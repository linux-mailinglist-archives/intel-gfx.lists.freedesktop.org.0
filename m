Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3F3493CC3F
	for <lists+intel-gfx@lfdr.de>; Tue, 11 Jun 2019 14:53:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 760A08916D;
	Tue, 11 Jun 2019 12:53:05 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id ACD4C8916D
 for <intel-gfx@lists.freedesktop.org>; Tue, 11 Jun 2019 12:53:03 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16864011-1500050 
 for multiple; Tue, 11 Jun 2019 13:52:45 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 11 Jun 2019 13:52:43 +0100
Message-Id: <20190611125244.23347-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 1/2] drm/i915: Move fence register tracking from
 i915->mm to ggtt
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgdGhlIGZlbmNlIHJlZ2lzdGVycyBvbmx5IGFwcGx5IHRvIHJlZ2lvbnMgaW5zaWRlIHRoZSBH
R1RUIGlzIG1ha2VzCm1vcmUgc2Vuc2UgdGhhdCB3ZSB0cmFjayB0aGVzZSBhcyBwYXJ0IG9mIHRo
ZSBpOTE1X2dndHQgYW5kIG5vdCB0aGUKZ2VuZXJhbCBtbS4gSW4gdGhlIG5leHQgcGF0Y2gsIHdl
IHdpbGwgdGhlbiBwdWxsIHRoZSByZWdpc3RlciBsb2NraW5nCnVuZGVybmVhdGggdGhlIGk5MTVf
Z2d0dC5tdXRleC4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2ls
c29uLmNvLnVrPgpSZXZpZXdlZC1ieTogTWlrYSBLdW9wcGFsYSA8bWlrYS5rdW9wcGFsYUBsaW51
eC5pbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4u
YyAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgICAgfCAg
MiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyAgICAgfCAgNiArLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2FwZXJ0dXJlX2dtLmMgICAgfCAgNyArLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5oICAgICAgICAgICAgfCAgNCArLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgICAgICAgfCA0MiArKysrKystLS0tLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kcnYuYyAgICAgICAgICAgfCAgMyArLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuaCAgICAgICAgICAgfCAyOCAtLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbS5jICAgICAgICAgICB8IDUyICsrKy0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5jIHwgOTAgKysrKysrKysrKysrKysrKy0tLS0t
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5oIHwgMTkgKysrKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jICAgICAgIHwgIDIgKwogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmggICAgICAgfCAxNCArKystCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jICAgICB8ICA2ICstCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3ZtYS5oICAgICAgICAgICB8ICAyICstCiAxNSBmaWxlcyBjaGFuZ2VkLCAxNDQg
aW5zZXJ0aW9ucygrKSwgMTM3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fbW1hbi5jCmluZGV4IGM3YjliMzRkZTAxYi4uYThiOGI5YzI4MWYxIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMKQEAgLTMxMCw5ICszMTAsOSBAQCB2
bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQogCS8qIE1hcmsg
YXMgYmVpbmcgbW1hcHBlZCBpbnRvIHVzZXJzcGFjZSBmb3IgbGF0ZXIgcmV2b2NhdGlvbiAqLwog
CWFzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChpOTE1KTsKIAlpZiAoIWk5MTVfdm1hX3NldF91c2Vy
ZmF1bHQodm1hKSAmJiAhb2JqLT51c2VyZmF1bHRfY291bnQrKykKLQkJbGlzdF9hZGQoJm9iai0+
dXNlcmZhdWx0X2xpbmssICZpOTE1LT5tbS51c2VyZmF1bHRfbGlzdCk7CisJCWxpc3RfYWRkKCZv
YmotPnVzZXJmYXVsdF9saW5rLCAmaTkxNS0+Z2d0dC51c2VyZmF1bHRfbGlzdCk7CiAJaWYgKENP
TkZJR19EUk1fSTkxNV9VU0VSRkFVTFRfQVVUT1NVU1BFTkQpCi0JCWludGVsX3dha2VyZWZfYXV0
bygmaTkxNS0+bW0udXNlcmZhdWx0X3dha2VyZWYsCisJCWludGVsX3dha2VyZWZfYXV0bygmaTkx
NS0+Z2d0dC51c2VyZmF1bHRfd2FrZXJlZiwKIAkJCQkgICBtc2Vjc190b19qaWZmaWVzX3RpbWVv
dXQoQ09ORklHX0RSTV9JOTE1X1VTRVJGQVVMVF9BVVRPU1VTUEVORCkpOwogCUdFTV9CVUdfT04o
IW9iai0+dXNlcmZhdWx0X2NvdW50KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
cG0uYwppbmRleCBmNDBmMTNjMGI4YjcuLjZkNjA2NGZiMmJmNSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKQEAgLTEyNiw3ICsxMjYsNyBAQCB2b2lkIGk5MTVfZ2VtX3N1
c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJR0VNX1RSQUNFKCJcbiIp
OwogCi0JaW50ZWxfd2FrZXJlZl9hdXRvKCZpOTE1LT5tbS51c2VyZmF1bHRfd2FrZXJlZiwgMCk7
CisJaW50ZWxfd2FrZXJlZl9hdXRvKCZpOTE1LT5nZ3R0LnVzZXJmYXVsdF93YWtlcmVmLCAwKTsK
IAlmbHVzaF93b3JrcXVldWUoaTkxNS0+d3EpOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
ZXNldC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwppbmRleCA2MGQy
NDExMGFmODAuLjRhYmViY2QzNmE3MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfcmVzZXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNl
dC5jCkBAIC02OTUsMTkgKzY5NSwxOSBAQCBzdGF0aWMgdm9pZCByZXZva2VfbW1hcHMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJaW50IGk7CiAKLQlmb3IgKGkgPSAwOyBpIDwg
aTkxNS0+bnVtX2ZlbmNlX3JlZ3M7IGkrKykgeworCWZvciAoaSA9IDA7IGkgPCBpOTE1LT5nZ3R0
Lm51bV9mZW5jZXM7IGkrKykgewogCQlzdHJ1Y3QgZHJtX3ZtYV9vZmZzZXRfbm9kZSAqbm9kZTsK
IAkJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAJCXU2NCB2bWFfb2Zmc2V0OwogCi0JCXZtYSA9IFJF
QURfT05DRShpOTE1LT5mZW5jZV9yZWdzW2ldLnZtYSk7CisJCXZtYSA9IFJFQURfT05DRShpOTE1
LT5nZ3R0LmZlbmNlX3JlZ3NbaV0udm1hKTsKIAkJaWYgKCF2bWEpCiAJCQljb250aW51ZTsKIAog
CQlpZiAoIWk5MTVfdm1hX2hhc191c2VyZmF1bHQodm1hKSkKIAkJCWNvbnRpbnVlOwogCi0JCUdF
TV9CVUdfT04odm1hLT5mZW5jZSAhPSAmaTkxNS0+ZmVuY2VfcmVnc1tpXSk7CisJCUdFTV9CVUdf
T04odm1hLT5mZW5jZSAhPSAmaTkxNS0+Z2d0dC5mZW5jZV9yZWdzW2ldKTsKIAkJbm9kZSA9ICZ2
bWEtPm9iai0+YmFzZS52bWFfbm9kZTsKIAkJdm1hX29mZnNldCA9IHZtYS0+Z2d0dF92aWV3LnBh
cnRpYWwub2Zmc2V0IDw8IFBBR0VfU0hJRlQ7CiAJCXVubWFwX21hcHBpbmdfcmFuZ2UoaTkxNS0+
ZHJtLmFub25faW5vZGUtPmlfbWFwcGluZywKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9hcGVydHVyZV9nbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2FwZXJ0dXJl
X2dtLmMKaW5kZXggMWZhMmY2NWMzY2QxLi40MDk4OTAyYmZhZWIgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d2dC9hcGVydHVyZV9nbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9hcGVydHVyZV9nbS5jCkBAIC0zNSw2ICszNSw3IEBACiAgKi8KIAogI2luY2x1ZGUg
Imk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaTkxNV9nZW1fZmVuY2VfcmVnLmgiCiAjaW5jbHVkZSAi
Z3Z0LmgiCiAKIHN0YXRpYyBpbnQgYWxsb2NfZ20oc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGJv
b2wgaGlnaF9nbSkKQEAgLTEyOCw3ICsxMjksNyBAQCB2b2lkIGludGVsX3ZncHVfd3JpdGVfZmVu
Y2Uoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCiB7CiAJc3RydWN0IGludGVsX2d2dCAqZ3Z0ID0g
dmdwdS0+Z3Z0OwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd2dC0+ZGV2
X3ByaXY7Ci0Jc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqcmVnOworCXN0cnVjdCBpOTE1X2Zl
bmNlX3JlZyAqcmVnOwogCWk5MTVfcmVnX3QgZmVuY2VfcmVnX2xvLCBmZW5jZV9yZWdfaGk7CiAK
IAlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoZGV2X3ByaXYpOwpAQCAtMTYzLDcgKzE2NCw3IEBA
IHN0YXRpYyB2b2lkIGZyZWVfdmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIHsK
IAlzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQgPSB2Z3B1LT5ndnQ7CiAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gZ3Z0LT5kZXZfcHJpdjsKLQlzdHJ1Y3QgZHJtX2k5MTVfZmVuY2Vf
cmVnICpyZWc7CisJc3RydWN0IGk5MTVfZmVuY2VfcmVnICpyZWc7CiAJdTMyIGk7CiAKIAlpZiAo
V0FSTl9PTighdmdwdV9mZW5jZV9zeih2Z3B1KSkpCkBAIC0xODcsNyArMTg4LDcgQEAgc3RhdGlj
IGludCBhbGxvY192Z3B1X2ZlbmNlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQogewogCXN0cnVj
dCBpbnRlbF9ndnQgKmd2dCA9IHZncHUtPmd2dDsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBndnQtPmRldl9wcml2OwotCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKnJl
ZzsKKwlzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKnJlZzsKIAlpbnQgaTsKIAogCWludGVsX3J1bnRp
bWVfcG1fZ2V0KGRldl9wcml2KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2
dC9ndnQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuaAppbmRleCBiNTRmMmJkYzEz
YTQuLmRmZDEwY2Y4MmI2NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2
dC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuaApAQCAtODcsNyArODcsNyBA
QCBzdHJ1Y3QgaW50ZWxfdmdwdV9nbSB7CiAKIC8qIEZlbmNlcyBvd25lZCBieSBhIHZHUFUgKi8K
IHN0cnVjdCBpbnRlbF92Z3B1X2ZlbmNlIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVnICpy
ZWdzW0lOVEVMX0dWVF9NQVhfTlVNX0ZFTkNFU107CisJc3RydWN0IGk5MTVfZmVuY2VfcmVnICpy
ZWdzW0lOVEVMX0dWVF9NQVhfTlVNX0ZFTkNFU107CiAJdTMyIGJhc2U7CiAJdTMyIHNpemU7CiB9
OwpAQCAtMzkwLDcgKzM5MCw3IEBAIGludCBpbnRlbF9ndnRfbG9hZF9maXJtd2FyZShzdHJ1Y3Qg
aW50ZWxfZ3Z0ICpndnQpOwogI2RlZmluZSBndnRfaGlkZGVuX2dtYWRyX2VuZChndnQpIChndnRf
aGlkZGVuX2dtYWRyX2Jhc2UoZ3Z0KSBcCiAJCQkJICAgKyBndnRfaGlkZGVuX3N6KGd2dCkgLSAx
KQogCi0jZGVmaW5lIGd2dF9mZW5jZV9zeihndnQpIChndnQtPmRldl9wcml2LT5udW1fZmVuY2Vf
cmVncykKKyNkZWZpbmUgZ3Z0X2ZlbmNlX3N6KGd2dCkgKChndnQpLT5kZXZfcHJpdi0+Z2d0dC5u
dW1fZmVuY2VzKQogCiAvKiBBcGVydHVyZS9HTSBzcGFjZSBkZWZpbml0aW9ucyBmb3IgdkdQVSAq
LwogI2RlZmluZSB2Z3B1X2FwZXJ0dXJlX29mZnNldCh2Z3B1KQkoKHZncHUpLT5nbS5sb3dfZ21f
bm9kZS5zdGFydCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdm
cy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggYjA3MGU2ZjM3
ODBjLi5jNDJlMTA5MjI0YWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZGVidWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC0x
NTYsOCArMTU2LDYgQEAgZGVzY3JpYmVfb2JqKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAl1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0czsK
IAlpbnQgcGluX2NvdW50ID0gMDsKIAotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJm9iai0+YmFzZS5k
ZXYtPnN0cnVjdF9tdXRleCk7Ci0KIAlzZXFfcHJpbnRmKG0sICIlcEs6ICVjJWMlYyVjJWMgJTh6
ZEtpQiAlMDJ4ICUwMnggJXMlcyVzIiwKIAkJICAgJm9iai0+YmFzZSwKIAkJICAgZ2V0X2FjdGl2
ZV9mbGFnKG9iaiksCkBAIC0xNzMsMTcgKzE3MSwxNyBAQCBkZXNjcmliZV9vYmooc3RydWN0IHNl
cV9maWxlICptLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCQkgICBvYmotPm1t
Lm1hZHYgPT0gSTkxNV9NQURWX0RPTlRORUVEID8gIiBwdXJnZWFibGUiIDogIiIpOwogCWlmIChv
YmotPmJhc2UubmFtZSkKIAkJc2VxX3ByaW50ZihtLCAiIChuYW1lOiAlZCkiLCBvYmotPmJhc2Uu
bmFtZSk7Ci0JbGlzdF9mb3JfZWFjaF9lbnRyeSh2bWEsICZvYmotPnZtYS5saXN0LCBvYmpfbGlu
aykgewotCQlpZiAoaTkxNV92bWFfaXNfcGlubmVkKHZtYSkpCi0JCQlwaW5fY291bnQrKzsKLQl9
Ci0Jc2VxX3ByaW50ZihtLCAiIChwaW5uZWQgeCAlZCkiLCBwaW5fY291bnQpOwotCWlmIChvYmot
PnBpbl9nbG9iYWwpCi0JCXNlcV9wcmludGYobSwgIiAoZ2xvYmFsKSIpOworCisJc3Bpbl9sb2Nr
KCZvYmotPnZtYS5sb2NrKTsKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KHZtYSwgJm9iai0+dm1hLmxp
c3QsIG9ial9saW5rKSB7CiAJCWlmICghZHJtX21tX25vZGVfYWxsb2NhdGVkKCZ2bWEtPm5vZGUp
KQogCQkJY29udGludWU7CiAKKwkJc3Bpbl91bmxvY2soJm9iai0+dm1hLmxvY2spOworCisJCWlm
IChpOTE1X3ZtYV9pc19waW5uZWQodm1hKSkKKwkJCXBpbl9jb3VudCsrOworCiAJCXNlcV9wcmlu
dGYobSwgIiAoJXNndHQgb2Zmc2V0OiAlMDhsbHgsIHNpemU6ICUwOGxseCwgcGFnZXM6ICVzIiwK
IAkJCSAgIGk5MTVfdm1hX2lzX2dndHQodm1hKSA/ICJnIiA6ICJwcCIsCiAJCQkgICB2bWEtPm5v
ZGUuc3RhcnQsIHZtYS0+bm9kZS5zaXplLApAQCAtMjM0LDkgKzIzMiwxNiBAQCBkZXNjcmliZV9v
Ymooc3RydWN0IHNlcV9maWxlICptLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQog
CQkJCSAgIHZtYS0+ZmVuY2UtPmlkLAogCQkJCSAgIGk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQo
JnZtYS0+bGFzdF9mZW5jZSkgPyAiKiIgOiAiIik7CiAJCXNlcV9wdXRzKG0sICIpIik7CisKKwkJ
c3Bpbl9sb2NrKCZvYmotPnZtYS5sb2NrKTsKIAl9CisJc3Bpbl91bmxvY2soJm9iai0+dm1hLmxv
Y2spOworCisJc2VxX3ByaW50ZihtLCAiIChwaW5uZWQgeCAlZCkiLCBwaW5fY291bnQpOwogCWlm
IChvYmotPnN0b2xlbikKIAkJc2VxX3ByaW50ZihtLCAiIChzdG9sZW46ICUwOGxseCkiLCBvYmot
PnN0b2xlbi0+c3RhcnQpOworCWlmIChvYmotPnBpbl9nbG9iYWwpCisJCXNlcV9wcmludGYobSwg
IiAoZ2xvYmFsKSIpOwogCiAJZW5naW5lID0gaTkxNV9nZW1fb2JqZWN0X2xhc3Rfd3JpdGVfZW5n
aW5lKG9iaik7CiAJaWYgKGVuZ2luZSkKQEAgLTg3MiwyOCArODc3LDI1IEBAIHN0YXRpYyBpbnQg
aTkxNV9pbnRlcnJ1cHRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAKIHN0
YXRpYyBpbnQgaTkxNV9nZW1fZmVuY2VfcmVnc19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9p
ZCAqZGF0YSkKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3Rv
X2k5MTUobS0+cHJpdmF0ZSk7Ci0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+
ZHJtOwotCWludCBpLCByZXQ7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2Rl
X3RvX2k5MTUobS0+cHJpdmF0ZSk7CisJdW5zaWduZWQgaW50IGk7CiAKLQlyZXQgPSBtdXRleF9s
b2NrX2ludGVycnVwdGlibGUoJmRldi0+c3RydWN0X211dGV4KTsKLQlpZiAocmV0KQotCQlyZXR1
cm4gcmV0OworCXNlcV9wcmludGYobSwgIlRvdGFsIGZlbmNlcyA9ICVkXG4iLCBpOTE1LT5nZ3R0
Lm51bV9mZW5jZXMpOwogCi0Jc2VxX3ByaW50ZihtLCAiVG90YWwgZmVuY2VzID0gJWRcbiIsIGRl
dl9wcml2LT5udW1fZmVuY2VfcmVncyk7Ci0JZm9yIChpID0gMDsgaSA8IGRldl9wcml2LT5udW1f
ZmVuY2VfcmVnczsgaSsrKSB7Ci0JCXN0cnVjdCBpOTE1X3ZtYSAqdm1hID0gZGV2X3ByaXYtPmZl
bmNlX3JlZ3NbaV0udm1hOworCXJjdV9yZWFkX2xvY2soKTsKKwlmb3IgKGkgPSAwOyBpIDwgaTkx
NS0+Z2d0dC5udW1fZmVuY2VzOyBpKyspIHsKKwkJc3RydWN0IGk5MTVfdm1hICp2bWEgPSBpOTE1
LT5nZ3R0LmZlbmNlX3JlZ3NbaV0udm1hOwogCiAJCXNlcV9wcmludGYobSwgIkZlbmNlICVkLCBw
aW4gY291bnQgPSAlZCwgb2JqZWN0ID0gIiwKLQkJCSAgIGksIGRldl9wcml2LT5mZW5jZV9yZWdz
W2ldLnBpbl9jb3VudCk7CisJCQkgICBpLCBpOTE1LT5nZ3R0LmZlbmNlX3JlZ3NbaV0ucGluX2Nv
dW50KTsKIAkJaWYgKCF2bWEpCiAJCQlzZXFfcHV0cyhtLCAidW51c2VkIik7CiAJCWVsc2UKIAkJ
CWRlc2NyaWJlX29iaihtLCB2bWEtPm9iaik7CiAJCXNlcV9wdXRjKG0sICdcbicpOwogCX0KKwly
Y3VfcmVhZF91bmxvY2soKTsKIAotCW11dGV4X3VubG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgpOwog
CXJldHVybiAwOwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Ry
di5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwppbmRleCAxYWY2NzUxZTFiMzYu
LjA2YTc2ZDQ5ZWNkMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCkBAIC0zNTAsNyArMzUwLDcg
QEAgc3RhdGljIGludCBpOTE1X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHZvaWQgKmRhdGEsCiAJCXZhbHVlID0gcGRldi0+cmV2aXNpb247CiAJCWJyZWFrOwogCWNhc2Ug
STkxNV9QQVJBTV9OVU1fRkVOQ0VTX0FWQUlMOgotCQl2YWx1ZSA9IGRldl9wcml2LT5udW1fZmVu
Y2VfcmVnczsKKwkJdmFsdWUgPSBkZXZfcHJpdi0+Z2d0dC5udW1fZmVuY2VzOwogCQlicmVhazsK
IAljYXNlIEk5MTVfUEFSQU1fSEFTX09WRVJMQVk6CiAJCXZhbHVlID0gZGV2X3ByaXYtPm92ZXJs
YXkgPyAxIDogMDsKQEAgLTE2MjUsNyArMTYyNSw2IEBAIHN0YXRpYyBpbnQgaTkxNV9kcml2ZXJf
aW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJaW50ZWxfdW5jb3Jl
X3Nhbml0aXplKGRldl9wcml2KTsKIAogCWludGVsX2d0X2luaXRfd29ya2Fyb3VuZHMoZGV2X3By
aXYpOwotCWk5MTVfZ2VtX2xvYWRfaW5pdF9mZW5jZXMoZGV2X3ByaXYpOwogCiAJLyogT24gdGhl
IDk0NUcvR00sIHRoZSBjaGlwc2V0IHJlcG9ydHMgdGhlIE1TSSBjYXBhYmlsaXR5IG9uIHRoZQog
CSAqIGludGVncmF0ZWQgZ3JhcGhpY3MgZXZlbiB0aG91Z2ggdGhlIHN1cHBvcnQgaXNuJ3QgYWN0
dWFsbHkgdGhlcmUKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2Lmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4IDBlYTdmNzhhZTIyNy4uNjc0
MzAwOTUzYWEyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKQEAgLTc2MSwxNCArNzYxLDYgQEAg
c3RydWN0IGk5MTVfZ2VtX21tIHsKIAkgKi8KIAlzdHJ1Y3QgbGlzdF9oZWFkIHB1cmdlX2xpc3Q7
CiAKLQkvKiogTGlzdCBvZiBhbGwgb2JqZWN0cyBpbiBndHRfc3BhY2UsIGN1cnJlbnRseSBtbWFw
ZWQgYnkgdXNlcnNwYWNlLgotCSAqIEFsbCBvYmplY3RzIHdpdGhpbiB0aGlzIGxpc3QgbXVzdCBh
bHNvIGJlIG9uIGJvdW5kX2xpc3QuCi0JICovCi0Jc3RydWN0IGxpc3RfaGVhZCB1c2VyZmF1bHRf
bGlzdDsKLQotCS8qIE1hbnVhbCBydW50aW1lIHBtIGF1dG9zdXNwZW5kIGRlbGF5IGZvciB1c2Vy
IEdHVFQgbW1hcHMgKi8KLQlzdHJ1Y3QgaW50ZWxfd2FrZXJlZl9hdXRvIHVzZXJmYXVsdF93YWtl
cmVmOwotCiAJLyoqCiAJICogTGlzdCBvZiBvYmplY3RzIHdoaWNoIGFyZSBwZW5kaW5nIGRlc3Ry
dWN0aW9uLgogCSAqLwpAQCAtNzk4LDkgKzc5MCw2IEBAIHN0cnVjdCBpOTE1X2dlbV9tbSB7CiAJ
c3RydWN0IG5vdGlmaWVyX2Jsb2NrIHZtYXBfbm90aWZpZXI7CiAJc3RydWN0IHNocmlua2VyIHNo
cmlua2VyOwogCi0JLyoqIExSVSBsaXN0IG9mIG9iamVjdHMgd2l0aCBmZW5jZSByZWdzIG9uIHRo
ZW0uICovCi0Jc3RydWN0IGxpc3RfaGVhZCBmZW5jZV9saXN0OwotCiAJLyoqCiAJICogV29ya3F1
ZXVlIHRvIGZhdWx0IGluIHVzZXJwdHIgcGFnZXMsIGZsdXNoZWQgYnkgdGhlIGV4ZWNidWYKIAkg
KiB3aGVuIHJlcXVpcmVkIGJ1dCBvdGhlcndpc2UgbGVmdCB0byB1c2Vyc3BhY2UgdG8gdHJ5IGFn
YWluCkBAIC0xNDg5LDkgKzE0NzgsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSB7CiAJLyog
cHJvdGVjdHMgcGFuZWwgcG93ZXIgc2VxdWVuY2VyIHN0YXRlICovCiAJc3RydWN0IG11dGV4IHBw
c19tdXRleDsKIAotCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgZmVuY2VfcmVnc1tJOTE1X01B
WF9OVU1fRkVOQ0VTXTsgLyogYXNzdW1lIDk2NSAqLwotCWludCBudW1fZmVuY2VfcmVnczsgLyog
OCBvbiBwcmUtOTY1LCAxNiBvdGhlcndpc2UgKi8KLQogCXVuc2lnbmVkIGludCBmc2JfZnJlcSwg
bWVtX2ZyZXEsIGlzX2RkcjM7CiAJdW5zaWduZWQgaW50IHNrbF9wcmVmZXJyZWRfdmNvX2ZyZXE7
CiAJdW5zaWduZWQgaW50IG1heF9jZGNsa19mcmVxOwpAQCAtMjUzOCw3ICsyNTI0LDYgQEAgdm9p
ZCBpOTE1X2dlbV9jbGVhbnVwX3VzZXJwdHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsKIHZvaWQgaTkxNV9nZW1fc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpOwogaW50IGk5MTVfZ2VtX2luaXRfZWFybHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKIHZvaWQgaTkxNV9nZW1fY2xlYW51cF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBpOTE1X2dlbV9sb2FkX2luaXRfZmVuY2VzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiBpbnQgaTkxNV9nZW1fZnJlZXplKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiBpbnQgaTkxNV9nZW1fZnJlZXplX2xhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIApAQCAtMjY1OCwxOSArMjY0Myw2IEBA
IHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqaTkxNV9nZW1fcHJpbWVfaW1wb3J0KHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYsCiBzdHJ1Y3QgZG1hX2J1ZiAqaTkxNV9nZW1fcHJpbWVfZXhwb3J0KHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYsCiAJCQkJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW1fb2JqLCBp
bnQgZmxhZ3MpOwogCi0vKiBpOTE1X2dlbV9mZW5jZV9yZWcuYyAqLwotc3RydWN0IGRybV9pOTE1
X2ZlbmNlX3JlZyAqCi1pOTE1X3Jlc2VydmVfZmVuY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKLXZvaWQgaTkxNV91bnJlc2VydmVfZmVuY2Uoc3RydWN0IGRybV9pOTE1X2Zl
bmNlX3JlZyAqZmVuY2UpOwotCi12b2lkIGk5MTVfZ2VtX3Jlc3RvcmVfZmVuY2VzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci0KLXZvaWQgaTkxNV9nZW1fZGV0ZWN0X2JpdF82
X3N3aXp6bGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQgaTkxNV9n
ZW1fb2JqZWN0X2RvX2JpdF8xN19zd2l6emxlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmosCi0JCQkJICAgICAgIHN0cnVjdCBzZ190YWJsZSAqcGFnZXMpOwotdm9pZCBpOTE1X2dlbV9v
YmplY3Rfc2F2ZV9iaXRfMTdfc3dpenpsZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
LAotCQkJCQkgc3RydWN0IHNnX3RhYmxlICpwYWdlcyk7Ci0KIHN0YXRpYyBpbmxpbmUgc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHQgKgogX19pOTE1X2dlbV9jb250ZXh0X2xvb2t1cF9yY3Uoc3RydWN0
IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZmlsZV9wcml2LCB1MzIgaWQpCiB7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW0uYwppbmRleCBlOTgwYzFlZTNkY2YuLmQ5YTllOGVjODBmMCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbS5jCkBAIC04ODMsNyArODgzLDcgQEAgaTkxNV9nZW1fc3dfZmluaXNoX2lvY3Rs
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJcmV0dXJuIDA7CiB9CiAKLXZv
aWQgaTkxNV9nZW1fcnVudGltZV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKK3ZvaWQgaTkxNV9nZW1fcnVudGltZV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQogewogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosICpvbjsKIAlp
bnQgaTsKQEAgLTg5NiwxNyArODk2LDE5IEBAIHZvaWQgaTkxNV9nZW1fcnVudGltZV9zdXNwZW5k
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkgKi8KIAogCWxpc3RfZm9yX2Vh
Y2hfZW50cnlfc2FmZShvYmosIG9uLAotCQkJCSAmZGV2X3ByaXYtPm1tLnVzZXJmYXVsdF9saXN0
LCB1c2VyZmF1bHRfbGluaykKKwkJCQkgJmk5MTUtPmdndHQudXNlcmZhdWx0X2xpc3QsIHVzZXJm
YXVsdF9saW5rKQogCQlfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAob2JqKTsKIAotCS8q
IFRoZSBmZW5jZSB3aWxsIGJlIGxvc3Qgd2hlbiB0aGUgZGV2aWNlIHBvd2VycyBkb3duLiBJZiBh
bnkgd2VyZQorCS8qCisJICogVGhlIGZlbmNlIHdpbGwgYmUgbG9zdCB3aGVuIHRoZSBkZXZpY2Ug
cG93ZXJzIGRvd24uIElmIGFueSB3ZXJlCiAJICogaW4gdXNlIGJ5IGhhcmR3YXJlIChpLmUuIHRo
ZXkgYXJlIHBpbm5lZCksIHdlIHNob3VsZCBub3QgYmUgcG93ZXJpbmcKIAkgKiBkb3duISBBbGwg
b3RoZXIgZmVuY2VzIHdpbGwgYmUgcmVhY3F1aXJlZCBieSB0aGUgdXNlciB1cG9uIHdha2luZy4K
IAkgKi8KLQlmb3IgKGkgPSAwOyBpIDwgZGV2X3ByaXYtPm51bV9mZW5jZV9yZWdzOyBpKyspIHsK
LQkJc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqcmVnID0gJmRldl9wcml2LT5mZW5jZV9yZWdz
W2ldOworCWZvciAoaSA9IDA7IGkgPCBpOTE1LT5nZ3R0Lm51bV9mZW5jZXM7IGkrKykgeworCQlz
dHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKnJlZyA9ICZpOTE1LT5nZ3R0LmZlbmNlX3JlZ3NbaV07CiAK
LQkJLyogSWRlYWxseSB3ZSB3YW50IHRvIGFzc2VydCB0aGF0IHRoZSBmZW5jZSByZWdpc3RlciBp
cyBub3QKKwkJLyoKKwkJICogSWRlYWxseSB3ZSB3YW50IHRvIGFzc2VydCB0aGF0IHRoZSBmZW5j
ZSByZWdpc3RlciBpcyBub3QKIAkJICogbGl2ZSBhdCB0aGlzIHBvaW50IChpLmUuIHRoYXQgbm8g
cGllY2Ugb2YgY29kZSB3aWxsIGJlCiAJCSAqIHRyeWluZyB0byB3cml0ZSB0aHJvdWdoIGZlbmNl
ICsgR1RULCBhcyB0aGF0IGJvdGggdmlvbGF0ZXMKIAkJICogb3VyIHRyYWNraW5nIG9mIGFjdGl2
aXR5IGFuZCBhc3NvY2lhdGVkIGxvY2tpbmcvYmFycmllcnMsCkBAIC0xNjg4LDcgKzE2OTAsNyBA
QCB2b2lkIGk5MTVfZ2VtX2ZpbmlfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQogewogCUdFTV9CVUdfT04oZGV2X3ByaXYtPmd0LmF3YWtlKTsKIAotCWludGVsX3dha2VyZWZf
YXV0b19maW5pKCZkZXZfcHJpdi0+bW0udXNlcmZhdWx0X3dha2VyZWYpOworCWludGVsX3dha2Vy
ZWZfYXV0b19maW5pKCZkZXZfcHJpdi0+Z2d0dC51c2VyZmF1bHRfd2FrZXJlZik7CiAKIAlpOTE1
X2dlbV9zdXNwZW5kX2xhdGUoZGV2X3ByaXYpOwogCWludGVsX2Rpc2FibGVfZ3RfcG93ZXJzYXZl
KGRldl9wcml2KTsKQEAgLTE3MzAsMzggKzE3MzIsNiBAQCB2b2lkIGk5MTVfZ2VtX2luaXRfbW1p
byhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlpOTE1X2dlbV9zYW5pdGl6ZShpOTE1
KTsKIH0KIAotdm9pZAotaTkxNV9nZW1fbG9hZF9pbml0X2ZlbmNlcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JaW50IGk7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSA3ICYmICFJU19WQUxMRVlWSUVXKGRldl9wcml2KSAmJgotCSAgICAhSVNfQ0hFUlJZVklF
VyhkZXZfcHJpdikpCi0JCWRldl9wcml2LT5udW1fZmVuY2VfcmVncyA9IDMyOwotCWVsc2UgaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCB8fAotCQkgSVNfSTk0NUcoZGV2X3ByaXYpIHx8IElT
X0k5NDVHTShkZXZfcHJpdikgfHwKLQkJIElTX0czMyhkZXZfcHJpdikgfHwgSVNfUElORVZJRVco
ZGV2X3ByaXYpKQotCQlkZXZfcHJpdi0+bnVtX2ZlbmNlX3JlZ3MgPSAxNjsKLQllbHNlCi0JCWRl
dl9wcml2LT5udW1fZmVuY2VfcmVncyA9IDg7Ci0KLQlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoZGV2
X3ByaXYpKQotCQlkZXZfcHJpdi0+bnVtX2ZlbmNlX3JlZ3MgPQotCQkJCUk5MTVfUkVBRCh2Z3Rp
Zl9yZWcoYXZhaWxfcnMuZmVuY2VfbnVtKSk7Ci0KLQkvKiBJbml0aWFsaXplIGZlbmNlIHJlZ2lz
dGVycyB0byB6ZXJvICovCi0JZm9yIChpID0gMDsgaSA8IGRldl9wcml2LT5udW1fZmVuY2VfcmVn
czsgaSsrKSB7Ci0JCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlID0gJmRldl9wcml2
LT5mZW5jZV9yZWdzW2ldOwotCi0JCWZlbmNlLT5pOTE1ID0gZGV2X3ByaXY7Ci0JCWZlbmNlLT5p
ZCA9IGk7Ci0JCWxpc3RfYWRkX3RhaWwoJmZlbmNlLT5saW5rLCAmZGV2X3ByaXYtPm1tLmZlbmNl
X2xpc3QpOwotCX0KLQlpOTE1X2dlbV9yZXN0b3JlX2ZlbmNlcyhkZXZfcHJpdik7Ci0KLQlpOTE1
X2dlbV9kZXRlY3RfYml0XzZfc3dpenpsZShkZXZfcHJpdik7Ci19Ci0KIHN0YXRpYyB2b2lkIGk5
MTVfZ2VtX2luaXRfX21tKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogCXNwaW5f
bG9ja19pbml0KCZpOTE1LT5tbS5vYmpfbG9jayk7CkBAIC0xNzcyLDEwICsxNzQyLDYgQEAgc3Rh
dGljIHZvaWQgaTkxNV9nZW1faW5pdF9fbW0oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
CiAJSU5JVF9MSVNUX0hFQUQoJmk5MTUtPm1tLnB1cmdlX2xpc3QpOwogCUlOSVRfTElTVF9IRUFE
KCZpOTE1LT5tbS51bmJvdW5kX2xpc3QpOwogCUlOSVRfTElTVF9IRUFEKCZpOTE1LT5tbS5ib3Vu
ZF9saXN0KTsKLQlJTklUX0xJU1RfSEVBRCgmaTkxNS0+bW0uZmVuY2VfbGlzdCk7Ci0KLQlJTklU
X0xJU1RfSEVBRCgmaTkxNS0+bW0udXNlcmZhdWx0X2xpc3QpOwotCWludGVsX3dha2VyZWZfYXV0
b19pbml0KCZpOTE1LT5tbS51c2VyZmF1bHRfd2FrZXJlZiwgaTkxNSk7CiAKIAlpOTE1X2dlbV9p
bml0X19vYmplY3RzKGk5MTUpOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW1fZmVuY2VfcmVnLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9mZW5j
ZV9yZWcuYwppbmRleCAxMGFhNmUzNTBiZmEuLjFjOTQ2NjY3NmNhZiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZmVuY2VfcmVnLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9nZW1fZmVuY2VfcmVnLmMKQEAgLTI1LDYgKzI1LDcgQEAKIAogI2luY2x1
ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAiaTkxNV9zY2F0dGVybGlzdC5oIgorI2luY2x1ZGUg
Imk5MTVfdmdwdS5oIgogCiAvKioKICAqIERPQzogZmVuY2UgcmVnaXN0ZXIgaGFuZGxpbmcKQEAg
LTU4LDcgKzU5LDcgQEAKIAogI2RlZmluZSBwaXBlbGluZWQgMAogCi1zdGF0aWMgdm9pZCBpOTY1
X3dyaXRlX2ZlbmNlX3JlZyhzdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVnICpmZW5jZSwKK3N0YXRp
YyB2b2lkIGk5NjVfd3JpdGVfZmVuY2VfcmVnKHN0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2Us
CiAJCQkJIHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogewogCWk5MTVfcmVnX3QgZmVuY2VfcmVnX2xv
LCBmZW5jZV9yZWdfaGk7CkBAIC0xMTUsNyArMTE2LDcgQEAgc3RhdGljIHZvaWQgaTk2NV93cml0
ZV9mZW5jZV9yZWcoc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2UsCiAJfQogfQogCi1z
dGF0aWMgdm9pZCBpOTE1X3dyaXRlX2ZlbmNlX3JlZyhzdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVn
ICpmZW5jZSwKK3N0YXRpYyB2b2lkIGk5MTVfd3JpdGVfZmVuY2VfcmVnKHN0cnVjdCBpOTE1X2Zl
bmNlX3JlZyAqZmVuY2UsCiAJCQkJIHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogewogCXUzMiB2YWw7
CkBAIC0xNTUsNyArMTU2LDcgQEAgc3RhdGljIHZvaWQgaTkxNV93cml0ZV9mZW5jZV9yZWcoc3Ry
dWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2UsCiAJfQogfQogCi1zdGF0aWMgdm9pZCBpODMw
X3dyaXRlX2ZlbmNlX3JlZyhzdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVnICpmZW5jZSwKK3N0YXRp
YyB2b2lkIGk4MzBfd3JpdGVfZmVuY2VfcmVnKHN0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2Us
CiAJCQkJIHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogewogCXUzMiB2YWw7CkBAIC0xODcsNyArMTg4
LDcgQEAgc3RhdGljIHZvaWQgaTgzMF93cml0ZV9mZW5jZV9yZWcoc3RydWN0IGRybV9pOTE1X2Zl
bmNlX3JlZyAqZmVuY2UsCiAJfQogfQogCi1zdGF0aWMgdm9pZCBmZW5jZV93cml0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfZmVuY2VfcmVnICpmZW5jZSwKK3N0YXRpYyB2b2lkIGZlbmNlX3dyaXRlKHN0cnVj
dCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2UsCiAJCQlzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKIHsKIAkv
KgpAQCAtMjExLDcgKzIxMiw3IEBAIHN0YXRpYyB2b2lkIGZlbmNlX3dyaXRlKHN0cnVjdCBkcm1f
aTkxNV9mZW5jZV9yZWcgKmZlbmNlLAogCWZlbmNlLT5kaXJ0eSA9IGZhbHNlOwogfQogCi1zdGF0
aWMgaW50IGZlbmNlX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVnICpmZW5jZSwKK3N0
YXRpYyBpbnQgZmVuY2VfdXBkYXRlKHN0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2UsCiAJCQlz
dHJ1Y3QgaTkxNV92bWEgKnZtYSkKIHsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKQEAgLTI1
Niw3ICsyNTcsNyBAQCBzdGF0aWMgaW50IGZlbmNlX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfZmVu
Y2VfcmVnICpmZW5jZSwKIAkJCW9sZC0+ZmVuY2UgPSBOVUxMOwogCQl9CiAKLQkJbGlzdF9tb3Zl
KCZmZW5jZS0+bGluaywgJmZlbmNlLT5pOTE1LT5tbS5mZW5jZV9saXN0KTsKKwkJbGlzdF9tb3Zl
KCZmZW5jZS0+bGluaywgJmZlbmNlLT5pOTE1LT5nZ3R0LmZlbmNlX2xpc3QpOwogCX0KIAogCS8q
CkBAIC0yODAsNyArMjgxLDcgQEAgc3RhdGljIGludCBmZW5jZV91cGRhdGUoc3RydWN0IGRybV9p
OTE1X2ZlbmNlX3JlZyAqZmVuY2UsCiAKIAlpZiAodm1hKSB7CiAJCXZtYS0+ZmVuY2UgPSBmZW5j
ZTsKLQkJbGlzdF9tb3ZlX3RhaWwoJmZlbmNlLT5saW5rLCAmZmVuY2UtPmk5MTUtPm1tLmZlbmNl
X2xpc3QpOworCQlsaXN0X21vdmVfdGFpbCgmZmVuY2UtPmxpbmssICZmZW5jZS0+aTkxNS0+Z2d0
dC5mZW5jZV9saXN0KTsKIAl9CiAKIAlpbnRlbF9ydW50aW1lX3BtX3B1dChmZW5jZS0+aTkxNSwg
d2FrZXJlZik7CkBAIC0zMDAsNyArMzAxLDcgQEAgc3RhdGljIGludCBmZW5jZV91cGRhdGUoc3Ry
dWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2UsCiAgKi8KIGludCBpOTE1X3ZtYV9wdXRfZmVu
Y2Uoc3RydWN0IGk5MTVfdm1hICp2bWEpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAq
ZmVuY2UgPSB2bWEtPmZlbmNlOworCXN0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2UgPSB2bWEt
PmZlbmNlOwogCiAJaWYgKCFmZW5jZSkKIAkJcmV0dXJuIDA7CkBAIC0zMTEsMTEgKzMxMiwxMSBA
QCBpbnQgaTkxNV92bWFfcHV0X2ZlbmNlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogCXJldHVybiBm
ZW5jZV91cGRhdGUoZmVuY2UsIE5VTEwpOwogfQogCi1zdGF0aWMgc3RydWN0IGRybV9pOTE1X2Zl
bmNlX3JlZyAqZmVuY2VfZmluZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3N0YXRp
YyBzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKmZlbmNlX2ZpbmQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2U7CisJc3RydWN0
IGk5MTVfZmVuY2VfcmVnICpmZW5jZTsKIAotCWxpc3RfZm9yX2VhY2hfZW50cnkoZmVuY2UsICZp
OTE1LT5tbS5mZW5jZV9saXN0LCBsaW5rKSB7CisJbGlzdF9mb3JfZWFjaF9lbnRyeShmZW5jZSwg
Jmk5MTUtPmdndHQuZmVuY2VfbGlzdCwgbGluaykgewogCQlHRU1fQlVHX09OKGZlbmNlLT52bWEg
JiYgZmVuY2UtPnZtYS0+ZmVuY2UgIT0gZmVuY2UpOwogCiAJCWlmIChmZW5jZS0+cGluX2NvdW50
KQpAQCAtMzQ5LDEwICszNTAsOSBAQCBzdGF0aWMgc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAq
ZmVuY2VfZmluZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKICAqCiAgKiAwIG9uIHN1
Y2Nlc3MsIG5lZ2F0aXZlIGVycm9yIGNvZGUgb24gZmFpbHVyZS4KICAqLwotaW50Ci1pOTE1X3Zt
YV9waW5fZmVuY2Uoc3RydWN0IGk5MTVfdm1hICp2bWEpCitpbnQgaTkxNV92bWFfcGluX2ZlbmNl
KHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogewotCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZl
bmNlOworCXN0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2U7CiAJc3RydWN0IGk5MTVfdm1hICpz
ZXQgPSBpOTE1X2dlbV9vYmplY3RfaXNfdGlsZWQodm1hLT5vYmopID8gdm1hIDogTlVMTDsKIAlp
bnQgZXJyOwogCkBAIC0zNjksNyArMzY5LDcgQEAgaTkxNV92bWFfcGluX2ZlbmNlKHN0cnVjdCBp
OTE1X3ZtYSAqdm1hKQogCQlmZW5jZS0+cGluX2NvdW50Kys7CiAJCWlmICghZmVuY2UtPmRpcnR5
KSB7CiAJCQlsaXN0X21vdmVfdGFpbCgmZmVuY2UtPmxpbmssCi0JCQkJICAgICAgICZmZW5jZS0+
aTkxNS0+bW0uZmVuY2VfbGlzdCk7CisJCQkJICAgICAgICZmZW5jZS0+aTkxNS0+Z2d0dC5mZW5j
ZV9saXN0KTsKIAkJCXJldHVybiAwOwogCQl9CiAJfSBlbHNlIGlmIChzZXQpIHsKQEAgLTQwNCwx
MCArNDA0LDkgQEAgaTkxNV92bWFfcGluX2ZlbmNlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogICog
VGhpcyBmdW5jdGlvbiB3YWxrcyB0aGUgZmVuY2UgcmVncyBsb29raW5nIGZvciBhIGZyZWUgb25l
IGFuZCByZW1vdmUKICAqIGl0IGZyb20gdGhlIGZlbmNlX2xpc3QuIEl0IGlzIHVzZWQgdG8gcmVz
ZXJ2ZSBmZW5jZSBmb3IgdkdQVSB0byB1c2UuCiAgKi8KLXN0cnVjdCBkcm1faTkxNV9mZW5jZV9y
ZWcgKgotaTkxNV9yZXNlcnZlX2ZlbmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQor
c3RydWN0IGk5MTVfZmVuY2VfcmVnICppOTE1X3Jlc2VydmVfZmVuY2Uoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2U7CisJ
c3RydWN0IGk5MTVfZmVuY2VfcmVnICpmZW5jZTsKIAlpbnQgY291bnQ7CiAJaW50IHJldDsKIApA
QCAtNDE1LDcgKzQxNCw3IEBAIGk5MTVfcmVzZXJ2ZV9mZW5jZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKIAogCS8qIEtlZXAgYXQgbGVhc3Qgb25lIGZlbmNlIGF2YWlsYWJsZSBmb3Ig
dGhlIGRpc3BsYXkgZW5naW5lLiAqLwogCWNvdW50ID0gMDsKLQlsaXN0X2Zvcl9lYWNoX2VudHJ5
KGZlbmNlLCAmaTkxNS0+bW0uZmVuY2VfbGlzdCwgbGluaykKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5
KGZlbmNlLCAmaTkxNS0+Z2d0dC5mZW5jZV9saXN0LCBsaW5rKQogCQljb3VudCArPSAhZmVuY2Ut
PnBpbl9jb3VudDsKIAlpZiAoY291bnQgPD0gMSkKIAkJcmV0dXJuIEVSUl9QVFIoLUVOT1NQQyk7
CkBAIC00NDEsMTEgKzQ0MCwxMSBAQCBpOTE1X3Jlc2VydmVfZmVuY2Uoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCiAgKgogICogVGhpcyBmdW5jdGlvbiBhZGQgYSByZXNlcnZlZCBmZW5j
ZSByZWdpc3RlciBmcm9tIHZHUFUgdG8gdGhlIGZlbmNlX2xpc3QuCiAgKi8KLXZvaWQgaTkxNV91
bnJlc2VydmVfZmVuY2Uoc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2UpCit2b2lkIGk5
MTVfdW5yZXNlcnZlX2ZlbmNlKHN0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2UpCiB7CiAJbG9j
a2RlcF9hc3NlcnRfaGVsZCgmZmVuY2UtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCi0JbGlz
dF9hZGQoJmZlbmNlLT5saW5rLCAmZmVuY2UtPmk5MTUtPm1tLmZlbmNlX2xpc3QpOworCWxpc3Rf
YWRkKCZmZW5jZS0+bGluaywgJmZlbmNlLT5pOTE1LT5nZ3R0LmZlbmNlX2xpc3QpOwogfQogCiAv
KioKQEAgLTQ2MSw4ICs0NjAsOCBAQCB2b2lkIGk5MTVfZ2VtX3Jlc3RvcmVfZmVuY2VzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWludCBpOwogCiAJcmN1X3JlYWRfbG9jaygpOyAv
KiBrZWVwIG9iaiBhbGl2ZSBhcyB3ZSBkZXJlZmVyZW5jZSAqLwotCWZvciAoaSA9IDA7IGkgPCBp
OTE1LT5udW1fZmVuY2VfcmVnczsgaSsrKSB7Ci0JCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcg
KnJlZyA9ICZpOTE1LT5mZW5jZV9yZWdzW2ldOworCWZvciAoaSA9IDA7IGkgPCBpOTE1LT5nZ3R0
Lm51bV9mZW5jZXM7IGkrKykgeworCQlzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKnJlZyA9ICZpOTE1
LT5nZ3R0LmZlbmNlX3JlZ3NbaV07CiAJCXN0cnVjdCBpOTE1X3ZtYSAqdm1hID0gUkVBRF9PTkNF
KHJlZy0+dm1hKTsKIAogCQlHRU1fQlVHX09OKHZtYSAmJiB2bWEtPmZlbmNlICE9IHJlZyk7CkBA
IC01MzQsOCArNTMzLDcgQEAgdm9pZCBpOTE1X2dlbV9yZXN0b3JlX2ZlbmNlcyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKICAqIERldGVjdHMgYml0IDYgc3dpenpsaW5nIG9mIGFkZHJl
c3MgbG9va3VwIGJldHdlZW4gSUdEIGFjY2VzcyBhbmQgQ1BVCiAgKiBhY2Nlc3MgdGhyb3VnaCBt
YWluIG1lbW9yeS4KICAqLwotdm9pZAotaTkxNV9nZW1fZGV0ZWN0X2JpdF82X3N3aXp6bGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0aWMgdm9pZCBkZXRlY3RfYml0XzZfc3dp
enpsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKIAlzdHJ1Y3QgaW50ZWxfdW5j
b3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwogCXUzMiBzd2l6emxlX3ggPSBJOTE1X0JJVF82
X1NXSVpaTEVfVU5LTk9XTjsKQEAgLTcwOCw4ICs3MDYsNyBAQCBpOTE1X2dlbV9kZXRlY3RfYml0
XzZfc3dpenpsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKICAqIGJpdCAxNyBvZiBp
dHMgcGh5c2ljYWwgYWRkcmVzcyBhbmQgdGhlcmVmb3JlIGJlaW5nIGludGVycHJldGVkIGRpZmZl
cmVudGx5CiAgKiBieSB0aGUgR1BVLgogICovCi1zdGF0aWMgdm9pZAotaTkxNV9nZW1fc3dpenps
ZV9wYWdlKHN0cnVjdCBwYWdlICpwYWdlKQorc3RhdGljIHZvaWQgaTkxNV9nZW1fc3dpenpsZV9w
YWdlKHN0cnVjdCBwYWdlICpwYWdlKQogewogCWNoYXIgdGVtcFs2NF07CiAJY2hhciAqdmFkZHI7
CkBAIC03OTgsMyArNzk1LDQyIEBAIGk5MTVfZ2VtX29iamVjdF9zYXZlX2JpdF8xN19zd2l6emxl
KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCWkrKzsKIAl9CiB9CisKK3ZvaWQg
aTkxNV9nZ3R0X2luaXRfZmVuY2VzKHN0cnVjdCBpOTE1X2dndHQgKmdndHQpCit7CisJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBnZ3R0LT52bS5pOTE1OworCWludCBudW1fZmVuY2Vz
OworCWludCBpOworCisJSU5JVF9MSVNUX0hFQUQoJmdndHQtPmZlbmNlX2xpc3QpOworCUlOSVRf
TElTVF9IRUFEKCZnZ3R0LT51c2VyZmF1bHRfbGlzdCk7CisJaW50ZWxfd2FrZXJlZl9hdXRvX2lu
aXQoJmdndHQtPnVzZXJmYXVsdF93YWtlcmVmLCBpOTE1KTsKKworCWRldGVjdF9iaXRfNl9zd2l6
emxlKGk5MTUpOworCisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA3ICYmCisJICAgICEoSVNfVkFM
TEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSkKKwkJbnVtX2ZlbmNlcyA9IDMy
OworCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0IHx8CisJCSBJU19JOTQ1RyhpOTE1KSB8
fCBJU19JOTQ1R00oaTkxNSkgfHwKKwkJIElTX0czMyhpOTE1KSB8fCBJU19QSU5FVklFVyhpOTE1
KSkKKwkJbnVtX2ZlbmNlcyA9IDE2OworCWVsc2UKKwkJbnVtX2ZlbmNlcyA9IDg7CisKKwlpZiAo
aW50ZWxfdmdwdV9hY3RpdmUoaTkxNSkpCisJCW51bV9mZW5jZXMgPSBpbnRlbF91bmNvcmVfcmVh
ZCgmaTkxNS0+dW5jb3JlLAorCQkJCQkgICAgICAgdmd0aWZfcmVnKGF2YWlsX3JzLmZlbmNlX251
bSkpOworCisJLyogSW5pdGlhbGl6ZSBmZW5jZSByZWdpc3RlcnMgdG8gemVybyAqLworCWZvciAo
aSA9IDA7IGkgPCBudW1fZmVuY2VzOyBpKyspIHsKKwkJc3RydWN0IGk5MTVfZmVuY2VfcmVnICpm
ZW5jZSA9ICZnZ3R0LT5mZW5jZV9yZWdzW2ldOworCisJCWZlbmNlLT5pOTE1ID0gaTkxNTsKKwkJ
ZmVuY2UtPmlkID0gaTsKKwkJbGlzdF9hZGRfdGFpbCgmZmVuY2UtPmxpbmssICZnZ3R0LT5mZW5j
ZV9saXN0KTsKKwl9CisJZ2d0dC0+bnVtX2ZlbmNlcyA9IG51bV9mZW5jZXM7CisKKwlpOTE1X2dl
bV9yZXN0b3JlX2ZlbmNlcyhpOTE1KTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1f
ZmVuY2VfcmVnLmgKaW5kZXggMDlkY2FmMTQxMjFiLi5kMmRhOTg4MjgxNzkgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5oCkBAIC0yNiwxMyArMjYsMTcgQEAKICNk
ZWZpbmUgX19JOTE1X0ZFTkNFX1JFR19IX18KIAogI2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4KKyNp
bmNsdWRlIDxsaW51eC90eXBlcy5oPgogCitzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdDsKIHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlOworc3RydWN0IGk5MTVfZ2d0dDsKIHN0cnVjdCBpOTE1X3Zt
YTsKK3N0cnVjdCBzZ190YWJsZTsKIAogI2RlZmluZSBJOTY1X0ZFTkNFX1BBR0UgNDA5NlVMCiAK
LXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgeworc3RydWN0IGk5MTVfZmVuY2VfcmVnIHsKIAlz
dHJ1Y3QgbGlzdF9oZWFkIGxpbms7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7CiAJ
c3RydWN0IGk5MTVfdm1hICp2bWE7CkBAIC00OSw0ICs1MywxNyBAQCBzdHJ1Y3QgZHJtX2k5MTVf
ZmVuY2VfcmVnIHsKIAlib29sIGRpcnR5OwogfTsKIAorLyogaTkxNV9nZW1fZmVuY2VfcmVnLmMg
Ki8KK3N0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqaTkxNV9yZXNlcnZlX2ZlbmNlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKK3ZvaWQgaTkxNV91bnJlc2VydmVfZmVuY2Uoc3RydWN0IGk5
MTVfZmVuY2VfcmVnICpmZW5jZSk7CisKK3ZvaWQgaTkxNV9nZW1fcmVzdG9yZV9mZW5jZXMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOworCit2b2lkIGk5MTVfZ2VtX29iamVjdF9kb19i
aXRfMTdfc3dpenpsZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAorCQkJCSAgICAg
ICBzdHJ1Y3Qgc2dfdGFibGUgKnBhZ2VzKTsKK3ZvaWQgaTkxNV9nZW1fb2JqZWN0X3NhdmVfYml0
XzE3X3N3aXp6bGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKKwkJCQkJIHN0cnVj
dCBzZ190YWJsZSAqcGFnZXMpOworCit2b2lkIGk5MTVfZ2d0dF9pbml0X2ZlbmNlcyhzdHJ1Y3Qg
aTkxNV9nZ3R0ICpnZ3R0KTsKKwogI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbV9ndHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5j
CmluZGV4IDVmNzI2OGMzM2FjMC4uZjhiZjcyYWY3ZDUxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dlbV9ndHQuYwpAQCAtMzUzOCw2ICszNTM4LDggQEAgaW50IGk5MTVfZ2d0dF9pbml0X2h3KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogCWdndHQtPm10cnIgPSBhcmNoX3Bo
eXNfd2NfYWRkKGdndHQtPmdtYWRyLnN0YXJ0LCBnZ3R0LT5tYXBwYWJsZV9lbmQpOwogCisJaTkx
NV9nZ3R0X2luaXRfZmVuY2VzKGdndHQpOworCiAJLyoKIAkgKiBJbml0aWFsaXNlIHN0b2xlbiBl
YXJseSBzbyB0aGF0IHdlIG1heSByZXNlcnZlIHByZWFsbG9jYXRlZAogCSAqIG9iamVjdHMgZm9y
IHRoZSBCSU9TIHRvIEtNUyB0cmFuc2l0aW9uLgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW1fZ3R0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQu
aAppbmRleCA4OTQzN2QwYTcyMWMuLjYzZmEzNTdjNjlkZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9nZW1fZ3R0LmgKQEAgLTM5LDYgKzM5LDcgQEAKICNpbmNsdWRlIDxsaW51eC9wYWdldmVjLmg+
CiAKICNpbmNsdWRlICJndC9pbnRlbF9yZXNldC5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX2ZlbmNl
X3JlZy5oIgogI2luY2x1ZGUgImk5MTVfcmVxdWVzdC5oIgogI2luY2x1ZGUgImk5MTVfc2NhdHRl
cmxpc3QuaCIKICNpbmNsdWRlICJpOTE1X3NlbGZ0ZXN0LmgiCkBAIC02MSw3ICs2Miw2IEBACiAj
ZGVmaW5lIEk5MTVfTUFYX05VTV9GRU5DRV9CSVRTIDYKIAogc3RydWN0IGRybV9pOTE1X2ZpbGVf
cHJpdmF0ZTsKLXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWc7CiBzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdDsKIHN0cnVjdCBpOTE1X3ZtYTsKIApAQCAtNDA4LDYgKzQwOCwxOCBAQCBzdHJ1Y3Qg
aTkxNV9nZ3R0IHsKIAogCXUzMiBwaW5fYmlhczsKIAorCXVuc2lnbmVkIGludCBudW1fZmVuY2Vz
OworCXN0cnVjdCBpOTE1X2ZlbmNlX3JlZyBmZW5jZV9yZWdzW0k5MTVfTUFYX05VTV9GRU5DRVNd
OworCXN0cnVjdCBsaXN0X2hlYWQgZmVuY2VfbGlzdDsKKworCS8qKiBMaXN0IG9mIGFsbCBvYmpl
Y3RzIGluIGd0dF9zcGFjZSwgY3VycmVudGx5IG1tYXBlZCBieSB1c2Vyc3BhY2UuCisJICogQWxs
IG9iamVjdHMgd2l0aGluIHRoaXMgbGlzdCBtdXN0IGFsc28gYmUgb24gYm91bmRfbGlzdC4KKwkg
Ki8KKwlzdHJ1Y3QgbGlzdF9oZWFkIHVzZXJmYXVsdF9saXN0OworCisJLyogTWFudWFsIHJ1bnRp
bWUgcG0gYXV0b3N1c3BlbmQgZGVsYXkgZm9yIHVzZXIgR0dUVCBtbWFwcyAqLworCXN0cnVjdCBp
bnRlbF93YWtlcmVmX2F1dG8gdXNlcmZhdWx0X3dha2VyZWY7CisKIAlzdHJ1Y3QgZHJtX21tX25v
ZGUgZXJyb3JfY2FwdHVyZTsKIAlzdHJ1Y3QgZHJtX21tX25vZGUgdWNfZnc7CiB9OwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMKaW5kZXggZGMwMjZkNWNkN2EwLi44YjBiNmI4YzI1
M2QgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYwpAQCAtMTEyNywxNyArMTEy
NywxNyBAQCBzdGF0aWMgdm9pZCBnZW1fcmVjb3JkX2ZlbmNlcyhzdHJ1Y3QgaTkxNV9ncHVfc3Rh
dGUgKmVycm9yKQogCWludCBpOwogCiAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikgewot
CQlmb3IgKGkgPSAwOyBpIDwgZGV2X3ByaXYtPm51bV9mZW5jZV9yZWdzOyBpKyspCisJCWZvciAo
aSA9IDA7IGkgPCBkZXZfcHJpdi0+Z2d0dC5udW1fZmVuY2VzOyBpKyspCiAJCQllcnJvci0+ZmVu
Y2VbaV0gPQogCQkJCWludGVsX3VuY29yZV9yZWFkNjQodW5jb3JlLAogCQkJCQkJICAgIEZFTkNF
X1JFR19HRU42X0xPKGkpKTsKIAl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkg
ewotCQlmb3IgKGkgPSAwOyBpIDwgZGV2X3ByaXYtPm51bV9mZW5jZV9yZWdzOyBpKyspCisJCWZv
ciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+Z2d0dC5udW1fZmVuY2VzOyBpKyspCiAJCQllcnJvci0+
ZmVuY2VbaV0gPQogCQkJCWludGVsX3VuY29yZV9yZWFkNjQodW5jb3JlLAogCQkJCQkJICAgIEZF
TkNFX1JFR185NjVfTE8oaSkpOwogCX0gZWxzZSB7Ci0JCWZvciAoaSA9IDA7IGkgPCBkZXZfcHJp
di0+bnVtX2ZlbmNlX3JlZ3M7IGkrKykKKwkJZm9yIChpID0gMDsgaSA8IGRldl9wcml2LT5nZ3R0
Lm51bV9mZW5jZXM7IGkrKykKIAkJCWVycm9yLT5mZW5jZVtpXSA9CiAJCQkJaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBGRU5DRV9SRUcoaSkpOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfdm1hLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5oCmlu
ZGV4IDBjNTdhYjRmZWQ1ZC4uNGI3NjlkYjY0OWJmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3ZtYS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmgK
QEAgLTU0LDcgKzU0LDcgQEAgc3RydWN0IGk5MTVfdm1hIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqOwogCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwogCWNvbnN0IHN0
cnVjdCBpOTE1X3ZtYV9vcHMgKm9wczsKLQlzdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVnICpmZW5j
ZTsKKwlzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKmZlbmNlOwogCXN0cnVjdCByZXNlcnZhdGlvbl9v
YmplY3QgKnJlc3Y7IC8qKiBBbGlhcyBvZiBvYmotPnJlc3YgKi8KIAlzdHJ1Y3Qgc2dfdGFibGUg
KnBhZ2VzOwogCXZvaWQgX19pb21lbSAqaW9tYXA7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QK
SW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

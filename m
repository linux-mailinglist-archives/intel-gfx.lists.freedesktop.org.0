Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 44D8046325
	for <lists+intel-gfx@lfdr.de>; Fri, 14 Jun 2019 17:43:36 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F25A189ACC;
	Fri, 14 Jun 2019 15:43:32 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EB040892F8
 for <intel-gfx@lists.freedesktop.org>; Thu, 13 Jun 2019 16:23:40 +0000 (UTC)
X-Amp-Result: UNSCANNABLE
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 13 Jun 2019 09:23:21 -0700
X-ExtLoop1: 1
Received: from rdvivi-losangeles.jf.intel.com (HELO intel.com) ([10.7.196.65])
 by orsmga003.jf.intel.com with ESMTP; 13 Jun 2019 09:23:17 -0700
Date: Thu, 13 Jun 2019 09:23:49 -0700
From: Rodrigo Vivi <rodrigo.vivi@intel.com>
To: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Message-ID: <20190613162349.GJ29428@intel.com>
References: <20190612162900.13777-1-lucas.demarchi@intel.com>
 <0000a4b2-ac8b-a18d-4c78-0db197c712a1@linux.intel.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <0000a4b2-ac8b-a18d-4c78-0db197c712a1@linux.intel.com>
User-Agent: Mutt/1.11.3 (2019-02-01)
X-Mailman-Approved-At: Fri, 14 Jun 2019 15:43:17 +0000
Subject: Re: [Intel-gfx] [PATCH] gpu/drm/i915: globally replace dev_priv
 with i915
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org, Lucas De Marchi <lucas.demarchi@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gVGh1LCBKdW4gMTMsIDIwMTkgYXQgMDQ6MTI6MTZQTSArMDEwMCwgVHZydGtvIFVyc3VsaW4g
d3JvdGU6Cj4gCj4gT24gMTIvMDYvMjAxOSAxNzoyOSwgTHVjYXMgRGUgTWFyY2hpIHdyb3RlOgo+
ID4gV2UgYXJlIHNsb3dseSBjb252ZXJ0aW5nIGRldl9wcml2IHRvIGk5MTUgZXZlcnl3aGVyZSwg
c3ByZWFkIGludG8KPiA+IHNtYWxsZXIgc2VyaWVzLiBXaGlsZSB0aGlzIGlzIGdvb2QgdG8gYXZv
aWQgdW5yZWxhdGVkIGJyZWFrYWdlcyB0byBvdGhlcgo+ID4gaW5mbGlnaHQgcGF0Y2hlcywgaXQn
cyBiYWQgYmVjYXVzZSBpbmZsaWdodCBwYXRjaGVzIG9uIG5lYXJieSBwYXRocyBrZWVwCj4gPiBi
cmVha2luZy4gUGFpcmVkIHdpdGggb3RoZXIgY29kZSBtb3ZlcyBhbmQgcmVmYWN0b3JlcyB0aGlz
IGlzIGJlY29taW5nIGEKPiA+IG5pZ2h0bWFyZS4KPiA+IAo+ID4gTm93IHRoYXQgSTkxNV97UkVB
RCxXUklURX0gYXJlIGdvbmUgYW5kIGltcGxpY2l0IGFjY2VzcyB0byBkZXZfcHJpdiBubwo+IAo+
IFdobyByZW1vdmVkIEk5MTVfUkVBRC9XUklURT8gSW4gZmFjdCBJIHNlZSBzb21lIGluIHRoaXMg
cGF0Y2guIFdlbGwgY29sb3VyCj4gbWUgY29uZnVzZWQuLiBob3cgZGlkIHRoZSBwYXRjaCBjb21w
aWxlPwoKYXMgc29vbiBhcyB0aGlzIGJlY29tZXMgdHJ1ZSBJIGFncmVlIHdpdGggTHVjYXMgdGhh
dCB0aGUgYmlnIHNlZCBpcyB0aGUKYmVzdCBzb2x1dGlvbi4KCj4gCj4gUGx1cyBpdCdzIG5vdCBJ
OTE1X1JFQUQvV1JJVEUgLSBzb21lIGRpc3BsYXkgbWFjcm9zIGhhdmUgaGlkZGVuIGRlcGVuZGVu
Y3kKPiBvbiBpbXBsaWNpdCBkZXZfcHJpdiBhcyB3ZWxsLgo+IAo+ID4gbG9uZ2VyIGV4aXN0cyB3
ZSBjYW4gc2ltcGx5IHNlZCBhbGwgZmlsZXMgYW5kIGJlIGRvbmUgd2l0aCB0aGUKPiA+IGNvbnZl
cnNpb24uIFRoaXMgd2FzIGdlbmVyYXRlZCB3aXRoIHRoZSBmb2xsb3dpbmcgY29tbWFuZHMgd2l0
aCBubwo+ID4gYWRkaXRpb25hbCBmaXh1cHM6Cj4gPiAKPiA+IAlnaXQgbHMtZmlsZXMgLS1mdWxs
LW5hbWUgLXogLS0gZHJpdmVycy9ncHUvZHJtL2k5MTUvIHwgXAo+ID4gCQl4YXJncyAtMCBzZWQg
LWkgJ3MvXGJkZXZfcHJpdlxiL2k5MTUvZycKPiA+IAo+ID4gQW55IHBlbmRpbmcgc2VyaWVzIGNh
biBhcHBseSB0aGUgc2FtZSBzZWFyY2ggYW5kIHJlcGxhY2Ugd2hlbiByZWJhc2luZy4KPiAKPiBJ
IGFtIGluIHR3byBtaW5kcy4gQ29udmVydGluZyBwaWVjZSBtZWFsIGlzIGVhc2llciBmb3Igc29t
ZSB1c2UgY2FzZXMsIGFuZAo+IGNvbnZlcnRpbmcgYWxsIGF0IG9uY2UgaXMgZWFzaWVyIGZvciBz
b21lIG90aGVycy4gRG9uJ3Qga25vdy4KPiAKPiBSZWdhcmRzLAo+IAo+IFR2cnRrbwo+IAo+ID4g
Cj4gPiBTaWduZWQtb2ZmLWJ5OiBMdWNhcyBEZSBNYXJjaGkgPGx1Y2FzLmRlbWFyY2hpQGludGVs
LmNvbT4KPiA+IC0tLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9fY2g3MDE3LmMgICAg
ICAgICAgICAgfCAgICA2ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2R2b19jaDd4eHgu
YyAgICAgICAgICAgICB8ICAgMTAgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX2l2
Y2guYyAgICAgICAgICAgICAgIHwgICAxNCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
dm9fbnMyNTAxLmMgICAgICAgICAgICAgfCAgIDE0ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2R2b19zaWwxNjQuYyAgICAgICAgICAgICB8ICAgMTAgKy0KPiA+ICAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZHZvX3RmcDQxMC5jICAgICAgICAgICAgIHwgICAxMCArLQo+ID4gICBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jICAgfCAgIDQ4ICstCj4gPiAgIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmggICB8ICAgIDYgKy0KPiA+
ICAgLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jICAgIHwgICAgNCAr
LQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMgICAgfCAg
ICA0ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaG1lbS5jICAg
ICB8ICAgIDQgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3N0b2xl
bi5jICAgIHwgIDE2OCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
dGlsaW5nLmMgICAgfCAgICA4ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV91c2VycHRyLmMgICB8ICAgNDAgKy0KPiA+ICAgLi4uL2dwdS9kcm0vaTkxNS9nZW0vc2Vs
ZnRlc3RzL2h1Z2VfcGFnZXMuYyAgIHwgICA0OCArLQo+ID4gICAuLi4vZHJtL2k5MTUvZ2VtL3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMgfCAgICA2ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oICAgICAgICB8ICAgIDIgKy0KPiA+ICAgZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgICAgIHwgICA2NiArLQo+ID4gICBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYyAgICAgfCAgIDM2ICstCj4gPiAg
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3MuYyAgICAgICAgICB8ICAgMjQgKy0K
PiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbW9jcy5oICAgICAgICAgIHwgICAg
MiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jICAgICAgICAg
fCAgICA2ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIu
YyAgICB8ICAgNTIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2FwZXJ0dXJlX2dt
LmMgICAgICAgIHwgICA2MCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvY2ZnX3Nw
YWNlLmMgICAgICAgICAgfCAgICA0ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9j
bWRfcGFyc2VyLmMgICAgICAgICB8ICAgMzQgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Z0L2RlYnVnZnMuYyAgICAgICAgICAgIHwgICAxMiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvZGlzcGxheS5jICAgICAgICAgICAgfCAgIDQ4ICstCj4gPiAgIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d2dC9kbWFidWYuYyAgICAgICAgICAgICB8ICAgMTIgKy0KPiA+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Z0L2VkaWQuYyAgICAgICAgICAgICAgIHwgICAgNiArLQo+ID4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZXhlY2xpc3QuYyAgICAgICAgICAgfCAgIDE0ICstCj4g
PiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9mYl9kZWNvZGVyLmMgICAgICAgICB8ICAgMTIg
Ky0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2Zpcm13YXJlLmMgICAgICAgICAgIHwg
ICAxNiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3R0LmMgICAgICAgICAgICAg
ICAgfCAgIDQ0ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuYyAgICAgICAg
ICAgICAgICB8ICAgMjYgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5oICAg
ICAgICAgICAgICAgIHwgICAyMCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvaGFu
ZGxlcnMuYyAgICAgICAgICAgfCAgIDkyICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2
dC9pbnRlcnJ1cHQuYyAgICAgICAgICB8ICAgIDYgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L2t2bWd0LmMgICAgICAgICAgICAgIHwgICAgNiArLQo+ID4gICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndnQvbW1pby5jICAgICAgICAgICAgICAgfCAgICAyICstCj4gPiAgIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9tbWlvX2NvbnRleHQuYyAgICAgICB8ICAgMzggKy0KPiA+ICAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkX3BvbGljeS5jICAgICAgIHwgICAxMiArLQo+ID4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMgICAgICAgICAgfCAgIDcyICst
Cj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC92Z3B1LmMgICAgICAgICAgICAgICB8ICAg
IDYgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMgICAgICAg
IHwgICAgNiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyAgICAg
ICAgICAgfCAgOTUyICsrKy0tLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVn
ZnMuaCAgICAgICAgICAgfCAgICA0ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmMgICAgICAgICAgICAgICB8IDEwOTIgKysrLS0tCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAgICB8ICA1OTAgKystLQo+ID4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dlbS5jICAgICAgICAgICAgICAgfCAgMzU2ICstCj4gPiAgIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2V2aWN0LmMgICAgICAgICB8ICAgIDYgKy0KPiA+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgICAgICAgICAgIHwgIDIxNCArLQo+
ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuaCAgICAgICAgICAgfCAgIDIw
ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMgICAgICAgICB8
ICAgNDQgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuaCAgICAg
ICAgIHwgICAgNiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jICAgICAg
ICAgICAgICAgfCAxODA4ICsrKysrLS0tLS0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9pcnEuaCAgICAgICAgICAgICAgIHwgICA4NiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X21lbWNweS5jICAgICAgICAgICAgfCAgICAyICstCj4gPiAgIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfb2FfYmR3LmMgICAgICAgICAgICB8ICAgMzIgKy0KPiA+ICAgZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9vYV9iZHcuaCAgICAgICAgICAgIHwgICAgMiArLQo+ID4gICBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2J4dC5jICAgICAgICAgICAgfCAgIDMyICstCj4gPiAg
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfYnh0LmggICAgICAgICAgICB8ICAgIDIgKy0K
PiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9jZmxndDIuYyAgICAgICAgIHwgICAz
MiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0Mi5oICAgICAgICAg
fCAgICAyICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfY2ZsZ3QzLmMgICAg
ICAgICB8ICAgMzIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9jZmxndDMu
aCAgICAgICAgIHwgICAgMiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2No
di5jICAgICAgICAgICAgfCAgIDMyICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
b2FfY2h2LmggICAgICAgICAgICB8ICAgIDIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9vYV9jbmwuYyAgICAgICAgICAgIHwgICAzMiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X29hX2NubC5oICAgICAgICAgICAgfCAgICAyICstCj4gPiAgIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfb2FfZ2xrLmMgICAgICAgICAgICB8ICAgMzIgKy0KPiA+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9nbGsuaCAgICAgICAgICAgIHwgICAgMiArLQo+ID4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2hzdy5jICAgICAgICAgICAgfCAgIDMyICstCj4g
PiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2FfaHN3LmggICAgICAgICAgICB8ICAgIDIg
Ky0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9pY2wuYyAgICAgICAgICAgIHwg
ICAzMiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2ljbC5oICAgICAgICAg
ICAgfCAgICAyICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ffa2JsZ3QyLmMg
ICAgICAgICB8ICAgMzIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9rYmxn
dDIuaCAgICAgICAgIHwgICAgMiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29h
X2tibGd0My5jICAgICAgICAgfCAgIDMyICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfb2Ffa2JsZ3QzLmggICAgICAgICB8ICAgIDIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9vYV9za2xndDIuYyAgICAgICAgIHwgICAzMiArLQo+ID4gICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X29hX3NrbGd0Mi5oICAgICAgICAgfCAgICAyICstCj4gPiAgIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfb2Ffc2tsZ3QzLmMgICAgICAgICB8ICAgMzIgKy0KPiA+ICAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9za2xndDMuaCAgICAgICAgIHwgICAgMiArLQo+ID4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0NC5jICAgICAgICAgfCAgIDMyICst
Cj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfb2Ffc2tsZ3Q0LmggICAgICAgICB8ICAg
IDIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMgICAgICAgICAgICAg
IHwgIDgxNCArKy0tLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jICAgICAg
ICAgICAgICAgfCAgIDQyICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcXVlcnku
YyAgICAgICAgICAgICB8ICAgMTAgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9y
ZWcuaCAgICAgICAgICAgICAgIHwgIDQyMCArLS0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9zdXNwZW5kLmMgICAgICAgICAgIHwgIDEwNiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3N5c2ZzLmMgICAgICAgICAgICAgfCAgMTcyICstCj4gPiAgIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfdHJhY2UuaCAgICAgICAgICAgICB8ICAgNDYgKy0KPiA+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmMgICAgICAgICAgICAgIHwgICAzMCArLQo+ID4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZncHUuaCAgICAgICAgICAgICAgfCAgIDE2ICstCj4g
PiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMgICAgICAgICAgICAgICB8ICAgIDQg
Ky0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaWNsX2RzaS5jICAgICAgICAgICAgICAgIHwg
IDEyMiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9hdG9taWMuYyAgICAgICAg
ICAgfCAgIDI4ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2F0b21pYy5oICAg
ICAgICAgICB8ICAgIDIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXVkaW8u
YyAgICAgICAgICAgIHwgIDIyMiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9h
dWRpby5oICAgICAgICAgICAgfCAgICA2ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2Jpb3MuYyAgICAgICAgICAgICB8ICA1NTIgKystLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9iaW9zLmggICAgICAgICAgICAgfCAgIDE4ICstCj4gPiAgIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2J3LmMgICAgICAgICAgICAgICB8ICAgNjggKy0KPiA+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfYncuaCAgICAgICAgICAgICAgIHwgICAgOCArLQo+ID4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jZGNsay5jICAgICAgICAgICAgfCAgODgyICsrLS0t
Cj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2NkY2xrLmggICAgICAgICAgICB8ICAg
MTQgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY29sb3IuYyAgICAgICAgICAg
IHwgIDE3NiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jb21ib19waHkuYyAg
ICAgICAgfCAgIDY0ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2NvbWJvX3Bo
eS5oICAgICAgICB8ICAgIDYgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY29u
bmVjdG9yLmMgICAgICAgIHwgICAxMiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9jcnQuYyAgICAgICAgICAgICAgfCAgMTcyICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2NydC5oICAgICAgICAgICAgICB8ICAgIDQgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfY3NyLmMgICAgICAgICAgICAgIHwgIDE0NCArLQo+ID4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9kZGkuYyAgICAgICAgICAgICAgfCAgNTkyICsrLS0KPiA+ICAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGRpLmggICAgICAgICAgICAgIHwgICAgNiArLQo+ID4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kZXZpY2VfaW5mby5jICAgICAgfCAgMTY0ICst
Cj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RldmljZV9pbmZvLmggICAgICB8ICAg
IDYgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheS5jICAgICAgICAg
IHwgMjkxNiArKysrKysrKy0tLS0tLS0tLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9kaXNwbGF5LmggICAgICAgICAgfCAgICA2ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2Rpc3BsYXlfcG93ZXIuYyAgICB8IDEwMjAgKysrLS0tCj4gPiAgIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2Rpc3BsYXlfcG93ZXIuaCAgICB8ICAgNjIgKy0KPiA+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfZHAuYyAgICAgICAgICAgICAgIHwgIDgyMiArKy0tLQo+ID4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcC5oICAgICAgICAgICAgICAgfCAgIDE4ICst
Cj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwX2F1eF9iYWNrbGlnaHQuYyB8ICAg
IDQgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHBfbXN0LmMgICAgICAgICAg
IHwgICAzMiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcGlvX3BoeS5jICAg
ICAgICAgfCAgMjc2ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwaW9fcGh5
LmggICAgICAgICB8ICAgMTIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHBs
bF9tZ3IuYyAgICAgICAgIHwgIDM1NiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9kcGxsX21nci5oICAgICAgICAgfCAgIDIwICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2Rydi5oICAgICAgICAgICAgICB8ICAgNzIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfZHNpLmMgICAgICAgICAgICAgIHwgICAgNiArLQo+ID4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9kc2kuaCAgICAgICAgICAgICAgfCAgICA2ICstCj4gPiAgIC4uLi9n
cHUvZHJtL2k5MTUvaW50ZWxfZHNpX2Rjc19iYWNrbGlnaHQuYyAgICB8ICAgIDQgKy0KPiA+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHNpX3ZidC5jICAgICAgICAgIHwgICA3NiArLQo+
ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kdm8uYyAgICAgICAgICAgICAgfCAgIDMy
ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2by5oICAgICAgICAgICAgICB8
ICAgIDIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHZvX2Rldi5oICAgICAg
ICAgIHwgICAgMiArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmMuYyAgICAg
ICAgICAgICAgfCAgNDEwICstLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmMu
aCAgICAgICAgICAgICAgfCAgIDIwICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2ZiZGV2LmMgICAgICAgICAgICB8ICAgNDYgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZmJkZXYuaCAgICAgICAgICAgIHwgICAgOCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9maWZvX3VuZGVycnVuLmMgICAgfCAgMTYwICstCj4gPiAgIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2ZpZm9fdW5kZXJydW4uaCAgICB8ICAgMTIgKy0KPiA+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfZnJvbnRidWZmZXIuYyAgICAgIHwgICA4MiArLQo+ID4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mcm9udGJ1ZmZlci5oICAgICAgfCAgICA2ICstCj4g
PiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2dtYnVzLmMgICAgICAgICAgICB8ICAyMzAg
Ky0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ21idXMuaCAgICAgICAgICAgIHwg
ICAxMCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWMuYyAgICAgICAgICAg
ICAgfCAgIDQ4ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19hZHMuYyAg
ICAgICAgICB8ICAgMTIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Z3
LmMgICAgICAgICAgIHwgICAyMCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9n
dWNfbG9nLmMgICAgICAgICAgfCAgIDE4ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2d1Y19zdWJtaXNzaW9uLmMgICB8ICAgNTYgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfZ3Z0LmMgICAgICAgICAgICAgIHwgICAzNiArLQo+ID4gICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9ndnQuaCAgICAgICAgICAgICAgfCAgIDE2ICstCj4gPiAgIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2hkY3AuYyAgICAgICAgICAgICB8ICAyODYgKy0KPiA+ICAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaGRjcC5oICAgICAgICAgICAgIHwgICAgNiArLQo+ID4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9oZG1pLmMgICAgICAgICAgICAgfCAgMzE2ICst
Cj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hkbWkuaCAgICAgICAgICAgICB8ICAg
IDIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaG90cGx1Zy5jICAgICAgICAg
IHwgIDIxMCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ob3RwbHVnLmggICAg
ICAgICAgfCAgIDE2ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2h1Yy5jICAg
ICAgICAgICAgICB8ICAgIDYgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaHVj
X2Z3LmMgICAgICAgICAgIHwgICAxOCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9scGVfYXVkaW8uYyAgICAgICAgfCAgIDk2ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2xwZV9hdWRpby5oICAgICAgICB8ICAgIDggKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfbHNwY29uLmMgICAgICAgICAgIHwgICAgNCArLQo+ID4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9sdmRzLmMgICAgICAgICAgICAgfCAgIDk2ICstCj4gPiAgIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX2x2ZHMuaCAgICAgICAgICAgICB8ICAgIDggKy0KPiA+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ByZWdpb24uYyAgICAgICAgIHwgIDExNCArLQo+
ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vcHJlZ2lvbi5oICAgICAgICAgfCAgIDI4
ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX292ZXJsYXkuYyAgICAgICAgICB8
ICAgOTggKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ZlcmxheS5oICAgICAg
ICAgIHwgICAgOCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wYW5lbC5jICAg
ICAgICAgICAgfCAgMjM4ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BpcGVf
Y3JjLmMgICAgICAgICB8ICAxMjAgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
cGlwZV9jcmMuaCAgICAgICAgIHwgICAgNCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9wbS5jICAgICAgICAgICAgICAgfCAyMzAwICsrKysrKy0tLS0tLS0KPiA+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uaCAgICAgICAgICAgICAgIHwgICA3NCArLQo+ID4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wc3IuYyAgICAgICAgICAgICAgfCAgMzk0ICstLQo+
ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wc3IuaCAgICAgICAgICAgICAgfCAgIDE0
ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3F1aXJrcy5oICAgICAgICAgICB8
ICAgIDIgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGltZV9wbS5oICAg
ICAgIHwgICAgOCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9zZHZvLmMgICAg
ICAgICAgICAgfCAgMTI4ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Nkdm8u
aCAgICAgICAgICAgICB8ICAgIDQgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
c3ByaXRlLmMgICAgICAgICAgIHwgIDIxOCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9zcHJpdGUuaCAgICAgICAgICAgfCAgICA4ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX3R2LmMgICAgICAgICAgICAgICB8ICAgNzIgKy0KPiA+ICAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfdHYuaCAgICAgICAgICAgICAgIHwgICAgMiArLQo+ID4gICBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF91Yy5jICAgICAgICAgICAgICAgfCAgICA0ICstCj4gPiAgIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmggICAgICAgICAgICAgICB8ICAgMjIgKy0KPiA+
ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWNfZncuYyAgICAgICAgICAgIHwgICAxMiAr
LQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91Y19mdy5oICAgICAgICAgICAgfCAg
ICAyICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VuY29yZS5jICAgICAgICAg
ICB8ICAgMjYgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5jb3JlLmggICAg
ICAgICAgIHwgICAgNCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF92YnRfZGVm
cy5oICAgICAgICAgfCAgICAyICstCj4gPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Zk
c2MuYyAgICAgICAgICAgICB8ICAgMTAgKy0KPiA+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfd29wY20uYyAgICAgICAgICAgIHwgICAxNCArLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMgfCAgIDI2ICstCj4gPiAgIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9ndWMuYyAgICB8ICAgNDYgKy0KPiA+ICAgZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX3VuY29yZS5jIHwgICAxMCArLQo+ID4gICBkcml2
ZXJzL2dwdS9kcm0vaTkxNS92bHZfZHNpLmMgICAgICAgICAgICAgICAgfCAgMjIyICstCj4gPiAg
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L3Zsdl9kc2lfcGxsLmMgICAgICAgICAgICB8ICAgODAgKy0K
PiA+ICAgMjAxIGZpbGVzIGNoYW5nZWQsIDEyMDIwIGluc2VydGlvbnMoKyksIDEyMDIwIGRlbGV0
aW9ucygtKQo+ID4gCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX2No
NzAxNy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX2NoNzAxNy5jCj4gPiBpbmRleCA2MDIz
ODBmZTc0ZjMuLmRmNjcwYzhkNWMzMSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2R2b19jaDcwMTcuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX2NoNzAx
Ny5jCj4gPiBAQCAtMjEwLDcgKzIxMCw3IEBAIHN0YXRpYyBib29sIGNoNzAxN19pbml0KHN0cnVj
dCBpbnRlbF9kdm9fZGV2aWNlICpkdm8sCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gICAJZHZv
LT5pMmNfYnVzID0gYWRhcHRlcjsKPiA+IC0JZHZvLT5kZXZfcHJpdiA9IHByaXY7Cj4gPiArCWR2
by0+aTkxNSA9IHByaXY7Cj4gPiAgIAlpZiAoIWNoNzAxN19yZWFkKGR2bywgQ0g3MDE3X0RFVklD
RV9JRCwgJnZhbCkpCj4gPiAgIAkJZ290byBmYWlsOwo+ID4gQEAgLTM5NSwxMSArMzk1LDExIEBA
IGRvIHsJCQkJCQkJXAo+ID4gICBzdGF0aWMgdm9pZCBjaDcwMTdfZGVzdHJveShzdHJ1Y3QgaW50
ZWxfZHZvX2RldmljZSAqZHZvKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBjaDcwMTdfcHJpdiAqcHJp
diA9IGR2by0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBjaDcwMTdfcHJpdiAqcHJpdiA9IGR2by0+
aTkxNTsKPiA+ICAgCWlmIChwcml2KSB7Cj4gPiAgIAkJa2ZyZWUocHJpdik7Cj4gPiAtCQlkdm8t
PmRldl9wcml2ID0gTlVMTDsKPiA+ICsJCWR2by0+aTkxNSA9IE5VTEw7Cj4gPiAgIAl9Cj4gPiAg
IH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9fY2g3eHh4LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9fY2g3eHh4LmMKPiA+IGluZGV4IGUwNzBiZWJlZTdiNS4u
ZTA3NjgwMWQwMzJmIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX2No
N3h4eC5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9fY2g3eHh4LmMKPiA+IEBA
IC0xMzUsNyArMTM1LDcgQEAgc3RhdGljIGNoYXIgKmNoN3h4eF9nZXRfZGlkKHU4IGRpZCkKPiA+
ICAgLyoqIFJlYWRzIGFuIDggYml0IHJlZ2lzdGVyICovCj4gPiAgIHN0YXRpYyBib29sIGNoN3h4
eF9yZWFkYihzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLCBpbnQgYWRkciwgdTggKmNoKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBjaDd4eHhfcHJpdiAqY2g3eHh4ID0gZHZvLT5kZXZfcHJpdjsK
PiA+ICsJc3RydWN0IGNoN3h4eF9wcml2ICpjaDd4eHggPSBkdm8tPmk5MTU7Cj4gPiAgIAlzdHJ1
Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIgPSBkdm8tPmkyY19idXM7Cj4gPiAgIAl1OCBvdXRfYnVm
WzJdOwo+ID4gICAJdTggaW5fYnVmWzJdOwo+ID4gQEAgLTE3Myw3ICsxNzMsNyBAQCBzdGF0aWMg
Ym9vbCBjaDd4eHhfcmVhZGIoc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bywgaW50IGFkZHIs
IHU4ICpjaCkKPiA+ICAgLyoqIFdyaXRlcyBhbiA4IGJpdCByZWdpc3RlciAqLwo+ID4gICBzdGF0
aWMgYm9vbCBjaDd4eHhfd3JpdGViKHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8sIGludCBh
ZGRyLCB1OCBjaCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgY2g3eHh4X3ByaXYgKmNoN3h4eCA9IGR2
by0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBjaDd4eHhfcHJpdiAqY2g3eHh4ID0gZHZvLT5pOTE1
Owo+ID4gICAJc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0gZHZvLT5pMmNfYnVzOwo+ID4g
ICAJdTggb3V0X2J1ZlsyXTsKPiA+ICAgCXN0cnVjdCBpMmNfbXNnIG1zZyA9IHsKPiA+IEBAIC0y
MTAsNyArMjEwLDcgQEAgc3RhdGljIGJvb2wgY2g3eHh4X2luaXQoc3RydWN0IGludGVsX2R2b19k
ZXZpY2UgKmR2bywKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAlkdm8tPmkyY19idXMgPSBh
ZGFwdGVyOwo+ID4gLQlkdm8tPmRldl9wcml2ID0gY2g3eHh4Owo+ID4gKwlkdm8tPmk5MTUgPSBj
aDd4eHg7Cj4gPiAgIAljaDd4eHgtPnF1aWV0ID0gdHJ1ZTsKPiA+ICAgCWlmICghY2g3eHh4X3Jl
YWRiKGR2bywgQ0g3eHh4X1JFR19WSUQsICZ2ZW5kb3IpKQo+ID4gQEAgLTM0NywxMSArMzQ3LDEx
IEBAIHN0YXRpYyB2b2lkIGNoN3h4eF9kdW1wX3JlZ3Moc3RydWN0IGludGVsX2R2b19kZXZpY2Ug
KmR2bykKPiA+ICAgc3RhdGljIHZvaWQgY2g3eHh4X2Rlc3Ryb3koc3RydWN0IGludGVsX2R2b19k
ZXZpY2UgKmR2bykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgY2g3eHh4X3ByaXYgKmNoN3h4eCA9IGR2
by0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBjaDd4eHhfcHJpdiAqY2g3eHh4ID0gZHZvLT5pOTE1
Owo+ID4gICAJaWYgKGNoN3h4eCkgewo+ID4gICAJCWtmcmVlKGNoN3h4eCk7Cj4gPiAtCQlkdm8t
PmRldl9wcml2ID0gTlVMTDsKPiA+ICsJCWR2by0+aTkxNSA9IE5VTEw7Cj4gPiAgIAl9Cj4gPiAg
IH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9faXZjaC5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZHZvX2l2Y2guYwo+ID4gaW5kZXggMDlkYmEzNWYzZmZhLi5jOTlj
MTYyMTE1NjcgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9faXZjaC5j
Cj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kdm9faXZjaC5jCj4gPiBAQCAtMTkxLDcg
KzE5MSw3IEBAIHN0YXRpYyB2b2lkIGl2Y2hfZHVtcF9yZWdzKHN0cnVjdCBpbnRlbF9kdm9fZGV2
aWNlICpkdm8pOwo+ID4gICAgKi8KPiA+ICAgc3RhdGljIGJvb2wgaXZjaF9yZWFkKHN0cnVjdCBp
bnRlbF9kdm9fZGV2aWNlICpkdm8sIGludCBhZGRyLCB1MTYgKmRhdGEpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGl2Y2hfcHJpdiAqcHJpdiA9IGR2by0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBpdmNo
X3ByaXYgKnByaXYgPSBkdm8tPmk5MTU7Cj4gPiAgIAlzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0
ZXIgPSBkdm8tPmkyY19idXM7Cj4gPiAgIAl1OCBvdXRfYnVmWzFdOwo+ID4gICAJdTggaW5fYnVm
WzJdOwo+ID4gQEAgLTIzNCw3ICsyMzQsNyBAQCBzdGF0aWMgYm9vbCBpdmNoX3JlYWQoc3RydWN0
IGludGVsX2R2b19kZXZpY2UgKmR2bywgaW50IGFkZHIsIHUxNiAqZGF0YSkKPiA+ICAgLyogV3Jp
dGVzIGEgMTYtYml0IHJlZ2lzdGVyIG9uIHRoZSBpdmNoICovCj4gPiAgIHN0YXRpYyBib29sIGl2
Y2hfd3JpdGUoc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bywgaW50IGFkZHIsIHUxNiBkYXRh
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpdmNoX3ByaXYgKnByaXYgPSBkdm8tPmRldl9wcml2Owo+
ID4gKwlzdHJ1Y3QgaXZjaF9wcml2ICpwcml2ID0gZHZvLT5pOTE1Owo+ID4gICAJc3RydWN0IGky
Y19hZGFwdGVyICphZGFwdGVyID0gZHZvLT5pMmNfYnVzOwo+ID4gICAJdTggb3V0X2J1ZlszXTsK
PiA+ICAgCXN0cnVjdCBpMmNfbXNnIG1zZyA9IHsKPiA+IEBAIC0yNzIsNyArMjcyLDcgQEAgc3Rh
dGljIGJvb2wgaXZjaF9pbml0KHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8sCj4gPiAgIAkJ
cmV0dXJuIGZhbHNlOwo+ID4gICAJZHZvLT5pMmNfYnVzID0gYWRhcHRlcjsKPiA+IC0JZHZvLT5k
ZXZfcHJpdiA9IHByaXY7Cj4gPiArCWR2by0+aTkxNSA9IHByaXY7Cj4gPiAgIAlwcml2LT5xdWll
dCA9IHRydWU7Cj4gPiAgIAlpZiAoIWl2Y2hfcmVhZChkdm8sIFZSMDAsICZ0ZW1wKSkKPiA+IEBA
IC0zMjgsNyArMzI4LDcgQEAgc3RhdGljIGVudW0gZHJtX21vZGVfc3RhdHVzIGl2Y2hfbW9kZV92
YWxpZChzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLAo+ID4gICAgKi8KPiA+ICAgc3RhdGlj
IHZvaWQgaXZjaF9yZXNldChzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBpdmNoX3ByaXYgKnByaXYgPSBkdm8tPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3Qg
aXZjaF9wcml2ICpwcml2ID0gZHZvLT5pOTE1Owo+ID4gICAJaW50IGk7Cj4gPiAgIAlEUk1fREVC
VUdfS01TKCJSZXNldHRpbmcgdGhlIElWQ0ggcmVnaXN0ZXJzXG4iKTsKPiA+IEBAIC0zOTgsNyAr
Mzk4LDcgQEAgc3RhdGljIHZvaWQgaXZjaF9tb2RlX3NldChzdHJ1Y3QgaW50ZWxfZHZvX2Rldmlj
ZSAqZHZvLAo+ID4gICAJCQkgIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlLAo+
ID4gICAJCQkgIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBpdmNoX3ByaXYgKnByaXYgPSBkdm8tPmRldl9wcml2Owo+ID4g
KwlzdHJ1Y3QgaXZjaF9wcml2ICpwcml2ID0gZHZvLT5pOTE1Owo+ID4gICAJdTE2IHZyNDAgPSAw
Owo+ID4gICAJdTE2IHZyMDEgPSAwOwo+ID4gICAJdTE2IHZyMTA7Cj4gPiBAQCAtNDgzLDExICs0
ODMsMTEgQEAgc3RhdGljIHZvaWQgaXZjaF9kdW1wX3JlZ3Moc3RydWN0IGludGVsX2R2b19kZXZp
Y2UgKmR2bykKPiA+ICAgc3RhdGljIHZvaWQgaXZjaF9kZXN0cm95KHN0cnVjdCBpbnRlbF9kdm9f
ZGV2aWNlICpkdm8pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGl2Y2hfcHJpdiAqcHJpdiA9IGR2by0+
ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBpdmNoX3ByaXYgKnByaXYgPSBkdm8tPmk5MTU7Cj4gPiAg
IAlpZiAocHJpdikgewo+ID4gICAJCWtmcmVlKHByaXYpOwo+ID4gLQkJZHZvLT5kZXZfcHJpdiA9
IE5VTEw7Cj4gPiArCQlkdm8tPmk5MTUgPSBOVUxMOwo+ID4gICAJfQo+ID4gICB9Cj4gPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX25zMjUwMS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZHZvX25zMjUwMS5jCj4gPiBpbmRleCBjODNhNWQ4OGQ2MmIuLmFmMDRmY2FhOThi
OCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2R2b19uczI1MDEuYwo+ID4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX25zMjUwMS5jCj4gPiBAQCAtMzkyLDcgKzM5
Miw3IEBAIHN0cnVjdCBuczI1MDFfcHJpdiB7Cj4gPiAgICovCj4gPiAgIHN0YXRpYyBib29sIG5z
MjUwMV9yZWFkYihzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLCBpbnQgYWRkciwgdTggKmNo
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBuczI1MDFfcHJpdiAqbnMgPSBkdm8tPmRldl9wcml2Owo+
ID4gKwlzdHJ1Y3QgbnMyNTAxX3ByaXYgKm5zID0gZHZvLT5pOTE1Owo+ID4gICAJc3RydWN0IGky
Y19hZGFwdGVyICphZGFwdGVyID0gZHZvLT5pMmNfYnVzOwo+ID4gICAJdTggb3V0X2J1ZlsyXTsK
PiA+ICAgCXU4IGluX2J1ZlsyXTsKPiA+IEBAIC00MzcsNyArNDM3LDcgQEAgc3RhdGljIGJvb2wg
bnMyNTAxX3JlYWRiKHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8sIGludCBhZGRyLCB1OCAq
Y2gpCj4gPiAgICovCj4gPiAgIHN0YXRpYyBib29sIG5zMjUwMV93cml0ZWIoc3RydWN0IGludGVs
X2R2b19kZXZpY2UgKmR2bywgaW50IGFkZHIsIHU4IGNoKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBu
czI1MDFfcHJpdiAqbnMgPSBkdm8tPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgbnMyNTAxX3ByaXYg
Km5zID0gZHZvLT5pOTE1Owo+ID4gICAJc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0gZHZv
LT5pMmNfYnVzOwo+ID4gICAJdTggb3V0X2J1ZlsyXTsKPiA+IEBAIC00ODEsNyArNDgxLDcgQEAg
c3RhdGljIGJvb2wgbnMyNTAxX2luaXQoc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bywKPiA+
ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAlkdm8tPmkyY19idXMgPSBhZGFwdGVyOwo+ID4gLQlk
dm8tPmRldl9wcml2ID0gbnM7Cj4gPiArCWR2by0+aTkxNSA9IG5zOwo+ID4gICAJbnMtPnF1aWV0
ID0gdHJ1ZTsKPiA+ICAgCWlmICghbnMyNTAxX3JlYWRiKGR2bywgTlMyNTAxX1ZJRF9MTywgJmNo
KSkKPiA+IEBAIC01NTEsNyArNTUxLDcgQEAgc3RhdGljIHZvaWQgbnMyNTAxX21vZGVfc2V0KHN0
cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8sCj4gPiAgIAkJCSAgICBjb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSkKPiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0
IG5zMjUwMV9jb25maWd1cmF0aW9uICpjb25mOwo+ID4gLQlzdHJ1Y3QgbnMyNTAxX3ByaXYgKm5z
ID0gKHN0cnVjdCBuczI1MDFfcHJpdiAqKShkdm8tPmRldl9wcml2KTsKPiA+ICsJc3RydWN0IG5z
MjUwMV9wcml2ICpucyA9IChzdHJ1Y3QgbnMyNTAxX3ByaXYgKikoZHZvLT5pOTE1KTsKPiA+ICAg
CWludCBtb2RlX2lkeCwgaTsKPiA+ICAgCURSTV9ERUJVR19LTVMKPiA+IEBAIC02NTUsNyArNjU1
LDcgQEAgc3RhdGljIGJvb2wgbnMyNTAxX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfZHZvX2Rl
dmljZSAqZHZvKQo+ID4gICAvKiBzZXQgdGhlIE5TMjUwMSBwb3dlciBzdGF0ZSAqLwo+ID4gICBz
dGF0aWMgdm9pZCBuczI1MDFfZHBtcyhzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLCBib29s
IGVuYWJsZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgbnMyNTAxX3ByaXYgKm5zID0gKHN0cnVjdCBu
czI1MDFfcHJpdiAqKShkdm8tPmRldl9wcml2KTsKPiA+ICsJc3RydWN0IG5zMjUwMV9wcml2ICpu
cyA9IChzdHJ1Y3QgbnMyNTAxX3ByaXYgKikoZHZvLT5pOTE1KTsKPiA+ICAgCURSTV9ERUJVR19L
TVMoIlRyeWluZyBzZXQgdGhlIGRwbXMgb2YgdGhlIERWTyB0byAlaVxuIiwgZW5hYmxlKTsKPiA+
IEBAIC02OTEsMTEgKzY5MSwxMSBAQCBzdGF0aWMgdm9pZCBuczI1MDFfZHBtcyhzdHJ1Y3QgaW50
ZWxfZHZvX2RldmljZSAqZHZvLCBib29sIGVuYWJsZSkKPiA+ICAgc3RhdGljIHZvaWQgbnMyNTAx
X2Rlc3Ryb3koc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bykKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgbnMyNTAxX3ByaXYgKm5zID0gZHZvLT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IG5zMjUwMV9w
cml2ICpucyA9IGR2by0+aTkxNTsKPiA+ICAgCWlmIChucykgewo+ID4gICAJCWtmcmVlKG5zKTsK
PiA+IC0JCWR2by0+ZGV2X3ByaXYgPSBOVUxMOwo+ID4gKwkJZHZvLT5pOTE1ID0gTlVMTDsKPiA+
ICAgCX0KPiA+ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2R2b19z
aWwxNjQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2R2b19zaWwxNjQuYwo+ID4gaW5kZXggMDQ2
OThlYWViNjMyLi5hNDUyZGNiYTE3OWMgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kdm9fc2lsMTY0LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2R2b19zaWwx
NjQuYwo+ID4gQEAgLTY4LDcgKzY4LDcgQEAgc3RydWN0IHNpbDE2NF9wcml2IHsKPiA+ICAgc3Rh
dGljIGJvb2wgc2lsMTY0X3JlYWRiKHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8sIGludCBh
ZGRyLCB1OCAqY2gpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IHNpbDE2NF9wcml2ICpzaWwgPSBkdm8t
PmRldl9wcml2Owo+ID4gKwlzdHJ1Y3Qgc2lsMTY0X3ByaXYgKnNpbCA9IGR2by0+aTkxNTsKPiA+
ICAgCXN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlciA9IGR2by0+aTJjX2J1czsKPiA+ICAgCXU4
IG91dF9idWZbMl07Cj4gPiAgIAl1OCBpbl9idWZbMl07Cj4gPiBAQCAtMTA1LDcgKzEwNSw3IEBA
IHN0YXRpYyBib29sIHNpbDE2NF9yZWFkYihzdHJ1Y3QgaW50ZWxfZHZvX2RldmljZSAqZHZvLCBp
bnQgYWRkciwgdTggKmNoKQo+ID4gICBzdGF0aWMgYm9vbCBzaWwxNjRfd3JpdGViKHN0cnVjdCBp
bnRlbF9kdm9fZGV2aWNlICpkdm8sIGludCBhZGRyLCB1OCBjaCkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3Qgc2lsMTY0X3ByaXYgKnNpbCA9IGR2by0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBzaWwxNjRf
cHJpdiAqc2lsID0gZHZvLT5pOTE1Owo+ID4gICAJc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVy
ID0gZHZvLT5pMmNfYnVzOwo+ID4gICAJdTggb3V0X2J1ZlsyXTsKPiA+ICAgCXN0cnVjdCBpMmNf
bXNnIG1zZyA9IHsKPiA+IEBAIC0xNDIsNyArMTQyLDcgQEAgc3RhdGljIGJvb2wgc2lsMTY0X2lu
aXQoc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bywKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4g
PiAgIAlkdm8tPmkyY19idXMgPSBhZGFwdGVyOwo+ID4gLQlkdm8tPmRldl9wcml2ID0gc2lsOwo+
ID4gKwlkdm8tPmk5MTUgPSBzaWw7Cj4gPiAgIAlzaWwtPnF1aWV0ID0gdHJ1ZTsKPiA+ICAgCWlm
ICghc2lsMTY0X3JlYWRiKGR2bywgU0lMMTY0X1ZJRF9MTywgJmNoKSkKPiA+IEBAIC0yNjAsMTEg
KzI2MCwxMSBAQCBzdGF0aWMgdm9pZCBzaWwxNjRfZHVtcF9yZWdzKHN0cnVjdCBpbnRlbF9kdm9f
ZGV2aWNlICpkdm8pCj4gPiAgIHN0YXRpYyB2b2lkIHNpbDE2NF9kZXN0cm95KHN0cnVjdCBpbnRl
bF9kdm9fZGV2aWNlICpkdm8pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IHNpbDE2NF9wcml2ICpzaWwg
PSBkdm8tPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3Qgc2lsMTY0X3ByaXYgKnNpbCA9IGR2by0+aTkx
NTsKPiA+ICAgCWlmIChzaWwpIHsKPiA+ICAgCQlrZnJlZShzaWwpOwo+ID4gLQkJZHZvLT5kZXZf
cHJpdiA9IE5VTEw7Cj4gPiArCQlkdm8tPmk5MTUgPSBOVUxMOwo+ID4gICAJfQo+ID4gICB9Cj4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX3RmcDQxMC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZHZvX3RmcDQxMC5jCj4gPiBpbmRleCA2MjMxMTRlZTczY2QuLjhmZmVk
ODkxNGI0OSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2R2b190ZnA0MTAu
Ywo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZHZvX3RmcDQxMC5jCj4gPiBAQCAtOTMs
NyArOTMsNyBAQCBzdHJ1Y3QgdGZwNDEwX3ByaXYgewo+ID4gICBzdGF0aWMgYm9vbCB0ZnA0MTBf
cmVhZGIoc3RydWN0IGludGVsX2R2b19kZXZpY2UgKmR2bywgaW50IGFkZHIsIHU4ICpjaCkKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgdGZwNDEwX3ByaXYgKnRmcCA9IGR2by0+ZGV2X3ByaXY7Cj4gPiAr
CXN0cnVjdCB0ZnA0MTBfcHJpdiAqdGZwID0gZHZvLT5pOTE1Owo+ID4gICAJc3RydWN0IGkyY19h
ZGFwdGVyICphZGFwdGVyID0gZHZvLT5pMmNfYnVzOwo+ID4gICAJdTggb3V0X2J1ZlsyXTsKPiA+
ICAgCXU4IGluX2J1ZlsyXTsKPiA+IEBAIC0xMzAsNyArMTMwLDcgQEAgc3RhdGljIGJvb2wgdGZw
NDEwX3JlYWRiKHN0cnVjdCBpbnRlbF9kdm9fZGV2aWNlICpkdm8sIGludCBhZGRyLCB1OCAqY2gp
Cj4gPiAgIHN0YXRpYyBib29sIHRmcDQxMF93cml0ZWIoc3RydWN0IGludGVsX2R2b19kZXZpY2Ug
KmR2bywgaW50IGFkZHIsIHU4IGNoKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCB0ZnA0MTBfcHJpdiAq
dGZwID0gZHZvLT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IHRmcDQxMF9wcml2ICp0ZnAgPSBkdm8t
Pmk5MTU7Cj4gPiAgIAlzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIgPSBkdm8tPmkyY19idXM7
Cj4gPiAgIAl1OCBvdXRfYnVmWzJdOwo+ID4gICAJc3RydWN0IGkyY19tc2cgbXNnID0gewo+ID4g
QEAgLTE3OCw3ICsxNzgsNyBAQCBzdGF0aWMgYm9vbCB0ZnA0MTBfaW5pdChzdHJ1Y3QgaW50ZWxf
ZHZvX2RldmljZSAqZHZvLAo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+ICAgCWR2by0+aTJjX2J1
cyA9IGFkYXB0ZXI7Cj4gPiAtCWR2by0+ZGV2X3ByaXYgPSB0ZnA7Cj4gPiArCWR2by0+aTkxNSA9
IHRmcDsKPiA+ICAgCXRmcC0+cXVpZXQgPSB0cnVlOwo+ID4gICAJaWYgKChpZCA9IHRmcDQxMF9n
ZXRpZChkdm8sIFRGUDQxMF9WSURfTE8pKSAhPSBURlA0MTBfVklEKSB7Cj4gPiBAQCAtMjk5LDEx
ICsyOTksMTEgQEAgc3RhdGljIHZvaWQgdGZwNDEwX2R1bXBfcmVncyhzdHJ1Y3QgaW50ZWxfZHZv
X2RldmljZSAqZHZvKQo+ID4gICBzdGF0aWMgdm9pZCB0ZnA0MTBfZGVzdHJveShzdHJ1Y3QgaW50
ZWxfZHZvX2RldmljZSAqZHZvKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCB0ZnA0MTBfcHJpdiAqdGZw
ID0gZHZvLT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IHRmcDQxMF9wcml2ICp0ZnAgPSBkdm8tPmk5
MTU7Cj4gPiAgIAlpZiAodGZwKSB7Cj4gPiAgIAkJa2ZyZWUodGZwKTsKPiA+IC0JCWR2by0+ZGV2
X3ByaXYgPSBOVUxMOwo+ID4gKwkJZHZvLT5pOTE1ID0gTlVMTDsKPiA+ICAgCX0KPiA+ICAgfQo+
ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCj4gPiBpbmRl
eCBjODZjYTlmMjE1MzIuLjJmYTY3NDdjN2I2ZSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKPiA+IEBAIC00OTUsMjcgKzQ5NSwyNyBAQCBz
dGF0aWMgdm9pZCBfX2Fzc2lnbl9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAo+
ID4gICB9Cj4gPiAgIHN0YXRpYyBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqCj4gPiAtaTkxNV9n
ZW1fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1bnNp
Z25lZCBpbnQgZmxhZ3MpCj4gPiAraTkxNV9nZW1fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsIHVuc2lnbmVkIGludCBmbGFncykKPiA+ICAgewo+ID4gICAJc3Ry
dWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eDsKPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2
X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICAgCWlmIChmbGFncyAmIEk5MTVfQ09OVEVYVF9DUkVB
VEVfRkxBR1NfU0lOR0xFX1RJTUVMSU5FICYmCj4gPiAtCSAgICAhSEFTX0VYRUNMSVNUUyhkZXZf
cHJpdikpCj4gPiArCSAgICAhSEFTX0VYRUNMSVNUUyhpOTE1KSkKPiA+ICAgCQlyZXR1cm4gRVJS
X1BUUigtRUlOVkFMKTsKPiA+ICAgCS8qIFJlYXAgdGhlIG1vc3Qgc3RhbGUgY29udGV4dCAqLwo+
ID4gLQljb250ZXh0c19mcmVlX2ZpcnN0KGRldl9wcml2KTsKPiA+ICsJY29udGV4dHNfZnJlZV9m
aXJzdChpOTE1KTsKPiA+IC0JY3R4ID0gX19jcmVhdGVfY29udGV4dChkZXZfcHJpdik7Cj4gPiAr
CWN0eCA9IF9fY3JlYXRlX2NvbnRleHQoaTkxNSk7Cj4gPiAgIAlpZiAoSVNfRVJSKGN0eCkpCj4g
PiAgIAkJcmV0dXJuIGN0eDsKPiA+IC0JaWYgKEhBU19GVUxMX1BQR1RUKGRldl9wcml2KSkgewo+
ID4gKwlpZiAoSEFTX0ZVTExfUFBHVFQoaTkxNSkpIHsKPiA+ICAgCQlzdHJ1Y3QgaTkxNV9wcGd0
dCAqcHBndHQ7Cj4gPiAtCQlwcGd0dCA9IGk5MTVfcHBndHRfY3JlYXRlKGRldl9wcml2KTsKPiA+
ICsJCXBwZ3R0ID0gaTkxNV9wcGd0dF9jcmVhdGUoaTkxNSk7Cj4gPiAgIAkJaWYgKElTX0VSUihw
cGd0dCkpIHsKPiA+ICAgCQkJRFJNX0RFQlVHX0RSSVZFUigiUFBHVFQgc2V0dXAgZmFpbGVkICgl
bGQpXG4iLAo+ID4gICAJCQkJCSBQVFJfRVJSKHBwZ3R0KSk7Cj4gPiBAQCAtNTMwLDcgKzUzMCw3
IEBAIGk5MTVfZ2VtX2NyZWF0ZV9jb250ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgdW5zaWduZWQgaW50IGZsYWdzKQo+ID4gICAJaWYgKGZsYWdzICYgSTkxNV9DT05URVhU
X0NSRUFURV9GTEFHU19TSU5HTEVfVElNRUxJTkUpIHsKPiA+ICAgCQlzdHJ1Y3QgaTkxNV90aW1l
bGluZSAqdGltZWxpbmU7Cj4gPiAtCQl0aW1lbGluZSA9IGk5MTVfdGltZWxpbmVfY3JlYXRlKGRl
dl9wcml2LCBOVUxMKTsKPiA+ICsJCXRpbWVsaW5lID0gaTkxNV90aW1lbGluZV9jcmVhdGUoaTkx
NSwgTlVMTCk7Cj4gPiAgIAkJaWYgKElTX0VSUih0aW1lbGluZSkpIHsKPiA+ICAgCQkJY29udGV4
dF9jbG9zZShjdHgpOwo+ID4gICAJCQlyZXR1cm4gRVJSX0NBU1QodGltZWxpbmUpOwo+ID4gQEAg
LTY0OSwxOSArNjQ5LDE5IEBAIHN0YXRpYyBib29sIG5lZWRzX3ByZWVtcHRfY29udGV4dChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgCXJldHVybiBIQVNfRVhFQ0xJU1RTKGk5
MTUpOwo+ID4gICB9Cj4gPiAtaW50IGk5MTVfZ2VtX2NvbnRleHRzX2luaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludCBpOTE1X2dlbV9jb250ZXh0c19pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dCAqY3R4Owo+ID4gICAJLyogUmVhc3N1cmUgb3Vyc2VsdmVzIHdlIGFyZSBvbmx5
IGNhbGxlZCBvbmNlICovCj4gPiAtCUdFTV9CVUdfT04oZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0
KTsKPiA+IC0JR0VNX0JVR19PTihkZXZfcHJpdi0+cHJlZW1wdF9jb250ZXh0KTsKPiA+ICsJR0VN
X0JVR19PTihpOTE1LT5rZXJuZWxfY29udGV4dCk7Cj4gPiArCUdFTV9CVUdfT04oaTkxNS0+cHJl
ZW1wdF9jb250ZXh0KTsKPiA+IC0JaW50ZWxfZW5naW5lX2luaXRfY3R4X3dhKGRldl9wcml2LT5l
bmdpbmVbUkNTMF0pOwo+ID4gLQlpbml0X2NvbnRleHRzKGRldl9wcml2KTsKPiA+ICsJaW50ZWxf
ZW5naW5lX2luaXRfY3R4X3dhKGk5MTUtPmVuZ2luZVtSQ1MwXSk7Cj4gPiArCWluaXRfY29udGV4
dHMoaTkxNSk7Cj4gPiAgIAkvKiBsb3dlc3QgcHJpb3JpdHk7IGlkbGUgdGFzayAqLwo+ID4gLQlj
dHggPSBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9rZXJuZWwoZGV2X3ByaXYsIEk5MTVfUFJJT1JJ
VFlfTUlOKTsKPiA+ICsJY3R4ID0gaTkxNV9nZW1fY29udGV4dF9jcmVhdGVfa2VybmVsKGk5MTUs
IEk5MTVfUFJJT1JJVFlfTUlOKTsKPiA+ICAgCWlmIChJU19FUlIoY3R4KSkgewo+ID4gICAJCURS
TV9FUlJPUigiRmFpbGVkIHRvIGNyZWF0ZSBkZWZhdWx0IGdsb2JhbCBjb250ZXh0XG4iKTsKPiA+
ICAgCQlyZXR1cm4gUFRSX0VSUihjdHgpOwo+ID4gQEAgLTY3NSwzMSArNjc1LDMxIEBAIGludCBp
OTE1X2dlbV9jb250ZXh0c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgCSAqLwo+ID4gICAJR0VNX0JVR19PTihjdHgtPmh3X2lkKTsKPiA+ICAgCUdFTV9CVUdf
T04oIWF0b21pY19yZWFkKCZjdHgtPmh3X2lkX3Bpbl9jb3VudCkpOwo+ID4gLQlkZXZfcHJpdi0+
a2VybmVsX2NvbnRleHQgPSBjdHg7Cj4gPiArCWk5MTUtPmtlcm5lbF9jb250ZXh0ID0gY3R4Owo+
ID4gICAJLyogaGlnaGVzdCBwcmlvcml0eTsgcHJlZW1wdGluZyB0YXNrICovCj4gPiAtCWlmIChu
ZWVkc19wcmVlbXB0X2NvbnRleHQoZGV2X3ByaXYpKSB7Cj4gPiAtCQljdHggPSBpOTE1X2dlbV9j
b250ZXh0X2NyZWF0ZV9rZXJuZWwoZGV2X3ByaXYsIElOVF9NQVgpOwo+ID4gKwlpZiAobmVlZHNf
cHJlZW1wdF9jb250ZXh0KGk5MTUpKSB7Cj4gPiArCQljdHggPSBpOTE1X2dlbV9jb250ZXh0X2Ny
ZWF0ZV9rZXJuZWwoaTkxNSwgSU5UX01BWCk7Cj4gPiAgIAkJaWYgKCFJU19FUlIoY3R4KSkKPiA+
IC0JCQlkZXZfcHJpdi0+cHJlZW1wdF9jb250ZXh0ID0gY3R4Owo+ID4gKwkJCWk5MTUtPnByZWVt
cHRfY29udGV4dCA9IGN0eDsKPiA+ICAgCQllbHNlCj4gPiAgIAkJCURSTV9FUlJPUigiRmFpbGVk
IHRvIGNyZWF0ZSBwcmVlbXB0IGNvbnRleHQ7IGRpc2FibGluZyBwcmVlbXB0aW9uXG4iKTsKPiA+
ICAgCX0KPiA+ICAgCURSTV9ERUJVR19EUklWRVIoIiVzIGNvbnRleHQgc3VwcG9ydCBpbml0aWFs
aXplZFxuIiwKPiA+IC0JCQkgRFJJVkVSX0NBUFMoZGV2X3ByaXYpLT5oYXNfbG9naWNhbF9jb250
ZXh0cyA/Cj4gPiArCQkJIERSSVZFUl9DQVBTKGk5MTUpLT5oYXNfbG9naWNhbF9jb250ZXh0cyA/
Cj4gPiAgIAkJCSAibG9naWNhbCIgOiAiZmFrZSIpOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0K
PiA+IC12b2lkIGk5MTVfZ2VtX2NvbnRleHRzX2xvc3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gK3ZvaWQgaTkxNV9nZW1fY29udGV4dHNfbG9zdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lOwo+ID4gICAJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Cj4gPiAtCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJbG9ja2RlcF9hc3Nl
cnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAtCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGRldl9wcml2LCBpZCkKPiA+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwg
aWQpCj4gPiAgIAkJaW50ZWxfZW5naW5lX2xvc3RfY29udGV4dChlbmdpbmUpOwo+ID4gICB9Cj4g
PiBAQCAtMjM2OCw3ICsyMzY4LDcgQEAgaW50IGk5MTVfZ2VtX2NvbnRleHRfc2V0cGFyYW1faW9j
dGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiA+ICAgaW50IGk5MTVfZ2Vt
X2NvbnRleHRfcmVzZXRfc3RhdHNfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiA+ICAg
CQkJCSAgICAgICB2b2lkICpkYXRhLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0
cnVjdCBkcm1faTkxNV9yZXNldF9zdGF0cyAqYXJncyA9IGRhdGE7Cj4gPiAgIAlzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4Owo+ID4gICAJaW50IHJldDsKPiA+IEBAIC0yMzkwLDcgKzIzOTAs
NyBAQCBpbnQgaTkxNV9nZW1fY29udGV4dF9yZXNldF9zdGF0c19pb2N0bChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LAo+ID4gICAJICovCj4gPiAgIAlpZiAoY2FwYWJsZShDQVBfU1lTX0FETUlOKSkK
PiA+IC0JCWFyZ3MtPnJlc2V0X2NvdW50ID0gaTkxNV9yZXNldF9jb3VudCgmZGV2X3ByaXYtPmdw
dV9lcnJvcik7Cj4gPiArCQlhcmdzLT5yZXNldF9jb3VudCA9IGk5MTVfcmVzZXRfY291bnQoJmk5
MTUtPmdwdV9lcnJvcik7Cj4gPiAgIAllbHNlCj4gPiAgIAkJYXJncy0+cmVzZXRfY291bnQgPSAw
Owo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250
ZXh0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCj4gPiBp
bmRleCA2MzAzOTJjNzdlNDguLmY1NWNiOGVhZTg3YSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKPiA+IEBAIC0xMzMsOSArMTMzLDkgQEAg
c3RhdGljIGlubGluZSBib29sIGk5MTVfZ2VtX2NvbnRleHRfaXNfa2VybmVsKHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgpCj4gPiAgIH0KPiA+ICAgLyogaTkxNV9nZW1fY29udGV4dC5jICov
Cj4gPiAtaW50IF9fbXVzdF9jaGVjayBpOTE1X2dlbV9jb250ZXh0c19pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpOTE1X2dlbV9jb250ZXh0c19sb3N0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpOTE1X2dlbV9j
b250ZXh0c19maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAraW50
IF9fbXVzdF9jaGVjayBpOTE1X2dlbV9jb250ZXh0c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiA+ICt2b2lkIGk5MTVfZ2VtX2NvbnRleHRzX2xvc3Qoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaTkxNV9nZW1fY29udGV4dHNfZmluaShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIGludCBpOTE1X2dlbV9jb250ZXh0X29w
ZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgc3RydWN0IGRybV9m
aWxlICpmaWxlKTsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fZXhlY2J1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4
ZWNidWZmZXIuYwo+ID4gaW5kZXggNTI4ZWVhNDRkY2NmLi44M2Q2NDU4MGEyZjIgMTAwNjQ0Cj4g
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCj4g
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCj4g
PiBAQCAtMjA5OSw3ICsyMDk5LDcgQEAgc3RhdGljIGludCBlYl9zdWJtaXQoc3RydWN0IGk5MTVf
ZXhlY2J1ZmZlciAqZWIpCj4gPiAgICAqIFRoZSBlbmdpbmUgaW5kZXggaXMgcmV0dXJuZWQuCj4g
PiAgICAqLwo+ID4gICBzdGF0aWMgdW5zaWduZWQgaW50Cj4gPiAtZ2VuOF9kaXNwYXRjaF9ic2Rf
ZW5naW5lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtnZW44X2Rpc3Bh
dGNoX2JzZF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSBz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1faTkxNV9maWxl
X3ByaXZhdGUgKmZpbGVfcHJpdiA9IGZpbGUtPmRyaXZlcl9wcml2Owo+ID4gQEAgLTIxMDcsNyAr
MjEwNyw3IEBAIGdlbjhfZGlzcGF0Y2hfYnNkX2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiAgIAkvKiBDaGVjayB3aGV0aGVyIHRoZSBmaWxlX3ByaXYgaGFzIGFs
cmVhZHkgc2VsZWN0ZWQgb25lIHJpbmcuICovCj4gPiAgIAlpZiAoKGludClmaWxlX3ByaXYtPmJz
ZF9lbmdpbmUgPCAwKQo+ID4gICAJCWZpbGVfcHJpdi0+YnNkX2VuZ2luZSA9IGF0b21pY19mZXRj
aF94b3IoMSwKPiA+IC0JCQkgJmRldl9wcml2LT5tbS5ic2RfZW5naW5lX2Rpc3BhdGNoX2luZGV4
KTsKPiA+ICsJCQkgJmk5MTUtPm1tLmJzZF9lbmdpbmVfZGlzcGF0Y2hfaW5kZXgpOwo+ID4gICAJ
cmV0dXJuIGZpbGVfcHJpdi0+YnNkX2VuZ2luZTsKPiA+ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYwo+ID4gaW5kZXggMzZiNzZjNmEwYTlkLi5hMzdm
MGFkYWMxNmUgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fb2JqZWN0LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9v
YmplY3QuYwo+ID4gQEAgLTM2Nyw3ICszNjcsNyBAQCB2b2lkCj4gPiAgIGk5MTVfZ2VtX29iamVj
dF9mbHVzaF93cml0ZV9kb21haW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiA+
ICAgCQkJCSAgIHVuc2lnbmVkIGludCBmbHVzaF9kb21haW5zKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2
KTsKPiA+ICAgCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwo+ID4gICAJYXNzZXJ0X29iamVjdF9oZWxk
KG9iaik7Cj4gPiBAQCAtMzc3LDcgKzM3Nyw3IEBAIGk5MTVfZ2VtX29iamVjdF9mbHVzaF93cml0
ZV9kb21haW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiA+ICAgCXN3aXRjaCAo
b2JqLT53cml0ZV9kb21haW4pIHsKPiA+ICAgCWNhc2UgSTkxNV9HRU1fRE9NQUlOX0dUVDoKPiA+
IC0JCWk5MTVfZ2VtX2ZsdXNoX2dndHRfd3JpdGVzKGRldl9wcml2KTsKPiA+ICsJCWk5MTVfZ2Vt
X2ZsdXNoX2dndHRfd3JpdGVzKGk5MTUpOwo+ID4gICAJCWludGVsX2ZiX29ial9mbHVzaChvYmos
Cj4gPiAgIAkJCQkgICBmYl93cml0ZV9vcmlnaW4ob2JqLCBJOTE1X0dFTV9ET01BSU5fR1RUKSk7
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3NobWVt
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2htZW0uYwo+ID4gaW5kZXgg
MTlkOWVjZGIyODk0Li5lYjRhYWU2NWY2ZTQgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fc2htZW0uYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3NobWVtLmMKPiA+IEBAIC01MjEsNyArNTIxLDcgQEAgaTkxNV9nZW1f
b2JqZWN0X2NyZWF0ZV9zaG1lbShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTY0IHNp
emUpCj4gPiAgIC8qIEFsbG9jYXRlIGEgbmV3IEdFTSBvYmplY3QgYW5kIGZpbGwgaXQgd2l0aCB0
aGUgc3VwcGxpZWQgZGF0YSAqLwo+ID4gICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqCj4g
PiAtaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbV9mcm9tX2RhdGEoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2k5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW1fZnJv
bV9kYXRhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgIGNv
bnN0IHZvaWQgKmRhdGEsIHNpemVfdCBzaXplKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqOwo+ID4gQEAgLTUyOSw3ICs1MjksNyBAQCBpOTE1X2dlbV9vYmpl
Y3RfY3JlYXRlX3NobWVtX2Zyb21fZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAgIAlzaXplX3Qgb2Zmc2V0Owo+ID4gICAJaW50IGVycjsKPiA+IC0Jb2JqID0gaTkx
NV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShkZXZfcHJpdiwgcm91bmRfdXAoc2l6ZSwgUEFHRV9T
SVpFKSk7Cj4gPiArCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0oaTkxNSwgcm91
bmRfdXAoc2l6ZSwgUEFHRV9TSVpFKSk7Cj4gPiAgIAlpZiAoSVNfRVJSKG9iaikpCj4gPiAgIAkJ
cmV0dXJuIG9iajsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fc3RvbGVuLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc3RvbGVu
LmMKPiA+IGluZGV4IGRlMWZhYjIwNThlYy4uMjRlMTc0ZjA2OWYzIDEwMDY0NAo+ID4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3N0b2xlbi5jCj4gPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc3RvbGVuLmMKPiA+IEBAIC0yNCw0OCArMjQs
NDggQEAKPiA+ICAgICogZm9yIGlzIGEgYm9vbi4KPiA+ICAgICovCj4gPiAtaW50IGk5MTVfZ2Vt
X3N0b2xlbl9pbnNlcnRfbm9kZV9pbl9yYW5nZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAraW50IGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZV9pbl9yYW5nZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgc3RydWN0IGRybV9tbV9ub2Rl
ICpub2RlLCB1NjQgc2l6ZSwKPiA+ICAgCQkJCQkgdW5zaWduZWQgYWxpZ25tZW50LCB1NjQgc3Rh
cnQsIHU2NCBlbmQpCj4gPiAgIHsKPiA+ICAgCWludCByZXQ7Cj4gPiAtCWlmICghZHJtX21tX2lu
aXRpYWxpemVkKCZkZXZfcHJpdi0+bW0uc3RvbGVuKSkKPiA+ICsJaWYgKCFkcm1fbW1faW5pdGlh
bGl6ZWQoJmk5MTUtPm1tLnN0b2xlbikpCj4gPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gPiAgIAkv
KiBXYVNraXBTdG9sZW5NZW1vcnlGaXJzdFBhZ2U6YmR3KyAqLwo+ID4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA4ICYmIHN0YXJ0IDwgNDA5NikKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSA4ICYmIHN0YXJ0IDwgNDA5NikKPiA+ICAgCQlzdGFydCA9IDQwOTY7Cj4gPiAtCW11dGV4
X2xvY2soJmRldl9wcml2LT5tbS5zdG9sZW5fbG9jayk7Cj4gPiAtCXJldCA9IGRybV9tbV9pbnNl
cnRfbm9kZV9pbl9yYW5nZSgmZGV2X3ByaXYtPm1tLnN0b2xlbiwgbm9kZSwKPiA+ICsJbXV0ZXhf
bG9jaygmaTkxNS0+bW0uc3RvbGVuX2xvY2spOwo+ID4gKwlyZXQgPSBkcm1fbW1faW5zZXJ0X25v
ZGVfaW5fcmFuZ2UoJmk5MTUtPm1tLnN0b2xlbiwgbm9kZSwKPiA+ICAgCQkJCQkgIHNpemUsIGFs
aWdubWVudCwgMCwKPiA+ICAgCQkJCQkgIHN0YXJ0LCBlbmQsIERSTV9NTV9JTlNFUlRfQkVTVCk7
Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPm1tLnN0b2xlbl9sb2NrKTsKPiA+ICsJbXV0
ZXhfdW5sb2NrKCZpOTE1LT5tbS5zdG9sZW5fbG9jayk7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4g
ICB9Cj4gPiAtaW50IGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAraW50IGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCXN0cnVjdCBkcm1fbW1fbm9k
ZSAqbm9kZSwgdTY0IHNpemUsCj4gPiAgIAkJCQl1bnNpZ25lZCBhbGlnbm1lbnQpCj4gPiAgIHsK
PiA+IC0JcmV0dXJuIGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZV9pbl9yYW5nZShkZXZfcHJp
diwgbm9kZSwgc2l6ZSwKPiA+ICsJcmV0dXJuIGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZV9p
bl9yYW5nZShpOTE1LCBub2RlLCBzaXplLAo+ID4gICAJCQkJCQkgICAgYWxpZ25tZW50LCAwLCBV
NjRfTUFYKTsKPiA+ICAgfQo+ID4gLXZvaWQgaTkxNV9nZW1fc3RvbGVuX3JlbW92ZV9ub2RlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGk5MTVfZ2VtX3N0b2xl
bl9yZW1vdmVfbm9kZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSBz
dHJ1Y3QgZHJtX21tX25vZGUgKm5vZGUpCj4gPiAgIHsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3By
aXYtPm1tLnN0b2xlbl9sb2NrKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+bW0uc3RvbGVuX2xv
Y2spOwo+ID4gICAJZHJtX21tX3JlbW92ZV9ub2RlKG5vZGUpOwo+ID4gLQltdXRleF91bmxvY2so
JmRldl9wcml2LT5tbS5zdG9sZW5fbG9jayk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+bW0u
c3RvbGVuX2xvY2spOwo+ID4gICB9Cj4gPiAtc3RhdGljIGludCBpOTE1X2FkanVzdF9zdG9sZW4o
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBpbnQgaTkxNV9h
ZGp1c3Rfc3RvbGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAg
ICBzdHJ1Y3QgcmVzb3VyY2UgKmRzbSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaTkxNV9nZ3R0ICpn
Z3R0ID0gJmRldl9wcml2LT5nZ3R0Owo+ID4gKwlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmk5
MTUtPmdndHQ7Cj4gPiAgIAlzdHJ1Y3QgcmVzb3VyY2UgKnI7Cj4gPiAgIAlpZiAoZHNtLT5zdGFy
dCA9PSAwIHx8IGRzbS0+ZW5kIDw9IGRzbS0+c3RhcnQpCj4gPiBAQCAtNzcsMTQgKzc3LDE0IEBA
IHN0YXRpYyBpbnQgaTkxNV9hZGp1c3Rfc3RvbGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCSAqLwo+ID4gICAJLyogTWFrZSBzdXJlIHdlIGRvbid0IGNsb2JiZXIg
dGhlIEdUVCBpZiBpdCdzIHdpdGhpbiBzdG9sZW4gbWVtb3J5ICovCj4gPiAtCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpIDw9IDQgJiYKPiA+IC0JICAgICFJU19HMzMoZGV2X3ByaXYpICYmICFJU19Q
SU5FVklFVyhkZXZfcHJpdikgJiYgIUlTX0c0WChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA8PSA0ICYmCj4gPiArCSAgICAhSVNfRzMzKGk5MTUpICYmICFJU19QSU5FVklF
VyhpOTE1KSAmJiAhSVNfRzRYKGk5MTUpKSB7Cj4gPiAgIAkJc3RydWN0IHJlc291cmNlIHN0b2xl
blsyXSA9IHsqZHNtLCAqZHNtfTsKPiA+ICAgCQlzdHJ1Y3QgcmVzb3VyY2UgZ2d0dF9yZXM7Cj4g
PiAgIAkJcmVzb3VyY2Vfc2l6ZV90IGdndHRfc3RhcnQ7Cj4gPiAgIAkJZ2d0dF9zdGFydCA9IEk5
MTVfUkVBRChQR1RCTF9DVEwpOwo+ID4gLQkJaWYgKElTX0dFTihkZXZfcHJpdiwgNCkpCj4gPiAr
CQlpZiAoSVNfR0VOKGk5MTUsIDQpKQo+ID4gICAJCQlnZ3R0X3N0YXJ0ID0gKGdndHRfc3RhcnQg
JiBQR1RCTF9BRERSRVNTX0xPX01BU0spIHwKPiA+ICAgCQkJCSAgICAgKGdndHRfc3RhcnQgJiBQ
R1RCTF9BRERSRVNTX0hJX01BU0spIDw8IDI4Owo+ID4gICAJCWVsc2UKPiA+IEBAIC0xMTgsNyAr
MTE4LDcgQEAgc3RhdGljIGludCBpOTE1X2FkanVzdF9zdG9sZW4oc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gICAJICoga2VybmVsLiBTbyBpZiB0aGUgcmVnaW9uIGlzIGFs
cmVhZHkgbWFya2VkIGFzIGJ1c3ksIHNvbWV0aGluZwo+ID4gICAJICogaXMgc2VyaW91c2x5IHdy
b25nLgo+ID4gICAJICovCj4gPiAtCXIgPSBkZXZtX3JlcXVlc3RfbWVtX3JlZ2lvbihkZXZfcHJp
di0+ZHJtLmRldiwgZHNtLT5zdGFydCwKPiA+ICsJciA9IGRldm1fcmVxdWVzdF9tZW1fcmVnaW9u
KGk5MTUtPmRybS5kZXYsIGRzbS0+c3RhcnQsCj4gPiAgIAkJCQkgICAgcmVzb3VyY2Vfc2l6ZShk
c20pLAo+ID4gICAJCQkJICAgICJHcmFwaGljcyBTdG9sZW4gTWVtb3J5Iik7Cj4gPiAgIAlpZiAo
ciA9PSBOVUxMKSB7Cj4gPiBAQCAtMTMxLDE0ICsxMzEsMTQgQEAgc3RhdGljIGludCBpOTE1X2Fk
anVzdF9zdG9sZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCSAq
IHJlc2VydmF0aW9uIHN0YXJ0aW5nIGZyb20gMSBpbnN0ZWFkIG9mIDAuCj4gPiAgIAkJICogVGhl
cmUncyBhbHNvIEJJT1Mgd2l0aCBvZmYtYnktb25lIG9uIHRoZSBvdGhlciBlbmQuCj4gPiAgIAkJ
ICovCj4gPiAtCQlyID0gZGV2bV9yZXF1ZXN0X21lbV9yZWdpb24oZGV2X3ByaXYtPmRybS5kZXYs
IGRzbS0+c3RhcnQgKyAxLAo+ID4gKwkJciA9IGRldm1fcmVxdWVzdF9tZW1fcmVnaW9uKGk5MTUt
PmRybS5kZXYsIGRzbS0+c3RhcnQgKyAxLAo+ID4gICAJCQkJCSAgICByZXNvdXJjZV9zaXplKGRz
bSkgLSAyLAo+ID4gICAJCQkJCSAgICAiR3JhcGhpY3MgU3RvbGVuIE1lbW9yeSIpOwo+ID4gICAJ
CS8qCj4gPiAgIAkJICogR0VOMyBmaXJtd2FyZSBsaWtlcyB0byBzbWFzaCBwY2kgYnJpZGdlcyBp
bnRvIHRoZSBzdG9sZW4KPiA+ICAgCQkgKiByYW5nZS4gQXBwYXJlbnRseSB0aGlzIHdvcmtzLgo+
ID4gICAJCSAqLwo+ID4gLQkJaWYgKHIgPT0gTlVMTCAmJiAhSVNfR0VOKGRldl9wcml2LCAzKSkg
ewo+ID4gKwkJaWYgKHIgPT0gTlVMTCAmJiAhSVNfR0VOKGk5MTUsIDMpKSB7Cj4gPiAgIAkJCURS
TV9FUlJPUigiY29uZmxpY3QgZGV0ZWN0ZWQgd2l0aCBzdG9sZW4gcmVnaW9uOiAlcFJcbiIsCj4g
PiAgIAkJCQkgIGRzbSk7Cj4gPiBAQCAtMTQ5LDI1ICsxNDksMjUgQEAgc3RhdGljIGludCBpOTE1
X2FkanVzdF9zdG9sZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
cmV0dXJuIDA7Cj4gPiAgIH0KPiA+IC12b2lkIGk5MTVfZ2VtX2NsZWFudXBfc3RvbGVuKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGk5MTVfZ2VtX2NsZWFudXBf
c3RvbGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWlmICgh
ZHJtX21tX2luaXRpYWxpemVkKCZkZXZfcHJpdi0+bW0uc3RvbGVuKSkKPiA+ICsJaWYgKCFkcm1f
bW1faW5pdGlhbGl6ZWQoJmk5MTUtPm1tLnN0b2xlbikpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlk
cm1fbW1fdGFrZWRvd24oJmRldl9wcml2LT5tbS5zdG9sZW4pOwo+ID4gKwlkcm1fbW1fdGFrZWRv
d24oJmk5MTUtPm1tLnN0b2xlbik7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnNHhfZ2V0X3N0
b2xlbl9yZXNlcnZlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3Rh
dGljIHZvaWQgZzR4X2dldF9zdG9sZW5fcmVzZXJ2ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gPiAgIAkJCQkgICAgcmVzb3VyY2Vfc2l6ZV90ICpiYXNlLAo+ID4gICAJCQkJICAg
IHJlc291cmNlX3NpemVfdCAqc2l6ZSkKPiA+ICAgewo+ID4gLQl1MzIgcmVnX3ZhbCA9IEk5MTVf
UkVBRChJU19HTTQ1KGRldl9wcml2KSA/Cj4gPiArCXUzMiByZWdfdmFsID0gSTkxNV9SRUFEKElT
X0dNNDUoaTkxNSkgPwo+ID4gICAJCQkJQ1RHX1NUT0xFTl9SRVNFUlZFRCA6Cj4gPiAgIAkJCQlF
TEtfU1RPTEVOX1JFU0VSVkVEKTsKPiA+IC0JcmVzb3VyY2Vfc2l6ZV90IHN0b2xlbl90b3AgPSBk
ZXZfcHJpdi0+ZHNtLmVuZCArIDE7Cj4gPiArCXJlc291cmNlX3NpemVfdCBzdG9sZW5fdG9wID0g
aTkxNS0+ZHNtLmVuZCArIDE7Cj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCIlc19TVE9MRU5fUkVT
RVJWRUQgPSAlMDh4XG4iLAo+ID4gLQkJCSBJU19HTTQ1KGRldl9wcml2KSA/ICJDVEciIDogIkVM
SyIsIHJlZ192YWwpOwo+ID4gKwkJCSBJU19HTTQ1KGk5MTUpID8gIkNURyIgOiAiRUxLIiwgcmVn
X3ZhbCk7Cj4gPiAgIAlpZiAoKHJlZ192YWwgJiBHNFhfU1RPTEVOX1JFU0VSVkVEX0VOQUJMRSkg
PT0gMCkKPiA+ICAgCQlyZXR1cm47Cj4gPiBAQCAtMTc2LDcgKzE3Niw3IEBAIHN0YXRpYyB2b2lk
IGc0eF9nZXRfc3RvbGVuX3Jlc2VydmVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgCSAqIFdoZXRoZXIgSUxLIHJlYWxseSByZXVzZXMgdGhlIEVMSyByZWdpc3RlciBm
b3IgdGhpcyBpcyB1bmNsZWFyLgo+ID4gICAJICogTGV0J3Mgc2VlIGlmIHdlIGNhdGNoIGFueW9u
ZSB3aXRoIHRoaXMgc3VwcG9zZWRseSBlbmFibGVkIG9uIElMSy4KPiA+ICAgCSAqLwo+ID4gLQlX
QVJOKElTX0dFTihkZXZfcHJpdiwgNSksICJJTEsgc3RvbGVuIHJlc2VydmVkIGZvdW5kPyAweCUw
OHhcbiIsCj4gPiArCVdBUk4oSVNfR0VOKGk5MTUsIDUpLCAiSUxLIHN0b2xlbiByZXNlcnZlZCBm
b3VuZD8gMHglMDh4XG4iLAo+ID4gICAJICAgICByZWdfdmFsKTsKPiA+ICAgCWlmICghKHJlZ192
YWwgJiBHNFhfU1RPTEVOX1JFU0VSVkVEX0FERFIyX01BU0spKQo+ID4gQEAgLTE4OCw3ICsxODgs
NyBAQCBzdGF0aWMgdm9pZCBnNHhfZ2V0X3N0b2xlbl9yZXNlcnZlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkqc2l6ZSA9IHN0b2xlbl90b3AgLSAqYmFzZTsKPiA+
ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGdlbjZfZ2V0X3N0b2xlbl9yZXNlcnZlZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgZ2VuNl9nZXRfc3RvbGVu
X3Jlc2VydmVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICBy
ZXNvdXJjZV9zaXplX3QgKmJhc2UsCj4gPiAgIAkJCQkgICAgIHJlc291cmNlX3NpemVfdCAqc2l6
ZSkKPiA+ICAgewo+ID4gQEAgLTIyMCwxMiArMjIwLDEyIEBAIHN0YXRpYyB2b2lkIGdlbjZfZ2V0
X3N0b2xlbl9yZXNlcnZlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAg
IAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCB2bHZfZ2V0X3N0b2xlbl9yZXNlcnZlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgdmx2X2dldF9z
dG9sZW5fcmVzZXJ2ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkg
ICAgcmVzb3VyY2Vfc2l6ZV90ICpiYXNlLAo+ID4gICAJCQkJICAgIHJlc291cmNlX3NpemVfdCAq
c2l6ZSkKPiA+ICAgewo+ID4gICAJdTMyIHJlZ192YWwgPSBJOTE1X1JFQUQoR0VONl9TVE9MRU5f
UkVTRVJWRUQpOwo+ID4gLQlyZXNvdXJjZV9zaXplX3Qgc3RvbGVuX3RvcCA9IGRldl9wcml2LT5k
c20uZW5kICsgMTsKPiA+ICsJcmVzb3VyY2Vfc2l6ZV90IHN0b2xlbl90b3AgPSBpOTE1LT5kc20u
ZW5kICsgMTsKPiA+ICAgCURSTV9ERUJVR19EUklWRVIoIkdFTjZfU1RPTEVOX1JFU0VSVkVEID0g
JTA4eFxuIiwgcmVnX3ZhbCk7Cj4gPiBAQCAtMjQ4LDcgKzI0OCw3IEBAIHN0YXRpYyB2b2lkIHZs
dl9nZXRfc3RvbGVuX3Jlc2VydmVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICAgCSpiYXNlID0gc3RvbGVuX3RvcCAtICpzaXplOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgZ2VuN19nZXRfc3RvbGVuX3Jlc2VydmVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBnZW43X2dldF9zdG9sZW5fcmVzZXJ2ZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgIHJlc291cmNlX3NpemVfdCAqYmFz
ZSwKPiA+ICAgCQkJCSAgICAgcmVzb3VyY2Vfc2l6ZV90ICpzaXplKQo+ID4gICB7Cj4gPiBAQCAt
Mjc0LDcgKzI3NCw3IEBAIHN0YXRpYyB2b2lkIGdlbjdfZ2V0X3N0b2xlbl9yZXNlcnZlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgdm9pZCBjaHZfZ2V0X3N0b2xlbl9yZXNlcnZlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgY2h2X2dldF9zdG9sZW5fcmVzZXJ2ZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgcmVzb3VyY2Vfc2l6ZV90ICpi
YXNlLAo+ID4gICAJCQkJICAgIHJlc291cmNlX3NpemVfdCAqc2l6ZSkKPiA+ICAgewo+ID4gQEAg
LTMwNiwxMiArMzA2LDEyIEBAIHN0YXRpYyB2b2lkIGNodl9nZXRfc3RvbGVuX3Jlc2VydmVkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCX0KPiA+ICAgfQo+ID4gLXN0
YXRpYyB2b2lkIGJkd19nZXRfc3RvbGVuX3Jlc2VydmVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBiZHdfZ2V0X3N0b2xlbl9yZXNlcnZlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICByZXNvdXJjZV9zaXplX3Qg
KmJhc2UsCj4gPiAgIAkJCQkgICAgcmVzb3VyY2Vfc2l6ZV90ICpzaXplKQo+ID4gICB7Cj4gPiAg
IAl1MzIgcmVnX3ZhbCA9IEk5MTVfUkVBRChHRU42X1NUT0xFTl9SRVNFUlZFRCk7Cj4gPiAtCXJl
c291cmNlX3NpemVfdCBzdG9sZW5fdG9wID0gZGV2X3ByaXYtPmRzbS5lbmQgKyAxOwo+ID4gKwly
ZXNvdXJjZV9zaXplX3Qgc3RvbGVuX3RvcCA9IGk5MTUtPmRzbS5lbmQgKyAxOwo+ID4gICAJRFJN
X0RFQlVHX0RSSVZFUigiR0VONl9TVE9MRU5fUkVTRVJWRUQgPSAlMDh4XG4iLCByZWdfdmFsKTsK
PiA+IEBAIC0zNTQsMTkgKzM1NCwxOSBAQCBzdGF0aWMgdm9pZCBpY2xfZ2V0X3N0b2xlbl9yZXNl
cnZlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCX0KPiA+ICAgfQo+ID4g
LWludCBpOTE1X2dlbV9pbml0X3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiAraW50IGk5MTVfZ2VtX2luaXRfc3RvbGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ID4gICB7Cj4gPiAgIAlyZXNvdXJjZV9zaXplX3QgcmVzZXJ2ZWRfYmFzZSwgc3Rv
bGVuX3RvcDsKPiA+ICAgCXJlc291cmNlX3NpemVfdCByZXNlcnZlZF90b3RhbCwgcmVzZXJ2ZWRf
c2l6ZTsKPiA+IC0JbXV0ZXhfaW5pdCgmZGV2X3ByaXYtPm1tLnN0b2xlbl9sb2NrKTsKPiA+ICsJ
bXV0ZXhfaW5pdCgmaTkxNS0+bW0uc3RvbGVuX2xvY2spOwo+ID4gLQlpZiAoaW50ZWxfdmdwdV9h
Y3RpdmUoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShpOTE1KSkgewo+
ID4gICAJCURSTV9JTkZPKCJpR1ZULWcgYWN0aXZlLCBkaXNhYmxpbmcgdXNlIG9mIHN0b2xlbiBt
ZW1vcnlcbiIpOwo+ID4gICAJCXJldHVybiAwOwo+ID4gICAJfQo+ID4gLQlpZiAoaW50ZWxfdnRk
X2FjdGl2ZSgpICYmIElOVEVMX0dFTihkZXZfcHJpdikgPCA4KSB7Cj4gPiArCWlmIChpbnRlbF92
dGRfYWN0aXZlKCkgJiYgSU5URUxfR0VOKGk5MTUpIDwgOCkgewo+ID4gICAJCURSTV9JTkZPKCJE
TUFSIGFjdGl2ZSwgZGlzYWJsaW5nIHVzZSBvZiBzdG9sZW4gbWVtb3J5XG4iKTsKPiA+ICAgCQly
ZXR1cm4gMDsKPiA+ICAgCX0KPiA+IEBAIC0zNzQsNTUgKzM3NCw1NSBAQCBpbnQgaTkxNV9nZW1f
aW5pdF9zdG9sZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJaWYg
KHJlc291cmNlX3NpemUoJmludGVsX2dyYXBoaWNzX3N0b2xlbl9yZXMpID09IDApCj4gPiAgIAkJ
cmV0dXJuIDA7Cj4gPiAtCWRldl9wcml2LT5kc20gPSBpbnRlbF9ncmFwaGljc19zdG9sZW5fcmVz
Owo+ID4gKwlpOTE1LT5kc20gPSBpbnRlbF9ncmFwaGljc19zdG9sZW5fcmVzOwo+ID4gLQlpZiAo
aTkxNV9hZGp1c3Rfc3RvbGVuKGRldl9wcml2LCAmZGV2X3ByaXYtPmRzbSkpCj4gPiArCWlmIChp
OTE1X2FkanVzdF9zdG9sZW4oaTkxNSwgJmk5MTUtPmRzbSkpCj4gPiAgIAkJcmV0dXJuIDA7Cj4g
PiAtCUdFTV9CVUdfT04oZGV2X3ByaXYtPmRzbS5zdGFydCA9PSAwKTsKPiA+IC0JR0VNX0JVR19P
TihkZXZfcHJpdi0+ZHNtLmVuZCA8PSBkZXZfcHJpdi0+ZHNtLnN0YXJ0KTsKPiA+ICsJR0VNX0JV
R19PTihpOTE1LT5kc20uc3RhcnQgPT0gMCk7Cj4gPiArCUdFTV9CVUdfT04oaTkxNS0+ZHNtLmVu
ZCA8PSBpOTE1LT5kc20uc3RhcnQpOwo+ID4gLQlzdG9sZW5fdG9wID0gZGV2X3ByaXYtPmRzbS5l
bmQgKyAxOwo+ID4gKwlzdG9sZW5fdG9wID0gaTkxNS0+ZHNtLmVuZCArIDE7Cj4gPiAgIAlyZXNl
cnZlZF9iYXNlID0gc3RvbGVuX3RvcDsKPiA+ICAgCXJlc2VydmVkX3NpemUgPSAwOwo+ID4gLQlz
d2l0Y2ggKElOVEVMX0dFTihkZXZfcHJpdikpIHsKPiA+ICsJc3dpdGNoIChJTlRFTF9HRU4oaTkx
NSkpIHsKPiA+ICAgCWNhc2UgMjoKPiA+ICAgCWNhc2UgMzoKPiA+ICAgCQlicmVhazsKPiA+ICAg
CWNhc2UgNDoKPiA+IC0JCWlmICghSVNfRzRYKGRldl9wcml2KSkKPiA+ICsJCWlmICghSVNfRzRY
KGk5MTUpKQo+ID4gICAJCQlicmVhazsKPiA+ICAgCQkvKiBmYWxsIHRocm91Z2ggKi8KPiA+ICAg
CWNhc2UgNToKPiA+IC0JCWc0eF9nZXRfc3RvbGVuX3Jlc2VydmVkKGRldl9wcml2LAo+ID4gKwkJ
ZzR4X2dldF9zdG9sZW5fcmVzZXJ2ZWQoaTkxNSwKPiA+ICAgCQkJCQkmcmVzZXJ2ZWRfYmFzZSwg
JnJlc2VydmVkX3NpemUpOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSA2Ogo+ID4gLQkJZ2Vu
Nl9nZXRfc3RvbGVuX3Jlc2VydmVkKGRldl9wcml2LAo+ID4gKwkJZ2VuNl9nZXRfc3RvbGVuX3Jl
c2VydmVkKGk5MTUsCj4gPiAgIAkJCQkJICZyZXNlcnZlZF9iYXNlLCAmcmVzZXJ2ZWRfc2l6ZSk7
Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIDc6Cj4gPiAtCQlpZiAoSVNfVkFMTEVZVklFVyhk
ZXZfcHJpdikpCj4gPiAtCQkJdmx2X2dldF9zdG9sZW5fcmVzZXJ2ZWQoZGV2X3ByaXYsCj4gPiAr
CQlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkKPiA+ICsJCQl2bHZfZ2V0X3N0b2xlbl9yZXNlcnZl
ZChpOTE1LAo+ID4gICAJCQkJCQkmcmVzZXJ2ZWRfYmFzZSwgJnJlc2VydmVkX3NpemUpOwo+ID4g
ICAJCWVsc2UKPiA+IC0JCQlnZW43X2dldF9zdG9sZW5fcmVzZXJ2ZWQoZGV2X3ByaXYsCj4gPiAr
CQkJZ2VuN19nZXRfc3RvbGVuX3Jlc2VydmVkKGk5MTUsCj4gPiAgIAkJCQkJCSAmcmVzZXJ2ZWRf
YmFzZSwgJnJlc2VydmVkX3NpemUpOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSA4Ogo+ID4g
ICAJY2FzZSA5Ogo+ID4gICAJY2FzZSAxMDoKPiA+IC0JCWlmIChJU19MUChkZXZfcHJpdikpCj4g
PiAtCQkJY2h2X2dldF9zdG9sZW5fcmVzZXJ2ZWQoZGV2X3ByaXYsCj4gPiArCQlpZiAoSVNfTFAo
aTkxNSkpCj4gPiArCQkJY2h2X2dldF9zdG9sZW5fcmVzZXJ2ZWQoaTkxNSwKPiA+ICAgCQkJCQkJ
JnJlc2VydmVkX2Jhc2UsICZyZXNlcnZlZF9zaXplKTsKPiA+ICAgCQllbHNlCj4gPiAtCQkJYmR3
X2dldF9zdG9sZW5fcmVzZXJ2ZWQoZGV2X3ByaXYsCj4gPiArCQkJYmR3X2dldF9zdG9sZW5fcmVz
ZXJ2ZWQoaTkxNSwKPiA+ICAgCQkJCQkJJnJlc2VydmVkX2Jhc2UsICZyZXNlcnZlZF9zaXplKTsK
PiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgMTE6Cj4gPiAgIAlkZWZhdWx0Ogo+ID4gLQkJaWNs
X2dldF9zdG9sZW5fcmVzZXJ2ZWQoZGV2X3ByaXYsICZyZXNlcnZlZF9iYXNlLAo+ID4gKwkJaWNs
X2dldF9zdG9sZW5fcmVzZXJ2ZWQoaTkxNSwgJnJlc2VydmVkX2Jhc2UsCj4gPiAgIAkJCQkJJnJl
c2VydmVkX3NpemUpOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJfQo+ID4gQEAgLTQzOSwxMiArNDM5
LDEyIEBAIGludCBpOTE1X2dlbV9pbml0X3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiAgIAkJcmVzZXJ2ZWRfc2l6ZSA9IDA7Cj4gPiAgIAl9Cj4gPiAtCWRldl9w
cml2LT5kc21fcmVzZXJ2ZWQgPQo+ID4gKwlpOTE1LT5kc21fcmVzZXJ2ZWQgPQo+ID4gICAJCShz
dHJ1Y3QgcmVzb3VyY2UpIERFRklORV9SRVNfTUVNKHJlc2VydmVkX2Jhc2UsIHJlc2VydmVkX3Np
emUpOwo+ID4gLQlpZiAoIXJlc291cmNlX2NvbnRhaW5zKCZkZXZfcHJpdi0+ZHNtLCAmZGV2X3By
aXYtPmRzbV9yZXNlcnZlZCkpIHsKPiA+ICsJaWYgKCFyZXNvdXJjZV9jb250YWlucygmaTkxNS0+
ZHNtLCAmaTkxNS0+ZHNtX3Jlc2VydmVkKSkgewo+ID4gICAJCURSTV9FUlJPUigiU3RvbGVuIHJl
c2VydmVkIGFyZWEgJXBSIG91dHNpZGUgc3RvbGVuIG1lbW9yeSAlcFJcbiIsCj4gPiAtCQkJICAm
ZGV2X3ByaXYtPmRzbV9yZXNlcnZlZCwgJmRldl9wcml2LT5kc20pOwo+ID4gKwkJCSAgJmk5MTUt
PmRzbV9yZXNlcnZlZCwgJmk5MTUtPmRzbSk7Cj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAgIAl9Cj4g
PiBAQCAtNDUzLDE0ICs0NTMsMTQgQEAgaW50IGk5MTVfZ2VtX2luaXRfc3RvbGVuKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXJlc2VydmVkX3RvdGFsID0gc3RvbGVu
X3RvcCAtIHJlc2VydmVkX2Jhc2U7Cj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJNZW1vcnkgcmVz
ZXJ2ZWQgZm9yIGdyYXBoaWNzIGRldmljZTogJWxsdUssIHVzYWJsZTogJWxsdUtcbiIsCj4gPiAt
CQkJICh1NjQpcmVzb3VyY2Vfc2l6ZSgmZGV2X3ByaXYtPmRzbSkgPj4gMTAsCj4gPiAtCQkJICgo
dTY0KXJlc291cmNlX3NpemUoJmRldl9wcml2LT5kc20pIC0gcmVzZXJ2ZWRfdG90YWwpID4+IDEw
KTsKPiA+ICsJCQkgKHU2NClyZXNvdXJjZV9zaXplKCZpOTE1LT5kc20pID4+IDEwLAo+ID4gKwkJ
CSAoKHU2NClyZXNvdXJjZV9zaXplKCZpOTE1LT5kc20pIC0gcmVzZXJ2ZWRfdG90YWwpID4+IDEw
KTsKPiA+IC0JZGV2X3ByaXYtPnN0b2xlbl91c2FibGVfc2l6ZSA9Cj4gPiAtCQlyZXNvdXJjZV9z
aXplKCZkZXZfcHJpdi0+ZHNtKSAtIHJlc2VydmVkX3RvdGFsOwo+ID4gKwlpOTE1LT5zdG9sZW5f
dXNhYmxlX3NpemUgPQo+ID4gKwkJcmVzb3VyY2Vfc2l6ZSgmaTkxNS0+ZHNtKSAtIHJlc2VydmVk
X3RvdGFsOwo+ID4gICAJLyogQmFzaWMgbWVtcmFuZ2UgYWxsb2NhdG9yIGZvciBzdG9sZW4gc3Bh
Y2UuICovCj4gPiAtCWRybV9tbV9pbml0KCZkZXZfcHJpdi0+bW0uc3RvbGVuLCAwLCBkZXZfcHJp
di0+c3RvbGVuX3VzYWJsZV9zaXplKTsKPiA+ICsJZHJtX21tX2luaXQoJmk5MTUtPm1tLnN0b2xl
biwgMCwgaTkxNS0+c3RvbGVuX3VzYWJsZV9zaXplKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9
Cj4gPiBAQCAtNDY5LDExICs0NjksMTEgQEAgc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqCj4gPiAg
IGk5MTVfcGFnZXNfY3JlYXRlX2Zvcl9zdG9sZW4oc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiA+
ICAgCQkJICAgICByZXNvdXJjZV9zaXplX3Qgb2Zmc2V0LCByZXNvdXJjZV9zaXplX3Qgc2l6ZSkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYp
Owo+ID4gICAJc3RydWN0IHNnX3RhYmxlICpzdDsKPiA+ICAgCXN0cnVjdCBzY2F0dGVybGlzdCAq
c2c7Cj4gPiAtCUdFTV9CVUdfT04ocmFuZ2Vfb3ZlcmZsb3dzKG9mZnNldCwgc2l6ZSwgcmVzb3Vy
Y2Vfc2l6ZSgmZGV2X3ByaXYtPmRzbSkpKTsKPiA+ICsJR0VNX0JVR19PTihyYW5nZV9vdmVyZmxv
d3Mob2Zmc2V0LCBzaXplLCByZXNvdXJjZV9zaXplKCZpOTE1LT5kc20pKSk7Cj4gPiAgIAkvKiBX
ZSBoaWRlIHRoYXQgd2UgaGF2ZSBubyBzdHJ1Y3QgcGFnZSBiYWNraW5nIG91ciBzdG9sZW4gb2Jq
ZWN0Cj4gPiAgIAkgKiBieSB3cmFwcGluZyB0aGUgY29udGlndW91cyBwaHlzaWNhbCBhbGxvY2F0
aW9uIHdpdGggYSBmYWtlCj4gPiBAQCAtNDkzLDcgKzQ5Myw3IEBAIGk5MTVfcGFnZXNfY3JlYXRl
X2Zvcl9zdG9sZW4oc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiA+ICAgCXNnLT5vZmZzZXQgPSAw
Owo+ID4gICAJc2ctPmxlbmd0aCA9IHNpemU7Cj4gPiAtCXNnX2RtYV9hZGRyZXNzKHNnKSA9IChk
bWFfYWRkcl90KWRldl9wcml2LT5kc20uc3RhcnQgKyBvZmZzZXQ7Cj4gPiArCXNnX2RtYV9hZGRy
ZXNzKHNnKSA9IChkbWFfYWRkcl90KWk5MTUtPmRzbS5zdGFydCArIG9mZnNldDsKPiA+ICAgCXNn
X2RtYV9sZW4oc2cpID0gc2l6ZTsKPiA+ICAgCXJldHVybiBzdDsKPiA+IEBAIC01MjQsMTQgKzUy
NCwxNCBAQCBzdGF0aWMgdm9pZCBpOTE1X2dlbV9vYmplY3RfcHV0X3BhZ2VzX3N0b2xlbihzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ID4gICBzdGF0aWMgdm9pZAo+ID4gICBpOTE1
X2dlbV9vYmplY3RfcmVsZWFzZV9zdG9sZW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KG9iai0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgZHJtX21tX25vZGUgKnN0b2xl
biA9IGZldGNoX2FuZF96ZXJvKCZvYmotPnN0b2xlbik7Cj4gPiAgIAlHRU1fQlVHX09OKCFzdG9s
ZW4pOwo+ID4gICAJX19pOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMob2JqKTsKPiA+IC0JaTkx
NV9nZW1fc3RvbGVuX3JlbW92ZV9ub2RlKGRldl9wcml2LCBzdG9sZW4pOwo+ID4gKwlpOTE1X2dl
bV9zdG9sZW5fcmVtb3ZlX25vZGUoaTkxNSwgc3RvbGVuKTsKPiA+ICAgCWtmcmVlKHN0b2xlbik7
Cj4gPiAgIH0KPiA+IEBAIC01NDIsNyArNTQyLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0X29wcyBpOTE1X2dlbV9vYmplY3Rfc3RvbGVuX29wcyA9IHsKPiA+ICAg
fTsKPiA+ICAgc3RhdGljIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICoKPiA+IC1faTkxNV9n
ZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gK19pOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgIHN0cnVjdCBkcm1fbW1fbm9kZSAqc3RvbGVuKQo+
ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+ID4gQEAgLTU1
MiwxMiArNTUyLDEyIEBAIF9pOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlpZiAob2JqID09IE5VTEwpCj4gPiAgIAkJ
cmV0dXJuIE5VTEw7Cj4gPiAtCWRybV9nZW1fcHJpdmF0ZV9vYmplY3RfaW5pdCgmZGV2X3ByaXYt
PmRybSwgJm9iai0+YmFzZSwgc3RvbGVuLT5zaXplKTsKPiA+ICsJZHJtX2dlbV9wcml2YXRlX29i
amVjdF9pbml0KCZpOTE1LT5kcm0sICZvYmotPmJhc2UsIHN0b2xlbi0+c2l6ZSk7Cj4gPiAgIAlp
OTE1X2dlbV9vYmplY3RfaW5pdChvYmosICZpOTE1X2dlbV9vYmplY3Rfc3RvbGVuX29wcyk7Cj4g
PiAgIAlvYmotPnN0b2xlbiA9IHN0b2xlbjsKPiA+ICAgCW9iai0+cmVhZF9kb21haW5zID0gSTkx
NV9HRU1fRE9NQUlOX0NQVSB8IEk5MTVfR0VNX0RPTUFJTl9HVFQ7Cj4gPiAtCWNhY2hlX2xldmVs
ID0gSEFTX0xMQyhkZXZfcHJpdikgPyBJOTE1X0NBQ0hFX0xMQyA6IEk5MTVfQ0FDSEVfTk9ORTsK
PiA+ICsJY2FjaGVfbGV2ZWwgPSBIQVNfTExDKGk5MTUpID8gSTkxNV9DQUNIRV9MTEMgOiBJOTE1
X0NBQ0hFX05PTkU7Cj4gPiAgIAlpOTE1X2dlbV9vYmplY3Rfc2V0X2NhY2hlX2NvaGVyZW5jeShv
YmosIGNhY2hlX2xldmVsKTsKPiA+ICAgCWlmIChpOTE1X2dlbV9vYmplY3RfcGluX3BhZ2VzKG9i
aikpCj4gPiBAQCAtNTcxLDE0ICs1NzEsMTQgQEAgX2k5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3Rv
bGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgfQo+ID4gICBzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqCj4gPiAtaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9s
ZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2k5MTVfZ2VtX29iamVj
dF9jcmVhdGVfc3RvbGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkg
ICAgICByZXNvdXJjZV9zaXplX3Qgc2l6ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iajsKPiA+ICAgCXN0cnVjdCBkcm1fbW1fbm9kZSAqc3RvbGVuOwo+ID4g
ICAJaW50IHJldDsKPiA+IC0JaWYgKCFkcm1fbW1faW5pdGlhbGl6ZWQoJmRldl9wcml2LT5tbS5z
dG9sZW4pKQo+ID4gKwlpZiAoIWRybV9tbV9pbml0aWFsaXplZCgmaTkxNS0+bW0uc3RvbGVuKSkK
PiA+ICAgCQlyZXR1cm4gTlVMTDsKPiA+ICAgCWlmIChzaXplID09IDApCj4gPiBAQCAtNTg4LDM3
ICs1ODgsMzcgQEAgaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW4oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJaWYgKCFzdG9sZW4pCj4gPiAgIAkJcmV0dXJuIE5V
TEw7Cj4gPiAtCXJldCA9IGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZShkZXZfcHJpdiwgc3Rv
bGVuLCBzaXplLCA0MDk2KTsKPiA+ICsJcmV0ID0gaTkxNV9nZW1fc3RvbGVuX2luc2VydF9ub2Rl
KGk5MTUsIHN0b2xlbiwgc2l6ZSwgNDA5Nik7Cj4gPiAgIAlpZiAocmV0KSB7Cj4gPiAgIAkJa2Zy
ZWUoc3RvbGVuKTsKPiA+ICAgCQlyZXR1cm4gTlVMTDsKPiA+ICAgCX0KPiA+IC0Jb2JqID0gX2k5
MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuKGRldl9wcml2LCBzdG9sZW4pOwo+ID4gKwlvYmog
PSBfaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW4oaTkxNSwgc3RvbGVuKTsKPiA+ICAgCWlm
IChvYmopCj4gPiAgIAkJcmV0dXJuIG9iajsKPiA+IC0JaTkxNV9nZW1fc3RvbGVuX3JlbW92ZV9u
b2RlKGRldl9wcml2LCBzdG9sZW4pOwo+ID4gKwlpOTE1X2dlbV9zdG9sZW5fcmVtb3ZlX25vZGUo
aTkxNSwgc3RvbGVuKTsKPiA+ICAgCWtmcmVlKHN0b2xlbik7Cj4gPiAgIAlyZXR1cm4gTlVMTDsK
PiA+ICAgfQo+ID4gICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqCj4gPiAtaTkxNV9nZW1f
b2JqZWN0X2NyZWF0ZV9zdG9sZW5fZm9yX3ByZWFsbG9jYXRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiAraTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW5fZm9yX3By
ZWFsbG9jYXRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICAg
ICAgcmVzb3VyY2Vfc2l6ZV90IHN0b2xlbl9vZmZzZXQsCj4gPiAgIAkJCQkJICAgICAgIHJlc291
cmNlX3NpemVfdCBndHRfb2Zmc2V0LAo+ID4gICAJCQkJCSAgICAgICByZXNvdXJjZV9zaXplX3Qg
c2l6ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5n
Z3R0Owo+ID4gKwlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmk5MTUtPmdndHQ7Cj4gPiAgIAlz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+ID4gICAJc3RydWN0IGRybV9tbV9ub2Rl
ICpzdG9sZW47Cj4gPiAgIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiA+ICAgCWludCByZXQ7Cj4g
PiAtCWlmICghZHJtX21tX2luaXRpYWxpemVkKCZkZXZfcHJpdi0+bW0uc3RvbGVuKSkKPiA+ICsJ
aWYgKCFkcm1fbW1faW5pdGlhbGl6ZWQoJmk5MTUtPm1tLnN0b2xlbikpCj4gPiAgIAkJcmV0dXJu
IE5VTEw7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5kcm0uc3RydWN0X211
dGV4KTsKPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Cj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJjcmVhdGluZyBwcmVhbGxvY2F0ZWQgc3RvbGVuIG9i
amVjdDogc3RvbGVuX29mZnNldD0lcGEsIGd0dF9vZmZzZXQ9JXBhLCBzaXplPSVwYVxuIiwKPiA+
ICAgCQkJICZzdG9sZW5fb2Zmc2V0LCAmZ3R0X29mZnNldCwgJnNpemUpOwo+ID4gQEAgLTYzNSwx
OSArNjM1LDE5IEBAIGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuX2Zvcl9wcmVhbGxvY2F0
ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2Cj4gPiAgIAlzdG9sZW4tPnN0YXJ0
ID0gc3RvbGVuX29mZnNldDsKPiA+ICAgCXN0b2xlbi0+c2l6ZSA9IHNpemU7Cj4gPiAtCW11dGV4
X2xvY2soJmRldl9wcml2LT5tbS5zdG9sZW5fbG9jayk7Cj4gPiAtCXJldCA9IGRybV9tbV9yZXNl
cnZlX25vZGUoJmRldl9wcml2LT5tbS5zdG9sZW4sIHN0b2xlbik7Cj4gPiAtCW11dGV4X3VubG9j
aygmZGV2X3ByaXYtPm1tLnN0b2xlbl9sb2NrKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+bW0u
c3RvbGVuX2xvY2spOwo+ID4gKwlyZXQgPSBkcm1fbW1fcmVzZXJ2ZV9ub2RlKCZpOTE1LT5tbS5z
dG9sZW4sIHN0b2xlbik7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+bW0uc3RvbGVuX2xvY2sp
Owo+ID4gICAJaWYgKHJldCkgewo+ID4gICAJCURSTV9ERUJVR19EUklWRVIoImZhaWxlZCB0byBh
bGxvY2F0ZSBzdG9sZW4gc3BhY2VcbiIpOwo+ID4gICAJCWtmcmVlKHN0b2xlbik7Cj4gPiAgIAkJ
cmV0dXJuIE5VTEw7Cj4gPiAgIAl9Cj4gPiAtCW9iaiA9IF9pOTE1X2dlbV9vYmplY3RfY3JlYXRl
X3N0b2xlbihkZXZfcHJpdiwgc3RvbGVuKTsKPiA+ICsJb2JqID0gX2k5MTVfZ2VtX29iamVjdF9j
cmVhdGVfc3RvbGVuKGk5MTUsIHN0b2xlbik7Cj4gPiAgIAlpZiAob2JqID09IE5VTEwpIHsKPiA+
ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJmYWlsZWQgdG8gYWxsb2NhdGUgc3RvbGVuIG9iamVjdFxu
Iik7Cj4gPiAtCQlpOTE1X2dlbV9zdG9sZW5fcmVtb3ZlX25vZGUoZGV2X3ByaXYsIHN0b2xlbik7
Cj4gPiArCQlpOTE1X2dlbV9zdG9sZW5fcmVtb3ZlX25vZGUoaTkxNSwgc3RvbGVuKTsKPiA+ICAg
CQlrZnJlZShzdG9sZW4pOwo+ID4gICAJCXJldHVybiBOVUxMOwo+ID4gICAJfQo+ID4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90aWxpbmcuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90aWxpbmcuYwo+ID4gaW5kZXggY2EwYzJmNDUx
NzQyLi40NmI1MjNkNGVkODQgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fdGlsaW5nLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV90aWxpbmcuYwo+ID4gQEAgLTM5OCw3ICszOTgsNyBAQCBpOTE1X2dlbV9nZXRfdGls
aW5nX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAgIAkJCSAg
c3RydWN0IGRybV9maWxlICpmaWxlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X2dldF90aWxpbmcgKmFyZ3MgPSBkYXRhOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
ajsKPiA+ICAgCWludCBlcnIgPSAtRU5PRU5UOwo+ID4gQEAgLTQxNSwxMCArNDE1LDEwIEBAIGk5
MTVfZ2VtX2dldF90aWxpbmdfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0
YSwKPiA+ICAgCXN3aXRjaCAoYXJncy0+dGlsaW5nX21vZGUpIHsKPiA+ICAgCWNhc2UgSTkxNV9U
SUxJTkdfWDoKPiA+IC0JCWFyZ3MtPnN3aXp6bGVfbW9kZSA9IGRldl9wcml2LT5tbS5iaXRfNl9z
d2l6emxlX3g7Cj4gPiArCQlhcmdzLT5zd2l6emxlX21vZGUgPSBpOTE1LT5tbS5iaXRfNl9zd2l6
emxlX3g7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5MTVfVElMSU5HX1k6Cj4gPiAtCQlh
cmdzLT5zd2l6emxlX21vZGUgPSBkZXZfcHJpdi0+bW0uYml0XzZfc3dpenpsZV95Owo+ID4gKwkJ
YXJncy0+c3dpenpsZV9tb2RlID0gaTkxNS0+bW0uYml0XzZfc3dpenpsZV95Owo+ID4gICAJCWJy
ZWFrOwo+ID4gICAJZGVmYXVsdDoKPiA+ICAgCWNhc2UgSTkxNV9USUxJTkdfTk9ORToKPiA+IEBA
IC00MjcsNyArNDI3LDcgQEAgaTkxNV9nZW1fZ2V0X3RpbGluZ19pb2N0bChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ID4gICAJfQo+ID4gICAJLyogSGlkZSBiaXQgMTcgZnJv
bSB0aGUgdXNlciAtLSBzZWUgY29tbWVudCBpbiBpOTE1X2dlbV9zZXRfdGlsaW5nICovCj4gPiAt
CWlmIChkZXZfcHJpdi0+cXVpcmtzICYgUVVJUktfUElOX1NXSVpaTEVEX1BBR0VTKQo+ID4gKwlp
ZiAoaTkxNS0+cXVpcmtzICYgUVVJUktfUElOX1NXSVpaTEVEX1BBR0VTKQo+ID4gICAJCWFyZ3Mt
PnBoeXNfc3dpenpsZV9tb2RlID0gSTkxNV9CSVRfNl9TV0laWkxFX1VOS05PV047Cj4gPiAgIAll
bHNlCj4gPiAgIAkJYXJncy0+cGh5c19zd2l6emxlX21vZGUgPSBhcmdzLT5zd2l6emxlX21vZGU7
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJw
dHIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMKPiA+IGlu
ZGV4IDUyOGI2MTY3ODMzNC4uZjIyZTEwZTg4OTVhIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYwo+ID4gQEAgLTMyNywxMiArMzI3LDEyIEBA
IGk5MTVfbW11X25vdGlmaWVyX2ZyZWUoc3RydWN0IGk5MTVfbW11X25vdGlmaWVyICptbiwKPiA+
ICAgI2VuZGlmCj4gPiAgIHN0YXRpYyBzdHJ1Y3QgaTkxNV9tbV9zdHJ1Y3QgKgo+ID4gLV9faTkx
NV9tbV9zdHJ1Y3RfZmluZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHN0cnVj
dCBtbV9zdHJ1Y3QgKnJlYWwpCj4gPiArX19pOTE1X21tX3N0cnVjdF9maW5kKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LCBzdHJ1Y3QgbW1fc3RydWN0ICpyZWFsKQo+ID4gICB7Cj4gPiAg
IAlzdHJ1Y3QgaTkxNV9tbV9zdHJ1Y3QgKm1tOwo+ID4gLQkvKiBQcm90ZWN0ZWQgYnkgZGV2X3By
aXYtPm1tX2xvY2sgKi8KPiA+IC0JaGFzaF9mb3JfZWFjaF9wb3NzaWJsZShkZXZfcHJpdi0+bW1f
c3RydWN0cywgbW0sIG5vZGUsICh1bnNpZ25lZCBsb25nKXJlYWwpCj4gPiArCS8qIFByb3RlY3Rl
ZCBieSBpOTE1LT5tbV9sb2NrICovCj4gPiArCWhhc2hfZm9yX2VhY2hfcG9zc2libGUoaTkxNS0+
bW1fc3RydWN0cywgbW0sIG5vZGUsICh1bnNpZ25lZCBsb25nKXJlYWwpCj4gPiAgIAkJaWYgKG1t
LT5tbSA9PSByZWFsKQo+ID4gICAJCQlyZXR1cm4gbW07Cj4gPiBAQCAtMzQyLDcgKzM0Miw3IEBA
IF9faTkxNV9tbV9zdHJ1Y3RfZmluZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IHN0cnVjdCBtbV9zdHJ1Y3QgKnJlYWwpCj4gPiAgIHN0YXRpYyBpbnQKPiA+ICAgaTkxNV9nZW1f
dXNlcnB0cl9pbml0X19tbV9zdHJ1Y3Qoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KG9iai0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUob2JqLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9tbV9zdHJ1Y3QgKm1tOwo+
ID4gICAJaW50IHJldCA9IDA7Cj4gPiBAQCAtMzU2LDggKzM1Niw4IEBAIGk5MTVfZ2VtX3VzZXJw
dHJfaW5pdF9fbW1fc3RydWN0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gPiAg
IAkgKiBzdHJ1Y3RfbXV0ZXgsIGkuZS4gd2UgbmVlZCB0byBzY2hlZHVsZSBhIHdvcmtlciB0byBk
byB0aGUgY2xlYW4KPiA+ICAgCSAqIHVwLgo+ID4gICAJICovCj4gPiAtCW11dGV4X2xvY2soJmRl
dl9wcml2LT5tbV9sb2NrKTsKPiA+IC0JbW0gPSBfX2k5MTVfbW1fc3RydWN0X2ZpbmQoZGV2X3By
aXYsIGN1cnJlbnQtPm1tKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+bW1fbG9jayk7Cj4gPiAr
CW1tID0gX19pOTE1X21tX3N0cnVjdF9maW5kKGk5MTUsIGN1cnJlbnQtPm1tKTsKPiA+ICAgCWlm
IChtbSA9PSBOVUxMKSB7Cj4gPiAgIAkJbW0gPSBrbWFsbG9jKHNpemVvZigqbW0pLCBHRlBfS0VS
TkVMKTsKPiA+ICAgCQlpZiAobW0gPT0gTlVMTCkgewo+ID4gQEAgLTM3MywxNSArMzczLDE1IEBA
IGk5MTVfZ2VtX3VzZXJwdHJfaW5pdF9fbW1fc3RydWN0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCj4gPiAgIAkJbW0tPm1uID0gTlVMTDsKPiA+IC0JCS8qIFByb3RlY3RlZCBieSBk
ZXZfcHJpdi0+bW1fbG9jayAqLwo+ID4gLQkJaGFzaF9hZGQoZGV2X3ByaXYtPm1tX3N0cnVjdHMs
Cj4gPiArCQkvKiBQcm90ZWN0ZWQgYnkgaTkxNS0+bW1fbG9jayAqLwo+ID4gKwkJaGFzaF9hZGQo
aTkxNS0+bW1fc3RydWN0cywKPiA+ICAgCQkJICZtbS0+bm9kZSwgKHVuc2lnbmVkIGxvbmcpbW0t
Pm1tKTsKPiA+ICAgCX0gZWxzZQo+ID4gICAJCWtyZWZfZ2V0KCZtbS0+a3JlZik7Cj4gPiAgIAlv
YmotPnVzZXJwdHIubW0gPSBtbTsKPiA+ICAgb3V0Ogo+ID4gLQltdXRleF91bmxvY2soJmRldl9w
cml2LT5tbV9sb2NrKTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5tbV9sb2NrKTsKPiA+ICAg
CXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IEBAIC0zOTksNyArMzk5LDcgQEAgX19pOTE1X21tX3N0
cnVjdF9mcmVlKHN0cnVjdCBrcmVmICprcmVmKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9t
bV9zdHJ1Y3QgKm1tID0gY29udGFpbmVyX29mKGtyZWYsIHR5cGVvZigqbW0pLCBrcmVmKTsKPiA+
IC0JLyogUHJvdGVjdGVkIGJ5IGRldl9wcml2LT5tbV9sb2NrICovCj4gPiArCS8qIFByb3RlY3Rl
ZCBieSBpOTE1LT5tbV9sb2NrICovCj4gPiAgIAloYXNoX2RlbCgmbW0tPm5vZGUpOwo+ID4gICAJ
bXV0ZXhfdW5sb2NrKCZtbS0+aTkxNS0+bW1fbG9jayk7Cj4gPiBAQCAtNzQxLDEzICs3NDEsMTMg
QEAgaTkxNV9nZW1fdXNlcnB0cl9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ID4gICAJ
CSAgICAgICB2b2lkICpkYXRhLAo+ID4gICAJCSAgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2
KTsKPiA+ICAgCXN0cnVjdCBkcm1faTkxNV9nZW1fdXNlcnB0ciAqYXJncyA9IGRhdGE7Cj4gPiAg
IAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+ID4gICAJaW50IHJldDsKPiA+ICAg
CXUzMiBoYW5kbGU7Cj4gPiAtCWlmICghSEFTX0xMQyhkZXZfcHJpdikgJiYgIUhBU19TTk9PUChk
ZXZfcHJpdikpIHsKPiA+ICsJaWYgKCFIQVNfTExDKGk5MTUpICYmICFIQVNfU05PT1AoaTkxNSkp
IHsKPiA+ICAgCQkvKiBXZSBjYW5ub3Qgc3VwcG9ydCBjb2hlcmVudCB1c2VycHRyIG9iamVjdHMg
b24gaHcgd2l0aG91dAo+ID4gICAJCSAqIExMQyBhbmQgYnJva2VuIHNub29waW5nLgo+ID4gICAJ
CSAqLwo+ID4gQEAgLTc3NCw3ICs3NzQsNyBAQCBpOTE1X2dlbV91c2VycHRyX2lvY3RsKHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgIAkJICogT24gYWxtb3N0IGFsbCBvZiB0aGUgb2xkZXIg
aHcsIHdlIGNhbm5vdCB0ZWxsIHRoZSBHUFUgdGhhdAo+ID4gICAJCSAqIGEgcGFnZSBpcyByZWFk
b25seS4KPiA+ICAgCQkgKi8KPiA+IC0JCXZtID0gZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0LT52
bTsKPiA+ICsJCXZtID0gaTkxNS0+a2VybmVsX2NvbnRleHQtPnZtOwo+ID4gICAJCWlmICghdm0g
fHwgIXZtLT5oYXNfcmVhZF9vbmx5KQo+ID4gICAJCQlyZXR1cm4gLUVOT0RFVjsKPiA+ICAgCX0K
PiA+IEBAIC04MTIsMjIgKzgxMiwyMiBAQCBpOTE1X2dlbV91c2VycHRyX2lvY3RsKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4gLWludCBpOTE1X2dl
bV9pbml0X3VzZXJwdHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2lu
dCBpOTE1X2dlbV9pbml0X3VzZXJwdHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+IC0JbXV0ZXhfaW5pdCgmZGV2X3ByaXYtPm1tX2xvY2spOwo+ID4gLQloYXNoX2lu
aXQoZGV2X3ByaXYtPm1tX3N0cnVjdHMpOwo+ID4gKwltdXRleF9pbml0KCZpOTE1LT5tbV9sb2Nr
KTsKPiA+ICsJaGFzaF9pbml0KGk5MTUtPm1tX3N0cnVjdHMpOwo+ID4gLQlkZXZfcHJpdi0+bW0u
dXNlcnB0cl93cSA9Cj4gPiArCWk5MTUtPm1tLnVzZXJwdHJfd3EgPQo+ID4gICAJCWFsbG9jX3dv
cmtxdWV1ZSgiaTkxNS11c2VycHRyLWFjcXVpcmUiLAo+ID4gICAJCQkJV1FfSElHSFBSSSB8IFdR
X1VOQk9VTkQsCj4gPiAgIAkJCQkwKTsKPiA+IC0JaWYgKCFkZXZfcHJpdi0+bW0udXNlcnB0cl93
cSkKPiA+ICsJaWYgKCFpOTE1LT5tbS51c2VycHRyX3dxKQo+ID4gICAJCXJldHVybiAtRU5PTUVN
Owo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IC12b2lkIGk5MTVfZ2VtX2NsZWFudXBfdXNl
cnB0cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpOTE1X2dl
bV9jbGVhbnVwX3VzZXJwdHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsK
PiA+IC0JZGVzdHJveV93b3JrcXVldWUoZGV2X3ByaXYtPm1tLnVzZXJwdHJfd3EpOwo+ID4gKwlk
ZXN0cm95X3dvcmtxdWV1ZShpOTE1LT5tbS51c2VycHRyX3dxKTsKPiA+ICAgfQo+ID4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKPiA+IGluZGV4
IDczZTY2N2IzMWNjNC4uNzg3OTc2OTlmZWIwIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jCj4gPiBAQCAtMTQxNSw4ICsxNDE1
LDggQEAgc3RhdGljIGludCBpZ3RfcHBndHRfZ2VtZnNfaHVnZSh2b2lkICphcmcpCj4gPiAgIHN0
YXRpYyBpbnQgaWd0X3BwZ3R0X3Bpbl91cGRhdGUodm9pZCAqYXJnKQo+ID4gICB7Cj4gPiAgIAlz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gYXJnOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBjdHgtPmk5MTU7Cj4gPiAtCXVuc2lnbmVkIGxvbmcgc3VwcG9y
dGVkID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPnBhZ2Vfc2l6ZXM7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gY3R4LT5pOTE1Owo+ID4gKwl1bnNpZ25lZCBsb25nIHN1cHBv
cnRlZCA9IElOVEVMX0lORk8oaTkxNSktPnBhZ2Vfc2l6ZXM7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm07Cj4gPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqOwo+ID4gICAJc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gPiBAQCAtMTQ0Myw3ICsx
NDQzLDcgQEAgc3RhdGljIGludCBpZ3RfcHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcpCj4gPiAg
IAlmb3JfZWFjaF9zZXRfYml0X2Zyb20oZmlyc3QsICZzdXBwb3J0ZWQsIGxhc3QgKyAxKSB7Cj4g
PiAgIAkJdW5zaWduZWQgaW50IHBhZ2Vfc2l6ZSA9IEJJVChmaXJzdCk7Cj4gPiAtCQlvYmogPSBp
OTE1X2dlbV9vYmplY3RfY3JlYXRlX2ludGVybmFsKGRldl9wcml2LCBwYWdlX3NpemUpOwo+ID4g
KwkJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1LCBwYWdlX3NpemUp
Owo+ID4gICAJCWlmIChJU19FUlIob2JqKSkKPiA+ICAgCQkJcmV0dXJuIFBUUl9FUlIob2JqKTsK
PiA+IEBAIC0xNDk3LDcgKzE0OTcsNyBAQCBzdGF0aWMgaW50IGlndF9wcGd0dF9waW5fdXBkYXRl
KHZvaWQgKmFyZykKPiA+ICAgCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7Cj4gPiAgIAl9Cj4g
PiAtCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoZGV2X3ByaXYsIFBBR0Vf
U0laRSk7Cj4gPiArCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoaTkxNSwg
UEFHRV9TSVpFKTsKPiA+ICAgCWlmIChJU19FUlIob2JqKSkKPiA+ICAgCQlyZXR1cm4gUFRSX0VS
UihvYmopOwo+ID4gQEAgLTE1MTgsNyArMTUxOCw3IEBAIHN0YXRpYyBpbnQgaWd0X3BwZ3R0X3Bp
bl91cGRhdGUodm9pZCAqYXJnKQo+ID4gICAJICogbGFuZCBpbiB0aGUgbm93IHN0YWxlIDJNIHBh
Z2UuCj4gPiAgIAkgKi8KPiA+IC0JZXJyID0gZ3B1X3dyaXRlKHZtYSwgY3R4LCBkZXZfcHJpdi0+
ZW5naW5lW1JDUzBdLCAwLCAweGRlYWRiZWFmKTsKPiA+ICsJZXJyID0gZ3B1X3dyaXRlKHZtYSwg
Y3R4LCBpOTE1LT5lbmdpbmVbUkNTMF0sIDAsIDB4ZGVhZGJlYWYpOwo+ID4gICAJaWYgKGVycikK
PiA+ICAgCQlnb3RvIG91dF91bnBpbjsKPiA+IEBAIC0xNjgyLDIwICsxNjgyLDIwIEBAIGludCBp
OTE1X2dlbV9odWdlX3BhZ2VfbW9ja19zZWxmdGVzdHModm9pZCkKPiA+ICAgCQlTVUJURVNUKGln
dF9tb2NrX3BwZ3R0X2h1Z2VfZmlsbCksCj4gPiAgIAkJU1VCVEVTVChpZ3RfbW9ja19wcGd0dF82
NEspLAo+ID4gICAJfTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2Owo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKPiA+ICAgCXN0cnVjdCBpOTE1X3Bw
Z3R0ICpwcGd0dDsKPiA+ICAgCWludCBlcnI7Cj4gPiAtCWRldl9wcml2ID0gbW9ja19nZW1fZGV2
aWNlKCk7Cj4gPiAtCWlmICghZGV2X3ByaXYpCj4gPiArCWk5MTUgPSBtb2NrX2dlbV9kZXZpY2Uo
KTsKPiA+ICsJaWYgKCFpOTE1KQo+ID4gICAJCXJldHVybiAtRU5PTUVNOwo+ID4gICAJLyogUHJl
dGVuZCB0byBiZSBhIGRldmljZSB3aGljaCBzdXBwb3J0cyB0aGUgNDhiIFBQR1RUICovCj4gPiAt
CW1rd3JpdGVfZGV2aWNlX2luZm8oZGV2X3ByaXYpLT5wcGd0dF90eXBlID0gSU5URUxfUFBHVFRf
RlVMTDsKPiA+IC0JbWt3cml0ZV9kZXZpY2VfaW5mbyhkZXZfcHJpdiktPnBwZ3R0X3NpemUgPSA0
ODsKPiA+ICsJbWt3cml0ZV9kZXZpY2VfaW5mbyhpOTE1KS0+cHBndHRfdHlwZSA9IElOVEVMX1BQ
R1RUX0ZVTEw7Cj4gPiArCW1rd3JpdGVfZGV2aWNlX2luZm8oaTkxNSktPnBwZ3R0X3NpemUgPSA0
ODsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQlw
cGd0dCA9IGk5MTVfcHBndHRfY3JlYXRlKGRldl9wcml2KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCXBwZ3R0ID0gaTkxNV9wcGd0dF9jcmVhdGUoaTkx
NSk7Cj4gPiAgIAlpZiAoSVNfRVJSKHBwZ3R0KSkgewo+ID4gICAJCWVyciA9IFBUUl9FUlIocHBn
dHQpOwo+ID4gICAJCWdvdG8gb3V0X3VubG9jazsKPiA+IEBAIC0xNzIwLDEzICsxNzIwLDEzIEBA
IGludCBpOTE1X2dlbV9odWdlX3BhZ2VfbW9ja19zZWxmdGVzdHModm9pZCkKPiA+ICAgCWk5MTVf
dm1fcHV0KCZwcGd0dC0+dm0pOwo+ID4gICBvdXRfdW5sb2NrOgo+ID4gLQltdXRleF91bmxvY2so
JmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+IC0JZHJtX2Rldl9wdXQoJmRldl9wcml2
LT5kcm0pOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4g
Kwlkcm1fZGV2X3B1dCgmaTkxNS0+ZHJtKTsKPiA+ICAgCXJldHVybiBlcnI7Cj4gPiAgIH0KPiA+
IC1pbnQgaTkxNV9nZW1faHVnZV9wYWdlX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQgaTkxNV9nZW1faHVnZV9wYWdlX2xpdmVfc2VsZnRl
c3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdGF0aWMg
Y29uc3Qgc3RydWN0IGk5MTVfc3VidGVzdCB0ZXN0c1tdID0gewo+ID4gICAJCVNVQlRFU1QoaWd0
X3Nocmlua190aHApLAo+ID4gQEAgLTE3NDEsMjIgKzE3NDEsMjIgQEAgaW50IGk5MTVfZ2VtX2h1
Z2VfcGFnZV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCWludCBlcnI7Cj4gPiAtCWlm
ICghSEFTX1BQR1RUKGRldl9wcml2KSkgewo+ID4gKwlpZiAoIUhBU19QUEdUVChpOTE1KSkgewo+
ID4gICAJCXByX2luZm8oIlBQR1RUIG5vdCBzdXBwb3J0ZWQsIHNraXBwaW5nIGxpdmUtc2VsZnRl
c3RzXG4iKTsKPiA+ICAgCQlyZXR1cm4gMDsKPiA+ICAgCX0KPiA+IC0JaWYgKGk5MTVfdGVybWlu
YWxseV93ZWRnZWQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoaTkxNV90ZXJtaW5hbGx5X3dlZGdlZChp
OTE1KSkKPiA+ICAgCQlyZXR1cm4gMDsKPiA+IC0JZmlsZSA9IG1vY2tfZmlsZShkZXZfcHJpdik7
Cj4gPiArCWZpbGUgPSBtb2NrX2ZpbGUoaTkxNSk7Cj4gPiAgIAlpZiAoSVNfRVJSKGZpbGUpKQo+
ID4gICAJCXJldHVybiBQVFJfRVJSKGZpbGUpOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChk
ZXZfcHJpdik7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4g
Kwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7Cj4gPiAtCWN0eCA9IGxpdmVf
Y29udGV4dChkZXZfcHJpdiwgZmlsZSk7Cj4gPiArCWN0eCA9IGxpdmVfY29udGV4dChpOTE1LCBm
aWxlKTsKPiA+ICAgCWlmIChJU19FUlIoY3R4KSkgewo+ID4gICAJCWVyciA9IFBUUl9FUlIoY3R4
KTsKPiA+ICAgCQlnb3RvIG91dF91bmxvY2s7Cj4gPiBAQCAtMTc2OCwxMCArMTc2OCwxMCBAQCBp
bnQgaTkxNV9nZW1faHVnZV9wYWdlX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICAgCWVyciA9IGk5MTVfc3VidGVzdHModGVzdHMsIGN0eCk7Cj4g
PiAgIG91dF91bmxvY2s6Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtl
cmVmKTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4g
PiArCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOwo+ID4gKwltdXRleF91bmxv
Y2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQltb2NrX2ZpbGVfZnJlZShkZXZfcHJp
diwgZmlsZSk7Cj4gPiArCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwo+ID4gICAJcmV0dXJu
IGVycjsKPiA+ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9z
ZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKPiA+IGluZGV4IDc0YjBlNTg3MWM0Yi4uMmZkY2Fh
MTY2N2JmIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0
cy9pOTE1X2dlbV9jb250ZXh0LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9z
ZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jCj4gPiBAQCAtMTc0OCw3ICsxNzQ4LDcgQEAgaW50
IGk5MTVfZ2VtX2NvbnRleHRfbW9ja19zZWxmdGVzdHModm9pZCkKPiA+ICAgCXJldHVybiBlcnI7
Cj4gPiAgIH0KPiA+IC1pbnQgaTkxNV9nZW1fY29udGV4dF9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAraW50IGk5MTVfZ2VtX2NvbnRleHRfbGl2
ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAg
CXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7Cj4gPiAgIAkJU1VC
VEVTVChsaXZlX25vcF9zd2l0Y2gpLAo+ID4gQEAgLTE3NTksOCArMTc1OSw4IEBAIGludCBpOTE1
X2dlbV9jb250ZXh0X2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICAgCQlTVUJURVNUKGlndF92bV9pc29sYXRpb24pLAo+ID4gICAJfTsKPiA+IC0J
aWYgKGk5MTVfdGVybWluYWxseV93ZWRnZWQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoaTkxNV90ZXJt
aW5hbGx5X3dlZGdlZChpOTE1KSkKPiA+ICAgCQlyZXR1cm4gMDsKPiA+IC0JcmV0dXJuIGk5MTVf
c3VidGVzdHModGVzdHMsIGRldl9wcml2KTsKPiA+ICsJcmV0dXJuIGk5MTVfc3VidGVzdHModGVz
dHMsIGk5MTUpOwo+ID4gICB9Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUu
aAo+ID4gaW5kZXggMTQzOWZhNDA5M2FjLi43NGY5YWQ2NjQ4ZWIgMTAwNjQ0Cj4gPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaAo+ID4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKPiA+IEBAIC00NjUsNyArNDY1LDcgQEAgc3Rh
dGljIGlubGluZSB2b2lkIGludGVsX2VuZ2luZV9yZXNldChzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUsCj4gPiAgIH0KPiA+ICAgYm9vbCBpbnRlbF9lbmdpbmVfaXNfaWRsZShzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwo+ID4gLWJvb2wgaW50ZWxfZW5naW5lc19hcmVfaWRs
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK2Jvb2wgaW50ZWxfZW5n
aW5lc19hcmVfaWRsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIHZvaWQg
aW50ZWxfZW5naW5lX2xvc3RfY29udGV4dChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
Owo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9j
cy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKPiA+IGluZGV4
IGMwZDk4NmRiNWE3NS4uYTA0OGI4NzQzY2U2IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCj4gPiBAQCAtMTYwLDcgKzE2MCw3IEBAIHN0YXRpYyBj
b25zdCBzdHJ1Y3QgZW5naW5lX2luZm8gaW50ZWxfZW5naW5lc1tdID0gewo+ID4gICAvKioKPiA+
ICAgICogaW50ZWxfZW5naW5lX2NvbnRleHRfc2l6ZSgpIC0gcmV0dXJuIHRoZSBzaXplIG9mIHRo
ZSBjb250ZXh0IGZvciBhbiBlbmdpbmUKPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIHBy
aXZhdGUKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgcHJpdmF0ZQo+ID4gICAgKiBAY2xhc3M6
IGVuZ2luZSBjbGFzcwo+ID4gICAgKgo+ID4gICAgKiBFYWNoIGVuZ2luZSBjbGFzcyBtYXkgcmVx
dWlyZSBhIGRpZmZlcmVudCBhbW91bnQgb2Ygc3BhY2UgZm9yIGEgY29udGV4dAo+ID4gQEAgLTE3
Miw3ICsxNzIsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGVuZ2luZV9pbmZvIGludGVsX2VuZ2lu
ZXNbXSA9IHsKPiA+ICAgICogaW4gTFJDIG1vZGUsIGJ1dCBkb2VzIG5vdCBpbmNsdWRlIHRoZSAi
c2hhcmVkIGRhdGEgcGFnZSIgdXNlZCB3aXRoCj4gPiAgICAqIEd1QyBzdWJtaXNzaW9uLiBUaGUg
Y2FsbGVyIHNob3VsZCBhY2NvdW50IGZvciB0aGlzIGlmIHVzaW5nIHRoZSBHdUMuCj4gPiAgICAq
Lwo+ID4gLXUzMiBpbnRlbF9lbmdpbmVfY29udGV4dF9zaXplKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgdTggY2xhc3MpCj4gPiArdTMyIGludGVsX2VuZ2luZV9jb250ZXh0X3Np
emUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU4IGNsYXNzKQo+ID4gICB7Cj4gPiAg
IAl1MzIgY3h0X3NpemU7Cj4gPiBAQCAtMTgwLDkgKzE4MCw5IEBAIHUzMiBpbnRlbF9lbmdpbmVf
Y29udGV4dF9zaXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTggY2xhc3Mp
Cj4gPiAgIAlzd2l0Y2ggKGNsYXNzKSB7Cj4gPiAgIAljYXNlIFJFTkRFUl9DTEFTUzoKPiA+IC0J
CXN3aXRjaCAoSU5URUxfR0VOKGRldl9wcml2KSkgewo+ID4gKwkJc3dpdGNoIChJTlRFTF9HRU4o
aTkxNSkpIHsKPiA+ICAgCQlkZWZhdWx0Ogo+ID4gLQkJCU1JU1NJTkdfQ0FTRShJTlRFTF9HRU4o
ZGV2X3ByaXYpKTsKPiA+ICsJCQlNSVNTSU5HX0NBU0UoSU5URUxfR0VOKGk5MTUpKTsKPiA+ICAg
CQkJcmV0dXJuIERFRkFVTFRfTFJfQ09OVEVYVF9SRU5ERVJfU0laRTsKPiA+ICAgCQljYXNlIDEx
Ogo+ID4gICAJCQlyZXR1cm4gR0VOMTFfTFJfQ09OVEVYVF9SRU5ERVJfU0laRTsKPiA+IEBAIC0x
OTMsNyArMTkzLDcgQEAgdTMyIGludGVsX2VuZ2luZV9jb250ZXh0X3NpemUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCBjbGFzcykKPiA+ICAgCQljYXNlIDg6Cj4gPiAgIAkJ
CXJldHVybiBHRU44X0xSX0NPTlRFWFRfUkVOREVSX1NJWkU7Cj4gPiAgIAkJY2FzZSA3Ogo+ID4g
LQkJCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSkKPiA+ICsJCQlpZiAoSVNfSEFTV0VMTChpOTE1
KSkKPiA+ICAgCQkJCXJldHVybiBIU1dfQ1hUX1RPVEFMX1NJWkU7Cj4gPiAgIAkJCWN4dF9zaXpl
ID0gSTkxNV9SRUFEKEdFTjdfQ1hUX1NJWkUpOwo+ID4gQEAgLTIxNyw3ICsyMTcsNyBAQCB1MzIg
aW50ZWxfZW5naW5lX2NvbnRleHRfc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIHU4IGNsYXNzKQo+ID4gICAJCQkgKi8KPiA+ICAgCQkJY3h0X3NpemUgPSBJOTE1X1JFQUQo
Q1hUX1NJWkUpICsgMTsKPiA+ICAgCQkJRFJNX0RFQlVHX0RSSVZFUigiZ2VuJWQgQ1hUX1NJWkUg
PSAlZCBieXRlcyBbMHglMDh4XVxuIiwKPiA+IC0JCQkJCSBJTlRFTF9HRU4oZGV2X3ByaXYpLAo+
ID4gKwkJCQkJIElOVEVMX0dFTihpOTE1KSwKPiA+ICAgCQkJCQkgY3h0X3NpemUgKiA2NCwKPiA+
ICAgCQkJCQkgY3h0X3NpemUgLSAxKTsKPiA+ICAgCQkJcmV0dXJuIHJvdW5kX3VwKGN4dF9zaXpl
ICogNjQsIFBBR0VfU0laRSk7Cj4gPiBAQCAtMjM0LDcgKzIzNCw3IEBAIHUzMiBpbnRlbF9lbmdp
bmVfY29udGV4dF9zaXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTggY2xh
c3MpCj4gPiAgIAljYXNlIFZJREVPX0RFQ09ERV9DTEFTUzoKPiA+ICAgCWNhc2UgVklERU9fRU5I
QU5DRU1FTlRfQ0xBU1M6Cj4gPiAgIAljYXNlIENPUFlfRU5HSU5FX0NMQVNTOgo+ID4gLQkJaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPCA4KQo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8IDgp
Cj4gPiAgIAkJCXJldHVybiAwOwo+ID4gICAJCXJldHVybiBHRU44X0xSX0NPTlRFWFRfT1RIRVJf
U0laRTsKPiA+ICAgCX0KPiA+IEBAIC0yODQsNyArMjg0LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxf
ZW5naW5lX3Nhbml0aXplX21taW8oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ID4g
ICB9Cj4gPiAgIHN0YXRpYyBpbnQKPiA+IC1pbnRlbF9lbmdpbmVfc2V0dXAoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2ludGVsX2VuZ2luZV9zZXR1cChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkgICBlbnVtIGludGVsX2VuZ2luZV9pZCBpZCkK
PiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0IGVuZ2luZV9pbmZvICppbmZvID0gJmludGVsX2Vu
Z2luZXNbaWRdOwo+ID4gQEAgLTMwMSwxMCArMzAxLDEwIEBAIGludGVsX2VuZ2luZV9zZXR1cChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlpZiAoR0VNX0RFQlVHX1dB
Uk5fT04oaW5mby0+aW5zdGFuY2UgPiBNQVhfRU5HSU5FX0lOU1RBTkNFKSkKPiA+ICAgCQlyZXR1
cm4gLUVJTlZBTDsKPiA+IC0JaWYgKEdFTV9ERUJVR19XQVJOX09OKGRldl9wcml2LT5lbmdpbmVf
Y2xhc3NbaW5mby0+Y2xhc3NdW2luZm8tPmluc3RhbmNlXSkpCj4gPiArCWlmIChHRU1fREVCVUdf
V0FSTl9PTihpOTE1LT5lbmdpbmVfY2xhc3NbaW5mby0+Y2xhc3NdW2luZm8tPmluc3RhbmNlXSkp
Cj4gPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gPiAtCUdFTV9CVUdfT04oZGV2X3ByaXYtPmVuZ2lu
ZVtpZF0pOwo+ID4gKwlHRU1fQlVHX09OKGk5MTUtPmVuZ2luZVtpZF0pOwo+ID4gICAJZW5naW5l
ID0ga3phbGxvYyhzaXplb2YoKmVuZ2luZSksIEdGUF9LRVJORUwpOwo+ID4gICAJaWYgKCFlbmdp
bmUpCj4gPiAgIAkJcmV0dXJuIC1FTk9NRU07Cj4gPiBAQCAtMzEzLDExICszMTMsMTEgQEAgaW50
ZWxfZW5naW5lX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAg
CWVuZ2luZS0+aWQgPSBpZDsKPiA+ICAgCWVuZ2luZS0+bWFzayA9IEJJVChpZCk7Cj4gPiAtCWVu
Z2luZS0+aTkxNSA9IGRldl9wcml2Owo+ID4gLQllbmdpbmUtPnVuY29yZSA9ICZkZXZfcHJpdi0+
dW5jb3JlOwo+ID4gKwllbmdpbmUtPmk5MTUgPSBpOTE1Owo+ID4gKwllbmdpbmUtPnVuY29yZSA9
ICZpOTE1LT51bmNvcmU7Cj4gPiAgIAlfX3NwcmludF9lbmdpbmVfbmFtZShlbmdpbmUtPm5hbWUs
IGluZm8pOwo+ID4gICAJZW5naW5lLT5od19pZCA9IGVuZ2luZS0+Z3VjX2lkID0gaW5mby0+aHdf
aWQ7Cj4gPiAtCWVuZ2luZS0+bW1pb19iYXNlID0gX19lbmdpbmVfbW1pb19iYXNlKGRldl9wcml2
LCBpbmZvLT5tbWlvX2Jhc2VzKTsKPiA+ICsJZW5naW5lLT5tbWlvX2Jhc2UgPSBfX2VuZ2luZV9t
bWlvX2Jhc2UoaTkxNSwgaW5mby0+bW1pb19iYXNlcyk7Cj4gPiAgIAllbmdpbmUtPmNsYXNzID0g
aW5mby0+Y2xhc3M7Cj4gPiAgIAllbmdpbmUtPmluc3RhbmNlID0gaW5mby0+aW5zdGFuY2U7Cj4g
PiBAQCAtMzI5LDEyICszMjksMTIgQEAgaW50ZWxfZW5naW5lX3NldHVwKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWVuZ2luZS0+dWFiaV9jbGFzcyA9IGludGVsX2Vu
Z2luZV9jbGFzc2VzW2luZm8tPmNsYXNzXS51YWJpX2NsYXNzOwo+ID4gLQllbmdpbmUtPmNvbnRl
eHRfc2l6ZSA9IGludGVsX2VuZ2luZV9jb250ZXh0X3NpemUoZGV2X3ByaXYsCj4gPiArCWVuZ2lu
ZS0+Y29udGV4dF9zaXplID0gaW50ZWxfZW5naW5lX2NvbnRleHRfc2l6ZShpOTE1LAo+ID4gICAJ
CQkJCQkJIGVuZ2luZS0+Y2xhc3MpOwo+ID4gICAJaWYgKFdBUk5fT04oZW5naW5lLT5jb250ZXh0
X3NpemUgPiBCSVQoMjApKSkKPiA+ICAgCQllbmdpbmUtPmNvbnRleHRfc2l6ZSA9IDA7Cj4gPiAg
IAlpZiAoZW5naW5lLT5jb250ZXh0X3NpemUpCj4gPiAtCQlEUklWRVJfQ0FQUyhkZXZfcHJpdikt
Pmhhc19sb2dpY2FsX2NvbnRleHRzID0gdHJ1ZTsKPiA+ICsJCURSSVZFUl9DQVBTKGk5MTUpLT5o
YXNfbG9naWNhbF9jb250ZXh0cyA9IHRydWU7Cj4gPiAgIAkvKiBOb3RoaW5nIHRvIGRvIGhlcmUs
IGV4ZWN1dGUgaW4gb3JkZXIgb2YgZGVwZW5kZW5jaWVzICovCj4gPiAgIAllbmdpbmUtPnNjaGVk
dWxlID0gTlVMTDsKPiA+IEBAIC0zNDYsOCArMzQ2LDggQEAgaW50ZWxfZW5naW5lX3NldHVwKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCS8qIFNjcnViIG1taW8gc3Rh
dGUgb24gdGFrZW92ZXIgKi8KPiA+ICAgCWludGVsX2VuZ2luZV9zYW5pdGl6ZV9tbWlvKGVuZ2lu
ZSk7Cj4gPiAtCWRldl9wcml2LT5lbmdpbmVfY2xhc3NbaW5mby0+Y2xhc3NdW2luZm8tPmluc3Rh
bmNlXSA9IGVuZ2luZTsKPiA+IC0JZGV2X3ByaXYtPmVuZ2luZVtpZF0gPSBlbmdpbmU7Cj4gPiAr
CWk5MTUtPmVuZ2luZV9jbGFzc1tpbmZvLT5jbGFzc11baW5mby0+aW5zdGFuY2VdID0gZW5naW5l
Owo+ID4gKwlpOTE1LT5lbmdpbmVbaWRdID0gZW5naW5lOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAg
IH0KPiA+IEBAIC05NTMsMTcgKzk1MywxNyBAQCBjb25zdCBjaGFyICppOTE1X2NhY2hlX2xldmVs
X3N0cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHR5cGUpCj4gPiAgIAl9Cj4g
PiAgIH0KPiA+IC11MzIgaW50ZWxfY2FsY3VsYXRlX21jcl9zX3NzX3NlbGVjdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdTMyIGludGVsX2NhbGN1bGF0ZV9tY3Jfc19z
c19zZWxlY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JY29u
c3Qgc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9JTkZPKGRldl9wcml2KS0+
c3NldTsKPiA+ICsJY29uc3Qgc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9J
TkZPKGk5MTUpLT5zc2V1Owo+ID4gICAJdTMyIG1jcl9zX3NzX3NlbGVjdDsKPiA+ICAgCXUzMiBz
bGljZSA9IGZscyhzc2V1LT5zbGljZV9tYXNrKTsKPiA+ICAgCXUzMiBzdWJzbGljZSA9IGZscyhz
c2V1LT5zdWJzbGljZV9tYXNrW3NsaWNlXSk7Cj4gPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDEw
KSkKPiA+ICsJaWYgKElTX0dFTihpOTE1LCAxMCkpCj4gPiAgIAkJbWNyX3Nfc3Nfc2VsZWN0ID0g
R0VOOF9NQ1JfU0xJQ0Uoc2xpY2UpIHwKPiA+ICAgCQkJCSAgR0VOOF9NQ1JfU1VCU0xJQ0Uoc3Vi
c2xpY2UpOwo+ID4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ID4gKwll
bHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gPiAgIAkJbWNyX3Nfc3Nfc2VsZWN0ID0g
R0VOMTFfTUNSX1NMSUNFKHNsaWNlKSB8Cj4gPiAgIAkJCQkgIEdFTjExX01DUl9TVUJTTElDRShz
dWJzbGljZSk7Cj4gPiAgIAllbHNlCj4gPiBAQCAtMTA5NSw3ICsxMDk1LDcgQEAgdm9pZCBpbnRl
bF9lbmdpbmVfZ2V0X2luc3Rkb25lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKPiA+
ICAgc3RhdGljIGJvb2wgcmluZ19pc19pZGxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBlbmdp
bmUtPmk5MTU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZW5naW5lLT5p
OTE1Owo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAgIAlib29sIGlkbGUgPSB0
cnVlOwo+ID4gQEAgLTExMDMsNyArMTEwMyw3IEBAIHN0YXRpYyBib29sIHJpbmdfaXNfaWRsZShz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAg
IAkvKiBJZiB0aGUgd2hvbGUgZGV2aWNlIGlzIGFzbGVlcCwgdGhlIGVuZ2luZSBtdXN0IGJlIGlk
bGUgKi8KPiA+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShkZXZf
cHJpdik7Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoaTkx
NSk7Cj4gPiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiBAQCAtMTEx
MywxMSArMTExMywxMSBAQCBzdGF0aWMgYm9vbCByaW5nX2lzX2lkbGUoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQo+ID4gICAJCWlkbGUgPSBmYWxzZTsKPiA+ICAgCS8qIE5vIGJpdCBm
b3IgZ2VuMiwgc28gYXNzdW1lIHRoZSBDUyBwYXJzZXIgaXMgaWRsZSAqLwo+ID4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+IDIgJiYKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+IDIgJiYK
PiA+ICAgCSAgICAhKEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19NSV9NT0RFKSAmIE1PREVfSURM
RSkpCj4gPiAgIAkJaWRsZSA9IGZhbHNlOwo+ID4gLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZf
cHJpdiwgd2FrZXJlZik7Cj4gPiArCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYp
Owo+ID4gICAJcmV0dXJuIGlkbGU7Cj4gPiAgIH0KPiA+IEBAIC0xMzIxLDEyICsxMzIxLDEyIEBA
IHN0YXRpYyB2b2lkIGhleGR1bXAoc3RydWN0IGRybV9wcmludGVyICptLCBjb25zdCB2b2lkICpi
dWYsIHNpemVfdCBsZW4pCj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2VuZ2luZV9wcmludF9yZWdp
c3RlcnMoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAo+ID4gICAJCQkJCSBz
dHJ1Y3QgZHJtX3ByaW50ZXIgKm0pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZW5naW5lLT5pOTE1Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IGVuZ2luZS0+aTkxNTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVf
ZXhlY2xpc3RzICogY29uc3QgZXhlY2xpc3RzID0KPiA+ICAgCQkmZW5naW5lLT5leGVjbGlzdHM7
Cj4gPiAgIAl1NjQgYWRkcjsKPiA+IC0JaWYgKGVuZ2luZS0+aWQgPT0gUkNTMCAmJiBJU19HRU5f
UkFOR0UoZGV2X3ByaXYsIDQsIDcpKQo+ID4gKwlpZiAoZW5naW5lLT5pZCA9PSBSQ1MwICYmIElT
X0dFTl9SQU5HRShpOTE1LCA0LCA3KSkKPiA+ICAgCQlkcm1fcHJpbnRmKG0sICJcdENDSUQ6IDB4
JTA4eFxuIiwgRU5HSU5FX1JFQUQoZW5naW5lLCBDQ0lEKSk7Cj4gPiAgIAlkcm1fcHJpbnRmKG0s
ICJcdFJJTkdfU1RBUlQ6IDB4JTA4eFxuIiwKPiA+ICAgCQkgICBFTkdJTkVfUkVBRChlbmdpbmUs
IFJJTkdfU1RBUlQpKTsKPiA+IEBAIC0xMzQzLDcgKzEzNDMsNyBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9lbmdpbmVfcHJpbnRfcmVnaXN0ZXJzKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSwKPiA+ICAgCQkJICAgRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX01JX01PREUpICYgKE1P
REVfSURMRSkgPyAiIFtpZGxlXSIgOiAiIik7Cj4gPiAgIAl9Cj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDYpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KSB7Cj4gPiAg
IAkJZHJtX3ByaW50ZihtLCAiXHRSSU5HX0lNUjogJTA4eFxuIiwKPiA+ICAgCQkJICAgRU5HSU5F
X1JFQUQoZW5naW5lLCBSSU5HX0lNUikpOwo+ID4gICAJfQo+ID4gQEAgLTEzNTQsMTUgKzEzNTQs
MTUgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5naW5lX3ByaW50X3JlZ2lzdGVycyhjb25zdCBzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCj4gPiAgIAlhZGRyID0gaW50ZWxfZW5naW5lX2dl
dF9sYXN0X2JhdGNoX2hlYWQoZW5naW5lKTsKPiA+ICAgCWRybV9wcmludGYobSwgIlx0QkJBRERS
OiAweCUwOHhfJTA4eFxuIiwKPiA+ICAgCQkgICB1cHBlcl8zMl9iaXRzKGFkZHIpLCBsb3dlcl8z
Ml9iaXRzKGFkZHIpKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkKPiA+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KQo+ID4gICAJCWFkZHIgPSBFTkdJTkVfUkVBRDY0KGVu
Z2luZSwgUklOR19ETUFfRkFERCwgUklOR19ETUFfRkFERF9VRFcpOwo+ID4gLQllbHNlIGlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDQpCj4gPiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+
PSA0KQo+ID4gICAJCWFkZHIgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfRE1BX0ZBREQpOwo+
ID4gICAJZWxzZQo+ID4gICAJCWFkZHIgPSBFTkdJTkVfUkVBRChlbmdpbmUsIERNQV9GQUREX0k4
WFgpOwo+ID4gICAJZHJtX3ByaW50ZihtLCAiXHRETUFfRkFERFI6IDB4JTA4eF8lMDh4XG4iLAo+
ID4gICAJCSAgIHVwcGVyXzMyX2JpdHMoYWRkciksIGxvd2VyXzMyX2JpdHMoYWRkcikpOwo+ID4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gNCkgewo+ID4gICAJCWRybV9wcmludGYobSwgIlx0SVBFSVI6IDB4JTA4eFxuIiwKPiA+
ICAgCQkJICAgRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX0lQRUlSKSk7Cj4gPiAgIAkJZHJtX3By
aW50ZihtLCAiXHRJUEVIUjogMHglMDh4XG4iLAo+ID4gQEAgLTEzNzIsNyArMTM3Miw3IEBAIHN0
YXRpYyB2b2lkIGludGVsX2VuZ2luZV9wcmludF9yZWdpc3RlcnMoY29uc3Qgc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLAo+ID4gICAJCWRybV9wcmludGYobSwgIlx0SVBFSFI6IDB4JTA4
eFxuIiwgRU5HSU5FX1JFQUQoZW5naW5lLCBJUEVIUikpOwo+ID4gICAJfQo+ID4gLQlpZiAoSEFT
X0VYRUNMSVNUUyhkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19FWEVDTElTVFMoaTkxNSkpIHsK
PiA+ICAgCQljb25zdCB1MzIgKmh3cyA9Cj4gPiAgIAkJCSZlbmdpbmUtPnN0YXR1c19wYWdlLmFk
ZHJbSTkxNV9IV1NfQ1NCX0JVRjBfSU5ERVhdOwo+ID4gICAJCWNvbnN0IHU4IG51bV9lbnRyaWVz
ID0gZXhlY2xpc3RzLT5jc2Jfc2l6ZTsKPiA+IEBAIC0xNDI2LDcgKzE0MjYsNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9lbmdpbmVfcHJpbnRfcmVnaXN0ZXJzKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSwKPiA+ICAgCQl9Cj4gPiAgIAkJZHJtX3ByaW50ZihtLCAiXHRcdEhXIGFj
dGl2ZT8gMHgleFxuIiwgZXhlY2xpc3RzLT5hY3RpdmUpOwo+ID4gICAJCXJjdV9yZWFkX3VubG9j
aygpOwo+ID4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPiA2KSB7Cj4gPiArCX0g
ZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID4gNikgewo+ID4gICAJCWRybV9wcmludGYobSwgIlx0
UFBfRElSX0JBU0U6IDB4JTA4eFxuIiwKPiA+ICAgCQkJICAgRU5HSU5FX1JFQUQoZW5naW5lLCBS
SU5HX1BQX0RJUl9CQVNFKSk7Cj4gPiAgIAkJZHJtX3ByaW50ZihtLCAiXHRQUF9ESVJfQkFTRV9S
RUFEOiAweCUwOHhcbiIsCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfaGFuZ2NoZWNrLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hl
Y2suYwo+ID4gaW5kZXggMTc0YmIwYTYwMzA5Li45NDg0MjNjNWY2N2QgMTAwNjQ0Cj4gPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYwo+ID4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfaGFuZ2NoZWNrLmMKPiA+IEBAIC01MCw3ICs1MCw3
IEBAIHN0YXRpYyBib29sIGluc3Rkb25lX3VuY2hhbmdlZCh1MzIgY3VycmVudF9pbnN0ZG9uZSwg
dTMyICpvbGRfaW5zdGRvbmUpCj4gPiAgIHN0YXRpYyBib29sIHN1YnVuaXRzX3N0dWNrKHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBlbmdpbmUtPmk5MTU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gZW5naW5lLT5pOTE1Owo+ID4gICAJc3RydWN0IGludGVsX2luc3Rkb25l
IGluc3Rkb25lOwo+ID4gICAJc3RydWN0IGludGVsX2luc3Rkb25lICphY2N1X2luc3Rkb25lID0g
JmVuZ2luZS0+aGFuZ2NoZWNrLmluc3Rkb25lOwo+ID4gICAJYm9vbCBzdHVjazsKPiA+IEBAIC03
Miw3ICs3Miw3IEBAIHN0YXRpYyBib29sIHN1YnVuaXRzX3N0dWNrKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKPiA+ICAgCXN0dWNrICY9IGluc3Rkb25lX3VuY2hhbmdlZChpbnN0ZG9u
ZS5zbGljZV9jb21tb24sCj4gPiAgIAkJCQkgICAgJmFjY3VfaW5zdGRvbmUtPnNsaWNlX2NvbW1v
bik7Cj4gPiAtCWZvcl9lYWNoX2luc3Rkb25lX3NsaWNlX3N1YnNsaWNlKGRldl9wcml2LCBzbGlj
ZSwgc3Vic2xpY2UpIHsKPiA+ICsJZm9yX2VhY2hfaW5zdGRvbmVfc2xpY2Vfc3Vic2xpY2UoaTkx
NSwgc2xpY2UsIHN1YnNsaWNlKSB7Cj4gPiAgIAkJc3R1Y2sgJj0gaW5zdGRvbmVfdW5jaGFuZ2Vk
KGluc3Rkb25lLnNhbXBsZXJbc2xpY2VdW3N1YnNsaWNlXSwKPiA+ICAgCQkJCQkgICAgJmFjY3Vf
aW5zdGRvbmUtPnNhbXBsZXJbc2xpY2VdW3N1YnNsaWNlXSk7Cj4gPiAgIAkJc3R1Y2sgJj0gaW5z
dGRvbmVfdW5jaGFuZ2VkKGluc3Rkb25lLnJvd1tzbGljZV1bc3Vic2xpY2VdLAo+ID4gQEAgLTEw
Myw3ICsxMDMsNyBAQCBoZWFkX3N0dWNrKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwg
dTY0IGFjdGhkKQo+ID4gICBzdGF0aWMgZW51bSBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNrX2FjdGlv
bgo+ID4gICBlbmdpbmVfc3R1Y2soc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1NjQg
YWN0aGQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
ZW5naW5lLT5pOTE1Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGVuZ2lu
ZS0+aTkxNTsKPiA+ICAgCWVudW0gaW50ZWxfZW5naW5lX2hhbmdjaGVja19hY3Rpb24gaGE7Cj4g
PiAgIAl1MzIgdG1wOwo+ID4gQEAgLTExMSw3ICsxMTEsNyBAQCBlbmdpbmVfc3R1Y2soc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1NjQgYWN0aGQpCj4gPiAgIAlpZiAoaGEgIT0gRU5H
SU5FX0RFQUQpCj4gPiAgIAkJcmV0dXJuIGhhOwo+ID4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCAy
KSkKPiA+ICsJaWYgKElTX0dFTihpOTE1LCAyKSkKPiA+ICAgCQlyZXR1cm4gRU5HSU5FX0RFQUQ7
Cj4gPiAgIAkvKiBJcyB0aGUgY2hpcCBoYW5naW5nIG9uIGEgV0FJVF9GT1JfRVZFTlQ/Cj4gPiBA
QCAtMTIxLDcgKzEyMSw3IEBAIGVuZ2luZV9zdHVjayhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsIHU2NCBhY3RoZCkKPiA+ICAgCSAqLwo+ID4gICAJdG1wID0gRU5HSU5FX1JFQUQoZW5n
aW5lLCBSSU5HX0NUTCk7Cj4gPiAgIAlpZiAodG1wICYgUklOR19XQUlUKSB7Cj4gPiAtCQlpOTE1
X2hhbmRsZV9lcnJvcihkZXZfcHJpdiwgZW5naW5lLT5tYXNrLCAwLAo+ID4gKwkJaTkxNV9oYW5k
bGVfZXJyb3IoaTkxNSwgZW5naW5lLT5tYXNrLCAwLAo+ID4gICAJCQkJICAic3R1Y2sgd2FpdCBv
biAlcyIsIGVuZ2luZS0+bmFtZSk7Cj4gPiAgIAkJRU5HSU5FX1dSSVRFKGVuZ2luZSwgUklOR19D
VEwsIHRtcCk7Cj4gPiAgIAkJcmV0dXJuIEVOR0lORV9XQUlUX0tJQ0s7Cj4gPiBAQCAtMjU2LDgg
KzI1Niw4IEBAIHN0YXRpYyB2b2lkIGhhbmdjaGVja19kZWNsYXJlX2hhbmcoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgdm9pZCBpOTE1X2hhbmdj
aGVja19lbGFwc2VkKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gLQkJY29udGFpbmVyX29mKHdvcmss
IHR5cGVvZigqZGV2X3ByaXYpLAo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
Cj4gPiArCQljb250YWluZXJfb2Yod29yaywgdHlwZW9mKCppOTE1KSwKPiA+ICAgCQkJICAgICBn
cHVfZXJyb3IuaGFuZ2NoZWNrX3dvcmsud29yayk7Cj4gPiAgIAlpbnRlbF9lbmdpbmVfbWFza190
IGh1bmcgPSAwLCBzdHVjayA9IDAsIHdlZGdlZCA9IDA7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmU7Cj4gPiBAQCAtMjY3LDEzICsyNjcsMTMgQEAgc3RhdGljIHZvaWQgaTkx
NV9oYW5nY2hlY2tfZWxhcHNlZChzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiAgIAlpZiAo
IWk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hlY2spCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlp
ZiAoIVJFQURfT05DRShkZXZfcHJpdi0+Z3QuYXdha2UpKQo+ID4gKwlpZiAoIVJFQURfT05DRShp
OTE1LT5ndC5hd2FrZSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlpZiAoaTkxNV90ZXJtaW5hbGx5
X3dlZGdlZChkZXZfcHJpdikpCj4gPiArCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUp
KQo+ID4gICAJCXJldHVybjsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lm
X2luX3VzZShkZXZfcHJpdik7Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9p
Zl9pbl91c2UoaTkxNSk7Cj4gPiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuOwo+ID4g
QEAgLTI4MSw5ICsyODEsOSBAQCBzdGF0aWMgdm9pZCBpOTE1X2hhbmdjaGVja19lbGFwc2VkKHN0
cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgCSAqIHBlcmlvZGljYWxseSBhcm0gdGhlIG1t
aW8gY2hlY2tlciB0byBzZWUgaWYgd2UgYXJlIHRyaWdnZXJpbmcKPiA+ICAgCSAqIGFueSBpbnZh
bGlkIGFjY2Vzcy4KPiA+ICAgCSAqLwo+ID4gLQlpbnRlbF91bmNvcmVfYXJtX3VuY2xhaW1lZF9t
bWlvX2RldGVjdGlvbigmZGV2X3ByaXYtPnVuY29yZSk7Cj4gPiArCWludGVsX3VuY29yZV9hcm1f
dW5jbGFpbWVkX21taW9fZGV0ZWN0aW9uKCZpOTE1LT51bmNvcmUpOwo+ID4gLQlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKPiA+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgaTkxNSwgaWQpIHsKPiA+ICAgCQlzdHJ1Y3QgaGFuZ2NoZWNrIGhjOwo+ID4gICAJCWludGVs
X2VuZ2luZV9zaWduYWxfYnJlYWRjcnVtYnMoZW5naW5lKTsKPiA+IEBAIC0zMDUsNyArMzA1LDcg
QEAgc3RhdGljIHZvaWQgaTkxNV9oYW5nY2hlY2tfZWxhcHNlZChzdHJ1Y3Qgd29ya19zdHJ1Y3Qg
KndvcmspCj4gPiAgIAlpZiAoR0VNX1NIT1dfREVCVUcoKSAmJiAoaHVuZyB8IHN0dWNrKSkgewo+
ID4gICAJCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2RlYnVnX3ByaW50ZXIoImhhbmdjaGVj
ayIpOwo+ID4gLQkJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7Cj4gPiAr
CQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewo+ID4gICAJCQlpZiAoaW50ZWxf
ZW5naW5lX2lzX2lkbGUoZW5naW5lKSkKPiA+ICAgCQkJCWNvbnRpbnVlOwo+ID4gQEAgLTMxNCwy
MCArMzE0LDIwIEBAIHN0YXRpYyB2b2lkIGk5MTVfaGFuZ2NoZWNrX2VsYXBzZWQoc3RydWN0IHdv
cmtfc3RydWN0ICp3b3JrKQo+ID4gICAJfQo+ID4gICAJaWYgKHdlZGdlZCkgewo+ID4gLQkJZGV2
X2VycihkZXZfcHJpdi0+ZHJtLmRldiwKPiA+ICsJCWRldl9lcnIoaTkxNS0+ZHJtLmRldiwKPiA+
ICAgCQkJIkdQVSByZWNvdmVyeSB0aW1lZCBvdXQsIgo+ID4gICAJCQkiIGNhbmNlbGxpbmcgYWxs
IGluLWZsaWdodCByZW5kZXJpbmcuXG4iKTsKPiA+ICAgCQlHRU1fVFJBQ0VfRFVNUCgpOwo+ID4g
LQkJaTkxNV9nZW1fc2V0X3dlZGdlZChkZXZfcHJpdik7Cj4gPiArCQlpOTE1X2dlbV9zZXRfd2Vk
Z2VkKGk5MTUpOwo+ID4gICAJfQo+ID4gICAJaWYgKGh1bmcpCj4gPiAtCQloYW5nY2hlY2tfZGVj
bGFyZV9oYW5nKGRldl9wcml2LCBodW5nLCBzdHVjayk7Cj4gPiArCQloYW5nY2hlY2tfZGVjbGFy
ZV9oYW5nKGk5MTUsIGh1bmcsIHN0dWNrKTsKPiA+IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2
X3ByaXYsIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVm
KTsKPiA+ICAgCS8qIFJlc2V0IHRpbWVyIGluIGNhc2UgR1BVIGhhbmdzIHdpdGhvdXQgYW5vdGhl
ciByZXF1ZXN0IGJlaW5nIGFkZGVkICovCj4gPiAtCWk5MTVfcXVldWVfaGFuZ2NoZWNrKGRldl9w
cml2KTsKPiA+ICsJaTkxNV9xdWV1ZV9oYW5nY2hlY2soaTkxNSk7Cj4gPiAgIH0KPiA+ICAgdm9p
ZCBpbnRlbF9lbmdpbmVfaW5pdF9oYW5nY2hlY2soc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3Mu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3MuYwo+ID4gaW5kZXggNzlkZjY2
MDIyZDNhLi45ZDZmMDg5M2Y1MjggMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9tb2NzLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X21vY3MuYwo+ID4gQEAgLTIzOSw3ICsyMzksNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9p
OTE1X21vY3NfZW50cnkgaWNlbGFrZV9tb2NzX3RhYmxlW10gPSB7Cj4gPiAgIC8qKgo+ID4gICAg
KiBnZXRfbW9jc19zZXR0aW5ncygpCj4gPiAtICogQGRldl9wcml2OglpOTE1IGRldmljZS4KPiA+
ICsgKiBAaTkxNToJaTkxNSBkZXZpY2UuCj4gPiAgICAqIEB0YWJsZTogICAgICBPdXRwdXQgdGFi
bGUgdGhhdCB3aWxsIGJlIG1hZGUgdG8gcG9pbnQgYXQgYXBwcm9wcmlhdGUKPiA+ICAgICoJICAg
ICAgTU9DUyB2YWx1ZXMgZm9yIHRoZSBkZXZpY2UuCj4gPiAgICAqCj4gPiBAQCAtMjQ5LDMzICsy
NDksMzMgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faTkxNV9tb2NzX2VudHJ5IGljZWxha2Vf
bW9jc190YWJsZVtdID0gewo+ID4gICAgKgo+ID4gICAgKiBSZXR1cm46IHRydWUgaWYgdGhlcmUg
YXJlIGFwcGxpY2FibGUgTU9DUyBzZXR0aW5ncyBmb3IgdGhlIGRldmljZS4KPiA+ICAgICovCj4g
PiAtc3RhdGljIGJvb2wgZ2V0X21vY3Nfc2V0dGluZ3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIGdldF9tb2NzX3NldHRpbmdzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgICBzdHJ1Y3QgZHJtX2k5MTVfbW9jc190
YWJsZSAqdGFibGUpCj4gPiAgIHsKPiA+ICAgCWJvb2wgcmVzdWx0ID0gZmFsc2U7Cj4gPiAtCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gMTEpIHsKPiA+ICAgCQl0YWJsZS0+c2l6ZSAgPSBBUlJBWV9TSVpFKGljZWxha2VfbW9jc190
YWJsZSk7Cj4gPiAgIAkJdGFibGUtPnRhYmxlID0gaWNlbGFrZV9tb2NzX3RhYmxlOwo+ID4gICAJ
CXRhYmxlLT5uX2VudHJpZXMgPSBHRU4xMV9OVU1fTU9DU19FTlRSSUVTOwo+ID4gICAJCXJlc3Vs
dCA9IHRydWU7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwgSVNfQ0FO
Tk9OTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19HRU45X0JDKGk5MTUpIHx8
IElTX0NBTk5PTkxBS0UoaTkxNSkpIHsKPiA+ICAgCQl0YWJsZS0+c2l6ZSAgPSBBUlJBWV9TSVpF
KHNreWxha2VfbW9jc190YWJsZSk7Cj4gPiAgIAkJdGFibGUtPm5fZW50cmllcyA9IEdFTjlfTlVN
X01PQ1NfRU5UUklFUzsKPiA+ICAgCQl0YWJsZS0+dGFibGUgPSBza3lsYWtlX21vY3NfdGFibGU7
Cj4gPiAgIAkJcmVzdWx0ID0gdHJ1ZTsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU45X0xQKGRldl9w
cml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiA+ICAgCQl0YWJs
ZS0+c2l6ZSAgPSBBUlJBWV9TSVpFKGJyb3h0b25fbW9jc190YWJsZSk7Cj4gPiAgIAkJdGFibGUt
Pm5fZW50cmllcyA9IEdFTjlfTlVNX01PQ1NfRU5UUklFUzsKPiA+ICAgCQl0YWJsZS0+dGFibGUg
PSBicm94dG9uX21vY3NfdGFibGU7Cj4gPiAgIAkJcmVzdWx0ID0gdHJ1ZTsKPiA+ICAgCX0gZWxz
ZSB7Cj4gPiAtCQlXQVJOX09OQ0UoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5LAo+ID4gKwkJV0FS
Tl9PTkNFKElOVEVMX0dFTihpOTE1KSA+PSA5LAo+ID4gICAJCQkgICJQbGF0Zm9ybSB0aGF0IHNo
b3VsZCBoYXZlIGEgTU9DUyB0YWJsZSBkb2VzIG5vdC5cbiIpOwo+ID4gICAJfQo+ID4gICAJLyog
V2FEaXNhYmxlU2tpcENhY2hpbmc6c2tsLGJ4dCxrYmwsZ2xrICovCj4gPiAtCWlmIChJU19HRU4o
ZGV2X3ByaXYsIDkpKSB7Cj4gPiArCWlmIChJU19HRU4oaTkxNSwgOSkpIHsKPiA+ICAgCQlpbnQg
aTsKPiA+ICAgCQlmb3IgKGkgPSAwOyBpIDwgdGFibGUtPnNpemU7IGkrKykKPiA+IEBAIC0zMzAs
MTIgKzMzMCwxMiBAQCBzdGF0aWMgdTMyIGdldF9lbnRyeV9jb250cm9sKGNvbnN0IHN0cnVjdCBk
cm1faTkxNV9tb2NzX3RhYmxlICp0YWJsZSwKPiA+ICAgICovCj4gPiAgIHZvaWQgaW50ZWxfbW9j
c19pbml0X2VuZ2luZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZW5naW5lLT5pOTE1Owo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGVuZ2luZS0+aTkxNTsKPiA+ICAgCXN0
cnVjdCBkcm1faTkxNV9tb2NzX3RhYmxlIHRhYmxlOwo+ID4gICAJdW5zaWduZWQgaW50IGluZGV4
Owo+ID4gICAJdTMyIHVudXNlZF92YWx1ZTsKPiA+IC0JaWYgKCFnZXRfbW9jc19zZXR0aW5ncyhk
ZXZfcHJpdiwgJnRhYmxlKSkKPiA+ICsJaWYgKCFnZXRfbW9jc19zZXR0aW5ncyhpOTE1LCAmdGFi
bGUpKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCS8qIFNldCB1bnVzZWQgdmFsdWVzIHRvIFBURSAq
Lwo+ID4gQEAgLTQ4Miw3ICs0ODIsNyBAQCBzdGF0aWMgaW50IGVtaXRfbW9jc19sM2NjX3RhYmxl
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfbW9jc19p
bml0X2wzY2NfdGFibGUoKSAtIHByb2dyYW0gdGhlIG1vY3MgY29udHJvbCB0YWJsZQo+ID4gLSAq
IEBkZXZfcHJpdjogICAgICBpOTE1IGRldmljZSBwcml2YXRlCj4gPiArICogQGk5MTU6ICAgICAg
aTkxNSBkZXZpY2UgcHJpdmF0ZQo+ID4gICAgKgo+ID4gICAgKiBUaGlzIGZ1bmN0aW9uIHNpbXBs
eSBwcm9ncmFtcyB0aGUgbW9jcyByZWdpc3RlcnMgZm9yIHRoZSBnaXZlbiB0YWJsZQo+ID4gICAg
KiBzdGFydGluZyBhdCB0aGUgZ2l2ZW4gYWRkcmVzcy4gVGhpcyByZWdpc3RlciBzZXQgaXMgIHBy
b2dyYW1tZWQgaW4gcGFpcnMuCj4gPiBAQCAtNDk0LDEzICs0OTQsMTMgQEAgc3RhdGljIGludCBl
bWl0X21vY3NfbDNjY190YWJsZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKPiA+ICAgICoKPiA+
ICAgICogUmV0dXJuOiBOb3RoaW5nLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX21vY3NfaW5p
dF9sM2NjX3RhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lk
IGludGVsX21vY3NfaW5pdF9sM2NjX3RhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfbW9jc190YWJsZSB0YWJsZTsKPiA+ICAg
CXVuc2lnbmVkIGludCBpOwo+ID4gICAJdTE2IHVudXNlZF92YWx1ZTsKPiA+IC0JaWYgKCFnZXRf
bW9jc19zZXR0aW5ncyhkZXZfcHJpdiwgJnRhYmxlKSkKPiA+ICsJaWYgKCFnZXRfbW9jc19zZXR0
aW5ncyhpOTE1LCAmdGFibGUpKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCS8qIFNldCB1bnVzZWQg
dmFsdWVzIHRvIFBURSAqLwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX21vY3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX21vY3MuaAo+ID4g
aW5kZXggMDkxMzcwNGExYWYyLi42Zjg5NzNmYmNiM2UgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9tb2NzLmgKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX21vY3MuaAo+ID4gQEAgLTU0LDcgKzU0LDcgQEAgc3RydWN0IGk5MTVfcmVx
dWVzdDsKPiA+ICAgc3RydWN0IGludGVsX2VuZ2luZV9jczsKPiA+ICAgaW50IGludGVsX3Jjc19j
b250ZXh0X2luaXRfbW9jcyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSk7Cj4gPiAtdm9pZCBpbnRl
bF9tb2NzX2luaXRfbDNjY190YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+ID4gK3ZvaWQgaW50ZWxfbW9jc19pbml0X2wzY2NfdGFibGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ID4gICB2b2lkIGludGVsX21vY3NfaW5pdF9lbmdpbmUoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKPiA+ICAgI2VuZGlmCj4gPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX3Jlc2V0LmMKPiA+IGluZGV4IDYzNjhiMzdmMjZkMS4uZDVjZDNjY2NiNDA3IDEw
MDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwo+ID4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwo+ID4gQEAgLTEyMDgs
MTMgKzEyMDgsMTMgQEAgc3RhdGljIHZvaWQgY2xlYXJfZXJyb3JfcmVnaXN0ZXJzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJfQo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQg
Z2VuNl9jaGVja19mYXVsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K3N0YXRpYyB2b2lkIGdlbjZfY2hlY2tfZmF1bHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gPiAg
IAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiA+ICAgCXUzMiBmYXVsdDsKPiA+IC0JZm9yX2Vh
Y2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7Cj4gPiArCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGk5MTUsIGlkKSB7Cj4gPiAgIAkJZmF1bHQgPSBHRU42X1JJTkdfRkFVTFRfUkVHX1JF
QUQoZW5naW5lKTsKPiA+ICAgCQlpZiAoZmF1bHQgJiBSSU5HX0ZBVUxUX1ZBTElEKSB7Cj4gPiAg
IAkJCURSTV9ERUJVR19EUklWRVIoIlVuZXhwZWN0ZWQgZmF1bHRcbiIKPiA+IEBAIC0xMjMwLDcg
KzEyMzAsNyBAQCBzdGF0aWMgdm9pZCBnZW42X2NoZWNrX2ZhdWx0cyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW44
X2NoZWNrX2ZhdWx0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3Rh
dGljIHZvaWQgZ2VuOF9jaGVja19mYXVsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+ICAgCXUzMiBmYXVsdCA9IEk5MTVfUkVBRChHRU44X1JJTkdfRkFVTFRfUkVH
KTsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVm
ZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMKPiA+IGlu
ZGV4IGIzYmY0N2U4MTYyZi4uOGVjMmQzMzJlMjA2IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMKPiA+IEBAIC00ODksMTEgKzQ4OSwxMSBAQCBz
dGF0aWMgdm9pZCBzZXRfaHdzdGFtKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMy
IG1hc2spCj4gPiAgIHN0YXRpYyB2b2lkIHNldF9od3NfcGdhKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwgcGh5c19hZGRyX3QgcGh5cykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBlbmdpbmUtPmk5MTU7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gZW5naW5lLT5pOTE1Owo+ID4gICAJdTMyIGFkZHI7Cj4gPiAgIAlh
ZGRyID0gbG93ZXJfMzJfYml0cyhwaHlzKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gNCkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KQo+ID4gICAJCWFkZHIgfD0gKHBo
eXMgPj4gMjgpICYgMHhmMDsKPiA+ICAgCUk5MTVfV1JJVEUoSFdTX1BHQSwgYWRkcik7Cj4gPiBA
QCAtNTE1LDE0ICs1MTUsMTQgQEAgc3RhdGljIHZvaWQgcmluZ19zZXR1cF9waHlzX3N0YXR1c19w
YWdlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiA+ICAgc3RhdGljIHZvaWQgc2V0
X2h3c3Aoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgb2Zmc2V0KQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGVuZ2luZS0+aTkxNTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBlbmdpbmUtPmk5MTU7Cj4gPiAg
IAlpOTE1X3JlZ190IGh3c3A7Cj4gPiAgIAkvKgo+ID4gICAJICogVGhlIHJpbmcgc3RhdHVzIHBh
Z2UgYWRkcmVzc2VzIGFyZSBubyBsb25nZXIgbmV4dCB0byB0aGUgcmVzdCBvZgo+ID4gICAJICog
dGhlIHJpbmcgcmVnaXN0ZXJzIGFzIG9mIGdlbjcuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX0dF
TihkZXZfcHJpdiwgNykpIHsKPiA+ICsJaWYgKElTX0dFTihpOTE1LCA3KSkgewo+ID4gICAJCXN3
aXRjaCAoZW5naW5lLT5pZCkgewo+ID4gICAJCS8qCj4gPiAgIAkJICogTm8gbW9yZSByaW5ncyBl
eGlzdCBvbiBHZW43LiBEZWZhdWx0IGNhc2UgaXMgb25seSB0byBzaHV0IHVwCj4gPiBAQCAtNTQ0
LDcgKzU0NCw3IEBAIHN0YXRpYyB2b2lkIHNldF9od3NwKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSwgdTMyIG9mZnNldCkKPiA+ICAgCQkJaHdzcCA9IFZFQk9YX0hXU19QR0FfR0VONzsK
PiA+ICAgCQkJYnJlYWs7Cj4gPiAgIAkJfQo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTihkZXZfcHJp
diwgNikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19HRU4oaTkxNSwgNikpIHsKPiA+ICAgCQlod3Nw
ID0gUklOR19IV1NfUEdBX0dFTjYoZW5naW5lLT5tbWlvX2Jhc2UpOwo+ID4gICAJfSBlbHNlIHsK
PiA+ICAgCQlod3NwID0gUklOR19IV1NfUEdBKGVuZ2luZS0+bW1pb19iYXNlKTsKPiA+IEBAIC01
NTYsOSArNTU2LDkgQEAgc3RhdGljIHZvaWQgc2V0X2h3c3Aoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lLCB1MzIgb2Zmc2V0KQo+ID4gICBzdGF0aWMgdm9pZCBmbHVzaF9jc190bGIoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGVuZ2luZS0+aTkxNTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBlbmdpbmUtPmk5MTU7Cj4gPiAtCWlmICghSVNfR0VOX1JBTkdFKGRl
dl9wcml2LCA2LCA3KSkKPiA+ICsJaWYgKCFJU19HRU5fUkFOR0UoaTkxNSwgNiwgNykpCj4gPiAg
IAkJcmV0dXJuOwo+ID4gICAJLyogcmluZyBzaG91bGQgYmUgaWRsZSBiZWZvcmUgaXNzdWluZyBh
IHN5bmMgZmx1c2gqLwo+ID4gQEAgLTU4NSw5ICs1ODUsOSBAQCBzdGF0aWMgdm9pZCByaW5nX3Nl
dHVwX3N0YXR1c19wYWdlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiA+ICAgc3Rh
dGljIGJvb2wgc3RvcF9yaW5nKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBlbmdpbmUtPmk5MTU7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZW5naW5lLT5pOTE1Owo+ID4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+IDIpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+IDIpIHsKPiA+ICAgCQlFTkdJTkVfV1JJVEUoZW5naW5lLAo+ID4gICAJCQkgICAgIFJJTkdf
TUlfTU9ERSwgX01BU0tFRF9CSVRfRU5BQkxFKFNUT1BfUklORykpOwo+ID4gICAJCWlmIChpbnRl
bF93YWl0X2Zvcl9yZWdpc3RlcihlbmdpbmUtPnVuY29yZSwKPiA+IEBAIC02MjIsNyArNjIyLDcg
QEAgc3RhdGljIGJvb2wgc3RvcF9yaW5nKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
PiA+ICAgc3RhdGljIGludCB4Y3NfcmVzdW1lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBlbmdp
bmUtPmk5MTU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZW5naW5lLT5p
OTE1Owo+ID4gICAJc3RydWN0IGludGVsX3JpbmcgKnJpbmcgPSBlbmdpbmUtPmJ1ZmZlcjsKPiA+
ICAgCWludCByZXQgPSAwOwo+ID4gQEAgLTY1NCw3ICs2NTQsNyBAQCBzdGF0aWMgaW50IHhjc19y
ZXN1bWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ID4gICAJCX0KPiA+ICAgCX0K
PiA+IC0JaWYgKEhXU19ORUVEU19QSFlTSUNBTChkZXZfcHJpdikpCj4gPiArCWlmIChIV1NfTkVF
RFNfUEhZU0lDQUwoaTkxNSkpCj4gPiAgIAkJcmluZ19zZXR1cF9waHlzX3N0YXR1c19wYWdlKGVu
Z2luZSk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJcmluZ19zZXR1cF9zdGF0dXNfcGFnZShlbmdpbmUp
Owo+ID4gQEAgLTcwNSw3ICs3MDUsNyBAQCBzdGF0aWMgaW50IHhjc19yZXN1bWUoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ID4gICAJCWdvdG8gb3V0Owo+ID4gICAJfQo+ID4gLQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA+IDIpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPiAy
KQo+ID4gICAJCUVOR0lORV9XUklURShlbmdpbmUsCj4gPiAgIAkJCSAgICAgUklOR19NSV9NT0RF
LCBfTUFTS0VEX0JJVF9ESVNBQkxFKFNUT1BfUklORykpOwo+ID4gQEAgLTgxNSw3ICs4MTUsNyBA
QCBzdGF0aWMgaW50IGludGVsX3Jjc19jdHhfaW5pdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkK
PiA+ICAgc3RhdGljIGludCByY3NfcmVzdW1lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBlbmdp
bmUtPmk5MTU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZW5naW5lLT5p
OTE1Owo+ID4gICAJLyoKPiA+ICAgCSAqIERpc2FibGUgQ09OU1RBTlRfQlVGRkVSIGJlZm9yZSBp
dCBpcyBsb2FkZWQgZnJvbSB0aGUgY29udGV4dAo+ID4gQEAgLTgyNywxMiArODI3LDEyIEBAIHN0
YXRpYyBpbnQgcmNzX3Jlc3VtZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gPiAg
IAkgKiB0aGV5IGFyZSBhbHJlYWR5IGFjY3VzdG9tZWQgdG8gZnJvbSBiZWZvcmUgY29udGV4dHMg
d2VyZQo+ID4gICAJICogZW5hYmxlZC4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSVNfR0VOKGRldl9w
cml2LCA0KSkKPiA+ICsJaWYgKElTX0dFTihpOTE1LCA0KSkKPiA+ICAgCQlJOTE1X1dSSVRFKEVD
T1NLUEQsCj4gPiAgIAkJCSAgIF9NQVNLRURfQklUX0VOQUJMRShFQ09fQ09OU1RBTlRfQlVGRkVS
X1NSX0RJU0FCTEUpKTsKPiA+ICAgCS8qIFdhVGltZWRTaW5nbGVWZXJ0ZXhEaXNwYXRjaDpjbCxi
dyxjdGcsZWxrLGlsayxzbmIgKi8KPiA+IC0JaWYgKElTX0dFTl9SQU5HRShkZXZfcHJpdiwgNCwg
NikpCj4gPiArCWlmIChJU19HRU5fUkFOR0UoaTkxNSwgNCwgNikpCj4gPiAgIAkJSTkxNV9XUklU
RShNSV9NT0RFLCBfTUFTS0VEX0JJVF9FTkFCTEUoVlNfVElNRVJfRElTUEFUQ0gpKTsKPiA+ICAg
CS8qIFdlIG5lZWQgdG8gZGlzYWJsZSB0aGUgQXN5bmNGbGlwIHBlcmZvcm1hbmNlIG9wdGltaXNh
dGlvbnMgaW4gb3JkZXIKPiA+IEBAIC04NDEsMjIgKzg0MSwyMiBAQCBzdGF0aWMgaW50IHJjc19y
ZXN1bWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ID4gICAJICoKPiA+ICAgCSAq
IFdhRGlzYWJsZUFzeW5jRmxpcFBlcmZNb2RlOnNuYixpdmIsaHN3LHZsdgo+ID4gICAJICovCj4g
PiAtCWlmIChJU19HRU5fUkFOR0UoZGV2X3ByaXYsIDYsIDcpKQo+ID4gKwlpZiAoSVNfR0VOX1JB
TkdFKGk5MTUsIDYsIDcpKQo+ID4gICAJCUk5MTVfV1JJVEUoTUlfTU9ERSwgX01BU0tFRF9CSVRf
RU5BQkxFKEFTWU5DX0ZMSVBfUEVSRl9ESVNBQkxFKSk7Cj4gPiAgIAkvKiBSZXF1aXJlZCBmb3Ig
dGhlIGhhcmR3YXJlIHRvIHByb2dyYW0gc2NhbmxpbmUgdmFsdWVzIGZvciB3YWl0aW5nICovCj4g
PiAgIAkvKiBXYUVuYWJsZUZsdXNoVGxiSW52YWxpZGF0aW9uTW9kZTpzbmIgKi8KPiA+IC0JaWYg
KElTX0dFTihkZXZfcHJpdiwgNikpCj4gPiArCWlmIChJU19HRU4oaTkxNSwgNikpCj4gPiAgIAkJ
STkxNV9XUklURShHRlhfTU9ERSwKPiA+ICAgCQkJICAgX01BU0tFRF9CSVRfRU5BQkxFKEdGWF9U
TEJfSU5WQUxJREFURV9FWFBMSUNJVCkpOwo+ID4gICAJLyogV2FCQ1NWQ1NUbGJJbnZhbGlkYXRp
b25Nb2RlOml2Yix2bHYsaHN3ICovCj4gPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDcpKQo+ID4g
KwlpZiAoSVNfR0VOKGk5MTUsIDcpKQo+ID4gICAJCUk5MTVfV1JJVEUoR0ZYX01PREVfR0VONywK
PiA+ICAgCQkJICAgX01BU0tFRF9CSVRfRU5BQkxFKEdGWF9UTEJfSU5WQUxJREFURV9FWFBMSUNJ
VCkgfAo+ID4gICAJCQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoR0ZYX1JFUExBWV9NT0RFKSk7Cj4g
PiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDYpKSB7Cj4gPiArCWlmIChJU19HRU4oaTkxNSwgNikp
IHsKPiA+ICAgCQkvKiBGcm9tIHRoZSBTYW5keWJyaWRnZSBQUk0sIHZvbHVtZSAxIHBhcnQgMywg
cGFnZSAyNDoKPiA+ICAgCQkgKiAiSWYgdGhpcyBiaXQgaXMgc2V0LCBTVEN1bml0IHdpbGwgaGF2
ZSBMUkEgYXMgcmVwbGFjZW1lbnQKPiA+ICAgCQkgKiAgcG9saWN5LiBbLi4uXSBUaGlzIGJpdCBt
dXN0IGJlIHJlc2V0LiAgTFJBIHJlcGxhY2VtZW50Cj4gPiBAQCAtODY2LDcgKzg2Niw3IEBAIHN0
YXRpYyBpbnQgcmNzX3Jlc3VtZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gPiAg
IAkJCSAgIF9NQVNLRURfQklUX0RJU0FCTEUoQ00wX1NUQ19FVklDVF9ESVNBQkxFX0xSQV9TTkIp
KTsKPiA+ICAgCX0KPiA+IC0JaWYgKElTX0dFTl9SQU5HRShkZXZfcHJpdiwgNiwgNykpCj4gPiAr
CWlmIChJU19HRU5fUkFOR0UoaTkxNSwgNiwgNykpCj4gPiAgIAkJSTkxNV9XUklURShJTlNUUE0s
IF9NQVNLRURfQklUX0VOQUJMRShJTlNUUE1fRk9SQ0VfT1JERVJJTkcpKTsKPiA+ICAgCXJldHVy
biB4Y3NfcmVzdW1lKGVuZ2luZSk7Cj4gPiBAQCAtMTIyNywxNSArMTIyNywxNSBAQCB2b2lkIGlu
dGVsX3JpbmdfdW5waW4oc3RydWN0IGludGVsX3JpbmcgKnJpbmcpCj4gPiAgIH0KPiA+ICAgc3Rh
dGljIHN0cnVjdCBpOTE1X3ZtYSAqCj4gPiAtaW50ZWxfcmluZ19jcmVhdGVfdm1hKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IHNpemUpCj4gPiAraW50ZWxfcmluZ19jcmVh
dGVfdm1hKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgc2l6ZSkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9ICZkZXZfcHJpdi0+Z2d0dC52bTsK
PiA+ICsJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSAmaTkxNS0+Z2d0dC52bTsKPiA+
ICAgCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV92
bWEgKnZtYTsKPiA+IC0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW4oZGV2X3By
aXYsIHNpemUpOwo+ID4gKwlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbihpOTE1
LCBzaXplKTsKPiA+ICAgCWlmICghb2JqKQo+ID4gLQkJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2Ny
ZWF0ZV9pbnRlcm5hbChkZXZfcHJpdiwgc2l6ZSk7Cj4gPiArCQlvYmogPSBpOTE1X2dlbV9vYmpl
Y3RfY3JlYXRlX2ludGVybmFsKGk5MTUsIHNpemUpOwo+ID4gICAJaWYgKElTX0VSUihvYmopKQo+
ID4gICAJCXJldHVybiBFUlJfQ0FTVChvYmopOwo+ID4gQEAgLTIxMTUsOSArMjExNSw5IEBAIHN0
YXRpYyB2b2lkIGdlbjZfYnNkX3NldF9kZWZhdWx0X3N1Ym1pc3Npb24oc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQo+ID4gICBzdGF0aWMgdm9pZCByaW5nX2Rlc3Ryb3koc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IGVuZ2luZS0+aTkxNTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBlbmdpbmUtPmk5MTU7Cj4gPiAtCVdBUk5fT04oSU5URUxfR0VOKGRldl9wcml2
KSA+IDIgJiYKPiA+ICsJV0FSTl9PTihJTlRFTF9HRU4oaTkxNSkgPiAyICYmCj4gPiAgIAkJKEVO
R0lORV9SRUFEKGVuZ2luZSwgUklOR19NSV9NT0RFKSAmIE1PREVfSURMRSkgPT0gMCk7Cj4gPiAg
IAlpbnRlbF9yaW5nX3VucGluKGVuZ2luZS0+YnVmZmVyKTsKPiA+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvYXBlcnR1cmVfZ20uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d2dC9hcGVydHVyZV9nbS5jCj4gPiBpbmRleCAxZmEyZjY1YzNjZDEuLjg4MDdkZTU2NjM2MSAx
MDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9hcGVydHVyZV9nbS5jCj4g
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvYXBlcnR1cmVfZ20uYwo+ID4gQEAgLTQw
LDcgKzQwLDcgQEAKPiA+ICAgc3RhdGljIGludCBhbGxvY19nbShzdHJ1Y3QgaW50ZWxfdmdwdSAq
dmdwdSwgYm9vbCBoaWdoX2dtKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQg
PSB2Z3B1LT5ndnQ7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd2
dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3Z0LT5p
OTE1Owo+ID4gICAJdW5zaWduZWQgaW50IGZsYWdzOwo+ID4gICAJdTY0IHN0YXJ0LCBlbmQsIHNp
emU7Cj4gPiAgIAlzdHJ1Y3QgZHJtX21tX25vZGUgKm5vZGU7Cj4gPiBAQCAtNjAsMTQgKzYwLDE0
IEBAIHN0YXRpYyBpbnQgYWxsb2NfZ20oc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGJvb2wgaGln
aF9nbSkKPiA+ICAgCQlmbGFncyA9IFBJTl9NQVBQQUJMRTsKPiA+ICAgCX0KPiA+IC0JbXV0ZXhf
bG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQltbWlvX2h3X2FjY2Vzc19w
cmUoZGV2X3ByaXYpOwo+ID4gLQlyZXQgPSBpOTE1X2dlbV9ndHRfaW5zZXJ0KCZkZXZfcHJpdi0+
Z2d0dC52bSwgbm9kZSwKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Cj4gPiArCW1taW9faHdfYWNjZXNzX3ByZShpOTE1KTsKPiA+ICsJcmV0ID0gaTkxNV9nZW1fZ3R0
X2luc2VydCgmaTkxNS0+Z2d0dC52bSwgbm9kZSwKPiA+ICAgCQkJCSAgc2l6ZSwgSTkxNV9HVFRf
UEFHRV9TSVpFLAo+ID4gICAJCQkJICBJOTE1X0NPTE9SX1VORVZJQ1RBQkxFLAo+ID4gICAJCQkJ
ICBzdGFydCwgZW5kLCBmbGFncyk7Cj4gPiAtCW1taW9faHdfYWNjZXNzX3Bvc3QoZGV2X3ByaXYp
Owo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJ
bW1pb19od19hY2Nlc3NfcG9zdChpOTE1KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0u
c3RydWN0X211dGV4KTsKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJZ3Z0X2VycigiZmFpbCB0byBh
bGxvYyAlcyBnbSBzcGFjZSBmcm9tIGhvc3RcbiIsCj4gPiAgIAkJCWhpZ2hfZ20gPyAiaGlnaCIg
OiAibG93Iik7Cj4gPiBAQCAtNzgsNyArNzgsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2dtKHN0cnVj
dCBpbnRlbF92Z3B1ICp2Z3B1LCBib29sIGhpZ2hfZ20pCj4gPiAgIHN0YXRpYyBpbnQgYWxsb2Nf
dmdwdV9nbShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGlu
dGVsX2d2dCAqZ3Z0ID0gdmdwdS0+Z3Z0Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBndnQtPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IGd2dC0+aTkxNTsKPiA+ICAgCWludCByZXQ7Cj4gPiAgIAlyZXQgPSBhbGxvY19nbSh2
Z3B1LCBmYWxzZSk7Cj4gPiBAQCAtOTcsMjAgKzk3LDIwIEBAIHN0YXRpYyBpbnQgYWxsb2Nfdmdw
dV9nbShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiA+ICAgCXJldHVybiAwOwo+ID4gICBvdXRf
ZnJlZV9hcGVydHVyZToKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICAgCWRy
bV9tbV9yZW1vdmVfbm9kZSgmdmdwdS0+Z20ubG93X2dtX25vZGUpOwo+ID4gLQltdXRleF91bmxv
Y2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+ICAgc3Rh
dGljIHZvaWQgZnJlZV92Z3B1X2dtKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3By
aXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1
Owo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCW11
dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICAJZHJtX21tX3JlbW92ZV9u
b2RlKCZ2Z3B1LT5nbS5sb3dfZ21fbm9kZSk7Cj4gPiAgIAlkcm1fbW1fcmVtb3ZlX25vZGUoJnZn
cHUtPmdtLmhpZ2hfZ21fbm9kZSk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
Owo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gQEAgLTEyNywxMSArMTI3LDExIEBAIHZvaWQgaW50ZWxf
dmdwdV93cml0ZV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiA+ICAgCQl1MzIgZmVu
Y2UsIHU2NCB2YWx1ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2d2dCAqZ3Z0ID0gdmdw
dS0+Z3Z0Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndnQtPmRl
dl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd2dC0+aTkxNTsK
PiA+ICAgCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKnJlZzsKPiA+ICAgCWk5MTVfcmVnX3Qg
ZmVuY2VfcmVnX2xvLCBmZW5jZV9yZWdfaGk7Cj4gPiAtCWFzc2VydF9ycG1fd2FrZWxvY2tfaGVs
ZChkZXZfcHJpdik7Cj4gPiArCWFzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChpOTE1KTsKPiA+ICAg
CWlmIChXQVJOX09OKGZlbmNlID49IHZncHVfZmVuY2Vfc3oodmdwdSkpKQo+ID4gICAJCXJldHVy
bjsKPiA+IEBAIC0xNjIsNDEgKzE2Miw0MSBAQCBzdGF0aWMgdm9pZCBfY2xlYXJfdmdwdV9mZW5j
ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiA+ICAgc3RhdGljIHZvaWQgZnJlZV92Z3B1X2Zl
bmNlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxf
Z3Z0ICpndnQgPSB2Z3B1LT5ndnQ7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IGd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gZ3Z0LT5pOTE1Owo+ID4gICAJc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqcmVnOwo+ID4g
ICAJdTMyIGk7Cj4gPiAgIAlpZiAoV0FSTl9PTighdmdwdV9mZW5jZV9zeih2Z3B1KSkpCj4gPiAg
IAkJcmV0dXJuOwo+ID4gLQlpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gPiArCWlu
dGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJt
LnN0cnVjdF9tdXRleCk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
Owo+ID4gICAJX2NsZWFyX3ZncHVfZmVuY2UodmdwdSk7Cj4gPiAgIAlmb3IgKGkgPSAwOyBpIDwg
dmdwdV9mZW5jZV9zeih2Z3B1KTsgaSsrKSB7Cj4gPiAgIAkJcmVnID0gdmdwdS0+ZmVuY2UucmVn
c1tpXTsKPiA+ICAgCQlpOTE1X3VucmVzZXJ2ZV9mZW5jZShyZWcpOwo+ID4gICAJCXZncHUtPmZl
bmNlLnJlZ3NbaV0gPSBOVUxMOwo+ID4gICAJfQo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2
LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKPiA+IC0JaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKGRldl9wcml2KTsK
PiA+ICsJaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKGk5MTUpOwo+ID4gICB9Cj4gPiAg
IHN0YXRpYyBpbnQgYWxsb2NfdmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiA+
ICAgewo+ID4gICAJc3RydWN0IGludGVsX2d2dCAqZ3Z0ID0gdmdwdS0+Z3Z0Owo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndnQtPmRldl9wcml2Owo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd2dC0+aTkxNTsKPiA+ICAgCXN0cnVjdCBkcm1f
aTkxNV9mZW5jZV9yZWcgKnJlZzsKPiA+ICAgCWludCBpOwo+ID4gLQlpbnRlbF9ydW50aW1lX3Bt
X2dldChkZXZfcHJpdik7Cj4gPiArCWludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ID4gICAJ
LyogUmVxdWVzdCBmZW5jZXMgZnJvbSBob3N0ICovCj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2
LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Cj4gPiAgIAlmb3IgKGkgPSAwOyBpIDwgdmdwdV9mZW5jZV9zeih2Z3B1KTsgaSsrKSB7
Cj4gPiAtCQlyZWcgPSBpOTE1X3Jlc2VydmVfZmVuY2UoZGV2X3ByaXYpOwo+ID4gKwkJcmVnID0g
aTkxNV9yZXNlcnZlX2ZlbmNlKGk5MTUpOwo+ID4gICAJCWlmIChJU19FUlIocmVnKSkKPiA+ICAg
CQkJZ290byBvdXRfZnJlZV9mZW5jZTsKPiA+IEBAIC0yMDUsOCArMjA1LDggQEAgc3RhdGljIGlu
dCBhbGxvY192Z3B1X2ZlbmNlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ID4gICAJX2NsZWFy
X3ZncHVfZmVuY2UodmdwdSk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwo+ID4gLQlpbnRlbF9ydW50aW1lX3BtX3B1dF91bmNoZWNrZWQoZGV2X3ByaXYp
Owo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwlpbnRl
bF9ydW50aW1lX3BtX3B1dF91bmNoZWNrZWQoaTkxNSk7Cj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAg
b3V0X2ZyZWVfZmVuY2U6Cj4gPiAgIAlndnRfdmdwdV9lcnIoIkZhaWxlZCB0byBhbGxvYyBmZW5j
ZXNcbiIpOwo+ID4gQEAgLTIxOCw4ICsyMTgsOCBAQCBzdGF0aWMgaW50IGFsbG9jX3ZncHVfZmVu
Y2Uoc3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4gPiAgIAkJaTkxNV91bnJlc2VydmVfZmVuY2Uo
cmVnKTsKPiA+ICAgCQl2Z3B1LT5mZW5jZS5yZWdzW2ldID0gTlVMTDsKPiA+ICAgCX0KPiA+IC0J
bXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAtCWludGVsX3J1
bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7Cj4gPiArCW11dGV4X3VubG9jaygmaTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tl
ZChpOTE1KTsKPiA+ICAgCXJldHVybiAtRU5PU1BDOwo+ID4gICB9Cj4gPiBAQCAtMzEzLDExICsz
MTMsMTEgQEAgdm9pZCBpbnRlbF92Z3B1X2ZyZWVfcmVzb3VyY2Uoc3RydWN0IGludGVsX3ZncHUg
KnZncHUpCj4gPiAgICAqLwo+ID4gICB2b2lkIGludGVsX3ZncHVfcmVzZXRfcmVzb3VyY2Uoc3Ry
dWN0IGludGVsX3ZncHUgKnZncHUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1f
Z2V0KGRldl9wcml2KTsKPiA+ICsJaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7Cj4gPiAgIAlf
Y2xlYXJfdmdwdV9mZW5jZSh2Z3B1KTsKPiA+IC0JaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVj
a2VkKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKGk5MTUp
Owo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d2dC9jZmdfc3BhY2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9jZmdfc3BhY2UuYwo+
ID4gaW5kZXggMTljZjFiYmUwNTlkLi5kM2E3NDRlN2M5NTkgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvY2ZnX3NwYWNlLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9jZmdfc3BhY2UuYwo+ID4gQEAgLTM5MSw5ICszOTEsOSBAQCB2b2lkIGludGVs
X3ZncHVfaW5pdF9jZmdfc3BhY2Uoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gPiAgIAltZW1z
ZXQodmdwdV9jZmdfc3BhY2UodmdwdSkgKyBJTlRFTF9HVlRfUENJX09QUkVHSU9OLCAwLCA0KTsK
PiA+ICAgCXZncHUtPmNmZ19zcGFjZS5iYXJbSU5URUxfR1ZUX1BDSV9CQVJfR1RUTU1JT10uc2l6
ZSA9Cj4gPiAtCQkJCXBjaV9yZXNvdXJjZV9sZW4oZ3Z0LT5kZXZfcHJpdi0+ZHJtLnBkZXYsIDAp
Owo+ID4gKwkJCQlwY2lfcmVzb3VyY2VfbGVuKGd2dC0+aTkxNS0+ZHJtLnBkZXYsIDApOwo+ID4g
ICAJdmdwdS0+Y2ZnX3NwYWNlLmJhcltJTlRFTF9HVlRfUENJX0JBUl9BUEVSVFVSRV0uc2l6ZSA9
Cj4gPiAtCQkJCXBjaV9yZXNvdXJjZV9sZW4oZ3Z0LT5kZXZfcHJpdi0+ZHJtLnBkZXYsIDIpOwo+
ID4gKwkJCQlwY2lfcmVzb3VyY2VfbGVuKGd2dC0+aTkxNS0+ZHJtLnBkZXYsIDIpOwo+ID4gICAJ
bWVtc2V0KHZncHVfY2ZnX3NwYWNlKHZncHUpICsgUENJX1JPTV9BRERSRVNTLCAwLCA0KTsKPiA+
ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9jbWRfcGFyc2Vy
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvY21kX3BhcnNlci5jCj4gPiBpbmRleCA2ZWE4
ODI3MGM4MTguLjJiMDlhY2MwNTAyZiAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9jbWRfcGFyc2VyLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9j
bWRfcGFyc2VyLmMKPiA+IEBAIC04MTksNyArODE5LDcgQEAgc3RhdGljIGludCBmb3JjZV9ub25w
cml2X3JlZ19oYW5kbGVyKHN0cnVjdCBwYXJzZXJfZXhlY19zdGF0ZSAqcywKPiA+ICAgCXVuc2ln
bmVkIGludCBkYXRhOwo+ID4gICAJdTMyIHJpbmdfYmFzZTsKPiA+ICAgCXUzMiBub3BpZDsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gcy0+dmdwdS0+Z3Z0LT5kZXZf
cHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBzLT52Z3B1LT5ndnQt
Pmk5MTU7Cj4gPiAgIAlpZiAoIXN0cmNtcChjbWQsICJscmkiKSkKPiA+ICAgCQlkYXRhID0gY21k
X3ZhbChzLCBpbmRleCArIDEpOwo+ID4gQEAgLTgyOSw3ICs4MjksNyBAQCBzdGF0aWMgaW50IGZv
cmNlX25vbnByaXZfcmVnX2hhbmRsZXIoc3RydWN0IHBhcnNlcl9leGVjX3N0YXRlICpzLAo+ID4g
ICAJCXJldHVybiAtRUlOVkFMOwo+ID4gICAJfQo+ID4gLQlyaW5nX2Jhc2UgPSBkZXZfcHJpdi0+
ZW5naW5lW3MtPnJpbmdfaWRdLT5tbWlvX2Jhc2U7Cj4gPiArCXJpbmdfYmFzZSA9IGk5MTUtPmVu
Z2luZVtzLT5yaW5nX2lkXS0+bW1pb19iYXNlOwo+ID4gICAJbm9waWQgPSBpOTE1X21taW9fcmVn
X29mZnNldChSSU5HX05PUElEKHJpbmdfYmFzZSkpOwo+ID4gICAJaWYgKCFpbnRlbF9ndnRfaW5f
Zm9yY2Vfbm9ucHJpdl93aGl0ZWxpc3QoZ3Z0LCBkYXRhKSAmJgo+ID4gQEAgLTkwNSw3ICs5MDUs
NyBAQCBzdGF0aWMgaW50IGNtZF9yZWdfaGFuZGxlcihzdHJ1Y3QgcGFyc2VyX2V4ZWNfc3RhdGUg
KnMsCj4gPiAgIAkgKiB1cGRhdGUgcmVnIHZhbHVlcyBpbiBpdCBpbnRvIHZyZWdzLCBzbyBMUklz
IGluIHdvcmtsb2FkIHdpdGgKPiA+ICAgCSAqIGluaGliaXQgY29udGV4dCB3aWxsIHJlc3RvcmUg
d2l0aCBjb3JyZWN0IHZhbHVlcwo+ID4gICAJICovCj4gPiAtCWlmIChJU19HRU4oZ3Z0LT5kZXZf
cHJpdiwgOSkgJiYKPiA+ICsJaWYgKElTX0dFTihndnQtPmk5MTUsIDkpICYmCj4gPiAgIAkJCWlu
dGVsX2d2dF9tbWlvX2lzX2luX2N0eChndnQsIG9mZnNldCkgJiYKPiA+ICAgCQkJIXN0cm5jbXAo
Y21kLCAibHJpIiwgMykpIHsKPiA+ICAgCQlpbnRlbF9ndnRfaHlwZXJ2aXNvcl9yZWFkX2dwYShz
LT52Z3B1LAo+ID4gQEAgLTk0Niw3ICs5NDYsNyBAQCBzdGF0aWMgaW50IGNtZF9oYW5kbGVyX2xy
aShzdHJ1Y3QgcGFyc2VyX2V4ZWNfc3RhdGUgKnMpCj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0ICpn
dnQgPSBzLT52Z3B1LT5ndnQ7Cj4gPiAgIAlmb3IgKGkgPSAxOyBpIDwgY21kX2xlbjsgaSArPSAy
KSB7Cj4gPiAtCQlpZiAoSVNfQlJPQURXRUxMKGd2dC0+ZGV2X3ByaXYpICYmIHMtPnJpbmdfaWQg
IT0gUkNTMCkgewo+ID4gKwkJaWYgKElTX0JST0FEV0VMTChndnQtPmk5MTUpICYmIHMtPnJpbmdf
aWQgIT0gUkNTMCkgewo+ID4gICAJCQlpZiAocy0+cmluZ19pZCA9PSBCQ1MwICYmCj4gPiAgIAkJ
CSAgICBjbWRfcmVnKHMsIGkpID09IGk5MTVfbW1pb19yZWdfb2Zmc2V0KERFUlJNUikpCj4gPiAg
IAkJCQlyZXQgfD0gMDsKPiA+IEBAIC05NjgsNyArOTY4LDcgQEAgc3RhdGljIGludCBjbWRfaGFu
ZGxlcl9scnIoc3RydWN0IHBhcnNlcl9leGVjX3N0YXRlICpzKQo+ID4gICAJaW50IGNtZF9sZW4g
PSBjbWRfbGVuZ3RoKHMpOwo+ID4gICAJZm9yIChpID0gMTsgaSA8IGNtZF9sZW47IGkgKz0gMikg
ewo+ID4gLQkJaWYgKElTX0JST0FEV0VMTChzLT52Z3B1LT5ndnQtPmRldl9wcml2KSkKPiA+ICsJ
CWlmIChJU19CUk9BRFdFTEwocy0+dmdwdS0+Z3Z0LT5pOTE1KSkKPiA+ICAgCQkJcmV0IHw9ICgo
Y21kX3JlZ19pbmhpYml0KHMsIGkpIHx8Cj4gPiAgIAkJCQkJKGNtZF9yZWdfaW5oaWJpdChzLCBp
ICsgMSkpKSkgPwo+ID4gICAJCQkJLUVCQURSUUMgOiAwOwo+ID4gQEAgLTk5Niw3ICs5OTYsNyBA
QCBzdGF0aWMgaW50IGNtZF9oYW5kbGVyX2xybShzdHJ1Y3QgcGFyc2VyX2V4ZWNfc3RhdGUgKnMp
Cj4gPiAgIAlpbnQgY21kX2xlbiA9IGNtZF9sZW5ndGgocyk7Cj4gPiAgIAlmb3IgKGkgPSAxOyBp
IDwgY21kX2xlbjspIHsKPiA+IC0JCWlmIChJU19CUk9BRFdFTEwoZ3Z0LT5kZXZfcHJpdikpCj4g
PiArCQlpZiAoSVNfQlJPQURXRUxMKGd2dC0+aTkxNSkpCj4gPiAgIAkJCXJldCB8PSAoY21kX3Jl
Z19pbmhpYml0KHMsIGkpKSA/IC1FQkFEUlFDIDogMDsKPiA+ICAgCQlpZiAocmV0KQo+ID4gICAJ
CQlicmVhazsKPiA+IEBAIC0xMTgwLDcgKzExODAsNyBAQCBzdHJ1Y3QgcGxhbmVfY29kZV9tYXBw
aW5nIHsKPiA+ICAgc3RhdGljIGludCBnZW44X2RlY29kZV9taV9kaXNwbGF5X2ZsaXAoc3RydWN0
IHBhcnNlcl9leGVjX3N0YXRlICpzLAo+ID4gICAJCXN0cnVjdCBtaV9kaXNwbGF5X2ZsaXBfY29t
bWFuZF9pbmZvICppbmZvKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHMtPnZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gcy0+dmdwdS0+Z3Z0LT5pOTE1Owo+ID4gICAJc3RydWN0IHBsYW5lX2Nv
ZGVfbWFwcGluZyBnZW44X3BsYW5lX2NvZGVbXSA9IHsKPiA+ICAgCQlbMF0gPSB7UElQRV9BLCBQ
TEFORV9BLCBQUklNQVJZX0FfRkxJUF9ET05FfSwKPiA+ICAgCQlbMV0gPSB7UElQRV9CLCBQTEFO
RV9BLCBQUklNQVJZX0JfRkxJUF9ET05FfSwKPiA+IEBAIC0xMjI2LDcgKzEyMjYsNyBAQCBzdGF0
aWMgaW50IGdlbjhfZGVjb2RlX21pX2Rpc3BsYXlfZmxpcChzdHJ1Y3QgcGFyc2VyX2V4ZWNfc3Rh
dGUgKnMsCj4gPiAgIHN0YXRpYyBpbnQgc2tsX2RlY29kZV9taV9kaXNwbGF5X2ZsaXAoc3RydWN0
IHBhcnNlcl9leGVjX3N0YXRlICpzLAo+ID4gICAJCXN0cnVjdCBtaV9kaXNwbGF5X2ZsaXBfY29t
bWFuZF9pbmZvICppbmZvKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHMtPnZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gcy0+dmdwdS0+Z3Z0LT5pOTE1Owo+ID4gICAJc3RydWN0IGludGVsX3Zn
cHUgKnZncHUgPSBzLT52Z3B1Owo+ID4gICAJdTMyIGR3b3JkMCA9IGNtZF92YWwocywgMCk7Cj4g
PiAgIAl1MzIgZHdvcmQxID0gY21kX3ZhbChzLCAxKTsKPiA+IEBAIC0xMjg1LDEzICsxMjg1LDEz
IEBAIHN0YXRpYyBpbnQgc2tsX2RlY29kZV9taV9kaXNwbGF5X2ZsaXAoc3RydWN0IHBhcnNlcl9l
eGVjX3N0YXRlICpzLAo+ID4gICBzdGF0aWMgaW50IGdlbjhfY2hlY2tfbWlfZGlzcGxheV9mbGlw
KHN0cnVjdCBwYXJzZXJfZXhlY19zdGF0ZSAqcywKPiA+ICAgCQlzdHJ1Y3QgbWlfZGlzcGxheV9m
bGlwX2NvbW1hbmRfaW5mbyAqaW5mbykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBzLT52Z3B1LT5ndnQtPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHMtPnZncHUtPmd2dC0+aTkxNTsKPiA+ICAgCXUzMiBzdHJp
ZGUsIHRpbGU7Cj4gPiAgIAlpZiAoIWluZm8tPmFzeW5jX2ZsaXApCj4gPiAgIAkJcmV0dXJuIDA7
Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKPiA+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA5KSB7Cj4gPiAgIAkJc3RyaWRlID0gdmdwdV92cmVnX3Qocy0+dmdwdSwgaW5m
by0+c3RyaWRlX3JlZykgJiBHRU5NQVNLKDksIDApOwo+ID4gICAJCXRpbGUgPSAodmdwdV92cmVn
X3Qocy0+dmdwdSwgaW5mby0+Y3RybF9yZWcpICYKPiA+ICAgCQkJCUdFTk1BU0soMTIsIDEwKSkg
Pj4gMTA7Cj4gPiBAQCAtMTMxNCwxMiArMTMxNCwxMiBAQCBzdGF0aWMgaW50IGdlbjhfdXBkYXRl
X3BsYW5lX21taW9fZnJvbV9taV9kaXNwbGF5X2ZsaXAoCj4gPiAgIAkJc3RydWN0IHBhcnNlcl9l
eGVjX3N0YXRlICpzLAo+ID4gICAJCXN0cnVjdCBtaV9kaXNwbGF5X2ZsaXBfY29tbWFuZF9pbmZv
ICppbmZvKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHMtPnZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gcy0+dmdwdS0+Z3Z0LT5pOTE1Owo+ID4gICAJc3RydWN0IGludGVsX3ZncHUgKnZncHUg
PSBzLT52Z3B1Owo+ID4gICAJc2V0X21hc2tfYml0cygmdmdwdV92cmVnX3QodmdwdSwgaW5mby0+
c3VyZl9yZWcpLCBHRU5NQVNLKDMxLCAxMiksCj4gPiAgIAkJICAgICAgaW5mby0+c3VyZl92YWwg
PDwgMTIpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Cj4gPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ID4gICAJCXNldF9tYXNrX2JpdHMoJnZncHVfdnJlZ190
KHZncHUsIGluZm8tPnN0cmlkZV9yZWcpLCBHRU5NQVNLKDksIDApLAo+ID4gICAJCQkgICAgICBp
bmZvLT5zdHJpZGVfdmFsKTsKPiA+ICAgCQlzZXRfbWFza19iaXRzKCZ2Z3B1X3ZyZWdfdCh2Z3B1
LCBpbmZvLT5jdHJsX3JlZyksIEdFTk1BU0soMTIsIDEwKSwKPiA+IEBAIC0xMzQ1LDExICsxMzQ1
LDExIEBAIHN0YXRpYyBpbnQgZ2VuOF91cGRhdGVfcGxhbmVfbW1pb19mcm9tX21pX2Rpc3BsYXlf
ZmxpcCgKPiA+ICAgc3RhdGljIGludCBkZWNvZGVfbWlfZGlzcGxheV9mbGlwKHN0cnVjdCBwYXJz
ZXJfZXhlY19zdGF0ZSAqcywKPiA+ICAgCQlzdHJ1Y3QgbWlfZGlzcGxheV9mbGlwX2NvbW1hbmRf
aW5mbyAqaW5mbykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSBzLT52Z3B1LT5ndnQtPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHMtPnZncHUtPmd2dC0+aTkxNTsKPiA+IC0JaWYgKElTX0JST0FEV0VMTChkZXZf
cHJpdikpCj4gPiArCWlmIChJU19CUk9BRFdFTEwoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIGdlbjhf
ZGVjb2RlX21pX2Rpc3BsYXlfZmxpcChzLCBpbmZvKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPj0gOSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gICAJCXJldHVy
biBza2xfZGVjb2RlX21pX2Rpc3BsYXlfZmxpcChzLCBpbmZvKTsKPiA+ICAgCXJldHVybiAtRU5P
REVWOwo+ID4gQEAgLTE3NTYsNyArMTc1Niw3IEBAIHN0YXRpYyBpbnQgcGVyZm9ybV9iYl9zaGFk
b3coc3RydWN0IHBhcnNlcl9leGVjX3N0YXRlICpzKQo+ID4gICAJaWYgKGJiLT5wcGd0dCkKPiA+
ICAgCQlzdGFydF9vZmZzZXQgPSBnbWEgJiB+STkxNV9HVFRfUEFHRV9NQVNLOwo+ID4gLQliYi0+
b2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShzLT52Z3B1LT5ndnQtPmRldl9wcml2
LAo+ID4gKwliYi0+b2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShzLT52Z3B1LT5n
dnQtPmk5MTUsCj4gPiAgIAkJCQkJICAgICAgIHJvdW5kX3VwKGJiX3NpemUgKyBzdGFydF9vZmZz
ZXQsCj4gPiAgIAkJCQkJCQlQQUdFX1NJWkUpKTsKPiA+ICAgCWlmIChJU19FUlIoYmItPm9iaikp
IHsKPiA+IEBAIC0yODMwLDcgKzI4MzAsNyBAQCBzdGF0aWMgaW50IHNoYWRvd19pbmRpcmVjdF9j
dHgoc3RydWN0IGludGVsX3NoYWRvd193YV9jdHggKndhX2N0eCkKPiA+ICAgCWludCByZXQgPSAw
Owo+ID4gICAJdm9pZCAqbWFwOwo+ID4gLQlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3No
bWVtKHdvcmtsb2FkLT52Z3B1LT5ndnQtPmRldl9wcml2LAo+ID4gKwlvYmogPSBpOTE1X2dlbV9v
YmplY3RfY3JlYXRlX3NobWVtKHdvcmtsb2FkLT52Z3B1LT5ndnQtPmk5MTUsCj4gPiAgIAkJCQkJ
ICAgcm91bmR1cChjdHhfc2l6ZSArIENBQ0hFTElORV9CWVRFUywKPiA+ICAgCQkJCQkJICAgUEFH
RV9TSVpFKSk7Cj4gPiAgIAlpZiAoSVNfRVJSKG9iaikpCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Z0L2RlYnVnZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9k
ZWJ1Z2ZzLmMKPiA+IGluZGV4IDJmYjdiNzNiMjYwZC4uMWZmN2YxMWM4OWEyIDEwMDY0NAo+ID4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2RlYnVnZnMuYwo+ID4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Z0L2RlYnVnZnMuYwo+ID4gQEAgLTU4LDcgKzU4LDcgQEAgc3RhdGlj
IGludCBtbWlvX29mZnNldF9jb21wYXJlKHZvaWQgKnByaXYsCj4gPiAgIHN0YXRpYyBpbmxpbmUg
aW50IG1taW9fZGlmZl9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndnQgKmd2dCwKPiA+ICAgCQkJCSAg
ICB1MzIgb2Zmc2V0LCB2b2lkICpkYXRhKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gZ3Z0LT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBndnQtPmk5MTU7Cj4gPiAgIAlzdHJ1Y3QgbW1pb19kaWZmX3BhcmFtICpwYXJh
bSA9IGRhdGE7Cj4gPiAgIAlzdHJ1Y3QgZGlmZl9tbWlvICpub2RlOwo+ID4gICAJdTMyIHByZWcs
IHZyZWc7Cj4gPiBAQCAtOTgsMTAgKzk4LDEwIEBAIHN0YXRpYyBpbnQgdmdwdV9tbWlvX2RpZmZf
c2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKnMsIHZvaWQgKnVudXNlZCkKPiA+ICAgCW11dGV4X2xvY2so
Jmd2dC0+bG9jayk7Cj4gPiAgIAlzcGluX2xvY2tfYmgoJmd2dC0+c2NoZWR1bGVyLm1taW9fY29u
dGV4dF9sb2NrKTsKPiA+IC0JbW1pb19od19hY2Nlc3NfcHJlKGd2dC0+ZGV2X3ByaXYpOwo+ID4g
KwltbWlvX2h3X2FjY2Vzc19wcmUoZ3Z0LT5pOTE1KTsKPiA+ICAgCS8qIFJlY29nbml6ZSBhbGwg
dGhlIGRpZmYgbW1pb3MgdG8gbGlzdC4gKi8KPiA+ICAgCWludGVsX2d2dF9mb3JfZWFjaF90cmFj
a2VkX21taW8oZ3Z0LCBtbWlvX2RpZmZfaGFuZGxlciwgJnBhcmFtKTsKPiA+IC0JbW1pb19od19h
Y2Nlc3NfcG9zdChndnQtPmRldl9wcml2KTsKPiA+ICsJbW1pb19od19hY2Nlc3NfcG9zdChndnQt
Pmk5MTUpOwo+ID4gICAJc3Bpbl91bmxvY2tfYmgoJmd2dC0+c2NoZWR1bGVyLm1taW9fY29udGV4
dF9sb2NrKTsKPiA+ICAgCW11dGV4X3VubG9jaygmZ3Z0LT5sb2NrKTsKPiA+IEBAIC0xNDIsNyAr
MTQyLDcgQEAgc3RhdGljIGludAo+ID4gICB2Z3B1X3NjYW5fbm9ucHJpdmJiX3NldCh2b2lkICpk
YXRhLCB1NjQgdmFsKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSA9IChz
dHJ1Y3QgaW50ZWxfdmdwdSAqKWRhdGE7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ID4gICAJZW51bSBpbnRlbF9lbmdpbmVfaWQg
aWQ7Cj4gPiAgIAljaGFyIGJ1ZlsxMjhdLCAqczsKPiA+ICAgCWludCBsZW47Cj4gPiBAQCAtMTY0
LDcgKzE2NCw3IEBAIHZncHVfc2Nhbl9ub25wcml2YmJfc2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwp
Cj4gPiAgIAlmb3IgKGlkID0gMDsgaWQgPCBJOTE1X05VTV9FTkdJTkVTOyBpZCsrKSB7Cj4gPiAg
IAkJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ID4gLQkJZW5naW5lID0gZGV2X3By
aXYtPmVuZ2luZVtpZF07Cj4gPiArCQllbmdpbmUgPSBpOTE1LT5lbmdpbmVbaWRdOwo+ID4gICAJ
CWlmIChlbmdpbmUgJiYgKHZhbCAmICgxIDw8IGlkKSkpIHsKPiA+ICAgCQkJbGVuID0gc25wcmlu
dGYocywgNCwgIiVkLCAiLCBlbmdpbmUtPmlkKTsKPiA+ICAgCQkJcyArPSBsZW47Cj4gPiBAQCAt
MjQwLDcgKzI0MCw3IEBAIHZvaWQgaW50ZWxfZ3Z0X2RlYnVnZnNfcmVtb3ZlX3ZncHUoc3RydWN0
IGludGVsX3ZncHUgKnZncHUpCj4gPiAgICAqLwo+ID4gICBpbnQgaW50ZWxfZ3Z0X2RlYnVnZnNf
aW5pdChzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9taW5v
ciAqbWlub3IgPSBndnQtPmRldl9wcml2LT5kcm0ucHJpbWFyeTsKPiA+ICsJc3RydWN0IGRybV9t
aW5vciAqbWlub3IgPSBndnQtPmk5MTUtPmRybS5wcmltYXJ5Owo+ID4gICAJc3RydWN0IGRlbnRy
eSAqZW50Owo+ID4gICAJZ3Z0LT5kZWJ1Z2ZzX3Jvb3QgPSBkZWJ1Z2ZzX2NyZWF0ZV9kaXIoImd2
dCIsIG1pbm9yLT5kZWJ1Z2ZzX3Jvb3QpOwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZGlzcGxheS5j
Cj4gPiBpbmRleCBlMWMzMTNkYTZjMDAuLmIwMzdhZWVkMmY0MCAxMDA2NDQKPiA+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9kaXNwbGF5LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9kaXNwbGF5LmMKPiA+IEBAIC01Nyw3ICs1Nyw3IEBAIHN0YXRpYyBpbnQgZ2V0
X2VkcF9waXBlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ID4gICBzdGF0aWMgaW50IGVkcF9w
aXBlX2lzX2VuYWJsZWQoc3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gPiAg
IAlpZiAoISh2Z3B1X3ZyZWdfdCh2Z3B1LCBQSVBFQ09ORihfUElQRV9FRFApKSAmIFBJUEVDT05G
X0VOQUJMRSkpCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiBAQCAtNjksNyArNjksNyBAQCBzdGF0aWMg
aW50IGVkcF9waXBlX2lzX2VuYWJsZWQoc3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4gPiAgIGlu
dCBwaXBlX2lzX2VuYWJsZWQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGludCBwaXBlKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+
ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0
LT5pOTE1Owo+ID4gICAJaWYgKFdBUk5fT04ocGlwZSA8IFBJUEVfQSB8fCBwaXBlID49IEk5MTVf
TUFYX1BJUEVTKSkKPiA+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+IEBAIC0xNjgsMTAgKzE2OCwx
MCBAQCBzdGF0aWMgdTggZHBjZF9maXhfZGF0YVtEUENEX0hFQURFUl9TSVpFXSA9IHsKPiA+ICAg
c3RhdGljIHZvaWQgZW11bGF0ZV9tb25pdG9yX3N0YXR1c19jaGFuZ2Uoc3RydWN0IGludGVsX3Zn
cHUgKnZncHUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gPiAgIAlpbnQgcGlwZTsKPiA+IC0JaWYgKElTX0JST1hU
T04oZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19CUk9YVE9OKGk5MTUpKSB7Cj4gPiAgIAkJdmdw
dV92cmVnX3QodmdwdSwgR0VOOF9ERV9QT1JUX0lTUikgJj0gfihCWFRfREVfUE9SVF9IUF9ERElB
IHwKPiA+ICAgCQkJQlhUX0RFX1BPUlRfSFBfRERJQiB8Cj4gPiAgIAkJCUJYVF9ERV9QT1JUX0hQ
X0RESUMpOwo+ID4gQEAgLTE5OCw4ICsxOTgsOCBAQCBzdGF0aWMgdm9pZCBlbXVsYXRlX21vbml0
b3Jfc3RhdHVzX2NoYW5nZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiA+ICAgCQkJU0RFX1BP
UlRDX0hPVFBMVUdfQ1BUIHwKPiA+ICAgCQkJU0RFX1BPUlREX0hPVFBMVUdfQ1BUKTsKPiA+IC0J
aWYgKElTX1NLWUxBS0UoZGV2X3ByaXYpIHx8IElTX0tBQllMQUtFKGRldl9wcml2KSB8fAo+ID4g
LQkgICAgSVNfQ09GRkVFTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX1NLWUxBS0UoaTkx
NSkgfHwgSVNfS0FCWUxBS0UoaTkxNSkgfHwKPiA+ICsJICAgIElTX0NPRkZFRUxBS0UoaTkxNSkp
IHsKPiA+ICAgCQl2Z3B1X3ZyZWdfdCh2Z3B1LCBTREVJU1IpICY9IH4oU0RFX1BPUlRBX0hPVFBM
VUdfU1BUIHwKPiA+ICAgCQkJCVNERV9QT1JURV9IT1RQTFVHX1NQVCk7Cj4gPiAgIAkJdmdwdV92
cmVnX3QodmdwdSwgU0tMX0ZVU0VfU1RBVFVTKSB8PQo+ID4gQEAgLTIyMyw3ICsyMjMsNyBAQCBz
dGF0aWMgdm9pZCBlbXVsYXRlX21vbml0b3Jfc3RhdHVzX2NoYW5nZShzdHJ1Y3QgaW50ZWxfdmdw
dSAqdmdwdSkKPiA+ICAgCQkJKFRSQU5TX0RESV9CUENfOCB8IFRSQU5TX0RESV9NT0RFX1NFTEVD
VF9EVkkgfAo+ID4gICAJCQkoUE9SVF9CIDw8IFRSQU5TX0RESV9QT1JUX1NISUZUKSB8Cj4gPiAg
IAkJCVRSQU5TX0RESV9GVU5DX0VOQUJMRSk7Cj4gPiAtCQlpZiAoSVNfQlJPQURXRUxMKGRldl9w
cml2KSkgewo+ID4gKwkJaWYgKElTX0JST0FEV0VMTChpOTE1KSkgewo+ID4gICAJCQl2Z3B1X3Zy
ZWdfdCh2Z3B1LCBQT1JUX0NMS19TRUwoUE9SVF9CKSkgJj0KPiA+ICAgCQkJCX5QT1JUX0NMS19T
RUxfTUFTSzsKPiA+ICAgCQkJdmdwdV92cmVnX3QodmdwdSwgUE9SVF9DTEtfU0VMKFBPUlRfQikp
IHw9Cj4gPiBAQCAtMjQzLDcgKzI0Myw3IEBAIHN0YXRpYyB2b2lkIGVtdWxhdGVfbW9uaXRvcl9z
dGF0dXNfY2hhbmdlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ID4gICAJCQkoVFJBTlNfRERJ
X0JQQ184IHwgVFJBTlNfRERJX01PREVfU0VMRUNUX0RWSSB8Cj4gPiAgIAkJCShQT1JUX0MgPDwg
VFJBTlNfRERJX1BPUlRfU0hJRlQpIHwKPiA+ICAgCQkJVFJBTlNfRERJX0ZVTkNfRU5BQkxFKTsK
PiA+IC0JCWlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Cj4gPiArCQlpZiAoSVNfQlJPQURX
RUxMKGk5MTUpKSB7Cj4gPiAgIAkJCXZncHVfdnJlZ190KHZncHUsIFBPUlRfQ0xLX1NFTChQT1JU
X0MpKSAmPQo+ID4gICAJCQkJflBPUlRfQ0xLX1NFTF9NQVNLOwo+ID4gICAJCQl2Z3B1X3ZyZWdf
dCh2Z3B1LCBQT1JUX0NMS19TRUwoUE9SVF9DKSkgfD0KPiA+IEBAIC0yNjMsNyArMjYzLDcgQEAg
c3RhdGljIHZvaWQgZW11bGF0ZV9tb25pdG9yX3N0YXR1c19jaGFuZ2Uoc3RydWN0IGludGVsX3Zn
cHUgKnZncHUpCj4gPiAgIAkJCShUUkFOU19ERElfQlBDXzggfCBUUkFOU19ERElfTU9ERV9TRUxF
Q1RfRFZJIHwKPiA+ICAgCQkJKFBPUlRfRCA8PCBUUkFOU19ERElfUE9SVF9TSElGVCkgfAo+ID4g
ICAJCQlUUkFOU19ERElfRlVOQ19FTkFCTEUpOwo+ID4gLQkJaWYgKElTX0JST0FEV0VMTChkZXZf
cHJpdikpIHsKPiA+ICsJCWlmIChJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiA+ICAgCQkJdmdwdV92
cmVnX3QodmdwdSwgUE9SVF9DTEtfU0VMKFBPUlRfRCkpICY9Cj4gPiAgIAkJCQl+UE9SVF9DTEtf
U0VMX01BU0s7Cj4gPiAgIAkJCXZncHVfdnJlZ190KHZncHUsIFBPUlRfQ0xLX1NFTChQT1JUX0Qp
KSB8PQo+ID4gQEAgLTI3NCwxNCArMjc0LDE0IEBAIHN0YXRpYyB2b2lkIGVtdWxhdGVfbW9uaXRv
cl9zdGF0dXNfY2hhbmdlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ID4gICAJCXZncHVfdnJl
Z190KHZncHUsIFNGVVNFX1NUUkFQKSB8PSBTRlVTRV9TVFJBUF9ERElEX0RFVEVDVEVEOwo+ID4g
ICAJfQo+ID4gLQlpZiAoKElTX1NLWUxBS0UoZGV2X3ByaXYpIHx8IElTX0tBQllMQUtFKGRldl9w
cml2KSB8fAo+ID4gLQkgICAgIElTX0NPRkZFRUxBS0UoZGV2X3ByaXYpKSAmJgo+ID4gKwlpZiAo
KElTX1NLWUxBS0UoaTkxNSkgfHwgSVNfS0FCWUxBS0UoaTkxNSkgfHwKPiA+ICsJICAgICBJU19D
T0ZGRUVMQUtFKGk5MTUpKSAmJgo+ID4gICAJCQlpbnRlbF92Z3B1X2hhc19tb25pdG9yX29uX3Bv
cnQodmdwdSwgUE9SVF9FKSkgewo+ID4gICAJCXZncHVfdnJlZ190KHZncHUsIFNERUlTUikgfD0g
U0RFX1BPUlRFX0hPVFBMVUdfU1BUOwo+ID4gICAJfQo+ID4gICAJaWYgKGludGVsX3ZncHVfaGFz
X21vbml0b3Jfb25fcG9ydCh2Z3B1LCBQT1JUX0EpKSB7Cj4gPiAtCQlpZiAoSVNfQlJPQURXRUxM
KGRldl9wcml2KSkKPiA+ICsJCWlmIChJU19CUk9BRFdFTEwoaTkxNSkpCj4gPiAgIAkJCXZncHVf
dnJlZ190KHZncHUsIEdFTjhfREVfUE9SVF9JU1IpIHw9Cj4gPiAgIAkJCQlHRU44X1BPUlRfRFBf
QV9IT1RQTFVHOwo+ID4gICAJCWVsc2UKPiA+IEBAIC0yOTEsMTEgKzI5MSwxMSBAQCBzdGF0aWMg
dm9pZCBlbXVsYXRlX21vbml0b3Jfc3RhdHVzX2NoYW5nZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdw
dSkKPiA+ICAgCX0KPiA+ICAgCS8qIENsZWFyIGhvc3QgQ1JUIHN0YXR1cywgc28gZ3Vlc3QgY291
bGRuJ3QgZGV0ZWN0IHRoaXMgaG9zdCBDUlQuICovCj4gPiAtCWlmIChJU19CUk9BRFdFTEwoZGV2
X3ByaXYpKQo+ID4gKwlpZiAoSVNfQlJPQURXRUxMKGk5MTUpKQo+ID4gICAJCXZncHVfdnJlZ190
KHZncHUsIFBDSF9BRFBBKSAmPSB+QURQQV9DUlRfSE9UUExVR19NT05JVE9SX01BU0s7Cj4gPiAg
IAkvKiBEaXNhYmxlIFByaW1hcnkvU3ByaXRlL0N1cnNvciBwbGFuZSAqLwo+ID4gLQlmb3JfZWFj
aF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkg
ewo+ID4gICAJCXZncHVfdnJlZ190KHZncHUsIERTUENOVFIocGlwZSkpICY9IH5ESVNQTEFZX1BM
QU5FX0VOQUJMRTsKPiA+ICAgCQl2Z3B1X3ZyZWdfdCh2Z3B1LCBTUFJDVEwocGlwZSkpICY9IH5T
UFJJVEVfRU5BQkxFOwo+ID4gICAJCXZncHVfdnJlZ190KHZncHUsIENVUkNOVFIocGlwZSkpICY9
IH5NQ1VSU09SX01PREU7Cj4gPiBAQCAtMzg5LDcgKzM4OSw3IEBAIHZvaWQgaW50ZWxfZ3Z0X2No
ZWNrX3ZibGFua19lbXVsYXRpb24oc3RydWN0IGludGVsX2d2dCAqZ3Z0KQo+ID4gICBzdGF0aWMg
dm9pZCBlbXVsYXRlX3ZibGFua19vbl9waXBlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBpbnQg
cGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2
Z3B1LT5ndnQtPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHZncHUtPmd2dC0+aTkxNTsKPiA+ICAgCXN0cnVjdCBpbnRlbF92Z3B1X2lycSAqaXJxID0gJnZn
cHUtPmlycTsKPiA+ICAgCWludCB2YmxhbmtfZXZlbnRbXSA9IHsKPiA+ICAgCQlbUElQRV9BXSA9
IFBJUEVfQV9WQkxBTkssCj4gPiBAQCAtNDIxLDcgKzQyMSw3IEBAIHN0YXRpYyB2b2lkIGVtdWxh
dGVfdmJsYW5rKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ID4gICAJaW50IHBpcGU7Cj4gPiAg
IAltdXRleF9sb2NrKCZ2Z3B1LT52Z3B1X2xvY2spOwo+ID4gLQlmb3JfZWFjaF9waXBlKHZncHUt
Pmd2dC0+ZGV2X3ByaXYsIHBpcGUpCj4gPiArCWZvcl9lYWNoX3BpcGUodmdwdS0+Z3Z0LT5pOTE1
LCBwaXBlKQo+ID4gICAJCWVtdWxhdGVfdmJsYW5rX29uX3BpcGUodmdwdSwgcGlwZSk7Cj4gPiAg
IAltdXRleF91bmxvY2soJnZncHUtPnZncHVfbG9jayk7Cj4gPiAgIH0KPiA+IEBAIC00NTQsMTAg
KzQ1NCwxMCBAQCB2b2lkIGludGVsX2d2dF9lbXVsYXRlX3ZibGFuayhzdHJ1Y3QgaW50ZWxfZ3Z0
ICpndnQpCj4gPiAgICAqLwo+ID4gICB2b2lkIGludGVsX3ZncHVfZW11bGF0ZV9ob3RwbHVnKHN0
cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBib29sIGNvbm5lY3RlZCkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkxNTsKPiA+ICAg
CS8qIFRPRE86IGFkZCBtb3JlIHBsYXRmb3JtcyBzdXBwb3J0ICovCj4gPiAtCWlmIChJU19TS1lM
QUtFKGRldl9wcml2KSB8fCBJU19LQUJZTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX1NL
WUxBS0UoaTkxNSkgfHwgSVNfS0FCWUxBS0UoaTkxNSkpIHsKPiA+ICAgCQlpZiAoY29ubmVjdGVk
KSB7Cj4gPiAgIAkJCXZncHVfdnJlZ190KHZncHUsIFNGVVNFX1NUUkFQKSB8PQo+ID4gICAJCQkJ
U0ZVU0VfU1RSQVBfRERJRF9ERVRFQ1RFRDsKPiA+IEBAIC00ODMsMTAgKzQ4MywxMCBAQCB2b2lk
IGludGVsX3ZncHVfZW11bGF0ZV9ob3RwbHVnKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBib29s
IGNvbm5lY3RlZCkKPiA+ICAgICovCj4gPiAgIHZvaWQgaW50ZWxfdmdwdV9jbGVhbl9kaXNwbGF5
KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ID4gLQlpZiAoSVNfU0tZTEFL
RShkZXZfcHJpdikgfHwgSVNfS0FCWUxBS0UoZGV2X3ByaXYpIHx8Cj4gPiAtCSAgICBJU19DT0ZG
RUVMQUtFKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX1NLWUxBS0UoaTkxNSkgfHwgSVNfS0FCWUxB
S0UoaTkxNSkgfHwKPiA+ICsJICAgIElTX0NPRkZFRUxBS0UoaTkxNSkpCj4gPiAgIAkJY2xlYW5f
dmlydHVhbF9kcF9tb25pdG9yKHZncHUsIFBPUlRfRCk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJY2xl
YW5fdmlydHVhbF9kcF9tb25pdG9yKHZncHUsIFBPUlRfQik7Cj4gPiBAQCAtNTA1LDEyICs1MDUs
MTIgQEAgdm9pZCBpbnRlbF92Z3B1X2NsZWFuX2Rpc3BsYXkoc3RydWN0IGludGVsX3ZncHUgKnZn
cHUpCj4gPiAgICAqLwo+ID4gICBpbnQgaW50ZWxfdmdwdV9pbml0X2Rpc3BsYXkoc3RydWN0IGlu
dGVsX3ZncHUgKnZncHUsIHU2NCByZXNvbHV0aW9uKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ID4gICAJaW50ZWxf
dmdwdV9pbml0X2kyY19lZGlkKHZncHUpOwo+ID4gLQlpZiAoSVNfU0tZTEFLRShkZXZfcHJpdikg
fHwgSVNfS0FCWUxBS0UoZGV2X3ByaXYpIHx8Cj4gPiAtCSAgICBJU19DT0ZGRUVMQUtFKGRldl9w
cml2KSkKPiA+ICsJaWYgKElTX1NLWUxBS0UoaTkxNSkgfHwgSVNfS0FCWUxBS0UoaTkxNSkgfHwK
PiA+ICsJICAgIElTX0NPRkZFRUxBS0UoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIHNldHVwX3ZpcnR1
YWxfZHBfbW9uaXRvcih2Z3B1LCBQT1JUX0QsIEdWVF9EUF9ELAo+ID4gICAJCQkJCQlyZXNvbHV0
aW9uKTsKPiA+ICAgCWVsc2UKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dnQvZG1hYnVmLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZG1hYnVmLmMKPiA+IGluZGV4
IDQxYzhlYmM2MGM2My4uNTIzMDM4ZDIyNGExIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Z0L2RtYWJ1Zi5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQv
ZG1hYnVmLmMKPiA+IEBAIC0zOSw3ICszOSw3IEBACj4gPiAgIHN0YXRpYyBpbnQgdmdwdV9nZW1f
Z2V0X3BhZ2VzKAo+ID4gICAJCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShvYmot
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KG9iai0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IHNnX3RhYmxlICpzdDsKPiA+ICAgCXN0cnVj
dCBzY2F0dGVybGlzdCAqc2c7Cj4gPiAgIAlpbnQgaSwgcmV0Owo+ID4gQEAgLTYxLDcgKzYxLDcg
QEAgc3RhdGljIGludCB2Z3B1X2dlbV9nZXRfcGFnZXMoCj4gPiAgIAkJa2ZyZWUoc3QpOwo+ID4g
ICAJCXJldHVybiByZXQ7Cj4gPiAgIAl9Cj4gPiAtCWd0dF9lbnRyaWVzID0gKGdlbjhfcHRlX3Qg
X19pb21lbSAqKWRldl9wcml2LT5nZ3R0LmdzbSArCj4gPiArCWd0dF9lbnRyaWVzID0gKGdlbjhf
cHRlX3QgX19pb21lbSAqKWk5MTUtPmdndHQuZ3NtICsKPiA+ICAgCQkoZmJfaW5mby0+c3RhcnQg
Pj4gUEFHRV9TSElGVCk7Cj4gPiAgIAlmb3JfZWFjaF9zZyhzdC0+c2dsLCBzZywgcGFnZV9udW0s
IGkpIHsKPiA+ICAgCQlzZy0+b2Zmc2V0ID0gMDsKPiA+IEBAIC0xNTIsNyArMTUyLDcgQEAgc3Rh
dGljIGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0X29wcyBpbnRlbF92Z3B1X2dlbV9v
cHMgPSB7Cj4gPiAgIHN0YXRpYyBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqdmdwdV9jcmVh
dGVfZ2VtKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgIAkJc3RydWN0IGludGVsX3ZncHVf
ZmJfaW5mbyAqaW5mbykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsK
PiA+ICAgCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9hbGxvYygpOwo+ID4gQEAgLTE2NSw3ICsxNjUs
NyBAQCBzdGF0aWMgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKnZncHVfY3JlYXRlX2dlbShz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ID4gICAJb2JqLT5yZWFkX2RvbWFpbnMgPSBJOTE1X0dF
TV9ET01BSU5fR1RUOwo+ID4gICAJb2JqLT53cml0ZV9kb21haW4gPSAwOwo+ID4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkg
ewo+ID4gICAJCXVuc2lnbmVkIGludCB0aWxpbmdfbW9kZSA9IDA7Cj4gPiAgIAkJdW5zaWduZWQg
aW50IHN0cmlkZSA9IDA7Cj4gPiBAQCAtMzYwLDcgKzM2MCw3IEBAIHN0YXRpYyB2b2lkIHVwZGF0
ZV9mYl9pbmZvKHN0cnVjdCB2ZmlvX2RldmljZV9nZnhfcGxhbmVfaW5mbyAqZ3Z0X2RtYWJ1ZiwK
PiA+ICAgaW50IGludGVsX3ZncHVfcXVlcnlfcGxhbmUoc3RydWN0IGludGVsX3ZncHUgKnZncHUs
IHZvaWQgKmFyZ3MpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZ2Z3B1
LT5ndnQtPmRldl9wcml2LT5kcm07Cj4gPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmdmdw
dS0+Z3Z0LT5pOTE1LT5kcm07Cj4gPiAgIAlzdHJ1Y3QgdmZpb19kZXZpY2VfZ2Z4X3BsYW5lX2lu
Zm8gKmdmeF9wbGFuZV9pbmZvID0gYXJnczsKPiA+ICAgCXN0cnVjdCBpbnRlbF92Z3B1X2RtYWJ1
Zl9vYmogKmRtYWJ1Zl9vYmo7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdV9mYl9pbmZvIGZiX2lu
Zm87Cj4gPiBAQCAtNDY2LDcgKzQ2Niw3IEBAIGludCBpbnRlbF92Z3B1X3F1ZXJ5X3BsYW5lKHN0
cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCB2b2lkICphcmdzKQo+ID4gICAvKiBUbyBhc3NvY2lhdGUg
YW4gZXhwb3NlZCBkbWFidWYgd2l0aCB0aGUgZG1hYnVmX29iaiAqLwo+ID4gICBpbnQgaW50ZWxf
dmdwdV9nZXRfZG1hYnVmKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCB1bnNpZ25lZCBpbnQgZG1h
YnVmX2lkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmdmdwdS0+Z3Z0
LT5kZXZfcHJpdi0+ZHJtOwo+ID4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJnZncHUtPmd2
dC0+aTkxNS0+ZHJtOwo+ID4gICAJc3RydWN0IGludGVsX3ZncHVfZG1hYnVmX29iaiAqZG1hYnVm
X29iajsKPiA+ICAgCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Cj4gPiAgIAlzdHJ1
Y3QgZG1hX2J1ZiAqZG1hYnVmOwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d2dC9lZGlkLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZWRpZC5jCj4gPiBpbmRleCAx
ZmU2MTI0OTE4ZjEuLjllNDVjYmFjNWVlZCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9lZGlkLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9lZGlk
LmMKPiA+IEBAIC0xMzUsNyArMTM1LDcgQEAgc3RhdGljIHZvaWQgcmVzZXRfZ21idXNfY29udHJv
bGxlcihzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiA+ICAgc3RhdGljIGludCBnbWJ1czBfbW1p
b193cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiA+ICAgCQkJdW5zaWduZWQgaW50IG9m
ZnNldCwgdm9pZCAqcF9kYXRhLCB1bnNpZ25lZCBpbnQgYnl0ZXMpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gPiAg
IAlpbnQgcG9ydCwgcGluX3NlbGVjdDsKPiA+ICAgCW1lbWNweSgmdmdwdV92cmVnKHZncHUsIG9m
ZnNldCksIHBfZGF0YSwgYnl0ZXMpOwo+ID4gQEAgLTE0Nyw5ICsxNDcsOSBAQCBzdGF0aWMgaW50
IGdtYnVzMF9tbWlvX3dyaXRlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+ID4gICAJaWYgKHBp
bl9zZWxlY3QgPT0gMCkKPiA+ICAgCQlyZXR1cm4gMDsKPiA+IC0JaWYgKElTX0JST1hUT04oZGV2
X3ByaXYpKQo+ID4gKwlpZiAoSVNfQlJPWFRPTihpOTE1KSkKPiA+ICAgCQlwb3J0ID0gYnh0X2dl
dF9wb3J0X2Zyb21fZ21idXMwKHBpbl9zZWxlY3QpOwo+ID4gLQllbHNlIGlmIChJU19DT0ZGRUVM
QUtFKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSVNfQ09GRkVFTEFLRShpOTE1KSkKPiA+ICAg
CQlwb3J0ID0gY25wX2dldF9wb3J0X2Zyb21fZ21idXMwKHBpbl9zZWxlY3QpOwo+ID4gICAJZWxz
ZQo+ID4gICAJCXBvcnQgPSBnZXRfcG9ydF9mcm9tX2dtYnVzMChwaW5fc2VsZWN0KTsKPiA+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZXhlY2xpc3QuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9leGVjbGlzdC5jCj4gPiBpbmRleCBmMjFiOGZiNWIzN2UuLjdhN2E5
MjU1NjVhMCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9leGVjbGlz
dC5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZXhlY2xpc3QuYwo+ID4gQEAg
LTQwLDcgKzQwLDcgQEAKPiA+ICAgI2RlZmluZSBfRUxfT0ZGU0VUX1NUQVRVU19QVFIgICAweDNB
MAo+ID4gICAjZGVmaW5lIGV4ZWNsaXN0X3JpbmdfbW1pbyhndnQsIHJpbmdfaWQsIG9mZnNldCkg
XAo+ID4gLQkoZ3Z0LT5kZXZfcHJpdi0+ZW5naW5lW3JpbmdfaWRdLT5tbWlvX2Jhc2UgKyAob2Zm
c2V0KSkKPiA+ICsJKGd2dC0+aTkxNS0+ZW5naW5lW3JpbmdfaWRdLT5tbWlvX2Jhc2UgKyAob2Zm
c2V0KSkKPiA+ICAgI2RlZmluZSB2YWxpZF9jb250ZXh0KGN0eCkgKChjdHgpLT52YWxpZCkKPiA+
ICAgI2RlZmluZSBzYW1lX2NvbnRleHQoYSwgYikgKCgoYSktPmNvbnRleHRfaWQgPT0gKGIpLT5j
b250ZXh0X2lkKSAmJiBcCj4gPiBAQCAtMTMzLDcgKzEzMyw3IEBAIHN0YXRpYyB2b2lkIGVtdWxh
dGVfY3NiX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfdmdwdV9leGVjbGlzdCAqZXhlY2xpc3QsCj4gPiAg
IAl1MzIgd3JpdGVfcG9pbnRlcjsKPiA+ICAgCXUzMiBjdHhfc3RhdHVzX3B0cl9yZWcsIGN0eF9z
dGF0dXNfYnVmX3JlZywgb2Zmc2V0Owo+ID4gICAJdW5zaWduZWQgbG9uZyBod3NwX2dwYTsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJp
djsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7
Cj4gPiAgIAljdHhfc3RhdHVzX3B0cl9yZWcgPSBleGVjbGlzdF9yaW5nX21taW8odmdwdS0+Z3Z0
LCByaW5nX2lkLAo+ID4gICAJCQlfRUxfT0ZGU0VUX1NUQVRVU19QVFIpOwo+ID4gQEAgLTE2OSw3
ICsxNjksNyBAQCBzdGF0aWMgdm9pZCBlbXVsYXRlX2NzYl91cGRhdGUoc3RydWN0IGludGVsX3Zn
cHVfZXhlY2xpc3QgKmV4ZWNsaXN0LAo+ID4gICAJCQlzdGF0dXMsIDgpOwo+ID4gICAJCWludGVs
X2d2dF9oeXBlcnZpc29yX3dyaXRlX2dwYSh2Z3B1LAo+ID4gICAJCQlod3NwX2dwYSArCj4gPiAt
CQkJaW50ZWxfaHdzX2NzYl93cml0ZV9pbmRleChkZXZfcHJpdikgKiA0LAo+ID4gKwkJCWludGVs
X2h3c19jc2Jfd3JpdGVfaW5kZXgoaTkxNSkgKiA0LAo+ID4gICAJCQkmd3JpdGVfcG9pbnRlciwg
NCk7Cj4gPiAgIAl9Cj4gPiBAQCAtNTI5LDEyICs1MjksMTIgQEAgc3RhdGljIHZvaWQgaW5pdF92
Z3B1X2V4ZWNsaXN0KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBpbnQgcmluZ19pZCkKPiA+ICAg
c3RhdGljIHZvaWQgY2xlYW5fZXhlY2xpc3Qoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gPiAg
IAkJCSAgIGludGVsX2VuZ2luZV9tYXNrX3QgZW5naW5lX21hc2spCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfdmdw
dV9zdWJtaXNzaW9uICpzID0gJnZncHUtPnN1Ym1pc3Npb247Cj4gPiAgIAlpbnRlbF9lbmdpbmVf
bWFza190IHRtcDsKPiA+IC0JZm9yX2VhY2hfZW5naW5lX21hc2tlZChlbmdpbmUsIGRldl9wcml2
LCBlbmdpbmVfbWFzaywgdG1wKSB7Cj4gPiArCWZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5l
LCBpOTE1LCBlbmdpbmVfbWFzaywgdG1wKSB7Cj4gPiAgIAkJa2ZyZWUocy0+cmluZ19zY2FuX2J1
ZmZlcltlbmdpbmUtPmlkXSk7Cj4gPiAgIAkJcy0+cmluZ19zY2FuX2J1ZmZlcltlbmdpbmUtPmlk
XSA9IE5VTEw7Cj4gPiAgIAkJcy0+cmluZ19zY2FuX2J1ZmZlcl9zaXplW2VuZ2luZS0+aWRdID0g
MDsKPiA+IEBAIC01NDQsMTEgKzU0NCwxMSBAQCBzdGF0aWMgdm9pZCBjbGVhbl9leGVjbGlzdChz
dHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiA+ICAgc3RhdGljIHZvaWQgcmVzZXRfZXhlY2xpc3Qo
c3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gPiAgIAkJCSAgIGludGVsX2VuZ2luZV9tYXNrX3Qg
ZW5naW5lX21hc2spCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmU7Cj4gPiAgIAlpbnRlbF9lbmdpbmVfbWFza190IHRtcDsKPiA+IC0JZm9yX2VhY2hfZW5n
aW5lX21hc2tlZChlbmdpbmUsIGRldl9wcml2LCBlbmdpbmVfbWFzaywgdG1wKQo+ID4gKwlmb3Jf
ZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgaTkxNSwgZW5naW5lX21hc2ssIHRtcCkKPiA+ICAg
CQlpbml0X3ZncHVfZXhlY2xpc3QodmdwdSwgZW5naW5lLT5pZCk7Cj4gPiAgIH0KPiA+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZmJfZGVjb2Rlci5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Z0L2ZiX2RlY29kZXIuYwo+ID4gaW5kZXggNjVlODQ3MzkyYWVhLi43NmMz
NDZlZWNkYTMgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZmJfZGVj
b2Rlci5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZmJfZGVjb2Rlci5jCj4g
PiBAQCAtMTQ2LDEyICsxNDYsMTIgQEAgc3RhdGljIGludCBza2xfZm9ybWF0X3RvX2RybShpbnQg
Zm9ybWF0LCBib29sIHJnYl9vcmRlciwgYm9vbCBhbHBoYSwKPiA+ICAgc3RhdGljIHUzMiBpbnRl
bF92Z3B1X2dldF9zdHJpZGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGludCBwaXBlLAo+ID4g
ICAJdTMyIHRpbGVkLCBpbnQgc3RyaWRlX21hc2ssIGludCBicHApCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gPiAg
IAl1MzIgc3RyaWRlX3JlZyA9IHZncHVfdnJlZ190KHZncHUsIERTUFNUUklERShwaXBlKSkgJiBz
dHJpZGVfbWFzazsKPiA+ICAgCXUzMiBzdHJpZGUgPSBzdHJpZGVfcmVnOwo+ID4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkg
ewo+ID4gICAJCXN3aXRjaCAodGlsZWQpIHsKPiA+ICAgCQljYXNlIFBMQU5FX0NUTF9USUxFRF9M
SU5FQVI6Cj4gPiAgIAkJCXN0cmlkZSA9IHN0cmlkZV9yZWcgKiA2NDsKPiA+IEBAIC0yMDMsNyAr
MjAzLDcgQEAgaW50IGludGVsX3ZncHVfZGVjb2RlX3ByaW1hcnlfcGxhbmUoc3RydWN0IGludGVs
X3ZncHUgKnZncHUsCj4gPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdV9wcmltYXJ5X3BsYW5lX2Zvcm1h
dCAqcGxhbmUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWwsIGZtdDsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gPiAgIAlpbnQgcGlw
ZTsKPiA+ICAgCXBpcGUgPSBnZXRfYWN0aXZlX3BpcGUodmdwdSk7Cj4gPiBAQCAtMjE1LDcgKzIx
NSw3IEBAIGludCBpbnRlbF92Z3B1X2RlY29kZV9wcmltYXJ5X3BsYW5lKHN0cnVjdCBpbnRlbF92
Z3B1ICp2Z3B1LAo+ID4gICAJaWYgKCFwbGFuZS0+ZW5hYmxlZCkKPiA+ICAgCQlyZXR1cm4gLUVO
T0RFVjsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkgewo+ID4gKwlpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDkpIHsKPiA+ICAgCQlwbGFuZS0+dGlsZWQgPSB2YWwgJiBQTEFORV9D
VExfVElMRURfTUFTSzsKPiA+ICAgCQlmbXQgPSBza2xfZm9ybWF0X3RvX2RybSgKPiA+ICAgCQkJ
dmFsICYgUExBTkVfQ1RMX0ZPUk1BVF9NQVNLLAo+ID4gQEAgLTI1Niw3ICsyNTYsNyBAQCBpbnQg
aW50ZWxfdmdwdV9kZWNvZGVfcHJpbWFyeV9wbGFuZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwK
PiA+ICAgCX0KPiA+ICAgCXBsYW5lLT5zdHJpZGUgPSBpbnRlbF92Z3B1X2dldF9zdHJpZGUodmdw
dSwgcGlwZSwgcGxhbmUtPnRpbGVkLAo+ID4gLQkJKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkg
Pwo+ID4gKwkJKElOVEVMX0dFTihpOTE1KSA+PSA5KSA/Cj4gPiAgIAkJCShfUFJJX1BMQU5FX1NU
UklERV9NQVNLID4+IDYpIDoKPiA+ICAgCQkJCV9QUklfUExBTkVfU1RSSURFX01BU0ssIHBsYW5l
LT5icHApOwo+ID4gQEAgLTMzNCw3ICszMzQsNyBAQCBpbnQgaW50ZWxfdmdwdV9kZWNvZGVfY3Vy
c29yX3BsYW5lKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+ID4gICB7Cj4gPiAgIAl1MzIgdmFs
LCBtb2RlLCBpbmRleDsKPiA+ICAgCXUzMiBhbHBoYV9wbGFuZSwgYWxwaGFfZm9yY2U7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+
ID4gICAJaW50IHBpcGU7Cj4gPiAgIAlwaXBlID0gZ2V0X2FjdGl2ZV9waXBlKHZncHUpOwo+ID4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9maXJtd2FyZS5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Z0L2Zpcm13YXJlLmMKPiA+IGluZGV4IDA0OTc3NWU4ZTM1MC4uZWZk
YzlkZjRmNzMxIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2Zpcm13
YXJlLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9maXJtd2FyZS5jCj4gPiBA
QCAtNjgsNyArNjgsNyBAQCBzdGF0aWMgc3RydWN0IGJpbl9hdHRyaWJ1dGUgZmlybXdhcmVfYXR0
ciA9IHsKPiA+ICAgc3RhdGljIGludCBtbWlvX3NuYXBzaG90X2hhbmRsZXIoc3RydWN0IGludGVs
X2d2dCAqZ3Z0LCB1MzIgb2Zmc2V0LCB2b2lkICpkYXRhKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3Z0LT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBndnQtPmk5MTU7Cj4gPiAgIAkqKHUzMiAqKShkYXRhICsgb2Zm
c2V0KSA9IGludGVsX3VuY29yZV9yZWFkX25vdHJhY2UoJmk5MTUtPnVuY29yZSwKPiA+ICAgCQkJ
CQkJCSAgICBfTU1JTyhvZmZzZXQpKTsKPiA+IEBAIC03OCw3ICs3OCw3IEBAIHN0YXRpYyBpbnQg
bW1pb19zbmFwc2hvdF9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndnQgKmd2dCwgdTMyIG9mZnNldCwg
dm9pZCAqZGF0YSkKPiA+ICAgc3RhdGljIGludCBleHBvc2VfZmlybXdhcmVfc3lzZnMoc3RydWN0
IGludGVsX2d2dCAqZ3Z0KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0X2RldmljZV9p
bmZvICppbmZvID0gJmd2dC0+ZGV2aWNlX2luZm87Cj4gPiAtCXN0cnVjdCBwY2lfZGV2ICpwZGV2
ID0gZ3Z0LT5kZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0g
Z3Z0LT5pOTE1LT5kcm0ucGRldjsKPiA+ICAgCXN0cnVjdCBndnRfZmlybXdhcmVfaGVhZGVyICpo
Owo+ID4gICAJdm9pZCAqZmlybXdhcmU7Cj4gPiAgIAl2b2lkICpwOwo+ID4gQEAgLTEyOSw3ICsx
MjksNyBAQCBzdGF0aWMgaW50IGV4cG9zZV9maXJtd2FyZV9zeXNmcyhzdHJ1Y3QgaW50ZWxfZ3Z0
ICpndnQpCj4gPiAgIHN0YXRpYyB2b2lkIGNsZWFuX2Zpcm13YXJlX3N5c2ZzKHN0cnVjdCBpbnRl
bF9ndnQgKmd2dCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGd2dC0+ZGV2
X3ByaXYtPmRybS5wZGV2Owo+ID4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGd2dC0+aTkxNS0+
ZHJtLnBkZXY7Cj4gPiAgIAlkZXZpY2VfcmVtb3ZlX2Jpbl9maWxlKCZwZGV2LT5kZXYsICZmaXJt
d2FyZV9hdHRyKTsKPiA+ICAgCXZmcmVlKGZpcm13YXJlX2F0dHIucHJpdmF0ZSk7Cj4gPiBAQCAt
MTUzLDggKzE1Myw4IEBAIHN0YXRpYyBpbnQgdmVyaWZ5X2Zpcm13YXJlKHN0cnVjdCBpbnRlbF9n
dnQgKmd2dCwKPiA+ICAgCQkJICAgY29uc3Qgc3RydWN0IGZpcm13YXJlICpmdykKPiA+ICAgewo+
ID4gICAJc3RydWN0IGludGVsX2d2dF9kZXZpY2VfaW5mbyAqaW5mbyA9ICZndnQtPmRldmljZV9p
bmZvOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndnQtPmRldl9w
cml2Owo+ID4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndnQtPmk5MTU7Cj4gPiArCXN0cnVj
dCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiAgIAlzdHJ1Y3QgZ3Z0X2Zpcm13
YXJlX2hlYWRlciAqaDsKPiA+ICAgCXVuc2lnbmVkIGxvbmcgaWQsIGNyYzMyX3N0YXJ0Owo+ID4g
ICAJY29uc3Qgdm9pZCAqbWVtOwo+ID4gQEAgLTIwOCw4ICsyMDgsOCBAQCBzdGF0aWMgaW50IHZl
cmlmeV9maXJtd2FyZShzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQsCj4gPiAgIGludCBpbnRlbF9ndnRf
bG9hZF9maXJtd2FyZShzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gPiAgIHsKPiA+ICAgCXN0cnVj
dCBpbnRlbF9ndnRfZGV2aWNlX2luZm8gKmluZm8gPSAmZ3Z0LT5kZXZpY2VfaW5mbzsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3Z0LT5kZXZfcHJpdjsKPiA+IC0J
c3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3Z0LT5pOTE1Owo+ID4gKwlzdHJ1Y3QgcGNpX2RldiAq
cGRldiA9IGk5MTUtPmRybS5wZGV2Owo+ID4gICAJc3RydWN0IGludGVsX2d2dF9maXJtd2FyZSAq
ZmlybXdhcmUgPSAmZ3Z0LT5maXJtd2FyZTsKPiA+ICAgCXN0cnVjdCBndnRfZmlybXdhcmVfaGVh
ZGVyICpoOwo+ID4gICAJY29uc3Qgc3RydWN0IGZpcm13YXJlICpmdzsKPiA+IEBAIC0yNDQsNyAr
MjQ0LDcgQEAgaW50IGludGVsX2d2dF9sb2FkX2Zpcm13YXJlKHN0cnVjdCBpbnRlbF9ndnQgKmd2
dCkKPiA+ICAgCWd2dF9kYmdfY29yZSgicmVxdWVzdCBodyBzdGF0ZSBmaXJtd2FyZSAlcy4uLlxu
IiwgcGF0aCk7Cj4gPiAtCXJldCA9IHJlcXVlc3RfZmlybXdhcmUoJmZ3LCBwYXRoLCAmZGV2X3By
aXYtPmRybS5wZGV2LT5kZXYpOwo+ID4gKwlyZXQgPSByZXF1ZXN0X2Zpcm13YXJlKCZmdywgcGF0
aCwgJmk5MTUtPmRybS5wZGV2LT5kZXYpOwo+ID4gICAJa2ZyZWUocGF0aCk7Cj4gPiAgIAlpZiAo
cmV0KQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndHQuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndHQuYwo+ID4gaW5kZXggNTMxMTViZGFlMTJiLi4zOTA1
NjJmZTMyMjMgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3R0LmMK
PiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndHQuYwo+ID4gQEAgLTI3NSwyNCAr
Mjc1LDI0IEBAIHN0YXRpYyBpbmxpbmUgaW50IGdldF9wc2VfdHlwZShpbnQgdHlwZSkKPiA+ICAg
CXJldHVybiBndHRfdHlwZV90YWJsZVt0eXBlXS5wc2VfZW50cnlfdHlwZTsKPiA+ICAgfQo+ID4g
LXN0YXRpYyB1NjQgcmVhZF9wdGU2NChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IHVuc2lnbmVkIGxvbmcgaW5kZXgpCj4gPiArc3RhdGljIHU2NCByZWFkX3B0ZTY0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCB1bnNpZ25lZCBsb25nIGluZGV4KQo+ID4gICB7Cj4gPiAt
CXZvaWQgX19pb21lbSAqYWRkciA9IChnZW44X3B0ZV90IF9faW9tZW0gKilkZXZfcHJpdi0+Z2d0
dC5nc20gKyBpbmRleDsKPiA+ICsJdm9pZCBfX2lvbWVtICphZGRyID0gKGdlbjhfcHRlX3QgX19p
b21lbSAqKWk5MTUtPmdndHQuZ3NtICsgaW5kZXg7Cj4gPiAgIAlyZXR1cm4gcmVhZHEoYWRkcik7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZ3R0X2ludmFsaWRhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGdndHRfaW52YWxpZGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQltbWlvX2h3X2FjY2Vzc19w
cmUoZGV2X3ByaXYpOwo+ID4gKwltbWlvX2h3X2FjY2Vzc19wcmUoaTkxNSk7Cj4gPiAgIAlJOTE1
X1dSSVRFKEdGWF9GTFNIX0NOVExfR0VONiwgR0ZYX0ZMU0hfQ05UTF9FTik7Cj4gPiAtCW1taW9f
aHdfYWNjZXNzX3Bvc3QoZGV2X3ByaXYpOwo+ID4gKwltbWlvX2h3X2FjY2Vzc19wb3N0KGk5MTUp
Owo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgd3JpdGVfcHRlNjQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIHdyaXRlX3B0ZTY0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCXVuc2lnbmVkIGxvbmcgaW5kZXgsIHU2NCBwdGUp
Cj4gPiAgIHsKPiA+IC0Jdm9pZCBfX2lvbWVtICphZGRyID0gKGdlbjhfcHRlX3QgX19pb21lbSAq
KWRldl9wcml2LT5nZ3R0LmdzbSArIGluZGV4Owo+ID4gKwl2b2lkIF9faW9tZW0gKmFkZHIgPSAo
Z2VuOF9wdGVfdCBfX2lvbWVtICopaTkxNS0+Z2d0dC5nc20gKyBpbmRleDsKPiA+ICAgCXdyaXRl
cShwdGUsIGFkZHIpOwo+ID4gICB9Cj4gPiBAQCAtMzE1LDcgKzMxNSw3IEBAIHN0YXRpYyBpbmxp
bmUgaW50IGd0dF9nZXRfZW50cnk2NCh2b2lkICpwdCwKPiA+ICAgCQlpZiAoV0FSTl9PTihyZXQp
KQo+ID4gICAJCQlyZXR1cm4gcmV0Owo+ID4gICAJfSBlbHNlIGlmICghcHQpIHsKPiA+IC0JCWUt
PnZhbDY0ID0gcmVhZF9wdGU2NCh2Z3B1LT5ndnQtPmRldl9wcml2LCBpbmRleCk7Cj4gPiArCQll
LT52YWw2NCA9IHJlYWRfcHRlNjQodmdwdS0+Z3Z0LT5pOTE1LCBpbmRleCk7Cj4gPiAgIAl9IGVs
c2Ugewo+ID4gICAJCWUtPnZhbDY0ID0gKigodTY0ICopcHQgKyBpbmRleCk7Cj4gPiAgIAl9Cj4g
PiBAQCAtMzQwLDcgKzM0MCw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IGd0dF9zZXRfZW50cnk2NCh2
b2lkICpwdCwKPiA+ICAgCQlpZiAoV0FSTl9PTihyZXQpKQo+ID4gICAJCQlyZXR1cm4gcmV0Owo+
ID4gICAJfSBlbHNlIGlmICghcHQpIHsKPiA+IC0JCXdyaXRlX3B0ZTY0KHZncHUtPmd2dC0+ZGV2
X3ByaXYsIGluZGV4LCBlLT52YWw2NCk7Cj4gPiArCQl3cml0ZV9wdGU2NCh2Z3B1LT5ndnQtPmk5
MTUsIGluZGV4LCBlLT52YWw2NCk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCSooKHU2NCAqKXB0
ICsgaW5kZXgpID0gZS0+dmFsNjQ7Cj4gPiAgIAl9Cj4gPiBAQCAtNzM0LDcgKzczNCw3IEBAIHN0
YXRpYyBpbnQgZGV0YWNoX29vc19wYWdlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+ID4gICBz
dGF0aWMgdm9pZCBwcGd0dF9mcmVlX3NwdChzdHJ1Y3QgaW50ZWxfdmdwdV9wcGd0dF9zcHQgKnNw
dCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZGV2aWNlICprZGV2ID0gJnNwdC0+dmdwdS0+Z3Z0LT5k
ZXZfcHJpdi0+ZHJtLnBkZXYtPmRldjsKPiA+ICsJc3RydWN0IGRldmljZSAqa2RldiA9ICZzcHQt
PnZncHUtPmd2dC0+aTkxNS0+ZHJtLnBkZXYtPmRldjsKPiA+ICAgCXRyYWNlX3NwdF9mcmVlKHNw
dC0+dmdwdS0+aWQsIHNwdCwgc3B0LT5ndWVzdF9wYWdlLnR5cGUpOwo+ID4gQEAgLTgxOSw3ICs4
MTksNyBAQCBzdGF0aWMgaW50IHJlY2xhaW1fb25lX3BwZ3R0X21tKHN0cnVjdCBpbnRlbF9ndnQg
Kmd2dCk7Cj4gPiAgIHN0YXRpYyBzdHJ1Y3QgaW50ZWxfdmdwdV9wcGd0dF9zcHQgKnBwZ3R0X2Fs
bG9jX3NwdCgKPiA+ICAgCQlzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgZW51bSBpbnRlbF9ndnRf
Z3R0X3R5cGUgdHlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZGV2aWNlICprZGV2ID0gJnZncHUt
Pmd2dC0+ZGV2X3ByaXYtPmRybS5wZGV2LT5kZXY7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmtkZXYg
PSAmdmdwdS0+Z3Z0LT5pOTE1LT5kcm0ucGRldi0+ZGV2Owo+ID4gICAJc3RydWN0IGludGVsX3Zn
cHVfcHBndHRfc3B0ICpzcHQgPSBOVUxMOwo+ID4gICAJZG1hX2FkZHJfdCBkYWRkcjsKPiA+ICAg
CWludCByZXQ7Cj4gPiBAQCAtMTA0NCwxNCArMTA0NCwxNCBAQCBzdGF0aWMgaW50IHBwZ3R0X2lu
dmFsaWRhdGVfc3B0KHN0cnVjdCBpbnRlbF92Z3B1X3BwZ3R0X3NwdCAqc3B0KQo+ID4gICBzdGF0
aWMgYm9vbCB2Z3B1X2lwc19lbmFibGVkKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2
X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5p
OTE1Owo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA9PSA5IHx8IElOVEVMX0dFTihkZXZf
cHJpdikgPT0gMTApIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA9PSA5IHx8IElOVEVMX0dF
TihpOTE1KSA9PSAxMCkgewo+ID4gICAJCXUzMiBpcHMgPSB2Z3B1X3ZyZWdfdCh2Z3B1LCBHRU44
X0dBTVdfRUNPX0RFVl9SV19JQSkgJgo+ID4gICAJCQlHQU1XX0VDT19FTkFCTEVfNjRLX0lQU19G
SUVMRDsKPiA+ICAgCQlyZXR1cm4gaXBzID09IEdBTVdfRUNPX0VOQUJMRV82NEtfSVBTX0ZJRUxE
Owo+ID4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiA+ICsJfSBl
bHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiA+ICAgCQkvKiA2NEsgcGFnaW5nIG9u
bHkgY29udHJvbGxlZCBieSBJUFMgYml0IGluIFBURSBub3cuICovCj4gPiAgIAkJcmV0dXJuIHRy
dWU7Cj4gPiAgIAl9IGVsc2UKPiA+IEBAIC0xMTUzLDcgKzExNTMsNyBAQCBzdGF0aWMgaW50IGlz
XzJNQl9ndHRfcG9zc2libGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfZ3Z0X2d0dF9wdGVfb3BzICpvcHMgPSB2Z3B1LT5ndnQtPmd0dC5wdGVfb3BzOwo+ID4g
ICAJdW5zaWduZWQgbG9uZyBwZm47Cj4gPiAtCWlmICghSEFTX1BBR0VfU0laRVModmdwdS0+Z3Z0
LT5kZXZfcHJpdiwgSTkxNV9HVFRfUEFHRV9TSVpFXzJNKSkKPiA+ICsJaWYgKCFIQVNfUEFHRV9T
SVpFUyh2Z3B1LT5ndnQtPmk5MTUsIEk5MTVfR1RUX1BBR0VfU0laRV8yTSkpCj4gPiAgIAkJcmV0
dXJuIDA7Cj4gPiAgIAlwZm4gPSBpbnRlbF9ndnRfaHlwZXJ2aXNvcl9nZm5fdG9fbWZuKHZncHUs
IG9wcy0+Z2V0X3BmbihlbnRyeSkpOwo+ID4gQEAgLTIzMDEsNyArMjMwMSw3IEBAIHN0YXRpYyBp
bnQgZW11bGF0ZV9nZ3R0X21taW9fd3JpdGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHVuc2ln
bmVkIGludCBvZmYsCj4gPiAgIAlnZ3R0X2ludmFsaWRhdGVfcHRlKHZncHUsICZlKTsKPiA+ICAg
CWdndHRfc2V0X2hvc3RfZW50cnkoZ2d0dF9tbSwgJm0sIGdfZ3R0X2luZGV4KTsKPiA+IC0JZ2d0
dF9pbnZhbGlkYXRlKGd2dC0+ZGV2X3ByaXYpOwo+ID4gKwlnZ3R0X2ludmFsaWRhdGUoZ3Z0LT5p
OTE1KTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiBAQCAtMjM0MCw3ICsyMzQwLDcgQEAg
c3RhdGljIGludCBhbGxvY19zY3JhdGNoX3BhZ2VzKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+
ID4gICAJCQkJdmdwdS0+Z3Z0LT5kZXZpY2VfaW5mby5ndHRfZW50cnlfc2l6ZV9zaGlmdDsKPiA+
ICAgCXZvaWQgKnNjcmF0Y2hfcHQ7Cj4gPiAgIAlpbnQgaTsKPiA+IC0Jc3RydWN0IGRldmljZSAq
ZGV2ID0gJnZncHUtPmd2dC0+ZGV2X3ByaXYtPmRybS5wZGV2LT5kZXY7Cj4gPiArCXN0cnVjdCBk
ZXZpY2UgKmRldiA9ICZ2Z3B1LT5ndnQtPmk5MTUtPmRybS5wZGV2LT5kZXY7Cj4gPiAgIAlkbWFf
YWRkcl90IGRhZGRyOwo+ID4gICAJaWYgKFdBUk5fT04odHlwZSA8IEdUVF9UWVBFX1BQR1RUX1BU
RV9QVCB8fCB0eXBlID49IEdUVF9UWVBFX01BWCkpCj4gPiBAQCAtMjM5Nyw3ICsyMzk3LDcgQEAg
c3RhdGljIGludCBhbGxvY19zY3JhdGNoX3BhZ2VzKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+
ID4gICBzdGF0aWMgaW50IHJlbGVhc2Vfc2NyYXRjaF9wYWdlX3RyZWUoc3RydWN0IGludGVsX3Zn
cHUgKnZncHUpCj4gPiAgIHsKPiA+ICAgCWludCBpOwo+ID4gLQlzdHJ1Y3QgZGV2aWNlICpkZXYg
PSAmdmdwdS0+Z3Z0LT5kZXZfcHJpdi0+ZHJtLnBkZXYtPmRldjsKPiA+ICsJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJnZncHUtPmd2dC0+aTkxNS0+ZHJtLnBkZXYtPmRldjsKPiA+ICAgCWRtYV9hZGRy
X3QgZGFkZHI7Cj4gPiAgIAlmb3IgKGkgPSBHVFRfVFlQRV9QUEdUVF9QVEVfUFQ7IGkgPCBHVFRf
VFlQRV9NQVg7IGkrKykgewo+ID4gQEAgLTI2NjksNyArMjY2OSw3IEBAIGludCBpbnRlbF9ndnRf
aW5pdF9ndHQoc3RydWN0IGludGVsX2d2dCAqZ3Z0KQo+ID4gICB7Cj4gPiAgIAlpbnQgcmV0Owo+
ID4gICAJdm9pZCAqcGFnZTsKPiA+IC0Jc3RydWN0IGRldmljZSAqZGV2ID0gJmd2dC0+ZGV2X3By
aXYtPmRybS5wZGV2LT5kZXY7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZndnQtPmk5MTUt
PmRybS5wZGV2LT5kZXY7Cj4gPiAgIAlkbWFfYWRkcl90IGRhZGRyOwo+ID4gICAJZ3Z0X2RiZ19j
b3JlKCJpbml0IGd0dFxuIik7Cj4gPiBAQCAtMjcxOCw3ICsyNzE4LDcgQEAgaW50IGludGVsX2d2
dF9pbml0X2d0dChzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gPiAgICAqLwo+ID4gICB2b2lkIGlu
dGVsX2d2dF9jbGVhbl9ndHQoc3RydWN0IGludGVsX2d2dCAqZ3Z0KQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkZXZpY2UgKmRldiA9ICZndnQtPmRldl9wcml2LT5kcm0ucGRldi0+ZGV2Owo+ID4gKwlz
dHJ1Y3QgZGV2aWNlICpkZXYgPSAmZ3Z0LT5pOTE1LT5kcm0ucGRldi0+ZGV2Owo+ID4gICAJZG1h
X2FkZHJfdCBkYWRkciA9IChkbWFfYWRkcl90KShndnQtPmd0dC5zY3JhdGNoX21mbiA8PAo+ID4g
ICAJCQkJCUk5MTVfR1RUX1BBR0VfU0hJRlQpOwo+ID4gQEAgLTI3NjYsNyArMjc2Niw3IEBAIHZv
aWQgaW50ZWxfdmdwdV9pbnZhbGlkYXRlX3BwZ3R0KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+
ID4gICB2b2lkIGludGVsX3ZncHVfcmVzZXRfZ2d0dChzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwg
Ym9vbCBpbnZhbGlkYXRlX29sZCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2d2dCAqZ3Z0
ID0gdmdwdS0+Z3Z0Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBn
dnQtPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd2dC0+
aTkxNTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9ndnRfZ3R0X3B0ZV9vcHMgKnB0ZV9vcHMgPSB2Z3B1
LT5ndnQtPmd0dC5wdGVfb3BzOwo+ID4gICAJc3RydWN0IGludGVsX2d2dF9ndHRfZW50cnkgZW50
cnkgPSB7LnR5cGUgPSBHVFRfVFlQRV9HR1RUX1BURX07Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0
X2d0dF9lbnRyeSBvbGRfZW50cnk7Cj4gPiBAQCAtMjc5Niw3ICsyNzk2LDcgQEAgdm9pZCBpbnRl
bF92Z3B1X3Jlc2V0X2dndHQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGJvb2wgaW52YWxpZGF0
ZV9vbGQpCj4gPiAgIAkJZ2d0dF9zZXRfaG9zdF9lbnRyeSh2Z3B1LT5ndHQuZ2d0dF9tbSwgJmVu
dHJ5LCBpbmRleCsrKTsKPiA+ICAgCX0KPiA+IC0JZ2d0dF9pbnZhbGlkYXRlKGRldl9wcml2KTsK
PiA+ICsJZ2d0dF9pbnZhbGlkYXRlKGk5MTUpOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9ndnQuYwo+ID4gaW5kZXggNDNmNDI0MjA2MmRkLi5iODRjZGQ4ZDhjOTggMTAwNjQ0
Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3Z0LmMKPiA+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuYwo+ID4gQEAgLTUyLDcgKzUyLDcgQEAgc3RhdGljIHN0
cnVjdCBpbnRlbF92Z3B1X3R5cGUgKmludGVsX2d2dF9maW5kX3ZncHVfdHlwZShzdHJ1Y3QgaW50
ZWxfZ3Z0ICpndnQsCj4gPiAgIAlpbnQgaTsKPiA+ICAgCXN0cnVjdCBpbnRlbF92Z3B1X3R5cGUg
KnQ7Cj4gPiAgIAljb25zdCBjaGFyICpkcml2ZXJfbmFtZSA9IGRldl9kcml2ZXJfc3RyaW5nKAo+
ID4gLQkJCSZndnQtPmRldl9wcml2LT5kcm0ucGRldi0+ZGV2KTsKPiA+ICsJCQkmZ3Z0LT5pOTE1
LT5kcm0ucGRldi0+ZGV2KTsKPiA+ICAgCWZvciAoaSA9IDA7IGkgPCBndnQtPm51bV90eXBlczsg
aSsrKSB7Cj4gPiAgIAkJdCA9ICZndnQtPnR5cGVzW2ldOwo+ID4gQEAgLTE5MSw3ICsxOTEsNyBA
QCBzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2d2dF9vcHMgaW50ZWxfZ3Z0X29wcyA9IHsKPiA+
ICAgc3RhdGljIHZvaWQgaW5pdF9kZXZpY2VfaW5mbyhzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4g
PiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9ndnRfZGV2aWNlX2luZm8gKmluZm8gPSAmZ3Z0LT5k
ZXZpY2VfaW5mbzsKPiA+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBndnQtPmRldl9wcml2LT5k
cm0ucGRldjsKPiA+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBndnQtPmk5MTUtPmRybS5wZGV2
Owo+ID4gICAJaW5mby0+bWF4X3N1cHBvcnRfdmdwdXMgPSA4Owo+ID4gICAJaW5mby0+Y2ZnX3Nw
YWNlX3NpemUgPSBQQ0lfQ0ZHX1NQQUNFX0VYUF9TSVpFOwo+ID4gQEAgLTI1NywxNSArMjU3LDE1
IEBAIHN0YXRpYyBpbnQgaW5pdF9zZXJ2aWNlX3RocmVhZChzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQp
Cj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9ndnRfY2xlYW5fZGV2aWNlIC0gY2xlYW4gYSBHVlQg
ZGV2aWNlCj4gPiAtICogQGRldl9wcml2OiBpOTE1IHByaXZhdGUKPiA+ICsgKiBAaTkxNTogaTkx
NSBwcml2YXRlCj4gPiAgICAqCj4gPiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGF0IHRo
ZSBkcml2ZXIgdW5sb2FkaW5nIHN0YWdlLCB0byBmcmVlIHRoZQo+ID4gICAgKiByZXNvdXJjZXMg
b3duZWQgYnkgYSBHVlQgZGV2aWNlLgo+ID4gICAgKgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVs
X2d2dF9jbGVhbl9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K3ZvaWQgaW50ZWxfZ3Z0X2NsZWFuX2RldmljZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQgPSB0b19ndnQoZGV2X3ByaXYp
Owo+ID4gKwlzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQgPSB0b19ndnQoaTkxNSk7Cj4gPiAgIAlpZiAo
V0FSTl9PTighZ3Z0KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiBAQCAtMjg1LDEzICsyODUsMTMgQEAg
dm9pZCBpbnRlbF9ndnRfY2xlYW5fZGV2aWNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICAgCWludGVsX2d2dF9jbGVhbl9tbWlvX2luZm8oZ3Z0KTsKPiA+ICAgCWlkcl9k
ZXN0cm95KCZndnQtPnZncHVfaWRyKTsKPiA+IC0Ja2ZyZWUoZGV2X3ByaXYtPmd2dCk7Cj4gPiAt
CWRldl9wcml2LT5ndnQgPSBOVUxMOwo+ID4gKwlrZnJlZShpOTE1LT5ndnQpOwo+ID4gKwlpOTE1
LT5ndnQgPSBOVUxMOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9ndnRfaW5pdF9k
ZXZpY2UgLSBpbml0aWFsaXplIGEgR1ZUIGRldmljZQo+ID4gLSAqIEBkZXZfcHJpdjogZHJtIGk5
MTUgcHJpdmF0ZSBkYXRhCj4gPiArICogQGk5MTU6IGRybSBpOTE1IHByaXZhdGUgZGF0YQo+ID4g
ICAgKgo+ID4gICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhdCB0aGUgaW5pdGlhbGl6YXRp
b24gc3RhZ2UsIHRvIGluaXRpYWxpemUKPiA+ICAgICogbmVjZXNzYXJ5IEdWVCBjb21wb25lbnRz
Lgo+ID4gQEAgLTMwMCwxMyArMzAwLDEzIEBAIHZvaWQgaW50ZWxfZ3Z0X2NsZWFuX2RldmljZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgICAqIFplcm8gb24gc3VjY2Vz
cywgbmVnYXRpdmUgZXJyb3IgY29kZSBpZiBmYWlsZWQuCj4gPiAgICAqCj4gPiAgICAqLwo+ID4g
LWludCBpbnRlbF9ndnRfaW5pdF9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gK2ludCBpbnRlbF9ndnRfaW5pdF9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9ndnQgKmd2dDsKPiA+ICAgCXN0
cnVjdCBpbnRlbF92Z3B1ICp2Z3B1Owo+ID4gICAJaW50IHJldDsKPiA+IC0JaWYgKFdBUk5fT04o
ZGV2X3ByaXYtPmd2dCkpCj4gPiArCWlmIChXQVJOX09OKGk5MTUtPmd2dCkpCj4gPiAgIAkJcmV0
dXJuIC1FRVhJU1Q7Cj4gPiAgIAlndnQgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgaW50ZWxfZ3Z0
KSwgR0ZQX0tFUk5FTCk7Cj4gPiBAQCAtMzE5LDcgKzMxOSw3IEBAIGludCBpbnRlbF9ndnRfaW5p
dF9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJc3Bpbl9s
b2NrX2luaXQoJmd2dC0+c2NoZWR1bGVyLm1taW9fY29udGV4dF9sb2NrKTsKPiA+ICAgCW11dGV4
X2luaXQoJmd2dC0+bG9jayk7Cj4gPiAgIAltdXRleF9pbml0KCZndnQtPnNjaGVkX2xvY2spOwo+
ID4gLQlndnQtPmRldl9wcml2ID0gZGV2X3ByaXY7Cj4gPiArCWd2dC0+aTkxNSA9IGk5MTU7Cj4g
PiAgIAlpbml0X2RldmljZV9pbmZvKGd2dCk7Cj4gPiBAQCAtMzgwLDggKzM4MCw4IEBAIGludCBp
bnRlbF9ndnRfaW5pdF9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gICAJCWd2dF9lcnIoImRlYnVnZnMgcmVnaXN0cmF0aW9uIGZhaWxlZCwgZ28gb24uXG4iKTsK
PiA+ICAgCWd2dF9kYmdfY29yZSgiZ3Z0IGRldmljZSBpbml0aWFsaXphdGlvbiBpcyBkb25lXG4i
KTsKPiA+IC0JZGV2X3ByaXYtPmd2dCA9IGd2dDsKPiA+IC0JaW50ZWxfZ3Z0X2hvc3QuZGV2ID0g
JmRldl9wcml2LT5kcm0ucGRldi0+ZGV2Owo+ID4gKwlpOTE1LT5ndnQgPSBndnQ7Cj4gPiArCWlu
dGVsX2d2dF9ob3N0LmRldiA9ICZpOTE1LT5kcm0ucGRldi0+ZGV2Owo+ID4gICAJaW50ZWxfZ3Z0
X2hvc3QuaW5pdGlhbGl6ZWQgPSB0cnVlOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Z0L2d2dC5oCj4gPiBpbmRleCBiNTRmMmJkYzEzYTQuLmZiZWJlMGFlNDA5NiAxMDA2NDQKPiA+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuaAo+ID4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Z0L2d2dC5oCj4gPiBAQCAtMzA2LDcgKzMwNiw3IEBAIHN0cnVjdCBpbnRl
bF9ndnQgewo+ID4gICAJLyogc2NoZWR1bGVyIHNjb3BlIGxvY2ssIHByb3RlY3QgZ3Z0IGFuZCB2
Z3B1IHNjaGVkdWxlIHJlbGF0ZWQgZGF0YSAqLwo+ID4gICAJc3RydWN0IG11dGV4IHNjaGVkX2xv
Y2s7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdjsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7Cj4gPiAgIAlzdHJ1Y3QgaWRyIHZncHVfaWRyOwkvKiB2
R1BVIElEUiBwb29sICovCj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0X2RldmljZV9pbmZvIGRldmlj
ZV9pbmZvOwo+ID4gQEAgLTM3MywxMiArMzczLDEyIEBAIGludCBpbnRlbF9ndnRfbG9hZF9maXJt
d2FyZShzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpOwo+ID4gICAjZGVmaW5lIEhPU1RfRkVOQ0UgNAo+
ID4gICAvKiBBcGVydHVyZS9HTSBzcGFjZSBkZWZpbml0aW9ucyBmb3IgR1ZUIGRldmljZSAqLwo+
ID4gLSNkZWZpbmUgZ3Z0X2FwZXJ0dXJlX3N6KGd2dCkJICAoZ3Z0LT5kZXZfcHJpdi0+Z2d0dC5t
YXBwYWJsZV9lbmQpCj4gPiAtI2RlZmluZSBndnRfYXBlcnR1cmVfcGFfYmFzZShndnQpIChndnQt
PmRldl9wcml2LT5nZ3R0LmdtYWRyLnN0YXJ0KQo+ID4gKyNkZWZpbmUgZ3Z0X2FwZXJ0dXJlX3N6
KGd2dCkJICAoZ3Z0LT5pOTE1LT5nZ3R0Lm1hcHBhYmxlX2VuZCkKPiA+ICsjZGVmaW5lIGd2dF9h
cGVydHVyZV9wYV9iYXNlKGd2dCkgKGd2dC0+aTkxNS0+Z2d0dC5nbWFkci5zdGFydCkKPiA+IC0j
ZGVmaW5lIGd2dF9nZ3R0X2dtX3N6KGd2dCkJICAoZ3Z0LT5kZXZfcHJpdi0+Z2d0dC52bS50b3Rh
bCkKPiA+ICsjZGVmaW5lIGd2dF9nZ3R0X2dtX3N6KGd2dCkJICAoZ3Z0LT5pOTE1LT5nZ3R0LnZt
LnRvdGFsKQo+ID4gICAjZGVmaW5lIGd2dF9nZ3R0X3N6KGd2dCkgXAo+ID4gLQkoKGd2dC0+ZGV2
X3ByaXYtPmdndHQudm0udG90YWwgPj4gUEFHRV9TSElGVCkgPDwgMykKPiA+ICsJKChndnQtPmk5
MTUtPmdndHQudm0udG90YWwgPj4gUEFHRV9TSElGVCkgPDwgMykKPiA+ICAgI2RlZmluZSBndnRf
aGlkZGVuX3N6KGd2dCkJICAoZ3Z0X2dndHRfZ21fc3ooZ3Z0KSAtIGd2dF9hcGVydHVyZV9zeihn
dnQpKQo+ID4gICAjZGVmaW5lIGd2dF9hcGVydHVyZV9nbWFkcl9iYXNlKGd2dCkgKDApCj4gPiBA
QCAtMzkwLDcgKzM5MCw3IEBAIGludCBpbnRlbF9ndnRfbG9hZF9maXJtd2FyZShzdHJ1Y3QgaW50
ZWxfZ3Z0ICpndnQpOwo+ID4gICAjZGVmaW5lIGd2dF9oaWRkZW5fZ21hZHJfZW5kKGd2dCkgKGd2
dF9oaWRkZW5fZ21hZHJfYmFzZShndnQpIFwKPiA+ICAgCQkJCSAgICsgZ3Z0X2hpZGRlbl9zeihn
dnQpIC0gMSkKPiA+IC0jZGVmaW5lIGd2dF9mZW5jZV9zeihndnQpIChndnQtPmRldl9wcml2LT5u
dW1fZmVuY2VfcmVncykKPiA+ICsjZGVmaW5lIGd2dF9mZW5jZV9zeihndnQpIChndnQtPmk5MTUt
Pm51bV9mZW5jZV9yZWdzKQo+ID4gICAvKiBBcGVydHVyZS9HTSBzcGFjZSBkZWZpbml0aW9ucyBm
b3IgdkdQVSAqLwo+ID4gICAjZGVmaW5lIHZncHVfYXBlcnR1cmVfb2Zmc2V0KHZncHUpCSgodmdw
dSktPmdtLmxvd19nbV9ub2RlLnN0YXJ0KQo+ID4gQEAgLTU4MiwxNCArNTgyLDE0IEBAIGVudW0g
ewo+ID4gICAJR1ZUX0ZBSUxTQUZFX0dVRVNUX0VSUiwKPiA+ICAgfTsKPiA+IC1zdGF0aWMgaW5s
aW5lIHZvaWQgbW1pb19od19hY2Nlc3NfcHJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtzdGF0aWMgaW5saW5lIHZvaWQgbW1pb19od19hY2Nlc3NfcHJlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fZ2V0
KGRldl9wcml2KTsKPiA+ICsJaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgaW5saW5lIHZvaWQgbW1pb19od19hY2Nlc3NfcG9zdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGlubGluZSB2b2lkIG1taW9faHdfYWNjZXNz
X3Bvc3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JaW50ZWxf
cnVudGltZV9wbV9wdXRfdW5jaGVja2VkKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfcnVudGltZV9w
bV9wdXRfdW5jaGVja2VkKGk5MTUpOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9oYW5kbGVycy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L2hhbmRsZXJzLmMKPiA+IGluZGV4IGE2YWRlNjYzNDliZC4uOWFjYjAxYjBiN2M3IDEw
MDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2hhbmRsZXJzLmMKPiA+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9oYW5kbGVycy5jCj4gPiBAQCAtNDksMTUgKzQ5
LDE1IEBACj4gPiAgIHVuc2lnbmVkIGxvbmcgaW50ZWxfZ3Z0X2dldF9kZXZpY2VfdHlwZShzdHJ1
Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gPiAgIHsKPiA+IC0JaWYgKElTX0JST0FEV0VMTChndnQtPmRl
dl9wcml2KSkKPiA+ICsJaWYgKElTX0JST0FEV0VMTChndnQtPmk5MTUpKQo+ID4gICAJCXJldHVy
biBEX0JEVzsKPiA+IC0JZWxzZSBpZiAoSVNfU0tZTEFLRShndnQtPmRldl9wcml2KSkKPiA+ICsJ
ZWxzZSBpZiAoSVNfU0tZTEFLRShndnQtPmk5MTUpKQo+ID4gICAJCXJldHVybiBEX1NLTDsKPiA+
IC0JZWxzZSBpZiAoSVNfS0FCWUxBS0UoZ3Z0LT5kZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElT
X0tBQllMQUtFKGd2dC0+aTkxNSkpCj4gPiAgIAkJcmV0dXJuIERfS0JMOwo+ID4gLQllbHNlIGlm
IChJU19CUk9YVE9OKGd2dC0+ZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19CUk9YVE9OKGd2
dC0+aTkxNSkpCj4gPiAgIAkJcmV0dXJuIERfQlhUOwo+ID4gLQllbHNlIGlmIChJU19DT0ZGRUVM
QUtFKGd2dC0+ZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19DT0ZGRUVMQUtFKGd2dC0+aTkx
NSkpCj4gPiAgIAkJcmV0dXJuIERfQ0ZMOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiBAQCAtMTU2LDcg
KzE1Niw3IEBAIGludCBpbnRlbF9ndnRfcmVuZGVyX21taW9fdG9fcmluZ19pZChzdHJ1Y3QgaW50
ZWxfZ3Z0ICpndnQsCj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gPiAg
IAlvZmZzZXQgJj0gfkdFTk1BU0soMTEsIDApOwo+ID4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5l
LCBndnQtPmRldl9wcml2LCBpZCkgewo+ID4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndnQt
Pmk5MTUsIGlkKSB7Cj4gPiAgIAkJaWYgKGVuZ2luZS0+bW1pb19iYXNlID09IG9mZnNldCkKPiA+
ICAgCQkJcmV0dXJuIGlkOwo+ID4gICAJfQo+ID4gQEAgLTIxNyw3ICsyMTcsNyBAQCBzdGF0aWMg
aW50IGdhbXdfZWNob19kZXZfcndfaWFfd3JpdGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4g
PiAgIHsKPiA+ICAgCXUzMiBpcHMgPSAoKih1MzIgKilwX2RhdGEpICYgR0FNV19FQ09fRU5BQkxF
XzY0S19JUFNfRklFTEQ7Cj4gPiAtCWlmIChJTlRFTF9HRU4odmdwdS0+Z3Z0LT5kZXZfcHJpdikg
PD0gMTApIHsKPiA+ICsJaWYgKElOVEVMX0dFTih2Z3B1LT5ndnQtPmk5MTUpIDw9IDEwKSB7Cj4g
PiAgIAkJaWYgKGlwcyA9PSBHQU1XX0VDT19FTkFCTEVfNjRLX0lQU19GSUVMRCkKPiA+ICAgCQkJ
Z3Z0X2RiZ19jb3JlKCJ2Z3B1JWQ6IGlwcyBlbmFibGVkXG4iLCB2Z3B1LT5pZCk7Cj4gPiAgIAkJ
ZWxzZSBpZiAoIWlwcykKPiA+IEBAIC0yNTMsNyArMjUzLDcgQEAgc3RhdGljIGludCBmZW5jZV9t
bWlvX3JlYWQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHVuc2lnbmVkIGludCBvZmYsCj4gPiAg
IHN0YXRpYyBpbnQgZmVuY2VfbW1pb193cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgdW5z
aWduZWQgaW50IG9mZiwKPiA+ICAgCQl2b2lkICpwX2RhdGEsIHVuc2lnbmVkIGludCBieXRlcykK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5n
dnQtPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUt
Pmd2dC0+aTkxNTsKPiA+ICAgCXVuc2lnbmVkIGludCBmZW5jZV9udW0gPSBvZmZzZXRfdG9fZmVu
Y2VfbnVtKG9mZik7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gQEAgLTI2MiwxMCArMjYyLDEwIEBAIHN0
YXRpYyBpbnQgZmVuY2VfbW1pb193cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgdW5zaWdu
ZWQgaW50IG9mZiwKPiA+ICAgCQlyZXR1cm4gcmV0Owo+ID4gICAJd3JpdGVfdnJlZyh2Z3B1LCBv
ZmYsIHBfZGF0YSwgYnl0ZXMpOwo+ID4gLQltbWlvX2h3X2FjY2Vzc19wcmUoZGV2X3ByaXYpOwo+
ID4gKwltbWlvX2h3X2FjY2Vzc19wcmUoaTkxNSk7Cj4gPiAgIAlpbnRlbF92Z3B1X3dyaXRlX2Zl
bmNlKHZncHUsIGZlbmNlX251bSwKPiA+ICAgCQkJdmdwdV92cmVnNjQodmdwdSwgZmVuY2VfbnVt
X3RvX29mZnNldChmZW5jZV9udW0pKSk7Cj4gPiAtCW1taW9faHdfYWNjZXNzX3Bvc3QoZGV2X3By
aXYpOwo+ID4gKwltbWlvX2h3X2FjY2Vzc19wb3N0KGk5MTUpOwo+ID4gICAJcmV0dXJuIDA7Cj4g
PiAgIH0KPiA+IEBAIC0yODMsNyArMjgzLDcgQEAgc3RhdGljIGludCBtdWxfZm9yY2Vfd2FrZV93
cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiA+ICAgCW9sZCA9IHZncHVfdnJlZyh2Z3B1
LCBvZmZzZXQpOwo+ID4gICAJbmV3ID0gQ0FMQ19NT0RFX01BU0tfUkVHKG9sZCwgKih1MzIgKilw
X2RhdGEpOwo+ID4gLQlpZiAoSU5URUxfR0VOKHZncHUtPmd2dC0+ZGV2X3ByaXYpICA+PSAgOSkg
ewo+ID4gKwlpZiAoSU5URUxfR0VOKHZncHUtPmd2dC0+aTkxNSkgID49ICA5KSB7Cj4gPiAgIAkJ
c3dpdGNoIChvZmZzZXQpIHsKPiA+ICAgCQljYXNlIEZPUkNFV0FLRV9SRU5ERVJfR0VOOV9SRUc6
Cj4gPiAgIAkJCWFja19yZWdfb2Zmc2V0ID0gRk9SQ0VXQUtFX0FDS19SRU5ERVJfR0VOOV9SRUc7
Cj4gPiBAQCAtMzQxLDcgKzM0MSw3IEBAIHN0YXRpYyBpbnQgZ2Ryc3RfbW1pb193cml0ZShzdHJ1
Y3QgaW50ZWxfdmdwdSAqdmdwdSwgdW5zaWduZWQgaW50IG9mZnNldCwKPiA+ICAgCQkJZ3Z0X2Ri
Z19tbWlvKCJ2Z3B1JWQ6IHJlcXVlc3QgVkNTMiBSZXNldFxuIiwgdmdwdS0+aWQpOwo+ID4gICAJ
CQllbmdpbmVfbWFzayB8PSBCSVQoVkNTMSk7Cj4gPiAgIAkJfQo+ID4gLQkJZW5naW5lX21hc2sg
Jj0gSU5URUxfSU5GTyh2Z3B1LT5ndnQtPmRldl9wcml2KS0+ZW5naW5lX21hc2s7Cj4gPiArCQll
bmdpbmVfbWFzayAmPSBJTlRFTF9JTkZPKHZncHUtPmd2dC0+aTkxNSktPmVuZ2luZV9tYXNrOwo+
ID4gICAJfQo+ID4gICAJLyogdmdwdV9sb2NrIGFscmVhZHkgaG9sZCBieSBlbXVsYXRlIG1taW8g
ci93ICovCj4gPiBAQCAtNTExLDcgKzUxMSw3IEBAIHN0YXRpYyBpbnQgZm9yY2Vfbm9ucHJpdl93
cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiA+ICAgCXUzMiByZWdfbm9ucHJpdiA9ICoo
dTMyICopcF9kYXRhOwo+ID4gICAJaW50IHJpbmdfaWQgPSBpbnRlbF9ndnRfcmVuZGVyX21taW9f
dG9fcmluZ19pZCh2Z3B1LT5ndnQsIG9mZnNldCk7Cj4gPiAgIAl1MzIgcmluZ19iYXNlOwo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkxNTsK
PiA+ICAgCWludCByZXQgPSAtRUlOVkFMOwo+ID4gICAJaWYgKChieXRlcyAhPSA0KSB8fCAoKG9m
ZnNldCAmIChieXRlcyAtIDEpKSAhPSAwKSB8fCByaW5nX2lkIDwgMCkgewo+ID4gQEAgLTUyMCw3
ICs1MjAsNyBAQCBzdGF0aWMgaW50IGZvcmNlX25vbnByaXZfd3JpdGUoc3RydWN0IGludGVsX3Zn
cHUgKnZncHUsCj4gPiAgIAkJcmV0dXJuIHJldDsKPiA+ICAgCX0KPiA+IC0JcmluZ19iYXNlID0g
ZGV2X3ByaXYtPmVuZ2luZVtyaW5nX2lkXS0+bW1pb19iYXNlOwo+ID4gKwlyaW5nX2Jhc2UgPSBp
OTE1LT5lbmdpbmVbcmluZ19pZF0tPm1taW9fYmFzZTsKPiA+ICAgCWlmIChpbl93aGl0ZWxpc3Qo
cmVnX25vbnByaXYpIHx8Cj4gPiAgIAkJcmVnX25vbnByaXYgPT0gaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoUklOR19OT1BJRChyaW5nX2Jhc2UpKSkgewo+ID4gQEAgLTc1MSw3ICs3NTEsNyBAQCBzdGF0
aWMgaW50IHNvdXRoX2NoaWNrZW4yX21taW9fd3JpdGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUs
Cj4gPiAgIHN0YXRpYyBpbnQgcHJpX3N1cmZfbW1pb193cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAq
dmdwdSwgdW5zaWduZWQgaW50IG9mZnNldCwKPiA+ICAgCQl2b2lkICpwX2RhdGEsIHVuc2lnbmVk
IGludCBieXRlcykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHZncHUtPmd2dC0+aTkxNTsKPiA+ICAgCXUzMiBwaXBlID0gRFNQU1VSRl9UT19QSVBF
KG9mZnNldCk7Cj4gPiAgIAlpbnQgZXZlbnQgPSBTS0xfRkxJUF9FVkVOVChwaXBlLCBQTEFORV9Q
UklNQVJZKTsKPiA+IEBAIC03OTIsNyArNzkyLDcgQEAgc3RhdGljIGludCByZWc1MDA4MF9tbWlv
X3dyaXRlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+ID4gICAJCQkgICAgICAgdW5zaWduZWQg
aW50IG9mZnNldCwgdm9pZCAqcF9kYXRhLAo+ID4gICAJCQkgICAgICAgdW5zaWduZWQgaW50IGJ5
dGVzKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZn
cHUtPmd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dmdwdS0+Z3Z0LT5pOTE1Owo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBSRUdfNTAwODBfVE9fUElQ
RShvZmZzZXQpOwo+ID4gICAJZW51bSBwbGFuZV9pZCBwbGFuZSA9IFJFR181MDA4MF9UT19QTEFO
RShvZmZzZXQpOwo+ID4gICAJaW50IGV2ZW50ID0gU0tMX0ZMSVBfRVZFTlQocGlwZSwgcGxhbmUp
Owo+ID4gQEAgLTgxNiw3ICs4MTYsNyBAQCBzdGF0aWMgaW50IHJlZzUwMDgwX21taW9fd3JpdGUo
c3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gPiAgIHN0YXRpYyBpbnQgdHJpZ2dlcl9hdXhfY2hh
bm5lbF9pbnRlcnJ1cHQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCj4gPiAgIAkJdW5zaWduZWQg
aW50IHJlZykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHZncHUtPmd2dC0+aTkxNTsKPiA+ICAgCWVudW0gaW50ZWxfZ3Z0X2V2ZW50X3R5cGUgZXZl
bnQ7Cj4gPiAgIAlpZiAocmVnID09IF9EUEFfQVVYX0NIX0NUTCkKPiA+IEBAIC05MTYsMTEgKzkx
NiwxMSBAQCBzdGF0aWMgaW50IGRwX2F1eF9jaF9jdGxfbW1pb193cml0ZShzdHJ1Y3QgaW50ZWxf
dmdwdSAqdmdwdSwKPiA+ICAgCXdyaXRlX3ZyZWcodmdwdSwgb2Zmc2V0LCBwX2RhdGEsIGJ5dGVz
KTsKPiA+ICAgCWRhdGEgPSB2Z3B1X3ZyZWcodmdwdSwgb2Zmc2V0KTsKPiA+IC0JaWYgKChJTlRF
TF9HRU4odmdwdS0+Z3Z0LT5kZXZfcHJpdikgPj0gOSkKPiA+ICsJaWYgKChJTlRFTF9HRU4odmdw
dS0+Z3Z0LT5pOTE1KSA+PSA5KQo+ID4gICAJCSYmIG9mZnNldCAhPSBfUkVHX1NLTF9EUF9BVVhf
Q0hfQ1RMKHBvcnRfaW5kZXgpKSB7Cj4gPiAgIAkJLyogU0tMIERQQi9DL0QgYXV4IGN0bCByZWdp
c3RlciBjaGFuZ2VkICovCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfQlJP
QURXRUxMKHZncHUtPmd2dC0+ZGV2X3ByaXYpICYmCj4gPiArCX0gZWxzZSBpZiAoSVNfQlJPQURX
RUxMKHZncHUtPmd2dC0+aTkxNSkgJiYKPiA+ICAgCQkgICBvZmZzZXQgIT0gX1JFR19IU1dfRFBf
QVVYX0NIX0NUTChwb3J0X2luZGV4KSkgewo+ID4gICAJCS8qIHdyaXRlIHRvIHRoZSBkYXRhIHJl
Z2lzdGVycyAqLwo+ID4gICAJCXJldHVybiAwOwo+ID4gQEAgLTEyMzYsOCArMTIzNiw4IEBAIHN0
YXRpYyBpbnQgaGFuZGxlX2cydl9ub3RpZmljYXRpb24oc3RydWN0IGludGVsX3ZncHUgKnZncHUs
IGludCBub3RpZmljYXRpb24pCj4gPiAgIHN0YXRpYyBpbnQgc2VuZF9kaXNwbGF5X3JlYWR5X3Vl
dmVudChzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgaW50IHJlYWR5KQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4g
PiAtCXN0cnVjdCBrb2JqZWN0ICprb2JqID0gJmRldl9wcml2LT5kcm0ucHJpbWFyeS0+a2Rldi0+
a29iajsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5
MTU7Cj4gPiArCXN0cnVjdCBrb2JqZWN0ICprb2JqID0gJmk5MTUtPmRybS5wcmltYXJ5LT5rZGV2
LT5rb2JqOwo+ID4gICAJY2hhciAqZW52WzNdID0ge05VTEwsIE5VTEwsIE5VTEx9Owo+ID4gICAJ
Y2hhciB2bWlkX3N0clsyMF07Cj4gPiAgIAljaGFyIGRpc3BsYXlfcmVhZHlfc3RyWzIwXTsKPiA+
IEBAIC0xNDE2LDkgKzE0MTYsOSBAQCBzdGF0aWMgaW50IG1haWxib3hfd3JpdGUoc3RydWN0IGlu
dGVsX3ZncHUgKnZncHUsIHVuc2lnbmVkIGludCBvZmZzZXQsCj4gPiAgIAlzd2l0Y2ggKGNtZCkg
ewo+ID4gICAJY2FzZSBHRU45X1BDT0RFX1JFQURfTUVNX0xBVEVOQ1k6Cj4gPiAtCQlpZiAoSVNf
U0tZTEFLRSh2Z3B1LT5ndnQtPmRldl9wcml2KQo+ID4gLQkJCSB8fCBJU19LQUJZTEFLRSh2Z3B1
LT5ndnQtPmRldl9wcml2KQo+ID4gLQkJCSB8fCBJU19DT0ZGRUVMQUtFKHZncHUtPmd2dC0+ZGV2
X3ByaXYpKSB7Cj4gPiArCQlpZiAoSVNfU0tZTEFLRSh2Z3B1LT5ndnQtPmk5MTUpCj4gPiArCQkJ
IHx8IElTX0tBQllMQUtFKHZncHUtPmd2dC0+aTkxNSkKPiA+ICsJCQkgfHwgSVNfQ09GRkVFTEFL
RSh2Z3B1LT5ndnQtPmk5MTUpKSB7Cj4gPiAgIAkJCS8qKgo+ID4gICAJCQkgKiAiUmVhZCBtZW1v
cnkgbGF0ZW5jeSIgY29tbWFuZCBvbiBnZW45Lgo+ID4gICAJCQkgKiBCZWxvdyBtZW1vcnkgbGF0
ZW5jeSB2YWx1ZXMgYXJlIHJlYWQKPiA+IEBAIC0xNDI4LDcgKzE0MjgsNyBAQCBzdGF0aWMgaW50
IG1haWxib3hfd3JpdGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHVuc2lnbmVkIGludCBvZmZz
ZXQsCj4gPiAgIAkJCQkqZGF0YTAgPSAweDFlMWExMTAwOwo+ID4gICAJCQllbHNlCj4gPiAgIAkJ
CQkqZGF0YTAgPSAweDYxNTE0YjNkOwo+ID4gLQkJfSBlbHNlIGlmIChJU19CUk9YVE9OKHZncHUt
Pmd2dC0+ZGV2X3ByaXYpKSB7Cj4gPiArCQl9IGVsc2UgaWYgKElTX0JST1hUT04odmdwdS0+Z3Z0
LT5pOTE1KSkgewo+ID4gICAJCQkvKioKPiA+ICAgCQkJICogIlJlYWQgbWVtb3J5IGxhdGVuY3ki
IGNvbW1hbmQgb24gZ2VuOS4KPiA+ICAgCQkJICogQmVsb3cgbWVtb3J5IGxhdGVuY3kgdmFsdWVz
IGFyZSByZWFkCj4gPiBAQCAtMTQ0MSw5ICsxNDQxLDkgQEAgc3RhdGljIGludCBtYWlsYm94X3dy
aXRlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCB1bnNpZ25lZCBpbnQgb2Zmc2V0LAo+ID4gICAJ
CX0KPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgU0tMX1BDT0RFX0NEQ0xLX0NPTlRST0w6Cj4g
PiAtCQlpZiAoSVNfU0tZTEFLRSh2Z3B1LT5ndnQtPmRldl9wcml2KQo+ID4gLQkJCSB8fCBJU19L
QUJZTEFLRSh2Z3B1LT5ndnQtPmRldl9wcml2KQo+ID4gLQkJCSB8fCBJU19DT0ZGRUVMQUtFKHZn
cHUtPmd2dC0+ZGV2X3ByaXYpKQo+ID4gKwkJaWYgKElTX1NLWUxBS0UodmdwdS0+Z3Z0LT5pOTE1
KQo+ID4gKwkJCSB8fCBJU19LQUJZTEFLRSh2Z3B1LT5ndnQtPmk5MTUpCj4gPiArCQkJIHx8IElT
X0NPRkZFRUxBS0UodmdwdS0+Z3Z0LT5pOTE1KSkKPiA+ICAgCQkJKmRhdGEwID0gU0tMX0NEQ0xL
X1JFQURZX0ZPUl9DSEFOR0U7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEdFTjZfUENPREVf
UkVBRF9SQzZWSURTOgo+ID4gQEAgLTE0OTYsNyArMTQ5Niw3IEBAIHN0YXRpYyBpbnQgc2tsX3Bv
d2VyX3dlbGxfY3RsX3dyaXRlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+ID4gICB7Cj4gPiAg
IAl1MzIgdiA9ICoodTMyICopcF9kYXRhOwo+ID4gLQlpZiAoSVNfQlJPWFRPTih2Z3B1LT5ndnQt
PmRldl9wcml2KSkKPiA+ICsJaWYgKElTX0JST1hUT04odmdwdS0+Z3Z0LT5pOTE1KSkKPiA+ICAg
CQl2ICY9ICgxIDw8IDMxKSB8ICgxIDw8IDI5KTsKPiA+ICAgCWVsc2UKPiA+ICAgCQl2ICY9ICgx
IDw8IDMxKSB8ICgxIDw8IDI5KSB8ICgxIDw8IDkpIHwKPiA+IEBAIC0xNjMzLDcgKzE2MzMsNyBA
QCBzdGF0aWMgaW50IG1taW9fcmVhZF9mcm9tX2h3KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+
ID4gICAJCXVuc2lnbmVkIGludCBvZmZzZXQsIHZvaWQgKnBfZGF0YSwgdW5zaWduZWQgaW50IGJ5
dGVzKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQgPSB2Z3B1LT5ndnQ7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd2dC0+ZGV2X3ByaXY7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3Z0LT5pOTE1Owo+ID4gICAJaW50
IHJpbmdfaWQ7Cj4gPiAgIAl1MzIgcmluZ19iYXNlOwo+ID4gQEAgLTE2NDUsMTQgKzE2NDUsMTQg
QEAgc3RhdGljIGludCBtbWlvX3JlYWRfZnJvbV9odyhzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwK
PiA+ICAgCSAqIGMuIHRoZSBvZmZzZXQgaXMgcmluZyB0aW1lIHN0YW1wIG1taW8KPiA+ICAgCSAq
Lwo+ID4gICAJaWYgKHJpbmdfaWQgPj0gMCkKPiA+IC0JCXJpbmdfYmFzZSA9IGRldl9wcml2LT5l
bmdpbmVbcmluZ19pZF0tPm1taW9fYmFzZTsKPiA+ICsJCXJpbmdfYmFzZSA9IGk5MTUtPmVuZ2lu
ZVtyaW5nX2lkXS0+bW1pb19iYXNlOwo+ID4gICAJaWYgKHJpbmdfaWQgPCAwIHx8IHZncHUgID09
IGd2dC0+c2NoZWR1bGVyLmVuZ2luZV9vd25lcltyaW5nX2lkXSB8fAo+ID4gICAJICAgIG9mZnNl
dCA9PSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX1RJTUVTVEFNUChyaW5nX2Jhc2UpKSB8fAo+
ID4gICAJICAgIG9mZnNldCA9PSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX1RJTUVTVEFNUF9V
RFcocmluZ19iYXNlKSkpIHsKPiA+IC0JCW1taW9faHdfYWNjZXNzX3ByZShkZXZfcHJpdik7Cj4g
PiArCQltbWlvX2h3X2FjY2Vzc19wcmUoaTkxNSk7Cj4gPiAgIAkJdmdwdV92cmVnKHZncHUsIG9m
ZnNldCkgPSBJOTE1X1JFQUQoX01NSU8ob2Zmc2V0KSk7Cj4gPiAtCQltbWlvX2h3X2FjY2Vzc19w
b3N0KGRldl9wcml2KTsKPiA+ICsJCW1taW9faHdfYWNjZXNzX3Bvc3QoaTkxNSk7Cj4gPiAgIAl9
Cj4gPiAgIAlyZXR1cm4gaW50ZWxfdmdwdV9kZWZhdWx0X21taW9fcmVhZCh2Z3B1LCBvZmZzZXQs
IHBfZGF0YSwgYnl0ZXMpOwo+ID4gQEAgLTE2OTMsNyArMTY5Myw3IEBAIHN0YXRpYyBpbnQgcmlu
Z19tb2RlX21taW9fd3JpdGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHVuc2lnbmVkIGludCBv
ZmZzZXQsCj4gPiAgIAlpbnQgcmV0Owo+ID4gICAJKCoodTMyICopcF9kYXRhKSAmPSB+X01BU0tF
RF9CSVRfRU5BQkxFKDEpOwo+ID4gLQlpZiAoSVNfQ09GRkVFTEFLRSh2Z3B1LT5ndnQtPmRldl9w
cml2KSkKPiA+ICsJaWYgKElTX0NPRkZFRUxBS0UodmdwdS0+Z3Z0LT5pOTE1KSkKPiA+ICAgCQko
Kih1MzIgKilwX2RhdGEpICY9IH5fTUFTS0VEX0JJVF9FTkFCTEUoMik7Cj4gPiAgIAl3cml0ZV92
cmVnKHZncHUsIG9mZnNldCwgcF9kYXRhLCBieXRlcyk7Cj4gPiBAQCAtMTcwMiw3ICsxNzAyLDcg
QEAgc3RhdGljIGludCByaW5nX21vZGVfbW1pb193cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdw
dSwgdW5zaWduZWQgaW50IG9mZnNldCwKPiA+ICAgCQlyZXR1cm4gMDsKPiA+ICAgCX0KPiA+IC0J
aWYgKElTX0NPRkZFRUxBS0UodmdwdS0+Z3Z0LT5kZXZfcHJpdikgJiYKPiA+ICsJaWYgKElTX0NP
RkZFRUxBS0UodmdwdS0+Z3Z0LT5pOTE1KSAmJgo+ID4gICAJICAgIGRhdGEgJiBfTUFTS0VEX0JJ
VF9FTkFCTEUoMikpIHsKPiA+ICAgCQllbnRlcl9mYWlsc2FmZV9tb2RlKHZncHUsIEdWVF9GQUlM
U0FGRV9VTlNVUFBPUlRFRF9HVUVTVCk7Cj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiBAQCAtMTgzNCw3
ICsxODM0LDcgQEAgc3RhdGljIGludCBjc2ZlX2NoaWNrZW4xX21taW9fd3JpdGUoc3RydWN0IGlu
dGVsX3ZncHUgKnZncHUsCj4gPiAgIAlNTUlPX0YocHJlZml4KEJMVF9SSU5HX0JBU0UpLCBzLCBm
LCBhbSwgcm0sIGQsIHIsIHcpOyBcCj4gPiAgIAlNTUlPX0YocHJlZml4KEdFTjZfQlNEX1JJTkdf
QkFTRSksIHMsIGYsIGFtLCBybSwgZCwgciwgdyk7IFwKPiA+ICAgCU1NSU9fRihwcmVmaXgoVkVC
T1hfUklOR19CQVNFKSwgcywgZiwgYW0sIHJtLCBkLCByLCB3KTsgXAo+ID4gLQlpZiAoSEFTX0VO
R0lORShkZXZfcHJpdiwgVkNTMSkpIFwKPiA+ICsJaWYgKEhBU19FTkdJTkUoaTkxNSwgVkNTMSkp
IFwKPiA+ICAgCQlNTUlPX0YocHJlZml4KEdFTjhfQlNEMl9SSU5HX0JBU0UpLCBzLCBmLCBhbSwg
cm0sIGQsIHIsIHcpOyBcCj4gPiAgIH0gd2hpbGUgKDApCj4gPiBAQCAtMTg1NSw3ICsxODU1LDcg
QEAgc3RhdGljIGludCBjc2ZlX2NoaWNrZW4xX21taW9fd3JpdGUoc3RydWN0IGludGVsX3ZncHUg
KnZncHUsCj4gPiAgIHN0YXRpYyBpbnQgaW5pdF9nZW5lcmljX21taW9faW5mbyhzdHJ1Y3QgaW50
ZWxfZ3Z0ICpndnQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gZ3Z0LT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSBndnQtPmk5MTU7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gICAJTU1JT19SSU5HX0RGSChSSU5HX0lN
UiwgRF9BTEwsIEZfQ01EX0FDQ0VTUywgTlVMTCwKPiA+IEBAIC0yNjcwLDcgKzI2NzAsNyBAQCBz
dGF0aWMgaW50IGluaXRfZ2VuZXJpY19tbWlvX2luZm8oc3RydWN0IGludGVsX2d2dCAqZ3Z0KQo+
ID4gICBzdGF0aWMgaW50IGluaXRfYnJvYWR3ZWxsX21taW9faW5mbyhzdHJ1Y3QgaW50ZWxfZ3Z0
ICpndnQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
Z3Z0LT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndnQt
Pmk5MTU7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gICAJTU1JT19ESChHRU44X0dUX0lNUigwKSwgRF9C
RFdfUExVUywgTlVMTCwgaW50ZWxfdmdwdV9yZWdfaW1yX2hhbmRsZXIpOwo+ID4gQEAgLTI4NTks
NyArMjg1OSw3IEBAIHN0YXRpYyBpbnQgaW5pdF9icm9hZHdlbGxfbW1pb19pbmZvKHN0cnVjdCBp
bnRlbF9ndnQgKmd2dCkKPiA+ICAgc3RhdGljIGludCBpbml0X3NrbF9tbWlvX2luZm8oc3RydWN0
IGludGVsX2d2dCAqZ3Z0KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gZ3Z0LT5pOTE1Owo+ID4gICAJaW50IHJldDsKPiA+ICAgCU1NSU9fREgoRk9SQ0VXQUtF
X1JFTkRFUl9HRU45LCBEX1NLTF9QTFVTLCBOVUxMLCBtdWxfZm9yY2Vfd2FrZV93cml0ZSk7Cj4g
PiBAQCAtMzEwOCw3ICszMTA4LDcgQEAgc3RhdGljIGludCBpbml0X3NrbF9tbWlvX2luZm8oc3Ry
dWN0IGludGVsX2d2dCAqZ3Z0KQo+ID4gICBzdGF0aWMgaW50IGluaXRfYnh0X21taW9faW5mbyhz
dHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZ3Z0LT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBndnQtPmk5MTU7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gICAJTU1JT19GKF9NTUlP
KDB4ODAwMDApLCAweDMwMDAsIDAsIDAsIDAsIERfQlhULCBOVUxMLCBOVUxMKTsKPiA+IEBAIC0z
MzQ0LDcgKzMzNDQsNyBAQCBzdGF0aWMgc3RydWN0IGd2dF9tbWlvX2Jsb2NrIG1taW9fYmxvY2tz
W10gPSB7Cj4gPiAgIGludCBpbnRlbF9ndnRfc2V0dXBfbW1pb19pbmZvKHN0cnVjdCBpbnRlbF9n
dnQgKmd2dCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2d2dF9kZXZpY2VfaW5mbyAqaW5m
byA9ICZndnQtPmRldmljZV9pbmZvOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSBndnQtPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IGd2dC0+aTkxNTsKPiA+ICAgCWludCBzaXplID0gaW5mby0+bW1pb19zaXplIC8gNCAqIHNp
emVvZigqZ3Z0LT5tbWlvLm1taW9fYXR0cmlidXRlKTsKPiA+ICAgCWludCByZXQ7Cj4gPiBAQCAt
MzM1NiwyMCArMzM1NiwyMCBAQCBpbnQgaW50ZWxfZ3Z0X3NldHVwX21taW9faW5mbyhzdHJ1Y3Qg
aW50ZWxfZ3Z0ICpndnQpCj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCWdvdG8gZXJyOwo+ID4gLQlp
ZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfQlJPQURXRUxMKGk5MTUp
KSB7Cj4gPiAgIAkJcmV0ID0gaW5pdF9icm9hZHdlbGxfbW1pb19pbmZvKGd2dCk7Cj4gPiAgIAkJ
aWYgKHJldCkKPiA+ICAgCQkJZ290byBlcnI7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfU0tZTEFLRShk
ZXZfcHJpdikKPiA+IC0JCXx8IElTX0tBQllMQUtFKGRldl9wcml2KQo+ID4gLQkJfHwgSVNfQ09G
RkVFTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19TS1lMQUtFKGk5MTUpCj4g
PiArCQl8fCBJU19LQUJZTEFLRShpOTE1KQo+ID4gKwkJfHwgSVNfQ09GRkVFTEFLRShpOTE1KSkg
ewo+ID4gICAJCXJldCA9IGluaXRfYnJvYWR3ZWxsX21taW9faW5mbyhndnQpOwo+ID4gICAJCWlm
IChyZXQpCj4gPiAgIAkJCWdvdG8gZXJyOwo+ID4gICAJCXJldCA9IGluaXRfc2tsX21taW9faW5m
byhndnQpOwo+ID4gICAJCWlmIChyZXQpCj4gPiAgIAkJCWdvdG8gZXJyOwo+ID4gLQl9IGVsc2Ug
aWYgKElTX0JST1hUT04oZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfQlJPWFRPTihp
OTE1KSkgewo+ID4gICAJCXJldCA9IGluaXRfYnJvYWR3ZWxsX21taW9faW5mbyhndnQpOwo+ID4g
ICAJCWlmIChyZXQpCj4gPiAgIAkJCWdvdG8gZXJyOwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9pbnRlcnJ1cHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9p
bnRlcnJ1cHQuYwo+ID4gaW5kZXggOTUxNjgxODEzMjMwLi4zN2UyZTcyYmZhY2MgMTAwNjQ0Cj4g
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvaW50ZXJydXB0LmMKPiA+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9pbnRlcnJ1cHQuYwo+ID4gQEAgLTUzNiw3ICs1MzYsNyBA
QCBzdGF0aWMgdm9pZCBnZW44X2luaXRfaXJxKAo+ID4gICAJU0VUX0JJVF9JTkZPKGlycSwgNCwg
VkNTX01JX0ZMVVNIX0RXLCBJTlRFTF9HVlRfSVJRX0lORk9fR1QxKTsKPiA+ICAgCVNFVF9CSVRf
SU5GTyhpcnEsIDgsIFZDU19BU19DT05URVhUX1NXSVRDSCwgSU5URUxfR1ZUX0lSUV9JTkZPX0dU
MSk7Cj4gPiAtCWlmIChIQVNfRU5HSU5FKGd2dC0+ZGV2X3ByaXYsIFZDUzEpKSB7Cj4gPiArCWlm
IChIQVNfRU5HSU5FKGd2dC0+aTkxNSwgVkNTMSkpIHsKPiA+ICAgCQlTRVRfQklUX0lORk8oaXJx
LCAxNiwgVkNTMl9NSV9VU0VSX0lOVEVSUlVQVCwKPiA+ICAgCQkJSU5URUxfR1ZUX0lSUV9JTkZP
X0dUMSk7Cj4gPiAgIAkJU0VUX0JJVF9JTkZPKGlycSwgMjAsIFZDUzJfTUlfRkxVU0hfRFcsCj4g
PiBAQCAtNTY4LDcgKzU2OCw3IEBAIHN0YXRpYyB2b2lkIGdlbjhfaW5pdF9pcnEoCj4gPiAgIAlT
RVRfQklUX0lORk8oaXJxLCAyMiwgRFBfQ19IT1RQTFVHLCBJTlRFTF9HVlRfSVJRX0lORk9fUENI
KTsKPiA+ICAgCVNFVF9CSVRfSU5GTyhpcnEsIDIzLCBEUF9EX0hPVFBMVUcsIElOVEVMX0dWVF9J
UlFfSU5GT19QQ0gpOwo+ID4gLQlpZiAoSVNfQlJPQURXRUxMKGd2dC0+ZGV2X3ByaXYpKSB7Cj4g
PiArCWlmIChJU19CUk9BRFdFTEwoZ3Z0LT5pOTE1KSkgewo+ID4gICAJCVNFVF9CSVRfSU5GTyhp
cnEsIDI1LCBBVVhfQ0hBTk5FTF9CLCBJTlRFTF9HVlRfSVJRX0lORk9fUENIKTsKPiA+ICAgCQlT
RVRfQklUX0lORk8oaXJxLCAyNiwgQVVYX0NIQU5ORUxfQywgSU5URUxfR1ZUX0lSUV9JTkZPX1BD
SCk7Cj4gPiAgIAkJU0VUX0JJVF9JTkZPKGlycSwgMjcsIEFVWF9DSEFOTkVMX0QsIElOVEVMX0dW
VF9JUlFfSU5GT19QQ0gpOwo+ID4gQEAgLTU4MSw3ICs1ODEsNyBAQCBzdGF0aWMgdm9pZCBnZW44
X2luaXRfaXJxKAo+ID4gICAJCVNFVF9CSVRfSU5GTyhpcnEsIDQsIFBSSU1BUllfQ19GTElQX0RP
TkUsIElOVEVMX0dWVF9JUlFfSU5GT19ERV9QSVBFX0MpOwo+ID4gICAJCVNFVF9CSVRfSU5GTyhp
cnEsIDUsIFNQUklURV9DX0ZMSVBfRE9ORSwgSU5URUxfR1ZUX0lSUV9JTkZPX0RFX1BJUEVfQyk7
Cj4gPiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGd2dC0+ZGV2X3ByaXYpID49IDkpIHsKPiA+ICsJ
fSBlbHNlIGlmIChJTlRFTF9HRU4oZ3Z0LT5pOTE1KSA+PSA5KSB7Cj4gPiAgIAkJU0VUX0JJVF9J
TkZPKGlycSwgMjUsIEFVWF9DSEFOTkVMX0IsIElOVEVMX0dWVF9JUlFfSU5GT19ERV9QT1JUKTsK
PiA+ICAgCQlTRVRfQklUX0lORk8oaXJxLCAyNiwgQVVYX0NIQU5ORUxfQywgSU5URUxfR1ZUX0lS
UV9JTkZPX0RFX1BPUlQpOwo+ID4gICAJCVNFVF9CSVRfSU5GTyhpcnEsIDI3LCBBVVhfQ0hBTk5F
TF9ELCBJTlRFTF9HVlRfSVJRX0lORk9fREVfUE9SVCk7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Z0L2t2bWd0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3Zt
Z3QuYwo+ID4gaW5kZXggMTQ0MzAxYjc3OGRmLi42MTVhNzk1OWI3NjIgMTAwNjQ0Cj4gPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQva3ZtZ3QuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Z0L2t2bWd0LmMKPiA+IEBAIC0xODcsNyArMTg3LDcgQEAgc3RhdGljIGludCBn
dnRfcGluX2d1ZXN0X3BhZ2Uoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHVuc2lnbmVkIGxvbmcg
Z2ZuLAo+ID4gICBzdGF0aWMgaW50IGd2dF9kbWFfbWFwX3BhZ2Uoc3RydWN0IGludGVsX3ZncHUg
KnZncHUsIHVuc2lnbmVkIGxvbmcgZ2ZuLAo+ID4gICAJCWRtYV9hZGRyX3QgKmRtYV9hZGRyLCB1
bnNpZ25lZCBsb25nIHNpemUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRldmljZSAqZGV2ID0gJnZn
cHUtPmd2dC0+ZGV2X3ByaXYtPmRybS5wZGV2LT5kZXY7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmRl
diA9ICZ2Z3B1LT5ndnQtPmk5MTUtPmRybS5wZGV2LT5kZXY7Cj4gPiAgIAlzdHJ1Y3QgcGFnZSAq
cGFnZSA9IE5VTEw7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gQEAgLTIxMCw3ICsyMTAsNyBAQCBzdGF0
aWMgaW50IGd2dF9kbWFfbWFwX3BhZ2Uoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIHVuc2lnbmVk
IGxvbmcgZ2ZuLAo+ID4gICBzdGF0aWMgdm9pZCBndnRfZG1hX3VubWFwX3BhZ2Uoc3RydWN0IGlu
dGVsX3ZncHUgKnZncHUsIHVuc2lnbmVkIGxvbmcgZ2ZuLAo+ID4gICAJCWRtYV9hZGRyX3QgZG1h
X2FkZHIsIHVuc2lnbmVkIGxvbmcgc2l6ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSAmdmdwdS0+Z3Z0LT5kZXZfcHJpdi0+ZHJtLnBkZXYtPmRldjsKPiA+ICsJc3RydWN0IGRl
dmljZSAqZGV2ID0gJnZncHUtPmd2dC0+aTkxNS0+ZHJtLnBkZXYtPmRldjsKPiA+ICAgCWRtYV91
bm1hcF9wYWdlKGRldiwgZG1hX2FkZHIsIHNpemUsIFBDSV9ETUFfQklESVJFQ1RJT05BTCk7Cj4g
PiAgIAlndnRfdW5waW5fZ3Vlc3RfcGFnZSh2Z3B1LCBnZm4sIHNpemUpOwo+ID4gQEAgLTkxMyw3
ICs5MTMsNyBAQCBzdGF0aWMgaW50IGludGVsX3ZncHVfYXBlcnR1cmVfcncoc3RydWN0IGludGVs
X3ZncHUgKnZncHUsIHU2NCBvZmYsCj4gPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gPiAgIAl9Cj4g
PiAtCWFwZXJ0dXJlX3ZhID0gaW9fbWFwcGluZ19tYXBfd2MoJnZncHUtPmd2dC0+ZGV2X3ByaXYt
PmdndHQuaW9tYXAsCj4gPiArCWFwZXJ0dXJlX3ZhID0gaW9fbWFwcGluZ19tYXBfd2MoJnZncHUt
Pmd2dC0+aTkxNS0+Z2d0dC5pb21hcCwKPiA+ICAgCQkJCQlBTElHTl9ET1dOKG9mZiwgUEFHRV9T
SVpFKSwKPiA+ICAgCQkJCQljb3VudCArIG9mZnNldF9pbl9wYWdlKG9mZikpOwo+ID4gICAJaWYg
KCFhcGVydHVyZV92YSkKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQv
bW1pby5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L21taW8uYwo+ID4gaW5kZXggYTU1MTc4
ODg0ZDY3Li41NzJiODMyOGFmNjEgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndnQvbW1pby5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1pby5jCj4g
PiBAQCAtMjQ1LDcgKzI0NSw3IEBAIHZvaWQgaW50ZWxfdmdwdV9yZXNldF9tbWlvKHN0cnVjdCBp
bnRlbF92Z3B1ICp2Z3B1LCBib29sIGRtbHIpCj4gPiAgIAkJLyogc2V0IHRoZSBiaXQgMDoyKENv
cmUgQy1TdGF0ZSApIHRvIEMwICovCj4gPiAgIAkJdmdwdV92cmVnX3QodmdwdSwgR0VONl9HVF9D
T1JFX1NUQVRVUykgPSAwOwo+ID4gLQkJaWYgKElTX0JST1hUT04odmdwdS0+Z3Z0LT5kZXZfcHJp
dikpIHsKPiA+ICsJCWlmIChJU19CUk9YVE9OKHZncHUtPmd2dC0+aTkxNSkpIHsKPiA+ICAgCQkJ
dmdwdV92cmVnX3QodmdwdSwgQlhUX1BfQ1JfR1RfRElTUF9QV1JPTikgJj0KPiA+ICAgCQkJCSAg
ICB+KEJJVCgwKSB8IEJJVCgxKSk7Cj4gPiAgIAkJCXZncHVfdnJlZ190KHZncHUsIEJYVF9QT1JU
X0NMMUNNX0RXMChEUElPX1BIWTApKSAmPQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9tbWlvX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9tbWlv
X2NvbnRleHQuYwo+ID4gaW5kZXggMjk5ODk5OWU4NTY4Li40NGZkNmEwYTY5OGMgMTAwNjQ0Cj4g
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvbW1pb19jb250ZXh0LmMKPiA+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9tbWlvX2NvbnRleHQuYwo+ID4gQEAgLTE0OCw3ICsx
NDgsNyBAQCBzdGF0aWMgc3RydWN0IHsKPiA+ICAgCXUzMiBsM2NjX3RhYmxlW0dFTjlfTU9DU19T
SVpFIC8gMl07Cj4gPiAgIH0gZ2VuOV9yZW5kZXJfbW9jczsKPiA+IC1zdGF0aWMgdm9pZCBsb2Fk
X3JlbmRlcl9tb2NzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0
aWMgdm9pZCBsb2FkX3JlbmRlcl9tb2NzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAgIAlpOTE1X3JlZ190IG9mZnNldDsKPiA+ICAgCXUzMiByZWdzW10gPSB7Cj4g
PiBAQCAtMTYxLDcgKzE2MSw3IEBAIHN0YXRpYyB2b2lkIGxvYWRfcmVuZGVyX21vY3Moc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJaW50IHJpbmdfaWQsIGk7Cj4gPiAg
IAlmb3IgKHJpbmdfaWQgPSAwOyByaW5nX2lkIDwgQVJSQVlfU0laRShyZWdzKTsgcmluZ19pZCsr
KSB7Cj4gPiAtCQlpZiAoIUhBU19FTkdJTkUoZGV2X3ByaXYsIHJpbmdfaWQpKQo+ID4gKwkJaWYg
KCFIQVNfRU5HSU5FKGk5MTUsIHJpbmdfaWQpKQo+ID4gICAJCQljb250aW51ZTsKPiA+ICAgCQlv
ZmZzZXQucmVnID0gcmVnc1tyaW5nX2lkXTsKPiA+ICAgCQlmb3IgKGkgPSAwOyBpIDwgR0VOOV9N
T0NTX1NJWkU7IGkrKykgewo+ID4gQEAgLTMyOSw4ICszMjksOCBAQCBpbnQgaW50ZWxfdmdwdV9y
ZXN0b3JlX2luaGliaXRfY29udGV4dChzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwKPiA+ICAgc3Rh
dGljIHZvaWQgaGFuZGxlX3RsYl9wZW5kaW5nX2V2ZW50KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1
LCBpbnQgcmluZ19pZCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+ID4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29y
ZSA9ICZpOTE1LT51bmNvcmU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdV9zdWJtaXNzaW9uICpz
ID0gJnZncHUtPnN1Ym1pc3Npb247Cj4gPiAgIAllbnVtIGZvcmNld2FrZV9kb21haW5zIGZ3Owo+
ID4gICAJaTkxNV9yZWdfdCByZWc7Cj4gPiBAQCAtMzU3LDcgKzM1Nyw3IEBAIHN0YXRpYyB2b2lk
IGhhbmRsZV90bGJfcGVuZGluZ19ldmVudChzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgaW50IHJp
bmdfaWQpCj4gPiAgIAkgKi8KPiA+ICAgCWZ3ID0gaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9mb3Jf
cmVnKHVuY29yZSwgcmVnLAo+ID4gICAJCQkJCSAgICBGV19SRUdfUkVBRCB8IEZXX1JFR19XUklU
RSk7Cj4gPiAtCWlmIChyaW5nX2lkID09IFJDUzAgJiYgSU5URUxfR0VOKGRldl9wcml2KSA+PSA5
KQo+ID4gKwlpZiAocmluZ19pZCA9PSBSQ1MwICYmIElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4g
ICAJCWZ3IHw9IEZPUkNFV0FLRV9SRU5ERVI7Cj4gPiAgIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtl
X2dldCh1bmNvcmUsIGZ3KTsKPiA+IEBAIC0zNzcsNyArMzc3LDcgQEAgc3RhdGljIHZvaWQgaGFu
ZGxlX3RsYl9wZW5kaW5nX2V2ZW50KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBpbnQgcmluZ19p
ZCkKPiA+ICAgc3RhdGljIHZvaWQgc3dpdGNoX21vY3Moc3RydWN0IGludGVsX3ZncHUgKnByZSwg
c3RydWN0IGludGVsX3ZncHUgKm5leHQsCj4gPiAgIAkJCWludCByaW5nX2lkKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTU7Cj4gPiAgIAlpOTE1X3JlZ190IG9mZnNldCwgbDNfb2Zmc2V0Owo+
ID4gICAJdTMyIG9sZF92LCBuZXdfdjsKPiA+IEBAIC0zOTAsMTUgKzM5MCwxNSBAQCBzdGF0aWMg
dm9pZCBzd2l0Y2hfbW9jcyhzdHJ1Y3QgaW50ZWxfdmdwdSAqcHJlLCBzdHJ1Y3QgaW50ZWxfdmdw
dSAqbmV4dCwKPiA+ICAgCX07Cj4gPiAgIAlpbnQgaTsKPiA+IC0JZGV2X3ByaXYgPSBwcmUgPyBw
cmUtPmd2dC0+ZGV2X3ByaXYgOiBuZXh0LT5ndnQtPmRldl9wcml2Owo+ID4gKwlpOTE1ID0gcHJl
ID8gcHJlLT5ndnQtPmk5MTUgOiBuZXh0LT5ndnQtPmk5MTU7Cj4gPiAgIAlpZiAoV0FSTl9PTihy
aW5nX2lkID49IEFSUkFZX1NJWkUocmVncykpKQo+ID4gICAJCXJldHVybjsKPiA+IC0JaWYgKHJp
bmdfaWQgPT0gUkNTMCAmJiBJU19HRU4oZGV2X3ByaXYsIDkpKQo+ID4gKwlpZiAocmluZ19pZCA9
PSBSQ1MwICYmIElTX0dFTihpOTE1LCA5KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAlpZiAoIXBy
ZSAmJiAhZ2VuOV9yZW5kZXJfbW9jcy5pbml0aWFsaXplZCkKPiA+IC0JCWxvYWRfcmVuZGVyX21v
Y3MoZGV2X3ByaXYpOwo+ID4gKwkJbG9hZF9yZW5kZXJfbW9jcyhpOTE1KTsKPiA+ICAgCW9mZnNl
dC5yZWcgPSByZWdzW3JpbmdfaWRdOwo+ID4gICAJZm9yIChpID0gMDsgaSA8IEdFTjlfTU9DU19T
SVpFOyBpKyspIHsKPiA+IEBAIC00NTQsMTYgKzQ1NCwxNiBAQCBzdGF0aWMgdm9pZCBzd2l0Y2hf
bW1pbyhzdHJ1Y3QgaW50ZWxfdmdwdSAqcHJlLAo+ID4gICAJCQlzdHJ1Y3QgaW50ZWxfdmdwdSAq
bmV4dCwKPiA+ICAgCQkJaW50IHJpbmdfaWQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsK
PiA+ICAgCXN0cnVjdCBpbnRlbF92Z3B1X3N1Ym1pc3Npb24gKnM7Cj4gPiAgIAlzdHJ1Y3QgZW5n
aW5lX21taW8gKm1taW87Cj4gPiAgIAl1MzIgb2xkX3YsIG5ld192Owo+ID4gLQlkZXZfcHJpdiA9
IHByZSA/IHByZS0+Z3Z0LT5kZXZfcHJpdiA6IG5leHQtPmd2dC0+ZGV2X3ByaXY7Cj4gPiAtCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiArCWk5MTUgPSBwcmUgPyBwcmUtPmd2dC0+
aTkxNSA6IG5leHQtPmd2dC0+aTkxNTsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+
ID4gICAJCXN3aXRjaF9tb2NzKHByZSwgbmV4dCwgcmluZ19pZCk7Cj4gPiAtCWZvciAobW1pbyA9
IGRldl9wcml2LT5ndnQtPmVuZ2luZV9tbWlvX2xpc3QubW1pbzsKPiA+ICsJZm9yIChtbWlvID0g
aTkxNS0+Z3Z0LT5lbmdpbmVfbW1pb19saXN0Lm1taW87Cj4gPiAgIAkgICAgIGk5MTVfbW1pb19y
ZWdfdmFsaWQobW1pby0+cmVnKTsgbW1pbysrKSB7Cj4gPiAgIAkJaWYgKG1taW8tPnJpbmdfaWQg
IT0gcmluZ19pZCkKPiA+ICAgCQkJY29udGludWU7Cj4gPiBAQCAtNDcyLDcgKzQ3Miw3IEBAIHN0
YXRpYyB2b2lkIHN3aXRjaF9tbWlvKHN0cnVjdCBpbnRlbF92Z3B1ICpwcmUsCj4gPiAgIAkJICog
c3RhdGUgaW1hZ2Ugb24gZ2VuOSwgaXQncyBpbml0aWFsaXplZCBieSBscmkgY29tbWFuZCBhbmQK
PiA+ICAgCQkgKiBzYXZlIG9yIHJlc3RvcmUgd2l0aCBjb250ZXh0IHRvZ2V0aGVyLgo+ID4gICAJ
CSAqLwo+ID4gLQkJaWYgKElTX0dFTihkZXZfcHJpdiwgOSkgJiYgbW1pby0+aW5fY29udGV4dCkK
PiA+ICsJCWlmIChJU19HRU4oaTkxNSwgOSkgJiYgbW1pby0+aW5fY29udGV4dCkKPiA+ICAgCQkJ
Y29udGludWU7Cj4gPiAgIAkJLy8gc2F2ZQo+ID4gQEAgLTUzNiw3ICs1MzYsNyBAQCBzdGF0aWMg
dm9pZCBzd2l0Y2hfbW1pbyhzdHJ1Y3QgaW50ZWxfdmdwdSAqcHJlLAo+ID4gICB2b2lkIGludGVs
X2d2dF9zd2l0Y2hfbW1pbyhzdHJ1Y3QgaW50ZWxfdmdwdSAqcHJlLAo+ID4gICAJCQkgICBzdHJ1
Y3QgaW50ZWxfdmdwdSAqbmV4dCwgaW50IHJpbmdfaWQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNTsKPiA+ICAgCWlmIChXQVJOX09OKCFwcmUgJiYgIW5leHQpKQo+ID4gICAJCXJldHVybjsK
PiA+IEBAIC01NDQsMTYgKzU0NCwxNiBAQCB2b2lkIGludGVsX2d2dF9zd2l0Y2hfbW1pbyhzdHJ1
Y3QgaW50ZWxfdmdwdSAqcHJlLAo+ID4gICAJZ3Z0X2RiZ19yZW5kZXIoInN3aXRjaCByaW5nICVk
IGZyb20gJXMgdG8gJXNcbiIsIHJpbmdfaWQsCj4gPiAgIAkJICAgICAgIHByZSA/ICJ2R1BVIiA6
ICJob3N0IiwgbmV4dCA/ICJ2R1BVIiA6ICJIT1NUIik7Cj4gPiAtCWRldl9wcml2ID0gcHJlID8g
cHJlLT5ndnQtPmRldl9wcml2IDogbmV4dC0+Z3Z0LT5kZXZfcHJpdjsKPiA+ICsJaTkxNSA9IHBy
ZSA/IHByZS0+Z3Z0LT5pOTE1IDogbmV4dC0+Z3Z0LT5pOTE1Owo+ID4gICAJLyoqCj4gPiAgIAkg
KiBXZSBhcmUgdXNpbmcgcmF3IG1taW8gYWNjZXNzIHdyYXBwZXIgdG8gaW1wcm92ZSB0aGUKPiA+
ICAgCSAqIHBlcmZvcm1hY2UgZm9yIGJhdGNoIG1taW8gcmVhZC93cml0ZSwgc28gd2UgbmVlZAo+
ID4gICAJICogaGFuZGxlIGZvcmNld2FrZSBtYW5udWFsbHkuCj4gPiAgIAkgKi8KPiA+IC0JaW50
ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwp
Owo+ID4gKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdB
S0VfQUxMKTsKPiA+ICAgCXN3aXRjaF9tbWlvKHByZSwgbmV4dCwgcmluZ19pZCk7Cj4gPiAtCWlu
dGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxM
KTsKPiA+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VX
QUtFX0FMTCk7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiBAQCAtNTY1LDcgKzU2NSw3IEBAIHZvaWQg
aW50ZWxfZ3Z0X2luaXRfZW5naW5lX21taW9fY29udGV4dChzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQp
Cj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBlbmdpbmVfbW1pbyAqbW1pbzsKPiA+IC0JaWYgKElOVEVM
X0dFTihndnQtPmRldl9wcml2KSA+PSA5KQo+ID4gKwlpZiAoSU5URUxfR0VOKGd2dC0+aTkxNSkg
Pj0gOSkKPiA+ICAgCQlndnQtPmVuZ2luZV9tbWlvX2xpc3QubW1pbyA9IGdlbjlfZW5naW5lX21t
aW9fbGlzdDsKPiA+ICAgCWVsc2UKPiA+ICAgCQlndnQtPmVuZ2luZV9tbWlvX2xpc3QubW1pbyA9
IGdlbjhfZW5naW5lX21taW9fbGlzdDsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvc2NoZWRfcG9saWN5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWRf
cG9saWN5LmMKPiA+IGluZGV4IDFjNzYzYTI3YTQxMi4uNjRhNWQ0Njg4Yzg5IDEwMDY0NAo+ID4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkX3BvbGljeS5jCj4gPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWRfcG9saWN5LmMKPiA+IEBAIC0zOSw3ICszOSw3
IEBAIHN0YXRpYyBib29sIHZncHVfaGFzX3BlbmRpbmdfd29ya2xvYWQoc3RydWN0IGludGVsX3Zn
cHUgKnZncHUpCj4gPiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBpOwo+ID4gICAJc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ID4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCB2Z3B1
LT5ndnQtPmRldl9wcml2LCBpKSB7Cj4gPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIHZncHUt
Pmd2dC0+aTkxNSwgaSkgewo+ID4gICAJCWlmICghbGlzdF9lbXB0eSh3b3JrbG9hZF9xX2hlYWQo
dmdwdSwgaSkpKQo+ID4gICAJCQlyZXR1cm4gdHJ1ZTsKPiA+ICAgCX0KPiA+IEBAIC0xNTIsNyAr
MTUyLDcgQEAgc3RhdGljIHZvaWQgdHJ5X3RvX3NjaGVkdWxlX25leHRfdmdwdShzdHJ1Y3QgaW50
ZWxfZ3Z0ICpndnQpCj4gPiAgIAlzY2hlZHVsZXItPm5lZWRfcmVzY2hlZHVsZSA9IHRydWU7Cj4g
PiAgIAkvKiBzdGlsbCBoYXZlIHVuY29tcGxldGVkIHdvcmtsb2FkPyAqLwo+ID4gLQlmb3JfZWFj
aF9lbmdpbmUoZW5naW5lLCBndnQtPmRldl9wcml2LCBpKSB7Cj4gPiArCWZvcl9lYWNoX2VuZ2lu
ZShlbmdpbmUsIGd2dC0+aTkxNSwgaSkgewo+ID4gICAJCWlmIChzY2hlZHVsZXItPmN1cnJlbnRf
d29ya2xvYWRbaV0pCj4gPiAgIAkJCXJldHVybjsKPiA+ICAgCX0KPiA+IEBAIC0xNjksNyArMTY5
LDcgQEAgc3RhdGljIHZvaWQgdHJ5X3RvX3NjaGVkdWxlX25leHRfdmdwdShzdHJ1Y3QgaW50ZWxf
Z3Z0ICpndnQpCj4gPiAgIAlzY2hlZHVsZXItPm5lZWRfcmVzY2hlZHVsZSA9IGZhbHNlOwo+ID4g
ICAJLyogd2FrZSB1cCB3b3JrbG9hZCBkaXNwYXRjaCB0aHJlYWQgKi8KPiA+IC0JZm9yX2VhY2hf
ZW5naW5lKGVuZ2luZSwgZ3Z0LT5kZXZfcHJpdiwgaSkKPiA+ICsJZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgZ3Z0LT5pOTE1LCBpKQo+ID4gICAJCXdha2VfdXAoJnNjaGVkdWxlci0+d2FpdHFbaV0p
Owo+ID4gICB9Cj4gPiBAQCAtNDQ2LDcgKzQ0Niw3IEBAIHZvaWQgaW50ZWxfdmdwdV9zdG9wX3Nj
aGVkdWxlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQo+ID4gICAJCSZ2Z3B1LT5ndnQtPnNjaGVk
dWxlcjsKPiA+ICAgCWludCByaW5nX2lkOwo+ID4gICAJc3RydWN0IHZncHVfc2NoZWRfZGF0YSAq
dmdwdV9kYXRhID0gdmdwdS0+c2NoZWRfZGF0YTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB2Z3B1LT5ndnQtPmk5MTU7Cj4gPiAgIAlpZiAoIXZncHVfZGF0YS0+
YWN0aXZlKQo+ID4gICAJCXJldHVybjsKPiA+IEBAIC00NjUsNyArNDY1LDcgQEAgdm9pZCBpbnRl
bF92Z3B1X3N0b3Bfc2NoZWR1bGUoc3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4gPiAgIAkJc2No
ZWR1bGVyLT5jdXJyZW50X3ZncHUgPSBOVUxMOwo+ID4gICAJfQo+ID4gLQlpbnRlbF9ydW50aW1l
X3BtX2dldChkZXZfcHJpdik7Cj4gPiArCWludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ID4g
ICAJc3Bpbl9sb2NrX2JoKCZzY2hlZHVsZXItPm1taW9fY29udGV4dF9sb2NrKTsKPiA+ICAgCWZv
ciAocmluZ19pZCA9IDA7IHJpbmdfaWQgPCBJOTE1X05VTV9FTkdJTkVTOyByaW5nX2lkKyspIHsK
PiA+ICAgCQlpZiAoc2NoZWR1bGVyLT5lbmdpbmVfb3duZXJbcmluZ19pZF0gPT0gdmdwdSkgewo+
ID4gQEAgLTQ3NCw2ICs0NzQsNiBAQCB2b2lkIGludGVsX3ZncHVfc3RvcF9zY2hlZHVsZShzdHJ1
Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiA+ICAgCQl9Cj4gPiAgIAl9Cj4gPiAgIAlzcGluX3VubG9j
a19iaCgmc2NoZWR1bGVyLT5tbWlvX2NvbnRleHRfbG9jayk7Cj4gPiAtCWludGVsX3J1bnRpbWVf
cG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7Cj4gPiArCWludGVsX3J1bnRpbWVfcG1fcHV0X3Vu
Y2hlY2tlZChpOTE1KTsKPiA+ICAgCW11dGV4X3VubG9jaygmdmdwdS0+Z3Z0LT5zY2hlZF9sb2Nr
KTsKPiA+ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hl
ZHVsZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYwo+ID4gaW5kZXgg
ZTMwMWVmYjE4ZDQ1Li5lYzcyOTlkOGE3MzggMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2
dC9zY2hlZHVsZXIuYwo+ID4gQEAgLTgzLDkgKzgzLDkgQEAgc3RhdGljIHZvaWQgdXBkYXRlX3No
YWRvd19wZHBzKHN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCkKPiA+ICAgc3Rh
dGljIHZvaWQgc3Jfb2FfcmVncyhzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQs
Cj4gPiAgIAkJdTMyICpyZWdfc3RhdGUsIGJvb2wgc2F2ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB3b3JrbG9hZC0+dmdwdS0+Z3Z0LT5kZXZfcHJp
djsKPiA+IC0JdTMyIGN0eF9vYWN0eGN0cmwgPSBkZXZfcHJpdi0+cGVyZi5vYS5jdHhfb2FjdHhj
dHJsX29mZnNldDsKPiA+IC0JdTMyIGN0eF9mbGV4ZXUwID0gZGV2X3ByaXYtPnBlcmYub2EuY3R4
X2ZsZXhldTBfb2Zmc2V0Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHdv
cmtsb2FkLT52Z3B1LT5ndnQtPmk5MTU7Cj4gPiArCXUzMiBjdHhfb2FjdHhjdHJsID0gaTkxNS0+
cGVyZi5vYS5jdHhfb2FjdHhjdHJsX29mZnNldDsKPiA+ICsJdTMyIGN0eF9mbGV4ZXUwID0gaTkx
NS0+cGVyZi5vYS5jdHhfZmxleGV1MF9vZmZzZXQ7Cj4gPiAgIAlpbnQgaSA9IDA7Cj4gPiAgIAl1
MzIgZmxleF9tbWlvW10gPSB7Cj4gPiAgIAkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoRVVfUEVSRl9D
TlRMMCksCj4gPiBAQCAtMTc3LDExICsxNzcsMTEgQEAgc3RhdGljIGludCBwb3B1bGF0ZV9zaGFk
b3dfY29udGV4dChzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCj4gPiAgIAln
dnRfZGJnX3NjaGVkKCJyaW5nIGlkICVkIHdvcmtsb2FkIGxyY2EgJXgiLCByaW5nX2lkLAo+ID4g
ICAJCQl3b3JrbG9hZC0+Y3R4X2Rlc2MubHJjYSk7Cj4gPiAtCWNvbnRleHRfcGFnZV9udW0gPSBn
dnQtPmRldl9wcml2LT5lbmdpbmVbcmluZ19pZF0tPmNvbnRleHRfc2l6ZTsKPiA+ICsJY29udGV4
dF9wYWdlX251bSA9IGd2dC0+aTkxNS0+ZW5naW5lW3JpbmdfaWRdLT5jb250ZXh0X3NpemU7Cj4g
PiAgIAljb250ZXh0X3BhZ2VfbnVtID0gY29udGV4dF9wYWdlX251bSA+PiBQQUdFX1NISUZUOwo+
ID4gLQlpZiAoSVNfQlJPQURXRUxMKGd2dC0+ZGV2X3ByaXYpICYmIHJpbmdfaWQgPT0gUkNTMCkK
PiA+ICsJaWYgKElTX0JST0FEV0VMTChndnQtPmk5MTUpICYmIHJpbmdfaWQgPT0gUkNTMCkKPiA+
ICAgCQljb250ZXh0X3BhZ2VfbnVtID0gMTk7Cj4gPiAgIAlpID0gMjsKPiA+IEBAIC0yMTEsOCAr
MjExLDggQEAgc3RhdGljIGlubGluZSBib29sIGlzX2d2dF9yZXF1ZXN0KHN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJlcSkKPiA+ICAgc3RhdGljIHZvaWQgc2F2ZV9yaW5nX2h3X3N0YXRlKHN0cnVjdCBp
bnRlbF92Z3B1ICp2Z3B1LCBpbnQgcmluZ19pZCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+ID4gLQl1MzIgcmlu
Z19iYXNlID0gZGV2X3ByaXYtPmVuZ2luZVtyaW5nX2lkXS0+bW1pb19iYXNlOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkxNTsKPiA+ICsJdTMyIHJp
bmdfYmFzZSA9IGk5MTUtPmVuZ2luZVtyaW5nX2lkXS0+bW1pb19iYXNlOwo+ID4gICAJaTkxNV9y
ZWdfdCByZWc7Cj4gPiAgIAlyZWcgPSBSSU5HX0lOU1RET05FKHJpbmdfYmFzZSk7Cj4gPiBAQCAt
MzkxLDEwICszOTEsMTAgQEAgaW50ZWxfZ3Z0X3dvcmtsb2FkX3JlcV9hbGxvYyhzdHJ1Y3QgaW50
ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF92
Z3B1ICp2Z3B1ID0gd29ya2xvYWQtPnZncHU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdV9zdWJt
aXNzaW9uICpzID0gJnZncHUtPnN1Ym1pc3Npb247Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ID4gICAJc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnE7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5kcm0uc3RydWN0
X211dGV4KTsKPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7Cj4gPiAgIAlpZiAod29ya2xvYWQtPnJlcSkKPiA+ICAgCQlyZXR1cm4gMDsKPiA+IEBAIC00
MjEsMTAgKzQyMSwxMCBAQCBpbnQgaW50ZWxfZ3Z0X3NjYW5fYW5kX3NoYWRvd193b3JrbG9hZChz
dHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCj4gPiAgIHsKPiA+ICAgCXN0cnVj
dCBpbnRlbF92Z3B1ICp2Z3B1ID0gd29ya2xvYWQtPnZncHU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxf
dmdwdV9zdWJtaXNzaW9uICpzID0gJnZncHUtPnN1Ym1pc3Npb247Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ID4gICAJaW50IHJl
dDsKPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgp
Owo+ID4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiA+
ICAgCWlmICh3b3JrbG9hZC0+c2hhZG93KQo+ID4gICAJCXJldHVybiAwOwo+ID4gQEAgLTU3Nyw3
ICs1NzcsNyBAQCBzdGF0aWMgaW50IHByZXBhcmVfc2hhZG93X3dhX2N0eChzdHJ1Y3QgaW50ZWxf
c2hhZG93X3dhX2N0eCAqd2FfY3R4KQo+ID4gICBzdGF0aWMgdm9pZCByZWxlYXNlX3NoYWRvd19i
YXRjaF9idWZmZXIoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkKQo+ID4gICB7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSA9IHdvcmtsb2FkLT52Z3B1Owo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkxNTsKPiA+
ICAgCXN0cnVjdCBpbnRlbF92Z3B1X3NoYWRvd19iYiAqYmIsICpwb3M7Cj4gPiAgIAlpZiAobGlz
dF9lbXB0eSgmd29ya2xvYWQtPnNoYWRvd19iYikpCj4gPiBAQCAtNTg2LDcgKzU4Niw3IEBAIHN0
YXRpYyB2b2lkIHJlbGVhc2Vfc2hhZG93X2JhdGNoX2J1ZmZlcihzdHJ1Y3QgaW50ZWxfdmdwdV93
b3JrbG9hZCAqd29ya2xvYWQpCj4gPiAgIAliYiA9IGxpc3RfZmlyc3RfZW50cnkoJndvcmtsb2Fk
LT5zaGFkb3dfYmIsCj4gPiAgIAkJCXN0cnVjdCBpbnRlbF92Z3B1X3NoYWRvd19iYiwgbGlzdCk7
Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJbXV0
ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAgIAlsaXN0X2Zvcl9lYWNoX2Vu
dHJ5X3NhZmUoYmIsIHBvcywgJndvcmtsb2FkLT5zaGFkb3dfYmIsIGxpc3QpIHsKPiA+ICAgCQlp
ZiAoYmItPm9iaikgewo+ID4gQEAgLTYwNiw3ICs2MDYsNyBAQCBzdGF0aWMgdm9pZCByZWxlYXNl
X3NoYWRvd19iYXRjaF9idWZmZXIoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2Fk
KQo+ID4gICAJCWtmcmVlKGJiKTsKPiA+ICAgCX0KPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJp
di0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGludCBwcmVwYXJlX3dvcmtsb2FkKHN0cnVj
dCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCkKPiA+IEBAIC02NzEsNyArNjcxLDcgQEAg
c3RhdGljIGludCBwcmVwYXJlX3dvcmtsb2FkKHN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3
b3JrbG9hZCkKPiA+ICAgc3RhdGljIGludCBkaXNwYXRjaF93b3JrbG9hZChzdHJ1Y3QgaW50ZWxf
dmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF92Z3B1
ICp2Z3B1ID0gd29ya2xvYWQtPnZncHU7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdmdwdS0+Z3Z0LT5pOTE1Owo+ID4gICAJc3RydWN0IGludGVsX3ZncHVfc3Vi
bWlzc2lvbiAqcyA9ICZ2Z3B1LT5zdWJtaXNzaW9uOwo+ID4gICAJc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnE7Cj4gPiAgIAlpbnQgcmluZ19pZCA9IHdvcmtsb2FkLT5yaW5nX2lkOwo+ID4gQEAgLTY4
MSw3ICs2ODEsNyBAQCBzdGF0aWMgaW50IGRpc3BhdGNoX3dvcmtsb2FkKHN0cnVjdCBpbnRlbF92
Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCkKPiA+ICAgCQlyaW5nX2lkLCB3b3JrbG9hZCk7Cj4gPiAg
IAltdXRleF9sb2NrKCZ2Z3B1LT52Z3B1X2xvY2spOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJp
di0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwo+ID4gICAJcmV0ID0gc2V0X2NvbnRleHRfcHBndHRfZnJvbV9zaGFkb3cod29ya2xv
YWQsCj4gPiAgIAkJCQkJICAgIHMtPnNoYWRvd1tyaW5nX2lkXS0+Z2VtX2NvbnRleHQpOwo+ID4g
QEAgLTcyMyw3ICs3MjMsNyBAQCBzdGF0aWMgaW50IGRpc3BhdGNoX3dvcmtsb2FkKHN0cnVjdCBp
bnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCkKPiA+ICAgZXJyX3JlcToKPiA+ICAgCWlmIChy
ZXQpCj4gPiAgIAkJd29ya2xvYWQtPnN0YXR1cyA9IHJldDsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZk
ZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7Cj4gPiAgIAltdXRleF91bmxvY2soJnZncHUtPnZncHVfbG9jayk7Cj4g
PiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtNzk2LDcgKzc5Niw3IEBAIHN0YXRpYyB2
b2lkIHVwZGF0ZV9ndWVzdF9jb250ZXh0KHN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3Jr
bG9hZCkKPiA+ICAgCXZvaWQgKnNyYzsKPiA+ICAgCXVuc2lnbmVkIGxvbmcgY29udGV4dF9ncGEs
IGNvbnRleHRfcGFnZV9udW07Cj4gPiAgIAlpbnQgaTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gZ3Z0LT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBndnQtPmk5MTU7Cj4gPiAgIAl1MzIgcmluZ19iYXNlOwo+ID4gICAJdTMy
IGhlYWQsIHRhaWw7Cj4gPiAgIAl1MTYgd3JhcF9jb3VudDsKPiA+IEBAIC04MTcsMTQgKzgxNywx
NCBAQCBzdGF0aWMgdm9pZCB1cGRhdGVfZ3Vlc3RfY29udGV4dChzdHJ1Y3QgaW50ZWxfdmdwdV93
b3JrbG9hZCAqd29ya2xvYWQpCj4gPiAgIAloZWFkID0gKHdyYXBfY291bnQgPDwgUkJfSEVBRF9X
UkFQX0NOVF9PRkYpIHwgdGFpbDsKPiA+IC0JcmluZ19iYXNlID0gZGV2X3ByaXYtPmVuZ2luZVt3
b3JrbG9hZC0+cmluZ19pZF0tPm1taW9fYmFzZTsKPiA+ICsJcmluZ19iYXNlID0gaTkxNS0+ZW5n
aW5lW3dvcmtsb2FkLT5yaW5nX2lkXS0+bW1pb19iYXNlOwo+ID4gICAJdmdwdV92cmVnX3Qodmdw
dSwgUklOR19UQUlMKHJpbmdfYmFzZSkpID0gdGFpbDsKPiA+ICAgCXZncHVfdnJlZ190KHZncHUs
IFJJTkdfSEVBRChyaW5nX2Jhc2UpKSA9IGhlYWQ7Cj4gPiAgIAljb250ZXh0X3BhZ2VfbnVtID0g
cnEtPmVuZ2luZS0+Y29udGV4dF9zaXplOwo+ID4gICAJY29udGV4dF9wYWdlX251bSA9IGNvbnRl
eHRfcGFnZV9udW0gPj4gUEFHRV9TSElGVDsKPiA+IC0JaWYgKElTX0JST0FEV0VMTChndnQtPmRl
dl9wcml2KSAmJiBycS0+ZW5naW5lLT5pZCA9PSBSQ1MwKQo+ID4gKwlpZiAoSVNfQlJPQURXRUxM
KGd2dC0+aTkxNSkgJiYgcnEtPmVuZ2luZS0+aWQgPT0gUkNTMCkKPiA+ICAgCQljb250ZXh0X3Bh
Z2VfbnVtID0gMTk7Cj4gPiAgIAlpID0gMjsKPiA+IEBAIC04NzUsMTMgKzg3NSwxMyBAQCB2b2lk
IGludGVsX3ZncHVfY2xlYW5fd29ya2xvYWRzKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LAo+ID4g
ICAJCQkJaW50ZWxfZW5naW5lX21hc2tfdCBlbmdpbmVfbWFzaykKPiA+ICAgewo+ID4gICAJc3Ry
dWN0IGludGVsX3ZncHVfc3VibWlzc2lvbiAqcyA9ICZ2Z3B1LT5zdWJtaXNzaW9uOwo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5ndnQtPmRldl9wcml2Owo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUtPmd2dC0+aTkxNTsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiA+ICAgCXN0cnVjdCBpbnRlbF92
Z3B1X3dvcmtsb2FkICpwb3MsICpuOwo+ID4gICAJaW50ZWxfZW5naW5lX21hc2tfdCB0bXA7Cj4g
PiAgIAkvKiBmcmVlIHRoZSB1bnN1Ym1pdGVkIHdvcmtsb2FkcyBpbiB0aGUgcXVldWVzLiAqLwo+
ID4gLQlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgZGV2X3ByaXYsIGVuZ2luZV9tYXNr
LCB0bXApIHsKPiA+ICsJZm9yX2VhY2hfZW5naW5lX21hc2tlZChlbmdpbmUsIGk5MTUsIGVuZ2lu
ZV9tYXNrLCB0bXApIHsKPiA+ICAgCQlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUocG9zLCBuLAo+
ID4gICAJCQkmcy0+d29ya2xvYWRfcV9oZWFkW2VuZ2luZS0+aWRdLCBsaXN0KSB7Cj4gPiAgIAkJ
CWxpc3RfZGVsX2luaXQoJnBvcy0+bGlzdCk7Cj4gPiBAQCAtOTg2LDcgKzk4Niw3IEBAIHN0YXRp
YyBpbnQgd29ya2xvYWRfdGhyZWFkKHZvaWQgKnByaXYpCj4gPiAgIAlzdHJ1Y3QgaW50ZWxfdmdw
dV93b3JrbG9hZCAqd29ya2xvYWQgPSBOVUxMOwo+ID4gICAJc3RydWN0IGludGVsX3ZncHUgKnZn
cHUgPSBOVUxMOwo+ID4gICAJaW50IHJldDsKPiA+IC0JYm9vbCBuZWVkX2ZvcmNlX3dha2UgPSAo
SU5URUxfR0VOKGd2dC0+ZGV2X3ByaXYpID49IDkpOwo+ID4gKwlib29sIG5lZWRfZm9yY2Vfd2Fr
ZSA9IChJTlRFTF9HRU4oZ3Z0LT5pOTE1KSA+PSA5KTsKPiA+ICAgCURFRklORV9XQUlUX0ZVTkMo
d2FpdCwgd29rZW5fd2FrZV9mdW5jdGlvbik7Cj4gPiAgIAlrZnJlZShwKTsKPiA+IEBAIC0xMDE1
LDcgKzEwMTUsNyBAQCBzdGF0aWMgaW50IHdvcmtsb2FkX3RocmVhZCh2b2lkICpwcml2KQo+ID4g
ICAJCQkJd29ya2xvYWQtPnJpbmdfaWQsIHdvcmtsb2FkKTsKPiA+ICAgCQlpZiAobmVlZF9mb3Jj
ZV93YWtlKQo+ID4gLQkJCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZndnQtPmRldl9wcml2
LT51bmNvcmUsCj4gPiArCQkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmd2dC0+aTkxNS0+
dW5jb3JlLAo+ID4gICAJCQkJCUZPUkNFV0FLRV9BTEwpOwo+ID4gICAJCXJldCA9IGRpc3BhdGNo
X3dvcmtsb2FkKHdvcmtsb2FkKTsKPiA+IEBAIC0xMDM3LDcgKzEwMzcsNyBAQCBzdGF0aWMgaW50
IHdvcmtsb2FkX3RocmVhZCh2b2lkICpwcml2KQo+ID4gICAJCWNvbXBsZXRlX2N1cnJlbnRfd29y
a2xvYWQoZ3Z0LCByaW5nX2lkKTsKPiA+ICAgCQlpZiAobmVlZF9mb3JjZV93YWtlKQo+ID4gLQkJ
CWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZndnQtPmRldl9wcml2LT51bmNvcmUsCj4gPiAr
CQkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmd2dC0+aTkxNS0+dW5jb3JlLAo+ID4gICAJ
CQkJCUZPUkNFV0FLRV9BTEwpOwo+ID4gICAJCWlmIChyZXQgJiYgKHZncHVfaXNfdm1fdW5oZWFs
dGh5KHJldCkpKQo+ID4gQEAgLTEwNjgsNyArMTA2OCw3IEBAIHZvaWQgaW50ZWxfZ3Z0X2NsZWFu
X3dvcmtsb2FkX3NjaGVkdWxlcihzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQpCj4gPiAgIAlndnRfZGJn
X2NvcmUoImNsZWFuIHdvcmtsb2FkIHNjaGVkdWxlclxuIik7Cj4gPiAtCWZvcl9lYWNoX2VuZ2lu
ZShlbmdpbmUsIGd2dC0+ZGV2X3ByaXYsIGkpIHsKPiA+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgZ3Z0LT5pOTE1LCBpKSB7Cj4gPiAgIAkJYXRvbWljX25vdGlmaWVyX2NoYWluX3VucmVnaXN0
ZXIoCj4gPiAgIAkJCQkJJmVuZ2luZS0+Y29udGV4dF9zdGF0dXNfbm90aWZpZXIsCj4gPiAgIAkJ
CQkJJmd2dC0+c2hhZG93X2N0eF9ub3RpZmllcl9ibG9ja1tpXSk7Cj4gPiBAQCAtMTA4OCw3ICsx
MDg4LDcgQEAgaW50IGludGVsX2d2dF9pbml0X3dvcmtsb2FkX3NjaGVkdWxlcihzdHJ1Y3QgaW50
ZWxfZ3Z0ICpndnQpCj4gPiAgIAlpbml0X3dhaXRxdWV1ZV9oZWFkKCZzY2hlZHVsZXItPndvcmts
b2FkX2NvbXBsZXRlX3dxKTsKPiA+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3Z0LT5kZXZf
cHJpdiwgaSkgewo+ID4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndnQtPmk5MTUsIGkpIHsK
PiA+ICAgCQlpbml0X3dhaXRxdWV1ZV9oZWFkKCZzY2hlZHVsZXItPndhaXRxW2ldKTsKPiA+ICAg
CQlwYXJhbSA9IGt6YWxsb2Moc2l6ZW9mKCpwYXJhbSksIEdGUF9LRVJORUwpOwo+ID4gQEAgLTEx
NTIsNyArMTE1Miw3IEBAIHZvaWQgaW50ZWxfdmdwdV9jbGVhbl9zdWJtaXNzaW9uKHN0cnVjdCBp
bnRlbF92Z3B1ICp2Z3B1KQo+ID4gICAJaW50ZWxfdmdwdV9zZWxlY3Rfc3VibWlzc2lvbl9vcHMo
dmdwdSwgQUxMX0VOR0lORVMsIDApOwo+ID4gICAJaTkxNV9jb250ZXh0X3BwZ3R0X3Jvb3RfcmVz
dG9yZShzLCBpOTE1X3ZtX3RvX3BwZ3R0KHMtPnNoYWRvd1swXS0+Z2VtX2NvbnRleHQtPnZtKSk7
Cj4gPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIHZncHUtPmd2dC0+ZGV2X3ByaXYsIGlkKQo+
ID4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCB2Z3B1LT5ndnQtPmk5MTUsIGlkKQo+ID4gICAJ
CWludGVsX2NvbnRleHRfdW5waW4ocy0+c2hhZG93W2lkXSk7Cj4gPiAgIAlrbWVtX2NhY2hlX2Rl
c3Ryb3kocy0+d29ya2xvYWRzKTsKPiA+IEBAIC0xMjEyLDEzICsxMjEyLDEzIEBAIGludCBpbnRl
bF92Z3B1X3NldHVwX3N1Ym1pc3Npb24oc3RydWN0IGludGVsX3ZncHUgKnZncHUpCj4gPiAgIAll
bnVtIGludGVsX2VuZ2luZV9pZCBpOwo+ID4gICAJaW50IHJldDsKPiA+IC0JY3R4ID0gaTkxNV9n
ZW1fY29udGV4dF9jcmVhdGVfZ3Z0KCZ2Z3B1LT5ndnQtPmRldl9wcml2LT5kcm0pOwo+ID4gKwlj
dHggPSBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9ndnQoJnZncHUtPmd2dC0+aTkxNS0+ZHJtKTsK
PiA+ICAgCWlmIChJU19FUlIoY3R4KSkKPiA+ICAgCQlyZXR1cm4gUFRSX0VSUihjdHgpOwo+ID4g
ICAJaTkxNV9jb250ZXh0X3BwZ3R0X3Jvb3Rfc2F2ZShzLCBpOTE1X3ZtX3RvX3BwZ3R0KGN0eC0+
dm0pKTsKPiA+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgdmdwdS0+Z3Z0LT5kZXZfcHJpdiwg
aSkgewo+ID4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCB2Z3B1LT5ndnQtPmk5MTUsIGkpIHsK
PiA+ICAgCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Cj4gPiAgIAkJSU5JVF9MSVNUX0hFQUQo
JnMtPndvcmtsb2FkX3FfaGVhZFtpXSk7Cj4gPiBAQCAtMTI2MCw3ICsxMjYwLDcgQEAgaW50IGlu
dGVsX3ZncHVfc2V0dXBfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKPiA+ICAg
b3V0X3NoYWRvd19jdHg6Cj4gPiAgIAlpOTE1X2NvbnRleHRfcHBndHRfcm9vdF9yZXN0b3JlKHMs
IGk5MTVfdm1fdG9fcHBndHQoY3R4LT52bSkpOwo+ID4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5l
LCB2Z3B1LT5ndnQtPmRldl9wcml2LCBpKSB7Cj4gPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUs
IHZncHUtPmd2dC0+aTkxNSwgaSkgewo+ID4gICAJCWlmIChJU19FUlIocy0+c2hhZG93W2ldKSkK
PiA+ICAgCQkJYnJlYWs7Cj4gPiBAQCAtMTQzOSw3ICsxNDM5LDcgQEAgaW50ZWxfdmdwdV9jcmVh
dGVfd29ya2xvYWQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGludCByaW5nX2lkLAo+ID4gICAJ
c3RydWN0IGxpc3RfaGVhZCAqcSA9IHdvcmtsb2FkX3FfaGVhZCh2Z3B1LCByaW5nX2lkKTsKPiA+
ICAgCXN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICpsYXN0X3dvcmtsb2FkID0gZ2V0X2xhc3Rf
d29ya2xvYWQocSk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQg
PSBOVUxMOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2Z3B1LT5n
dnQtPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZncHUt
Pmd2dC0+aTkxNTsKPiA+ICAgCXU2NCByaW5nX2NvbnRleHRfZ3BhOwo+ID4gICAJdTMyIGhlYWQs
IHRhaWwsIHN0YXJ0LCBjdGwsIGN0eF9jdGwsIHBlcl9jdHgsIGluZGlyZWN0X2N0eDsKPiA+ICAg
CXUzMiBndWVzdF9oZWFkOwo+ID4gQEAgLTE1MjYsMTEgKzE1MjYsMTEgQEAgaW50ZWxfdmdwdV9j
cmVhdGVfd29ya2xvYWQoc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGludCByaW5nX2lkLAo+ID4g
ICAJICogYXMgdGhlcmUgaXMgb25seSBvbmUgcHJlLWFsbG9jYXRlZCBidWYtb2JqIGZvciBzaGFk
b3cuCj4gPiAgIAkgKi8KPiA+ICAgCWlmIChsaXN0X2VtcHR5KHdvcmtsb2FkX3FfaGVhZCh2Z3B1
LCByaW5nX2lkKSkpIHsKPiA+IC0JCWludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKPiA+
IC0JCW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJCWludGVs
X3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ID4gKwkJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7Cj4gPiAgIAkJcmV0ID0gaW50ZWxfZ3Z0X3NjYW5fYW5kX3NoYWRvd193b3JrbG9h
ZCh3b3JrbG9hZCk7Cj4gPiAtCQltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211
dGV4KTsKPiA+IC0JCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7Cj4g
PiArCQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwkJaW50ZWxf
cnVudGltZV9wbV9wdXRfdW5jaGVja2VkKGk5MTUpOwo+ID4gICAJfQo+ID4gICAJaWYgKHJldCkg
ewo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC92Z3B1LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvdmdwdS5jCj4gPiBpbmRleCA0NGNlM2MyYjlhYzEuLmEzMTE3
MzdjOTYzMyAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC92Z3B1LmMK
PiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC92Z3B1LmMKPiA+IEBAIC0xNDgsMTAg
KzE0OCwxMCBAQCBpbnQgaW50ZWxfZ3Z0X2luaXRfdmdwdV90eXBlcyhzdHJ1Y3QgaW50ZWxfZ3Z0
ICpndnQpCj4gPiAgIAkJZ3Z0LT50eXBlc1tpXS5hdmFpbF9pbnN0YW5jZSA9IG1pbihsb3dfYXZh
aWwgLyB2Z3B1X3R5cGVzW2ldLmxvd19tbSwKPiA+ICAgCQkJCQkJICAgaGlnaF9hdmFpbCAvIHZn
cHVfdHlwZXNbaV0uaGlnaF9tbSk7Cj4gPiAtCQlpZiAoSVNfR0VOKGd2dC0+ZGV2X3ByaXYsIDgp
KQo+ID4gKwkJaWYgKElTX0dFTihndnQtPmk5MTUsIDgpKQo+ID4gICAJCQlzcHJpbnRmKGd2dC0+
dHlwZXNbaV0ubmFtZSwgIkdWVGdfVjRfJXMiLAo+ID4gICAJCQkJCQl2Z3B1X3R5cGVzW2ldLm5h
bWUpOwo+ID4gLQkJZWxzZSBpZiAoSVNfR0VOKGd2dC0+ZGV2X3ByaXYsIDkpKQo+ID4gKwkJZWxz
ZSBpZiAoSVNfR0VOKGd2dC0+aTkxNSwgOSkpCj4gPiAgIAkJCXNwcmludGYoZ3Z0LT50eXBlc1tp
XS5uYW1lLCAiR1ZUZ19WNV8lcyIsCj4gPiAgIAkJCQkJCXZncHVfdHlwZXNbaV0ubmFtZSk7Cj4g
PiBAQCAtNDI5LDcgKzQyOSw3IEBAIHN0YXRpYyBzdHJ1Y3QgaW50ZWxfdmdwdSAqX19pbnRlbF9n
dnRfY3JlYXRlX3ZncHUoc3RydWN0IGludGVsX2d2dCAqZ3Z0LAo+ID4gICAJCWdvdG8gb3V0X2Ns
ZWFuX3NjaGVkX3BvbGljeTsKPiA+ICAgCS8qVE9ETzogYWRkIG1vcmUgcGxhdGZvcm1zIHN1cHBv
cnQgKi8KPiA+IC0JaWYgKElTX1NLWUxBS0UoZ3Z0LT5kZXZfcHJpdikgfHwgSVNfS0FCWUxBS0Uo
Z3Z0LT5kZXZfcHJpdikpCj4gPiArCWlmIChJU19TS1lMQUtFKGd2dC0+aTkxNSkgfHwgSVNfS0FC
WUxBS0UoZ3Z0LT5pOTE1KSkKPiA+ICAgCQlyZXQgPSBpbnRlbF9ndnRfaHlwZXJ2aXNvcl9zZXRf
ZWRpZCh2Z3B1LCBQT1JUX0QpOwo+ID4gICAJaWYgKHJldCkKPiA+ICAgCQlnb3RvIG91dF9jbGVh
bl9zY2hlZF9wb2xpY3k7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9jbWRfcGFyc2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2NtZF9wYXJzZXIuYwo+
ID4gaW5kZXggYTI4YmNkMmQ3YzA5Li5lOWQwNzYxNjdiMjQgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2NtZF9wYXJzZXIuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9jbWRfcGFyc2VyLmMKPiA+IEBAIC0xMzQyLDIxICsxMzQyLDIxIEBAIGlu
dCBpbnRlbF9lbmdpbmVfY21kX3BhcnNlcihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUs
Cj4gPiAgIC8qKgo+ID4gICAgKiBpOTE1X2NtZF9wYXJzZXJfZ2V0X3ZlcnNpb24oKSAtIGdldCB0
aGUgY21kIHBhcnNlciB2ZXJzaW9uIG51bWJlcgo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZp
Y2UgcHJpdmF0ZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBwcml2YXRlCj4gPiAgICAqCj4g
PiAgICAqIFRoZSBjbWQgcGFyc2VyIG1haW50YWlucyBhIHNpbXBsZSBpbmNyZWFzaW5nIGludGVn
ZXIgdmVyc2lvbiBudW1iZXIgc3VpdGFibGUKPiA+ICAgICogZm9yIHBhc3NpbmcgdG8gdXNlcnNw
YWNlIGNsaWVudHMgdG8gZGV0ZXJtaW5lIHdoYXQgb3BlcmF0aW9ucyBhcmUgcGVybWl0dGVkLgo+
ID4gICAgKgo+ID4gICAgKiBSZXR1cm46IHRoZSBjdXJyZW50IHZlcnNpb24gbnVtYmVyIG9mIHRo
ZSBjbWQgcGFyc2VyCj4gPiAgICAqLwo+ID4gLWludCBpOTE1X2NtZF9wYXJzZXJfZ2V0X3ZlcnNp
b24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludCBpOTE1X2NtZF9w
YXJzZXJfZ2V0X3ZlcnNpb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiA+ICAgCWVudW0gaW50ZWxf
ZW5naW5lX2lkIGlkOwo+ID4gICAJYm9vbCBhY3RpdmUgPSBmYWxzZTsKPiA+ICAgCS8qIElmIHRo
ZSBjb21tYW5kIHBhcnNlciBpcyBub3QgZW5hYmxlZCwgcmVwb3J0IDAgLSB1bnN1cHBvcnRlZCAq
Lwo+ID4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKPiA+ICsJZm9y
X2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKPiA+ICAgCQlpZiAoaW50ZWxfZW5naW5l
X25lZWRzX2NtZF9wYXJzZXIoZW5naW5lKSkgewo+ID4gICAJCQlhY3RpdmUgPSB0cnVlOwo+ID4g
ICAJCQlicmVhazsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rl
YnVnZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCj4gPiBpbmRleCAw
MjZmYjQ2MDIwZjYuLmZlYzAxODU4Njg1ZCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZGVidWdmcy5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2RlYnVnZnMuYwo+ID4gQEAgLTU1LDE3ICs1NSwxNyBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpub2RlX3RvX2k5MTUoc3RydWN0IGRybV9pbmZvX25vZGUgKm5vZGUp
Cj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9jYXBhYmlsaXRpZXMoc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICpkYXRhKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+IC0JY29uc3Qgc3RydWN0IGludGVsX2Rl
dmljZV9pbmZvICppbmZvID0gSU5URUxfSU5GTyhkZXZfcHJpdik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gKwljb25z
dCBzdHJ1Y3QgaW50ZWxfZGV2aWNlX2luZm8gKmluZm8gPSBJTlRFTF9JTkZPKGk5MTUpOwo+ID4g
ICAJc3RydWN0IGRybV9wcmludGVyIHAgPSBkcm1fc2VxX2ZpbGVfcHJpbnRlcihtKTsKPiA+IC0J
c2VxX3ByaW50ZihtLCAiZ2VuOiAlZFxuIiwgSU5URUxfR0VOKGRldl9wcml2KSk7Cj4gPiArCXNl
cV9wcmludGYobSwgImdlbjogJWRcbiIsIElOVEVMX0dFTihpOTE1KSk7Cj4gPiAgIAlzZXFfcHJp
bnRmKG0sICJwbGF0Zm9ybTogJXNcbiIsIGludGVsX3BsYXRmb3JtX25hbWUoaW5mby0+cGxhdGZv
cm0pKTsKPiA+IC0Jc2VxX3ByaW50ZihtLCAicGNoOiAlZFxuIiwgSU5URUxfUENIX1RZUEUoZGV2
X3ByaXYpKTsKPiA+ICsJc2VxX3ByaW50ZihtLCAicGNoOiAlZFxuIiwgSU5URUxfUENIX1RZUEUo
aTkxNSkpOwo+ID4gICAJaW50ZWxfZGV2aWNlX2luZm9fZHVtcF9mbGFncyhpbmZvLCAmcCk7Cj4g
PiAtCWludGVsX2RldmljZV9pbmZvX2R1bXBfcnVudGltZShSVU5USU1FX0lORk8oZGV2X3ByaXYp
LCAmcCk7Cj4gPiAtCWludGVsX2RyaXZlcl9jYXBzX3ByaW50KCZkZXZfcHJpdi0+Y2FwcywgJnAp
Owo+ID4gKwlpbnRlbF9kZXZpY2VfaW5mb19kdW1wX3J1bnRpbWUoUlVOVElNRV9JTkZPKGk5MTUp
LCAmcCk7Cj4gPiArCWludGVsX2RyaXZlcl9jYXBzX3ByaW50KCZpOTE1LT5jYXBzLCAmcCk7Cj4g
PiAgIAlrZXJuZWxfcGFyYW1fbG9jayhUSElTX01PRFVMRSk7Cj4gPiAgIAlpOTE1X3BhcmFtc19k
dW1wKCZpOTE1X21vZHBhcmFtcywgJnApOwo+ID4gQEAgLTEzNyw3ICsxMzcsNyBAQCBzdHJpbmdp
ZnlfcGFnZV9zaXplcyh1bnNpZ25lZCBpbnQgcGFnZV9zaXplcywgY2hhciAqYnVmLCBzaXplX3Qg
bGVuKQo+ID4gICBzdGF0aWMgdm9pZAo+ID4gICBkZXNjcmliZV9vYmooc3RydWN0IHNlcV9maWxl
ICptLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2
KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiA+ICAgCXN0cnVjdCBp
OTE1X3ZtYSAqdm1hOwo+ID4gICAJdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHM7Cj4gPiBA
QCAtMTU1LDcgKzE1NSw3IEBAIGRlc2NyaWJlX29iaihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gPiAgIAkJICAgb2JqLT5iYXNlLnNpemUgLyAx
MDI0LAo+ID4gICAJCSAgIG9iai0+cmVhZF9kb21haW5zLAo+ID4gICAJCSAgIG9iai0+d3JpdGVf
ZG9tYWluLAo+ID4gLQkJICAgaTkxNV9jYWNoZV9sZXZlbF9zdHIoZGV2X3ByaXYsIG9iai0+Y2Fj
aGVfbGV2ZWwpLAo+ID4gKwkJICAgaTkxNV9jYWNoZV9sZXZlbF9zdHIoaTkxNSwgb2JqLT5jYWNo
ZV9sZXZlbCksCj4gPiAgIAkJICAgb2JqLT5tbS5kaXJ0eSA/ICIgZGlydHkiIDogIiIsCj4gPiAg
IAkJICAgb2JqLT5tbS5tYWR2ID09IEk5MTVfTUFEVl9ET05UTkVFRCA/ICIgcHVyZ2VhYmxlIiA6
ICIiKTsKPiA+ICAgCWlmIChvYmotPmJhc2UubmFtZSkKPiA+IEBAIC0yOTYsNyArMjk2LDcgQEAg
c3RhdGljIGludCBwZXJfZmlsZV9zdGF0cyhpbnQgaWQsIHZvaWQgKnB0ciwgdm9pZCAqZGF0YSkK
PiA+ICAgfSB3aGlsZSAoMCkKPiA+ICAgc3RhdGljIHZvaWQgcHJpbnRfYmF0Y2hfcG9vbF9zdGF0
cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCj4gPiAtCQkJCSAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiA+ICsJCQkJICAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gPiBAQCAtMzA0LDcgKzMwNCw3IEBAIHN0YXRp
YyB2b2lkIHByaW50X2JhdGNoX3Bvb2xfc3RhdHMoc3RydWN0IHNlcV9maWxlICptLAo+ID4gICAJ
ZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Cj4gPiAgIAlpbnQgajsKPiA+IC0JZm9yX2VhY2hfZW5n
aW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKSB7Cj4gPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUs
IGk5MTUsIGlkKSB7Cj4gPiAgIAkJZm9yIChqID0gMDsgaiA8IEFSUkFZX1NJWkUoZW5naW5lLT5i
YXRjaF9wb29sLmNhY2hlX2xpc3QpOyBqKyspIHsKPiA+ICAgCQkJbGlzdF9mb3JfZWFjaF9lbnRy
eShvYmosCj4gPiAgIAkJCQkJICAgICZlbmdpbmUtPmJhdGNoX3Bvb2wuY2FjaGVfbGlzdFtqXSwK
PiA+IEBAIC0zODIsOCArMzgyLDggQEAgc3RhdGljIGludCBpOTE1X2dlbV9vYmplY3RfaW5mbyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9nZW1f
YmF0Y2hfcG9vbF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+
cHJpdmF0ZSk7Cj4gPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJp
dmF0ZSk7Cj4gPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ID4gICAJ
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZTsKPiA+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ID4gQEAgLTM5
NCw3ICszOTQsNyBAQCBzdGF0aWMgaW50IGk5MTVfZ2VtX2JhdGNoX3Bvb2xfaW5mbyhzdHJ1Y3Qg
c2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCXJldHVybiBy
ZXQ7Cj4gPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkgewo+ID4gKwlm
b3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewo+ID4gICAJCWZvciAoaiA9IDA7IGog
PCBBUlJBWV9TSVpFKGVuZ2luZS0+YmF0Y2hfcG9vbC5jYWNoZV9saXN0KTsgaisrKSB7Cj4gPiAg
IAkJCWludCBjb3VudDsKPiA+IEBAIC00MjcsMTUgKzQyNywxNSBAQCBzdGF0aWMgaW50IGk5MTVf
Z2VtX2JhdGNoX3Bvb2xfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAg
IHN0YXRpYyB2b2lkIGdlbjhfZGlzcGxheV9pbnRlcnJ1cHRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9k
ZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICAgCWludCBwaXBlOwo+ID4gLQlmb3Jf
ZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlw
ZSkgewo+ID4gICAJCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9tYWlu
Owo+ID4gICAJCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJCXBvd2VyX2RvbWFpbiA9
IFBPV0VSX0RPTUFJTl9QSVBFKHBpcGUpOwo+ID4gLQkJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlf
cG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsCj4gPiArCQl3YWtlcmVmID0gaW50ZWxfZGlz
cGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LAo+ID4gICAJCQkJCQkJICAgICBwb3dlcl9k
b21haW4pOwo+ID4gICAJCWlmICghd2FrZXJlZikgewo+ID4gICAJCQlzZXFfcHJpbnRmKG0sICJQ
aXBlICVjIHBvd2VyIGRpc2FibGVkXG4iLAo+ID4gQEAgLTQ1Miw3ICs0NTIsNyBAQCBzdGF0aWMg
dm9pZCBnZW44X2Rpc3BsYXlfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptKQo+ID4g
ICAJCQkgICBwaXBlX25hbWUocGlwZSksCj4gPiAgIAkJCSAgIEk5MTVfUkVBRChHRU44X0RFX1BJ
UEVfSUVSKHBpcGUpKSk7Cj4gPiAtCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwg
cG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiA+ICsJCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5
MTUsIHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiAgIAl9Cj4gPiAgIAlzZXFfcHJpbnRmKG0s
ICJEaXNwbGF5IEVuZ2luZSBwb3J0IGludGVycnVwdCBtYXNrOlx0JTA4eFxuIiwKPiA+IEBAIC00
NzksMTUgKzQ3OSwxNSBAQCBzdGF0aWMgdm9pZCBnZW44X2Rpc3BsYXlfaW50ZXJydXB0X2luZm8o
c3RydWN0IHNlcV9maWxlICptKQo+ID4gICBzdGF0aWMgaW50IGk5MTVfaW50ZXJydXB0X2luZm8o
c3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gPiAgIAllbnVtIGludGVs
X2VuZ2luZV9pZCBpZDsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJaW50
IGksIHBpcGU7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7
Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiA+IC0JaWYgKElT
X0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKSB7
Cj4gPiAgIAkJaW50ZWxfd2FrZXJlZl90IHByZWY7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiTWFz
dGVyIEludGVycnVwdCBDb250cm9sOlx0JTA4eFxuIiwKPiA+IEBAIC01MDEsMTEgKzUwMSwxMSBA
QCBzdGF0aWMgaW50IGk5MTVfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lk
ICpkYXRhKQo+ID4gICAJCQkgICBJOTE1X1JFQUQoVkxWX0lJUl9SVykpOwo+ID4gICAJCXNlcV9w
cmludGYobSwgIkRpc3BsYXkgSU1SOlx0JTA4eFxuIiwKPiA+ICAgCQkJICAgSTkxNV9SRUFEKFZM
Vl9JTVIpKTsKPiA+IC0JCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKPiA+ICsJCWZv
cl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ID4gICAJCQllbnVtIGludGVsX2Rpc3BsYXlfcG93
ZXJfZG9tYWluIHBvd2VyX2RvbWFpbjsKPiA+ICAgCQkJcG93ZXJfZG9tYWluID0gUE9XRVJfRE9N
QUlOX1BJUEUocGlwZSk7Cj4gPiAtCQkJcHJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lm
X2VuYWJsZWQoZGV2X3ByaXYsCj4gPiArCQkJcHJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0
X2lmX2VuYWJsZWQoaTkxNSwKPiA+ICAgCQkJCQkJCQkgIHBvd2VyX2RvbWFpbik7Cj4gPiAgIAkJ
CWlmICghcHJlZikgewo+ID4gICAJCQkJc2VxX3ByaW50ZihtLCAiUGlwZSAlYyBwb3dlciBkaXNh
YmxlZFxuIiwKPiA+IEBAIC01MTcsMTcgKzUxNywxNyBAQCBzdGF0aWMgaW50IGk5MTVfaW50ZXJy
dXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ID4gICAJCQkJICAgcGlw
ZV9uYW1lKHBpcGUpLAo+ID4gICAJCQkJICAgSTkxNV9SRUFEKFBJUEVTVEFUKHBpcGUpKSk7Cj4g
PiAtCQkJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbiwgcHJl
Zik7Cj4gPiArCQkJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgcG93ZXJfZG9tYWluLCBw
cmVmKTsKPiA+ICAgCQl9Cj4gPiAtCQlwcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2
X3ByaXYsIFBPV0VSX0RPTUFJTl9JTklUKTsKPiA+ICsJCXByZWYgPSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2dldChpOTE1LCBQT1dFUl9ET01BSU5fSU5JVCk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAi
UG9ydCBob3RwbHVnOlx0JTA4eFxuIiwKPiA+ICAgCQkJICAgSTkxNV9SRUFEKFBPUlRfSE9UUExV
R19FTikpOwo+ID4gICAJCXNlcV9wcmludGYobSwgIkRQRkxJUFNUQVQ6XHQlMDh4XG4iLAo+ID4g
ICAJCQkgICBJOTE1X1JFQUQoVkxWX0RQRkxJUFNUQVQpKTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0s
ICJEUElOVkdUVDpcdCUwOHhcbiIsCj4gPiAgIAkJCSAgIEk5MTVfUkVBRChEUElOVkdUVCkpOwo+
ID4gLQkJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9JTklU
LCBwcmVmKTsKPiA+ICsJCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIFBPV0VSX0RPTUFJ
Tl9JTklULCBwcmVmKTsKPiA+ICAgCQlmb3IgKGkgPSAwOyBpIDwgNDsgaSsrKSB7Cj4gPiAgIAkJ
CXNlcV9wcmludGYobSwgIkdUIEludGVycnVwdCBJTVIgJWQ6XHQlMDh4XG4iLAo+ID4gQEAgLTU0
NCw3ICs1NDQsNyBAQCBzdGF0aWMgaW50IGk5MTVfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICpkYXRhKQo+ID4gICAJCQkgICBJOTE1X1JFQUQoR0VOOF9QQ1VfSUlSKSk7
Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiUENVIGludGVycnVwdCBlbmFibGU6XHQlMDh4XG4iLAo+
ID4gICAJCQkgICBJOTE1X1JFQUQoR0VOOF9QQ1VfSUVSKSk7Cj4gPiAtCX0gZWxzZSBpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+ID4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1
KSA+PSAxMSkgewo+ID4gICAJCXNlcV9wcmludGYobSwgIk1hc3RlciBJbnRlcnJ1cHQgQ29udHJv
bDogICUwOHhcbiIsCj4gPiAgIAkJCSAgIEk5MTVfUkVBRChHRU4xMV9HRlhfTVNUUl9JUlEpKTsK
PiA+IEBAIC01NjUsNyArNTY1LDcgQEAgc3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0
cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgCQkJICAgSTkxNV9SRUFEKEdFTjEx
X0RJU1BMQVlfSU5UX0NUTCkpOwo+ID4gICAJCWdlbjhfZGlzcGxheV9pbnRlcnJ1cHRfaW5mbyht
KTsKPiA+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpIHsKPiA+ICsJfSBl
bHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkgewo+ID4gICAJCXNlcV9wcmludGYobSwgIk1h
c3RlciBJbnRlcnJ1cHQgQ29udHJvbDpcdCUwOHhcbiIsCj4gPiAgIAkJCSAgIEk5MTVfUkVBRChH
RU44X01BU1RFUl9JUlEpKTsKPiA+IEBAIC01NzksNyArNTc5LDcgQEAgc3RhdGljIGludCBpOTE1
X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgCQl9
Cj4gPiAgIAkJZ2VuOF9kaXNwbGF5X2ludGVycnVwdF9pbmZvKG0pOwo+ID4gLQl9IGVsc2UgaWYg
KElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklF
VyhpOTE1KSkgewo+ID4gICAJCXNlcV9wcmludGYobSwgIkRpc3BsYXkgSUVSOlx0JTA4eFxuIiwK
PiA+ICAgCQkJICAgSTkxNV9SRUFEKFZMVl9JRVIpKTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJE
aXNwbGF5IElJUjpcdCUwOHhcbiIsCj4gPiBAQCAtNTg4LDEyICs1ODgsMTIgQEAgc3RhdGljIGlu
dCBpOTE1X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+
ICAgCQkJICAgSTkxNV9SRUFEKFZMVl9JSVJfUlcpKTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJE
aXNwbGF5IElNUjpcdCUwOHhcbiIsCj4gPiAgIAkJCSAgIEk5MTVfUkVBRChWTFZfSU1SKSk7Cj4g
PiAtCQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gPiArCQlmb3JfZWFjaF9waXBl
KGk5MTUsIHBpcGUpIHsKPiA+ICAgCQkJZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBw
b3dlcl9kb21haW47Cj4gPiAgIAkJCWludGVsX3dha2VyZWZfdCBwcmVmOwo+ID4gICAJCQlwb3dl
cl9kb21haW4gPSBQT1dFUl9ET01BSU5fUElQRShwaXBlKTsKPiA+IC0JCQlwcmVmID0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwKPiA+ICsJCQlwcmVmID0gaW50
ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LAo+ID4gICAJCQkJCQkJCSAgcG93
ZXJfZG9tYWluKTsKPiA+ICAgCQkJaWYgKCFwcmVmKSB7Cj4gPiAgIAkJCQlzZXFfcHJpbnRmKG0s
ICJQaXBlICVjIHBvd2VyIGRpc2FibGVkXG4iLAo+ID4gQEAgLTYwNCw3ICs2MDQsNyBAQCBzdGF0
aWMgaW50IGk5MTVfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRh
KQo+ID4gICAJCQlzZXFfcHJpbnRmKG0sICJQaXBlICVjIHN0YXQ6XHQlMDh4XG4iLAo+ID4gICAJ
CQkJICAgcGlwZV9uYW1lKHBpcGUpLAo+ID4gICAJCQkJICAgSTkxNV9SRUFEKFBJUEVTVEFUKHBp
cGUpKSk7Cj4gPiAtCQkJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIHBvd2VyX2Rv
bWFpbiwgcHJlZik7Cj4gPiArCQkJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgcG93ZXJf
ZG9tYWluLCBwcmVmKTsKPiA+ICAgCQl9Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiTWFzdGVyIElF
UjpcdCUwOHhcbiIsCj4gPiBAQCAtNjMxLDE0ICs2MzEsMTQgQEAgc3RhdGljIGludCBpOTE1X2lu
dGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgCQlzZXFf
cHJpbnRmKG0sICJEUElOVkdUVDpcdCUwOHhcbiIsCj4gPiAgIAkJCSAgIEk5MTVfUkVBRChEUElO
VkdUVCkpOwo+ID4gLQl9IGVsc2UgaWYgKCFIQVNfUENIX1NQTElUKGRldl9wcml2KSkgewo+ID4g
Kwl9IGVsc2UgaWYgKCFIQVNfUENIX1NQTElUKGk5MTUpKSB7Cj4gPiAgIAkJc2VxX3ByaW50Ziht
LCAiSW50ZXJydXB0IGVuYWJsZTogICAgJTA4eFxuIiwKPiA+ICAgCQkJICAgSTkxNV9SRUFEKEdF
TjJfSUVSKSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiSW50ZXJydXB0IGlkZW50aXR5OiAgJTA4
eFxuIiwKPiA+ICAgCQkJICAgSTkxNV9SRUFEKEdFTjJfSUlSKSk7Cj4gPiAgIAkJc2VxX3ByaW50
ZihtLCAiSW50ZXJydXB0IG1hc2s6ICAgICAgJTA4eFxuIiwKPiA+ICAgCQkJICAgSTkxNV9SRUFE
KEdFTjJfSU1SKSk7Cj4gPiAtCQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKQo+ID4gKwkJ
Zm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+ID4gICAJCQlzZXFfcHJpbnRmKG0sICJQaXBlICVj
IHN0YXQ6ICAgICAgICAgJTA4eFxuIiwKPiA+ICAgCQkJCSAgIHBpcGVfbmFtZShwaXBlKSwKPiA+
ICAgCQkJCSAgIEk5MTVfUkVBRChQSVBFU1RBVChwaXBlKSkpOwo+ID4gQEAgLTY2Myw3ICs2NjMs
NyBAQCBzdGF0aWMgaW50IGk5MTVfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICpkYXRhKQo+ID4gICAJCQkgICBJOTE1X1JFQUQoR1RJTVIpKTsKPiA+ICAgCX0KPiA+IC0J
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSAxMSkgewo+ID4gICAJCXNlcV9wcmludGYobSwgIlJDUyBJbnRyIE1hc2s6XHQgJTA4eFxu
IiwKPiA+ICAgCQkJICAgSTkxNV9SRUFEKEdFTjExX1JDUzBfUlNWRF9JTlRSX01BU0spKTsKPiA+
ICAgCQlzZXFfcHJpbnRmKG0sICJCQ1MgSW50ciBNYXNrOlx0ICUwOHhcbiIsCj4gPiBAQCAtNjgz
LDM1ICs2ODMsMzUgQEAgc3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFf
ZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJHdW5pdC9DU01FIElu
dHIgTWFzazpcdCAlMDh4XG4iLAo+ID4gICAJCQkgICBJOTE1X1JFQUQoR0VOMTFfR1VOSVRfQ1NN
RV9JTlRSX01BU0spKTsKPiA+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYp
IHsKPiA+IC0JCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkgewo+ID4gKwl9
IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KSB7Cj4gPiArCQlmb3JfZWFjaF9lbmdpbmUo
ZW5naW5lLCBpOTE1LCBpZCkgewo+ID4gICAJCQlzZXFfcHJpbnRmKG0sCj4gPiAgIAkJCQkgICAi
R3JhcGhpY3MgSW50ZXJydXB0IG1hc2sgKCVzKToJJTA4eFxuIiwKPiA+ICAgCQkJCSAgIGVuZ2lu
ZS0+bmFtZSwgRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX0lNUikpOwo+ID4gICAJCX0KPiA+ICAg
CX0KPiA+IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ID4gKwlp
bnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiA+ICAgCXJldHVybiAwOwo+ID4g
ICB9Cj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9nZW1fZmVuY2VfcmVnc19pbmZvKHN0cnVjdCBzZXFf
ZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiAtCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiArCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ID4gICAJaW50IGksIHJldDsKPiA+ICAgCXJldCA9IG11
dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZGV2LT5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICAJaWYgKHJl
dCkKPiA+ICAgCQlyZXR1cm4gcmV0Owo+ID4gLQlzZXFfcHJpbnRmKG0sICJUb3RhbCBmZW5jZXMg
PSAlZFxuIiwgZGV2X3ByaXYtPm51bV9mZW5jZV9yZWdzKTsKPiA+IC0JZm9yIChpID0gMDsgaSA8
IGRldl9wcml2LT5udW1fZmVuY2VfcmVnczsgaSsrKSB7Cj4gPiAtCQlzdHJ1Y3QgaTkxNV92bWEg
KnZtYSA9IGRldl9wcml2LT5mZW5jZV9yZWdzW2ldLnZtYTsKPiA+ICsJc2VxX3ByaW50ZihtLCAi
VG90YWwgZmVuY2VzID0gJWRcbiIsIGk5MTUtPm51bV9mZW5jZV9yZWdzKTsKPiA+ICsJZm9yIChp
ID0gMDsgaSA8IGk5MTUtPm51bV9mZW5jZV9yZWdzOyBpKyspIHsKPiA+ICsJCXN0cnVjdCBpOTE1
X3ZtYSAqdm1hID0gaTkxNS0+ZmVuY2VfcmVnc1tpXS52bWE7Cj4gPiAgIAkJc2VxX3ByaW50Ziht
LCAiRmVuY2UgJWQsIHBpbiBjb3VudCA9ICVkLCBvYmplY3QgPSAiLAo+ID4gLQkJCSAgIGksIGRl
dl9wcml2LT5mZW5jZV9yZWdzW2ldLnBpbl9jb3VudCk7Cj4gPiArCQkJICAgaSwgaTkxNS0+ZmVu
Y2VfcmVnc1tpXS5waW5fY291bnQpOwo+ID4gICAJCWlmICghdm1hKQo+ID4gICAJCQlzZXFfcHV0
cyhtLCAidW51c2VkIik7Cj4gPiAgIAkJZWxzZQo+ID4gQEAgLTgyNSwxNSArODI1LDE1IEBAIHN0
YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGk5MTVfZXJyb3Jfc3RhdGVfZm9wcyA9
IHsKPiA+ICAgc3RhdGljIGludCBpOTE1X2ZyZXF1ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqdW51c2VkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+IC0Jc3RydWN0IGludGVsX3Vu
Y29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gPiAtCXN0cnVjdCBpbnRlbF9ycHMg
KnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJc3RydWN0IGludGVsX3Vu
Y29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiA+ICsJc3RydWN0IGludGVsX3JwcyAqcnBz
ID0gJmk5MTUtPmd0X3BtLnJwczsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4g
ICAJaW50IHJldCA9IDA7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZf
cHJpdik7Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiA+IC0J
aWYgKElTX0dFTihkZXZfcHJpdiwgNSkpIHsKPiA+ICsJaWYgKElTX0dFTihpOTE1LCA1KSkgewo+
ID4gICAJCXUxNiByZ3Zzd2N0bCA9IGludGVsX3VuY29yZV9yZWFkMTYodW5jb3JlLCBNRU1TV0NU
TCk7Cj4gPiAgIAkJdTE2IHJndnN0YXQgPSBpbnRlbF91bmNvcmVfcmVhZDE2KHVuY29yZSwgTUVN
U1RBVF9JTEspOwo+ID4gQEAgLTg0Myw3ICs4NDMsNyBAQCBzdGF0aWMgaW50IGk5MTVfZnJlcXVl
bmN5X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gPiAgIAkJCSAgIE1F
TVNUQVRfVklEX1NISUZUKTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJDdXJyZW50IFAtc3RhdGU6
ICVkXG4iLAo+ID4gICAJCQkgICAocmd2c3RhdCAmIE1FTVNUQVRfUFNUQVRFX01BU0spID4+IE1F
TVNUQVRfUFNUQVRFX1NISUZUKTsKPiA+IC0JfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9w
cml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX1ZB
TExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ID4gICAJCXUzMiBycG1v
ZGVjdGwsIGZyZXFfc3RzOwo+ID4gICAJCXJwbW9kZWN0bCA9IEk5MTVfUkVBRChHRU42X1JQX0NP
TlRST0wpOwo+ID4gQEAgLTg1NSwzMiArODU1LDMyIEBAIHN0YXRpYyBpbnQgaTkxNV9mcmVxdWVu
Y3lfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiA+ICAgCQkJICAgeWVz
bm8oKHJwbW9kZWN0bCAmIEdFTjZfUlBfTUVESUFfTU9ERV9NQVNLKSA9PQo+ID4gICAJCQkJICBH
RU42X1JQX01FRElBX1NXX01PREUpKTsKPiA+IC0JCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOwo+
ID4gLQkJZnJlcV9zdHMgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX0dQVV9G
UkVRX1NUUyk7Cj4gPiAtCQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKPiA+ICsJCXZsdl9wdW5p
dF9nZXQoaTkxNSk7Cj4gPiArCQlmcmVxX3N0cyA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklU
X1JFR19HUFVfRlJFUV9TVFMpOwo+ID4gKwkJdmx2X3B1bml0X3B1dChpOTE1KTsKPiA+ICAgCQlz
ZXFfcHJpbnRmKG0sICJQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTOiAweCUwOHhcbiIsIGZyZXFfc3Rz
KTsKPiA+IC0JCXNlcV9wcmludGYobSwgIkREUiBmcmVxOiAlZCBNSHpcbiIsIGRldl9wcml2LT5t
ZW1fZnJlcSk7Cj4gPiArCQlzZXFfcHJpbnRmKG0sICJERFIgZnJlcTogJWQgTUh6XG4iLCBpOTE1
LT5tZW1fZnJlcSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiYWN0dWFsIEdQVSBmcmVxOiAlZCBN
SHpcbiIsCj4gPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIChmcmVxX3N0cyA+PiA4
KSAmIDB4ZmYpKTsKPiA+ICsJCQkgICBpbnRlbF9ncHVfZnJlcShpOTE1LCAoZnJlcV9zdHMgPj4g
OCkgJiAweGZmKSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiY3VycmVudCBHUFUgZnJlcTogJWQg
TUh6XG4iLAo+ID4gLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPmN1cl9mcmVx
KSk7Cj4gPiArCQkJICAgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBzLT5jdXJfZnJlcSkpOwo+ID4g
ICAJCXNlcV9wcmludGYobSwgIm1heCBHUFUgZnJlcTogJWQgTUh6XG4iLAo+ID4gLQkJCSAgIGlu
dGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPm1heF9mcmVxKSk7Cj4gPiArCQkJICAgaW50ZWxf
Z3B1X2ZyZXEoaTkxNSwgcnBzLT5tYXhfZnJlcSkpOwo+ID4gICAJCXNlcV9wcmludGYobSwgIm1p
biBHUFUgZnJlcTogJWQgTUh6XG4iLAo+ID4gLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2
LCBycHMtPm1pbl9mcmVxKSk7Cj4gPiArCQkJICAgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBzLT5t
aW5fZnJlcSkpOwo+ID4gICAJCXNlcV9wcmludGYobSwgImlkbGUgR1BVIGZyZXE6ICVkIE1Ielxu
IiwKPiA+IC0JCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5pZGxlX2ZyZXEpKTsK
PiA+ICsJCQkgICBpbnRlbF9ncHVfZnJlcShpOTE1LCBycHMtPmlkbGVfZnJlcSkpOwo+ID4gICAJ
CXNlcV9wcmludGYobSwKPiA+ICAgCQkJICAgImVmZmljaWVudCAoUlBlKSBmcmVxdWVuY3k6ICVk
IE1IelxuIiwKPiA+IC0JCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5lZmZpY2ll
bnRfZnJlcSkpOwo+ID4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikgewo+
ID4gKwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpKTsKPiA+
ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikgewo+ID4gICAJCXUzMiBycF9zdGF0
ZV9saW1pdHM7Cj4gPiAgIAkJdTMyIGd0X3BlcmZfc3RhdHVzOwo+ID4gICAJCXUzMiBycF9zdGF0
ZV9jYXA7Cj4gPiBAQCAtODkyLDcgKzg5Miw3IEBAIHN0YXRpYyBpbnQgaTkxNV9mcmVxdWVuY3lf
aW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiA+ICAgCQlpbnQgbWF4X2Zy
ZXE7Cj4gPiAgIAkJcnBfc3RhdGVfbGltaXRzID0gSTkxNV9SRUFEKEdFTjZfUlBfU1RBVEVfTElN
SVRTKTsKPiA+IC0JCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewo+ID4gKwkJaWYgKElTX0dF
TjlfTFAoaTkxNSkpIHsKPiA+ICAgCQkJcnBfc3RhdGVfY2FwID0gSTkxNV9SRUFEKEJYVF9SUF9T
VEFURV9DQVApOwo+ID4gICAJCQlndF9wZXJmX3N0YXR1cyA9IEk5MTVfUkVBRChCWFRfR1RfUEVS
Rl9TVEFUVVMpOwo+ID4gICAJCX0gZWxzZSB7Cj4gPiBAQCAtOTAxLDE5ICs5MDEsMTkgQEAgc3Rh
dGljIGludCBpOTE1X2ZyZXF1ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51
c2VkKQo+ID4gICAJCX0KPiA+ICAgCQkvKiBSUFNUQVQxIGlzIGluIHRoZSBHVCBwb3dlciB3ZWxs
ICovCj4gPiAtCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwg
Rk9SQ0VXQUtFX0FMTCk7Cj4gPiArCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+
dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICAgCQlyZXFmID0gSTkxNV9SRUFEKEdFTjZfUlBO
U1dSRVEpOwo+ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiA+ICsJCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gOSkKPiA+ICAgCQkJcmVxZiA+Pj0gMjM7Cj4gPiAgIAkJZWxzZSB7
Cj4gPiAgIAkJCXJlcWYgJj0gfkdFTjZfVFVSQk9fRElTQUJMRTsKPiA+IC0JCQlpZiAoSVNfSEFT
V0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiA+ICsJCQlpZiAoSVNf
SEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gPiAgIAkJCQlyZXFmID4+PSAy
NDsKPiA+ICAgCQkJZWxzZQo+ID4gICAJCQkJcmVxZiA+Pj0gMjU7Cj4gPiAgIAkJfQo+ID4gLQkJ
cmVxZiA9IGludGVsX2dwdV9mcmVxKGRldl9wcml2LCByZXFmKTsKPiA+ICsJCXJlcWYgPSBpbnRl
bF9ncHVfZnJlcShpOTE1LCByZXFmKTsKPiA+ICAgCQlycG1vZGVjdGwgPSBJOTE1X1JFQUQoR0VO
Nl9SUF9DT05UUk9MKTsKPiA+ICAgCQlycGluY2xpbWl0ID0gSTkxNV9SRUFEKEdFTjZfUlBfVVBf
VEhSRVNIT0xEKTsKPiA+IEBAIC05MjYsMTIgKzkyNiwxMiBAQCBzdGF0aWMgaW50IGk5MTVfZnJl
cXVlbmN5X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gPiAgIAkJcnBk
b3duZWkgPSBJOTE1X1JFQUQoR0VONl9SUF9DVVJfRE9XTl9FSSkgJiBHRU42X0NVUklBVkdfTUFT
SzsKPiA+ICAgCQlycGN1cmRvd24gPSBJOTE1X1JFQUQoR0VONl9SUF9DVVJfRE9XTikgJiBHRU42
X0NVUkJTWVRBVkdfTUFTSzsKPiA+ICAgCQlycHByZXZkb3duID0gSTkxNV9SRUFEKEdFTjZfUlBf
UFJFVl9ET1dOKSAmIEdFTjZfQ1VSQlNZVEFWR19NQVNLOwo+ID4gLQkJY2FnZiA9IGludGVsX2dw
dV9mcmVxKGRldl9wcml2LAo+ID4gLQkJCQkgICAgICBpbnRlbF9nZXRfY2FnZihkZXZfcHJpdiwg
cnBzdGF0KSk7Cj4gPiArCQljYWdmID0gaW50ZWxfZ3B1X2ZyZXEoaTkxNSwKPiA+ICsJCQkJICAg
ICAgaW50ZWxfZ2V0X2NhZ2YoaTkxNSwgcnBzdGF0KSk7Cj4gPiAtCQlpbnRlbF91bmNvcmVfZm9y
Y2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCQlpbnRl
bF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+
IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiArCQlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDExKSB7Cj4gPiAgIAkJCXBtX2llciA9IEk5MTVfUkVBRChHRU4xMV9HUE1fV0dC
T1hQRVJGX0lOVFJfRU5BQkxFKTsKPiA+ICAgCQkJcG1faW1yID0gSTkxNV9SRUFEKEdFTjExX0dQ
TV9XR0JPWFBFUkZfSU5UUl9NQVNLKTsKPiA+ICAgCQkJLyoKPiA+IEBAIC05NDAsNyArOTQwLDcg
QEAgc3RhdGljIGludCBpOTE1X2ZyZXF1ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9p
ZCAqdW51c2VkKQo+ID4gICAJCQkgKi8KPiA+ICAgCQkJcG1faXNyID0gMDsKPiA+ICAgCQkJcG1f
aWlyID0gMDsKPiA+IC0JCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KSB7Cj4g
PiArCQl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KSB7Cj4gPiAgIAkJCXBtX2llciA9
IEk5MTVfUkVBRChHRU44X0dUX0lFUigyKSk7Cj4gPiAgIAkJCXBtX2ltciA9IEk5MTVfUkVBRChH
RU44X0dUX0lNUigyKSk7Cj4gPiAgIAkJCXBtX2lzciA9IEk5MTVfUkVBRChHRU44X0dUX0lTUigy
KSk7Cj4gPiBAQCAtOTYzLDE0ICs5NjMsMTQgQEAgc3RhdGljIGludCBpOTE1X2ZyZXF1ZW5jeV9p
bmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ID4gICAJCXNlcV9wcmludGYo
bSwgIlBNIElFUj0weCUwOHggSU1SPTB4JTA4eCwgTUFTSz0weCUwOHhcbiIsCj4gPiAgIAkJCSAg
IHBtX2llciwgcG1faW1yLCBwbV9tYXNrKTsKPiA+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
IDw9IDEwKQo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8PSAxMCkKPiA+ICAgCQkJc2VxX3By
aW50ZihtLCAiUE0gSVNSPTB4JTA4eCBJSVI9MHglMDh4XG4iLAo+ID4gICAJCQkJICAgcG1faXNy
LCBwbV9paXIpOwo+ID4gICAJCXNlcV9wcmludGYobSwgInBtX2ludHJtc2tfbWJ6OiAweCUwOHhc
biIsCj4gPiAgIAkJCSAgIHJwcy0+cG1faW50cm1za19tYnopOwo+ID4gICAJCXNlcV9wcmludGYo
bSwgIkdUX1BFUkZfU1RBVFVTOiAweCUwOHhcbiIsIGd0X3BlcmZfc3RhdHVzKTsKPiA+ICAgCQlz
ZXFfcHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSByYXRpbzogJWRcbiIsCj4gPiAtCQkJICAgKGd0
X3BlcmZfc3RhdHVzICYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSA/IDB4MWZmMDAgOiAweGZm
MDApKSA+PiA4KTsKPiA+ICsJCQkgICAoZ3RfcGVyZl9zdGF0dXMgJiAoSU5URUxfR0VOKGk5MTUp
ID49IDkgPyAweDFmZjAwIDogMHhmZjAwKSkgPj4gOCk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAi
UmVuZGVyIHAtc3RhdGUgVklEOiAlZFxuIiwKPiA+ICAgCQkJICAgZ3RfcGVyZl9zdGF0dXMgJiAw
eGZmKTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSBsaW1pdDogJWRcbiIs
Cj4gPiBAQCAtOTgyLDcyICs5ODIsNzIgQEAgc3RhdGljIGludCBpOTE1X2ZyZXF1ZW5jeV9pbmZv
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ID4gICAJCXNlcV9wcmludGYobSwg
IlJQTlNXUkVROiAlZE1IelxuIiwgcmVxZik7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiQ0FHRjog
JWRNSHpcbiIsIGNhZ2YpOwo+ID4gICAJCXNlcV9wcmludGYobSwgIlJQIENVUiBVUCBFSTogJWQg
KCVkdXMpXG4iLAo+ID4gLQkJCSAgIHJwdXBlaSwgR1RfUE1fSU5URVJWQUxfVE9fVVMoZGV2X3By
aXYsIHJwdXBlaSkpOwo+ID4gKwkJCSAgIHJwdXBlaSwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkx
NSwgcnB1cGVpKSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiUlAgQ1VSIFVQOiAlZCAoJWR1cylc
biIsCj4gPiAtCQkJICAgcnBjdXJ1cCwgR1RfUE1fSU5URVJWQUxfVE9fVVMoZGV2X3ByaXYsIHJw
Y3VydXApKTsKPiA+ICsJCQkgICBycGN1cnVwLCBHVF9QTV9JTlRFUlZBTF9UT19VUyhpOTE1LCBy
cGN1cnVwKSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiUlAgUFJFViBVUDogJWQgKCVkdXMpXG4i
LAo+ID4gLQkJCSAgIHJwcHJldnVwLCBHVF9QTV9JTlRFUlZBTF9UT19VUyhkZXZfcHJpdiwgcnBw
cmV2dXApKTsKPiA+ICsJCQkgICBycHByZXZ1cCwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwg
cnBwcmV2dXApKTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJVcCB0aHJlc2hvbGQ6ICVkJSVcbiIs
Cj4gPiAgIAkJCSAgIHJwcy0+cG93ZXIudXBfdGhyZXNob2xkKTsKPiA+ICAgCQlzZXFfcHJpbnRm
KG0sICJSUCBDVVIgRE9XTiBFSTogJWQgKCVkdXMpXG4iLAo+ID4gLQkJCSAgIHJwZG93bmVpLCBH
VF9QTV9JTlRFUlZBTF9UT19VUyhkZXZfcHJpdiwgcnBkb3duZWkpKTsKPiA+ICsJCQkgICBycGRv
d25laSwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBkb3duZWkpKTsKPiA+ICAgCQlzZXFf
cHJpbnRmKG0sICJSUCBDVVIgRE9XTjogJWQgKCVkdXMpXG4iLAo+ID4gLQkJCSAgIHJwY3VyZG93
biwgR1RfUE1fSU5URVJWQUxfVE9fVVMoZGV2X3ByaXYsIHJwY3VyZG93bikpOwo+ID4gKwkJCSAg
IHJwY3VyZG93biwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBjdXJkb3duKSk7Cj4gPiAg
IAkJc2VxX3ByaW50ZihtLCAiUlAgUFJFViBET1dOOiAlZCAoJWR1cylcbiIsCj4gPiAtCQkJICAg
cnBwcmV2ZG93biwgR1RfUE1fSU5URVJWQUxfVE9fVVMoZGV2X3ByaXYsIHJwcHJldmRvd24pKTsK
PiA+ICsJCQkgICBycHByZXZkb3duLCBHVF9QTV9JTlRFUlZBTF9UT19VUyhpOTE1LCBycHByZXZk
b3duKSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiRG93biB0aHJlc2hvbGQ6ICVkJSVcbiIsCj4g
PiAgIAkJCSAgIHJwcy0+cG93ZXIuZG93bl90aHJlc2hvbGQpOwo+ID4gLQkJbWF4X2ZyZXEgPSAo
SVNfR0VOOV9MUChkZXZfcHJpdikgPyBycF9zdGF0ZV9jYXAgPj4gMCA6Cj4gPiArCQltYXhfZnJl
cSA9IChJU19HRU45X0xQKGk5MTUpID8gcnBfc3RhdGVfY2FwID4+IDAgOgo+ID4gICAJCQkgICAg
cnBfc3RhdGVfY2FwID4+IDE2KSAmIDB4ZmY7Cj4gPiAtCQltYXhfZnJlcSAqPSAoSVNfR0VOOV9C
QyhkZXZfcHJpdikgfHwKPiA+IC0JCQkgICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgPyBH
RU45X0ZSRVFfU0NBTEVSIDogMSk7Cj4gPiArCQltYXhfZnJlcSAqPSAoSVNfR0VOOV9CQyhpOTE1
KSB8fAo+ID4gKwkJCSAgICAgSU5URUxfR0VOKGk5MTUpID49IDEwID8gR0VOOV9GUkVRX1NDQUxF
UiA6IDEpOwo+ID4gICAJCXNlcV9wcmludGYobSwgIkxvd2VzdCAoUlBOKSBmcmVxdWVuY3k6ICVk
TUh6XG4iLAo+ID4gLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBtYXhfZnJlcSkpOwo+
ID4gKwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIG1heF9mcmVxKSk7Cj4gPiAgIAkJbWF4X2Zy
ZXEgPSAocnBfc3RhdGVfY2FwICYgMHhmZjAwKSA+PiA4Owo+ID4gLQkJbWF4X2ZyZXEgKj0gKElT
X0dFTjlfQkMoZGV2X3ByaXYpIHx8Cj4gPiAtCQkJICAgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDEwID8gR0VOOV9GUkVRX1NDQUxFUiA6IDEpOwo+ID4gKwkJbWF4X2ZyZXEgKj0gKElTX0dFTjlf
QkMoaTkxNSkgfHwKPiA+ICsJCQkgICAgIElOVEVMX0dFTihpOTE1KSA+PSAxMCA/IEdFTjlfRlJF
UV9TQ0FMRVIgOiAxKTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJOb21pbmFsIChSUDEpIGZyZXF1
ZW5jeTogJWRNSHpcbiIsCj4gPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIG1heF9m
cmVxKSk7Cj4gPiArCQkJICAgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgbWF4X2ZyZXEpKTsKPiA+IC0J
CW1heF9mcmVxID0gKElTX0dFTjlfTFAoZGV2X3ByaXYpID8gcnBfc3RhdGVfY2FwID4+IDE2IDoK
PiA+ICsJCW1heF9mcmVxID0gKElTX0dFTjlfTFAoaTkxNSkgPyBycF9zdGF0ZV9jYXAgPj4gMTYg
Ogo+ID4gICAJCQkgICAgcnBfc3RhdGVfY2FwID4+IDApICYgMHhmZjsKPiA+IC0JCW1heF9mcmVx
ICo9IChJU19HRU45X0JDKGRldl9wcml2KSB8fAo+ID4gLQkJCSAgICAgSU5URUxfR0VOKGRldl9w
cml2KSA+PSAxMCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKPiA+ICsJCW1heF9mcmVxICo9IChJ
U19HRU45X0JDKGk5MTUpIHx8Cj4gPiArCQkJICAgICBJTlRFTF9HRU4oaTkxNSkgPj0gMTAgPyBH
RU45X0ZSRVFfU0NBTEVSIDogMSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiTWF4IG5vbi1vdmVy
Y2xvY2tlZCAoUlAwKSBmcmVxdWVuY3k6ICVkTUh6XG4iLAo+ID4gLQkJCSAgIGludGVsX2dwdV9m
cmVxKGRldl9wcml2LCBtYXhfZnJlcSkpOwo+ID4gKwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUs
IG1heF9mcmVxKSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiTWF4IG92ZXJjbG9ja2VkIGZyZXF1
ZW5jeTogJWRNSHpcbiIsCj4gPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+
bWF4X2ZyZXEpKTsKPiA+ICsJCQkgICBpbnRlbF9ncHVfZnJlcShpOTE1LCBycHMtPm1heF9mcmVx
KSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiQ3VycmVudCBmcmVxOiAlZCBNSHpcbiIsCj4gPiAt
CQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+Y3VyX2ZyZXEpKTsKPiA+ICsJCQkg
ICBpbnRlbF9ncHVfZnJlcShpOTE1LCBycHMtPmN1cl9mcmVxKSk7Cj4gPiAgIAkJc2VxX3ByaW50
ZihtLCAiQWN0dWFsIGZyZXE6ICVkIE1IelxuIiwgY2FnZik7Cj4gPiAgIAkJc2VxX3ByaW50Ziht
LCAiSWRsZSBmcmVxOiAlZCBNSHpcbiIsCj4gPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3By
aXYsIHJwcy0+aWRsZV9mcmVxKSk7Cj4gPiArCQkJICAgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBz
LT5pZGxlX2ZyZXEpKTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJNaW4gZnJlcTogJWQgTUh6XG4i
LAo+ID4gLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPm1pbl9mcmVxKSk7Cj4g
PiArCQkJICAgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBzLT5taW5fZnJlcSkpOwo+ID4gICAJCXNl
cV9wcmludGYobSwgIkJvb3N0IGZyZXE6ICVkIE1IelxuIiwKPiA+IC0JCQkgICBpbnRlbF9ncHVf
ZnJlcShkZXZfcHJpdiwgcnBzLT5ib29zdF9mcmVxKSk7Cj4gPiArCQkJICAgaW50ZWxfZ3B1X2Zy
ZXEoaTkxNSwgcnBzLT5ib29zdF9mcmVxKSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiTWF4IGZy
ZXE6ICVkIE1IelxuIiwKPiA+IC0JCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5t
YXhfZnJlcSkpOwo+ID4gKwkJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+bWF4X2ZyZXEp
KTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sCj4gPiAgIAkJCSAgICJlZmZpY2llbnQgKFJQZSkgZnJl
cXVlbmN5OiAlZCBNSHpcbiIsCj4gPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJw
cy0+ZWZmaWNpZW50X2ZyZXEpKTsKPiA+ICsJCQkgICBpbnRlbF9ncHVfZnJlcShpOTE1LCBycHMt
PmVmZmljaWVudF9mcmVxKSk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCXNlcV9wdXRzKG0sICJu
byBQLXN0YXRlIGluZm8gYXZhaWxhYmxlXG4iKTsKPiA+ICAgCX0KPiA+IC0Jc2VxX3ByaW50Ziht
LCAiQ3VycmVudCBDRCBjbG9jayBmcmVxdWVuY3k6ICVkIGtIelxuIiwgZGV2X3ByaXYtPmNkY2xr
Lmh3LmNkY2xrKTsKPiA+IC0Jc2VxX3ByaW50ZihtLCAiTWF4IENEIGNsb2NrIGZyZXF1ZW5jeTog
JWQga0h6XG4iLCBkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEpOwo+ID4gLQlzZXFfcHJpbnRmKG0s
ICJNYXggcGl4ZWwgY2xvY2sgZnJlcXVlbmN5OiAlZCBrSHpcbiIsIGRldl9wcml2LT5tYXhfZG90
Y2xrX2ZyZXEpOwo+ID4gKwlzZXFfcHJpbnRmKG0sICJDdXJyZW50IENEIGNsb2NrIGZyZXF1ZW5j
eTogJWQga0h6XG4iLCBpOTE1LT5jZGNsay5ody5jZGNsayk7Cj4gPiArCXNlcV9wcmludGYobSwg
Ik1heCBDRCBjbG9jayBmcmVxdWVuY3k6ICVkIGtIelxuIiwgaTkxNS0+bWF4X2NkY2xrX2ZyZXEp
Owo+ID4gKwlzZXFfcHJpbnRmKG0sICJNYXggcGl4ZWwgY2xvY2sgZnJlcXVlbmN5OiAlZCBrSHpc
biIsIGk5MTUtPm1heF9kb3RjbGtfZnJlcSk7Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRl
dl9wcml2LCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJl
Zik7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaTkxNV9pbnN0
ZG9uZV9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMg
dm9pZCBpOTE1X2luc3Rkb25lX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgIAkJCSAgICAgICBzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCj4gPiAgIAkJCSAgICAgICBzdHJ1Y3Qg
aW50ZWxfaW5zdGRvbmUgKmluc3Rkb25lKQo+ID4gICB7Cj4gPiBAQCAtMTA1NywzNyArMTA1Nywz
NyBAQCBzdGF0aWMgdm9pZCBpOTE1X2luc3Rkb25lX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gICAJc2VxX3ByaW50ZihtLCAiXHRcdElOU1RET05FOiAweCUwOHhc
biIsCj4gPiAgIAkJICAgaW5zdGRvbmUtPmluc3Rkb25lKTsKPiA+IC0JaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPD0gMykKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8PSAzKQo+ID4gICAJCXJl
dHVybjsKPiA+ICAgCXNlcV9wcmludGYobSwgIlx0XHRTQ19JTlNURE9ORTogMHglMDh4XG4iLAo+
ID4gICAJCSAgIGluc3Rkb25lLT5zbGljZV9jb21tb24pOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA8PSA2KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDYpCj4gPiAgIAkJcmV0
dXJuOwo+ID4gLQlmb3JfZWFjaF9pbnN0ZG9uZV9zbGljZV9zdWJzbGljZShkZXZfcHJpdiwgc2xp
Y2UsIHN1YnNsaWNlKQo+ID4gKwlmb3JfZWFjaF9pbnN0ZG9uZV9zbGljZV9zdWJzbGljZShpOTE1
LCBzbGljZSwgc3Vic2xpY2UpCj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiXHRcdFNBTVBMRVJfSU5T
VERPTkVbJWRdWyVkXTogMHglMDh4XG4iLAo+ID4gICAJCQkgICBzbGljZSwgc3Vic2xpY2UsIGlu
c3Rkb25lLT5zYW1wbGVyW3NsaWNlXVtzdWJzbGljZV0pOwo+ID4gLQlmb3JfZWFjaF9pbnN0ZG9u
ZV9zbGljZV9zdWJzbGljZShkZXZfcHJpdiwgc2xpY2UsIHN1YnNsaWNlKQo+ID4gKwlmb3JfZWFj
aF9pbnN0ZG9uZV9zbGljZV9zdWJzbGljZShpOTE1LCBzbGljZSwgc3Vic2xpY2UpCj4gPiAgIAkJ
c2VxX3ByaW50ZihtLCAiXHRcdFJPV19JTlNURE9ORVslZF1bJWRdOiAweCUwOHhcbiIsCj4gPiAg
IAkJCSAgIHNsaWNlLCBzdWJzbGljZSwgaW5zdGRvbmUtPnJvd1tzbGljZV1bc3Vic2xpY2VdKTsK
PiA+ICAgfQo+ID4gICBzdGF0aWMgaW50IGk5MTVfaGFuZ2NoZWNrX2luZm8oc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICp1bnVzZWQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiA+ICAgCXU2NCBhY3RoZFtJOTE1X05VTV9F
TkdJTkVTXTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9pbnN0ZG9uZSBpbnN0ZG9uZTsKPiA+ICAgCWlu
dGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Cj4g
PiAtCXNlcV9wcmludGYobSwgIlJlc2V0IGZsYWdzOiAlbHhcbiIsIGRldl9wcml2LT5ncHVfZXJy
b3IuZmxhZ3MpOwo+ID4gLQlpZiAodGVzdF9iaXQoSTkxNV9XRURHRUQsICZkZXZfcHJpdi0+Z3B1
X2Vycm9yLmZsYWdzKSkKPiA+ICsJc2VxX3ByaW50ZihtLCAiUmVzZXQgZmxhZ3M6ICVseFxuIiwg
aTkxNS0+Z3B1X2Vycm9yLmZsYWdzKTsKPiA+ICsJaWYgKHRlc3RfYml0KEk5MTVfV0VER0VELCAm
aTkxNS0+Z3B1X2Vycm9yLmZsYWdzKSkKPiA+ICAgCQlzZXFfcHV0cyhtLCAiXHRXZWRnZWRcbiIp
Owo+ID4gLQlpZiAodGVzdF9iaXQoSTkxNV9SRVNFVF9CQUNLT0ZGLCAmZGV2X3ByaXYtPmdwdV9l
cnJvci5mbGFncykpCj4gPiArCWlmICh0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZpOTE1
LT5ncHVfZXJyb3IuZmxhZ3MpKQo+ID4gICAJCXNlcV9wdXRzKG0sICJcdERldmljZSAoZ2xvYmFs
KSByZXNldCBpbiBwcm9ncmVzc1xuIik7Cj4gPiAgIAlpZiAoIWk5MTVfbW9kcGFyYW1zLmVuYWJs
ZV9oYW5nY2hlY2spIHsKPiA+IEBAIC0xMDk1LDI1ICsxMDk1LDI1IEBAIHN0YXRpYyBpbnQgaTkx
NV9oYW5nY2hlY2tfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiA+ICAg
CQlyZXR1cm4gMDsKPiA+ICAgCX0KPiA+IC0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKGRldl9wcml2
LCB3YWtlcmVmKSB7Cj4gPiAtCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQp
Cj4gPiArCXdpdGhfaW50ZWxfcnVudGltZV9wbShpOTE1LCB3YWtlcmVmKSB7Cj4gPiArCQlmb3Jf
ZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkKPiA+ICAgCQkJYWN0aGRbaWRdID0gaW50ZWxf
ZW5naW5lX2dldF9hY3RpdmVfaGVhZChlbmdpbmUpOwo+ID4gLQkJaW50ZWxfZW5naW5lX2dldF9p
bnN0ZG9uZShkZXZfcHJpdi0+ZW5naW5lW1JDUzBdLCAmaW5zdGRvbmUpOwo+ID4gKwkJaW50ZWxf
ZW5naW5lX2dldF9pbnN0ZG9uZShpOTE1LT5lbmdpbmVbUkNTMF0sICZpbnN0ZG9uZSk7Cj4gPiAg
IAl9Cj4gPiAtCWlmICh0aW1lcl9wZW5kaW5nKCZkZXZfcHJpdi0+Z3B1X2Vycm9yLmhhbmdjaGVj
a193b3JrLnRpbWVyKSkKPiA+ICsJaWYgKHRpbWVyX3BlbmRpbmcoJmk5MTUtPmdwdV9lcnJvci5o
YW5nY2hlY2tfd29yay50aW1lcikpCj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiSGFuZ2NoZWNrIGFj
dGl2ZSwgdGltZXIgZmlyZXMgaW4gJWRtc1xuIiwKPiA+IC0JCQkgICBqaWZmaWVzX3RvX21zZWNz
KGRldl9wcml2LT5ncHVfZXJyb3IuaGFuZ2NoZWNrX3dvcmsudGltZXIuZXhwaXJlcyAtCj4gPiAr
CQkJICAgamlmZmllc190b19tc2VjcyhpOTE1LT5ncHVfZXJyb3IuaGFuZ2NoZWNrX3dvcmsudGlt
ZXIuZXhwaXJlcyAtCj4gPiAgIAkJCQkJICAgIGppZmZpZXMpKTsKPiA+IC0JZWxzZSBpZiAoZGVs
YXllZF93b3JrX3BlbmRpbmcoJmRldl9wcml2LT5ncHVfZXJyb3IuaGFuZ2NoZWNrX3dvcmspKQo+
ID4gKwllbHNlIGlmIChkZWxheWVkX3dvcmtfcGVuZGluZygmaTkxNS0+Z3B1X2Vycm9yLmhhbmdj
aGVja193b3JrKSkKPiA+ICAgCQlzZXFfcHV0cyhtLCAiSGFuZ2NoZWNrIGFjdGl2ZSwgd29yayBw
ZW5kaW5nXG4iKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlzZXFfcHV0cyhtLCAiSGFuZ2NoZWNrIGlu
YWN0aXZlXG4iKTsKPiA+IC0Jc2VxX3ByaW50ZihtLCAiR1QgYWN0aXZlPyAlc1xuIiwgeWVzbm8o
ZGV2X3ByaXYtPmd0LmF3YWtlKSk7Cj4gPiArCXNlcV9wcmludGYobSwgIkdUIGFjdGl2ZT8gJXNc
biIsIHllc25vKGk5MTUtPmd0LmF3YWtlKSk7Cj4gPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUs
IGRldl9wcml2LCBpZCkgewo+ID4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkg
ewo+ID4gICAJCXNlcV9wcmludGYobSwgIiVzOiAlZCBtcyBhZ29cbiIsCj4gPiAgIAkJCSAgIGVu
Z2luZS0+bmFtZSwKPiA+ICAgCQkJICAgamlmZmllc190b19tc2VjcyhqaWZmaWVzIC0KPiA+IEBA
IC0xMTI2LDExICsxMTI2LDExIEBAIHN0YXRpYyBpbnQgaTkxNV9oYW5nY2hlY2tfaW5mbyhzdHJ1
Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiA+ICAgCQlpZiAoZW5naW5lLT5pZCA9PSBS
Q1MwKSB7Cj4gPiAgIAkJCXNlcV9wdXRzKG0sICJcdGluc3Rkb25lIHJlYWQgPVxuIik7Cj4gPiAt
CQkJaTkxNV9pbnN0ZG9uZV9pbmZvKGRldl9wcml2LCBtLCAmaW5zdGRvbmUpOwo+ID4gKwkJCWk5
MTVfaW5zdGRvbmVfaW5mbyhpOTE1LCBtLCAmaW5zdGRvbmUpOwo+ID4gICAJCQlzZXFfcHV0cyht
LCAiXHRpbnN0ZG9uZSBhY2N1ID1cbiIpOwo+ID4gLQkJCWk5MTVfaW5zdGRvbmVfaW5mbyhkZXZf
cHJpdiwgbSwKPiA+ICsJCQlpOTE1X2luc3Rkb25lX2luZm8oaTkxNSwgbSwKPiA+ICAgCQkJCQkg
ICAmZW5naW5lLT5oYW5nY2hlY2suaW5zdGRvbmUpOwo+ID4gICAJCX0KPiA+ICAgCX0KPiA+IEBA
IC0xMTQwLDE0ICsxMTQwLDE0IEBAIHN0YXRpYyBpbnQgaTkxNV9oYW5nY2hlY2tfaW5mbyhzdHJ1
Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiA+ICAgc3RhdGljIGludCBpOTE1X3Jlc2V0
X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUp
Owo+ID4gLQlzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9yID0gJmRldl9wcml2LT5ncHVfZXJy
b3I7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0t
PnByaXZhdGUpOwo+ID4gKwlzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9yID0gJmk5MTUtPmdw
dV9lcnJvcjsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiA+ICAgCWVu
dW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ID4gICAJc2VxX3ByaW50ZihtLCAiZnVsbCBncHUgcmVz
ZXQgPSAldVxuIiwgaTkxNV9yZXNldF9jb3VudChlcnJvcikpOwo+ID4gLQlmb3JfZWFjaF9lbmdp
bmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKPiA+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwg
aTkxNSwgaWQpIHsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICIlcyA9ICV1XG4iLCBlbmdpbmUtPm5h
bWUsCj4gPiAgIAkJCSAgIGk5MTVfcmVzZXRfZW5naW5lX2NvdW50KGVycm9yLCBlbmdpbmUpKTsK
PiA+ICAgCX0KPiA+IEBAIC0xMjM1LDE2ICsxMjM1LDE2IEBAIHN0YXRpYyB2b2lkIHByaW50X3Jj
Nl9yZXMoc3RydWN0IHNlcV9maWxlICptLAo+ID4gICAJCQkgIGNvbnN0IGNoYXIgKnRpdGxlLAo+
ID4gICAJCQkgIGNvbnN0IGk5MTVfcmVnX3QgcmVnKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7
Cj4gPiAgIAlzZXFfcHJpbnRmKG0sICIlcyAldSAoJWxsdSB1cylcbiIsCj4gPiAgIAkJICAgdGl0
bGUsIEk5MTVfUkVBRChyZWcpLAo+ID4gLQkJICAgaW50ZWxfcmM2X3Jlc2lkZW5jeV91cyhkZXZf
cHJpdiwgcmVnKSk7Cj4gPiArCQkgICBpbnRlbF9yYzZfcmVzaWRlbmN5X3VzKGk5MTUsIHJlZykp
Owo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgdmx2X2RycGNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9k
ZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICAgCXUzMiByY2N0bDEsIHB3X3N0YXR1
czsKPiA+ICAgCXB3X3N0YXR1cyA9IEk5MTVfUkVBRChWTFZfR1RMQ19QV19TVEFUVVMpOwo+ID4g
QEAgLTEyNjYsNyArMTI2Niw3IEBAIHN0YXRpYyBpbnQgdmx2X2RycGNfaW5mbyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0pCj4gPiAgIHN0YXRpYyBpbnQgZ2VuNl9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxl
ICptKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5v
ZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiAgIAl1MzIgZ3RfY29yZV9zdGF0dXMs
IHJjY3RsMSwgcmM2dmlkcyA9IDA7Cj4gPiAgIAl1MzIgZ2VuOV9wb3dlcmdhdGVfZW5hYmxlID0g
MCwgZ2VuOV9wb3dlcmdhdGVfc3RhdHVzID0gMDsKPiA+IEBAIC0xMjc0LDIwICsxMjc0LDIwIEBA
IHN0YXRpYyBpbnQgZ2VuNl9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQo+ID4gICAJdHJh
Y2VfaTkxNV9yZWdfcncoZmFsc2UsIEdFTjZfR1RfQ09SRV9TVEFUVVMsIGd0X2NvcmVfc3RhdHVz
LCA0LCB0cnVlKTsKPiA+ICAgCXJjY3RsMSA9IEk5MTVfUkVBRChHRU42X1JDX0NPTlRST0wpOwo+
ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Cj4gPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gOSkgewo+ID4gICAJCWdlbjlfcG93ZXJnYXRlX2VuYWJsZSA9IEk5MTVfUkVBRChH
RU45X1BHX0VOQUJMRSk7Cj4gPiAgIAkJZ2VuOV9wb3dlcmdhdGVfc3RhdHVzID0gSTkxNV9SRUFE
KEdFTjlfUFdSR1RfRE9NQUlOX1NUQVRVUyk7Cj4gPiAgIAl9Cj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpIDw9IDcpCj4gPiAtCQlzYW5keWJyaWRnZV9wY29kZV9yZWFkKGRldl9wcml2LCBH
RU42X1BDT0RFX1JFQURfUkM2VklEUywKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8PSA3KQo+
ID4gKwkJc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChpOTE1LCBHRU42X1BDT0RFX1JFQURfUkM2VklE
UywKPiA+ICAgCQkJCSAgICAgICAmcmM2dmlkcywgTlVMTCk7Cj4gPiAgIAlzZXFfcHJpbnRmKG0s
ICJSQzFlIEVuYWJsZWQ6ICVzXG4iLAo+ID4gICAJCSAgIHllc25vKHJjY3RsMSAmIEdFTjZfUkNf
Q1RMX1JDMWVfRU5BQkxFKSk7Cj4gPiAgIAlzZXFfcHJpbnRmKG0sICJSQzYgRW5hYmxlZDogJXNc
biIsCj4gPiAgIAkJICAgeWVzbm8ocmNjdGwxICYgR0VONl9SQ19DVExfUkM2X0VOQUJMRSkpOwo+
ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Cj4gPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gOSkgewo+ID4gICAJCXNlcV9wcmludGYobSwgIlJlbmRlciBXZWxsIEdhdGluZyBF
bmFibGVkOiAlc1xuIiwKPiA+ICAgCQkJeWVzbm8oZ2VuOV9wb3dlcmdhdGVfZW5hYmxlICYgR0VO
OV9SRU5ERVJfUEdfRU5BQkxFKSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiTWVkaWEgV2VsbCBH
YXRpbmcgRW5hYmxlZDogJXNcbiIsCj4gPiBAQCAtMTMyMSw3ICsxMzIxLDcgQEAgc3RhdGljIGlu
dCBnZW42X2RycGNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCj4gPiAgIAlzZXFfcHJpbnRmKG0s
ICJDb3JlIFBvd2VyIERvd246ICVzXG4iLAo+ID4gICAJCSAgIHllc25vKGd0X2NvcmVfc3RhdHVz
ICYgR0VONl9DT1JFX0NQRF9TVEFURV9NQVNLKSk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDkpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KSB7Cj4gPiAgIAkJc2Vx
X3ByaW50ZihtLCAiUmVuZGVyIFBvd2VyIFdlbGw6ICVzXG4iLAo+ID4gICAJCQkoZ2VuOV9wb3dl
cmdhdGVfc3RhdHVzICYKPiA+ICAgCQkJIEdFTjlfUFdSR1RfUkVOREVSX1NUQVRVU19NQVNLKSA/
ICJVcCIgOiAiRG93biIpOwo+ID4gQEAgLTEzMzcsNyArMTMzNyw3IEBAIHN0YXRpYyBpbnQgZ2Vu
Nl9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQo+ID4gICAJcHJpbnRfcmM2X3JlcyhtLCAi
UkM2KyByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBHRU42X0dUX0dGWF9SQzZwKTsKPiA+ICAgCXBy
aW50X3JjNl9yZXMobSwgIlJDNisrIHJlc2lkZW5jeSBzaW5jZSBib290OiIsIEdFTjZfR1RfR0ZY
X1JDNnBwKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNykgewo+ID4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpIDw9IDcpIHsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJSQzYgICB2b2x0
YWdlOiAlZG1WXG4iLAo+ID4gICAJCQkgICBHRU42X0RFQ09ERV9SQzZfVklEKCgocmM2dmlkcyA+
PiAwKSAmIDB4ZmYpKSk7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiUkM2KyAgdm9sdGFnZTogJWRt
VlxuIiwKPiA+IEBAIC0xMzUxLDE0ICsxMzUxLDE0IEBAIHN0YXRpYyBpbnQgZ2VuNl9kcnBjX2lu
Zm8oc3RydWN0IHNlcV9maWxlICptKQo+ID4gICBzdGF0aWMgaW50IGk5MTVfZHJwY19pbmZvKHN0
cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7
Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCWludCBlcnIgPSAtRU5PREVW
Owo+ID4gLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oZGV2X3ByaXYsIHdha2VyZWYpIHsKPiA+IC0J
CWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkK
PiA+ICsJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGk5MTUsIHdha2VyZWYpIHsKPiA+ICsJCWlmIChJ
U19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJCWVyciA9
IHZsdl9kcnBjX2luZm8obSk7Cj4gPiAtCQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDYpCj4gPiArCQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKPiA+ICAgCQkJZXJyID0g
Z2VuNl9kcnBjX2luZm8obSk7Cj4gPiAgIAkJZWxzZQo+ID4gICAJCQllcnIgPSBpcm9ubGFrZV9k
cnBjX2luZm8obSk7Cj4gPiBAQCAtMTM2OSw0NCArMTM2OSw0NCBAQCBzdGF0aWMgaW50IGk5MTVf
ZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ID4gICBzdGF0aWMg
aW50IGk5MTVfZnJvbnRidWZmZXJfdHJhY2tpbmcoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1
bnVzZWQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
bm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICAgCXNlcV9wcmludGYobSwgIkZC
IHRyYWNraW5nIGJ1c3kgYml0czogMHglMDh4XG4iLAo+ID4gLQkJICAgZGV2X3ByaXYtPmZiX3Ry
YWNraW5nLmJ1c3lfYml0cyk7Cj4gPiArCQkgICBpOTE1LT5mYl90cmFja2luZy5idXN5X2JpdHMp
Owo+ID4gICAJc2VxX3ByaW50ZihtLCAiRkIgdHJhY2tpbmcgZmxpcCBiaXRzOiAweCUwOHhcbiIs
Cj4gPiAtCQkgICBkZXZfcHJpdi0+ZmJfdHJhY2tpbmcuZmxpcF9iaXRzKTsKPiA+ICsJCSAgIGk5
MTUtPmZiX3RyYWNraW5nLmZsaXBfYml0cyk7Cj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4g
ICBzdGF0aWMgaW50IGk5MTVfZmJjX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVu
dXNlZCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBu
b2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiAtCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZk
ZXZfcHJpdi0+ZmJjOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVf
dG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUt
PmZiYzsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gLQlpZiAoIUhBU19GQkMo
ZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19GQkMoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIC1FTk9E
RVY7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gPiAr
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiA+ICAgCW11dGV4X2xvY2so
JmZiYy0+bG9jayk7Cj4gPiAtCWlmIChpbnRlbF9mYmNfaXNfYWN0aXZlKGRldl9wcml2KSkKPiA+
ICsJaWYgKGludGVsX2ZiY19pc19hY3RpdmUoaTkxNSkpCj4gPiAgIAkJc2VxX3B1dHMobSwgIkZC
QyBlbmFibGVkXG4iKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJGQkMgZGlz
YWJsZWQ6ICVzXG4iLCBmYmMtPm5vX2ZiY19yZWFzb24pOwo+ID4gLQlpZiAoaW50ZWxfZmJjX2lz
X2FjdGl2ZShkZXZfcHJpdikpIHsKPiA+ICsJaWYgKGludGVsX2ZiY19pc19hY3RpdmUoaTkxNSkp
IHsKPiA+ICAgCQl1MzIgbWFzazsKPiA+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgp
Cj4gPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpCj4gPiAgIAkJCW1hc2sgPSBJOTE1X1JF
QUQoSVZCX0ZCQ19TVEFUVVMyKSAmIEJEV19GQkNfQ09NUF9TRUdfTUFTSzsKPiA+IC0JCWVsc2Ug
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykKPiA+ICsJCWVsc2UgaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA3KQo+ID4gICAJCQltYXNrID0gSTkxNV9SRUFEKElWQl9GQkNfU1RBVFVTMikgJiBJ
VkJfRkJDX0NPTVBfU0VHX01BU0s7Cj4gPiAtCQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDUpCj4gPiArCQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNSkKPiA+ICAgCQkJbWFz
ayA9IEk5MTVfUkVBRChJTEtfRFBGQ19TVEFUVVMpICYgSUxLX0RQRkNfQ09NUF9TRUdfTUFTSzsK
PiA+IC0JCWVsc2UgaWYgKElTX0c0WChkZXZfcHJpdikpCj4gPiArCQllbHNlIGlmIChJU19HNFgo
aTkxNSkpCj4gPiAgIAkJCW1hc2sgPSBJOTE1X1JFQUQoRFBGQ19TVEFUVVMpICYgRFBGQ19DT01Q
X1NFR19NQVNLOwo+ID4gICAJCWVsc2UKPiA+ICAgCQkJbWFzayA9IEk5MTVfUkVBRChGQkNfU1RB
VFVTKSAmIChGQkNfU1RBVF9DT01QUkVTU0lORyB8Cj4gPiBAQCAtMTQxNiw0MSArMTQxNiw0MSBA
QCBzdGF0aWMgaW50IGk5MTVfZmJjX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVu
dXNlZCkKPiA+ICAgCX0KPiA+ICAgCW11dGV4X3VubG9jaygmZmJjLT5sb2NrKTsKPiA+IC0JaW50
ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9ydW50aW1l
X3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiAgIHN0
YXRpYyBpbnQgaTkxNV9mYmNfZmFsc2VfY29sb3JfZ2V0KHZvaWQgKmRhdGEsIHU2NCAqdmFsKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRhdGE7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZGF0YTsKPiA+IC0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPCA3IHx8ICFIQVNfRkJDKGRldl9wcml2KSkKPiA+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA8IDcgfHwgIUhBU19GQkMoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIC1FTk9ERVY7
Cj4gPiAtCSp2YWwgPSBkZXZfcHJpdi0+ZmJjLmZhbHNlX2NvbG9yOwo+ID4gKwkqdmFsID0gaTkx
NS0+ZmJjLmZhbHNlX2NvbG9yOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+ICAgc3RhdGlj
IGludCBpOTE1X2ZiY19mYWxzZV9jb2xvcl9zZXQodm9pZCAqZGF0YSwgdTY0IHZhbCkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkYXRhOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRhdGE7Cj4gPiAgIAl1MzIgcmVnOwo+ID4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDcgfHwgIUhBU19GQkMoZGV2X3ByaXYpKQo+ID4g
KwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNyB8fCAhSEFTX0ZCQyhpOTE1KSkKPiA+ICAgCQlyZXR1
cm4gLUVOT0RFVjsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmZiYy5sb2NrKTsKPiA+ICsJ
bXV0ZXhfbG9jaygmaTkxNS0+ZmJjLmxvY2spOwo+ID4gICAJcmVnID0gSTkxNV9SRUFEKElMS19E
UEZDX0NPTlRST0wpOwo+ID4gLQlkZXZfcHJpdi0+ZmJjLmZhbHNlX2NvbG9yID0gdmFsOwo+ID4g
KwlpOTE1LT5mYmMuZmFsc2VfY29sb3IgPSB2YWw7Cj4gPiAgIAlJOTE1X1dSSVRFKElMS19EUEZD
X0NPTlRST0wsIHZhbCA/Cj4gPiAgIAkJICAgKHJlZyB8IEZCQ19DVExfRkFMU0VfQ09MT1IpIDoK
PiA+ICAgCQkgICAocmVnICYgfkZCQ19DVExfRkFMU0VfQ09MT1IpKTsKPiA+IC0JbXV0ZXhfdW5s
b2NrKCZkZXZfcHJpdi0+ZmJjLmxvY2spOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmZiYy5s
b2NrKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiBAQCAtMTQ2MCwxOCArMTQ2MCwxOCBA
QCBERUZJTkVfU0lNUExFX0FUVFJJQlVURShpOTE1X2ZiY19mYWxzZV9jb2xvcl9mb3BzLAo+ID4g
ICBzdGF0aWMgaW50IGk5MTVfaXBzX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVu
dXNlZCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBu
b2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdh
a2VyZWY7Cj4gPiAtCWlmICghSEFTX0lQUyhkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX0lQUyhp
OTE1KSkKPiA+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRp
bWVfcG1fZ2V0KGRldl9wcml2KTsKPiA+ICsJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0
KGk5MTUpOwo+ID4gICAJc2VxX3ByaW50ZihtLCAiRW5hYmxlZCBieSBrZXJuZWwgcGFyYW1ldGVy
OiAlc1xuIiwKPiA+ICAgCQkgICB5ZXNubyhpOTE1X21vZHBhcmFtcy5lbmFibGVfaXBzKSk7Cj4g
PiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA4KSB7Cj4gPiAgIAkJc2VxX3B1dHMobSwgIkN1cnJlbnRseTogdW5rbm93blxuIik7
Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCWlmIChJOTE1X1JFQUQoSVBTX0NUTCkgJiBJUFNfRU5B
QkxFKQo+ID4gQEAgLTE0ODAsMzQgKzE0ODAsMzQgQEAgc3RhdGljIGludCBpOTE1X2lwc19zdGF0
dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gPiAgIAkJCXNlcV9wdXRzKG0s
ICJDdXJyZW50bHk6IGRpc2FibGVkXG4iKTsKPiA+ICAgCX0KPiA+IC0JaW50ZWxfcnVudGltZV9w
bV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1
LCB3YWtlcmVmKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgaTkx
NV9zcl9zdGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnBy
aXZhdGUpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkx
NShtLT5wcml2YXRlKTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJYm9v
bCBzcl9lbmFibGVkID0gZmFsc2U7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2dldChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0lOSVQpOwo+ID4gKwl3YWtlcmVmID0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgUE9XRVJfRE9NQUlOX0lOSVQpOwo+ID4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCj4g
PiAgIAkJLyogbm8gZ2xvYmFsIFNSIHN0YXR1czsgaW5zcGVjdCBwZXItcGxhbmUgV00gKi87Cj4g
PiAtCWVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChIQVNf
UENIX1NQTElUKGk5MTUpKQo+ID4gICAJCXNyX2VuYWJsZWQgPSBJOTE1X1JFQUQoV00xX0xQX0lM
SykgJiBXTTFfTFBfU1JfRU47Cj4gPiAtCWVsc2UgaWYgKElTX0k5NjVHTShkZXZfcHJpdikgfHwg
SVNfRzRYKGRldl9wcml2KSB8fAo+ID4gLQkJIElTX0k5NDVHKGRldl9wcml2KSB8fCBJU19JOTQ1
R00oZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19JOTY1R00oaTkxNSkgfHwgSVNfRzRYKGk5
MTUpIHx8Cj4gPiArCQkgSVNfSTk0NUcoaTkxNSkgfHwgSVNfSTk0NUdNKGk5MTUpKQo+ID4gICAJ
CXNyX2VuYWJsZWQgPSBJOTE1X1JFQUQoRldfQkxDX1NFTEYpICYgRldfQkxDX1NFTEZfRU47Cj4g
PiAtCWVsc2UgaWYgKElTX0k5MTVHTShkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElTX0k5MTVH
TShpOTE1KSkKPiA+ICAgCQlzcl9lbmFibGVkID0gSTkxNV9SRUFEKElOU1RQTSkgJiBJTlNUUE1f
U0VMRl9FTjsKPiA+IC0JZWxzZSBpZiAoSVNfUElORVZJRVcoZGV2X3ByaXYpKQo+ID4gKwllbHNl
IGlmIChJU19QSU5FVklFVyhpOTE1KSkKPiA+ICAgCQlzcl9lbmFibGVkID0gSTkxNV9SRUFEKERT
UEZXMykgJiBQSU5FVklFV19TRUxGX1JFRlJFU0hfRU47Cj4gPiAtCWVsc2UgaWYgKElTX1ZBTExF
WVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlm
IChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJc3Jf
ZW5hYmxlZCA9IEk5MTVfUkVBRChGV19CTENfU0VMRl9WTFYpICYgRldfQ1NQV1JEV05FTjsKPiA+
IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9JTklULCB3
YWtlcmVmKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9NQUlO
X0lOSVQsIHdha2VyZWYpOwo+ID4gICAJc2VxX3ByaW50ZihtLCAic2VsZi1yZWZyZXNoOiAlc1xu
IiwgZW5hYmxlZGRpc2FibGVkKHNyX2VuYWJsZWQpKTsKPiA+IEBAIC0xNTQwLDE4ICsxNTQwLDE4
IEBAIHN0YXRpYyBpbnQgaTkxNV9lbW9uX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQg
KnVudXNlZCkKPiA+ICAgc3RhdGljIGludCBpOTE1X3JpbmdfZnJlcV90YWJsZShzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiAtCXN0cnVjdCBp
bnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJc3RydWN0
IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0X3BtLnJwczsKPiA+ICAgCXVuc2lnbmVkIGludCBt
YXhfZ3B1X2ZyZXEsIG1pbl9ncHVfZnJlcTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVm
Owo+ID4gICAJaW50IGdwdV9mcmVxLCBpYV9mcmVxOwo+ID4gLQlpZiAoIUhBU19MTEMoZGV2X3By
aXYpKQo+ID4gKwlpZiAoIUhBU19MTEMoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4g
PiAgIAltaW5fZ3B1X2ZyZXEgPSBycHMtPm1pbl9mcmVxOwo+ID4gICAJbWF4X2dwdV9mcmVxID0g
cnBzLT5tYXhfZnJlcTsKPiA+IC0JaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8IElOVEVMX0dF
TihkZXZfcHJpdikgPj0gMTApIHsKPiA+ICsJaWYgKElTX0dFTjlfQkMoaTkxNSkgfHwgSU5URUxf
R0VOKGk5MTUpID49IDEwKSB7Cj4gPiAgIAkJLyogQ29udmVydCBHVCBmcmVxdWVuY3kgdG8gNTAg
SFogdW5pdHMgKi8KPiA+ICAgCQltaW5fZ3B1X2ZyZXEgLz0gR0VOOV9GUkVRX1NDQUxFUjsKPiA+
ICAgCQltYXhfZ3B1X2ZyZXEgLz0gR0VOOV9GUkVRX1NDQUxFUjsKPiA+IEBAIC0xNTU5LDMwICsx
NTU5LDMwIEBAIHN0YXRpYyBpbnQgaTkxNV9yaW5nX2ZyZXFfdGFibGUoc3RydWN0IHNlcV9maWxl
ICptLCB2b2lkICp1bnVzZWQpCj4gPiAgIAlzZXFfcHV0cyhtLCAiR1BVIGZyZXEgKE1IeilcdEVm
ZmVjdGl2ZSBDUFUgZnJlcSAoTUh6KVx0RWZmZWN0aXZlIFJpbmcgZnJlcSAoTUh6KVxuIik7Cj4g
PiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gPiArCXdha2Vy
ZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiA+ICAgCWZvciAoZ3B1X2ZyZXEgPSBt
aW5fZ3B1X2ZyZXE7IGdwdV9mcmVxIDw9IG1heF9ncHVfZnJlcTsgZ3B1X2ZyZXErKykgewo+ID4g
ICAJCWlhX2ZyZXEgPSBncHVfZnJlcTsKPiA+IC0JCXNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoZGV2
X3ByaXYsCj4gPiArCQlzYW5keWJyaWRnZV9wY29kZV9yZWFkKGk5MTUsCj4gPiAgIAkJCQkgICAg
ICAgR0VONl9QQ09ERV9SRUFEX01JTl9GUkVRX1RBQkxFLAo+ID4gICAJCQkJICAgICAgICZpYV9m
cmVxLCBOVUxMKTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICIlZFx0XHQlZFx0XHRcdFx0JWRcbiIs
Cj4gPiAtCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIChncHVfZnJlcSAqCj4gPiAtCQkJ
CQkJICAgICAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwKPiA+IC0JCQkJCQkgICAgICBJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDEwID8KPiA+ICsJCQkgICBpbnRlbF9ncHVfZnJlcShpOTE1LCAoZ3B1
X2ZyZXEgKgo+ID4gKwkJCQkJCSAgICAgKElTX0dFTjlfQkMoaTkxNSkgfHwKPiA+ICsJCQkJCQkg
ICAgICBJTlRFTF9HRU4oaTkxNSkgPj0gMTAgPwo+ID4gICAJCQkJCQkgICAgICBHRU45X0ZSRVFf
U0NBTEVSIDogMSkpKSwKPiA+ICAgCQkJICAgKChpYV9mcmVxID4+IDApICYgMHhmZikgKiAxMDAs
Cj4gPiAgIAkJCSAgICgoaWFfZnJlcSA+PiA4KSAmIDB4ZmYpICogMTAwKTsKPiA+ICAgCX0KPiA+
IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9y
dW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4g
PiAgIHN0YXRpYyBpbnQgaTkxNV9vcHJlZ2lvbihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVu
dXNlZCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBu
b2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAm
ZGV2X3ByaXYtPmRybTsKPiA+IC0Jc3RydWN0IGludGVsX29wcmVnaW9uICpvcHJlZ2lvbiA9ICZk
ZXZfcHJpdi0+b3ByZWdpb247Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
bm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0g
Jmk5MTUtPmRybTsKPiA+ICsJc3RydWN0IGludGVsX29wcmVnaW9uICpvcHJlZ2lvbiA9ICZpOTE1
LT5vcHJlZ2lvbjsKPiA+ICAgCWludCByZXQ7Cj4gPiAgIAlyZXQgPSBtdXRleF9sb2NrX2ludGVy
cnVwdGlibGUoJmRldi0+c3RydWN0X211dGV4KTsKPiA+IEBAIC0xNjEwLDggKzE2MTAsOCBAQCBz
dGF0aWMgaW50IGk5MTVfdmJ0KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ID4g
ICBzdGF0aWMgaW50IGk5MTVfZ2VtX2ZyYW1lYnVmZmVyX2luZm8oc3RydWN0IHNlcV9maWxlICpt
LCB2b2lkICpkYXRhKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9ICZpOTE1LT5kcm07Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIgKmZiZGV2X2Zi
ID0gTlVMTDsKPiA+ICAgCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmRybV9mYjsKPiA+ICAgCWlu
dCByZXQ7Cj4gPiBAQCAtMTYyMSw4ICsxNjIxLDggQEAgc3RhdGljIGludCBpOTE1X2dlbV9mcmFt
ZWJ1ZmZlcl9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgCQlyZXR1
cm4gcmV0Owo+ID4gICAjaWZkZWYgQ09ORklHX0RSTV9GQkRFVl9FTVVMQVRJT04KPiA+IC0JaWYg
KGRldl9wcml2LT5mYmRldiAmJiBkZXZfcHJpdi0+ZmJkZXYtPmhlbHBlci5mYikgewo+ID4gLQkJ
ZmJkZXZfZmIgPSB0b19pbnRlbF9mcmFtZWJ1ZmZlcihkZXZfcHJpdi0+ZmJkZXYtPmhlbHBlci5m
Yik7Cj4gPiArCWlmIChpOTE1LT5mYmRldiAmJiBpOTE1LT5mYmRldi0+aGVscGVyLmZiKSB7Cj4g
PiArCQlmYmRldl9mYiA9IHRvX2ludGVsX2ZyYW1lYnVmZmVyKGk5MTUtPmZiZGV2LT5oZWxwZXIu
ZmIpOwo+ID4gICAJCXNlcV9wcmludGYobSwgImZiY29uIHNpemU6ICVkIHggJWQsIGRlcHRoICVk
LCAlZCBicHAsIG1vZGlmaWVyIDB4JWxseCwgcmVmY291bnQgJWQsIG9iaiAiLAo+ID4gICAJCQkg
ICBmYmRldl9mYi0+YmFzZS53aWR0aCwKPiA+IEBAIC0xNjY2LDggKzE2NjYsOCBAQCBzdGF0aWMg
dm9pZCBkZXNjcmliZV9jdHhfcmluZyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVjdCBpbnRlbF9y
aW5nICpyaW5nKQo+ID4gICBzdGF0aWMgaW50IGk5MTVfY29udGV4dF9zdGF0dXMoc3RydWN0IHNl
cV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gLQlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiA+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0
ICpjdHg7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gQEAgLTE2NzUsNyArMTY3NSw3IEBAIHN0YXRpYyBp
bnQgaTkxNV9jb250ZXh0X3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkK
PiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJcmV0dXJuIHJldDsKPiA+IC0JbGlzdF9mb3JfZWFjaF9l
bnRyeShjdHgsICZkZXZfcHJpdi0+Y29udGV4dHMubGlzdCwgbGluaykgewo+ID4gKwlsaXN0X2Zv
cl9lYWNoX2VudHJ5KGN0eCwgJmk5MTUtPmNvbnRleHRzLmxpc3QsIGxpbmspIHsKPiA+ICAgCQlz
dHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVyIGl0Owo+ID4gICAJCXN0cnVjdCBpbnRlbF9jb250
ZXh0ICpjZTsKPiA+IEBAIC0xNzQ2LDE4ICsxNzQ2LDE4IEBAIHN0YXRpYyBjb25zdCBjaGFyICpz
d2l6emxlX3N0cmluZyh1bnNpZ25lZCBzd2l6emxlKQo+ID4gICBzdGF0aWMgaW50IGk5MTVfc3dp
enpsZV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgewo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0
ZSk7Cj4gPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3Jl
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5w
cml2YXRlKTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29y
ZTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gLQl3YWtlcmVmID0gaW50ZWxf
cnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ID4gKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9w
bV9nZXQoaTkxNSk7Cj4gPiAgIAlzZXFfcHJpbnRmKG0sICJiaXQ2IHN3aXp6bGUgZm9yIFgtdGls
aW5nID0gJXNcbiIsCj4gPiAtCQkgICBzd2l6emxlX3N0cmluZyhkZXZfcHJpdi0+bW0uYml0XzZf
c3dpenpsZV94KSk7Cj4gPiArCQkgICBzd2l6emxlX3N0cmluZyhpOTE1LT5tbS5iaXRfNl9zd2l6
emxlX3gpKTsKPiA+ICAgCXNlcV9wcmludGYobSwgImJpdDYgc3dpenpsZSBmb3IgWS10aWxpbmcg
PSAlc1xuIiwKPiA+IC0JCSAgIHN3aXp6bGVfc3RyaW5nKGRldl9wcml2LT5tbS5iaXRfNl9zd2l6
emxlX3kpKTsKPiA+ICsJCSAgIHN3aXp6bGVfc3RyaW5nKGk5MTUtPm1tLmJpdF82X3N3aXp6bGVf
eSkpOwo+ID4gLQlpZiAoSVNfR0VOX1JBTkdFKGRldl9wcml2LCAzLCA0KSkgewo+ID4gKwlpZiAo
SVNfR0VOX1JBTkdFKGk5MTUsIDMsIDQpKSB7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiRERDID0g
MHglMDh4XG4iLAo+ID4gICAJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIERDQykpOwo+
ID4gICAJCXNlcV9wcmludGYobSwgIkREQzIgPSAweCUwOHhcbiIsCj4gPiBAQCAtMTc2Niw3ICsx
NzY2LDcgQEAgc3RhdGljIGludCBpOTE1X3N3aXp6bGVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKmRhdGEpCj4gPiAgIAkJCSAgIGludGVsX3VuY29yZV9yZWFkMTYodW5jb3JlLCBDMERS
QjMpKTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJDMURSQjMgPSAweCUwNHhcbiIsCj4gPiAgIAkJ
CSAgIGludGVsX3VuY29yZV9yZWFkMTYodW5jb3JlLCBDMURSQjMpKTsKPiA+IC0JfSBlbHNlIGlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpIHsKPiA+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gNikgewo+ID4gICAJCXNlcV9wcmludGYobSwgIk1BRF9ESU1NX0MwID0gMHglMDh4
XG4iLAo+ID4gICAJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIE1BRF9ESU1NX0MwKSk7
Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAiTUFEX0RJTU1fQzEgPSAweCUwOHhcbiIsCj4gPiBAQCAt
MTc3NSw3ICsxNzc1LDcgQEAgc3RhdGljIGludCBpOTE1X3N3aXp6bGVfaW5mbyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAgIAkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29y
ZSwgTUFEX0RJTU1fQzIpKTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJUSUxFQ1RMID0gMHglMDh4
XG4iLAo+ID4gICAJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFRJTEVDVEwpKTsKPiA+
IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpCj4gPiArCQlpZiAoSU5URUxfR0VOKGk5
MTUpID49IDgpCj4gPiAgIAkJCXNlcV9wcmludGYobSwgIkdBTVRBUkJNT0RFID0gMHglMDh4XG4i
LAo+ID4gICAJCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHQU1UQVJCTU9ERSkpOwo+
ID4gICAJCWVsc2UKPiA+IEBAIC0xNzg1LDEwICsxNzg1LDEwIEBAIHN0YXRpYyBpbnQgaTkxNV9z
d2l6emxlX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ID4gICAJCQkgICBp
bnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIERJU1BfQVJCX0NUTCkpOwo+ID4gICAJfQo+ID4gLQlp
ZiAoZGV2X3ByaXYtPnF1aXJrcyAmIFFVSVJLX1BJTl9TV0laWkxFRF9QQUdFUykKPiA+ICsJaWYg
KGk5MTUtPnF1aXJrcyAmIFFVSVJLX1BJTl9TV0laWkxFRF9QQUdFUykKPiA+ICAgCQlzZXFfcHV0
cyhtLCAiTC1zaGFwZWQgbWVtb3J5IGRldGVjdGVkXG4iKTsKPiA+IC0JaW50ZWxfcnVudGltZV9w
bV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1
LCB3YWtlcmVmKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiBAQCAtMTgwOSw1NCArMTgw
OSw1NCBAQCBzdGF0aWMgY29uc3QgY2hhciAqcnBzX3Bvd2VyX3RvX3N0cih1bnNpZ25lZCBpbnQg
cG93ZXIpCj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9ycHNfYm9vc3RfaW5mbyhzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gLQlzdHJ1Y3QgaW50ZWxf
cnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiArCXN0cnVjdCBpbnRl
bF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gPiAgIAl1MzIgYWN0X2ZyZXEgPSBycHMt
PmN1cl9mcmVxOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAtCXdpdGhfaW50
ZWxfcnVudGltZV9wbV9pZl9pbl91c2UoZGV2X3ByaXYsIHdha2VyZWYpIHsKPiA+IC0JCWlmIChJ
U19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4g
LQkJCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOwo+ID4gLQkJCWFjdF9mcmVxID0gdmx2X3B1bml0
X3JlYWQoZGV2X3ByaXYsCj4gPiArCXdpdGhfaW50ZWxfcnVudGltZV9wbV9pZl9pbl91c2UoaTkx
NSwgd2FrZXJlZikgewo+ID4gKwkJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZ
VklFVyhpOTE1KSkgewo+ID4gKwkJCXZsdl9wdW5pdF9nZXQoaTkxNSk7Cj4gPiArCQkJYWN0X2Zy
ZXEgPSB2bHZfcHVuaXRfcmVhZChpOTE1LAo+ID4gICAJCQkJCQkgIFBVTklUX1JFR19HUFVfRlJF
UV9TVFMpOwo+ID4gLQkJCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYpOwo+ID4gKwkJCXZsdl9wdW5p
dF9wdXQoaTkxNSk7Cj4gPiAgIAkJCWFjdF9mcmVxID0gKGFjdF9mcmVxID4+IDgpICYgMHhmZjsK
PiA+ICAgCQl9IGVsc2Ugewo+ID4gLQkJCWFjdF9mcmVxID0gaW50ZWxfZ2V0X2NhZ2YoZGV2X3By
aXYsCj4gPiArCQkJYWN0X2ZyZXEgPSBpbnRlbF9nZXRfY2FnZihpOTE1LAo+ID4gICAJCQkJCQkg
IEk5MTVfUkVBRChHRU42X1JQU1RBVDEpKTsKPiA+ICAgCQl9Cj4gPiAgIAl9Cj4gPiAgIAlzZXFf
cHJpbnRmKG0sICJSUFMgZW5hYmxlZD8gJWRcbiIsIHJwcy0+ZW5hYmxlZCk7Cj4gPiAtCXNlcV9w
cmludGYobSwgIkdQVSBidXN5PyAlc1xuIiwgeWVzbm8oZGV2X3ByaXYtPmd0LmF3YWtlKSk7Cj4g
PiArCXNlcV9wcmludGYobSwgIkdQVSBidXN5PyAlc1xuIiwgeWVzbm8oaTkxNS0+Z3QuYXdha2Up
KTsKPiA+ICAgCXNlcV9wcmludGYobSwgIkJvb3N0cyBvdXRzdGFuZGluZz8gJWRcbiIsCj4gPiAg
IAkJICAgYXRvbWljX3JlYWQoJnJwcy0+bnVtX3dhaXRlcnMpKTsKPiA+ICAgCXNlcV9wcmludGYo
bSwgIkludGVyYWN0aXZlPyAlZFxuIiwgUkVBRF9PTkNFKHJwcy0+cG93ZXIuaW50ZXJhY3RpdmUp
KTsKPiA+ICAgCXNlcV9wcmludGYobSwgIkZyZXF1ZW5jeSByZXF1ZXN0ZWQgJWQsIGFjdHVhbCAl
ZFxuIiwKPiA+IC0JCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPmN1cl9mcmVxKSwK
PiA+IC0JCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBhY3RfZnJlcSkpOwo+ID4gKwkJICAg
aW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBzLT5jdXJfZnJlcSksCj4gPiArCQkgICBpbnRlbF9ncHVf
ZnJlcShpOTE1LCBhY3RfZnJlcSkpOwo+ID4gICAJc2VxX3ByaW50ZihtLCAiICBtaW4gaGFyZDol
ZCwgc29mdDolZDsgbWF4IHNvZnQ6JWQsIGhhcmQ6JWRcbiIsCj4gPiAtCQkgICBpbnRlbF9ncHVf
ZnJlcShkZXZfcHJpdiwgcnBzLT5taW5fZnJlcSksCj4gPiAtCQkgICBpbnRlbF9ncHVfZnJlcShk
ZXZfcHJpdiwgcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQpLAo+ID4gLQkJICAgaW50ZWxfZ3B1X2Zy
ZXEoZGV2X3ByaXYsIHJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0KSwKPiA+IC0JCSAgIGludGVsX2dw
dV9mcmVxKGRldl9wcml2LCBycHMtPm1heF9mcmVxKSk7Cj4gPiArCQkgICBpbnRlbF9ncHVfZnJl
cShpOTE1LCBycHMtPm1pbl9mcmVxKSwKPiA+ICsJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJw
cy0+bWluX2ZyZXFfc29mdGxpbWl0KSwKPiA+ICsJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJw
cy0+bWF4X2ZyZXFfc29mdGxpbWl0KSwKPiA+ICsJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJw
cy0+bWF4X2ZyZXEpKTsKPiA+ICAgCXNlcV9wcmludGYobSwgIiAgaWRsZTolZCwgZWZmaWNpZW50
OiVkLCBib29zdDolZFxuIiwKPiA+IC0JCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMt
PmlkbGVfZnJlcSksCj4gPiAtCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5lZmZp
Y2llbnRfZnJlcSksCj4gPiAtCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5ib29z
dF9mcmVxKSk7Cj4gPiArCQkgICBpbnRlbF9ncHVfZnJlcShpOTE1LCBycHMtPmlkbGVfZnJlcSks
Cj4gPiArCQkgICBpbnRlbF9ncHVfZnJlcShpOTE1LCBycHMtPmVmZmljaWVudF9mcmVxKSwKPiA+
ICsJCSAgIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+Ym9vc3RfZnJlcSkpOwo+ID4gICAJc2Vx
X3ByaW50ZihtLCAiV2FpdCBib29zdHM6ICVkXG4iLCBhdG9taWNfcmVhZCgmcnBzLT5ib29zdHMp
KTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNiAmJiBycHMtPmVuYWJsZWQgJiYg
ZGV2X3ByaXYtPmd0LmF3YWtlKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNiAmJiBy
cHMtPmVuYWJsZWQgJiYgaTkxNS0+Z3QuYXdha2UpIHsKPiA+ICAgCQl1MzIgcnB1cCwgcnB1cGVp
Owo+ID4gICAJCXUzMiBycGRvd24sIHJwZG93bmVpOwo+ID4gLQkJaW50ZWxfdW5jb3JlX2ZvcmNl
d2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gKwkJaW50ZWxf
dW5jb3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiAg
IAkJcnB1cCA9IEk5MTVfUkVBRF9GVyhHRU42X1JQX0NVUl9VUCkgJiBHRU42X1JQX0VJX01BU0s7
Cj4gPiAgIAkJcnB1cGVpID0gSTkxNV9SRUFEX0ZXKEdFTjZfUlBfQ1VSX1VQX0VJKSAmIEdFTjZf
UlBfRUlfTUFTSzsKPiA+ICAgCQlycGRvd24gPSBJOTE1X1JFQURfRlcoR0VONl9SUF9DVVJfRE9X
TikgJiBHRU42X1JQX0VJX01BU0s7Cj4gPiAgIAkJcnBkb3duZWkgPSBJOTE1X1JFQURfRlcoR0VO
Nl9SUF9DVVJfRE9XTl9FSSkgJiBHRU42X1JQX0VJX01BU0s7Cj4gPiAtCQlpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCQlp
bnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsK
PiA+ICAgCQlzZXFfcHJpbnRmKG0sICJcblJQUyBBdXRvdHVuaW5nIChjdXJyZW50IFwiJXNcIiB3
aW5kb3cpOlxuIiwKPiA+ICAgCQkJICAgcnBzX3Bvd2VyX3RvX3N0cihycHMtPnBvd2VyLm1vZGUp
KTsKPiA+IEBAIC0xODc1LDI5ICsxODc1LDI5IEBAIHN0YXRpYyBpbnQgaTkxNV9ycHNfYm9vc3Rf
aW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAgIHN0YXRpYyBpbnQgaTkx
NV9sbGMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsK
PiA+IC0JY29uc3QgYm9vbCBlZHJhbSA9IElOVEVMX0dFTihkZXZfcHJpdikgPiA4Owo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsK
PiA+ICsJY29uc3QgYm9vbCBlZHJhbSA9IElOVEVMX0dFTihpOTE1KSA+IDg7Cj4gPiAtCXNlcV9w
cmludGYobSwgIkxMQzogJXNcbiIsIHllc25vKEhBU19MTEMoZGV2X3ByaXYpKSk7Cj4gPiArCXNl
cV9wcmludGYobSwgIkxMQzogJXNcbiIsIHllc25vKEhBU19MTEMoaTkxNSkpKTsKPiA+ICAgCXNl
cV9wcmludGYobSwgIiVzOiAldU1CXG4iLCBlZHJhbSA/ICJlRFJBTSIgOiAiZUxMQyIsCj4gPiAt
CQkgICBkZXZfcHJpdi0+ZWRyYW1fc2l6ZV9tYik7Cj4gPiArCQkgICBpOTE1LT5lZHJhbV9zaXpl
X21iKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9odWNf
bG9hZF9zdGF0dXNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0t
PnByaXZhdGUpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9f
aTkxNShtLT5wcml2YXRlKTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJ
c3RydWN0IGRybV9wcmludGVyIHA7Cj4gPiAtCWlmICghSEFTX0hVQyhkZXZfcHJpdikpCj4gPiAr
CWlmICghSEFTX0hVQyhpOTE1KSkKPiA+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiA+ICAgCXAgPSBk
cm1fc2VxX2ZpbGVfcHJpbnRlcihtKTsKPiA+IC0JaW50ZWxfdWNfZndfZHVtcCgmZGV2X3ByaXYt
Pmh1Yy5mdywgJnApOwo+ID4gKwlpbnRlbF91Y19md19kdW1wKCZpOTE1LT5odWMuZncsICZwKTsK
PiA+IC0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKGRldl9wcml2LCB3YWtlcmVmKQo+ID4gKwl3aXRo
X2ludGVsX3J1bnRpbWVfcG0oaTkxNSwgd2FrZXJlZikKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJc
bkh1QyBzdGF0dXMgMHglMDh4OlxuIiwgSTkxNV9SRUFEKEhVQ19TVEFUVVMyKSk7Cj4gPiAgIAly
ZXR1cm4gMDsKPiA+IEBAIC0xOTA1LDE3ICsxOTA1LDE3IEBAIHN0YXRpYyBpbnQgaTkxNV9odWNf
bG9hZF9zdGF0dXNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAgIHN0
YXRpYyBpbnQgaTkxNV9ndWNfbG9hZF9zdGF0dXNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKmRhdGEpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICAgCWludGVsX3dha2VyZWZf
dCB3YWtlcmVmOwo+ID4gICAJc3RydWN0IGRybV9wcmludGVyIHA7Cj4gPiAtCWlmICghSEFTX0dV
QyhkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX0dVQyhpOTE1KSkKPiA+ICAgCQlyZXR1cm4gLUVO
T0RFVjsKPiA+ICAgCXAgPSBkcm1fc2VxX2ZpbGVfcHJpbnRlcihtKTsKPiA+IC0JaW50ZWxfdWNf
ZndfZHVtcCgmZGV2X3ByaXYtPmd1Yy5mdywgJnApOwo+ID4gKwlpbnRlbF91Y19md19kdW1wKCZp
OTE1LT5ndWMuZncsICZwKTsKPiA+IC0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKGRldl9wcml2LCB3
YWtlcmVmKSB7Cj4gPiArCXdpdGhfaW50ZWxfcnVudGltZV9wbShpOTE1LCB3YWtlcmVmKSB7Cj4g
PiAgIAkJdTMyIHRtcCA9IEk5MTVfUkVBRChHVUNfU1RBVFVTKTsKPiA+ICAgCQl1MzIgaTsKPiA+
IEBAIC0xOTU0LDkgKzE5NTQsOSBAQCBzdHJpbmdpZnlfZ3VjX2xvZ190eXBlKGVudW0gZ3VjX2xv
Z19idWZmZXJfdHlwZSB0eXBlKQo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGk5MTVfZ3VjX2xv
Z19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwKPiA+IC0JCQkgICAgICBzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArCQkJICAgICAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX2d1Y19sb2cgKmxvZyA9ICZkZXZfcHJp
di0+Z3VjLmxvZzsKPiA+ICsJc3RydWN0IGludGVsX2d1Y19sb2cgKmxvZyA9ICZpOTE1LT5ndWMu
bG9nOwo+ID4gICAJZW51bSBndWNfbG9nX2J1ZmZlcl90eXBlIHR5cGU7Cj4gPiAgIAlpZiAoIWlu
dGVsX2d1Y19sb2dfcmVsYXlfZW5hYmxlZChsb2cpKSB7Cj4gPiBAQCAtMTk3OCw3ICsxOTc4LDcg
QEAgc3RhdGljIHZvaWQgaTkxNV9ndWNfbG9nX2luZm8oc3RydWN0IHNlcV9maWxlICptLAo+ID4g
ICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGk5MTVfZ3VjX2NsaWVudF9pbmZvKHN0cnVjdCBzZXFfZmls
ZSAqbSwKPiA+IC0JCQkJIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICsJ
CQkJIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJIHN0cnVjdCBpbnRl
bF9ndWNfY2xpZW50ICpjbGllbnQpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZTsKPiA+IEBAIC0xOTkwLDcgKzE5OTAsNyBAQCBzdGF0aWMgdm9pZCBpOTE1X2d1
Y19jbGllbnRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCj4gPiAgIAlzZXFfcHJpbnRmKG0sICJc
dERvb3JiZWxsIGlkICVkLCBvZmZzZXQ6IDB4JWx4XG4iLAo+ID4gICAJCWNsaWVudC0+ZG9vcmJl
bGxfaWQsIGNsaWVudC0+ZG9vcmJlbGxfb2Zmc2V0KTsKPiA+IC0JZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgZGV2X3ByaXYsIGlkKSB7Cj4gPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUs
IGlkKSB7Cj4gPiAgIAkJdTY0IHN1Ym1pc3Npb25zID0gY2xpZW50LT5zdWJtaXNzaW9uc1tpZF07
Cj4gPiAgIAkJdG90ICs9IHN1Ym1pc3Npb25zOwo+ID4gICAJCXNlcV9wcmludGYobSwgIlx0U3Vi
bWlzc2lvbnM6ICVsbHUgJXNcbiIsCj4gPiBAQCAtMjAwMSwxNSArMjAwMSwxNSBAQCBzdGF0aWMg
dm9pZCBpOTE1X2d1Y19jbGllbnRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCj4gPiAgIHN0YXRp
YyBpbnQgaTkxNV9ndWNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwo+ID4gLQljb25zdCBzdHJ1Y3QgaW50ZWxfZ3VjICpndWMgPSAmZGV2X3By
aXYtPmd1YzsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5
MTUobS0+cHJpdmF0ZSk7Cj4gPiArCWNvbnN0IHN0cnVjdCBpbnRlbF9ndWMgKmd1YyA9ICZpOTE1
LT5ndWM7Cj4gPiAtCWlmICghVVNFU19HVUMoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIVVTRVNfR1VD
KGk5MTUpKQo+ID4gICAJCXJldHVybiAtRU5PREVWOwo+ID4gLQlpOTE1X2d1Y19sb2dfaW5mbyht
LCBkZXZfcHJpdik7Cj4gPiArCWk5MTVfZ3VjX2xvZ19pbmZvKG0sIGk5MTUpOwo+ID4gLQlpZiAo
IVVTRVNfR1VDX1NVQk1JU1NJT04oZGV2X3ByaXYpKQo+ID4gKwlpZiAoIVVTRVNfR1VDX1NVQk1J
U1NJT04oaTkxNSkpCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAgIAlHRU1fQlVHX09OKCFndWMtPmV4
ZWNidWZfY2xpZW50KTsKPiA+IEBAIC0yMDE5LDExICsyMDE5LDExIEBAIHN0YXRpYyBpbnQgaTkx
NV9ndWNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAgIAlzZXFfcHJp
bnRmKG0sICJEb29yYmVsbCBuZXh0IGNhY2hlbGluZTogMHgleFxuIiwgZ3VjLT5kYl9jYWNoZWxp
bmUpOwo+ID4gICAJc2VxX3ByaW50ZihtLCAiXG5HdUMgZXhlY2J1ZiBjbGllbnQgQCAlcDpcbiIs
IGd1Yy0+ZXhlY2J1Zl9jbGllbnQpOwo+ID4gLQlpOTE1X2d1Y19jbGllbnRfaW5mbyhtLCBkZXZf
cHJpdiwgZ3VjLT5leGVjYnVmX2NsaWVudCk7Cj4gPiArCWk5MTVfZ3VjX2NsaWVudF9pbmZvKG0s
IGk5MTUsIGd1Yy0+ZXhlY2J1Zl9jbGllbnQpOwo+ID4gICAJaWYgKGd1Yy0+cHJlZW1wdF9jbGll
bnQpIHsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJcbkd1QyBwcmVlbXB0IGNsaWVudCBAICVwOlxu
IiwKPiA+ICAgCQkJICAgZ3VjLT5wcmVlbXB0X2NsaWVudCk7Cj4gPiAtCQlpOTE1X2d1Y19jbGll
bnRfaW5mbyhtLCBkZXZfcHJpdiwgZ3VjLT5wcmVlbXB0X2NsaWVudCk7Cj4gPiArCQlpOTE1X2d1
Y19jbGllbnRfaW5mbyhtLCBpOTE1LCBndWMtPnByZWVtcHRfY2xpZW50KTsKPiA+ICAgCX0KPiA+
ICAgCS8qIEFkZCBtb3JlIGFzIHJlcXVpcmVkIC4uLiAqLwo+ID4gQEAgLTIwMzMsMTQgKzIwMzMs
MTQgQEAgc3RhdGljIGludCBpOTE1X2d1Y19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
ZGF0YSkKPiA+ICAgc3RhdGljIGludCBpOTE1X2d1Y19zdGFnZV9wb29sKHN0cnVjdCBzZXFfZmls
ZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiAtCWNvbnN0IHN0cnVjdCBp
bnRlbF9ndWMgKmd1YyA9ICZkZXZfcHJpdi0+Z3VjOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJY29uc3Qgc3RydWN0
IGludGVsX2d1YyAqZ3VjID0gJmk5MTUtPmd1YzsKPiA+ICAgCXN0cnVjdCBndWNfc3RhZ2VfZGVz
YyAqZGVzYyA9IGd1Yy0+c3RhZ2VfZGVzY19wb29sX3ZhZGRyOwo+ID4gICAJc3RydWN0IGludGVs
X2d1Y19jbGllbnQgKmNsaWVudCA9IGd1Yy0+ZXhlY2J1Zl9jbGllbnQ7Cj4gPiAgIAlpbnRlbF9l
bmdpbmVfbWFza190IHRtcDsKPiA+ICAgCWludCBpbmRleDsKPiA+IC0JaWYgKCFVU0VTX0dVQ19T
VUJNSVNTSU9OKGRldl9wcml2KSkKPiA+ICsJaWYgKCFVU0VTX0dVQ19TVUJNSVNTSU9OKGk5MTUp
KQo+ID4gICAJCXJldHVybiAtRU5PREVWOwo+ID4gICAJZm9yIChpbmRleCA9IDA7IGluZGV4IDwg
R1VDX01BWF9TVEFHRV9ERVNDUklQVE9SUzsgaW5kZXgrKywgZGVzYysrKSB7Cj4gPiBAQCAtMjA2
Niw3ICsyMDY2LDcgQEAgc3RhdGljIGludCBpOTE1X2d1Y19zdGFnZV9wb29sKHN0cnVjdCBzZXFf
ZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgCQkJICAgZGVzYy0+d3FfYWRkciwgZGVzYy0+d3Ff
c2l6ZSk7Cj4gPiAgIAkJc2VxX3B1dGMobSwgJ1xuJyk7Cj4gPiAtCQlmb3JfZWFjaF9lbmdpbmVf
bWFza2VkKGVuZ2luZSwgZGV2X3ByaXYsIGNsaWVudC0+ZW5naW5lcywgdG1wKSB7Cj4gPiArCQlm
b3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgaTkxNSwgY2xpZW50LT5lbmdpbmVzLCB0bXAp
IHsKPiA+ICAgCQkJdTMyIGd1Y19lbmdpbmVfaWQgPSBlbmdpbmUtPmd1Y19pZDsKPiA+ICAgCQkJ
c3RydWN0IGd1Y19leGVjbGlzdF9jb250ZXh0ICpscmMgPQo+ID4gICAJCQkJCQkmZGVzYy0+bHJj
W2d1Y19lbmdpbmVfaWRdOwo+ID4gQEAgLTIwODgsMTkgKzIwODgsMTkgQEAgc3RhdGljIGludCBp
OTE1X2d1Y19zdGFnZV9wb29sKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAg
c3RhdGljIGludCBpOTE1X2d1Y19sb2dfZHVtcChzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRh
dGEpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1faW5mb19ub2RlICpub2RlID0gbS0+cHJpdmF0
ZTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1
KG5vZGUpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkx
NShub2RlKTsKPiA+ICAgCWJvb2wgZHVtcF9sb2FkX2VyciA9ICEhbm9kZS0+aW5mb19lbnQtPmRh
dGE7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gTlVMTDsKPiA+ICAg
CXUzMiAqbG9nOwo+ID4gICAJaW50IGkgPSAwOwo+ID4gLQlpZiAoIUhBU19HVUMoZGV2X3ByaXYp
KQo+ID4gKwlpZiAoIUhBU19HVUMoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gPiAg
IAlpZiAoZHVtcF9sb2FkX2VycikKPiA+IC0JCW9iaiA9IGRldl9wcml2LT5ndWMubG9hZF9lcnJf
bG9nOwo+ID4gLQllbHNlIGlmIChkZXZfcHJpdi0+Z3VjLmxvZy52bWEpCj4gPiAtCQlvYmogPSBk
ZXZfcHJpdi0+Z3VjLmxvZy52bWEtPm9iajsKPiA+ICsJCW9iaiA9IGk5MTUtPmd1Yy5sb2FkX2Vy
cl9sb2c7Cj4gPiArCWVsc2UgaWYgKGk5MTUtPmd1Yy5sb2cudm1hKQo+ID4gKwkJb2JqID0gaTkx
NS0+Z3VjLmxvZy52bWEtPm9iajsKPiA+ICAgCWlmICghb2JqKQo+ID4gICAJCXJldHVybiAwOwo+
ID4gQEAgLTIxMjYsMjQgKzIxMjYsMjQgQEAgc3RhdGljIGludCBpOTE1X2d1Y19sb2dfZHVtcChz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9ndWNf
bG9nX2xldmVsX2dldCh2b2lkICpkYXRhLCB1NjQgKnZhbCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkYXRhOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IGRhdGE7Cj4gPiAtCWlmICghVVNFU19HVUMoZGV2X3ByaXYpKQo+ID4g
KwlpZiAoIVVTRVNfR1VDKGk5MTUpKQo+ID4gICAJCXJldHVybiAtRU5PREVWOwo+ID4gLQkqdmFs
ID0gaW50ZWxfZ3VjX2xvZ19nZXRfbGV2ZWwoJmRldl9wcml2LT5ndWMubG9nKTsKPiA+ICsJKnZh
bCA9IGludGVsX2d1Y19sb2dfZ2V0X2xldmVsKCZpOTE1LT5ndWMubG9nKTsKPiA+ICAgCXJldHVy
biAwOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9ndWNfbG9nX2xldmVsX3NldCh2b2lk
ICpkYXRhLCB1NjQgdmFsKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGRhdGE7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZGF0
YTsKPiA+IC0JaWYgKCFVU0VTX0dVQyhkZXZfcHJpdikpCj4gPiArCWlmICghVVNFU19HVUMoaTkx
NSkpCj4gPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gPiAtCXJldHVybiBpbnRlbF9ndWNfbG9nX3Nl
dF9sZXZlbCgmZGV2X3ByaXYtPmd1Yy5sb2csIHZhbCk7Cj4gPiArCXJldHVybiBpbnRlbF9ndWNf
bG9nX3NldF9sZXZlbCgmaTkxNS0+Z3VjLmxvZywgdmFsKTsKPiA+ICAgfQo+ID4gICBERUZJTkVf
U0lNUExFX0FUVFJJQlVURShpOTE1X2d1Y19sb2dfbGV2ZWxfZm9wcywKPiA+IEBAIC0yMTUyLDE0
ICsyMTUyLDE0IEBAIERFRklORV9TSU1QTEVfQVRUUklCVVRFKGk5MTVfZ3VjX2xvZ19sZXZlbF9m
b3BzLAo+ID4gICBzdGF0aWMgaW50IGk5MTVfZ3VjX2xvZ19yZWxheV9vcGVuKHN0cnVjdCBpbm9k
ZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGlub2RlLT5pX3ByaXZhdGU7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gaW5vZGUtPmlfcHJpdmF0ZTsKPiA+IC0JaWYgKCFVU0VTX0dV
QyhkZXZfcHJpdikpCj4gPiArCWlmICghVVNFU19HVUMoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIC1F
Tk9ERVY7Cj4gPiAtCWZpbGUtPnByaXZhdGVfZGF0YSA9ICZkZXZfcHJpdi0+Z3VjLmxvZzsKPiA+
ICsJZmlsZS0+cHJpdmF0ZV9kYXRhID0gJmk5MTUtPmd1Yy5sb2c7Cj4gPiAtCXJldHVybiBpbnRl
bF9ndWNfbG9nX3JlbGF5X29wZW4oJmRldl9wcml2LT5ndWMubG9nKTsKPiA+ICsJcmV0dXJuIGlu
dGVsX2d1Y19sb2dfcmVsYXlfb3BlbigmaTkxNS0+Z3VjLmxvZyk7Cj4gPiAgIH0KPiA+ICAgc3Rh
dGljIHNzaXplX3QKPiA+IEBAIC0yMTc3LDkgKzIxNzcsOSBAQCBpOTE1X2d1Y19sb2dfcmVsYXlf
d3JpdGUoc3RydWN0IGZpbGUgKmZpbHAsCj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9ndWNfbG9nX3Jl
bGF5X3JlbGVhc2Uoc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gaW5vZGUtPmlfcHJp
dmF0ZTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBpbm9kZS0+aV9wcml2
YXRlOwo+ID4gLQlpbnRlbF9ndWNfbG9nX3JlbGF5X2Nsb3NlKCZkZXZfcHJpdi0+Z3VjLmxvZyk7
Cj4gPiArCWludGVsX2d1Y19sb2dfcmVsYXlfY2xvc2UoJmk5MTUtPmd1Yy5sb2cpOwo+ID4gICAJ
cmV0dXJuIDA7Cj4gPiAgIH0KPiA+IEBAIC0yMjA1LDEyICsyMjA1LDEyIEBAIHN0YXRpYyBpbnQg
aTkxNV9wc3Jfc2lua19zdGF0dXNfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEp
Cj4gPiAgIAkJInNpbmsgaW50ZXJuYWwgZXJyb3IiLAo+ID4gICAJfTsKPiA+ICAgCXN0cnVjdCBk
cm1fY29ubmVjdG9yICpjb25uZWN0b3IgPSBtLT5wcml2YXRlOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPQo+ID4gICAJCWVuY190b19pbnRlbF9kcCgm
aW50ZWxfYXR0YWNoZWRfZW5jb2Rlcihjb25uZWN0b3IpLT5iYXNlKTsKPiA+ICAgCWludCByZXQ7
Cj4gPiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikpIHsKPiA+ICsJaWYgKCFDQU5fUFNSKGk5MTUp
KSB7Cj4gPiAgIAkJc2VxX3B1dHMobSwgIlBTUiBVbnN1cHBvcnRlZFxuIik7Cj4gPiAgIAkJcmV0
dXJuIC1FTk9ERVY7Cj4gPiAgIAl9Cj4gPiBAQCAtMjIzNiwxMiArMjIzNiwxMiBAQCBzdGF0aWMg
aW50IGk5MTVfcHNyX3Npbmtfc3RhdHVzX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpk
YXRhKQo+ID4gICBERUZJTkVfU0hPV19BVFRSSUJVVEUoaTkxNV9wc3Jfc2lua19zdGF0dXMpOwo+
ID4gICBzdGF0aWMgdm9pZAo+ID4gLXBzcl9zb3VyY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgc3RydWN0IHNlcV9maWxlICptKQo+ID4gK3Bzcl9zb3VyY2Vfc3Rh
dHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCj4g
PiAgIHsKPiA+ICAgCXUzMiB2YWwsIHN0YXR1c192YWw7Cj4gPiAgIAljb25zdCBjaGFyICpzdGF0
dXMgPSAidW5rbm93biI7Cj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCkgewo+
ID4gKwlpZiAoaTkxNS0+cHNyLnBzcjJfZW5hYmxlZCkgewo+ID4gICAJCXN0YXRpYyBjb25zdCBj
aGFyICogY29uc3QgbGl2ZV9zdGF0dXNbXSA9IHsKPiA+ICAgCQkJIklETEUiLAo+ID4gICAJCQki
Q0FQVFVSRSIsCj4gPiBAQCAtMjI4MywxNCArMjI4MywxNCBAQCBwc3Jfc291cmNlX3N0YXR1cyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHN0cnVjdCBzZXFfZmlsZSAqbSkKPiA+
ICAgc3RhdGljIGludCBpOTE1X2VkcF9wc3Jfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9p
ZCAqZGF0YSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiAtCXN0cnVjdCBpOTE1X3BzciAqcHNyID0g
JmRldl9wcml2LT5wc3I7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9k
ZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gKwlzdHJ1Y3QgaTkxNV9wc3IgKnBzciA9ICZpOTE1
LT5wc3I7Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCWNvbnN0IGNoYXIg
KnN0YXR1czsKPiA+ICAgCWJvb2wgZW5hYmxlZDsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAtCWlmICgh
SEFTX1BTUihkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX1BTUihpOTE1KSkKPiA+ICAgCQlyZXR1
cm4gLUVOT0RFVjsKPiA+ICAgCXNlcV9wcmludGYobSwgIlNpbmsgc3VwcG9ydDogJXMiLCB5ZXNu
byhwc3ItPnNpbmtfc3VwcG9ydCkpOwo+ID4gQEAgLTIzMDEsNyArMjMwMSw3IEBAIHN0YXRpYyBp
bnQgaTkxNV9lZHBfcHNyX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4g
PiAgIAlpZiAoIXBzci0+c2lua19zdXBwb3J0KQo+ID4gICAJCXJldHVybiAwOwo+ID4gLQl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ID4gKwl3YWtlcmVmID0gaW50
ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7Cj4gPiAgIAltdXRleF9sb2NrKCZwc3ItPmxvY2spOwo+
ID4gICAJaWYgKHBzci0+ZW5hYmxlZCkKPiA+IEBAIC0yMzIyLDE0ICsyMzIyLDE0IEBAIHN0YXRp
YyBpbnQgaTkxNV9lZHBfcHNyX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEp
Cj4gPiAgIAl9Cj4gPiAgIAlzZXFfcHJpbnRmKG0sICJTb3VyY2UgUFNSIGN0bDogJXMgWzB4JTA4
eF1cbiIsCj4gPiAgIAkJICAgZW5hYmxlZGRpc2FibGVkKGVuYWJsZWQpLCB2YWwpOwo+ID4gLQlw
c3Jfc291cmNlX3N0YXR1cyhkZXZfcHJpdiwgbSk7Cj4gPiArCXBzcl9zb3VyY2Vfc3RhdHVzKGk5
MTUsIG0pOwo+ID4gICAJc2VxX3ByaW50ZihtLCAiQnVzeSBmcm9udGJ1ZmZlciBiaXRzOiAweCUw
OHhcbiIsCj4gPiAgIAkJICAgcHNyLT5idXN5X2Zyb250YnVmZmVyX2JpdHMpOwo+ID4gICAJLyoK
PiA+ICAgCSAqIFNLTCsgUGVyZiBjb3VudGVyIGlzIHJlc2V0IHRvIDAgZXZlcnl0aW1lIERDIHN0
YXRlIGlzIGVudGVyZWQKPiA+ICAgCSAqLwo+ID4gLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikg
fHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8
fCBJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiA+ICAgCQl2YWwgPSBJOTE1X1JFQUQoRURQX1BTUl9Q
RVJGX0NOVCkgJiBFRFBfUFNSX1BFUkZfQ05UX01BU0s7Cj4gPiAgIAkJc2VxX3ByaW50ZihtLCAi
UGVyZm9ybWFuY2UgY291bnRlcjogJXVcbiIsIHZhbCk7Cj4gPiAgIAl9Cj4gPiBAQCAtMjM2NSw3
ICsyMzY1LDcgQEAgc3RhdGljIGludCBpOTE1X2VkcF9wc3Jfc3RhdHVzKHN0cnVjdCBzZXFfZmls
ZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgdW5sb2NrOgo+ID4gICAJbXV0ZXhfdW5sb2NrKCZwc3It
PmxvY2spOwo+ID4gLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7Cj4g
PiArCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOwo+ID4gICAJcmV0dXJuIDA7
Cj4gPiAgIH0KPiA+IEBAIC0yMzczLDIwICsyMzczLDIwIEBAIHN0YXRpYyBpbnQgaTkxNV9lZHBf
cHNyX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAgIHN0YXRpYyBp
bnQKPiA+ICAgaTkxNV9lZHBfcHNyX2RlYnVnX3NldCh2b2lkICpkYXRhLCB1NjQgdmFsKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRhdGE7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZGF0YTsKPiA+ICAgCWludGVsX3dha2Vy
ZWZfdCB3YWtlcmVmOwo+ID4gICAJaW50IHJldDsKPiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2
KSkKPiA+ICsJaWYgKCFDQU5fUFNSKGk5MTUpKQo+ID4gICAJCXJldHVybiAtRU5PREVWOwo+ID4g
ICAJRFJNX0RFQlVHX0tNUygiU2V0dGluZyBQU1IgZGVidWcgdG8gJWxseFxuIiwgdmFsKTsKPiA+
IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKPiA+ICsJd2FrZXJl
ZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ID4gLQlyZXQgPSBpbnRlbF9wc3JfZGVi
dWdfc2V0KGRldl9wcml2LCB2YWwpOwo+ID4gKwlyZXQgPSBpbnRlbF9wc3JfZGVidWdfc2V0KGk5
MTUsIHZhbCk7Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsK
PiA+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4g
cmV0Owo+ID4gICB9Cj4gPiBAQCAtMjM5NCwxMiArMjM5NCwxMiBAQCBpOTE1X2VkcF9wc3JfZGVi
dWdfc2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwpCj4gPiAgIHN0YXRpYyBpbnQKPiA+ICAgaTkxNV9l
ZHBfcHNyX2RlYnVnX2dldCh2b2lkICpkYXRhLCB1NjQgKnZhbCkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkYXRhOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IGRhdGE7Cj4gPiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikpCj4g
PiArCWlmICghQ0FOX1BTUihpOTE1KSkKPiA+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiA+IC0JKnZh
bCA9IFJFQURfT05DRShkZXZfcHJpdi0+cHNyLmRlYnVnKTsKPiA+ICsJKnZhbCA9IFJFQURfT05D
RShpOTE1LT5wc3IuZGVidWcpOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IEBAIC0yNDA5
LDE5ICsyNDA5LDE5IEBAIERFRklORV9TSU1QTEVfQVRUUklCVVRFKGk5MTVfZWRwX3Bzcl9kZWJ1
Z19mb3BzLAo+ID4gICBzdGF0aWMgaW50IGk5MTVfZW5lcmd5X3VKKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqZGF0YSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gICAJdW5zaWduZWQg
bG9uZyBsb25nIHBvd2VyOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAgIAl1
MzIgdW5pdHM7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNikKPiA+ICsJaWYgKElO
VEVMX0dFTihpOTE1KSA8IDYpCj4gPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gPiAgIAlpZiAocmRt
c3JsX3NhZmUoTVNSX1JBUExfUE9XRVJfVU5JVCwgJnBvd2VyKSkKPiA+ICAgCQlyZXR1cm4gLUVO
T0RFVjsKPiA+ICAgCXVuaXRzID0gKHBvd2VyICYgMHgxZjAwKSA+PiA4Owo+ID4gLQl3aXRoX2lu
dGVsX3J1bnRpbWVfcG0oZGV2X3ByaXYsIHdha2VyZWYpCj4gPiArCXdpdGhfaW50ZWxfcnVudGlt
ZV9wbShpOTE1LCB3YWtlcmVmKQo+ID4gICAJCXBvd2VyID0gSTkxNV9SRUFEKE1DSF9TRUNQX05S
R19TVFRTKTsKPiA+ICAgCXBvd2VyID0gKDEwMDAwMDAgKiBwb3dlcikgPj4gdW5pdHM7IC8qIGNv
bnZlcnQgdG8gdUogKi8KPiA+IEBAIC0yNDMyLDIxICsyNDMyLDIxIEBAIHN0YXRpYyBpbnQgaTkx
NV9lbmVyZ3lfdUooc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQo+ID4gICBzdGF0aWMg
aW50IGk5MTVfcnVudGltZV9wbV9zdGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVz
ZWQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9k
ZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9w
cml2LT5kcm0ucGRldjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2Rl
X3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+
ZHJtLnBkZXY7Cj4gPiAtCWlmICghSEFTX1JVTlRJTUVfUE0oZGV2X3ByaXYpKQo+ID4gKwlpZiAo
IUhBU19SVU5USU1FX1BNKGk5MTUpKQo+ID4gICAJCXNlcV9wdXRzKG0sICJSdW50aW1lIHBvd2Vy
IG1hbmFnZW1lbnQgbm90IHN1cHBvcnRlZFxuIik7Cj4gPiAgIAlzZXFfcHJpbnRmKG0sICJSdW50
aW1lIHBvd2VyIHN0YXR1czogJXNcbiIsCj4gPiAtCQkgICBlbmFibGVkZGlzYWJsZWQoIWRldl9w
cml2LT5wb3dlcl9kb21haW5zLndha2VyZWYpKTsKPiA+ICsJCSAgIGVuYWJsZWRkaXNhYmxlZCgh
aTkxNS0+cG93ZXJfZG9tYWlucy53YWtlcmVmKSk7Cj4gPiAtCXNlcV9wcmludGYobSwgIkdQVSBp
ZGxlOiAlc1xuIiwgeWVzbm8oIWRldl9wcml2LT5ndC5hd2FrZSkpOwo+ID4gKwlzZXFfcHJpbnRm
KG0sICJHUFUgaWRsZTogJXNcbiIsIHllc25vKCFpOTE1LT5ndC5hd2FrZSkpOwo+ID4gICAJc2Vx
X3ByaW50ZihtLCAiSVJRcyBkaXNhYmxlZDogJXNcbiIsCj4gPiAtCQkgICB5ZXNubyghaW50ZWxf
aXJxc19lbmFibGVkKGRldl9wcml2KSkpOwo+ID4gKwkJICAgeWVzbm8oIWludGVsX2lycXNfZW5h
YmxlZChpOTE1KSkpOwo+ID4gICAjaWZkZWYgQ09ORklHX1BNCj4gPiAgIAlzZXFfcHJpbnRmKG0s
ICJVc2FnZSBjb3VudDogJWRcbiIsCj4gPiAtCQkgICBhdG9taWNfcmVhZCgmZGV2X3ByaXYtPmRy
bS5kZXYtPnBvd2VyLnVzYWdlX2NvdW50KSk7Cj4gPiArCQkgICBhdG9taWNfcmVhZCgmaTkxNS0+
ZHJtLmRldi0+cG93ZXIudXNhZ2VfY291bnQpKTsKPiA+ICAgI2Vsc2UKPiA+ICAgCXNlcV9wcmlu
dGYobSwgIkRldmljZSBQb3dlciBNYW5hZ2VtZW50IChDT05GSUdfUE0pIGRpc2FibGVkXG4iKTsK
PiA+ICAgI2VuZGlmCj4gPiBAQCAtMjQ1Nyw3ICsyNDU3LDcgQEAgc3RhdGljIGludCBpOTE1X3J1
bnRpbWVfcG1fc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ID4gICAJ
aWYgKElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX1JVTlRJTUVfUE0pKSB7Cj4gPiAg
IAkJc3RydWN0IGRybV9wcmludGVyIHAgPSBkcm1fc2VxX2ZpbGVfcHJpbnRlcihtKTsKPiA+IC0J
CXByaW50X2ludGVsX3J1bnRpbWVfcG1fd2FrZXJlZihkZXZfcHJpdiwgJnApOwo+ID4gKwkJcHJp
bnRfaW50ZWxfcnVudGltZV9wbV93YWtlcmVmKGk5MTUsICZwKTsKPiA+ICAgCX0KPiA+ICAgCXJl
dHVybiAwOwo+ID4gQEAgLTI0NjUsOCArMjQ2NSw4IEBAIHN0YXRpYyBpbnQgaTkxNV9ydW50aW1l
X3BtX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiA+ICAgc3RhdGlj
IGludCBpOTE1X3Bvd2VyX2RvbWFpbl9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51
c2VkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5v
ZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+IC0Jc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAq
cG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiArCXN0
cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93ZXJfZG9t
YWluczsKPiA+ICAgCWludCBpOwo+ID4gICAJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9j
ayk7Cj4gPiBAQCAtMjQ5MywxNiArMjQ5MywxNiBAQCBzdGF0aWMgaW50IGk5MTVfcG93ZXJfZG9t
YWluX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gPiAgIHN0YXRpYyBp
bnQgaTkxNV9kbWNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUo
bS0+cHJpdmF0ZSk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90
b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfY3NyICpjc3I7Cj4gPiAtCWlmICghSEFTX0NTUihkZXZfcHJpdikpCj4g
PiArCWlmICghSEFTX0NTUihpOTE1KSkKPiA+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiA+IC0JY3Ny
ID0gJmRldl9wcml2LT5jc3I7Cj4gPiArCWNzciA9ICZpOTE1LT5jc3I7Cj4gPiAtCXdha2VyZWYg
PSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9y
dW50aW1lX3BtX2dldChpOTE1KTsKPiA+ICAgCXNlcV9wcmludGYobSwgImZ3IGxvYWRlZDogJXNc
biIsIHllc25vKGNzci0+ZG1jX3BheWxvYWQgIT0gTlVMTCkpOwo+ID4gICAJc2VxX3ByaW50Ziht
LCAicGF0aDogJXNcbiIsIGNzci0+ZndfcGF0aCk7Cj4gPiBAQCAtMjUxMywxMyArMjUxMywxMyBA
QCBzdGF0aWMgaW50IGk5MTVfZG1jX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVz
ZWQpCj4gPiAgIAlzZXFfcHJpbnRmKG0sICJ2ZXJzaW9uOiAlZC4lZFxuIiwgQ1NSX1ZFUlNJT05f
TUFKT1IoY3NyLT52ZXJzaW9uKSwKPiA+ICAgCQkgICBDU1JfVkVSU0lPTl9NSU5PUihjc3ItPnZl
cnNpb24pKTsKPiA+IC0JaWYgKFdBUk5fT04oSU5URUxfR0VOKGRldl9wcml2KSA+IDExKSkKPiA+
ICsJaWYgKFdBUk5fT04oSU5URUxfR0VOKGk5MTUpID4gMTEpKQo+ID4gICAJCWdvdG8gb3V0Owo+
ID4gICAJc2VxX3ByaW50ZihtLCAiREMzIC0+IERDNSBjb3VudDogJWRcbiIsCj4gPiAtCQkgICBJ
OTE1X1JFQUQoSVNfQlJPWFRPTihkZXZfcHJpdikgPyBCWFRfQ1NSX0RDM19EQzVfQ09VTlQgOgo+
ID4gKwkJICAgSTkxNV9SRUFEKElTX0JST1hUT04oaTkxNSkgPyBCWFRfQ1NSX0RDM19EQzVfQ09V
TlQgOgo+ID4gICAJCQkJCQkgICAgU0tMX0NTUl9EQzNfREM1X0NPVU5UKSk7Cj4gPiAtCWlmICgh
SVNfR0VOOV9MUChkZXZfcHJpdikpCj4gPiArCWlmICghSVNfR0VOOV9MUChpOTE1KSkKPiA+ICAg
CQlzZXFfcHJpbnRmKG0sICJEQzUgLT4gREM2IGNvdW50OiAlZFxuIiwKPiA+ICAgCQkJICAgSTkx
NV9SRUFEKFNLTF9DU1JfREM1X0RDNl9DT1VOVCkpOwo+ID4gQEAgLTI1MjgsNyArMjUyOCw3IEBA
IHN0YXRpYyBpbnQgaTkxNV9kbWNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNl
ZCkKPiA+ICAgCXNlcV9wcmludGYobSwgInNzcCBiYXNlOiAweCUwOHhcbiIsIEk5MTVfUkVBRChD
U1JfU1NQX0JBU0UpKTsKPiA+ICAgCXNlcV9wcmludGYobSwgImh0cDogMHglMDh4XG4iLCBJOTE1
X1JFQUQoQ1NSX0hUUF9TS0wpKTsKPiA+IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYs
IHdha2VyZWYpOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiA+
ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiBAQCAtMjU0OCw4ICsyNTQ4LDggQEAgc3RhdGljIHZv
aWQgaW50ZWxfZW5jb2Rlcl9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwKPiA+ICAgCQkJICAgICAg
IHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAo+ID4gICAJCQkgICAgICAgc3RydWN0IGlu
dGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gLQlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiA+ICAgCXN0cnVjdCBkcm1fY3J0YyAqY3J0
YyA9ICZpbnRlbF9jcnRjLT5iYXNlOwo+ID4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50
ZWxfY29ubmVjdG9yOwo+ID4gICAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwo+ID4gQEAg
LTI1NzUsOCArMjU3NSw4IEBAIHN0YXRpYyB2b2lkIGludGVsX2VuY29kZXJfaW5mbyhzdHJ1Y3Qg
c2VxX2ZpbGUgKm0sCj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2NydGNfaW5mbyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjKQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRl
KTsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsK
PiA+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZpOTE1LT5kcm07Cj4gPiAgIAlzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGMgPSAmaW50ZWxfY3J0Yy0+YmFzZTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9l
bmNvZGVyICppbnRlbF9lbmNvZGVyOwo+ID4gICAJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqcGxh
bmVfc3RhdGUgPSBjcnRjLT5wcmltYXJ5LT5zdGF0ZTsKPiA+IEBAIC0yNzMxLDggKzI3MzEsOCBA
QCBzdGF0aWMgdm9pZCBwbGFuZV9yb3RhdGlvbihjaGFyICpidWYsIHNpemVfdCBidWZzaXplLCB1
bnNpZ25lZCBpbnQgcm90YXRpb24pCj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX3BsYW5lX2luZm8o
c3RydWN0IHNlcV9maWxlICptLCBzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YykKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUo
bS0+cHJpdmF0ZSk7Cj4gPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRy
bTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+
cHJpdmF0ZSk7Cj4gPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ID4g
ICAJc3RydWN0IGludGVsX3BsYW5lICppbnRlbF9wbGFuZTsKPiA+ICAgCWZvcl9lYWNoX2ludGVs
X3BsYW5lX29uX2NydGMoZGV2LCBpbnRlbF9jcnRjLCBpbnRlbF9wbGFuZSkgewo+ID4gQEAgLTI4
MDUsMTQgKzI4MDUsMTQgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2NhbGVyX2luZm8oc3RydWN0IHNl
cV9maWxlICptLCBzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YykKPiA+ICAgc3RhdGljIGlu
dCBpOTE1X2Rpc3BsYXlfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5
MTUobS0+cHJpdmF0ZSk7Cj4gPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYt
PmRybTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUo
bS0+cHJpdmF0ZSk7Cj4gPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+
ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yOwo+ID4gICAJc3RydWN0IGRybV9jb25uZWN0b3JfbGlzdF9pdGVyIGNvbm5f
aXRlcjsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gLQl3YWtlcmVmID0gaW50
ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ID4gKwl3YWtlcmVmID0gaW50ZWxfcnVudGlt
ZV9wbV9nZXQoaTkxNSk7Cj4gPiAgIAlzZXFfcHJpbnRmKG0sICJDUlRDIGluZm9cbiIpOwo+ID4g
ICAJc2VxX3ByaW50ZihtLCAiLS0tLS0tLS0tXG4iKTsKPiA+IEBAIC0yODYxLDQyICsyODYxLDQy
IEBAIHN0YXRpYyBpbnQgaTkxNV9kaXNwbGF5X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lk
ICp1bnVzZWQpCj4gPiAgIAlkcm1fY29ubmVjdG9yX2xpc3RfaXRlcl9lbmQoJmNvbm5faXRlcik7
Cj4gPiAgIAltdXRleF91bmxvY2soJmRldi0+bW9kZV9jb25maWcubXV0ZXgpOwo+ID4gLQlpbnRl
bF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7Cj4gPiArCWludGVsX3J1bnRpbWVf
cG1fcHV0KGk5MTUsIHdha2VyZWYpOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+ICAgc3Rh
dGljIGludCBpOTE1X2VuZ2luZV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2Vk
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVf
dG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmU7Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCWVudW0gaW50
ZWxfZW5naW5lX2lkIGlkOwo+ID4gICAJc3RydWN0IGRybV9wcmludGVyIHA7Cj4gPiAtCXdha2Vy
ZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gPiArCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiA+ICAgCXNlcV9wcmludGYobSwgIkdUIGF3YWtlPyAl
cyBbJWRdXG4iLAo+ID4gLQkJICAgeWVzbm8oZGV2X3ByaXYtPmd0LmF3YWtlKSwKPiA+IC0JCSAg
IGF0b21pY19yZWFkKCZkZXZfcHJpdi0+Z3Qud2FrZXJlZi5jb3VudCkpOwo+ID4gKwkJICAgeWVz
bm8oaTkxNS0+Z3QuYXdha2UpLAo+ID4gKwkJICAgYXRvbWljX3JlYWQoJmk5MTUtPmd0Lndha2Vy
ZWYuY291bnQpKTsKPiA+ICAgCXNlcV9wcmludGYobSwgIkNTIHRpbWVzdGFtcCBmcmVxdWVuY3k6
ICV1IGtIelxuIiwKPiA+IC0JCSAgIFJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPmNzX3RpbWVzdGFt
cF9mcmVxdWVuY3lfa2h6KTsKPiA+ICsJCSAgIFJVTlRJTUVfSU5GTyhpOTE1KS0+Y3NfdGltZXN0
YW1wX2ZyZXF1ZW5jeV9raHopOwo+ID4gICAJcCA9IGRybV9zZXFfZmlsZV9wcmludGVyKG0pOwo+
ID4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCj4gPiArCWZvcl9lYWNo
X2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQo+ID4gICAJCWludGVsX2VuZ2luZV9kdW1wKGVuZ2lu
ZSwgJnAsICIlc1xuIiwgZW5naW5lLT5uYW1lKTsKPiA+IC0JaW50ZWxfcnVudGltZV9wbV9wdXQo
ZGV2X3ByaXYsIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtl
cmVmKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9yY3Nf
dG9wb2xvZ3koc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZh
dGUpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNSht
LT5wcml2YXRlKTsKPiA+ICAgCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX3NlcV9maWxlX3By
aW50ZXIobSk7Cj4gPiAtCWludGVsX2RldmljZV9pbmZvX2R1bXBfdG9wb2xvZ3koJlJVTlRJTUVf
SU5GTyhkZXZfcHJpdiktPnNzZXUsICZwKTsKPiA+ICsJaW50ZWxfZGV2aWNlX2luZm9fZHVtcF90
b3BvbG9neSgmUlVOVElNRV9JTkZPKGk5MTUpLT5zc2V1LCAmcCk7Cj4gPiAgIAlyZXR1cm4gMDsK
PiA+ICAgfQo+ID4gQEAgLTI5MTMsMTMgKzI5MTMsMTMgQEAgc3RhdGljIGludCBpOTE1X3Nocmlu
a2VyX2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCj4gPiAgIHN0YXRpYyBp
bnQgaTkxNV9zaGFyZWRfZHBsbHNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNl
ZCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2Rl
X3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2
X3ByaXYtPmRybTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3Rv
X2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+
ZHJtOwo+ID4gICAJaW50IGk7Cj4gPiAgIAlkcm1fbW9kZXNldF9sb2NrX2FsbChkZXYpOwo+ID4g
LQlmb3IgKGkgPSAwOyBpIDwgZGV2X3ByaXYtPm51bV9zaGFyZWRfZHBsbDsgaSsrKSB7Cj4gPiAt
CQlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCA9ICZkZXZfcHJpdi0+c2hhcmVkX2RwbGxz
W2ldOwo+ID4gKwlmb3IgKGkgPSAwOyBpIDwgaTkxNS0+bnVtX3NoYXJlZF9kcGxsOyBpKyspIHsK
PiA+ICsJCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsID0gJmk5MTUtPnNoYXJlZF9kcGxs
c1tpXTsKPiA+ICAgCQlzZXFfcHJpbnRmKG0sICJEUExMJWk6ICVzLCBpZDogJWlcbiIsIGksIHBs
bC0+aW5mby0+bmFtZSwKPiA+ICAgCQkJICAgcGxsLT5pbmZvLT5pZCk7Cj4gPiBAQCAtMjk3Nywy
OCArMjk3NywyOCBAQCBzdGF0aWMgaW50IGk5MTVfd2FfcmVnaXN0ZXJzKHN0cnVjdCBzZXFfZmls
ZSAqbSwgdm9pZCAqdW51c2VkKQo+ID4gICBzdGF0aWMgaW50IGk5MTVfaXBjX3N0YXR1c19zaG93
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBtLT5wcml2YXRlOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IG0tPnByaXZhdGU7Cj4gPiAgIAlzZXFfcHJpbnRmKG0sICJJc29j
aHJvbm91cyBQcmlvcml0eSBDb250cm9sOiAlc1xuIiwKPiA+IC0JCQl5ZXNubyhkZXZfcHJpdi0+
aXBjX2VuYWJsZWQpKTsKPiA+ICsJCQl5ZXNubyhpOTE1LT5pcGNfZW5hYmxlZCkpOwo+ID4gICAJ
cmV0dXJuIDA7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGludCBpOTE1X2lwY19zdGF0dXNfb3Blbihz
dHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBpbm9kZS0+aV9wcml2YXRlOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGlub2RlLT5pX3ByaXZhdGU7Cj4gPiAtCWlm
ICghSEFTX0lQQyhkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX0lQQyhpOTE1KSkKPiA+ICAgCQly
ZXR1cm4gLUVOT0RFVjsKPiA+IC0JcmV0dXJuIHNpbmdsZV9vcGVuKGZpbGUsIGk5MTVfaXBjX3N0
YXR1c19zaG93LCBkZXZfcHJpdik7Cj4gPiArCXJldHVybiBzaW5nbGVfb3BlbihmaWxlLCBpOTE1
X2lwY19zdGF0dXNfc2hvdywgaTkxNSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHNzaXplX3QgaTkx
NV9pcGNfc3RhdHVzX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLCBjb25zdCBjaGFyIF9fdXNlciAq
dWJ1ZiwKPiA+ICAgCQkJCSAgICAgc2l6ZV90IGxlbiwgbG9mZl90ICpvZmZwKQo+ID4gICB7Cj4g
PiAgIAlzdHJ1Y3Qgc2VxX2ZpbGUgKm0gPSBmaWxlLT5wcml2YXRlX2RhdGE7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG0tPnByaXZhdGU7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gbS0+cHJpdmF0ZTsKPiA+ICAgCWludGVsX3dha2VyZWZf
dCB3YWtlcmVmOwo+ID4gICAJYm9vbCBlbmFibGU7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gQEAgLTMw
MDcsMTIgKzMwMDcsMTIgQEAgc3RhdGljIHNzaXplX3QgaTkxNV9pcGNfc3RhdHVzX3dyaXRlKHN0
cnVjdCBmaWxlICpmaWxlLCBjb25zdCBjaGFyIF9fdXNlciAqdWJ1ZiwKPiA+ICAgCWlmIChyZXQg
PCAwKQo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiAtCXdpdGhfaW50ZWxfcnVudGltZV9wbShkZXZf
cHJpdiwgd2FrZXJlZikgewo+ID4gLQkJaWYgKCFkZXZfcHJpdi0+aXBjX2VuYWJsZWQgJiYgZW5h
YmxlKQo+ID4gKwl3aXRoX2ludGVsX3J1bnRpbWVfcG0oaTkxNSwgd2FrZXJlZikgewo+ID4gKwkJ
aWYgKCFpOTE1LT5pcGNfZW5hYmxlZCAmJiBlbmFibGUpCj4gPiAgIAkJCURSTV9JTkZPKCJFbmFi
bGluZyBJUEM6IFdNIHdpbGwgYmUgcHJvcGVyIG9ubHkgYWZ0ZXIgbmV4dCBjb21taXRcbiIpOwo+
ID4gLQkJZGV2X3ByaXYtPndtLmRpc3RydXN0X2Jpb3Nfd20gPSB0cnVlOwo+ID4gLQkJZGV2X3By
aXYtPmlwY19lbmFibGVkID0gZW5hYmxlOwo+ID4gLQkJaW50ZWxfZW5hYmxlX2lwYyhkZXZfcHJp
dik7Cj4gPiArCQlpOTE1LT53bS5kaXN0cnVzdF9iaW9zX3dtID0gdHJ1ZTsKPiA+ICsJCWk5MTUt
PmlwY19lbmFibGVkID0gZW5hYmxlOwo+ID4gKwkJaW50ZWxfZW5hYmxlX2lwYyhpOTE1KTsKPiA+
ICAgCX0KPiA+ICAgCXJldHVybiBsZW47Cj4gPiBAQCAtMzAyOSwxOSArMzAyOSwxOSBAQCBzdGF0
aWMgY29uc3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9ucyBpOTE1X2lwY19zdGF0dXNfZm9wcyA9IHsK
PiA+ICAgc3RhdGljIGludCBpOTE1X2RkYl9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
dW51c2VkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9
ICZkZXZfcHJpdi0+ZHJtOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5v
ZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZp
OTE1LT5kcm07Cj4gPiAgIAlzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSAqZW50cnk7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA5KQo+
ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgOSkKPiA+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiA+
ICAgCWRybV9tb2Rlc2V0X2xvY2tfYWxsKGRldik7Cj4gPiAgIAlzZXFfcHJpbnRmKG0sICIlLTE1
cyU4cyU4cyU4c1xuIiwgIiIsICJTdGFydCIsICJFbmQiLCAiU2l6ZSIpOwo+ID4gLQlmb3JfZWFj
aF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRjKSB7Cj4gPiArCWZvcl9lYWNoX2ludGVs
X2NydGMoJmk5MTUtPmRybSwgY3J0Yykgewo+ID4gICAJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlID0KPiA+ICAgCQkJdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0
YXRlKTsKPiA+ICAgCQllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiBAQCAtMzA3MCw4
ICszMDcwLDggQEAgc3RhdGljIHZvaWQgZHJyc19zdGF0dXNfcGVyX2NydGMoc3RydWN0IHNlcV9m
aWxlICptLAo+ID4gICAJCQkJIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgIAkJCQkgc3Ry
dWN0IGludGVsX2NydGMgKmludGVsX2NydGMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gLQlzdHJ1Y3QgaTkxNV9kcnJz
ICpkcnJzID0gJmRldl9wcml2LT5kcnJzOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGk5MTVfZHJycyAqZHJycyA9ICZpOTE1
LT5kcnJzOwo+ID4gICAJaW50IHZyZWZyZXNoID0gMDsKPiA+ICAgCXN0cnVjdCBkcm1fY29ubmVj
dG9yICpjb25uZWN0b3I7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXIgY29u
bl9pdGVyOwo+ID4gQEAgLTMwODUsMTEgKzMwODUsMTEgQEAgc3RhdGljIHZvaWQgZHJyc19zdGF0
dXNfcGVyX2NydGMoc3RydWN0IHNlcV9maWxlICptLAo+ID4gICAJfQo+ID4gICAJZHJtX2Nvbm5l
Y3Rvcl9saXN0X2l0ZXJfZW5kKCZjb25uX2l0ZXIpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPnZidC5k
cnJzX3R5cGUgPT0gU1RBVElDX0RSUlNfU1VQUE9SVCkKPiA+ICsJaWYgKGk5MTUtPnZidC5kcnJz
X3R5cGUgPT0gU1RBVElDX0RSUlNfU1VQUE9SVCkKPiA+ICAgCQlzZXFfcHV0cyhtLCAiXHRWQlQ6
IERSUlNfdHlwZTogU3RhdGljIik7Cj4gPiAtCWVsc2UgaWYgKGRldl9wcml2LT52YnQuZHJyc190
eXBlID09IFNFQU1MRVNTX0RSUlNfU1VQUE9SVCkKPiA+ICsJZWxzZSBpZiAoaTkxNS0+dmJ0LmRy
cnNfdHlwZSA9PSBTRUFNTEVTU19EUlJTX1NVUFBPUlQpCj4gPiAgIAkJc2VxX3B1dHMobSwgIlx0
VkJUOiBEUlJTX3R5cGU6IFNlYW1sZXNzIik7Cj4gPiAtCWVsc2UgaWYgKGRldl9wcml2LT52YnQu
ZHJyc190eXBlID09IERSUlNfTk9UX1NVUFBPUlRFRCkKPiA+ICsJZWxzZSBpZiAoaTkxNS0+dmJ0
LmRycnNfdHlwZSA9PSBEUlJTX05PVF9TVVBQT1JURUQpCj4gPiAgIAkJc2VxX3B1dHMobSwgIlx0
VkJUOiBEUlJTX3R5cGU6IE5vbmUiKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlzZXFfcHV0cyhtLCAi
XHRWQlQ6IERSUlNfdHlwZTogRklYTUU6IFVucmVjb2duaXplZCBWYWx1ZSIpOwo+ID4gQEAgLTMx
MDYsNyArMzEwNiw3IEBAIHN0YXRpYyB2b2lkIGRycnNfc3RhdHVzX3Blcl9jcnRjKHN0cnVjdCBz
ZXFfZmlsZSAqbSwKPiA+ICAgCQkvKiBkaXNhYmxlX2RycnMoKSB3aWxsIG1ha2UgZHJycy0+ZHAg
TlVMTCAqLwo+ID4gICAJCWlmICghZHJycy0+ZHApIHsKPiA+ICAgCQkJc2VxX3B1dHMobSwgIklk
bGVuZXNzIERSUlM6IERpc2FibGVkXG4iKTsKPiA+IC0JCQlpZiAoZGV2X3ByaXYtPnBzci5lbmFi
bGVkKQo+ID4gKwkJCWlmIChpOTE1LT5wc3IuZW5hYmxlZCkKPiA+ICAgCQkJCXNlcV9wdXRzKG0s
Cj4gPiAgIAkJCQkiXHRBcyBQU1IgaXMgZW5hYmxlZCwgRFJSUyBpcyBub3QgZW5hYmxlZFxuIik7
Cj4gPiAgIAkJCW11dGV4X3VubG9jaygmZHJycy0+bXV0ZXgpOwo+ID4gQEAgLTMxNDMsOCArMzE0
Myw4IEBAIHN0YXRpYyB2b2lkIGRycnNfc3RhdHVzX3Blcl9jcnRjKHN0cnVjdCBzZXFfZmlsZSAq
bSwKPiA+ICAgc3RhdGljIGludCBpOTE1X2RycnNfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwg
dm9pZCAqdW51c2VkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9ICZpOTE1LT5kcm07Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YzsKPiA+
ICAgCWludCBhY3RpdmVfY3J0Y19jbnQgPSAwOwo+ID4gQEAgLTMxNjcsOCArMzE2Nyw4IEBAIHN0
YXRpYyBpbnQgaTkxNV9kcnJzX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNl
ZCkKPiA+ICAgc3RhdGljIGludCBpOTE1X2RwX21zdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwg
dm9pZCAqdW51c2VkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9ICZpOTE1LT5kcm07Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2Rl
cjsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0Owo+ID4g
ICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcjsKPiA+IEBAIC0zMjU3LDggKzMyNTcs
OCBAQCBzdGF0aWMgc3NpemVfdCBpOTE1X2Rpc3BsYXlwb3J0X3Rlc3RfYWN0aXZlX3dyaXRlKHN0
cnVjdCBmaWxlICpmaWxlLAo+ID4gICBzdGF0aWMgaW50IGk5MTVfZGlzcGxheXBvcnRfdGVzdF9h
Y3RpdmVfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbS0+cHJpdmF0ZTsKPiA+IC0Jc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IG0tPnByaXZhdGU7Cj4gPiArCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSAmaTkxNS0+ZHJtOwo+ID4gICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcjsK
PiA+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yX2xpc3RfaXRlciBjb25uX2l0ZXI7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwOwo+ID4gQEAgLTMzMDcsOCArMzMwNyw4IEBAIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGk5MTVfZGlzcGxheXBvcnRfdGVzdF9hY3Rp
dmVfZm9wcyA9IHsKPiA+ICAgc3RhdGljIGludCBpOTE1X2Rpc3BsYXlwb3J0X3Rlc3RfZGF0YV9z
aG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBtLT5wcml2YXRlOwo+ID4gLQlzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gbS0+cHJpdmF0ZTsKPiA+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZp
OTE1LT5kcm07Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yOwo+ID4gICAJ
c3RydWN0IGRybV9jb25uZWN0b3JfbGlzdF9pdGVyIGNvbm5faXRlcjsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHA7Cj4gPiBAQCAtMzM1MSw4ICszMzUxLDggQEAgREVGSU5FX1NIT1df
QVRUUklCVVRFKGk5MTVfZGlzcGxheXBvcnRfdGVzdF9kYXRhKTsKPiA+ICAgc3RhdGljIGludCBp
OTE1X2Rpc3BsYXlwb3J0X3Rlc3RfdHlwZV9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
ZGF0YSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBt
LT5wcml2YXRlOwo+ID4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbS0+cHJpdmF0ZTsKPiA+ICsJ
c3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZpOTE1LT5kcm07Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciAqY29ubmVjdG9yOwo+ID4gICAJc3RydWN0IGRybV9jb25uZWN0b3JfbGlzdF9pdGVy
IGNvbm5faXRlcjsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHA7Cj4gPiBAQCAtMzM4
MywxOSArMzM4MywxOSBAQCBERUZJTkVfU0hPV19BVFRSSUJVVEUoaTkxNV9kaXNwbGF5cG9ydF90
ZXN0X3R5cGUpOwo+ID4gICBzdGF0aWMgdm9pZCB3bV9sYXRlbmN5X3Nob3coc3RydWN0IHNlcV9m
aWxlICptLCBjb25zdCB1MTYgd21bOF0pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gbS0+cHJpdmF0ZTsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9ICZkZXZfcHJpdi0+ZHJtOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IG0tPnByaXZhdGU7Cj4gPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+
ID4gICAJaW50IGxldmVsOwo+ID4gICAJaW50IG51bV9sZXZlbHM7Cj4gPiAtCWlmIChJU19DSEVS
UllWSUVXKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJ
bnVtX2xldmVscyA9IDM7Cj4gPiAtCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQo+
ID4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQo+ID4gICAJCW51bV9sZXZlbHMgPSAx
Owo+ID4gLQllbHNlIGlmIChJU19HNFgoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19HNFgo
aTkxNSkpCj4gPiAgIAkJbnVtX2xldmVscyA9IDM7Cj4gPiAgIAllbHNlCj4gPiAtCQludW1fbGV2
ZWxzID0gaWxrX3dtX21heF9sZXZlbChkZXZfcHJpdikgKyAxOwo+ID4gKwkJbnVtX2xldmVscyA9
IGlsa193bV9tYXhfbGV2ZWwoaTkxNSkgKyAxOwo+ID4gICAJZHJtX21vZGVzZXRfbG9ja19hbGwo
ZGV2KTsKPiA+IEBAIC0zNDA2LDEwICszNDA2LDEwIEBAIHN0YXRpYyB2b2lkIHdtX2xhdGVuY3lf
c2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIGNvbnN0IHUxNiB3bVs4XSkKPiA+ICAgCQkgKiAtIFdN
MSsgbGF0ZW5jeSB2YWx1ZXMgaW4gMC41dXMgdW5pdHMKPiA+ICAgCQkgKiAtIGxhdGVuY2llcyBh
cmUgaW4gdXMgb24gZ2VuOS92bHYvY2h2Cj4gPiAgIAkJICovCj4gPiAtCQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA5IHx8Cj4gPiAtCQkgICAgSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwK
PiA+IC0JCSAgICBJU19DSEVSUllWSUVXKGRldl9wcml2KSB8fAo+ID4gLQkJICAgIElTX0c0WChk
ZXZfcHJpdikpCj4gPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkgfHwKPiA+ICsJCSAgICBJ
U19WQUxMRVlWSUVXKGk5MTUpIHx8Cj4gPiArCQkgICAgSVNfQ0hFUlJZVklFVyhpOTE1KSB8fAo+
ID4gKwkJICAgIElTX0c0WChpOTE1KSkKPiA+ICAgCQkJbGF0ZW5jeSAqPSAxMDsKPiA+ICAgCQll
bHNlIGlmIChsZXZlbCA+IDApCj4gPiAgIAkJCWxhdGVuY3kgKj0gNTsKPiA+IEBAIC0zNDIzLDEz
ICszNDIzLDEzIEBAIHN0YXRpYyB2b2lkIHdtX2xhdGVuY3lfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0sIGNvbnN0IHUxNiB3bVs4XSkKPiA+ICAgc3RhdGljIGludCBwcmlfd21fbGF0ZW5jeV9zaG93
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBtLT5wcml2YXRlOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IG0tPnByaXZhdGU7Cj4gPiAgIAljb25zdCB1MTYgKmxhdGVuY2ll
czsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiA+IC0JCWxhdGVuY2llcyA9
IGRldl9wcml2LT53bS5za2xfbGF0ZW5jeTsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5
KQo+ID4gKwkJbGF0ZW5jaWVzID0gaTkxNS0+d20uc2tsX2xhdGVuY3k7Cj4gPiAgIAllbHNlCj4g
PiAtCQlsYXRlbmNpZXMgPSBkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3k7Cj4gPiArCQlsYXRlbmNp
ZXMgPSBpOTE1LT53bS5wcmlfbGF0ZW5jeTsKPiA+ICAgCXdtX2xhdGVuY3lfc2hvdyhtLCBsYXRl
bmNpZXMpOwo+ID4gQEAgLTM0MzgsMTMgKzM0MzgsMTMgQEAgc3RhdGljIGludCBwcmlfd21fbGF0
ZW5jeV9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgc3RhdGljIGlu
dCBzcHJfd21fbGF0ZW5jeV9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBtLT5wcml2YXRl
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG0tPnByaXZhdGU7Cj4gPiAg
IAljb25zdCB1MTYgKmxhdGVuY2llczsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
OSkKPiA+IC0JCWxhdGVuY2llcyA9IGRldl9wcml2LT53bS5za2xfbGF0ZW5jeTsKPiA+ICsJaWYg
KElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gKwkJbGF0ZW5jaWVzID0gaTkxNS0+d20uc2tsX2xh
dGVuY3k7Cj4gPiAgIAllbHNlCj4gPiAtCQlsYXRlbmNpZXMgPSBkZXZfcHJpdi0+d20uc3ByX2xh
dGVuY3k7Cj4gPiArCQlsYXRlbmNpZXMgPSBpOTE1LT53bS5zcHJfbGF0ZW5jeTsKPiA+ICAgCXdt
X2xhdGVuY3lfc2hvdyhtLCBsYXRlbmNpZXMpOwo+ID4gQEAgLTM0NTMsMTMgKzM0NTMsMTMgQEAg
c3RhdGljIGludCBzcHJfd21fbGF0ZW5jeV9zaG93KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAq
ZGF0YSkKPiA+ICAgc3RhdGljIGludCBjdXJfd21fbGF0ZW5jeV9zaG93KHN0cnVjdCBzZXFfZmls
ZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBtLT5wcml2YXRlOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IG0tPnByaXZhdGU7Cj4gPiAgIAljb25zdCB1MTYgKmxhdGVuY2llczsKPiA+IC0JaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiA+IC0JCWxhdGVuY2llcyA9IGRldl9wcml2LT53bS5z
a2xfbGF0ZW5jeTsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gKwkJbGF0ZW5j
aWVzID0gaTkxNS0+d20uc2tsX2xhdGVuY3k7Cj4gPiAgIAllbHNlCj4gPiAtCQlsYXRlbmNpZXMg
PSBkZXZfcHJpdi0+d20uY3VyX2xhdGVuY3k7Cj4gPiArCQlsYXRlbmNpZXMgPSBpOTE1LT53bS5j
dXJfbGF0ZW5jeTsKPiA+ICAgCXdtX2xhdGVuY3lfc2hvdyhtLCBsYXRlbmNpZXMpOwo+ID4gQEAg
LTM0NjgsNTQgKzM0NjgsNTQgQEAgc3RhdGljIGludCBjdXJfd21fbGF0ZW5jeV9zaG93KHN0cnVj
dCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKPiA+ICAgc3RhdGljIGludCBwcmlfd21fbGF0ZW5j
eV9vcGVuKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGlub2RlLT5pX3ByaXZhdGU7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gaW5vZGUtPmlfcHJpdmF0ZTsK
PiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA1ICYmICFJU19HNFgoZGV2X3ByaXYpKQo+
ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNSAmJiAhSVNfRzRYKGk5MTUpKQo+ID4gICAJCXJl
dHVybiAtRU5PREVWOwo+ID4gLQlyZXR1cm4gc2luZ2xlX29wZW4oZmlsZSwgcHJpX3dtX2xhdGVu
Y3lfc2hvdywgZGV2X3ByaXYpOwo+ID4gKwlyZXR1cm4gc2luZ2xlX29wZW4oZmlsZSwgcHJpX3dt
X2xhdGVuY3lfc2hvdywgaTkxNSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGludCBzcHJfd21fbGF0
ZW5jeV9vcGVuKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGlub2RlLT5pX3ByaXZh
dGU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gaW5vZGUtPmlfcHJpdmF0
ZTsKPiA+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2KSkKPiA+ICsJaWYgKEhBU19HTUNIKGk5MTUp
KQo+ID4gICAJCXJldHVybiAtRU5PREVWOwo+ID4gLQlyZXR1cm4gc2luZ2xlX29wZW4oZmlsZSwg
c3ByX3dtX2xhdGVuY3lfc2hvdywgZGV2X3ByaXYpOwo+ID4gKwlyZXR1cm4gc2luZ2xlX29wZW4o
ZmlsZSwgc3ByX3dtX2xhdGVuY3lfc2hvdywgaTkxNSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGlu
dCBjdXJfd21fbGF0ZW5jeV9vcGVuKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpm
aWxlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGlu
b2RlLT5pX3ByaXZhdGU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gaW5v
ZGUtPmlfcHJpdmF0ZTsKPiA+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2KSkKPiA+ICsJaWYgKEhB
U19HTUNIKGk5MTUpKQo+ID4gICAJCXJldHVybiAtRU5PREVWOwo+ID4gLQlyZXR1cm4gc2luZ2xl
X29wZW4oZmlsZSwgY3VyX3dtX2xhdGVuY3lfc2hvdywgZGV2X3ByaXYpOwo+ID4gKwlyZXR1cm4g
c2luZ2xlX29wZW4oZmlsZSwgY3VyX3dtX2xhdGVuY3lfc2hvdywgaTkxNSk7Cj4gPiAgIH0KPiA+
ICAgc3RhdGljIHNzaXplX3Qgd21fbGF0ZW5jeV93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwgY29u
c3QgY2hhciBfX3VzZXIgKnVidWYsCj4gPiAgIAkJCQlzaXplX3QgbGVuLCBsb2ZmX3QgKm9mZnAs
IHUxNiB3bVs4XSkKPiA+ICAgewo+ID4gICAJc3RydWN0IHNlcV9maWxlICptID0gZmlsZS0+cHJp
dmF0ZV9kYXRhOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBtLT5w
cml2YXRlOwo+ID4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbS0+cHJpdmF0ZTsKPiA+ICsJc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9ICZpOTE1LT5kcm07Cj4gPiAgIAl1MTYgbmV3WzhdID0geyAw
IH07Cj4gPiAgIAlpbnQgbnVtX2xldmVsczsKPiA+ICAgCWludCBsZXZlbDsKPiA+ICAgCWludCBy
ZXQ7Cj4gPiAgIAljaGFyIHRtcFszMl07Cj4gPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2
KSkKPiA+ICsJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJbnVtX2xldmVscyA9IDM7
Cj4gPiAtCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJ
U19WQUxMRVlWSUVXKGk5MTUpKQo+ID4gICAJCW51bV9sZXZlbHMgPSAxOwo+ID4gLQllbHNlIGlm
IChJU19HNFgoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19HNFgoaTkxNSkpCj4gPiAgIAkJ
bnVtX2xldmVscyA9IDM7Cj4gPiAgIAllbHNlCj4gPiAtCQludW1fbGV2ZWxzID0gaWxrX3dtX21h
eF9sZXZlbChkZXZfcHJpdikgKyAxOwo+ID4gKwkJbnVtX2xldmVscyA9IGlsa193bV9tYXhfbGV2
ZWwoaTkxNSkgKyAxOwo+ID4gICAJaWYgKGxlbiA+PSBzaXplb2YodG1wKSkKPiA+ICAgCQlyZXR1
cm4gLUVJTlZBTDsKPiA+IEBAIC0zNTQ2LDEzICszNTQ2LDEzIEBAIHN0YXRpYyBzc2l6ZV90IHBy
aV93bV9sYXRlbmN5X3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLCBjb25zdCBjaGFyIF9fdXNlciAq
dWJ1ZiwKPiA+ICAgCQkJCSAgICBzaXplX3QgbGVuLCBsb2ZmX3QgKm9mZnApCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBzZXFfZmlsZSAqbSA9IGZpbGUtPnByaXZhdGVfZGF0YTsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbS0+cHJpdmF0ZTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBtLT5wcml2YXRlOwo+ID4gICAJdTE2ICpsYXRlbmNpZXM7
Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiAtCQlsYXRlbmNpZXMgPSBk
ZXZfcHJpdi0+d20uc2tsX2xhdGVuY3k7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkK
PiA+ICsJCWxhdGVuY2llcyA9IGk5MTUtPndtLnNrbF9sYXRlbmN5Owo+ID4gICAJZWxzZQo+ID4g
LQkJbGF0ZW5jaWVzID0gZGV2X3ByaXYtPndtLnByaV9sYXRlbmN5Owo+ID4gKwkJbGF0ZW5jaWVz
ID0gaTkxNS0+d20ucHJpX2xhdGVuY3k7Cj4gPiAgIAlyZXR1cm4gd21fbGF0ZW5jeV93cml0ZShm
aWxlLCB1YnVmLCBsZW4sIG9mZnAsIGxhdGVuY2llcyk7Cj4gPiAgIH0KPiA+IEBAIC0zNTYxLDEz
ICszNTYxLDEzIEBAIHN0YXRpYyBzc2l6ZV90IHNwcl93bV9sYXRlbmN5X3dyaXRlKHN0cnVjdCBm
aWxlICpmaWxlLCBjb25zdCBjaGFyIF9fdXNlciAqdWJ1ZiwKPiA+ICAgCQkJCSAgICBzaXplX3Qg
bGVuLCBsb2ZmX3QgKm9mZnApCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBzZXFfZmlsZSAqbSA9IGZp
bGUtPnByaXZhdGVfZGF0YTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gbS0+cHJpdmF0ZTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBtLT5w
cml2YXRlOwo+ID4gICAJdTE2ICpsYXRlbmNpZXM7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDkpCj4gPiAtCQlsYXRlbmNpZXMgPSBkZXZfcHJpdi0+d20uc2tsX2xhdGVuY3k7Cj4g
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiA+ICsJCWxhdGVuY2llcyA9IGk5MTUtPndt
LnNrbF9sYXRlbmN5Owo+ID4gICAJZWxzZQo+ID4gLQkJbGF0ZW5jaWVzID0gZGV2X3ByaXYtPndt
LnNwcl9sYXRlbmN5Owo+ID4gKwkJbGF0ZW5jaWVzID0gaTkxNS0+d20uc3ByX2xhdGVuY3k7Cj4g
PiAgIAlyZXR1cm4gd21fbGF0ZW5jeV93cml0ZShmaWxlLCB1YnVmLCBsZW4sIG9mZnAsIGxhdGVu
Y2llcyk7Cj4gPiAgIH0KPiA+IEBAIC0zNTc2LDEzICszNTc2LDEzIEBAIHN0YXRpYyBzc2l6ZV90
IGN1cl93bV9sYXRlbmN5X3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLCBjb25zdCBjaGFyIF9fdXNl
ciAqdWJ1ZiwKPiA+ICAgCQkJCSAgICBzaXplX3QgbGVuLCBsb2ZmX3QgKm9mZnApCj4gPiAgIHsK
PiA+ICAgCXN0cnVjdCBzZXFfZmlsZSAqbSA9IGZpbGUtPnByaXZhdGVfZGF0YTsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbS0+cHJpdmF0ZTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBtLT5wcml2YXRlOwo+ID4gICAJdTE2ICpsYXRlbmNp
ZXM7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiAtCQlsYXRlbmNpZXMg
PSBkZXZfcHJpdi0+d20uc2tsX2xhdGVuY3k7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0g
OSkKPiA+ICsJCWxhdGVuY2llcyA9IGk5MTUtPndtLnNrbF9sYXRlbmN5Owo+ID4gICAJZWxzZQo+
ID4gLQkJbGF0ZW5jaWVzID0gZGV2X3ByaXYtPndtLmN1cl9sYXRlbmN5Owo+ID4gKwkJbGF0ZW5j
aWVzID0gaTkxNS0+d20uY3VyX2xhdGVuY3k7Cj4gPiAgIAlyZXR1cm4gd21fbGF0ZW5jeV93cml0
ZShmaWxlLCB1YnVmLCBsZW4sIG9mZnAsIGxhdGVuY2llcyk7Cj4gPiAgIH0KPiA+IEBAIC0zNzUy
LDE0ICszNzUyLDE0IEBAIERFRklORV9TSU1QTEVfQVRUUklCVVRFKGk5MTVfZHJvcF9jYWNoZXNf
Zm9wcywKPiA+ICAgc3RhdGljIGludAo+ID4gICBpOTE1X2NhY2hlX3NoYXJpbmdfZ2V0KHZvaWQg
KmRhdGEsIHU2NCAqdmFsKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGRhdGE7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZGF0
YTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJdTMyIHNucGNyID0gMDsK
PiA+IC0JaWYgKCEoSVNfR0VOX1JBTkdFKGRldl9wcml2LCA2LCA3KSkpCj4gPiArCWlmICghKElT
X0dFTl9SQU5HRShpOTE1LCA2LCA3KSkpCj4gPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gPiAtCXdp
dGhfaW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJlZikKPiA+ICsJd2l0aF9pbnRlbF9y
dW50aW1lX3BtKGk5MTUsIHdha2VyZWYpCj4gPiAgIAkJc25wY3IgPSBJOTE1X1JFQUQoR0VONl9N
QkNVTklUX1NOUENSKTsKPiA+ICAgCSp2YWwgPSAoc25wY3IgJiBHRU42X01CQ19TTlBDUl9NQVNL
KSA+PiBHRU42X01CQ19TTlBDUl9TSElGVDsKPiA+IEBAIC0zNzcwLDE3ICszNzcwLDE3IEBAIGk5
MTVfY2FjaGVfc2hhcmluZ19nZXQodm9pZCAqZGF0YSwgdTY0ICp2YWwpCj4gPiAgIHN0YXRpYyBp
bnQKPiA+ICAgaTkxNV9jYWNoZV9zaGFyaW5nX3NldCh2b2lkICpkYXRhLCB1NjQgdmFsKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRhdGE7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZGF0YTsKPiA+ICAgCWludGVsX3dha2Vy
ZWZfdCB3YWtlcmVmOwo+ID4gLQlpZiAoIShJU19HRU5fUkFOR0UoZGV2X3ByaXYsIDYsIDcpKSkK
PiA+ICsJaWYgKCEoSVNfR0VOX1JBTkdFKGk5MTUsIDYsIDcpKSkKPiA+ICAgCQlyZXR1cm4gLUVO
T0RFVjsKPiA+ICAgCWlmICh2YWwgPiAzKQo+ID4gICAJCXJldHVybiAtRUlOVkFMOwo+ID4gICAJ
RFJNX0RFQlVHX0RSSVZFUigiTWFudWFsbHkgc2V0dGluZyB1bmNvcmUgc2hhcmluZyB0byAlbGx1
XG4iLCB2YWwpOwo+ID4gLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oZGV2X3ByaXYsIHdha2VyZWYp
IHsKPiA+ICsJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGk5MTUsIHdha2VyZWYpIHsKPiA+ICAgCQl1
MzIgc25wY3I7Cj4gPiAgIAkJLyogVXBkYXRlIHRoZSBjYWNoZSBzaGFyaW5nIHBvbGljeSBoZXJl
IGFzIHdlbGwgKi8KPiA+IEBAIC0zNzk3LDcgKzM3OTcsNyBAQCBERUZJTkVfU0lNUExFX0FUVFJJ
QlVURShpOTE1X2NhY2hlX3NoYXJpbmdfZm9wcywKPiA+ICAgCQkJaTkxNV9jYWNoZV9zaGFyaW5n
X2dldCwgaTkxNV9jYWNoZV9zaGFyaW5nX3NldCwKPiA+ICAgCQkJIiVsbHVcbiIpOwo+ID4gLXN0
YXRpYyB2b2lkIGNoZXJyeXZpZXdfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBjaGVycnl2aWV3X3NzZXVfZGV2aWNl
X3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgIHN0cnVj
dCBzc2V1X2Rldl9pbmZvICpzc2V1KQo+ID4gICB7Cj4gPiAgICNkZWZpbmUgU1NfTUFYIDIKPiA+
IEBAIC0zODMwLDExICszODMwLDExIEBAIHN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfc3NldV9kZXZp
Y2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgI3VuZGVm
IFNTX01BWAo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuMTBfc3NldV9kZXZpY2Vfc3RhdHVz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBnZW4x
MF9zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAg
IAkJCQkgICAgIHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1KQo+ID4gICB7Cj4gPiAgICNkZWZp
bmUgU1NfTUFYIDYKPiA+IC0JY29uc3Qgc3RydWN0IGludGVsX3J1bnRpbWVfaW5mbyAqaW5mbyA9
IFJVTlRJTUVfSU5GTyhkZXZfcHJpdik7Cj4gPiArCWNvbnN0IHN0cnVjdCBpbnRlbF9ydW50aW1l
X2luZm8gKmluZm8gPSBSVU5USU1FX0lORk8oaTkxNSk7Cj4gPiAgIAl1MzIgc19yZWdbU1NfTUFY
XSwgZXVfcmVnWzIgKiBTU19NQVhdLCBldV9tYXNrWzJdOwo+ID4gICAJaW50IHMsIHNzOwo+ID4g
QEAgLTM4ODYsMTEgKzM4ODYsMTEgQEAgc3RhdGljIHZvaWQgZ2VuMTBfc3NldV9kZXZpY2Vfc3Rh
dHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgI3VuZGVmIFNTX01B
WAo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuOV9zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGdlbjlfc3NldV9k
ZXZpY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAg
IHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1KQo+ID4gICB7Cj4gPiAgICNkZWZpbmUgU1NfTUFY
IDMKPiA+IC0JY29uc3Qgc3RydWN0IGludGVsX3J1bnRpbWVfaW5mbyAqaW5mbyA9IFJVTlRJTUVf
SU5GTyhkZXZfcHJpdik7Cj4gPiArCWNvbnN0IHN0cnVjdCBpbnRlbF9ydW50aW1lX2luZm8gKmlu
Zm8gPSBSVU5USU1FX0lORk8oaTkxNSk7Cj4gPiAgIAl1MzIgc19yZWdbU1NfTUFYXSwgZXVfcmVn
WzIgKiBTU19NQVhdLCBldV9tYXNrWzJdOwo+ID4gICAJaW50IHMsIHNzOwo+ID4gQEAgLTM5MTYs
MTQgKzM5MTYsMTQgQEAgc3RhdGljIHZvaWQgZ2VuOV9zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCXNzZXUtPnNsaWNlX21hc2sgfD0g
QklUKHMpOwo+ID4gLQkJaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKQo+ID4gKwkJaWYgKElTX0dF
TjlfQkMoaTkxNSkpCj4gPiAgIAkJCXNzZXUtPnN1YnNsaWNlX21hc2tbc10gPQo+ID4gLQkJCQlS
VU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1LnN1YnNsaWNlX21hc2tbc107Cj4gPiArCQkJCVJV
TlRJTUVfSU5GTyhpOTE1KS0+c3NldS5zdWJzbGljZV9tYXNrW3NdOwo+ID4gICAJCWZvciAoc3Mg
PSAwOyBzcyA8IGluZm8tPnNzZXUubWF4X3N1YnNsaWNlczsgc3MrKykgewo+ID4gICAJCQl1bnNp
Z25lZCBpbnQgZXVfY250Owo+ID4gLQkJCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewo+ID4g
KwkJCWlmIChJU19HRU45X0xQKGk5MTUpKSB7Cj4gPiAgIAkJCQlpZiAoIShzX3JlZ1tzXSAmIChH
RU45X1BHQ1RMX1NTX0FDSyhzcykpKSkKPiA+ICAgCQkJCQkvKiBza2lwIGRpc2FibGVkIHN1YnNs
aWNlICovCj4gPiAgIAkJCQkJY29udGludWU7Cj4gPiBAQCAtMzk0Miw3ICszOTQyLDcgQEAgc3Rh
dGljIHZvaWQgZ2VuOV9zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gICAjdW5kZWYgU1NfTUFYCj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBi
cm9hZHdlbGxfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBicm9hZHdlbGxfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJCSBzdHJ1Y3Qgc3NldV9kZXZfaW5m
byAqc3NldSkKPiA+ICAgewo+ID4gICAJdTMyIHNsaWNlX2luZm8gPSBJOTE1X1JFQUQoR0VOOF9H
VF9TTElDRV9JTkZPKTsKPiA+IEBAIC0zOTUyLDEwICszOTUyLDEwIEBAIHN0YXRpYyB2b2lkIGJy
b2Fkd2VsbF9zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gICAJaWYgKHNzZXUtPnNsaWNlX21hc2spIHsKPiA+ICAgCQlzc2V1LT5ldV9wZXJf
c3Vic2xpY2UgPQo+ID4gLQkJCVJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPnNzZXUuZXVfcGVyX3N1
YnNsaWNlOwo+ID4gKwkJCVJVTlRJTUVfSU5GTyhpOTE1KS0+c3NldS5ldV9wZXJfc3Vic2xpY2U7
Cj4gPiAgIAkJZm9yIChzID0gMDsgcyA8IGZscyhzc2V1LT5zbGljZV9tYXNrKTsgcysrKSB7Cj4g
PiAgIAkJCXNzZXUtPnN1YnNsaWNlX21hc2tbc10gPQo+ID4gLQkJCQlSVU5USU1FX0lORk8oZGV2
X3ByaXYpLT5zc2V1LnN1YnNsaWNlX21hc2tbc107Cj4gPiArCQkJCVJVTlRJTUVfSU5GTyhpOTE1
KS0+c3NldS5zdWJzbGljZV9tYXNrW3NdOwo+ID4gICAJCX0KPiA+ICAgCQlzc2V1LT5ldV90b3Rh
bCA9IHNzZXUtPmV1X3Blcl9zdWJzbGljZSAqCj4gPiAgIAkJCQkgaW50ZWxfc3NldV9zdWJzbGlj
ZV90b3RhbChzc2V1KTsKPiA+IEBAIC0zOTYzLDcgKzM5NjMsNyBAQCBzdGF0aWMgdm9pZCBicm9h
ZHdlbGxfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgCQkvKiBzdWJ0cmFjdCBmdXNlZCBvZmYgRVUocykgZnJvbSBlbmFibGVkIHNsaWNl
KHMpICovCj4gPiAgIAkJZm9yIChzID0gMDsgcyA8IGZscyhzc2V1LT5zbGljZV9tYXNrKTsgcysr
KSB7Cj4gPiAgIAkJCXU4IHN1YnNsaWNlXzdldSA9Cj4gPiAtCQkJCVJVTlRJTUVfSU5GTyhkZXZf
cHJpdiktPnNzZXUuc3Vic2xpY2VfN2V1W3NdOwo+ID4gKwkJCQlSVU5USU1FX0lORk8oaTkxNSkt
PnNzZXUuc3Vic2xpY2VfN2V1W3NdOwo+ID4gICAJCQlzc2V1LT5ldV90b3RhbCAtPSBod2VpZ2h0
OChzdWJzbGljZV83ZXUpOwo+ID4gICAJCX0KPiA+IEBAIC0zOTczLDcgKzM5NzMsNyBAQCBzdGF0
aWMgdm9pZCBicm9hZHdlbGxfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICAgc3RhdGljIHZvaWQgaTkxNV9wcmludF9zc2V1X2luZm8oc3Ry
dWN0IHNlcV9maWxlICptLCBib29sIGlzX2F2YWlsYWJsZV9pbmZvLAo+ID4gICAJCQkJIGNvbnN0
IHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4g
PiAgIAljb25zdCBjaGFyICp0eXBlID0gaXNfYXZhaWxhYmxlX2luZm8gPyAiQXZhaWxhYmxlIiA6
ICJFbmFibGVkIjsKPiA+ICAgCWludCBzOwo+ID4gQEAgLTM5OTUsOCArMzk5NSw4IEBAIHN0YXRp
YyB2b2lkIGk5MTVfcHJpbnRfc3NldV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgYm9vbCBpc19h
dmFpbGFibGVfaW5mbywKPiA+ICAgCWlmICghaXNfYXZhaWxhYmxlX2luZm8pCj4gPiAgIAkJcmV0
dXJuOwo+ID4gLQlzZXFfcHJpbnRmKG0sICIgIEhhcyBQb29sZWQgRVU6ICVzXG4iLCB5ZXNubyhI
QVNfUE9PTEVEX0VVKGRldl9wcml2KSkpOwo+ID4gLQlpZiAoSEFTX1BPT0xFRF9FVShkZXZfcHJp
dikpCj4gPiArCXNlcV9wcmludGYobSwgIiAgSGFzIFBvb2xlZCBFVTogJXNcbiIsIHllc25vKEhB
U19QT09MRURfRVUoaTkxNSkpKTsKPiA+ICsJaWYgKEhBU19QT09MRURfRVUoaTkxNSkpCj4gPiAg
IAkJc2VxX3ByaW50ZihtLCAiICBNaW4gRVUgaW4gcG9vbDogJXVcbiIsIHNzZXUtPm1pbl9ldV9p
bl9wb29sKTsKPiA+ICAgCXNlcV9wcmludGYobSwgIiAgSGFzIFNsaWNlIFBvd2VyIEdhdGluZzog
JXNcbiIsCj4gPiBAQCAtNDAwOSwzMiArNDAwOSwzMiBAQCBzdGF0aWMgdm9pZCBpOTE1X3ByaW50
X3NzZXVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIGJvb2wgaXNfYXZhaWxhYmxlX2luZm8sCj4g
PiAgIHN0YXRpYyBpbnQgaTkxNV9zc2V1X3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQg
KnVudXNlZCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwo+ID4gICAJc3RydWN0IHNzZXVfZGV2
X2luZm8gc3NldTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA8IDgpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA4KQo+ID4g
ICAJCXJldHVybiAtRU5PREVWOwo+ID4gICAJc2VxX3B1dHMobSwgIlNTRVUgRGV2aWNlIEluZm9c
biIpOwo+ID4gLQlpOTE1X3ByaW50X3NzZXVfaW5mbyhtLCB0cnVlLCAmUlVOVElNRV9JTkZPKGRl
dl9wcml2KS0+c3NldSk7Cj4gPiArCWk5MTVfcHJpbnRfc3NldV9pbmZvKG0sIHRydWUsICZSVU5U
SU1FX0lORk8oaTkxNSktPnNzZXUpOwo+ID4gICAJc2VxX3B1dHMobSwgIlNTRVUgRGV2aWNlIFN0
YXR1c1xuIik7Cj4gPiAgIAltZW1zZXQoJnNzZXUsIDAsIHNpemVvZihzc2V1KSk7Cj4gPiAtCXNz
ZXUubWF4X3NsaWNlcyA9IFJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPnNzZXUubWF4X3NsaWNlczsK
PiA+IC0Jc3NldS5tYXhfc3Vic2xpY2VzID0gUlVOVElNRV9JTkZPKGRldl9wcml2KS0+c3NldS5t
YXhfc3Vic2xpY2VzOwo+ID4gKwlzc2V1Lm1heF9zbGljZXMgPSBSVU5USU1FX0lORk8oaTkxNSkt
PnNzZXUubWF4X3NsaWNlczsKPiA+ICsJc3NldS5tYXhfc3Vic2xpY2VzID0gUlVOVElNRV9JTkZP
KGk5MTUpLT5zc2V1Lm1heF9zdWJzbGljZXM7Cj4gPiAgIAlzc2V1Lm1heF9ldXNfcGVyX3N1YnNs
aWNlID0KPiA+IC0JCVJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPnNzZXUubWF4X2V1c19wZXJfc3Vi
c2xpY2U7Cj4gPiAtCj4gPiAtCXdpdGhfaW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJl
Zikgewo+ID4gLQkJaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gLQkJCWNoZXJyeXZp
ZXdfc3NldV9kZXZpY2Vfc3RhdHVzKGRldl9wcml2LCAmc3NldSk7Cj4gPiAtCQllbHNlIGlmIChJ
U19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ID4gLQkJCWJyb2Fkd2VsbF9zc2V1X2RldmljZV9zdGF0
dXMoZGV2X3ByaXYsICZzc2V1KTsKPiA+IC0JCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgOSkp
Cj4gPiAtCQkJZ2VuOV9zc2V1X2RldmljZV9zdGF0dXMoZGV2X3ByaXYsICZzc2V1KTsKPiA+IC0J
CWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApCj4gPiAtCQkJZ2VuMTBfc3NldV9k
ZXZpY2Vfc3RhdHVzKGRldl9wcml2LCAmc3NldSk7Cj4gPiArCQlSVU5USU1FX0lORk8oaTkxNSkt
PnNzZXUubWF4X2V1c19wZXJfc3Vic2xpY2U7Cj4gPiArCj4gPiArCXdpdGhfaW50ZWxfcnVudGlt
ZV9wbShpOTE1LCB3YWtlcmVmKSB7Cj4gPiArCQlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+
ICsJCQljaGVycnl2aWV3X3NzZXVfZGV2aWNlX3N0YXR1cyhpOTE1LCAmc3NldSk7Cj4gPiArCQll
bHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpCj4gPiArCQkJYnJvYWR3ZWxsX3NzZXVfZGV2aWNl
X3N0YXR1cyhpOTE1LCAmc3NldSk7Cj4gPiArCQllbHNlIGlmIChJU19HRU4oaTkxNSwgOSkpCj4g
PiArCQkJZ2VuOV9zc2V1X2RldmljZV9zdGF0dXMoaTkxNSwgJnNzZXUpOwo+ID4gKwkJZWxzZSBp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDEwKQo+ID4gKwkJCWdlbjEwX3NzZXVfZGV2aWNlX3N0YXR1
cyhpOTE1LCAmc3NldSk7Cj4gPiAgIAl9Cj4gPiAgIAlpOTE1X3ByaW50X3NzZXVfaW5mbyhtLCBm
YWxzZSwgJnNzZXUpOwo+ID4gQEAgLTQwNzcsMTUgKzQwNzcsMTUgQEAgc3RhdGljIGNvbnN0IHN0
cnVjdCBmaWxlX29wZXJhdGlvbnMgaTkxNV9mb3JjZXdha2VfZm9wcyA9IHsKPiA+ICAgc3RhdGlj
IGludCBpOTE1X2hwZF9zdG9ybV9jdGxfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRh
dGEpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbS0+
cHJpdmF0ZTsKPiA+IC0Jc3RydWN0IGk5MTVfaG90cGx1ZyAqaG90cGx1ZyA9ICZkZXZfcHJpdi0+
aG90cGx1ZzsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBtLT5wcml2YXRl
Owo+ID4gKwlzdHJ1Y3QgaTkxNV9ob3RwbHVnICpob3RwbHVnID0gJmk5MTUtPmhvdHBsdWc7Cj4g
PiAgIAkvKiBTeW5jaHJvbml6ZSB3aXRoIGV2ZXJ5dGhpbmcgZmlyc3QgaW4gY2FzZSB0aGVyZSdz
IGJlZW4gYW4gSFBECj4gPiAgIAkgKiBzdG9ybSwgYnV0IHdlIGhhdmVuJ3QgZmluaXNoZWQgaGFu
ZGxpbmcgaXQgaW4gdGhlIGtlcm5lbCB5ZXQKPiA+ICAgCSAqLwo+ID4gLQlzeW5jaHJvbml6ZV9p
cnEoZGV2X3ByaXYtPmRybS5pcnEpOwo+ID4gLQlmbHVzaF93b3JrKCZkZXZfcHJpdi0+aG90cGx1
Zy5kaWdfcG9ydF93b3JrKTsKPiA+IC0JZmx1c2hfd29yaygmZGV2X3ByaXYtPmhvdHBsdWcuaG90
cGx1Z193b3JrKTsKPiA+ICsJc3luY2hyb25pemVfaXJxKGk5MTUtPmRybS5pcnEpOwo+ID4gKwlm
bHVzaF93b3JrKCZpOTE1LT5ob3RwbHVnLmRpZ19wb3J0X3dvcmspOwo+ID4gKwlmbHVzaF93b3Jr
KCZpOTE1LT5ob3RwbHVnLmhvdHBsdWdfd29yayk7Cj4gPiAgIAlzZXFfcHJpbnRmKG0sICJUaHJl
c2hvbGQ6ICVkXG4iLCBob3RwbHVnLT5ocGRfc3Rvcm1fdGhyZXNob2xkKTsKPiA+ICAgCXNlcV9w
cmludGYobSwgIkRldGVjdGVkOiAlc1xuIiwKPiA+IEBAIC00MDk5LDggKzQwOTksOCBAQCBzdGF0
aWMgc3NpemVfdCBpOTE1X2hwZF9zdG9ybV9jdGxfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCj4g
PiAgIAkJCQkJbG9mZl90ICpvZmZwKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3Qgc2VxX2ZpbGUgKm0g
PSBmaWxlLT5wcml2YXRlX2RhdGE7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IG0tPnByaXZhdGU7Cj4gPiAtCXN0cnVjdCBpOTE1X2hvdHBsdWcgKmhvdHBsdWcgPSAm
ZGV2X3ByaXYtPmhvdHBsdWc7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
bS0+cHJpdmF0ZTsKPiA+ICsJc3RydWN0IGk5MTVfaG90cGx1ZyAqaG90cGx1ZyA9ICZpOTE1LT5o
b3RwbHVnOwo+ID4gICAJdW5zaWduZWQgaW50IG5ld190aHJlc2hvbGQ7Cj4gPiAgIAlpbnQgaTsK
PiA+ICAgCWNoYXIgKm5ld2xpbmU7Cj4gPiBAQCAtNDEzMCwxNSArNDEzMCwxNSBAQCBzdGF0aWMg
c3NpemVfdCBpOTE1X2hwZF9zdG9ybV9jdGxfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCj4gPiAg
IAllbHNlCj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiRGlzYWJsaW5nIEhQRCBzdG9ybSBkZXRlY3Rp
b25cbiIpOwo+ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlz
cGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAgIAlob3RwbHVnLT5ocGRfc3Rvcm1f
dGhyZXNob2xkID0gbmV3X3RocmVzaG9sZDsKPiA+ICAgCS8qIFJlc2V0IHRoZSBIUEQgc3Rvcm0g
c3RhdHMgc28gd2UgZG9uJ3QgYWNjaWRlbnRhbGx5IHRyaWdnZXIgYSBzdG9ybSAqLwo+ID4gICAJ
Zm9yX2VhY2hfaHBkX3BpbihpKQo+ID4gICAJCWhvdHBsdWctPnN0YXRzW2ldLmNvdW50ID0gMDsK
PiA+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGluX3Vu
bG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICAgCS8qIFJlLWVuYWJsZSBocGQgaW1tZWRp
YXRlbHkgaWYgd2Ugd2VyZSBpbiBhbiBpcnEgc3Rvcm0gKi8KPiA+IC0JZmx1c2hfZGVsYXllZF93
b3JrKCZkZXZfcHJpdi0+aG90cGx1Zy5yZWVuYWJsZV93b3JrKTsKPiA+ICsJZmx1c2hfZGVsYXll
ZF93b3JrKCZpOTE1LT5ob3RwbHVnLnJlZW5hYmxlX3dvcmspOwo+ID4gICAJcmV0dXJuIGxlbjsK
PiA+ICAgfQo+ID4gQEAgLTQxNTksMTAgKzQxNTksMTAgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBm
aWxlX29wZXJhdGlvbnMgaTkxNV9ocGRfc3Rvcm1fY3RsX2ZvcHMgPSB7Cj4gPiAgIHN0YXRpYyBp
bnQgaTkxNV9ocGRfc2hvcnRfc3Rvcm1fY3RsX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lk
ICpkYXRhKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IG0tPnByaXZhdGU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbS0+cHJp
dmF0ZTsKPiA+ICAgCXNlcV9wcmludGYobSwgIkVuYWJsZWQ6ICVzXG4iLAo+ID4gLQkJICAgeWVz
bm8oZGV2X3ByaXYtPmhvdHBsdWcuaHBkX3Nob3J0X3N0b3JtX2VuYWJsZWQpKTsKPiA+ICsJCSAg
IHllc25vKGk5MTUtPmhvdHBsdWcuaHBkX3Nob3J0X3N0b3JtX2VuYWJsZWQpKTsKPiA+ICAgCXJl
dHVybiAwOwo+ID4gICB9Cj4gPiBAQCAtNDE3OSw4ICs0MTc5LDggQEAgc3RhdGljIHNzaXplX3Qg
aTkxNV9ocGRfc2hvcnRfc3Rvcm1fY3RsX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAo+ID4gICAJ
CQkJCSAgICAgIHNpemVfdCBsZW4sIGxvZmZfdCAqb2ZmcCkKPiA+ICAgewo+ID4gICAJc3RydWN0
IHNlcV9maWxlICptID0gZmlsZS0+cHJpdmF0ZV9kYXRhOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBtLT5wcml2YXRlOwo+ID4gLQlzdHJ1Y3QgaTkxNV9ob3RwbHVn
ICpob3RwbHVnID0gJmRldl9wcml2LT5ob3RwbHVnOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IG0tPnByaXZhdGU7Cj4gPiArCXN0cnVjdCBpOTE1X2hvdHBsdWcgKmhvdHBs
dWcgPSAmaTkxNS0+aG90cGx1ZzsKPiA+ICAgCWNoYXIgKm5ld2xpbmU7Cj4gPiAgIAljaGFyIHRt
cFsxNl07Cj4gPiAgIAlpbnQgaTsKPiA+IEBAIC00MjAxLDIyICs0MjAxLDIyIEBAIHN0YXRpYyBz
c2l6ZV90IGk5MTVfaHBkX3Nob3J0X3N0b3JtX2N0bF93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwK
PiA+ICAgCS8qIFJlc2V0IHRvIHRoZSAiZGVmYXVsdCIgc3RhdGUgZm9yIHRoaXMgc3lzdGVtICov
Cj4gPiAgIAlpZiAoc3RyY21wKHRtcCwgInJlc2V0IikgPT0gMCkKPiA+IC0JCW5ld19zdGF0ZSA9
ICFIQVNfRFBfTVNUKGRldl9wcml2KTsKPiA+ICsJCW5ld19zdGF0ZSA9ICFIQVNfRFBfTVNUKGk5
MTUpOwo+ID4gICAJZWxzZSBpZiAoa3N0cnRvYm9vbCh0bXAsICZuZXdfc3RhdGUpICE9IDApCj4g
PiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCIlc2FibGluZyBIUEQg
c2hvcnQgc3Rvcm0gZGV0ZWN0aW9uXG4iLAo+ID4gICAJCSAgICAgIG5ld19zdGF0ZSA/ICJFbiIg
OiAiRGlzIik7Cj4gPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAr
CXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICAgCWhvdHBsdWctPmhwZF9zaG9y
dF9zdG9ybV9lbmFibGVkID0gbmV3X3N0YXRlOwo+ID4gICAJLyogUmVzZXQgdGhlIEhQRCBzdG9y
bSBzdGF0cyBzbyB3ZSBkb24ndCBhY2NpZGVudGFsbHkgdHJpZ2dlciBhIHN0b3JtICovCj4gPiAg
IAlmb3JfZWFjaF9ocGRfcGluKGkpCj4gPiAgIAkJaG90cGx1Zy0+c3RhdHNbaV0uY291bnQgPSAw
Owo+ID4gLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5f
dW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gICAJLyogUmUtZW5hYmxlIGhwZCBpbW1l
ZGlhdGVseSBpZiB3ZSB3ZXJlIGluIGFuIGlycSBzdG9ybSAqLwo+ID4gLQlmbHVzaF9kZWxheWVk
X3dvcmsoJmRldl9wcml2LT5ob3RwbHVnLnJlZW5hYmxlX3dvcmspOwo+ID4gKwlmbHVzaF9kZWxh
eWVkX3dvcmsoJmk5MTUtPmhvdHBsdWcucmVlbmFibGVfd29yayk7Cj4gPiAgIAlyZXR1cm4gbGVu
Owo+ID4gICB9Cj4gPiBAQCAtNDIzMiwxMSArNDIzMiwxMSBAQCBzdGF0aWMgY29uc3Qgc3RydWN0
IGZpbGVfb3BlcmF0aW9ucyBpOTE1X2hwZF9zaG9ydF9zdG9ybV9jdGxfZm9wcyA9IHsKPiA+ICAg
c3RhdGljIGludCBpOTE1X2RycnNfY3RsX3NldCh2b2lkICpkYXRhLCB1NjQgdmFsKQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRhdGE7Cj4gPiAtCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBkYXRhOwo+ID4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0g
Jmk5MTUtPmRybTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ID4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA8IDcpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA3KQo+ID4g
ICAJCXJldHVybiAtRU5PREVWOwo+ID4gICAJZm9yX2VhY2hfaW50ZWxfY3J0YyhkZXYsIGNydGMp
IHsKPiA+IEBAIC00MzA1LDkgKzQzMDUsOSBAQCBpOTE1X2ZpZm9fdW5kZXJydW5fcmVzZXRfd3Jp
dGUoc3RydWN0IGZpbGUgKmZpbHAsCj4gPiAgIAkJCSAgICAgICBjb25zdCBjaGFyIF9fdXNlciAq
dWJ1ZiwKPiA+ICAgCQkJICAgICAgIHNpemVfdCBjbnQsIGxvZmZfdCAqcHBvcykKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBmaWxwLT5wcml2YXRlX2Rh
dGE7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZmlscC0+cHJpdmF0ZV9k
YXRhOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGM7Cj4gPiAtCXN0cnVjdCBk
cm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiA+ICsJc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9ICZpOTE1LT5kcm07Cj4gPiAgIAlpbnQgcmV0Owo+ID4gICAJYm9vbCByZXNldDsKPiA+
IEBAIC00MzQ3LDcgKzQzNDcsNyBAQCBpOTE1X2ZpZm9fdW5kZXJydW5fcmVzZXRfd3JpdGUoc3Ry
dWN0IGZpbGUgKmZpbHAsCj4gPiAgIAkJCXJldHVybiByZXQ7Cj4gPiAgIAl9Cj4gPiAtCXJldCA9
IGludGVsX2ZiY19yZXNldF91bmRlcnJ1bihkZXZfcHJpdik7Cj4gPiArCXJldCA9IGludGVsX2Zi
Y19yZXNldF91bmRlcnJ1bihpOTE1KTsKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJcmV0dXJuIHJl
dDsKPiA+IEBAIC00NDM3LDkgKzQ0MzcsOSBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfZGVi
dWdmc19maWxlcyB7Cj4gPiAgIAl7Imk5MTVfZWRwX3Bzcl9kZWJ1ZyIsICZpOTE1X2VkcF9wc3Jf
ZGVidWdfZm9wc30KPiA+ICAgfTsKPiA+IC1pbnQgaTkxNV9kZWJ1Z2ZzX3JlZ2lzdGVyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQgaTkxNV9kZWJ1Z2ZzX3JlZ2lz
dGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1fbWlub3IgKm1pbm9yID0gZGV2X3ByaXYtPmRybS5wcmltYXJ5Owo+ID4gKwlzdHJ1Y3QgZHJt
X21pbm9yICptaW5vciA9IGk5MTUtPmRybS5wcmltYXJ5Owo+ID4gICAJc3RydWN0IGRlbnRyeSAq
ZW50Owo+ID4gICAJaW50IGk7Cj4gPiBAQCAtNDY5Miw3ICs0NjkyLDcgQEAgc3RhdGljIGNvbnN0
IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgaTkxNV9kc2NfZmVjX3N1cHBvcnRfZm9wcyA9IHsKPiA+
ICAgaW50IGk5MTVfZGVidWdmc19jb25uZWN0b3JfYWRkKHN0cnVjdCBkcm1fY29ubmVjdG9yICpj
b25uZWN0b3IpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkZW50cnkgKnJvb3QgPSBjb25uZWN0b3It
PmRlYnVnZnNfZW50cnk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ID4gICAJLyogVGhlIGNvbm5lY3RvciBt
dXN0IGhhdmUgYmVlbiByZWdpc3RlcmVkIGJlZm9yZWhhbmRzLiAqLwo+ID4gICAJaWYgKCFyb290
KQo+ID4gQEAgLTQ3MTcsNyArNDcxNyw3IEBAIGludCBpOTE1X2RlYnVnZnNfY29ubmVjdG9yX2Fk
ZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICAJCQkJICAgIGNvbm5lY3Rv
ciwgJmk5MTVfaGRjcF9zaW5rX2NhcGFiaWxpdHlfZm9wcyk7Cj4gPiAgIAl9Cj4gPiAtCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDEwICYmCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0g
MTAgJiYKPiA+ICAgCSAgICAoY29ubmVjdG9yLT5jb25uZWN0b3JfdHlwZSA9PSBEUk1fTU9ERV9D
T05ORUNUT1JfRGlzcGxheVBvcnQgfHwKPiA+ICAgCSAgICAgY29ubmVjdG9yLT5jb25uZWN0b3Jf
dHlwZSA9PSBEUk1fTU9ERV9DT05ORUNUT1JfZURQKSkKPiA+ICAgCQlkZWJ1Z2ZzX2NyZWF0ZV9m
aWxlKCJpOTE1X2RzY19mZWNfc3VwcG9ydCIsIFNfSVJVR08sIHJvb3QsCj4gPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2RlYnVnZnMuaAo+ID4gaW5kZXggYzBjZDIyZWI5MTZkLi4zZTk5ZWFmOGRlMDIg
MTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuaAo+ID4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmgKPiA+IEBAIC0xMCwxMCAr
MTAsMTAgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7Cj4gPiAgIHN0cnVjdCBkcm1fY29ubmVj
dG9yOwo+ID4gICAjaWZkZWYgQ09ORklHX0RFQlVHX0ZTCj4gPiAtaW50IGk5MTVfZGVidWdmc19y
ZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK2ludCBpOTE1
X2RlYnVnZnNfcmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICBp
bnQgaTkxNV9kZWJ1Z2ZzX2Nvbm5lY3Rvcl9hZGQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5l
Y3Rvcik7Cj4gPiAgICNlbHNlCj4gPiAtc3RhdGljIGlubGluZSBpbnQgaTkxNV9kZWJ1Z2ZzX3Jl
Z2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikgeyByZXR1cm4gMDsgfQo+
ID4gK3N0YXRpYyBpbmxpbmUgaW50IGk5MTVfZGVidWdmc19yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkgeyByZXR1cm4gMDsgfQo+ID4gICBzdGF0aWMgaW5saW5lIGludCBp
OTE1X2RlYnVnZnNfY29ubmVjdG9yX2FkZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9y
KSB7IHJldHVybiAwOyB9Cj4gPiAgICNlbmRpZgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCj4g
PiBpbmRleCA4MWZmMmM3OGZkNTUuLmEwOWQwMjhlYzhkOCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmMKPiA+IEBAIC0xMDgsMTEgKzEwOCwxMSBAQCBib29sIGk5MTVfZXJyb3JfaW5q
ZWN0ZWQodm9pZCkKPiA+ICAgCQkgICAgInByb3ZpZGluZyB0aGUgZG1lc2cgbG9nIGJ5IGJvb3Rp
bmcgd2l0aCBkcm0uZGVidWc9MHhmIgo+ID4gICB2b2lkCj4gPiAtX19pOTE1X3ByaW50ayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IGNoYXIgKmxldmVsLAo+ID4gK19f
aTkxNV9wcmludGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGNvbnN0IGNoYXIgKmxl
dmVsLAo+ID4gICAJICAgICAgY29uc3QgY2hhciAqZm10LCAuLi4pCj4gPiAgIHsKPiA+ICAgCXN0
YXRpYyBib29sIHNob3duX2J1Z19vbmNlOwo+ID4gLQlzdHJ1Y3QgZGV2aWNlICprZGV2ID0gZGV2
X3ByaXYtPmRybS5kZXY7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmtkZXYgPSBpOTE1LT5kcm0uZGV2
Owo+ID4gICAJYm9vbCBpc19lcnJvciA9IGxldmVsWzFdIDw9IEtFUk5fRVJSWzFdOwo+ID4gICAJ
Ym9vbCBpc19kZWJ1ZyA9IGxldmVsWzFdID09IEtFUk5fREVCVUdbMV07Cj4gPiAgIAlzdHJ1Y3Qg
dmFfZm9ybWF0IHZhZjsKPiA+IEBAIC0xNDgsNzQgKzE0OCw3NCBAQCBfX2k5MTVfcHJpbnRrKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgY29uc3QgY2hhciAqbGV2ZWwsCj4gPiAg
IC8qIE1hcCBQQ0ggZGV2aWNlIGlkIHRvIFBDSCB0eXBlLCBvciBQQ0hfTk9ORSBpZiB1bmtub3du
LiAqLwo+ID4gICBzdGF0aWMgZW51bSBpbnRlbF9wY2gKPiA+IC1pbnRlbF9wY2hfdHlwZShjb25z
dCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVuc2lnbmVkIHNob3J0IGlkKQo+
ID4gK2ludGVsX3BjaF90eXBlKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1
bnNpZ25lZCBzaG9ydCBpZCkKPiA+ICAgewo+ID4gICAJc3dpdGNoIChpZCkgewo+ID4gICAJY2Fz
ZSBJTlRFTF9QQ0hfSUJYX0RFVklDRV9JRF9UWVBFOgo+ID4gICAJCURSTV9ERUJVR19LTVMoIkZv
dW5kIEliZXggUGVhayBQQ0hcbiIpOwo+ID4gLQkJV0FSTl9PTighSVNfR0VOKGRldl9wcml2LCA1
KSk7Cj4gPiArCQlXQVJOX09OKCFJU19HRU4oaTkxNSwgNSkpOwo+ID4gICAJCXJldHVybiBQQ0hf
SUJYOwo+ID4gICAJY2FzZSBJTlRFTF9QQ0hfQ1BUX0RFVklDRV9JRF9UWVBFOgo+ID4gICAJCURS
TV9ERUJVR19LTVMoIkZvdW5kIENvdWdhclBvaW50IFBDSFxuIik7Cj4gPiAtCQlXQVJOX09OKCFJ
U19HRU4oZGV2X3ByaXYsIDYpICYmICFJU19JVllCUklER0UoZGV2X3ByaXYpKTsKPiA+ICsJCVdB
Uk5fT04oIUlTX0dFTihpOTE1LCA2KSAmJiAhSVNfSVZZQlJJREdFKGk5MTUpKTsKPiA+ICAgCQly
ZXR1cm4gUENIX0NQVDsKPiA+ICAgCWNhc2UgSU5URUxfUENIX1BQVF9ERVZJQ0VfSURfVFlQRToK
PiA+ICAgCQlEUk1fREVCVUdfS01TKCJGb3VuZCBQYW50aGVyUG9pbnQgUENIXG4iKTsKPiA+IC0J
CVdBUk5fT04oIUlTX0dFTihkZXZfcHJpdiwgNikgJiYgIUlTX0lWWUJSSURHRShkZXZfcHJpdikp
Owo+ID4gKwkJV0FSTl9PTighSVNfR0VOKGk5MTUsIDYpICYmICFJU19JVllCUklER0UoaTkxNSkp
Owo+ID4gICAJCS8qIFBhbnRoZXJQb2ludCBpcyBDUFQgY29tcGF0aWJsZSAqLwo+ID4gICAJCXJl
dHVybiBQQ0hfQ1BUOwo+ID4gICAJY2FzZSBJTlRFTF9QQ0hfTFBUX0RFVklDRV9JRF9UWVBFOgo+
ID4gICAJCURSTV9ERUJVR19LTVMoIkZvdW5kIEx5bnhQb2ludCBQQ0hcbiIpOwo+ID4gLQkJV0FS
Tl9PTighSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgIUlTX0JST0FEV0VMTChkZXZfcHJpdikpOwo+
ID4gLQkJV0FSTl9PTihJU19IU1dfVUxUKGRldl9wcml2KSB8fCBJU19CRFdfVUxUKGRldl9wcml2
KSk7Cj4gPiArCQlXQVJOX09OKCFJU19IQVNXRUxMKGk5MTUpICYmICFJU19CUk9BRFdFTEwoaTkx
NSkpOwo+ID4gKwkJV0FSTl9PTihJU19IU1dfVUxUKGk5MTUpIHx8IElTX0JEV19VTFQoaTkxNSkp
Owo+ID4gICAJCXJldHVybiBQQ0hfTFBUOwo+ID4gICAJY2FzZSBJTlRFTF9QQ0hfTFBUX0xQX0RF
VklDRV9JRF9UWVBFOgo+ID4gICAJCURSTV9ERUJVR19LTVMoIkZvdW5kIEx5bnhQb2ludCBMUCBQ
Q0hcbiIpOwo+ID4gLQkJV0FSTl9PTighSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgIUlTX0JST0FE
V0VMTChkZXZfcHJpdikpOwo+ID4gLQkJV0FSTl9PTighSVNfSFNXX1VMVChkZXZfcHJpdikgJiYg
IUlTX0JEV19VTFQoZGV2X3ByaXYpKTsKPiA+ICsJCVdBUk5fT04oIUlTX0hBU1dFTEwoaTkxNSkg
JiYgIUlTX0JST0FEV0VMTChpOTE1KSk7Cj4gPiArCQlXQVJOX09OKCFJU19IU1dfVUxUKGk5MTUp
ICYmICFJU19CRFdfVUxUKGk5MTUpKTsKPiA+ICAgCQlyZXR1cm4gUENIX0xQVDsKPiA+ICAgCWNh
c2UgSU5URUxfUENIX1dQVF9ERVZJQ0VfSURfVFlQRToKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJG
b3VuZCBXaWxkY2F0UG9pbnQgUENIXG4iKTsKPiA+IC0JCVdBUk5fT04oIUlTX0hBU1dFTEwoZGV2
X3ByaXYpICYmICFJU19CUk9BRFdFTEwoZGV2X3ByaXYpKTsKPiA+IC0JCVdBUk5fT04oSVNfSFNX
X1VMVChkZXZfcHJpdikgfHwgSVNfQkRXX1VMVChkZXZfcHJpdikpOwo+ID4gKwkJV0FSTl9PTigh
SVNfSEFTV0VMTChpOTE1KSAmJiAhSVNfQlJPQURXRUxMKGk5MTUpKTsKPiA+ICsJCVdBUk5fT04o
SVNfSFNXX1VMVChpOTE1KSB8fCBJU19CRFdfVUxUKGk5MTUpKTsKPiA+ICAgCQkvKiBXaWxkY2F0
UG9pbnQgaXMgTFBUIGNvbXBhdGlibGUgKi8KPiA+ICAgCQlyZXR1cm4gUENIX0xQVDsKPiA+ICAg
CWNhc2UgSU5URUxfUENIX1dQVF9MUF9ERVZJQ0VfSURfVFlQRToKPiA+ICAgCQlEUk1fREVCVUdf
S01TKCJGb3VuZCBXaWxkY2F0UG9pbnQgTFAgUENIXG4iKTsKPiA+IC0JCVdBUk5fT04oIUlTX0hB
U1dFTEwoZGV2X3ByaXYpICYmICFJU19CUk9BRFdFTEwoZGV2X3ByaXYpKTsKPiA+IC0JCVdBUk5f
T04oIUlTX0hTV19VTFQoZGV2X3ByaXYpICYmICFJU19CRFdfVUxUKGRldl9wcml2KSk7Cj4gPiAr
CQlXQVJOX09OKCFJU19IQVNXRUxMKGk5MTUpICYmICFJU19CUk9BRFdFTEwoaTkxNSkpOwo+ID4g
KwkJV0FSTl9PTighSVNfSFNXX1VMVChpOTE1KSAmJiAhSVNfQkRXX1VMVChpOTE1KSk7Cj4gPiAg
IAkJLyogV2lsZGNhdFBvaW50IGlzIExQVCBjb21wYXRpYmxlICovCj4gPiAgIAkJcmV0dXJuIFBD
SF9MUFQ7Cj4gPiAgIAljYXNlIElOVEVMX1BDSF9TUFRfREVWSUNFX0lEX1RZUEU6Cj4gPiAgIAkJ
RFJNX0RFQlVHX0tNUygiRm91bmQgU3VucmlzZVBvaW50IFBDSFxuIik7Cj4gPiAtCQlXQVJOX09O
KCFJU19TS1lMQUtFKGRldl9wcml2KSAmJiAhSVNfS0FCWUxBS0UoZGV2X3ByaXYpKTsKPiA+ICsJ
CVdBUk5fT04oIUlTX1NLWUxBS0UoaTkxNSkgJiYgIUlTX0tBQllMQUtFKGk5MTUpKTsKPiA+ICAg
CQlyZXR1cm4gUENIX1NQVDsKPiA+ICAgCWNhc2UgSU5URUxfUENIX1NQVF9MUF9ERVZJQ0VfSURf
VFlQRToKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJGb3VuZCBTdW5yaXNlUG9pbnQgTFAgUENIXG4i
KTsKPiA+IC0JCVdBUk5fT04oIUlTX1NLWUxBS0UoZGV2X3ByaXYpICYmICFJU19LQUJZTEFLRShk
ZXZfcHJpdikpOwo+ID4gKwkJV0FSTl9PTighSVNfU0tZTEFLRShpOTE1KSAmJiAhSVNfS0FCWUxB
S0UoaTkxNSkpOwo+ID4gICAJCXJldHVybiBQQ0hfU1BUOwo+ID4gICAJY2FzZSBJTlRFTF9QQ0hf
S0JQX0RFVklDRV9JRF9UWVBFOgo+ID4gICAJCURSTV9ERUJVR19LTVMoIkZvdW5kIEthYnkgTGFr
ZSBQQ0ggKEtCUClcbiIpOwo+ID4gLQkJV0FSTl9PTighSVNfU0tZTEFLRShkZXZfcHJpdikgJiYg
IUlTX0tBQllMQUtFKGRldl9wcml2KSAmJgo+ID4gLQkJCSFJU19DT0ZGRUVMQUtFKGRldl9wcml2
KSk7Cj4gPiArCQlXQVJOX09OKCFJU19TS1lMQUtFKGk5MTUpICYmICFJU19LQUJZTEFLRShpOTE1
KSAmJgo+ID4gKwkJCSFJU19DT0ZGRUVMQUtFKGk5MTUpKTsKPiA+ICAgCQkvKiBLQlAgaXMgU1BU
IGNvbXBhdGlibGUgKi8KPiA+ICAgCQlyZXR1cm4gUENIX1NQVDsKPiA+ICAgCWNhc2UgSU5URUxf
UENIX0NOUF9ERVZJQ0VfSURfVFlQRToKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJGb3VuZCBDYW5u
b24gTGFrZSBQQ0ggKENOUClcbiIpOwo+ID4gLQkJV0FSTl9PTighSVNfQ0FOTk9OTEFLRShkZXZf
cHJpdikgJiYgIUlTX0NPRkZFRUxBS0UoZGV2X3ByaXYpKTsKPiA+ICsJCVdBUk5fT04oIUlTX0NB
Tk5PTkxBS0UoaTkxNSkgJiYgIUlTX0NPRkZFRUxBS0UoaTkxNSkpOwo+ID4gICAJCXJldHVybiBQ
Q0hfQ05QOwo+ID4gICAJY2FzZSBJTlRFTF9QQ0hfQ05QX0xQX0RFVklDRV9JRF9UWVBFOgo+ID4g
ICAJCURSTV9ERUJVR19LTVMoIkZvdW5kIENhbm5vbiBMYWtlIExQIFBDSCAoQ05QLUxQKVxuIik7
Cj4gPiAtCQlXQVJOX09OKCFJU19DQU5OT05MQUtFKGRldl9wcml2KSAmJiAhSVNfQ09GRkVFTEFL
RShkZXZfcHJpdikpOwo+ID4gKwkJV0FSTl9PTighSVNfQ0FOTk9OTEFLRShpOTE1KSAmJiAhSVNf
Q09GRkVFTEFLRShpOTE1KSk7Cj4gPiAgIAkJcmV0dXJuIFBDSF9DTlA7Cj4gPiAgIAljYXNlIElO
VEVMX1BDSF9DTVBfREVWSUNFX0lEX1RZUEU6Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiRm91bmQg
Q29tZXQgTGFrZSBQQ0ggKENNUClcbiIpOwo+ID4gLQkJV0FSTl9PTighSVNfQ09GRkVFTEFLRShk
ZXZfcHJpdikpOwo+ID4gKwkJV0FSTl9PTighSVNfQ09GRkVFTEFLRShpOTE1KSk7Cj4gPiAgIAkJ
LyogQ29tZXRQb2ludCBpcyBDTlAgQ29tcGF0aWJsZSAqLwo+ID4gICAJCXJldHVybiBQQ0hfQ05Q
Owo+ID4gICAJY2FzZSBJTlRFTF9QQ0hfSUNQX0RFVklDRV9JRF9UWVBFOgo+ID4gICAJCURSTV9E
RUJVR19LTVMoIkZvdW5kIEljZSBMYWtlIFBDSFxuIik7Cj4gPiAtCQlXQVJOX09OKCFJU19JQ0VM
QUtFKGRldl9wcml2KSk7Cj4gPiArCQlXQVJOX09OKCFJU19JQ0VMQUtFKGk5MTUpKTsKPiA+ICAg
CQlyZXR1cm4gUENIX0lDUDsKPiA+ICAgCWRlZmF1bHQ6Cj4gPiAgIAkJcmV0dXJuIFBDSF9OT05F
Owo+ID4gQEAgLTIzMyw3ICsyMzMsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9pc192aXJ0X3BjaCh1
bnNpZ25lZCBzaG9ydCBpZCwKPiA+ICAgfQo+ID4gICBzdGF0aWMgdW5zaWduZWQgc2hvcnQKPiA+
IC1pbnRlbF92aXJ0X2RldGVjdF9wY2goY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gK2ludGVsX3ZpcnRfZGV0ZWN0X3BjaChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdW5zaWduZWQgc2hvcnQgaWQgPSAwOwo+ID4g
QEAgLTI0NCwxOSArMjQ0LDE5IEBAIGludGVsX3ZpcnRfZGV0ZWN0X3BjaChjb25zdCBzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiBtYWtlIGFuIGVkdWNhdGVkIGd1
ZXNzIGFzIHRvIHdoaWNoIFBDSCBpcyByZWFsbHkgdGhlcmUuCj4gPiAgIAkgKi8KPiA+IC0JaWYg
KElTX0lDRUxBS0UoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfSUNFTEFLRShpOTE1KSkKPiA+ICAg
CQlpZCA9IElOVEVMX1BDSF9JQ1BfREVWSUNFX0lEX1RZUEU7Cj4gPiAtCWVsc2UgaWYgKElTX0NB
Tk5PTkxBS0UoZGV2X3ByaXYpIHx8IElTX0NPRkZFRUxBS0UoZGV2X3ByaXYpKQo+ID4gKwllbHNl
IGlmIChJU19DQU5OT05MQUtFKGk5MTUpIHx8IElTX0NPRkZFRUxBS0UoaTkxNSkpCj4gPiAgIAkJ
aWQgPSBJTlRFTF9QQ0hfQ05QX0RFVklDRV9JRF9UWVBFOwo+ID4gLQllbHNlIGlmIChJU19LQUJZ
TEFLRShkZXZfcHJpdikgfHwgSVNfU0tZTEFLRShkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElT
X0tBQllMQUtFKGk5MTUpIHx8IElTX1NLWUxBS0UoaTkxNSkpCj4gPiAgIAkJaWQgPSBJTlRFTF9Q
Q0hfU1BUX0RFVklDRV9JRF9UWVBFOwo+ID4gLQllbHNlIGlmIChJU19IU1dfVUxUKGRldl9wcml2
KSB8fCBJU19CRFdfVUxUKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSVNfSFNXX1VMVChpOTE1
KSB8fCBJU19CRFdfVUxUKGk5MTUpKQo+ID4gICAJCWlkID0gSU5URUxfUENIX0xQVF9MUF9ERVZJ
Q0VfSURfVFlQRTsKPiA+IC0JZWxzZSBpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJP
QURXRUxMKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19C
Uk9BRFdFTEwoaTkxNSkpCj4gPiAgIAkJaWQgPSBJTlRFTF9QQ0hfTFBUX0RFVklDRV9JRF9UWVBF
Owo+ID4gLQllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDYpIHx8IElTX0lWWUJSSURHRShkZXZf
cHJpdikpCj4gPiArCWVsc2UgaWYgKElTX0dFTihpOTE1LCA2KSB8fCBJU19JVllCUklER0UoaTkx
NSkpCj4gPiAgIAkJaWQgPSBJTlRFTF9QQ0hfQ1BUX0RFVklDRV9JRF9UWVBFOwo+ID4gLQllbHNl
IGlmIChJU19HRU4oZGV2X3ByaXYsIDUpKQo+ID4gKwllbHNlIGlmIChJU19HRU4oaTkxNSwgNSkp
Cj4gPiAgIAkJaWQgPSBJTlRFTF9QQ0hfSUJYX0RFVklDRV9JRF9UWVBFOwo+ID4gICAJaWYgKGlk
KQo+ID4gQEAgLTI2Nyw3ICsyNjcsNyBAQCBpbnRlbF92aXJ0X2RldGVjdF9wY2goY29uc3Qgc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJcmV0dXJuIGlkOwo+ID4gICB9
Cj4gPiAtc3RhdGljIHZvaWQgaW50ZWxfZGV0ZWN0X3BjaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaW50ZWxfZGV0ZWN0X3BjaChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJc3RydWN0IHBjaV9kZXYgKnBjaCA9
IE5VTEw7Cj4gPiBAQCAtMjkxLDIyICsyOTEsMjIgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGV0ZWN0
X3BjaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJaWQgPSBwY2gt
PmRldmljZSAmIElOVEVMX1BDSF9ERVZJQ0VfSURfTUFTSzsKPiA+IC0JCXBjaF90eXBlID0gaW50
ZWxfcGNoX3R5cGUoZGV2X3ByaXYsIGlkKTsKPiA+ICsJCXBjaF90eXBlID0gaW50ZWxfcGNoX3R5
cGUoaTkxNSwgaWQpOwo+ID4gICAJCWlmIChwY2hfdHlwZSAhPSBQQ0hfTk9ORSkgewo+ID4gLQkJ
CWRldl9wcml2LT5wY2hfdHlwZSA9IHBjaF90eXBlOwo+ID4gLQkJCWRldl9wcml2LT5wY2hfaWQg
PSBpZDsKPiA+ICsJCQlpOTE1LT5wY2hfdHlwZSA9IHBjaF90eXBlOwo+ID4gKwkJCWk5MTUtPnBj
aF9pZCA9IGlkOwo+ID4gICAJCQlicmVhazsKPiA+ICAgCQl9IGVsc2UgaWYgKGludGVsX2lzX3Zp
cnRfcGNoKGlkLCBwY2gtPnN1YnN5c3RlbV92ZW5kb3IsCj4gPiAgIAkJCQkJIHBjaC0+c3Vic3lz
dGVtX2RldmljZSkpIHsKPiA+IC0JCQlpZCA9IGludGVsX3ZpcnRfZGV0ZWN0X3BjaChkZXZfcHJp
dik7Cj4gPiAtCQkJcGNoX3R5cGUgPSBpbnRlbF9wY2hfdHlwZShkZXZfcHJpdiwgaWQpOwo+ID4g
KwkJCWlkID0gaW50ZWxfdmlydF9kZXRlY3RfcGNoKGk5MTUpOwo+ID4gKwkJCXBjaF90eXBlID0g
aW50ZWxfcGNoX3R5cGUoaTkxNSwgaWQpOwo+ID4gICAJCQkvKiBTYW5pdHkgY2hlY2sgdmlydHVh
bCBQQ0ggaWQgKi8KPiA+ICAgCQkJaWYgKFdBUk5fT04oaWQgJiYgcGNoX3R5cGUgPT0gUENIX05P
TkUpKQo+ID4gICAJCQkJaWQgPSAwOwo+ID4gLQkJCWRldl9wcml2LT5wY2hfdHlwZSA9IHBjaF90
eXBlOwo+ID4gLQkJCWRldl9wcml2LT5wY2hfaWQgPSBpZDsKPiA+ICsJCQlpOTE1LT5wY2hfdHlw
ZSA9IHBjaF90eXBlOwo+ID4gKwkJCWk5MTUtPnBjaF9pZCA9IGlkOwo+ID4gICAJCQlicmVhazsK
PiA+ICAgCQl9Cj4gPiAgIAl9Cj4gPiBAQCAtMzE1LDEwICszMTUsMTAgQEAgc3RhdGljIHZvaWQg
aW50ZWxfZGV0ZWN0X3BjaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAg
IAkgKiBVc2UgUENIX05PUCAoUENIIGJ1dCBubyBTb3V0aCBEaXNwbGF5KSBmb3IgUENIIHBsYXRm
b3JtcyB3aXRob3V0Cj4gPiAgIAkgKiBkaXNwbGF5Lgo+ID4gICAJICovCj4gPiAtCWlmIChwY2gg
JiYgIUhBU19ESVNQTEFZKGRldl9wcml2KSkgewo+ID4gKwlpZiAocGNoICYmICFIQVNfRElTUExB
WShpOTE1KSkgewo+ID4gICAJCURSTV9ERUJVR19LTVMoIkRpc3BsYXkgZGlzYWJsZWQsIHJldmVy
dGluZyB0byBOT1AgUENIXG4iKTsKPiA+IC0JCWRldl9wcml2LT5wY2hfdHlwZSA9IFBDSF9OT1A7
Cj4gPiAtCQlkZXZfcHJpdi0+cGNoX2lkID0gMDsKPiA+ICsJCWk5MTUtPnBjaF90eXBlID0gUENI
X05PUDsKPiA+ICsJCWk5MTUtPnBjaF9pZCA9IDA7Cj4gPiAgIAl9Cj4gPiAgIAlpZiAoIXBjaCkK
PiA+IEBAIC0zMzAsOSArMzMwLDkgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGV0ZWN0X3BjaChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9nZXRw
YXJhbV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ID4gICAJCQkg
ICAgICAgc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gLQlzdHJ1Y3QgcGNp
X2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiA+IC0JY29uc3Qgc3RydWN0IHNzZXVf
ZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9JTkZPKGRldl9wcml2KS0+c3NldTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBw
Y2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiArCWNvbnN0IHN0cnVjdCBzc2V1X2Rl
dl9pbmZvICpzc2V1ID0gJlJVTlRJTUVfSU5GTyhpOTE1KS0+c3NldTsKPiA+ICAgCWRybV9pOTE1
X2dldHBhcmFtX3QgKnBhcmFtID0gZGF0YTsKPiA+ICAgCWludCB2YWx1ZTsKPiA+IEBAIC0zNTAs
NDAgKzM1MCw0MCBAQCBzdGF0aWMgaW50IGk5MTVfZ2V0cGFyYW1faW9jdGwoc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiA+ICAgCQl2YWx1ZSA9IHBkZXYtPnJldmlzaW9uOwo+
ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSBJOTE1X1BBUkFNX05VTV9GRU5DRVNfQVZBSUw6Cj4g
PiAtCQl2YWx1ZSA9IGRldl9wcml2LT5udW1fZmVuY2VfcmVnczsKPiA+ICsJCXZhbHVlID0gaTkx
NS0+bnVtX2ZlbmNlX3JlZ3M7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5MTVfUEFSQU1f
SEFTX09WRVJMQVk6Cj4gPiAtCQl2YWx1ZSA9IGRldl9wcml2LT5vdmVybGF5ID8gMSA6IDA7Cj4g
PiArCQl2YWx1ZSA9IGk5MTUtPm92ZXJsYXkgPyAxIDogMDsKPiA+ICAgCQlicmVhazsKPiA+ICAg
CWNhc2UgSTkxNV9QQVJBTV9IQVNfQlNEOgo+ID4gLQkJdmFsdWUgPSAhIWRldl9wcml2LT5lbmdp
bmVbVkNTMF07Cj4gPiArCQl2YWx1ZSA9ICEhaTkxNS0+ZW5naW5lW1ZDUzBdOwo+ID4gICAJCWJy
ZWFrOwo+ID4gICAJY2FzZSBJOTE1X1BBUkFNX0hBU19CTFQ6Cj4gPiAtCQl2YWx1ZSA9ICEhZGV2
X3ByaXYtPmVuZ2luZVtCQ1MwXTsKPiA+ICsJCXZhbHVlID0gISFpOTE1LT5lbmdpbmVbQkNTMF07
Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5MTVfUEFSQU1fSEFTX1ZFQk9YOgo+ID4gLQkJ
dmFsdWUgPSAhIWRldl9wcml2LT5lbmdpbmVbVkVDUzBdOwo+ID4gKwkJdmFsdWUgPSAhIWk5MTUt
PmVuZ2luZVtWRUNTMF07Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5MTVfUEFSQU1fSEFT
X0JTRDI6Cj4gPiAtCQl2YWx1ZSA9ICEhZGV2X3ByaXYtPmVuZ2luZVtWQ1MxXTsKPiA+ICsJCXZh
bHVlID0gISFpOTE1LT5lbmdpbmVbVkNTMV07Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5
MTVfUEFSQU1fSEFTX0xMQzoKPiA+IC0JCXZhbHVlID0gSEFTX0xMQyhkZXZfcHJpdik7Cj4gPiAr
CQl2YWx1ZSA9IEhBU19MTEMoaTkxNSk7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5MTVf
UEFSQU1fSEFTX1dUOgo+ID4gLQkJdmFsdWUgPSBIQVNfV1QoZGV2X3ByaXYpOwo+ID4gKwkJdmFs
dWUgPSBIQVNfV1QoaTkxNSk7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5MTVfUEFSQU1f
SEFTX0FMSUFTSU5HX1BQR1RUOgo+ID4gLQkJdmFsdWUgPSBJTlRFTF9QUEdUVChkZXZfcHJpdik7
Cj4gPiArCQl2YWx1ZSA9IElOVEVMX1BQR1RUKGk5MTUpOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJ
Y2FzZSBJOTE1X1BBUkFNX0hBU19TRU1BUEhPUkVTOgo+ID4gLQkJdmFsdWUgPSAhIShkZXZfcHJp
di0+Y2Fwcy5zY2hlZHVsZXIgJiBJOTE1X1NDSEVEVUxFUl9DQVBfU0VNQVBIT1JFUyk7Cj4gPiAr
CQl2YWx1ZSA9ICEhKGk5MTUtPmNhcHMuc2NoZWR1bGVyICYgSTkxNV9TQ0hFRFVMRVJfQ0FQX1NF
TUFQSE9SRVMpOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSBJOTE1X1BBUkFNX0hBU19TRUNV
UkVfQkFUQ0hFUzoKPiA+ICAgCQl2YWx1ZSA9IGNhcGFibGUoQ0FQX1NZU19BRE1JTik7Cj4gPiAg
IAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5MTVfUEFSQU1fQ01EX1BBUlNFUl9WRVJTSU9OOgo+ID4g
LQkJdmFsdWUgPSBpOTE1X2NtZF9wYXJzZXJfZ2V0X3ZlcnNpb24oZGV2X3ByaXYpOwo+ID4gKwkJ
dmFsdWUgPSBpOTE1X2NtZF9wYXJzZXJfZ2V0X3ZlcnNpb24oaTkxNSk7Cj4gPiAgIAkJYnJlYWs7
Cj4gPiAgIAljYXNlIEk5MTVfUEFSQU1fU1VCU0xJQ0VfVE9UQUw6Cj4gPiAgIAkJdmFsdWUgPSBp
bnRlbF9zc2V1X3N1YnNsaWNlX3RvdGFsKHNzZXUpOwo+ID4gQEAgLTM5NywyMSArMzk3LDIxIEBA
IHN0YXRpYyBpbnQgaTkxNV9nZXRwYXJhbV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2
b2lkICpkYXRhLAo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSBJOTE1X1BBUkFNX0hBU19HUFVf
UkVTRVQ6Cj4gPiAgIAkJdmFsdWUgPSBpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2NoZWNrICYm
Cj4gPiAtCQkJaW50ZWxfaGFzX2dwdV9yZXNldChkZXZfcHJpdik7Cj4gPiAtCQlpZiAodmFsdWUg
JiYgaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShkZXZfcHJpdikpCj4gPiArCQkJaW50ZWxfaGFzX2dw
dV9yZXNldChpOTE1KTsKPiA+ICsJCWlmICh2YWx1ZSAmJiBpbnRlbF9oYXNfcmVzZXRfZW5naW5l
KGk5MTUpKQo+ID4gICAJCQl2YWx1ZSA9IDI7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5
MTVfUEFSQU1fSEFTX1JFU09VUkNFX1NUUkVBTUVSOgo+ID4gICAJCXZhbHVlID0gMDsKPiA+ICAg
CQlicmVhazsKPiA+ICAgCWNhc2UgSTkxNV9QQVJBTV9IQVNfUE9PTEVEX0VVOgo+ID4gLQkJdmFs
dWUgPSBIQVNfUE9PTEVEX0VVKGRldl9wcml2KTsKPiA+ICsJCXZhbHVlID0gSEFTX1BPT0xFRF9F
VShpOTE1KTsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgSTkxNV9QQVJBTV9NSU5fRVVfSU5f
UE9PTDoKPiA+ICAgCQl2YWx1ZSA9IHNzZXUtPm1pbl9ldV9pbl9wb29sOwo+ID4gICAJCWJyZWFr
Owo+ID4gICAJY2FzZSBJOTE1X1BBUkFNX0hVQ19TVEFUVVM6Cj4gPiAtCQl2YWx1ZSA9IGludGVs
X2h1Y19jaGVja19zdGF0dXMoJmRldl9wcml2LT5odWMpOwo+ID4gKwkJdmFsdWUgPSBpbnRlbF9o
dWNfY2hlY2tfc3RhdHVzKCZpOTE1LT5odWMpOwo+ID4gICAJCWlmICh2YWx1ZSA8IDApCj4gPiAg
IAkJCXJldHVybiB2YWx1ZTsKPiA+ICAgCQlicmVhazsKPiA+IEBAIC00MjMsNyArNDIzLDcgQEAg
c3RhdGljIGludCBpOTE1X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZv
aWQgKmRhdGEsCj4gPiAgIAkJdmFsdWUgPSBpOTE1X2dlbV9tbWFwX2d0dF92ZXJzaW9uKCk7Cj4g
PiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5MTVfUEFSQU1fSEFTX1NDSEVEVUxFUjoKPiA+IC0J
CXZhbHVlID0gZGV2X3ByaXYtPmNhcHMuc2NoZWR1bGVyOwo+ID4gKwkJdmFsdWUgPSBpOTE1LT5j
YXBzLnNjaGVkdWxlcjsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgSTkxNV9QQVJBTV9NTUFQ
X1ZFUlNJT046Cj4gPiBAQCAtNDU2LDcgKzQ1Niw3IEBAIHN0YXRpYyBpbnQgaTkxNV9nZXRwYXJh
bV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ID4gICAJCXZhbHVl
ID0gMTsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgSTkxNV9QQVJBTV9IQVNfQ09OVEVYVF9J
U09MQVRJT046Cj4gPiAtCQl2YWx1ZSA9IGludGVsX2VuZ2luZXNfaGFzX2NvbnRleHRfaXNvbGF0
aW9uKGRldl9wcml2KTsKPiA+ICsJCXZhbHVlID0gaW50ZWxfZW5naW5lc19oYXNfY29udGV4dF9p
c29sYXRpb24oaTkxNSk7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5MTVfUEFSQU1fU0xJ
Q0VfTUFTSzoKPiA+ICAgCQl2YWx1ZSA9IHNzZXUtPnNsaWNlX21hc2s7Cj4gPiBAQCAtNDY5LDEw
ICs0NjksMTAgQEAgc3RhdGljIGludCBpOTE1X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAgIAkJCXJldHVybiAtRU5PREVWOwo+ID4gICAJCWJy
ZWFrOwo+ID4gICAJY2FzZSBJOTE1X1BBUkFNX0NTX1RJTUVTVEFNUF9GUkVRVUVOQ1k6Cj4gPiAt
CQl2YWx1ZSA9IDEwMDAgKiBSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5jc190aW1lc3RhbXBfZnJl
cXVlbmN5X2toejsKPiA+ICsJCXZhbHVlID0gMTAwMCAqIFJVTlRJTUVfSU5GTyhpOTE1KS0+Y3Nf
dGltZXN0YW1wX2ZyZXF1ZW5jeV9raHo7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEk5MTVf
UEFSQU1fTU1BUF9HVFRfQ09IRVJFTlQ6Cj4gPiAtCQl2YWx1ZSA9IElOVEVMX0lORk8oZGV2X3By
aXYpLT5oYXNfY29oZXJlbnRfZ2d0dDsKPiA+ICsJCXZhbHVlID0gSU5URUxfSU5GTyhpOTE1KS0+
aGFzX2NvaGVyZW50X2dndHQ7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAlkZWZhdWx0Ogo+ID4gICAJ
CURSTV9ERUJVRygiVW5rbm93biBwYXJhbWV0ZXIgJWRcbiIsIHBhcmFtLT5wYXJhbSk7Cj4gPiBA
QCAtNDg1LDEzICs0ODUsMTMgQEAgc3RhdGljIGludCBpOTE1X2dldHBhcmFtX2lvY3RsKHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+
ID4gLXN0YXRpYyBpbnQgaTkxNV9nZXRfYnJpZGdlX2RldihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGludCBpOTE1X2dldF9icmlkZ2VfZGV2KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWludCBkb21haW4gPSBwY2lfZG9t
YWluX25yKGRldl9wcml2LT5kcm0ucGRldi0+YnVzKTsKPiA+ICsJaW50IGRvbWFpbiA9IHBjaV9k
b21haW5fbnIoaTkxNS0+ZHJtLnBkZXYtPmJ1cyk7Cj4gPiAtCWRldl9wcml2LT5icmlkZ2VfZGV2
ID0KPiA+ICsJaTkxNS0+YnJpZGdlX2RldiA9Cj4gPiAgIAkJcGNpX2dldF9kb21haW5fYnVzX2Fu
ZF9zbG90KGRvbWFpbiwgMCwgUENJX0RFVkZOKDAsIDApKTsKPiA+IC0JaWYgKCFkZXZfcHJpdi0+
YnJpZGdlX2Rldikgewo+ID4gKwlpZiAoIWk5MTUtPmJyaWRnZV9kZXYpIHsKPiA+ICAgCQlEUk1f
RVJST1IoImJyaWRnZSBkZXZpY2Ugbm90IGZvdW5kXG4iKTsKPiA+ICAgCQlyZXR1cm4gLTE7Cj4g
PiAgIAl9Cj4gPiBAQCAtNTAwLDE2ICs1MDAsMTYgQEAgc3RhdGljIGludCBpOTE1X2dldF9icmlk
Z2VfZGV2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgLyogQWxsb2Nh
dGUgc3BhY2UgZm9yIHRoZSBNQ0ggcmVncyBpZiBuZWVkZWQsIHJldHVybiBub256ZXJvIG9uIGVy
cm9yICovCj4gPiAgIHN0YXRpYyBpbnQKPiA+IC1pbnRlbF9hbGxvY19tY2hiYXJfcmVzb3VyY2Uo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludGVsX2FsbG9jX21jaGJh
cl9yZXNvdXJjZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlp
bnQgcmVnID0gSU5URUxfR0VOKGRldl9wcml2KSA+PSA0ID8gTUNIQkFSX0k5NjUgOiBNQ0hCQVJf
STkxNTsKPiA+ICsJaW50IHJlZyA9IElOVEVMX0dFTihpOTE1KSA+PSA0ID8gTUNIQkFSX0k5NjUg
OiBNQ0hCQVJfSTkxNTsKPiA+ICAgCXUzMiB0ZW1wX2xvLCB0ZW1wX2hpID0gMDsKPiA+ICAgCXU2
NCBtY2hiYXJfYWRkcjsKPiA+ICAgCWludCByZXQ7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDQpCj4gPiAtCQlwY2lfcmVhZF9jb25maWdfZHdvcmQoZGV2X3ByaXYtPmJyaWRnZV9k
ZXYsIHJlZyArIDQsICZ0ZW1wX2hpKTsKPiA+IC0JcGNpX3JlYWRfY29uZmlnX2R3b3JkKGRldl9w
cml2LT5icmlkZ2VfZGV2LCByZWcsICZ0ZW1wX2xvKTsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSA0KQo+ID4gKwkJcGNpX3JlYWRfY29uZmlnX2R3b3JkKGk5MTUtPmJyaWRnZV9kZXYsIHJl
ZyArIDQsICZ0ZW1wX2hpKTsKPiA+ICsJcGNpX3JlYWRfY29uZmlnX2R3b3JkKGk5MTUtPmJyaWRn
ZV9kZXYsIHJlZywgJnRlbXBfbG8pOwo+ID4gICAJbWNoYmFyX2FkZHIgPSAoKHU2NCl0ZW1wX2hp
IDw8IDMyKSB8IHRlbXBfbG87Cj4gPiAgIAkvKiBJZiBBQ1BJIGRvZXNuJ3QgaGF2ZSBpdCwgYXNz
dW1lIHdlIG5lZWQgdG8gYWxsb2NhdGUgaXQgb3Vyc2VsdmVzICovCj4gPiBAQCAtNTIwLDQ3ICs1
MjAsNDcgQEAgaW50ZWxfYWxsb2NfbWNoYmFyX3Jlc291cmNlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICAgI2VuZGlmCj4gPiAgIAkvKiBHZXQgc29tZSBzcGFjZSBmb3Ig
aXQgKi8KPiA+IC0JZGV2X3ByaXYtPm1jaF9yZXMubmFtZSA9ICJpOTE1IE1DSEJBUiI7Cj4gPiAt
CWRldl9wcml2LT5tY2hfcmVzLmZsYWdzID0gSU9SRVNPVVJDRV9NRU07Cj4gPiAtCXJldCA9IHBj
aV9idXNfYWxsb2NfcmVzb3VyY2UoZGV2X3ByaXYtPmJyaWRnZV9kZXYtPmJ1cywKPiA+IC0JCQkJ
ICAgICAmZGV2X3ByaXYtPm1jaF9yZXMsCj4gPiArCWk5MTUtPm1jaF9yZXMubmFtZSA9ICJpOTE1
IE1DSEJBUiI7Cj4gPiArCWk5MTUtPm1jaF9yZXMuZmxhZ3MgPSBJT1JFU09VUkNFX01FTTsKPiA+
ICsJcmV0ID0gcGNpX2J1c19hbGxvY19yZXNvdXJjZShpOTE1LT5icmlkZ2VfZGV2LT5idXMsCj4g
PiArCQkJCSAgICAgJmk5MTUtPm1jaF9yZXMsCj4gPiAgIAkJCQkgICAgIE1DSEJBUl9TSVpFLCBN
Q0hCQVJfU0laRSwKPiA+ICAgCQkJCSAgICAgUENJQklPU19NSU5fTUVNLAo+ID4gICAJCQkJICAg
ICAwLCBwY2liaW9zX2FsaWduX3Jlc291cmNlLAo+ID4gLQkJCQkgICAgIGRldl9wcml2LT5icmlk
Z2VfZGV2KTsKPiA+ICsJCQkJICAgICBpOTE1LT5icmlkZ2VfZGV2KTsKPiA+ICAgCWlmIChyZXQp
IHsKPiA+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJmYWlsZWQgYnVzIGFsbG9jOiAlZFxuIiwgcmV0
KTsKPiA+IC0JCWRldl9wcml2LT5tY2hfcmVzLnN0YXJ0ID0gMDsKPiA+ICsJCWk5MTUtPm1jaF9y
ZXMuc3RhcnQgPSAwOwo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiAgIAl9Cj4gPiAtCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDQpCj4gPiAtCQlwY2lfd3JpdGVfY29uZmlnX2R3b3JkKGRldl9w
cml2LT5icmlkZ2VfZGV2LCByZWcgKyA0LAo+ID4gLQkJCQkgICAgICAgdXBwZXJfMzJfYml0cyhk
ZXZfcHJpdi0+bWNoX3Jlcy5zdGFydCkpOwo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQp
Cj4gPiArCQlwY2lfd3JpdGVfY29uZmlnX2R3b3JkKGk5MTUtPmJyaWRnZV9kZXYsIHJlZyArIDQs
Cj4gPiArCQkJCSAgICAgICB1cHBlcl8zMl9iaXRzKGk5MTUtPm1jaF9yZXMuc3RhcnQpKTsKPiA+
IC0JcGNpX3dyaXRlX2NvbmZpZ19kd29yZChkZXZfcHJpdi0+YnJpZGdlX2RldiwgcmVnLAo+ID4g
LQkJCSAgICAgICBsb3dlcl8zMl9iaXRzKGRldl9wcml2LT5tY2hfcmVzLnN0YXJ0KSk7Cj4gPiAr
CXBjaV93cml0ZV9jb25maWdfZHdvcmQoaTkxNS0+YnJpZGdlX2RldiwgcmVnLAo+ID4gKwkJCSAg
ICAgICBsb3dlcl8zMl9iaXRzKGk5MTUtPm1jaF9yZXMuc3RhcnQpKTsKPiA+ICAgCXJldHVybiAw
Owo+ID4gICB9Cj4gPiAgIC8qIFNldHVwIE1DSEJBUiBpZiBwb3NzaWJsZSwgcmV0dXJuIHRydWUg
aWYgd2Ugc2hvdWxkIGRpc2FibGUgaXQgYWdhaW4gKi8KPiA+ICAgc3RhdGljIHZvaWQKPiA+IC1p
bnRlbF9zZXR1cF9tY2hiYXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K2ludGVsX3NldHVwX21jaGJhcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAg
ewo+ID4gLQlpbnQgbWNoYmFyX3JlZyA9IElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCA/IE1DSEJB
Ul9JOTY1IDogTUNIQkFSX0k5MTU7Cj4gPiArCWludCBtY2hiYXJfcmVnID0gSU5URUxfR0VOKGk5
MTUpID49IDQgPyBNQ0hCQVJfSTk2NSA6IE1DSEJBUl9JOTE1Owo+ID4gICAJdTMyIHRlbXA7Cj4g
PiAgIAlib29sIGVuYWJsZWQ7Cj4gPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJ
U19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwg
SVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWRldl9wcml2LT5tY2hi
YXJfbmVlZF9kaXNhYmxlID0gZmFsc2U7Cj4gPiArCWk5MTUtPm1jaGJhcl9uZWVkX2Rpc2FibGUg
PSBmYWxzZTsKPiA+IC0JaWYgKElTX0k5MTVHKGRldl9wcml2KSB8fCBJU19JOTE1R00oZGV2X3By
aXYpKSB7Cj4gPiAtCQlwY2lfcmVhZF9jb25maWdfZHdvcmQoZGV2X3ByaXYtPmJyaWRnZV9kZXYs
IERFVkVOLCAmdGVtcCk7Cj4gPiArCWlmIChJU19JOTE1RyhpOTE1KSB8fCBJU19JOTE1R00oaTkx
NSkpIHsKPiA+ICsJCXBjaV9yZWFkX2NvbmZpZ19kd29yZChpOTE1LT5icmlkZ2VfZGV2LCBERVZF
TiwgJnRlbXApOwo+ID4gICAJCWVuYWJsZWQgPSAhISh0ZW1wICYgREVWRU5fTUNIQkFSX0VOKTsK
PiA+ICAgCX0gZWxzZSB7Cj4gPiAtCQlwY2lfcmVhZF9jb25maWdfZHdvcmQoZGV2X3ByaXYtPmJy
aWRnZV9kZXYsIG1jaGJhcl9yZWcsICZ0ZW1wKTsKPiA+ICsJCXBjaV9yZWFkX2NvbmZpZ19kd29y
ZChpOTE1LT5icmlkZ2VfZGV2LCBtY2hiYXJfcmVnLCAmdGVtcCk7Cj4gPiAgIAkJZW5hYmxlZCA9
IHRlbXAgJiAxOwo+ID4gICAJfQo+ID4gQEAgLTU2OCw1NiArNTY4LDU2IEBAIGludGVsX3NldHVw
X21jaGJhcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlpZiAoZW5h
YmxlZCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWlmIChpbnRlbF9hbGxvY19tY2hiYXJfcmVzb3Vy
Y2UoZGV2X3ByaXYpKQo+ID4gKwlpZiAoaW50ZWxfYWxsb2NfbWNoYmFyX3Jlc291cmNlKGk5MTUp
KQo+ID4gICAJCXJldHVybjsKPiA+IC0JZGV2X3ByaXYtPm1jaGJhcl9uZWVkX2Rpc2FibGUgPSB0
cnVlOwo+ID4gKwlpOTE1LT5tY2hiYXJfbmVlZF9kaXNhYmxlID0gdHJ1ZTsKPiA+ICAgCS8qIFNw
YWNlIGlzIGFsbG9jYXRlZCBvciByZXNlcnZlZCwgc28gZW5hYmxlIGl0LiAqLwo+ID4gLQlpZiAo
SVNfSTkxNUcoZGV2X3ByaXYpIHx8IElTX0k5MTVHTShkZXZfcHJpdikpIHsKPiA+IC0JCXBjaV93
cml0ZV9jb25maWdfZHdvcmQoZGV2X3ByaXYtPmJyaWRnZV9kZXYsIERFVkVOLAo+ID4gKwlpZiAo
SVNfSTkxNUcoaTkxNSkgfHwgSVNfSTkxNUdNKGk5MTUpKSB7Cj4gPiArCQlwY2lfd3JpdGVfY29u
ZmlnX2R3b3JkKGk5MTUtPmJyaWRnZV9kZXYsIERFVkVOLAo+ID4gICAJCQkJICAgICAgIHRlbXAg
fCBERVZFTl9NQ0hCQVJfRU4pOwo+ID4gICAJfSBlbHNlIHsKPiA+IC0JCXBjaV9yZWFkX2NvbmZp
Z19kd29yZChkZXZfcHJpdi0+YnJpZGdlX2RldiwgbWNoYmFyX3JlZywgJnRlbXApOwo+ID4gLQkJ
cGNpX3dyaXRlX2NvbmZpZ19kd29yZChkZXZfcHJpdi0+YnJpZGdlX2RldiwgbWNoYmFyX3JlZywg
dGVtcCB8IDEpOwo+ID4gKwkJcGNpX3JlYWRfY29uZmlnX2R3b3JkKGk5MTUtPmJyaWRnZV9kZXYs
IG1jaGJhcl9yZWcsICZ0ZW1wKTsKPiA+ICsJCXBjaV93cml0ZV9jb25maWdfZHdvcmQoaTkxNS0+
YnJpZGdlX2RldiwgbWNoYmFyX3JlZywgdGVtcCB8IDEpOwo+ID4gICAJfQo+ID4gICB9Cj4gPiAg
IHN0YXRpYyB2b2lkCj4gPiAtaW50ZWxfdGVhcmRvd25fbWNoYmFyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnRlbF90ZWFyZG93bl9tY2hiYXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JaW50IG1jaGJhcl9yZWcgPSBJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDQgPyBNQ0hCQVJfSTk2NSA6IE1DSEJBUl9JOTE1Owo+ID4gKwlpbnQg
bWNoYmFyX3JlZyA9IElOVEVMX0dFTihpOTE1KSA+PSA0ID8gTUNIQkFSX0k5NjUgOiBNQ0hCQVJf
STkxNTsKPiA+IC0JaWYgKGRldl9wcml2LT5tY2hiYXJfbmVlZF9kaXNhYmxlKSB7Cj4gPiAtCQlp
ZiAoSVNfSTkxNUcoZGV2X3ByaXYpIHx8IElTX0k5MTVHTShkZXZfcHJpdikpIHsKPiA+ICsJaWYg
KGk5MTUtPm1jaGJhcl9uZWVkX2Rpc2FibGUpIHsKPiA+ICsJCWlmIChJU19JOTE1RyhpOTE1KSB8
fCBJU19JOTE1R00oaTkxNSkpIHsKPiA+ICAgCQkJdTMyIGRldmVuX3ZhbDsKPiA+IC0JCQlwY2lf
cmVhZF9jb25maWdfZHdvcmQoZGV2X3ByaXYtPmJyaWRnZV9kZXYsIERFVkVOLAo+ID4gKwkJCXBj
aV9yZWFkX2NvbmZpZ19kd29yZChpOTE1LT5icmlkZ2VfZGV2LCBERVZFTiwKPiA+ICAgCQkJCQkg
ICAgICAmZGV2ZW5fdmFsKTsKPiA+ICAgCQkJZGV2ZW5fdmFsICY9IH5ERVZFTl9NQ0hCQVJfRU47
Cj4gPiAtCQkJcGNpX3dyaXRlX2NvbmZpZ19kd29yZChkZXZfcHJpdi0+YnJpZGdlX2RldiwgREVW
RU4sCj4gPiArCQkJcGNpX3dyaXRlX2NvbmZpZ19kd29yZChpOTE1LT5icmlkZ2VfZGV2LCBERVZF
TiwKPiA+ICAgCQkJCQkgICAgICAgZGV2ZW5fdmFsKTsKPiA+ICAgCQl9IGVsc2Ugewo+ID4gICAJ
CQl1MzIgbWNoYmFyX3ZhbDsKPiA+IC0JCQlwY2lfcmVhZF9jb25maWdfZHdvcmQoZGV2X3ByaXYt
PmJyaWRnZV9kZXYsIG1jaGJhcl9yZWcsCj4gPiArCQkJcGNpX3JlYWRfY29uZmlnX2R3b3JkKGk5
MTUtPmJyaWRnZV9kZXYsIG1jaGJhcl9yZWcsCj4gPiAgIAkJCQkJICAgICAgJm1jaGJhcl92YWwp
Owo+ID4gICAJCQltY2hiYXJfdmFsICY9IH4xOwo+ID4gLQkJCXBjaV93cml0ZV9jb25maWdfZHdv
cmQoZGV2X3ByaXYtPmJyaWRnZV9kZXYsIG1jaGJhcl9yZWcsCj4gPiArCQkJcGNpX3dyaXRlX2Nv
bmZpZ19kd29yZChpOTE1LT5icmlkZ2VfZGV2LCBtY2hiYXJfcmVnLAo+ID4gICAJCQkJCSAgICAg
ICBtY2hiYXJfdmFsKTsKPiA+ICAgCQl9Cj4gPiAgIAl9Cj4gPiAtCWlmIChkZXZfcHJpdi0+bWNo
X3Jlcy5zdGFydCkKPiA+IC0JCXJlbGVhc2VfcmVzb3VyY2UoJmRldl9wcml2LT5tY2hfcmVzKTsK
PiA+ICsJaWYgKGk5MTUtPm1jaF9yZXMuc3RhcnQpCj4gPiArCQlyZWxlYXNlX3Jlc291cmNlKCZp
OTE1LT5tY2hfcmVzKTsKPiA+ICAgfQo+ID4gICAvKiB0cnVlID0gZW5hYmxlIGRlY29kZSwgZmFs
c2UgPSBkaXNhYmxlIGRlY29kZXIgKi8KPiA+ICAgc3RhdGljIHVuc2lnbmVkIGludCBpOTE1X3Zn
YV9zZXRfZGVjb2RlKHZvaWQgKmNvb2tpZSwgYm9vbCBzdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBjb29raWU7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gY29va2llOwo+ID4gLQlpbnRlbF9tb2Rlc2V0X3ZnYV9zZXRf
c3RhdGUoZGV2X3ByaXYsIHN0YXRlKTsKPiA+ICsJaW50ZWxfbW9kZXNldF92Z2Ffc2V0X3N0YXRl
KGk5MTUsIHN0YXRlKTsKPiA+ICAgCWlmIChzdGF0ZSkKPiA+ICAgCQlyZXR1cm4gVkdBX1JTUkNf
TEVHQUNZX0lPIHwgVkdBX1JTUkNfTEVHQUNZX01FTSB8Cj4gPiAgIAkJICAgICAgIFZHQV9SU1JD
X05PUk1BTF9JTyB8IFZHQV9SU1JDX05PUk1BTF9NRU07Cj4gPiBAQCAtNjY4LDIxICs2NjgsMjEg
QEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2Z2Ffc3dpdGNoZXJvb19jbGllbnRfb3BzIGk5MTVfc3dp
dGNoZXJvb19vcHMgPSB7Cj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9sb2FkX21vZGVzZXRfaW5pdChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYg
PSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5w
ZGV2Owo+ID4gICAJaW50IHJldDsKPiA+ICAgCWlmIChpOTE1X2luamVjdF9sb2FkX2ZhaWx1cmUo
KSkKPiA+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiA+IC0JaWYgKEhBU19ESVNQTEFZKGRldl9wcml2
KSkgewo+ID4gLQkJcmV0ID0gZHJtX3ZibGFua19pbml0KCZkZXZfcHJpdi0+ZHJtLAo+ID4gLQkJ
CQkgICAgICBJTlRFTF9JTkZPKGRldl9wcml2KS0+bnVtX3BpcGVzKTsKPiA+ICsJaWYgKEhBU19E
SVNQTEFZKGk5MTUpKSB7Cj4gPiArCQlyZXQgPSBkcm1fdmJsYW5rX2luaXQoJmk5MTUtPmRybSwK
PiA+ICsJCQkJICAgICAgSU5URUxfSU5GTyhpOTE1KS0+bnVtX3BpcGVzKTsKPiA+ICAgCQlpZiAo
cmV0KQo+ID4gICAJCQlnb3RvIG91dDsKPiA+ICAgCX0KPiA+IC0JaW50ZWxfYmlvc19pbml0KGRl
dl9wcml2KTsKPiA+ICsJaW50ZWxfYmlvc19pbml0KGk5MTUpOwo+ID4gICAJLyogSWYgd2UgaGF2
ZSA+IDEgVkdBIGNhcmRzLCB0aGVuIHdlIG5lZWQgdG8gYXJiaXRyYXRlIGFjY2Vzcwo+ID4gICAJ
ICogdG8gdGhlIGNvbW1vbiBWR0EgcmVzb3VyY2VzLgo+ID4gQEAgLTY5MSw3ICs2OTEsNyBAQCBz
dGF0aWMgaW50IGk5MTVfbG9hZF9tb2Rlc2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikK
PiA+ICAgCSAqIHRoZW4gd2UgZG8gbm90IHRha2UgcGFydCBpbiBWR0EgYXJiaXRyYXRpb24gYW5k
IHRoZQo+ID4gICAJICogdmdhX2NsaWVudF9yZWdpc3RlcigpIGZhaWxzIHdpdGggLUVOT0RFVi4K
PiA+ICAgCSAqLwo+ID4gLQlyZXQgPSB2Z2FfY2xpZW50X3JlZ2lzdGVyKHBkZXYsIGRldl9wcml2
LCBOVUxMLCBpOTE1X3ZnYV9zZXRfZGVjb2RlKTsKPiA+ICsJcmV0ID0gdmdhX2NsaWVudF9yZWdp
c3RlcihwZGV2LCBpOTE1LCBOVUxMLCBpOTE1X3ZnYV9zZXRfZGVjb2RlKTsKPiA+ICAgCWlmIChy
ZXQgJiYgcmV0ICE9IC1FTk9ERVYpCj4gPiAgIAkJZ290byBvdXQ7Cj4gPiBAQCAtNzAyLDE3ICs3
MDIsMTcgQEAgc3RhdGljIGludCBpOTE1X2xvYWRfbW9kZXNldF9pbml0KHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYpCj4gPiAgIAkJZ290byBjbGVhbnVwX3ZnYV9jbGllbnQ7Cj4gPiAgIAkvKiBtdXN0
IGhhcHBlbiBiZWZvcmUgaW50ZWxfcG93ZXJfZG9tYWluc19pbml0X2h3KCkgb24gVkxWL0NIViAq
Lwo+ID4gLQlpbnRlbF91cGRhdGVfcmF3Y2xrKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfdXBkYXRl
X3Jhd2NsayhpOTE1KTsKPiA+IC0JaW50ZWxfcG93ZXJfZG9tYWluc19pbml0X2h3KGRldl9wcml2
LCBmYWxzZSk7Cj4gPiArCWludGVsX3Bvd2VyX2RvbWFpbnNfaW5pdF9odyhpOTE1LCBmYWxzZSk7
Cj4gPiAtCWludGVsX2Nzcl91Y29kZV9pbml0KGRldl9wcml2KTsKPiA+ICsJaW50ZWxfY3NyX3Vj
b2RlX2luaXQoaTkxNSk7Cj4gPiAtCXJldCA9IGludGVsX2lycV9pbnN0YWxsKGRldl9wcml2KTsK
PiA+ICsJcmV0ID0gaW50ZWxfaXJxX2luc3RhbGwoaTkxNSk7Cj4gPiAgIAlpZiAocmV0KQo+ID4g
ICAJCWdvdG8gY2xlYW51cF9jc3I7Cj4gPiAtCWludGVsX2dtYnVzX3NldHVwKGRldl9wcml2KTsK
PiA+ICsJaW50ZWxfZ21idXNfc2V0dXAoaTkxNSk7Cj4gPiAgIAkvKiBJbXBvcnRhbnQ6IFRoZSBv
dXRwdXQgc2V0dXAgZnVuY3Rpb25zIGNhbGxlZCBieSBtb2Rlc2V0X2luaXQgbmVlZAo+ID4gICAJ
ICogd29ya2luZyBpcnFzIGZvciBlLmcuIGdtYnVzIGFuZCBkcCBhdXggdHJhbnNmZXJzLiAqLwo+
ID4gQEAgLTcyMCwxMyArNzIwLDEzIEBAIHN0YXRpYyBpbnQgaTkxNV9sb2FkX21vZGVzZXRfaW5p
dChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICAJaWYgKHJldCkKPiA+ICAgCQlnb3RvIGNs
ZWFudXBfaXJxOwo+ID4gLQlyZXQgPSBpOTE1X2dlbV9pbml0KGRldl9wcml2KTsKPiA+ICsJcmV0
ID0gaTkxNV9nZW1faW5pdChpOTE1KTsKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJZ290byBjbGVh
bnVwX21vZGVzZXQ7Cj4gPiAtCWludGVsX292ZXJsYXlfc2V0dXAoZGV2X3ByaXYpOwo+ID4gKwlp
bnRlbF9vdmVybGF5X3NldHVwKGk5MTUpOwo+ID4gLQlpZiAoIUhBU19ESVNQTEFZKGRldl9wcml2
KSkKPiA+ICsJaWYgKCFIQVNfRElTUExBWShpOTE1KSkKPiA+ICAgCQlyZXR1cm4gMDsKPiA+ICAg
CXJldCA9IGludGVsX2ZiZGV2X2luaXQoZGV2KTsKPiA+IEBAIC03MzQsMjQgKzczNCwyNCBAQCBz
dGF0aWMgaW50IGk5MTVfbG9hZF9tb2Rlc2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikK
PiA+ICAgCQlnb3RvIGNsZWFudXBfZ2VtOwo+ID4gICAJLyogT25seSBlbmFibGUgaG90cGx1ZyBo
YW5kbGluZyBvbmNlIHRoZSBmYmRldiBpcyBmdWxseSBzZXQgdXAuICovCj4gPiAtCWludGVsX2hw
ZF9pbml0KGRldl9wcml2KTsKPiA+ICsJaW50ZWxfaHBkX2luaXQoaTkxNSk7Cj4gPiAtCWludGVs
X2luaXRfaXBjKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfaW5pdF9pcGMoaTkxNSk7Cj4gPiAgIAly
ZXR1cm4gMDsKPiA+ICAgY2xlYW51cF9nZW06Cj4gPiAtCWk5MTVfZ2VtX3N1c3BlbmQoZGV2X3By
aXYpOwo+ID4gLQlpOTE1X2dlbV9maW5pX2h3KGRldl9wcml2KTsKPiA+IC0JaTkxNV9nZW1fZmlu
aShkZXZfcHJpdik7Cj4gPiArCWk5MTVfZ2VtX3N1c3BlbmQoaTkxNSk7Cj4gPiArCWk5MTVfZ2Vt
X2ZpbmlfaHcoaTkxNSk7Cj4gPiArCWk5MTVfZ2VtX2ZpbmkoaTkxNSk7Cj4gPiAgIGNsZWFudXBf
bW9kZXNldDoKPiA+ICAgCWludGVsX21vZGVzZXRfY2xlYW51cChkZXYpOwo+ID4gICBjbGVhbnVw
X2lycToKPiA+ICAgCWRybV9pcnFfdW5pbnN0YWxsKGRldik7Cj4gPiAtCWludGVsX2dtYnVzX3Rl
YXJkb3duKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfZ21idXNfdGVhcmRvd24oaTkxNSk7Cj4gPiAg
IGNsZWFudXBfY3NyOgo+ID4gLQlpbnRlbF9jc3JfdWNvZGVfZmluaShkZXZfcHJpdik7Cj4gPiAt
CWludGVsX3Bvd2VyX2RvbWFpbnNfZmluaV9odyhkZXZfcHJpdik7Cj4gPiArCWludGVsX2Nzcl91
Y29kZV9maW5pKGk5MTUpOwo+ID4gKwlpbnRlbF9wb3dlcl9kb21haW5zX2ZpbmlfaHcoaTkxNSk7
Cj4gPiAgIAl2Z2Ffc3dpdGNoZXJvb191bnJlZ2lzdGVyX2NsaWVudChwZGV2KTsKPiA+ICAgY2xl
YW51cF92Z2FfY2xpZW50Ogo+ID4gICAJdmdhX2NsaWVudF9yZWdpc3RlcihwZGV2LCBOVUxMLCBO
VUxMLCBOVUxMKTsKPiA+IEBAIC03NTksMTEgKzc1OSwxMSBAQCBzdGF0aWMgaW50IGk5MTVfbG9h
ZF9tb2Rlc2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgCXJldHVybiByZXQ7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IGk5MTVfa2lja19vdXRfZmlybXdhcmVfZmIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBpbnQgaTkxNV9raWNrX291
dF9maXJtd2FyZV9mYihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4g
ICAJc3RydWN0IGFwZXJ0dXJlc19zdHJ1Y3QgKmFwOwo+ID4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRl
diA9IGRldl9wcml2LT5kcm0ucGRldjsKPiA+IC0Jc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9ICZk
ZXZfcHJpdi0+Z2d0dDsKPiA+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0ucGRl
djsKPiA+ICsJc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9ICZpOTE1LT5nZ3R0Owo+ID4gICAJYm9v
bCBwcmltYXJ5Owo+ID4gICAJaW50IHJldDsKPiA+IEBAIC03ODQsMjIgKzc4NCwyMiBAQCBzdGF0
aWMgaW50IGk5MTVfa2lja19vdXRfZmlybXdhcmVfZmIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGlu
dGVsX2luaXRfZHBpbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3Rh
dGljIHZvaWQgaW50ZWxfaW5pdF9kcGlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAgIAkvKgo+ID4gICAJICogSU9TRl9QT1JUX0RQSU8gaXMgdXNlZCBmb3IgVkxW
IHgyIFBIWSAoRFAvSERNSSBCIGFuZCBDKSwKPiA+ICAgCSAqIENIViB4MSBQSFkgKERQL0hETUkg
RCkKPiA+ICAgCSAqIElPU0ZfUE9SVF9EUElPXzIgaXMgdXNlZCBmb3IgQ0hWIHgyIFBIWSAoRFAv
SERNSSBCIGFuZCBDKQo+ID4gICAJICovCj4gPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2
KSkgewo+ID4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ID4gICAJCURQSU9fUEhZX0lP
U0ZfUE9SVChEUElPX1BIWTApID0gSU9TRl9QT1JUX0RQSU9fMjsKPiA+ICAgCQlEUElPX1BIWV9J
T1NGX1BPUlQoRFBJT19QSFkxKSA9IElPU0ZfUE9SVF9EUElPOwo+ID4gLQl9IGVsc2UgaWYgKElT
X1ZBTExFWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhp
OTE1KSkgewo+ID4gICAJCURQSU9fUEhZX0lPU0ZfUE9SVChEUElPX1BIWTApID0gSU9TRl9QT1JU
X0RQSU87Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IGk5MTVfd29ya3F1ZXVlc19p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgaW50IGk5
MTVfd29ya3F1ZXVlc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7
Cj4gPiAgIAkvKgo+ID4gICAJICogVGhlIGk5MTUgd29ya3F1ZXVlIGlzIHByaW1hcmlseSB1c2Vk
IGZvciBiYXRjaGVkIHJldGlyZW1lbnQgb2YKPiA+IEBAIC04MTUsMTggKzgxNSwxOCBAQCBzdGF0
aWMgaW50IGk5MTVfd29ya3F1ZXVlc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICAgCSAqIHNvIHRoZXJlIGlzIG5vIHBvaW50IGluIHJ1bm5pbmcgbW9yZSB0aGFu
IG9uZSBpbnN0YW5jZSBvZiB0aGUKPiA+ICAgCSAqIHdvcmtxdWV1ZSBhdCBhbnkgdGltZS4gIFVz
ZSBhbiBvcmRlcmVkIG9uZS4KPiA+ICAgCSAqLwo+ID4gLQlkZXZfcHJpdi0+d3EgPSBhbGxvY19v
cmRlcmVkX3dvcmtxdWV1ZSgiaTkxNSIsIDApOwo+ID4gLQlpZiAoZGV2X3ByaXYtPndxID09IE5V
TEwpCj4gPiArCWk5MTUtPndxID0gYWxsb2Nfb3JkZXJlZF93b3JrcXVldWUoImk5MTUiLCAwKTsK
PiA+ICsJaWYgKGk5MTUtPndxID09IE5VTEwpCj4gPiAgIAkJZ290byBvdXRfZXJyOwo+ID4gLQlk
ZXZfcHJpdi0+aG90cGx1Zy5kcF93cSA9IGFsbG9jX29yZGVyZWRfd29ya3F1ZXVlKCJpOTE1LWRw
IiwgMCk7Cj4gPiAtCWlmIChkZXZfcHJpdi0+aG90cGx1Zy5kcF93cSA9PSBOVUxMKQo+ID4gKwlp
OTE1LT5ob3RwbHVnLmRwX3dxID0gYWxsb2Nfb3JkZXJlZF93b3JrcXVldWUoImk5MTUtZHAiLCAw
KTsKPiA+ICsJaWYgKGk5MTUtPmhvdHBsdWcuZHBfd3EgPT0gTlVMTCkKPiA+ICAgCQlnb3RvIG91
dF9mcmVlX3dxOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIG91dF9mcmVlX3dxOgo+ID4gLQlkZXN0
cm95X3dvcmtxdWV1ZShkZXZfcHJpdi0+d3EpOwo+ID4gKwlkZXN0cm95X3dvcmtxdWV1ZShpOTE1
LT53cSk7Cj4gPiAgIG91dF9lcnI6Cj4gPiAgIAlEUk1fRVJST1IoIkZhaWxlZCB0byBhbGxvY2F0
ZSB3b3JrcXVldWVzLlxuIik7Cj4gPiBAQCAtODQyLDEwICs4NDIsMTAgQEAgc3RhdGljIHZvaWQg
aTkxNV9lbmdpbmVzX2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAg
IAkJa2ZyZWUoZW5naW5lKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGk5MTVfd29ya3F1ZXVl
c19jbGVhbnVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMg
dm9pZCBpOTE1X3dvcmtxdWV1ZXNfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiA+ICAgewo+ID4gLQlkZXN0cm95X3dvcmtxdWV1ZShkZXZfcHJpdi0+aG90cGx1Zy5kcF93
cSk7Cj4gPiAtCWRlc3Ryb3lfd29ya3F1ZXVlKGRldl9wcml2LT53cSk7Cj4gPiArCWRlc3Ryb3lf
d29ya3F1ZXVlKGk5MTUtPmhvdHBsdWcuZHBfd3EpOwo+ID4gKwlkZXN0cm95X3dvcmtxdWV1ZShp
OTE1LT53cSk7Cj4gPiAgIH0KPiA+ICAgLyoKPiA+IEBAIC04NTgsMTQgKzg1OCwxNCBAQCBzdGF0
aWMgdm9pZCBpOTE1X3dvcmtxdWV1ZXNfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiAgICAqICh3b3JrYXJvdW5kcyBoYXZlIGEgaGFiaXQgb2YgcGVyc2lzdGlu
ZyEpLiBBbnl0aGluZyBvbGRlciB0aGFuIHRoYXQKPiA+ICAgICogc2hvdWxkIGJlIHJlbW92ZWQg
YWxvbmcgd2l0aCB0aGUgY29tcGxpY2F0aW9ucyB0aGV5IGludHJvZHVjZS4KPiA+ICAgICovCj4g
PiAtc3RhdGljIHZvaWQgaW50ZWxfZGV0ZWN0X3ByZXByb2R1Y3Rpb25faHcoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGludGVsX2RldGVjdF9wcmVw
cm9kdWN0aW9uX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAg
IAlib29sIHByZSA9IGZhbHNlOwo+ID4gLQlwcmUgfD0gSVNfSFNXX0VBUkxZX1NEVihkZXZfcHJp
dik7Cj4gPiAtCXByZSB8PSBJU19TS0xfUkVWSUQoZGV2X3ByaXYsIDAsIFNLTF9SRVZJRF9GMCk7
Cj4gPiAtCXByZSB8PSBJU19CWFRfUkVWSUQoZGV2X3ByaXYsIDAsIEJYVF9SRVZJRF9CX0xBU1Qp
Owo+ID4gLQlwcmUgfD0gSVNfS0JMX1JFVklEKGRldl9wcml2LCAwLCBLQkxfUkVWSURfQTApOwo+
ID4gKwlwcmUgfD0gSVNfSFNXX0VBUkxZX1NEVihpOTE1KTsKPiA+ICsJcHJlIHw9IElTX1NLTF9S
RVZJRChpOTE1LCAwLCBTS0xfUkVWSURfRjApOwo+ID4gKwlwcmUgfD0gSVNfQlhUX1JFVklEKGk5
MTUsIDAsIEJYVF9SRVZJRF9CX0xBU1QpOwo+ID4gKwlwcmUgfD0gSVNfS0JMX1JFVklEKGk5MTUs
IDAsIEtCTF9SRVZJRF9BMCk7Cj4gPiAgIAlpZiAocHJlKSB7Cj4gPiAgIAkJRFJNX0VSUk9SKCJU
aGlzIGlzIGEgcHJlLXByb2R1Y3Rpb24gc3RlcHBpbmcuICIKPiA+IEBAIC04NzYsNyArODc2LDcg
QEAgc3RhdGljIHZvaWQgaW50ZWxfZGV0ZWN0X3ByZXByb2R1Y3Rpb25faHcoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAvKioKPiA+ICAgICogaTkxNV9kcml2ZXJfaW5p
dF9lYXJseSAtIHNldHVwIHN0YXRlIG5vdCByZXF1aXJpbmcgZGV2aWNlIGFjY2Vzcwo+ID4gLSAq
IEBkZXZfcHJpdjogZGV2aWNlIHByaXZhdGUKPiA+ICsgKiBAaTkxNTogZGV2aWNlIHByaXZhdGUK
PiA+ICAgICoKPiA+ICAgICogSW5pdGlhbGl6ZSBldmVyeXRoaW5nIHRoYXQgaXMgYSAiU1ctb25s
eSIgc3RhdGUsIHRoYXQgaXMgc3RhdGUgbm90Cj4gPiAgICAqIHJlcXVpcmluZyBhY2Nlc3Npbmcg
dGhlIGRldmljZSBvciBleHBvc2luZyB0aGUgZHJpdmVyIHZpYSBrZXJuZWwgaW50ZXJuYWwKPiA+
IEBAIC04ODQsMTUyICs4ODQsMTUyIEBAIHN0YXRpYyB2b2lkIGludGVsX2RldGVjdF9wcmVwcm9k
dWN0aW9uX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgICogc3lz
dGVtIG1lbW9yeSBhbGxvY2F0aW9uLCBzZXR0aW5nIHVwIGRldmljZSBzcGVjaWZpYyBhdHRyaWJ1
dGVzIGFuZAo+ID4gICAgKiBmdW5jdGlvbiBob29rcyBub3QgcmVxdWlyaW5nIGFjY2Vzc2luZyB0
aGUgZGV2aWNlLgo+ID4gICAgKi8KPiA+IC1zdGF0aWMgaW50IGk5MTVfZHJpdmVyX2luaXRfZWFy
bHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBpbnQgaTkx
NV9kcml2ZXJfaW5pdF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAg
ewo+ID4gICAJaW50IHJldCA9IDA7Cj4gPiAgIAlpZiAoaTkxNV9pbmplY3RfbG9hZF9mYWlsdXJl
KCkpCj4gPiAgIAkJcmV0dXJuIC1FTk9ERVY7Cj4gPiAtCWludGVsX2RldmljZV9pbmZvX3N1YnBs
YXRmb3JtX2luaXQoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9kZXZpY2VfaW5mb19zdWJwbGF0Zm9y
bV9pbml0KGk5MTUpOwo+ID4gLQlpbnRlbF91bmNvcmVfaW5pdF9lYXJseSgmZGV2X3ByaXYtPnVu
Y29yZSk7Cj4gPiArCWludGVsX3VuY29yZV9pbml0X2Vhcmx5KCZpOTE1LT51bmNvcmUpOwo+ID4g
LQlzcGluX2xvY2tfaW5pdCgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+IC0Jc3Bpbl9sb2NrX2lu
aXQoJmRldl9wcml2LT5ncHVfZXJyb3IubG9jayk7Cj4gPiAtCW11dGV4X2luaXQoJmRldl9wcml2
LT5iYWNrbGlnaHRfbG9jayk7Cj4gPiArCXNwaW5fbG9ja19pbml0KCZpOTE1LT5pcnFfbG9jayk7
Cj4gPiArCXNwaW5fbG9ja19pbml0KCZpOTE1LT5ncHVfZXJyb3IubG9jayk7Cj4gPiArCW11dGV4
X2luaXQoJmk5MTUtPmJhY2tsaWdodF9sb2NrKTsKPiA+IC0JbXV0ZXhfaW5pdCgmZGV2X3ByaXYt
PnNiX2xvY2spOwo+ID4gLQlwbV9xb3NfYWRkX3JlcXVlc3QoJmRldl9wcml2LT5zYl9xb3MsCj4g
PiArCW11dGV4X2luaXQoJmk5MTUtPnNiX2xvY2spOwo+ID4gKwlwbV9xb3NfYWRkX3JlcXVlc3Qo
Jmk5MTUtPnNiX3FvcywKPiA+ICAgCQkJICAgUE1fUU9TX0NQVV9ETUFfTEFURU5DWSwgUE1fUU9T
X0RFRkFVTFRfVkFMVUUpOwo+ID4gLQltdXRleF9pbml0KCZkZXZfcHJpdi0+YXZfbXV0ZXgpOwo+
ID4gLQltdXRleF9pbml0KCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ID4gLQltdXRleF9pbml0
KCZkZXZfcHJpdi0+cHBzX211dGV4KTsKPiA+IC0JbXV0ZXhfaW5pdCgmZGV2X3ByaXYtPmhkY3Bf
Y29tcF9tdXRleCk7Cj4gPiArCW11dGV4X2luaXQoJmk5MTUtPmF2X211dGV4KTsKPiA+ICsJbXV0
ZXhfaW5pdCgmaTkxNS0+d20ud21fbXV0ZXgpOwo+ID4gKwltdXRleF9pbml0KCZpOTE1LT5wcHNf
bXV0ZXgpOwo+ID4gKwltdXRleF9pbml0KCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gLQlp
OTE1X21lbWNweV9pbml0X2Vhcmx5KGRldl9wcml2KTsKPiA+IC0JaW50ZWxfcnVudGltZV9wbV9p
bml0X2Vhcmx5KGRldl9wcml2KTsKPiA+ICsJaTkxNV9tZW1jcHlfaW5pdF9lYXJseShpOTE1KTsK
PiA+ICsJaW50ZWxfcnVudGltZV9wbV9pbml0X2Vhcmx5KGk5MTUpOwo+ID4gLQlyZXQgPSBpOTE1
X3dvcmtxdWV1ZXNfaW5pdChkZXZfcHJpdik7Cj4gPiArCXJldCA9IGk5MTVfd29ya3F1ZXVlc19p
bml0KGk5MTUpOwo+ID4gICAJaWYgKHJldCA8IDApCj4gPiAgIAkJZ290byBlcnJfZW5naW5lczsK
PiA+IC0JcmV0ID0gaTkxNV9nZW1faW5pdF9lYXJseShkZXZfcHJpdik7Cj4gPiArCXJldCA9IGk5
MTVfZ2VtX2luaXRfZWFybHkoaTkxNSk7Cj4gPiAgIAlpZiAocmV0IDwgMCkKPiA+ICAgCQlnb3Rv
IGVycl93b3JrcXVldWVzOwo+ID4gICAJLyogVGhpcyBtdXN0IGJlIGNhbGxlZCBiZWZvcmUgYW55
IGNhbGxzIHRvIEhBU19QQ0hfKiAqLwo+ID4gLQlpbnRlbF9kZXRlY3RfcGNoKGRldl9wcml2KTsK
PiA+ICsJaW50ZWxfZGV0ZWN0X3BjaChpOTE1KTsKPiA+IC0JaW50ZWxfd29wY21faW5pdF9lYXJs
eSgmZGV2X3ByaXYtPndvcGNtKTsKPiA+IC0JaW50ZWxfdWNfaW5pdF9lYXJseShkZXZfcHJpdik7
Cj4gPiAtCWludGVsX3BtX3NldHVwKGRldl9wcml2KTsKPiA+IC0JaW50ZWxfaW5pdF9kcGlvKGRl
dl9wcml2KTsKPiA+IC0JcmV0ID0gaW50ZWxfcG93ZXJfZG9tYWluc19pbml0KGRldl9wcml2KTsK
PiA+ICsJaW50ZWxfd29wY21faW5pdF9lYXJseSgmaTkxNS0+d29wY20pOwo+ID4gKwlpbnRlbF91
Y19pbml0X2Vhcmx5KGk5MTUpOwo+ID4gKwlpbnRlbF9wbV9zZXR1cChpOTE1KTsKPiA+ICsJaW50
ZWxfaW5pdF9kcGlvKGk5MTUpOwo+ID4gKwlyZXQgPSBpbnRlbF9wb3dlcl9kb21haW5zX2luaXQo
aTkxNSk7Cj4gPiAgIAlpZiAocmV0IDwgMCkKPiA+ICAgCQlnb3RvIGVycl91YzsKPiA+IC0JaW50
ZWxfaXJxX2luaXQoZGV2X3ByaXYpOwo+ID4gLQlpbnRlbF9oYW5nY2hlY2tfaW5pdChkZXZfcHJp
dik7Cj4gPiAtCWludGVsX2luaXRfZGlzcGxheV9ob29rcyhkZXZfcHJpdik7Cj4gPiAtCWludGVs
X2luaXRfY2xvY2tfZ2F0aW5nX2hvb2tzKGRldl9wcml2KTsKPiA+IC0JaW50ZWxfaW5pdF9hdWRp
b19ob29rcyhkZXZfcHJpdik7Cj4gPiAtCWludGVsX2Rpc3BsYXlfY3JjX2luaXQoZGV2X3ByaXYp
Owo+ID4gKwlpbnRlbF9pcnFfaW5pdChpOTE1KTsKPiA+ICsJaW50ZWxfaGFuZ2NoZWNrX2luaXQo
aTkxNSk7Cj4gPiArCWludGVsX2luaXRfZGlzcGxheV9ob29rcyhpOTE1KTsKPiA+ICsJaW50ZWxf
aW5pdF9jbG9ja19nYXRpbmdfaG9va3MoaTkxNSk7Cj4gPiArCWludGVsX2luaXRfYXVkaW9faG9v
a3MoaTkxNSk7Cj4gPiArCWludGVsX2Rpc3BsYXlfY3JjX2luaXQoaTkxNSk7Cj4gPiAtCWludGVs
X2RldGVjdF9wcmVwcm9kdWN0aW9uX2h3KGRldl9wcml2KTsKPiA+ICsJaW50ZWxfZGV0ZWN0X3By
ZXByb2R1Y3Rpb25faHcoaTkxNSk7Cj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgZXJyX3VjOgo+ID4g
LQlpbnRlbF91Y19jbGVhbnVwX2Vhcmx5KGRldl9wcml2KTsKPiA+IC0JaTkxNV9nZW1fY2xlYW51
cF9lYXJseShkZXZfcHJpdik7Cj4gPiArCWludGVsX3VjX2NsZWFudXBfZWFybHkoaTkxNSk7Cj4g
PiArCWk5MTVfZ2VtX2NsZWFudXBfZWFybHkoaTkxNSk7Cj4gPiAgIGVycl93b3JrcXVldWVzOgo+
ID4gLQlpOTE1X3dvcmtxdWV1ZXNfY2xlYW51cChkZXZfcHJpdik7Cj4gPiArCWk5MTVfd29ya3F1
ZXVlc19jbGVhbnVwKGk5MTUpOwo+ID4gICBlcnJfZW5naW5lczoKPiA+IC0JaTkxNV9lbmdpbmVz
X2NsZWFudXAoZGV2X3ByaXYpOwo+ID4gKwlpOTE1X2VuZ2luZXNfY2xlYW51cChpOTE1KTsKPiA+
ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGk5MTVfZHJpdmVyX2Ns
ZWFudXBfZWFybHkgLSBjbGVhbnVwIHRoZSBzZXR1cCBkb25lIGluIGk5MTVfZHJpdmVyX2luaXRf
ZWFybHkoKQo+ID4gLSAqIEBkZXZfcHJpdjogZGV2aWNlIHByaXZhdGUKPiA+ICsgKiBAaTkxNTog
ZGV2aWNlIHByaXZhdGUKPiA+ICAgICovCj4gPiAtc3RhdGljIHZvaWQgaTkxNV9kcml2ZXJfY2xl
YW51cF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGlj
IHZvaWQgaTkxNV9kcml2ZXJfY2xlYW51cF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gLQlpbnRlbF9pcnFfZmluaShkZXZfcHJpdik7Cj4gPiAtCWludGVs
X3Bvd2VyX2RvbWFpbnNfY2xlYW51cChkZXZfcHJpdik7Cj4gPiAtCWludGVsX3VjX2NsZWFudXBf
ZWFybHkoZGV2X3ByaXYpOwo+ID4gLQlpOTE1X2dlbV9jbGVhbnVwX2Vhcmx5KGRldl9wcml2KTsK
PiA+IC0JaTkxNV93b3JrcXVldWVzX2NsZWFudXAoZGV2X3ByaXYpOwo+ID4gLQlpOTE1X2VuZ2lu
ZXNfY2xlYW51cChkZXZfcHJpdik7Cj4gPiArCWludGVsX2lycV9maW5pKGk5MTUpOwo+ID4gKwlp
bnRlbF9wb3dlcl9kb21haW5zX2NsZWFudXAoaTkxNSk7Cj4gPiArCWludGVsX3VjX2NsZWFudXBf
ZWFybHkoaTkxNSk7Cj4gPiArCWk5MTVfZ2VtX2NsZWFudXBfZWFybHkoaTkxNSk7Cj4gPiArCWk5
MTVfd29ya3F1ZXVlc19jbGVhbnVwKGk5MTUpOwo+ID4gKwlpOTE1X2VuZ2luZXNfY2xlYW51cChp
OTE1KTsKPiA+IC0JcG1fcW9zX3JlbW92ZV9yZXF1ZXN0KCZkZXZfcHJpdi0+c2JfcW9zKTsKPiA+
IC0JbXV0ZXhfZGVzdHJveSgmZGV2X3ByaXYtPnNiX2xvY2spOwo+ID4gKwlwbV9xb3NfcmVtb3Zl
X3JlcXVlc3QoJmk5MTUtPnNiX3Fvcyk7Cj4gPiArCW11dGV4X2Rlc3Ryb3koJmk5MTUtPnNiX2xv
Y2spOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpOTE1X2RyaXZlcl9pbml0X21taW8gLSBz
ZXR1cCBkZXZpY2UgTU1JTwo+ID4gLSAqIEBkZXZfcHJpdjogZGV2aWNlIHByaXZhdGUKPiA+ICsg
KiBAaTkxNTogZGV2aWNlIHByaXZhdGUKPiA+ICAgICoKPiA+ICAgICogU2V0dXAgbWluaW1hbCBk
ZXZpY2Ugc3RhdGUgbmVjZXNzYXJ5IGZvciBNTUlPIGFjY2Vzc2VzIGxhdGVyIGluIHRoZQo+ID4g
ICAgKiBpbml0aWFsaXphdGlvbiBzZXF1ZW5jZS4gVGhlIHNldHVwIGhlcmUgc2hvdWxkIGF2b2lk
IGFueSBvdGhlciBkZXZpY2Utd2lkZQo+ID4gICAgKiBzaWRlIGVmZmVjdHMgb3IgZXhwb3Npbmcg
dGhlIGRyaXZlciB2aWEga2VybmVsIGludGVybmFsIG9yIHVzZXIgc3BhY2UKPiA+ICAgICogaW50
ZXJmYWNlcy4KPiA+ICAgICovCj4gPiAtc3RhdGljIGludCBpOTE1X2RyaXZlcl9pbml0X21taW8o
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBpbnQgaTkxNV9k
cml2ZXJfaW5pdF9tbWlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAgIAlpbnQgcmV0Owo+ID4gICAJaWYgKGk5MTVfaW5qZWN0X2xvYWRfZmFpbHVyZSgpKQo+ID4g
ICAJCXJldHVybiAtRU5PREVWOwo+ID4gLQlpZiAoaTkxNV9nZXRfYnJpZGdlX2RldihkZXZfcHJp
dikpCj4gPiArCWlmIChpOTE1X2dldF9icmlkZ2VfZGV2KGk5MTUpKQo+ID4gICAJCXJldHVybiAt
RUlPOwo+ID4gLQlyZXQgPSBpbnRlbF91bmNvcmVfaW5pdF9tbWlvKCZkZXZfcHJpdi0+dW5jb3Jl
KTsKPiA+ICsJcmV0ID0gaW50ZWxfdW5jb3JlX2luaXRfbW1pbygmaTkxNS0+dW5jb3JlKTsKPiA+
ICAgCWlmIChyZXQgPCAwKQo+ID4gICAJCWdvdG8gZXJyX2JyaWRnZTsKPiA+ICAgCS8qIFRyeSB0
byBtYWtlIHN1cmUgTUNIQkFSIGlzIGVuYWJsZWQgYmVmb3JlIHBva2luZyBhdCBpdCAqLwo+ID4g
LQlpbnRlbF9zZXR1cF9tY2hiYXIoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9zZXR1cF9tY2hiYXIo
aTkxNSk7Cj4gPiAtCWludGVsX2RldmljZV9pbmZvX2luaXRfbW1pbyhkZXZfcHJpdik7Cj4gPiAr
CWludGVsX2RldmljZV9pbmZvX2luaXRfbW1pbyhpOTE1KTsKPiA+IC0JaW50ZWxfdW5jb3JlX3By
dW5lX21taW9fZG9tYWlucygmZGV2X3ByaXYtPnVuY29yZSk7Cj4gPiArCWludGVsX3VuY29yZV9w
cnVuZV9tbWlvX2RvbWFpbnMoJmk5MTUtPnVuY29yZSk7Cj4gPiAtCWludGVsX3VjX2luaXRfbW1p
byhkZXZfcHJpdik7Cj4gPiArCWludGVsX3VjX2luaXRfbW1pbyhpOTE1KTsKPiA+IC0JcmV0ID0g
aW50ZWxfZW5naW5lc19pbml0X21taW8oZGV2X3ByaXYpOwo+ID4gKwlyZXQgPSBpbnRlbF9lbmdp
bmVzX2luaXRfbW1pbyhpOTE1KTsKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJZ290byBlcnJfdW5j
b3JlOwo+ID4gLQlpOTE1X2dlbV9pbml0X21taW8oZGV2X3ByaXYpOwo+ID4gKwlpOTE1X2dlbV9p
bml0X21taW8oaTkxNSk7Cj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgZXJyX3VuY29yZToKPiA+IC0J
aW50ZWxfdGVhcmRvd25fbWNoYmFyKGRldl9wcml2KTsKPiA+IC0JaW50ZWxfdW5jb3JlX2Zpbmlf
bW1pbygmZGV2X3ByaXYtPnVuY29yZSk7Cj4gPiArCWludGVsX3RlYXJkb3duX21jaGJhcihpOTE1
KTsKPiA+ICsJaW50ZWxfdW5jb3JlX2ZpbmlfbW1pbygmaTkxNS0+dW5jb3JlKTsKPiA+ICAgZXJy
X2JyaWRnZToKPiA+IC0JcGNpX2Rldl9wdXQoZGV2X3ByaXYtPmJyaWRnZV9kZXYpOwo+ID4gKwlw
Y2lfZGV2X3B1dChpOTE1LT5icmlkZ2VfZGV2KTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0K
PiA+ICAgLyoqCj4gPiAgICAqIGk5MTVfZHJpdmVyX2NsZWFudXBfbW1pbyAtIGNsZWFudXAgdGhl
IHNldHVwIGRvbmUgaW4gaTkxNV9kcml2ZXJfaW5pdF9tbWlvKCkKPiA+IC0gKiBAZGV2X3ByaXY6
IGRldmljZSBwcml2YXRlCj4gPiArICogQGk5MTU6IGRldmljZSBwcml2YXRlCj4gPiAgICAqLwo+
ID4gLXN0YXRpYyB2b2lkIGk5MTVfZHJpdmVyX2NsZWFudXBfbW1pbyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaTkxNV9kcml2ZXJfY2xlYW51cF9t
bWlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWludGVsX3Rl
YXJkb3duX21jaGJhcihkZXZfcHJpdik7Cj4gPiAtCWludGVsX3VuY29yZV9maW5pX21taW8oJmRl
dl9wcml2LT51bmNvcmUpOwo+ID4gLQlwY2lfZGV2X3B1dChkZXZfcHJpdi0+YnJpZGdlX2Rldik7
Cj4gPiArCWludGVsX3RlYXJkb3duX21jaGJhcihpOTE1KTsKPiA+ICsJaW50ZWxfdW5jb3JlX2Zp
bmlfbW1pbygmaTkxNS0+dW5jb3JlKTsKPiA+ICsJcGNpX2Rldl9wdXQoaTkxNS0+YnJpZGdlX2Rl
dik7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9zYW5pdGl6ZV9vcHRpb25zKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9zYW5p
dGl6ZV9vcHRpb25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAt
CWludGVsX2d2dF9zYW5pdGl6ZV9vcHRpb25zKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfZ3Z0X3Nh
bml0aXplX29wdGlvbnMoaTkxNSk7Cj4gPiAgIH0KPiA+ICAgI2RlZmluZSBEUkFNX1RZUEVfU1RS
KHR5cGUpIFtJTlRFTF9EUkFNXyAjIyB0eXBlXSA9ICN0eXBlCj4gPiBAQCAtMTEzMSwxMSArMTEz
MSwxMSBAQCBza2xfaXNfMTZnYl9kaW1tKGNvbnN0IHN0cnVjdCBkcmFtX2RpbW1faW5mbyAqZGlt
bSkKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZAo+ID4gLXNrbF9kcmFtX2dldF9kaW1tX2luZm8o
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3NrbF9kcmFtX2dldF9kaW1t
X2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICAgIHN0cnVj
dCBkcmFtX2RpbW1faW5mbyAqZGltbSwKPiA+ICAgCQkgICAgICAgaW50IGNoYW5uZWwsIGNoYXIg
ZGltbV9uYW1lLCB1MTYgdmFsKQo+ID4gICB7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDEwKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTApIHsKPiA+ICAgCQlkaW1t
LT5zaXplID0gY25sX2dldF9kaW1tX3NpemUodmFsKTsKPiA+ICAgCQlkaW1tLT53aWR0aCA9IGNu
bF9nZXRfZGltbV93aWR0aCh2YWwpOwo+ID4gICAJCWRpbW0tPnJhbmtzID0gY25sX2dldF9kaW1t
X3JhbmtzKHZhbCk7Cj4gPiBAQCAtMTE1MSwxMyArMTE1MSwxMyBAQCBza2xfZHJhbV9nZXRfZGlt
bV9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgfQo+ID4gICBz
dGF0aWMgaW50Cj4gPiAtc2tsX2RyYW1fZ2V0X2NoYW5uZWxfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc2tsX2RyYW1fZ2V0X2NoYW5uZWxfaW5mbyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICBzdHJ1Y3QgZHJhbV9jaGFubmVsX2lu
Zm8gKmNoLAo+ID4gICAJCQkgIGludCBjaGFubmVsLCB1MzIgdmFsKQo+ID4gICB7Cj4gPiAtCXNr
bF9kcmFtX2dldF9kaW1tX2luZm8oZGV2X3ByaXYsICZjaC0+ZGltbV9sLAo+ID4gKwlza2xfZHJh
bV9nZXRfZGltbV9pbmZvKGk5MTUsICZjaC0+ZGltbV9sLAo+ID4gICAJCQkgICAgICAgY2hhbm5l
bCwgJ0wnLCB2YWwgJiAweGZmZmYpOwo+ID4gLQlza2xfZHJhbV9nZXRfZGltbV9pbmZvKGRldl9w
cml2LCAmY2gtPmRpbW1fcywKPiA+ICsJc2tsX2RyYW1fZ2V0X2RpbW1faW5mbyhpOTE1LCAmY2gt
PmRpbW1fcywKPiA+ICAgCQkJICAgICAgIGNoYW5uZWwsICdTJywgdmFsID4+IDE2KTsKPiA+ICAg
CWlmIChjaC0+ZGltbV9sLnNpemUgPT0gMCAmJiBjaC0+ZGltbV9zLnNpemUgPT0gMCkgewo+ID4g
QEAgLTExOTIsMjAgKzExOTIsMjAgQEAgaW50ZWxfaXNfZHJhbV9zeW1tZXRyaWMoY29uc3Qgc3Ry
dWN0IGRyYW1fY2hhbm5lbF9pbmZvICpjaDAsCj4gPiAgIH0KPiA+ICAgc3RhdGljIGludAo+ID4g
LXNrbF9kcmFtX2dldF9jaGFubmVsc19pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtza2xfZHJhbV9nZXRfY2hhbm5lbHNfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJhbV9pbmZvICpkcmFtX2luZm8gPSAm
ZGV2X3ByaXYtPmRyYW1faW5mbzsKPiA+ICsJc3RydWN0IGRyYW1faW5mbyAqZHJhbV9pbmZvID0g
Jmk5MTUtPmRyYW1faW5mbzsKPiA+ICAgCXN0cnVjdCBkcmFtX2NoYW5uZWxfaW5mbyBjaDAgPSB7
fSwgY2gxID0ge307Cj4gPiAgIAl1MzIgdmFsOwo+ID4gICAJaW50IHJldDsKPiA+ICAgCXZhbCA9
IEk5MTVfUkVBRChTS0xfTUFEX0RJTU1fQ0gwXzBfMF8wX01DSEJBUl9NQ01BSU4pOwo+ID4gLQly
ZXQgPSBza2xfZHJhbV9nZXRfY2hhbm5lbF9pbmZvKGRldl9wcml2LCAmY2gwLCAwLCB2YWwpOwo+
ID4gKwlyZXQgPSBza2xfZHJhbV9nZXRfY2hhbm5lbF9pbmZvKGk5MTUsICZjaDAsIDAsIHZhbCk7
Cj4gPiAgIAlpZiAocmV0ID09IDApCj4gPiAgIAkJZHJhbV9pbmZvLT5udW1fY2hhbm5lbHMrKzsK
PiA+ICAgCXZhbCA9IEk5MTVfUkVBRChTS0xfTUFEX0RJTU1fQ0gxXzBfMF8wX01DSEJBUl9NQ01B
SU4pOwo+ID4gLQlyZXQgPSBza2xfZHJhbV9nZXRfY2hhbm5lbF9pbmZvKGRldl9wcml2LCAmY2gx
LCAxLCB2YWwpOwo+ID4gKwlyZXQgPSBza2xfZHJhbV9nZXRfY2hhbm5lbF9pbmZvKGk5MTUsICZj
aDEsIDEsIHZhbCk7Cj4gPiAgIAlpZiAocmV0ID09IDApCj4gPiAgIAkJZHJhbV9pbmZvLT5udW1f
Y2hhbm5lbHMrKzsKPiA+IEBAIC0xMjM5LDcgKzEyMzksNyBAQCBza2xfZHJhbV9nZXRfY2hhbm5l
bHNfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIH0KPiA+ICAg
c3RhdGljIGVudW0gaW50ZWxfZHJhbV90eXBlCj4gPiAtc2tsX2dldF9kcmFtX3R5cGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3NrbF9nZXRfZHJhbV90eXBlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gQEAg
LTEyNjEsMTYgKzEyNjEsMTYgQEAgc2tsX2dldF9kcmFtX3R5cGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQKPiA+IC1za2xfZ2V0X2Ry
YW1faW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc2tsX2dldF9k
cmFtX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRyYW1faW5mbyAqZHJhbV9pbmZvID0gJmRldl9wcml2LT5kcmFtX2luZm87Cj4gPiArCXN0
cnVjdCBkcmFtX2luZm8gKmRyYW1faW5mbyA9ICZpOTE1LT5kcmFtX2luZm87Cj4gPiAgIAl1MzIg
bWVtX2ZyZXFfa2h6LCB2YWw7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gLQlkcmFtX2luZm8tPnR5cGUg
PSBza2xfZ2V0X2RyYW1fdHlwZShkZXZfcHJpdik7Cj4gPiArCWRyYW1faW5mby0+dHlwZSA9IHNr
bF9nZXRfZHJhbV90eXBlKGk5MTUpOwo+ID4gICAJRFJNX0RFQlVHX0tNUygiRFJBTSB0eXBlOiAl
c1xuIiwgaW50ZWxfZHJhbV90eXBlX3N0cihkcmFtX2luZm8tPnR5cGUpKTsKPiA+IC0JcmV0ID0g
c2tsX2RyYW1fZ2V0X2NoYW5uZWxzX2luZm8oZGV2X3ByaXYpOwo+ID4gKwlyZXQgPSBza2xfZHJh
bV9nZXRfY2hhbm5lbHNfaW5mbyhpOTE1KTsKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJcmV0dXJu
IHJldDsKPiA+IEBAIC0xMzcwLDkgKzEzNzAsOSBAQCBzdGF0aWMgdm9pZCBieHRfZ2V0X2RpbW1f
aW5mbyhzdHJ1Y3QgZHJhbV9kaW1tX2luZm8gKmRpbW0sCj4gPiAgIH0KPiA+ICAgc3RhdGljIGlu
dAo+ID4gLWJ4dF9nZXRfZHJhbV9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICtieHRfZ2V0X2RyYW1faW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJhbV9pbmZvICpkcmFtX2luZm8gPSAmZGV2X3ByaXYtPmRy
YW1faW5mbzsKPiA+ICsJc3RydWN0IGRyYW1faW5mbyAqZHJhbV9pbmZvID0gJmk5MTUtPmRyYW1f
aW5mbzsKPiA+ICAgCXUzMiBkcmFtX2NoYW5uZWxzOwo+ID4gICAJdTMyIG1lbV9mcmVxX2toeiwg
dmFsOwo+ID4gICAJdTggbnVtX2FjdGl2ZV9jaGFubmVsczsKPiA+IEBAIC0xNDQzLDkgKzE0NDMs
OSBAQCBieHRfZ2V0X2RyYW1faW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQKPiA+IC1pbnRlbF9nZXRfZHJhbV9pbmZvKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnRlbF9nZXRfZHJhbV9pbmZvKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcmFtX2lu
Zm8gKmRyYW1faW5mbyA9ICZkZXZfcHJpdi0+ZHJhbV9pbmZvOwo+ID4gKwlzdHJ1Y3QgZHJhbV9p
bmZvICpkcmFtX2luZm8gPSAmaTkxNS0+ZHJhbV9pbmZvOwo+ID4gICAJaW50IHJldDsKPiA+ICAg
CS8qCj4gPiBAQCAtMTQ1MywxNSArMTQ1MywxNSBAQCBpbnRlbF9nZXRfZHJhbV9pbmZvKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIFRoaXMgaXMgb25seSB1c2Vk
IGZvciB0aGUgbGV2ZWwgMCB3YXRlcm1hcmsgbGF0ZW5jeQo+ID4gICAJICogdy9hIHdoaWNoIGRv
ZXMgbm90IGFwcGx5IHRvIGJ4dC9nbGsuCj4gPiAgIAkgKi8KPiA+IC0JZHJhbV9pbmZvLT5pc18x
NmdiX2RpbW0gPSAhSVNfR0VOOV9MUChkZXZfcHJpdik7Cj4gPiArCWRyYW1faW5mby0+aXNfMTZn
Yl9kaW1tID0gIUlTX0dFTjlfTFAoaTkxNSk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
IDwgOSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDkpCj4gPiAgIAkJcmV0dXJuOwo+ID4g
LQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gPiAtCQlyZXQgPSBieHRfZ2V0X2RyYW1faW5m
byhkZXZfcHJpdik7Cj4gPiArCWlmIChJU19HRU45X0xQKGk5MTUpKQo+ID4gKwkJcmV0ID0gYnh0
X2dldF9kcmFtX2luZm8oaTkxNSk7Cj4gPiAgIAllbHNlCj4gPiAtCQlyZXQgPSBza2xfZ2V0X2Ry
YW1faW5mbyhkZXZfcHJpdik7Cj4gPiArCQlyZXQgPSBza2xfZ2V0X2RyYW1faW5mbyhpOTE1KTsK
PiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJcmV0dXJuOwo+ID4gQEAgLTE0NzMsNyArMTQ3Myw3IEBA
IGludGVsX2dldF9kcmFtX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gICAJCSAgICAgIGRyYW1faW5mby0+cmFua3MsIHllc25vKGRyYW1faW5mby0+aXNfMTZnYl9k
aW1tKSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTMyIGdlbjlfZWRyYW1fc2l6ZV9tYihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBjYXApCj4gPiArc3RhdGljIHUzMiBnZW45
X2VkcmFtX3NpemVfbWIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBjYXApCj4g
PiAgIHsKPiA+ICAgCWNvbnN0IHVuc2lnbmVkIGludCB3YXlzWzhdID0geyA0LCA4LCAxMiwgMTYs
IDE2LCAxNiwgMTYsIDE2IH07Cj4gPiAgIAljb25zdCB1bnNpZ25lZCBpbnQgc2V0c1s0XSA9IHsg
MSwgMSwgMiwgMiB9Owo+ID4gQEAgLTE0ODMsMTYgKzE0ODMsMTYgQEAgc3RhdGljIHUzMiBnZW45
X2VkcmFtX3NpemVfbWIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgY2Fw
KQo+ID4gICAJCXNldHNbRURSQU1fU0VUU19JRFgoY2FwKV07Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
dm9pZCBlZHJhbV9kZXRlY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K3N0YXRpYyB2b2lkIGVkcmFtX2RldGVjdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiA+ICAgewo+ID4gICAJdTMyIGVkcmFtX2NhcCA9IDA7Cj4gPiAtCWlmICghKElTX0hBU1dFTEwo
ZGV2X3ByaXYpIHx8Cj4gPiAtCSAgICAgIElTX0JST0FEV0VMTChkZXZfcHJpdikgfHwKPiA+IC0J
ICAgICAgSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSkKPiA+ICsJaWYgKCEoSVNfSEFTV0VMTChp
OTE1KSB8fAo+ID4gKwkgICAgICBJU19CUk9BRFdFTEwoaTkxNSkgfHwKPiA+ICsJICAgICAgSU5U
RUxfR0VOKGk5MTUpID49IDkpKQo+ID4gICAJCXJldHVybjsKPiA+IC0JZWRyYW1fY2FwID0gX19y
YXdfdW5jb3JlX3JlYWQzMigmZGV2X3ByaXYtPnVuY29yZSwgSFNXX0VEUkFNX0NBUCk7Cj4gPiAr
CWVkcmFtX2NhcCA9IF9fcmF3X3VuY29yZV9yZWFkMzIoJmk5MTUtPnVuY29yZSwgSFNXX0VEUkFN
X0NBUCk7Cj4gPiAgIAkvKiBOQjogV2UgY2FuJ3Qgd3JpdGUgSURJQ1IgeWV0IGJlY2F1c2Ugd2Ug
ZG9uJ3QgaGF2ZSBndCBmdW5jcyBzZXQgdXAgKi8KPiA+IEBAIC0xNTAzLDYzICsxNTAzLDYzIEBA
IHN0YXRpYyB2b2lkIGVkcmFtX2RldGVjdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiAgIAkgKiBUaGUgbmVlZGVkIGNhcGFiaWxpdHkgYml0cyBmb3Igc2l6ZSBjYWxjdWxh
dGlvbiBhcmUgbm90IHRoZXJlIHdpdGgKPiA+ICAgCSAqIHByZSBnZW45IHNvIHJldHVybiAxMjhN
QiBhbHdheXMuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA5KQo+
ID4gLQkJZGV2X3ByaXYtPmVkcmFtX3NpemVfbWIgPSAxMjg7Cj4gPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPCA5KQo+ID4gKwkJaTkxNS0+ZWRyYW1fc2l6ZV9tYiA9IDEyODsKPiA+ICAgCWVsc2UK
PiA+IC0JCWRldl9wcml2LT5lZHJhbV9zaXplX21iID0KPiA+IC0JCQlnZW45X2VkcmFtX3NpemVf
bWIoZGV2X3ByaXYsIGVkcmFtX2NhcCk7Cj4gPiArCQlpOTE1LT5lZHJhbV9zaXplX21iID0KPiA+
ICsJCQlnZW45X2VkcmFtX3NpemVfbWIoaTkxNSwgZWRyYW1fY2FwKTsKPiA+IC0JRFJNX0lORk8o
IkZvdW5kICV1TUIgb2YgZURSQU1cbiIsIGRldl9wcml2LT5lZHJhbV9zaXplX21iKTsKPiA+ICsJ
RFJNX0lORk8oIkZvdW5kICV1TUIgb2YgZURSQU1cbiIsIGk5MTUtPmVkcmFtX3NpemVfbWIpOwo+
ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpOTE1X2RyaXZlcl9pbml0X2h3IC0gc2V0dXAgc3Rh
dGUgcmVxdWlyaW5nIGRldmljZSBhY2Nlc3MKPiA+IC0gKiBAZGV2X3ByaXY6IGRldmljZSBwcml2
YXRlCj4gPiArICogQGk5MTU6IGRldmljZSBwcml2YXRlCj4gPiAgICAqCj4gPiAgICAqIFNldHVw
IHN0YXRlIHRoYXQgcmVxdWlyZXMgYWNjZXNzaW5nIHRoZSBkZXZpY2UsIGJ1dCBkb2Vzbid0IHJl
cXVpcmUKPiA+ICAgICogZXhwb3NpbmcgdGhlIGRyaXZlciB2aWEga2VybmVsIGludGVybmFsIG9y
IHVzZXJzcGFjZSBpbnRlcmZhY2VzLgo+ID4gICAgKi8KPiA+IC1zdGF0aWMgaW50IGk5MTVfZHJp
dmVyX2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRp
YyBpbnQgaTkxNV9kcml2ZXJfaW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsK
PiA+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiA+ICAgCWludCBy
ZXQ7Cj4gPiAgIAlpZiAoaTkxNV9pbmplY3RfbG9hZF9mYWlsdXJlKCkpCj4gPiAgIAkJcmV0dXJu
IC1FTk9ERVY7Cj4gPiAtCWludGVsX2RldmljZV9pbmZvX3J1bnRpbWVfaW5pdChkZXZfcHJpdik7
Cj4gPiArCWludGVsX2RldmljZV9pbmZvX3J1bnRpbWVfaW5pdChpOTE1KTsKPiA+IC0JaWYgKEhB
U19QUEdUVChkZXZfcHJpdikpIHsKPiA+IC0JCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShkZXZfcHJp
dikgJiYKPiA+IC0JCSAgICAhaW50ZWxfdmdwdV9oYXNfZnVsbF9wcGd0dChkZXZfcHJpdikpIHsK
PiA+IC0JCQlpOTE1X3JlcG9ydF9lcnJvcihkZXZfcHJpdiwKPiA+ICsJaWYgKEhBU19QUEdUVChp
OTE1KSkgewo+ID4gKwkJaWYgKGludGVsX3ZncHVfYWN0aXZlKGk5MTUpICYmCj4gPiArCQkgICAg
IWludGVsX3ZncHVfaGFzX2Z1bGxfcHBndHQoaTkxNSkpIHsKPiA+ICsJCQlpOTE1X3JlcG9ydF9l
cnJvcihpOTE1LAo+ID4gICAJCQkJCSAgImluY29tcGF0aWJsZSB2R1BVIGZvdW5kLCBzdXBwb3J0
IGZvciBpc29sYXRlZCBwcEdUVCByZXF1aXJlZFxuIik7Cj4gPiAgIAkJCXJldHVybiAtRU5YSU87
Cj4gPiAgIAkJfQo+ID4gICAJfQo+ID4gLQlpZiAoSEFTX0VYRUNMSVNUUyhkZXZfcHJpdikpIHsK
PiA+ICsJaWYgKEhBU19FWEVDTElTVFMoaTkxNSkpIHsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIE9s
ZGVyIEdWVCBlbXVsYXRpb24gZGVwZW5kcyB1cG9uIGludGVyY2VwdGluZyBDU0IgbW1pbywKPiA+
ICAgCQkgKiB3aGljaCB3ZSBubyBsb25nZXIgdXNlLCBwcmVmZXJyaW5nIHRvIHVzZSB0aGUgSFdT
UCBjYWNoZQo+ID4gICAJCSAqIGluc3RlYWQuCj4gPiAgIAkJICovCj4gPiAtCQlpZiAoaW50ZWxf
dmdwdV9hY3RpdmUoZGV2X3ByaXYpICYmCj4gPiAtCQkgICAgIWludGVsX3ZncHVfaGFzX2h3c3Bf
ZW11bGF0aW9uKGRldl9wcml2KSkgewo+ID4gLQkJCWk5MTVfcmVwb3J0X2Vycm9yKGRldl9wcml2
LAo+ID4gKwkJaWYgKGludGVsX3ZncHVfYWN0aXZlKGk5MTUpICYmCj4gPiArCQkgICAgIWludGVs
X3ZncHVfaGFzX2h3c3BfZW11bGF0aW9uKGk5MTUpKSB7Cj4gPiArCQkJaTkxNV9yZXBvcnRfZXJy
b3IoaTkxNSwKPiA+ICAgCQkJCQkgICJvbGQgdkdQVSBob3N0IGZvdW5kLCBzdXBwb3J0IGZvciBI
V1NQIGVtdWxhdGlvbiByZXF1aXJlZFxuIik7Cj4gPiAgIAkJCXJldHVybiAtRU5YSU87Cj4gPiAg
IAkJfQo+ID4gICAJfQo+ID4gLQlpbnRlbF9zYW5pdGl6ZV9vcHRpb25zKGRldl9wcml2KTsKPiA+
ICsJaW50ZWxfc2FuaXRpemVfb3B0aW9ucyhpOTE1KTsKPiA+ICAgCS8qIG5lZWRzIHRvIGJlIGRv
bmUgYmVmb3JlIGdndHQgcHJvYmUgKi8KPiA+IC0JZWRyYW1fZGV0ZWN0KGRldl9wcml2KTsKPiA+
ICsJZWRyYW1fZGV0ZWN0KGk5MTUpOwo+ID4gLQlpOTE1X3BlcmZfaW5pdChkZXZfcHJpdik7Cj4g
PiArCWk5MTVfcGVyZl9pbml0KGk5MTUpOwo+ID4gLQlyZXQgPSBpOTE1X2dndHRfcHJvYmVfaHco
ZGV2X3ByaXYpOwo+ID4gKwlyZXQgPSBpOTE1X2dndHRfcHJvYmVfaHcoaTkxNSk7Cj4gPiAgIAlp
ZiAocmV0KQo+ID4gICAJCWdvdG8gZXJyX3BlcmY7Cj4gPiBAQCAtMTU2Nyw3ICsxNTY3LDcgQEAg
c3RhdGljIGludCBpOTE1X2RyaXZlcl9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICAgCSAqIFdBUk5JTkc6IEFwcGFyZW50bHkgd2UgbXVzdCBraWNrIGZiZGV2
IGRyaXZlcnMgYmVmb3JlIHZnYWNvbiwKPiA+ICAgCSAqIG90aGVyd2lzZSB0aGUgdmdhIGZiZGV2
IGRyaXZlciBmYWxscyBvdmVyLgo+ID4gICAJICovCj4gPiAtCXJldCA9IGk5MTVfa2lja19vdXRf
ZmlybXdhcmVfZmIoZGV2X3ByaXYpOwo+ID4gKwlyZXQgPSBpOTE1X2tpY2tfb3V0X2Zpcm13YXJl
X2ZiKGk5MTUpOwo+ID4gICAJaWYgKHJldCkgewo+ID4gICAJCURSTV9FUlJPUigiZmFpbGVkIHRv
IHJlbW92ZSBjb25mbGljdGluZyBmcmFtZWJ1ZmZlciBkcml2ZXJzXG4iKTsKPiA+ICAgCQlnb3Rv
IGVycl9nZ3R0Owo+ID4gQEAgLTE1NzksMTEgKzE1NzksMTEgQEAgc3RhdGljIGludCBpOTE1X2Ry
aXZlcl9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQln
b3RvIGVycl9nZ3R0Owo+ID4gICAJfQo+ID4gLQlyZXQgPSBpOTE1X2dndHRfaW5pdF9odyhkZXZf
cHJpdik7Cj4gPiArCXJldCA9IGk5MTVfZ2d0dF9pbml0X2h3KGk5MTUpOwo+ID4gICAJaWYgKHJl
dCkKPiA+ICAgCQlnb3RvIGVycl9nZ3R0Owo+ID4gLQlyZXQgPSBpOTE1X2dndHRfZW5hYmxlX2h3
KGRldl9wcml2KTsKPiA+ICsJcmV0ID0gaTkxNV9nZ3R0X2VuYWJsZV9odyhpOTE1KTsKPiA+ICAg
CWlmIChyZXQpIHsKPiA+ICAgCQlEUk1fRVJST1IoImZhaWxlZCB0byBlbmFibGUgR0dUVFxuIik7
Cj4gPiAgIAkJZ290byBlcnJfZ2d0dDsKPiA+IEBAIC0xNTkyLDcgKzE1OTIsNyBAQCBzdGF0aWMg
aW50IGk5MTVfZHJpdmVyX2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gICAJcGNpX3NldF9tYXN0ZXIocGRldik7Cj4gPiAgIAkvKiBvdmVybGF5IG9uIGdlbjIg
aXMgYnJva2VuIGFuZCBjYW4ndCBhZGRyZXNzIGFib3ZlIDFHICovCj4gPiAtCWlmIChJU19HRU4o
ZGV2X3ByaXYsIDIpKSB7Cj4gPiArCWlmIChJU19HRU4oaTkxNSwgMikpIHsKPiA+ICAgCQlyZXQg
PSBkbWFfc2V0X2NvaGVyZW50X21hc2soJnBkZXYtPmRldiwgRE1BX0JJVF9NQVNLKDMwKSk7Cj4g
PiAgIAkJaWYgKHJldCkgewo+ID4gICAJCQlEUk1fRVJST1IoImZhaWxlZCB0byBzZXQgRE1BIG1h
c2tcbiIpOwo+ID4gQEAgLTE2MDksNyArMTYwOSw3IEBAIHN0YXRpYyBpbnQgaTkxNV9kcml2ZXJf
aW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiBiZWhh
dmlvdXIgaWYgYW55IGdlbmVyYWwgc3RhdGUgaXMgYWNjZXNzZWQgd2l0aGluIGEgcGFnZSBhYm92
ZSA0R0IsCj4gPiAgIAkgKiB3aGljaCBhbHNvIG5lZWRzIHRvIGJlIGhhbmRsZWQgY2FyZWZ1bGx5
Lgo+ID4gICAJICovCj4gPiAtCWlmIChJU19JOTY1RyhkZXZfcHJpdikgfHwgSVNfSTk2NUdNKGRl
dl9wcml2KSkgewo+ID4gKwlpZiAoSVNfSTk2NUcoaTkxNSkgfHwgSVNfSTk2NUdNKGk5MTUpKSB7
Cj4gPiAgIAkJcmV0ID0gZG1hX3NldF9jb2hlcmVudF9tYXNrKCZwZGV2LT5kZXYsIERNQV9CSVRf
TUFTSygzMikpOwo+ID4gICAJCWlmIChyZXQpIHsKPiA+IEBAIC0xNjE5LDEzICsxNjE5LDEzIEBA
IHN0YXRpYyBpbnQgaTkxNV9kcml2ZXJfaW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiAgIAkJfQo+ID4gICAJfQo+ID4gLQlwbV9xb3NfYWRkX3JlcXVlc3QoJmRl
dl9wcml2LT5wbV9xb3MsIFBNX1FPU19DUFVfRE1BX0xBVEVOQ1ksCj4gPiArCXBtX3Fvc19hZGRf
cmVxdWVzdCgmaTkxNS0+cG1fcW9zLCBQTV9RT1NfQ1BVX0RNQV9MQVRFTkNZLAo+ID4gICAJCQkg
ICBQTV9RT1NfREVGQVVMVF9WQUxVRSk7Cj4gPiAtCWludGVsX3VuY29yZV9zYW5pdGl6ZShkZXZf
cHJpdik7Cj4gPiArCWludGVsX3VuY29yZV9zYW5pdGl6ZShpOTE1KTsKPiA+IC0JaW50ZWxfZ3Rf
aW5pdF93b3JrYXJvdW5kcyhkZXZfcHJpdik7Cj4gPiAtCWk5MTVfZ2VtX2xvYWRfaW5pdF9mZW5j
ZXMoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9ndF9pbml0X3dvcmthcm91bmRzKGk5MTUpOwo+ID4g
KwlpOTE1X2dlbV9sb2FkX2luaXRfZmVuY2VzKGk5MTUpOwo+ID4gICAJLyogT24gdGhlIDk0NUcv
R00sIHRoZSBjaGlwc2V0IHJlcG9ydHMgdGhlIE1TSSBjYXBhYmlsaXR5IG9uIHRoZQo+ID4gICAJ
ICogaW50ZWdyYXRlZCBncmFwaGljcyBldmVuIHRob3VnaCB0aGUgc3VwcG9ydCBpc24ndCBhY3R1
YWxseSB0aGVyZQo+ID4gQEAgLTE2NDYsOTQgKzE2NDYsOTQgQEAgc3RhdGljIGludCBpOTE1X2Ry
aXZlcl9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAq
IGRldmljZS4gVGhlIGtlcm5lbCB0aGVuIGRpc2FibGVzIHRoYXQgaW50ZXJydXB0IHNvdXJjZSBh
bmQgc28KPiA+ICAgCSAqIHByZXZlbnRzIHRoZSBvdGhlciBkZXZpY2UgZnJvbSB3b3JraW5nIHBy
b3Blcmx5Lgo+ID4gICAJICovCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDUpIHsK
PiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA1KSB7Cj4gPiAgIAkJaWYgKHBjaV9lbmFibGVf
bXNpKHBkZXYpIDwgMCkKPiA+ICAgCQkJRFJNX0RFQlVHX0RSSVZFUigiY2FuJ3QgZW5hYmxlIE1T
SSIpOwo+ID4gICAJfQo+ID4gLQlyZXQgPSBpbnRlbF9ndnRfaW5pdChkZXZfcHJpdik7Cj4gPiAr
CXJldCA9IGludGVsX2d2dF9pbml0KGk5MTUpOwo+ID4gICAJaWYgKHJldCkKPiA+ICAgCQlnb3Rv
IGVycl9tc2k7Cj4gPiAtCWludGVsX29wcmVnaW9uX3NldHVwKGRldl9wcml2KTsKPiA+ICsJaW50
ZWxfb3ByZWdpb25fc2V0dXAoaTkxNSk7Cj4gPiAgIAkvKgo+ID4gICAJICogRmlsbCB0aGUgZHJh
bSBzdHJ1Y3R1cmUgdG8gZ2V0IHRoZSBzeXN0ZW0gcmF3IGJhbmR3aWR0aCBhbmQKPiA+ICAgCSAq
IGRyYW0gaW5mby4gVGhpcyB3aWxsIGJlIHVzZWQgZm9yIG1lbW9yeSBsYXRlbmN5IGNhbGN1bGF0
aW9uLgo+ID4gICAJICovCj4gPiAtCWludGVsX2dldF9kcmFtX2luZm8oZGV2X3ByaXYpOwo+ID4g
KwlpbnRlbF9nZXRfZHJhbV9pbmZvKGk5MTUpOwo+ID4gLQlpbnRlbF9id19pbml0X2h3KGRldl9w
cml2KTsKPiA+ICsJaW50ZWxfYndfaW5pdF9odyhpOTE1KTsKPiA+ICAgCXJldHVybiAwOwo+ID4g
ICBlcnJfbXNpOgo+ID4gICAJaWYgKHBkZXYtPm1zaV9lbmFibGVkKQo+ID4gICAJCXBjaV9kaXNh
YmxlX21zaShwZGV2KTsKPiA+IC0JcG1fcW9zX3JlbW92ZV9yZXF1ZXN0KCZkZXZfcHJpdi0+cG1f
cW9zKTsKPiA+ICsJcG1fcW9zX3JlbW92ZV9yZXF1ZXN0KCZpOTE1LT5wbV9xb3MpOwo+ID4gICBl
cnJfZ2d0dDoKPiA+IC0JaTkxNV9nZ3R0X2NsZWFudXBfaHcoZGV2X3ByaXYpOwo+ID4gKwlpOTE1
X2dndHRfY2xlYW51cF9odyhpOTE1KTsKPiA+ICAgZXJyX3BlcmY6Cj4gPiAtCWk5MTVfcGVyZl9m
aW5pKGRldl9wcml2KTsKPiA+ICsJaTkxNV9wZXJmX2ZpbmkoaTkxNSk7Cj4gPiAgIAlyZXR1cm4g
cmV0Owo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpOTE1X2RyaXZlcl9jbGVhbnVwX2h3IC0g
Y2xlYW51cCB0aGUgc2V0dXAgZG9uZSBpbiBpOTE1X2RyaXZlcl9pbml0X2h3KCkKPiA+IC0gKiBA
ZGV2X3ByaXY6IGRldmljZSBwcml2YXRlCj4gPiArICogQGk5MTU6IGRldmljZSBwcml2YXRlCj4g
PiAgICAqLwo+ID4gLXN0YXRpYyB2b2lkIGk5MTVfZHJpdmVyX2NsZWFudXBfaHcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGk5MTVfZHJpdmVyX2Ns
ZWFudXBfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gPiArCXN0cnVjdCBwY2lf
ZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiAtCWk5MTVfcGVyZl9maW5pKGRldl9wcml2
KTsKPiA+ICsJaTkxNV9wZXJmX2ZpbmkoaTkxNSk7Cj4gPiAgIAlpZiAocGRldi0+bXNpX2VuYWJs
ZWQpCj4gPiAgIAkJcGNpX2Rpc2FibGVfbXNpKHBkZXYpOwo+ID4gLQlwbV9xb3NfcmVtb3ZlX3Jl
cXVlc3QoJmRldl9wcml2LT5wbV9xb3MpOwo+ID4gKwlwbV9xb3NfcmVtb3ZlX3JlcXVlc3QoJmk5
MTUtPnBtX3Fvcyk7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGk5MTVfZHJpdmVyX3JlZ2lz
dGVyIC0gcmVnaXN0ZXIgdGhlIGRyaXZlciB3aXRoIHRoZSByZXN0IG9mIHRoZSBzeXN0ZW0KPiA+
IC0gKiBAZGV2X3ByaXY6IGRldmljZSBwcml2YXRlCj4gPiArICogQGk5MTU6IGRldmljZSBwcml2
YXRlCj4gPiAgICAqCj4gPiAgICAqIFBlcmZvcm0gYW55IHN0ZXBzIG5lY2Vzc2FyeSB0byBtYWtl
IHRoZSBkcml2ZXIgYXZhaWxhYmxlIHZpYSBrZXJuZWwKPiA+ICAgICogaW50ZXJuYWwgb3IgdXNl
cnNwYWNlIGludGVyZmFjZXMuCj4gPiAgICAqLwo+ID4gLXN0YXRpYyB2b2lkIGk5MTVfZHJpdmVy
X3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMg
dm9pZCBpOTE1X2RyaXZlcl9yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4g
PiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ID4gLQlpOTE1X2dlbV9z
aHJpbmtlcl9yZWdpc3RlcihkZXZfcHJpdik7Cj4gPiAtCWk5MTVfcG11X3JlZ2lzdGVyKGRldl9w
cml2KTsKPiA+ICsJaTkxNV9nZW1fc2hyaW5rZXJfcmVnaXN0ZXIoaTkxNSk7Cj4gPiArCWk5MTVf
cG11X3JlZ2lzdGVyKGk5MTUpOwo+ID4gICAJLyoKPiA+ICAgCSAqIE5vdGlmeSBhIHZhbGlkIHN1
cmZhY2UgYWZ0ZXIgbW9kZXNldHRpbmcsCj4gPiAgIAkgKiB3aGVuIHJ1bm5pbmcgaW5zaWRlIGEg
Vk0uCj4gPiAgIAkgKi8KPiA+IC0JaWYgKGludGVsX3ZncHVfYWN0aXZlKGRldl9wcml2KSkKPiA+
ICsJaWYgKGludGVsX3ZncHVfYWN0aXZlKGk5MTUpKQo+ID4gICAJCUk5MTVfV1JJVEUodmd0aWZf
cmVnKGRpc3BsYXlfcmVhZHkpLCBWR1RfRFJWX0RJU1BMQVlfUkVBRFkpOwo+ID4gICAJLyogUmV2
ZWFsIG91ciBwcmVzZW5jZSB0byB1c2Vyc3BhY2UgKi8KPiA+ICAgCWlmIChkcm1fZGV2X3JlZ2lz
dGVyKGRldiwgMCkgPT0gMCkgewo+ID4gLQkJaTkxNV9kZWJ1Z2ZzX3JlZ2lzdGVyKGRldl9wcml2
KTsKPiA+IC0JCWk5MTVfc2V0dXBfc3lzZnMoZGV2X3ByaXYpOwo+ID4gKwkJaTkxNV9kZWJ1Z2Zz
X3JlZ2lzdGVyKGk5MTUpOwo+ID4gKwkJaTkxNV9zZXR1cF9zeXNmcyhpOTE1KTsKPiA+ICAgCQkv
KiBEZXBlbmRzIG9uIHN5c2ZzIGhhdmluZyBiZWVuIGluaXRpYWxpemVkICovCj4gPiAtCQlpOTE1
X3BlcmZfcmVnaXN0ZXIoZGV2X3ByaXYpOwo+ID4gKwkJaTkxNV9wZXJmX3JlZ2lzdGVyKGk5MTUp
Owo+ID4gICAJfSBlbHNlCj4gPiAgIAkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gcmVnaXN0ZXIgZHJp
dmVyIGZvciB1c2Vyc3BhY2UgYWNjZXNzIVxuIik7Cj4gPiAtCWlmIChIQVNfRElTUExBWShkZXZf
cHJpdikpIHsKPiA+ICsJaWYgKEhBU19ESVNQTEFZKGk5MTUpKSB7Cj4gPiAgIAkJLyogTXVzdCBi
ZSBkb25lIGFmdGVyIHByb2Jpbmcgb3V0cHV0cyAqLwo+ID4gLQkJaW50ZWxfb3ByZWdpb25fcmVn
aXN0ZXIoZGV2X3ByaXYpOwo+ID4gKwkJaW50ZWxfb3ByZWdpb25fcmVnaXN0ZXIoaTkxNSk7Cj4g
PiAgIAkJYWNwaV92aWRlb19yZWdpc3RlcigpOwo+ID4gICAJfQo+ID4gLQlpZiAoSVNfR0VOKGRl
dl9wcml2LCA1KSkKPiA+IC0JCWludGVsX2dwdV9pcHNfaW5pdChkZXZfcHJpdik7Cj4gPiArCWlm
IChJU19HRU4oaTkxNSwgNSkpCj4gPiArCQlpbnRlbF9ncHVfaXBzX2luaXQoaTkxNSk7Cj4gPiAt
CWludGVsX2F1ZGlvX2luaXQoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9hdWRpb19pbml0KGk5MTUp
Owo+ID4gICAJLyoKPiA+ICAgCSAqIFNvbWUgcG9ydHMgcmVxdWlyZSBjb3JyZWN0bHkgc2V0LXVw
IGhwZCByZWdpc3RlcnMgZm9yIGRldGVjdGlvbiB0bwo+ID4gQEAgLTE3NDgsNjAgKzE3NDgsNjAg
QEAgc3RhdGljIHZvaWQgaTkxNV9kcml2ZXJfcmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gICAJICogV2UgbmVlZCB0byBjb29yZGluYXRlIHRoZSBob3RwbHVn
cyB3aXRoIHRoZSBhc3luY2hyb25vdXMgZmJkZXYKPiA+ICAgCSAqIGNvbmZpZ3VyYXRpb24sIGZv
ciB3aGljaCB3ZSB1c2UgdGhlIGZiZGV2LT5hc3luY19jb29raWUuCj4gPiAgIAkgKi8KPiA+IC0J
aWYgKEhBU19ESVNQTEFZKGRldl9wcml2KSkKPiA+ICsJaWYgKEhBU19ESVNQTEFZKGk5MTUpKQo+
ID4gICAJCWRybV9rbXNfaGVscGVyX3BvbGxfaW5pdChkZXYpOwo+ID4gLQlpbnRlbF9wb3dlcl9k
b21haW5zX2VuYWJsZShkZXZfcHJpdik7Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fZW5hYmxlKGRl
dl9wcml2KTsKPiA+ICsJaW50ZWxfcG93ZXJfZG9tYWluc19lbmFibGUoaTkxNSk7Cj4gPiArCWlu
dGVsX3J1bnRpbWVfcG1fZW5hYmxlKGk5MTUpOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBp
OTE1X2RyaXZlcl91bnJlZ2lzdGVyIC0gY2xlYW51cCB0aGUgcmVnaXN0cmF0aW9uIGRvbmUgaW4g
aTkxNV9kcml2ZXJfcmVnaXNlcigpCj4gPiAtICogQGRldl9wcml2OiBkZXZpY2UgcHJpdmF0ZQo+
ID4gKyAqIEBpOTE1OiBkZXZpY2UgcHJpdmF0ZQo+ID4gICAgKi8KPiA+IC1zdGF0aWMgdm9pZCBp
OTE1X2RyaXZlcl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICtzdGF0aWMgdm9pZCBpOTE1X2RyaXZlcl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fZGlzYWJsZShkZXZf
cHJpdik7Cj4gPiAtCWludGVsX3Bvd2VyX2RvbWFpbnNfZGlzYWJsZShkZXZfcHJpdik7Cj4gPiAr
CWludGVsX3J1bnRpbWVfcG1fZGlzYWJsZShpOTE1KTsKPiA+ICsJaW50ZWxfcG93ZXJfZG9tYWlu
c19kaXNhYmxlKGk5MTUpOwo+ID4gLQlpbnRlbF9mYmRldl91bnJlZ2lzdGVyKGRldl9wcml2KTsK
PiA+IC0JaW50ZWxfYXVkaW9fZGVpbml0KGRldl9wcml2KTsKPiA+ICsJaW50ZWxfZmJkZXZfdW5y
ZWdpc3RlcihpOTE1KTsKPiA+ICsJaW50ZWxfYXVkaW9fZGVpbml0KGk5MTUpOwo+ID4gICAJLyoK
PiA+ICAgCSAqIEFmdGVyIGZsdXNoaW5nIHRoZSBmYmRldiAoaW5jbC4gYSBsYXRlIGFzeW5jIGNv
bmZpZyB3aGljaCB3aWxsCj4gPiAgIAkgKiBoYXZlIGRlbGF5ZWQgcXVldWluZyBvZiBhIGhvdHBs
dWcgZXZlbnQpLCB0aGVuIGZsdXNoIHRoZSBob3RwbHVnCj4gPiAgIAkgKiBldmVudHMuCj4gPiAg
IAkgKi8KPiA+IC0JZHJtX2ttc19oZWxwZXJfcG9sbF9maW5pKCZkZXZfcHJpdi0+ZHJtKTsKPiA+
ICsJZHJtX2ttc19oZWxwZXJfcG9sbF9maW5pKCZpOTE1LT5kcm0pOwo+ID4gICAJaW50ZWxfZ3B1
X2lwc190ZWFyZG93bigpOwo+ID4gICAJYWNwaV92aWRlb191bnJlZ2lzdGVyKCk7Cj4gPiAtCWlu
dGVsX29wcmVnaW9uX3VucmVnaXN0ZXIoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9vcHJlZ2lvbl91
bnJlZ2lzdGVyKGk5MTUpOwo+ID4gLQlpOTE1X3BlcmZfdW5yZWdpc3RlcihkZXZfcHJpdik7Cj4g
PiAtCWk5MTVfcG11X3VucmVnaXN0ZXIoZGV2X3ByaXYpOwo+ID4gKwlpOTE1X3BlcmZfdW5yZWdp
c3RlcihpOTE1KTsKPiA+ICsJaTkxNV9wbXVfdW5yZWdpc3RlcihpOTE1KTsKPiA+IC0JaTkxNV90
ZWFyZG93bl9zeXNmcyhkZXZfcHJpdik7Cj4gPiAtCWRybV9kZXZfdW5wbHVnKCZkZXZfcHJpdi0+
ZHJtKTsKPiA+ICsJaTkxNV90ZWFyZG93bl9zeXNmcyhpOTE1KTsKPiA+ICsJZHJtX2Rldl91bnBs
dWcoJmk5MTUtPmRybSk7Cj4gPiAtCWk5MTVfZ2VtX3Nocmlua2VyX3VucmVnaXN0ZXIoZGV2X3By
aXYpOwo+ID4gKwlpOTE1X2dlbV9zaHJpbmtlcl91bnJlZ2lzdGVyKGk5MTUpOwo+ID4gICB9Cj4g
PiAtc3RhdGljIHZvaWQgaTkxNV93ZWxjb21lX21lc3NhZ2VzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpOTE1X3dlbGNvbWVfbWVzc2FnZXMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWlmIChkcm1fZGVidWcg
JiBEUk1fVVRfRFJJVkVSKSB7Cj4gPiAgIAkJc3RydWN0IGRybV9wcmludGVyIHAgPSBkcm1fZGVi
dWdfcHJpbnRlcigiaTkxNSBkZXZpY2UgaW5mbzoiKTsKPiA+ICAgCQlkcm1fcHJpbnRmKCZwLCAi
cGNpaWQ9MHglMDR4IHJldj0weCUwMnggcGxhdGZvcm09JXMgKHN1YnBsYXRmb3JtPTB4JXgpIGdl
bj0laVxuIiwKPiA+IC0JCQkgICBJTlRFTF9ERVZJRChkZXZfcHJpdiksCj4gPiAtCQkJICAgSU5U
RUxfUkVWSUQoZGV2X3ByaXYpLAo+ID4gLQkJCSAgIGludGVsX3BsYXRmb3JtX25hbWUoSU5URUxf
SU5GTyhkZXZfcHJpdiktPnBsYXRmb3JtKSwKPiA+IC0JCQkgICBpbnRlbF9zdWJwbGF0Zm9ybShS
VU5USU1FX0lORk8oZGV2X3ByaXYpLAo+ID4gLQkJCQkJICAgICBJTlRFTF9JTkZPKGRldl9wcml2
KS0+cGxhdGZvcm0pLAo+ID4gLQkJCSAgIElOVEVMX0dFTihkZXZfcHJpdikpOwo+ID4gLQo+ID4g
LQkJaW50ZWxfZGV2aWNlX2luZm9fZHVtcF9mbGFncyhJTlRFTF9JTkZPKGRldl9wcml2KSwgJnAp
Owo+ID4gLQkJaW50ZWxfZGV2aWNlX2luZm9fZHVtcF9ydW50aW1lKFJVTlRJTUVfSU5GTyhkZXZf
cHJpdiksICZwKTsKPiA+ICsJCQkgICBJTlRFTF9ERVZJRChpOTE1KSwKPiA+ICsJCQkgICBJTlRF
TF9SRVZJRChpOTE1KSwKPiA+ICsJCQkgICBpbnRlbF9wbGF0Zm9ybV9uYW1lKElOVEVMX0lORk8o
aTkxNSktPnBsYXRmb3JtKSwKPiA+ICsJCQkgICBpbnRlbF9zdWJwbGF0Zm9ybShSVU5USU1FX0lO
Rk8oaTkxNSksCj4gPiArCQkJCQkgICAgIElOVEVMX0lORk8oaTkxNSktPnBsYXRmb3JtKSwKPiA+
ICsJCQkgICBJTlRFTF9HRU4oaTkxNSkpOwo+ID4gKwo+ID4gKwkJaW50ZWxfZGV2aWNlX2luZm9f
ZHVtcF9mbGFncyhJTlRFTF9JTkZPKGk5MTUpLCAmcCk7Cj4gPiArCQlpbnRlbF9kZXZpY2VfaW5m
b19kdW1wX3J1bnRpbWUoUlVOVElNRV9JTkZPKGk5MTUpLCAmcCk7Cj4gPiAgIAl9Cj4gPiAgIAlp
ZiAoSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUcpKQo+ID4gQEAgLTE4NzEsMTI2ICsx
ODcxLDEyNiBAQCBpbnQgaTkxNV9kcml2ZXJfbG9hZChzdHJ1Y3QgcGNpX2RldiAqcGRldiwgY29u
c3Qgc3RydWN0IHBjaV9kZXZpY2VfaWQgKmVudCkKPiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0
IGludGVsX2RldmljZV9pbmZvICptYXRjaF9pbmZvID0KPiA+ICAgCQkoc3RydWN0IGludGVsX2Rl
dmljZV9pbmZvICopZW50LT5kcml2ZXJfZGF0YTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKPiA+ICAg
CWludCByZXQ7Cj4gPiAtCWRldl9wcml2ID0gaTkxNV9kcml2ZXJfY3JlYXRlKHBkZXYsIGVudCk7
Cj4gPiAtCWlmIChJU19FUlIoZGV2X3ByaXYpKQo+ID4gLQkJcmV0dXJuIFBUUl9FUlIoZGV2X3By
aXYpOwo+ID4gKwlpOTE1ID0gaTkxNV9kcml2ZXJfY3JlYXRlKHBkZXYsIGVudCk7Cj4gPiArCWlm
IChJU19FUlIoaTkxNSkpCj4gPiArCQlyZXR1cm4gUFRSX0VSUihpOTE1KTsKPiA+ICAgCS8qIERp
c2FibGUgbnVjbGVhciBwYWdlZmxpcCBieSBkZWZhdWx0IG9uIHByZS1JTEsgKi8KPiA+ICAgCWlm
ICghaTkxNV9tb2RwYXJhbXMubnVjbGVhcl9wYWdlZmxpcCAmJiBtYXRjaF9pbmZvLT5nZW4gPCA1
KQo+ID4gLQkJZGV2X3ByaXYtPmRybS5kcml2ZXJfZmVhdHVyZXMgJj0gfkRSSVZFUl9BVE9NSUM7
Cj4gPiArCQlpOTE1LT5kcm0uZHJpdmVyX2ZlYXR1cmVzICY9IH5EUklWRVJfQVRPTUlDOwo+ID4g
ICAJcmV0ID0gcGNpX2VuYWJsZV9kZXZpY2UocGRldik7Cj4gPiAgIAlpZiAocmV0KQo+ID4gICAJ
CWdvdG8gb3V0X2Zpbmk7Cj4gPiAtCXJldCA9IGk5MTVfZHJpdmVyX2luaXRfZWFybHkoZGV2X3By
aXYpOwo+ID4gKwlyZXQgPSBpOTE1X2RyaXZlcl9pbml0X2Vhcmx5KGk5MTUpOwo+ID4gICAJaWYg
KHJldCA8IDApCj4gPiAgIAkJZ290byBvdXRfcGNpX2Rpc2FibGU7Cj4gPiAtCWRpc2FibGVfcnBt
X3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gPiArCWRpc2FibGVfcnBtX3dha2VyZWZfYXNz
ZXJ0cyhpOTE1KTsKPiA+IC0JcmV0ID0gaTkxNV9kcml2ZXJfaW5pdF9tbWlvKGRldl9wcml2KTsK
PiA+ICsJcmV0ID0gaTkxNV9kcml2ZXJfaW5pdF9tbWlvKGk5MTUpOwo+ID4gICAJaWYgKHJldCA8
IDApCj4gPiAgIAkJZ290byBvdXRfcnVudGltZV9wbV9wdXQ7Cj4gPiAtCXJldCA9IGk5MTVfZHJp
dmVyX2luaXRfaHcoZGV2X3ByaXYpOwo+ID4gKwlyZXQgPSBpOTE1X2RyaXZlcl9pbml0X2h3KGk5
MTUpOwo+ID4gICAJaWYgKHJldCA8IDApCj4gPiAgIAkJZ290byBvdXRfY2xlYW51cF9tbWlvOwo+
ID4gLQlyZXQgPSBpOTE1X2xvYWRfbW9kZXNldF9pbml0KCZkZXZfcHJpdi0+ZHJtKTsKPiA+ICsJ
cmV0ID0gaTkxNV9sb2FkX21vZGVzZXRfaW5pdCgmaTkxNS0+ZHJtKTsKPiA+ICAgCWlmIChyZXQg
PCAwKQo+ID4gICAJCWdvdG8gb3V0X2NsZWFudXBfaHc7Cj4gPiAtCWk5MTVfZHJpdmVyX3JlZ2lz
dGVyKGRldl9wcml2KTsKPiA+ICsJaTkxNV9kcml2ZXJfcmVnaXN0ZXIoaTkxNSk7Cj4gPiAtCWVu
YWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGRldl9wcml2KTsKPiA+ICsJZW5hYmxlX3JwbV93YWtl
cmVmX2Fzc2VydHMoaTkxNSk7Cj4gPiAtCWk5MTVfd2VsY29tZV9tZXNzYWdlcyhkZXZfcHJpdik7
Cj4gPiArCWk5MTVfd2VsY29tZV9tZXNzYWdlcyhpOTE1KTsKPiA+ICAgCXJldHVybiAwOwo+ID4g
ICBvdXRfY2xlYW51cF9odzoKPiA+IC0JaTkxNV9kcml2ZXJfY2xlYW51cF9odyhkZXZfcHJpdik7
Cj4gPiAtCWk5MTVfZ2d0dF9jbGVhbnVwX2h3KGRldl9wcml2KTsKPiA+ICsJaTkxNV9kcml2ZXJf
Y2xlYW51cF9odyhpOTE1KTsKPiA+ICsJaTkxNV9nZ3R0X2NsZWFudXBfaHcoaTkxNSk7Cj4gPiAg
IG91dF9jbGVhbnVwX21taW86Cj4gPiAtCWk5MTVfZHJpdmVyX2NsZWFudXBfbW1pbyhkZXZfcHJp
dik7Cj4gPiArCWk5MTVfZHJpdmVyX2NsZWFudXBfbW1pbyhpOTE1KTsKPiA+ICAgb3V0X3J1bnRp
bWVfcG1fcHV0Ogo+ID4gLQllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4g
PiAtCWk5MTVfZHJpdmVyX2NsZWFudXBfZWFybHkoZGV2X3ByaXYpOwo+ID4gKwllbmFibGVfcnBt
X3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiA+ICsJaTkxNV9kcml2ZXJfY2xlYW51cF9lYXJseShp
OTE1KTsKPiA+ICAgb3V0X3BjaV9kaXNhYmxlOgo+ID4gICAJcGNpX2Rpc2FibGVfZGV2aWNlKHBk
ZXYpOwo+ID4gICBvdXRfZmluaToKPiA+IC0JaTkxNV9sb2FkX2Vycm9yKGRldl9wcml2LCAiRGV2
aWNlIGluaXRpYWxpemF0aW9uIGZhaWxlZCAoJWQpXG4iLCByZXQpOwo+ID4gLQlpOTE1X2RyaXZl
cl9kZXN0cm95KGRldl9wcml2KTsKPiA+ICsJaTkxNV9sb2FkX2Vycm9yKGk5MTUsICJEZXZpY2Ug
aW5pdGlhbGl6YXRpb24gZmFpbGVkICglZClcbiIsIHJldCk7Cj4gPiArCWk5MTVfZHJpdmVyX2Rl
c3Ryb3koaTkxNSk7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiAgIHZvaWQgaTkxNV9k
cml2ZXJfdW5sb2FkKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gLQlzdHJ1Y3Qg
cGNpX2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2
ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiAtCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZf
cHJpdik7Cj4gPiArCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiA+IC0JaTkx
NV9kcml2ZXJfdW5yZWdpc3RlcihkZXZfcHJpdik7Cj4gPiArCWk5MTVfZHJpdmVyX3VucmVnaXN0
ZXIoaTkxNSk7Cj4gPiAgIAkvKgo+ID4gICAJICogQWZ0ZXIgdW5yZWdpc3RlcmluZyB0aGUgZGV2
aWNlIHRvIHByZXZlbnQgYW55IG5ldyB1c2VycywgY2FuY2VsCj4gPiAgIAkgKiBhbGwgaW4tZmxp
Z2h0IHJlcXVlc3RzIHNvIHRoYXQgd2UgY2FuIHF1aWNrbHkgdW5iaW5kIHRoZSBhY3RpdmUKPiA+
ICAgCSAqIHJlc291cmNlcy4KPiA+ICAgCSAqLwo+ID4gLQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGRl
dl9wcml2KTsKPiA+ICsJaTkxNV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKPiA+ICAgCS8qIEZsdXNo
IGFueSBleHRlcm5hbCBjb2RlIHRoYXQgc3RpbGwgbWF5IGJlIHVuZGVyIHRoZSBSQ1UgbG9jayAq
Lwo+ID4gICAJc3luY2hyb25pemVfcmN1KCk7Cj4gPiAtCWk5MTVfZ2VtX3N1c3BlbmQoZGV2X3By
aXYpOwo+ID4gKwlpOTE1X2dlbV9zdXNwZW5kKGk5MTUpOwo+ID4gICAJZHJtX2F0b21pY19oZWxw
ZXJfc2h1dGRvd24oZGV2KTsKPiA+IC0JaW50ZWxfZ3Z0X2NsZWFudXAoZGV2X3ByaXYpOwo+ID4g
KwlpbnRlbF9ndnRfY2xlYW51cChpOTE1KTsKPiA+ICAgCWludGVsX21vZGVzZXRfY2xlYW51cChk
ZXYpOwo+ID4gLQlpbnRlbF9iaW9zX2NsZWFudXAoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9iaW9z
X2NsZWFudXAoaTkxNSk7Cj4gPiAgIAl2Z2Ffc3dpdGNoZXJvb191bnJlZ2lzdGVyX2NsaWVudChw
ZGV2KTsKPiA+ICAgCXZnYV9jbGllbnRfcmVnaXN0ZXIocGRldiwgTlVMTCwgTlVMTCwgTlVMTCk7
Cj4gPiAtCWludGVsX2Nzcl91Y29kZV9maW5pKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfY3NyX3Vj
b2RlX2ZpbmkoaTkxNSk7Cj4gPiAgIAkvKiBGcmVlIGVycm9yIHN0YXRlIGFmdGVyIGludGVycnVw
dHMgYXJlIGZ1bGx5IGRpc2FibGVkLiAqLwo+ID4gLQljYW5jZWxfZGVsYXllZF93b3JrX3N5bmMo
JmRldl9wcml2LT5ncHVfZXJyb3IuaGFuZ2NoZWNrX3dvcmspOwo+ID4gLQlpOTE1X3Jlc2V0X2Vy
cm9yX3N0YXRlKGRldl9wcml2KTsKPiA+ICsJY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZpOTE1
LT5ncHVfZXJyb3IuaGFuZ2NoZWNrX3dvcmspOwo+ID4gKwlpOTE1X3Jlc2V0X2Vycm9yX3N0YXRl
KGk5MTUpOwo+ID4gLQlpOTE1X2dlbV9maW5pX2h3KGRldl9wcml2KTsKPiA+ICsJaTkxNV9nZW1f
ZmluaV9odyhpOTE1KTsKPiA+IC0JaW50ZWxfcG93ZXJfZG9tYWluc19maW5pX2h3KGRldl9wcml2
KTsKPiA+ICsJaW50ZWxfcG93ZXJfZG9tYWluc19maW5pX2h3KGk5MTUpOwo+ID4gLQlpOTE1X2Ry
aXZlcl9jbGVhbnVwX2h3KGRldl9wcml2KTsKPiA+ICsJaTkxNV9kcml2ZXJfY2xlYW51cF9odyhp
OTE1KTsKPiA+IC0JZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ID4gKwll
bmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9p
ZCBpOTE1X2RyaXZlcl9yZWxlYXNlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+IC0JZGlz
YWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGRldl9wcml2KTsKPiA+ICsJZGlzYWJsZV9ycG1fd2Fr
ZXJlZl9hc3NlcnRzKGk5MTUpOwo+ID4gLQlpOTE1X2dlbV9maW5pKGRldl9wcml2KTsKPiA+ICsJ
aTkxNV9nZW1fZmluaShpOTE1KTsKPiA+IC0JaTkxNV9nZ3R0X2NsZWFudXBfaHcoZGV2X3ByaXYp
Owo+ID4gLQlpOTE1X2RyaXZlcl9jbGVhbnVwX21taW8oZGV2X3ByaXYpOwo+ID4gKwlpOTE1X2dn
dHRfY2xlYW51cF9odyhpOTE1KTsKPiA+ICsJaTkxNV9kcml2ZXJfY2xlYW51cF9tbWlvKGk5MTUp
Owo+ID4gLQllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gPiAtCWludGVs
X3J1bnRpbWVfcG1fY2xlYW51cChkZXZfcHJpdik7Cj4gPiArCWVuYWJsZV9ycG1fd2FrZXJlZl9h
c3NlcnRzKGk5MTUpOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX2NsZWFudXAoaTkxNSk7Cj4gPiAt
CWk5MTVfZHJpdmVyX2NsZWFudXBfZWFybHkoZGV2X3ByaXYpOwo+ID4gLQlpOTE1X2RyaXZlcl9k
ZXN0cm95KGRldl9wcml2KTsKPiA+ICsJaTkxNV9kcml2ZXJfY2xlYW51cF9lYXJseShpOTE1KTsK
PiA+ICsJaTkxNV9kcml2ZXJfZGVzdHJveShpOTE1KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW50
IGk5MTVfZHJpdmVyX29wZW4oc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRybV9maWxl
ICpmaWxlKQo+ID4gQEAgLTIwMzUsOSArMjAzNSw5IEBAIHN0YXRpYyB2b2lkIGk5MTVfZHJpdmVy
X3Bvc3RjbG9zZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUp
Cj4gPiAgIAlrZnJlZShmaWxlX3ByaXYpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaW50ZWxf
c3VzcGVuZF9lbmNvZGVycyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAr
c3RhdGljIHZvaWQgaW50ZWxfc3VzcGVuZF9lbmNvZGVycyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2
LT5kcm07Cj4gPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ID4gICAJ
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7Cj4gPiAgIAlkcm1fbW9kZXNldF9sb2NrX2Fs
bChkZXYpOwo+ID4gQEAgLTIwNDcsMTEgKzIwNDcsMTEgQEAgc3RhdGljIHZvaWQgaW50ZWxfc3Vz
cGVuZF9lbmNvZGVycyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlk
cm1fbW9kZXNldF91bmxvY2tfYWxsKGRldik7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IHZsdl9y
ZXN1bWVfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3Rh
dGljIGludCB2bHZfcmVzdW1lX3ByZXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gPiAgIAkJCSAgICAgIGJvb2wgcnBtX3Jlc3VtZSk7Cj4gPiAtc3RhdGljIGludCB2bHZfc3Vz
cGVuZF9jb21wbGV0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3N0
YXRpYyBpbnQgdmx2X3N1c3BlbmRfY29tcGxldGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpOwo+ID4gLXN0YXRpYyBib29sIHN1c3BlbmRfdG9faWRsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGJvb2wgc3VzcGVuZF90b19pZGxlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgICNpZiBJU19FTkFCTEVEKENPTkZJ
R19BQ1BJX1NMRUVQKQo+ID4gICAJaWYgKGFjcGlfdGFyZ2V0X3N5c3RlbV9zdGF0ZSgpIDwgQUNQ
SV9TVEFURV9TMykKPiA+IEBAIC0yMDc3LDE1ICsyMDc3LDE1IEBAIHN0YXRpYyBpbnQgaTkxNV9k
cm1fcHJlcGFyZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICBzdGF0aWMgaW50IGk5MTVf
ZHJtX3N1c3BlbmQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiAtCXN0cnVjdCBw
Y2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYg
PSBpOTE1LT5kcm0ucGRldjsKPiA+ICAgCXBjaV9wb3dlcl90IG9wcmVnaW9uX3RhcmdldF9zdGF0
ZTsKPiA+IC0JZGlzYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGRldl9wcml2KTsKPiA+ICsJZGlz
YWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ID4gICAJLyogV2UgZG8gYSBsb3Qgb2Yg
cG9raW5nIGluIGEgbG90IG9mIHJlZ2lzdGVycywgbWFrZSBzdXJlIHRoZXkgd29yawo+ID4gICAJ
ICogcHJvcGVybHkuICovCj4gPiAtCWludGVsX3Bvd2VyX2RvbWFpbnNfZGlzYWJsZShkZXZfcHJp
dik7Cj4gPiArCWludGVsX3Bvd2VyX2RvbWFpbnNfZGlzYWJsZShpOTE1KTsKPiA+ICAgCWRybV9r
bXNfaGVscGVyX3BvbGxfZGlzYWJsZShkZXYpOwo+ID4gQEAgLTIwOTMsNDAgKzIwOTMsNDAgQEAg
c3RhdGljIGludCBpOTE1X2RybV9zdXNwZW5kKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAg
IAlpbnRlbF9kaXNwbGF5X3N1c3BlbmQoZGV2KTsKPiA+IC0JaW50ZWxfZHBfbXN0X3N1c3BlbmQo
ZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9kcF9tc3Rfc3VzcGVuZChpOTE1KTsKPiA+IC0JaW50ZWxf
cnVudGltZV9wbV9kaXNhYmxlX2ludGVycnVwdHMoZGV2X3ByaXYpOwo+ID4gLQlpbnRlbF9ocGRf
Y2FuY2VsX3dvcmsoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX2Rpc2FibGVfaW50
ZXJydXB0cyhpOTE1KTsKPiA+ICsJaW50ZWxfaHBkX2NhbmNlbF93b3JrKGk5MTUpOwo+ID4gLQlp
bnRlbF9zdXNwZW5kX2VuY29kZXJzKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfc3VzcGVuZF9lbmNv
ZGVycyhpOTE1KTsKPiA+IC0JaW50ZWxfc3VzcGVuZF9odyhkZXZfcHJpdik7Cj4gPiArCWludGVs
X3N1c3BlbmRfaHcoaTkxNSk7Cj4gPiAtCWk5MTVfZ2VtX3N1c3BlbmRfZ3R0X21hcHBpbmdzKGRl
dl9wcml2KTsKPiA+ICsJaTkxNV9nZW1fc3VzcGVuZF9ndHRfbWFwcGluZ3MoaTkxNSk7Cj4gPiAt
CWk5MTVfc2F2ZV9zdGF0ZShkZXZfcHJpdik7Cj4gPiArCWk5MTVfc2F2ZV9zdGF0ZShpOTE1KTsK
PiA+IC0Jb3ByZWdpb25fdGFyZ2V0X3N0YXRlID0gc3VzcGVuZF90b19pZGxlKGRldl9wcml2KSA/
IFBDSV9EMSA6IFBDSV9EM2NvbGQ7Cj4gPiAtCWludGVsX29wcmVnaW9uX3N1c3BlbmQoZGV2X3By
aXYsIG9wcmVnaW9uX3RhcmdldF9zdGF0ZSk7Cj4gPiArCW9wcmVnaW9uX3RhcmdldF9zdGF0ZSA9
IHN1c3BlbmRfdG9faWRsZShpOTE1KSA/IFBDSV9EMSA6IFBDSV9EM2NvbGQ7Cj4gPiArCWludGVs
X29wcmVnaW9uX3N1c3BlbmQoaTkxNSwgb3ByZWdpb25fdGFyZ2V0X3N0YXRlKTsKPiA+ICAgCWlu
dGVsX2ZiZGV2X3NldF9zdXNwZW5kKGRldiwgRkJJTkZPX1NUQVRFX1NVU1BFTkRFRCwgdHJ1ZSk7
Cj4gPiAtCWRldl9wcml2LT5zdXNwZW5kX2NvdW50Kys7Cj4gPiArCWk5MTUtPnN1c3BlbmRfY291
bnQrKzsKPiA+IC0JaW50ZWxfY3NyX3Vjb2RlX3N1c3BlbmQoZGV2X3ByaXYpOwo+ID4gKwlpbnRl
bF9jc3JfdWNvZGVfc3VzcGVuZChpOTE1KTsKPiA+IC0JZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2Vy
dHMoZGV2X3ByaXYpOwo+ID4gKwllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiA+
ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBlbnVtIGk5MTVfZHJtX3N1c3BlbmRf
bW9kZQo+ID4gLWdldF9zdXNwZW5kX21vZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCBib29sIGhpYmVybmF0ZSkKPiA+ICtnZXRfc3VzcGVuZF9tb2RlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LCBib29sIGhpYmVybmF0ZSkKPiA+ICAgewo+ID4gICAJaWYgKGhpYmVy
bmF0ZSkKPiA+ICAgCQlyZXR1cm4gSTkxNV9EUk1fU1VTUEVORF9ISUJFUk5BVEU7Cj4gPiAtCWlm
IChzdXNwZW5kX3RvX2lkbGUoZGV2X3ByaXYpKQo+ID4gKwlpZiAoc3VzcGVuZF90b19pZGxlKGk5
MTUpKQo+ID4gICAJCXJldHVybiBJOTE1X0RSTV9TVVNQRU5EX0lETEU7Cj4gPiAgIAlyZXR1cm4g
STkxNV9EUk1fU1VTUEVORF9NRU07Cj4gPiBAQCAtMjEzNCwzMCArMjEzNCwzMCBAQCBnZXRfc3Vz
cGVuZF9tb2RlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBoaWJlcm5h
dGUpCj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9kcm1fc3VzcGVuZF9sYXRlKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsIGJvb2wgaGliZXJuYXRpb24pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gLQlzdHJ1Y3QgcGNpX2RldiAq
cGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+
ZHJtLnBkZXY7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gLQlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2Vy
dHMoZGV2X3ByaXYpOwo+ID4gKwlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4g
PiAtCWk5MTVfZ2VtX3N1c3BlbmRfbGF0ZShkZXZfcHJpdik7Cj4gPiArCWk5MTVfZ2VtX3N1c3Bl
bmRfbGF0ZShpOTE1KTsKPiA+IC0JaW50ZWxfdW5jb3JlX3N1c3BlbmQoJmRldl9wcml2LT51bmNv
cmUpOwo+ID4gKwlpbnRlbF91bmNvcmVfc3VzcGVuZCgmaTkxNS0+dW5jb3JlKTsKPiA+IC0JaW50
ZWxfcG93ZXJfZG9tYWluc19zdXNwZW5kKGRldl9wcml2LAo+ID4gLQkJCQkgICAgZ2V0X3N1c3Bl
bmRfbW9kZShkZXZfcHJpdiwgaGliZXJuYXRpb24pKTsKPiA+ICsJaW50ZWxfcG93ZXJfZG9tYWlu
c19zdXNwZW5kKGk5MTUsCj4gPiArCQkJCSAgICBnZXRfc3VzcGVuZF9tb2RlKGk5MTUsIGhpYmVy
bmF0aW9uKSk7Cj4gPiAgIAlyZXQgPSAwOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSAxMSB8fCBJU19HRU45X0xQKGRldl9wcml2KSkKPiA+IC0JCWJ4dF9lbmFibGVfZGM5KGRldl9w
cml2KTsKPiA+IC0JZWxzZSBpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxM
KGRldl9wcml2KSkKPiA+IC0JCWhzd19lbmFibGVfcGM4KGRldl9wcml2KTsKPiA+IC0JZWxzZSBp
ZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4g
PiAtCQlyZXQgPSB2bHZfc3VzcGVuZF9jb21wbGV0ZShkZXZfcHJpdik7Cj4gPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gMTEgfHwgSVNfR0VOOV9MUChpOTE1KSkKPiA+ICsJCWJ4dF9lbmFibGVf
ZGM5KGk5MTUpOwo+ID4gKwllbHNlIGlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VM
TChpOTE1KSkKPiA+ICsJCWhzd19lbmFibGVfcGM4KGk5MTUpOwo+ID4gKwllbHNlIGlmIChJU19W
QUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiArCQlyZXQgPSB2bHZf
c3VzcGVuZF9jb21wbGV0ZShpOTE1KTsKPiA+ICAgCWlmIChyZXQpIHsKPiA+ICAgCQlEUk1fRVJS
T1IoIlN1c3BlbmQgY29tcGxldGUgZmFpbGVkOiAlZFxuIiwgcmV0KTsKPiA+IC0JCWludGVsX3Bv
d2VyX2RvbWFpbnNfcmVzdW1lKGRldl9wcml2KTsKPiA+ICsJCWludGVsX3Bvd2VyX2RvbWFpbnNf
cmVzdW1lKGk5MTUpOwo+ID4gICAJCWdvdG8gb3V0Owo+ID4gICAJfQo+ID4gQEAgLTIxNzUsMTMg
KzIxNzUsMTMgQEAgc3RhdGljIGludCBpOTE1X2RybV9zdXNwZW5kX2xhdGUoc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwgYm9vbCBoaWJlcm5hdGlvbikKPiA+ICAgCSAqIEZ1aml0c3UgRlNDIFM3MTEw
Cj4gPiAgIAkgKiBBY2VyIEFzcGlyZSAxODMwVAo+ID4gICAJICovCj4gPiAtCWlmICghKGhpYmVy
bmF0aW9uICYmIElOVEVMX0dFTihkZXZfcHJpdikgPCA2KSkKPiA+ICsJaWYgKCEoaGliZXJuYXRp
b24gJiYgSU5URUxfR0VOKGk5MTUpIDwgNikpCj4gPiAgIAkJcGNpX3NldF9wb3dlcl9zdGF0ZShw
ZGV2LCBQQ0lfRDNob3QpOwo+ID4gICBvdXQ6Cj4gPiAtCWVuYWJsZV9ycG1fd2FrZXJlZl9hc3Nl
cnRzKGRldl9wcml2KTsKPiA+IC0JaWYgKCFkZXZfcHJpdi0+dW5jb3JlLnVzZXJfZm9yY2V3YWtl
LmNvdW50KQo+ID4gLQkJaW50ZWxfcnVudGltZV9wbV9jbGVhbnVwKGRldl9wcml2KTsKPiA+ICsJ
ZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gPiArCWlmICghaTkxNS0+dW5jb3Jl
LnVzZXJfZm9yY2V3YWtlLmNvdW50KQo+ID4gKwkJaW50ZWxfcnVudGltZV9wbV9jbGVhbnVwKGk5
MTUpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTIyMTIsMjQgKzIyMTIsMjQg
QEAgc3RhdGljIGludCBpOTE1X3N1c3BlbmRfc3dpdGNoZXJvbyhzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LCBwbV9tZXNzYWdlX3Qgc3RhdGUpCj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9kcm1fcmVzdW1l
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCWludCByZXQ7Cj4gPiAtCWRpc2FibGVf
cnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gPiAtCWludGVsX3Nhbml0aXplX2d0X3Bv
d2Vyc2F2ZShkZXZfcHJpdik7Cj4gPiArCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1
KTsKPiA+ICsJaW50ZWxfc2FuaXRpemVfZ3RfcG93ZXJzYXZlKGk5MTUpOwo+ID4gLQlpOTE1X2dl
bV9zYW5pdGl6ZShkZXZfcHJpdik7Cj4gPiArCWk5MTVfZ2VtX3Nhbml0aXplKGk5MTUpOwo+ID4g
LQlyZXQgPSBpOTE1X2dndHRfZW5hYmxlX2h3KGRldl9wcml2KTsKPiA+ICsJcmV0ID0gaTkxNV9n
Z3R0X2VuYWJsZV9odyhpOTE1KTsKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJRFJNX0VSUk9SKCJm
YWlsZWQgdG8gcmUtZW5hYmxlIEdHVFRcbiIpOwo+ID4gLQlpbnRlbF9jc3JfdWNvZGVfcmVzdW1l
KGRldl9wcml2KTsKPiA+ICsJaW50ZWxfY3NyX3Vjb2RlX3Jlc3VtZShpOTE1KTsKPiA+IC0JaTkx
NV9yZXN0b3JlX3N0YXRlKGRldl9wcml2KTsKPiA+IC0JaW50ZWxfcHBzX3VubG9ja19yZWdzX3dh
KGRldl9wcml2KTsKPiA+ICsJaTkxNV9yZXN0b3JlX3N0YXRlKGk5MTUpOwo+ID4gKwlpbnRlbF9w
cHNfdW5sb2NrX3JlZ3Nfd2EoaTkxNSk7Cj4gPiAtCWludGVsX2luaXRfcGNoX3JlZmNsayhkZXZf
cHJpdik7Cj4gPiArCWludGVsX2luaXRfcGNoX3JlZmNsayhpOTE1KTsKPiA+ICAgCS8qCj4gPiAg
IAkgKiBJbnRlcnJ1cHRzIGhhdmUgdG8gYmUgZW5hYmxlZCBiZWZvcmUgYW55IGJhdGNoZXMgYXJl
IHJ1bi4gSWYgbm90IHRoZQo+ID4gQEAgLTIyNDEsMjEgKzIyNDEsMjEgQEAgc3RhdGljIGludCBp
OTE1X2RybV9yZXN1bWUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgCSAqIE1vZGVzZXQg
ZW5hYmxpbmcgaW4gaW50ZWxfbW9kZXNldF9pbml0X2h3KCkgYWxzbyBuZWVkcyB3b3JraW5nCj4g
PiAgIAkgKiBpbnRlcnJ1cHRzLgo+ID4gICAJICovCj4gPiAtCWludGVsX3J1bnRpbWVfcG1fZW5h
YmxlX2ludGVycnVwdHMoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX2VuYWJsZV9p
bnRlcnJ1cHRzKGk5MTUpOwo+ID4gICAJZHJtX21vZGVfY29uZmlnX3Jlc2V0KGRldik7Cj4gPiAt
CWk5MTVfZ2VtX3Jlc3VtZShkZXZfcHJpdik7Cj4gPiArCWk5MTVfZ2VtX3Jlc3VtZShpOTE1KTsK
PiA+ICAgCWludGVsX21vZGVzZXRfaW5pdF9odyhkZXYpOwo+ID4gLQlpbnRlbF9pbml0X2Nsb2Nr
X2dhdGluZyhkZXZfcHJpdik7Cj4gPiArCWludGVsX2luaXRfY2xvY2tfZ2F0aW5nKGk5MTUpOwo+
ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gLQlpZiAoZGV2X3By
aXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCkKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmhwZF9p
cnFfc2V0dXAoZGV2X3ByaXYpOwo+ID4gLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFf
bG9jayk7Cj4gPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICsJaWYgKGk5
MTUtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuaHBkX2lycV9z
ZXR1cChpOTE1KTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAt
CWludGVsX2RwX21zdF9yZXN1bWUoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9kcF9tc3RfcmVzdW1l
KGk5MTUpOwo+ID4gICAJaW50ZWxfZGlzcGxheV9yZXN1bWUoZGV2KTsKPiA+IEBAIC0yMjY3LDIz
ICsyMjY3LDIzIEBAIHN0YXRpYyBpbnQgaTkxNV9kcm1fcmVzdW1lKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYpCj4gPiAgIAkgKiBib3RoZXIgd2l0aCB0aGUgdGlueSByYWNlIGhlcmUgd2hlcmUgd2Ug
bWlnaHQgbG9zZSBob3RwbHVnCj4gPiAgIAkgKiBub3RpZmljYXRpb25zLgo+ID4gICAJICogKi8K
PiA+IC0JaW50ZWxfaHBkX2luaXQoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9ocGRfaW5pdChpOTE1
KTsKPiA+IC0JaW50ZWxfb3ByZWdpb25fcmVzdW1lKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfb3By
ZWdpb25fcmVzdW1lKGk5MTUpOwo+ID4gICAJaW50ZWxfZmJkZXZfc2V0X3N1c3BlbmQoZGV2LCBG
QklORk9fU1RBVEVfUlVOTklORywgZmFsc2UpOwo+ID4gLQlpbnRlbF9wb3dlcl9kb21haW5zX2Vu
YWJsZShkZXZfcHJpdik7Cj4gPiArCWludGVsX3Bvd2VyX2RvbWFpbnNfZW5hYmxlKGk5MTUpOwo+
ID4gLQllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gPiArCWVuYWJsZV9y
cG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+ICAg
c3RhdGljIGludCBpOTE1X2RybV9yZXN1bWVfZWFybHkoc3RydWN0IGRybV9kZXZpY2UgKmRldikK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGRldik7Cj4gPiAtCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJ
c3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiA+ICAgCWludCByZXQ7Cj4g
PiAgIAkvKgo+ID4gQEAgLTIzMzAsMzIgKzIzMzAsMzIgQEAgc3RhdGljIGludCBpOTE1X2RybV9y
ZXN1bWVfZWFybHkoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgCXBjaV9zZXRfbWFzdGVy
KHBkZXYpOwo+ID4gLQlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ID4g
KwlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gPiAtCWlmIChJU19WQUxMRVlW
SUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+IC0JCXJldCA9IHZs
dl9yZXN1bWVfcHJlcGFyZShkZXZfcHJpdiwgZmFsc2UpOwo+ID4gKwlpZiAoSVNfVkFMTEVZVklF
VyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKQo+ID4gKwkJcmV0ID0gdmx2X3Jlc3VtZV9w
cmVwYXJlKGk5MTUsIGZhbHNlKTsKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJRFJNX0VSUk9SKCJS
ZXN1bWUgcHJlcGFyZSBmYWlsZWQ6ICVkLCBjb250aW51aW5nIGFueXdheVxuIiwKPiA+ICAgCQkJ
ICByZXQpOwo+ID4gLQlpbnRlbF91bmNvcmVfcmVzdW1lX2Vhcmx5KCZkZXZfcHJpdi0+dW5jb3Jl
KTsKPiA+ICsJaW50ZWxfdW5jb3JlX3Jlc3VtZV9lYXJseSgmaTkxNS0+dW5jb3JlKTsKPiA+IC0J
aTkxNV9jaGVja19hbmRfY2xlYXJfZmF1bHRzKGRldl9wcml2KTsKPiA+ICsJaTkxNV9jaGVja19h
bmRfY2xlYXJfZmF1bHRzKGk5MTUpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAx
MSB8fCBJU19HRU45X0xQKGRldl9wcml2KSkgewo+ID4gLQkJZ2VuOV9zYW5pdGl6ZV9kY19zdGF0
ZShkZXZfcHJpdik7Cj4gPiAtCQlieHRfZGlzYWJsZV9kYzkoZGV2X3ByaXYpOwo+ID4gLQl9IGVs
c2UgaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsK
PiA+IC0JCWhzd19kaXNhYmxlX3BjOChkZXZfcHJpdik7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gMTEgfHwgSVNfR0VOOV9MUChpOTE1KSkgewo+ID4gKwkJZ2VuOV9zYW5pdGl6ZV9kY19z
dGF0ZShpOTE1KTsKPiA+ICsJCWJ4dF9kaXNhYmxlX2RjOShpOTE1KTsKPiA+ICsJfSBlbHNlIGlm
IChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkgewo+ID4gKwkJaHN3X2Rp
c2FibGVfcGM4KGk5MTUpOwo+ID4gICAJfQo+ID4gLQlpbnRlbF91bmNvcmVfc2FuaXRpemUoZGV2
X3ByaXYpOwo+ID4gKwlpbnRlbF91bmNvcmVfc2FuaXRpemUoaTkxNSk7Cj4gPiAtCWludGVsX3Bv
d2VyX2RvbWFpbnNfcmVzdW1lKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfcG93ZXJfZG9tYWluc19y
ZXN1bWUoaTkxNSk7Cj4gPiAtCWludGVsX2d0X3Nhbml0aXplKGRldl9wcml2LCB0cnVlKTsKPiA+
ICsJaW50ZWxfZ3Rfc2FuaXRpemUoaTkxNSwgdHJ1ZSk7Cj4gPiAtCWVuYWJsZV9ycG1fd2FrZXJl
Zl9hc3NlcnRzKGRldl9wcml2KTsKPiA+ICsJZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkx
NSk7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtMjU0MCw5ICsyNTQwLDkgQEAg
c3RhdGljIGludCBpOTE1X3BtX3Jlc3RvcmUoc3RydWN0IGRldmljZSAqa2RldikKPiA+ICAgICog
YSBibGFjay1ib3ggZm9yIHRoZSBkcml2ZXIuIEZ1cnRoZXIgaW52ZXN0aWdhdGlvbiBpcyBuZWVk
ZWQgdG8gcmVkdWNlIHRoZQo+ID4gICAgKiBzYXZlZC9yZXN0b3JlZCByZWdpc3RlcnMgZXZlbiBm
dXJ0aGVyLCBieSBmb2xsb3dpbmcgdGhlIHNhbWUgMyBjcml0ZXJpYS4KPiA+ICAgICovCj4gPiAt
c3RhdGljIHZvaWQgdmx2X3NhdmVfZ3VuaXRfczBpeF9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgdmx2X3NhdmVfZ3VuaXRfczBpeF9zdGF0
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qgdmx2
X3MwaXhfc3RhdGUgKnMgPSAmZGV2X3ByaXYtPnZsdl9zMGl4X3N0YXRlOwo+ID4gKwlzdHJ1Y3Qg
dmx2X3MwaXhfc3RhdGUgKnMgPSAmaTkxNS0+dmx2X3MwaXhfc3RhdGU7Cj4gPiAgIAlpbnQgaTsK
PiA+ICAgCS8qIEdBTSAweDQwMDAtMHg0NzcwICovCj4gPiBAQCAtMjYyMSw5ICsyNjIxLDkgQEAg
c3RhdGljIHZvaWQgdmx2X3NhdmVfZ3VuaXRfczBpeF9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKi8KPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHZsdl9y
ZXN0b3JlX2d1bml0X3MwaXhfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gK3N0YXRpYyB2b2lkIHZsdl9yZXN0b3JlX2d1bml0X3MwaXhfc3RhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IHZsdl9zMGl4X3N0YXRl
ICpzID0gJmRldl9wcml2LT52bHZfczBpeF9zdGF0ZTsKPiA+ICsJc3RydWN0IHZsdl9zMGl4X3N0
YXRlICpzID0gJmk5MTUtPnZsdl9zMGl4X3N0YXRlOwo+ID4gICAJdTMyIHZhbDsKPiA+ICAgCWlu
dCBpOwo+ID4gQEAgLTI3MzIsNyArMjczMiw3IEBAIHN0YXRpYyBpbnQgdmx2X3dhaXRfZm9yX3B3
X3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCXJldHVybiByZXQ7
Cj4gPiAgIH0KPiA+IC1pbnQgdmx2X2ZvcmNlX2dmeF9jbG9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIGJvb2wgZm9yY2Vfb24pCj4gPiAraW50IHZsdl9mb3JjZV9nZnhfY2xv
Y2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgZm9yY2Vfb24pCj4gPiAgIHsK
PiA+ICAgCXUzMiB2YWw7Cj4gPiAgIAlpbnQgZXJyOwo+ID4gQEAgLTI3NDYsNyArMjc0Niw3IEBA
IGludCB2bHZfZm9yY2VfZ2Z4X2Nsb2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgYm9vbCBmb3JjZV9vbikKPiA+ICAgCWlmICghZm9yY2Vfb24pCj4gPiAgIAkJcmV0dXJuIDA7
Cj4gPiAtCWVyciA9IGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+
ID4gKwllcnIgPSBpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJ
CQkJICAgICAgVkxWX0dUTENfU1VSVklWQUJJTElUWV9SRUcsCj4gPiAgIAkJCQkgICAgICBWTFZf
R0ZYX0NMS19TVEFUVVNfQklULAo+ID4gICAJCQkJICAgICAgVkxWX0dGWF9DTEtfU1RBVFVTX0JJ
VCwKPiA+IEBAIC0yNzU4LDcgKzI3NTgsNyBAQCBpbnQgdmx2X2ZvcmNlX2dmeF9jbG9jayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgZm9yY2Vfb24pCj4gPiAgIAlyZXR1
cm4gZXJyOwo+ID4gICB9Cj4gPiAtc3RhdGljIGludCB2bHZfYWxsb3dfZ3Rfd2FrZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgYWxsb3cpCj4gPiArc3RhdGljIGludCB2
bHZfYWxsb3dfZ3Rfd2FrZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgYm9vbCBhbGxv
dykKPiA+ICAgewo+ID4gICAJdTMyIG1hc2s7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gQEAgLTI3NzQs
MTQgKzI3NzQsMTQgQEAgc3RhdGljIGludCB2bHZfYWxsb3dfZ3Rfd2FrZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgYWxsb3cpCj4gPiAgIAltYXNrID0gVkxWX0dUTENf
QUxMT1dXQUtFQUNLOwo+ID4gICAJdmFsID0gYWxsb3cgPyBtYXNrIDogMDsKPiA+IC0JZXJyID0g
dmx2X3dhaXRfZm9yX3B3X3N0YXR1cyhkZXZfcHJpdiwgbWFzaywgdmFsKTsKPiA+ICsJZXJyID0g
dmx2X3dhaXRfZm9yX3B3X3N0YXR1cyhpOTE1LCBtYXNrLCB2YWwpOwo+ID4gICAJaWYgKGVycikK
PiA+ICAgCQlEUk1fRVJST1IoInRpbWVvdXQgZGlzYWJsaW5nIEdUIHdha2luZ1xuIik7Cj4gPiAg
IAlyZXR1cm4gZXJyOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgdmx2X3dhaXRfZm9yX2d0X3dl
bGxzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCB2
bHZfd2FpdF9mb3JfZ3Rfd2VsbHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAg
IAkJCQkgIGJvb2wgd2FpdF9mb3Jfb24pCj4gPiAgIHsKPiA+ICAgCXUzMiBtYXNrOwo+ID4gQEAg
LTI3OTcsMTIgKzI3OTcsMTIgQEAgc3RhdGljIHZvaWQgdmx2X3dhaXRfZm9yX2d0X3dlbGxzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCSAqIFRoaXMgY2FuIGZhaWwg
dG8gdHVybiBvZmYgdGhlIHJjNiBpZiB0aGUgR1BVIGlzIHN0dWNrIGFmdGVyIGEgZmFpbGVkCj4g
PiAgIAkgKiByZXNldCBhbmQgd2UgYXJlIHRyeWluZyB0byBmb3JjZSB0aGUgbWFjaGluZSB0byBz
bGVlcC4KPiA+ICAgCSAqLwo+ID4gLQlpZiAodmx2X3dhaXRfZm9yX3B3X3N0YXR1cyhkZXZfcHJp
diwgbWFzaywgdmFsKSkKPiA+ICsJaWYgKHZsdl93YWl0X2Zvcl9wd19zdGF0dXMoaTkxNSwgbWFz
aywgdmFsKSkKPiA+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJ0aW1lb3V0IHdhaXRpbmcgZm9yIEdU
IHdlbGxzIHRvIGdvICVzXG4iLAo+ID4gICAJCQkJIG9ub2ZmKHdhaXRfZm9yX29uKSk7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCB2bHZfY2hlY2tfbm9fZ3RfYWNjZXNzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCB2bHZfY2hlY2tfbm9fZ3RfYWNj
ZXNzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlpZiAoIShJ
OTE1X1JFQUQoVkxWX0dUTENfUFdfU1RBVFVTKSAmIFZMVl9HVExDX0FMTE9XV0FLRUVSUikpCj4g
PiAgIAkJcmV0dXJuOwo+ID4gQEAgLTI4MTEsNyArMjgxMSw3IEBAIHN0YXRpYyB2b2lkIHZsdl9j
aGVja19ub19ndF9hY2Nlc3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
ICAJSTkxNV9XUklURShWTFZfR1RMQ19QV19TVEFUVVMsIFZMVl9HVExDX0FMTE9XV0FLRUVSUik7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IHZsdl9zdXNwZW5kX2NvbXBsZXRlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgaW50IHZsdl9zdXNwZW5kX2NvbXBs
ZXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIgbWFz
azsKPiA+ICAgCWludCBlcnI7Cj4gPiBAQCAtMjgyMCwyNSArMjgyMCwyNSBAQCBzdGF0aWMgaW50
IHZsdl9zdXNwZW5kX2NvbXBsZXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgCSAqIEJzcGVjIGRlZmluZXMgdGhlIGZvbGxvd2luZyBHVCB3ZWxsIG9uIGZsYWdzIGFz
IGRlYnVnIG9ubHksIHNvCj4gPiAgIAkgKiBkb24ndCB0cmVhdCB0aGVtIGFzIGhhcmQgZmFpbHVy
ZXMuCj4gPiAgIAkgKi8KPiA+IC0Jdmx2X3dhaXRfZm9yX2d0X3dlbGxzKGRldl9wcml2LCBmYWxz
ZSk7Cj4gPiArCXZsdl93YWl0X2Zvcl9ndF93ZWxscyhpOTE1LCBmYWxzZSk7Cj4gPiAgIAltYXNr
ID0gVkxWX0dUTENfUkVOREVSX0NUWF9FWElTVFMgfCBWTFZfR1RMQ19NRURJQV9DVFhfRVhJU1RT
Owo+ID4gICAJV0FSTl9PTigoSTkxNV9SRUFEKFZMVl9HVExDX1dBS0VfQ1RSTCkgJiBtYXNrKSAh
PSBtYXNrKTsKPiA+IC0Jdmx2X2NoZWNrX25vX2d0X2FjY2VzcyhkZXZfcHJpdik7Cj4gPiArCXZs
dl9jaGVja19ub19ndF9hY2Nlc3MoaTkxNSk7Cj4gPiAtCWVyciA9IHZsdl9mb3JjZV9nZnhfY2xv
Y2soZGV2X3ByaXYsIHRydWUpOwo+ID4gKwllcnIgPSB2bHZfZm9yY2VfZ2Z4X2Nsb2NrKGk5MTUs
IHRydWUpOwo+ID4gICAJaWYgKGVycikKPiA+ICAgCQlnb3RvIGVycjE7Cj4gPiAtCWVyciA9IHZs
dl9hbGxvd19ndF93YWtlKGRldl9wcml2LCBmYWxzZSk7Cj4gPiArCWVyciA9IHZsdl9hbGxvd19n
dF93YWtlKGk5MTUsIGZhbHNlKTsKPiA+ICAgCWlmIChlcnIpCj4gPiAgIAkJZ290byBlcnIyOwo+
ID4gLQlpZiAoIUlTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gLQkJdmx2X3NhdmVfZ3VuaXRf
czBpeF9zdGF0ZShkZXZfcHJpdik7Cj4gPiArCWlmICghSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+
ICsJCXZsdl9zYXZlX2d1bml0X3MwaXhfc3RhdGUoaTkxNSk7Cj4gPiAtCWVyciA9IHZsdl9mb3Jj
ZV9nZnhfY2xvY2soZGV2X3ByaXYsIGZhbHNlKTsKPiA+ICsJZXJyID0gdmx2X2ZvcmNlX2dmeF9j
bG9jayhpOTE1LCBmYWxzZSk7Cj4gPiAgIAlpZiAoZXJyKQo+ID4gICAJCWdvdG8gZXJyMjsKPiA+
IEBAIC0yODQ2LDE0ICsyODQ2LDE0IEBAIHN0YXRpYyBpbnQgdmx2X3N1c3BlbmRfY29tcGxldGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICBlcnIyOgo+ID4gICAJLyog
Rm9yIHNhZmV0eSBhbHdheXMgcmUtZW5hYmxlIHdha2luZyBhbmQgZGlzYWJsZSBnZnggY2xvY2sg
Zm9yY2luZyAqLwo+ID4gLQl2bHZfYWxsb3dfZ3Rfd2FrZShkZXZfcHJpdiwgdHJ1ZSk7Cj4gPiAr
CXZsdl9hbGxvd19ndF93YWtlKGk5MTUsIHRydWUpOwo+ID4gICBlcnIxOgo+ID4gLQl2bHZfZm9y
Y2VfZ2Z4X2Nsb2NrKGRldl9wcml2LCBmYWxzZSk7Cj4gPiArCXZsdl9mb3JjZV9nZnhfY2xvY2so
aTkxNSwgZmFsc2UpOwo+ID4gICAJcmV0dXJuIGVycjsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQg
dmx2X3Jlc3VtZV9wcmVwYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICtzdGF0aWMgaW50IHZsdl9yZXN1bWVfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJCWJvb2wgcnBtX3Jlc3VtZSkKPiA+ICAgewo+ID4gICAJaW50IGVycjsK
PiA+IEBAIC0yODY0LDIzICsyODY0LDIzIEBAIHN0YXRpYyBpbnQgdmx2X3Jlc3VtZV9wcmVwYXJl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCSAqIGNhbiBkbyBhdCB0
aGlzIHBvaW50LiBSZXR1cm4gdGhlIGZpcnN0IGVycm9yIGNvZGUgKHdoaWNoIHdpbGwgYWxzbwo+
ID4gICAJICogbGVhdmUgUlBNIHBlcm1hbmVudGx5IGRpc2FibGVkKS4KPiA+ICAgCSAqLwo+ID4g
LQlyZXQgPSB2bHZfZm9yY2VfZ2Z4X2Nsb2NrKGRldl9wcml2LCB0cnVlKTsKPiA+ICsJcmV0ID0g
dmx2X2ZvcmNlX2dmeF9jbG9jayhpOTE1LCB0cnVlKTsKPiA+IC0JaWYgKCFJU19DSEVSUllWSUVX
KGRldl9wcml2KSkKPiA+IC0JCXZsdl9yZXN0b3JlX2d1bml0X3MwaXhfc3RhdGUoZGV2X3ByaXYp
Owo+ID4gKwlpZiAoIUlTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiArCQl2bHZfcmVzdG9yZV9ndW5p
dF9zMGl4X3N0YXRlKGk5MTUpOwo+ID4gLQllcnIgPSB2bHZfYWxsb3dfZ3Rfd2FrZShkZXZfcHJp
diwgdHJ1ZSk7Cj4gPiArCWVyciA9IHZsdl9hbGxvd19ndF93YWtlKGk5MTUsIHRydWUpOwo+ID4g
ICAJaWYgKCFyZXQpCj4gPiAgIAkJcmV0ID0gZXJyOwo+ID4gLQllcnIgPSB2bHZfZm9yY2VfZ2Z4
X2Nsb2NrKGRldl9wcml2LCBmYWxzZSk7Cj4gPiArCWVyciA9IHZsdl9mb3JjZV9nZnhfY2xvY2so
aTkxNSwgZmFsc2UpOwo+ID4gICAJaWYgKCFyZXQpCj4gPiAgIAkJcmV0ID0gZXJyOwo+ID4gLQl2
bHZfY2hlY2tfbm9fZ3RfYWNjZXNzKGRldl9wcml2KTsKPiA+ICsJdmx2X2NoZWNrX25vX2d0X2Fj
Y2VzcyhpOTE1KTsKPiA+ICAgCWlmIChycG1fcmVzdW1lKQo+ID4gLQkJaW50ZWxfaW5pdF9jbG9j
a19nYXRpbmcoZGV2X3ByaXYpOwo+ID4gKwkJaW50ZWxfaW5pdF9jbG9ja19nYXRpbmcoaTkxNSk7
Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtMjg4OSw4MCArMjg4OSw4MCBAQCBz
dGF0aWMgaW50IGludGVsX3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgZGV2aWNlICprZGV2KQo+ID4g
ICB7Cj4gPiAgIAlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IHRvX3BjaV9kZXYoa2Rldik7Cj4gPiAg
IAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gcGNpX2dldF9kcnZkYXRhKHBkZXYpOwo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJaW50IHJl
dDsKPiA+IC0JaWYgKFdBUk5fT05fT05DRSghKGRldl9wcml2LT5ndF9wbS5yYzYuZW5hYmxlZCAm
JiBIQVNfUkM2KGRldl9wcml2KSkpKQo+ID4gKwlpZiAoV0FSTl9PTl9PTkNFKCEoaTkxNS0+Z3Rf
cG0ucmM2LmVuYWJsZWQgJiYgSEFTX1JDNihpOTE1KSkpKQo+ID4gICAJCXJldHVybiAtRU5PREVW
Owo+ID4gLQlpZiAoV0FSTl9PTl9PTkNFKCFIQVNfUlVOVElNRV9QTShkZXZfcHJpdikpKQo+ID4g
KwlpZiAoV0FSTl9PTl9PTkNFKCFIQVNfUlVOVElNRV9QTShpOTE1KSkpCj4gPiAgIAkJcmV0dXJu
IC1FTk9ERVY7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJTdXNwZW5kaW5nIGRldmljZVxuIik7Cj4g
PiAtCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gPiArCWRpc2FibGVf
cnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBXZSBhcmUgc2Fm
ZSBoZXJlIGFnYWluc3QgcmUtZmF1bHRzLCBzaW5jZSB0aGUgZmF1bHQgaGFuZGxlciB0YWtlcwo+
ID4gICAJICogYW4gUlBNIHJlZmVyZW5jZS4KPiA+ICAgCSAqLwo+ID4gLQlpOTE1X2dlbV9ydW50
aW1lX3N1c3BlbmQoZGV2X3ByaXYpOwo+ID4gKwlpOTE1X2dlbV9ydW50aW1lX3N1c3BlbmQoaTkx
NSk7Cj4gPiAtCWludGVsX3VjX3J1bnRpbWVfc3VzcGVuZChkZXZfcHJpdik7Cj4gPiArCWludGVs
X3VjX3J1bnRpbWVfc3VzcGVuZChpOTE1KTsKPiA+IC0JaW50ZWxfcnVudGltZV9wbV9kaXNhYmxl
X2ludGVycnVwdHMoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX2Rpc2FibGVfaW50
ZXJydXB0cyhpOTE1KTsKPiA+IC0JaW50ZWxfdW5jb3JlX3N1c3BlbmQoJmRldl9wcml2LT51bmNv
cmUpOwo+ID4gKwlpbnRlbF91bmNvcmVfc3VzcGVuZCgmaTkxNS0+dW5jb3JlKTsKPiA+ICAgCXJl
dCA9IDA7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiAtCQlpY2xf
ZGlzcGxheV9jb3JlX3VuaW5pdChkZXZfcHJpdik7Cj4gPiAtCQlieHRfZW5hYmxlX2RjOShkZXZf
cHJpdik7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKPiA+IC0JCWJ4
dF9kaXNwbGF5X2NvcmVfdW5pbml0KGRldl9wcml2KTsKPiA+IC0JCWJ4dF9lbmFibGVfZGM5KGRl
dl9wcml2KTsKPiA+IC0JfSBlbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9B
RFdFTEwoZGV2X3ByaXYpKSB7Cj4gPiAtCQloc3dfZW5hYmxlX3BjOChkZXZfcHJpdik7Cj4gPiAt
CX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpIHsKPiA+IC0JCXJldCA9IHZsdl9zdXNwZW5kX2NvbXBsZXRlKGRldl9wcml2KTsKPiA+
ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgewo+ID4gKwkJaWNsX2Rpc3BsYXlfY29yZV91
bmluaXQoaTkxNSk7Cj4gPiArCQlieHRfZW5hYmxlX2RjOShpOTE1KTsKPiA+ICsJfSBlbHNlIGlm
IChJU19HRU45X0xQKGk5MTUpKSB7Cj4gPiArCQlieHRfZGlzcGxheV9jb3JlX3VuaW5pdChpOTE1
KTsKPiA+ICsJCWJ4dF9lbmFibGVfZGM5KGk5MTUpOwo+ID4gKwl9IGVsc2UgaWYgKElTX0hBU1dF
TEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gPiArCQloc3dfZW5hYmxlX3BjOChp
OTE1KTsKPiA+ICsJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJ
RVcoaTkxNSkpIHsKPiA+ICsJCXJldCA9IHZsdl9zdXNwZW5kX2NvbXBsZXRlKGk5MTUpOwo+ID4g
ICAJfQo+ID4gICAJaWYgKHJldCkgewo+ID4gICAJCURSTV9FUlJPUigiUnVudGltZSBzdXNwZW5k
IGZhaWxlZCwgZGlzYWJsaW5nIGl0ICglZClcbiIsIHJldCk7Cj4gPiAtCQlpbnRlbF91bmNvcmVf
cnVudGltZV9yZXN1bWUoJmRldl9wcml2LT51bmNvcmUpOwo+ID4gKwkJaW50ZWxfdW5jb3JlX3J1
bnRpbWVfcmVzdW1lKCZpOTE1LT51bmNvcmUpOwo+ID4gLQkJaW50ZWxfcnVudGltZV9wbV9lbmFi
bGVfaW50ZXJydXB0cyhkZXZfcHJpdik7Cj4gPiArCQlpbnRlbF9ydW50aW1lX3BtX2VuYWJsZV9p
bnRlcnJ1cHRzKGk5MTUpOwo+ID4gLQkJaW50ZWxfdWNfcmVzdW1lKGRldl9wcml2KTsKPiA+ICsJ
CWludGVsX3VjX3Jlc3VtZShpOTE1KTsKPiA+IC0JCWk5MTVfZ2VtX2luaXRfc3dpenpsaW5nKGRl
dl9wcml2KTsKPiA+IC0JCWk5MTVfZ2VtX3Jlc3RvcmVfZmVuY2VzKGRldl9wcml2KTsKPiA+ICsJ
CWk5MTVfZ2VtX2luaXRfc3dpenpsaW5nKGk5MTUpOwo+ID4gKwkJaTkxNV9nZW1fcmVzdG9yZV9m
ZW5jZXMoaTkxNSk7Cj4gPiAtCQllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7
Cj4gPiArCQllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiA+ICAgCQlyZXR1cm4g
cmV0Owo+ID4gICAJfQo+ID4gLQllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7
Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fY2xlYW51cChkZXZfcHJpdik7Cj4gPiArCWVuYWJsZV9y
cG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX2NsZWFudXAo
aTkxNSk7Cj4gPiAtCWlmIChpbnRlbF91bmNvcmVfYXJtX3VuY2xhaW1lZF9tbWlvX2RldGVjdGlv
bigmZGV2X3ByaXYtPnVuY29yZSkpCj4gPiArCWlmIChpbnRlbF91bmNvcmVfYXJtX3VuY2xhaW1l
ZF9tbWlvX2RldGVjdGlvbigmaTkxNS0+dW5jb3JlKSkKPiA+ICAgCQlEUk1fRVJST1IoIlVuY2xh
aW1lZCBhY2Nlc3MgZGV0ZWN0ZWQgcHJpb3IgdG8gc3VzcGVuZGluZ1xuIik7Cj4gPiAtCWRldl9w
cml2LT5ydW50aW1lX3BtLnN1c3BlbmRlZCA9IHRydWU7Cj4gPiArCWk5MTUtPnJ1bnRpbWVfcG0u
c3VzcGVuZGVkID0gdHJ1ZTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBGSVhNRTogV2UgcmVhbGx5IHNo
b3VsZCBmaW5kIGEgZG9jdW1lbnQgdGhhdCByZWZlcmVuY2VzIHRoZSBhcmd1bWVudHMKPiA+ICAg
CSAqIHVzZWQgYmVsb3chCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX0JST0FEV0VMTChkZXZfcHJp
dikpIHsKPiA+ICsJaWYgKElTX0JST0FEV0VMTChpOTE1KSkgewo+ID4gICAJCS8qCj4gPiAgIAkJ
ICogT24gQnJvYWR3ZWxsLCBpZiB3ZSB1c2UgUENJX0QxIHRoZSBQQ0ggRERJIHBvcnRzIHdpbGwg
c3RvcAo+ID4gICAJCSAqIGJlaW5nIGRldGVjdGVkLCBhbmQgdGhlIGNhbGwgd2UgZG8gYXQgaW50
ZWxfcnVudGltZV9yZXN1bWUoKQo+ID4gICAJCSAqIHdvbid0IGJlIGFibGUgdG8gcmVzdG9yZSB0
aGVtLiBTaW5jZSBQQ0lfRDNob3QgbWF0Y2hlcyB0aGUKPiA+ICAgCQkgKiBhY3R1YWwgc3BlY2lm
aWNhdGlvbiBhbmQgYXBwZWFycyB0byBiZSB3b3JraW5nLCB1c2UgaXQuCj4gPiAgIAkJICovCj4g
PiAtCQlpbnRlbF9vcHJlZ2lvbl9ub3RpZnlfYWRhcHRlcihkZXZfcHJpdiwgUENJX0QzaG90KTsK
PiA+ICsJCWludGVsX29wcmVnaW9uX25vdGlmeV9hZGFwdGVyKGk5MTUsIFBDSV9EM2hvdCk7Cj4g
PiAgIAl9IGVsc2Ugewo+ID4gICAJCS8qCj4gPiAgIAkJICogY3VycmVudCB2ZXJzaW9ucyBvZiBm
aXJtd2FyZSB3aGljaCBkZXBlbmQgb24gdGhpcyBvcHJlZ2lvbgo+ID4gQEAgLTI5NzEsMTMgKzI5
NzEsMTMgQEAgc3RhdGljIGludCBpbnRlbF9ydW50aW1lX3N1c3BlbmQoc3RydWN0IGRldmljZSAq
a2RldikKPiA+ICAgCQkgKiB0byBkaXN0aW5ndWlzaCBpdCBmcm9tIG5vdGlmaWNhdGlvbnMgdGhh
dCBtaWdodCBiZSBzZW50IHZpYQo+ID4gICAJCSAqIHRoZSBzdXNwZW5kIHBhdGguCj4gPiAgIAkJ
ICovCj4gPiAtCQlpbnRlbF9vcHJlZ2lvbl9ub3RpZnlfYWRhcHRlcihkZXZfcHJpdiwgUENJX0Qx
KTsKPiA+ICsJCWludGVsX29wcmVnaW9uX25vdGlmeV9hZGFwdGVyKGk5MTUsIFBDSV9EMSk7Cj4g
PiAgIAl9Cj4gPiAtCWFzc2VydF9mb3JjZXdha2VzX2luYWN0aXZlKCZkZXZfcHJpdi0+dW5jb3Jl
KTsKPiA+ICsJYXNzZXJ0X2ZvcmNld2FrZXNfaW5hY3RpdmUoJmk5MTUtPnVuY29yZSk7Cj4gPiAt
CWlmICghSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgJiYgIUlTX0NIRVJSWVZJRVcoZGV2X3ByaXYp
KQo+ID4gLQkJaW50ZWxfaHBkX3BvbGxfaW5pdChkZXZfcHJpdik7Cj4gPiArCWlmICghSVNfVkFM
TEVZVklFVyhpOTE1KSAmJiAhSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICsJCWludGVsX2hwZF9w
b2xsX2luaXQoaTkxNSk7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJEZXZpY2Ugc3VzcGVuZGVkXG4i
KTsKPiA+ICAgCXJldHVybiAwOwo+ID4gQEAgLTI5ODcsNjkgKzI5ODcsNjkgQEAgc3RhdGljIGlu
dCBpbnRlbF9ydW50aW1lX3Jlc3VtZShzdHJ1Y3QgZGV2aWNlICprZGV2KQo+ID4gICB7Cj4gPiAg
IAlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IHRvX3BjaV9kZXYoa2Rldik7Cj4gPiAgIAlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gcGNpX2dldF9kcnZkYXRhKHBkZXYpOwo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJaW50IHJldCA9IDA7Cj4g
PiAtCWlmIChXQVJOX09OX09OQ0UoIUhBU19SVU5USU1FX1BNKGRldl9wcml2KSkpCj4gPiArCWlm
IChXQVJOX09OX09OQ0UoIUhBU19SVU5USU1FX1BNKGk5MTUpKSkKPiA+ICAgCQlyZXR1cm4gLUVO
T0RFVjsKPiA+ICAgCURSTV9ERUJVR19LTVMoIlJlc3VtaW5nIGRldmljZVxuIik7Cj4gPiAtCVdB
Uk5fT05fT05DRShhdG9taWNfcmVhZCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0ud2FrZXJlZl9jb3Vu
dCkpOwo+ID4gLQlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ID4gKwlX
QVJOX09OX09OQ0UoYXRvbWljX3JlYWQoJmk5MTUtPnJ1bnRpbWVfcG0ud2FrZXJlZl9jb3VudCkp
Owo+ID4gKwlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gPiAtCWludGVsX29w
cmVnaW9uX25vdGlmeV9hZGFwdGVyKGRldl9wcml2LCBQQ0lfRDApOwo+ID4gLQlkZXZfcHJpdi0+
cnVudGltZV9wbS5zdXNwZW5kZWQgPSBmYWxzZTsKPiA+IC0JaWYgKGludGVsX3VuY29yZV91bmNs
YWltZWRfbW1pbygmZGV2X3ByaXYtPnVuY29yZSkpCj4gPiArCWludGVsX29wcmVnaW9uX25vdGlm
eV9hZGFwdGVyKGk5MTUsIFBDSV9EMCk7Cj4gPiArCWk5MTUtPnJ1bnRpbWVfcG0uc3VzcGVuZGVk
ID0gZmFsc2U7Cj4gPiArCWlmIChpbnRlbF91bmNvcmVfdW5jbGFpbWVkX21taW8oJmk5MTUtPnVu
Y29yZSkpCj4gPiAgIAkJRFJNX0RFQlVHX0RSSVZFUigiVW5jbGFpbWVkIGFjY2VzcyBkdXJpbmcg
c3VzcGVuZCwgYmlvcz9cbiIpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkg
ewo+ID4gLQkJYnh0X2Rpc2FibGVfZGM5KGRldl9wcml2KTsKPiA+IC0JCWljbF9kaXNwbGF5X2Nv
cmVfaW5pdChkZXZfcHJpdiwgdHJ1ZSk7Cj4gPiAtCQlpZiAoZGV2X3ByaXYtPmNzci5kbWNfcGF5
bG9hZCkgewo+ID4gLQkJCWlmIChkZXZfcHJpdi0+Y3NyLmFsbG93ZWRfZGNfbWFzayAmCj4gPiAr
CWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiA+ICsJCWJ4dF9kaXNhYmxlX2RjOShpOTE1
KTsKPiA+ICsJCWljbF9kaXNwbGF5X2NvcmVfaW5pdChpOTE1LCB0cnVlKTsKPiA+ICsJCWlmIChp
OTE1LT5jc3IuZG1jX3BheWxvYWQpIHsKPiA+ICsJCQlpZiAoaTkxNS0+Y3NyLmFsbG93ZWRfZGNf
bWFzayAmCj4gPiAgIAkJCSAgICBEQ19TVEFURV9FTl9VUFRPX0RDNikKPiA+IC0JCQkJc2tsX2Vu
YWJsZV9kYzYoZGV2X3ByaXYpOwo+ID4gLQkJCWVsc2UgaWYgKGRldl9wcml2LT5jc3IuYWxsb3dl
ZF9kY19tYXNrICYKPiA+ICsJCQkJc2tsX2VuYWJsZV9kYzYoaTkxNSk7Cj4gPiArCQkJZWxzZSBp
ZiAoaTkxNS0+Y3NyLmFsbG93ZWRfZGNfbWFzayAmCj4gPiAgIAkJCQkgRENfU1RBVEVfRU5fVVBU
T19EQzUpCj4gPiAtCQkJCWdlbjlfZW5hYmxlX2RjNShkZXZfcHJpdik7Cj4gPiArCQkJCWdlbjlf
ZW5hYmxlX2RjNShpOTE1KTsKPiA+ICAgCQl9Cj4gPiAtCX0gZWxzZSBpZiAoSVNfR0VOOV9MUChk
ZXZfcHJpdikpIHsKPiA+IC0JCWJ4dF9kaXNhYmxlX2RjOShkZXZfcHJpdik7Cj4gPiAtCQlieHRf
ZGlzcGxheV9jb3JlX2luaXQoZGV2X3ByaXYsIHRydWUpOwo+ID4gLQkJaWYgKGRldl9wcml2LT5j
c3IuZG1jX3BheWxvYWQgJiYKPiA+IC0JCSAgICAoZGV2X3ByaXYtPmNzci5hbGxvd2VkX2RjX21h
c2sgJiBEQ19TVEFURV9FTl9VUFRPX0RDNSkpCj4gPiAtCQkJZ2VuOV9lbmFibGVfZGM1KGRldl9w
cml2KTsKPiA+IC0JfSBlbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdF
TEwoZGV2X3ByaXYpKSB7Cj4gPiAtCQloc3dfZGlzYWJsZV9wYzgoZGV2X3ByaXYpOwo+ID4gLQl9
IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3By
aXYpKSB7Cj4gPiAtCQlyZXQgPSB2bHZfcmVzdW1lX3ByZXBhcmUoZGV2X3ByaXYsIHRydWUpOwo+
ID4gKwl9IGVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiA+ICsJCWJ4dF9kaXNhYmxlX2Rj
OShpOTE1KTsKPiA+ICsJCWJ4dF9kaXNwbGF5X2NvcmVfaW5pdChpOTE1LCB0cnVlKTsKPiA+ICsJ
CWlmIChpOTE1LT5jc3IuZG1jX3BheWxvYWQgJiYKPiA+ICsJCSAgICAoaTkxNS0+Y3NyLmFsbG93
ZWRfZGNfbWFzayAmIERDX1NUQVRFX0VOX1VQVE9fREM1KSkKPiA+ICsJCQlnZW45X2VuYWJsZV9k
YzUoaTkxNSk7Cj4gPiArCX0gZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdF
TEwoaTkxNSkpIHsKPiA+ICsJCWhzd19kaXNhYmxlX3BjOChpOTE1KTsKPiA+ICsJfSBlbHNlIGlm
IChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+ICsJCXJl
dCA9IHZsdl9yZXN1bWVfcHJlcGFyZShpOTE1LCB0cnVlKTsKPiA+ICAgCX0KPiA+IC0JaW50ZWxf
dW5jb3JlX3J1bnRpbWVfcmVzdW1lKCZkZXZfcHJpdi0+dW5jb3JlKTsKPiA+ICsJaW50ZWxfdW5j
b3JlX3J1bnRpbWVfcmVzdW1lKCZpOTE1LT51bmNvcmUpOwo+ID4gLQlpbnRlbF9ydW50aW1lX3Bt
X2VuYWJsZV9pbnRlcnJ1cHRzKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfcnVudGltZV9wbV9lbmFi
bGVfaW50ZXJydXB0cyhpOTE1KTsKPiA+IC0JaW50ZWxfdWNfcmVzdW1lKGRldl9wcml2KTsKPiA+
ICsJaW50ZWxfdWNfcmVzdW1lKGk5MTUpOwo+ID4gICAJLyoKPiA+ICAgCSAqIE5vIHBvaW50IG9m
IHJvbGxpbmcgYmFjayB0aGluZ3MgaW4gY2FzZSBvZiBhbiBlcnJvciwgYXMgdGhlIGJlc3QKPiA+
ICAgCSAqIHdlIGNhbiBkbyBpcyB0byBob3BlIHRoYXQgdGhpbmdzIHdpbGwgc3RpbGwgd29yayAo
YW5kIGRpc2FibGUgUlBNKS4KPiA+ICAgCSAqLwo+ID4gLQlpOTE1X2dlbV9pbml0X3N3aXp6bGlu
ZyhkZXZfcHJpdik7Cj4gPiAtCWk5MTVfZ2VtX3Jlc3RvcmVfZmVuY2VzKGRldl9wcml2KTsKPiA+
ICsJaTkxNV9nZW1faW5pdF9zd2l6emxpbmcoaTkxNSk7Cj4gPiArCWk5MTVfZ2VtX3Jlc3RvcmVf
ZmVuY2VzKGk5MTUpOwo+ID4gICAJLyoKPiA+ICAgCSAqIE9uIFZMVi9DSFYgZGlzcGxheSBpbnRl
cnJ1cHRzIGFyZSBwYXJ0IG9mIHRoZSBkaXNwbGF5Cj4gPiAgIAkgKiBwb3dlciB3ZWxsLCBzbyBo
cGQgaXMgcmVpbml0aWFsaXplZCBmcm9tIHRoZXJlLiBGb3IKPiA+ICAgCSAqIGV2ZXJ5b25lIGVs
c2UgZG8gaXQgaGVyZS4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoIUlTX1ZBTExFWVZJRVcoZGV2X3By
aXYpICYmICFJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+IC0JCWludGVsX2hwZF9pbml0KGRl
dl9wcml2KTsKPiA+ICsJaWYgKCFJU19WQUxMRVlWSUVXKGk5MTUpICYmICFJU19DSEVSUllWSUVX
KGk5MTUpKQo+ID4gKwkJaW50ZWxfaHBkX2luaXQoaTkxNSk7Cj4gPiAtCWludGVsX2VuYWJsZV9p
cGMoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9lbmFibGVfaXBjKGk5MTUpOwo+ID4gLQllbmFibGVf
cnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gPiArCWVuYWJsZV9ycG1fd2FrZXJlZl9h
c3NlcnRzKGk5MTUpOwo+ID4gICAJaWYgKHJldCkKPiA+ICAgCQlEUk1fRVJST1IoIlJ1bnRpbWUg
cmVzdW1lIGZhaWxlZCwgZGlzYWJsaW5nIGl0ICglZClcbiIsIHJldCk7Cj4gPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmgKPiA+IGluZGV4IGViOThkMjg1ZDI5MC4uYTFhZGI3OWNhMmMzIDEwMDY0NAo+
ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAo+ID4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAo+ID4gQEAgLTIwOCw3ICsyMDgsNyBAQCBzdHJ1Y3Qg
aTkxNV9tbV9zdHJ1Y3Q7Cj4gPiAgIHN0cnVjdCBpOTE1X21tdV9vYmplY3Q7Cj4gPiAgIHN0cnVj
dCBkcm1faTkxNV9maWxlX3ByaXZhdGUgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1Owo+ID4gICAJc3Ry
dWN0IGRybV9maWxlICpmaWxlOwo+ID4gICAJc3RydWN0IHsKPiA+IEBAIC0yNzgsMTIgKzI3OCwx
MiBAQCBzdHJ1Y3QgZHBsbDsKPiA+ICAgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlOwo+ID4gICBz
dHJ1Y3QgZHJtX2k5MTVfZGlzcGxheV9mdW5jcyB7Cj4gPiAtCXZvaWQgKCpnZXRfY2RjbGspKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICsJdm9pZCAoKmdldF9jZGNsayko
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgc3RydWN0IGludGVsX2Nk
Y2xrX3N0YXRlICpjZGNsa19zdGF0ZSk7Cj4gPiAtCXZvaWQgKCpzZXRfY2RjbGspKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICsJdm9pZCAoKnNldF9jZGNsaykoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgY29uc3Qgc3RydWN0IGludGVsX2Nk
Y2xrX3N0YXRlICpjZGNsa19zdGF0ZSwKPiA+ICAgCQkJICBlbnVtIHBpcGUgcGlwZSk7Cj4gPiAt
CWludCAoKmdldF9maWZvX3NpemUpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICsJaW50ICgqZ2V0X2ZpZm9fc2l6ZSkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gPiAgIAkJCSAgICAgZW51bSBpOXh4X3BsYW5lX2lkIGk5eHhfcGxhbmUpOwo+ID4gICAJaW50
ICgqY29tcHV0ZV9waXBlX3dtKShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKTsKPiA+
ICAgCWludCAoKmNvbXB1dGVfaW50ZXJtZWRpYXRlX3dtKShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqbmV3c3RhdGUpOwo+ID4gQEAgLTMxNyw4ICszMTcsOCBAQCBzdHJ1Y3QgZHJtX2k5MTVfZGlz
cGxheV9mdW5jcyB7Cj4gPiAgIAkJCQkgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3Rh
dGUgKm9sZF9jb25uX3N0YXRlKTsKPiA+ICAgCXZvaWQgKCpmZGlfbGlua190cmFpbikoc3RydWN0
IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gPiAtCXZvaWQgKCppbml0X2Nsb2NrX2dhdGluZykoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC0Jdm9pZCAoKmhwZF9pcnFfc2V0
dXApKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArCXZvaWQgKCppbml0
X2Nsb2NrX2dhdGluZykoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gKwl2b2lk
ICgqaHBkX2lycV9zZXR1cCkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAJ
LyogY2xvY2sgdXBkYXRlcyBmb3IgbW9kZSBzZXQgKi8KPiA+ICAgCS8qIGN1cnNvciB1cGRhdGVz
ICovCj4gPiAgIAkvKiByZW5kZXIgY2xvY2sgaW5jcmVhc2UvZGVjcmVhc2UgKi8KPiA+IEBAIC01
NTIsNyArNTUyLDcgQEAgc3RydWN0IGludGVsX2dtYnVzIHsKPiA+ICAgCXUzMiByZWcwOwo+ID4g
ICAJaTkxNV9yZWdfdCBncGlvX3JlZzsKPiA+ICAgCXN0cnVjdCBpMmNfYWxnb19iaXRfZGF0YSBi
aXRfYWxnbzsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2Owo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKPiA+ICAgfTsKPiA+ICAgc3RydWN0IGk5MTVf
c3VzcGVuZF9zYXZlZF9yZWdpc3RlcnMgewo+ID4gQEAgLTY0MSw3ICs2NDEsNyBAQCBzdHJ1Y3Qg
aW50ZWxfcnBzIHsKPiA+ICAgCS8qCj4gPiAgIAkgKiB3b3JrLCBpbnRlcnJ1cHRzX2VuYWJsZWQg
YW5kIHBtX2lpciBhcmUgcHJvdGVjdGVkIGJ5Cj4gPiAtCSAqIGRldl9wcml2LT5pcnFfbG9jawo+
ID4gKwkgKiBpOTE1LT5pcnFfbG9jawo+ID4gICAJICovCj4gPiAgIAlzdHJ1Y3Qgd29ya19zdHJ1
Y3Qgd29yazsKPiA+ICAgCWJvb2wgaW50ZXJydXB0c19lbmFibGVkOwo+ID4gQEAgLTEyNDAsOSAr
MTI0MCw5IEBAIHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtX29wcyB7Cj4gPiAgICAqLwo+ID4gICBz
dHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSB7Cj4gPiAgIAkvKioKPiA+IC0JICogQGRldl9wcml2OiBp
OTE1IGRybSBkZXZpY2UKPiA+ICsJICogQGk5MTU6IGk5MTUgZHJtIGRldmljZQo+ID4gICAJICov
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTU7Cj4gPiAgIAkvKioKPiA+ICAgCSAqIEBsaW5rOiBMaW5rcyB0
aGUgc3RyZWFtIGludG8gYGAmZHJtX2k5MTVfcHJpdmF0ZS0+c3RyZWFtc2BgCj4gPiBAQCAtMTMw
MiwyMCArMTMwMiwyMCBAQCBzdHJ1Y3QgaTkxNV9vYV9vcHMgewo+ID4gICAJICogQGlzX3ZhbGlk
X2JfY291bnRlcl9yZWc6IFZhbGlkYXRlcyByZWdpc3RlcidzIGFkZHJlc3MgZm9yCj4gPiAgIAkg
KiBwcm9ncmFtbWluZyBib29sZWFuIGNvdW50ZXJzIGZvciBhIHBhcnRpY3VsYXIgcGxhdGZvcm0u
Cj4gPiAgIAkgKi8KPiA+IC0JYm9vbCAoKmlzX3ZhbGlkX2JfY291bnRlcl9yZWcpKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICsJYm9vbCAoKmlzX3ZhbGlkX2JfY291bnRl
cl9yZWcpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgIHUz
MiBhZGRyKTsKPiA+ICAgCS8qKgo+ID4gICAJICogQGlzX3ZhbGlkX211eF9yZWc6IFZhbGlkYXRl
cyByZWdpc3RlcidzIGFkZHJlc3MgZm9yIHByb2dyYW1taW5nIG11eAo+ID4gICAJICogZm9yIGEg
cGFydGljdWxhciBwbGF0Zm9ybS4KPiA+ICAgCSAqLwo+ID4gLQlib29sICgqaXNfdmFsaWRfbXV4
X3JlZykoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgYWRkcik7Cj4gPiAr
CWJvb2wgKCppc192YWxpZF9tdXhfcmVnKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
dTMyIGFkZHIpOwo+ID4gICAJLyoqCj4gPiAgIAkgKiBAaXNfdmFsaWRfZmxleF9yZWc6IFZhbGlk
YXRlcyByZWdpc3RlcidzIGFkZHJlc3MgZm9yIHByb2dyYW1taW5nCj4gPiAgIAkgKiBmbGV4IEVV
IGZpbHRlcmluZyBmb3IgYSBwYXJ0aWN1bGFyIHBsYXRmb3JtLgo+ID4gICAJICovCj4gPiAtCWJv
b2wgKCppc192YWxpZF9mbGV4X3JlZykoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCB1MzIgYWRkcik7Cj4gPiArCWJvb2wgKCppc192YWxpZF9mbGV4X3JlZykoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBhZGRyKTsKPiA+ICAgCS8qKgo+ID4gICAJICogQGVuYWJs
ZV9tZXRyaWNfc2V0OiBTZWxlY3RzIGFuZCBhcHBsaWVzIGFueSBNVVggY29uZmlndXJhdGlvbiB0
byBzZXQKPiA+IEBAIC0xMzI5LDcgKzEzMjksNyBAQCBzdHJ1Y3QgaTkxNV9vYV9vcHMgewo+ID4g
ICAJICogQGRpc2FibGVfbWV0cmljX3NldDogUmVtb3ZlIHN5c3RlbSBjb25zdHJhaW50cyBhc3Nv
Y2lhdGVkIHdpdGggdXNpbmcKPiA+ICAgCSAqIHRoZSBPQSB1bml0Lgo+ID4gICAJICovCj4gPiAt
CXZvaWQgKCpkaXNhYmxlX21ldHJpY19zZXQpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdik7Cj4gPiArCXZvaWQgKCpkaXNhYmxlX21ldHJpY19zZXQpKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KTsKPiA+ICAgCS8qKgo+ID4gICAJICogQG9hX2VuYWJsZTogRW5hYmxlIHBl
cmlvZGljIHNhbXBsaW5nCj4gPiBAQCAtMTM1Nyw3ICsxMzU3LDcgQEAgc3RydWN0IGk5MTVfb2Ff
b3BzIHsKPiA+ICAgCSAqIGhhbmRsaW5nIHRoZSBPQSB1bml0IHRhaWwgcG9pbnRlciByYWNlIHRo
YXQgYWZmZWN0cyBtdWx0aXBsZQo+ID4gICAJICogZ2VuZXJhdGlvbnMuCj4gPiAgIAkgKi8KPiA+
IC0JdTMyICgqb2FfaHdfdGFpbF9yZWFkKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwo+ID4gKwl1MzIgKCpvYV9od190YWlsX3JlYWQpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KTsKPiA+ICAgfTsKPiA+ICAgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlIHsKPiA+IEBA
IC0xNzUwLDEzICsxNzUwLDEzIEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlIHsKPiA+ICAgCQkv
Kgo+ID4gICAJCSAqIExvY2sgYXNzb2NpYXRlZCB3aXRoIGFkZGluZy9tb2RpZnlpbmcvcmVtb3Zp
bmcgT0EgY29uZmlncwo+ID4gLQkJICogaW4gZGV2X3ByaXYtPnBlcmYubWV0cmljc19pZHIuCj4g
PiArCQkgKiBpbiBpOTE1LT5wZXJmLm1ldHJpY3NfaWRyLgo+ID4gICAJCSAqLwo+ID4gICAJCXN0
cnVjdCBtdXRleCBtZXRyaWNzX2xvY2s7Cj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBMaXN0IG9mIGR5
bmFtaWMgY29uZmlndXJhdGlvbnMsIHlvdSBuZWVkIHRvIGhvbGQKPiA+IC0JCSAqIGRldl9wcml2
LT5wZXJmLm1ldHJpY3NfbG9jayB0byBhY2Nlc3MgaXQuCj4gPiArCQkgKiBpOTE1LT5wZXJmLm1l
dHJpY3NfbG9jayB0byBhY2Nlc3MgaXQuCj4gPiAgIAkJICovCj4gPiAgIAkJc3RydWN0IGlkciBt
ZXRyaWNzX2lkcjsKPiA+IEBAIC0xNzcyLDcgKzE3NzIsNyBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSB7Cj4gPiAgIAkJCSAqIFRoZSBzdHJlYW0gY3VycmVudGx5IHVzaW5nIHRoZSBPQSB1bml0
LiBJZiBhY2Nlc3NlZAo+ID4gICAJCQkgKiBvdXRzaWRlIGEgc3lzY2FsbCBhc3NvY2lhdGVkIHRv
IGl0cyBmaWxlCj4gPiAgIAkJCSAqIGRlc2NyaXB0b3IsIHlvdSBuZWVkIHRvIGhvbGQKPiA+IC0J
CQkgKiBkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleC4KPiA+ICsJCQkgKiBpOTE1LT5kcm0uc3Ry
dWN0X211dGV4Lgo+ID4gICAJCQkgKi8KPiA+ICAgCQkJc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0g
KmV4Y2x1c2l2ZV9zdHJlYW07Cj4gPiBAQCAtMjA2NiwxNSArMjA2NiwxNSBAQCBlbnVtIGhkbWlf
Zm9yY2VfYXVkaW8gewo+ID4gICAJR0VOTUFTSyhJTlRFTF9GUk9OVEJVRkZFUl9CSVRTX1BFUl9Q
SVBFICogKChwaXBlKSArIDEpIC0gMSwgXAo+ID4gICAJCUlOVEVMX0ZST05UQlVGRkVSX0JJVFNf
UEVSX1BJUEUgKiAocGlwZSkpCj4gPiAtI2RlZmluZSBJTlRFTF9JTkZPKGRldl9wcml2KQkoJihk
ZXZfcHJpdiktPl9faW5mbykKPiA+IC0jZGVmaW5lIFJVTlRJTUVfSU5GTyhkZXZfcHJpdikJKCYo
ZGV2X3ByaXYpLT5fX3J1bnRpbWUpCj4gPiAtI2RlZmluZSBEUklWRVJfQ0FQUyhkZXZfcHJpdikJ
KCYoZGV2X3ByaXYpLT5jYXBzKQo+ID4gKyNkZWZpbmUgSU5URUxfSU5GTyhpOTE1KQkoJihpOTE1
KS0+X19pbmZvKQo+ID4gKyNkZWZpbmUgUlVOVElNRV9JTkZPKGk5MTUpCSgmKGk5MTUpLT5fX3J1
bnRpbWUpCj4gPiArI2RlZmluZSBEUklWRVJfQ0FQUyhpOTE1KQkoJihpOTE1KS0+Y2FwcykKPiA+
IC0jZGVmaW5lIElOVEVMX0dFTihkZXZfcHJpdikJKElOVEVMX0lORk8oZGV2X3ByaXYpLT5nZW4p
Cj4gPiAtI2RlZmluZSBJTlRFTF9ERVZJRChkZXZfcHJpdikJKFJVTlRJTUVfSU5GTyhkZXZfcHJp
diktPmRldmljZV9pZCkKPiA+ICsjZGVmaW5lIElOVEVMX0dFTihpOTE1KQkoSU5URUxfSU5GTyhp
OTE1KS0+Z2VuKQo+ID4gKyNkZWZpbmUgSU5URUxfREVWSUQoaTkxNSkJKFJVTlRJTUVfSU5GTyhp
OTE1KS0+ZGV2aWNlX2lkKQo+ID4gICAjZGVmaW5lIFJFVklEX0ZPUkVWRVIJCTB4ZmYKPiA+IC0j
ZGVmaW5lIElOVEVMX1JFVklEKGRldl9wcml2KQkoKGRldl9wcml2KS0+ZHJtLnBkZXYtPnJldmlz
aW9uKQo+ID4gKyNkZWZpbmUgSU5URUxfUkVWSUQoaTkxNSkJKChpOTE1KS0+ZHJtLnBkZXYtPnJl
dmlzaW9uKQo+ID4gICAjZGVmaW5lIElOVEVMX0dFTl9NQVNLKHMsIGUpICggXAo+ID4gICAJQlVJ
TERfQlVHX09OX1pFUk8oIV9fYnVpbHRpbl9jb25zdGFudF9wKHMpKSArIFwKPiA+IEBAIC0yMDgy
LDEyICsyMDgyLDEyIEBAIGVudW0gaGRtaV9mb3JjZV9hdWRpbyB7Cj4gPiAgIAlHRU5NQVNLKChl
KSAtIDEsIChzKSAtIDEpKQo+ID4gICAvKiBSZXR1cm5zIHRydWUgaWYgR2VuIGlzIGluIGluY2x1
c2l2ZSByYW5nZSBbU3RhcnQsIEVuZF0gKi8KPiA+IC0jZGVmaW5lIElTX0dFTl9SQU5HRShkZXZf
cHJpdiwgcywgZSkgXAo+ID4gLQkoISEoSU5URUxfSU5GTyhkZXZfcHJpdiktPmdlbl9tYXNrICYg
SU5URUxfR0VOX01BU0soKHMpLCAoZSkpKSkKPiA+ICsjZGVmaW5lIElTX0dFTl9SQU5HRShpOTE1
LCBzLCBlKSBcCj4gPiArCSghIShJTlRFTF9JTkZPKGk5MTUpLT5nZW5fbWFzayAmIElOVEVMX0dF
Tl9NQVNLKChzKSwgKGUpKSkpCj4gPiAtI2RlZmluZSBJU19HRU4oZGV2X3ByaXYsIG4pIFwKPiA+
ICsjZGVmaW5lIElTX0dFTihpOTE1LCBuKSBcCj4gPiAgIAkoQlVJTERfQlVHX09OX1pFUk8oIV9f
YnVpbHRpbl9jb25zdGFudF9wKG4pKSArIFwKPiA+IC0JIElOVEVMX0lORk8oZGV2X3ByaXYpLT5n
ZW4gPT0gKG4pKQo+ID4gKwkgSU5URUxfSU5GTyhpOTE1KS0+Z2VuID09IChuKSkKPiA+ICAgLyoK
PiA+ICAgICogUmV0dXJuIHRydWUgaWYgcmV2aXNpb24gaXMgaW4gcmFuZ2UgW3NpbmNlLHVudGls
XSBpbmNsdXNpdmUuCj4gPiBAQCAtMjE1OSw4OCArMjE1OSw4OCBAQCBJU19TVUJQTEFURk9STShj
b25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCXJldHVybiAoKG1hc2sg
PDwgKG1zYiAtIHBiKSkgJiAobWFzayA8PCAobXNiIC0gcykpKSAmIEJJVChtc2IpOwo+ID4gICB9
Cj4gPiAtI2RlZmluZSBJU19NT0JJTEUoZGV2X3ByaXYpCShJTlRFTF9JTkZPKGRldl9wcml2KS0+
aXNfbW9iaWxlKQo+ID4gLQo+ID4gLSNkZWZpbmUgSVNfSTgzMChkZXZfcHJpdikJSVNfUExBVEZP
Uk0oZGV2X3ByaXYsIElOVEVMX0k4MzApCj4gPiAtI2RlZmluZSBJU19JODQ1RyhkZXZfcHJpdikJ
SVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0k4NDVHKQo+ID4gLSNkZWZpbmUgSVNfSTg1WChk
ZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0k4NVgpCj4gPiAtI2RlZmluZSBJ
U19JODY1RyhkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0k4NjVHKQo+ID4g
LSNkZWZpbmUgSVNfSTkxNUcoZGV2X3ByaXYpCUlTX1BMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9J
OTE1RykKPiA+IC0jZGVmaW5lIElTX0k5MTVHTShkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3By
aXYsIElOVEVMX0k5MTVHTSkKPiA+IC0jZGVmaW5lIElTX0k5NDVHKGRldl9wcml2KQlJU19QTEFU
Rk9STShkZXZfcHJpdiwgSU5URUxfSTk0NUcpCj4gPiAtI2RlZmluZSBJU19JOTQ1R00oZGV2X3By
aXYpCUlTX1BMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9JOTQ1R00pCj4gPiAtI2RlZmluZSBJU19J
OTY1RyhkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0k5NjVHKQo+ID4gLSNk
ZWZpbmUgSVNfSTk2NUdNKGRldl9wcml2KQlJU19QTEFURk9STShkZXZfcHJpdiwgSU5URUxfSTk2
NUdNKQo+ID4gLSNkZWZpbmUgSVNfRzQ1KGRldl9wcml2KQlJU19QTEFURk9STShkZXZfcHJpdiwg
SU5URUxfRzQ1KQo+ID4gLSNkZWZpbmUgSVNfR000NShkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2
X3ByaXYsIElOVEVMX0dNNDUpCj4gPiAtI2RlZmluZSBJU19HNFgoZGV2X3ByaXYpCShJU19HNDUo
ZGV2X3ByaXYpIHx8IElTX0dNNDUoZGV2X3ByaXYpKQo+ID4gLSNkZWZpbmUgSVNfUElORVZJRVco
ZGV2X3ByaXYpCUlTX1BMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9QSU5FVklFVykKPiA+IC0jZGVm
aW5lIElTX0czMyhkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0czMykKPiA+
IC0jZGVmaW5lIElTX0lST05MQUtFKGRldl9wcml2KQlJU19QTEFURk9STShkZXZfcHJpdiwgSU5U
RUxfSVJPTkxBS0UpCj4gPiAtI2RlZmluZSBJU19JUk9OTEFLRV9NKGRldl9wcml2KSBcCj4gPiAt
CShJU19QTEFURk9STShkZXZfcHJpdiwgSU5URUxfSVJPTkxBS0UpICYmIElTX01PQklMRShkZXZf
cHJpdikpCj4gPiAtI2RlZmluZSBJU19JVllCUklER0UoZGV2X3ByaXYpCUlTX1BMQVRGT1JNKGRl
dl9wcml2LCBJTlRFTF9JVllCUklER0UpCj4gPiAtI2RlZmluZSBJU19JVkJfR1QxKGRldl9wcml2
KQkoSVNfSVZZQlJJREdFKGRldl9wcml2KSAmJiBcCj4gPiAtCQkJCSBJTlRFTF9JTkZPKGRldl9w
cml2KS0+Z3QgPT0gMSkKPiA+IC0jZGVmaW5lIElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpCUlTX1BM
QVRGT1JNKGRldl9wcml2LCBJTlRFTF9WQUxMRVlWSUVXKQo+ID4gLSNkZWZpbmUgSVNfQ0hFUlJZ
VklFVyhkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0NIRVJSWVZJRVcpCj4g
PiAtI2RlZmluZSBJU19IQVNXRUxMKGRldl9wcml2KQlJU19QTEFURk9STShkZXZfcHJpdiwgSU5U
RUxfSEFTV0VMTCkKPiA+IC0jZGVmaW5lIElTX0JST0FEV0VMTChkZXZfcHJpdikJSVNfUExBVEZP
Uk0oZGV2X3ByaXYsIElOVEVMX0JST0FEV0VMTCkKPiA+IC0jZGVmaW5lIElTX1NLWUxBS0UoZGV2
X3ByaXYpCUlTX1BMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9TS1lMQUtFKQo+ID4gLSNkZWZpbmUg
SVNfQlJPWFRPTihkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0JST1hUT04p
Cj4gPiAtI2RlZmluZSBJU19LQUJZTEFLRShkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYs
IElOVEVMX0tBQllMQUtFKQo+ID4gLSNkZWZpbmUgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikJSVNf
UExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0dFTUlOSUxBS0UpCj4gPiAtI2RlZmluZSBJU19DT0ZG
RUVMQUtFKGRldl9wcml2KQlJU19QTEFURk9STShkZXZfcHJpdiwgSU5URUxfQ09GRkVFTEFLRSkK
PiA+IC0jZGVmaW5lIElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpCUlTX1BMQVRGT1JNKGRldl9wcml2
LCBJTlRFTF9DQU5OT05MQUtFKQo+ID4gLSNkZWZpbmUgSVNfSUNFTEFLRShkZXZfcHJpdikJSVNf
UExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0lDRUxBS0UpCj4gPiAtI2RlZmluZSBJU19FTEtIQVJU
TEFLRShkZXZfcHJpdikJSVNfUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0VMS0hBUlRMQUtFKQo+
ID4gLSNkZWZpbmUgSVNfSFNXX0VBUkxZX1NEVihkZXZfcHJpdikgKElTX0hBU1dFTEwoZGV2X3By
aXYpICYmIFwKPiA+IC0JCQkJICAgIChJTlRFTF9ERVZJRChkZXZfcHJpdikgJiAweEZGMDApID09
IDB4MEMwMCkKPiA+IC0jZGVmaW5lIElTX0JEV19VTFQoZGV2X3ByaXYpIFwKPiA+IC0JSVNfU1VC
UExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0JST0FEV0VMTCwgSU5URUxfU1VCUExBVEZPUk1fVUxU
KQo+ID4gLSNkZWZpbmUgSVNfQkRXX1VMWChkZXZfcHJpdikgXAo+ID4gLQlJU19TVUJQTEFURk9S
TShkZXZfcHJpdiwgSU5URUxfQlJPQURXRUxMLCBJTlRFTF9TVUJQTEFURk9STV9VTFgpCj4gPiAt
I2RlZmluZSBJU19CRFdfR1QzKGRldl9wcml2KQkoSVNfQlJPQURXRUxMKGRldl9wcml2KSAmJiBc
Cj4gPiAtCQkJCSBJTlRFTF9JTkZPKGRldl9wcml2KS0+Z3QgPT0gMykKPiA+IC0jZGVmaW5lIElT
X0hTV19VTFQoZGV2X3ByaXYpIFwKPiA+IC0JSVNfU1VCUExBVEZPUk0oZGV2X3ByaXYsIElOVEVM
X0hBU1dFTEwsIElOVEVMX1NVQlBMQVRGT1JNX1VMVCkKPiA+IC0jZGVmaW5lIElTX0hTV19HVDMo
ZGV2X3ByaXYpCShJU19IQVNXRUxMKGRldl9wcml2KSAmJiBcCj4gPiAtCQkJCSBJTlRFTF9JTkZP
KGRldl9wcml2KS0+Z3QgPT0gMykKPiA+IC0jZGVmaW5lIElTX0hTV19HVDEoZGV2X3ByaXYpCShJ
U19IQVNXRUxMKGRldl9wcml2KSAmJiBcCj4gPiAtCQkJCSBJTlRFTF9JTkZPKGRldl9wcml2KS0+
Z3QgPT0gMSkKPiA+ICsjZGVmaW5lIElTX01PQklMRShpOTE1KQkoSU5URUxfSU5GTyhpOTE1KS0+
aXNfbW9iaWxlKQo+ID4gKwo+ID4gKyNkZWZpbmUgSVNfSTgzMChpOTE1KQlJU19QTEFURk9STShp
OTE1LCBJTlRFTF9JODMwKQo+ID4gKyNkZWZpbmUgSVNfSTg0NUcoaTkxNSkJSVNfUExBVEZPUk0o
aTkxNSwgSU5URUxfSTg0NUcpCj4gPiArI2RlZmluZSBJU19JODVYKGk5MTUpCUlTX1BMQVRGT1JN
KGk5MTUsIElOVEVMX0k4NVgpCj4gPiArI2RlZmluZSBJU19JODY1RyhpOTE1KQlJU19QTEFURk9S
TShpOTE1LCBJTlRFTF9JODY1RykKPiA+ICsjZGVmaW5lIElTX0k5MTVHKGk5MTUpCUlTX1BMQVRG
T1JNKGk5MTUsIElOVEVMX0k5MTVHKQo+ID4gKyNkZWZpbmUgSVNfSTkxNUdNKGk5MTUpCUlTX1BM
QVRGT1JNKGk5MTUsIElOVEVMX0k5MTVHTSkKPiA+ICsjZGVmaW5lIElTX0k5NDVHKGk5MTUpCUlT
X1BMQVRGT1JNKGk5MTUsIElOVEVMX0k5NDVHKQo+ID4gKyNkZWZpbmUgSVNfSTk0NUdNKGk5MTUp
CUlTX1BMQVRGT1JNKGk5MTUsIElOVEVMX0k5NDVHTSkKPiA+ICsjZGVmaW5lIElTX0k5NjVHKGk5
MTUpCUlTX1BMQVRGT1JNKGk5MTUsIElOVEVMX0k5NjVHKQo+ID4gKyNkZWZpbmUgSVNfSTk2NUdN
KGk5MTUpCUlTX1BMQVRGT1JNKGk5MTUsIElOVEVMX0k5NjVHTSkKPiA+ICsjZGVmaW5lIElTX0c0
NShpOTE1KQlJU19QTEFURk9STShpOTE1LCBJTlRFTF9HNDUpCj4gPiArI2RlZmluZSBJU19HTTQ1
KGk5MTUpCUlTX1BMQVRGT1JNKGk5MTUsIElOVEVMX0dNNDUpCj4gPiArI2RlZmluZSBJU19HNFgo
aTkxNSkJKElTX0c0NShpOTE1KSB8fCBJU19HTTQ1KGk5MTUpKQo+ID4gKyNkZWZpbmUgSVNfUElO
RVZJRVcoaTkxNSkJSVNfUExBVEZPUk0oaTkxNSwgSU5URUxfUElORVZJRVcpCj4gPiArI2RlZmlu
ZSBJU19HMzMoaTkxNSkJSVNfUExBVEZPUk0oaTkxNSwgSU5URUxfRzMzKQo+ID4gKyNkZWZpbmUg
SVNfSVJPTkxBS0UoaTkxNSkJSVNfUExBVEZPUk0oaTkxNSwgSU5URUxfSVJPTkxBS0UpCj4gPiAr
I2RlZmluZSBJU19JUk9OTEFLRV9NKGk5MTUpIFwKPiA+ICsJKElTX1BMQVRGT1JNKGk5MTUsIElO
VEVMX0lST05MQUtFKSAmJiBJU19NT0JJTEUoaTkxNSkpCj4gPiArI2RlZmluZSBJU19JVllCUklE
R0UoaTkxNSkJSVNfUExBVEZPUk0oaTkxNSwgSU5URUxfSVZZQlJJREdFKQo+ID4gKyNkZWZpbmUg
SVNfSVZCX0dUMShpOTE1KQkoSVNfSVZZQlJJREdFKGk5MTUpICYmIFwKPiA+ICsJCQkJIElOVEVM
X0lORk8oaTkxNSktPmd0ID09IDEpCj4gPiArI2RlZmluZSBJU19WQUxMRVlWSUVXKGk5MTUpCUlT
X1BMQVRGT1JNKGk5MTUsIElOVEVMX1ZBTExFWVZJRVcpCj4gPiArI2RlZmluZSBJU19DSEVSUllW
SUVXKGk5MTUpCUlTX1BMQVRGT1JNKGk5MTUsIElOVEVMX0NIRVJSWVZJRVcpCj4gPiArI2RlZmlu
ZSBJU19IQVNXRUxMKGk5MTUpCUlTX1BMQVRGT1JNKGk5MTUsIElOVEVMX0hBU1dFTEwpCj4gPiAr
I2RlZmluZSBJU19CUk9BRFdFTEwoaTkxNSkJSVNfUExBVEZPUk0oaTkxNSwgSU5URUxfQlJPQURX
RUxMKQo+ID4gKyNkZWZpbmUgSVNfU0tZTEFLRShpOTE1KQlJU19QTEFURk9STShpOTE1LCBJTlRF
TF9TS1lMQUtFKQo+ID4gKyNkZWZpbmUgSVNfQlJPWFRPTihpOTE1KQlJU19QTEFURk9STShpOTE1
LCBJTlRFTF9CUk9YVE9OKQo+ID4gKyNkZWZpbmUgSVNfS0FCWUxBS0UoaTkxNSkJSVNfUExBVEZP
Uk0oaTkxNSwgSU5URUxfS0FCWUxBS0UpCj4gPiArI2RlZmluZSBJU19HRU1JTklMQUtFKGk5MTUp
CUlTX1BMQVRGT1JNKGk5MTUsIElOVEVMX0dFTUlOSUxBS0UpCj4gPiArI2RlZmluZSBJU19DT0ZG
RUVMQUtFKGk5MTUpCUlTX1BMQVRGT1JNKGk5MTUsIElOVEVMX0NPRkZFRUxBS0UpCj4gPiArI2Rl
ZmluZSBJU19DQU5OT05MQUtFKGk5MTUpCUlTX1BMQVRGT1JNKGk5MTUsIElOVEVMX0NBTk5PTkxB
S0UpCj4gPiArI2RlZmluZSBJU19JQ0VMQUtFKGk5MTUpCUlTX1BMQVRGT1JNKGk5MTUsIElOVEVM
X0lDRUxBS0UpCj4gPiArI2RlZmluZSBJU19FTEtIQVJUTEFLRShpOTE1KQlJU19QTEFURk9STShp
OTE1LCBJTlRFTF9FTEtIQVJUTEFLRSkKPiA+ICsjZGVmaW5lIElTX0hTV19FQVJMWV9TRFYoaTkx
NSkgKElTX0hBU1dFTEwoaTkxNSkgJiYgXAo+ID4gKwkJCQkgICAgKElOVEVMX0RFVklEKGk5MTUp
ICYgMHhGRjAwKSA9PSAweDBDMDApCj4gPiArI2RlZmluZSBJU19CRFdfVUxUKGk5MTUpIFwKPiA+
ICsJSVNfU1VCUExBVEZPUk0oaTkxNSwgSU5URUxfQlJPQURXRUxMLCBJTlRFTF9TVUJQTEFURk9S
TV9VTFQpCj4gPiArI2RlZmluZSBJU19CRFdfVUxYKGk5MTUpIFwKPiA+ICsJSVNfU1VCUExBVEZP
Uk0oaTkxNSwgSU5URUxfQlJPQURXRUxMLCBJTlRFTF9TVUJQTEFURk9STV9VTFgpCj4gPiArI2Rl
ZmluZSBJU19CRFdfR1QzKGk5MTUpCShJU19CUk9BRFdFTEwoaTkxNSkgJiYgXAo+ID4gKwkJCQkg
SU5URUxfSU5GTyhpOTE1KS0+Z3QgPT0gMykKPiA+ICsjZGVmaW5lIElTX0hTV19VTFQoaTkxNSkg
XAo+ID4gKwlJU19TVUJQTEFURk9STShpOTE1LCBJTlRFTF9IQVNXRUxMLCBJTlRFTF9TVUJQTEFU
Rk9STV9VTFQpCj4gPiArI2RlZmluZSBJU19IU1dfR1QzKGk5MTUpCShJU19IQVNXRUxMKGk5MTUp
ICYmIFwKPiA+ICsJCQkJIElOVEVMX0lORk8oaTkxNSktPmd0ID09IDMpCj4gPiArI2RlZmluZSBJ
U19IU1dfR1QxKGk5MTUpCShJU19IQVNXRUxMKGk5MTUpICYmIFwKPiA+ICsJCQkJIElOVEVMX0lO
Rk8oaTkxNSktPmd0ID09IDEpCj4gPiAgIC8qIFVMWCBtYWNoaW5lcyBhcmUgYWxzbyBjb25zaWRl
cmVkIFVMVC4gKi8KPiA+IC0jZGVmaW5lIElTX0hTV19VTFgoZGV2X3ByaXYpIFwKPiA+IC0JSVNf
U1VCUExBVEZPUk0oZGV2X3ByaXYsIElOVEVMX0hBU1dFTEwsIElOVEVMX1NVQlBMQVRGT1JNX1VM
WCkKPiA+IC0jZGVmaW5lIElTX1NLTF9VTFQoZGV2X3ByaXYpIFwKPiA+IC0JSVNfU1VCUExBVEZP
Uk0oZGV2X3ByaXYsIElOVEVMX1NLWUxBS0UsIElOVEVMX1NVQlBMQVRGT1JNX1VMVCkKPiA+IC0j
ZGVmaW5lIElTX1NLTF9VTFgoZGV2X3ByaXYpIFwKPiA+IC0JSVNfU1VCUExBVEZPUk0oZGV2X3By
aXYsIElOVEVMX1NLWUxBS0UsIElOVEVMX1NVQlBMQVRGT1JNX1VMWCkKPiA+IC0jZGVmaW5lIElT
X0tCTF9VTFQoZGV2X3ByaXYpIFwKPiA+IC0JSVNfU1VCUExBVEZPUk0oZGV2X3ByaXYsIElOVEVM
X0tBQllMQUtFLCBJTlRFTF9TVUJQTEFURk9STV9VTFQpCj4gPiAtI2RlZmluZSBJU19LQkxfVUxY
KGRldl9wcml2KSBcCj4gPiAtCUlTX1NVQlBMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9LQUJZTEFL
RSwgSU5URUxfU1VCUExBVEZPUk1fVUxYKQo+ID4gLSNkZWZpbmUgSVNfU0tMX0dUMihkZXZfcHJp
dikJKElTX1NLWUxBS0UoZGV2X3ByaXYpICYmIFwKPiA+IC0JCQkJIElOVEVMX0lORk8oZGV2X3By
aXYpLT5ndCA9PSAyKQo+ID4gLSNkZWZpbmUgSVNfU0tMX0dUMyhkZXZfcHJpdikJKElTX1NLWUxB
S0UoZGV2X3ByaXYpICYmIFwKPiA+IC0JCQkJIElOVEVMX0lORk8oZGV2X3ByaXYpLT5ndCA9PSAz
KQo+ID4gLSNkZWZpbmUgSVNfU0tMX0dUNChkZXZfcHJpdikJKElTX1NLWUxBS0UoZGV2X3ByaXYp
ICYmIFwKPiA+IC0JCQkJIElOVEVMX0lORk8oZGV2X3ByaXYpLT5ndCA9PSA0KQo+ID4gLSNkZWZp
bmUgSVNfS0JMX0dUMihkZXZfcHJpdikJKElTX0tBQllMQUtFKGRldl9wcml2KSAmJiBcCj4gPiAt
CQkJCSBJTlRFTF9JTkZPKGRldl9wcml2KS0+Z3QgPT0gMikKPiA+IC0jZGVmaW5lIElTX0tCTF9H
VDMoZGV2X3ByaXYpCShJU19LQUJZTEFLRShkZXZfcHJpdikgJiYgXAo+ID4gLQkJCQkgSU5URUxf
SU5GTyhkZXZfcHJpdiktPmd0ID09IDMpCj4gPiAtI2RlZmluZSBJU19DRkxfVUxUKGRldl9wcml2
KSBcCj4gPiAtCUlTX1NVQlBMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9DT0ZGRUVMQUtFLCBJTlRF
TF9TVUJQTEFURk9STV9VTFQpCj4gPiAtI2RlZmluZSBJU19DRkxfVUxYKGRldl9wcml2KSBcCj4g
PiAtCUlTX1NVQlBMQVRGT1JNKGRldl9wcml2LCBJTlRFTF9DT0ZGRUVMQUtFLCBJTlRFTF9TVUJQ
TEFURk9STV9VTFgpCj4gPiAtI2RlZmluZSBJU19DRkxfR1QyKGRldl9wcml2KQkoSVNfQ09GRkVF
TEFLRShkZXZfcHJpdikgJiYgXAo+ID4gLQkJCQkgSU5URUxfSU5GTyhkZXZfcHJpdiktPmd0ID09
IDIpCj4gPiAtI2RlZmluZSBJU19DRkxfR1QzKGRldl9wcml2KQkoSVNfQ09GRkVFTEFLRShkZXZf
cHJpdikgJiYgXAo+ID4gLQkJCQkgSU5URUxfSU5GTyhkZXZfcHJpdiktPmd0ID09IDMpCj4gPiAt
I2RlZmluZSBJU19DTkxfV0lUSF9QT1JUX0YoZGV2X3ByaXYpIFwKPiA+IC0JSVNfU1VCUExBVEZP
Uk0oZGV2X3ByaXYsIElOVEVMX0NBTk5PTkxBS0UsIElOVEVMX1NVQlBMQVRGT1JNX1BPUlRGKQo+
ID4gLSNkZWZpbmUgSVNfSUNMX1dJVEhfUE9SVF9GKGRldl9wcml2KSBcCj4gPiAtCUlTX1NVQlBM
QVRGT1JNKGRldl9wcml2LCBJTlRFTF9JQ0VMQUtFLCBJTlRFTF9TVUJQTEFURk9STV9QT1JURikK
PiA+ICsjZGVmaW5lIElTX0hTV19VTFgoaTkxNSkgXAo+ID4gKwlJU19TVUJQTEFURk9STShpOTE1
LCBJTlRFTF9IQVNXRUxMLCBJTlRFTF9TVUJQTEFURk9STV9VTFgpCj4gPiArI2RlZmluZSBJU19T
S0xfVUxUKGk5MTUpIFwKPiA+ICsJSVNfU1VCUExBVEZPUk0oaTkxNSwgSU5URUxfU0tZTEFLRSwg
SU5URUxfU1VCUExBVEZPUk1fVUxUKQo+ID4gKyNkZWZpbmUgSVNfU0tMX1VMWChpOTE1KSBcCj4g
PiArCUlTX1NVQlBMQVRGT1JNKGk5MTUsIElOVEVMX1NLWUxBS0UsIElOVEVMX1NVQlBMQVRGT1JN
X1VMWCkKPiA+ICsjZGVmaW5lIElTX0tCTF9VTFQoaTkxNSkgXAo+ID4gKwlJU19TVUJQTEFURk9S
TShpOTE1LCBJTlRFTF9LQUJZTEFLRSwgSU5URUxfU1VCUExBVEZPUk1fVUxUKQo+ID4gKyNkZWZp
bmUgSVNfS0JMX1VMWChpOTE1KSBcCj4gPiArCUlTX1NVQlBMQVRGT1JNKGk5MTUsIElOVEVMX0tB
QllMQUtFLCBJTlRFTF9TVUJQTEFURk9STV9VTFgpCj4gPiArI2RlZmluZSBJU19TS0xfR1QyKGk5
MTUpCShJU19TS1lMQUtFKGk5MTUpICYmIFwKPiA+ICsJCQkJIElOVEVMX0lORk8oaTkxNSktPmd0
ID09IDIpCj4gPiArI2RlZmluZSBJU19TS0xfR1QzKGk5MTUpCShJU19TS1lMQUtFKGk5MTUpICYm
IFwKPiA+ICsJCQkJIElOVEVMX0lORk8oaTkxNSktPmd0ID09IDMpCj4gPiArI2RlZmluZSBJU19T
S0xfR1Q0KGk5MTUpCShJU19TS1lMQUtFKGk5MTUpICYmIFwKPiA+ICsJCQkJIElOVEVMX0lORk8o
aTkxNSktPmd0ID09IDQpCj4gPiArI2RlZmluZSBJU19LQkxfR1QyKGk5MTUpCShJU19LQUJZTEFL
RShpOTE1KSAmJiBcCj4gPiArCQkJCSBJTlRFTF9JTkZPKGk5MTUpLT5ndCA9PSAyKQo+ID4gKyNk
ZWZpbmUgSVNfS0JMX0dUMyhpOTE1KQkoSVNfS0FCWUxBS0UoaTkxNSkgJiYgXAo+ID4gKwkJCQkg
SU5URUxfSU5GTyhpOTE1KS0+Z3QgPT0gMykKPiA+ICsjZGVmaW5lIElTX0NGTF9VTFQoaTkxNSkg
XAo+ID4gKwlJU19TVUJQTEFURk9STShpOTE1LCBJTlRFTF9DT0ZGRUVMQUtFLCBJTlRFTF9TVUJQ
TEFURk9STV9VTFQpCj4gPiArI2RlZmluZSBJU19DRkxfVUxYKGk5MTUpIFwKPiA+ICsJSVNfU1VC
UExBVEZPUk0oaTkxNSwgSU5URUxfQ09GRkVFTEFLRSwgSU5URUxfU1VCUExBVEZPUk1fVUxYKQo+
ID4gKyNkZWZpbmUgSVNfQ0ZMX0dUMihpOTE1KQkoSVNfQ09GRkVFTEFLRShpOTE1KSAmJiBcCj4g
PiArCQkJCSBJTlRFTF9JTkZPKGk5MTUpLT5ndCA9PSAyKQo+ID4gKyNkZWZpbmUgSVNfQ0ZMX0dU
MyhpOTE1KQkoSVNfQ09GRkVFTEFLRShpOTE1KSAmJiBcCj4gPiArCQkJCSBJTlRFTF9JTkZPKGk5
MTUpLT5ndCA9PSAzKQo+ID4gKyNkZWZpbmUgSVNfQ05MX1dJVEhfUE9SVF9GKGk5MTUpIFwKPiA+
ICsJSVNfU1VCUExBVEZPUk0oaTkxNSwgSU5URUxfQ0FOTk9OTEFLRSwgSU5URUxfU1VCUExBVEZP
Uk1fUE9SVEYpCj4gPiArI2RlZmluZSBJU19JQ0xfV0lUSF9QT1JUX0YoaTkxNSkgXAo+ID4gKwlJ
U19TVUJQTEFURk9STShpOTE1LCBJTlRFTF9JQ0VMQUtFLCBJTlRFTF9TVUJQTEFURk9STV9QT1JU
RikKPiA+ICAgI2RlZmluZSBTS0xfUkVWSURfQTAJCTB4MAo+ID4gICAjZGVmaW5lIFNLTF9SRVZJ
RF9CMAkJMHgxCj4gPiBAQCAtMjI1OSw4ICsyMjU5LDggQEAgSVNfU1VCUExBVEZPUk0oY29uc3Qg
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgICNkZWZpbmUgQlhUX1JFVklEX0Jf
TEFTVAkweDgKPiA+ICAgI2RlZmluZSBCWFRfUkVWSURfQzAJCTB4OQo+ID4gLSNkZWZpbmUgSVNf
QlhUX1JFVklEKGRldl9wcml2LCBzaW5jZSwgdW50aWwpIFwKPiA+IC0JKElTX0JST1hUT04oZGV2
X3ByaXYpICYmIElTX1JFVklEKGRldl9wcml2LCBzaW5jZSwgdW50aWwpKQo+ID4gKyNkZWZpbmUg
SVNfQlhUX1JFVklEKGk5MTUsIHNpbmNlLCB1bnRpbCkgXAo+ID4gKwkoSVNfQlJPWFRPTihpOTE1
KSAmJiBJU19SRVZJRChpOTE1LCBzaW5jZSwgdW50aWwpKQo+ID4gICAjZGVmaW5lIEtCTF9SRVZJ
RF9BMAkJMHgwCj4gPiAgICNkZWZpbmUgS0JMX1JFVklEX0IwCQkweDEKPiA+IEBAIC0yMjY4LDE0
ICsyMjY4LDE0IEBAIElTX1NVQlBMQVRGT1JNKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ID4gICAjZGVmaW5lIEtCTF9SRVZJRF9EMAkJMHgzCj4gPiAgICNkZWZpbmUgS0JM
X1JFVklEX0UwCQkweDQKPiA+IC0jZGVmaW5lIElTX0tCTF9SRVZJRChkZXZfcHJpdiwgc2luY2Us
IHVudGlsKSBcCj4gPiAtCShJU19LQUJZTEFLRShkZXZfcHJpdikgJiYgSVNfUkVWSUQoZGV2X3By
aXYsIHNpbmNlLCB1bnRpbCkpCj4gPiArI2RlZmluZSBJU19LQkxfUkVWSUQoaTkxNSwgc2luY2Us
IHVudGlsKSBcCj4gPiArCShJU19LQUJZTEFLRShpOTE1KSAmJiBJU19SRVZJRChpOTE1LCBzaW5j
ZSwgdW50aWwpKQo+ID4gICAjZGVmaW5lIEdMS19SRVZJRF9BMAkJMHgwCj4gPiAgICNkZWZpbmUg
R0xLX1JFVklEX0ExCQkweDEKPiA+IC0jZGVmaW5lIElTX0dMS19SRVZJRChkZXZfcHJpdiwgc2lu
Y2UsIHVudGlsKSBcCj4gPiAtCShJU19HRU1JTklMQUtFKGRldl9wcml2KSAmJiBJU19SRVZJRChk
ZXZfcHJpdiwgc2luY2UsIHVudGlsKSkKPiA+ICsjZGVmaW5lIElTX0dMS19SRVZJRChpOTE1LCBz
aW5jZSwgdW50aWwpIFwKPiA+ICsJKElTX0dFTUlOSUxBS0UoaTkxNSkgJiYgSVNfUkVWSUQoaTkx
NSwgc2luY2UsIHVudGlsKSkKPiA+ICAgI2RlZmluZSBDTkxfUkVWSURfQTAJCTB4MAo+ID4gICAj
ZGVmaW5lIENOTF9SRVZJRF9CMAkJMHgxCj4gPiBAQCAtMjI5MywxMjIgKzIyOTMsMTIyIEBAIElT
X1NVQlBMQVRGT1JNKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAj
ZGVmaW5lIElTX0lDTF9SRVZJRChwLCBzaW5jZSwgdW50aWwpIFwKPiA+ICAgCShJU19JQ0VMQUtF
KHApICYmIElTX1JFVklEKHAsIHNpbmNlLCB1bnRpbCkpCj4gPiAtI2RlZmluZSBJU19MUChkZXZf
cHJpdikJKElOVEVMX0lORk8oZGV2X3ByaXYpLT5pc19scCkKPiA+IC0jZGVmaW5lIElTX0dFTjlf
TFAoZGV2X3ByaXYpCShJU19HRU4oZGV2X3ByaXYsIDkpICYmIElTX0xQKGRldl9wcml2KSkKPiA+
IC0jZGVmaW5lIElTX0dFTjlfQkMoZGV2X3ByaXYpCShJU19HRU4oZGV2X3ByaXYsIDkpICYmICFJ
U19MUChkZXZfcHJpdikpCj4gPiArI2RlZmluZSBJU19MUChpOTE1KQkoSU5URUxfSU5GTyhpOTE1
KS0+aXNfbHApCj4gPiArI2RlZmluZSBJU19HRU45X0xQKGk5MTUpCShJU19HRU4oaTkxNSwgOSkg
JiYgSVNfTFAoaTkxNSkpCj4gPiArI2RlZmluZSBJU19HRU45X0JDKGk5MTUpCShJU19HRU4oaTkx
NSwgOSkgJiYgIUlTX0xQKGk5MTUpKQo+ID4gLSNkZWZpbmUgSEFTX0VOR0lORShkZXZfcHJpdiwg
aWQpIChJTlRFTF9JTkZPKGRldl9wcml2KS0+ZW5naW5lX21hc2sgJiBCSVQoaWQpKQo+ID4gKyNk
ZWZpbmUgSEFTX0VOR0lORShpOTE1LCBpZCkgKElOVEVMX0lORk8oaTkxNSktPmVuZ2luZV9tYXNr
ICYgQklUKGlkKSkKPiA+IC0jZGVmaW5lIEVOR0lORV9JTlNUQU5DRVNfTUFTSyhkZXZfcHJpdiwg
Zmlyc3QsIGNvdW50KSAoewkJXAo+ID4gKyNkZWZpbmUgRU5HSU5FX0lOU1RBTkNFU19NQVNLKGk5
MTUsIGZpcnN0LCBjb3VudCkgKHsJCVwKPiA+ICAgCXVuc2lnbmVkIGludCBmaXJzdF9fID0gKGZp
cnN0KTsJCQkJCVwKPiA+ICAgCXVuc2lnbmVkIGludCBjb3VudF9fID0gKGNvdW50KTsJCQkJCVwK
PiA+IC0JKElOVEVMX0lORk8oZGV2X3ByaXYpLT5lbmdpbmVfbWFzayAmCQkJCVwKPiA+ICsJKElO
VEVMX0lORk8oaTkxNSktPmVuZ2luZV9tYXNrICYJCQkJXAo+ID4gICAJIEdFTk1BU0soZmlyc3Rf
XyArIGNvdW50X18gLSAxLCBmaXJzdF9fKSkgPj4gZmlyc3RfXzsJCVwKPiA+ICAgfSkKPiA+IC0j
ZGVmaW5lIFZEQk9YX01BU0soZGV2X3ByaXYpIFwKPiA+IC0JRU5HSU5FX0lOU1RBTkNFU19NQVNL
KGRldl9wcml2LCBWQ1MwLCBJOTE1X01BWF9WQ1MpCj4gPiAtI2RlZmluZSBWRUJPWF9NQVNLKGRl
dl9wcml2KSBcCj4gPiAtCUVOR0lORV9JTlNUQU5DRVNfTUFTSyhkZXZfcHJpdiwgVkVDUzAsIEk5
MTVfTUFYX1ZFQ1MpCj4gPiAtCj4gPiAtI2RlZmluZSBIQVNfTExDKGRldl9wcml2KQkoSU5URUxf
SU5GTyhkZXZfcHJpdiktPmhhc19sbGMpCj4gPiAtI2RlZmluZSBIQVNfU05PT1AoZGV2X3ByaXYp
CShJTlRFTF9JTkZPKGRldl9wcml2KS0+aGFzX3Nub29wKQo+ID4gLSNkZWZpbmUgSEFTX0VEUkFN
KGRldl9wcml2KQkoKGRldl9wcml2KS0+ZWRyYW1fc2l6ZV9tYikKPiA+IC0jZGVmaW5lIEhBU19X
VChkZXZfcHJpdikJKChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBcCj4gPiAtCQkJCSBJU19CUk9B
RFdFTEwoZGV2X3ByaXYpKSAmJiBIQVNfRURSQU0oZGV2X3ByaXYpKQo+ID4gLQo+ID4gLSNkZWZp
bmUgSFdTX05FRURTX1BIWVNJQ0FMKGRldl9wcml2KQkoSU5URUxfSU5GTyhkZXZfcHJpdiktPmh3
c19uZWVkc19waHlzaWNhbCkKPiA+IC0KPiA+IC0jZGVmaW5lIEhBU19MT0dJQ0FMX1JJTkdfQ09O
VEVYVFMoZGV2X3ByaXYpIFwKPiA+IC0JCShJTlRFTF9JTkZPKGRldl9wcml2KS0+aGFzX2xvZ2lj
YWxfcmluZ19jb250ZXh0cykKPiA+IC0jZGVmaW5lIEhBU19MT0dJQ0FMX1JJTkdfRUxTUShkZXZf
cHJpdikgXAo+ID4gLQkJKElOVEVMX0lORk8oZGV2X3ByaXYpLT5oYXNfbG9naWNhbF9yaW5nX2Vs
c3EpCj4gPiAtI2RlZmluZSBIQVNfTE9HSUNBTF9SSU5HX1BSRUVNUFRJT04oZGV2X3ByaXYpIFwK
PiA+IC0JCShJTlRFTF9JTkZPKGRldl9wcml2KS0+aGFzX2xvZ2ljYWxfcmluZ19wcmVlbXB0aW9u
KQo+ID4gLQo+ID4gLSNkZWZpbmUgSEFTX0VYRUNMSVNUUyhkZXZfcHJpdikgSEFTX0xPR0lDQUxf
UklOR19DT05URVhUUyhkZXZfcHJpdikKPiA+IC0KPiA+IC0jZGVmaW5lIElOVEVMX1BQR1RUKGRl
dl9wcml2KSAoSU5URUxfSU5GTyhkZXZfcHJpdiktPnBwZ3R0X3R5cGUpCj4gPiAtI2RlZmluZSBI
QVNfUFBHVFQoZGV2X3ByaXYpIFwKPiA+IC0JKElOVEVMX1BQR1RUKGRldl9wcml2KSAhPSBJTlRF
TF9QUEdUVF9OT05FKQo+ID4gLSNkZWZpbmUgSEFTX0ZVTExfUFBHVFQoZGV2X3ByaXYpIFwKPiA+
IC0JKElOVEVMX1BQR1RUKGRldl9wcml2KSA+PSBJTlRFTF9QUEdUVF9GVUxMKQo+ID4gLQo+ID4g
LSNkZWZpbmUgSEFTX1BBR0VfU0laRVMoZGV2X3ByaXYsIHNpemVzKSAoeyBcCj4gPiArI2RlZmlu
ZSBWREJPWF9NQVNLKGk5MTUpIFwKPiA+ICsJRU5HSU5FX0lOU1RBTkNFU19NQVNLKGk5MTUsIFZD
UzAsIEk5MTVfTUFYX1ZDUykKPiA+ICsjZGVmaW5lIFZFQk9YX01BU0soaTkxNSkgXAo+ID4gKwlF
TkdJTkVfSU5TVEFOQ0VTX01BU0soaTkxNSwgVkVDUzAsIEk5MTVfTUFYX1ZFQ1MpCj4gPiArCj4g
PiArI2RlZmluZSBIQVNfTExDKGk5MTUpCShJTlRFTF9JTkZPKGk5MTUpLT5oYXNfbGxjKQo+ID4g
KyNkZWZpbmUgSEFTX1NOT09QKGk5MTUpCShJTlRFTF9JTkZPKGk5MTUpLT5oYXNfc25vb3ApCj4g
PiArI2RlZmluZSBIQVNfRURSQU0oaTkxNSkJKChpOTE1KS0+ZWRyYW1fc2l6ZV9tYikKPiA+ICsj
ZGVmaW5lIEhBU19XVChpOTE1KQkoKElTX0hBU1dFTEwoaTkxNSkgfHwgXAo+ID4gKwkJCQkgSVNf
QlJPQURXRUxMKGk5MTUpKSAmJiBIQVNfRURSQU0oaTkxNSkpCj4gPiArCj4gPiArI2RlZmluZSBI
V1NfTkVFRFNfUEhZU0lDQUwoaTkxNSkJKElOVEVMX0lORk8oaTkxNSktPmh3c19uZWVkc19waHlz
aWNhbCkKPiA+ICsKPiA+ICsjZGVmaW5lIEhBU19MT0dJQ0FMX1JJTkdfQ09OVEVYVFMoaTkxNSkg
XAo+ID4gKwkJKElOVEVMX0lORk8oaTkxNSktPmhhc19sb2dpY2FsX3JpbmdfY29udGV4dHMpCj4g
PiArI2RlZmluZSBIQVNfTE9HSUNBTF9SSU5HX0VMU1EoaTkxNSkgXAo+ID4gKwkJKElOVEVMX0lO
Rk8oaTkxNSktPmhhc19sb2dpY2FsX3JpbmdfZWxzcSkKPiA+ICsjZGVmaW5lIEhBU19MT0dJQ0FM
X1JJTkdfUFJFRU1QVElPTihpOTE1KSBcCj4gPiArCQkoSU5URUxfSU5GTyhpOTE1KS0+aGFzX2xv
Z2ljYWxfcmluZ19wcmVlbXB0aW9uKQo+ID4gKwo+ID4gKyNkZWZpbmUgSEFTX0VYRUNMSVNUUyhp
OTE1KSBIQVNfTE9HSUNBTF9SSU5HX0NPTlRFWFRTKGk5MTUpCj4gPiArCj4gPiArI2RlZmluZSBJ
TlRFTF9QUEdUVChpOTE1KSAoSU5URUxfSU5GTyhpOTE1KS0+cHBndHRfdHlwZSkKPiA+ICsjZGVm
aW5lIEhBU19QUEdUVChpOTE1KSBcCj4gPiArCShJTlRFTF9QUEdUVChpOTE1KSAhPSBJTlRFTF9Q
UEdUVF9OT05FKQo+ID4gKyNkZWZpbmUgSEFTX0ZVTExfUFBHVFQoaTkxNSkgXAo+ID4gKwkoSU5U
RUxfUFBHVFQoaTkxNSkgPj0gSU5URUxfUFBHVFRfRlVMTCkKPiA+ICsKPiA+ICsjZGVmaW5lIEhB
U19QQUdFX1NJWkVTKGk5MTUsIHNpemVzKSAoeyBcCj4gPiAgIAlHRU1fQlVHX09OKChzaXplcykg
PT0gMCk7IFwKPiA+IC0JKChzaXplcykgJiB+SU5URUxfSU5GTyhkZXZfcHJpdiktPnBhZ2Vfc2l6
ZXMpID09IDA7IFwKPiA+ICsJKChzaXplcykgJiB+SU5URUxfSU5GTyhpOTE1KS0+cGFnZV9zaXpl
cykgPT0gMDsgXAo+ID4gICB9KQo+ID4gLSNkZWZpbmUgSEFTX09WRVJMQVkoZGV2X3ByaXYpCQkg
KElOVEVMX0lORk8oZGV2X3ByaXYpLT5kaXNwbGF5Lmhhc19vdmVybGF5KQo+ID4gLSNkZWZpbmUg
T1ZFUkxBWV9ORUVEU19QSFlTSUNBTChkZXZfcHJpdikgXAo+ID4gLQkJKElOVEVMX0lORk8oZGV2
X3ByaXYpLT5kaXNwbGF5Lm92ZXJsYXlfbmVlZHNfcGh5c2ljYWwpCj4gPiArI2RlZmluZSBIQVNf
T1ZFUkxBWShpOTE1KQkJIChJTlRFTF9JTkZPKGk5MTUpLT5kaXNwbGF5Lmhhc19vdmVybGF5KQo+
ID4gKyNkZWZpbmUgT1ZFUkxBWV9ORUVEU19QSFlTSUNBTChpOTE1KSBcCj4gPiArCQkoSU5URUxf
SU5GTyhpOTE1KS0+ZGlzcGxheS5vdmVybGF5X25lZWRzX3BoeXNpY2FsKQo+ID4gICAvKiBFYXJs
eSBnZW4yIGhhdmUgYSB0b3RhbGx5IGJ1c3RlZCBDUyB0bGIgYW5kIHJlcXVpcmUgcGlubmVkIGJh
dGNoZXMuICovCj4gPiAtI2RlZmluZSBIQVNfQlJPS0VOX0NTX1RMQihkZXZfcHJpdikJKElTX0k4
MzAoZGV2X3ByaXYpIHx8IElTX0k4NDVHKGRldl9wcml2KSkKPiA+ICsjZGVmaW5lIEhBU19CUk9L
RU5fQ1NfVExCKGk5MTUpCShJU19JODMwKGk5MTUpIHx8IElTX0k4NDVHKGk5MTUpKQo+ID4gICAv
KiBXYVJzRGlzYWJsZUNvYXJzZVBvd2VyR2F0aW5nOnNrbCxjbmwgKi8KPiA+IC0jZGVmaW5lIE5F
RURTX1dhUnNEaXNhYmxlQ29hcnNlUG93ZXJHYXRpbmcoZGV2X3ByaXYpIFwKPiA+IC0JKElTX0NB
Tk5PTkxBS0UoZGV2X3ByaXYpIHx8IFwKPiA+IC0JIElTX1NLTF9HVDMoZGV2X3ByaXYpIHx8IElT
X1NLTF9HVDQoZGV2X3ByaXYpKQo+ID4gKyNkZWZpbmUgTkVFRFNfV2FSc0Rpc2FibGVDb2Fyc2VQ
b3dlckdhdGluZyhpOTE1KSBcCj4gPiArCShJU19DQU5OT05MQUtFKGk5MTUpIHx8IFwKPiA+ICsJ
IElTX1NLTF9HVDMoaTkxNSkgfHwgSVNfU0tMX0dUNChpOTE1KSkKPiA+IC0jZGVmaW5lIEhBU19H
TUJVU19JUlEoZGV2X3ByaXYpIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpCj4gPiAtI2RlZmlu
ZSBIQVNfR01CVVNfQlVSU1RfUkVBRChkZXZfcHJpdikgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
MTAgfHwgXAo+ID4gLQkJCQkJSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgXAo+ID4gLQkJCQkJ
SVNfS0FCWUxBS0UoZGV2X3ByaXYpKQo+ID4gKyNkZWZpbmUgSEFTX0dNQlVTX0lSUShpOTE1KSAo
SU5URUxfR0VOKGk5MTUpID49IDQpCj4gPiArI2RlZmluZSBIQVNfR01CVVNfQlVSU1RfUkVBRChp
OTE1KSAoSU5URUxfR0VOKGk5MTUpID49IDEwIHx8IFwKPiA+ICsJCQkJCUlTX0dFTUlOSUxBS0Uo
aTkxNSkgfHwgXAo+ID4gKwkJCQkJSVNfS0FCWUxBS0UoaTkxNSkpCj4gPiAgIC8qIFdpdGggdGhl
IDk0NSBhbmQgbGF0ZXIsIFkgdGlsaW5nIGdvdCBhZGp1c3RlZCBzbyB0aGF0IGl0IHdhcyAzMiAx
MjgtYnl0ZQo+ID4gICAgKiByb3dzLCB3aGljaCBjaGFuZ2VkIHRoZSBhbGlnbm1lbnQgcmVxdWly
ZW1lbnRzIGFuZCBmZW5jZSBwcm9ncmFtbWluZy4KPiA+ICAgICovCj4gPiAtI2RlZmluZSBIQVNf
MTI4X0JZVEVfWV9USUxJTkcoZGV2X3ByaXYpICghSVNfR0VOKGRldl9wcml2LCAyKSAmJiBcCj4g
PiAtCQkJCQkgIShJU19JOTE1RyhkZXZfcHJpdikgfHwgXAo+ID4gLQkJCQkJIElTX0k5MTVHTShk
ZXZfcHJpdikpKQo+ID4gLSNkZWZpbmUgU1VQUE9SVFNfVFYoZGV2X3ByaXYpCQkoSU5URUxfSU5G
TyhkZXZfcHJpdiktPmRpc3BsYXkuc3VwcG9ydHNfdHYpCj4gPiAtI2RlZmluZSBJOTE1X0hBU19I
T1RQTFVHKGRldl9wcml2KQkoSU5URUxfSU5GTyhkZXZfcHJpdiktPmRpc3BsYXkuaGFzX2hvdHBs
dWcpCj4gPiArI2RlZmluZSBIQVNfMTI4X0JZVEVfWV9USUxJTkcoaTkxNSkgKCFJU19HRU4oaTkx
NSwgMikgJiYgXAo+ID4gKwkJCQkJICEoSVNfSTkxNUcoaTkxNSkgfHwgXAo+ID4gKwkJCQkJIElT
X0k5MTVHTShpOTE1KSkpCj4gPiArI2RlZmluZSBTVVBQT1JUU19UVihpOTE1KQkJKElOVEVMX0lO
Rk8oaTkxNSktPmRpc3BsYXkuc3VwcG9ydHNfdHYpCj4gPiArI2RlZmluZSBJOTE1X0hBU19IT1RQ
TFVHKGk5MTUpCShJTlRFTF9JTkZPKGk5MTUpLT5kaXNwbGF5Lmhhc19ob3RwbHVnKQo+ID4gLSNk
ZWZpbmUgSEFTX0ZXX0JMQyhkZXZfcHJpdikgCShJTlRFTF9HRU4oZGV2X3ByaXYpID4gMikKPiA+
IC0jZGVmaW5lIEhBU19GQkMoZGV2X3ByaXYpCShJTlRFTF9JTkZPKGRldl9wcml2KS0+ZGlzcGxh
eS5oYXNfZmJjKQo+ID4gLSNkZWZpbmUgSEFTX0NVUl9GQkMoZGV2X3ByaXYpCSghSEFTX0dNQ0go
ZGV2X3ByaXYpICYmIElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykKPiA+ICsjZGVmaW5lIEhBU19G
V19CTEMoaTkxNSkgCShJTlRFTF9HRU4oaTkxNSkgPiAyKQo+ID4gKyNkZWZpbmUgSEFTX0ZCQyhp
OTE1KQkoSU5URUxfSU5GTyhpOTE1KS0+ZGlzcGxheS5oYXNfZmJjKQo+ID4gKyNkZWZpbmUgSEFT
X0NVUl9GQkMoaTkxNSkJKCFIQVNfR01DSChpOTE1KSAmJiBJTlRFTF9HRU4oaTkxNSkgPj0gNykK
PiA+IC0jZGVmaW5lIEhBU19JUFMoZGV2X3ByaXYpCShJU19IU1dfVUxUKGRldl9wcml2KSB8fCBJ
U19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ID4gKyNkZWZpbmUgSEFTX0lQUyhpOTE1KQkoSVNfSFNX
X1VMVChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gPiAtI2RlZmluZSBIQVNfRFBfTVNU
KGRldl9wcml2KQkoSU5URUxfSU5GTyhkZXZfcHJpdiktPmRpc3BsYXkuaGFzX2RwX21zdCkKPiA+
ICsjZGVmaW5lIEhBU19EUF9NU1QoaTkxNSkJKElOVEVMX0lORk8oaTkxNSktPmRpc3BsYXkuaGFz
X2RwX21zdCkKPiA+IC0jZGVmaW5lIEhBU19EREkoZGV2X3ByaXYpCQkgKElOVEVMX0lORk8oZGV2
X3ByaXYpLT5kaXNwbGF5Lmhhc19kZGkpCj4gPiAtI2RlZmluZSBIQVNfRlBHQV9EQkdfVU5DTEFJ
TUVEKGRldl9wcml2KSAoSU5URUxfSU5GTyhkZXZfcHJpdiktPmhhc19mcGdhX2RiZykKPiA+IC0j
ZGVmaW5lIEhBU19QU1IoZGV2X3ByaXYpCQkgKElOVEVMX0lORk8oZGV2X3ByaXYpLT5kaXNwbGF5
Lmhhc19wc3IpCj4gPiAtI2RlZmluZSBIQVNfVFJBTlNDT0RFUl9FRFAoZGV2X3ByaXYpCSAoSU5U
RUxfSU5GTyhkZXZfcHJpdiktPnRyYW5zX29mZnNldHNbVFJBTlNDT0RFUl9FRFBdICE9IDApCj4g
PiArI2RlZmluZSBIQVNfRERJKGk5MTUpCQkgKElOVEVMX0lORk8oaTkxNSktPmRpc3BsYXkuaGFz
X2RkaSkKPiA+ICsjZGVmaW5lIEhBU19GUEdBX0RCR19VTkNMQUlNRUQoaTkxNSkgKElOVEVMX0lO
Rk8oaTkxNSktPmhhc19mcGdhX2RiZykKPiA+ICsjZGVmaW5lIEhBU19QU1IoaTkxNSkJCSAoSU5U
RUxfSU5GTyhpOTE1KS0+ZGlzcGxheS5oYXNfcHNyKQo+ID4gKyNkZWZpbmUgSEFTX1RSQU5TQ09E
RVJfRURQKGk5MTUpCSAoSU5URUxfSU5GTyhpOTE1KS0+dHJhbnNfb2Zmc2V0c1tUUkFOU0NPREVS
X0VEUF0gIT0gMCkKPiA+IC0jZGVmaW5lIEhBU19SQzYoZGV2X3ByaXYpCQkgKElOVEVMX0lORk8o
ZGV2X3ByaXYpLT5oYXNfcmM2KQo+ID4gLSNkZWZpbmUgSEFTX1JDNnAoZGV2X3ByaXYpCQkgKElO
VEVMX0lORk8oZGV2X3ByaXYpLT5oYXNfcmM2cCkKPiA+IC0jZGVmaW5lIEhBU19SQzZwcChkZXZf
cHJpdikJCSAoZmFsc2UpIC8qIEhXIHdhcyBuZXZlciB2YWxpZGF0ZWQgKi8KPiA+ICsjZGVmaW5l
IEhBU19SQzYoaTkxNSkJCSAoSU5URUxfSU5GTyhpOTE1KS0+aGFzX3JjNikKPiA+ICsjZGVmaW5l
IEhBU19SQzZwKGk5MTUpCQkgKElOVEVMX0lORk8oaTkxNSktPmhhc19yYzZwKQo+ID4gKyNkZWZp
bmUgSEFTX1JDNnBwKGk5MTUpCQkgKGZhbHNlKSAvKiBIVyB3YXMgbmV2ZXIgdmFsaWRhdGVkICov
Cj4gPiAtI2RlZmluZSBIQVNfUlBTKGRldl9wcml2KQkoSU5URUxfSU5GTyhkZXZfcHJpdiktPmhh
c19ycHMpCj4gPiArI2RlZmluZSBIQVNfUlBTKGk5MTUpCShJTlRFTF9JTkZPKGk5MTUpLT5oYXNf
cnBzKQo+ID4gLSNkZWZpbmUgSEFTX0NTUihkZXZfcHJpdikJKElOVEVMX0lORk8oZGV2X3ByaXYp
LT5kaXNwbGF5Lmhhc19jc3IpCj4gPiArI2RlZmluZSBIQVNfQ1NSKGk5MTUpCShJTlRFTF9JTkZP
KGk5MTUpLT5kaXNwbGF5Lmhhc19jc3IpCj4gPiAtI2RlZmluZSBIQVNfUlVOVElNRV9QTShkZXZf
cHJpdikgKElOVEVMX0lORk8oZGV2X3ByaXYpLT5oYXNfcnVudGltZV9wbSkKPiA+IC0jZGVmaW5l
IEhBU182NEJJVF9SRUxPQyhkZXZfcHJpdikgKElOVEVMX0lORk8oZGV2X3ByaXYpLT5oYXNfNjRi
aXRfcmVsb2MpCj4gPiArI2RlZmluZSBIQVNfUlVOVElNRV9QTShpOTE1KSAoSU5URUxfSU5GTyhp
OTE1KS0+aGFzX3J1bnRpbWVfcG0pCj4gPiArI2RlZmluZSBIQVNfNjRCSVRfUkVMT0MoaTkxNSkg
KElOVEVMX0lORk8oaTkxNSktPmhhc182NGJpdF9yZWxvYykKPiA+IC0jZGVmaW5lIEhBU19JUEMo
ZGV2X3ByaXYpCQkgKElOVEVMX0lORk8oZGV2X3ByaXYpLT5kaXNwbGF5Lmhhc19pcGMpCj4gPiAr
I2RlZmluZSBIQVNfSVBDKGk5MTUpCQkgKElOVEVMX0lORk8oaTkxNSktPmRpc3BsYXkuaGFzX2lw
YykKPiA+ICAgLyoKPiA+ICAgICogRm9yIG5vdywgYW55dGhpbmcgd2l0aCBhIEd1QyByZXF1aXJl
cyB1Q29kZSBsb2FkaW5nLCBhbmQgdGhlbiBzdXBwb3J0cwo+ID4gICAgKiBjb21tYW5kIHN1Ym1p
c3Npb24gb25jZSBsb2FkZWQuIEJ1dCB0aGVzZSBhcmUgbG9naWNhbGx5IGluZGVwZW5kZW50Cj4g
PiAgICAqIHByb3BlcnRpZXMsIHNvIHdlIGhhdmUgc2VwYXJhdGUgbWFjcm9zIHRvIHRlc3QgdGhl
bS4KPiA+ICAgICovCj4gPiAtI2RlZmluZSBIQVNfR1VDKGRldl9wcml2KQkoSU5URUxfSU5GTyhk
ZXZfcHJpdiktPmhhc19ndWMpCj4gPiAtI2RlZmluZSBIQVNfR1VDX1VDT0RFKGRldl9wcml2KQko
SEFTX0dVQyhkZXZfcHJpdikpCj4gPiAtI2RlZmluZSBIQVNfR1VDX1NDSEVEKGRldl9wcml2KQko
SEFTX0dVQyhkZXZfcHJpdikpCj4gPiArI2RlZmluZSBIQVNfR1VDKGk5MTUpCShJTlRFTF9JTkZP
KGk5MTUpLT5oYXNfZ3VjKQo+ID4gKyNkZWZpbmUgSEFTX0dVQ19VQ09ERShpOTE1KQkoSEFTX0dV
QyhpOTE1KSkKPiA+ICsjZGVmaW5lIEhBU19HVUNfU0NIRUQoaTkxNSkJKEhBU19HVUMoaTkxNSkp
Cj4gPiAgIC8qIEZvciBub3csIGFueXRoaW5nIHdpdGggYSBHdUMgaGFzIGFsc28gSHVDICovCj4g
PiAtI2RlZmluZSBIQVNfSFVDKGRldl9wcml2KQkoSEFTX0dVQyhkZXZfcHJpdikpCj4gPiAtI2Rl
ZmluZSBIQVNfSFVDX1VDT0RFKGRldl9wcml2KQkoSEFTX0dVQyhkZXZfcHJpdikpCj4gPiArI2Rl
ZmluZSBIQVNfSFVDKGk5MTUpCShIQVNfR1VDKGk5MTUpKQo+ID4gKyNkZWZpbmUgSEFTX0hVQ19V
Q09ERShpOTE1KQkoSEFTX0dVQyhpOTE1KSkKPiA+ICAgLyogSGF2aW5nIGEgR3VDIGlzIG5vdCB0
aGUgc2FtZSBhcyB1c2luZyBhIEd1QyAqLwo+ID4gLSNkZWZpbmUgVVNFU19HVUMoZGV2X3ByaXYp
CQlpbnRlbF91Y19pc191c2luZ19ndWMoZGV2X3ByaXYpCj4gPiAtI2RlZmluZSBVU0VTX0dVQ19T
VUJNSVNTSU9OKGRldl9wcml2KQlpbnRlbF91Y19pc191c2luZ19ndWNfc3VibWlzc2lvbihkZXZf
cHJpdikKPiA+IC0jZGVmaW5lIFVTRVNfSFVDKGRldl9wcml2KQkJaW50ZWxfdWNfaXNfdXNpbmdf
aHVjKGRldl9wcml2KQo+ID4gKyNkZWZpbmUgVVNFU19HVUMoaTkxNSkJCWludGVsX3VjX2lzX3Vz
aW5nX2d1YyhpOTE1KQo+ID4gKyNkZWZpbmUgVVNFU19HVUNfU1VCTUlTU0lPTihpOTE1KQlpbnRl
bF91Y19pc191c2luZ19ndWNfc3VibWlzc2lvbihpOTE1KQo+ID4gKyNkZWZpbmUgVVNFU19IVUMo
aTkxNSkJCWludGVsX3VjX2lzX3VzaW5nX2h1YyhpOTE1KQo+ID4gLSNkZWZpbmUgSEFTX1BPT0xF
RF9FVShkZXZfcHJpdikJKElOVEVMX0lORk8oZGV2X3ByaXYpLT5oYXNfcG9vbGVkX2V1KQo+ID4g
KyNkZWZpbmUgSEFTX1BPT0xFRF9FVShpOTE1KQkoSU5URUxfSU5GTyhpOTE1KS0+aGFzX3Bvb2xl
ZF9ldSkKPiA+ICAgI2RlZmluZSBJTlRFTF9QQ0hfREVWSUNFX0lEX01BU0sJCTB4ZmY4MAo+ID4g
ICAjZGVmaW5lIElOVEVMX1BDSF9JQlhfREVWSUNFX0lEX1RZUEUJCTB4M2IwMAo+ID4gQEAgLTI0
MjksMzYgKzI0MjksMzYgQEAgSVNfU1VCUExBVEZPUk0oY29uc3Qgc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgICNkZWZpbmUgSU5URUxfUENIX1AzWF9ERVZJQ0VfSURfVFlQRQkJ
MHg3MDAwCj4gPiAgICNkZWZpbmUgSU5URUxfUENIX1FFTVVfREVWSUNFX0lEX1RZUEUJCTB4Mjkw
MCAvKiBxZW11IHEzNSBoYXMgMjkxOCAqLwo+ID4gLSNkZWZpbmUgSU5URUxfUENIX1RZUEUoZGV2
X3ByaXYpICgoZGV2X3ByaXYpLT5wY2hfdHlwZSkKPiA+IC0jZGVmaW5lIElOVEVMX1BDSF9JRChk
ZXZfcHJpdikgKChkZXZfcHJpdiktPnBjaF9pZCkKPiA+IC0jZGVmaW5lIEhBU19QQ0hfSUNQKGRl
dl9wcml2KSAoSU5URUxfUENIX1RZUEUoZGV2X3ByaXYpID09IFBDSF9JQ1ApCj4gPiAtI2RlZmlu
ZSBIQVNfUENIX0NOUChkZXZfcHJpdikgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA9PSBQQ0hf
Q05QKQo+ID4gLSNkZWZpbmUgSEFTX1BDSF9TUFQoZGV2X3ByaXYpIChJTlRFTF9QQ0hfVFlQRShk
ZXZfcHJpdikgPT0gUENIX1NQVCkKPiA+IC0jZGVmaW5lIEhBU19QQ0hfTFBUKGRldl9wcml2KSAo
SU5URUxfUENIX1RZUEUoZGV2X3ByaXYpID09IFBDSF9MUFQpCj4gPiAtI2RlZmluZSBIQVNfUENI
X0xQVF9MUChkZXZfcHJpdikgXAo+ID4gLQkoSU5URUxfUENIX0lEKGRldl9wcml2KSA9PSBJTlRF
TF9QQ0hfTFBUX0xQX0RFVklDRV9JRF9UWVBFIHx8IFwKPiA+IC0JIElOVEVMX1BDSF9JRChkZXZf
cHJpdikgPT0gSU5URUxfUENIX1dQVF9MUF9ERVZJQ0VfSURfVFlQRSkKPiA+IC0jZGVmaW5lIEhB
U19QQ0hfTFBUX0goZGV2X3ByaXYpIFwKPiA+IC0JKElOVEVMX1BDSF9JRChkZXZfcHJpdikgPT0g
SU5URUxfUENIX0xQVF9ERVZJQ0VfSURfVFlQRSB8fCBcCj4gPiAtCSBJTlRFTF9QQ0hfSUQoZGV2
X3ByaXYpID09IElOVEVMX1BDSF9XUFRfREVWSUNFX0lEX1RZUEUpCj4gPiAtI2RlZmluZSBIQVNf
UENIX0NQVChkZXZfcHJpdikgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA9PSBQQ0hfQ1BUKQo+
ID4gLSNkZWZpbmUgSEFTX1BDSF9JQlgoZGV2X3ByaXYpIChJTlRFTF9QQ0hfVFlQRShkZXZfcHJp
dikgPT0gUENIX0lCWCkKPiA+IC0jZGVmaW5lIEhBU19QQ0hfTk9QKGRldl9wcml2KSAoSU5URUxf
UENIX1RZUEUoZGV2X3ByaXYpID09IFBDSF9OT1ApCj4gPiAtI2RlZmluZSBIQVNfUENIX1NQTElU
KGRldl9wcml2KSAoSU5URUxfUENIX1RZUEUoZGV2X3ByaXYpICE9IFBDSF9OT05FKQo+ID4gLQo+
ID4gLSNkZWZpbmUgSEFTX0dNQ0goZGV2X3ByaXYpIChJTlRFTF9JTkZPKGRldl9wcml2KS0+ZGlz
cGxheS5oYXNfZ21jaCkKPiA+IC0KPiA+IC0jZGVmaW5lIEhBU19MU1BDT04oZGV2X3ByaXYpIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiArI2RlZmluZSBJTlRFTF9QQ0hfVFlQRShpOTE1
KSAoKGk5MTUpLT5wY2hfdHlwZSkKPiA+ICsjZGVmaW5lIElOVEVMX1BDSF9JRChpOTE1KSAoKGk5
MTUpLT5wY2hfaWQpCj4gPiArI2RlZmluZSBIQVNfUENIX0lDUChpOTE1KSAoSU5URUxfUENIX1RZ
UEUoaTkxNSkgPT0gUENIX0lDUCkKPiA+ICsjZGVmaW5lIEhBU19QQ0hfQ05QKGk5MTUpIChJTlRF
TF9QQ0hfVFlQRShpOTE1KSA9PSBQQ0hfQ05QKQo+ID4gKyNkZWZpbmUgSEFTX1BDSF9TUFQoaTkx
NSkgKElOVEVMX1BDSF9UWVBFKGk5MTUpID09IFBDSF9TUFQpCj4gPiArI2RlZmluZSBIQVNfUENI
X0xQVChpOTE1KSAoSU5URUxfUENIX1RZUEUoaTkxNSkgPT0gUENIX0xQVCkKPiA+ICsjZGVmaW5l
IEhBU19QQ0hfTFBUX0xQKGk5MTUpIFwKPiA+ICsJKElOVEVMX1BDSF9JRChpOTE1KSA9PSBJTlRF
TF9QQ0hfTFBUX0xQX0RFVklDRV9JRF9UWVBFIHx8IFwKPiA+ICsJIElOVEVMX1BDSF9JRChpOTE1
KSA9PSBJTlRFTF9QQ0hfV1BUX0xQX0RFVklDRV9JRF9UWVBFKQo+ID4gKyNkZWZpbmUgSEFTX1BD
SF9MUFRfSChpOTE1KSBcCj4gPiArCShJTlRFTF9QQ0hfSUQoaTkxNSkgPT0gSU5URUxfUENIX0xQ
VF9ERVZJQ0VfSURfVFlQRSB8fCBcCj4gPiArCSBJTlRFTF9QQ0hfSUQoaTkxNSkgPT0gSU5URUxf
UENIX1dQVF9ERVZJQ0VfSURfVFlQRSkKPiA+ICsjZGVmaW5lIEhBU19QQ0hfQ1BUKGk5MTUpIChJ
TlRFTF9QQ0hfVFlQRShpOTE1KSA9PSBQQ0hfQ1BUKQo+ID4gKyNkZWZpbmUgSEFTX1BDSF9JQlgo
aTkxNSkgKElOVEVMX1BDSF9UWVBFKGk5MTUpID09IFBDSF9JQlgpCj4gPiArI2RlZmluZSBIQVNf
UENIX05PUChpOTE1KSAoSU5URUxfUENIX1RZUEUoaTkxNSkgPT0gUENIX05PUCkKPiA+ICsjZGVm
aW5lIEhBU19QQ0hfU1BMSVQoaTkxNSkgKElOVEVMX1BDSF9UWVBFKGk5MTUpICE9IFBDSF9OT05F
KQo+ID4gKwo+ID4gKyNkZWZpbmUgSEFTX0dNQ0goaTkxNSkgKElOVEVMX0lORk8oaTkxNSktPmRp
c3BsYXkuaGFzX2dtY2gpCj4gPiArCj4gPiArI2RlZmluZSBIQVNfTFNQQ09OKGk5MTUpIChJTlRF
TF9HRU4oaTkxNSkgPj0gOSkKPiA+ICAgLyogRFBGID09IGR5bmFtaWMgcGFyaXR5IGZlYXR1cmUg
Ki8KPiA+IC0jZGVmaW5lIEhBU19MM19EUEYoZGV2X3ByaXYpIChJTlRFTF9JTkZPKGRldl9wcml2
KS0+aGFzX2wzX2RwZikKPiA+IC0jZGVmaW5lIE5VTV9MM19TTElDRVMoZGV2X3ByaXYpIChJU19I
U1dfR1QzKGRldl9wcml2KSA/IFwKPiA+IC0JCQkJIDIgOiBIQVNfTDNfRFBGKGRldl9wcml2KSkK
PiA+ICsjZGVmaW5lIEhBU19MM19EUEYoaTkxNSkgKElOVEVMX0lORk8oaTkxNSktPmhhc19sM19k
cGYpCj4gPiArI2RlZmluZSBOVU1fTDNfU0xJQ0VTKGk5MTUpIChJU19IU1dfR1QzKGk5MTUpID8g
XAo+ID4gKwkJCQkgMiA6IEhBU19MM19EUEYoaTkxNSkpCj4gPiAgICNkZWZpbmUgR1RfRlJFUVVF
TkNZX01VTFRJUExJRVIgNTAKPiA+ICAgI2RlZmluZSBHRU45X0ZSRVFfU0NBTEVSIDMKPiA+IC0j
ZGVmaW5lIEhBU19ESVNQTEFZKGRldl9wcml2KSAoSU5URUxfSU5GTyhkZXZfcHJpdiktPm51bV9w
aXBlcyA+IDApCj4gPiArI2RlZmluZSBIQVNfRElTUExBWShpOTE1KSAoSU5URUxfSU5GTyhpOTE1
KS0+bnVtX3BpcGVzID4gMCkKPiA+ICAgI2luY2x1ZGUgImk5MTVfdHJhY2UuaCIKPiA+IEBAIC0y
NDcxLDI0ICsyNDcxLDI0IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF92dGRfYWN0aXZlKHZv
aWQpCj4gPiAgIAlyZXR1cm4gZmFsc2U7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW5saW5lIGJvb2wg
aW50ZWxfc2Nhbm91dF9uZWVkc192dGRfd2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gK3N0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9zY2Fub3V0X25lZWRzX3Z0ZF93YShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlyZXR1cm4gSU5URUxf
R0VOKGRldl9wcml2KSA+PSA2ICYmIGludGVsX3Z0ZF9hY3RpdmUoKTsKPiA+ICsJcmV0dXJuIElO
VEVMX0dFTihpOTE1KSA+PSA2ICYmIGludGVsX3Z0ZF9hY3RpdmUoKTsKPiA+ICAgfQo+ID4gICBz
dGF0aWMgaW5saW5lIGJvb2wKPiA+IC1pbnRlbF9nZ3R0X3VwZGF0ZV9uZWVkc192dGRfd2Eoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludGVsX2dndHRfdXBkYXRlX25l
ZWRzX3Z0ZF93YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQly
ZXR1cm4gSVNfQlJPWFRPTihkZXZfcHJpdikgJiYgaW50ZWxfdnRkX2FjdGl2ZSgpOwo+ID4gKwly
ZXR1cm4gSVNfQlJPWFRPTihpOTE1KSAmJiBpbnRlbF92dGRfYWN0aXZlKCk7Cj4gPiAgIH0KPiA+
ICAgLyogaTkxNV9kcnYuYyAqLwo+ID4gICB2b2lkIF9fcHJpbnRmKDMsIDQpCj4gPiAtX19pOTE1
X3ByaW50ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IGNoYXIgKmxl
dmVsLAo+ID4gK19faTkxNV9wcmludGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGNv
bnN0IGNoYXIgKmxldmVsLAo+ID4gICAJICAgICAgY29uc3QgY2hhciAqZm10LCAuLi4pOwo+ID4g
LSNkZWZpbmUgaTkxNV9yZXBvcnRfZXJyb3IoZGV2X3ByaXYsIGZtdCwgLi4uKQkJCQkgICBcCj4g
PiAtCV9faTkxNV9wcmludGsoZGV2X3ByaXYsIEtFUk5fRVJSLCBmbXQsICMjX19WQV9BUkdTX18p
Cj4gPiArI2RlZmluZSBpOTE1X3JlcG9ydF9lcnJvcihpOTE1LCBmbXQsIC4uLikJCQkJICAgXAo+
ID4gKwlfX2k5MTVfcHJpbnRrKGk5MTUsIEtFUk5fRVJSLCBmbXQsICMjX19WQV9BUkdTX18pCj4g
PiAgICNpZmRlZiBDT05GSUdfQ09NUEFUCj4gPiAgIGV4dGVybiBsb25nIGk5MTVfY29tcGF0X2lv
Y3RsKHN0cnVjdCBmaWxlICpmaWxwLCB1bnNpZ25lZCBpbnQgY21kLAo+ID4gQEAgLTI1MDMsMTIg
KzI1MDMsMTIgQEAgZXh0ZXJuIGludCBpOTE1X2RyaXZlcl9sb2FkKHN0cnVjdCBwY2lfZGV2ICpw
ZGV2LAo+ID4gICBleHRlcm4gdm9pZCBpOTE1X2RyaXZlcl91bmxvYWQoc3RydWN0IGRybV9kZXZp
Y2UgKmRldik7Cj4gPiAgIGV4dGVybiB2b2lkIGludGVsX2VuZ2luZV9pbml0X2hhbmdjaGVjayhz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwo+ID4gLWV4dGVybiB2b2lkIGludGVsX2hh
bmdjaGVja19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtaW50
IHZsdl9mb3JjZV9nZnhfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBi
b29sIG9uKTsKPiA+ICtleHRlcm4gdm9pZCBpbnRlbF9oYW5nY2hlY2tfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAraW50IHZsdl9mb3JjZV9nZnhfY2xvY2soc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgb24pOwo+ID4gLXUzMiBpbnRlbF9jYWxjdWxh
dGVfbWNyX3Nfc3Nfc2VsZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4g
PiArdTMyIGludGVsX2NhbGN1bGF0ZV9tY3Jfc19zc19zZWxlY3Qoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ID4gLXN0YXRpYyBpbmxpbmUgdm9pZCBpOTE1X3F1ZXVlX2hhbmdjaGVj
ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGlubGluZSB2
b2lkIGk5MTVfcXVldWVfaGFuZ2NoZWNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIGRlbGF5Owo+ID4gQEAgLTI1MjIsMjggKzI1MjIs
MjggQEAgc3RhdGljIGlubGluZSB2b2lkIGk5MTVfcXVldWVfaGFuZ2NoZWNrKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCWRlbGF5ID0gcm91bmRfamlmZmllc191cF9y
ZWxhdGl2ZShEUk1fSTkxNV9IQU5HQ0hFQ0tfSklGRklFUyk7Cj4gPiAgIAlxdWV1ZV9kZWxheWVk
X3dvcmsoc3lzdGVtX2xvbmdfd3EsCj4gPiAtCQkJICAgJmRldl9wcml2LT5ncHVfZXJyb3IuaGFu
Z2NoZWNrX3dvcmssIGRlbGF5KTsKPiA+ICsJCQkgICAmaTkxNS0+Z3B1X2Vycm9yLmhhbmdjaGVj
a193b3JrLCBkZWxheSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfZ3Z0
X2FjdGl2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGlu
bGluZSBib29sIGludGVsX2d2dF9hY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+IC0JcmV0dXJuIGRldl9wcml2LT5ndnQ7Cj4gPiArCXJldHVybiBpOTE1LT5n
dnQ7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfdmdwdV9hY3RpdmUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBpbmxpbmUgYm9vbCBp
bnRlbF92Z3B1X2FjdGl2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+
ID4gLQlyZXR1cm4gZGV2X3ByaXYtPnZncHUuYWN0aXZlOwo+ID4gKwlyZXR1cm4gaTkxNS0+dmdw
dS5hY3RpdmU7Cj4gPiAgIH0KPiA+ICAgLyogaTkxNV9nZW0uYyAqLwo+ID4gLWludCBpOTE1X2dl
bV9pbml0X3VzZXJwdHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12
b2lkIGk5MTVfZ2VtX2NsZWFudXBfdXNlcnB0cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwo+ID4gK2ludCBpOTE1X2dlbV9pbml0X3VzZXJwdHIoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaTkxNV9nZW1fY2xlYW51cF91c2VycHRyKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgdm9pZCBpOTE1X2dlbV9zYW5pdGl6ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAtaW50IGk5MTVfZ2VtX2luaXRfZWFybHko
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGk5MTVfZ2VtX2Ns
ZWFudXBfZWFybHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lk
IGk5MTVfZ2VtX2xvYWRfaW5pdF9mZW5jZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsKPiA+IC1pbnQgaTkxNV9nZW1fZnJlZXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gPiAtaW50IGk5MTVfZ2VtX2ZyZWV6ZV9sYXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7Cj4gPiAraW50IGk5MTVfZ2VtX2luaXRfZWFybHkoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaTkxNV9nZW1fY2xlYW51cF9lYXJseShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBpOTE1X2dlbV9sb2FkX2lu
aXRfZmVuY2VzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICtpbnQgaTkxNV9n
ZW1fZnJlZXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICtpbnQgaTkxNV9n
ZW1fZnJlZXplX2xhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICBzdGF0
aWMgaW5saW5lIHZvaWQgaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gQEAgLTI1OTEsNyArMjU5MSw3IEBAIGk5MTVf
Z2VtX29iamVjdF9nZ3R0X3BpbihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ID4g
ICBpbnQgaTkxNV9nZW1fb2JqZWN0X3VuYmluZChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqKTsKPiA+IC12b2lkIGk5MTVfZ2VtX3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3ZvaWQgaTkxNV9nZW1fcnVudGltZV9zdXNwZW5kKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgc3RhdGljIGlubGluZSBpbnQgX19t
dXN0X2NoZWNrCj4gPiAgIGk5MTVfbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYpCj4gPiBAQCAtMjYzMywyMCArMjYzMywyMCBAQCBzdGF0aWMgaW5saW5lIHUz
MiBpOTE1X3Jlc2V0X2VuZ2luZV9jb3VudChzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9yLAo+
ID4gICAJcmV0dXJuIFJFQURfT05DRShlcnJvci0+cmVzZXRfZW5naW5lX2NvdW50W2VuZ2luZS0+
aWRdKTsKPiA+ICAgfQo+ID4gLXZvaWQgaTkxNV9nZW1fc2V0X3dlZGdlZChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLWJvb2wgaTkxNV9nZW1fdW5zZXRfd2VkZ2VkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBpOTE1X2dlbV9zZXRf
d2VkZ2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICtib29sIGk5MTVfZ2Vt
X3Vuc2V0X3dlZGdlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIHZvaWQg
aTkxNV9nZW1faW5pdF9tbWlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+IC1p
bnQgX19tdXN0X2NoZWNrIGk5MTVfZ2VtX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKPiA+IC1pbnQgX19tdXN0X2NoZWNrIGk5MTVfZ2VtX2luaXRfaHcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGk5MTVfZ2VtX2luaXRfc3dpenps
aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpOTE1X2dl
bV9maW5pX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBp
OTE1X2dlbV9maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtaW50
IGk5MTVfZ2VtX3dhaXRfZm9yX2lkbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gK2ludCBfX211c3RfY2hlY2sgaTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSk7Cj4gPiAraW50IF9fbXVzdF9jaGVjayBpOTE1X2dlbV9pbml0X2h3KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGk5MTVfZ2VtX2luaXRfc3dpenps
aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGk5MTVfZ2VtX2Zp
bmlfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaTkxNV9nZW1f
ZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAraW50IGk5MTVfZ2VtX3dh
aXRfZm9yX2lkbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgIHVu
c2lnbmVkIGludCBmbGFncywgbG9uZyB0aW1lb3V0KTsKPiA+IC12b2lkIGk5MTVfZ2VtX3N1c3Bl
bmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGk5MTVfZ2Vt
X3N1c3BlbmRfbGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZv
aWQgaTkxNV9nZW1fcmVzdW1lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4g
PiArdm9pZCBpOTE1X2dlbV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiA+ICt2b2lkIGk5MTVfZ2VtX3N1c3BlbmRfbGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7Cj4gPiArdm9pZCBpOTE1X2dlbV9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwo+ID4gICB2bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAq
dm1mKTsKPiA+ICAgaW50IGk5MTVfZ2VtX29wZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7Cj4gPiBAQCAtMjY2MywxMiArMjY2MywxMiBAQCBz
dHJ1Y3QgZG1hX2J1ZiAqaTkxNV9nZW1fcHJpbWVfZXhwb3J0KHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsCj4gPiAgIC8qIGk5MTVfZ2VtX2ZlbmNlX3JlZy5jICovCj4gPiAgIHN0cnVjdCBkcm1faTkx
NV9mZW5jZV9yZWcgKgo+ID4gLWk5MTVfcmVzZXJ2ZV9mZW5jZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+ID4gK2k5MTVfcmVzZXJ2ZV9mZW5jZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIHZvaWQgaTkxNV91bnJlc2VydmVfZmVuY2Uoc3RydWN0IGRy
bV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2UpOwo+ID4gLXZvaWQgaTkxNV9nZW1fcmVzdG9yZV9mZW5j
ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICt2b2lkIGk5MTVfZ2Vt
X3Jlc3RvcmVfZmVuY2VzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+IC12b2lk
IGk5MTVfZ2VtX2RldGVjdF9iaXRfNl9zd2l6emxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gPiArdm9pZCBpOTE1X2dlbV9kZXRlY3RfYml0XzZfc3dpenpsZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIHZvaWQgaTkxNV9nZW1fb2JqZWN0X2RvX2Jp
dF8xN19zd2l6emxlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gPiAgIAkJCQkg
ICAgICAgc3RydWN0IHNnX3RhYmxlICpwYWdlcyk7Cj4gPiAgIHZvaWQgaTkxNV9nZW1fb2JqZWN0
X3NhdmVfYml0XzE3X3N3aXp6bGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiA+
IEBAIC0yNzE1LDQwICsyNzE1LDQwIEBAIGludCBfX211c3RfY2hlY2sgaTkxNV9nZW1fZXZpY3Rf
Zm9yX25vZGUoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gPiAgIAkJCQkJIHVuc2ln
bmVkIGludCBmbGFncyk7Cj4gPiAgIGludCBpOTE1X2dlbV9ldmljdF92bShzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bSk7Cj4gPiAtdm9pZCBpOTE1X2dlbV9mbHVzaF9nZ3R0X3dyaXRlcyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3ZvaWQgaTkxNV9nZW1fZmx1
c2hfZ2d0dF93cml0ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAvKiBi
ZWxvbmdzIGluIGk5MTVfZ2VtX2d0dC5oICovCj4gPiAtc3RhdGljIGlubGluZSB2b2lkIGk5MTVf
Z2VtX2NoaXBzZXRfZmx1c2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K3N0YXRpYyBpbmxpbmUgdm9pZCBpOTE1X2dlbV9jaGlwc2V0X2ZsdXNoKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl3bWIoKTsKPiA+IC0JaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPCA2KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNikKPiA+ICAgCQlp
bnRlbF9ndHRfY2hpcHNldF9mbHVzaCgpOwo+ID4gICB9Cj4gPiAgIC8qIGk5MTVfZ2VtX3N0b2xl
bi5jICovCj4gPiAtaW50IGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAraW50IGk5MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9k
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCXN0cnVjdCBkcm1fbW1f
bm9kZSAqbm9kZSwgdTY0IHNpemUsCj4gPiAgIAkJCQl1bnNpZ25lZCBhbGlnbm1lbnQpOwo+ID4g
LWludCBpOTE1X2dlbV9zdG9sZW5faW5zZXJ0X25vZGVfaW5fcmFuZ2Uoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2ludCBpOTE1X2dlbV9zdG9sZW5faW5zZXJ0X25vZGVf
aW5fcmFuZ2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJIHN0cnVj
dCBkcm1fbW1fbm9kZSAqbm9kZSwgdTY0IHNpemUsCj4gPiAgIAkJCQkJIHVuc2lnbmVkIGFsaWdu
bWVudCwgdTY0IHN0YXJ0LAo+ID4gICAJCQkJCSB1NjQgZW5kKTsKPiA+IC12b2lkIGk5MTVfZ2Vt
X3N0b2xlbl9yZW1vdmVfbm9kZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiArdm9pZCBpOTE1X2dlbV9zdG9sZW5fcmVtb3ZlX25vZGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCQkgc3RydWN0IGRybV9tbV9ub2RlICpub2RlKTsKPiA+IC1pbnQg
aTkxNV9nZW1faW5pdF9zdG9sZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsK
PiA+IC12b2lkIGk5MTVfZ2VtX2NsZWFudXBfc3RvbGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cj4gPiAraW50IGk5MTVfZ2VtX2luaXRfc3RvbGVuKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGk5MTVfZ2VtX2NsZWFudXBfc3RvbGVuKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKgo+ID4gLWk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgcmVzb3VyY2Vfc2l6ZV90
IHNpemUpOwo+ID4gICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqCj4gPiAtaTkxNV9nZW1f
b2JqZWN0X2NyZWF0ZV9zdG9sZW5fZm9yX3ByZWFsbG9jYXRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiAraTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW5fZm9yX3By
ZWFsbG9jYXRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICAg
ICAgcmVzb3VyY2Vfc2l6ZV90IHN0b2xlbl9vZmZzZXQsCj4gPiAgIAkJCQkJICAgICAgIHJlc291
cmNlX3NpemVfdCBndHRfb2Zmc2V0LAo+ID4gICAJCQkJCSAgICAgICByZXNvdXJjZV9zaXplX3Qg
c2l6ZSk7Cj4gPiAgIC8qIGk5MTVfZ2VtX2ludGVybmFsLmMgKi8KPiA+ICAgc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKgo+ID4gLWk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2k5MTVfZ2VtX29iamVjdF9jcmVh
dGVfaW50ZXJuYWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQlwaHlz
X2FkZHJfdCBzaXplKTsKPiA+ICAgLyogaTkxNV9nZW1fc2hyaW5rZXIuYyAqLwo+ID4gQEAgLTI3
NzEsMjEgKzI3NzEsMjEgQEAgdm9pZCBpOTE1X2dlbV9zaHJpbmtlcl90YWludHNfbXV0ZXgoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIC8qIGk5MTVfZ2VtX3RpbGluZy5jICov
Cj4gPiAgIHN0YXRpYyBpbmxpbmUgYm9vbCBpOTE1X2dlbV9vYmplY3RfbmVlZHNfYml0MTdfc3dp
enpsZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2
KTsKPiA+IC0JcmV0dXJuIGRldl9wcml2LT5tbS5iaXRfNl9zd2l6emxlX3ggPT0gSTkxNV9CSVRf
Nl9TV0laWkxFXzlfMTBfMTcgJiYKPiA+ICsJcmV0dXJuIGk5MTUtPm1tLmJpdF82X3N3aXp6bGVf
eCA9PSBJOTE1X0JJVF82X1NXSVpaTEVfOV8xMF8xNyAmJgo+ID4gICAJCWk5MTVfZ2VtX29iamVj
dF9pc190aWxlZChvYmopOwo+ID4gICB9Cj4gPiAtdTMyIGk5MTVfZ2VtX2ZlbmNlX3NpemUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgc2l6ZSwKPiA+ICt1MzIgaTkxNV9n
ZW1fZmVuY2Vfc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIHNpemUsCj4g
PiAgIAkJCXVuc2lnbmVkIGludCB0aWxpbmcsIHVuc2lnbmVkIGludCBzdHJpZGUpOwo+ID4gLXUz
MiBpOTE1X2dlbV9mZW5jZV9hbGlnbm1lbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCB1MzIgc2l6ZSwKPiA+ICt1MzIgaTkxNV9nZW1fZmVuY2VfYWxpZ25tZW50KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgc2l6ZSwKPiA+ICAgCQkJICAgICB1bnNpZ25lZCBp
bnQgdGlsaW5nLCB1bnNpZ25lZCBpbnQgc3RyaWRlKTsKPiA+ICAgY29uc3QgY2hhciAqaTkxNV9j
YWNoZV9sZXZlbF9zdHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCB0eXBlKTsK
PiA+ICAgLyogaTkxNV9jbWRfcGFyc2VyLmMgKi8KPiA+IC1pbnQgaTkxNV9jbWRfcGFyc2VyX2dl
dF92ZXJzaW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAraW50IGk5
MTVfY21kX3BhcnNlcl9nZXRfdmVyc2lvbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gPiAgIHZvaWQgaW50ZWxfZW5naW5lX2luaXRfY21kX3BhcnNlcihzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUpOwo+ID4gICB2b2lkIGludGVsX2VuZ2luZV9jbGVhbnVwX2NtZF9wYXJz
ZXIoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKPiA+ICAgaW50IGludGVsX2VuZ2lu
ZV9jbWRfcGFyc2VyKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKPiA+IEBAIC0yNzk2
LDUyICsyNzk2LDUyIEBAIGludCBpbnRlbF9lbmdpbmVfY21kX3BhcnNlcihzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsCj4gPiAgIAkJCSAgICBib29sIGlzX21hc3Rlcik7Cj4gPiAgIC8q
IGk5MTVfcGVyZi5jICovCj4gPiAtZXh0ZXJuIHZvaWQgaTkxNV9wZXJmX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfZmlu
aShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLWV4dGVybiB2b2lkIGk5
MTVfcGVyZl9yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4g
LWV4dGVybiB2b2lkIGk5MTVfcGVyZl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cj4gPiArZXh0ZXJuIHZvaWQgaTkxNV9wZXJmX2luaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK2V4dGVybiB2b2lkIGk5MTVfcGVyZl9maW5pKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfcmVn
aXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK2V4dGVybiB2b2lkIGk5
MTVfcGVyZl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAg
LyogaTkxNV9zdXNwZW5kLmMgKi8KPiA+IC1leHRlcm4gaW50IGk5MTVfc2F2ZV9zdGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLWV4dGVybiBpbnQgaTkxNV9yZXN0
b3JlX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArZXh0ZXJu
IGludCBpOTE1X3NhdmVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4g
K2V4dGVybiBpbnQgaTkxNV9yZXN0b3JlX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KTsKPiA+ICAgLyogaTkxNV9zeXNmcy5jICovCj4gPiAtdm9pZCBpOTE1X3NldHVwX3N5c2Zz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpOTE1X3RlYXJk
b3duX3N5c2ZzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBp
OTE1X3NldHVwX3N5c2ZzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lk
IGk5MTVfdGVhcmRvd25fc3lzZnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4g
ICAvKiBpbnRlbF9kZXZpY2VfaW5mby5jICovCj4gPiAgIHN0YXRpYyBpbmxpbmUgc3RydWN0IGlu
dGVsX2RldmljZV9pbmZvICoKPiA+IC1ta3dyaXRlX2RldmljZV9pbmZvKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtta3dyaXRlX2RldmljZV9pbmZvKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXJldHVybiAoc3RydWN0IGludGVsX2Rl
dmljZV9pbmZvICopSU5URUxfSU5GTyhkZXZfcHJpdik7Cj4gPiArCXJldHVybiAoc3RydWN0IGlu
dGVsX2RldmljZV9pbmZvICopSU5URUxfSU5GTyhpOTE1KTsKPiA+ICAgfQo+ID4gICAvKiBtb2Rl
c2V0dGluZyAqLwo+ID4gICBleHRlcm4gdm9pZCBpbnRlbF9tb2Rlc2V0X2luaXRfaHcoc3RydWN0
IGRybV9kZXZpY2UgKmRldik7Cj4gPiAgIGV4dGVybiBpbnQgaW50ZWxfbW9kZXNldF9pbml0KHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYpOwo+ID4gICBleHRlcm4gdm9pZCBpbnRlbF9tb2Rlc2V0X2Ns
ZWFudXAoc3RydWN0IGRybV9kZXZpY2UgKmRldik7Cj4gPiAtZXh0ZXJuIGludCBpbnRlbF9tb2Rl
c2V0X3ZnYV9zZXRfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
K2V4dGVybiBpbnQgaW50ZWxfbW9kZXNldF92Z2Ffc2V0X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgIGJvb2wgc3RhdGUpOwo+ID4gICBleHRlcm4g
dm9pZCBpbnRlbF9kaXNwbGF5X3Jlc3VtZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsKPiA+IC1l
eHRlcm4gdm9pZCBpOTE1X3JlZGlzYWJsZV92Z2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKPiA+IC1leHRlcm4gdm9pZCBpOTE1X3JlZGlzYWJsZV92Z2FfcG93ZXJfb24oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC1leHRlcm4gdm9pZCBpbnRlbF9p
bml0X3BjaF9yZWZjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtl
eHRlcm4gdm9pZCBpOTE1X3JlZGlzYWJsZV92Z2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpOwo+ID4gK2V4dGVybiB2b2lkIGk5MTVfcmVkaXNhYmxlX3ZnYV9wb3dlcl9vbihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArZXh0ZXJuIHZvaWQgaW50ZWxfaW5pdF9wY2hf
cmVmY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgaW50IGk5MTVfcmVn
X3JlYWRfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiA+ICAgCQkJ
c3RydWN0IGRybV9maWxlICpmaWxlKTsKPiA+ICAgZXh0ZXJuIHN0cnVjdCBpbnRlbF9kaXNwbGF5
X2Vycm9yX3N0YXRlICoKPiA+IC1pbnRlbF9kaXNwbGF5X2NhcHR1cmVfZXJyb3Jfc3RhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtpbnRlbF9kaXNwbGF5X2NhcHR1
cmVfZXJyb3Jfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICBleHRl
cm4gdm9pZCBpbnRlbF9kaXNwbGF5X3ByaW50X2Vycm9yX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9l
cnJvcl9zdGF0ZV9idWYgKmUsCj4gPiAgIAkJCQkJICAgIHN0cnVjdCBpbnRlbF9kaXNwbGF5X2Vy
cm9yX3N0YXRlICplcnJvcik7Cj4gPiAgICNkZWZpbmUgX19JOTE1X1JFR19PUChvcF9fLCBkZXZf
cHJpdl9fLCAuLi4pIFwKPiA+ICAgCWludGVsX3VuY29yZV8jI29wX18oJihkZXZfcHJpdl9fKS0+
dW5jb3JlLCBfX1ZBX0FSR1NfXykKPiA+IC0jZGVmaW5lIEk5MTVfUkVBRChyZWdfXykJIF9fSTkx
NV9SRUdfT1AocmVhZCwgZGV2X3ByaXYsIChyZWdfXykpCj4gPiAtI2RlZmluZSBJOTE1X1dSSVRF
KHJlZ19fLCB2YWxfXykgX19JOTE1X1JFR19PUCh3cml0ZSwgZGV2X3ByaXYsIChyZWdfXyksICh2
YWxfXykpCj4gPiArI2RlZmluZSBJOTE1X1JFQUQocmVnX18pCSBfX0k5MTVfUkVHX09QKHJlYWQs
IGk5MTUsIChyZWdfXykpCj4gPiArI2RlZmluZSBJOTE1X1dSSVRFKHJlZ19fLCB2YWxfXykgX19J
OTE1X1JFR19PUCh3cml0ZSwgaTkxNSwgKHJlZ19fKSwgKHZhbF9fKSkKPiA+IC0jZGVmaW5lIFBP
U1RJTkdfUkVBRChyZWdfXykJX19JOTE1X1JFR19PUChwb3N0aW5nX3JlYWQsIGRldl9wcml2LCAo
cmVnX18pKQo+ID4gKyNkZWZpbmUgUE9TVElOR19SRUFEKHJlZ19fKQlfX0k5MTVfUkVHX09QKHBv
c3RpbmdfcmVhZCwgaTkxNSwgKHJlZ19fKSkKPiA+ICAgLyogVGhlc2UgYXJlIHVudHJhY2VkIG1t
aW8tYWNjZXNzb3JzIHRoYXQgYXJlIG9ubHkgdmFsaWQgdG8gYmUgdXNlZCBpbnNpZGUKPiA+ICAg
ICogY3JpdGljYWwgc2VjdGlvbnMsIHN1Y2ggYXMgaW5zaWRlIElSUSBoYW5kbGVycywgd2hlcmUg
Zm9yY2V3YWtlIGlzIGV4cGxpY2l0bHkKPiA+IEBAIC0yODUxLDEzICsyODUxLDEzIEBAIGV4dGVy
biB2b2lkIGludGVsX2Rpc3BsYXlfcHJpbnRfZXJyb3Jfc3RhdGUoc3RydWN0IGRybV9pOTE1X2Vy
cm9yX3N0YXRlX2J1ZiAqZSwKPiA+ICAgICoKPiA+ICAgICogQXMgYW4gZXhhbXBsZSwgdGhlc2Ug
YWNjZXNzb3JzIGNhbiBwb3NzaWJseSBiZSB1c2VkIGJldHdlZW46Cj4gPiAgICAqCj4gPiAtICog
c3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrKTsKPiA+ICsgKiBzcGluX2xvY2tf
aXJxKCZpOTE1LT51bmNvcmUubG9jayk7Cj4gPiAgICAqIGludGVsX3VuY29yZV9mb3JjZXdha2Vf
Z2V0X19sb2NrZWQoKTsKPiA+ICAgICoKPiA+ICAgICogYW5kCj4gPiAgICAqCj4gPiAgICAqIGlu
dGVsX3VuY29yZV9mb3JjZXdha2VfcHV0X19sb2NrZWQoKTsKPiA+IC0gKiBzcGluX3VubG9ja19p
cnEoJmRldl9wcml2LT51bmNvcmUubG9jayk7Cj4gPiArICogc3Bpbl91bmxvY2tfaXJxKCZpOTE1
LT51bmNvcmUubG9jayk7Cj4gPiAgICAqCj4gPiAgICAqCj4gPiAgICAqIE5vdGU6IHNvbWUgcmVn
aXN0ZXJzIG1heSBub3QgbmVlZCBmb3JjZXdha2UgaGVsZCwgc28KPiA+IEBAIC0yODY2LDE4ICsy
ODY2LDE4IEBAIGV4dGVybiB2b2lkIGludGVsX2Rpc3BsYXlfcHJpbnRfZXJyb3Jfc3RhdGUoc3Ry
dWN0IGRybV9pOTE1X2Vycm9yX3N0YXRlX2J1ZiAqZSwKPiA+ICAgICoKPiA+ICAgICogQ2VydGFp
biBhcmNoaXRlY3R1cmVzIHdpbGwgZGllIGlmIHRoZSBzYW1lIGNhY2hlbGluZSBpcyBjb25jdXJy
ZW50bHkgYWNjZXNzZWQKPiA+ICAgICogYnkgZGlmZmVyZW50IGNsaWVudHMgKGUuZy4gb24gSXZ5
YnJpZGdlKS4gQWNjZXNzIHRvIHJlZ2lzdGVycyBzaG91bGQKPiA+IC0gKiB0aGVyZWZvcmUgZ2Vu
ZXJhbGx5IGJlIHNlcmlhbGlzZWQsIGJ5IGVpdGhlciB0aGUgZGV2X3ByaXYtPnVuY29yZS5sb2Nr
IG9yCj4gPiArICogdGhlcmVmb3JlIGdlbmVyYWxseSBiZSBzZXJpYWxpc2VkLCBieSBlaXRoZXIg
dGhlIGk5MTUtPnVuY29yZS5sb2NrIG9yCj4gPiAgICAqIGEgbW9yZSBsb2NhbGlzZWQgbG9jayBn
dWFyZGluZyBhbGwgYWNjZXNzIHRvIHRoYXQgYmFuayBvZiByZWdpc3RlcnMuCj4gPiAgICAqLwo+
ID4gLSNkZWZpbmUgSTkxNV9SRUFEX0ZXKHJlZ19fKSBfX0k5MTVfUkVHX09QKHJlYWRfZncsIGRl
dl9wcml2LCAocmVnX18pKQo+ID4gLSNkZWZpbmUgSTkxNV9XUklURV9GVyhyZWdfXywgdmFsX18p
IF9fSTkxNV9SRUdfT1Aod3JpdGVfZncsIGRldl9wcml2LCAocmVnX18pLCAodmFsX18pKQo+ID4g
KyNkZWZpbmUgSTkxNV9SRUFEX0ZXKHJlZ19fKSBfX0k5MTVfUkVHX09QKHJlYWRfZncsIGk5MTUs
IChyZWdfXykpCj4gPiArI2RlZmluZSBJOTE1X1dSSVRFX0ZXKHJlZ19fLCB2YWxfXykgX19JOTE1
X1JFR19PUCh3cml0ZV9mdywgaTkxNSwgKHJlZ19fKSwgKHZhbF9fKSkKPiA+ICAgLyogIkJyb2Fk
Y2FzdCBSR0IiIHByb3BlcnR5ICovCj4gPiAgICNkZWZpbmUgSU5URUxfQlJPQURDQVNUX1JHQl9B
VVRPIDAKPiA+ICAgI2RlZmluZSBJTlRFTF9CUk9BRENBU1RfUkdCX0ZVTEwgMQo+ID4gICAjZGVm
aW5lIElOVEVMX0JST0FEQ0FTVF9SR0JfTElNSVRFRCAyCj4gPiAtdm9pZCBpOTE1X21lbWNweV9p
bml0X2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBp
OTE1X21lbWNweV9pbml0X2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+
ICAgYm9vbCBpOTE1X21lbWNweV9mcm9tX3djKHZvaWQgKmRzdCwgY29uc3Qgdm9pZCAqc3JjLCB1
bnNpZ25lZCBsb25nIGxlbik7Cj4gPiAgIC8qIFRoZSBtb3ZudGRxYSBpbnN0cnVjdGlvbnMgdXNl
ZCBmb3IgbWVtY3B5LWZyb20td2MgcmVxdWlyZSAxNi1ieXRlIGFsaWdubWVudCwKPiA+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW0uYwo+ID4gaW5kZXggNDAxN2VjZjU2MWY2Li4xNzc0Yzc2MDQwNzYgMTAw
NjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCj4gPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCj4gPiBAQCAtMTQ5LDcgKzE0OSw3IEBAIGk5
MTVfZ2VtX3BoeXNfcHdyaXRlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gPiAg
IHN0YXRpYyBpbnQKPiA+ICAgaTkxNV9nZW1fY3JlYXRlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwK
PiA+IC0JCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICsJCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCXU2NCAqc2l6ZV9wLAo+ID4gICAJCXUzMiAq
aGFuZGxlX3ApCj4gPiAgIHsKPiA+IEBAIC0xNjMsNyArMTYzLDcgQEAgaTkxNV9nZW1fY3JlYXRl
KHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwKPiA+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICAgCS8q
IEFsbG9jYXRlIHRoZSBuZXcgb2JqZWN0ICovCj4gPiAtCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9j
cmVhdGVfc2htZW0oZGV2X3ByaXYsIHNpemUpOwo+ID4gKwlvYmogPSBpOTE1X2dlbV9vYmplY3Rf
Y3JlYXRlX3NobWVtKGk5MTUsIHNpemUpOwo+ID4gICAJaWYgKElTX0VSUihvYmopKQo+ID4gICAJ
CXJldHVybiBQVFJfRVJSKG9iaik7Cj4gPiBAQCAtMjIzLDE2ICsyMjMsMTYgQEAgaW50Cj4gPiAg
IGk5MTVfZ2VtX2NyZWF0ZV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRh
LAo+ID4gICAJCSAgICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGRy
bV9pOTE1X2dlbV9jcmVhdGUgKmFyZ3MgPSBkYXRhOwo+ID4gLQlpOTE1X2dlbV9mbHVzaF9mcmVl
X29iamVjdHMoZGV2X3ByaXYpOwo+ID4gKwlpOTE1X2dlbV9mbHVzaF9mcmVlX29iamVjdHMoaTkx
NSk7Cj4gPiAtCXJldHVybiBpOTE1X2dlbV9jcmVhdGUoZmlsZSwgZGV2X3ByaXYsCj4gPiArCXJl
dHVybiBpOTE1X2dlbV9jcmVhdGUoZmlsZSwgaTkxNSwKPiA+ICAgCQkJICAgICAgICZhcmdzLT5z
aXplLCAmYXJncy0+aGFuZGxlKTsKPiA+ICAgfQo+ID4gLXZvaWQgaTkxNV9nZW1fZmx1c2hfZ2d0
dF93cml0ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaTkx
NV9nZW1fZmx1c2hfZ2d0dF93cml0ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gQEAgLTI1NywxMyArMjU3
LDEzIEBAIHZvaWQgaTkxNV9nZW1fZmx1c2hfZ2d0dF93cml0ZXMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gICAJd21iKCk7Cj4gPiAtCWlmIChJTlRFTF9JTkZPKGRldl9w
cml2KS0+aGFzX2NvaGVyZW50X2dndHQpCj4gPiArCWlmIChJTlRFTF9JTkZPKGk5MTUpLT5oYXNf
Y29oZXJlbnRfZ2d0dCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWk5MTVfZ2VtX2NoaXBzZXRfZmx1
c2goZGV2X3ByaXYpOwo+ID4gKwlpOTE1X2dlbV9jaGlwc2V0X2ZsdXNoKGk5MTUpOwo+ID4gLQl3
aXRoX2ludGVsX3J1bnRpbWVfcG0oZGV2X3ByaXYsIHdha2VyZWYpIHsKPiA+IC0JCXN0cnVjdCBp
bnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ID4gKwl3aXRoX2ludGVs
X3J1bnRpbWVfcG0oaTkxNSwgd2FrZXJlZikgewo+ID4gKwkJc3RydWN0IGludGVsX3VuY29yZSAq
dW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiA+ICAgCQlzcGluX2xvY2tfaXJxKCZ1bmNvcmUtPmxv
Y2spOwo+ID4gICAJCWludGVsX3VuY29yZV9wb3N0aW5nX3JlYWRfZncodW5jb3JlLAo+ID4gQEAg
LTg4NCw3ICs4ODQsNyBAQCBpOTE1X2dlbV9zd19maW5pc2hfaW9jdGwoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwgdm9pZCAqZGF0YSwKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiAtdm9pZCBp
OTE1X2dlbV9ydW50aW1lX3N1c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gK3ZvaWQgaTkxNV9nZW1fcnVudGltZV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
LCAqb247Cj4gPiAgIAlpbnQgaTsKPiA+IEBAIC04OTcsMTUgKzg5NywxNSBAQCB2b2lkIGk5MTVf
Z2VtX3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiAgIAkgKi8KPiA+ICAgCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShvYmosIG9uLAo+ID4gLQkJ
CQkgJmRldl9wcml2LT5tbS51c2VyZmF1bHRfbGlzdCwgdXNlcmZhdWx0X2xpbmspCj4gPiArCQkJ
CSAmaTkxNS0+bW0udXNlcmZhdWx0X2xpc3QsIHVzZXJmYXVsdF9saW5rKQo+ID4gICAJCV9faTkx
NV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcChvYmopOwo+ID4gICAJLyogVGhlIGZlbmNlIHdpbGwg
YmUgbG9zdCB3aGVuIHRoZSBkZXZpY2UgcG93ZXJzIGRvd24uIElmIGFueSB3ZXJlCj4gPiAgIAkg
KiBpbiB1c2UgYnkgaGFyZHdhcmUgKGkuZS4gdGhleSBhcmUgcGlubmVkKSwgd2Ugc2hvdWxkIG5v
dCBiZSBwb3dlcmluZwo+ID4gICAJICogZG93biEgQWxsIG90aGVyIGZlbmNlcyB3aWxsIGJlIHJl
YWNxdWlyZWQgYnkgdGhlIHVzZXIgdXBvbiB3YWtpbmcuCj4gPiAgIAkgKi8KPiA+IC0JZm9yIChp
ID0gMDsgaSA8IGRldl9wcml2LT5udW1fZmVuY2VfcmVnczsgaSsrKSB7Cj4gPiAtCQlzdHJ1Y3Qg
ZHJtX2k5MTVfZmVuY2VfcmVnICpyZWcgPSAmZGV2X3ByaXYtPmZlbmNlX3JlZ3NbaV07Cj4gPiAr
CWZvciAoaSA9IDA7IGkgPCBpOTE1LT5udW1fZmVuY2VfcmVnczsgaSsrKSB7Cj4gPiArCQlzdHJ1
Y3QgZHJtX2k5MTVfZmVuY2VfcmVnICpyZWcgPSAmaTkxNS0+ZmVuY2VfcmVnc1tpXTsKPiA+ICAg
CQkvKiBJZGVhbGx5IHdlIHdhbnQgdG8gYXNzZXJ0IHRoYXQgdGhlIGZlbmNlIHJlZ2lzdGVyIGlz
IG5vdAo+ID4gICAJCSAqIGxpdmUgYXQgdGhpcyBwb2ludCAoaS5lLiB0aGF0IG5vIHBpZWNlIG9m
IGNvZGUgd2lsbCBiZQo+ID4gQEAgLTEwMjAsOCArMTAyMCw4IEBAIGk5MTVfZ2VtX29iamVjdF9n
Z3R0X3BpbihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ID4gICAJCQkgdTY0IGFs
aWdubWVudCwKPiA+ICAgCQkJIHU2NCBmbGFncykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+ID4gLQlzdHJ1
Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9ICZkZXZfcHJpdi0+Z2d0dC52bTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+ID4g
KwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9ICZpOTE1LT5nZ3R0LnZtOwo+ID4gICAJ
c3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gQEAgLTEwMzYsNyArMTAz
Niw3IEBAIGk5MTVfZ2VtX29iamVjdF9nZ3R0X3BpbihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqLAo+ID4gICAJCSAqIHRoZSBvYmplY3QgaW4gYW5kIG91dCBvZiB0aGUgR2xvYmFsIEdU
VCBhbmQKPiA+ICAgCQkgKiB3YXN0ZSBhIGxvdCBvZiBjeWNsZXMgdW5kZXIgdGhlIG11dGV4Lgo+
ID4gICAJCSAqLwo+ID4gLQkJaWYgKG9iai0+YmFzZS5zaXplID4gZGV2X3ByaXYtPmdndHQubWFw
cGFibGVfZW5kKQo+ID4gKwkJaWYgKG9iai0+YmFzZS5zaXplID4gaTkxNS0+Z2d0dC5tYXBwYWJs
ZV9lbmQpCj4gPiAgIAkJCXJldHVybiBFUlJfUFRSKC1FMkJJRyk7Cj4gPiAgIAkJLyogSWYgTk9O
QkxPQ0sgaXMgc2V0IHRoZSBjYWxsZXIgaXMgb3B0aW1pc3RpY2FsbHkKPiA+IEBAIC0xMDU1LDcg
KzEwNTUsNyBAQCBpOTE1X2dlbV9vYmplY3RfZ2d0dF9waW4oc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaiwKPiA+ICAgCQkgKiB3ZSBjb3VsZCB0cnkgdG8gbWluaW1pc2UgaGFybSB0byBv
dGhlcnMuCj4gPiAgIAkJICovCj4gPiAgIAkJaWYgKGZsYWdzICYgUElOX05PTkJMT0NLICYmCj4g
PiAtCQkgICAgb2JqLT5iYXNlLnNpemUgPiBkZXZfcHJpdi0+Z2d0dC5tYXBwYWJsZV9lbmQgLyAy
KQo+ID4gKwkJICAgIG9iai0+YmFzZS5zaXplID4gaTkxNS0+Z2d0dC5tYXBwYWJsZV9lbmQgLyAy
KQo+ID4gICAJCQlyZXR1cm4gRVJSX1BUUigtRU5PU1BDKTsKPiA+ICAgCX0KPiA+IEBAIC0xMDY5
LDcgKzEwNjksNyBAQCBpOTE1X2dlbV9vYmplY3RfZ2d0dF9waW4oc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaiwKPiA+ICAgCQkJCXJldHVybiBFUlJfUFRSKC1FTk9TUEMpOwo+ID4gICAJ
CQlpZiAoZmxhZ3MgJiBQSU5fTUFQUEFCTEUgJiYKPiA+IC0JCQkgICAgdm1hLT5mZW5jZV9zaXpl
ID4gZGV2X3ByaXYtPmdndHQubWFwcGFibGVfZW5kIC8gMikKPiA+ICsJCQkgICAgdm1hLT5mZW5j
ZV9zaXplID4gaTkxNS0+Z2d0dC5tYXBwYWJsZV9lbmQgLyAyKQo+ID4gICAJCQkJcmV0dXJuIEVS
Ul9QVFIoLUVOT1NQQyk7Cj4gPiAgIAkJfQo+ID4gQEAgLTEyMDIsMzAgKzEyMDIsMzAgQEAgdm9p
ZCBpOTE1X2dlbV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAg
CW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAgIH0KPiA+IC12b2lk
IGk5MTVfZ2VtX2luaXRfc3dpenpsaW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICt2b2lkIGk5MTVfZ2VtX2luaXRfc3dpenpsaW5nKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNSB8fAo+
ID4gLQkgICAgZGV2X3ByaXYtPm1tLmJpdF82X3N3aXp6bGVfeCA9PSBJOTE1X0JJVF82X1NXSVpa
TEVfTk9ORSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDUgfHwKPiA+ICsJICAgIGk5MTUt
Pm1tLmJpdF82X3N3aXp6bGVfeCA9PSBJOTE1X0JJVF82X1NXSVpaTEVfTk9ORSkKPiA+ICAgCQly
ZXR1cm47Cj4gPiAgIAlJOTE1X1dSSVRFKERJU1BfQVJCX0NUTCwgSTkxNV9SRUFEKERJU1BfQVJC
X0NUTCkgfAo+ID4gICAJCQkJIERJU1BfVElMRV9TVVJGQUNFX1NXSVpaTElORyk7Cj4gPiAtCWlm
IChJU19HRU4oZGV2X3ByaXYsIDUpKQo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDUpKQo+ID4gICAJ
CXJldHVybjsKPiA+ICAgCUk5MTVfV1JJVEUoVElMRUNUTCwgSTkxNV9SRUFEKFRJTEVDVEwpIHwg
VElMRUNUTF9TV1pDVEwpOwo+ID4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkKPiA+ICsJaWYg
KElTX0dFTihpOTE1LCA2KSkKPiA+ICAgCQlJOTE1X1dSSVRFKEFSQl9NT0RFLCBfTUFTS0VEX0JJ
VF9FTkFCTEUoQVJCX01PREVfU1dJWlpMRV9TTkIpKTsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOKGRl
dl9wcml2LCA3KSkKPiA+ICsJZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDcpKQo+ID4gICAJCUk5MTVf
V1JJVEUoQVJCX01PREUsIF9NQVNLRURfQklUX0VOQUJMRShBUkJfTU9ERV9TV0laWkxFX0lWQikp
Owo+ID4gLQllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDgpKQo+ID4gKwllbHNlIGlmIChJU19H
RU4oaTkxNSwgOCkpCj4gPiAgIAkJSTkxNV9XUklURShHQU1UQVJCTU9ERSwgX01BU0tFRF9CSVRf
RU5BQkxFKEFSQl9NT0RFX1NXSVpaTEVfQkRXKSk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJQlVHKCk7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbml0X3VudXNlZF9yaW5nKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGJhc2UpCj4gPiArc3RhdGljIHZvaWQgaW5pdF91bnVz
ZWRfcmluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGJhc2UpCj4gPiAgIHsK
PiA+ICAgCUk5MTVfV1JJVEUoUklOR19DVEwoYmFzZSksIDApOwo+ID4gICAJSTkxNV9XUklURShS
SU5HX0hFQUQoYmFzZSksIDApOwo+ID4gQEAgLTEyMzMsNDUgKzEyMzMsNDUgQEAgc3RhdGljIHZv
aWQgaW5pdF91bnVzZWRfcmluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUz
MiBiYXNlKQo+ID4gICAJSTkxNV9XUklURShSSU5HX1NUQVJUKGJhc2UpLCAwKTsKPiA+ICAgfQo+
ID4gLXN0YXRpYyB2b2lkIGluaXRfdW51c2VkX3JpbmdzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbml0X3VudXNlZF9yaW5ncyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoSVNfSTgzMChkZXZfcHJpdikp
IHsKPiA+IC0JCWluaXRfdW51c2VkX3JpbmcoZGV2X3ByaXYsIFBSQjFfQkFTRSk7Cj4gPiAtCQlp
bml0X3VudXNlZF9yaW5nKGRldl9wcml2LCBTUkIwX0JBU0UpOwo+ID4gLQkJaW5pdF91bnVzZWRf
cmluZyhkZXZfcHJpdiwgU1JCMV9CQVNFKTsKPiA+IC0JCWluaXRfdW51c2VkX3JpbmcoZGV2X3By
aXYsIFNSQjJfQkFTRSk7Cj4gPiAtCQlpbml0X3VudXNlZF9yaW5nKGRldl9wcml2LCBTUkIzX0JB
U0UpOwo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMikpIHsKPiA+IC0JCWluaXRf
dW51c2VkX3JpbmcoZGV2X3ByaXYsIFNSQjBfQkFTRSk7Cj4gPiAtCQlpbml0X3VudXNlZF9yaW5n
KGRldl9wcml2LCBTUkIxX0JBU0UpOwo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwg
MykpIHsKPiA+IC0JCWluaXRfdW51c2VkX3JpbmcoZGV2X3ByaXYsIFBSQjFfQkFTRSk7Cj4gPiAt
CQlpbml0X3VudXNlZF9yaW5nKGRldl9wcml2LCBQUkIyX0JBU0UpOwo+ID4gKwlpZiAoSVNfSTgz
MChpOTE1KSkgewo+ID4gKwkJaW5pdF91bnVzZWRfcmluZyhpOTE1LCBQUkIxX0JBU0UpOwo+ID4g
KwkJaW5pdF91bnVzZWRfcmluZyhpOTE1LCBTUkIwX0JBU0UpOwo+ID4gKwkJaW5pdF91bnVzZWRf
cmluZyhpOTE1LCBTUkIxX0JBU0UpOwo+ID4gKwkJaW5pdF91bnVzZWRfcmluZyhpOTE1LCBTUkIy
X0JBU0UpOwo+ID4gKwkJaW5pdF91bnVzZWRfcmluZyhpOTE1LCBTUkIzX0JBU0UpOwo+ID4gKwl9
IGVsc2UgaWYgKElTX0dFTihpOTE1LCAyKSkgewo+ID4gKwkJaW5pdF91bnVzZWRfcmluZyhpOTE1
LCBTUkIwX0JBU0UpOwo+ID4gKwkJaW5pdF91bnVzZWRfcmluZyhpOTE1LCBTUkIxX0JBU0UpOwo+
ID4gKwl9IGVsc2UgaWYgKElTX0dFTihpOTE1LCAzKSkgewo+ID4gKwkJaW5pdF91bnVzZWRfcmlu
ZyhpOTE1LCBQUkIxX0JBU0UpOwo+ID4gKwkJaW5pdF91bnVzZWRfcmluZyhpOTE1LCBQUkIyX0JB
U0UpOwo+ID4gICAJfQo+ID4gICB9Cj4gPiAtaW50IGk5MTVfZ2VtX2luaXRfaHcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludCBpOTE1X2dlbV9pbml0X2h3KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gLQlk
ZXZfcHJpdi0+Z3QubGFzdF9pbml0X3RpbWUgPSBrdGltZV9nZXQoKTsKPiA+ICsJaTkxNS0+Z3Qu
bGFzdF9pbml0X3RpbWUgPSBrdGltZV9nZXQoKTsKPiA+ICAgCS8qIERvdWJsZSBsYXllciBzZWN1
cml0eSBibGFua2V0LCBzZWUgaTkxNV9nZW1faW5pdCgpICovCj4gPiAtCWludGVsX3VuY29yZV9m
b3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICsJaW50
ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4g
PiAtCWlmIChIQVNfRURSQU0oZGV2X3ByaXYpICYmIElOVEVMX0dFTihkZXZfcHJpdikgPCA5KQo+
ID4gKwlpZiAoSEFTX0VEUkFNKGk5MTUpICYmIElOVEVMX0dFTihpOTE1KSA8IDkpCj4gPiAgIAkJ
STkxNV9XUklURShIU1dfSURJQ1IsIEk5MTVfUkVBRChIU1dfSURJQ1IpIHwgSURJSEFTSE1TSygw
eGYpKTsKPiA+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKQo+ID4gLQkJSTkxNV9XUklURShN
SV9QUkVESUNBVEVfUkVTVUxUXzIsIElTX0hTV19HVDMoZGV2X3ByaXYpID8KPiA+ICsJaWYgKElT
X0hBU1dFTEwoaTkxNSkpCj4gPiArCQlJOTE1X1dSSVRFKE1JX1BSRURJQ0FURV9SRVNVTFRfMiwg
SVNfSFNXX0dUMyhpOTE1KSA/Cj4gPiAgIAkJCSAgIExPV0VSX1NMSUNFX0VOQUJMRUQgOiBMT1dF
Ul9TTElDRV9ESVNBQkxFRCk7Cj4gPiAgIAkvKiBBcHBseSB0aGUgR1Qgd29ya2Fyb3VuZHMuLi4g
Ki8KPiA+IC0JaW50ZWxfZ3RfYXBwbHlfd29ya2Fyb3VuZHMoZGV2X3ByaXYpOwo+ID4gKwlpbnRl
bF9ndF9hcHBseV93b3JrYXJvdW5kcyhpOTE1KTsKPiA+ICAgCS8qIC4uLmFuZCBkZXRlcm1pbmUg
d2hldGhlciB0aGV5IGFyZSBzdGlja2luZy4gKi8KPiA+IC0JaW50ZWxfZ3RfdmVyaWZ5X3dvcmth
cm91bmRzKGRldl9wcml2LCAiaW5pdCIpOwo+ID4gKwlpbnRlbF9ndF92ZXJpZnlfd29ya2Fyb3Vu
ZHMoaTkxNSwgImluaXQiKTsKPiA+IC0JaTkxNV9nZW1faW5pdF9zd2l6emxpbmcoZGV2X3ByaXYp
Owo+ID4gKwlpOTE1X2dlbV9pbml0X3N3aXp6bGluZyhpOTE1KTsKPiA+ICAgCS8qCj4gPiAgIAkg
KiBBdCBsZWFzdCA4MzAgY2FuIGxlYXZlIHNvbWUgb2YgdGhlIHVudXNlZCByaW5ncwo+ID4gQEAg
LTEyNzksNDggKzEyNzksNDggQEAgaW50IGk5MTVfZ2VtX2luaXRfaHcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICogd2lsbCBwcmV2ZW50IGMzIGVudHJ5LiBNYWtl
cyBzdXJlIGFsbCB1bnVzZWQgcmluZ3MKPiA+ICAgCSAqIGFyZSB0b3RhbGx5IGlkbGUuCj4gPiAg
IAkgKi8KPiA+IC0JaW5pdF91bnVzZWRfcmluZ3MoZGV2X3ByaXYpOwo+ID4gKwlpbml0X3VudXNl
ZF9yaW5ncyhpOTE1KTsKPiA+IC0JQlVHX09OKCFkZXZfcHJpdi0+a2VybmVsX2NvbnRleHQpOwo+
ID4gLQlyZXQgPSBpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGRldl9wcml2KTsKPiA+ICsJQlVHX09O
KCFpOTE1LT5rZXJuZWxfY29udGV4dCk7Cj4gPiArCXJldCA9IGk5MTVfdGVybWluYWxseV93ZWRn
ZWQoaTkxNSk7Cj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCWdvdG8gb3V0Owo+ID4gLQlyZXQgPSBp
OTE1X3BwZ3R0X2luaXRfaHcoZGV2X3ByaXYpOwo+ID4gKwlyZXQgPSBpOTE1X3BwZ3R0X2luaXRf
aHcoaTkxNSk7Cj4gPiAgIAlpZiAocmV0KSB7Cj4gPiAgIAkJRFJNX0VSUk9SKCJFbmFibGluZyBQ
UEdUVCBmYWlsZWQgKCVkKVxuIiwgcmV0KTsKPiA+ICAgCQlnb3RvIG91dDsKPiA+ICAgCX0KPiA+
IC0JcmV0ID0gaW50ZWxfd29wY21faW5pdF9odygmZGV2X3ByaXYtPndvcGNtKTsKPiA+ICsJcmV0
ID0gaW50ZWxfd29wY21faW5pdF9odygmaTkxNS0+d29wY20pOwo+ID4gICAJaWYgKHJldCkgewo+
ID4gICAJCURSTV9FUlJPUigiRW5hYmxpbmcgV09QQ00gZmFpbGVkICglZClcbiIsIHJldCk7Cj4g
PiAgIAkJZ290byBvdXQ7Cj4gPiAgIAl9Cj4gPiAgIAkvKiBXZSBjYW4ndCBlbmFibGUgY29udGV4
dHMgdW50aWwgYWxsIGZpcm13YXJlIGlzIGxvYWRlZCAqLwo+ID4gLQlyZXQgPSBpbnRlbF91Y19p
bml0X2h3KGRldl9wcml2KTsKPiA+ICsJcmV0ID0gaW50ZWxfdWNfaW5pdF9odyhpOTE1KTsKPiA+
ICAgCWlmIChyZXQpIHsKPiA+ICAgCQlEUk1fRVJST1IoIkVuYWJsaW5nIHVjIGZhaWxlZCAoJWQp
XG4iLCByZXQpOwo+ID4gICAJCWdvdG8gb3V0Owo+ID4gICAJfQo+ID4gLQlpbnRlbF9tb2NzX2lu
aXRfbDNjY190YWJsZShkZXZfcHJpdik7Cj4gPiArCWludGVsX21vY3NfaW5pdF9sM2NjX3RhYmxl
KGk5MTUpOwo+ID4gICAJLyogT25seSB3aGVuIHRoZSBIVyBpcyByZS1pbml0aWFsaXNlZCwgY2Fu
IHdlIHJlcGxheSB0aGUgcmVxdWVzdHMgKi8KPiA+IC0JcmV0ID0gaW50ZWxfZW5naW5lc19yZXN1
bWUoZGV2X3ByaXYpOwo+ID4gKwlyZXQgPSBpbnRlbF9lbmdpbmVzX3Jlc3VtZShpOTE1KTsKPiA+
ICAgCWlmIChyZXQpCj4gPiAgIAkJZ290byBjbGVhbnVwX3VjOwo+ID4gLQlpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCWlu
dGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+
ID4gLQlpbnRlbF9lbmdpbmVzX3NldF9zY2hlZHVsZXJfY2FwcyhkZXZfcHJpdik7Cj4gPiArCWlu
dGVsX2VuZ2luZXNfc2V0X3NjaGVkdWxlcl9jYXBzKGk5MTUpOwo+ID4gICAJcmV0dXJuIDA7Cj4g
PiAgIGNsZWFudXBfdWM6Cj4gPiAtCWludGVsX3VjX2ZpbmlfaHcoZGV2X3ByaXYpOwo+ID4gKwlp
bnRlbF91Y19maW5pX2h3KGk5MTUpOwo+ID4gICBvdXQ6Cj4gPiAtCWludGVsX3VuY29yZV9mb3Jj
ZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICsJaW50ZWxf
dW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiAg
IAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtMTUwNSwyOCArMTUwNSwyOCBAQCBzdGF0aWMg
aW50IGludGVsX2VuZ2luZXNfdmVyaWZ5X3dvcmthcm91bmRzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ID4gICAJcmV0dXJuIGVycjsKPiA+ICAgfQo+ID4gLWludCBpOTE1X2dlbV9p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQgaTkxNV9nZW1f
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJaW50IHJl
dDsKPiA+ICAgCS8qIFdlIG5lZWQgdG8gZmFsbGJhY2sgdG8gNEsgcGFnZXMgaWYgaG9zdCBkb2Vz
bid0IHN1cHBvcnQgaHVnZSBndHQuICovCj4gPiAtCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShkZXZf
cHJpdikgJiYgIWludGVsX3ZncHVfaGFzX2h1Z2VfZ3R0KGRldl9wcml2KSkKPiA+IC0JCW1rd3Jp
dGVfZGV2aWNlX2luZm8oZGV2X3ByaXYpLT5wYWdlX3NpemVzID0KPiA+ICsJaWYgKGludGVsX3Zn
cHVfYWN0aXZlKGk5MTUpICYmICFpbnRlbF92Z3B1X2hhc19odWdlX2d0dChpOTE1KSkKPiA+ICsJ
CW1rd3JpdGVfZGV2aWNlX2luZm8oaTkxNSktPnBhZ2Vfc2l6ZXMgPQo+ID4gICAJCQlJOTE1X0dU
VF9QQUdFX1NJWkVfNEs7Cj4gPiAtCWRldl9wcml2LT5tbS51bm9yZGVyZWRfdGltZWxpbmUgPSBk
bWFfZmVuY2VfY29udGV4dF9hbGxvYygxKTsKPiA+ICsJaTkxNS0+bW0udW5vcmRlcmVkX3RpbWVs
aW5lID0gZG1hX2ZlbmNlX2NvbnRleHRfYWxsb2MoMSk7Cj4gPiAtCWk5MTVfdGltZWxpbmVzX2lu
aXQoZGV2X3ByaXYpOwo+ID4gKwlpOTE1X3RpbWVsaW5lc19pbml0KGk5MTUpOwo+ID4gLQlyZXQg
PSBpOTE1X2dlbV9pbml0X3VzZXJwdHIoZGV2X3ByaXYpOwo+ID4gKwlyZXQgPSBpOTE1X2dlbV9p
bml0X3VzZXJwdHIoaTkxNSk7Cj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCXJldHVybiByZXQ7Cj4g
PiAtCXJldCA9IGludGVsX3VjX2luaXRfbWlzYyhkZXZfcHJpdik7Cj4gPiArCXJldCA9IGludGVs
X3VjX2luaXRfbWlzYyhpOTE1KTsKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJcmV0dXJuIHJldDsK
PiA+IC0JcmV0ID0gaW50ZWxfd29wY21faW5pdCgmZGV2X3ByaXYtPndvcGNtKTsKPiA+ICsJcmV0
ID0gaW50ZWxfd29wY21faW5pdCgmaTkxNS0+d29wY20pOwo+ID4gICAJaWYgKHJldCkKPiA+ICAg
CQlnb3RvIGVycl91Y19taXNjOwo+ID4gQEAgLTE1MzYsNDcgKzE1MzYsNDcgQEAgaW50IGk5MTVf
Z2VtX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICogd2Ug
aG9sZCB0aGUgZm9yY2V3YWtlIGR1cmluZyBpbml0aWFsaXNhdGlvbiB0aGVzZSBwcm9ibGVtcwo+
ID4gICAJICoganVzdCBtYWdpY2FsbHkgZ28gYXdheS4KPiA+ICAgCSAqLwo+ID4gLQltdXRleF9s
b2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAtCWludGVsX3VuY29yZV9mb3Jj
ZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICsJbXV0ZXhf
bG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCWludGVsX3VuY29yZV9mb3JjZXdh
a2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gLQlyZXQgPSBpOTE1X2dl
bV9pbml0X2dndHQoZGV2X3ByaXYpOwo+ID4gKwlyZXQgPSBpOTE1X2dlbV9pbml0X2dndHQoaTkx
NSk7Cj4gPiAgIAlpZiAocmV0KSB7Cj4gPiAgIAkJR0VNX0JVR19PTihyZXQgPT0gLUVJTyk7Cj4g
PiAgIAkJZ290byBlcnJfdW5sb2NrOwo+ID4gICAJfQo+ID4gLQlyZXQgPSBpOTE1X2dlbV9pbml0
X3NjcmF0Y2goZGV2X3ByaXYsCj4gPiAtCQkJCSAgICBJU19HRU4oZGV2X3ByaXYsIDIpID8gU1pf
MjU2SyA6IFBBR0VfU0laRSk7Cj4gPiArCXJldCA9IGk5MTVfZ2VtX2luaXRfc2NyYXRjaChpOTE1
LAo+ID4gKwkJCQkgICAgSVNfR0VOKGk5MTUsIDIpID8gU1pfMjU2SyA6IFBBR0VfU0laRSk7Cj4g
PiAgIAlpZiAocmV0KSB7Cj4gPiAgIAkJR0VNX0JVR19PTihyZXQgPT0gLUVJTyk7Cj4gPiAgIAkJ
Z290byBlcnJfZ2d0dDsKPiA+ICAgCX0KPiA+IC0JcmV0ID0gaW50ZWxfZW5naW5lc19zZXR1cChk
ZXZfcHJpdik7Cj4gPiArCXJldCA9IGludGVsX2VuZ2luZXNfc2V0dXAoaTkxNSk7Cj4gPiAgIAlp
ZiAocmV0KSB7Cj4gPiAgIAkJR0VNX0JVR19PTihyZXQgPT0gLUVJTyk7Cj4gPiAgIAkJZ290byBl
cnJfdW5sb2NrOwo+ID4gICAJfQo+ID4gLQlyZXQgPSBpOTE1X2dlbV9jb250ZXh0c19pbml0KGRl
dl9wcml2KTsKPiA+ICsJcmV0ID0gaTkxNV9nZW1fY29udGV4dHNfaW5pdChpOTE1KTsKPiA+ICAg
CWlmIChyZXQpIHsKPiA+ICAgCQlHRU1fQlVHX09OKHJldCA9PSAtRUlPKTsKPiA+ICAgCQlnb3Rv
IGVycl9zY3JhdGNoOwo+ID4gICAJfQo+ID4gLQlyZXQgPSBpbnRlbF9lbmdpbmVzX2luaXQoZGV2
X3ByaXYpOwo+ID4gKwlyZXQgPSBpbnRlbF9lbmdpbmVzX2luaXQoaTkxNSk7Cj4gPiAgIAlpZiAo
cmV0KSB7Cj4gPiAgIAkJR0VNX0JVR19PTihyZXQgPT0gLUVJTyk7Cj4gPiAgIAkJZ290byBlcnJf
Y29udGV4dDsKPiA+ICAgCX0KPiA+IC0JaW50ZWxfaW5pdF9ndF9wb3dlcnNhdmUoZGV2X3ByaXYp
Owo+ID4gKwlpbnRlbF9pbml0X2d0X3Bvd2Vyc2F2ZShpOTE1KTsKPiA+IC0JcmV0ID0gaW50ZWxf
dWNfaW5pdChkZXZfcHJpdik7Cj4gPiArCXJldCA9IGludGVsX3VjX2luaXQoaTkxNSk7Cj4gPiAg
IAlpZiAocmV0KQo+ID4gICAJCWdvdG8gZXJyX3BtOwo+ID4gLQlyZXQgPSBpOTE1X2dlbV9pbml0
X2h3KGRldl9wcml2KTsKPiA+ICsJcmV0ID0gaTkxNV9nZW1faW5pdF9odyhpOTE1KTsKPiA+ICAg
CWlmIChyZXQpCj4gPiAgIAkJZ290byBlcnJfdWNfaW5pdDsKPiA+IEBAIC0xNTg5LDEzICsxNTg5
LDEzIEBAIGludCBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICAgCSAqCj4gPiAgIAkgKiBGSVhNRTogYnJlYWsgdXAgdGhlIHdvcmthcm91bmRzIGFu
ZCBhcHBseSB0aGVtIGF0IHRoZSByaWdodCB0aW1lIQo+ID4gICAJICovCj4gPiAtCWludGVsX2lu
aXRfY2xvY2tfZ2F0aW5nKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfaW5pdF9jbG9ja19nYXRpbmco
aTkxNSk7Cj4gPiAtCXJldCA9IGludGVsX2VuZ2luZXNfdmVyaWZ5X3dvcmthcm91bmRzKGRldl9w
cml2KTsKPiA+ICsJcmV0ID0gaW50ZWxfZW5naW5lc192ZXJpZnlfd29ya2Fyb3VuZHMoaTkxNSk7
Cj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCWdvdG8gZXJyX2luaXRfaHc7Cj4gPiAtCXJldCA9IF9f
aW50ZWxfZW5naW5lc19yZWNvcmRfZGVmYXVsdHMoZGV2X3ByaXYpOwo+ID4gKwlyZXQgPSBfX2lu
dGVsX2VuZ2luZXNfcmVjb3JkX2RlZmF1bHRzKGk5MTUpOwo+ID4gICAJaWYgKHJldCkKPiA+ICAg
CQlnb3RvIGVycl9pbml0X2h3Owo+ID4gQEAgLTE2MDksOCArMTYwOSw4IEBAIGludCBpOTE1X2dl
bV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQlnb3RvIGVy
cl9pbml0X2h3Owo+ID4gICAJfQo+ID4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2
X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgm
aTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKPiA+ICAgCXJldHVybiAwOwo+ID4gQEAgLTE2MjEsMTA3ICsxNjIx
LDEwNyBAQCBpbnQgaTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiAgIAkgKiBkcml2ZXIgZG9lc24ndCBleHBsb2RlIGR1cmluZyBydW50aW1lLgo+ID4g
ICAJICovCj4gPiAgIGVycl9pbml0X2h3Ogo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5k
cm0uc3RydWN0X211dGV4KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKPiA+IC0JaTkxNV9nZW1fc2V0X3dlZGdlZChkZXZfcHJpdik7Cj4gPiAtCWk5MTVfZ2Vt
X3N1c3BlbmQoZGV2X3ByaXYpOwo+ID4gLQlpOTE1X2dlbV9zdXNwZW5kX2xhdGUoZGV2X3ByaXYp
Owo+ID4gKwlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOwo+ID4gKwlpOTE1X2dlbV9zdXNwZW5k
KGk5MTUpOwo+ID4gKwlpOTE1X2dlbV9zdXNwZW5kX2xhdGUoaTkxNSk7Cj4gPiAtCWk5MTVfZ2Vt
X2RyYWluX3dvcmtxdWV1ZShkZXZfcHJpdik7Cj4gPiArCWk5MTVfZ2VtX2RyYWluX3dvcmtxdWV1
ZShpOTE1KTsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+
ID4gLQlpbnRlbF91Y19maW5pX2h3KGRldl9wcml2KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCWludGVsX3VjX2ZpbmlfaHcoaTkxNSk7Cj4gPiAgIGVy
cl91Y19pbml0Ogo+ID4gLQlpbnRlbF91Y19maW5pKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfdWNf
ZmluaShpOTE1KTsKPiA+ICAgZXJyX3BtOgo+ID4gICAJaWYgKHJldCAhPSAtRUlPKSB7Cj4gPiAt
CQlpbnRlbF9jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShkZXZfcHJpdik7Cj4gPiAtCQlpbnRlbF9lbmdp
bmVzX2NsZWFudXAoZGV2X3ByaXYpOwo+ID4gKwkJaW50ZWxfY2xlYW51cF9ndF9wb3dlcnNhdmUo
aTkxNSk7Cj4gPiArCQlpbnRlbF9lbmdpbmVzX2NsZWFudXAoaTkxNSk7Cj4gPiAgIAl9Cj4gPiAg
IGVycl9jb250ZXh0Ogo+ID4gICAJaWYgKHJldCAhPSAtRUlPKQo+ID4gLQkJaTkxNV9nZW1fY29u
dGV4dHNfZmluaShkZXZfcHJpdik7Cj4gPiArCQlpOTE1X2dlbV9jb250ZXh0c19maW5pKGk5MTUp
Owo+ID4gICBlcnJfc2NyYXRjaDoKPiA+IC0JaTkxNV9nZW1fZmluaV9zY3JhdGNoKGRldl9wcml2
KTsKPiA+ICsJaTkxNV9nZW1fZmluaV9zY3JhdGNoKGk5MTUpOwo+ID4gICBlcnJfZ2d0dDoKPiA+
ICAgZXJyX3VubG9jazoKPiA+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2
LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5k
cm0uc3RydWN0X211dGV4KTsKPiA+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUt
PnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7Cj4gPiAgIGVycl91Y19taXNjOgo+ID4gLQlpbnRlbF91Y19maW5pX21pc2Mo
ZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF91Y19maW5pX21pc2MoaTkxNSk7Cj4gPiAgIAlpZiAocmV0
ICE9IC1FSU8pIHsKPiA+IC0JCWk5MTVfZ2VtX2NsZWFudXBfdXNlcnB0cihkZXZfcHJpdik7Cj4g
PiAtCQlpOTE1X3RpbWVsaW5lc19maW5pKGRldl9wcml2KTsKPiA+ICsJCWk5MTVfZ2VtX2NsZWFu
dXBfdXNlcnB0cihpOTE1KTsKPiA+ICsJCWk5MTVfdGltZWxpbmVzX2ZpbmkoaTkxNSk7Cj4gPiAg
IAl9Cj4gPiAgIAlpZiAocmV0ID09IC1FSU8pIHsKPiA+IC0JCW11dGV4X2xvY2soJmRldl9wcml2
LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwo+ID4gICAJCS8qCj4gPiAgIAkJICogQWxsb3cgZW5naW5lIGluaXRpYWxpc2F0aW9u
IHRvIGZhaWwgYnkgbWFya2luZyB0aGUgR1BVIGFzCj4gPiAgIAkJICogd2VkZ2VkLiBCdXQgd2Ug
b25seSB3YW50IHRvIGRvIHRoaXMgd2hlcmUgdGhlIEdQVSBpcyBhbmdyeSwKPiA+ICAgCQkgKiBm
b3IgYWxsIG90aGVyIGZhaWx1cmUsIHN1Y2ggYXMgYW4gYWxsb2NhdGlvbiBmYWlsdXJlLCBiYWls
Lgo+ID4gICAJCSAqLwo+ID4gLQkJaWYgKCFpOTE1X3Jlc2V0X2ZhaWxlZChkZXZfcHJpdikpIHsK
PiA+IC0JCQlpOTE1X2xvYWRfZXJyb3IoZGV2X3ByaXYsCj4gPiArCQlpZiAoIWk5MTVfcmVzZXRf
ZmFpbGVkKGk5MTUpKSB7Cj4gPiArCQkJaTkxNV9sb2FkX2Vycm9yKGk5MTUsCj4gPiAgIAkJCQkJ
IkZhaWxlZCB0byBpbml0aWFsaXplIEdQVSwgZGVjbGFyaW5nIGl0IHdlZGdlZCFcbiIpOwo+ID4g
LQkJCWk5MTVfZ2VtX3NldF93ZWRnZWQoZGV2X3ByaXYpOwo+ID4gKwkJCWk5MTVfZ2VtX3NldF93
ZWRnZWQoaTkxNSk7Cj4gPiAgIAkJfQo+ID4gICAJCS8qIE1pbmltYWwgYmFzaWMgcmVjb3Zlcnkg
Zm9yIEtNUyAqLwo+ID4gLQkJcmV0ID0gaTkxNV9nZ3R0X2VuYWJsZV9odyhkZXZfcHJpdik7Cj4g
PiAtCQlpOTE1X2dlbV9yZXN0b3JlX2d0dF9tYXBwaW5ncyhkZXZfcHJpdik7Cj4gPiAtCQlpOTE1
X2dlbV9yZXN0b3JlX2ZlbmNlcyhkZXZfcHJpdik7Cj4gPiAtCQlpbnRlbF9pbml0X2Nsb2NrX2dh
dGluZyhkZXZfcHJpdik7Cj4gPiArCQlyZXQgPSBpOTE1X2dndHRfZW5hYmxlX2h3KGk5MTUpOwo+
ID4gKwkJaTkxNV9nZW1fcmVzdG9yZV9ndHRfbWFwcGluZ3MoaTkxNSk7Cj4gPiArCQlpOTE1X2dl
bV9yZXN0b3JlX2ZlbmNlcyhpOTE1KTsKPiA+ICsJCWludGVsX2luaXRfY2xvY2tfZ2F0aW5nKGk5
MTUpOwo+ID4gLQkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4g
PiArCQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICAJfQo+ID4g
LQlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGRldl9wcml2KTsKPiA+ICsJaTkxNV9nZW1f
ZHJhaW5fZnJlZWRfb2JqZWN0cyhpOTE1KTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+
IC12b2lkIGk5MTVfZ2VtX2ZpbmlfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gK3ZvaWQgaTkxNV9nZW1fZmluaV9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiA+ICAgewo+ID4gLQlHRU1fQlVHX09OKGRldl9wcml2LT5ndC5hd2FrZSk7Cj4gPiArCUdF
TV9CVUdfT04oaTkxNS0+Z3QuYXdha2UpOwo+ID4gLQlpbnRlbF93YWtlcmVmX2F1dG9fZmluaSgm
ZGV2X3ByaXYtPm1tLnVzZXJmYXVsdF93YWtlcmVmKTsKPiA+ICsJaW50ZWxfd2FrZXJlZl9hdXRv
X2ZpbmkoJmk5MTUtPm1tLnVzZXJmYXVsdF93YWtlcmVmKTsKPiA+IC0JaTkxNV9nZW1fc3VzcGVu
ZF9sYXRlKGRldl9wcml2KTsKPiA+IC0JaW50ZWxfZGlzYWJsZV9ndF9wb3dlcnNhdmUoZGV2X3By
aXYpOwo+ID4gKwlpOTE1X2dlbV9zdXNwZW5kX2xhdGUoaTkxNSk7Cj4gPiArCWludGVsX2Rpc2Fi
bGVfZ3RfcG93ZXJzYXZlKGk5MTUpOwo+ID4gICAJLyogRmx1c2ggYW55IG91dHN0YW5kaW5nIHVu
cGluX3dvcmsuICovCj4gPiAtCWk5MTVfZ2VtX2RyYWluX3dvcmtxdWV1ZShkZXZfcHJpdik7Cj4g
PiArCWk5MTVfZ2VtX2RyYWluX3dvcmtxdWV1ZShpOTE1KTsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2
X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQlpbnRlbF91Y19maW5pX2h3KGRldl9wcml2
KTsKPiA+IC0JaW50ZWxfdWNfZmluaShkZXZfcHJpdik7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2
X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKPiA+ICsJaW50ZWxfdWNfZmluaV9odyhpOTE1KTsKPiA+ICsJaW50ZWxfdWNf
ZmluaShpOTE1KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
PiA+IC0JaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhkZXZfcHJpdik7Cj4gPiArCWk5MTVf
Z2VtX2RyYWluX2ZyZWVkX29iamVjdHMoaTkxNSk7Cj4gPiAgIH0KPiA+IC12b2lkIGk5MTVfZ2Vt
X2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaTkxNV9n
ZW1fZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQltdXRl
eF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAtCWludGVsX2VuZ2luZXNf
Y2xlYW51cChkZXZfcHJpdik7Cj4gPiAtCWk5MTVfZ2VtX2NvbnRleHRzX2ZpbmkoZGV2X3ByaXYp
Owo+ID4gLQlpOTE1X2dlbV9maW5pX3NjcmF0Y2goZGV2X3ByaXYpOwo+ID4gLQltdXRleF91bmxv
Y2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCWludGVsX2VuZ2luZXNfY2xlYW51cChpOTE1KTsKPiA+
ICsJaTkxNV9nZW1fY29udGV4dHNfZmluaShpOTE1KTsKPiA+ICsJaTkxNV9nZW1fZmluaV9zY3Jh
dGNoKGk5MTUpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+
ID4gLQlpbnRlbF93YV9saXN0X2ZyZWUoJmRldl9wcml2LT5ndF93YV9saXN0KTsKPiA+ICsJaW50
ZWxfd2FfbGlzdF9mcmVlKCZpOTE1LT5ndF93YV9saXN0KTsKPiA+IC0JaW50ZWxfY2xlYW51cF9n
dF9wb3dlcnNhdmUoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShp
OTE1KTsKPiA+IC0JaW50ZWxfdWNfZmluaV9taXNjKGRldl9wcml2KTsKPiA+IC0JaTkxNV9nZW1f
Y2xlYW51cF91c2VycHRyKGRldl9wcml2KTsKPiA+IC0JaTkxNV90aW1lbGluZXNfZmluaShkZXZf
cHJpdik7Cj4gPiArCWludGVsX3VjX2ZpbmlfbWlzYyhpOTE1KTsKPiA+ICsJaTkxNV9nZW1fY2xl
YW51cF91c2VycHRyKGk5MTUpOwo+ID4gKwlpOTE1X3RpbWVsaW5lc19maW5pKGk5MTUpOwo+ID4g
LQlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGRldl9wcml2KTsKPiA+ICsJaTkxNV9nZW1f
ZHJhaW5fZnJlZWRfb2JqZWN0cyhpOTE1KTsKPiA+IC0JV0FSTl9PTighbGlzdF9lbXB0eSgmZGV2
X3ByaXYtPmNvbnRleHRzLmxpc3QpKTsKPiA+ICsJV0FSTl9PTighbGlzdF9lbXB0eSgmaTkxNS0+
Y29udGV4dHMubGlzdCkpOwo+ID4gICB9Cj4gPiAgIHZvaWQgaTkxNV9nZW1faW5pdF9tbWlvKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gQEAgLTE3MzAsMzUgKzE3MzAsMzUgQEAg
dm9pZCBpOTE1X2dlbV9pbml0X21taW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIH0KPiA+ICAgdm9pZAo+ID4gLWk5MTVfZ2VtX2xvYWRfaW5pdF9mZW5jZXMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2k5MTVfZ2VtX2xvYWRfaW5pdF9mZW5jZXMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWludCBpOwo+ID4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA3ICYmICFJU19WQUxMRVlWSUVXKGRldl9wcml2
KSAmJgo+ID4gLQkgICAgIUlTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYt
Pm51bV9mZW5jZV9yZWdzID0gMzI7Cj4gPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gNCB8fAo+ID4gLQkJIElTX0k5NDVHKGRldl9wcml2KSB8fCBJU19JOTQ1R00oZGV2X3ByaXYp
IHx8Cj4gPiAtCQkgSVNfRzMzKGRldl9wcml2KSB8fCBJU19QSU5FVklFVyhkZXZfcHJpdikpCj4g
PiAtCQlkZXZfcHJpdi0+bnVtX2ZlbmNlX3JlZ3MgPSAxNjsKPiA+ICsJaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA3ICYmICFJU19WQUxMRVlWSUVXKGk5MTUpICYmCj4gPiArCSAgICAhSVNfQ0hFUlJZ
VklFVyhpOTE1KSkKPiA+ICsJCWk5MTUtPm51bV9mZW5jZV9yZWdzID0gMzI7Cj4gPiArCWVsc2Ug
aWYgKElOVEVMX0dFTihpOTE1KSA+PSA0IHx8Cj4gPiArCQkgSVNfSTk0NUcoaTkxNSkgfHwgSVNf
STk0NUdNKGk5MTUpIHx8Cj4gPiArCQkgSVNfRzMzKGk5MTUpIHx8IElTX1BJTkVWSUVXKGk5MTUp
KQo+ID4gKwkJaTkxNS0+bnVtX2ZlbmNlX3JlZ3MgPSAxNjsKPiA+ICAgCWVsc2UKPiA+IC0JCWRl
dl9wcml2LT5udW1fZmVuY2VfcmVncyA9IDg7Cj4gPiArCQlpOTE1LT5udW1fZmVuY2VfcmVncyA9
IDg7Cj4gPiAtCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShkZXZfcHJpdikpCj4gPiAtCQlkZXZfcHJp
di0+bnVtX2ZlbmNlX3JlZ3MgPQo+ID4gKwlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoaTkxNSkpCj4g
PiArCQlpOTE1LT5udW1fZmVuY2VfcmVncyA9Cj4gPiAgIAkJCQlJOTE1X1JFQUQodmd0aWZfcmVn
KGF2YWlsX3JzLmZlbmNlX251bSkpOwo+ID4gICAJLyogSW5pdGlhbGl6ZSBmZW5jZSByZWdpc3Rl
cnMgdG8gemVybyAqLwo+ID4gLQlmb3IgKGkgPSAwOyBpIDwgZGV2X3ByaXYtPm51bV9mZW5jZV9y
ZWdzOyBpKyspIHsKPiA+IC0JCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlID0gJmRl
dl9wcml2LT5mZW5jZV9yZWdzW2ldOwo+ID4gKwlmb3IgKGkgPSAwOyBpIDwgaTkxNS0+bnVtX2Zl
bmNlX3JlZ3M7IGkrKykgewo+ID4gKwkJc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2Ug
PSAmaTkxNS0+ZmVuY2VfcmVnc1tpXTsKPiA+IC0JCWZlbmNlLT5pOTE1ID0gZGV2X3ByaXY7Cj4g
PiArCQlmZW5jZS0+aTkxNSA9IGk5MTU7Cj4gPiAgIAkJZmVuY2UtPmlkID0gaTsKPiA+IC0JCWxp
c3RfYWRkX3RhaWwoJmZlbmNlLT5saW5rLCAmZGV2X3ByaXYtPm1tLmZlbmNlX2xpc3QpOwo+ID4g
KwkJbGlzdF9hZGRfdGFpbCgmZmVuY2UtPmxpbmssICZpOTE1LT5tbS5mZW5jZV9saXN0KTsKPiA+
ICAgCX0KPiA+IC0JaTkxNV9nZW1fcmVzdG9yZV9mZW5jZXMoZGV2X3ByaXYpOwo+ID4gKwlpOTE1
X2dlbV9yZXN0b3JlX2ZlbmNlcyhpOTE1KTsKPiA+IC0JaTkxNV9nZW1fZGV0ZWN0X2JpdF82X3N3
aXp6bGUoZGV2X3ByaXYpOwo+ID4gKwlpOTE1X2dlbV9kZXRlY3RfYml0XzZfc3dpenpsZShpOTE1
KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBpOTE1X2dlbV9pbml0X19tbShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+IEBAIC0xNzc4LDU2ICsxNzc4LDU2IEBAIHN0YXRpYyB2
b2lkIGk5MTVfZ2VtX2luaXRfX21tKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4g
ICAJaTkxNV9nZW1faW5pdF9fb2JqZWN0cyhpOTE1KTsKPiA+ICAgfQo+ID4gLWludCBpOTE1X2dl
bV9pbml0X2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQg
aTkxNV9nZW1faW5pdF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAg
ewo+ID4gICAJc3RhdGljIHN0cnVjdCBsb2NrX2NsYXNzX2tleSByZXNldF9rZXk7Cj4gPiAgIAlp
bnQgZXJyOwo+ID4gLQlpbnRlbF9ndF9wbV9pbml0KGRldl9wcml2KTsKPiA+ICsJaW50ZWxfZ3Rf
cG1faW5pdChpOTE1KTsKPiA+IC0JSU5JVF9MSVNUX0hFQUQoJmRldl9wcml2LT5ndC5hY3RpdmVf
cmluZ3MpOwo+ID4gLQlJTklUX0xJU1RfSEVBRCgmZGV2X3ByaXYtPmd0LmNsb3NlZF92bWEpOwo+
ID4gLQlzcGluX2xvY2tfaW5pdCgmZGV2X3ByaXYtPmd0LmNsb3NlZF9sb2NrKTsKPiA+IC0JbG9j
a2RlcF9pbml0X21hcCgmZGV2X3ByaXYtPmd0LnJlc2V0X2xvY2ttYXAsCj4gPiArCUlOSVRfTElT
VF9IRUFEKCZpOTE1LT5ndC5hY3RpdmVfcmluZ3MpOwo+ID4gKwlJTklUX0xJU1RfSEVBRCgmaTkx
NS0+Z3QuY2xvc2VkX3ZtYSk7Cj4gPiArCXNwaW5fbG9ja19pbml0KCZpOTE1LT5ndC5jbG9zZWRf
bG9jayk7Cj4gPiArCWxvY2tkZXBfaW5pdF9tYXAoJmk5MTUtPmd0LnJlc2V0X2xvY2ttYXAsCj4g
PiAgIAkJCSAiaTkxNS5yZXNldCIsICZyZXNldF9rZXksIDApOwo+ID4gLQlpOTE1X2dlbV9pbml0
X19tbShkZXZfcHJpdik7Cj4gPiAtCWk5MTVfZ2VtX2luaXRfX3BtKGRldl9wcml2KTsKPiA+ICsJ
aTkxNV9nZW1faW5pdF9fbW0oaTkxNSk7Cj4gPiArCWk5MTVfZ2VtX2luaXRfX3BtKGk5MTUpOwo+
ID4gLQlpbml0X3dhaXRxdWV1ZV9oZWFkKCZkZXZfcHJpdi0+Z3B1X2Vycm9yLndhaXRfcXVldWUp
Owo+ID4gLQlpbml0X3dhaXRxdWV1ZV9oZWFkKCZkZXZfcHJpdi0+Z3B1X2Vycm9yLnJlc2V0X3F1
ZXVlKTsKPiA+IC0JbXV0ZXhfaW5pdCgmZGV2X3ByaXYtPmdwdV9lcnJvci53ZWRnZV9tdXRleCk7
Cj4gPiAtCWluaXRfc3JjdV9zdHJ1Y3QoJmRldl9wcml2LT5ncHVfZXJyb3IucmVzZXRfYmFja29m
Zl9zcmN1KTsKPiA+ICsJaW5pdF93YWl0cXVldWVfaGVhZCgmaTkxNS0+Z3B1X2Vycm9yLndhaXRf
cXVldWUpOwo+ID4gKwlpbml0X3dhaXRxdWV1ZV9oZWFkKCZpOTE1LT5ncHVfZXJyb3IucmVzZXRf
cXVldWUpOwo+ID4gKwltdXRleF9pbml0KCZpOTE1LT5ncHVfZXJyb3Iud2VkZ2VfbXV0ZXgpOwo+
ID4gKwlpbml0X3NyY3Vfc3RydWN0KCZpOTE1LT5ncHVfZXJyb3IucmVzZXRfYmFja29mZl9zcmN1
KTsKPiA+IC0JYXRvbWljX3NldCgmZGV2X3ByaXYtPm1tLmJzZF9lbmdpbmVfZGlzcGF0Y2hfaW5k
ZXgsIDApOwo+ID4gKwlhdG9taWNfc2V0KCZpOTE1LT5tbS5ic2RfZW5naW5lX2Rpc3BhdGNoX2lu
ZGV4LCAwKTsKPiA+IC0Jc3Bpbl9sb2NrX2luaXQoJmRldl9wcml2LT5mYl90cmFja2luZy5sb2Nr
KTsKPiA+ICsJc3Bpbl9sb2NrX2luaXQoJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwo+ID4gLQll
cnIgPSBpOTE1X2dlbWZzX2luaXQoZGV2X3ByaXYpOwo+ID4gKwllcnIgPSBpOTE1X2dlbWZzX2lu
aXQoaTkxNSk7Cj4gPiAgIAlpZiAoZXJyKQo+ID4gICAJCURSTV9OT1RFKCJVbmFibGUgdG8gY3Jl
YXRlIGEgcHJpdmF0ZSB0bXBmcyBtb3VudCwgaHVnZXBhZ2Ugc3VwcG9ydCB3aWxsIGJlIGRpc2Fi
bGVkKCVkKS5cbiIsIGVycik7Cj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4gLXZvaWQgaTkx
NV9nZW1fY2xlYW51cF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiArdm9pZCBpOTE1X2dlbV9jbGVhbnVwX2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAtCWk5MTVfZ2VtX2RyYWluX2ZyZWVkX29iamVjdHMoZGV2X3ByaXYp
Owo+ID4gLQlHRU1fQlVHX09OKCFsbGlzdF9lbXB0eSgmZGV2X3ByaXYtPm1tLmZyZWVfbGlzdCkp
Owo+ID4gLQlHRU1fQlVHX09OKGF0b21pY19yZWFkKCZkZXZfcHJpdi0+bW0uZnJlZV9jb3VudCkp
Owo+ID4gLQlXQVJOX09OKGRldl9wcml2LT5tbS5zaHJpbmtfY291bnQpOwo+ID4gKwlpOTE1X2dl
bV9kcmFpbl9mcmVlZF9vYmplY3RzKGk5MTUpOwo+ID4gKwlHRU1fQlVHX09OKCFsbGlzdF9lbXB0
eSgmaTkxNS0+bW0uZnJlZV9saXN0KSk7Cj4gPiArCUdFTV9CVUdfT04oYXRvbWljX3JlYWQoJmk5
MTUtPm1tLmZyZWVfY291bnQpKTsKPiA+ICsJV0FSTl9PTihpOTE1LT5tbS5zaHJpbmtfY291bnQp
Owo+ID4gLQljbGVhbnVwX3NyY3Vfc3RydWN0KCZkZXZfcHJpdi0+Z3B1X2Vycm9yLnJlc2V0X2Jh
Y2tvZmZfc3JjdSk7Cj4gPiArCWNsZWFudXBfc3JjdV9zdHJ1Y3QoJmk5MTUtPmdwdV9lcnJvci5y
ZXNldF9iYWNrb2ZmX3NyY3UpOwo+ID4gLQlpOTE1X2dlbWZzX2ZpbmkoZGV2X3ByaXYpOwo+ID4g
KwlpOTE1X2dlbWZzX2ZpbmkoaTkxNSk7Cj4gPiAgIH0KPiA+IC1pbnQgaTkxNV9nZW1fZnJlZXpl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQgaTkxNV9nZW1fZnJl
ZXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAkvKiBEaXNj
YXJkIGFsbCBwdXJnZWFibGUgb2JqZWN0cywgbGV0IHVzZXJzcGFjZSByZWNvdmVyIHRob3NlIGFz
Cj4gPiAgIAkgKiByZXF1aXJlZCBhZnRlciByZXN1bWluZy4KPiA+ICAgCSAqLwo+ID4gLQlpOTE1
X2dlbV9zaHJpbmtfYWxsKGRldl9wcml2KTsKPiA+ICsJaTkxNV9nZW1fc2hyaW5rX2FsbChpOTE1
KTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiBAQCAtMTg5NSw3ICsxODk1LDcgQEAgaW50
IGk5MTVfZ2VtX29wZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBkcm1f
ZmlsZSAqZmlsZSkKPiA+ICAgCQlyZXR1cm4gLUVOT01FTTsKPiA+ICAgCWZpbGUtPmRyaXZlcl9w
cml2ID0gZmlsZV9wcml2Owo+ID4gLQlmaWxlX3ByaXYtPmRldl9wcml2ID0gaTkxNTsKPiA+ICsJ
ZmlsZV9wcml2LT5pOTE1ID0gaTkxNTsKPiA+ICAgCWZpbGVfcHJpdi0+ZmlsZSA9IGZpbGU7Cj4g
PiAgIAlzcGluX2xvY2tfaW5pdCgmZmlsZV9wcml2LT5tbS5sb2NrKTsKPiA+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ldmljdC5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW1fZXZpY3QuYwo+ID4gaW5kZXggYTU3ODNjNGNiOThiLi40MjQ0ZDljNTRk
NjYgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ldmljdC5j
Cj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ldmljdC5jCj4gPiBAQCAt
OTksNyArOTksNyBAQCBpOTE1X2dlbV9ldmljdF9zb21ldGhpbmcoc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqdm0sCj4gPiAgIAkJCSB1NjQgc3RhcnQsIHU2NCBlbmQsCj4gPiAgIAkJCSB1bnNp
Z25lZCBmbGFncykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB2bS0+aTkxNTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2bS0+
aTkxNTsKPiA+ICAgCXN0cnVjdCBkcm1fbW1fc2NhbiBzY2FuOwo+ID4gICAJc3RydWN0IGxpc3Rf
aGVhZCBldmljdGlvbl9saXN0Owo+ID4gICAJc3RydWN0IGk5MTVfdm1hICp2bWEsICpuZXh0Owo+
ID4gQEAgLTEzOCw3ICsxMzgsNyBAQCBpOTE1X2dlbV9ldmljdF9zb21ldGhpbmcoc3RydWN0IGk5
MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gPiAgIAkgKiByZXRpcmluZy4KPiA+ICAgCSAqLwo+ID4g
ICAJaWYgKCEoZmxhZ3MgJiBQSU5fTk9OQkxPQ0spKQo+ID4gLQkJaTkxNV9yZXRpcmVfcmVxdWVz
dHMoZGV2X3ByaXYpOwo+ID4gKwkJaTkxNV9yZXRpcmVfcmVxdWVzdHMoaTkxNSk7Cj4gPiAgIHNl
YXJjaF9hZ2FpbjoKPiA+ICAgCWFjdGl2ZSA9IE5VTEw7Cj4gPiBAQCAtMjExLDcgKzIxMSw3IEBA
IGk5MTVfZ2VtX2V2aWN0X3NvbWV0aGluZyhzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwK
PiA+ICAgCWlmIChJOTE1X1NFTEZURVNUX09OTFkoaWd0X2V2aWN0X2N0bC5mYWlsX2lmX2J1c3kp
KQo+ID4gICAJCXJldHVybiAtRUJVU1k7Cj4gPiAtCXJldCA9IGdndHRfZmx1c2goZGV2X3ByaXYp
Owo+ID4gKwlyZXQgPSBnZ3R0X2ZsdXNoKGk5MTUpOwo+ID4gICAJaWYgKHJldCkKPiA+ICAgCQly
ZXR1cm4gcmV0Owo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2Vt
X2d0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKPiA+IGluZGV4IGU3
MDY3NWJmYjUxZC4uNDJkODhkYWU5YzVkIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW1fZ3R0LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2VtX2d0dC5jCj4gPiBAQCAtMTI5NCw3ICsxMjk0LDcgQEAgc3RhdGljIGludCBnZW44X2luaXRf
c2NyYXRjaChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKPiA+ICAgc3RhdGljIGludCBn
ZW44X3BwZ3R0X25vdGlmeV92Z3Qoc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0LCBib29sIGNyZWF0
ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSAmcHBndHQt
PnZtOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2bS0+aTkxNTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2bS0+aTkxNTsKPiA+ICAgCWVu
dW0gdmd0X2cydl90eXBlIG1zZzsKPiA+ICAgCWludCBpOwo+ID4gQEAgLTE2OTIsNyArMTY5Miw3
IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBnZW42X3dyaXRlX3BkZShjb25zdCBzdHJ1Y3QgZ2VuNl9w
cGd0dCAqcHBndHQsCj4gPiAgIAkJICBwcGd0dC0+cGRfYWRkciArIHBkZSk7Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgdm9pZCBnZW43X3BwZ3R0X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgZ2VuN19wcGd0dF9lbmFibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZTsKPiA+ICAgCXUzMiBlY29jaGssIGVjb2JpdHM7Cj4gPiBAQCAtMTcwMiw3ICsxNzAy
LDcgQEAgc3RhdGljIHZvaWQgZ2VuN19wcGd0dF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gICAJSTkxNV9XUklURShHQUNfRUNPX0JJVFMsIGVjb2JpdHMgfCBF
Q09CSVRTX1BQR1RUX0NBQ0hFNjRCKTsKPiA+ICAgCWVjb2NoayA9IEk5MTVfUkVBRChHQU1fRUNP
Q0hLKTsKPiA+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19IQVNX
RUxMKGk5MTUpKSB7Cj4gPiAgIAkJZWNvY2hrIHw9IEVDT0NIS19QUEdUVF9XQl9IU1c7Cj4gPiAg
IAl9IGVsc2Ugewo+ID4gICAJCWVjb2NoayB8PSBFQ09DSEtfUFBHVFRfTExDX0lWQjsKPiA+IEBA
IC0xNzEwLDcgKzE3MTAsNyBAQCBzdGF0aWMgdm9pZCBnZW43X3BwZ3R0X2VuYWJsZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAl9Cj4gPiAgIAlJOTE1X1dSSVRFKEdB
TV9FQ09DSEssIGVjb2Noayk7Cj4gPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2
LCBpZCkgewo+ID4gKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewo+ID4gICAJ
CS8qIEdGWF9NT0RFIGlzIHBlci1yaW5nIG9uIGdlbjcrICovCj4gPiAgIAkJRU5HSU5FX1dSSVRF
KGVuZ2luZSwKPiA+ICAgCQkJICAgICBSSU5HX01PREVfR0VONywKPiA+IEBAIC0xNzE4LDcgKzE3
MTgsNyBAQCBzdGF0aWMgdm9pZCBnZW43X3BwZ3R0X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW42X3Bw
Z3R0X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGlj
IHZvaWQgZ2VuNl9wcGd0dF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+ICAgCXUzMiBlY29jaGssIGdhYl9jdGwsIGVjb2JpdHM7Cj4gPiBAQCAtMTczMiw3
ICsxNzMyLDcgQEAgc3RhdGljIHZvaWQgZ2VuNl9wcGd0dF9lbmFibGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJZWNvY2hrID0gSTkxNV9SRUFEKEdBTV9FQ09DSEsp
Owo+ID4gICAJSTkxNV9XUklURShHQU1fRUNPQ0hLLCBlY29jaGsgfCBFQ09DSEtfU05CX0JJVCB8
IEVDT0NIS19QUEdUVF9DQUNIRTY0Qik7Cj4gPiAtCWlmIChIQVNfUFBHVFQoZGV2X3ByaXYpKSAv
KiBtYXkgYmUgZGlzYWJsZWQgZm9yIFZULWQgKi8KPiA+ICsJaWYgKEhBU19QUEdUVChpOTE1KSkg
LyogbWF5IGJlIGRpc2FibGVkIGZvciBWVC1kICovCj4gPiAgIAkJSTkxNV9XUklURShHRlhfTU9E
RSwgX01BU0tFRF9CSVRfRU5BQkxFKEdGWF9QUEdUVF9FTkFCTEUpKTsKPiA+ICAgfQo+ID4gQEAg
LTIxODUsMjAgKzIxODUsMjAgQEAgc3RhdGljIHN0cnVjdCBpOTE1X3BwZ3R0ICpnZW42X3BwZ3R0
X2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgCXJldHVybiBFUlJf
UFRSKGVycik7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBndHRfd3JpdGVfd29ya2Fyb3VuZHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGd0dF93
cml0ZV93b3JrYXJvdW5kcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+
ID4gICAJLyogVGhpcyBmdW5jdGlvbiBpcyBmb3IgZ3R0IHJlbGF0ZWQgd29ya2Fyb3VuZHMuIFRo
aXMgZnVuY3Rpb24gaXMKPiA+ICAgCSAqIGNhbGxlZCBvbiBkcml2ZXIgbG9hZCBhbmQgYWZ0ZXIg
YSBHUFUgcmVzZXQsIHNvIHlvdSBjYW4gcGxhY2UKPiA+ICAgCSAqIHdvcmthcm91bmRzIGhlcmUg
ZXZlbiBpZiB0aGV5IGdldCBvdmVyd3JpdHRlbiBieSBHUFUgcmVzZXQuCj4gPiAgIAkgKi8KPiA+
ICAgCS8qIFdhSW5jcmVhc2VEZWZhdWx0VExCRW50cmllczpjaHYsYmR3LHNrbCxieHQsa2JsLGds
ayxjZmwsY25sLGljbCAqLwo+ID4gLQlpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiA+ICsJ
aWYgKElTX0JST0FEV0VMTChpOTE1KSkKPiA+ICAgCQlJOTE1X1dSSVRFKEdFTjhfTDNfTFJBXzFf
R1BHUFUsIEdFTjhfTDNfTFJBXzFfR1BHUFVfREVGQVVMVF9WQUxVRV9CRFcpOwo+ID4gLQllbHNl
IGlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSVNfQ0hFUlJZVklF
VyhpOTE1KSkKPiA+ICAgCQlJOTE1X1dSSVRFKEdFTjhfTDNfTFJBXzFfR1BHUFUsIEdFTjhfTDNf
TFJBXzFfR1BHUFVfREVGQVVMVF9WQUxVRV9DSFYpOwo+ID4gLQllbHNlIGlmIChJU19HRU45X0xQ
KGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiA+ICAgCQlJOTE1
X1dSSVRFKEdFTjhfTDNfTFJBXzFfR1BHUFUsIEdFTjlfTDNfTFJBXzFfR1BHUFVfREVGQVVMVF9W
QUxVRV9CWFQpOwo+ID4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiAr
CWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gICAJCUk5MTVfV1JJVEUoR0VOOF9M
M19MUkFfMV9HUEdQVSwgR0VOOV9MM19MUkFfMV9HUEdQVV9ERUZBVUxUX1ZBTFVFX1NLTCk7Cj4g
PiAgIAkvKgo+ID4gQEAgLTIyMTIsMjEgKzIyMTIsMjEgQEAgc3RhdGljIHZvaWQgZ3R0X3dyaXRl
X3dvcmthcm91bmRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAq
IDMySyBwYWdlcywgYnV0IHdlIGRvbid0IGN1cnJlbnRseSBoYXZlIGFueSBzdXBwb3J0IGZvciBp
dCBpbiBvdXIKPiA+ICAgCSAqIGRyaXZlci4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSEFTX1BBR0Vf
U0laRVMoZGV2X3ByaXYsIEk5MTVfR1RUX1BBR0VfU0laRV82NEspICYmCj4gPiAtCSAgICBJTlRF
TF9HRU4oZGV2X3ByaXYpIDw9IDEwKQo+ID4gKwlpZiAoSEFTX1BBR0VfU0laRVMoaTkxNSwgSTkx
NV9HVFRfUEFHRV9TSVpFXzY0SykgJiYKPiA+ICsJICAgIElOVEVMX0dFTihpOTE1KSA8PSAxMCkK
PiA+ICAgCQlJOTE1X1dSSVRFKEdFTjhfR0FNV19FQ09fREVWX1JXX0lBLAo+ID4gICAJCQkgICBJ
OTE1X1JFQUQoR0VOOF9HQU1XX0VDT19ERVZfUldfSUEpIHwKPiA+ICAgCQkJICAgR0FNV19FQ09f
RU5BQkxFXzY0S19JUFNfRklFTEQpOwo+ID4gICB9Cj4gPiAtaW50IGk5MTVfcHBndHRfaW5pdF9o
dyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAraW50IGk5MTVfcHBndHRf
aW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlndHRf
d3JpdGVfd29ya2Fyb3VuZHMoZGV2X3ByaXYpOwo+ID4gKwlndHRfd3JpdGVfd29ya2Fyb3VuZHMo
aTkxNSk7Cj4gPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDYpKQo+ID4gLQkJZ2VuNl9wcGd0dF9l
bmFibGUoZGV2X3ByaXYpOwo+ID4gLQllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDcpKQo+ID4g
LQkJZ2VuN19wcGd0dF9lbmFibGUoZGV2X3ByaXYpOwo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDYp
KQo+ID4gKwkJZ2VuNl9wcGd0dF9lbmFibGUoaTkxNSk7Cj4gPiArCWVsc2UgaWYgKElTX0dFTihp
OTE1LCA3KSkKPiA+ICsJCWdlbjdfcHBndHRfZW5hYmxlKGk5MTUpOwo+ID4gICAJcmV0dXJuIDA7
Cj4gPiAgIH0KPiA+IEBAIC0yMjkzLDI5ICsyMjkzLDI5IEBAIHZvaWQgaTkxNV92bV9yZWxlYXNl
KHN0cnVjdCBrcmVmICprcmVmKQo+ID4gICAvKiBDZXJ0YWluIEdlbjUgY2hpcHNldHMgcmVxdWly
ZSByZXF1aXJlIGlkbGluZyB0aGUgR1BVIGJlZm9yZQo+ID4gICAgKiB1bm1hcHBpbmcgYW55dGhp
bmcgZnJvbSB0aGUgR1RUIHdoZW4gVlQtZCBpcyBlbmFibGVkLgo+ID4gICAgKi8KPiA+IC1zdGF0
aWMgYm9vbCBuZWVkc19pZGxlX21hcHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gK3N0YXRpYyBib29sIG5lZWRzX2lkbGVfbWFwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJLyogUXVlcnkgaW50ZWxfaW9tbXUgdG8gc2VlIGlmIHdl
IG5lZWQgdGhlIHdvcmthcm91bmQuIFByZXN1bWFibHkgdGhhdAo+ID4gICAJICogd2FzIGxvYWRl
ZCBmaXJzdC4KPiA+ICAgCSAqLwo+ID4gLQlyZXR1cm4gSVNfR0VOKGRldl9wcml2LCA1KSAmJiBJ
U19NT0JJTEUoZGV2X3ByaXYpICYmIGludGVsX3Z0ZF9hY3RpdmUoKTsKPiA+ICsJcmV0dXJuIElT
X0dFTihpOTE1LCA1KSAmJiBJU19NT0JJTEUoaTkxNSkgJiYgaW50ZWxfdnRkX2FjdGl2ZSgpOwo+
ID4gICB9Cj4gPiAtdm9pZCBpOTE1X2dlbV9zdXNwZW5kX2d0dF9tYXBwaW5ncyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpOTE1X2dlbV9zdXNwZW5kX2d0dF9t
YXBwaW5ncyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5nZ3R0Owo+ID4gKwlzdHJ1Y3QgaTkxNV9n
Z3R0ICpnZ3R0ID0gJmk5MTUtPmdndHQ7Cj4gPiAgIAkvKiBEb24ndCBib3RoZXIgbWVzc2luZyB3
aXRoIGZhdWx0cyBwcmUgR0VONiBhcyB3ZSBoYXZlIGxpdHRsZQo+ID4gICAJICogZG9jdW1lbnRh
dGlvbiBzdXBwb3J0aW5nIHRoYXQgaXQncyBhIGdvb2QgaWRlYS4KPiA+ICAgCSAqLwo+ID4gLQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDYpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA2
KQo+ID4gICAJCXJldHVybjsKPiA+IC0JaTkxNV9jaGVja19hbmRfY2xlYXJfZmF1bHRzKGRldl9w
cml2KTsKPiA+ICsJaTkxNV9jaGVja19hbmRfY2xlYXJfZmF1bHRzKGk5MTUpOwo+ID4gICAJZ2d0
dC0+dm0uY2xlYXJfcmFuZ2UoJmdndHQtPnZtLCAwLCBnZ3R0LT52bS50b3RhbCk7Cj4gPiAtCWk5
MTVfZ2d0dF9pbnZhbGlkYXRlKGRldl9wcml2KTsKPiA+ICsJaTkxNV9nZ3R0X2ludmFsaWRhdGUo
aTkxNSk7Cj4gPiAgIH0KPiA+ICAgaW50IGk5MTVfZ2VtX2d0dF9wcmVwYXJlX3BhZ2VzKHN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gPiBAQCAtMjQxMSw3ICsyNDExLDcgQEAgc3Rh
dGljIHZvaWQgZ2VuNl9nZ3R0X2luc2VydF9wYWdlKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2Ug
KnZtLAo+ID4gICAgKiBCaW5kcyBhbiBvYmplY3QgaW50byB0aGUgZ2xvYmFsIGd0dCB3aXRoIHRo
ZSBzcGVjaWZpZWQgY2FjaGUgbGV2ZWwuIFRoZSBvYmplY3QKPiA+ICAgICogd2lsbCBiZSBhY2Nl
c3NpYmxlIHRvIHRoZSBHUFUgdmlhIGNvbW1hbmRzIHdob3NlIG9wZXJhbmRzIHJlZmVyZW5jZSBv
ZmZzZXRzCj4gPiAgICAqIHdpdGhpbiB0aGUgZ2xvYmFsIEdUVCBhcyB3ZWxsIGFzIGFjY2Vzc2li
bGUgYnkgdGhlIEdQVSB0aHJvdWdoIHRoZSBHTUFEUgo+ID4gLSAqIG1hcHBlZCBCQVIgKGRldl9w
cml2LT5tbS5ndHQtPmd0dCkuCj4gPiArICogbWFwcGVkIEJBUiAoaTkxNS0+bW0uZ3R0LT5ndHQp
Lgo+ID4gICAgKi8KPiA+ICAgc3RhdGljIHZvaWQgZ2VuNl9nZ3R0X2luc2VydF9lbnRyaWVzKHN0
cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAo+ID4gICAJCQkJICAgICBzdHJ1Y3QgaTkxNV92
bWEgKnZtYSwKPiA+IEBAIC0yNDYxLDcgKzI0NjEsNyBAQCBzdGF0aWMgdm9pZCBnZW44X2dndHRf
Y2xlYXJfcmFuZ2Uoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gPiAgIHN0YXRpYyB2
b2lkIGJ4dF92dGRfZ2d0dF93YShzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2bS0+aTkxNTsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB2bS0+aTkxNTsKPiA+ICAgCS8qCj4g
PiAgIAkgKiBNYWtlIHN1cmUgdGhlIGludGVybmFsIEdBTSBmaWZvIGhhcyBiZWVuIGNsZWFyZWQg
b2YgYWxsIEdUVAo+ID4gQEAgLTI3MDUsMTIgKzI3MDUsMTIgQEAgc3RhdGljIHZvaWQgYWxpYXNp
bmdfZ3R0X3VuYmluZF92bWEoc3RydWN0IGk5MTVfdm1hICp2bWEpCj4gPiAgIHZvaWQgaTkxNV9n
ZW1fZ3R0X2ZpbmlzaF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ID4g
ICAJCQkgICAgICAgc3RydWN0IHNnX3RhYmxlICpwYWdlcykKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+ID4g
LQlzdHJ1Y3QgZGV2aWNlICprZGV2ID0gJmRldl9wcml2LT5kcm0ucGRldi0+ZGV2Owo+ID4gLQlz
dHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5nZ3R0Owo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Cj4gPiArCXN0cnVj
dCBkZXZpY2UgKmtkZXYgPSAmaTkxNS0+ZHJtLnBkZXYtPmRldjsKPiA+ICsJc3RydWN0IGk5MTVf
Z2d0dCAqZ2d0dCA9ICZpOTE1LT5nZ3R0Owo+ID4gICAJaWYgKHVubGlrZWx5KGdndHQtPmRvX2lk
bGVfbWFwcykpIHsKPiA+IC0JCWlmIChpOTE1X2dlbV93YWl0X2Zvcl9pZGxlKGRldl9wcml2LCAw
LCBNQVhfU0NIRURVTEVfVElNRU9VVCkpIHsKPiA+ICsJCWlmIChpOTE1X2dlbV93YWl0X2Zvcl9p
ZGxlKGk5MTUsIDAsIE1BWF9TQ0hFRFVMRV9USU1FT1VUKSkgewo+ID4gICAJCQlEUk1fRVJST1Io
IkZhaWxlZCB0byB3YWl0IGZvciBpZGxlOyBWVCdkIG1heSBoYW5nLlxuIik7Cj4gPiAgIAkJCS8q
IFdhaXQgYSBiaXQsIGluIGhvcGVzIGl0IGF2b2lkcyB0aGUgaGFuZyAqLwo+ID4gICAJCQl1ZGVs
YXkoMTApOwo+ID4gQEAgLTI4MzQsNyArMjgzNCw3IEBAIHN0YXRpYyB2b2lkIGdndHRfcmVsZWFz
ZV9ndWNfdG9wKHN0cnVjdCBpOTE1X2dndHQgKmdndHQpCj4gPiAgIAkJZHJtX21tX3JlbW92ZV9u
b2RlKCZnZ3R0LT51Y19mdyk7Cj4gPiAgIH0KPiA+IC1pbnQgaTkxNV9nZW1faW5pdF9nZ3R0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQgaTkxNV9nZW1faW5pdF9n
Z3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAkvKiBMZXQg
R0VNIE1hbmFnZSBhbGwgb2YgdGhlIGFwZXJ0dXJlLgo+ID4gICAJICoKPiA+IEBAIC0yODQ1LDcg
KzI4NDUsNyBAQCBpbnQgaTkxNV9nZW1faW5pdF9nZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiA+ICAgCSAqIGFwZXJ0dXJlLiAgT25lIHBhZ2Ugc2hvdWxkIGJlIGVub3Vn
aCB0byBrZWVwIGFueSBwcmVmZXRjaGluZyBpbnNpZGUKPiA+ICAgCSAqIG9mIHRoZSBhcGVydHVy
ZS4KPiA+ICAgCSAqLwo+ID4gLQlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5n
Z3R0Owo+ID4gKwlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmk5MTUtPmdndHQ7Cj4gPiAgIAl1
bnNpZ25lZCBsb25nIGhvbGVfc3RhcnQsIGhvbGVfZW5kOwo+ID4gICAJc3RydWN0IGRybV9tbV9u
b2RlICplbnRyeTsKPiA+ICAgCWludCByZXQ7Cj4gPiBAQCAtMjg1Nyw5ICsyODU3LDkgQEAgaW50
IGk5MTVfZ2VtX2luaXRfZ2d0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiAgIAkgKiB3aHkuCj4gPiAgIAkgKi8KPiA+ICAgCWdndHQtPnBpbl9iaWFzID0gbWF4X3QodTMy
LCBJOTE1X0dUVF9QQUdFX1NJWkUsCj4gPiAtCQkJICAgICAgIGludGVsX3dvcGNtX2d1Y19zaXpl
KCZkZXZfcHJpdi0+d29wY20pKTsKPiA+ICsJCQkgICAgICAgaW50ZWxfd29wY21fZ3VjX3NpemUo
Jmk5MTUtPndvcGNtKSk7Cj4gPiAtCXJldCA9IGludGVsX3ZndF9iYWxsb29uKGRldl9wcml2KTsK
PiA+ICsJcmV0ID0gaW50ZWxfdmd0X2JhbGxvb24oaTkxNSk7Cj4gPiAgIAlpZiAocmV0KQo+ID4g
ICAJCXJldHVybiByZXQ7Cj4gPiBAQCAtMjg5MSw4ICsyODkxLDggQEAgaW50IGk5MTVfZ2VtX2lu
aXRfZ2d0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkvKiBBbmQg
ZmluYWxseSBjbGVhciB0aGUgcmVzZXJ2ZWQgZ3VhcmQgcGFnZSAqLwo+ID4gICAJZ2d0dC0+dm0u
Y2xlYXJfcmFuZ2UoJmdndHQtPnZtLCBnZ3R0LT52bS50b3RhbCAtIFBBR0VfU0laRSwgUEFHRV9T
SVpFKTsKPiA+IC0JaWYgKElOVEVMX1BQR1RUKGRldl9wcml2KSA9PSBJTlRFTF9QUEdUVF9BTElB
U0lORykgewo+ID4gLQkJcmV0ID0gaW5pdF9hbGlhc2luZ19wcGd0dChkZXZfcHJpdik7Cj4gPiAr
CWlmIChJTlRFTF9QUEdUVChpOTE1KSA9PSBJTlRFTF9QUEdUVF9BTElBU0lORykgewo+ID4gKwkJ
cmV0ID0gaW5pdF9hbGlhc2luZ19wcGd0dChpOTE1KTsKPiA+ICAgCQlpZiAocmV0KQo+ID4gICAJ
CQlnb3RvIGVycl9hcHBndHQ7Cj4gPiAgIAl9Cj4gPiBAQCAtMjkwOCwxOCArMjkwOCwxOCBAQCBp
bnQgaTkxNV9nZW1faW5pdF9nZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgLyoqCj4gPiAgICAqIGk5MTVfZ2d0dF9jbGVhbnVwX2h3IC0gQ2xlYW4gdXAgR0dUVCBo
YXJkd2FyZSBpbml0aWFsaXphdGlvbgo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiA+
ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UKPiA+ICAgICovCj4gPiAtdm9pZCBpOTE1X2dndHRfY2xl
YW51cF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpOTE1
X2dndHRfY2xlYW51cF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5nZ3R0Owo+ID4gKwlzdHJ1
Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmk5MTUtPmdndHQ7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV92bWEg
KnZtYSwgKnZuOwo+ID4gICAJc3RydWN0IHBhZ2V2ZWMgKnB2ZWM7Cj4gPiAgIAlnZ3R0LT52bS5j
bG9zZWQgPSB0cnVlOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRl
eCk7Cj4gPiAtCWZpbmlfYWxpYXNpbmdfcHBndHQoZGV2X3ByaXYpOwo+ID4gKwltdXRleF9sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJZmluaV9hbGlhc2luZ19wcGd0dChpOTE1
KTsKPiA+ICAgCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZSh2bWEsIHZuLCAmZ2d0dC0+dm0uYm91
bmRfbGlzdCwgdm1fbGluaykKPiA+ICAgCQlXQVJOX09OKGk5MTVfdm1hX3VuYmluZCh2bWEpKTsK
PiA+IEBAIC0yOTMwLDI0ICsyOTMwLDI0IEBAIHZvaWQgaTkxNV9nZ3R0X2NsZWFudXBfaHcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJZ2d0dF9yZWxlYXNlX2d1Y190
b3AoZ2d0dCk7Cj4gPiAgIAlpZiAoZHJtX21tX2luaXRpYWxpemVkKCZnZ3R0LT52bS5tbSkpIHsK
PiA+IC0JCWludGVsX3ZndF9kZWJhbGxvb24oZGV2X3ByaXYpOwo+ID4gKwkJaW50ZWxfdmd0X2Rl
YmFsbG9vbihpOTE1KTsKPiA+ICAgCQlpOTE1X2FkZHJlc3Nfc3BhY2VfZmluaSgmZ2d0dC0+dm0p
Owo+ID4gICAJfQo+ID4gICAJZ2d0dC0+dm0uY2xlYW51cCgmZ2d0dC0+dm0pOwo+ID4gLQlwdmVj
ID0gJmRldl9wcml2LT5tbS53Y19zdGFzaC5wdmVjOwo+ID4gKwlwdmVjID0gJmk5MTUtPm1tLndj
X3N0YXNoLnB2ZWM7Cj4gPiAgIAlpZiAocHZlYy0+bnIpIHsKPiA+ICAgCQlzZXRfcGFnZXNfYXJy
YXlfd2IocHZlYy0+cGFnZXMsIHB2ZWMtPm5yKTsKPiA+ICAgCQlfX3BhZ2V2ZWNfcmVsZWFzZShw
dmVjKTsKPiA+ICAgCX0KPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9t
dXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAg
IAlhcmNoX3BoeXNfd2NfZGVsKGdndHQtPm10cnIpOwo+ID4gICAJaW9fbWFwcGluZ19maW5pKCZn
Z3R0LT5pb21hcCk7Cj4gPiAtCWk5MTVfZ2VtX2NsZWFudXBfc3RvbGVuKGRldl9wcml2KTsKPiA+
ICsJaTkxNV9nZW1fY2xlYW51cF9zdG9sZW4oaTkxNSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHVu
c2lnbmVkIGludCBnZW42X2dldF90b3RhbF9ndHRfc2l6ZSh1MTYgc25iX2dtY2hfY3RsKQo+ID4g
QEAgLTI5ODYsOCArMjk4Niw4IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgY2h2X2dldF90b3RhbF9n
dHRfc2l6ZSh1MTYgZ21jaF9jdHJsKQo+ID4gICBzdGF0aWMgaW50IGdndHRfcHJvYmVfY29tbW9u
KHN0cnVjdCBpOTE1X2dndHQgKmdndHQsIHU2NCBzaXplKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGdndHQtPnZtLmk5MTU7Cj4gPiAtCXN0cnVjdCBw
Y2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IGdndHQtPnZtLmk5MTU7Cj4gPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2
ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiAgIAlwaHlzX2FkZHJfdCBwaHlzX2FkZHI7Cj4gPiAgIAlp
bnQgcmV0Owo+ID4gQEAgLTMwMDEsNyArMzAwMSw3IEBAIHN0YXRpYyBpbnQgZ2d0dF9wcm9iZV9j
b21tb24oc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCwgdTY0IHNpemUpCj4gPiAgIAkgKiByZXNvcnQg
dG8gYW4gdW5jYWNoZWQgbWFwcGluZy4gVGhlIFdDIGlzc3VlIGlzIGVhc2lseSBjYXVnaHQgYnkg
dGhlCj4gPiAgIAkgKiByZWFkYmFjayBjaGVjayB3aGVuIHdyaXRpbmcgR1RUIFBURSBlbnRyaWVz
Lgo+ID4gICAJICovCj4gPiAtCWlmIChJU19HRU45X0xQKGRldl9wcml2KSB8fCBJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDEwKQo+ID4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSB8fCBJTlRFTF9HRU4o
aTkxNSkgPj0gMTApCj4gPiAgIAkJZ2d0dC0+Z3NtID0gaW9yZW1hcF9ub2NhY2hlKHBoeXNfYWRk
ciwgc2l6ZSk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJZ2d0dC0+Z3NtID0gaW9yZW1hcF93YyhwaHlz
X2FkZHIsIHNpemUpOwo+ID4gQEAgLTMxMzUsOSArMzEzNSw5IEBAIHZvaWQgaW50ZWxfcHBhdF9w
dXQoY29uc3Qgc3RydWN0IGludGVsX3BwYXRfZW50cnkgKmVudHJ5KQo+ID4gICAJa3JlZl9wdXQo
JnBwYXQtPmVudHJpZXNbaW5kZXhdLnJlZiwgcmVsZWFzZV9wcGF0KTsKPiA+ICAgfQo+ID4gLXN0
YXRpYyB2b2lkIGNubF9wcml2YXRlX3BhdF91cGRhdGVfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGNubF9wcml2YXRlX3BhdF91cGRhdGVfaHco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVs
X3BwYXQgKnBwYXQgPSAmZGV2X3ByaXYtPnBwYXQ7Cj4gPiArCXN0cnVjdCBpbnRlbF9wcGF0ICpw
cGF0ID0gJmk5MTUtPnBwYXQ7Cj4gPiAgIAlpbnQgaTsKPiA+ICAgCWZvcl9lYWNoX3NldF9iaXQo
aSwgcHBhdC0+ZGlydHksIHBwYXQtPm1heF9lbnRyaWVzKSB7Cj4gPiBAQCAtMzE0Niw5ICszMTQ2
LDkgQEAgc3RhdGljIHZvaWQgY25sX3ByaXZhdGVfcGF0X3VwZGF0ZV9odyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBi
ZHdfcHJpdmF0ZV9wYXRfdXBkYXRlX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICtzdGF0aWMgdm9pZCBiZHdfcHJpdmF0ZV9wYXRfdXBkYXRlX2h3KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9wcGF0ICpwcGF0
ID0gJmRldl9wcml2LT5wcGF0Owo+ID4gKwlzdHJ1Y3QgaW50ZWxfcHBhdCAqcHBhdCA9ICZpOTE1
LT5wcGF0Owo+ID4gICAJdTY0IHBhdCA9IDA7Cj4gPiAgIAlpbnQgaTsKPiA+IEBAIC0zMjkzLDE2
ICszMjkzLDE2IEBAIHN0YXRpYyB2b2lkIGdlbjZfZ21jaF9yZW1vdmUoc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm0pCj4gPiAgIAljbGVhbnVwX3NjcmF0Y2hfcGFnZSh2bSk7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgdm9pZCBzZXR1cF9wcml2YXRlX3BhdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgc2V0dXBfcHJpdmF0ZV9wYXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3BwYXQgKnBw
YXQgPSAmZGV2X3ByaXYtPnBwYXQ7Cj4gPiArCXN0cnVjdCBpbnRlbF9wcGF0ICpwcGF0ID0gJmk5
MTUtPnBwYXQ7Cj4gPiAgIAlpbnQgaTsKPiA+IC0JcHBhdC0+aTkxNSA9IGRldl9wcml2Owo+ID4g
KwlwcGF0LT5pOTE1ID0gaTkxNTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAp
Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTApCj4gPiAgIAkJY25sX3NldHVwX3ByaXZh
dGVfcHBhdChwcGF0KTsKPiA+IC0JZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgfHwg
SVNfR0VOOV9MUChkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkg
fHwgSVNfR0VOOV9MUChpOTE1KSkKPiA+ICAgCQljaHZfc2V0dXBfcHJpdmF0ZV9wcGF0KHBwYXQp
Owo+ID4gICAJZWxzZQo+ID4gICAJCWJkd19zZXR1cF9wcml2YXRlX3BwYXQocHBhdCk7Cj4gPiBA
QCAtMzMxNSwxMyArMzMxNSwxMyBAQCBzdGF0aWMgdm9pZCBzZXR1cF9wcml2YXRlX3BhdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJc2V0X2JpdChpLCBwcGF0LT5k
aXJ0eSk7Cj4gPiAgIAl9Cj4gPiAtCXBwYXQtPnVwZGF0ZV9odyhkZXZfcHJpdik7Cj4gPiArCXBw
YXQtPnVwZGF0ZV9odyhpOTE1KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW50IGdlbjhfZ21jaF9w
cm9iZShzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGdndHQtPnZtLmk5MTU7Cj4gPiAtCXN0cnVjdCBwY2lfZGV2
ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IGdndHQtPnZtLmk5MTU7Cj4gPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkx
NS0+ZHJtLnBkZXY7Cj4gPiAgIAl1bnNpZ25lZCBpbnQgc2l6ZTsKPiA+ICAgCXUxNiBzbmJfZ21j
aF9jdGw7Cj4gPiAgIAlpbnQgZXJyOwo+ID4gQEAgLTMzMzksNyArMzMzOSw3IEBAIHN0YXRpYyBp
bnQgZ2VuOF9nbWNoX3Byb2JlKHN0cnVjdCBpOTE1X2dndHQgKmdndHQpCj4gPiAgIAkJRFJNX0VS
Uk9SKCJDYW4ndCBzZXQgRE1BIG1hc2svY29uc2lzdGVudCBtYXNrICglZClcbiIsIGVycik7Cj4g
PiAgIAlwY2lfcmVhZF9jb25maWdfd29yZChwZGV2LCBTTkJfR01DSF9DVFJMLCAmc25iX2dtY2hf
Y3RsKTsKPiA+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfQ0hF
UlJZVklFVyhpOTE1KSkKPiA+ICAgCQlzaXplID0gY2h2X2dldF90b3RhbF9ndHRfc2l6ZShzbmJf
Z21jaF9jdGwpOwo+ID4gICAJZWxzZQo+ID4gICAJCXNpemUgPSBnZW44X2dldF90b3RhbF9ndHRf
c2l6ZShzbmJfZ21jaF9jdGwpOwo+ID4gQEAgLTMzNDgsMjMgKzMzNDgsMjMgQEAgc3RhdGljIGlu
dCBnZW44X2dtY2hfcHJvYmUoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCkKPiA+ICAgCWdndHQtPnZt
LmNsZWFudXAgPSBnZW42X2dtY2hfcmVtb3ZlOwo+ID4gICAJZ2d0dC0+dm0uaW5zZXJ0X3BhZ2Ug
PSBnZW44X2dndHRfaW5zZXJ0X3BhZ2U7Cj4gPiAgIAlnZ3R0LT52bS5jbGVhcl9yYW5nZSA9IG5v
cF9jbGVhcl9yYW5nZTsKPiA+IC0JaWYgKGludGVsX3NjYW5vdXRfbmVlZHNfdnRkX3dhKGRldl9w
cml2KSkKPiA+ICsJaWYgKGludGVsX3NjYW5vdXRfbmVlZHNfdnRkX3dhKGk5MTUpKQo+ID4gICAJ
CWdndHQtPnZtLmNsZWFyX3JhbmdlID0gZ2VuOF9nZ3R0X2NsZWFyX3JhbmdlOwo+ID4gICAJZ2d0
dC0+dm0uaW5zZXJ0X2VudHJpZXMgPSBnZW44X2dndHRfaW5zZXJ0X2VudHJpZXM7Cj4gPiAgIAkv
KiBTZXJpYWxpemUgR1RUIHVwZGF0ZXMgd2l0aCBhcGVydHVyZSBhY2Nlc3Mgb24gQlhUIGlmIFZU
LWQgaXMgb24uICovCj4gPiAtCWlmIChpbnRlbF9nZ3R0X3VwZGF0ZV9uZWVkc192dGRfd2EoZGV2
X3ByaXYpIHx8Cj4gPiAtCSAgICBJU19DSEVSUllWSUVXKGRldl9wcml2KSAvKiBmYWlscyB3aXRo
IGNvbmN1cnJlbnQgdXNlL3VwZGF0ZSAqLykgewo+ID4gKwlpZiAoaW50ZWxfZ2d0dF91cGRhdGVf
bmVlZHNfdnRkX3dhKGk5MTUpIHx8Cj4gPiArCSAgICBJU19DSEVSUllWSUVXKGk5MTUpIC8qIGZh
aWxzIHdpdGggY29uY3VycmVudCB1c2UvdXBkYXRlICovKSB7Cj4gPiAgIAkJZ2d0dC0+dm0uaW5z
ZXJ0X2VudHJpZXMgPSBieHRfdnRkX2dndHRfaW5zZXJ0X2VudHJpZXNfX0JLTDsKPiA+ICAgCQln
Z3R0LT52bS5pbnNlcnRfcGFnZSAgICA9IGJ4dF92dGRfZ2d0dF9pbnNlcnRfcGFnZV9fQktMOwo+
ID4gICAJCWlmIChnZ3R0LT52bS5jbGVhcl9yYW5nZSAhPSBub3BfY2xlYXJfcmFuZ2UpCj4gPiAg
IAkJCWdndHQtPnZtLmNsZWFyX3JhbmdlID0gYnh0X3Z0ZF9nZ3R0X2NsZWFyX3JhbmdlX19CS0w7
Cj4gPiAgIAkJLyogUHJldmVudCByZWN1cnNpdmVseSBjYWxsaW5nIHN0b3BfbWFjaGluZSgpIGFu
ZCBkZWFkbG9ja3MuICovCj4gPiAtCQlkZXZfaW5mbyhkZXZfcHJpdi0+ZHJtLmRldiwKPiA+ICsJ
CWRldl9pbmZvKGk5MTUtPmRybS5kZXYsCj4gPiAgIAkJCSAiRGlzYWJsaW5nIGVycm9yIGNhcHR1
cmUgZm9yIFZULWQgd29ya2Fyb3VuZFxuIik7Cj4gPiAtCQlpOTE1X2Rpc2FibGVfZXJyb3Jfc3Rh
dGUoZGV2X3ByaXYsIC1FTk9ERVYpOwo+ID4gKwkJaTkxNV9kaXNhYmxlX2Vycm9yX3N0YXRlKGk5
MTUsIC1FTk9ERVYpOwo+ID4gICAJfQo+ID4gICAJZ2d0dC0+aW52YWxpZGF0ZSA9IGdlbjZfZ2d0
dF9pbnZhbGlkYXRlOwo+ID4gQEAgLTMzNzYsMTUgKzMzNzYsMTUgQEAgc3RhdGljIGludCBnZW44
X2dtY2hfcHJvYmUoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCkKPiA+ICAgCWdndHQtPnZtLnB0ZV9l
bmNvZGUgPSBnZW44X3B0ZV9lbmNvZGU7Cj4gPiAtCXNldHVwX3ByaXZhdGVfcGF0KGRldl9wcml2
KTsKPiA+ICsJc2V0dXBfcHJpdmF0ZV9wYXQoaTkxNSk7Cj4gPiAgIAlyZXR1cm4gZ2d0dF9wcm9i
ZV9jb21tb24oZ2d0dCwgc2l6ZSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGludCBnZW42X2dtY2hf
cHJvYmUoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBnZ3R0LT52bS5pOTE1Owo+ID4gLQlzdHJ1Y3QgcGNpX2Rl
diAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBnZ3R0LT52bS5pOTE1Owo+ID4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5
MTUtPmRybS5wZGV2Owo+ID4gICAJdW5zaWduZWQgaW50IHNpemU7Cj4gPiAgIAl1MTYgc25iX2dt
Y2hfY3RsOwo+ID4gICAJaW50IGVycjsKPiA+IEBAIC0zNDEzLDcgKzM0MTMsNyBAQCBzdGF0aWMg
aW50IGdlbjZfZ21jaF9wcm9iZShzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQo+ID4gICAJZ2d0dC0+
dm0udG90YWwgPSAoc2l6ZSAvIHNpemVvZihnZW42X3B0ZV90KSkgKiBJOTE1X0dUVF9QQUdFX1NJ
WkU7Cj4gPiAgIAlnZ3R0LT52bS5jbGVhcl9yYW5nZSA9IG5vcF9jbGVhcl9yYW5nZTsKPiA+IC0J
aWYgKCFIQVNfRlVMTF9QUEdUVChkZXZfcHJpdikgfHwgaW50ZWxfc2Nhbm91dF9uZWVkc192dGRf
d2EoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19GVUxMX1BQR1RUKGk5MTUpIHx8IGludGVsX3Nj
YW5vdXRfbmVlZHNfdnRkX3dhKGk5MTUpKQo+ID4gICAJCWdndHQtPnZtLmNsZWFyX3JhbmdlID0g
Z2VuNl9nZ3R0X2NsZWFyX3JhbmdlOwo+ID4gICAJZ2d0dC0+dm0uaW5zZXJ0X3BhZ2UgPSBnZW42
X2dndHRfaW5zZXJ0X3BhZ2U7Cj4gPiAgIAlnZ3R0LT52bS5pbnNlcnRfZW50cmllcyA9IGdlbjZf
Z2d0dF9pbnNlcnRfZW50cmllczsKPiA+IEBAIC0zNDIxLDEzICszNDIxLDEzIEBAIHN0YXRpYyBp
bnQgZ2VuNl9nbWNoX3Byb2JlKHN0cnVjdCBpOTE1X2dndHQgKmdndHQpCj4gPiAgIAlnZ3R0LT5p
bnZhbGlkYXRlID0gZ2VuNl9nZ3R0X2ludmFsaWRhdGU7Cj4gPiAtCWlmIChIQVNfRURSQU0oZGV2
X3ByaXYpKQo+ID4gKwlpZiAoSEFTX0VEUkFNKGk5MTUpKQo+ID4gICAJCWdndHQtPnZtLnB0ZV9l
bmNvZGUgPSBpcmlzX3B0ZV9lbmNvZGU7Cj4gPiAtCWVsc2UgaWYgKElTX0hBU1dFTEwoZGV2X3By
aXYpKQo+ID4gKwllbHNlIGlmIChJU19IQVNXRUxMKGk5MTUpKQo+ID4gICAJCWdndHQtPnZtLnB0
ZV9lbmNvZGUgPSBoc3dfcHRlX2VuY29kZTsKPiA+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhk
ZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCj4gPiAgIAkJZ2d0
dC0+dm0ucHRlX2VuY29kZSA9IGJ5dF9wdGVfZW5jb2RlOwo+ID4gLQllbHNlIGlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDcpCj4gPiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA3KQo+
ID4gICAJCWdndHQtPnZtLnB0ZV9lbmNvZGUgPSBpdmJfcHRlX2VuY29kZTsKPiA+ICAgCWVsc2UK
PiA+ICAgCQlnZ3R0LT52bS5wdGVfZW5jb2RlID0gc25iX3B0ZV9lbmNvZGU7Cj4gPiBAQCAtMzQ0
NywxMSArMzQ0NywxMSBAQCBzdGF0aWMgdm9pZCBpOTE1X2dtY2hfcmVtb3ZlKHN0cnVjdCBpOTE1
X2FkZHJlc3Nfc3BhY2UgKnZtKQo+ID4gICBzdGF0aWMgaW50IGk5MTVfZ21jaF9wcm9iZShzdHJ1
Y3QgaTkxNV9nZ3R0ICpnZ3R0KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGdndHQtPnZtLmk5MTU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gZ2d0dC0+dm0uaTkxNTsKPiA+ICAgCXBoeXNfYWRkcl90IGdtYWRyX2Jhc2U7Cj4g
PiAgIAlpbnQgcmV0Owo+ID4gLQlyZXQgPSBpbnRlbF9nbWNoX3Byb2JlKGRldl9wcml2LT5icmlk
Z2VfZGV2LCBkZXZfcHJpdi0+ZHJtLnBkZXYsIE5VTEwpOwo+ID4gKwlyZXQgPSBpbnRlbF9nbWNo
X3Byb2JlKGk5MTUtPmJyaWRnZV9kZXYsIGk5MTUtPmRybS5wZGV2LCBOVUxMKTsKPiA+ICAgCWlm
ICghcmV0KSB7Cj4gPiAgIAkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gc2V0IHVwIGdtY2hcbiIpOwo+
ID4gICAJCXJldHVybiAtRUlPOwo+ID4gQEAgLTM0NjMsNyArMzQ2Myw3IEBAIHN0YXRpYyBpbnQg
aTkxNV9nbWNoX3Byb2JlKHN0cnVjdCBpOTE1X2dndHQgKmdndHQpCj4gPiAgIAkJKHN0cnVjdCBy
ZXNvdXJjZSkgREVGSU5FX1JFU19NRU0oZ21hZHJfYmFzZSwKPiA+ICAgCQkJCQkJIGdndHQtPm1h
cHBhYmxlX2VuZCk7Cj4gPiAtCWdndHQtPmRvX2lkbGVfbWFwcyA9IG5lZWRzX2lkbGVfbWFwcyhk
ZXZfcHJpdik7Cj4gPiArCWdndHQtPmRvX2lkbGVfbWFwcyA9IG5lZWRzX2lkbGVfbWFwcyhpOTE1
KTsKPiA+ICAgCWdndHQtPnZtLmluc2VydF9wYWdlID0gaTkxNV9nZ3R0X2luc2VydF9wYWdlOwo+
ID4gICAJZ2d0dC0+dm0uaW5zZXJ0X2VudHJpZXMgPSBpOTE1X2dndHRfaW5zZXJ0X2VudHJpZXM7
Cj4gPiAgIAlnZ3R0LT52bS5jbGVhcl9yYW5nZSA9IGk5MTVfZ2d0dF9jbGVhcl9yYW5nZTsKPiA+
IEBAIC0zNDg0LDE5ICszNDg0LDE5IEBAIHN0YXRpYyBpbnQgaTkxNV9nbWNoX3Byb2JlKHN0cnVj
dCBpOTE1X2dndHQgKmdndHQpCj4gPiAgIC8qKgo+ID4gICAgKiBpOTE1X2dndHRfcHJvYmVfaHcg
LSBQcm9iZSBHR1RUIGhhcmR3YXJlIGxvY2F0aW9uCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRl
dmljZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZQo+ID4gICAgKi8KPiA+IC1pbnQgaTkxNV9n
Z3R0X3Byb2JlX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQg
aTkxNV9nZ3R0X3Byb2JlX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBpOTE1X2dndHQgKmdndHQgPSAmZGV2X3ByaXYtPmdndHQ7Cj4gPiArCXN0
cnVjdCBpOTE1X2dndHQgKmdndHQgPSAmaTkxNS0+Z2d0dDsKPiA+ICAgCWludCByZXQ7Cj4gPiAt
CWdndHQtPnZtLmk5MTUgPSBkZXZfcHJpdjsKPiA+IC0JZ2d0dC0+dm0uZG1hID0gJmRldl9wcml2
LT5kcm0ucGRldi0+ZGV2Owo+ID4gKwlnZ3R0LT52bS5pOTE1ID0gaTkxNTsKPiA+ICsJZ2d0dC0+
dm0uZG1hID0gJmk5MTUtPmRybS5wZGV2LT5kZXY7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpIDw9IDUpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPD0gNSkKPiA+ICAgCQlyZXQgPSBp
OTE1X2dtY2hfcHJvYmUoZ2d0dCk7Cj4gPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
PCA4KQo+ID4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPCA4KQo+ID4gICAJCXJldCA9IGdl
bjZfZ21jaF9wcm9iZShnZ3R0KTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlyZXQgPSBnZW44X2dtY2hf
cHJvYmUoZ2d0dCk7Cj4gPiBAQCAtMzUzMiwzNSArMzUzMiwzNSBAQCBpbnQgaTkxNV9nZ3R0X3By
b2JlX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgLyoqCj4gPiAg
ICAqIGk5MTVfZ2d0dF9pbml0X2h3IC0gSW5pdGlhbGl6ZSBHR1RUIGhhcmR3YXJlCj4gPiAtICog
QGRldl9wcml2OiBpOTE1IGRldmljZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZQo+ID4gICAg
Ki8KPiA+IC1pbnQgaTkxNV9nZ3R0X2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gK2ludCBpOTE1X2dndHRfaW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2
LT5nZ3R0Owo+ID4gKwlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmk5MTUtPmdndHQ7Cj4gPiAg
IAlpbnQgcmV0Owo+ID4gLQlzdGFzaF9pbml0KCZkZXZfcHJpdi0+bW0ud2Nfc3Rhc2gpOwo+ID4g
KwlzdGFzaF9pbml0KCZpOTE1LT5tbS53Y19zdGFzaCk7Cj4gPiAgIAkvKiBOb3RlIHRoYXQgd2Ug
dXNlIHBhZ2UgY29sb3VyaW5nIHRvIGVuZm9yY2UgYSBndWFyZCBwYWdlIGF0IHRoZQo+ID4gICAJ
ICogZW5kIG9mIHRoZSBhZGRyZXNzIHNwYWNlLiBUaGlzIGlzIHJlcXVpcmVkIGFzIHRoZSBDUyBt
YXkgcHJlZmV0Y2gKPiA+ICAgCSAqIGJleW9uZCB0aGUgZW5kIG9mIHRoZSBiYXRjaCBidWZmZXIs
IGFjcm9zcyB0aGUgcGFnZSBib3VuZGFyeSwKPiA+ICAgCSAqIGFuZCBiZXlvbmQgdGhlIGVuZCBv
ZiB0aGUgR1RUIGlmIHdlIGRvIG5vdCBwcm92aWRlIGEgZ3VhcmQuCj4gPiAgIAkgKi8KPiA+IC0J
bXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwltdXRleF9sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICAgCWk5MTVfYWRkcmVzc19zcGFjZV9pbml0
KCZnZ3R0LT52bSwgVk1fQ0xBU1NfR0dUVCk7Cj4gPiAgIAlnZ3R0LT52bS5pc19nZ3R0ID0gdHJ1
ZTsKPiA+ICAgCS8qIE9ubHkgVkxWIHN1cHBvcnRzIHJlYWQtb25seSBHR1RUIG1hcHBpbmdzICov
Cj4gPiAtCWdndHQtPnZtLmhhc19yZWFkX29ubHkgPSBJU19WQUxMRVlWSUVXKGRldl9wcml2KTsK
PiA+ICsJZ2d0dC0+dm0uaGFzX3JlYWRfb25seSA9IElTX1ZBTExFWVZJRVcoaTkxNSk7Cj4gPiAt
CWlmICghSEFTX0xMQyhkZXZfcHJpdikgJiYgIUhBU19QUEdUVChkZXZfcHJpdikpCj4gPiArCWlm
ICghSEFTX0xMQyhpOTE1KSAmJiAhSEFTX1BQR1RUKGk5MTUpKQo+ID4gICAJCWdndHQtPnZtLm1t
LmNvbG9yX2FkanVzdCA9IGk5MTVfZ3R0X2NvbG9yX2FkanVzdDsKPiA+IC0JbXV0ZXhfdW5sb2Nr
KCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAtCWlmICghaW9fbWFwcGluZ19pbml0X3djKCZkZXZfcHJp
di0+Z2d0dC5pb21hcCwKPiA+IC0JCQkJZGV2X3ByaXYtPmdndHQuZ21hZHIuc3RhcnQsCj4gPiAt
CQkJCWRldl9wcml2LT5nZ3R0Lm1hcHBhYmxlX2VuZCkpIHsKPiA+ICsJaWYgKCFpb19tYXBwaW5n
X2luaXRfd2MoJmk5MTUtPmdndHQuaW9tYXAsCj4gPiArCQkJCWk5MTUtPmdndHQuZ21hZHIuc3Rh
cnQsCj4gPiArCQkJCWk5MTUtPmdndHQubWFwcGFibGVfZW5kKSkgewo+ID4gICAJCXJldCA9IC1F
SU87Cj4gPiAgIAkJZ290byBvdXRfZ3R0X2NsZWFudXA7Cj4gPiAgIAl9Cj4gPiBAQCAtMzU3MSw3
ICszNTcxLDcgQEAgaW50IGk5MTVfZ2d0dF9pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiA+ICAgCSAqIEluaXRpYWxpc2Ugc3RvbGVuIGVhcmx5IHNvIHRoYXQgd2Ug
bWF5IHJlc2VydmUgcHJlYWxsb2NhdGVkCj4gPiAgIAkgKiBvYmplY3RzIGZvciB0aGUgQklPUyB0
byBLTVMgdHJhbnNpdGlvbi4KPiA+ICAgCSAqLwo+ID4gLQlyZXQgPSBpOTE1X2dlbV9pbml0X3N0
b2xlbihkZXZfcHJpdik7Cj4gPiArCXJldCA9IGk5MTVfZ2VtX2luaXRfc3RvbGVuKGk5MTUpOwo+
ID4gICAJaWYgKHJldCkKPiA+ICAgCQlnb3RvIG91dF9ndHRfY2xlYW51cDsKPiA+IEBAIC0zNTgy
LDkgKzM1ODIsOSBAQCBpbnQgaTkxNV9nZ3R0X2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gLWludCBpOTE1X2dn
dHRfZW5hYmxlX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQg
aTkxNV9nZ3R0X2VuYWJsZV9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAg
ewo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDYgJiYgIWludGVsX2VuYWJsZV9ndHQo
KSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDYgJiYgIWludGVsX2VuYWJsZV9ndHQoKSkK
PiA+ICAgCQlyZXR1cm4gLUVJTzsKPiA+ICAgCXJldHVybiAwOwo+ID4gQEAgLTM2MTMsMTIgKzM2
MTMsMTIgQEAgdm9pZCBpOTE1X2dndHRfZGlzYWJsZV9ndWMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gPiAgIAlpOTE1X2dndHRfaW52YWxpZGF0ZShpOTE1KTsKPiA+ICAgfQo+ID4g
LXZvaWQgaTkxNV9nZW1fcmVzdG9yZV9ndHRfbWFwcGluZ3Moc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaTkxNV9nZW1fcmVzdG9yZV9ndHRfbWFwcGluZ3Moc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGk5MTVfZ2d0
dCAqZ2d0dCA9ICZkZXZfcHJpdi0+Z2d0dDsKPiA+ICsJc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9
ICZpOTE1LT5nZ3R0Owo+ID4gICAJc3RydWN0IGk5MTVfdm1hICp2bWEsICp2bjsKPiA+IC0JaTkx
NV9jaGVja19hbmRfY2xlYXJfZmF1bHRzKGRldl9wcml2KTsKPiA+ICsJaTkxNV9jaGVja19hbmRf
Y2xlYXJfZmF1bHRzKGk5MTUpOwo+ID4gICAJbXV0ZXhfbG9jaygmZ2d0dC0+dm0ubXV0ZXgpOwo+
ID4gQEAgLTM2NTIsMTUgKzM2NTIsMTUgQEAgdm9pZCBpOTE1X2dlbV9yZXN0b3JlX2d0dF9tYXBw
aW5ncyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAl9Cj4gPiAgIAln
Z3R0LT52bS5jbG9zZWQgPSBmYWxzZTsKPiA+IC0JaTkxNV9nZ3R0X2ludmFsaWRhdGUoZGV2X3By
aXYpOwo+ID4gKwlpOTE1X2dndHRfaW52YWxpZGF0ZShpOTE1KTsKPiA+ICAgCW11dGV4X3VubG9j
aygmZ2d0dC0+dm0ubXV0ZXgpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KSB7
Cj4gPiAtCQlzdHJ1Y3QgaW50ZWxfcHBhdCAqcHBhdCA9ICZkZXZfcHJpdi0+cHBhdDsKPiA+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KSB7Cj4gPiArCQlzdHJ1Y3QgaW50ZWxfcHBhdCAqcHBh
dCA9ICZpOTE1LT5wcGF0Owo+ID4gICAJCWJpdG1hcF9zZXQocHBhdC0+ZGlydHksIDAsIHBwYXQt
Pm1heF9lbnRyaWVzKTsKPiA+IC0JCWRldl9wcml2LT5wcGF0LnVwZGF0ZV9odyhkZXZfcHJpdik7
Cj4gPiArCQlpOTE1LT5wcGF0LnVwZGF0ZV9odyhpOTE1KTsKPiA+ICAgCQlyZXR1cm47Cj4gPiAg
IAl9Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dl
bV9ndHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5oCj4gPiBpbmRleCA4
OTQzN2QwYTcyMWMuLmI0NDQ1NTJjY2M2MyAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2VtX2d0dC5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dlbV9ndHQuaAo+ID4gQEAgLTQwMCw3ICs0MDAsNyBAQCBzdHJ1Y3QgaTkxNV9nZ3R0IHsKPiA+
ICAgCS8qKiAiR3JhcGhpY3MgU3RvbGVuIE1lbW9yeSIgaG9sZHMgdGhlIGdsb2JhbCBQVEVzICov
Cj4gPiAgIAl2b2lkIF9faW9tZW0gKmdzbTsKPiA+IC0Jdm9pZCAoKmludmFsaWRhdGUpKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArCXZvaWQgKCppbnZhbGlkYXRlKShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIAlib29sIGRvX2lkbGVfbWFwczsK
PiA+IEBAIC02MjcsMTcgKzYyNywxNyBAQCBjb25zdCBzdHJ1Y3QgaW50ZWxfcHBhdF9lbnRyeSAq
Cj4gPiAgIGludGVsX3BwYXRfZ2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1OCB2
YWx1ZSk7Cj4gPiAgIHZvaWQgaW50ZWxfcHBhdF9wdXQoY29uc3Qgc3RydWN0IGludGVsX3BwYXRf
ZW50cnkgKmVudHJ5KTsKPiA+IC1pbnQgaTkxNV9nZ3R0X3Byb2JlX2h3KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtaW50IGk5MTVfZ2d0dF9pbml0X2h3KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtaW50IGk5MTVfZ2d0dF9lbmFibGVfaHco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtpbnQgaTkxNV9nZ3R0X3By
b2JlX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICtpbnQgaTkxNV9nZ3R0
X2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK2ludCBpOTE1X2dn
dHRfZW5hYmxlX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgdm9pZCBp
OTE1X2dndHRfZW5hYmxlX2d1YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAg
IHZvaWQgaTkxNV9nZ3R0X2Rpc2FibGVfZ3VjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KTsKPiA+IC1pbnQgaTkxNV9nZW1faW5pdF9nZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gPiAtdm9pZCBpOTE1X2dndHRfY2xlYW51cF9odyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK2ludCBpOTE1X2dlbV9pbml0X2dndHQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaTkxNV9nZ3R0X2NsZWFudXBfaHcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gLWludCBpOTE1X3BwZ3R0X2luaXRfaHco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtpbnQgaTkxNV9wcGd0dF9p
bml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+IC1zdHJ1Y3QgaTkxNV9w
cGd0dCAqaTkxNV9wcGd0dF9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiA+ICtzdHJ1Y3QgaTkxNV9wcGd0dCAqaTkxNV9wcGd0dF9jcmVhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICBzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2FkZHJl
c3Nfc3BhY2UgKgo+ID4gICBpOTE1X3ZtX2dldChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2
bSkKPiA+IEBAIC02NTcsOCArNjU3LDggQEAgaW50IGdlbjZfcHBndHRfcGluKHN0cnVjdCBpOTE1
X3BwZ3R0ICpiYXNlKTsKPiA+ICAgdm9pZCBnZW42X3BwZ3R0X3VucGluKHN0cnVjdCBpOTE1X3Bw
Z3R0ICpiYXNlKTsKPiA+ICAgdm9pZCBnZW42X3BwZ3R0X3VucGluX2FsbChzdHJ1Y3QgaTkxNV9w
cGd0dCAqYmFzZSk7Cj4gPiAtdm9pZCBpOTE1X2dlbV9zdXNwZW5kX2d0dF9tYXBwaW5ncyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgaTkxNV9nZW1fcmVzdG9y
ZV9ndHRfbWFwcGluZ3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICt2
b2lkIGk5MTVfZ2VtX3N1c3BlbmRfZ3R0X21hcHBpbmdzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KTsKPiA+ICt2b2lkIGk5MTVfZ2VtX3Jlc3RvcmVfZ3R0X21hcHBpbmdzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgaW50IF9fbXVzdF9jaGVjayBpOTE1X2dlbV9n
dHRfcHJlcGFyZV9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ID4gICAJ
CQkJCSAgICBzdHJ1Y3Qgc2dfdGFibGUgKnBhZ2VzKTsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9ncHVfZXJyb3IuYwo+ID4gaW5kZXggZDdmMTY0YzlmMmViLi4zMzVkYTU5MDMxYjAgMTAwNjQ0
Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCj4gPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCj4gPiBAQCAtMTEyMiwyMiAr
MTEyMiwyMiBAQCBzdGF0aWMgdTMyIGk5MTVfZXJyb3JfZ2VuZXJhdGVfY29kZShzdHJ1Y3QgaTkx
NV9ncHVfc3RhdGUgKmVycm9yLAo+ID4gICBzdGF0aWMgdm9pZCBnZW1fcmVjb3JkX2ZlbmNlcyhz
dHJ1Y3QgaTkxNV9ncHVfc3RhdGUgKmVycm9yKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGVycm9yLT5pOTE1Owo+ID4gLQlzdHJ1Y3QgaW50ZWxfdW5j
b3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBlcnJvci0+aTkxNTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5j
b3JlID0gJmk5MTUtPnVuY29yZTsKPiA+ICAgCWludCBpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSA2KSB7Cj4gPiAtCQlmb3IgKGkgPSAwOyBpIDwgZGV2X3ByaXYtPm51bV9mZW5j
ZV9yZWdzOyBpKyspCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikgewo+ID4gKwkJZm9y
IChpID0gMDsgaSA8IGk5MTUtPm51bV9mZW5jZV9yZWdzOyBpKyspCj4gPiAgIAkJCWVycm9yLT5m
ZW5jZVtpXSA9Cj4gPiAgIAkJCQlpbnRlbF91bmNvcmVfcmVhZDY0KHVuY29yZSwKPiA+ICAgCQkJ
CQkJICAgIEZFTkNFX1JFR19HRU42X0xPKGkpKTsKPiA+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDQpIHsKPiA+IC0JCWZvciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+bnVtX2Zl
bmNlX3JlZ3M7IGkrKykKPiA+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkgewo+
ID4gKwkJZm9yIChpID0gMDsgaSA8IGk5MTUtPm51bV9mZW5jZV9yZWdzOyBpKyspCj4gPiAgIAkJ
CWVycm9yLT5mZW5jZVtpXSA9Cj4gPiAgIAkJCQlpbnRlbF91bmNvcmVfcmVhZDY0KHVuY29yZSwK
PiA+ICAgCQkJCQkJICAgIEZFTkNFX1JFR185NjVfTE8oaSkpOwo+ID4gICAJfSBlbHNlIHsKPiA+
IC0JCWZvciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+bnVtX2ZlbmNlX3JlZ3M7IGkrKykKPiA+ICsJ
CWZvciAoaSA9IDA7IGkgPCBpOTE1LT5udW1fZmVuY2VfcmVnczsgaSsrKQo+ID4gICAJCQllcnJv
ci0+ZmVuY2VbaV0gPQo+ID4gICAJCQkJaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBGRU5DRV9S
RUcoaSkpOwo+ID4gICAJfQo+ID4gQEAgLTExNDgsMjMgKzExNDgsMjMgQEAgc3RhdGljIHZvaWQg
ZXJyb3JfcmVjb3JkX2VuZ2luZV9yZWdpc3RlcnMoc3RydWN0IGk5MTVfZ3B1X3N0YXRlICplcnJv
ciwKPiA+ICAgCQkJCQkgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKPiA+ICAgCQkJ
CQkgIHN0cnVjdCBkcm1faTkxNV9lcnJvcl9lbmdpbmUgKmVlKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGVuZ2luZS0+aTkxNTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBlbmdpbmUtPmk5MTU7Cj4gPiAtCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDYpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KSB7Cj4g
PiAgIAkJZWUtPnJjX3BzbWkgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfUFNNSV9DVEwpOwo+
ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkKPiA+ICsJCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gOCkKPiA+ICAgCQkJZWUtPmZhdWx0X3JlZyA9IEk5MTVfUkVBRChHRU44X1JJTkdf
RkFVTFRfUkVHKTsKPiA+ICAgCQllbHNlCj4gPiAgIAkJCWVlLT5mYXVsdF9yZWcgPSBHRU42X1JJ
TkdfRkFVTFRfUkVHX1JFQUQoZW5naW5lKTsKPiA+ICAgCX0KPiA+IC0JaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gNCkgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpIHsKPiA+ICAg
CQllZS0+ZmFkZHIgPSBFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfRE1BX0ZBREQpOwo+ID4gICAJ
CWVlLT5pcGVpciA9IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19JUEVJUik7Cj4gPiAgIAkJZWUt
PmlwZWhyID0gRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX0lQRUhSKTsKPiA+ICAgCQllZS0+aW5z
dHBzID0gRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX0lOU1RQUyk7Cj4gPiAgIAkJZWUtPmJiYWRk
ciA9IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19CQkFERFIpOwo+ID4gLQkJaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gOCkgewo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KSB7Cj4g
PiAgIAkJCWVlLT5mYWRkciB8PSAodTY0KUVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19ETUFfRkFE
RF9VRFcpIDw8IDMyOwo+ID4gICAJCQllZS0+YmJhZGRyIHw9ICh1NjQpRU5HSU5FX1JFQUQoZW5n
aW5lLCBSSU5HX0JCQUREUl9VRFcpIDw8IDMyOwo+ID4gICAJCX0KPiA+IEBAIC0xMTgzLDEzICsx
MTgzLDEzIEBAIHN0YXRpYyB2b2lkIGVycm9yX3JlY29yZF9lbmdpbmVfcmVnaXN0ZXJzKHN0cnVj
dCBpOTE1X2dwdV9zdGF0ZSAqZXJyb3IsCj4gPiAgIAllZS0+aGVhZCA9IEVOR0lORV9SRUFEKGVu
Z2luZSwgUklOR19IRUFEKTsKPiA+ICAgCWVlLT50YWlsID0gRU5HSU5FX1JFQUQoZW5naW5lLCBS
SU5HX1RBSUwpOwo+ID4gICAJZWUtPmN0bCA9IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19DVEwp
Owo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+IDIpCj4gPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPiAyKQo+ID4gICAJCWVlLT5tb2RlID0gRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX01J
X01PREUpOwo+ID4gLQlpZiAoIUhXU19ORUVEU19QSFlTSUNBTChkZXZfcHJpdikpIHsKPiA+ICsJ
aWYgKCFIV1NfTkVFRFNfUEhZU0lDQUwoaTkxNSkpIHsKPiA+ICAgCQlpOTE1X3JlZ190IG1taW87
Cj4gPiAtCQlpZiAoSVNfR0VOKGRldl9wcml2LCA3KSkgewo+ID4gKwkJaWYgKElTX0dFTihpOTE1
LCA3KSkgewo+ID4gICAJCQlzd2l0Y2ggKGVuZ2luZS0+aWQpIHsKPiA+ICAgCQkJZGVmYXVsdDoK
PiA+ICAgCQkJCU1JU1NJTkdfQ0FTRShlbmdpbmUtPmlkKTsKPiA+IEBAIC0xMjE5LDIxICsxMjE5
LDIxIEBAIHN0YXRpYyB2b2lkIGVycm9yX3JlY29yZF9lbmdpbmVfcmVnaXN0ZXJzKHN0cnVjdCBp
OTE1X2dwdV9zdGF0ZSAqZXJyb3IsCj4gPiAgIAllZS0+aWRsZSA9IGludGVsX2VuZ2luZV9pc19p
ZGxlKGVuZ2luZSk7Cj4gPiAgIAlpZiAoIWVlLT5pZGxlKQo+ID4gICAJCWVlLT5oYW5nY2hlY2tf
dGltZXN0YW1wID0gZW5naW5lLT5oYW5nY2hlY2suYWN0aW9uX3RpbWVzdGFtcDsKPiA+IC0JZWUt
PnJlc2V0X2NvdW50ID0gaTkxNV9yZXNldF9lbmdpbmVfY291bnQoJmRldl9wcml2LT5ncHVfZXJy
b3IsCj4gPiArCWVlLT5yZXNldF9jb3VudCA9IGk5MTVfcmVzZXRfZW5naW5lX2NvdW50KCZpOTE1
LT5ncHVfZXJyb3IsCj4gPiAgIAkJCQkJCSAgZW5naW5lKTsKPiA+IC0JaWYgKEhBU19QUEdUVChk
ZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19QUEdUVChpOTE1KSkgewo+ID4gICAJCWludCBpOwo+
ID4gICAJCWVlLT52bV9pbmZvLmdmeF9tb2RlID0gRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX01P
REVfR0VONyk7Cj4gPiAtCQlpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkgewo+ID4gKwkJaWYgKElT
X0dFTihpOTE1LCA2KSkgewo+ID4gICAJCQllZS0+dm1faW5mby5wcF9kaXJfYmFzZSA9Cj4gPiAg
IAkJCQlFTkdJTkVfUkVBRChlbmdpbmUsIFJJTkdfUFBfRElSX0JBU0VfUkVBRCk7Cj4gPiAtCQl9
IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgNykpIHsKPiA+ICsJCX0gZWxzZSBpZiAoSVNfR0VO
KGk5MTUsIDcpKSB7Cj4gPiAgIAkJCWVlLT52bV9pbmZvLnBwX2Rpcl9iYXNlID0KPiA+ICAgCQkJ
CUVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19QUF9ESVJfQkFTRSk7Cj4gPiAtCQl9IGVsc2UgaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkgewo+ID4gKwkJfSBlbHNlIGlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gOCkgewo+ID4gICAJCQl1MzIgYmFzZSA9IGVuZ2luZS0+bW1pb19iYXNlOwo+ID4g
ICAJCQlmb3IgKGkgPSAwOyBpIDwgNDsgaSsrKSB7Cj4gPiBAQCAtMTM4OCw3ICsxMzg4LDcgQEAg
c3RhdGljIHZvaWQgcmVxdWVzdF9yZWNvcmRfdXNlcl9ibyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
ZXF1ZXN0LAo+ID4gICB9Cj4gPiAgIHN0YXRpYyBzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jfb2JqZWN0
ICoKPiA+IC1jYXB0dXJlX29iamVjdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiArY2FwdHVyZV9vYmplY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAg
IAkgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiA+ICAgewo+ID4gICAJ
aWYgKG9iaiAmJiBpOTE1X2dlbV9vYmplY3RfaGFzX3BhZ2VzKG9iaikpIHsKPiA+IEBAIC0xMzk5
LDcgKzEzOTksNyBAQCBjYXB0dXJlX29iamVjdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAgIAkJCS5vYmogPSBvYmosCj4gPiAgIAkJfTsKPiA+IC0JCXJldHVybiBpOTE1
X2Vycm9yX29iamVjdF9jcmVhdGUoZGV2X3ByaXYsICZmYWtlKTsKPiA+ICsJCXJldHVybiBpOTE1
X2Vycm9yX29iamVjdF9jcmVhdGUoaTkxNSwgJmZha2UpOwo+ID4gICAJfSBlbHNlIHsKPiA+ICAg
CQlyZXR1cm4gTlVMTDsKPiA+ICAgCX0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dwdV9lcnJvci5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJy
b3IuaAo+ID4gaW5kZXggMmVjZDBjNmExYzk0Li45ODBmOTVmYjU1NzggMTAwNjQ0Cj4gPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5oCj4gPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5oCj4gPiBAQCAtMjM0LDcgKzIzNCw3IEBAIHN0
cnVjdCBpOTE1X2dwdV9lcnJvciB7Cj4gPiAgIAkvKioKPiA+ICAgCSAqIFdhaXRxdWV1ZSB0byBz
aWduYWwgd2hlbiB0aGUgcmVzZXQgaGFzIGNvbXBsZXRlZC4gVXNlZCBieSBjbGllbnRzCj4gPiAt
CSAqIHRoYXQgd2FpdCBmb3IgZGV2X3ByaXYtPm1tLndlZGdlZCB0byBzZXR0bGUuCj4gPiArCSAq
IHRoYXQgd2FpdCBmb3IgaTkxNS0+bW0ud2VkZ2VkIHRvIHNldHRsZS4KPiA+ICAgCSAqLwo+ID4g
ICAJd2FpdF9xdWV1ZV9oZWFkX3QgcmVzZXRfcXVldWU7Cj4gPiBAQCAtMjU5LDcgKzI1OSw3IEBA
IF9fcHJpbnRmKDIsIDMpCj4gPiAgIHZvaWQgaTkxNV9lcnJvcl9wcmludGYoc3RydWN0IGRybV9p
OTE1X2Vycm9yX3N0YXRlX2J1ZiAqZSwgY29uc3QgY2hhciAqZiwgLi4uKTsKPiA+ICAgc3RydWN0
IGk5MTVfZ3B1X3N0YXRlICppOTE1X2NhcHR1cmVfZ3B1X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KTsKPiA+IC12b2lkIGk5MTVfY2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpOTE1X2NhcHR1cmVfZXJyb3Jf
c3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgIGludGVs
X2VuZ2luZV9tYXNrX3QgZW5naW5lX21hc2ssCj4gPiAgIAkJCSAgICAgIGNvbnN0IGNoYXIgKmVy
cm9yX21zZyk7Cj4gPiBAQCAtMjg2LDcgKzI4Niw3IEBAIHZvaWQgaTkxNV9kaXNhYmxlX2Vycm9y
X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgZXJyKTsKPiA+ICAgI2Vs
c2UKPiA+IC1zdGF0aWMgaW5saW5lIHZvaWQgaTkxNV9jYXB0dXJlX2Vycm9yX3N0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW5saW5lIHZvaWQgaTkx
NV9jYXB0dXJlX2Vycm9yX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4g
ICAJCQkJCSAgICB1MzIgZW5naW5lX21hc2ssCj4gPiAgIAkJCQkJICAgIGNvbnN0IGNoYXIgKmVy
cm9yX21zZykKPiA+ICAgewo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfaXJxLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jCj4gPiBpbmRleCBjZDll
ZGRkZDY3MTguLjgxZWE2NWQ4NWI5ZiAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfaXJxLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMK
PiA+IEBAIC0yNTYsMTggKzI1NiwxOCBAQCBzdGF0aWMgdm9pZCBnZW4yX2lycV9pbml0KHN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSwKPiA+ICAgI2RlZmluZSBHRU4yX0lSUV9JTklUKHVuY29y
ZSwgaW1yX3ZhbCwgaWVyX3ZhbCkgXAo+ID4gICAJZ2VuMl9pcnFfaW5pdCgodW5jb3JlKSwgaW1y
X3ZhbCwgaWVyX3ZhbCkKPiA+IC1zdGF0aWMgdm9pZCBnZW42X3Jwc19pcnFfaGFuZGxlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwbV9paXIpOwo+ID4gLXN0YXRpYyB2
b2lkIGdlbjlfZ3VjX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgdTMyIHBtX2lpcik7Cj4gPiArc3RhdGljIHZvaWQgZ2VuNl9ycHNfaXJxX2hhbmRsZXIoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBwbV9paXIpOwo+ID4gK3N0YXRpYyB2b2lk
IGdlbjlfZ3VjX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIg
cG1faWlyKTsKPiA+ICAgLyogRm9yIGRpc3BsYXkgaG90cGx1ZyBpbnRlcnJ1cHQgKi8KPiA+ICAg
c3RhdGljIGlubGluZSB2b2lkCj4gPiAtaTkxNV9ob3RwbHVnX2ludGVycnVwdF91cGRhdGVfbG9j
a2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpOTE1X2hvdHBsdWdf
aW50ZXJydXB0X3VwZGF0ZV9sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgIAkJCQkgICAgIHUzMiBtYXNrLAo+ID4gICAJCQkJICAgICB1MzIgYml0cykKPiA+ICAgewo+
ID4gICAJdTMyIHZhbDsKPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmlycV9s
b2NrKTsKPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+ID4gICAJ
V0FSTl9PTihiaXRzICYgfm1hc2spOwo+ID4gICAJdmFsID0gSTkxNV9SRUFEKFBPUlRfSE9UUExV
R19FTik7Cj4gPiBAQCAtMjc4LDcgKzI3OCw3IEBAIGk5MTVfaG90cGx1Z19pbnRlcnJ1cHRfdXBk
YXRlX2xvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIC8qKgo+
ID4gICAgKiBpOTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0ZSAtIHVwZGF0ZSBob3RwbHVnIGlu
dGVycnVwdCBlbmFibGUKPiA+IC0gKiBAZGV2X3ByaXY6IGRyaXZlciBwcml2YXRlCj4gPiArICog
QGk5MTU6IGRyaXZlciBwcml2YXRlCj4gPiAgICAqIEBtYXNrOiBiaXRzIHRvIHVwZGF0ZQo+ID4g
ICAgKiBAYml0czogYml0cyB0byBlbmFibGUKPiA+ICAgICogTk9URTogdGhlIEhQRCBlbmFibGUg
Yml0cyBhcmUgbW9kaWZpZWQgYm90aCBpbnNpZGUgYW5kIG91dHNpZGUKPiA+IEBAIC0yODgsMTMg
KzI4OCwxMyBAQCBpOTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0ZV9sb2NrZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAgKiBoZWxkIGFscmVhZHksIHRoaXMgZnVu
Y3Rpb24gYWNxdWlyZXMgdGhlIGxvY2sgaXRzZWxmLiBBIG5vbi1sb2NraW5nCj4gPiAgICAqIHZl
cnNpb24gaXMgYWxzbyBhdmFpbGFibGUuCj4gPiAgICAqLwo+ID4gLXZvaWQgaTkxNV9ob3RwbHVn
X2ludGVycnVwdF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
K3ZvaWQgaTkxNV9ob3RwbHVnX2ludGVycnVwdF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCQkgICB1MzIgbWFzaywKPiA+ICAgCQkJCSAgIHUzMiBiaXRzKQo+
ID4gICB7Cj4gPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAtCWk5
MTVfaG90cGx1Z19pbnRlcnJ1cHRfdXBkYXRlX2xvY2tlZChkZXZfcHJpdiwgbWFzaywgYml0cyk7
Cj4gPiAtCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJc3Bpbl9s
b2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gKwlpOTE1X2hvdHBsdWdfaW50ZXJydXB0X3Vw
ZGF0ZV9sb2NrZWQoaTkxNSwgbWFzaywgYml0cyk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycSgmaTkx
NS0+aXJxX2xvY2spOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB1MzIKPiA+IEBAIC0zMzQsODQgKzMz
NCw4NCBAQCBzdGF0aWMgYm9vbCBnZW4xMV9yZXNldF9vbmVfaWlyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICogY29uc3QgaTkxNSwKPiA+ICAgLyoqCj4gPiAgICAqIGlsa191cGRhdGVfZGlzcGxh
eV9pcnEgLSB1cGRhdGUgREVJTVIKPiA+IC0gKiBAZGV2X3ByaXY6IGRyaXZlciBwcml2YXRlCj4g
PiArICogQGk5MTU6IGRyaXZlciBwcml2YXRlCj4gPiAgICAqIEBpbnRlcnJ1cHRfbWFzazogbWFz
ayBvZiBpbnRlcnJ1cHQgYml0cyB0byB1cGRhdGUKPiA+ICAgICogQGVuYWJsZWRfaXJxX21hc2s6
IG1hc2sgb2YgaW50ZXJydXB0IGJpdHMgdG8gZW5hYmxlCj4gPiAgICAqLwo+ID4gLXZvaWQgaWxr
X3VwZGF0ZV9kaXNwbGF5X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiArdm9pZCBpbGtfdXBkYXRlX2Rpc3BsYXlfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ID4gICAJCQkgICAgdTMyIGludGVycnVwdF9tYXNrLAo+ID4gICAJCQkgICAgdTMyIGVu
YWJsZWRfaXJxX21hc2spCj4gPiAgIHsKPiA+ICAgCXUzMiBuZXdfdmFsOwo+ID4gLQlsb2NrZGVw
X2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlsb2NrZGVwX2Fzc2VydF9o
ZWxkKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAgIAlXQVJOX09OKGVuYWJsZWRfaXJxX21hc2sgJiB+
aW50ZXJydXB0X21hc2spOwo+ID4gLQlpZiAoV0FSTl9PTighaW50ZWxfaXJxc19lbmFibGVkKGRl
dl9wcml2KSkpCj4gPiArCWlmIChXQVJOX09OKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkpKQo+
ID4gICAJCXJldHVybjsKPiA+IC0JbmV3X3ZhbCA9IGRldl9wcml2LT5pcnFfbWFzazsKPiA+ICsJ
bmV3X3ZhbCA9IGk5MTUtPmlycV9tYXNrOwo+ID4gICAJbmV3X3ZhbCAmPSB+aW50ZXJydXB0X21h
c2s7Cj4gPiAgIAluZXdfdmFsIHw9ICh+ZW5hYmxlZF9pcnFfbWFzayAmIGludGVycnVwdF9tYXNr
KTsKPiA+IC0JaWYgKG5ld192YWwgIT0gZGV2X3ByaXYtPmlycV9tYXNrKSB7Cj4gPiAtCQlkZXZf
cHJpdi0+aXJxX21hc2sgPSBuZXdfdmFsOwo+ID4gLQkJSTkxNV9XUklURShERUlNUiwgZGV2X3By
aXYtPmlycV9tYXNrKTsKPiA+ICsJaWYgKG5ld192YWwgIT0gaTkxNS0+aXJxX21hc2spIHsKPiA+
ICsJCWk5MTUtPmlycV9tYXNrID0gbmV3X3ZhbDsKPiA+ICsJCUk5MTVfV1JJVEUoREVJTVIsIGk5
MTUtPmlycV9tYXNrKTsKPiA+ICAgCQlQT1NUSU5HX1JFQUQoREVJTVIpOwo+ID4gICAJfQo+ID4g
ICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpbGtfdXBkYXRlX2d0X2lycSAtIHVwZGF0ZSBHVElNUgo+
ID4gLSAqIEBkZXZfcHJpdjogZHJpdmVyIHByaXZhdGUKPiA+ICsgKiBAaTkxNTogZHJpdmVyIHBy
aXZhdGUKPiA+ICAgICogQGludGVycnVwdF9tYXNrOiBtYXNrIG9mIGludGVycnVwdCBiaXRzIHRv
IHVwZGF0ZQo+ID4gICAgKiBAZW5hYmxlZF9pcnFfbWFzazogbWFzayBvZiBpbnRlcnJ1cHQgYml0
cyB0byBlbmFibGUKPiA+ICAgICovCj4gPiAtc3RhdGljIHZvaWQgaWxrX3VwZGF0ZV9ndF9pcnEo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGlsa191
cGRhdGVfZ3RfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAg
ICB1MzIgaW50ZXJydXB0X21hc2ssCj4gPiAgIAkJCSAgICAgIHUzMiBlbmFibGVkX2lycV9tYXNr
KQo+ID4gICB7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7
Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICAgCVdBUk5f
T04oZW5hYmxlZF9pcnFfbWFzayAmIH5pbnRlcnJ1cHRfbWFzayk7Cj4gPiAtCWlmIChXQVJOX09O
KCFpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpKSkKPiA+ICsJaWYgKFdBUk5fT04oIWludGVs
X2lycXNfZW5hYmxlZChpOTE1KSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlkZXZfcHJpdi0+Z3Rf
aXJxX21hc2sgJj0gfmludGVycnVwdF9tYXNrOwo+ID4gLQlkZXZfcHJpdi0+Z3RfaXJxX21hc2sg
fD0gKH5lbmFibGVkX2lycV9tYXNrICYgaW50ZXJydXB0X21hc2spOwo+ID4gLQlJOTE1X1dSSVRF
KEdUSU1SLCBkZXZfcHJpdi0+Z3RfaXJxX21hc2spOwo+ID4gKwlpOTE1LT5ndF9pcnFfbWFzayAm
PSB+aW50ZXJydXB0X21hc2s7Cj4gPiArCWk5MTUtPmd0X2lycV9tYXNrIHw9ICh+ZW5hYmxlZF9p
cnFfbWFzayAmIGludGVycnVwdF9tYXNrKTsKPiA+ICsJSTkxNV9XUklURShHVElNUiwgaTkxNS0+
Z3RfaXJxX21hc2spOwo+ID4gICB9Cj4gPiAtdm9pZCBnZW41X2VuYWJsZV9ndF9pcnEoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFzaykKPiA+ICt2b2lkIGdlbjVfZW5h
YmxlX2d0X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIG1hc2spCj4gPiAg
IHsKPiA+IC0JaWxrX3VwZGF0ZV9ndF9pcnEoZGV2X3ByaXYsIG1hc2ssIG1hc2spOwo+ID4gLQlp
bnRlbF91bmNvcmVfcG9zdGluZ19yZWFkX2Z3KCZkZXZfcHJpdi0+dW5jb3JlLCBHVElNUik7Cj4g
PiArCWlsa191cGRhdGVfZ3RfaXJxKGk5MTUsIG1hc2ssIG1hc2spOwo+ID4gKwlpbnRlbF91bmNv
cmVfcG9zdGluZ19yZWFkX2Z3KCZpOTE1LT51bmNvcmUsIEdUSU1SKTsKPiA+ICAgfQo+ID4gLXZv
aWQgZ2VuNV9kaXNhYmxlX2d0X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IHUzMiBtYXNrKQo+ID4gK3ZvaWQgZ2VuNV9kaXNhYmxlX2d0X2lycShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgdTMyIG1hc2spCj4gPiAgIHsKPiA+IC0JaWxrX3VwZGF0ZV9ndF9pcnEo
ZGV2X3ByaXYsIG1hc2ssIDApOwo+ID4gKwlpbGtfdXBkYXRlX2d0X2lycShpOTE1LCBtYXNrLCAw
KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpOTE1X3JlZ190IGdlbjZfcG1faWlyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgaTkxNV9yZWdfdCBnZW42X3BtX2lp
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlXQVJOX09OX09O
Q0UoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSk7Cj4gPiArCVdBUk5fT05fT05DRShJTlRFTF9H
RU4oaTkxNSkgPj0gMTEpOwo+ID4gLQlyZXR1cm4gSU5URUxfR0VOKGRldl9wcml2KSA+PSA4ID8g
R0VOOF9HVF9JSVIoMikgOiBHRU42X1BNSUlSOwo+ID4gKwlyZXR1cm4gSU5URUxfR0VOKGk5MTUp
ID49IDggPyBHRU44X0dUX0lJUigyKSA6IEdFTjZfUE1JSVI7Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
dm9pZCB3cml0ZV9wbV9pbXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K3N0YXRpYyB2b2lkIHdyaXRlX3BtX2ltcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiA+ICAgewo+ID4gICAJaTkxNV9yZWdfdCByZWc7Cj4gPiAtCXUzMiBtYXNrID0gZGV2X3ByaXYt
PnBtX2ltcjsKPiA+ICsJdTMyIG1hc2sgPSBpOTE1LT5wbV9pbXI7Cj4gPiAtCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsK
PiA+ICAgCQlyZWcgPSBHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfTUFTSzsKPiA+ICAgCQkvKiBw
bSBpcyBpbiB1cHBlciBoYWxmICovCj4gPiAgIAkJbWFzayA9IG1hc2sgPDwgMTY7Cj4gPiAtCX0g
ZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KSB7Cj4gPiArCX0gZWxzZSBpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDgpIHsKPiA+ICAgCQlyZWcgPSBHRU44X0dUX0lNUigyKTsKPiA+ICAg
CX0gZWxzZSB7Cj4gPiAgIAkJcmVnID0gR0VONl9QTUlNUjsKPiA+IEBAIC00MjEsMTYgKzQyMSwx
NiBAQCBzdGF0aWMgdm9pZCB3cml0ZV9wbV9pbXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJUE9TVElOR19SRUFEKHJlZyk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9p
ZCB3cml0ZV9wbV9pZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0
YXRpYyB2b2lkIHdyaXRlX3BtX2llcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+
ICAgewo+ID4gICAJaTkxNV9yZWdfdCByZWc7Cj4gPiAtCXUzMiBtYXNrID0gZGV2X3ByaXYtPnBt
X2llcjsKPiA+ICsJdTMyIG1hc2sgPSBpOTE1LT5wbV9pZXI7Cj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDExKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiA+
ICAgCQlyZWcgPSBHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfRU5BQkxFOwo+ID4gICAJCS8qIHBt
IGlzIGluIHVwcGVyIGhhbGYgKi8KPiA+ICAgCQltYXNrID0gbWFzayA8PCAxNjsKPiA+IC0JfSBl
bHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpIHsKPiA+ICsJfSBlbHNlIGlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gOCkgewo+ID4gICAJCXJlZyA9IEdFTjhfR1RfSUVSKDIpOwo+ID4gICAJ
fSBlbHNlIHsKPiA+ICAgCQlyZWcgPSBHRU42X1BNSUVSOwo+ID4gQEAgLTQ0MSwxMSArNDQxLDEx
IEBAIHN0YXRpYyB2b2lkIHdyaXRlX3BtX2llcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiAgIC8qKgo+ID4gICAgKiBzbmJfdXBkYXRlX3BtX2lycSAtIHVwZGF0ZSBHRU42
X1BNSU1SCj4gPiAtICogQGRldl9wcml2OiBkcml2ZXIgcHJpdmF0ZQo+ID4gKyAqIEBpOTE1OiBk
cml2ZXIgcHJpdmF0ZQo+ID4gICAgKiBAaW50ZXJydXB0X21hc2s6IG1hc2sgb2YgaW50ZXJydXB0
IGJpdHMgdG8gdXBkYXRlCj4gPiAgICAqIEBlbmFibGVkX2lycV9tYXNrOiBtYXNrIG9mIGludGVy
cnVwdCBiaXRzIHRvIGVuYWJsZQo+ID4gICAgKi8KPiA+IC1zdGF0aWMgdm9pZCBzbmJfdXBkYXRl
X3BtX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZv
aWQgc25iX3VwZGF0ZV9wbV9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAg
IAkJCSAgICAgIHUzMiBpbnRlcnJ1cHRfbWFzaywKPiA+ICAgCQkJICAgICAgdTMyIGVuYWJsZWRf
aXJxX21hc2spCj4gPiAgIHsKPiA+IEBAIC00NTMsMTI3ICs0NTMsMTI3IEBAIHN0YXRpYyB2b2lk
IHNuYl91cGRhdGVfcG1faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICAgCVdBUk5fT04oZW5hYmxlZF9pcnFfbWFzayAmIH5pbnRlcnJ1cHRfbWFzayk7Cj4gPiAtCWxv
Y2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJmk5MTUtPmlycV9sb2NrKTsKPiA+IC0JbmV3X3ZhbCA9IGRldl9wcml2LT5wbV9p
bXI7Cj4gPiArCW5ld192YWwgPSBpOTE1LT5wbV9pbXI7Cj4gPiAgIAluZXdfdmFsICY9IH5pbnRl
cnJ1cHRfbWFzazsKPiA+ICAgCW5ld192YWwgfD0gKH5lbmFibGVkX2lycV9tYXNrICYgaW50ZXJy
dXB0X21hc2spOwo+ID4gLQlpZiAobmV3X3ZhbCAhPSBkZXZfcHJpdi0+cG1faW1yKSB7Cj4gPiAt
CQlkZXZfcHJpdi0+cG1faW1yID0gbmV3X3ZhbDsKPiA+IC0JCXdyaXRlX3BtX2ltcihkZXZfcHJp
dik7Cj4gPiArCWlmIChuZXdfdmFsICE9IGk5MTUtPnBtX2ltcikgewo+ID4gKwkJaTkxNS0+cG1f
aW1yID0gbmV3X3ZhbDsKPiA+ICsJCXdyaXRlX3BtX2ltcihpOTE1KTsKPiA+ICAgCX0KPiA+ICAg
fQo+ID4gLXZvaWQgZ2VuNl91bm1hc2tfcG1faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgdTMyIG1hc2spCj4gPiArdm9pZCBnZW42X3VubWFza19wbV9pcnEoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBtYXNrKQo+ID4gICB7Cj4gPiAtCWlmIChXQVJOX09O
KCFpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpKSkKPiA+ICsJaWYgKFdBUk5fT04oIWludGVs
X2lycXNfZW5hYmxlZChpOTE1KSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlzbmJfdXBkYXRlX3Bt
X2lycShkZXZfcHJpdiwgbWFzaywgbWFzayk7Cj4gPiArCXNuYl91cGRhdGVfcG1faXJxKGk5MTUs
IG1hc2ssIG1hc2spOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgX19nZW42X21hc2tfcG1faXJx
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIG1hc2spCj4gPiArc3RhdGlj
IHZvaWQgX19nZW42X21hc2tfcG1faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1
MzIgbWFzaykKPiA+ICAgewo+ID4gLQlzbmJfdXBkYXRlX3BtX2lycShkZXZfcHJpdiwgbWFzaywg
MCk7Cj4gPiArCXNuYl91cGRhdGVfcG1faXJxKGk5MTUsIG1hc2ssIDApOwo+ID4gICB9Cj4gPiAt
dm9pZCBnZW42X21hc2tfcG1faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
dTMyIG1hc2spCj4gPiArdm9pZCBnZW42X21hc2tfcG1faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCB1MzIgbWFzaykKPiA+ICAgewo+ID4gLQlpZiAoV0FSTl9PTighaW50ZWxfaXJx
c19lbmFibGVkKGRldl9wcml2KSkpCj4gPiArCWlmIChXQVJOX09OKCFpbnRlbF9pcnFzX2VuYWJs
ZWQoaTkxNSkpKQo+ID4gICAJCXJldHVybjsKPiA+IC0JX19nZW42X21hc2tfcG1faXJxKGRldl9w
cml2LCBtYXNrKTsKPiA+ICsJX19nZW42X21hc2tfcG1faXJxKGk5MTUsIG1hc2spOwo+ID4gICB9
Cj4gPiAtc3RhdGljIHZvaWQgZ2VuNl9yZXNldF9wbV9paXIoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCB1MzIgcmVzZXRfbWFzaykKPiA+ICtzdGF0aWMgdm9pZCBnZW42X3Jlc2V0
X3BtX2lpcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIHJlc2V0X21hc2spCj4g
PiAgIHsKPiA+IC0JaTkxNV9yZWdfdCByZWcgPSBnZW42X3BtX2lpcihkZXZfcHJpdik7Cj4gPiAr
CWk5MTVfcmVnX3QgcmVnID0gZ2VuNl9wbV9paXIoaTkxNSk7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5
MTUtPmlycV9sb2NrKTsKPiA+ICAgCUk5MTVfV1JJVEUocmVnLCByZXNldF9tYXNrKTsKPiA+ICAg
CUk5MTVfV1JJVEUocmVnLCByZXNldF9tYXNrKTsKPiA+ICAgCVBPU1RJTkdfUkVBRChyZWcpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuNl9lbmFibGVfcG1faXJxKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGVuYWJsZV9tYXNrKQo+ID4gK3N0YXRpYyB2b2lkIGdl
bjZfZW5hYmxlX3BtX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGVuYWJs
ZV9tYXNrKQo+ID4gICB7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFf
bG9jayk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmlycV9sb2NrKTsKPiA+IC0J
ZGV2X3ByaXYtPnBtX2llciB8PSBlbmFibGVfbWFzazsKPiA+IC0Jd3JpdGVfcG1faWVyKGRldl9w
cml2KTsKPiA+IC0JZ2VuNl91bm1hc2tfcG1faXJxKGRldl9wcml2LCBlbmFibGVfbWFzayk7Cj4g
PiArCWk5MTUtPnBtX2llciB8PSBlbmFibGVfbWFzazsKPiA+ICsJd3JpdGVfcG1faWVyKGk5MTUp
Owo+ID4gKwlnZW42X3VubWFza19wbV9pcnEoaTkxNSwgZW5hYmxlX21hc2spOwo+ID4gICAJLyog
dW5tYXNrX3BtX2lycSBwcm92aWRlcyBhbiBpbXBsaWNpdCBiYXJyaWVyIChQT1NUSU5HX1JFQUQp
ICovCj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW42X2Rpc2FibGVfcG1faXJxKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGRpc2FibGVfbWFzaykKPiA+ICtzdGF0aWMg
dm9pZCBnZW42X2Rpc2FibGVfcG1faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1
MzIgZGlzYWJsZV9tYXNrKQo+ID4gICB7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9w
cml2LT5pcnFfbG9jayk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmlycV9sb2Nr
KTsKPiA+IC0JZGV2X3ByaXYtPnBtX2llciAmPSB+ZGlzYWJsZV9tYXNrOwo+ID4gLQlfX2dlbjZf
bWFza19wbV9pcnEoZGV2X3ByaXYsIGRpc2FibGVfbWFzayk7Cj4gPiAtCXdyaXRlX3BtX2llcihk
ZXZfcHJpdik7Cj4gPiArCWk5MTUtPnBtX2llciAmPSB+ZGlzYWJsZV9tYXNrOwo+ID4gKwlfX2dl
bjZfbWFza19wbV9pcnEoaTkxNSwgZGlzYWJsZV9tYXNrKTsKPiA+ICsJd3JpdGVfcG1faWVyKGk5
MTUpOwo+ID4gICAJLyogdGhvdWdoIGEgYmFycmllciBpcyBtaXNzaW5nIGhlcmUsIGJ1dCBkb24n
dCByZWFsbHkgbmVlZCBhIG9uZSAqLwo+ID4gICB9Cj4gPiAtdm9pZCBnZW4xMV9yZXNldF9ycHNf
aW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBn
ZW4xMV9yZXNldF9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiA+ICAgewo+ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlz
cGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAtCXdoaWxlIChnZW4xMV9yZXNldF9v
bmVfaWlyKGRldl9wcml2LCAwLCBHRU4xMV9HVFBNKSkKPiA+ICsJd2hpbGUgKGdlbjExX3Jlc2V0
X29uZV9paXIoaTkxNSwgMCwgR0VOMTFfR1RQTSkpCj4gPiAgIAkJOwo+ID4gLQlkZXZfcHJpdi0+
Z3RfcG0ucnBzLnBtX2lpciA9IDA7Cj4gPiArCWk5MTUtPmd0X3BtLnJwcy5wbV9paXIgPSAwOwo+
ID4gLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5fdW5s
b2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gICB9Cj4gPiAtdm9pZCBnZW42X3Jlc2V0X3Jw
c19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lk
IGdlbjZfcmVzZXRfcnBzX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+IC0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+IC0J
Z2VuNl9yZXNldF9wbV9paXIoZGV2X3ByaXYsIEdFTjZfUE1fUlBTX0VWRU5UUyk7Cj4gPiAtCWRl
dl9wcml2LT5ndF9wbS5ycHMucG1faWlyID0gMDsKPiA+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZf
cHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4g
PiArCWdlbjZfcmVzZXRfcG1faWlyKGk5MTUsIEdFTjZfUE1fUlBTX0VWRU5UUyk7Cj4gPiArCWk5
MTUtPmd0X3BtLnJwcy5wbV9paXIgPSAwOwo+ID4gKwlzcGluX3VubG9ja19pcnEoJmk5MTUtPmly
cV9sb2NrKTsKPiA+ICAgfQo+ID4gLXZvaWQgZ2VuNl9lbmFibGVfcnBzX2ludGVycnVwdHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgZ2VuNl9lbmFibGVfcnBz
X2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gPiArCXN0cnVj
dCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gPiAgIAlpZiAoUkVBRF9PTkNF
KHJwcy0+aW50ZXJydXB0c19lbmFibGVkKSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCXNwaW5fbG9j
a19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmly
cV9sb2NrKTsKPiA+ICAgCVdBUk5fT05fT05DRShycHMtPnBtX2lpcik7Cj4gPiAtCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDExKQo+ID4gLQkJV0FSTl9PTl9PTkNFKGdlbjExX3Jlc2V0X29u
ZV9paXIoZGV2X3ByaXYsIDAsIEdFTjExX0dUUE0pKTsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSAxMSkKPiA+ICsJCVdBUk5fT05fT05DRShnZW4xMV9yZXNldF9vbmVfaWlyKGk5MTUsIDAs
IEdFTjExX0dUUE0pKTsKPiA+ICAgCWVsc2UKPiA+IC0JCVdBUk5fT05fT05DRShJOTE1X1JFQUQo
Z2VuNl9wbV9paXIoZGV2X3ByaXYpKSAmIGRldl9wcml2LT5wbV9ycHNfZXZlbnRzKTsKPiA+ICsJ
CVdBUk5fT05fT05DRShJOTE1X1JFQUQoZ2VuNl9wbV9paXIoaTkxNSkpICYgaTkxNS0+cG1fcnBz
X2V2ZW50cyk7Cj4gPiAgIAlycHMtPmludGVycnVwdHNfZW5hYmxlZCA9IHRydWU7Cj4gPiAtCWdl
bjZfZW5hYmxlX3BtX2lycShkZXZfcHJpdiwgZGV2X3ByaXYtPnBtX3Jwc19ldmVudHMpOwo+ID4g
KwlnZW42X2VuYWJsZV9wbV9pcnEoaTkxNSwgaTkxNS0+cG1fcnBzX2V2ZW50cyk7Cj4gPiAtCXNw
aW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJx
KCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAgIH0KPiA+IC12b2lkIGdlbjZfZGlzYWJsZV9ycHNfaW50
ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBnZW42
X2Rpc2FibGVfcnBzX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7
Cj4gPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gPiAgIAlp
ZiAoIVJFQURfT05DRShycHMtPmludGVycnVwdHNfZW5hYmxlZCkpCj4gPiAgIAkJcmV0dXJuOwo+
ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGluX2xvY2tf
aXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAgIAlycHMtPmludGVycnVwdHNfZW5hYmxlZCA9IGZh
bHNlOwo+ID4gLQlJOTE1X1dSSVRFKEdFTjZfUE1JTlRSTVNLLCBnZW42X3Nhbml0aXplX3Jwc19w
bV9tYXNrKGRldl9wcml2LCB+MHUpKTsKPiA+ICsJSTkxNV9XUklURShHRU42X1BNSU5UUk1TSywg
Z2VuNl9zYW5pdGl6ZV9ycHNfcG1fbWFzayhpOTE1LCB+MHUpKTsKPiA+IC0JZ2VuNl9kaXNhYmxl
X3BtX2lycShkZXZfcHJpdiwgR0VONl9QTV9SUFNfRVZFTlRTKTsKPiA+ICsJZ2VuNl9kaXNhYmxl
X3BtX2lycShpOTE1LCBHRU42X1BNX1JQU19FVkVOVFMpOwo+ID4gLQlzcGluX3VubG9ja19pcnEo
JmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAtCXN5bmNocm9uaXplX2lycShkZXZfcHJpdi0+ZHJt
LmlycSk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gKwlzeW5j
aHJvbml6ZV9pcnEoaTkxNS0+ZHJtLmlycSk7Cj4gPiAgIAkvKiBOb3cgdGhhdCB3ZSB3aWxsIG5v
dCBiZSBnZW5lcmF0aW5nIGFueSBtb3JlIHdvcmssIGZsdXNoIGFueQo+ID4gICAJICogb3V0c3Rh
bmRpbmcgdGFza3MuIEFzIHdlIGFyZSBjYWxsZWQgb24gdGhlIFJQUyBpZGxlIHBhdGgsCj4gPiBA
QCAtNTgxLDQ4ICs1ODEsNDggQEAgdm9pZCBnZW42X2Rpc2FibGVfcnBzX2ludGVycnVwdHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICogc3RhdGUgb2YgdGhlIHdv
cmtlciBjYW4gYmUgZGlzY2FyZGVkLgo+ID4gICAJICovCj4gPiAgIAljYW5jZWxfd29ya19zeW5j
KCZycHMtPndvcmspOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiA+IC0J
CWdlbjExX3Jlc2V0X3Jwc19pbnRlcnJ1cHRzKGRldl9wcml2KTsKPiA+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSAxMSkKPiA+ICsJCWdlbjExX3Jlc2V0X3Jwc19pbnRlcnJ1cHRzKGk5MTUpOwo+
ID4gICAJZWxzZQo+ID4gLQkJZ2VuNl9yZXNldF9ycHNfaW50ZXJydXB0cyhkZXZfcHJpdik7Cj4g
PiArCQlnZW42X3Jlc2V0X3Jwc19pbnRlcnJ1cHRzKGk5MTUpOwo+ID4gICB9Cj4gPiAtdm9pZCBn
ZW45X3Jlc2V0X2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICt2b2lkIGdlbjlfcmVzZXRfZ3VjX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKGRldl9w
cml2KTsKPiA+ICsJYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKGk5MTUpOwo+ID4gLQlzcGluX2xv
Y2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gLQlnZW42X3Jlc2V0X3BtX2lpcihkZXZf
cHJpdiwgZGV2X3ByaXYtPnBtX2d1Y19ldmVudHMpOwo+ID4gLQlzcGluX3VubG9ja19pcnEoJmRl
dl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsK
PiA+ICsJZ2VuNl9yZXNldF9wbV9paXIoaTkxNSwgaTkxNS0+cG1fZ3VjX2V2ZW50cyk7Cj4gPiAr
CXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gICB9Cj4gPiAtdm9pZCBnZW45
X2VuYWJsZV9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiArdm9pZCBnZW45X2VuYWJsZV9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoZGV2X3By
aXYpOwo+ID4gKwlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoaTkxNSk7Cj4gPiAtCXNwaW5fbG9j
a19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAtCWlmICghZGV2X3ByaXYtPmd1Yy5pbnRl
cnJ1cHRzLmVuYWJsZWQpIHsKPiA+IC0JCVdBUk5fT05fT05DRShJOTE1X1JFQUQoZ2VuNl9wbV9p
aXIoZGV2X3ByaXYpKSAmCj4gPiAtCQkJCSAgICAgICBkZXZfcHJpdi0+cG1fZ3VjX2V2ZW50cyk7
Cj4gPiAtCQlkZXZfcHJpdi0+Z3VjLmludGVycnVwdHMuZW5hYmxlZCA9IHRydWU7Cj4gPiAtCQln
ZW42X2VuYWJsZV9wbV9pcnEoZGV2X3ByaXYsIGRldl9wcml2LT5wbV9ndWNfZXZlbnRzKTsKPiA+
ICsJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gKwlpZiAoIWk5MTUtPmd1Yy5p
bnRlcnJ1cHRzLmVuYWJsZWQpIHsKPiA+ICsJCVdBUk5fT05fT05DRShJOTE1X1JFQUQoZ2VuNl9w
bV9paXIoaTkxNSkpICYKPiA+ICsJCQkJICAgICAgIGk5MTUtPnBtX2d1Y19ldmVudHMpOwo+ID4g
KwkJaTkxNS0+Z3VjLmludGVycnVwdHMuZW5hYmxlZCA9IHRydWU7Cj4gPiArCQlnZW42X2VuYWJs
ZV9wbV9pcnEoaTkxNSwgaTkxNS0+cG1fZ3VjX2V2ZW50cyk7Cj4gPiAgIAl9Cj4gPiAtCXNwaW5f
dW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxKCZp
OTE1LT5pcnFfbG9jayk7Cj4gPiAgIH0KPiA+IC12b2lkIGdlbjlfZGlzYWJsZV9ndWNfaW50ZXJy
dXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBnZW45X2Rp
c2FibGVfZ3VjX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAg
IHsKPiA+IC0JYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKGRldl9wcml2KTsKPiA+ICsJYXNzZXJ0
X3JwbV93YWtlbG9ja19oZWxkKGk5MTUpOwo+ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+
aXJxX2xvY2spOwo+ID4gLQlkZXZfcHJpdi0+Z3VjLmludGVycnVwdHMuZW5hYmxlZCA9IGZhbHNl
Owo+ID4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiArCWk5MTUtPmd1Yy5p
bnRlcnJ1cHRzLmVuYWJsZWQgPSBmYWxzZTsKPiA+IC0JZ2VuNl9kaXNhYmxlX3BtX2lycShkZXZf
cHJpdiwgZGV2X3ByaXYtPnBtX2d1Y19ldmVudHMpOwo+ID4gKwlnZW42X2Rpc2FibGVfcG1faXJx
KGk5MTUsIGk5MTUtPnBtX2d1Y19ldmVudHMpOwo+ID4gLQlzcGluX3VubG9ja19pcnEoJmRldl9w
cml2LT5pcnFfbG9jayk7Cj4gPiAtCXN5bmNocm9uaXplX2lycShkZXZfcHJpdi0+ZHJtLmlycSk7
Cj4gPiArCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gKwlzeW5jaHJvbml6
ZV9pcnEoaTkxNS0+ZHJtLmlycSk7Cj4gPiAtCWdlbjlfcmVzZXRfZ3VjX2ludGVycnVwdHMoZGV2
X3ByaXYpOwo+ID4gKwlnZW45X3Jlc2V0X2d1Y19pbnRlcnJ1cHRzKGk5MTUpOwo+ID4gICB9Cj4g
PiAgIHZvaWQgZ2VuMTFfcmVzZXRfZ3VjX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gPiBAQCAtNjMyLDUzICs2MzIsNTMgQEAgdm9pZCBnZW4xMV9yZXNldF9ndWNf
aW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgCXNwaW5fdW5s
b2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gICB9Cj4gPiAtdm9pZCBnZW4xMV9lbmFibGVf
Z3VjX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3Zv
aWQgZ2VuMTFfZW5hYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4g
PiAtCWlmICghZGV2X3ByaXYtPmd1Yy5pbnRlcnJ1cHRzLmVuYWJsZWQpIHsKPiA+ICsJc3Bpbl9s
b2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gKwlpZiAoIWk5MTUtPmd1Yy5pbnRlcnJ1cHRz
LmVuYWJsZWQpIHsKPiA+ICAgCQl1MzIgZXZlbnRzID0gUkVHX0ZJRUxEX1BSRVAoRU5HSU5FMV9N
QVNLLAo+ID4gICAJCQkJCSAgICBHRU4xMV9HVUNfSU5UUl9HVUMySE9TVCk7Cj4gPiAtCQlXQVJO
X09OX09OQ0UoZ2VuMTFfcmVzZXRfb25lX2lpcihkZXZfcHJpdiwgMCwgR0VOMTFfR1VDKSk7Cj4g
PiArCQlXQVJOX09OX09OQ0UoZ2VuMTFfcmVzZXRfb25lX2lpcihpOTE1LCAwLCBHRU4xMV9HVUMp
KTsKPiA+ICAgCQlJOTE1X1dSSVRFKEdFTjExX0dVQ19TR19JTlRSX0VOQUJMRSwgZXZlbnRzKTsK
PiA+ICAgCQlJOTE1X1dSSVRFKEdFTjExX0dVQ19TR19JTlRSX01BU0ssIH5ldmVudHMpOwo+ID4g
LQkJZGV2X3ByaXYtPmd1Yy5pbnRlcnJ1cHRzLmVuYWJsZWQgPSB0cnVlOwo+ID4gKwkJaTkxNS0+
Z3VjLmludGVycnVwdHMuZW5hYmxlZCA9IHRydWU7Cj4gPiAgIAl9Cj4gPiAtCXNwaW5fdW5sb2Nr
X2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5p
cnFfbG9jayk7Cj4gPiAgIH0KPiA+IC12b2lkIGdlbjExX2Rpc2FibGVfZ3VjX2ludGVycnVwdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgZ2VuMTFfZGlzYWJs
ZV9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+
ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gLQlkZXZfcHJpdi0+
Z3VjLmludGVycnVwdHMuZW5hYmxlZCA9IGZhbHNlOwo+ID4gKwlzcGluX2xvY2tfaXJxKCZpOTE1
LT5pcnFfbG9jayk7Cj4gPiArCWk5MTUtPmd1Yy5pbnRlcnJ1cHRzLmVuYWJsZWQgPSBmYWxzZTsK
PiA+ICAgCUk5MTVfV1JJVEUoR0VOMTFfR1VDX1NHX0lOVFJfTUFTSywgfjApOwo+ID4gICAJSTkx
NV9XUklURShHRU4xMV9HVUNfU0dfSU5UUl9FTkFCTEUsIDApOwo+ID4gLQlzcGluX3VubG9ja19p
cnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAtCXN5bmNocm9uaXplX2lycShkZXZfcHJpdi0+
ZHJtLmlycSk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gKwlz
eW5jaHJvbml6ZV9pcnEoaTkxNS0+ZHJtLmlycSk7Cj4gPiAtCWdlbjExX3Jlc2V0X2d1Y19pbnRl
cnJ1cHRzKGRldl9wcml2KTsKPiA+ICsJZ2VuMTFfcmVzZXRfZ3VjX2ludGVycnVwdHMoaTkxNSk7
Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGJkd191cGRhdGVfcG9ydF9pcnEgLSB1cGRhdGUg
REUgcG9ydCBpbnRlcnJ1cHQKPiA+IC0gKiBAZGV2X3ByaXY6IGRyaXZlciBwcml2YXRlCj4gPiAr
ICogQGk5MTU6IGRyaXZlciBwcml2YXRlCj4gPiAgICAqIEBpbnRlcnJ1cHRfbWFzazogbWFzayBv
ZiBpbnRlcnJ1cHQgYml0cyB0byB1cGRhdGUKPiA+ICAgICogQGVuYWJsZWRfaXJxX21hc2s6IG1h
c2sgb2YgaW50ZXJydXB0IGJpdHMgdG8gZW5hYmxlCj4gPiAgICAqLwo+ID4gLXN0YXRpYyB2b2lk
IGJkd191cGRhdGVfcG9ydF9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3N0YXRpYyB2b2lkIGJkd191cGRhdGVfcG9ydF9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCQl1MzIgaW50ZXJydXB0X21hc2ssCj4gPiAgIAkJCQl1MzIgZW5h
YmxlZF9pcnFfbWFzaykKPiA+ICAgewo+ID4gICAJdTMyIG5ld192YWw7Cj4gPiAgIAl1MzIgb2xk
X3ZhbDsKPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+
ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+ID4gICAJV0FSTl9PTihl
bmFibGVkX2lycV9tYXNrICYgfmludGVycnVwdF9tYXNrKTsKPiA+IC0JaWYgKFdBUk5fT04oIWlu
dGVsX2lycXNfZW5hYmxlZChkZXZfcHJpdikpKQo+ID4gKwlpZiAoV0FSTl9PTighaW50ZWxfaXJx
c19lbmFibGVkKGk5MTUpKSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAlvbGRfdmFsID0gSTkxNV9S
RUFEKEdFTjhfREVfUE9SVF9JTVIpOwo+ID4gQEAgLTY5NSw0MyArNjk1LDQzIEBAIHN0YXRpYyB2
b2lkIGJkd191cGRhdGVfcG9ydF9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gICAvKioKPiA+ICAgICogYmR3X3VwZGF0ZV9waXBlX2lycSAtIHVwZGF0ZSBERSBwaXBl
IGludGVycnVwdAo+ID4gLSAqIEBkZXZfcHJpdjogZHJpdmVyIHByaXZhdGUKPiA+ICsgKiBAaTkx
NTogZHJpdmVyIHByaXZhdGUKPiA+ICAgICogQHBpcGU6IHBpcGUgd2hvc2UgaW50ZXJydXB0IHRv
IHVwZGF0ZQo+ID4gICAgKiBAaW50ZXJydXB0X21hc2s6IG1hc2sgb2YgaW50ZXJydXB0IGJpdHMg
dG8gdXBkYXRlCj4gPiAgICAqIEBlbmFibGVkX2lycV9tYXNrOiBtYXNrIG9mIGludGVycnVwdCBi
aXRzIHRvIGVuYWJsZQo+ID4gICAgKi8KPiA+IC12b2lkIGJkd191cGRhdGVfcGlwZV9pcnEoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgYmR3X3VwZGF0ZV9waXBl
X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJIGVudW0gcGlwZSBw
aXBlLAo+ID4gICAJCQkgdTMyIGludGVycnVwdF9tYXNrLAo+ID4gICAJCQkgdTMyIGVuYWJsZWRf
aXJxX21hc2spCj4gPiAgIHsKPiA+ICAgCXUzMiBuZXdfdmFsOwo+ID4gLQlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZp
OTE1LT5pcnFfbG9jayk7Cj4gPiAgIAlXQVJOX09OKGVuYWJsZWRfaXJxX21hc2sgJiB+aW50ZXJy
dXB0X21hc2spOwo+ID4gLQlpZiAoV0FSTl9PTighaW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2
KSkpCj4gPiArCWlmIChXQVJOX09OKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkpKQo+ID4gICAJ
CXJldHVybjsKPiA+IC0JbmV3X3ZhbCA9IGRldl9wcml2LT5kZV9pcnFfbWFza1twaXBlXTsKPiA+
ICsJbmV3X3ZhbCA9IGk5MTUtPmRlX2lycV9tYXNrW3BpcGVdOwo+ID4gICAJbmV3X3ZhbCAmPSB+
aW50ZXJydXB0X21hc2s7Cj4gPiAgIAluZXdfdmFsIHw9ICh+ZW5hYmxlZF9pcnFfbWFzayAmIGlu
dGVycnVwdF9tYXNrKTsKPiA+IC0JaWYgKG5ld192YWwgIT0gZGV2X3ByaXYtPmRlX2lycV9tYXNr
W3BpcGVdKSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGVfaXJxX21hc2tbcGlwZV0gPSBuZXdfdmFsOwo+
ID4gLQkJSTkxNV9XUklURShHRU44X0RFX1BJUEVfSU1SKHBpcGUpLCBkZXZfcHJpdi0+ZGVfaXJx
X21hc2tbcGlwZV0pOwo+ID4gKwlpZiAobmV3X3ZhbCAhPSBpOTE1LT5kZV9pcnFfbWFza1twaXBl
XSkgewo+ID4gKwkJaTkxNS0+ZGVfaXJxX21hc2tbcGlwZV0gPSBuZXdfdmFsOwo+ID4gKwkJSTkx
NV9XUklURShHRU44X0RFX1BJUEVfSU1SKHBpcGUpLCBpOTE1LT5kZV9pcnFfbWFza1twaXBlXSk7
Cj4gPiAgIAkJUE9TVElOR19SRUFEKEdFTjhfREVfUElQRV9JTVIocGlwZSkpOwo+ID4gICAJfQo+
ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpYnhfZGlzcGxheV9pbnRlcnJ1cHRfdXBkYXRlIC0g
dXBkYXRlIFNERUlNUgo+ID4gLSAqIEBkZXZfcHJpdjogZHJpdmVyIHByaXZhdGUKPiA+ICsgKiBA
aTkxNTogZHJpdmVyIHByaXZhdGUKPiA+ICAgICogQGludGVycnVwdF9tYXNrOiBtYXNrIG9mIGlu
dGVycnVwdCBiaXRzIHRvIHVwZGF0ZQo+ID4gICAgKiBAZW5hYmxlZF9pcnFfbWFzazogbWFzayBv
ZiBpbnRlcnJ1cHQgYml0cyB0byBlbmFibGUKPiA+ICAgICovCj4gPiAtdm9pZCBpYnhfZGlzcGxh
eV9pbnRlcnJ1cHRfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICt2b2lkIGlieF9kaXNwbGF5X2ludGVycnVwdF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCQkgIHUzMiBpbnRlcnJ1cHRfbWFzaywKPiA+ICAgCQkJCSAgdTMy
IGVuYWJsZWRfaXJxX21hc2spCj4gPiAgIHsKPiA+IEBAIC03NDEsMjQgKzc0MSwyNCBAQCB2b2lk
IGlieF9kaXNwbGF5X2ludGVycnVwdF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAJV0FSTl9PTihlbmFibGVkX2lycV9tYXNrICYgfmludGVycnVwdF9tYXNr
KTsKPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJ
bG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+ID4gLQlpZiAoV0FSTl9PTigh
aW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSkpCj4gPiArCWlmIChXQVJOX09OKCFpbnRlbF9p
cnFzX2VuYWJsZWQoaTkxNSkpKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCUk5MTVfV1JJVEUoU0RF
SU1SLCBzZGVpbXIpOwo+ID4gICAJUE9TVElOR19SRUFEKFNERUlNUik7Cj4gPiAgIH0KPiA+IC11
MzIgaTkxNV9waXBlc3RhdF9lbmFibGVfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiArdTMyIGk5MTVfcGlwZXN0YXRfZW5hYmxlX21hc2soc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgIGVudW0gcGlwZSBwaXBlKQo+ID4gICB7Cj4g
PiAtCXUzMiBzdGF0dXNfbWFzayA9IGRldl9wcml2LT5waXBlc3RhdF9pcnFfbWFza1twaXBlXTsK
PiA+ICsJdTMyIHN0YXR1c19tYXNrID0gaTkxNS0+cGlwZXN0YXRfaXJxX21hc2tbcGlwZV07Cj4g
PiAgIAl1MzIgZW5hYmxlX21hc2sgPSBzdGF0dXNfbWFzayA8PCAxNjsKPiA+IC0JbG9ja2RlcF9h
c3NlcnRfaGVsZCgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmaTkxNS0+aXJxX2xvY2spOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDUpCj4g
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA1KQo+ID4gICAJCWdvdG8gb3V0Owo+ID4gICAJLyoK
PiA+IEBAIC03OTEsNyArNzkxLDcgQEAgdTMyIGk5MTVfcGlwZXN0YXRfZW5hYmxlX21hc2soc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJcmV0dXJuIGVuYWJsZV9tYXNr
Owo+ID4gICB9Cj4gPiAtdm9pZCBpOTE1X2VuYWJsZV9waXBlc3RhdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpOTE1X2VuYWJsZV9waXBlc3RhdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICBlbnVtIHBpcGUgcGlwZSwgdTMyIHN0
YXR1c19tYXNrKQo+ID4gICB7Cj4gPiAgIAlpOTE1X3JlZ190IHJlZyA9IFBJUEVTVEFUKHBpcGUp
Owo+ID4gQEAgLTgwMSwyMCArODAxLDIwIEBAIHZvaWQgaTkxNV9lbmFibGVfcGlwZXN0YXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCSAgInBpcGUgJWM6IHN0YXR1
c19tYXNrPTB4JXhcbiIsCj4gPiAgIAkJICBwaXBlX25hbWUocGlwZSksIHN0YXR1c19tYXNrKTsK
PiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+IC0JV0FS
Tl9PTighaW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICsJV0FSTl9PTighaW50ZWxfaXJxc19lbmFibGVk
KGk5MTUpKTsKPiA+IC0JaWYgKChkZXZfcHJpdi0+cGlwZXN0YXRfaXJxX21hc2tbcGlwZV0gJiBz
dGF0dXNfbWFzaykgPT0gc3RhdHVzX21hc2spCj4gPiArCWlmICgoaTkxNS0+cGlwZXN0YXRfaXJx
X21hc2tbcGlwZV0gJiBzdGF0dXNfbWFzaykgPT0gc3RhdHVzX21hc2spCj4gPiAgIAkJcmV0dXJu
Owo+ID4gLQlkZXZfcHJpdi0+cGlwZXN0YXRfaXJxX21hc2tbcGlwZV0gfD0gc3RhdHVzX21hc2s7
Cj4gPiAtCWVuYWJsZV9tYXNrID0gaTkxNV9waXBlc3RhdF9lbmFibGVfbWFzayhkZXZfcHJpdiwg
cGlwZSk7Cj4gPiArCWk5MTUtPnBpcGVzdGF0X2lycV9tYXNrW3BpcGVdIHw9IHN0YXR1c19tYXNr
Owo+ID4gKwllbmFibGVfbWFzayA9IGk5MTVfcGlwZXN0YXRfZW5hYmxlX21hc2soaTkxNSwgcGlw
ZSk7Cj4gPiAgIAlJOTE1X1dSSVRFKHJlZywgZW5hYmxlX21hc2sgfCBzdGF0dXNfbWFzayk7Cj4g
PiAgIAlQT1NUSU5HX1JFQUQocmVnKTsKPiA+ICAgfQo+ID4gLXZvaWQgaTkxNV9kaXNhYmxlX3Bp
cGVzdGF0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGk5MTVf
ZGlzYWJsZV9waXBlc3RhdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJ
ICAgZW51bSBwaXBlIHBpcGUsIHUzMiBzdGF0dXNfbWFzaykKPiA+ICAgewo+ID4gICAJaTkxNV9y
ZWdfdCByZWcgPSBQSVBFU1RBVChwaXBlKTsKPiA+IEBAIC04MjQsNDQgKzgyNCw0NCBAQCB2b2lk
IGk5MTVfZGlzYWJsZV9waXBlc3RhdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiAgIAkJICAicGlwZSAlYzogc3RhdHVzX21hc2s9MHgleFxuIiwKPiA+ICAgCQkgIHBpcGVf
bmFtZShwaXBlKSwgc3RhdHVzX21hc2spOwo+ID4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZf
cHJpdi0+aXJxX2xvY2spOwo+ID4gLQlXQVJOX09OKCFpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3By
aXYpKTsKPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+ID4gKwlX
QVJOX09OKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkpOwo+ID4gLQlpZiAoKGRldl9wcml2LT5w
aXBlc3RhdF9pcnFfbWFza1twaXBlXSAmIHN0YXR1c19tYXNrKSA9PSAwKQo+ID4gKwlpZiAoKGk5
MTUtPnBpcGVzdGF0X2lycV9tYXNrW3BpcGVdICYgc3RhdHVzX21hc2spID09IDApCj4gPiAgIAkJ
cmV0dXJuOwo+ID4gLQlkZXZfcHJpdi0+cGlwZXN0YXRfaXJxX21hc2tbcGlwZV0gJj0gfnN0YXR1
c19tYXNrOwo+ID4gLQllbmFibGVfbWFzayA9IGk5MTVfcGlwZXN0YXRfZW5hYmxlX21hc2soZGV2
X3ByaXYsIHBpcGUpOwo+ID4gKwlpOTE1LT5waXBlc3RhdF9pcnFfbWFza1twaXBlXSAmPSB+c3Rh
dHVzX21hc2s7Cj4gPiArCWVuYWJsZV9tYXNrID0gaTkxNV9waXBlc3RhdF9lbmFibGVfbWFzayhp
OTE1LCBwaXBlKTsKPiA+ICAgCUk5MTVfV1JJVEUocmVnLCBlbmFibGVfbWFzayB8IHN0YXR1c19t
YXNrKTsKPiA+ICAgCVBPU1RJTkdfUkVBRChyZWcpOwo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wg
aTkxNV9oYXNfYXNsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3Rh
dGljIGJvb2wgaTkxNV9oYXNfYXNsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+
ICAgewo+ID4gLQlpZiAoIWRldl9wcml2LT5vcHJlZ2lvbi5hc2xlKQo+ID4gKwlpZiAoIWk5MTUt
Pm9wcmVnaW9uLmFzbGUpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gLQlyZXR1cm4gSVNfUElO
RVZJRVcoZGV2X3ByaXYpIHx8IElTX01PQklMRShkZXZfcHJpdik7Cj4gPiArCXJldHVybiBJU19Q
SU5FVklFVyhpOTE1KSB8fCBJU19NT0JJTEUoaTkxNSk7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAg
ICAqIGk5MTVfZW5hYmxlX2FzbGVfcGlwZXN0YXQgLSBlbmFibGUgQVNMRSBwaXBlc3RhdCBmb3Ig
T3BSZWdpb24KPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIHByaXZhdGUKPiA+ICsgKiBA
aTkxNTogaTkxNSBkZXZpY2UgcHJpdmF0ZQo+ID4gICAgKi8KPiA+IC1zdGF0aWMgdm9pZCBpOTE1
X2VuYWJsZV9hc2xlX3BpcGVzdGF0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICtzdGF0aWMgdm9pZCBpOTE1X2VuYWJsZV9hc2xlX3BpcGVzdGF0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWlmICghaTkxNV9oYXNfYXNsZShkZXZfcHJp
dikpCj4gPiArCWlmICghaTkxNV9oYXNfYXNsZShpOTE1KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAt
CXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5fbG9ja19pcnEo
Jmk5MTUtPmlycV9sb2NrKTsKPiA+IC0JaTkxNV9lbmFibGVfcGlwZXN0YXQoZGV2X3ByaXYsIFBJ
UEVfQiwgUElQRV9MRUdBQ1lfQkxDX0VWRU5UX1NUQVRVUyk7Cj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDQpCj4gPiAtCQlpOTE1X2VuYWJsZV9waXBlc3RhdChkZXZfcHJpdiwgUElQ
RV9BLAo+ID4gKwlpOTE1X2VuYWJsZV9waXBlc3RhdChpOTE1LCBQSVBFX0IsIFBJUEVfTEVHQUNZ
X0JMQ19FVkVOVF9TVEFUVVMpOwo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpCj4gPiAr
CQlpOTE1X2VuYWJsZV9waXBlc3RhdChpOTE1LCBQSVBFX0EsCj4gPiAgIAkJCQkgICAgIFBJUEVf
TEVHQUNZX0JMQ19FVkVOVF9TVEFUVVMpOwo+ID4gLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2
LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4g
ICB9Cj4gPiAgIC8qCj4gPiBAQCAtOTE5LDcgKzkxOSw3IEBAIHN0YXRpYyB2b2lkIGk5MTVfZW5h
YmxlX2FzbGVfcGlwZXN0YXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
ICAgKi8KPiA+ICAgc3RhdGljIHUzMiBpOTE1X2dldF92YmxhbmtfY291bnRlcihzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGRybV92Ymxh
bmtfY3J0YyAqdmJsYW5rID0gJmRldi0+dmJsYW5rW3BpcGVdOwo+ID4gICAJY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKm1vZGUgPSAmdmJsYW5rLT5od21vZGU7Cj4gPiAgIAlpOTE1X3Jl
Z190IGhpZ2hfZnJhbWUsIGxvd19mcmFtZTsKPiA+IEBAIC05NTUsNyArOTU1LDcgQEAgc3RhdGlj
IHUzMiBpOTE1X2dldF92YmxhbmtfY291bnRlcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNp
Z25lZCBpbnQgcGlwZSkKPiA+ICAgCWhpZ2hfZnJhbWUgPSBQSVBFRlJBTUUocGlwZSk7Cj4gPiAg
IAlsb3dfZnJhbWUgPSBQSVBFRlJBTUVQSVhFTChwaXBlKTsKPiA+IC0Jc3Bpbl9sb2NrX2lycXNh
dmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gKwlzcGluX2xvY2tfaXJx
c2F2ZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBI
aWdoICYgbG93IHJlZ2lzdGVyIGZpZWxkcyBhcmVuJ3Qgc3luY2hyb25pemVkLCBzbyBtYWtlIHN1
cmUKPiA+IEBAIC05NjgsNyArOTY4LDcgQEAgc3RhdGljIHUzMiBpOTE1X2dldF92YmxhbmtfY291
bnRlcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSkKPiA+ICAgCQlo
aWdoMiA9IEk5MTVfUkVBRF9GVyhoaWdoX2ZyYW1lKSAmIFBJUEVfRlJBTUVfSElHSF9NQVNLOwo+
ID4gICAJfSB3aGlsZSAoaGlnaDEgIT0gaGlnaDIpOwo+ID4gLQlzcGluX3VubG9ja19pcnFyZXN0
b3JlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICsJc3Bpbl91bmxvY2tf
aXJxcmVzdG9yZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICAgCWhpZ2gxID4+
PSBQSVBFX0ZSQU1FX0hJR0hfU0hJRlQ7Cj4gPiAgIAlwaXhlbCA9IGxvdyAmIFBJUEVfUElYRUxf
TUFTSzsKPiA+IEBAIC05ODQsNyArOTg0LDcgQEAgc3RhdGljIHUzMiBpOTE1X2dldF92Ymxhbmtf
Y291bnRlcihzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSkKPiA+ICAg
c3RhdGljIHUzMiBnNHhfZ2V0X3ZibGFua19jb3VudGVyKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHVuc2lnbmVkIGludCBwaXBlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlyZXR1cm4gSTkxNV9SRUFEKFBJUEVfRlJNQ09V
TlRfRzRYKHBpcGUpKTsKPiA+ICAgfQo+ID4gQEAgLTk5OSw3ICs5OTksNyBAQCBzdGF0aWMgdTMy
IGc0eF9nZXRfdmJsYW5rX2NvdW50ZXIoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQg
aW50IHBpcGUpCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgdTMyIF9faW50ZWxfZ2V0X2NydGNfc2Nh
bmxpbmVfZnJvbV90aW1lc3RhbXAoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgZHJtX3ZibGFua19jcnRjICp2YmxhbmsgPQo+ID4g
ICAJCSZjcnRjLT5iYXNlLmRldi0+dmJsYW5rW2RybV9jcnRjX2luZGV4KCZjcnRjLT5iYXNlKV07
Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZ2YmxhbmstPmh3
bW9kZTsKPiA+IEBAIC0xMDQ0LDcgKzEwNDQsNyBAQCBzdGF0aWMgdTMyIF9faW50ZWxfZ2V0X2Ny
dGNfc2NhbmxpbmVfZnJvbV90aW1lc3RhbXAoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAg
IHN0YXRpYyBpbnQgX19pbnRlbF9nZXRfY3J0Y19zY2FubGluZShzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YykKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2Uu
ZGV2Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+
ID4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGU7Cj4gPiAgIAlzdHJ1Y3Qg
ZHJtX3ZibGFua19jcnRjICp2Ymxhbms7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBp
cGU7Cj4gPiBAQCAtMTA2Myw3ICsxMDYzLDcgQEAgc3RhdGljIGludCBfX2ludGVsX2dldF9jcnRj
X3NjYW5saW5lKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ID4gICAJaWYgKG1vZGUtPmZsYWdz
ICYgRFJNX01PREVfRkxBR19JTlRFUkxBQ0UpCj4gPiAgIAkJdnRvdGFsIC89IDI7Cj4gPiAtCWlm
IChJU19HRU4oZGV2X3ByaXYsIDIpKQo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDIpKQo+ID4gICAJ
CXBvc2l0aW9uID0gSTkxNV9SRUFEX0ZXKFBJUEVEU0wocGlwZSkpICYgRFNMX0xJTkVNQVNLX0dF
TjI7Cj4gPiAgIAllbHNlCj4gPiAgIAkJcG9zaXRpb24gPSBJOTE1X1JFQURfRlcoUElQRURTTChw
aXBlKSkgJiBEU0xfTElORU1BU0tfR0VOMzsKPiA+IEBAIC0xMDgwLDcgKzEwODAsNyBAQCBzdGF0
aWMgaW50IF9faW50ZWxfZ2V0X2NydGNfc2NhbmxpbmUoc3RydWN0IGludGVsX2NydGMgKmNydGMp
Cj4gPiAgIAkgKiBwcm9ibGVtLiAgV2UgbWF5IG5lZWQgdG8gZXh0ZW5kIHRoaXMgdG8gaW5jbHVk
ZSBvdGhlciBwbGF0Zm9ybXMsCj4gPiAgIAkgKiBidXQgc28gZmFyIHRlc3Rpbmcgb25seSBzaG93
cyB0aGUgcHJvYmxlbSBvbiBIU1cuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKEhBU19EREkoZGV2X3By
aXYpICYmICFwb3NpdGlvbikgewo+ID4gKwlpZiAoSEFTX0RESShpOTE1KSAmJiAhcG9zaXRpb24p
IHsKPiA+ICAgCQlpbnQgaSwgdGVtcDsKPiA+ICAgCQlmb3IgKGkgPSAwOyBpIDwgMTAwOyBpKysp
IHsKPiA+IEBAIC0xMTA1LDE0ICsxMTA1LDE0IEBAIHN0YXRpYyBib29sIGk5MTVfZ2V0X2NydGNf
c2Nhbm91dHBvcyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSwKPiA+
ICAgCQkJCSAgICAga3RpbWVfdCAqc3RpbWUsIGt0aW1lX3QgKmV0aW1lLAo+ID4gICAJCQkJICAg
ICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiAtCXN0cnVj
dCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3By
aXYsCj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+
ID4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9w
aXBlKGk5MTUsCj4gPiAgIAkJCQkJCQkJcGlwZSk7Cj4gPiAgIAlpbnQgcG9zaXRpb247Cj4gPiAg
IAlpbnQgdmJsX3N0YXJ0LCB2YmxfZW5kLCBoc3luY19zdGFydCwgaHRvdGFsLCB2dG90YWw7Cj4g
PiAgIAl1bnNpZ25lZCBsb25nIGlycWZsYWdzOwo+ID4gLQlib29sIHVzZV9zY2FubGluZV9jb3Vu
dGVyID0gSU5URUxfR0VOKGRldl9wcml2KSA+PSA1IHx8Cj4gPiAtCQlJU19HNFgoZGV2X3ByaXYp
IHx8IElTX0dFTihkZXZfcHJpdiwgMikgfHwKPiA+ICsJYm9vbCB1c2Vfc2NhbmxpbmVfY291bnRl
ciA9IElOVEVMX0dFTihpOTE1KSA+PSA1IHx8Cj4gPiArCQlJU19HNFgoaTkxNSkgfHwgSVNfR0VO
KGk5MTUsIDIpIHx8Cj4gPiAgIAkJbW9kZS0+cHJpdmF0ZV9mbGFncyAmIEk5MTVfTU9ERV9GTEFH
X1VTRV9TQ0FOTElORV9DT1VOVEVSOwo+ID4gICAJaWYgKFdBUk5fT04oIW1vZGUtPmNydGNfY2xv
Y2spKSB7Cj4gPiBAQCAtMTEzOCw3ICsxMTM4LDcgQEAgc3RhdGljIGJvb2wgaTkxNV9nZXRfY3J0
Y19zY2Fub3V0cG9zKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlLAo+
ID4gICAJICogcmVnaXN0ZXIgcmVhZHMsIHBvdGVudGlhbGx5IHdpdGggcHJlZW1wdGlvbiBkaXNh
YmxlZCwgc28gdGhlCj4gPiAgIAkgKiBmb2xsb3dpbmcgY29kZSBtdXN0IG5vdCBibG9jayBvbiB1
bmNvcmUubG9jay4KPiA+ICAgCSAqLwo+ID4gLQlzcGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYt
PnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT51
bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gICAJLyogcHJlZW1wdF9kaXNhYmxlX3J0KCkgc2hv
dWxkIGdvIHJpZ2h0IGhlcmUgaW4gUFJFRU1QVF9SVCBwYXRjaHNldC4gKi8KPiA+IEBAIC0xMTkz
LDcgKzExOTMsNyBAQCBzdGF0aWMgYm9vbCBpOTE1X2dldF9jcnRjX3NjYW5vdXRwb3Moc3RydWN0
IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGUsCj4gPiAgIAkvKiBwcmVlbXB0X2Vu
YWJsZV9ydCgpIHNob3VsZCBnbyByaWdodCBoZXJlIGluIFBSRUVNUFRfUlQgcGF0Y2hzZXQuICov
Cj4gPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJx
ZmxhZ3MpOwo+ID4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT51bmNvcmUubG9jaywg
aXJxZmxhZ3MpOwo+ID4gICAJLyoKPiA+ICAgCSAqIFdoaWxlIGluIHZibGFuaywgcG9zaXRpb24g
d2lsbCBiZSBuZWdhdGl2ZQo+ID4gQEAgLTEyMTksMjAgKzEyMTksMjAgQEAgc3RhdGljIGJvb2wg
aTkxNV9nZXRfY3J0Y19zY2Fub3V0cG9zKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVk
IGludCBwaXBlLAo+ID4gICBpbnQgaW50ZWxfZ2V0X2NydGNfc2NhbmxpbmUoc3RydWN0IGludGVs
X2NydGMgKmNydGMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAl1bnNpZ25lZCBsb25n
IGlycWZsYWdzOwo+ID4gICAJaW50IHBvc2l0aW9uOwo+ID4gLQlzcGluX2xvY2tfaXJxc2F2ZSgm
ZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gPiArCXNwaW5fbG9ja19pcnFzYXZl
KCZpOTE1LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gICAJcG9zaXRpb24gPSBfX2ludGVs
X2dldF9jcnRjX3NjYW5saW5lKGNydGMpOwo+ID4gLQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZk
ZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxcmVz
dG9yZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICAgCXJldHVybiBwb3NpdGlv
bjsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGlyb25sYWtlX3Jwc19jaGFuZ2VfaXJxX2hhbmRs
ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGly
b25sYWtlX3Jwc19jaGFuZ2VfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2
LT51bmNvcmU7Cj4gPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNv
cmU7Cj4gPiAgIAl1MzIgYnVzeV91cCwgYnVzeV9kb3duLCBtYXhfYXZnLCBtaW5fYXZnOwo+ID4g
ICAJdTggbmV3X2RlbGF5Owo+ID4gQEAgLTEyNDIsNyArMTI0Miw3IEBAIHN0YXRpYyB2b2lkIGly
b25sYWtlX3Jwc19jaGFuZ2VfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJCQkgICAgIE1FTUlOVFJTVFMsCj4gPiAgIAkJCSAgICAgaW50ZWxfdW5j
b3JlX3JlYWQodW5jb3JlLCBNRU1JTlRSU1RTKSk7Cj4gPiAtCW5ld19kZWxheSA9IGRldl9wcml2
LT5pcHMuY3VyX2RlbGF5Owo+ID4gKwluZXdfZGVsYXkgPSBpOTE1LT5pcHMuY3VyX2RlbGF5Owo+
ID4gICAJaW50ZWxfdW5jb3JlX3dyaXRlMTYodW5jb3JlLCBNRU1JTlRSU1RTLCBNRU1JTlRfRVZB
TF9DSEcpOwo+ID4gICAJYnVzeV91cCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgUkNQUkVW
QlNZVFVQQVZHKTsKPiA+IEBAIC0xMjUyLDI2ICsxMjUyLDI2IEBAIHN0YXRpYyB2b2lkIGlyb25s
YWtlX3Jwc19jaGFuZ2VfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gICAJLyogSGFuZGxlIFJDUyBjaGFuZ2UgcmVxdWVzdCBmcm9tIGh3ICovCj4gPiAg
IAlpZiAoYnVzeV91cCA+IG1heF9hdmcpIHsKPiA+IC0JCWlmIChkZXZfcHJpdi0+aXBzLmN1cl9k
ZWxheSAhPSBkZXZfcHJpdi0+aXBzLm1heF9kZWxheSkKPiA+IC0JCQluZXdfZGVsYXkgPSBkZXZf
cHJpdi0+aXBzLmN1cl9kZWxheSAtIDE7Cj4gPiAtCQlpZiAobmV3X2RlbGF5IDwgZGV2X3ByaXYt
Pmlwcy5tYXhfZGVsYXkpCj4gPiAtCQkJbmV3X2RlbGF5ID0gZGV2X3ByaXYtPmlwcy5tYXhfZGVs
YXk7Cj4gPiArCQlpZiAoaTkxNS0+aXBzLmN1cl9kZWxheSAhPSBpOTE1LT5pcHMubWF4X2RlbGF5
KQo+ID4gKwkJCW5ld19kZWxheSA9IGk5MTUtPmlwcy5jdXJfZGVsYXkgLSAxOwo+ID4gKwkJaWYg
KG5ld19kZWxheSA8IGk5MTUtPmlwcy5tYXhfZGVsYXkpCj4gPiArCQkJbmV3X2RlbGF5ID0gaTkx
NS0+aXBzLm1heF9kZWxheTsKPiA+ICAgCX0gZWxzZSBpZiAoYnVzeV9kb3duIDwgbWluX2F2Zykg
ewo+ID4gLQkJaWYgKGRldl9wcml2LT5pcHMuY3VyX2RlbGF5ICE9IGRldl9wcml2LT5pcHMubWlu
X2RlbGF5KQo+ID4gLQkJCW5ld19kZWxheSA9IGRldl9wcml2LT5pcHMuY3VyX2RlbGF5ICsgMTsK
PiA+IC0JCWlmIChuZXdfZGVsYXkgPiBkZXZfcHJpdi0+aXBzLm1pbl9kZWxheSkKPiA+IC0JCQlu
ZXdfZGVsYXkgPSBkZXZfcHJpdi0+aXBzLm1pbl9kZWxheTsKPiA+ICsJCWlmIChpOTE1LT5pcHMu
Y3VyX2RlbGF5ICE9IGk5MTUtPmlwcy5taW5fZGVsYXkpCj4gPiArCQkJbmV3X2RlbGF5ID0gaTkx
NS0+aXBzLmN1cl9kZWxheSArIDE7Cj4gPiArCQlpZiAobmV3X2RlbGF5ID4gaTkxNS0+aXBzLm1p
bl9kZWxheSkKPiA+ICsJCQluZXdfZGVsYXkgPSBpOTE1LT5pcHMubWluX2RlbGF5Owo+ID4gICAJ
fQo+ID4gLQlpZiAoaXJvbmxha2Vfc2V0X2RycHMoZGV2X3ByaXYsIG5ld19kZWxheSkpCj4gPiAt
CQlkZXZfcHJpdi0+aXBzLmN1cl9kZWxheSA9IG5ld19kZWxheTsKPiA+ICsJaWYgKGlyb25sYWtl
X3NldF9kcnBzKGk5MTUsIG5ld19kZWxheSkpCj4gPiArCQlpOTE1LT5pcHMuY3VyX2RlbGF5ID0g
bmV3X2RlbGF5Owo+ID4gICAJc3Bpbl91bmxvY2soJm1jaGRldl9sb2NrKTsKPiA+ICAgCXJldHVy
bjsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHZsdl9jMF9yZWFkKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCB2bHZfYzBfcmVhZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJc3RydWN0IGludGVsX3Jwc19laSAqZWkpCj4g
PiAgIHsKPiA+ICAgCWVpLT5rdGltZSA9IGt0aW1lX2dldF9yYXcoKTsKPiA+IEBAIC0xMjc5LDE0
ICsxMjc5LDE0IEBAIHN0YXRpYyB2b2lkIHZsdl9jMF9yZWFkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICAgCWVpLT5tZWRpYV9jMCA9IEk5MTVfUkVBRChWTFZfTUVESUFf
QzBfQ09VTlQpOwo+ID4gICB9Cj4gPiAtdm9pZCBnZW42X3Jwc19yZXNldF9laShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBnZW42X3Jwc19yZXNldF9laShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQltZW1zZXQoJmRldl9wcml2
LT5ndF9wbS5ycHMuZWksIDAsIHNpemVvZihkZXZfcHJpdi0+Z3RfcG0ucnBzLmVpKSk7Cj4gPiAr
CW1lbXNldCgmaTkxNS0+Z3RfcG0ucnBzLmVpLCAwLCBzaXplb2YoaTkxNS0+Z3RfcG0ucnBzLmVp
KSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTMyIHZsdl93YV9jMF9laShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwbV9paXIpCj4gPiArc3RhdGljIHUzMiB2bHZfd2FfYzBf
ZWkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBwbV9paXIpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gPiArCXN0
cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gPiAgIAljb25zdCBzdHJ1
Y3QgaW50ZWxfcnBzX2VpICpwcmV2ID0gJnJwcy0+ZWk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcnBz
X2VpIG5vdzsKPiA+ICAgCXUzMiBldmVudHMgPSAwOwo+ID4gQEAgLTEyOTQsNyArMTI5NCw3IEBA
IHN0YXRpYyB1MzIgdmx2X3dhX2MwX2VpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgdTMyIHBtX2lpcikKPiA+ICAgCWlmICgocG1faWlyICYgR0VONl9QTV9SUF9VUF9FSV9FWFBJ
UkVEKSA9PSAwKQo+ID4gICAJCXJldHVybiAwOwo+ID4gLQl2bHZfYzBfcmVhZChkZXZfcHJpdiwg
Jm5vdyk7Cj4gPiArCXZsdl9jMF9yZWFkKGk5MTUsICZub3cpOwo+ID4gICAJaWYgKHByZXYtPmt0
aW1lKSB7Cj4gPiAgIAkJdTY0IHRpbWUsIGMwOwo+ID4gQEAgLTEzMDIsNyArMTMwMiw3IEBAIHN0
YXRpYyB1MzIgdmx2X3dhX2MwX2VpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
dTMyIHBtX2lpcikKPiA+ICAgCQl0aW1lID0ga3RpbWVfdXNfZGVsdGEobm93Lmt0aW1lLCBwcmV2
LT5rdGltZSk7Cj4gPiAtCQl0aW1lICo9IGRldl9wcml2LT5jemNsa19mcmVxOwo+ID4gKwkJdGlt
ZSAqPSBpOTE1LT5jemNsa19mcmVxOwo+ID4gICAJCS8qIFdvcmtsb2FkIGNhbiBiZSBzcGxpdCBi
ZXR3ZWVuIHJlbmRlciArIG1lZGlhLAo+ID4gICAJCSAqIGUuZy4gU3dhcEJ1ZmZlcnMgYmVpbmcg
YmxpdHRlZCBpbiBYIGFmdGVyIGJlaW5nIHJlbmRlcmVkIGluCj4gPiBAQCAtMTMyNiwyOCArMTMy
NiwyOCBAQCBzdGF0aWMgdTMyIHZsdl93YV9jMF9laShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIHUzMiBwbV9paXIpCj4gPiAgIHN0YXRpYyB2b2lkIGdlbjZfcG1fcnBzX3dvcmso
c3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0K
PiA+ICAgCQljb250YWluZXJfb2Yod29yaywgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUsIGd0X3Bt
LnJwcy53b3JrKTsKPiA+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9w
bS5ycHM7Cj4gPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4g
PiAgIAlib29sIGNsaWVudF9ib29zdCA9IGZhbHNlOwo+ID4gICAJaW50IG5ld19kZWxheSwgYWRq
LCBtaW4sIG1heDsKPiA+ICAgCXUzMiBwbV9paXIgPSAwOwo+ID4gLQlzcGluX2xvY2tfaXJxKCZk
ZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7
Cj4gPiAgIAlpZiAocnBzLT5pbnRlcnJ1cHRzX2VuYWJsZWQpIHsKPiA+ICAgCQlwbV9paXIgPSBm
ZXRjaF9hbmRfemVybygmcnBzLT5wbV9paXIpOwo+ID4gICAJCWNsaWVudF9ib29zdCA9IGF0b21p
Y19yZWFkKCZycHMtPm51bV93YWl0ZXJzKTsKPiA+ICAgCX0KPiA+IC0Jc3Bpbl91bmxvY2tfaXJx
KCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGluX3VubG9ja19pcnEoJmk5MTUtPmlycV9s
b2NrKTsKPiA+ICAgCS8qIE1ha2Ugc3VyZSB3ZSBkaWRuJ3QgcXVldWUgYW55dGhpbmcgd2UncmUg
bm90IGdvaW5nIHRvIHByb2Nlc3MuICovCj4gPiAtCVdBUk5fT04ocG1faWlyICYgfmRldl9wcml2
LT5wbV9ycHNfZXZlbnRzKTsKPiA+IC0JaWYgKChwbV9paXIgJiBkZXZfcHJpdi0+cG1fcnBzX2V2
ZW50cykgPT0gMCAmJiAhY2xpZW50X2Jvb3N0KQo+ID4gKwlXQVJOX09OKHBtX2lpciAmIH5pOTE1
LT5wbV9ycHNfZXZlbnRzKTsKPiA+ICsJaWYgKChwbV9paXIgJiBpOTE1LT5wbV9ycHNfZXZlbnRz
KSA9PSAwICYmICFjbGllbnRfYm9vc3QpCj4gPiAgIAkJZ290byBvdXQ7Cj4gPiAgIAltdXRleF9s
b2NrKCZycHMtPmxvY2spOwo+ID4gLQlwbV9paXIgfD0gdmx2X3dhX2MwX2VpKGRldl9wcml2LCBw
bV9paXIpOwo+ID4gKwlwbV9paXIgfD0gdmx2X3dhX2MwX2VpKGk5MTUsIHBtX2lpcik7Cj4gPiAg
IAlhZGogPSBycHMtPmxhc3RfYWRqOwo+ID4gICAJbmV3X2RlbGF5ID0gcnBzLT5jdXJfZnJlcTsK
PiA+IEBAIC0xMzYyLDcgKzEzNjIsNyBAQCBzdGF0aWMgdm9pZCBnZW42X3BtX3Jwc193b3JrKHN0
cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgCQlpZiAoYWRqID4gMCkKPiA+ICAgCQkJYWRq
ICo9IDI7Cj4gPiAgIAkJZWxzZSAvKiBDSFYgbmVlZHMgZXZlbiBlbmNvZGUgdmFsdWVzICovCj4g
PiAtCQkJYWRqID0gSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgPyAyIDogMTsKPiA+ICsJCQlhZGog
PSBJU19DSEVSUllWSUVXKGk5MTUpID8gMiA6IDE7Cj4gPiAgIAkJaWYgKG5ld19kZWxheSA+PSBy
cHMtPm1heF9mcmVxX3NvZnRsaW1pdCkKPiA+ICAgCQkJYWRqID0gMDsKPiA+IEBAIC0xMzc4LDcg
KzEzNzgsNyBAQCBzdGF0aWMgdm9pZCBnZW42X3BtX3Jwc193b3JrKHN0cnVjdCB3b3JrX3N0cnVj
dCAqd29yaykKPiA+ICAgCQlpZiAoYWRqIDwgMCkKPiA+ICAgCQkJYWRqICo9IDI7Cj4gPiAgIAkJ
ZWxzZSAvKiBDSFYgbmVlZHMgZXZlbiBlbmNvZGUgdmFsdWVzICovCj4gPiAtCQkJYWRqID0gSVNf
Q0hFUlJZVklFVyhkZXZfcHJpdikgPyAtMiA6IC0xOwo+ID4gKwkJCWFkaiA9IElTX0NIRVJSWVZJ
RVcoaTkxNSkgPyAtMiA6IC0xOwo+ID4gICAJCWlmIChuZXdfZGVsYXkgPD0gcnBzLT5taW5fZnJl
cV9zb2Z0bGltaXQpCj4gPiAgIAkJCWFkaiA9IDA7Cj4gPiBAQCAtMTQwNiw3ICsxNDA2LDcgQEAg
c3RhdGljIHZvaWQgZ2VuNl9wbV9ycHNfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4g
PiAgIAluZXdfZGVsYXkgKz0gYWRqOwo+ID4gICAJbmV3X2RlbGF5ID0gY2xhbXBfdChpbnQsIG5l
d19kZWxheSwgbWluLCBtYXgpOwo+ID4gLQlpZiAoaW50ZWxfc2V0X3JwcyhkZXZfcHJpdiwgbmV3
X2RlbGF5KSkgewo+ID4gKwlpZiAoaW50ZWxfc2V0X3JwcyhpOTE1LCBuZXdfZGVsYXkpKSB7Cj4g
PiAgIAkJRFJNX0RFQlVHX0RSSVZFUigiRmFpbGVkIHRvIHNldCBuZXcgR1BVIGZyZXF1ZW5jeVxu
Iik7Cj4gPiAgIAkJcnBzLT5sYXN0X2FkaiA9IDA7Cj4gPiAgIAl9Cj4gPiBAQCAtMTQxNSwxMCAr
MTQxNSwxMCBAQCBzdGF0aWMgdm9pZCBnZW42X3BtX3Jwc193b3JrKHN0cnVjdCB3b3JrX3N0cnVj
dCAqd29yaykKPiA+ICAgb3V0Ogo+ID4gICAJLyogTWFrZSBzdXJlIG5vdCB0byBjb3JydXB0IFBN
SU1SIHN0YXRlIHVzZWQgYnkgcmluZ2J1ZmZlciBvbiBHRU42ICovCj4gPiAtCXNwaW5fbG9ja19p
cnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9s
b2NrKTsKPiA+ICAgCWlmIChycHMtPmludGVycnVwdHNfZW5hYmxlZCkKPiA+IC0JCWdlbjZfdW5t
YXNrX3BtX2lycShkZXZfcHJpdiwgZGV2X3ByaXYtPnBtX3Jwc19ldmVudHMpOwo+ID4gLQlzcGlu
X3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCQlnZW42X3VubWFza19wbV9p
cnEoaTkxNSwgaTkxNS0+cG1fcnBzX2V2ZW50cyk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycSgmaTkx
NS0+aXJxX2xvY2spOwo+ID4gICB9Cj4gPiBAQCAtMTQzMyw4ICsxNDMzLDggQEAgc3RhdGljIHZv
aWQgZ2VuNl9wbV9ycHNfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiAgICAqLwo+
ID4gICBzdGF0aWMgdm9pZCBpdnlicmlkZ2VfcGFyaXR5X3dvcmsoc3RydWN0IHdvcmtfc3RydWN0
ICp3b3JrKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
Cj4gPiAtCQljb250YWluZXJfb2Yod29yaywgdHlwZW9mKCpkZXZfcHJpdiksIGwzX3Bhcml0eS5l
cnJvcl93b3JrKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ID4gKwkJ
Y29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqaTkxNSksIGwzX3Bhcml0eS5lcnJvcl93b3JrKTsK
PiA+ICAgCXUzMiBlcnJvcl9zdGF0dXMsIHJvdywgYmFuaywgc3ViYmFuazsKPiA+ICAgCWNoYXIg
KnBhcml0eV9ldmVudFs2XTsKPiA+ICAgCXUzMiBtaXNjY3BjdGw7Cj4gPiBAQCAtMTQ0NCwyNCAr
MTQ0NCwyNCBAQCBzdGF0aWMgdm9pZCBpdnlicmlkZ2VfcGFyaXR5X3dvcmsoc3RydWN0IHdvcmtf
c3RydWN0ICp3b3JrKQo+ID4gICAJICogSW4gb3JkZXIgdG8gcHJldmVudCBhIGdldC9wdXQgc3R5
bGUgaW50ZXJmYWNlLCBhY3F1aXJlIHN0cnVjdCBtdXRleAo+ID4gICAJICogYW55IHRpbWUgd2Ug
YWNjZXNzIHRob3NlIHJlZ2lzdGVycy4KPiA+ICAgCSAqLwo+ID4gLQltdXRleF9sb2NrKCZkZXZf
cHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwo+ID4gICAJLyogSWYgd2UndmUgc2NyZXdlZCB1cCB0cmFja2luZywganVzdCBs
ZXQgdGhlIGludGVycnVwdCBmaXJlIGFnYWluICovCj4gPiAtCWlmIChXQVJOX09OKCFkZXZfcHJp
di0+bDNfcGFyaXR5LndoaWNoX3NsaWNlKSkKPiA+ICsJaWYgKFdBUk5fT04oIWk5MTUtPmwzX3Bh
cml0eS53aGljaF9zbGljZSkpCj4gPiAgIAkJZ290byBvdXQ7Cj4gPiAgIAltaXNjY3BjdGwgPSBJ
OTE1X1JFQUQoR0VON19NSVNDQ1BDVEwpOwo+ID4gICAJSTkxNV9XUklURShHRU43X01JU0NDUENU
TCwgbWlzY2NwY3RsICYgfkdFTjdfRE9QX0NMT0NLX0dBVEVfRU5BQkxFKTsKPiA+ICAgCVBPU1RJ
TkdfUkVBRChHRU43X01JU0NDUENUTCk7Cj4gPiAtCXdoaWxlICgoc2xpY2UgPSBmZnMoZGV2X3By
aXYtPmwzX3Bhcml0eS53aGljaF9zbGljZSkpICE9IDApIHsKPiA+ICsJd2hpbGUgKChzbGljZSA9
IGZmcyhpOTE1LT5sM19wYXJpdHkud2hpY2hfc2xpY2UpKSAhPSAwKSB7Cj4gPiAgIAkJaTkxNV9y
ZWdfdCByZWc7Cj4gPiAgIAkJc2xpY2UtLTsKPiA+IC0JCWlmIChXQVJOX09OX09OQ0Uoc2xpY2Ug
Pj0gTlVNX0wzX1NMSUNFUyhkZXZfcHJpdikpKQo+ID4gKwkJaWYgKFdBUk5fT05fT05DRShzbGlj
ZSA+PSBOVU1fTDNfU0xJQ0VTKGk5MTUpKSkKPiA+ICAgCQkJYnJlYWs7Cj4gPiAtCQlkZXZfcHJp
di0+bDNfcGFyaXR5LndoaWNoX3NsaWNlICY9IH4oMTw8c2xpY2UpOwo+ID4gKwkJaTkxNS0+bDNf
cGFyaXR5LndoaWNoX3NsaWNlICY9IH4oMTw8c2xpY2UpOwo+ID4gICAJCXJlZyA9IEdFTjdfTDND
REVSUlNUMShzbGljZSk7Cj4gPiBAQCAtMTQ4MCw3ICsxNDgwLDcgQEAgc3RhdGljIHZvaWQgaXZ5
YnJpZGdlX3Bhcml0eV93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgCQlwYXJp
dHlfZXZlbnRbNF0gPSBrYXNwcmludGYoR0ZQX0tFUk5FTCwgIlNMSUNFPSVkIiwgc2xpY2UpOwo+
ID4gICAJCXBhcml0eV9ldmVudFs1XSA9IE5VTEw7Cj4gPiAtCQlrb2JqZWN0X3VldmVudF9lbnYo
JmRldl9wcml2LT5kcm0ucHJpbWFyeS0+a2Rldi0+a29iaiwKPiA+ICsJCWtvYmplY3RfdWV2ZW50
X2VudigmaTkxNS0+ZHJtLnByaW1hcnktPmtkZXYtPmtvYmosCj4gPiAgIAkJCQkgICBLT0JKX0NI
QU5HRSwgcGFyaXR5X2V2ZW50KTsKPiA+ICAgCQlEUk1fREVCVUcoIlBhcml0eSBlcnJvcjogU2xp
Y2UgPSAlZCwgUm93ID0gJWQsIEJhbmsgPSAlZCwgU3ViIGJhbmsgPSAlZC5cbiIsCj4gPiBAQCAt
MTQ5NSw2MCArMTQ5NSw2MCBAQCBzdGF0aWMgdm9pZCBpdnlicmlkZ2VfcGFyaXR5X3dvcmsoc3Ry
dWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ID4gICAJSTkxNV9XUklURShHRU43X01JU0NDUENUTCwg
bWlzY2NwY3RsKTsKPiA+ICAgb3V0Ogo+ID4gLQlXQVJOX09OKGRldl9wcml2LT5sM19wYXJpdHku
d2hpY2hfc2xpY2UpOwo+ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+
ID4gLQlnZW41X2VuYWJsZV9ndF9pcnEoZGV2X3ByaXYsIEdUX1BBUklUWV9FUlJPUihkZXZfcHJp
dikpOwo+ID4gLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCVdB
Uk5fT04oaTkxNS0+bDNfcGFyaXR5LndoaWNoX3NsaWNlKTsKPiA+ICsJc3Bpbl9sb2NrX2lycSgm
aTkxNS0+aXJxX2xvY2spOwo+ID4gKwlnZW41X2VuYWJsZV9ndF9pcnEoaTkxNSwgR1RfUEFSSVRZ
X0VSUk9SKGk5MTUpKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4g
PiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwltdXRl
eF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgaXZ5YnJpZGdlX3Bhcml0eV9lcnJvcl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaXZ5YnJpZGdlX3Bhcml0eV9lcnJvcl9p
cnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICAg
ICAgdTMyIGlpcikKPiA+ICAgewo+ID4gLQlpZiAoIUhBU19MM19EUEYoZGV2X3ByaXYpKQo+ID4g
KwlpZiAoIUhBU19MM19EUEYoaTkxNSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlzcGluX2xvY2so
JmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAtCWdlbjVfZGlzYWJsZV9ndF9pcnEoZGV2X3ByaXYs
IEdUX1BBUklUWV9FUlJPUihkZXZfcHJpdikpOwo+ID4gLQlzcGluX3VubG9jaygmZGV2X3ByaXYt
PmlycV9sb2NrKTsKPiA+ICsJc3Bpbl9sb2NrKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiArCWdlbjVf
ZGlzYWJsZV9ndF9pcnEoaTkxNSwgR1RfUEFSSVRZX0VSUk9SKGk5MTUpKTsKPiA+ICsJc3Bpbl91
bmxvY2soJmk5MTUtPmlycV9sb2NrKTsKPiA+IC0JaWlyICY9IEdUX1BBUklUWV9FUlJPUihkZXZf
cHJpdik7Cj4gPiArCWlpciAmPSBHVF9QQVJJVFlfRVJST1IoaTkxNSk7Cj4gPiAgIAlpZiAoaWly
ICYgR1RfUkVOREVSX0wzX1BBUklUWV9FUlJPUl9JTlRFUlJVUFRfUzEpCj4gPiAtCQlkZXZfcHJp
di0+bDNfcGFyaXR5LndoaWNoX3NsaWNlIHw9IDEgPDwgMTsKPiA+ICsJCWk5MTUtPmwzX3Bhcml0
eS53aGljaF9zbGljZSB8PSAxIDw8IDE7Cj4gPiAgIAlpZiAoaWlyICYgR1RfUkVOREVSX0wzX1BB
UklUWV9FUlJPUl9JTlRFUlJVUFQpCj4gPiAtCQlkZXZfcHJpdi0+bDNfcGFyaXR5LndoaWNoX3Ns
aWNlIHw9IDEgPDwgMDsKPiA+ICsJCWk5MTUtPmwzX3Bhcml0eS53aGljaF9zbGljZSB8PSAxIDw8
IDA7Cj4gPiAtCXF1ZXVlX3dvcmsoZGV2X3ByaXYtPndxLCAmZGV2X3ByaXYtPmwzX3Bhcml0eS5l
cnJvcl93b3JrKTsKPiA+ICsJcXVldWVfd29yayhpOTE1LT53cSwgJmk5MTUtPmwzX3Bhcml0eS5l
cnJvcl93b3JrKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGlsa19ndF9pcnFfaGFuZGxlcihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaWxrX2d0
X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAg
ICAgdTMyIGd0X2lpcikKPiA+ICAgewo+ID4gICAJaWYgKGd0X2lpciAmIEdUX1JFTkRFUl9VU0VS
X0lOVEVSUlVQVCkKPiA+IC0JCWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoZGV2X3ByaXYt
PmVuZ2luZVtSQ1MwXSk7Cj4gPiArCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGk5MTUt
PmVuZ2luZVtSQ1MwXSk7Cj4gPiAgIAlpZiAoZ3RfaWlyICYgSUxLX0JTRF9VU0VSX0lOVEVSUlVQ
VCkKPiA+IC0JCWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoZGV2X3ByaXYtPmVuZ2luZVtW
Q1MwXSk7Cj4gPiArCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGk5MTUtPmVuZ2luZVtW
Q1MwXSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBzbmJfZ3RfaXJxX2hhbmRsZXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIHNuYl9ndF9pcnFf
aGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgIHUz
MiBndF9paXIpCj4gPiAgIHsKPiA+ICAgCWlmIChndF9paXIgJiBHVF9SRU5ERVJfVVNFUl9JTlRF
UlJVUFQpCj4gPiAtCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGRldl9wcml2LT5lbmdp
bmVbUkNTMF0pOwo+ID4gKwkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycShpOTE1LT5lbmdp
bmVbUkNTMF0pOwo+ID4gICAJaWYgKGd0X2lpciAmIEdUX0JTRF9VU0VSX0lOVEVSUlVQVCkKPiA+
IC0JCWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoZGV2X3ByaXYtPmVuZ2luZVtWQ1MwXSk7
Cj4gPiArCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGk5MTUtPmVuZ2luZVtWQ1MwXSk7
Cj4gPiAgIAlpZiAoZ3RfaWlyICYgR1RfQkxUX1VTRVJfSU5URVJSVVBUKQo+ID4gLQkJaW50ZWxf
ZW5naW5lX2JyZWFkY3J1bWJzX2lycShkZXZfcHJpdi0+ZW5naW5lW0JDUzBdKTsKPiA+ICsJCWlu
dGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoaTkxNS0+ZW5naW5lW0JDUzBdKTsKPiA+ICAgCWlm
IChndF9paXIgJiAoR1RfQkxUX0NTX0VSUk9SX0lOVEVSUlVQVCB8Cj4gPiAgIAkJICAgICAgR1Rf
QlNEX0NTX0VSUk9SX0lOVEVSUlVQVCB8Cj4gPiAgIAkJICAgICAgR1RfUkVOREVSX0NTX01BU1RF
Ul9FUlJPUl9JTlRFUlJVUFQpKQo+ID4gICAJCURSTV9ERUJVRygiQ29tbWFuZCBwYXJzZXIgZXJy
b3IsIGd0X2lpciAweCUwOHhcbiIsIGd0X2lpcik7Cj4gPiAtCWlmIChndF9paXIgJiBHVF9QQVJJ
VFlfRVJST1IoZGV2X3ByaXYpKQo+ID4gLQkJaXZ5YnJpZGdlX3Bhcml0eV9lcnJvcl9pcnFfaGFu
ZGxlcihkZXZfcHJpdiwgZ3RfaWlyKTsKPiA+ICsJaWYgKGd0X2lpciAmIEdUX1BBUklUWV9FUlJP
UihpOTE1KSkKPiA+ICsJCWl2eWJyaWRnZV9wYXJpdHlfZXJyb3JfaXJxX2hhbmRsZXIoaTkxNSwg
Z3RfaWlyKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZAo+ID4gQEAgLTE3NjMsNyArMTc2Myw3
IEBAIHN0YXRpYyBib29sIGk5eHhfcG9ydF9ob3RwbHVnX2xvbmdfZGV0ZWN0KGVudW0gaHBkX3Bp
biBwaW4sIHUzMiB2YWwpCj4gPiAgICAqCj4gPiAgICAqIE5vdGUgdGhhdCB0aGUgY2FsbGVyIGlz
IGV4cGVjdGVkIHRvIHplcm8gb3V0IHRoZSBtYXNrcyBpbml0aWFsbHkuCj4gPiAgICAqLwo+ID4g
LXN0YXRpYyB2b2lkIGludGVsX2dldF9ocGRfcGlucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaW50ZWxfZ2V0X2hwZF9waW5zKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgICAgdTMyICpwaW5fbWFzaywgdTMyICps
b25nX21hc2ssCj4gPiAgIAkJCSAgICAgICB1MzIgaG90cGx1Z190cmlnZ2VyLCB1MzIgZGlnX2hv
dHBsdWdfcmVnLAo+ID4gICAJCQkgICAgICAgY29uc3QgdTMyIGhwZFtIUERfTlVNX1BJTlNdLAo+
ID4gQEAgLTE3ODYsMjUgKzE3ODYsMjUgQEAgc3RhdGljIHZvaWQgaW50ZWxfZ2V0X2hwZF9waW5z
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgfQo+ID4gLXN0YXRpYyB2
b2lkIGdtYnVzX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICtzdGF0aWMgdm9pZCBnbWJ1c19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQl3YWtlX3VwX2FsbCgmZGV2X3ByaXYtPmdtYnVzX3dhaXRf
cXVldWUpOwo+ID4gKwl3YWtlX3VwX2FsbCgmaTkxNS0+Z21idXNfd2FpdF9xdWV1ZSk7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCBkcF9hdXhfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGRwX2F1eF9pcnFfaGFuZGxlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQl3YWtlX3VwX2FsbCgmZGV2
X3ByaXYtPmdtYnVzX3dhaXRfcXVldWUpOwo+ID4gKwl3YWtlX3VwX2FsbCgmaTkxNS0+Z21idXNf
d2FpdF9xdWV1ZSk7Cj4gPiAgIH0KPiA+ICAgI2lmIGRlZmluZWQoQ09ORklHX0RFQlVHX0ZTKQo+
ID4gLXN0YXRpYyB2b2lkIGRpc3BsYXlfcGlwZV9jcmNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGRpc3BsYXlfcGlwZV9jcmNf
aXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJIGVu
dW0gcGlwZSBwaXBlLAo+ID4gICAJCQkJCSB1MzIgY3JjMCwgdTMyIGNyYzEsCj4gPiAgIAkJCQkJ
IHUzMiBjcmMyLCB1MzIgY3JjMywKPiA+ICAgCQkJCQkgdTMyIGNyYzQpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGludGVsX3BpcGVfY3JjICpwaXBlX2NyYyA9ICZkZXZfcHJpdi0+cGlwZV9jcmNbcGlw
ZV07Cj4gPiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3Bp
cGUoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcGlwZV9jcmMgKnBpcGVfY3Jj
ID0gJmk5MTUtPnBpcGVfY3JjW3BpcGVdOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGk5MTUsIHBpcGUpOwo+ID4gICAJdTMyIGNyY3NbNV0g
PSB7IGNyYzAsIGNyYzEsIGNyYzIsIGNyYzMsIGNyYzQgfTsKPiA+ICAgCXRyYWNlX2ludGVsX3Bp
cGVfY3JjKGNydGMsIGNyY3MpOwo+ID4gQEAgLTE4MTksNyArMTgxOSw3IEBAIHN0YXRpYyB2b2lk
IGRpc3BsYXlfcGlwZV9jcmNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAJICogZG9uJ3QgdHJ1c3QgdGhhdCBvbmUgZWl0aGVyLgo+ID4gICAJICov
Cj4gPiAgIAlpZiAocGlwZV9jcmMtPnNraXBwZWQgPD0gMCB8fAo+ID4gLQkgICAgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gOCAmJiBwaXBlX2NyYy0+c2tpcHBlZCA9PSAxKSkgewo+ID4gKwkgICAg
KElOVEVMX0dFTihpOTE1KSA+PSA4ICYmIHBpcGVfY3JjLT5za2lwcGVkID09IDEpKSB7Cj4gPiAg
IAkJcGlwZV9jcmMtPnNraXBwZWQrKzsKPiA+ICAgCQlzcGluX3VubG9jaygmcGlwZV9jcmMtPmxv
Y2spOwo+ID4gICAJCXJldHVybjsKPiA+IEBAIC0xODMyLDcgKzE4MzIsNyBAQCBzdGF0aWMgdm9p
ZCBkaXNwbGF5X3BpcGVfY3JjX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgfQo+ID4gICAjZWxzZQo+ID4gICBzdGF0aWMgaW5saW5lIHZvaWQKPiA+
IC1kaXNwbGF5X3BpcGVfY3JjX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICtkaXNwbGF5X3BpcGVfY3JjX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgIGVudW0gcGlwZSBwaXBlLAo+ID4gICAJCQkg
ICAgIHUzMiBjcmMwLCB1MzIgY3JjMSwKPiA+ICAgCQkJICAgICB1MzIgY3JjMiwgdTMyIGNyYzMs
Cj4gPiBAQCAtMTg0MCwxOCArMTg0MCwxOCBAQCBkaXNwbGF5X3BpcGVfY3JjX2lycV9oYW5kbGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgI2VuZGlmCj4gPiAtc3Rh
dGljIHZvaWQgaHN3X3BpcGVfY3JjX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBoc3dfcGlwZV9jcmNfaXJxX2hhbmRsZXIoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgIGVudW0gcGlwZSBwaXBl
KQo+ID4gICB7Cj4gPiAtCWRpc3BsYXlfcGlwZV9jcmNfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBp
cGUsCj4gPiArCWRpc3BsYXlfcGlwZV9jcmNfaXJxX2hhbmRsZXIoaTkxNSwgcGlwZSwKPiA+ICAg
CQkJCSAgICAgSTkxNV9SRUFEKFBJUEVfQ1JDX1JFU18xX0lWQihwaXBlKSksCj4gPiAgIAkJCQkg
ICAgIDAsIDAsIDAsIDApOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaXZiX3BpcGVfY3JjX2ly
cV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMg
dm9pZCBpdmJfcGlwZV9jcmNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJCQkgICAgIGVudW0gcGlwZSBwaXBlKQo+ID4gICB7Cj4gPiAtCWRpc3BsYXlf
cGlwZV9jcmNfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBpcGUsCj4gPiArCWRpc3BsYXlfcGlwZV9j
cmNfaXJxX2hhbmRsZXIoaTkxNSwgcGlwZSwKPiA+ICAgCQkJCSAgICAgSTkxNV9SRUFEKFBJUEVf
Q1JDX1JFU18xX0lWQihwaXBlKSksCj4gPiAgIAkJCQkgICAgIEk5MTVfUkVBRChQSVBFX0NSQ19S
RVNfMl9JVkIocGlwZSkpLAo+ID4gICAJCQkJICAgICBJOTE1X1JFQUQoUElQRV9DUkNfUkVTXzNf
SVZCKHBpcGUpKSwKPiA+IEBAIC0xODU5LDIyICsxODU5LDIyIEBAIHN0YXRpYyB2b2lkIGl2Yl9w
aXBlX2NyY19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiAgIAkJCQkgICAgIEk5MTVfUkVBRChQSVBFX0NSQ19SRVNfNV9JVkIocGlwZSkpKTsKPiA+ICAg
fQo+ID4gLXN0YXRpYyB2b2lkIGk5eHhfcGlwZV9jcmNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGk5eHhfcGlwZV9jcmNfaXJx
X2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgICBl
bnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gICAJdTMyIHJlczEsIHJlczI7Cj4gPiAtCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDMpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMykK
PiA+ICAgCQlyZXMxID0gSTkxNV9SRUFEKFBJUEVfQ1JDX1JFU19SRVMxX0k5MTUocGlwZSkpOwo+
ID4gICAJZWxzZQo+ID4gICAJCXJlczEgPSAwOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSA1IHx8IElTX0c0WChkZXZfcHJpdikpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0g
NSB8fCBJU19HNFgoaTkxNSkpCj4gPiAgIAkJcmVzMiA9IEk5MTVfUkVBRChQSVBFX0NSQ19SRVNf
UkVTMl9HNFgocGlwZSkpOwo+ID4gICAJZWxzZQo+ID4gICAJCXJlczIgPSAwOwo+ID4gLQlkaXNw
bGF5X3BpcGVfY3JjX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlLAo+ID4gKwlkaXNwbGF5X3Bp
cGVfY3JjX2lycV9oYW5kbGVyKGk5MTUsIHBpcGUsCj4gPiAgIAkJCQkgICAgIEk5MTVfUkVBRChQ
SVBFX0NSQ19SRVNfUkVEKHBpcGUpKSwKPiA+ICAgCQkJCSAgICAgSTkxNV9SRUFEKFBJUEVfQ1JD
X1JFU19HUkVFTihwaXBlKSksCj4gPiAgIAkJCQkgICAgIEk5MTVfUkVBRChQSVBFX0NSQ19SRVNf
QkxVRShwaXBlKSksCj4gPiBAQCAtMTkwMywzNCArMTkwMywzNCBAQCBzdGF0aWMgdm9pZCBnZW4x
MV9ycHNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBwbV9p
aXIpCj4gPiAgIAlzY2hlZHVsZV93b3JrKCZycHMtPndvcmspOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IHZvaWQgZ2VuNl9ycHNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCB1MzIgcG1faWlyKQo+ID4gK3N0YXRpYyB2b2lkIGdlbjZfcnBzX2lycV9oYW5kbGVyKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcG1faWlyKQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlzdHJ1Y3Qg
aW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ID4gLQlpZiAocG1faWlyICYgZGV2
X3ByaXYtPnBtX3Jwc19ldmVudHMpIHsKPiA+IC0JCXNwaW5fbG9jaygmZGV2X3ByaXYtPmlycV9s
b2NrKTsKPiA+IC0JCWdlbjZfbWFza19wbV9pcnEoZGV2X3ByaXYsIHBtX2lpciAmIGRldl9wcml2
LT5wbV9ycHNfZXZlbnRzKTsKPiA+ICsJaWYgKHBtX2lpciAmIGk5MTUtPnBtX3Jwc19ldmVudHMp
IHsKPiA+ICsJCXNwaW5fbG9jaygmaTkxNS0+aXJxX2xvY2spOwo+ID4gKwkJZ2VuNl9tYXNrX3Bt
X2lycShpOTE1LCBwbV9paXIgJiBpOTE1LT5wbV9ycHNfZXZlbnRzKTsKPiA+ICAgCQlpZiAocnBz
LT5pbnRlcnJ1cHRzX2VuYWJsZWQpIHsKPiA+IC0JCQlycHMtPnBtX2lpciB8PSBwbV9paXIgJiBk
ZXZfcHJpdi0+cG1fcnBzX2V2ZW50czsKPiA+ICsJCQlycHMtPnBtX2lpciB8PSBwbV9paXIgJiBp
OTE1LT5wbV9ycHNfZXZlbnRzOwo+ID4gICAJCQlzY2hlZHVsZV93b3JrKCZycHMtPndvcmspOwo+
ID4gICAJCX0KPiA+IC0JCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwkJ
c3Bpbl91bmxvY2soJmk5MTUtPmlycV9sb2NrKTsKPiA+ICAgCX0KPiA+IC0JaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gOCkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KQo+ID4gICAJ
CXJldHVybjsKPiA+ICAgCWlmIChwbV9paXIgJiBQTV9WRUJPWF9VU0VSX0lOVEVSUlVQVCkKPiA+
IC0JCWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoZGV2X3ByaXYtPmVuZ2luZVtWRUNTMF0p
Owo+ID4gKwkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycShpOTE1LT5lbmdpbmVbVkVDUzBd
KTsKPiA+ICAgCWlmIChwbV9paXIgJiBQTV9WRUJPWF9DU19FUlJPUl9JTlRFUlJVUFQpCj4gPiAg
IAkJRFJNX0RFQlVHKCJDb21tYW5kIHBhcnNlciBlcnJvciwgcG1faWlyIDB4JTA4eFxuIiwgcG1f
aWlyKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGdlbjlfZ3VjX2lycV9oYW5kbGVyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGd0X2lpcikKPiA+ICtzdGF0aWMgdm9p
ZCBnZW45X2d1Y19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMy
IGd0X2lpcikKPiA+ICAgewo+ID4gICAJaWYgKGd0X2lpciAmIEdFTjlfR1VDX1RPX0hPU1RfSU5U
X0VWRU5UKQo+ID4gLQkJaW50ZWxfZ3VjX3RvX2hvc3RfZXZlbnRfaGFuZGxlcigmZGV2X3ByaXYt
Pmd1Yyk7Cj4gPiArCQlpbnRlbF9ndWNfdG9faG9zdF9ldmVudF9oYW5kbGVyKCZpOTE1LT5ndWMp
Owo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGdlbjExX2d1Y19pcnFfaGFuZGxlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTE2IGlpcikKPiA+IEBAIC0xOTM5LDMyICsxOTM5LDMy
IEBAIHN0YXRpYyB2b2lkIGdlbjExX2d1Y19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgdTE2IGlpcikKPiA+ICAgCQlpbnRlbF9ndWNfdG9faG9zdF9ldmVudF9oYW5k
bGVyKCZpOTE1LT5ndWMpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaTl4eF9waXBlc3RhdF9p
cnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2
b2lkIGk5eHhfcGlwZXN0YXRfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ID4gICB7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZTsKPiA+IC0JZm9yX2VhY2hfcGlwZShkZXZf
cHJpdiwgcGlwZSkgewo+ID4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpIHsKPiA+ICAgCQlJ
OTE1X1dSSVRFKFBJUEVTVEFUKHBpcGUpLAo+ID4gICAJCQkgICBQSVBFU1RBVF9JTlRfU1RBVFVT
X01BU0sgfAo+ID4gICAJCQkgICBQSVBFX0ZJRk9fVU5ERVJSVU5fU1RBVFVTKTsKPiA+IC0JCWRl
dl9wcml2LT5waXBlc3RhdF9pcnFfbWFza1twaXBlXSA9IDA7Cj4gPiArCQlpOTE1LT5waXBlc3Rh
dF9pcnFfbWFza1twaXBlXSA9IDA7Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBp
OXh4X3BpcGVzdGF0X2lycV9hY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3N0YXRpYyB2b2lkIGk5eHhfcGlwZXN0YXRfaXJxX2FjayhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgdTMyIGlpciwgdTMyIHBpcGVfc3RhdHNbSTkxNV9NQVhf
UElQRVNdKQo+ID4gICB7Cj4gPiAgIAlpbnQgcGlwZTsKPiA+IC0Jc3Bpbl9sb2NrKCZkZXZfcHJp
di0+aXJxX2xvY2spOwo+ID4gKwlzcGluX2xvY2soJmk5MTUtPmlycV9sb2NrKTsKPiA+IC0JaWYg
KCFkZXZfcHJpdi0+ZGlzcGxheV9pcnFzX2VuYWJsZWQpIHsKPiA+IC0JCXNwaW5fdW5sb2NrKCZk
ZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlpZiAoIWk5MTUtPmRpc3BsYXlfaXJxc19lbmFibGVk
KSB7Cj4gPiArCQlzcGluX3VubG9jaygmaTkxNS0+aXJxX2xvY2spOwo+ID4gICAJCXJldHVybjsK
PiA+ICAgCX0KPiA+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ID4gKwlmb3Jf
ZWFjaF9waXBlKGk5MTUsIHBpcGUpIHsKPiA+ICAgCQlpOTE1X3JlZ190IHJlZzsKPiA+ICAgCQl1
MzIgc3RhdHVzX21hc2ssIGVuYWJsZV9tYXNrLCBpaXJfYml0ID0gMDsKPiA+IEBAIC0xOTkxLDE0
ICsxOTkxLDE0IEBAIHN0YXRpYyB2b2lkIGk5eHhfcGlwZXN0YXRfaXJxX2FjayhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJCWJyZWFrOwo+ID4gICAJCX0KPiA+ICAg
CQlpZiAoaWlyICYgaWlyX2JpdCkKPiA+IC0JCQlzdGF0dXNfbWFzayB8PSBkZXZfcHJpdi0+cGlw
ZXN0YXRfaXJxX21hc2tbcGlwZV07Cj4gPiArCQkJc3RhdHVzX21hc2sgfD0gaTkxNS0+cGlwZXN0
YXRfaXJxX21hc2tbcGlwZV07Cj4gPiAgIAkJaWYgKCFzdGF0dXNfbWFzaykKPiA+ICAgCQkJY29u
dGludWU7Cj4gPiAgIAkJcmVnID0gUElQRVNUQVQocGlwZSk7Cj4gPiAgIAkJcGlwZV9zdGF0c1tw
aXBlXSA9IEk5MTVfUkVBRChyZWcpICYgc3RhdHVzX21hc2s7Cj4gPiAtCQllbmFibGVfbWFzayA9
IGk5MTVfcGlwZXN0YXRfZW5hYmxlX21hc2soZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwkJZW5hYmxl
X21hc2sgPSBpOTE1X3BpcGVzdGF0X2VuYWJsZV9tYXNrKGk5MTUsIHBpcGUpOwo+ID4gICAJCS8q
Cj4gPiAgIAkJICogQ2xlYXIgdGhlIFBJUEUqU1RBVCByZWdzIGJlZm9yZSB0aGUgSUlSCj4gPiBA
QCAtMjAxNCwxMDQgKzIwMTQsMTA0IEBAIHN0YXRpYyB2b2lkIGk5eHhfcGlwZXN0YXRfaXJxX2Fj
ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJCUk5MTVfV1JJVEUo
cmVnLCBlbmFibGVfbWFzayk7Cj4gPiAgIAkJfQo+ID4gICAJfQo+ID4gLQlzcGluX3VubG9jaygm
ZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJc3Bpbl91bmxvY2soJmk5MTUtPmlycV9sb2NrKTsK
PiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGk4eHhfcGlwZXN0YXRfaXJxX2hhbmRsZXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGk4eHhfcGlwZXN0
YXRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkg
ICAgICB1MTYgaWlyLCB1MzIgcGlwZV9zdGF0c1tJOTE1X01BWF9QSVBFU10pCj4gPiAgIHsKPiA+
ICAgCWVudW0gcGlwZSBwaXBlOwo+ID4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7
Cj4gPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ID4gICAJCWlmIChwaXBlX3N0YXRz
W3BpcGVdICYgUElQRV9WQkxBTktfSU5URVJSVVBUX1NUQVRVUykKPiA+IC0JCQlkcm1faGFuZGxl
X3ZibGFuaygmZGV2X3ByaXYtPmRybSwgcGlwZSk7Cj4gPiArCQkJZHJtX2hhbmRsZV92Ymxhbmso
Jmk5MTUtPmRybSwgcGlwZSk7Cj4gPiAgIAkJaWYgKHBpcGVfc3RhdHNbcGlwZV0gJiBQSVBFX0NS
Q19ET05FX0lOVEVSUlVQVF9TVEFUVVMpCj4gPiAtCQkJaTl4eF9waXBlX2NyY19pcnFfaGFuZGxl
cihkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCQkJaTl4eF9waXBlX2NyY19pcnFfaGFuZGxlcihpOTE1
LCBwaXBlKTsKPiA+ICAgCQlpZiAocGlwZV9zdGF0c1twaXBlXSAmIFBJUEVfRklGT19VTkRFUlJV
Tl9TVEFUVVMpCj4gPiAtCQkJaW50ZWxfY3B1X2ZpZm9fdW5kZXJydW5faXJxX2hhbmRsZXIoZGV2
X3ByaXYsIHBpcGUpOwo+ID4gKwkJCWludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVy
KGk5MTUsIHBpcGUpOwo+ID4gICAJfQo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaTkxNV9waXBl
c3RhdF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAr
c3RhdGljIHZvaWQgaTkxNV9waXBlc3RhdF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgIHUzMiBpaXIsIHUzMiBwaXBlX3N0YXRzW0k5MTVf
TUFYX1BJUEVTXSkKPiA+ICAgewo+ID4gICAJYm9vbCBibGNfZXZlbnQgPSBmYWxzZTsKPiA+ICAg
CWVudW0gcGlwZSBwaXBlOwo+ID4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4g
PiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ID4gICAJCWlmIChwaXBlX3N0YXRzW3Bp
cGVdICYgUElQRV9WQkxBTktfSU5URVJSVVBUX1NUQVRVUykKPiA+IC0JCQlkcm1faGFuZGxlX3Zi
bGFuaygmZGV2X3ByaXYtPmRybSwgcGlwZSk7Cj4gPiArCQkJZHJtX2hhbmRsZV92YmxhbmsoJmk5
MTUtPmRybSwgcGlwZSk7Cj4gPiAgIAkJaWYgKHBpcGVfc3RhdHNbcGlwZV0gJiBQSVBFX0xFR0FD
WV9CTENfRVZFTlRfU1RBVFVTKQo+ID4gICAJCQlibGNfZXZlbnQgPSB0cnVlOwo+ID4gICAJCWlm
IChwaXBlX3N0YXRzW3BpcGVdICYgUElQRV9DUkNfRE9ORV9JTlRFUlJVUFRfU1RBVFVTKQo+ID4g
LQkJCWk5eHhfcGlwZV9jcmNfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwkJCWk5
eHhfcGlwZV9jcmNfaXJxX2hhbmRsZXIoaTkxNSwgcGlwZSk7Cj4gPiAgIAkJaWYgKHBpcGVfc3Rh
dHNbcGlwZV0gJiBQSVBFX0ZJRk9fVU5ERVJSVU5fU1RBVFVTKQo+ID4gLQkJCWludGVsX2NwdV9m
aWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJCQlpbnRlbF9j
cHVfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihpOTE1LCBwaXBlKTsKPiA+ICAgCX0KPiA+ICAg
CWlmIChibGNfZXZlbnQgfHwgKGlpciAmIEk5MTVfQVNMRV9JTlRFUlJVUFQpKQo+ID4gLQkJaW50
ZWxfb3ByZWdpb25fYXNsZV9pbnRyKGRldl9wcml2KTsKPiA+ICsJCWludGVsX29wcmVnaW9uX2Fz
bGVfaW50cihpOTE1KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGk5NjVfcGlwZXN0YXRfaXJx
X2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2
b2lkIGk5NjVfcGlwZXN0YXRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJCQkgICAgICB1MzIgaWlyLCB1MzIgcGlwZV9zdGF0c1tJOTE1X01BWF9QSVBF
U10pCj4gPiAgIHsKPiA+ICAgCWJvb2wgYmxjX2V2ZW50ID0gZmFsc2U7Cj4gPiAgIAllbnVtIHBp
cGUgcGlwZTsKPiA+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ID4gKwlmb3Jf
ZWFjaF9waXBlKGk5MTUsIHBpcGUpIHsKPiA+ICAgCQlpZiAocGlwZV9zdGF0c1twaXBlXSAmIFBJ
UEVfU1RBUlRfVkJMQU5LX0lOVEVSUlVQVF9TVEFUVVMpCj4gPiAtCQkJZHJtX2hhbmRsZV92Ymxh
bmsoJmRldl9wcml2LT5kcm0sIHBpcGUpOwo+ID4gKwkJCWRybV9oYW5kbGVfdmJsYW5rKCZpOTE1
LT5kcm0sIHBpcGUpOwo+ID4gICAJCWlmIChwaXBlX3N0YXRzW3BpcGVdICYgUElQRV9MRUdBQ1lf
QkxDX0VWRU5UX1NUQVRVUykKPiA+ICAgCQkJYmxjX2V2ZW50ID0gdHJ1ZTsKPiA+ICAgCQlpZiAo
cGlwZV9zdGF0c1twaXBlXSAmIFBJUEVfQ1JDX0RPTkVfSU5URVJSVVBUX1NUQVRVUykKPiA+IC0J
CQlpOXh4X3BpcGVfY3JjX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJCQlpOXh4
X3BpcGVfY3JjX2lycV9oYW5kbGVyKGk5MTUsIHBpcGUpOwo+ID4gICAJCWlmIChwaXBlX3N0YXRz
W3BpcGVdICYgUElQRV9GSUZPX1VOREVSUlVOX1NUQVRVUykKPiA+IC0JCQlpbnRlbF9jcHVfZmlm
b191bmRlcnJ1bl9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCQkJaW50ZWxfY3B1
X2ZpZm9fdW5kZXJydW5faXJxX2hhbmRsZXIoaTkxNSwgcGlwZSk7Cj4gPiAgIAl9Cj4gPiAgIAlp
ZiAoYmxjX2V2ZW50IHx8IChpaXIgJiBJOTE1X0FTTEVfSU5URVJSVVBUKSkKPiA+IC0JCWludGVs
X29wcmVnaW9uX2FzbGVfaW50cihkZXZfcHJpdik7Cj4gPiArCQlpbnRlbF9vcHJlZ2lvbl9hc2xl
X2ludHIoaTkxNSk7Cj4gPiAgIAlpZiAocGlwZV9zdGF0c1swXSAmIFBJUEVfR01CVVNfSU5URVJS
VVBUX1NUQVRVUykKPiA+IC0JCWdtYnVzX2lycV9oYW5kbGVyKGRldl9wcml2KTsKPiA+ICsJCWdt
YnVzX2lycV9oYW5kbGVyKGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgdmFsbGV5dmll
d19waXBlc3RhdF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiArc3RhdGljIHZvaWQgdmFsbGV5dmlld19waXBlc3RhdF9pcnFfaGFuZGxlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICAgdTMyIHBpcGVfc3RhdHNbSTkx
NV9NQVhfUElQRVNdKQo+ID4gICB7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZTsKPiA+IC0JZm9yX2Vh
Y2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ID4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUp
IHsKPiA+ICAgCQlpZiAocGlwZV9zdGF0c1twaXBlXSAmIFBJUEVfU1RBUlRfVkJMQU5LX0lOVEVS
UlVQVF9TVEFUVVMpCj4gPiAtCQkJZHJtX2hhbmRsZV92YmxhbmsoJmRldl9wcml2LT5kcm0sIHBp
cGUpOwo+ID4gKwkJCWRybV9oYW5kbGVfdmJsYW5rKCZpOTE1LT5kcm0sIHBpcGUpOwo+ID4gICAJ
CWlmIChwaXBlX3N0YXRzW3BpcGVdICYgUElQRV9DUkNfRE9ORV9JTlRFUlJVUFRfU1RBVFVTKQo+
ID4gLQkJCWk5eHhfcGlwZV9jcmNfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwkJ
CWk5eHhfcGlwZV9jcmNfaXJxX2hhbmRsZXIoaTkxNSwgcGlwZSk7Cj4gPiAgIAkJaWYgKHBpcGVf
c3RhdHNbcGlwZV0gJiBQSVBFX0ZJRk9fVU5ERVJSVU5fU1RBVFVTKQo+ID4gLQkJCWludGVsX2Nw
dV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJCQlpbnRl
bF9jcHVfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihpOTE1LCBwaXBlKTsKPiA+ICAgCX0KPiA+
ICAgCWlmIChwaXBlX3N0YXRzWzBdICYgUElQRV9HTUJVU19JTlRFUlJVUFRfU1RBVFVTKQo+ID4g
LQkJZ21idXNfaXJxX2hhbmRsZXIoZGV2X3ByaXYpOwo+ID4gKwkJZ21idXNfaXJxX2hhbmRsZXIo
aTkxNSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTMyIGk5eHhfaHBkX2lycV9hY2soc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB1MzIgaTl4eF9ocGRfaXJxX2Fj
ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIGhvdHBs
dWdfc3RhdHVzID0gMCwgaG90cGx1Z19zdGF0dXNfbWFzazsKPiA+ICAgCWludCBpOwo+ID4gLQlp
ZiAoSVNfRzRYKGRldl9wcml2KSB8fAo+ID4gLQkgICAgSVNfVkFMTEVZVklFVyhkZXZfcHJpdikg
fHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiArCWlmIChJU19HNFgoaTkxNSkgfHwKPiA+
ICsJICAgIElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICAg
CQlob3RwbHVnX3N0YXR1c19tYXNrID0gSE9UUExVR19JTlRfU1RBVFVTX0c0WCB8Cj4gPiAgIAkJ
CURQX0FVWF9DSEFOTkVMX01BU0tfSU5UX1NUQVRVU19HNFg7Cj4gPiAgIAllbHNlCj4gPiBAQCAt
MjE0MywzNSArMjE0MywzNSBAQCBzdGF0aWMgdTMyIGk5eHhfaHBkX2lycV9hY2soc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJcmV0dXJuIGhvdHBsdWdfc3RhdHVzOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaTl4eF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGk5eHhfaHBkX2lycV9oYW5k
bGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJIHUzMiBob3RwbHVn
X3N0YXR1cykKPiA+ICAgewo+ID4gICAJdTMyIHBpbl9tYXNrID0gMCwgbG9uZ19tYXNrID0gMDsK
PiA+IC0JaWYgKElTX0c0WChkZXZfcHJpdikgfHwgSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwK
PiA+IC0JICAgIElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19HNFgoaTkx
NSkgfHwgSVNfVkFMTEVZVklFVyhpOTE1KSB8fAo+ID4gKwkgICAgSVNfQ0hFUlJZVklFVyhpOTE1
KSkgewo+ID4gICAJCXUzMiBob3RwbHVnX3RyaWdnZXIgPSBob3RwbHVnX3N0YXR1cyAmIEhPVFBM
VUdfSU5UX1NUQVRVU19HNFg7Cj4gPiAgIAkJaWYgKGhvdHBsdWdfdHJpZ2dlcikgewo+ID4gLQkJ
CWludGVsX2dldF9ocGRfcGlucyhkZXZfcHJpdiwgJnBpbl9tYXNrLCAmbG9uZ19tYXNrLAo+ID4g
KwkJCWludGVsX2dldF9ocGRfcGlucyhpOTE1LCAmcGluX21hc2ssICZsb25nX21hc2ssCj4gPiAg
IAkJCQkJICAgaG90cGx1Z190cmlnZ2VyLCBob3RwbHVnX3RyaWdnZXIsCj4gPiAgIAkJCQkJICAg
aHBkX3N0YXR1c19nNHgsCj4gPiAgIAkJCQkJICAgaTl4eF9wb3J0X2hvdHBsdWdfbG9uZ19kZXRl
Y3QpOwo+ID4gLQkJCWludGVsX2hwZF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGluX21hc2ssIGxv
bmdfbWFzayk7Cj4gPiArCQkJaW50ZWxfaHBkX2lycV9oYW5kbGVyKGk5MTUsIHBpbl9tYXNrLCBs
b25nX21hc2spOwo+ID4gICAJCX0KPiA+ICAgCQlpZiAoaG90cGx1Z19zdGF0dXMgJiBEUF9BVVhf
Q0hBTk5FTF9NQVNLX0lOVF9TVEFUVVNfRzRYKQo+ID4gLQkJCWRwX2F1eF9pcnFfaGFuZGxlcihk
ZXZfcHJpdik7Cj4gPiArCQkJZHBfYXV4X2lycV9oYW5kbGVyKGk5MTUpOwo+ID4gICAJfSBlbHNl
IHsKPiA+ICAgCQl1MzIgaG90cGx1Z190cmlnZ2VyID0gaG90cGx1Z19zdGF0dXMgJiBIT1RQTFVH
X0lOVF9TVEFUVVNfSTkxNTsKPiA+ICAgCQlpZiAoaG90cGx1Z190cmlnZ2VyKSB7Cj4gPiAtCQkJ
aW50ZWxfZ2V0X2hwZF9waW5zKGRldl9wcml2LCAmcGluX21hc2ssICZsb25nX21hc2ssCj4gPiAr
CQkJaW50ZWxfZ2V0X2hwZF9waW5zKGk5MTUsICZwaW5fbWFzaywgJmxvbmdfbWFzaywKPiA+ICAg
CQkJCQkgICBob3RwbHVnX3RyaWdnZXIsIGhvdHBsdWdfdHJpZ2dlciwKPiA+ICAgCQkJCQkgICBo
cGRfc3RhdHVzX2k5MTUsCj4gPiAgIAkJCQkJICAgaTl4eF9wb3J0X2hvdHBsdWdfbG9uZ19kZXRl
Y3QpOwo+ID4gLQkJCWludGVsX2hwZF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGluX21hc2ssIGxv
bmdfbWFzayk7Cj4gPiArCQkJaW50ZWxfaHBkX2lycV9oYW5kbGVyKGk5MTUsIHBpbl9tYXNrLCBs
b25nX21hc2spOwo+ID4gICAJCX0KPiA+ICAgCX0KPiA+ICAgfQo+ID4gQEAgLTIxNzksMTQgKzIx
NzksMTQgQEAgc3RhdGljIHZvaWQgaTl4eF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICBzdGF0aWMgaXJxcmV0dXJuX3QgdmFsbGV5dmlld19p
cnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYgPSBhcmc7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGRldik7Cj4gPiAgIAlpcnFyZXR1cm5fdCByZXQgPSBJUlFfTk9ORTsKPiA+IC0JaWYg
KCFpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIWludGVsX2lycXNfZW5h
YmxlZChpOTE1KSkKPiA+ICAgCQlyZXR1cm4gSVJRX05PTkU7Cj4gPiAgIAkvKiBJUlFzIGFyZSBz
eW5jZWQgZHVyaW5nIHJ1bnRpbWVfc3VzcGVuZCwgd2UgZG9uJ3QgcmVxdWlyZSBhIHdha2VyZWYg
Ki8KPiA+IC0JZGlzYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGRldl9wcml2KTsKPiA+ICsJZGlz
YWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ID4gICAJZG8gewo+ID4gICAJCXUzMiBp
aXIsIGd0X2lpciwgcG1faWlyOwo+ID4gQEAgLTIyMjYsMTUgKzIyMjYsMTUgQEAgc3RhdGljIGly
cXJldHVybl90IHZhbGxleXZpZXdfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQo+ID4g
ICAJCQlJOTE1X1dSSVRFKEdFTjZfUE1JSVIsIHBtX2lpcik7Cj4gPiAgIAkJaWYgKGlpciAmIEk5
MTVfRElTUExBWV9QT1JUX0lOVEVSUlVQVCkKPiA+IC0JCQlob3RwbHVnX3N0YXR1cyA9IGk5eHhf
aHBkX2lycV9hY2soZGV2X3ByaXYpOwo+ID4gKwkJCWhvdHBsdWdfc3RhdHVzID0gaTl4eF9ocGRf
aXJxX2FjayhpOTE1KTsKPiA+ICAgCQkvKiBDYWxsIHJlZ2FyZGxlc3MsIGFzIHNvbWUgc3RhdHVz
IGJpdHMgbWlnaHQgbm90IGJlCj4gPiAgIAkJICogc2lnbmFsbGVkIGluIGlpciAqLwo+ID4gLQkJ
aTl4eF9waXBlc3RhdF9pcnFfYWNrKGRldl9wcml2LCBpaXIsIHBpcGVfc3RhdHMpOwo+ID4gKwkJ
aTl4eF9waXBlc3RhdF9pcnFfYWNrKGk5MTUsIGlpciwgcGlwZV9zdGF0cyk7Cj4gPiAgIAkJaWYg
KGlpciAmIChJOTE1X0xQRV9QSVBFX0FfSU5URVJSVVBUIHwKPiA+ICAgCQkJICAgSTkxNV9MUEVf
UElQRV9CX0lOVEVSUlVQVCkpCj4gPiAtCQkJaW50ZWxfbHBlX2F1ZGlvX2lycV9oYW5kbGVyKGRl
dl9wcml2KTsKPiA+ICsJCQlpbnRlbF9scGVfYXVkaW9faXJxX2hhbmRsZXIoaTkxNSk7Cj4gPiAg
IAkJLyoKPiA+ICAgCQkgKiBWTFZfSUlSIGlzIHNpbmdsZSBidWZmZXJlZCwgYW5kIHJlZmxlY3Rz
IHRoZSBsZXZlbAo+ID4gQEAgLTIyNDcsMTcgKzIyNDcsMTcgQEAgc3RhdGljIGlycXJldHVybl90
IHZhbGxleXZpZXdfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQo+ID4gICAJCUk5MTVf
V1JJVEUoVkxWX01BU1RFUl9JRVIsIE1BU1RFUl9JTlRFUlJVUFRfRU5BQkxFKTsKPiA+ICAgCQlp
ZiAoZ3RfaWlyKQo+ID4gLQkJCXNuYl9ndF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgZ3RfaWlyKTsK
PiA+ICsJCQlzbmJfZ3RfaXJxX2hhbmRsZXIoaTkxNSwgZ3RfaWlyKTsKPiA+ICAgCQlpZiAocG1f
aWlyKQo+ID4gLQkJCWdlbjZfcnBzX2lycV9oYW5kbGVyKGRldl9wcml2LCBwbV9paXIpOwo+ID4g
KwkJCWdlbjZfcnBzX2lycV9oYW5kbGVyKGk5MTUsIHBtX2lpcik7Cj4gPiAgIAkJaWYgKGhvdHBs
dWdfc3RhdHVzKQo+ID4gLQkJCWk5eHhfaHBkX2lycV9oYW5kbGVyKGRldl9wcml2LCBob3RwbHVn
X3N0YXR1cyk7Cj4gPiArCQkJaTl4eF9ocGRfaXJxX2hhbmRsZXIoaTkxNSwgaG90cGx1Z19zdGF0
dXMpOwo+ID4gLQkJdmFsbGV5dmlld19waXBlc3RhdF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGlw
ZV9zdGF0cyk7Cj4gPiArCQl2YWxsZXl2aWV3X3BpcGVzdGF0X2lycV9oYW5kbGVyKGk5MTUsIHBp
cGVfc3RhdHMpOwo+ID4gICAJfSB3aGlsZSAoMCk7Cj4gPiAtCWVuYWJsZV9ycG1fd2FrZXJlZl9h
c3NlcnRzKGRldl9wcml2KTsKPiA+ICsJZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7
Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtMjI2NSwxNCArMjI2NSwxNCBAQCBz
dGF0aWMgaXJxcmV0dXJuX3QgdmFsbGV5dmlld19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICph
cmcpCj4gPiAgIHN0YXRpYyBpcnFyZXR1cm5fdCBjaGVycnl2aWV3X2lycV9oYW5kbGVyKGludCBp
cnEsIHZvaWQgKmFyZykKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGFy
ZzsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+
ICAgCWlycXJldHVybl90IHJldCA9IElSUV9OT05FOwo+ID4gLQlpZiAoIWludGVsX2lycXNfZW5h
YmxlZChkZXZfcHJpdikpCj4gPiArCWlmICghaW50ZWxfaXJxc19lbmFibGVkKGk5MTUpKQo+ID4g
ICAJCXJldHVybiBJUlFfTk9ORTsKPiA+ICAgCS8qIElSUXMgYXJlIHN5bmNlZCBkdXJpbmcgcnVu
dGltZV9zdXNwZW5kLCB3ZSBkb24ndCByZXF1aXJlIGEgd2FrZXJlZiAqLwo+ID4gLQlkaXNhYmxl
X3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ID4gKwlkaXNhYmxlX3JwbV93YWtlcmVm
X2Fzc2VydHMoaTkxNSk7Cj4gPiAgIAlkbyB7Cj4gPiAgIAkJdTMyIG1hc3Rlcl9jdGwsIGlpcjsK
PiA+IEBAIC0yMzA2LDE5ICsyMzA2LDE5IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBjaGVycnl2aWV3
X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykKPiA+ICAgCQlpZXIgPSBJOTE1X1JFQUQo
VkxWX0lFUik7Cj4gPiAgIAkJSTkxNV9XUklURShWTFZfSUVSLCAwKTsKPiA+IC0JCWdlbjhfZ3Rf
aXJxX2FjayhkZXZfcHJpdiwgbWFzdGVyX2N0bCwgZ3RfaWlyKTsKPiA+ICsJCWdlbjhfZ3RfaXJx
X2FjayhpOTE1LCBtYXN0ZXJfY3RsLCBndF9paXIpOwo+ID4gICAJCWlmIChpaXIgJiBJOTE1X0RJ
U1BMQVlfUE9SVF9JTlRFUlJVUFQpCj4gPiAtCQkJaG90cGx1Z19zdGF0dXMgPSBpOXh4X2hwZF9p
cnFfYWNrKGRldl9wcml2KTsKPiA+ICsJCQlob3RwbHVnX3N0YXR1cyA9IGk5eHhfaHBkX2lycV9h
Y2soaTkxNSk7Cj4gPiAgIAkJLyogQ2FsbCByZWdhcmRsZXNzLCBhcyBzb21lIHN0YXR1cyBiaXRz
IG1pZ2h0IG5vdCBiZQo+ID4gICAJCSAqIHNpZ25hbGxlZCBpbiBpaXIgKi8KPiA+IC0JCWk5eHhf
cGlwZXN0YXRfaXJxX2FjayhkZXZfcHJpdiwgaWlyLCBwaXBlX3N0YXRzKTsKPiA+ICsJCWk5eHhf
cGlwZXN0YXRfaXJxX2FjayhpOTE1LCBpaXIsIHBpcGVfc3RhdHMpOwo+ID4gICAJCWlmIChpaXIg
JiAoSTkxNV9MUEVfUElQRV9BX0lOVEVSUlVQVCB8Cj4gPiAgIAkJCSAgIEk5MTVfTFBFX1BJUEVf
Ql9JTlRFUlJVUFQgfAo+ID4gICAJCQkgICBJOTE1X0xQRV9QSVBFX0NfSU5URVJSVVBUKSkKPiA+
IC0JCQlpbnRlbF9scGVfYXVkaW9faXJxX2hhbmRsZXIoZGV2X3ByaXYpOwo+ID4gKwkJCWludGVs
X2xwZV9hdWRpb19pcnFfaGFuZGxlcihpOTE1KTsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIFZMVl9J
SVIgaXMgc2luZ2xlIGJ1ZmZlcmVkLCBhbmQgcmVmbGVjdHMgdGhlIGxldmVsCj4gPiBAQCAtMjMz
MCwyMCArMjMzMCwyMCBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgY2hlcnJ5dmlld19pcnFfaGFuZGxl
cihpbnQgaXJxLCB2b2lkICphcmcpCj4gPiAgIAkJSTkxNV9XUklURShWTFZfSUVSLCBpZXIpOwo+
ID4gICAJCUk5MTVfV1JJVEUoR0VOOF9NQVNURVJfSVJRLCBHRU44X01BU1RFUl9JUlFfQ09OVFJP
TCk7Cj4gPiAtCQlnZW44X2d0X2lycV9oYW5kbGVyKGRldl9wcml2LCBtYXN0ZXJfY3RsLCBndF9p
aXIpOwo+ID4gKwkJZ2VuOF9ndF9pcnFfaGFuZGxlcihpOTE1LCBtYXN0ZXJfY3RsLCBndF9paXIp
Owo+ID4gICAJCWlmIChob3RwbHVnX3N0YXR1cykKPiA+IC0JCQlpOXh4X2hwZF9pcnFfaGFuZGxl
cihkZXZfcHJpdiwgaG90cGx1Z19zdGF0dXMpOwo+ID4gKwkJCWk5eHhfaHBkX2lycV9oYW5kbGVy
KGk5MTUsIGhvdHBsdWdfc3RhdHVzKTsKPiA+IC0JCXZhbGxleXZpZXdfcGlwZXN0YXRfaXJxX2hh
bmRsZXIoZGV2X3ByaXYsIHBpcGVfc3RhdHMpOwo+ID4gKwkJdmFsbGV5dmlld19waXBlc3RhdF9p
cnFfaGFuZGxlcihpOTE1LCBwaXBlX3N0YXRzKTsKPiA+ICAgCX0gd2hpbGUgKDApOwo+ID4gLQll
bmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gPiArCWVuYWJsZV9ycG1fd2Fr
ZXJlZl9hc3NlcnRzKGk5MTUpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gLXN0YXRp
YyB2b2lkIGlieF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK3N0YXRpYyB2b2lkIGlieF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQl1MzIgaG90cGx1Z190cmlnZ2VyLAo+ID4gICAJCQkJ
Y29uc3QgdTMyIGhwZFtIUERfTlVNX1BJTlNdKQo+ID4gICB7Cj4gPiBAQCAtMjM2OCwxOSArMjM2
OCwxOSBAQCBzdGF0aWMgdm9pZCBpYnhfaHBkX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWlmICghaG90cGx1Z190cmlnZ2VyKQo+ID4gICAJCXJl
dHVybjsKPiA+IC0JaW50ZWxfZ2V0X2hwZF9waW5zKGRldl9wcml2LCAmcGluX21hc2ssICZsb25n
X21hc2ssIGhvdHBsdWdfdHJpZ2dlciwKPiA+ICsJaW50ZWxfZ2V0X2hwZF9waW5zKGk5MTUsICZw
aW5fbWFzaywgJmxvbmdfbWFzaywgaG90cGx1Z190cmlnZ2VyLAo+ID4gICAJCQkgICBkaWdfaG90
cGx1Z19yZWcsIGhwZCwKPiA+ICAgCQkJICAgcGNoX3BvcnRfaG90cGx1Z19sb25nX2RldGVjdCk7
Cj4gPiAtCWludGVsX2hwZF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGluX21hc2ssIGxvbmdfbWFz
ayk7Cj4gPiArCWludGVsX2hwZF9pcnFfaGFuZGxlcihpOTE1LCBwaW5fbWFzaywgbG9uZ19tYXNr
KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGlieF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwY2hfaWlyKQo+ID4gK3N0YXRpYyB2b2lkIGlieF9p
cnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIHBjaF9paXIpCj4g
PiAgIHsKPiA+ICAgCWludCBwaXBlOwo+ID4gICAJdTMyIGhvdHBsdWdfdHJpZ2dlciA9IHBjaF9p
aXIgJiBTREVfSE9UUExVR19NQVNLOwo+ID4gLQlpYnhfaHBkX2lycV9oYW5kbGVyKGRldl9wcml2
LCBob3RwbHVnX3RyaWdnZXIsIGhwZF9pYngpOwo+ID4gKwlpYnhfaHBkX2lycV9oYW5kbGVyKGk5
MTUsIGhvdHBsdWdfdHJpZ2dlciwgaHBkX2lieCk7Cj4gPiAgIAlpZiAocGNoX2lpciAmIFNERV9B
VURJT19QT1dFUl9NQVNLKSB7Cj4gPiAgIAkJaW50IHBvcnQgPSBmZnMoKHBjaF9paXIgJiBTREVf
QVVESU9fUE9XRVJfTUFTSykgPj4KPiA+IEBAIC0yMzkwLDEwICsyMzkwLDEwIEBAIHN0YXRpYyB2
b2lkIGlieF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUz
MiBwY2hfaWlyKQo+ID4gICAJfQo+ID4gICAJaWYgKHBjaF9paXIgJiBTREVfQVVYX01BU0spCj4g
PiAtCQlkcF9hdXhfaXJxX2hhbmRsZXIoZGV2X3ByaXYpOwo+ID4gKwkJZHBfYXV4X2lycV9oYW5k
bGVyKGk5MTUpOwo+ID4gICAJaWYgKHBjaF9paXIgJiBTREVfR01CVVMpCj4gPiAtCQlnbWJ1c19p
cnFfaGFuZGxlcihkZXZfcHJpdik7Cj4gPiArCQlnbWJ1c19pcnFfaGFuZGxlcihpOTE1KTsKPiA+
ICAgCWlmIChwY2hfaWlyICYgU0RFX0FVRElPX0hEQ1BfTUFTSykKPiA+ICAgCQlEUk1fREVCVUdf
RFJJVkVSKCJQQ0ggSERDUCBhdWRpbyBpbnRlcnJ1cHRcbiIpOwo+ID4gQEAgLTI0MDUsNyArMjQw
NSw3IEBAIHN0YXRpYyB2b2lkIGlieF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIHUzMiBwY2hfaWlyKQo+ID4gICAJCURSTV9FUlJPUigiUENIIHBvaXNvbiBp
bnRlcnJ1cHRcbiIpOwo+ID4gICAJaWYgKHBjaF9paXIgJiBTREVfRkRJX01BU0spCj4gPiAtCQlm
b3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKQo+ID4gKwkJZm9yX2VhY2hfcGlwZShpOTE1LCBw
aXBlKQo+ID4gICAJCQlEUk1fREVCVUdfRFJJVkVSKCIgIHBpcGUgJWMgRkRJIElJUjogMHglMDh4
XG4iLAo+ID4gICAJCQkJCSBwaXBlX25hbWUocGlwZSksCj4gPiAgIAkJCQkJIEk5MTVfUkVBRChG
RElfUlhfSUlSKHBpcGUpKSk7Cj4gPiBAQCAtMjQxNywxMyArMjQxNywxMyBAQCBzdGF0aWMgdm9p
ZCBpYnhfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIg
cGNoX2lpcikKPiA+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJQQ0ggdHJhbnNjb2RlciBDUkMgZXJy
b3IgaW50ZXJydXB0XG4iKTsKPiA+ICAgCWlmIChwY2hfaWlyICYgU0RFX1RSQU5TQV9GSUZPX1VO
REVSKQo+ID4gLQkJaW50ZWxfcGNoX2ZpZm9fdW5kZXJydW5faXJxX2hhbmRsZXIoZGV2X3ByaXYs
IFBJUEVfQSk7Cj4gPiArCQlpbnRlbF9wY2hfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihpOTE1
LCBQSVBFX0EpOwo+ID4gICAJaWYgKHBjaF9paXIgJiBTREVfVFJBTlNCX0ZJRk9fVU5ERVIpCj4g
PiAtCQlpbnRlbF9wY2hfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihkZXZfcHJpdiwgUElQRV9C
KTsKPiA+ICsJCWludGVsX3BjaF9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKGk5MTUsIFBJUEVf
Qik7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpdmJfZXJyX2ludF9oYW5kbGVyKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpdmJfZXJyX2ludF9o
YW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIg
ZXJyX2ludCA9IEk5MTVfUkVBRChHRU43X0VSUl9JTlQpOwo+ID4gICAJZW51bSBwaXBlIHBpcGU7
Cj4gPiBAQCAtMjQzMSwyMiArMjQzMSwyMiBAQCBzdGF0aWMgdm9pZCBpdmJfZXJyX2ludF9oYW5k
bGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCWlmIChlcnJfaW50
ICYgRVJSX0lOVF9QT0lTT04pCj4gPiAgIAkJRFJNX0VSUk9SKCJQb2lzb24gaW50ZXJydXB0XG4i
KTsKPiA+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ID4gKwlmb3JfZWFjaF9w
aXBlKGk5MTUsIHBpcGUpIHsKPiA+ICAgCQlpZiAoZXJyX2ludCAmIEVSUl9JTlRfRklGT19VTkRF
UlJVTihwaXBlKSkKPiA+IC0JCQlpbnRlbF9jcHVfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihk
ZXZfcHJpdiwgcGlwZSk7Cj4gPiArCQkJaW50ZWxfY3B1X2ZpZm9fdW5kZXJydW5faXJxX2hhbmRs
ZXIoaTkxNSwgcGlwZSk7Cj4gPiAgIAkJaWYgKGVycl9pbnQgJiBFUlJfSU5UX1BJUEVfQ1JDX0RP
TkUocGlwZSkpIHsKPiA+IC0JCQlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkKPiA+IC0JCQkJ
aXZiX3BpcGVfY3JjX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJCQlpZiAoSVNf
SVZZQlJJREdFKGk5MTUpKQo+ID4gKwkJCQlpdmJfcGlwZV9jcmNfaXJxX2hhbmRsZXIoaTkxNSwg
cGlwZSk7Cj4gPiAgIAkJCWVsc2UKPiA+IC0JCQkJaHN3X3BpcGVfY3JjX2lycV9oYW5kbGVyKGRl
dl9wcml2LCBwaXBlKTsKPiA+ICsJCQkJaHN3X3BpcGVfY3JjX2lycV9oYW5kbGVyKGk5MTUsIHBp
cGUpOwo+ID4gICAJCX0KPiA+ICAgCX0KPiA+ICAgCUk5MTVfV1JJVEUoR0VON19FUlJfSU5ULCBl
cnJfaW50KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGNwdF9zZXJyX2ludF9oYW5kbGVyKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBjcHRfc2Vy
cl9pbnRfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4g
ICAJdTMyIHNlcnJfaW50ID0gSTkxNV9SRUFEKFNFUlJfSU5UKTsKPiA+ICAgCWVudW0gcGlwZSBw
aXBlOwo+ID4gQEAgLTI0NTQsMTkgKzI0NTQsMTkgQEAgc3RhdGljIHZvaWQgY3B0X3NlcnJfaW50
X2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJaWYgKHNl
cnJfaW50ICYgU0VSUl9JTlRfUE9JU09OKQo+ID4gICAJCURSTV9FUlJPUigiUENIIHBvaXNvbiBp
bnRlcnJ1cHRcbiIpOwo+ID4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKQo+ID4gKwlm
b3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpCj4gPiAgIAkJaWYgKHNlcnJfaW50ICYgU0VSUl9JTlRf
VFJBTlNfRklGT19VTkRFUlJVTihwaXBlKSkKPiA+IC0JCQlpbnRlbF9wY2hfZmlmb191bmRlcnJ1
bl9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCQkJaW50ZWxfcGNoX2ZpZm9fdW5k
ZXJydW5faXJxX2hhbmRsZXIoaTkxNSwgcGlwZSk7Cj4gPiAgIAlJOTE1X1dSSVRFKFNFUlJfSU5U
LCBzZXJyX2ludCk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBjcHRfaXJxX2hhbmRsZXIoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcGNoX2lpcikKPiA+ICtzdGF0aWMg
dm9pZCBjcHRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBw
Y2hfaWlyKQo+ID4gICB7Cj4gPiAgIAlpbnQgcGlwZTsKPiA+ICAgCXUzMiBob3RwbHVnX3RyaWdn
ZXIgPSBwY2hfaWlyICYgU0RFX0hPVFBMVUdfTUFTS19DUFQ7Cj4gPiAtCWlieF9ocGRfaXJxX2hh
bmRsZXIoZGV2X3ByaXYsIGhvdHBsdWdfdHJpZ2dlciwgaHBkX2NwdCk7Cj4gPiArCWlieF9ocGRf
aXJxX2hhbmRsZXIoaTkxNSwgaG90cGx1Z190cmlnZ2VyLCBocGRfY3B0KTsKPiA+ICAgCWlmIChw
Y2hfaWlyICYgU0RFX0FVRElPX1BPV0VSX01BU0tfQ1BUKSB7Cj4gPiAgIAkJaW50IHBvcnQgPSBm
ZnMoKHBjaF9paXIgJiBTREVfQVVESU9fUE9XRVJfTUFTS19DUFQpID4+Cj4gPiBAQCAtMjQ3Niwx
MCArMjQ3NiwxMCBAQCBzdGF0aWMgdm9pZCBjcHRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcGNoX2lpcikKPiA+ICAgCX0KPiA+ICAgCWlmIChwY2hf
aWlyICYgU0RFX0FVWF9NQVNLX0NQVCkKPiA+IC0JCWRwX2F1eF9pcnFfaGFuZGxlcihkZXZfcHJp
dik7Cj4gPiArCQlkcF9hdXhfaXJxX2hhbmRsZXIoaTkxNSk7Cj4gPiAgIAlpZiAocGNoX2lpciAm
IFNERV9HTUJVU19DUFQpCj4gPiAtCQlnbWJ1c19pcnFfaGFuZGxlcihkZXZfcHJpdik7Cj4gPiAr
CQlnbWJ1c19pcnFfaGFuZGxlcihpOTE1KTsKPiA+ICAgCWlmIChwY2hfaWlyICYgU0RFX0FVRElP
X0NQX1JFUV9DUFQpCj4gPiAgIAkJRFJNX0RFQlVHX0RSSVZFUigiQXVkaW8gQ1AgcmVxdWVzdCBp
bnRlcnJ1cHRcbiIpOwo+ID4gQEAgLTI0ODgsMTYgKzI0ODgsMTYgQEAgc3RhdGljIHZvaWQgY3B0
X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHBjaF9p
aXIpCj4gPiAgIAkJRFJNX0RFQlVHX0RSSVZFUigiQXVkaW8gQ1AgY2hhbmdlIGludGVycnVwdFxu
Iik7Cj4gPiAgIAlpZiAocGNoX2lpciAmIFNERV9GRElfTUFTS19DUFQpCj4gPiAtCQlmb3JfZWFj
aF9waXBlKGRldl9wcml2LCBwaXBlKQo+ID4gKwkJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+
ID4gICAJCQlEUk1fREVCVUdfRFJJVkVSKCIgIHBpcGUgJWMgRkRJIElJUjogMHglMDh4XG4iLAo+
ID4gICAJCQkJCSBwaXBlX25hbWUocGlwZSksCj4gPiAgIAkJCQkJIEk5MTVfUkVBRChGRElfUlhf
SUlSKHBpcGUpKSk7Cj4gPiAgIAlpZiAocGNoX2lpciAmIFNERV9FUlJPUl9DUFQpCj4gPiAtCQlj
cHRfc2Vycl9pbnRfaGFuZGxlcihkZXZfcHJpdik7Cj4gPiArCQljcHRfc2Vycl9pbnRfaGFuZGxl
cihpOTE1KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGljcF9pcnFfaGFuZGxlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwY2hfaWlyKQo+ID4gK3N0YXRpYyB2b2lk
IGljcF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIHBjaF9p
aXIpCj4gPiAgIHsKPiA+ICAgCXUzMiBkZGlfaG90cGx1Z190cmlnZ2VyID0gcGNoX2lpciAmIFNE
RV9ERElfTUFTS19JQ1A7Cj4gPiAgIAl1MzIgdGNfaG90cGx1Z190cmlnZ2VyID0gcGNoX2lpciAm
IFNERV9UQ19NQVNLX0lDUDsKPiA+IEBAIC0yNTA5LDcgKzI1MDksNyBAQCBzdGF0aWMgdm9pZCBp
Y3BfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcGNo
X2lpcikKPiA+ICAgCQlkaWdfaG90cGx1Z19yZWcgPSBJOTE1X1JFQUQoU0hPVFBMVUdfQ1RMX0RE
SSk7Cj4gPiAgIAkJSTkxNV9XUklURShTSE9UUExVR19DVExfRERJLCBkaWdfaG90cGx1Z19yZWcp
Owo+ID4gLQkJaW50ZWxfZ2V0X2hwZF9waW5zKGRldl9wcml2LCAmcGluX21hc2ssICZsb25nX21h
c2ssCj4gPiArCQlpbnRlbF9nZXRfaHBkX3BpbnMoaTkxNSwgJnBpbl9tYXNrLCAmbG9uZ19tYXNr
LAo+ID4gICAJCQkJICAgZGRpX2hvdHBsdWdfdHJpZ2dlciwKPiA+ICAgCQkJCSAgIGRpZ19ob3Rw
bHVnX3JlZywgaHBkX2ljcCwKPiA+ICAgCQkJCSAgIGljcF9kZGlfcG9ydF9ob3RwbHVnX2xvbmdf
ZGV0ZWN0KTsKPiA+IEBAIC0yNTIxLDIwICsyNTIxLDIwIEBAIHN0YXRpYyB2b2lkIGljcF9pcnFf
aGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwY2hfaWlyKQo+
ID4gICAJCWRpZ19ob3RwbHVnX3JlZyA9IEk5MTVfUkVBRChTSE9UUExVR19DVExfVEMpOwo+ID4g
ICAJCUk5MTVfV1JJVEUoU0hPVFBMVUdfQ1RMX1RDLCBkaWdfaG90cGx1Z19yZWcpOwo+ID4gLQkJ
aW50ZWxfZ2V0X2hwZF9waW5zKGRldl9wcml2LCAmcGluX21hc2ssICZsb25nX21hc2ssCj4gPiAr
CQlpbnRlbF9nZXRfaHBkX3BpbnMoaTkxNSwgJnBpbl9tYXNrLCAmbG9uZ19tYXNrLAo+ID4gICAJ
CQkJICAgdGNfaG90cGx1Z190cmlnZ2VyLAo+ID4gICAJCQkJICAgZGlnX2hvdHBsdWdfcmVnLCBo
cGRfaWNwLAo+ID4gICAJCQkJICAgaWNwX3RjX3BvcnRfaG90cGx1Z19sb25nX2RldGVjdCk7Cj4g
PiAgIAl9Cj4gPiAgIAlpZiAocGluX21hc2spCj4gPiAtCQlpbnRlbF9ocGRfaXJxX2hhbmRsZXIo
ZGV2X3ByaXYsIHBpbl9tYXNrLCBsb25nX21hc2spOwo+ID4gKwkJaW50ZWxfaHBkX2lycV9oYW5k
bGVyKGk5MTUsIHBpbl9tYXNrLCBsb25nX21hc2spOwo+ID4gICAJaWYgKHBjaF9paXIgJiBTREVf
R01CVVNfSUNQKQo+ID4gLQkJZ21idXNfaXJxX2hhbmRsZXIoZGV2X3ByaXYpOwo+ID4gKwkJZ21i
dXNfaXJxX2hhbmRsZXIoaTkxNSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBzcHRfaXJxX2hh
bmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcGNoX2lpcikKPiA+
ICtzdGF0aWMgdm9pZCBzcHRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsIHUzMiBwY2hfaWlyKQo+ID4gICB7Cj4gPiAgIAl1MzIgaG90cGx1Z190cmlnZ2VyID0gcGNo
X2lpciAmIFNERV9IT1RQTFVHX01BU0tfU1BUICYKPiA+ICAgCQl+U0RFX1BPUlRFX0hPVFBMVUdf
U1BUOwo+ID4gQEAgLTI1NDcsNyArMjU0Nyw3IEBAIHN0YXRpYyB2b2lkIHNwdF9pcnFfaGFuZGxl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwY2hfaWlyKQo+ID4gICAJ
CWRpZ19ob3RwbHVnX3JlZyA9IEk5MTVfUkVBRChQQ0hfUE9SVF9IT1RQTFVHKTsKPiA+ICAgCQlJ
OTE1X1dSSVRFKFBDSF9QT1JUX0hPVFBMVUcsIGRpZ19ob3RwbHVnX3JlZyk7Cj4gPiAtCQlpbnRl
bF9nZXRfaHBkX3BpbnMoZGV2X3ByaXYsICZwaW5fbWFzaywgJmxvbmdfbWFzaywKPiA+ICsJCWlu
dGVsX2dldF9ocGRfcGlucyhpOTE1LCAmcGluX21hc2ssICZsb25nX21hc2ssCj4gPiAgIAkJCQkg
ICBob3RwbHVnX3RyaWdnZXIsIGRpZ19ob3RwbHVnX3JlZywgaHBkX3NwdCwKPiA+ICAgCQkJCSAg
IHNwdF9wb3J0X2hvdHBsdWdfbG9uZ19kZXRlY3QpOwo+ID4gICAJfQo+ID4gQEAgLTI1NTgsMTkg
KzI1NTgsMTkgQEAgc3RhdGljIHZvaWQgc3B0X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgdTMyIHBjaF9paXIpCj4gPiAgIAkJZGlnX2hvdHBsdWdfcmVnID0g
STkxNV9SRUFEKFBDSF9QT1JUX0hPVFBMVUcyKTsKPiA+ICAgCQlJOTE1X1dSSVRFKFBDSF9QT1JU
X0hPVFBMVUcyLCBkaWdfaG90cGx1Z19yZWcpOwo+ID4gLQkJaW50ZWxfZ2V0X2hwZF9waW5zKGRl
dl9wcml2LCAmcGluX21hc2ssICZsb25nX21hc2ssCj4gPiArCQlpbnRlbF9nZXRfaHBkX3BpbnMo
aTkxNSwgJnBpbl9tYXNrLCAmbG9uZ19tYXNrLAo+ID4gICAJCQkJICAgaG90cGx1ZzJfdHJpZ2dl
ciwgZGlnX2hvdHBsdWdfcmVnLCBocGRfc3B0LAo+ID4gICAJCQkJICAgc3B0X3BvcnRfaG90cGx1
ZzJfbG9uZ19kZXRlY3QpOwo+ID4gICAJfQo+ID4gICAJaWYgKHBpbl9tYXNrKQo+ID4gLQkJaW50
ZWxfaHBkX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaW5fbWFzaywgbG9uZ19tYXNrKTsKPiA+ICsJ
CWludGVsX2hwZF9pcnFfaGFuZGxlcihpOTE1LCBwaW5fbWFzaywgbG9uZ19tYXNrKTsKPiA+ICAg
CWlmIChwY2hfaWlyICYgU0RFX0dNQlVTX0NQVCkKPiA+IC0JCWdtYnVzX2lycV9oYW5kbGVyKGRl
dl9wcml2KTsKPiA+ICsJCWdtYnVzX2lycV9oYW5kbGVyKGk5MTUpOwo+ID4gICB9Cj4gPiAtc3Rh
dGljIHZvaWQgaWxrX2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaWxrX2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCXUzMiBob3RwbHVnX3RyaWdnZXIsCj4gPiAgIAkJ
CQljb25zdCB1MzIgaHBkW0hQRF9OVU1fUElOU10pCj4gPiAgIHsKPiA+IEBAIC0yNTc5LDk0ICsy
NTc5LDk0IEBAIHN0YXRpYyB2b2lkIGlsa19ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJZGlnX2hvdHBsdWdfcmVnID0gSTkxNV9SRUFEKERJ
R0lUQUxfUE9SVF9IT1RQTFVHX0NOVFJMKTsKPiA+ICAgCUk5MTVfV1JJVEUoRElHSVRBTF9QT1JU
X0hPVFBMVUdfQ05UUkwsIGRpZ19ob3RwbHVnX3JlZyk7Cj4gPiAtCWludGVsX2dldF9ocGRfcGlu
cyhkZXZfcHJpdiwgJnBpbl9tYXNrLCAmbG9uZ19tYXNrLCBob3RwbHVnX3RyaWdnZXIsCj4gPiAr
CWludGVsX2dldF9ocGRfcGlucyhpOTE1LCAmcGluX21hc2ssICZsb25nX21hc2ssIGhvdHBsdWdf
dHJpZ2dlciwKPiA+ICAgCQkJICAgZGlnX2hvdHBsdWdfcmVnLCBocGQsCj4gPiAgIAkJCSAgIGls
a19wb3J0X2hvdHBsdWdfbG9uZ19kZXRlY3QpOwo+ID4gLQlpbnRlbF9ocGRfaXJxX2hhbmRsZXIo
ZGV2X3ByaXYsIHBpbl9tYXNrLCBsb25nX21hc2spOwo+ID4gKwlpbnRlbF9ocGRfaXJxX2hhbmRs
ZXIoaTkxNSwgcGluX21hc2ssIGxvbmdfbWFzayk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBp
bGtfZGlzcGxheV9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiArc3RhdGljIHZvaWQgaWxrX2Rpc3BsYXlfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgdTMyIGRlX2lpcikKPiA+ICAgewo+ID4gICAJ
ZW51bSBwaXBlIHBpcGU7Cj4gPiAgIAl1MzIgaG90cGx1Z190cmlnZ2VyID0gZGVfaWlyICYgREVf
RFBfQV9IT1RQTFVHOwo+ID4gICAJaWYgKGhvdHBsdWdfdHJpZ2dlcikKPiA+IC0JCWlsa19ocGRf
aXJxX2hhbmRsZXIoZGV2X3ByaXYsIGhvdHBsdWdfdHJpZ2dlciwgaHBkX2lsayk7Cj4gPiArCQlp
bGtfaHBkX2lycV9oYW5kbGVyKGk5MTUsIGhvdHBsdWdfdHJpZ2dlciwgaHBkX2lsayk7Cj4gPiAg
IAlpZiAoZGVfaWlyICYgREVfQVVYX0NIQU5ORUxfQSkKPiA+IC0JCWRwX2F1eF9pcnFfaGFuZGxl
cihkZXZfcHJpdik7Cj4gPiArCQlkcF9hdXhfaXJxX2hhbmRsZXIoaTkxNSk7Cj4gPiAgIAlpZiAo
ZGVfaWlyICYgREVfR1NFKQo+ID4gLQkJaW50ZWxfb3ByZWdpb25fYXNsZV9pbnRyKGRldl9wcml2
KTsKPiA+ICsJCWludGVsX29wcmVnaW9uX2FzbGVfaW50cihpOTE1KTsKPiA+ICAgCWlmIChkZV9p
aXIgJiBERV9QT0lTT04pCj4gPiAgIAkJRFJNX0VSUk9SKCJQb2lzb24gaW50ZXJydXB0XG4iKTsK
PiA+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ID4gKwlmb3JfZWFjaF9waXBl
KGk5MTUsIHBpcGUpIHsKPiA+ICAgCQlpZiAoZGVfaWlyICYgREVfUElQRV9WQkxBTksocGlwZSkp
Cj4gPiAtCQkJZHJtX2hhbmRsZV92YmxhbmsoJmRldl9wcml2LT5kcm0sIHBpcGUpOwo+ID4gKwkJ
CWRybV9oYW5kbGVfdmJsYW5rKCZpOTE1LT5kcm0sIHBpcGUpOwo+ID4gICAJCWlmIChkZV9paXIg
JiBERV9QSVBFX0ZJRk9fVU5ERVJSVU4ocGlwZSkpCj4gPiAtCQkJaW50ZWxfY3B1X2ZpZm9fdW5k
ZXJydW5faXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwkJCWludGVsX2NwdV9maWZv
X3VuZGVycnVuX2lycV9oYW5kbGVyKGk5MTUsIHBpcGUpOwo+ID4gICAJCWlmIChkZV9paXIgJiBE
RV9QSVBFX0NSQ19ET05FKHBpcGUpKQo+ID4gLQkJCWk5eHhfcGlwZV9jcmNfaXJxX2hhbmRsZXIo
ZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwkJCWk5eHhfcGlwZV9jcmNfaXJxX2hhbmRsZXIoaTkxNSwg
cGlwZSk7Cj4gPiAgIAl9Cj4gPiAgIAkvKiBjaGVjayBldmVudCBmcm9tIFBDSCAqLwo+ID4gICAJ
aWYgKGRlX2lpciAmIERFX1BDSF9FVkVOVCkgewo+ID4gICAJCXUzMiBwY2hfaWlyID0gSTkxNV9S
RUFEKFNERUlJUik7Cj4gPiAtCQlpZiAoSEFTX1BDSF9DUFQoZGV2X3ByaXYpKQo+ID4gLQkJCWNw
dF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcGNoX2lpcik7Cj4gPiArCQlpZiAoSEFTX1BDSF9DUFQo
aTkxNSkpCj4gPiArCQkJY3B0X2lycV9oYW5kbGVyKGk5MTUsIHBjaF9paXIpOwo+ID4gICAJCWVs
c2UKPiA+IC0JCQlpYnhfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBjaF9paXIpOwo+ID4gKwkJCWli
eF9pcnFfaGFuZGxlcihpOTE1LCBwY2hfaWlyKTsKPiA+ICAgCQkvKiBzaG91bGQgY2xlYXIgUENI
IGhvdHBsdWcgZXZlbnQgYmVmb3JlIGNsZWFyIENQVSBpcnEgKi8KPiA+ICAgCQlJOTE1X1dSSVRF
KFNERUlJUiwgcGNoX2lpcik7Cj4gPiAgIAl9Cj4gPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDUp
ICYmIGRlX2lpciAmIERFX1BDVV9FVkVOVCkKPiA+IC0JCWlyb25sYWtlX3Jwc19jaGFuZ2VfaXJx
X2hhbmRsZXIoZGV2X3ByaXYpOwo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDUpICYmIGRlX2lpciAm
IERFX1BDVV9FVkVOVCkKPiA+ICsJCWlyb25sYWtlX3Jwc19jaGFuZ2VfaXJxX2hhbmRsZXIoaTkx
NSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpdmJfZGlzcGxheV9pcnFfaGFuZGxlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaXZiX2Rpc3Bs
YXlfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkg
ICAgdTMyIGRlX2lpcikKPiA+ICAgewo+ID4gICAJZW51bSBwaXBlIHBpcGU7Cj4gPiAgIAl1MzIg
aG90cGx1Z190cmlnZ2VyID0gZGVfaWlyICYgREVfRFBfQV9IT1RQTFVHX0lWQjsKPiA+ICAgCWlm
IChob3RwbHVnX3RyaWdnZXIpCj4gPiAtCQlpbGtfaHBkX2lycV9oYW5kbGVyKGRldl9wcml2LCBo
b3RwbHVnX3RyaWdnZXIsIGhwZF9pdmIpOwo+ID4gKwkJaWxrX2hwZF9pcnFfaGFuZGxlcihpOTE1
LCBob3RwbHVnX3RyaWdnZXIsIGhwZF9pdmIpOwo+ID4gICAJaWYgKGRlX2lpciAmIERFX0VSUl9J
TlRfSVZCKQo+ID4gLQkJaXZiX2Vycl9pbnRfaGFuZGxlcihkZXZfcHJpdik7Cj4gPiArCQlpdmJf
ZXJyX2ludF9oYW5kbGVyKGk5MTUpOwo+ID4gICAJaWYgKGRlX2lpciAmIERFX0VEUF9QU1JfSU5U
X0hTVykgewo+ID4gICAJCXUzMiBwc3JfaWlyID0gSTkxNV9SRUFEKEVEUF9QU1JfSUlSKTsKPiA+
IC0JCWludGVsX3Bzcl9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcHNyX2lpcik7Cj4gPiArCQlpbnRl
bF9wc3JfaXJxX2hhbmRsZXIoaTkxNSwgcHNyX2lpcik7Cj4gPiAgIAkJSTkxNV9XUklURShFRFBf
UFNSX0lJUiwgcHNyX2lpcik7Cj4gPiAgIAl9Cj4gPiAgIAlpZiAoZGVfaWlyICYgREVfQVVYX0NI
QU5ORUxfQV9JVkIpCj4gPiAtCQlkcF9hdXhfaXJxX2hhbmRsZXIoZGV2X3ByaXYpOwo+ID4gKwkJ
ZHBfYXV4X2lycV9oYW5kbGVyKGk5MTUpOwo+ID4gICAJaWYgKGRlX2lpciAmIERFX0dTRV9JVkIp
Cj4gPiAtCQlpbnRlbF9vcHJlZ2lvbl9hc2xlX2ludHIoZGV2X3ByaXYpOwo+ID4gKwkJaW50ZWxf
b3ByZWdpb25fYXNsZV9pbnRyKGk5MTUpOwo+ID4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBw
aXBlKSB7Cj4gPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ID4gICAJCWlmIChkZV9p
aXIgJiAoREVfUElQRV9WQkxBTktfSVZCKHBpcGUpKSkKPiA+IC0JCQlkcm1faGFuZGxlX3ZibGFu
aygmZGV2X3ByaXYtPmRybSwgcGlwZSk7Cj4gPiArCQkJZHJtX2hhbmRsZV92YmxhbmsoJmk5MTUt
PmRybSwgcGlwZSk7Cj4gPiAgIAl9Cj4gPiAgIAkvKiBjaGVjayBldmVudCBmcm9tIFBDSCAqLwo+
ID4gLQlpZiAoIUhBU19QQ0hfTk9QKGRldl9wcml2KSAmJiAoZGVfaWlyICYgREVfUENIX0VWRU5U
X0lWQikpIHsKPiA+ICsJaWYgKCFIQVNfUENIX05PUChpOTE1KSAmJiAoZGVfaWlyICYgREVfUENI
X0VWRU5UX0lWQikpIHsKPiA+ICAgCQl1MzIgcGNoX2lpciA9IEk5MTVfUkVBRChTREVJSVIpOwo+
ID4gLQkJY3B0X2lycV9oYW5kbGVyKGRldl9wcml2LCBwY2hfaWlyKTsKPiA+ICsJCWNwdF9pcnFf
aGFuZGxlcihpOTE1LCBwY2hfaWlyKTsKPiA+ICAgCQkvKiBjbGVhciBQQ0ggaG90cGx1ZyBldmVu
dCBiZWZvcmUgY2xlYXIgQ1BVIGlycSAqLwo+ID4gICAJCUk5MTVfV1JJVEUoU0RFSUlSLCBwY2hf
aWlyKTsKPiA+IEBAIC0yNjg0LDE1ICsyNjg0LDE1IEBAIHN0YXRpYyB2b2lkIGl2Yl9kaXNwbGF5
X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgc3Rh
dGljIGlycXJldHVybl90IGlyb25sYWtlX2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykK
PiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGFyZzsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXUzMiBkZV9paXIs
IGd0X2lpciwgZGVfaWVyLCBzZGVfaWVyID0gMDsKPiA+ICAgCWlycXJldHVybl90IHJldCA9IElS
UV9OT05FOwo+ID4gLQlpZiAoIWludGVsX2lycXNfZW5hYmxlZChkZXZfcHJpdikpCj4gPiArCWlm
ICghaW50ZWxfaXJxc19lbmFibGVkKGk5MTUpKQo+ID4gICAJCXJldHVybiBJUlFfTk9ORTsKPiA+
ICAgCS8qIElSUXMgYXJlIHN5bmNlZCBkdXJpbmcgcnVudGltZV9zdXNwZW5kLCB3ZSBkb24ndCBy
ZXF1aXJlIGEgd2FrZXJlZiAqLwo+ID4gLQlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2
X3ByaXYpOwo+ID4gKwlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoaTkxNSk7Cj4gPiAgIAkv
KiBkaXNhYmxlIG1hc3RlciBpbnRlcnJ1cHQgYmVmb3JlIGNsZWFyaW5nIGlpciAgKi8KPiA+ICAg
CWRlX2llciA9IEk5MTVfUkVBRChERUlFUik7Cj4gPiBAQCAtMjcwMyw3ICsyNzAzLDcgQEAgc3Rh
dGljIGlycXJldHVybl90IGlyb25sYWtlX2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykK
PiA+ICAgCSAqIGFibGUgdG8gcHJvY2VzcyB0aGVtIGFmdGVyIHdlIHJlc3RvcmUgU0RFSUVSIChh
cyBzb29uIGFzIHdlIHJlc3RvcmUKPiA+ICAgCSAqIGl0LCB3ZSdsbCBnZXQgYW4gaW50ZXJydXB0
IGlmIFNERUlJUiBzdGlsbCBoYXMgc29tZXRoaW5nIHRvIHByb2Nlc3MKPiA+ICAgCSAqIGR1ZSB0
byBpdHMgYmFjayBxdWV1ZSkuICovCj4gPiAtCWlmICghSEFTX1BDSF9OT1AoZGV2X3ByaXYpKSB7
Cj4gPiArCWlmICghSEFTX1BDSF9OT1AoaTkxNSkpIHsKPiA+ICAgCQlzZGVfaWVyID0gSTkxNV9S
RUFEKFNERUlFUik7Cj4gPiAgIAkJSTkxNV9XUklURShTREVJRVIsIDApOwo+ID4gICAJfQo+ID4g
QEAgLTI3MTQsNDIgKzI3MTQsNDIgQEAgc3RhdGljIGlycXJldHVybl90IGlyb25sYWtlX2lycV9o
YW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykKPiA+ICAgCWlmIChndF9paXIpIHsKPiA+ICAgCQlJ
OTE1X1dSSVRFKEdUSUlSLCBndF9paXIpOwo+ID4gICAJCXJldCA9IElSUV9IQU5ETEVEOwo+ID4g
LQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikKPiA+IC0JCQlzbmJfZ3RfaXJxX2hhbmRs
ZXIoZGV2X3ByaXYsIGd0X2lpcik7Cj4gPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCj4g
PiArCQkJc25iX2d0X2lycV9oYW5kbGVyKGk5MTUsIGd0X2lpcik7Cj4gPiAgIAkJZWxzZQo+ID4g
LQkJCWlsa19ndF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgZ3RfaWlyKTsKPiA+ICsJCQlpbGtfZ3Rf
aXJxX2hhbmRsZXIoaTkxNSwgZ3RfaWlyKTsKPiA+ICAgCX0KPiA+ICAgCWRlX2lpciA9IEk5MTVf
UkVBRChERUlJUik7Cj4gPiAgIAlpZiAoZGVfaWlyKSB7Cj4gPiAgIAkJSTkxNV9XUklURShERUlJ
UiwgZGVfaWlyKTsKPiA+ICAgCQlyZXQgPSBJUlFfSEFORExFRDsKPiA+IC0JCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDcpCj4gPiAtCQkJaXZiX2Rpc3BsYXlfaXJxX2hhbmRsZXIoZGV2X3By
aXYsIGRlX2lpcik7Cj4gPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDcpCj4gPiArCQkJaXZi
X2Rpc3BsYXlfaXJxX2hhbmRsZXIoaTkxNSwgZGVfaWlyKTsKPiA+ICAgCQllbHNlCj4gPiAtCQkJ
aWxrX2Rpc3BsYXlfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIGRlX2lpcik7Cj4gPiArCQkJaWxrX2Rp
c3BsYXlfaXJxX2hhbmRsZXIoaTkxNSwgZGVfaWlyKTsKPiA+ICAgCX0KPiA+IC0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gNikgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpIHsK
PiA+ICAgCQl1MzIgcG1faWlyID0gSTkxNV9SRUFEKEdFTjZfUE1JSVIpOwo+ID4gICAJCWlmIChw
bV9paXIpIHsKPiA+ICAgCQkJSTkxNV9XUklURShHRU42X1BNSUlSLCBwbV9paXIpOwo+ID4gICAJ
CQlyZXQgPSBJUlFfSEFORExFRDsKPiA+IC0JCQlnZW42X3Jwc19pcnFfaGFuZGxlcihkZXZfcHJp
diwgcG1faWlyKTsKPiA+ICsJCQlnZW42X3Jwc19pcnFfaGFuZGxlcihpOTE1LCBwbV9paXIpOwo+
ID4gICAJCX0KPiA+ICAgCX0KPiA+ICAgCUk5MTVfV1JJVEUoREVJRVIsIGRlX2llcik7Cj4gPiAt
CWlmICghSEFTX1BDSF9OT1AoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19QQ0hfTk9QKGk5MTUp
KQo+ID4gICAJCUk5MTVfV1JJVEUoU0RFSUVSLCBzZGVfaWVyKTsKPiA+ICAgCS8qIElSUXMgYXJl
IHN5bmNlZCBkdXJpbmcgcnVudGltZV9zdXNwZW5kLCB3ZSBkb24ndCByZXF1aXJlIGEgd2FrZXJl
ZiAqLwo+ID4gLQllbmFibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gPiArCWVu
YWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAg
fQo+ID4gLXN0YXRpYyB2b2lkIGJ4dF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGJ4dF9ocGRfaXJxX2hhbmRsZXIoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQl1MzIgaG90cGx1Z190cmlnZ2Vy
LAo+ID4gICAJCQkJY29uc3QgdTMyIGhwZFtIUERfTlVNX1BJTlNdKQo+ID4gICB7Cj4gPiBAQCAt
Mjc1OCwxNCArMjc1OCwxNCBAQCBzdGF0aWMgdm9pZCBieHRfaHBkX2lycV9oYW5kbGVyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWRpZ19ob3RwbHVnX3JlZyA9IEk5
MTVfUkVBRChQQ0hfUE9SVF9IT1RQTFVHKTsKPiA+ICAgCUk5MTVfV1JJVEUoUENIX1BPUlRfSE9U
UExVRywgZGlnX2hvdHBsdWdfcmVnKTsKPiA+IC0JaW50ZWxfZ2V0X2hwZF9waW5zKGRldl9wcml2
LCAmcGluX21hc2ssICZsb25nX21hc2ssIGhvdHBsdWdfdHJpZ2dlciwKPiA+ICsJaW50ZWxfZ2V0
X2hwZF9waW5zKGk5MTUsICZwaW5fbWFzaywgJmxvbmdfbWFzaywgaG90cGx1Z190cmlnZ2VyLAo+
ID4gICAJCQkgICBkaWdfaG90cGx1Z19yZWcsIGhwZCwKPiA+ICAgCQkJICAgYnh0X3BvcnRfaG90
cGx1Z19sb25nX2RldGVjdCk7Cj4gPiAtCWludGVsX2hwZF9pcnFfaGFuZGxlcihkZXZfcHJpdiwg
cGluX21hc2ssIGxvbmdfbWFzayk7Cj4gPiArCWludGVsX2hwZF9pcnFfaGFuZGxlcihpOTE1LCBw
aW5fbWFzaywgbG9uZ19tYXNrKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGdlbjExX2hwZF9p
cnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBpaXIpCj4g
PiArc3RhdGljIHZvaWQgZ2VuMTFfaHBkX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCB1MzIgaWlyKQo+ID4gICB7Cj4gPiAgIAl1MzIgcGluX21hc2sgPSAwLCBsb25n
X21hc2sgPSAwOwo+ID4gICAJdTMyIHRyaWdnZXJfdGMgPSBpaXIgJiBHRU4xMV9ERV9UQ19IT1RQ
TFVHX01BU0s7Cj4gPiBAQCAtMjc3Nyw3ICsyNzc3LDcgQEAgc3RhdGljIHZvaWQgZ2VuMTFfaHBk
X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGlpcikK
PiA+ICAgCQlkaWdfaG90cGx1Z19yZWcgPSBJOTE1X1JFQUQoR0VOMTFfVENfSE9UUExVR19DVEwp
Owo+ID4gICAJCUk5MTVfV1JJVEUoR0VOMTFfVENfSE9UUExVR19DVEwsIGRpZ19ob3RwbHVnX3Jl
Zyk7Cj4gPiAtCQlpbnRlbF9nZXRfaHBkX3BpbnMoZGV2X3ByaXYsICZwaW5fbWFzaywgJmxvbmdf
bWFzaywgdHJpZ2dlcl90YywKPiA+ICsJCWludGVsX2dldF9ocGRfcGlucyhpOTE1LCAmcGluX21h
c2ssICZsb25nX21hc2ssIHRyaWdnZXJfdGMsCj4gPiAgIAkJCQkgICBkaWdfaG90cGx1Z19yZWcs
IGhwZF9nZW4xMSwKPiA+ICAgCQkJCSAgIGdlbjExX3BvcnRfaG90cGx1Z19sb25nX2RldGVjdCk7
Cj4gPiAgIAl9Cj4gPiBAQCAtMjc4OCwzMCArMjc4OCwzMCBAQCBzdGF0aWMgdm9pZCBnZW4xMV9o
cGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgaWly
KQo+ID4gICAJCWRpZ19ob3RwbHVnX3JlZyA9IEk5MTVfUkVBRChHRU4xMV9UQlRfSE9UUExVR19D
VEwpOwo+ID4gICAJCUk5MTVfV1JJVEUoR0VOMTFfVEJUX0hPVFBMVUdfQ1RMLCBkaWdfaG90cGx1
Z19yZWcpOwo+ID4gLQkJaW50ZWxfZ2V0X2hwZF9waW5zKGRldl9wcml2LCAmcGluX21hc2ssICZs
b25nX21hc2ssIHRyaWdnZXJfdGJ0LAo+ID4gKwkJaW50ZWxfZ2V0X2hwZF9waW5zKGk5MTUsICZw
aW5fbWFzaywgJmxvbmdfbWFzaywgdHJpZ2dlcl90YnQsCj4gPiAgIAkJCQkgICBkaWdfaG90cGx1
Z19yZWcsIGhwZF9nZW4xMSwKPiA+ICAgCQkJCSAgIGdlbjExX3BvcnRfaG90cGx1Z19sb25nX2Rl
dGVjdCk7Cj4gPiAgIAl9Cj4gPiAgIAlpZiAocGluX21hc2spCj4gPiAtCQlpbnRlbF9ocGRfaXJx
X2hhbmRsZXIoZGV2X3ByaXYsIHBpbl9tYXNrLCBsb25nX21hc2spOwo+ID4gKwkJaW50ZWxfaHBk
X2lycV9oYW5kbGVyKGk5MTUsIHBpbl9tYXNrLCBsb25nX21hc2spOwo+ID4gICAJZWxzZQo+ID4g
ICAJCURSTV9FUlJPUigiVW5leHBlY3RlZCBERSBIUEQgaW50ZXJydXB0IDB4JTA4eFxuIiwgaWly
KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB1MzIgZ2VuOF9kZV9wb3J0X2F1eF9tYXNrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdTMyIGdlbjhfZGVfcG9ydF9h
dXhfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMy
IG1hc2sgPSBHRU44X0FVWF9DSEFOTkVMX0E7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDkpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiA+ICAgCQltYXNrIHw9IEdF
TjlfQVVYX0NIQU5ORUxfQiB8Cj4gPiAgIAkJCUdFTjlfQVVYX0NIQU5ORUxfQyB8Cj4gPiAgIAkJ
CUdFTjlfQVVYX0NIQU5ORUxfRDsKPiA+IC0JaWYgKElTX0NOTF9XSVRIX1BPUlRfRihkZXZfcHJp
dikpCj4gPiArCWlmIChJU19DTkxfV0lUSF9QT1JUX0YoaTkxNSkpCj4gPiAgIAkJbWFzayB8PSBD
TkxfQVVYX0NIQU5ORUxfRjsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4g
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gPiAgIAkJbWFzayB8PSBJQ0xfQVVYX0NI
QU5ORUxfRSB8Cj4gPiAgIAkJCUNOTF9BVVhfQ0hBTk5FTF9GOwo+ID4gQEAgLTI4MTksNyArMjgx
OSw3IEBAIHN0YXRpYyB1MzIgZ2VuOF9kZV9wb3J0X2F1eF9tYXNrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICAgfQo+ID4gICBzdGF0aWMgaXJxcmV0dXJuX3QKPiA+IC1n
ZW44X2RlX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMy
IG1hc3Rlcl9jdGwpCj4gPiArZ2VuOF9kZV9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgdTMyIG1hc3Rlcl9jdGwpCj4gPiAgIHsKPiA+ICAgCWlycXJldHVybl90IHJl
dCA9IElSUV9OT05FOwo+ID4gICAJdTMyIGlpcjsKPiA+IEBAIC0yODM0LDE0ICsyODM0LDE0IEBA
IGdlbjhfZGVfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1
MzIgbWFzdGVyX2N0bCkKPiA+ICAgCQkJcmV0ID0gSVJRX0hBTkRMRUQ7Cj4gPiAgIAkJCWlmIChp
aXIgJiBHRU44X0RFX01JU0NfR1NFKSB7Cj4gPiAtCQkJCWludGVsX29wcmVnaW9uX2FzbGVfaW50
cihkZXZfcHJpdik7Cj4gPiArCQkJCWludGVsX29wcmVnaW9uX2FzbGVfaW50cihpOTE1KTsKPiA+
ICAgCQkJCWZvdW5kID0gdHJ1ZTsKPiA+ICAgCQkJfQo+ID4gICAJCQlpZiAoaWlyICYgR0VOOF9E
RV9FRFBfUFNSKSB7Cj4gPiAgIAkJCQl1MzIgcHNyX2lpciA9IEk5MTVfUkVBRChFRFBfUFNSX0lJ
Uik7Cj4gPiAtCQkJCWludGVsX3Bzcl9pcnFfaGFuZGxlcihkZXZfcHJpdiwgcHNyX2lpcik7Cj4g
PiArCQkJCWludGVsX3Bzcl9pcnFfaGFuZGxlcihpOTE1LCBwc3JfaWlyKTsKPiA+ICAgCQkJCUk5
MTVfV1JJVEUoRURQX1BTUl9JSVIsIHBzcl9paXIpOwo+ID4gICAJCQkJZm91bmQgPSB0cnVlOwo+
ID4gICAJCQl9Cj4gPiBAQCAtMjg1MywxMiArMjg1MywxMiBAQCBnZW44X2RlX2lycV9oYW5kbGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIG1hc3Rlcl9jdGwpCj4gPiAg
IAkJCURSTV9FUlJPUigiVGhlIG1hc3RlciBjb250cm9sIGludGVycnVwdCBsaWVkIChERSBNSVND
KSFcbiIpOwo+ID4gICAJfQo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSAmJiAo
bWFzdGVyX2N0bCAmIEdFTjExX0RFX0hQRF9JUlEpKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gMTEgJiYgKG1hc3Rlcl9jdGwgJiBHRU4xMV9ERV9IUERfSVJRKSkgewo+ID4gICAJCWlp
ciA9IEk5MTVfUkVBRChHRU4xMV9ERV9IUERfSUlSKTsKPiA+ICAgCQlpZiAoaWlyKSB7Cj4gPiAg
IAkJCUk5MTVfV1JJVEUoR0VOMTFfREVfSFBEX0lJUiwgaWlyKTsKPiA+ICAgCQkJcmV0ID0gSVJR
X0hBTkRMRUQ7Cj4gPiAtCQkJZ2VuMTFfaHBkX2lycV9oYW5kbGVyKGRldl9wcml2LCBpaXIpOwo+
ID4gKwkJCWdlbjExX2hwZF9pcnFfaGFuZGxlcihpOTE1LCBpaXIpOwo+ID4gICAJCX0gZWxzZSB7
Cj4gPiAgIAkJCURSTV9FUlJPUigiVGhlIG1hc3RlciBjb250cm9sIGludGVycnVwdCBsaWVkLCAo
REUgSFBEKSFcbiIpOwo+ID4gICAJCX0KPiA+IEBAIC0yODczLDI5ICsyODczLDI5IEBAIGdlbjhf
ZGVfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFz
dGVyX2N0bCkKPiA+ICAgCQkJSTkxNV9XUklURShHRU44X0RFX1BPUlRfSUlSLCBpaXIpOwo+ID4g
ICAJCQlyZXQgPSBJUlFfSEFORExFRDsKPiA+IC0JCQlpZiAoaWlyICYgZ2VuOF9kZV9wb3J0X2F1
eF9tYXNrKGRldl9wcml2KSkgewo+ID4gLQkJCQlkcF9hdXhfaXJxX2hhbmRsZXIoZGV2X3ByaXYp
Owo+ID4gKwkJCWlmIChpaXIgJiBnZW44X2RlX3BvcnRfYXV4X21hc2soaTkxNSkpIHsKPiA+ICsJ
CQkJZHBfYXV4X2lycV9oYW5kbGVyKGk5MTUpOwo+ID4gICAJCQkJZm91bmQgPSB0cnVlOwo+ID4g
ICAJCQl9Cj4gPiAtCQkJaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Cj4gPiArCQkJaWYgKElT
X0dFTjlfTFAoaTkxNSkpIHsKPiA+ICAgCQkJCXRtcF9tYXNrID0gaWlyICYgQlhUX0RFX1BPUlRf
SE9UUExVR19NQVNLOwo+ID4gICAJCQkJaWYgKHRtcF9tYXNrKSB7Cj4gPiAtCQkJCQlieHRfaHBk
X2lycV9oYW5kbGVyKGRldl9wcml2LCB0bXBfbWFzaywKPiA+ICsJCQkJCWJ4dF9ocGRfaXJxX2hh
bmRsZXIoaTkxNSwgdG1wX21hc2ssCj4gPiAgIAkJCQkJCQkgICAgaHBkX2J4dCk7Cj4gPiAgIAkJ
CQkJZm91bmQgPSB0cnVlOwo+ID4gICAJCQkJfQo+ID4gLQkJCX0gZWxzZSBpZiAoSVNfQlJPQURX
RUxMKGRldl9wcml2KSkgewo+ID4gKwkJCX0gZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpKSB7
Cj4gPiAgIAkJCQl0bXBfbWFzayA9IGlpciAmIEdFTjhfUE9SVF9EUF9BX0hPVFBMVUc7Cj4gPiAg
IAkJCQlpZiAodG1wX21hc2spIHsKPiA+IC0JCQkJCWlsa19ocGRfaXJxX2hhbmRsZXIoZGV2X3By
aXYsCj4gPiArCQkJCQlpbGtfaHBkX2lycV9oYW5kbGVyKGk5MTUsCj4gPiAgIAkJCQkJCQkgICAg
dG1wX21hc2ssIGhwZF9iZHcpOwo+ID4gICAJCQkJCWZvdW5kID0gdHJ1ZTsKPiA+ICAgCQkJCX0K
PiA+ICAgCQkJfQo+ID4gLQkJCWlmIChJU19HRU45X0xQKGRldl9wcml2KSAmJiAoaWlyICYgQlhU
X0RFX1BPUlRfR01CVVMpKSB7Cj4gPiAtCQkJCWdtYnVzX2lycV9oYW5kbGVyKGRldl9wcml2KTsK
PiA+ICsJCQlpZiAoSVNfR0VOOV9MUChpOTE1KSAmJiAoaWlyICYgQlhUX0RFX1BPUlRfR01CVVMp
KSB7Cj4gPiArCQkJCWdtYnVzX2lycV9oYW5kbGVyKGk5MTUpOwo+ID4gICAJCQkJZm91bmQgPSB0
cnVlOwo+ID4gICAJCQl9Cj4gPiBAQCAtMjkwNiw3ICsyOTA2LDcgQEAgZ2VuOF9kZV9pcnFfaGFu
ZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBtYXN0ZXJfY3RsKQo+
ID4gICAJCQlEUk1fRVJST1IoIlRoZSBtYXN0ZXIgY29udHJvbCBpbnRlcnJ1cHQgbGllZCAoREUg
UE9SVCkhXG4iKTsKPiA+ICAgCX0KPiA+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkg
ewo+ID4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpIHsKPiA+ICAgCQl1MzIgZmF1bHRfZXJy
b3JzOwo+ID4gICAJCWlmICghKG1hc3Rlcl9jdGwgJiBHRU44X0RFX1BJUEVfSVJRKHBpcGUpKSkK
PiA+IEBAIC0yOTIyLDE2ICsyOTIyLDE2IEBAIGdlbjhfZGVfaXJxX2hhbmRsZXIoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFzdGVyX2N0bCkKPiA+ICAgCQlJOTE1X1dS
SVRFKEdFTjhfREVfUElQRV9JSVIocGlwZSksIGlpcik7Cj4gPiAgIAkJaWYgKGlpciAmIEdFTjhf
UElQRV9WQkxBTkspCj4gPiAtCQkJZHJtX2hhbmRsZV92YmxhbmsoJmRldl9wcml2LT5kcm0sIHBp
cGUpOwo+ID4gKwkJCWRybV9oYW5kbGVfdmJsYW5rKCZpOTE1LT5kcm0sIHBpcGUpOwo+ID4gICAJ
CWlmIChpaXIgJiBHRU44X1BJUEVfQ0RDTEtfQ1JDX0RPTkUpCj4gPiAtCQkJaHN3X3BpcGVfY3Jj
X2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJCQloc3dfcGlwZV9jcmNfaXJxX2hh
bmRsZXIoaTkxNSwgcGlwZSk7Cj4gPiAgIAkJaWYgKGlpciAmIEdFTjhfUElQRV9GSUZPX1VOREVS
UlVOKQo+ID4gLQkJCWludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKGRldl9wcml2
LCBwaXBlKTsKPiA+ICsJCQlpbnRlbF9jcHVfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihpOTE1
LCBwaXBlKTsKPiA+ICAgCQlmYXVsdF9lcnJvcnMgPSBpaXI7Cj4gPiAtCQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA5KQo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gICAJ
CQlmYXVsdF9lcnJvcnMgJj0gR0VOOV9ERV9QSVBFX0lSUV9GQVVMVF9FUlJPUlM7Cj4gPiAgIAkJ
ZWxzZQo+ID4gICAJCQlmYXVsdF9lcnJvcnMgJj0gR0VOOF9ERV9QSVBFX0lSUV9GQVVMVF9FUlJP
UlM7Cj4gPiBAQCAtMjk0Miw3ICsyOTQyLDcgQEAgZ2VuOF9kZV9pcnFfaGFuZGxlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBtYXN0ZXJfY3RsKQo+ID4gICAJCQkJICBm
YXVsdF9lcnJvcnMpOwo+ID4gICAJfQo+ID4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikg
JiYgIUhBU19QQ0hfTk9QKGRldl9wcml2KSAmJgo+ID4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1
KSAmJiAhSEFTX1BDSF9OT1AoaTkxNSkgJiYKPiA+ICAgCSAgICBtYXN0ZXJfY3RsICYgR0VOOF9E
RV9QQ0hfSVJRKSB7Cj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBGSVhNRShCRFcpOiBBc3N1bWUgZm9y
IG5vdyB0aGF0IHRoZSBuZXcgaW50ZXJydXB0IGhhbmRsaW5nCj4gPiBAQCAtMjk1NCwxMiArMjk1
NCwxMiBAQCBnZW44X2RlX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgdTMyIG1hc3Rlcl9jdGwpCj4gPiAgIAkJCUk5MTVfV1JJVEUoU0RFSUlSLCBpaXIpOwo+
ID4gICAJCQlyZXQgPSBJUlFfSEFORExFRDsKPiA+IC0JCQlpZiAoSU5URUxfUENIX1RZUEUoZGV2
X3ByaXYpID49IFBDSF9JQ1ApCj4gPiAtCQkJCWljcF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgaWly
KTsKPiA+IC0JCQllbHNlIGlmIChJTlRFTF9QQ0hfVFlQRShkZXZfcHJpdikgPj0gUENIX1NQVCkK
PiA+IC0JCQkJc3B0X2lycV9oYW5kbGVyKGRldl9wcml2LCBpaXIpOwo+ID4gKwkJCWlmIChJTlRF
TF9QQ0hfVFlQRShpOTE1KSA+PSBQQ0hfSUNQKQo+ID4gKwkJCQlpY3BfaXJxX2hhbmRsZXIoaTkx
NSwgaWlyKTsKPiA+ICsJCQllbHNlIGlmIChJTlRFTF9QQ0hfVFlQRShpOTE1KSA+PSBQQ0hfU1BU
KQo+ID4gKwkJCQlzcHRfaXJxX2hhbmRsZXIoaTkxNSwgaWlyKTsKPiA+ICAgCQkJZWxzZQo+ID4g
LQkJCQljcHRfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIGlpcik7Cj4gPiArCQkJCWNwdF9pcnFfaGFu
ZGxlcihpOTE1LCBpaXIpOwo+ID4gICAJCX0gZWxzZSB7Cj4gPiAgIAkJCS8qCj4gPiAgIAkJCSAq
IExpa2Ugb24gcHJldmlvdXMgUENIIHRoZXJlIHNlZW1zIHRvIGJlIHNvbWV0aGluZwo+ID4gQEAg
LTI5OTIsMTIgKzI5OTIsMTIgQEAgc3RhdGljIGlubGluZSB2b2lkIGdlbjhfbWFzdGVyX2ludHJf
ZW5hYmxlKHZvaWQgX19pb21lbSAqIGNvbnN0IHJlZ3MpCj4gPiAgIHN0YXRpYyBpcnFyZXR1cm5f
dCBnZW44X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGFyZyk7Cj4gPiAtCXZvaWQg
X19pb21lbSAqIGNvbnN0IHJlZ3MgPSBkZXZfcHJpdi0+dW5jb3JlLnJlZ3M7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShhcmcpOwo+ID4gKwl2b2lkIF9faW9t
ZW0gKiBjb25zdCByZWdzID0gaTkxNS0+dW5jb3JlLnJlZ3M7Cj4gPiAgIAl1MzIgbWFzdGVyX2N0
bDsKPiA+ICAgCXUzMiBndF9paXJbNF07Cj4gPiAtCWlmICghaW50ZWxfaXJxc19lbmFibGVkKGRl
dl9wcml2KSkKPiA+ICsJaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkpCj4gPiAgIAkJcmV0
dXJuIElSUV9OT05FOwo+ID4gICAJbWFzdGVyX2N0bCA9IGdlbjhfbWFzdGVyX2ludHJfZGlzYWJs
ZShyZWdzKTsKPiA+IEBAIC0zMDA3LDE4ICszMDA3LDE4IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBn
ZW44X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykKPiA+ICAgCX0KPiA+ICAgCS8qIEZp
bmQsIGNsZWFyLCB0aGVuIHByb2Nlc3MgZWFjaCBzb3VyY2Ugb2YgaW50ZXJydXB0ICovCj4gPiAt
CWdlbjhfZ3RfaXJxX2FjayhkZXZfcHJpdiwgbWFzdGVyX2N0bCwgZ3RfaWlyKTsKPiA+ICsJZ2Vu
OF9ndF9pcnFfYWNrKGk5MTUsIG1hc3Rlcl9jdGwsIGd0X2lpcik7Cj4gPiAgIAkvKiBJUlFzIGFy
ZSBzeW5jZWQgZHVyaW5nIHJ1bnRpbWVfc3VzcGVuZCwgd2UgZG9uJ3QgcmVxdWlyZSBhIHdha2Vy
ZWYgKi8KPiA+ICAgCWlmIChtYXN0ZXJfY3RsICYgfkdFTjhfR1RfSVJRUykgewo+ID4gLQkJZGlz
YWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGRldl9wcml2KTsKPiA+IC0JCWdlbjhfZGVfaXJxX2hh
bmRsZXIoZGV2X3ByaXYsIG1hc3Rlcl9jdGwpOwo+ID4gLQkJZW5hYmxlX3JwbV93YWtlcmVmX2Fz
c2VydHMoZGV2X3ByaXYpOwo+ID4gKwkJZGlzYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUp
Owo+ID4gKwkJZ2VuOF9kZV9pcnFfaGFuZGxlcihpOTE1LCBtYXN0ZXJfY3RsKTsKPiA+ICsJCWVu
YWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ID4gICAJfQo+ID4gICAJZ2VuOF9tYXN0
ZXJfaW50cl9lbmFibGUocmVncyk7Cj4gPiAtCWdlbjhfZ3RfaXJxX2hhbmRsZXIoZGV2X3ByaXYs
IG1hc3Rlcl9jdGwsIGd0X2lpcik7Cj4gPiArCWdlbjhfZ3RfaXJxX2hhbmRsZXIoaTkxNSwgbWFz
dGVyX2N0bCwgZ3RfaWlyKTsKPiA+ICAgCXJldHVybiBJUlFfSEFORExFRDsKPiA+ICAgfQo+ID4g
QEAgLTMxNDksOSArMzE0OSw5IEBAIGdlbjExX2d0X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICogY29uc3QgaTkxNSwKPiA+ICAgfQo+ID4gICBzdGF0aWMgdTMyCj4gPiAtZ2Vu
MTFfZ3VfbWlzY19pcnFfYWNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgY29u
c3QgdTMyIG1hc3Rlcl9jdGwpCj4gPiArZ2VuMTFfZ3VfbWlzY19pcnFfYWNrKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LCBjb25zdCB1MzIgbWFzdGVyX2N0bCkKPiA+ICAgewo+ID4gLQl2
b2lkIF9faW9tZW0gKiBjb25zdCByZWdzID0gZGV2X3ByaXYtPnVuY29yZS5yZWdzOwo+ID4gKwl2
b2lkIF9faW9tZW0gKiBjb25zdCByZWdzID0gaTkxNS0+dW5jb3JlLnJlZ3M7Cj4gPiAgIAl1MzIg
aWlyOwo+ID4gICAJaWYgKCEobWFzdGVyX2N0bCAmIEdFTjExX0dVX01JU0NfSVJRKSkKPiA+IEBA
IC0zMTY1LDEwICszMTY1LDEwIEBAIGdlbjExX2d1X21pc2NfaXJxX2FjayhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IHUzMiBtYXN0ZXJfY3RsKQo+ID4gICB9Cj4gPiAg
IHN0YXRpYyB2b2lkCj4gPiAtZ2VuMTFfZ3VfbWlzY19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IHUzMiBpaXIpCj4gPiArZ2VuMTFfZ3VfbWlzY19p
cnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgY29uc3QgdTMyIGlpcikK
PiA+ICAgewo+ID4gICAJaWYgKGlpciAmIEdFTjExX0dVX01JU0NfR1NFKQo+ID4gLQkJaW50ZWxf
b3ByZWdpb25fYXNsZV9pbnRyKGRldl9wcml2KTsKPiA+ICsJCWludGVsX29wcmVnaW9uX2FzbGVf
aW50cihpOTE1KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW5saW5lIHUzMiBnZW4xMV9tYXN0ZXJf
aW50cl9kaXNhYmxlKHZvaWQgX19pb21lbSAqIGNvbnN0IHJlZ3MpCj4gPiBAQCAtMzIzNSw1NCAr
MzIzNSw1NCBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgZ2VuMTFfaXJxX2hhbmRsZXIoaW50IGlycSwg
dm9pZCAqYXJnKQo+ID4gICAgKi8KPiA+ICAgc3RhdGljIGludCBpOHh4X2VuYWJsZV92Ymxhbmso
c3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGUpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXVuc2ln
bmVkIGxvbmcgaXJxZmxhZ3M7Cj4gPiAtCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+aXJx
X2xvY2ssIGlycWZsYWdzKTsKPiA+IC0JaTkxNV9lbmFibGVfcGlwZXN0YXQoZGV2X3ByaXYsIHBp
cGUsIFBJUEVfVkJMQU5LX0lOVEVSUlVQVF9TVEFUVVMpOwo+ID4gLQlzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsKPiA+ICsJc3Bpbl9sb2NrX2ly
cXNhdmUoJmk5MTUtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gPiArCWk5MTVfZW5hYmxlX3BpcGVz
dGF0KGk5MTUsIHBpcGUsIFBJUEVfVkJMQU5LX0lOVEVSUlVQVF9TVEFUVVMpOwo+ID4gKwlzcGlu
X3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ID4gICAJcmV0
dXJuIDA7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGludCBpOTQ1Z21fZW5hYmxlX3ZibGFuayhzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LCB1bnNpZ25lZCBpbnQgcGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gLQlpZiAoZGV2X3By
aXYtPmk5NDVnbV92YmxhbmsuZW5hYmxlZCsrID09IDApCj4gPiAtCQlzY2hlZHVsZV93b3JrKCZk
ZXZfcHJpdi0+aTk0NWdtX3ZibGFuay53b3JrKTsKPiA+ICsJaWYgKGk5MTUtPmk5NDVnbV92Ymxh
bmsuZW5hYmxlZCsrID09IDApCj4gPiArCQlzY2hlZHVsZV93b3JrKCZpOTE1LT5pOTQ1Z21fdmJs
YW5rLndvcmspOwo+ID4gICAJcmV0dXJuIGk4eHhfZW5hYmxlX3ZibGFuayhkZXYsIHBpcGUpOwo+
ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgaTk2NV9lbmFibGVfdmJsYW5rKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIGlycWZs
YWdzOwo+ID4gLQlzcGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPmlycV9sb2NrLCBpcnFmbGFn
cyk7Cj4gPiAtCWk5MTVfZW5hYmxlX3BpcGVzdGF0KGRldl9wcml2LCBwaXBlLAo+ID4gKwlzcGlu
X2xvY2tfaXJxc2F2ZSgmaTkxNS0+aXJxX2xvY2ssIGlycWZsYWdzKTsKPiA+ICsJaTkxNV9lbmFi
bGVfcGlwZXN0YXQoaTkxNSwgcGlwZSwKPiA+ICAgCQkJICAgICBQSVBFX1NUQVJUX1ZCTEFOS19J
TlRFUlJVUFRfU1RBVFVTKTsKPiA+IC0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYt
PmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUt
PmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4gICBzdGF0
aWMgaW50IGlyb25sYWtlX2VuYWJsZV92Ymxhbmsoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5z
aWduZWQgaW50IHBpcGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXVuc2lnbmVkIGxvbmcgaXJxZmxhZ3M7Cj4gPiAtCXUz
MiBiaXQgPSBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDcgPwo+ID4gKwl1MzIgYml0ID0gSU5URUxf
R0VOKGk5MTUpID49IDcgPwo+ID4gICAJCURFX1BJUEVfVkJMQU5LX0lWQihwaXBlKSA6IERFX1BJ
UEVfVkJMQU5LKHBpcGUpOwo+ID4gLQlzcGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPmlycV9s
b2NrLCBpcnFmbGFncyk7Cj4gPiAtCWlsa19lbmFibGVfZGlzcGxheV9pcnEoZGV2X3ByaXYsIGJp
dCk7Cj4gPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT5pcnFfbG9jaywgaXJx
ZmxhZ3MpOwo+ID4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+aXJxX2xvY2ssIGlycWZsYWdz
KTsKPiA+ICsJaWxrX2VuYWJsZV9kaXNwbGF5X2lycShpOTE1LCBiaXQpOwo+ID4gKwlzcGluX3Vu
bG9ja19pcnFyZXN0b3JlKCZpOTE1LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ID4gICAJLyogRXZl
biB0aG91Z2ggdGhlcmUgaXMgbm8gRE1DLCBmcmFtZSBjb3VudGVyIGNhbiBnZXQgc3R1Y2sgd2hl
bgo+ID4gICAJICogUFNSIGlzIGFjdGl2ZSBhcyBubyBmcmFtZXMgYXJlIGdlbmVyYXRlZC4KPiA+
ICAgCSAqLwo+ID4gLQlpZiAoSEFTX1BTUihkZXZfcHJpdikpCj4gPiArCWlmIChIQVNfUFNSKGk5
MTUpKQo+ID4gICAJCWRybV92YmxhbmtfcmVzdG9yZShkZXYsIHBpcGUpOwo+ID4gICAJcmV0dXJu
IDA7Cj4gPiBAQCAtMzI5MCwxNyArMzI5MCwxNyBAQCBzdGF0aWMgaW50IGlyb25sYWtlX2VuYWJs
ZV92Ymxhbmsoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGUpCj4gPiAg
IHN0YXRpYyBpbnQgZ2VuOF9lbmFibGVfdmJsYW5rKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVu
c2lnbmVkIGludCBwaXBlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIGlycWZsYWdzOwo+ID4gLQlz
cGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gPiAtCWJk
d19lbmFibGVfcGlwZV9pcnEoZGV2X3ByaXYsIHBpcGUsIEdFTjhfUElQRV9WQkxBTkspOwo+ID4g
LQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsK
PiA+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gPiAr
CWJkd19lbmFibGVfcGlwZV9pcnEoaTkxNSwgcGlwZSwgR0VOOF9QSVBFX1ZCTEFOSyk7Cj4gPiAr
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gPiAg
IAkvKiBFdmVuIGlmIHRoZXJlIGlzIG5vIERNQywgZnJhbWUgY291bnRlciBjYW4gZ2V0IHN0dWNr
IHdoZW4KPiA+ICAgCSAqIFBTUiBpcyBhY3RpdmUgYXMgbm8gZnJhbWVzIGFyZSBnZW5lcmF0ZWQs
IHNvIGNoZWNrIG9ubHkgZm9yIFBTUi4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSEFTX1BTUihkZXZf
cHJpdikpCj4gPiArCWlmIChIQVNfUFNSKGk5MTUpKQo+ID4gICAJCWRybV92YmxhbmtfcmVzdG9y
ZShkZXYsIHBpcGUpOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiBAQCAtMzMxMSw2MCArMzMxMSw2MCBA
QCBzdGF0aWMgaW50IGdlbjhfZW5hYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1
bnNpZ25lZCBpbnQgcGlwZSkKPiA+ICAgICovCj4gPiAgIHN0YXRpYyB2b2lkIGk4eHhfZGlzYWJs
ZV92Ymxhbmsoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGUpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+
ICAgCXVuc2lnbmVkIGxvbmcgaXJxZmxhZ3M7Cj4gPiAtCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZf
cHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsKPiA+IC0JaTkxNV9kaXNhYmxlX3BpcGVzdGF0KGRl
dl9wcml2LCBwaXBlLCBQSVBFX1ZCTEFOS19JTlRFUlJVUFRfU1RBVFVTKTsKPiA+IC0Jc3Bpbl91
bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gPiArCXNw
aW5fbG9ja19pcnFzYXZlKCZpOTE1LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ID4gKwlpOTE1X2Rp
c2FibGVfcGlwZXN0YXQoaTkxNSwgcGlwZSwgUElQRV9WQkxBTktfSU5URVJSVVBUX1NUQVRVUyk7
Cj4gPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPmlycV9sb2NrLCBpcnFmbGFncyk7
Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgaTk0NWdtX2Rpc2FibGVfdmJsYW5rKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlpOHh4X2Rpc2FibGVf
dmJsYW5rKGRldiwgcGlwZSk7Cj4gPiAtCWlmICgtLWRldl9wcml2LT5pOTQ1Z21fdmJsYW5rLmVu
YWJsZWQgPT0gMCkKPiA+IC0JCXNjaGVkdWxlX3dvcmsoJmRldl9wcml2LT5pOTQ1Z21fdmJsYW5r
LndvcmspOwo+ID4gKwlpZiAoLS1pOTE1LT5pOTQ1Z21fdmJsYW5rLmVuYWJsZWQgPT0gMCkKPiA+
ICsJCXNjaGVkdWxlX3dvcmsoJmk5MTUtPmk5NDVnbV92Ymxhbmsud29yayk7Cj4gPiAgIH0KPiA+
ICAgc3RhdGljIHZvaWQgaTk2NV9kaXNhYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCB1bnNpZ25lZCBpbnQgcGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJdW5zaWduZWQgbG9uZyBpcnFmbGFnczsKPiA+
IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ID4g
LQlpOTE1X2Rpc2FibGVfcGlwZXN0YXQoZGV2X3ByaXYsIHBpcGUsCj4gPiArCXNwaW5fbG9ja19p
cnFzYXZlKCZpOTE1LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ID4gKwlpOTE1X2Rpc2FibGVfcGlw
ZXN0YXQoaTkxNSwgcGlwZSwKPiA+ICAgCQkJICAgICAgUElQRV9TVEFSVF9WQkxBTktfSU5URVJS
VVBUX1NUQVRVUyk7Cj4gPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT5pcnFf
bG9jaywgaXJxZmxhZ3MpOwo+ID4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5pcnFf
bG9jaywgaXJxZmxhZ3MpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGlyb25sYWtlX2Rpc2Fi
bGVfdmJsYW5rKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGludCBwaXBlKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4g
PiAgIAl1bnNpZ25lZCBsb25nIGlycWZsYWdzOwo+ID4gLQl1MzIgYml0ID0gSU5URUxfR0VOKGRl
dl9wcml2KSA+PSA3ID8KPiA+ICsJdTMyIGJpdCA9IElOVEVMX0dFTihpOTE1KSA+PSA3ID8KPiA+
ICAgCQlERV9QSVBFX1ZCTEFOS19JVkIocGlwZSkgOiBERV9QSVBFX1ZCTEFOSyhwaXBlKTsKPiA+
IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ID4g
LQlpbGtfZGlzYWJsZV9kaXNwbGF5X2lycShkZXZfcHJpdiwgYml0KTsKPiA+IC0Jc3Bpbl91bmxv
Y2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gPiArCXNwaW5f
bG9ja19pcnFzYXZlKCZpOTE1LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ID4gKwlpbGtfZGlzYWJs
ZV9kaXNwbGF5X2lycShpOTE1LCBiaXQpOwo+ID4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZp
OTE1LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGdlbjhf
ZGlzYWJsZV92Ymxhbmsoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHBpcGUp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2
KTsKPiA+ICAgCXVuc2lnbmVkIGxvbmcgaXJxZmxhZ3M7Cj4gPiAtCXNwaW5fbG9ja19pcnFzYXZl
KCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsKPiA+IC0JYmR3X2Rpc2FibGVfcGlwZV9p
cnEoZGV2X3ByaXYsIHBpcGUsIEdFTjhfUElQRV9WQkxBTkspOwo+ID4gLQlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGlycWZsYWdzKTsKPiA+ICsJc3Bpbl9sb2Nr
X2lycXNhdmUoJmk5MTUtPmlycV9sb2NrLCBpcnFmbGFncyk7Cj4gPiArCWJkd19kaXNhYmxlX3Bp
cGVfaXJxKGk5MTUsIHBpcGUsIEdFTjhfUElQRV9WQkxBTkspOwo+ID4gKwlzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZpOTE1LT5pcnFfbG9jaywgaXJxZmxhZ3MpOwo+ID4gICB9Cj4gPiAgIHN0YXRp
YyB2b2lkIGk5NDVnbV92Ymxhbmtfd29ya19mdW5jKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gPiAgIAkJY29udGFpbmVyX29mKHdvcmss
IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlLCBpOTQ1Z21fdmJsYW5rLndvcmspOwo+ID4gICAJLyoK
PiA+IEBAIC0zMzcyLDkgKzMzNzIsOSBAQCBzdGF0aWMgdm9pZCBpOTQ1Z21fdmJsYW5rX3dvcmtf
ZnVuYyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiAgIAkgKiBoZW5jZSB3ZSB3YW50IHRv
IHByZXZlbnQgQzMgdXNhZ2Ugd2hpbGUgdmJsYW5rIGludGVycnVwdHMKPiA+ICAgCSAqIGFyZSBl
bmFibGVkLgo+ID4gICAJICovCj4gPiAtCXBtX3Fvc191cGRhdGVfcmVxdWVzdCgmZGV2X3ByaXYt
Pmk5NDVnbV92YmxhbmsucG1fcW9zLAo+ID4gLQkJCSAgICAgIFJFQURfT05DRShkZXZfcHJpdi0+
aTk0NWdtX3ZibGFuay5lbmFibGVkKSA/Cj4gPiAtCQkJICAgICAgZGV2X3ByaXYtPmk5NDVnbV92
YmxhbmsuYzNfZGlzYWJsZV9sYXRlbmN5IDoKPiA+ICsJcG1fcW9zX3VwZGF0ZV9yZXF1ZXN0KCZp
OTE1LT5pOTQ1Z21fdmJsYW5rLnBtX3FvcywKPiA+ICsJCQkgICAgICBSRUFEX09OQ0UoaTkxNS0+
aTk0NWdtX3ZibGFuay5lbmFibGVkKSA/Cj4gPiArCQkJICAgICAgaTkxNS0+aTk0NWdtX3ZibGFu
ay5jM19kaXNhYmxlX2xhdGVuY3kgOgo+ID4gICAJCQkgICAgICBQTV9RT1NfREVGQVVMVF9WQUxV
RSk7Cj4gPiAgIH0KPiA+IEBAIC0zMzk4LDM0ICszMzk4LDM0IEBAIHN0YXRpYyBpbnQgY3N0YXRl
X2Rpc2FibGVfbGF0ZW5jeShjb25zdCBjaGFyICpuYW1lKQo+ID4gICAJcmV0dXJuIDA7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCBpOTQ1Z21fdmJsYW5rX3dvcmtfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaTk0NWdtX3ZibGFua193b3Jr
X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JSU5JVF9X
T1JLKCZkZXZfcHJpdi0+aTk0NWdtX3ZibGFuay53b3JrLAo+ID4gKwlJTklUX1dPUksoJmk5MTUt
Pmk5NDVnbV92Ymxhbmsud29yaywKPiA+ICAgCQkgIGk5NDVnbV92Ymxhbmtfd29ya19mdW5jKTsK
PiA+IC0JZGV2X3ByaXYtPmk5NDVnbV92YmxhbmsuYzNfZGlzYWJsZV9sYXRlbmN5ID0KPiA+ICsJ
aTkxNS0+aTk0NWdtX3ZibGFuay5jM19kaXNhYmxlX2xhdGVuY3kgPQo+ID4gICAJCWNzdGF0ZV9k
aXNhYmxlX2xhdGVuY3koIkMzIik7Cj4gPiAtCXBtX3Fvc19hZGRfcmVxdWVzdCgmZGV2X3ByaXYt
Pmk5NDVnbV92YmxhbmsucG1fcW9zLAo+ID4gKwlwbV9xb3NfYWRkX3JlcXVlc3QoJmk5MTUtPmk5
NDVnbV92YmxhbmsucG1fcW9zLAo+ID4gICAJCQkgICBQTV9RT1NfQ1BVX0RNQV9MQVRFTkNZLAo+
ID4gICAJCQkgICBQTV9RT1NfREVGQVVMVF9WQUxVRSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9p
ZCBpOTQ1Z21fdmJsYW5rX3dvcmtfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiArc3RhdGljIHZvaWQgaTk0NWdtX3ZibGFua193b3JrX2Zpbmkoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JY2FuY2VsX3dvcmtfc3luYygmZGV2X3By
aXYtPmk5NDVnbV92Ymxhbmsud29yayk7Cj4gPiAtCXBtX3Fvc19yZW1vdmVfcmVxdWVzdCgmZGV2
X3ByaXYtPmk5NDVnbV92YmxhbmsucG1fcW9zKTsKPiA+ICsJY2FuY2VsX3dvcmtfc3luYygmaTkx
NS0+aTk0NWdtX3ZibGFuay53b3JrKTsKPiA+ICsJcG1fcW9zX3JlbW92ZV9yZXF1ZXN0KCZpOTE1
LT5pOTQ1Z21fdmJsYW5rLnBtX3Fvcyk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpYnhfaXJx
X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9p
ZCBpYnhfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ID4g
KwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ID4gLQlpZiAo
SEFTX1BDSF9OT1AoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFTX1BDSF9OT1AoaTkxNSkpCj4gPiAg
IAkJcmV0dXJuOwo+ID4gICAJR0VOM19JUlFfUkVTRVQodW5jb3JlLCBTREUpOwo+ID4gLQlpZiAo
SEFTX1BDSF9DUFQoZGV2X3ByaXYpIHx8IEhBU19QQ0hfTFBUKGRldl9wcml2KSkKPiA+ICsJaWYg
KEhBU19QQ0hfQ1BUKGk5MTUpIHx8IEhBU19QQ0hfTFBUKGk5MTUpKQo+ID4gICAJCUk5MTVfV1JJ
VEUoU0VSUl9JTlQsIDB4ZmZmZmZmZmYpOwo+ID4gICB9Cj4gPiBAQCAtMzQzOSw5ICszNDM5LDkg
QEAgc3RhdGljIHZvaWQgaWJ4X2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgdm9pZCBpYnhfaXJxX3ByZV9wb3N0aW5zdGFs
bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAtCWlmIChIQVNfUENIX05PUChkZXZfcHJp
dikpCj4gPiArCWlmIChIQVNfUENIX05PUChpOTE1KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAlX
QVJOX09OKEk5MTVfUkVBRChTREVJRVIpICE9IDApOwo+ID4gQEAgLTM0NDksMzYgKzM0NDksMzYg
QEAgc3RhdGljIHZvaWQgaWJ4X2lycV9wcmVfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2Ug
KmRldikKPiA+ICAgCVBPU1RJTkdfUkVBRChTREVJRVIpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgZ2VuNV9ndF9pcnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gK3N0YXRpYyB2b2lkIGdlbjVfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZf
cHJpdi0+dW5jb3JlOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+
dW5jb3JlOwo+ID4gICAJR0VOM19JUlFfUkVTRVQodW5jb3JlLCBHVCk7Cj4gPiAtCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDYpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKPiA+
ICAgCQlHRU4zX0lSUV9SRVNFVCh1bmNvcmUsIEdFTjZfUE0pOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IHZvaWQgdmx2X2Rpc3BsYXlfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtzdGF0aWMgdm9pZCB2bHZfZGlzcGxheV9pcnFfcmVzZXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5j
b3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29y
ZSA9ICZpOTE1LT51bmNvcmU7Cj4gPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+
ICsJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJSTkxNV9XUklURShEUElOVkdUVCwg
RFBJTlZHVFRfU1RBVFVTX01BU0tfQ0hWKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlJOTE1X1dSSVRF
KERQSU5WR1RULCBEUElOVkdUVF9TVEFUVVNfTUFTSyk7Cj4gPiAtCWk5MTVfaG90cGx1Z19pbnRl
cnJ1cHRfdXBkYXRlX2xvY2tlZChkZXZfcHJpdiwgMHhmZmZmZmZmZiwgMCk7Cj4gPiArCWk5MTVf
aG90cGx1Z19pbnRlcnJ1cHRfdXBkYXRlX2xvY2tlZChpOTE1LCAweGZmZmZmZmZmLCAwKTsKPiA+
ICAgCUk5MTVfV1JJVEUoUE9SVF9IT1RQTFVHX1NUQVQsIEk5MTVfUkVBRChQT1JUX0hPVFBMVUdf
U1RBVCkpOwo+ID4gLQlpOXh4X3BpcGVzdGF0X2lycV9yZXNldChkZXZfcHJpdik7Cj4gPiArCWk5
eHhfcGlwZXN0YXRfaXJxX3Jlc2V0KGk5MTUpOwo+ID4gICAJR0VOM19JUlFfUkVTRVQodW5jb3Jl
LCBWTFZfKTsKPiA+IC0JZGV2X3ByaXYtPmlycV9tYXNrID0gfjB1Owo+ID4gKwlpOTE1LT5pcnFf
bWFzayA9IH4wdTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHZsdl9kaXNwbGF5X2lycV9wb3N0
aW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZv
aWQgdmx2X2Rpc3BsYXlfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJp
di0+dW5jb3JlOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5j
b3JlOwo+ID4gICAJdTMyIHBpcGVzdGF0X21hc2s7Cj4gPiAgIAl1MzIgZW5hYmxlX21hc2s7Cj4g
PiBAQCAtMzQ4Niw5ICszNDg2LDkgQEAgc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfaXJxX3Bvc3Rp
bnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXBpcGVzdGF0
X21hc2sgPSBQSVBFX0NSQ19ET05FX0lOVEVSUlVQVF9TVEFUVVM7Cj4gPiAtCWk5MTVfZW5hYmxl
X3BpcGVzdGF0KGRldl9wcml2LCBQSVBFX0EsIFBJUEVfR01CVVNfSU5URVJSVVBUX1NUQVRVUyk7
Cj4gPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpCj4gPiAtCQlpOTE1X2VuYWJsZV9w
aXBlc3RhdChkZXZfcHJpdiwgcGlwZSwgcGlwZXN0YXRfbWFzayk7Cj4gPiArCWk5MTVfZW5hYmxl
X3BpcGVzdGF0KGk5MTUsIFBJUEVfQSwgUElQRV9HTUJVU19JTlRFUlJVUFRfU1RBVFVTKTsKPiA+
ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+ID4gKwkJaTkxNV9lbmFibGVfcGlwZXN0YXQo
aTkxNSwgcGlwZSwgcGlwZXN0YXRfbWFzayk7Cj4gPiAgIAllbmFibGVfbWFzayA9IEk5MTVfRElT
UExBWV9QT1JUX0lOVEVSUlVQVCB8Cj4gPiAgIAkJSTkxNV9ESVNQTEFZX1BJUEVfQV9FVkVOVF9J
TlRFUlJVUFQgfAo+ID4gQEAgLTM0OTYsNTYgKzM0OTYsNTYgQEAgc3RhdGljIHZvaWQgdmx2X2Rp
c3BsYXlfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgCQlJOTE1X0xQRV9QSVBFX0FfSU5URVJSVVBUIHwKPiA+ICAgCQlJOTE1X0xQRV9QSVBF
X0JfSU5URVJSVVBUOwo+ID4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiArCWlm
IChJU19DSEVSUllWSUVXKGk5MTUpKQo+ID4gICAJCWVuYWJsZV9tYXNrIHw9IEk5MTVfRElTUExB
WV9QSVBFX0NfRVZFTlRfSU5URVJSVVBUIHwKPiA+ICAgCQkJSTkxNV9MUEVfUElQRV9DX0lOVEVS
UlVQVDsKPiA+IC0JV0FSTl9PTihkZXZfcHJpdi0+aXJxX21hc2sgIT0gfjB1KTsKPiA+ICsJV0FS
Tl9PTihpOTE1LT5pcnFfbWFzayAhPSB+MHUpOwo+ID4gLQlkZXZfcHJpdi0+aXJxX21hc2sgPSB+
ZW5hYmxlX21hc2s7Cj4gPiArCWk5MTUtPmlycV9tYXNrID0gfmVuYWJsZV9tYXNrOwo+ID4gLQlH
RU4zX0lSUV9JTklUKHVuY29yZSwgVkxWXywgZGV2X3ByaXYtPmlycV9tYXNrLCBlbmFibGVfbWFz
ayk7Cj4gPiArCUdFTjNfSVJRX0lOSVQodW5jb3JlLCBWTFZfLCBpOTE1LT5pcnFfbWFzaywgZW5h
YmxlX21hc2spOwo+ID4gICB9Cj4gPiAgIC8qIGRybV9kbWEuaCBob29rcwo+ID4gICAqLwo+ID4g
ICBzdGF0aWMgdm9pZCBpcm9ubGFrZV9pcnFfcmVzZXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGRldik7Cj4gPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5j
b3JlOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsK
PiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiA+ICAg
CUdFTjNfSVJRX1JFU0VUKHVuY29yZSwgREUpOwo+ID4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA3
KSkKPiA+ICsJaWYgKElTX0dFTihpOTE1LCA3KSkKPiA+ICAgCQlJOTE1X1dSSVRFKEdFTjdfRVJS
X0lOVCwgMHhmZmZmZmZmZik7Cj4gPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSkgewo+ID4g
KwlpZiAoSVNfSEFTV0VMTChpOTE1KSkgewo+ID4gICAJCUk5MTVfV1JJVEUoRURQX1BTUl9JTVIs
IDB4ZmZmZmZmZmYpOwo+ID4gICAJCUk5MTVfV1JJVEUoRURQX1BTUl9JSVIsIDB4ZmZmZmZmZmYp
Owo+ID4gICAJfQo+ID4gLQlnZW41X2d0X2lycV9yZXNldChkZXZfcHJpdik7Cj4gPiArCWdlbjVf
Z3RfaXJxX3Jlc2V0KGk5MTUpOwo+ID4gLQlpYnhfaXJxX3Jlc2V0KGRldl9wcml2KTsKPiA+ICsJ
aWJ4X2lycV9yZXNldChpOTE1KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3
X2lycV9yZXNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlJOTE1X1dSSVRFKFZM
Vl9NQVNURVJfSUVSLCAwKTsKPiA+ICAgCVBPU1RJTkdfUkVBRChWTFZfTUFTVEVSX0lFUik7Cj4g
PiAtCWdlbjVfZ3RfaXJxX3Jlc2V0KGRldl9wcml2KTsKPiA+ICsJZ2VuNV9ndF9pcnFfcmVzZXQo
aTkxNSk7Cj4gPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAtCWlm
IChkZXZfcHJpdi0+ZGlzcGxheV9pcnFzX2VuYWJsZWQpCj4gPiAtCQl2bHZfZGlzcGxheV9pcnFf
cmVzZXQoZGV2X3ByaXYpOwo+ID4gLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9j
ayk7Cj4gPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICsJaWYgKGk5MTUt
PmRpc3BsYXlfaXJxc19lbmFibGVkKQo+ID4gKwkJdmx2X2Rpc3BsYXlfaXJxX3Jlc2V0KGk5MTUp
Owo+ID4gKwlzcGluX3VubG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICAgfQo+ID4gLXN0
YXRpYyB2b2lkIGdlbjhfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnZW44X2d0X2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUg
PSAmZGV2X3ByaXYtPnVuY29yZTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0g
Jmk5MTUtPnVuY29yZTsKPiA+ICAgCUdFTjhfSVJRX1JFU0VUX05EWCh1bmNvcmUsIEdULCAwKTsK
PiA+ICAgCUdFTjhfSVJRX1JFU0VUX05EWCh1bmNvcmUsIEdULCAxKTsKPiA+IEBAIC0zNTU1LDE5
ICszNTU1LDE5IEBAIHN0YXRpYyB2b2lkIGdlbjhfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgc3RhdGljIHZvaWQgZ2VuOF9pcnFfcmVzZXQoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVu
Y29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0g
Jmk5MTUtPnVuY29yZTsKPiA+ICAgCWludCBwaXBlOwo+ID4gLQlnZW44X21hc3Rlcl9pbnRyX2Rp
c2FibGUoZGV2X3ByaXYtPnVuY29yZS5yZWdzKTsKPiA+ICsJZ2VuOF9tYXN0ZXJfaW50cl9kaXNh
YmxlKGk5MTUtPnVuY29yZS5yZWdzKTsKPiA+IC0JZ2VuOF9ndF9pcnFfcmVzZXQoZGV2X3ByaXYp
Owo+ID4gKwlnZW44X2d0X2lycV9yZXNldChpOTE1KTsKPiA+ICAgCUk5MTVfV1JJVEUoRURQX1BT
Ul9JTVIsIDB4ZmZmZmZmZmYpOwo+ID4gICAJSTkxNV9XUklURShFRFBfUFNSX0lJUiwgMHhmZmZm
ZmZmZik7Cj4gPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpCj4gPiAtCQlpZiAoaW50
ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGRldl9wcml2LAo+ID4gKwlmb3JfZWFjaF9waXBl
KGk5MTUsIHBpcGUpCj4gPiArCQlpZiAoaW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGk5
MTUsCj4gPiAgIAkJCQkJCSAgIFBPV0VSX0RPTUFJTl9QSVBFKHBpcGUpKSkKPiA+ICAgCQkJR0VO
OF9JUlFfUkVTRVRfTkRYKHVuY29yZSwgREVfUElQRSwgcGlwZSk7Cj4gPiBAQCAtMzU3NSwxMSAr
MzU3NSwxMSBAQCBzdGF0aWMgdm9pZCBnZW44X2lycV9yZXNldChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2KQo+ID4gICAJR0VOM19JUlFfUkVTRVQodW5jb3JlLCBHRU44X0RFX01JU0NfKTsKPiA+ICAg
CUdFTjNfSVJRX1JFU0VUKHVuY29yZSwgR0VOOF9QQ1VfKTsKPiA+IC0JaWYgKEhBU19QQ0hfU1BM
SVQoZGV2X3ByaXYpKQo+ID4gLQkJaWJ4X2lycV9yZXNldChkZXZfcHJpdik7Cj4gPiArCWlmIChI
QVNfUENIX1NQTElUKGk5MTUpKQo+ID4gKwkJaWJ4X2lycV9yZXNldChpOTE1KTsKPiA+ICAgfQo+
ID4gLXN0YXRpYyB2b2lkIGdlbjExX2d0X2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgZ2VuMTFfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAkvKiBEaXNhYmxlIFJDUywgQkNT
LCBWQ1MgYW5kIFZFQ1MgY2xhc3MgZW5naW5lcy4gKi8KPiA+ICAgCUk5MTVfV1JJVEUoR0VOMTFf
UkVOREVSX0NPUFlfSU5UUl9FTkFCTEUsIDApOwo+ID4gQEAgLTM2MDAsMjEgKzM2MDAsMjEgQEAg
c3RhdGljIHZvaWQgZ2VuMTFfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICAgc3RhdGljIHZvaWQgZ2VuMTFfaXJxX3Jlc2V0KHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gZGV2LT5kZXZfcHJpdmF0ZTsKPiA+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0g
JmRldl9wcml2LT51bmNvcmU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
ZGV2LT5kZXZfcHJpdmF0ZTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5
MTUtPnVuY29yZTsKPiA+ICAgCWludCBwaXBlOwo+ID4gLQlnZW4xMV9tYXN0ZXJfaW50cl9kaXNh
YmxlKGRldl9wcml2LT51bmNvcmUucmVncyk7Cj4gPiArCWdlbjExX21hc3Rlcl9pbnRyX2Rpc2Fi
bGUoaTkxNS0+dW5jb3JlLnJlZ3MpOwo+ID4gLQlnZW4xMV9ndF9pcnFfcmVzZXQoZGV2X3ByaXYp
Owo+ID4gKwlnZW4xMV9ndF9pcnFfcmVzZXQoaTkxNSk7Cj4gPiAgIAlJOTE1X1dSSVRFKEdFTjEx
X0RJU1BMQVlfSU5UX0NUTCwgMCk7Cj4gPiAgIAlJOTE1X1dSSVRFKEVEUF9QU1JfSU1SLCAweGZm
ZmZmZmZmKTsKPiA+ICAgCUk5MTVfV1JJVEUoRURQX1BTUl9JSVIsIDB4ZmZmZmZmZmYpOwo+ID4g
LQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKQo+ID4gLQkJaWYgKGludGVsX2Rpc3BsYXlf
cG93ZXJfaXNfZW5hYmxlZChkZXZfcHJpdiwKPiA+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBl
KQo+ID4gKwkJaWYgKGludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5hYmxlZChpOTE1LAo+ID4gICAJ
CQkJCQkgICBQT1dFUl9ET01BSU5fUElQRShwaXBlKSkpCj4gPiAgIAkJCUdFTjhfSVJRX1JFU0VU
X05EWCh1bmNvcmUsIERFX1BJUEUsIHBpcGUpOwo+ID4gQEAgLTM2MjQsODcgKzM2MjQsODcgQEAg
c3RhdGljIHZvaWQgZ2VuMTFfaXJxX3Jlc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAg
IAlHRU4zX0lSUV9SRVNFVCh1bmNvcmUsIEdFTjExX0dVX01JU0NfKTsKPiA+ICAgCUdFTjNfSVJR
X1JFU0VUKHVuY29yZSwgR0VOOF9QQ1VfKTsKPiA+IC0JaWYgKElOVEVMX1BDSF9UWVBFKGRldl9w
cml2KSA+PSBQQ0hfSUNQKQo+ID4gKwlpZiAoSU5URUxfUENIX1RZUEUoaTkxNSkgPj0gUENIX0lD
UCkKPiA+ICAgCQlHRU4zX0lSUV9SRVNFVCh1bmNvcmUsIFNERSk7Cj4gPiAgIH0KPiA+IC12b2lk
IGdlbjhfaXJxX3Bvd2VyX3dlbGxfcG9zdF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gK3ZvaWQgZ2VuOF9pcnFfcG93ZXJfd2VsbF9wb3N0X2VuYWJsZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgdTggcGlwZV9tYXNrKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5j
b3JlOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+
ID4gICAJdTMyIGV4dHJhX2llciA9IEdFTjhfUElQRV9WQkxBTksgfCBHRU44X1BJUEVfRklGT19V
TkRFUlJVTjsKPiA+ICAgCWVudW0gcGlwZSBwaXBlOwo+ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZf
cHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4g
PiAtCWlmICghaW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSkgewo+ID4gLQkJc3Bpbl91bmxv
Y2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlpZiAoIWludGVsX2lycXNfZW5hYmxl
ZChpOTE1KSkgewo+ID4gKwkJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAg
IAkJcmV0dXJuOwo+ID4gICAJfQo+ID4gLQlmb3JfZWFjaF9waXBlX21hc2tlZChkZXZfcHJpdiwg
cGlwZSwgcGlwZV9tYXNrKQo+ID4gKwlmb3JfZWFjaF9waXBlX21hc2tlZChpOTE1LCBwaXBlLCBw
aXBlX21hc2spCj4gPiAgIAkJR0VOOF9JUlFfSU5JVF9ORFgodW5jb3JlLCBERV9QSVBFLCBwaXBl
LAo+ID4gLQkJCQkgIGRldl9wcml2LT5kZV9pcnFfbWFza1twaXBlXSwKPiA+IC0JCQkJICB+ZGV2
X3ByaXYtPmRlX2lycV9tYXNrW3BpcGVdIHwgZXh0cmFfaWVyKTsKPiA+ICsJCQkJICBpOTE1LT5k
ZV9pcnFfbWFza1twaXBlXSwKPiA+ICsJCQkJICB+aTkxNS0+ZGVfaXJxX21hc2tbcGlwZV0gfCBl
eHRyYV9pZXIpOwo+ID4gLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4g
PiArCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gICB9Cj4gPiAtdm9pZCBn
ZW44X2lycV9wb3dlcl93ZWxsX3ByZV9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICt2b2lkIGdlbjhfaXJxX3Bvd2VyX3dlbGxfcHJlX2Rpc2FibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgIHU4IHBpcGVfbWFzaykKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29y
ZTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiA+
ICAgCWVudW0gcGlwZSBwaXBlOwo+ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xv
Y2spOwo+ID4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAtCWlmICghaW50
ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSkgewo+ID4gLQkJc3Bpbl91bmxvY2tfaXJxKCZkZXZf
cHJpdi0+aXJxX2xvY2spOwo+ID4gKwlpZiAoIWludGVsX2lycXNfZW5hYmxlZChpOTE1KSkgewo+
ID4gKwkJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAgIAkJcmV0dXJuOwo+
ID4gICAJfQo+ID4gLQlmb3JfZWFjaF9waXBlX21hc2tlZChkZXZfcHJpdiwgcGlwZSwgcGlwZV9t
YXNrKQo+ID4gKwlmb3JfZWFjaF9waXBlX21hc2tlZChpOTE1LCBwaXBlLCBwaXBlX21hc2spCj4g
PiAgIAkJR0VOOF9JUlFfUkVTRVRfTkRYKHVuY29yZSwgREVfUElQRSwgcGlwZSk7Cj4gPiAtCXNw
aW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJx
KCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAgIAkvKiBtYWtlIHN1cmUgd2UncmUgZG9uZSBwcm9jZXNz
aW5nIGRpc3BsYXkgaXJxcyAqLwo+ID4gLQlzeW5jaHJvbml6ZV9pcnEoZGV2X3ByaXYtPmRybS5p
cnEpOwo+ID4gKwlzeW5jaHJvbml6ZV9pcnEoaTkxNS0+ZHJtLmlycSk7Cj4gPiAgIH0KPiA+ICAg
c3RhdGljIHZvaWQgY2hlcnJ5dmlld19pcnFfcmVzZXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGRldik7Cj4gPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5j
b3JlOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsK
PiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiA+ICAg
CUk5MTVfV1JJVEUoR0VOOF9NQVNURVJfSVJRLCAwKTsKPiA+ICAgCVBPU1RJTkdfUkVBRChHRU44
X01BU1RFUl9JUlEpOwo+ID4gLQlnZW44X2d0X2lycV9yZXNldChkZXZfcHJpdik7Cj4gPiArCWdl
bjhfZ3RfaXJxX3Jlc2V0KGk5MTUpOwo+ID4gICAJR0VOM19JUlFfUkVTRVQodW5jb3JlLCBHRU44
X1BDVV8pOwo+ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gLQlp
ZiAoZGV2X3ByaXYtPmRpc3BsYXlfaXJxc19lbmFibGVkKQo+ID4gLQkJdmx2X2Rpc3BsYXlfaXJx
X3Jlc2V0KGRldl9wcml2KTsKPiA+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xv
Y2spOwo+ID4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiArCWlmIChpOTE1
LT5kaXNwbGF5X2lycXNfZW5hYmxlZCkKPiA+ICsJCXZsdl9kaXNwbGF5X2lycV9yZXNldChpOTE1
KTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAgIH0KPiA+IC1z
dGF0aWMgdTMyIGludGVsX2hwZF9lbmFibGVkX2lycXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gK3N0YXRpYyB1MzIgaW50ZWxfaHBkX2VuYWJsZWRfaXJxcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgY29uc3QgdTMyIGhwZFtIUERfTlVN
X1BJTlNdKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiA+
ICAgCXUzMiBlbmFibGVkX2lycXMgPSAwOwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9lbmNvZGVyKCZk
ZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKQo+ID4gLQkJaWYgKGRldl9wcml2LT5ob3RwbHVnLnN0YXRz
W2VuY29kZXItPmhwZF9waW5dLnN0YXRlID09IEhQRF9FTkFCTEVEKQo+ID4gKwlmb3JfZWFjaF9p
bnRlbF9lbmNvZGVyKCZpOTE1LT5kcm0sIGVuY29kZXIpCj4gPiArCQlpZiAoaTkxNS0+aG90cGx1
Zy5zdGF0c1tlbmNvZGVyLT5ocGRfcGluXS5zdGF0ZSA9PSBIUERfRU5BQkxFRCkKPiA+ICAgCQkJ
ZW5hYmxlZF9pcnFzIHw9IGhwZFtlbmNvZGVyLT5ocGRfcGluXTsKPiA+ICAgCXJldHVybiBlbmFi
bGVkX2lycXM7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpYnhfaHBkX2RldGVjdGlvbl9zZXR1
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaWJ4
X2hwZF9kZXRlY3Rpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAg
IHsKPiA+ICAgCXUzMiBob3RwbHVnOwo+ID4gQEAgLTM3MjQsMjkgKzM3MjQsMjkgQEAgc3RhdGlj
IHZvaWQgaWJ4X2hwZF9kZXRlY3Rpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJICogV2hlbiBDUFUgYW5kIFBDSCBhcmUgb24gdGhlIHNhbWUgcGFja2Fn
ZSwgcG9ydCBBCj4gPiAgIAkgKiBIUEQgbXVzdCBiZSBlbmFibGVkIGluIGJvdGggbm9ydGggYW5k
IHNvdXRoLgo+ID4gICAJICovCj4gPiAtCWlmIChIQVNfUENIX0xQVF9MUChkZXZfcHJpdikpCj4g
PiArCWlmIChIQVNfUENIX0xQVF9MUChpOTE1KSkKPiA+ICAgCQlob3RwbHVnIHw9IFBPUlRBX0hP
VFBMVUdfRU5BQkxFOwo+ID4gICAJSTkxNV9XUklURShQQ0hfUE9SVF9IT1RQTFVHLCBob3RwbHVn
KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGlieF9ocGRfaXJxX3NldHVwKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpYnhfaHBkX2lycV9zZXR1
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIGhvdHBs
dWdfaXJxcywgZW5hYmxlZF9pcnFzOwo+ID4gLQlpZiAoSEFTX1BDSF9JQlgoZGV2X3ByaXYpKSB7
Cj4gPiArCWlmIChIQVNfUENIX0lCWChpOTE1KSkgewo+ID4gICAJCWhvdHBsdWdfaXJxcyA9IFNE
RV9IT1RQTFVHX01BU0s7Cj4gPiAtCQllbmFibGVkX2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9p
cnFzKGRldl9wcml2LCBocGRfaWJ4KTsKPiA+ICsJCWVuYWJsZWRfaXJxcyA9IGludGVsX2hwZF9l
bmFibGVkX2lycXMoaTkxNSwgaHBkX2lieCk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCWhvdHBs
dWdfaXJxcyA9IFNERV9IT1RQTFVHX01BU0tfQ1BUOwo+ID4gLQkJZW5hYmxlZF9pcnFzID0gaW50
ZWxfaHBkX2VuYWJsZWRfaXJxcyhkZXZfcHJpdiwgaHBkX2NwdCk7Cj4gPiArCQllbmFibGVkX2ly
cXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGk5MTUsIGhwZF9jcHQpOwo+ID4gICAJfQo+ID4g
LQlpYnhfZGlzcGxheV9pbnRlcnJ1cHRfdXBkYXRlKGRldl9wcml2LCBob3RwbHVnX2lycXMsIGVu
YWJsZWRfaXJxcyk7Cj4gPiArCWlieF9kaXNwbGF5X2ludGVycnVwdF91cGRhdGUoaTkxNSwgaG90
cGx1Z19pcnFzLCBlbmFibGVkX2lycXMpOwo+ID4gLQlpYnhfaHBkX2RldGVjdGlvbl9zZXR1cChk
ZXZfcHJpdik7Cj4gPiArCWlieF9ocGRfZGV0ZWN0aW9uX3NldHVwKGk5MTUpOwo+ID4gICB9Cj4g
PiAtc3RhdGljIHZvaWQgaWNwX2hwZF9kZXRlY3Rpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGljcF9ocGRfZGV0ZWN0aW9uX3NldHVw
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIgaG90cGx1
ZzsKPiA+IEBAIC0zNzYzLDE5ICszNzYzLDE5IEBAIHN0YXRpYyB2b2lkIGljcF9ocGRfZGV0ZWN0
aW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCUk5MTVf
V1JJVEUoU0hPVFBMVUdfQ1RMX1RDLCBob3RwbHVnKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lk
IGljcF9ocGRfaXJxX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICtzdGF0aWMgdm9pZCBpY3BfaHBkX2lycV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIGhvdHBsdWdfaXJxcywgZW5hYmxlZF9pcnFzOwo+ID4g
ICAJaG90cGx1Z19pcnFzID0gU0RFX0RESV9NQVNLX0lDUCB8IFNERV9UQ19NQVNLX0lDUDsKPiA+
IC0JZW5hYmxlZF9pcnFzID0gaW50ZWxfaHBkX2VuYWJsZWRfaXJxcyhkZXZfcHJpdiwgaHBkX2lj
cCk7Cj4gPiArCWVuYWJsZWRfaXJxcyA9IGludGVsX2hwZF9lbmFibGVkX2lycXMoaTkxNSwgaHBk
X2ljcCk7Cj4gPiAtCWlieF9kaXNwbGF5X2ludGVycnVwdF91cGRhdGUoZGV2X3ByaXYsIGhvdHBs
dWdfaXJxcywgZW5hYmxlZF9pcnFzKTsKPiA+ICsJaWJ4X2Rpc3BsYXlfaW50ZXJydXB0X3VwZGF0
ZShpOTE1LCBob3RwbHVnX2lycXMsIGVuYWJsZWRfaXJxcyk7Cj4gPiAtCWljcF9ocGRfZGV0ZWN0
aW9uX3NldHVwKGRldl9wcml2KTsKPiA+ICsJaWNwX2hwZF9kZXRlY3Rpb25fc2V0dXAoaTkxNSk7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW4xMV9ocGRfZGV0ZWN0aW9uX3NldHVwKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnZW4xMV9ocGRf
ZGV0ZWN0aW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAgIAl1MzIgaG90cGx1ZzsKPiA+IEBAIC0zNzk0LDEyICszNzk0LDEyIEBAIHN0YXRpYyB2b2lk
IGdlbjExX2hwZF9kZXRlY3Rpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gICAJSTkxNV9XUklURShHRU4xMV9UQlRfSE9UUExVR19DVEwsIGhvdHBsdWcpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuMTFfaHBkX2lycV9zZXR1cChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgZ2VuMTFfaHBkX2lycV9zZXR1
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIGhvdHBs
dWdfaXJxcywgZW5hYmxlZF9pcnFzOwo+ID4gICAJdTMyIHZhbDsKPiA+IC0JZW5hYmxlZF9pcnFz
ID0gaW50ZWxfaHBkX2VuYWJsZWRfaXJxcyhkZXZfcHJpdiwgaHBkX2dlbjExKTsKPiA+ICsJZW5h
YmxlZF9pcnFzID0gaW50ZWxfaHBkX2VuYWJsZWRfaXJxcyhpOTE1LCBocGRfZ2VuMTEpOwo+ID4g
ICAJaG90cGx1Z19pcnFzID0gR0VOMTFfREVfVENfSE9UUExVR19NQVNLIHwgR0VOMTFfREVfVEJU
X0hPVFBMVUdfTUFTSzsKPiA+ICAgCXZhbCA9IEk5MTVfUkVBRChHRU4xMV9ERV9IUERfSU1SKTsK
PiA+IEBAIC0zODA3LDE4ICszODA3LDE4IEBAIHN0YXRpYyB2b2lkIGdlbjExX2hwZF9pcnFfc2V0
dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJSTkxNV9XUklURShH
RU4xMV9ERV9IUERfSU1SLCB2YWwpOwo+ID4gICAJUE9TVElOR19SRUFEKEdFTjExX0RFX0hQRF9J
TVIpOwo+ID4gLQlnZW4xMV9ocGRfZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2KTsKPiA+ICsJZ2Vu
MTFfaHBkX2RldGVjdGlvbl9zZXR1cChpOTE1KTsKPiA+IC0JaWYgKElOVEVMX1BDSF9UWVBFKGRl
dl9wcml2KSA+PSBQQ0hfSUNQKQo+ID4gLQkJaWNwX2hwZF9pcnFfc2V0dXAoZGV2X3ByaXYpOwo+
ID4gKwlpZiAoSU5URUxfUENIX1RZUEUoaTkxNSkgPj0gUENIX0lDUCkKPiA+ICsJCWljcF9ocGRf
aXJxX3NldHVwKGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgc3B0X2hwZF9kZXRlY3Rp
b25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2
b2lkIHNwdF9ocGRfZGV0ZWN0aW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsLCBob3RwbHVnOwo+ID4gICAJLyogRGlzcGxheSBXQSAj
MTE3OSBXYUhhcmRIYW5nb25Ib3RQbHVnOiBjbnAgKi8KPiA+IC0JaWYgKEhBU19QQ0hfQ05QKGRl
dl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX1BDSF9DTlAoaTkxNSkpIHsKPiA+ICAgCQl2YWwgPSBJ
OTE1X1JFQUQoU09VVEhfQ0hJQ0tFTjEpOwo+ID4gICAJCXZhbCAmPSB+Q0hBU1NJU19DTEtfUkVR
X0RVUkFUSU9OX01BU0s7Cj4gPiAgIAkJdmFsIHw9IENIQVNTSVNfQ0xLX1JFUV9EVVJBVElPTigw
eGYpOwo+ID4gQEAgLTM4MzgsMTkgKzM4MzgsMTkgQEAgc3RhdGljIHZvaWQgc3B0X2hwZF9kZXRl
Y3Rpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJSTkx
NV9XUklURShQQ0hfUE9SVF9IT1RQTFVHMiwgaG90cGx1Zyk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
dm9pZCBzcHRfaHBkX2lycV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiArc3RhdGljIHZvaWQgc3B0X2hwZF9pcnFfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiBob3RwbHVnX2lycXMsIGVuYWJsZWRfaXJxczsK
PiA+ICAgCWhvdHBsdWdfaXJxcyA9IFNERV9IT1RQTFVHX01BU0tfU1BUOwo+ID4gLQllbmFibGVk
X2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGRldl9wcml2LCBocGRfc3B0KTsKPiA+ICsJ
ZW5hYmxlZF9pcnFzID0gaW50ZWxfaHBkX2VuYWJsZWRfaXJxcyhpOTE1LCBocGRfc3B0KTsKPiA+
IC0JaWJ4X2Rpc3BsYXlfaW50ZXJydXB0X3VwZGF0ZShkZXZfcHJpdiwgaG90cGx1Z19pcnFzLCBl
bmFibGVkX2lycXMpOwo+ID4gKwlpYnhfZGlzcGxheV9pbnRlcnJ1cHRfdXBkYXRlKGk5MTUsIGhv
dHBsdWdfaXJxcywgZW5hYmxlZF9pcnFzKTsKPiA+IC0Jc3B0X2hwZF9kZXRlY3Rpb25fc2V0dXAo
ZGV2X3ByaXYpOwo+ID4gKwlzcHRfaHBkX2RldGVjdGlvbl9zZXR1cChpOTE1KTsKPiA+ICAgfQo+
ID4gLXN0YXRpYyB2b2lkIGlsa19ocGRfZGV0ZWN0aW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbGtfaHBkX2RldGVjdGlvbl9zZXR1
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIGhvdHBs
dWc7Cj4gPiBAQCAtMzg2NiwzMyArMzg2NiwzMyBAQCBzdGF0aWMgdm9pZCBpbGtfaHBkX2RldGVj
dGlvbl9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlJOTE1
X1dSSVRFKERJR0lUQUxfUE9SVF9IT1RQTFVHX0NOVFJMLCBob3RwbHVnKTsKPiA+ICAgfQo+ID4g
LXN0YXRpYyB2b2lkIGlsa19ocGRfaXJxX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbGtfaHBkX2lycV9zZXR1cChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIGhvdHBsdWdfaXJxcywgZW5hYmxl
ZF9pcnFzOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KSB7Cj4gPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gOCkgewo+ID4gICAJCWhvdHBsdWdfaXJxcyA9IEdFTjhfUE9SVF9E
UF9BX0hPVFBMVUc7Cj4gPiAtCQllbmFibGVkX2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFz
KGRldl9wcml2LCBocGRfYmR3KTsKPiA+ICsJCWVuYWJsZWRfaXJxcyA9IGludGVsX2hwZF9lbmFi
bGVkX2lycXMoaTkxNSwgaHBkX2Jkdyk7Cj4gPiAtCQliZHdfdXBkYXRlX3BvcnRfaXJxKGRldl9w
cml2LCBob3RwbHVnX2lycXMsIGVuYWJsZWRfaXJxcyk7Cj4gPiAtCX0gZWxzZSBpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA3KSB7Cj4gPiArCQliZHdfdXBkYXRlX3BvcnRfaXJxKGk5MTUsIGhv
dHBsdWdfaXJxcywgZW5hYmxlZF9pcnFzKTsKPiA+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gNykgewo+ID4gICAJCWhvdHBsdWdfaXJxcyA9IERFX0RQX0FfSE9UUExVR19JVkI7Cj4g
PiAtCQllbmFibGVkX2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGRldl9wcml2LCBocGRf
aXZiKTsKPiA+ICsJCWVuYWJsZWRfaXJxcyA9IGludGVsX2hwZF9lbmFibGVkX2lycXMoaTkxNSwg
aHBkX2l2Yik7Cj4gPiAtCQlpbGtfdXBkYXRlX2Rpc3BsYXlfaXJxKGRldl9wcml2LCBob3RwbHVn
X2lycXMsIGVuYWJsZWRfaXJxcyk7Cj4gPiArCQlpbGtfdXBkYXRlX2Rpc3BsYXlfaXJxKGk5MTUs
IGhvdHBsdWdfaXJxcywgZW5hYmxlZF9pcnFzKTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAgIAkJaG90
cGx1Z19pcnFzID0gREVfRFBfQV9IT1RQTFVHOwo+ID4gLQkJZW5hYmxlZF9pcnFzID0gaW50ZWxf
aHBkX2VuYWJsZWRfaXJxcyhkZXZfcHJpdiwgaHBkX2lsayk7Cj4gPiArCQllbmFibGVkX2lycXMg
PSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGk5MTUsIGhwZF9pbGspOwo+ID4gLQkJaWxrX3VwZGF0
ZV9kaXNwbGF5X2lycShkZXZfcHJpdiwgaG90cGx1Z19pcnFzLCBlbmFibGVkX2lycXMpOwo+ID4g
KwkJaWxrX3VwZGF0ZV9kaXNwbGF5X2lycShpOTE1LCBob3RwbHVnX2lycXMsIGVuYWJsZWRfaXJx
cyk7Cj4gPiAgIAl9Cj4gPiAtCWlsa19ocGRfZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2KTsKPiA+
ICsJaWxrX2hwZF9kZXRlY3Rpb25fc2V0dXAoaTkxNSk7Cj4gPiAtCWlieF9ocGRfaXJxX3NldHVw
KGRldl9wcml2KTsKPiA+ICsJaWJ4X2hwZF9pcnFfc2V0dXAoaTkxNSk7Cj4gPiAgIH0KPiA+IC1z
dGF0aWMgdm9pZCBfX2J4dF9ocGRfZGV0ZWN0aW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBfX2J4dF9ocGRfZGV0ZWN0aW9uX3NldHVw
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgdTMyIGVuYWJs
ZWRfaXJxcykKPiA+ICAgewo+ID4gICAJdTMyIGhvdHBsdWc7Cj4gPiBAQCAtMzkxMSwxMDYgKzM5
MTEsMTA2IEBAIHN0YXRpYyB2b2lkIF9fYnh0X2hwZF9kZXRlY3Rpb25fc2V0dXAoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJICogZm9yIEhQRCBkZXRlY3Rpb24gbG9n
aWMsIHVwZGF0ZSBpdCBiYXNlZCBvbiBWQlQgZmllbGRzLgo+ID4gICAJICovCj4gPiAgIAlpZiAo
KGVuYWJsZWRfaXJxcyAmIEJYVF9ERV9QT1JUX0hQX0RESUEpICYmCj4gPiAtCSAgICBpbnRlbF9i
aW9zX2lzX3BvcnRfaHBkX2ludmVydGVkKGRldl9wcml2LCBQT1JUX0EpKQo+ID4gKwkgICAgaW50
ZWxfYmlvc19pc19wb3J0X2hwZF9pbnZlcnRlZChpOTE1LCBQT1JUX0EpKQo+ID4gICAJCWhvdHBs
dWcgfD0gQlhUX0RESUFfSFBEX0lOVkVSVDsKPiA+ICAgCWlmICgoZW5hYmxlZF9pcnFzICYgQlhU
X0RFX1BPUlRfSFBfRERJQikgJiYKPiA+IC0JICAgIGludGVsX2Jpb3NfaXNfcG9ydF9ocGRfaW52
ZXJ0ZWQoZGV2X3ByaXYsIFBPUlRfQikpCj4gPiArCSAgICBpbnRlbF9iaW9zX2lzX3BvcnRfaHBk
X2ludmVydGVkKGk5MTUsIFBPUlRfQikpCj4gPiAgIAkJaG90cGx1ZyB8PSBCWFRfRERJQl9IUERf
SU5WRVJUOwo+ID4gICAJaWYgKChlbmFibGVkX2lycXMgJiBCWFRfREVfUE9SVF9IUF9ERElDKSAm
Jgo+ID4gLQkgICAgaW50ZWxfYmlvc19pc19wb3J0X2hwZF9pbnZlcnRlZChkZXZfcHJpdiwgUE9S
VF9DKSkKPiA+ICsJICAgIGludGVsX2Jpb3NfaXNfcG9ydF9ocGRfaW52ZXJ0ZWQoaTkxNSwgUE9S
VF9DKSkKPiA+ICAgCQlob3RwbHVnIHw9IEJYVF9ERElDX0hQRF9JTlZFUlQ7Cj4gPiAgIAlJOTE1
X1dSSVRFKFBDSF9QT1JUX0hPVFBMVUcsIGhvdHBsdWcpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgYnh0X2hwZF9kZXRlY3Rpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gK3N0YXRpYyB2b2lkIGJ4dF9ocGRfZGV0ZWN0aW9uX3NldHVwKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCV9fYnh0X2hwZF9kZXRlY3Rpb25fc2V0
dXAoZGV2X3ByaXYsIEJYVF9ERV9QT1JUX0hPVFBMVUdfTUFTSyk7Cj4gPiArCV9fYnh0X2hwZF9k
ZXRlY3Rpb25fc2V0dXAoaTkxNSwgQlhUX0RFX1BPUlRfSE9UUExVR19NQVNLKTsKPiA+ICAgfQo+
ID4gLXN0YXRpYyB2b2lkIGJ4dF9ocGRfaXJxX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBieHRfaHBkX2lycV9zZXR1cChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIGhvdHBsdWdfaXJxcywgZW5h
YmxlZF9pcnFzOwo+ID4gLQllbmFibGVkX2lycXMgPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGRl
dl9wcml2LCBocGRfYnh0KTsKPiA+ICsJZW5hYmxlZF9pcnFzID0gaW50ZWxfaHBkX2VuYWJsZWRf
aXJxcyhpOTE1LCBocGRfYnh0KTsKPiA+ICAgCWhvdHBsdWdfaXJxcyA9IEJYVF9ERV9QT1JUX0hP
VFBMVUdfTUFTSzsKPiA+IC0JYmR3X3VwZGF0ZV9wb3J0X2lycShkZXZfcHJpdiwgaG90cGx1Z19p
cnFzLCBlbmFibGVkX2lycXMpOwo+ID4gKwliZHdfdXBkYXRlX3BvcnRfaXJxKGk5MTUsIGhvdHBs
dWdfaXJxcywgZW5hYmxlZF9pcnFzKTsKPiA+IC0JX19ieHRfaHBkX2RldGVjdGlvbl9zZXR1cChk
ZXZfcHJpdiwgZW5hYmxlZF9pcnFzKTsKPiA+ICsJX19ieHRfaHBkX2RldGVjdGlvbl9zZXR1cChp
OTE1LCBlbmFibGVkX2lycXMpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGlieF9pcnFfcG9z
dGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJdTMyIG1hc2s7Cj4gPiAt
CWlmIChIQVNfUENIX05PUChkZXZfcHJpdikpCj4gPiArCWlmIChIQVNfUENIX05PUChpOTE1KSkK
PiA+ICAgCQlyZXR1cm47Cj4gPiAtCWlmIChIQVNfUENIX0lCWChkZXZfcHJpdikpCj4gPiArCWlm
IChIQVNfUENIX0lCWChpOTE1KSkKPiA+ICAgCQltYXNrID0gU0RFX0dNQlVTIHwgU0RFX0FVWF9N
QVNLIHwgU0RFX1BPSVNPTjsKPiA+IC0JZWxzZSBpZiAoSEFTX1BDSF9DUFQoZGV2X3ByaXYpIHx8
IEhBU19QQ0hfTFBUKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSEFTX1BDSF9DUFQoaTkxNSkg
fHwgSEFTX1BDSF9MUFQoaTkxNSkpCj4gPiAgIAkJbWFzayA9IFNERV9HTUJVU19DUFQgfCBTREVf
QVVYX01BU0tfQ1BUOwo+ID4gICAJZWxzZQo+ID4gICAJCW1hc2sgPSBTREVfR01CVVNfQ1BUOwo+
ID4gLQlnZW4zX2Fzc2VydF9paXJfaXNfemVybygmZGV2X3ByaXYtPnVuY29yZSwgU0RFSUlSKTsK
PiA+ICsJZ2VuM19hc3NlcnRfaWlyX2lzX3plcm8oJmk5MTUtPnVuY29yZSwgU0RFSUlSKTsKPiA+
ICAgCUk5MTVfV1JJVEUoU0RFSU1SLCB+bWFzayk7Cj4gPiAtCWlmIChIQVNfUENIX0lCWChkZXZf
cHJpdikgfHwgSEFTX1BDSF9DUFQoZGV2X3ByaXYpIHx8Cj4gPiAtCSAgICBIQVNfUENIX0xQVChk
ZXZfcHJpdikpCj4gPiAtCQlpYnhfaHBkX2RldGVjdGlvbl9zZXR1cChkZXZfcHJpdik7Cj4gPiAr
CWlmIChIQVNfUENIX0lCWChpOTE1KSB8fCBIQVNfUENIX0NQVChpOTE1KSB8fAo+ID4gKwkgICAg
SEFTX1BDSF9MUFQoaTkxNSkpCj4gPiArCQlpYnhfaHBkX2RldGVjdGlvbl9zZXR1cChpOTE1KTsK
PiA+ICAgCWVsc2UKPiA+IC0JCXNwdF9ocGRfZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2KTsKPiA+
ICsJCXNwdF9ocGRfZGV0ZWN0aW9uX3NldHVwKGk5MTUpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2
b2lkIGdlbjVfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
Owo+ID4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAr
CXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7Cj4gPiAgIAl1MzIg
cG1faXJxcywgZ3RfaXJxczsKPiA+ICAgCXBtX2lycXMgPSBndF9pcnFzID0gMDsKPiA+IC0JZGV2
X3ByaXYtPmd0X2lycV9tYXNrID0gfjA7Cj4gPiAtCWlmIChIQVNfTDNfRFBGKGRldl9wcml2KSkg
ewo+ID4gKwlpOTE1LT5ndF9pcnFfbWFzayA9IH4wOwo+ID4gKwlpZiAoSEFTX0wzX0RQRihpOTE1
KSkgewo+ID4gICAJCS8qIEwzIHBhcml0eSBpbnRlcnJ1cHQgaXMgYWx3YXlzIHVubWFza2VkLiAq
Lwo+ID4gLQkJZGV2X3ByaXYtPmd0X2lycV9tYXNrID0gfkdUX1BBUklUWV9FUlJPUihkZXZfcHJp
dik7Cj4gPiAtCQlndF9pcnFzIHw9IEdUX1BBUklUWV9FUlJPUihkZXZfcHJpdik7Cj4gPiArCQlp
OTE1LT5ndF9pcnFfbWFzayA9IH5HVF9QQVJJVFlfRVJST1IoaTkxNSk7Cj4gPiArCQlndF9pcnFz
IHw9IEdUX1BBUklUWV9FUlJPUihpOTE1KTsKPiA+ICAgCX0KPiA+ICAgCWd0X2lycXMgfD0gR1Rf
UkVOREVSX1VTRVJfSU5URVJSVVBUOwo+ID4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA1KSkgewo+
ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDUpKSB7Cj4gPiAgIAkJZ3RfaXJxcyB8PSBJTEtfQlNEX1VT
RVJfSU5URVJSVVBUOwo+ID4gICAJfSBlbHNlIHsKPiA+ICAgCQlndF9pcnFzIHw9IEdUX0JMVF9V
U0VSX0lOVEVSUlVQVCB8IEdUX0JTRF9VU0VSX0lOVEVSUlVQVDsKPiA+ICAgCX0KPiA+IC0JR0VO
M19JUlFfSU5JVCh1bmNvcmUsIEdULCBkZXZfcHJpdi0+Z3RfaXJxX21hc2ssIGd0X2lycXMpOwo+
ID4gKwlHRU4zX0lSUV9JTklUKHVuY29yZSwgR1QsIGk5MTUtPmd0X2lycV9tYXNrLCBndF9pcnFz
KTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikgewo+ID4gKwlpZiAoSU5URUxf
R0VOKGk5MTUpID49IDYpIHsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIFJQUyBpbnRlcnJ1cHRzIHdp
bGwgZ2V0IGVuYWJsZWQvZGlzYWJsZWQgb24gZGVtYW5kIHdoZW4gUlBTCj4gPiAgIAkJICogaXRz
ZWxmIGlzIGVuYWJsZWQvZGlzYWJsZWQuCj4gPiAgIAkJICovCj4gPiAtCQlpZiAoSEFTX0VOR0lO
RShkZXZfcHJpdiwgVkVDUzApKSB7Cj4gPiArCQlpZiAoSEFTX0VOR0lORShpOTE1LCBWRUNTMCkp
IHsKPiA+ICAgCQkJcG1faXJxcyB8PSBQTV9WRUJPWF9VU0VSX0lOVEVSUlVQVDsKPiA+IC0JCQlk
ZXZfcHJpdi0+cG1faWVyIHw9IFBNX1ZFQk9YX1VTRVJfSU5URVJSVVBUOwo+ID4gKwkJCWk5MTUt
PnBtX2llciB8PSBQTV9WRUJPWF9VU0VSX0lOVEVSUlVQVDsKPiA+ICAgCQl9Cj4gPiAtCQlkZXZf
cHJpdi0+cG1faW1yID0gMHhmZmZmZmZmZjsKPiA+IC0JCUdFTjNfSVJRX0lOSVQodW5jb3JlLCBH
RU42X1BNLCBkZXZfcHJpdi0+cG1faW1yLCBwbV9pcnFzKTsKPiA+ICsJCWk5MTUtPnBtX2ltciA9
IDB4ZmZmZmZmZmY7Cj4gPiArCQlHRU4zX0lSUV9JTklUKHVuY29yZSwgR0VONl9QTSwgaTkxNS0+
cG1faW1yLCBwbV9pcnFzKTsKPiA+ICAgCX0KPiA+ICAgfQo+ID4gICBzdGF0aWMgaW50IGlyb25s
YWtlX2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICB7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+IC0J
c3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ID4gICAJdTMyIGRpc3BsYXlf
bWFzaywgZXh0cmFfbWFzazsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykgewo+
ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDcpIHsKPiA+ICAgCQlkaXNwbGF5X21hc2sgPSAo
REVfTUFTVEVSX0lSUV9DT05UUk9MIHwgREVfR1NFX0lWQiB8Cj4gPiAgIAkJCQlERV9QQ0hfRVZF
TlRfSVZCIHwgREVfQVVYX0NIQU5ORUxfQV9JVkIpOwo+ID4gICAJCWV4dHJhX21hc2sgPSAoREVf
UElQRUNfVkJMQU5LX0lWQiB8IERFX1BJUEVCX1ZCTEFOS19JVkIgfAo+ID4gQEAgLTQwMjUsNzgg
KzQwMjUsNzggQEAgc3RhdGljIGludCBpcm9ubGFrZV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRy
bV9kZXZpY2UgKmRldikKPiA+ICAgCQkJICAgICAgREVfRFBfQV9IT1RQTFVHKTsKPiA+ICAgCX0K
PiA+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19IQVNXRUxMKGk5
MTUpKSB7Cj4gPiAgIAkJZ2VuM19hc3NlcnRfaWlyX2lzX3plcm8odW5jb3JlLCBFRFBfUFNSX0lJ
Uik7Cj4gPiAtCQlpbnRlbF9wc3JfaXJxX2NvbnRyb2woZGV2X3ByaXYsIGRldl9wcml2LT5wc3Iu
ZGVidWcpOwo+ID4gKwkJaW50ZWxfcHNyX2lycV9jb250cm9sKGk5MTUsIGk5MTUtPnBzci5kZWJ1
Zyk7Cj4gPiAgIAkJZGlzcGxheV9tYXNrIHw9IERFX0VEUF9QU1JfSU5UX0hTVzsKPiA+ICAgCX0K
PiA+IC0JZGV2X3ByaXYtPmlycV9tYXNrID0gfmRpc3BsYXlfbWFzazsKPiA+ICsJaTkxNS0+aXJx
X21hc2sgPSB+ZGlzcGxheV9tYXNrOwo+ID4gICAJaWJ4X2lycV9wcmVfcG9zdGluc3RhbGwoZGV2
KTsKPiA+IC0JR0VOM19JUlFfSU5JVCh1bmNvcmUsIERFLCBkZXZfcHJpdi0+aXJxX21hc2ssCj4g
PiArCUdFTjNfSVJRX0lOSVQodW5jb3JlLCBERSwgaTkxNS0+aXJxX21hc2ssCj4gPiAgIAkJICAg
ICAgZGlzcGxheV9tYXNrIHwgZXh0cmFfbWFzayk7Cj4gPiAgIAlnZW41X2d0X2lycV9wb3N0aW5z
dGFsbChkZXYpOwo+ID4gLQlpbGtfaHBkX2RldGVjdGlvbl9zZXR1cChkZXZfcHJpdik7Cj4gPiAr
CWlsa19ocGRfZGV0ZWN0aW9uX3NldHVwKGk5MTUpOwo+ID4gICAJaWJ4X2lycV9wb3N0aW5zdGFs
bChkZXYpOwo+ID4gLQlpZiAoSVNfSVJPTkxBS0VfTShkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElT
X0lST05MQUtFX00oaTkxNSkpIHsKPiA+ICAgCQkvKiBFbmFibGUgUENVIGV2ZW50IGludGVycnVw
dHMKPiA+ICAgCQkgKgo+ID4gICAJCSAqIHNwaW5sb2NraW5nIG5vdCByZXF1aXJlZCBoZXJlIGZv
ciBjb3JyZWN0bmVzcyBzaW5jZSBpbnRlcnJ1cHQKPiA+ICAgCQkgKiBzZXR1cCBpcyBndWFyYW50
ZWVkIHRvIHJ1biBpbiBzaW5nbGUtdGhyZWFkZWQgY29udGV4dC4gQnV0IHdlCj4gPiAgIAkJICog
bmVlZCBpdCB0byBtYWtlIHRoZSBhc3NlcnRfc3Bpbl9sb2NrZWQgaGFwcHkuICovCj4gPiAtCQlz
cGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gLQkJaWxrX2VuYWJsZV9kaXNw
bGF5X2lycShkZXZfcHJpdiwgREVfUENVX0VWRU5UKTsKPiA+IC0JCXNwaW5fdW5sb2NrX2lycSgm
ZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2Nr
KTsKPiA+ICsJCWlsa19lbmFibGVfZGlzcGxheV9pcnEoaTkxNSwgREVfUENVX0VWRU5UKTsKPiA+
ICsJCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gICAJfQo+ID4gICAJcmV0
dXJuIDA7Cj4gPiAgIH0KPiA+IC12b2lkIHZhbGxleXZpZXdfZW5hYmxlX2Rpc3BsYXlfaXJxcyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCB2YWxsZXl2aWV3X2Vu
YWJsZV9kaXNwbGF5X2lycXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsK
PiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJbG9j
a2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmRp
c3BsYXlfaXJxc19lbmFibGVkKQo+ID4gKwlpZiAoaTkxNS0+ZGlzcGxheV9pcnFzX2VuYWJsZWQp
Cj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlkZXZfcHJpdi0+ZGlzcGxheV9pcnFzX2VuYWJsZWQgPSB0
cnVlOwo+ID4gKwlpOTE1LT5kaXNwbGF5X2lycXNfZW5hYmxlZCA9IHRydWU7Cj4gPiAtCWlmIChp
bnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpKSB7Cj4gPiAtCQl2bHZfZGlzcGxheV9pcnFfcmVz
ZXQoZGV2X3ByaXYpOwo+ID4gLQkJdmx2X2Rpc3BsYXlfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2
KTsKPiA+ICsJaWYgKGludGVsX2lycXNfZW5hYmxlZChpOTE1KSkgewo+ID4gKwkJdmx2X2Rpc3Bs
YXlfaXJxX3Jlc2V0KGk5MTUpOwo+ID4gKwkJdmx2X2Rpc3BsYXlfaXJxX3Bvc3RpbnN0YWxsKGk5
MTUpOwo+ID4gICAJfQo+ID4gICB9Cj4gPiAtdm9pZCB2YWxsZXl2aWV3X2Rpc2FibGVfZGlzcGxh
eV9pcnFzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIHZhbGxl
eXZpZXdfZGlzYWJsZV9kaXNwbGF5X2lycXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmlycV9sb2NrKTsK
PiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xvY2spOwo+ID4gLQlpZiAoIWRl
dl9wcml2LT5kaXNwbGF5X2lycXNfZW5hYmxlZCkKPiA+ICsJaWYgKCFpOTE1LT5kaXNwbGF5X2ly
cXNfZW5hYmxlZCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWRldl9wcml2LT5kaXNwbGF5X2lycXNf
ZW5hYmxlZCA9IGZhbHNlOwo+ID4gKwlpOTE1LT5kaXNwbGF5X2lycXNfZW5hYmxlZCA9IGZhbHNl
Owo+ID4gLQlpZiAoaW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSkKPiA+IC0JCXZsdl9kaXNw
bGF5X2lycV9yZXNldChkZXZfcHJpdik7Cj4gPiArCWlmIChpbnRlbF9pcnFzX2VuYWJsZWQoaTkx
NSkpCj4gPiArCQl2bHZfZGlzcGxheV9pcnFfcmVzZXQoaTkxNSk7Cj4gPiAgIH0KPiA+ICAgc3Rh
dGljIGludCB2YWxsZXl2aWV3X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRl
dik7Cj4gPiAgIAlnZW41X2d0X2lycV9wb3N0aW5zdGFsbChkZXYpOwo+ID4gLQlzcGluX2xvY2tf
aXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmRpc3BsYXlfaXJx
c19lbmFibGVkKQo+ID4gLQkJdmx2X2Rpc3BsYXlfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsK
PiA+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGluX2xv
Y2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiArCWlmIChpOTE1LT5kaXNwbGF5X2lycXNfZW5h
YmxlZCkKPiA+ICsJCXZsdl9kaXNwbGF5X2lycV9wb3N0aW5zdGFsbChpOTE1KTsKPiA+ICsJc3Bp
bl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAgIAlJOTE1X1dSSVRFKFZMVl9NQVNU
RVJfSUVSLCBNQVNURVJfSU5URVJSVVBUX0VOQUJMRSk7Cj4gPiAgIAlQT1NUSU5HX1JFQUQoVkxW
X01BU1RFUl9JRVIpOwo+ID4gQEAgLTQxMDQsOSArNDEwNCw5IEBAIHN0YXRpYyBpbnQgdmFsbGV5
dmlld19pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgCXJldHVy
biAwOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuOF9ndF9pcnFfcG9zdGluc3RhbGwoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGdlbjhfZ3Rf
aXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ID4g
KwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ID4gICAJLyog
VGhlc2UgYXJlIGludGVycnVwdHMgd2UnbGwgdG9nZ2xlIHdpdGggdGhlIHJpbmcgbWFzayByZWdp
c3RlciAqLwo+ID4gICAJdTMyIGd0X2ludGVycnVwdHNbXSA9IHsKPiA+IEBAIC00MTI2LDIxICs0
MTI2LDIxIEBAIHN0YXRpYyB2b2lkIGdlbjhfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgR1RfQ09OVEVYVF9TV0lUQ0hfSU5URVJS
VVBUIDw8IEdFTjhfVkVDU19JUlFfU0hJRlQpCj4gPiAgIAl9Owo+ID4gLQlkZXZfcHJpdi0+cG1f
aWVyID0gMHgwOwo+ID4gLQlkZXZfcHJpdi0+cG1faW1yID0gfmRldl9wcml2LT5wbV9pZXI7Cj4g
PiArCWk5MTUtPnBtX2llciA9IDB4MDsKPiA+ICsJaTkxNS0+cG1faW1yID0gfmk5MTUtPnBtX2ll
cjsKPiA+ICAgCUdFTjhfSVJRX0lOSVRfTkRYKHVuY29yZSwgR1QsIDAsIH5ndF9pbnRlcnJ1cHRz
WzBdLCBndF9pbnRlcnJ1cHRzWzBdKTsKPiA+ICAgCUdFTjhfSVJRX0lOSVRfTkRYKHVuY29yZSwg
R1QsIDEsIH5ndF9pbnRlcnJ1cHRzWzFdLCBndF9pbnRlcnJ1cHRzWzFdKTsKPiA+ICAgCS8qCj4g
PiAgIAkgKiBSUFMgaW50ZXJydXB0cyB3aWxsIGdldCBlbmFibGVkL2Rpc2FibGVkIG9uIGRlbWFu
ZCB3aGVuIFJQUyBpdHNlbGYKPiA+ICAgCSAqIGlzIGVuYWJsZWQvZGlzYWJsZWQuIFNhbWUgd2ls
IGJlIHRoZSBjYXNlIGZvciBHdUMgaW50ZXJydXB0cy4KPiA+ICAgCSAqLwo+ID4gLQlHRU44X0lS
UV9JTklUX05EWCh1bmNvcmUsIEdULCAyLCBkZXZfcHJpdi0+cG1faW1yLCBkZXZfcHJpdi0+cG1f
aWVyKTsKPiA+ICsJR0VOOF9JUlFfSU5JVF9ORFgodW5jb3JlLCBHVCwgMiwgaTkxNS0+cG1faW1y
LCBpOTE1LT5wbV9pZXIpOwo+ID4gICAJR0VOOF9JUlFfSU5JVF9ORFgodW5jb3JlLCBHVCwgMywg
fmd0X2ludGVycnVwdHNbM10sIGd0X2ludGVycnVwdHNbM10pOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IHZvaWQgZ2VuOF9kZV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGdlbjhfZGVfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ID4gICAJdTMyIGRlX3BpcGVfbWFza2VkID0gR0VOOF9Q
SVBFX0NEQ0xLX0NSQ19ET05FOwo+ID4gICAJdTMyIGRlX3BpcGVfZW5hYmxlczsKPiA+IEBAIC00
MTQ5LDg0ICs0MTQ5LDg0IEBAIHN0YXRpYyB2b2lkIGdlbjhfZGVfaXJxX3Bvc3RpbnN0YWxsKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXUzMiBkZV9taXNjX21hc2tl
ZCA9IEdFTjhfREVfRURQX1BTUjsKPiA+ICAgCWVudW0gcGlwZSBwaXBlOwo+ID4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA8PSAxMCkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8PSAxMCkK
PiA+ICAgCQlkZV9taXNjX21hc2tlZCB8PSBHRU44X0RFX01JU0NfR1NFOwo+ID4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkg
ewo+ID4gICAJCWRlX3BpcGVfbWFza2VkIHw9IEdFTjlfREVfUElQRV9JUlFfRkFVTFRfRVJST1JT
Owo+ID4gICAJCWRlX3BvcnRfbWFza2VkIHw9IEdFTjlfQVVYX0NIQU5ORUxfQiB8IEdFTjlfQVVY
X0NIQU5ORUxfQyB8Cj4gPiAgIAkJCQkgIEdFTjlfQVVYX0NIQU5ORUxfRDsKPiA+IC0JCWlmIChJ
U19HRU45X0xQKGRldl9wcml2KSkKPiA+ICsJCWlmIChJU19HRU45X0xQKGk5MTUpKQo+ID4gICAJ
CQlkZV9wb3J0X21hc2tlZCB8PSBCWFRfREVfUE9SVF9HTUJVUzsKPiA+ICAgCX0gZWxzZSB7Cj4g
PiAgIAkJZGVfcGlwZV9tYXNrZWQgfD0gR0VOOF9ERV9QSVBFX0lSUV9GQVVMVF9FUlJPUlM7Cj4g
PiAgIAl9Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ID4gKwlpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDExKQo+ID4gICAJCWRlX3BvcnRfbWFza2VkIHw9IElDTF9BVVhfQ0hB
Tk5FTF9FOwo+ID4gLQlpZiAoSVNfQ05MX1dJVEhfUE9SVF9GKGRldl9wcml2KSB8fCBJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDExKQo+ID4gKwlpZiAoSVNfQ05MX1dJVEhfUE9SVF9GKGk5MTUpIHx8
IElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICAgCQlkZV9wb3J0X21hc2tlZCB8PSBDTkxfQVVY
X0NIQU5ORUxfRjsKPiA+ICAgCWRlX3BpcGVfZW5hYmxlcyA9IGRlX3BpcGVfbWFza2VkIHwgR0VO
OF9QSVBFX1ZCTEFOSyB8Cj4gPiAgIAkJCQkJICAgR0VOOF9QSVBFX0ZJRk9fVU5ERVJSVU47Cj4g
PiAgIAlkZV9wb3J0X2VuYWJsZXMgPSBkZV9wb3J0X21hc2tlZDsKPiA+IC0JaWYgKElTX0dFTjlf
TFAoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiA+ICAgCQlkZV9wb3J0
X2VuYWJsZXMgfD0gQlhUX0RFX1BPUlRfSE9UUExVR19NQVNLOwo+ID4gLQllbHNlIGlmIChJU19C
Uk9BRFdFTEwoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpCj4g
PiAgIAkJZGVfcG9ydF9lbmFibGVzIHw9IEdFTjhfUE9SVF9EUF9BX0hPVFBMVUc7Cj4gPiAgIAln
ZW4zX2Fzc2VydF9paXJfaXNfemVybyh1bmNvcmUsIEVEUF9QU1JfSUlSKTsKPiA+IC0JaW50ZWxf
cHNyX2lycV9jb250cm9sKGRldl9wcml2LCBkZXZfcHJpdi0+cHNyLmRlYnVnKTsKPiA+ICsJaW50
ZWxfcHNyX2lycV9jb250cm9sKGk5MTUsIGk5MTUtPnBzci5kZWJ1Zyk7Cj4gPiAtCWZvcl9lYWNo
X3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKPiA+IC0JCWRldl9wcml2LT5kZV9pcnFfbWFza1twaXBl
XSA9IH5kZV9waXBlX21hc2tlZDsKPiA+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4g
PiArCQlpOTE1LT5kZV9pcnFfbWFza1twaXBlXSA9IH5kZV9waXBlX21hc2tlZDsKPiA+IC0JCWlm
IChpbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoZGV2X3ByaXYsCj4gPiArCQlpZiAoaW50
ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGk5MTUsCj4gPiAgIAkJCQlQT1dFUl9ET01BSU5f
UElQRShwaXBlKSkpCj4gPiAgIAkJCUdFTjhfSVJRX0lOSVRfTkRYKHVuY29yZSwgREVfUElQRSwg
cGlwZSwKPiA+IC0JCQkJCSAgZGV2X3ByaXYtPmRlX2lycV9tYXNrW3BpcGVdLAo+ID4gKwkJCQkJ
ICBpOTE1LT5kZV9pcnFfbWFza1twaXBlXSwKPiA+ICAgCQkJCQkgIGRlX3BpcGVfZW5hYmxlcyk7
Cj4gPiAgIAl9Cj4gPiAgIAlHRU4zX0lSUV9JTklUKHVuY29yZSwgR0VOOF9ERV9QT1JUXywgfmRl
X3BvcnRfbWFza2VkLCBkZV9wb3J0X2VuYWJsZXMpOwo+ID4gICAJR0VOM19JUlFfSU5JVCh1bmNv
cmUsIEdFTjhfREVfTUlTQ18sIH5kZV9taXNjX21hc2tlZCwgZGVfbWlzY19tYXNrZWQpOwo+ID4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5
MTUpID49IDExKSB7Cj4gPiAgIAkJdTMyIGRlX2hwZF9tYXNrZWQgPSAwOwo+ID4gICAJCXUzMiBk
ZV9ocGRfZW5hYmxlcyA9IEdFTjExX0RFX1RDX0hPVFBMVUdfTUFTSyB8Cj4gPiAgIAkJCQkgICAg
IEdFTjExX0RFX1RCVF9IT1RQTFVHX01BU0s7Cj4gPiAgIAkJR0VOM19JUlFfSU5JVCh1bmNvcmUs
IEdFTjExX0RFX0hQRF8sIH5kZV9ocGRfbWFza2VkLAo+ID4gICAJCQkgICAgICBkZV9ocGRfZW5h
Ymxlcyk7Cj4gPiAtCQlnZW4xMV9ocGRfZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2KTsKPiA+IC0J
fSBlbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewo+ID4gLQkJYnh0X2hwZF9kZXRlY3Rp
b25fc2V0dXAoZGV2X3ByaXYpOwo+ID4gLQl9IGVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJp
dikpIHsKPiA+IC0JCWlsa19ocGRfZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2KTsKPiA+ICsJCWdl
bjExX2hwZF9kZXRlY3Rpb25fc2V0dXAoaTkxNSk7Cj4gPiArCX0gZWxzZSBpZiAoSVNfR0VOOV9M
UChpOTE1KSkgewo+ID4gKwkJYnh0X2hwZF9kZXRlY3Rpb25fc2V0dXAoaTkxNSk7Cj4gPiArCX0g
ZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gPiArCQlpbGtfaHBkX2RldGVjdGlvbl9z
ZXR1cChpOTE1KTsKPiA+ICAgCX0KPiA+ICAgfQo+ID4gICBzdGF0aWMgaW50IGdlbjhfaXJxX3Bv
c3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+IC0JaWYgKEhBU19QQ0hfU1BM
SVQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkKPiA+ICAgCQlpYnhf
aXJxX3ByZV9wb3N0aW5zdGFsbChkZXYpOwo+ID4gLQlnZW44X2d0X2lycV9wb3N0aW5zdGFsbChk
ZXZfcHJpdik7Cj4gPiAtCWdlbjhfZGVfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKPiA+ICsJ
Z2VuOF9ndF9pcnFfcG9zdGluc3RhbGwoaTkxNSk7Cj4gPiArCWdlbjhfZGVfaXJxX3Bvc3RpbnN0
YWxsKGk5MTUpOwo+ID4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpCj4gPiArCWlmIChI
QVNfUENIX1NQTElUKGk5MTUpKQo+ID4gICAJCWlieF9pcnFfcG9zdGluc3RhbGwoZGV2KTsKPiA+
IC0JZ2VuOF9tYXN0ZXJfaW50cl9lbmFibGUoZGV2X3ByaXYtPnVuY29yZS5yZWdzKTsKPiA+ICsJ
Z2VuOF9tYXN0ZXJfaW50cl9lbmFibGUoaTkxNS0+dW5jb3JlLnJlZ3MpOwo+ID4gICAJcmV0dXJu
IDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW4xMV9ndF9pcnFfcG9zdGluc3RhbGwoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGdlbjExX2d0
X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+
ID4gICAJY29uc3QgdTMyIGlycXMgPSBHVF9SRU5ERVJfVVNFUl9JTlRFUlJVUFQgfCBHVF9DT05U
RVhUX1NXSVRDSF9JTlRFUlJVUFQ7Cj4gPiBAQCAtNDI0Nyw4ICs0MjQ3LDggQEAgc3RhdGljIHZv
aWQgZ2VuMTFfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICAgCSAqIFJQUyBpbnRlcnJ1cHRzIHdpbGwgZ2V0IGVuYWJsZWQvZGlzYWJsZWQg
b24gZGVtYW5kIHdoZW4gUlBTIGl0c2VsZgo+ID4gICAJICogaXMgZW5hYmxlZC9kaXNhYmxlZC4K
PiA+ICAgCSAqLwo+ID4gLQlkZXZfcHJpdi0+cG1faWVyID0gMHgwOwo+ID4gLQlkZXZfcHJpdi0+
cG1faW1yID0gfmRldl9wcml2LT5wbV9pZXI7Cj4gPiArCWk5MTUtPnBtX2llciA9IDB4MDsKPiA+
ICsJaTkxNS0+cG1faW1yID0gfmk5MTUtPnBtX2llcjsKPiA+ICAgCUk5MTVfV1JJVEUoR0VOMTFf
R1BNX1dHQk9YUEVSRl9JTlRSX0VOQUJMRSwgMCk7Cj4gPiAgIAlJOTE1X1dSSVRFKEdFTjExX0dQ
TV9XR0JPWFBFUkZfSU5UUl9NQVNLLCAgfjApOwo+ID4gQEAgLTQyNTksMzYgKzQyNTksMzYgQEAg
c3RhdGljIHZvaWQgZ2VuMTFfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICAgc3RhdGljIHZvaWQgaWNwX2lycV9wb3N0aW5zdGFsbChzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAl1MzIgbWFzayA9IFNERV9HTUJVU19JQ1A7Cj4g
PiAgIAlXQVJOX09OKEk5MTVfUkVBRChTREVJRVIpICE9IDApOwo+ID4gICAJSTkxNV9XUklURShT
REVJRVIsIDB4ZmZmZmZmZmYpOwo+ID4gICAJUE9TVElOR19SRUFEKFNERUlFUik7Cj4gPiAtCWdl
bjNfYXNzZXJ0X2lpcl9pc196ZXJvKCZkZXZfcHJpdi0+dW5jb3JlLCBTREVJSVIpOwo+ID4gKwln
ZW4zX2Fzc2VydF9paXJfaXNfemVybygmaTkxNS0+dW5jb3JlLCBTREVJSVIpOwo+ID4gICAJSTkx
NV9XUklURShTREVJTVIsIH5tYXNrKTsKPiA+IC0JaWNwX2hwZF9kZXRlY3Rpb25fc2V0dXAoZGV2
X3ByaXYpOwo+ID4gKwlpY3BfaHBkX2RldGVjdGlvbl9zZXR1cChpOTE1KTsKPiA+ICAgfQo+ID4g
ICBzdGF0aWMgaW50IGdlbjExX2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRldi0+
ZGV2X3ByaXZhdGU7Cj4gPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJp
di0+dW5jb3JlOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRldi0+ZGV2
X3ByaXZhdGU7Cj4gPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNv
cmU7Cj4gPiAgIAl1MzIgZ3VfbWlzY19tYXNrZWQgPSBHRU4xMV9HVV9NSVNDX0dTRTsKPiA+IC0J
aWYgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA+PSBQQ0hfSUNQKQo+ID4gKwlpZiAoSU5URUxf
UENIX1RZUEUoaTkxNSkgPj0gUENIX0lDUCkKPiA+ICAgCQlpY3BfaXJxX3Bvc3RpbnN0YWxsKGRl
dik7Cj4gPiAtCWdlbjExX2d0X2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7Cj4gPiAtCWdlbjhf
ZGVfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKPiA+ICsJZ2VuMTFfZ3RfaXJxX3Bvc3RpbnN0
YWxsKGk5MTUpOwo+ID4gKwlnZW44X2RlX2lycV9wb3N0aW5zdGFsbChpOTE1KTsKPiA+ICAgCUdF
TjNfSVJRX0lOSVQodW5jb3JlLCBHRU4xMV9HVV9NSVNDXywgfmd1X21pc2NfbWFza2VkLCBndV9t
aXNjX21hc2tlZCk7Cj4gPiAgIAlJOTE1X1dSSVRFKEdFTjExX0RJU1BMQVlfSU5UX0NUTCwgR0VO
MTFfRElTUExBWV9JUlFfRU5BQkxFKTsKPiA+IC0JZ2VuMTFfbWFzdGVyX2ludHJfZW5hYmxlKGRl
dl9wcml2LT51bmNvcmUucmVncyk7Cj4gPiArCWdlbjExX21hc3Rlcl9pbnRyX2VuYWJsZShpOTE1
LT51bmNvcmUucmVncyk7Cj4gPiAgIAlQT1NUSU5HX1JFQUQoR0VOMTFfR0ZYX01TVFJfSVJRKTsK
PiA+ICAgCXJldHVybiAwOwo+ID4gQEAgLTQyOTYsMTQgKzQyOTYsMTQgQEAgc3RhdGljIGludCBn
ZW4xMV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgc3RhdGlj
IGludCBjaGVycnl2aWV3X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7
Cj4gPiAtCWdlbjhfZ3RfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKPiA+ICsJZ2VuOF9ndF9p
cnFfcG9zdGluc3RhbGwoaTkxNSk7Cj4gPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFf
bG9jayk7Cj4gPiAtCWlmIChkZXZfcHJpdi0+ZGlzcGxheV9pcnFzX2VuYWJsZWQpCj4gPiAtCQl2
bHZfZGlzcGxheV9pcnFfcG9zdGluc3RhbGwoZGV2X3ByaXYpOwo+ID4gLQlzcGluX3VubG9ja19p
cnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9s
b2NrKTsKPiA+ICsJaWYgKGk5MTUtPmRpc3BsYXlfaXJxc19lbmFibGVkKQo+ID4gKwkJdmx2X2Rp
c3BsYXlfaXJxX3Bvc3RpbnN0YWxsKGk5MTUpOwo+ID4gKwlzcGluX3VubG9ja19pcnEoJmk5MTUt
PmlycV9sb2NrKTsKPiA+ICAgCUk5MTVfV1JJVEUoR0VOOF9NQVNURVJfSVJRLCBHRU44X01BU1RF
Ul9JUlFfQ09OVFJPTCk7Cj4gPiAgIAlQT1NUSU5HX1JFQUQoR0VOOF9NQVNURVJfSVJRKTsKPiA+
IEBAIC00MzEzLDE4ICs0MzEzLDE4IEBAIHN0YXRpYyBpbnQgY2hlcnJ5dmlld19pcnFfcG9zdGlu
c3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgc3RhdGljIHZvaWQgaTh4eF9pcnFf
cmVzZXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiAtCXN0cnVjdCBpbnRlbF91
bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAq
dW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiA+IC0JaTl4eF9waXBlc3RhdF9pcnFfcmVzZXQoZGV2
X3ByaXYpOwo+ID4gKwlpOXh4X3BpcGVzdGF0X2lycV9yZXNldChpOTE1KTsKPiA+ICAgCUdFTjJf
SVJRX1JFU0VUKHVuY29yZSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGludCBpOHh4X2lycV9wb3N0
aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+IC0Jc3RydWN0IGludGVs
X3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3Jl
ICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ID4gICAJdTE2IGVuYWJsZV9tYXNrOwo+ID4gICAJ
aW50ZWxfdW5jb3JlX3dyaXRlMTYodW5jb3JlLAo+ID4gQEAgLTQzMzMsNyArNDMzMyw3IEBAIHN0
YXRpYyBpbnQgaTh4eF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+
ICAgCQkJICAgICAgIEk5MTVfRVJST1JfTUVNT1JZX1JFRlJFU0gpKTsKPiA+ICAgCS8qIFVubWFz
ayB0aGUgaW50ZXJydXB0cyB0aGF0IHdlIGFsd2F5cyB3YW50IG9uLiAqLwo+ID4gLQlkZXZfcHJp
di0+aXJxX21hc2sgPQo+ID4gKwlpOTE1LT5pcnFfbWFzayA9Cj4gPiAgIAkJfihJOTE1X0RJU1BM
QVlfUElQRV9BX0VWRU5UX0lOVEVSUlVQVCB8Cj4gPiAgIAkJICBJOTE1X0RJU1BMQVlfUElQRV9C
X0VWRU5UX0lOVEVSUlVQVCB8Cj4gPiAgIAkJICBJOTE1X01BU1RFUl9FUlJPUl9JTlRFUlJVUFQp
Owo+ID4gQEAgLTQzNDQsMTQgKzQzNDQsMTQgQEAgc3RhdGljIGludCBpOHh4X2lycV9wb3N0aW5z
dGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICAJCUk5MTVfTUFTVEVSX0VSUk9SX0lO
VEVSUlVQVCB8Cj4gPiAgIAkJSTkxNV9VU0VSX0lOVEVSUlVQVDsKPiA+IC0JR0VOMl9JUlFfSU5J
VCh1bmNvcmUsIGRldl9wcml2LT5pcnFfbWFzaywgZW5hYmxlX21hc2spOwo+ID4gKwlHRU4yX0lS
UV9JTklUKHVuY29yZSwgaTkxNS0+aXJxX21hc2ssIGVuYWJsZV9tYXNrKTsKPiA+ICAgCS8qIElu
dGVycnVwdCBzZXR1cCBpcyBhbHJlYWR5IGd1YXJhbnRlZWQgdG8gYmUgc2luZ2xlLXRocmVhZGVk
LCB0aGlzIGlzCj4gPiAgIAkgKiBqdXN0IHRvIG1ha2UgdGhlIGFzc2VydF9zcGluX2xvY2tlZCBj
aGVjayBoYXBweS4gKi8KPiA+IC0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsK
PiA+IC0JaTkxNV9lbmFibGVfcGlwZXN0YXQoZGV2X3ByaXYsIFBJUEVfQSwgUElQRV9DUkNfRE9O
RV9JTlRFUlJVUFRfU1RBVFVTKTsKPiA+IC0JaTkxNV9lbmFibGVfcGlwZXN0YXQoZGV2X3ByaXYs
IFBJUEVfQiwgUElQRV9DUkNfRE9ORV9JTlRFUlJVUFRfU1RBVFVTKTsKPiA+IC0Jc3Bpbl91bmxv
Y2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5p
cnFfbG9jayk7Cj4gPiArCWk5MTVfZW5hYmxlX3BpcGVzdGF0KGk5MTUsIFBJUEVfQSwgUElQRV9D
UkNfRE9ORV9JTlRFUlJVUFRfU1RBVFVTKTsKPiA+ICsJaTkxNV9lbmFibGVfcGlwZXN0YXQoaTkx
NSwgUElQRV9CLCBQSVBFX0NSQ19ET05FX0lOVEVSUlVQVF9TVEFUVVMpOwo+ID4gKwlzcGluX3Vu
bG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiBA
QCAtNDM4Niw3ICs0Mzg2LDcgQEAgc3RhdGljIHZvaWQgaTh4eF9lcnJvcl9pcnFfYWNrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJaW50ZWxfdW5jb3JlX3dyaXRlMTYodW5j
b3JlLCBFTVIsIGVtciB8ICplaXJfc3R1Y2spOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaTh4
eF9lcnJvcl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiArc3RhdGljIHZvaWQgaTh4eF9lcnJvcl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgIHUxNiBlaXIsIHUxNiBlaXJfc3R1Y2spCj4gPiAgIHsK
PiA+ICAgCURSTV9ERUJVRygiTWFzdGVyIEVycm9yOiBFSVIgMHglMDR4XG4iLCBlaXIpOwo+ID4g
QEAgLTQzOTUsNyArNDM5NSw3IEBAIHN0YXRpYyB2b2lkIGk4eHhfZXJyb3JfaXJxX2hhbmRsZXIo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCURSTV9ERUJVR19EUklW
RVIoIkVJUiBzdHVjazogMHglMDR4LCBtYXNrZWRcbiIsIGVpcl9zdHVjayk7Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgdm9pZCBpOXh4X2Vycm9yX2lycV9hY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGk5eHhfZXJyb3JfaXJxX2FjayhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgIHUzMiAqZWlyLCB1MzIgKmVpcl9z
dHVjaykKPiA+ICAgewo+ID4gICAJdTMyIGVtcjsKPiA+IEBAIC00NDIzLDcgKzQ0MjMsNyBAQCBz
dGF0aWMgdm9pZCBpOXh4X2Vycm9yX2lycV9hY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAJSTkxNV9XUklURShFTVIsIGVtciB8ICplaXJfc3R1Y2spOwo+ID4gICB9
Cj4gPiAtc3RhdGljIHZvaWQgaTl4eF9lcnJvcl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaTl4eF9lcnJvcl9pcnFfaGFuZGxl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgIHUzMiBlaXIsIHUz
MiBlaXJfc3R1Y2spCj4gPiAgIHsKPiA+ICAgCURSTV9ERUJVRygiTWFzdGVyIEVycm9yLCBFSVIg
MHglMDh4XG4iLCBlaXIpOwo+ID4gQEAgLTQ0MzUsMjEgKzQ0MzUsMjEgQEAgc3RhdGljIHZvaWQg
aTl4eF9lcnJvcl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiAgIHN0YXRpYyBpcnFyZXR1cm5fdCBpOHh4X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQg
KmFyZykKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGFyZzsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCWlycXJl
dHVybl90IHJldCA9IElSUV9OT05FOwo+ID4gLQlpZiAoIWludGVsX2lycXNfZW5hYmxlZChkZXZf
cHJpdikpCj4gPiArCWlmICghaW50ZWxfaXJxc19lbmFibGVkKGk5MTUpKQo+ID4gICAJCXJldHVy
biBJUlFfTk9ORTsKPiA+ICAgCS8qIElSUXMgYXJlIHN5bmNlZCBkdXJpbmcgcnVudGltZV9zdXNw
ZW5kLCB3ZSBkb24ndCByZXF1aXJlIGEgd2FrZXJlZiAqLwo+ID4gLQlkaXNhYmxlX3JwbV93YWtl
cmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ID4gKwlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMo
aTkxNSk7Cj4gPiAgIAlkbyB7Cj4gPiAgIAkJdTMyIHBpcGVfc3RhdHNbSTkxNV9NQVhfUElQRVNd
ID0ge307Cj4gPiAgIAkJdTE2IGVpciA9IDAsIGVpcl9zdHVjayA9IDA7Cj4gPiAgIAkJdTE2IGlp
cjsKPiA+IC0JCWlpciA9IGludGVsX3VuY29yZV9yZWFkMTYoJmRldl9wcml2LT51bmNvcmUsIEdF
TjJfSUlSKTsKPiA+ICsJCWlpciA9IGludGVsX3VuY29yZV9yZWFkMTYoJmk5MTUtPnVuY29yZSwg
R0VOMl9JSVIpOwo+ID4gICAJCWlmIChpaXIgPT0gMCkKPiA+ICAgCQkJYnJlYWs7Cj4gPiBAQCAt
NDQ1Nyw1MyArNDQ1Nyw1MyBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgaTh4eF9pcnFfaGFuZGxlcihp
bnQgaXJxLCB2b2lkICphcmcpCj4gPiAgIAkJLyogQ2FsbCByZWdhcmRsZXNzLCBhcyBzb21lIHN0
YXR1cyBiaXRzIG1pZ2h0IG5vdCBiZQo+ID4gICAJCSAqIHNpZ25hbGxlZCBpbiBpaXIgKi8KPiA+
IC0JCWk5eHhfcGlwZXN0YXRfaXJxX2FjayhkZXZfcHJpdiwgaWlyLCBwaXBlX3N0YXRzKTsKPiA+
ICsJCWk5eHhfcGlwZXN0YXRfaXJxX2FjayhpOTE1LCBpaXIsIHBpcGVfc3RhdHMpOwo+ID4gICAJ
CWlmIChpaXIgJiBJOTE1X01BU1RFUl9FUlJPUl9JTlRFUlJVUFQpCj4gPiAtCQkJaTh4eF9lcnJv
cl9pcnFfYWNrKGRldl9wcml2LCAmZWlyLCAmZWlyX3N0dWNrKTsKPiA+ICsJCQlpOHh4X2Vycm9y
X2lycV9hY2soaTkxNSwgJmVpciwgJmVpcl9zdHVjayk7Cj4gPiAtCQlpbnRlbF91bmNvcmVfd3Jp
dGUxNigmZGV2X3ByaXYtPnVuY29yZSwgR0VOMl9JSVIsIGlpcik7Cj4gPiArCQlpbnRlbF91bmNv
cmVfd3JpdGUxNigmaTkxNS0+dW5jb3JlLCBHRU4yX0lJUiwgaWlyKTsKPiA+ICAgCQlpZiAoaWly
ICYgSTkxNV9VU0VSX0lOVEVSUlVQVCkKPiA+IC0JCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNf
aXJxKGRldl9wcml2LT5lbmdpbmVbUkNTMF0pOwo+ID4gKwkJCWludGVsX2VuZ2luZV9icmVhZGNy
dW1ic19pcnEoaTkxNS0+ZW5naW5lW1JDUzBdKTsKPiA+ICAgCQlpZiAoaWlyICYgSTkxNV9NQVNU
RVJfRVJST1JfSU5URVJSVVBUKQo+ID4gLQkJCWk4eHhfZXJyb3JfaXJxX2hhbmRsZXIoZGV2X3By
aXYsIGVpciwgZWlyX3N0dWNrKTsKPiA+ICsJCQlpOHh4X2Vycm9yX2lycV9oYW5kbGVyKGk5MTUs
IGVpciwgZWlyX3N0dWNrKTsKPiA+IC0JCWk4eHhfcGlwZXN0YXRfaXJxX2hhbmRsZXIoZGV2X3By
aXYsIGlpciwgcGlwZV9zdGF0cyk7Cj4gPiArCQlpOHh4X3BpcGVzdGF0X2lycV9oYW5kbGVyKGk5
MTUsIGlpciwgcGlwZV9zdGF0cyk7Cj4gPiAgIAl9IHdoaWxlICgwKTsKPiA+IC0JZW5hYmxlX3Jw
bV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ID4gKwllbmFibGVfcnBtX3dha2VyZWZfYXNz
ZXJ0cyhpOTE1KTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQg
aTkxNV9pcnFfcmVzZXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiAtCXN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGludGVs
X3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiA+IC0JaWYgKEk5MTVfSEFTX0hPVFBM
VUcoZGV2X3ByaXYpKSB7Cj4gPiAtCQlpOTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0ZShkZXZf
cHJpdiwgMHhmZmZmZmZmZiwgMCk7Cj4gPiArCWlmIChJOTE1X0hBU19IT1RQTFVHKGk5MTUpKSB7
Cj4gPiArCQlpOTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0ZShpOTE1LCAweGZmZmZmZmZmLCAw
KTsKPiA+ICAgCQlJOTE1X1dSSVRFKFBPUlRfSE9UUExVR19TVEFULCBJOTE1X1JFQUQoUE9SVF9I
T1RQTFVHX1NUQVQpKTsKPiA+ICAgCX0KPiA+IC0JaTl4eF9waXBlc3RhdF9pcnFfcmVzZXQoZGV2
X3ByaXYpOwo+ID4gKwlpOXh4X3BpcGVzdGF0X2lycV9yZXNldChpOTE1KTsKPiA+ICAgCUdFTjNf
SVJRX1JFU0VUKHVuY29yZSwgR0VOMl8pOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9p
cnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiAtCXN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGludGVs
X3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiA+ICAgCXUzMiBlbmFibGVfbWFzazsK
PiA+ICAgCUk5MTVfV1JJVEUoRU1SLCB+KEk5MTVfRVJST1JfUEFHRV9UQUJMRSB8Cj4gPiAgIAkJ
CSAgSTkxNV9FUlJPUl9NRU1PUllfUkVGUkVTSCkpOwo+ID4gICAJLyogVW5tYXNrIHRoZSBpbnRl
cnJ1cHRzIHRoYXQgd2UgYWx3YXlzIHdhbnQgb24uICovCj4gPiAtCWRldl9wcml2LT5pcnFfbWFz
ayA9Cj4gPiArCWk5MTUtPmlycV9tYXNrID0KPiA+ICAgCQl+KEk5MTVfQVNMRV9JTlRFUlJVUFQg
fAo+ID4gICAJCSAgSTkxNV9ESVNQTEFZX1BJUEVfQV9FVkVOVF9JTlRFUlJVUFQgfAo+ID4gICAJ
CSAgSTkxNV9ESVNQTEFZX1BJUEVfQl9FVkVOVF9JTlRFUlJVUFQgfAo+ID4gQEAgLTQ1MTYsMjMg
KzQ1MTYsMjMgQEAgc3RhdGljIGludCBpOTE1X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2KQo+ID4gICAJCUk5MTVfTUFTVEVSX0VSUk9SX0lOVEVSUlVQVCB8Cj4gPiAgIAkJ
STkxNV9VU0VSX0lOVEVSUlVQVDsKPiA+IC0JaWYgKEk5MTVfSEFTX0hPVFBMVUcoZGV2X3ByaXYp
KSB7Cj4gPiArCWlmIChJOTE1X0hBU19IT1RQTFVHKGk5MTUpKSB7Cj4gPiAgIAkJLyogRW5hYmxl
IGluIElFUi4uLiAqLwo+ID4gICAJCWVuYWJsZV9tYXNrIHw9IEk5MTVfRElTUExBWV9QT1JUX0lO
VEVSUlVQVDsKPiA+ICAgCQkvKiBhbmQgdW5tYXNrIGluIElNUiAqLwo+ID4gLQkJZGV2X3ByaXYt
PmlycV9tYXNrICY9IH5JOTE1X0RJU1BMQVlfUE9SVF9JTlRFUlJVUFQ7Cj4gPiArCQlpOTE1LT5p
cnFfbWFzayAmPSB+STkxNV9ESVNQTEFZX1BPUlRfSU5URVJSVVBUOwo+ID4gICAJfQo+ID4gLQlH
RU4zX0lSUV9JTklUKHVuY29yZSwgR0VOMl8sIGRldl9wcml2LT5pcnFfbWFzaywgZW5hYmxlX21h
c2spOwo+ID4gKwlHRU4zX0lSUV9JTklUKHVuY29yZSwgR0VOMl8sIGk5MTUtPmlycV9tYXNrLCBl
bmFibGVfbWFzayk7Cj4gPiAgIAkvKiBJbnRlcnJ1cHQgc2V0dXAgaXMgYWxyZWFkeSBndWFyYW50
ZWVkIHRvIGJlIHNpbmdsZS10aHJlYWRlZCwgdGhpcyBpcwo+ID4gICAJICoganVzdCB0byBtYWtl
IHRoZSBhc3NlcnRfc3Bpbl9sb2NrZWQgY2hlY2sgaGFwcHkuICovCj4gPiAtCXNwaW5fbG9ja19p
cnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAtCWk5MTVfZW5hYmxlX3BpcGVzdGF0KGRldl9w
cml2LCBQSVBFX0EsIFBJUEVfQ1JDX0RPTkVfSU5URVJSVVBUX1NUQVRVUyk7Cj4gPiAtCWk5MTVf
ZW5hYmxlX3BpcGVzdGF0KGRldl9wcml2LCBQSVBFX0IsIFBJUEVfQ1JDX0RPTkVfSU5URVJSVVBU
X1NUQVRVUyk7Cj4gPiAtCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+
ICsJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gKwlpOTE1X2VuYWJsZV9waXBl
c3RhdChpOTE1LCBQSVBFX0EsIFBJUEVfQ1JDX0RPTkVfSU5URVJSVVBUX1NUQVRVUyk7Cj4gPiAr
CWk5MTVfZW5hYmxlX3BpcGVzdGF0KGk5MTUsIFBJUEVfQiwgUElQRV9DUkNfRE9ORV9JTlRFUlJV
UFRfU1RBVFVTKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAt
CWk5MTVfZW5hYmxlX2FzbGVfcGlwZXN0YXQoZGV2X3ByaXYpOwo+ID4gKwlpOTE1X2VuYWJsZV9h
c2xlX3BpcGVzdGF0KGk5MTUpOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IEBAIC00NTQw
LDE0ICs0NTQwLDE0IEBAIHN0YXRpYyBpbnQgaTkxNV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRy
bV9kZXZpY2UgKmRldikKPiA+ICAgc3RhdGljIGlycXJldHVybl90IGk5MTVfaXJxX2hhbmRsZXIo
aW50IGlycSwgdm9pZCAqYXJnKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gYXJnOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYp
Owo+ID4gICAJaXJxcmV0dXJuX3QgcmV0ID0gSVJRX05PTkU7Cj4gPiAtCWlmICghaW50ZWxfaXJx
c19lbmFibGVkKGRldl9wcml2KSkKPiA+ICsJaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkp
Cj4gPiAgIAkJcmV0dXJuIElSUV9OT05FOwo+ID4gICAJLyogSVJRcyBhcmUgc3luY2VkIGR1cmlu
ZyBydW50aW1lX3N1c3BlbmQsIHdlIGRvbid0IHJlcXVpcmUgYSB3YWtlcmVmICovCj4gPiAtCWRp
c2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cyhkZXZfcHJpdik7Cj4gPiArCWRpc2FibGVfcnBtX3dh
a2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiA+ICAgCWRvIHsKPiA+ICAgCQl1MzIgcGlwZV9zdGF0c1tJ
OTE1X01BWF9QSVBFU10gPSB7fTsKPiA+IEBAIC00NTYxLDUzICs0NTYxLDUzIEBAIHN0YXRpYyBp
cnFyZXR1cm5fdCBpOTE1X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykKPiA+ICAgCQly
ZXQgPSBJUlFfSEFORExFRDsKPiA+IC0JCWlmIChJOTE1X0hBU19IT1RQTFVHKGRldl9wcml2KSAm
Jgo+ID4gKwkJaWYgKEk5MTVfSEFTX0hPVFBMVUcoaTkxNSkgJiYKPiA+ICAgCQkgICAgaWlyICYg
STkxNV9ESVNQTEFZX1BPUlRfSU5URVJSVVBUKQo+ID4gLQkJCWhvdHBsdWdfc3RhdHVzID0gaTl4
eF9ocGRfaXJxX2FjayhkZXZfcHJpdik7Cj4gPiArCQkJaG90cGx1Z19zdGF0dXMgPSBpOXh4X2hw
ZF9pcnFfYWNrKGk5MTUpOwo+ID4gICAJCS8qIENhbGwgcmVnYXJkbGVzcywgYXMgc29tZSBzdGF0
dXMgYml0cyBtaWdodCBub3QgYmUKPiA+ICAgCQkgKiBzaWduYWxsZWQgaW4gaWlyICovCj4gPiAt
CQlpOXh4X3BpcGVzdGF0X2lycV9hY2soZGV2X3ByaXYsIGlpciwgcGlwZV9zdGF0cyk7Cj4gPiAr
CQlpOXh4X3BpcGVzdGF0X2lycV9hY2soaTkxNSwgaWlyLCBwaXBlX3N0YXRzKTsKPiA+ICAgCQlp
ZiAoaWlyICYgSTkxNV9NQVNURVJfRVJST1JfSU5URVJSVVBUKQo+ID4gLQkJCWk5eHhfZXJyb3Jf
aXJxX2FjayhkZXZfcHJpdiwgJmVpciwgJmVpcl9zdHVjayk7Cj4gPiArCQkJaTl4eF9lcnJvcl9p
cnFfYWNrKGk5MTUsICZlaXIsICZlaXJfc3R1Y2spOwo+ID4gICAJCUk5MTVfV1JJVEUoR0VOMl9J
SVIsIGlpcik7Cj4gPiAgIAkJaWYgKGlpciAmIEk5MTVfVVNFUl9JTlRFUlJVUFQpCj4gPiAtCQkJ
aW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycShkZXZfcHJpdi0+ZW5naW5lW1JDUzBdKTsKPiA+
ICsJCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGk5MTUtPmVuZ2luZVtSQ1MwXSk7Cj4g
PiAgIAkJaWYgKGlpciAmIEk5MTVfTUFTVEVSX0VSUk9SX0lOVEVSUlVQVCkKPiA+IC0JCQlpOXh4
X2Vycm9yX2lycV9oYW5kbGVyKGRldl9wcml2LCBlaXIsIGVpcl9zdHVjayk7Cj4gPiArCQkJaTl4
eF9lcnJvcl9pcnFfaGFuZGxlcihpOTE1LCBlaXIsIGVpcl9zdHVjayk7Cj4gPiAgIAkJaWYgKGhv
dHBsdWdfc3RhdHVzKQo+ID4gLQkJCWk5eHhfaHBkX2lycV9oYW5kbGVyKGRldl9wcml2LCBob3Rw
bHVnX3N0YXR1cyk7Cj4gPiArCQkJaTl4eF9ocGRfaXJxX2hhbmRsZXIoaTkxNSwgaG90cGx1Z19z
dGF0dXMpOwo+ID4gLQkJaTkxNV9waXBlc3RhdF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgaWlyLCBw
aXBlX3N0YXRzKTsKPiA+ICsJCWk5MTVfcGlwZXN0YXRfaXJxX2hhbmRsZXIoaTkxNSwgaWlyLCBw
aXBlX3N0YXRzKTsKPiA+ICAgCX0gd2hpbGUgKDApOwo+ID4gLQllbmFibGVfcnBtX3dha2VyZWZf
YXNzZXJ0cyhkZXZfcHJpdik7Cj4gPiArCWVuYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUp
Owo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBpOTY1X2lycV9y
ZXNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+IC0Jc3RydWN0IGludGVsX3Vu
Y29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ID4gLQlpOTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0
ZShkZXZfcHJpdiwgMHhmZmZmZmZmZiwgMCk7Cj4gPiArCWk5MTVfaG90cGx1Z19pbnRlcnJ1cHRf
dXBkYXRlKGk5MTUsIDB4ZmZmZmZmZmYsIDApOwo+ID4gICAJSTkxNV9XUklURShQT1JUX0hPVFBM
VUdfU1RBVCwgSTkxNV9SRUFEKFBPUlRfSE9UUExVR19TVEFUKSk7Cj4gPiAtCWk5eHhfcGlwZXN0
YXRfaXJxX3Jlc2V0KGRldl9wcml2KTsKPiA+ICsJaTl4eF9waXBlc3RhdF9pcnFfcmVzZXQoaTkx
NSk7Cj4gPiAgIAlHRU4zX0lSUV9SRVNFVCh1bmNvcmUsIEdFTjJfKTsKPiA+ICAgfQo+ID4gICBz
dGF0aWMgaW50IGk5NjVfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4g
PiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShk
ZXYpOwo+ID4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29y
ZTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4g
PiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7Cj4gPiAgIAl1
MzIgZW5hYmxlX21hc2s7Cj4gPiAgIAl1MzIgZXJyb3JfbWFzazsKPiA+IEBAIC00NjE1LDcgKzQ2
MTUsNyBAQCBzdGF0aWMgaW50IGk5NjVfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYpCj4gPiAgIAkgKiBFbmFibGUgc29tZSBlcnJvciBkZXRlY3Rpb24sIG5vdGUgdGhlIGlu
c3RydWN0aW9uIGVycm9yIG1hc2sKPiA+ICAgCSAqIGJpdCBpcyByZXNlcnZlZCwgc28gd2UgbGVh
dmUgaXQgbWFza2VkLgo+ID4gICAJICovCj4gPiAtCWlmIChJU19HNFgoZGV2X3ByaXYpKSB7Cj4g
PiArCWlmIChJU19HNFgoaTkxNSkpIHsKPiA+ICAgCQllcnJvcl9tYXNrID0gfihHTTQ1X0VSUk9S
X1BBR0VfVEFCTEUgfAo+ID4gICAJCQkgICAgICAgR000NV9FUlJPUl9NRU1fUFJJViB8Cj4gPiAg
IAkJCSAgICAgICBHTTQ1X0VSUk9SX0NQX1BSSVYgfAo+ID4gQEAgLTQ2MjcsNyArNDYyNyw3IEBA
IHN0YXRpYyBpbnQgaTk2NV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikK
PiA+ICAgCUk5MTVfV1JJVEUoRU1SLCBlcnJvcl9tYXNrKTsKPiA+ICAgCS8qIFVubWFzayB0aGUg
aW50ZXJydXB0cyB0aGF0IHdlIGFsd2F5cyB3YW50IG9uLiAqLwo+ID4gLQlkZXZfcHJpdi0+aXJx
X21hc2sgPQo+ID4gKwlpOTE1LT5pcnFfbWFzayA9Cj4gPiAgIAkJfihJOTE1X0FTTEVfSU5URVJS
VVBUIHwKPiA+ICAgCQkgIEk5MTVfRElTUExBWV9QT1JUX0lOVEVSUlVQVCB8Cj4gPiAgIAkJICBJ
OTE1X0RJU1BMQVlfUElQRV9BX0VWRU5UX0lOVEVSUlVQVCB8Cj4gPiBAQCAtNDY0Miw0MyArNDY0
Miw0MyBAQCBzdGF0aWMgaW50IGk5NjVfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYpCj4gPiAgIAkJSTkxNV9NQVNURVJfRVJST1JfSU5URVJSVVBUIHwKPiA+ICAgCQlJOTE1
X1VTRVJfSU5URVJSVVBUOwo+ID4gLQlpZiAoSVNfRzRYKGRldl9wcml2KSkKPiA+ICsJaWYgKElT
X0c0WChpOTE1KSkKPiA+ICAgCQllbmFibGVfbWFzayB8PSBJOTE1X0JTRF9VU0VSX0lOVEVSUlVQ
VDsKPiA+IC0JR0VOM19JUlFfSU5JVCh1bmNvcmUsIEdFTjJfLCBkZXZfcHJpdi0+aXJxX21hc2ss
IGVuYWJsZV9tYXNrKTsKPiA+ICsJR0VOM19JUlFfSU5JVCh1bmNvcmUsIEdFTjJfLCBpOTE1LT5p
cnFfbWFzaywgZW5hYmxlX21hc2spOwo+ID4gICAJLyogSW50ZXJydXB0IHNldHVwIGlzIGFscmVh
ZHkgZ3VhcmFudGVlZCB0byBiZSBzaW5nbGUtdGhyZWFkZWQsIHRoaXMgaXMKPiA+ICAgCSAqIGp1
c3QgdG8gbWFrZSB0aGUgYXNzZXJ0X3NwaW5fbG9ja2VkIGNoZWNrIGhhcHB5LiAqLwo+ID4gLQlz
cGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gLQlpOTE1X2VuYWJsZV9waXBl
c3RhdChkZXZfcHJpdiwgUElQRV9BLCBQSVBFX0dNQlVTX0lOVEVSUlVQVF9TVEFUVVMpOwo+ID4g
LQlpOTE1X2VuYWJsZV9waXBlc3RhdChkZXZfcHJpdiwgUElQRV9BLCBQSVBFX0NSQ19ET05FX0lO
VEVSUlVQVF9TVEFUVVMpOwo+ID4gLQlpOTE1X2VuYWJsZV9waXBlc3RhdChkZXZfcHJpdiwgUElQ
RV9CLCBQSVBFX0NSQ19ET05FX0lOVEVSUlVQVF9TVEFUVVMpOwo+ID4gLQlzcGluX3VubG9ja19p
cnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9s
b2NrKTsKPiA+ICsJaTkxNV9lbmFibGVfcGlwZXN0YXQoaTkxNSwgUElQRV9BLCBQSVBFX0dNQlVT
X0lOVEVSUlVQVF9TVEFUVVMpOwo+ID4gKwlpOTE1X2VuYWJsZV9waXBlc3RhdChpOTE1LCBQSVBF
X0EsIFBJUEVfQ1JDX0RPTkVfSU5URVJSVVBUX1NUQVRVUyk7Cj4gPiArCWk5MTVfZW5hYmxlX3Bp
cGVzdGF0KGk5MTUsIFBJUEVfQiwgUElQRV9DUkNfRE9ORV9JTlRFUlJVUFRfU1RBVFVTKTsKPiA+
ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAtCWk5MTVfZW5hYmxlX2Fz
bGVfcGlwZXN0YXQoZGV2X3ByaXYpOwo+ID4gKwlpOTE1X2VuYWJsZV9hc2xlX3BpcGVzdGF0KGk5
MTUpOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpOTE1X2hwZF9p
cnFfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2
b2lkIGk5MTVfaHBkX2lycV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+
ICAgewo+ID4gICAJdTMyIGhvdHBsdWdfZW47Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRl
dl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmlycV9s
b2NrKTsKPiA+ICAgCS8qIE5vdGUgSERNSSBhbmQgRFAgc2hhcmUgaG90cGx1ZyBiaXRzICovCj4g
PiAgIAkvKiBlbmFibGUgYml0cyBhcmUgdGhlIHNhbWUgZm9yIGFsbCBnZW5lcmF0aW9ucyAqLwo+
ID4gLQlob3RwbHVnX2VuID0gaW50ZWxfaHBkX2VuYWJsZWRfaXJxcyhkZXZfcHJpdiwgaHBkX21h
c2tfaTkxNSk7Cj4gPiArCWhvdHBsdWdfZW4gPSBpbnRlbF9ocGRfZW5hYmxlZF9pcnFzKGk5MTUs
IGhwZF9tYXNrX2k5MTUpOwo+ID4gICAJLyogUHJvZ3JhbW1pbmcgdGhlIENSVCBkZXRlY3Rpb24g
cGFyYW1ldGVycyB0ZW5kcwo+ID4gICAJICAgdG8gZ2VuZXJhdGUgYSBzcHVyaW91cyBob3RwbHVn
IGV2ZW50IGFib3V0IHRocmVlCj4gPiAgIAkgICBzZWNvbmRzIGxhdGVyLiAgU28ganVzdCBkbyBp
dCBvbmNlLgo+ID4gICAJKi8KPiA+IC0JaWYgKElTX0c0WChkZXZfcHJpdikpCj4gPiArCWlmIChJ
U19HNFgoaTkxNSkpCj4gPiAgIAkJaG90cGx1Z19lbiB8PSBDUlRfSE9UUExVR19BQ1RJVkFUSU9O
X1BFUklPRF82NDsKPiA+ICAgCWhvdHBsdWdfZW4gfD0gQ1JUX0hPVFBMVUdfVk9MVEFHRV9DT01Q
QVJFXzUwOwo+ID4gICAJLyogSWdub3JlIFRWIHNpbmNlIGl0J3MgYnVnZ3kgKi8KPiA+IC0JaTkx
NV9ob3RwbHVnX2ludGVycnVwdF91cGRhdGVfbG9ja2VkKGRldl9wcml2LAo+ID4gKwlpOTE1X2hv
dHBsdWdfaW50ZXJydXB0X3VwZGF0ZV9sb2NrZWQoaTkxNSwKPiA+ICAgCQkJCQkgICAgIEhPVFBM
VUdfSU5UX0VOX01BU0sgfAo+ID4gICAJCQkJCSAgICAgQ1JUX0hPVFBMVUdfVk9MVEFHRV9DT01Q
QVJFX01BU0sgfAo+ID4gICAJCQkJCSAgICAgQ1JUX0hPVFBMVUdfQUNUSVZBVElPTl9QRVJJT0Rf
NjQsCj4gPiBAQCAtNDY4OCwxNCArNDY4OCwxNCBAQCBzdGF0aWMgdm9pZCBpOTE1X2hwZF9pcnFf
c2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICBzdGF0aWMgaXJx
cmV0dXJuX3QgaTk2NV9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBhcmc7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlpcnFyZXR1cm5fdCByZXQgPSBJUlFf
Tk9ORTsKPiA+IC0JaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpKQo+ID4gKwlpZiAo
IWludGVsX2lycXNfZW5hYmxlZChpOTE1KSkKPiA+ICAgCQlyZXR1cm4gSVJRX05PTkU7Cj4gPiAg
IAkvKiBJUlFzIGFyZSBzeW5jZWQgZHVyaW5nIHJ1bnRpbWVfc3VzcGVuZCwgd2UgZG9uJ3QgcmVx
dWlyZSBhIHdha2VyZWYgKi8KPiA+IC0JZGlzYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGRldl9w
cml2KTsKPiA+ICsJZGlzYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ID4gICAJZG8g
ewo+ID4gICAJCXUzMiBwaXBlX3N0YXRzW0k5MTVfTUFYX1BJUEVTXSA9IHt9Owo+ID4gQEAgLTQ3
MTAsNzYgKzQ3MTAsNzYgQEAgc3RhdGljIGlycXJldHVybl90IGk5NjVfaXJxX2hhbmRsZXIoaW50
IGlycSwgdm9pZCAqYXJnKQo+ID4gICAJCXJldCA9IElSUV9IQU5ETEVEOwo+ID4gICAJCWlmIChp
aXIgJiBJOTE1X0RJU1BMQVlfUE9SVF9JTlRFUlJVUFQpCj4gPiAtCQkJaG90cGx1Z19zdGF0dXMg
PSBpOXh4X2hwZF9pcnFfYWNrKGRldl9wcml2KTsKPiA+ICsJCQlob3RwbHVnX3N0YXR1cyA9IGk5
eHhfaHBkX2lycV9hY2soaTkxNSk7Cj4gPiAgIAkJLyogQ2FsbCByZWdhcmRsZXNzLCBhcyBzb21l
IHN0YXR1cyBiaXRzIG1pZ2h0IG5vdCBiZQo+ID4gICAJCSAqIHNpZ25hbGxlZCBpbiBpaXIgKi8K
PiA+IC0JCWk5eHhfcGlwZXN0YXRfaXJxX2FjayhkZXZfcHJpdiwgaWlyLCBwaXBlX3N0YXRzKTsK
PiA+ICsJCWk5eHhfcGlwZXN0YXRfaXJxX2FjayhpOTE1LCBpaXIsIHBpcGVfc3RhdHMpOwo+ID4g
ICAJCWlmIChpaXIgJiBJOTE1X01BU1RFUl9FUlJPUl9JTlRFUlJVUFQpCj4gPiAtCQkJaTl4eF9l
cnJvcl9pcnFfYWNrKGRldl9wcml2LCAmZWlyLCAmZWlyX3N0dWNrKTsKPiA+ICsJCQlpOXh4X2Vy
cm9yX2lycV9hY2soaTkxNSwgJmVpciwgJmVpcl9zdHVjayk7Cj4gPiAgIAkJSTkxNV9XUklURShH
RU4yX0lJUiwgaWlyKTsKPiA+ICAgCQlpZiAoaWlyICYgSTkxNV9VU0VSX0lOVEVSUlVQVCkKPiA+
IC0JCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGRldl9wcml2LT5lbmdpbmVbUkNTMF0p
Owo+ID4gKwkJCWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoaTkxNS0+ZW5naW5lW1JDUzBd
KTsKPiA+ICAgCQlpZiAoaWlyICYgSTkxNV9CU0RfVVNFUl9JTlRFUlJVUFQpCj4gPiAtCQkJaW50
ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycShkZXZfcHJpdi0+ZW5naW5lW1ZDUzBdKTsKPiA+ICsJ
CQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGk5MTUtPmVuZ2luZVtWQ1MwXSk7Cj4gPiAg
IAkJaWYgKGlpciAmIEk5MTVfTUFTVEVSX0VSUk9SX0lOVEVSUlVQVCkKPiA+IC0JCQlpOXh4X2Vy
cm9yX2lycV9oYW5kbGVyKGRldl9wcml2LCBlaXIsIGVpcl9zdHVjayk7Cj4gPiArCQkJaTl4eF9l
cnJvcl9pcnFfaGFuZGxlcihpOTE1LCBlaXIsIGVpcl9zdHVjayk7Cj4gPiAgIAkJaWYgKGhvdHBs
dWdfc3RhdHVzKQo+ID4gLQkJCWk5eHhfaHBkX2lycV9oYW5kbGVyKGRldl9wcml2LCBob3RwbHVn
X3N0YXR1cyk7Cj4gPiArCQkJaTl4eF9ocGRfaXJxX2hhbmRsZXIoaTkxNSwgaG90cGx1Z19zdGF0
dXMpOwo+ID4gLQkJaTk2NV9waXBlc3RhdF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgaWlyLCBwaXBl
X3N0YXRzKTsKPiA+ICsJCWk5NjVfcGlwZXN0YXRfaXJxX2hhbmRsZXIoaTkxNSwgaWlyLCBwaXBl
X3N0YXRzKTsKPiA+ICAgCX0gd2hpbGUgKDApOwo+ID4gLQllbmFibGVfcnBtX3dha2VyZWZfYXNz
ZXJ0cyhkZXZfcHJpdik7Cj4gPiArCWVuYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+
ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfaXJxX2lu
aXQgLSBpbml0aWFsaXplcyBpcnEgc3VwcG9ydAo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZp
Y2UgaW5zdGFuY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICAgICoK
PiA+ICAgICogVGhpcyBmdW5jdGlvbiBpbml0aWFsaXplcyBhbGwgdGhlIGlycSBzdXBwb3J0IGlu
Y2x1ZGluZyB3b3JrIGl0ZW1zLCB0aW1lcnMKPiA+ICAgICogYW5kIGFsbCB0aGUgdnRhYmxlcy4g
SXQgZG9lcyBub3Qgc2V0dXAgdGhlIGludGVycnVwdCBpdHNlbGYgdGhvdWdoLgo+ID4gICAgKi8K
PiA+IC12b2lkIGludGVsX2lycV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICt2b2lkIGludGVsX2lycV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsK
PiA+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gPiAr
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ID4gKwlzdHJ1Y3QgaW50ZWxf
cnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ID4gICAJaW50IGk7Cj4gPiAtCWlmIChJU19J
OTQ1R00oZGV2X3ByaXYpKQo+ID4gLQkJaTk0NWdtX3ZibGFua193b3JrX2luaXQoZGV2X3ByaXYp
Owo+ID4gKwlpZiAoSVNfSTk0NUdNKGk5MTUpKQo+ID4gKwkJaTk0NWdtX3ZibGFua193b3JrX2lu
aXQoaTkxNSk7Cj4gPiAtCWludGVsX2hwZF9pbml0X3dvcmsoZGV2X3ByaXYpOwo+ID4gKwlpbnRl
bF9ocGRfaW5pdF93b3JrKGk5MTUpOwo+ID4gICAJSU5JVF9XT1JLKCZycHMtPndvcmssIGdlbjZf
cG1fcnBzX3dvcmspOwo+ID4gLQlJTklUX1dPUksoJmRldl9wcml2LT5sM19wYXJpdHkuZXJyb3Jf
d29yaywgaXZ5YnJpZGdlX3Bhcml0eV93b3JrKTsKPiA+ICsJSU5JVF9XT1JLKCZpOTE1LT5sM19w
YXJpdHkuZXJyb3Jfd29yaywgaXZ5YnJpZGdlX3Bhcml0eV93b3JrKTsKPiA+ICAgCWZvciAoaSA9
IDA7IGkgPCBNQVhfTDNfU0xJQ0VTOyArK2kpCj4gPiAtCQlkZXZfcHJpdi0+bDNfcGFyaXR5LnJl
bWFwX2luZm9baV0gPSBOVUxMOwo+ID4gKwkJaTkxNS0+bDNfcGFyaXR5LnJlbWFwX2luZm9baV0g
PSBOVUxMOwo+ID4gLQlpZiAoSEFTX0dVQ19TQ0hFRChkZXZfcHJpdikgJiYgSU5URUxfR0VOKGRl
dl9wcml2KSA8IDExKQo+ID4gLQkJZGV2X3ByaXYtPnBtX2d1Y19ldmVudHMgPSBHRU45X0dVQ19U
T19IT1NUX0lOVF9FVkVOVDsKPiA+ICsJaWYgKEhBU19HVUNfU0NIRUQoaTkxNSkgJiYgSU5URUxf
R0VOKGk5MTUpIDwgMTEpCj4gPiArCQlpOTE1LT5wbV9ndWNfZXZlbnRzID0gR0VOOV9HVUNfVE9f
SE9TVF9JTlRfRVZFTlQ7Cj4gPiAgIAkvKiBMZXQncyB0cmFjayB0aGUgZW5hYmxlZCBycHMgZXZl
bnRzICovCj4gPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX1ZB
TExFWVZJRVcoaTkxNSkpCj4gPiAgIAkJLyogV2FHc3ZSQzBSZXNpZGVuY3lNZXRob2Q6dmx2ICov
Cj4gPiAtCQlkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyA9IEdFTjZfUE1fUlBfVVBfRUlfRVhQSVJF
RDsKPiA+ICsJCWk5MTUtPnBtX3Jwc19ldmVudHMgPSBHRU42X1BNX1JQX1VQX0VJX0VYUElSRUQ7
Cj4gPiAgIAllbHNlCj4gPiAtCQlkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyA9IChHRU42X1BNX1JQ
X1VQX1RIUkVTSE9MRCB8Cj4gPiArCQlpOTE1LT5wbV9ycHNfZXZlbnRzID0gKEdFTjZfUE1fUlBf
VVBfVEhSRVNIT0xEIHwKPiA+ICAgCQkJCQkgICBHRU42X1BNX1JQX0RPV05fVEhSRVNIT0xEIHwK
PiA+ICAgCQkJCQkgICBHRU42X1BNX1JQX0RPV05fVElNRU9VVCk7Cj4gPiAgIAkvKiBXZSBzaGFy
ZSB0aGUgcmVnaXN0ZXIgd2l0aCBvdGhlciBlbmdpbmUgKi8KPiA+IC0JaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPiA5KQo+ID4gLQkJR0VNX1dBUk5fT04oZGV2X3ByaXYtPnBtX3Jwc19ldmVudHMg
JiAweGZmZmYwMDAwKTsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+IDkpCj4gPiArCQlHRU1f
V0FSTl9PTihpOTE1LT5wbV9ycHNfZXZlbnRzICYgMHhmZmZmMDAwMCk7Cj4gPiAgIAlycHMtPnBt
X2ludHJtc2tfbWJ6ID0gMDsKPiA+IEBAIC00Nzg5LDE1ICs0Nzg5LDE1IEBAIHZvaWQgaW50ZWxf
aXJxX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICoKPiA+
ICAgCSAqIFRPRE86IHZlcmlmeSBpZiB0aGlzIGNhbiBiZSByZXByb2R1Y2VkIG9uIFZMVixDSFYu
Cj4gPiAgIAkgKi8KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNykKPiA+ICsJaWYg
KElOVEVMX0dFTihpOTE1KSA8PSA3KQo+ID4gICAJCXJwcy0+cG1faW50cm1za19tYnogfD0gR0VO
Nl9QTV9SUF9VUF9FSV9FWFBJUkVEOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4
KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpCj4gPiAgIAkJcnBzLT5wbV9pbnRybXNr
X21ieiB8PSBHRU44X1BNSU5UUl9ESVNBQkxFX1JFRElSRUNUX1RPX0dVQzsKPiA+IC0JaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gNSB8fCBJU19HNFgoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDUgfHwgSVNfRzRYKGk5MTUpKQo+ID4gICAJCWRldi0+ZHJpdmVyLT5n
ZXRfdmJsYW5rX2NvdW50ZXIgPSBnNHhfZ2V0X3ZibGFua19jb3VudGVyOwo+ID4gLQllbHNlIGlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDMpCj4gPiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1
KSA+PSAzKQo+ID4gICAJCWRldi0+ZHJpdmVyLT5nZXRfdmJsYW5rX2NvdW50ZXIgPSBpOTE1X2dl
dF92YmxhbmtfY291bnRlcjsKPiA+ICAgCWRldi0+dmJsYW5rX2Rpc2FibGVfaW1tZWRpYXRlID0g
dHJ1ZTsKPiA+IEBAIC00ODA4LDgzICs0ODA4LDgzIEBAIHZvaWQgaW50ZWxfaXJxX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICogb3V0c2lkZSBvZiB0aGUg
cG93ZXIgZG9tYWluLiBXZSBkZWZlciBzZXR0aW5nIHVwIHRoZSBkaXNwbGF5IGlycXMKPiA+ICAg
CSAqIGluIHRoaXMgY2FzZSB0byB0aGUgcnVudGltZSBwbS4KPiA+ICAgCSAqLwo+ID4gLQlkZXZf
cHJpdi0+ZGlzcGxheV9pcnFzX2VuYWJsZWQgPSB0cnVlOwo+ID4gLQlpZiAoSVNfVkFMTEVZVklF
VyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiAtCQlkZXZfcHJpdi0+
ZGlzcGxheV9pcnFzX2VuYWJsZWQgPSBmYWxzZTsKPiA+ICsJaTkxNS0+ZGlzcGxheV9pcnFzX2Vu
YWJsZWQgPSB0cnVlOwo+ID4gKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllW
SUVXKGk5MTUpKQo+ID4gKwkJaTkxNS0+ZGlzcGxheV9pcnFzX2VuYWJsZWQgPSBmYWxzZTsKPiA+
IC0JZGV2X3ByaXYtPmhvdHBsdWcuaHBkX3N0b3JtX3RocmVzaG9sZCA9IEhQRF9TVE9STV9ERUZB
VUxUX1RIUkVTSE9MRDsKPiA+ICsJaTkxNS0+aG90cGx1Zy5ocGRfc3Rvcm1fdGhyZXNob2xkID0g
SFBEX1NUT1JNX0RFRkFVTFRfVEhSRVNIT0xEOwo+ID4gICAJLyogSWYgd2UgaGF2ZSBNU1Qgc3Vw
cG9ydCwgd2Ugd2FudCB0byBhdm9pZCBkb2luZyBzaG9ydCBIUEQgSVJRIHN0b3JtCj4gPiAgIAkg
KiBkZXRlY3Rpb24sIGFzIHNob3J0IEhQRCBzdG9ybXMgd2lsbCBvY2N1ciBhcyBhIG5hdHVyYWwg
cGFydCBvZgo+ID4gICAJICogc2lkZWJhbmQgbWVzc2FnaW5nIHdpdGggTVNULgo+ID4gICAJICog
T24gb2xkZXIgcGxhdGZvcm1zIGhvd2V2ZXIsIElSUSBzdG9ybXMgY2FuIG9jY3VyIHdpdGggYm90
aCBsb25nIGFuZAo+ID4gICAJICogc2hvcnQgcHVsc2VzLCBhcyBzZWVuIG9uIHNvbWUgRzR4IHN5
c3RlbXMuCj4gPiAgIAkgKi8KPiA+IC0JZGV2X3ByaXYtPmhvdHBsdWcuaHBkX3Nob3J0X3N0b3Jt
X2VuYWJsZWQgPSAhSEFTX0RQX01TVChkZXZfcHJpdik7Cj4gPiArCWk5MTUtPmhvdHBsdWcuaHBk
X3Nob3J0X3N0b3JtX2VuYWJsZWQgPSAhSEFTX0RQX01TVChpOTE1KTsKPiA+ICAgCWRldi0+ZHJp
dmVyLT5nZXRfdmJsYW5rX3RpbWVzdGFtcCA9IGRybV9jYWxjX3ZibHRpbWVzdGFtcF9mcm9tX3Nj
YW5vdXRwb3M7Cj4gPiAgIAlkZXYtPmRyaXZlci0+Z2V0X3NjYW5vdXRfcG9zaXRpb24gPSBpOTE1
X2dldF9jcnRjX3NjYW5vdXRwb3M7Cj4gPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkg
ewo+ID4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ID4gICAJCWRldi0+ZHJpdmVyLT5p
cnFfaGFuZGxlciA9IGNoZXJyeXZpZXdfaXJxX2hhbmRsZXI7Cj4gPiAgIAkJZGV2LT5kcml2ZXIt
PmlycV9wcmVpbnN0YWxsID0gY2hlcnJ5dmlld19pcnFfcmVzZXQ7Cj4gPiAgIAkJZGV2LT5kcml2
ZXItPmlycV9wb3N0aW5zdGFsbCA9IGNoZXJyeXZpZXdfaXJxX3Bvc3RpbnN0YWxsOwo+ID4gICAJ
CWRldi0+ZHJpdmVyLT5pcnFfdW5pbnN0YWxsID0gY2hlcnJ5dmlld19pcnFfcmVzZXQ7Cj4gPiAg
IAkJZGV2LT5kcml2ZXItPmVuYWJsZV92YmxhbmsgPSBpOTY1X2VuYWJsZV92Ymxhbms7Cj4gPiAg
IAkJZGV2LT5kcml2ZXItPmRpc2FibGVfdmJsYW5rID0gaTk2NV9kaXNhYmxlX3ZibGFuazsKPiA+
IC0JCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAgPSBpOTE1X2hwZF9pcnFfc2V0dXA7
Cj4gPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpIHsKPiA+ICsJCWk5MTUt
PmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGk5MTVfaHBkX2lycV9zZXR1cDsKPiA+ICsJfSBlbHNl
IGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKSB7Cj4gPiAgIAkJZGV2LT5kcml2ZXItPmlycV9oYW5k
bGVyID0gdmFsbGV5dmlld19pcnFfaGFuZGxlcjsKPiA+ICAgCQlkZXYtPmRyaXZlci0+aXJxX3By
ZWluc3RhbGwgPSB2YWxsZXl2aWV3X2lycV9yZXNldDsKPiA+ICAgCQlkZXYtPmRyaXZlci0+aXJx
X3Bvc3RpbnN0YWxsID0gdmFsbGV5dmlld19pcnFfcG9zdGluc3RhbGw7Cj4gPiAgIAkJZGV2LT5k
cml2ZXItPmlycV91bmluc3RhbGwgPSB2YWxsZXl2aWV3X2lycV9yZXNldDsKPiA+ICAgCQlkZXYt
PmRyaXZlci0+ZW5hYmxlX3ZibGFuayA9IGk5NjVfZW5hYmxlX3ZibGFuazsKPiA+ICAgCQlkZXYt
PmRyaXZlci0+ZGlzYWJsZV92YmxhbmsgPSBpOTY1X2Rpc2FibGVfdmJsYW5rOwo+ID4gLQkJZGV2
X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGk5MTVfaHBkX2lycV9zZXR1cDsKPiA+IC0J
fSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiArCQlpOTE1LT5kaXNw
bGF5LmhwZF9pcnFfc2V0dXAgPSBpOTE1X2hwZF9pcnFfc2V0dXA7Cj4gPiArCX0gZWxzZSBpZiAo
SU5URUxfR0VOKGk5MTUpID49IDExKSB7Cj4gPiAgIAkJZGV2LT5kcml2ZXItPmlycV9oYW5kbGVy
ID0gZ2VuMTFfaXJxX2hhbmRsZXI7Cj4gPiAgIAkJZGV2LT5kcml2ZXItPmlycV9wcmVpbnN0YWxs
ID0gZ2VuMTFfaXJxX3Jlc2V0Owo+ID4gICAJCWRldi0+ZHJpdmVyLT5pcnFfcG9zdGluc3RhbGwg
PSBnZW4xMV9pcnFfcG9zdGluc3RhbGw7Cj4gPiAgIAkJZGV2LT5kcml2ZXItPmlycV91bmluc3Rh
bGwgPSBnZW4xMV9pcnFfcmVzZXQ7Cj4gPiAgIAkJZGV2LT5kcml2ZXItPmVuYWJsZV92Ymxhbmsg
PSBnZW44X2VuYWJsZV92Ymxhbms7Cj4gPiAgIAkJZGV2LT5kcml2ZXItPmRpc2FibGVfdmJsYW5r
ID0gZ2VuOF9kaXNhYmxlX3ZibGFuazsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFf
c2V0dXAgPSBnZW4xMV9ocGRfaXJxX3NldHVwOwo+ID4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gOCkgewo+ID4gKwkJaTkxNS0+ZGlzcGxheS5ocGRfaXJxX3NldHVwID0gZ2Vu
MTFfaHBkX2lycV9zZXR1cDsKPiA+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkg
ewo+ID4gICAJCWRldi0+ZHJpdmVyLT5pcnFfaGFuZGxlciA9IGdlbjhfaXJxX2hhbmRsZXI7Cj4g
PiAgIAkJZGV2LT5kcml2ZXItPmlycV9wcmVpbnN0YWxsID0gZ2VuOF9pcnFfcmVzZXQ7Cj4gPiAg
IAkJZGV2LT5kcml2ZXItPmlycV9wb3N0aW5zdGFsbCA9IGdlbjhfaXJxX3Bvc3RpbnN0YWxsOwo+
ID4gICAJCWRldi0+ZHJpdmVyLT5pcnFfdW5pbnN0YWxsID0gZ2VuOF9pcnFfcmVzZXQ7Cj4gPiAg
IAkJZGV2LT5kcml2ZXItPmVuYWJsZV92YmxhbmsgPSBnZW44X2VuYWJsZV92Ymxhbms7Cj4gPiAg
IAkJZGV2LT5kcml2ZXItPmRpc2FibGVfdmJsYW5rID0gZ2VuOF9kaXNhYmxlX3ZibGFuazsKPiA+
IC0JCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkKPiA+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5o
cGRfaXJxX3NldHVwID0gYnh0X2hwZF9pcnFfc2V0dXA7Cj4gPiAtCQllbHNlIGlmIChJTlRFTF9Q
Q0hfVFlQRShkZXZfcHJpdikgPj0gUENIX1NQVCkKPiA+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5o
cGRfaXJxX3NldHVwID0gc3B0X2hwZF9pcnFfc2V0dXA7Cj4gPiArCQlpZiAoSVNfR0VOOV9MUChp
OTE1KSkKPiA+ICsJCQlpOTE1LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAgPSBieHRfaHBkX2lycV9z
ZXR1cDsKPiA+ICsJCWVsc2UgaWYgKElOVEVMX1BDSF9UWVBFKGk5MTUpID49IFBDSF9TUFQpCj4g
PiArCQkJaTkxNS0+ZGlzcGxheS5ocGRfaXJxX3NldHVwID0gc3B0X2hwZF9pcnFfc2V0dXA7Cj4g
PiAgIAkJZWxzZQo+ID4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAgPSBpbGtf
aHBkX2lycV9zZXR1cDsKPiA+IC0JfSBlbHNlIGlmIChIQVNfUENIX1NQTElUKGRldl9wcml2KSkg
ewo+ID4gKwkJCWk5MTUtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGlsa19ocGRfaXJxX3NldHVw
Owo+ID4gKwl9IGVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpIHsKPiA+ICAgCQlkZXYtPmRy
aXZlci0+aXJxX2hhbmRsZXIgPSBpcm9ubGFrZV9pcnFfaGFuZGxlcjsKPiA+ICAgCQlkZXYtPmRy
aXZlci0+aXJxX3ByZWluc3RhbGwgPSBpcm9ubGFrZV9pcnFfcmVzZXQ7Cj4gPiAgIAkJZGV2LT5k
cml2ZXItPmlycV9wb3N0aW5zdGFsbCA9IGlyb25sYWtlX2lycV9wb3N0aW5zdGFsbDsKPiA+ICAg
CQlkZXYtPmRyaXZlci0+aXJxX3VuaW5zdGFsbCA9IGlyb25sYWtlX2lycV9yZXNldDsKPiA+ICAg
CQlkZXYtPmRyaXZlci0+ZW5hYmxlX3ZibGFuayA9IGlyb25sYWtlX2VuYWJsZV92Ymxhbms7Cj4g
PiAgIAkJZGV2LT5kcml2ZXItPmRpc2FibGVfdmJsYW5rID0gaXJvbmxha2VfZGlzYWJsZV92Ymxh
bms7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5ocGRfaXJxX3NldHVwID0gaWxrX2hwZF9pcnFf
c2V0dXA7Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAgPSBpbGtfaHBkX2lycV9z
ZXR1cDsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAtCQlpZiAoSVNfR0VOKGRldl9wcml2LCAyKSkgewo+
ID4gKwkJaWYgKElTX0dFTihpOTE1LCAyKSkgewo+ID4gICAJCQlkZXYtPmRyaXZlci0+aXJxX3By
ZWluc3RhbGwgPSBpOHh4X2lycV9yZXNldDsKPiA+ICAgCQkJZGV2LT5kcml2ZXItPmlycV9wb3N0
aW5zdGFsbCA9IGk4eHhfaXJxX3Bvc3RpbnN0YWxsOwo+ID4gICAJCQlkZXYtPmRyaXZlci0+aXJx
X2hhbmRsZXIgPSBpOHh4X2lycV9oYW5kbGVyOwo+ID4gICAJCQlkZXYtPmRyaXZlci0+aXJxX3Vu
aW5zdGFsbCA9IGk4eHhfaXJxX3Jlc2V0Owo+ID4gICAJCQlkZXYtPmRyaXZlci0+ZW5hYmxlX3Zi
bGFuayA9IGk4eHhfZW5hYmxlX3ZibGFuazsKPiA+ICAgCQkJZGV2LT5kcml2ZXItPmRpc2FibGVf
dmJsYW5rID0gaTh4eF9kaXNhYmxlX3ZibGFuazsKPiA+IC0JCX0gZWxzZSBpZiAoSVNfSTk0NUdN
KGRldl9wcml2KSkgewo+ID4gKwkJfSBlbHNlIGlmIChJU19JOTQ1R00oaTkxNSkpIHsKPiA+ICAg
CQkJZGV2LT5kcml2ZXItPmlycV9wcmVpbnN0YWxsID0gaTkxNV9pcnFfcmVzZXQ7Cj4gPiAgIAkJ
CWRldi0+ZHJpdmVyLT5pcnFfcG9zdGluc3RhbGwgPSBpOTE1X2lycV9wb3N0aW5zdGFsbDsKPiA+
ICAgCQkJZGV2LT5kcml2ZXItPmlycV91bmluc3RhbGwgPSBpOTE1X2lycV9yZXNldDsKPiA+ICAg
CQkJZGV2LT5kcml2ZXItPmlycV9oYW5kbGVyID0gaTkxNV9pcnFfaGFuZGxlcjsKPiA+ICAgCQkJ
ZGV2LT5kcml2ZXItPmVuYWJsZV92YmxhbmsgPSBpOTQ1Z21fZW5hYmxlX3ZibGFuazsKPiA+ICAg
CQkJZGV2LT5kcml2ZXItPmRpc2FibGVfdmJsYW5rID0gaTk0NWdtX2Rpc2FibGVfdmJsYW5rOwo+
ID4gLQkJfSBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDMpKSB7Cj4gPiArCQl9IGVsc2UgaWYg
KElTX0dFTihpOTE1LCAzKSkgewo+ID4gICAJCQlkZXYtPmRyaXZlci0+aXJxX3ByZWluc3RhbGwg
PSBpOTE1X2lycV9yZXNldDsKPiA+ICAgCQkJZGV2LT5kcml2ZXItPmlycV9wb3N0aW5zdGFsbCA9
IGk5MTVfaXJxX3Bvc3RpbnN0YWxsOwo+ID4gICAJCQlkZXYtPmRyaXZlci0+aXJxX3VuaW5zdGFs
bCA9IGk5MTVfaXJxX3Jlc2V0Owo+ID4gQEAgLTQ4OTksOCArNDg5OSw4IEBAIHZvaWQgaW50ZWxf
aXJxX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCQlkZXYt
PmRyaXZlci0+ZW5hYmxlX3ZibGFuayA9IGk5NjVfZW5hYmxlX3ZibGFuazsKPiA+ICAgCQkJZGV2
LT5kcml2ZXItPmRpc2FibGVfdmJsYW5rID0gaTk2NV9kaXNhYmxlX3ZibGFuazsKPiA+ICAgCQl9
Cj4gPiAtCQlpZiAoSTkxNV9IQVNfSE9UUExVRyhkZXZfcHJpdikpCj4gPiAtCQkJZGV2X3ByaXYt
PmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGk5MTVfaHBkX2lycV9zZXR1cDsKPiA+ICsJCWlmIChJ
OTE1X0hBU19IT1RQTFVHKGk5MTUpKQo+ID4gKwkJCWk5MTUtPmRpc3BsYXkuaHBkX2lycV9zZXR1
cCA9IGk5MTVfaHBkX2lycV9zZXR1cDsKPiA+ICAgCX0KPiA+ICAgfQo+ID4gQEAgLTQ5MjMsNyAr
NDkyMyw3IEBAIHZvaWQgaW50ZWxfaXJxX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9pcnFfaW5zdGFsbCAtIGVuYWJsZXMgdGhlIGhh
cmR3YXJlIGludGVycnVwdAo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UK
PiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICAgICoKPiA+ICAgICogVGhp
cyBmdW5jdGlvbiBlbmFibGVzIHRoZSBoYXJkd2FyZSBpbnRlcnJ1cHQgaGFuZGxpbmcsIGJ1dCBs
ZWF2ZXMgdGhlIGhvdHBsdWcKPiA+ICAgICogaGFuZGxpbmcgc3RpbGwgZGlzYWJsZWQuIEl0IGlz
IGNhbGxlZCBhZnRlciBpbnRlbF9pcnFfaW5pdCgpLgo+ID4gQEAgLTQ5MzIsNTYgKzQ5MzIsNTYg
QEAgdm9pZCBpbnRlbF9pcnFfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+
ICAgICogYnV0IGRvbid0IHdhbnQgdG8gZGVhbCB3aXRoIHRoZSBoYXNzbGUgb2YgY29uY3VycmVu
dCBwcm9iZSBhbmQgaG90cGx1Zwo+ID4gICAgKiB3b3JrZXJzLiBIZW5jZSB0aGUgc3BsaXQgaW50
byB0aGlzIHR3by1zdGFnZSBhcHByb2FjaC4KPiA+ICAgICovCj4gPiAtaW50IGludGVsX2lycV9p
bnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQgaW50ZWxf
aXJxX2luc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAg
CS8qCj4gPiAgIAkgKiBXZSBlbmFibGUgc29tZSBpbnRlcnJ1cHQgc291cmNlcyBpbiBvdXIgcG9z
dGluc3RhbGwgaG9va3MsIHNvIG1hcmsKPiA+ICAgCSAqIGludGVycnVwdHMgYXMgZW5hYmxlZCBf
YmVmb3JlXyBhY3R1YWxseSBlbmFibGluZyB0aGVtIHRvIGF2b2lkCj4gPiAgIAkgKiBzcGVjaWFs
IGNhc2VzIGluIG91ciBvcmRlcmluZyBjaGVja3MuCj4gPiAgIAkgKi8KPiA+IC0JZGV2X3ByaXYt
PnJ1bnRpbWVfcG0uaXJxc19lbmFibGVkID0gdHJ1ZTsKPiA+ICsJaTkxNS0+cnVudGltZV9wbS5p
cnFzX2VuYWJsZWQgPSB0cnVlOwo+ID4gLQlyZXR1cm4gZHJtX2lycV9pbnN0YWxsKCZkZXZfcHJp
di0+ZHJtLCBkZXZfcHJpdi0+ZHJtLnBkZXYtPmlycSk7Cj4gPiArCXJldHVybiBkcm1faXJxX2lu
c3RhbGwoJmk5MTUtPmRybSwgaTkxNS0+ZHJtLnBkZXYtPmlycSk7Cj4gPiAgIH0KPiA+ICAgLyoq
Cj4gPiAgICAqIGludGVsX2lycV91bmluc3RhbGwgLSBmaW5pbGl6ZXMgYWxsIGlycSBoYW5kbGlu
Zwo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICsgKiBAaTkxNTog
aTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICAgICoKPiA+ICAgICogVGhpcyBzdG9wcyBpbnRlcnJ1
cHQgYW5kIGhvdHBsdWcgaGFuZGxpbmcgYW5kIHVucmVnaXN0ZXJzIGFuZCBmcmVlcyBhbGwKPiA+
ICAgICogcmVzb3VyY2VzIGFjcXVpcmVkIGluIHRoZSBpbml0IGZ1bmN0aW9ucy4KPiA+ICAgICov
Cj4gPiAtdm9pZCBpbnRlbF9pcnFfdW5pbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICt2b2lkIGludGVsX2lycV91bmluc3RhbGwoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JZHJtX2lycV91bmluc3RhbGwoJmRldl9wcml2LT5k
cm0pOwo+ID4gLQlpbnRlbF9ocGRfY2FuY2VsX3dvcmsoZGV2X3ByaXYpOwo+ID4gLQlkZXZfcHJp
di0+cnVudGltZV9wbS5pcnFzX2VuYWJsZWQgPSBmYWxzZTsKPiA+ICsJZHJtX2lycV91bmluc3Rh
bGwoJmk5MTUtPmRybSk7Cj4gPiArCWludGVsX2hwZF9jYW5jZWxfd29yayhpOTE1KTsKPiA+ICsJ
aTkxNS0+cnVudGltZV9wbS5pcnFzX2VuYWJsZWQgPSBmYWxzZTsKPiA+ICAgfQo+ID4gICAvKioK
PiA+ICAgICogaW50ZWxfcnVudGltZV9wbV9kaXNhYmxlX2ludGVycnVwdHMgLSBydW50aW1lIGlu
dGVycnVwdCBkaXNhYmxpbmcKPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNl
Cj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiAgICAqCj4gPiAgICAqIFRo
aXMgZnVuY3Rpb24gaXMgdXNlZCB0byBkaXNhYmxlIGludGVycnVwdHMgYXQgcnVudGltZSwgYm90
aCBpbiB0aGUgcnVudGltZQo+ID4gICAgKiBwbSBhbmQgdGhlIHN5c3RlbSBzdXNwZW5kL3Jlc3Vt
ZSBjb2RlLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX3J1bnRpbWVfcG1fZGlzYWJsZV9pbnRl
cnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGludGVs
X3J1bnRpbWVfcG1fZGlzYWJsZV9pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAtCWRldl9wcml2LT5kcm0uZHJpdmVyLT5pcnFfdW5pbnN0YWxsKCZk
ZXZfcHJpdi0+ZHJtKTsKPiA+IC0JZGV2X3ByaXYtPnJ1bnRpbWVfcG0uaXJxc19lbmFibGVkID0g
ZmFsc2U7Cj4gPiAtCXN5bmNocm9uaXplX2lycShkZXZfcHJpdi0+ZHJtLmlycSk7Cj4gPiArCWk5
MTUtPmRybS5kcml2ZXItPmlycV91bmluc3RhbGwoJmk5MTUtPmRybSk7Cj4gPiArCWk5MTUtPnJ1
bnRpbWVfcG0uaXJxc19lbmFibGVkID0gZmFsc2U7Cj4gPiArCXN5bmNocm9uaXplX2lycShpOTE1
LT5kcm0uaXJxKTsKPiA+ICAgfQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfcnVudGltZV9wbV9l
bmFibGVfaW50ZXJydXB0cyAtIHJ1bnRpbWUgaW50ZXJydXB0IGVuYWJsaW5nCj4gPiAtICogQGRl
dl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBp
bnN0YW5jZQo+ID4gICAgKgo+ID4gICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gZW5hYmxl
IGludGVycnVwdHMgYXQgcnVudGltZSwgYm90aCBpbiB0aGUgcnVudGltZQo+ID4gICAgKiBwbSBh
bmQgdGhlIHN5c3RlbSBzdXNwZW5kL3Jlc3VtZSBjb2RlLgo+ID4gICAgKi8KPiA+IC12b2lkIGlu
dGVsX3J1bnRpbWVfcG1fZW5hYmxlX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfcnVudGltZV9wbV9lbmFibGVfaW50ZXJydXB0cyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlkZXZfcHJpdi0+cnVu
dGltZV9wbS5pcnFzX2VuYWJsZWQgPSB0cnVlOwo+ID4gLQlkZXZfcHJpdi0+ZHJtLmRyaXZlci0+
aXJxX3ByZWluc3RhbGwoJmRldl9wcml2LT5kcm0pOwo+ID4gLQlkZXZfcHJpdi0+ZHJtLmRyaXZl
ci0+aXJxX3Bvc3RpbnN0YWxsKCZkZXZfcHJpdi0+ZHJtKTsKPiA+ICsJaTkxNS0+cnVudGltZV9w
bS5pcnFzX2VuYWJsZWQgPSB0cnVlOwo+ID4gKwlpOTE1LT5kcm0uZHJpdmVyLT5pcnFfcHJlaW5z
dGFsbCgmaTkxNS0+ZHJtKTsKPiA+ICsJaTkxNS0+ZHJtLmRyaXZlci0+aXJxX3Bvc3RpbnN0YWxs
KCZpOTE1LT5kcm0pOwo+ID4gICB9Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9pcnEuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmgKPiA+IGluZGV4
IGNiMjVkZDIxMzMwOC4uNjA0NTA0OTkzNTEzIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9pcnEuaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9p
cnEuaAo+ID4gQEAgLTEzLDc3ICsxMyw3NyBAQAo+ID4gICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZTsKPiA+ICAgc3RydWN0IGludGVsX2NydGM7Cj4gPiAtZXh0ZXJuIHZvaWQgaW50ZWxfaXJxX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC1leHRlcm4gdm9pZCBp
bnRlbF9pcnFfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLWlu
dCBpbnRlbF9pcnFfaW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+
ID4gLXZvaWQgaW50ZWxfaXJxX3VuaW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwo+ID4gK2V4dGVybiB2b2lkIGludGVsX2lycV9pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KTsKPiA+ICtleHRlcm4gdm9pZCBpbnRlbF9pcnFfZmluaShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAraW50IGludGVsX2lycV9pbnN0YWxsKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX2lycV91bmluc3RhbGwoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gLXUzMiBpOTE1X3BpcGVzdGF0X2VuYWJs
ZV9tYXNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt1MzIgaTkxNV9w
aXBlc3RhdF9lbmFibGVfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJICAgICAgZW51bSBwaXBlIHBpcGUpOwo+ID4gICB2b2lkCj4gPiAtaTkxNV9lbmFibGVfcGlw
ZXN0YXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSwK
PiA+ICtpOTE1X2VuYWJsZV9waXBlc3RhdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
ZW51bSBwaXBlIHBpcGUsCj4gPiAgIAkJICAgICB1MzIgc3RhdHVzX21hc2spOwo+ID4gICB2b2lk
Cj4gPiAtaTkxNV9kaXNhYmxlX3BpcGVzdGF0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgZW51bSBwaXBlIHBpcGUsCj4gPiAraTkxNV9kaXNhYmxlX3BpcGVzdGF0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSwKPiA+ICAgCQkgICAgICB1MzIg
c3RhdHVzX21hc2spOwo+ID4gLXZvaWQgdmFsbGV5dmlld19lbmFibGVfZGlzcGxheV9pcnFzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCB2YWxsZXl2aWV3X2Rp
c2FibGVfZGlzcGxheV9pcnFzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4g
PiArdm9pZCB2YWxsZXl2aWV3X2VuYWJsZV9kaXNwbGF5X2lycXMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgdmFsbGV5dmlld19kaXNhYmxlX2Rpc3BsYXlfaXJxcyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAtdm9pZCBpOTE1X2hvdHBsdWdfaW50
ZXJydXB0X3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9p
ZCBpOTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJCSAgIHUzMiBtYXNrLAo+ID4gICAJCQkJICAgdTMyIGJpdHMpOwo+ID4g
LXZvaWQgaWxrX3VwZGF0ZV9kaXNwbGF5X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiArdm9pZCBpbGtfdXBkYXRlX2Rpc3BsYXlfaXJxKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgdTMyIGludGVycnVwdF9tYXNrLAo+ID4gICAJCQkg
ICAgdTMyIGVuYWJsZWRfaXJxX21hc2spOwo+ID4gICBzdGF0aWMgaW5saW5lIHZvaWQKPiA+IC1p
bGtfZW5hYmxlX2Rpc3BsYXlfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
dTMyIGJpdHMpCj4gPiAraWxrX2VuYWJsZV9kaXNwbGF5X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgdTMyIGJpdHMpCj4gPiAgIHsKPiA+IC0JaWxrX3VwZGF0ZV9kaXNwbGF5X2ly
cShkZXZfcHJpdiwgYml0cywgYml0cyk7Cj4gPiArCWlsa191cGRhdGVfZGlzcGxheV9pcnEoaTkx
NSwgYml0cywgYml0cyk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGlubGluZSB2b2lkCj4gPiAtaWxr
X2Rpc2FibGVfZGlzcGxheV9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1
MzIgYml0cykKPiA+ICtpbGtfZGlzYWJsZV9kaXNwbGF5X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgdTMyIGJpdHMpCj4gPiAgIHsKPiA+IC0JaWxrX3VwZGF0ZV9kaXNwbGF5X2ly
cShkZXZfcHJpdiwgYml0cywgMCk7Cj4gPiArCWlsa191cGRhdGVfZGlzcGxheV9pcnEoaTkxNSwg
Yml0cywgMCk7Cj4gPiAgIH0KPiA+IC12b2lkIGJkd191cGRhdGVfcGlwZV9pcnEoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgYmR3X3VwZGF0ZV9waXBlX2lycShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJIGVudW0gcGlwZSBwaXBlLAo+
ID4gICAJCQkgdTMyIGludGVycnVwdF9tYXNrLAo+ID4gICAJCQkgdTMyIGVuYWJsZWRfaXJxX21h
c2spOwo+ID4gLXN0YXRpYyBpbmxpbmUgdm9pZCBiZHdfZW5hYmxlX3BpcGVfaXJxKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW5saW5lIHZvaWQgYmR3X2Vu
YWJsZV9waXBlX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAg
ICAgICBlbnVtIHBpcGUgcGlwZSwgdTMyIGJpdHMpCj4gPiAgIHsKPiA+IC0JYmR3X3VwZGF0ZV9w
aXBlX2lycShkZXZfcHJpdiwgcGlwZSwgYml0cywgYml0cyk7Cj4gPiArCWJkd191cGRhdGVfcGlw
ZV9pcnEoaTkxNSwgcGlwZSwgYml0cywgYml0cyk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW5saW5l
IHZvaWQgYmR3X2Rpc2FibGVfcGlwZV9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK3N0YXRpYyBpbmxpbmUgdm9pZCBiZHdfZGlzYWJsZV9waXBlX2lycShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQllbnVtIHBpcGUgcGlwZSwgdTMyIGJp
dHMpCj4gPiAgIHsKPiA+IC0JYmR3X3VwZGF0ZV9waXBlX2lycShkZXZfcHJpdiwgcGlwZSwgYml0
cywgMCk7Cj4gPiArCWJkd191cGRhdGVfcGlwZV9pcnEoaTkxNSwgcGlwZSwgYml0cywgMCk7Cj4g
PiAgIH0KPiA+IC12b2lkIGlieF9kaXNwbGF5X2ludGVycnVwdF91cGRhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgaWJ4X2Rpc3BsYXlfaW50ZXJydXB0X3Vw
ZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgdTMyIGludGVy
cnVwdF9tYXNrLAo+ID4gICAJCQkJICB1MzIgZW5hYmxlZF9pcnFfbWFzayk7Cj4gPiAgIHN0YXRp
YyBpbmxpbmUgdm9pZAo+ID4gLWlieF9lbmFibGVfZGlzcGxheV9pbnRlcnJ1cHQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgYml0cykKPiA+ICtpYnhfZW5hYmxlX2Rpc3Bs
YXlfaW50ZXJydXB0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgYml0cykKPiA+
ICAgewo+ID4gLQlpYnhfZGlzcGxheV9pbnRlcnJ1cHRfdXBkYXRlKGRldl9wcml2LCBiaXRzLCBi
aXRzKTsKPiA+ICsJaWJ4X2Rpc3BsYXlfaW50ZXJydXB0X3VwZGF0ZShpOTE1LCBiaXRzLCBiaXRz
KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW5saW5lIHZvaWQKPiA+IC1pYnhfZGlzYWJsZV9kaXNw
bGF5X2ludGVycnVwdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBiaXRz
KQo+ID4gK2lieF9kaXNhYmxlX2Rpc3BsYXlfaW50ZXJydXB0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCB1MzIgYml0cykKPiA+ICAgewo+ID4gLQlpYnhfZGlzcGxheV9pbnRlcnJ1cHRf
dXBkYXRlKGRldl9wcml2LCBiaXRzLCAwKTsKPiA+ICsJaWJ4X2Rpc3BsYXlfaW50ZXJydXB0X3Vw
ZGF0ZShpOTE1LCBiaXRzLCAwKTsKPiA+ICAgfQo+ID4gLXZvaWQgZ2VuNV9lbmFibGVfZ3RfaXJx
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIG1hc2spOwo+ID4gLXZvaWQg
Z2VuNV9kaXNhYmxlX2d0X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUz
MiBtYXNrKTsKPiA+IC12b2lkIGdlbjZfbWFza19wbV9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCB1MzIgbWFzayk7Cj4gPiAtdm9pZCBnZW42X3VubWFza19wbV9pcnEoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFzayk7Cj4gPiAtdm9pZCBnZW4x
MV9yZXNldF9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+ID4gLXZvaWQgZ2VuNl9yZXNldF9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgZ2VuNl9lbmFibGVfcnBzX2ludGVycnVwdHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGdlbjZfZGlzYWJsZV9y
cHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZv
aWQgZ2VuNl9ycHNfcmVzZXRfZWkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsK
PiA+ICt2b2lkIGdlbjVfZW5hYmxlX2d0X2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwgdTMyIG1hc2spOwo+ID4gK3ZvaWQgZ2VuNV9kaXNhYmxlX2d0X2lycShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIG1hc2spOwo+ID4gK3ZvaWQgZ2VuNl9tYXNrX3BtX2lycShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIG1hc2spOwo+ID4gK3ZvaWQgZ2VuNl91
bm1hc2tfcG1faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgbWFzayk7Cj4g
PiArdm9pZCBnZW4xMV9yZXNldF9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSk7Cj4gPiArdm9pZCBnZW42X3Jlc2V0X3Jwc19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGdlbjZfZW5hYmxlX3Jwc19pbnRlcnJ1cHRz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGdlbjZfZGlzYWJsZV9y
cHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBn
ZW42X3Jwc19yZXNldF9laShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIHN0
YXRpYyBpbmxpbmUgdTMyIGdlbjZfc2FuaXRpemVfcnBzX3BtX21hc2soY29uc3Qgc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJICAgIHUzMiBtYXNrKQo+ID4gQEAgLTkx
LDI1ICs5MSwyNSBAQCBzdGF0aWMgaW5saW5lIHUzMiBnZW42X3Nhbml0aXplX3Jwc19wbV9tYXNr
KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJcmV0dXJuIG1hc2sg
JiB+aTkxNS0+Z3RfcG0ucnBzLnBtX2ludHJtc2tfbWJ6Owo+ID4gICB9Cj4gPiAtdm9pZCBpbnRl
bF9ydW50aW1lX3BtX2Rpc2FibGVfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpOwo+ID4gLXZvaWQgaW50ZWxfcnVudGltZV9wbV9lbmFibGVfaW50ZXJydXB0cyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXN0YXRpYyBpbmxpbmUgYm9v
bCBpbnRlbF9pcnFzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gK3ZvaWQgaW50ZWxfcnVudGltZV9wbV9kaXNhYmxlX2ludGVycnVwdHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfcnVudGltZV9wbV9lbmFibGVfaW50
ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArc3RhdGljIGlubGlu
ZSBib29sIGludGVsX2lycXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiA+ICAgewo+ID4gICAJLyoKPiA+ICAgCSAqIFdlIG9ubHkgdXNlIGRybV9pcnFfdW5pbnN0YWxs
KCkgYXQgdW5sb2FkIGFuZCBWVCBzd2l0Y2gsIHNvCj4gPiAgIAkgKiB0aGlzIGlzIHRoZSBvbmx5
IHRoaW5nIHdlIG5lZWQgdG8gY2hlY2suCj4gPiAgIAkgKi8KPiA+IC0JcmV0dXJuIGRldl9wcml2
LT5ydW50aW1lX3BtLmlycXNfZW5hYmxlZDsKPiA+ICsJcmV0dXJuIGk5MTUtPnJ1bnRpbWVfcG0u
aXJxc19lbmFibGVkOwo+ID4gICB9Cj4gPiAgIGludCBpbnRlbF9nZXRfY3J0Y19zY2FubGluZShz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0Yyk7Cj4gPiAtdm9pZCBnZW44X2lycV9wb3dlcl93ZWxsX3Bv
c3RfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGdl
bjhfaXJxX3Bvd2VyX3dlbGxfcG9zdF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJCQkgICAgIHU4IHBpcGVfbWFzayk7Cj4gPiAtdm9pZCBnZW44X2lycV9wb3dl
cl93ZWxsX3ByZV9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICt2b2lkIGdlbjhfaXJxX3Bvd2VyX3dlbGxfcHJlX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgIHU4IHBpcGVfbWFzayk7Cj4gPiAtdm9pZCBnZW45
X3Jlc2V0X2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cj4gPiAtdm9pZCBnZW45X2VuYWJsZV9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgZ2VuOV9kaXNhYmxlX2d1Y19pbnRlcnJ1cHRzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBnZW45X3Jlc2V0X2d1
Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGdl
bjlfZW5hYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiA+ICt2b2lkIGdlbjlfZGlzYWJsZV9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSk7Cj4gPiAgIHZvaWQgZ2VuMTFfcmVzZXRfZ3VjX2ludGVycnVwdHMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICB2b2lkIGdlbjExX2VuYWJsZV9ndWNfaW50
ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIHZvaWQgZ2VuMTFf
ZGlzYWJsZV9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9tZW1jcHkuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfbWVtY3B5LmMKPiA+IGluZGV4IDc5ZjhlYzc1NjM2Mi4uMmJk
NjY0YzE2YmEwIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9tZW1j
cHkuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9tZW1jcHkuYwo+ID4gQEAg
LTk0LDcgKzk0LDcgQEAgYm9vbCBpOTE1X21lbWNweV9mcm9tX3djKHZvaWQgKmRzdCwgY29uc3Qg
dm9pZCAqc3JjLCB1bnNpZ25lZCBsb25nIGxlbikKPiA+ICAgCXJldHVybiBmYWxzZTsKPiA+ICAg
fQo+ID4gLXZvaWQgaTkxNV9tZW1jcHlfaW5pdF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpOTE1X21lbWNweV9pbml0X2Vhcmx5KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAkvKgo+ID4gICAJICogU29tZSBoeXBl
cnZpc29ycyAoZS5nLiBLVk0pIGRvbid0IHN1cHBvcnQgVkVYLXByZWZpeCBpbnN0cnVjdGlvbnMK
PiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Jkdy5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9iZHcuYwo+ID4gaW5kZXggNGFjZGI5NDU1NWI3Li43
Yzk3Y2Q5MGU5NzMgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29h
X2Jkdy5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Jkdy5jCj4gPiBA
QCAtNjQsMjggKzY0LDI4IEBAIHNob3dfdGVzdF9vYV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBz
dHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB9Cj4gPiAgIHZv
aWQKPiA+IC1pOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19iZHcoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2JkdyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJsY3B5KGRldl9wcml2
LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gPiArCXN0cmxjcHkoaTkxNS0+cGVyZi5vYS50
ZXN0X2NvbmZpZy51dWlkLAo+ID4gICAJCSJkNmRlNmY1NS1lNTI2LTRmNzktYTZhNi1kNzMxNWMw
OTA0NGUiLAo+ID4gLQkJc2l6ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQp
KTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+ID4gKwkJc2l6
ZW9mKGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ID4gKwlpOTE1LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmlkID0gMTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcu
bXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0X29hKTsK
PiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdfdGVz
dF9vYTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJB
WV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hOwo+ID4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJBWV9T
SVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9j
b25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7Cj4gPiArCWk5
MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShi
X2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4X2V1X2Nv
bmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3Mg
PSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmln
LmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ID4g
LQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICJkNmRl
NmY1NS1lNTI2LTRmNzktYTZhNi1kNzMxNWMwOTA0NGUiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+cGVyZi5vYS50ZXN0
X2NvbmZpZy5hdHRyczsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRy
aWMubmFtZSA9ICJkNmRlNmY1NS1lNTI2LTRmNzktYTZhNi1kNzMxNWMwOTA0NGUiOwo+ID4gKwlp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGk5MTUtPnBlcmYu
b2EudGVzdF9jb25maWcuYXR0cnM7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19p
ZC5hdHRyOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmk5MTUt
PnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gPiAtCWRldl9wcml2
LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+
ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5t
b2RlID0gMDQ0NDsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9j
b25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gPiArCWk5MTUtPnBlcmYu
b2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7Cj4gPiArCWk5
MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rf
b2FfaWQ7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X29hX2Jkdy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9iZHcuaAo+ID4gaW5kZXgg
MGU2NjdmMWE4YWExLi42OTQ3OWU1YjQzNmYgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X29hX2Jkdy5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X29hX2Jkdy5oCj4gPiBAQCAtMTAsNiArMTAsNiBAQAo+ID4gICAjaWZuZGVmIF9fSTkxNV9PQV9C
RFdfSF9fCj4gPiAgICNkZWZpbmUgX19JOTE1X09BX0JEV19IX18KPiA+IC1leHRlcm4gdm9pZCBp
OTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19iZHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKPiA+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19iZHco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAjZW5kaWYKPiA+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2J4dC5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9vYV9ieHQuYwo+ID4gaW5kZXggYTQ0MTk1YzM5OTIzLi41ZWMyMzZiMzNlY2Mg
MTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2J4dC5jCj4gPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2J4dC5jCj4gPiBAQCAtNjIsMjggKzYy
LDI4IEBAIHNob3dfdGVzdF9vYV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNl
X2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB9Cj4gPiAgIHZvaWQKPiA+IC1pOTE1
X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19ieHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gK2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2J4dChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJsY3B5KGRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLnV1aWQsCj4gPiArCXN0cmxjcHkoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51
dWlkLAo+ID4gICAJCSI1ZWU3MmY1Yy0wOTJmLTQyMWUtOGI3MC0yMjVmN2MzZTk2MTIiLAo+ID4g
LQkJc2l6ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiA+IC0JZGV2
X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+ID4gKwkJc2l6ZW9mKGk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmln
LmlkID0gMTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBt
dXhfY29uZmlnX3Rlc3Rfb2E7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11
eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsKPiA+ICsJ
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9j
b25maWdfdGVzdF9vYSk7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291
bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGJfY291bnRl
cl9jb25maWdfdGVzdF9vYSk7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3Vu
dGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7Cj4gPiArCWk5MTUtPnBlcmYub2Eu
dGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29u
ZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3Jl
Z3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0
X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29h
KTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2Nv
bmZpZ190ZXN0X29hOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19s
ZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICI1ZWU3MmY1Yy0wOTJmLTQy
MWUtOGI3MC0yMjVmN2MzZTk2MTIiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5zeXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRy
czsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICI1
ZWU3MmY1Yy0wOTJmLTQyMWUtOGI3MC0yMjVmN2MzZTk2MTIiOwo+ID4gKwlpOTE1LT5wZXJmLm9h
LnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGk5MTUtPnBlcmYub2EudGVzdF9jb25m
aWcuYXR0cnM7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0g
JmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ID4g
KwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmk5MTUtPnBlcmYub2EudGVz
dF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+ID4gLQlkZXZfcHJp
di0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsK
PiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cg
PSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNf
bWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25m
aWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7Cj4gPiArCWk5MTUtPnBlcmYub2Eu
dGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiAg
IH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2J4dC5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9ieHQuaAo+ID4gaW5kZXggNjc5ZTkyY2Y0ZjFk
Li40N2Q4MzI3ZjM4YTEgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X29hX2J4dC5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2J4dC5oCj4g
PiBAQCAtMTAsNiArMTAsNiBAQAo+ID4gICAjaWZuZGVmIF9fSTkxNV9PQV9CWFRfSF9fCj4gPiAg
ICNkZWZpbmUgX19JOTE1X09BX0JYVF9IX18KPiA+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9h
ZF90ZXN0X2NvbmZpZ19ieHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+
ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19ieHQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAjZW5kaWYKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0Mi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9vYV9jZmxndDIuYwo+ID4gaW5kZXggN2Y2MGQ1MWI4NzYxLi4zOTcyY2Q3ZGNiZmMgMTAwNjQ0
Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0Mi5jCj4gPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0Mi5jCj4gPiBAQCAtNjMsMjggKzYz
LDI4IEBAIHNob3dfdGVzdF9vYV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNl
X2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB9Cj4gPiAgIHZvaWQKPiA+IC1pOTE1
X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jZmxndDIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gK2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2NmbGd0MihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJsY3B5KGRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gPiArCXN0cmxjcHkoaTkxNS0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy51dWlkLAo+ID4gICAJCSI3NGZiNDkwMi1kM2QzLTQyMzctOWU5MC1jYmRjNjhkMGE0NDYi
LAo+ID4gLQkJc2l6ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiA+
IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+ID4gKwkJc2l6ZW9mKGk5
MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLmlkID0gMTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3Jl
Z3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29u
ZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJ
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsK
PiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpF
KG11eF9jb25maWdfdGVzdF9vYSk7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJp
di0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGJf
Y291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcu
Yl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7Cj4gPiArCWk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50
ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5m
bGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ190
ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4
X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhf
cmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZf
cHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICI3NGZiNDkwMi1k
M2QzLTQyMzctOWU5MC1jYmRjNjhkMGE0NDYiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0
X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5hdHRyczsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFt
ZSA9ICI3NGZiNDkwMi1kM2QzLTQyMzctOWU5MC1jYmRjNjhkMGE0NDYiOwo+ID4gKwlpOTE1LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGk5MTUtPnBlcmYub2EudGVz
dF9jb25maWcuYXR0cnM7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJz
WzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRy
Owo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmk5MTUtPnBlcmYu
b2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gPiAtCWRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+ID4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0g
MDQ0NDsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lk
LnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcu
c3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVz
dF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7Cj4gPiArCWk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7
Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Nm
bGd0Mi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9jZmxndDIuaAo+ID4gaW5kZXgg
NGQ2MDI1NTU5YmJlLi40MzQ1NDVjOWM1ZDkgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X29hX2NmbGd0Mi5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X29hX2NmbGd0Mi5oCj4gPiBAQCAtMTAsNiArMTAsNiBAQAo+ID4gICAjaWZuZGVmIF9fSTkx
NV9PQV9DRkxHVDJfSF9fCj4gPiAgICNkZWZpbmUgX19JOTE1X09BX0NGTEdUMl9IX18KPiA+IC1l
eHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jZmxndDIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90
ZXN0X2NvbmZpZ19jZmxndDIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAj
ZW5kaWYKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0
My5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9jZmxndDMuYwo+ID4gaW5kZXggYTky
YzM4ZTNhMGNlLi5jMDBiOWQ5ZDZkZGYgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X29hX2NmbGd0My5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X29hX2NmbGd0My5jCj4gPiBAQCAtNjMsMjggKzYzLDI4IEBAIHNob3dfdGVzdF9vYV9pZChzdHJ1
Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVm
KQo+ID4gICB9Cj4gPiAgIHZvaWQKPiA+IC1pOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jZmxn
dDMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2k5MTVfcGVyZl9sb2Fk
X3Rlc3RfY29uZmlnX2NmbGd0MyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAg
ewo+ID4gLQlzdHJsY3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gPiAr
CXN0cmxjcHkoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ID4gICAJCSI1NzdlOGUy
Yy0zZmEwLTQ4NzUtODc0My0zNTM4ZDU4NWUzYjAiLAo+ID4gLQkJc2l6ZW9mKGRldl9wcml2LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9j
b25maWcuaWQgPSAxOwo+ID4gKwkJc2l6ZW9mKGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVp
ZCkpOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiA+IC0JZGV2X3By
aXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7Cj4g
PiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJ
WkUobXV4X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5t
dXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gPiAt
CWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVy
X2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2Nv
dW50ZXJfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4g
PiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJf
Y29uZmlnX3Rlc3Rfb2E7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVy
X3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190
ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVu
ID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gKwlp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhf
ZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5z
eXNmc19tZXRyaWMubmFtZSA9ICI1NzdlOGUyYy0zZmEwLTQ4NzUtODc0My0zNTM4ZDU4NWUzYjAi
Owo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMg
PSBkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiA+ICsJaTkxNS0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICI1NzdlOGUyYy0zZmEwLTQ4NzUtODc0
My0zNTM4ZDU4NWUzYjAiOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21l
dHJpYy5hdHRycyA9IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gPiAtCWRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLmF0dHJzWzBdID0gJmk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmlj
X2lkLmF0dHI7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJp
Y19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsKPiA+IC0JZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4g
PiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9
ICJpZCI7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0
dHIubW9kZSA9IDA0NDQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0My5oIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9vYV9jZmxndDMuaAo+ID4gaW5kZXggMDY5N2Y0MDc3NDAyLi4yYzIzZWRhMDU2YWEg
MTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0My5oCj4g
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NmbGd0My5oCj4gPiBAQCAtMTAs
NiArMTAsNiBAQAo+ID4gICAjaWZuZGVmIF9fSTkxNV9PQV9DRkxHVDNfSF9fCj4gPiAgICNkZWZp
bmUgX19JOTE1X09BX0NGTEdUM19IX18KPiA+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90
ZXN0X2NvbmZpZ19jZmxndDMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+
ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jZmxndDMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAjZW5kaWYKPiA+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Nodi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9vYV9jaHYuYwo+ID4gaW5kZXggNzFlYzg4OWEwMTE0Li41ODI5ZDI0ZDBmN2MgMTAwNjQ0Cj4g
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Nodi5jCj4gPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Nodi5jCj4gPiBAQCAtNjMsMjggKzYzLDI4IEBAIHNo
b3dfdGVzdF9vYV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0
ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB9Cj4gPiAgIHZvaWQKPiA+IC1pOTE1X3BlcmZfbG9h
ZF90ZXN0X2NvbmZpZ19jaHYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2NodihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gLQlzdHJsY3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LnV1aWQsCj4gPiArCXN0cmxjcHkoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ID4g
ICAJCSI0YTUzNGIwNy1jYmEzLTQxNGQtOGQ2MC04NzQ4MzBlODgzYWEiLAo+ID4gLQkJc2l6ZW9m
KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiA+IC0JZGV2X3ByaXYtPnBl
cmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+ID4gKwkJc2l6ZW9mKGk5MTUtPnBlcmYub2EudGVz
dF9jb25maWcudXVpZCkpOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsK
PiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmln
X3Rlc3Rfb2E7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xl
biA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50
ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsKPiA+ICsJaTkxNS0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVz
dF9vYSk7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdz
ID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0
X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdf
dGVzdF9vYSk7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3Mg
PSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25m
aWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rf
b2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4
X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5m
bGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJ
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0
X29hOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJB
WV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50
ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICI0YTUzNGIwNy1jYmEzLTQxNGQtOGQ2MC04
NzQ4MzBlODgzYWEiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19t
ZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiA+ICsJ
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICI0YTUzNGIwNy1j
YmEzLTQxNGQtOGQ2MC04NzQ4MzBlODgzYWEiOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29u
ZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7
Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2
LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ID4gKwlpOTE1LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmk5MTUtPnBlcmYub2EudGVzdF9jb25maWcu
c3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsKPiA+IC0JZGV2
X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rl
c3Rfb2FfaWQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lk
LmF0dHIubmFtZSA9ICJpZCI7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNf
bWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25m
aWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiAgIH0KPiA+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Nodi5oIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9vYV9jaHYuaAo+ID4gaW5kZXggMDk4NmVhZTMxMzVmLi40YmIzYjZi
ZTdiZDIgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Nodi5o
Cj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2Nodi5oCj4gPiBAQCAtMTAs
NiArMTAsNiBAQAo+ID4gICAjaWZuZGVmIF9fSTkxNV9PQV9DSFZfSF9fCj4gPiAgICNkZWZpbmUg
X19JOTE1X09BX0NIVl9IX18KPiA+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2Nv
bmZpZ19jaHYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtleHRlcm4g
dm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jaHYoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwo+ID4gICAjZW5kaWYKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X29hX2NubC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9jbmwuYwo+
ID4gaW5kZXggNWMyM2Q4ODNkNmM5Li5mY2YwOGI5ZTdjNzMgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NubC5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X29hX2NubC5jCj4gPiBAQCAtNzUsMjggKzc1LDI4IEBAIHNob3dfdGVzdF9vYV9p
ZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hh
ciAqYnVmKQo+ID4gICB9Cj4gPiAgIHZvaWQKPiA+IC1pOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZp
Z19jbmwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2k5MTVfcGVyZl9s
b2FkX3Rlc3RfY29uZmlnX2NubChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAg
ewo+ID4gLQlzdHJsY3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gPiAr
CXN0cmxjcHkoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ID4gICAJCSJkYjQxZWRk
NC1kOGU3LTQ3MzAtYWQxMS1iOWEyZDY4MzM1MDMiLAo+ID4gLQkJc2l6ZW9mKGRldl9wcml2LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9j
b25maWcuaWQgPSAxOwo+ID4gKwkJc2l6ZW9mKGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVp
ZCkpOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiA+IC0JZGV2X3By
aXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7Cj4g
PiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJ
WkUobXV4X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5t
dXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gPiAt
CWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVy
X2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2Nv
dW50ZXJfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4g
PiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJf
Y29uZmlnX3Rlc3Rfb2E7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVy
X3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190
ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVu
ID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gKwlp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhf
ZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5z
eXNmc19tZXRyaWMubmFtZSA9ICJkYjQxZWRkNC1kOGU3LTQ3MzAtYWQxMS1iOWEyZDY4MzM1MDMi
Owo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMg
PSBkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiA+ICsJaTkxNS0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICJkYjQxZWRkNC1kOGU3LTQ3MzAtYWQx
MS1iOWEyZDY4MzM1MDMiOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21l
dHJpYy5hdHRycyA9IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gPiAtCWRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLmF0dHJzWzBdID0gJmk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmlj
X2lkLmF0dHI7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJp
Y19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsKPiA+IC0JZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4g
PiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9
ICJpZCI7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0
dHIubW9kZSA9IDA0NDQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NubC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9vYV9jbmwuaAo+ID4gaW5kZXggZTgzMGE0MDZhZmYyLi5jNzAxMDE2NTUwNDkgMTAwNjQ0
Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NubC5oCj4gPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2NubC5oCj4gPiBAQCAtMTAsNiArMTAsNiBAQAo+
ID4gICAjaWZuZGVmIF9fSTkxNV9PQV9DTkxfSF9fCj4gPiAgICNkZWZpbmUgX19JOTE1X09BX0NO
TF9IX18KPiA+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jbmwoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtleHRlcm4gdm9pZCBpOTE1X3Bl
cmZfbG9hZF90ZXN0X2NvbmZpZ19jbmwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+
ID4gICAjZW5kaWYKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29h
X2dsay5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9nbGsuYwo+ID4gaW5kZXggNGJk
ZGE2NmRmN2QyLi5mZGIzOGI5ZWE5YmIgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X29hX2dsay5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29h
X2dsay5jCj4gPiBAQCAtNjIsMjggKzYyLDI4IEBAIHNob3dfdGVzdF9vYV9pZChzdHJ1Y3QgZGV2
aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4g
ICB9Cj4gPiAgIHZvaWQKPiA+IC1pOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19nbGsoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29u
ZmlnX2dsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJs
Y3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gPiArCXN0cmxjcHkoaTkx
NS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ID4gICAJCSJkZDNmZDc4OS1lNzgzLTQyMDQt
OGNkMC1iNjcxYmJjY2IwY2YiLAo+ID4gLQkJc2l6ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLnV1aWQpKTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAx
Owo+ID4gKwkJc2l6ZW9mKGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ID4gKwlp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2Eu
dGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7Cj4gPiAtCWRldl9wcml2
LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZp
Z190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11
eF9jb25maWdfdGVzdF9vYTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVn
c19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gPiAtCWRldl9wcml2LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0
X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19s
ZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gPiArCWk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rf
b2E7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0g
QVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4g
LQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0la
RShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gKwlpOTE1LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rl
c3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMu
bmFtZSA9ICJkZDNmZDc4OS1lNzgzLTQyMDQtOGNkMC1iNjcxYmJjY2IwY2YiOwo+ID4gLQlkZXZf
cHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5zeXNmc19tZXRyaWMubmFtZSA9ICJkZDNmZDc4OS1lNzgzLTQyMDQtOGNkMC1iNjcxYmJjY2Iw
Y2YiOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9
IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5
c2ZzX21ldHJpY19pZC5hdHRyOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJz
WzBdID0gJmk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4g
PiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5h
bWUgPSAiaWQiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRy
aWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25m
aWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiArCWk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gPiAr
CWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0
NDQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cg
PSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X29hX2dsay5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9nbGsu
aAo+ID4gaW5kZXggMDZkZWRmOTkxZWRiLi41ZDA3OTg2ODI3YzggMTAwNjQ0Cj4gPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2dsay5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X29hX2dsay5oCj4gPiBAQCAtMTAsNiArMTAsNiBAQAo+ID4gICAjaWZuZGVm
IF9fSTkxNV9PQV9HTEtfSF9fCj4gPiAgICNkZWZpbmUgX19JOTE1X09BX0dMS19IX18KPiA+IC1l
eHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19nbGsoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0
X2NvbmZpZ19nbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAjZW5kaWYK
PiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2hzdy5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9oc3cuYwo+ID4gaW5kZXggY2M2NTI2ZmRkMmJkLi42
NDAzMDFjOWZiOWQgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29h
X2hzdy5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2hzdy5jCj4gPiBA
QCAtOTIsMjggKzkyLDI4IEBAIHNob3dfcmVuZGVyX2Jhc2ljX2lkKHN0cnVjdCBkZXZpY2UgKmtk
ZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpiCj4gPiAgIH0KPiA+ICAg
dm9pZAo+ID4gLWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2hzdyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAraTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfaHN3KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cmxjcHkoZGV2X3By
aXYtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCwKPiA+ICsJc3RybGNweShpOTE1LT5wZXJmLm9h
LnRlc3RfY29uZmlnLnV1aWQsCj4gPiAgIAkJIjQwM2Q4ODMyLTFhMjctNGFhNi1hNjRlLWY1Mzg5
Y2U3YjIxMiIsCj4gPiAtCQlzaXplb2YoZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcudXVp
ZCkpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5pZCA9IDE7Cj4gPiArCQlz
aXplb2YoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkKSk7Cj4gPiArCWk5MTUtPnBlcmYu
b2EudGVzdF9jb25maWcuaWQgPSAxOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5tdXhfcmVncyA9IG11eF9jb25maWdfcmVuZGVyX2Jhc2ljOwo+ID4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfcmVu
ZGVyX2Jhc2ljKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11
eF9jb25maWdfcmVuZGVyX2Jhc2ljOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11
eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ19yZW5kZXJfYmFzaWMpOwo+ID4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVncyA9IGJfY291bnRlcl9j
b25maWdfcmVuZGVyX2Jhc2ljOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5i
X2NvdW50ZXJfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdfcmVuZGVyX2Jh
c2ljKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVncyA9IGJf
Y291bnRlcl9jb25maWdfcmVuZGVyX2Jhc2ljOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29u
ZmlnLmJfY291bnRlcl9yZWdzX2xlbiA9IEFSUkFZX1NJWkUoYl9jb3VudGVyX2NvbmZpZ19yZW5k
ZXJfYmFzaWMpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3Mg
PSBmbGV4X2V1X2NvbmZpZ19yZW5kZXJfYmFzaWM7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3JlbmRl
cl9iYXNpYyk7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuZmxleF9yZWdzID0gZmxl
eF9ldV9jb25maWdfcmVuZGVyX2Jhc2ljOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmln
LmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3JlbmRlcl9iYXNpYyk7
Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5uYW1lID0g
IjQwM2Q4ODMyLTFhMjctNGFhNi1hNjRlLWY1Mzg5Y2U3YjIxMiI7Cj4gPiAtCWRldl9wcml2LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGRldl9wcml2LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmF0dHJzOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2Zz
X21ldHJpYy5uYW1lID0gIjQwM2Q4ODMyLTFhMjctNGFhNi1hNjRlLWY1Mzg5Y2U3YjIxMiI7Cj4g
PiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljLmF0dHJzID0gaTkxNS0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9j
b25maWcuYXR0cnNbMF0gPSAmZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljX2lkLmF0dHI7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnNbMF0gPSAm
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0cjsKPiA+IC0JZGV2
X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJp
ZCI7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5h
dHRyLm1vZGUgPSAwNDQ0Owo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNm
c19tZXRyaWNfaWQuc2hvdyA9IHNob3dfcmVuZGVyX2Jhc2ljX2lkOwo+ID4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+ID4gKwlp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm1vZGUgPSAwNDQ0
Owo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5zaG93ID0g
c2hvd19yZW5kZXJfYmFzaWNfaWQ7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X29hX2hzdy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9o
c3cuaAo+ID4gaW5kZXggM2QwYzg3MGNkMGJkLi43ODEyYTlkZjg2NDcgMTAwNjQ0Cj4gPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2hzdy5oCj4gPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X29hX2hzdy5oCj4gPiBAQCAtMTAsNiArMTAsNiBAQAo+ID4gICAjaWZu
ZGVmIF9fSTkxNV9PQV9IU1dfSF9fCj4gPiAgICNkZWZpbmUgX19JOTE1X09BX0hTV19IX18KPiA+
IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19oc3coc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90
ZXN0X2NvbmZpZ19oc3coc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAjZW5k
aWYKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2ljbC5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9pY2wuYwo+ID4gaW5kZXggYmFhNTE0MjdhNTQz
Li4yYThjNmRlNjE5YmEgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X29hX2ljbC5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2ljbC5jCj4g
PiBAQCAtNzIsMjggKzcyLDI4IEBAIHNob3dfdGVzdF9vYV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2
LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB9Cj4gPiAg
IHZvaWQKPiA+IC1pOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19pY2woc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2ljbChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJsY3B5KGRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gPiArCXN0cmxjcHkoaTkxNS0+cGVyZi5v
YS50ZXN0X2NvbmZpZy51dWlkLAo+ID4gICAJCSJhMjkxNjY1ZS0yNDRiLTRiNzYtOWI5YS0wMWRl
OWQzYzgwNjgiLAo+ID4gLQkJc2l6ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1
aWQpKTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+ID4gKwkJ
c2l6ZW9mKGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ID4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25m
aWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9h
LnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0X29h
KTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdf
dGVzdF9vYTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBB
UlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hOwo+ID4g
LQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJB
WV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVz
dF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7Cj4gPiAr
CWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJSQVlfU0la
RShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0
X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJp
di0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4X2V1
X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3Jl
Z3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29u
ZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2EpOwo+
ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICJh
MjkxNjY1ZS0yNDRiLTRiNzYtOWI5YS0wMWRlOWQzYzgwNjgiOwo+ID4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+cGVyZi5vYS50
ZXN0X2NvbmZpZy5hdHRyczsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19t
ZXRyaWMubmFtZSA9ICJhMjkxNjY1ZS0yNDRiLTRiNzYtOWI5YS0wMWRlOWQzYzgwNjgiOwo+ID4g
KwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29u
ZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJp
Y19pZC5hdHRyOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmk5
MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gPiAtCWRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQi
Owo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0
ci5tb2RlID0gMDQ0NDsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNf
bWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVz
dF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gPiArCWk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7Cj4gPiAr
CWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rl
c3Rfb2FfaWQ7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X29hX2ljbC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9pY2wuaAo+ID4gaW5k
ZXggMjRlYWE5N2Q2MWJhLi5hN2M1MGQzMWU2NzggMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X29hX2ljbC5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X29hX2ljbC5oCj4gPiBAQCAtMTAsNiArMTAsNiBAQAo+ID4gICAjaWZuZGVmIF9fSTkxNV9P
QV9JQ0xfSF9fCj4gPiAgICNkZWZpbmUgX19JOTE1X09BX0lDTF9IX18KPiA+IC1leHRlcm4gdm9p
ZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19pY2woc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiA+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19p
Y2woc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAjZW5kaWYKPiA+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0Mi5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9vYV9rYmxndDIuYwo+ID4gaW5kZXggMTY4ZTQ5YWIwZDRkLi45NzUz
MTFkZjNkNjIgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2ti
bGd0Mi5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0Mi5jCj4g
PiBAQCAtNjMsMjggKzYzLDI4IEBAIHNob3dfdGVzdF9vYV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2
LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB9Cj4gPiAg
IHZvaWQKPiA+IC1pOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19rYmxndDIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2ti
bGd0MihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJsY3B5
KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gPiArCXN0cmxjcHkoaTkxNS0+
cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ID4gICAJCSJiYWEzYzdlNC01MmI2LTRiODUtODAx
ZS00NjVhOTRiNzQ2ZGQiLAo+ID4gLQkJc2l6ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29u
ZmlnLnV1aWQpKTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+
ID4gKwkJc2l6ZW9mKGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ID4gKwlpOTE1
LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVz
dF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7Cj4gPiAtCWRldl9wcml2LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190
ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9j
b25maWdfdGVzdF9vYTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19s
ZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gPiAtCWRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29h
Owo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4g
PSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gPiArCWk5MTUtPnBlcmYu
b2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7
Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJS
QVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShm
bGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5m
bGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRl
c3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rf
b2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFt
ZSA9ICJiYWEzYzdlNC01MmI2LTRiODUtODAxZS00NjVhOTRiNzQ2ZGQiOwo+ID4gLQlkZXZfcHJp
di0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5z
eXNmc19tZXRyaWMubmFtZSA9ICJiYWEzYzdlNC01MmI2LTRiODUtODAxZS00NjVhOTRiNzQ2ZGQi
Owo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGk5
MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2Zz
X21ldHJpY19pZC5hdHRyOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBd
ID0gJmk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gPiAt
CWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUg
PSAiaWQiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNf
aWQuYXR0ci5tb2RlID0gMDQ0NDsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcu
c3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiArCWk5MTUtPnBlcmYu
b2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gPiArCWk5
MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7
Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBz
aG93X3Rlc3Rfb2FfaWQ7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X29hX2tibGd0Mi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9rYmxn
dDIuaAo+ID4gaW5kZXggYTU1Mzk4YTkwNGRlLi41MzY1NWRlN2I5NzYgMTAwNjQ0Cj4gPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0Mi5oCj4gPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0Mi5oCj4gPiBAQCAtMTAsNiArMTAsNiBAQAo+ID4g
ICAjaWZuZGVmIF9fSTkxNV9PQV9LQkxHVDJfSF9fCj4gPiAgICNkZWZpbmUgX19JOTE1X09BX0tC
TEdUMl9IX18KPiA+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19rYmxn
dDIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtleHRlcm4gdm9pZCBp
OTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19rYmxndDIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwo+ID4gICAjZW5kaWYKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X29hX2tibGd0My5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9rYmxndDMu
Ywo+ID4gaW5kZXggNmZmYTU1M2MzODhlLi5lZDM5ZjhkZDlhZjIgMTAwNjQ0Cj4gPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0My5jCj4gPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X29hX2tibGd0My5jCj4gPiBAQCAtNjMsMjggKzYzLDI4IEBAIHNob3df
dGVzdF9vYV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAq
YXR0ciwgY2hhciAqYnVmKQo+ID4gICB9Cj4gPiAgIHZvaWQKPiA+IC1pOTE1X3BlcmZfbG9hZF90
ZXN0X2NvbmZpZ19rYmxndDMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2tibGd0MyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJsY3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29u
ZmlnLnV1aWQsCj4gPiArCXN0cmxjcHkoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+
ID4gICAJCSJmMTc5MmYzMi02ZGIyLTRiNTAtYjRiMi01NTcxMjhmMTY4OGQiLAo+ID4gLQkJc2l6
ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiA+IC0JZGV2X3ByaXYt
PnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+ID4gKwkJc2l6ZW9mKGk5MTUtPnBlcmYub2Eu
dGVzdF9jb25maWcudXVpZCkpOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0g
MTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29u
ZmlnX3Rlc3Rfb2E7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdz
X2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsKPiA+ICsJaTkxNS0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdf
dGVzdF9vYSk7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9y
ZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50
ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25m
aWdfdGVzdF9vYSk7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3Jl
Z3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9j
b25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rl
c3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBm
bGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiA+
ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190
ZXN0X29hOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBB
UlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICJmMTc5MmYzMi02ZGIyLTRiNTAtYjRi
Mi01NTcxMjhmMTY4OGQiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNm
c19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiA+
ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICJmMTc5MmYz
Mi02ZGIyLTRiNTAtYjRiMi01NTcxMjhmMTY4OGQiOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0
cnM7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ID4gKwlpOTE1
LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmk5MTUtPnBlcmYub2EudGVzdF9jb25m
aWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29u
ZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+ID4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsKPiA+IC0J
ZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93
X3Rlc3Rfb2FfaWQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmlj
X2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lz
ZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9j
b25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiAgIH0KPiA+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0My5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9rYmxndDMuaAo+ID4gaW5kZXggM2RkZDM0ODNiN2Nj
Li42MGViZTJiMjBhZGEgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X29hX2tibGd0My5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX2tibGd0
My5oCj4gPiBAQCAtMTAsNiArMTAsNiBAQAo+ID4gICAjaWZuZGVmIF9fSTkxNV9PQV9LQkxHVDNf
SF9fCj4gPiAgICNkZWZpbmUgX19JOTE1X09BX0tCTEdUM19IX18KPiA+IC1leHRlcm4gdm9pZCBp
OTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19rYmxndDMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiA+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19r
YmxndDMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAjZW5kaWYKPiA+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0Mi5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9za2xndDIuYwo+ID4gaW5kZXggN2NlNmVlODUxZDQzLi42
MGI0ZGJjZDRjNTkgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29h
X3NrbGd0Mi5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0Mi5j
Cj4gPiBAQCAtNjIsMjggKzYyLDI4IEBAIHNob3dfdGVzdF9vYV9pZChzdHJ1Y3QgZGV2aWNlICpr
ZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB9Cj4g
PiAgIHZvaWQKPiA+IC1pOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19za2xndDIoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmln
X3NrbGd0MihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJs
Y3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gPiArCXN0cmxjcHkoaTkx
NS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ID4gICAJCSIxNjUxOTQ5Zi0wYWMwLTRjYjEt
YTA2Zi1kYWZkNzRhNDA3ZDEiLAo+ID4gLQkJc2l6ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLnV1aWQpKTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAx
Owo+ID4gKwkJc2l6ZW9mKGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ID4gKwlp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2Eu
dGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7Cj4gPiAtCWRldl9wcml2
LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZp
Z190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11
eF9jb25maWdfdGVzdF9vYTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVn
c19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gPiAtCWRldl9wcml2LT5w
ZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0
X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19s
ZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gPiArCWk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rf
b2E7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0g
QVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4g
LQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0la
RShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gKwlpOTE1LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rl
c3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMu
bmFtZSA9ICIxNjUxOTQ5Zi0wYWMwLTRjYjEtYTA2Zi1kYWZkNzRhNDA3ZDEiOwo+ID4gLQlkZXZf
cHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZp
Zy5zeXNmc19tZXRyaWMubmFtZSA9ICIxNjUxOTQ5Zi0wYWMwLTRjYjEtYTA2Zi1kYWZkNzRhNDA3
ZDEiOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9
IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9h
LnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5
c2ZzX21ldHJpY19pZC5hdHRyOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJz
WzBdID0gJmk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4g
PiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5h
bWUgPSAiaWQiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRy
aWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25m
aWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiArCWk5MTUtPnBl
cmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gPiAr
CWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0
NDQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cg
PSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X29hX3NrbGd0Mi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9z
a2xndDIuaAo+ID4gaW5kZXggYmU2MjU2MDM3MjM5Li5lZTZmNzQ3NTAyZWEgMTAwNjQ0Cj4gPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0Mi5oCj4gPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0Mi5oCj4gPiBAQCAtMTAsNiArMTAsNiBAQAo+
ID4gICAjaWZuZGVmIF9fSTkxNV9PQV9TS0xHVDJfSF9fCj4gPiAgICNkZWZpbmUgX19JOTE1X09B
X1NLTEdUMl9IX18KPiA+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19z
a2xndDIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtleHRlcm4gdm9p
ZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19za2xndDIoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwo+ID4gICAjZW5kaWYKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X29hX3NrbGd0My5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9za2xn
dDMuYwo+ID4gaW5kZXggMDg2Y2EyNjMxZTFjLi44YzIzY2Y3MTJhN2EgMTAwNjQ0Cj4gPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0My5jCj4gPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0My5jCj4gPiBAQCAtNjMsMjggKzYzLDI4IEBAIHNo
b3dfdGVzdF9vYV9pZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0
ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB9Cj4gPiAgIHZvaWQKPiA+IC1pOTE1X3BlcmZfbG9h
ZF90ZXN0X2NvbmZpZ19za2xndDMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gK2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX3NrbGd0MyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJsY3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLnV1aWQsCj4gPiArCXN0cmxjcHkoaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlk
LAo+ID4gICAJCSIyYjk4NTgwMy1kM2M5LTQ2MjktOGE0Zi02MzRiZmVjYmEwZTgiLAo+ID4gLQkJ
c2l6ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQpKTsKPiA+IC0JZGV2X3By
aXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPSAxOwo+ID4gKwkJc2l6ZW9mKGk5MTUtPnBlcmYu
b2EudGVzdF9jb25maWcudXVpZCkpOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlk
ID0gMTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhf
Y29uZmlnX3Rlc3Rfb2E7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9y
ZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9IG11eF9jb25maWdfdGVzdF9vYTsKPiA+ICsJaTkx
NS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25m
aWdfdGVzdF9vYSk7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRl
cl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5v
YS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9j
b25maWdfdGVzdF9vYSk7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVy
X3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2E7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVz
dF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVuID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmln
X3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3Mg
PSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlfU0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsK
PiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZp
Z190ZXN0X29hOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4g
PSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVy
Zi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICIyYjk4NTgwMy1kM2M5LTQ2Mjkt
OGE0Zi02MzRiZmVjYmEwZTgiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5z
eXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyczsK
PiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICIyYjk4
NTgwMy1kM2M5LTQ2MjktOGE0Zi02MzRiZmVjYmEwZTgiOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRl
c3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRycyA9IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcu
YXR0cnM7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRl
dl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ID4gKwlp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmk5MTUtPnBlcmYub2EudGVzdF9j
b25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyLm5hbWUgPSAiaWQiOwo+ID4gLQlkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsKPiA+
IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBz
aG93X3Rlc3Rfb2FfaWQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0
cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcu
c3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9IDA0NDQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVz
dF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiAgIH0K
PiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0My5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9za2xndDMuaAo+ID4gaW5kZXggNjUwYmViMDY4
ZTU2Li4zNWNjYjQxMjVkNzEgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X29hX3NrbGd0My5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3Nr
bGd0My5oCj4gPiBAQCAtMTAsNiArMTAsNiBAQAo+ID4gICAjaWZuZGVmIF9fSTkxNV9PQV9TS0xH
VDNfSF9fCj4gPiAgICNkZWZpbmUgX19JOTE1X09BX1NLTEdUM19IX18KPiA+IC1leHRlcm4gdm9p
ZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19za2xndDMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KTsKPiA+ICtleHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZp
Z19za2xndDMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAjZW5kaWYKPiA+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0NC5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9vYV9za2xndDQuYwo+ID4gaW5kZXggYjI5MWE2ZWI4YTg3
Li5iODQ2ZGE2MTk4ZjggMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X29hX3NrbGd0NC5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0
NC5jCj4gPiBAQCAtNjMsMjggKzYzLDI4IEBAIHNob3dfdGVzdF9vYV9pZChzdHJ1Y3QgZGV2aWNl
ICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB9
Cj4gPiAgIHZvaWQKPiA+IC1pOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19za2xndDQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2k5MTVfcGVyZl9sb2FkX3Rlc3RfY29u
ZmlnX3NrbGd0NChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlz
dHJsY3B5KGRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnV1aWQsCj4gPiArCXN0cmxjcHko
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy51dWlkLAo+ID4gICAJCSI4ODJmYTQzMy0xZjRhLTRh
NjctYTk2Mi1jNzQxODg4ZmU1ZjUiLAo+ID4gLQkJc2l6ZW9mKGRldl9wcml2LT5wZXJmLm9hLnRl
c3RfY29uZmlnLnV1aWQpKTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQg
PSAxOwo+ID4gKwkJc2l6ZW9mKGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcudXVpZCkpOwo+ID4g
KwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmlkID0gMTsKPiA+IC0JZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcubXV4X3JlZ3MgPSBtdXhfY29uZmlnX3Rlc3Rfb2E7Cj4gPiAtCWRldl9w
cml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLm11eF9yZWdzX2xlbiA9IEFSUkFZX1NJWkUobXV4X2Nv
bmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhfcmVncyA9
IG11eF9jb25maWdfdGVzdF9vYTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5tdXhf
cmVnc19sZW4gPSBBUlJBWV9TSVpFKG11eF9jb25maWdfdGVzdF9vYSk7Cj4gPiAtCWRldl9wcml2
LT5wZXJmLm9hLnRlc3RfY29uZmlnLmJfY291bnRlcl9yZWdzID0gYl9jb3VudGVyX2NvbmZpZ190
ZXN0X29hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5iX2NvdW50ZXJfcmVn
c19sZW4gPSBBUlJBWV9TSVpFKGJfY291bnRlcl9jb25maWdfdGVzdF9vYSk7Cj4gPiArCWk5MTUt
PnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3MgPSBiX2NvdW50ZXJfY29uZmlnX3Rl
c3Rfb2E7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYl9jb3VudGVyX3JlZ3NfbGVu
ID0gQVJSQVlfU0laRShiX2NvdW50ZXJfY29uZmlnX3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+
cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+
ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5mbGV4X3JlZ3NfbGVuID0gQVJSQVlf
U0laRShmbGV4X2V1X2NvbmZpZ190ZXN0X29hKTsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy5mbGV4X3JlZ3MgPSBmbGV4X2V1X2NvbmZpZ190ZXN0X29hOwo+ID4gKwlpOTE1LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmZsZXhfcmVnc19sZW4gPSBBUlJBWV9TSVpFKGZsZXhfZXVfY29uZmln
X3Rlc3Rfb2EpOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRy
aWMubmFtZSA9ICI4ODJmYTQzMy0xZjRhLTRhNjctYTk2Mi1jNzQxODg4ZmU1ZjUiOwo+ID4gLQlk
ZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMuYXR0cnMgPSBkZXZfcHJp
di0+cGVyZi5vYS50ZXN0X2NvbmZpZy5hdHRyczsKPiA+ICsJaTkxNS0+cGVyZi5vYS50ZXN0X2Nv
bmZpZy5zeXNmc19tZXRyaWMubmFtZSA9ICI4ODJmYTQzMy0xZjRhLTRhNjctYTk2Mi1jNzQxODg4
ZmU1ZjUiOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYy5hdHRy
cyA9IGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuYXR0cnM7Cj4gPiAtCWRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLmF0dHJzWzBdID0gJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LnN5c2ZzX21ldHJpY19pZC5hdHRyOwo+ID4gKwlpOTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLmF0
dHJzWzBdID0gJmk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHI7
Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRy
Lm5hbWUgPSAiaWQiOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19t
ZXRyaWNfaWQuYXR0ci5tb2RlID0gMDQ0NDsKPiA+IC0JZGV2X3ByaXYtPnBlcmYub2EudGVzdF9j
b25maWcuc3lzZnNfbWV0cmljX2lkLnNob3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiArCWk5MTUt
PnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubmFtZSA9ICJpZCI7Cj4g
PiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLmF0dHIubW9kZSA9
IDA0NDQ7Cj4gPiArCWk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuc3lzZnNfbWV0cmljX2lkLnNo
b3cgPSBzaG93X3Rlc3Rfb2FfaWQ7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0NC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9v
YV9za2xndDQuaAo+ID4gaW5kZXggOGRjZjg0OWQxMzFlLi5mM2Y2ZDdiZjI4ZTAgMTAwNjQ0Cj4g
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0NC5oCj4gPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X29hX3NrbGd0NC5oCj4gPiBAQCAtMTAsNiArMTAsNiBA
QAo+ID4gICAjaWZuZGVmIF9fSTkxNV9PQV9TS0xHVDRfSF9fCj4gPiAgICNkZWZpbmUgX19JOTE1
X09BX1NLTEdUNF9IX18KPiA+IC1leHRlcm4gdm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZp
Z19za2xndDQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtleHRlcm4g
dm9pZCBpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19za2xndDQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ID4gICAjZW5kaWYKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3BlcmYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCj4g
PiBpbmRleCBkOTJkZGZhZGEyNjIuLmUwZWY3N2VjNGRhMyAxMDA2NDQKPiA+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3BlcmYuYwo+ID4gQEAgLTM2Niw3ICszNjYsNyBAQCBzdHJ1Y3QgcGVyZl9vcGVuX3By
b3BlcnRpZXMgewo+ID4gICAJaW50IG9hX3BlcmlvZF9leHBvbmVudDsKPiA+ICAgfTsKPiA+IC1z
dGF0aWMgdm9pZCBmcmVlX29hX2NvbmZpZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiArc3RhdGljIHZvaWQgZnJlZV9vYV9jb25maWcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCSAgIHN0cnVjdCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmlnKQo+
ID4gICB7Cj4gPiAgIAlpZiAoIVBUUl9FUlIob2FfY29uZmlnLT5mbGV4X3JlZ3MpKQo+ID4gQEAg
LTM3OCw0OCArMzc4LDQ4IEBAIHN0YXRpYyB2b2lkIGZyZWVfb2FfY29uZmlnKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWtmcmVlKG9hX2NvbmZpZyk7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgdm9pZCBwdXRfb2FfY29uZmlnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBwdXRfb2FfY29uZmlnKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ID4gICAJCQkgIHN0cnVjdCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmln
KQo+ID4gICB7Cj4gPiAgIAlpZiAoIWF0b21pY19kZWNfYW5kX3Rlc3QoJm9hX2NvbmZpZy0+cmVm
X2NvdW50KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWZyZWVfb2FfY29uZmlnKGRldl9wcml2LCBv
YV9jb25maWcpOwo+ID4gKwlmcmVlX29hX2NvbmZpZyhpOTE1LCBvYV9jb25maWcpOwo+ID4gICB9
Cj4gPiAtc3RhdGljIGludCBnZXRfb2FfY29uZmlnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW50IGdldF9vYV9jb25maWcoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCSBpbnQgbWV0cmljc19zZXQsCj4gPiAgIAkJCSBzdHJ1Y3Qg
aTkxNV9vYV9jb25maWcgKipvdXRfY29uZmlnKQo+ID4gICB7Cj4gPiAgIAlpbnQgcmV0Owo+ID4g
ICAJaWYgKG1ldHJpY3Nfc2V0ID09IDEpIHsKPiA+IC0JCSpvdXRfY29uZmlnID0gJmRldl9wcml2
LT5wZXJmLm9hLnRlc3RfY29uZmlnOwo+ID4gLQkJYXRvbWljX2luYygmZGV2X3ByaXYtPnBlcmYu
b2EudGVzdF9jb25maWcucmVmX2NvdW50KTsKPiA+ICsJCSpvdXRfY29uZmlnID0gJmk5MTUtPnBl
cmYub2EudGVzdF9jb25maWc7Cj4gPiArCQlhdG9taWNfaW5jKCZpOTE1LT5wZXJmLm9hLnRlc3Rf
Y29uZmlnLnJlZl9jb3VudCk7Cj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAgIAl9Cj4gPiAtCXJldCA9
IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZGV2X3ByaXYtPnBlcmYubWV0cmljc19sb2NrKTsK
PiA+ICsJcmV0ID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZpOTE1LT5wZXJmLm1ldHJpY3Nf
bG9jayk7Cj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiAtCSpvdXRfY29u
ZmlnID0gaWRyX2ZpbmQoJmRldl9wcml2LT5wZXJmLm1ldHJpY3NfaWRyLCBtZXRyaWNzX3NldCk7
Cj4gPiArCSpvdXRfY29uZmlnID0gaWRyX2ZpbmQoJmk5MTUtPnBlcmYubWV0cmljc19pZHIsIG1l
dHJpY3Nfc2V0KTsKPiA+ICAgCWlmICghKm91dF9jb25maWcpCj4gPiAgIAkJcmV0ID0gLUVJTlZB
TDsKPiA+ICAgCWVsc2UKPiA+ICAgCQlhdG9taWNfaW5jKCYoKm91dF9jb25maWcpLT5yZWZfY291
bnQpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wZXJmLm1ldHJpY3NfbG9jayk7Cj4g
PiArCW11dGV4X3VubG9jaygmaTkxNS0+cGVyZi5tZXRyaWNzX2xvY2spOwo+ID4gICAJcmV0dXJu
IHJldDsKPiA+ICAgfQo+ID4gLXN0YXRpYyB1MzIgZ2VuOF9vYV9od190YWlsX3JlYWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB1MzIgZ2VuOF9vYV9od190
YWlsX3JlYWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXJl
dHVybiBJOTE1X1JFQUQoR0VOOF9PQVRBSUxQVFIpICYgR0VOOF9PQVRBSUxQVFJfTUFTSzsKPiA+
ICAgfQo+ID4gLXN0YXRpYyB1MzIgZ2VuN19vYV9od190YWlsX3JlYWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB1MzIgZ2VuN19vYV9od190YWlsX3JlYWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiBvYXN0YXR1
czEgPSBJOTE1X1JFQUQoR0VON19PQVNUQVRVUzEpOwo+ID4gQEAgLTQyOCw3ICs0MjgsNyBAQCBz
dGF0aWMgdTMyIGdlbjdfb2FfaHdfdGFpbF9yZWFkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICAgLyoqCj4gPiAgICAqIG9hX2J1ZmZlcl9jaGVja191bmxvY2tlZCAtIGNo
ZWNrIGZvciBkYXRhIGFuZCB1cGRhdGUgdGFpbCBwdHIgc3RhdGUKPiA+IC0gKiBAZGV2X3ByaXY6
IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNl
Cj4gPiAgICAqCj4gPiAgICAqIFRoaXMgaXMgZWl0aGVyIGNhbGxlZCB2aWEgZm9wcyAoZm9yIGJs
b2NraW5nIHJlYWRzIGluIHVzZXIgY3R4KSBvciB0aGUgcG9sbAo+ID4gICAgKiBjaGVjayBocnRp
bWVyIChhdG9taWMgY3R4KSB0byBjaGVjayB0aGUgT0EgYnVmZmVyIHRhaWwgcG9pbnRlciBhbmQg
Y2hlY2sKPiA+IEBAIC00NTAsOSArNDUwLDkgQEAgc3RhdGljIHUzMiBnZW43X29hX2h3X3RhaWxf
cmVhZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgICAqCj4gPiAgICAq
IFJldHVybnM6ICV0cnVlIGlmIHRoZSBPQSBidWZmZXIgY29udGFpbnMgZGF0YSwgZWxzZSAlZmFs
c2UKPiA+ICAgICovCj4gPiAtc3RhdGljIGJvb2wgb2FfYnVmZmVyX2NoZWNrX3VubG9ja2VkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgYm9vbCBvYV9idWZm
ZXJfY2hlY2tfdW5sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsK
PiA+IC0JaW50IHJlcG9ydF9zaXplID0gZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLmZvcm1h
dF9zaXplOwo+ID4gKwlpbnQgcmVwb3J0X3NpemUgPSBpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5m
b3JtYXRfc2l6ZTsKPiA+ICAgCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gPiAgIAl1bnNpZ25lZCBp
bnQgYWdlZF9pZHg7Cj4gPiAgIAl1MzIgaGVhZCwgaHdfdGFpbCwgYWdlZF90YWlsLCBhZ2luZ190
YWlsOwo+ID4gQEAgLTQ2MiwxOSArNDYyLDE5IEBAIHN0YXRpYyBib29sIG9hX2J1ZmZlcl9jaGVj
a191bmxvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiBj
b3VsZCByZXN1bHQgaW4gYW4gT0EgYnVmZmVyIHJlc2V0IHdoaWNoIG1pZ2h0IHJlc2V0IHRoZSBo
ZWFkLAo+ID4gICAJICogdGFpbHNbXSBhbmQgYWdlZF90YWlsIHN0YXRlLgo+ID4gICAJICovCj4g
PiAtCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIucHRyX2xv
Y2ssIGZsYWdzKTsKPiA+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPnBlcmYub2Eub2FfYnVm
ZmVyLnB0cl9sb2NrLCBmbGFncyk7Cj4gPiAgIAkvKiBOQjogVGhlIGhlYWQgd2Ugb2JzZXJ2ZSBo
ZXJlIG1pZ2h0IGVmZmVjdGl2ZWx5IGJlIGEgbGl0dGxlIG91dCBvZgo+ID4gICAJICogZGF0ZSAo
YmV0d2VlbiBoZWFkIGFuZCB0YWlsc1thZ2VkX2lkeF0ub2Zmc2V0IGlmIHRoZXJlIGlzIGN1cnJl
bnRseQo+ID4gICAJICogYSByZWFkKCkgaW4gcHJvZ3Jlc3MuCj4gPiAgIAkgKi8KPiA+IC0JaGVh
ZCA9IGRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5oZWFkOwo+ID4gKwloZWFkID0gaTkxNS0+
cGVyZi5vYS5vYV9idWZmZXIuaGVhZDsKPiA+IC0JYWdlZF9pZHggPSBkZXZfcHJpdi0+cGVyZi5v
YS5vYV9idWZmZXIuYWdlZF90YWlsX2lkeDsKPiA+IC0JYWdlZF90YWlsID0gZGV2X3ByaXYtPnBl
cmYub2Eub2FfYnVmZmVyLnRhaWxzW2FnZWRfaWR4XS5vZmZzZXQ7Cj4gPiAtCWFnaW5nX3RhaWwg
PSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudGFpbHNbIWFnZWRfaWR4XS5vZmZzZXQ7Cj4g
PiArCWFnZWRfaWR4ID0gaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIuYWdlZF90YWlsX2lkeDsKPiA+
ICsJYWdlZF90YWlsID0gaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudGFpbHNbYWdlZF9pZHhdLm9m
ZnNldDsKPiA+ICsJYWdpbmdfdGFpbCA9IGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnRhaWxzWyFh
Z2VkX2lkeF0ub2Zmc2V0Owo+ID4gLQlod190YWlsID0gZGV2X3ByaXYtPnBlcmYub2Eub3BzLm9h
X2h3X3RhaWxfcmVhZChkZXZfcHJpdik7Cj4gPiArCWh3X3RhaWwgPSBpOTE1LT5wZXJmLm9hLm9w
cy5vYV9od190YWlsX3JlYWQoaTkxNSk7Cj4gPiAgIAkvKiBUaGUgdGFpbCBwb2ludGVyIGluY3Jl
YXNlcyBpbiA2NCBieXRlIGluY3JlbWVudHMsCj4gPiAgIAkgKiBub3QgaW4gcmVwb3J0X3NpemUg
c3RlcHMuLi4KPiA+IEBAIC00OTQsMTYgKzQ5NCwxNiBAQCBzdGF0aWMgYm9vbCBvYV9idWZmZXJf
Y2hlY2tfdW5sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJ
ICogYXZhaWxhYmxlKSB3aXRob3V0IG5lZWRpbmcgdG8gd2FpdCBmb3IgYSBsYXRlciBocnRpbWVy
IGNhbGxiYWNrLgo+ID4gICAJICovCj4gPiAgIAlpZiAoYWdpbmdfdGFpbCAhPSBJTlZBTElEX1RB
SUxfUFRSICYmCj4gPiAtCSAgICAoKG5vdyAtIGRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5h
Z2luZ190aW1lc3RhbXApID4KPiA+ICsJICAgICgobm93IC0gaTkxNS0+cGVyZi5vYS5vYV9idWZm
ZXIuYWdpbmdfdGltZXN0YW1wKSA+Cj4gPiAgIAkgICAgIE9BX1RBSUxfTUFSR0lOX05TRUMpKSB7
Cj4gPiAgIAkJYWdlZF9pZHggXj0gMTsKPiA+IC0JCWRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZl
ci5hZ2VkX3RhaWxfaWR4ID0gYWdlZF9pZHg7Cj4gPiArCQlpOTE1LT5wZXJmLm9hLm9hX2J1ZmZl
ci5hZ2VkX3RhaWxfaWR4ID0gYWdlZF9pZHg7Cj4gPiAgIAkJYWdlZF90YWlsID0gYWdpbmdfdGFp
bDsKPiA+ICAgCQkvKiBNYXJrIHRoYXQgd2UgbmVlZCBhIG5ldyBwb2ludGVyIHRvIHN0YXJ0IGFn
aW5nLi4uICovCj4gPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudGFpbHNbIWFnZWRf
aWR4XS5vZmZzZXQgPSBJTlZBTElEX1RBSUxfUFRSOwo+ID4gKwkJaTkxNS0+cGVyZi5vYS5vYV9i
dWZmZXIudGFpbHNbIWFnZWRfaWR4XS5vZmZzZXQgPSBJTlZBTElEX1RBSUxfUFRSOwo+ID4gICAJ
CWFnaW5nX3RhaWwgPSBJTlZBTElEX1RBSUxfUFRSOwo+ID4gICAJfQo+ID4gQEAgLTUxOCw3ICs1
MTgsNyBAQCBzdGF0aWMgYm9vbCBvYV9idWZmZXJfY2hlY2tfdW5sb2NrZWQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJaWYgKGFnaW5nX3RhaWwgPT0gSU5WQUxJRF9U
QUlMX1BUUiAmJgo+ID4gICAJICAgIChhZ2VkX3RhaWwgPT0gSU5WQUxJRF9UQUlMX1BUUiB8fAo+
ID4gICAJICAgICBPQV9UQUtFTihod190YWlsLCBhZ2VkX3RhaWwpID49IHJlcG9ydF9zaXplKSkg
ewo+ID4gLQkJc3RydWN0IGk5MTVfdm1hICp2bWEgPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZm
ZXIudm1hOwo+ID4gKwkJc3RydWN0IGk5MTVfdm1hICp2bWEgPSBpOTE1LT5wZXJmLm9hLm9hX2J1
ZmZlci52bWE7Cj4gPiAgIAkJdTMyIGd0dF9vZmZzZXQgPSBpOTE1X2dndHRfb2Zmc2V0KHZtYSk7
Cj4gPiAgIAkJLyogQmUgcGFyYW5vaWQgYW5kIGRvIGEgYm91bmRzIGNoZWNrIG9uIHRoZSBwb2lu
dGVyIHJlYWQgYmFjawo+ID4gQEAgLTUyNywxNiArNTI3LDE2IEBAIHN0YXRpYyBib29sIG9hX2J1
ZmZlcl9jaGVja191bmxvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiAgIAkJICovCj4gPiAgIAkJaWYgKGh3X3RhaWwgPj0gZ3R0X29mZnNldCAmJgo+ID4gICAJCSAg
ICBod190YWlsIDwgKGd0dF9vZmZzZXQgKyBPQV9CVUZGRVJfU0laRSkpIHsKPiA+IC0JCQlkZXZf
cHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudGFpbHNbIWFnZWRfaWR4XS5vZmZzZXQgPQo+ID4gKwkJ
CWk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnRhaWxzWyFhZ2VkX2lkeF0ub2Zmc2V0ID0KPiA+ICAg
CQkJCWFnaW5nX3RhaWwgPSBod190YWlsOwo+ID4gLQkJCWRldl9wcml2LT5wZXJmLm9hLm9hX2J1
ZmZlci5hZ2luZ190aW1lc3RhbXAgPSBub3c7Cj4gPiArCQkJaTkxNS0+cGVyZi5vYS5vYV9idWZm
ZXIuYWdpbmdfdGltZXN0YW1wID0gbm93Owo+ID4gICAJCX0gZWxzZSB7Cj4gPiAgIAkJCURSTV9F
UlJPUigiSWdub3Jpbmcgc3B1cmlvdXMgb3V0IG9mIHJhbmdlIE9BIGJ1ZmZlciB0YWlsIHBvaW50
ZXIgPSAldVxuIiwKPiA+ICAgCQkJCSAgaHdfdGFpbCk7Cj4gPiAgIAkJfQo+ID4gICAJfQo+ID4g
LQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIucHRy
X2xvY2ssIGZsYWdzKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+cGVyZi5v
YS5vYV9idWZmZXIucHRyX2xvY2ssIGZsYWdzKTsKPiA+ICAgCXJldHVybiBhZ2VkX3RhaWwgPT0g
SU5WQUxJRF9UQUlMX1BUUiA/Cj4gPiAgIAkJZmFsc2UgOiBPQV9UQUtFTihhZ2VkX3RhaWwsIGhl
YWQpID49IHJlcG9ydF9zaXplOwo+ID4gQEAgLTU5OSw4ICs1OTksOCBAQCBzdGF0aWMgaW50IGFw
cGVuZF9vYV9zYW1wbGUoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKPiA+ICAgCQkJ
ICAgIHNpemVfdCAqb2Zmc2V0LAo+ID4gICAJCQkgICAgY29uc3QgdTggKnJlcG9ydCkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBzdHJlYW0tPmRldl9w
cml2Owo+ID4gLQlpbnQgcmVwb3J0X3NpemUgPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIu
Zm9ybWF0X3NpemU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFt
LT5pOTE1Owo+ID4gKwlpbnQgcmVwb3J0X3NpemUgPSBpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5m
b3JtYXRfc2l6ZTsKPiA+ICAgCXN0cnVjdCBkcm1faTkxNV9wZXJmX3JlY29yZF9oZWFkZXIgaGVh
ZGVyOwo+ID4gICAJdTMyIHNhbXBsZV9mbGFncyA9IHN0cmVhbS0+c2FtcGxlX2ZsYWdzOwo+ID4g
QEAgLTY1MSwxMCArNjUxLDEwIEBAIHN0YXRpYyBpbnQgZ2VuOF9hcHBlbmRfb2FfcmVwb3J0cyhz
dHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ID4gICAJCQkJICBzaXplX3QgY291bnQs
Cj4gPiAgIAkJCQkgIHNpemVfdCAqb2Zmc2V0KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gPiAtCWludCByZXBvcnRf
c2l6ZSA9IGRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5mb3JtYXRfc2l6ZTsKPiA+IC0JdTgg
Km9hX2J1Zl9iYXNlID0gZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnZhZGRyOwo+ID4gLQl1
MzIgZ3R0X29mZnNldCA9IGk5MTVfZ2d0dF9vZmZzZXQoZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVm
ZmVyLnZtYSk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5p
OTE1Owo+ID4gKwlpbnQgcmVwb3J0X3NpemUgPSBpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5mb3Jt
YXRfc2l6ZTsKPiA+ICsJdTggKm9hX2J1Zl9iYXNlID0gaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIu
dmFkZHI7Cj4gPiArCXUzMiBndHRfb2Zmc2V0ID0gaTkxNV9nZ3R0X29mZnNldChpOTE1LT5wZXJm
Lm9hLm9hX2J1ZmZlci52bWEpOwo+ID4gICAJdTMyIG1hc2sgPSAoT0FfQlVGRkVSX1NJWkUgLSAx
KTsKPiA+ICAgCXNpemVfdCBzdGFydF9vZmZzZXQgPSAqb2Zmc2V0Owo+ID4gICAJdW5zaWduZWQg
bG9uZyBmbGFnczsKPiA+IEBAIC02NjYsMTMgKzY2NiwxMyBAQCBzdGF0aWMgaW50IGdlbjhfYXBw
ZW5kX29hX3JlcG9ydHMoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKPiA+ICAgCWlm
IChXQVJOX09OKCFzdHJlYW0tPmVuYWJsZWQpKQo+ID4gICAJCXJldHVybiAtRUlPOwo+ID4gLQlz
cGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBm
bGFncyk7Cj4gPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5w
dHJfbG9jaywgZmxhZ3MpOwo+ID4gLQloZWFkID0gZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVy
LmhlYWQ7Cj4gPiAtCWFnZWRfdGFpbF9pZHggPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIu
YWdlZF90YWlsX2lkeDsKPiA+IC0JdGFpbCA9IGRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci50
YWlsc1thZ2VkX3RhaWxfaWR4XS5vZmZzZXQ7Cj4gPiArCWhlYWQgPSBpOTE1LT5wZXJmLm9hLm9h
X2J1ZmZlci5oZWFkOwo+ID4gKwlhZ2VkX3RhaWxfaWR4ID0gaTkxNS0+cGVyZi5vYS5vYV9idWZm
ZXIuYWdlZF90YWlsX2lkeDsKPiA+ICsJdGFpbCA9IGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnRh
aWxzW2FnZWRfdGFpbF9pZHhdLm9mZnNldDsKPiA+IC0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgm
ZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFncyk7Cj4gPiArCXNwaW5f
dW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFn
cyk7Cj4gPiAgIAkvKgo+ID4gICAJICogQW4gaW52YWxpZCB0YWlsIHBvaW50ZXIgaGVyZSBtZWFu
cyB3ZSdyZSBzdGlsbCB3YWl0aW5nIGZvciB0aGUgcG9sbAo+ID4gQEAgLTczNiwxMiArNzM2LDEy
IEBAIHN0YXRpYyBpbnQgZ2VuOF9hcHBlbmRfb2FfcmVwb3J0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0
cmVhbSAqc3RyZWFtLAo+ID4gICAJCXJlYXNvbiA9ICgocmVwb3J0MzJbMF0gPj4gT0FSRVBPUlRf
UkVBU09OX1NISUZUKSAmCj4gPiAgIAkJCSAgT0FSRVBPUlRfUkVBU09OX01BU0spOwo+ID4gICAJ
CWlmIChyZWFzb24gPT0gMCkgewo+ID4gLQkJCWlmIChfX3JhdGVsaW1pdCgmZGV2X3ByaXYtPnBl
cmYub2Euc3B1cmlvdXNfcmVwb3J0X3JzKSkKPiA+ICsJCQlpZiAoX19yYXRlbGltaXQoJmk5MTUt
PnBlcmYub2Euc3B1cmlvdXNfcmVwb3J0X3JzKSkKPiA+ICAgCQkJCURSTV9OT1RFKCJTa2lwcGlu
ZyBzcHVyaW91cywgaW52YWxpZCBPQSByZXBvcnRcbiIpOwo+ID4gICAJCQljb250aW51ZTsKPiA+
ICAgCQl9Cj4gPiAtCQljdHhfaWQgPSByZXBvcnQzMlsyXSAmIGRldl9wcml2LT5wZXJmLm9hLnNw
ZWNpZmljX2N0eF9pZF9tYXNrOwo+ID4gKwkJY3R4X2lkID0gcmVwb3J0MzJbMl0gJiBpOTE1LT5w
ZXJmLm9hLnNwZWNpZmljX2N0eF9pZF9tYXNrOwo+ID4gICAJCS8qCj4gPiAgIAkJICogU3F1YXNo
IHdoYXRldmVyIGlzIGluIHRoZSBDVFhfSUQgZmllbGQgaWYgaXQncyBtYXJrZWQgYXMKPiA+IEBA
IC03NTEsNyArNzUxLDcgQEAgc3RhdGljIGludCBnZW44X2FwcGVuZF9vYV9yZXBvcnRzKHN0cnVj
dCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gPiAgIAkJICogTm90ZTogdGhhdCB3ZSBkb24n
dCBjbGVhciB0aGUgdmFsaWRfY3R4X2JpdCBzbyB1c2Vyc3BhY2UgY2FuCj4gPiAgIAkJICogdW5k
ZXJzdGFuZCB0aGF0IHRoZSBJRCBoYXMgYmVlbiBzcXVhc2hlZCBieSB0aGUga2VybmVsLgo+ID4g
ICAJCSAqLwo+ID4gLQkJaWYgKCEocmVwb3J0MzJbMF0gJiBkZXZfcHJpdi0+cGVyZi5vYS5nZW44
X3ZhbGlkX2N0eF9iaXQpKQo+ID4gKwkJaWYgKCEocmVwb3J0MzJbMF0gJiBpOTE1LT5wZXJmLm9h
LmdlbjhfdmFsaWRfY3R4X2JpdCkpCj4gPiAgIAkJCWN0eF9pZCA9IHJlcG9ydDMyWzJdID0gSU5W
QUxJRF9DVFhfSUQ7Cj4gPiAgIAkJLyoKPiA+IEBAIC03ODUsMTggKzc4NSwxOCBAQCBzdGF0aWMg
aW50IGdlbjhfYXBwZW5kX29hX3JlcG9ydHMoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVh
bSwKPiA+ICAgCQkgKiBzd2l0Y2hlcyBzaW5jZSBpdCdzIG5vdC11bmNvbW1vbiBmb3IgcGVyaW9k
aWMgc2FtcGxlcyB0bwo+ID4gICAJCSAqIGlkZW50aWZ5IGEgc3dpdGNoIGJlZm9yZSBhbnkgJ2Nv
bnRleHQgc3dpdGNoJyByZXBvcnQuCj4gPiAgIAkJICovCj4gPiAtCQlpZiAoIWRldl9wcml2LT5w
ZXJmLm9hLmV4Y2x1c2l2ZV9zdHJlYW0tPmN0eCB8fAo+ID4gLQkJICAgIGRldl9wcml2LT5wZXJm
Lm9hLnNwZWNpZmljX2N0eF9pZCA9PSBjdHhfaWQgfHwKPiA+IC0JCSAgICAoZGV2X3ByaXYtPnBl
cmYub2Eub2FfYnVmZmVyLmxhc3RfY3R4X2lkID09Cj4gPiAtCQkgICAgIGRldl9wcml2LT5wZXJm
Lm9hLnNwZWNpZmljX2N0eF9pZCkgfHwKPiA+ICsJCWlmICghaTkxNS0+cGVyZi5vYS5leGNsdXNp
dmVfc3RyZWFtLT5jdHggfHwKPiA+ICsJCSAgICBpOTE1LT5wZXJmLm9hLnNwZWNpZmljX2N0eF9p
ZCA9PSBjdHhfaWQgfHwKPiA+ICsJCSAgICAoaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIubGFzdF9j
dHhfaWQgPT0KPiA+ICsJCSAgICAgaTkxNS0+cGVyZi5vYS5zcGVjaWZpY19jdHhfaWQpIHx8Cj4g
PiAgIAkJICAgIHJlYXNvbiAmIE9BUkVQT1JUX1JFQVNPTl9DVFhfU1dJVENIKSB7Cj4gPiAgIAkJ
CS8qCj4gPiAgIAkJCSAqIFdoaWxlIGZpbHRlcmluZyBmb3IgYSBzaW5nbGUgY29udGV4dCB3ZSBh
dm9pZAo+ID4gICAJCQkgKiBsZWFraW5nIHRoZSBJRHMgb2Ygb3RoZXIgY29udGV4dHMuCj4gPiAg
IAkJCSAqLwo+ID4gLQkJCWlmIChkZXZfcHJpdi0+cGVyZi5vYS5leGNsdXNpdmVfc3RyZWFtLT5j
dHggJiYKPiA+IC0JCQkgICAgZGV2X3ByaXYtPnBlcmYub2Euc3BlY2lmaWNfY3R4X2lkICE9IGN0
eF9pZCkgewo+ID4gKwkJCWlmIChpOTE1LT5wZXJmLm9hLmV4Y2x1c2l2ZV9zdHJlYW0tPmN0eCAm
Jgo+ID4gKwkJCSAgICBpOTE1LT5wZXJmLm9hLnNwZWNpZmljX2N0eF9pZCAhPSBjdHhfaWQpIHsK
PiA+ICAgCQkJCXJlcG9ydDMyWzJdID0gSU5WQUxJRF9DVFhfSUQ7Cj4gPiAgIAkJCX0KPiA+IEBA
IC04MDUsNyArODA1LDcgQEAgc3RhdGljIGludCBnZW44X2FwcGVuZF9vYV9yZXBvcnRzKHN0cnVj
dCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gPiAgIAkJCWlmIChyZXQpCj4gPiAgIAkJCQli
cmVhazsKPiA+IC0JCQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIubGFzdF9jdHhfaWQgPSBj
dHhfaWQ7Cj4gPiArCQkJaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIubGFzdF9jdHhfaWQgPSBjdHhf
aWQ7Cj4gPiAgIAkJfQo+ID4gICAJCS8qCj4gPiBAQCAtODE5LDcgKzgxOSw3IEBAIHN0YXRpYyBp
bnQgZ2VuOF9hcHBlbmRfb2FfcmVwb3J0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFt
LAo+ID4gICAJfQo+ID4gICAJaWYgKHN0YXJ0X29mZnNldCAhPSAqb2Zmc2V0KSB7Cj4gPiAtCQlz
cGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBm
bGFncyk7Cj4gPiArCQlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIu
cHRyX2xvY2ssIGZsYWdzKTsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIFdlIHJlbW92ZWQgdGhlIGd0
dF9vZmZzZXQgZm9yIHRoZSBjb3B5IGxvb3AgYWJvdmUsIGluZGV4aW5nCj4gPiBAQCAtODI4LDkg
KzgyOCw5IEBAIHN0YXRpYyBpbnQgZ2VuOF9hcHBlbmRfb2FfcmVwb3J0cyhzdHJ1Y3QgaTkxNV9w
ZXJmX3N0cmVhbSAqc3RyZWFtLAo+ID4gICAJCWhlYWQgKz0gZ3R0X29mZnNldDsKPiA+ICAgCQlJ
OTE1X1dSSVRFKEdFTjhfT0FIRUFEUFRSLCBoZWFkICYgR0VOOF9PQUhFQURQVFJfTUFTSyk7Cj4g
PiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuaGVhZCA9IGhlYWQ7Cj4gPiArCQlpOTE1
LT5wZXJmLm9hLm9hX2J1ZmZlci5oZWFkID0gaGVhZDsKPiA+IC0JCXNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoJmRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5wdHJfbG9jaywgZmxhZ3MpOwo+ID4g
KwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIucHRyX2xv
Y2ssIGZsYWdzKTsKPiA+ICAgCX0KPiA+ICAgCXJldHVybiByZXQ7Cj4gPiBAQCAtODYxLDExICs4
NjEsMTEgQEAgc3RhdGljIGludCBnZW44X29hX3JlYWQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0g
KnN0cmVhbSwKPiA+ICAgCQkJc2l6ZV90IGNvdW50LAo+ID4gICAJCQlzaXplX3QgKm9mZnNldCkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBzdHJlYW0t
PmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+
aTkxNTsKPiA+ICAgCXUzMiBvYXN0YXR1czsKPiA+ICAgCWludCByZXQ7Cj4gPiAtCWlmIChXQVJO
X09OKCFkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIpKQo+ID4gKwlpZiAoV0FSTl9P
TighaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIpKQo+ID4gICAJCXJldHVybiAtRUlPOwo+
ID4gICAJb2FzdGF0dXMgPSBJOTE1X1JFQUQoR0VOOF9PQVNUQVRVUyk7Cj4gPiBAQCAtODkxLDEw
ICs4OTEsMTAgQEAgc3RhdGljIGludCBnZW44X29hX3JlYWQoc3RydWN0IGk5MTVfcGVyZl9zdHJl
YW0gKnN0cmVhbSwKPiA+ICAgCQkJcmV0dXJuIHJldDsKPiA+ICAgCQlEUk1fREVCVUcoIk9BIGJ1
ZmZlciBvdmVyZmxvdyAoZXhwb25lbnQgPSAlZCk6IGZvcmNlIHJlc3RhcnRcbiIsCj4gPiAtCQkJ
ICBkZXZfcHJpdi0+cGVyZi5vYS5wZXJpb2RfZXhwb25lbnQpOwo+ID4gKwkJCSAgaTkxNS0+cGVy
Zi5vYS5wZXJpb2RfZXhwb25lbnQpOwo+ID4gLQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLm9hX2Rp
c2FibGUoc3RyZWFtKTsKPiA+IC0JCWRldl9wcml2LT5wZXJmLm9hLm9wcy5vYV9lbmFibGUoc3Ry
ZWFtKTsKPiA+ICsJCWk5MTUtPnBlcmYub2Eub3BzLm9hX2Rpc2FibGUoc3RyZWFtKTsKPiA+ICsJ
CWk5MTUtPnBlcmYub2Eub3BzLm9hX2VuYWJsZShzdHJlYW0pOwo+ID4gICAJCS8qCj4gPiAgIAkJ
ICogTm90ZTogLm9hX2VuYWJsZSgpIGlzIGV4cGVjdGVkIHRvIHJlLWluaXQgdGhlIG9hYnVmZmVy
IGFuZAo+ID4gQEAgLTk0MCwxMCArOTQwLDEwIEBAIHN0YXRpYyBpbnQgZ2VuN19hcHBlbmRfb2Ff
cmVwb3J0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ID4gICAJCQkJICBzaXpl
X3QgY291bnQsCj4gPiAgIAkJCQkgIHNpemVfdCAqb2Zmc2V0KQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gPiAtCWlu
dCByZXBvcnRfc2l6ZSA9IGRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5mb3JtYXRfc2l6ZTsK
PiA+IC0JdTggKm9hX2J1Zl9iYXNlID0gZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnZhZGRy
Owo+ID4gLQl1MzIgZ3R0X29mZnNldCA9IGk5MTVfZ2d0dF9vZmZzZXQoZGV2X3ByaXYtPnBlcmYu
b2Eub2FfYnVmZmVyLnZtYSk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
c3RyZWFtLT5pOTE1Owo+ID4gKwlpbnQgcmVwb3J0X3NpemUgPSBpOTE1LT5wZXJmLm9hLm9hX2J1
ZmZlci5mb3JtYXRfc2l6ZTsKPiA+ICsJdTggKm9hX2J1Zl9iYXNlID0gaTkxNS0+cGVyZi5vYS5v
YV9idWZmZXIudmFkZHI7Cj4gPiArCXUzMiBndHRfb2Zmc2V0ID0gaTkxNV9nZ3R0X29mZnNldChp
OTE1LT5wZXJmLm9hLm9hX2J1ZmZlci52bWEpOwo+ID4gICAJdTMyIG1hc2sgPSAoT0FfQlVGRkVS
X1NJWkUgLSAxKTsKPiA+ICAgCXNpemVfdCBzdGFydF9vZmZzZXQgPSAqb2Zmc2V0Owo+ID4gICAJ
dW5zaWduZWQgbG9uZyBmbGFnczsKPiA+IEBAIC05NTUsMTMgKzk1NSwxMyBAQCBzdGF0aWMgaW50
IGdlbjdfYXBwZW5kX29hX3JlcG9ydHMoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwK
PiA+ICAgCWlmIChXQVJOX09OKCFzdHJlYW0tPmVuYWJsZWQpKQo+ID4gICAJCXJldHVybiAtRUlP
Owo+ID4gLQlzcGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnB0
cl9sb2NrLCBmbGFncyk7Cj4gPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT5wZXJmLm9hLm9h
X2J1ZmZlci5wdHJfbG9jaywgZmxhZ3MpOwo+ID4gLQloZWFkID0gZGV2X3ByaXYtPnBlcmYub2Eu
b2FfYnVmZmVyLmhlYWQ7Cj4gPiAtCWFnZWRfdGFpbF9pZHggPSBkZXZfcHJpdi0+cGVyZi5vYS5v
YV9idWZmZXIuYWdlZF90YWlsX2lkeDsKPiA+IC0JdGFpbCA9IGRldl9wcml2LT5wZXJmLm9hLm9h
X2J1ZmZlci50YWlsc1thZ2VkX3RhaWxfaWR4XS5vZmZzZXQ7Cj4gPiArCWhlYWQgPSBpOTE1LT5w
ZXJmLm9hLm9hX2J1ZmZlci5oZWFkOwo+ID4gKwlhZ2VkX3RhaWxfaWR4ID0gaTkxNS0+cGVyZi5v
YS5vYV9idWZmZXIuYWdlZF90YWlsX2lkeDsKPiA+ICsJdGFpbCA9IGk5MTUtPnBlcmYub2Eub2Ff
YnVmZmVyLnRhaWxzW2FnZWRfdGFpbF9pZHhdLm9mZnNldDsKPiA+IC0Jc3Bpbl91bmxvY2tfaXJx
cmVzdG9yZSgmZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFncyk7Cj4g
PiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9s
b2NrLCBmbGFncyk7Cj4gPiAgIAkvKiBBbiBpbnZhbGlkIHRhaWwgcG9pbnRlciBoZXJlIG1lYW5z
IHdlJ3JlIHN0aWxsIHdhaXRpbmcgZm9yIHRoZSBwb2xsCj4gPiAgIAkgKiBocnRpbWVyIGNhbGxi
YWNrIHRvIGdpdmUgdXMgYSBwb2ludGVyCj4gPiBAQCAtMTAxNCw3ICsxMDE0LDcgQEAgc3RhdGlj
IGludCBnZW43X2FwcGVuZF9vYV9yZXBvcnRzKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJl
YW0sCj4gPiAgIAkJICogY29weWluZyBpdCB0byB1c2Vyc3BhY2UuLi4KPiA+ICAgCQkgKi8KPiA+
ICAgCQlpZiAocmVwb3J0MzJbMF0gPT0gMCkgewo+ID4gLQkJCWlmIChfX3JhdGVsaW1pdCgmZGV2
X3ByaXYtPnBlcmYub2Euc3B1cmlvdXNfcmVwb3J0X3JzKSkKPiA+ICsJCQlpZiAoX19yYXRlbGlt
aXQoJmk5MTUtPnBlcmYub2Euc3B1cmlvdXNfcmVwb3J0X3JzKSkKPiA+ICAgCQkJCURSTV9OT1RF
KCJTa2lwcGluZyBzcHVyaW91cywgaW52YWxpZCBPQSByZXBvcnRcbiIpOwo+ID4gICAJCQljb250
aW51ZTsKPiA+ICAgCQl9Cj4gPiBAQCAtMTAzMyw3ICsxMDMzLDcgQEAgc3RhdGljIGludCBnZW43
X2FwcGVuZF9vYV9yZXBvcnRzKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gPiAg
IAl9Cj4gPiAgIAlpZiAoc3RhcnRfb2Zmc2V0ICE9ICpvZmZzZXQpIHsKPiA+IC0JCXNwaW5fbG9j
a19pcnFzYXZlKCZkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIucHRyX2xvY2ssIGZsYWdzKTsK
PiA+ICsJCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5wdHJfbG9j
aywgZmxhZ3MpOwo+ID4gICAJCS8qIFdlIHJlbW92ZWQgdGhlIGd0dF9vZmZzZXQgZm9yIHRoZSBj
b3B5IGxvb3AgYWJvdmUsIGluZGV4aW5nCj4gPiAgIAkJICogcmVsYXRpdmUgdG8gb2FfYnVmX2Jh
c2Ugc28gcHV0IGJhY2sgaGVyZS4uLgo+ID4gQEAgLTEwNDMsOSArMTA0Myw5IEBAIHN0YXRpYyBp
bnQgZ2VuN19hcHBlbmRfb2FfcmVwb3J0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFt
LAo+ID4gICAJCUk5MTVfV1JJVEUoR0VON19PQVNUQVRVUzIsCj4gPiAgIAkJCSAgICgoaGVhZCAm
IEdFTjdfT0FTVEFUVVMyX0hFQURfTUFTSykgfAo+ID4gICAJCQkgICAgR0VON19PQVNUQVRVUzJf
TUVNX1NFTEVDVF9HR1RUKSk7Cj4gPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuaGVh
ZCA9IGhlYWQ7Cj4gPiArCQlpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5oZWFkID0gaGVhZDsKPiA+
IC0JCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5w
dHJfbG9jaywgZmxhZ3MpOwo+ID4gKwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+cGVy
Zi5vYS5vYV9idWZmZXIucHRyX2xvY2ssIGZsYWdzKTsKPiA+ICAgCX0KPiA+ICAgCXJldHVybiBy
ZXQ7Cj4gPiBAQCAtMTA3MiwxMSArMTA3MiwxMSBAQCBzdGF0aWMgaW50IGdlbjdfb2FfcmVhZChz
dHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ID4gICAJCQlzaXplX3QgY291bnQsCj4g
PiAgIAkJCXNpemVfdCAqb2Zmc2V0KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ID4gICAJdTMyIG9hc3RhdHVzMTsKPiA+ICAg
CWludCByZXQ7Cj4gPiAtCWlmIChXQVJOX09OKCFkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIu
dmFkZHIpKQo+ID4gKwlpZiAoV0FSTl9PTighaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIp
KQo+ID4gICAJCXJldHVybiAtRUlPOwo+ID4gICAJb2FzdGF0dXMxID0gSTkxNV9SRUFEKEdFTjdf
T0FTVEFUVVMxKTsKPiA+IEBAIC0xMDg2LDcgKzEwODYsNyBAQCBzdGF0aWMgaW50IGdlbjdfb2Ff
cmVhZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ID4gICAJICogbWF5IGJlIHVw
ZGF0ZWQgYXN5bmNocm9ub3VzbHkpIHNvIHdlIGlnbm9yZSBzdGF0dXMgYml0cwo+ID4gICAJICog
dGhhdCBoYXZlIGFscmVhZHkgYmVlbiByZXBvcnRlZCB0byB1c2Vyc3BhY2UuCj4gPiAgIAkgKi8K
PiA+IC0Jb2FzdGF0dXMxICY9IH5kZXZfcHJpdi0+cGVyZi5vYS5nZW43X2xhdGNoZWRfb2FzdGF0
dXMxOwo+ID4gKwlvYXN0YXR1czEgJj0gfmk5MTUtPnBlcmYub2EuZ2VuN19sYXRjaGVkX29hc3Rh
dHVzMTsKPiA+ICAgCS8qIFdlIHRyZWF0IE9BQlVGRkVSX09WRVJGTE9XIGFzIGEgc2lnbmlmaWNh
bnQgZXJyb3I6Cj4gPiAgIAkgKgo+ID4gQEAgLTExMTUsMTAgKzExMTUsMTAgQEAgc3RhdGljIGlu
dCBnZW43X29hX3JlYWQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKPiA+ICAgCQkJ
cmV0dXJuIHJldDsKPiA+ICAgCQlEUk1fREVCVUcoIk9BIGJ1ZmZlciBvdmVyZmxvdyAoZXhwb25l
bnQgPSAlZCk6IGZvcmNlIHJlc3RhcnRcbiIsCj4gPiAtCQkJICBkZXZfcHJpdi0+cGVyZi5vYS5w
ZXJpb2RfZXhwb25lbnQpOwo+ID4gKwkJCSAgaTkxNS0+cGVyZi5vYS5wZXJpb2RfZXhwb25lbnQp
Owo+ID4gLQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLm9hX2Rpc2FibGUoc3RyZWFtKTsKPiA+IC0J
CWRldl9wcml2LT5wZXJmLm9hLm9wcy5vYV9lbmFibGUoc3RyZWFtKTsKPiA+ICsJCWk5MTUtPnBl
cmYub2Eub3BzLm9hX2Rpc2FibGUoc3RyZWFtKTsKPiA+ICsJCWk5MTUtPnBlcmYub2Eub3BzLm9h
X2VuYWJsZShzdHJlYW0pOwo+ID4gICAJCW9hc3RhdHVzMSA9IEk5MTVfUkVBRChHRU43X09BU1RB
VFVTMSk7Cj4gPiAgIAl9Cj4gPiBAQCAtMTEyOCw3ICsxMTI4LDcgQEAgc3RhdGljIGludCBnZW43
X29hX3JlYWQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKPiA+ICAgCQkJCSAgICAg
ICBEUk1fSTkxNV9QRVJGX1JFQ09SRF9PQV9SRVBPUlRfTE9TVCk7Cj4gPiAgIAkJaWYgKHJldCkK
PiA+ICAgCQkJcmV0dXJuIHJldDsKPiA+IC0JCWRldl9wcml2LT5wZXJmLm9hLmdlbjdfbGF0Y2hl
ZF9vYXN0YXR1czEgfD0KPiA+ICsJCWk5MTUtPnBlcmYub2EuZ2VuN19sYXRjaGVkX29hc3RhdHVz
MSB8PQo+ID4gICAJCQlHRU43X09BU1RBVFVTMV9SRVBPUlRfTE9TVDsKPiA+ICAgCX0KPiA+IEBA
IC0xMTUxLDE0ICsxMTUxLDE0IEBAIHN0YXRpYyBpbnQgZ2VuN19vYV9yZWFkKHN0cnVjdCBpOTE1
X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgaW50IGk5MTVfb2Ff
d2FpdF91bmxvY2tlZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ID4g
ICAJLyogV2Ugd291bGQgd2FpdCBpbmRlZmluaXRlbHkgaWYgcGVyaW9kaWMgc2FtcGxpbmcgaXMg
bm90IGVuYWJsZWQgKi8KPiA+IC0JaWYgKCFkZXZfcHJpdi0+cGVyZi5vYS5wZXJpb2RpYykKPiA+
ICsJaWYgKCFpOTE1LT5wZXJmLm9hLnBlcmlvZGljKQo+ID4gICAJCXJldHVybiAtRUlPOwo+ID4g
LQlyZXR1cm4gd2FpdF9ldmVudF9pbnRlcnJ1cHRpYmxlKGRldl9wcml2LT5wZXJmLm9hLnBvbGxf
d3EsCj4gPiAtCQkJCQlvYV9idWZmZXJfY2hlY2tfdW5sb2NrZWQoZGV2X3ByaXYpKTsKPiA+ICsJ
cmV0dXJuIHdhaXRfZXZlbnRfaW50ZXJydXB0aWJsZShpOTE1LT5wZXJmLm9hLnBvbGxfd3EsCj4g
PiArCQkJCQlvYV9idWZmZXJfY2hlY2tfdW5sb2NrZWQoaTkxNSkpOwo+ID4gICB9Cj4gPiAgIC8q
Kgo+ID4gQEAgLTExNzUsOSArMTE3NSw5IEBAIHN0YXRpYyB2b2lkIGk5MTVfb2FfcG9sbF93YWl0
KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gPiAgIAkJCSAgICAgIHN0cnVjdCBm
aWxlICpmaWxlLAo+ID4gICAJCQkgICAgICBwb2xsX3RhYmxlICp3YWl0KQo+ID4gICB7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ID4gLQlw
b2xsX3dhaXQoZmlsZSwgJmRldl9wcml2LT5wZXJmLm9hLnBvbGxfd3EsIHdhaXQpOwo+ID4gKwlw
b2xsX3dhaXQoZmlsZSwgJmk5MTUtPnBlcmYub2EucG9sbF93cSwgd2FpdCk7Cj4gPiAgIH0KPiA+
ICAgLyoqCj4gPiBAQCAtMTE5Nyw5ICsxMTk3LDkgQEAgc3RhdGljIGludCBpOTE1X29hX3JlYWQo
c3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKPiA+ICAgCQkJc2l6ZV90IGNvdW50LAo+
ID4gICAJCQlzaXplX3QgKm9mZnNldCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBzdHJlYW0tPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+aTkxNTsKPiA+IC0JcmV0dXJuIGRldl9wcml2LT5wZXJm
Lm9hLm9wcy5yZWFkKHN0cmVhbSwgYnVmLCBjb3VudCwgb2Zmc2V0KTsKPiA+ICsJcmV0dXJuIGk5
MTUtPnBlcmYub2Eub3BzLnJlYWQoc3RyZWFtLCBidWYsIGNvdW50LCBvZmZzZXQpOwo+ID4gICB9
Cj4gPiAgIHN0YXRpYyBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqb2FfcGluX2NvbnRleHQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiBAQCAtMTI0OCw3ICsxMjQ4LDcgQEAgc3RhdGlj
IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpvYV9waW5fY29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgICovCj4gPiAgIHN0YXRpYyBpbnQgb2FfZ2V0X3JlbmRlcl9jdHhf
aWQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ID4gICAJc3RydWN0IGludGVs
X2NvbnRleHQgKmNlOwo+ID4gICAJY2UgPSBvYV9waW5fY29udGV4dChpOTE1LCBzdHJlYW0tPmN0
eCk7Cj4gPiBAQCAtMTMzMCwxNyArMTMzMCwxNyBAQCBzdGF0aWMgaW50IG9hX2dldF9yZW5kZXJf
Y3R4X2lkKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCj4gPiAgICAqLwo+ID4gICBz
dGF0aWMgdm9pZCBvYV9wdXRfcmVuZGVyX2N0eF9pZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAq
c3RyZWFtKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
c3RyZWFtLT5pOTE1Owo+ID4gICAJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwo+ID4gLQlkZXZf
cHJpdi0+cGVyZi5vYS5zcGVjaWZpY19jdHhfaWQgPSBJTlZBTElEX0NUWF9JRDsKPiA+IC0JZGV2
X3ByaXYtPnBlcmYub2Euc3BlY2lmaWNfY3R4X2lkX21hc2sgPSAwOwo+ID4gKwlpOTE1LT5wZXJm
Lm9hLnNwZWNpZmljX2N0eF9pZCA9IElOVkFMSURfQ1RYX0lEOwo+ID4gKwlpOTE1LT5wZXJmLm9h
LnNwZWNpZmljX2N0eF9pZF9tYXNrID0gMDsKPiA+IC0JY2UgPSBmZXRjaF9hbmRfemVybygmZGV2
X3ByaXYtPnBlcmYub2EucGlubmVkX2N0eCk7Cj4gPiArCWNlID0gZmV0Y2hfYW5kX3plcm8oJmk5
MTUtPnBlcmYub2EucGlubmVkX2N0eCk7Cj4gPiAgIAlpZiAoY2UpIHsKPiA+IC0JCW11dGV4X2xv
Y2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJCW11dGV4X2xvY2soJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICAJCWludGVsX2NvbnRleHRfdW5waW4oY2UpOwo+ID4g
LQkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCQltdXRl
eF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICAJfQo+ID4gICB9Cj4gPiBA
QCAtMTM1OSw2NCArMTM1OSw2NCBAQCBmcmVlX29hX2J1ZmZlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgc3RhdGljIHZvaWQgaTkxNV9vYV9zdHJlYW1fZGVzdHJveShzdHJ1
Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ID4gLQlCVUdfT04oc3RyZWFtICE9
IGRldl9wcml2LT5wZXJmLm9hLmV4Y2x1c2l2ZV9zdHJlYW0pOwo+ID4gKwlCVUdfT04oc3RyZWFt
ICE9IGk5MTUtPnBlcmYub2EuZXhjbHVzaXZlX3N0cmVhbSk7Cj4gPiAgIAkvKgo+ID4gICAJICog
VW5zZXQgZXhjbHVzaXZlX3N0cmVhbSBmaXJzdCwgaXQgd2lsbCBiZSBjaGVja2VkIHdoaWxlIGRp
c2FibGluZwo+ID4gICAJICogdGhlIG1ldHJpYyBzZXQgb24gZ2VuOCsuCj4gPiAgIAkgKi8KPiA+
IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQlkZXZfcHJp
di0+cGVyZi5vYS5leGNsdXNpdmVfc3RyZWFtID0gTlVMTDsKPiA+IC0JZGV2X3ByaXYtPnBlcmYu
b2Eub3BzLmRpc2FibGVfbWV0cmljX3NldChkZXZfcHJpdik7Cj4gPiAtCW11dGV4X3VubG9jaygm
ZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0u
c3RydWN0X211dGV4KTsKPiA+ICsJaTkxNS0+cGVyZi5vYS5leGNsdXNpdmVfc3RyZWFtID0gTlVM
TDsKPiA+ICsJaTkxNS0+cGVyZi5vYS5vcHMuZGlzYWJsZV9tZXRyaWNfc2V0KGk5MTUpOwo+ID4g
KwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQlmcmVlX29hX2J1
ZmZlcihkZXZfcHJpdik7Cj4gPiArCWZyZWVfb2FfYnVmZmVyKGk5MTUpOwo+ID4gLQlpbnRlbF91
bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4g
PiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCBzdHJlYW0tPndha2VyZWYpOwo+ID4g
KwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxM
KTsKPiA+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgc3RyZWFtLT53YWtlcmVmKTsKPiA+
ICAgCWlmIChzdHJlYW0tPmN0eCkKPiA+ICAgCQlvYV9wdXRfcmVuZGVyX2N0eF9pZChzdHJlYW0p
Owo+ID4gLQlwdXRfb2FfY29uZmlnKGRldl9wcml2LCBzdHJlYW0tPm9hX2NvbmZpZyk7Cj4gPiAr
CXB1dF9vYV9jb25maWcoaTkxNSwgc3RyZWFtLT5vYV9jb25maWcpOwo+ID4gLQlpZiAoZGV2X3By
aXYtPnBlcmYub2Euc3B1cmlvdXNfcmVwb3J0X3JzLm1pc3NlZCkgewo+ID4gKwlpZiAoaTkxNS0+
cGVyZi5vYS5zcHVyaW91c19yZXBvcnRfcnMubWlzc2VkKSB7Cj4gPiAgIAkJRFJNX05PVEUoIiVk
IHNwdXJpb3VzIE9BIHJlcG9ydCBub3RpY2VzIHN1cHByZXNzZWQgZHVlIHRvIHJhdGVsaW1pdGlu
Z1xuIiwKPiA+IC0JCQkgZGV2X3ByaXYtPnBlcmYub2Euc3B1cmlvdXNfcmVwb3J0X3JzLm1pc3Nl
ZCk7Cj4gPiArCQkJIGk5MTUtPnBlcmYub2Euc3B1cmlvdXNfcmVwb3J0X3JzLm1pc3NlZCk7Cj4g
PiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW43X2luaXRfb2FfYnVmZmVyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnZW43X2luaXRf
b2FfYnVmZmVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXUz
MiBndHRfb2Zmc2V0ID0gaTkxNV9nZ3R0X29mZnNldChkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZm
ZXIudm1hKTsKPiA+ICsJdTMyIGd0dF9vZmZzZXQgPSBpOTE1X2dndHRfb2Zmc2V0KGk5MTUtPnBl
cmYub2Eub2FfYnVmZmVyLnZtYSk7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIGZsYWdzOwo+ID4gLQlz
cGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBm
bGFncyk7Cj4gPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5w
dHJfbG9jaywgZmxhZ3MpOwo+ID4gICAJLyogUHJlLURldkJEVzogT0FCVUZGRVIgbXVzdCBiZSBz
ZXQgd2l0aCBjb3VudGVycyBvZmYsCj4gPiAgIAkgKiBiZWZvcmUgT0FTVEFUVVMxLCBidXQgYWZ0
ZXIgT0FTVEFUVVMyCj4gPiAgIAkgKi8KPiA+ICAgCUk5MTVfV1JJVEUoR0VON19PQVNUQVRVUzIs
Cj4gPiAgIAkJICAgZ3R0X29mZnNldCB8IEdFTjdfT0FTVEFUVVMyX01FTV9TRUxFQ1RfR0dUVCk7
IC8qIGhlYWQgKi8KPiA+IC0JZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLmhlYWQgPSBndHRf
b2Zmc2V0Owo+ID4gKwlpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5oZWFkID0gZ3R0X29mZnNldDsK
PiA+ICAgCUk5MTVfV1JJVEUoR0VON19PQUJVRkZFUiwgZ3R0X29mZnNldCk7Cj4gPiAgIAlJOTE1
X1dSSVRFKEdFTjdfT0FTVEFUVVMxLCBndHRfb2Zmc2V0IHwgT0FCVUZGRVJfU0laRV8xNk0pOyAv
KiB0YWlsICovCj4gPiAgIAkvKiBNYXJrIHRoYXQgd2UgbmVlZCB1cGRhdGVkIHRhaWwgcG9pbnRl
cnMgdG8gcmVhZCBmcm9tLi4uICovCj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci50
YWlsc1swXS5vZmZzZXQgPSBJTlZBTElEX1RBSUxfUFRSOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5v
YS5vYV9idWZmZXIudGFpbHNbMV0ub2Zmc2V0ID0gSU5WQUxJRF9UQUlMX1BUUjsKPiA+ICsJaTkx
NS0+cGVyZi5vYS5vYV9idWZmZXIudGFpbHNbMF0ub2Zmc2V0ID0gSU5WQUxJRF9UQUlMX1BUUjsK
PiA+ICsJaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudGFpbHNbMV0ub2Zmc2V0ID0gSU5WQUxJRF9U
QUlMX1BUUjsKPiA+IC0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPnBlcmYub2Eu
b2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFncyk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUo
Jmk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBmbGFncyk7Cj4gPiAgIAkvKiBPbiBI
YXN3ZWxsIHdlIGhhdmUgdG8gdHJhY2sgd2hpY2ggT0FTVEFUVVMxIGZsYWdzIHdlJ3ZlCj4gPiAg
IAkgKiBhbHJlYWR5IHNlZW4gc2luY2UgdGhleSBjYW4ndCBiZSBjbGVhcmVkIHdoaWxlIHBlcmlv
ZGljCj4gPiAgIAkgKiBzYW1wbGluZyBpcyBlbmFibGVkLgo+ID4gICAJICovCj4gPiAtCWRldl9w
cml2LT5wZXJmLm9hLmdlbjdfbGF0Y2hlZF9vYXN0YXR1czEgPSAwOwo+ID4gKwlpOTE1LT5wZXJm
Lm9hLmdlbjdfbGF0Y2hlZF9vYXN0YXR1czEgPSAwOwo+ID4gICAJLyogTkI6IGFsdGhvdWdoIHRo
ZSBPQSBidWZmZXIgd2lsbCBpbml0aWFsbHkgYmUgYWxsb2NhdGVkCj4gPiAgIAkgKiB6ZXJvZWQg
dmlhIHNobWZzIChhbmQgc28gdGhpcyBtZW1zZXQgaXMgcmVkdW5kYW50IHdoZW4KPiA+IEBAIC0x
NDI5LDI0ICsxNDI5LDI0IEBAIHN0YXRpYyB2b2lkIGdlbjdfaW5pdF9vYV9idWZmZXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICogdGhlIGFzc3VtcHRpb24gdGhh
dCBuZXcgcmVwb3J0cyBhcmUgYmVpbmcgd3JpdHRlbiB0byB6ZXJvZWQKPiA+ICAgCSAqIG1lbW9y
eS4uLgo+ID4gICAJICovCj4gPiAtCW1lbXNldChkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIu
dmFkZHIsIDAsIE9BX0JVRkZFUl9TSVpFKTsKPiA+ICsJbWVtc2V0KGk5MTUtPnBlcmYub2Eub2Ff
YnVmZmVyLnZhZGRyLCAwLCBPQV9CVUZGRVJfU0laRSk7Cj4gPiAgIAkvKiBNYXliZSBtYWtlIC0+
cG9sbGluIHBlci1zdHJlYW0gc3RhdGUgaWYgd2Ugc3VwcG9ydCBtdWx0aXBsZQo+ID4gICAJICog
Y29uY3VycmVudCBzdHJlYW1zIGluIHRoZSBmdXR1cmUuCj4gPiAgIAkgKi8KPiA+IC0JZGV2X3By
aXYtPnBlcmYub2EucG9sbGluID0gZmFsc2U7Cj4gPiArCWk5MTUtPnBlcmYub2EucG9sbGluID0g
ZmFsc2U7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW44X2luaXRfb2FfYnVmZmVyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnZW44X2luaXRf
b2FfYnVmZmVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXUz
MiBndHRfb2Zmc2V0ID0gaTkxNV9nZ3R0X29mZnNldChkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZm
ZXIudm1hKTsKPiA+ICsJdTMyIGd0dF9vZmZzZXQgPSBpOTE1X2dndHRfb2Zmc2V0KGk5MTUtPnBl
cmYub2Eub2FfYnVmZmVyLnZtYSk7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIGZsYWdzOwo+ID4gLQlz
cGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnB0cl9sb2NrLCBm
bGFncyk7Cj4gPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5w
dHJfbG9jaywgZmxhZ3MpOwo+ID4gICAJSTkxNV9XUklURShHRU44X09BU1RBVFVTLCAwKTsKPiA+
ICAgCUk5MTVfV1JJVEUoR0VOOF9PQUhFQURQVFIsIGd0dF9vZmZzZXQpOwo+ID4gLQlkZXZfcHJp
di0+cGVyZi5vYS5vYV9idWZmZXIuaGVhZCA9IGd0dF9vZmZzZXQ7Cj4gPiArCWk5MTUtPnBlcmYu
b2Eub2FfYnVmZmVyLmhlYWQgPSBndHRfb2Zmc2V0Owo+ID4gICAJSTkxNV9XUklURShHRU44X09B
QlVGRkVSX1VEVywgMCk7Cj4gPiBAQCAtMTQ2MywxNyArMTQ2MywxNyBAQCBzdGF0aWMgdm9pZCBn
ZW44X2luaXRfb2FfYnVmZmVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCUk5MTVfV1JJVEUoR0VOOF9PQVRBSUxQVFIsIGd0dF9vZmZzZXQgJiBHRU44X09BVEFJTFBU
Ul9NQVNLKTsKPiA+ICAgCS8qIE1hcmsgdGhhdCB3ZSBuZWVkIHVwZGF0ZWQgdGFpbCBwb2ludGVy
cyB0byByZWFkIGZyb20uLi4gKi8KPiA+IC0JZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnRh
aWxzWzBdLm9mZnNldCA9IElOVkFMSURfVEFJTF9QVFI7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9h
Lm9hX2J1ZmZlci50YWlsc1sxXS5vZmZzZXQgPSBJTlZBTElEX1RBSUxfUFRSOwo+ID4gKwlpOTE1
LT5wZXJmLm9hLm9hX2J1ZmZlci50YWlsc1swXS5vZmZzZXQgPSBJTlZBTElEX1RBSUxfUFRSOwo+
ID4gKwlpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci50YWlsc1sxXS5vZmZzZXQgPSBJTlZBTElEX1RB
SUxfUFRSOwo+ID4gICAJLyoKPiA+ICAgCSAqIFJlc2V0IHN0YXRlIHVzZWQgdG8gcmVjb2duaXNl
IGNvbnRleHQgc3dpdGNoZXMsIGFmZmVjdGluZyB3aGljaAo+ID4gICAJICogcmVwb3J0cyB3ZSB3
aWxsIGZvcndhcmQgdG8gdXNlcnNwYWNlIHdoaWxlIGZpbHRlcmluZyBmb3IgYSBzaW5nbGUKPiA+
ICAgCSAqIGNvbnRleHQuCj4gPiAgIAkgKi8KPiA+IC0JZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVm
ZmVyLmxhc3RfY3R4X2lkID0gSU5WQUxJRF9DVFhfSUQ7Cj4gPiArCWk5MTUtPnBlcmYub2Eub2Ff
YnVmZmVyLmxhc3RfY3R4X2lkID0gSU5WQUxJRF9DVFhfSUQ7Cj4gPiAtCXNwaW5fdW5sb2NrX2ly
cXJlc3RvcmUoJmRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci5wdHJfbG9jaywgZmxhZ3MpOwo+
ID4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5wdHJf
bG9jaywgZmxhZ3MpOwo+ID4gICAJLyoKPiA+ICAgCSAqIE5COiBhbHRob3VnaCB0aGUgT0EgYnVm
ZmVyIHdpbGwgaW5pdGlhbGx5IGJlIGFsbG9jYXRlZAo+ID4gQEAgLTE0ODcsMzIgKzE0ODcsMzIg
QEAgc3RhdGljIHZvaWQgZ2VuOF9pbml0X29hX2J1ZmZlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiB0aGUgYXNzdW1wdGlvbiB0aGF0IG5ldyByZXBvcnRzIGFy
ZSBiZWluZyB3cml0dGVuIHRvIHplcm9lZAo+ID4gICAJICogbWVtb3J5Li4uCj4gPiAgIAkgKi8K
PiA+IC0JbWVtc2V0KGRldl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci52YWRkciwgMCwgT0FfQlVG
RkVSX1NJWkUpOwo+ID4gKwltZW1zZXQoaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIsIDAs
IE9BX0JVRkZFUl9TSVpFKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBNYXliZSBtYWtlIC0+cG9sbGlu
IHBlci1zdHJlYW0gc3RhdGUgaWYgd2Ugc3VwcG9ydCBtdWx0aXBsZQo+ID4gICAJICogY29uY3Vy
cmVudCBzdHJlYW1zIGluIHRoZSBmdXR1cmUuCj4gPiAgIAkgKi8KPiA+IC0JZGV2X3ByaXYtPnBl
cmYub2EucG9sbGluID0gZmFsc2U7Cj4gPiArCWk5MTUtPnBlcmYub2EucG9sbGluID0gZmFsc2U7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IGFsbG9jX29hX2J1ZmZlcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGludCBhbGxvY19vYV9idWZmZXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpibzsKPiA+ICAgCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwo+ID4gICAJaW50IHJl
dDsKPiA+IC0JaWYgKFdBUk5fT04oZGV2X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnZtYSkpCj4g
PiArCWlmIChXQVJOX09OKGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLnZtYSkpCj4gPiAgIAkJcmV0
dXJuIC1FTk9ERVY7Cj4gPiAtCXJldCA9IGk5MTVfbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZk
ZXZfcHJpdi0+ZHJtKTsKPiA+ICsJcmV0ID0gaTkxNV9tdXRleF9sb2NrX2ludGVycnVwdGlibGUo
Jmk5MTUtPmRybSk7Cj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiAgIAlC
VUlMRF9CVUdfT05fTk9UX1BPV0VSX09GXzIoT0FfQlVGRkVSX1NJWkUpOwo+ID4gICAJQlVJTERf
QlVHX09OKE9BX0JVRkZFUl9TSVpFIDwgU1pfMTI4SyB8fCBPQV9CVUZGRVJfU0laRSA+IFNaXzE2
TSk7Cj4gPiAtCWJvID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShkZXZfcHJpdiwgT0Ff
QlVGRkVSX1NJWkUpOwo+ID4gKwlibyA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0oaTkx
NSwgT0FfQlVGRkVSX1NJWkUpOwo+ID4gICAJaWYgKElTX0VSUihibykpIHsKPiA+ICAgCQlEUk1f
RVJST1IoIkZhaWxlZCB0byBhbGxvY2F0ZSBPQSBidWZmZXJcbiIpOwo+ID4gICAJCXJldCA9IFBU
Ul9FUlIoYm8pOwo+ID4gQEAgLTE1MjcsMTggKzE1MjcsMTggQEAgc3RhdGljIGludCBhbGxvY19v
YV9idWZmZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCXJldCA9
IFBUUl9FUlIodm1hKTsKPiA+ICAgCQlnb3RvIGVycl91bnJlZjsKPiA+ICAgCX0KPiA+IC0JZGV2
X3ByaXYtPnBlcmYub2Eub2FfYnVmZmVyLnZtYSA9IHZtYTsKPiA+ICsJaTkxNS0+cGVyZi5vYS5v
YV9idWZmZXIudm1hID0gdm1hOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudmFk
ZHIgPQo+ID4gKwlpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci52YWRkciA9Cj4gPiAgIAkJaTkxNV9n
ZW1fb2JqZWN0X3Bpbl9tYXAoYm8sIEk5MTVfTUFQX1dCKTsKPiA+IC0JaWYgKElTX0VSUihkZXZf
cHJpdi0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIpKSB7Cj4gPiAtCQlyZXQgPSBQVFJfRVJSKGRl
dl9wcml2LT5wZXJmLm9hLm9hX2J1ZmZlci52YWRkcik7Cj4gPiArCWlmIChJU19FUlIoaTkxNS0+
cGVyZi5vYS5vYV9idWZmZXIudmFkZHIpKSB7Cj4gPiArCQlyZXQgPSBQVFJfRVJSKGk5MTUtPnBl
cmYub2Eub2FfYnVmZmVyLnZhZGRyKTsKPiA+ICAgCQlnb3RvIGVycl91bnBpbjsKPiA+ICAgCX0K
PiA+ICAgCURSTV9ERUJVR19EUklWRVIoIk9BIEJ1ZmZlciBpbml0aWFsaXplZCwgZ3R0IG9mZnNl
dCA9IDB4JXgsIHZhZGRyID0gJXBcbiIsCj4gPiAtCQkJIGk5MTVfZ2d0dF9vZmZzZXQoZGV2X3By
aXYtPnBlcmYub2Eub2FfYnVmZmVyLnZtYSksCj4gPiAtCQkJIGRldl9wcml2LT5wZXJmLm9hLm9h
X2J1ZmZlci52YWRkcik7Cj4gPiArCQkJIGk5MTVfZ2d0dF9vZmZzZXQoaTkxNS0+cGVyZi5vYS5v
YV9idWZmZXIudm1hKSwKPiA+ICsJCQkgaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIpOwo+
ID4gICAJZ290byB1bmxvY2s7Cj4gPiBAQCAtMTU0OCwxNSArMTU0OCwxNSBAQCBzdGF0aWMgaW50
IGFsbG9jX29hX2J1ZmZlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAg
IGVycl91bnJlZjoKPiA+ICAgCWk5MTVfZ2VtX29iamVjdF9wdXQoYm8pOwo+ID4gLQlkZXZfcHJp
di0+cGVyZi5vYS5vYV9idWZmZXIudmFkZHIgPSBOVUxMOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5v
YS5vYV9idWZmZXIudm1hID0gTlVMTDsKPiA+ICsJaTkxNS0+cGVyZi5vYS5vYV9idWZmZXIudmFk
ZHIgPSBOVUxMOwo+ID4gKwlpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci52bWEgPSBOVUxMOwo+ID4g
ICB1bmxvY2s6Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgp
Owo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICAJcmV0
dXJuIHJldDsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGNvbmZpZ19vYV9yZWdzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBjb25maWdfb2FfcmVn
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgY29uc3Qgc3RydWN0
IGk5MTVfb2FfcmVnICpyZWdzLAo+ID4gICAJCQkgICB1MzIgbl9yZWdzKQo+ID4gICB7Cj4gPiBA
QCAtMTU3MSw3ICsxNTcxLDcgQEAgc3RhdGljIHZvaWQgY29uZmlnX29hX3JlZ3Moc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICBzdGF0aWMgaW50IGhzd19lbmFibGVfbWV0
cmljX3NldChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ID4gICAJY29u
c3Qgc3RydWN0IGk5MTVfb2FfY29uZmlnICpvYV9jb25maWcgPSBzdHJlYW0tPm9hX2NvbmZpZzsK
PiA+ICAgCS8qIFBSTToKPiA+IEBAIC0xNTg4LDcgKzE1ODgsNyBAQCBzdGF0aWMgaW50IGhzd19l
bmFibGVfbWV0cmljX3NldChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ID4gICAJ
STkxNV9XUklURShHRU42X1VDR0NUTDEsIChJOTE1X1JFQUQoR0VONl9VQ0dDVEwxKSB8Cj4gPiAg
IAkJCQkgIEdFTjZfQ1NVTklUX0NMT0NLX0dBVEVfRElTQUJMRSkpOwo+ID4gLQljb25maWdfb2Ff
cmVncyhkZXZfcHJpdiwgb2FfY29uZmlnLT5tdXhfcmVncywgb2FfY29uZmlnLT5tdXhfcmVnc19s
ZW4pOwo+ID4gKwljb25maWdfb2FfcmVncyhpOTE1LCBvYV9jb25maWctPm11eF9yZWdzLCBvYV9j
b25maWctPm11eF9yZWdzX2xlbik7Cj4gPiAgIAkvKiBJdCBhcHBhcmVudGx5IHRha2VzIGEgZmFp
cmx5IGxvbmcgdGltZSBmb3IgYSBuZXcgTVVYCj4gPiAgIAkgKiBjb25maWd1cmF0aW9uIHRvIGJl
IGJlIGFwcGxpZWQgYWZ0ZXIgdGhlc2UgcmVnaXN0ZXIgd3JpdGVzLgo+ID4gQEAgLTE2MTMsMTMg
KzE2MTMsMTMgQEAgc3RhdGljIGludCBoc3dfZW5hYmxlX21ldHJpY19zZXQoc3RydWN0IGk5MTVf
cGVyZl9zdHJlYW0gKnN0cmVhbSkKPiA+ICAgCSAqLwo+ID4gICAJdXNsZWVwX3JhbmdlKDE1MDAw
LCAyMDAwMCk7Cj4gPiAtCWNvbmZpZ19vYV9yZWdzKGRldl9wcml2LCBvYV9jb25maWctPmJfY291
bnRlcl9yZWdzLAo+ID4gKwljb25maWdfb2FfcmVncyhpOTE1LCBvYV9jb25maWctPmJfY291bnRl
cl9yZWdzLAo+ID4gICAJCSAgICAgICBvYV9jb25maWctPmJfY291bnRlcl9yZWdzX2xlbik7Cj4g
PiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGhzd19kaXNhYmxlX21ldHJp
Y19zZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lk
IGhzd19kaXNhYmxlX21ldHJpY19zZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+ICAgCUk5MTVfV1JJVEUoR0VONl9VQ0dDVEwxLCAoSTkxNV9SRUFEKEdFTjZfVUNH
Q1RMMSkgJgo+ID4gICAJCQkJICB+R0VONl9DU1VOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFKSk7Cj4g
PiBAQCAtMTcxNiwxNSArMTcxNiwxNSBAQCBnZW44X3VwZGF0ZV9yZWdfc3RhdGVfdW5sb2NrZWQo
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLAo+ID4gICAgKgo+ID4gICAgKiBOb3RlOiBpdCdzIG9u
bHkgdGhlIFJDUy9SZW5kZXIgY29udGV4dCB0aGF0IGhhcyBhbnkgT0Egc3RhdGUuCj4gPiAgICAq
Lwo+ID4gLXN0YXRpYyBpbnQgZ2VuOF9jb25maWd1cmVfYWxsX2NvbnRleHRzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW50IGdlbjhfY29uZmlndXJlX2Fs
bF9jb250ZXh0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAg
ICBjb25zdCBzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9hX2NvbmZpZykKPiA+ICAgewo+ID4gLQl1
bnNpZ25lZCBpbnQgbWFwX3R5cGUgPSBpOTE1X2NvaGVyZW50X21hcF90eXBlKGRldl9wcml2KTsK
PiA+ICsJdW5zaWduZWQgaW50IG1hcF90eXBlID0gaTkxNV9jb2hlcmVudF9tYXBfdHlwZShpOTE1
KTsKPiA+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Cj4gPiAgIAlzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycTsKPiA+ICAgCWludCByZXQ7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQo
JmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAgIAkvKgo+ID4gICAJICogVGhlIE9BIHJlZ2lz
dGVyIGNvbmZpZyBpcyBzZXR1cCB0aHJvdWdoIHRoZSBjb250ZXh0IGltYWdlLiBUaGlzIGltYWdl
Cj4gPiBAQCAtMTczOSwxNCArMTczOSwxNCBAQCBzdGF0aWMgaW50IGdlbjhfY29uZmlndXJlX2Fs
bF9jb250ZXh0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkgKiBT
byBmYXIgdGhlIGJlc3Qgd2F5IHRvIHdvcmsgYXJvdW5kIHRoaXMgaXNzdWUgc2VlbXMgdG8gYmUg
ZHJhaW5pbmcKPiA+ICAgCSAqIHRoZSBHUFUgZnJvbSBhbnkgc3VibWl0dGVkIHdvcmsuCj4gPiAg
IAkgKi8KPiA+IC0JcmV0ID0gaTkxNV9nZW1fd2FpdF9mb3JfaWRsZShkZXZfcHJpdiwKPiA+ICsJ
cmV0ID0gaTkxNV9nZW1fd2FpdF9mb3JfaWRsZShpOTE1LAo+ID4gICAJCQkJICAgICBJOTE1X1dB
SVRfTE9DS0VELAo+ID4gICAJCQkJICAgICBNQVhfU0NIRURVTEVfVElNRU9VVCk7Cj4gPiAgIAlp
ZiAocmV0KQo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiAgIAkvKiBVcGRhdGUgYWxsIGNvbnRleHRz
IG5vdyB0aGF0IHdlJ3ZlIHN0YWxsZWQgdGhlIHN1Ym1pc3Npb24uICovCj4gPiAtCWxpc3RfZm9y
X2VhY2hfZW50cnkoY3R4LCAmZGV2X3ByaXYtPmNvbnRleHRzLmxpc3QsIGxpbmspIHsKPiA+ICsJ
bGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsICZpOTE1LT5jb250ZXh0cy5saXN0LCBsaW5rKSB7Cj4g
PiAgIAkJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNfaXRlciBpdDsKPiA+ICAgCQlzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2U7Cj4gPiBAQCAtMTc4Myw3ICsxNzgzLDcgQEAgc3RhdGljIGludCBnZW44
X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gICAJICogQXBwbHkgdGhlIGNvbmZpZ3VyYXRpb24gYnkgZG9pbmcgb25lIGNvbnRleHQg
cmVzdG9yZSBvZiB0aGUgZWRpdGVkCj4gPiAgIAkgKiBjb250ZXh0IGltYWdlLgo+ID4gICAJICov
Cj4gPiAtCXJxID0gaTkxNV9yZXF1ZXN0X2NyZWF0ZShkZXZfcHJpdi0+ZW5naW5lW1JDUzBdLT5r
ZXJuZWxfY29udGV4dCk7Cj4gPiArCXJxID0gaTkxNV9yZXF1ZXN0X2NyZWF0ZShpOTE1LT5lbmdp
bmVbUkNTMF0tPmtlcm5lbF9jb250ZXh0KTsKPiA+ICAgCWlmIChJU19FUlIocnEpKQo+ID4gICAJ
CXJldHVybiBQVFJfRVJSKHJxKTsKPiA+IEBAIC0xNzk0LDcgKzE3OTQsNyBAQCBzdGF0aWMgaW50
IGdlbjhfY29uZmlndXJlX2FsbF9jb250ZXh0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAgIHN0YXRpYyBpbnQgZ2VuOF9lbmFibGVfbWV0cmljX3NldChzdHJ1Y3QgaTkx
NV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ID4gICAJY29uc3Qgc3RydWN0IGk5MTVfb2Ff
Y29uZmlnICpvYV9jb25maWcgPSBzdHJlYW0tPm9hX2NvbmZpZzsKPiA+ICAgCWludCByZXQ7Cj4g
PiBAQCAtMTgyMSw3ICsxODIxLDcgQEAgc3RhdGljIGludCBnZW44X2VuYWJsZV9tZXRyaWNfc2V0
KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCj4gPiAgIAkgKiBiZSByZWFkIGJhY2sg
ZnJvbSBhdXRvbWF0aWNhbGx5IHRyaWdnZXJlZCByZXBvcnRzLCBhcyBwYXJ0IG9mIHRoZQo+ID4g
ICAJICogUlBUX0lEIGZpZWxkLgo+ID4gICAJICovCj4gPiAtCWlmIChJU19HRU5fUkFOR0UoZGV2
X3ByaXYsIDksIDExKSkgewo+ID4gKwlpZiAoSVNfR0VOX1JBTkdFKGk5MTUsIDksIDExKSkgewo+
ID4gICAJCUk5MTVfV1JJVEUoR0VOOF9PQV9ERUJVRywKPiA+ICAgCQkJICAgX01BU0tFRF9CSVRf
RU5BQkxFKEdFTjlfT0FfREVCVUdfRElTQUJMRV9DTEtfUkFUSU9fUkVQT1JUUyB8Cj4gPiAgIAkJ
CQkJICAgICAgR0VOOV9PQV9ERUJVR19JTkNMVURFX0NMS19SQVRJTykpOwo+ID4gQEAgLTE4MzIs
MzEgKzE4MzIsMzEgQEAgc3RhdGljIGludCBnZW44X2VuYWJsZV9tZXRyaWNfc2V0KHN0cnVjdCBp
OTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCj4gPiAgIAkgKiB0byBtYWtlIHN1cmUgYWxsIHNsaWNl
cy9zdWJzbGljZXMgYXJlIE9OIGJlZm9yZSB3cml0aW5nIHRvIE5PQQo+ID4gICAJICogcmVnaXN0
ZXJzLgo+ID4gICAJICovCj4gPiAtCXJldCA9IGdlbjhfY29uZmlndXJlX2FsbF9jb250ZXh0cyhk
ZXZfcHJpdiwgb2FfY29uZmlnKTsKPiA+ICsJcmV0ID0gZ2VuOF9jb25maWd1cmVfYWxsX2NvbnRl
eHRzKGk5MTUsIG9hX2NvbmZpZyk7Cj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCXJldHVybiByZXQ7
Cj4gPiAtCWNvbmZpZ19vYV9yZWdzKGRldl9wcml2LCBvYV9jb25maWctPm11eF9yZWdzLCBvYV9j
b25maWctPm11eF9yZWdzX2xlbik7Cj4gPiArCWNvbmZpZ19vYV9yZWdzKGk5MTUsIG9hX2NvbmZp
Zy0+bXV4X3JlZ3MsIG9hX2NvbmZpZy0+bXV4X3JlZ3NfbGVuKTsKPiA+IC0JY29uZmlnX29hX3Jl
Z3MoZGV2X3ByaXYsIG9hX2NvbmZpZy0+Yl9jb3VudGVyX3JlZ3MsCj4gPiArCWNvbmZpZ19vYV9y
ZWdzKGk5MTUsIG9hX2NvbmZpZy0+Yl9jb3VudGVyX3JlZ3MsCj4gPiAgIAkJICAgICAgIG9hX2Nv
bmZpZy0+Yl9jb3VudGVyX3JlZ3NfbGVuKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiAt
c3RhdGljIHZvaWQgZ2VuOF9kaXNhYmxlX21ldHJpY19zZXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGdlbjhfZGlzYWJsZV9tZXRyaWNfc2V0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAkvKiBSZXNldCBhbGwg
Y29udGV4dHMnIHNsaWNlcy9zdWJzbGljZXMgY29uZmlndXJhdGlvbnMuICovCj4gPiAtCWdlbjhf
Y29uZmlndXJlX2FsbF9jb250ZXh0cyhkZXZfcHJpdiwgTlVMTCk7Cj4gPiArCWdlbjhfY29uZmln
dXJlX2FsbF9jb250ZXh0cyhpOTE1LCBOVUxMKTsKPiA+ICAgCUk5MTVfV1JJVEUoR0RUX0NISUNL
RU5fQklUUywgKEk5MTVfUkVBRChHRFRfQ0hJQ0tFTl9CSVRTKSAmCj4gPiAgIAkJCQkgICAgICB+
R1RfTk9BX0VOQUJMRSkpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuMTBfZGlzYWJsZV9t
ZXRyaWNfc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMg
dm9pZCBnZW4xMF9kaXNhYmxlX21ldHJpY19zZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gPiAgIHsKPiA+ICAgCS8qIFJlc2V0IGFsbCBjb250ZXh0cycgc2xpY2VzL3N1YnNsaWNl
cyBjb25maWd1cmF0aW9ucy4gKi8KPiA+IC0JZ2VuOF9jb25maWd1cmVfYWxsX2NvbnRleHRzKGRl
dl9wcml2LCBOVUxMKTsKPiA+ICsJZ2VuOF9jb25maWd1cmVfYWxsX2NvbnRleHRzKGk5MTUsIE5V
TEwpOwo+ID4gICAJLyogTWFrZSBzdXJlIHdlIGRpc2FibGUgbm9hIHRvIHNhdmUgcG93ZXIuICov
Cj4gPiAgIAlJOTE1X1dSSVRFKFJQTV9DT05GSUcxLAo+ID4gQEAgLTE4NjUsMTIgKzE4NjUsMTIg
QEAgc3RhdGljIHZvaWQgZ2VuMTBfZGlzYWJsZV9tZXRyaWNfc2V0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICAgc3RhdGljIHZvaWQgZ2VuN19vYV9lbmFibGUoc3RydWN0
IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBzdHJlYW0tPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+aTkxNTsKPiA+ICAgCXN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0ICpjdHggPSBzdHJlYW0tPmN0eDsKPiA+IC0JdTMyIGN0eF9pZCA9IGRldl9wcml2LT5w
ZXJmLm9hLnNwZWNpZmljX2N0eF9pZDsKPiA+IC0JYm9vbCBwZXJpb2RpYyA9IGRldl9wcml2LT5w
ZXJmLm9hLnBlcmlvZGljOwo+ID4gLQl1MzIgcGVyaW9kX2V4cG9uZW50ID0gZGV2X3ByaXYtPnBl
cmYub2EucGVyaW9kX2V4cG9uZW50Owo+ID4gLQl1MzIgcmVwb3J0X2Zvcm1hdCA9IGRldl9wcml2
LT5wZXJmLm9hLm9hX2J1ZmZlci5mb3JtYXQ7Cj4gPiArCXUzMiBjdHhfaWQgPSBpOTE1LT5wZXJm
Lm9hLnNwZWNpZmljX2N0eF9pZDsKPiA+ICsJYm9vbCBwZXJpb2RpYyA9IGk5MTUtPnBlcmYub2Eu
cGVyaW9kaWM7Cj4gPiArCXUzMiBwZXJpb2RfZXhwb25lbnQgPSBpOTE1LT5wZXJmLm9hLnBlcmlv
ZF9leHBvbmVudDsKPiA+ICsJdTMyIHJlcG9ydF9mb3JtYXQgPSBpOTE1LT5wZXJmLm9hLm9hX2J1
ZmZlci5mb3JtYXQ7Cj4gPiAgIAkvKgo+ID4gICAJICogUmVzZXQgYnVmIHBvaW50ZXJzIHNvIHdl
IGRvbid0IGZvcndhcmQgcmVwb3J0cyBmcm9tIGJlZm9yZSBub3cuCj4gPiBAQCAtMTg4MSw3ICsx
ODgxLDcgQEAgc3RhdGljIHZvaWQgZ2VuN19vYV9lbmFibGUoc3RydWN0IGk5MTVfcGVyZl9zdHJl
YW0gKnN0cmVhbSkKPiA+ICAgCSAqIG9uIHRoZSBhc3N1bXB0aW9uIHRoYXQgY2VydGFpbiBmaWVs
ZHMgYXJlIHdyaXR0ZW4gdG8gemVyb2VkCj4gPiAgIAkgKiBtZW1vcnkgd2hpY2ggdGhpcyBoZWxw
cyBtYWludGFpbnMuCj4gPiAgIAkgKi8KPiA+IC0JZ2VuN19pbml0X29hX2J1ZmZlcihkZXZfcHJp
dik7Cj4gPiArCWdlbjdfaW5pdF9vYV9idWZmZXIoaTkxNSk7Cj4gPiAgIAlJOTE1X1dSSVRFKEdF
TjdfT0FDT05UUk9MLAo+ID4gICAJCSAgIChjdHhfaWQgJiBHRU43X09BQ09OVFJPTF9DVFhfTUFT
SykgfAo+ID4gQEAgLTE4OTUsOCArMTg5NSw4IEBAIHN0YXRpYyB2b2lkIGdlbjdfb2FfZW5hYmxl
KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCj4gPiAgIHN0YXRpYyB2b2lkIGdlbjhf
b2FfZW5hYmxlKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gc3RyZWFtLT5kZXZfcHJpdjsKPiA+
IC0JdTMyIHJlcG9ydF9mb3JtYXQgPSBkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuZm9ybWF0
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVhbS0+aTkxNTsKPiA+
ICsJdTMyIHJlcG9ydF9mb3JtYXQgPSBpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5mb3JtYXQ7Cj4g
PiAgIAkvKgo+ID4gICAJICogUmVzZXQgYnVmIHBvaW50ZXJzIHNvIHdlIGRvbid0IGZvcndhcmQg
cmVwb3J0cyBmcm9tIGJlZm9yZSBub3cuCj4gPiBAQCAtMTkwNyw3ICsxOTA3LDcgQEAgc3RhdGlj
IHZvaWQgZ2VuOF9vYV9lbmFibGUoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKPiA+
ICAgCSAqIG9uIHRoZSBhc3N1bXB0aW9uIHRoYXQgY2VydGFpbiBmaWVsZHMgYXJlIHdyaXR0ZW4g
dG8gemVyb2VkCj4gPiAgIAkgKiBtZW1vcnkgd2hpY2ggdGhpcyBoZWxwcyBtYWludGFpbnMuCj4g
PiAgIAkgKi8KPiA+IC0JZ2VuOF9pbml0X29hX2J1ZmZlcihkZXZfcHJpdik7Cj4gPiArCWdlbjhf
aW5pdF9vYV9idWZmZXIoaTkxNSk7Cj4gPiAgIAkvKgo+ID4gICAJICogTm90ZTogd2UgZG9uJ3Qg
cmVseSBvbiB0aGUgaGFyZHdhcmUgdG8gcGVyZm9ybSBzaW5nbGUgY29udGV4dAo+ID4gQEAgLTE5
MzAsMTkgKzE5MzAsMTkgQEAgc3RhdGljIHZvaWQgZ2VuOF9vYV9lbmFibGUoc3RydWN0IGk5MTVf
cGVyZl9zdHJlYW0gKnN0cmVhbSkKPiA+ICAgICovCj4gPiAgIHN0YXRpYyB2b2lkIGk5MTVfb2Ff
c3RyZWFtX2VuYWJsZShzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ID4g
LQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMub2FfZW5hYmxlKHN0cmVhbSk7Cj4gPiArCWk5MTUtPnBl
cmYub2Eub3BzLm9hX2VuYWJsZShzdHJlYW0pOwo+ID4gLQlpZiAoZGV2X3ByaXYtPnBlcmYub2Eu
cGVyaW9kaWMpCj4gPiAtCQlocnRpbWVyX3N0YXJ0KCZkZXZfcHJpdi0+cGVyZi5vYS5wb2xsX2No
ZWNrX3RpbWVyLAo+ID4gKwlpZiAoaTkxNS0+cGVyZi5vYS5wZXJpb2RpYykKPiA+ICsJCWhydGlt
ZXJfc3RhcnQoJmk5MTUtPnBlcmYub2EucG9sbF9jaGVja190aW1lciwKPiA+ICAgCQkJICAgICAg
bnNfdG9fa3RpbWUoUE9MTF9QRVJJT0QpLAo+ID4gICAJCQkgICAgICBIUlRJTUVSX01PREVfUkVM
X1BJTk5FRCk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgZ2VuN19vYV9kaXNhYmxlKHN0cnVj
dCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3Vu
Y29yZSAqdW5jb3JlID0gJnN0cmVhbS0+ZGV2X3ByaXYtPnVuY29yZTsKPiA+ICsJc3RydWN0IGlu
dGVsX3VuY29yZSAqdW5jb3JlID0gJnN0cmVhbS0+aTkxNS0+dW5jb3JlOwo+ID4gICAJaW50ZWxf
dW5jb3JlX3dyaXRlKHVuY29yZSwgR0VON19PQUNPTlRST0wsIDApOwo+ID4gICAJaWYgKGludGVs
X3dhaXRfZm9yX3JlZ2lzdGVyKHVuY29yZSwKPiA+IEBAIC0xOTUzLDcgKzE5NTMsNyBAQCBzdGF0
aWMgdm9pZCBnZW43X29hX2Rpc2FibGUoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkK
PiA+ICAgc3RhdGljIHZvaWQgZ2VuOF9vYV9kaXNhYmxlKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFt
ICpzdHJlYW0pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJnN0
cmVhbS0+ZGV2X3ByaXYtPnVuY29yZTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3Jl
ID0gJnN0cmVhbS0+aTkxNS0+dW5jb3JlOwo+ID4gICAJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29y
ZSwgR0VOOF9PQUNPTlRST0wsIDApOwo+ID4gICAJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVy
KHVuY29yZSwKPiA+IEBAIC0xOTcyLDEyICsxOTcyLDEyIEBAIHN0YXRpYyB2b2lkIGdlbjhfb2Ff
ZGlzYWJsZShzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQo+ID4gICAgKi8KPiA+ICAg
c3RhdGljIHZvaWQgaTkxNV9vYV9zdHJlYW1fZGlzYWJsZShzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVh
bSAqc3RyZWFtKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gc3RyZWFtLT5pOTE1Owo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMub2FfZGlzYWJsZShz
dHJlYW0pOwo+ID4gKwlpOTE1LT5wZXJmLm9hLm9wcy5vYV9kaXNhYmxlKHN0cmVhbSk7Cj4gPiAt
CWlmIChkZXZfcHJpdi0+cGVyZi5vYS5wZXJpb2RpYykKPiA+IC0JCWhydGltZXJfY2FuY2VsKCZk
ZXZfcHJpdi0+cGVyZi5vYS5wb2xsX2NoZWNrX3RpbWVyKTsKPiA+ICsJaWYgKGk5MTUtPnBlcmYu
b2EucGVyaW9kaWMpCj4gPiArCQlocnRpbWVyX2NhbmNlbCgmaTkxNS0+cGVyZi5vYS5wb2xsX2No
ZWNrX3RpbWVyKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfcGVyZl9z
dHJlYW1fb3BzIGk5MTVfb2Ffc3RyZWFtX29wcyA9IHsKPiA+IEBAIC0yMDExLDcgKzIwMTEsNyBA
QCBzdGF0aWMgaW50IGk5MTVfb2Ffc3RyZWFtX2luaXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0g
KnN0cmVhbSwKPiA+ICAgCQkJICAgICAgIHN0cnVjdCBkcm1faTkxNV9wZXJmX29wZW5fcGFyYW0g
KnBhcmFtLAo+ID4gICAJCQkgICAgICAgc3RydWN0IHBlcmZfb3Blbl9wcm9wZXJ0aWVzICpwcm9w
cykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBzdHJl
YW0tPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHN0cmVh
bS0+aTkxNTsKPiA+ICAgCWludCBmb3JtYXRfc2l6ZTsKPiA+ICAgCWludCByZXQ7Cj4gPiBAQCAt
MjAxOSw3ICsyMDE5LDcgQEAgc3RhdGljIGludCBpOTE1X29hX3N0cmVhbV9pbml0KHN0cnVjdCBp
OTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4gPiAgIAkgKiByZWFzb24gdGhlbiBkb24ndCBsZXQg
dXNlcnNwYWNlIHRyeSB0aGVpciBsdWNrIHdpdGggY29uZmlnCj4gPiAgIAkgKiBJRHMKPiA+ICAg
CSAqLwo+ID4gLQlpZiAoIWRldl9wcml2LT5wZXJmLm1ldHJpY3Nfa29iaikgewo+ID4gKwlpZiAo
IWk5MTUtPnBlcmYubWV0cmljc19rb2JqKSB7Cj4gPiAgIAkJRFJNX0RFQlVHKCJPQSBtZXRyaWNz
IHdlcmVuJ3QgYWR2ZXJ0aXNlZCB2aWEgc3lzZnNcbiIpOwo+ID4gICAJCXJldHVybiAtRUlOVkFM
Owo+ID4gICAJfQo+ID4gQEAgLTIwMjksNyArMjAyOSw3IEBAIHN0YXRpYyBpbnQgaTkxNV9vYV9z
dHJlYW1faW5pdChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAo+ID4gICAJCXJldHVy
biAtRUlOVkFMOwo+ID4gICAJfQo+ID4gLQlpZiAoIWRldl9wcml2LT5wZXJmLm9hLm9wcy5lbmFi
bGVfbWV0cmljX3NldCkgewo+ID4gKwlpZiAoIWk5MTUtPnBlcmYub2Eub3BzLmVuYWJsZV9tZXRy
aWNfc2V0KSB7Cj4gPiAgIAkJRFJNX0RFQlVHKCJPQSB1bml0IG5vdCBzdXBwb3J0ZWRcbiIpOwo+
ID4gICAJCXJldHVybiAtRU5PREVWOwo+ID4gICAJfQo+ID4gQEAgLTIwMzgsNyArMjAzOCw3IEBA
IHN0YXRpYyBpbnQgaTkxNV9vYV9zdHJlYW1faW5pdChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAq
c3RyZWFtLAo+ID4gICAJICogY291bnRlciByZXBvcnRzIGFuZCBtYXJzaGFsIHRvIHRoZSBhcHBy
b3ByaWF0ZSBjbGllbnQKPiA+ICAgCSAqIHdlIGN1cnJlbnRseSBvbmx5IGFsbG93IGV4Y2x1c2l2
ZSBhY2Nlc3MKPiA+ICAgCSAqLwo+ID4gLQlpZiAoZGV2X3ByaXYtPnBlcmYub2EuZXhjbHVzaXZl
X3N0cmVhbSkgewo+ID4gKwlpZiAoaTkxNS0+cGVyZi5vYS5leGNsdXNpdmVfc3RyZWFtKSB7Cj4g
PiAgIAkJRFJNX0RFQlVHKCJPQSB1bml0IGFscmVhZHkgaW4gdXNlXG4iKTsKPiA+ICAgCQlyZXR1
cm4gLUVCVVNZOwo+ID4gICAJfQo+ID4gQEAgLTIwNTksMzIgKzIwNTksMzIgQEAgc3RhdGljIGlu
dCBpOTE1X29hX3N0cmVhbV9pbml0KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCj4g
PiAgIAkgKgo+ID4gICAJICogVXNpbmcgdGhlIHNhbWUgbGltaXRpbmcgZmFjdG9ycyBhcyBwcmlu
dGtfcmF0ZWxpbWl0KCkKPiA+ICAgCSAqLwo+ID4gLQlyYXRlbGltaXRfc3RhdGVfaW5pdCgmZGV2
X3ByaXYtPnBlcmYub2Euc3B1cmlvdXNfcmVwb3J0X3JzLAo+ID4gKwlyYXRlbGltaXRfc3RhdGVf
aW5pdCgmaTkxNS0+cGVyZi5vYS5zcHVyaW91c19yZXBvcnRfcnMsCj4gPiAgIAkJCSAgICAgNSAq
IEhaLCAxMCk7Cj4gPiAgIAkvKiBTaW5jZSB3ZSB1c2UgYSBEUk1fTk9URSBmb3Igc3B1cmlvdXMg
cmVwb3J0cyBpdCB3b3VsZCBiZQo+ID4gICAJICogaW5jb25zaXN0ZW50IHRvIGxldCBfX3JhdGVs
aW1pdCgpIGF1dG9tYXRpY2FsbHkgcHJpbnQgYSB3YXJuaW5nIGZvcgo+ID4gICAJICogdGhyb3R0
bGluZy4KPiA+ICAgCSAqLwo+ID4gLQlyYXRlbGltaXRfc2V0X2ZsYWdzKCZkZXZfcHJpdi0+cGVy
Zi5vYS5zcHVyaW91c19yZXBvcnRfcnMsCj4gPiArCXJhdGVsaW1pdF9zZXRfZmxhZ3MoJmk5MTUt
PnBlcmYub2Euc3B1cmlvdXNfcmVwb3J0X3JzLAo+ID4gICAJCQkgICAgUkFURUxJTUlUX01TR19P
Tl9SRUxFQVNFKTsKPiA+ICAgCXN0cmVhbS0+c2FtcGxlX3NpemUgPSBzaXplb2Yoc3RydWN0IGRy
bV9pOTE1X3BlcmZfcmVjb3JkX2hlYWRlcik7Cj4gPiAtCWZvcm1hdF9zaXplID0gZGV2X3ByaXYt
PnBlcmYub2Eub2FfZm9ybWF0c1twcm9wcy0+b2FfZm9ybWF0XS5zaXplOwo+ID4gKwlmb3JtYXRf
c2l6ZSA9IGk5MTUtPnBlcmYub2Eub2FfZm9ybWF0c1twcm9wcy0+b2FfZm9ybWF0XS5zaXplOwo+
ID4gICAJc3RyZWFtLT5zYW1wbGVfZmxhZ3MgfD0gU0FNUExFX09BX1JFUE9SVDsKPiA+ICAgCXN0
cmVhbS0+c2FtcGxlX3NpemUgKz0gZm9ybWF0X3NpemU7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9h
Lm9hX2J1ZmZlci5mb3JtYXRfc2l6ZSA9IGZvcm1hdF9zaXplOwo+ID4gLQlpZiAoV0FSTl9PTihk
ZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuZm9ybWF0X3NpemUgPT0gMCkpCj4gPiArCWk5MTUt
PnBlcmYub2Eub2FfYnVmZmVyLmZvcm1hdF9zaXplID0gZm9ybWF0X3NpemU7Cj4gPiArCWlmIChX
QVJOX09OKGk5MTUtPnBlcmYub2Eub2FfYnVmZmVyLmZvcm1hdF9zaXplID09IDApKQo+ID4gICAJ
CXJldHVybiAtRUlOVkFMOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5vYS5vYV9idWZmZXIuZm9ybWF0
ID0KPiA+IC0JCWRldl9wcml2LT5wZXJmLm9hLm9hX2Zvcm1hdHNbcHJvcHMtPm9hX2Zvcm1hdF0u
Zm9ybWF0Owo+ID4gKwlpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5mb3JtYXQgPQo+ID4gKwkJaTkx
NS0+cGVyZi5vYS5vYV9mb3JtYXRzW3Byb3BzLT5vYV9mb3JtYXRdLmZvcm1hdDsKPiA+IC0JZGV2
X3ByaXYtPnBlcmYub2EucGVyaW9kaWMgPSBwcm9wcy0+b2FfcGVyaW9kaWM7Cj4gPiAtCWlmIChk
ZXZfcHJpdi0+cGVyZi5vYS5wZXJpb2RpYykKPiA+IC0JCWRldl9wcml2LT5wZXJmLm9hLnBlcmlv
ZF9leHBvbmVudCA9IHByb3BzLT5vYV9wZXJpb2RfZXhwb25lbnQ7Cj4gPiArCWk5MTUtPnBlcmYu
b2EucGVyaW9kaWMgPSBwcm9wcy0+b2FfcGVyaW9kaWM7Cj4gPiArCWlmIChpOTE1LT5wZXJmLm9h
LnBlcmlvZGljKQo+ID4gKwkJaTkxNS0+cGVyZi5vYS5wZXJpb2RfZXhwb25lbnQgPSBwcm9wcy0+
b2FfcGVyaW9kX2V4cG9uZW50Owo+ID4gICAJaWYgKHN0cmVhbS0+Y3R4KSB7Cj4gPiAgIAkJcmV0
ID0gb2FfZ2V0X3JlbmRlcl9jdHhfaWQoc3RyZWFtKTsKPiA+IEBAIC0yMDk0LDcgKzIwOTQsNyBA
QCBzdGF0aWMgaW50IGk5MTVfb2Ffc3RyZWFtX2luaXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0g
KnN0cmVhbSwKPiA+ICAgCQl9Cj4gPiAgIAl9Cj4gPiAtCXJldCA9IGdldF9vYV9jb25maWcoZGV2
X3ByaXYsIHByb3BzLT5tZXRyaWNzX3NldCwgJnN0cmVhbS0+b2FfY29uZmlnKTsKPiA+ICsJcmV0
ID0gZ2V0X29hX2NvbmZpZyhpOTE1LCBwcm9wcy0+bWV0cmljc19zZXQsICZzdHJlYW0tPm9hX2Nv
bmZpZyk7Cj4gPiAgIAlpZiAocmV0KSB7Cj4gPiAgIAkJRFJNX0RFQlVHKCJJbnZhbGlkIE9BIGNv
bmZpZyBpZD0laVxuIiwgcHJvcHMtPm1ldHJpY3Nfc2V0KTsKPiA+ICAgCQlnb3RvIGVycl9jb25m
aWc7Cj4gPiBAQCAtMjExMiw0MyArMjExMiw0MyBAQCBzdGF0aWMgaW50IGk5MTVfb2Ffc3RyZWFt
X2luaXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKPiA+ICAgCSAqICAgSW4gb3Vy
IGNhc2Ugd2UgYXJlIGV4cGVjdGluZyB0aGF0IHRha2luZyBwbSArIEZPUkNFV0FLRQo+ID4gICAJ
ICogICByZWZlcmVuY2VzIHdpbGwgZWZmZWN0aXZlbHkgZGlzYWJsZSBSQzYuCj4gPiAgIAkgKi8K
PiA+IC0Jc3RyZWFtLT53YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+
ID4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VX
QUtFX0FMTCk7Cj4gPiArCXN0cmVhbS0+d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5
MTUpOwo+ID4gKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBGT1JD
RVdBS0VfQUxMKTsKPiA+IC0JcmV0ID0gYWxsb2Nfb2FfYnVmZmVyKGRldl9wcml2KTsKPiA+ICsJ
cmV0ID0gYWxsb2Nfb2FfYnVmZmVyKGk5MTUpOwo+ID4gICAJaWYgKHJldCkKPiA+ICAgCQlnb3Rv
IGVycl9vYV9idWZfYWxsb2M7Cj4gPiAtCXJldCA9IGk5MTVfbXV0ZXhfbG9ja19pbnRlcnJ1cHRp
YmxlKCZkZXZfcHJpdi0+ZHJtKTsKPiA+ICsJcmV0ID0gaTkxNV9tdXRleF9sb2NrX2ludGVycnVw
dGlibGUoJmk5MTUtPmRybSk7Cj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCWdvdG8gZXJyX2xvY2s7
Cj4gPiAgIAlzdHJlYW0tPm9wcyA9ICZpOTE1X29hX3N0cmVhbV9vcHM7Cj4gPiAtCWRldl9wcml2
LT5wZXJmLm9hLmV4Y2x1c2l2ZV9zdHJlYW0gPSBzdHJlYW07Cj4gPiArCWk5MTUtPnBlcmYub2Eu
ZXhjbHVzaXZlX3N0cmVhbSA9IHN0cmVhbTsKPiA+IC0JcmV0ID0gZGV2X3ByaXYtPnBlcmYub2Eu
b3BzLmVuYWJsZV9tZXRyaWNfc2V0KHN0cmVhbSk7Cj4gPiArCXJldCA9IGk5MTUtPnBlcmYub2Eu
b3BzLmVuYWJsZV9tZXRyaWNfc2V0KHN0cmVhbSk7Cj4gPiAgIAlpZiAocmV0KSB7Cj4gPiAgIAkJ
RFJNX0RFQlVHKCJVbmFibGUgdG8gZW5hYmxlIG1ldHJpYyBzZXRcbiIpOwo+ID4gICAJCWdvdG8g
ZXJyX2VuYWJsZTsKPiA+ICAgCX0KPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0
cnVjdF9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Cj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgZXJyX2VuYWJsZToKPiA+IC0JZGV2X3ByaXYtPnBlcmYu
b2EuZXhjbHVzaXZlX3N0cmVhbSA9IE5VTEw7Cj4gPiAtCWRldl9wcml2LT5wZXJmLm9hLm9wcy5k
aXNhYmxlX21ldHJpY19zZXQoZGV2X3ByaXYpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2
LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJaTkxNS0+cGVyZi5vYS5leGNsdXNpdmVfc3RyZWFt
ID0gTlVMTDsKPiA+ICsJaTkxNS0+cGVyZi5vYS5vcHMuZGlzYWJsZV9tZXRyaWNfc2V0KGk5MTUp
Owo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICBlcnJf
bG9jazoKPiA+IC0JZnJlZV9vYV9idWZmZXIoZGV2X3ByaXYpOwo+ID4gKwlmcmVlX29hX2J1ZmZl
cihpOTE1KTsKPiA+ICAgZXJyX29hX2J1Zl9hbGxvYzoKPiA+IC0JcHV0X29hX2NvbmZpZyhkZXZf
cHJpdiwgc3RyZWFtLT5vYV9jb25maWcpOwo+ID4gKwlwdXRfb2FfY29uZmlnKGk5MTUsIHN0cmVh
bS0+b2FfY29uZmlnKTsKPiA+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2
LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZf
cHJpdiwgc3RyZWFtLT53YWtlcmVmKTsKPiA+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQo
Jmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCWludGVsX3J1bnRpbWVfcG1fcHV0
KGk5MTUsIHN0cmVhbS0+d2FrZXJlZik7Cj4gPiAgIGVycl9jb25maWc6Cj4gPiAgIAlpZiAoc3Ry
ZWFtLT5jdHgpCj4gPiBAQCAtMjIzOCw3ICsyMjM4LDcgQEAgc3RhdGljIHNzaXplX3QgaTkxNV9w
ZXJmX3JlYWQoc3RydWN0IGZpbGUgKmZpbGUsCj4gPiAgIAkJCSAgICAgIGxvZmZfdCAqcHBvcykK
PiA+ICAgewo+ID4gICAJc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSA9IGZpbGUtPnBy
aXZhdGVfZGF0YTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gc3Ry
ZWFtLT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBzdHJl
YW0tPmk5MTU7Cj4gPiAgIAlzc2l6ZV90IHJldDsKPiA+ICAgCS8qIFRvIGVuc3VyZSBpdCdzIGhh
bmRsZWQgY29uc2lzdGVudGx5IHdlIHNpbXBseSB0cmVhdCBhbGwgcmVhZHMgb2YgYQo+ID4gQEAg
LTIyNjEsMTUgKzIyNjEsMTUgQEAgc3RhdGljIHNzaXplX3QgaTkxNV9wZXJmX3JlYWQoc3RydWN0
IGZpbGUgKmZpbGUsCj4gPiAgIAkJCWlmIChyZXQpCj4gPiAgIAkJCQlyZXR1cm4gcmV0Owo+ID4g
LQkJCW11dGV4X2xvY2soJmRldl9wcml2LT5wZXJmLmxvY2spOwo+ID4gKwkJCW11dGV4X2xvY2so
Jmk5MTUtPnBlcmYubG9jayk7Cj4gPiAgIAkJCXJldCA9IGk5MTVfcGVyZl9yZWFkX2xvY2tlZChz
dHJlYW0sIGZpbGUsCj4gPiAgIAkJCQkJCSAgICBidWYsIGNvdW50LCBwcG9zKTsKPiA+IC0JCQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5wZXJmLmxvY2spOwo+ID4gKwkJCW11dGV4X3VubG9jaygm
aTkxNS0+cGVyZi5sb2NrKTsKPiA+ICAgCQl9IHdoaWxlIChyZXQgPT0gLUVBR0FJTik7Cj4gPiAg
IAl9IGVsc2Ugewo+ID4gLQkJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBlcmYubG9jayk7Cj4gPiAr
CQltdXRleF9sb2NrKCZpOTE1LT5wZXJmLmxvY2spOwo+ID4gICAJCXJldCA9IGk5MTVfcGVyZl9y
ZWFkX2xvY2tlZChzdHJlYW0sIGZpbGUsIGJ1ZiwgY291bnQsIHBwb3MpOwo+ID4gLQkJbXV0ZXhf
dW5sb2NrKCZkZXZfcHJpdi0+cGVyZi5sb2NrKTsKPiA+ICsJCW11dGV4X3VubG9jaygmaTkxNS0+
cGVyZi5sb2NrKTsKPiA+ICAgCX0KPiA+ICAgCS8qIFdlIGFsbG93IHRoZSBwb2xsIGNoZWNraW5n
IHRvIHNvbWV0aW1lcyByZXBvcnQgZmFsc2UgcG9zaXRpdmUgRVBPTExJTgo+ID4gQEAgLTIyODQs
NyArMjI4NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGk5MTVfcGVyZl9yZWFkKHN0cnVjdCBmaWxlICpm
aWxlLAo+ID4gICAJCS8qIE1heWJlIG1ha2UgLT5wb2xsaW4gcGVyLXN0cmVhbSBzdGF0ZSBpZiB3
ZSBzdXBwb3J0IG11bHRpcGxlCj4gPiAgIAkJICogY29uY3VycmVudCBzdHJlYW1zIGluIHRoZSBm
dXR1cmUuCj4gPiAgIAkJICovCj4gPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5wb2xsaW4gPSBmYWxz
ZTsKPiA+ICsJCWk5MTUtPnBlcmYub2EucG9sbGluID0gZmFsc2U7Cj4gPiAgIAl9Cj4gPiAgIAly
ZXR1cm4gcmV0Owo+ID4gQEAgLTIyOTIsMTMgKzIyOTIsMTMgQEAgc3RhdGljIHNzaXplX3QgaTkx
NV9wZXJmX3JlYWQoc3RydWN0IGZpbGUgKmZpbGUsCj4gPiAgIHN0YXRpYyBlbnVtIGhydGltZXJf
cmVzdGFydCBvYV9wb2xsX2NoZWNrX3RpbWVyX2NiKHN0cnVjdCBocnRpbWVyICpocnRpbWVyKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gPiAtCQlj
b250YWluZXJfb2YoaHJ0aW1lciwgdHlwZW9mKCpkZXZfcHJpdiksCj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0KPiA+ICsJCWNvbnRhaW5lcl9vZihocnRpbWVyLCB0eXBlb2Yo
Kmk5MTUpLAo+ID4gICAJCQkgICAgIHBlcmYub2EucG9sbF9jaGVja190aW1lcik7Cj4gPiAtCWlm
IChvYV9idWZmZXJfY2hlY2tfdW5sb2NrZWQoZGV2X3ByaXYpKSB7Cj4gPiAtCQlkZXZfcHJpdi0+
cGVyZi5vYS5wb2xsaW4gPSB0cnVlOwo+ID4gLQkJd2FrZV91cCgmZGV2X3ByaXYtPnBlcmYub2Eu
cG9sbF93cSk7Cj4gPiArCWlmIChvYV9idWZmZXJfY2hlY2tfdW5sb2NrZWQoaTkxNSkpIHsKPiA+
ICsJCWk5MTUtPnBlcmYub2EucG9sbGluID0gdHJ1ZTsKPiA+ICsJCXdha2VfdXAoJmk5MTUtPnBl
cmYub2EucG9sbF93cSk7Cj4gPiAgIAl9Cj4gPiAgIAlocnRpbWVyX2ZvcndhcmRfbm93KGhydGlt
ZXIsIG5zX3RvX2t0aW1lKFBPTExfUEVSSU9EKSk7Cj4gPiBAQCAtMjMwOCw3ICsyMzA4LDcgQEAg
c3RhdGljIGVudW0gaHJ0aW1lcl9yZXN0YXJ0IG9hX3BvbGxfY2hlY2tfdGltZXJfY2Ioc3RydWN0
IGhydGltZXIgKmhydGltZXIpCj4gPiAgIC8qKgo+ID4gICAgKiBpOTE1X3BlcmZfcG9sbF9sb2Nr
ZWQgLSBwb2xsX3dhaXQoKSB3aXRoIGEgc3VpdGFibGUgd2FpdCBxdWV1ZSBmb3Igc3RyZWFtCj4g
PiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1OiBpOTE1
IGRldmljZSBpbnN0YW5jZQo+ID4gICAgKiBAc3RyZWFtOiBBbiBpOTE1IHBlcmYgc3RyZWFtCj4g
PiAgICAqIEBmaWxlOiBBbiBpOTE1IHBlcmYgc3RyZWFtIGZpbGUKPiA+ICAgICogQHdhaXQ6IHBv
bGwoKSBzdGF0ZSB0YWJsZQo+ID4gQEAgLTIzMjIsNyArMjMyMiw3IEBAIHN0YXRpYyBlbnVtIGhy
dGltZXJfcmVzdGFydCBvYV9wb2xsX2NoZWNrX3RpbWVyX2NiKHN0cnVjdCBocnRpbWVyICpocnRp
bWVyKQo+ID4gICAgKgo+ID4gICAgKiBSZXR1cm5zOiBhbnkgcG9sbCBldmVudHMgdGhhdCBhcmUg
cmVhZHkgd2l0aG91dCBzbGVlcGluZwo+ID4gICAgKi8KPiA+IC1zdGF0aWMgX19wb2xsX3QgaTkx
NV9wZXJmX3BvbGxfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICtzdGF0aWMgX19wb2xsX3QgaTkxNV9wZXJmX3BvbGxfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ID4gICAJCQkJCSAgc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVh
bSwKPiA+ICAgCQkJCQkgIHN0cnVjdCBmaWxlICpmaWxlLAo+ID4gICAJCQkJCSAgcG9sbF90YWJs
ZSAqd2FpdCkKPiA+IEBAIC0yMzM3LDcgKzIzMzcsNyBAQCBzdGF0aWMgX19wb2xsX3QgaTkxNV9w
ZXJmX3BvbGxfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAg
CSAqIHRoZSBocnRpbWVyL29hX3BvbGxfY2hlY2tfdGltZXJfY2IgdG8gbm90aWZ5IHVzIHdoZW4g
dGhlcmUgYXJlCj4gPiAgIAkgKiBzYW1wbGVzIHRvIHJlYWQuCj4gPiAgIAkgKi8KPiA+IC0JaWYg
KGRldl9wcml2LT5wZXJmLm9hLnBvbGxpbikKPiA+ICsJaWYgKGk5MTUtPnBlcmYub2EucG9sbGlu
KQo+ID4gICAJCWV2ZW50cyB8PSBFUE9MTElOOwo+ID4gICAJcmV0dXJuIGV2ZW50czsKPiA+IEBA
IC0yMzU5LDEyICsyMzU5LDEyIEBAIHN0YXRpYyBfX3BvbGxfdCBpOTE1X3BlcmZfcG9sbF9sb2Nr
ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICBzdGF0aWMgX19wb2xs
X3QgaTkxNV9wZXJmX3BvbGwoc3RydWN0IGZpbGUgKmZpbGUsIHBvbGxfdGFibGUgKndhaXQpCj4g
PiAgIHsKPiA+ICAgCXN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0gPSBmaWxlLT5wcml2
YXRlX2RhdGE7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVh
bS0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFt
LT5pOTE1Owo+ID4gICAJX19wb2xsX3QgcmV0Owo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+
cGVyZi5sb2NrKTsKPiA+IC0JcmV0ID0gaTkxNV9wZXJmX3BvbGxfbG9ja2VkKGRldl9wcml2LCBz
dHJlYW0sIGZpbGUsIHdhaXQpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wZXJmLmxv
Y2spOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5wZXJmLmxvY2spOwo+ID4gKwlyZXQgPSBpOTE1
X3BlcmZfcG9sbF9sb2NrZWQoaTkxNSwgc3RyZWFtLCBmaWxlLCB3YWl0KTsKPiA+ICsJbXV0ZXhf
dW5sb2NrKCZpOTE1LT5wZXJmLmxvY2spOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4g
QEAgLTI0NjEsMTIgKzI0NjEsMTIgQEAgc3RhdGljIGxvbmcgaTkxNV9wZXJmX2lvY3RsKHN0cnVj
dCBmaWxlICpmaWxlLAo+ID4gICAJCQkgICAgdW5zaWduZWQgbG9uZyBhcmcpCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0gPSBmaWxlLT5wcml2YXRlX2RhdGE7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3By
aXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+
ID4gICAJbG9uZyByZXQ7Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5wZXJmLmxvY2spOwo+
ID4gKwltdXRleF9sb2NrKCZpOTE1LT5wZXJmLmxvY2spOwo+ID4gICAJcmV0ID0gaTkxNV9wZXJm
X2lvY3RsX2xvY2tlZChzdHJlYW0sIGNtZCwgYXJnKTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+cGVyZi5sb2NrKTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5wZXJmLmxvY2spOwo+
ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTI1MTEsMTEgKzI1MTEsMTEgQEAgc3Rh
dGljIHZvaWQgaTkxNV9wZXJmX2Rlc3Ryb3lfbG9ja2VkKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFt
ICpzdHJlYW0pCj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9wZXJmX3JlbGVhc2Uoc3RydWN0IGlub2Rl
ICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpOTE1X3Bl
cmZfc3RyZWFtICpzdHJlYW0gPSBmaWxlLT5wcml2YXRlX2RhdGE7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5pOTE1Owo+ID4gLQltdXRleF9sb2NrKCZk
ZXZfcHJpdi0+cGVyZi5sb2NrKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+cGVyZi5sb2NrKTsK
PiA+ICAgCWk5MTVfcGVyZl9kZXN0cm95X2xvY2tlZChzdHJlYW0pOwo+ID4gLQltdXRleF91bmxv
Y2soJmRldl9wcml2LT5wZXJmLmxvY2spOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPnBlcmYu
bG9jayk7Cj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4gQEAgLTI1MzcsNyArMjUzNyw3IEBA
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGZvcHMgPSB7Cj4gPiAgIC8qKgo+
ID4gICAgKiBpOTE1X3BlcmZfb3Blbl9pb2N0bF9sb2NrZWQgLSBEUk0gaW9jdGwoKSBmb3IgdXNl
cnNwYWNlIHRvIG9wZW4gYSBzdHJlYW0gRkQKPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNl
IGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiAgICAqIEBw
YXJhbTogVGhlIG9wZW4gcGFyYW1ldGVycyBwYXNzZWQgdG8gJ0RSTV9JOTE1X1BFUkZfT1BFTmAK
PiA+ICAgICogQHByb3BzOiBpbmRpdmlkdWFsbHkgdmFsaWRhdGVkIHU2NCBwcm9wZXJ0eSB2YWx1
ZSBwYWlycwo+ID4gICAgKiBAZmlsZTogZHJtIGZpbGUKPiA+IEBAIC0yNTYwLDcgKzI1NjAsNyBA
QCBzdGF0aWMgY29uc3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9ucyBmb3BzID0gewo+ID4gICAgKiBS
ZXR1cm5zOiB6ZXJvIG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2RlLgo+ID4gICAg
Ki8KPiA+ICAgc3RhdGljIGludAo+ID4gLWk5MTVfcGVyZl9vcGVuX2lvY3RsX2xvY2tlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAraTkxNV9wZXJmX29wZW5faW9jdGxf
bG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgc3RydWN0
IGRybV9pOTE1X3BlcmZfb3Blbl9wYXJhbSAqcGFyYW0sCj4gPiAgIAkJCSAgICBzdHJ1Y3QgcGVy
Zl9vcGVuX3Byb3BlcnRpZXMgKnByb3BzLAo+ID4gICAJCQkgICAgc3RydWN0IGRybV9maWxlICpm
aWxlKQo+ID4gQEAgLTI1OTksNyArMjU5OSw3IEBAIGk5MTVfcGVyZl9vcGVuX2lvY3RsX2xvY2tl
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkgKiBNSV9SRVBPUlRf
UEVSRl9DT1VOVCBjb21tYW5kcyBhbmQgc28gY29uc2lkZXIgaXQgYSBwcml2aWxlZ2VkIG9wIHRv
Cj4gPiAgIAkgKiBlbmFibGUgdGhlIE9BIHVuaXQgYnkgZGVmYXVsdC4KPiA+ICAgCSAqLwo+ID4g
LQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgc3BlY2lmaWNfY3R4KQo+ID4gKwlpZiAoSVNf
SEFTV0VMTChpOTE1KSAmJiBzcGVjaWZpY19jdHgpCj4gPiAgIAkJcHJpdmlsZWdlZF9vcCA9IGZh
bHNlOwo+ID4gICAJLyogU2ltaWxhciB0byBwZXJmJ3Mga2VybmVsLnBlcmZfcGFyYW5vaWRfY3B1
IHN5c2N0bCBvcHRpb24KPiA+IEBAIC0yNjIwLDcgKzI2MjAsNyBAQCBpOTE1X3BlcmZfb3Blbl9p
b2N0bF9sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCWdv
dG8gZXJyX2N0eDsKPiA+ICAgCX0KPiA+IC0Jc3RyZWFtLT5kZXZfcHJpdiA9IGRldl9wcml2Owo+
ID4gKwlzdHJlYW0tPmk5MTUgPSBpOTE1Owo+ID4gICAJc3RyZWFtLT5jdHggPSBzcGVjaWZpY19j
dHg7Cj4gPiAgIAlyZXQgPSBpOTE1X29hX3N0cmVhbV9pbml0KHN0cmVhbSwgcGFyYW0sIHByb3Bz
KTsKPiA+IEBAIC0yNjM2LDcgKzI2MzYsNyBAQCBpOTE1X3BlcmZfb3Blbl9pb2N0bF9sb2NrZWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCWdvdG8gZXJyX2ZsYWdz
Owo+ID4gICAJfQo+ID4gLQlsaXN0X2FkZCgmc3RyZWFtLT5saW5rLCAmZGV2X3ByaXYtPnBlcmYu
c3RyZWFtcyk7Cj4gPiArCWxpc3RfYWRkKCZzdHJlYW0tPmxpbmssICZpOTE1LT5wZXJmLnN0cmVh
bXMpOwo+ID4gICAJaWYgKHBhcmFtLT5mbGFncyAmIEk5MTVfUEVSRl9GTEFHX0ZEX0NMT0VYRUMp
Cj4gPiAgIAkJZl9mbGFncyB8PSBPX0NMT0VYRUM7Cj4gPiBAQCAtMjY2OCwxNSArMjY2OCwxNSBA
QCBpOTE1X3BlcmZfb3Blbl9pb2N0bF9sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gLXN0YXRpYyB1NjQgb2FfZXhw
b25lbnRfdG9fbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgZXhwb25l
bnQpCj4gPiArc3RhdGljIHU2NCBvYV9leHBvbmVudF90b19ucyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgaW50IGV4cG9uZW50KQo+ID4gICB7Cj4gPiAgIAlyZXR1cm4gZGl2NjRfdTY0
KDEwMDAwMDAwMDBVTEwgKiAoMlVMTCA8PCBleHBvbmVudCksCj4gPiAtCQkJIDEwMDBVTEwgKiBS
VU5USU1FX0lORk8oZGV2X3ByaXYpLT5jc190aW1lc3RhbXBfZnJlcXVlbmN5X2toeik7Cj4gPiAr
CQkJIDEwMDBVTEwgKiBSVU5USU1FX0lORk8oaTkxNSktPmNzX3RpbWVzdGFtcF9mcmVxdWVuY3lf
a2h6KTsKPiA+ICAgfQo+ID4gICAvKioKPiA+ICAgICogcmVhZF9wcm9wZXJ0aWVzX3VubG9ja2Vk
IC0gdmFsaWRhdGUgKyBjb3B5IHVzZXJzcGFjZSBzdHJlYW0gb3BlbiBwcm9wZXJ0aWVzCj4gPiAt
ICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRl
dmljZSBpbnN0YW5jZQo+ID4gICAgKiBAdXByb3BzOiBUaGUgYXJyYXkgb2YgdTY0IGtleSB2YWx1
ZSBwYWlycyBnaXZlbiBieSB1c2Vyc3BhY2UKPiA+ICAgICogQG5fcHJvcHM6IFRoZSBudW1iZXIg
b2Yga2V5IHZhbHVlIHBhaXJzIGV4cGVjdGVkIGluIEB1cHJvcHMKPiA+ICAgICogQHByb3BzOiBU
aGUgc3RyZWFtIGNvbmZpZ3VyYXRpb24gYnVpbHQgdXAgd2hpbGUgdmFsaWRhdGluZyBwcm9wZXJ0
aWVzCj4gPiBAQCAtMjY4OSw3ICsyNjg5LDcgQEAgc3RhdGljIHU2NCBvYV9leHBvbmVudF90b19u
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBleHBvbmVudCkKPiA+ICAg
ICogd2Ugc2hvdWxkbid0IHZhbGlkYXRlIG9yIGFzc3VtZSBhbnl0aGluZyBhYm91dCBvcmRlcmlu
ZyBoZXJlLiBUaGlzIGRvZXNuJ3QKPiA+ICAgICogcnVsZSBvdXQgZGVmaW5pbmcgbmV3IHByb3Bl
cnRpZXMgd2l0aCBvcmRlcmluZyByZXF1aXJlbWVudHMgaW4gdGhlIGZ1dHVyZS4KPiA+ICAgICov
Cj4gPiAtc3RhdGljIGludCByZWFkX3Byb3BlcnRpZXNfdW5sb2NrZWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBpbnQgcmVhZF9wcm9wZXJ0aWVzX3VubG9j
a2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgIHU2NCBfX3Vz
ZXIgKnVwcm9wcywKPiA+ICAgCQkJCSAgICB1MzIgbl9wcm9wcywKPiA+ICAgCQkJCSAgICBzdHJ1
Y3QgcGVyZl9vcGVuX3Byb3BlcnRpZXMgKnByb3BzKQo+ID4gQEAgLTI3NTUsNyArMjc1NSw3IEBA
IHN0YXRpYyBpbnQgcmVhZF9wcm9wZXJ0aWVzX3VubG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICAgCQkJCQkgIHZhbHVlKTsKPiA+ICAgCQkJCXJldHVybiAtRUlO
VkFMOwo+ID4gICAJCQl9Cj4gPiAtCQkJaWYgKCFkZXZfcHJpdi0+cGVyZi5vYS5vYV9mb3JtYXRz
W3ZhbHVlXS5zaXplKSB7Cj4gPiArCQkJaWYgKCFpOTE1LT5wZXJmLm9hLm9hX2Zvcm1hdHNbdmFs
dWVdLnNpemUpIHsKPiA+ICAgCQkJCURSTV9ERUJVRygiVW5zdXBwb3J0ZWQgT0EgcmVwb3J0IGZv
cm1hdCAlbGx1XG4iLAo+ID4gICAJCQkJCSAgdmFsdWUpOwo+ID4gICAJCQkJcmV0dXJuIC1FSU5W
QUw7Cj4gPiBAQCAtMjc3Niw3ICsyNzc2LDcgQEAgc3RhdGljIGludCByZWFkX3Byb3BlcnRpZXNf
dW5sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCQkgKi8K
PiA+ICAgCQkJQlVJTERfQlVHX09OKHNpemVvZihvYV9wZXJpb2QpICE9IDgpOwo+ID4gLQkJCW9h
X3BlcmlvZCA9IG9hX2V4cG9uZW50X3RvX25zKGRldl9wcml2LCB2YWx1ZSk7Cj4gPiArCQkJb2Ff
cGVyaW9kID0gb2FfZXhwb25lbnRfdG9fbnMoaTkxNSwgdmFsdWUpOwo+ID4gICAJCQkvKiBUaGlz
IGNoZWNrIGlzIHByaW1hcmlseSB0byBlbnN1cmUgdGhhdCBvYV9wZXJpb2QgPD0KPiA+ICAgCQkJ
ICogVUlOVDMyX01BWCAoYmVmb3JlIHBhc3NpbmcgdG8gZG9fZGl2IHdoaWNoIG9ubHkKPiA+IEBA
IC0yODM5LDEzICsyODM5LDEzIEBAIHN0YXRpYyBpbnQgcmVhZF9wcm9wZXJ0aWVzX3VubG9ja2Vk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgaW50IGk5MTVfcGVyZl9v
cGVuX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAgIAkJCSBz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZGV2LT5kZXZfcHJpdmF0ZTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBkZXYtPmRldl9wcml2YXRlOwo+ID4gICAJc3RydWN0IGRybV9pOTE1X3Bl
cmZfb3Blbl9wYXJhbSAqcGFyYW0gPSBkYXRhOwo+ID4gICAJc3RydWN0IHBlcmZfb3Blbl9wcm9w
ZXJ0aWVzIHByb3BzOwo+ID4gICAJdTMyIGtub3duX29wZW5fZmxhZ3M7Cj4gPiAgIAlpbnQgcmV0
Owo+ID4gLQlpZiAoIWRldl9wcml2LT5wZXJmLmluaXRpYWxpemVkKSB7Cj4gPiArCWlmICghaTkx
NS0+cGVyZi5pbml0aWFsaXplZCkgewo+ID4gICAJCURSTV9ERUJVRygiaTkxNSBwZXJmIGludGVy
ZmFjZSBub3QgYXZhaWxhYmxlIGZvciB0aGlzIHN5c3RlbVxuIik7Cj4gPiAgIAkJcmV0dXJuIC1F
Tk9UU1VQUDsKPiA+ICAgCX0KPiA+IEBAIC0yODU4LDEyNCArMjg1OCwxMjQgQEAgaW50IGk5MTVf
cGVyZl9vcGVuX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAg
IAkJcmV0dXJuIC1FSU5WQUw7Cj4gPiAgIAl9Cj4gPiAtCXJldCA9IHJlYWRfcHJvcGVydGllc191
bmxvY2tlZChkZXZfcHJpdiwKPiA+ICsJcmV0ID0gcmVhZF9wcm9wZXJ0aWVzX3VubG9ja2VkKGk5
MTUsCj4gPiAgIAkJCQkgICAgICAgdTY0X3RvX3VzZXJfcHRyKHBhcmFtLT5wcm9wZXJ0aWVzX3B0
ciksCj4gPiAgIAkJCQkgICAgICAgcGFyYW0tPm51bV9wcm9wZXJ0aWVzLAo+ID4gICAJCQkJICAg
ICAgICZwcm9wcyk7Cj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiAtCW11
dGV4X2xvY2soJmRldl9wcml2LT5wZXJmLmxvY2spOwo+ID4gLQlyZXQgPSBpOTE1X3BlcmZfb3Bl
bl9pb2N0bF9sb2NrZWQoZGV2X3ByaXYsIHBhcmFtLCAmcHJvcHMsIGZpbGUpOwo+ID4gLQltdXRl
eF91bmxvY2soJmRldl9wcml2LT5wZXJmLmxvY2spOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5w
ZXJmLmxvY2spOwo+ID4gKwlyZXQgPSBpOTE1X3BlcmZfb3Blbl9pb2N0bF9sb2NrZWQoaTkxNSwg
cGFyYW0sICZwcm9wcywgZmlsZSk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+cGVyZi5sb2Nr
KTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGk5MTVfcGVy
Zl9yZWdpc3RlciAtIGV4cG9zZXMgaTkxNS1wZXJmIHRvIHVzZXJzcGFjZQo+ID4gLSAqIEBkZXZf
cHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5z
dGFuY2UKPiA+ICAgICoKPiA+ICAgICogSW4gcGFydGljdWxhciBPQSBtZXRyaWMgc2V0cyBhcmUg
YWR2ZXJ0aXNlZCB1bmRlciBhIHN5c2ZzIG1ldHJpY3MvCj4gPiAgICAqIGRpcmVjdG9yeSBhbGxv
d2luZyB1c2Vyc3BhY2UgdG8gZW51bWVyYXRlIHZhbGlkIElEcyB0aGF0IGNhbiBiZQo+ID4gICAg
KiB1c2VkIHRvIG9wZW4gYW4gaTkxNS1wZXJmIHN0cmVhbS4KPiA+ICAgICovCj4gPiAtdm9pZCBp
OTE1X3BlcmZfcmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K3ZvaWQgaTkxNV9wZXJmX3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gLQlpZiAoIWRldl9wcml2LT5wZXJmLmluaXRpYWxp
emVkKQo+ID4gKwlpZiAoIWk5MTUtPnBlcmYuaW5pdGlhbGl6ZWQpCj4gPiAgIAkJcmV0dXJuOwo+
ID4gICAJLyogVG8gYmUgc3VyZSB3ZSdyZSBzeW5jaHJvbml6ZWQgd2l0aCBhbiBhdHRlbXB0ZWQK
PiA+ICAgCSAqIGk5MTVfcGVyZl9vcGVuX2lvY3RsKCk7IGNvbnNpZGVyaW5nIHRoYXQgd2UgcmVn
aXN0ZXIgYWZ0ZXIKPiA+ICAgCSAqIGJlaW5nIGV4cG9zZWQgdG8gdXNlcnNwYWNlLgo+ID4gICAJ
ICovCj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5wZXJmLmxvY2spOwo+ID4gKwltdXRleF9s
b2NrKCZpOTE1LT5wZXJmLmxvY2spOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2tvYmog
PQo+ID4gKwlpOTE1LT5wZXJmLm1ldHJpY3Nfa29iaiA9Cj4gPiAgIAkJa29iamVjdF9jcmVhdGVf
YW5kX2FkZCgibWV0cmljcyIsCj4gPiAtCQkJCSAgICAgICAmZGV2X3ByaXYtPmRybS5wcmltYXJ5
LT5rZGV2LT5rb2JqKTsKPiA+IC0JaWYgKCFkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2tvYmopCj4g
PiArCQkJCSAgICAgICAmaTkxNS0+ZHJtLnByaW1hcnktPmtkZXYtPmtvYmopOwo+ID4gKwlpZiAo
IWk5MTUtPnBlcmYubWV0cmljc19rb2JqKQo+ID4gICAJCWdvdG8gZXhpdDsKPiA+IC0Jc3lzZnNf
YXR0cl9pbml0KCZkZXZfcHJpdi0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWNfaWQu
YXR0cik7Cj4gPiAtCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiAt
CQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19pY2woZGV2X3ByaXYpOwo+ID4gLQl9IGVsc2Ug
aWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKSB7Cj4gPiAtCQlpOTE1X3BlcmZfbG9hZF90ZXN0
X2NvbmZpZ19jbmwoZGV2X3ByaXYpOwo+ID4gLQl9IGVsc2UgaWYgKElTX0NPRkZFRUxBS0UoZGV2
X3ByaXYpKSB7Cj4gPiAtCQlpZiAoSVNfQ0ZMX0dUMihkZXZfcHJpdikpCj4gPiAtCQkJaTkxNV9w
ZXJmX2xvYWRfdGVzdF9jb25maWdfY2ZsZ3QyKGRldl9wcml2KTsKPiA+IC0JCWlmIChJU19DRkxf
R1QzKGRldl9wcml2KSkKPiA+IC0JCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jZmxndDMo
ZGV2X3ByaXYpOwo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4g
PiAtCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19nbGsoZGV2X3ByaXYpOwo+ID4gLQl9IGVs
c2UgaWYgKElTX0tBQllMQUtFKGRldl9wcml2KSkgewo+ID4gLQkJaWYgKElTX0tCTF9HVDIoZGV2
X3ByaXYpKQo+ID4gLQkJCWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2tibGd0MihkZXZfcHJp
dik7Cj4gPiAtCQllbHNlIGlmIChJU19LQkxfR1QzKGRldl9wcml2KSkKPiA+IC0JCQlpOTE1X3Bl
cmZfbG9hZF90ZXN0X2NvbmZpZ19rYmxndDMoZGV2X3ByaXYpOwo+ID4gLQl9IGVsc2UgaWYgKElT
X0JST1hUT04oZGV2X3ByaXYpKSB7Cj4gPiAtCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19i
eHQoZGV2X3ByaXYpOwo+ID4gLQl9IGVsc2UgaWYgKElTX1NLWUxBS0UoZGV2X3ByaXYpKSB7Cj4g
PiAtCQlpZiAoSVNfU0tMX0dUMihkZXZfcHJpdikpCj4gPiAtCQkJaTkxNV9wZXJmX2xvYWRfdGVz
dF9jb25maWdfc2tsZ3QyKGRldl9wcml2KTsKPiA+IC0JCWVsc2UgaWYgKElTX1NLTF9HVDMoZGV2
X3ByaXYpKQo+ID4gLQkJCWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX3NrbGd0MyhkZXZfcHJp
dik7Cj4gPiAtCQllbHNlIGlmIChJU19TS0xfR1Q0KGRldl9wcml2KSkKPiA+IC0JCQlpOTE1X3Bl
cmZfbG9hZF90ZXN0X2NvbmZpZ19za2xndDQoZGV2X3ByaXYpOwo+ID4gLQl9IGVsc2UgaWYgKElT
X0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiAtCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZp
Z19jaHYoZGV2X3ByaXYpOwo+ID4gLQl9IGVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikp
IHsKPiA+IC0JCWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2JkdyhkZXZfcHJpdik7Cj4gPiAt
CX0gZWxzZSBpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikpIHsKPiA+IC0JCWk5MTVfcGVyZl9sb2Fk
X3Rlc3RfY29uZmlnX2hzdyhkZXZfcHJpdik7Cj4gPiAtfQo+ID4gLQo+ID4gLQlpZiAoZGV2X3By
aXYtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPT0gMCkKPiA+ICsJc3lzZnNfYXR0cl9pbml0KCZp
OTE1LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpY19pZC5hdHRyKTsKPiA+ICsKPiA+
ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgewo+ID4gKwkJaTkxNV9wZXJmX2xvYWRfdGVz
dF9jb25maWdfaWNsKGk5MTUpOwo+ID4gKwl9IGVsc2UgaWYgKElTX0NBTk5PTkxBS0UoaTkxNSkp
IHsKPiA+ICsJCWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmlnX2NubChpOTE1KTsKPiA+ICsJfSBl
bHNlIGlmIChJU19DT0ZGRUVMQUtFKGk5MTUpKSB7Cj4gPiArCQlpZiAoSVNfQ0ZMX0dUMihpOTE1
KSkKPiA+ICsJCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jZmxndDIoaTkxNSk7Cj4gPiAr
CQlpZiAoSVNfQ0ZMX0dUMyhpOTE1KSkKPiA+ICsJCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZp
Z19jZmxndDMoaTkxNSk7Cj4gPiArCX0gZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkgewo+
ID4gKwkJaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfZ2xrKGk5MTUpOwo+ID4gKwl9IGVsc2Ug
aWYgKElTX0tBQllMQUtFKGk5MTUpKSB7Cj4gPiArCQlpZiAoSVNfS0JMX0dUMihpOTE1KSkKPiA+
ICsJCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19rYmxndDIoaTkxNSk7Cj4gPiArCQllbHNl
IGlmIChJU19LQkxfR1QzKGk5MTUpKQo+ID4gKwkJCWk5MTVfcGVyZl9sb2FkX3Rlc3RfY29uZmln
X2tibGd0MyhpOTE1KTsKPiA+ICsJfSBlbHNlIGlmIChJU19CUk9YVE9OKGk5MTUpKSB7Cj4gPiAr
CQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19ieHQoaTkxNSk7Cj4gPiArCX0gZWxzZSBpZiAo
SVNfU0tZTEFLRShpOTE1KSkgewo+ID4gKwkJaWYgKElTX1NLTF9HVDIoaTkxNSkpCj4gPiArCQkJ
aTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfc2tsZ3QyKGk5MTUpOwo+ID4gKwkJZWxzZSBpZiAo
SVNfU0tMX0dUMyhpOTE1KSkKPiA+ICsJCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19za2xn
dDMoaTkxNSk7Cj4gPiArCQllbHNlIGlmIChJU19TS0xfR1Q0KGk5MTUpKQo+ID4gKwkJCWk5MTVf
cGVyZl9sb2FkX3Rlc3RfY29uZmlnX3NrbGd0NChpOTE1KTsKPiA+ICsJfSBlbHNlIGlmIChJU19D
SEVSUllWSUVXKGk5MTUpKSB7Cj4gPiArCQlpOTE1X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19jaHYo
aTkxNSk7Cj4gPiArCX0gZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gPiArCQlpOTE1
X3BlcmZfbG9hZF90ZXN0X2NvbmZpZ19iZHcoaTkxNSk7Cj4gPiArCX0gZWxzZSBpZiAoSVNfSEFT
V0VMTChpOTE1KSkgewo+ID4gKwkJaTkxNV9wZXJmX2xvYWRfdGVzdF9jb25maWdfaHN3KGk5MTUp
Owo+ID4gK30KPiA+ICsKPiA+ICsJaWYgKGk5MTUtPnBlcmYub2EudGVzdF9jb25maWcuaWQgPT0g
MCkKPiA+ICAgCQlnb3RvIHN5c2ZzX2Vycm9yOwo+ID4gLQlyZXQgPSBzeXNmc19jcmVhdGVfZ3Jv
dXAoZGV2X3ByaXYtPnBlcmYubWV0cmljc19rb2JqLAo+ID4gLQkJCQkgJmRldl9wcml2LT5wZXJm
Lm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYyk7Cj4gPiArCXJldCA9IHN5c2ZzX2NyZWF0ZV9n
cm91cChpOTE1LT5wZXJmLm1ldHJpY3Nfa29iaiwKPiA+ICsJCQkJICZpOTE1LT5wZXJmLm9hLnRl
c3RfY29uZmlnLnN5c2ZzX21ldHJpYyk7Cj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCWdvdG8gc3lz
ZnNfZXJyb3I7Cj4gPiAtCWF0b21pY19zZXQoJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmln
LnJlZl9jb3VudCwgMSk7Cj4gPiArCWF0b21pY19zZXQoJmk5MTUtPnBlcmYub2EudGVzdF9jb25m
aWcucmVmX2NvdW50LCAxKTsKPiA+ICAgCWdvdG8gZXhpdDsKPiA+ICAgc3lzZnNfZXJyb3I6Cj4g
PiAtCWtvYmplY3RfcHV0KGRldl9wcml2LT5wZXJmLm1ldHJpY3Nfa29iaik7Cj4gPiAtCWRldl9w
cml2LT5wZXJmLm1ldHJpY3Nfa29iaiA9IE5VTEw7Cj4gPiArCWtvYmplY3RfcHV0KGk5MTUtPnBl
cmYubWV0cmljc19rb2JqKTsKPiA+ICsJaTkxNS0+cGVyZi5tZXRyaWNzX2tvYmogPSBOVUxMOwo+
ID4gICBleGl0Ogo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wZXJmLmxvY2spOwo+ID4g
KwltdXRleF91bmxvY2soJmk5MTUtPnBlcmYubG9jayk7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAg
ICAqIGk5MTVfcGVyZl91bnJlZ2lzdGVyIC0gaGlkZSBpOTE1LXBlcmYgZnJvbSB1c2Vyc3BhY2UK
PiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5
MTUgZGV2aWNlIGluc3RhbmNlCj4gPiAgICAqCj4gPiAgICAqIGk5MTUtcGVyZiBzdGF0ZSBjbGVh
bnVwIGlzIHNwbGl0IHVwIGludG8gYW4gJ3VucmVnaXN0ZXInIGFuZAo+ID4gICAgKiAnZGVpbml0
JyBwaGFzZSB3aGVyZSB0aGUgaW50ZXJmYWNlIGlzIGZpcnN0IGhpZGRlbiBmcm9tCj4gPiAgICAq
IHVzZXJzcGFjZSBieSBpOTE1X3BlcmZfdW5yZWdpc3RlcigpIGJlZm9yZSBjbGVhbmluZyB1cAo+
ID4gICAgKiByZW1haW5pbmcgc3RhdGUgaW4gaTkxNV9wZXJmX2ZpbmkoKS4KPiA+ICAgICovCj4g
PiAtdm9pZCBpOTE1X3BlcmZfdW5yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiArdm9pZCBpOTE1X3BlcmZfdW5yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoIWRldl9wcml2LT5wZXJmLm1ldHJpY3Nfa29i
aikKPiA+ICsJaWYgKCFpOTE1LT5wZXJmLm1ldHJpY3Nfa29iaikKPiA+ICAgCQlyZXR1cm47Cj4g
PiAtCXN5c2ZzX3JlbW92ZV9ncm91cChkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2tvYmosCj4gPiAt
CQkJICAgJmRldl9wcml2LT5wZXJmLm9hLnRlc3RfY29uZmlnLnN5c2ZzX21ldHJpYyk7Cj4gPiAr
CXN5c2ZzX3JlbW92ZV9ncm91cChpOTE1LT5wZXJmLm1ldHJpY3Nfa29iaiwKPiA+ICsJCQkgICAm
aTkxNS0+cGVyZi5vYS50ZXN0X2NvbmZpZy5zeXNmc19tZXRyaWMpOwo+ID4gLQlrb2JqZWN0X3B1
dChkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2tvYmopOwo+ID4gLQlkZXZfcHJpdi0+cGVyZi5tZXRy
aWNzX2tvYmogPSBOVUxMOwo+ID4gKwlrb2JqZWN0X3B1dChpOTE1LT5wZXJmLm1ldHJpY3Nfa29i
aik7Cj4gPiArCWk5MTUtPnBlcmYubWV0cmljc19rb2JqID0gTlVMTDsKPiA+ICAgfQo+ID4gLXN0
YXRpYyBib29sIGdlbjhfaXNfdmFsaWRfZmxleF9hZGRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwgdTMyIGFkZHIpCj4gPiArc3RhdGljIGJvb2wgZ2VuOF9pc192YWxpZF9mbGV4
X2FkZHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBhZGRyKQo+ID4gICB7Cj4g
PiAgIAlzdGF0aWMgY29uc3QgaTkxNV9yZWdfdCBmbGV4X2V1X3JlZ3NbXSA9IHsKPiA+ICAgCQlF
VV9QRVJGX0NOVEwwLAo+ID4gQEAgLTI5OTUsNyArMjk5NSw3IEBAIHN0YXRpYyBib29sIGdlbjhf
aXNfdmFsaWRfZmxleF9hZGRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMy
IGFkZHIpCj4gPiAgIAlyZXR1cm4gZmFsc2U7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBnZW43
X2lzX3ZhbGlkX2JfY291bnRlcl9hZGRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgdTMyIGFkZHIpCj4gPiArc3RhdGljIGJvb2wgZ2VuN19pc192YWxpZF9iX2NvdW50ZXJfYWRk
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGFkZHIpCj4gPiAgIHsKPiA+ICAg
CXJldHVybiAoYWRkciA+PSBpOTE1X21taW9fcmVnX29mZnNldChPQVNUQVJUVFJJRzEpICYmCj4g
PiAgIAkJYWRkciA8PSBpOTE1X21taW9fcmVnX29mZnNldChPQVNUQVJUVFJJRzgpKSB8fAo+ID4g
QEAgLTMwMDUsNyArMzAwNSw3IEBAIHN0YXRpYyBib29sIGdlbjdfaXNfdmFsaWRfYl9jb3VudGVy
X2FkZHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIKPiA+ICAgCQkgYWRk
ciA8PSBpOTE1X21taW9fcmVnX29mZnNldChPQUNFQzdfMSkpOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IGJvb2wgZ2VuN19pc192YWxpZF9tdXhfYWRkcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIHUzMiBhZGRyKQo+ID4gK3N0YXRpYyBib29sIGdlbjdfaXNfdmFsaWRfbXV4X2FkZHIo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBhZGRyKQo+ID4gICB7Cj4gPiAgIAly
ZXR1cm4gYWRkciA9PSBpOTE1X21taW9fcmVnX29mZnNldChIQUxGX1NMSUNFX0NISUNLRU4yKSB8
fAo+ID4gICAJCShhZGRyID49IGk5MTVfbW1pb19yZWdfb2Zmc2V0KE1JQ1JPX0JQMF8wKSAmJgo+
ID4gQEAgLTMwMTYsMzQgKzMwMTYsMzQgQEAgc3RhdGljIGJvb2wgZ2VuN19pc192YWxpZF9tdXhf
YWRkcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBhZGRyKQo+ID4gICAJ
CSBhZGRyIDw9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KE9BX1BFUkZNQVRSSVhfSEkpKTsKPiA+ICAg
fQo+ID4gLXN0YXRpYyBib29sIGdlbjhfaXNfdmFsaWRfbXV4X2FkZHIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgYWRkcikKPiA+ICtzdGF0aWMgYm9vbCBnZW44X2lzX3Zh
bGlkX211eF9hZGRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgYWRkcikKPiA+
ICAgewo+ID4gLQlyZXR1cm4gZ2VuN19pc192YWxpZF9tdXhfYWRkcihkZXZfcHJpdiwgYWRkcikg
fHwKPiA+ICsJcmV0dXJuIGdlbjdfaXNfdmFsaWRfbXV4X2FkZHIoaTkxNSwgYWRkcikgfHwKPiA+
ICAgCQlhZGRyID09IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFdBSVRfRk9SX1JDNl9FWElUKSB8fAo+
ID4gICAJCShhZGRyID49IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJQTV9DT05GSUcwKSAmJgo+ID4g
ICAJCSBhZGRyIDw9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KE5PQV9DT05GSUcoOCkpKTsKPiA+ICAg
fQo+ID4gLXN0YXRpYyBib29sIGdlbjEwX2lzX3ZhbGlkX211eF9hZGRyKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGFkZHIpCj4gPiArc3RhdGljIGJvb2wgZ2VuMTBfaXNf
dmFsaWRfbXV4X2FkZHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBhZGRyKQo+
ID4gICB7Cj4gPiAtCXJldHVybiBnZW44X2lzX3ZhbGlkX211eF9hZGRyKGRldl9wcml2LCBhZGRy
KSB8fAo+ID4gKwlyZXR1cm4gZ2VuOF9pc192YWxpZF9tdXhfYWRkcihpOTE1LCBhZGRyKSB8fAo+
ID4gICAJCWFkZHIgPT0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOMTBfTk9BX1dSSVRFX0hJR0gp
IHx8Cj4gPiAgIAkJKGFkZHIgPj0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoT0FfUEVSRkNOVDNfTE8p
ICYmCj4gPiAgIAkJIGFkZHIgPD0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoT0FfUEVSRkNOVDRfSEkp
KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIGhzd19pc192YWxpZF9tdXhfYWRkcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBhZGRyKQo+ID4gK3N0YXRpYyBib29sIGhz
d19pc192YWxpZF9tdXhfYWRkcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGFk
ZHIpCj4gPiAgIHsKPiA+IC0JcmV0dXJuIGdlbjdfaXNfdmFsaWRfbXV4X2FkZHIoZGV2X3ByaXYs
IGFkZHIpIHx8Cj4gPiArCXJldHVybiBnZW43X2lzX3ZhbGlkX211eF9hZGRyKGk5MTUsIGFkZHIp
IHx8Cj4gPiAgIAkJKGFkZHIgPj0gMHgyNTEwMCAmJiBhZGRyIDw9IDB4MkZGOTApIHx8Cj4gPiAg
IAkJKGFkZHIgPj0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoSFNXX01CVklEMl9OT0EwKSAmJgo+ID4g
ICAJCSBhZGRyIDw9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEhTV19NQlZJRDJfTk9BOSkpIHx8Cj4g
PiAgIAkJYWRkciA9PSBpOTE1X21taW9fcmVnX29mZnNldChIU1dfTUJWSUQyX01JU1IwKTsKPiA+
ICAgfQo+ID4gLXN0YXRpYyBib29sIGNodl9pc192YWxpZF9tdXhfYWRkcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBhZGRyKQo+ID4gK3N0YXRpYyBib29sIGNodl9pc192
YWxpZF9tdXhfYWRkcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGFkZHIpCj4g
PiAgIHsKPiA+IC0JcmV0dXJuIGdlbjdfaXNfdmFsaWRfbXV4X2FkZHIoZGV2X3ByaXYsIGFkZHIp
IHx8Cj4gPiArCXJldHVybiBnZW43X2lzX3ZhbGlkX211eF9hZGRyKGk5MTUsIGFkZHIpIHx8Cj4g
PiAgIAkJKGFkZHIgPj0gMHgxODIzMDAgJiYgYWRkciA8PSAweDE4MjNBNCk7Cj4gPiAgIH0KPiA+
IEBAIC0zMDY2LDggKzMwNjYsOCBAQCBzdGF0aWMgdTMyIG1hc2tfcmVnX3ZhbHVlKHUzMiByZWcs
IHUzMiB2YWwpCj4gPiAgIAlyZXR1cm4gdmFsOwo+ID4gICB9Cj4gPiAtc3RhdGljIHN0cnVjdCBp
OTE1X29hX3JlZyAqYWxsb2Nfb2FfcmVncyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAtCQkJCQkgYm9vbCAoKmlzX3ZhbGlkKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIHUzMiBhZGRyKSwKPiA+ICtzdGF0aWMgc3RydWN0IGk5MTVfb2FfcmVnICphbGxv
Y19vYV9yZWdzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gKwkJCQkJIGJvb2wg
KCppc192YWxpZCkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBhZGRyKSwKPiA+
ICAgCQkJCQkgdTMyIF9fdXNlciAqcmVncywKPiA+ICAgCQkJCQkgdTMyIG5fcmVncykKPiA+ICAg
ewo+ID4gQEAgLTMwOTcsNyArMzA5Nyw3IEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV9vYV9yZWcgKmFs
bG9jX29hX3JlZ3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCWlm
IChlcnIpCj4gPiAgIAkJCWdvdG8gYWRkcl9lcnI7Cj4gPiAtCQlpZiAoIWlzX3ZhbGlkKGRldl9w
cml2LCBhZGRyKSkgewo+ID4gKwkJaWYgKCFpc192YWxpZChpOTE1LCBhZGRyKSkgewo+ID4gICAJ
CQlEUk1fREVCVUcoIkludmFsaWQgb2FfcmVnIGFkZHJlc3M6ICVYXG4iLCBhZGRyKTsKPiA+ICAg
CQkJZXJyID0gLUVJTlZBTDsKPiA+ICAgCQkJZ290byBhZGRyX2VycjsKPiA+IEBAIC0zMTMwLDcg
KzMxMzAsNyBAQCBzdGF0aWMgc3NpemVfdCBzaG93X2R5bmFtaWNfaWQoc3RydWN0IGRldmljZSAq
ZGV2LAo+ID4gICAJcmV0dXJuIHNwcmludGYoYnVmLCAiJWRcbiIsIG9hX2NvbmZpZy0+aWQpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIGludCBjcmVhdGVfZHluYW1pY19vYV9zeXNmc19lbnRyeShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGludCBjcmVhdGVfZHlu
YW1pY19vYV9zeXNmc19lbnRyeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJCQkgc3RydWN0IGk5MTVfb2FfY29uZmlnICpvYV9jb25maWcpCj4gPiAgIHsKPiA+ICAgCXN5
c2ZzX2F0dHJfaW5pdCgmb2FfY29uZmlnLT5zeXNmc19tZXRyaWNfaWQuYXR0cik7Cj4gPiBAQCAt
MzE0NSw3ICszMTQ1LDcgQEAgc3RhdGljIGludCBjcmVhdGVfZHluYW1pY19vYV9zeXNmc19lbnRy
eShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlvYV9jb25maWctPnN5
c2ZzX21ldHJpYy5uYW1lID0gb2FfY29uZmlnLT51dWlkOwo+ID4gICAJb2FfY29uZmlnLT5zeXNm
c19tZXRyaWMuYXR0cnMgPSBvYV9jb25maWctPmF0dHJzOwo+ID4gLQlyZXR1cm4gc3lzZnNfY3Jl
YXRlX2dyb3VwKGRldl9wcml2LT5wZXJmLm1ldHJpY3Nfa29iaiwKPiA+ICsJcmV0dXJuIHN5c2Zz
X2NyZWF0ZV9ncm91cChpOTE1LT5wZXJmLm1ldHJpY3Nfa29iaiwKPiA+ICAgCQkJCSAgJm9hX2Nv
bmZpZy0+c3lzZnNfbWV0cmljKTsKPiA+ICAgfQo+ID4gQEAgLTMxNjUsMTcgKzMxNjUsMTcgQEAg
c3RhdGljIGludCBjcmVhdGVfZHluYW1pY19vYV9zeXNmc19lbnRyeShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIGludCBpOTE1X3BlcmZfYWRkX2NvbmZpZ19pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ID4gICAJCQkgICAgICAgc3RydWN0
IGRybV9maWxlICpmaWxlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGRldi0+ZGV2X3ByaXZhdGU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gZGV2LT5kZXZfcHJpdmF0ZTsKPiA+ICAgCXN0cnVjdCBkcm1faTkxNV9wZXJmX29h
X2NvbmZpZyAqYXJncyA9IGRhdGE7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9hX2Nv
bmZpZywgKnRtcDsKPiA+ICAgCWludCBlcnIsIGlkOwo+ID4gLQlpZiAoIWRldl9wcml2LT5wZXJm
LmluaXRpYWxpemVkKSB7Cj4gPiArCWlmICghaTkxNS0+cGVyZi5pbml0aWFsaXplZCkgewo+ID4g
ICAJCURSTV9ERUJVRygiaTkxNSBwZXJmIGludGVyZmFjZSBub3QgYXZhaWxhYmxlIGZvciB0aGlz
IHN5c3RlbVxuIik7Cj4gPiAgIAkJcmV0dXJuIC1FTk9UU1VQUDsKPiA+ICAgCX0KPiA+IC0JaWYg
KCFkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2tvYmopIHsKPiA+ICsJaWYgKCFpOTE1LT5wZXJmLm1l
dHJpY3Nfa29iaikgewo+ID4gICAJCURSTV9ERUJVRygiT0EgbWV0cmljcyB3ZXJlbid0IGFkdmVy
dGlzZWQgdmlhIHN5c2ZzXG4iKTsKPiA+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICAgCX0KPiA+
IEBAIC0zMjEzLDggKzMyMTMsOCBAQCBpbnQgaTkxNV9wZXJmX2FkZF9jb25maWdfaW9jdGwoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiA+ICAgCW9hX2NvbmZpZy0+bXV4X3Jl
Z3NfbGVuID0gYXJncy0+bl9tdXhfcmVnczsKPiA+ICAgCW9hX2NvbmZpZy0+bXV4X3JlZ3MgPQo+
ID4gLQkJYWxsb2Nfb2FfcmVncyhkZXZfcHJpdiwKPiA+IC0JCQkgICAgICBkZXZfcHJpdi0+cGVy
Zi5vYS5vcHMuaXNfdmFsaWRfbXV4X3JlZywKPiA+ICsJCWFsbG9jX29hX3JlZ3MoaTkxNSwKPiA+
ICsJCQkgICAgICBpOTE1LT5wZXJmLm9hLm9wcy5pc192YWxpZF9tdXhfcmVnLAo+ID4gICAJCQkg
ICAgICB1NjRfdG9fdXNlcl9wdHIoYXJncy0+bXV4X3JlZ3NfcHRyKSwKPiA+ICAgCQkJICAgICAg
YXJncy0+bl9tdXhfcmVncyk7Cj4gPiBAQCAtMzIyNiw4ICszMjI2LDggQEAgaW50IGk5MTVfcGVy
Zl9hZGRfY29uZmlnX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4g
PiAgIAlvYV9jb25maWctPmJfY291bnRlcl9yZWdzX2xlbiA9IGFyZ3MtPm5fYm9vbGVhbl9yZWdz
Owo+ID4gICAJb2FfY29uZmlnLT5iX2NvdW50ZXJfcmVncyA9Cj4gPiAtCQlhbGxvY19vYV9yZWdz
KGRldl9wcml2LAo+ID4gLQkJCSAgICAgIGRldl9wcml2LT5wZXJmLm9hLm9wcy5pc192YWxpZF9i
X2NvdW50ZXJfcmVnLAo+ID4gKwkJYWxsb2Nfb2FfcmVncyhpOTE1LAo+ID4gKwkJCSAgICAgIGk5
MTUtPnBlcmYub2Eub3BzLmlzX3ZhbGlkX2JfY291bnRlcl9yZWcsCj4gPiAgIAkJCSAgICAgIHU2
NF90b191c2VyX3B0cihhcmdzLT5ib29sZWFuX3JlZ3NfcHRyKSwKPiA+ICAgCQkJICAgICAgYXJn
cy0+bl9ib29sZWFuX3JlZ3MpOwo+ID4gQEAgLTMyMzcsNyArMzIzNyw3IEBAIGludCBpOTE1X3Bl
cmZfYWRkX2NvbmZpZ19pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+
ID4gICAJCWdvdG8gcmVnX2VycjsKPiA+ICAgCX0KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPCA4KSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA4KSB7Cj4gPiAgIAkJaWYgKGFy
Z3MtPm5fZmxleF9yZWdzICE9IDApIHsKPiA+ICAgCQkJZXJyID0gLUVJTlZBTDsKPiA+ICAgCQkJ
Z290byByZWdfZXJyOwo+ID4gQEAgLTMyNDUsOCArMzI0NSw4IEBAIGludCBpOTE1X3BlcmZfYWRk
X2NvbmZpZ19pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ID4gICAJ
fSBlbHNlIHsKPiA+ICAgCQlvYV9jb25maWctPmZsZXhfcmVnc19sZW4gPSBhcmdzLT5uX2ZsZXhf
cmVnczsKPiA+ICAgCQlvYV9jb25maWctPmZsZXhfcmVncyA9Cj4gPiAtCQkJYWxsb2Nfb2FfcmVn
cyhkZXZfcHJpdiwKPiA+IC0JCQkJICAgICAgZGV2X3ByaXYtPnBlcmYub2Eub3BzLmlzX3ZhbGlk
X2ZsZXhfcmVnLAo+ID4gKwkJCWFsbG9jX29hX3JlZ3MoaTkxNSwKPiA+ICsJCQkJICAgICAgaTkx
NS0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfZmxleF9yZWcsCj4gPiAgIAkJCQkgICAgICB1NjRfdG9f
dXNlcl9wdHIoYXJncy0+ZmxleF9yZWdzX3B0ciksCj4gPiAgIAkJCQkgICAgICBhcmdzLT5uX2Zs
ZXhfcmVncyk7Cj4gPiBAQCAtMzI1NywxNCArMzI1NywxNCBAQCBpbnQgaTkxNV9wZXJmX2FkZF9j
b25maWdfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiA+ICAgCQl9
Cj4gPiAgIAl9Cj4gPiAtCWVyciA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZGV2X3ByaXYt
PnBlcmYubWV0cmljc19sb2NrKTsKPiA+ICsJZXJyID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxl
KCZpOTE1LT5wZXJmLm1ldHJpY3NfbG9jayk7Cj4gPiAgIAlpZiAoZXJyKQo+ID4gICAJCWdvdG8g
cmVnX2VycjsKPiA+ICAgCS8qIFdlIHNob3VsZG4ndCBoYXZlIHRvbyBtYW55IGNvbmZpZ3MsIHNv
IHRoaXMgaXRlcmF0aW9uIHNob3VsZG4ndCBiZQo+ID4gICAJICogdG9vIGNvc3RseS4KPiA+ICAg
CSAqLwo+ID4gLQlpZHJfZm9yX2VhY2hfZW50cnkoJmRldl9wcml2LT5wZXJmLm1ldHJpY3NfaWRy
LCB0bXAsIGlkKSB7Cj4gPiArCWlkcl9mb3JfZWFjaF9lbnRyeSgmaTkxNS0+cGVyZi5tZXRyaWNz
X2lkciwgdG1wLCBpZCkgewo+ID4gICAJCWlmICghc3RyY21wKHRtcC0+dXVpZCwgb2FfY29uZmln
LT51dWlkKSkgewo+ID4gICAJCQlEUk1fREVCVUcoIk9BIGNvbmZpZyBhbHJlYWR5IGV4aXN0cyB3
aXRoIHRoaXMgdXVpZFxuIik7Cj4gPiAgIAkJCWVyciA9IC1FQUREUklOVVNFOwo+ID4gQEAgLTMy
NzIsMTQgKzMyNzIsMTQgQEAgaW50IGk5MTVfcGVyZl9hZGRfY29uZmlnX2lvY3RsKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAgIAkJfQo+ID4gICAJfQo+ID4gLQllcnIg
PSBjcmVhdGVfZHluYW1pY19vYV9zeXNmc19lbnRyeShkZXZfcHJpdiwgb2FfY29uZmlnKTsKPiA+
ICsJZXJyID0gY3JlYXRlX2R5bmFtaWNfb2Ffc3lzZnNfZW50cnkoaTkxNSwgb2FfY29uZmlnKTsK
PiA+ICAgCWlmIChlcnIpIHsKPiA+ICAgCQlEUk1fREVCVUcoIkZhaWxlZCB0byBjcmVhdGUgc3lz
ZnMgZW50cnkgZm9yIE9BIGNvbmZpZ1xuIik7Cj4gPiAgIAkJZ290byBzeXNmc19lcnI7Cj4gPiAg
IAl9Cj4gPiAgIAkvKiBDb25maWcgaWQgMCBpcyBpbnZhbGlkLCBpZCAxIGZvciBrZXJuZWwgc3Rv
cmVkIHRlc3QgY29uZmlnLiAqLwo+ID4gLQlvYV9jb25maWctPmlkID0gaWRyX2FsbG9jKCZkZXZf
cHJpdi0+cGVyZi5tZXRyaWNzX2lkciwKPiA+ICsJb2FfY29uZmlnLT5pZCA9IGlkcl9hbGxvYygm
aTkxNS0+cGVyZi5tZXRyaWNzX2lkciwKPiA+ICAgCQkJCSAgb2FfY29uZmlnLCAyLAo+ID4gICAJ
CQkJICAwLCBHRlBfS0VSTkVMKTsKPiA+ICAgCWlmIChvYV9jb25maWctPmlkIDwgMCkgewo+ID4g
QEAgLTMyODgsMTYgKzMyODgsMTYgQEAgaW50IGk5MTVfcGVyZl9hZGRfY29uZmlnX2lvY3RsKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAgIAkJZ290byBzeXNmc19lcnI7
Cj4gPiAgIAl9Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBlcmYubWV0cmljc19sb2Nr
KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5wZXJmLm1ldHJpY3NfbG9jayk7Cj4gPiAgIAlE
Uk1fREVCVUcoIkFkZGVkIGNvbmZpZyAlcyBpZD0laVxuIiwgb2FfY29uZmlnLT51dWlkLCBvYV9j
b25maWctPmlkKTsKPiA+ICAgCXJldHVybiBvYV9jb25maWctPmlkOwo+ID4gICBzeXNmc19lcnI6
Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBlcmYubWV0cmljc19sb2NrKTsKPiA+ICsJ
bXV0ZXhfdW5sb2NrKCZpOTE1LT5wZXJmLm1ldHJpY3NfbG9jayk7Cj4gPiAgIHJlZ19lcnI6Cj4g
PiAtCXB1dF9vYV9jb25maWcoZGV2X3ByaXYsIG9hX2NvbmZpZyk7Cj4gPiArCXB1dF9vYV9jb25m
aWcoaTkxNSwgb2FfY29uZmlnKTsKPiA+ICAgCURSTV9ERUJVRygiRmFpbGVkIHRvIGFkZCBuZXcg
T0EgY29uZmlnXG4iKTsKPiA+ICAgCXJldHVybiBlcnI7Cj4gPiAgIH0KPiA+IEBAIC0zMzE2LDEy
ICszMzE2LDEyIEBAIGludCBpOTE1X3BlcmZfYWRkX2NvbmZpZ19pb2N0bChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ID4gICBpbnQgaTkxNV9wZXJmX3JlbW92ZV9jb25maWdf
aW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiA+ICAgCQkJCSAgc3Ry
dWN0IGRybV9maWxlICpmaWxlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGRldi0+ZGV2X3ByaXZhdGU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gZGV2LT5kZXZfcHJpdmF0ZTsKPiA+ICAgCXU2NCAqYXJnID0gZGF0YTsKPiA+
ICAgCXN0cnVjdCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmlnOwo+ID4gICAJaW50IHJldDsKPiA+
IC0JaWYgKCFkZXZfcHJpdi0+cGVyZi5pbml0aWFsaXplZCkgewo+ID4gKwlpZiAoIWk5MTUtPnBl
cmYuaW5pdGlhbGl6ZWQpIHsKPiA+ICAgCQlEUk1fREVCVUcoImk5MTUgcGVyZiBpbnRlcmZhY2Ug
bm90IGF2YWlsYWJsZSBmb3IgdGhpcyBzeXN0ZW1cbiIpOwo+ID4gICAJCXJldHVybiAtRU5PVFNV
UFA7Cj4gPiAgIAl9Cj4gPiBAQCAtMzMzMSwxMSArMzMzMSwxMSBAQCBpbnQgaTkxNV9wZXJmX3Jl
bW92ZV9jb25maWdfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiA+
ICAgCQlyZXR1cm4gLUVBQ0NFUzsKPiA+ICAgCX0KPiA+IC0JcmV0ID0gbXV0ZXhfbG9ja19pbnRl
cnJ1cHRpYmxlKCZkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2xvY2spOwo+ID4gKwlyZXQgPSBtdXRl
eF9sb2NrX2ludGVycnVwdGlibGUoJmk5MTUtPnBlcmYubWV0cmljc19sb2NrKTsKPiA+ICAgCWlm
IChyZXQpCj4gPiAgIAkJZ290byBsb2NrX2VycjsKPiA+IC0Jb2FfY29uZmlnID0gaWRyX2ZpbmQo
JmRldl9wcml2LT5wZXJmLm1ldHJpY3NfaWRyLCAqYXJnKTsKPiA+ICsJb2FfY29uZmlnID0gaWRy
X2ZpbmQoJmk5MTUtPnBlcmYubWV0cmljc19pZHIsICphcmcpOwo+ID4gICAJaWYgKCFvYV9jb25m
aWcpIHsKPiA+ICAgCQlEUk1fREVCVUcoIkZhaWxlZCB0byByZW1vdmUgdW5rbm93biBPQSBjb25m
aWdcbiIpOwo+ID4gICAJCXJldCA9IC1FTk9FTlQ7Cj4gPiBAQCAtMzM0NCwxNyArMzM0NCwxNyBA
QCBpbnQgaTkxNV9wZXJmX3JlbW92ZV9jb25maWdfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwgdm9pZCAqZGF0YSwKPiA+ICAgCUdFTV9CVUdfT04oKmFyZyAhPSBvYV9jb25maWctPmlkKTsK
PiA+IC0Jc3lzZnNfcmVtb3ZlX2dyb3VwKGRldl9wcml2LT5wZXJmLm1ldHJpY3Nfa29iaiwKPiA+
ICsJc3lzZnNfcmVtb3ZlX2dyb3VwKGk5MTUtPnBlcmYubWV0cmljc19rb2JqLAo+ID4gICAJCQkg
ICAmb2FfY29uZmlnLT5zeXNmc19tZXRyaWMpOwo+ID4gLQlpZHJfcmVtb3ZlKCZkZXZfcHJpdi0+
cGVyZi5tZXRyaWNzX2lkciwgKmFyZyk7Cj4gPiArCWlkcl9yZW1vdmUoJmk5MTUtPnBlcmYubWV0
cmljc19pZHIsICphcmcpOwo+ID4gICAJRFJNX0RFQlVHKCJSZW1vdmVkIGNvbmZpZyAlcyBpZD0l
aVxuIiwgb2FfY29uZmlnLT51dWlkLCBvYV9jb25maWctPmlkKTsKPiA+IC0JcHV0X29hX2NvbmZp
ZyhkZXZfcHJpdiwgb2FfY29uZmlnKTsKPiA+ICsJcHV0X29hX2NvbmZpZyhpOTE1LCBvYV9jb25m
aWcpOwo+ID4gICBjb25maWdfZXJyOgo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wZXJm
Lm1ldHJpY3NfbG9jayk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+cGVyZi5tZXRyaWNzX2xv
Y2spOwo+ID4gICBsb2NrX2VycjoKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IEBAIC0z
NDAzLDEzNSArMzQwMywxMzUgQEAgc3RhdGljIHN0cnVjdCBjdGxfdGFibGUgZGV2X3Jvb3RbXSA9
IHsKPiA+ICAgLyoqCj4gPiAgICAqIGk5MTVfcGVyZl9pbml0IC0gaW5pdGlhbGl6ZSBpOTE1LXBl
cmYgc3RhdGUgb24gbW9kdWxlIGxvYWQKPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGlu
c3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiAgICAqCj4gPiAg
ICAqIEluaXRpYWxpemVzIGk5MTUtcGVyZiBzdGF0ZSB3aXRob3V0IGV4cG9zaW5nIGFueXRoaW5n
IHRvIHVzZXJzcGFjZS4KPiA+ICAgICoKPiA+ICAgICogTm90ZTogaTkxNS1wZXJmIGluaXRpYWxp
emF0aW9uIGlzIHNwbGl0IGludG8gYW4gJ2luaXQnIGFuZCAncmVnaXN0ZXInCj4gPiAgICAqIHBo
YXNlIHdpdGggdGhlIGk5MTVfcGVyZl9yZWdpc3RlcigpIGV4cG9zaW5nIHN0YXRlIHRvIHVzZXJz
cGFjZS4KPiA+ICAgICovCj4gPiAtdm9pZCBpOTE1X3BlcmZfaW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpOTE1X3BlcmZfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikp
IHsKPiA+IC0JCWRldl9wcml2LT5wZXJmLm9hLm9wcy5pc192YWxpZF9iX2NvdW50ZXJfcmVnID0K
PiA+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkpIHsKPiA+ICsJCWk5MTUtPnBlcmYub2Eub3BzLmlz
X3ZhbGlkX2JfY291bnRlcl9yZWcgPQo+ID4gICAJCQlnZW43X2lzX3ZhbGlkX2JfY291bnRlcl9h
ZGRyOwo+ID4gLQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLmlzX3ZhbGlkX211eF9yZWcgPQo+ID4g
KwkJaTkxNS0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfbXV4X3JlZyA9Cj4gPiAgIAkJCWhzd19pc192
YWxpZF9tdXhfYWRkcjsKPiA+IC0JCWRldl9wcml2LT5wZXJmLm9hLm9wcy5pc192YWxpZF9mbGV4
X3JlZyA9IE5VTEw7Cj4gPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMuZW5hYmxlX21ldHJpY19z
ZXQgPSBoc3dfZW5hYmxlX21ldHJpY19zZXQ7Cj4gPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMu
ZGlzYWJsZV9tZXRyaWNfc2V0ID0gaHN3X2Rpc2FibGVfbWV0cmljX3NldDsKPiA+IC0JCWRldl9w
cml2LT5wZXJmLm9hLm9wcy5vYV9lbmFibGUgPSBnZW43X29hX2VuYWJsZTsKPiA+IC0JCWRldl9w
cml2LT5wZXJmLm9hLm9wcy5vYV9kaXNhYmxlID0gZ2VuN19vYV9kaXNhYmxlOwo+ID4gLQkJZGV2
X3ByaXYtPnBlcmYub2Eub3BzLnJlYWQgPSBnZW43X29hX3JlYWQ7Cj4gPiAtCQlkZXZfcHJpdi0+
cGVyZi5vYS5vcHMub2FfaHdfdGFpbF9yZWFkID0KPiA+ICsJCWk5MTUtPnBlcmYub2Eub3BzLmlz
X3ZhbGlkX2ZsZXhfcmVnID0gTlVMTDsKPiA+ICsJCWk5MTUtPnBlcmYub2Eub3BzLmVuYWJsZV9t
ZXRyaWNfc2V0ID0gaHN3X2VuYWJsZV9tZXRyaWNfc2V0Owo+ID4gKwkJaTkxNS0+cGVyZi5vYS5v
cHMuZGlzYWJsZV9tZXRyaWNfc2V0ID0gaHN3X2Rpc2FibGVfbWV0cmljX3NldDsKPiA+ICsJCWk5
MTUtPnBlcmYub2Eub3BzLm9hX2VuYWJsZSA9IGdlbjdfb2FfZW5hYmxlOwo+ID4gKwkJaTkxNS0+
cGVyZi5vYS5vcHMub2FfZGlzYWJsZSA9IGdlbjdfb2FfZGlzYWJsZTsKPiA+ICsJCWk5MTUtPnBl
cmYub2Eub3BzLnJlYWQgPSBnZW43X29hX3JlYWQ7Cj4gPiArCQlpOTE1LT5wZXJmLm9hLm9wcy5v
YV9od190YWlsX3JlYWQgPQo+ID4gICAJCQlnZW43X29hX2h3X3RhaWxfcmVhZDsKPiA+IC0JCWRl
dl9wcml2LT5wZXJmLm9hLm9hX2Zvcm1hdHMgPSBoc3dfb2FfZm9ybWF0czsKPiA+IC0JfSBlbHNl
IGlmIChIQVNfTE9HSUNBTF9SSU5HX0NPTlRFWFRTKGRldl9wcml2KSkgewo+ID4gKwkJaTkxNS0+
cGVyZi5vYS5vYV9mb3JtYXRzID0gaHN3X29hX2Zvcm1hdHM7Cj4gPiArCX0gZWxzZSBpZiAoSEFT
X0xPR0lDQUxfUklOR19DT05URVhUUyhpOTE1KSkgewo+ID4gICAJCS8qIE5vdGU6IHRoYXQgYWx0
aG91Z2ggd2UgY291bGQgdGhlb3JldGljYWxseSBhbHNvIHN1cHBvcnQgdGhlCj4gPiAgIAkJICog
bGVnYWN5IHJpbmdidWZmZXIgbW9kZSBvbiBCRFcgKGFuZCBlYXJsaWVyIGl0ZXJhdGlvbnMgb2YK
PiA+ICAgCQkgKiB0aGlzIGRyaXZlciwgYmVmb3JlIHVwc3RyZWFtaW5nIGRpZCB0aGlzKSBpdCBk
aWRuJ3Qgc2VlbQo+ID4gICAJCSAqIHdvcnRoIHRoZSBjb21wbGV4aXR5IHRvIG1haW50YWluIG5v
dyB0aGF0IEJEVysgZW5hYmxlCj4gPiAgIAkJICogZXhlY2xpc3QgbW9kZSBieSBkZWZhdWx0Lgo+
ID4gICAJCSAqLwo+ID4gLQkJZGV2X3ByaXYtPnBlcmYub2Eub2FfZm9ybWF0cyA9IGdlbjhfcGx1
c19vYV9mb3JtYXRzOwo+ID4gKwkJaTkxNS0+cGVyZi5vYS5vYV9mb3JtYXRzID0gZ2VuOF9wbHVz
X29hX2Zvcm1hdHM7Cj4gPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMub2FfZW5hYmxlID0gZ2Vu
OF9vYV9lbmFibGU7Cj4gPiAtCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMub2FfZGlzYWJsZSA9IGdl
bjhfb2FfZGlzYWJsZTsKPiA+IC0JCWRldl9wcml2LT5wZXJmLm9hLm9wcy5yZWFkID0gZ2VuOF9v
YV9yZWFkOwo+ID4gLQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLm9hX2h3X3RhaWxfcmVhZCA9IGdl
bjhfb2FfaHdfdGFpbF9yZWFkOwo+ID4gKwkJaTkxNS0+cGVyZi5vYS5vcHMub2FfZW5hYmxlID0g
Z2VuOF9vYV9lbmFibGU7Cj4gPiArCQlpOTE1LT5wZXJmLm9hLm9wcy5vYV9kaXNhYmxlID0gZ2Vu
OF9vYV9kaXNhYmxlOwo+ID4gKwkJaTkxNS0+cGVyZi5vYS5vcHMucmVhZCA9IGdlbjhfb2FfcmVh
ZDsKPiA+ICsJCWk5MTUtPnBlcmYub2Eub3BzLm9hX2h3X3RhaWxfcmVhZCA9IGdlbjhfb2FfaHdf
dGFpbF9yZWFkOwo+ID4gLQkJaWYgKElTX0dFTl9SQU5HRShkZXZfcHJpdiwgOCwgOSkpIHsKPiA+
IC0JCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfYl9jb3VudGVyX3JlZyA9Cj4gPiAr
CQlpZiAoSVNfR0VOX1JBTkdFKGk5MTUsIDgsIDkpKSB7Cj4gPiArCQkJaTkxNS0+cGVyZi5vYS5v
cHMuaXNfdmFsaWRfYl9jb3VudGVyX3JlZyA9Cj4gPiAgIAkJCQlnZW43X2lzX3ZhbGlkX2JfY291
bnRlcl9hZGRyOwo+ID4gLQkJCWRldl9wcml2LT5wZXJmLm9hLm9wcy5pc192YWxpZF9tdXhfcmVn
ID0KPiA+ICsJCQlpOTE1LT5wZXJmLm9hLm9wcy5pc192YWxpZF9tdXhfcmVnID0KPiA+ICAgCQkJ
CWdlbjhfaXNfdmFsaWRfbXV4X2FkZHI7Cj4gPiAtCQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLmlz
X3ZhbGlkX2ZsZXhfcmVnID0KPiA+ICsJCQlpOTE1LT5wZXJmLm9hLm9wcy5pc192YWxpZF9mbGV4
X3JlZyA9Cj4gPiAgIAkJCQlnZW44X2lzX3ZhbGlkX2ZsZXhfYWRkcjsKPiA+IC0JCQlpZiAoSVNf
Q0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+IC0JCQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLmlz
X3ZhbGlkX211eF9yZWcgPQo+ID4gKwkJCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiAr
CQkJCWk5MTUtPnBlcmYub2Eub3BzLmlzX3ZhbGlkX211eF9yZWcgPQo+ID4gICAJCQkJCWNodl9p
c192YWxpZF9tdXhfYWRkcjsKPiA+ICAgCQkJfQo+ID4gLQkJCWRldl9wcml2LT5wZXJmLm9hLm9w
cy5lbmFibGVfbWV0cmljX3NldCA9IGdlbjhfZW5hYmxlX21ldHJpY19zZXQ7Cj4gPiAtCQkJZGV2
X3ByaXYtPnBlcmYub2Eub3BzLmRpc2FibGVfbWV0cmljX3NldCA9IGdlbjhfZGlzYWJsZV9tZXRy
aWNfc2V0Owo+ID4gKwkJCWk5MTUtPnBlcmYub2Eub3BzLmVuYWJsZV9tZXRyaWNfc2V0ID0gZ2Vu
OF9lbmFibGVfbWV0cmljX3NldDsKPiA+ICsJCQlpOTE1LT5wZXJmLm9hLm9wcy5kaXNhYmxlX21l
dHJpY19zZXQgPSBnZW44X2Rpc2FibGVfbWV0cmljX3NldDsKPiA+IC0JCQlpZiAoSVNfR0VOKGRl
dl9wcml2LCA4KSkgewo+ID4gLQkJCQlkZXZfcHJpdi0+cGVyZi5vYS5jdHhfb2FjdHhjdHJsX29m
ZnNldCA9IDB4MTIwOwo+ID4gLQkJCQlkZXZfcHJpdi0+cGVyZi5vYS5jdHhfZmxleGV1MF9vZmZz
ZXQgPSAweDJjZTsKPiA+ICsJCQlpZiAoSVNfR0VOKGk5MTUsIDgpKSB7Cj4gPiArCQkJCWk5MTUt
PnBlcmYub2EuY3R4X29hY3R4Y3RybF9vZmZzZXQgPSAweDEyMDsKPiA+ICsJCQkJaTkxNS0+cGVy
Zi5vYS5jdHhfZmxleGV1MF9vZmZzZXQgPSAweDJjZTsKPiA+IC0JCQkJZGV2X3ByaXYtPnBlcmYu
b2EuZ2VuOF92YWxpZF9jdHhfYml0ID0gKDE8PDI1KTsKPiA+ICsJCQkJaTkxNS0+cGVyZi5vYS5n
ZW44X3ZhbGlkX2N0eF9iaXQgPSAoMTw8MjUpOwo+ID4gICAJCQl9IGVsc2Ugewo+ID4gLQkJCQlk
ZXZfcHJpdi0+cGVyZi5vYS5jdHhfb2FjdHhjdHJsX29mZnNldCA9IDB4MTI4Owo+ID4gLQkJCQlk
ZXZfcHJpdi0+cGVyZi5vYS5jdHhfZmxleGV1MF9vZmZzZXQgPSAweDNkZTsKPiA+ICsJCQkJaTkx
NS0+cGVyZi5vYS5jdHhfb2FjdHhjdHJsX29mZnNldCA9IDB4MTI4Owo+ID4gKwkJCQlpOTE1LT5w
ZXJmLm9hLmN0eF9mbGV4ZXUwX29mZnNldCA9IDB4M2RlOwo+ID4gLQkJCQlkZXZfcHJpdi0+cGVy
Zi5vYS5nZW44X3ZhbGlkX2N0eF9iaXQgPSAoMTw8MTYpOwo+ID4gKwkJCQlpOTE1LT5wZXJmLm9h
LmdlbjhfdmFsaWRfY3R4X2JpdCA9ICgxPDwxNik7Cj4gPiAgIAkJCX0KPiA+IC0JCX0gZWxzZSBp
ZiAoSVNfR0VOX1JBTkdFKGRldl9wcml2LCAxMCwgMTEpKSB7Cj4gPiAtCQkJZGV2X3ByaXYtPnBl
cmYub2Eub3BzLmlzX3ZhbGlkX2JfY291bnRlcl9yZWcgPQo+ID4gKwkJfSBlbHNlIGlmIChJU19H
RU5fUkFOR0UoaTkxNSwgMTAsIDExKSkgewo+ID4gKwkJCWk5MTUtPnBlcmYub2Eub3BzLmlzX3Zh
bGlkX2JfY291bnRlcl9yZWcgPQo+ID4gICAJCQkJZ2VuN19pc192YWxpZF9iX2NvdW50ZXJfYWRk
cjsKPiA+IC0JCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfbXV4X3JlZyA9Cj4gPiAr
CQkJaTkxNS0+cGVyZi5vYS5vcHMuaXNfdmFsaWRfbXV4X3JlZyA9Cj4gPiAgIAkJCQlnZW4xMF9p
c192YWxpZF9tdXhfYWRkcjsKPiA+IC0JCQlkZXZfcHJpdi0+cGVyZi5vYS5vcHMuaXNfdmFsaWRf
ZmxleF9yZWcgPQo+ID4gKwkJCWk5MTUtPnBlcmYub2Eub3BzLmlzX3ZhbGlkX2ZsZXhfcmVnID0K
PiA+ICAgCQkJCWdlbjhfaXNfdmFsaWRfZmxleF9hZGRyOwo+ID4gLQkJCWRldl9wcml2LT5wZXJm
Lm9hLm9wcy5lbmFibGVfbWV0cmljX3NldCA9IGdlbjhfZW5hYmxlX21ldHJpY19zZXQ7Cj4gPiAt
CQkJZGV2X3ByaXYtPnBlcmYub2Eub3BzLmRpc2FibGVfbWV0cmljX3NldCA9IGdlbjEwX2Rpc2Fi
bGVfbWV0cmljX3NldDsKPiA+ICsJCQlpOTE1LT5wZXJmLm9hLm9wcy5lbmFibGVfbWV0cmljX3Nl
dCA9IGdlbjhfZW5hYmxlX21ldHJpY19zZXQ7Cj4gPiArCQkJaTkxNS0+cGVyZi5vYS5vcHMuZGlz
YWJsZV9tZXRyaWNfc2V0ID0gZ2VuMTBfZGlzYWJsZV9tZXRyaWNfc2V0Owo+ID4gLQkJCWRldl9w
cml2LT5wZXJmLm9hLmN0eF9vYWN0eGN0cmxfb2Zmc2V0ID0gMHgxMjg7Cj4gPiAtCQkJZGV2X3By
aXYtPnBlcmYub2EuY3R4X2ZsZXhldTBfb2Zmc2V0ID0gMHgzZGU7Cj4gPiArCQkJaTkxNS0+cGVy
Zi5vYS5jdHhfb2FjdHhjdHJsX29mZnNldCA9IDB4MTI4Owo+ID4gKwkJCWk5MTUtPnBlcmYub2Eu
Y3R4X2ZsZXhldTBfb2Zmc2V0ID0gMHgzZGU7Cj4gPiAtCQkJZGV2X3ByaXYtPnBlcmYub2EuZ2Vu
OF92YWxpZF9jdHhfYml0ID0gKDE8PDE2KTsKPiA+ICsJCQlpOTE1LT5wZXJmLm9hLmdlbjhfdmFs
aWRfY3R4X2JpdCA9ICgxPDwxNik7Cj4gPiAgIAkJfQo+ID4gICAJfQo+ID4gLQlpZiAoZGV2X3By
aXYtPnBlcmYub2Eub3BzLmVuYWJsZV9tZXRyaWNfc2V0KSB7Cj4gPiAtCQlocnRpbWVyX2luaXQo
JmRldl9wcml2LT5wZXJmLm9hLnBvbGxfY2hlY2tfdGltZXIsCj4gPiArCWlmIChpOTE1LT5wZXJm
Lm9hLm9wcy5lbmFibGVfbWV0cmljX3NldCkgewo+ID4gKwkJaHJ0aW1lcl9pbml0KCZpOTE1LT5w
ZXJmLm9hLnBvbGxfY2hlY2tfdGltZXIsCj4gPiAgIAkJCQlDTE9DS19NT05PVE9OSUMsIEhSVElN
RVJfTU9ERV9SRUwpOwo+ID4gLQkJZGV2X3ByaXYtPnBlcmYub2EucG9sbF9jaGVja190aW1lci5m
dW5jdGlvbiA9IG9hX3BvbGxfY2hlY2tfdGltZXJfY2I7Cj4gPiAtCQlpbml0X3dhaXRxdWV1ZV9o
ZWFkKCZkZXZfcHJpdi0+cGVyZi5vYS5wb2xsX3dxKTsKPiA+ICsJCWk5MTUtPnBlcmYub2EucG9s
bF9jaGVja190aW1lci5mdW5jdGlvbiA9IG9hX3BvbGxfY2hlY2tfdGltZXJfY2I7Cj4gPiArCQlp
bml0X3dhaXRxdWV1ZV9oZWFkKCZpOTE1LT5wZXJmLm9hLnBvbGxfd3EpOwo+ID4gLQkJSU5JVF9M
SVNUX0hFQUQoJmRldl9wcml2LT5wZXJmLnN0cmVhbXMpOwo+ID4gLQkJbXV0ZXhfaW5pdCgmZGV2
X3ByaXYtPnBlcmYubG9jayk7Cj4gPiAtCQlzcGluX2xvY2tfaW5pdCgmZGV2X3ByaXYtPnBlcmYu
b2Eub2FfYnVmZmVyLnB0cl9sb2NrKTsKPiA+ICsJCUlOSVRfTElTVF9IRUFEKCZpOTE1LT5wZXJm
LnN0cmVhbXMpOwo+ID4gKwkJbXV0ZXhfaW5pdCgmaTkxNS0+cGVyZi5sb2NrKTsKPiA+ICsJCXNw
aW5fbG9ja19pbml0KCZpOTE1LT5wZXJmLm9hLm9hX2J1ZmZlci5wdHJfbG9jayk7Cj4gPiAgIAkJ
b2Ffc2FtcGxlX3JhdGVfaGFyZF9saW1pdCA9IDEwMDAgKgo+ID4gLQkJCShSVU5USU1FX0lORk8o
ZGV2X3ByaXYpLT5jc190aW1lc3RhbXBfZnJlcXVlbmN5X2toeiAvIDIpOwo+ID4gLQkJZGV2X3By
aXYtPnBlcmYuc3lzY3RsX2hlYWRlciA9IHJlZ2lzdGVyX3N5c2N0bF90YWJsZShkZXZfcm9vdCk7
Cj4gPiArCQkJKFJVTlRJTUVfSU5GTyhpOTE1KS0+Y3NfdGltZXN0YW1wX2ZyZXF1ZW5jeV9raHog
LyAyKTsKPiA+ICsJCWk5MTUtPnBlcmYuc3lzY3RsX2hlYWRlciA9IHJlZ2lzdGVyX3N5c2N0bF90
YWJsZShkZXZfcm9vdCk7Cj4gPiAtCQltdXRleF9pbml0KCZkZXZfcHJpdi0+cGVyZi5tZXRyaWNz
X2xvY2spOwo+ID4gLQkJaWRyX2luaXQoJmRldl9wcml2LT5wZXJmLm1ldHJpY3NfaWRyKTsKPiA+
ICsJCW11dGV4X2luaXQoJmk5MTUtPnBlcmYubWV0cmljc19sb2NrKTsKPiA+ICsJCWlkcl9pbml0
KCZpOTE1LT5wZXJmLm1ldHJpY3NfaWRyKTsKPiA+IC0JCWRldl9wcml2LT5wZXJmLmluaXRpYWxp
emVkID0gdHJ1ZTsKPiA+ICsJCWk5MTUtPnBlcmYuaW5pdGlhbGl6ZWQgPSB0cnVlOwo+ID4gICAJ
fQo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgZGVzdHJveV9jb25maWcoaW50IGlkLCB2b2lkICpw
LCB2b2lkICpkYXRhKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IGRhdGE7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZGF0YTsK
PiA+ICAgCXN0cnVjdCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmlnID0gcDsKPiA+IC0JcHV0X29h
X2NvbmZpZyhkZXZfcHJpdiwgb2FfY29uZmlnKTsKPiA+ICsJcHV0X29hX2NvbmZpZyhpOTE1LCBv
YV9jb25maWcpOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGk5
MTVfcGVyZl9maW5pIC0gQ291bnRlciBwYXJ0IHRvIGk5MTVfcGVyZl9pbml0KCkKPiA+IC0gKiBA
ZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNl
IGluc3RhbmNlCj4gPiAgICAqLwo+ID4gLXZvaWQgaTkxNV9wZXJmX2Zpbmkoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaTkxNV9wZXJmX2Zpbmkoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JaWYgKCFkZXZfcHJpdi0+cGVyZi5p
bml0aWFsaXplZCkKPiA+ICsJaWYgKCFpOTE1LT5wZXJmLmluaXRpYWxpemVkKQo+ID4gICAJCXJl
dHVybjsKPiA+IC0JaWRyX2Zvcl9lYWNoKCZkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2lkciwgZGVz
dHJveV9jb25maWcsIGRldl9wcml2KTsKPiA+IC0JaWRyX2Rlc3Ryb3koJmRldl9wcml2LT5wZXJm
Lm1ldHJpY3NfaWRyKTsKPiA+ICsJaWRyX2Zvcl9lYWNoKCZpOTE1LT5wZXJmLm1ldHJpY3NfaWRy
LCBkZXN0cm95X2NvbmZpZywgaTkxNSk7Cj4gPiArCWlkcl9kZXN0cm95KCZpOTE1LT5wZXJmLm1l
dHJpY3NfaWRyKTsKPiA+IC0JdW5yZWdpc3Rlcl9zeXNjdGxfdGFibGUoZGV2X3ByaXYtPnBlcmYu
c3lzY3RsX2hlYWRlcik7Cj4gPiArCXVucmVnaXN0ZXJfc3lzY3RsX3RhYmxlKGk5MTUtPnBlcmYu
c3lzY3RsX2hlYWRlcik7Cj4gPiAtCW1lbXNldCgmZGV2X3ByaXYtPnBlcmYub2Eub3BzLCAwLCBz
aXplb2YoZGV2X3ByaXYtPnBlcmYub2Eub3BzKSk7Cj4gPiArCW1lbXNldCgmaTkxNS0+cGVyZi5v
YS5vcHMsIDAsIHNpemVvZihpOTE1LT5wZXJmLm9hLm9wcykpOwo+ID4gLQlkZXZfcHJpdi0+cGVy
Zi5pbml0aWFsaXplZCA9IGZhbHNlOwo+ID4gKwlpOTE1LT5wZXJmLmluaXRpYWxpemVkID0gZmFs
c2U7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Bt
dS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYwo+ID4gaW5kZXggZWI5YzBlMGU1
NDVjLi5jNDg2MWMxMjEwMGMgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3BtdS5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jCj4gPiBA
QCAtMTU5LDI0ICsxNTksMjQgQEAgYWRkX3NhbXBsZShzdHJ1Y3QgaTkxNV9wbXVfc2FtcGxlICpz
YW1wbGUsIHUzMiB2YWwpCj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQKPiA+IC1lbmdpbmVzX3Nh
bXBsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVuc2lnbmVkIGludCBwZXJp
b2RfbnMpCj4gPiArZW5naW5lc19zYW1wbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IHVuc2lnbmVkIGludCBwZXJpb2RfbnMpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZTsKPiA+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ID4gICAJaW50
ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIGZsYWdzOwo+ID4gLQlp
ZiAoKGRldl9wcml2LT5wbXUuZW5hYmxlICYgRU5HSU5FX1NBTVBMRV9NQVNLKSA9PSAwKQo+ID4g
KwlpZiAoKGk5MTUtPnBtdS5lbmFibGUgJiBFTkdJTkVfU0FNUExFX01BU0spID09IDApCj4gPiAg
IAkJcmV0dXJuOwo+ID4gICAJd2FrZXJlZiA9IDA7Cj4gPiAtCWlmIChSRUFEX09OQ0UoZGV2X3By
aXYtPmd0LmF3YWtlKSkKPiA+IC0JCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9p
bl91c2UoZGV2X3ByaXYpOwo+ID4gKwlpZiAoUkVBRF9PTkNFKGk5MTUtPmd0LmF3YWtlKSkKPiA+
ICsJCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoaTkxNSk7Cj4gPiAg
IAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlzcGluX2xvY2tfaXJxc2F2ZSgm
ZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBmbGFncyk7Cj4gPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdp
bmUsIGRldl9wcml2LCBpZCkgewo+ID4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+dW5jb3Jl
LmxvY2ssIGZsYWdzKTsKPiA+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsK
PiA+ICAgCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX3BtdSAqcG11ID0gJmVuZ2luZS0+cG11Owo+ID4g
ICAJCWJvb2wgYnVzeTsKPiA+ICAgCQl1MzIgdmFsOwo+ID4gQEAgLTIwNSw5ICsyMDUsOSBAQCBl
bmdpbmVzX3NhbXBsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHVuc2lnbmVk
IGludCBwZXJpb2RfbnMpCj4gPiAgIAkJaWYgKGJ1c3kpCj4gPiAgIAkJCWFkZF9zYW1wbGUoJnBt
dS0+c2FtcGxlW0k5MTVfU0FNUExFX0JVU1ldLCBwZXJpb2RfbnMpOwo+ID4gICAJfQo+ID4gLQlz
cGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGZsYWdzKTsKPiA+
ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGZsYWdzKTsKPiA+
IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9y
dW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZAo+
ID4gQEAgLTIxNywzMyArMjE3LDMzIEBAIGFkZF9zYW1wbGVfbXVsdChzdHJ1Y3QgaTkxNV9wbXVf
c2FtcGxlICpzYW1wbGUsIHUzMiB2YWwsIHUzMiBtdWwpCj4gPiAgIH0KPiA+ICAgc3RhdGljIHZv
aWQKPiA+IC1mcmVxdWVuY3lfc2FtcGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgdW5zaWduZWQgaW50IHBlcmlvZF9ucykKPiA+ICtmcmVxdWVuY3lfc2FtcGxlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCB1bnNpZ25lZCBpbnQgcGVyaW9kX25zKQo+ID4gICB7Cj4g
PiAtCWlmIChkZXZfcHJpdi0+cG11LmVuYWJsZSAmCj4gPiArCWlmIChpOTE1LT5wbXUuZW5hYmxl
ICYKPiA+ICAgCSAgICBjb25maWdfZW5hYmxlZF9tYXNrKEk5MTVfUE1VX0FDVFVBTF9GUkVRVUVO
Q1kpKSB7Cj4gPiAgIAkJdTMyIHZhbDsKPiA+IC0JCXZhbCA9IGRldl9wcml2LT5ndF9wbS5ycHMu
Y3VyX2ZyZXE7Cj4gPiAtCQlpZiAoZGV2X3ByaXYtPmd0LmF3YWtlKSB7Cj4gPiArCQl2YWwgPSBp
OTE1LT5ndF9wbS5ycHMuY3VyX2ZyZXE7Cj4gPiArCQlpZiAoaTkxNS0+Z3QuYXdha2UpIHsKPiA+
ICAgCQkJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAtCQkJd2l0aF9pbnRlbF9ydW50aW1l
X3BtX2lmX2luX3VzZShkZXZfcHJpdiwgd2FrZXJlZikgewo+ID4gLQkJCQl2YWwgPSBpbnRlbF91
bmNvcmVfcmVhZF9ub3RyYWNlKCZkZXZfcHJpdi0+dW5jb3JlLAo+ID4gKwkJCXdpdGhfaW50ZWxf
cnVudGltZV9wbV9pZl9pbl91c2UoaTkxNSwgd2FrZXJlZikgewo+ID4gKwkJCQl2YWwgPSBpbnRl
bF91bmNvcmVfcmVhZF9ub3RyYWNlKCZpOTE1LT51bmNvcmUsCj4gPiAgIAkJCQkJCQkJR0VONl9S
UFNUQVQxKTsKPiA+IC0JCQkJdmFsID0gaW50ZWxfZ2V0X2NhZ2YoZGV2X3ByaXYsIHZhbCk7Cj4g
PiArCQkJCXZhbCA9IGludGVsX2dldF9jYWdmKGk5MTUsIHZhbCk7Cj4gPiAgIAkJCX0KPiA+ICAg
CQl9Cj4gPiAtCQlhZGRfc2FtcGxlX211bHQoJmRldl9wcml2LT5wbXUuc2FtcGxlW19fSTkxNV9T
QU1QTEVfRlJFUV9BQ1RdLAo+ID4gLQkJCQlpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgdmFsKSwK
PiA+ICsJCWFkZF9zYW1wbGVfbXVsdCgmaTkxNS0+cG11LnNhbXBsZVtfX0k5MTVfU0FNUExFX0ZS
RVFfQUNUXSwKPiA+ICsJCQkJaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgdmFsKSwKPiA+ICAgCQkJCXBl
cmlvZF9ucyAvIDEwMDApOwo+ID4gICAJfQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBtdS5lbmFibGUg
Jgo+ID4gKwlpZiAoaTkxNS0+cG11LmVuYWJsZSAmCj4gPiAgIAkgICAgY29uZmlnX2VuYWJsZWRf
bWFzayhJOTE1X1BNVV9SRVFVRVNURURfRlJFUVVFTkNZKSkgewo+ID4gLQkJYWRkX3NhbXBsZV9t
dWx0KCZkZXZfcHJpdi0+cG11LnNhbXBsZVtfX0k5MTVfU0FNUExFX0ZSRVFfUkVRXSwKPiA+IC0J
CQkJaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsCj4gPiAtCQkJCQkgICAgICAgZGV2X3ByaXYtPmd0
X3BtLnJwcy5jdXJfZnJlcSksCj4gPiArCQlhZGRfc2FtcGxlX211bHQoJmk5MTUtPnBtdS5zYW1w
bGVbX19JOTE1X1NBTVBMRV9GUkVRX1JFUV0sCj4gPiArCQkJCWludGVsX2dwdV9mcmVxKGk5MTUs
Cj4gPiArCQkJCQkgICAgICAgaTkxNS0+Z3RfcG0ucnBzLmN1cl9mcmVxKSwKPiA+ICAgCQkJCXBl
cmlvZF9ucyAvIDEwMDApOwo+ID4gICAJfQo+ID4gICB9Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9xdWVyeS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9x
dWVyeS5jCj4gPiBpbmRleCA3YjcwMTYxNzEwNTcuLjg3NjA2MzYyYjU2ZiAxMDA2NDQKPiA+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcXVlcnkuYwo+ID4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9xdWVyeS5jCj4gPiBAQCAtMzEsMTAgKzMxLDEwIEBAIHN0YXRpYyBp
bnQgY29weV9xdWVyeV9pdGVtKHZvaWQgKnF1ZXJ5X2hkciwgc2l6ZV90IHF1ZXJ5X3N6LAo+ID4g
ICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IHF1ZXJ5X3RvcG9sb2d5X2luZm8o
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBpbnQgcXVlcnlf
dG9wb2xvZ3lfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAg
ICAgIHN0cnVjdCBkcm1faTkxNV9xdWVyeV9pdGVtICpxdWVyeV9pdGVtKQo+ID4gICB7Cj4gPiAt
CWNvbnN0IHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1ID0gJlJVTlRJTUVfSU5GTyhkZXZfcHJp
diktPnNzZXU7Cj4gPiArCWNvbnN0IHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1ID0gJlJVTlRJ
TUVfSU5GTyhpOTE1KS0+c3NldTsKPiA+ICAgCXN0cnVjdCBkcm1faTkxNV9xdWVyeV90b3BvbG9n
eV9pbmZvIHRvcG87Cj4gPiAgIAl1MzIgc2xpY2VfbGVuZ3RoLCBzdWJzbGljZV9sZW5ndGgsIGV1
X2xlbmd0aCwgdG90YWxfbGVuZ3RoOwo+ID4gICAJdTggc3Vic2xpY2Vfc3RyaWRlID0gR0VOX1NT
RVVfU1RSSURFKHNzZXUtPm1heF9zdWJzbGljZXMpOwo+ID4gQEAgLTE0Myw3ICsxNDMsNyBAQCBx
dWVyeV9lbmdpbmVfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCXJl
dHVybiBsZW47Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50ICgqIGNvbnN0IGk5MTVfcXVlcnlfZnVu
Y3NbXSkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBpbnQg
KCogY29uc3QgaTkxNV9xdWVyeV9mdW5jc1tdKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICAgCQkJCQlzdHJ1Y3QgZHJtX2k5MTVfcXVlcnlfaXRlbSAqcXVlcnlfaXRlbSkgPSB7
Cj4gPiAgIAlxdWVyeV90b3BvbG9neV9pbmZvLAo+ID4gICAJcXVlcnlfZW5naW5lX2luZm8sCj4g
PiBAQCAtMTUxLDcgKzE1MSw3IEBAIHN0YXRpYyBpbnQgKCogY29uc3QgaTkxNV9xdWVyeV9mdW5j
c1tdKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIGludCBpOTE1X3F1
ZXJ5X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsIHN0cnVjdCBkcm1f
ZmlsZSAqZmlsZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGRybV9pOTE1X3F1ZXJ5ICphcmdzID0gZGF0YTsK
PiA+ICAgCXN0cnVjdCBkcm1faTkxNV9xdWVyeV9pdGVtIF9fdXNlciAqdXNlcl9pdGVtX3B0ciA9
Cj4gPiAgIAkJdTY0X3RvX3VzZXJfcHRyKGFyZ3MtPml0ZW1zX3B0cik7Cj4gPiBAQCAtMTgwLDcg
KzE4MCw3IEBAIGludCBpOTE1X3F1ZXJ5X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZv
aWQgKmRhdGEsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKPiA+ICAgCQlpZiAoZnVuY19pZHggPCBB
UlJBWV9TSVpFKGk5MTVfcXVlcnlfZnVuY3MpKSB7Cj4gPiAgIAkJCWZ1bmNfaWR4ID0gYXJyYXlf
aW5kZXhfbm9zcGVjKGZ1bmNfaWR4LAo+ID4gICAJCQkJCQkgICAgICBBUlJBWV9TSVpFKGk5MTVf
cXVlcnlfZnVuY3MpKTsKPiA+IC0JCQlyZXQgPSBpOTE1X3F1ZXJ5X2Z1bmNzW2Z1bmNfaWR4XShk
ZXZfcHJpdiwgJml0ZW0pOwo+ID4gKwkJCXJldCA9IGk5MTVfcXVlcnlfZnVuY3NbZnVuY19pZHhd
KGk5MTUsICZpdGVtKTsKPiA+ICAgCQl9Cj4gPiAgIAkJLyogT25seSB3cml0ZSB0aGUgbGVuZ3Ro
IGJhY2sgdG8gdXNlcnNwYWNlIGlmIHRoZXkgZGlmZmVyLiAqLwo+ID4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3JlZy5oCj4gPiBpbmRleCBlZGY5ZjkzOTM0YTEuLmI1MjI5NzBiZGY3NCAxMDA2NDQKPiA+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfcmVnLmgKPiA+IEBAIC0yMDUsNyArMjA1LDcgQEAgc3RhdGljIGlubGlu
ZSBib29sIGk5MTVfbW1pb19yZWdfdmFsaWQoaTkxNV9yZWdfdCByZWcpCj4gPiAgICNkZWZpbmUg
VkxWX01JUElfQkFTRQkJCVZMVl9ESVNQTEFZX0JBU0UKPiA+ICAgI2RlZmluZSBCWFRfTUlQSV9C
QVNFCQkJMHg2MDAwMAo+ID4gLSNkZWZpbmUgRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpCShJ
TlRFTF9JTkZPKGRldl9wcml2KS0+ZGlzcGxheV9tbWlvX29mZnNldCkKPiA+ICsjZGVmaW5lIERJ
U1BMQVlfTU1JT19CQVNFKGk5MTUpCShJTlRFTF9JTkZPKGk5MTUpLT5kaXNwbGF5X21taW9fb2Zm
c2V0KQo+ID4gICAvKgo+ID4gICAgKiBHaXZlbiB0aGUgZmlyc3QgdHdvIG51bWJlcnMgX19hIGFu
ZCBfX2Igb2YgYXJiaXRyYXJpbHkgbWFueSBldmVubHkgc3BhY2VkCj4gPiBAQCAtMjQ3LDE1ICsy
NDcsMTUgQEAgc3RhdGljIGlubGluZSBib29sIGk5MTVfbW1pb19yZWdfdmFsaWQoaTkxNV9yZWdf
dCByZWcpCj4gPiAgICAqIERldmljZSBpbmZvIG9mZnNldCBhcnJheSBiYXNlZCBoZWxwZXJzIGZv
ciBncm91cHMgb2YgcmVnaXN0ZXJzIHdpdGggdW5ldmVubHkKPiA+ICAgICogc3BhY2VkIGJhc2Ug
b2Zmc2V0cy4KPiA+ICAgICovCj4gPiAtI2RlZmluZSBfTU1JT19QSVBFMihwaXBlLCByZWcpCQlf
TU1JTyhJTlRFTF9JTkZPKGRldl9wcml2KS0+cGlwZV9vZmZzZXRzW3BpcGVdIC0gXAo+ID4gLQkJ
CQkJICAgICAgSU5URUxfSU5GTyhkZXZfcHJpdiktPnBpcGVfb2Zmc2V0c1tQSVBFX0FdICsgKHJl
ZykgKyBcCj4gPiAtCQkJCQkgICAgICBESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikpCj4gPiAt
I2RlZmluZSBfTU1JT19UUkFOUzIocGlwZSwgcmVnKQkJX01NSU8oSU5URUxfSU5GTyhkZXZfcHJp
diktPnRyYW5zX29mZnNldHNbKHBpcGUpXSAtIFwKPiA+IC0JCQkJCSAgICAgIElOVEVMX0lORk8o
ZGV2X3ByaXYpLT50cmFuc19vZmZzZXRzW1RSQU5TQ09ERVJfQV0gKyAocmVnKSArIFwKPiA+IC0J
CQkJCSAgICAgIERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSkKPiA+IC0jZGVmaW5lIF9DVVJT
T1IyKHBpcGUsIHJlZykJCV9NTUlPKElOVEVMX0lORk8oZGV2X3ByaXYpLT5jdXJzb3Jfb2Zmc2V0
c1socGlwZSldIC0gXAo+ID4gLQkJCQkJICAgICAgSU5URUxfSU5GTyhkZXZfcHJpdiktPmN1cnNv
cl9vZmZzZXRzW1BJUEVfQV0gKyAocmVnKSArIFwKPiA+IC0JCQkJCSAgICAgIERJU1BMQVlfTU1J
T19CQVNFKGRldl9wcml2KSkKPiA+ICsjZGVmaW5lIF9NTUlPX1BJUEUyKHBpcGUsIHJlZykJCV9N
TUlPKElOVEVMX0lORk8oaTkxNSktPnBpcGVfb2Zmc2V0c1twaXBlXSAtIFwKPiA+ICsJCQkJCSAg
ICAgIElOVEVMX0lORk8oaTkxNSktPnBpcGVfb2Zmc2V0c1tQSVBFX0FdICsgKHJlZykgKyBcCj4g
PiArCQkJCQkgICAgICBESVNQTEFZX01NSU9fQkFTRShpOTE1KSkKPiA+ICsjZGVmaW5lIF9NTUlP
X1RSQU5TMihwaXBlLCByZWcpCQlfTU1JTyhJTlRFTF9JTkZPKGk5MTUpLT50cmFuc19vZmZzZXRz
WyhwaXBlKV0gLSBcCj4gPiArCQkJCQkgICAgICBJTlRFTF9JTkZPKGk5MTUpLT50cmFuc19vZmZz
ZXRzW1RSQU5TQ09ERVJfQV0gKyAocmVnKSArIFwKPiA+ICsJCQkJCSAgICAgIERJU1BMQVlfTU1J
T19CQVNFKGk5MTUpKQo+ID4gKyNkZWZpbmUgX0NVUlNPUjIocGlwZSwgcmVnKQkJX01NSU8oSU5U
RUxfSU5GTyhpOTE1KS0+Y3Vyc29yX29mZnNldHNbKHBpcGUpXSAtIFwKPiA+ICsJCQkJCSAgICAg
IElOVEVMX0lORk8oaTkxNSktPmN1cnNvcl9vZmZzZXRzW1BJUEVfQV0gKyAocmVnKSArIFwKPiA+
ICsJCQkJCSAgICAgIERJU1BMQVlfTU1JT19CQVNFKGk5MTUpKQo+ID4gICAjZGVmaW5lIF9fTUFT
S0VEX0ZJRUxEKG1hc2ssIHZhbHVlKSAoKG1hc2spIDw8IDE2IHwgKHZhbHVlKSkKPiA+ICAgI2Rl
ZmluZSBfTUFTS0VEX0ZJRUxEKG1hc2ssIHZhbHVlKSAoewkJCQkJICAgXAo+ID4gQEAgLTEzMDcs
NyArMTMwNyw3IEBAIGVudW0gaTkxNV9wb3dlcl93ZWxsX2lkIHsKPiA+ICAgI2RlZmluZSAgRFBJ
T19DTU5SU1QJCQkoMSA8PCAwKQo+ID4gICAjZGVmaW5lIERQSU9fUEhZKHBpcGUpCQkJKChwaXBl
KSA+PiAxKQo+ID4gLSNkZWZpbmUgRFBJT19QSFlfSU9TRl9QT1JUKHBoeSkJCShkZXZfcHJpdi0+
ZHBpb19waHlfaW9zZl9wb3J0W3BoeV0pCj4gPiArI2RlZmluZSBEUElPX1BIWV9JT1NGX1BPUlQo
cGh5KQkJKGk5MTUtPmRwaW9fcGh5X2lvc2ZfcG9ydFtwaHldKQo+ID4gICAvKgo+ID4gICAgKiBQ
ZXIgcGlwZS9QTEwgRFBJTyByZWdzCj4gPiBAQCAtMzAwNCw5ICszMDA0LDkgQEAgZW51bSBpOTE1
X3Bvd2VyX3dlbGxfaWQgewo+ID4gICAjZGVmaW5lIFBNX1ZFQk9YX0NTX0VSUk9SX0lOVEVSUlVQ
VAkJKDEgPDwgMTIpIC8qIGhzdysgKi8KPiA+ICAgI2RlZmluZSBQTV9WRUJPWF9VU0VSX0lOVEVS
UlVQVAkJCSgxIDw8IDEwKSAvKiBoc3crICovCj4gPiAtI2RlZmluZSBHVF9QQVJJVFlfRVJST1Io
ZGV2X3ByaXYpIFwKPiA+ICsjZGVmaW5lIEdUX1BBUklUWV9FUlJPUihpOTE1KSBcCj4gPiAgIAko
R1RfUkVOREVSX0wzX1BBUklUWV9FUlJPUl9JTlRFUlJVUFQgfCBcCj4gPiAtCSAoSVNfSEFTV0VM
TChkZXZfcHJpdikgPyBHVF9SRU5ERVJfTDNfUEFSSVRZX0VSUk9SX0lOVEVSUlVQVF9TMSA6IDAp
KQo+ID4gKwkgKElTX0hBU1dFTEwoaTkxNSkgPyBHVF9SRU5ERVJfTDNfUEFSSVRZX0VSUk9SX0lO
VEVSUlVQVF9TMSA6IDApKQo+ID4gICAvKiBUaGVzZSBhcmUgYWxsIHRoZSAib2xkIiBpbnRlcnJ1
cHRzICovCj4gPiAgICNkZWZpbmUgSUxLX0JTRF9VU0VSX0lOVEVSUlVQVAkJCQkoMSA8PCA1KQo+
ID4gQEAgLTMxOTUsNyArMzE5NSw3IEBAIGVudW0gaTkxNV9wb3dlcl93ZWxsX2lkIHsKPiA+ICAg
LyoKPiA+ICAgICogR1BJTyByZWdzCj4gPiAgICAqLwo+ID4gLSNkZWZpbmUgR1BJTyhncGlvKQkJ
X01NSU8oZGV2X3ByaXYtPmdwaW9fbW1pb19iYXNlICsgMHg1MDEwICsgXAo+ID4gKyNkZWZpbmUg
R1BJTyhncGlvKQkJX01NSU8oaTkxNS0+Z3Bpb19tbWlvX2Jhc2UgKyAweDUwMTAgKyBcCj4gPiAg
IAkJCQkgICAgICA0ICogKGdwaW8pKQo+ID4gICAjIGRlZmluZSBHUElPX0NMT0NLX0RJUl9NQVNL
CQkoMSA8PCAwKQo+ID4gQEAgLTMyMTMsNyArMzIxMyw3IEBAIGVudW0gaTkxNV9wb3dlcl93ZWxs
X2lkIHsKPiA+ICAgIyBkZWZpbmUgR1BJT19EQVRBX1ZBTF9JTgkJKDEgPDwgMTIpCj4gPiAgICMg
ZGVmaW5lIEdQSU9fREFUQV9QVUxMVVBfRElTQUJMRQkoMSA8PCAxMykKPiA+IC0jZGVmaW5lIEdN
QlVTMAkJCV9NTUlPKGRldl9wcml2LT5ncGlvX21taW9fYmFzZSArIDB4NTEwMCkgLyogY2xvY2sv
cG9ydCBzZWxlY3QgKi8KPiA+ICsjZGVmaW5lIEdNQlVTMAkJCV9NTUlPKGk5MTUtPmdwaW9fbW1p
b19iYXNlICsgMHg1MTAwKSAvKiBjbG9jay9wb3J0IHNlbGVjdCAqLwo+ID4gICAjZGVmaW5lICAg
R01CVVNfQUtTVl9TRUxFQ1QJKDEgPDwgMTEpCj4gPiAgICNkZWZpbmUgICBHTUJVU19SQVRFXzEw
MEtIWgkoMCA8PCA4KQo+ID4gICAjZGVmaW5lICAgR01CVVNfUkFURV81MEtIWgkoMSA8PCA4KQo+
ID4gQEAgLTMyNDAsNyArMzI0MCw3IEBAIGVudW0gaTkxNV9wb3dlcl93ZWxsX2lkIHsKPiA+ICAg
I2RlZmluZSAgIEdNQlVTX1BJTl8xMl9UQzRfSUNQCTEyCj4gPiAgICNkZWZpbmUgICBHTUJVU19O
VU1fUElOUwkxMyAvKiBpbmNsdWRpbmcgMCAqLwo+ID4gLSNkZWZpbmUgR01CVVMxCQkJX01NSU8o
ZGV2X3ByaXYtPmdwaW9fbW1pb19iYXNlICsgMHg1MTA0KSAvKiBjb21tYW5kL3N0YXR1cyAqLwo+
ID4gKyNkZWZpbmUgR01CVVMxCQkJX01NSU8oaTkxNS0+Z3Bpb19tbWlvX2Jhc2UgKyAweDUxMDQp
IC8qIGNvbW1hbmQvc3RhdHVzICovCj4gPiAgICNkZWZpbmUgICBHTUJVU19TV19DTFJfSU5UCSgx
IDw8IDMxKQo+ID4gICAjZGVmaW5lICAgR01CVVNfU1dfUkRZCQkoMSA8PCAzMCkKPiA+ICAgI2Rl
ZmluZSAgIEdNQlVTX0VOVAkJKDEgPDwgMjkpIC8qIGVuYWJsZSB0aW1lb3V0ICovCj4gPiBAQCAt
MzI1NSw3ICszMjU1LDcgQEAgZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgewo+ID4gICAjZGVmaW5l
ICAgR01CVVNfU0xBVkVfQUREUl9TSElGVCAxCj4gPiAgICNkZWZpbmUgICBHTUJVU19TTEFWRV9S
RUFECSgxIDw8IDApCj4gPiAgICNkZWZpbmUgICBHTUJVU19TTEFWRV9XUklURQkoMCA8PCAwKQo+
ID4gLSNkZWZpbmUgR01CVVMyCQkJX01NSU8oZGV2X3ByaXYtPmdwaW9fbW1pb19iYXNlICsgMHg1
MTA4KSAvKiBzdGF0dXMgKi8KPiA+ICsjZGVmaW5lIEdNQlVTMgkJCV9NTUlPKGk5MTUtPmdwaW9f
bW1pb19iYXNlICsgMHg1MTA4KSAvKiBzdGF0dXMgKi8KPiA+ICAgI2RlZmluZSAgIEdNQlVTX0lO
VVNFCQkoMSA8PCAxNSkKPiA+ICAgI2RlZmluZSAgIEdNQlVTX0hXX1dBSVRfUEhBU0UJKDEgPDwg
MTQpCj4gPiAgICNkZWZpbmUgICBHTUJVU19TVEFMTF9USU1FT1VUCSgxIDw8IDEzKQo+ID4gQEAg
LTMyNjMsMjIgKzMyNjMsMjIgQEAgZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgewo+ID4gICAjZGVm
aW5lICAgR01CVVNfSFdfUkRZCQkoMSA8PCAxMSkKPiA+ICAgI2RlZmluZSAgIEdNQlVTX1NBVE9F
UgkJKDEgPDwgMTApCj4gPiAgICNkZWZpbmUgICBHTUJVU19BQ1RJVkUJCSgxIDw8IDkpCj4gPiAt
I2RlZmluZSBHTUJVUzMJCQlfTU1JTyhkZXZfcHJpdi0+Z3Bpb19tbWlvX2Jhc2UgKyAweDUxMGMp
IC8qIGRhdGEgYnVmZmVyIGJ5dGVzIDMtMCAqLwo+ID4gLSNkZWZpbmUgR01CVVM0CQkJX01NSU8o
ZGV2X3ByaXYtPmdwaW9fbW1pb19iYXNlICsgMHg1MTEwKSAvKiBpbnRlcnJ1cHQgbWFzayAoUGlu
ZXZpZXcrKSAqLwo+ID4gKyNkZWZpbmUgR01CVVMzCQkJX01NSU8oaTkxNS0+Z3Bpb19tbWlvX2Jh
c2UgKyAweDUxMGMpIC8qIGRhdGEgYnVmZmVyIGJ5dGVzIDMtMCAqLwo+ID4gKyNkZWZpbmUgR01C
VVM0CQkJX01NSU8oaTkxNS0+Z3Bpb19tbWlvX2Jhc2UgKyAweDUxMTApIC8qIGludGVycnVwdCBt
YXNrIChQaW5ldmlldyspICovCj4gPiAgICNkZWZpbmUgICBHTUJVU19TTEFWRV9USU1FT1VUX0VO
ICgxIDw8IDQpCj4gPiAgICNkZWZpbmUgICBHTUJVU19OQUtfRU4JCSgxIDw8IDMpCj4gPiAgICNk
ZWZpbmUgICBHTUJVU19JRExFX0VOCQkoMSA8PCAyKQo+ID4gICAjZGVmaW5lICAgR01CVVNfSFdf
V0FJVF9FTgkoMSA8PCAxKQo+ID4gICAjZGVmaW5lICAgR01CVVNfSFdfUkRZX0VOCSgxIDw8IDAp
Cj4gPiAtI2RlZmluZSBHTUJVUzUJCQlfTU1JTyhkZXZfcHJpdi0+Z3Bpb19tbWlvX2Jhc2UgKyAw
eDUxMjApIC8qIGJ5dGUgaW5kZXggKi8KPiA+ICsjZGVmaW5lIEdNQlVTNQkJCV9NTUlPKGk5MTUt
PmdwaW9fbW1pb19iYXNlICsgMHg1MTIwKSAvKiBieXRlIGluZGV4ICovCj4gPiAgICNkZWZpbmUg
ICBHTUJVU18yQllURV9JTkRFWF9FTgkoMSA8PCAzMSkKPiA+ICAgLyoKPiA+ICAgICogQ2xvY2sg
Y29udHJvbCAmIHBvd2VyIG1hbmFnZW1lbnQKPiA+ICAgICovCj4gPiAtI2RlZmluZSBfRFBMTF9B
IChESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYwMTQpCj4gPiAtI2RlZmluZSBfRFBM
TF9CIChESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYwMTgpCj4gPiAtI2RlZmluZSBf
Q0hWX0RQTExfQyAoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2MDMwKQo+ID4gKyNk
ZWZpbmUgX0RQTExfQSAoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYwMTQpCj4gPiArI2Rl
ZmluZSBfRFBMTF9CIChESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjAxOCkKPiA+ICsjZGVm
aW5lIF9DSFZfRFBMTF9DIChESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjAzMCkKPiA+ICAg
I2RlZmluZSBEUExMKHBpcGUpIF9NTUlPX1BJUEUzKChwaXBlKSwgX0RQTExfQSwgX0RQTExfQiwg
X0NIVl9EUExMX0MpCj4gPiAgICNkZWZpbmUgVkdBMAlfTU1JTygweDYwMDApCj4gPiBAQCAtMzM3
NSw5ICszMzc1LDkgQEAgZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgewo+ID4gICAjZGVmaW5lICAg
U0RWT19NVUxUSVBMSUVSX1NISUZUX0hJUkVTCQk0Cj4gPiAgICNkZWZpbmUgICBTRFZPX01VTFRJ
UExJRVJfU0hJRlRfVkdBCQkwCj4gPiAtI2RlZmluZSBfRFBMTF9BX01EIChESVNQTEFZX01NSU9f
QkFTRShkZXZfcHJpdikgKyAweDYwMWMpCj4gPiAtI2RlZmluZSBfRFBMTF9CX01EIChESVNQTEFZ
X01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYwMjApCj4gPiAtI2RlZmluZSBfQ0hWX0RQTExfQ19N
RCAoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2MDNjKQo+ID4gKyNkZWZpbmUgX0RQ
TExfQV9NRCAoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYwMWMpCj4gPiArI2RlZmluZSBf
RFBMTF9CX01EIChESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjAyMCkKPiA+ICsjZGVmaW5l
IF9DSFZfRFBMTF9DX01EIChESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjAzYykKPiA+ICAg
I2RlZmluZSBEUExMX01EKHBpcGUpIF9NTUlPX1BJUEUzKChwaXBlKSwgX0RQTExfQV9NRCwgX0RQ
TExfQl9NRCwgX0NIVl9EUExMX0NfTUQpCj4gPiAgIC8qCj4gPiBAQCAtMzQ0OSw3ICszNDQ5LDcg
QEAgZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgewo+ID4gICAjZGVmaW5lICBEU1RBVEVfUExMX0Qz
X09GRgkJCSgxIDw8IDMpCj4gPiAgICNkZWZpbmUgIERTVEFURV9HRlhfQ0xPQ0tfR0FUSU5HCQko
MSA8PCAxKQo+ID4gICAjZGVmaW5lICBEU1RBVEVfRE9UX0NMT0NLX0dBVElORwkJKDEgPDwgMCkK
PiA+IC0jZGVmaW5lIERTUENMS19HQVRFX0QJX01NSU8oRElTUExBWV9NTUlPX0JBU0UoZGV2X3By
aXYpICsgMHg2MjAwKQo+ID4gKyNkZWZpbmUgRFNQQ0xLX0dBVEVfRAlfTU1JTyhESVNQTEFZX01N
SU9fQkFTRShpOTE1KSArIDB4NjIwMCkKPiA+ICAgIyBkZWZpbmUgRFBVTklUX0JfQ0xPQ0tfR0FU
RV9ESVNBQkxFCQkoMSA8PCAzMCkgLyogOTY1ICovCj4gPiAgICMgZGVmaW5lIFZTVU5JVF9DTE9D
S19HQVRFX0RJU0FCTEUJCSgxIDw8IDI5KSAvKiA5NjUgKi8KPiA+ICAgIyBkZWZpbmUgVlJIVU5J
VF9DTE9DS19HQVRFX0RJU0FCTEUJCSgxIDw8IDI4KSAvKiA5NjUgKi8KPiA+IEBAIC0zNTg5LDcg
KzM1ODksNyBAQCBlbnVtIGk5MTVfcG93ZXJfd2VsbF9pZCB7Cj4gPiAgICNkZWZpbmUgX1BBTEVU
VEVfQQkJMHhhMDAwCj4gPiAgICNkZWZpbmUgX1BBTEVUVEVfQgkJMHhhODAwCj4gPiAgICNkZWZp
bmUgX0NIVl9QQUxFVFRFX0MJCTB4YzAwMAo+ID4gLSNkZWZpbmUgUEFMRVRURShwaXBlLCBpKQlf
TU1JTyhESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyBcCj4gPiArI2RlZmluZSBQQUxFVFRF
KHBpcGUsIGkpCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgXAo+ID4gICAJCQkJICAg
ICAgX1BJQ0soKHBpcGUpLCBfUEFMRVRURV9BLAkJXAo+ID4gICAJCQkJCSAgICBfUEFMRVRURV9C
LCBfQ0hWX1BBTEVUVEVfQykgKyBcCj4gPiAgIAkJCQkgICAgICAoaSkgKiA0KQo+ID4gQEAgLTM5
MzYsOCArMzkzNiw4IEBAIGVudW0gaTkxNV9wb3dlcl93ZWxsX2lkIHsKPiA+ICAgI2RlZmluZSBJ
TlRFUlZBTF8xXzI4X1VTKHVzKQlyb3VuZHVwKCgodXMpICogMTAwKSA+PiA3LCAyNSkKPiA+ICAg
I2RlZmluZSBJTlRFUlZBTF8xXzMzX1VTKHVzKQkoKCh1cykgKiAzKSAgID4+IDIpCj4gPiAgICNk
ZWZpbmUgSU5URVJWQUxfMF84MzNfVVModXMpCSgoKHVzKSAqIDYpIC8gNSkKPiA+IC0jZGVmaW5l
IEdUX0lOVEVSVkFMX0ZST01fVVMoZGV2X3ByaXYsIHVzKSAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA5ID8gXAo+ID4gLQkJCQkoSVNfR0VOOV9MUChkZXZfcHJpdikgPyBcCj4gPiArI2RlZmluZSBH
VF9JTlRFUlZBTF9GUk9NX1VTKGk5MTUsIHVzKSAoSU5URUxfR0VOKGk5MTUpID49IDkgPyBcCj4g
PiArCQkJCShJU19HRU45X0xQKGk5MTUpID8gXAo+ID4gICAJCQkJSU5URVJWQUxfMF84MzNfVVMo
dXMpIDogXAo+ID4gICAJCQkJSU5URVJWQUxfMV8zM19VUyh1cykpIDogXAo+ID4gICAJCQkJSU5U
RVJWQUxfMV8yOF9VUyh1cykpCj4gPiBAQCAtMzk0NSw4ICszOTQ1LDggQEAgZW51bSBpOTE1X3Bv
d2VyX3dlbGxfaWQgewo+ID4gICAjZGVmaW5lIElOVEVSVkFMXzFfMjhfVE9fVVMoaW50ZXJ2YWwp
ICAoKChpbnRlcnZhbCkgPDwgNykgLyAxMDApCj4gPiAgICNkZWZpbmUgSU5URVJWQUxfMV8zM19U
T19VUyhpbnRlcnZhbCkgICgoKGludGVydmFsKSA8PCAyKSAvIDMpCj4gPiAgICNkZWZpbmUgSU5U
RVJWQUxfMF84MzNfVE9fVVMoaW50ZXJ2YWwpICgoKGludGVydmFsKSAqIDUpICAvIDYpCj4gPiAt
I2RlZmluZSBHVF9QTV9JTlRFUlZBTF9UT19VUyhkZXZfcHJpdiwgaW50ZXJ2YWwpIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDkgPyBcCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgKElT
X0dFTjlfTFAoZGV2X3ByaXYpID8gXAo+ID4gKyNkZWZpbmUgR1RfUE1fSU5URVJWQUxfVE9fVVMo
aTkxNSwgaW50ZXJ2YWwpIChJTlRFTF9HRU4oaTkxNSkgPj0gOSA/IFwKPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAoSVNfR0VOOV9MUChpOTE1KSA/IFwKPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgSU5URVJWQUxfMF84MzNfVE9fVVMoaW50ZXJ2YWwpIDogXAo+ID4gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBJTlRFUlZBTF8xXzMzX1RPX1VTKGludGVydmFsKSkg
OiBcCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElOVEVSVkFMXzFfMjhfVE9fVVMo
aW50ZXJ2YWwpKQo+ID4gQEAgLTQyMTksNyArNDIxOSw3IEBAIGVudW0gewo+ID4gICAvKiBIU1cr
IGVEUCBQU1IgcmVnaXN0ZXJzICovCj4gPiAgICNkZWZpbmUgSFNXX0VEUF9QU1JfQkFTRQkweDY0
ODAwCj4gPiAgICNkZWZpbmUgQkRXX0VEUF9QU1JfQkFTRQkweDZmODAwCj4gPiAtI2RlZmluZSBF
RFBfUFNSX0NUTAkJCQlfTU1JTyhkZXZfcHJpdi0+cHNyX21taW9fYmFzZSArIDApCj4gPiArI2Rl
ZmluZSBFRFBfUFNSX0NUTAkJCQlfTU1JTyhpOTE1LT5wc3JfbW1pb19iYXNlICsgMCkKPiA+ICAg
I2RlZmluZSAgIEVEUF9QU1JfRU5BQkxFCQkJKDEgPDwgMzEpCj4gPiAgICNkZWZpbmUgICBCRFdf
UFNSX1NJTkdMRV9GUkFNRQkJCSgxIDw8IDMwKQo+ID4gICAjZGVmaW5lICAgRURQX1BTUl9SRVNU
T1JFX1BTUl9BQ1RJVkVfQ1RYX01BU0sJKDEgPDwgMjkpIC8qIFNXIGNhbid0IG1vZGlmeSAqLwo+
ID4gQEAgLTQyNTYsMTYgKzQyNTYsMTYgQEAgZW51bSB7Cj4gPiAgICNkZWZpbmUgICBFRFBfUFNS
X1RSQU5TQ09ERVJfQV9TSElGVAkJOAo+ID4gICAjZGVmaW5lICAgRURQX1BTUl9UUkFOU0NPREVS
X0VEUF9TSElGVAkJMAo+ID4gLSNkZWZpbmUgRURQX1BTUl9BVVhfQ1RMCQkJCV9NTUlPKGRldl9w
cml2LT5wc3JfbW1pb19iYXNlICsgMHgxMCkKPiA+ICsjZGVmaW5lIEVEUF9QU1JfQVVYX0NUTAkJ
CQlfTU1JTyhpOTE1LT5wc3JfbW1pb19iYXNlICsgMHgxMCkKPiA+ICAgI2RlZmluZSAgIEVEUF9Q
U1JfQVVYX0NUTF9USU1FX09VVF9NQVNLCQkoMyA8PCAyNikKPiA+ICAgI2RlZmluZSAgIEVEUF9Q
U1JfQVVYX0NUTF9NRVNTQUdFX1NJWkVfTUFTSwkoMHgxZiA8PCAyMCkKPiA+ICAgI2RlZmluZSAg
IEVEUF9QU1JfQVVYX0NUTF9QUkVDSEFSR0VfMlVTX01BU0sJKDB4ZiA8PCAxNikKPiA+ICAgI2Rl
ZmluZSAgIEVEUF9QU1JfQVVYX0NUTF9FUlJPUl9JTlRFUlJVUFQJKDEgPDwgMTEpCj4gPiAgICNk
ZWZpbmUgICBFRFBfUFNSX0FVWF9DVExfQklUX0NMT0NLXzJYX01BU0sJKDB4N2ZmKQo+ID4gLSNk
ZWZpbmUgRURQX1BTUl9BVVhfREFUQShpKQkJCV9NTUlPKGRldl9wcml2LT5wc3JfbW1pb19iYXNl
ICsgMHgxNCArIChpKSAqIDQpIC8qIDUgcmVnaXN0ZXJzICovCj4gPiArI2RlZmluZSBFRFBfUFNS
X0FVWF9EQVRBKGkpCQkJX01NSU8oaTkxNS0+cHNyX21taW9fYmFzZSArIDB4MTQgKyAoaSkgKiA0
KSAvKiA1IHJlZ2lzdGVycyAqLwo+ID4gLSNkZWZpbmUgRURQX1BTUl9TVEFUVVMJCQkJX01NSU8o
ZGV2X3ByaXYtPnBzcl9tbWlvX2Jhc2UgKyAweDQwKQo+ID4gKyNkZWZpbmUgRURQX1BTUl9TVEFU
VVMJCQkJX01NSU8oaTkxNS0+cHNyX21taW9fYmFzZSArIDB4NDApCj4gPiAgICNkZWZpbmUgICBF
RFBfUFNSX1NUQVRVU19TVEFURV9NQVNLCQkoNyA8PCAyOSkKPiA+ICAgI2RlZmluZSAgIEVEUF9Q
U1JfU1RBVFVTX1NUQVRFX1NISUZUCQkyOQo+ID4gICAjZGVmaW5lICAgRURQX1BTUl9TVEFUVVNf
U1RBVEVfSURMRQkJKDAgPDwgMjkpCj4gPiBAQCAtNDI5MCwxMCArNDI5MCwxMCBAQCBlbnVtIHsK
PiA+ICAgI2RlZmluZSAgIEVEUF9QU1JfU1RBVFVTX1NFTkRJTkdfVFAxCQkoMSA8PCA0KQo+ID4g
ICAjZGVmaW5lICAgRURQX1BTUl9TVEFUVVNfSURMRV9NQVNLCQkweGYKPiA+IC0jZGVmaW5lIEVE
UF9QU1JfUEVSRl9DTlQJCV9NTUlPKGRldl9wcml2LT5wc3JfbW1pb19iYXNlICsgMHg0NCkKPiA+
ICsjZGVmaW5lIEVEUF9QU1JfUEVSRl9DTlQJCV9NTUlPKGk5MTUtPnBzcl9tbWlvX2Jhc2UgKyAw
eDQ0KQo+ID4gICAjZGVmaW5lICAgRURQX1BTUl9QRVJGX0NOVF9NQVNLCQkweGZmZmZmZgo+ID4g
LSNkZWZpbmUgRURQX1BTUl9ERUJVRwkJCQlfTU1JTyhkZXZfcHJpdi0+cHNyX21taW9fYmFzZSAr
IDB4NjApIC8qIFBTUl9NQVNLIG9uIFNLTCsgKi8KPiA+ICsjZGVmaW5lIEVEUF9QU1JfREVCVUcJ
CQkJX01NSU8oaTkxNS0+cHNyX21taW9fYmFzZSArIDB4NjApIC8qIFBTUl9NQVNLIG9uIFNLTCsg
Ki8KPiA+ICAgI2RlZmluZSAgIEVEUF9QU1JfREVCVUdfTUFTS19NQVhfU0xFRVAgICAgICAgICAo
MSA8PCAyOCkKPiA+ICAgI2RlZmluZSAgIEVEUF9QU1JfREVCVUdfTUFTS19MUFNQICAgICAgICAg
ICAgICAoMSA8PCAyNykKPiA+ICAgI2RlZmluZSAgIEVEUF9QU1JfREVCVUdfTUFTS19NRU1VUCAg
ICAgICAgICAgICAoMSA8PCAyNikKPiA+IEBAIC00NDA1LDcgKzQ0MDUsNyBAQCBlbnVtIHsKPiA+
ICAgLyogSG90cGx1ZyBjb250cm9sICg5NDUrIG9ubHkpICovCj4gPiAtI2RlZmluZSBQT1JUX0hP
VFBMVUdfRU4JCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjExMTApCj4g
PiArI2RlZmluZSBQT1JUX0hPVFBMVUdfRU4JCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGk5MTUp
ICsgMHg2MTExMCkKPiA+ICAgI2RlZmluZSAgIFBPUlRCX0hPVFBMVUdfSU5UX0VOCQkJKDEgPDwg
MjkpCj4gPiAgICNkZWZpbmUgICBQT1JUQ19IT1RQTFVHX0lOVF9FTgkJCSgxIDw8IDI4KQo+ID4g
ICAjZGVmaW5lICAgUE9SVERfSE9UUExVR19JTlRfRU4JCQkoMSA8PCAyNykKPiA+IEBAIC00NDM1
LDcgKzQ0MzUsNyBAQCBlbnVtIHsKPiA+ICAgI2RlZmluZSBDUlRfSE9UUExVR19ERVRFQ1RfVk9M
VEFHRV8zMjVNVgkoMCA8PCAyKQo+ID4gICAjZGVmaW5lIENSVF9IT1RQTFVHX0RFVEVDVF9WT0xU
QUdFXzQ3NU1WCSgxIDw8IDIpCj4gPiAtI2RlZmluZSBQT1JUX0hPVFBMVUdfU1RBVAlfTU1JTyhE
SVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYxMTE0KQo+ID4gKyNkZWZpbmUgUE9SVF9I
T1RQTFVHX1NUQVQJX01NSU8oRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYxMTE0KQo+ID4g
ICAvKgo+ID4gICAgKiBIRE1JL0RQIGJpdHMgYXJlIGc0eCsKPiA+ICAgICoKPiA+IEBAIC00NTE3
LDcgKzQ1MTcsNyBAQCBlbnVtIHsKPiA+ICAgI2RlZmluZSBQT1JUX0RGVF9JOVhYCQkJCV9NTUlP
KDB4NjExNTApCj4gPiAgICNkZWZpbmUgICBEQ19CQUxBTkNFX1JFU0VUCQkJKDEgPDwgMjUpCj4g
PiAtI2RlZmluZSBQT1JUX0RGVDJfRzRYCQlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShkZXZfcHJp
dikgKyAweDYxMTU0KQo+ID4gKyNkZWZpbmUgUE9SVF9ERlQyX0c0WAkJX01NSU8oRElTUExBWV9N
TUlPX0JBU0UoaTkxNSkgKyAweDYxMTU0KQo+ID4gICAjZGVmaW5lICAgRENfQkFMQU5DRV9SRVNF
VF9WTFYJCQkoMSA8PCAzMSkKPiA+ICAgI2RlZmluZSAgIFBJUEVfU0NSQU1CTEVfUkVTRVRfTUFT
SwkJKCgxIDw8IDE0KSB8ICgweDMgPDwgMCkpCj4gPiAgICNkZWZpbmUgICBQSVBFX0NfU0NSQU1C
TEVfUkVTRVQJCQkoMSA8PCAxNCkgLyogY2h2ICovCj4gPiBAQCAtNDcxOSw3ICs0NzE5LDcgQEAg
ZW51bSB7Cj4gPiAgICNkZWZpbmUgVkxWX1BQU19CQVNFCQkJKFZMVl9ESVNQTEFZX0JBU0UgKyBQ
UFNfQkFTRSkKPiA+ICAgI2RlZmluZSBQQ0hfUFBTX0JBU0UJCQkweEM3MjAwCj4gPiAtI2RlZmlu
ZSBfTU1JT19QUFMocHBzX2lkeCwgcmVnKQkJX01NSU8oZGV2X3ByaXYtPnBwc19tbWlvX2Jhc2Ug
LQlcCj4gPiArI2RlZmluZSBfTU1JT19QUFMocHBzX2lkeCwgcmVnKQkJX01NSU8oaTkxNS0+cHBz
X21taW9fYmFzZSAtCVwKPiA+ICAgCQkJCQkgICAgICBQUFNfQkFTRSArIChyZWcpICsJXAo+ID4g
ICAJCQkJCSAgICAgIChwcHNfaWR4KSAqIDB4MTAwKQo+ID4gQEAgLTQ3OTIsNyArNDc5Miw3IEBA
IGVudW0gewo+ID4gICAjZGVmaW5lICBQQU5FTF9QT1dFUl9DWUNMRV9ERUxBWV9NQVNLCVJFR19H
RU5NQVNLKDQsIDApCj4gPiAgIC8qIFBhbmVsIGZpdHRpbmcgKi8KPiA+IC0jZGVmaW5lIFBGSVRf
Q09OVFJPTAlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYxMjMwKQo+ID4g
KyNkZWZpbmUgUEZJVF9DT05UUk9MCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2
MTIzMCkKPiA+ICAgI2RlZmluZSAgIFBGSVRfRU5BQkxFCQkoMSA8PCAzMSkKPiA+ICAgI2RlZmlu
ZSAgIFBGSVRfUElQRV9NQVNLCSgzIDw8IDI5KQo+ID4gICAjZGVmaW5lICAgUEZJVF9QSVBFX1NI
SUZUCTI5Cj4gPiBAQCAtNDgxMCw3ICs0ODEwLDcgQEAgZW51bSB7Cj4gPiAgICNkZWZpbmUgICBQ
RklUX1NDQUxJTkdfUFJPR1JBTU1FRCAoMSA8PCAyNikKPiA+ICAgI2RlZmluZSAgIFBGSVRfU0NB
TElOR19QSUxMQVIJKDIgPDwgMjYpCj4gPiAgICNkZWZpbmUgICBQRklUX1NDQUxJTkdfTEVUVEVS
CSgzIDw8IDI2KQo+ID4gLSNkZWZpbmUgUEZJVF9QR01fUkFUSU9TIF9NTUlPKERJU1BMQVlfTU1J
T19CQVNFKGRldl9wcml2KSArIDB4NjEyMzQpCj4gPiArI2RlZmluZSBQRklUX1BHTV9SQVRJT1Mg
X01NSU8oRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDYxMjM0KQo+ID4gICAvKiBQcmUtOTY1
ICovCj4gPiAgICNkZWZpbmUJCVBGSVRfVkVSVF9TQ0FMRV9TSElGVAkJMjAKPiA+ICAgI2RlZmlu
ZQkJUEZJVF9WRVJUX1NDQUxFX01BU0sJCTB4ZmZmMDAwMDAKPiA+IEBAIC00ODIyLDI1ICs0ODIy
LDI1IEBAIGVudW0gewo+ID4gICAjZGVmaW5lCQlQRklUX0hPUklaX1NDQUxFX1NISUZUXzk2NQkw
Cj4gPiAgICNkZWZpbmUJCVBGSVRfSE9SSVpfU0NBTEVfTUFTS185NjUJMHgwMDAwMWZmZgo+ID4g
LSNkZWZpbmUgUEZJVF9BVVRPX1JBVElPUyBfTU1JTyhESVNQTEFZX01NSU9fQkFTRShkZXZfcHJp
dikgKyAweDYxMjM4KQo+ID4gKyNkZWZpbmUgUEZJVF9BVVRPX1JBVElPUyBfTU1JTyhESVNQTEFZ
X01NSU9fQkFTRShpOTE1KSArIDB4NjEyMzgpCj4gPiAtI2RlZmluZSBfVkxWX0JMQ19QV01fQ1RM
Ml9BIChESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYxMjUwKQo+ID4gLSNkZWZpbmUg
X1ZMVl9CTENfUFdNX0NUTDJfQiAoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2MTM1
MCkKPiA+ICsjZGVmaW5lIF9WTFZfQkxDX1BXTV9DVEwyX0EgKERJU1BMQVlfTU1JT19CQVNFKGk5
MTUpICsgMHg2MTI1MCkKPiA+ICsjZGVmaW5lIF9WTFZfQkxDX1BXTV9DVEwyX0IgKERJU1BMQVlf
TU1JT19CQVNFKGk5MTUpICsgMHg2MTM1MCkKPiA+ICAgI2RlZmluZSBWTFZfQkxDX1BXTV9DVEwy
KHBpcGUpIF9NTUlPX1BJUEUocGlwZSwgX1ZMVl9CTENfUFdNX0NUTDJfQSwgXAo+ID4gICAJCQkJ
CSBfVkxWX0JMQ19QV01fQ1RMMl9CKQo+ID4gLSNkZWZpbmUgX1ZMVl9CTENfUFdNX0NUTF9BIChE
SVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYxMjU0KQo+ID4gLSNkZWZpbmUgX1ZMVl9C
TENfUFdNX0NUTF9CIChESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDYxMzU0KQo+ID4g
KyNkZWZpbmUgX1ZMVl9CTENfUFdNX0NUTF9BIChESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4
NjEyNTQpCj4gPiArI2RlZmluZSBfVkxWX0JMQ19QV01fQ1RMX0IgKERJU1BMQVlfTU1JT19CQVNF
KGk5MTUpICsgMHg2MTM1NCkKPiA+ICAgI2RlZmluZSBWTFZfQkxDX1BXTV9DVEwocGlwZSkgX01N
SU9fUElQRShwaXBlLCBfVkxWX0JMQ19QV01fQ1RMX0EsIFwKPiA+ICAgCQkJCQlfVkxWX0JMQ19Q
V01fQ1RMX0IpCj4gPiAtI2RlZmluZSBfVkxWX0JMQ19ISVNUX0NUTF9BIChESVNQTEFZX01NSU9f
QkFTRShkZXZfcHJpdikgKyAweDYxMjYwKQo+ID4gLSNkZWZpbmUgX1ZMVl9CTENfSElTVF9DVExf
QiAoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2MTM2MCkKPiA+ICsjZGVmaW5lIF9W
TFZfQkxDX0hJU1RfQ1RMX0EgKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2MTI2MCkKPiA+
ICsjZGVmaW5lIF9WTFZfQkxDX0hJU1RfQ1RMX0IgKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsg
MHg2MTM2MCkKPiA+ICAgI2RlZmluZSBWTFZfQkxDX0hJU1RfQ1RMKHBpcGUpIF9NTUlPX1BJUEUo
cGlwZSwgX1ZMVl9CTENfSElTVF9DVExfQSwgXAo+ID4gICAJCQkJCSBfVkxWX0JMQ19ISVNUX0NU
TF9CKQo+ID4gICAvKiBCYWNrbGlnaHQgY29udHJvbCAqLwo+ID4gLSNkZWZpbmUgQkxDX1BXTV9D
VEwyCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjEyNTApIC8qIDk2NSsg
b25seSAqLwo+ID4gKyNkZWZpbmUgQkxDX1BXTV9DVEwyCV9NTUlPKERJU1BMQVlfTU1JT19CQVNF
KGk5MTUpICsgMHg2MTI1MCkgLyogOTY1KyBvbmx5ICovCj4gPiAgICNkZWZpbmUgICBCTE1fUFdN
X0VOQUJMRQkJKDEgPDwgMzEpCj4gPiAgICNkZWZpbmUgICBCTE1fQ09NQklOQVRJT05fTU9ERQkJ
KDEgPDwgMzApIC8qIGdlbjQgb25seSAqLwo+ID4gICAjZGVmaW5lICAgQkxNX1BJUEVfU0VMRUNU
CQkoMSA8PCAyOSkKPiA+IEBAIC00ODYzLDcgKzQ4NjMsNyBAQCBlbnVtIHsKPiA+ICAgI2RlZmlu
ZSAgIEJMTV9QSEFTRV9JTl9DT1VOVF9NQVNLCSgweGZmIDw8IDgpCj4gPiAgICNkZWZpbmUgICBC
TE1fUEhBU0VfSU5fSU5DUl9TSElGVAkoMCkKPiA+ICAgI2RlZmluZSAgIEJMTV9QSEFTRV9JTl9J
TkNSX01BU0sJKDB4ZmYgPDwgMCkKPiA+IC0jZGVmaW5lIEJMQ19QV01fQ1RMCV9NTUlPKERJU1BM
QVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjEyNTQpCj4gPiArI2RlZmluZSBCTENfUFdNX0NU
TAlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjEyNTQpCj4gPiAgIC8qCj4gPiAg
ICAqIFRoaXMgaXMgdGhlIG1vc3Qgc2lnbmlmaWNhbnQgMTUgYml0cyBvZiB0aGUgbnVtYmVyIG9m
IGJhY2tsaWdodCBjeWNsZXMgaW4gYQo+ID4gICAgKiBjb21wbGV0ZSBjeWNsZSBvZiB0aGUgbW9k
dWxhdGVkIGJhY2tsaWdodCBjb250cm9sLgo+ID4gQEAgLTQ4ODUsNyArNDg4NSw3IEBAIGVudW0g
ewo+ID4gICAjZGVmaW5lICAgQkFDS0xJR0hUX0RVVFlfQ1lDTEVfTUFTS19QTlYJCSgweGZmZmUp
Cj4gPiAgICNkZWZpbmUgICBCTE1fUE9MQVJJVFlfUE5WCQkJKDEgPDwgMCkgLyogcG52IG9ubHkg
Ki8KPiA+IC0jZGVmaW5lIEJMQ19ISVNUX0NUTAlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShkZXZf
cHJpdikgKyAweDYxMjYwKQo+ID4gKyNkZWZpbmUgQkxDX0hJU1RfQ1RMCV9NTUlPKERJU1BMQVlf
TU1JT19CQVNFKGk5MTUpICsgMHg2MTI2MCkKPiA+ICAgI2RlZmluZSAgQkxNX0hJU1RPR1JBTV9F
TkFCTEUJCQkoMSA8PCAzMSkKPiA+ICAgLyogTmV3IHJlZ2lzdGVycyBmb3IgUENILXNwbGl0IHBs
YXRmb3Jtcy4gU2FmZSB3aGVyZSBuZXcgYml0cyBzaG93IHVwLCB0aGUKPiA+IEBAIC01NTEwLDQ3
ICs1NTEwLDQ3IEBAIGVudW0gewo+ID4gICAgKiBpcyAyMCBieXRlcyBpbiBlYWNoIGRpcmVjdGlv
biwgaGVuY2UgdGhlIDUgZml4ZWQKPiA+ICAgICogZGF0YSByZWdpc3RlcnMKPiA+ICAgICovCj4g
PiAtI2RlZmluZSBfRFBBX0FVWF9DSF9DVEwJCShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikg
KyAweDY0MDEwKQo+ID4gLSNkZWZpbmUgX0RQQV9BVVhfQ0hfREFUQTEJKERJU1BMQVlfTU1JT19C
QVNFKGRldl9wcml2KSArIDB4NjQwMTQpCj4gPiAtI2RlZmluZSBfRFBBX0FVWF9DSF9EQVRBMgko
RElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2NDAxOCkKPiA+IC0jZGVmaW5lIF9EUEFf
QVVYX0NIX0RBVEEzCShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDY0MDFjKQo+ID4g
LSNkZWZpbmUgX0RQQV9BVVhfQ0hfREFUQTQJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSAr
IDB4NjQwMjApCj4gPiAtI2RlZmluZSBfRFBBX0FVWF9DSF9EQVRBNQkoRElTUExBWV9NTUlPX0JB
U0UoZGV2X3ByaXYpICsgMHg2NDAyNCkKPiA+IC0KPiA+IC0jZGVmaW5lIF9EUEJfQVVYX0NIX0NU
TAkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQxMTApCj4gPiAtI2RlZmluZSBf
RFBCX0FVWF9DSF9EQVRBMQkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2NDExNCkK
PiA+IC0jZGVmaW5lIF9EUEJfQVVYX0NIX0RBVEEyCShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJp
dikgKyAweDY0MTE4KQo+ID4gLSNkZWZpbmUgX0RQQl9BVVhfQ0hfREFUQTMJKERJU1BMQVlfTU1J
T19CQVNFKGRldl9wcml2KSArIDB4NjQxMWMpCj4gPiAtI2RlZmluZSBfRFBCX0FVWF9DSF9EQVRB
NAkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2NDEyMCkKPiA+IC0jZGVmaW5lIF9E
UEJfQVVYX0NIX0RBVEE1CShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDY0MTI0KQo+
ID4gLQo+ID4gLSNkZWZpbmUgX0RQQ19BVVhfQ0hfQ1RMCQkoRElTUExBWV9NTUlPX0JBU0UoZGV2
X3ByaXYpICsgMHg2NDIxMCkKPiA+IC0jZGVmaW5lIF9EUENfQVVYX0NIX0RBVEExCShESVNQTEFZ
X01NSU9fQkFTRShkZXZfcHJpdikgKyAweDY0MjE0KQo+ID4gLSNkZWZpbmUgX0RQQ19BVVhfQ0hf
REFUQTIJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQyMTgpCj4gPiAtI2RlZmlu
ZSBfRFBDX0FVWF9DSF9EQVRBMwkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2NDIx
YykKPiA+IC0jZGVmaW5lIF9EUENfQVVYX0NIX0RBVEE0CShESVNQTEFZX01NSU9fQkFTRShkZXZf
cHJpdikgKyAweDY0MjIwKQo+ID4gLSNkZWZpbmUgX0RQQ19BVVhfQ0hfREFUQTUJKERJU1BMQVlf
TU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQyMjQpCj4gPiAtCj4gPiAtI2RlZmluZSBfRFBEX0FV
WF9DSF9DVEwJCShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDY0MzEwKQo+ID4gLSNk
ZWZpbmUgX0RQRF9BVVhfQ0hfREFUQTEJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4
NjQzMTQpCj4gPiAtI2RlZmluZSBfRFBEX0FVWF9DSF9EQVRBMgkoRElTUExBWV9NTUlPX0JBU0Uo
ZGV2X3ByaXYpICsgMHg2NDMxOCkKPiA+IC0jZGVmaW5lIF9EUERfQVVYX0NIX0RBVEEzCShESVNQ
TEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDY0MzFjKQo+ID4gLSNkZWZpbmUgX0RQRF9BVVhf
Q0hfREFUQTQJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NjQzMjApCj4gPiAtI2Rl
ZmluZSBfRFBEX0FVWF9DSF9EQVRBNQkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2
NDMyNCkKPiA+IC0KPiA+IC0jZGVmaW5lIF9EUEVfQVVYX0NIX0NUTAkJKERJU1BMQVlfTU1JT19C
QVNFKGRldl9wcml2KSArIDB4NjQ0MTApCj4gPiAtI2RlZmluZSBfRFBFX0FVWF9DSF9EQVRBMQko
RElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2NDQxNCkKPiA+IC0jZGVmaW5lIF9EUEVf
QVVYX0NIX0RBVEEyCShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDY0NDE4KQo+ID4g
LSNkZWZpbmUgX0RQRV9BVVhfQ0hfREFUQTMJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSAr
IDB4NjQ0MWMpCj4gPiAtI2RlZmluZSBfRFBFX0FVWF9DSF9EQVRBNAkoRElTUExBWV9NTUlPX0JB
U0UoZGV2X3ByaXYpICsgMHg2NDQyMCkKPiA+IC0jZGVmaW5lIF9EUEVfQVVYX0NIX0RBVEE1CShE
SVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDY0NDI0KQo+ID4gLQo+ID4gLSNkZWZpbmUg
X0RQRl9BVVhfQ0hfQ1RMCQkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2NDUxMCkK
PiA+IC0jZGVmaW5lIF9EUEZfQVVYX0NIX0RBVEExCShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJp
dikgKyAweDY0NTE0KQo+ID4gLSNkZWZpbmUgX0RQRl9BVVhfQ0hfREFUQTIJKERJU1BMQVlfTU1J
T19CQVNFKGRldl9wcml2KSArIDB4NjQ1MTgpCj4gPiAtI2RlZmluZSBfRFBGX0FVWF9DSF9EQVRB
MwkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2NDUxYykKPiA+IC0jZGVmaW5lIF9E
UEZfQVVYX0NIX0RBVEE0CShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDY0NTIwKQo+
ID4gLSNkZWZpbmUgX0RQRl9BVVhfQ0hfREFUQTUJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2
KSArIDB4NjQ1MjQpCj4gPiArI2RlZmluZSBfRFBBX0FVWF9DSF9DVEwJCShESVNQTEFZX01NSU9f
QkFTRShpOTE1KSArIDB4NjQwMTApCj4gPiArI2RlZmluZSBfRFBBX0FVWF9DSF9EQVRBMQkoRElT
UExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0MDE0KQo+ID4gKyNkZWZpbmUgX0RQQV9BVVhfQ0hf
REFUQTIJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDAxOCkKPiA+ICsjZGVmaW5lIF9E
UEFfQVVYX0NIX0RBVEEzCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQwMWMpCj4gPiAr
I2RlZmluZSBfRFBBX0FVWF9DSF9EQVRBNAkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0
MDIwKQo+ID4gKyNkZWZpbmUgX0RQQV9BVVhfQ0hfREFUQTUJKERJU1BMQVlfTU1JT19CQVNFKGk5
MTUpICsgMHg2NDAyNCkKPiA+ICsKPiA+ICsjZGVmaW5lIF9EUEJfQVVYX0NIX0NUTAkJKERJU1BM
QVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDExMCkKPiA+ICsjZGVmaW5lIF9EUEJfQVVYX0NIX0RB
VEExCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQxMTQpCj4gPiArI2RlZmluZSBfRFBC
X0FVWF9DSF9EQVRBMgkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0MTE4KQo+ID4gKyNk
ZWZpbmUgX0RQQl9BVVhfQ0hfREFUQTMJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDEx
YykKPiA+ICsjZGVmaW5lIF9EUEJfQVVYX0NIX0RBVEE0CShESVNQTEFZX01NSU9fQkFTRShpOTE1
KSArIDB4NjQxMjApCj4gPiArI2RlZmluZSBfRFBCX0FVWF9DSF9EQVRBNQkoRElTUExBWV9NTUlP
X0JBU0UoaTkxNSkgKyAweDY0MTI0KQo+ID4gKwo+ID4gKyNkZWZpbmUgX0RQQ19BVVhfQ0hfQ1RM
CQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0MjEwKQo+ID4gKyNkZWZpbmUgX0RQQ19B
VVhfQ0hfREFUQTEJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDIxNCkKPiA+ICsjZGVm
aW5lIF9EUENfQVVYX0NIX0RBVEEyCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQyMTgp
Cj4gPiArI2RlZmluZSBfRFBDX0FVWF9DSF9EQVRBMwkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkg
KyAweDY0MjFjKQo+ID4gKyNkZWZpbmUgX0RQQ19BVVhfQ0hfREFUQTQJKERJU1BMQVlfTU1JT19C
QVNFKGk5MTUpICsgMHg2NDIyMCkKPiA+ICsjZGVmaW5lIF9EUENfQVVYX0NIX0RBVEE1CShESVNQ
TEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQyMjQpCj4gPiArCj4gPiArI2RlZmluZSBfRFBEX0FV
WF9DSF9DVEwJCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQzMTApCj4gPiArI2RlZmlu
ZSBfRFBEX0FVWF9DSF9EQVRBMQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0MzE0KQo+
ID4gKyNkZWZpbmUgX0RQRF9BVVhfQ0hfREFUQTIJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsg
MHg2NDMxOCkKPiA+ICsjZGVmaW5lIF9EUERfQVVYX0NIX0RBVEEzCShESVNQTEFZX01NSU9fQkFT
RShpOTE1KSArIDB4NjQzMWMpCj4gPiArI2RlZmluZSBfRFBEX0FVWF9DSF9EQVRBNAkoRElTUExB
WV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0MzIwKQo+ID4gKyNkZWZpbmUgX0RQRF9BVVhfQ0hfREFU
QTUJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDMyNCkKPiA+ICsKPiA+ICsjZGVmaW5l
IF9EUEVfQVVYX0NIX0NUTAkJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDQxMCkKPiA+
ICsjZGVmaW5lIF9EUEVfQVVYX0NIX0RBVEExCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4
NjQ0MTQpCj4gPiArI2RlZmluZSBfRFBFX0FVWF9DSF9EQVRBMgkoRElTUExBWV9NTUlPX0JBU0Uo
aTkxNSkgKyAweDY0NDE4KQo+ID4gKyNkZWZpbmUgX0RQRV9BVVhfQ0hfREFUQTMJKERJU1BMQVlf
TU1JT19CQVNFKGk5MTUpICsgMHg2NDQxYykKPiA+ICsjZGVmaW5lIF9EUEVfQVVYX0NIX0RBVEE0
CShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQ0MjApCj4gPiArI2RlZmluZSBfRFBFX0FV
WF9DSF9EQVRBNQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0NDI0KQo+ID4gKwo+ID4g
KyNkZWZpbmUgX0RQRl9BVVhfQ0hfQ1RMCQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0
NTEwKQo+ID4gKyNkZWZpbmUgX0RQRl9BVVhfQ0hfREFUQTEJKERJU1BMQVlfTU1JT19CQVNFKGk5
MTUpICsgMHg2NDUxNCkKPiA+ICsjZGVmaW5lIF9EUEZfQVVYX0NIX0RBVEEyCShESVNQTEFZX01N
SU9fQkFTRShpOTE1KSArIDB4NjQ1MTgpCj4gPiArI2RlZmluZSBfRFBGX0FVWF9DSF9EQVRBMwko
RElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDY0NTFjKQo+ID4gKyNkZWZpbmUgX0RQRl9BVVhf
Q0hfREFUQTQJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg2NDUyMCkKPiA+ICsjZGVmaW5l
IF9EUEZfQVVYX0NIX0RBVEE1CShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4NjQ1MjQpCj4g
PiAgICNkZWZpbmUgRFBfQVVYX0NIX0NUTChhdXhfY2gpCV9NTUlPX1BPUlQoYXV4X2NoLCBfRFBB
X0FVWF9DSF9DVEwsIF9EUEJfQVVYX0NIX0NUTCkKPiA+ICAgI2RlZmluZSBEUF9BVVhfQ0hfREFU
QShhdXhfY2gsIGkpCV9NTUlPKF9QT1JUKGF1eF9jaCwgX0RQQV9BVVhfQ0hfREFUQTEsIF9EUEJf
QVVYX0NIX0RBVEExKSArIChpKSAqIDQpIC8qIDUgcmVnaXN0ZXJzICovCj4gPiBAQCAtNTg0Myw3
ICs1ODQzLDcgQEAgZW51bSB7Cj4gPiAgICNkZWZpbmUgICBEUElOVkdUVF9TVEFUVVNfTUFTSwkJ
CTB4ZmYKPiA+ICAgI2RlZmluZSAgIERQSU5WR1RUX1NUQVRVU19NQVNLX0NIVgkJMHhmZmYKPiA+
IC0jZGVmaW5lIERTUEFSQgkJCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4
NzAwMzApCj4gPiArI2RlZmluZSBEU1BBUkIJCQlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShpOTE1
KSArIDB4NzAwMzApCj4gPiAgICNkZWZpbmUgICBEU1BBUkJfQ1NUQVJUX01BU0sJKDB4N2YgPDwg
NykKPiA+ICAgI2RlZmluZSAgIERTUEFSQl9DU1RBUlRfU0hJRlQJNwo+ID4gICAjZGVmaW5lICAg
RFNQQVJCX0JTVEFSVF9NQVNLCSgweDdmKQo+ID4gQEAgLTU4NzgsNyArNTg3OCw3IEBAIGVudW0g
ewo+ID4gICAjZGVmaW5lICAgRFNQQVJCX1NQUklURUZfTUFTS19WTFYJKDB4ZmYgPDwgOCkKPiA+
ICAgLyogcG52L2dlbjQvZzR4L3Zsdi9jaHYgKi8KPiA+IC0jZGVmaW5lIERTUEZXMQkJX01NSU8o
RElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg3MDAzNCkKPiA+ICsjZGVmaW5lIERTUEZX
MQkJX01NSU8oRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDcwMDM0KQo+ID4gICAjZGVmaW5l
ICAgRFNQRldfU1JfU0hJRlQJCTIzCj4gPiAgICNkZWZpbmUgICBEU1BGV19TUl9NQVNLCQkJKDB4
MWZmIDw8IDIzKQo+ID4gICAjZGVmaW5lICAgRFNQRldfQ1VSU09SQl9TSElGVAkJMTYKPiA+IEBA
IC01ODg5LDcgKzU4ODksNyBAQCBlbnVtIHsKPiA+ICAgI2RlZmluZSAgIERTUEZXX1BMQU5FQV9T
SElGVAkJMAo+ID4gICAjZGVmaW5lICAgRFNQRldfUExBTkVBX01BU0sJCSgweDdmIDw8IDApCj4g
PiAgICNkZWZpbmUgICBEU1BGV19QTEFORUFfTUFTS19WTFYJCSgweGZmIDw8IDApIC8qIHZsdi9j
aHYgKi8KPiA+IC0jZGVmaW5lIERTUEZXMgkJX01NSU8oRElTUExBWV9NTUlPX0JBU0UoZGV2X3By
aXYpICsgMHg3MDAzOCkKPiA+ICsjZGVmaW5lIERTUEZXMgkJX01NSU8oRElTUExBWV9NTUlPX0JB
U0UoaTkxNSkgKyAweDcwMDM4KQo+ID4gICAjZGVmaW5lICAgRFNQRldfRkJDX1NSX0VOCQkoMSA8
PCAzMSkJICAvKiBnNHggKi8KPiA+ICAgI2RlZmluZSAgIERTUEZXX0ZCQ19TUl9TSElGVAkJMjgK
PiA+ICAgI2RlZmluZSAgIERTUEZXX0ZCQ19TUl9NQVNLCQkoMHg3IDw8IDI4KSAvKiBnNHggKi8K
PiA+IEBAIC01OTA1LDcgKzU5MDUsNyBAQCBlbnVtIHsKPiA+ICAgI2RlZmluZSAgIERTUEZXX1NQ
UklURUFfU0hJRlQJCTAKPiA+ICAgI2RlZmluZSAgIERTUEZXX1NQUklURUFfTUFTSwkJKDB4N2Yg
PDwgMCkgLyogZzR4ICovCj4gPiAgICNkZWZpbmUgICBEU1BGV19TUFJJVEVBX01BU0tfVkxWCSgw
eGZmIDw8IDApIC8qIHZsdi9jaHYgKi8KPiA+IC0jZGVmaW5lIERTUEZXMwkJX01NSU8oRElTUExB
WV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg3MDAzYykKPiA+ICsjZGVmaW5lIERTUEZXMwkJX01N
SU8oRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDcwMDNjKQo+ID4gICAjZGVmaW5lICAgRFNQ
RldfSFBMTF9TUl9FTgkJKDEgPDwgMzEpCj4gPiAgICNkZWZpbmUgICBQSU5FVklFV19TRUxGX1JF
RlJFU0hfRU4JKDEgPDwgMzApCj4gPiAgICNkZWZpbmUgICBEU1BGV19DVVJTT1JfU1JfU0hJRlQJ
CTI0Cj4gPiBAQCAtNjMyMiwzNSArNjMyMiwzNSBAQCBlbnVtIHsKPiA+ICAgICogWzEwOjFmXSBh
bGwKPiA+ICAgICogWzMwOjMyXSBhbGwKPiA+ICAgICovCj4gPiAtI2RlZmluZSBTV0YwKGkpCV9N
TUlPKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NzA0MTAgKyAoaSkgKiA0KQo+ID4g
LSNkZWZpbmUgU1dGMShpKQlfTU1JTyhESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDcx
NDEwICsgKGkpICogNCkKPiA+IC0jZGVmaW5lIFNXRjMoaSkJX01NSU8oRElTUExBWV9NTUlPX0JB
U0UoZGV2X3ByaXYpICsgMHg3MjQxNCArIChpKSAqIDQpCj4gPiArI2RlZmluZSBTV0YwKGkpCV9N
TUlPKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg3MDQxMCArIChpKSAqIDQpCj4gPiArI2Rl
ZmluZSBTV0YxKGkpCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg3MTQxMCArIChp
KSAqIDQpCj4gPiArI2RlZmluZSBTV0YzKGkpCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGk5MTUp
ICsgMHg3MjQxNCArIChpKSAqIDQpCj4gPiAgICNkZWZpbmUgU1dGX0lMSyhpKQlfTU1JTygweDRG
MDAwICsgKGkpICogNCkKPiA+ICAgLyogUGlwZSBCICovCj4gPiAtI2RlZmluZSBfUElQRUJEU0wJ
CShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDcxMDAwKQo+ID4gLSNkZWZpbmUgX1BJ
UEVCQ09ORgkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2KSArIDB4NzEwMDgpCj4gPiAtI2Rl
ZmluZSBfUElQRUJTVEFUCQkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg3MTAyNCkK
PiA+ICsjZGVmaW5lIF9QSVBFQkRTTAkJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg3MTAw
MCkKPiA+ICsjZGVmaW5lIF9QSVBFQkNPTkYJCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSArIDB4
NzEwMDgpCj4gPiArI2RlZmluZSBfUElQRUJTVEFUCQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkg
KyAweDcxMDI0KQo+ID4gICAjZGVmaW5lIF9QSVBFQkZSQU1FSElHSAkJMHg3MTA0MAo+ID4gICAj
ZGVmaW5lIF9QSVBFQkZSQU1FUElYRUwJMHg3MTA0NAo+ID4gLSNkZWZpbmUgX1BJUEVCX0ZSTUNP
VU5UX0c0WAkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg3MTA0MCkKPiA+IC0jZGVm
aW5lIF9QSVBFQl9GTElQQ09VTlRfRzRYCShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAw
eDcxMDQ0KQo+ID4gKyNkZWZpbmUgX1BJUEVCX0ZSTUNPVU5UX0c0WAkoRElTUExBWV9NTUlPX0JB
U0UoaTkxNSkgKyAweDcxMDQwKQo+ID4gKyNkZWZpbmUgX1BJUEVCX0ZMSVBDT1VOVF9HNFgJKERJ
U1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg3MTA0NCkKPiA+ICAgLyogRGlzcGxheSBCIGNvbnRy
b2wgKi8KPiA+IC0jZGVmaW5lIF9EU1BCQ05UUgkJKERJU1BMQVlfTU1JT19CQVNFKGRldl9wcml2
KSArIDB4NzExODApCj4gPiArI2RlZmluZSBfRFNQQkNOVFIJCShESVNQTEFZX01NSU9fQkFTRShp
OTE1KSArIDB4NzExODApCj4gPiAgICNkZWZpbmUgICBESVNQUExBTkVfQUxQSEFfVFJBTlNfRU5B
QkxFCQkoMSA8PCAxNSkKPiA+ICAgI2RlZmluZSAgIERJU1BQTEFORV9BTFBIQV9UUkFOU19ESVNB
QkxFCQkwCj4gPiAgICNkZWZpbmUgICBESVNQUExBTkVfU1BSSVRFX0FCT1ZFX0RJU1BMQVkJMAo+
ID4gICAjZGVmaW5lICAgRElTUFBMQU5FX1NQUklURV9BQk9WRV9PVkVSTEFZCSgxKQo+ID4gLSNk
ZWZpbmUgX0RTUEJBRERSCQkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg3MTE4NCkK
PiA+IC0jZGVmaW5lIF9EU1BCU1RSSURFCQkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsg
MHg3MTE4OCkKPiA+IC0jZGVmaW5lIF9EU1BCUE9TCQkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3By
aXYpICsgMHg3MTE4QykKPiA+IC0jZGVmaW5lIF9EU1BCU0laRQkJKERJU1BMQVlfTU1JT19CQVNF
KGRldl9wcml2KSArIDB4NzExOTApCj4gPiAtI2RlZmluZSBfRFNQQlNVUkYJCShESVNQTEFZX01N
SU9fQkFTRShkZXZfcHJpdikgKyAweDcxMTlDKQo+ID4gLSNkZWZpbmUgX0RTUEJUSUxFT0ZGCQko
RElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg3MTFBNCkKPiA+IC0jZGVmaW5lIF9EU1BC
T0ZGU0VUCQkoRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg3MTFBNCkKPiA+IC0jZGVm
aW5lIF9EU1BCU1VSRkxJVkUJCShESVNQTEFZX01NSU9fQkFTRShkZXZfcHJpdikgKyAweDcxMUFD
KQo+ID4gKyNkZWZpbmUgX0RTUEJBRERSCQkoRElTUExBWV9NTUlPX0JBU0UoaTkxNSkgKyAweDcx
MTg0KQo+ID4gKyNkZWZpbmUgX0RTUEJTVFJJREUJCShESVNQTEFZX01NSU9fQkFTRShpOTE1KSAr
IDB4NzExODgpCj4gPiArI2RlZmluZSBfRFNQQlBPUwkJKERJU1BMQVlfTU1JT19CQVNFKGk5MTUp
ICsgMHg3MTE4QykKPiA+ICsjZGVmaW5lIF9EU1BCU0laRQkJKERJU1BMQVlfTU1JT19CQVNFKGk5
MTUpICsgMHg3MTE5MCkKPiA+ICsjZGVmaW5lIF9EU1BCU1VSRgkJKERJU1BMQVlfTU1JT19CQVNF
KGk5MTUpICsgMHg3MTE5QykKPiA+ICsjZGVmaW5lIF9EU1BCVElMRU9GRgkJKERJU1BMQVlfTU1J
T19CQVNFKGk5MTUpICsgMHg3MTFBNCkKPiA+ICsjZGVmaW5lIF9EU1BCT0ZGU0VUCQkoRElTUExB
WV9NTUlPX0JBU0UoaTkxNSkgKyAweDcxMUE0KQo+ID4gKyNkZWZpbmUgX0RTUEJTVVJGTElWRQkJ
KERJU1BMQVlfTU1JT19CQVNFKGk5MTUpICsgMHg3MTFBQykKPiA+ICAgLyogSUNMIERTSSAwIGFu
ZCAxICovCj4gPiAgICNkZWZpbmUgX1BJUEVEU0kwQ09ORgkJMHg3YjAwOAo+ID4gQEAgLTg5NDYs
NyArODk0Niw3IEBAIGVudW0gewo+ID4gICAjZGVmaW5lICAgR0VOOV9FTkFCTEVfR1BHUFVfUFJF
RU1QVElPTgkoMSA8PCAyKQo+ID4gICAvKiBBdWRpbyAqLwo+ID4gLSNkZWZpbmUgRzRYX0FVRF9W
SURfRElECQkJX01NSU8oRElTUExBWV9NTUlPX0JBU0UoZGV2X3ByaXYpICsgMHg2MjAyMCkKPiA+
ICsjZGVmaW5lIEc0WF9BVURfVklEX0RJRAkJCV9NTUlPKERJU1BMQVlfTU1JT19CQVNFKGk5MTUp
ICsgMHg2MjAyMCkKPiA+ICAgI2RlZmluZSAgIElOVEVMX0FVRElPX0RFVkNMCQkweDgwODYyOUZC
Cj4gPiAgICNkZWZpbmUgICBJTlRFTF9BVURJT19ERVZCTEMJCTB4ODA4NjI4MDEKPiA+ICAgI2Rl
ZmluZSAgIElOVEVMX0FVRElPX0RFVkNURwkJMHg4MDg2MjgwMgo+ID4gQEAgLTEwNDY5LDggKzEw
NDY5LDggQEAgZW51bSBza2xfcG93ZXJfZ2F0ZSB7Cj4gPiAgIC8qIE1JUEkgRFNJIENvbnRyb2xs
ZXIgYW5kIEQtUEhZIHJlZ2lzdGVycyAqLwo+ID4gLSNkZWZpbmUgX01JUElBX0RFVklDRV9SRUFE
WQkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjAwMCkKPiA+IC0jZGVmaW5lIF9NSVBJ
Q19ERVZJQ0VfUkVBRFkJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4MDApCj4gPiAr
I2RlZmluZSBfTUlQSUFfREVWSUNFX1JFQURZCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIw
MDApCj4gPiArI2RlZmluZSBfTUlQSUNfREVWSUNFX1JFQURZCQkoaTkxNS0+bWlwaV9tbWlvX2Jh
c2UgKyAweGI4MDApCj4gPiAgICNkZWZpbmUgTUlQSV9ERVZJQ0VfUkVBRFkocG9ydCkJCV9NTUlP
X01JUEkocG9ydCwgX01JUElBX0RFVklDRV9SRUFEWSwgX01JUElDX0RFVklDRV9SRUFEWSkKPiA+
ICAgI2RlZmluZSAgQlVTX1BPU1NFU1NJT04JCQkJCSgxIDw8IDMpIC8qIHNldCB0byBnaXZlIGJ1
cyB0byByZWNlaXZlciAqLwo+ID4gICAjZGVmaW5lICBVTFBTX1NUQVRFX01BU0sJCQkJKDMgPDwg
MSkKPiA+IEBAIC0xMDQ3OSwxMSArMTA0NzksMTEgQEAgZW51bSBza2xfcG93ZXJfZ2F0ZSB7Cj4g
PiAgICNkZWZpbmUgIFVMUFNfU1RBVEVfTk9STUFMX09QRVJBVElPTgkJCSgwIDw8IDEpCj4gPiAg
ICNkZWZpbmUgIERFVklDRV9SRUFEWQkJCQkJKDEgPDwgMCkKPiA+IC0jZGVmaW5lIF9NSVBJQV9J
TlRSX1NUQVQJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMDQpCj4gPiAtI2RlZmlu
ZSBfTUlQSUNfSU5UUl9TVEFUCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODA0KQo+
ID4gKyNkZWZpbmUgX01JUElBX0lOVFJfU1RBVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhi
MDA0KQo+ID4gKyNkZWZpbmUgX01JUElDX0lOVFJfU1RBVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNl
ICsgMHhiODA0KQo+ID4gICAjZGVmaW5lIE1JUElfSU5UUl9TVEFUKHBvcnQpCQlfTU1JT19NSVBJ
KHBvcnQsIF9NSVBJQV9JTlRSX1NUQVQsIF9NSVBJQ19JTlRSX1NUQVQpCj4gPiAtI2RlZmluZSBf
TUlQSUFfSU5UUl9FTgkJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMDgpCj4gPiAt
I2RlZmluZSBfTUlQSUNfSU5UUl9FTgkJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4
MDgpCj4gPiArI2RlZmluZSBfTUlQSUFfSU5UUl9FTgkJCShpOTE1LT5taXBpX21taW9fYmFzZSAr
IDB4YjAwOCkKPiA+ICsjZGVmaW5lIF9NSVBJQ19JTlRSX0VOCQkJKGk5MTUtPm1pcGlfbW1pb19i
YXNlICsgMHhiODA4KQo+ID4gICAjZGVmaW5lIE1JUElfSU5UUl9FTihwb3J0KQkJX01NSU9fTUlQ
SShwb3J0LCBfTUlQSUFfSU5UUl9FTiwgX01JUElDX0lOVFJfRU4pCj4gPiAgICNkZWZpbmUgIFRF
QVJJTkdfRUZGRUNUCQkJCQkoMSA8PCAzMSkKPiA+ICAgI2RlZmluZSAgU1BMX1BLVF9TRU5UX0lO
VEVSUlVQVAkJCQkoMSA8PCAzMCkKPiA+IEBAIC0xMDUxOCw4ICsxMDUxOCw4IEBAIGVudW0gc2ts
X3Bvd2VyX2dhdGUgewo+ID4gICAjZGVmaW5lICBSWFNPVF9TWU5DX0VSUk9SCQkJCSgxIDw8IDEp
Cj4gPiAgICNkZWZpbmUgIFJYU09UX0VSUk9SCQkJCQkoMSA8PCAwKQo+ID4gLSNkZWZpbmUgX01J
UElBX0RTSV9GVU5DX1BSRwkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjAwYykKPiA+
IC0jZGVmaW5lIF9NSVBJQ19EU0lfRlVOQ19QUkcJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2Ug
KyAweGI4MGMpCj4gPiArI2RlZmluZSBfTUlQSUFfRFNJX0ZVTkNfUFJHCQkoaTkxNS0+bWlwaV9t
bWlvX2Jhc2UgKyAweGIwMGMpCj4gPiArI2RlZmluZSBfTUlQSUNfRFNJX0ZVTkNfUFJHCQkoaTkx
NS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4MGMpCj4gPiAgICNkZWZpbmUgTUlQSV9EU0lfRlVOQ19Q
UkcocG9ydCkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0RTSV9GVU5DX1BSRywgX01JUElDX0RT
SV9GVU5DX1BSRykKPiA+ICAgI2RlZmluZSAgQ01EX01PREVfREFUQV9XSURUSF9NQVNLCQkJKDcg
PDwgMTMpCj4gPiAgICNkZWZpbmUgIENNRF9NT0RFX05PVF9TVVBQT1JURUQJCQkJKDAgPDwgMTMp
Cj4gPiBAQCAtMTA1NDEsNzggKzEwNTQxLDc4IEBAIGVudW0gc2tsX3Bvd2VyX2dhdGUgewo+ID4g
ICAjZGVmaW5lICBEQVRBX0xBTkVTX1BSR19SRUdfU0hJRlQJCQkwCj4gPiAgICNkZWZpbmUgIERB
VEFfTEFORVNfUFJHX1JFR19NQVNLCQkJKDcgPDwgMCkKPiA+IC0jZGVmaW5lIF9NSVBJQV9IU19U
WF9USU1FT1VUCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDEwKQo+ID4gLSNkZWZp
bmUgX01JUElDX0hTX1RYX1RJTUVPVVQJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4
MTApCj4gPiArI2RlZmluZSBfTUlQSUFfSFNfVFhfVElNRU9VVAkJKGk5MTUtPm1pcGlfbW1pb19i
YXNlICsgMHhiMDEwKQo+ID4gKyNkZWZpbmUgX01JUElDX0hTX1RYX1RJTUVPVVQJCShpOTE1LT5t
aXBpX21taW9fYmFzZSArIDB4YjgxMCkKPiA+ICAgI2RlZmluZSBNSVBJX0hTX1RYX1RJTUVPVVQo
cG9ydCkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFfSFNfVFhfVElNRU9VVCwgX01JUElDX0hTX1RY
X1RJTUVPVVQpCj4gPiAgICNkZWZpbmUgIEhJR0hfU1BFRURfVFhfVElNRU9VVF9DT1VOVEVSX01B
U0sJCTB4ZmZmZmZmCj4gPiAtI2RlZmluZSBfTUlQSUFfTFBfUlhfVElNRU9VVAkJKGRldl9wcml2
LT5taXBpX21taW9fYmFzZSArIDB4YjAxNCkKPiA+IC0jZGVmaW5lIF9NSVBJQ19MUF9SWF9USU1F
T1VUCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODE0KQo+ID4gKyNkZWZpbmUgX01J
UElBX0xQX1JYX1RJTUVPVVQJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjAxNCkKPiA+ICsj
ZGVmaW5lIF9NSVBJQ19MUF9SWF9USU1FT1VUCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4
MTQpCj4gPiAgICNkZWZpbmUgTUlQSV9MUF9SWF9USU1FT1VUKHBvcnQpCV9NTUlPX01JUEkocG9y
dCwgX01JUElBX0xQX1JYX1RJTUVPVVQsIF9NSVBJQ19MUF9SWF9USU1FT1VUKQo+ID4gICAjZGVm
aW5lICBMT1dfUE9XRVJfUlhfVElNRU9VVF9DT1VOVEVSX01BU0sJCTB4ZmZmZmZmCj4gPiAtI2Rl
ZmluZSBfTUlQSUFfVFVSTl9BUk9VTkRfVElNRU9VVAkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNl
ICsgMHhiMDE4KQo+ID4gLSNkZWZpbmUgX01JUElDX1RVUk5fQVJPVU5EX1RJTUVPVVQJKGRldl9w
cml2LT5taXBpX21taW9fYmFzZSArIDB4YjgxOCkKPiA+ICsjZGVmaW5lIF9NSVBJQV9UVVJOX0FS
T1VORF9USU1FT1VUCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjAxOCkKPiA+ICsjZGVmaW5l
IF9NSVBJQ19UVVJOX0FST1VORF9USU1FT1VUCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjgx
OCkKPiA+ICAgI2RlZmluZSBNSVBJX1RVUk5fQVJPVU5EX1RJTUVPVVQocG9ydCkJX01NSU9fTUlQ
SShwb3J0LCBfTUlQSUFfVFVSTl9BUk9VTkRfVElNRU9VVCwgX01JUElDX1RVUk5fQVJPVU5EX1RJ
TUVPVVQpCj4gPiAgICNkZWZpbmUgIFRVUk5fQVJPVU5EX1RJTUVPVVRfTUFTSwkJCTB4M2YKPiA+
IC0jZGVmaW5lIF9NSVBJQV9ERVZJQ0VfUkVTRVRfVElNRVIJKGRldl9wcml2LT5taXBpX21taW9f
YmFzZSArIDB4YjAxYykKPiA+IC0jZGVmaW5lIF9NSVBJQ19ERVZJQ0VfUkVTRVRfVElNRVIJKGRl
dl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjgxYykKPiA+ICsjZGVmaW5lIF9NSVBJQV9ERVZJ
Q0VfUkVTRVRfVElNRVIJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDFjKQo+ID4gKyNkZWZp
bmUgX01JUElDX0RFVklDRV9SRVNFVF9USU1FUgkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4
MWMpCj4gPiAgICNkZWZpbmUgTUlQSV9ERVZJQ0VfUkVTRVRfVElNRVIocG9ydCkJX01NSU9fTUlQ
SShwb3J0LCBfTUlQSUFfREVWSUNFX1JFU0VUX1RJTUVSLCBfTUlQSUNfREVWSUNFX1JFU0VUX1RJ
TUVSKQo+ID4gICAjZGVmaW5lICBERVZJQ0VfUkVTRVRfVElNRVJfTUFTSwkJCTB4ZmZmZgo+ID4g
LSNkZWZpbmUgX01JUElBX0RQSV9SRVNPTFVUSU9OCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNl
ICsgMHhiMDIwKQo+ID4gLSNkZWZpbmUgX01JUElDX0RQSV9SRVNPTFVUSU9OCQkoZGV2X3ByaXYt
Pm1pcGlfbW1pb19iYXNlICsgMHhiODIwKQo+ID4gKyNkZWZpbmUgX01JUElBX0RQSV9SRVNPTFVU
SU9OCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMjApCj4gPiArI2RlZmluZSBfTUlQSUNf
RFBJX1JFU09MVVRJT04JCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjgyMCkKPiA+ICAgI2Rl
ZmluZSBNSVBJX0RQSV9SRVNPTFVUSU9OKHBvcnQpCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0RQ
SV9SRVNPTFVUSU9OLCBfTUlQSUNfRFBJX1JFU09MVVRJT04pCj4gPiAgICNkZWZpbmUgIFZFUlRJ
Q0FMX0FERFJFU1NfU0hJRlQJCQkJMTYKPiA+ICAgI2RlZmluZSAgVkVSVElDQUxfQUREUkVTU19N
QVNLCQkJCSgweGZmZmYgPDwgMTYpCj4gPiAgICNkZWZpbmUgIEhPUklaT05UQUxfQUREUkVTU19T
SElGVAkJCTAKPiA+ICAgI2RlZmluZSAgSE9SSVpPTlRBTF9BRERSRVNTX01BU0sJCQkweGZmZmYK
PiA+IC0jZGVmaW5lIF9NSVBJQV9EQklfRklGT19USFJPVFRMRQkoZGV2X3ByaXYtPm1pcGlfbW1p
b19iYXNlICsgMHhiMDI0KQo+ID4gLSNkZWZpbmUgX01JUElDX0RCSV9GSUZPX1RIUk9UVExFCShk
ZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4MjQpCj4gPiArI2RlZmluZSBfTUlQSUFfREJJ
X0ZJRk9fVEhST1RUTEUJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDI0KQo+ID4gKyNkZWZp
bmUgX01JUElDX0RCSV9GSUZPX1RIUk9UVExFCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjgy
NCkKPiA+ICAgI2RlZmluZSBNSVBJX0RCSV9GSUZPX1RIUk9UVExFKHBvcnQpCV9NTUlPX01JUEko
cG9ydCwgX01JUElBX0RCSV9GSUZPX1RIUk9UVExFLCBfTUlQSUNfREJJX0ZJRk9fVEhST1RUTEUp
Cj4gPiAgICNkZWZpbmUgIERCSV9GSUZPX0VNUFRZX0hBTEYJCQkJKDAgPDwgMCkKPiA+ICAgI2Rl
ZmluZSAgREJJX0ZJRk9fRU1QVFlfUVVBUlRFUgkJCQkoMSA8PCAwKQo+ID4gICAjZGVmaW5lICBE
QklfRklGT19FTVBUWV83X0xPQ0FUSU9OUwkJCSgyIDw8IDApCj4gPiAgIC8qIHJlZ3MgYmVsb3cg
YXJlIGJpdHMgMTU6MCAqLwo+ID4gLSNkZWZpbmUgX01JUElBX0hTWU5DX1BBRERJTkdfQ09VTlQJ
KGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjAyOCkKPiA+IC0jZGVmaW5lIF9NSVBJQ19I
U1lOQ19QQURESU5HX0NPVU5UCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4MjgpCj4g
PiArI2RlZmluZSBfTUlQSUFfSFNZTkNfUEFERElOR19DT1VOVAkoaTkxNS0+bWlwaV9tbWlvX2Jh
c2UgKyAweGIwMjgpCj4gPiArI2RlZmluZSBfTUlQSUNfSFNZTkNfUEFERElOR19DT1VOVAkoaTkx
NS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4MjgpCj4gPiAgICNkZWZpbmUgTUlQSV9IU1lOQ19QQURE
SU5HX0NPVU5UKHBvcnQpCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0hTWU5DX1BBRERJTkdfQ09V
TlQsIF9NSVBJQ19IU1lOQ19QQURESU5HX0NPVU5UKQo+ID4gLSNkZWZpbmUgX01JUElBX0hCUF9D
T1VOVAkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjAyYykKPiA+IC0jZGVmaW5lIF9N
SVBJQ19IQlBfQ09VTlQJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4MmMpCj4gPiAr
I2RlZmluZSBfTUlQSUFfSEJQX0NPVU5UCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMmMp
Cj4gPiArI2RlZmluZSBfTUlQSUNfSEJQX0NPVU5UCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAw
eGI4MmMpCj4gPiAgICNkZWZpbmUgTUlQSV9IQlBfQ09VTlQocG9ydCkJCV9NTUlPX01JUEkocG9y
dCwgX01JUElBX0hCUF9DT1VOVCwgX01JUElDX0hCUF9DT1VOVCkKPiA+IC0jZGVmaW5lIF9NSVBJ
QV9IRlBfQ09VTlQJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwMzApCj4gPiAtI2Rl
ZmluZSBfTUlQSUNfSEZQX0NPVU5UCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODMw
KQo+ID4gKyNkZWZpbmUgX01JUElBX0hGUF9DT1VOVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsg
MHhiMDMwKQo+ID4gKyNkZWZpbmUgX01JUElDX0hGUF9DT1VOVAkJKGk5MTUtPm1pcGlfbW1pb19i
YXNlICsgMHhiODMwKQo+ID4gICAjZGVmaW5lIE1JUElfSEZQX0NPVU5UKHBvcnQpCQlfTU1JT19N
SVBJKHBvcnQsIF9NSVBJQV9IRlBfQ09VTlQsIF9NSVBJQ19IRlBfQ09VTlQpCj4gPiAtI2RlZmlu
ZSBfTUlQSUFfSEFDVElWRV9BUkVBX0NPVU5UCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAw
eGIwMzQpCj4gPiAtI2RlZmluZSBfTUlQSUNfSEFDVElWRV9BUkVBX0NPVU5UCShkZXZfcHJpdi0+
bWlwaV9tbWlvX2Jhc2UgKyAweGI4MzQpCj4gPiArI2RlZmluZSBfTUlQSUFfSEFDVElWRV9BUkVB
X0NPVU5UCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjAzNCkKPiA+ICsjZGVmaW5lIF9NSVBJ
Q19IQUNUSVZFX0FSRUFfQ09VTlQJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODM0KQo+ID4g
ICAjZGVmaW5lIE1JUElfSEFDVElWRV9BUkVBX0NPVU5UKHBvcnQpCV9NTUlPX01JUEkocG9ydCwg
X01JUElBX0hBQ1RJVkVfQVJFQV9DT1VOVCwgX01JUElDX0hBQ1RJVkVfQVJFQV9DT1VOVCkKPiA+
IC0jZGVmaW5lIF9NSVBJQV9WU1lOQ19QQURESU5HX0NPVU5UCShkZXZfcHJpdi0+bWlwaV9tbWlv
X2Jhc2UgKyAweGIwMzgpCj4gPiAtI2RlZmluZSBfTUlQSUNfVlNZTkNfUEFERElOR19DT1VOVAko
ZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODM4KQo+ID4gKyNkZWZpbmUgX01JUElBX1ZT
WU5DX1BBRERJTkdfQ09VTlQJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDM4KQo+ID4gKyNk
ZWZpbmUgX01JUElDX1ZTWU5DX1BBRERJTkdfQ09VTlQJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsg
MHhiODM4KQo+ID4gICAjZGVmaW5lIE1JUElfVlNZTkNfUEFERElOR19DT1VOVChwb3J0KQlfTU1J
T19NSVBJKHBvcnQsIF9NSVBJQV9WU1lOQ19QQURESU5HX0NPVU5ULCBfTUlQSUNfVlNZTkNfUEFE
RElOR19DT1VOVCkKPiA+IC0jZGVmaW5lIF9NSVBJQV9WQlBfQ09VTlQJCShkZXZfcHJpdi0+bWlw
aV9tbWlvX2Jhc2UgKyAweGIwM2MpCj4gPiAtI2RlZmluZSBfTUlQSUNfVkJQX0NPVU5UCQkoZGV2
X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODNjKQo+ID4gKyNkZWZpbmUgX01JUElBX1ZCUF9D
T1VOVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDNjKQo+ID4gKyNkZWZpbmUgX01JUElD
X1ZCUF9DT1VOVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODNjKQo+ID4gICAjZGVmaW5l
IE1JUElfVkJQX0NPVU5UKHBvcnQpCQlfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9WQlBfQ09VTlQs
IF9NSVBJQ19WQlBfQ09VTlQpCj4gPiAtI2RlZmluZSBfTUlQSUFfVkZQX0NPVU5UCQkoZGV2X3By
aXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDQwKQo+ID4gLSNkZWZpbmUgX01JUElDX1ZGUF9DT1VO
VAkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg0MCkKPiA+ICsjZGVmaW5lIF9NSVBJ
QV9WRlBfQ09VTlQJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjA0MCkKPiA+ICsjZGVmaW5l
IF9NSVBJQ19WRlBfQ09VTlQJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjg0MCkKPiA+ICAg
I2RlZmluZSBNSVBJX1ZGUF9DT1VOVChwb3J0KQkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFfVkZQ
X0NPVU5ULCBfTUlQSUNfVkZQX0NPVU5UKQo+ID4gLSNkZWZpbmUgX01JUElBX0hJR0hfTE9XX1NX
SVRDSF9DT1VOVAkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDQ0KQo+ID4gLSNkZWZp
bmUgX01JUElDX0hJR0hfTE9XX1NXSVRDSF9DT1VOVAkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNl
ICsgMHhiODQ0KQo+ID4gKyNkZWZpbmUgX01JUElBX0hJR0hfTE9XX1NXSVRDSF9DT1VOVAkoaTkx
NS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwNDQpCj4gPiArI2RlZmluZSBfTUlQSUNfSElHSF9MT1df
U1dJVENIX0NPVU5UCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjg0NCkKPiA+ICAgI2RlZmlu
ZSBNSVBJX0hJR0hfTE9XX1NXSVRDSF9DT1VOVChwb3J0KQlfTU1JT19NSVBJKHBvcnQsCV9NSVBJ
QV9ISUdIX0xPV19TV0lUQ0hfQ09VTlQsIF9NSVBJQ19ISUdIX0xPV19TV0lUQ0hfQ09VTlQpCj4g
PiAgIC8qIHJlZ3MgYWJvdmUgYXJlIGJpdHMgMTU6MCAqLwo+ID4gLSNkZWZpbmUgX01JUElBX0RQ
SV9DT05UUk9MCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDQ4KQo+ID4gLSNkZWZp
bmUgX01JUElDX0RQSV9DT05UUk9MCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODQ4
KQo+ID4gKyNkZWZpbmUgX01JUElBX0RQSV9DT05UUk9MCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2Ug
KyAweGIwNDgpCj4gPiArI2RlZmluZSBfTUlQSUNfRFBJX0NPTlRST0wJCShpOTE1LT5taXBpX21t
aW9fYmFzZSArIDB4Yjg0OCkKPiA+ICAgI2RlZmluZSBNSVBJX0RQSV9DT05UUk9MKHBvcnQpCQlf
TU1JT19NSVBJKHBvcnQsIF9NSVBJQV9EUElfQ09OVFJPTCwgX01JUElDX0RQSV9DT05UUk9MKQo+
ID4gICAjZGVmaW5lICBEUElfTFBfTU9ERQkJCQkJKDEgPDwgNikKPiA+ICAgI2RlZmluZSAgQkFD
S0xJR0hUX09GRgkJCQkJKDEgPDwgNSkKPiA+IEBAIC0xMDYyMiwyNyArMTA2MjIsMjcgQEAgZW51
bSBza2xfcG93ZXJfZ2F0ZSB7Cj4gPiAgICNkZWZpbmUgIFRVUk5fT04JCQkJCSgxIDw8IDEpCj4g
PiAgICNkZWZpbmUgIFNIVVRET1dOCQkJCQkoMSA8PCAwKQo+ID4gLSNkZWZpbmUgX01JUElBX0RQ
SV9EQVRBCQkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjA0YykKPiA+IC0jZGVmaW5l
IF9NSVBJQ19EUElfREFUQQkJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4NGMpCj4g
PiArI2RlZmluZSBfTUlQSUFfRFBJX0RBVEEJCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIw
NGMpCj4gPiArI2RlZmluZSBfTUlQSUNfRFBJX0RBVEEJCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2Ug
KyAweGI4NGMpCj4gPiAgICNkZWZpbmUgTUlQSV9EUElfREFUQShwb3J0KQkJX01NSU9fTUlQSShw
b3J0LCBfTUlQSUFfRFBJX0RBVEEsIF9NSVBJQ19EUElfREFUQSkKPiA+ICAgI2RlZmluZSAgQ09N
TUFORF9CWVRFX1NISUZUCQkJCTAKPiA+ICAgI2RlZmluZSAgQ09NTUFORF9CWVRFX01BU0sJCQkJ
KDB4M2YgPDwgMCkKPiA+IC0jZGVmaW5lIF9NSVBJQV9JTklUX0NPVU5UCQkoZGV2X3ByaXYtPm1p
cGlfbW1pb19iYXNlICsgMHhiMDUwKQo+ID4gLSNkZWZpbmUgX01JUElDX0lOSVRfQ09VTlQJCShk
ZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4NTApCj4gPiArI2RlZmluZSBfTUlQSUFfSU5J
VF9DT1VOVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDUwKQo+ID4gKyNkZWZpbmUgX01J
UElDX0lOSVRfQ09VTlQJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjg1MCkKPiA+ICAgI2Rl
ZmluZSBNSVBJX0lOSVRfQ09VTlQocG9ydCkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0lOSVRf
Q09VTlQsIF9NSVBJQ19JTklUX0NPVU5UKQo+ID4gICAjZGVmaW5lICBNQVNURVJfSU5JVF9USU1F
Ul9TSElGVAkJCTAKPiA+ICAgI2RlZmluZSAgTUFTVEVSX0lOSVRfVElNRVJfTUFTSwkJCQkoMHhm
ZmZmIDw8IDApCj4gPiAtI2RlZmluZSBfTUlQSUFfTUFYX1JFVFVSTl9QS1RfU0laRQkoZGV2X3By
aXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDU0KQo+ID4gLSNkZWZpbmUgX01JUElDX01BWF9SRVRV
Uk5fUEtUX1NJWkUJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg1NCkKPiA+ICsjZGVm
aW5lIF9NSVBJQV9NQVhfUkVUVVJOX1BLVF9TSVpFCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4
YjA1NCkKPiA+ICsjZGVmaW5lIF9NSVBJQ19NQVhfUkVUVVJOX1BLVF9TSVpFCShpOTE1LT5taXBp
X21taW9fYmFzZSArIDB4Yjg1NCkKPiA+ICAgI2RlZmluZSBNSVBJX01BWF9SRVRVUk5fUEtUX1NJ
WkUocG9ydCkJX01NSU9fTUlQSShwb3J0LCBcCj4gPiAgIAkJCV9NSVBJQV9NQVhfUkVUVVJOX1BL
VF9TSVpFLCBfTUlQSUNfTUFYX1JFVFVSTl9QS1RfU0laRSkKPiA+ICAgI2RlZmluZSAgTUFYX1JF
VFVSTl9QS1RfU0laRV9TSElGVAkJCTAKPiA+ICAgI2RlZmluZSAgTUFYX1JFVFVSTl9QS1RfU0la
RV9NQVNLCQkJKDB4M2ZmIDw8IDApCj4gPiAtI2RlZmluZSBfTUlQSUFfVklERU9fTU9ERV9GT1JN
QVQJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjA1OCkKPiA+IC0jZGVmaW5lIF9NSVBJ
Q19WSURFT19NT0RFX0ZPUk1BVAkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODU4KQo+
ID4gKyNkZWZpbmUgX01JUElBX1ZJREVPX01PREVfRk9STUFUCShpOTE1LT5taXBpX21taW9fYmFz
ZSArIDB4YjA1OCkKPiA+ICsjZGVmaW5lIF9NSVBJQ19WSURFT19NT0RFX0ZPUk1BVAkoaTkxNS0+
bWlwaV9tbWlvX2Jhc2UgKyAweGI4NTgpCj4gPiAgICNkZWZpbmUgTUlQSV9WSURFT19NT0RFX0ZP
Uk1BVChwb3J0KQlfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9WSURFT19NT0RFX0ZPUk1BVCwgX01J
UElDX1ZJREVPX01PREVfRk9STUFUKQo+ID4gICAjZGVmaW5lICBSQU5ET01fRFBJX0RJU1BMQVlf
UkVTT0xVVElPTgkJCSgxIDw8IDQpCj4gPiAgICNkZWZpbmUgIERJU0FCTEVfVklERU9fQlRBCQkJ
CSgxIDw8IDMpCj4gPiBAQCAtMTA2NTEsOCArMTA2NTEsOCBAQCBlbnVtIHNrbF9wb3dlcl9nYXRl
IHsKPiA+ICAgI2RlZmluZSAgVklERU9fTU9ERV9OT05fQlVSU1RfV0lUSF9TWU5DX0VWRU5UUwkJ
KDIgPDwgMCkKPiA+ICAgI2RlZmluZSAgVklERU9fTU9ERV9CVVJTVAkJCQkoMyA8PCAwKQo+ID4g
LSNkZWZpbmUgX01JUElBX0VPVF9ESVNBQkxFCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsg
MHhiMDVjKQo+ID4gLSNkZWZpbmUgX01JUElDX0VPVF9ESVNBQkxFCQkoZGV2X3ByaXYtPm1pcGlf
bW1pb19iYXNlICsgMHhiODVjKQo+ID4gKyNkZWZpbmUgX01JUElBX0VPVF9ESVNBQkxFCQkoaTkx
NS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwNWMpCj4gPiArI2RlZmluZSBfTUlQSUNfRU9UX0RJU0FC
TEUJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjg1YykKPiA+ICAgI2RlZmluZSBNSVBJX0VP
VF9ESVNBQkxFKHBvcnQpCQlfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9FT1RfRElTQUJMRSwgX01J
UElDX0VPVF9ESVNBQkxFKQo+ID4gICAjZGVmaW5lICBCWFRfREVGRUFUVVJFX0RQSV9GSUZPX0NU
UgkJCSgxIDw8IDkpCj4gPiAgICNkZWZpbmUgIEJYVF9EUEhZX0RFRkVBVFVSRV9FTgkJCQkoMSA8
PCA4KQo+ID4gQEAgLTEwNjY1LDM1ICsxMDY2NSwzNSBAQCBlbnVtIHNrbF9wb3dlcl9nYXRlIHsK
PiA+ICAgI2RlZmluZSAgQ0xPQ0tTVE9QCQkJCQkoMSA8PCAxKQo+ID4gICAjZGVmaW5lICBFT1Rf
RElTQUJMRQkJCQkJKDEgPDwgMCkKPiA+IC0jZGVmaW5lIF9NSVBJQV9MUF9CWVRFQ0xLCQkoZGV2
X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDYwKQo+ID4gLSNkZWZpbmUgX01JUElDX0xQX0JZ
VEVDTEsJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4NjApCj4gPiArI2RlZmluZSBf
TUlQSUFfTFBfQllURUNMSwkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDYwKQo+ID4gKyNk
ZWZpbmUgX01JUElDX0xQX0JZVEVDTEsJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjg2MCkK
PiA+ICAgI2RlZmluZSBNSVBJX0xQX0JZVEVDTEsocG9ydCkJCV9NTUlPX01JUEkocG9ydCwgX01J
UElBX0xQX0JZVEVDTEssIF9NSVBJQ19MUF9CWVRFQ0xLKQo+ID4gICAjZGVmaW5lICBMUF9CWVRF
Q0xLX1NISUZUCQkJCTAKPiA+ICAgI2RlZmluZSAgTFBfQllURUNMS19NQVNLCQkJCSgweGZmZmYg
PDwgMCkKPiA+IC0jZGVmaW5lIF9NSVBJQV9UTFBYX1RJTUVfQ09VTlQJCShkZXZfcHJpdi0+bWlw
aV9tbWlvX2Jhc2UgKyAweGIwYTQpCj4gPiAtI2RlZmluZSBfTUlQSUNfVExQWF9USU1FX0NPVU5U
CQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiOGE0KQo+ID4gKyNkZWZpbmUgX01JUElB
X1RMUFhfVElNRV9DT1VOVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMGE0KQo+ID4gKyNk
ZWZpbmUgX01JUElDX1RMUFhfVElNRV9DT1VOVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhi
OGE0KQo+ID4gICAjZGVmaW5lIE1JUElfVExQWF9USU1FX0NPVU5UKHBvcnQpCSBfTU1JT19NSVBJ
KHBvcnQsIF9NSVBJQV9UTFBYX1RJTUVfQ09VTlQsIF9NSVBJQ19UTFBYX1RJTUVfQ09VTlQpCj4g
PiAtI2RlZmluZSBfTUlQSUFfQ0xLX0xBTkVfVElNSU5HCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19i
YXNlICsgMHhiMDk4KQo+ID4gLSNkZWZpbmUgX01JUElDX0NMS19MQU5FX1RJTUlORwkJKGRldl9w
cml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg5OCkKPiA+ICsjZGVmaW5lIF9NSVBJQV9DTEtfTEFO
RV9USU1JTkcJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjA5OCkKPiA+ICsjZGVmaW5lIF9N
SVBJQ19DTEtfTEFORV9USU1JTkcJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjg5OCkKPiA+
ICAgI2RlZmluZSBNSVBJX0NMS19MQU5FX1RJTUlORyhwb3J0KQkgX01NSU9fTUlQSShwb3J0LCBf
TUlQSUFfQ0xLX0xBTkVfVElNSU5HLCBfTUlQSUNfQ0xLX0xBTkVfVElNSU5HKQo+ID4gICAvKiBi
aXRzIDMxOjAgKi8KPiA+IC0jZGVmaW5lIF9NSVBJQV9MUF9HRU5fREFUQQkJKGRldl9wcml2LT5t
aXBpX21taW9fYmFzZSArIDB4YjA2NCkKPiA+IC0jZGVmaW5lIF9NSVBJQ19MUF9HRU5fREFUQQkJ
KGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg2NCkKPiA+ICsjZGVmaW5lIF9NSVBJQV9M
UF9HRU5fREFUQQkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDY0KQo+ID4gKyNkZWZpbmUg
X01JUElDX0xQX0dFTl9EQVRBCQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4NjQpCj4gPiAg
ICNkZWZpbmUgTUlQSV9MUF9HRU5fREFUQShwb3J0KQkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFf
TFBfR0VOX0RBVEEsIF9NSVBJQ19MUF9HRU5fREFUQSkKPiA+ICAgLyogYml0cyAzMTowICovCj4g
PiAtI2RlZmluZSBfTUlQSUFfSFNfR0VOX0RBVEEJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2Ug
KyAweGIwNjgpCj4gPiAtI2RlZmluZSBfTUlQSUNfSFNfR0VOX0RBVEEJCShkZXZfcHJpdi0+bWlw
aV9tbWlvX2Jhc2UgKyAweGI4NjgpCj4gPiArI2RlZmluZSBfTUlQSUFfSFNfR0VOX0RBVEEJCShp
OTE1LT5taXBpX21taW9fYmFzZSArIDB4YjA2OCkKPiA+ICsjZGVmaW5lIF9NSVBJQ19IU19HRU5f
REFUQQkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODY4KQo+ID4gICAjZGVmaW5lIE1JUElf
SFNfR0VOX0RBVEEocG9ydCkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0hTX0dFTl9EQVRBLCBf
TUlQSUNfSFNfR0VOX0RBVEEpCj4gPiAtI2RlZmluZSBfTUlQSUFfTFBfR0VOX0NUUkwJCShkZXZf
cHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwNmMpCj4gPiAtI2RlZmluZSBfTUlQSUNfTFBfR0VO
X0NUUkwJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4NmMpCj4gPiArI2RlZmluZSBf
TUlQSUFfTFBfR0VOX0NUUkwJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjA2YykKPiA+ICsj
ZGVmaW5lIF9NSVBJQ19MUF9HRU5fQ1RSTAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODZj
KQo+ID4gICAjZGVmaW5lIE1JUElfTFBfR0VOX0NUUkwocG9ydCkJCV9NTUlPX01JUEkocG9ydCwg
X01JUElBX0xQX0dFTl9DVFJMLCBfTUlQSUNfTFBfR0VOX0NUUkwpCj4gPiAtI2RlZmluZSBfTUlQ
SUFfSFNfR0VOX0NUUkwJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwNzApCj4gPiAt
I2RlZmluZSBfTUlQSUNfSFNfR0VOX0NUUkwJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAw
eGI4NzApCj4gPiArI2RlZmluZSBfTUlQSUFfSFNfR0VOX0NUUkwJCShpOTE1LT5taXBpX21taW9f
YmFzZSArIDB4YjA3MCkKPiA+ICsjZGVmaW5lIF9NSVBJQ19IU19HRU5fQ1RSTAkJKGk5MTUtPm1p
cGlfbW1pb19iYXNlICsgMHhiODcwKQo+ID4gICAjZGVmaW5lIE1JUElfSFNfR0VOX0NUUkwocG9y
dCkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0hTX0dFTl9DVFJMLCBfTUlQSUNfSFNfR0VOX0NU
UkwpCj4gPiAgICNkZWZpbmUgIExPTkdfUEFDS0VUX1dPUkRfQ09VTlRfU0hJRlQJCQk4Cj4gPiAg
ICNkZWZpbmUgIExPTkdfUEFDS0VUX1dPUkRfQ09VTlRfTUFTSwkJCSgweGZmZmYgPDwgOCkKPiA+
IEBAIC0xMDcwNSw4ICsxMDcwNSw4IEBAIGVudW0gc2tsX3Bvd2VyX2dhdGUgewo+ID4gICAjZGVm
aW5lICBEQVRBX1RZUEVfTUFTSwkJCQkJKDB4M2YgPDwgMCkKPiA+ICAgLyogZGF0YSB0eXBlIHZh
bHVlcywgc2VlIGluY2x1ZGUvdmlkZW8vbWlwaV9kaXNwbGF5LmggKi8KPiA+IC0jZGVmaW5lIF9N
SVBJQV9HRU5fRklGT19TVEFUCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiMDc0KQo+
ID4gLSNkZWZpbmUgX01JUElDX0dFTl9GSUZPX1NUQVQJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jh
c2UgKyAweGI4NzQpCj4gPiArI2RlZmluZSBfTUlQSUFfR0VOX0ZJRk9fU1RBVAkJKGk5MTUtPm1p
cGlfbW1pb19iYXNlICsgMHhiMDc0KQo+ID4gKyNkZWZpbmUgX01JUElDX0dFTl9GSUZPX1NUQVQJ
CShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjg3NCkKPiA+ICAgI2RlZmluZSBNSVBJX0dFTl9G
SUZPX1NUQVQocG9ydCkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFfR0VOX0ZJRk9fU1RBVCwgX01J
UElDX0dFTl9GSUZPX1NUQVQpCj4gPiAgICNkZWZpbmUgIERQSV9GSUZPX0VNUFRZCQkJCQkoMSA8
PCAyOCkKPiA+ICAgI2RlZmluZSAgREJJX0ZJRk9fRU1QVFkJCQkJCSgxIDw8IDI3KQo+ID4gQEAg
LTEwNzIzLDE1ICsxMDcyMywxNSBAQCBlbnVtIHNrbF9wb3dlcl9nYXRlIHsKPiA+ICAgI2RlZmlu
ZSAgSFNfREFUQV9GSUZPX0hBTEZfRU1QVFkJCQkoMSA8PCAxKQo+ID4gICAjZGVmaW5lICBIU19E
QVRBX0ZJRk9fRlVMTAkJCQkoMSA8PCAwKQo+ID4gLSNkZWZpbmUgX01JUElBX0hTX0xTX0RCSV9F
TkFCTEUJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwNzgpCj4gPiAtI2RlZmluZSBf
TUlQSUNfSFNfTFNfREJJX0VOQUJMRQkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4Yjg3
OCkKPiA+ICsjZGVmaW5lIF9NSVBJQV9IU19MU19EQklfRU5BQkxFCQkoaTkxNS0+bWlwaV9tbWlv
X2Jhc2UgKyAweGIwNzgpCj4gPiArI2RlZmluZSBfTUlQSUNfSFNfTFNfREJJX0VOQUJMRQkJKGk5
MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODc4KQo+ID4gICAjZGVmaW5lIE1JUElfSFNfTFBfREJJ
X0VOQUJMRShwb3J0KQlfTU1JT19NSVBJKHBvcnQsIF9NSVBJQV9IU19MU19EQklfRU5BQkxFLCBf
TUlQSUNfSFNfTFNfREJJX0VOQUJMRSkKPiA+ICAgI2RlZmluZSAgREJJX0hTX0xQX01PREVfTUFT
SwkJCQkoMSA8PCAwKQo+ID4gICAjZGVmaW5lICBEQklfTFBfTU9ERQkJCQkJKDEgPDwgMCkKPiA+
ICAgI2RlZmluZSAgREJJX0hTX01PREUJCQkJCSgwIDw8IDApCj4gPiAtI2RlZmluZSBfTUlQSUFf
RFBIWV9QQVJBTQkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjA4MCkKPiA+IC0jZGVm
aW5lIF9NSVBJQ19EUEhZX1BBUkFNCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODgw
KQo+ID4gKyNkZWZpbmUgX01JUElBX0RQSFlfUEFSQU0JCShpOTE1LT5taXBpX21taW9fYmFzZSAr
IDB4YjA4MCkKPiA+ICsjZGVmaW5lIF9NSVBJQ19EUEhZX1BBUkFNCQkoaTkxNS0+bWlwaV9tbWlv
X2Jhc2UgKyAweGI4ODApCj4gPiAgICNkZWZpbmUgTUlQSV9EUEhZX1BBUkFNKHBvcnQpCQlfTU1J
T19NSVBJKHBvcnQsIF9NSVBJQV9EUEhZX1BBUkFNLCBfTUlQSUNfRFBIWV9QQVJBTSkKPiA+ICAg
I2RlZmluZSAgRVhJVF9aRVJPX0NPVU5UX1NISUZUCQkJCTI0Cj4gPiAgICNkZWZpbmUgIEVYSVRf
WkVST19DT1VOVF9NQVNLCQkJCSgweDNmIDw8IDI0KQo+ID4gQEAgLTEwOTc4LDM0ICsxMDk3OCwz
NCBAQCBlbnVtIHNrbF9wb3dlcl9nYXRlIHsKPiA+ICAgI2RlZmluZSAgVEFfVElNRU9VVF9WQUxV
RSh4KQkJKCh4KSA8PCAwKQo+ID4gICAvKiBiaXRzIDMxOjAgKi8KPiA+IC0jZGVmaW5lIF9NSVBJ
QV9EQklfQldfQ1RSTAkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjA4NCkKPiA+IC0j
ZGVmaW5lIF9NSVBJQ19EQklfQldfQ1RSTAkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4
Yjg4NCkKPiA+ICsjZGVmaW5lIF9NSVBJQV9EQklfQldfQ1RSTAkJKGk5MTUtPm1pcGlfbW1pb19i
YXNlICsgMHhiMDg0KQo+ID4gKyNkZWZpbmUgX01JUElDX0RCSV9CV19DVFJMCQkoaTkxNS0+bWlw
aV9tbWlvX2Jhc2UgKyAweGI4ODQpCj4gPiAgICNkZWZpbmUgTUlQSV9EQklfQldfQ1RSTChwb3J0
KQkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFfREJJX0JXX0NUUkwsIF9NSVBJQ19EQklfQldfQ1RS
TCkKPiA+IC0jZGVmaW5lIF9NSVBJQV9DTEtfTEFORV9TV0lUQ0hfVElNRV9DTlQJCShkZXZfcHJp
di0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwODgpCj4gPiAtI2RlZmluZSBfTUlQSUNfQ0xLX0xBTkVf
U1dJVENIX1RJTUVfQ05UCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODg4KQo+ID4g
KyNkZWZpbmUgX01JUElBX0NMS19MQU5FX1NXSVRDSF9USU1FX0NOVAkJKGk5MTUtPm1pcGlfbW1p
b19iYXNlICsgMHhiMDg4KQo+ID4gKyNkZWZpbmUgX01JUElDX0NMS19MQU5FX1NXSVRDSF9USU1F
X0NOVAkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiODg4KQo+ID4gICAjZGVmaW5lIE1JUElf
Q0xLX0xBTkVfU1dJVENIX1RJTUVfQ05UKHBvcnQpCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0NM
S19MQU5FX1NXSVRDSF9USU1FX0NOVCwgX01JUElDX0NMS19MQU5FX1NXSVRDSF9USU1FX0NOVCkK
PiA+ICAgI2RlZmluZSAgTFBfSFNfU1NXX0NOVF9TSElGVAkJCQkxNgo+ID4gICAjZGVmaW5lICBM
UF9IU19TU1dfQ05UX01BU0sJCQkJKDB4ZmZmZiA8PCAxNikKPiA+ICAgI2RlZmluZSAgSFNfTFBf
UFdSX1NXX0NOVF9TSElGVAkJCQkwCj4gPiAgICNkZWZpbmUgIEhTX0xQX1BXUl9TV19DTlRfTUFT
SwkJCQkoMHhmZmZmIDw8IDApCj4gPiAtI2RlZmluZSBfTUlQSUFfU1RPUF9TVEFURV9TVEFMTAkJ
KGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjA4YykKPiA+IC0jZGVmaW5lIF9NSVBJQ19T
VE9QX1NUQVRFX1NUQUxMCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODhjKQo+ID4g
KyNkZWZpbmUgX01JUElBX1NUT1BfU1RBVEVfU1RBTEwJCShpOTE1LT5taXBpX21taW9fYmFzZSAr
IDB4YjA4YykKPiA+ICsjZGVmaW5lIF9NSVBJQ19TVE9QX1NUQVRFX1NUQUxMCQkoaTkxNS0+bWlw
aV9tbWlvX2Jhc2UgKyAweGI4OGMpCj4gPiAgICNkZWZpbmUgTUlQSV9TVE9QX1NUQVRFX1NUQUxM
KHBvcnQpCV9NTUlPX01JUEkocG9ydCwgX01JUElBX1NUT1BfU1RBVEVfU1RBTEwsIF9NSVBJQ19T
VE9QX1NUQVRFX1NUQUxMKQo+ID4gICAjZGVmaW5lICBTVE9QX1NUQVRFX1NUQUxMX0NPVU5URVJf
U0hJRlQJCQkwCj4gPiAgICNkZWZpbmUgIFNUT1BfU1RBVEVfU1RBTExfQ09VTlRFUl9NQVNLCQkJ
KDB4ZmYgPDwgMCkKPiA+IC0jZGVmaW5lIF9NSVBJQV9JTlRSX1NUQVRfUkVHXzEJCShkZXZfcHJp
di0+bWlwaV9tbWlvX2Jhc2UgKyAweGIwOTApCj4gPiAtI2RlZmluZSBfTUlQSUNfSU5UUl9TVEFU
X1JFR18xCQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsgMHhiODkwKQo+ID4gKyNkZWZpbmUg
X01JUElBX0lOVFJfU1RBVF9SRUdfMQkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDkwKQo+
ID4gKyNkZWZpbmUgX01JUElDX0lOVFJfU1RBVF9SRUdfMQkJKGk5MTUtPm1pcGlfbW1pb19iYXNl
ICsgMHhiODkwKQo+ID4gICAjZGVmaW5lIE1JUElfSU5UUl9TVEFUX1JFR18xKHBvcnQpCV9NTUlP
X01JUEkocG9ydCwgX01JUElBX0lOVFJfU1RBVF9SRUdfMSwgX01JUElDX0lOVFJfU1RBVF9SRUdf
MSkKPiA+IC0jZGVmaW5lIF9NSVBJQV9JTlRSX0VOX1JFR18xCQkoZGV2X3ByaXYtPm1pcGlfbW1p
b19iYXNlICsgMHhiMDk0KQo+ID4gLSNkZWZpbmUgX01JUElDX0lOVFJfRU5fUkVHXzEJCShkZXZf
cHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI4OTQpCj4gPiArI2RlZmluZSBfTUlQSUFfSU5UUl9F
Tl9SRUdfMQkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiMDk0KQo+ID4gKyNkZWZpbmUgX01J
UElDX0lOVFJfRU5fUkVHXzEJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4Yjg5NCkKPiA+ICAg
I2RlZmluZSBNSVBJX0lOVFJfRU5fUkVHXzEocG9ydCkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFf
SU5UUl9FTl9SRUdfMSwgX01JUElDX0lOVFJfRU5fUkVHXzEpCj4gPiAgICNkZWZpbmUgIFJYX0NP
TlRFTlRJT05fREVURUNURUQJCQkJKDEgPDwgMCkKPiA+ICAgLyogWFhYOiBvbmx5IHBpcGUgQSA/
IT8gKi8KPiA+IC0jZGVmaW5lIE1JUElBX0RCSV9UWVBFQ19DVFJMCQkoZGV2X3ByaXYtPm1pcGlf
bW1pb19iYXNlICsgMHhiMTAwKQo+ID4gKyNkZWZpbmUgTUlQSUFfREJJX1RZUEVDX0NUUkwJCShp
OTE1LT5taXBpX21taW9fYmFzZSArIDB4YjEwMCkKPiA+ICAgI2RlZmluZSAgREJJX1RZUEVDX0VO
QUJMRQkJCQkoMSA8PCAzMSkKPiA+ICAgI2RlZmluZSAgREJJX1RZUEVDX1dJUAkJCQkJKDEgPDwg
MzApCj4gPiAgICNkZWZpbmUgIERCSV9UWVBFQ19PUFRJT05fU0hJRlQJCQkJMjgKPiA+IEBAIC0x
MTAxOSw4ICsxMTAxOSw4IEBAIGVudW0gc2tsX3Bvd2VyX2dhdGUgewo+ID4gICAvKiBNSVBJIGFk
YXB0ZXIgcmVnaXN0ZXJzICovCj4gPiAtI2RlZmluZSBfTUlQSUFfQ1RSTAkJCShkZXZfcHJpdi0+
bWlwaV9tbWlvX2Jhc2UgKyAweGIxMDQpCj4gPiAtI2RlZmluZSBfTUlQSUNfQ1RSTAkJCShkZXZf
cHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI5MDQpCj4gPiArI2RlZmluZSBfTUlQSUFfQ1RSTAkJ
CShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjEwNCkKPiA+ICsjZGVmaW5lIF9NSVBJQ19DVFJM
CQkJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiOTA0KQo+ID4gICAjZGVmaW5lIE1JUElfQ1RS
TChwb3J0KQkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0NUUkwsIF9NSVBJQ19DVFJMKQo+ID4g
ICAjZGVmaW5lICBFU0NBUEVfQ0xPQ0tfRElWSURFUl9TSElGVAkJCTUgLyogQSBvbmx5ICovCj4g
PiAgICNkZWZpbmUgIEVTQ0FQRV9DTE9DS19ESVZJREVSX01BU0sJCQkoMyA8PCA1KQo+ID4gQEAg
LTExMDUyLDIxICsxMTA1MiwyMSBAQCBlbnVtIHNrbF9wb3dlcl9nYXRlIHsKPiA+ICAgI2RlZmlu
ZSAgR0xLX01JUElJT19QT1JUX1BPV0VSRUQJCQkoMSA8PCAxKSAvKiBSTyAqLwo+ID4gICAjZGVm
aW5lICBHTEtfTUlQSUlPX0VOQUJMRQkJCQkoMSA8PCAwKQo+ID4gLSNkZWZpbmUgX01JUElBX0RB
VEFfQUREUkVTUwkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjEwOCkKPiA+IC0jZGVm
aW5lIF9NSVBJQ19EQVRBX0FERFJFU1MJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI5
MDgpCj4gPiArI2RlZmluZSBfTUlQSUFfREFUQV9BRERSRVNTCQkoaTkxNS0+bWlwaV9tbWlvX2Jh
c2UgKyAweGIxMDgpCj4gPiArI2RlZmluZSBfTUlQSUNfREFUQV9BRERSRVNTCQkoaTkxNS0+bWlw
aV9tbWlvX2Jhc2UgKyAweGI5MDgpCj4gPiAgICNkZWZpbmUgTUlQSV9EQVRBX0FERFJFU1MocG9y
dCkJCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0RBVEFfQUREUkVTUywgX01JUElDX0RBVEFfQURE
UkVTUykKPiA+ICAgI2RlZmluZSAgREFUQV9NRU1fQUREUkVTU19TSElGVAkJCQk1Cj4gPiAgICNk
ZWZpbmUgIERBVEFfTUVNX0FERFJFU1NfTUFTSwkJCQkoMHg3ZmZmZmZmIDw8IDUpCj4gPiAgICNk
ZWZpbmUgIERBVEFfVkFMSUQJCQkJCSgxIDw8IDApCj4gPiAtI2RlZmluZSBfTUlQSUFfREFUQV9M
RU5HVEgJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGIxMGMpCj4gPiAtI2RlZmluZSBf
TUlQSUNfREFUQV9MRU5HVEgJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI5MGMpCj4g
PiArI2RlZmluZSBfTUlQSUFfREFUQV9MRU5HVEgJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4
YjEwYykKPiA+ICsjZGVmaW5lIF9NSVBJQ19EQVRBX0xFTkdUSAkJKGk5MTUtPm1pcGlfbW1pb19i
YXNlICsgMHhiOTBjKQo+ID4gICAjZGVmaW5lIE1JUElfREFUQV9MRU5HVEgocG9ydCkJCV9NTUlP
X01JUEkocG9ydCwgX01JUElBX0RBVEFfTEVOR1RILCBfTUlQSUNfREFUQV9MRU5HVEgpCj4gPiAg
ICNkZWZpbmUgIERBVEFfTEVOR1RIX1NISUZUCQkJCTAKPiA+ICAgI2RlZmluZSAgREFUQV9MRU5H
VEhfTUFTSwkJCQkoMHhmZmZmZiA8PCAwKQo+ID4gLSNkZWZpbmUgX01JUElBX0NPTU1BTkRfQURE
UkVTUwkJKGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjExMCkKPiA+IC0jZGVmaW5lIF9N
SVBJQ19DT01NQU5EX0FERFJFU1MJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI5MTAp
Cj4gPiArI2RlZmluZSBfTUlQSUFfQ09NTUFORF9BRERSRVNTCQkoaTkxNS0+bWlwaV9tbWlvX2Jh
c2UgKyAweGIxMTApCj4gPiArI2RlZmluZSBfTUlQSUNfQ09NTUFORF9BRERSRVNTCQkoaTkxNS0+
bWlwaV9tbWlvX2Jhc2UgKyAweGI5MTApCj4gPiAgICNkZWZpbmUgTUlQSV9DT01NQU5EX0FERFJF
U1MocG9ydCkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFfQ09NTUFORF9BRERSRVNTLCBfTUlQSUNf
Q09NTUFORF9BRERSRVNTKQo+ID4gICAjZGVmaW5lICBDT01NQU5EX01FTV9BRERSRVNTX1NISUZU
CQkJNQo+ID4gICAjZGVmaW5lICBDT01NQU5EX01FTV9BRERSRVNTX01BU0sJCQkoMHg3ZmZmZmZm
IDw8IDUpCj4gPiBAQCAtMTEwNzQsMTggKzExMDc0LDE4IEBAIGVudW0gc2tsX3Bvd2VyX2dhdGUg
ewo+ID4gICAjZGVmaW5lICBNRU1PUllfV1JJVEVfREFUQV9GUk9NX1BJUEVfUkVOREVSSU5HCQko
MSA8PCAxKQo+ID4gICAjZGVmaW5lICBDT01NQU5EX1ZBTElECQkJCQkoMSA8PCAwKQo+ID4gLSNk
ZWZpbmUgX01JUElBX0NPTU1BTkRfTEVOR1RICQkoZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlICsg
MHhiMTE0KQo+ID4gLSNkZWZpbmUgX01JUElDX0NPTU1BTkRfTEVOR1RICQkoZGV2X3ByaXYtPm1p
cGlfbW1pb19iYXNlICsgMHhiOTE0KQo+ID4gKyNkZWZpbmUgX01JUElBX0NPTU1BTkRfTEVOR1RI
CQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIxMTQpCj4gPiArI2RlZmluZSBfTUlQSUNfQ09N
TUFORF9MRU5HVEgJCShpOTE1LT5taXBpX21taW9fYmFzZSArIDB4YjkxNCkKPiA+ICAgI2RlZmlu
ZSBNSVBJX0NPTU1BTkRfTEVOR1RIKHBvcnQpCV9NTUlPX01JUEkocG9ydCwgX01JUElBX0NPTU1B
TkRfTEVOR1RILCBfTUlQSUNfQ09NTUFORF9MRU5HVEgpCj4gPiAgICNkZWZpbmUgIENPTU1BTkRf
TEVOR1RIX1NISUZUKG4pCQkJKDggKiAobikpIC8qIG46IDAuLi4zICovCj4gPiAgICNkZWZpbmUg
IENPTU1BTkRfTEVOR1RIX01BU0sobikJCQkJKDB4ZmYgPDwgKDggKiAobikpKQo+ID4gLSNkZWZp
bmUgX01JUElBX1JFQURfREFUQV9SRVRVUk4wCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAw
eGIxMTgpCj4gPiAtI2RlZmluZSBfTUlQSUNfUkVBRF9EQVRBX1JFVFVSTjAJKGRldl9wcml2LT5t
aXBpX21taW9fYmFzZSArIDB4YjkxOCkKPiA+ICsjZGVmaW5lIF9NSVBJQV9SRUFEX0RBVEFfUkVU
VVJOMAkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAweGIxMTgpCj4gPiArI2RlZmluZSBfTUlQSUNf
UkVBRF9EQVRBX1JFVFVSTjAJKGk5MTUtPm1pcGlfbW1pb19iYXNlICsgMHhiOTE4KQo+ID4gICAj
ZGVmaW5lIE1JUElfUkVBRF9EQVRBX1JFVFVSTihwb3J0LCBuKSBfTU1JTyhfTUlQSShwb3J0LCBf
TUlQSUFfUkVBRF9EQVRBX1JFVFVSTjAsIF9NSVBJQ19SRUFEX0RBVEFfUkVUVVJOMCkgKyA0ICog
KG4pKSAvKiBuOiAwLi4uNyAqLwo+ID4gLSNkZWZpbmUgX01JUElBX1JFQURfREFUQV9WQUxJRAkJ
KGRldl9wcml2LT5taXBpX21taW9fYmFzZSArIDB4YjEzOCkKPiA+IC0jZGVmaW5lIF9NSVBJQ19S
RUFEX0RBVEFfVkFMSUQJCShkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgKyAweGI5MzgpCj4gPiAr
I2RlZmluZSBfTUlQSUFfUkVBRF9EQVRBX1ZBTElECQkoaTkxNS0+bWlwaV9tbWlvX2Jhc2UgKyAw
eGIxMzgpCj4gPiArI2RlZmluZSBfTUlQSUNfUkVBRF9EQVRBX1ZBTElECQkoaTkxNS0+bWlwaV9t
bWlvX2Jhc2UgKyAweGI5MzgpCj4gPiAgICNkZWZpbmUgTUlQSV9SRUFEX0RBVEFfVkFMSUQocG9y
dCkJX01NSU9fTUlQSShwb3J0LCBfTUlQSUFfUkVBRF9EQVRBX1ZBTElELCBfTUlQSUNfUkVBRF9E
QVRBX1ZBTElEKQo+ID4gICAjZGVmaW5lICBSRUFEX0RBVEFfVkFMSUQobikJCQkJKDEgPDwgKG4p
KQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3VzcGVuZC5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zdXNwZW5kLmMKPiA+IGluZGV4IDU4MTIwMWJjYjgx
YS4uNWIzYWQ3YzkyNDBlIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9zdXNwZW5kLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3VzcGVuZC5j
Cj4gPiBAQCAtMzEsMTIxICszMSwxMjEgQEAKPiA+ICAgI2luY2x1ZGUgImludGVsX2ZiYy5oIgo+
ID4gICAjaW5jbHVkZSAiaW50ZWxfZ21idXMuaCIKPiA+IC1zdGF0aWMgdm9pZCBpOTE1X3NhdmVf
ZGlzcGxheShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZv
aWQgaTkxNV9zYXZlX2Rpc3BsYXkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAg
IHsKPiA+ICAgCS8qIERpc3BsYXkgYXJiaXRyYXRpb24gY29udHJvbCAqLwo+ID4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA8PSA0KQo+ID4gLQkJZGV2X3ByaXYtPnJlZ2ZpbGUuc2F2ZURTUEFS
QiA9IEk5MTVfUkVBRChEU1BBUkIpOwo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDQpCj4g
PiArCQlpOTE1LT5yZWdmaWxlLnNhdmVEU1BBUkIgPSBJOTE1X1JFQUQoRFNQQVJCKTsKPiA+ICAg
CS8qIHNhdmUgRkJDIGludGVydmFsICovCj4gPiAtCWlmIChIQVNfRkJDKGRldl9wcml2KSAmJiBJ
TlRFTF9HRU4oZGV2X3ByaXYpIDw9IDQgJiYgIUlTX0c0WChkZXZfcHJpdikpCj4gPiAtCQlkZXZf
cHJpdi0+cmVnZmlsZS5zYXZlRkJDX0NPTlRST0wgPSBJOTE1X1JFQUQoRkJDX0NPTlRST0wpOwo+
ID4gKwlpZiAoSEFTX0ZCQyhpOTE1KSAmJiBJTlRFTF9HRU4oaTkxNSkgPD0gNCAmJiAhSVNfRzRY
KGk5MTUpKQo+ID4gKwkJaTkxNS0+cmVnZmlsZS5zYXZlRkJDX0NPTlRST0wgPSBJOTE1X1JFQUQo
RkJDX0NPTlRST0wpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaTkxNV9yZXN0b3JlX2Rpc3Bs
YXkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGk5
MTVfcmVzdG9yZV9kaXNwbGF5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7
Cj4gPiAgIAkvKiBEaXNwbGF5IGFyYml0cmF0aW9uICovCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpIDw9IDQpCj4gPiAtCQlJOTE1X1dSSVRFKERTUEFSQiwgZGV2X3ByaXYtPnJlZ2ZpbGUu
c2F2ZURTUEFSQik7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPD0gNCkKPiA+ICsJCUk5MTVf
V1JJVEUoRFNQQVJCLCBpOTE1LT5yZWdmaWxlLnNhdmVEU1BBUkIpOwo+ID4gICAJLyogb25seSBy
ZXN0b3JlIEZCQyBpbmZvIG9uIHRoZSBwbGF0Zm9ybSB0aGF0IHN1cHBvcnRzIEZCQyovCj4gPiAt
CWludGVsX2ZiY19nbG9iYWxfZGlzYWJsZShkZXZfcHJpdik7Cj4gPiArCWludGVsX2ZiY19nbG9i
YWxfZGlzYWJsZShpOTE1KTsKPiA+ICAgCS8qIHJlc3RvcmUgRkJDIGludGVydmFsICovCj4gPiAt
CWlmIChIQVNfRkJDKGRldl9wcml2KSAmJiBJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDQgJiYgIUlT
X0c0WChkZXZfcHJpdikpCj4gPiAtCQlJOTE1X1dSSVRFKEZCQ19DT05UUk9MLCBkZXZfcHJpdi0+
cmVnZmlsZS5zYXZlRkJDX0NPTlRST0wpOwo+ID4gKwlpZiAoSEFTX0ZCQyhpOTE1KSAmJiBJTlRF
TF9HRU4oaTkxNSkgPD0gNCAmJiAhSVNfRzRYKGk5MTUpKQo+ID4gKwkJSTkxNV9XUklURShGQkNf
Q09OVFJPTCwgaTkxNS0+cmVnZmlsZS5zYXZlRkJDX0NPTlRST0wpOwo+ID4gLQlpOTE1X3JlZGlz
YWJsZV92Z2EoZGV2X3ByaXYpOwo+ID4gKwlpOTE1X3JlZGlzYWJsZV92Z2EoaTkxNSk7Cj4gPiAg
IH0KPiA+IC1pbnQgaTkxNV9zYXZlX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtpbnQgaTkxNV9zYXZlX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5w
ZGV2Owo+ID4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2Owo+ID4gICAJ
aW50IGk7Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+
ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAtCWk5MTVfc2F2ZV9k
aXNwbGF5KGRldl9wcml2KTsKPiA+ICsJaTkxNV9zYXZlX2Rpc3BsYXkoaTkxNSk7Cj4gPiAtCWlm
IChJU19HRU4oZGV2X3ByaXYsIDQpKQo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDQpKQo+ID4gICAJ
CXBjaV9yZWFkX2NvbmZpZ193b3JkKHBkZXYsIEdDREdNQlVTLAo+ID4gLQkJCQkgICAgICZkZXZf
cHJpdi0+cmVnZmlsZS5zYXZlR0NER01CVVMpOwo+ID4gKwkJCQkgICAgICZpOTE1LT5yZWdmaWxl
LnNhdmVHQ0RHTUJVUyk7Cj4gPiAgIAkvKiBDYWNoZSBtb2RlIHN0YXRlICovCj4gPiAtCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpIDwgNykKPiA+IC0JCWRldl9wcml2LT5yZWdmaWxlLnNhdmVDQUNI
RV9NT0RFXzAgPSBJOTE1X1JFQUQoQ0FDSEVfTU9ERV8wKTsKPiA+ICsJaWYgKElOVEVMX0dFTihp
OTE1KSA8IDcpCj4gPiArCQlpOTE1LT5yZWdmaWxlLnNhdmVDQUNIRV9NT0RFXzAgPSBJOTE1X1JF
QUQoQ0FDSEVfTU9ERV8wKTsKPiA+ICAgCS8qIE1lbW9yeSBBcmJpdHJhdGlvbiBzdGF0ZSAqLwo+
ID4gLQlkZXZfcHJpdi0+cmVnZmlsZS5zYXZlTUlfQVJCX1NUQVRFID0gSTkxNV9SRUFEKE1JX0FS
Ql9TVEFURSk7Cj4gPiArCWk5MTUtPnJlZ2ZpbGUuc2F2ZU1JX0FSQl9TVEFURSA9IEk5MTVfUkVB
RChNSV9BUkJfU1RBVEUpOwo+ID4gICAJLyogU2NyYXRjaCBzcGFjZSAqLwo+ID4gLQlpZiAoSVNf
R0VOKGRldl9wcml2LCAyKSAmJiBJU19NT0JJTEUoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19H
RU4oaTkxNSwgMikgJiYgSVNfTU9CSUxFKGk5MTUpKSB7Cj4gPiAgIAkJZm9yIChpID0gMDsgaSA8
IDc7IGkrKykgewo+ID4gLQkJCWRldl9wcml2LT5yZWdmaWxlLnNhdmVTV0YwW2ldID0gSTkxNV9S
RUFEKFNXRjAoaSkpOwo+ID4gLQkJCWRldl9wcml2LT5yZWdmaWxlLnNhdmVTV0YxW2ldID0gSTkx
NV9SRUFEKFNXRjEoaSkpOwo+ID4gKwkJCWk5MTUtPnJlZ2ZpbGUuc2F2ZVNXRjBbaV0gPSBJOTE1
X1JFQUQoU1dGMChpKSk7Cj4gPiArCQkJaTkxNS0+cmVnZmlsZS5zYXZlU1dGMVtpXSA9IEk5MTVf
UkVBRChTV0YxKGkpKTsKPiA+ICAgCQl9Cj4gPiAgIAkJZm9yIChpID0gMDsgaSA8IDM7IGkrKykK
PiA+IC0JCQlkZXZfcHJpdi0+cmVnZmlsZS5zYXZlU1dGM1tpXSA9IEk5MTVfUkVBRChTV0YzKGkp
KTsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDIpKSB7Cj4gPiArCQkJaTkxNS0+
cmVnZmlsZS5zYXZlU1dGM1tpXSA9IEk5MTVfUkVBRChTV0YzKGkpKTsKPiA+ICsJfSBlbHNlIGlm
IChJU19HRU4oaTkxNSwgMikpIHsKPiA+ICAgCQlmb3IgKGkgPSAwOyBpIDwgNzsgaSsrKQo+ID4g
LQkJCWRldl9wcml2LT5yZWdmaWxlLnNhdmVTV0YxW2ldID0gSTkxNV9SRUFEKFNXRjEoaSkpOwo+
ID4gLQl9IGVsc2UgaWYgKEhBU19HTUNIKGRldl9wcml2KSkgewo+ID4gKwkJCWk5MTUtPnJlZ2Zp
bGUuc2F2ZVNXRjFbaV0gPSBJOTE1X1JFQUQoU1dGMShpKSk7Cj4gPiArCX0gZWxzZSBpZiAoSEFT
X0dNQ0goaTkxNSkpIHsKPiA+ICAgCQlmb3IgKGkgPSAwOyBpIDwgMTY7IGkrKykgewo+ID4gLQkJ
CWRldl9wcml2LT5yZWdmaWxlLnNhdmVTV0YwW2ldID0gSTkxNV9SRUFEKFNXRjAoaSkpOwo+ID4g
LQkJCWRldl9wcml2LT5yZWdmaWxlLnNhdmVTV0YxW2ldID0gSTkxNV9SRUFEKFNXRjEoaSkpOwo+
ID4gKwkJCWk5MTUtPnJlZ2ZpbGUuc2F2ZVNXRjBbaV0gPSBJOTE1X1JFQUQoU1dGMChpKSk7Cj4g
PiArCQkJaTkxNS0+cmVnZmlsZS5zYXZlU1dGMVtpXSA9IEk5MTVfUkVBRChTV0YxKGkpKTsKPiA+
ICAgCQl9Cj4gPiAgIAkJZm9yIChpID0gMDsgaSA8IDM7IGkrKykKPiA+IC0JCQlkZXZfcHJpdi0+
cmVnZmlsZS5zYXZlU1dGM1tpXSA9IEk5MTVfUkVBRChTV0YzKGkpKTsKPiA+ICsJCQlpOTE1LT5y
ZWdmaWxlLnNhdmVTV0YzW2ldID0gSTkxNV9SRUFEKFNXRjMoaSkpOwo+ID4gICAJfQo+ID4gLQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4g
PiAtaW50IGk5MTVfcmVzdG9yZV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiAraW50IGk5MTVfcmVzdG9yZV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0u
cGRldjsKPiA+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiA+ICAg
CWludCBpOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4g
PiArCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQlpZiAoSVNfR0VO
KGRldl9wcml2LCA0KSkKPiA+ICsJaWYgKElTX0dFTihpOTE1LCA0KSkKPiA+ICAgCQlwY2lfd3Jp
dGVfY29uZmlnX3dvcmQocGRldiwgR0NER01CVVMsCj4gPiAtCQkJCSAgICAgIGRldl9wcml2LT5y
ZWdmaWxlLnNhdmVHQ0RHTUJVUyk7Cj4gPiAtCWk5MTVfcmVzdG9yZV9kaXNwbGF5KGRldl9wcml2
KTsKPiA+ICsJCQkJICAgICAgaTkxNS0+cmVnZmlsZS5zYXZlR0NER01CVVMpOwo+ID4gKwlpOTE1
X3Jlc3RvcmVfZGlzcGxheShpOTE1KTsKPiA+ICAgCS8qIENhY2hlIG1vZGUgc3RhdGUgKi8KPiA+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA3KQo+ID4gLQkJSTkxNV9XUklURShDQUNIRV9N
T0RFXzAsIGRldl9wcml2LT5yZWdmaWxlLnNhdmVDQUNIRV9NT0RFXzAgfAo+ID4gKwlpZiAoSU5U
RUxfR0VOKGk5MTUpIDwgNykKPiA+ICsJCUk5MTVfV1JJVEUoQ0FDSEVfTU9ERV8wLCBpOTE1LT5y
ZWdmaWxlLnNhdmVDQUNIRV9NT0RFXzAgfAo+ID4gICAJCQkgICAweGZmZmYwMDAwKTsKPiA+ICAg
CS8qIE1lbW9yeSBhcmJpdHJhdGlvbiBzdGF0ZSAqLwo+ID4gLQlJOTE1X1dSSVRFKE1JX0FSQl9T
VEFURSwgZGV2X3ByaXYtPnJlZ2ZpbGUuc2F2ZU1JX0FSQl9TVEFURSB8IDB4ZmZmZjAwMDApOwo+
ID4gKwlJOTE1X1dSSVRFKE1JX0FSQl9TVEFURSwgaTkxNS0+cmVnZmlsZS5zYXZlTUlfQVJCX1NU
QVRFIHwgMHhmZmZmMDAwMCk7Cj4gPiAgIAkvKiBTY3JhdGNoIHNwYWNlICovCj4gPiAtCWlmIChJ
U19HRU4oZGV2X3ByaXYsIDIpICYmIElTX01PQklMRShkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElT
X0dFTihpOTE1LCAyKSAmJiBJU19NT0JJTEUoaTkxNSkpIHsKPiA+ICAgCQlmb3IgKGkgPSAwOyBp
IDwgNzsgaSsrKSB7Cj4gPiAtCQkJSTkxNV9XUklURShTV0YwKGkpLCBkZXZfcHJpdi0+cmVnZmls
ZS5zYXZlU1dGMFtpXSk7Cj4gPiAtCQkJSTkxNV9XUklURShTV0YxKGkpLCBkZXZfcHJpdi0+cmVn
ZmlsZS5zYXZlU1dGMVtpXSk7Cj4gPiArCQkJSTkxNV9XUklURShTV0YwKGkpLCBpOTE1LT5yZWdm
aWxlLnNhdmVTV0YwW2ldKTsKPiA+ICsJCQlJOTE1X1dSSVRFKFNXRjEoaSksIGk5MTUtPnJlZ2Zp
bGUuc2F2ZVNXRjFbaV0pOwo+ID4gICAJCX0KPiA+ICAgCQlmb3IgKGkgPSAwOyBpIDwgMzsgaSsr
KQo+ID4gLQkJCUk5MTVfV1JJVEUoU1dGMyhpKSwgZGV2X3ByaXYtPnJlZ2ZpbGUuc2F2ZVNXRjNb
aV0pOwo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMikpIHsKPiA+ICsJCQlJOTE1
X1dSSVRFKFNXRjMoaSksIGk5MTUtPnJlZ2ZpbGUuc2F2ZVNXRjNbaV0pOwo+ID4gKwl9IGVsc2Ug
aWYgKElTX0dFTihpOTE1LCAyKSkgewo+ID4gICAJCWZvciAoaSA9IDA7IGkgPCA3OyBpKyspCj4g
PiAtCQkJSTkxNV9XUklURShTV0YxKGkpLCBkZXZfcHJpdi0+cmVnZmlsZS5zYXZlU1dGMVtpXSk7
Cj4gPiAtCX0gZWxzZSBpZiAoSEFTX0dNQ0goZGV2X3ByaXYpKSB7Cj4gPiArCQkJSTkxNV9XUklU
RShTV0YxKGkpLCBpOTE1LT5yZWdmaWxlLnNhdmVTV0YxW2ldKTsKPiA+ICsJfSBlbHNlIGlmIChI
QVNfR01DSChpOTE1KSkgewo+ID4gICAJCWZvciAoaSA9IDA7IGkgPCAxNjsgaSsrKSB7Cj4gPiAt
CQkJSTkxNV9XUklURShTV0YwKGkpLCBkZXZfcHJpdi0+cmVnZmlsZS5zYXZlU1dGMFtpXSk7Cj4g
PiAtCQkJSTkxNV9XUklURShTV0YxKGkpLCBkZXZfcHJpdi0+cmVnZmlsZS5zYXZlU1dGMVtpXSk7
Cj4gPiArCQkJSTkxNV9XUklURShTV0YwKGkpLCBpOTE1LT5yZWdmaWxlLnNhdmVTV0YwW2ldKTsK
PiA+ICsJCQlJOTE1X1dSSVRFKFNXRjEoaSksIGk5MTUtPnJlZ2ZpbGUuc2F2ZVNXRjFbaV0pOwo+
ID4gICAJCX0KPiA+ICAgCQlmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKQo+ID4gLQkJCUk5MTVfV1JJ
VEUoU1dGMyhpKSwgZGV2X3ByaXYtPnJlZ2ZpbGUuc2F2ZVNXRjNbaV0pOwo+ID4gKwkJCUk5MTVf
V1JJVEUoU1dGMyhpKSwgaTkxNS0+cmVnZmlsZS5zYXZlU1dGM1tpXSk7Cj4gPiAgIAl9Cj4gPiAt
CW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwltdXRleF91
bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQlpbnRlbF9nbWJ1c19yZXNldChk
ZXZfcHJpdik7Cj4gPiArCWludGVsX2dtYnVzX3Jlc2V0KGk5MTUpOwo+ID4gICAJcmV0dXJuIDA7
Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2Zz
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMKPiA+IGluZGV4IDNlZjA3Yjk4
N2Q0MC4uOWM4OWJlM2VjNGMxIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9zeXNmcy5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMK
PiA+IEBAIC00MiwxNCArNDIsMTQgQEAgc3RhdGljIGlubGluZSBzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqa2Rldl9taW5vcl90b19pOTE1KHN0cnVjdCBkZXZpY2UgKmtkZXYpCj4gPiAgIH0KPiA+
ICAgI2lmZGVmIENPTkZJR19QTQo+ID4gLXN0YXRpYyB1MzIgY2FsY19yZXNpZGVuY3koc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB1MzIgY2FsY19yZXNpZGVu
Y3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgaTkxNV9yZWdfdCBy
ZWcpCj4gPiAgIHsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJdTY0IHJl
cyA9IDA7Cj4gPiAtCXdpdGhfaW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJlZikKPiA+
IC0JCXJlcyA9IGludGVsX3JjNl9yZXNpZGVuY3lfdXMoZGV2X3ByaXYsIHJlZyk7Cj4gPiArCXdp
dGhfaW50ZWxfcnVudGltZV9wbShpOTE1LCB3YWtlcmVmKQo+ID4gKwkJcmVzID0gaW50ZWxfcmM2
X3Jlc2lkZW5jeV91cyhpOTE1LCByZWcpOwo+ID4gICAJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNU
X1VMTChyZXMsIDEwMDApOwo+ID4gICB9Cj4gPiBAQCAtNTcsMTUgKzU3LDE1IEBAIHN0YXRpYyB1
MzIgY2FsY19yZXNpZGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
ICBzdGF0aWMgc3NpemVfdAo+ID4gICBzaG93X3JjNl9tYXNrKHN0cnVjdCBkZXZpY2UgKmtkZXYs
IHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtk
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGtkZXZfbWlub3JfdG9f
aTkxNShrZGV2KTsKPiA+ICAgCXVuc2lnbmVkIGludCBtYXNrOwo+ID4gICAJbWFzayA9IDA7Cj4g
PiAtCWlmIChIQVNfUkM2KGRldl9wcml2KSkKPiA+ICsJaWYgKEhBU19SQzYoaTkxNSkpCj4gPiAg
IAkJbWFzayB8PSBCSVQoMCk7Cj4gPiAtCWlmIChIQVNfUkM2cChkZXZfcHJpdikpCj4gPiArCWlm
IChIQVNfUkM2cChpOTE1KSkKPiA+ICAgCQltYXNrIHw9IEJJVCgxKTsKPiA+IC0JaWYgKEhBU19S
QzZwcChkZXZfcHJpdikpCj4gPiArCWlmIChIQVNfUkM2cHAoaTkxNSkpCj4gPiAgIAkJbWFzayB8
PSBCSVQoMik7Cj4gPiAgIAlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIleFxuIiwg
bWFzayk7Cj4gPiBAQCAtNzQsMzIgKzc0LDMyIEBAIHNob3dfcmM2X21hc2soc3RydWN0IGRldmlj
ZSAqa2Rldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiA+ICAg
c3RhdGljIHNzaXplX3QKPiA+ICAgc2hvd19yYzZfbXMoc3RydWN0IGRldmljZSAqa2Rldiwgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7
Cj4gPiAtCXUzMiByYzZfcmVzaWRlbmN5ID0gY2FsY19yZXNpZGVuY3koZGV2X3ByaXYsIEdFTjZf
R1RfR0ZYX1JDNik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9t
aW5vcl90b19pOTE1KGtkZXYpOwo+ID4gKwl1MzIgcmM2X3Jlc2lkZW5jeSA9IGNhbGNfcmVzaWRl
bmN5KGk5MTUsIEdFTjZfR1RfR0ZYX1JDNik7Cj4gPiAgIAlyZXR1cm4gc25wcmludGYoYnVmLCBQ
QUdFX1NJWkUsICIldVxuIiwgcmM2X3Jlc2lkZW5jeSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHNz
aXplX3QKPiA+ICAgc2hvd19yYzZwX21zKHN0cnVjdCBkZXZpY2UgKmtkZXYsIHN0cnVjdCBkZXZp
Y2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+ID4gLQl1
MzIgcmM2cF9yZXNpZGVuY3kgPSBjYWxjX3Jlc2lkZW5jeShkZXZfcHJpdiwgR0VONl9HVF9HRlhf
UkM2cCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90
b19pOTE1KGtkZXYpOwo+ID4gKwl1MzIgcmM2cF9yZXNpZGVuY3kgPSBjYWxjX3Jlc2lkZW5jeShp
OTE1LCBHRU42X0dUX0dGWF9SQzZwKTsKPiA+ICAgCXJldHVybiBzbnByaW50ZihidWYsIFBBR0Vf
U0laRSwgIiV1XG4iLCByYzZwX3Jlc2lkZW5jeSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHNzaXpl
X3QKPiA+ICAgc2hvd19yYzZwcF9tcyhzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNl
X2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKPiA+IC0JdTMy
IHJjNnBwX3Jlc2lkZW5jeSA9IGNhbGNfcmVzaWRlbmN5KGRldl9wcml2LCBHRU42X0dUX0dGWF9S
QzZwcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90
b19pOTE1KGtkZXYpOwo+ID4gKwl1MzIgcmM2cHBfcmVzaWRlbmN5ID0gY2FsY19yZXNpZGVuY3ko
aTkxNSwgR0VONl9HVF9HRlhfUkM2cHApOwo+ID4gICAJcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFH
RV9TSVpFLCAiJXVcbiIsIHJjNnBwX3Jlc2lkZW5jeSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHNz
aXplX3QKPiA+ICAgc2hvd19tZWRpYV9yYzZfbXMoc3RydWN0IGRldmljZSAqa2Rldiwgc3RydWN0
IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Cj4g
PiAtCXUzMiByYzZfcmVzaWRlbmN5ID0gY2FsY19yZXNpZGVuY3koZGV2X3ByaXYsIFZMVl9HVF9N
RURJQV9SQzYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGtkZXZfbWlu
b3JfdG9faTkxNShrZGV2KTsKPiA+ICsJdTMyIHJjNl9yZXNpZGVuY3kgPSBjYWxjX3Jlc2lkZW5j
eShpOTE1LCBWTFZfR1RfTUVESUFfUkM2KTsKPiA+ICAgCXJldHVybiBzbnByaW50ZihidWYsIFBB
R0VfU0laRSwgIiV1XG4iLCByYzZfcmVzaWRlbmN5KTsKPiA+ICAgfQo+ID4gQEAgLTE0Miw5ICsx
NDIsOSBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCBtZWRpYV9yYzZfYXR0
cl9ncm91cCA9IHsKPiA+ICAgfTsKPiA+ICAgI2VuZGlmCj4gPiAtc3RhdGljIGludCBsM19hY2Nl
c3NfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBsb2ZmX3Qgb2Zmc2V0
KQo+ID4gK3N0YXRpYyBpbnQgbDNfYWNjZXNzX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCBsb2ZmX3Qgb2Zmc2V0KQo+ID4gICB7Cj4gPiAtCWlmICghSEFTX0wzX0RQRihkZXZf
cHJpdikpCj4gPiArCWlmICghSEFTX0wzX0RQRihpOTE1KSkKPiA+ICAgCQlyZXR1cm4gLUVQRVJN
Owo+ID4gICAJaWYgKG9mZnNldCAlIDQgIT0gMCkKPiA+IEBAIC0xNjIsMTQgKzE2MiwxNCBAQCBp
OTE1X2wzX3JlYWQoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCBrb2JqZWN0ICprb2JqLAo+ID4g
ICAJICAgICBsb2ZmX3Qgb2Zmc2V0LCBzaXplX3QgY291bnQpCj4gPiAgIHsKPiA+ICAgCXN0cnVj
dCBkZXZpY2UgKmtkZXYgPSBrb2JqX3RvX2Rldihrb2JqKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+ID4gLQlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiA+ICAgCWludCBzbGljZSA9IChpbnQpKHVp
bnRwdHJfdClhdHRyLT5wcml2YXRlOwo+ID4gICAJaW50IHJldDsKPiA+ICAgCWNvdW50ID0gcm91
bmRfZG93bihjb3VudCwgNCk7Cj4gPiAtCXJldCA9IGwzX2FjY2Vzc192YWxpZChkZXZfcHJpdiwg
b2Zmc2V0KTsKPiA+ICsJcmV0ID0gbDNfYWNjZXNzX3ZhbGlkKGk5MTUsIG9mZnNldCk7Cj4gPiAg
IAlpZiAocmV0KQo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiBAQCAtMTc5LDkgKzE3OSw5IEBAIGk5
MTVfbDNfcmVhZChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IGtvYmplY3QgKmtvYmosCj4gPiAg
IAlpZiAocmV0KQo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiAtCWlmIChkZXZfcHJpdi0+bDNfcGFy
aXR5LnJlbWFwX2luZm9bc2xpY2VdKQo+ID4gKwlpZiAoaTkxNS0+bDNfcGFyaXR5LnJlbWFwX2lu
Zm9bc2xpY2VdKQo+ID4gICAJCW1lbWNweShidWYsCj4gPiAtCQkgICAgICAgZGV2X3ByaXYtPmwz
X3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNlXSArIChvZmZzZXQvNCksCj4gPiArCQkgICAgICAgaTkx
NS0+bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdICsgKG9mZnNldC80KSwKPiA+ICAgCQkgICAg
ICAgY291bnQpOwo+ID4gICAJZWxzZQo+ID4gICAJCW1lbXNldChidWYsIDAsIGNvdW50KTsKPiA+
IEBAIC0xOTcsMTQgKzE5NywxNCBAQCBpOTE1X2wzX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxwLCBz
dHJ1Y3Qga29iamVjdCAqa29iaiwKPiA+ICAgCSAgICAgIGxvZmZfdCBvZmZzZXQsIHNpemVfdCBj
b3VudCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGRldmljZSAqa2RldiA9IGtvYmpfdG9fZGV2KGtv
YmopOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9y
X3RvX2k5MTUoa2Rldik7Cj4gPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYt
PmRybTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBrZGV2X21pbm9yX3Rv
X2k5MTUoa2Rldik7Cj4gPiArCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+
ID4gICAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eDsKPiA+ICAgCWludCBzbGljZSA9IChp
bnQpKHVpbnRwdHJfdClhdHRyLT5wcml2YXRlOwo+ID4gICAJdTMyICoqcmVtYXBfaW5mbzsKPiA+
ICAgCWludCByZXQ7Cj4gPiAtCXJldCA9IGwzX2FjY2Vzc192YWxpZChkZXZfcHJpdiwgb2Zmc2V0
KTsKPiA+ICsJcmV0ID0gbDNfYWNjZXNzX3ZhbGlkKGk5MTUsIG9mZnNldCk7Cj4gPiAgIAlpZiAo
cmV0KQo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiBAQCAtMjEyLDcgKzIxMiw3IEBAIGk5MTVfbDNf
d3JpdGUoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCBrb2JqZWN0ICprb2JqLAo+ID4gICAJaWYg
KHJldCkKPiA+ICAgCQlyZXR1cm4gcmV0Owo+ID4gLQlyZW1hcF9pbmZvID0gJmRldl9wcml2LT5s
M19wYXJpdHkucmVtYXBfaW5mb1tzbGljZV07Cj4gPiArCXJlbWFwX2luZm8gPSAmaTkxNS0+bDNf
cGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdOwo+ID4gICAJaWYgKCEqcmVtYXBfaW5mbykgewo+ID4g
ICAJCSpyZW1hcF9pbmZvID0ga3phbGxvYyhHRU43X0wzTE9HX1NJWkUsIEdGUF9LRVJORUwpOwo+
ID4gICAJCWlmICghKnJlbWFwX2luZm8pIHsKPiA+IEBAIC0yMjgsNyArMjI4LDcgQEAgaTkxNV9s
M193cml0ZShzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IGtvYmplY3QgKmtvYmosCj4gPiAgIAlt
ZW1jcHkoKnJlbWFwX2luZm8gKyAob2Zmc2V0LzQpLCBidWYsIGNvdW50KTsKPiA+ICAgCS8qIE5C
OiBXZSBkZWZlciB0aGUgcmVtYXBwaW5nIHVudGlsIHdlIHN3aXRjaCB0byB0aGUgY29udGV4dCAq
Lwo+ID4gLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGN0eCwgJmRldl9wcml2LT5jb250ZXh0cy5saXN0
LCBsaW5rKQo+ID4gKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGN0eCwgJmk5MTUtPmNvbnRleHRzLmxp
c3QsIGxpbmspCj4gPiAgIAkJY3R4LT5yZW1hcF9zbGljZSB8PSAoMTw8c2xpY2UpOwo+ID4gICAJ
cmV0ID0gY291bnQ7Cj4gPiBAQCAtMjYwLDUyICsyNjAsNTIgQEAgc3RhdGljIGNvbnN0IHN0cnVj
dCBiaW5fYXR0cmlidXRlIGRwZl9hdHRyc18xID0gewo+ID4gICBzdGF0aWMgc3NpemVfdCBndF9h
Y3RfZnJlcV9taHpfc2hvdyhzdHJ1Y3QgZGV2aWNlICprZGV2LAo+ID4gICAJCQkJICAgIHN0cnVj
dCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGtkZXZfbWlub3JfdG9faTkxNShr
ZGV2KTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJdTMyIGZyZXE7Cj4g
PiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gPiArCXdha2Vy
ZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiA+IC0JaWYgKElTX1ZBTExFWVZJRVco
ZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiAtCQl2bHZfcHVuaXRf
Z2V0KGRldl9wcml2KTsKPiA+IC0JCWZyZXEgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVO
SVRfUkVHX0dQVV9GUkVRX1NUUyk7Cj4gPiAtCQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKPiA+
ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ID4g
KwkJdmx2X3B1bml0X2dldChpOTE1KTsKPiA+ICsJCWZyZXEgPSB2bHZfcHVuaXRfcmVhZChpOTE1
LCBQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTKTsKPiA+ICsJCXZsdl9wdW5pdF9wdXQoaTkxNSk7Cj4g
PiAgIAkJZnJlcSA9IChmcmVxID4+IDgpICYgMHhmZjsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAtCQlm
cmVxID0gaW50ZWxfZ2V0X2NhZ2YoZGV2X3ByaXYsIEk5MTVfUkVBRChHRU42X1JQU1RBVDEpKTsK
PiA+ICsJCWZyZXEgPSBpbnRlbF9nZXRfY2FnZihpOTE1LCBJOTE1X1JFQUQoR0VONl9SUFNUQVQx
KSk7Cj4gPiAgIAl9Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVm
KTsKPiA+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7Cj4gPiAtCXJldHVy
biBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIiVkXG4iLCBpbnRlbF9ncHVfZnJlcShkZXZfcHJp
diwgZnJlcSkpOwo+ID4gKwlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIlZFxuIiwg
aW50ZWxfZ3B1X2ZyZXEoaTkxNSwgZnJlcSkpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBzc2l6ZV90
IGd0X2N1cl9mcmVxX21oel9zaG93KHN0cnVjdCBkZXZpY2UgKmtkZXYsCj4gPiAgIAkJCQkgICAg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiA+ICAgewo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19p
OTE1KGtkZXYpOwo+ID4gICAJcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJWRcbiIs
Cj4gPiAtCQkJaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsCj4gPiAtCQkJCSAgICAgICBkZXZfcHJp
di0+Z3RfcG0ucnBzLmN1cl9mcmVxKSk7Cj4gPiArCQkJaW50ZWxfZ3B1X2ZyZXEoaTkxNSwKPiA+
ICsJCQkJICAgICAgIGk5MTUtPmd0X3BtLnJwcy5jdXJfZnJlcSkpOwo+ID4gICB9Cj4gPiAgIHN0
YXRpYyBzc2l6ZV90IGd0X2Jvb3N0X2ZyZXFfbWh6X3Nob3coc3RydWN0IGRldmljZSAqa2Rldiwg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiA+ICAgewo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19p
OTE1KGtkZXYpOwo+ID4gICAJcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJWRcbiIs
Cj4gPiAtCQkJaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsCj4gPiAtCQkJCSAgICAgICBkZXZfcHJp
di0+Z3RfcG0ucnBzLmJvb3N0X2ZyZXEpKTsKPiA+ICsJCQlpbnRlbF9ncHVfZnJlcShpOTE1LAo+
ID4gKwkJCQkgICAgICAgaTkxNS0+Z3RfcG0ucnBzLmJvb3N0X2ZyZXEpKTsKPiA+ICAgfQo+ID4g
ICBzdGF0aWMgc3NpemVfdCBndF9ib29zdF9mcmVxX21oel9zdG9yZShzdHJ1Y3QgZGV2aWNlICpr
ZGV2LAo+ID4gICAJCQkJICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+ID4g
ICAJCQkJICAgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGNvdW50KQo+ID4gICB7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkxNShr
ZGV2KTsKPiA+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19pOTE1
KGtkZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+
ID4gICAJYm9vbCBib29zdCA9IGZhbHNlOwo+ID4gICAJc3NpemVfdCByZXQ7Cj4gPiAgIAl1MzIg
dmFsOwo+ID4gQEAgLTMxNSw3ICszMTUsNyBAQCBzdGF0aWMgc3NpemVfdCBndF9ib29zdF9mcmVx
X21oel9zdG9yZShzdHJ1Y3QgZGV2aWNlICprZGV2LAo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiAg
IAkvKiBWYWxpZGF0ZSBhZ2FpbnN0IChzdGF0aWMpIGhhcmR3YXJlIGxpbWl0cyAqLwo+ID4gLQl2
YWwgPSBpbnRlbF9mcmVxX29wY29kZShkZXZfcHJpdiwgdmFsKTsKPiA+ICsJdmFsID0gaW50ZWxf
ZnJlcV9vcGNvZGUoaTkxNSwgdmFsKTsKPiA+ICAgCWlmICh2YWwgPCBycHMtPm1pbl9mcmVxIHx8
IHZhbCA+IHJwcy0+bWF4X2ZyZXEpCj4gPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gPiBAQCAtMzM0
LDI4ICszMzQsMjggQEAgc3RhdGljIHNzaXplX3QgZ3RfYm9vc3RfZnJlcV9taHpfc3RvcmUoc3Ry
dWN0IGRldmljZSAqa2RldiwKPiA+ICAgc3RhdGljIHNzaXplX3Qgdmx2X3JwZV9mcmVxX21oel9z
aG93KHN0cnVjdCBkZXZpY2UgKmtkZXYsCj4gPiAgIAkJCQkgICAgIHN0cnVjdCBkZXZpY2VfYXR0
cmlidXRlICphdHRyLCBjaGFyICpidWYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKPiA+ICAg
CXJldHVybiBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIiVkXG4iLAo+ID4gLQkJCWludGVsX2dw
dV9mcmVxKGRldl9wcml2LAo+ID4gLQkJCQkgICAgICAgZGV2X3ByaXYtPmd0X3BtLnJwcy5lZmZp
Y2llbnRfZnJlcSkpOwo+ID4gKwkJCWludGVsX2dwdV9mcmVxKGk5MTUsCj4gPiArCQkJCSAgICAg
ICBpOTE1LT5ndF9wbS5ycHMuZWZmaWNpZW50X2ZyZXEpKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMg
c3NpemVfdCBndF9tYXhfZnJlcV9taHpfc2hvdyhzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3Qg
ZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rl
dik7Cj4gPiAgIAlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIlZFxuIiwKPiA+IC0J
CQlpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwKPiA+IC0JCQkJICAgICAgIGRldl9wcml2LT5ndF9w
bS5ycHMubWF4X2ZyZXFfc29mdGxpbWl0KSk7Cj4gPiArCQkJaW50ZWxfZ3B1X2ZyZXEoaTkxNSwK
PiA+ICsJCQkJICAgICAgIGk5MTUtPmd0X3BtLnJwcy5tYXhfZnJlcV9zb2Z0bGltaXQpKTsKPiA+
ICAgfQo+ID4gICBzdGF0aWMgc3NpemVfdCBndF9tYXhfZnJlcV9taHpfc3RvcmUoc3RydWN0IGRl
dmljZSAqa2RldiwKPiA+ICAgCQkJCSAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIs
Cj4gPiAgIAkJCQkgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGNvdW50KQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkx
NShrZGV2KTsKPiA+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5y
cHM7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19p
OTE1KGtkZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBz
Owo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gICAJ
c3NpemVfdCByZXQ7Cj4gPiBAQCAtMzY0LDEwICszNjQsMTAgQEAgc3RhdGljIHNzaXplX3QgZ3Rf
bWF4X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCj4gPiAgIAlpZiAocmV0KQo+
ID4gICAJCXJldHVybiByZXQ7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChk
ZXZfcHJpdik7Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiA+
ICAgCW11dGV4X2xvY2soJnJwcy0+bG9jayk7Cj4gPiAtCXZhbCA9IGludGVsX2ZyZXFfb3Bjb2Rl
KGRldl9wcml2LCB2YWwpOwo+ID4gKwl2YWwgPSBpbnRlbF9mcmVxX29wY29kZShpOTE1LCB2YWwp
Owo+ID4gICAJaWYgKHZhbCA8IHJwcy0+bWluX2ZyZXEgfHwKPiA+ICAgCSAgICB2YWwgPiBycHMt
Pm1heF9mcmVxIHx8Cj4gPiAgIAkgICAgdmFsIDwgcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQpIHsK
PiA+IEBAIC0zNzcsNyArMzc3LDcgQEAgc3RhdGljIHNzaXplX3QgZ3RfbWF4X2ZyZXFfbWh6X3N0
b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCj4gPiAgIAlpZiAodmFsID4gcnBzLT5ycDBfZnJlcSkK
PiA+ICAgCQlEUk1fREVCVUcoIlVzZXIgcmVxdWVzdGVkIG92ZXJjbG9ja2luZyB0byAlZFxuIiwK
PiA+IC0JCQkgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCB2YWwpKTsKPiA+ICsJCQkgIGludGVs
X2dwdV9mcmVxKGk5MTUsIHZhbCkpOwo+ID4gICAJcnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQgPSB2
YWw7Cj4gPiBAQCAtMzg4LDMwICszODgsMzAgQEAgc3RhdGljIHNzaXplX3QgZ3RfbWF4X2ZyZXFf
bWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCj4gPiAgIAkvKiBXZSBzdGlsbCBuZWVkICpf
c2V0X3JwcyB0byBwcm9jZXNzIHRoZSBuZXcgbWF4X2RlbGF5IGFuZAo+ID4gICAJICogdXBkYXRl
IHRoZSBpbnRlcnJ1cHQgbGltaXRzIGFuZCBQTUlOVFJNU0sgZXZlbiB0aG91Z2gKPiA+ICAgCSAq
IGZyZXF1ZW5jeSByZXF1ZXN0IG1heSBiZSB1bmNoYW5nZWQuICovCj4gPiAtCXJldCA9IGludGVs
X3NldF9ycHMoZGV2X3ByaXYsIHZhbCk7Cj4gPiArCXJldCA9IGludGVsX3NldF9ycHMoaTkxNSwg
dmFsKTsKPiA+ICAgdW5sb2NrOgo+ID4gICAJbXV0ZXhfdW5sb2NrKCZycHMtPmxvY2spOwo+ID4g
LQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7Cj4gPiArCWludGVsX3J1
bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOwo+ID4gICAJcmV0dXJuIHJldCA/OiBjb3VudDsK
PiA+ICAgfQo+ID4gICBzdGF0aWMgc3NpemVfdCBndF9taW5fZnJlcV9taHpfc2hvdyhzdHJ1Y3Qg
ZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlu
b3JfdG9faTkxNShrZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBr
ZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Cj4gPiAgIAlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdF
X1NJWkUsICIlZFxuIiwKPiA+IC0JCQlpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwKPiA+IC0JCQkJ
ICAgICAgIGRldl9wcml2LT5ndF9wbS5ycHMubWluX2ZyZXFfc29mdGxpbWl0KSk7Cj4gPiArCQkJ
aW50ZWxfZ3B1X2ZyZXEoaTkxNSwKPiA+ICsJCQkJICAgICAgIGk5MTUtPmd0X3BtLnJwcy5taW5f
ZnJlcV9zb2Z0bGltaXQpKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgc3NpemVfdCBndF9taW5fZnJl
cV9taHpfc3RvcmUoc3RydWN0IGRldmljZSAqa2RldiwKPiA+ICAgCQkJCSAgICAgc3RydWN0IGRl
dmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gPiAgIAkJCQkgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6
ZV90IGNvdW50KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKPiA+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBz
ID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpy
cHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4g
PiAgIAl1MzIgdmFsOwo+ID4gICAJc3NpemVfdCByZXQ7Cj4gPiBAQCAtNDIwLDEwICs0MjAsMTAg
QEAgc3RhdGljIHNzaXplX3QgZ3RfbWluX2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtk
ZXYsCj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiAtCXdha2VyZWYgPSBp
bnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9ydW50
aW1lX3BtX2dldChpOTE1KTsKPiA+ICAgCW11dGV4X2xvY2soJnJwcy0+bG9jayk7Cj4gPiAtCXZh
bCA9IGludGVsX2ZyZXFfb3Bjb2RlKGRldl9wcml2LCB2YWwpOwo+ID4gKwl2YWwgPSBpbnRlbF9m
cmVxX29wY29kZShpOTE1LCB2YWwpOwo+ID4gICAJaWYgKHZhbCA8IHJwcy0+bWluX2ZyZXEgfHwK
PiA+ICAgCSAgICB2YWwgPiBycHMtPm1heF9mcmVxIHx8Cj4gPiAgIAkgICAgdmFsID4gcnBzLT5t
YXhfZnJlcV9zb2Z0bGltaXQpIHsKPiA+IEBAIC00NDAsMTEgKzQ0MCwxMSBAQCBzdGF0aWMgc3Np
emVfdCBndF9taW5fZnJlcV9taHpfc3RvcmUoc3RydWN0IGRldmljZSAqa2RldiwKPiA+ICAgCS8q
IFdlIHN0aWxsIG5lZWQgKl9zZXRfcnBzIHRvIHByb2Nlc3MgdGhlIG5ldyBtaW5fZGVsYXkgYW5k
Cj4gPiAgIAkgKiB1cGRhdGUgdGhlIGludGVycnVwdCBsaW1pdHMgYW5kIFBNSU5UUk1TSyBldmVu
IHRob3VnaAo+ID4gICAJICogZnJlcXVlbmN5IHJlcXVlc3QgbWF5IGJlIHVuY2hhbmdlZC4gKi8K
PiA+IC0JcmV0ID0gaW50ZWxfc2V0X3JwcyhkZXZfcHJpdiwgdmFsKTsKPiA+ICsJcmV0ID0gaW50
ZWxfc2V0X3JwcyhpOTE1LCB2YWwpOwo+ID4gICB1bmxvY2s6Cj4gPiAgIAltdXRleF91bmxvY2so
JnJwcy0+bG9jayk7Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVm
KTsKPiA+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1
cm4gcmV0ID86IGNvdW50Owo+ID4gICB9Cj4gPiBAQCAtNDY1LDE2ICs0NjUsMTYgQEAgc3RhdGlj
IERFVklDRV9BVFRSKGd0X1JQbl9mcmVxX21oeiwgU19JUlVHTywgZ3RfcnBfbWh6X3Nob3csIE5V
TEwpOwo+ID4gICAvKiBGb3Igbm93IHdlIGhhdmUgYSBzdGF0aWMgbnVtYmVyIG9mIFJQIHN0YXRl
cyAqLwo+ID4gICBzdGF0aWMgc3NpemVfdCBndF9ycF9taHpfc2hvdyhzdHJ1Y3QgZGV2aWNlICpr
ZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkx
NShrZGV2KTsKPiA+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5y
cHM7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19p
OTE1KGtkZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBz
Owo+ID4gICAJdTMyIHZhbDsKPiA+ICAgCWlmIChhdHRyID09ICZkZXZfYXR0cl9ndF9SUDBfZnJl
cV9taHopCj4gPiAtCQl2YWwgPSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5ycDBfZnJl
cSk7Cj4gPiArCQl2YWwgPSBpbnRlbF9ncHVfZnJlcShpOTE1LCBycHMtPnJwMF9mcmVxKTsKPiA+
ICAgCWVsc2UgaWYgKGF0dHIgPT0gJmRldl9hdHRyX2d0X1JQMV9mcmVxX21oeikKPiA+IC0JCXZh
bCA9IGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPnJwMV9mcmVxKTsKPiA+ICsJCXZhbCA9
IGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+cnAxX2ZyZXEpOwo+ID4gICAJZWxzZSBpZiAoYXR0
ciA9PSAmZGV2X2F0dHJfZ3RfUlBuX2ZyZXFfbWh6KQo+ID4gLQkJdmFsID0gaW50ZWxfZ3B1X2Zy
ZXEoZGV2X3ByaXYsIHJwcy0+bWluX2ZyZXEpOwo+ID4gKwkJdmFsID0gaW50ZWxfZ3B1X2ZyZXEo
aTkxNSwgcnBzLT5taW5fZnJlcSk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJQlVHKCk7Cj4gPiBAQCAt
NTQwLDEwICs1NDAsMTAgQEAgc3RhdGljIHNzaXplX3QgZXJyb3Jfc3RhdGVfd3JpdGUoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCBrb2JqZWN0ICprb2JqLAo+ID4gICAJCQkJIGxvZmZfdCBvZmYs
IHNpemVfdCBjb3VudCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGRldmljZSAqa2RldiA9IGtvYmpf
dG9fZGV2KGtvYmopOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBr
ZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwo+ID4gICAJRFJNX0RFQlVHX0RSSVZFUigi
UmVzZXR0aW5nIGVycm9yIHN0YXRlXG4iKTsKPiA+IC0JaTkxNV9yZXNldF9lcnJvcl9zdGF0ZShk
ZXZfcHJpdik7Cj4gPiArCWk5MTVfcmVzZXRfZXJyb3Jfc3RhdGUoaTkxNSk7Cj4gPiAgIAlyZXR1
cm4gY291bnQ7Cj4gPiAgIH0KPiA+IEBAIC01NzEsMzcgKzU3MSwzNyBAQCBzdGF0aWMgdm9pZCBp
OTE1X3NldHVwX2Vycm9yX2NhcHR1cmUoc3RydWN0IGRldmljZSAqa2Rldikge30KPiA+ICAgc3Rh
dGljIHZvaWQgaTkxNV90ZWFyZG93bl9lcnJvcl9jYXB0dXJlKHN0cnVjdCBkZXZpY2UgKmtkZXYp
IHt9Cj4gPiAgICNlbmRpZgo+ID4gLXZvaWQgaTkxNV9zZXR1cF9zeXNmcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpOTE1X3NldHVwX3N5c2ZzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkZXZpY2UgKmtkZXYg
PSBkZXZfcHJpdi0+ZHJtLnByaW1hcnktPmtkZXY7Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmtkZXYg
PSBpOTE1LT5kcm0ucHJpbWFyeS0+a2RldjsKPiA+ICAgCWludCByZXQ7Cj4gPiAgICNpZmRlZiBD
T05GSUdfUE0KPiA+IC0JaWYgKEhBU19SQzYoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChIQVNfUkM2
KGk5MTUpKSB7Cj4gPiAgIAkJcmV0ID0gc3lzZnNfbWVyZ2VfZ3JvdXAoJmtkZXYtPmtvYmosCj4g
PiAgIAkJCQkJJnJjNl9hdHRyX2dyb3VwKTsKPiA+ICAgCQlpZiAocmV0KQo+ID4gICAJCQlEUk1f
RVJST1IoIlJDNiByZXNpZGVuY3kgc3lzZnMgc2V0dXAgZmFpbGVkXG4iKTsKPiA+ICAgCX0KPiA+
IC0JaWYgKEhBU19SQzZwKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX1JDNnAoaTkxNSkpIHsK
PiA+ICAgCQlyZXQgPSBzeXNmc19tZXJnZV9ncm91cCgma2Rldi0+a29iaiwKPiA+ICAgCQkJCQkm
cmM2cF9hdHRyX2dyb3VwKTsKPiA+ICAgCQlpZiAocmV0KQo+ID4gICAJCQlEUk1fRVJST1IoIlJD
NnAgcmVzaWRlbmN5IHN5c2ZzIHNldHVwIGZhaWxlZFxuIik7Cj4gPiAgIAl9Cj4gPiAtCWlmIChJ
U19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4g
KwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiAg
IAkJcmV0ID0gc3lzZnNfbWVyZ2VfZ3JvdXAoJmtkZXYtPmtvYmosCj4gPiAgIAkJCQkJJm1lZGlh
X3JjNl9hdHRyX2dyb3VwKTsKPiA+ICAgCQlpZiAocmV0KQo+ID4gICAJCQlEUk1fRVJST1IoIk1l
ZGlhIFJDNiByZXNpZGVuY3kgc3lzZnMgc2V0dXAgZmFpbGVkXG4iKTsKPiA+ICAgCX0KPiA+ICAg
I2VuZGlmCj4gPiAtCWlmIChIQVNfTDNfRFBGKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX0wz
X0RQRihpOTE1KSkgewo+ID4gICAJCXJldCA9IGRldmljZV9jcmVhdGVfYmluX2ZpbGUoa2Rldiwg
JmRwZl9hdHRycyk7Cj4gPiAgIAkJaWYgKHJldCkKPiA+ICAgCQkJRFJNX0VSUk9SKCJsMyBwYXJp
dHkgc3lzZnMgc2V0dXAgZmFpbGVkXG4iKTsKPiA+IC0JCWlmIChOVU1fTDNfU0xJQ0VTKGRldl9w
cml2KSA+IDEpIHsKPiA+ICsJCWlmIChOVU1fTDNfU0xJQ0VTKGk5MTUpID4gMSkgewo+ID4gICAJ
CQlyZXQgPSBkZXZpY2VfY3JlYXRlX2Jpbl9maWxlKGtkZXYsCj4gPiAgIAkJCQkJCSAgICAgJmRw
Zl9hdHRyc18xKTsKPiA+ICAgCQkJaWYgKHJldCkKPiA+IEBAIC02MTAsOSArNjEwLDkgQEAgdm9p
ZCBpOTE1X3NldHVwX3N5c2ZzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCX0KPiA+ICAgCXJldCA9IDA7Cj4gPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8
fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkg
fHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICAgCQlyZXQgPSBzeXNmc19jcmVhdGVfZmlsZXMo
JmtkZXYtPmtvYmosIHZsdl9hdHRycyk7Cj4gPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPj0gNikKPiA+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCj4gPiAgIAkJcmV0
ID0gc3lzZnNfY3JlYXRlX2ZpbGVzKCZrZGV2LT5rb2JqLCBnZW42X2F0dHJzKTsKPiA+ICAgCWlm
IChyZXQpCj4gPiAgIAkJRFJNX0VSUk9SKCJSUFMgc3lzZnMgc2V0dXAgZmFpbGVkXG4iKTsKPiA+
IEBAIC02MjAsMTMgKzYyMCwxMyBAQCB2b2lkIGk5MTVfc2V0dXBfc3lzZnMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJaTkxNV9zZXR1cF9lcnJvcl9jYXB0dXJlKGtk
ZXYpOwo+ID4gICB9Cj4gPiAtdm9pZCBpOTE1X3RlYXJkb3duX3N5c2ZzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGk5MTVfdGVhcmRvd25fc3lzZnMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRldmljZSAqa2Rl
diA9IGRldl9wcml2LT5kcm0ucHJpbWFyeS0+a2RldjsKPiA+ICsJc3RydWN0IGRldmljZSAqa2Rl
diA9IGk5MTUtPmRybS5wcmltYXJ5LT5rZGV2Owo+ID4gICAJaTkxNV90ZWFyZG93bl9lcnJvcl9j
YXB0dXJlKGtkZXYpOwo+ID4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpCj4gPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NI
RVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJc3lzZnNfcmVtb3ZlX2ZpbGVzKCZrZGV2LT5rb2JqLCB2
bHZfYXR0cnMpOwo+ID4gICAJZWxzZQo+ID4gICAJCXN5c2ZzX3JlbW92ZV9maWxlcygma2Rldi0+
a29iaiwgZ2VuNl9hdHRycyk7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV90cmFjZS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCj4gPiBpbmRl
eCA1YzhjZmFhNzBkNzIuLjk1NDhiOWZlNDE5OSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfdHJhY2UuaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV90cmFjZS5oCj4gPiBAQCAtMjEsOCArMjEsOCBAQAo+ID4gICAvKiB3YXRlcm1hcmsvZmlmbyB1
cGRhdGVzICovCj4gPiAgIFRSQUNFX0VWRU5UKGludGVsX3BpcGVfZW5hYmxlLAo+ID4gLQkgICAg
VFBfUFJPVE8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlw
ZSksCj4gPiAtCSAgICBUUF9BUkdTKGRldl9wcml2LCBwaXBlKSwKPiA+ICsJICAgIFRQX1BST1RP
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSksCj4gPiArCSAg
ICBUUF9BUkdTKGk5MTUsIHBpcGUpLAo+ID4gICAJICAgIFRQX1NUUlVDVF9fZW50cnkoCj4gPiAg
IAkJCSAgICAgX19hcnJheSh1MzIsIGZyYW1lLCAzKQo+ID4gQEAgLTMyLDExICszMiwxMSBAQCBU
UkFDRV9FVkVOVChpbnRlbF9waXBlX2VuYWJsZSwKPiA+ICAgCSAgICBUUF9mYXN0X2Fzc2lnbigK
PiA+ICAgCQkJICAgZW51bSBwaXBlIF9waXBlOwo+ID4gLQkJCSAgIGZvcl9lYWNoX3BpcGUoZGV2
X3ByaXYsIF9waXBlKSB7Cj4gPiArCQkJICAgZm9yX2VhY2hfcGlwZShpOTE1LCBfcGlwZSkgewo+
ID4gICAJCQkJICAgX19lbnRyeS0+ZnJhbWVbX3BpcGVdID0KPiA+IC0JCQkJCSAgIGRldl9wcml2
LT5kcm0uZHJpdmVyLT5nZXRfdmJsYW5rX2NvdW50ZXIoJmRldl9wcml2LT5kcm0sIF9waXBlKTsK
PiA+ICsJCQkJCSAgIGk5MTUtPmRybS5kcml2ZXItPmdldF92YmxhbmtfY291bnRlcigmaTkxNS0+
ZHJtLCBfcGlwZSk7Cj4gPiAgIAkJCQkgICBfX2VudHJ5LT5zY2FubGluZVtfcGlwZV0gPQo+ID4g
LQkJCQkJICAgaW50ZWxfZ2V0X2NydGNfc2NhbmxpbmUoaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUo
ZGV2X3ByaXYsIF9waXBlKSk7Cj4gPiArCQkJCQkgICBpbnRlbF9nZXRfY3J0Y19zY2FubGluZShp
bnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBfcGlwZSkpOwo+ID4gICAJCQkgICB9Cj4gPiAg
IAkJCSAgIF9fZW50cnktPnBpcGUgPSBwaXBlOwo+ID4gICAJCQkgICApLAo+ID4gQEAgLTQ5LDgg
KzQ5LDggQEAgVFJBQ0VfRVZFTlQoaW50ZWxfcGlwZV9lbmFibGUsCj4gPiAgICk7Cj4gPiAgIFRS
QUNFX0VWRU5UKGludGVsX3BpcGVfZGlzYWJsZSwKPiA+IC0JICAgIFRQX1BST1RPKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpLAo+ID4gLQkgICAgVFBf
QVJHUyhkZXZfcHJpdiwgcGlwZSksCj4gPiArCSAgICBUUF9QUk9UTyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgZW51bSBwaXBlIHBpcGUpLAo+ID4gKwkgICAgVFBfQVJHUyhpOTE1LCBw
aXBlKSwKPiA+ICAgCSAgICBUUF9TVFJVQ1RfX2VudHJ5KAo+ID4gICAJCQkgICAgIF9fYXJyYXko
dTMyLCBmcmFtZSwgMykKPiA+IEBAIC02MCwxMSArNjAsMTEgQEAgVFJBQ0VfRVZFTlQoaW50ZWxf
cGlwZV9kaXNhYmxlLAo+ID4gICAJICAgIFRQX2Zhc3RfYXNzaWduKAo+ID4gICAJCQkgICBlbnVt
IHBpcGUgX3BpcGU7Cj4gPiAtCQkJICAgZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgX3BpcGUpIHsK
PiA+ICsJCQkgICBmb3JfZWFjaF9waXBlKGk5MTUsIF9waXBlKSB7Cj4gPiAgIAkJCQkgICBfX2Vu
dHJ5LT5mcmFtZVtfcGlwZV0gPQo+ID4gLQkJCQkJICAgZGV2X3ByaXYtPmRybS5kcml2ZXItPmdl
dF92YmxhbmtfY291bnRlcigmZGV2X3ByaXYtPmRybSwgX3BpcGUpOwo+ID4gKwkJCQkJICAgaTkx
NS0+ZHJtLmRyaXZlci0+Z2V0X3ZibGFua19jb3VudGVyKCZpOTE1LT5kcm0sIF9waXBlKTsKPiA+
ICAgCQkJCSAgIF9fZW50cnktPnNjYW5saW5lW19waXBlXSA9Cj4gPiAtCQkJCQkgICBpbnRlbF9n
ZXRfY3J0Y19zY2FubGluZShpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgX3BpcGUp
KTsKPiA+ICsJCQkJCSAgIGludGVsX2dldF9jcnRjX3NjYW5saW5lKGludGVsX2dldF9jcnRjX2Zv
cl9waXBlKGk5MTUsIF9waXBlKSk7Cj4gPiAgIAkJCSAgIH0KPiA+ICAgCQkJICAgX19lbnRyeS0+
cGlwZSA9IHBpcGU7Cj4gPiAgIAkJCSAgICksCj4gPiBAQCAtMTAyLDggKzEwMiw4IEBAIFRSQUNF
X0VWRU5UKGludGVsX3BpcGVfY3JjLAo+ID4gICApOwo+ID4gICBUUkFDRV9FVkVOVChpbnRlbF9j
cHVfZmlmb191bmRlcnJ1biwKPiA+IC0JICAgIFRQX1BST1RPKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpLAo+ID4gLQkgICAgVFBfQVJHUyhkZXZfcHJp
diwgcGlwZSksCj4gPiArCSAgICBUUF9QUk9UTyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwgZW51bSBwaXBlIHBpcGUpLAo+ID4gKwkgICAgVFBfQVJHUyhpOTE1LCBwaXBlKSwKPiA+ICAg
CSAgICBUUF9TVFJVQ1RfX2VudHJ5KAo+ID4gICAJCQkgICAgIF9fZmllbGQoZW51bSBwaXBlLCBw
aXBlKQo+ID4gQEAgLTExMyw4ICsxMTMsOCBAQCBUUkFDRV9FVkVOVChpbnRlbF9jcHVfZmlmb191
bmRlcnJ1biwKPiA+ICAgCSAgICBUUF9mYXN0X2Fzc2lnbigKPiA+ICAgCQkJICAgX19lbnRyeS0+
cGlwZSA9IHBpcGU7Cj4gPiAtCQkJICAgX19lbnRyeS0+ZnJhbWUgPSBkZXZfcHJpdi0+ZHJtLmRy
aXZlci0+Z2V0X3ZibGFua19jb3VudGVyKCZkZXZfcHJpdi0+ZHJtLCBwaXBlKTsKPiA+IC0JCQkg
ICBfX2VudHJ5LT5zY2FubGluZSA9IGludGVsX2dldF9jcnRjX3NjYW5saW5lKGludGVsX2dldF9j
cnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKSk7Cj4gPiArCQkJICAgX19lbnRyeS0+ZnJhbWUg
PSBpOTE1LT5kcm0uZHJpdmVyLT5nZXRfdmJsYW5rX2NvdW50ZXIoJmk5MTUtPmRybSwgcGlwZSk7
Cj4gPiArCQkJICAgX19lbnRyeS0+c2NhbmxpbmUgPSBpbnRlbF9nZXRfY3J0Y19zY2FubGluZShp
bnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwaXBlKSk7Cj4gPiAgIAkJCSAgICksCj4gPiAg
IAkgICAgVFBfcHJpbnRrKCJwaXBlICVjLCBmcmFtZT0ldSwgc2NhbmxpbmU9JXUiLAo+ID4gQEAg
LTEyMyw4ICsxMjMsOCBAQCBUUkFDRV9FVkVOVChpbnRlbF9jcHVfZmlmb191bmRlcnJ1biwKPiA+
ICAgKTsKPiA+ICAgVFJBQ0VfRVZFTlQoaW50ZWxfcGNoX2ZpZm9fdW5kZXJydW4sCj4gPiAtCSAg
ICBUUF9QUk9UTyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBw
Y2hfdHJhbnNjb2RlciksCj4gPiAtCSAgICBUUF9BUkdTKGRldl9wcml2LCBwY2hfdHJhbnNjb2Rl
ciksCj4gPiArCSAgICBUUF9QUk9UTyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51
bSBwaXBlIHBjaF90cmFuc2NvZGVyKSwKPiA+ICsJICAgIFRQX0FSR1MoaTkxNSwgcGNoX3RyYW5z
Y29kZXIpLAo+ID4gICAJICAgIFRQX1NUUlVDVF9fZW50cnkoCj4gPiAgIAkJCSAgICAgX19maWVs
ZChlbnVtIHBpcGUsIHBpcGUpCj4gPiBAQCAtMTM1LDggKzEzNSw4IEBAIFRSQUNFX0VWRU5UKGlu
dGVsX3BjaF9maWZvX3VuZGVycnVuLAo+ID4gICAJICAgIFRQX2Zhc3RfYXNzaWduKAo+ID4gICAJ
CQkgICBlbnVtIHBpcGUgcGlwZSA9IHBjaF90cmFuc2NvZGVyOwo+ID4gICAJCQkgICBfX2VudHJ5
LT5waXBlID0gcGlwZTsKPiA+IC0JCQkgICBfX2VudHJ5LT5mcmFtZSA9IGRldl9wcml2LT5kcm0u
ZHJpdmVyLT5nZXRfdmJsYW5rX2NvdW50ZXIoJmRldl9wcml2LT5kcm0sIHBpcGUpOwo+ID4gLQkJ
CSAgIF9fZW50cnktPnNjYW5saW5lID0gaW50ZWxfZ2V0X2NydGNfc2NhbmxpbmUoaW50ZWxfZ2V0
X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpKTsKPiA+ICsJCQkgICBfX2VudHJ5LT5mcmFt
ZSA9IGk5MTUtPmRybS5kcml2ZXItPmdldF92YmxhbmtfY291bnRlcigmaTkxNS0+ZHJtLCBwaXBl
KTsKPiA+ICsJCQkgICBfX2VudHJ5LT5zY2FubGluZSA9IGludGVsX2dldF9jcnRjX3NjYW5saW5l
KGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGk5MTUsIHBpcGUpKTsKPiA+ICAgCQkJICAgKSwKPiA+
ICAgCSAgICBUUF9wcmludGsoInBjaCB0cmFuc2NvZGVyICVjLCBmcmFtZT0ldSwgc2NhbmxpbmU9
JXUiLAo+ID4gQEAgLTE0NSw4ICsxNDUsOCBAQCBUUkFDRV9FVkVOVChpbnRlbF9wY2hfZmlmb191
bmRlcnJ1biwKPiA+ICAgKTsKPiA+ICAgVFJBQ0VfRVZFTlQoaW50ZWxfbWVtb3J5X2N4c3IsCj4g
PiAtCSAgICBUUF9QUk9UTyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wg
b2xkLCBib29sIG5ldyksCj4gPiAtCSAgICBUUF9BUkdTKGRldl9wcml2LCBvbGQsIG5ldyksCj4g
PiArCSAgICBUUF9QUk9UTyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgYm9vbCBvbGQs
IGJvb2wgbmV3KSwKPiA+ICsJICAgIFRQX0FSR1MoaTkxNSwgb2xkLCBuZXcpLAo+ID4gICAJICAg
IFRQX1NUUlVDVF9fZW50cnkoCj4gPiAgIAkJCSAgICAgX19hcnJheSh1MzIsIGZyYW1lLCAzKQo+
ID4gQEAgLTE1NywxMSArMTU3LDExIEBAIFRSQUNFX0VWRU5UKGludGVsX21lbW9yeV9jeHNyLAo+
ID4gICAJICAgIFRQX2Zhc3RfYXNzaWduKAo+ID4gICAJCQkgICBlbnVtIHBpcGUgcGlwZTsKPiA+
IC0JCQkgICBmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gPiArCQkJICAgZm9yX2Vh
Y2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gPiAgIAkJCQkgICBfX2VudHJ5LT5mcmFtZVtwaXBlXSA9
Cj4gPiAtCQkJCQkgICBkZXZfcHJpdi0+ZHJtLmRyaXZlci0+Z2V0X3ZibGFua19jb3VudGVyKCZk
ZXZfcHJpdi0+ZHJtLCBwaXBlKTsKPiA+ICsJCQkJCSAgIGk5MTUtPmRybS5kcml2ZXItPmdldF92
YmxhbmtfY291bnRlcigmaTkxNS0+ZHJtLCBwaXBlKTsKPiA+ICAgCQkJCSAgIF9fZW50cnktPnNj
YW5saW5lW3BpcGVdID0KPiA+IC0JCQkJCSAgIGludGVsX2dldF9jcnRjX3NjYW5saW5lKGludGVs
X2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKSk7Cj4gPiArCQkJCQkgICBpbnRlbF9n
ZXRfY3J0Y19zY2FubGluZShpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwaXBlKSk7Cj4g
PiAgIAkJCSAgIH0KPiA+ICAgCQkJICAgX19lbnRyeS0+b2xkID0gb2xkOwo+ID4gICAJCQkgICBf
X2VudHJ5LT5uZXcgPSBuZXc7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV92Z3B1LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZncHUuYwo+ID4gaW5kZXgg
OTRkMzk5MmI1OTlkLi45Njg3NGE0ODE5YTkgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3ZncHUuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92
Z3B1LmMKPiA+IEBAIC01MywxNCArNTMsMTQgQEAKPiA+ICAgLyoqCj4gPiAgICAqIGk5MTVfY2hl
Y2tfdmdwdSAtIGRldGVjdCB2aXJ0dWFsIEdQVQo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZp
Y2UgcHJpdmF0ZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBwcml2YXRlCj4gPiAgICAqCj4g
PiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGF0IHRoZSBpbml0aWFsaXphdGlvbiBzdGFn
ZSwgdG8gZGV0ZWN0IHdoZXRoZXIKPiA+ICAgICogcnVubmluZyBvbiBhIHZHUFUuCj4gPiAgICAq
Lwo+ID4gLXZvaWQgaTkxNV9jaGVja192Z3B1KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICt2b2lkIGk5MTVfY2hlY2tfdmdwdShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3By
aXYtPnVuY29yZTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVu
Y29yZTsKPiA+ICAgCXU2NCBtYWdpYzsKPiA+ICAgCXUxNiB2ZXJzaW9uX21ham9yOwo+ID4gQEAg
LTc2LDE1ICs3NiwxNSBAQCB2b2lkIGk5MTVfY2hlY2tfdmdwdShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJfQo+ID4gLQlkZXZfcHJpdi0+
dmdwdS5jYXBzID0gX19yYXdfdW5jb3JlX3JlYWQzMih1bmNvcmUsIHZndGlmX3JlZyh2Z3RfY2Fw
cykpOwo+ID4gKwlpOTE1LT52Z3B1LmNhcHMgPSBfX3Jhd191bmNvcmVfcmVhZDMyKHVuY29yZSwg
dmd0aWZfcmVnKHZndF9jYXBzKSk7Cj4gPiAtCWRldl9wcml2LT52Z3B1LmFjdGl2ZSA9IHRydWU7
Cj4gPiArCWk5MTUtPnZncHUuYWN0aXZlID0gdHJ1ZTsKPiA+ICAgCURSTV9JTkZPKCJWaXJ0dWFs
IEdQVSBmb3IgSW50ZWwgR1ZULWcgZGV0ZWN0ZWQuXG4iKTsKPiA+ICAgfQo+ID4gLWJvb2wgaW50
ZWxfdmdwdV9oYXNfZnVsbF9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiArYm9vbCBpbnRlbF92Z3B1X2hhc19mdWxsX3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXJldHVybiBkZXZfcHJpdi0+dmdwdS5jYXBzICYgVkdU
X0NBUFNfRlVMTF9QUEdUVDsKPiA+ICsJcmV0dXJuIGk5MTUtPnZncHUuY2FwcyAmIFZHVF9DQVBT
X0ZVTExfUFBHVFQ7Cj4gPiAgIH0KPiA+ICAgc3RydWN0IF9iYWxsb29uX2luZm9fIHsKPiA+IEBA
IC0xMTIsMjIgKzExMiwyMiBAQCBzdGF0aWMgdm9pZCB2Z3RfZGViYWxsb29uX3NwYWNlKHN0cnVj
dCBpOTE1X2dndHQgKmdndHQsCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF92Z3RfZGViYWxsb29u
IC0gZGViYWxsb29uIHJlc2VydmVkIGdyYXBoaWNzIGFkZHJlc3MgdHJ1bmtzCj4gPiAtICogQGRl
dl9wcml2OiBpOTE1IGRldmljZSBwcml2YXRlIGRhdGEKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZp
Y2UgcHJpdmF0ZSBkYXRhCj4gPiAgICAqCj4gPiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVk
IHRvIGRlYWxsb2NhdGUgdGhlIGJhbGxvb25lZC1vdXQgZ3JhcGhpYyBtZW1vcnksIHdoZW4KPiA+
ICAgICogZHJpdmVyIGlzIHVubG9hZGVkIG9yIHdoZW4gYmFsbG9vbmluZyBmYWlscy4KPiA+ICAg
ICovCj4gPiAtdm9pZCBpbnRlbF92Z3RfZGViYWxsb29uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiA+ICt2b2lkIGludGVsX3ZndF9kZWJhbGxvb24oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWludCBpOwo+ID4gLQlpZiAoIWludGVsX3Zn
cHVfYWN0aXZlKGRldl9wcml2KSkKPiA+ICsJaWYgKCFpbnRlbF92Z3B1X2FjdGl2ZShpOTE1KSkK
PiA+ICAgCQlyZXR1cm47Cj4gPiAgIAlEUk1fREVCVUcoIlZHVCBkZWJhbGxvb24uXG4iKTsKPiA+
ICAgCWZvciAoaSA9IDA7IGkgPCA0OyBpKyspCj4gPiAtCQl2Z3RfZGViYWxsb29uX3NwYWNlKCZk
ZXZfcHJpdi0+Z2d0dCwgJmJsX2luZm8uc3BhY2VbaV0pOwo+ID4gKwkJdmd0X2RlYmFsbG9vbl9z
cGFjZSgmaTkxNS0+Z2d0dCwgJmJsX2luZm8uc3BhY2VbaV0pOwo+ID4gICB9Cj4gPiAgIHN0YXRp
YyBpbnQgdmd0X2JhbGxvb25fc3BhY2Uoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCwKPiA+IEBAIC0x
NTMsNyArMTUzLDcgQEAgc3RhdGljIGludCB2Z3RfYmFsbG9vbl9zcGFjZShzdHJ1Y3QgaTkxNV9n
Z3R0ICpnZ3R0LAo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfdmd0X2JhbGxvb24gLSBiYWxsb29u
IG91dCByZXNlcnZlZCBncmFwaGljcyBhZGRyZXNzIHRydW5rcwo+ID4gLSAqIEBkZXZfcHJpdjog
aTkxNSBkZXZpY2UgcHJpdmF0ZSBkYXRhCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIHByaXZh
dGUgZGF0YQo+ID4gICAgKgo+ID4gICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhdCB0aGUg
aW5pdGlhbGl6YXRpb24gc3RhZ2UsIHRvIGJhbGxvb24gb3V0IHRoZQo+ID4gICAgKiBncmFwaGlj
IGFkZHJlc3Mgc3BhY2UgYWxsb2NhdGVkIHRvIG90aGVyIHZHUFVzLCBieSBtYXJraW5nIHRoZXNl
IHNwYWNlcyBhcwo+ID4gQEAgLTE5NSwxNiArMTk1LDE2IEBAIHN0YXRpYyBpbnQgdmd0X2JhbGxv
b25fc3BhY2Uoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCwKPiA+ICAgICogUmV0dXJuczoKPiA+ICAg
ICogemVybyBvbiBzdWNjZXNzLCBub24temVybyBpZiBjb25maWd1cmF0aW9uIGludmFsaWQgb3Ig
YmFsbG9vbmluZyBmYWlsZWQKPiA+ICAgICovCj4gPiAtaW50IGludGVsX3ZndF9iYWxsb29uKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQgaW50ZWxfdmd0X2JhbGxv
b24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGk5
MTVfZ2d0dCAqZ2d0dCA9ICZkZXZfcHJpdi0+Z2d0dDsKPiA+ICsJc3RydWN0IGk5MTVfZ2d0dCAq
Z2d0dCA9ICZpOTE1LT5nZ3R0Owo+ID4gICAJdW5zaWduZWQgbG9uZyBnZ3R0X2VuZCA9IGdndHQt
PnZtLnRvdGFsOwo+ID4gICAJdW5zaWduZWQgbG9uZyBtYXBwYWJsZV9iYXNlLCBtYXBwYWJsZV9z
aXplLCBtYXBwYWJsZV9lbmQ7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIHVubWFwcGFibGVfYmFzZSwg
dW5tYXBwYWJsZV9zaXplLCB1bm1hcHBhYmxlX2VuZDsKPiA+ICAgCWludCByZXQ7Cj4gPiAtCWlm
ICghaW50ZWxfdmdwdV9hY3RpdmUoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIWludGVsX3ZncHVfYWN0
aXZlKGk5MTUpKQo+ID4gICAJCXJldHVybiAwOwo+ID4gICAJbWFwcGFibGVfYmFzZSA9IEk5MTVf
UkVBRCh2Z3RpZl9yZWcoYXZhaWxfcnMubWFwcGFibGVfZ21hZHIuYmFzZSkpOwo+ID4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdmdwdS5oIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV92Z3B1LmgKPiA+IGluZGV4IGViZTFiN2JjZWQ5OC4uMGZhMGJmYjg4YmVkIDEw
MDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmgKPiA+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdmdwdS5oCj4gPiBAQCAtMjYsMjMgKzI2LDIzIEBA
Cj4gPiAgICNpbmNsdWRlICJpOTE1X3B2aW5mby5oIgo+ID4gLXZvaWQgaTkxNV9jaGVja192Z3B1
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBpOTE1X2NoZWNr
X3ZncHUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gLWJvb2wgaW50ZWxfdmdw
dV9oYXNfZnVsbF9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4g
K2Jvb2wgaW50ZWxfdmdwdV9oYXNfZnVsbF9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7Cj4gPiAgIHN0YXRpYyBpbmxpbmUgYm9vbAo+ID4gLWludGVsX3ZncHVfaGFzX2h3c3Bf
ZW11bGF0aW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnRlbF92
Z3B1X2hhc19od3NwX2VtdWxhdGlvbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+
ICAgewo+ID4gLQlyZXR1cm4gZGV2X3ByaXYtPnZncHUuY2FwcyAmIFZHVF9DQVBTX0hXU1BfRU1V
TEFUSU9OOwo+ID4gKwlyZXR1cm4gaTkxNS0+dmdwdS5jYXBzICYgVkdUX0NBUFNfSFdTUF9FTVVM
QVRJT047Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGlubGluZSBib29sCj4gPiAtaW50ZWxfdmdwdV9o
YXNfaHVnZV9ndHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludGVs
X3ZncHVfaGFzX2h1Z2VfZ3R0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7
Cj4gPiAtCXJldHVybiBkZXZfcHJpdi0+dmdwdS5jYXBzICYgVkdUX0NBUFNfSFVHRV9HVFQ7Cj4g
PiArCXJldHVybiBpOTE1LT52Z3B1LmNhcHMgJiBWR1RfQ0FQU19IVUdFX0dUVDsKPiA+ICAgfQo+
ID4gLWludCBpbnRlbF92Z3RfYmFsbG9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwo+ID4gLXZvaWQgaW50ZWxfdmd0X2RlYmFsbG9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwo+ID4gK2ludCBpbnRlbF92Z3RfYmFsbG9vbihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBpbnRlbF92Z3RfZGViYWxsb29uKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgI2VuZGlmIC8qIF9JOTE1X1ZHUFVfSF8gKi8KPiA+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV92bWEuYwo+ID4gaW5kZXggY2IzNDFlNGFjZjk5Li5lM2Y0ZDcwMDZh
MWIgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCj4gPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCj4gPiBAQCAtNTU1LDcgKzU1NSw3
IEBAIHN0YXRpYyB2b2lkIGFzc2VydF9iaW5kX2NvdW50KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmopCj4gPiAgIHN0YXRpYyBpbnQKPiA+ICAgaTkxNV92bWFfaW5zZXJ0KHN0
cnVjdCBpOTE1X3ZtYSAqdm1hLCB1NjQgc2l6ZSwgdTY0IGFsaWdubWVudCwgdTY0IGZsYWdzKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZtYS0+dm0t
Pmk5MTU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdm1hLT52bS0+aTkx
NTsKPiA+ICAgCXVuc2lnbmVkIGludCBjYWNoZV9sZXZlbDsKPiA+ICAgCXU2NCBzdGFydCwgZW5k
Owo+ID4gICAJaW50IHJldDsKPiA+IEBAIC01ODEsNyArNTgxLDcgQEAgaTkxNV92bWFfaW5zZXJ0
KHN0cnVjdCBpOTE1X3ZtYSAqdm1hLCB1NjQgc2l6ZSwgdTY0IGFsaWdubWVudCwgdTY0IGZsYWdz
KQo+ID4gICAJZW5kID0gdm1hLT52bS0+dG90YWw7Cj4gPiAgIAlpZiAoZmxhZ3MgJiBQSU5fTUFQ
UEFCTEUpCj4gPiAtCQllbmQgPSBtaW5fdCh1NjQsIGVuZCwgZGV2X3ByaXYtPmdndHQubWFwcGFi
bGVfZW5kKTsKPiA+ICsJCWVuZCA9IG1pbl90KHU2NCwgZW5kLCBpOTE1LT5nZ3R0Lm1hcHBhYmxl
X2VuZCk7Cj4gPiAgIAlpZiAoZmxhZ3MgJiBQSU5fWk9ORV80RykKPiA+ICAgCQllbmQgPSBtaW5f
dCh1NjQsIGVuZCwgKDFVTEwgPDwgMzIpIC0gSTkxNV9HVFRfUEFHRV9TSVpFKTsKPiA+ICAgCUdF
TV9CVUdfT04oIUlTX0FMSUdORUQoZW5kLCBJOTE1X0dUVF9QQUdFX1NJWkUpKTsKPiA+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pY2xfZHNpLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pY2xfZHNpLmMKPiA+IGluZGV4IDc0NDQ4ZTZiZjc0OS4uZDAxOTJlMDkzZjZmIDEwMDY0
NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaWNsX2RzaS5jCj4gPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pY2xfZHNpLmMKPiA+IEBAIC0zNSwzMiArMzUsMzIgQEAKPiA+ICAg
I2luY2x1ZGUgImludGVsX2RzaS5oIgo+ID4gICAjaW5jbHVkZSAiaW50ZWxfcGFuZWwuaCIKPiA+
IC1zdGF0aWMgaW5saW5lIGludCBoZWFkZXJfY3JlZGl0c19hdmFpbGFibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBpbmxpbmUgaW50IGhlYWRlcl9jcmVk
aXRzX2F2YWlsYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkg
ICBlbnVtIHRyYW5zY29kZXIgZHNpX3RyYW5zKQo+ID4gICB7Cj4gPiAgIAlyZXR1cm4gKEk5MTVf
UkVBRChEU0lfQ01EX1RYQ1RMKGRzaV90cmFucykpICYgRlJFRV9IRUFERVJfQ1JFRElUX01BU0sp
Cj4gPiAgIAkJPj4gRlJFRV9IRUFERVJfQ1JFRElUX1NISUZUOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IGlubGluZSBpbnQgcGF5bG9hZF9jcmVkaXRzX2F2YWlsYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGlubGluZSBpbnQgcGF5bG9hZF9jcmVkaXRzX2F2
YWlsYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICAgZW51
bSB0cmFuc2NvZGVyIGRzaV90cmFucykKPiA+ICAgewo+ID4gICAJcmV0dXJuIChJOTE1X1JFQUQo
RFNJX0NNRF9UWENUTChkc2lfdHJhbnMpKSAmIEZSRUVfUExPQURfQ1JFRElUX01BU0spCj4gPiAg
IAkJPj4gRlJFRV9QTE9BRF9DUkVESVRfU0hJRlQ7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCB3
YWl0X2Zvcl9oZWFkZXJfY3JlZGl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiArc3RhdGljIHZvaWQgd2FpdF9mb3JfaGVhZGVyX2NyZWRpdHMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgZW51bSB0cmFuc2NvZGVyIGRzaV90cmFucykK
PiA+ICAgewo+ID4gLQlpZiAod2FpdF9mb3JfdXMoaGVhZGVyX2NyZWRpdHNfYXZhaWxhYmxlKGRl
dl9wcml2LCBkc2lfdHJhbnMpID49Cj4gPiArCWlmICh3YWl0X2Zvcl91cyhoZWFkZXJfY3JlZGl0
c19hdmFpbGFibGUoaTkxNSwgZHNpX3RyYW5zKSA+PQo+ID4gICAJCQlNQVhfSEVBREVSX0NSRURJ
VCwgMTAwKSkKPiA+ICAgCQlEUk1fRVJST1IoIkRTSSBoZWFkZXIgY3JlZGl0cyBub3QgcmVsZWFz
ZWRcbiIpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgd2FpdF9mb3JfcGF5bG9hZF9jcmVkaXRz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCB3YWl0
X2Zvcl9wYXlsb2FkX2NyZWRpdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAg
IAkJCQkgICAgIGVudW0gdHJhbnNjb2RlciBkc2lfdHJhbnMpCj4gPiAgIHsKPiA+IC0JaWYgKHdh
aXRfZm9yX3VzKHBheWxvYWRfY3JlZGl0c19hdmFpbGFibGUoZGV2X3ByaXYsIGRzaV90cmFucykg
Pj0KPiA+ICsJaWYgKHdhaXRfZm9yX3VzKHBheWxvYWRfY3JlZGl0c19hdmFpbGFibGUoaTkxNSwg
ZHNpX3RyYW5zKSA+PQo+ID4gICAJCQlNQVhfUExPQURfQ1JFRElULCAxMDApKQo+ID4gICAJCURS
TV9FUlJPUigiRFNJIHBheWxvYWQgY3JlZGl0cyBub3QgcmVsZWFzZWRcbiIpOwo+ID4gICB9Cj4g
PiBAQCAtNzUsNyArNzUsNyBAQCBzdGF0aWMgZW51bSB0cmFuc2NvZGVyIGRzaV9wb3J0X3RvX3Ry
YW5zY29kZXIoZW51bSBwb3J0IHBvcnQpCj4gPiAgIHN0YXRpYyB2b2lkIHdhaXRfZm9yX2NtZHNf
ZGlzcGF0Y2hlZF90b19wYW5lbChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2Rz
aSA9IGVuY190b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ID4gICAJc3RydWN0IG1pcGlf
ZHNpX2RldmljZSAqZHNpOwo+ID4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gPiBAQCAtODUsOCArODUs
OCBAQCBzdGF0aWMgdm9pZCB3YWl0X2Zvcl9jbWRzX2Rpc3BhdGNoZWRfdG9fcGFuZWwoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIAkvKiB3YWl0IGZvciBoZWFkZXIvcGF5bG9h
ZCBjcmVkaXRzIHRvIGJlIHJlbGVhc2VkICovCj4gPiAgIAlmb3JfZWFjaF9kc2lfcG9ydChwb3J0
LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gPiAgIAkJZHNpX3RyYW5zID0gZHNpX3BvcnRfdG9fdHJh
bnNjb2Rlcihwb3J0KTsKPiA+IC0JCXdhaXRfZm9yX2hlYWRlcl9jcmVkaXRzKGRldl9wcml2LCBk
c2lfdHJhbnMpOwo+ID4gLQkJd2FpdF9mb3JfcGF5bG9hZF9jcmVkaXRzKGRldl9wcml2LCBkc2lf
dHJhbnMpOwo+ID4gKwkJd2FpdF9mb3JfaGVhZGVyX2NyZWRpdHMoaTkxNSwgZHNpX3RyYW5zKTsK
PiA+ICsJCXdhaXRfZm9yX3BheWxvYWRfY3JlZGl0cyhpOTE1LCBkc2lfdHJhbnMpOwo+ID4gICAJ
fQo+ID4gICAJLyogc2VuZCBub3AgRENTIGNvbW1hbmQgKi8KPiA+IEBAIC0xMDIsNyArMTAyLDcg
QEAgc3RhdGljIHZvaWQgd2FpdF9mb3JfY21kc19kaXNwYXRjaGVkX3RvX3BhbmVsKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICAJLyogd2FpdCBmb3IgaGVhZGVyIGNyZWRpdHMg
dG8gYmUgcmVsZWFzZWQgKi8KPiA+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2Rz
aS0+cG9ydHMpIHsKPiA+ICAgCQlkc2lfdHJhbnMgPSBkc2lfcG9ydF90b190cmFuc2NvZGVyKHBv
cnQpOwo+ID4gLQkJd2FpdF9mb3JfaGVhZGVyX2NyZWRpdHMoZGV2X3ByaXYsIGRzaV90cmFucyk7
Cj4gPiArCQl3YWl0X2Zvcl9oZWFkZXJfY3JlZGl0cyhpOTE1LCBkc2lfdHJhbnMpOwo+ID4gICAJ
fQo+ID4gICAJLyogd2FpdCBmb3IgTFAgVFggaW4gcHJvZ3Jlc3MgYml0IHRvIGJlIGNsZWFyZWQg
Ki8KPiA+IEBAIC0xMTgsNyArMTE4LDcgQEAgc3RhdGljIGJvb2wgYWRkX3BheWxkX3RvX3F1ZXVl
KHN0cnVjdCBpbnRlbF9kc2lfaG9zdCAqaG9zdCwgY29uc3QgdTggKmRhdGEsCj4gPiAgIAkJCSAg
ICAgICB1MzIgbGVuKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kg
PSBob3N0LT5pbnRlbF9kc2k7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoaW50ZWxfZHNpLT5iYXNlLmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGludGVsX2RzaS0+YmFzZS5iYXNlLmRldik7Cj4g
PiAgIAllbnVtIHRyYW5zY29kZXIgZHNpX3RyYW5zID0gZHNpX3BvcnRfdG9fdHJhbnNjb2Rlciho
b3N0LT5wb3J0KTsKPiA+ICAgCWludCBmcmVlX2NyZWRpdHM7Cj4gPiAgIAlpbnQgaSwgajsKPiA+
IEBAIC0xMjYsNyArMTI2LDcgQEAgc3RhdGljIGJvb2wgYWRkX3BheWxkX3RvX3F1ZXVlKHN0cnVj
dCBpbnRlbF9kc2lfaG9zdCAqaG9zdCwgY29uc3QgdTggKmRhdGEsCj4gPiAgIAlmb3IgKGkgPSAw
OyBpIDwgbGVuOyBpICs9IDQpIHsKPiA+ICAgCQl1MzIgdG1wID0gMDsKPiA+IC0JCWZyZWVfY3Jl
ZGl0cyA9IHBheWxvYWRfY3JlZGl0c19hdmFpbGFibGUoZGV2X3ByaXYsIGRzaV90cmFucyk7Cj4g
PiArCQlmcmVlX2NyZWRpdHMgPSBwYXlsb2FkX2NyZWRpdHNfYXZhaWxhYmxlKGk5MTUsIGRzaV90
cmFucyk7Cj4gPiAgIAkJaWYgKGZyZWVfY3JlZGl0cyA8IDEpIHsKPiA+ICAgCQkJRFJNX0VSUk9S
KCJQYXlsb2FkIGNyZWRpdCBub3QgYXZhaWxhYmxlXG4iKTsKPiA+ICAgCQkJcmV0dXJuIGZhbHNl
Owo+ID4gQEAgLTE0NSwxMyArMTQ1LDEzIEBAIHN0YXRpYyBpbnQgZHNpX3NlbmRfcGt0X2hkcihz
dHJ1Y3QgaW50ZWxfZHNpX2hvc3QgKmhvc3QsCj4gPiAgIAkJCSAgICBzdHJ1Y3QgbWlwaV9kc2lf
cGFja2V0IHBrdCwgYm9vbCBlbmFibGVfbHBkdCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVs
X2RzaSAqaW50ZWxfZHNpID0gaG9zdC0+aW50ZWxfZHNpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2RzaS0+YmFzZS5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShpbnRlbF9kc2ktPmJh
c2UuYmFzZS5kZXYpOwo+ID4gICAJZW51bSB0cmFuc2NvZGVyIGRzaV90cmFucyA9IGRzaV9wb3J0
X3RvX3RyYW5zY29kZXIoaG9zdC0+cG9ydCk7Cj4gPiAgIAl1MzIgdG1wOwo+ID4gICAJaW50IGZy
ZWVfY3JlZGl0czsKPiA+ICAgCS8qIGNoZWNrIGlmIGhlYWRlciBjcmVkaXQgYXZhaWxhYmxlICov
Cj4gPiAtCWZyZWVfY3JlZGl0cyA9IGhlYWRlcl9jcmVkaXRzX2F2YWlsYWJsZShkZXZfcHJpdiwg
ZHNpX3RyYW5zKTsKPiA+ICsJZnJlZV9jcmVkaXRzID0gaGVhZGVyX2NyZWRpdHNfYXZhaWxhYmxl
KGk5MTUsIGRzaV90cmFucyk7Cj4gPiAgIAlpZiAoZnJlZV9jcmVkaXRzIDwgMSkgewo+ID4gICAJ
CURSTV9FUlJPUigic2VuZCBwa3QgaGVhZGVyIGZhaWxlZCwgbm90IGVub3VnaCBoZHIgY3JlZGl0
c1xuIik7Cj4gPiAgIAkJcmV0dXJuIC0xOwo+ID4gQEAgLTIwMCw3ICsyMDAsNyBAQCBzdGF0aWMg
aW50IGRzaV9zZW5kX3BrdF9wYXlsZChzdHJ1Y3QgaW50ZWxfZHNpX2hvc3QgKmhvc3QsCj4gPiAg
IHN0YXRpYyB2b2lkIGRzaV9wcm9ncmFtX3N3aW5nX2FuZF9kZWVtcGhhc2lzKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJ
c3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+
YmFzZSk7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+ICAgCXUzMiB0bXA7Cj4gPiBAQCAtMjY2
LDcgKzI2Niw3IEBAIHN0YXRpYyB2b2lkIGRzaV9wcm9ncmFtX3N3aW5nX2FuZF9kZWVtcGhhc2lz
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICBzdGF0aWMgdm9pZCBjb25maWd1
cmVfZHVhbF9saW5rX21vZGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJ
CQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2Rz
aSA9IGVuY190b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ID4gICAJdTMyIGRzc19jdGwx
Owo+ID4gQEAgLTMwNCw3ICszMDQsNyBAQCBzdGF0aWMgdm9pZCBjb25maWd1cmVfZHVhbF9saW5r
X21vZGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIHN0YXRpYyB2b2lkIGdl
bjExX2RzaV9wcm9ncmFtX2VzY19jbGtfZGl2KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAq
aW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAllbnVt
IHBvcnQgcG9ydDsKPiA+ICAgCXUzMiBicHAgPSBtaXBpX2RzaV9waXhlbF9mb3JtYXRfdG9fYnBw
KGludGVsX2RzaS0+cGl4ZWxfZm9ybWF0KTsKPiA+IEBAIC0zMjksNyArMzI5LDcgQEAgc3RhdGlj
IHZvaWQgZ2VuMTFfZHNpX3Byb2dyYW1fZXNjX2Nsa19kaXYoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIpCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZXRfZHNpX2lvX3Bv
d2VyX2RvbWFpbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRp
YyB2b2lkIGdldF9kc2lfaW9fcG93ZXJfZG9tYWlucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJCSAgICAgc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpKQo+ID4gICB7
Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+IEBAIC0zMzcsNyArMzM3LDcgQEAgc3RhdGljIHZv
aWQgZ2V0X2RzaV9pb19wb3dlcl9kb21haW5zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsK
PiA+ICAgCQlXQVJOX09OKGludGVsX2RzaS0+aW9fd2FrZXJlZltwb3J0XSk7Cj4gPiAgIAkJaW50
ZWxfZHNpLT5pb193YWtlcmVmW3BvcnRdID0KPiA+IC0JCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dl
dChkZXZfcHJpdiwKPiA+ICsJCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LAo+ID4gICAJ
CQkJCQlwb3J0ID09IFBPUlRfQSA/Cj4gPiAgIAkJCQkJCVBPV0VSX0RPTUFJTl9QT1JUX0RESV9B
X0lPIDoKPiA+ICAgCQkJCQkJUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfSU8pOwo+ID4gQEAgLTM0
Niw3ICszNDYsNyBAQCBzdGF0aWMgdm9pZCBnZXRfZHNpX2lvX3Bvd2VyX2RvbWFpbnMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICBzdGF0aWMgdm9pZCBnZW4xMV9kc2lf
ZW5hYmxlX2lvX3Bvd2VyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0g
ZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsK
PiA+ICAgCXUzMiB0bXA7Cj4gPiBAQCAtMzU3LDIzICszNTcsMjMgQEAgc3RhdGljIHZvaWQgZ2Vu
MTFfZHNpX2VuYWJsZV9pb19wb3dlcihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+
ICAgCQlJOTE1X1dSSVRFKElDTF9EU0lfSU9fTU9ERUNUTChwb3J0KSwgdG1wKTsKPiA+ICAgCX0K
PiA+IC0JZ2V0X2RzaV9pb19wb3dlcl9kb21haW5zKGRldl9wcml2LCBpbnRlbF9kc2kpOwo+ID4g
KwlnZXRfZHNpX2lvX3Bvd2VyX2RvbWFpbnMoaTkxNSwgaW50ZWxfZHNpKTsKPiA+ICAgfQo+ID4g
ICBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfcG93ZXJfdXBfbGFuZXMoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsK
PiA+ICAgCWVudW0gcG9ydCBwb3J0Owo+ID4gICAJZm9yX2VhY2hfZHNpX3BvcnQocG9ydCwgaW50
ZWxfZHNpLT5wb3J0cykKPiA+IC0JCWludGVsX2NvbWJvX3BoeV9wb3dlcl91cF9sYW5lcyhkZXZf
cHJpdiwgcG9ydCwgdHJ1ZSwKPiA+ICsJCWludGVsX2NvbWJvX3BoeV9wb3dlcl91cF9sYW5lcyhp
OTE1LCBwb3J0LCB0cnVlLAo+ID4gICAJCQkJCSAgICAgICBpbnRlbF9kc2ktPmxhbmVfY291bnQs
IGZhbHNlKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfY29uZmlnX3BoeV9s
YW5lc19zZXF1ZW5jZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVu
Y190b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ID4gICAJZW51bSBwb3J0IHBvcnQ7Cj4g
PiAgIAl1MzIgdG1wOwo+ID4gQEAgLTQwOSw3ICs0MDksNyBAQCBzdGF0aWMgdm9pZCBnZW4xMV9k
c2lfY29uZmlnX3BoeV9sYW5lc19zZXF1ZW5jZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
cikKPiA+ICAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX3ZvbHRhZ2Vfc3dpbmdfcHJvZ3JhbV9zZXEo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNp
KCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCXUzMiB0bXA7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsK
PiA+IEBAIC00NjEsNyArNDYxLDcgQEAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX3ZvbHRhZ2Vfc3dp
bmdfcHJvZ3JhbV9zZXEoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHN0YXRp
YyB2b2lkIGdlbjExX2RzaV9lbmFibGVfZGRpX2J1ZmZlcihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ID4g
ICAJdTMyIHRtcDsKPiA+ICAgCWVudW0gcG9ydCBwb3J0Owo+ID4gQEAgLTQ4MCw3ICs0ODAsNyBA
QCBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfZW5hYmxlX2RkaV9idWZmZXIoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIpCj4gPiAgIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9zZXR1cF9kcGh5X3Rp
bWluZ3Moc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50
ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCXUzMiB0bXA7Cj4gPiAgIAllbnVtIHBvcnQg
cG9ydDsKPiA+IEBAIC01MzUsNDggKzUzNSw0OCBAQCBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfc2V0
dXBfZHBoeV90aW1pbmdzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICBzdGF0
aWMgdm9pZCBnZW4xMV9kc2lfZ2F0ZV9jbG9ja3Moc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNp
ICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCXUz
MiB0bXA7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYt
PmRwbGxfbG9jayk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmRwbGxfbG9jayk7Cj4gPiAgIAl0
bXAgPSBJOTE1X1JFQUQoRFBDTEtBX0NGR0NSMF9JQ0wpOwo+ID4gICAJZm9yX2VhY2hfZHNpX3Bv
cnQocG9ydCwgaW50ZWxfZHNpLT5wb3J0cykgewo+ID4gICAJCXRtcCB8PSBEUENMS0FfQ0ZHQ1Iw
X0RESV9DTEtfT0ZGKHBvcnQpOwo+ID4gICAJfQo+ID4gICAJSTkxNV9XUklURShEUENMS0FfQ0ZH
Q1IwX0lDTCwgdG1wKTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHBsbF9sb2NrKTsK
PiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcGxsX2xvY2spOwo+ID4gICB9Cj4gPiAgIHN0YXRp
YyB2b2lkIGdlbjExX2RzaV91bmdhdGVfY2xvY2tzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2Rz
aSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAl1
MzIgdG1wOwo+ID4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2
LT5kcGxsX2xvY2spOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5kcGxsX2xvY2spOwo+ID4gICAJ
dG1wID0gSTkxNV9SRUFEKERQQ0xLQV9DRkdDUjBfSUNMKTsKPiA+ICAgCWZvcl9lYWNoX2RzaV9w
b3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiA+ICAgCQl0bXAgJj0gfkRQQ0xLQV9DRkdD
UjBfRERJX0NMS19PRkYocG9ydCk7Cj4gPiAgIAl9Cj4gPiAgIAlJOTE1X1dSSVRFKERQQ0xLQV9D
RkdDUjBfSUNMLCB0bXApOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5kcGxsX2xvY2sp
Owo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmRwbGxfbG9jayk7Cj4gPiAgIH0KPiA+ICAgc3Rh
dGljIHZvaWQgZ2VuMTFfZHNpX21hcF9wbGwoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAq
aW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCA9IGNydGNfc3RhdGUtPnNoYXJlZF9kcGxsOwo+ID4g
ICAJZW51bSBwb3J0IHBvcnQ7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQltdXRleF9sb2NrKCZkZXZf
cHJpdi0+ZHBsbF9sb2NrKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHBsbF9sb2NrKTsKPiA+
ICAgCXZhbCA9IEk5MTVfUkVBRChEUENMS0FfQ0ZHQ1IwX0lDTCk7Cj4gPiAgIAlmb3JfZWFjaF9k
c2lfcG9ydChwb3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gPiBAQCAtNTkyLDE0ICs1OTIsMTQg
QEAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX21hcF9wbGwoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gPiAgIAlQT1NUSU5HX1JFQUQoRFBDTEtBX0NGR0NSMF9JQ0wpOwo+ID4gLQltdXRl
eF91bmxvY2soJmRldl9wcml2LT5kcGxsX2xvY2spOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUt
PmRwbGxfbG9jayk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQKPiA+ICAgZ2VuMTFfZHNpX2Nv
bmZpZ3VyZV90cmFuc2NvZGVyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJ
CQkgICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxf
ZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0
Yyk7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7Cj4gPiBAQCAtNzM2
LDcgKzczNiw3IEBAIHN0YXRpYyB2b2lkCj4gPiAgIGdlbjExX2RzaV9zZXRfdHJhbnNjb2Rlcl90
aW1pbmdzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJIGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRl
bF9kc2koJmVuY29kZXItPmJhc2UpOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKmFkanVzdGVkX21vZGUgPQo+ID4gICAJCQkJCSZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3Rl
ZF9tb2RlOwo+ID4gQEAgLTg0OSw3ICs4NDksNyBAQCBnZW4xMV9kc2lfc2V0X3RyYW5zY29kZXJf
dGltaW5ncyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIHZvaWQg
Z2VuMTFfZHNpX2VuYWJsZV90cmFuc2NvZGVyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAq
aW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAllbnVt
IHBvcnQgcG9ydDsKPiA+ICAgCWVudW0gdHJhbnNjb2RlciBkc2lfdHJhbnM7Cj4gPiBAQCAtODYy
LDcgKzg2Miw3IEBAIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9lbmFibGVfdHJhbnNjb2RlcihzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgCQlJOTE1X1dSSVRFKFBJUEVDT05GKGRz
aV90cmFucyksIHRtcCk7Cj4gPiAgIAkJLyogd2FpdCBmb3IgdHJhbnNjb2RlciB0byBiZSBlbmFi
bGVkICovCj4gPiAtCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNv
cmUsCj4gPiArCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiA+
ICAgCQkJCQkgICAgUElQRUNPTkYoZHNpX3RyYW5zKSwKPiA+ICAgCQkJCQkgICAgSTk2NV9QSVBF
Q09ORl9BQ1RJVkUsCj4gPiAgIAkJCQkJICAgIEk5NjVfUElQRUNPTkZfQUNUSVZFLCAxMCkpCj4g
PiBAQCAtODcyLDcgKzg3Miw3IEBAIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9lbmFibGVfdHJhbnNj
b2RlcihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgc3RhdGljIHZvaWQgZ2Vu
MTFfZHNpX3NldHVwX3RpbWVvdXRzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxf
ZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAllbnVtIHBvcnQg
cG9ydDsKPiA+ICAgCWVudW0gdHJhbnNjb2RlciBkc2lfdHJhbnM7Cj4gPiBAQCAtOTUwLDcgKzk1
MCw3IEBAIGdlbjExX2RzaV9lbmFibGVfcG9ydF9hbmRfcGh5KHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ID4gICBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfcG93ZXJ1cF9wYW5lbChzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2koJmVu
Y29kZXItPmJhc2UpOwo+ID4gICAJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNpOwo+ID4gICAJ
ZW51bSBwb3J0IHBvcnQ7Cj4gPiBAQCAtMTAyNiw3ICsxMDI2LDcgQEAgc3RhdGljIHZvaWQgZ2Vu
MTFfZHNpX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIHN0
YXRpYyB2b2lkIGdlbjExX2RzaV9kaXNhYmxlX3RyYW5zY29kZXIoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsK
PiA+ICAgCWVudW0gcG9ydCBwb3J0Owo+ID4gICAJZW51bSB0cmFuc2NvZGVyIGRzaV90cmFuczsK
PiA+IEBAIC0xMDQxLDcgKzEwNDEsNyBAQCBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfZGlzYWJsZV90
cmFuc2NvZGVyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICAJCUk5MTVfV1JJ
VEUoUElQRUNPTkYoZHNpX3RyYW5zKSwgdG1wKTsKPiA+ICAgCQkvKiB3YWl0IGZvciB0cmFuc2Nv
ZGVyIHRvIGJlIGRpc2FibGVkICovCj4gPiAtCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIo
JmRldl9wcml2LT51bmNvcmUsCj4gPiArCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5
MTUtPnVuY29yZSwKPiA+ICAgCQkJCQkgICAgUElQRUNPTkYoZHNpX3RyYW5zKSwKPiA+ICAgCQkJ
CQkgICAgSTk2NV9QSVBFQ09ORl9BQ1RJVkUsIDAsIDUwKSkKPiA+ICAgCQkJRFJNX0VSUk9SKCJE
U0kgdHJhbmNvZGVyIG5vdCBkaXNhYmxlZFxuIik7Cj4gPiBAQCAtMTA2Miw3ICsxMDYyLDcgQEAg
c3RhdGljIHZvaWQgZ2VuMTFfZHNpX3Bvd2VyZG93bl9wYW5lbChzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlcikKPiA+ICAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX2RlY29uZmlndXJlX3RyYW5j
b2RlcihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRl
bF9kc2koJmVuY29kZXItPmJhc2UpOwo+ID4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gPiAgIAllbnVt
IHRyYW5zY29kZXIgZHNpX3RyYW5zOwo+ID4gQEAgLTExMDMsNyArMTEwMyw3IEBAIHN0YXRpYyB2
b2lkIGdlbjExX2RzaV9kZWNvbmZpZ3VyZV90cmFuY29kZXIoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIpCj4gPiAgIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9kaXNhYmxlX3BvcnQoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNv
ZGVyLT5iYXNlKTsKPiA+ICAgCXUzMiB0bXA7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+IEBA
IC0xMTI1LDcgKzExMjUsNyBAQCBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfZGlzYWJsZV9wb3J0KHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICBzdGF0aWMgdm9pZCBnZW4xMV9kc2lf
ZGlzYWJsZV9pb19wb3dlcihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9
IGVuY190b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ID4gICAJZW51bSBwb3J0IHBvcnQ7
Cj4gPiAgIAl1MzIgdG1wOwo+ID4gQEAgLTExMzQsNyArMTEzNCw3IEBAIHN0YXRpYyB2b2lkIGdl
bjExX2RzaV9kaXNhYmxlX2lvX3Bvd2VyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+
ID4gICAJCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJCXdha2VyZWYgPSBmZXRjaF9h
bmRfemVybygmaW50ZWxfZHNpLT5pb193YWtlcmVmW3BvcnRdKTsKPiA+IC0JCWludGVsX2Rpc3Bs
YXlfcG93ZXJfcHV0KGRldl9wcml2LAo+ID4gKwkJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkx
NSwKPiA+ICAgCQkJCQlwb3J0ID09IFBPUlRfQSA/Cj4gPiAgIAkJCQkJUE9XRVJfRE9NQUlOX1BP
UlRfRERJX0FfSU8gOgo+ID4gICAJCQkJCVBPV0VSX0RPTUFJTl9QT1JUX0RESV9CX0lPLAo+ID4g
QEAgLTEyMDUsMTMgKzEyMDUsMTMgQEAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX2dldF90aW1pbmdz
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICBzdGF0aWMgdm9pZCBnZW4xMV9k
c2lfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCSBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
cGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9k
c2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCS8qIEZJWE1FOiBh
ZGFwdCBpY2xfZGRpX2Nsb2NrX2dldCgpIGZvciBEU0kgYW5kIHVzZSB0aGF0PyAqLwo+ID4gICAJ
cGlwZV9jb25maWctPnBvcnRfY2xvY2sgPQo+ID4gLQkJY25sX2NhbGNfd3JwbGxfbGluayhkZXZf
cHJpdiwgJnBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlKTsKPiA+ICsJCWNubF9jYWxjX3dycGxs
X2xpbmsoaTkxNSwgJnBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlKTsKPiA+ICAgCXBpcGVfY29u
ZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9IGludGVsX2RzaS0+cGNsazsKPiA+
ICAgCWlmIChpbnRlbF9kc2ktPmR1YWxfbGluaykKPiA+IEBAIC0xMjYzLDcgKzEyNjMsNyBAQCBz
dGF0aWMgdm9pZCBnZW4xMV9kc2lfZ2V0X3Bvd2VyX2RvbWFpbnMoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gPiAgIHN0YXRpYyBib29sIGdlbjExX2RzaV9nZXRfaHdfc3RhdGUoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkgICBlbnVtIHBpcGUgKnBpcGUp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICpp
bnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWVudW0g
dHJhbnNjb2RlciBkc2lfdHJhbnM7Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+
IEBAIC0xMjcxLDcgKzEyNzEsNyBAQCBzdGF0aWMgYm9vbCBnZW4xMV9kc2lfZ2V0X2h3X3N0YXRl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJYm9vbCByZXQgPSBmYWxzZTsK
PiA+ICAgCXUzMiB0bXA7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9p
Zl9lbmFibGVkKGRldl9wcml2LAo+ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9n
ZXRfaWZfZW5hYmxlZChpOTE1LAo+ID4gICAJCQkJCQkgICAgIGVuY29kZXItPnBvd2VyX2RvbWFp
bik7Cj4gPiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTEy
OTgsNyArMTI5OCw3IEBAIHN0YXRpYyBib29sIGdlbjExX2RzaV9nZXRfaHdfc3RhdGUoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJcmV0ID0gdG1wICYgUElQRUNPTkZfRU5B
QkxFOwo+ID4gICAJfQo+ID4gICBvdXQ6Cj4gPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRl
dl9wcml2LCBlbmNvZGVyLT5wb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9kaXNw
bGF5X3Bvd2VyX3B1dChpOTE1LCBlbmNvZGVyLT5wb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ID4g
ICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTEzOTEsOCArMTM5MSw4IEBAIHN0YXRpYyBj
b25zdCBzdHJ1Y3QgbWlwaV9kc2lfaG9zdF9vcHMgZ2VuMTFfZHNpX2hvc3Rfb3BzID0gewo+ID4g
ICBzdGF0aWMgdm9pZCBpY2xfZHBoeV9wYXJhbV9pbml0KHN0cnVjdCBpbnRlbF9kc2kgKmludGVs
X2RzaSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVsX2RzaS0+
YmFzZS5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwo+ID4gLQlzdHJ1Y3QgbWlwaV9jb25maWcgKm1pcGlfY29uZmlnID0gZGV2
X3ByaXYtPnZidC5kc2kuY29uZmlnOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IG1pcGlfY29uZmlnICptaXBpX2NvbmZpZyA9
IGk5MTUtPnZidC5kc2kuY29uZmlnOwo+ID4gICAJdTMyIHRscHhfbnM7Cj4gPiAgIAl1MzIgcHJl
cGFyZV9jbnQsIGV4aXRfemVyb19jbnQsIGNsa196ZXJvX2NudCwgdHJhaWxfY250Owo+ID4gICAJ
dTMyIHRoc19wcmVwYXJlX25zLCB0Y2xrX3RyYWlsX25zOwo+ID4gQEAgLTE0ODcsOSArMTQ4Nyw5
IEBAIHN0YXRpYyB2b2lkIGljbF9kcGh5X3BhcmFtX2luaXQoc3RydWN0IGludGVsX2RzaSAqaW50
ZWxfZHNpKQo+ID4gICAJaW50ZWxfZHNpX2xvZ19wYXJhbXMoaW50ZWxfZHNpKTsKPiA+ICAgfQo+
ID4gLXZvaWQgaWNsX2RzaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICt2b2lkIGljbF9kc2lfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gPiAr
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ID4gICAJc3RydWN0IGludGVs
X2RzaSAqaW50ZWxfZHNpOwo+ID4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICppbnRlbF9jb25uZWN0b3I7Cj4gPiBAQCAtMTQ5
Nyw3ICsxNDk3LDcgQEAgdm9pZCBpY2xfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGU7Cj4g
PiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+IC0JaWYgKCFpbnRlbF9iaW9zX2lzX2RzaV9wcmVzZW50
KGRldl9wcml2LCAmcG9ydCkpCj4gPiArCWlmICghaW50ZWxfYmlvc19pc19kc2lfcHJlc2VudChp
OTE1LCAmcG9ydCkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJaW50ZWxfZHNpID0ga3phbGxvYyhz
aXplb2YoKmludGVsX2RzaSksIEdGUF9LRVJORUwpOwo+ID4gQEAgLTE1NTYsMTMgKzE1NTYsMTMg
QEAgdm9pZCBpY2xfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gICAJaW50ZWxfcGFuZWxfaW5pdCgmaW50ZWxfY29ubmVjdG9yLT5wYW5lbCwgZml4ZWRfbW9k
ZSwgTlVMTCk7Cj4gPiAgIAlpbnRlbF9wYW5lbF9zZXR1cF9iYWNrbGlnaHQoY29ubmVjdG9yLCBJ
TlZBTElEX1BJUEUpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPnZidC5kc2kuY29uZmlnLT5kdWFsX2xp
bmspCj4gPiArCWlmIChpOTE1LT52YnQuZHNpLmNvbmZpZy0+ZHVhbF9saW5rKQo+ID4gICAJCWlu
dGVsX2RzaS0+cG9ydHMgPSBCSVQoUE9SVF9BKSB8IEJJVChQT1JUX0IpOwo+ID4gICAJZWxzZQo+
ID4gICAJCWludGVsX2RzaS0+cG9ydHMgPSBCSVQocG9ydCk7Cj4gPiAtCWludGVsX2RzaS0+ZGNz
X2JhY2tsaWdodF9wb3J0cyA9IGRldl9wcml2LT52YnQuZHNpLmJsX3BvcnRzOwo+ID4gLQlpbnRl
bF9kc2ktPmRjc19jYWJjX3BvcnRzID0gZGV2X3ByaXYtPnZidC5kc2kuY2FiY19wb3J0czsKPiA+
ICsJaW50ZWxfZHNpLT5kY3NfYmFja2xpZ2h0X3BvcnRzID0gaTkxNS0+dmJ0LmRzaS5ibF9wb3J0
czsKPiA+ICsJaW50ZWxfZHNpLT5kY3NfY2FiY19wb3J0cyA9IGk5MTUtPnZidC5kc2kuY2FiY19w
b3J0czsKPiA+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsK
PiA+ICAgCQlzdHJ1Y3QgaW50ZWxfZHNpX2hvc3QgKmhvc3Q7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXRvbWljLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9hdG9taWMuYwo+ID4gaW5kZXggNmI5ODVlODk1YTk3Li40NTc4MmU2ZmYwZjQgMTAwNjQ0
Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9hdG9taWMuYwo+ID4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXRvbWljLmMKPiA+IEBAIC01NCwxMyArNTQsMTMg
QEAgaW50IGludGVsX2RpZ2l0YWxfY29ubmVjdG9yX2F0b21pY19nZXRfcHJvcGVydHkoc3RydWN0
IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgCQkJCQkJdTY0ICp2YWwpCj4gPiAgIHsK
PiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjb25uZWN0b3ItPmRldjsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9kaWdpdGFsX2Nvbm5lY3Rvcl9zdGF0ZSAqaW50ZWxfY29ubl9zdGF0ZSA9Cj4gPiAgIAkJ
dG9faW50ZWxfZGlnaXRhbF9jb25uZWN0b3Jfc3RhdGUoc3RhdGUpOwo+ID4gLQlpZiAocHJvcGVy
dHkgPT0gZGV2X3ByaXYtPmZvcmNlX2F1ZGlvX3Byb3BlcnR5KQo+ID4gKwlpZiAocHJvcGVydHkg
PT0gaTkxNS0+Zm9yY2VfYXVkaW9fcHJvcGVydHkpCj4gPiAgIAkJKnZhbCA9IGludGVsX2Nvbm5f
c3RhdGUtPmZvcmNlX2F1ZGlvOwo+ID4gLQllbHNlIGlmIChwcm9wZXJ0eSA9PSBkZXZfcHJpdi0+
YnJvYWRjYXN0X3JnYl9wcm9wZXJ0eSkKPiA+ICsJZWxzZSBpZiAocHJvcGVydHkgPT0gaTkxNS0+
YnJvYWRjYXN0X3JnYl9wcm9wZXJ0eSkKPiA+ICAgCQkqdmFsID0gaW50ZWxfY29ubl9zdGF0ZS0+
YnJvYWRjYXN0X3JnYjsKPiA+ICAgCWVsc2Ugewo+ID4gICAJCURSTV9ERUJVR19BVE9NSUMoIlVu
a25vd24gcHJvcGVydHkgW1BST1A6JWQ6JXNdXG4iLAo+ID4gQEAgLTg2LDE2ICs4NiwxNiBAQCBp
bnQgaW50ZWxfZGlnaXRhbF9jb25uZWN0b3JfYXRvbWljX3NldF9wcm9wZXJ0eShzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ID4gICAJCQkJCQl1NjQgdmFsKQo+ID4gICB7Cj4gPiAg
IAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY29ubmVjdG9yLT5kZXY7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9jb25uZWN0b3Jfc3RhdGUgKmludGVsX2Nvbm5fc3RhdGUgPQo+ID4gICAJCXRvX2lu
dGVsX2RpZ2l0YWxfY29ubmVjdG9yX3N0YXRlKHN0YXRlKTsKPiA+IC0JaWYgKHByb3BlcnR5ID09
IGRldl9wcml2LT5mb3JjZV9hdWRpb19wcm9wZXJ0eSkgewo+ID4gKwlpZiAocHJvcGVydHkgPT0g
aTkxNS0+Zm9yY2VfYXVkaW9fcHJvcGVydHkpIHsKPiA+ICAgCQlpbnRlbF9jb25uX3N0YXRlLT5m
b3JjZV9hdWRpbyA9IHZhbDsKPiA+ICAgCQlyZXR1cm4gMDsKPiA+ICAgCX0KPiA+IC0JaWYgKHBy
b3BlcnR5ID09IGRldl9wcml2LT5icm9hZGNhc3RfcmdiX3Byb3BlcnR5KSB7Cj4gPiArCWlmIChw
cm9wZXJ0eSA9PSBpOTE1LT5icm9hZGNhc3RfcmdiX3Byb3BlcnR5KSB7Cj4gPiAgIAkJaW50ZWxf
Y29ubl9zdGF0ZS0+YnJvYWRjYXN0X3JnYiA9IHZhbDsKPiA+ICAgCQlyZXR1cm4gMDsKPiA+ICAg
CX0KPiA+IEBAIC0yMjcsNyArMjI3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX3NldHVw
X3NjYWxlcihzdHJ1Y3QgaW50ZWxfY3J0Y19zY2FsZXJfc3RhdGUgKnNjYWxlcl9zdGEKPiA+ICAg
CQkJCSAgICAgIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUsCj4gPiAgIAkJ
CQkgICAgICBpbnQgKnNjYWxlcl9pZCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2NydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGludGVsX2NydGMtPmJhc2UuZGV2
KTsKPiA+ICAgCWludCBqOwo+ID4gICAJdTMyIG1vZGU7Cj4gPiBAQCAtMjUxLDEwICsyNTEsMTAg
QEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX3NldHVwX3NjYWxlcihzdHJ1Y3QgaW50ZWxfY3J0
Y19zY2FsZXJfc3RhdGUgKnNjYWxlcl9zdGEKPiA+ICAgCSAgICBwbGFuZV9zdGF0ZS0+YmFzZS5m
Yi0+Zm9ybWF0LT5pc195dXYgJiYKPiA+ICAgCSAgICBwbGFuZV9zdGF0ZS0+YmFzZS5mYi0+Zm9y
bWF0LT5udW1fcGxhbmVzID4gMSkgewo+ID4gICAJCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUg
PSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4gPiAtCQlpZiAoSVNf
R0VOKGRldl9wcml2LCA5KSAmJgo+ID4gLQkJICAgICFJU19HRU1JTklMQUtFKGRldl9wcml2KSkg
ewo+ID4gKwkJaWYgKElTX0dFTihpOTE1LCA5KSAmJgo+ID4gKwkJICAgICFJU19HRU1JTklMQUtF
KGk5MTUpKSB7Cj4gPiAgIAkJCW1vZGUgPSBTS0xfUFNfU0NBTEVSX01PREVfTlYxMjsKPiA+IC0J
CX0gZWxzZSBpZiAoaWNsX2lzX2hkcl9wbGFuZShkZXZfcHJpdiwgcGxhbmUtPmlkKSkgewo+ID4g
KwkJfSBlbHNlIGlmIChpY2xfaXNfaGRyX3BsYW5lKGk5MTUsIHBsYW5lLT5pZCkpIHsKPiA+ICAg
CQkJLyoKPiA+ICAgCQkJICogT24gZ2VuMTErJ3MgSERSIHBsYW5lcyB3ZSBvbmx5IHVzZSB0aGUg
c2NhbGVyIGZvcgo+ID4gICAJCQkgKiBzY2FsaW5nLiBUaGV5IGhhdmUgYSBkZWRpY2F0ZWQgY2hy
b21hIHVwc2FtcGxlciwgc28KPiA+IEBAIC0yNjcsNyArMjY3LDcgQEAgc3RhdGljIHZvaWQgaW50
ZWxfYXRvbWljX3NldHVwX3NjYWxlcihzdHJ1Y3QgaW50ZWxfY3J0Y19zY2FsZXJfc3RhdGUgKnNj
YWxlcl9zdGEKPiA+ICAgCQkJaWYgKHBsYW5lX3N0YXRlLT5saW5rZWRfcGxhbmUpCj4gPiAgIAkJ
CQltb2RlIHw9IFBTX1BMQU5FX1lfU0VMKHBsYW5lX3N0YXRlLT5saW5rZWRfcGxhbmUtPmlkKTsK
PiA+ICAgCQl9Cj4gPiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+IDkgfHwgSVNf
R0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkg
PiA5IHx8IElTX0dFTUlOSUxBS0UoaTkxNSkpIHsKPiA+ICAgCQltb2RlID0gUFNfU0NBTEVSX01P
REVfTk9STUFMOwo+ID4gICAJfSBlbHNlIGlmIChudW1fc2NhbGVyc19uZWVkID09IDEgJiYgaW50
ZWxfY3J0Yy0+bnVtX3NjYWxlcnMgPiAxKSB7Cj4gPiAgIAkJLyoKPiA+IEBAIC0yOTAsNyArMjkw
LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX3NldHVwX3NjYWxlcihzdHJ1Y3QgaW50ZWxf
Y3J0Y19zY2FsZXJfc3RhdGUgKnNjYWxlcl9zdGEKPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2F0
b21pY19zZXR1cF9zY2FsZXJzKCkgLSBzZXR1cCBzY2FsZXJzIGZvciBjcnRjIHBlciBzdGFnZWQg
cmVxdWVzdHMKPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlCj4gPiArICogQGk5MTU6IGk5
MTUgZGV2aWNlCj4gPiAgICAqIEBpbnRlbF9jcnRjOiBpbnRlbCBjcnRjCj4gPiAgICAqIEBjcnRj
X3N0YXRlOiBpbmNvbWluZyBjcnRjX3N0YXRlIHRvIHZhbGlkYXRlIGFuZCBzZXR1cCBzY2FsZXJz
Cj4gPiAgICAqCj4gPiBAQCAtMzA1LDcgKzMwNSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21p
Y19zZXR1cF9zY2FsZXIoc3RydWN0IGludGVsX2NydGNfc2NhbGVyX3N0YXRlICpzY2FsZXJfc3Rh
Cj4gPiAgICAqICAgICAgICAgMCAtIHNjYWxlcnMgd2VyZSBzZXR1cCBzdWNjZXNmdWxseQo+ID4g
ICAgKiAgICAgICAgIGVycm9yIGNvZGUgLSBvdGhlcndpc2UKPiA+ICAgICovCj4gPiAtaW50IGlu
dGVsX2F0b21pY19zZXR1cF9zY2FsZXJzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICtpbnQgaW50ZWxfYXRvbWljX3NldHVwX3NjYWxlcnMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0
YywKPiA+ICAgCQkJICAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
ID4gICB7Cj4gPiBAQCAtMzY5LDcgKzM2OSw3IEBAIGludCBpbnRlbF9hdG9taWNfc2V0dXBfc2Nh
bGVycyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJCSAqLwo+ID4g
ICAJCQlpZiAoIXBsYW5lKSB7Cj4gPiAgIAkJCQlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpzdGF0
ZTsKPiA+IC0JCQkJcGxhbmUgPSBkcm1fcGxhbmVfZnJvbV9pbmRleCgmZGV2X3ByaXYtPmRybSwg
aSk7Cj4gPiArCQkJCXBsYW5lID0gZHJtX3BsYW5lX2Zyb21faW5kZXgoJmk5MTUtPmRybSwgaSk7
Cj4gPiAgIAkJCQlzdGF0ZSA9IGRybV9hdG9taWNfZ2V0X3BsYW5lX3N0YXRlKGRybV9zdGF0ZSwg
cGxhbmUpOwo+ID4gICAJCQkJaWYgKElTX0VSUihzdGF0ZSkpIHsKPiA+ICAgCQkJCQlEUk1fREVC
VUdfS01TKCJGYWlsZWQgdG8gYWRkIFtQTEFORTolZF0gdG8gZHJtX3N0YXRlXG4iLAo+ID4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2F0b21pYy5oIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfYXRvbWljLmgKPiA+IGluZGV4IDFjODUwN2RhMWE2OS4uNTQ4MmZk
MDRkNjM5IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXRvbWlj
LmgKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2F0b21pYy5oCj4gPiBAQCAt
NDIsNyArNDIsNyBAQCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqCj4gPiAgIGludGVsX2F0b21p
Y19nZXRfY3J0Y19zdGF0ZShzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gPiAgIAkJ
CSAgICBzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0Yyk7Cj4gPiAtaW50IGludGVsX2F0b21pY19zZXR1
cF9zY2FsZXJzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpbnQgaW50
ZWxfYXRvbWljX3NldHVwX3NjYWxlcnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywKPiA+ICAgCQkJICAg
ICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKPiA+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9hdWRpby5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfYXVkaW8uYwo+ID4gaW5kZXggODQwZGFmZjEyMjQ2Li5mNDYzZDg0NTJmZTkgMTAw
NjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9hdWRpby5jCj4gPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9hdWRpby5jCj4gPiBAQCAtMjMwLDcgKzIzMCw3
IEBAIHN0YXRpYyBib29sIGludGVsX2VsZF91cHRvZGF0ZShzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAq
Y29ubmVjdG9yLAo+ID4gICAJCQkgICAgICAgaTkxNV9yZWdfdCByZWdfZWxkYSwgdTMyIGJpdHNf
ZWxkYSwKPiA+ICAgCQkJICAgICAgIGk5MTVfcmVnX3QgcmVnX2VkaWQpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0
b3ItPmRldik7Cj4gPiAgIAljb25zdCB1OCAqZWxkID0gY29ubmVjdG9yLT5lbGQ7Cj4gPiAgIAl1
MzIgdG1wOwo+ID4gICAJaW50IGk7Cj4gPiBAQCAtMjU2LDcgKzI1Niw3IEBAIHN0YXRpYyB2b2lk
IGc0eF9hdWRpb19jb2RlY19kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ID4gICAJCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0
ZSwKPiA+ICAgCQkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nv
bm5fc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAl1MzIgZWxkdiwg
dG1wOwo+ID4gICAJRFJNX0RFQlVHX0tNUygiRGlzYWJsZSBhdWRpbyBjb2RlY1xuIik7Cj4gPiBA
QCAtMjc3LDcgKzI3Nyw3IEBAIHN0YXRpYyB2b2lkIGc0eF9hdWRpb19jb2RlY19lbmFibGUoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJCSAgIGNvbnN0IHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+ID4gICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IGNvbm5fc3RhdGUtPmNv
bm5lY3RvcjsKPiA+ICAgCWNvbnN0IHU4ICplbGQgPSBjb25uZWN0b3ItPmVsZDsKPiA+ICAgCXUz
MiBlbGR2Owo+ID4gQEAgLTMxNyw4ICszMTcsOCBAQCBzdGF0aWMgdm9pZAo+ID4gICBoc3dfZHBf
YXVkaW9fY29uZmlnX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAg
CQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7Cj4gPiAtCXN0cnVjdCBpOTE1X2F1ZGlvX2NvbXBvbmVudCAqYWNvbXAgPSBk
ZXZfcHJpdi0+YXVkaW9fY29tcG9uZW50Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgaTkxNV9hdWRp
b19jb21wb25lbnQgKmFjb21wID0gaTkxNS0+YXVkaW9fY29tcG9uZW50Owo+ID4gICAJZW51bSB0
cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4g
PiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gPiAgIAljb25zdCBzdHJ1Y3Qg
ZHBfYXVkX25fbSAqbm07Cj4gPiBAQCAtMzY0LDggKzM2NCw4IEBAIHN0YXRpYyB2b2lkCj4gPiAg
IGhzd19oZG1pX2F1ZGlvX2NvbmZpZ191cGRhdGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gPiAgIAkJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAtCXN0cnVjdCBpOTE1X2F1ZGlvX2NvbXBvbmVu
dCAqYWNvbXAgPSBkZXZfcHJpdi0+YXVkaW9fY29tcG9uZW50Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1
Y3QgaTkxNV9hdWRpb19jb21wb25lbnQgKmFjb21wID0gaTkxNS0+YXVkaW9fY29tcG9uZW50Owo+
ID4gICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3Ry
YW5zY29kZXI7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gPiAgIAlp
bnQgbiwgcmF0ZTsKPiA+IEBAIC00MTYsMTQgKzQxNiwxNCBAQCBzdGF0aWMgdm9pZCBoc3dfYXVk
aW9fY29kZWNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJ
CSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gPiAg
IAkJCQkgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRl
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSB0cmFuc2NvZGVyIGNw
dV90cmFuc2NvZGVyID0gb2xkX2NydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+ID4gICAJdTMy
IHRtcDsKPiA+ICAgCURSTV9ERUJVR19LTVMoIkRpc2FibGUgYXVkaW8gY29kZWMgb24gdHJhbnNj
b2RlciAlc1xuIiwKPiA+ICAgCQkgICAgICB0cmFuc2NvZGVyX25hbWUoY3B1X3RyYW5zY29kZXIp
KTsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmF2X211dGV4KTsKPiA+ICsJbXV0ZXhfbG9j
aygmaTkxNS0+YXZfbXV0ZXgpOwo+ID4gICAJLyogRGlzYWJsZSB0aW1lc3RhbXBzICovCj4gPiAg
IAl0bXAgPSBJOTE1X1JFQUQoSFNXX0FVRF9DRkcoY3B1X3RyYW5zY29kZXIpKTsKPiA+IEBAIC00
NDEsMTQgKzQ0MSwxNCBAQCBzdGF0aWMgdm9pZCBoc3dfYXVkaW9fY29kZWNfZGlzYWJsZShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCXRtcCAmPSB+QVVESU9fT1VUUFVUX0VO
QUJMRShjcHVfdHJhbnNjb2Rlcik7Cj4gPiAgIAlJOTE1X1dSSVRFKEhTV19BVURfUElOX0VMRF9D
UF9WTEQsIHRtcCk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmF2X211dGV4KTsKPiA+
ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5hdl9tdXRleCk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZv
aWQgaHN3X2F1ZGlvX2NvZGVjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiA+ICAgCQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ID4gICAJCQkJICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yID0gY29ubl9zdGF0ZS0+Y29ubmVjdG9yOwo+ID4gICAJZW51bSB0cmFuc2Nv
ZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gPiAgIAlj
b25zdCB1OCAqZWxkID0gY29ubmVjdG9yLT5lbGQ7Cj4gPiBAQCAtNDU4LDcgKzQ1OCw3IEBAIHN0
YXRpYyB2b2lkIGhzd19hdWRpb19jb2RlY19lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gPiAgIAlEUk1fREVCVUdfS01TKCJFbmFibGUgYXVkaW8gY29kZWMgb24gdHJhbnNj
b2RlciAlcywgJXUgYnl0ZXMgRUxEXG4iLAo+ID4gICAJCSAgICAgIHRyYW5zY29kZXJfbmFtZShj
cHVfdHJhbnNjb2RlciksIGRybV9lbGRfc2l6ZShlbGQpKTsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2
X3ByaXYtPmF2X211dGV4KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+YXZfbXV0ZXgpOwo+ID4g
ICAJLyogRW5hYmxlIGF1ZGlvIHByZXNlbmNlIGRldGVjdCwgaW52YWxpZGF0ZSBFTEQgKi8KPiA+
ICAgCXRtcCA9IEk5MTVfUkVBRChIU1dfQVVEX1BJTl9FTERfQ1BfVkxEKTsKPiA+IEBAIC00OTEs
MTQgKzQ5MSwxNCBAQCBzdGF0aWMgdm9pZCBoc3dfYXVkaW9fY29kZWNfZW5hYmxlKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJLyogRW5hYmxlIHRpbWVzdGFtcHMgKi8KPiA+
ICAgCWhzd19hdWRpb19jb25maWdfdXBkYXRlKGVuY29kZXIsIGNydGNfc3RhdGUpOwo+ID4gLQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5hdl9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkx
NS0+YXZfbXV0ZXgpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGlsa19hdWRpb19jb2RlY19k
aXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJICAgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiA+ICAgCQkJCSAgICBj
b25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAgIAllbnVtIHBpcGUg
cGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7
Cj4gPiBAQCAtNTExLDEwICs1MTEsMTAgQEAgc3RhdGljIHZvaWQgaWxrX2F1ZGlvX2NvZGVjX2Rp
c2FibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAlpZiAoV0FSTl9PTihw
b3J0ID09IFBPUlRfQSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlpZiAoSEFTX1BDSF9JQlgoZGV2
X3ByaXYpKSB7Cj4gPiArCWlmIChIQVNfUENIX0lCWChpOTE1KSkgewo+ID4gICAJCWF1ZF9jb25m
aWcgPSBJQlhfQVVEX0NGRyhwaXBlKTsKPiA+ICAgCQlhdWRfY250cmxfc3QyID0gSUJYX0FVRF9D
TlRMX1NUMjsKPiA+IC0JfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19D
SEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkx
NSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ID4gICAJCWF1ZF9jb25maWcgPSBWTFZfQVVE
X0NGRyhwaXBlKTsKPiA+ICAgCQlhdWRfY250cmxfc3QyID0gVkxWX0FVRF9DTlRMX1NUMjsKPiA+
ICAgCX0gZWxzZSB7Cj4gPiBAQCAtNTQ0LDcgKzU0NCw3IEBAIHN0YXRpYyB2b2lkIGlsa19hdWRp
b19jb2RlY19lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkg
ICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJCSAg
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvciAqY29ubmVjdG9yID0gY29ubl9zdGF0ZS0+Y29ubmVjdG9yOwo+ID4gICAJZW51bSBwaXBl
IHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gQEAgLTU2NywxMyArNTY3LDEzIEBAIHN0YXRpYyB2b2lk
IGlsa19hdWRpb19jb2RlY19lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
PiAgIAkgKiBpbmZyYXN0cnVjdHVyZSBpcyBub3QgdGhlcmUgeWV0Lgo+ID4gICAJICovCj4gPiAt
CWlmIChIQVNfUENIX0lCWChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19QQ0hfSUJYKGk5MTUp
KSB7Cj4gPiAgIAkJaGRtaXdfaGRtaWVkaWQgPSBJQlhfSERNSVdfSERNSUVESUQocGlwZSk7Cj4g
PiAgIAkJYXVkX2NvbmZpZyA9IElCWF9BVURfQ0ZHKHBpcGUpOwo+ID4gICAJCWF1ZF9jbnRsX3N0
ID0gSUJYX0FVRF9DTlRMX1NUKHBpcGUpOwo+ID4gICAJCWF1ZF9jbnRybF9zdDIgPSBJQlhfQVVE
X0NOVExfU1QyOwo+ID4gLQl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8Cj4g
PiAtCQkgICBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX1ZB
TExFWVZJRVcoaTkxNSkgfHwKPiA+ICsJCSAgIElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+ICAg
CQloZG1pd19oZG1pZWRpZCA9IFZMVl9IRE1JV19IRE1JRURJRChwaXBlKTsKPiA+ICAgCQlhdWRf
Y29uZmlnID0gVkxWX0FVRF9DRkcocGlwZSk7Cj4gPiAgIAkJYXVkX2NudGxfc3QgPSBWTFZfQVVE
X0NOVExfU1QocGlwZSk7Cj4gPiBAQCAtNjMyLDggKzYzMiw4IEBAIHZvaWQgaW50ZWxfYXVkaW9f
Y29kZWNfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkgICAg
ICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJICAg
ICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7Cj4gPiAtCXN0cnVjdCBpOTE1X2F1ZGlvX2NvbXBvbmVudCAqYWNvbXAgPSBk
ZXZfcHJpdi0+YXVkaW9fY29tcG9uZW50Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgaTkxNV9hdWRp
b19jb21wb25lbnQgKmFjb21wID0gaTkxNS0+YXVkaW9fY29tcG9uZW50Owo+ID4gICAJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gY29ubl9zdGF0ZS0+Y29u
bmVjdG9yOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21v
ZGUgPQo+ID4gQEAgLTY1NCwxNyArNjU0LDE3IEBAIHZvaWQgaW50ZWxfYXVkaW9fY29kZWNfZW5h
YmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJY29ubmVjdG9yLT5lbGRb
Nl0gPSBkcm1fYXZfc3luY19kZWxheShjb25uZWN0b3IsIGFkanVzdGVkX21vZGUpIC8gMjsKPiA+
IC0JaWYgKGRldl9wcml2LT5kaXNwbGF5LmF1ZGlvX2NvZGVjX2VuYWJsZSkKPiA+IC0JCWRldl9w
cml2LT5kaXNwbGF5LmF1ZGlvX2NvZGVjX2VuYWJsZShlbmNvZGVyLAo+ID4gKwlpZiAoaTkxNS0+
ZGlzcGxheS5hdWRpb19jb2RlY19lbmFibGUpCj4gPiArCQlpOTE1LT5kaXNwbGF5LmF1ZGlvX2Nv
ZGVjX2VuYWJsZShlbmNvZGVyLAo+ID4gICAJCQkJCQkgICAgIGNydGNfc3RhdGUsCj4gPiAgIAkJ
CQkJCSAgICAgY29ubl9zdGF0ZSk7Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5hdl9tdXRl
eCk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmF2X211dGV4KTsKPiA+ICAgCWVuY29kZXItPmF1
ZGlvX2Nvbm5lY3RvciA9IGNvbm5lY3RvcjsKPiA+ICAgCS8qIHJlZmVycmVkIGluIGF1ZGlvIGNh
bGxiYWNrcyAqLwo+ID4gLQlkZXZfcHJpdi0+YXZfZW5jX21hcFtwaXBlXSA9IGVuY29kZXI7Cj4g
PiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmF2X211dGV4KTsKPiA+ICsJaTkxNS0+YXZfZW5j
X21hcFtwaXBlXSA9IGVuY29kZXI7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+YXZfbXV0ZXgp
Owo+ID4gICAJaWYgKGFjb21wICYmIGFjb21wLT5iYXNlLmF1ZGlvX29wcyAmJgo+ID4gICAJICAg
IGFjb21wLT5iYXNlLmF1ZGlvX29wcy0+cGluX2VsZF9ub3RpZnkpIHsKPiA+IEBAIC02NzUsNyAr
Njc1LDcgQEAgdm9pZCBpbnRlbF9hdWRpb19jb2RlY19lbmFibGUoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkJCSAoaW50KSBwb3J0LCAoaW50KSBwaXBlKTsKPiA+ICAg
CX0KPiA+IC0JaW50ZWxfbHBlX2F1ZGlvX25vdGlmeShkZXZfcHJpdiwgcGlwZSwgcG9ydCwgY29u
bmVjdG9yLT5lbGQsCj4gPiArCWludGVsX2xwZV9hdWRpb19ub3RpZnkoaTkxNSwgcGlwZSwgcG9y
dCwgY29ubmVjdG9yLT5lbGQsCj4gPiAgIAkJCSAgICAgICBjcnRjX3N0YXRlLT5wb3J0X2Nsb2Nr
LAo+ID4gICAJCQkgICAgICAgaW50ZWxfY3J0Y19oYXNfZHBfZW5jb2RlcihjcnRjX3N0YXRlKSk7
Cj4gPiAgIH0KPiA+IEBAIC02OTMsMjEgKzY5MywyMSBAQCB2b2lkIGludGVsX2F1ZGlvX2NvZGVj
X2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgICAgICBj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gPiAgIAkJCSAg
ICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4g
PiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7Cj4gPiAtCXN0cnVjdCBpOTE1X2F1ZGlvX2NvbXBvbmVudCAqYWNv
bXAgPSBkZXZfcHJpdi0+YXVkaW9fY29tcG9uZW50Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgaTkx
NV9hdWRpb19jb21wb25lbnQgKmFjb21wID0gaTkxNS0+YXVkaW9fY29tcG9uZW50Owo+ID4gICAJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+ID4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ID4gICAJ
ZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmRpc3BsYXku
YXVkaW9fY29kZWNfZGlzYWJsZSkKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmF1ZGlvX2NvZGVj
X2Rpc2FibGUoZW5jb2RlciwKPiA+ICsJaWYgKGk5MTUtPmRpc3BsYXkuYXVkaW9fY29kZWNfZGlz
YWJsZSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuYXVkaW9fY29kZWNfZGlzYWJsZShlbmNvZGVyLAo+
ID4gICAJCQkJCQkgICAgICBvbGRfY3J0Y19zdGF0ZSwKPiA+ICAgCQkJCQkJICAgICAgb2xkX2Nv
bm5fc3RhdGUpOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+YXZfbXV0ZXgpOwo+ID4gKwlt
dXRleF9sb2NrKCZpOTE1LT5hdl9tdXRleCk7Cj4gPiAgIAllbmNvZGVyLT5hdWRpb19jb25uZWN0
b3IgPSBOVUxMOwo+ID4gLQlkZXZfcHJpdi0+YXZfZW5jX21hcFtwaXBlXSA9IE5VTEw7Cj4gPiAt
CW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmF2X211dGV4KTsKPiA+ICsJaTkxNS0+YXZfZW5jX21h
cFtwaXBlXSA9IE5VTEw7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+YXZfbXV0ZXgpOwo+ID4g
ICAJaWYgKGFjb21wICYmIGFjb21wLT5iYXNlLmF1ZGlvX29wcyAmJgo+ID4gICAJICAgIGFjb21w
LT5iYXNlLmF1ZGlvX29wcy0+cGluX2VsZF9ub3RpZnkpIHsKPiA+IEBAIC03MTgsMzEgKzcxOCwz
MSBAQCB2b2lkIGludGVsX2F1ZGlvX2NvZGVjX2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gPiAgIAkJCQkJCSAoaW50KSBwb3J0LCAoaW50KSBwaXBlKTsKPiA+ICAgCX0K
PiA+IC0JaW50ZWxfbHBlX2F1ZGlvX25vdGlmeShkZXZfcHJpdiwgcGlwZSwgcG9ydCwgTlVMTCwg
MCwgZmFsc2UpOwo+ID4gKwlpbnRlbF9scGVfYXVkaW9fbm90aWZ5KGk5MTUsIHBpcGUsIHBvcnQs
IE5VTEwsIDAsIGZhbHNlKTsKPiA+ICAgfQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfaW5pdF9h
dWRpb19ob29rcyAtIFNldCB1cCBjaGlwIHNwZWNpZmljIGF1ZGlvIGhvb2tzCj4gPiAtICogQGRl
dl9wcml2OiBkZXZpY2UgcHJpdmF0ZQo+ID4gKyAqIEBpOTE1OiBkZXZpY2UgcHJpdmF0ZQo+ID4g
ICAgKi8KPiA+IC12b2lkIGludGVsX2luaXRfYXVkaW9faG9va3Moc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfaW5pdF9hdWRpb19ob29rcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoSVNfRzRYKGRldl9wcml2
KSkgewo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuYXVkaW9fY29kZWNfZW5hYmxlID0gZzR4X2F1
ZGlvX2NvZGVjX2VuYWJsZTsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmF1ZGlvX2NvZGVjX2Rp
c2FibGUgPSBnNHhfYXVkaW9fY29kZWNfZGlzYWJsZTsKPiA+IC0JfSBlbHNlIGlmIChJU19WQUxM
RVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4gLQkJZGV2
X3ByaXYtPmRpc3BsYXkuYXVkaW9fY29kZWNfZW5hYmxlID0gaWxrX2F1ZGlvX2NvZGVjX2VuYWJs
ZTsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmF1ZGlvX2NvZGVjX2Rpc2FibGUgPSBpbGtfYXVk
aW9fY29kZWNfZGlzYWJsZTsKPiA+IC0JfSBlbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8
fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpIHsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmF1
ZGlvX2NvZGVjX2VuYWJsZSA9IGhzd19hdWRpb19jb2RlY19lbmFibGU7Cj4gPiAtCQlkZXZfcHJp
di0+ZGlzcGxheS5hdWRpb19jb2RlY19kaXNhYmxlID0gaHN3X2F1ZGlvX2NvZGVjX2Rpc2FibGU7
Cj4gPiAtCX0gZWxzZSBpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpIHsKPiA+IC0JCWRldl9w
cml2LT5kaXNwbGF5LmF1ZGlvX2NvZGVjX2VuYWJsZSA9IGlsa19hdWRpb19jb2RlY19lbmFibGU7
Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5hdWRpb19jb2RlY19kaXNhYmxlID0gaWxrX2F1ZGlv
X2NvZGVjX2Rpc2FibGU7Cj4gPiArCWlmIChJU19HNFgoaTkxNSkpIHsKPiA+ICsJCWk5MTUtPmRp
c3BsYXkuYXVkaW9fY29kZWNfZW5hYmxlID0gZzR4X2F1ZGlvX2NvZGVjX2VuYWJsZTsKPiA+ICsJ
CWk5MTUtPmRpc3BsYXkuYXVkaW9fY29kZWNfZGlzYWJsZSA9IGc0eF9hdWRpb19jb2RlY19kaXNh
YmxlOwo+ID4gKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklF
VyhpOTE1KSkgewo+ID4gKwkJaTkxNS0+ZGlzcGxheS5hdWRpb19jb2RlY19lbmFibGUgPSBpbGtf
YXVkaW9fY29kZWNfZW5hYmxlOwo+ID4gKwkJaTkxNS0+ZGlzcGxheS5hdWRpb19jb2RlY19kaXNh
YmxlID0gaWxrX2F1ZGlvX2NvZGVjX2Rpc2FibGU7Cj4gPiArCX0gZWxzZSBpZiAoSVNfSEFTV0VM
TChpOTE1KSB8fCBJTlRFTF9HRU4oaTkxNSkgPj0gOCkgewo+ID4gKwkJaTkxNS0+ZGlzcGxheS5h
dWRpb19jb2RlY19lbmFibGUgPSBoc3dfYXVkaW9fY29kZWNfZW5hYmxlOwo+ID4gKwkJaTkxNS0+
ZGlzcGxheS5hdWRpb19jb2RlY19kaXNhYmxlID0gaHN3X2F1ZGlvX2NvZGVjX2Rpc2FibGU7Cj4g
PiArCX0gZWxzZSBpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkgewo+ID4gKwkJaTkxNS0+ZGlzcGxh
eS5hdWRpb19jb2RlY19lbmFibGUgPSBpbGtfYXVkaW9fY29kZWNfZW5hYmxlOwo+ID4gKwkJaTkx
NS0+ZGlzcGxheS5hdWRpb19jb2RlY19kaXNhYmxlID0gaWxrX2F1ZGlvX2NvZGVjX2Rpc2FibGU7
Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnbGtfZm9yY2VfYXVkaW9fY2RjbGso
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGdsa19m
b3JjZV9hdWRpb19jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJ
CSAgYm9vbCBlbmFibGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fbW9kZXNldF9hY3F1aXJl
X2N0eCBjdHg7Cj4gPiBAQCAtNzUwLDcgKzc1MCw3IEBAIHN0YXRpYyB2b2lkIGdsa19mb3JjZV9h
dWRpb19jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlpbnQg
cmV0Owo+ID4gICAJZHJtX21vZGVzZXRfYWNxdWlyZV9pbml0KCZjdHgsIDApOwo+ID4gLQlzdGF0
ZSA9IGRybV9hdG9taWNfc3RhdGVfYWxsb2MoJmRldl9wcml2LT5kcm0pOwo+ID4gKwlzdGF0ZSA9
IGRybV9hdG9taWNfc3RhdGVfYWxsb2MoJmk5MTUtPmRybSk7Cj4gPiAgIAlpZiAoV0FSTl9PTigh
c3RhdGUpKQo+ID4gICAJCXJldHVybjsKPiA+IEBAIC03NjIsMTEgKzc2MiwxMSBAQCBzdGF0aWMg
dm9pZCBnbGtfZm9yY2VfYXVkaW9fY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gICAJCWVuYWJsZSA/IDIgKiA5NjAwMCA6IDA7Cj4gPiAgIAkvKgo+ID4gLQkgKiBQ
cm90ZWN0cyBkZXZfcHJpdi0+Y2RjbGsuZm9yY2VfbWluX2NkY2xrCj4gPiArCSAqIFByb3RlY3Rz
IGk5MTUtPmNkY2xrLmZvcmNlX21pbl9jZGNsawo+ID4gICAJICogTmVlZCB0byBsb2NrIHRoaXMg
aGVyZSBpbiBjYXNlIHdlIGhhdmUgbm8gYWN0aXZlIHBpcGVzCj4gPiAgIAkgKiBhbmQgdGh1cyB3
b3VsZG4ndCBsb2NrIGl0IGR1cmluZyB0aGUgY29tbWl0IG90aGVyd2lzZS4KPiA+ICAgCSAqLwo+
ID4gLQlyZXQgPSBkcm1fbW9kZXNldF9sb2NrKCZkZXZfcHJpdi0+ZHJtLm1vZGVfY29uZmlnLmNv
bm5lY3Rpb25fbXV0ZXgsCj4gPiArCXJldCA9IGRybV9tb2Rlc2V0X2xvY2soJmk5MTUtPmRybS5t
b2RlX2NvbmZpZy5jb25uZWN0aW9uX211dGV4LAo+ID4gICAJCQkgICAgICAgJmN0eCk7Cj4gPiAg
IAlpZiAoIXJldCkKPiA+ICAgCQlyZXQgPSBkcm1fYXRvbWljX2NvbW1pdChzdGF0ZSk7Cj4gPiBA
QCAtNzg3LDE4ICs3ODcsMTggQEAgc3RhdGljIHZvaWQgZ2xrX2ZvcmNlX2F1ZGlvX2NkY2xrKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgc3RhdGljIHVuc2lnbmVkIGxv
bmcgaTkxNV9hdWRpb19jb21wb25lbnRfZ2V0X3Bvd2VyKHN0cnVjdCBkZXZpY2UgKmtkZXYpCj4g
PiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl90b19p
OTE1KGtkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGtkZXZfdG9f
aTkxNShrZGV2KTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCByZXQ7Cj4gPiAgIAkvKiBDYXRjaCBw
b3RlbnRpYWwgaW1wZWRhbmNlIG1pc21hdGNoZXMgYmVmb3JlIHRoZXkgb2NjdXIhICovCj4gPiAg
IAlCVUlMRF9CVUdfT04oc2l6ZW9mKGludGVsX3dha2VyZWZfdCkgPiBzaXplb2YodW5zaWduZWQg
bG9uZykpOwo+ID4gLQlyZXQgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwgUE9X
RVJfRE9NQUlOX0FVRElPKTsKPiA+ICsJcmV0ID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkx
NSwgUE9XRVJfRE9NQUlOX0FVRElPKTsKPiA+ICAgCS8qIEZvcmNlIENEQ0xLIHRvIDIqQkNMSyBh
cyBsb25nIGFzIHdlIG5lZWQgYXVkaW8gdG8gYmUgcG93ZXJlZC4gKi8KPiA+IC0JaWYgKGRldl9w
cml2LT5hdWRpb19wb3dlcl9yZWZjb3VudCsrID09IDApCj4gPiAtCQlpZiAoSVNfQ0FOTk9OTEFL
RShkZXZfcHJpdikgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gPiAtCQkJZ2xrX2ZvcmNl
X2F1ZGlvX2NkY2xrKGRldl9wcml2LCB0cnVlKTsKPiA+ICsJaWYgKGk5MTUtPmF1ZGlvX3Bvd2Vy
X3JlZmNvdW50KysgPT0gMCkKPiA+ICsJCWlmIChJU19DQU5OT05MQUtFKGk5MTUpIHx8IElTX0dF
TUlOSUxBS0UoaTkxNSkpCj4gPiArCQkJZ2xrX2ZvcmNlX2F1ZGlvX2NkY2xrKGk5MTUsIHRydWUp
Owo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTgwNiwyNCArODA2LDI0IEBAIHN0
YXRpYyB1bnNpZ25lZCBsb25nIGk5MTVfYXVkaW9fY29tcG9uZW50X2dldF9wb3dlcihzdHJ1Y3Qg
ZGV2aWNlICprZGV2KQo+ID4gICBzdGF0aWMgdm9pZCBpOTE1X2F1ZGlvX2NvbXBvbmVudF9wdXRf
cG93ZXIoc3RydWN0IGRldmljZSAqa2RldiwKPiA+ICAgCQkJCQkgICB1bnNpZ25lZCBsb25nIGNv
b2tpZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBr
ZGV2X3RvX2k5MTUoa2Rldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
a2Rldl90b19pOTE1KGtkZXYpOwo+ID4gICAJLyogU3RvcCBmb3JjaW5nIENEQ0xLIHRvIDIqQkNM
SyBpZiBubyBuZWVkIGZvciBhdWRpbyB0byBiZSBwb3dlcmVkLiAqLwo+ID4gLQlpZiAoLS1kZXZf
cHJpdi0+YXVkaW9fcG93ZXJfcmVmY291bnQgPT0gMCkKPiA+IC0JCWlmIChJU19DQU5OT05MQUtF
KGRldl9wcml2KSB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSkKPiA+IC0JCQlnbGtfZm9yY2Vf
YXVkaW9fY2RjbGsoZGV2X3ByaXYsIGZhbHNlKTsKPiA+ICsJaWYgKC0taTkxNS0+YXVkaW9fcG93
ZXJfcmVmY291bnQgPT0gMCkKPiA+ICsJCWlmIChJU19DQU5OT05MQUtFKGk5MTUpIHx8IElTX0dF
TUlOSUxBS0UoaTkxNSkpCj4gPiArCQkJZ2xrX2ZvcmNlX2F1ZGlvX2NkY2xrKGk5MTUsIGZhbHNl
KTsKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9B
VURJTywgY29va2llKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJf
RE9NQUlOX0FVRElPLCBjb29raWUpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGk5MTVfYXVk
aW9fY29tcG9uZW50X2NvZGVjX3dha2Vfb3ZlcnJpZGUoc3RydWN0IGRldmljZSAqa2RldiwKPiA+
ICAgCQkJCQkJICAgICBib29sIGVuYWJsZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X3RvX2k5MTUoa2Rldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl90b19pOTE1KGtkZXYpOwo+ID4gICAJdW5zaWduZWQg
bG9uZyBjb29raWU7Cj4gPiAgIAl1MzIgdG1wOwo+ID4gLQlpZiAoIUlTX0dFTihkZXZfcHJpdiwg
OSkpCj4gPiArCWlmICghSVNfR0VOKGk5MTUsIDkpKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCWNv
b2tpZSA9IGk5MTVfYXVkaW9fY29tcG9uZW50X2dldF9wb3dlcihrZGV2KTsKPiA+IEBAIC04NTAs
MTIgKzg1MCwxMiBAQCBzdGF0aWMgdm9pZCBpOTE1X2F1ZGlvX2NvbXBvbmVudF9jb2RlY193YWtl
X292ZXJyaWRlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCj4gPiAgIC8qIEdldCBDRENMSyBpbiBrSHog
ICovCj4gPiAgIHN0YXRpYyBpbnQgaTkxNV9hdWRpb19jb21wb25lbnRfZ2V0X2NkY2xrX2ZyZXEo
c3RydWN0IGRldmljZSAqa2RldikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSBrZGV2X3RvX2k5MTUoa2Rldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0ga2Rldl90b19pOTE1KGtkZXYpOwo+ID4gLQlpZiAoV0FSTl9PTl9PTkNF
KCFIQVNfRERJKGRldl9wcml2KSkpCj4gPiArCWlmIChXQVJOX09OX09OQ0UoIUhBU19EREkoaTkx
NSkpKQo+ID4gICAJCXJldHVybiAtRU5PREVWOwo+ID4gLQlyZXR1cm4gZGV2X3ByaXYtPmNkY2xr
Lmh3LmNkY2xrOwo+ID4gKwlyZXR1cm4gaTkxNS0+Y2RjbGsuaHcuY2RjbGs7Cj4gPiAgIH0KPiA+
ICAgLyoKPiA+IEBAIC04NjgsMTcgKzg2OCwxNyBAQCBzdGF0aWMgaW50IGk5MTVfYXVkaW9fY29t
cG9uZW50X2dldF9jZGNsa19mcmVxKHN0cnVjdCBkZXZpY2UgKmtkZXYpCj4gPiAgICAqICAgd2ls
bCBnZXQgdGhlIHJpZ2h0IGludGVsX2VuY29kZXIgd2l0aCBwb3J0IG1hdGNoZWQKPiA+ICAgICog
Tm9uLU1TVCAmIChwaXBlIDwgMCk6IGdldCB0aGUgcmlnaHQgaW50ZWxfZW5jb2RlciB3aXRoIHBv
cnQgbWF0Y2hlZAo+ID4gICAgKi8KPiA+IC1zdGF0aWMgc3RydWN0IGludGVsX2VuY29kZXIgKmdl
dF9zYXZlZF9lbmMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRp
YyBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZ2V0X3NhdmVkX2VuYyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICAgICAgaW50IHBvcnQsIGludCBwaXBlKQo+ID4gICB7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPiA+ICAgCS8qIE1TVCAqLwo+
ID4gICAJaWYgKHBpcGUgPj0gMCkgewo+ID4gLQkJaWYgKFdBUk5fT04ocGlwZSA+PSBBUlJBWV9T
SVpFKGRldl9wcml2LT5hdl9lbmNfbWFwKSkpCj4gPiArCQlpZiAoV0FSTl9PTihwaXBlID49IEFS
UkFZX1NJWkUoaTkxNS0+YXZfZW5jX21hcCkpKQo+ID4gICAJCQlyZXR1cm4gTlVMTDsKPiA+IC0J
CWVuY29kZXIgPSBkZXZfcHJpdi0+YXZfZW5jX21hcFtwaXBlXTsKPiA+ICsJCWVuY29kZXIgPSBp
OTE1LT5hdl9lbmNfbWFwW3BpcGVdOwo+ID4gICAJCS8qCj4gPiAgIAkJICogd2hlbiBib290dXAs
IGF1ZGlvIGRyaXZlciBtYXkgbm90IGtub3cgaXQgaXMKPiA+ICAgCQkgKiBNU1Qgb3Igbm90LiBT
byBpdCB3aWxsIHBvbGwgYWxsIHRoZSBwb3J0ICYgcGlwZQo+ID4gQEAgLTg5Myw4ICs4OTMsOCBA
QCBzdGF0aWMgc3RydWN0IGludGVsX2VuY29kZXIgKmdldF9zYXZlZF9lbmMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJaWYgKHBpcGUgPiAwKQo+ID4gICAJCXJldHVy
biBOVUxMOwo+ID4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gPiAtCQllbmNv
ZGVyID0gZGV2X3ByaXYtPmF2X2VuY19tYXBbcGlwZV07Cj4gPiArCWZvcl9lYWNoX3BpcGUoaTkx
NSwgcGlwZSkgewo+ID4gKwkJZW5jb2RlciA9IGk5MTUtPmF2X2VuY19tYXBbcGlwZV07Cj4gPiAg
IAkJaWYgKGVuY29kZXIgPT0gTlVMTCkKPiA+ICAgCQkJY29udGludWU7Cj4gPiBAQCAtOTExLDIx
ICs5MTEsMjEgQEAgc3RhdGljIHN0cnVjdCBpbnRlbF9lbmNvZGVyICpnZXRfc2F2ZWRfZW5jKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgc3RhdGljIGludCBpOTE1X2F1
ZGlvX2NvbXBvbmVudF9zeW5jX2F1ZGlvX3JhdGUoc3RydWN0IGRldmljZSAqa2RldiwgaW50IHBv
cnQsCj4gPiAgIAkJCQkJCWludCBwaXBlLCBpbnQgcmF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X3RvX2k5MTUoa2Rldik7Cj4gPiAtCXN0
cnVjdCBpOTE1X2F1ZGlvX2NvbXBvbmVudCAqYWNvbXAgPSBkZXZfcHJpdi0+YXVkaW9fY29tcG9u
ZW50Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGtkZXZfdG9faTkxNShr
ZGV2KTsKPiA+ICsJc3RydWN0IGk5MTVfYXVkaW9fY29tcG9uZW50ICphY29tcCA9IGk5MTUtPmF1
ZGlvX2NvbXBvbmVudDsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ID4g
ICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIGNvb2tpZTsK
PiA+ICAgCWludCBlcnIgPSAwOwo+ID4gLQlpZiAoIUhBU19EREkoZGV2X3ByaXYpKQo+ID4gKwlp
ZiAoIUhBU19EREkoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAgIAljb29raWUgPSBpOTE1
X2F1ZGlvX2NvbXBvbmVudF9nZXRfcG93ZXIoa2Rldik7Cj4gPiAtCW11dGV4X2xvY2soJmRldl9w
cml2LT5hdl9tdXRleCk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmF2X211dGV4KTsKPiA+ICAg
CS8qIDEuIGdldCB0aGUgcGlwZSAqLwo+ID4gLQllbmNvZGVyID0gZ2V0X3NhdmVkX2VuYyhkZXZf
cHJpdiwgcG9ydCwgcGlwZSk7Cj4gPiArCWVuY29kZXIgPSBnZXRfc2F2ZWRfZW5jKGk5MTUsIHBv
cnQsIHBpcGUpOwo+ID4gICAJaWYgKCFlbmNvZGVyIHx8ICFlbmNvZGVyLT5iYXNlLmNydGMpIHsK
PiA+ICAgCQlEUk1fREVCVUdfS01TKCJOb3QgdmFsaWQgZm9yIHBvcnQgJWNcbiIsIHBvcnRfbmFt
ZShwb3J0KSk7Cj4gPiAgIAkJZXJyID0gLUVOT0RFVjsKPiA+IEBAIC05NDAsNyArOTQwLDcgQEAg
c3RhdGljIGludCBpOTE1X2F1ZGlvX2NvbXBvbmVudF9zeW5jX2F1ZGlvX3JhdGUoc3RydWN0IGRl
dmljZSAqa2RldiwgaW50IHBvcnQsCj4gPiAgIAloc3dfYXVkaW9fY29uZmlnX3VwZGF0ZShlbmNv
ZGVyLCBjcnRjLT5jb25maWcpOwo+ID4gICAgdW5sb2NrOgo+ID4gLQltdXRleF91bmxvY2soJmRl
dl9wcml2LT5hdl9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+YXZfbXV0ZXgpOwo+
ID4gICAJaTkxNV9hdWRpb19jb21wb25lbnRfcHV0X3Bvd2VyKGtkZXYsIGNvb2tpZSk7Cj4gPiAg
IAlyZXR1cm4gZXJyOwo+ID4gICB9Cj4gPiBAQCAtOTQ5LDE3ICs5NDksMTcgQEAgc3RhdGljIGlu
dCBpOTE1X2F1ZGlvX2NvbXBvbmVudF9nZXRfZWxkKHN0cnVjdCBkZXZpY2UgKmtkZXYsIGludCBw
b3J0LAo+ID4gICAJCQkJCWludCBwaXBlLCBib29sICplbmFibGVkLAo+ID4gICAJCQkJCXVuc2ln
bmVkIGNoYXIgKmJ1ZiwgaW50IG1heF9ieXRlcykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X3RvX2k5MTUoa2Rldik7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl90b19pOTE1KGtkZXYpOwo+ID4gICAJc3RydWN0
IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXI7Cj4gPiAgIAljb25zdCB1OCAqZWxkOwo+ID4g
ICAJaW50IHJldCA9IC1FSU5WQUw7Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5hdl9tdXRl
eCk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmF2X211dGV4KTsKPiA+IC0JaW50ZWxfZW5jb2Rl
ciA9IGdldF9zYXZlZF9lbmMoZGV2X3ByaXYsIHBvcnQsIHBpcGUpOwo+ID4gKwlpbnRlbF9lbmNv
ZGVyID0gZ2V0X3NhdmVkX2VuYyhpOTE1LCBwb3J0LCBwaXBlKTsKPiA+ICAgCWlmICghaW50ZWxf
ZW5jb2Rlcikgewo+ID4gICAJCURSTV9ERUJVR19LTVMoIk5vdCB2YWxpZCBmb3IgcG9ydCAlY1xu
IiwgcG9ydF9uYW1lKHBvcnQpKTsKPiA+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmF2X211
dGV4KTsKPiA+ICsJCW11dGV4X3VubG9jaygmaTkxNS0+YXZfbXV0ZXgpOwo+ID4gICAJCXJldHVy
biByZXQ7Cj4gPiAgIAl9Cj4gPiBAQCAtOTcxLDcgKzk3MSw3IEBAIHN0YXRpYyBpbnQgaTkxNV9h
dWRpb19jb21wb25lbnRfZ2V0X2VsZChzdHJ1Y3QgZGV2aWNlICprZGV2LCBpbnQgcG9ydCwKPiA+
ICAgCQltZW1jcHkoYnVmLCBlbGQsIG1pbihtYXhfYnl0ZXMsIHJldCkpOwo+ID4gICAJfQo+ID4g
LQltdXRleF91bmxvY2soJmRldl9wcml2LT5hdl9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygm
aTkxNS0+YXZfbXV0ZXgpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTk4OSw3
ICs5ODksNyBAQCBzdGF0aWMgaW50IGk5MTVfYXVkaW9fY29tcG9uZW50X2JpbmQoc3RydWN0IGRl
dmljZSAqaTkxNV9rZGV2LAo+ID4gICAJCQkJICAgICBzdHJ1Y3QgZGV2aWNlICpoZGFfa2Rldiwg
dm9pZCAqZGF0YSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGk5MTVfYXVkaW9fY29tcG9uZW50ICph
Y29tcCA9IGRhdGE7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtk
ZXZfdG9faTkxNShpOTE1X2tkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IGtkZXZfdG9faTkxNShpOTE1X2tkZXYpOwo+ID4gICAJaW50IGk7Cj4gPiAgIAlpZiAoV0FS
Tl9PTihhY29tcC0+YmFzZS5vcHMgfHwgYWNvbXAtPmJhc2UuZGV2KSkKPiA+IEBAIC05OTgsMTQg
Kzk5OCwxNCBAQCBzdGF0aWMgaW50IGk5MTVfYXVkaW9fY29tcG9uZW50X2JpbmQoc3RydWN0IGRl
dmljZSAqaTkxNV9rZGV2LAo+ID4gICAJaWYgKFdBUk5fT04oIWRldmljZV9saW5rX2FkZChoZGFf
a2RldiwgaTkxNV9rZGV2LCBETF9GTEFHX1NUQVRFTEVTUykpKQo+ID4gICAJCXJldHVybiAtRU5P
TUVNOwo+ID4gLQlkcm1fbW9kZXNldF9sb2NrX2FsbCgmZGV2X3ByaXYtPmRybSk7Cj4gPiArCWRy
bV9tb2Rlc2V0X2xvY2tfYWxsKCZpOTE1LT5kcm0pOwo+ID4gICAJYWNvbXAtPmJhc2Uub3BzID0g
Jmk5MTVfYXVkaW9fY29tcG9uZW50X29wczsKPiA+ICAgCWFjb21wLT5iYXNlLmRldiA9IGk5MTVf
a2RldjsKPiA+ICAgCUJVSUxEX0JVR19PTihNQVhfUE9SVFMgIT0gSTkxNV9NQVhfUE9SVFMpOwo+
ID4gICAJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoYWNvbXAtPmF1ZF9zYW1wbGVfcmF0ZSk7
IGkrKykKPiA+ICAgCQlhY29tcC0+YXVkX3NhbXBsZV9yYXRlW2ldID0gMDsKPiA+IC0JZGV2X3By
aXYtPmF1ZGlvX2NvbXBvbmVudCA9IGFjb21wOwo+ID4gLQlkcm1fbW9kZXNldF91bmxvY2tfYWxs
KCZkZXZfcHJpdi0+ZHJtKTsKPiA+ICsJaTkxNS0+YXVkaW9fY29tcG9uZW50ID0gYWNvbXA7Cj4g
PiArCWRybV9tb2Rlc2V0X3VubG9ja19hbGwoJmk5MTUtPmRybSk7Cj4gPiAgIAlyZXR1cm4gMDsK
PiA+ICAgfQo+ID4gQEAgLTEwMTQsMTMgKzEwMTQsMTMgQEAgc3RhdGljIHZvaWQgaTkxNV9hdWRp
b19jb21wb25lbnRfdW5iaW5kKHN0cnVjdCBkZXZpY2UgKmk5MTVfa2RldiwKPiA+ICAgCQkJCQlz
dHJ1Y3QgZGV2aWNlICpoZGFfa2Rldiwgdm9pZCAqZGF0YSkKPiA+ICAgewo+ID4gICAJc3RydWN0
IGk5MTVfYXVkaW9fY29tcG9uZW50ICphY29tcCA9IGRhdGE7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfdG9faTkxNShpOTE1X2tkZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGtkZXZfdG9faTkxNShpOTE1X2tkZXYpOwo+ID4g
LQlkcm1fbW9kZXNldF9sb2NrX2FsbCgmZGV2X3ByaXYtPmRybSk7Cj4gPiArCWRybV9tb2Rlc2V0
X2xvY2tfYWxsKCZpOTE1LT5kcm0pOwo+ID4gICAJYWNvbXAtPmJhc2Uub3BzID0gTlVMTDsKPiA+
ICAgCWFjb21wLT5iYXNlLmRldiA9IE5VTEw7Cj4gPiAtCWRldl9wcml2LT5hdWRpb19jb21wb25l
bnQgPSBOVUxMOwo+ID4gLQlkcm1fbW9kZXNldF91bmxvY2tfYWxsKCZkZXZfcHJpdi0+ZHJtKTsK
PiA+ICsJaTkxNS0+YXVkaW9fY29tcG9uZW50ID0gTlVMTDsKPiA+ICsJZHJtX21vZGVzZXRfdW5s
b2NrX2FsbCgmaTkxNS0+ZHJtKTsKPiA+ICAgCWRldmljZV9saW5rX3JlbW92ZShoZGFfa2Rldiwg
aTkxNV9rZGV2KTsKPiA+ICAgfQo+ID4gQEAgLTEwMzIsNyArMTAzMiw3IEBAIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgY29tcG9uZW50X29wcyBpOTE1X2F1ZGlvX2NvbXBvbmVudF9iaW5kX29wcyA9IHsK
PiA+ICAgLyoqCj4gPiAgICAqIGk5MTVfYXVkaW9fY29tcG9uZW50X2luaXQgLSBpbml0aWFsaXpl
IGFuZCByZWdpc3RlciB0aGUgYXVkaW8gY29tcG9uZW50Cj4gPiAtICogQGRldl9wcml2OiBpOTE1
IGRldmljZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4g
ICAgKgo+ID4gICAgKiBUaGlzIHdpbGwgcmVnaXN0ZXIgd2l0aCB0aGUgY29tcG9uZW50IGZyYW1l
d29yayBhIGNoaWxkIGNvbXBvbmVudCB3aGljaAo+ID4gICAgKiB3aWxsIGJpbmQgZHluYW1pY2Fs
bHkgdG8gdGhlIHNuZF9oZGFfaW50ZWwgZHJpdmVyJ3MgY29ycmVzcG9uZGluZyBtYXN0ZXIKPiA+
IEBAIC0xMDQ2LDExICsxMDQ2LDExIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY29tcG9uZW50X29w
cyBpOTE1X2F1ZGlvX2NvbXBvbmVudF9iaW5kX29wcyA9IHsKPiA+ICAgICogV2UgaWdub3JlIGFu
eSBlcnJvciBkdXJpbmcgcmVnaXN0cmF0aW9uIGFuZCBjb250aW51ZSB3aXRoIHJlZHVjZWQKPiA+
ICAgICogZnVuY3Rpb25hbGl0eSAoaS5lLiB3aXRob3V0IEhETUkgYXVkaW8pLgo+ID4gICAgKi8K
PiA+IC1zdGF0aWMgdm9pZCBpOTE1X2F1ZGlvX2NvbXBvbmVudF9pbml0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpOTE1X2F1ZGlvX2NvbXBvbmVu
dF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlpbnQg
cmV0Owo+ID4gLQlyZXQgPSBjb21wb25lbnRfYWRkX3R5cGVkKGRldl9wcml2LT5kcm0uZGV2LAo+
ID4gKwlyZXQgPSBjb21wb25lbnRfYWRkX3R5cGVkKGk5MTUtPmRybS5kZXYsCj4gPiAgIAkJCQkg
ICZpOTE1X2F1ZGlvX2NvbXBvbmVudF9iaW5kX29wcywKPiA+ICAgCQkJCSAgSTkxNV9DT01QT05F
TlRfQVVESU8pOwo+ID4gICAJaWYgKHJldCA8IDApIHsKPiA+IEBAIC0xMDU5LDQ2ICsxMDU5LDQ2
IEBAIHN0YXRpYyB2b2lkIGk5MTVfYXVkaW9fY29tcG9uZW50X2luaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0JZGV2X3By
aXYtPmF1ZGlvX2NvbXBvbmVudF9yZWdpc3RlcmVkID0gdHJ1ZTsKPiA+ICsJaTkxNS0+YXVkaW9f
Y29tcG9uZW50X3JlZ2lzdGVyZWQgPSB0cnVlOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBp
OTE1X2F1ZGlvX2NvbXBvbmVudF9jbGVhbnVwIC0gZGVyZWdpc3RlciB0aGUgYXVkaW8gY29tcG9u
ZW50Cj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1
OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gICAgKgo+ID4gICAgKiBEZXJlZ2lzdGVycyB0aGUg
YXVkaW8gY29tcG9uZW50LCBicmVha2luZyBhbnkgZXhpc3RpbmcgYmluZGluZyB0byB0aGUKPiA+
ICAgICogY29ycmVzcG9uZGluZyBzbmRfaGRhX2ludGVsIGRyaXZlcidzIG1hc3RlciBjb21wb25l
bnQuCj4gPiAgICAqLwo+ID4gLXN0YXRpYyB2b2lkIGk5MTVfYXVkaW9fY29tcG9uZW50X2NsZWFu
dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGk5
MTVfYXVkaW9fY29tcG9uZW50X2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+IC0JaWYgKCFkZXZfcHJpdi0+YXVkaW9fY29tcG9uZW50X3JlZ2lzdGVyZWQp
Cj4gPiArCWlmICghaTkxNS0+YXVkaW9fY29tcG9uZW50X3JlZ2lzdGVyZWQpCj4gPiAgIAkJcmV0
dXJuOwo+ID4gLQljb21wb25lbnRfZGVsKGRldl9wcml2LT5kcm0uZGV2LCAmaTkxNV9hdWRpb19j
b21wb25lbnRfYmluZF9vcHMpOwo+ID4gLQlkZXZfcHJpdi0+YXVkaW9fY29tcG9uZW50X3JlZ2lz
dGVyZWQgPSBmYWxzZTsKPiA+ICsJY29tcG9uZW50X2RlbChpOTE1LT5kcm0uZGV2LCAmaTkxNV9h
dWRpb19jb21wb25lbnRfYmluZF9vcHMpOwo+ID4gKwlpOTE1LT5hdWRpb19jb21wb25lbnRfcmVn
aXN0ZXJlZCA9IGZhbHNlOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9hdWRpb19p
bml0KCkgLSBJbml0aWFsaXplIHRoZSBhdWRpbyBkcml2ZXIgZWl0aGVyIHVzaW5nCj4gPiAgICAq
IGNvbXBvbmVudCBmcmFtZXdvcmsgb3IgdXNpbmcgbHBlIGF1ZGlvIGJyaWRnZQo+ID4gLSAqIEBk
ZXZfcHJpdjogdGhlIGk5MTUgZHJtIGRldmljZSBwcml2YXRlIGRhdGEKPiA+ICsgKiBAaTkxNTog
dGhlIGk5MTUgZHJtIGRldmljZSBwcml2YXRlIGRhdGEKPiA+ICAgICoKPiA+ICAgICovCj4gPiAt
dm9pZCBpbnRlbF9hdWRpb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICt2b2lkIGludGVsX2F1ZGlvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+IC0JaWYgKGludGVsX2xwZV9hdWRpb19pbml0KGRldl9wcml2KSA8IDApCj4g
PiAtCQlpOTE1X2F1ZGlvX2NvbXBvbmVudF9pbml0KGRldl9wcml2KTsKPiA+ICsJaWYgKGludGVs
X2xwZV9hdWRpb19pbml0KGk5MTUpIDwgMCkKPiA+ICsJCWk5MTVfYXVkaW9fY29tcG9uZW50X2lu
aXQoaTkxNSk7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2F1ZGlvX2RlaW5pdCgp
IC0gZGVpbml0aWFsaXplIHRoZSBhdWRpbyBkcml2ZXIKPiA+IC0gKiBAZGV2X3ByaXY6IHRoZSBp
OTE1IGRybSBkZXZpY2UgcHJpdmF0ZSBkYXRhCj4gPiArICogQGk5MTU6IHRoZSBpOTE1IGRybSBk
ZXZpY2UgcHJpdmF0ZSBkYXRhCj4gPiAgICAqCj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfYXVk
aW9fZGVpbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGlu
dGVsX2F1ZGlvX2RlaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+
ID4gLQlpZiAoKGRldl9wcml2KS0+bHBlX2F1ZGlvLnBsYXRkZXYgIT0gTlVMTCkKPiA+IC0JCWlu
dGVsX2xwZV9hdWRpb190ZWFyZG93bihkZXZfcHJpdik7Cj4gPiArCWlmICgoaTkxNSktPmxwZV9h
dWRpby5wbGF0ZGV2ICE9IE5VTEwpCj4gPiArCQlpbnRlbF9scGVfYXVkaW9fdGVhcmRvd24oaTkx
NSk7Cj4gPiAgIAllbHNlCj4gPiAtCQlpOTE1X2F1ZGlvX2NvbXBvbmVudF9jbGVhbnVwKGRldl9w
cml2KTsKPiA+ICsJCWk5MTVfYXVkaW9fY29tcG9uZW50X2NsZWFudXAoaTkxNSk7Cj4gPiAgIH0K
PiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9hdWRpby5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYXVkaW8uaAo+ID4gaW5kZXggYTM2NTdjN2E3YmEyLi5j
OGZkZTQyYTlmZGUgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9h
dWRpby5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9hdWRpby5oCj4gPiBA
QCAtMTEsMTQgKzExLDE0IEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwo+ID4gICBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZTsKPiA+ICAgc3RydWN0IGludGVsX2VuY29kZXI7Cj4gPiAtdm9pZCBp
bnRlbF9pbml0X2F1ZGlvX2hvb2tzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cj4gPiArdm9pZCBpbnRlbF9pbml0X2F1ZGlvX2hvb2tzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KTsKPiA+ICAgdm9pZCBpbnRlbF9hdWRpb19jb2RlY19lbmFibGUoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSk7Cj4gPiAgIHZvaWQgaW50ZWxfYXVkaW9fY29kZWNfZGlz
YWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgICAgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiA+ICAgCQkJICAgICAg
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSk7Cj4gPiAt
dm9pZCBpbnRlbF9hdWRpb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cj4gPiAtdm9pZCBpbnRlbF9hdWRpb19kZWluaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKPiA+ICt2b2lkIGludGVsX2F1ZGlvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfYXVkaW9fZGVpbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KTsKPiA+ICAgI2VuZGlmIC8qIF9fSU5URUxfQVVESU9fSF9fICovCj4gPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYmlvcy5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfYmlvcy5jCj4gPiBpbmRleCAxYzAzN2RmYTgzZjUuLjdiZGFjNTVk
MDhjYyAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Jpb3MuYwo+
ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYmlvcy5jCj4gPiBAQCAtMjAyLDcg
KzIwMiw3IEBAIGdldF9sdmRzX2ZwX3RpbWluZyhjb25zdCBzdHJ1Y3QgYmRiX2hlYWRlciAqYmRi
LAo+ID4gICAvKiBUcnkgdG8gZmluZCBpbnRlZ3JhdGVkIHBhbmVsIGRhdGEgKi8KPiA+ICAgc3Rh
dGljIHZvaWQKPiA+IC1wYXJzZV9sZnBfcGFuZWxfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiArcGFyc2VfbGZwX3BhbmVsX2RhdGEoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICBjb25zdCBzdHJ1Y3QgYmRiX2hlYWRlciAqYmRiKQo+
ID4gICB7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgYmRiX2x2ZHNfb3B0aW9ucyAqbHZkc19vcHRpb25z
Owo+ID4gQEAgLTIxOSw5ICsyMTksOSBAQCBwYXJzZV9sZnBfcGFuZWxfZGF0YShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlpZiAoIWx2ZHNfb3B0aW9ucykKPiA+ICAg
CQlyZXR1cm47Cj4gPiAtCWRldl9wcml2LT52YnQubHZkc19kaXRoZXIgPSBsdmRzX29wdGlvbnMt
PnBpeGVsX2RpdGhlcjsKPiA+ICsJaTkxNS0+dmJ0Lmx2ZHNfZGl0aGVyID0gbHZkc19vcHRpb25z
LT5waXhlbF9kaXRoZXI7Cj4gPiAtCXJldCA9IGludGVsX29wcmVnaW9uX2dldF9wYW5lbF90eXBl
KGRldl9wcml2KTsKPiA+ICsJcmV0ID0gaW50ZWxfb3ByZWdpb25fZ2V0X3BhbmVsX3R5cGUoaTkx
NSk7Cj4gPiAgIAlpZiAocmV0ID49IDApIHsKPiA+ICAgCQlXQVJOX09OKHJldCA+IDB4Zik7Cj4g
PiAgIAkJcGFuZWxfdHlwZSA9IHJldDsKPiA+IEBAIC0yMzYsNyArMjM2LDcgQEAgcGFyc2VfbGZw
X3BhbmVsX2RhdGEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCURS
TV9ERUJVR19LTVMoIlBhbmVsIHR5cGU6ICVkIChWQlQpXG4iLCBwYW5lbF90eXBlKTsKPiA+ICAg
CX0KPiA+IC0JZGV2X3ByaXYtPnZidC5wYW5lbF90eXBlID0gcGFuZWxfdHlwZTsKPiA+ICsJaTkx
NS0+dmJ0LnBhbmVsX3R5cGUgPSBwYW5lbF90eXBlOwo+ID4gICAJZHJyc19tb2RlID0gKGx2ZHNf
b3B0aW9ucy0+ZHBzX3BhbmVsX3R5cGVfYml0cwo+ID4gICAJCQkJPj4gKHBhbmVsX3R5cGUgKiAy
KSkgJiBNT0RFX01BU0s7Cj4gPiBAQCAtMjQ3LDE1ICsyNDcsMTUgQEAgcGFyc2VfbGZwX3BhbmVs
X2RhdGEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJICovCj4gPiAg
IAlzd2l0Y2ggKGRycnNfbW9kZSkgewo+ID4gICAJY2FzZSAwOgo+ID4gLQkJZGV2X3ByaXYtPnZi
dC5kcnJzX3R5cGUgPSBTVEFUSUNfRFJSU19TVVBQT1JUOwo+ID4gKwkJaTkxNS0+dmJ0LmRycnNf
dHlwZSA9IFNUQVRJQ19EUlJTX1NVUFBPUlQ7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiRFJSUyBz
dXBwb3J0ZWQgbW9kZSBpcyBzdGF0aWNcbiIpOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSAy
Ogo+ID4gLQkJZGV2X3ByaXYtPnZidC5kcnJzX3R5cGUgPSBTRUFNTEVTU19EUlJTX1NVUFBPUlQ7
Cj4gPiArCQlpOTE1LT52YnQuZHJyc190eXBlID0gU0VBTUxFU1NfRFJSU19TVVBQT1JUOwo+ID4g
ICAJCURSTV9ERUJVR19LTVMoIkRSUlMgc3VwcG9ydGVkIG1vZGUgaXMgc2VhbWxlc3NcbiIpOwo+
ID4gICAJCWJyZWFrOwo+ID4gICAJZGVmYXVsdDoKPiA+IC0JCWRldl9wcml2LT52YnQuZHJyc190
eXBlID0gRFJSU19OT1RfU1VQUE9SVEVEOwo+ID4gKwkJaTkxNS0+dmJ0LmRycnNfdHlwZSA9IERS
UlNfTk9UX1NVUFBPUlRFRDsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJEUlJTIG5vdCBzdXBwb3J0
ZWQgKFZCVCBpbnB1dClcbiIpOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJfQo+ID4gQEAgLTI3OCw3
ICsyNzgsNyBAQCBwYXJzZV9sZnBfcGFuZWxfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiAgIAlmaWxsX2RldGFpbF90aW1pbmdfZGF0YShwYW5lbF9maXhlZF9tb2Rl
LCBwYW5lbF9kdm9fdGltaW5nKTsKPiA+IC0JZGV2X3ByaXYtPnZidC5sZnBfbHZkc192YnRfbW9k
ZSA9IHBhbmVsX2ZpeGVkX21vZGU7Cj4gPiArCWk5MTUtPnZidC5sZnBfbHZkc192YnRfbW9kZSA9
IHBhbmVsX2ZpeGVkX21vZGU7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJGb3VuZCBwYW5lbCBtb2Rl
IGluIEJJT1MgVkJUIHRhYmxlczpcbiIpOwo+ID4gICAJZHJtX21vZGVfZGVidWdfcHJpbnRtb2Rl
bGluZShwYW5lbF9maXhlZF9tb2RlKTsKPiA+IEBAIC0yOTAsMjAgKzI5MCwyMCBAQCBwYXJzZV9s
ZnBfcGFuZWxfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJ
LyogY2hlY2sgdGhlIHJlc29sdXRpb24sIGp1c3QgdG8gYmUgc3VyZSAqLwo+ID4gICAJCWlmIChm
cF90aW1pbmctPnhfcmVzID09IHBhbmVsX2ZpeGVkX21vZGUtPmhkaXNwbGF5ICYmCj4gPiAgIAkJ
ICAgIGZwX3RpbWluZy0+eV9yZXMgPT0gcGFuZWxfZml4ZWRfbW9kZS0+dmRpc3BsYXkpIHsKPiA+
IC0JCQlkZXZfcHJpdi0+dmJ0LmJpb3NfbHZkc192YWwgPSBmcF90aW1pbmctPmx2ZHNfcmVnX3Zh
bDsKPiA+ICsJCQlpOTE1LT52YnQuYmlvc19sdmRzX3ZhbCA9IGZwX3RpbWluZy0+bHZkc19yZWdf
dmFsOwo+ID4gICAJCQlEUk1fREVCVUdfS01TKCJWQlQgaW5pdGlhbCBMVkRTIHZhbHVlICV4XG4i
LAo+ID4gLQkJCQkgICAgICBkZXZfcHJpdi0+dmJ0LmJpb3NfbHZkc192YWwpOwo+ID4gKwkJCQkg
ICAgICBpOTE1LT52YnQuYmlvc19sdmRzX3ZhbCk7Cj4gPiAgIAkJfQo+ID4gICAJfQo+ID4gICB9
Cj4gPiAgIHN0YXRpYyB2b2lkCj4gPiAtcGFyc2VfbGZwX2JhY2tsaWdodChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArcGFyc2VfbGZwX2JhY2tsaWdodChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkgICAgY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIg
KmJkYikKPiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0IGJkYl9sZnBfYmFja2xpZ2h0X2RhdGEg
KmJhY2tsaWdodF9kYXRhOwo+ID4gICAJY29uc3Qgc3RydWN0IGxmcF9iYWNrbGlnaHRfZGF0YV9l
bnRyeSAqZW50cnk7Cj4gPiAtCWludCBwYW5lbF90eXBlID0gZGV2X3ByaXYtPnZidC5wYW5lbF90
eXBlOwo+ID4gKwlpbnQgcGFuZWxfdHlwZSA9IGk5MTUtPnZidC5wYW5lbF90eXBlOwo+ID4gICAJ
YmFja2xpZ2h0X2RhdGEgPSBmaW5kX3NlY3Rpb24oYmRiLCBCREJfTFZEU19CQUNLTElHSFQpOwo+
ID4gICAJaWYgKCFiYWNrbGlnaHRfZGF0YSkKPiA+IEBAIC0zMTcsMzggKzMxNywzOCBAQCBwYXJz
ZV9sZnBfYmFja2xpZ2h0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAg
CWVudHJ5ID0gJmJhY2tsaWdodF9kYXRhLT5kYXRhW3BhbmVsX3R5cGVdOwo+ID4gLQlkZXZfcHJp
di0+dmJ0LmJhY2tsaWdodC5wcmVzZW50ID0gZW50cnktPnR5cGUgPT0gQkRCX0JBQ0tMSUdIVF9U
WVBFX1BXTTsKPiA+IC0JaWYgKCFkZXZfcHJpdi0+dmJ0LmJhY2tsaWdodC5wcmVzZW50KSB7Cj4g
PiArCWk5MTUtPnZidC5iYWNrbGlnaHQucHJlc2VudCA9IGVudHJ5LT50eXBlID09IEJEQl9CQUNL
TElHSFRfVFlQRV9QV007Cj4gPiArCWlmICghaTkxNS0+dmJ0LmJhY2tsaWdodC5wcmVzZW50KSB7
Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiUFdNIGJhY2tsaWdodCBub3QgcHJlc2VudCBpbiBWQlQg
KHR5cGUgJXUpXG4iLAo+ID4gICAJCQkgICAgICBlbnRyeS0+dHlwZSk7Cj4gPiAgIAkJcmV0dXJu
Owo+ID4gICAJfQo+ID4gLQlkZXZfcHJpdi0+dmJ0LmJhY2tsaWdodC50eXBlID0gSU5URUxfQkFD
S0xJR0hUX0RJU1BMQVlfRERJOwo+ID4gKwlpOTE1LT52YnQuYmFja2xpZ2h0LnR5cGUgPSBJTlRF
TF9CQUNLTElHSFRfRElTUExBWV9EREk7Cj4gPiAgIAlpZiAoYmRiLT52ZXJzaW9uID49IDE5MSAm
Jgo+ID4gICAJICAgIGdldF9ibG9ja3NpemUoYmFja2xpZ2h0X2RhdGEpID49IHNpemVvZigqYmFj
a2xpZ2h0X2RhdGEpKSB7Cj4gPiAgIAkJY29uc3Qgc3RydWN0IGxmcF9iYWNrbGlnaHRfY29udHJv
bF9tZXRob2QgKm1ldGhvZDsKPiA+ICAgCQltZXRob2QgPSAmYmFja2xpZ2h0X2RhdGEtPmJhY2ts
aWdodF9jb250cm9sW3BhbmVsX3R5cGVdOwo+ID4gLQkJZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQu
dHlwZSA9IG1ldGhvZC0+dHlwZTsKPiA+IC0JCWRldl9wcml2LT52YnQuYmFja2xpZ2h0LmNvbnRy
b2xsZXIgPSBtZXRob2QtPmNvbnRyb2xsZXI7Cj4gPiArCQlpOTE1LT52YnQuYmFja2xpZ2h0LnR5
cGUgPSBtZXRob2QtPnR5cGU7Cj4gPiArCQlpOTE1LT52YnQuYmFja2xpZ2h0LmNvbnRyb2xsZXIg
PSBtZXRob2QtPmNvbnRyb2xsZXI7Cj4gPiAgIAl9Cj4gPiAtCWRldl9wcml2LT52YnQuYmFja2xp
Z2h0LnB3bV9mcmVxX2h6ID0gZW50cnktPnB3bV9mcmVxX2h6Owo+ID4gLQlkZXZfcHJpdi0+dmJ0
LmJhY2tsaWdodC5hY3RpdmVfbG93X3B3bSA9IGVudHJ5LT5hY3RpdmVfbG93X3B3bTsKPiA+IC0J
ZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQubWluX2JyaWdodG5lc3MgPSBlbnRyeS0+bWluX2JyaWdo
dG5lc3M7Cj4gPiArCWk5MTUtPnZidC5iYWNrbGlnaHQucHdtX2ZyZXFfaHogPSBlbnRyeS0+cHdt
X2ZyZXFfaHo7Cj4gPiArCWk5MTUtPnZidC5iYWNrbGlnaHQuYWN0aXZlX2xvd19wd20gPSBlbnRy
eS0+YWN0aXZlX2xvd19wd207Cj4gPiArCWk5MTUtPnZidC5iYWNrbGlnaHQubWluX2JyaWdodG5l
c3MgPSBlbnRyeS0+bWluX2JyaWdodG5lc3M7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJWQlQgYmFj
a2xpZ2h0IFBXTSBtb2R1bGF0aW9uIGZyZXF1ZW5jeSAldSBIeiwgIgo+ID4gICAJCSAgICAgICJh
Y3RpdmUgJXMsIG1pbiBicmlnaHRuZXNzICV1LCBsZXZlbCAldSwgY29udHJvbGxlciAldVxuIiwK
PiA+IC0JCSAgICAgIGRldl9wcml2LT52YnQuYmFja2xpZ2h0LnB3bV9mcmVxX2h6LAo+ID4gLQkJ
ICAgICAgZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQuYWN0aXZlX2xvd19wd20gPyAibG93IiA6ICJo
aWdoIiwKPiA+IC0JCSAgICAgIGRldl9wcml2LT52YnQuYmFja2xpZ2h0Lm1pbl9icmlnaHRuZXNz
LAo+ID4gKwkJICAgICAgaTkxNS0+dmJ0LmJhY2tsaWdodC5wd21fZnJlcV9oeiwKPiA+ICsJCSAg
ICAgIGk5MTUtPnZidC5iYWNrbGlnaHQuYWN0aXZlX2xvd19wd20gPyAibG93IiA6ICJoaWdoIiwK
PiA+ICsJCSAgICAgIGk5MTUtPnZidC5iYWNrbGlnaHQubWluX2JyaWdodG5lc3MsCj4gPiAgIAkJ
ICAgICAgYmFja2xpZ2h0X2RhdGEtPmxldmVsW3BhbmVsX3R5cGVdLAo+ID4gLQkJICAgICAgZGV2
X3ByaXYtPnZidC5iYWNrbGlnaHQuY29udHJvbGxlcik7Cj4gPiArCQkgICAgICBpOTE1LT52YnQu
YmFja2xpZ2h0LmNvbnRyb2xsZXIpOwo+ID4gICB9Cj4gPiAgIC8qIFRyeSB0byBmaW5kIHNkdm8g
cGFuZWwgZGF0YSAqLwo+ID4gICBzdGF0aWMgdm9pZAo+ID4gLXBhcnNlX3Nkdm9fcGFuZWxfZGF0
YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArcGFyc2Vfc2R2b19wYW5l
bF9kYXRhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCSAgICAgIGNvbnN0
IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4gPiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVjdCBiZGJf
c2R2b19wYW5lbF9kdGRzICpkdGRzOwo+ID4gQEAgLTM4MSwxNiArMzgxLDE2IEBAIHBhcnNlX3Nk
dm9fcGFuZWxfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlm
aWxsX2RldGFpbF90aW1pbmdfZGF0YShwYW5lbF9maXhlZF9tb2RlLCAmZHRkcy0+ZHRkc1tpbmRl
eF0pOwo+ID4gLQlkZXZfcHJpdi0+dmJ0LnNkdm9fbHZkc192YnRfbW9kZSA9IHBhbmVsX2ZpeGVk
X21vZGU7Cj4gPiArCWk5MTUtPnZidC5zZHZvX2x2ZHNfdmJ0X21vZGUgPSBwYW5lbF9maXhlZF9t
b2RlOwo+ID4gICAJRFJNX0RFQlVHX0tNUygiRm91bmQgU0RWTyBwYW5lbCBtb2RlIGluIEJJT1Mg
VkJUIHRhYmxlczpcbiIpOwo+ID4gICAJZHJtX21vZGVfZGVidWdfcHJpbnRtb2RlbGluZShwYW5l
bF9maXhlZF9tb2RlKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQgaW50ZWxfYmlvc19zc2NfZnJl
cXVlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW50
IGludGVsX2Jpb3Nfc3NjX2ZyZXF1ZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiA+ICAgCQkJCSAgICBib29sIGFsdGVybmF0ZSkKPiA+ICAgewo+ID4gLQlzd2l0Y2ggKElOVEVM
X0dFTihkZXZfcHJpdikpIHsKPiA+ICsJc3dpdGNoIChJTlRFTF9HRU4oaTkxNSkpIHsKPiA+ICAg
CWNhc2UgMjoKPiA+ICAgCQlyZXR1cm4gYWx0ZXJuYXRlID8gNjY2NjcgOiA0ODAwMDsKPiA+ICAg
CWNhc2UgMzoKPiA+IEBAIC00MDIsNyArNDAyLDcgQEAgc3RhdGljIGludCBpbnRlbF9iaW9zX3Nz
Y19mcmVxdWVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICB9Cj4g
PiAgIHN0YXRpYyB2b2lkCj4gPiAtcGFyc2VfZ2VuZXJhbF9mZWF0dXJlcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArcGFyc2VfZ2VuZXJhbF9mZWF0dXJlcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkgICAgICAgY29uc3Qgc3RydWN0IGJkYl9o
ZWFkZXIgKmJkYikKPiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0IGJkYl9nZW5lcmFsX2ZlYXR1
cmVzICpnZW5lcmFsOwo+ID4gQEAgLTQxMSwzMCArNDExLDMwIEBAIHBhcnNlX2dlbmVyYWxfZmVh
dHVyZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJaWYgKCFnZW5l
cmFsKQo+ID4gICAJCXJldHVybjsKPiA+IC0JZGV2X3ByaXYtPnZidC5pbnRfdHZfc3VwcG9ydCA9
IGdlbmVyYWwtPmludF90dl9zdXBwb3J0Owo+ID4gKwlpOTE1LT52YnQuaW50X3R2X3N1cHBvcnQg
PSBnZW5lcmFsLT5pbnRfdHZfc3VwcG9ydDsKPiA+ICAgCS8qIGludF9jcnRfc3VwcG9ydCBjYW4n
dCBiZSB0cnVzdGVkIG9uIGVhcmxpZXIgcGxhdGZvcm1zICovCj4gPiAgIAlpZiAoYmRiLT52ZXJz
aW9uID49IDE1NSAmJgo+ID4gLQkgICAgKEhBU19EREkoZGV2X3ByaXYpIHx8IElTX1ZBTExFWVZJ
RVcoZGV2X3ByaXYpKSkKPiA+IC0JCWRldl9wcml2LT52YnQuaW50X2NydF9zdXBwb3J0ID0gZ2Vu
ZXJhbC0+aW50X2NydF9zdXBwb3J0Owo+ID4gLQlkZXZfcHJpdi0+dmJ0Lmx2ZHNfdXNlX3NzYyA9
IGdlbmVyYWwtPmVuYWJsZV9zc2M7Cj4gPiAtCWRldl9wcml2LT52YnQubHZkc19zc2NfZnJlcSA9
Cj4gPiAtCQlpbnRlbF9iaW9zX3NzY19mcmVxdWVuY3koZGV2X3ByaXYsIGdlbmVyYWwtPnNzY19m
cmVxKTsKPiA+IC0JZGV2X3ByaXYtPnZidC5kaXNwbGF5X2Nsb2NrX21vZGUgPSBnZW5lcmFsLT5k
aXNwbGF5X2Nsb2NrX21vZGU7Cj4gPiAtCWRldl9wcml2LT52YnQuZmRpX3J4X3BvbGFyaXR5X2lu
dmVydGVkID0gZ2VuZXJhbC0+ZmRpX3J4X3BvbGFyaXR5X2ludmVydGVkOwo+ID4gKwkgICAgKEhB
U19EREkoaTkxNSkgfHwgSVNfVkFMTEVZVklFVyhpOTE1KSkpCj4gPiArCQlpOTE1LT52YnQuaW50
X2NydF9zdXBwb3J0ID0gZ2VuZXJhbC0+aW50X2NydF9zdXBwb3J0Owo+ID4gKwlpOTE1LT52YnQu
bHZkc191c2Vfc3NjID0gZ2VuZXJhbC0+ZW5hYmxlX3NzYzsKPiA+ICsJaTkxNS0+dmJ0Lmx2ZHNf
c3NjX2ZyZXEgPQo+ID4gKwkJaW50ZWxfYmlvc19zc2NfZnJlcXVlbmN5KGk5MTUsIGdlbmVyYWwt
PnNzY19mcmVxKTsKPiA+ICsJaTkxNS0+dmJ0LmRpc3BsYXlfY2xvY2tfbW9kZSA9IGdlbmVyYWwt
PmRpc3BsYXlfY2xvY2tfbW9kZTsKPiA+ICsJaTkxNS0+dmJ0LmZkaV9yeF9wb2xhcml0eV9pbnZl
cnRlZCA9IGdlbmVyYWwtPmZkaV9yeF9wb2xhcml0eV9pbnZlcnRlZDsKPiA+ICAgCWlmIChiZGIt
PnZlcnNpb24gPj0gMTgxKSB7Cj4gPiAtCQlkZXZfcHJpdi0+dmJ0Lm9yaWVudGF0aW9uID0gZ2Vu
ZXJhbC0+cm90YXRlXzE4MCA/Cj4gPiArCQlpOTE1LT52YnQub3JpZW50YXRpb24gPSBnZW5lcmFs
LT5yb3RhdGVfMTgwID8KPiA+ICAgCQkJRFJNX01PREVfUEFORUxfT1JJRU5UQVRJT05fQk9UVE9N
X1VQIDoKPiA+ICAgCQkJRFJNX01PREVfUEFORUxfT1JJRU5UQVRJT05fTk9STUFMOwo+ID4gICAJ
fSBlbHNlIHsKPiA+IC0JCWRldl9wcml2LT52YnQub3JpZW50YXRpb24gPSBEUk1fTU9ERV9QQU5F
TF9PUklFTlRBVElPTl9VTktOT1dOOwo+ID4gKwkJaTkxNS0+dmJ0Lm9yaWVudGF0aW9uID0gRFJN
X01PREVfUEFORUxfT1JJRU5UQVRJT05fVU5LTk9XTjsKPiA+ICAgCX0KPiA+ICAgCURSTV9ERUJV
R19LTVMoIkJEQl9HRU5FUkFMX0ZFQVRVUkVTIGludF90dl9zdXBwb3J0ICVkIGludF9jcnRfc3Vw
cG9ydCAlZCBsdmRzX3VzZV9zc2MgJWQgbHZkc19zc2NfZnJlcSAlZCBkaXNwbGF5X2Nsb2NrX21v
ZGUgJWQgZmRpX3J4X3BvbGFyaXR5X2ludmVydGVkICVkXG4iLAo+ID4gLQkJICAgICAgZGV2X3By
aXYtPnZidC5pbnRfdHZfc3VwcG9ydCwKPiA+IC0JCSAgICAgIGRldl9wcml2LT52YnQuaW50X2Ny
dF9zdXBwb3J0LAo+ID4gLQkJICAgICAgZGV2X3ByaXYtPnZidC5sdmRzX3VzZV9zc2MsCj4gPiAt
CQkgICAgICBkZXZfcHJpdi0+dmJ0Lmx2ZHNfc3NjX2ZyZXEsCj4gPiAtCQkgICAgICBkZXZfcHJp
di0+dmJ0LmRpc3BsYXlfY2xvY2tfbW9kZSwKPiA+IC0JCSAgICAgIGRldl9wcml2LT52YnQuZmRp
X3J4X3BvbGFyaXR5X2ludmVydGVkKTsKPiA+ICsJCSAgICAgIGk5MTUtPnZidC5pbnRfdHZfc3Vw
cG9ydCwKPiA+ICsJCSAgICAgIGk5MTUtPnZidC5pbnRfY3J0X3N1cHBvcnQsCj4gPiArCQkgICAg
ICBpOTE1LT52YnQubHZkc191c2Vfc3NjLAo+ID4gKwkJICAgICAgaTkxNS0+dmJ0Lmx2ZHNfc3Nj
X2ZyZXEsCj4gPiArCQkgICAgICBpOTE1LT52YnQuZGlzcGxheV9jbG9ja19tb2RlLAo+ID4gKwkJ
ICAgICAgaTkxNS0+dmJ0LmZkaV9yeF9wb2xhcml0eV9pbnZlcnRlZCk7Cj4gPiAgIH0KPiA+ICAg
c3RhdGljIGNvbnN0IHN0cnVjdCBjaGlsZF9kZXZpY2VfY29uZmlnICoKPiA+IEBAIC00NDQsNyAr
NDQ0LDcgQEAgY2hpbGRfZGV2aWNlX3B0cihjb25zdCBzdHJ1Y3QgYmRiX2dlbmVyYWxfZGVmaW5p
dGlvbnMgKmRlZnMsIGludCBpKQo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkCj4gPiAtcGFyc2Vf
c2R2b19kZXZpY2VfbWFwcGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4
IGJkYl92ZXJzaW9uKQo+ID4gK3BhcnNlX3Nkdm9fZGV2aWNlX21hcHBpbmcoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsIHU4IGJkYl92ZXJzaW9uKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3Qg
c2R2b19kZXZpY2VfbWFwcGluZyAqbWFwcGluZzsKPiA+ICAgCWNvbnN0IHN0cnVjdCBjaGlsZF9k
ZXZpY2VfY29uZmlnICpjaGlsZDsKPiA+IEBAIC00NTQsMTMgKzQ1NCwxMyBAQCBwYXJzZV9zZHZv
X2RldmljZV9tYXBwaW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTggYmRi
X3ZlcnNpb24pCj4gPiAgIAkgKiBPbmx5IHBhcnNlIFNEVk8gbWFwcGluZ3Mgb24gZ2VucyB0aGF0
IGNvdWxkIGhhdmUgU0RWTy4gVGhpcyBpc24ndAo+ID4gICAJICogYWNjdXJhdGUgYW5kIGRvZXNu
J3QgaGF2ZSB0byBiZSwgYXMgbG9uZyBhcyBpdCdzIG5vdCB0b28gc3RyaWN0Lgo+ID4gICAJICov
Cj4gPiAtCWlmICghSVNfR0VOX1JBTkdFKGRldl9wcml2LCAzLCA3KSkgewo+ID4gKwlpZiAoIUlT
X0dFTl9SQU5HRShpOTE1LCAzLCA3KSkgewo+ID4gICAJCURSTV9ERUJVR19LTVMoIlNraXBwaW5n
IFNEVk8gZGV2aWNlIG1hcHBpbmdcbiIpOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0J
Zm9yIChpID0gMCwgY291bnQgPSAwOyBpIDwgZGV2X3ByaXYtPnZidC5jaGlsZF9kZXZfbnVtOyBp
KyspIHsKPiA+IC0JCWNoaWxkID0gZGV2X3ByaXYtPnZidC5jaGlsZF9kZXYgKyBpOwo+ID4gKwlm
b3IgKGkgPSAwLCBjb3VudCA9IDA7IGkgPCBpOTE1LT52YnQuY2hpbGRfZGV2X251bTsgaSsrKSB7
Cj4gPiArCQljaGlsZCA9IGk5MTUtPnZidC5jaGlsZF9kZXYgKyBpOwo+ID4gICAJCWlmIChjaGls
ZC0+c2xhdmVfYWRkciAhPSBTTEFWRV9BRERSMSAmJgo+ID4gICAJCSAgICBjaGlsZC0+c2xhdmVf
YWRkciAhPSBTTEFWRV9BRERSMikgewo+ID4gQEAgLTQ4MSw3ICs0ODEsNyBAQCBwYXJzZV9zZHZv
X2RldmljZV9tYXBwaW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTggYmRi
X3ZlcnNpb24pCj4gPiAgIAkJCSAgICAgIGNoaWxkLT5zbGF2ZV9hZGRyLAo+ID4gICAJCQkgICAg
ICAoY2hpbGQtPmR2b19wb3J0ID09IERFVklDRV9QT1JUX0RWT0IpID8KPiA+ICAgCQkJICAgICAg
IlNEVk9CIiA6ICJTRFZPQyIpOwo+ID4gLQkJbWFwcGluZyA9ICZkZXZfcHJpdi0+dmJ0LnNkdm9f
bWFwcGluZ3NbY2hpbGQtPmR2b19wb3J0IC0gMV07Cj4gPiArCQltYXBwaW5nID0gJmk5MTUtPnZi
dC5zZHZvX21hcHBpbmdzW2NoaWxkLT5kdm9fcG9ydCAtIDFdOwo+ID4gICAJCWlmICghbWFwcGlu
Zy0+aW5pdGlhbGl6ZWQpIHsKPiA+ICAgCQkJbWFwcGluZy0+ZHZvX3BvcnQgPSBjaGlsZC0+ZHZv
X3BvcnQ7Cj4gPiAgIAkJCW1hcHBpbmctPnNsYXZlX2FkZHIgPSBjaGlsZC0+c2xhdmVfYWRkcjsK
PiA+IEBAIC01MTUsNyArNTE1LDcgQEAgcGFyc2Vfc2R2b19kZXZpY2VfbWFwcGluZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IGJkYl92ZXJzaW9uKQo+ID4gICB9Cj4gPiAg
IHN0YXRpYyB2b2lkCj4gPiAtcGFyc2VfZHJpdmVyX2ZlYXR1cmVzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtwYXJzZV9kcml2ZXJfZmVhdHVyZXMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICAgY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIg
KmJkYikKPiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0IGJkYl9kcml2ZXJfZmVhdHVyZXMgKmRy
aXZlcjsKPiA+IEBAIC01MjQsMTQgKzUyNCwxNCBAQCBwYXJzZV9kcml2ZXJfZmVhdHVyZXMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJaWYgKCFkcml2ZXIpCj4gPiAg
IAkJcmV0dXJuOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA1KSB7Cj4gPiArCWlm
IChJTlRFTF9HRU4oaTkxNSkgPj0gNSkgewo+ID4gICAJCS8qCj4gPiAgIAkJICogTm90ZSB0aGF0
IHdlIGNvbnNpZGVyIEJEQl9EUklWRVJfRkVBVFVSRV9JTlRfU0RWT19MVkRTCj4gPiAgIAkJICog
dG8gbWVhbiAiZURQIi4gVGhlIFZCVCBzcGVjIGRvZXNuJ3QgYWdyZWUgd2l0aCB0aGF0Cj4gPiAg
IAkJICogaW50ZXJwcmV0YXRpb24sIGJ1dCByZWFsIHdvcmxkIFZCVHMgc2VlbSB0by4KPiA+ICAg
CQkgKi8KPiA+ICAgCQlpZiAoZHJpdmVyLT5sdmRzX2NvbmZpZyAhPSBCREJfRFJJVkVSX0ZFQVRV
UkVfSU5UX0xWRFMpCj4gPiAtCQkJZGV2X3ByaXYtPnZidC5pbnRfbHZkc19zdXBwb3J0ID0gMDsK
PiA+ICsJCQlpOTE1LT52YnQuaW50X2x2ZHNfc3VwcG9ydCA9IDA7Cj4gPiAgIAl9IGVsc2Ugewo+
ID4gICAJCS8qCj4gPiAgIAkJICogRklYTUUgaXQncyBub3QgY2xlYXIgd2hpY2ggQkRCIHZlcnNp
b24gaGFzIHRoZSBMVkRTIGNvbmZpZwo+ID4gQEAgLTU0Nyw3ICs1NDcsNyBAQCBwYXJzZV9kcml2
ZXJfZmVhdHVyZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCWlm
IChiZGItPnZlcnNpb24gPj0gMTM0ICYmCj4gPiAgIAkJICAgIGRyaXZlci0+bHZkc19jb25maWcg
IT0gQkRCX0RSSVZFUl9GRUFUVVJFX0lOVF9MVkRTICYmCj4gPiAgIAkJICAgIGRyaXZlci0+bHZk
c19jb25maWcgIT0gQkRCX0RSSVZFUl9GRUFUVVJFX0lOVF9TRFZPX0xWRFMpCj4gPiAtCQkJZGV2
X3ByaXYtPnZidC5pbnRfbHZkc19zdXBwb3J0ID0gMDsKPiA+ICsJCQlpOTE1LT52YnQuaW50X2x2
ZHNfc3VwcG9ydCA9IDA7Cj4gPiAgIAl9Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJEUlJTIFN0YXRl
IEVuYWJsZWQ6JWRcbiIsIGRyaXZlci0+ZHJyc19lbmFibGVkKTsKPiA+IEBAIC01NTgsMTcgKzU1
OCwxNyBAQCBwYXJzZV9kcml2ZXJfZmVhdHVyZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAJICogZHJpdmVyLT5kcnJzX2VuYWJsZWQ9ZmFsc2UKPiA+ICAgCSAqLwo+
ID4gICAJaWYgKCFkcml2ZXItPmRycnNfZW5hYmxlZCkKPiA+IC0JCWRldl9wcml2LT52YnQuZHJy
c190eXBlID0gRFJSU19OT1RfU1VQUE9SVEVEOwo+ID4gLQlkZXZfcHJpdi0+dmJ0LnBzci5lbmFi
bGUgPSBkcml2ZXItPnBzcl9lbmFibGVkOwo+ID4gKwkJaTkxNS0+dmJ0LmRycnNfdHlwZSA9IERS
UlNfTk9UX1NVUFBPUlRFRDsKPiA+ICsJaTkxNS0+dmJ0LnBzci5lbmFibGUgPSBkcml2ZXItPnBz
cl9lbmFibGVkOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkCj4gPiAtcGFyc2VfZWRwKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIgKmJk
YikKPiA+ICtwYXJzZV9lZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGNvbnN0IHN0
cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4gPiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVjdCBiZGJfZWRw
ICplZHA7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZWRwX3Bvd2VyX3NlcSAqZWRwX3BwczsKPiA+ICAg
CWNvbnN0IHN0cnVjdCBlZHBfZmFzdF9saW5rX3BhcmFtcyAqZWRwX2xpbmtfcGFyYW1zOwo+ID4g
LQlpbnQgcGFuZWxfdHlwZSA9IGRldl9wcml2LT52YnQucGFuZWxfdHlwZTsKPiA+ICsJaW50IHBh
bmVsX3R5cGUgPSBpOTE1LT52YnQucGFuZWxfdHlwZTsKPiA+ICAgCWVkcCA9IGZpbmRfc2VjdGlv
bihiZGIsIEJEQl9FRFApOwo+ID4gICAJaWYgKCFlZHApCj4gPiBAQCAtNTc2LDEzICs1NzYsMTMg
QEAgcGFyc2VfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgY29uc3Qgc3Ry
dWN0IGJkYl9oZWFkZXIgKmJkYikKPiA+ICAgCXN3aXRjaCAoKGVkcC0+Y29sb3JfZGVwdGggPj4g
KHBhbmVsX3R5cGUgKiAyKSkgJiAzKSB7Cj4gPiAgIAljYXNlIEVEUF8xOEJQUDoKPiA+IC0JCWRl
dl9wcml2LT52YnQuZWRwLmJwcCA9IDE4Owo+ID4gKwkJaTkxNS0+dmJ0LmVkcC5icHAgPSAxODsK
PiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgRURQXzI0QlBQOgo+ID4gLQkJZGV2X3ByaXYtPnZi
dC5lZHAuYnBwID0gMjQ7Cj4gPiArCQlpOTE1LT52YnQuZWRwLmJwcCA9IDI0Owo+ID4gICAJCWJy
ZWFrOwo+ID4gICAJY2FzZSBFRFBfMzBCUFA6Cj4gPiAtCQlkZXZfcHJpdi0+dmJ0LmVkcC5icHAg
PSAzMDsKPiA+ICsJCWk5MTUtPnZidC5lZHAuYnBwID0gMzA7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAg
IAl9Cj4gPiBAQCAtNTkwLDE0ICs1OTAsMTQgQEAgcGFyc2VfZWRwKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIgKmJkYikKPiA+ICAgCWVk
cF9wcHMgPSAmZWRwLT5wb3dlcl9zZXFzW3BhbmVsX3R5cGVdOwo+ID4gICAJZWRwX2xpbmtfcGFy
YW1zID0gJmVkcC0+ZmFzdF9saW5rX3BhcmFtc1twYW5lbF90eXBlXTsKPiA+IC0JZGV2X3ByaXYt
PnZidC5lZHAucHBzID0gKmVkcF9wcHM7Cj4gPiArCWk5MTUtPnZidC5lZHAucHBzID0gKmVkcF9w
cHM7Cj4gPiAgIAlzd2l0Y2ggKGVkcF9saW5rX3BhcmFtcy0+cmF0ZSkgewo+ID4gICAJY2FzZSBF
RFBfUkFURV8xXzYyOgo+ID4gLQkJZGV2X3ByaXYtPnZidC5lZHAucmF0ZSA9IERQX0xJTktfQldf
MV82MjsKPiA+ICsJCWk5MTUtPnZidC5lZHAucmF0ZSA9IERQX0xJTktfQldfMV82MjsKPiA+ICAg
CQlicmVhazsKPiA+ICAgCWNhc2UgRURQX1JBVEVfMl83Ogo+ID4gLQkJZGV2X3ByaXYtPnZidC5l
ZHAucmF0ZSA9IERQX0xJTktfQldfMl83Owo+ID4gKwkJaTkxNS0+dmJ0LmVkcC5yYXRlID0gRFBf
TElOS19CV18yXzc7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAlkZWZhdWx0Ogo+ID4gICAJCURSTV9E
RUJVR19LTVMoIlZCVCBoYXMgdW5rbm93biBlRFAgbGluayByYXRlIHZhbHVlICV1XG4iLAo+ID4g
QEAgLTYwNywxMyArNjA3LDEzIEBAIHBhcnNlX2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4gPiAgIAlzd2l0Y2ggKGVk
cF9saW5rX3BhcmFtcy0+bGFuZXMpIHsKPiA+ICAgCWNhc2UgRURQX0xBTkVfMToKPiA+IC0JCWRl
dl9wcml2LT52YnQuZWRwLmxhbmVzID0gMTsKPiA+ICsJCWk5MTUtPnZidC5lZHAubGFuZXMgPSAx
Owo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSBFRFBfTEFORV8yOgo+ID4gLQkJZGV2X3ByaXYt
PnZidC5lZHAubGFuZXMgPSAyOwo+ID4gKwkJaTkxNS0+dmJ0LmVkcC5sYW5lcyA9IDI7Cj4gPiAg
IAkJYnJlYWs7Cj4gPiAgIAljYXNlIEVEUF9MQU5FXzQ6Cj4gPiAtCQlkZXZfcHJpdi0+dmJ0LmVk
cC5sYW5lcyA9IDQ7Cj4gPiArCQlpOTE1LT52YnQuZWRwLmxhbmVzID0gNDsKPiA+ICAgCQlicmVh
azsKPiA+ICAgCWRlZmF1bHQ6Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiVkJUIGhhcyB1bmtub3du
IGVEUCBsYW5lIGNvdW50IHZhbHVlICV1XG4iLAo+ID4gQEAgLTYyMywxNiArNjIzLDE2IEBAIHBh
cnNlX2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGNvbnN0IHN0cnVjdCBi
ZGJfaGVhZGVyICpiZGIpCj4gPiAgIAlzd2l0Y2ggKGVkcF9saW5rX3BhcmFtcy0+cHJlZW1waGFz
aXMpIHsKPiA+ICAgCWNhc2UgRURQX1BSRUVNUEhBU0lTX05PTkU6Cj4gPiAtCQlkZXZfcHJpdi0+
dmJ0LmVkcC5wcmVlbXBoYXNpcyA9IERQX1RSQUlOX1BSRV9FTVBIX0xFVkVMXzA7Cj4gPiArCQlp
OTE1LT52YnQuZWRwLnByZWVtcGhhc2lzID0gRFBfVFJBSU5fUFJFX0VNUEhfTEVWRUxfMDsKPiA+
ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgRURQX1BSRUVNUEhBU0lTXzNfNWRCOgo+ID4gLQkJZGV2
X3ByaXYtPnZidC5lZHAucHJlZW1waGFzaXMgPSBEUF9UUkFJTl9QUkVfRU1QSF9MRVZFTF8xOwo+
ID4gKwkJaTkxNS0+dmJ0LmVkcC5wcmVlbXBoYXNpcyA9IERQX1RSQUlOX1BSRV9FTVBIX0xFVkVM
XzE7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEVEUF9QUkVFTVBIQVNJU182ZEI6Cj4gPiAt
CQlkZXZfcHJpdi0+dmJ0LmVkcC5wcmVlbXBoYXNpcyA9IERQX1RSQUlOX1BSRV9FTVBIX0xFVkVM
XzI7Cj4gPiArCQlpOTE1LT52YnQuZWRwLnByZWVtcGhhc2lzID0gRFBfVFJBSU5fUFJFX0VNUEhf
TEVWRUxfMjsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgRURQX1BSRUVNUEhBU0lTXzlfNWRC
Ogo+ID4gLQkJZGV2X3ByaXYtPnZidC5lZHAucHJlZW1waGFzaXMgPSBEUF9UUkFJTl9QUkVfRU1Q
SF9MRVZFTF8zOwo+ID4gKwkJaTkxNS0+dmJ0LmVkcC5wcmVlbXBoYXNpcyA9IERQX1RSQUlOX1BS
RV9FTVBIX0xFVkVMXzM7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAlkZWZhdWx0Ogo+ID4gICAJCURS
TV9ERUJVR19LTVMoIlZCVCBoYXMgdW5rbm93biBlRFAgcHJlLWVtcGhhc2lzIHZhbHVlICV1XG4i
LAo+ID4gQEAgLTY0MiwxNiArNjQyLDE2IEBAIHBhcnNlX2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCj4gPiAgIAlzd2l0
Y2ggKGVkcF9saW5rX3BhcmFtcy0+dnN3aW5nKSB7Cj4gPiAgIAljYXNlIEVEUF9WU1dJTkdfMF80
VjoKPiA+IC0JCWRldl9wcml2LT52YnQuZWRwLnZzd2luZyA9IERQX1RSQUlOX1ZPTFRBR0VfU1dJ
TkdfTEVWRUxfMDsKPiA+ICsJCWk5MTUtPnZidC5lZHAudnN3aW5nID0gRFBfVFJBSU5fVk9MVEFH
RV9TV0lOR19MRVZFTF8wOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSBFRFBfVlNXSU5HXzBf
NlY6Cj4gPiAtCQlkZXZfcHJpdi0+dmJ0LmVkcC52c3dpbmcgPSBEUF9UUkFJTl9WT0xUQUdFX1NX
SU5HX0xFVkVMXzE7Cj4gPiArCQlpOTE1LT52YnQuZWRwLnZzd2luZyA9IERQX1RSQUlOX1ZPTFRB
R0VfU1dJTkdfTEVWRUxfMTsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgRURQX1ZTV0lOR18w
XzhWOgo+ID4gLQkJZGV2X3ByaXYtPnZidC5lZHAudnN3aW5nID0gRFBfVFJBSU5fVk9MVEFHRV9T
V0lOR19MRVZFTF8yOwo+ID4gKwkJaTkxNS0+dmJ0LmVkcC52c3dpbmcgPSBEUF9UUkFJTl9WT0xU
QUdFX1NXSU5HX0xFVkVMXzI7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEVEUF9WU1dJTkdf
MV8yVjoKPiA+IC0JCWRldl9wcml2LT52YnQuZWRwLnZzd2luZyA9IERQX1RSQUlOX1ZPTFRBR0Vf
U1dJTkdfTEVWRUxfMzsKPiA+ICsJCWk5MTUtPnZidC5lZHAudnN3aW5nID0gRFBfVFJBSU5fVk9M
VEFHRV9TV0lOR19MRVZFTF8zOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJZGVmYXVsdDoKPiA+ICAg
CQlEUk1fREVCVUdfS01TKCJWQlQgaGFzIHVua25vd24gZURQIHZvbHRhZ2Ugc3dpbmcgdmFsdWUg
JXVcbiIsCj4gPiBAQCAtNjY0LDIxICs2NjQsMjEgQEAgcGFyc2VfZWRwKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIgKmJkYikKPiA+ICAg
CQkvKiBEb24ndCByZWFkIGZyb20gVkJUIGlmIG1vZHVsZSBwYXJhbWV0ZXIgaGFzIHZhbGlkIHZh
bHVlKi8KPiA+ICAgCQlpZiAoaTkxNV9tb2RwYXJhbXMuZWRwX3Zzd2luZykgewo+ID4gLQkJCWRl
dl9wcml2LT52YnQuZWRwLmxvd192c3dpbmcgPQo+ID4gKwkJCWk5MTUtPnZidC5lZHAubG93X3Zz
d2luZyA9Cj4gPiAgIAkJCQlpOTE1X21vZHBhcmFtcy5lZHBfdnN3aW5nID09IDE7Cj4gPiAgIAkJ
fSBlbHNlIHsKPiA+ICAgCQkJdnN3aW5nID0gKGVkcC0+ZWRwX3Zzd2luZ19wcmVlbXBoID4+IChw
YW5lbF90eXBlICogNCkpICYgMHhGOwo+ID4gLQkJCWRldl9wcml2LT52YnQuZWRwLmxvd192c3dp
bmcgPSB2c3dpbmcgPT0gMDsKPiA+ICsJCQlpOTE1LT52YnQuZWRwLmxvd192c3dpbmcgPSB2c3dp
bmcgPT0gMDsKPiA+ICAgCQl9Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQKPiA+
IC1wYXJzZV9wc3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBjb25zdCBzdHJ1
Y3QgYmRiX2hlYWRlciAqYmRiKQo+ID4gK3BhcnNlX3BzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwgY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIgKmJkYikKPiA+ICAgewo+ID4gICAJY29u
c3Qgc3RydWN0IGJkYl9wc3IgKnBzcjsKPiA+ICAgCWNvbnN0IHN0cnVjdCBwc3JfdGFibGUgKnBz
cl90YWJsZTsKPiA+IC0JaW50IHBhbmVsX3R5cGUgPSBkZXZfcHJpdi0+dmJ0LnBhbmVsX3R5cGU7
Cj4gPiArCWludCBwYW5lbF90eXBlID0gaTkxNS0+dmJ0LnBhbmVsX3R5cGU7Cj4gPiAgIAlwc3Ig
PSBmaW5kX3NlY3Rpb24oYmRiLCBCREJfUFNSKTsKPiA+ICAgCWlmICghcHNyKSB7Cj4gPiBAQCAt
Njg4LDI1ICs2ODgsMjUgQEAgcGFyc2VfcHNyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIgKmJkYikKPiA+ICAgCXBzcl90YWJsZSA9ICZw
c3ItPnBzcl90YWJsZVtwYW5lbF90eXBlXTsKPiA+IC0JZGV2X3ByaXYtPnZidC5wc3IuZnVsbF9s
aW5rID0gcHNyX3RhYmxlLT5mdWxsX2xpbms7Cj4gPiAtCWRldl9wcml2LT52YnQucHNyLnJlcXVp
cmVfYXV4X3dha2V1cCA9IHBzcl90YWJsZS0+cmVxdWlyZV9hdXhfdG9fd2FrZXVwOwo+ID4gKwlp
OTE1LT52YnQucHNyLmZ1bGxfbGluayA9IHBzcl90YWJsZS0+ZnVsbF9saW5rOwo+ID4gKwlpOTE1
LT52YnQucHNyLnJlcXVpcmVfYXV4X3dha2V1cCA9IHBzcl90YWJsZS0+cmVxdWlyZV9hdXhfdG9f
d2FrZXVwOwo+ID4gICAJLyogQWxsb3dlZCBWQlQgdmFsdWVzIGdvZXMgZnJvbSAwIHRvIDE1ICov
Cj4gPiAtCWRldl9wcml2LT52YnQucHNyLmlkbGVfZnJhbWVzID0gcHNyX3RhYmxlLT5pZGxlX2Zy
YW1lcyA8IDAgPyAwIDoKPiA+ICsJaTkxNS0+dmJ0LnBzci5pZGxlX2ZyYW1lcyA9IHBzcl90YWJs
ZS0+aWRsZV9mcmFtZXMgPCAwID8gMCA6Cj4gPiAgIAkJcHNyX3RhYmxlLT5pZGxlX2ZyYW1lcyA+
IDE1ID8gMTUgOiBwc3JfdGFibGUtPmlkbGVfZnJhbWVzOwo+ID4gICAJc3dpdGNoIChwc3JfdGFi
bGUtPmxpbmVzX3RvX3dhaXQpIHsKPiA+ICAgCWNhc2UgMDoKPiA+IC0JCWRldl9wcml2LT52YnQu
cHNyLmxpbmVzX3RvX3dhaXQgPSBQU1JfMF9MSU5FU19UT19XQUlUOwo+ID4gKwkJaTkxNS0+dmJ0
LnBzci5saW5lc190b193YWl0ID0gUFNSXzBfTElORVNfVE9fV0FJVDsKPiA+ICAgCQlicmVhazsK
PiA+ICAgCWNhc2UgMToKPiA+IC0JCWRldl9wcml2LT52YnQucHNyLmxpbmVzX3RvX3dhaXQgPSBQ
U1JfMV9MSU5FX1RPX1dBSVQ7Cj4gPiArCQlpOTE1LT52YnQucHNyLmxpbmVzX3RvX3dhaXQgPSBQ
U1JfMV9MSU5FX1RPX1dBSVQ7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIDI6Cj4gPiAtCQlk
ZXZfcHJpdi0+dmJ0LnBzci5saW5lc190b193YWl0ID0gUFNSXzRfTElORVNfVE9fV0FJVDsKPiA+
ICsJCWk5MTUtPnZidC5wc3IubGluZXNfdG9fd2FpdCA9IFBTUl80X0xJTkVTX1RPX1dBSVQ7Cj4g
PiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIDM6Cj4gPiAtCQlkZXZfcHJpdi0+dmJ0LnBzci5saW5l
c190b193YWl0ID0gUFNSXzhfTElORVNfVE9fV0FJVDsKPiA+ICsJCWk5MTUtPnZidC5wc3IubGlu
ZXNfdG9fd2FpdCA9IFBTUl84X0xJTkVTX1RPX1dBSVQ7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAlk
ZWZhdWx0Ogo+ID4gICAJCURSTV9ERUJVR19LTVMoIlZCVCBoYXMgdW5rbm93biBQU1IgbGluZXMg
dG8gd2FpdCAldVxuIiwKPiA+IEBAIC03MTksNDggKzcxOSw0OCBAQCBwYXJzZV9wc3Ioc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBjb25zdCBzdHJ1Y3QgYmRiX2hlYWRlciAqYmRi
KQo+ID4gICAJICogT2xkIGRlY2ltYWwgdmFsdWUgaXMgd2FrZSB1cCB0aW1lIGluIG11bHRpcGxl
cyBvZiAxMDAgdXMuCj4gPiAgIAkgKi8KPiA+ICAgCWlmIChiZGItPnZlcnNpb24gPj0gMjA1ICYm
Cj4gPiAtCSAgICAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJp
dikgfHwKPiA+IC0JICAgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSkgewo+ID4gKwkgICAg
KElTX0dFTjlfQkMoaTkxNSkgfHwgSVNfR0VNSU5JTEFLRShpOTE1KSB8fAo+ID4gKwkgICAgIElO
VEVMX0dFTihpOTE1KSA+PSAxMCkpIHsKPiA+ICAgCQlzd2l0Y2ggKHBzcl90YWJsZS0+dHAxX3dh
a2V1cF90aW1lKSB7Cj4gPiAgIAkJY2FzZSAwOgo+ID4gLQkJCWRldl9wcml2LT52YnQucHNyLnRw
MV93YWtldXBfdGltZV91cyA9IDUwMDsKPiA+ICsJCQlpOTE1LT52YnQucHNyLnRwMV93YWtldXBf
dGltZV91cyA9IDUwMDsKPiA+ICAgCQkJYnJlYWs7Cj4gPiAgIAkJY2FzZSAxOgo+ID4gLQkJCWRl
dl9wcml2LT52YnQucHNyLnRwMV93YWtldXBfdGltZV91cyA9IDEwMDsKPiA+ICsJCQlpOTE1LT52
YnQucHNyLnRwMV93YWtldXBfdGltZV91cyA9IDEwMDsKPiA+ICAgCQkJYnJlYWs7Cj4gPiAgIAkJ
Y2FzZSAzOgo+ID4gLQkJCWRldl9wcml2LT52YnQucHNyLnRwMV93YWtldXBfdGltZV91cyA9IDA7
Cj4gPiArCQkJaTkxNS0+dmJ0LnBzci50cDFfd2FrZXVwX3RpbWVfdXMgPSAwOwo+ID4gICAJCQli
cmVhazsKPiA+ICAgCQlkZWZhdWx0Ogo+ID4gICAJCQlEUk1fREVCVUdfS01TKCJWQlQgdHAxIHdh
a2V1cCB0aW1lIHZhbHVlICVkIGlzIG91dHNpZGUgcmFuZ2VbMC0zXSwgZGVmYXVsdGluZyB0byBt
YXggdmFsdWUgMjUwMHVzXG4iLAo+ID4gICAJCQkJCXBzcl90YWJsZS0+dHAxX3dha2V1cF90aW1l
KTsKPiA+ICAgCQkJLyogZmFsbHRocm91Z2ggKi8KPiA+ICAgCQljYXNlIDI6Cj4gPiAtCQkJZGV2
X3ByaXYtPnZidC5wc3IudHAxX3dha2V1cF90aW1lX3VzID0gMjUwMDsKPiA+ICsJCQlpOTE1LT52
YnQucHNyLnRwMV93YWtldXBfdGltZV91cyA9IDI1MDA7Cj4gPiAgIAkJCWJyZWFrOwo+ID4gICAJ
CX0KPiA+ICAgCQlzd2l0Y2ggKHBzcl90YWJsZS0+dHAyX3RwM193YWtldXBfdGltZSkgewo+ID4g
ICAJCWNhc2UgMDoKPiA+IC0JCQlkZXZfcHJpdi0+dmJ0LnBzci50cDJfdHAzX3dha2V1cF90aW1l
X3VzID0gNTAwOwo+ID4gKwkJCWk5MTUtPnZidC5wc3IudHAyX3RwM193YWtldXBfdGltZV91cyA9
IDUwMDsKPiA+ICAgCQkJYnJlYWs7Cj4gPiAgIAkJY2FzZSAxOgo+ID4gLQkJCWRldl9wcml2LT52
YnQucHNyLnRwMl90cDNfd2FrZXVwX3RpbWVfdXMgPSAxMDA7Cj4gPiArCQkJaTkxNS0+dmJ0LnBz
ci50cDJfdHAzX3dha2V1cF90aW1lX3VzID0gMTAwOwo+ID4gICAJCQlicmVhazsKPiA+ICAgCQlj
YXNlIDM6Cj4gPiAtCQkJZGV2X3ByaXYtPnZidC5wc3IudHAyX3RwM193YWtldXBfdGltZV91cyA9
IDA7Cj4gPiArCQkJaTkxNS0+dmJ0LnBzci50cDJfdHAzX3dha2V1cF90aW1lX3VzID0gMDsKPiA+
ICAgCQkJYnJlYWs7Cj4gPiAgIAkJZGVmYXVsdDoKPiA+ICAgCQkJRFJNX0RFQlVHX0tNUygiVkJU
IHRwMl90cDMgd2FrZXVwIHRpbWUgdmFsdWUgJWQgaXMgb3V0c2lkZSByYW5nZVswLTNdLCBkZWZh
dWx0aW5nIHRvIG1heCB2YWx1ZSAyNTAwdXNcbiIsCj4gPiAgIAkJCQkJcHNyX3RhYmxlLT50cDJf
dHAzX3dha2V1cF90aW1lKTsKPiA+ICAgCQkJLyogZmFsbHRocm91Z2ggKi8KPiA+ICAgCQljYXNl
IDI6Cj4gPiAtCQkJZGV2X3ByaXYtPnZidC5wc3IudHAyX3RwM193YWtldXBfdGltZV91cyA9IDI1
MDA7Cj4gPiArCQkJaTkxNS0+dmJ0LnBzci50cDJfdHAzX3dha2V1cF90aW1lX3VzID0gMjUwMDsK
PiA+ICAgCQlicmVhazsKPiA+ICAgCQl9Cj4gPiAgIAl9IGVsc2Ugewo+ID4gLQkJZGV2X3ByaXYt
PnZidC5wc3IudHAxX3dha2V1cF90aW1lX3VzID0gcHNyX3RhYmxlLT50cDFfd2FrZXVwX3RpbWUg
KiAxMDA7Cj4gPiAtCQlkZXZfcHJpdi0+dmJ0LnBzci50cDJfdHAzX3dha2V1cF90aW1lX3VzID0g
cHNyX3RhYmxlLT50cDJfdHAzX3dha2V1cF90aW1lICogMTAwOwo+ID4gKwkJaTkxNS0+dmJ0LnBz
ci50cDFfd2FrZXVwX3RpbWVfdXMgPSBwc3JfdGFibGUtPnRwMV93YWtldXBfdGltZSAqIDEwMDsK
PiA+ICsJCWk5MTUtPnZidC5wc3IudHAyX3RwM193YWtldXBfdGltZV91cyA9IHBzcl90YWJsZS0+
dHAyX3RwM193YWtldXBfdGltZSAqIDEwMDsKPiA+ICAgCX0KPiA+ICAgCWlmIChiZGItPnZlcnNp
b24gPj0gMjI2KSB7Cj4gPiBAQCAtNzgyLDc0ICs3ODIsNzQgQEAgcGFyc2VfcHNyKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIgKmJkYikK
PiA+ICAgCQkJd2FrZXVwX3RpbWUgPSAyNTAwOwo+ID4gICAJCQlicmVhazsKPiA+ICAgCQl9Cj4g
PiAtCQlkZXZfcHJpdi0+dmJ0LnBzci5wc3IyX3RwMl90cDNfd2FrZXVwX3RpbWVfdXMgPSB3YWtl
dXBfdGltZTsKPiA+ICsJCWk5MTUtPnZidC5wc3IucHNyMl90cDJfdHAzX3dha2V1cF90aW1lX3Vz
ID0gd2FrZXVwX3RpbWU7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCS8qIFJldXNpbmcgUFNSMSB3
YWtldXAgdGltZSBmb3IgUFNSMiBpbiBvbGRlciBWQlRzICovCj4gPiAtCQlkZXZfcHJpdi0+dmJ0
LnBzci5wc3IyX3RwMl90cDNfd2FrZXVwX3RpbWVfdXMgPSBkZXZfcHJpdi0+dmJ0LnBzci50cDJf
dHAzX3dha2V1cF90aW1lX3VzOwo+ID4gKwkJaTkxNS0+dmJ0LnBzci5wc3IyX3RwMl90cDNfd2Fr
ZXVwX3RpbWVfdXMgPSBpOTE1LT52YnQucHNyLnRwMl90cDNfd2FrZXVwX3RpbWVfdXM7Cj4gPiAg
IAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBwYXJzZV9kc2lfYmFja2xpZ2h0X3BvcnRzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBwYXJzZV9k
c2lfYmFja2xpZ2h0X3BvcnRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJ
CQkJICAgICAgdTE2IHZlcnNpb24sIGVudW0gcG9ydCBwb3J0KQo+ID4gICB7Cj4gPiAtCWlmICgh
ZGV2X3ByaXYtPnZidC5kc2kuY29uZmlnLT5kdWFsX2xpbmsgfHwgdmVyc2lvbiA8IDE5Nykgewo+
ID4gLQkJZGV2X3ByaXYtPnZidC5kc2kuYmxfcG9ydHMgPSBCSVQocG9ydCk7Cj4gPiAtCQlpZiAo
ZGV2X3ByaXYtPnZidC5kc2kuY29uZmlnLT5jYWJjX3N1cHBvcnRlZCkKPiA+IC0JCQlkZXZfcHJp
di0+dmJ0LmRzaS5jYWJjX3BvcnRzID0gQklUKHBvcnQpOwo+ID4gKwlpZiAoIWk5MTUtPnZidC5k
c2kuY29uZmlnLT5kdWFsX2xpbmsgfHwgdmVyc2lvbiA8IDE5Nykgewo+ID4gKwkJaTkxNS0+dmJ0
LmRzaS5ibF9wb3J0cyA9IEJJVChwb3J0KTsKPiA+ICsJCWlmIChpOTE1LT52YnQuZHNpLmNvbmZp
Zy0+Y2FiY19zdXBwb3J0ZWQpCj4gPiArCQkJaTkxNS0+dmJ0LmRzaS5jYWJjX3BvcnRzID0gQklU
KHBvcnQpOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0Jc3dpdGNoIChkZXZfcHJpdi0+
dmJ0LmRzaS5jb25maWctPmRsX2Rjc19iYWNrbGlnaHRfcG9ydHMpIHsKPiA+ICsJc3dpdGNoIChp
OTE1LT52YnQuZHNpLmNvbmZpZy0+ZGxfZGNzX2JhY2tsaWdodF9wb3J0cykgewo+ID4gICAJY2Fz
ZSBETF9EQ1NfUE9SVF9BOgo+ID4gLQkJZGV2X3ByaXYtPnZidC5kc2kuYmxfcG9ydHMgPSBCSVQo
UE9SVF9BKTsKPiA+ICsJCWk5MTUtPnZidC5kc2kuYmxfcG9ydHMgPSBCSVQoUE9SVF9BKTsKPiA+
ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgRExfRENTX1BPUlRfQzoKPiA+IC0JCWRldl9wcml2LT52
YnQuZHNpLmJsX3BvcnRzID0gQklUKFBPUlRfQyk7Cj4gPiArCQlpOTE1LT52YnQuZHNpLmJsX3Bv
cnRzID0gQklUKFBPUlRfQyk7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAlkZWZhdWx0Ogo+ID4gICAJ
Y2FzZSBETF9EQ1NfUE9SVF9BX0FORF9DOgo+ID4gLQkJZGV2X3ByaXYtPnZidC5kc2kuYmxfcG9y
dHMgPSBCSVQoUE9SVF9BKSB8IEJJVChQT1JUX0MpOwo+ID4gKwkJaTkxNS0+dmJ0LmRzaS5ibF9w
b3J0cyA9IEJJVChQT1JUX0EpIHwgQklUKFBPUlRfQyk7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAl9
Cj4gPiAtCWlmICghZGV2X3ByaXYtPnZidC5kc2kuY29uZmlnLT5jYWJjX3N1cHBvcnRlZCkKPiA+
ICsJaWYgKCFpOTE1LT52YnQuZHNpLmNvbmZpZy0+Y2FiY19zdXBwb3J0ZWQpCj4gPiAgIAkJcmV0
dXJuOwo+ID4gLQlzd2l0Y2ggKGRldl9wcml2LT52YnQuZHNpLmNvbmZpZy0+ZGxfZGNzX2NhYmNf
cG9ydHMpIHsKPiA+ICsJc3dpdGNoIChpOTE1LT52YnQuZHNpLmNvbmZpZy0+ZGxfZGNzX2NhYmNf
cG9ydHMpIHsKPiA+ICAgCWNhc2UgRExfRENTX1BPUlRfQToKPiA+IC0JCWRldl9wcml2LT52YnQu
ZHNpLmNhYmNfcG9ydHMgPSBCSVQoUE9SVF9BKTsKPiA+ICsJCWk5MTUtPnZidC5kc2kuY2FiY19w
b3J0cyA9IEJJVChQT1JUX0EpOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSBETF9EQ1NfUE9S
VF9DOgo+ID4gLQkJZGV2X3ByaXYtPnZidC5kc2kuY2FiY19wb3J0cyA9IEJJVChQT1JUX0MpOwo+
ID4gKwkJaTkxNS0+dmJ0LmRzaS5jYWJjX3BvcnRzID0gQklUKFBPUlRfQyk7Cj4gPiAgIAkJYnJl
YWs7Cj4gPiAgIAlkZWZhdWx0Ogo+ID4gICAJY2FzZSBETF9EQ1NfUE9SVF9BX0FORF9DOgo+ID4g
LQkJZGV2X3ByaXYtPnZidC5kc2kuY2FiY19wb3J0cyA9Cj4gPiArCQlpOTE1LT52YnQuZHNpLmNh
YmNfcG9ydHMgPQo+ID4gICAJCQkJCUJJVChQT1JUX0EpIHwgQklUKFBPUlRfQyk7Cj4gPiAgIAkJ
YnJlYWs7Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQKPiA+IC1wYXJzZV9taXBp
X2NvbmZpZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArcGFyc2VfbWlw
aV9jb25maWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICBjb25zdCBz
dHJ1Y3QgYmRiX2hlYWRlciAqYmRiKQo+ID4gICB7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgYmRiX21p
cGlfY29uZmlnICpzdGFydDsKPiA+ICAgCWNvbnN0IHN0cnVjdCBtaXBpX2NvbmZpZyAqY29uZmln
Owo+ID4gICAJY29uc3Qgc3RydWN0IG1pcGlfcHBzX2RhdGEgKnBwczsKPiA+IC0JaW50IHBhbmVs
X3R5cGUgPSBkZXZfcHJpdi0+dmJ0LnBhbmVsX3R5cGU7Cj4gPiArCWludCBwYW5lbF90eXBlID0g
aTkxNS0+dmJ0LnBhbmVsX3R5cGU7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+ICAgCS8qIHBh
cnNlIE1JUEkgYmxvY2tzIG9ubHkgaWYgTEZQIHR5cGUgaXMgTUlQSSAqLwo+ID4gLQlpZiAoIWlu
dGVsX2Jpb3NfaXNfZHNpX3ByZXNlbnQoZGV2X3ByaXYsICZwb3J0KSkKPiA+ICsJaWYgKCFpbnRl
bF9iaW9zX2lzX2RzaV9wcmVzZW50KGk5MTUsICZwb3J0KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAg
IAkvKiBJbml0aWFsaXplIHRoaXMgdG8gdW5kZWZpbmVkIGluZGljYXRpbmcgbm8gZ2VuZXJpYyBN
SVBJIHN1cHBvcnQgKi8KPiA+IC0JZGV2X3ByaXYtPnZidC5kc2kucGFuZWxfaWQgPSBNSVBJX0RT
SV9VTkRFRklORURfUEFORUxfSUQ7Cj4gPiArCWk5MTUtPnZidC5kc2kucGFuZWxfaWQgPSBNSVBJ
X0RTSV9VTkRFRklORURfUEFORUxfSUQ7Cj4gPiAgIAkvKiBCbG9jayAjNDAgaXMgYWxyZWFkeSBw
YXJzZWQgYW5kIHBhbmVsX2ZpeGVkX21vZGUgaXMKPiA+IC0JICogc3RvcmVkIGluIGRldl9wcml2
LT5sZnBfbHZkc192YnRfbW9kZQo+ID4gKwkgKiBzdG9yZWQgaW4gaTkxNS0+bGZwX2x2ZHNfdmJ0
X21vZGUKPiA+ICAgCSAqIHJlc3VzZSB0aGlzIHdoZW4gbmVlZGVkCj4gPiAgIAkgKi8KPiA+IEBA
IC04NzMsMTcgKzg3MywxNyBAQCBwYXJzZV9taXBpX2NvbmZpZyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlwcHMgPSAmc3RhcnQtPnBwc1twYW5lbF90eXBlXTsKPiA+
ICAgCS8qIHN0b3JlIGFzIG9mIG5vdyBmdWxsIGRhdGEuIFRyaW0gd2hlbiB3ZSByZWFsaXNlIGFs
bCBpcyBub3QgbmVlZGVkICovCj4gPiAtCWRldl9wcml2LT52YnQuZHNpLmNvbmZpZyA9IGttZW1k
dXAoY29uZmlnLCBzaXplb2Yoc3RydWN0IG1pcGlfY29uZmlnKSwgR0ZQX0tFUk5FTCk7Cj4gPiAt
CWlmICghZGV2X3ByaXYtPnZidC5kc2kuY29uZmlnKQo+ID4gKwlpOTE1LT52YnQuZHNpLmNvbmZp
ZyA9IGttZW1kdXAoY29uZmlnLCBzaXplb2Yoc3RydWN0IG1pcGlfY29uZmlnKSwgR0ZQX0tFUk5F
TCk7Cj4gPiArCWlmICghaTkxNS0+dmJ0LmRzaS5jb25maWcpCj4gPiAgIAkJcmV0dXJuOwo+ID4g
LQlkZXZfcHJpdi0+dmJ0LmRzaS5wcHMgPSBrbWVtZHVwKHBwcywgc2l6ZW9mKHN0cnVjdCBtaXBp
X3Bwc19kYXRhKSwgR0ZQX0tFUk5FTCk7Cj4gPiAtCWlmICghZGV2X3ByaXYtPnZidC5kc2kucHBz
KSB7Cj4gPiAtCQlrZnJlZShkZXZfcHJpdi0+dmJ0LmRzaS5jb25maWcpOwo+ID4gKwlpOTE1LT52
YnQuZHNpLnBwcyA9IGttZW1kdXAocHBzLCBzaXplb2Yoc3RydWN0IG1pcGlfcHBzX2RhdGEpLCBH
RlBfS0VSTkVMKTsKPiA+ICsJaWYgKCFpOTE1LT52YnQuZHNpLnBwcykgewo+ID4gKwkJa2ZyZWUo
aTkxNS0+dmJ0LmRzaS5jb25maWcpOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0JcGFy
c2VfZHNpX2JhY2tsaWdodF9wb3J0cyhkZXZfcHJpdiwgYmRiLT52ZXJzaW9uLCBwb3J0KTsKPiA+
ICsJcGFyc2VfZHNpX2JhY2tsaWdodF9wb3J0cyhpOTE1LCBiZGItPnZlcnNpb24sIHBvcnQpOwo+
ID4gICAJLyogRklYTUUgaXMgdGhlIDkwIHZzLiAyNzAgY29ycmVjdD8gKi8KPiA+ICAgCXN3aXRj
aCAoY29uZmlnLT5yb3RhdGlvbikgewo+ID4gQEAgLTg5MiwyNSArODkyLDI1IEBAIHBhcnNlX21p
cGlfY29uZmlnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQkgKiBN
b3N0IChhbGw/KSBWQlRzIGNsYWltIDAgZGVncmVlcyBkZXNwaXRlIGhhdmluZwo+ID4gICAJCSAq
IGFuIHVwc2lkZSBkb3duIHBhbmVsLCB0aHVzIHdlIGRvIG5vdCB0cnVzdCB0aGlzLgo+ID4gICAJ
CSAqLwo+ID4gLQkJZGV2X3ByaXYtPnZidC5kc2kub3JpZW50YXRpb24gPQo+ID4gKwkJaTkxNS0+
dmJ0LmRzaS5vcmllbnRhdGlvbiA9Cj4gPiAgIAkJCURSTV9NT0RFX1BBTkVMX09SSUVOVEFUSU9O
X1VOS05PV047Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEVOQUJMRV9ST1RBVElPTl85MDoK
PiA+IC0JCWRldl9wcml2LT52YnQuZHNpLm9yaWVudGF0aW9uID0KPiA+ICsJCWk5MTUtPnZidC5k
c2kub3JpZW50YXRpb24gPQo+ID4gICAJCQlEUk1fTU9ERV9QQU5FTF9PUklFTlRBVElPTl9SSUdI
VF9VUDsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgRU5BQkxFX1JPVEFUSU9OXzE4MDoKPiA+
IC0JCWRldl9wcml2LT52YnQuZHNpLm9yaWVudGF0aW9uID0KPiA+ICsJCWk5MTUtPnZidC5kc2ku
b3JpZW50YXRpb24gPQo+ID4gICAJCQlEUk1fTU9ERV9QQU5FTF9PUklFTlRBVElPTl9CT1RUT01f
VVA7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIEVOQUJMRV9ST1RBVElPTl8yNzA6Cj4gPiAt
CQlkZXZfcHJpdi0+dmJ0LmRzaS5vcmllbnRhdGlvbiA9Cj4gPiArCQlpOTE1LT52YnQuZHNpLm9y
aWVudGF0aW9uID0KPiA+ICAgCQkJRFJNX01PREVfUEFORUxfT1JJRU5UQVRJT05fTEVGVF9VUDsK
PiA+ICAgCQlicmVhazsKPiA+ICAgCX0KPiA+ICAgCS8qIFdlIGhhdmUgbWFuZGF0b3J5IG1pcGkg
Y29uZmlnIGJsb2Nrcy4gSW5pdGlhbGl6ZSBhcyBnZW5lcmljIHBhbmVsICovCj4gPiAtCWRldl9w
cml2LT52YnQuZHNpLnBhbmVsX2lkID0gTUlQSV9EU0lfR0VORVJJQ19QQU5FTF9JRDsKPiA+ICsJ
aTkxNS0+dmJ0LmRzaS5wYW5lbF9pZCA9IE1JUElfRFNJX0dFTkVSSUNfUEFORUxfSUQ7Cj4gPiAg
IH0KPiA+ICAgLyogRmluZCB0aGUgc2VxdWVuY2UgYmxvY2sgYW5kIHNpemUgZm9yIHRoZSBnaXZl
biBwYW5lbC4gKi8KPiA+IEBAIC0xMDczLDEyICsxMDczLDEyIEBAIHN0YXRpYyBpbnQgZ290b19u
ZXh0X3NlcXVlbmNlX3YzKGNvbnN0IHU4ICpkYXRhLCBpbnQgaW5kZXgsIGludCB0b3RhbCkKPiA+
ICAgICogR2V0IGxlbiBvZiBwcmUtZml4ZWQgZGVhc3NlcnQgZnJhZ21lbnQgZnJvbSBhIHYxIGlu
aXQgT1RQIHNlcXVlbmNlLAo+ID4gICAgKiBza2lwIGFsbCBkZWxheSArIGdwaW8gb3BlcmFuZHMg
YW5kIHN0b3AgYXQgdGhlIGZpcnN0IERTSSBwYWNrZXQgb3AuCj4gPiAgICAqLwo+ID4gLXN0YXRp
YyBpbnQgZ2V0X2luaXRfb3RwX2RlYXNzZXJ0X2ZyYWdtZW50X2xlbihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGludCBnZXRfaW5pdF9vdHBfZGVhc3NlcnRf
ZnJhZ21lbnRfbGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAt
CWNvbnN0IHU4ICpkYXRhID0gZGV2X3ByaXYtPnZidC5kc2kuc2VxdWVuY2VbTUlQSV9TRVFfSU5J
VF9PVFBdOwo+ID4gKwljb25zdCB1OCAqZGF0YSA9IGk5MTUtPnZidC5kc2kuc2VxdWVuY2VbTUlQ
SV9TRVFfSU5JVF9PVFBdOwo+ID4gICAJaW50IGluZGV4LCBsZW47Cj4gPiAtCWlmIChXQVJOX09O
KCFkYXRhIHx8IGRldl9wcml2LT52YnQuZHNpLnNlcV92ZXJzaW9uICE9IDEpKQo+ID4gKwlpZiAo
V0FSTl9PTighZGF0YSB8fCBpOTE1LT52YnQuZHNpLnNlcV92ZXJzaW9uICE9IDEpKQo+ID4gICAJ
CXJldHVybiAwOwo+ID4gICAJLyogaW5kZXggPSAxIHRvIHNraXAgc2VxdWVuY2UgYnl0ZSAqLwo+
ID4gQEAgLTExMDYsNTQgKzExMDYsNTQgQEAgc3RhdGljIGludCBnZXRfaW5pdF9vdHBfZGVhc3Nl
cnRfZnJhZ21lbnRfbGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAg
ICogdGhlc2UgZGV2aWNlcyB3ZSBzcGxpdCB0aGUgaW5pdCBPVFAgc2VxdWVuY2UgaW50byBhIGRl
YXNzZXJ0IHNlcXVlbmNlIGFuZAo+ID4gICAgKiB0aGUgYWN0dWFsIGluaXQgT1RQIHBhcnQuCj4g
PiAgICAqLwo+ID4gLXN0YXRpYyB2b2lkIGZpeHVwX21pcGlfc2VxdWVuY2VzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBmaXh1cF9taXBpX3NlcXVl
bmNlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTggKmlu
aXRfb3RwOwo+ID4gICAJaW50IGxlbjsKPiA+ICAgCS8qIExpbWl0IHRoaXMgdG8gVkxWIGZvciBu
b3cuICovCj4gPiAtCWlmICghSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCj4gPiArCWlmICghSVNf
VkFMTEVZVklFVyhpOTE1KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAkvKiBMaW1pdCB0aGlzIHRv
IHYxIHZpZC1tb2RlIHNlcXVlbmNlcyAqLwo+ID4gLQlpZiAoZGV2X3ByaXYtPnZidC5kc2kuY29u
ZmlnLT5pc19jbWRfbW9kZSB8fAo+ID4gLQkgICAgZGV2X3ByaXYtPnZidC5kc2kuc2VxX3ZlcnNp
b24gIT0gMSkKPiA+ICsJaWYgKGk5MTUtPnZidC5kc2kuY29uZmlnLT5pc19jbWRfbW9kZSB8fAo+
ID4gKwkgICAgaTkxNS0+dmJ0LmRzaS5zZXFfdmVyc2lvbiAhPSAxKQo+ID4gICAJCXJldHVybjsK
PiA+ICAgCS8qIE9ubHkgZG8gdGhpcyBpZiB0aGVyZSBhcmUgb3RwIGFuZCBhc3NlcnQgc2VxcyBh
bmQgbm8gZGVhc3NlcnQgc2VxICovCj4gPiAtCWlmICghZGV2X3ByaXYtPnZidC5kc2kuc2VxdWVu
Y2VbTUlQSV9TRVFfSU5JVF9PVFBdIHx8Cj4gPiAtCSAgICAhZGV2X3ByaXYtPnZidC5kc2kuc2Vx
dWVuY2VbTUlQSV9TRVFfQVNTRVJUX1JFU0VUXSB8fAo+ID4gLQkgICAgZGV2X3ByaXYtPnZidC5k
c2kuc2VxdWVuY2VbTUlQSV9TRVFfREVBU1NFUlRfUkVTRVRdKQo+ID4gKwlpZiAoIWk5MTUtPnZi
dC5kc2kuc2VxdWVuY2VbTUlQSV9TRVFfSU5JVF9PVFBdIHx8Cj4gPiArCSAgICAhaTkxNS0+dmJ0
LmRzaS5zZXF1ZW5jZVtNSVBJX1NFUV9BU1NFUlRfUkVTRVRdIHx8Cj4gPiArCSAgICBpOTE1LT52
YnQuZHNpLnNlcXVlbmNlW01JUElfU0VRX0RFQVNTRVJUX1JFU0VUXSkKPiA+ICAgCQlyZXR1cm47
Cj4gPiAgIAkvKiBUaGUgZGVhc3NlcnQtc2VxdWVuY2UgZW5kcyBhdCB0aGUgZmlyc3QgRFNJIHBh
Y2tldCAqLwo+ID4gLQlsZW4gPSBnZXRfaW5pdF9vdHBfZGVhc3NlcnRfZnJhZ21lbnRfbGVuKGRl
dl9wcml2KTsKPiA+ICsJbGVuID0gZ2V0X2luaXRfb3RwX2RlYXNzZXJ0X2ZyYWdtZW50X2xlbihp
OTE1KTsKPiA+ICAgCWlmICghbGVuKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCURSTV9ERUJVR19L
TVMoIlVzaW5nIGluaXQgT1RQIGZyYWdtZW50IHRvIGRlYXNzZXJ0IHJlc2V0XG4iKTsKPiA+ICAg
CS8qIENvcHkgdGhlIGZyYWdtZW50LCB1cGRhdGUgc2VxIGJ5dGUgYW5kIHRlcm1pbmF0ZSBpdCAq
Lwo+ID4gLQlpbml0X290cCA9ICh1OCAqKWRldl9wcml2LT52YnQuZHNpLnNlcXVlbmNlW01JUElf
U0VRX0lOSVRfT1RQXTsKPiA+IC0JZGV2X3ByaXYtPnZidC5kc2kuZGVhc3NlcnRfc2VxID0ga21l
bWR1cChpbml0X290cCwgbGVuICsgMSwgR0ZQX0tFUk5FTCk7Cj4gPiAtCWlmICghZGV2X3ByaXYt
PnZidC5kc2kuZGVhc3NlcnRfc2VxKQo+ID4gKwlpbml0X290cCA9ICh1OCAqKWk5MTUtPnZidC5k
c2kuc2VxdWVuY2VbTUlQSV9TRVFfSU5JVF9PVFBdOwo+ID4gKwlpOTE1LT52YnQuZHNpLmRlYXNz
ZXJ0X3NlcSA9IGttZW1kdXAoaW5pdF9vdHAsIGxlbiArIDEsIEdGUF9LRVJORUwpOwo+ID4gKwlp
ZiAoIWk5MTUtPnZidC5kc2kuZGVhc3NlcnRfc2VxKQo+ID4gICAJCXJldHVybjsKPiA+IC0JZGV2
X3ByaXYtPnZidC5kc2kuZGVhc3NlcnRfc2VxWzBdID0gTUlQSV9TRVFfREVBU1NFUlRfUkVTRVQ7
Cj4gPiAtCWRldl9wcml2LT52YnQuZHNpLmRlYXNzZXJ0X3NlcVtsZW5dID0gTUlQSV9TRVFfRUxF
TV9FTkQ7Cj4gPiArCWk5MTUtPnZidC5kc2kuZGVhc3NlcnRfc2VxWzBdID0gTUlQSV9TRVFfREVB
U1NFUlRfUkVTRVQ7Cj4gPiArCWk5MTUtPnZidC5kc2kuZGVhc3NlcnRfc2VxW2xlbl0gPSBNSVBJ
X1NFUV9FTEVNX0VORDsKPiA+ICAgCS8qIFVzZSB0aGUgY29weSBmb3IgZGVhc3NlcnQgKi8KPiA+
IC0JZGV2X3ByaXYtPnZidC5kc2kuc2VxdWVuY2VbTUlQSV9TRVFfREVBU1NFUlRfUkVTRVRdID0K
PiA+IC0JCWRldl9wcml2LT52YnQuZHNpLmRlYXNzZXJ0X3NlcTsKPiA+ICsJaTkxNS0+dmJ0LmRz
aS5zZXF1ZW5jZVtNSVBJX1NFUV9ERUFTU0VSVF9SRVNFVF0gPQo+ID4gKwkJaTkxNS0+dmJ0LmRz
aS5kZWFzc2VydF9zZXE7Cj4gPiAgIAkvKiBSZXBsYWNlIHRoZSBsYXN0IGJ5dGUgb2YgdGhlIGZy
YWdtZW50IHdpdGggaW5pdCBPVFAgc2VxIGJ5dGUgKi8KPiA+ICAgCWluaXRfb3RwW2xlbiAtIDFd
ID0gTUlQSV9TRVFfSU5JVF9PVFA7Cj4gPiAgIAkvKiBBbmQgbWFrZSBNSVBJX01JUElfU0VRX0lO
SVRfT1RQIHBvaW50IHRvIGl0ICovCj4gPiAtCWRldl9wcml2LT52YnQuZHNpLnNlcXVlbmNlW01J
UElfU0VRX0lOSVRfT1RQXSA9IGluaXRfb3RwICsgbGVuIC0gMTsKPiA+ICsJaTkxNS0+dmJ0LmRz
aS5zZXF1ZW5jZVtNSVBJX1NFUV9JTklUX09UUF0gPSBpbml0X290cCArIGxlbiAtIDE7Cj4gPiAg
IH0KPiA+ICAgc3RhdGljIHZvaWQKPiA+IC1wYXJzZV9taXBpX3NlcXVlbmNlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtwYXJzZV9taXBpX3NlcXVlbmNlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCSAgICBjb25zdCBzdHJ1Y3QgYmRiX2hlYWRl
ciAqYmRiKQo+ID4gICB7Cj4gPiAtCWludCBwYW5lbF90eXBlID0gZGV2X3ByaXYtPnZidC5wYW5l
bF90eXBlOwo+ID4gKwlpbnQgcGFuZWxfdHlwZSA9IGk5MTUtPnZidC5wYW5lbF90eXBlOwo+ID4g
ICAJY29uc3Qgc3RydWN0IGJkYl9taXBpX3NlcXVlbmNlICpzZXF1ZW5jZTsKPiA+ICAgCWNvbnN0
IHU4ICpzZXFfZGF0YTsKPiA+ICAgCXUzMiBzZXFfc2l6ZTsKPiA+IEBAIC0xMTYxLDcgKzExNjEs
NyBAQCBwYXJzZV9taXBpX3NlcXVlbmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgCWludCBpbmRleCA9IDA7Cj4gPiAgIAkvKiBPbmx5IG91ciBnZW5lcmljIHBhbmVs
IGRyaXZlciB1c2VzIHRoZSBzZXF1ZW5jZSBibG9jay4gKi8KPiA+IC0JaWYgKGRldl9wcml2LT52
YnQuZHNpLnBhbmVsX2lkICE9IE1JUElfRFNJX0dFTkVSSUNfUEFORUxfSUQpCj4gPiArCWlmIChp
OTE1LT52YnQuZHNpLnBhbmVsX2lkICE9IE1JUElfRFNJX0dFTkVSSUNfUEFORUxfSUQpCj4gPiAg
IAkJcmV0dXJuOwo+ID4gICAJc2VxdWVuY2UgPSBmaW5kX3NlY3Rpb24oYmRiLCBCREJfTUlQSV9T
RVFVRU5DRSk7Cj4gPiBAQCAtMTIwMiw3ICsxMjAyLDcgQEAgcGFyc2VfbWlwaV9zZXF1ZW5jZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJaWYgKHNlcV9pZCA9PSBN
SVBJX1NFUV9URUFSX09OIHx8IHNlcV9pZCA9PSBNSVBJX1NFUV9URUFSX09GRikKPiA+ICAgCQkJ
RFJNX0RFQlVHX0tNUygiVW5zdXBwb3J0ZWQgc2VxdWVuY2UgJXVcbiIsIHNlcV9pZCk7Cj4gPiAt
CQlkZXZfcHJpdi0+dmJ0LmRzaS5zZXF1ZW5jZVtzZXFfaWRdID0gZGF0YSArIGluZGV4Owo+ID4g
KwkJaTkxNS0+dmJ0LmRzaS5zZXF1ZW5jZVtzZXFfaWRdID0gZGF0YSArIGluZGV4Owo+ID4gICAJ
CWlmIChzZXF1ZW5jZS0+dmVyc2lvbiA+PSAzKQo+ID4gICAJCQlpbmRleCA9IGdvdG9fbmV4dF9z
ZXF1ZW5jZV92MyhkYXRhLCBpbmRleCwgc2VxX3NpemUpOwo+ID4gQEAgLTEyMTQsMTggKzEyMTQs
MTggQEAgcGFyc2VfbWlwaV9zZXF1ZW5jZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAgIAkJfQo+ID4gICAJfQo+ID4gLQlkZXZfcHJpdi0+dmJ0LmRzaS5kYXRhID0gZGF0
YTsKPiA+IC0JZGV2X3ByaXYtPnZidC5kc2kuc2l6ZSA9IHNlcV9zaXplOwo+ID4gLQlkZXZfcHJp
di0+dmJ0LmRzaS5zZXFfdmVyc2lvbiA9IHNlcXVlbmNlLT52ZXJzaW9uOwo+ID4gKwlpOTE1LT52
YnQuZHNpLmRhdGEgPSBkYXRhOwo+ID4gKwlpOTE1LT52YnQuZHNpLnNpemUgPSBzZXFfc2l6ZTsK
PiA+ICsJaTkxNS0+dmJ0LmRzaS5zZXFfdmVyc2lvbiA9IHNlcXVlbmNlLT52ZXJzaW9uOwo+ID4g
LQlmaXh1cF9taXBpX3NlcXVlbmNlcyhkZXZfcHJpdik7Cj4gPiArCWZpeHVwX21pcGlfc2VxdWVu
Y2VzKGk5MTUpOwo+ID4gICAJRFJNX0RFQlVHX0RSSVZFUigiTUlQSSByZWxhdGVkIFZCVCBwYXJz
aW5nIGNvbXBsZXRlXG4iKTsKPiA+ICAgCXJldHVybjsKPiA+ICAgZXJyOgo+ID4gICAJa2ZyZWUo
ZGF0YSk7Cj4gPiAtCW1lbXNldChkZXZfcHJpdi0+dmJ0LmRzaS5zZXF1ZW5jZSwgMCwgc2l6ZW9m
KGRldl9wcml2LT52YnQuZHNpLnNlcXVlbmNlKSk7Cj4gPiArCW1lbXNldChpOTE1LT52YnQuZHNp
LnNlcXVlbmNlLCAwLCBzaXplb2YoaTkxNS0+dmJ0LmRzaS5zZXF1ZW5jZSkpOwo+ID4gICB9Cj4g
PiAgIHN0YXRpYyB1OCB0cmFuc2xhdGVfaWJvb3N0KHU4IHZhbCkKPiA+IEBAIC0xMjU0LDE2ICsx
MjU0LDE2IEBAIHN0YXRpYyBlbnVtIHBvcnQgZ2V0X3BvcnRfYnlfZGRjX3BpbihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTggZGRjX3BpbikKPiA+ICAgCXJldHVybiBQT1JUX05PTkU7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBzYW5pdGl6ZV9kZGNfcGluKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBzYW5pdGl6ZV9kZGNfcGluKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgIGVudW0gcG9ydCBwb3J0
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkZGlfdmJ0X3BvcnRfaW5mbyAqaW5mbyA9ICZkZXZfcHJp
di0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF07Cj4gPiArCXN0cnVjdCBkZGlfdmJ0X3BvcnRfaW5m
byAqaW5mbyA9ICZpOTE1LT52YnQuZGRpX3BvcnRfaW5mb1twb3J0XTsKPiA+ICAgCWVudW0gcG9y
dCBwOwo+ID4gICAJaWYgKCFpbmZvLT5hbHRlcm5hdGVfZGRjX3BpbikKPiA+ICAgCQlyZXR1cm47
Cj4gPiAtCXAgPSBnZXRfcG9ydF9ieV9kZGNfcGluKGRldl9wcml2LCBpbmZvLT5hbHRlcm5hdGVf
ZGRjX3Bpbik7Cj4gPiArCXAgPSBnZXRfcG9ydF9ieV9kZGNfcGluKGk5MTUsIGluZm8tPmFsdGVy
bmF0ZV9kZGNfcGluKTsKPiA+ICAgCWlmIChwICE9IFBPUlRfTk9ORSkgewo+ID4gICAJCURSTV9E
RUJVR19LTVMoInBvcnQgJWMgdHJ5aW5nIHRvIHVzZSB0aGUgc2FtZSBEREMgcGluICgweCV4KSBh
cyBwb3J0ICVjLCAiCj4gPiAgIAkJCSAgICAgICJkaXNhYmxpbmcgcG9ydCAlYyBEVkkvSERNSSBz
dXBwb3J0XG4iLAo+ID4gQEAgLTEzMDAsMTYgKzEzMDAsMTYgQEAgc3RhdGljIGVudW0gcG9ydCBn
ZXRfcG9ydF9ieV9hdXhfY2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU4IGF1eF9j
aCkKPiA+ICAgCXJldHVybiBQT1JUX05PTkU7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBzYW5p
dGl6ZV9hdXhfY2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRp
YyB2b2lkIHNhbml0aXplX2F1eF9jaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+
ICAgCQkJICAgIGVudW0gcG9ydCBwb3J0KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkZGlfdmJ0X3Bv
cnRfaW5mbyAqaW5mbyA9ICZkZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF07Cj4gPiAr
CXN0cnVjdCBkZGlfdmJ0X3BvcnRfaW5mbyAqaW5mbyA9ICZpOTE1LT52YnQuZGRpX3BvcnRfaW5m
b1twb3J0XTsKPiA+ICAgCWVudW0gcG9ydCBwOwo+ID4gICAJaWYgKCFpbmZvLT5hbHRlcm5hdGVf
YXV4X2NoYW5uZWwpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlwID0gZ2V0X3BvcnRfYnlfYXV4X2No
KGRldl9wcml2LCBpbmZvLT5hbHRlcm5hdGVfYXV4X2NoYW5uZWwpOwo+ID4gKwlwID0gZ2V0X3Bv
cnRfYnlfYXV4X2NoKGk5MTUsIGluZm8tPmFsdGVybmF0ZV9hdXhfY2hhbm5lbCk7Cj4gPiAgIAlp
ZiAocCAhPSBQT1JUX05PTkUpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJwb3J0ICVjIHRyeWlu
ZyB0byB1c2UgdGhlIHNhbWUgQVVYIENIICgweCV4KSBhcyBwb3J0ICVjLCAiCj4gPiAgIAkJCSAg
ICAgICJkaXNhYmxpbmcgcG9ydCAlYyBEUCBzdXBwb3J0XG4iLAo+ID4gQEAgLTEzNDcsMTUgKzEz
NDcsMTUgQEAgc3RhdGljIGNvbnN0IHU4IGljcF9kZGNfcGluX21hcFtdID0gewo+ID4gICAJW0lD
TF9ERENfQlVTX1BPUlRfNF0gPSBHTUJVU19QSU5fMTJfVEM0X0lDUCwKPiA+ICAgfTsKPiA+IC1z
dGF0aWMgdTggbWFwX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1
OCB2YnRfcGluKQo+ID4gK3N0YXRpYyB1OCBtYXBfZGRjX3BpbihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgdTggdmJ0X3BpbikKPiA+ICAgewo+ID4gICAJY29uc3QgdTggKmRkY19waW5f
bWFwOwo+ID4gICAJaW50IG5fZW50cmllczsKPiA+IC0JaWYgKEhBU19QQ0hfSUNQKGRldl9wcml2
KSkgewo+ID4gKwlpZiAoSEFTX1BDSF9JQ1AoaTkxNSkpIHsKPiA+ICAgCQlkZGNfcGluX21hcCA9
IGljcF9kZGNfcGluX21hcDsKPiA+ICAgCQluX2VudHJpZXMgPSBBUlJBWV9TSVpFKGljcF9kZGNf
cGluX21hcCk7Cj4gPiAtCX0gZWxzZSBpZiAoSEFTX1BDSF9DTlAoZGV2X3ByaXYpKSB7Cj4gPiAr
CX0gZWxzZSBpZiAoSEFTX1BDSF9DTlAoaTkxNSkpIHsKPiA+ICAgCQlkZGNfcGluX21hcCA9IGNu
cF9kZGNfcGluX21hcDsKPiA+ICAgCQluX2VudHJpZXMgPSBBUlJBWV9TSVpFKGNucF9kZGNfcGlu
X21hcCk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gQEAgLTE0MDEsNyArMTQwMSw3IEBAIHN0YXRpYyBl
bnVtIHBvcnQgZHZvX3BvcnRfdG9fcG9ydCh1OCBkdm9fcG9ydCkKPiA+ICAgCXJldHVybiBQT1JU
X05PTkU7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBwYXJzZV9kZGlfcG9ydChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgcGFyc2VfZGRpX3BvcnQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgIGNvbnN0IHN0cnVjdCBj
aGlsZF9kZXZpY2VfY29uZmlnICpjaGlsZCwKPiA+ICAgCQkJICAgdTggYmRiX3ZlcnNpb24pCj4g
PiAgIHsKPiA+IEBAIC0xNDEzLDcgKzE0MTMsNyBAQCBzdGF0aWMgdm9pZCBwYXJzZV9kZGlfcG9y
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlpZiAocG9ydCA9PSBQ
T1JUX05PTkUpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlpbmZvID0gJmRldl9wcml2LT52YnQuZGRp
X3BvcnRfaW5mb1twb3J0XTsKPiA+ICsJaW5mbyA9ICZpOTE1LT52YnQuZGRpX3BvcnRfaW5mb1tw
b3J0XTsKPiA+ICAgCWlmIChpbmZvLT5jaGlsZCkgewo+ID4gICAJCURSTV9ERUJVR19LTVMoIk1v
cmUgdGhhbiBvbmUgY2hpbGQgZGV2aWNlIGZvciBwb3J0ICVjIGluIFZCVCwgdXNpbmcgdGhlIGZp
cnN0LlxuIiwKPiA+IEBAIC0xNDQ3LDcgKzE0NDcsNyBAQCBzdGF0aWMgdm9pZCBwYXJzZV9kZGlf
cG9ydChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlEUk1fREVCVUdf
S01TKCJQb3J0ICVjIFZCVCBpbmZvOiBDUlQ6JWQgRFZJOiVkIEhETUk6JWQgRFA6JWQgZURQOiVk
IExTUENPTjolZCBVU0ItVHlwZS1DOiVkIFRCVDolZFxuIiwKPiA+ICAgCQkgICAgICBwb3J0X25h
bWUocG9ydCksIGlzX2NydCwgaXNfZHZpLCBpc19oZG1pLCBpc19kcCwgaXNfZWRwLAo+ID4gLQkJ
ICAgICAgSEFTX0xTUENPTihkZXZfcHJpdikgJiYgY2hpbGQtPmxzcGNvbiwKPiA+ICsJCSAgICAg
IEhBU19MU1BDT04oaTkxNSkgJiYgY2hpbGQtPmxzcGNvbiwKPiA+ICAgCQkgICAgICBpbmZvLT5z
dXBwb3J0c190eXBlY191c2IsIGluZm8tPnN1cHBvcnRzX3RidCk7Cj4gPiAgIAlpZiAoaXNfZWRw
ICYmIGlzX2R2aSkKPiA+IEBAIC0xNDY5LDEwICsxNDY5LDEwIEBAIHN0YXRpYyB2b2lkIHBhcnNl
X2RkaV9wb3J0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWlmIChp
c19kdmkpIHsKPiA+ICAgCQl1OCBkZGNfcGluOwo+ID4gLQkJZGRjX3BpbiA9IG1hcF9kZGNfcGlu
KGRldl9wcml2LCBjaGlsZC0+ZGRjX3Bpbik7Cj4gPiAtCQlpZiAoaW50ZWxfZ21idXNfaXNfdmFs
aWRfcGluKGRldl9wcml2LCBkZGNfcGluKSkgewo+ID4gKwkJZGRjX3BpbiA9IG1hcF9kZGNfcGlu
KGk5MTUsIGNoaWxkLT5kZGNfcGluKTsKPiA+ICsJCWlmIChpbnRlbF9nbWJ1c19pc192YWxpZF9w
aW4oaTkxNSwgZGRjX3BpbikpIHsKPiA+ICAgCQkJaW5mby0+YWx0ZXJuYXRlX2RkY19waW4gPSBk
ZGNfcGluOwo+ID4gLQkJCXNhbml0aXplX2RkY19waW4oZGV2X3ByaXYsIHBvcnQpOwo+ID4gKwkJ
CXNhbml0aXplX2RkY19waW4oaTkxNSwgcG9ydCk7Cj4gPiAgIAkJfSBlbHNlIHsKPiA+ICAgCQkJ
RFJNX0RFQlVHX0tNUygiUG9ydCAlYyBoYXMgaW52YWxpZCBEREMgcGluICVkLCAiCj4gPiAgIAkJ
CQkgICAgICAic3RpY2tpbmcgdG8gZGVmYXVsdHNcbiIsCj4gPiBAQCAtMTQ4Myw3ICsxNDgzLDcg
QEAgc3RhdGljIHZvaWQgcGFyc2VfZGRpX3BvcnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAJaWYgKGlzX2RwKSB7Cj4gPiAgIAkJaW5mby0+YWx0ZXJuYXRlX2F1eF9j
aGFubmVsID0gY2hpbGQtPmF1eF9jaGFubmVsOwo+ID4gLQkJc2FuaXRpemVfYXV4X2NoKGRldl9w
cml2LCBwb3J0KTsKPiA+ICsJCXNhbml0aXplX2F1eF9jaChpOTE1LCBwb3J0KTsKPiA+ICAgCX0K
PiA+ICAgCWlmIChiZGJfdmVyc2lvbiA+PSAxNTgpIHsKPiA+IEBAIC0xNTUzLDI2ICsxNTUzLDI2
IEBAIHN0YXRpYyB2b2lkIHBhcnNlX2RkaV9wb3J0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCWluZm8tPmNoaWxkID0gY2hpbGQ7Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
dm9pZCBwYXJzZV9kZGlfcG9ydHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1
OCBiZGJfdmVyc2lvbikKPiA+ICtzdGF0aWMgdm9pZCBwYXJzZV9kZGlfcG9ydHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU4IGJkYl92ZXJzaW9uKQo+ID4gICB7Cj4gPiAgIAljb25z
dCBzdHJ1Y3QgY2hpbGRfZGV2aWNlX2NvbmZpZyAqY2hpbGQ7Cj4gPiAgIAlpbnQgaTsKPiA+IC0J
aWYgKCFIQVNfRERJKGRldl9wcml2KSAmJiAhSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiAr
CWlmICghSEFTX0RESShpOTE1KSAmJiAhSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICAgCQlyZXR1
cm47Cj4gPiAgIAlpZiAoYmRiX3ZlcnNpb24gPCAxNTUpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlm
b3IgKGkgPSAwOyBpIDwgZGV2X3ByaXYtPnZidC5jaGlsZF9kZXZfbnVtOyBpKyspIHsKPiA+IC0J
CWNoaWxkID0gZGV2X3ByaXYtPnZidC5jaGlsZF9kZXYgKyBpOwo+ID4gKwlmb3IgKGkgPSAwOyBp
IDwgaTkxNS0+dmJ0LmNoaWxkX2Rldl9udW07IGkrKykgewo+ID4gKwkJY2hpbGQgPSBpOTE1LT52
YnQuY2hpbGRfZGV2ICsgaTsKPiA+IC0JCXBhcnNlX2RkaV9wb3J0KGRldl9wcml2LCBjaGlsZCwg
YmRiX3ZlcnNpb24pOwo+ID4gKwkJcGFyc2VfZGRpX3BvcnQoaTkxNSwgY2hpbGQsIGJkYl92ZXJz
aW9uKTsKPiA+ICAgCX0KPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZAo+ID4gLXBhcnNlX2dlbmVy
YWxfZGVmaW5pdGlvbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3Bh
cnNlX2dlbmVyYWxfZGVmaW5pdGlvbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgIAkJCSAgY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIgKmJkYikKPiA+ICAgewo+ID4gICAJY29u
c3Qgc3RydWN0IGJkYl9nZW5lcmFsX2RlZmluaXRpb25zICpkZWZzOwo+ID4gQEAgLTE1OTcsOCAr
MTU5Nyw4IEBAIHBhcnNlX2dlbmVyYWxfZGVmaW5pdGlvbnMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gICAJYnVzX3BpbiA9IGRlZnMtPmNydF9kZGNfZ21idXNfcGluOwo+
ID4gICAJRFJNX0RFQlVHX0tNUygiY3J0X2RkY19idXNfcGluOiAlZFxuIiwgYnVzX3Bpbik7Cj4g
PiAtCWlmIChpbnRlbF9nbWJ1c19pc192YWxpZF9waW4oZGV2X3ByaXYsIGJ1c19waW4pKQo+ID4g
LQkJZGV2X3ByaXYtPnZidC5jcnRfZGRjX3BpbiA9IGJ1c19waW47Cj4gPiArCWlmIChpbnRlbF9n
bWJ1c19pc192YWxpZF9waW4oaTkxNSwgYnVzX3BpbikpCj4gPiArCQlpOTE1LT52YnQuY3J0X2Rk
Y19waW4gPSBidXNfcGluOwo+ID4gICAJaWYgKGJkYi0+dmVyc2lvbiA8IDEwNikgewo+ID4gICAJ
CWV4cGVjdGVkX3NpemUgPSAyMjsKPiA+IEBAIC0xNjQ1LDEzICsxNjQ1LDEzIEBAIHBhcnNlX2dl
bmVyYWxfZGVmaW5pdGlvbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
ICAJCURSTV9ERUJVR19LTVMoIm5vIGNoaWxkIGRldiBpcyBwYXJzZWQgZnJvbSBWQlRcbiIpOwo+
ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0JZGV2X3ByaXYtPnZidC5jaGlsZF9kZXYgPSBr
Y2FsbG9jKGNvdW50LCBzaXplb2YoKmNoaWxkKSwgR0ZQX0tFUk5FTCk7Cj4gPiAtCWlmICghZGV2
X3ByaXYtPnZidC5jaGlsZF9kZXYpIHsKPiA+ICsJaTkxNS0+dmJ0LmNoaWxkX2RldiA9IGtjYWxs
b2MoY291bnQsIHNpemVvZigqY2hpbGQpLCBHRlBfS0VSTkVMKTsKPiA+ICsJaWYgKCFpOTE1LT52
YnQuY2hpbGRfZGV2KSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiTm8gbWVtb3J5IHNwYWNlIGZv
ciBjaGlsZCBkZXZpY2VcbiIpOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0JZGV2X3By
aXYtPnZidC5jaGlsZF9kZXZfbnVtID0gY291bnQ7Cj4gPiArCWk5MTUtPnZidC5jaGlsZF9kZXZf
bnVtID0gY291bnQ7Cj4gPiAgIAljb3VudCA9IDA7Cj4gPiAgIAlmb3IgKGkgPSAwOyBpIDwgY2hp
bGRfZGV2aWNlX251bTsgaSsrKSB7Cj4gPiAgIAkJY2hpbGQgPSBjaGlsZF9kZXZpY2VfcHRyKGRl
ZnMsIGkpOwo+ID4gQEAgLTE2NjMsNyArMTY2Myw3IEBAIHBhcnNlX2dlbmVyYWxfZGVmaW5pdGlv
bnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCSAqIChjaGlsZF9k
ZXZfc2l6ZSkgb2YgdGhlIGNoaWxkIGRldmljZS4gQWNjZXNzaW5nIHRoZSBkYXRhIG11c3QKPiA+
ICAgCQkgKiBkZXBlbmQgb24gVkJUIHZlcnNpb24uCj4gPiAgIAkJICovCj4gPiAtCQltZW1jcHko
ZGV2X3ByaXYtPnZidC5jaGlsZF9kZXYgKyBjb3VudCwgY2hpbGQsCj4gPiArCQltZW1jcHkoaTkx
NS0+dmJ0LmNoaWxkX2RldiArIGNvdW50LCBjaGlsZCwKPiA+ICAgCQkgICAgICAgbWluX3Qoc2l6
ZV90LCBkZWZzLT5jaGlsZF9kZXZfc2l6ZSwgc2l6ZW9mKCpjaGlsZCkpKTsKPiA+ICAgCQljb3Vu
dCsrOwo+ID4gICAJfQo+ID4gQEAgLTE2NzEsNDEgKzE2NzEsNDEgQEAgcGFyc2VfZ2VuZXJhbF9k
ZWZpbml0aW9ucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIC8qIENv
bW1vbiBkZWZhdWx0cyB3aGljaCBtYXkgYmUgb3ZlcnJpZGRlbiBieSBWQlQuICovCj4gPiAgIHN0
YXRpYyB2b2lkCj4gPiAtaW5pdF92YnRfZGVmYXVsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gK2luaXRfdmJ0X2RlZmF1bHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ID4gICB7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+IC0JZGV2X3ByaXYtPnZi
dC5jcnRfZGRjX3BpbiA9IEdNQlVTX1BJTl9WR0FEREM7Cj4gPiArCWk5MTUtPnZidC5jcnRfZGRj
X3BpbiA9IEdNQlVTX1BJTl9WR0FEREM7Cj4gPiAgIAkvKiBEZWZhdWx0IHRvIGhhdmluZyBiYWNr
bGlnaHQgKi8KPiA+IC0JZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQucHJlc2VudCA9IHRydWU7Cj4g
PiArCWk5MTUtPnZidC5iYWNrbGlnaHQucHJlc2VudCA9IHRydWU7Cj4gPiAgIAkvKiBMRlAgcGFu
ZWwgZGF0YSAqLwo+ID4gLQlkZXZfcHJpdi0+dmJ0Lmx2ZHNfZGl0aGVyID0gMTsKPiA+ICsJaTkx
NS0+dmJ0Lmx2ZHNfZGl0aGVyID0gMTsKPiA+ICAgCS8qIFNEVk8gcGFuZWwgZGF0YSAqLwo+ID4g
LQlkZXZfcHJpdi0+dmJ0LnNkdm9fbHZkc192YnRfbW9kZSA9IE5VTEw7Cj4gPiArCWk5MTUtPnZi
dC5zZHZvX2x2ZHNfdmJ0X21vZGUgPSBOVUxMOwo+ID4gICAJLyogZ2VuZXJhbCBmZWF0dXJlcyAq
Lwo+ID4gLQlkZXZfcHJpdi0+dmJ0LmludF90dl9zdXBwb3J0ID0gMTsKPiA+IC0JZGV2X3ByaXYt
PnZidC5pbnRfY3J0X3N1cHBvcnQgPSAxOwo+ID4gKwlpOTE1LT52YnQuaW50X3R2X3N1cHBvcnQg
PSAxOwo+ID4gKwlpOTE1LT52YnQuaW50X2NydF9zdXBwb3J0ID0gMTsKPiA+ICAgCS8qIGRyaXZl
ciBmZWF0dXJlcyAqLwo+ID4gLQlkZXZfcHJpdi0+dmJ0LmludF9sdmRzX3N1cHBvcnQgPSAxOwo+
ID4gKwlpOTE1LT52YnQuaW50X2x2ZHNfc3VwcG9ydCA9IDE7Cj4gPiAgIAkvKiBEZWZhdWx0IHRv
IHVzaW5nIFNTQyAqLwo+ID4gLQlkZXZfcHJpdi0+dmJ0Lmx2ZHNfdXNlX3NzYyA9IDE7Cj4gPiAr
CWk5MTUtPnZidC5sdmRzX3VzZV9zc2MgPSAxOwo+ID4gICAJLyoKPiA+ICAgCSAqIENvcmUvU2Fu
ZHlCcmlkZ2UvSXZ5QnJpZGdlIHVzZSBhbHRlcm5hdGl2ZSAoMTIwTUh6KSByZWZlcmVuY2UKPiA+
ICAgCSAqIGNsb2NrIGZvciBMVkRTLgo+ID4gICAJICovCj4gPiAtCWRldl9wcml2LT52YnQubHZk
c19zc2NfZnJlcSA9IGludGVsX2Jpb3Nfc3NjX2ZyZXF1ZW5jeShkZXZfcHJpdiwKPiA+IC0JCQkh
SEFTX1BDSF9TUExJVChkZXZfcHJpdikpOwo+ID4gLQlEUk1fREVCVUdfS01TKCJTZXQgZGVmYXVs
dCB0byBTU0MgYXQgJWQga0h6XG4iLCBkZXZfcHJpdi0+dmJ0Lmx2ZHNfc3NjX2ZyZXEpOwo+ID4g
KwlpOTE1LT52YnQubHZkc19zc2NfZnJlcSA9IGludGVsX2Jpb3Nfc3NjX2ZyZXF1ZW5jeShpOTE1
LAo+ID4gKwkJCSFIQVNfUENIX1NQTElUKGk5MTUpKTsKPiA+ICsJRFJNX0RFQlVHX0tNUygiU2V0
IGRlZmF1bHQgdG8gU1NDIGF0ICVkIGtIelxuIiwgaTkxNS0+dmJ0Lmx2ZHNfc3NjX2ZyZXEpOwo+
ID4gICAJZm9yIChwb3J0ID0gUE9SVF9BOyBwb3J0IDwgSTkxNV9NQVhfUE9SVFM7IHBvcnQrKykg
ewo+ID4gICAJCXN0cnVjdCBkZGlfdmJ0X3BvcnRfaW5mbyAqaW5mbyA9Cj4gPiAtCQkJJmRldl9w
cml2LT52YnQuZGRpX3BvcnRfaW5mb1twb3J0XTsKPiA+ICsJCQkmaTkxNS0+dmJ0LmRkaV9wb3J0
X2luZm9bcG9ydF07Cj4gPiAgIAkJaW5mby0+aGRtaV9sZXZlbF9zaGlmdCA9IEhETUlfTEVWRUxf
U0hJRlRfVU5LTk9XTjsKPiA+ICAgCX0KPiA+IEBAIC0xNzEzLDE5ICsxNzEzLDE5IEBAIGluaXRf
dmJ0X2RlZmF1bHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgLyog
RGVmYXVsdHMgdG8gaW5pdGlhbGl6ZSBvbmx5IGlmIHRoZXJlIGlzIG5vIFZCVC4gKi8KPiA+ICAg
c3RhdGljIHZvaWQKPiA+IC1pbml0X3ZidF9taXNzaW5nX2RlZmF1bHRzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbml0X3ZidF9taXNzaW5nX2RlZmF1bHRzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsK
PiA+ICAgCWZvciAocG9ydCA9IFBPUlRfQTsgcG9ydCA8IEk5MTVfTUFYX1BPUlRTOyBwb3J0Kysp
IHsKPiA+ICAgCQlzdHJ1Y3QgZGRpX3ZidF9wb3J0X2luZm8gKmluZm8gPQo+ID4gLQkJCSZkZXZf
cHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF07Cj4gPiArCQkJJmk5MTUtPnZidC5kZGlfcG9y
dF9pbmZvW3BvcnRdOwo+ID4gICAJCS8qCj4gPiAgIAkJICogVkJUIGhhcyB0aGUgVHlwZUMgbW9k
ZSAobmF0aXZlLFRCVC9VU0IpIGFuZCB3ZSBkb24ndCB3YW50Cj4gPiAgIAkJICogdG8gZGV0ZWN0
IGl0Lgo+ID4gICAJCSAqLwo+ID4gLQkJaWYgKGludGVsX3BvcnRfaXNfdGMoZGV2X3ByaXYsIHBv
cnQpKQo+ID4gKwkJaWYgKGludGVsX3BvcnRfaXNfdGMoaTkxNSwgcG9ydCkpCj4gPiAgIAkJCWNv
bnRpbnVlOwo+ID4gICAJCWluZm8tPnN1cHBvcnRzX2R2aSA9IChwb3J0ICE9IFBPUlRfQSAmJiBw
b3J0ICE9IFBPUlRfRSk7Cj4gPiBAQCAtMTgxMSwyNSArMTgxMSwyNSBAQCBzdGF0aWMgY29uc3Qg
c3RydWN0IHZidF9oZWFkZXIgKmZpbmRfdmJ0KHZvaWQgX19pb21lbSAqYmlvcywgc2l6ZV90IHNp
emUpCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9iaW9zX2luaXQgLSBmaW5kIFZCVCBhbmQgaW5p
dGlhbGl6ZSBzZXR0aW5ncyBmcm9tIHRoZSBCSU9TCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRl
dmljZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gICAg
Kgo+ID4gICAgKiBQYXJzZSBhbmQgaW5pdGlhbGl6ZSBzZXR0aW5ncyBmcm9tIHRoZSBWaWRlbyBC
SU9TIFRhYmxlcyAoVkJUKS4gSWYgdGhlIFZCVAo+ID4gICAgKiB3YXMgbm90IGZvdW5kIGluIEFD
UEkgT3BSZWdpb24sIHRyeSB0byBmaW5kIGl0IGluIFBDSSBST00gZmlyc3QuIEFsc28KPiA+ICAg
ICogaW5pdGlhbGl6ZSBzb21lIGRlZmF1bHRzIGlmIHRoZSBWQlQgaXMgbm90IHByZXNlbnQgYXQg
YWxsLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2Jpb3NfaW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9iaW9zX2luaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBk
ZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gPiAtCWNvbnN0IHN0cnVjdCB2YnRfaGVhZGVyICp2YnQgPSBk
ZXZfcHJpdi0+b3ByZWdpb24udmJ0Owo+ID4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUt
PmRybS5wZGV2Owo+ID4gKwljb25zdCBzdHJ1Y3QgdmJ0X2hlYWRlciAqdmJ0ID0gaTkxNS0+b3By
ZWdpb24udmJ0Owo+ID4gICAJY29uc3Qgc3RydWN0IGJkYl9oZWFkZXIgKmJkYjsKPiA+ICAgCXU4
IF9faW9tZW0gKmJpb3MgPSBOVUxMOwo+ID4gLQlpZiAoIUhBU19ESVNQTEFZKGRldl9wcml2KSkg
ewo+ID4gKwlpZiAoIUhBU19ESVNQTEFZKGk5MTUpKSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygi
U2tpcHBpbmcgVkJUIGluaXQgZHVlIHRvIGRpc2FibGVkIGRpc3BsYXkuXG4iKTsKPiA+ICAgCQly
ZXR1cm47Cj4gPiAgIAl9Cj4gPiAtCWluaXRfdmJ0X2RlZmF1bHRzKGRldl9wcml2KTsKPiA+ICsJ
aW5pdF92YnRfZGVmYXVsdHMoaTkxNSk7Cj4gPiAgIAkvKiBJZiB0aGUgT3BSZWdpb24gZG9lcyBu
b3QgaGF2ZSBWQlQsIGxvb2sgaW4gUENJIFJPTS4gKi8KPiA+ICAgCWlmICghdmJ0KSB7Cj4gPiBA
QCAtMTg1MiwyNSArMTg1MiwyNSBAQCB2b2lkIGludGVsX2Jpb3NfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICAgICAgKGludClzaXplb2YodmJ0LT5zaWdu
YXR1cmUpLCB2YnQtPnNpZ25hdHVyZSwgYmRiLT52ZXJzaW9uKTsKPiA+ICAgCS8qIEdyYWIgdXNl
ZnVsIGdlbmVyYWwgZGVmaW5pdGlvbnMgKi8KPiA+IC0JcGFyc2VfZ2VuZXJhbF9mZWF0dXJlcyhk
ZXZfcHJpdiwgYmRiKTsKPiA+IC0JcGFyc2VfZ2VuZXJhbF9kZWZpbml0aW9ucyhkZXZfcHJpdiwg
YmRiKTsKPiA+IC0JcGFyc2VfbGZwX3BhbmVsX2RhdGEoZGV2X3ByaXYsIGJkYik7Cj4gPiAtCXBh
cnNlX2xmcF9iYWNrbGlnaHQoZGV2X3ByaXYsIGJkYik7Cj4gPiAtCXBhcnNlX3Nkdm9fcGFuZWxf
ZGF0YShkZXZfcHJpdiwgYmRiKTsKPiA+IC0JcGFyc2VfZHJpdmVyX2ZlYXR1cmVzKGRldl9wcml2
LCBiZGIpOwo+ID4gLQlwYXJzZV9lZHAoZGV2X3ByaXYsIGJkYik7Cj4gPiAtCXBhcnNlX3Bzcihk
ZXZfcHJpdiwgYmRiKTsKPiA+IC0JcGFyc2VfbWlwaV9jb25maWcoZGV2X3ByaXYsIGJkYik7Cj4g
PiAtCXBhcnNlX21pcGlfc2VxdWVuY2UoZGV2X3ByaXYsIGJkYik7Cj4gPiArCXBhcnNlX2dlbmVy
YWxfZmVhdHVyZXMoaTkxNSwgYmRiKTsKPiA+ICsJcGFyc2VfZ2VuZXJhbF9kZWZpbml0aW9ucyhp
OTE1LCBiZGIpOwo+ID4gKwlwYXJzZV9sZnBfcGFuZWxfZGF0YShpOTE1LCBiZGIpOwo+ID4gKwlw
YXJzZV9sZnBfYmFja2xpZ2h0KGk5MTUsIGJkYik7Cj4gPiArCXBhcnNlX3Nkdm9fcGFuZWxfZGF0
YShpOTE1LCBiZGIpOwo+ID4gKwlwYXJzZV9kcml2ZXJfZmVhdHVyZXMoaTkxNSwgYmRiKTsKPiA+
ICsJcGFyc2VfZWRwKGk5MTUsIGJkYik7Cj4gPiArCXBhcnNlX3BzcihpOTE1LCBiZGIpOwo+ID4g
KwlwYXJzZV9taXBpX2NvbmZpZyhpOTE1LCBiZGIpOwo+ID4gKwlwYXJzZV9taXBpX3NlcXVlbmNl
KGk5MTUsIGJkYik7Cj4gPiAgIAkvKiBGdXJ0aGVyIHByb2Nlc3Npbmcgb24gcHJlLXBhcnNlZCBk
YXRhICovCj4gPiAtCXBhcnNlX3Nkdm9fZGV2aWNlX21hcHBpbmcoZGV2X3ByaXYsIGJkYi0+dmVy
c2lvbik7Cj4gPiAtCXBhcnNlX2RkaV9wb3J0cyhkZXZfcHJpdiwgYmRiLT52ZXJzaW9uKTsKPiA+
ICsJcGFyc2Vfc2R2b19kZXZpY2VfbWFwcGluZyhpOTE1LCBiZGItPnZlcnNpb24pOwo+ID4gKwlw
YXJzZV9kZGlfcG9ydHMoaTkxNSwgYmRiLT52ZXJzaW9uKTsKPiA+ICAgb3V0Ogo+ID4gICAJaWYg
KCF2YnQpIHsKPiA+ICAgCQlEUk1fSU5GTygiRmFpbGVkIHRvIGZpbmQgVkJJT1MgdGFibGVzIChW
QlQpXG4iKTsKPiA+IC0JCWluaXRfdmJ0X21pc3NpbmdfZGVmYXVsdHMoZGV2X3ByaXYpOwo+ID4g
KwkJaW5pdF92YnRfbWlzc2luZ19kZWZhdWx0cyhpOTE1KTsKPiA+ICAgCX0KPiA+ICAgCWlmIChi
aW9zKQo+ID4gQEAgLTE4NzksNDcgKzE4NzksNDcgQEAgdm9pZCBpbnRlbF9iaW9zX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxf
Ymlvc19jbGVhbnVwIC0gRnJlZSBhbnkgcmVzb3VyY2VzIGFsbG9jYXRlZCBieSBpbnRlbF9iaW9z
X2luaXQoKQo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICsgKiBA
aTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICAgICovCj4gPiAtdm9pZCBpbnRlbF9iaW9z
X2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50
ZWxfYmlvc19jbGVhbnVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAtCWtmcmVlKGRldl9wcml2LT52YnQuY2hpbGRfZGV2KTsKPiA+IC0JZGV2X3ByaXYtPnZidC5j
aGlsZF9kZXYgPSBOVUxMOwo+ID4gLQlkZXZfcHJpdi0+dmJ0LmNoaWxkX2Rldl9udW0gPSAwOwo+
ID4gLQlrZnJlZShkZXZfcHJpdi0+dmJ0LnNkdm9fbHZkc192YnRfbW9kZSk7Cj4gPiAtCWRldl9w
cml2LT52YnQuc2R2b19sdmRzX3ZidF9tb2RlID0gTlVMTDsKPiA+IC0Ja2ZyZWUoZGV2X3ByaXYt
PnZidC5sZnBfbHZkc192YnRfbW9kZSk7Cj4gPiAtCWRldl9wcml2LT52YnQubGZwX2x2ZHNfdmJ0
X21vZGUgPSBOVUxMOwo+ID4gLQlrZnJlZShkZXZfcHJpdi0+dmJ0LmRzaS5kYXRhKTsKPiA+IC0J
ZGV2X3ByaXYtPnZidC5kc2kuZGF0YSA9IE5VTEw7Cj4gPiAtCWtmcmVlKGRldl9wcml2LT52YnQu
ZHNpLnBwcyk7Cj4gPiAtCWRldl9wcml2LT52YnQuZHNpLnBwcyA9IE5VTEw7Cj4gPiAtCWtmcmVl
KGRldl9wcml2LT52YnQuZHNpLmNvbmZpZyk7Cj4gPiAtCWRldl9wcml2LT52YnQuZHNpLmNvbmZp
ZyA9IE5VTEw7Cj4gPiAtCWtmcmVlKGRldl9wcml2LT52YnQuZHNpLmRlYXNzZXJ0X3NlcSk7Cj4g
PiAtCWRldl9wcml2LT52YnQuZHNpLmRlYXNzZXJ0X3NlcSA9IE5VTEw7Cj4gPiArCWtmcmVlKGk5
MTUtPnZidC5jaGlsZF9kZXYpOwo+ID4gKwlpOTE1LT52YnQuY2hpbGRfZGV2ID0gTlVMTDsKPiA+
ICsJaTkxNS0+dmJ0LmNoaWxkX2Rldl9udW0gPSAwOwo+ID4gKwlrZnJlZShpOTE1LT52YnQuc2R2
b19sdmRzX3ZidF9tb2RlKTsKPiA+ICsJaTkxNS0+dmJ0LnNkdm9fbHZkc192YnRfbW9kZSA9IE5V
TEw7Cj4gPiArCWtmcmVlKGk5MTUtPnZidC5sZnBfbHZkc192YnRfbW9kZSk7Cj4gPiArCWk5MTUt
PnZidC5sZnBfbHZkc192YnRfbW9kZSA9IE5VTEw7Cj4gPiArCWtmcmVlKGk5MTUtPnZidC5kc2ku
ZGF0YSk7Cj4gPiArCWk5MTUtPnZidC5kc2kuZGF0YSA9IE5VTEw7Cj4gPiArCWtmcmVlKGk5MTUt
PnZidC5kc2kucHBzKTsKPiA+ICsJaTkxNS0+dmJ0LmRzaS5wcHMgPSBOVUxMOwo+ID4gKwlrZnJl
ZShpOTE1LT52YnQuZHNpLmNvbmZpZyk7Cj4gPiArCWk5MTUtPnZidC5kc2kuY29uZmlnID0gTlVM
TDsKPiA+ICsJa2ZyZWUoaTkxNS0+dmJ0LmRzaS5kZWFzc2VydF9zZXEpOwo+ID4gKwlpOTE1LT52
YnQuZHNpLmRlYXNzZXJ0X3NlcSA9IE5VTEw7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGlu
dGVsX2Jpb3NfaXNfdHZfcHJlc2VudCAtIGlzIGludGVncmF0ZWQgVFYgcHJlc2VudCBpbiBWQlQK
PiA+IC0gKiBAZGV2X3ByaXY6CWk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6CWk5
MTUgZGV2aWNlIGluc3RhbmNlCj4gPiAgICAqCj4gPiAgICAqIFJldHVybiB0cnVlIGlmIFRWIGlz
IHByZXNlbnQuIElmIG5vIGNoaWxkIGRldmljZXMgd2VyZSBwYXJzZWQgZnJvbSBWQlQsCj4gPiAg
ICAqIGFzc3VtZSBUViBpcyBwcmVzZW50Lgo+ID4gICAgKi8KPiA+IC1ib29sIGludGVsX2Jpb3Nf
aXNfdHZfcHJlc2VudChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArYm9v
bCBpbnRlbF9iaW9zX2lzX3R2X3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVjdCBjaGlsZF9kZXZpY2VfY29uZmlnICpjaGlsZDsK
PiA+ICAgCWludCBpOwo+ID4gLQlpZiAoIWRldl9wcml2LT52YnQuaW50X3R2X3N1cHBvcnQpCj4g
PiArCWlmICghaTkxNS0+dmJ0LmludF90dl9zdXBwb3J0KQo+ID4gICAJCXJldHVybiBmYWxzZTsK
PiA+IC0JaWYgKCFkZXZfcHJpdi0+dmJ0LmNoaWxkX2Rldl9udW0pCj4gPiArCWlmICghaTkxNS0+
dmJ0LmNoaWxkX2Rldl9udW0pCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAtCWZvciAoaSA9IDA7
IGkgPCBkZXZfcHJpdi0+dmJ0LmNoaWxkX2Rldl9udW07IGkrKykgewo+ID4gLQkJY2hpbGQgPSBk
ZXZfcHJpdi0+dmJ0LmNoaWxkX2RldiArIGk7Cj4gPiArCWZvciAoaSA9IDA7IGkgPCBpOTE1LT52
YnQuY2hpbGRfZGV2X251bTsgaSsrKSB7Cj4gPiArCQljaGlsZCA9IGk5MTUtPnZidC5jaGlsZF9k
ZXYgKyBpOwo+ID4gICAJCS8qCj4gPiAgIAkJICogSWYgdGhlIGRldmljZSB0eXBlIGlzIG5vdCBU
ViwgY29udGludWUuCj4gPiAgIAkJICovCj4gPiBAQCAtMTk0MywyMiArMTk0MywyMiBAQCBib29s
IGludGVsX2Jpb3NfaXNfdHZfcHJlc2VudChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9iaW9zX2lzX2x2ZHNfcHJlc2VudCAtIGlzIExW
RFMgcHJlc2VudCBpbiBWQlQKPiA+IC0gKiBAZGV2X3ByaXY6CWk5MTUgZGV2aWNlIGluc3RhbmNl
Cj4gPiArICogQGk5MTU6CWk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiAgICAqIEBpMmNfcGluOglp
MmMgcGluIGZvciBMVkRTIGlmIHByZXNlbnQKPiA+ICAgICoKPiA+ICAgICogUmV0dXJuIHRydWUg
aWYgTFZEUyBpcyBwcmVzZW50LiBJZiBubyBjaGlsZCBkZXZpY2VzIHdlcmUgcGFyc2VkIGZyb20g
VkJULAo+ID4gICAgKiBhc3N1bWUgTFZEUyBpcyBwcmVzZW50Lgo+ID4gICAgKi8KPiA+IC1ib29s
IGludGVsX2Jpb3NfaXNfbHZkc19wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgdTggKmkyY19waW4pCj4gPiArYm9vbCBpbnRlbF9iaW9zX2lzX2x2ZHNfcHJlc2VudChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTggKmkyY19waW4pCj4gPiAgIHsKPiA+ICAg
CWNvbnN0IHN0cnVjdCBjaGlsZF9kZXZpY2VfY29uZmlnICpjaGlsZDsKPiA+ICAgCWludCBpOwo+
ID4gLQlpZiAoIWRldl9wcml2LT52YnQuY2hpbGRfZGV2X251bSkKPiA+ICsJaWYgKCFpOTE1LT52
YnQuY2hpbGRfZGV2X251bSkKPiA+ICAgCQlyZXR1cm4gdHJ1ZTsKPiA+IC0JZm9yIChpID0gMDsg
aSA8IGRldl9wcml2LT52YnQuY2hpbGRfZGV2X251bTsgaSsrKSB7Cj4gPiAtCQljaGlsZCA9IGRl
dl9wcml2LT52YnQuY2hpbGRfZGV2ICsgaTsKPiA+ICsJZm9yIChpID0gMDsgaSA8IGk5MTUtPnZi
dC5jaGlsZF9kZXZfbnVtOyBpKyspIHsKPiA+ICsJCWNoaWxkID0gaTkxNS0+dmJ0LmNoaWxkX2Rl
diArIGk7Cj4gPiAgIAkJLyogSWYgdGhlIGRldmljZSB0eXBlIGlzIG5vdCBMRlAsIGNvbnRpbnVl
Lgo+ID4gICAJCSAqIFdlIGhhdmUgdG8gY2hlY2sgYm90aCB0aGUgbmV3IGlkZW50aWZpZXJzIGFz
IHdlbGwgYXMgdGhlCj4gPiBAQCAtMTk2OCw3ICsxOTY4LDcgQEAgYm9vbCBpbnRlbF9iaW9zX2lz
X2x2ZHNfcHJlc2VudChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4ICppMmNf
cGluKQo+ID4gICAJCSAgICBjaGlsZC0+ZGV2aWNlX3R5cGUgIT0gREVWSUNFX1RZUEVfTEZQKQo+
ID4gICAJCQljb250aW51ZTsKPiA+IC0JCWlmIChpbnRlbF9nbWJ1c19pc192YWxpZF9waW4oZGV2
X3ByaXYsIGNoaWxkLT5pMmNfcGluKSkKPiA+ICsJCWlmIChpbnRlbF9nbWJ1c19pc192YWxpZF9w
aW4oaTkxNSwgY2hpbGQtPmkyY19waW4pKQo+ID4gICAJCQkqaTJjX3BpbiA9IGNoaWxkLT5pMmNf
cGluOwo+ID4gICAJCS8qIEhvd2V2ZXIsIHdlIGNhbm5vdCB0cnVzdCB0aGUgQklPUyB3cml0ZXJz
IHRvIHBvcHVsYXRlCj4gPiBAQCAtMTk4NCw3ICsxOTg0LDcgQEAgYm9vbCBpbnRlbF9iaW9zX2lz
X2x2ZHNfcHJlc2VudChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4ICppMmNf
cGluKQo+ID4gICAJCSAqIGFkZGl0aW9uYWwgZGF0YS4gIFRydXN0IHRoYXQgaWYgdGhlIFZCVCB3
YXMgd3JpdHRlbiBpbnRvCj4gPiAgIAkJICogdGhlIE9wUmVnaW9uIHRoZW4gdGhleSBoYXZlIHZh
bGlkYXRlZCB0aGUgTFZEUydzIGV4aXN0ZW5jZS4KPiA+ICAgCQkgKi8KPiA+IC0JCWlmIChkZXZf
cHJpdi0+b3ByZWdpb24udmJ0KQo+ID4gKwkJaWYgKGk5MTUtPm9wcmVnaW9uLnZidCkKPiA+ICAg
CQkJcmV0dXJuIHRydWU7Cj4gPiAgIAl9Cj4gPiBAQCAtMTk5MywxMiArMTk5MywxMiBAQCBib29s
IGludGVsX2Jpb3NfaXNfbHZkc19wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgdTggKmkyY19waW4pCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9iaW9zX2lzX3BvcnRf
cHJlc2VudCAtIGlzIHRoZSBzcGVjaWZpZWQgZGlnaXRhbCBwb3J0IHByZXNlbnQKPiA+IC0gKiBA
ZGV2X3ByaXY6CWk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6CWk5MTUgZGV2aWNl
IGluc3RhbmNlCj4gPiAgICAqIEBwb3J0Oglwb3J0IHRvIGNoZWNrCj4gPiAgICAqCj4gPiAgICAq
IFJldHVybiB0cnVlIGlmIHRoZSBkZXZpY2UgaW4gJXBvcnQgaXMgcHJlc2VudC4KPiA+ICAgICov
Cj4gPiAtYm9vbCBpbnRlbF9iaW9zX2lzX3BvcnRfcHJlc2VudChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KQo+ID4gK2Jvb2wgaW50ZWxfYmlvc19pc19w
b3J0X3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcG9ydCBwb3J0
KQo+ID4gICB7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgY2hpbGRfZGV2aWNlX2NvbmZpZyAqY2hpbGQ7
Cj4gPiAgIAlzdGF0aWMgY29uc3Qgc3RydWN0IHsKPiA+IEBAIC0yMDEyLDkgKzIwMTIsOSBAQCBi
b29sIGludGVsX2Jpb3NfaXNfcG9ydF9wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgZW51bSBwb3J0IHBvcgo+ID4gICAJfTsKPiA+ICAgCWludCBpOwo+ID4gLQlpZiAo
SEFTX0RESShkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19EREkoaTkxNSkpIHsKPiA+ICAgCQlj
b25zdCBzdHJ1Y3QgZGRpX3ZidF9wb3J0X2luZm8gKnBvcnRfaW5mbyA9Cj4gPiAtCQkJJmRldl9w
cml2LT52YnQuZGRpX3BvcnRfaW5mb1twb3J0XTsKPiA+ICsJCQkmaTkxNS0+dmJ0LmRkaV9wb3J0
X2luZm9bcG9ydF07Cj4gPiAgIAkJcmV0dXJuIHBvcnRfaW5mby0+c3VwcG9ydHNfZHAgfHwKPiA+
ICAgCQkgICAgICAgcG9ydF9pbmZvLT5zdXBwb3J0c19kdmkgfHwKPiA+IEBAIC0yMDI1LDExICsy
MDI1LDExIEBAIGJvb2wgaW50ZWxfYmlvc19pc19wb3J0X3ByZXNlbnQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9yCj4gPiAgIAlpZiAoV0FSTl9PTihwb3J0
ID09IFBPUlRfQSkgfHwgcG9ydCA+PSBBUlJBWV9TSVpFKHBvcnRfbWFwcGluZykpCj4gPiAgIAkJ
cmV0dXJuIGZhbHNlOwo+ID4gLQlpZiAoIWRldl9wcml2LT52YnQuY2hpbGRfZGV2X251bSkKPiA+
ICsJaWYgKCFpOTE1LT52YnQuY2hpbGRfZGV2X251bSkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4g
PiAtCWZvciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+dmJ0LmNoaWxkX2Rldl9udW07IGkrKykgewo+
ID4gLQkJY2hpbGQgPSBkZXZfcHJpdi0+dmJ0LmNoaWxkX2RldiArIGk7Cj4gPiArCWZvciAoaSA9
IDA7IGkgPCBpOTE1LT52YnQuY2hpbGRfZGV2X251bTsgaSsrKSB7Cj4gPiArCQljaGlsZCA9IGk5
MTUtPnZidC5jaGlsZF9kZXYgKyBpOwo+ID4gICAJCWlmICgoY2hpbGQtPmR2b19wb3J0ID09IHBv
cnRfbWFwcGluZ1twb3J0XS5kcCB8fAo+ID4gICAJCSAgICAgY2hpbGQtPmR2b19wb3J0ID09IHBv
cnRfbWFwcGluZ1twb3J0XS5oZG1pKSAmJgo+ID4gQEAgLTIwNDMsMTIgKzIwNDMsMTIgQEAgYm9v
bCBpbnRlbF9iaW9zX2lzX3BvcnRfcHJlc2VudChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIGVudW0gcG9ydCBwb3IKPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2Jpb3NfaXNfcG9y
dF9lZHAgLSBpcyB0aGUgZGV2aWNlIGluIGdpdmVuIHBvcnQgZURQCj4gPiAtICogQGRldl9wcml2
OglpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1OglpOTE1IGRldmljZSBpbnN0YW5j
ZQo+ID4gICAgKiBAcG9ydDoJcG9ydCB0byBjaGVjawo+ID4gICAgKgo+ID4gICAgKiBSZXR1cm4g
dHJ1ZSBpZiB0aGUgZGV2aWNlIGluICVwb3J0IGlzIGVEUC4KPiA+ICAgICovCj4gPiAtYm9vbCBp
bnRlbF9iaW9zX2lzX3BvcnRfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
ZW51bSBwb3J0IHBvcnQpCj4gPiArYm9vbCBpbnRlbF9iaW9zX2lzX3BvcnRfZWRwKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+ID4gICAJY29u
c3Qgc3RydWN0IGNoaWxkX2RldmljZV9jb25maWcgKmNoaWxkOwo+ID4gICAJc3RhdGljIGNvbnN0
IHNob3J0IHBvcnRfbWFwcGluZ1tdID0gewo+ID4gQEAgLTIwNjAsMTQgKzIwNjAsMTQgQEAgYm9v
bCBpbnRlbF9iaW9zX2lzX3BvcnRfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgZW51bSBwb3J0IHBvcnQpCj4gPiAgIAl9Owo+ID4gICAJaW50IGk7Cj4gPiAtCWlmIChIQVNf
RERJKGRldl9wcml2KSkKPiA+IC0JCXJldHVybiBkZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9b
cG9ydF0uc3VwcG9ydHNfZWRwOwo+ID4gKwlpZiAoSEFTX0RESShpOTE1KSkKPiA+ICsJCXJldHVy
biBpOTE1LT52YnQuZGRpX3BvcnRfaW5mb1twb3J0XS5zdXBwb3J0c19lZHA7Cj4gPiAtCWlmICgh
ZGV2X3ByaXYtPnZidC5jaGlsZF9kZXZfbnVtKQo+ID4gKwlpZiAoIWk5MTUtPnZidC5jaGlsZF9k
ZXZfbnVtKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IC0JZm9yIChpID0gMDsgaSA8IGRldl9w
cml2LT52YnQuY2hpbGRfZGV2X251bTsgaSsrKSB7Cj4gPiAtCQljaGlsZCA9IGRldl9wcml2LT52
YnQuY2hpbGRfZGV2ICsgaTsKPiA+ICsJZm9yIChpID0gMDsgaSA8IGk5MTUtPnZidC5jaGlsZF9k
ZXZfbnVtOyBpKyspIHsKPiA+ICsJCWNoaWxkID0gaTkxNS0+dmJ0LmNoaWxkX2RldiArIGk7Cj4g
PiAgIAkJaWYgKGNoaWxkLT5kdm9fcG9ydCA9PSBwb3J0X21hcHBpbmdbcG9ydF0gJiYKPiA+ICAg
CQkgICAgKGNoaWxkLT5kZXZpY2VfdHlwZSAmIERFVklDRV9UWVBFX2VEUF9CSVRTKSA9PQo+ID4g
QEAgLTIxMTMsMTQgKzIxMTMsMTQgQEAgc3RhdGljIGJvb2wgY2hpbGRfZGV2X2lzX2RwX2R1YWxf
bW9kZShjb25zdCBzdHJ1Y3QgY2hpbGRfZGV2aWNlX2NvbmZpZyAqY2hpbGQsCj4gPiAgIAlyZXR1
cm4gZmFsc2U7Cj4gPiAgIH0KPiA+IC1ib29sIGludGVsX2Jpb3NfaXNfcG9ydF9kcF9kdWFsX21v
ZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2Jvb2wgaW50ZWxfYmlv
c19pc19wb3J0X2RwX2R1YWxfbW9kZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+
ICAgCQkJCSAgICAgZW51bSBwb3J0IHBvcnQpCj4gPiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVjdCBj
aGlsZF9kZXZpY2VfY29uZmlnICpjaGlsZDsKPiA+ICAgCWludCBpOwo+ID4gLQlmb3IgKGkgPSAw
OyBpIDwgZGV2X3ByaXYtPnZidC5jaGlsZF9kZXZfbnVtOyBpKyspIHsKPiA+IC0JCWNoaWxkID0g
ZGV2X3ByaXYtPnZidC5jaGlsZF9kZXYgKyBpOwo+ID4gKwlmb3IgKGkgPSAwOyBpIDwgaTkxNS0+
dmJ0LmNoaWxkX2Rldl9udW07IGkrKykgewo+ID4gKwkJY2hpbGQgPSBpOTE1LT52YnQuY2hpbGRf
ZGV2ICsgaTsKPiA+ICAgCQlpZiAoY2hpbGRfZGV2X2lzX2RwX2R1YWxfbW9kZShjaGlsZCwgcG9y
dCkpCj4gPiAgIAkJCXJldHVybiB0cnVlOwo+ID4gQEAgLTIxMzEsMjAgKzIxMzEsMjAgQEAgYm9v
bCBpbnRlbF9iaW9zX2lzX3BvcnRfZHBfZHVhbF9tb2RlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2Jpb3NfaXNfZHNpX3ByZXNlbnQg
LSBpcyBEU0kgcHJlc2VudCBpbiBWQlQKPiA+IC0gKiBAZGV2X3ByaXY6CWk5MTUgZGV2aWNlIGlu
c3RhbmNlCj4gPiArICogQGk5MTU6CWk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiAgICAqIEBwb3J0
Oglwb3J0IGZvciBEU0kgaWYgcHJlc2VudAo+ID4gICAgKgo+ID4gICAgKiBSZXR1cm4gdHJ1ZSBp
ZiBEU0kgaXMgcHJlc2VudCwgYW5kIHJldHVybiB0aGUgcG9ydCBpbiAlcG9ydC4KPiA+ICAgICov
Cj4gPiAtYm9vbCBpbnRlbF9iaW9zX2lzX2RzaV9wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICtib29sIGludGVsX2Jpb3NfaXNfZHNpX3ByZXNlbnQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgICBlbnVtIHBvcnQgKnBvcnQp
Cj4gPiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVjdCBjaGlsZF9kZXZpY2VfY29uZmlnICpjaGlsZDsK
PiA+ICAgCXU4IGR2b19wb3J0Owo+ID4gICAJaW50IGk7Cj4gPiAtCWZvciAoaSA9IDA7IGkgPCBk
ZXZfcHJpdi0+dmJ0LmNoaWxkX2Rldl9udW07IGkrKykgewo+ID4gLQkJY2hpbGQgPSBkZXZfcHJp
di0+dmJ0LmNoaWxkX2RldiArIGk7Cj4gPiArCWZvciAoaSA9IDA7IGkgPCBpOTE1LT52YnQuY2hp
bGRfZGV2X251bTsgaSsrKSB7Cj4gPiArCQljaGlsZCA9IGk5MTUtPnZidC5jaGlsZF9kZXYgKyBp
Owo+ID4gICAJCWlmICghKGNoaWxkLT5kZXZpY2VfdHlwZSAmIERFVklDRV9UWVBFX01JUElfT1VU
UFVUKSkKPiA+ICAgCQkJY29udGludWU7Cj4gPiBAQCAtMjE1Miw4ICsyMTUyLDggQEAgYm9vbCBp
bnRlbF9iaW9zX2lzX2RzaV9wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgCQlkdm9fcG9ydCA9IGNoaWxkLT5kdm9fcG9ydDsKPiA+ICAgCQlpZiAoZHZvX3Bv
cnQgPT0gRFZPX1BPUlRfTUlQSUEgfHwKPiA+IC0JCSAgICAoZHZvX3BvcnQgPT0gRFZPX1BPUlRf
TUlQSUIgJiYgSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgfHwKPiA+IC0JCSAgICAoZHZvX3Bv
cnQgPT0gRFZPX1BPUlRfTUlQSUMgJiYgSU5URUxfR0VOKGRldl9wcml2KSA8IDExKSkgewo+ID4g
KwkJICAgIChkdm9fcG9ydCA9PSBEVk9fUE9SVF9NSVBJQiAmJiBJTlRFTF9HRU4oaTkxNSkgPj0g
MTEpIHx8Cj4gPiArCQkgICAgKGR2b19wb3J0ID09IERWT19QT1JUX01JUElDICYmIElOVEVMX0dF
TihpOTE1KSA8IDExKSkgewo+ID4gICAJCQlpZiAocG9ydCkKPiA+ICAgCQkJCSpwb3J0ID0gZHZv
X3BvcnQgLSBEVk9fUE9SVF9NSVBJQTsKPiA+ICAgCQkJcmV0dXJuIHRydWU7Cj4gPiBAQCAtMjIw
NSwxMSArMjIwNSwxMSBAQCBpbnRlbF9iaW9zX2lzX2xzcGNvbl9wcmVzZW50KGNvbnN0IHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJcmV0dXJuIEhBU19MU1BDT04oaTkxNSkg
JiYgY2hpbGQgJiYgY2hpbGQtPmxzcGNvbjsKPiA+ICAgfQo+ID4gLWVudW0gYXV4X2NoIGludGVs
X2Jpb3NfcG9ydF9hdXhfY2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
K2VudW0gYXV4X2NoIGludGVsX2Jpb3NfcG9ydF9hdXhfY2goc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCQkgICBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+ID4gICAJY29u
c3Qgc3RydWN0IGRkaV92YnRfcG9ydF9pbmZvICppbmZvID0KPiA+IC0JCSZkZXZfcHJpdi0+dmJ0
LmRkaV9wb3J0X2luZm9bcG9ydF07Cj4gPiArCQkmaTkxNS0+dmJ0LmRkaV9wb3J0X2luZm9bcG9y
dF07Cj4gPiAgIAllbnVtIGF1eF9jaCBhdXhfY2g7Cj4gPiAgIAlpZiAoIWluZm8tPmFsdGVybmF0
ZV9hdXhfY2hhbm5lbCkgewo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2Jpb3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Jpb3MuaAo+ID4gaW5kZXgg
NGU0MmNmYWY2MWE3Li5kMjkyYmQxNzkwYWUgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9iaW9zLmgKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2Jpb3MuaAo+ID4gQEAgLTIyNiwxOSArMjI2LDE5IEBAIHN0cnVjdCBtaXBpX3Bwc19kYXRhIHsK
PiA+ICAgCXUxNiBwYW5lbF9wb3dlcl9jeWNsZV9kZWxheTsKPiA+ICAgfSBfX3BhY2tlZDsKPiA+
IC12b2lkIGludGVsX2Jpb3NfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+ID4gLXZvaWQgaW50ZWxfYmlvc19jbGVhbnVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gPiArdm9pZCBpbnRlbF9iaW9zX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfYmlvc19jbGVhbnVwKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KTsKPiA+ICAgYm9vbCBpbnRlbF9iaW9zX2lzX3ZhbGlkX3ZidChjb25zdCB2
b2lkICpidWYsIHNpemVfdCBzaXplKTsKPiA+IC1ib29sIGludGVsX2Jpb3NfaXNfdHZfcHJlc2Vu
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLWJvb2wgaW50ZWxfYmlv
c19pc19sdmRzX3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCAq
aTJjX3Bpbik7Cj4gPiAtYm9vbCBpbnRlbF9iaW9zX2lzX3BvcnRfcHJlc2VudChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KTsKPiA+IC1ib29sIGludGVs
X2Jpb3NfaXNfcG9ydF9lZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVt
IHBvcnQgcG9ydCk7Cj4gPiAtYm9vbCBpbnRlbF9iaW9zX2lzX3BvcnRfZHBfZHVhbF9tb2RlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpOwo+ID4gLWJv
b2wgaW50ZWxfYmlvc19pc19kc2lfcHJlc2VudChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIGVudW0gcG9ydCAqcG9ydCk7Cj4gPiArYm9vbCBpbnRlbF9iaW9zX2lzX3R2X3ByZXNl
bnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK2Jvb2wgaW50ZWxfYmlvc19p
c19sdmRzX3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU4ICppMmNfcGlu
KTsKPiA+ICtib29sIGludGVsX2Jpb3NfaXNfcG9ydF9wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCk7Cj4gPiArYm9vbCBpbnRlbF9iaW9zX2lzX3Bv
cnRfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCk7Cj4g
PiArYm9vbCBpbnRlbF9iaW9zX2lzX3BvcnRfZHBfZHVhbF9tb2RlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCk7Cj4gPiArYm9vbCBpbnRlbF9iaW9zX2lzX2Rz
aV9wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBvcnQgKnBvcnQp
Owo+ID4gICBib29sIGludGVsX2Jpb3NfaXNfcG9ydF9ocGRfaW52ZXJ0ZWQoY29uc3Qgc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgIGVudW0gcG9ydCBwb3J0KTsK
PiA+ICAgYm9vbCBpbnRlbF9iaW9zX2lzX2xzcGNvbl9wcmVzZW50KGNvbnN0IHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICBlbnVtIHBvcnQgcG9ydCk7Cj4gPiAtZW51
bSBhdXhfY2ggaW50ZWxfYmlvc19wb3J0X2F1eF9jaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KTsKPiA+ICtlbnVtIGF1eF9jaCBpbnRlbF9iaW9zX3Bv
cnRfYXV4X2NoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCk7
Cj4gPiAgICNlbmRpZiAvKiBfSU5URUxfQklPU19IXyAqLwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX2J3LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9i
dy5jCj4gPiBpbmRleCA3NTNhYzMxNjUwNjEuLjFhY2E0NGEyNThkMyAxMDA2NDQKPiA+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2J3LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX2J3LmMKPiA+IEBAIC0yMiwxMyArMjIsMTMgQEAgc3RydWN0IGludGVsX3Fn
dl9pbmZvIHsKPiA+ICAgCWVudW0gaW50ZWxfZHJhbV90eXBlIGRyYW1fdHlwZTsKPiA+ICAgfTsK
PiA+IC1zdGF0aWMgaW50IGljbF9wY29kZV9yZWFkX21lbV9nbG9iYWxfaW5mbyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGludCBpY2xfcGNvZGVfcmVhZF9t
ZW1fZ2xvYmFsX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJ
ICBzdHJ1Y3QgaW50ZWxfcWd2X2luZm8gKnFpKQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsID0gMDsK
PiA+ICAgCWludCByZXQ7Cj4gPiAtCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoZGV2X3By
aXYsCj4gPiArCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoaTkxNSwKPiA+ICAgCQkJCSAg
ICAgSUNMX1BDT0RFX01FTV9TVUJTWVNZU1RFTV9JTkZPIHwKPiA+ICAgCQkJCSAgICAgSUNMX1BD
T0RFX01FTV9TU19SRUFEX0dMT0JBTF9JTkZPLAo+ID4gICAJCQkJICAgICAmdmFsLCBOVUxMKTsK
PiA+IEBAIC02MSwxNCArNjEsMTQgQEAgc3RhdGljIGludCBpY2xfcGNvZGVfcmVhZF9tZW1fZ2xv
YmFsX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJcmV0dXJu
IDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IGljbF9wY29kZV9yZWFkX3Fndl9wb2ludF9pbmZv
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW50IGljbF9w
Y29kZV9yZWFkX3Fndl9wb2ludF9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ID4gICAJCQkJCSBzdHJ1Y3QgaW50ZWxfcWd2X3BvaW50ICpzcCwKPiA+ICAgCQkJCQkgaW50IHBv
aW50KQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsID0gMCwgdmFsMjsKPiA+ICAgCWludCByZXQ7Cj4g
PiAtCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoZGV2X3ByaXYsCj4gPiArCXJldCA9IHNh
bmR5YnJpZGdlX3Bjb2RlX3JlYWQoaTkxNSwKPiA+ICAgCQkJCSAgICAgSUNMX1BDT0RFX01FTV9T
VUJTWVNZU1RFTV9JTkZPIHwKPiA+ICAgCQkJCSAgICAgSUNMX1BDT0RFX01FTV9TU19SRUFEX1FH
Vl9QT0lOVF9JTkZPKHBvaW50KSwKPiA+ICAgCQkJCSAgICAgJnZhbCwgJnZhbDIpOwo+ID4gQEAg
LTg3LDEyICs4NywxMiBAQCBzdGF0aWMgaW50IGljbF9wY29kZV9yZWFkX3Fndl9wb2ludF9pbmZv
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXJldHVybiAwOwo+ID4g
ICB9Cj4gPiAtc3RhdGljIGludCBpY2xfZ2V0X3Fndl9wb2ludHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBpbnQgaWNsX2dldF9xZ3ZfcG9pbnRzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgICBzdHJ1Y3QgaW50ZWxfcWd2
X2luZm8gKnFpKQo+ID4gICB7Cj4gPiAgIAlpbnQgaSwgcmV0Owo+ID4gLQlyZXQgPSBpY2xfcGNv
ZGVfcmVhZF9tZW1fZ2xvYmFsX2luZm8oZGV2X3ByaXYsIHFpKTsKPiA+ICsJcmV0ID0gaWNsX3Bj
b2RlX3JlYWRfbWVtX2dsb2JhbF9pbmZvKGk5MTUsIHFpKTsKPiA+ICAgCWlmIChyZXQpCj4gPiAg
IAkJcmV0dXJuIHJldDsKPiA+IEBAIC0xMDIsNyArMTAyLDcgQEAgc3RhdGljIGludCBpY2xfZ2V0
X3Fndl9wb2ludHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJZm9y
IChpID0gMDsgaSA8IHFpLT5udW1fcG9pbnRzOyBpKyspIHsKPiA+ICAgCQlzdHJ1Y3QgaW50ZWxf
cWd2X3BvaW50ICpzcCA9ICZxaS0+cG9pbnRzW2ldOwo+ID4gLQkJcmV0ID0gaWNsX3Bjb2RlX3Jl
YWRfcWd2X3BvaW50X2luZm8oZGV2X3ByaXYsIHNwLCBpKTsKPiA+ICsJCXJldCA9IGljbF9wY29k
ZV9yZWFkX3Fndl9wb2ludF9pbmZvKGk5MTUsIHNwLCBpKTsKPiA+ICAgCQlpZiAocmV0KQo+ID4g
ICAJCQlyZXR1cm4gcmV0Owo+ID4gQEAgLTE0Miw3ICsxNDIsNyBAQCBzdGF0aWMgY29uc3Qgc3Ry
dWN0IGludGVsX3NhX2luZm8gaWNsX3NhX2luZm8gPSB7Cj4gPiAgIAkuZGlzcGxheXJ0aWRzID0g
MTI4LAo+ID4gICB9Owo+ID4gLXN0YXRpYyBpbnQgaWNsX2dldF9id19pbmZvKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgaW50IGljbF9nZXRfYndfaW5mbyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVs
X3Fndl9pbmZvIHFpID0ge307Cj4gPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfc2FfaW5mbyAqc2Eg
PSAmaWNsX3NhX2luZm87Cj4gPiBAQCAtMTU0LDcgKzE1NCw3IEBAIHN0YXRpYyBpbnQgaWNsX2dl
dF9id19pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCWludCBt
YXhkZWJ3Owo+ID4gICAJaW50IGksIHJldDsKPiA+IC0JcmV0ID0gaWNsX2dldF9xZ3ZfcG9pbnRz
KGRldl9wcml2LCAmcWkpOwo+ID4gKwlyZXQgPSBpY2xfZ2V0X3Fndl9wb2ludHMoaTkxNSwgJnFp
KTsKPiA+ICAgCWlmIChyZXQpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJGYWlsZWQgdG8gZ2V0
IG1lbW9yeSBzdWJzeXN0ZW0gaW5mb3JtYXRpb24sIGlnbm9yaW5nIGJhbmR3aWR0aCBsaW1pdHMi
KTsKPiA+ICAgCQlyZXR1cm4gcmV0Owo+ID4gQEAgLTE3MCw4ICsxNzAsOCBAQCBzdGF0aWMgaW50
IGljbF9nZXRfYndfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAg
IAkJICAgICAgaWNsX2NhbGNfYncoZGNsa19tYXgsIDE2LCAxKSAqIDYgLyAxMCk7IC8qIDYwJSAq
Lwo+ID4gICAJaXBxZGVwdGggPSBtaW4oaXBxZGVwdGhwY2gsIHNhLT5kaXNwbGF5cnRpZHMgLyBu
dW1fY2hhbm5lbHMpOwo+ID4gLQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShkZXZfcHJpdi0+
bWF4X2J3KTsgaSsrKSB7Cj4gPiAtCQlzdHJ1Y3QgaW50ZWxfYndfaW5mbyAqYmkgPSAmZGV2X3By
aXYtPm1heF9id1tpXTsKPiA+ICsJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoaTkxNS0+bWF4
X2J3KTsgaSsrKSB7Cj4gPiArCQlzdHJ1Y3QgaW50ZWxfYndfaW5mbyAqYmkgPSAmaTkxNS0+bWF4
X2J3W2ldOwo+ID4gICAJCWludCBjbHBjaGdyb3VwOwo+ID4gICAJCWludCBqOwo+ID4gQEAgLTIw
NiwxOCArMjA2LDE4IEBAIHN0YXRpYyBpbnQgaWNsX2dldF9id19pbmZvKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IHVuc2lnbmVkIGludCBpY2xfbWF4X2J3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICtzdGF0aWMgdW5zaWduZWQgaW50IGljbF9tYXhfYncoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgICBpbnQgbnVtX3BsYW5lcywgaW50IHFndl9wb2lu
dCkKPiA+ICAgewo+ID4gICAJaW50IGk7Cj4gPiAgIAkvKiBEaWQgd2UgaW5pdGlhbGl6ZSB0aGUg
YncgbGltaXRzIHN1Y2Nlc3NmdWxseT8gKi8KPiA+IC0JaWYgKGRldl9wcml2LT5tYXhfYndbMF0u
bnVtX3BsYW5lcyA9PSAwKQo+ID4gKwlpZiAoaTkxNS0+bWF4X2J3WzBdLm51bV9wbGFuZXMgPT0g
MCkKPiA+ICAgCQlyZXR1cm4gVUlOVF9NQVg7Cj4gPiAtCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9T
SVpFKGRldl9wcml2LT5tYXhfYncpOyBpKyspIHsKPiA+ICsJZm9yIChpID0gMDsgaSA8IEFSUkFZ
X1NJWkUoaTkxNS0+bWF4X2J3KTsgaSsrKSB7Cj4gPiAgIAkJY29uc3Qgc3RydWN0IGludGVsX2J3
X2luZm8gKmJpID0KPiA+IC0JCQkmZGV2X3ByaXYtPm1heF9id1tpXTsKPiA+ICsJCQkmaTkxNS0+
bWF4X2J3W2ldOwo+ID4gICAJCWlmIChudW1fcGxhbmVzID49IGJpLT5udW1fcGxhbmVzKQo+ID4g
ICAJCQlyZXR1cm4gYmktPmRlcmF0ZWRid1txZ3ZfcG9pbnRdOwo+ID4gQEAgLTIyNiwyNCArMjI2
LDI0IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgaWNsX21heF9idyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxf
YndfaW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBp
bnRlbF9id19pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDExKSkKPiA+IC0JCWljbF9nZXRfYndfaW5mbyhkZXZf
cHJpdik7Cj4gPiArCWlmIChJU19HRU4oaTkxNSwgMTEpKQo+ID4gKwkJaWNsX2dldF9id19pbmZv
KGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9tYXhfZGF0YV9y
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdW5zaWdu
ZWQgaW50IGludGVsX21heF9kYXRhX3JhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gPiAgIAkJCQkJaW50IG51bV9wbGFuZXMpCj4gPiAgIHsKPiA+IC0JaWYgKElTX0dFTihkZXZf
cHJpdiwgMTEpKQo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDExKSkKPiA+ICAgCQkvKgo+ID4gICAJ
CSAqIEZJWE1FIHdpdGggU0FHViBkaXNhYmxlZCBtYXliZSB3ZSBjYW4gYXNzdW1lCj4gPiAgIAkJ
ICogcG9pbnQgMSB3aWxsIGFsd2F5cyBiZSB1c2VkPyBTZWVtcyB0byBtYXRjaAo+ID4gICAJCSAq
IHRoZSBiZWhhdmlvdXIgb2JzZXJ2ZWQgaW4gdGhlIHdpbGQuCj4gPiAgIAkJICovCj4gPiAtCQly
ZXR1cm4gbWluMyhpY2xfbWF4X2J3KGRldl9wcml2LCBudW1fcGxhbmVzLCAwKSwKPiA+IC0JCQkg
ICAgaWNsX21heF9idyhkZXZfcHJpdiwgbnVtX3BsYW5lcywgMSksCj4gPiAtCQkJICAgIGljbF9t
YXhfYncoZGV2X3ByaXYsIG51bV9wbGFuZXMsIDIpKTsKPiA+ICsJCXJldHVybiBtaW4zKGljbF9t
YXhfYncoaTkxNSwgbnVtX3BsYW5lcywgMCksCj4gPiArCQkJICAgIGljbF9tYXhfYncoaTkxNSwg
bnVtX3BsYW5lcywgMSksCj4gPiArCQkJICAgIGljbF9tYXhfYncoaTkxNSwgbnVtX3BsYW5lcywg
MikpOwo+ID4gICAJZWxzZQo+ID4gICAJCXJldHVybiBVSU5UX01BWDsKPiA+ICAgfQo+ID4gQEAg
LTI5MywyNSArMjkzLDI1IEBAIHZvaWQgaW50ZWxfYndfY3J0Y191cGRhdGUoc3RydWN0IGludGVs
X2J3X3N0YXRlICpid19zdGF0ZSwKPiA+ICAgCQkgICAgICBid19zdGF0ZS0+bnVtX2FjdGl2ZV9w
bGFuZXNbY3J0Yy0+cGlwZV0pOwo+ID4gICB9Cj4gPiAtc3RhdGljIHVuc2lnbmVkIGludCBpbnRl
bF9id19udW1fYWN0aXZlX3BsYW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiArc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9id19udW1fYWN0aXZlX3BsYW5lcyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICAgICAgY29uc3Qgc3RydWN0
IGludGVsX2J3X3N0YXRlICpid19zdGF0ZSkKPiA+ICAgewo+ID4gICAJdW5zaWduZWQgaW50IG51
bV9hY3RpdmVfcGxhbmVzID0gMDsKPiA+ICAgCWVudW0gcGlwZSBwaXBlOwo+ID4gLQlmb3JfZWFj
aF9waXBlKGRldl9wcml2LCBwaXBlKQo+ID4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpCj4g
PiAgIAkJbnVtX2FjdGl2ZV9wbGFuZXMgKz0gYndfc3RhdGUtPm51bV9hY3RpdmVfcGxhbmVzW3Bp
cGVdOwo+ID4gICAJcmV0dXJuIG51bV9hY3RpdmVfcGxhbmVzOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IHVuc2lnbmVkIGludCBpbnRlbF9id19kYXRhX3JhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gK3N0YXRpYyB1bnNpZ25lZCBpbnQgaW50ZWxfYndfZGF0YV9yYXRlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9id19zdGF0ZSAqYndfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXVuc2lnbmVkIGludCBk
YXRhX3JhdGUgPSAwOwo+ID4gICAJZW51bSBwaXBlIHBpcGU7Cj4gPiAtCWZvcl9lYWNoX3BpcGUo
ZGV2X3ByaXYsIHBpcGUpCj4gPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkKPiA+ICAgCQlk
YXRhX3JhdGUgKz0gYndfc3RhdGUtPmRhdGFfcmF0ZVtwaXBlXTsKPiA+ICAgCXJldHVybiBkYXRh
X3JhdGU7Cj4gPiBAQCAtMzE5LDcgKzMxOSw3IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgaW50ZWxf
YndfZGF0YV9yYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgaW50
IGludGVsX2J3X2F0b21pY19jaGVjayhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KHN0YXRlLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUg
Km5ld19jcnRjX3N0YXRlLCAqb2xkX2NydGNfc3RhdGU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfYndf
c3RhdGUgKmJ3X3N0YXRlID0gTlVMTDsKPiA+ICAgCXVuc2lnbmVkIGludCBkYXRhX3JhdGUsIG1h
eF9kYXRhX3JhdGU7Cj4gPiBAQCAtMzI4LDcgKzMyOCw3IEBAIGludCBpbnRlbF9id19hdG9taWNf
Y2hlY2soc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIAlpbnQgaTsKPiA+
ICAgCS8qIEZJWE1FIGVhcmxpZXIgZ2VucyBuZWVkIHNvbWUgY2hlY2tzIHRvbyAqLwo+ID4gLQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDExKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwg
MTEpCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAgIAlmb3JfZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19p
bl9zdGF0ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsCj4gPiBAQCAtMzY2LDEwICszNjYs
MTAgQEAgaW50IGludGVsX2J3X2F0b21pY19jaGVjayhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
ICpzdGF0ZSkKPiA+ICAgCWlmICghYndfc3RhdGUpCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAtCWRh
dGFfcmF0ZSA9IGludGVsX2J3X2RhdGFfcmF0ZShkZXZfcHJpdiwgYndfc3RhdGUpOwo+ID4gLQlu
dW1fYWN0aXZlX3BsYW5lcyA9IGludGVsX2J3X251bV9hY3RpdmVfcGxhbmVzKGRldl9wcml2LCBi
d19zdGF0ZSk7Cj4gPiArCWRhdGFfcmF0ZSA9IGludGVsX2J3X2RhdGFfcmF0ZShpOTE1LCBid19z
dGF0ZSk7Cj4gPiArCW51bV9hY3RpdmVfcGxhbmVzID0gaW50ZWxfYndfbnVtX2FjdGl2ZV9wbGFu
ZXMoaTkxNSwgYndfc3RhdGUpOwo+ID4gLQltYXhfZGF0YV9yYXRlID0gaW50ZWxfbWF4X2RhdGFf
cmF0ZShkZXZfcHJpdiwgbnVtX2FjdGl2ZV9wbGFuZXMpOwo+ID4gKwltYXhfZGF0YV9yYXRlID0g
aW50ZWxfbWF4X2RhdGFfcmF0ZShpOTE1LCBudW1fYWN0aXZlX3BsYW5lcyk7Cj4gPiAgIAlkYXRh
X3JhdGUgPSBESVZfUk9VTkRfVVAoZGF0YV9yYXRlLCAxMDAwKTsKPiA+IEBAIC00MDYsNyArNDA2
LDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcHJpdmF0ZV9zdGF0ZV9mdW5jcyBpbnRlbF9i
d19mdW5jcyA9IHsKPiA+ICAgCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9IGludGVsX2J3X2Rlc3Ry
b3lfc3RhdGUsCj4gPiAgIH07Cj4gPiAtaW50IGludGVsX2J3X2luaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludCBpbnRlbF9id19pbml0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfYndfc3RhdGUgKnN0
YXRlOwo+ID4gQEAgLTQxNCw3ICs0MTQsNyBAQCBpbnQgaW50ZWxfYndfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlpZiAoIXN0YXRlKQo+ID4gICAJCXJldHVy
biAtRU5PTUVNOwo+ID4gLQlkcm1fYXRvbWljX3ByaXZhdGVfb2JqX2luaXQoJmRldl9wcml2LT5k
cm0sICZkZXZfcHJpdi0+Yndfb2JqLAo+ID4gKwlkcm1fYXRvbWljX3ByaXZhdGVfb2JqX2luaXQo
Jmk5MTUtPmRybSwgJmk5MTUtPmJ3X29iaiwKPiA+ICAgCQkJCSAgICAmc3RhdGUtPmJhc2UsICZp
bnRlbF9id19mdW5jcyk7Cj4gPiAgIAlyZXR1cm4gMDsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9idy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfYncu
aAo+ID4gaW5kZXggZTlkOWM2ZDYzYmMzLi4zOTZlNTAyOWY5YTQgMTAwNjQ0Cj4gPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9idy5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9idy5oCj4gPiBAQCAtMjcsMTkgKzI3LDE5IEBAIHN0cnVjdCBpbnRlbF9id19z
dGF0ZSB7Cj4gPiAgIHN0YXRpYyBpbmxpbmUgc3RydWN0IGludGVsX2J3X3N0YXRlICoKPiA+ICAg
aW50ZWxfYXRvbWljX2dldF9id19zdGF0ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KHN0YXRlLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGRybV9wcml2YXRlX3N0
YXRlICpid19zdGF0ZTsKPiA+ICAgCWJ3X3N0YXRlID0gZHJtX2F0b21pY19nZXRfcHJpdmF0ZV9v
Ympfc3RhdGUoJnN0YXRlLT5iYXNlLAo+ID4gLQkJCQkJCSAgICAmZGV2X3ByaXYtPmJ3X29iaik7
Cj4gPiArCQkJCQkJICAgICZpOTE1LT5id19vYmopOwo+ID4gICAJaWYgKElTX0VSUihid19zdGF0
ZSkpCj4gPiAgIAkJcmV0dXJuIEVSUl9DQVNUKGJ3X3N0YXRlKTsKPiA+ICAgCXJldHVybiB0b19p
bnRlbF9id19zdGF0ZShid19zdGF0ZSk7Cj4gPiAgIH0KPiA+IC12b2lkIGludGVsX2J3X2luaXRf
aHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC1pbnQgaW50ZWxfYndf
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3ZvaWQgaW50ZWxf
YndfaW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAraW50IGludGVs
X2J3X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICBpbnQgaW50ZWxf
YndfYXRvbWljX2NoZWNrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKTsKPiA+ICAg
dm9pZCBpbnRlbF9id19jcnRjX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfYndfc3RhdGUgKmJ3X3N0YXRl
LAo+ID4gICAJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsK
PiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jZGNsay5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY2RjbGsuYwo+ID4gaW5kZXggODk5M2FiMjgzNTYyLi4w
MmM2MTcxODBjNGIgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9j
ZGNsay5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jZGNsay5jCj4gPiBA
QCAtNTMsNDYgKzUzLDQ2IEBACj4gPiAgICAqIGRpdmlkZXJzIGNhbiBiZSBwcm9ncmFtbWVkIGNv
cnJlY3RseS4KPiA+ICAgICovCj4gPiAtc3RhdGljIHZvaWQgZml4ZWRfMTMzbWh6X2dldF9jZGNs
ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgZml4
ZWRfMTMzbWh6X2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJCSAgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4gPiAgIHsKPiA+
ICAgCWNkY2xrX3N0YXRlLT5jZGNsayA9IDEzMzMzMzsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lk
IGZpeGVkXzIwMG1oel9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gK3N0YXRpYyB2b2lkIGZpeGVkXzIwMG1oel9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNk
Y2xrX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAljZGNsa19zdGF0ZS0+Y2RjbGsgPSAyMDAwMDA7Cj4g
PiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBmaXhlZF8yNjZtaHpfZ2V0X2NkY2xrKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBmaXhlZF8yNjZtaHpfZ2V0
X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgc3RydWN0
IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSkKPiA+ICAgewo+ID4gICAJY2RjbGtfc3Rh
dGUtPmNkY2xrID0gMjY2NjY3Owo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZml4ZWRfMzMzbWh6
X2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGlj
IHZvaWQgZml4ZWRfMzMzbWh6X2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4g
PiAgIHsKPiA+ICAgCWNkY2xrX3N0YXRlLT5jZGNsayA9IDMzMzMzMzsKPiA+ICAgfQo+ID4gLXN0
YXRpYyB2b2lkIGZpeGVkXzQwMG1oel9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGZpeGVkXzQwMG1oel9nZXRfY2RjbGsoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICBzdHJ1Y3QgaW50ZWxfY2RjbGtf
c3RhdGUgKmNkY2xrX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAljZGNsa19zdGF0ZS0+Y2RjbGsgPSA0
MDAwMDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBmaXhlZF80NTBtaHpfZ2V0X2NkY2xrKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBmaXhlZF80
NTBtaHpfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJ
ICAgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSkKPiA+ICAgewo+ID4gICAJ
Y2RjbGtfc3RhdGUtPmNkY2xrID0gNDUwMDAwOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaTg1
eF9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRp
YyB2b2lkIGk4NXhfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4g
ICAJCQkgICBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ID4gKwlzdHJ1
Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2Owo+ID4gICAJdTE2IGhwbGxjYyA9IDA7
Cj4gPiAgIAkvKgo+ID4gQEAgLTEzMSwxMCArMTMxLDEwIEBAIHN0YXRpYyB2b2lkIGk4NXhfZ2V0
X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCX0KPiA+ICAg
fQo+ID4gLXN0YXRpYyB2b2lkIGk5MTVnbV9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGk5MTVnbV9nZXRfY2RjbGsoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgc3RydWN0IGludGVsX2NkY2xrX3N0
YXRlICpjZGNsa19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRl
dl9wcml2LT5kcm0ucGRldjsKPiA+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0u
cGRldjsKPiA+ICAgCXUxNiBnY2ZnYyA9IDA7Cj4gPiAgIAlwY2lfcmVhZF9jb25maWdfd29yZChw
ZGV2LCBHQ0ZHQywgJmdjZmdjKTsKPiA+IEBAIC0xNTUsMTAgKzE1NSwxMCBAQCBzdGF0aWMgdm9p
ZCBpOTE1Z21fZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICAgCX0KPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGk5NDVnbV9nZXRfY2RjbGsoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGk5NDVnbV9nZXRfY2Rj
bGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgc3RydWN0IGlu
dGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgcGNpX2Rl
diAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiA+ICsJc3RydWN0IHBjaV9kZXYgKnBkZXYg
PSBpOTE1LT5kcm0ucGRldjsKPiA+ICAgCXUxNiBnY2ZnYyA9IDA7Cj4gPiAgIAlwY2lfcmVhZF9j
b25maWdfd29yZChwZGV2LCBHQ0ZHQywgJmdjZmdjKTsKPiA+IEBAIC0xNzksNyArMTc5LDcgQEAg
c3RhdGljIHZvaWQgaTk0NWdtX2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdW5zaWduZWQgaW50IGludGVsX2hw
bGxfdmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdW5z
aWduZWQgaW50IGludGVsX2hwbGxfdmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAgIAlzdGF0aWMgY29uc3QgdW5zaWduZWQgaW50IGJsYl92Y29bOF0gPSB7Cj4g
PiAgIAkJWzBdID0gMzIwMDAwMCwKPiA+IEBAIC0yMjMsMjAgKzIyMywyMCBAQCBzdGF0aWMgdW5z
aWduZWQgaW50IGludGVsX2hwbGxfdmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICAgCXU4IHRtcCA9IDA7Cj4gPiAgIAkvKiBGSVhNRSBvdGhlciBjaGlwc2V0cz8gKi8K
PiA+IC0JaWYgKElTX0dNNDUoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfR000NShpOTE1KSkKPiA+
ICAgCQl2Y29fdGFibGUgPSBjdGdfdmNvOwo+ID4gLQllbHNlIGlmIChJU19HNDUoZGV2X3ByaXYp
KQo+ID4gKwllbHNlIGlmIChJU19HNDUoaTkxNSkpCj4gPiAgIAkJdmNvX3RhYmxlID0gZWxrX3Zj
bzsKPiA+IC0JZWxzZSBpZiAoSVNfSTk2NUdNKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSVNf
STk2NUdNKGk5MTUpKQo+ID4gICAJCXZjb190YWJsZSA9IGNsX3ZjbzsKPiA+IC0JZWxzZSBpZiAo
SVNfUElORVZJRVcoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19QSU5FVklFVyhpOTE1KSkK
PiA+ICAgCQl2Y29fdGFibGUgPSBwbnZfdmNvOwo+ID4gLQllbHNlIGlmIChJU19HMzMoZGV2X3By
aXYpKQo+ID4gKwllbHNlIGlmIChJU19HMzMoaTkxNSkpCj4gPiAgIAkJdmNvX3RhYmxlID0gYmxi
X3ZjbzsKPiA+ICAgCWVsc2UKPiA+ICAgCQlyZXR1cm4gMDsKPiA+IC0JdG1wID0gSTkxNV9SRUFE
KElTX1BJTkVWSUVXKGRldl9wcml2KSB8fCBJU19NT0JJTEUoZGV2X3ByaXYpID8KPiA+ICsJdG1w
ID0gSTkxNV9SRUFEKElTX1BJTkVWSUVXKGk5MTUpIHx8IElTX01PQklMRShpOTE1KSA/Cj4gPiAg
IAkJCUhQTExWQ09fTU9CSUxFIDogSFBMTFZDTyk7Cj4gPiAgIAl2Y28gPSB2Y29fdGFibGVbdG1w
ICYgMHg3XTsKPiA+IEBAIC0yNDgsMTAgKzI0OCwxMCBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGlu
dGVsX2hwbGxfdmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXJl
dHVybiB2Y287Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnMzNfZ2V0X2NkY2xrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBnMzNfZ2V0X2NkY2xr
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgIHN0cnVjdCBpbnRlbF9j
ZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IHBjaV9kZXYgKnBk
ZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkx
NS0+ZHJtLnBkZXY7Cj4gPiAgIAlzdGF0aWMgY29uc3QgdTggZGl2XzMyMDBbXSA9IHsgMTIsIDEw
LCAgOCwgIDcsIDUsIDE2IH07Cj4gPiAgIAlzdGF0aWMgY29uc3QgdTggZGl2XzQwMDBbXSA9IHsg
MTQsIDEyLCAxMCwgIDgsIDYsIDIwIH07Cj4gPiAgIAlzdGF0aWMgY29uc3QgdTggZGl2XzQ4MDBb
XSA9IHsgMjAsIDE0LCAxMiwgMTAsIDgsIDI0IH07Cj4gPiBAQCAtMjYwLDcgKzI2MCw3IEBAIHN0
YXRpYyB2b2lkIGczM19nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gICAJdW5zaWduZWQgaW50IGNkY2xrX3NlbDsKPiA+ICAgCXUxNiB0bXAgPSAwOwo+ID4g
LQljZGNsa19zdGF0ZS0+dmNvID0gaW50ZWxfaHBsbF92Y28oZGV2X3ByaXYpOwo+ID4gKwljZGNs
a19zdGF0ZS0+dmNvID0gaW50ZWxfaHBsbF92Y28oaTkxNSk7Cj4gPiAgIAlwY2lfcmVhZF9jb25m
aWdfd29yZChwZGV2LCBHQ0ZHQywgJnRtcCk7Cj4gPiBAQCAtMjk2LDEwICsyOTYsMTAgQEAgc3Rh
dGljIHZvaWQgZzMzX2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiAgIAljZGNsa19zdGF0ZS0+Y2RjbGsgPSAxOTA0NzY7Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
dm9pZCBwbnZfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICtzdGF0aWMgdm9pZCBwbnZfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ID4gICAJCQkgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gPiAr
CXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiAgIAl1MTYgZ2NmZ2Mg
PSAwOwo+ID4gICAJcGNpX3JlYWRfY29uZmlnX3dvcmQocGRldiwgR0NGR0MsICZnY2ZnYyk7Cj4g
PiBAQCAtMzI5LDEwICszMjksMTAgQEAgc3RhdGljIHZvaWQgcG52X2dldF9jZGNsayhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
dm9pZCBpOTY1Z21fZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICtzdGF0aWMgdm9pZCBpOTY1Z21fZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ID4gICAJCQkgICAgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3Rh
dGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBk
ZXY7Cj4gPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiAgIAlz
dGF0aWMgY29uc3QgdTggZGl2XzMyMDBbXSA9IHsgMTYsIDEwLCAgOCB9Owo+ID4gICAJc3RhdGlj
IGNvbnN0IHU4IGRpdl80MDAwW10gPSB7IDIwLCAxMiwgMTAgfTsKPiA+ICAgCXN0YXRpYyBjb25z
dCB1OCBkaXZfNTMzM1tdID0geyAyNCwgMTYsIDE0IH07Cj4gPiBAQCAtMzQwLDcgKzM0MCw3IEBA
IHN0YXRpYyB2b2lkIGk5NjVnbV9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAJdW5zaWduZWQgaW50IGNkY2xrX3NlbDsKPiA+ICAgCXUxNiB0bXAgPSAw
Owo+ID4gLQljZGNsa19zdGF0ZS0+dmNvID0gaW50ZWxfaHBsbF92Y28oZGV2X3ByaXYpOwo+ID4g
KwljZGNsa19zdGF0ZS0+dmNvID0gaW50ZWxfaHBsbF92Y28oaTkxNSk7Cj4gPiAgIAlwY2lfcmVh
ZF9jb25maWdfd29yZChwZGV2LCBHQ0ZHQywgJnRtcCk7Cj4gPiBAQCAtMzczLDE0ICszNzMsMTQg
QEAgc3RhdGljIHZvaWQgaTk2NWdtX2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiAgIAljZGNsa19zdGF0ZS0+Y2RjbGsgPSAyMDAwMDA7Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgdm9pZCBnbTQ1X2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgZ200NV9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtf
c3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJt
LnBkZXY7Cj4gPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiAg
IAl1bnNpZ25lZCBpbnQgY2RjbGtfc2VsOwo+ID4gICAJdTE2IHRtcCA9IDA7Cj4gPiAtCWNkY2xr
X3N0YXRlLT52Y28gPSBpbnRlbF9ocGxsX3ZjbyhkZXZfcHJpdik7Cj4gPiArCWNkY2xrX3N0YXRl
LT52Y28gPSBpbnRlbF9ocGxsX3ZjbyhpOTE1KTsKPiA+ICAgCXBjaV9yZWFkX2NvbmZpZ193b3Jk
KHBkZXYsIEdDRkdDLCAmdG1wKTsKPiA+IEBAIC00MDMsNyArNDAzLDcgQEAgc3RhdGljIHZvaWQg
Z200NV9nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
fQo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaHN3X2dldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaHN3X2dldF9jZGNsayhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3Rh
dGUgKmNkY2xrX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAl1MzIgbGNwbGwgPSBJOTE1X1JFQUQoTENQ
TExfQ1RMKTsKPiA+IEBAIC00MTUsMTUgKzQxNSwxNSBAQCBzdGF0aWMgdm9pZCBoc3dfZ2V0X2Nk
Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQljZGNsa19zdGF0
ZS0+Y2RjbGsgPSA0NTAwMDA7Cj4gPiAgIAllbHNlIGlmIChmcmVxID09IExDUExMX0NMS19GUkVR
XzQ1MCkKPiA+ICAgCQljZGNsa19zdGF0ZS0+Y2RjbGsgPSA0NTAwMDA7Cj4gPiAtCWVsc2UgaWYg
KElTX0hTV19VTFQoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19IU1dfVUxUKGk5MTUpKQo+
ID4gICAJCWNkY2xrX3N0YXRlLT5jZGNsayA9IDMzNzUwMDsKPiA+ICAgCWVsc2UKPiA+ICAgCQlj
ZGNsa19zdGF0ZS0+Y2RjbGsgPSA1NDAwMDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IHZsdl9j
YWxjX2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IG1pbl9jZGNs
aykKPiA+ICtzdGF0aWMgaW50IHZsdl9jYWxjX2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCBpbnQgbWluX2NkY2xrKQo+ID4gICB7Cj4gPiAtCWludCBmcmVxXzMyMCA9IChkZXZf
cHJpdi0+aHBsbF9mcmVxIDw8ICAxKSAlIDMyMDAwMCAhPSAwID8KPiA+ICsJaW50IGZyZXFfMzIw
ID0gKGk5MTUtPmhwbGxfZnJlcSA8PCAgMSkgJSAzMjAwMDAgIT0gMCA/Cj4gPiAgIAkJMzMzMzMz
IDogMzIwMDAwOwo+ID4gICAJLyoKPiA+IEBAIC00MzEsNyArNDMxLDcgQEAgc3RhdGljIGludCB2
bHZfY2FsY19jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBtaW5f
Y2RjbGspCj4gPiAgIAkgKiBOb3Qgc3VyZSB3aGF0J3Mgd3JvbmcuIEZvciBub3cgdXNlIDIwME1I
eiBvbmx5IHdoZW4gYWxsIHBpcGVzCj4gPiAgIAkgKiBhcmUgb2ZmLgo+ID4gICAJICovCj4gPiAt
CWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSAmJiBtaW5fY2RjbGsgPiBmcmVxXzMyMCkKPiA+
ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgJiYgbWluX2NkY2xrID4gZnJlcV8zMjApCj4gPiAg
IAkJcmV0dXJuIDQwMDAwMDsKPiA+ICAgCWVsc2UgaWYgKG1pbl9jZGNsayA+IDI2NjY2NykKPiA+
ICAgCQlyZXR1cm4gZnJlcV8zMjA7Cj4gPiBAQCAtNDQxLDkgKzQ0MSw5IEBAIHN0YXRpYyBpbnQg
dmx2X2NhbGNfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgbWlu
X2NkY2xrKQo+ID4gICAJCXJldHVybiAyMDAwMDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTggdmx2
X2NhbGNfdm9sdGFnZV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGlu
dCBjZGNsaykKPiA+ICtzdGF0aWMgdTggdmx2X2NhbGNfdm9sdGFnZV9sZXZlbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IGNkY2xrKQo+ID4gICB7Cj4gPiAtCWlmIChJU19WQUxM
RVlWSUVXKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkgewo+ID4g
ICAJCWlmIChjZGNsayA+PSAzMjAwMDApIC8qIGp1bXAgdG8gaGlnaGVzdCB2b2x0YWdlIGZvciA0
MDBNSHogdG9vICovCj4gPiAgIAkJCXJldHVybiAyOwo+ID4gICAJCWVsc2UgaWYgKGNkY2xrID49
IDI2NjY2NykKPiA+IEBAIC00NTYsMjkgKzQ1NiwyOSBAQCBzdGF0aWMgdTggdmx2X2NhbGNfdm9s
dGFnZV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBjZGNsaykK
PiA+ICAgCQkgKiBoYXJkd2FyZSBoYXMgc2hvd24gdGhhdCB3ZSBqdXN0IG5lZWQgdG8gd3JpdGUg
dGhlIGRlc2lyZWQKPiA+ICAgCQkgKiBDQ0sgZGl2aWRlciBpbnRvIHRoZSBQdW5pdCByZWdpc3Rl
ci4KPiA+ICAgCQkgKi8KPiA+IC0JCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChkZXZfcHJpdi0+
aHBsbF9mcmVxIDw8IDEsIGNkY2xrKSAtIDE7Cj4gPiArCQlyZXR1cm4gRElWX1JPVU5EX0NMT1NF
U1QoaTkxNS0+aHBsbF9mcmVxIDw8IDEsIGNkY2xrKSAtIDE7Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgdm9pZCB2bHZfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICtzdGF0aWMgdm9pZCB2bHZfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ID4gICAJCQkgIHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3Rh
dGUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAtCXZsdl9pb3NmX3NiX2dldChkZXZfcHJp
diwKPiA+ICsJdmx2X2lvc2Zfc2JfZ2V0KGk5MTUsCj4gPiAgIAkJCUJJVChWTFZfSU9TRl9TQl9D
Q0spIHwgQklUKFZMVl9JT1NGX1NCX1BVTklUKSk7Cj4gPiAtCWNkY2xrX3N0YXRlLT52Y28gPSB2
bHZfZ2V0X2hwbGxfdmNvKGRldl9wcml2KTsKPiA+IC0JY2RjbGtfc3RhdGUtPmNkY2xrID0gdmx2
X2dldF9jY2tfY2xvY2soZGV2X3ByaXYsICJjZGNsayIsCj4gPiArCWNkY2xrX3N0YXRlLT52Y28g
PSB2bHZfZ2V0X2hwbGxfdmNvKGk5MTUpOwo+ID4gKwljZGNsa19zdGF0ZS0+Y2RjbGsgPSB2bHZf
Z2V0X2Nja19jbG9jayhpOTE1LCAiY2RjbGsiLAo+ID4gICAJCQkJCSAgICAgICBDQ0tfRElTUExB
WV9DTE9DS19DT05UUk9MLAo+ID4gICAJCQkJCSAgICAgICBjZGNsa19zdGF0ZS0+dmNvKTsKPiA+
IC0JdmFsID0gdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19EU1BTU1BNKTsKPiA+
ICsJdmFsID0gdmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0RTUFNTUE0pOwo+ID4gLQl2
bHZfaW9zZl9zYl9wdXQoZGV2X3ByaXYsCj4gPiArCXZsdl9pb3NmX3NiX3B1dChpOTE1LAo+ID4g
ICAJCQlCSVQoVkxWX0lPU0ZfU0JfQ0NLKSB8IEJJVChWTFZfSU9TRl9TQl9QVU5JVCkpOwo+ID4g
LQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCj4gPiArCWlmIChJU19WQUxMRVlWSUVXKGk5
MTUpKQo+ID4gICAJCWNkY2xrX3N0YXRlLT52b2x0YWdlX2xldmVsID0gKHZhbCAmIERTUEZSRVFH
VUFSX01BU0spID4+Cj4gPiAgIAkJCURTUEZSRVFHVUFSX1NISUZUOwo+ID4gICAJZWxzZQo+ID4g
QEAgLTQ4NiwxOCArNDg2LDE4IEBAIHN0YXRpYyB2b2lkIHZsdl9nZXRfY2RjbGsoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCQlEU1BGUkVRR1VBUl9TSElGVF9DSFY7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCB2bHZfcHJvZ3JhbV9wZmlfY3JlZGl0cyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgdmx2X3Byb2dyYW1f
cGZpX2NyZWRpdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAg
CXVuc2lnbmVkIGludCBjcmVkaXRzLCBkZWZhdWx0X2NyZWRpdHM7Cj4gPiAtCWlmIChJU19DSEVS
UllWSUVXKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJ
ZGVmYXVsdF9jcmVkaXRzID0gUEZJX0NSRURJVCgxMik7Cj4gPiAgIAllbHNlCj4gPiAgIAkJZGVm
YXVsdF9jcmVkaXRzID0gUEZJX0NSRURJVCg4KTsKPiA+IC0JaWYgKGRldl9wcml2LT5jZGNsay5o
dy5jZGNsayA+PSBkZXZfcHJpdi0+Y3pjbGtfZnJlcSkgewo+ID4gKwlpZiAoaTkxNS0+Y2RjbGsu
aHcuY2RjbGsgPj0gaTkxNS0+Y3pjbGtfZnJlcSkgewo+ID4gICAJCS8qIENIViBzdWdnZXN0ZWQg
dmFsdWUgaXMgMzEgb3IgNjMgKi8KPiA+IC0JCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkK
PiA+ICsJCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKQo+ID4gICAJCQljcmVkaXRzID0gUEZJX0NS
RURJVF82MzsKPiA+ICAgCQllbHNlCj4gPiAgIAkJCWNyZWRpdHMgPSBQRklfQ1JFRElUKDE1KTsK
PiA+IEBAIC01MjIsNyArNTIyLDcgQEAgc3RhdGljIHZvaWQgdmx2X3Byb2dyYW1fcGZpX2NyZWRp
dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJV0FSTl9PTihJOTE1
X1JFQUQoR0NJX0NPTlRST0wpICYgUEZJX0NSRURJVF9SRVNFTkQpOwo+ID4gICB9Cj4gPiAtc3Rh
dGljIHZvaWQgdmx2X3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiArc3RhdGljIHZvaWQgdmx2X3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0
YXRlLAo+ID4gICAJCQkgIGVudW0gcGlwZSBwaXBlKQo+ID4gICB7Cj4gPiBAQCAtNTQ4LDE4ICs1
NDgsMTggQEAgc3RhdGljIHZvaWQgdmx2X3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiAgIAkgKiBhIHN5c3RlbSBzdXNwZW5kLiAgU28gZ3JhYiB0aGUgUElQ
RS1BIGRvbWFpbiwgd2hpY2ggY292ZXJzCj4gPiAgIAkgKiB0aGUgSFcgYmxvY2tzIG5lZWRlZCBm
b3IgdGhlIGZvbGxvd2luZyBwcm9ncmFtbWluZy4KPiA+ICAgCSAqLwo+ID4gLQl3YWtlcmVmID0g
aW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9QSVBFX0EpOwo+
ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgUE9XRVJfRE9NQUlO
X1BJUEVfQSk7Cj4gPiAtCXZsdl9pb3NmX3NiX2dldChkZXZfcHJpdiwKPiA+ICsJdmx2X2lvc2Zf
c2JfZ2V0KGk5MTUsCj4gPiAgIAkJCUJJVChWTFZfSU9TRl9TQl9DQ0spIHwKPiA+ICAgCQkJQklU
KFZMVl9JT1NGX1NCX0JVTklUKSB8Cj4gPiAgIAkJCUJJVChWTFZfSU9TRl9TQl9QVU5JVCkpOwo+
ID4gLQl2YWwgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX0RTUFNTUE0pOwo+
ID4gKwl2YWwgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfRFNQU1NQTSk7Cj4gPiAg
IAl2YWwgJj0gfkRTUEZSRVFHVUFSX01BU0s7Cj4gPiAgIAl2YWwgfD0gKGNtZCA8PCBEU1BGUkVR
R1VBUl9TSElGVCk7Cj4gPiAtCXZsdl9wdW5pdF93cml0ZShkZXZfcHJpdiwgUFVOSVRfUkVHX0RT
UFNTUE0sIHZhbCk7Cj4gPiAtCWlmICh3YWl0X2Zvcigodmx2X3B1bml0X3JlYWQoZGV2X3ByaXYs
IFBVTklUX1JFR19EU1BTU1BNKSAmCj4gPiArCXZsdl9wdW5pdF93cml0ZShpOTE1LCBQVU5JVF9S
RUdfRFNQU1NQTSwgdmFsKTsKPiA+ICsJaWYgKHdhaXRfZm9yKCh2bHZfcHVuaXRfcmVhZChpOTE1
LCBQVU5JVF9SRUdfRFNQU1NQTSkgJgo+ID4gICAJCSAgICAgIERTUEZSRVFTVEFUX01BU0spID09
IChjbWQgPDwgRFNQRlJFUVNUQVRfU0hJRlQpLAo+ID4gICAJCSAgICAgNTApKSB7Cj4gPiAgIAkJ
RFJNX0VSUk9SKCJ0aW1lZCBvdXQgd2FpdGluZyBmb3IgQ0RjbGsgY2hhbmdlXG4iKTsKPiA+IEBA
IC01NjgsMjMgKzU2OCwyMyBAQCBzdGF0aWMgdm9pZCB2bHZfc2V0X2NkY2xrKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWlmIChjZGNsayA9PSA0MDAwMDApIHsKPiA+
ICAgCQl1MzIgZGl2aWRlcjsKPiA+IC0JCWRpdmlkZXIgPSBESVZfUk9VTkRfQ0xPU0VTVChkZXZf
cHJpdi0+aHBsbF9mcmVxIDw8IDEsCj4gPiArCQlkaXZpZGVyID0gRElWX1JPVU5EX0NMT1NFU1Qo
aTkxNS0+aHBsbF9mcmVxIDw8IDEsCj4gPiAgIAkJCQkJICAgIGNkY2xrKSAtIDE7Cj4gPiAgIAkJ
LyogYWRqdXN0IGNkY2xrIGRpdmlkZXIgKi8KPiA+IC0JCXZhbCA9IHZsdl9jY2tfcmVhZChkZXZf
cHJpdiwgQ0NLX0RJU1BMQVlfQ0xPQ0tfQ09OVFJPTCk7Cj4gPiArCQl2YWwgPSB2bHZfY2NrX3Jl
YWQoaTkxNSwgQ0NLX0RJU1BMQVlfQ0xPQ0tfQ09OVFJPTCk7Cj4gPiAgIAkJdmFsICY9IH5DQ0tf
RlJFUVVFTkNZX1ZBTFVFUzsKPiA+ICAgCQl2YWwgfD0gZGl2aWRlcjsKPiA+IC0JCXZsdl9jY2tf
d3JpdGUoZGV2X3ByaXYsIENDS19ESVNQTEFZX0NMT0NLX0NPTlRST0wsIHZhbCk7Cj4gPiArCQl2
bHZfY2NrX3dyaXRlKGk5MTUsIENDS19ESVNQTEFZX0NMT0NLX0NPTlRST0wsIHZhbCk7Cj4gPiAt
CQlpZiAod2FpdF9mb3IoKHZsdl9jY2tfcmVhZChkZXZfcHJpdiwgQ0NLX0RJU1BMQVlfQ0xPQ0tf
Q09OVFJPTCkgJgo+ID4gKwkJaWYgKHdhaXRfZm9yKCh2bHZfY2NrX3JlYWQoaTkxNSwgQ0NLX0RJ
U1BMQVlfQ0xPQ0tfQ09OVFJPTCkgJgo+ID4gICAJCQkgICAgICBDQ0tfRlJFUVVFTkNZX1NUQVRV
UykgPT0gKGRpdmlkZXIgPDwgQ0NLX0ZSRVFVRU5DWV9TVEFUVVNfU0hJRlQpLAo+ID4gICAJCQkg
ICAgIDUwKSkKPiA+ICAgCQkJRFJNX0VSUk9SKCJ0aW1lZCBvdXQgd2FpdGluZyBmb3IgQ0RjbGsg
Y2hhbmdlXG4iKTsKPiA+ICAgCX0KPiA+ICAgCS8qIGFkanVzdCBzZWxmLXJlZnJlc2ggZXhpdCBs
YXRlbmN5IHZhbHVlICovCj4gPiAtCXZhbCA9IHZsdl9idW5pdF9yZWFkKGRldl9wcml2LCBCVU5J
VF9SRUdfQklTT0MpOwo+ID4gKwl2YWwgPSB2bHZfYnVuaXRfcmVhZChpOTE1LCBCVU5JVF9SRUdf
QklTT0MpOwo+ID4gICAJdmFsICY9IH4weDdmOwo+ID4gICAJLyoKPiA+IEBAIC01OTUsMjEgKzU5
NSwyMSBAQCBzdGF0aWMgdm9pZCB2bHZfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICAgCQl2YWwgfD0gNDUwMCAvIDI1MDsgLyogNC41IHVzZWMgKi8KPiA+
ICAgCWVsc2UKPiA+ICAgCQl2YWwgfD0gMzAwMCAvIDI1MDsgLyogMy4wIHVzZWMgKi8KPiA+IC0J
dmx2X2J1bml0X3dyaXRlKGRldl9wcml2LCBCVU5JVF9SRUdfQklTT0MsIHZhbCk7Cj4gPiArCXZs
dl9idW5pdF93cml0ZShpOTE1LCBCVU5JVF9SRUdfQklTT0MsIHZhbCk7Cj4gPiAtCXZsdl9pb3Nm
X3NiX3B1dChkZXZfcHJpdiwKPiA+ICsJdmx2X2lvc2Zfc2JfcHV0KGk5MTUsCj4gPiAgIAkJCUJJ
VChWTFZfSU9TRl9TQl9DQ0spIHwKPiA+ICAgCQkJQklUKFZMVl9JT1NGX1NCX0JVTklUKSB8Cj4g
PiAgIAkJCUJJVChWTFZfSU9TRl9TQl9QVU5JVCkpOwo+ID4gLQlpbnRlbF91cGRhdGVfY2RjbGso
ZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF91cGRhdGVfY2RjbGsoaTkxNSk7Cj4gPiAtCXZsdl9wcm9n
cmFtX3BmaV9jcmVkaXRzKGRldl9wcml2KTsKPiA+ICsJdmx2X3Byb2dyYW1fcGZpX2NyZWRpdHMo
aTkxNSk7Cj4gPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQT1dFUl9ET01B
SU5fUElQRV9BLCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwg
UE9XRVJfRE9NQUlOX1BJUEVfQSwgd2FrZXJlZik7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBj
aHZfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0
aWMgdm9pZCBjaHZfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4g
ICAJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUsCj4gPiAg
IAkJCSAgZW51bSBwaXBlIHBpcGUpCj4gPiAgIHsKPiA+IEBAIC02MzQsMjYgKzYzNCwyNiBAQCBz
dGF0aWMgdm9pZCBjaHZfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgCSAqIGEgc3lzdGVtIHN1c3BlbmQuICBTbyBncmFiIHRoZSBQSVBFLUEgZG9tYWlu
LCB3aGljaCBjb3ZlcnMKPiA+ICAgCSAqIHRoZSBIVyBibG9ja3MgbmVlZGVkIGZvciB0aGUgZm9s
bG93aW5nIHByb2dyYW1taW5nLgo+ID4gICAJICovCj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNw
bGF5X3Bvd2VyX2dldChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX1BJUEVfQSk7Cj4gPiArCXdha2Vy
ZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBQT1dFUl9ET01BSU5fUElQRV9BKTsK
PiA+IC0Jdmx2X3B1bml0X2dldChkZXZfcHJpdik7Cj4gPiAtCXZhbCA9IHZsdl9wdW5pdF9yZWFk
KGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSk7Cj4gPiArCXZsdl9wdW5pdF9nZXQoaTkxNSk7
Cj4gPiArCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19EU1BTU1BNKTsKPiA+
ICAgCXZhbCAmPSB+RFNQRlJFUUdVQVJfTUFTS19DSFY7Cj4gPiAgIAl2YWwgfD0gKGNtZCA8PCBE
U1BGUkVRR1VBUl9TSElGVF9DSFYpOwo+ID4gLQl2bHZfcHVuaXRfd3JpdGUoZGV2X3ByaXYsIFBV
TklUX1JFR19EU1BTU1BNLCB2YWwpOwo+ID4gLQlpZiAod2FpdF9mb3IoKHZsdl9wdW5pdF9yZWFk
KGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSkgJgo+ID4gKwl2bHZfcHVuaXRfd3JpdGUoaTkx
NSwgUFVOSVRfUkVHX0RTUFNTUE0sIHZhbCk7Cj4gPiArCWlmICh3YWl0X2Zvcigodmx2X3B1bml0
X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0RTUFNTUE0pICYKPiA+ICAgCQkgICAgICBEU1BGUkVRU1RB
VF9NQVNLX0NIVikgPT0gKGNtZCA8PCBEU1BGUkVRU1RBVF9TSElGVF9DSFYpLAo+ID4gICAJCSAg
ICAgNTApKSB7Cj4gPiAgIAkJRFJNX0VSUk9SKCJ0aW1lZCBvdXQgd2FpdGluZyBmb3IgQ0RjbGsg
Y2hhbmdlXG4iKTsKPiA+ICAgCX0KPiA+IC0Jdmx2X3B1bml0X3B1dChkZXZfcHJpdik7Cj4gPiAr
CXZsdl9wdW5pdF9wdXQoaTkxNSk7Cj4gPiAtCWludGVsX3VwZGF0ZV9jZGNsayhkZXZfcHJpdik7
Cj4gPiArCWludGVsX3VwZGF0ZV9jZGNsayhpOTE1KTsKPiA+IC0Jdmx2X3Byb2dyYW1fcGZpX2Ny
ZWRpdHMoZGV2X3ByaXYpOwo+ID4gKwl2bHZfcHJvZ3JhbV9wZmlfY3JlZGl0cyhpOTE1KTsKPiA+
IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9QSVBFX0Es
IHdha2VyZWYpOwo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9ET01B
SU5fUElQRV9BLCB3YWtlcmVmKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW50IGJkd19jYWxjX2Nk
Y2xrKGludCBtaW5fY2RjbGspCj4gPiBAQCAtNjgzLDcgKzY4Myw3IEBAIHN0YXRpYyB1OCBiZHdf
Y2FsY192b2x0YWdlX2xldmVsKGludCBjZGNsaykKPiA+ICAgCX0KPiA+ICAgfQo+ID4gLXN0YXRp
YyB2b2lkIGJkd19nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3N0YXRpYyB2b2lkIGJkd19nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJCSAgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSkKPiA+
ICAgewo+ID4gICAJdTMyIGxjcGxsID0gSTkxNV9SRUFEKExDUExMX0NUTCk7Cj4gPiBAQCAtNzEw
LDcgKzcxMCw3IEBAIHN0YXRpYyB2b2lkIGJkd19nZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gICAJCWJkd19jYWxjX3ZvbHRhZ2VfbGV2ZWwoY2RjbGtfc3Rh
dGUtPmNkY2xrKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGJkd19zZXRfY2RjbGsoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGJkd19zZXRfY2Rj
bGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgY29uc3Qgc3RydWN0
IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSwKPiA+ICAgCQkJICBlbnVtIHBpcGUgcGlw
ZSkKPiA+ICAgewo+ID4gQEAgLTcyNiw3ICs3MjYsNyBAQCBzdGF0aWMgdm9pZCBiZHdfc2V0X2Nk
Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQkgInRyeWluZyB0
byBjaGFuZ2UgY2RjbGsgZnJlcXVlbmN5IHdpdGggY2RjbGsgbm90IGVuYWJsZWRcbiIpKQo+ID4g
ICAJCXJldHVybjsKPiA+IC0JcmV0ID0gc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUoZGV2X3ByaXYs
Cj4gPiArCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGk5MTUsCj4gPiAgIAkJCQkgICAg
ICBCRFdfUENPREVfRElTUExBWV9GUkVRX0NIQU5HRV9SRVEsIDB4MCk7Cj4gPiAgIAlpZiAocmV0
KSB7Cj4gPiAgIAkJRFJNX0VSUk9SKCJmYWlsZWQgdG8gaW5mb3JtIHBjb2RlIGFib3V0IGNkY2xr
IGNoYW5nZVxuIik7Cj4gPiBAQCAtNzc2LDEyICs3NzYsMTIgQEAgc3RhdGljIHZvaWQgYmR3X3Nl
dF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJCUxDUExM
X0NEX1NPVVJDRV9GQ0xLX0RPTkUpID09IDAsIDEpKQo+ID4gICAJCURSTV9FUlJPUigiU3dpdGNo
aW5nIGJhY2sgdG8gTENQTEwgZmFpbGVkXG4iKTsKPiA+IC0Jc2FuZHlicmlkZ2VfcGNvZGVfd3Jp
dGUoZGV2X3ByaXYsIEhTV19QQ09ERV9ERV9XUklURV9GUkVRX1JFUSwKPiA+ICsJc2FuZHlicmlk
Z2VfcGNvZGVfd3JpdGUoaTkxNSwgSFNXX1BDT0RFX0RFX1dSSVRFX0ZSRVFfUkVRLAo+ID4gICAJ
CQkJY2RjbGtfc3RhdGUtPnZvbHRhZ2VfbGV2ZWwpOwo+ID4gICAJSTkxNV9XUklURShDRENMS19G
UkVRLCBESVZfUk9VTkRfQ0xPU0VTVChjZGNsaywgMTAwMCkgLSAxKTsKPiA+IC0JaW50ZWxfdXBk
YXRlX2NkY2xrKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ID4g
ICB9Cj4gPiAgIHN0YXRpYyBpbnQgc2tsX2NhbGNfY2RjbGsoaW50IG1pbl9jZGNsaywgaW50IHZj
bykKPiA+IEBAIC04MTksNyArODE5LDcgQEAgc3RhdGljIHU4IHNrbF9jYWxjX3ZvbHRhZ2VfbGV2
ZWwoaW50IGNkY2xrKQo+ID4gICAJCXJldHVybiAwOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQg
c2tsX2RwbGwwX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAr
c3RhdGljIHZvaWQgc2tsX2RwbGwwX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICAgCQkJICAgICBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlKQo+
ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gQEAgLTg1OSwxMiArODU5LDEyIEBAIHN0YXRpYyB2
b2lkIHNrbF9kcGxsMF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gICAJfQo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgc2tsX2dldF9jZGNsayhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgc2tsX2dldF9jZGNsayhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICBzdHJ1Y3QgaW50ZWxfY2Rj
bGtfc3RhdGUgKmNkY2xrX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAl1MzIgY2RjdGw7Cj4gPiAtCXNr
bF9kcGxsMF91cGRhdGUoZGV2X3ByaXYsIGNkY2xrX3N0YXRlKTsKPiA+ICsJc2tsX2RwbGwwX3Vw
ZGF0ZShpOTE1LCBjZGNsa19zdGF0ZSk7Cj4gPiAgIAljZGNsa19zdGF0ZS0+Y2RjbGsgPSBjZGNs
a19zdGF0ZS0+YnlwYXNzID0gY2RjbGtfc3RhdGUtPnJlZjsKPiA+IEBAIC05MjYsMTggKzkyNiwx
OCBAQCBzdGF0aWMgaW50IHNrbF9jZGNsa19kZWNpbWFsKGludCBjZGNsaykKPiA+ICAgCXJldHVy
biBESVZfUk9VTkRfQ0xPU0VTVChjZGNsayAtIDEwMDAsIDUwMCk7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgdm9pZCBza2xfc2V0X3ByZWZlcnJlZF9jZGNsa192Y28oc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIHNrbF9zZXRfcHJlZmVycmVkX2NkY2xrX3Zj
byhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQlpbnQgdmNvKQo+ID4g
ICB7Cj4gPiAtCWJvb2wgY2hhbmdlZCA9IGRldl9wcml2LT5za2xfcHJlZmVycmVkX3Zjb19mcmVx
ICE9IHZjbzsKPiA+ICsJYm9vbCBjaGFuZ2VkID0gaTkxNS0+c2tsX3ByZWZlcnJlZF92Y29fZnJl
cSAhPSB2Y287Cj4gPiAtCWRldl9wcml2LT5za2xfcHJlZmVycmVkX3Zjb19mcmVxID0gdmNvOwo+
ID4gKwlpOTE1LT5za2xfcHJlZmVycmVkX3Zjb19mcmVxID0gdmNvOwo+ID4gICAJaWYgKGNoYW5n
ZWQpCj4gPiAtCQlpbnRlbF91cGRhdGVfbWF4X2NkY2xrKGRldl9wcml2KTsKPiA+ICsJCWludGVs
X3VwZGF0ZV9tYXhfY2RjbGsoaTkxNSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBza2xfZHBs
bDBfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IHZjbykKPiA+
ICtzdGF0aWMgdm9pZCBza2xfZHBsbDBfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBpbnQgdmNvKQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gQEAgLTk2OSwyOSArOTY5
LDI5IEBAIHN0YXRpYyB2b2lkIHNrbF9kcGxsMF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCBpbnQgdmNvKQo+ID4gICAJSTkxNV9XUklURShMQ1BMTDFfQ1RMLCBJOTE1
X1JFQUQoTENQTEwxX0NUTCkgfCBMQ1BMTF9QTExfRU5BQkxFKTsKPiA+IC0JaWYgKGludGVsX3dh
aXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ID4gKwlpZiAoaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiA+ICAgCQkJCSAgICBMQ1BMTDFfQ1RMLCBMQ1BM
TF9QTExfTE9DSywgTENQTExfUExMX0xPQ0ssCj4gPiAgIAkJCQkgICAgNSkpCj4gPiAgIAkJRFJN
X0VSUk9SKCJEUExMMCBub3QgbG9ja2VkXG4iKTsKPiA+IC0JZGV2X3ByaXYtPmNkY2xrLmh3LnZj
byA9IHZjbzsKPiA+ICsJaTkxNS0+Y2RjbGsuaHcudmNvID0gdmNvOwo+ID4gICAJLyogV2UnbGwg
d2FudCB0byBrZWVwIHVzaW5nIHRoZSBjdXJyZW50IHZjbyBmcm9tIG5vdyBvbi4gKi8KPiA+IC0J
c2tsX3NldF9wcmVmZXJyZWRfY2RjbGtfdmNvKGRldl9wcml2LCB2Y28pOwo+ID4gKwlza2xfc2V0
X3ByZWZlcnJlZF9jZGNsa192Y28oaTkxNSwgdmNvKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lk
IHNrbF9kcGxsMF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICtzdGF0aWMgdm9pZCBza2xfZHBsbDBfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gICAJSTkxNV9XUklURShMQ1BMTDFfQ1RMLCBJOTE1X1JFQUQoTENQ
TEwxX0NUTCkgJiB+TENQTExfUExMX0VOQUJMRSk7Cj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9y
ZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lz
dGVyKCZpOTE1LT51bmNvcmUsCj4gPiAgIAkJCQkgICAgTENQTEwxX0NUTCwgTENQTExfUExMX0xP
Q0ssIDAsCj4gPiAgIAkJCQkgICAgMSkpCj4gPiAgIAkJRFJNX0VSUk9SKCJDb3VsZG4ndCBkaXNh
YmxlIERQTEwwXG4iKTsKPiA+IC0JZGV2X3ByaXYtPmNkY2xrLmh3LnZjbyA9IDA7Cj4gPiArCWk5
MTUtPmNkY2xrLmh3LnZjbyA9IDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBza2xfc2V0X2Nk
Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBz
a2xfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgIGNv
bnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUsCj4gPiAgIAkJCSAgZW51
bSBwaXBlIHBpcGUpCj4gPiAgIHsKPiA+IEBAIC0xMDA4LDkgKzEwMDgsOSBAQCBzdGF0aWMgdm9p
ZCBza2xfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAg
CSAqIHVzZSB0aGUgY29ycmVzcG9uZGluZyBWQ08gZnJlcSBhcyB0aGF0IGFsd2F5cyBsZWFkcyB0
byB1c2luZyB0aGUKPiA+ICAgCSAqIG1pbmltdW0gMzA4TUh6IENEQ0xLLgo+ID4gICAJICovCj4g
PiAtCVdBUk5fT05fT05DRShJU19TS1lMQUtFKGRldl9wcml2KSAmJiB2Y28gPT0gODY0MDAwMCk7
Cj4gPiArCVdBUk5fT05fT05DRShJU19TS1lMQUtFKGk5MTUpICYmIHZjbyA9PSA4NjQwMDAwKTsK
PiA+IC0JcmV0ID0gc2tsX3Bjb2RlX3JlcXVlc3QoZGV2X3ByaXYsIFNLTF9QQ09ERV9DRENMS19D
T05UUk9MLAo+ID4gKwlyZXQgPSBza2xfcGNvZGVfcmVxdWVzdChpOTE1LCBTS0xfUENPREVfQ0RD
TEtfQ09OVFJPTCwKPiA+ICAgCQkJCVNLTF9DRENMS19QUkVQQVJFX0ZPUl9DSEFOR0UsCj4gPiAg
IAkJCQlTS0xfQ0RDTEtfUkVBRFlfRk9SX0NIQU5HRSwKPiA+ICAgCQkJCVNLTF9DRENMS19SRUFE
WV9GT1JfQ0hBTkdFLCAzKTsKPiA+IEBAIC0xMDIzLDcgKzEwMjMsNyBAQCBzdGF0aWMgdm9pZCBz
a2xfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCS8q
IENob29zZSBmcmVxdWVuY3kgZm9yIHRoaXMgY2RjbGsgKi8KPiA+ICAgCXN3aXRjaCAoY2RjbGsp
IHsKPiA+ICAgCWRlZmF1bHQ6Cj4gPiAtCQlXQVJOX09OKGNkY2xrICE9IGRldl9wcml2LT5jZGNs
ay5ody5ieXBhc3MpOwo+ID4gKwkJV0FSTl9PTihjZGNsayAhPSBpOTE1LT5jZGNsay5ody5ieXBh
c3MpOwo+ID4gICAJCVdBUk5fT04odmNvICE9IDApOwo+ID4gICAJCS8qIGZhbGwgdGhyb3VnaCAq
Lwo+ID4gICAJY2FzZSAzMDg1NzE6Cj4gPiBAQCAtMTA0MywxMyArMTA0MywxMyBAQCBzdGF0aWMg
dm9pZCBza2xfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICAgCQlicmVhazsKPiA+ICAgCX0KPiA+IC0JaWYgKGRldl9wcml2LT5jZGNsay5ody52Y28gIT0g
MCAmJgo+ID4gLQkgICAgZGV2X3ByaXYtPmNkY2xrLmh3LnZjbyAhPSB2Y28pCj4gPiAtCQlza2xf
ZHBsbDBfZGlzYWJsZShkZXZfcHJpdik7Cj4gPiArCWlmIChpOTE1LT5jZGNsay5ody52Y28gIT0g
MCAmJgo+ID4gKwkgICAgaTkxNS0+Y2RjbGsuaHcudmNvICE9IHZjbykKPiA+ICsJCXNrbF9kcGxs
MF9kaXNhYmxlKGk5MTUpOwo+ID4gICAJY2RjbGtfY3RsID0gSTkxNV9SRUFEKENEQ0xLX0NUTCk7
Cj4gPiAtCWlmIChkZXZfcHJpdi0+Y2RjbGsuaHcudmNvICE9IHZjbykgewo+ID4gKwlpZiAoaTkx
NS0+Y2RjbGsuaHcudmNvICE9IHZjbykgewo+ID4gICAJCS8qIFdhIERpc3BsYXkgIzExODM6IHNr
bCxrYmwsY2ZsICovCj4gPiAgIAkJY2RjbGtfY3RsICY9IH4oQ0RDTEtfRlJFUV9TRUxfTUFTSyB8
IENEQ0xLX0ZSRVFfREVDSU1BTF9NQVNLKTsKPiA+ICAgCQljZGNsa19jdGwgfD0gZnJlcV9zZWxl
Y3QgfCBza2xfY2RjbGtfZGVjaW1hbChjZGNsayk7Cj4gPiBAQCAtMTA2MSw4ICsxMDYxLDggQEAg
c3RhdGljIHZvaWQgc2tsX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAgIAlJOTE1X1dSSVRFKENEQ0xLX0NUTCwgY2RjbGtfY3RsKTsKPiA+ICAgCVBPU1RJ
TkdfUkVBRChDRENMS19DVEwpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmNkY2xrLmh3LnZjbyAhPSB2
Y28pCj4gPiAtCQlza2xfZHBsbDBfZW5hYmxlKGRldl9wcml2LCB2Y28pOwo+ID4gKwlpZiAoaTkx
NS0+Y2RjbGsuaHcudmNvICE9IHZjbykKPiA+ICsJCXNrbF9kcGxsMF9lbmFibGUoaTkxNSwgdmNv
KTsKPiA+ICAgCS8qIFdhIERpc3BsYXkgIzExODM6IHNrbCxrYmwsY2ZsICovCj4gPiAgIAljZGNs
a19jdGwgJj0gfihDRENMS19GUkVRX1NFTF9NQVNLIHwgQ0RDTEtfRlJFUV9ERUNJTUFMX01BU0sp
Owo+ID4gQEAgLTEwNzcsMTMgKzEwNzcsMTMgQEAgc3RhdGljIHZvaWQgc2tsX3NldF9jZGNsayhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlQT1NUSU5HX1JFQUQoQ0RD
TEtfQ1RMKTsKPiA+ICAgCS8qIGluZm9ybSBQQ1Ugb2YgdGhlIGNoYW5nZSAqLwo+ID4gLQlzYW5k
eWJyaWRnZV9wY29kZV93cml0ZShkZXZfcHJpdiwgU0tMX1BDT0RFX0NEQ0xLX0NPTlRST0wsCj4g
PiArCXNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGk5MTUsIFNLTF9QQ09ERV9DRENMS19DT05UUk9M
LAo+ID4gICAJCQkJY2RjbGtfc3RhdGUtPnZvbHRhZ2VfbGV2ZWwpOwo+ID4gLQlpbnRlbF91cGRh
dGVfY2RjbGsoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF91cGRhdGVfY2RjbGsoaTkxNSk7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCBza2xfc2FuaXRpemVfY2RjbGsoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIHNrbF9zYW5pdGl6ZV9jZGNsayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIGNkY3RsLCBleHBl
Y3RlZDsKPiA+IEBAIC0xMDk1LDEyICsxMDk1LDEyIEBAIHN0YXRpYyB2b2lkIHNrbF9zYW5pdGl6
ZV9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlpZiAoKEk5
MTVfUkVBRChTV0ZfSUxLKDB4MTgpKSAmIDB4MDBGRkZGRkYpID09IDApCj4gPiAgIAkJZ290byBz
YW5pdGl6ZTsKPiA+IC0JaW50ZWxfdXBkYXRlX2NkY2xrKGRldl9wcml2KTsKPiA+IC0JaW50ZWxf
ZHVtcF9jZGNsa19zdGF0ZSgmZGV2X3ByaXYtPmNkY2xrLmh3LCAiQ3VycmVudCBDRENMSyIpOwo+
ID4gKwlpbnRlbF91cGRhdGVfY2RjbGsoaTkxNSk7Cj4gPiArCWludGVsX2R1bXBfY2RjbGtfc3Rh
dGUoJmk5MTUtPmNkY2xrLmh3LCAiQ3VycmVudCBDRENMSyIpOwo+ID4gICAJLyogSXMgUExMIGVu
YWJsZWQgYW5kIGxvY2tlZCA/ICovCj4gPiAtCWlmIChkZXZfcHJpdi0+Y2RjbGsuaHcudmNvID09
IDAgfHwKPiA+IC0JICAgIGRldl9wcml2LT5jZGNsay5ody5jZGNsayA9PSBkZXZfcHJpdi0+Y2Rj
bGsuaHcuYnlwYXNzKQo+ID4gKwlpZiAoaTkxNS0+Y2RjbGsuaHcudmNvID09IDAgfHwKPiA+ICsJ
ICAgIGk5MTUtPmNkY2xrLmh3LmNkY2xrID09IGk5MTUtPmNkY2xrLmh3LmJ5cGFzcykKPiA+ICAg
CQlnb3RvIHNhbml0aXplOwo+ID4gICAJLyogRFBMTCBva2F5OyB2ZXJpZnkgdGhlIGNkY2xvY2sK
PiA+IEBAIC0xMTExLDcgKzExMTEsNyBAQCBzdGF0aWMgdm9pZCBza2xfc2FuaXRpemVfY2RjbGso
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICovCj4gPiAgIAljZGN0
bCA9IEk5MTVfUkVBRChDRENMS19DVEwpOwo+ID4gICAJZXhwZWN0ZWQgPSAoY2RjdGwgJiBDRENM
S19GUkVRX1NFTF9NQVNLKSB8Cj4gPiAtCQlza2xfY2RjbGtfZGVjaW1hbChkZXZfcHJpdi0+Y2Rj
bGsuaHcuY2RjbGspOwo+ID4gKwkJc2tsX2NkY2xrX2RlY2ltYWwoaTkxNS0+Y2RjbGsuaHcuY2Rj
bGspOwo+ID4gICAJaWYgKGNkY3RsID09IGV4cGVjdGVkKQo+ID4gICAJCS8qIEFsbCB3ZWxsOyBu
b3RoaW5nIHRvIHNhbml0aXplICovCj4gPiAgIAkJcmV0dXJuOwo+ID4gQEAgLTExMjAsNDkgKzEx
MjAsNDkgQEAgc3RhdGljIHZvaWQgc2tsX3Nhbml0aXplX2NkY2xrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICAgCURSTV9ERUJVR19LTVMoIlNhbml0aXppbmcgY2RjbGsg
cHJvZ3JhbW1lZCBieSBwcmUtb3NcbiIpOwo+ID4gICAJLyogZm9yY2UgY2RjbGsgcHJvZ3JhbW1p
bmcgKi8KPiA+IC0JZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrID0gMDsKPiA+ICsJaTkxNS0+Y2Rj
bGsuaHcuY2RjbGsgPSAwOwo+ID4gICAJLyogZm9yY2UgZnVsbCBQTEwgZGlzYWJsZSArIGVuYWJs
ZSAqLwo+ID4gLQlkZXZfcHJpdi0+Y2RjbGsuaHcudmNvID0gLTE7Cj4gPiArCWk5MTUtPmNkY2xr
Lmh3LnZjbyA9IC0xOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgc2tsX2luaXRfY2RjbGsoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIHNrbF9pbml0
X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfY2RjbGtfc3RhdGUgY2RjbGtfc3RhdGU7Cj4gPiAtCXNrbF9zYW5pdGl6ZV9jZGNs
ayhkZXZfcHJpdik7Cj4gPiArCXNrbF9zYW5pdGl6ZV9jZGNsayhpOTE1KTsKPiA+IC0JaWYgKGRl
dl9wcml2LT5jZGNsay5ody5jZGNsayAhPSAwICYmCj4gPiAtCSAgICBkZXZfcHJpdi0+Y2RjbGsu
aHcudmNvICE9IDApIHsKPiA+ICsJaWYgKGk5MTUtPmNkY2xrLmh3LmNkY2xrICE9IDAgJiYKPiA+
ICsJICAgIGk5MTUtPmNkY2xrLmh3LnZjbyAhPSAwKSB7Cj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBV
c2UgdGhlIGN1cnJlbnQgdmNvIGFzIG91ciBpbml0aWFsCj4gPiAgIAkJICogZ3Vlc3MgYXMgdG8g
d2hhdCB0aGUgcHJlZmVycmVkIHZjbyBpcy4KPiA+ICAgCQkgKi8KPiA+IC0JCWlmIChkZXZfcHJp
di0+c2tsX3ByZWZlcnJlZF92Y29fZnJlcSA9PSAwKQo+ID4gLQkJCXNrbF9zZXRfcHJlZmVycmVk
X2NkY2xrX3ZjbyhkZXZfcHJpdiwKPiA+IC0JCQkJCQkgICAgZGV2X3ByaXYtPmNkY2xrLmh3LnZj
byk7Cj4gPiArCQlpZiAoaTkxNS0+c2tsX3ByZWZlcnJlZF92Y29fZnJlcSA9PSAwKQo+ID4gKwkJ
CXNrbF9zZXRfcHJlZmVycmVkX2NkY2xrX3ZjbyhpOTE1LAo+ID4gKwkJCQkJCSAgICBpOTE1LT5j
ZGNsay5ody52Y28pOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0JY2RjbGtfc3RhdGUg
PSBkZXZfcHJpdi0+Y2RjbGsuaHc7Cj4gPiArCWNkY2xrX3N0YXRlID0gaTkxNS0+Y2RjbGsuaHc7
Cj4gPiAtCWNkY2xrX3N0YXRlLnZjbyA9IGRldl9wcml2LT5za2xfcHJlZmVycmVkX3Zjb19mcmVx
Owo+ID4gKwljZGNsa19zdGF0ZS52Y28gPSBpOTE1LT5za2xfcHJlZmVycmVkX3Zjb19mcmVxOwo+
ID4gICAJaWYgKGNkY2xrX3N0YXRlLnZjbyA9PSAwKQo+ID4gICAJCWNkY2xrX3N0YXRlLnZjbyA9
IDgxMDAwMDA7Cj4gPiAgIAljZGNsa19zdGF0ZS5jZGNsayA9IHNrbF9jYWxjX2NkY2xrKDAsIGNk
Y2xrX3N0YXRlLnZjbyk7Cj4gPiAgIAljZGNsa19zdGF0ZS52b2x0YWdlX2xldmVsID0gc2tsX2Nh
bGNfdm9sdGFnZV9sZXZlbChjZGNsa19zdGF0ZS5jZGNsayk7Cj4gPiAtCXNrbF9zZXRfY2RjbGso
ZGV2X3ByaXYsICZjZGNsa19zdGF0ZSwgSU5WQUxJRF9QSVBFKTsKPiA+ICsJc2tsX3NldF9jZGNs
ayhpOTE1LCAmY2RjbGtfc3RhdGUsIElOVkFMSURfUElQRSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
dm9pZCBza2xfdW5pbml0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICtzdGF0aWMgdm9pZCBza2xfdW5pbml0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBjZGNsa19zdGF0
ZSA9IGRldl9wcml2LT5jZGNsay5odzsKPiA+ICsJc3RydWN0IGludGVsX2NkY2xrX3N0YXRlIGNk
Y2xrX3N0YXRlID0gaTkxNS0+Y2RjbGsuaHc7Cj4gPiAgIAljZGNsa19zdGF0ZS5jZGNsayA9IGNk
Y2xrX3N0YXRlLmJ5cGFzczsKPiA+ICAgCWNkY2xrX3N0YXRlLnZjbyA9IDA7Cj4gPiAgIAljZGNs
a19zdGF0ZS52b2x0YWdlX2xldmVsID0gc2tsX2NhbGNfdm9sdGFnZV9sZXZlbChjZGNsa19zdGF0
ZS5jZGNsayk7Cj4gPiAtCXNrbF9zZXRfY2RjbGsoZGV2X3ByaXYsICZjZGNsa19zdGF0ZSwgSU5W
QUxJRF9QSVBFKTsKPiA+ICsJc2tsX3NldF9jZGNsayhpOTE1LCAmY2RjbGtfc3RhdGUsIElOVkFM
SURfUElQRSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGludCBieHRfY2FsY19jZGNsayhpbnQgbWlu
X2NkY2xrKQo+ID4gQEAgLTExOTQsMTEgKzExOTQsMTEgQEAgc3RhdGljIHU4IGJ4dF9jYWxjX3Zv
bHRhZ2VfbGV2ZWwoaW50IGNkY2xrKQo+ID4gICAJcmV0dXJuIERJVl9ST1VORF9VUChjZGNsaywg
MjUwMDApOwo+ID4gICB9Cj4gPiAtc3RhdGljIGludCBieHRfZGVfcGxsX3ZjbyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBjZGNsaykKPiA+ICtzdGF0aWMgaW50IGJ4dF9k
ZV9wbGxfdmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgY2RjbGspCj4gPiAg
IHsKPiA+ICAgCWludCByYXRpbzsKPiA+IC0JaWYgKGNkY2xrID09IGRldl9wcml2LT5jZGNsay5o
dy5ieXBhc3MpCj4gPiArCWlmIChjZGNsayA9PSBpOTE1LT5jZGNsay5ody5ieXBhc3MpCj4gPiAg
IAkJcmV0dXJuIDA7Cj4gPiAgIAlzd2l0Y2ggKGNkY2xrKSB7Cj4gPiBAQCAtMTIxNiwxNCArMTIx
NiwxNCBAQCBzdGF0aWMgaW50IGJ4dF9kZV9wbGxfdmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwgaW50IGNkY2xrKQo+ID4gICAJCWJyZWFrOwo+ID4gICAJfQo+ID4gLQlyZXR1
cm4gZGV2X3ByaXYtPmNkY2xrLmh3LnJlZiAqIHJhdGlvOwo+ID4gKwlyZXR1cm4gaTkxNS0+Y2Rj
bGsuaHcucmVmICogcmF0aW87Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IGdsa19kZV9wbGxfdmNv
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IGNkY2xrKQo+ID4gK3N0YXRp
YyBpbnQgZ2xrX2RlX3BsbF92Y28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCBj
ZGNsaykKPiA+ICAgewo+ID4gICAJaW50IHJhdGlvOwo+ID4gLQlpZiAoY2RjbGsgPT0gZGV2X3By
aXYtPmNkY2xrLmh3LmJ5cGFzcykKPiA+ICsJaWYgKGNkY2xrID09IGk5MTUtPmNkY2xrLmh3LmJ5
cGFzcykKPiA+ICAgCQlyZXR1cm4gMDsKPiA+ICAgCXN3aXRjaCAoY2RjbGspIHsKPiA+IEBAIC0x
MjM3LDEwICsxMjM3LDEwIEBAIHN0YXRpYyBpbnQgZ2xrX2RlX3BsbF92Y28oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgY2RjbGspCj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAl9
Cj4gPiAtCXJldHVybiBkZXZfcHJpdi0+Y2RjbGsuaHcucmVmICogcmF0aW87Cj4gPiArCXJldHVy
biBpOTE1LT5jZGNsay5ody5yZWYgKiByYXRpbzsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGJ4
dF9kZV9wbGxfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtz
dGF0aWMgdm9pZCBieHRfZGVfcGxsX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICAgCQkJICAgICAgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSkK
PiA+ICAgewo+ID4gICAJdTMyIHZhbDsKPiA+IEBAIC0xMjU5LDEzICsxMjU5LDEzIEBAIHN0YXRp
YyB2b2lkIGJ4dF9kZV9wbGxfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgCWNkY2xrX3N0YXRlLT52Y28gPSAodmFsICYgQlhUX0RFX1BMTF9SQVRJT19NQVNL
KSAqIGNkY2xrX3N0YXRlLT5yZWY7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBieHRfZ2V0X2Nk
Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBi
eHRfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgIHN0
cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXUzMiBk
aXZpZGVyOwo+ID4gICAJaW50IGRpdjsKPiA+IC0JYnh0X2RlX3BsbF91cGRhdGUoZGV2X3ByaXYs
IGNkY2xrX3N0YXRlKTsKPiA+ICsJYnh0X2RlX3BsbF91cGRhdGUoaTkxNSwgY2RjbGtfc3RhdGUp
Owo+ID4gICAJY2RjbGtfc3RhdGUtPmNkY2xrID0gY2RjbGtfc3RhdGUtPmJ5cGFzcyA9IGNkY2xr
X3N0YXRlLT5yZWY7Cj4gPiBAQCAtMTI3OSw3ICsxMjc5LDcgQEAgc3RhdGljIHZvaWQgYnh0X2dl
dF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJZGl2ID0g
MjsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgQlhUX0NEQ0xLX0NEMlhfRElWX1NFTF8xXzU6
Cj4gPiAtCQlXQVJOKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpLCAiVW5zdXBwb3J0ZWQgZGl2aWRl
clxuIik7Cj4gPiArCQlXQVJOKElTX0dFTUlOSUxBS0UoaTkxNSksICJVbnN1cHBvcnRlZCBkaXZp
ZGVyXG4iKTsKPiA+ICAgCQlkaXYgPSAzOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSBCWFRf
Q0RDTEtfQ0QyWF9ESVZfU0VMXzI6Cj4gPiBAQCAtMTMwNCwyMiArMTMwNCwyMiBAQCBzdGF0aWMg
dm9pZCBieHRfZ2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICAgCQlieHRfY2FsY192b2x0YWdlX2xldmVsKGNkY2xrX3N0YXRlLT5jZGNsayk7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgdm9pZCBieHRfZGVfcGxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGJ4dF9kZV9wbGxfZGlzYWJsZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJSTkxNV9XUklURShCWFRfREVf
UExMX0VOQUJMRSwgMCk7Cj4gPiAgIAkvKiBUaW1lb3V0IDIwMHVzICovCj4gPiAtCWlmIChpbnRl
bF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJaWYgKGludGVsX3dh
aXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gPiAgIAkJCQkgICAgQlhUX0RFX1BMTF9F
TkFCTEUsIEJYVF9ERV9QTExfTE9DSywgMCwKPiA+ICAgCQkJCSAgICAxKSkKPiA+ICAgCQlEUk1f
RVJST1IoInRpbWVvdXQgd2FpdGluZyBmb3IgREUgUExMIHVubG9ja1xuIik7Cj4gPiAtCWRldl9w
cml2LT5jZGNsay5ody52Y28gPSAwOwo+ID4gKwlpOTE1LT5jZGNsay5ody52Y28gPSAwOwo+ID4g
ICB9Cj4gPiAtc3RhdGljIHZvaWQgYnh0X2RlX3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCBpbnQgdmNvKQo+ID4gK3N0YXRpYyB2b2lkIGJ4dF9kZV9wbGxfZW5h
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgdmNvKQo+ID4gICB7Cj4gPiAt
CWludCByYXRpbyA9IERJVl9ST1VORF9DTE9TRVNUKHZjbywgZGV2X3ByaXYtPmNkY2xrLmh3LnJl
Zik7Cj4gPiArCWludCByYXRpbyA9IERJVl9ST1VORF9DTE9TRVNUKHZjbywgaTkxNS0+Y2RjbGsu
aHcucmVmKTsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAgIAl2YWwgPSBJOTE1X1JFQUQoQlhUX0RFX1BM
TF9DVEwpOwo+ID4gQEAgLTEzMzAsMTcgKzEzMzAsMTcgQEAgc3RhdGljIHZvaWQgYnh0X2RlX3Bs
bF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgdmNvKQo+ID4g
ICAJSTkxNV9XUklURShCWFRfREVfUExMX0VOQUJMRSwgQlhUX0RFX1BMTF9QTExfRU5BQkxFKTsK
PiA+ICAgCS8qIFRpbWVvdXQgMjAwdXMgKi8KPiA+IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lz
dGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ID4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIo
Jmk5MTUtPnVuY29yZSwKPiA+ICAgCQkJCSAgICBCWFRfREVfUExMX0VOQUJMRSwKPiA+ICAgCQkJ
CSAgICBCWFRfREVfUExMX0xPQ0ssCj4gPiAgIAkJCQkgICAgQlhUX0RFX1BMTF9MT0NLLAo+ID4g
ICAJCQkJICAgIDEpKQo+ID4gICAJCURSTV9FUlJPUigidGltZW91dCB3YWl0aW5nIGZvciBERSBQ
TEwgbG9ja1xuIik7Cj4gPiAtCWRldl9wcml2LT5jZGNsay5ody52Y28gPSB2Y287Cj4gPiArCWk5
MTUtPmNkY2xrLmh3LnZjbyA9IHZjbzsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGJ4dF9zZXRf
Y2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lk
IGJ4dF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAg
Y29uc3Qgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19zdGF0ZSwKPiA+ICAgCQkJICBl
bnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gQEAgLTEzNTIsMTQgKzEzNTIsMTQgQEAgc3RhdGlj
IHZvaWQgYnh0X3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiAgIAkvKiBjZGNsayA9IHZjbyAvIDIgLyBkaXZ7MSwxLjUsMiw0fSAqLwo+ID4gICAJc3dpdGNo
IChESVZfUk9VTkRfQ0xPU0VTVCh2Y28sIGNkY2xrKSkgewo+ID4gICAJZGVmYXVsdDoKPiA+IC0J
CVdBUk5fT04oY2RjbGsgIT0gZGV2X3ByaXYtPmNkY2xrLmh3LmJ5cGFzcyk7Cj4gPiArCQlXQVJO
X09OKGNkY2xrICE9IGk5MTUtPmNkY2xrLmh3LmJ5cGFzcyk7Cj4gPiAgIAkJV0FSTl9PTih2Y28g
IT0gMCk7Cj4gPiAgIAkJLyogZmFsbCB0aHJvdWdoICovCj4gPiAgIAljYXNlIDI6Cj4gPiAgIAkJ
ZGl2aWRlciA9IEJYVF9DRENMS19DRDJYX0RJVl9TRUxfMTsKPiA+ICAgCQlicmVhazsKPiA+ICAg
CWNhc2UgMzoKPiA+IC0JCVdBUk4oSVNfR0VNSU5JTEFLRShkZXZfcHJpdiksICJVbnN1cHBvcnRl
ZCBkaXZpZGVyXG4iKTsKPiA+ICsJCVdBUk4oSVNfR0VNSU5JTEFLRShpOTE1KSwgIlVuc3VwcG9y
dGVkIGRpdmlkZXJcbiIpOwo+ID4gICAJCWRpdmlkZXIgPSBCWFRfQ0RDTEtfQ0QyWF9ESVZfU0VM
XzFfNTsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgNDoKPiA+IEBAIC0xMzc1LDcgKzEzNzUs
NyBAQCBzdGF0aWMgdm9pZCBieHRfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCSAqIHJlcXVpcmVzIHVzIHRvIHdhaXQgdXAgdG8gMTUwdXNlYywgYnV0
IHRoYXQgbGVhZHMgdG8gdGltZW91dHM7Cj4gPiAgIAkgKiB0aGUgMm1zIHVzZWQgaGVyZSBpcyBi
YXNlZCBvbiBleHBlcmltZW50Lgo+ID4gICAJICovCj4gPiAtCXJldCA9IHNhbmR5YnJpZGdlX3Bj
b2RlX3dyaXRlX3RpbWVvdXQoZGV2X3ByaXYsCj4gPiArCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2Rl
X3dyaXRlX3RpbWVvdXQoaTkxNSwKPiA+ICAgCQkJCQkgICAgICBIU1dfUENPREVfREVfV1JJVEVf
RlJFUV9SRVEsCj4gPiAgIAkJCQkJICAgICAgMHg4MDAwMDAwMCwgMTUwLCAyKTsKPiA+ICAgCWlm
IChyZXQpIHsKPiA+IEBAIC0xMzg0LDEyICsxMzg0LDEyIEBAIHN0YXRpYyB2b2lkIGJ4dF9zZXRf
Y2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCXJldHVybjsK
PiA+ICAgCX0KPiA+IC0JaWYgKGRldl9wcml2LT5jZGNsay5ody52Y28gIT0gMCAmJgo+ID4gLQkg
ICAgZGV2X3ByaXYtPmNkY2xrLmh3LnZjbyAhPSB2Y28pCj4gPiAtCQlieHRfZGVfcGxsX2Rpc2Fi
bGUoZGV2X3ByaXYpOwo+ID4gKwlpZiAoaTkxNS0+Y2RjbGsuaHcudmNvICE9IDAgJiYKPiA+ICsJ
ICAgIGk5MTUtPmNkY2xrLmh3LnZjbyAhPSB2Y28pCj4gPiArCQlieHRfZGVfcGxsX2Rpc2FibGUo
aTkxNSk7Cj4gPiAtCWlmIChkZXZfcHJpdi0+Y2RjbGsuaHcudmNvICE9IHZjbykKPiA+IC0JCWJ4
dF9kZV9wbGxfZW5hYmxlKGRldl9wcml2LCB2Y28pOwo+ID4gKwlpZiAoaTkxNS0+Y2RjbGsuaHcu
dmNvICE9IHZjbykKPiA+ICsJCWJ4dF9kZV9wbGxfZW5hYmxlKGk5MTUsIHZjbyk7Cj4gPiAgIAl2
YWwgPSBkaXZpZGVyIHwgc2tsX2NkY2xrX2RlY2ltYWwoY2RjbGspOwo+ID4gICAJaWYgKHBpcGUg
PT0gSU5WQUxJRF9QSVBFKQo+ID4gQEAgLTE0MDUsNyArMTQwNSw3IEBAIHN0YXRpYyB2b2lkIGJ4
dF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJSTkx
NV9XUklURShDRENMS19DVEwsIHZhbCk7Cj4gPiAgIAlpZiAocGlwZSAhPSBJTlZBTElEX1BJUEUp
Cj4gPiAtCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwkJaW50
ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsIHBpcGUpOwo+ID4gICAJLyoKPiA+ICAgCSAqIFRoZSB0
aW1lb3V0IGlzbid0IHNwZWNpZmllZCwgdGhlIDJtcyB1c2VkIGhlcmUgaXMgYmFzZWQgb24KPiA+
IEBAIC0xNDEzLDcgKzE0MTMsNyBAQCBzdGF0aWMgdm9pZCBieHRfc2V0X2NkY2xrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCSAqIEZJWE1FOiBXYWl0aW5nIGZvciB0
aGUgcmVxdWVzdCBjb21wbGV0aW9uIGNvdWxkIGJlIGRlbGF5ZWQgdW50aWwKPiA+ICAgCSAqIHRo
ZSBuZXh0IFBDT0RFIHJlcXVlc3QgYmFzZWQgb24gQlNwZWMuCj4gPiAgIAkgKi8KPiA+IC0JcmV0
ID0gc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGVfdGltZW91dChkZXZfcHJpdiwKPiA+ICsJcmV0ID0g
c2FuZHlicmlkZ2VfcGNvZGVfd3JpdGVfdGltZW91dChpOTE1LAo+ID4gICAJCQkJCSAgICAgIEhT
V19QQ09ERV9ERV9XUklURV9GUkVRX1JFUSwKPiA+ICAgCQkJCQkgICAgICBjZGNsa19zdGF0ZS0+
dm9sdGFnZV9sZXZlbCwgMTUwLCAyKTsKPiA+ICAgCWlmIChyZXQpIHsKPiA+IEBAIC0xNDIyLDE4
ICsxNDIyLDE4IEBAIHN0YXRpYyB2b2lkIGJ4dF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0JaW50ZWxfdXBk
YXRlX2NkY2xrKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ID4g
ICB9Cj4gPiAtc3RhdGljIHZvaWQgYnh0X3Nhbml0aXplX2NkY2xrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBieHRfc2FuaXRpemVfY2RjbGsoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiBjZGN0bCwgZXhw
ZWN0ZWQ7Cj4gPiAtCWludGVsX3VwZGF0ZV9jZGNsayhkZXZfcHJpdik7Cj4gPiAtCWludGVsX2R1
bXBfY2RjbGtfc3RhdGUoJmRldl9wcml2LT5jZGNsay5odywgIkN1cnJlbnQgQ0RDTEsiKTsKPiA+
ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ID4gKwlpbnRlbF9kdW1wX2NkY2xrX3N0YXRl
KCZpOTE1LT5jZGNsay5odywgIkN1cnJlbnQgQ0RDTEsiKTsKPiA+IC0JaWYgKGRldl9wcml2LT5j
ZGNsay5ody52Y28gPT0gMCB8fAo+ID4gLQkgICAgZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrID09
IGRldl9wcml2LT5jZGNsay5ody5ieXBhc3MpCj4gPiArCWlmIChpOTE1LT5jZGNsay5ody52Y28g
PT0gMCB8fAo+ID4gKwkgICAgaTkxNS0+Y2RjbGsuaHcuY2RjbGsgPT0gaTkxNS0+Y2RjbGsuaHcu
YnlwYXNzKQo+ID4gICAJCWdvdG8gc2FuaXRpemU7Cj4gPiAgIAkvKiBEUExMIG9rYXk7IHZlcmlm
eSB0aGUgY2RjbG9jawo+ID4gQEAgLTE0NTEsMTIgKzE0NTEsMTIgQEAgc3RhdGljIHZvaWQgYnh0
X3Nhbml0aXplX2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAg
CWNkY3RsICY9IH5CWFRfQ0RDTEtfQ0QyWF9QSVBFX05PTkU7Cj4gPiAgIAlleHBlY3RlZCA9IChj
ZGN0bCAmIEJYVF9DRENMS19DRDJYX0RJVl9TRUxfTUFTSykgfAo+ID4gLQkJc2tsX2NkY2xrX2Rl
Y2ltYWwoZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrKTsKPiA+ICsJCXNrbF9jZGNsa19kZWNpbWFs
KGk5MTUtPmNkY2xrLmh3LmNkY2xrKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBEaXNhYmxlIFNTQSBQ
cmVjaGFyZ2Ugd2hlbiBDRCBjbG9jayBmcmVxdWVuY3kgPCA1MDAgTUh6LAo+ID4gICAJICogZW5h
YmxlIG90aGVyd2lzZS4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoZGV2X3ByaXYtPmNkY2xrLmh3LmNk
Y2xrID49IDUwMDAwMCkKPiA+ICsJaWYgKGk5MTUtPmNkY2xrLmh3LmNkY2xrID49IDUwMDAwMCkK
PiA+ICAgCQlleHBlY3RlZCB8PSBCWFRfQ0RDTEtfU1NBX1BSRUNIQVJHRV9FTkFCTEU7Cj4gPiAg
IAlpZiAoY2RjdGwgPT0gZXhwZWN0ZWQpCj4gPiBAQCAtMTQ2Nyw1MCArMTQ2Nyw1MCBAQCBzdGF0
aWMgdm9pZCBieHRfc2FuaXRpemVfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gICAJRFJNX0RFQlVHX0tNUygiU2FuaXRpemluZyBjZGNsayBwcm9ncmFtbWVkIGJ5
IHByZS1vc1xuIik7Cj4gPiAgIAkvKiBmb3JjZSBjZGNsayBwcm9ncmFtbWluZyAqLwo+ID4gLQlk
ZXZfcHJpdi0+Y2RjbGsuaHcuY2RjbGsgPSAwOwo+ID4gKwlpOTE1LT5jZGNsay5ody5jZGNsayA9
IDA7Cj4gPiAgIAkvKiBmb3JjZSBmdWxsIFBMTCBkaXNhYmxlICsgZW5hYmxlICovCj4gPiAtCWRl
dl9wcml2LT5jZGNsay5ody52Y28gPSAtMTsKPiA+ICsJaTkxNS0+Y2RjbGsuaHcudmNvID0gLTE7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBieHRfaW5pdF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgYnh0X2luaXRfY2RjbGsoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jZGNs
a19zdGF0ZSBjZGNsa19zdGF0ZTsKPiA+IC0JYnh0X3Nhbml0aXplX2NkY2xrKGRldl9wcml2KTsK
PiA+ICsJYnh0X3Nhbml0aXplX2NkY2xrKGk5MTUpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmNkY2xr
Lmh3LmNkY2xrICE9IDAgJiYKPiA+IC0JICAgIGRldl9wcml2LT5jZGNsay5ody52Y28gIT0gMCkK
PiA+ICsJaWYgKGk5MTUtPmNkY2xrLmh3LmNkY2xrICE9IDAgJiYKPiA+ICsJICAgIGk5MTUtPmNk
Y2xrLmh3LnZjbyAhPSAwKQo+ID4gICAJCXJldHVybjsKPiA+IC0JY2RjbGtfc3RhdGUgPSBkZXZf
cHJpdi0+Y2RjbGsuaHc7Cj4gPiArCWNkY2xrX3N0YXRlID0gaTkxNS0+Y2RjbGsuaHc7Cj4gPiAg
IAkvKgo+ID4gICAJICogRklYTUU6Cj4gPiAgIAkgKiAtIFRoZSBpbml0aWFsIENEQ0xLIG5lZWRz
IHRvIGJlIHJlYWQgZnJvbSBWQlQuCj4gPiAgIAkgKiAgIE5lZWQgdG8gbWFrZSB0aGlzIGNoYW5n
ZSBhZnRlciBWQlQgaGFzIGNoYW5nZXMgZm9yIEJYVC4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSVNf
R0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpIHsK
PiA+ICAgCQljZGNsa19zdGF0ZS5jZGNsayA9IGdsa19jYWxjX2NkY2xrKDApOwo+ID4gLQkJY2Rj
bGtfc3RhdGUudmNvID0gZ2xrX2RlX3BsbF92Y28oZGV2X3ByaXYsIGNkY2xrX3N0YXRlLmNkY2xr
KTsKPiA+ICsJCWNkY2xrX3N0YXRlLnZjbyA9IGdsa19kZV9wbGxfdmNvKGk5MTUsIGNkY2xrX3N0
YXRlLmNkY2xrKTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAgIAkJY2RjbGtfc3RhdGUuY2RjbGsgPSBi
eHRfY2FsY19jZGNsaygwKTsKPiA+IC0JCWNkY2xrX3N0YXRlLnZjbyA9IGJ4dF9kZV9wbGxfdmNv
KGRldl9wcml2LCBjZGNsa19zdGF0ZS5jZGNsayk7Cj4gPiArCQljZGNsa19zdGF0ZS52Y28gPSBi
eHRfZGVfcGxsX3ZjbyhpOTE1LCBjZGNsa19zdGF0ZS5jZGNsayk7Cj4gPiAgIAl9Cj4gPiAgIAlj
ZGNsa19zdGF0ZS52b2x0YWdlX2xldmVsID0gYnh0X2NhbGNfdm9sdGFnZV9sZXZlbChjZGNsa19z
dGF0ZS5jZGNsayk7Cj4gPiAtCWJ4dF9zZXRfY2RjbGsoZGV2X3ByaXYsICZjZGNsa19zdGF0ZSwg
SU5WQUxJRF9QSVBFKTsKPiA+ICsJYnh0X3NldF9jZGNsayhpOTE1LCAmY2RjbGtfc3RhdGUsIElO
VkFMSURfUElQRSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBieHRfdW5pbml0X2NkY2xrKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBieHRfdW5p
bml0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBjZGNsa19zdGF0ZSA9IGRldl9wcml2LT5jZGNsay5odzsK
PiA+ICsJc3RydWN0IGludGVsX2NkY2xrX3N0YXRlIGNkY2xrX3N0YXRlID0gaTkxNS0+Y2RjbGsu
aHc7Cj4gPiAgIAljZGNsa19zdGF0ZS5jZGNsayA9IGNkY2xrX3N0YXRlLmJ5cGFzczsKPiA+ICAg
CWNkY2xrX3N0YXRlLnZjbyA9IDA7Cj4gPiAgIAljZGNsa19zdGF0ZS52b2x0YWdlX2xldmVsID0g
Ynh0X2NhbGNfdm9sdGFnZV9sZXZlbChjZGNsa19zdGF0ZS5jZGNsayk7Cj4gPiAtCWJ4dF9zZXRf
Y2RjbGsoZGV2X3ByaXYsICZjZGNsa19zdGF0ZSwgSU5WQUxJRF9QSVBFKTsKPiA+ICsJYnh0X3Nl
dF9jZGNsayhpOTE1LCAmY2RjbGtfc3RhdGUsIElOVkFMSURfUElQRSk7Cj4gPiAgIH0KPiA+ICAg
c3RhdGljIGludCBjbmxfY2FsY19jZGNsayhpbnQgbWluX2NkY2xrKQo+ID4gQEAgLTE1MzMsNyAr
MTUzMyw3IEBAIHN0YXRpYyB1OCBjbmxfY2FsY192b2x0YWdlX2xldmVsKGludCBjZGNsaykKPiA+
ICAgCQlyZXR1cm4gMDsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGNubF9jZGNsa19wbGxfdXBk
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBj
bmxfY2RjbGtfcGxsX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJCSBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlKQo+ID4gICB7Cj4gPiAg
IAl1MzIgdmFsOwo+ID4gQEAgLTE1NTUsMTMgKzE1NTUsMTMgQEAgc3RhdGljIHZvaWQgY25sX2Nk
Y2xrX3BsbF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
Y2RjbGtfc3RhdGUtPnZjbyA9ICh2YWwgJiBDTkxfQ0RDTEtfUExMX1JBVElPX01BU0spICogY2Rj
bGtfc3RhdGUtPnJlZjsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGNubF9nZXRfY2RjbGsoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGNubF9nZXRf
Y2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSBzdHJ1Y3QgaW50
ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAl1MzIgZGl2aWRlcjsK
PiA+ICAgCWludCBkaXY7Cj4gPiAtCWNubF9jZGNsa19wbGxfdXBkYXRlKGRldl9wcml2LCBjZGNs
a19zdGF0ZSk7Cj4gPiArCWNubF9jZGNsa19wbGxfdXBkYXRlKGk5MTUsIGNkY2xrX3N0YXRlKTsK
PiA+ICAgCWNkY2xrX3N0YXRlLT5jZGNsayA9IGNkY2xrX3N0YXRlLT5ieXBhc3MgPSBjZGNsa19z
dGF0ZS0+cmVmOwo+ID4gQEAgLTE1OTMsNyArMTU5Myw3IEBAIHN0YXRpYyB2b2lkIGNubF9nZXRf
Y2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCWNubF9jYWxj
X3ZvbHRhZ2VfbGV2ZWwoY2RjbGtfc3RhdGUtPmNkY2xrKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2
b2lkIGNubF9jZGNsa19wbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiArc3RhdGljIHZvaWQgY25sX2NkY2xrX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gQEAgLTE2MDUsMTIg
KzE2MDUsMTIgQEAgc3RhdGljIHZvaWQgY25sX2NkY2xrX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCWlmICh3YWl0X2ZvcigoSTkxNV9SRUFEKEJY
VF9ERV9QTExfRU5BQkxFKSAmIEJYVF9ERV9QTExfTE9DSykgPT0gMCwgMSkpCj4gPiAgIAkJRFJN
X0VSUk9SKCJ0aW1lb3V0IHdhaXRpbmcgZm9yIENEQ0xLIFBMTCB1bmxvY2tcbiIpOwo+ID4gLQlk
ZXZfcHJpdi0+Y2RjbGsuaHcudmNvID0gMDsKPiA+ICsJaTkxNS0+Y2RjbGsuaHcudmNvID0gMDsK
PiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGNubF9jZGNsa19wbGxfZW5hYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IHZjbykKPiA+ICtzdGF0aWMgdm9pZCBjbmxfY2Rj
bGtfcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHZjbykKPiA+
ICAgewo+ID4gLQlpbnQgcmF0aW8gPSBESVZfUk9VTkRfQ0xPU0VTVCh2Y28sIGRldl9wcml2LT5j
ZGNsay5ody5yZWYpOwo+ID4gKwlpbnQgcmF0aW8gPSBESVZfUk9VTkRfQ0xPU0VTVCh2Y28sIGk5
MTUtPmNkY2xrLmh3LnJlZik7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gICAJdmFsID0gQ05MX0NEQ0xL
X1BMTF9SQVRJTyhyYXRpbyk7Cj4gPiBAQCAtMTYyMywxMCArMTYyMywxMCBAQCBzdGF0aWMgdm9p
ZCBjbmxfY2RjbGtfcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IGludCB2Y28pCj4gPiAgIAlpZiAod2FpdF9mb3IoKEk5MTVfUkVBRChCWFRfREVfUExMX0VOQUJM
RSkgJiBCWFRfREVfUExMX0xPQ0spICE9IDAsIDEpKQo+ID4gICAJCURSTV9FUlJPUigidGltZW91
dCB3YWl0aW5nIGZvciBDRENMSyBQTEwgbG9ja1xuIik7Cj4gPiAtCWRldl9wcml2LT5jZGNsay5o
dy52Y28gPSB2Y287Cj4gPiArCWk5MTUtPmNkY2xrLmh3LnZjbyA9IHZjbzsKPiA+ICAgfQo+ID4g
LXN0YXRpYyB2b2lkIGNubF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK3N0YXRpYyB2b2lkIGNubF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICpjZGNs
a19zdGF0ZSwKPiA+ICAgCQkJICBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gQEAgLTE2MzUs
NyArMTYzNSw3IEBAIHN0YXRpYyB2b2lkIGNubF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gICAJdTMyIHZhbCwgZGl2aWRlcjsKPiA+ICAgCWludCByZXQ7
Cj4gPiAtCXJldCA9IHNrbF9wY29kZV9yZXF1ZXN0KGRldl9wcml2LCBTS0xfUENPREVfQ0RDTEtf
Q09OVFJPTCwKPiA+ICsJcmV0ID0gc2tsX3Bjb2RlX3JlcXVlc3QoaTkxNSwgU0tMX1BDT0RFX0NE
Q0xLX0NPTlRST0wsCj4gPiAgIAkJCQlTS0xfQ0RDTEtfUFJFUEFSRV9GT1JfQ0hBTkdFLAo+ID4g
ICAJCQkJU0tMX0NEQ0xLX1JFQURZX0ZPUl9DSEFOR0UsCj4gPiAgIAkJCQlTS0xfQ0RDTEtfUkVB
RFlfRk9SX0NIQU5HRSwgMyk7Cj4gPiBAQCAtMTY0OCw3ICsxNjQ4LDcgQEAgc3RhdGljIHZvaWQg
Y25sX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkv
KiBjZGNsayA9IHZjbyAvIDIgLyBkaXZ7MSwyfSAqLwo+ID4gICAJc3dpdGNoIChESVZfUk9VTkRf
Q0xPU0VTVCh2Y28sIGNkY2xrKSkgewo+ID4gICAJZGVmYXVsdDoKPiA+IC0JCVdBUk5fT04oY2Rj
bGsgIT0gZGV2X3ByaXYtPmNkY2xrLmh3LmJ5cGFzcyk7Cj4gPiArCQlXQVJOX09OKGNkY2xrICE9
IGk5MTUtPmNkY2xrLmh3LmJ5cGFzcyk7Cj4gPiAgIAkJV0FSTl9PTih2Y28gIT0gMCk7Cj4gPiAg
IAkJLyogZmFsbCB0aHJvdWdoICovCj4gPiAgIAljYXNlIDI6Cj4gPiBAQCAtMTY1OSwxMiArMTY1
OSwxMiBAQCBzdGF0aWMgdm9pZCBjbmxfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICAgCQlicmVhazsKPiA+ICAgCX0KPiA+IC0JaWYgKGRldl9wcml2LT5j
ZGNsay5ody52Y28gIT0gMCAmJgo+ID4gLQkgICAgZGV2X3ByaXYtPmNkY2xrLmh3LnZjbyAhPSB2
Y28pCj4gPiAtCQljbmxfY2RjbGtfcGxsX2Rpc2FibGUoZGV2X3ByaXYpOwo+ID4gKwlpZiAoaTkx
NS0+Y2RjbGsuaHcudmNvICE9IDAgJiYKPiA+ICsJICAgIGk5MTUtPmNkY2xrLmh3LnZjbyAhPSB2
Y28pCj4gPiArCQljbmxfY2RjbGtfcGxsX2Rpc2FibGUoaTkxNSk7Cj4gPiAtCWlmIChkZXZfcHJp
di0+Y2RjbGsuaHcudmNvICE9IHZjbykKPiA+IC0JCWNubF9jZGNsa19wbGxfZW5hYmxlKGRldl9w
cml2LCB2Y28pOwo+ID4gKwlpZiAoaTkxNS0+Y2RjbGsuaHcudmNvICE9IHZjbykKPiA+ICsJCWNu
bF9jZGNsa19wbGxfZW5hYmxlKGk5MTUsIHZjbyk7Cj4gPiAgIAl2YWwgPSBkaXZpZGVyIHwgc2ts
X2NkY2xrX2RlY2ltYWwoY2RjbGspOwo+ID4gICAJaWYgKHBpcGUgPT0gSU5WQUxJRF9QSVBFKQo+
ID4gQEAgLTE2NzQsMjYgKzE2NzQsMjYgQEAgc3RhdGljIHZvaWQgY25sX3NldF9jZGNsayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlJOTE1X1dSSVRFKENEQ0xLX0NU
TCwgdmFsKTsKPiA+ICAgCWlmIChwaXBlICE9IElOVkFMSURfUElQRSkKPiA+IC0JCWludGVsX3dh
aXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCQlpbnRlbF93YWl0X2Zvcl92Ymxh
bmsoaTkxNSwgcGlwZSk7Cj4gPiAgIAkvKiBpbmZvcm0gUENVIG9mIHRoZSBjaGFuZ2UgKi8KPiA+
IC0Jc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUoZGV2X3ByaXYsIFNLTF9QQ09ERV9DRENMS19DT05U
Uk9MLAo+ID4gKwlzYW5keWJyaWRnZV9wY29kZV93cml0ZShpOTE1LCBTS0xfUENPREVfQ0RDTEtf
Q09OVFJPTCwKPiA+ICAgCQkJCWNkY2xrX3N0YXRlLT52b2x0YWdlX2xldmVsKTsKPiA+IC0JaW50
ZWxfdXBkYXRlX2NkY2xrKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUp
Owo+ID4gICAJLyoKPiA+ICAgCSAqIENhbid0IHJlYWQgb3V0IHRoZSB2b2x0YWdlIGxldmVsIDoo
Cj4gPiAgIAkgKiBMZXQncyBqdXN0IGFzc3VtZSBldmVyeXRoaW5nIGlzIGFzIGV4cGVjdGVkLgo+
ID4gICAJICovCj4gPiAtCWRldl9wcml2LT5jZGNsay5ody52b2x0YWdlX2xldmVsID0gY2RjbGtf
c3RhdGUtPnZvbHRhZ2VfbGV2ZWw7Cj4gPiArCWk5MTUtPmNkY2xrLmh3LnZvbHRhZ2VfbGV2ZWwg
PSBjZGNsa19zdGF0ZS0+dm9sdGFnZV9sZXZlbDsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQgY25s
X2NkY2xrX3BsbF92Y28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgY2Rj
bGspCj4gPiArc3RhdGljIGludCBjbmxfY2RjbGtfcGxsX3ZjbyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgaW50IGNkY2xrKQo+ID4gICB7Cj4gPiAgIAlpbnQgcmF0aW87Cj4gPiAtCWlm
IChjZGNsayA9PSBkZXZfcHJpdi0+Y2RjbGsuaHcuYnlwYXNzKQo+ID4gKwlpZiAoY2RjbGsgPT0g
aTkxNS0+Y2RjbGsuaHcuYnlwYXNzKQo+ID4gICAJCXJldHVybiAwOwo+ID4gICAJc3dpdGNoIChj
ZGNsaykgewo+ID4gQEAgLTE3MDIsMjUgKzE3MDIsMjUgQEAgc3RhdGljIGludCBjbmxfY2RjbGtf
cGxsX3ZjbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBjZGNsaykKPiA+
ICAgCQkvKiBmYWxsIHRocm91Z2ggKi8KPiA+ICAgCWNhc2UgMTY4MDAwOgo+ID4gICAJY2FzZSAz
MzYwMDA6Cj4gPiAtCQlyYXRpbyA9IGRldl9wcml2LT5jZGNsay5ody5yZWYgPT0gMTkyMDAgPyAz
NSA6IDI4Owo+ID4gKwkJcmF0aW8gPSBpOTE1LT5jZGNsay5ody5yZWYgPT0gMTkyMDAgPyAzNSA6
IDI4Owo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSA1MjgwMDA6Cj4gPiAtCQlyYXRpbyA9IGRl
dl9wcml2LT5jZGNsay5ody5yZWYgPT0gMTkyMDAgPyA1NSA6IDQ0Owo+ID4gKwkJcmF0aW8gPSBp
OTE1LT5jZGNsay5ody5yZWYgPT0gMTkyMDAgPyA1NSA6IDQ0Owo+ID4gICAJCWJyZWFrOwo+ID4g
ICAJfQo+ID4gLQlyZXR1cm4gZGV2X3ByaXYtPmNkY2xrLmh3LnJlZiAqIHJhdGlvOwo+ID4gKwly
ZXR1cm4gaTkxNS0+Y2RjbGsuaHcucmVmICogcmF0aW87Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9p
ZCBjbmxfc2FuaXRpemVfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gK3N0YXRpYyB2b2lkIGNubF9zYW5pdGl6ZV9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIGNkY3RsLCBleHBlY3RlZDsKPiA+IC0JaW50ZWxf
dXBkYXRlX2NkY2xrKGRldl9wcml2KTsKPiA+IC0JaW50ZWxfZHVtcF9jZGNsa19zdGF0ZSgmZGV2
X3ByaXYtPmNkY2xrLmh3LCAiQ3VycmVudCBDRENMSyIpOwo+ID4gKwlpbnRlbF91cGRhdGVfY2Rj
bGsoaTkxNSk7Cj4gPiArCWludGVsX2R1bXBfY2RjbGtfc3RhdGUoJmk5MTUtPmNkY2xrLmh3LCAi
Q3VycmVudCBDRENMSyIpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmNkY2xrLmh3LnZjbyA9PSAwIHx8
Cj4gPiAtCSAgICBkZXZfcHJpdi0+Y2RjbGsuaHcuY2RjbGsgPT0gZGV2X3ByaXYtPmNkY2xrLmh3
LmJ5cGFzcykKPiA+ICsJaWYgKGk5MTUtPmNkY2xrLmh3LnZjbyA9PSAwIHx8Cj4gPiArCSAgICBp
OTE1LT5jZGNsay5ody5jZGNsayA9PSBpOTE1LT5jZGNsay5ody5ieXBhc3MpCj4gPiAgIAkJZ290
byBzYW5pdGl6ZTsKPiA+ICAgCS8qIERQTEwgb2theTsgdmVyaWZ5IHRoZSBjZGNsb2NrCj4gPiBA
QCAtMTczOCw3ICsxNzM4LDcgQEAgc3RhdGljIHZvaWQgY25sX3Nhbml0aXplX2NkY2xrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCWNkY3RsICY9IH5CWFRfQ0RDTEtf
Q0QyWF9QSVBFX05PTkU7Cj4gPiAgIAlleHBlY3RlZCA9IChjZGN0bCAmIEJYVF9DRENMS19DRDJY
X0RJVl9TRUxfTUFTSykgfAo+ID4gLQkJICAgc2tsX2NkY2xrX2RlY2ltYWwoZGV2X3ByaXYtPmNk
Y2xrLmh3LmNkY2xrKTsKPiA+ICsJCSAgIHNrbF9jZGNsa19kZWNpbWFsKGk5MTUtPmNkY2xrLmh3
LmNkY2xrKTsKPiA+ICAgCWlmIChjZGN0bCA9PSBleHBlY3RlZCkKPiA+ICAgCQkvKiBBbGwgd2Vs
bDsgbm90aGluZyB0byBzYW5pdGl6ZSAqLwo+ID4gQEAgLTE3NDgsMTAgKzE3NDgsMTAgQEAgc3Rh
dGljIHZvaWQgY25sX3Nhbml0aXplX2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICAgCURSTV9ERUJVR19LTVMoIlNhbml0aXppbmcgY2RjbGsgcHJvZ3JhbW1lZCBi
eSBwcmUtb3NcbiIpOwo+ID4gICAJLyogZm9yY2UgY2RjbGsgcHJvZ3JhbW1pbmcgKi8KPiA+IC0J
ZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrID0gMDsKPiA+ICsJaTkxNS0+Y2RjbGsuaHcuY2RjbGsg
PSAwOwo+ID4gICAJLyogZm9yY2UgZnVsbCBQTEwgZGlzYWJsZSArIGVuYWJsZSAqLwo+ID4gLQlk
ZXZfcHJpdi0+Y2RjbGsuaHcudmNvID0gLTE7Cj4gPiArCWk5MTUtPmNkY2xrLmh3LnZjbyA9IC0x
Owo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgaWNsX2NhbGNfY2RjbGsoaW50IG1pbl9jZGNsaywg
dW5zaWduZWQgaW50IHJlZikKPiA+IEBAIC0xNzgxLDExICsxNzgxLDExIEBAIHN0YXRpYyBpbnQg
aWNsX2NhbGNfY2RjbGsoaW50IG1pbl9jZGNsaywgdW5zaWduZWQgaW50IHJlZikKPiA+ICAgCQly
ZXR1cm4gcmFuZ2VzWzBdOwo+ID4gICB9Cj4gPiAtc3RhdGljIGludCBpY2xfY2FsY19jZGNsa19w
bGxfdmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IGNkY2xrKQo+ID4g
K3N0YXRpYyBpbnQgaWNsX2NhbGNfY2RjbGtfcGxsX3ZjbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwgaW50IGNkY2xrKQo+ID4gICB7Cj4gPiAgIAlpbnQgcmF0aW87Cj4gPiAtCWlmIChj
ZGNsayA9PSBkZXZfcHJpdi0+Y2RjbGsuaHcuYnlwYXNzKQo+ID4gKwlpZiAoY2RjbGsgPT0gaTkx
NS0+Y2RjbGsuaHcuYnlwYXNzKQo+ID4gICAJCXJldHVybiAwOwo+ID4gICAJc3dpdGNoIChjZGNs
aykgewo+ID4gQEAgLTE3OTUsMjEgKzE3OTUsMjEgQEAgc3RhdGljIGludCBpY2xfY2FsY19jZGNs
a19wbGxfdmNvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IGNkY2xrKQo+
ID4gICAJY2FzZSAzMDcyMDA6Cj4gPiAgIAljYXNlIDU1NjgwMDoKPiA+ICAgCWNhc2UgNjUyODAw
Ogo+ID4gLQkJV0FSTl9PTihkZXZfcHJpdi0+Y2RjbGsuaHcucmVmICE9IDE5MjAwICYmCj4gPiAt
CQkJZGV2X3ByaXYtPmNkY2xrLmh3LnJlZiAhPSAzODQwMCk7Cj4gPiArCQlXQVJOX09OKGk5MTUt
PmNkY2xrLmh3LnJlZiAhPSAxOTIwMCAmJgo+ID4gKwkJCWk5MTUtPmNkY2xrLmh3LnJlZiAhPSAz
ODQwMCk7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIDMxMjAwMDoKPiA+ICAgCWNhc2UgNTUy
MDAwOgo+ID4gICAJY2FzZSA2NDgwMDA6Cj4gPiAtCQlXQVJOX09OKGRldl9wcml2LT5jZGNsay5o
dy5yZWYgIT0gMjQwMDApOwo+ID4gKwkJV0FSTl9PTihpOTE1LT5jZGNsay5ody5yZWYgIT0gMjQw
MDApOwo+ID4gICAJfQo+ID4gLQlyYXRpbyA9IGNkY2xrIC8gKGRldl9wcml2LT5jZGNsay5ody5y
ZWYgLyAyKTsKPiA+ICsJcmF0aW8gPSBjZGNsayAvIChpOTE1LT5jZGNsay5ody5yZWYgLyAyKTsK
PiA+IC0JcmV0dXJuIGRldl9wcml2LT5jZGNsay5ody5yZWYgKiByYXRpbzsKPiA+ICsJcmV0dXJu
IGk5MTUtPmNkY2xrLmh3LnJlZiAqIHJhdGlvOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaWNs
X3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGlj
IHZvaWQgaWNsX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlLAo+ID4gICAJ
CQkgIGVudW0gcGlwZSBwaXBlKQo+ID4gICB7Cj4gPiBAQCAtMTgxNyw3ICsxODE3LDcgQEAgc3Rh
dGljIHZvaWQgaWNsX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiAgIAl1bnNpZ25lZCBpbnQgdmNvID0gY2RjbGtfc3RhdGUtPnZjbzsKPiA+ICAgCWludCBy
ZXQ7Cj4gPiAtCXJldCA9IHNrbF9wY29kZV9yZXF1ZXN0KGRldl9wcml2LCBTS0xfUENPREVfQ0RD
TEtfQ09OVFJPTCwKPiA+ICsJcmV0ID0gc2tsX3Bjb2RlX3JlcXVlc3QoaTkxNSwgU0tMX1BDT0RF
X0NEQ0xLX0NPTlRST0wsCj4gPiAgIAkJCQlTS0xfQ0RDTEtfUFJFUEFSRV9GT1JfQ0hBTkdFLAo+
ID4gICAJCQkJU0tMX0NEQ0xLX1JFQURZX0ZPUl9DSEFOR0UsCj4gPiAgIAkJCQlTS0xfQ0RDTEtf
UkVBRFlfRk9SX0NIQU5HRSwgMyk7Cj4gPiBAQCAtMTgyNywxMiArMTgyNywxMiBAQCBzdGF0aWMg
dm9pZCBpY2xfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiAtCWlmIChkZXZfcHJpdi0+Y2RjbGsuaHcudmNvICE9
IDAgJiYKPiA+IC0JICAgIGRldl9wcml2LT5jZGNsay5ody52Y28gIT0gdmNvKQo+ID4gLQkJY25s
X2NkY2xrX3BsbF9kaXNhYmxlKGRldl9wcml2KTsKPiA+ICsJaWYgKGk5MTUtPmNkY2xrLmh3LnZj
byAhPSAwICYmCj4gPiArCSAgICBpOTE1LT5jZGNsay5ody52Y28gIT0gdmNvKQo+ID4gKwkJY25s
X2NkY2xrX3BsbF9kaXNhYmxlKGk5MTUpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmNkY2xrLmh3LnZj
byAhPSB2Y28pCj4gPiAtCQljbmxfY2RjbGtfcGxsX2VuYWJsZShkZXZfcHJpdiwgdmNvKTsKPiA+
ICsJaWYgKGk5MTUtPmNkY2xrLmh3LnZjbyAhPSB2Y28pCj4gPiArCQljbmxfY2RjbGtfcGxsX2Vu
YWJsZShpOTE1LCB2Y28pOwo+ID4gICAJLyoKPiA+ICAgCSAqIE9uIElDTCBDRDJYX0RJViBjYW4g
b25seSBiZSAxLCBzbyB3ZSdsbCBuZXZlciBlbmQgdXAgY2hhbmdpbmcgdGhlCj4gPiBAQCAtMTg0
MiwxNiArMTg0MiwxNiBAQCBzdGF0aWMgdm9pZCBpY2xfc2V0X2NkY2xrKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCUk5MTVfV1JJVEUoQ0RDTEtfQ1RMLCBJQ0xfQ0RD
TEtfQ0QyWF9QSVBFX05PTkUgfAo+ID4gICAJCQkgICAgICBza2xfY2RjbGtfZGVjaW1hbChjZGNs
aykpOwo+ID4gLQlzYW5keWJyaWRnZV9wY29kZV93cml0ZShkZXZfcHJpdiwgU0tMX1BDT0RFX0NE
Q0xLX0NPTlRST0wsCj4gPiArCXNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGk5MTUsIFNLTF9QQ09E
RV9DRENMS19DT05UUk9MLAo+ID4gICAJCQkJY2RjbGtfc3RhdGUtPnZvbHRhZ2VfbGV2ZWwpOwo+
ID4gLQlpbnRlbF91cGRhdGVfY2RjbGsoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF91cGRhdGVfY2Rj
bGsoaTkxNSk7Cj4gPiAgIAkvKgo+ID4gICAJICogQ2FuJ3QgcmVhZCBvdXQgdGhlIHZvbHRhZ2Ug
bGV2ZWwgOigKPiA+ICAgCSAqIExldCdzIGp1c3QgYXNzdW1lIGV2ZXJ5dGhpbmcgaXMgYXMgZXhw
ZWN0ZWQuCj4gPiAgIAkgKi8KPiA+IC0JZGV2X3ByaXYtPmNkY2xrLmh3LnZvbHRhZ2VfbGV2ZWwg
PSBjZGNsa19zdGF0ZS0+dm9sdGFnZV9sZXZlbDsKPiA+ICsJaTkxNS0+Y2RjbGsuaHcudm9sdGFn
ZV9sZXZlbCA9IGNkY2xrX3N0YXRlLT52b2x0YWdlX2xldmVsOwo+ID4gICB9Cj4gPiAgIHN0YXRp
YyB1OCBpY2xfY2FsY192b2x0YWdlX2xldmVsKGludCBjZGNsaykKPiA+IEBAIC0xODY0LDcgKzE4
NjQsNyBAQCBzdGF0aWMgdTggaWNsX2NhbGNfdm9sdGFnZV9sZXZlbChpbnQgY2RjbGspCj4gPiAg
IAkJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpY2xfZ2V0X2NkY2xrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBpY2xfZ2V0X2Nk
Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgIHN0cnVjdCBpbnRl
bF9jZGNsa19zdGF0ZSAqY2RjbGtfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7Cj4gPiBA
QCAtMTkxNSwxNyArMTkxNSwxNyBAQCBzdGF0aWMgdm9pZCBpY2xfZ2V0X2NkY2xrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQlpY2xfY2FsY192b2x0YWdlX2xldmVs
KGNkY2xrX3N0YXRlLT5jZGNsayk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpY2xfaW5pdF9j
ZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQg
aWNsX2luaXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBzYW5pdGl6ZWRfc3RhdGU7Cj4gPiAgIAl1MzIg
dmFsOwo+ID4gLQkvKiBUaGlzIHNldHMgZGV2X3ByaXYtPmNkY2xrLmh3LiAqLwo+ID4gLQlpbnRl
bF91cGRhdGVfY2RjbGsoZGV2X3ByaXYpOwo+ID4gLQlpbnRlbF9kdW1wX2NkY2xrX3N0YXRlKCZk
ZXZfcHJpdi0+Y2RjbGsuaHcsICJDdXJyZW50IENEQ0xLIik7Cj4gPiArCS8qIFRoaXMgc2V0cyBp
OTE1LT5jZGNsay5ody4gKi8KPiA+ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ID4gKwlp
bnRlbF9kdW1wX2NkY2xrX3N0YXRlKCZpOTE1LT5jZGNsay5odywgIkN1cnJlbnQgQ0RDTEsiKTsK
PiA+ICAgCS8qIFRoaXMgbWVhbnMgQ0RDTEsgZGlzYWJsZWQuICovCj4gPiAtCWlmIChkZXZfcHJp
di0+Y2RjbGsuaHcuY2RjbGsgPT0gZGV2X3ByaXYtPmNkY2xrLmh3LmJ5cGFzcykKPiA+ICsJaWYg
KGk5MTUtPmNkY2xrLmh3LmNkY2xrID09IGk5MTUtPmNkY2xrLmh3LmJ5cGFzcykKPiA+ICAgCQln
b3RvIHNhbml0aXplOwo+ID4gICAJdmFsID0gSTkxNV9SRUFEKENEQ0xLX0NUTCk7Cj4gPiBAQCAt
MTkzNCw3ICsxOTM0LDcgQEAgc3RhdGljIHZvaWQgaWNsX2luaXRfY2RjbGsoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCWdvdG8gc2FuaXRpemU7Cj4gPiAgIAlpZiAo
KHZhbCAmIENEQ0xLX0ZSRVFfREVDSU1BTF9NQVNLKSAhPQo+ID4gLQkgICAgc2tsX2NkY2xrX2Rl
Y2ltYWwoZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrKSkKPiA+ICsJICAgIHNrbF9jZGNsa19kZWNp
bWFsKGk5MTUtPmNkY2xrLmh3LmNkY2xrKSkKPiA+ICAgCQlnb3RvIHNhbml0aXplOwo+ID4gICAJ
cmV0dXJuOwo+ID4gQEAgLTE5NDIsNjIgKzE5NDIsNjIgQEAgc3RhdGljIHZvaWQgaWNsX2luaXRf
Y2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICBzYW5pdGl6ZToK
PiA+ICAgCURSTV9ERUJVR19LTVMoIlNhbml0aXppbmcgY2RjbGsgcHJvZ3JhbW1lZCBieSBwcmUt
b3NcbiIpOwo+ID4gLQlzYW5pdGl6ZWRfc3RhdGUucmVmID0gZGV2X3ByaXYtPmNkY2xrLmh3LnJl
ZjsKPiA+ICsJc2FuaXRpemVkX3N0YXRlLnJlZiA9IGk5MTUtPmNkY2xrLmh3LnJlZjsKPiA+ICAg
CXNhbml0aXplZF9zdGF0ZS5jZGNsayA9IGljbF9jYWxjX2NkY2xrKDAsIHNhbml0aXplZF9zdGF0
ZS5yZWYpOwo+ID4gLQlzYW5pdGl6ZWRfc3RhdGUudmNvID0gaWNsX2NhbGNfY2RjbGtfcGxsX3Zj
byhkZXZfcHJpdiwKPiA+ICsJc2FuaXRpemVkX3N0YXRlLnZjbyA9IGljbF9jYWxjX2NkY2xrX3Bs
bF92Y28oaTkxNSwKPiA+ICAgCQkJCQkJICAgICBzYW5pdGl6ZWRfc3RhdGUuY2RjbGspOwo+ID4g
ICAJc2FuaXRpemVkX3N0YXRlLnZvbHRhZ2VfbGV2ZWwgPQo+ID4gICAJCQkJaWNsX2NhbGNfdm9s
dGFnZV9sZXZlbChzYW5pdGl6ZWRfc3RhdGUuY2RjbGspOwo+ID4gLQlpY2xfc2V0X2NkY2xrKGRl
dl9wcml2LCAmc2FuaXRpemVkX3N0YXRlLCBJTlZBTElEX1BJUEUpOwo+ID4gKwlpY2xfc2V0X2Nk
Y2xrKGk5MTUsICZzYW5pdGl6ZWRfc3RhdGUsIElOVkFMSURfUElQRSk7Cj4gPiAgIH0KPiA+IC1z
dGF0aWMgdm9pZCBpY2xfdW5pbml0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpY2xfdW5pbml0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBjZGNs
a19zdGF0ZSA9IGRldl9wcml2LT5jZGNsay5odzsKPiA+ICsJc3RydWN0IGludGVsX2NkY2xrX3N0
YXRlIGNkY2xrX3N0YXRlID0gaTkxNS0+Y2RjbGsuaHc7Cj4gPiAgIAljZGNsa19zdGF0ZS5jZGNs
ayA9IGNkY2xrX3N0YXRlLmJ5cGFzczsKPiA+ICAgCWNkY2xrX3N0YXRlLnZjbyA9IDA7Cj4gPiAg
IAljZGNsa19zdGF0ZS52b2x0YWdlX2xldmVsID0gaWNsX2NhbGNfdm9sdGFnZV9sZXZlbChjZGNs
a19zdGF0ZS5jZGNsayk7Cj4gPiAtCWljbF9zZXRfY2RjbGsoZGV2X3ByaXYsICZjZGNsa19zdGF0
ZSwgSU5WQUxJRF9QSVBFKTsKPiA+ICsJaWNsX3NldF9jZGNsayhpOTE1LCAmY2RjbGtfc3RhdGUs
IElOVkFMSURfUElQRSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBjbmxfaW5pdF9jZGNsayhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgY25sX2lu
aXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBjZGNsa19zdGF0ZTsKPiA+IC0JY25sX3Nhbml0aXplX2Nk
Y2xrKGRldl9wcml2KTsKPiA+ICsJY25sX3Nhbml0aXplX2NkY2xrKGk5MTUpOwo+ID4gLQlpZiAo
ZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrICE9IDAgJiYKPiA+IC0JICAgIGRldl9wcml2LT5jZGNs
ay5ody52Y28gIT0gMCkKPiA+ICsJaWYgKGk5MTUtPmNkY2xrLmh3LmNkY2xrICE9IDAgJiYKPiA+
ICsJICAgIGk5MTUtPmNkY2xrLmh3LnZjbyAhPSAwKQo+ID4gICAJCXJldHVybjsKPiA+IC0JY2Rj
bGtfc3RhdGUgPSBkZXZfcHJpdi0+Y2RjbGsuaHc7Cj4gPiArCWNkY2xrX3N0YXRlID0gaTkxNS0+
Y2RjbGsuaHc7Cj4gPiAgIAljZGNsa19zdGF0ZS5jZGNsayA9IGNubF9jYWxjX2NkY2xrKDApOwo+
ID4gLQljZGNsa19zdGF0ZS52Y28gPSBjbmxfY2RjbGtfcGxsX3ZjbyhkZXZfcHJpdiwgY2RjbGtf
c3RhdGUuY2RjbGspOwo+ID4gKwljZGNsa19zdGF0ZS52Y28gPSBjbmxfY2RjbGtfcGxsX3Zjbyhp
OTE1LCBjZGNsa19zdGF0ZS5jZGNsayk7Cj4gPiAgIAljZGNsa19zdGF0ZS52b2x0YWdlX2xldmVs
ID0gY25sX2NhbGNfdm9sdGFnZV9sZXZlbChjZGNsa19zdGF0ZS5jZGNsayk7Cj4gPiAtCWNubF9z
ZXRfY2RjbGsoZGV2X3ByaXYsICZjZGNsa19zdGF0ZSwgSU5WQUxJRF9QSVBFKTsKPiA+ICsJY25s
X3NldF9jZGNsayhpOTE1LCAmY2RjbGtfc3RhdGUsIElOVkFMSURfUElQRSk7Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgdm9pZCBjbmxfdW5pbml0X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBjbmxfdW5pbml0X2NkY2xrKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBj
ZGNsa19zdGF0ZSA9IGRldl9wcml2LT5jZGNsay5odzsKPiA+ICsJc3RydWN0IGludGVsX2NkY2xr
X3N0YXRlIGNkY2xrX3N0YXRlID0gaTkxNS0+Y2RjbGsuaHc7Cj4gPiAgIAljZGNsa19zdGF0ZS5j
ZGNsayA9IGNkY2xrX3N0YXRlLmJ5cGFzczsKPiA+ICAgCWNkY2xrX3N0YXRlLnZjbyA9IDA7Cj4g
PiAgIAljZGNsa19zdGF0ZS52b2x0YWdlX2xldmVsID0gY25sX2NhbGNfdm9sdGFnZV9sZXZlbChj
ZGNsa19zdGF0ZS5jZGNsayk7Cj4gPiAtCWNubF9zZXRfY2RjbGsoZGV2X3ByaXYsICZjZGNsa19z
dGF0ZSwgSU5WQUxJRF9QSVBFKTsKPiA+ICsJY25sX3NldF9jZGNsayhpOTE1LCAmY2RjbGtfc3Rh
dGUsIElOVkFMSURfUElQRSk7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2NkY2xr
X2luaXQgLSBJbml0aWFsaXplIENEQ0xLCj4gPiAgICAqIEBpOTE1OiBpOTE1IGRldmljZQo+ID4g
ICAgKgo+ID4gLSAqIEluaXRpYWxpemUgQ0RDTEsuIFRoaXMgY29uc2lzdHMgbWFpbmx5IG9mIGlu
aXRpYWxpemluZyBkZXZfcHJpdi0+Y2RjbGsuaHcgYW5kCj4gPiArICogSW5pdGlhbGl6ZSBDRENM
Sy4gVGhpcyBjb25zaXN0cyBtYWlubHkgb2YgaW5pdGlhbGl6aW5nIGk5MTUtPmNkY2xrLmh3IGFu
ZAo+ID4gICAgKiBzYW5pdGl6aW5nIHRoZSBzdGF0ZSBvZiB0aGUgaGFyZHdhcmUgaWYgbmVlZGVk
LiBUaGlzIGlzIGdlbmVyYWxseSBkb25lIG9ubHkKPiA+ICAgICogZHVyaW5nIHRoZSBkaXNwbGF5
IGNvcmUgaW5pdGlhbGl6YXRpb24gc2VxdWVuY2UsIGFmdGVyIHdoaWNoIHRoZSBETUMgd2lsbAo+
ID4gICAgKiB0YWtlIGNhcmUgb2YgdHVybmluZyBDRENMSyBvZmYvb24gYXMgbmVlZGVkLgo+ID4g
QEAgLTIwNTEsMTkgKzIwNTEsMTkgQEAgYm9vbCBpbnRlbF9jZGNsa19uZWVkc19tb2Rlc2V0KGNv
bnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqYSwKPiA+ICAgLyoqCj4gPiAgICAqIGludGVs
X2NkY2xrX25lZWRzX2NkMnhfdXBkYXRlIC0gRGV0ZXJtaW5lIGlmIHR3byBDRENMSyBzdGF0ZXMg
cmVxdWlyZSBhIGNkMnggZGl2aWRlciB1cGRhdGUKPiA+IC0gKiBAZGV2X3ByaXY6IE5vdCBhIENE
Q0xLIHN0YXRlLCBpdCdzIHRoZSBkcm1faTkxNV9wcml2YXRlIQo+ID4gKyAqIEBpOTE1OiBOb3Qg
YSBDRENMSyBzdGF0ZSwgaXQncyB0aGUgZHJtX2k5MTVfcHJpdmF0ZSEKPiA+ICAgICogQGE6IGZp
cnN0IENEQ0xLIHN0YXRlCj4gPiAgICAqIEBiOiBzZWNvbmQgQ0RDTEsgc3RhdGUKPiA+ICAgICoK
PiA+ICAgICogUmV0dXJuczoKPiA+ICAgICogVHJ1ZSBpZiB0aGUgQ0RDTEsgc3RhdGVzIHJlcXVp
cmUganVzdCBhIGNkMnggZGl2aWRlciB1cGRhdGUsIGZhbHNlIGlmIG5vdC4KPiA+ICAgICovCj4g
PiAtYm9vbCBpbnRlbF9jZGNsa19uZWVkc19jZDJ4X3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiArYm9vbCBpbnRlbF9jZGNsa19uZWVkc19jZDJ4X3VwZGF0ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9jZGNsa19zdGF0ZSAqYSwKPiA+ICAgCQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNs
a19zdGF0ZSAqYikKPiA+ICAgewo+ID4gICAJLyogT2xkZXIgaHcgZG9lc24ndCBoYXZlIHRoZSBj
YXBhYmlsaXR5ICovCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTAgJiYgIUlTX0dF
TjlfTFAoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgMTAgJiYgIUlTX0dF
TjlfTFAoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gICAJcmV0dXJuIGEtPmNkY2xr
ICE9IGItPmNkY2xrICYmCj4gPiBAQCAtMjEwMCwxMCArMjEwMCwxMCBAQCBib29sIGludGVsX2Nk
Y2xrX2NoYW5nZWQoY29uc3Qgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICphLAo+ID4gICAgKi8K
PiA+ICAgdm9pZCBpbnRlbF9jZGNsa19zd2FwX3N0YXRlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3Rh
dGUgKnN0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7Cj4gPiAtCXN3YXAoc3RhdGUtPmNk
Y2xrLmxvZ2ljYWwsIGRldl9wcml2LT5jZGNsay5sb2dpY2FsKTsKPiA+IC0Jc3dhcChzdGF0ZS0+
Y2RjbGsuYWN0dWFsLCBkZXZfcHJpdi0+Y2RjbGsuYWN0dWFsKTsKPiA+ICsJc3dhcChzdGF0ZS0+
Y2RjbGsubG9naWNhbCwgaTkxNS0+Y2RjbGsubG9naWNhbCk7Cj4gPiArCXN3YXAoc3RhdGUtPmNk
Y2xrLmFjdHVhbCwgaTkxNS0+Y2RjbGsuYWN0dWFsKTsKPiA+ICAgfQo+ID4gICB2b2lkIGludGVs
X2R1bXBfY2RjbGtfc3RhdGUoY29uc3Qgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICpjZGNsa19z
dGF0ZSwKPiA+IEBAIC0yMTE3LDM3ICsyMTE3LDM3IEBAIHZvaWQgaW50ZWxfZHVtcF9jZGNsa19z
dGF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY2RjbGtfc3RhdGUgKmNkY2xrX3N0YXRlLAo+ID4gICAv
KioKPiA+ICAgICogaW50ZWxfc2V0X2NkY2xrIC0gUHVzaCB0aGUgQ0RDTEsgc3RhdGUgdG8gdGhl
IGhhcmR3YXJlCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZQo+ID4gKyAqIEBpOTE1OiBp
OTE1IGRldmljZQo+ID4gICAgKiBAY2RjbGtfc3RhdGU6IG5ldyBDRENMSyBzdGF0ZQo+ID4gICAg
KiBAcGlwZTogcGlwZSB3aXRoIHdoaWNoIHRvIHN5bmNocm9uaXplIHRoZSB1cGRhdGUKPiA+ICAg
ICoKPiA+ICAgICogUHJvZ3JhbSB0aGUgaGFyZHdhcmUgYmFzZWQgb24gdGhlIHBhc3NlZCBpbiBD
RENMSyBzdGF0ZSwKPiA+ICAgICogaWYgbmVjZXNzYXJ5Lgo+ID4gICAgKi8KPiA+IC1zdGF0aWMg
dm9pZCBpbnRlbF9zZXRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3N0YXRpYyB2b2lkIGludGVsX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqY2RjbGtf
c3RhdGUsCj4gPiAgIAkJCSAgICBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gLQlpZiAoIWlu
dGVsX2NkY2xrX2NoYW5nZWQoJmRldl9wcml2LT5jZGNsay5odywgY2RjbGtfc3RhdGUpKQo+ID4g
KwlpZiAoIWludGVsX2NkY2xrX2NoYW5nZWQoJmk5MTUtPmNkY2xrLmh3LCBjZGNsa19zdGF0ZSkp
Cj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlpZiAoV0FSTl9PTl9PTkNFKCFkZXZfcHJpdi0+ZGlzcGxh
eS5zZXRfY2RjbGspKQo+ID4gKwlpZiAoV0FSTl9PTl9PTkNFKCFpOTE1LT5kaXNwbGF5LnNldF9j
ZGNsaykpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJaW50ZWxfZHVtcF9jZGNsa19zdGF0ZShjZGNs
a19zdGF0ZSwgIkNoYW5naW5nIENEQ0xLIHRvIik7Cj4gPiAtCWRldl9wcml2LT5kaXNwbGF5LnNl
dF9jZGNsayhkZXZfcHJpdiwgY2RjbGtfc3RhdGUsIHBpcGUpOwo+ID4gKwlpOTE1LT5kaXNwbGF5
LnNldF9jZGNsayhpOTE1LCBjZGNsa19zdGF0ZSwgcGlwZSk7Cj4gPiAtCWlmIChXQVJOKGludGVs
X2NkY2xrX2NoYW5nZWQoJmRldl9wcml2LT5jZGNsay5odywgY2RjbGtfc3RhdGUpLAo+ID4gKwlp
ZiAoV0FSTihpbnRlbF9jZGNsa19jaGFuZ2VkKCZpOTE1LT5jZGNsay5odywgY2RjbGtfc3RhdGUp
LAo+ID4gICAJCSAiY2RjbGsgc3RhdGUgZG9lc24ndCBtYXRjaCFcbiIpKSB7Cj4gPiAtCQlpbnRl
bF9kdW1wX2NkY2xrX3N0YXRlKCZkZXZfcHJpdi0+Y2RjbGsuaHcsICJbaHcgc3RhdGVdIik7Cj4g
PiArCQlpbnRlbF9kdW1wX2NkY2xrX3N0YXRlKCZpOTE1LT5jZGNsay5odywgIltodyBzdGF0ZV0i
KTsKPiA+ICAgCQlpbnRlbF9kdW1wX2NkY2xrX3N0YXRlKGNkY2xrX3N0YXRlLCAiW3N3IHN0YXRl
XSIpOwo+ID4gICAJfQo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9zZXRfY2RjbGtf
cHJlX3BsYW5lX3VwZGF0ZSAtIFB1c2ggdGhlIENEQ0xLIHN0YXRlIHRvIHRoZSBoYXJkd2FyZQo+
ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UK
PiA+ICAgICogQG9sZF9zdGF0ZTogb2xkIENEQ0xLIHN0YXRlCj4gPiAgICAqIEBuZXdfc3RhdGU6
IG5ldyBDRENMSyBzdGF0ZQo+ID4gICAgKiBAcGlwZTogcGlwZSB3aXRoIHdoaWNoIHRvIHN5bmNo
cm9uaXplIHRoZSB1cGRhdGUKPiA+IEBAIC0yMTU2LDE4ICsyMTU2LDE4IEBAIHN0YXRpYyB2b2lk
IGludGVsX3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAg
ICAqIGluIENEQ0xLIHN0YXRlLCBpZiBuZWNlc3NhcnkuCj4gPiAgICAqLwo+ID4gICB2b2lkCj4g
PiAtaW50ZWxfc2V0X2NkY2xrX3ByZV9wbGFuZV91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK2ludGVsX3NldF9jZGNsa19wcmVfcGxhbmVfdXBkYXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9j
ZGNsa19zdGF0ZSAqb2xkX3N0YXRlLAo+ID4gICAJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNs
a19zdGF0ZSAqbmV3X3N0YXRlLAo+ID4gICAJCQkJIGVudW0gcGlwZSBwaXBlKQo+ID4gICB7Cj4g
PiAgIAlpZiAocGlwZSA9PSBJTlZBTElEX1BJUEUgfHwgb2xkX3N0YXRlLT5jZGNsayA8PSBuZXdf
c3RhdGUtPmNkY2xrKQo+ID4gLQkJaW50ZWxfc2V0X2NkY2xrKGRldl9wcml2LCBuZXdfc3RhdGUs
IHBpcGUpOwo+ID4gKwkJaW50ZWxfc2V0X2NkY2xrKGk5MTUsIG5ld19zdGF0ZSwgcGlwZSk7Cj4g
PiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX3NldF9jZGNsa19wb3N0X3BsYW5lX3VwZGF0
ZSAtIFB1c2ggdGhlIENEQ0xLIHN0YXRlIHRvIHRoZSBoYXJkd2FyZQo+ID4gLSAqIEBkZXZfcHJp
djogaTkxNSBkZXZpY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UKPiA+ICAgICogQG9sZF9z
dGF0ZTogb2xkIENEQ0xLIHN0YXRlCj4gPiAgICAqIEBuZXdfc3RhdGU6IG5ldyBDRENMSyBzdGF0
ZQo+ID4gICAgKiBAcGlwZTogcGlwZSB3aXRoIHdoaWNoIHRvIHN5bmNocm9uaXplIHRoZSB1cGRh
dGUKPiA+IEBAIC0yMTc2LDI0ICsyMTc2LDI0IEBAIGludGVsX3NldF9jZGNsa19wcmVfcGxhbmVf
dXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgICogaW4gQ0RD
TEsgc3RhdGUsIGlmIG5lY2Vzc2FyeS4KPiA+ICAgICovCj4gPiAgIHZvaWQKPiA+IC1pbnRlbF9z
ZXRfY2RjbGtfcG9zdF9wbGFuZV91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK2ludGVsX3NldF9jZGNsa19wb3N0X3BsYW5lX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NkY2xrX3N0
YXRlICpvbGRfc3RhdGUsCj4gPiAgIAkJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0
ZSAqbmV3X3N0YXRlLAo+ID4gICAJCQkJICBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gICAJ
aWYgKHBpcGUgIT0gSU5WQUxJRF9QSVBFICYmIG9sZF9zdGF0ZS0+Y2RjbGsgPiBuZXdfc3RhdGUt
PmNkY2xrKQo+ID4gLQkJaW50ZWxfc2V0X2NkY2xrKGRldl9wcml2LCBuZXdfc3RhdGUsIHBpcGUp
Owo+ID4gKwkJaW50ZWxfc2V0X2NkY2xrKGk5MTUsIG5ld19zdGF0ZSwgcGlwZSk7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgaW50IGludGVsX3BpeGVsX3JhdGVfdG9fY2RjbGsoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBpbnQgaW50ZWxfcGl4ZWxfcmF0ZV90b19j
ZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgaW50IHBp
eGVsX3JhdGUpCj4gPiAgIHsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwg
SVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTAg
fHwgSVNfR0VNSU5JTEFLRShpOTE1KSkKPiA+ICAgCQlyZXR1cm4gRElWX1JPVU5EX1VQKHBpeGVs
X3JhdGUsIDIpOwo+ID4gLQllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDkpIHx8Cj4gPiAtCQkg
SVNfQlJPQURXRUxMKGRldl9wcml2KSB8fCBJU19IQVNXRUxMKGRldl9wcml2KSkKPiA+ICsJZWxz
ZSBpZiAoSVNfR0VOKGk5MTUsIDkpIHx8Cj4gPiArCQkgSVNfQlJPQURXRUxMKGk5MTUpIHx8IElT
X0hBU1dFTEwoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIHBpeGVsX3JhdGU7Cj4gPiAtCWVsc2UgaWYg
KElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19DSEVSUllWSUVXKGk5
MTUpKQo+ID4gICAJCXJldHVybiBESVZfUk9VTkRfVVAocGl4ZWxfcmF0ZSAqIDEwMCwgOTUpOwo+
ID4gICAJZWxzZQo+ID4gICAJCXJldHVybiBESVZfUk9VTkRfVVAocGl4ZWxfcmF0ZSAqIDEwMCwg
OTApOwo+ID4gQEAgLTIyMDEsMTcgKzIyMDEsMTcgQEAgc3RhdGljIGludCBpbnRlbF9waXhlbF9y
YXRlX3RvX2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgaW50
IGludGVsX2NydGNfY29tcHV0ZV9taW5fY2RjbGsoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ID4gICAJCXRv
X2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gICAJaW50IG1pbl9jZGNsazsK
PiA+ICAgCWlmICghY3J0Y19zdGF0ZS0+YmFzZS5lbmFibGUpCj4gPiAgIAkJcmV0dXJuIDA7Cj4g
PiAtCW1pbl9jZGNsayA9IGludGVsX3BpeGVsX3JhdGVfdG9fY2RjbGsoZGV2X3ByaXYsIGNydGNf
c3RhdGUtPnBpeGVsX3JhdGUpOwo+ID4gKwltaW5fY2RjbGsgPSBpbnRlbF9waXhlbF9yYXRlX3Rv
X2NkY2xrKGk5MTUsIGNydGNfc3RhdGUtPnBpeGVsX3JhdGUpOwo+ID4gICAJLyogcGl4ZWwgcmF0
ZSBtdXN0bid0IGV4Y2VlZCA5NSUgb2YgY2RjbGsgd2l0aCBJUFMgb24gQkRXICovCj4gPiAtCWlm
IChJU19CUk9BRFdFTEwoZGV2X3ByaXYpICYmIGhzd19jcnRjX3N0YXRlX2lwc19jYXBhYmxlKGNy
dGNfc3RhdGUpKQo+ID4gKwlpZiAoSVNfQlJPQURXRUxMKGk5MTUpICYmIGhzd19jcnRjX3N0YXRl
X2lwc19jYXBhYmxlKGNydGNfc3RhdGUpKQo+ID4gICAJCW1pbl9jZGNsayA9IERJVl9ST1VORF9V
UChtaW5fY2RjbGsgKiAxMDAsIDk1KTsKPiA+ICAgCS8qIEJTcGVjIHNheXMgIkRvIG5vdCB1c2Ug
RGlzcGxheVBvcnQgd2l0aCBDRENMSyBsZXNzIHRoYW4gNDMyIE1IeiwKPiA+IEBAIC0yMjIzLDEw
ICsyMjIzLDEwIEBAIGludCBpbnRlbF9jcnRjX2NvbXB1dGVfbWluX2NkY2xrKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICAJICAgIGNydGNfc3RhdGUtPmhh
c19hdWRpbyAmJgo+ID4gICAJICAgIGNydGNfc3RhdGUtPnBvcnRfY2xvY2sgPj0gNTQwMDAwICYm
Cj4gPiAgIAkgICAgY3J0Y19zdGF0ZS0+bGFuZV9jb3VudCA9PSA0KSB7Cj4gPiAtCQlpZiAoSVNf
Q0FOTk9OTEFLRShkZXZfcHJpdikgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJ
CWlmIChJU19DQU5OT05MQUtFKGk5MTUpIHx8IElTX0dFTUlOSUxBS0UoaTkxNSkpIHsKPiA+ICAg
CQkJLyogRGlzcGxheSBXQSAjMTE0NTogZ2xrLGNubCAqLwo+ID4gICAJCQltaW5fY2RjbGsgPSBt
YXgoMzE2ODAwLCBtaW5fY2RjbGspOwo+ID4gLQkJfSBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYs
IDkpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiA+ICsJCX0gZWxzZSBpZiAoSVNfR0VO
KGk5MTUsIDkpIHx8IElTX0JST0FEV0VMTChpOTE1KSkgewo+ID4gICAJCQkvKiBEaXNwbGF5IFdB
ICMxMTQ0OiBza2wsYnh0ICovCj4gPiAgIAkJCW1pbl9jZGNsayA9IG1heCg0MzIwMDAsIG1pbl9j
ZGNsayk7Cj4gPiAgIAkJfQo+ID4gQEAgLTIyMzYsNyArMjIzNiw3IEBAIGludCBpbnRlbF9jcnRj
X2NvbXB1dGVfbWluX2NkY2xrKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ID4gICAJICogQWNjb3JkaW5nIHRvIEJTcGVjLCAiVGhlIENEIGNsb2NrIGZyZXF1ZW5j
eSBtdXN0IGJlIGF0IGxlYXN0IHR3aWNlCj4gPiAgIAkgKiB0aGUgZnJlcXVlbmN5IG9mIHRoZSBB
emFsaWEgQkNMSy4iIGFuZCBCQ0xLIGlzIDk2IE1IeiBieSBkZWZhdWx0Lgo+ID4gICAJICovCj4g
PiAtCWlmIChjcnRjX3N0YXRlLT5oYXNfYXVkaW8gJiYgSU5URUxfR0VOKGRldl9wcml2KSA+PSA5
KQo+ID4gKwlpZiAoY3J0Y19zdGF0ZS0+aGFzX2F1ZGlvICYmIElOVEVMX0dFTihpOTE1KSA+PSA5
KQo+ID4gICAJCW1pbl9jZGNsayA9IG1heCgyICogOTYwMDAsIG1pbl9jZGNsayk7Cj4gPiAgIAkv
Kgo+ID4gQEAgLTIyNDQsNyArMjI0NCw3IEBAIGludCBpbnRlbF9jcnRjX2NvbXB1dGVfbWluX2Nk
Y2xrKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICAJICog
dGhhbiAzMjAwMDBLSHouCj4gPiAgIAkgKi8KPiA+ICAgCWlmIChpbnRlbF9jcnRjX2hhc190eXBl
KGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9EU0kpICYmCj4gPiAtCSAgICBJU19WQUxMRVlWSUVX
KGRldl9wcml2KSkKPiA+ICsJICAgIElTX1ZBTExFWVZJRVcoaTkxNSkpCj4gPiAgIAkJbWluX2Nk
Y2xrID0gbWF4KDMyMDAwMCwgbWluX2NkY2xrKTsKPiA+ICAgCS8qCj4gPiBAQCAtMjI1MywxMiAr
MjI1MywxMiBAQCBpbnQgaW50ZWxfY3J0Y19jb21wdXRlX21pbl9jZGNsayhjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgCSAqIGNvcnJlY3QgZm9yIERTSSBQ
TEwgYW5kIERFIFBMTC4KPiA+ICAgCSAqLwo+ID4gICAJaWYgKGludGVsX2NydGNfaGFzX3R5cGUo
Y3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0RTSSkgJiYKPiA+IC0JICAgIElTX0dFTUlOSUxBS0Uo
ZGV2X3ByaXYpKQo+ID4gKwkgICAgSVNfR0VNSU5JTEFLRShpOTE1KSkKPiA+ICAgCQltaW5fY2Rj
bGsgPSBtYXgoMTU4NDAwLCBtaW5fY2RjbGspOwo+ID4gLQlpZiAobWluX2NkY2xrID4gZGV2X3By
aXYtPm1heF9jZGNsa19mcmVxKSB7Cj4gPiArCWlmIChtaW5fY2RjbGsgPiBpOTE1LT5tYXhfY2Rj
bGtfZnJlcSkgewo+ID4gICAJCURSTV9ERUJVR19LTVMoInJlcXVpcmVkIGNkY2xrICglZCBrSHop
IGV4Y2VlZHMgbWF4ICglZCBrSHopXG4iLAo+ID4gLQkJCSAgICAgIG1pbl9jZGNsaywgZGV2X3By
aXYtPm1heF9jZGNsa19mcmVxKTsKPiA+ICsJCQkgICAgICBtaW5fY2RjbGssIGk5MTUtPm1heF9j
ZGNsa19mcmVxKTsKPiA+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICAgCX0KPiA+IEBAIC0yMjY3
LDEzICsyMjY3LDEzIEBAIGludCBpbnRlbF9jcnRjX2NvbXB1dGVfbWluX2NkY2xrKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICBzdGF0aWMgaW50IGludGVs
X2NvbXB1dGVfbWluX2NkY2xrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3Rh
dGUtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KHN0YXRlLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOwo+ID4gICAJaW50IG1pbl9j
ZGNsaywgaTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlOwo+ID4gLQltZW1jcHkoc3RhdGUtPm1pbl9j
ZGNsaywgZGV2X3ByaXYtPm1pbl9jZGNsaywKPiA+ICsJbWVtY3B5KHN0YXRlLT5taW5fY2RjbGss
IGk5MTUtPm1pbl9jZGNsaywKPiA+ICAgCSAgICAgICBzaXplb2Yoc3RhdGUtPm1pbl9jZGNsaykp
Owo+ID4gICAJZm9yX2VhY2hfbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIGNy
dGNfc3RhdGUsIGkpIHsKPiA+IEBAIC0yMjg1LDcgKzIyODUsNyBAQCBzdGF0aWMgaW50IGludGVs
X2NvbXB1dGVfbWluX2NkY2xrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4g
ICAJfQo+ID4gICAJbWluX2NkY2xrID0gc3RhdGUtPmNkY2xrLmZvcmNlX21pbl9jZGNsazsKPiA+
IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkKPiA+ICsJZm9yX2VhY2hfcGlwZShpOTE1
LCBwaXBlKQo+ID4gICAJCW1pbl9jZGNsayA9IG1heChzdGF0ZS0+bWluX2NkY2xrW3BpcGVdLCBt
aW5fY2RjbGspOwo+ID4gICAJcmV0dXJuIG1pbl9jZGNsazsKPiA+IEBAIC0yMzAyLDE0ICsyMzAy
LDE0IEBAIHN0YXRpYyBpbnQgaW50ZWxfY29tcHV0ZV9taW5fY2RjbGsoc3RydWN0IGludGVsX2F0
b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgdTggY25sX2NvbXB1dGVf
bWluX3ZvbHRhZ2VfbGV2ZWwoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0
ZS0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoc3RhdGUtPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ID4g
ICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGU7Cj4gPiAgIAl1OCBtaW5fdm9s
dGFnZV9sZXZlbDsKPiA+ICAgCWludCBpOwo+ID4gICAJZW51bSBwaXBlIHBpcGU7Cj4gPiAtCW1l
bWNweShzdGF0ZS0+bWluX3ZvbHRhZ2VfbGV2ZWwsIGRldl9wcml2LT5taW5fdm9sdGFnZV9sZXZl
bCwKPiA+ICsJbWVtY3B5KHN0YXRlLT5taW5fdm9sdGFnZV9sZXZlbCwgaTkxNS0+bWluX3ZvbHRh
Z2VfbGV2ZWwsCj4gPiAgIAkgICAgICAgc2l6ZW9mKHN0YXRlLT5taW5fdm9sdGFnZV9sZXZlbCkp
Owo+ID4gICAJZm9yX2VhY2hfbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIGNy
dGNfc3RhdGUsIGkpIHsKPiA+IEBAIC0yMzIxLDcgKzIzMjEsNyBAQCBzdGF0aWMgdTggY25sX2Nv
bXB1dGVfbWluX3ZvbHRhZ2VfbGV2ZWwoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUp
Cj4gPiAgIAl9Cj4gPiAgIAltaW5fdm9sdGFnZV9sZXZlbCA9IDA7Cj4gPiAtCWZvcl9lYWNoX3Bp
cGUoZGV2X3ByaXYsIHBpcGUpCj4gPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkKPiA+ICAg
CQltaW5fdm9sdGFnZV9sZXZlbCA9IG1heChzdGF0ZS0+bWluX3ZvbHRhZ2VfbGV2ZWxbcGlwZV0s
Cj4gPiAgIAkJCQkJbWluX3ZvbHRhZ2VfbGV2ZWwpOwo+ID4gQEAgLTIzMzAsMjUgKzIzMzAsMjUg
QEAgc3RhdGljIHU4IGNubF9jb21wdXRlX21pbl92b2x0YWdlX2xldmVsKHN0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICBzdGF0aWMgaW50IHZsdl9tb2Rlc2V0X2NhbGNfY2Rj
bGsoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoc3RhdGUtPmJhc2Uu
ZGV2KTsKPiA+ICAgCWludCBtaW5fY2RjbGssIGNkY2xrOwo+ID4gICAJbWluX2NkY2xrID0gaW50
ZWxfY29tcHV0ZV9taW5fY2RjbGsoc3RhdGUpOwo+ID4gICAJaWYgKG1pbl9jZGNsayA8IDApCj4g
PiAgIAkJcmV0dXJuIG1pbl9jZGNsazsKPiA+IC0JY2RjbGsgPSB2bHZfY2FsY19jZGNsayhkZXZf
cHJpdiwgbWluX2NkY2xrKTsKPiA+ICsJY2RjbGsgPSB2bHZfY2FsY19jZGNsayhpOTE1LCBtaW5f
Y2RjbGspOwo+ID4gICAJc3RhdGUtPmNkY2xrLmxvZ2ljYWwuY2RjbGsgPSBjZGNsazsKPiA+ICAg
CXN0YXRlLT5jZGNsay5sb2dpY2FsLnZvbHRhZ2VfbGV2ZWwgPQo+ID4gLQkJdmx2X2NhbGNfdm9s
dGFnZV9sZXZlbChkZXZfcHJpdiwgY2RjbGspOwo+ID4gKwkJdmx2X2NhbGNfdm9sdGFnZV9sZXZl
bChpOTE1LCBjZGNsayk7Cj4gPiAgIAlpZiAoIXN0YXRlLT5hY3RpdmVfY3J0Y3MpIHsKPiA+IC0J
CWNkY2xrID0gdmx2X2NhbGNfY2RjbGsoZGV2X3ByaXYsIHN0YXRlLT5jZGNsay5mb3JjZV9taW5f
Y2RjbGspOwo+ID4gKwkJY2RjbGsgPSB2bHZfY2FsY19jZGNsayhpOTE1LCBzdGF0ZS0+Y2RjbGsu
Zm9yY2VfbWluX2NkY2xrKTsKPiA+ICAgCQlzdGF0ZS0+Y2RjbGsuYWN0dWFsLmNkY2xrID0gY2Rj
bGs7Cj4gPiAgIAkJc3RhdGUtPmNkY2xrLmFjdHVhbC52b2x0YWdlX2xldmVsID0KPiA+IC0JCQl2
bHZfY2FsY192b2x0YWdlX2xldmVsKGRldl9wcml2LCBjZGNsayk7Cj4gPiArCQkJdmx2X2NhbGNf
dm9sdGFnZV9sZXZlbChpOTE1LCBjZGNsayk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCXN0YXRl
LT5jZGNsay5hY3R1YWwgPSBzdGF0ZS0+Y2RjbGsubG9naWNhbDsKPiA+ICAgCX0KPiA+IEBAIC0y
Mzg5LDE0ICsyMzg5LDE0IEBAIHN0YXRpYyBpbnQgYmR3X21vZGVzZXRfY2FsY19jZGNsayhzdHJ1
Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgc3RhdGljIGludCBza2xfZHBsbDBf
dmNvKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHN0YXRlLT5iYXNl
LmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOwo+ID4gICAJaW50IHZjbywgaTsKPiA+ICAgCXZjbyA9
IHN0YXRlLT5jZGNsay5sb2dpY2FsLnZjbzsKPiA+ICAgCWlmICghdmNvKQo+ID4gLQkJdmNvID0g
ZGV2X3ByaXYtPnNrbF9wcmVmZXJyZWRfdmNvX2ZyZXE7Cj4gPiArCQl2Y28gPSBpOTE1LT5za2xf
cHJlZmVycmVkX3Zjb19mcmVxOwo+ID4gICAJZm9yX2VhY2hfbmV3X2ludGVsX2NydGNfaW5fc3Rh
dGUoc3RhdGUsIGNydGMsIGNydGNfc3RhdGUsIGkpIHsKPiA+ICAgCQlpZiAoIWNydGNfc3RhdGUt
PmJhc2UuZW5hYmxlKQo+ID4gQEAgLTI0NjAsMTkgKzI0NjAsMTkgQEAgc3RhdGljIGludCBza2xf
bW9kZXNldF9jYWxjX2NkY2xrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4g
ICBzdGF0aWMgaW50IGJ4dF9tb2Rlc2V0X2NhbGNfY2RjbGsoc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKPiA+ICAgCWludCBtaW5fY2Rj
bGssIGNkY2xrLCB2Y287Cj4gPiAgIAltaW5fY2RjbGsgPSBpbnRlbF9jb21wdXRlX21pbl9jZGNs
ayhzdGF0ZSk7Cj4gPiAgIAlpZiAobWluX2NkY2xrIDwgMCkKPiA+ICAgCQlyZXR1cm4gbWluX2Nk
Y2xrOwo+ID4gLQlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0dF
TUlOSUxBS0UoaTkxNSkpIHsKPiA+ICAgCQljZGNsayA9IGdsa19jYWxjX2NkY2xrKG1pbl9jZGNs
ayk7Cj4gPiAtCQl2Y28gPSBnbGtfZGVfcGxsX3ZjbyhkZXZfcHJpdiwgY2RjbGspOwo+ID4gKwkJ
dmNvID0gZ2xrX2RlX3BsbF92Y28oaTkxNSwgY2RjbGspOwo+ID4gICAJfSBlbHNlIHsKPiA+ICAg
CQljZGNsayA9IGJ4dF9jYWxjX2NkY2xrKG1pbl9jZGNsayk7Cj4gPiAtCQl2Y28gPSBieHRfZGVf
cGxsX3ZjbyhkZXZfcHJpdiwgY2RjbGspOwo+ID4gKwkJdmNvID0gYnh0X2RlX3BsbF92Y28oaTkx
NSwgY2RjbGspOwo+ID4gICAJfQo+ID4gICAJc3RhdGUtPmNkY2xrLmxvZ2ljYWwudmNvID0gdmNv
Owo+ID4gQEAgLTI0ODEsMTIgKzI0ODEsMTIgQEAgc3RhdGljIGludCBieHRfbW9kZXNldF9jYWxj
X2NkY2xrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICAJCWJ4dF9jYWxj
X3ZvbHRhZ2VfbGV2ZWwoY2RjbGspOwo+ID4gICAJaWYgKCFzdGF0ZS0+YWN0aXZlX2NydGNzKSB7
Cj4gPiAtCQlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJCWlmIChJU19HRU1J
TklMQUtFKGk5MTUpKSB7Cj4gPiAgIAkJCWNkY2xrID0gZ2xrX2NhbGNfY2RjbGsoc3RhdGUtPmNk
Y2xrLmZvcmNlX21pbl9jZGNsayk7Cj4gPiAtCQkJdmNvID0gZ2xrX2RlX3BsbF92Y28oZGV2X3By
aXYsIGNkY2xrKTsKPiA+ICsJCQl2Y28gPSBnbGtfZGVfcGxsX3ZjbyhpOTE1LCBjZGNsayk7Cj4g
PiAgIAkJfSBlbHNlIHsKPiA+ICAgCQkJY2RjbGsgPSBieHRfY2FsY19jZGNsayhzdGF0ZS0+Y2Rj
bGsuZm9yY2VfbWluX2NkY2xrKTsKPiA+IC0JCQl2Y28gPSBieHRfZGVfcGxsX3ZjbyhkZXZfcHJp
diwgY2RjbGspOwo+ID4gKwkJCXZjbyA9IGJ4dF9kZV9wbGxfdmNvKGk5MTUsIGNkY2xrKTsKPiA+
ICAgCQl9Cj4gPiAgIAkJc3RhdGUtPmNkY2xrLmFjdHVhbC52Y28gPSB2Y287Cj4gPiBAQCAtMjUw
Miw3ICsyNTAyLDcgQEAgc3RhdGljIGludCBieHRfbW9kZXNldF9jYWxjX2NkY2xrKHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICBzdGF0aWMgaW50IGNubF9tb2Rlc2V0X2Nh
bGNfY2RjbGsoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoc3RhdGUt
PmJhc2UuZGV2KTsKPiA+ICAgCWludCBtaW5fY2RjbGssIGNkY2xrLCB2Y287Cj4gPiAgIAltaW5f
Y2RjbGsgPSBpbnRlbF9jb21wdXRlX21pbl9jZGNsayhzdGF0ZSk7Cj4gPiBAQCAtMjUxMCw3ICsy
NTEwLDcgQEAgc3RhdGljIGludCBjbmxfbW9kZXNldF9jYWxjX2NkY2xrKHN0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICAJCXJldHVybiBtaW5fY2RjbGs7Cj4gPiAgIAljZGNs
ayA9IGNubF9jYWxjX2NkY2xrKG1pbl9jZGNsayk7Cj4gPiAtCXZjbyA9IGNubF9jZGNsa19wbGxf
dmNvKGRldl9wcml2LCBjZGNsayk7Cj4gPiArCXZjbyA9IGNubF9jZGNsa19wbGxfdmNvKGk5MTUs
IGNkY2xrKTsKPiA+ICAgCXN0YXRlLT5jZGNsay5sb2dpY2FsLnZjbyA9IHZjbzsKPiA+ICAgCXN0
YXRlLT5jZGNsay5sb2dpY2FsLmNkY2xrID0gY2RjbGs7Cj4gPiBAQCAtMjUyMCw3ICsyNTIwLDcg
QEAgc3RhdGljIGludCBjbmxfbW9kZXNldF9jYWxjX2NkY2xrKHN0cnVjdCBpbnRlbF9hdG9taWNf
c3RhdGUgKnN0YXRlKQo+ID4gICAJaWYgKCFzdGF0ZS0+YWN0aXZlX2NydGNzKSB7Cj4gPiAgIAkJ
Y2RjbGsgPSBjbmxfY2FsY19jZGNsayhzdGF0ZS0+Y2RjbGsuZm9yY2VfbWluX2NkY2xrKTsKPiA+
IC0JCXZjbyA9IGNubF9jZGNsa19wbGxfdmNvKGRldl9wcml2LCBjZGNsayk7Cj4gPiArCQl2Y28g
PSBjbmxfY2RjbGtfcGxsX3ZjbyhpOTE1LCBjZGNsayk7Cj4gPiAgIAkJc3RhdGUtPmNkY2xrLmFj
dHVhbC52Y28gPSB2Y287Cj4gPiAgIAkJc3RhdGUtPmNkY2xrLmFjdHVhbC5jZGNsayA9IGNkY2xr
Owo+ID4gQEAgLTI1MzUsNyArMjUzNSw3IEBAIHN0YXRpYyBpbnQgY25sX21vZGVzZXRfY2FsY19j
ZGNsayhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgc3RhdGljIGludCBp
Y2xfbW9kZXNldF9jYWxjX2NkY2xrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
c3RhdGUtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KHN0YXRlLT5iYXNlLmRldik7Cj4gPiAgIAl1bnNpZ25lZCBpbnQgcmVmID0gc3RhdGUt
PmNkY2xrLmxvZ2ljYWwucmVmOwo+ID4gICAJaW50IG1pbl9jZGNsaywgY2RjbGssIHZjbzsKPiA+
IEBAIC0yNTQ0LDcgKzI1NDQsNyBAQCBzdGF0aWMgaW50IGljbF9tb2Rlc2V0X2NhbGNfY2RjbGso
c3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIAkJcmV0dXJuIG1pbl9jZGNs
azsKPiA+ICAgCWNkY2xrID0gaWNsX2NhbGNfY2RjbGsobWluX2NkY2xrLCByZWYpOwo+ID4gLQl2
Y28gPSBpY2xfY2FsY19jZGNsa19wbGxfdmNvKGRldl9wcml2LCBjZGNsayk7Cj4gPiArCXZjbyA9
IGljbF9jYWxjX2NkY2xrX3BsbF92Y28oaTkxNSwgY2RjbGspOwo+ID4gICAJc3RhdGUtPmNkY2xr
LmxvZ2ljYWwudmNvID0gdmNvOwo+ID4gICAJc3RhdGUtPmNkY2xrLmxvZ2ljYWwuY2RjbGsgPSBj
ZGNsazsKPiA+IEBAIC0yNTU0LDcgKzI1NTQsNyBAQCBzdGF0aWMgaW50IGljbF9tb2Rlc2V0X2Nh
bGNfY2RjbGsoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIAlpZiAoIXN0
YXRlLT5hY3RpdmVfY3J0Y3MpIHsKPiA+ICAgCQljZGNsayA9IGljbF9jYWxjX2NkY2xrKHN0YXRl
LT5jZGNsay5mb3JjZV9taW5fY2RjbGssIHJlZik7Cj4gPiAtCQl2Y28gPSBpY2xfY2FsY19jZGNs
a19wbGxfdmNvKGRldl9wcml2LCBjZGNsayk7Cj4gPiArCQl2Y28gPSBpY2xfY2FsY19jZGNsa19w
bGxfdmNvKGk5MTUsIGNkY2xrKTsKPiA+ICAgCQlzdGF0ZS0+Y2RjbGsuYWN0dWFsLnZjbyA9IHZj
bzsKPiA+ICAgCQlzdGF0ZS0+Y2RjbGsuYWN0dWFsLmNkY2xrID0gY2RjbGs7Cj4gPiBAQCAtMjU2
NywxOCArMjU2NywxOCBAQCBzdGF0aWMgaW50IGljbF9tb2Rlc2V0X2NhbGNfY2RjbGsoc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4g
LXN0YXRpYyBpbnQgaW50ZWxfY29tcHV0ZV9tYXhfZG90Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgaW50IGludGVsX2NvbXB1dGVfbWF4X2RvdGNsayhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpbnQgbWF4X2NkY2xr
X2ZyZXEgPSBkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXE7Cj4gPiArCWludCBtYXhfY2RjbGtfZnJl
cSA9IGk5MTUtPm1heF9jZGNsa19mcmVxOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSAxMCB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGk5MTUpKQo+ID4gICAJCXJldHVybiAyICogbWF4X2Nk
Y2xrX2ZyZXE7Cj4gPiAtCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgOSkgfHwKPiA+IC0JCSBJ
U19CUk9BRFdFTEwoZGV2X3ByaXYpIHx8IElTX0hBU1dFTEwoZGV2X3ByaXYpKQo+ID4gKwllbHNl
IGlmIChJU19HRU4oaTkxNSwgOSkgfHwKPiA+ICsJCSBJU19CUk9BRFdFTEwoaTkxNSkgfHwgSVNf
SEFTV0VMTChpOTE1KSkKPiA+ICAgCQlyZXR1cm4gbWF4X2NkY2xrX2ZyZXE7Cj4gPiAtCWVsc2Ug
aWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19DSEVSUllWSUVX
KGk5MTUpKQo+ID4gICAJCXJldHVybiBtYXhfY2RjbGtfZnJlcSo5NS8xMDA7Cj4gPiAtCWVsc2Ug
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA0KQo+ID4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkx
NSkgPCA0KQo+ID4gICAJCXJldHVybiAyKm1heF9jZGNsa19mcmVxKjkwLzEwMDsKPiA+ICAgCWVs
c2UKPiA+ICAgCQlyZXR1cm4gbWF4X2NkY2xrX2ZyZXEqOTAvMTAwOwo+ID4gQEAgLTI1ODYsMjYg
KzI1ODYsMjYgQEAgc3RhdGljIGludCBpbnRlbF9jb21wdXRlX21heF9kb3RjbGsoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfdXBkYXRl
X21heF9jZGNsayAtIERldGVybWluZSB0aGUgbWF4aW11bSBzdXBwb3J0IENEQ0xLIGZyZXF1ZW5j
eQo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZp
Y2UKPiA+ICAgICoKPiA+ICAgICogRGV0ZXJtaW5lIHRoZSBtYXhpbXVtIENEQ0xLIGZyZXF1ZW5j
eSB0aGUgcGxhdGZvcm0gc3VwcG9ydHMsIGFuZCBhbHNvCj4gPiAgICAqIGRlcml2ZSB0aGUgbWF4
aW11bSBkb3QgY2xvY2sgZnJlcXVlbmN5IHRoZSBtYXhpbXVtIENEQ0xLIGZyZXF1ZW5jeQo+ID4g
ICAgKiBhbGxvd3MuCj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfdXBkYXRlX21heF9jZGNsayhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF91cGRhdGVf
bWF4X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiAtCQlpZiAoZGV2X3ByaXYtPmNkY2xr
Lmh3LnJlZiA9PSAyNDAwMCkKPiA+IC0JCQlkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEgPSA2NDgw
MDA7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiA+ICsJCWlmIChpOTE1LT5j
ZGNsay5ody5yZWYgPT0gMjQwMDApCj4gPiArCQkJaTkxNS0+bWF4X2NkY2xrX2ZyZXEgPSA2NDgw
MDA7Cj4gPiAgIAkJZWxzZQo+ID4gLQkJCWRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSA9IDY1Mjgw
MDsKPiA+IC0JfSBlbHNlIGlmIChJU19DQU5OT05MQUtFKGRldl9wcml2KSkgewo+ID4gLQkJZGV2
X3ByaXYtPm1heF9jZGNsa19mcmVxID0gNTI4MDAwOwo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTjlf
QkMoZGV2X3ByaXYpKSB7Cj4gPiArCQkJaTkxNS0+bWF4X2NkY2xrX2ZyZXEgPSA2NTI4MDA7Cj4g
PiArCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkgewo+ID4gKwkJaTkxNS0+bWF4X2Nk
Y2xrX2ZyZXEgPSA1MjgwMDA7Cj4gPiArCX0gZWxzZSBpZiAoSVNfR0VOOV9CQyhpOTE1KSkgewo+
ID4gICAJCXUzMiBsaW1pdCA9IEk5MTVfUkVBRChTS0xfREZTTSkgJiBTS0xfREZTTV9DRENMS19M
SU1JVF9NQVNLOwo+ID4gICAJCWludCBtYXhfY2RjbGssIHZjbzsKPiA+IC0JCXZjbyA9IGRldl9w
cml2LT5za2xfcHJlZmVycmVkX3Zjb19mcmVxOwo+ID4gKwkJdmNvID0gaTkxNS0+c2tsX3ByZWZl
cnJlZF92Y29fZnJlcTsKPiA+ICAgCQlXQVJOX09OKHZjbyAhPSA4MTAwMDAwICYmIHZjbyAhPSA4
NjQwMDAwKTsKPiA+ICAgCQkvKgo+ID4gQEAgLTI2MjIsMTIgKzI2MjIsMTIgQEAgdm9pZCBpbnRl
bF91cGRhdGVfbWF4X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCQllbHNlCj4gPiAgIAkJCW1heF9jZGNsayA9IDMwODU3MTsKPiA+IC0JCWRldl9wcml2LT5t
YXhfY2RjbGtfZnJlcSA9IHNrbF9jYWxjX2NkY2xrKG1heF9jZGNsaywgdmNvKTsKPiA+IC0JfSBl
bHNlIGlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSkgewo+ID4gLQkJZGV2X3ByaXYtPm1heF9j
ZGNsa19mcmVxID0gMzE2ODAwOwo+ID4gLQl9IGVsc2UgaWYgKElTX0JST1hUT04oZGV2X3ByaXYp
KSB7Cj4gPiAtCQlkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEgPSA2MjQwMDA7Cj4gPiAtCX0gZWxz
ZSBpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkgIHsKPiA+ICsJCWk5MTUtPm1heF9jZGNsa19m
cmVxID0gc2tsX2NhbGNfY2RjbGsobWF4X2NkY2xrLCB2Y28pOwo+ID4gKwl9IGVsc2UgaWYgKElT
X0dFTUlOSUxBS0UoaTkxNSkpIHsKPiA+ICsJCWk5MTUtPm1heF9jZGNsa19mcmVxID0gMzE2ODAw
Owo+ID4gKwl9IGVsc2UgaWYgKElTX0JST1hUT04oaTkxNSkpIHsKPiA+ICsJCWk5MTUtPm1heF9j
ZGNsa19mcmVxID0gNjI0MDAwOwo+ID4gKwl9IGVsc2UgaWYgKElTX0JST0FEV0VMTChpOTE1KSkg
IHsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIEZJWE1FIHdpdGggZXh0cmEgY29vbGluZyB3ZSBjYW4g
YWxsb3cKPiA+ICAgCQkgKiA1NDAgTUh6IGZvciBVTFggYW5kIDY3NSBNaHogZm9yIFVMVC4KPiA+
IEBAIC0yNjM1LDQwICsyNjM1LDQwIEBAIHZvaWQgaW50ZWxfdXBkYXRlX21heF9jZGNsayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICogYXZhaWxhYmxlPyBQQ0kg
SUQsIFZUQiwgc29tZXRoaW5nIGVsc2U/Cj4gPiAgIAkJICovCj4gPiAgIAkJaWYgKEk5MTVfUkVB
RChGVVNFX1NUUkFQKSAmIEhTV19DRENMS19MSU1JVCkKPiA+IC0JCQlkZXZfcHJpdi0+bWF4X2Nk
Y2xrX2ZyZXEgPSA0NTAwMDA7Cj4gPiAtCQllbHNlIGlmIChJU19CRFdfVUxYKGRldl9wcml2KSkK
PiA+IC0JCQlkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEgPSA0NTAwMDA7Cj4gPiAtCQllbHNlIGlm
IChJU19CRFdfVUxUKGRldl9wcml2KSkKPiA+IC0JCQlkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEg
PSA1NDAwMDA7Cj4gPiArCQkJaTkxNS0+bWF4X2NkY2xrX2ZyZXEgPSA0NTAwMDA7Cj4gPiArCQll
bHNlIGlmIChJU19CRFdfVUxYKGk5MTUpKQo+ID4gKwkJCWk5MTUtPm1heF9jZGNsa19mcmVxID0g
NDUwMDAwOwo+ID4gKwkJZWxzZSBpZiAoSVNfQkRXX1VMVChpOTE1KSkKPiA+ICsJCQlpOTE1LT5t
YXhfY2RjbGtfZnJlcSA9IDU0MDAwMDsKPiA+ICAgCQllbHNlCj4gPiAtCQkJZGV2X3ByaXYtPm1h
eF9jZGNsa19mcmVxID0gNjc1MDAwOwo+ID4gLQl9IGVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2
X3ByaXYpKSB7Cj4gPiAtCQlkZXZfcHJpdi0+bWF4X2NkY2xrX2ZyZXEgPSAzMjAwMDA7Cj4gPiAt
CX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpIHsKPiA+IC0JCWRldl9wcml2LT5t
YXhfY2RjbGtfZnJlcSA9IDQwMDAwMDsKPiA+ICsJCQlpOTE1LT5tYXhfY2RjbGtfZnJlcSA9IDY3
NTAwMDsKPiA+ICsJfSBlbHNlIGlmIChJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiArCQlpOTE1
LT5tYXhfY2RjbGtfZnJlcSA9IDMyMDAwMDsKPiA+ICsJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVX
KGk5MTUpKSB7Cj4gPiArCQlpOTE1LT5tYXhfY2RjbGtfZnJlcSA9IDQwMDAwMDsKPiA+ICAgCX0g
ZWxzZSB7Cj4gPiAgIAkJLyogb3RoZXJ3aXNlIGFzc3VtZSBjZGNsayBpcyBmaXhlZCAqLwo+ID4g
LQkJZGV2X3ByaXYtPm1heF9jZGNsa19mcmVxID0gZGV2X3ByaXYtPmNkY2xrLmh3LmNkY2xrOwo+
ID4gKwkJaTkxNS0+bWF4X2NkY2xrX2ZyZXEgPSBpOTE1LT5jZGNsay5ody5jZGNsazsKPiA+ICAg
CX0KPiA+IC0JZGV2X3ByaXYtPm1heF9kb3RjbGtfZnJlcSA9IGludGVsX2NvbXB1dGVfbWF4X2Rv
dGNsayhkZXZfcHJpdik7Cj4gPiArCWk5MTUtPm1heF9kb3RjbGtfZnJlcSA9IGludGVsX2NvbXB1
dGVfbWF4X2RvdGNsayhpOTE1KTsKPiA+ICAgCURSTV9ERUJVR19EUklWRVIoIk1heCBDRCBjbG9j
ayByYXRlOiAlZCBrSHpcbiIsCj4gPiAtCQkJIGRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSk7Cj4g
PiArCQkJIGk5MTUtPm1heF9jZGNsa19mcmVxKTsKPiA+ICAgCURSTV9ERUJVR19EUklWRVIoIk1h
eCBkb3RjbG9jayByYXRlOiAlZCBrSHpcbiIsCj4gPiAtCQkJIGRldl9wcml2LT5tYXhfZG90Y2xr
X2ZyZXEpOwo+ID4gKwkJCSBpOTE1LT5tYXhfZG90Y2xrX2ZyZXEpOwo+ID4gICB9Cj4gPiAgIC8q
Kgo+ID4gICAgKiBpbnRlbF91cGRhdGVfY2RjbGsgLSBEZXRlcm1pbmUgdGhlIGN1cnJlbnQgQ0RD
TEsgZnJlcXVlbmN5Cj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZQo+ID4gKyAqIEBpOTE1
OiBpOTE1IGRldmljZQo+ID4gICAgKgo+ID4gICAgKiBEZXRlcm1pbmUgdGhlIGN1cnJlbnQgQ0RD
TEsgZnJlcXVlbmN5Lgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX3VwZGF0ZV9jZGNsayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF91cGRhdGVfY2Rj
bGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JZGV2X3ByaXYt
PmRpc3BsYXkuZ2V0X2NkY2xrKGRldl9wcml2LCAmZGV2X3ByaXYtPmNkY2xrLmh3KTsKPiA+ICsJ
aTkxNS0+ZGlzcGxheS5nZXRfY2RjbGsoaTkxNSwgJmk5MTUtPmNkY2xrLmh3KTsKPiA+ICAgCS8q
Cj4gPiAgIAkgKiA5OjAgQ01CVVMgW3NpY10gQ0RDTEsgZnJlcXVlbmN5IChjZGZyZXEpOgo+ID4g
QEAgLTI2NzYsMTIgKzI2NzYsMTIgQEAgdm9pZCBpbnRlbF91cGRhdGVfY2RjbGsoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICogb2YgY2RjbGsgdGhhdCBnZW5lcmF0
ZXMgNE1IeiByZWZlcmVuY2UgY2xvY2sgZnJlcSB3aGljaCBpcyB1c2VkIHRvCj4gPiAgIAkgKiBn
ZW5lcmF0ZSBHTUJ1cyBjbG9jay4gVGhpcyB3aWxsIHZhcnkgd2l0aCB0aGUgY2RjbGsgZnJlcS4K
PiA+ICAgCSAqLwo+ID4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZ
VklFVyhkZXZfcHJpdikpCj4gPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJS
WVZJRVcoaTkxNSkpCj4gPiAgIAkJSTkxNV9XUklURShHTUJVU0ZSRVFfVkxWLAo+ID4gLQkJCSAg
IERJVl9ST1VORF9VUChkZXZfcHJpdi0+Y2RjbGsuaHcuY2RjbGssIDEwMDApKTsKPiA+ICsJCQkg
ICBESVZfUk9VTkRfVVAoaTkxNS0+Y2RjbGsuaHcuY2RjbGssIDEwMDApKTsKPiA+ICAgfQo+ID4g
LXN0YXRpYyBpbnQgY25wX3Jhd2NsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiArc3RhdGljIGludCBjbnBfcmF3Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ID4gICB7Cj4gPiAgIAl1MzIgcmF3Y2xrOwo+ID4gICAJaW50IGRpdmlkZXIsIGZyYWN0aW9u
Owo+ID4gQEAgLTI3MDIsNyArMjcwMiw3IEBAIHN0YXRpYyBpbnQgY25wX3Jhd2NsayhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJcmF3Y2xrIHw9IENOUF9SQVdDTEtf
REVOKERJVl9ST1VORF9DTE9TRVNUKG51bWVyYXRvciAqIDEwMDAsCj4gPiAgIAkJCQkJCQkgICBm
cmFjdGlvbikgLSAxKTsKPiA+IC0JCWlmIChJTlRFTF9QQ0hfVFlQRShkZXZfcHJpdikgPj0gUENI
X0lDUCkKPiA+ICsJCWlmIChJTlRFTF9QQ0hfVFlQRShpOTE1KSA+PSBQQ0hfSUNQKQo+ID4gICAJ
CQlyYXdjbGsgfD0gSUNQX1JBV0NMS19OVU0obnVtZXJhdG9yKTsKPiA+ICAgCX0KPiA+IEBAIC0y
NzEwLDE5ICsyNzEwLDE5IEBAIHN0YXRpYyBpbnQgY25wX3Jhd2NsayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlyZXR1cm4gZGl2aWRlciArIGZyYWN0aW9uOwo+ID4g
ICB9Cj4gPiAtc3RhdGljIGludCBwY2hfcmF3Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtzdGF0aWMgaW50IHBjaF9yYXdjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXJldHVybiAoSTkxNV9SRUFEKFBDSF9SQVdDTEtfRlJF
USkgJiBSQVdDTEtfRlJFUV9NQVNLKSAqIDEwMDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IHZs
dl9ocmF3Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMg
aW50IHZsdl9ocmF3Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAgIAkvKiBSQVdDTEtfRlJFUV9WTFYgcmVnaXN0ZXIgdXBkYXRlZCBmcm9tIHBvd2VyIHdlbGwg
Y29kZSAqLwo+ID4gLQlyZXR1cm4gdmx2X2dldF9jY2tfY2xvY2tfaHBsbChkZXZfcHJpdiwgImhy
YXdjbGsiLAo+ID4gKwlyZXR1cm4gdmx2X2dldF9jY2tfY2xvY2tfaHBsbChpOTE1LCAiaHJhd2Ns
ayIsCj4gPiAgIAkJCQkgICAgICBDQ0tfRElTUExBWV9SRUZfQ0xPQ0tfQ09OVFJPTCk7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgaW50IGc0eF9ocmF3Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtzdGF0aWMgaW50IGc0eF9ocmF3Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIgY2xrY2ZnOwo+ID4gQEAgLTI3NTAsMTA0ICsy
NzUwLDEwNCBAQCBzdGF0aWMgaW50IGc0eF9ocmF3Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX3VwZGF0ZV9yYXdjbGsgLSBEZXRl
cm1pbmUgdGhlIGN1cnJlbnQgUkFXQ0xLIGZyZXF1ZW5jeQo+ID4gLSAqIEBkZXZfcHJpdjogaTkx
NSBkZXZpY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UKPiA+ICAgICoKPiA+ICAgICogRGV0
ZXJtaW5lIHRoZSBjdXJyZW50IFJBV0NMSyBmcmVxdWVuY3kuIFJBV0NMSyBpcyBhIGZpeGVkCj4g
PiAgICAqIGZyZXF1ZW5jeSBjbG9jayBzbyB0aGlzIG5lZWRzIHRvIGRvbmUgb25seSBvbmNlLgo+
ID4gICAgKi8KPiA+IC12b2lkIGludGVsX3VwZGF0ZV9yYXdjbGsoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gLXsKPiA+IC0JaWYgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2
KSA+PSBQQ0hfQ05QKQo+ID4gLQkJZGV2X3ByaXYtPnJhd2Nsa19mcmVxID0gY25wX3Jhd2Nsayhk
ZXZfcHJpdik7Cj4gPiAtCWVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKQo+ID4gLQkJ
ZGV2X3ByaXYtPnJhd2Nsa19mcmVxID0gcGNoX3Jhd2NsayhkZXZfcHJpdik7Cj4gPiAtCWVsc2Ug
aWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+
ID4gLQkJZGV2X3ByaXYtPnJhd2Nsa19mcmVxID0gdmx2X2hyYXdjbGsoZGV2X3ByaXYpOwo+ID4g
LQllbHNlIGlmIChJU19HNFgoZGV2X3ByaXYpIHx8IElTX1BJTkVWSUVXKGRldl9wcml2KSkKPiA+
IC0JCWRldl9wcml2LT5yYXdjbGtfZnJlcSA9IGc0eF9ocmF3Y2xrKGRldl9wcml2KTsKPiA+ICt2
b2lkIGludGVsX3VwZGF0ZV9yYXdjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiArewo+ID4gKwlpZiAoSU5URUxfUENIX1RZUEUoaTkxNSkgPj0gUENIX0NOUCkKPiA+ICsJCWk5
MTUtPnJhd2Nsa19mcmVxID0gY25wX3Jhd2NsayhpOTE1KTsKPiA+ICsJZWxzZSBpZiAoSEFTX1BD
SF9TUExJVChpOTE1KSkKPiA+ICsJCWk5MTUtPnJhd2Nsa19mcmVxID0gcGNoX3Jhd2NsayhpOTE1
KTsKPiA+ICsJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5
MTUpKQo+ID4gKwkJaTkxNS0+cmF3Y2xrX2ZyZXEgPSB2bHZfaHJhd2NsayhpOTE1KTsKPiA+ICsJ
ZWxzZSBpZiAoSVNfRzRYKGk5MTUpIHx8IElTX1BJTkVWSUVXKGk5MTUpKQo+ID4gKwkJaTkxNS0+
cmF3Y2xrX2ZyZXEgPSBnNHhfaHJhd2NsayhpOTE1KTsKPiA+ICAgCWVsc2UKPiA+ICAgCQkvKiBu
byByYXdjbGsgb24gb3RoZXIgcGxhdGZvcm1zLCBvciBubyBuZWVkIHRvIGtub3cgaXQgKi8KPiA+
ICAgCQlyZXR1cm47Cj4gPiAtCURSTV9ERUJVR19EUklWRVIoInJhd2NsayByYXRlOiAlZCBrSHpc
biIsIGRldl9wcml2LT5yYXdjbGtfZnJlcSk7Cj4gPiArCURSTV9ERUJVR19EUklWRVIoInJhd2Ns
ayByYXRlOiAlZCBrSHpcbiIsIGk5MTUtPnJhd2Nsa19mcmVxKTsKPiA+ICAgfQo+ID4gICAvKioK
PiA+ICAgICogaW50ZWxfaW5pdF9jZGNsa19ob29rcyAtIEluaXRpYWxpemUgQ0RDTEsgcmVsYXRl
ZCBtb2Rlc2V0dGluZyBob29rcwo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiA+ICsg
KiBAaTkxNTogaTkxNSBkZXZpY2UKPiA+ICAgICovCj4gPiAtdm9pZCBpbnRlbF9pbml0X2NkY2xr
X2hvb2tzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+IC17Cj4gPiAtCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5z
ZXRfY2RjbGsgPSBpY2xfc2V0X2NkY2xrOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkubW9kZXNl
dF9jYWxjX2NkY2xrID0gaWNsX21vZGVzZXRfY2FsY19jZGNsazsKPiA+IC0JfSBlbHNlIGlmIChJ
U19DQU5OT05MQUtFKGRldl9wcml2KSkgewo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuc2V0X2Nk
Y2xrID0gY25sX3NldF9jZGNsazsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5Lm1vZGVzZXRfY2Fs
Y19jZGNsayA9IGNubF9tb2Rlc2V0X2NhbGNfY2RjbGs7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfR0VO
OV9MUChkZXZfcHJpdikpIHsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LnNldF9jZGNsayA9IGJ4
dF9zZXRfY2RjbGs7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5tb2Rlc2V0X2NhbGNfY2RjbGsg
PSBieHRfbW9kZXNldF9jYWxjX2NkY2xrOwo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTjlfQkMoZGV2
X3ByaXYpKSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5zZXRfY2RjbGsgPSBza2xfc2V0X2Nk
Y2xrOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkubW9kZXNldF9jYWxjX2NkY2xrID0gc2tsX21v
ZGVzZXRfY2FsY19jZGNsazsKPiA+IC0JfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYp
KSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5zZXRfY2RjbGsgPSBiZHdfc2V0X2NkY2xrOwo+
ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkubW9kZXNldF9jYWxjX2NkY2xrID0gYmR3X21vZGVzZXRf
Y2FsY19jZGNsazsKPiA+IC0JfSBlbHNlIGlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+
ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuc2V0X2NkY2xrID0gY2h2X3NldF9jZGNsazsKPiA+IC0J
CWRldl9wcml2LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19jZGNsayA9IHZsdl9tb2Rlc2V0X2NhbGNf
Y2RjbGs7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpIHsKPiA+IC0J
CWRldl9wcml2LT5kaXNwbGF5LnNldF9jZGNsayA9IHZsdl9zZXRfY2RjbGs7Cj4gPiAtCQlkZXZf
cHJpdi0+ZGlzcGxheS5tb2Rlc2V0X2NhbGNfY2RjbGsgPSB2bHZfbW9kZXNldF9jYWxjX2NkY2xr
Owo+ID4gK3ZvaWQgaW50ZWxfaW5pdF9jZGNsa19ob29rcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiA+ICt7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiA+ICsJ
CWk5MTUtPmRpc3BsYXkuc2V0X2NkY2xrID0gaWNsX3NldF9jZGNsazsKPiA+ICsJCWk5MTUtPmRp
c3BsYXkubW9kZXNldF9jYWxjX2NkY2xrID0gaWNsX21vZGVzZXRfY2FsY19jZGNsazsKPiA+ICsJ
fSBlbHNlIGlmIChJU19DQU5OT05MQUtFKGk5MTUpKSB7Cj4gPiArCQlpOTE1LT5kaXNwbGF5LnNl
dF9jZGNsayA9IGNubF9zZXRfY2RjbGs7Cj4gPiArCQlpOTE1LT5kaXNwbGF5Lm1vZGVzZXRfY2Fs
Y19jZGNsayA9IGNubF9tb2Rlc2V0X2NhbGNfY2RjbGs7Cj4gPiArCX0gZWxzZSBpZiAoSVNfR0VO
OV9MUChpOTE1KSkgewo+ID4gKwkJaTkxNS0+ZGlzcGxheS5zZXRfY2RjbGsgPSBieHRfc2V0X2Nk
Y2xrOwo+ID4gKwkJaTkxNS0+ZGlzcGxheS5tb2Rlc2V0X2NhbGNfY2RjbGsgPSBieHRfbW9kZXNl
dF9jYWxjX2NkY2xrOwo+ID4gKwl9IGVsc2UgaWYgKElTX0dFTjlfQkMoaTkxNSkpIHsKPiA+ICsJ
CWk5MTUtPmRpc3BsYXkuc2V0X2NkY2xrID0gc2tsX3NldF9jZGNsazsKPiA+ICsJCWk5MTUtPmRp
c3BsYXkubW9kZXNldF9jYWxjX2NkY2xrID0gc2tsX21vZGVzZXRfY2FsY19jZGNsazsKPiA+ICsJ
fSBlbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuc2V0
X2NkY2xrID0gYmR3X3NldF9jZGNsazsKPiA+ICsJCWk5MTUtPmRpc3BsYXkubW9kZXNldF9jYWxj
X2NkY2xrID0gYmR3X21vZGVzZXRfY2FsY19jZGNsazsKPiA+ICsJfSBlbHNlIGlmIChJU19DSEVS
UllWSUVXKGk5MTUpKSB7Cj4gPiArCQlpOTE1LT5kaXNwbGF5LnNldF9jZGNsayA9IGNodl9zZXRf
Y2RjbGs7Cj4gPiArCQlpOTE1LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19jZGNsayA9IHZsdl9tb2Rl
c2V0X2NhbGNfY2RjbGs7Cj4gPiArCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkgewo+
ID4gKwkJaTkxNS0+ZGlzcGxheS5zZXRfY2RjbGsgPSB2bHZfc2V0X2NkY2xrOwo+ID4gKwkJaTkx
NS0+ZGlzcGxheS5tb2Rlc2V0X2NhbGNfY2RjbGsgPSB2bHZfbW9kZXNldF9jYWxjX2NkY2xrOwo+
ID4gICAJfQo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiA+IC0JCWRldl9w
cml2LT5kaXNwbGF5LmdldF9jZGNsayA9IGljbF9nZXRfY2RjbGs7Cj4gPiAtCWVsc2UgaWYgKElT
X0NBTk5PTkxBS0UoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2NkY2xr
ID0gY25sX2dldF9jZGNsazsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4g
PiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfY2RjbGsgPSBieHRfZ2V0X2NkY2xrOwo+ID4gLQll
bHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2KSkKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5Lmdl
dF9jZGNsayA9IHNrbF9nZXRfY2RjbGs7Cj4gPiAtCWVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZf
cHJpdikpCj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfY2RjbGsgPSBiZHdfZ2V0X2NkY2xr
Owo+ID4gLQllbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSkKPiA+IC0JCWRldl9wcml2LT5k
aXNwbGF5LmdldF9jZGNsayA9IGhzd19nZXRfY2RjbGs7Cj4gPiAtCWVsc2UgaWYgKElTX1ZBTExF
WVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3By
aXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gdmx2X2dldF9jZGNsazsKPiA+IC0JZWxzZSBpZiAoSVNf
R0VOKGRldl9wcml2LCA2KSB8fCBJU19JVllCUklER0UoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3By
aXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZml4ZWRfNDAwbWh6X2dldF9jZGNsazsKPiA+IC0JZWxz
ZSBpZiAoSVNfR0VOKGRldl9wcml2LCA1KSkKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9j
ZGNsayA9IGZpeGVkXzQ1MG1oel9nZXRfY2RjbGs7Cj4gPiAtCWVsc2UgaWYgKElTX0dNNDUoZGV2
X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZ200NV9nZXRfY2Rj
bGs7Cj4gPiAtCWVsc2UgaWYgKElTX0c0NShkZXZfcHJpdikpCj4gPiAtCQlkZXZfcHJpdi0+ZGlz
cGxheS5nZXRfY2RjbGsgPSBnMzNfZ2V0X2NkY2xrOwo+ID4gLQllbHNlIGlmIChJU19JOTY1R00o
ZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gaTk2NWdtX2dl
dF9jZGNsazsKPiA+IC0JZWxzZSBpZiAoSVNfSTk2NUcoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3By
aXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZml4ZWRfNDAwbWh6X2dldF9jZGNsazsKPiA+IC0JZWxz
ZSBpZiAoSVNfUElORVZJRVcoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0
X2NkY2xrID0gcG52X2dldF9jZGNsazsKPiA+IC0JZWxzZSBpZiAoSVNfRzMzKGRldl9wcml2KSkK
PiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9jZGNsayA9IGczM19nZXRfY2RjbGs7Cj4gPiAt
CWVsc2UgaWYgKElTX0k5NDVHTShkZXZfcHJpdikpCj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5n
ZXRfY2RjbGsgPSBpOTQ1Z21fZ2V0X2NkY2xrOwo+ID4gLQllbHNlIGlmIChJU19JOTQ1RyhkZXZf
cHJpdikpCj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfY2RjbGsgPSBmaXhlZF80MDBtaHpf
Z2V0X2NkY2xrOwo+ID4gLQllbHNlIGlmIChJU19JOTE1R00oZGV2X3ByaXYpKQo+ID4gLQkJZGV2
X3ByaXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gaTkxNWdtX2dldF9jZGNsazsKPiA+IC0JZWxzZSBp
ZiAoSVNfSTkxNUcoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2NkY2xr
ID0gZml4ZWRfMzMzbWh6X2dldF9jZGNsazsKPiA+IC0JZWxzZSBpZiAoSVNfSTg2NUcoZGV2X3By
aXYpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZml4ZWRfMjY2bWh6X2dl
dF9jZGNsazsKPiA+IC0JZWxzZSBpZiAoSVNfSTg1WChkZXZfcHJpdikpCj4gPiAtCQlkZXZfcHJp
di0+ZGlzcGxheS5nZXRfY2RjbGsgPSBpODV4X2dldF9jZGNsazsKPiA+IC0JZWxzZSBpZiAoSVNf
STg0NUcoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZml4
ZWRfMjAwbWh6X2dldF9jZGNsazsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+
ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gaWNsX2dldF9jZGNsazsKPiA+ICsJZWxzZSBp
ZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0g
Y25sX2dldF9jZGNsazsKPiA+ICsJZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiA+ICsJCWk5
MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gYnh0X2dldF9jZGNsazsKPiA+ICsJZWxzZSBpZiAoSVNf
R0VOOV9CQyhpOTE1KSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gc2tsX2dldF9j
ZGNsazsKPiA+ICsJZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpKQo+ID4gKwkJaTkxNS0+ZGlz
cGxheS5nZXRfY2RjbGsgPSBiZHdfZ2V0X2NkY2xrOwo+ID4gKwllbHNlIGlmIChJU19IQVNXRUxM
KGk5MTUpKQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5nZXRfY2RjbGsgPSBoc3dfZ2V0X2NkY2xrOwo+
ID4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkp
Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9IHZsdl9nZXRfY2RjbGs7Cj4gPiArCWVs
c2UgaWYgKElTX0dFTihpOTE1LCA2KSB8fCBJU19JVllCUklER0UoaTkxNSkpCj4gPiArCQlpOTE1
LT5kaXNwbGF5LmdldF9jZGNsayA9IGZpeGVkXzQwMG1oel9nZXRfY2RjbGs7Cj4gPiArCWVsc2Ug
aWYgKElTX0dFTihpOTE1LCA1KSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZml4
ZWRfNDUwbWh6X2dldF9jZGNsazsKPiA+ICsJZWxzZSBpZiAoSVNfR000NShpOTE1KSkKPiA+ICsJ
CWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZ200NV9nZXRfY2RjbGs7Cj4gPiArCWVsc2UgaWYg
KElTX0c0NShpOTE1KSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZzMzX2dldF9j
ZGNsazsKPiA+ICsJZWxzZSBpZiAoSVNfSTk2NUdNKGk5MTUpKQo+ID4gKwkJaTkxNS0+ZGlzcGxh
eS5nZXRfY2RjbGsgPSBpOTY1Z21fZ2V0X2NkY2xrOwo+ID4gKwllbHNlIGlmIChJU19JOTY1Ryhp
OTE1KSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZml4ZWRfNDAwbWh6X2dldF9j
ZGNsazsKPiA+ICsJZWxzZSBpZiAoSVNfUElORVZJRVcoaTkxNSkpCj4gPiArCQlpOTE1LT5kaXNw
bGF5LmdldF9jZGNsayA9IHBudl9nZXRfY2RjbGs7Cj4gPiArCWVsc2UgaWYgKElTX0czMyhpOTE1
KSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZzMzX2dldF9jZGNsazsKPiA+ICsJ
ZWxzZSBpZiAoSVNfSTk0NUdNKGk5MTUpKQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5nZXRfY2RjbGsg
PSBpOTQ1Z21fZ2V0X2NkY2xrOwo+ID4gKwllbHNlIGlmIChJU19JOTQ1RyhpOTE1KSkKPiA+ICsJ
CWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZml4ZWRfNDAwbWh6X2dldF9jZGNsazsKPiA+ICsJ
ZWxzZSBpZiAoSVNfSTkxNUdNKGk5MTUpKQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5nZXRfY2RjbGsg
PSBpOTE1Z21fZ2V0X2NkY2xrOwo+ID4gKwllbHNlIGlmIChJU19JOTE1RyhpOTE1KSkKPiA+ICsJ
CWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZml4ZWRfMzMzbWh6X2dldF9jZGNsazsKPiA+ICsJ
ZWxzZSBpZiAoSVNfSTg2NUcoaTkxNSkpCj4gPiArCQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9
IGZpeGVkXzI2Nm1oel9nZXRfY2RjbGs7Cj4gPiArCWVsc2UgaWYgKElTX0k4NVgoaTkxNSkpCj4g
PiArCQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9IGk4NXhfZ2V0X2NkY2xrOwo+ID4gKwllbHNl
IGlmIChJU19JODQ1RyhpOTE1KSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrID0gZml4
ZWRfMjAwbWh6X2dldF9jZGNsazsKPiA+ICAgCWVsc2UgeyAvKiA4MzAgKi8KPiA+IC0JCVdBUk4o
IUlTX0k4MzAoZGV2X3ByaXYpLAo+ID4gKwkJV0FSTighSVNfSTgzMChpOTE1KSwKPiA+ICAgCQkg
ICAgICJVbmtub3duIHBsYXRmb3JtLiBBc3N1bWluZyAxMzMgTUh6IENEQ0xLXG4iKTsKPiA+IC0J
CWRldl9wcml2LT5kaXNwbGF5LmdldF9jZGNsayA9IGZpeGVkXzEzM21oel9nZXRfY2RjbGs7Cj4g
PiArCQlpOTE1LT5kaXNwbGF5LmdldF9jZGNsayA9IGZpeGVkXzEzM21oel9nZXRfY2RjbGs7Cj4g
PiAgIAl9Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9jZGNsay5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY2RjbGsuaAo+ID4gaW5kZXgg
NGQ2ZjdmNWY4OTMwLi40ZTE3MTAyYWY2NmMgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9jZGNsay5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9jZGNsay5oCj4gPiBAQCAtMTgsMTEgKzE4LDExIEBAIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
Owo+ID4gICBpbnQgaW50ZWxfY3J0Y19jb21wdXRlX21pbl9jZGNsayhjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gPiAgIHZvaWQgaW50ZWxfY2RjbGtfaW5pdChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIHZvaWQgaW50ZWxfY2RjbGtfdW5p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+IC12b2lkIGludGVsX2luaXRf
Y2RjbGtfaG9va3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lk
IGludGVsX3VwZGF0ZV9tYXhfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiA+IC12b2lkIGludGVsX3VwZGF0ZV9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpOwo+ID4gLXZvaWQgaW50ZWxfdXBkYXRlX3Jhd2NsayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLWJvb2wgaW50ZWxfY2RjbGtfbmVlZHNfY2QyeF91cGRh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgaW50ZWxfaW5p
dF9jZGNsa19ob29rcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBp
bnRlbF91cGRhdGVfbWF4X2NkY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+
ICt2b2lkIGludGVsX3VwZGF0ZV9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gPiArdm9pZCBpbnRlbF91cGRhdGVfcmF3Y2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KTsKPiA+ICtib29sIGludGVsX2NkY2xrX25lZWRzX2NkMnhfdXBkYXRlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NkY2xr
X3N0YXRlICphLAo+ID4gICAJCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NkY2xrX3N0YXRlICpi
KTsKPiA+ICAgYm9vbCBpbnRlbF9jZGNsa19uZWVkc19tb2Rlc2V0KGNvbnN0IHN0cnVjdCBpbnRl
bF9jZGNsa19zdGF0ZSAqYSwKPiA+IEBAIC0zMSwxMiArMzEsMTIgQEAgYm9vbCBpbnRlbF9jZGNs
a19jaGFuZ2VkKGNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqYSwKPiA+ICAgCQkJIGNv
bnN0IHN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSAqYik7Cj4gPiAgIHZvaWQgaW50ZWxfY2RjbGtf
c3dhcF9zdGF0ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSk7Cj4gPiAgIHZvaWQK
PiA+IC1pbnRlbF9zZXRfY2RjbGtfcHJlX3BsYW5lX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiAraW50ZWxfc2V0X2NkY2xrX3ByZV9wbGFuZV91cGRhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgY29uc3Qgc3RydWN0IGludGVs
X2NkY2xrX3N0YXRlICpvbGRfc3RhdGUsCj4gPiAgIAkJCQkgY29uc3Qgc3RydWN0IGludGVsX2Nk
Y2xrX3N0YXRlICpuZXdfc3RhdGUsCj4gPiAgIAkJCQkgZW51bSBwaXBlIHBpcGUpOwo+ID4gICB2
b2lkCj4gPiAtaW50ZWxfc2V0X2NkY2xrX3Bvc3RfcGxhbmVfdXBkYXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpbnRlbF9zZXRfY2RjbGtfcG9zdF9wbGFuZV91cGRh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgIGNvbnN0IHN0cnVj
dCBpbnRlbF9jZGNsa19zdGF0ZSAqb2xkX3N0YXRlLAo+ID4gICAJCQkJICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY2RjbGtfc3RhdGUgKm5ld19zdGF0ZSwKPiA+ICAgCQkJCSAgZW51bSBwaXBlIHBpcGUp
Owo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2NvbG9yLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jb2xvci5jCj4gPiBpbmRleCAwYjhjZjNlOGM5NjMu
LmVmYzY3ZTRhMGJhNSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2NvbG9yLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2NvbG9yLmMKPiA+
IEBAIC0xMzcsNyArMTM3LDcgQEAgc3RhdGljIHZvaWQgaWxrX3VwZGF0ZV9waXBlX2NzYyhzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJCWNvbnN0IHUxNiBjb2VmZls5XSwKPiA+ICAg
CQkJCWNvbnN0IHUxNiBwb3N0b2ZmWzNdKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJ
ZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJSTkxNV9XUklURShQSVBFX0NTQ19Q
UkVPRkZfSEkocGlwZSksIHByZW9mZlswXSk7Cj4gPiBAQCAtMTUzLDcgKzE1Myw3IEBAIHN0YXRp
YyB2b2lkIGlsa191cGRhdGVfcGlwZV9jc2Moc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAg
IAlJOTE1X1dSSVRFKFBJUEVfQ1NDX0NPRUZGX1JWX0dWKHBpcGUpLCBjb2VmZls2XSA8PCAxNiB8
IGNvZWZmWzddKTsKPiA+ICAgCUk5MTVfV1JJVEUoUElQRV9DU0NfQ09FRkZfQlYocGlwZSksIGNv
ZWZmWzhdIDw8IDE2KTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykgewo+ID4g
KwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDcpIHsKPiA+ICAgCQlJOTE1X1dSSVRFKFBJUEVfQ1ND
X1BPU1RPRkZfSEkocGlwZSksIHBvc3RvZmZbMF0pOwo+ID4gICAJCUk5MTVfV1JJVEUoUElQRV9D
U0NfUE9TVE9GRl9NRShwaXBlKSwgcG9zdG9mZlsxXSk7Cj4gPiAgIAkJSTkxNV9XUklURShQSVBF
X0NTQ19QT1NUT0ZGX0xPKHBpcGUpLCBwb3N0b2ZmWzJdKTsKPiA+IEBAIC0xNjUsNyArMTY1LDcg
QEAgc3RhdGljIHZvaWQgaWNsX3VwZGF0ZV9vdXRwdXRfY3NjKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+ID4gICAJCQkJICBjb25zdCB1MTYgY29lZmZbOV0sCj4gPiAgIAkJCQkgIGNvbnN0IHUx
NiBwb3N0b2ZmWzNdKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwaXBlIHBp
cGUgPSBjcnRjLT5waXBlOwo+ID4gICAJSTkxNV9XUklURShQSVBFX0NTQ19PVVRQVVRfUFJFT0ZG
X0hJKHBpcGUpLCBwcmVvZmZbMF0pOwo+ID4gQEAgLTE4OCwxNSArMTg4LDE1IEBAIHN0YXRpYyB2
b2lkIGljbF91cGRhdGVfb3V0cHV0X2NzYyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAg
c3RhdGljIGJvb2wgaWxrX2NzY19saW1pdGVkX3JhbmdlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjLT5kZXYpOwo+ID4gICAJLyoKPiA+ICAgCSAqIEZJWE1FIGlmIHRoZXJlJ3MgYSBnYW1tYSBM
VVQgYWZ0ZXIgdGhlIENTQywgd2Ugc2hvdWxkCj4gPiAgIAkgKiBkbyB0aGUgcmFuZ2UgY29tcHJl
c3Npb24gdXNpbmcgdGhlIGdhbW1hIExVVCBpbnN0ZWFkLgo+ID4gICAJICovCj4gPiAgIAlyZXR1
cm4gY3J0Y19zdGF0ZS0+bGltaXRlZF9jb2xvcl9yYW5nZSAmJgo+ID4gLQkJKElTX0hBU1dFTEwo
ZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikgfHwKPiA+IC0JCSBJU19HRU5fUkFO
R0UoZGV2X3ByaXYsIDksIDEwKSk7Cj4gPiArCQkoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9B
RFdFTEwoaTkxNSkgfHwKPiA+ICsJCSBJU19HRU5fUkFOR0UoaTkxNSwgOSwgMTApKTsKPiA+ICAg
fQo+ID4gICBzdGF0aWMgdm9pZCBpbGtfY3NjX2NvbnZlcnRfY3RtKGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gQEAgLTI1NCw3ICsyNTQsNyBAQCBzdGF0aWMg
dm9pZCBpbGtfY3NjX2NvbnZlcnRfY3RtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAo+ID4gICBzdGF0aWMgdm9pZCBpbGtfbG9hZF9jc2NfbWF0cml4KGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gPiAgIAlib29sIGxpbWl0ZWRfY29sb3JfcmFuZ2UgPSBpbGtfY3Nj
X2xpbWl0ZWRfcmFuZ2UoY3J0Y19zdGF0ZSk7Cj4gPiAgIAlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5j
dG0pIHsKPiA+IEBAIC0yODAsNyArMjgwLDcgQEAgc3RhdGljIHZvaWQgaWxrX2xvYWRfY3NjX21h
dHJpeChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgCQkg
KiBMVVQgaXMgbmVlZGVkIGJ1dCBDU0MgaXMgbm90IHdlIG5lZWQgdG8gbG9hZCBhbgo+ID4gICAJ
CSAqIGlkZW50aXR5IG1hdHJpeC4KPiA+ICAgCQkgKi8KPiA+IC0JCVdBUk5fT04oIUlTX0NBTk5P
TkxBS0UoZGV2X3ByaXYpICYmICFJU19HRU1JTklMQUtFKGRldl9wcml2KSk7Cj4gPiArCQlXQVJO
X09OKCFJU19DQU5OT05MQUtFKGk5MTUpICYmICFJU19HRU1JTklMQUtFKGk5MTUpKTsKPiA+ICAg
CQlpbGtfdXBkYXRlX3BpcGVfY3NjKGNydGMsIGlsa19jc2Nfb2ZmX3plcm8sCj4gPiAgIAkJCQkg
ICAgaWxrX2NzY19jb2VmZl9pZGVudGl0eSwKPiA+IEBAIC0yOTMsNyArMjkzLDcgQEAgc3RhdGlj
IHZvaWQgaWxrX2xvYWRfY3NjX21hdHJpeChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPiA+ICAgc3RhdGljIHZvaWQgaWNsX2xvYWRfY3NjX21hdHJpeChjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJaWYgKGNydGNfc3RhdGUtPmJhc2UuY3RtKSB7Cj4gPiAg
IAkJdTE2IGNvZWZmWzldOwo+ID4gQEAgLTMyMiw3ICszMjIsNyBAQCBzdGF0aWMgdm9pZCBpY2xf
bG9hZF9jc2NfbWF0cml4KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+ID4gICBzdGF0aWMgdm9pZCBjaGVycnl2aWV3X2xvYWRfY3NjX21hdHJpeChjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFz
ZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJ
aWYgKGNydGNfc3RhdGUtPmJhc2UuY3RtKSB7Cj4gPiBAQCAtMzg4LDE1ICszODgsMTUgQEAgc3Rh
dGljIHZvaWQgaTl4eF9sb2FkX2x1dHNfaW50ZXJuYWwoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQkgICAgY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0
eV9ibG9iICpibG9iKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAg
IAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAlpbnQgaTsKPiA+IC0JaWYgKEhB
U19HTUNIKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX0dNQ0goaTkxNSkpIHsKPiA+ICAgCQlp
ZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfRFNJKSkKPiA+
IC0JCQlhc3NlcnRfZHNpX3BsbF9lbmFibGVkKGRldl9wcml2KTsKPiA+ICsJCQlhc3NlcnRfZHNp
X3BsbF9lbmFibGVkKGk5MTUpOwo+ID4gICAJCWVsc2UKPiA+IC0JCQlhc3NlcnRfcGxsX2VuYWJs
ZWQoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwkJCWFzc2VydF9wbGxfZW5hYmxlZChpOTE1LCBwaXBl
KTsKPiA+ICAgCX0KPiA+ICAgCWlmIChibG9iKSB7Cj4gPiBAQCAtNDA4LDcgKzQwOCw3IEBAIHN0
YXRpYyB2b2lkIGk5eHhfbG9hZF9sdXRzX2ludGVybmFsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkJKGRybV9jb2xvcl9sdXRfZXh0cmFjdChsdXRb
aV0uZ3JlZW4sIDgpIDw8IDgpIHwKPiA+ICAgCQkJCWRybV9jb2xvcl9sdXRfZXh0cmFjdChsdXRb
aV0uYmx1ZSwgOCk7Cj4gPiAtCQkJaWYgKEhBU19HTUNIKGRldl9wcml2KSkKPiA+ICsJCQlpZiAo
SEFTX0dNQ0goaTkxNSkpCj4gPiAgIAkJCQlJOTE1X1dSSVRFKFBBTEVUVEUocGlwZSwgaSksIHdv
cmQpOwo+ID4gICAJCQllbHNlCj4gPiAgIAkJCQlJOTE1X1dSSVRFKExHQ19QQUxFVFRFKHBpcGUs
IGkpLCB3b3JkKTsKPiA+IEBAIC00MjQsNyArNDI0LDcgQEAgc3RhdGljIHZvaWQgaTl4eF9sb2Fk
X2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHN0
YXRpYyB2b2lkIGk5eHhfY29sb3JfY29tbWl0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAg
IAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gQEAgLTQz
Nyw3ICs0MzcsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X2NvbG9yX2NvbW1pdChjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgc3RhdGljIHZvaWQgaWxrX2NvbG9y
X2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAg
ewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBj
cnRjLT5waXBlOwo+ID4gICAJdTMyIHZhbDsKPiA+IEBAIC00NTIsNyArNDUyLDcgQEAgc3RhdGlj
IHZvaWQgaWxrX2NvbG9yX2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiA+ICAgc3RhdGljIHZvaWQgaHN3X2NvbG9yX2NvbW1pdChjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ID4gICAJSTkxNV9XUklURShHQU1NQV9NT0RFKGNydGMtPnBpcGUpLCBjcnRj
X3N0YXRlLT5nYW1tYV9tb2RlKTsKPiA+IEBAIC00NjIsNyArNDYyLDcgQEAgc3RhdGljIHZvaWQg
aHN3X2NvbG9yX2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiA+ICAgc3RhdGljIHZvaWQgc2tsX2NvbG9yX2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJdTMyIHZhbCA9
IDA7Cj4gPiBAQCAtNDc5LDcgKzQ3OSw3IEBAIHN0YXRpYyB2b2lkIHNrbF9jb2xvcl9jb21taXQo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIAlJOTE1X1dS
SVRFKEdBTU1BX01PREUoY3J0Yy0+cGlwZSksIGNydGNfc3RhdGUtPmdhbW1hX21vZGUpOwo+ID4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSAxMSkKPiA+ICAgCQlpY2xfbG9hZF9jc2NfbWF0cml4KGNydGNfc3RhdGUpOwo+ID4gICAJ
ZWxzZQo+ID4gICAJCWlsa19sb2FkX2NzY19tYXRyaXgoY3J0Y19zdGF0ZSk7Cj4gPiBAQCAtNDg4
LDcgKzQ4OCw3IEBAIHN0YXRpYyB2b2lkIHNrbF9jb2xvcl9jb21taXQoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHN0YXRpYyB2b2lkIGk5NjVfbG9hZF9s
dXRfMTBwNihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJICAgICAgIGNvbnN0IHN0
cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqYmxvYikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+
ICAgCWNvbnN0IHN0cnVjdCBkcm1fY29sb3JfbHV0ICpsdXQgPSBibG9iLT5kYXRhOwo+ID4gICAJ
aW50IGksIGx1dF9zaXplID0gZHJtX2NvbG9yX2x1dF9zaXplKGJsb2IpOwo+ID4gICAJZW51bSBw
aXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gQEAgLTUxOSw3ICs1MTksNyBAQCBzdGF0aWMgdm9p
ZCBpOTY1X2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiA+ICAgc3RhdGljIHZvaWQgaWxrX2xvYWRfbHV0XzEwKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+ID4gICAJCQkgICAgY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpibG9iKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQg
Kmx1dCA9IGJsb2ItPmRhdGE7Cj4gPiAgIAlpbnQgaSwgbHV0X3NpemUgPSBkcm1fY29sb3JfbHV0
X3NpemUoYmxvYik7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiBAQCAt
NTU2LDcgKzU1Niw3IEBAIHN0YXRpYyB2b2lkIGl2Yl9sb2FkX2x1dF8xMChzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiA+ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAq
YmxvYiwKPiA+ICAgCQkJICAgIHUzMiBwcmVjX2luZGV4KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYp
Owo+ID4gICAJaW50IGh3X2x1dF9zaXplID0gaXZiX2x1dF8xMF9zaXplKHByZWNfaW5kZXgpOwo+
ID4gICAJY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmx1dCA9IGJsb2ItPmRhdGE7Cj4gPiAg
IAlpbnQgaSwgbHV0X3NpemUgPSBkcm1fY29sb3JfbHV0X3NpemUoYmxvYik7Cj4gPiBAQCAtNTgz
LDcgKzU4Myw3IEBAIHN0YXRpYyB2b2lkIGJkd19sb2FkX2x1dF8xMChzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKPiA+ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqYmxv
YiwKPiA+ICAgCQkJICAgIHUzMiBwcmVjX2luZGV4KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ID4gICAJaW50IGh3X2x1dF9zaXplID0gaXZiX2x1dF8xMF9zaXplKHByZWNfaW5kZXgpOwo+ID4g
ICAJY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmx1dCA9IGJsb2ItPmRhdGE7Cj4gPiAgIAlp
bnQgaSwgbHV0X3NpemUgPSBkcm1fY29sb3JfbHV0X3NpemUoYmxvYik7Cj4gPiBAQCAtNjA5LDcg
KzYwOSw3IEBAIHN0YXRpYyB2b2lkIGJkd19sb2FkX2x1dF8xMChzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKPiA+ICAgc3RhdGljIHZvaWQgaXZiX2xvYWRfbHV0XzEwX21heChzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBl
ID0gY3J0Yy0+cGlwZTsKPiA+ICAgCS8qIFByb2dyYW0gdGhlIG1heCByZWdpc3RlciB0byBjbGFt
cCB2YWx1ZXMgPiAxLjAuICovCj4gPiBAQCAtNjIyLDcgKzYyMiw3IEBAIHN0YXRpYyB2b2lkIGl2
Yl9sb2FkX2x1dF8xMF9tYXgoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIAkgKiBUb0Rv
OiBFeHRlbmQgdGhlIEFCSSB0byBiZSBhYmxlIHRvIHByb2dyYW0gdmFsdWVzCj4gPiAgIAkgKiBm
cm9tIDMuMCB0byA3LjAKPiA+ICAgCSAqLwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSAxMCB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5
MTUpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoaTkxNSkpIHsKPiA+ICAgCQlJOTE1X1dSSVRFKFBS
RUNfUEFMX0VYVDJfR0NfTUFYKHBpcGUsIDApLCAxIDw8IDE2KTsKPiA+ICAgCQlJOTE1X1dSSVRF
KFBSRUNfUEFMX0VYVDJfR0NfTUFYKHBpcGUsIDEpLCAxIDw8IDE2KTsKPiA+ICAgCQlJOTE1X1dS
SVRFKFBSRUNfUEFMX0VYVDJfR0NfTUFYKHBpcGUsIDIpLCAxIDw8IDE2KTsKPiA+IEBAIC02Nzgs
OSArNjc4LDkgQEAgc3RhdGljIHZvaWQgYmR3X2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgc3RhdGljIHZvaWQgZ2xrX2xvYWRfZGVnYW1t
YV9sdXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0
Yy0+cGlwZTsKPiA+IC0JY29uc3QgdTMyIGx1dF9zaXplID0gSU5URUxfSU5GTyhkZXZfcHJpdikt
PmNvbG9yLmRlZ2FtbWFfbHV0X3NpemU7Cj4gPiArCWNvbnN0IHUzMiBsdXRfc2l6ZSA9IElOVEVM
X0lORk8oaTkxNSktPmNvbG9yLmRlZ2FtbWFfbHV0X3NpemU7Cj4gPiAgIAljb25zdCBzdHJ1Y3Qg
ZHJtX2NvbG9yX2x1dCAqbHV0ID0gY3J0Y19zdGF0ZS0+YmFzZS5kZWdhbW1hX2x1dC0+ZGF0YTsK
PiA+ICAgCXUzMiBpOwo+ID4gQEAgLTcxNyw5ICs3MTcsOSBAQCBzdGF0aWMgdm9pZCBnbGtfbG9h
ZF9kZWdhbW1hX2x1dChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiA+ICAgc3RhdGljIHZvaWQgZ2xrX2xvYWRfZGVnYW1tYV9sdXRfbGluZWFyKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAtCWNv
bnN0IHUzMiBsdXRfc2l6ZSA9IElOVEVMX0lORk8oZGV2X3ByaXYpLT5jb2xvci5kZWdhbW1hX2x1
dF9zaXplOwo+ID4gKwljb25zdCB1MzIgbHV0X3NpemUgPSBJTlRFTF9JTkZPKGk5MTUpLT5jb2xv
ci5kZWdhbW1hX2x1dF9zaXplOwo+ID4gICAJdTMyIGk7Cj4gPiAgIAkvKgo+ID4gQEAgLTc5OCw3
ICs3OTgsNyBAQCBzdGF0aWMgdTMyIGNodl9jZ21fZGVnYW1tYV91ZHcoY29uc3Qgc3RydWN0IGRy
bV9jb2xvcl9sdXQgKmNvbG9yKQo+ID4gICBzdGF0aWMgdm9pZCBjaHZfbG9hZF9jZ21fZGVnYW1t
YShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX3By
b3BlcnR5X2Jsb2IgKmJsb2IpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAljb25zdCBz
dHJ1Y3QgZHJtX2NvbG9yX2x1dCAqbHV0ID0gYmxvYi0+ZGF0YTsKPiA+ICAgCWludCBpLCBsdXRf
c2l6ZSA9IGRybV9jb2xvcl9sdXRfc2l6ZShibG9iKTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0g
Y3J0Yy0+cGlwZTsKPiA+IEBAIC04MjUsNyArODI1LDcgQEAgc3RhdGljIHUzMiBjaHZfY2dtX2dh
bW1hX3Vkdyhjb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqY29sb3IpCj4gPiAgIHN0YXRpYyB2
b2lkIGNodl9sb2FkX2NnbV9nYW1tYShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJ
ICAgICAgIGNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqYmxvYikKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBkcm1fY29sb3JfbHV0ICpsdXQgPSBibG9i
LT5kYXRhOwo+ID4gICAJaW50IGksIGx1dF9zaXplID0gZHJtX2NvbG9yX2x1dF9zaXplKGJsb2Ip
Owo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gQEAgLTg2MCwzNyArODYw
LDM3IEBAIHN0YXRpYyB2b2lkIGNodl9sb2FkX2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHZvaWQgaW50ZWxfY29sb3JfbG9hZF9sdXRzKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gLQlkZXZfcHJpdi0+ZGlzcGxheS5sb2Fk
X2x1dHMoY3J0Y19zdGF0ZSk7Cj4gPiArCWk5MTUtPmRpc3BsYXkubG9hZF9sdXRzKGNydGNfc3Rh
dGUpOwo+ID4gICB9Cj4gPiAgIHZvaWQgaW50ZWxfY29sb3JfY29tbWl0KGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gLQlkZXZfcHJpdi0+ZGlzcGxheS5jb2xvcl9jb21taXQo
Y3J0Y19zdGF0ZSk7Cj4gPiArCWk5MTUtPmRpc3BsYXkuY29sb3JfY29tbWl0KGNydGNfc3RhdGUp
Owo+ID4gICB9Cj4gPiAgIGludCBpbnRlbF9jb2xvcl9jaGVjayhzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0
Yy0+ZGV2KTsKPiA+IC0JcmV0dXJuIGRldl9wcml2LT5kaXNwbGF5LmNvbG9yX2NoZWNrKGNydGNf
c3RhdGUpOwo+ID4gKwlyZXR1cm4gaTkxNS0+ZGlzcGxheS5jb2xvcl9jaGVjayhjcnRjX3N0YXRl
KTsKPiA+ICAgfQo+ID4gICB2b2lkIGludGVsX2NvbG9yX2dldF9jb25maWcoc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjX3N0YXRlLT5i
YXNlLmNydGMtPmRldik7Cj4gPiAtCWlmIChkZXZfcHJpdi0+ZGlzcGxheS5yZWFkX2x1dHMpCj4g
PiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5yZWFkX2x1dHMoY3J0Y19zdGF0ZSk7Cj4gPiArCWlmIChp
OTE1LT5kaXNwbGF5LnJlYWRfbHV0cykKPiA+ICsJCWk5MTUtPmRpc3BsYXkucmVhZF9sdXRzKGNy
dGNfc3RhdGUpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBib29sIG5lZWRfcGxhbmVfdXBkYXRlKHN0
cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gPiAg
IAkvKgo+ID4gICAJICogT24gcHJlLVNLTCB0aGUgcGlwZSBnYW1tYSBlbmFibGUgYW5kIHBpcGUg
Y3NjIGVuYWJsZSBmb3IKPiA+IEBAIC04OTgsNyArODk4LDcgQEAgc3RhdGljIGJvb2wgbmVlZF9w
bGFuZV91cGRhdGUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCSAqIFdlIGhhdmUg
dG8gcmVjb25maWd1cmUgdGhhdCBldmVuIGlmIHRoZSBwbGFuZSBpcyBpbmFjdGl2ZS4KPiA+ICAg
CSAqLwo+ID4gICAJcmV0dXJuIGNydGNfc3RhdGUtPmFjdGl2ZV9wbGFuZXMgJiBCSVQocGxhbmUt
PmlkKSB8fAo+ID4gLQkJKElOVEVMX0dFTihkZXZfcHJpdikgPCA5ICYmCj4gPiArCQkoSU5URUxf
R0VOKGk5MTUpIDwgOSAmJgo+ID4gICAJCSBwbGFuZS0+aWQgPT0gUExBTkVfUFJJTUFSWSk7Cj4g
PiAgIH0KPiA+IEBAIC05MDYsNyArOTA2LDcgQEAgc3RhdGljIGludAo+ID4gICBpbnRlbF9jb2xv
cl9hZGRfYWZmZWN0ZWRfcGxhbmVzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19z
dGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKG5ld19jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlID0KPiA+ICAgCQl0b19pbnRlbF9hdG9taWNf
c3RhdGUobmV3X2NydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+ID4gICAJY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlID0KPiA+IEBAIC05MjEsNyArOTIxLDcgQEAg
aW50ZWxfY29sb3JfYWRkX2FmZmVjdGVkX3BsYW5lcyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
bmV3X2NydGNfc3RhdGUpCj4gPiAgIAkgICAgbmV3X2NydGNfc3RhdGUtPmNzY19lbmFibGUgPT0g
b2xkX2NydGNfc3RhdGUtPmNzY19lbmFibGUpCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAtCWZvcl9l
YWNoX2ludGVsX3BsYW5lX29uX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMsIHBsYW5lKSB7Cj4g
PiArCWZvcl9lYWNoX2ludGVsX3BsYW5lX29uX2NydGMoJmk5MTUtPmRybSwgY3J0YywgcGxhbmUp
IHsKPiA+ICAgCQlzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlOwo+ID4gICAJ
CWlmICghbmVlZF9wbGFuZV91cGRhdGUocGxhbmUsIG5ld19jcnRjX3N0YXRlKSkKPiA+IEBAIC05
NTYsNyArOTU2LDcgQEAgc3RhdGljIGludCBjaGVja19sdXRfc2l6ZShjb25zdCBzdHJ1Y3QgZHJt
X3Byb3BlcnR5X2Jsb2IgKmx1dCwgaW50IGV4cGVjdGVkKQo+ID4gICBzdGF0aWMgaW50IGNoZWNr
X2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0
YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gPiAgIAljb25zdCBzdHJ1
Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmJhc2UuZ2FtbWFf
bHV0Owo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpkZWdhbW1hX2x1dCA9
IGNydGNfc3RhdGUtPmJhc2UuZGVnYW1tYV9sdXQ7Cj4gPiAgIAlpbnQgZ2FtbWFfbGVuZ3RoLCBk
ZWdhbW1hX2xlbmd0aDsKPiA+IEBAIC05NzIsMTAgKzk3MiwxMCBAQCBzdGF0aWMgaW50IGNoZWNr
X2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIAkJ
cmV0dXJuIC1FSU5WQUw7Cj4gPiAgIAl9Cj4gPiAtCWRlZ2FtbWFfbGVuZ3RoID0gSU5URUxfSU5G
TyhkZXZfcHJpdiktPmNvbG9yLmRlZ2FtbWFfbHV0X3NpemU7Cj4gPiAtCWdhbW1hX2xlbmd0aCA9
IElOVEVMX0lORk8oZGV2X3ByaXYpLT5jb2xvci5nYW1tYV9sdXRfc2l6ZTsKPiA+IC0JZGVnYW1t
YV90ZXN0cyA9IElOVEVMX0lORk8oZGV2X3ByaXYpLT5jb2xvci5kZWdhbW1hX2x1dF90ZXN0czsK
PiA+IC0JZ2FtbWFfdGVzdHMgPSBJTlRFTF9JTkZPKGRldl9wcml2KS0+Y29sb3IuZ2FtbWFfbHV0
X3Rlc3RzOwo+ID4gKwlkZWdhbW1hX2xlbmd0aCA9IElOVEVMX0lORk8oaTkxNSktPmNvbG9yLmRl
Z2FtbWFfbHV0X3NpemU7Cj4gPiArCWdhbW1hX2xlbmd0aCA9IElOVEVMX0lORk8oaTkxNSktPmNv
bG9yLmdhbW1hX2x1dF9zaXplOwo+ID4gKwlkZWdhbW1hX3Rlc3RzID0gSU5URUxfSU5GTyhpOTE1
KS0+Y29sb3IuZGVnYW1tYV9sdXRfdGVzdHM7Cj4gPiArCWdhbW1hX3Rlc3RzID0gSU5URUxfSU5G
TyhpOTE1KS0+Y29sb3IuZ2FtbWFfbHV0X3Rlc3RzOwo+ID4gICAJaWYgKGNoZWNrX2x1dF9zaXpl
KGRlZ2FtbWFfbHV0LCBkZWdhbW1hX2xlbmd0aCkgfHwKPiA+ICAgCSAgICBjaGVja19sdXRfc2l6
ZShnYW1tYV9sdXQsIGdhbW1hX2xlbmd0aCkpCj4gPiBAQCAtMTI1NSw1NiArMTI1NSw1NiBAQCBz
dGF0aWMgaW50IGljbF9jb2xvcl9jaGVjayhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPiA+ICAgdm9pZCBpbnRlbF9jb2xvcl9pbml0KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gLQlib29sIGhhc19jdG0gPSBJTlRFTF9JTkZPKGRldl9w
cml2KS0+Y29sb3IuZGVnYW1tYV9sdXRfc2l6ZSAhPSAwOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlib29sIGhhc19j
dG0gPSBJTlRFTF9JTkZPKGk5MTUpLT5jb2xvci5kZWdhbW1hX2x1dF9zaXplICE9IDA7Cj4gPiAg
IAlkcm1fbW9kZV9jcnRjX3NldF9nYW1tYV9zaXplKCZjcnRjLT5iYXNlLCAyNTYpOwo+ID4gLQlp
ZiAoSEFTX0dNQ0goZGV2X3ByaXYpKSB7Cj4gPiAtCQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJp
dikpIHsKPiA+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5jb2xvcl9jaGVjayA9IGNodl9jb2xvcl9j
aGVjazsKPiA+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5jb2xvcl9jb21taXQgPSBpOXh4X2NvbG9y
X2NvbW1pdDsKPiA+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5sb2FkX2x1dHMgPSBjaHZfbG9hZF9s
dXRzOwo+ID4gLQkJfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpIHsKPiA+IC0J
CQlkZXZfcHJpdi0+ZGlzcGxheS5jb2xvcl9jaGVjayA9IGk5eHhfY29sb3JfY2hlY2s7Cj4gPiAt
CQkJZGV2X3ByaXYtPmRpc3BsYXkuY29sb3JfY29tbWl0ID0gaTl4eF9jb2xvcl9jb21taXQ7Cj4g
PiAtCQkJZGV2X3ByaXYtPmRpc3BsYXkubG9hZF9sdXRzID0gaTk2NV9sb2FkX2x1dHM7Cj4gPiAr
CWlmIChIQVNfR01DSChpOTE1KSkgewo+ID4gKwkJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpIHsK
PiA+ICsJCQlpOTE1LT5kaXNwbGF5LmNvbG9yX2NoZWNrID0gY2h2X2NvbG9yX2NoZWNrOwo+ID4g
KwkJCWk5MTUtPmRpc3BsYXkuY29sb3JfY29tbWl0ID0gaTl4eF9jb2xvcl9jb21taXQ7Cj4gPiAr
CQkJaTkxNS0+ZGlzcGxheS5sb2FkX2x1dHMgPSBjaHZfbG9hZF9sdXRzOwo+ID4gKwkJfSBlbHNl
IGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkgewo+ID4gKwkJCWk5MTUtPmRpc3BsYXkuY29sb3Jf
Y2hlY2sgPSBpOXh4X2NvbG9yX2NoZWNrOwo+ID4gKwkJCWk5MTUtPmRpc3BsYXkuY29sb3JfY29t
bWl0ID0gaTl4eF9jb2xvcl9jb21taXQ7Cj4gPiArCQkJaTkxNS0+ZGlzcGxheS5sb2FkX2x1dHMg
PSBpOTY1X2xvYWRfbHV0czsKPiA+ICAgCQl9IGVsc2Ugewo+ID4gLQkJCWRldl9wcml2LT5kaXNw
bGF5LmNvbG9yX2NoZWNrID0gaTl4eF9jb2xvcl9jaGVjazsKPiA+IC0JCQlkZXZfcHJpdi0+ZGlz
cGxheS5jb2xvcl9jb21taXQgPSBpOXh4X2NvbG9yX2NvbW1pdDsKPiA+IC0JCQlkZXZfcHJpdi0+
ZGlzcGxheS5sb2FkX2x1dHMgPSBpOXh4X2xvYWRfbHV0czsKPiA+ICsJCQlpOTE1LT5kaXNwbGF5
LmNvbG9yX2NoZWNrID0gaTl4eF9jb2xvcl9jaGVjazsKPiA+ICsJCQlpOTE1LT5kaXNwbGF5LmNv
bG9yX2NvbW1pdCA9IGk5eHhfY29sb3JfY29tbWl0Owo+ID4gKwkJCWk5MTUtPmRpc3BsYXkubG9h
ZF9sdXRzID0gaTl4eF9sb2FkX2x1dHM7Cj4gPiAgIAkJfQo+ID4gICAJfSBlbHNlIHsKPiA+IC0J
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ID4gLQkJCWRldl9wcml2LT5kaXNwbGF5
LmNvbG9yX2NoZWNrID0gaWNsX2NvbG9yX2NoZWNrOwo+ID4gLQkJZWxzZSBpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSkKPiA+IC0JCQlkZXZf
cHJpdi0+ZGlzcGxheS5jb2xvcl9jaGVjayA9IGdsa19jb2xvcl9jaGVjazsKPiA+IC0JCWVsc2Ug
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykKPiA+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5j
b2xvcl9jaGVjayA9IGl2Yl9jb2xvcl9jaGVjazsKPiA+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gMTEpCj4gPiArCQkJaTkxNS0+ZGlzcGxheS5jb2xvcl9jaGVjayA9IGljbF9jb2xvcl9jaGVj
azsKPiA+ICsJCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCB8fCBJU19HRU1JTklMQUtF
KGk5MTUpKQo+ID4gKwkJCWk5MTUtPmRpc3BsYXkuY29sb3JfY2hlY2sgPSBnbGtfY29sb3JfY2hl
Y2s7Cj4gPiArCQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNykKPiA+ICsJCQlpOTE1LT5k
aXNwbGF5LmNvbG9yX2NoZWNrID0gaXZiX2NvbG9yX2NoZWNrOwo+ID4gICAJCWVsc2UKPiA+IC0J
CQlkZXZfcHJpdi0+ZGlzcGxheS5jb2xvcl9jaGVjayA9IGlsa19jb2xvcl9jaGVjazsKPiA+ICsJ
CQlpOTE1LT5kaXNwbGF5LmNvbG9yX2NoZWNrID0gaWxrX2NvbG9yX2NoZWNrOwo+ID4gLQkJaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiA+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5jb2xv
cl9jb21taXQgPSBza2xfY29sb3JfY29tbWl0Owo+ID4gLQkJZWxzZSBpZiAoSVNfQlJPQURXRUxM
KGRldl9wcml2KSB8fCBJU19IQVNXRUxMKGRldl9wcml2KSkKPiA+IC0JCQlkZXZfcHJpdi0+ZGlz
cGxheS5jb2xvcl9jb21taXQgPSBoc3dfY29sb3JfY29tbWl0Owo+ID4gKwkJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA5KQo+ID4gKwkJCWk5MTUtPmRpc3BsYXkuY29sb3JfY29tbWl0ID0gc2tsX2Nv
bG9yX2NvbW1pdDsKPiA+ICsJCWVsc2UgaWYgKElTX0JST0FEV0VMTChpOTE1KSB8fCBJU19IQVNX
RUxMKGk5MTUpKQo+ID4gKwkJCWk5MTUtPmRpc3BsYXkuY29sb3JfY29tbWl0ID0gaHN3X2NvbG9y
X2NvbW1pdDsKPiA+ICAgCQllbHNlCj4gPiAtCQkJZGV2X3ByaXYtPmRpc3BsYXkuY29sb3JfY29t
bWl0ID0gaWxrX2NvbG9yX2NvbW1pdDsKPiA+IC0KPiA+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDExKQo+ID4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmxvYWRfbHV0cyA9IGljbF9sb2Fk
X2x1dHM7Cj4gPiAtCQllbHNlIGlmIChJU19DQU5OT05MQUtFKGRldl9wcml2KSB8fCBJU19HRU1J
TklMQUtFKGRldl9wcml2KSkKPiA+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5sb2FkX2x1dHMgPSBn
bGtfbG9hZF9sdXRzOwo+ID4gLQkJZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KQo+
ID4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmxvYWRfbHV0cyA9IGJkd19sb2FkX2x1dHM7Cj4gPiAt
CQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDcpCj4gPiAtCQkJZGV2X3ByaXYtPmRp
c3BsYXkubG9hZF9sdXRzID0gaXZiX2xvYWRfbHV0czsKPiA+ICsJCQlpOTE1LT5kaXNwbGF5LmNv
bG9yX2NvbW1pdCA9IGlsa19jb2xvcl9jb21taXQ7Cj4gPiArCj4gPiArCQlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDExKQo+ID4gKwkJCWk5MTUtPmRpc3BsYXkubG9hZF9sdXRzID0gaWNsX2xvYWRf
bHV0czsKPiA+ICsJCWVsc2UgaWYgKElTX0NBTk5PTkxBS0UoaTkxNSkgfHwgSVNfR0VNSU5JTEFL
RShpOTE1KSkKPiA+ICsJCQlpOTE1LT5kaXNwbGF5LmxvYWRfbHV0cyA9IGdsa19sb2FkX2x1dHM7
Cj4gPiArCQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkKPiA+ICsJCQlpOTE1LT5kaXNw
bGF5LmxvYWRfbHV0cyA9IGJkd19sb2FkX2x1dHM7Cj4gPiArCQllbHNlIGlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gNykKPiA+ICsJCQlpOTE1LT5kaXNwbGF5LmxvYWRfbHV0cyA9IGl2Yl9sb2FkX2x1
dHM7Cj4gPiAgIAkJZWxzZQo+ID4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmxvYWRfbHV0cyA9IGls
a19sb2FkX2x1dHM7Cj4gPiArCQkJaTkxNS0+ZGlzcGxheS5sb2FkX2x1dHMgPSBpbGtfbG9hZF9s
dXRzOwo+ID4gICAJfQo+ID4gICAJZHJtX2NydGNfZW5hYmxlX2NvbG9yX21nbXQoJmNydGMtPmJh
c2UsCj4gPiAtCQkJCSAgIElOVEVMX0lORk8oZGV2X3ByaXYpLT5jb2xvci5kZWdhbW1hX2x1dF9z
aXplLAo+ID4gKwkJCQkgICBJTlRFTF9JTkZPKGk5MTUpLT5jb2xvci5kZWdhbW1hX2x1dF9zaXpl
LAo+ID4gICAJCQkJICAgaGFzX2N0bSwKPiA+IC0JCQkJICAgSU5URUxfSU5GTyhkZXZfcHJpdikt
PmNvbG9yLmdhbW1hX2x1dF9zaXplKTsKPiA+ICsJCQkJICAgSU5URUxfSU5GTyhpOTE1KS0+Y29s
b3IuZ2FtbWFfbHV0X3NpemUpOwo+ID4gICB9Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfY29tYm9fcGh5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9j
b21ib19waHkuYwo+ID4gaW5kZXggODQxNzA4ZGE1YTU2Li4wZTdjMThkNzgzY2EgMTAwNjQ0Cj4g
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jb21ib19waHkuYwo+ID4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY29tYm9fcGh5LmMKPiA+IEBAIC00NCw3ICs0NCw3
IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY25sX3Byb2Ntb24gewo+ID4gICAgKiBvbiBpdHMgbmFt
ZS4KPiA+ICAgICovCj4gPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY25sX3Byb2Ntb24gKgo+ID4g
LWNubF9nZXRfcHJvY21vbl9yZWZfdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgZW51bSBwb3J0IHBvcnQpCj4gPiArY25sX2dldF9wcm9jbW9uX3JlZl92YWx1ZXMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcG9ydCBwb3J0KQo+ID4gICB7Cj4gPiAg
IAljb25zdCBzdHJ1Y3QgY25sX3Byb2Ntb24gKnByb2Ntb247Cj4gPiAgIAl1MzIgdmFsOwo+ID4g
QEAgLTc0LDEzICs3NCwxMyBAQCBjbmxfZ2V0X3Byb2Ntb25fcmVmX3ZhbHVlcyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KQo+ID4gICAJcmV0dXJuIHBy
b2Ntb247Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBjbmxfc2V0X3Byb2Ntb25fcmVmX3ZhbHVl
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgY25s
X3NldF9wcm9jbW9uX3JlZl92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgIAkJCQkgICAgICAgZW51bSBwb3J0IHBvcnQpCj4gPiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVj
dCBjbmxfcHJvY21vbiAqcHJvY21vbjsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAtCXByb2Ntb24gPSBj
bmxfZ2V0X3Byb2Ntb25fcmVmX3ZhbHVlcyhkZXZfcHJpdiwgcG9ydCk7Cj4gPiArCXByb2Ntb24g
PSBjbmxfZ2V0X3Byb2Ntb25fcmVmX3ZhbHVlcyhpOTE1LCBwb3J0KTsKPiA+ICAgCXZhbCA9IEk5
MTVfUkVBRChJQ0xfUE9SVF9DT01QX0RXMShwb3J0KSk7Cj4gPiAgIAl2YWwgJj0gfigoMHhmZiA8
PCAxNikgfCAweGZmKTsKPiA+IEBAIC05MSw3ICs5MSw3IEBAIHN0YXRpYyB2b2lkIGNubF9zZXRf
cHJvY21vbl9yZWZfdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICAgCUk5MTVfV1JJVEUoSUNMX1BPUlRfQ09NUF9EVzEwKHBvcnQpLCBwcm9jbW9uLT5kdzEwKTsK
PiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIGNoZWNrX3BoeV9yZWcoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIGNoZWNrX3BoeV9yZWcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgZW51bSBwb3J0IHBvcnQsIGk5MTVfcmVn
X3QgcmVnLCB1MzIgbWFzaywKPiA+ICAgCQkJICB1MzIgZXhwZWN0ZWRfdmFsKQo+ID4gICB7Cj4g
PiBAQCAtMTA4LDQ3ICsxMDgsNDcgQEAgc3RhdGljIGJvb2wgY2hlY2tfcGh5X3JlZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXR1cm4gdHJ1ZTsKPiA+ICAgfQo+
ID4gLXN0YXRpYyBib29sIGNubF92ZXJpZnlfcHJvY21vbl9yZWZfdmFsdWVzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgYm9vbCBjbmxfdmVyaWZ5X3Byb2Nt
b25fcmVmX3ZhbHVlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkg
IGVudW0gcG9ydCBwb3J0KQo+ID4gICB7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgY25sX3Byb2Ntb24g
KnByb2Ntb247Cj4gPiAgIAlib29sIHJldDsKPiA+IC0JcHJvY21vbiA9IGNubF9nZXRfcHJvY21v
bl9yZWZfdmFsdWVzKGRldl9wcml2LCBwb3J0KTsKPiA+ICsJcHJvY21vbiA9IGNubF9nZXRfcHJv
Y21vbl9yZWZfdmFsdWVzKGk5MTUsIHBvcnQpOwo+ID4gLQlyZXQgPSBjaGVja19waHlfcmVnKGRl
dl9wcml2LCBwb3J0LCBJQ0xfUE9SVF9DT01QX0RXMShwb3J0KSwKPiA+ICsJcmV0ID0gY2hlY2tf
cGh5X3JlZyhpOTE1LCBwb3J0LCBJQ0xfUE9SVF9DT01QX0RXMShwb3J0KSwKPiA+ICAgCQkJICAg
ICgweGZmIDw8IDE2KSB8IDB4ZmYsIHByb2Ntb24tPmR3MSk7Cj4gPiAtCXJldCAmPSBjaGVja19w
aHlfcmVnKGRldl9wcml2LCBwb3J0LCBJQ0xfUE9SVF9DT01QX0RXOShwb3J0KSwKPiA+ICsJcmV0
ICY9IGNoZWNrX3BoeV9yZWcoaTkxNSwgcG9ydCwgSUNMX1BPUlRfQ09NUF9EVzkocG9ydCksCj4g
PiAgIAkJCSAgICAgLTFVLCBwcm9jbW9uLT5kdzkpOwo+ID4gLQlyZXQgJj0gY2hlY2tfcGh5X3Jl
ZyhkZXZfcHJpdiwgcG9ydCwgSUNMX1BPUlRfQ09NUF9EVzEwKHBvcnQpLAo+ID4gKwlyZXQgJj0g
Y2hlY2tfcGh5X3JlZyhpOTE1LCBwb3J0LCBJQ0xfUE9SVF9DT01QX0RXMTAocG9ydCksCj4gPiAg
IAkJCSAgICAgLTFVLCBwcm9jbW9uLT5kdzEwKTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgYm9vbCBjbmxfY29tYm9fcGh5X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBib29sIGNubF9jb21ib19waHlfZW5hYmxlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJcmV0dXJuICEoSTkx
NV9SRUFEKENISUNLRU5fTUlTQ18yKSAmIENOTF9DT01QX1BXUl9ET1dOKSAmJgo+ID4gICAJCShJ
OTE1X1JFQUQoQ05MX1BPUlRfQ09NUF9EVzApICYgQ09NUF9JTklUKTsKPiA+ICAgfQo+ID4gLXN0
YXRpYyBib29sIGNubF9jb21ib19waHlfdmVyaWZ5X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgYm9vbCBjbmxfY29tYm9fcGh5X3ZlcmlmeV9zdGF0
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJZW51bSBwb3J0
IHBvcnQgPSBQT1JUX0E7Cj4gPiAgIAlib29sIHJldDsKPiA+IC0JaWYgKCFjbmxfY29tYm9fcGh5
X2VuYWJsZWQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIWNubF9jb21ib19waHlfZW5hYmxlZChpOTE1
KSkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAtCXJldCA9IGNubF92ZXJpZnlfcHJvY21vbl9y
ZWZfdmFsdWVzKGRldl9wcml2LCBwb3J0KTsKPiA+ICsJcmV0ID0gY25sX3ZlcmlmeV9wcm9jbW9u
X3JlZl92YWx1ZXMoaTkxNSwgcG9ydCk7Cj4gPiAtCXJldCAmPSBjaGVja19waHlfcmVnKGRldl9w
cml2LCBwb3J0LCBDTkxfUE9SVF9DTDFDTV9EVzUsCj4gPiArCXJldCAmPSBjaGVja19waHlfcmVn
KGk5MTUsIHBvcnQsIENOTF9QT1JUX0NMMUNNX0RXNSwKPiA+ICAgCQkJICAgICBDTF9QT1dFUl9E
T1dOX0VOQUJMRSwgQ0xfUE9XRVJfRE9XTl9FTkFCTEUpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+
ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGNubF9jb21ib19waHlzX2luaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGNubF9jb21ib19waHlzX2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7Cj4g
PiBAQCAtMTU3LDcgKzE1Nyw3IEBAIHN0YXRpYyB2b2lkIGNubF9jb21ib19waHlzX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJSTkxNV9XUklURShDSElDS0VO
X01JU0NfMiwgdmFsKTsKPiA+ICAgCS8qIER1bW15IFBPUlRfQSB0byBnZXQgdGhlIGNvcnJlY3Qg
Q05MIHJlZ2lzdGVyIGZyb20gdGhlIElDTCBtYWNybyAqLwo+ID4gLQljbmxfc2V0X3Byb2Ntb25f
cmVmX3ZhbHVlcyhkZXZfcHJpdiwgUE9SVF9BKTsKPiA+ICsJY25sX3NldF9wcm9jbW9uX3JlZl92
YWx1ZXMoaTkxNSwgUE9SVF9BKTsKPiA+ICAgCXZhbCA9IEk5MTVfUkVBRChDTkxfUE9SVF9DT01Q
X0RXMCk7Cj4gPiAgIAl2YWwgfD0gQ09NUF9JTklUOwo+ID4gQEAgLTE2OCwxMSArMTY4LDExIEBA
IHN0YXRpYyB2b2lkIGNubF9jb21ib19waHlzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gICAJSTkxNV9XUklURShDTkxfUE9SVF9DTDFDTV9EVzUsIHZhbCk7Cj4g
PiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBjbmxfY29tYm9fcGh5c191bmluaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGNubF9jb21ib19waHlzX3Vu
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIHZh
bDsKPiA+IC0JaWYgKCFjbmxfY29tYm9fcGh5X3ZlcmlmeV9zdGF0ZShkZXZfcHJpdikpCj4gPiAr
CWlmICghY25sX2NvbWJvX3BoeV92ZXJpZnlfc3RhdGUoaTkxNSkpCj4gPiAgIAkJRFJNX1dBUk4o
IkNvbWJvIFBIWSBIVyBzdGF0ZSBjaGFuZ2VkIHVuZXhwZWN0ZWRseS5cbiIpOwo+ID4gICAJdmFs
ID0gSTkxNV9SRUFEKENISUNLRU5fTUlTQ18yKTsKPiA+IEBAIC0xODAsNyArMTgwLDcgQEAgc3Rh
dGljIHZvaWQgY25sX2NvbWJvX3BoeXNfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICAgCUk5MTVfV1JJVEUoQ0hJQ0tFTl9NSVNDXzIsIHZhbCk7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgYm9vbCBpY2xfY29tYm9fcGh5X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIGljbF9jb21ib19waHlfZW5hYmxlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgZW51bSBwb3J0IHBvcnQp
Cj4gPiAgIHsKPiA+ICAgCXJldHVybiAhKEk5MTVfUkVBRChJQ0xfUEhZX01JU0MocG9ydCkpICYK
PiA+IEBAIC0xODgsMjcgKzE4OCwyNyBAQCBzdGF0aWMgYm9vbCBpY2xfY29tYm9fcGh5X2VuYWJs
ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCShJOTE1X1JFQUQo
SUNMX1BPUlRfQ09NUF9EVzAocG9ydCkpICYgQ09NUF9JTklUKTsKPiA+ICAgfQo+ID4gLXN0YXRp
YyBib29sIGljbF9jb21ib19waHlfdmVyaWZ5X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgYm9vbCBpY2xfY29tYm9fcGh5X3ZlcmlmeV9zdGF0ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgICBlbnVtIHBvcnQg
cG9ydCkKPiA+ICAgewo+ID4gICAJYm9vbCByZXQ7Cj4gPiAtCWlmICghaWNsX2NvbWJvX3BoeV9l
bmFibGVkKGRldl9wcml2LCBwb3J0KSkKPiA+ICsJaWYgKCFpY2xfY29tYm9fcGh5X2VuYWJsZWQo
aTkxNSwgcG9ydCkpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gLQlyZXQgPSBjbmxfdmVyaWZ5
X3Byb2Ntb25fcmVmX3ZhbHVlcyhkZXZfcHJpdiwgcG9ydCk7Cj4gPiArCXJldCA9IGNubF92ZXJp
ZnlfcHJvY21vbl9yZWZfdmFsdWVzKGk5MTUsIHBvcnQpOwo+ID4gICAJaWYgKHBvcnQgPT0gUE9S
VF9BKQo+ID4gLQkJcmV0ICY9IGNoZWNrX3BoeV9yZWcoZGV2X3ByaXYsIHBvcnQsIElDTF9QT1JU
X0NPTVBfRFc4KHBvcnQpLAo+ID4gKwkJcmV0ICY9IGNoZWNrX3BoeV9yZWcoaTkxNSwgcG9ydCwg
SUNMX1BPUlRfQ09NUF9EVzgocG9ydCksCj4gPiAgIAkJCQkgICAgIElSRUZHRU4sIElSRUZHRU4p
Owo+ID4gLQlyZXQgJj0gY2hlY2tfcGh5X3JlZyhkZXZfcHJpdiwgcG9ydCwgSUNMX1BPUlRfQ0xf
RFc1KHBvcnQpLAo+ID4gKwlyZXQgJj0gY2hlY2tfcGh5X3JlZyhpOTE1LCBwb3J0LCBJQ0xfUE9S
VF9DTF9EVzUocG9ydCksCj4gPiAgIAkJCSAgICAgQ0xfUE9XRVJfRE9XTl9FTkFCTEUsIENMX1BP
V0VSX0RPV05fRU5BQkxFKTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IC12b2lkIGlu
dGVsX2NvbWJvX3BoeV9wb3dlcl91cF9sYW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiArdm9pZCBpbnRlbF9jb21ib19waHlfcG93ZXJfdXBfbGFuZXMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgZW51bSBwb3J0IHBvcnQsIGJvb2wg
aXNfZHNpLAo+ID4gICAJCQkJICAgIGludCBsYW5lX2NvdW50LCBib29sIGxhbmVfcmV2ZXJzYWwp
Cj4gPiAgIHsKPiA+IEBAIC0yNjAsMTQgKzI2MCwxNCBAQCB2b2lkIGludGVsX2NvbWJvX3BoeV9w
b3dlcl91cF9sYW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlJ
OTE1X1dSSVRFKElDTF9QT1JUX0NMX0RXMTAocG9ydCksIHZhbCk7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgdm9pZCBpY2xfY29tYm9fcGh5c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpY2xfY29tYm9fcGh5c19pbml0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+IC0JZm9y
X2VhY2hfY29tYm9fcG9ydChkZXZfcHJpdiwgcG9ydCkgewo+ID4gKwlmb3JfZWFjaF9jb21ib19w
b3J0KGk5MTUsIHBvcnQpIHsKPiA+ICAgCQl1MzIgdmFsOwo+ID4gLQkJaWYgKGljbF9jb21ib19w
aHlfdmVyaWZ5X3N0YXRlKGRldl9wcml2LCBwb3J0KSkgewo+ID4gKwkJaWYgKGljbF9jb21ib19w
aHlfdmVyaWZ5X3N0YXRlKGk5MTUsIHBvcnQpKSB7Cj4gPiAgIAkJCURSTV9ERUJVR19EUklWRVIo
IlBvcnQgJWMgY29tYm8gUEhZIGFscmVhZHkgZW5hYmxlZCwgd29uJ3QgcmVwcm9ncmFtIGl0Llxu
IiwKPiA+ICAgCQkJCQkgcG9ydF9uYW1lKHBvcnQpKTsKPiA+ICAgCQkJY29udGludWU7Cj4gPiBA
QCAtMjc3LDcgKzI3Nyw3IEBAIHN0YXRpYyB2b2lkIGljbF9jb21ib19waHlzX2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCXZhbCAmPSB+SUNMX1BIWV9NSVND
X0RFX0lPX0NPTVBfUFdSX0RPV047Cj4gPiAgIAkJSTkxNV9XUklURShJQ0xfUEhZX01JU0MocG9y
dCksIHZhbCk7Cj4gPiAtCQljbmxfc2V0X3Byb2Ntb25fcmVmX3ZhbHVlcyhkZXZfcHJpdiwgcG9y
dCk7Cj4gPiArCQljbmxfc2V0X3Byb2Ntb25fcmVmX3ZhbHVlcyhpOTE1LCBwb3J0KTsKPiA+ICAg
CQlpZiAocG9ydCA9PSBQT1JUX0EpIHsKPiA+ICAgCQkJdmFsID0gSTkxNV9SRUFEKElDTF9QT1JU
X0NPTVBfRFc4KHBvcnQpKTsKPiA+IEBAIC0yOTUsMTUgKzI5NSwxNSBAQCBzdGF0aWMgdm9pZCBp
Y2xfY29tYm9fcGh5c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCX0KPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGljbF9jb21ib19waHlzX3VuaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaWNsX2NvbWJv
X3BoeXNfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAg
IAllbnVtIHBvcnQgcG9ydDsKPiA+IC0JZm9yX2VhY2hfY29tYm9fcG9ydF9yZXZlcnNlKGRldl9w
cml2LCBwb3J0KSB7Cj4gPiArCWZvcl9lYWNoX2NvbWJvX3BvcnRfcmV2ZXJzZShpOTE1LCBwb3J0
KSB7Cj4gPiAgIAkJdTMyIHZhbDsKPiA+ICAgCQlpZiAocG9ydCA9PSBQT1JUX0EgJiYKPiA+IC0J
CSAgICAhaWNsX2NvbWJvX3BoeV92ZXJpZnlfc3RhdGUoZGV2X3ByaXYsIHBvcnQpKQo+ID4gKwkJ
ICAgICFpY2xfY29tYm9fcGh5X3ZlcmlmeV9zdGF0ZShpOTE1LCBwb3J0KSkKPiA+ICAgCQkJRFJN
X1dBUk4oIlBvcnQgJWMgY29tYm8gUEhZIEhXIHN0YXRlIGNoYW5nZWQgdW5leHBlY3RlZGx5XG4i
LAo+ID4gICAJCQkJIHBvcnRfbmFtZShwb3J0KSk7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfY29tYm9fcGh5LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9jb21ib19waHkuaAo+ID4gaW5kZXggZTZlMTk1YTgzYjE5Li5hMDgyODZjZmNlY2YgMTAwNjQ0
Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jb21ib19waHkuaAo+ID4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY29tYm9fcGh5LmgKPiA+IEBAIC0xMSw5ICsx
MSw5IEBACj4gPiAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwo+ID4gLXZvaWQgaW50ZWxfY29t
Ym9fcGh5X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lk
IGludGVsX2NvbWJvX3BoeV91bmluaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiA+IC12b2lkIGludGVsX2NvbWJvX3BoeV9wb3dlcl91cF9sYW5lcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpbnRlbF9jb21ib19waHlfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBpbnRlbF9jb21ib19waHlfdW5p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX2NvbWJv
X3BoeV9wb3dlcl91cF9sYW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJCSAgICBlbnVtIHBvcnQgcG9ydCwgYm9vbCBpc19kc2ksCj4gPiAgIAkJCQkgICAgaW50IGxh
bmVfY291bnQsIGJvb2wgbGFuZV9yZXZlcnNhbCk7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfY29ubmVjdG9yLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9jb25uZWN0b3IuYwo+ID4gaW5kZXggMDczYjZjM2FiN2NjLi4yOTEyODA0ZDVhMGQgMTAwNjQ0
Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jb25uZWN0b3IuYwo+ID4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY29ubmVjdG9yLmMKPiA+IEBAIC0yMTksMTAg
KzIxOSwxMCBAQCB2b2lkCj4gPiAgIGludGVsX2F0dGFjaF9mb3JjZV9hdWRpb19wcm9wZXJ0eShz
dHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2ID0gY29ubmVjdG9yLT5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgZHJtX3Byb3BlcnR5ICpwcm9w
Owo+ID4gLQlwcm9wID0gZGV2X3ByaXYtPmZvcmNlX2F1ZGlvX3Byb3BlcnR5Owo+ID4gKwlwcm9w
ID0gaTkxNS0+Zm9yY2VfYXVkaW9fcHJvcGVydHk7Cj4gPiAgIAlpZiAocHJvcCA9PSBOVUxMKSB7
Cj4gPiAgIAkJcHJvcCA9IGRybV9wcm9wZXJ0eV9jcmVhdGVfZW51bShkZXYsIDAsCj4gPiAgIAkJ
CQkJICAgImF1ZGlvIiwKPiA+IEBAIC0yMzEsNyArMjMxLDcgQEAgaW50ZWxfYXR0YWNoX2ZvcmNl
X2F1ZGlvX3Byb3BlcnR5KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIAkJ
aWYgKHByb3AgPT0gTlVMTCkKPiA+ICAgCQkJcmV0dXJuOwo+ID4gLQkJZGV2X3ByaXYtPmZvcmNl
X2F1ZGlvX3Byb3BlcnR5ID0gcHJvcDsKPiA+ICsJCWk5MTUtPmZvcmNlX2F1ZGlvX3Byb3BlcnR5
ID0gcHJvcDsKPiA+ICAgCX0KPiA+ICAgCWRybV9vYmplY3RfYXR0YWNoX3Byb3BlcnR5KCZjb25u
ZWN0b3ItPmJhc2UsIHByb3AsIDApOwo+ID4gICB9Cj4gPiBAQCAtMjQ2LDEwICsyNDYsMTAgQEAg
dm9pZAo+ID4gICBpbnRlbF9hdHRhY2hfYnJvYWRjYXN0X3JnYl9wcm9wZXJ0eShzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2ID0gY29ubmVjdG9yLT5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgZHJtX3Byb3BlcnR5ICpwcm9wOwo+ID4gLQlw
cm9wID0gZGV2X3ByaXYtPmJyb2FkY2FzdF9yZ2JfcHJvcGVydHk7Cj4gPiArCXByb3AgPSBpOTE1
LT5icm9hZGNhc3RfcmdiX3Byb3BlcnR5Owo+ID4gICAJaWYgKHByb3AgPT0gTlVMTCkgewo+ID4g
ICAJCXByb3AgPSBkcm1fcHJvcGVydHlfY3JlYXRlX2VudW0oZGV2LCBEUk1fTU9ERV9QUk9QX0VO
VU0sCj4gPiAgIAkJCQkJICAgIkJyb2FkY2FzdCBSR0IiLAo+ID4gQEAgLTI1OCw3ICsyNTgsNyBA
QCBpbnRlbF9hdHRhY2hfYnJvYWRjYXN0X3JnYl9wcm9wZXJ0eShzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yKQo+ID4gICAJCWlmIChwcm9wID09IE5VTEwpCj4gPiAgIAkJCXJldHVybjsK
PiA+IC0JCWRldl9wcml2LT5icm9hZGNhc3RfcmdiX3Byb3BlcnR5ID0gcHJvcDsKPiA+ICsJCWk5
MTUtPmJyb2FkY2FzdF9yZ2JfcHJvcGVydHkgPSBwcm9wOwo+ID4gICAJfQo+ID4gICAJZHJtX29i
amVjdF9hdHRhY2hfcHJvcGVydHkoJmNvbm5lY3Rvci0+YmFzZSwgcHJvcCwgMCk7Cj4gPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY3J0LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9jcnQuYwo+ID4gaW5kZXggM2ZjZjJmODRiY2NlLi4yYTc5NGUwYmY0NTcg
MTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jcnQuYwo+ID4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY3J0LmMKPiA+IEBAIC03MCw3ICs3MCw3IEBA
IHN0YXRpYyBzdHJ1Y3QgaW50ZWxfY3J0ICppbnRlbF9hdHRhY2hlZF9jcnQoc3RydWN0IGRybV9j
b25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgCXJldHVybiBpbnRlbF9lbmNvZGVyX3RvX2NydChp
bnRlbF9hdHRhY2hlZF9lbmNvZGVyKGNvbm5lY3RvcikpOwo+ID4gICB9Cj4gPiAtYm9vbCBpbnRl
bF9jcnRfcG9ydF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICtib29sIGludGVsX2NydF9wb3J0X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJCSAgICBpOTE1X3JlZ190IGFkcGFfcmVnLCBlbnVtIHBpcGUgKnBpcGUpCj4g
PiAgIHsKPiA+ICAgCXUzMiB2YWw7Cj4gPiBAQCAtNzgsNyArNzgsNyBAQCBib29sIGludGVsX2Ny
dF9wb3J0X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
dmFsID0gSTkxNV9SRUFEKGFkcGFfcmVnKTsKPiA+ICAgCS8qIGFzc2VydHMgd2FudCB0byBrbm93
IHRoZSBwaXBlIGV2ZW4gaWYgdGhlIHBvcnQgaXMgZGlzYWJsZWQgKi8KPiA+IC0JaWYgKEhBU19Q
Q0hfQ1BUKGRldl9wcml2KSkKPiA+ICsJaWYgKEhBU19QQ0hfQ1BUKGk5MTUpKQo+ID4gICAJCSpw
aXBlID0gKHZhbCAmIEFEUEFfUElQRV9TRUxfTUFTS19DUFQpID4+IEFEUEFfUElQRV9TRUxfU0hJ
RlRfQ1BUOwo+ID4gICAJZWxzZQo+ID4gICAJCSpwaXBlID0gKHZhbCAmIEFEUEFfUElQRV9TRUxf
TUFTSykgPj4gQURQQV9QSVBFX1NFTF9TSElGVDsKPiA+IEBAIC04OSwyNiArODksMjYgQEAgYm9v
bCBpbnRlbF9jcnRfcG9ydF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgc3RhdGljIGJvb2wgaW50ZWxfY3J0X2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCSAgIGVudW0gcGlwZSAqcGlwZSkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnQgKmNydCA9IGludGVs
X2VuY29kZXJfdG9fY3J0KGVuY29kZXIpOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7
Cj4gPiAgIAlib29sIHJldDsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0
X2lmX2VuYWJsZWQoZGV2X3ByaXYsCj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2dldF9pZl9lbmFibGVkKGk5MTUsCj4gPiAgIAkJCQkJCSAgICAgZW5jb2Rlci0+cG93ZXJfZG9t
YWluKTsKPiA+ICAgCWlmICghd2FrZXJlZikKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAtCXJl
dCA9IGludGVsX2NydF9wb3J0X2VuYWJsZWQoZGV2X3ByaXYsIGNydC0+YWRwYV9yZWcsIHBpcGUp
Owo+ID4gKwlyZXQgPSBpbnRlbF9jcnRfcG9ydF9lbmFibGVkKGk5MTUsIGNydC0+YWRwYV9yZWcs
IHBpcGUpOwo+ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgZW5jb2Rlci0+
cG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkx
NSwgZW5jb2Rlci0+cG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiA+ICAgCXJldHVybiByZXQ7Cj4g
PiAgIH0KPiA+ICAgc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9jcnRfZ2V0X2ZsYWdzKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ID4gICAJc3RydWN0IGludGVsX2NydCAqY3J0ID0gaW50ZWxfZW5jb2Rlcl90b19jcnQoZW5jb2Rl
cik7Cj4gPiAgIAl1MzIgdG1wLCBmbGFncyA9IDA7Cj4gPiBAQCAtMTQwLDcgKzE0MCw3IEBAIHN0
YXRpYyB2b2lkIGludGVsX2NydF9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAo+ID4gICBzdGF0aWMgdm9pZCBoc3dfY3J0X2dldF9jb25maWcoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
cGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlpbnRlbF9k
ZGlfZ2V0X2NvbmZpZyhlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gPiBAQCAtMTUwLDcgKzE1MCw3
IEBAIHN0YXRpYyB2b2lkIGhzd19jcnRfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKPiA+ICAgCQkJCQkgICAgICBEUk1fTU9ERV9GTEFHX05WU1lOQyk7Cj4gPiAgIAlw
aXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IGludGVsX2NydF9nZXRfZmxh
Z3MoZW5jb2Rlcik7Cj4gPiAtCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19j
bG9jayA9IGxwdF9nZXRfaWNsa2lwKGRldl9wcml2KTsKPiA+ICsJcGlwZV9jb25maWctPmJhc2Uu
YWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrID0gbHB0X2dldF9pY2xraXAoaTkxNSk7Cj4gPiAgIH0K
PiA+ICAgLyogTm90ZTogVGhlIGNhbGxlciBpcyByZXF1aXJlZCB0byBmaWx0ZXIgb3V0IGRwbXMg
bW9kZXMgbm90IHN1cHBvcnRlZCBieSB0aGUKPiA+IEBAIC0xNTksMTMgKzE1OSwxMyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9jcnRfc2V0X2RwbXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKPiA+ICAgCQkJICAgICAgIGludCBtb2RlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+ID4gICAJc3RydWN0IGludGVsX2NydCAqY3J0ID0gaW50ZWxfZW5jb2Rlcl90b19jcnQoZW5j
b2Rlcik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2Rl
ICphZGp1c3RlZF9tb2RlID0gJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiA+ICAg
CXUzMiBhZHBhOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA1KQo+ID4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDUpCj4gPiAgIAkJYWRwYSA9IEFEUEFfSE9UUExVR19CSVRTOwo+
ID4gICAJZWxzZQo+ID4gICAJCWFkcGEgPSAwOwo+ID4gQEAgLTE3NiwxNCArMTc2LDE0IEBAIHN0
YXRpYyB2b2lkIGludGVsX2NydF9zZXRfZHBtcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiA+ICAgCQlhZHBhIHw9IEFEUEFfVlNZTkNfQUNUSVZFX0hJR0g7Cj4gPiAgIAkvKiBGb3Ig
Q1BUIGFsbG93IDMgcGlwZSBjb25maWcsIGZvciBvdGhlcnMganVzdCB1c2UgQSBvciBCICovCj4g
PiAtCWlmIChIQVNfUENIX0xQVChkZXZfcHJpdikpCj4gPiArCWlmIChIQVNfUENIX0xQVChpOTE1
KSkKPiA+ICAgCQk7IC8qIFRob3NlIGJpdHMgZG9uJ3QgZXhpc3QgaGVyZSAqLwo+ID4gLQllbHNl
IGlmIChIQVNfUENIX0NQVChkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKEhBU19QQ0hfQ1BUKGk5
MTUpKQo+ID4gICAJCWFkcGEgfD0gQURQQV9QSVBFX1NFTF9DUFQoY3J0Yy0+cGlwZSk7Cj4gPiAg
IAllbHNlCj4gPiAgIAkJYWRwYSB8PSBBRFBBX1BJUEVfU0VMKGNydGMtPnBpcGUpOwo+ID4gLQlp
ZiAoIUhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19QQ0hfU1BMSVQoaTkx
NSkpCj4gPiAgIAkJSTkxNV9XUklURShCQ0xSUEFUKGNydGMtPnBpcGUpLCAwKTsKPiA+ICAgCXN3
aXRjaCAobW9kZSkgewo+ID4gQEAgLTIyOCw1NyArMjI4LDU3IEBAIHN0YXRpYyB2b2lkIGhzd19k
aXNhYmxlX2NydChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgIGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiA+ICAgCQkJICAg
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCVdBUk5fT04oIW9sZF9jcnRjX3N0YXRlLT5o
YXNfcGNoX2VuY29kZXIpOwo+ID4gLQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0
aW5nKGRldl9wcml2LCBQSVBFX0EsIGZhbHNlKTsKPiA+ICsJaW50ZWxfc2V0X3BjaF9maWZvX3Vu
ZGVycnVuX3JlcG9ydGluZyhpOTE1LCBQSVBFX0EsIGZhbHNlKTsKPiA+ICAgfQo+ID4gICBzdGF0
aWMgdm9pZCBoc3dfcG9zdF9kaXNhYmxlX2NydChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiA+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3Rh
dGUsCj4gPiAgIAkJCQkgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25u
X3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJaW50ZWxfZGRpX2Rp
c2FibGVfcGlwZV9jbG9jayhvbGRfY3J0Y19zdGF0ZSk7Cj4gPiAgIAlwY2hfcG9zdF9kaXNhYmxl
X2NydChlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5fc3RhdGUpOwo+ID4gLQlscHRf
ZGlzYWJsZV9wY2hfdHJhbnNjb2RlcihkZXZfcHJpdik7Cj4gPiAtCWxwdF9kaXNhYmxlX2ljbGtp
cChkZXZfcHJpdik7Cj4gPiArCWxwdF9kaXNhYmxlX3BjaF90cmFuc2NvZGVyKGk5MTUpOwo+ID4g
KwlscHRfZGlzYWJsZV9pY2xraXAoaTkxNSk7Cj4gPiAgIAlpbnRlbF9kZGlfZmRpX3Bvc3RfZGlz
YWJsZShlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5fc3RhdGUpOwo+ID4gICAJV0FS
Tl9PTighb2xkX2NydGNfc3RhdGUtPmhhc19wY2hfZW5jb2Rlcik7Cj4gPiAtCWludGVsX3NldF9w
Y2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIFBJUEVfQSwgdHJ1ZSk7Cj4gPiAr
CWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoaTkxNSwgUElQRV9BLCB0cnVl
KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBoc3dfcHJlX3BsbF9lbmFibGVfY3J0KHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJICAgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiA+ICAgCVdBUk5fT04oIWNydGNfc3RhdGUtPmhhc19wY2hfZW5jb2Rlcik7Cj4gPiAtCWludGVs
X3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIFBJUEVfQSwgZmFsc2Up
Owo+ID4gKwlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIFBJUEVf
QSwgZmFsc2UpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGhzd19wcmVfZW5hYmxlX2NydChz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkgICAgICAgY29uc3Qgc3Ry
dWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlw
ZTsKPiA+ICAgCVdBUk5fT04oIWNydGNfc3RhdGUtPmhhc19wY2hfZW5jb2Rlcik7Cj4gPiAtCWlu
dGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIHBpcGUsIGZhbHNl
KTsKPiA+ICsJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBwaXBl
LCBmYWxzZSk7Cj4gPiAtCWRldl9wcml2LT5kaXNwbGF5LmZkaV9saW5rX3RyYWluKGNydGMsIGNy
dGNfc3RhdGUpOwo+ID4gKwlpOTE1LT5kaXNwbGF5LmZkaV9saW5rX3RyYWluKGNydGMsIGNydGNf
c3RhdGUpOwo+ID4gICAJaW50ZWxfZGRpX2VuYWJsZV9waXBlX2Nsb2NrKGNydGNfc3RhdGUpOwo+
ID4gICB9Cj4gPiBAQCAtMjg3LDcgKzI4Nyw3IEBAIHN0YXRpYyB2b2lkIGhzd19lbmFibGVfY3J0
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJICAgY29uc3Qgc3RydWN0IGRy
bV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19z
dGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+
IEBAIC0yOTUsMTAgKzI5NSwxMCBAQCBzdGF0aWMgdm9pZCBoc3dfZW5hYmxlX2NydChzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCWludGVsX2NydF9zZXRfZHBtcyhlbmNvZGVy
LCBjcnRjX3N0YXRlLCBEUk1fTU9ERV9EUE1TX09OKTsKPiA+IC0JaW50ZWxfd2FpdF9mb3JfdmJs
YW5rKGRldl9wcml2LCBwaXBlKTsKPiA+IC0JaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9wcml2
LCBwaXBlKTsKPiA+IC0JaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZf
cHJpdiwgcGlwZSwgdHJ1ZSk7Cj4gPiAtCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBv
cnRpbmcoZGV2X3ByaXYsIFBJUEVfQSwgdHJ1ZSk7Cj4gPiArCWludGVsX3dhaXRfZm9yX3ZibGFu
ayhpOTE1LCBwaXBlKTsKPiA+ICsJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsIHBpcGUpOwo+
ID4gKwlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIHBpcGUsIHRy
dWUpOwo+ID4gKwlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIFBJ
UEVfQSwgdHJ1ZSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2NydChz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+IEBAIC0zMTMsOCArMzEzLDggQEAgaW50
ZWxfY3J0X21vZGVfdmFsaWQoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAg
CQkgICAgIHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gY29ubmVjdG9yLT5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+IC0JaW50IG1heF9kb3RjbGsg
PSBkZXZfcHJpdi0+bWF4X2RvdGNsa19mcmVxOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJaW50IG1heF9kb3RjbGsgPSBpOTE1LT5tYXhf
ZG90Y2xrX2ZyZXE7Cj4gPiAgIAlpbnQgbWF4X2Nsb2NrOwo+ID4gICAJaWYgKG1vZGUtPmZsYWdz
ICYgRFJNX01PREVfRkxBR19EQkxTQ0FOKQo+ID4gQEAgLTMyMywxNSArMzIzLDE1IEBAIGludGVs
X2NydF9tb2RlX3ZhbGlkKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gPiAgIAlp
ZiAobW9kZS0+Y2xvY2sgPCAyNTAwMCkKPiA+ICAgCQlyZXR1cm4gTU9ERV9DTE9DS19MT1c7Cj4g
PiAtCWlmIChIQVNfUENIX0xQVChkZXZfcHJpdikpCj4gPiArCWlmIChIQVNfUENIX0xQVChpOTE1
KSkKPiA+ICAgCQltYXhfY2xvY2sgPSAxODAwMDA7Cj4gPiAtCWVsc2UgaWYgKElTX1ZBTExFWVZJ
RVcoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQo+ID4gICAJ
CS8qCj4gPiAgIAkJICogMjcwIE1IeiBkdWUgdG8gY3VycmVudCBEUExMIGxpbWl0cywKPiA+ICAg
CQkgKiBEQUMgbGltaXQgc3VwcG9zZWRseSAzNTUgTUh6Lgo+ID4gICAJCSAqLwo+ID4gICAJCW1h
eF9jbG9jayA9IDI3MDAwMDsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOX1JBTkdFKGRldl9wcml2LCAz
LCA0KSkKPiA+ICsJZWxzZSBpZiAoSVNfR0VOX1JBTkdFKGk5MTUsIDMsIDQpKQo+ID4gICAJCW1h
eF9jbG9jayA9IDQwMDAwMDsKPiA+ICAgCWVsc2UKPiA+ICAgCQltYXhfY2xvY2sgPSAzNTAwMDA7
Cj4gPiBAQCAtMzQyLDcgKzM0Miw3IEBAIGludGVsX2NydF9tb2RlX3ZhbGlkKHN0cnVjdCBkcm1f
Y29ubmVjdG9yICpjb25uZWN0b3IsCj4gPiAgIAkJcmV0dXJuIE1PREVfQ0xPQ0tfSElHSDsKPiA+
ICAgCS8qIFRoZSBGREkgcmVjZWl2ZXIgb24gTFBUIG9ubHkgc3VwcG9ydHMgOGJwYyBhbmQgb25s
eSBoYXMgMiBsYW5lcy4gKi8KPiA+IC0JaWYgKEhBU19QQ0hfTFBUKGRldl9wcml2KSAmJgo+ID4g
KwlpZiAoSEFTX1BDSF9MUFQoaTkxNSkgJiYKPiA+ICAgCSAgICAoaXJvbmxha2VfZ2V0X2xhbmVz
X3JlcXVpcmVkKG1vZGUtPmNsb2NrLCAyNzAwMDAsIDI0KSA+IDIpKQo+ID4gICAJCXJldHVybiBN
T0RFX0NMT0NLX0hJR0g7Cj4gPiBAQCAtMzg4LDcgKzM4OCw3IEBAIHN0YXRpYyBpbnQgaHN3X2Ny
dF9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJ
CSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ID4gICAJCQkJICBzdHJ1
Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0K
PiA+ICAgCQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiA+IEBAIC00MDQsNyAr
NDA0LDcgQEAgc3RhdGljIGludCBoc3dfY3J0X2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ID4gICAJcGlwZV9jb25maWctPm91dHB1dF9mb3JtYXQgPSBJTlRF
TF9PVVRQVVRfRk9STUFUX1JHQjsKPiA+ICAgCS8qIExQVCBGREkgUlggb25seSBzdXBwb3J0cyA4
YnBjLiAqLwo+ID4gLQlpZiAoSEFTX1BDSF9MUFQoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChIQVNf
UENIX0xQVChpOTE1KSkgewo+ID4gICAJCWlmIChwaXBlX2NvbmZpZy0+YndfY29uc3RyYWluZWQg
JiYgcGlwZV9jb25maWctPnBpcGVfYnBwIDwgMjQpIHsKPiA+ICAgCQkJRFJNX0RFQlVHX0tNUygi
TFBUIG9ubHkgc3VwcG9ydHMgMjRicHBcbiIpOwo+ID4gICAJCQlyZXR1cm4gLUVJTlZBTDsKPiA+
IEBAIC00MjMsMTMgKzQyMywxMyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9pcm9ubGFrZV9jcnRfZGV0
ZWN0X2hvdHBsdWcoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgewo+ID4g
ICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNvbm5lY3Rvci0+ZGV2Owo+ID4gICAJc3RydWN0
IGludGVsX2NydCAqY3J0ID0gaW50ZWxfYXR0YWNoZWRfY3J0KGNvbm5lY3Rvcik7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAl1MzIgYWRw
YTsKPiA+ICAgCWJvb2wgcmV0Owo+ID4gICAJLyogVGhlIGZpcnN0IHRpbWUgdGhyb3VnaCwgdHJp
Z2dlciBhbiBleHBsaWNpdCBkZXRlY3Rpb24gY3ljbGUgKi8KPiA+ICAgCWlmIChjcnQtPmZvcmNl
X2hvdHBsdWdfcmVxdWlyZWQpIHsKPiA+IC0JCWJvb2wgdHVybl9vZmZfZGFjID0gSEFTX1BDSF9T
UExJVChkZXZfcHJpdik7Cj4gPiArCQlib29sIHR1cm5fb2ZmX2RhYyA9IEhBU19QQ0hfU1BMSVQo
aTkxNSk7Cj4gPiAgIAkJdTMyIHNhdmVfYWRwYTsKPiA+ICAgCQljcnQtPmZvcmNlX2hvdHBsdWdf
cmVxdWlyZWQgPSAwOwo+ID4gQEAgLTQ0Myw3ICs0NDMsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9p
cm9ubGFrZV9jcnRfZGV0ZWN0X2hvdHBsdWcoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rv
cikKPiA+ICAgCQlJOTE1X1dSSVRFKGNydC0+YWRwYV9yZWcsIGFkcGEpOwo+ID4gLQkJaWYgKGlu
dGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ID4gKwkJaWYgKGludGVs
X3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gPiAgIAkJCQkJICAgIGNydC0+YWRw
YV9yZWcsCj4gPiAgIAkJCQkJICAgIEFEUEFfQ1JUX0hPVFBMVUdfRk9SQ0VfVFJJR0dFUiwgMCwK
PiA+ICAgCQkJCQkgICAgMTAwMCkpCj4gPiBAQCAtNDcwLDcgKzQ3MCw3IEBAIHN0YXRpYyBib29s
IHZhbGxleXZpZXdfY3J0X2RldGVjdF9ob3RwbHVnKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25u
ZWN0b3IpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjb25uZWN0b3It
PmRldjsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnQgKmNydCA9IGludGVsX2F0dGFjaGVkX2NydChj
b25uZWN0b3IpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShk
ZXYpOwo+ID4gICAJYm9vbCByZWVuYWJsZV9ocGQ7Cj4gPiAgIAl1MzIgYWRwYTsKPiA+ICAgCWJv
b2wgcmV0Owo+ID4gQEAgLTQ4OCw3ICs0ODgsNyBAQCBzdGF0aWMgYm9vbCB2YWxsZXl2aWV3X2Ny
dF9kZXRlY3RfaG90cGx1ZyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICAJ
ICoKPiA+ICAgCSAqIEp1c3QgZGlzYWJsZSBIUEQgaW50ZXJydXB0cyBoZXJlIHRvIHByZXZlbnQg
dGhpcwo+ID4gICAJICovCj4gPiAtCXJlZW5hYmxlX2hwZCA9IGludGVsX2hwZF9kaXNhYmxlKGRl
dl9wcml2LCBjcnQtPmJhc2UuaHBkX3Bpbik7Cj4gPiArCXJlZW5hYmxlX2hwZCA9IGludGVsX2hw
ZF9kaXNhYmxlKGk5MTUsIGNydC0+YmFzZS5ocGRfcGluKTsKPiA+ICAgCXNhdmVfYWRwYSA9IGFk
cGEgPSBJOTE1X1JFQUQoY3J0LT5hZHBhX3JlZyk7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJ0cmln
Z2VyIGhvdHBsdWcgZGV0ZWN0IGN5Y2xlOiBhZHBhPTB4JXhcbiIsIGFkcGEpOwo+ID4gQEAgLTQ5
Nyw3ICs0OTcsNyBAQCBzdGF0aWMgYm9vbCB2YWxsZXl2aWV3X2NydF9kZXRlY3RfaG90cGx1Zyhz
dHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICAJSTkxNV9XUklURShjcnQtPmFk
cGFfcmVnLCBhZHBhKTsKPiA+IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJp
di0+dW5jb3JlLAo+ID4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29y
ZSwKPiA+ICAgCQkJCSAgICBjcnQtPmFkcGFfcmVnLAo+ID4gICAJCQkJICAgIEFEUEFfQ1JUX0hP
VFBMVUdfRk9SQ0VfVFJJR0dFUiwgMCwKPiA+ICAgCQkJCSAgICAxMDAwKSkgewo+ID4gQEAgLTUx
NSw3ICs1MTUsNyBAQCBzdGF0aWMgYm9vbCB2YWxsZXl2aWV3X2NydF9kZXRlY3RfaG90cGx1Zyhz
dHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICAJRFJNX0RFQlVHX0tNUygidmFs
bGV5dmlldyBob3RwbHVnIGFkcGE9MHgleCwgcmVzdWx0ICVkXG4iLCBhZHBhLCByZXQpOwo+ID4g
ICAJaWYgKHJlZW5hYmxlX2hwZCkKPiA+IC0JCWludGVsX2hwZF9lbmFibGUoZGV2X3ByaXYsIGNy
dC0+YmFzZS5ocGRfcGluKTsKPiA+ICsJCWludGVsX2hwZF9lbmFibGUoaTkxNSwgY3J0LT5iYXNl
LmhwZF9waW4pOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTUyMywxNSArNTIz
LDE1IEBAIHN0YXRpYyBib29sIHZhbGxleXZpZXdfY3J0X2RldGVjdF9ob3RwbHVnKHN0cnVjdCBk
cm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHN0YXRpYyBib29sIGludGVsX2NydF9kZXRl
Y3RfaG90cGx1ZyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAg
IAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY29ubmVjdG9yLT5kZXY7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAl1MzIgc3RhdDsKPiA+
ICAgCWJvb2wgcmV0ID0gZmFsc2U7Cj4gPiAgIAlpbnQgaSwgdHJpZXMgPSAwOwo+ID4gLQlpZiAo
SEFTX1BDSF9TUExJVChkZXZfcHJpdikpCj4gPiArCWlmIChIQVNfUENIX1NQTElUKGk5MTUpKQo+
ID4gICAJCXJldHVybiBpbnRlbF9pcm9ubGFrZV9jcnRfZGV0ZWN0X2hvdHBsdWcoY29ubmVjdG9y
KTsKPiA+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfVkFMTEVZ
VklFVyhpOTE1KSkKPiA+ICAgCQlyZXR1cm4gdmFsbGV5dmlld19jcnRfZGV0ZWN0X2hvdHBsdWco
Y29ubmVjdG9yKTsKPiA+ICAgCS8qCj4gPiBAQCAtNTM5LDE4ICs1MzksMTggQEAgc3RhdGljIGJv
b2wgaW50ZWxfY3J0X2RldGVjdF9ob3RwbHVnKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IpCj4gPiAgIAkgKiB0byBnZXQgYSByZWxpYWJsZSByZXN1bHQuCj4gPiAgIAkgKi8KPiA+IC0J
aWYgKElTX0c0NShkZXZfcHJpdikpCj4gPiArCWlmIChJU19HNDUoaTkxNSkpCj4gPiAgIAkJdHJp
ZXMgPSAyOwo+ID4gICAJZWxzZQo+ID4gICAJCXRyaWVzID0gMTsKPiA+ICAgCWZvciAoaSA9IDA7
IGkgPCB0cmllcyA7IGkrKykgewo+ID4gICAJCS8qIHR1cm4gb24gdGhlIEZPUkNFX0RFVEVDVCAq
Lwo+ID4gLQkJaTkxNV9ob3RwbHVnX2ludGVycnVwdF91cGRhdGUoZGV2X3ByaXYsCj4gPiArCQlp
OTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0ZShpOTE1LAo+ID4gICAJCQkJCSAgICAgIENSVF9I
T1RQTFVHX0ZPUkNFX0RFVEVDVCwKPiA+ICAgCQkJCQkgICAgICBDUlRfSE9UUExVR19GT1JDRV9E
RVRFQ1QpOwo+ID4gICAJCS8qIHdhaXQgZm9yIEZPUkNFX0RFVEVDVCB0byBnbyBvZmYgKi8KPiA+
IC0JCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwgUE9SVF9I
T1RQTFVHX0VOLAo+ID4gKwkJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNv
cmUsIFBPUlRfSE9UUExVR19FTiwKPiA+ICAgCQkJCQkgICAgQ1JUX0hPVFBMVUdfRk9SQ0VfREVU
RUNULCAwLAo+ID4gICAJCQkJCSAgICAxMDAwKSkKPiA+ICAgCQkJRFJNX0RFQlVHX0tNUygidGlt
ZWQgb3V0IHdhaXRpbmcgZm9yIEZPUkNFX0RFVEVDVCB0byBnbyBvZmYiKTsKPiA+IEBAIC01NjMs
NyArNTYzLDcgQEAgc3RhdGljIGJvb2wgaW50ZWxfY3J0X2RldGVjdF9ob3RwbHVnKHN0cnVjdCBk
cm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIAkvKiBjbGVhciB0aGUgaW50ZXJydXB0IHdl
IGp1c3QgZ2VuZXJhdGVkLCBpZiBhbnkgKi8KPiA+ICAgCUk5MTVfV1JJVEUoUE9SVF9IT1RQTFVH
X1NUQVQsIENSVF9IT1RQTFVHX0lOVF9TVEFUVVMpOwo+ID4gLQlpOTE1X2hvdHBsdWdfaW50ZXJy
dXB0X3VwZGF0ZShkZXZfcHJpdiwgQ1JUX0hPVFBMVUdfRk9SQ0VfREVURUNULCAwKTsKPiA+ICsJ
aTkxNV9ob3RwbHVnX2ludGVycnVwdF91cGRhdGUoaTkxNSwgQ1JUX0hPVFBMVUdfRk9SQ0VfREVU
RUNULCAwKTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IEBAIC02MDUsMTQgKzYwNSwx
NCBAQCBzdGF0aWMgaW50IGludGVsX2NydF9kZGNfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVj
dG9yICpjb25uZWN0b3IsCj4gPiAgIHN0YXRpYyBib29sIGludGVsX2NydF9kZXRlY3RfZGRjKHN0
cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9jcnQgKmNydCA9IGludGVsX2F0dGFjaGVkX2NydChjb25uZWN0b3IpOwo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydC0+YmFzZS5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnQtPmJhc2Uu
YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGVkaWQgKmVkaWQ7Cj4gPiAgIAlzdHJ1Y3QgaTJjX2Fk
YXB0ZXIgKmkyYzsKPiA+ICAgCWJvb2wgcmV0ID0gZmFsc2U7Cj4gPiAgIAlCVUdfT04oY3J0LT5i
YXNlLnR5cGUgIT0gSU5URUxfT1VUUFVUX0FOQUxPRyk7Cj4gPiAtCWkyYyA9IGludGVsX2dtYnVz
X2dldF9hZGFwdGVyKGRldl9wcml2LCBkZXZfcHJpdi0+dmJ0LmNydF9kZGNfcGluKTsKPiA+ICsJ
aTJjID0gaW50ZWxfZ21idXNfZ2V0X2FkYXB0ZXIoaTkxNSwgaTkxNS0+dmJ0LmNydF9kZGNfcGlu
KTsKPiA+ICAgCWVkaWQgPSBpbnRlbF9jcnRfZ2V0X2VkaWQoY29ubmVjdG9yLCBpMmMpOwo+ID4g
ICAJaWYgKGVkaWQpIHsKPiA+IEBAIC02NDIsOCArNjQyLDggQEAgc3RhdGljIGVudW0gZHJtX2Nv
bm5lY3Rvcl9zdGF0dXMKPiA+ICAgaW50ZWxfY3J0X2xvYWRfZGV0ZWN0KHN0cnVjdCBpbnRlbF9j
cnQgKmNydCwgdTMyIHBpcGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYg
PSBjcnQtPmJhc2UuYmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0g
JmRldl9wcml2LT51bmNvcmU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+
dW5jb3JlOwo+ID4gICAJdTMyIHNhdmVfYmNscnBhdDsKPiA+ICAgCXUzMiBzYXZlX3Z0b3RhbDsK
PiA+ICAgCXUzMiB2dG90YWwsIHZhY3RpdmU7Cj4gPiBAQCAtNjc3LDcgKzY3Nyw3IEBAIGludGVs
X2NydF9sb2FkX2RldGVjdChzdHJ1Y3QgaW50ZWxfY3J0ICpjcnQsIHUzMiBwaXBlKQo+ID4gICAJ
LyogU2V0IHRoZSBib3JkZXIgY29sb3IgdG8gcHVycGxlLiAqLwo+ID4gICAJaW50ZWxfdW5jb3Jl
X3dyaXRlKHVuY29yZSwgYmNscnBhdF9yZWcsIDB4NTAwMDUwKTsKPiA+IC0JaWYgKCFJU19HRU4o
ZGV2X3ByaXYsIDIpKSB7Cj4gPiArCWlmICghSVNfR0VOKGk5MTUsIDIpKSB7Cj4gPiAgIAkJdTMy
IHBpcGVjb25mID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBwaXBlY29uZl9yZWcpOwo+ID4g
ICAJCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsCj4gPiAgIAkJCQkgICBwaXBlY29uZl9yZWcs
Cj4gPiBAQCAtNjg1LDcgKzY4NSw3IEBAIGludGVsX2NydF9sb2FkX2RldGVjdChzdHJ1Y3QgaW50
ZWxfY3J0ICpjcnQsIHUzMiBwaXBlKQo+ID4gICAJCWludGVsX3VuY29yZV9wb3N0aW5nX3JlYWQo
dW5jb3JlLCBwaXBlY29uZl9yZWcpOwo+ID4gICAJCS8qIFdhaXQgZm9yIG5leHQgVmJsYW5rIHRv
IHN1YnN0aXR1ZQo+ID4gICAJCSAqIGJvcmRlciBjb2xvciBmb3IgQ29sb3IgaW5mbyAqLwo+ID4g
LQkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJCWludGVsX3dh
aXRfZm9yX3ZibGFuayhpOTE1LCBwaXBlKTsKPiA+ICAgCQlzdDAwID0gaW50ZWxfdW5jb3JlX3Jl
YWQ4KHVuY29yZSwgX1ZHQV9NU1JfV1JJVEUpOwo+ID4gICAJCXN0YXR1cyA9ICgoc3QwMCAmICgx
IDw8IDQpKSAhPSAwKSA/Cj4gPiAgIAkJCWNvbm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkIDoKPiA+
IEBAIC03ODksNyArNzg5LDcgQEAgaW50ZWxfY3J0X2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yLAo+ID4gICAJCSBzdHJ1Y3QgZHJtX21vZGVzZXRfYWNxdWlyZV9jdHggKmN0
eCwKPiA+ICAgCQkgYm9vbCBmb3JjZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9jcnQgKmNydCA9IGludGVsX2F0dGFjaGVkX2NydChjb25uZWN0b3IpOwo+ID4g
ICAJc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIgPSAmY3J0LT5iYXNlOwo+ID4g
ICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiBAQCAtODAxLDcgKzgwMSw3IEBAIGludGVs
X2NydF9kZXRlY3Qoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgCQkgICAg
ICBmb3JjZSk7Cj4gPiAgIAlpZiAoaTkxNV9tb2RwYXJhbXMubG9hZF9kZXRlY3RfdGVzdCkgewo+
ID4gLQkJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9wcml2LAo+ID4gKwkJ
d2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5MTUsCj4gPiAgIAkJCQkJCSAgaW50
ZWxfZW5jb2Rlci0+cG93ZXJfZG9tYWluKTsKPiA+ICAgCQlnb3RvIGxvYWRfZGV0ZWN0Owo+ID4g
ICAJfQo+ID4gQEAgLTgxMCwxMCArODEwLDEwIEBAIGludGVsX2NydF9kZXRlY3Qoc3RydWN0IGRy
bV9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgCWlmIChkbWlfY2hlY2tfc3lzdGVtKGludGVs
X3NwdXJpb3VzX2NydF9kZXRlY3QpKQo+ID4gICAJCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Rp
c2Nvbm5lY3RlZDsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9w
cml2LAo+ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwKPiA+ICAg
CQkJCQkgIGludGVsX2VuY29kZXItPnBvd2VyX2RvbWFpbik7Cj4gPiAtCWlmIChJOTE1X0hBU19I
T1RQTFVHKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSTkxNV9IQVNfSE9UUExVRyhpOTE1KSkgewo+
ID4gICAJCS8qIFdlIGNhbiBub3QgcmVseSBvbiB0aGUgSFBEIHBpbiBhbHdheXMgYmVpbmcgY29y
cmVjdGx5IHdpcmVkCj4gPiAgIAkJICogdXAsIGZvciBleGFtcGxlIG1hbnkgS1ZNIGRvIG5vdCBw
YXNzIGl0IHRocm91Z2gsIGFuZCBzbwo+ID4gICAJCSAqIG9ubHkgdHJ1c3QgYW4gYXNzZXJ0aW9u
IHRoYXQgdGhlIG1vbml0b3IgaXMgY29ubmVjdGVkLgo+ID4gQEAgLTgzNSw3ICs4MzUsNyBAQCBp
bnRlbF9jcnRfZGV0ZWN0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gPiAgIAkg
KiBicm9rZW4gbW9uaXRvciAod2l0aG91dCBlZGlkKSB0byB3b3JrIGJlaGluZCBhIGJyb2tlbiBr
dm0gKHRoYXQgZmFpbHMKPiA+ICAgCSAqIHRvIGhhdmUgdGhlIHJpZ2h0IHJlc2lzdG9ycyBmb3Ig
SFAgZGV0ZWN0aW9uKSBuZWVkcyB0byBmaXggdGhpcyB1cC4KPiA+ICAgCSAqIEZvciBub3cganVz
dCBiYWlsIG91dC4gKi8KPiA+IC0JaWYgKEk5MTVfSEFTX0hPVFBMVUcoZGV2X3ByaXYpKSB7Cj4g
PiArCWlmIChJOTE1X0hBU19IT1RQTFVHKGk5MTUpKSB7Cj4gPiAgIAkJc3RhdHVzID0gY29ubmVj
dG9yX3N0YXR1c19kaXNjb25uZWN0ZWQ7Cj4gPiAgIAkJZ290byBvdXQ7Cj4gPiAgIAl9Cj4gPiBA
QCAtODUxLDcgKzg1MSw3IEBAIGludGVsX2NydF9kZXRlY3Qoc3RydWN0IGRybV9jb25uZWN0b3Ig
KmNvbm5lY3RvciwKPiA+ICAgCWlmIChyZXQgPiAwKSB7Cj4gPiAgIAkJaWYgKGludGVsX2NydF9k
ZXRlY3RfZGRjKGNvbm5lY3RvcikpCj4gPiAgIAkJCXN0YXR1cyA9IGNvbm5lY3Rvcl9zdGF0dXNf
Y29ubmVjdGVkOwo+ID4gLQkJZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDQpCj4gPiAr
CQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPCA0KQo+ID4gICAJCQlzdGF0dXMgPSBpbnRlbF9j
cnRfbG9hZF9kZXRlY3QoY3J0LAo+ID4gICAJCQkJdG9faW50ZWxfY3J0Yyhjb25uZWN0b3ItPnN0
YXRlLT5jcnRjKS0+cGlwZSk7Cj4gPiAgIAkJZWxzZSBpZiAoaTkxNV9tb2RwYXJhbXMubG9hZF9k
ZXRlY3RfdGVzdCkKPiA+IEBAIC04NjYsNDQgKzg2Niw0NCBAQCBpbnRlbF9jcnRfZGV0ZWN0KHN0
cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4gPiAgIAl9Cj4gPiAgIG91dDoKPiA+IC0J
aW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIGludGVsX2VuY29kZXItPnBvd2VyX2Rv
bWFpbiwgd2FrZXJlZik7Cj4gPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIGludGVs
X2VuY29kZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4gc3RhdHVzOwo+
ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgaW50ZWxfY3J0X2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gY29ubmVjdG9yLT5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0ICpjcnQgPSBpbnRlbF9hdHRhY2hl
ZF9jcnQoY29ubmVjdG9yKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNv
ZGVyID0gJmNydC0+YmFzZTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJ
c3RydWN0IGkyY19hZGFwdGVyICppMmM7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gLQl3YWtlcmVmID0g
aW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsCj4gPiArCXdha2VyZWYgPSBpbnRlbF9k
aXNwbGF5X3Bvd2VyX2dldChpOTE1LAo+ID4gICAJCQkJCSAgaW50ZWxfZW5jb2Rlci0+cG93ZXJf
ZG9tYWluKTsKPiA+IC0JaTJjID0gaW50ZWxfZ21idXNfZ2V0X2FkYXB0ZXIoZGV2X3ByaXYsIGRl
dl9wcml2LT52YnQuY3J0X2RkY19waW4pOwo+ID4gKwlpMmMgPSBpbnRlbF9nbWJ1c19nZXRfYWRh
cHRlcihpOTE1LCBpOTE1LT52YnQuY3J0X2RkY19waW4pOwo+ID4gICAJcmV0ID0gaW50ZWxfY3J0
X2RkY19nZXRfbW9kZXMoY29ubmVjdG9yLCBpMmMpOwo+ID4gLQlpZiAocmV0IHx8ICFJU19HNFgo
ZGV2X3ByaXYpKQo+ID4gKwlpZiAocmV0IHx8ICFJU19HNFgoaTkxNSkpCj4gPiAgIAkJZ290byBv
dXQ7Cj4gPiAgIAkvKiBUcnkgdG8gcHJvYmUgZGlnaXRhbCBwb3J0IGZvciBvdXRwdXQgaW4gRFZJ
LUkgLT4gVkdBIG1vZGUuICovCj4gPiAtCWkyYyA9IGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGRl
dl9wcml2LCBHTUJVU19QSU5fRFBCKTsKPiA+ICsJaTJjID0gaW50ZWxfZ21idXNfZ2V0X2FkYXB0
ZXIoaTkxNSwgR01CVVNfUElOX0RQQik7Cj4gPiAgIAlyZXQgPSBpbnRlbF9jcnRfZGRjX2dldF9t
b2Rlcyhjb25uZWN0b3IsIGkyYyk7Cj4gPiAgIG91dDoKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dl
cl9wdXQoZGV2X3ByaXYsIGludGVsX2VuY29kZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4g
PiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIGludGVsX2VuY29kZXItPnBvd2VyX2Rv
bWFpbiwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiAgIHZvaWQgaW50
ZWxfY3J0X3Jlc2V0KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5k
ZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydCAqY3J0ID0gaW50ZWxfZW5jb2Rlcl90b19jcnQo
dG9faW50ZWxfZW5jb2RlcihlbmNvZGVyKSk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDUpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA1KSB7Cj4gPiAgIAkJdTMyIGFk
cGE7Cj4gPiAgIAkJYWRwYSA9IEk5MTVfUkVBRChjcnQtPmFkcGFfcmVnKTsKPiA+IEBAIC05NDIs
NyArOTQyLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9mdW5jcyBpbnRlbF9j
cnRfZW5jX2Z1bmNzID0gewo+ID4gICAJLmRlc3Ryb3kgPSBpbnRlbF9lbmNvZGVyX2Rlc3Ryb3ks
Cj4gPiAgIH07Cj4gPiAtdm9pZCBpbnRlbF9jcnRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9jcnRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rv
cjsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnQgKmNydDsKPiA+IEBAIC05NTAsOSArOTUwLDkgQEAg
dm9pZCBpbnRlbF9jcnRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiAgIAlpOTE1X3JlZ190IGFkcGFfcmVnOwo+ID4gICAJdTMyIGFkcGE7Cj4gPiAtCWlmIChIQVNf
UENIX1NQTElUKGRldl9wcml2KSkKPiA+ICsJaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpCj4gPiAg
IAkJYWRwYV9yZWcgPSBQQ0hfQURQQTsKPiA+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZf
cHJpdikpCj4gPiArCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCj4gPiAgIAkJYWRwYV9y
ZWcgPSBWTFZfQURQQTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlhZHBhX3JlZyA9IEFEUEE7Cj4gPiBA
QCAtOTg2LDIyICs5ODYsMjIgQEAgdm9pZCBpbnRlbF9jcnRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAljb25uZWN0b3IgPSAmaW50ZWxfY29ubmVjdG9yLT5i
YXNlOwo+ID4gICAJY3J0LT5jb25uZWN0b3IgPSBpbnRlbF9jb25uZWN0b3I7Cj4gPiAtCWRybV9j
b25uZWN0b3JfaW5pdCgmZGV2X3ByaXYtPmRybSwgJmludGVsX2Nvbm5lY3Rvci0+YmFzZSwKPiA+
ICsJZHJtX2Nvbm5lY3Rvcl9pbml0KCZpOTE1LT5kcm0sICZpbnRlbF9jb25uZWN0b3ItPmJhc2Us
Cj4gPiAgIAkJCSAgICZpbnRlbF9jcnRfY29ubmVjdG9yX2Z1bmNzLCBEUk1fTU9ERV9DT05ORUNU
T1JfVkdBKTsKPiA+IC0JZHJtX2VuY29kZXJfaW5pdCgmZGV2X3ByaXYtPmRybSwgJmNydC0+YmFz
ZS5iYXNlLCAmaW50ZWxfY3J0X2VuY19mdW5jcywKPiA+ICsJZHJtX2VuY29kZXJfaW5pdCgmaTkx
NS0+ZHJtLCAmY3J0LT5iYXNlLmJhc2UsICZpbnRlbF9jcnRfZW5jX2Z1bmNzLAo+ID4gICAJCQkg
RFJNX01PREVfRU5DT0RFUl9EQUMsICJDUlQiKTsKPiA+ICAgCWludGVsX2Nvbm5lY3Rvcl9hdHRh
Y2hfZW5jb2RlcihpbnRlbF9jb25uZWN0b3IsICZjcnQtPmJhc2UpOwo+ID4gICAJY3J0LT5iYXNl
LnR5cGUgPSBJTlRFTF9PVVRQVVRfQU5BTE9HOwo+ID4gICAJY3J0LT5iYXNlLmNsb25lYWJsZSA9
ICgxIDw8IElOVEVMX09VVFBVVF9EVk8pIHwgKDEgPDwgSU5URUxfT1VUUFVUX0hETUkpOwo+ID4g
LQlpZiAoSVNfSTgzMChkZXZfcHJpdikpCj4gPiArCWlmIChJU19JODMwKGk5MTUpKQo+ID4gICAJ
CWNydC0+YmFzZS5jcnRjX21hc2sgPSAoMSA8PCAwKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQljcnQt
PmJhc2UuY3J0Y19tYXNrID0gKDEgPDwgMCkgfCAoMSA8PCAxKSB8ICgxIDw8IDIpOwo+ID4gLQlp
ZiAoSVNfR0VOKGRldl9wcml2LCAyKSkKPiA+ICsJaWYgKElTX0dFTihpOTE1LCAyKSkKPiA+ICAg
CQljb25uZWN0b3ItPmludGVybGFjZV9hbGxvd2VkID0gMDsKPiA+ICAgCWVsc2UKPiA+ICAgCQlj
b25uZWN0b3ItPmludGVybGFjZV9hbGxvd2VkID0gMTsKPiA+IEBAIC0xMDExLDEzICsxMDExLDEz
IEBAIHZvaWQgaW50ZWxfY3J0X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gICAJY3J0LT5iYXNlLnBvd2VyX2RvbWFpbiA9IFBPV0VSX0RPTUFJTl9QT1JUX0NSVDsK
PiA+IC0JaWYgKEk5MTVfSEFTX0hPVFBMVUcoZGV2X3ByaXYpICYmCj4gPiArCWlmIChJOTE1X0hB
U19IT1RQTFVHKGk5MTUpICYmCj4gPiAgIAkgICAgIWRtaV9jaGVja19zeXN0ZW0oaW50ZWxfc3B1
cmlvdXNfY3J0X2RldGVjdCkpIHsKPiA+ICAgCQljcnQtPmJhc2UuaHBkX3BpbiA9IEhQRF9DUlQ7
Cj4gPiAgIAkJY3J0LT5iYXNlLmhvdHBsdWcgPSBpbnRlbF9lbmNvZGVyX2hvdHBsdWc7Cj4gPiAg
IAl9Cj4gPiAtCWlmIChIQVNfRERJKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX0RESShpOTE1
KSkgewo+ID4gICAJCWNydC0+YmFzZS5wb3J0ID0gUE9SVF9FOwo+ID4gICAJCWNydC0+YmFzZS5n
ZXRfY29uZmlnID0gaHN3X2NydF9nZXRfY29uZmlnOwo+ID4gICAJCWNydC0+YmFzZS5nZXRfaHdf
c3RhdGUgPSBpbnRlbF9kZGlfZ2V0X2h3X3N0YXRlOwo+ID4gQEAgLTEwMjgsNyArMTAyOCw3IEBA
IHZvaWQgaW50ZWxfY3J0X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gICAJCWNydC0+YmFzZS5kaXNhYmxlID0gaHN3X2Rpc2FibGVfY3J0Owo+ID4gICAJCWNydC0+
YmFzZS5wb3N0X2Rpc2FibGUgPSBoc3dfcG9zdF9kaXNhYmxlX2NydDsKPiA+ICAgCX0gZWxzZSB7
Cj4gPiAtCQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpIHsKPiA+ICsJCWlmIChIQVNfUENI
X1NQTElUKGk5MTUpKSB7Cj4gPiAgIAkJCWNydC0+YmFzZS5jb21wdXRlX2NvbmZpZyA9IHBjaF9j
cnRfY29tcHV0ZV9jb25maWc7Cj4gPiAgIAkJCWNydC0+YmFzZS5kaXNhYmxlID0gcGNoX2Rpc2Fi
bGVfY3J0Owo+ID4gICAJCQljcnQtPmJhc2UucG9zdF9kaXNhYmxlID0gcGNoX3Bvc3RfZGlzYWJs
ZV9jcnQ7Cj4gPiBAQCAtMTA0NSw3ICsxMDQ1LDcgQEAgdm9pZCBpbnRlbF9jcnRfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlkcm1fY29ubmVjdG9yX2hlbHBl
cl9hZGQoY29ubmVjdG9yLCAmaW50ZWxfY3J0X2Nvbm5lY3Rvcl9oZWxwZXJfZnVuY3MpOwo+ID4g
LQlpZiAoIUk5MTVfSEFTX0hPVFBMVUcoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUk5MTVfSEFTX0hP
VFBMVUcoaTkxNSkpCj4gPiAgIAkJaW50ZWxfY29ubmVjdG9yLT5wb2xsZWQgPSBEUk1fQ09OTkVD
VE9SX1BPTExfQ09OTkVDVDsKPiA+ICAgCS8qCj4gPiBAQCAtMTA1OCwxMSArMTA1OCwxMSBAQCB2
b2lkIGludGVsX2NydF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCSAqIHBvbGFyaXR5IGFuZCBsaW5rIHJldmVyc2FsIGJpdHMgb3Igbm90LCBpbnN0ZWFkIG9m
IHJlbHlpbmcgb24gdGhlCj4gPiAgIAkgKiBCSU9TLgo+ID4gICAJICovCj4gPiAtCWlmIChIQVNf
UENIX0xQVChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19QQ0hfTFBUKGk5MTUpKSB7Cj4gPiAg
IAkJdTMyIGZkaV9jb25maWcgPSBGRElfUlhfUE9MQVJJVFlfUkVWRVJTRURfTFBUIHwKPiA+ICAg
CQkJCSBGRElfUlhfTElOS19SRVZFUlNBTF9PVkVSUklERTsKPiA+IC0JCWRldl9wcml2LT5mZGlf
cnhfY29uZmlnID0gSTkxNV9SRUFEKEZESV9SWF9DVEwoUElQRV9BKSkgJiBmZGlfY29uZmlnOwo+
ID4gKwkJaTkxNS0+ZmRpX3J4X2NvbmZpZyA9IEk5MTVfUkVBRChGRElfUlhfQ1RMKFBJUEVfQSkp
ICYgZmRpX2NvbmZpZzsKPiA+ICAgCX0KPiA+ICAgCWludGVsX2NydF9yZXNldCgmY3J0LT5iYXNl
LmJhc2UpOwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2NydC5o
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY3J0LmgKPiA+IGluZGV4IDFiM2ZiYTM1OWVm
Yy4uZjc3MWZiY2Y4YjI3IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfY3J0LmgKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2NydC5oCj4gPiBA
QCAtMTMsOSArMTMsOSBAQCBzdHJ1Y3QgZHJtX2VuY29kZXI7Cj4gPiAgIHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlOwo+ID4gICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiA+IC1ib29sIGludGVs
X2NydF9wb3J0X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
K2Jvb2wgaW50ZWxfY3J0X3BvcnRfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICAgCQkJICAgIGk5MTVfcmVnX3QgYWRwYV9yZWcsIGVudW0gcGlwZSAqcGlwZSk7Cj4g
PiAtdm9pZCBpbnRlbF9jcnRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+ID4gK3ZvaWQgaW50ZWxfY3J0X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Owo+ID4gICB2b2lkIGludGVsX2NydF9yZXNldChzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIp
Owo+ID4gICAjZW5kaWYgLyogX19JTlRFTF9DUlRfSF9fICovCj4gPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY3NyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9jc3IuYwo+ID4gaW5kZXggYmYwZWViZDM4NWI5Li4yOWVhM2NiNmJiYWYgMTAwNjQ0Cj4gPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jc3IuYwo+ID4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfY3NyLmMKPiA+IEBAIC0yMDYsMTggKzIwNiwxOCBAQCBzdGF0aWMg
Y29uc3Qgc3RydWN0IHN0ZXBwaW5nX2luZm8gaWNsX3N0ZXBwaW5nX2luZm9bXSA9IHsKPiA+ICAg
c3RhdGljIGNvbnN0IHN0cnVjdCBzdGVwcGluZ19pbmZvIG5vX3N0ZXBwaW5nX2luZm8gPSB7ICcq
JywgJyonIH07Cj4gPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc3RlcHBpbmdfaW5mbyAqCj4gPiAt
aW50ZWxfZ2V0X3N0ZXBwaW5nX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gK2ludGVsX2dldF9zdGVwcGluZ19pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAgIAljb25zdCBzdHJ1Y3Qgc3RlcHBpbmdfaW5mbyAqc2k7Cj4gPiAg
IAl1bnNpZ25lZCBpbnQgc2l6ZTsKPiA+IC0JaWYgKElTX0lDRUxBS0UoZGV2X3ByaXYpKSB7Cj4g
PiArCWlmIChJU19JQ0VMQUtFKGk5MTUpKSB7Cj4gPiAgIAkJc2l6ZSA9IEFSUkFZX1NJWkUoaWNs
X3N0ZXBwaW5nX2luZm8pOwo+ID4gICAJCXNpID0gaWNsX3N0ZXBwaW5nX2luZm87Cj4gPiAtCX0g
ZWxzZSBpZiAoSVNfU0tZTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19TS1lM
QUtFKGk5MTUpKSB7Cj4gPiAgIAkJc2l6ZSA9IEFSUkFZX1NJWkUoc2tsX3N0ZXBwaW5nX2luZm8p
Owo+ID4gICAJCXNpID0gc2tsX3N0ZXBwaW5nX2luZm87Cj4gPiAtCX0gZWxzZSBpZiAoSVNfQlJP
WFRPTihkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19CUk9YVE9OKGk5MTUpKSB7Cj4g
PiAgIAkJc2l6ZSA9IEFSUkFZX1NJWkUoYnh0X3N0ZXBwaW5nX2luZm8pOwo+ID4gICAJCXNpID0g
Ynh0X3N0ZXBwaW5nX2luZm87Cj4gPiAgIAl9IGVsc2Ugewo+ID4gQEAgLTIyNSwxOSArMjI1LDE5
IEBAIGludGVsX2dldF9zdGVwcGluZ19pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICAgCQlzaSA9IE5VTEw7Cj4gPiAgIAl9Cj4gPiAtCWlmIChJTlRFTF9SRVZJRChk
ZXZfcHJpdikgPCBzaXplKQo+ID4gLQkJcmV0dXJuIHNpICsgSU5URUxfUkVWSUQoZGV2X3ByaXYp
Owo+ID4gKwlpZiAoSU5URUxfUkVWSUQoaTkxNSkgPCBzaXplKQo+ID4gKwkJcmV0dXJuIHNpICsg
SU5URUxfUkVWSUQoaTkxNSk7Cj4gPiAgIAlyZXR1cm4gJm5vX3N0ZXBwaW5nX2luZm87Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCBnZW45X3NldF9kY19zdGF0ZV9kZWJ1Z21hc2soc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGdlbjlfc2V0X2RjX3N0
YXRlX2RlYnVnbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4g
ICAJdTMyIHZhbCwgbWFzazsKPiA+ICAgCW1hc2sgPSBEQ19TVEFURV9ERUJVR19NQVNLX01FTU9S
WV9VUDsKPiA+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfR0VOOV9M
UChpOTE1KSkKPiA+ICAgCQltYXNrIHw9IERDX1NUQVRFX0RFQlVHX01BU0tfQ09SRVM7Cj4gPiAg
IAkvKiBUaGUgYmVsb3cgYml0IGRvZXNuJ3QgbmVlZCB0byBiZSBjbGVhcmVkIGV2ZXIgYWZ0ZXJ3
YXJkcyAqLwo+ID4gQEAgLTI1MSwyOSArMjUxLDI5IEBAIHN0YXRpYyB2b2lkIGdlbjlfc2V0X2Rj
X3N0YXRlX2RlYnVnbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAg
IC8qKgo+ID4gICAgKiBpbnRlbF9jc3JfbG9hZF9wcm9ncmFtKCkgLSB3cml0ZSB0aGUgZmlybXdh
cmUgZnJvbSBtZW1vcnkgdG8gcmVnaXN0ZXIuCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRybSBk
ZXZpY2UuCj4gPiArICogQGk5MTU6IGk5MTUgZHJtIGRldmljZS4KPiA+ICAgICoKPiA+ICAgICog
Q1NSIGZpcm13YXJlIGlzIHJlYWQgZnJvbSBhIC5iaW4gZmlsZSBhbmQga2VwdCBpbiBpbnRlcm5h
bCBtZW1vcnkgb25lIHRpbWUuCj4gPiAgICAqIEV2ZXJ5dGltZSBkaXNwbGF5IGNvbWVzIGJhY2sg
ZnJvbSBsb3cgcG93ZXIgc3RhdGUgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgdG8KPiA+ICAgICog
Y29weSB0aGUgZmlybXdhcmUgZnJvbSBpbnRlcm5hbCBtZW1vcnkgdG8gcmVnaXN0ZXJzLgo+ID4g
ICAgKi8KPiA+IC12b2lkIGludGVsX2Nzcl9sb2FkX3Byb2dyYW0oc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfY3NyX2xvYWRfcHJvZ3JhbShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQl1MzIgKnBheWxvYWQgPSBkZXZf
cHJpdi0+Y3NyLmRtY19wYXlsb2FkOwo+ID4gKwl1MzIgKnBheWxvYWQgPSBpOTE1LT5jc3IuZG1j
X3BheWxvYWQ7Cj4gPiAgIAl1MzIgaSwgZndfc2l6ZTsKPiA+IC0JaWYgKCFIQVNfQ1NSKGRldl9w
cml2KSkgewo+ID4gKwlpZiAoIUhBU19DU1IoaTkxNSkpIHsKPiA+ICAgCQlEUk1fRVJST1IoIk5v
IENTUiBzdXBwb3J0IGF2YWlsYWJsZSBmb3IgdGhpcyBwbGF0Zm9ybVxuIik7Cj4gPiAgIAkJcmV0
dXJuOwo+ID4gICAJfQo+ID4gLQlpZiAoIWRldl9wcml2LT5jc3IuZG1jX3BheWxvYWQpIHsKPiA+
ICsJaWYgKCFpOTE1LT5jc3IuZG1jX3BheWxvYWQpIHsKPiA+ICAgCQlEUk1fRVJST1IoIlRyaWVk
IHRvIHByb2dyYW0gQ1NSIHdpdGggZW1wdHkgcGF5bG9hZFxuIik7Cj4gPiAgIAkJcmV0dXJuOwo+
ID4gICAJfQo+ID4gLQlmd19zaXplID0gZGV2X3ByaXYtPmNzci5kbWNfZndfc2l6ZTsKPiA+IC0J
YXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKGRldl9wcml2KTsKPiA+ICsJZndfc2l6ZSA9IGk5MTUt
PmNzci5kbWNfZndfc2l6ZTsKPiA+ICsJYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKGk5MTUpOwo+
ID4gICAJcHJlZW1wdF9kaXNhYmxlKCk7Cj4gPiBAQCAtMjgyLDI0ICsyODIsMjQgQEAgdm9pZCBp
bnRlbF9jc3JfbG9hZF9wcm9ncmFtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgCXByZWVtcHRfZW5hYmxlKCk7Cj4gPiAtCWZvciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+
Y3NyLm1taW9fY291bnQ7IGkrKykgewo+ID4gLQkJSTkxNV9XUklURShkZXZfcHJpdi0+Y3NyLm1t
aW9hZGRyW2ldLAo+ID4gLQkJCSAgIGRldl9wcml2LT5jc3IubW1pb2RhdGFbaV0pOwo+ID4gKwlm
b3IgKGkgPSAwOyBpIDwgaTkxNS0+Y3NyLm1taW9fY291bnQ7IGkrKykgewo+ID4gKwkJSTkxNV9X
UklURShpOTE1LT5jc3IubW1pb2FkZHJbaV0sCj4gPiArCQkJICAgaTkxNS0+Y3NyLm1taW9kYXRh
W2ldKTsKPiA+ICAgCX0KPiA+IC0JZGV2X3ByaXYtPmNzci5kY19zdGF0ZSA9IDA7Cj4gPiArCWk5
MTUtPmNzci5kY19zdGF0ZSA9IDA7Cj4gPiAtCWdlbjlfc2V0X2RjX3N0YXRlX2RlYnVnbWFzayhk
ZXZfcHJpdik7Cj4gPiArCWdlbjlfc2V0X2RjX3N0YXRlX2RlYnVnbWFzayhpOTE1KTsKPiA+ICAg
fQo+ID4gLXN0YXRpYyB1MzIgKnBhcnNlX2Nzcl9mdyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiArc3RhdGljIHUzMiAqcGFyc2VfY3NyX2Z3KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ID4gICAJCQkgY29uc3Qgc3RydWN0IGZpcm13YXJlICpmdykKPiA+ICAg
ewo+ID4gICAJc3RydWN0IGludGVsX2Nzc19oZWFkZXIgKmNzc19oZWFkZXI7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfcGFja2FnZV9oZWFkZXIgKnBhY2thZ2VfaGVhZGVyOwo+ID4gICAJc3RydWN0IGlu
dGVsX2RtY19oZWFkZXIgKmRtY19oZWFkZXI7Cj4gPiAtCXN0cnVjdCBpbnRlbF9jc3IgKmNzciA9
ICZkZXZfcHJpdi0+Y3NyOwo+ID4gLQljb25zdCBzdHJ1Y3Qgc3RlcHBpbmdfaW5mbyAqc2kgPSBp
bnRlbF9nZXRfc3RlcHBpbmdfaW5mbyhkZXZfcHJpdik7Cj4gPiArCXN0cnVjdCBpbnRlbF9jc3Ig
KmNzciA9ICZpOTE1LT5jc3I7Cj4gPiArCWNvbnN0IHN0cnVjdCBzdGVwcGluZ19pbmZvICpzaSA9
IGludGVsX2dldF9zdGVwcGluZ19pbmZvKGk5MTUpOwo+ID4gICAJdTMyIGRtY19vZmZzZXQgPSBD
U1JfREVGQVVMVF9GV19PRkZTRVQsIHJlYWRjb3VudCA9IDAsIG5ieXRlczsKPiA+ICAgCXUzMiBp
Owo+ID4gICAJdTMyICpkbWNfcGF5bG9hZDsKPiA+IEBAIC00MzAsNDggKzQzMCw0OCBAQCBzdGF0
aWMgdTMyICpwYXJzZV9jc3JfZncoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gICAJcmV0dXJuIE5VTEw7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9jc3JfcnVu
dGltZV9wbV9nZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRp
YyB2b2lkIGludGVsX2Nzcl9ydW50aW1lX3BtX2dldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gLQlXQVJOX09OKGRldl9wcml2LT5jc3Iud2FrZXJlZik7Cj4gPiAt
CWRldl9wcml2LT5jc3Iud2FrZXJlZiA9Cj4gPiAtCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChk
ZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0lOSVQpOwo+ID4gKwlXQVJOX09OKGk5MTUtPmNzci53YWtl
cmVmKTsKPiA+ICsJaTkxNS0+Y3NyLndha2VyZWYgPQo+ID4gKwkJaW50ZWxfZGlzcGxheV9wb3dl
cl9nZXQoaTkxNSwgUE9XRVJfRE9NQUlOX0lOSVQpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQg
aW50ZWxfY3NyX3J1bnRpbWVfcG1fcHV0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9jc3JfcnVudGltZV9wbV9wdXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVm
IF9fbWF5YmVfdW51c2VkID0KPiA+IC0JCWZldGNoX2FuZF96ZXJvKCZkZXZfcHJpdi0+Y3NyLndh
a2VyZWYpOwo+ID4gKwkJZmV0Y2hfYW5kX3plcm8oJmk5MTUtPmNzci53YWtlcmVmKTsKPiA+IC0J
aW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9JTklULCB3YWtl
cmVmKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9NQUlOX0lO
SVQsIHdha2VyZWYpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGNzcl9sb2FkX3dvcmtfZm4o
c3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfY3NyICpjc3I7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZmlybXdhcmUg
KmZ3ID0gTlVMTDsKPiA+IC0JZGV2X3ByaXYgPSBjb250YWluZXJfb2Yod29yaywgdHlwZW9mKCpk
ZXZfcHJpdiksIGNzci53b3JrKTsKPiA+IC0JY3NyID0gJmRldl9wcml2LT5jc3I7Cj4gPiArCWk5
MTUgPSBjb250YWluZXJfb2Yod29yaywgdHlwZW9mKCppOTE1KSwgY3NyLndvcmspOwo+ID4gKwlj
c3IgPSAmaTkxNS0+Y3NyOwo+ID4gLQlyZXF1ZXN0X2Zpcm13YXJlKCZmdywgZGV2X3ByaXYtPmNz
ci5md19wYXRoLCAmZGV2X3ByaXYtPmRybS5wZGV2LT5kZXYpOwo+ID4gKwlyZXF1ZXN0X2Zpcm13
YXJlKCZmdywgaTkxNS0+Y3NyLmZ3X3BhdGgsICZpOTE1LT5kcm0ucGRldi0+ZGV2KTsKPiA+ICAg
CWlmIChmdykKPiA+IC0JCWRldl9wcml2LT5jc3IuZG1jX3BheWxvYWQgPSBwYXJzZV9jc3JfZnco
ZGV2X3ByaXYsIGZ3KTsKPiA+ICsJCWk5MTUtPmNzci5kbWNfcGF5bG9hZCA9IHBhcnNlX2Nzcl9m
dyhpOTE1LCBmdyk7Cj4gPiAtCWlmIChkZXZfcHJpdi0+Y3NyLmRtY19wYXlsb2FkKSB7Cj4gPiAt
CQlpbnRlbF9jc3JfbG9hZF9wcm9ncmFtKGRldl9wcml2KTsKPiA+IC0JCWludGVsX2Nzcl9ydW50
aW1lX3BtX3B1dChkZXZfcHJpdik7Cj4gPiArCWlmIChpOTE1LT5jc3IuZG1jX3BheWxvYWQpIHsK
PiA+ICsJCWludGVsX2Nzcl9sb2FkX3Byb2dyYW0oaTkxNSk7Cj4gPiArCQlpbnRlbF9jc3JfcnVu
dGltZV9wbV9wdXQoaTkxNSk7Cj4gPiAgIAkJRFJNX0lORk8oIkZpbmlzaGVkIGxvYWRpbmcgRE1D
IGZpcm13YXJlICVzICh2JXUuJXUpXG4iLAo+ID4gLQkJCSBkZXZfcHJpdi0+Y3NyLmZ3X3BhdGgs
Cj4gPiArCQkJIGk5MTUtPmNzci5md19wYXRoLAo+ID4gICAJCQkgQ1NSX1ZFUlNJT05fTUFKT1Io
Y3NyLT52ZXJzaW9uKSwKPiA+ICAgCQkJIENTUl9WRVJTSU9OX01JTk9SKGNzci0+dmVyc2lvbikp
Owo+ID4gICAJfSBlbHNlIHsKPiA+IC0JCWRldl9ub3RpY2UoZGV2X3ByaXYtPmRybS5kZXYsCj4g
PiArCQlkZXZfbm90aWNlKGk5MTUtPmRybS5kZXYsCj4gPiAgIAkJCSAgICJGYWlsZWQgdG8gbG9h
ZCBETUMgZmlybXdhcmUgJXMuIgo+ID4gICAJCQkgICAiIERpc2FibGluZyBydW50aW1lIHBvd2Vy
IG1hbmFnZW1lbnQuXG4iLAo+ID4gICAJCQkgICBjc3ItPmZ3X3BhdGgpOwo+ID4gLQkJZGV2X25v
dGljZShkZXZfcHJpdi0+ZHJtLmRldiwgIkRNQyBmaXJtd2FyZSBob21lcGFnZTogJXMiLAo+ID4g
KwkJZGV2X25vdGljZShpOTE1LT5kcm0uZGV2LCAiRE1DIGZpcm13YXJlIGhvbWVwYWdlOiAlcyIs
Cj4gPiAgIAkJCSAgIElOVEVMX1VDX0ZJUk1XQVJFX1VSTCk7Cj4gPiAgIAl9Cj4gPiBAQCAtNDgw
LDE4ICs0ODAsMTggQEAgc3RhdGljIHZvaWQgY3NyX2xvYWRfd29ya19mbihzdHJ1Y3Qgd29ya19z
dHJ1Y3QgKndvcmspCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9jc3JfdWNvZGVfaW5pdCgpIC0g
aW5pdGlhbGl6ZSB0aGUgZmlybXdhcmUgbG9hZGluZy4KPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUg
ZHJtIGRldmljZS4KPiA+ICsgKiBAaTkxNTogaTkxNSBkcm0gZGV2aWNlLgo+ID4gICAgKgo+ID4g
ICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhdCB0aGUgdGltZSBvZiBsb2FkaW5nIHRoZSBk
aXNwbGF5IGRyaXZlciB0byByZWFkCj4gPiAgICAqIGZpcm13YXJlIGZyb20gYSAuYmluIGZpbGUg
YW5kIGNvcGllZCBpbnRvIGEgaW50ZXJuYWwgbWVtb3J5Lgo+ID4gICAgKi8KPiA+IC12b2lkIGlu
dGVsX2Nzcl91Y29kZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICt2b2lkIGludGVsX2Nzcl91Y29kZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9jc3IgKmNzciA9ICZkZXZfcHJpdi0+Y3NyOwo+
ID4gKwlzdHJ1Y3QgaW50ZWxfY3NyICpjc3IgPSAmaTkxNS0+Y3NyOwo+ID4gLQlJTklUX1dPUkso
JmRldl9wcml2LT5jc3Iud29yaywgY3NyX2xvYWRfd29ya19mbik7Cj4gPiArCUlOSVRfV09SSygm
aTkxNS0+Y3NyLndvcmssIGNzcl9sb2FkX3dvcmtfZm4pOwo+ID4gLQlpZiAoIUhBU19DU1IoZGV2
X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19DU1IoaTkxNSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJ
LyoKPiA+IEBAIC01MDIsMzIgKzUwMiwzMiBAQCB2b2lkIGludGVsX2Nzcl91Y29kZV9pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIHN1c3BlbmQgYXMgcnVu
dGltZSBzdXNwZW5kICpyZXF1aXJlcyogYSB3b3JraW5nIENTUiBmb3Igd2hhdGV2ZXIKPiA+ICAg
CSAqIHJlYXNvbi4KPiA+ICAgCSAqLwo+ID4gLQlpbnRlbF9jc3JfcnVudGltZV9wbV9nZXQoZGV2
X3ByaXYpOwo+ID4gKwlpbnRlbF9jc3JfcnVudGltZV9wbV9nZXQoaTkxNSk7Cj4gPiAtCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDEyKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0g
MTIpIHsKPiA+ICAgCQkvKiBBbGxvdyB0byBsb2FkIGZ3IHZpYSBwYXJhbWV0ZXIgdXNpbmcgdGhl
IGxhc3Qga25vd24gc2l6ZSAqLwo+ID4gICAJCWNzci0+bWF4X2Z3X3NpemUgPSBHRU4xMl9DU1Jf
TUFYX0ZXX1NJWkU7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCAxMSkpIHsKPiA+
ICsJfSBlbHNlIGlmIChJU19HRU4oaTkxNSwgMTEpKSB7Cj4gPiAgIAkJY3NyLT5md19wYXRoID0g
SUNMX0NTUl9QQVRIOwo+ID4gICAJCWNzci0+cmVxdWlyZWRfdmVyc2lvbiA9IElDTF9DU1JfVkVS
U0lPTl9SRVFVSVJFRDsKPiA+ICAgCQljc3ItPm1heF9md19zaXplID0gSUNMX0NTUl9NQVhfRldf
U0laRTsKPiA+IC0JfSBlbHNlIGlmIChJU19DQU5OT05MQUtFKGRldl9wcml2KSkgewo+ID4gKwl9
IGVsc2UgaWYgKElTX0NBTk5PTkxBS0UoaTkxNSkpIHsKPiA+ICAgCQljc3ItPmZ3X3BhdGggPSBD
TkxfQ1NSX1BBVEg7Cj4gPiAgIAkJY3NyLT5yZXF1aXJlZF92ZXJzaW9uID0gQ05MX0NTUl9WRVJT
SU9OX1JFUVVJUkVEOwo+ID4gICAJCWNzci0+bWF4X2Z3X3NpemUgPSBDTkxfQ1NSX01BWF9GV19T
SVpFOwo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4gPiArCX0g
ZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkgewo+ID4gICAJCWNzci0+ZndfcGF0aCA9IEdM
S19DU1JfUEFUSDsKPiA+ICAgCQljc3ItPnJlcXVpcmVkX3ZlcnNpb24gPSBHTEtfQ1NSX1ZFUlNJ
T05fUkVRVUlSRUQ7Cj4gPiAgIAkJY3NyLT5tYXhfZndfc2l6ZSA9IEdMS19DU1JfTUFYX0ZXX1NJ
WkU7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfS0FCWUxBS0UoZGV2X3ByaXYpIHx8IElTX0NPRkZFRUxB
S0UoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfS0FCWUxBS0UoaTkxNSkgfHwgSVNf
Q09GRkVFTEFLRShpOTE1KSkgewo+ID4gICAJCWNzci0+ZndfcGF0aCA9IEtCTF9DU1JfUEFUSDsK
PiA+ICAgCQljc3ItPnJlcXVpcmVkX3ZlcnNpb24gPSBLQkxfQ1NSX1ZFUlNJT05fUkVRVUlSRUQ7
Cj4gPiAgIAkJY3NyLT5tYXhfZndfc2l6ZSA9IEtCTF9DU1JfTUFYX0ZXX1NJWkU7Cj4gPiAtCX0g
ZWxzZSBpZiAoSVNfU0tZTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19TS1lM
QUtFKGk5MTUpKSB7Cj4gPiAgIAkJY3NyLT5md19wYXRoID0gU0tMX0NTUl9QQVRIOwo+ID4gICAJ
CWNzci0+cmVxdWlyZWRfdmVyc2lvbiA9IFNLTF9DU1JfVkVSU0lPTl9SRVFVSVJFRDsKPiA+ICAg
CQljc3ItPm1heF9md19zaXplID0gU0tMX0NTUl9NQVhfRldfU0laRTsKPiA+IC0JfSBlbHNlIGlm
IChJU19CUk9YVE9OKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0JST1hUT04oaTkx
NSkpIHsKPiA+ICAgCQljc3ItPmZ3X3BhdGggPSBCWFRfQ1NSX1BBVEg7Cj4gPiAgIAkJY3NyLT5y
ZXF1aXJlZF92ZXJzaW9uID0gQlhUX0NTUl9WRVJTSU9OX1JFUVVJUkVEOwo+ID4gICAJCWNzci0+
bWF4X2Z3X3NpemUgPSBCWFRfQ1NSX01BWF9GV19TSVpFOwo+ID4gQEAgLTU1MSw2MyArNTUxLDYz
IEBAIHZvaWQgaW50ZWxfY3NyX3Vjb2RlX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJfQo+ID4gICAJRFJNX0RFQlVHX0tNUygiTG9hZGluZyAlc1xuIiwgY3Ny
LT5md19wYXRoKTsKPiA+IC0Jc2NoZWR1bGVfd29yaygmZGV2X3ByaXYtPmNzci53b3JrKTsKPiA+
ICsJc2NoZWR1bGVfd29yaygmaTkxNS0+Y3NyLndvcmspOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4g
ICAgKiBpbnRlbF9jc3JfdWNvZGVfc3VzcGVuZCgpIC0gcHJlcGFyZSBDU1IgZmlybXdhcmUgYmVm
b3JlIHN5c3RlbSBzdXNwZW5kCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRybSBkZXZpY2UKPiA+
ICsgKiBAaTkxNTogaTkxNSBkcm0gZGV2aWNlCj4gPiAgICAqCj4gPiAgICAqIFByZXBhcmUgdGhl
IERNQyBmaXJtd2FyZSBiZWZvcmUgZW50ZXJpbmcgc3lzdGVtIHN1c3BlbmQuIFRoaXMgaW5jbHVk
ZXMKPiA+ICAgICogZmx1c2hpbmcgcGVuZGluZyB3b3JrIGl0ZW1zIGFuZCByZWxlYXNpbmcgYW55
IHJlc291cmNlcyBhY3F1aXJlZCBkdXJpbmcKPiA+ICAgICogaW5pdC4KPiA+ICAgICovCj4gPiAt
dm9pZCBpbnRlbF9jc3JfdWNvZGVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9jc3JfdWNvZGVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoIUhBU19DU1IoZGV2X3ByaXYpKQo+ID4g
KwlpZiAoIUhBU19DU1IoaTkxNSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlmbHVzaF93b3JrKCZk
ZXZfcHJpdi0+Y3NyLndvcmspOwo+ID4gKwlmbHVzaF93b3JrKCZpOTE1LT5jc3Iud29yayk7Cj4g
PiAgIAkvKiBEcm9wIHRoZSByZWZlcmVuY2UgaGVsZCBpbiBjYXNlIERNQyBpc24ndCBsb2FkZWQu
ICovCj4gPiAtCWlmICghZGV2X3ByaXYtPmNzci5kbWNfcGF5bG9hZCkKPiA+IC0JCWludGVsX2Nz
cl9ydW50aW1lX3BtX3B1dChkZXZfcHJpdik7Cj4gPiArCWlmICghaTkxNS0+Y3NyLmRtY19wYXls
b2FkKQo+ID4gKwkJaW50ZWxfY3NyX3J1bnRpbWVfcG1fcHV0KGk5MTUpOwo+ID4gICB9Cj4gPiAg
IC8qKgo+ID4gICAgKiBpbnRlbF9jc3JfdWNvZGVfcmVzdW1lKCkgLSBpbml0IENTUiBmaXJtd2Fy
ZSBkdXJpbmcgc3lzdGVtIHJlc3VtZQo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkcm0gZGV2aWNl
Cj4gPiArICogQGk5MTU6IGk5MTUgZHJtIGRldmljZQo+ID4gICAgKgo+ID4gICAgKiBSZWluaXRp
YWxpemUgdGhlIERNQyBmaXJtd2FyZSBkdXJpbmcgc3lzdGVtIHJlc3VtZSwgcmVhY3F1aXJpbmcg
YW55Cj4gPiAgICAqIHJlc291cmNlcyByZWxlYXNlZCBpbiBpbnRlbF9jc3JfdWNvZGVfc3VzcGVu
ZCgpLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2Nzcl91Y29kZV9yZXN1bWUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfY3NyX3Vjb2RlX3Jlc3Vt
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoIUhBU19D
U1IoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19DU1IoaTkxNSkpCj4gPiAgIAkJcmV0dXJuOwo+
ID4gICAJLyoKPiA+ICAgCSAqIFJlYWNxdWlyZSB0aGUgcmVmZXJlbmNlIHRvIGtlZXAgUlBNIGRp
c2FibGVkIGluIGNhc2UgRE1DIGlzbid0Cj4gPiAgIAkgKiBsb2FkZWQuCj4gPiAgIAkgKi8KPiA+
IC0JaWYgKCFkZXZfcHJpdi0+Y3NyLmRtY19wYXlsb2FkKQo+ID4gLQkJaW50ZWxfY3NyX3J1bnRp
bWVfcG1fZ2V0KGRldl9wcml2KTsKPiA+ICsJaWYgKCFpOTE1LT5jc3IuZG1jX3BheWxvYWQpCj4g
PiArCQlpbnRlbF9jc3JfcnVudGltZV9wbV9nZXQoaTkxNSk7Cj4gPiAgIH0KPiA+ICAgLyoqCj4g
PiAgICAqIGludGVsX2Nzcl91Y29kZV9maW5pKCkgLSB1bmxvYWQgdGhlIENTUiBmaXJtd2FyZS4K
PiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZHJtIGRldmljZS4KPiA+ICsgKiBAaTkxNTogaTkxNSBk
cm0gZGV2aWNlLgo+ID4gICAgKgo+ID4gICAgKiBGaXJtbXdhcmUgdW5sb2FkaW5nIGluY2x1ZGVz
IGZyZWVpbmcgdGhlIGludGVybmFsIG1lbW9yeSBhbmQgcmVzZXQgdGhlCj4gPiAgICAqIGZpcm13
YXJlIGxvYWRpbmcgc3RhdHVzLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2Nzcl91Y29kZV9m
aW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGludGVsX2Nz
cl91Y29kZV9maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAt
CWlmICghSEFTX0NTUihkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX0NTUihpOTE1KSkKPiA+ICAg
CQlyZXR1cm47Cj4gPiAtCWludGVsX2Nzcl91Y29kZV9zdXNwZW5kKGRldl9wcml2KTsKPiA+IC0J
V0FSTl9PTihkZXZfcHJpdi0+Y3NyLndha2VyZWYpOwo+ID4gKwlpbnRlbF9jc3JfdWNvZGVfc3Vz
cGVuZChpOTE1KTsKPiA+ICsJV0FSTl9PTihpOTE1LT5jc3Iud2FrZXJlZik7Cj4gPiAtCWtmcmVl
KGRldl9wcml2LT5jc3IuZG1jX3BheWxvYWQpOwo+ID4gKwlrZnJlZShpOTE1LT5jc3IuZG1jX3Bh
eWxvYWQpOwo+ID4gICB9Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfZGRpLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kZGkuYwo+ID4gaW5kZXggNzky
NWExNzZmOTAwLi5lYjYxNzMxZjFhYmMgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kZGkuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGRp
LmMKPiA+IEBAIC01ODYsOSArNTg2LDkgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpY2xfbWdfcGh5
X2RkaV9idWZfdHJhbnMgaWNsX21nX3BoeV9kZGlfdHJhbnNsYXRpb25zW10gPSB7Cj4gPiAgIH07
Cj4gPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZGRpX2J1Zl90cmFucyAqCj4gPiAtYmR3X2dldF9i
dWZfdHJhbnNfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50ICpuX2Vu
dHJpZXMpCj4gPiArYmR3X2dldF9idWZfdHJhbnNfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCBpbnQgKm5fZW50cmllcykKPiA+ICAgewo+ID4gLQlpZiAoZGV2X3ByaXYtPnZidC5l
ZHAubG93X3Zzd2luZykgewo+ID4gKwlpZiAoaTkxNS0+dmJ0LmVkcC5sb3dfdnN3aW5nKSB7Cj4g
PiAgIAkJKm5fZW50cmllcyA9IEFSUkFZX1NJWkUoYmR3X2RkaV90cmFuc2xhdGlvbnNfZWRwKTsK
PiA+ICAgCQlyZXR1cm4gYmR3X2RkaV90cmFuc2xhdGlvbnNfZWRwOwo+ID4gICAJfSBlbHNlIHsK
PiA+IEBAIC01OTgsMTIgKzU5OCwxMiBAQCBiZHdfZ2V0X2J1Zl90cmFuc19lZHAoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgKm5fZW50cmllcykKPiA+ICAgfQo+ID4gICBz
dGF0aWMgY29uc3Qgc3RydWN0IGRkaV9idWZfdHJhbnMgKgo+ID4gLXNrbF9nZXRfYnVmX3RyYW5z
X2RwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50ICpuX2VudHJpZXMpCj4g
PiArc2tsX2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGlu
dCAqbl9lbnRyaWVzKQo+ID4gICB7Cj4gPiAtCWlmIChJU19TS0xfVUxYKGRldl9wcml2KSkgewo+
ID4gKwlpZiAoSVNfU0tMX1VMWChpOTE1KSkgewo+ID4gICAJCSpuX2VudHJpZXMgPSBBUlJBWV9T
SVpFKHNrbF95X2RkaV90cmFuc2xhdGlvbnNfZHApOwo+ID4gICAJCXJldHVybiBza2xfeV9kZGlf
dHJhbnNsYXRpb25zX2RwOwo+ID4gLQl9IGVsc2UgaWYgKElTX1NLTF9VTFQoZGV2X3ByaXYpKSB7
Cj4gPiArCX0gZWxzZSBpZiAoSVNfU0tMX1VMVChpOTE1KSkgewo+ID4gICAJCSpuX2VudHJpZXMg
PSBBUlJBWV9TSVpFKHNrbF91X2RkaV90cmFuc2xhdGlvbnNfZHApOwo+ID4gICAJCXJldHVybiBz
a2xfdV9kZGlfdHJhbnNsYXRpb25zX2RwOwo+ID4gICAJfSBlbHNlIHsKPiA+IEBAIC02MTMsMTIg
KzYxMywxMiBAQCBza2xfZ2V0X2J1Zl90cmFuc19kcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIGludCAqbl9lbnRyaWVzKQo+ID4gICB9Cj4gPiAgIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgZGRpX2J1Zl90cmFucyAqCj4gPiAta2JsX2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgKm5fZW50cmllcykKPiA+ICtrYmxfZ2V0X2J1Zl90
cmFuc19kcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50ICpuX2VudHJpZXMpCj4g
PiAgIHsKPiA+IC0JaWYgKElTX0tCTF9VTFgoZGV2X3ByaXYpIHx8IElTX0NGTF9VTFgoZGV2X3By
aXYpKSB7Cj4gPiArCWlmIChJU19LQkxfVUxYKGk5MTUpIHx8IElTX0NGTF9VTFgoaTkxNSkpIHsK
PiA+ICAgCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShrYmxfeV9kZGlfdHJhbnNsYXRpb25zX2Rw
KTsKPiA+ICAgCQlyZXR1cm4ga2JsX3lfZGRpX3RyYW5zbGF0aW9uc19kcDsKPiA+IC0JfSBlbHNl
IGlmIChJU19LQkxfVUxUKGRldl9wcml2KSB8fCBJU19DRkxfVUxUKGRldl9wcml2KSkgewo+ID4g
Kwl9IGVsc2UgaWYgKElTX0tCTF9VTFQoaTkxNSkgfHwgSVNfQ0ZMX1VMVChpOTE1KSkgewo+ID4g
ICAJCSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKGtibF91X2RkaV90cmFuc2xhdGlvbnNfZHApOwo+
ID4gICAJCXJldHVybiBrYmxfdV9kZGlfdHJhbnNsYXRpb25zX2RwOwo+ID4gICAJfSBlbHNlIHsK
PiA+IEBAIC02MjgsMTUgKzYyOCwxNSBAQCBrYmxfZ2V0X2J1Zl90cmFuc19kcChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCAqbl9lbnRyaWVzKQo+ID4gICB9Cj4gPiAgIHN0
YXRpYyBjb25zdCBzdHJ1Y3QgZGRpX2J1Zl90cmFucyAqCj4gPiAtc2tsX2dldF9idWZfdHJhbnNf
ZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50ICpuX2VudHJpZXMpCj4g
PiArc2tsX2dldF9idWZfdHJhbnNfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBp
bnQgKm5fZW50cmllcykKPiA+ICAgewo+ID4gLQlpZiAoZGV2X3ByaXYtPnZidC5lZHAubG93X3Zz
d2luZykgewo+ID4gLQkJaWYgKElTX1NLTF9VTFgoZGV2X3ByaXYpIHx8IElTX0tCTF9VTFgoZGV2
X3ByaXYpIHx8Cj4gPiAtCQkgICAgSVNfQ0ZMX1VMWChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKGk5
MTUtPnZidC5lZHAubG93X3Zzd2luZykgewo+ID4gKwkJaWYgKElTX1NLTF9VTFgoaTkxNSkgfHwg
SVNfS0JMX1VMWChpOTE1KSB8fAo+ID4gKwkJICAgIElTX0NGTF9VTFgoaTkxNSkpIHsKPiA+ICAg
CQkJKm5fZW50cmllcyA9IEFSUkFZX1NJWkUoc2tsX3lfZGRpX3RyYW5zbGF0aW9uc19lZHApOwo+
ID4gICAJCQlyZXR1cm4gc2tsX3lfZGRpX3RyYW5zbGF0aW9uc19lZHA7Cj4gPiAtCQl9IGVsc2Ug
aWYgKElTX1NLTF9VTFQoZGV2X3ByaXYpIHx8IElTX0tCTF9VTFQoZGV2X3ByaXYpIHx8Cj4gPiAt
CQkJICAgSVNfQ0ZMX1VMVChkZXZfcHJpdikpIHsKPiA+ICsJCX0gZWxzZSBpZiAoSVNfU0tMX1VM
VChpOTE1KSB8fCBJU19LQkxfVUxUKGk5MTUpIHx8Cj4gPiArCQkJICAgSVNfQ0ZMX1VMVChpOTE1
KSkgewo+ID4gICAJCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShza2xfdV9kZGlfdHJhbnNsYXRp
b25zX2VkcCk7Cj4gPiAgIAkJCXJldHVybiBza2xfdV9kZGlfdHJhbnNsYXRpb25zX2VkcDsKPiA+
ICAgCQl9IGVsc2Ugewo+ID4gQEAgLTY0NSwxNyArNjQ1LDE3IEBAIHNrbF9nZXRfYnVmX3RyYW5z
X2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCAqbl9lbnRyaWVzKQo+
ID4gICAJCX0KPiA+ICAgCX0KPiA+IC0JaWYgKElTX0tBQllMQUtFKGRldl9wcml2KSB8fCBJU19D
T0ZGRUVMQUtFKGRldl9wcml2KSkKPiA+IC0JCXJldHVybiBrYmxfZ2V0X2J1Zl90cmFuc19kcChk
ZXZfcHJpdiwgbl9lbnRyaWVzKTsKPiA+ICsJaWYgKElTX0tBQllMQUtFKGk5MTUpIHx8IElTX0NP
RkZFRUxBS0UoaTkxNSkpCj4gPiArCQlyZXR1cm4ga2JsX2dldF9idWZfdHJhbnNfZHAoaTkxNSwg
bl9lbnRyaWVzKTsKPiA+ICAgCWVsc2UKPiA+IC0JCXJldHVybiBza2xfZ2V0X2J1Zl90cmFuc19k
cChkZXZfcHJpdiwgbl9lbnRyaWVzKTsKPiA+ICsJCXJldHVybiBza2xfZ2V0X2J1Zl90cmFuc19k
cChpOTE1LCBuX2VudHJpZXMpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZGRp
X2J1Zl90cmFucyAqCj4gPiAtc2tsX2dldF9idWZfdHJhbnNfaGRtaShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIGludCAqbl9lbnRyaWVzKQo+ID4gK3NrbF9nZXRfYnVmX3RyYW5z
X2hkbWkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCAqbl9lbnRyaWVzKQo+ID4g
ICB7Cj4gPiAtCWlmIChJU19TS0xfVUxYKGRldl9wcml2KSB8fCBJU19LQkxfVUxYKGRldl9wcml2
KSB8fAo+ID4gLQkgICAgSVNfQ0ZMX1VMWChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX1NLTF9V
TFgoaTkxNSkgfHwgSVNfS0JMX1VMWChpOTE1KSB8fAo+ID4gKwkgICAgSVNfQ0ZMX1VMWChpOTE1
KSkgewo+ID4gICAJCSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKHNrbF95X2RkaV90cmFuc2xhdGlv
bnNfaGRtaSk7Cj4gPiAgIAkJcmV0dXJuIHNrbF95X2RkaV90cmFuc2xhdGlvbnNfaGRtaTsKPiA+
ICAgCX0gZWxzZSB7Cj4gPiBAQCAtNjc0LDIzICs2NzQsMjMgQEAgc3RhdGljIGludCBza2xfYnVm
X3RyYW5zX251bV9lbnRyaWVzKGVudW0gcG9ydCBwb3J0LCBpbnQgbl9lbnRyaWVzKQo+ID4gICB9
Cj4gPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZGRpX2J1Zl90cmFucyAqCj4gPiAtaW50ZWxfZGRp
X2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
K2ludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2RwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ID4gICAJCQkgICBlbnVtIHBvcnQgcG9ydCwgaW50ICpuX2VudHJpZXMpCj4gPiAgIHsKPiA+
IC0JaWYgKElTX0tBQllMQUtFKGRldl9wcml2KSB8fCBJU19DT0ZGRUVMQUtFKGRldl9wcml2KSkg
ewo+ID4gKwlpZiAoSVNfS0FCWUxBS0UoaTkxNSkgfHwgSVNfQ09GRkVFTEFLRShpOTE1KSkgewo+
ID4gICAJCWNvbnN0IHN0cnVjdCBkZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNsYXRpb25zID0KPiA+
IC0JCQlrYmxfZ2V0X2J1Zl90cmFuc19kcChkZXZfcHJpdiwgbl9lbnRyaWVzKTsKPiA+ICsJCQlr
YmxfZ2V0X2J1Zl90cmFuc19kcChpOTE1LCBuX2VudHJpZXMpOwo+ID4gICAJCSpuX2VudHJpZXMg
PSBza2xfYnVmX3RyYW5zX251bV9lbnRyaWVzKHBvcnQsICpuX2VudHJpZXMpOwo+ID4gICAJCXJl
dHVybiBkZGlfdHJhbnNsYXRpb25zOwo+ID4gLQl9IGVsc2UgaWYgKElTX1NLWUxBS0UoZGV2X3By
aXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfU0tZTEFLRShpOTE1KSkgewo+ID4gICAJCWNvbnN0
IHN0cnVjdCBkZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNsYXRpb25zID0KPiA+IC0JCQlza2xfZ2V0
X2J1Zl90cmFuc19kcChkZXZfcHJpdiwgbl9lbnRyaWVzKTsKPiA+ICsJCQlza2xfZ2V0X2J1Zl90
cmFuc19kcChpOTE1LCBuX2VudHJpZXMpOwo+ID4gICAJCSpuX2VudHJpZXMgPSBza2xfYnVmX3Ry
YW5zX251bV9lbnRyaWVzKHBvcnQsICpuX2VudHJpZXMpOwo+ID4gICAJCXJldHVybiBkZGlfdHJh
bnNsYXRpb25zOwo+ID4gLQl9IGVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiA+
ICsJfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiA+ICAgCQkqbl9lbnRyaWVzID0g
QVJSQVlfU0laRShiZHdfZGRpX3RyYW5zbGF0aW9uc19kcCk7Cj4gPiAgIAkJcmV0dXJuICBiZHdf
ZGRpX3RyYW5zbGF0aW9uc19kcDsKPiA+IC0JfSBlbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2
KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0hBU1dFTEwoaTkxNSkpIHsKPiA+ICAgCQkqbl9lbnRy
aWVzID0gQVJSQVlfU0laRShoc3dfZGRpX3RyYW5zbGF0aW9uc19kcCk7Cj4gPiAgIAkJcmV0dXJu
IGhzd19kZGlfdHJhbnNsYXRpb25zX2RwOwo+ID4gICAJfQo+ID4gQEAgLTcwMCwxNyArNzAwLDE3
IEBAIGludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2RwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgfQo+ID4gICBzdGF0aWMgY29uc3Qgc3RydWN0IGRkaV9idWZfdHJhbnMg
Kgo+ID4gLWludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiAraW50ZWxfZGRpX2dldF9idWZfdHJhbnNfZWRwKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgZW51bSBwb3J0IHBvcnQsIGludCAqbl9l
bnRyaWVzKQo+ID4gICB7Cj4gPiAtCWlmIChJU19HRU45X0JDKGRldl9wcml2KSkgewo+ID4gKwlp
ZiAoSVNfR0VOOV9CQyhpOTE1KSkgewo+ID4gICAJCWNvbnN0IHN0cnVjdCBkZGlfYnVmX3RyYW5z
ICpkZGlfdHJhbnNsYXRpb25zID0KPiA+IC0JCQlza2xfZ2V0X2J1Zl90cmFuc19lZHAoZGV2X3By
aXYsIG5fZW50cmllcyk7Cj4gPiArCQkJc2tsX2dldF9idWZfdHJhbnNfZWRwKGk5MTUsIG5fZW50
cmllcyk7Cj4gPiAgIAkJKm5fZW50cmllcyA9IHNrbF9idWZfdHJhbnNfbnVtX2VudHJpZXMocG9y
dCwgKm5fZW50cmllcyk7Cj4gPiAgIAkJcmV0dXJuIGRkaV90cmFuc2xhdGlvbnM7Cj4gPiAtCX0g
ZWxzZSBpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ID4gLQkJcmV0dXJuIGJkd19nZXRf
YnVmX3RyYW5zX2VkcChkZXZfcHJpdiwgbl9lbnRyaWVzKTsKPiA+IC0JfSBlbHNlIGlmIChJU19I
QVNXRUxMKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0JST0FEV0VMTChpOTE1KSkg
ewo+ID4gKwkJcmV0dXJuIGJkd19nZXRfYnVmX3RyYW5zX2VkcChpOTE1LCBuX2VudHJpZXMpOwo+
ID4gKwl9IGVsc2UgaWYgKElTX0hBU1dFTEwoaTkxNSkpIHsKPiA+ICAgCQkqbl9lbnRyaWVzID0g
QVJSQVlfU0laRShoc3dfZGRpX3RyYW5zbGF0aW9uc19kcCk7Cj4gPiAgIAkJcmV0dXJuIGhzd19k
ZGlfdHJhbnNsYXRpb25zX2RwOwo+ID4gICAJfQo+ID4gQEAgLTcyMCwxMyArNzIwLDEzIEBAIGlu
dGVsX2RkaV9nZXRfYnVmX3RyYW5zX2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAgIH0KPiA+ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBkZGlfYnVmX3RyYW5zICoKPiA+
IC1pbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19mZGkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gK2ludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2ZkaShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgIGludCAqbl9lbnRyaWVzKQo+ID4gICB7Cj4gPiAt
CWlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19CUk9BRFdFTEwoaTkx
NSkpIHsKPiA+ICAgCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShiZHdfZGRpX3RyYW5zbGF0aW9u
c19mZGkpOwo+ID4gICAJCXJldHVybiBiZHdfZGRpX3RyYW5zbGF0aW9uc19mZGk7Cj4gPiAtCX0g
ZWxzZSBpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19IQVNX
RUxMKGk5MTUpKSB7Cj4gPiAgIAkJKm5fZW50cmllcyA9IEFSUkFZX1NJWkUoaHN3X2RkaV90cmFu
c2xhdGlvbnNfZmRpKTsKPiA+ICAgCQlyZXR1cm4gaHN3X2RkaV90cmFuc2xhdGlvbnNfZmRpOwo+
ID4gICAJfQo+ID4gQEAgLTczNiwxNSArNzM2LDE1IEBAIGludGVsX2RkaV9nZXRfYnVmX3RyYW5z
X2ZkaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIH0KPiA+ICAgc3Rh
dGljIGNvbnN0IHN0cnVjdCBkZGlfYnVmX3RyYW5zICoKPiA+IC1pbnRlbF9kZGlfZ2V0X2J1Zl90
cmFuc19oZG1pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpbnRlbF9k
ZGlfZ2V0X2J1Zl90cmFuc19oZG1pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4g
ICAJCQkgICAgIGludCAqbl9lbnRyaWVzKQo+ID4gICB7Cj4gPiAtCWlmIChJU19HRU45X0JDKGRl
dl9wcml2KSkgewo+ID4gLQkJcmV0dXJuIHNrbF9nZXRfYnVmX3RyYW5zX2hkbWkoZGV2X3ByaXYs
IG5fZW50cmllcyk7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+
ID4gKwlpZiAoSVNfR0VOOV9CQyhpOTE1KSkgewo+ID4gKwkJcmV0dXJuIHNrbF9nZXRfYnVmX3Ry
YW5zX2hkbWkoaTkxNSwgbl9lbnRyaWVzKTsKPiA+ICsJfSBlbHNlIGlmIChJU19CUk9BRFdFTEwo
aTkxNSkpIHsKPiA+ICAgCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShiZHdfZGRpX3RyYW5zbGF0
aW9uc19oZG1pKTsKPiA+ICAgCQlyZXR1cm4gYmR3X2RkaV90cmFuc2xhdGlvbnNfaGRtaTsKPiA+
IC0JfSBlbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElT
X0hBU1dFTEwoaTkxNSkpIHsKPiA+ICAgCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShoc3dfZGRp
X3RyYW5zbGF0aW9uc19oZG1pKTsKPiA+ICAgCQlyZXR1cm4gaHN3X2RkaV90cmFuc2xhdGlvbnNf
aGRtaTsKPiA+ICAgCX0KPiA+IEBAIC03NTQsMzIgKzc1NCwzMiBAQCBpbnRlbF9kZGlfZ2V0X2J1
Zl90cmFuc19oZG1pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgfQo+
ID4gICBzdGF0aWMgY29uc3Qgc3RydWN0IGJ4dF9kZGlfYnVmX3RyYW5zICoKPiA+IC1ieHRfZ2V0
X2J1Zl90cmFuc19kcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCAqbl9l
bnRyaWVzKQo+ID4gK2J4dF9nZXRfYnVmX3RyYW5zX2RwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCBpbnQgKm5fZW50cmllcykKPiA+ICAgewo+ID4gICAJKm5fZW50cmllcyA9IEFSUkFZ
X1NJWkUoYnh0X2RkaV90cmFuc2xhdGlvbnNfZHApOwo+ID4gICAJcmV0dXJuIGJ4dF9kZGlfdHJh
bnNsYXRpb25zX2RwOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgYnh0X2RkaV9i
dWZfdHJhbnMgKgo+ID4gLWJ4dF9nZXRfYnVmX3RyYW5zX2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIGludCAqbl9lbnRyaWVzKQo+ID4gK2J4dF9nZXRfYnVmX3RyYW5zX2Vk
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50ICpuX2VudHJpZXMpCj4gPiAgIHsK
PiA+IC0JaWYgKGRldl9wcml2LT52YnQuZWRwLmxvd192c3dpbmcpIHsKPiA+ICsJaWYgKGk5MTUt
PnZidC5lZHAubG93X3Zzd2luZykgewo+ID4gICAJCSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKGJ4
dF9kZGlfdHJhbnNsYXRpb25zX2VkcCk7Cj4gPiAgIAkJcmV0dXJuIGJ4dF9kZGlfdHJhbnNsYXRp
b25zX2VkcDsKPiA+ICAgCX0KPiA+IC0JcmV0dXJuIGJ4dF9nZXRfYnVmX3RyYW5zX2RwKGRldl9w
cml2LCBuX2VudHJpZXMpOwo+ID4gKwlyZXR1cm4gYnh0X2dldF9idWZfdHJhbnNfZHAoaTkxNSwg
bl9lbnRyaWVzKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgY29uc3Qgc3RydWN0IGJ4dF9kZGlfYnVm
X3RyYW5zICoKPiA+IC1ieHRfZ2V0X2J1Zl90cmFuc19oZG1pKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgaW50ICpuX2VudHJpZXMpCj4gPiArYnh0X2dldF9idWZfdHJhbnNfaGRt
aShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50ICpuX2VudHJpZXMpCj4gPiAgIHsK
PiA+ICAgCSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKGJ4dF9kZGlfdHJhbnNsYXRpb25zX2hkbWkp
Owo+ID4gICAJcmV0dXJuIGJ4dF9kZGlfdHJhbnNsYXRpb25zX2hkbWk7Cj4gPiAgIH0KPiA+ICAg
c3RhdGljIGNvbnN0IHN0cnVjdCBjbmxfZGRpX2J1Zl90cmFucyAqCj4gPiAtY25sX2dldF9idWZf
dHJhbnNfaGRtaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCAqbl9lbnRy
aWVzKQo+ID4gK2NubF9nZXRfYnVmX3RyYW5zX2hkbWkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsIGludCAqbl9lbnRyaWVzKQo+ID4gICB7Cj4gPiAgIAl1MzIgdm9sdGFnZSA9IEk5MTVf
UkVBRChDTkxfUE9SVF9DT01QX0RXMykgJiBWT0xUQUdFX0lORk9fTUFTSzsKPiA+IEBAIC04MDAs
NyArODAwLDcgQEAgY25sX2dldF9idWZfdHJhbnNfaGRtaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIGludCAqbl9lbnRyaWVzKQo+ID4gICB9Cj4gPiAgIHN0YXRpYyBjb25zdCBz
dHJ1Y3QgY25sX2RkaV9idWZfdHJhbnMgKgo+ID4gLWNubF9nZXRfYnVmX3RyYW5zX2RwKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50ICpuX2VudHJpZXMpCj4gPiArY25sX2dl
dF9idWZfdHJhbnNfZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCAqbl9lbnRy
aWVzKQo+ID4gICB7Cj4gPiAgIAl1MzIgdm9sdGFnZSA9IEk5MTVfUkVBRChDTkxfUE9SVF9DT01Q
X0RXMykgJiBWT0xUQUdFX0lORk9fTUFTSzsKPiA+IEBAIC04MjEsMTEgKzgyMSwxMSBAQCBjbmxf
Z2V0X2J1Zl90cmFuc19kcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCAq
bl9lbnRyaWVzKQo+ID4gICB9Cj4gPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY25sX2RkaV9idWZf
dHJhbnMgKgo+ID4gLWNubF9nZXRfYnVmX3RyYW5zX2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIGludCAqbl9lbnRyaWVzKQo+ID4gK2NubF9nZXRfYnVmX3RyYW5zX2VkcChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50ICpuX2VudHJpZXMpCj4gPiAgIHsKPiA+
ICAgCXUzMiB2b2x0YWdlID0gSTkxNV9SRUFEKENOTF9QT1JUX0NPTVBfRFczKSAmIFZPTFRBR0Vf
SU5GT19NQVNLOwo+ID4gLQlpZiAoZGV2X3ByaXYtPnZidC5lZHAubG93X3Zzd2luZykgewo+ID4g
KwlpZiAoaTkxNS0+dmJ0LmVkcC5sb3dfdnN3aW5nKSB7Cj4gPiAgIAkJaWYgKHZvbHRhZ2UgPT0g
Vk9MVEFHRV9JTkZPXzBfODVWKSB7Cj4gPiAgIAkJCSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKGNu
bF9kZGlfdHJhbnNsYXRpb25zX2VkcF8wXzg1Vik7Cj4gPiAgIAkJCXJldHVybiBjbmxfZGRpX3Ry
YW5zbGF0aW9uc19lZHBfMF84NVY7Cj4gPiBAQCAtODQxLDEyICs4NDEsMTIgQEAgY25sX2dldF9i
dWZfdHJhbnNfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50ICpuX2Vu
dHJpZXMpCj4gPiAgIAkJfQo+ID4gICAJCXJldHVybiBOVUxMOwo+ID4gICAJfSBlbHNlIHsKPiA+
IC0JCXJldHVybiBjbmxfZ2V0X2J1Zl90cmFuc19kcChkZXZfcHJpdiwgbl9lbnRyaWVzKTsKPiA+
ICsJCXJldHVybiBjbmxfZ2V0X2J1Zl90cmFuc19kcChpOTE1LCBuX2VudHJpZXMpOwo+ID4gICAJ
fQo+ID4gICB9Cj4gPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY25sX2RkaV9idWZfdHJhbnMgKgo+
ID4gLWljbF9nZXRfY29tYm9fYnVmX3RyYW5zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgZW51bSBwb3J0IHBvcnQsCj4gPiAraWNsX2dldF9jb21ib19idWZfdHJhbnMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcG9ydCBwb3J0LAo+ID4gICAJCQlpbnQgdHlw
ZSwgaW50IHJhdGUsIGludCAqbl9lbnRyaWVzKQo+ID4gICB7Cj4gPiAgIAlpZiAodHlwZSA9PSBJ
TlRFTF9PVVRQVVRfSERNSSkgewo+ID4gQEAgLTg1NSw3ICs4NTUsNyBAQCBpY2xfZ2V0X2NvbWJv
X2J1Zl90cmFucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBw
b3J0LAo+ID4gICAJfSBlbHNlIGlmIChyYXRlID4gNTQwMDAwICYmIHR5cGUgPT0gSU5URUxfT1VU
UFVUX0VEUCkgewo+ID4gICAJCSpuX2VudHJpZXMgPSBBUlJBWV9TSVpFKGljbF9jb21ib19waHlf
ZGRpX3RyYW5zbGF0aW9uc19lZHBfaGJyMyk7Cj4gPiAgIAkJcmV0dXJuIGljbF9jb21ib19waHlf
ZGRpX3RyYW5zbGF0aW9uc19lZHBfaGJyMzsKPiA+IC0JfSBlbHNlIGlmICh0eXBlID09IElOVEVM
X09VVFBVVF9FRFAgJiYgZGV2X3ByaXYtPnZidC5lZHAubG93X3Zzd2luZykgewo+ID4gKwl9IGVs
c2UgaWYgKHR5cGUgPT0gSU5URUxfT1VUUFVUX0VEUCAmJiBpOTE1LT52YnQuZWRwLmxvd192c3dp
bmcpIHsKPiA+ICAgCQkqbl9lbnRyaWVzID0gQVJSQVlfU0laRShpY2xfY29tYm9fcGh5X2RkaV90
cmFuc2xhdGlvbnNfZWRwX2hicjIpOwo+ID4gICAJCXJldHVybiBpY2xfY29tYm9fcGh5X2RkaV90
cmFuc2xhdGlvbnNfZWRwX2hicjI7Cj4gPiAgIAl9Cj4gPiBAQCAtODY0LDMzICs4NjQsMzMgQEAg
aWNsX2dldF9jb21ib19idWZfdHJhbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBlbnVtIHBvcnQgcG9ydCwKPiA+ICAgCXJldHVybiBpY2xfY29tYm9fcGh5X2RkaV90cmFuc2xh
dGlvbnNfZHBfaGJyMjsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQgaW50ZWxfZGRpX2hkbWlfbGV2
ZWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCkKPiA+
ICtzdGF0aWMgaW50IGludGVsX2RkaV9oZG1pX2xldmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+ID4gICAJaW50IG5fZW50cmllcywgbGV2
ZWwsIGRlZmF1bHRfZW50cnk7Cj4gPiAtCWxldmVsID0gZGV2X3ByaXYtPnZidC5kZGlfcG9ydF9p
bmZvW3BvcnRdLmhkbWlfbGV2ZWxfc2hpZnQ7Cj4gPiArCWxldmVsID0gaTkxNS0+dmJ0LmRkaV9w
b3J0X2luZm9bcG9ydF0uaGRtaV9sZXZlbF9zaGlmdDsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPj0gMTEpIHsKPiA+IC0JCWlmIChpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KGRldl9wcml2
LCBwb3J0KSkKPiA+IC0JCQlpY2xfZ2V0X2NvbWJvX2J1Zl90cmFucyhkZXZfcHJpdiwgcG9ydCwg
SU5URUxfT1VUUFVUX0hETUksCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiA+
ICsJCWlmIChpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KGk5MTUsIHBvcnQpKQo+ID4gKwkJCWljbF9n
ZXRfY29tYm9fYnVmX3RyYW5zKGk5MTUsIHBvcnQsIElOVEVMX09VVFBVVF9IRE1JLAo+ID4gICAJ
CQkJCQkwLCAmbl9lbnRyaWVzKTsKPiA+ICAgCQllbHNlCj4gPiAgIAkJCW5fZW50cmllcyA9IEFS
UkFZX1NJWkUoaWNsX21nX3BoeV9kZGlfdHJhbnNsYXRpb25zKTsKPiA+ICAgCQlkZWZhdWx0X2Vu
dHJ5ID0gbl9lbnRyaWVzIC0gMTsKPiA+IC0JfSBlbHNlIGlmIChJU19DQU5OT05MQUtFKGRldl9w
cml2KSkgewo+ID4gLQkJY25sX2dldF9idWZfdHJhbnNfaGRtaShkZXZfcHJpdiwgJm5fZW50cmll
cyk7Cj4gPiArCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkgewo+ID4gKwkJY25sX2dl
dF9idWZfdHJhbnNfaGRtaShpOTE1LCAmbl9lbnRyaWVzKTsKPiA+ICAgCQlkZWZhdWx0X2VudHJ5
ID0gbl9lbnRyaWVzIC0gMTsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkg
ewo+ID4gLQkJYnh0X2dldF9idWZfdHJhbnNfaGRtaShkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4g
PiArCX0gZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkgewo+ID4gKwkJYnh0X2dldF9idWZfdHJh
bnNfaGRtaShpOTE1LCAmbl9lbnRyaWVzKTsKPiA+ICAgCQlkZWZhdWx0X2VudHJ5ID0gbl9lbnRy
aWVzIC0gMTsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2KSkgewo+ID4gLQkJ
aW50ZWxfZGRpX2dldF9idWZfdHJhbnNfaGRtaShkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4gPiAr
CX0gZWxzZSBpZiAoSVNfR0VOOV9CQyhpOTE1KSkgewo+ID4gKwkJaW50ZWxfZGRpX2dldF9idWZf
dHJhbnNfaGRtaShpOTE1LCAmbl9lbnRyaWVzKTsKPiA+ICAgCQlkZWZhdWx0X2VudHJ5ID0gODsK
PiA+IC0JfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Cj4gPiAtCQlpbnRlbF9k
ZGlfZ2V0X2J1Zl90cmFuc19oZG1pKGRldl9wcml2LCAmbl9lbnRyaWVzKTsKPiA+ICsJfSBlbHNl
IGlmIChJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiA+ICsJCWludGVsX2RkaV9nZXRfYnVmX3RyYW5z
X2hkbWkoaTkxNSwgJm5fZW50cmllcyk7Cj4gPiAgIAkJZGVmYXVsdF9lbnRyeSA9IDc7Cj4gPiAt
CX0gZWxzZSBpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikpIHsKPiA+IC0JCWludGVsX2RkaV9nZXRf
YnVmX3RyYW5zX2hkbWkoZGV2X3ByaXYsICZuX2VudHJpZXMpOwo+ID4gKwl9IGVsc2UgaWYgKElT
X0hBU1dFTEwoaTkxNSkpIHsKPiA+ICsJCWludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2hkbWkoaTkx
NSwgJm5fZW50cmllcyk7Cj4gPiAgIAkJZGVmYXVsdF9lbnRyeSA9IDY7Cj4gPiAgIAl9IGVsc2Ug
ewo+ID4gICAJCVdBUk4oMSwgImRkaSB0cmFuc2xhdGlvbiB0YWJsZSBtaXNzaW5nXG4iKTsKPiA+
IEBAIC05MTcsMjUgKzkxNywyNSBAQCBzdGF0aWMgaW50IGludGVsX2RkaV9oZG1pX2xldmVsKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcgo+ID4gICBzdGF0
aWMgdm9pZCBpbnRlbF9wcmVwYXJlX2RwX2RkaV9idWZmZXJzKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ID4gICAJCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXUzMiBpYm9vc3Rf
Yml0ID0gMDsKPiA+ICAgCWludCBpLCBuX2VudHJpZXM7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9
IGVuY29kZXItPnBvcnQ7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZGRpX2J1Zl90cmFucyAqZGRpX3Ry
YW5zbGF0aW9uczsKPiA+ICAgCWlmIChpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElO
VEVMX09VVFBVVF9BTkFMT0cpKQo+ID4gLQkJZGRpX3RyYW5zbGF0aW9ucyA9IGludGVsX2RkaV9n
ZXRfYnVmX3RyYW5zX2ZkaShkZXZfcHJpdiwKPiA+ICsJCWRkaV90cmFuc2xhdGlvbnMgPSBpbnRl
bF9kZGlfZ2V0X2J1Zl90cmFuc19mZGkoaTkxNSwKPiA+ICAgCQkJCQkJCSAgICAgICAmbl9lbnRy
aWVzKTsKPiA+ICAgCWVsc2UgaWYgKGludGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5U
RUxfT1VUUFVUX0VEUCkpCj4gPiAtCQlkZGlfdHJhbnNsYXRpb25zID0gaW50ZWxfZGRpX2dldF9i
dWZfdHJhbnNfZWRwKGRldl9wcml2LCBwb3J0LAo+ID4gKwkJZGRpX3RyYW5zbGF0aW9ucyA9IGlu
dGVsX2RkaV9nZXRfYnVmX3RyYW5zX2VkcChpOTE1LCBwb3J0LAo+ID4gICAJCQkJCQkJICAgICAg
ICZuX2VudHJpZXMpOwo+ID4gICAJZWxzZQo+ID4gLQkJZGRpX3RyYW5zbGF0aW9ucyA9IGludGVs
X2RkaV9nZXRfYnVmX3RyYW5zX2RwKGRldl9wcml2LCBwb3J0LAo+ID4gKwkJZGRpX3RyYW5zbGF0
aW9ucyA9IGludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2RwKGk5MTUsIHBvcnQsCj4gPiAgIAkJCQkJ
CQkgICAgICAmbl9lbnRyaWVzKTsKPiA+ICAgCS8qIElmIHdlJ3JlIGJvb3N0aW5nIHRoZSBjdXJy
ZW50LCBzZXQgYml0IDMxIG9mIHRyYW5zMSAqLwo+ID4gLQlpZiAoSVNfR0VOOV9CQyhkZXZfcHJp
dikgJiYKPiA+IC0JICAgIGRldl9wcml2LT52YnQuZGRpX3BvcnRfaW5mb1twb3J0XS5kcF9ib29z
dF9sZXZlbCkKPiA+ICsJaWYgKElTX0dFTjlfQkMoaTkxNSkgJiYKPiA+ICsJICAgIGk5MTUtPnZi
dC5kZGlfcG9ydF9pbmZvW3BvcnRdLmRwX2Jvb3N0X2xldmVsKQo+ID4gICAJCWlib29zdF9iaXQg
PSBERElfQlVGX0JBTEFOQ0VfTEVHX0VOQUJMRTsKPiA+ICAgCWZvciAoaSA9IDA7IGkgPCBuX2Vu
dHJpZXM7IGkrKykgewo+ID4gQEAgLTk1NCwxMyArOTU0LDEzIEBAIHN0YXRpYyB2b2lkIGludGVs
X3ByZXBhcmVfZHBfZGRpX2J1ZmZlcnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
PiAgIHN0YXRpYyB2b2lkIGludGVsX3ByZXBhcmVfaGRtaV9kZGlfYnVmZmVycyhzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCQkgICBpbnQgbGV2ZWwpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAl1MzIgaWJvb3N0X2JpdCA9IDA7Cj4gPiAgIAlpbnQg
bl9lbnRyaWVzOwo+ID4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ID4gICAJ
Y29uc3Qgc3RydWN0IGRkaV9idWZfdHJhbnMgKmRkaV90cmFuc2xhdGlvbnM7Cj4gPiAtCWRkaV90
cmFuc2xhdGlvbnMgPSBpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19oZG1pKGRldl9wcml2LCAmbl9l
bnRyaWVzKTsKPiA+ICsJZGRpX3RyYW5zbGF0aW9ucyA9IGludGVsX2RkaV9nZXRfYnVmX3RyYW5z
X2hkbWkoaTkxNSwgJm5fZW50cmllcyk7Cj4gPiAgIAlpZiAoV0FSTl9PTl9PTkNFKCFkZGlfdHJh
bnNsYXRpb25zKSkKPiA+ICAgCQlyZXR1cm47Cj4gPiBAQCAtOTY4LDggKzk2OCw4IEBAIHN0YXRp
YyB2b2lkIGludGVsX3ByZXBhcmVfaGRtaV9kZGlfYnVmZmVycyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiA+ICAgCQlsZXZlbCA9IG5fZW50cmllcyAtIDE7Cj4gPiAgIAkvKiBJZiB3
ZSdyZSBib29zdGluZyB0aGUgY3VycmVudCwgc2V0IGJpdCAzMSBvZiB0cmFuczEgKi8KPiA+IC0J
aWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpICYmCj4gPiAtCSAgICBkZXZfcHJpdi0+dmJ0LmRkaV9w
b3J0X2luZm9bcG9ydF0uaGRtaV9ib29zdF9sZXZlbCkKPiA+ICsJaWYgKElTX0dFTjlfQkMoaTkx
NSkgJiYKPiA+ICsJICAgIGk5MTUtPnZidC5kZGlfcG9ydF9pbmZvW3BvcnRdLmhkbWlfYm9vc3Rf
bGV2ZWwpCj4gPiAgIAkJaWJvb3N0X2JpdCA9IERESV9CVUZfQkFMQU5DRV9MRUdfRU5BQkxFOwo+
ID4gICAJLyogRW50cnkgOSBpcyBmb3IgSERNSTogKi8KPiA+IEBAIC05NzksNyArOTc5LDcgQEAg
c3RhdGljIHZvaWQgaW50ZWxfcHJlcGFyZV9oZG1pX2RkaV9idWZmZXJzKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ID4gICAJCSAgIGRkaV90cmFuc2xhdGlvbnNbbGV2ZWxdLnRyYW5z
Mik7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF93YWl0X2RkaV9idWZfaWRsZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaW50ZWxfd2Fp
dF9kZGlfYnVmX2lkbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkg
ICAgZW51bSBwb3J0IHBvcnQpCj4gPiAgIHsKPiA+ICAgCWk5MTVfcmVnX3QgcmVnID0gRERJX0JV
Rl9DVEwocG9ydCk7Cj4gPiBAQCAtMTA2NCw3ICsxMDY0LDcgQEAgdm9pZCBoc3dfZmRpX2xpbmtf
dHJhaW4oc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCWNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsK
PiA+ICAgCXUzMiB0ZW1wLCBpLCByeF9jdGxfdmFsLCBkZGlfcGxsX3NlbDsKPiA+IEBAIC0xMDg1
LDcgKzEwODUsNyBAQCB2b2lkIGhzd19mZGlfbGlua190cmFpbihzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKPiA+ICAgCQkJCSAgRkRJX1JYX1RQMV9UT19UUDJfNDggfCBGRElfUlhfRkRJX0RFTEFZ
XzkwKTsKPiA+ICAgCS8qIEVuYWJsZSB0aGUgUENIIFJlY2VpdmVyIEZESSBQTEwgKi8KPiA+IC0J
cnhfY3RsX3ZhbCA9IGRldl9wcml2LT5mZGlfcnhfY29uZmlnIHwgRkRJX1JYX0VOSEFOQ0VfRlJB
TUVfRU5BQkxFIHwKPiA+ICsJcnhfY3RsX3ZhbCA9IGk5MTUtPmZkaV9yeF9jb25maWcgfCBGRElf
UlhfRU5IQU5DRV9GUkFNRV9FTkFCTEUgfAo+ID4gICAJCSAgICAgRkRJX1JYX1BMTF9FTkFCTEUg
fAo+ID4gICAJCSAgICAgRkRJX0RQX1BPUlRfV0lEVEgoY3J0Y19zdGF0ZS0+ZmRpX2xhbmVzKTsK
PiA+ICAgCUk5MTVfV1JJVEUoRkRJX1JYX0NUTChQSVBFX0EpLCByeF9jdGxfdmFsKTsKPiA+IEBA
IC0xMTc0LDcgKzExNzQsNyBAQCB2b2lkIGhzd19mZGlfbGlua190cmFpbihzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiA+ICAgCQlJOTE1X1dSSVRFKERQX1RQX0NUTChQT1JUX0UpLCB0ZW1wKTsK
PiA+ICAgCQlQT1NUSU5HX1JFQUQoRFBfVFBfQ1RMKFBPUlRfRSkpOwo+ID4gLQkJaW50ZWxfd2Fp
dF9kZGlfYnVmX2lkbGUoZGV2X3ByaXYsIFBPUlRfRSk7Cj4gPiArCQlpbnRlbF93YWl0X2RkaV9i
dWZfaWRsZShpOTE1LCBQT1JUX0UpOwo+ID4gICAJCS8qIFJlc2V0IEZESV9SWF9NSVNDIHB3cmRu
IGxhbmVzICovCj4gPiAgIAkJdGVtcCA9IEk5MTVfUkVBRChGRElfUlhfTUlTQyhQSVBFX0EpKTsK
PiA+IEBAIC0xMjIzLDcgKzEyMjMsNyBAQCBpbnRlbF9kZGlfZ2V0X2NydGNfZW5jb2RlcihzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgaW50IGhzd19kZGlfY2FsY193cnBsbF9saW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW50IGhzd19kZGlfY2FsY193cnBsbF9saW5rKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgaTkxNV9yZWdfdCByZWcpCj4gPiAg
IHsKPiA+ICAgCWludCByZWZjbGs7Cj4gPiBAQCAtMTIzOCw3ICsxMjM4LDcgQEAgc3RhdGljIGlu
dCBoc3dfZGRpX2NhbGNfd3JwbGxfbGluayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAgIAkJICogbm9uLVNTQyBmb3Igbm9uLVVMVCBIU1cuIENoZWNrIEZVU0VfU1RSQVAz
Cj4gPiAgIAkJICogZm9yIHRoZSBub24tU1NDIHJlZmVyZW5jZSBmcmVxdWVuY3kuCj4gPiAgIAkJ
ICovCj4gPiAtCQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgIUlTX0hTV19VTFQoZGV2X3By
aXYpKSB7Cj4gPiArCQlpZiAoSVNfSEFTV0VMTChpOTE1KSAmJiAhSVNfSFNXX1VMVChpOTE1KSkg
ewo+ID4gICAJCQlpZiAoSTkxNV9SRUFEKEZVU0VfU1RSQVAzKSAmIEhTV19SRUZfQ0xLX1NFTEVD
VCkKPiA+ICAgCQkJCXJlZmNsayA9IDI0Owo+ID4gICAJCQllbHNlCj4gPiBAQCAtMTMyNSw3ICsx
MzI1LDcgQEAgc3RhdGljIGludCBza2xfY2FsY193cnBsbF9saW5rKGNvbnN0IHN0cnVjdCBpbnRl
bF9kcGxsX2h3X3N0YXRlICpwbGxfc3RhdGUpCj4gPiAgIAlyZXR1cm4gZGNvX2ZyZXEgLyAocDAg
KiBwMSAqIHAyICogNSk7Cj4gPiAgIH0KPiA+IC1pbnQgY25sX2NhbGNfd3JwbGxfbGluayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAraW50IGNubF9jYWxjX3dycGxsX2xp
bmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCXN0cnVjdCBpbnRlbF9k
cGxsX2h3X3N0YXRlICpwbGxfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXUzMiBwMCwgcDEsIHAyLCBk
Y29fZnJlcSwgcmVmX2Nsb2NrOwo+ID4gQEAgLTEzNjcsNyArMTM2Nyw3IEBAIGludCBjbmxfY2Fs
Y193cnBsbF9saW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQli
cmVhazsKPiA+ICAgCX0KPiA+IC0JcmVmX2Nsb2NrID0gY25sX2hkbWlfcGxsX3JlZl9jbG9jayhk
ZXZfcHJpdik7Cj4gPiArCXJlZl9jbG9jayA9IGNubF9oZG1pX3BsbF9yZWZfY2xvY2soaTkxNSk7
Cj4gPiAgIAlkY29fZnJlcSA9IChwbGxfc3RhdGUtPmNmZ2NyMCAmIERQTExfQ0ZHQ1IwX0RDT19J
TlRFR0VSX01BU0spCj4gPiAgIAkJKiByZWZfY2xvY2s7Cj4gPiBAQCAtMTM4MSw3ICsxMzgxLDcg
QEAgaW50IGNubF9jYWxjX3dycGxsX2xpbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gICAJcmV0dXJuIGRjb19mcmVxIC8gKHAwICogcDEgKiBwMiAqIDUpOwo+ID4gICB9
Cj4gPiAtc3RhdGljIGludCBpY2xfY2FsY190YnRfcGxsX2xpbmsoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBpbnQgaWNsX2NhbGNfdGJ0X3BsbF9saW5rKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJIGVudW0gcG9ydCBwb3J0KQo+
ID4gICB7Cj4gPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKERESV9DTEtfU0VMKHBvcnQpKSAmIERE
SV9DTEtfU0VMX01BU0s7Cj4gPiBAQCAtMTQwMywxMyArMTQwMywxMyBAQCBzdGF0aWMgaW50IGlj
bF9jYWxjX3RidF9wbGxfbGluayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IGljbF9jYWxjX21nX3BsbF9saW5rKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW50IGljbF9jYWxjX21n
X3BsbF9saW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJY29uc3Qg
c3RydWN0IGludGVsX2RwbGxfaHdfc3RhdGUgKnBsbF9zdGF0ZSkKPiA+ICAgewo+ID4gICAJdTMy
IG0xLCBtMl9pbnQsIG0yX2ZyYWMsIGRpdjEsIGRpdjIsIHJlZl9jbG9jazsKPiA+ICAgCXU2NCB0
bXA7Cj4gPiAtCXJlZl9jbG9jayA9IGRldl9wcml2LT5jZGNsay5ody5yZWY7Cj4gPiArCXJlZl9j
bG9jayA9IGk5MTUtPmNkY2xrLmh3LnJlZjsKPiA+ICAgCW0xID0gcGxsX3N0YXRlLT5tZ19wbGxf
ZGl2MSAmIE1HX1BMTF9ESVYxX0ZCUFJFRElWX01BU0s7Cj4gPiAgIAltMl9pbnQgPSBwbGxfc3Rh
dGUtPm1nX3BsbF9kaXYwICYgTUdfUExMX0RJVjBfRkJESVZfSU5UX01BU0s7Cj4gPiBAQCAtMTQ4
MywyMSArMTQ4MywyMSBAQCBzdGF0aWMgdm9pZCBkZGlfZG90Y2xvY2tfZ2V0KHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgc3RhdGljIHZvaWQgaWNsX2RkaV9jbG9j
a19nZXQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgICAgIHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2Uu
ZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpwbGxfc3RhdGUgPSAmcGlw
ZV9jb25maWctPmRwbGxfaHdfc3RhdGU7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXIt
PnBvcnQ7Cj4gPiAgIAlpbnQgbGlua19jbG9jazsKPiA+IC0JaWYgKGludGVsX3BvcnRfaXNfY29t
Ym9waHkoZGV2X3ByaXYsIHBvcnQpKSB7Cj4gPiAtCQlsaW5rX2Nsb2NrID0gY25sX2NhbGNfd3Jw
bGxfbGluayhkZXZfcHJpdiwgcGxsX3N0YXRlKTsKPiA+ICsJaWYgKGludGVsX3BvcnRfaXNfY29t
Ym9waHkoaTkxNSwgcG9ydCkpIHsKPiA+ICsJCWxpbmtfY2xvY2sgPSBjbmxfY2FsY193cnBsbF9s
aW5rKGk5MTUsIHBsbF9zdGF0ZSk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gLQkJZW51bSBpbnRlbF9k
cGxsX2lkIHBsbF9pZCA9IGludGVsX2dldF9zaGFyZWRfZHBsbF9pZChkZXZfcHJpdiwKPiA+ICsJ
CWVudW0gaW50ZWxfZHBsbF9pZCBwbGxfaWQgPSBpbnRlbF9nZXRfc2hhcmVkX2RwbGxfaWQoaTkx
NSwKPiA+ICAgCQkJCQkJcGlwZV9jb25maWctPnNoYXJlZF9kcGxsKTsKPiA+ICAgCQlpZiAocGxs
X2lkID09IERQTExfSURfSUNMX1RCVFBMTCkKPiA+IC0JCQlsaW5rX2Nsb2NrID0gaWNsX2NhbGNf
dGJ0X3BsbF9saW5rKGRldl9wcml2LCBwb3J0KTsKPiA+ICsJCQlsaW5rX2Nsb2NrID0gaWNsX2Nh
bGNfdGJ0X3BsbF9saW5rKGk5MTUsIHBvcnQpOwo+ID4gICAJCWVsc2UKPiA+IC0JCQlsaW5rX2Ns
b2NrID0gaWNsX2NhbGNfbWdfcGxsX2xpbmsoZGV2X3ByaXYsIHBsbF9zdGF0ZSk7Cj4gPiArCQkJ
bGlua19jbG9jayA9IGljbF9jYWxjX21nX3BsbF9saW5rKGk5MTUsIHBsbF9zdGF0ZSk7Cj4gPiAg
IAl9Cj4gPiAgIAlwaXBlX2NvbmZpZy0+cG9ydF9jbG9jayA9IGxpbmtfY2xvY2s7Cj4gPiBAQCAt
MTUwOCwxMiArMTUwOCwxMiBAQCBzdGF0aWMgdm9pZCBpY2xfZGRpX2Nsb2NrX2dldChzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIHZvaWQgY25sX2RkaV9jbG9ja19n
ZXQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgICAgIHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpwbGxfc3RhdGUgPSAmcGlwZV9j
b25maWctPmRwbGxfaHdfc3RhdGU7Cj4gPiAgIAlpbnQgbGlua19jbG9jazsKPiA+ICAgCWlmIChw
bGxfc3RhdGUtPmNmZ2NyMCAmIERQTExfQ0ZHQ1IwX0hETUlfTU9ERSkgewo+ID4gLQkJbGlua19j
bG9jayA9IGNubF9jYWxjX3dycGxsX2xpbmsoZGV2X3ByaXYsIHBsbF9zdGF0ZSk7Cj4gPiArCQls
aW5rX2Nsb2NrID0gY25sX2NhbGNfd3JwbGxfbGluayhpOTE1LCBwbGxfc3RhdGUpOwo+ID4gICAJ
fSBlbHNlIHsKPiA+ICAgCQlsaW5rX2Nsb2NrID0gcGxsX3N0YXRlLT5jZmdjcjAgJiBEUExMX0NG
R0NSMF9MSU5LX1JBVEVfTUFTSzsKPiA+IEBAIC0xNjA0LDcgKzE2MDQsNyBAQCBzdGF0aWMgdm9p
ZCBza2xfZGRpX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAg
c3RhdGljIHZvaWQgaHN3X2RkaV9jbG9ja19nZXQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gPiAgIAkJCSAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWludCBsaW5rX2Nsb2NrID0gMDsK
PiA+ICAgCXUzMiB2YWwsIHBsbDsKPiA+IEBAIC0xNjIwLDEwICsxNjIwLDEwIEBAIHN0YXRpYyB2
b2lkIGhzd19kZGlfY2xvY2tfZ2V0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4g
ICAJCWxpbmtfY2xvY2sgPSAyNzAwMDA7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIFBPUlRf
Q0xLX1NFTF9XUlBMTDE6Cj4gPiAtCQlsaW5rX2Nsb2NrID0gaHN3X2RkaV9jYWxjX3dycGxsX2xp
bmsoZGV2X3ByaXYsIFdSUExMX0NUTCgwKSk7Cj4gPiArCQlsaW5rX2Nsb2NrID0gaHN3X2RkaV9j
YWxjX3dycGxsX2xpbmsoaTkxNSwgV1JQTExfQ1RMKDApKTsKPiA+ICAgCQlicmVhazsKPiA+ICAg
CWNhc2UgUE9SVF9DTEtfU0VMX1dSUExMMjoKPiA+IC0JCWxpbmtfY2xvY2sgPSBoc3dfZGRpX2Nh
bGNfd3JwbGxfbGluayhkZXZfcHJpdiwgV1JQTExfQ1RMKDEpKTsKPiA+ICsJCWxpbmtfY2xvY2sg
PSBoc3dfZGRpX2NhbGNfd3JwbGxfbGluayhpOTE1LCBXUlBMTF9DVEwoMSkpOwo+ID4gICAJCWJy
ZWFrOwo+ID4gICAJY2FzZSBQT1JUX0NMS19TRUxfU1BMTDoKPiA+ICAgCQlwbGwgPSBJOTE1X1JF
QUQoU1BMTF9DVEwpICYgU1BMTF9GUkVRX01BU0s7Cj4gPiBAQCAtMTY3NSwyNCArMTY3NSwyNCBA
QCBzdGF0aWMgdm9pZCBieHRfZGRpX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBl
X2NvbmZpZykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+IC0JaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gMTEpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gPiAg
IAkJaWNsX2RkaV9jbG9ja19nZXQoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ID4gLQllbHNlIGlm
IChJU19DQU5OT05MQUtFKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShp
OTE1KSkKPiA+ICAgCQljbmxfZGRpX2Nsb2NrX2dldChlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4g
PiAtCWVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19HRU45
X0xQKGk5MTUpKQo+ID4gICAJCWJ4dF9kZGlfY2xvY2tfZ2V0KGVuY29kZXIsIHBpcGVfY29uZmln
KTsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElT
X0dFTjlfQkMoaTkxNSkpCj4gPiAgIAkJc2tsX2RkaV9jbG9ja19nZXQoZW5jb2RlciwgcGlwZV9j
b25maWcpOwo+ID4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDgpCj4gPiArCWVs
c2UgaWYgKElOVEVMX0dFTihpOTE1KSA8PSA4KQo+ID4gICAJCWhzd19kZGlfY2xvY2tfZ2V0KGVu
Y29kZXIsIHBpcGVfY29uZmlnKTsKPiA+ICAgfQo+ID4gICB2b2lkIGludGVsX2RkaV9zZXRfcGlw
ZV9zZXR0aW5ncyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+
ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSB0cmFuc2NvZGVy
IGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gPiAgIAl1MzIg
dGVtcDsKPiA+IEBAIC0xNzQ2LDcgKzE3NDYsNyBAQCB2b2lkIGludGVsX2RkaV9zZXRfdmNfcGF5
bG9hZF9hbGxvYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+
ICAgCQkJCSAgICBib29sIHN0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Cj4gPiAgIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5j
cHVfdHJhbnNjb2RlcjsKPiA+ICAgCXUzMiB0ZW1wOwo+ID4gQEAgLTE3NjIsNyArMTc2Miw3IEBA
IHZvaWQgaW50ZWxfZGRpX2VuYWJsZV90cmFuc2NvZGVyX2Z1bmMoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gICAJc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIgPSBpbnRlbF9kZGlfZ2V0X2NydGNfZW5jb2Rlcihj
cnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7
Cj4gPiAgIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVf
dHJhbnNjb2RlcjsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiA+IEBA
IC0xODQ1LDcgKzE4NDUsNyBAQCB2b2lkIGludGVsX2RkaV9lbmFibGVfdHJhbnNjb2Rlcl9mdW5j
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB2b2lkIGlu
dGVsX2RkaV9kaXNhYmxlX3RyYW5zY29kZXJfZnVuYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ID4gICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3Ry
YW5zY29kZXI7Cj4gPiAgIAlpOTE1X3JlZ190IHJlZyA9IFRSQU5TX0RESV9GVU5DX0NUTChjcHVf
dHJhbnNjb2Rlcik7Cj4gPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4gPiBAQCAtMTg1
NCw3ICsxODU0LDcgQEAgdm9pZCBpbnRlbF9kZGlfZGlzYWJsZV90cmFuc2NvZGVyX2Z1bmMoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUKPiA+ICAgCXZhbCB8PSBUUkFO
U19ERElfUE9SVF9OT05FOwo+ID4gICAJSTkxNV9XUklURShyZWcsIHZhbCk7Cj4gPiAtCWlmIChk
ZXZfcHJpdi0+cXVpcmtzICYgUVVJUktfSU5DUkVBU0VfRERJX0RJU0FCTEVEX1RJTUUgJiYKPiA+
ICsJaWYgKGk5MTUtPnF1aXJrcyAmIFFVSVJLX0lOQ1JFQVNFX0RESV9ESVNBQkxFRF9USU1FICYm
Cj4gPiAgIAkgICAgaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRf
SERNSSkpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJRdWlyayBJbmNyZWFzZSBEREkgZGlzYWJs
ZWQgdGltZVxuIik7Cj4gPiAgIAkJLyogUXVpcmsgdGltZSBhdCAxMDBtcyBmb3IgcmVsaWFibGUg
b3BlcmF0aW9uICovCj4gPiBAQCAtMTg2NiwxMyArMTg2NiwxMyBAQCBpbnQgaW50ZWxfZGRpX3Rv
Z2dsZV9oZGNwX3NpZ25hbGxpbmcoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIs
Cj4gPiAgIAkJCQkgICAgIGJvb2wgZW5hYmxlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gaW50ZWxfZW5jb2Rlci0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2Fr
ZXJlZjsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gMDsKPiA+ICAgCWludCByZXQgPSAwOwo+ID4g
ICAJdTMyIHRtcDsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2Vu
YWJsZWQoZGV2X3ByaXYsCj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9p
Zl9lbmFibGVkKGk5MTUsCj4gPiAgIAkJCQkJCSAgICAgaW50ZWxfZW5jb2Rlci0+cG93ZXJfZG9t
YWluKTsKPiA+ICAgCWlmIChXQVJOX09OKCF3YWtlcmVmKSkKPiA+ICAgCQlyZXR1cm4gLUVOWElP
Owo+ID4gQEAgLTE4ODksMTQgKzE4ODksMTQgQEAgaW50IGludGVsX2RkaV90b2dnbGVfaGRjcF9z
aWduYWxsaW5nKHN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+ID4gICAJCXRt
cCAmPSB+VFJBTlNfRERJX0hEQ1BfU0lHTkFMTElORzsKPiA+ICAgCUk5MTVfV1JJVEUoVFJBTlNf
RERJX0ZVTkNfQ1RMKHBpcGUpLCB0bXApOwo+ID4gICBvdXQ6Cj4gPiAtCWludGVsX2Rpc3BsYXlf
cG93ZXJfcHV0KGRldl9wcml2LCBpbnRlbF9lbmNvZGVyLT5wb3dlcl9kb21haW4sIHdha2VyZWYp
Owo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBpbnRlbF9lbmNvZGVyLT5wb3dl
cl9kb21haW4sIHdha2VyZWYpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gICBib29s
IGludGVsX2RkaV9jb25uZWN0b3JfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmludGVsX2Nvbm5lY3RvcikKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9
IGludGVsX2Nvbm5lY3Rvci0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciA9IGludGVsX2Nvbm5lY3Rvci0+ZW5jb2RlcjsKPiA+ICAgCWludCB0eXBlID0gaW50ZWxfY29u
bmVjdG9yLT5iYXNlLmNvbm5lY3Rvcl90eXBlOwo+ID4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNv
ZGVyLT5wb3J0Owo+ID4gQEAgLTE5MDYsNyArMTkwNiw3IEBAIGJvb2wgaW50ZWxfZGRpX2Nvbm5l
Y3Rvcl9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9y
KQo+ID4gICAJdTMyIHRtcDsKPiA+ICAgCWJvb2wgcmV0Owo+ID4gLQl3YWtlcmVmID0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwKPiA+ICsJd2FrZXJlZiA9IGlu
dGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoaTkxNSwKPiA+ICAgCQkJCQkJICAgICBl
bmNvZGVyLT5wb3dlcl9kb21haW4pOwo+ID4gICAJaWYgKCF3YWtlcmVmKQo+ID4gICAJCXJldHVy
biBmYWxzZTsKPiA+IEBAIC0xOTE2LDcgKzE5MTYsNyBAQCBib29sIGludGVsX2RkaV9jb25uZWN0
b3JfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvcikK
PiA+ICAgCQlnb3RvIG91dDsKPiA+ICAgCX0KPiA+IC0JaWYgKEhBU19UUkFOU0NPREVSX0VEUChk
ZXZfcHJpdikgJiYgcG9ydCA9PSBQT1JUX0EpCj4gPiArCWlmIChIQVNfVFJBTlNDT0RFUl9FRFAo
aTkxNSkgJiYgcG9ydCA9PSBQT1JUX0EpCj4gPiAgIAkJY3B1X3RyYW5zY29kZXIgPSBUUkFOU0NP
REVSX0VEUDsKPiA+ICAgCWVsc2UKPiA+ICAgCQljcHVfdHJhbnNjb2RlciA9IChlbnVtIHRyYW5z
Y29kZXIpIHBpcGU7Cj4gPiBAQCAtMTk1MCw3ICsxOTUwLDcgQEAgYm9vbCBpbnRlbF9kZGlfY29u
bmVjdG9yX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICppbnRlbF9jb25uZWN0
b3IpCj4gPiAgIAl9Cj4gPiAgIG91dDoKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2
X3ByaXYsIGVuY29kZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiArCWludGVsX2Rpc3Bs
YXlfcG93ZXJfcHV0KGk5MTUsIGVuY29kZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiAg
IAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtMTk1OSw3ICsxOTU5LDcgQEAgc3RhdGljIHZv
aWQgaW50ZWxfZGRpX2dldF9lbmNvZGVyX3BpcGVzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAo+ID4gICAJCQkJCXU4ICpwaXBlX21hc2ssIGJvb2wgKmlzX2RwX21zdCkKPiA+ICAgewo+
ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJZW51bSBw
b3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7
Cj4gPiAgIAllbnVtIHBpcGUgcDsKPiA+IEBAIC0xOTY5LDcgKzE5NjksNyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9kZGlfZ2V0X2VuY29kZXJfcGlwZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gPiAgIAkqcGlwZV9tYXNrID0gMDsKPiA+ICAgCSppc19kcF9tc3QgPSBmYWxzZTsKPiA+
IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYs
Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUs
Cj4gPiAgIAkJCQkJCSAgICAgZW5jb2Rlci0+cG93ZXJfZG9tYWluKTsKPiA+ICAgCWlmICghd2Fr
ZXJlZikKPiA+ICAgCQlyZXR1cm47Cj4gPiBAQCAtMTk3OCw3ICsxOTc4LDcgQEAgc3RhdGljIHZv
aWQgaW50ZWxfZGRpX2dldF9lbmNvZGVyX3BpcGVzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAo+ID4gICAJaWYgKCEodG1wICYgRERJX0JVRl9DVExfRU5BQkxFKSkKPiA+ICAgCQlnb3Rv
IG91dDsKPiA+IC0JaWYgKEhBU19UUkFOU0NPREVSX0VEUChkZXZfcHJpdikgJiYgcG9ydCA9PSBQ
T1JUX0EpIHsKPiA+ICsJaWYgKEhBU19UUkFOU0NPREVSX0VEUChpOTE1KSAmJiBwb3J0ID09IFBP
UlRfQSkgewo+ID4gICAJCXRtcCA9IEk5MTVfUkVBRChUUkFOU19ERElfRlVOQ19DVEwoVFJBTlND
T0RFUl9FRFApKTsKPiA+ICAgCQlzd2l0Y2ggKHRtcCAmIFRSQU5TX0RESV9FRFBfSU5QVVRfTUFT
Sykgewo+ID4gQEAgLTIwMDEsNyArMjAwMSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9nZXRf
ZW5jb2Rlcl9waXBlcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCX0KPiA+
ICAgCW1zdF9waXBlX21hc2sgPSAwOwo+ID4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwKSB7
Cj4gPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcCkgewo+ID4gICAJCWVudW0gdHJhbnNjb2RlciBj
cHVfdHJhbnNjb2RlciA9IChlbnVtIHRyYW5zY29kZXIpcDsKPiA+ICAgCQl0bXAgPSBJOTE1X1JF
QUQoVFJBTlNfRERJX0ZVTkNfQ1RMKGNwdV90cmFuc2NvZGVyKSk7Cj4gPiBAQCAtMjAzMyw3ICsy
MDMzLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX2dldF9lbmNvZGVyX3BpcGVzKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCSppc19kcF9tc3QgPSBtc3RfcGlwZV9tYXNr
Owo+ID4gICBvdXQ6Cj4gPiAtCWlmICgqcGlwZV9tYXNrICYmIElTX0dFTjlfTFAoZGV2X3ByaXYp
KSB7Cj4gPiArCWlmICgqcGlwZV9tYXNrICYmIElTX0dFTjlfTFAoaTkxNSkpIHsKPiA+ICAgCQl0
bXAgPSBJOTE1X1JFQUQoQlhUX1BIWV9DVEwocG9ydCkpOwo+ID4gICAJCWlmICgodG1wICYgKEJY
VF9QSFlfQ01OTEFORV9QT1dFUkRPV05fQUNLIHwKPiA+ICAgCQkJICAgIEJYVF9QSFlfTEFORV9Q
T1dFUkRPV05fQUNLIHwKPiA+IEBAIC0yMDQyLDcgKzIwNDIsNyBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9kZGlfZ2V0X2VuY29kZXJfcGlwZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
PiAgIAkJCQkgICIoUEhZX0NUTCAlMDh4KVxuIiwgcG9ydF9uYW1lKHBvcnQpLCB0bXApOwo+ID4g
ICAJfQo+ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgZW5jb2Rlci0+cG93
ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwg
ZW5jb2Rlci0+cG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiA+ICAgfQo+ID4gICBib29sIGludGVs
X2RkaV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiBAQCAt
MjA4Myw3ICsyMDgzLDcgQEAgaW50ZWxfZGRpX21haW5fbGlua19hdXhfZG9tYWluKHN0cnVjdCBp
bnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9kZGlf
Z2V0X3Bvd2VyX2RvbWFpbnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJ
CQkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydDsK
PiA+ICAgCS8qCj4gPiBAQCAtMjA5NSwyOSArMjA5NSwyOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9k
ZGlfZ2V0X3Bvd2VyX2RvbWFpbnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAg
IAkJcmV0dXJuOwo+ID4gICAJZGlnX3BvcnQgPSBlbmNfdG9fZGlnX3BvcnQoJmVuY29kZXItPmJh
c2UpOwo+ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwgZGlnX3BvcnQtPmRk
aV9pb19wb3dlcl9kb21haW4pOwo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBk
aWdfcG9ydC0+ZGRpX2lvX3Bvd2VyX2RvbWFpbik7Cj4gPiAgIAkvKgo+ID4gICAJICogQVVYIHBv
d2VyIGlzIG9ubHkgbmVlZGVkIGZvciAoZSlEUCBtb2RlLCBhbmQgZm9yIEhETUkgbW9kZSBvbiBU
Qwo+ID4gICAJICogcG9ydHMuCj4gPiAgIAkgKi8KPiA+ICAgCWlmIChpbnRlbF9jcnRjX2hhc19k
cF9lbmNvZGVyKGNydGNfc3RhdGUpIHx8Cj4gPiAtCSAgICBpbnRlbF9wb3J0X2lzX3RjKGRldl9w
cml2LCBlbmNvZGVyLT5wb3J0KSkKPiA+IC0JCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9w
cml2LAo+ID4gKwkgICAgaW50ZWxfcG9ydF9pc190YyhpOTE1LCBlbmNvZGVyLT5wb3J0KSkKPiA+
ICsJCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5MTUsCj4gPiAgIAkJCQkJaW50ZWxfZGRpX21h
aW5fbGlua19hdXhfZG9tYWluKGRpZ19wb3J0KSk7Cj4gPiAgIAkvKgo+ID4gICAJICogVkRTQyBw
b3dlciBpcyBuZWVkZWQgd2hlbiBEU0MgaXMgZW5hYmxlZAo+ID4gICAJICovCj4gPiAgIAlpZiAo
Y3J0Y19zdGF0ZS0+ZHNjX3BhcmFtcy5jb21wcmVzc2lvbl9lbmFibGUpCj4gPiAtCQlpbnRlbF9k
aXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwKPiA+ICsJCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0
KGk5MTUsCj4gPiAgIAkJCQkJaW50ZWxfZHNjX3Bvd2VyX2RvbWFpbihjcnRjX3N0YXRlKSk7Cj4g
PiAgIH0KPiA+ICAgdm9pZCBpbnRlbF9kZGlfZW5hYmxlX3BpcGVfY2xvY2soY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyID0gaW50ZWxf
ZGRpX2dldF9jcnRjX2VuY29kZXIoY3J0Yyk7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29k
ZXItPnBvcnQ7Cj4gPiAgIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0
YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiA+IEBAIC0yMTI5LDcgKzIxMjksNyBAQCB2b2lkIGludGVs
X2RkaV9lbmFibGVfcGlwZV9jbG9jayhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiA+ICAgdm9pZCBpbnRlbF9kZGlfZGlzYWJsZV9waXBlX2Nsb2NrKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRj
LT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFu
c2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gPiAgIAlpZiAoY3B1X3RyYW5z
Y29kZXIgIT0gVFJBTlNDT0RFUl9FRFApCj4gPiBAQCAtMjEzNyw3ICsyMTM3LDcgQEAgdm9pZCBp
bnRlbF9kZGlfZGlzYWJsZV9waXBlX2Nsb2NrKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKQo+ID4gICAJCQkgICBUUkFOU19DTEtfU0VMX0RJU0FCTEVEKTsKPiA+ICAg
fQo+ID4gLXN0YXRpYyB2b2lkIF9za2xfZGRpX3NldF9pYm9vc3Qoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIF9za2xfZGRpX3NldF9pYm9vc3Qoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQllbnVtIHBvcnQgcG9ydCwgdTgg
aWJvb3N0KQo+ID4gICB7Cj4gPiAgIAl1MzIgdG1wOwo+ID4gQEAgLTIxNTUsMjUgKzIxNTUsMjUg
QEAgc3RhdGljIHZvaWQgc2tsX2RkaV9zZXRfaWJvb3N0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ID4gICAJCQkgICAgICAgaW50IGxldmVsLCBlbnVtIGludGVsX291dHB1dF90eXBl
IHR5cGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2Rp
Z19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gPiAgIAl1OCBp
Ym9vc3Q7Cj4gPiAgIAlpZiAodHlwZSA9PSBJTlRFTF9PVVRQVVRfSERNSSkKPiA+IC0JCWlib29z
dCA9IGRldl9wcml2LT52YnQuZGRpX3BvcnRfaW5mb1twb3J0XS5oZG1pX2Jvb3N0X2xldmVsOwo+
ID4gKwkJaWJvb3N0ID0gaTkxNS0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF0uaGRtaV9ib29zdF9s
ZXZlbDsKPiA+ICAgCWVsc2UKPiA+IC0JCWlib29zdCA9IGRldl9wcml2LT52YnQuZGRpX3BvcnRf
aW5mb1twb3J0XS5kcF9ib29zdF9sZXZlbDsKPiA+ICsJCWlib29zdCA9IGk5MTUtPnZidC5kZGlf
cG9ydF9pbmZvW3BvcnRdLmRwX2Jvb3N0X2xldmVsOwo+ID4gICAJaWYgKGlib29zdCA9PSAwKSB7
Cj4gPiAgIAkJY29uc3Qgc3RydWN0IGRkaV9idWZfdHJhbnMgKmRkaV90cmFuc2xhdGlvbnM7Cj4g
PiAgIAkJaW50IG5fZW50cmllczsKPiA+ICAgCQlpZiAodHlwZSA9PSBJTlRFTF9PVVRQVVRfSERN
SSkKPiA+IC0JCQlkZGlfdHJhbnNsYXRpb25zID0gaW50ZWxfZGRpX2dldF9idWZfdHJhbnNfaGRt
aShkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4gPiArCQkJZGRpX3RyYW5zbGF0aW9ucyA9IGludGVs
X2RkaV9nZXRfYnVmX3RyYW5zX2hkbWkoaTkxNSwgJm5fZW50cmllcyk7Cj4gPiAgIAkJZWxzZSBp
ZiAodHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQKQo+ID4gLQkJCWRkaV90cmFuc2xhdGlvbnMgPSBp
bnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19lZHAoZGV2X3ByaXYsIHBvcnQsICZuX2VudHJpZXMpOwo+
ID4gKwkJCWRkaV90cmFuc2xhdGlvbnMgPSBpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19lZHAoaTkx
NSwgcG9ydCwgJm5fZW50cmllcyk7Cj4gPiAgIAkJZWxzZQo+ID4gLQkJCWRkaV90cmFuc2xhdGlv
bnMgPSBpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19kcChkZXZfcHJpdiwgcG9ydCwgJm5fZW50cmll
cyk7Cj4gPiArCQkJZGRpX3RyYW5zbGF0aW9ucyA9IGludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2Rw
KGk5MTUsIHBvcnQsICZuX2VudHJpZXMpOwo+ID4gICAJCWlmIChXQVJOX09OX09OQ0UoIWRkaV90
cmFuc2xhdGlvbnMpKQo+ID4gICAJCQlyZXR1cm47Cj4gPiBAQCAtMjE4OSwzMyArMjE4OSwzMyBA
QCBzdGF0aWMgdm9pZCBza2xfZGRpX3NldF9pYm9vc3Qoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJfQo+ID4gLQlfc2tsX2RkaV9zZXRfaWJvb3N0
KGRldl9wcml2LCBwb3J0LCBpYm9vc3QpOwo+ID4gKwlfc2tsX2RkaV9zZXRfaWJvb3N0KGk5MTUs
IHBvcnQsIGlib29zdCk7Cj4gPiAgIAlpZiAocG9ydCA9PSBQT1JUX0EgJiYgaW50ZWxfZGlnX3Bv
cnQtPm1heF9sYW5lcyA9PSA0KQo+ID4gLQkJX3NrbF9kZGlfc2V0X2lib29zdChkZXZfcHJpdiwg
UE9SVF9FLCBpYm9vc3QpOwo+ID4gKwkJX3NrbF9kZGlfc2V0X2lib29zdChpOTE1LCBQT1JUX0Us
IGlib29zdCk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgYnh0X2RkaV92c3dpbmdfc2VxdWVu
Y2Uoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkgICAgaW50IGxldmVs
LCBlbnVtIGludGVsX291dHB1dF90eXBlIHR5cGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgYnh0X2RkaV9idWZfdHJhbnMgKmRkaV90cmFuc2xhdGlv
bnM7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gPiAgIAlpbnQgbl9l
bnRyaWVzOwo+ID4gICAJaWYgKHR5cGUgPT0gSU5URUxfT1VUUFVUX0hETUkpCj4gPiAtCQlkZGlf
dHJhbnNsYXRpb25zID0gYnh0X2dldF9idWZfdHJhbnNfaGRtaShkZXZfcHJpdiwgJm5fZW50cmll
cyk7Cj4gPiArCQlkZGlfdHJhbnNsYXRpb25zID0gYnh0X2dldF9idWZfdHJhbnNfaGRtaShpOTE1
LCAmbl9lbnRyaWVzKTsKPiA+ICAgCWVsc2UgaWYgKHR5cGUgPT0gSU5URUxfT1VUUFVUX0VEUCkK
PiA+IC0JCWRkaV90cmFuc2xhdGlvbnMgPSBieHRfZ2V0X2J1Zl90cmFuc19lZHAoZGV2X3ByaXYs
ICZuX2VudHJpZXMpOwo+ID4gKwkJZGRpX3RyYW5zbGF0aW9ucyA9IGJ4dF9nZXRfYnVmX3RyYW5z
X2VkcChpOTE1LCAmbl9lbnRyaWVzKTsKPiA+ICAgCWVsc2UKPiA+IC0JCWRkaV90cmFuc2xhdGlv
bnMgPSBieHRfZ2V0X2J1Zl90cmFuc19kcChkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4gPiArCQlk
ZGlfdHJhbnNsYXRpb25zID0gYnh0X2dldF9idWZfdHJhbnNfZHAoaTkxNSwgJm5fZW50cmllcyk7
Cj4gPiAgIAlpZiAoV0FSTl9PTl9PTkNFKCFkZGlfdHJhbnNsYXRpb25zKSkKPiA+ICAgCQlyZXR1
cm47Cj4gPiAgIAlpZiAoV0FSTl9PTl9PTkNFKGxldmVsID49IG5fZW50cmllcykpCj4gPiAgIAkJ
bGV2ZWwgPSBuX2VudHJpZXMgLSAxOwo+ID4gLQlieHRfZGRpX3BoeV9zZXRfc2lnbmFsX2xldmVs
KGRldl9wcml2LCBwb3J0LAo+ID4gKwlieHRfZGRpX3BoeV9zZXRfc2lnbmFsX2xldmVsKGk5MTUs
IHBvcnQsCj4gPiAgIAkJCQkgICAgIGRkaV90cmFuc2xhdGlvbnNbbGV2ZWxdLm1hcmdpbiwKPiA+
ICAgCQkJCSAgICAgZGRpX3RyYW5zbGF0aW9uc1tsZXZlbF0uc2NhbGUsCj4gPiAgIAkJCQkgICAg
IGRkaV90cmFuc2xhdGlvbnNbbGV2ZWxdLmVuYWJsZSwKPiA+IEBAIC0yMjI0LDMyICsyMjI0LDMy
IEBAIHN0YXRpYyB2b2lkIGJ4dF9kZGlfdnN3aW5nX3NlcXVlbmNlKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+ID4gICB1OCBpbnRlbF9kZGlfZHBfdm9sdGFnZV9tYXgoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5i
YXNlKTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiA+ICAgCWludCBu
X2VudHJpZXM7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiAtCQlp
ZiAoaW50ZWxfcG9ydF9pc19jb21ib3BoeShkZXZfcHJpdiwgcG9ydCkpCj4gPiAtCQkJaWNsX2dl
dF9jb21ib19idWZfdHJhbnMoZGV2X3ByaXYsIHBvcnQsIGVuY29kZXItPnR5cGUsCj4gPiArCWlm
IChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiA+ICsJCWlmIChpbnRlbF9wb3J0X2lzX2NvbWJv
cGh5KGk5MTUsIHBvcnQpKQo+ID4gKwkJCWljbF9nZXRfY29tYm9fYnVmX3RyYW5zKGk5MTUsIHBv
cnQsIGVuY29kZXItPnR5cGUsCj4gPiAgIAkJCQkJCWludGVsX2RwLT5saW5rX3JhdGUsICZuX2Vu
dHJpZXMpOwo+ID4gICAJCWVsc2UKPiA+ICAgCQkJbl9lbnRyaWVzID0gQVJSQVlfU0laRShpY2xf
bWdfcGh5X2RkaV90cmFuc2xhdGlvbnMpOwo+ID4gLQl9IGVsc2UgaWYgKElTX0NBTk5PTkxBS0Uo
ZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkgewo+ID4g
ICAJCWlmIChlbmNvZGVyLT50eXBlID09IElOVEVMX09VVFBVVF9FRFApCj4gPiAtCQkJY25sX2dl
dF9idWZfdHJhbnNfZWRwKGRldl9wcml2LCAmbl9lbnRyaWVzKTsKPiA+ICsJCQljbmxfZ2V0X2J1
Zl90cmFuc19lZHAoaTkxNSwgJm5fZW50cmllcyk7Cj4gPiAgIAkJZWxzZQo+ID4gLQkJCWNubF9n
ZXRfYnVmX3RyYW5zX2RwKGRldl9wcml2LCAmbl9lbnRyaWVzKTsKPiA+IC0JfSBlbHNlIGlmIChJ
U19HRU45X0xQKGRldl9wcml2KSkgewo+ID4gKwkJCWNubF9nZXRfYnVmX3RyYW5zX2RwKGk5MTUs
ICZuX2VudHJpZXMpOwo+ID4gKwl9IGVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiA+ICAg
CQlpZiAoZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQKQo+ID4gLQkJCWJ4dF9nZXRf
YnVmX3RyYW5zX2VkcChkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4gPiArCQkJYnh0X2dldF9idWZf
dHJhbnNfZWRwKGk5MTUsICZuX2VudHJpZXMpOwo+ID4gICAJCWVsc2UKPiA+IC0JCQlieHRfZ2V0
X2J1Zl90cmFuc19kcChkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4gPiArCQkJYnh0X2dldF9idWZf
dHJhbnNfZHAoaTkxNSwgJm5fZW50cmllcyk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCWlmIChl
bmNvZGVyLT50eXBlID09IElOVEVMX09VVFBVVF9FRFApCj4gPiAtCQkJaW50ZWxfZGRpX2dldF9i
dWZfdHJhbnNfZWRwKGRldl9wcml2LCBwb3J0LCAmbl9lbnRyaWVzKTsKPiA+ICsJCQlpbnRlbF9k
ZGlfZ2V0X2J1Zl90cmFuc19lZHAoaTkxNSwgcG9ydCwgJm5fZW50cmllcyk7Cj4gPiAgIAkJZWxz
ZQo+ID4gLQkJCWludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2RwKGRldl9wcml2LCBwb3J0LCAmbl9l
bnRyaWVzKTsKPiA+ICsJCQlpbnRlbF9kZGlfZ2V0X2J1Zl90cmFuc19kcChpOTE1LCBwb3J0LCAm
bl9lbnRyaWVzKTsKPiA+ICAgCX0KPiA+ICAgCWlmIChXQVJOX09OKG5fZW50cmllcyA8IDEpKQo+
ID4gQEAgLTIyODQsMTggKzIyODQsMTggQEAgdTggaW50ZWxfZGRpX2RwX3ByZV9lbXBoYXNpc19t
YXgoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIHU4IHZvbHRhZ2Vfc3dpbmcKPiA+ICAg
c3RhdGljIHZvaWQgY25sX2RkaV92c3dpbmdfcHJvZ3JhbShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKPiA+ICAgCQkJCSAgIGludCBsZXZlbCwgZW51bSBpbnRlbF9vdXRwdXRfdHlwZSB0
eXBlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJY29uc3Qgc3RydWN0IGNu
bF9kZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNsYXRpb25zOwo+ID4gICAJZW51bSBwb3J0IHBvcnQg
PSBlbmNvZGVyLT5wb3J0Owo+ID4gICAJaW50IG5fZW50cmllcywgbG47Cj4gPiAgIAl1MzIgdmFs
Owo+ID4gICAJaWYgKHR5cGUgPT0gSU5URUxfT1VUUFVUX0hETUkpCj4gPiAtCQlkZGlfdHJhbnNs
YXRpb25zID0gY25sX2dldF9idWZfdHJhbnNfaGRtaShkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4g
PiArCQlkZGlfdHJhbnNsYXRpb25zID0gY25sX2dldF9idWZfdHJhbnNfaGRtaShpOTE1LCAmbl9l
bnRyaWVzKTsKPiA+ICAgCWVsc2UgaWYgKHR5cGUgPT0gSU5URUxfT1VUUFVUX0VEUCkKPiA+IC0J
CWRkaV90cmFuc2xhdGlvbnMgPSBjbmxfZ2V0X2J1Zl90cmFuc19lZHAoZGV2X3ByaXYsICZuX2Vu
dHJpZXMpOwo+ID4gKwkJZGRpX3RyYW5zbGF0aW9ucyA9IGNubF9nZXRfYnVmX3RyYW5zX2VkcChp
OTE1LCAmbl9lbnRyaWVzKTsKPiA+ICAgCWVsc2UKPiA+IC0JCWRkaV90cmFuc2xhdGlvbnMgPSBj
bmxfZ2V0X2J1Zl90cmFuc19kcChkZXZfcHJpdiwgJm5fZW50cmllcyk7Cj4gPiArCQlkZGlfdHJh
bnNsYXRpb25zID0gY25sX2dldF9idWZfdHJhbnNfZHAoaTkxNSwgJm5fZW50cmllcyk7Cj4gPiAg
IAlpZiAoV0FSTl9PTl9PTkNFKCFkZGlfdHJhbnNsYXRpb25zKSkKPiA+ICAgCQlyZXR1cm47Cj4g
PiBAQCAtMjM0OCw3ICsyMzQ4LDcgQEAgc3RhdGljIHZvaWQgY25sX2RkaV92c3dpbmdfcHJvZ3Jh
bShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIHZvaWQgY25sX2Rk
aV92c3dpbmdfc2VxdWVuY2Uoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJ
CQkgICAgaW50IGxldmVsLCBlbnVtIGludGVsX291dHB1dF90eXBlIHR5cGUpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7
Cj4gPiAgIAlpbnQgd2lkdGgsIHJhdGUsIGxuOwo+ID4gICAJdTMyIHZhbDsKPiA+IEBAIC0yNDEy
LDcgKzI0MTIsNyBAQCBzdGF0aWMgdm9pZCBjbmxfZGRpX3Zzd2luZ19zZXF1ZW5jZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCUk5MTVfV1JJVEUoQ05MX1BPUlRfVFhfRFc1
X0dSUChwb3J0KSwgdmFsKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGljbF9kZGlfY29tYm9f
dnN3aW5nX3Byb2dyYW0oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0
YXRpYyB2b2lkIGljbF9kZGlfY29tYm9fdnN3aW5nX3Byb2dyYW0oc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJdTMyIGxldmVsLCBlbnVtIHBvcnQgcG9ydCwgaW50IHR5
cGUsCj4gPiAgIAkJCQkJaW50IHJhdGUpCj4gPiAgIHsKPiA+IEBAIC0yNDIwLDcgKzI0MjAsNyBA
QCBzdGF0aWMgdm9pZCBpY2xfZGRpX2NvbWJvX3Zzd2luZ19wcm9ncmFtKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXUzMiBuX2VudHJpZXMsIHZhbDsKPiA+ICAgCWlu
dCBsbjsKPiA+IC0JZGRpX3RyYW5zbGF0aW9ucyA9IGljbF9nZXRfY29tYm9fYnVmX3RyYW5zKGRl
dl9wcml2LCBwb3J0LCB0eXBlLAo+ID4gKwlkZGlfdHJhbnNsYXRpb25zID0gaWNsX2dldF9jb21i
b19idWZfdHJhbnMoaTkxNSwgcG9ydCwgdHlwZSwKPiA+ICAgCQkJCQkJICAgcmF0ZSwgJm5fZW50
cmllcyk7Cj4gPiAgIAlpZiAoIWRkaV90cmFuc2xhdGlvbnMpCj4gPiAgIAkJcmV0dXJuOwo+ID4g
QEAgLTI0NzIsNyArMjQ3Miw3IEBAIHN0YXRpYyB2b2lkIGljbF9jb21ib19waHlfZGRpX3Zzd2lu
Z19zZXF1ZW5jZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCQkgICAg
ICB1MzIgbGV2ZWwsCj4gPiAgIAkJCQkJICAgICAgZW51bSBpbnRlbF9vdXRwdXRfdHlwZSB0eXBl
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwb3J0IHBvcnQgPSBl
bmNvZGVyLT5wb3J0Owo+ID4gICAJaW50IHdpZHRoID0gMDsKPiA+ICAgCWludCByYXRlID0gMDsK
PiA+IEBAIC0yNTMwLDcgKzI1MzAsNyBAQCBzdGF0aWMgdm9pZCBpY2xfY29tYm9fcGh5X2RkaV92
c3dpbmdfc2VxdWVuY2Uoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAlJOTE1
X1dSSVRFKElDTF9QT1JUX1RYX0RXNV9HUlAocG9ydCksIHZhbCk7Cj4gPiAgIAkvKiA1LiBQcm9n
cmFtIHN3aW5nIGFuZCBkZS1lbXBoYXNpcyAqLwo+ID4gLQlpY2xfZGRpX2NvbWJvX3Zzd2luZ19w
cm9ncmFtKGRldl9wcml2LCBsZXZlbCwgcG9ydCwgdHlwZSwgcmF0ZSk7Cj4gPiArCWljbF9kZGlf
Y29tYm9fdnN3aW5nX3Byb2dyYW0oaTkxNSwgbGV2ZWwsIHBvcnQsIHR5cGUsIHJhdGUpOwo+ID4g
ICAJLyogNi4gU2V0IHRyYWluaW5nIGVuYWJsZSB0byB0cmlnZ2VyIHVwZGF0ZSAqLwo+ID4gICAJ
dmFsID0gSTkxNV9SRUFEKElDTF9QT1JUX1RYX0RXNV9MTjAocG9ydCkpOwo+ID4gQEAgLTI1NDIs
NyArMjU0Miw3IEBAIHN0YXRpYyB2b2lkIGljbF9tZ19waHlfZGRpX3Zzd2luZ19zZXF1ZW5jZShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCQkgICBpbnQgbGlua19jbG9j
aywKPiA+ICAgCQkJCQkgICB1MzIgbGV2ZWwpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gPiAgIAljb25zdCBzdHJ1
Y3QgaWNsX21nX3BoeV9kZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNsYXRpb25zOwo+ID4gICAJdTMy
IG5fZW50cmllcywgdmFsOwo+ID4gQEAgLTI2NjIsMTAgKzI2NjIsMTAgQEAgc3RhdGljIHZvaWQg
aWNsX2RkaV92c3dpbmdfc2VxdWVuY2Uoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
PiAgIAkJCQkgICAgdTMyIGxldmVsLAo+ID4gICAJCQkJICAgIGVudW0gaW50ZWxfb3V0cHV0X3R5
cGUgdHlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcG9ydCBw
b3J0ID0gZW5jb2Rlci0+cG9ydDsKPiA+IC0JaWYgKGludGVsX3BvcnRfaXNfY29tYm9waHkoZGV2
X3ByaXYsIHBvcnQpKQo+ID4gKwlpZiAoaW50ZWxfcG9ydF9pc19jb21ib3BoeShpOTE1LCBwb3J0
KSkKPiA+ICAgCQlpY2xfY29tYm9fcGh5X2RkaV92c3dpbmdfc2VxdWVuY2UoZW5jb2RlciwgbGV2
ZWwsIHR5cGUpOwo+ID4gICAJZWxzZQo+ID4gICAJCWljbF9tZ19waHlfZGRpX3Zzd2luZ19zZXF1
ZW5jZShlbmNvZGVyLCBsaW5rX2Nsb2NrLCBsZXZlbCk7Cj4gPiBAQCAtMjY5OCwxNCArMjY5OCwx
NCBAQCBzdGF0aWMgdTMyIGludGVsX2RkaV9kcF9sZXZlbChzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwKQo+ID4gICB1MzIgYnh0X3NpZ25hbF9sZXZlbHMoc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQgPSBkcF90
b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZHBvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZHBvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ID4gICAJ
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIgPSAmZHBvcnQtPmJhc2U7Cj4gPiAgIAlpbnQg
bGV2ZWwgPSBpbnRlbF9kZGlfZHBfbGV2ZWwoaW50ZWxfZHApOwo+ID4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICAg
CQlpY2xfZGRpX3Zzd2luZ19zZXF1ZW5jZShlbmNvZGVyLCBpbnRlbF9kcC0+bGlua19yYXRlLAo+
ID4gICAJCQkJCWxldmVsLCBlbmNvZGVyLT50eXBlKTsKPiA+IC0JZWxzZSBpZiAoSVNfQ0FOTk9O
TEFLRShkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElTX0NBTk5PTkxBS0UoaTkxNSkpCj4gPiAg
IAkJY25sX2RkaV92c3dpbmdfc2VxdWVuY2UoZW5jb2RlciwgbGV2ZWwsIGVuY29kZXItPnR5cGUp
Owo+ID4gICAJZWxzZQo+ID4gICAJCWJ4dF9kZGlfdnN3aW5nX3NlcXVlbmNlKGVuY29kZXIsIGxl
dmVsLCBlbmNvZGVyLT50eXBlKTsKPiA+IEBAIC0yNzE2LDI0ICsyNzE2LDI0IEBAIHUzMiBieHRf
c2lnbmFsX2xldmVscyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICB1MzIgZGRpX3Np
Z25hbF9sZXZlbHMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgewo+ID4gICAJc3Ry
dWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZHBvcnQt
PmJhc2UuYmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZHBvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIgPSAmZHBvcnQtPmJhc2U7Cj4gPiAgIAlpbnQgbGV2ZWwgPSBpbnRlbF9kZGlfZHBf
bGV2ZWwoaW50ZWxfZHApOwo+ID4gLQlpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikpCj4gPiArCWlm
IChJU19HRU45X0JDKGk5MTUpKQo+ID4gICAJCXNrbF9kZGlfc2V0X2lib29zdChlbmNvZGVyLCBs
ZXZlbCwgZW5jb2Rlci0+dHlwZSk7Cj4gPiAgIAlyZXR1cm4gRERJX0JVRl9UUkFOU19TRUxFQ1Qo
bGV2ZWwpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbmxpbmUKPiA+IC11MzIgaWNsX2RwY2xrYV9j
ZmdjcjBfY2xrX29mZihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdTMy
IGljbF9kcGNsa2FfY2ZnY3IwX2Nsa19vZmYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gPiAgIAkJCSAgICAgIGVudW0gcG9ydCBwb3J0KQo+ID4gICB7Cj4gPiAtCWlmIChpbnRlbF9w
b3J0X2lzX2NvbWJvcGh5KGRldl9wcml2LCBwb3J0KSkgewo+ID4gKwlpZiAoaW50ZWxfcG9ydF9p
c19jb21ib3BoeShpOTE1LCBwb3J0KSkgewo+ID4gICAJCXJldHVybiBJQ0xfRFBDTEtBX0NGR0NS
MF9ERElfQ0xLX09GRihwb3J0KTsKPiA+IC0JfSBlbHNlIGlmIChpbnRlbF9wb3J0X2lzX3RjKGRl
dl9wcml2LCBwb3J0KSkgewo+ID4gLQkJZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0
X3RvX3RjKGRldl9wcml2LCBwb3J0KTsKPiA+ICsJfSBlbHNlIGlmIChpbnRlbF9wb3J0X2lzX3Rj
KGk5MTUsIHBvcnQpKSB7Cj4gPiArCQllbnVtIHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRf
dG9fdGMoaTkxNSwgcG9ydCk7Cj4gPiAgIAkJcmV0dXJuIElDTF9EUENMS0FfQ0ZHQ1IwX1RDX0NM
S19PRkYodGNfcG9ydCk7Cj4gPiAgIAl9Cj4gPiBAQCAtMjc0NCw0NyArMjc0NCw0NyBAQCB1MzIg
aWNsX2RwY2xrYV9jZmdjcjBfY2xrX29mZihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAgIHN0YXRpYyB2b2lkIGljbF9tYXBfcGxsc190b19wb3J0cyhzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCA9IGNydGNfc3RhdGUtPnNoYXJlZF9kcGxsOwo+ID4g
ICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ID4gICAJdTMyIHZhbDsKPiA+IC0J
bXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRwbGxfbG9jayk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUt
PmRwbGxfbG9jayk7Cj4gPiAgIAl2YWwgPSBJOTE1X1JFQUQoRFBDTEtBX0NGR0NSMF9JQ0wpOwo+
ID4gLQlXQVJOX09OKCh2YWwgJiBpY2xfZHBjbGthX2NmZ2NyMF9jbGtfb2ZmKGRldl9wcml2LCBw
b3J0KSkgPT0gMCk7Cj4gPiArCVdBUk5fT04oKHZhbCAmIGljbF9kcGNsa2FfY2ZnY3IwX2Nsa19v
ZmYoaTkxNSwgcG9ydCkpID09IDApOwo+ID4gLQlpZiAoaW50ZWxfcG9ydF9pc19jb21ib3BoeShk
ZXZfcHJpdiwgcG9ydCkpIHsKPiA+ICsJaWYgKGludGVsX3BvcnRfaXNfY29tYm9waHkoaTkxNSwg
cG9ydCkpIHsKPiA+ICAgCQl2YWwgJj0gfkRQQ0xLQV9DRkdDUjBfRERJX0NMS19TRUxfTUFTSyhw
b3J0KTsKPiA+ICAgCQl2YWwgfD0gRFBDTEtBX0NGR0NSMF9ERElfQ0xLX1NFTChwbGwtPmluZm8t
PmlkLCBwb3J0KTsKPiA+ICAgCQlJOTE1X1dSSVRFKERQQ0xLQV9DRkdDUjBfSUNMLCB2YWwpOwo+
ID4gICAJCVBPU1RJTkdfUkVBRChEUENMS0FfQ0ZHQ1IwX0lDTCk7Cj4gPiAgIAl9Cj4gPiAtCXZh
bCAmPSB+aWNsX2RwY2xrYV9jZmdjcjBfY2xrX29mZihkZXZfcHJpdiwgcG9ydCk7Cj4gPiArCXZh
bCAmPSB+aWNsX2RwY2xrYV9jZmdjcjBfY2xrX29mZihpOTE1LCBwb3J0KTsKPiA+ICAgCUk5MTVf
V1JJVEUoRFBDTEtBX0NGR0NSMF9JQ0wsIHZhbCk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPmRwbGxfbG9jayk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHBsbF9sb2NrKTsKPiA+
ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBpY2xfdW5tYXBfcGxsc190b19wb3J0cyhzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAg
CWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAtCW11
dGV4X2xvY2soJmRldl9wcml2LT5kcGxsX2xvY2spOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5k
cGxsX2xvY2spOwo+ID4gICAJdmFsID0gSTkxNV9SRUFEKERQQ0xLQV9DRkdDUjBfSUNMKTsKPiA+
IC0JdmFsIHw9IGljbF9kcGNsa2FfY2ZnY3IwX2Nsa19vZmYoZGV2X3ByaXYsIHBvcnQpOwo+ID4g
Kwl2YWwgfD0gaWNsX2RwY2xrYV9jZmdjcjBfY2xrX29mZihpOTE1LCBwb3J0KTsKPiA+ICAgCUk5
MTVfV1JJVEUoRFBDTEtBX0NGR0NSMF9JQ0wsIHZhbCk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2
X3ByaXYtPmRwbGxfbG9jayk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHBsbF9sb2NrKTsK
PiA+ICAgfQo+ID4gICB2b2lkIGljbF9zYW5pdGl6ZV9lbmNvZGVyX3BsbF9tYXBwaW5nKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ID4gICAJdTMyIHZhbDsKPiA+ICAgCWVudW0gcG9ydCBwb3J0Owo+ID4gICAJdTMyIHBvcnRfbWFz
azsKPiA+IEBAIC0yODIxLDcgKzI4MjEsNyBAQCB2b2lkIGljbF9zYW5pdGl6ZV9lbmNvZGVyX3Bs
bF9tYXBwaW5nKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICAJCSAqIFNhbml0
eSBjaGVjayB0aGF0IHdlIGhhdmVuJ3QgaW5jb3JyZWN0bHkgcmVnaXN0ZXJlZCBhbm90aGVyCj4g
PiAgIAkJICogZW5jb2RlciB1c2luZyBhbnkgb2YgdGhlIHBvcnRzIG9mIHRoaXMgRFNJIGVuY29k
ZXIuCj4gPiAgIAkJICovCj4gPiAtCQlmb3JfZWFjaF9pbnRlbF9lbmNvZGVyKCZkZXZfcHJpdi0+
ZHJtLCBvdGhlcl9lbmNvZGVyKSB7Cj4gPiArCQlmb3JfZWFjaF9pbnRlbF9lbmNvZGVyKCZpOTE1
LT5kcm0sIG90aGVyX2VuY29kZXIpIHsKPiA+ICAgCQkJaWYgKG90aGVyX2VuY29kZXIgPT0gZW5j
b2RlcikKPiA+ICAgCQkJCWNvbnRpbnVlOwo+ID4gQEAgLTI4MzgsNyArMjgzOCw3IEBAIHZvaWQg
aWNsX3Nhbml0aXplX2VuY29kZXJfcGxsX21hcHBpbmcoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIpCj4gPiAgIAl2YWwgPSBJOTE1X1JFQUQoRFBDTEtBX0NGR0NSMF9JQ0wpOwo+ID4gICAJ
Zm9yX2VhY2hfcG9ydF9tYXNrZWQocG9ydCwgcG9ydF9tYXNrKSB7Cj4gPiAgIAkJYm9vbCBkZGlf
Y2xrX3VuZ2F0ZWQgPSAhKHZhbCAmCj4gPiAtCQkJCQkgaWNsX2RwY2xrYV9jZmdjcjBfY2xrX29m
ZihkZXZfcHJpdiwKPiA+ICsJCQkJCSBpY2xfZHBjbGthX2NmZ2NyMF9jbGtfb2ZmKGk5MTUsCj4g
PiAgIAkJCQkJCQkJICAgcG9ydCkpOwo+ID4gICAJCWlmIChkZGlfY2xrX25lZWRlZCA9PSBkZGlf
Y2xrX3VuZ2F0ZWQpCj4gPiBAQCAtMjg1Myw3ICsyODUzLDcgQEAgdm9pZCBpY2xfc2FuaXRpemVf
ZW5jb2Rlcl9wbGxfbWFwcGluZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAg
CQlEUk1fTk9URSgiUG9ydCAlYyBpcyBkaXNhYmxlZC9pbiBEU0kgbW9kZSB3aXRoIGFuIHVuZ2F0
ZWQgRERJIGNsb2NrLCBnYXRlIGl0XG4iLAo+ID4gICAJCQkgcG9ydF9uYW1lKHBvcnQpKTsKPiA+
IC0JCXZhbCB8PSBpY2xfZHBjbGthX2NmZ2NyMF9jbGtfb2ZmKGRldl9wcml2LCBwb3J0KTsKPiA+
ICsJCXZhbCB8PSBpY2xfZHBjbGthX2NmZ2NyMF9jbGtfb2ZmKGk5MTUsIHBvcnQpOwo+ID4gICAJ
CUk5MTVfV1JJVEUoRFBDTEtBX0NGR0NSMF9JQ0wsIHZhbCk7Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+
IEBAIC0yODYxLDcgKzI4NjEsNyBAQCB2b2lkIGljbF9zYW5pdGl6ZV9lbmNvZGVyX3BsbF9tYXBw
aW5nKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICBzdGF0aWMgdm9pZCBpbnRl
bF9kZGlfY2xrX3NlbGVjdChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJ
CSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsK
PiA+ICAgCXUzMiB2YWw7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBs
bCA9IGNydGNfc3RhdGUtPnNoYXJlZF9kcGxsOwo+ID4gQEAgLTI4NjksMTMgKzI4NjksMTMgQEAg
c3RhdGljIHZvaWQgaW50ZWxfZGRpX2Nsa19zZWxlY3Qoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gPiAgIAlpZiAoV0FSTl9PTighcGxsKSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCW11
dGV4X2xvY2soJmRldl9wcml2LT5kcGxsX2xvY2spOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5k
cGxsX2xvY2spOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+ID4gLQkJ
aWYgKCFpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KGRldl9wcml2LCBwb3J0KSkKPiA+ICsJaWYgKElO
VEVMX0dFTihpOTE1KSA+PSAxMSkgewo+ID4gKwkJaWYgKCFpbnRlbF9wb3J0X2lzX2NvbWJvcGh5
KGk5MTUsIHBvcnQpKQo+ID4gICAJCQlJOTE1X1dSSVRFKERESV9DTEtfU0VMKHBvcnQpLAo+ID4g
ICAJCQkJICAgaWNsX3BsbF90b19kZGlfY2xrX3NlbChlbmNvZGVyLCBjcnRjX3N0YXRlKSk7Cj4g
PiAtCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlm
IChJU19DQU5OT05MQUtFKGk5MTUpKSB7Cj4gPiAgIAkJLyogQ29uZmlndXJlIERQQ0xLQV9DRkdD
UjAgdG8gbWFwIHRoZSBEUExMIHRvIHRoZSBEREkuICovCj4gPiAgIAkJdmFsID0gSTkxNV9SRUFE
KERQQ0xLQV9DRkdDUjApOwo+ID4gICAJCXZhbCAmPSB+RFBDTEtBX0NGR0NSMF9ERElfQ0xLX1NF
TF9NQVNLKHBvcnQpOwo+ID4gQEAgLTI4OTAsNyArMjg5MCw3IEBAIHN0YXRpYyB2b2lkIGludGVs
X2RkaV9jbGtfc2VsZWN0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCXZh
bCA9IEk5MTVfUkVBRChEUENMS0FfQ0ZHQ1IwKTsKPiA+ICAgCQl2YWwgJj0gfkRQQ0xLQV9DRkdD
UjBfRERJX0NMS19PRkYocG9ydCk7Cj4gPiAgIAkJSTkxNV9XUklURShEUENMS0FfQ0ZHQ1IwLCB2
YWwpOwo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxz
ZSBpZiAoSVNfR0VOOV9CQyhpOTE1KSkgewo+ID4gICAJCS8qIERESSAtPiBQTEwgbWFwcGluZyAg
Ki8KPiA+ICAgCQl2YWwgPSBJOTE1X1JFQUQoRFBMTF9DVFJMMik7Cj4gPiBAQCAtMjkwMSwzNyAr
MjkwMSwzNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfY2xrX3NlbGVjdChzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQlJOTE1X1dSSVRFKERQTExfQ1RSTDIsIHZhbCk7Cj4g
PiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDkpIHsKPiA+ICsJfSBlbHNlIGlm
IChJTlRFTF9HRU4oaTkxNSkgPCA5KSB7Cj4gPiAgIAkJSTkxNV9XUklURShQT1JUX0NMS19TRUwo
cG9ydCksIGhzd19wbGxfdG9fZGRpX3BsbF9zZWwocGxsKSk7Cj4gPiAgIAl9Cj4gPiAtCW11dGV4
X3VubG9jaygmZGV2X3ByaXYtPmRwbGxfbG9jayk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+
ZHBsbF9sb2NrKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfY2xrX2Rpc2Fi
bGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gPiAtCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiAtCQlpZiAoIWludGVsX3BvcnRfaXNfY29t
Ym9waHkoZGV2X3ByaXYsIHBvcnQpKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKSB7
Cj4gPiArCQlpZiAoIWludGVsX3BvcnRfaXNfY29tYm9waHkoaTkxNSwgcG9ydCkpCj4gPiAgIAkJ
CUk5MTVfV1JJVEUoRERJX0NMS19TRUwocG9ydCksIERESV9DTEtfU0VMX05PTkUpOwo+ID4gLQl9
IGVsc2UgaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNf
Q0FOTk9OTEFLRShpOTE1KSkgewo+ID4gICAJCUk5MTVfV1JJVEUoRFBDTEtBX0NGR0NSMCwgSTkx
NV9SRUFEKERQQ0xLQV9DRkdDUjApIHwKPiA+ICAgCQkJICAgRFBDTEtBX0NGR0NSMF9ERElfQ0xL
X09GRihwb3J0KSk7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikpIHsKPiA+
ICsJfSBlbHNlIGlmIChJU19HRU45X0JDKGk5MTUpKSB7Cj4gPiAgIAkJSTkxNV9XUklURShEUExM
X0NUUkwyLCBJOTE1X1JFQUQoRFBMTF9DVFJMMikgfAo+ID4gICAJCQkgICBEUExMX0NUUkwyX0RE
SV9DTEtfT0ZGKHBvcnQpKTsKPiA+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwg
OSkgewo+ID4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA8IDkpIHsKPiA+ICAgCQlJOTE1
X1dSSVRFKFBPUlRfQ0xLX1NFTChwb3J0KSwgUE9SVF9DTEtfU0VMX05PTkUpOwo+ID4gICAJfQo+
ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGljbF9lbmFibGVfcGh5X2Nsb2NrX2dhdGluZyhzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0
LT5iYXNlLmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gZGlnX3BvcnQtPmJhc2Uu
cG9ydDsKPiA+IC0JZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0X3RvX3RjKGRldl9w
cml2LCBwb3J0KTsKPiA+ICsJZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0X3RvX3Rj
KGk5MTUsIHBvcnQpOwo+ID4gICAJdTMyIHZhbDsKPiA+ICAgCWludCBsbjsKPiA+IEBAIC0yOTYx
LDkgKzI5NjEsOSBAQCBzdGF0aWMgdm9pZCBpY2xfZW5hYmxlX3BoeV9jbG9ja19nYXRpbmcoc3Ry
dWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpCj4gPiAgIHN0YXRpYyB2b2lkIGljbF9k
aXNhYmxlX3BoeV9jbG9ja19nYXRpbmcoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3Bv
cnQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gPiAgIAllbnVt
IHBvcnQgcG9ydCA9IGRpZ19wb3J0LT5iYXNlLnBvcnQ7Cj4gPiAtCWVudW0gdGNfcG9ydCB0Y19w
b3J0ID0gaW50ZWxfcG9ydF90b190YyhkZXZfcHJpdiwgcG9ydCk7Cj4gPiArCWVudW0gdGNfcG9y
dCB0Y19wb3J0ID0gaW50ZWxfcG9ydF90b190YyhpOTE1LCBwb3J0KTsKPiA+ICAgCXUzMiB2YWw7
Cj4gPiAgIAlpbnQgbG47Cj4gPiBAQCAtMjk5Myw5ICsyOTkzLDkgQEAgc3RhdGljIHZvaWQgaWNs
X2Rpc2FibGVfcGh5X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdf
cG9ydCkKPiA+ICAgc3RhdGljIHZvaWQgaWNsX3Byb2dyYW1fbWdfZHBfbW9kZShzdHJ1Y3QgaW50
ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2RpZ19wb3J0LT5iYXNlLmJh
c2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGlu
dGVsX2RpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50
ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKPiA+IC0JZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRl
bF9wb3J0X3RvX3RjKGRldl9wcml2LCBwb3J0KTsKPiA+ICsJZW51bSB0Y19wb3J0IHRjX3BvcnQg
PSBpbnRlbF9wb3J0X3RvX3RjKGk5MTUsIHBvcnQpOwo+ID4gICAJdTMyIGxuMCwgbG4xLCBsYW5l
X2luZm87Cj4gPiAgIAlpZiAodGNfcG9ydCA9PSBQT1JUX1RDX05PTkUgfHwgaW50ZWxfZGlnX3Bv
cnQtPnRjX3R5cGUgPT0gVENfUE9SVF9UQlQpCj4gPiBAQCAtMzA2OSw3ICszMDY5LDcgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZHBfc2lua19zZXRfZmVjX3JlYWR5KHN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHAsCj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2RkaV9lbmFibGVfZmVjKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJZW51
bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ID4gICAJdTMyIHZhbDsKPiA+IEBAIC0zMDgw
LDcgKzMwODAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfZW5hYmxlX2ZlYyhzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCXZhbCB8PSBEUF9UUF9DVExfRkVDX0VOQUJMRTsK
PiA+ICAgCUk5MTVfV1JJVEUoRFBfVFBfQ1RMKHBvcnQpLCB2YWwpOwo+ID4gLQlpZiAoaW50ZWxf
d2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsIERQX1RQX1NUQVRVUyhwb3J0KSwK
PiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsIERQX1RQX1NU
QVRVUyhwb3J0KSwKPiA+ICAgCQkJCSAgICBEUF9UUF9TVEFUVVNfRkVDX0VOQUJMRV9MSVZFLAo+
ID4gICAJCQkJICAgIERQX1RQX1NUQVRVU19GRUNfRU5BQkxFX0xJVkUsCj4gPiAgIAkJCQkgICAg
MSkpCj4gPiBAQCAtMzA5MCw3ICszMDkwLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX2VuYWJs
ZV9mZWMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIHN0YXRpYyB2b2lkIGlu
dGVsX2RkaV9kaXNhYmxlX2ZlY19zdGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiA+ICAgCQkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rl
ci0+cG9ydDsKPiA+ICAgCXUzMiB2YWw7Cj4gPiBAQCAtMzEwOCw3ICszMTA4LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfZGRpX3ByZV9lbmFibGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gPiAgIAkJCQkgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5f
c3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9f
aW50ZWxfZHAoJmVuY29kZXItPmJhc2UpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWVu
dW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFs
X3BvcnQgKmRpZ19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAg
CWJvb2wgaXNfbXN0ID0gaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQ
VVRfRFBfTVNUKTsKPiA+IEBAIC0zMTIzLDI2ICszMTIzLDI2IEBAIHN0YXRpYyB2b2lkIGludGVs
X2RkaV9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJ
aW50ZWxfZGRpX2Nsa19zZWxlY3QoZW5jb2RlciwgY3J0Y19zdGF0ZSk7Cj4gPiAtCWludGVsX2Rp
c3BsYXlfcG93ZXJfZ2V0KGRldl9wcml2LCBkaWdfcG9ydC0+ZGRpX2lvX3Bvd2VyX2RvbWFpbik7
Cj4gPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5MTUsIGRpZ19wb3J0LT5kZGlfaW9fcG93
ZXJfZG9tYWluKTsKPiA+ICAgCWljbF9wcm9ncmFtX21nX2RwX21vZGUoZGlnX3BvcnQpOwo+ID4g
ICAJaWNsX2Rpc2FibGVfcGh5X2Nsb2NrX2dhdGluZyhkaWdfcG9ydCk7Cj4gPiAtCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDExKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+
ID4gICAJCWljbF9kZGlfdnN3aW5nX3NlcXVlbmNlKGVuY29kZXIsIGNydGNfc3RhdGUtPnBvcnRf
Y2xvY2ssCj4gPiAgIAkJCQkJbGV2ZWwsIGVuY29kZXItPnR5cGUpOwo+ID4gLQllbHNlIGlmIChJ
U19DQU5OT05MQUtFKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1
KSkKPiA+ICAgCQljbmxfZGRpX3Zzd2luZ19zZXF1ZW5jZShlbmNvZGVyLCBsZXZlbCwgZW5jb2Rl
ci0+dHlwZSk7Cj4gPiAtCWVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ID4gKwllbHNl
IGlmIChJU19HRU45X0xQKGk5MTUpKQo+ID4gICAJCWJ4dF9kZGlfdnN3aW5nX3NlcXVlbmNlKGVu
Y29kZXIsIGxldmVsLCBlbmNvZGVyLT50eXBlKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlpbnRlbF9w
cmVwYXJlX2RwX2RkaV9idWZmZXJzKGVuY29kZXIsIGNydGNfc3RhdGUpOwo+ID4gLQlpZiAoaW50
ZWxfcG9ydF9pc19jb21ib3BoeShkZXZfcHJpdiwgcG9ydCkpIHsKPiA+ICsJaWYgKGludGVsX3Bv
cnRfaXNfY29tYm9waHkoaTkxNSwgcG9ydCkpIHsKPiA+ICAgCQlib29sIGxhbmVfcmV2ZXJzYWwg
PQo+ID4gICAJCQlkaWdfcG9ydC0+c2F2ZWRfcG9ydF9iaXRzICYgRERJX0JVRl9QT1JUX1JFVkVS
U0FMOwo+ID4gLQkJaW50ZWxfY29tYm9fcGh5X3Bvd2VyX3VwX2xhbmVzKGRldl9wcml2LCBwb3J0
LCBmYWxzZSwKPiA+ICsJCWludGVsX2NvbWJvX3BoeV9wb3dlcl91cF9sYW5lcyhpOTE1LCBwb3J0
LCBmYWxzZSwKPiA+ICAgCQkJCQkgICAgICAgY3J0Y19zdGF0ZS0+bGFuZV9jb3VudCwKPiA+ICAg
CQkJCQkgICAgICAgbGFuZV9yZXZlcnNhbCk7Cj4gPiAgIAl9Cj4gPiBAQCAtMzE1NCw3ICszMTU0
LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX3ByZV9lbmFibGVfZHAoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkJICAgICAgdHJ1ZSk7Cj4gPiAgIAlpbnRlbF9kcF9z
aW5rX3NldF9mZWNfcmVhZHkoaW50ZWxfZHAsIGNydGNfc3RhdGUpOwo+ID4gICAJaW50ZWxfZHBf
c3RhcnRfbGlua190cmFpbihpbnRlbF9kcCk7Cj4gPiAtCWlmIChwb3J0ICE9IFBPUlRfQSB8fCBJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiArCWlmIChwb3J0ICE9IFBPUlRfQSB8fCBJTlRF
TF9HRU4oaTkxNSkgPj0gOSkKPiA+ICAgCQlpbnRlbF9kcF9zdG9wX2xpbmtfdHJhaW4oaW50ZWxf
ZHApOwo+ID4gICAJaW50ZWxfZGRpX2VuYWJsZV9mZWMoZW5jb2RlciwgY3J0Y19zdGF0ZSk7Cj4g
PiBAQCAtMzE3MywzMiArMzE3MywzMiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfcHJlX2VuYWJs
ZV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICB7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCA9IGVuY190b19kaWdfcG9ydCgm
ZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9ICZp
bnRlbF9kaWdfcG9ydC0+aGRtaTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBv
cnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gPiAtCWludCBsZXZlbCA9IGludGVsX2RkaV9oZG1p
X2xldmVsKGRldl9wcml2LCBwb3J0KTsKPiA+ICsJaW50IGxldmVsID0gaW50ZWxfZGRpX2hkbWlf
bGV2ZWwoaTkxNSwgcG9ydCk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdf
cG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAlpbnRlbF9kcF9k
dWFsX21vZGVfc2V0X3RtZHNfb3V0cHV0KGludGVsX2hkbWksIHRydWUpOwo+ID4gICAJaW50ZWxf
ZGRpX2Nsa19zZWxlY3QoZW5jb2RlciwgY3J0Y19zdGF0ZSk7Cj4gPiAtCWludGVsX2Rpc3BsYXlf
cG93ZXJfZ2V0KGRldl9wcml2LCBkaWdfcG9ydC0+ZGRpX2lvX3Bvd2VyX2RvbWFpbik7Cj4gPiAr
CWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5MTUsIGRpZ19wb3J0LT5kZGlfaW9fcG93ZXJfZG9t
YWluKTsKPiA+ICAgCWljbF9wcm9ncmFtX21nX2RwX21vZGUoZGlnX3BvcnQpOwo+ID4gICAJaWNs
X2Rpc2FibGVfcGh5X2Nsb2NrX2dhdGluZyhkaWdfcG9ydCk7Cj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDExKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ID4gICAJ
CWljbF9kZGlfdnN3aW5nX3NlcXVlbmNlKGVuY29kZXIsIGNydGNfc3RhdGUtPnBvcnRfY2xvY2ss
Cj4gPiAgIAkJCQkJbGV2ZWwsIElOVEVMX09VVFBVVF9IRE1JKTsKPiA+IC0JZWxzZSBpZiAoSVNf
Q0FOTk9OTEFLRShkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElTX0NBTk5PTkxBS0UoaTkxNSkp
Cj4gPiAgIAkJY25sX2RkaV92c3dpbmdfc2VxdWVuY2UoZW5jb2RlciwgbGV2ZWwsIElOVEVMX09V
VFBVVF9IRE1JKTsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gPiArCWVs
c2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gPiAgIAkJYnh0X2RkaV92c3dpbmdfc2VxdWVuY2Uo
ZW5jb2RlciwgbGV2ZWwsIElOVEVMX09VVFBVVF9IRE1JKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlp
bnRlbF9wcmVwYXJlX2hkbWlfZGRpX2J1ZmZlcnMoZW5jb2RlciwgbGV2ZWwpOwo+ID4gICAJaWNs
X2VuYWJsZV9waHlfY2xvY2tfZ2F0aW5nKGRpZ19wb3J0KTsKPiA+IC0JaWYgKElTX0dFTjlfQkMo
ZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfR0VOOV9CQyhpOTE1KSkKPiA+ICAgCQlza2xfZGRpX3Nl
dF9pYm9vc3QoZW5jb2RlciwgbGV2ZWwsIElOVEVMX09VVFBVVF9IRE1JKTsKPiA+ICAgCWludGVs
X2RkaV9lbmFibGVfcGlwZV9jbG9jayhjcnRjX3N0YXRlKTsKPiA+IEBAIC0zMjEzLDcgKzMyMTMs
NyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiA+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJ
ZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJLyoKPiA+IEBAIC0zMjMxLDEwICsz
MjMxLDEwIEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ID4gICAJV0FSTl9PTihjcnRjX3N0YXRlLT5oYXNfcGNoX2VuY29k
ZXIpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiA+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSAxMSkKPiA+ICAgCQlpY2xfbWFwX3BsbHNfdG9fcG9ydHMoZW5jb2Rlciwg
Y3J0Y19zdGF0ZSk7Cj4gPiAtCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmco
ZGV2X3ByaXYsIHBpcGUsIHRydWUpOwo+ID4gKwlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5f
cmVwb3J0aW5nKGk5MTUsIHBpcGUsIHRydWUpOwo+ID4gICAJaWYgKGludGVsX2NydGNfaGFzX3R5
cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0hETUkpKSB7Cj4gPiAgIAkJaW50ZWxfZGRpX3By
ZV9lbmFibGVfaGRtaShlbmNvZGVyLCBjcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsKPiA+IEBAIC0z
MjU3LDcgKzMyNTcsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfcHJlX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJsZV9k
ZGlfYnVmKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJICBjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiA+ICAgCWJv
b2wgd2FpdCA9IGZhbHNlOwo+ID4gICAJdTMyIHZhbDsKPiA+IEBAIC0zMjc4LDE0ICszMjc4LDE0
IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfZGRpX2J1ZihzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiA+ICAgCWludGVsX2RkaV9kaXNhYmxlX2ZlY19zdGF0ZShlbmNvZGVyLCBj
cnRjX3N0YXRlKTsKPiA+ICAgCWlmICh3YWl0KQo+ID4gLQkJaW50ZWxfd2FpdF9kZGlfYnVmX2lk
bGUoZGV2X3ByaXYsIHBvcnQpOwo+ID4gKwkJaW50ZWxfd2FpdF9kZGlfYnVmX2lkbGUoaTkxNSwg
cG9ydCk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX3Bvc3RfZGlzYWJsZV9k
cChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCSAgICAgIGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiA+ICAgCQkJCSAgICAgIGNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRp
Z19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHAgPSAmZGlnX3BvcnQtPmRwOwo+ID4gICAJYm9vbCBpc19tc3QgPSBp
bnRlbF9jcnRjX2hhc190eXBlKG9sZF9jcnRjX3N0YXRlLAo+ID4gQEAgLTMzMDUsNyArMzMwNSw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9wb3N0X2Rpc2FibGVfZHAoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCj4gPiAgIAlpbnRlbF9lZHBfcGFuZWxfdmRkX29uKGludGVsX2RwKTsK
PiA+ICAgCWludGVsX2VkcF9wYW5lbF9vZmYoaW50ZWxfZHApOwo+ID4gLQlpbnRlbF9kaXNwbGF5
X3Bvd2VyX3B1dF91bmNoZWNrZWQoZGV2X3ByaXYsCj4gPiArCWludGVsX2Rpc3BsYXlfcG93ZXJf
cHV0X3VuY2hlY2tlZChpOTE1LAo+ID4gICAJCQkJCSAgZGlnX3BvcnQtPmRkaV9pb19wb3dlcl9k
b21haW4pOwo+ID4gICAJaW50ZWxfZGRpX2Nsa19kaXNhYmxlKGVuY29kZXIpOwo+ID4gQEAgLTMz
MTUsNyArMzMxNSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9wb3N0X2Rpc2FibGVfaGRtaShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCQljb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gPiAgIAkJCQkJY29uc3Qgc3RydWN0IGRy
bV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBlbmNf
dG9fZGlnX3BvcnQoJmVuY29kZXItPmJhc2UpOwo+ID4gICAJc3RydWN0IGludGVsX2hkbWkgKmlu
dGVsX2hkbWkgPSAmZGlnX3BvcnQtPmhkbWk7Cj4gPiBAQCAtMzMyNiw3ICszMzI2LDcgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZGRpX3Bvc3RfZGlzYWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ID4gICAJaW50ZWxfZGlzYWJsZV9kZGlfYnVmKGVuY29kZXIsIG9sZF9jcnRj
X3N0YXRlKTsKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKGRldl9wcml2
LAo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF91bmNoZWNrZWQoaTkxNSwKPiA+ICAgCQkJ
CQkgIGRpZ19wb3J0LT5kZGlfaW9fcG93ZXJfZG9tYWluKTsKPiA+ICAgCWludGVsX2RkaV9jbGtf
ZGlzYWJsZShlbmNvZGVyKTsKPiA+IEBAIC0zMzM4LDcgKzMzMzgsNyBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9kZGlfcG9zdF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4g
ICAJCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+
ID4gICAJCQkJICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0
YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJLyoKPiA+ICAgCSAqIFdo
ZW4gY2FsbGVkIGZyb20gRFAgTVNUIGNvZGU6Cj4gPiBAQCAtMzM2MCw3ICszMzYwLDcgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZGRpX3Bvc3RfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPiA+ICAgCQlpbnRlbF9kZGlfcG9zdF9kaXNhYmxlX2RwKGVuY29kZXIsCj4gPiAgIAkJ
CQkJICBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5fc3RhdGUpOwo+ID4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICAg
CQlpY2xfdW5tYXBfcGxsc190b19wb3J0cyhlbmNvZGVyKTsKPiA+ICAgfQo+ID4gQEAgLTMzNjgs
NyArMzM2OCw3IEBAIHZvaWQgaW50ZWxfZGRpX2ZkaV9wb3N0X2Rpc2FibGUoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqb2xkX2NydGNfc3RhdGUsCj4gPiAgIAkJCQljb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAg
IAl1MzIgdmFsOwo+ID4gICAJLyoKPiA+IEBAIC0zNDAyLDExICszNDAyLDExIEBAIHN0YXRpYyB2
b2lkIGludGVsX2VuYWJsZV9kZGlfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
PiAgIAkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAg
CQkJCWNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9
IGVuY190b19pbnRlbF9kcCgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9
IGVuY29kZXItPnBvcnQ7Cj4gPiAtCWlmIChwb3J0ID09IFBPUlRfQSAmJiBJTlRFTF9HRU4oZGV2
X3ByaXYpIDwgOSkKPiA+ICsJaWYgKHBvcnQgPT0gUE9SVF9BICYmIElOVEVMX0dFTihpOTE1KSA8
IDkpCj4gPiAgIAkJaW50ZWxfZHBfc3RvcF9saW5rX3RyYWluKGludGVsX2RwKTsKPiA+ICAgCWlu
dGVsX2VkcF9iYWNrbGlnaHRfb24oY3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSk7Cj4gPiBAQCAtMzQx
OSw3ICszNDE5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2RkaV9kcChzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgfQo+ID4gICBzdGF0aWMgaTkxNV9yZWdfdAo+ID4g
LWdlbjlfY2hpY2tlbl90cmFuc19yZWdfYnlfcG9ydChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiArZ2VuOV9jaGlja2VuX3RyYW5zX3JlZ19ieV9wb3J0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgICAgZW51bSBwb3J0IHBvcnQpCj4gPiAg
IHsKPiA+ICAgCXN0YXRpYyBjb25zdCBpOTE1X3JlZ190IHJlZ3NbXSA9IHsKPiA+IEBAIC0zNDMw
LDcgKzM0MzAsNyBAQCBnZW45X2NoaWNrZW5fdHJhbnNfcmVnX2J5X3BvcnQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCVtQT1JUX0VdID0gQ0hJQ0tFTl9UUkFOU19B
LAo+ID4gICAJfTsKPiA+IC0JV0FSTl9PTihJTlRFTF9HRU4oZGV2X3ByaXYpIDwgOSk7Cj4gPiAr
CVdBUk5fT04oSU5URUxfR0VOKGk5MTUpIDwgOSk7Cj4gPiAgIAlpZiAoV0FSTl9PTihwb3J0IDwg
UE9SVF9BIHx8IHBvcnQgPiBQT1JUX0UpKQo+ID4gICAJCXBvcnQgPSBQT1JUX0E7Cj4gPiBAQCAt
MzQ0Miw3ICszNDQyLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2RkaV9oZG1pKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJCSAgY29uc3Qgc3RydWN0IGRybV9jb25u
ZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGVuY190b19kaWdfcG9y
dCgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9y
ID0gY29ubl9zdGF0ZS0+Y29ubmVjdG9yOwo+ID4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVy
LT5wb3J0Owo+ID4gQEAgLTM0NTQsMTQgKzM0NTQsMTQgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5h
YmxlX2RkaV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkgIGNv
bm5lY3Rvci0+YmFzZS5pZCwgY29ubmVjdG9yLT5uYW1lKTsKPiA+ICAgCS8qIERpc3BsYXkgV0Eg
IzExNDM6IHNrbCxrYmwsY2ZsICovCj4gPiAtCWlmIChJU19HRU45X0JDKGRldl9wcml2KSkgewo+
ID4gKwlpZiAoSVNfR0VOOV9CQyhpOTE1KSkgewo+ID4gICAJCS8qCj4gPiAgIAkJICogRm9yIHNv
bWUgcmVhc29uIHRoZXNlIGNoaWNrZW4gYml0cyBoYXZlIGJlZW4KPiA+ICAgCQkgKiBzdHVmZmVk
IGludG8gYSB0cmFuc2NvZGVyIHJlZ2lzdGVyLCBldmVudCB0aG91Z2gKPiA+ICAgCQkgKiB0aGUg
Yml0cyBhZmZlY3QgYSBzcGVjaWZpYyBEREkgcG9ydCByYXRoZXIgdGhhbgo+ID4gICAJCSAqIGEg
c3BlY2lmaWMgdHJhbnNjb2Rlci4KPiA+ICAgCQkgKi8KPiA+IC0JCWk5MTVfcmVnX3QgcmVnID0g
Z2VuOV9jaGlja2VuX3RyYW5zX3JlZ19ieV9wb3J0KGRldl9wcml2LCBwb3J0KTsKPiA+ICsJCWk5
MTVfcmVnX3QgcmVnID0gZ2VuOV9jaGlja2VuX3RyYW5zX3JlZ19ieV9wb3J0KGk5MTUsIHBvcnQp
Owo+ID4gICAJCXUzMiB2YWw7Cj4gPiAgIAkJdmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4gPiBAQCAt
MzU5NSw5ICszNTk1LDkgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX3NldF9maWFfbGFuZV9jb3Vu
dChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCQkgY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ID4gICAJCQkJCSBlbnVtIHBvcnQgcG9y
dCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmRpZ19wb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiA+
IC0JZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0X3RvX3RjKGRldl9wcml2LCBwb3J0
KTsKPiA+ICsJZW51bSB0Y19wb3J0IHRjX3BvcnQgPSBpbnRlbF9wb3J0X3RvX3RjKGk5MTUsIHBv
cnQpOwo+ID4gICAJdTMyIHZhbCA9IEk5MTVfUkVBRChQT1JUX1RYX0RGTEVYRFBNTEUxKTsKPiA+
ICAgCWJvb2wgbGFuZV9yZXZlcnNhbCA9IGRpZ19wb3J0LT5zYXZlZF9wb3J0X2JpdHMgJiBERElf
QlVGX1BPUlRfUkVWRVJTQUw7Cj4gPiBAQCAtMzYyNSwxNiArMzYyNSwxNiBAQCBpbnRlbF9kZGlf
cHJlX3BsbF9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSBj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJIGNvbnN0
IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQg
PSBlbmNfdG9fZGlnX3BvcnQoJmVuY29kZXItPmJhc2UpOwo+ID4gICAJZW51bSBwb3J0IHBvcnQg
PSBlbmNvZGVyLT5wb3J0Owo+ID4gICAJaWYgKGludGVsX2NydGNfaGFzX2RwX2VuY29kZXIoY3J0
Y19zdGF0ZSkgfHwKPiA+IC0JICAgIGludGVsX3BvcnRfaXNfdGMoZGV2X3ByaXYsIGVuY29kZXIt
PnBvcnQpKQo+ID4gLQkJaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsCj4gPiArCSAg
ICBpbnRlbF9wb3J0X2lzX3RjKGk5MTUsIGVuY29kZXItPnBvcnQpKQo+ID4gKwkJaW50ZWxfZGlz
cGxheV9wb3dlcl9nZXQoaTkxNSwKPiA+ICAgCQkJCQlpbnRlbF9kZGlfbWFpbl9saW5rX2F1eF9k
b21haW4oZGlnX3BvcnQpKTsKPiA+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ID4gKwlp
ZiAoSVNfR0VOOV9MUChpOTE1KSkKPiA+ICAgCQlieHRfZGRpX3BoeV9zZXRfbGFuZV9vcHRpbV9t
YXNrKGVuY29kZXIsCj4gPiAgIAkJCQkJCWNydGNfc3RhdGUtPmxhbmVfbGF0X29wdGltX21hc2sp
Owo+ID4gQEAgLTM2NTQsMTkgKzM2NTQsMTkgQEAgaW50ZWxfZGRpX3Bvc3RfcGxsX2Rpc2FibGUo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkgICBjb25zdCBzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZW5jX3RvX2Rp
Z19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWlmIChpbnRlbF9jcnRjX2hhc19kcF9lbmNv
ZGVyKGNydGNfc3RhdGUpIHx8Cj4gPiAtCSAgICBpbnRlbF9wb3J0X2lzX3RjKGRldl9wcml2LCBl
bmNvZGVyLT5wb3J0KSkKPiA+IC0JCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChk
ZXZfcHJpdiwKPiA+ICsJICAgIGludGVsX3BvcnRfaXNfdGMoaTkxNSwgZW5jb2Rlci0+cG9ydCkp
Cj4gPiArCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF91bmNoZWNrZWQoaTkxNSwKPiA+ICAgCQkJ
CQkJICBpbnRlbF9kZGlfbWFpbl9saW5rX2F1eF9kb21haW4oZGlnX3BvcnQpKTsKPiA+ICAgfQo+
ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfcHJlcGFyZV9saW5rX3JldHJhaW4oc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9y
dCAqaW50ZWxfZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0KPiA+ICAgCQl0b19pOTE1KGludGVsX2RpZ19wb3J0LT5iYXNlLmJhc2UuZGV2
KTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKPiA+
ICAgCXUzMiB2YWw7Cj4gPiBAQCAtMzY4Nyw3ICszNjg3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxf
ZGRpX3ByZXBhcmVfbGlua19yZXRyYWluKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAg
IAkJUE9TVElOR19SRUFEKERQX1RQX0NUTChwb3J0KSk7Cj4gPiAgIAkJaWYgKHdhaXQpCj4gPiAt
CQkJaW50ZWxfd2FpdF9kZGlfYnVmX2lkbGUoZGV2X3ByaXYsIHBvcnQpOwo+ID4gKwkJCWludGVs
X3dhaXRfZGRpX2J1Zl9pZGxlKGk5MTUsIHBvcnQpOwo+ID4gICAJfQo+ID4gICAJdmFsID0gRFBf
VFBfQ1RMX0VOQUJMRSB8Cj4gPiBAQCAtMzcwOSwzMiArMzcwOSwzMiBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9kZGlfcHJlcGFyZV9saW5rX3JldHJhaW4oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkK
PiA+ICAgCXVkZWxheSg2MDApOwo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wgaW50ZWxfZGRpX2lz
X2F1ZGlvX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0
YXRpYyBib29sIGludGVsX2RkaV9pc19hdWRpb19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgIGVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2Rl
cikKPiA+ICAgewo+ID4gICAJaWYgKGNwdV90cmFuc2NvZGVyID09IFRSQU5TQ09ERVJfRURQKQo+
ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IC0JaWYgKCFpbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2Vu
YWJsZWQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9BVURJTykpCj4gPiArCWlmICghaW50ZWxfZGlz
cGxheV9wb3dlcl9pc19lbmFibGVkKGk5MTUsIFBPV0VSX0RPTUFJTl9BVURJTykpCj4gPiAgIAkJ
cmV0dXJuIGZhbHNlOwo+ID4gICAJcmV0dXJuIEk5MTVfUkVBRChIU1dfQVVEX1BJTl9FTERfQ1Bf
VkxEKSAmCj4gPiAgIAkJQVVESU9fT1VUUFVUX0VOQUJMRShjcHVfdHJhbnNjb2Rlcik7Cj4gPiAg
IH0KPiA+IC12b2lkIGludGVsX2RkaV9jb21wdXRlX21pbl92b2x0YWdlX2xldmVsKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2RkaV9jb21wdXRlX21p
bl92b2x0YWdlX2xldmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJ
CSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSAmJiBjcnRjX3N0YXRlLT5wb3J0X2Nsb2NrID4gNTk0
MDAwKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExICYmIGNydGNfc3RhdGUtPnBvcnRf
Y2xvY2sgPiA1OTQwMDApCj4gPiAgIAkJY3J0Y19zdGF0ZS0+bWluX3ZvbHRhZ2VfbGV2ZWwgPSAx
Owo+ID4gLQllbHNlIGlmIChJU19DQU5OT05MQUtFKGRldl9wcml2KSAmJiBjcnRjX3N0YXRlLT5w
b3J0X2Nsb2NrID4gNTk0MDAwKQo+ID4gKwllbHNlIGlmIChJU19DQU5OT05MQUtFKGk5MTUpICYm
IGNydGNfc3RhdGUtPnBvcnRfY2xvY2sgPiA1OTQwMDApCj4gPiAgIAkJY3J0Y19zdGF0ZS0+bWlu
X3ZvbHRhZ2VfbGV2ZWwgPSAyOwo+ID4gICB9Cj4gPiAgIHZvaWQgaW50ZWxfZGRpX2dldF9jb25m
aWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ID4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVf
Y29uZmlnLT5iYXNlLmNydGMpOwo+ID4gICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVy
ID0gcGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVyOwo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0
YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQ7Cj4gPiBAQCAtMzgxNiwxMCArMzgxNiwxMCBAQCB2b2lk
IGludGVsX2RkaV9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4g
ICAJfQo+ID4gICAJcGlwZV9jb25maWctPmhhc19hdWRpbyA9Cj4gPiAtCQlpbnRlbF9kZGlfaXNf
YXVkaW9fZW5hYmxlZChkZXZfcHJpdiwgY3B1X3RyYW5zY29kZXIpOwo+ID4gKwkJaW50ZWxfZGRp
X2lzX2F1ZGlvX2VuYWJsZWQoaTkxNSwgY3B1X3RyYW5zY29kZXIpOwo+ID4gLQlpZiAoZW5jb2Rl
ci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQICYmIGRldl9wcml2LT52YnQuZWRwLmJwcCAmJgo+
ID4gLQkgICAgcGlwZV9jb25maWctPnBpcGVfYnBwID4gZGV2X3ByaXYtPnZidC5lZHAuYnBwKSB7
Cj4gPiArCWlmIChlbmNvZGVyLT50eXBlID09IElOVEVMX09VVFBVVF9FRFAgJiYgaTkxNS0+dmJ0
LmVkcC5icHAgJiYKPiA+ICsJICAgIHBpcGVfY29uZmlnLT5waXBlX2JwcCA+IGk5MTUtPnZidC5l
ZHAuYnBwKSB7Cj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBUaGlzIGlzIGEgYmlnIGZhdCB1Z2x5IGhh
Y2suCj4gPiAgIAkJICoKPiA+IEBAIC0zODM0LDE3ICszODM0LDE3IEBAIHZvaWQgaW50ZWxfZGRp
X2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJICogbG9h
ZC4KPiA+ICAgCQkgKi8KPiA+ICAgCQlEUk1fREVCVUdfS01TKCJwaXBlIGhhcyAlZCBicHAgZm9y
IGVEUCBwYW5lbCwgb3ZlcnJpZGluZyBCSU9TLXByb3ZpZGVkIG1heCAlZCBicHBcbiIsCj4gPiAt
CQkJICAgICAgcGlwZV9jb25maWctPnBpcGVfYnBwLCBkZXZfcHJpdi0+dmJ0LmVkcC5icHApOwo+
ID4gLQkJZGV2X3ByaXYtPnZidC5lZHAuYnBwID0gcGlwZV9jb25maWctPnBpcGVfYnBwOwo+ID4g
KwkJCSAgICAgIHBpcGVfY29uZmlnLT5waXBlX2JwcCwgaTkxNS0+dmJ0LmVkcC5icHApOwo+ID4g
KwkJaTkxNS0+dmJ0LmVkcC5icHAgPSBwaXBlX2NvbmZpZy0+cGlwZV9icHA7Cj4gPiAgIAl9Cj4g
PiAgIAlpbnRlbF9kZGlfY2xvY2tfZ2V0KGVuY29kZXIsIHBpcGVfY29uZmlnKTsKPiA+IC0JaWYg
KElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiA+ICAg
CQlwaXBlX2NvbmZpZy0+bGFuZV9sYXRfb3B0aW1fbWFzayA9Cj4gPiAgIAkJCWJ4dF9kZGlfcGh5
X2dldF9sYW5lX2xhdF9vcHRpbV9tYXNrKGVuY29kZXIpOwo+ID4gLQlpbnRlbF9kZGlfY29tcHV0
ZV9taW5fdm9sdGFnZV9sZXZlbChkZXZfcHJpdiwgcGlwZV9jb25maWcpOwo+ID4gKwlpbnRlbF9k
ZGlfY29tcHV0ZV9taW5fdm9sdGFnZV9sZXZlbChpOTE1LCBwaXBlX2NvbmZpZyk7Cj4gPiAgIAlp
bnRlbF9oZG1pX3JlYWRfZ2NwX2luZm9mcmFtZShlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gPiBA
QCAtMzg4NSwxMSArMzg4NSwxMSBAQCBzdGF0aWMgaW50IGludGVsX2RkaV9jb21wdXRlX2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCSAgICBzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsK
PiA+ICAgCWludCByZXQ7Cj4gPiAtCWlmIChIQVNfVFJBTlNDT0RFUl9FRFAoZGV2X3ByaXYpICYm
IHBvcnQgPT0gUE9SVF9BKQo+ID4gKwlpZiAoSEFTX1RSQU5TQ09ERVJfRURQKGk5MTUpICYmIHBv
cnQgPT0gUE9SVF9BKQo+ID4gICAJCXBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlciA9IFRSQU5T
Q09ERVJfRURQOwo+ID4gICAJaWYgKGludGVsX2NydGNfaGFzX3R5cGUocGlwZV9jb25maWcsIElO
VEVMX09VVFBVVF9IRE1JKSkKPiA+IEBAIC0zODk5LDE3ICszODk5LDE3IEBAIHN0YXRpYyBpbnQg
aW50ZWxfZGRpX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ID4gICAJaWYgKHJldCkKPiA+ICAgCQlyZXR1cm4gcmV0Owo+ID4gLQlpZiAoSVNfSEFTV0VMTChk
ZXZfcHJpdikgJiYgY3J0Yy0+cGlwZSA9PSBQSVBFX0EgJiYKPiA+ICsJaWYgKElTX0hBU1dFTEwo
aTkxNSkgJiYgY3J0Yy0+cGlwZSA9PSBQSVBFX0EgJiYKPiA+ICAgCSAgICBwaXBlX2NvbmZpZy0+
Y3B1X3RyYW5zY29kZXIgPT0gVFJBTlNDT0RFUl9FRFApCj4gPiAgIAkJcGlwZV9jb25maWctPnBj
aF9wZml0LmZvcmNlX3RocnUgPQo+ID4gICAJCQlwaXBlX2NvbmZpZy0+cGNoX3BmaXQuZW5hYmxl
ZCB8fAo+ID4gICAJCQlwaXBlX2NvbmZpZy0+Y3JjX2VuYWJsZWQ7Cj4gPiAtCWlmIChJU19HRU45
X0xQKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gPiAgIAkJcGlwZV9j
b25maWctPmxhbmVfbGF0X29wdGltX21hc2sgPQo+ID4gICAJCQlieHRfZGRpX3BoeV9jYWxjX2xh
bmVfbGF0X29wdGltX21hc2socGlwZV9jb25maWctPmxhbmVfY291bnQpOwo+ID4gLQlpbnRlbF9k
ZGlfY29tcHV0ZV9taW5fdm9sdGFnZV9sZXZlbChkZXZfcHJpdiwgcGlwZV9jb25maWcpOwo+ID4g
KwlpbnRlbF9kZGlfY29tcHV0ZV9taW5fdm9sdGFnZV9sZXZlbChpOTE1LCBwaXBlX2NvbmZpZyk7
Cj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4gQEAgLTQwMTMsMTEgKzQwMTMsMTEgQEAgc3Rh
dGljIGludCBtb2Rlc2V0X3BpcGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ID4gICBzdGF0aWMg
aW50IGludGVsX2hkbWlfcmVzZXRfbGluayhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiA+ICAgCQkJCSBzdHJ1Y3QgZHJtX21vZGVzZXRfYWNxdWlyZV9jdHggKmN0eCkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICpoZG1pID0gZW5j
X3RvX2ludGVsX2hkbWkoJmVuY29kZXItPmJhc2UpOwo+ID4gICAJc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yID0gaGRtaS0+YXR0YWNoZWRfY29ubmVjdG9yOwo+ID4gICAJc3RydWN0
IGkyY19hZGFwdGVyICphZGFwdGVyID0KPiA+IC0JCWludGVsX2dtYnVzX2dldF9hZGFwdGVyKGRl
dl9wcml2LCBoZG1pLT5kZGNfYnVzKTsKPiA+ICsJCWludGVsX2dtYnVzX2dldF9hZGFwdGVyKGk5
MTUsIGhkbWktPmRkY19idXMpOwo+ID4gICAJc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNv
bm5fc3RhdGU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ID4gQEAgLTQwMjcsNyArNDAyNyw3IEBAIHN0
YXRpYyBpbnQgaW50ZWxfaGRtaV9yZXNldF9saW5rKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAo+ID4gICAJaWYgKCFjb25uZWN0b3IgfHwgY29ubmVjdG9yLT5iYXNlLnN0YXR1cyAhPSBj
b25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZCkKPiA+ICAgCQlyZXR1cm4gMDsKPiA+IC0JcmV0ID0g
ZHJtX21vZGVzZXRfbG9jaygmZGV2X3ByaXYtPmRybS5tb2RlX2NvbmZpZy5jb25uZWN0aW9uX211
dGV4LAo+ID4gKwlyZXQgPSBkcm1fbW9kZXNldF9sb2NrKCZpOTE1LT5kcm0ubW9kZV9jb25maWcu
Y29ubmVjdGlvbl9tdXRleCwKPiA+ICAgCQkJICAgICAgIGN0eCk7Cj4gPiAgIAlpZiAocmV0KQo+
ID4gICAJCXJldHVybiByZXQ7Cj4gPiBAQCAtNDEzMSw3ICs0MTMxLDcgQEAgaW50ZWxfZGRpX2lu
aXRfaGRtaV9jb25uZWN0b3Ioc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3Bv
cnQpCj4gPiAgIHN0YXRpYyBib29sIGludGVsX2RkaV9hX2ZvcmNlXzRfbGFuZXMoc3RydWN0IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkcG9ydC0+YmFzZS5iYXNlLmRl
dik7Cj4gPiAgIAlpZiAoZHBvcnQtPmJhc2UucG9ydCAhPSBQT1JUX0EpCj4gPiAgIAkJcmV0dXJu
IGZhbHNlOwo+ID4gQEAgLTQxNDIsNyArNDE0Miw3IEBAIHN0YXRpYyBib29sIGludGVsX2RkaV9h
X2ZvcmNlXzRfbGFuZXMoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQpCj4gPiAgIAkv
KiBCcm94dG9uL0dlbWluaWxha2U6IEJzcGVjIHNheXMgdGhhdCBERElfQV80X0xBTkVTIGlzIHRo
ZSBvbmx5Cj4gPiAgIAkgKiAgICAgICAgICAgICAgICAgICAgIHN1cHBvcnRlZCBjb25maWd1cmF0
aW9uCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ID4gKwlpZiAo
SVNfR0VOOV9MUChpOTE1KSkKPiA+ICAgCQlyZXR1cm4gdHJ1ZTsKPiA+ICAgCS8qIENhbm5vbmxh
a2U6IE1vc3Qgb2YgU0tVcyBkb24ndCBzdXBwb3J0IERESV9FLCBhbmQgdGhlIG9ubHkKPiA+IEBA
IC00MTUwLDggKzQxNTAsOCBAQCBzdGF0aWMgYm9vbCBpbnRlbF9kZGlfYV9mb3JjZV80X2xhbmVz
KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRwb3J0KQo+ID4gICAJICogICAgICAgICAgICAg
RERJX0Ygd2hhdCBtYWtlcyBERElfRSB1c2VsZXNzLiBIb3dldmVyIGZvciB0aGlzCj4gPiAgIAkg
KiAgICAgICAgICAgICBjYXNlIGxldCdzIHRydXN0IFZCVCBpbmZvLgo+ID4gICAJICovCj4gPiAt
CWlmIChJU19DQU5OT05MQUtFKGRldl9wcml2KSAmJgo+ID4gLQkgICAgIWludGVsX2Jpb3NfaXNf
cG9ydF9wcmVzZW50KGRldl9wcml2LCBQT1JUX0UpKQo+ID4gKwlpZiAoSVNfQ0FOTk9OTEFLRShp
OTE1KSAmJgo+ID4gKwkgICAgIWludGVsX2Jpb3NfaXNfcG9ydF9wcmVzZW50KGk5MTUsIFBPUlRf
RSkpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAgIAlyZXR1cm4gZmFsc2U7Cj4gPiBAQCAtNDE2
MCwxMSArNDE2MCwxMSBAQCBzdGF0aWMgYm9vbCBpbnRlbF9kZGlfYV9mb3JjZV80X2xhbmVzKHN0
cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRwb3J0KQo+ID4gICBzdGF0aWMgaW50Cj4gPiAgIGlu
dGVsX2RkaV9tYXhfbGFuZXMoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZHBvcnQp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShpbnRlbF9kcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShpbnRlbF9kcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gPiAgIAll
bnVtIHBvcnQgcG9ydCA9IGludGVsX2Rwb3J0LT5iYXNlLnBvcnQ7Cj4gPiAgIAlpbnQgbWF4X2xh
bmVzID0gNDsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gPiAgIAkJcmV0dXJuIG1heF9sYW5lczsKPiA+ICAgCWlm
IChwb3J0ID09IFBPUlRfQSB8fCBwb3J0ID09IFBPUlRfRSkgewo+ID4gQEAgLTQxODksMTAgKzQx
ODksMTAgQEAgaW50ZWxfZGRpX21heF9sYW5lcyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpp
bnRlbF9kcG9ydCkKPiA+ICAgCXJldHVybiBtYXhfbGFuZXM7Cj4gPiAgIH0KPiA+IC12b2lkIGlu
dGVsX2RkaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0
IHBvcnQpCj4gPiArdm9pZCBpbnRlbF9kZGlfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwgZW51bSBwb3J0IHBvcnQpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkZGlfdmJ0X3BvcnRf
aW5mbyAqcG9ydF9pbmZvID0KPiA+IC0JCSZkZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9bcG9y
dF07Cj4gPiArCQkmaTkxNS0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF07Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydDsKPiA+ICAgCXN0cnVjdCBpbnRlbF9l
bmNvZGVyICppbnRlbF9lbmNvZGVyOwo+ID4gICAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVy
Owo+ID4gQEAgLTQyMDIsNyArNDIwMiw3IEBAIHZvaWQgaW50ZWxfZGRpX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgCWluaXRfaGRt
aSA9IHBvcnRfaW5mby0+c3VwcG9ydHNfZHZpIHx8IHBvcnRfaW5mby0+c3VwcG9ydHNfaGRtaTsK
PiA+ICAgCWluaXRfZHAgPSBwb3J0X2luZm8tPnN1cHBvcnRzX2RwOwo+ID4gLQlpZiAoaW50ZWxf
Ymlvc19pc19sc3Bjb25fcHJlc2VudChkZXZfcHJpdiwgcG9ydCkpIHsKPiA+ICsJaWYgKGludGVs
X2Jpb3NfaXNfbHNwY29uX3ByZXNlbnQoaTkxNSwgcG9ydCkpIHsKPiA+ICAgCQkvKgo+ID4gICAJ
CSAqIExzcGNvbiBkZXZpY2UgbmVlZHMgdG8gYmUgZHJpdmVuIHdpdGggRFAgY29ubmVjdG9yCj4g
PiAgIAkJICogd2l0aCBzcGVjaWFsIGRldGVjdGlvbiBzZXF1ZW5jZS4gU28gbWFrZSBzdXJlIERQ
Cj4gPiBAQCAtNDIyNyw3ICs0MjI3LDcgQEAgdm9pZCBpbnRlbF9kZGlfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KQo+ID4gICAJaW50ZWxfZW5j
b2RlciA9ICZpbnRlbF9kaWdfcG9ydC0+YmFzZTsKPiA+ICAgCWVuY29kZXIgPSAmaW50ZWxfZW5j
b2Rlci0+YmFzZTsKPiA+IC0JZHJtX2VuY29kZXJfaW5pdCgmZGV2X3ByaXYtPmRybSwgZW5jb2Rl
ciwgJmludGVsX2RkaV9mdW5jcywKPiA+ICsJZHJtX2VuY29kZXJfaW5pdCgmaTkxNS0+ZHJtLCBl
bmNvZGVyLCAmaW50ZWxfZGRpX2Z1bmNzLAo+ID4gICAJCQkgRFJNX01PREVfRU5DT0RFUl9UTURT
LCAiRERJICVjIiwgcG9ydF9uYW1lKHBvcnQpKTsKPiA+ICAgCWludGVsX2VuY29kZXItPmhvdHBs
dWcgPSBpbnRlbF9kZGlfaG90cGx1ZzsKPiA+IEBAIC00MjQ4LDEwICs0MjQ4LDEwIEBAIHZvaWQg
aW50ZWxfZGRpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBv
cnQgcG9ydCkKPiA+ICAgCWludGVsX2VuY29kZXItPnBvd2VyX2RvbWFpbiA9IGludGVsX3BvcnRf
dG9fcG93ZXJfZG9tYWluKHBvcnQpOwo+ID4gICAJaW50ZWxfZW5jb2Rlci0+cG9ydCA9IHBvcnQ7
Cj4gPiAgIAlpbnRlbF9lbmNvZGVyLT5jbG9uZWFibGUgPSAwOwo+ID4gLQlmb3JfZWFjaF9waXBl
KGRldl9wcml2LCBwaXBlKQo+ID4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpCj4gPiAgIAkJ
aW50ZWxfZW5jb2Rlci0+Y3J0Y19tYXNrIHw9IEJJVChwaXBlKTsKPiA+IC0JaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gMTEpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gPiAg
IAkJaW50ZWxfZGlnX3BvcnQtPnNhdmVkX3BvcnRfYml0cyA9IEk5MTVfUkVBRChERElfQlVGX0NU
TChwb3J0KSkgJgo+ID4gICAJCQlERElfQlVGX1BPUlRfUkVWRVJTQUw7Cj4gPiAgIAllbHNlCj4g
PiBAQCAtNDI1OSw5ICs0MjU5LDkgQEAgdm9pZCBpbnRlbF9kZGlfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KQo+ID4gICAJCQkoRERJX0JVRl9Q
T1JUX1JFVkVSU0FMIHwgRERJX0FfNF9MQU5FUyk7Cj4gPiAgIAlpbnRlbF9kaWdfcG9ydC0+ZHAu
b3V0cHV0X3JlZyA9IElOVkFMSURfTU1JT19SRUc7Cj4gPiAgIAlpbnRlbF9kaWdfcG9ydC0+bWF4
X2xhbmVzID0gaW50ZWxfZGRpX21heF9sYW5lcyhpbnRlbF9kaWdfcG9ydCk7Cj4gPiAtCWludGVs
X2RpZ19wb3J0LT5hdXhfY2ggPSBpbnRlbF9iaW9zX3BvcnRfYXV4X2NoKGRldl9wcml2LCBwb3J0
KTsKPiA+ICsJaW50ZWxfZGlnX3BvcnQtPmF1eF9jaCA9IGludGVsX2Jpb3NfcG9ydF9hdXhfY2go
aTkxNSwgcG9ydCk7Cj4gPiAtCWludGVsX2RpZ19wb3J0LT50Y19sZWdhY3lfcG9ydCA9IGludGVs
X3BvcnRfaXNfdGMoZGV2X3ByaXYsIHBvcnQpICYmCj4gPiArCWludGVsX2RpZ19wb3J0LT50Y19s
ZWdhY3lfcG9ydCA9IGludGVsX3BvcnRfaXNfdGMoaTkxNSwgcG9ydCkgJiYKPiA+ICAgCQkJCQkg
IXBvcnRfaW5mby0+c3VwcG9ydHNfdHlwZWNfdXNiICYmCj4gPiAgIAkJCQkJICFwb3J0X2luZm8t
PnN1cHBvcnRzX3RidDsKPiA+IEBAIC00MzI0LDcgKzQzMjQsNyBAQCB2b2lkIGludGVsX2RkaV9p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpCj4g
PiAgIAlpbnRlbF9pbmZvZnJhbWVfaW5pdChpbnRlbF9kaWdfcG9ydCk7Cj4gPiAtCWlmIChpbnRl
bF9wb3J0X2lzX3RjKGRldl9wcml2LCBwb3J0KSkKPiA+ICsJaWYgKGludGVsX3BvcnRfaXNfdGMo
aTkxNSwgcG9ydCkpCj4gPiAgIAkJaW50ZWxfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChpbnRlbF9l
bmNvZGVyKTsKPiA+ICAgCXJldHVybjsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kZGkuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RkaS5oCj4gPiBp
bmRleCBhMDgzNjVkYTI2NDMuLjUwZGQ2ZmFjNGUzYiAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2RkaS5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9kZGkuaAo+ID4gQEAgLTI0LDcgKzI0LDcgQEAgdm9pZCBpbnRlbF9kZGlfZmRpX3Bvc3Rf
ZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKPiA+ICAgCQkJCWNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSk7Cj4gPiAgIHZv
aWQgaHN3X2ZkaV9saW5rX3RyYWluKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQlj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gPiAtdm9pZCBpbnRl
bF9kZGlfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBw
b3J0KTsKPiA+ICt2b2lkIGludGVsX2RkaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBlbnVtIHBvcnQgcG9ydCk7Cj4gPiAgIGJvb2wgaW50ZWxfZGRpX2dldF9od19zdGF0ZShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwgZW51bSBwaXBlICpwaXBlKTsKPiA+ICAgdm9p
ZCBpbnRlbF9kZGlfZW5hYmxlX3RyYW5zY29kZXJfZnVuYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gPiAgIHZvaWQgaW50ZWxfZGRpX2Rpc2FibGVfdHJhbnNj
b2Rlcl9mdW5jKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKPiA+
IEBAIC0zNiw3ICszNiw3IEBAIHZvaWQgaW50ZWxfZGRpX2dldF9jb25maWcoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBp
cGVfY29uZmlnKTsKPiA+ICAgdm9pZCBpbnRlbF9kZGlfc2V0X3ZjX3BheWxvYWRfYWxsb2MoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQkgICAgYm9v
bCBzdGF0ZSk7Cj4gPiAtdm9pZCBpbnRlbF9kZGlfY29tcHV0ZV9taW5fdm9sdGFnZV9sZXZlbChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpbnRlbF9kZGlfY29t
cHV0ZV9taW5fdm9sdGFnZV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+
ICAgCQkJCQkgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+ID4gICB1MzIg
Ynh0X3NpZ25hbF9sZXZlbHMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCk7Cj4gPiAgIHUzMiBk
ZGlfc2lnbmFsX2xldmVscyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsKPiA+IEBAIC00Niw3
ICs0Niw3IEBAIHU4IGludGVsX2RkaV9kcF9wcmVfZW1waGFzaXNfbWF4KHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ID4gICBpbnQgaW50ZWxfZGRpX3RvZ2dsZV9oZGNwX3NpZ25hbGxp
bmcoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCj4gPiAgIAkJCQkgICAgIGJv
b2wgZW5hYmxlKTsKPiA+ICAgdm9pZCBpY2xfc2FuaXRpemVfZW5jb2Rlcl9wbGxfbWFwcGluZyhz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rlcik7Cj4gPiAtaW50IGNubF9jYWxjX3dycGxsX2xp
bmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2ludCBjbmxfY2FsY193
cnBsbF9saW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQlzdHJ1Y3Qg
aW50ZWxfZHBsbF9od19zdGF0ZSAqc3RhdGUpOwo+ID4gICAjZW5kaWYgLyogX19JTlRFTF9ERElf
SF9fICovCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGV2aWNl
X2luZm8uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RldmljZV9pbmZvLmMKPiA+IGlu
ZGV4IDcxMzVkOGRjMzJhNy4uYTY3MDg4MWIzZjFlIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uYwo+ID4gQEAgLTE4MiwxNSArMTgyLDE1IEBAIHN0YXRp
YyB1MTYgY29tcHV0ZV9ldV90b3RhbChjb25zdCBzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSkK
PiA+ICAgCXJldHVybiB0b3RhbDsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGdlbjExX3NzZXVf
aW5mb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMg
dm9pZCBnZW4xMV9zc2V1X2luZm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSA9ICZSVU5USU1FX0lORk8o
ZGV2X3ByaXYpLT5zc2V1Owo+ID4gKwlzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSA9ICZSVU5U
SU1FX0lORk8oaTkxNSktPnNzZXU7Cj4gPiAgIAl1OCBzX2VuOwo+ID4gICAJdTMyIHNzX2VuLCBz
c19lbl9tYXNrOwo+ID4gICAJdTggZXVfZW47Cj4gPiAgIAlpbnQgczsKPiA+IC0JaWYgKElTX0VM
S0hBUlRMQUtFKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfRUxLSEFSVExBS0UoaTkxNSkpIHsK
PiA+ICAgCQlzc2V1LT5tYXhfc2xpY2VzID0gMTsKPiA+ICAgCQlzc2V1LT5tYXhfc3Vic2xpY2Vz
ID0gNDsKPiA+ICAgCQlzc2V1LT5tYXhfZXVzX3Blcl9zdWJzbGljZSA9IDg7Cj4gPiBAQCAtMjI3
LDkgKzIyNyw5IEBAIHN0YXRpYyB2b2lkIGdlbjExX3NzZXVfaW5mb19pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXNzZXUtPmhhc19ldV9wZyA9IDE7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCBnZW4xMF9zc2V1X2luZm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgZ2VuMTBfc3NldV9pbmZvX2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IHNzZXVf
ZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9JTkZPKGRldl9wcml2KS0+c3NldTsKPiA+ICsJc3Ry
dWN0IHNzZXVfZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9JTkZPKGk5MTUpLT5zc2V1Owo+ID4g
ICAJY29uc3QgdTMyIGZ1c2UyID0gSTkxNV9SRUFEKEdFTjhfRlVTRTIpOwo+ID4gICAJaW50IHMs
IHNzOwo+ID4gICAJY29uc3QgaW50IGV1X21hc2sgPSAweGZmOwo+ID4gQEAgLTMwNSw5ICszMDUs
OSBAQCBzdGF0aWMgdm9pZCBnZW4xMF9zc2V1X2luZm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlzc2V1LT5oYXNfZXVfcGcgPSAxOwo+ID4gICB9Cj4gPiAt
c3RhdGljIHZvaWQgY2hlcnJ5dmlld19zc2V1X2luZm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgY2hlcnJ5dmlld19zc2V1X2luZm9faW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qgc3Nl
dV9kZXZfaW5mbyAqc3NldSA9ICZSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1Owo+ID4gKwlz
dHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSA9ICZSVU5USU1FX0lORk8oaTkxNSktPnNzZXU7Cj4g
PiAgIAl1MzIgZnVzZTsKPiA+ICAgCWZ1c2UgPSBJOTE1X1JFQUQoQ0hWX0ZVU0VfR1QpOwo+ID4g
QEAgLTM1OSwxMCArMzU5LDEwIEBAIHN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfc3NldV9pbmZvX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJc3NldS0+aGFzX2V1
X3BnID0gKHNzZXUtPmV1X3Blcl9zdWJzbGljZSA+IDIpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgZ2VuOV9zc2V1X2luZm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiArc3RhdGljIHZvaWQgZ2VuOV9zc2V1X2luZm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfZGV2aWNlX2luZm8gKmluZm8g
PSBta3dyaXRlX2RldmljZV9pbmZvKGRldl9wcml2KTsKPiA+IC0Jc3RydWN0IHNzZXVfZGV2X2lu
Zm8gKnNzZXUgPSAmUlVOVElNRV9JTkZPKGRldl9wcml2KS0+c3NldTsKPiA+ICsJc3RydWN0IGlu
dGVsX2RldmljZV9pbmZvICppbmZvID0gbWt3cml0ZV9kZXZpY2VfaW5mbyhpOTE1KTsKPiA+ICsJ
c3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUgPSAmUlVOVElNRV9JTkZPKGk5MTUpLT5zc2V1Owo+
ID4gICAJaW50IHMsIHNzOwo+ID4gICAJdTMyIGZ1c2UyLCBldV9kaXNhYmxlLCBzdWJzbGljZV9t
YXNrOwo+ID4gICAJY29uc3QgdTggZXVfbWFzayA9IDB4ZmY7Cj4gPiBAQCAtMzcxLDggKzM3MSw4
IEBAIHN0YXRpYyB2b2lkIGdlbjlfc3NldV9pbmZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gICAJc3NldS0+c2xpY2VfbWFzayA9IChmdXNlMiAmIEdFTjhfRjJf
U19FTkFfTUFTSykgPj4gR0VOOF9GMl9TX0VOQV9TSElGVDsKPiA+ICAgCS8qIEJYVCBoYXMgYSBz
aW5nbGUgc2xpY2UgYW5kIGF0IG1vc3QgMyBzdWJzbGljZXMuICovCj4gPiAtCXNzZXUtPm1heF9z
bGljZXMgPSBJU19HRU45X0xQKGRldl9wcml2KSA/IDEgOiAzOwo+ID4gLQlzc2V1LT5tYXhfc3Vi
c2xpY2VzID0gSVNfR0VOOV9MUChkZXZfcHJpdikgPyAzIDogNDsKPiA+ICsJc3NldS0+bWF4X3Ns
aWNlcyA9IElTX0dFTjlfTFAoaTkxNSkgPyAxIDogMzsKPiA+ICsJc3NldS0+bWF4X3N1YnNsaWNl
cyA9IElTX0dFTjlfTFAoaTkxNSkgPyAzIDogNDsKPiA+ICAgCXNzZXUtPm1heF9ldXNfcGVyX3N1
YnNsaWNlID0gODsKPiA+ICAgCS8qCj4gPiBAQCAtNDQyLDEyICs0NDIsMTIgQEAgc3RhdGljIHZv
aWQgZ2VuOV9zc2V1X2luZm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAgIAkgKiBwYWlyIHBlciBzdWJzbGljZS4KPiA+ICAgCSovCj4gPiAgIAlzc2V1LT5oYXNf
c2xpY2VfcGcgPQo+ID4gLQkJIUlTX0dFTjlfTFAoZGV2X3ByaXYpICYmIGh3ZWlnaHQ4KHNzZXUt
PnNsaWNlX21hc2spID4gMTsKPiA+ICsJCSFJU19HRU45X0xQKGk5MTUpICYmIGh3ZWlnaHQ4KHNz
ZXUtPnNsaWNlX21hc2spID4gMTsKPiA+ICAgCXNzZXUtPmhhc19zdWJzbGljZV9wZyA9Cj4gPiAt
CQlJU19HRU45X0xQKGRldl9wcml2KSAmJiBpbnRlbF9zc2V1X3N1YnNsaWNlX3RvdGFsKHNzZXUp
ID4gMTsKPiA+ICsJCUlTX0dFTjlfTFAoaTkxNSkgJiYgaW50ZWxfc3NldV9zdWJzbGljZV90b3Rh
bChzc2V1KSA+IDE7Cj4gPiAgIAlzc2V1LT5oYXNfZXVfcGcgPSBzc2V1LT5ldV9wZXJfc3Vic2xp
Y2UgPiAyOwo+ID4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0dF
TjlfTFAoaTkxNSkpIHsKPiA+ICAgI2RlZmluZSBJU19TU19ESVNBQkxFRChzcykJKCEoc3NldS0+
c3Vic2xpY2VfbWFza1swXSAmIEJJVChzcykpKQo+ID4gICAJCWluZm8tPmhhc19wb29sZWRfZXUg
PSBod2VpZ2h0OChzc2V1LT5zdWJzbGljZV9tYXNrWzBdKSA9PSAzOwo+ID4gQEAgLTQ2NCw5ICs0
NjQsOSBAQCBzdGF0aWMgdm9pZCBnZW45X3NzZXVfaW5mb19pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICAgCX0KPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGJyb2Fk
d2VsbF9zc2V1X2luZm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiArc3RhdGljIHZvaWQgYnJvYWR3ZWxsX3NzZXVfaW5mb19pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1ID0g
JlJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPnNzZXU7Cj4gPiArCXN0cnVjdCBzc2V1X2Rldl9pbmZv
ICpzc2V1ID0gJlJVTlRJTUVfSU5GTyhpOTE1KS0+c3NldTsKPiA+ICAgCWludCBzLCBzczsKPiA+
ICAgCXUzMiBmdXNlMiwgc3Vic2xpY2VfbWFzaywgZXVfZGlzYWJsZVszXTsgLyogc19tYXggKi8K
PiA+IEBAIC01NDcsOSArNTQ3LDkgQEAgc3RhdGljIHZvaWQgYnJvYWR3ZWxsX3NzZXVfaW5mb19p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXNzZXUtPmhhc19l
dV9wZyA9IDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBoYXN3ZWxsX3NzZXVfaW5mb19pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBoYXN3
ZWxsX3NzZXVfaW5mb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1ID0gJlJVTlRJTUVfSU5GTyhkZXZfcHJp
diktPnNzZXU7Cj4gPiArCXN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1ID0gJlJVTlRJTUVfSU5G
TyhpOTE1KS0+c3NldTsKPiA+ICAgCXUzMiBmdXNlMTsKPiA+ICAgCWludCBzLCBzczsKPiA+IEBA
IC01NTcsOSArNTU3LDkgQEAgc3RhdGljIHZvaWQgaGFzd2VsbF9zc2V1X2luZm9faW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiBUaGVyZSBpc24ndCBhIHJl
Z2lzdGVyIHRvIHRlbGwgdXMgaG93IG1hbnkgc2xpY2VzL3N1YnNsaWNlcy4gV2UKPiA+ICAgCSAq
IHdvcmsgb2ZmIHRoZSBQQ0ktaWRzIGhlcmUuCj4gPiAgIAkgKi8KPiA+IC0Jc3dpdGNoIChJTlRF
TF9JTkZPKGRldl9wcml2KS0+Z3QpIHsKPiA+ICsJc3dpdGNoIChJTlRFTF9JTkZPKGk5MTUpLT5n
dCkgewo+ID4gICAJZGVmYXVsdDoKPiA+IC0JCU1JU1NJTkdfQ0FTRShJTlRFTF9JTkZPKGRldl9w
cml2KS0+Z3QpOwo+ID4gKwkJTUlTU0lOR19DQVNFKElOVEVMX0lORk8oaTkxNSktPmd0KTsKPiA+
ICAgCQkvKiBmYWxsIHRocm91Z2ggKi8KPiA+ICAgCWNhc2UgMToKPiA+ICAgCQlzc2V1LT5zbGlj
ZV9tYXNrID0gQklUKDApOwo+ID4gQEAgLTYxMiw3ICs2MTIsNyBAQCBzdGF0aWMgdm9pZCBoYXN3
ZWxsX3NzZXVfaW5mb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCXNzZXUtPmhhc19ldV9wZyA9IDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTMyIHJlYWRfcmVm
ZXJlbmNlX3RzX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0
YXRpYyB1MzIgcmVhZF9yZWZlcmVuY2VfdHNfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIHRzX292ZXJyaWRlID0gSTkxNV9SRUFEKEdFTjlfVElN
RVNUQU1QX09WRVJSSURFKTsKPiA+ICAgCXUzMiBiYXNlX2ZyZXEsIGZyYWNfZnJlcTsKPiA+IEBA
IC02MjksNyArNjI5LDcgQEAgc3RhdGljIHUzMiByZWFkX3JlZmVyZW5jZV90c19mcmVxKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXJldHVybiBiYXNlX2ZyZXEgKyBm
cmFjX2ZyZXE7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTMyIGdlbjEwX2dldF9jcnlzdGFsX2Nsb2Nr
X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB1MzIg
Z2VuMTBfZ2V0X2NyeXN0YWxfY2xvY2tfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICAgCQkJCQl1MzIgcnBtX2NvbmZpZ19yZWcpCj4gPiAgIHsKPiA+ICAgCXUzMiBmMTlf
Ml9taHogPSAxOTIwMDsKPiA+IEBAIC02NDksNyArNjQ5LDcgQEAgc3RhdGljIHUzMiBnZW4xMF9n
ZXRfY3J5c3RhbF9jbG9ja19mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICAgCX0KPiA+ICAgfQo+ID4gLXN0YXRpYyB1MzIgZ2VuMTFfZ2V0X2NyeXN0YWxfY2xvY2tf
ZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHUzMiBn
ZW4xMV9nZXRfY3J5c3RhbF9jbG9ja19mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ID4gICAJCQkJCXUzMiBycG1fY29uZmlnX3JlZykKPiA+ICAgewo+ID4gICAJdTMyIGYxOV8y
X21oeiA9IDE5MjAwOwo+ID4gQEAgLTY3NSwyMSArNjc1LDIxIEBAIHN0YXRpYyB1MzIgZ2VuMTFf
Z2V0X2NyeXN0YWxfY2xvY2tfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTMyIHJlYWRfdGltZXN0YW1wX2ZyZXF1ZW5j
eShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHUzMiByZWFk
X3RpbWVzdGFtcF9mcmVxdWVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAg
IHsKPiA+ICAgCXUzMiBmMTJfNV9taHogPSAxMjUwMDsKPiA+ICAgCXUzMiBmMTlfMl9taHogPSAx
OTIwMDsKPiA+ICAgCXUzMiBmMjRfbWh6ID0gMjQwMDA7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpIDw9IDQpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8PSA0KSB7Cj4gPiAgIAkJ
LyogUFJNcyBzYXk6Cj4gPiAgIAkJICoKPiA+ICAgCQkgKiAgICAgIlRoZSB2YWx1ZSBpbiB0aGlz
IHJlZ2lzdGVyIGluY3JlbWVudHMgb25jZSBldmVyeSAxNgo+ID4gICAJCSAqICAgICAgaGNsa3Mu
IiAodGhyb3VnaCB0aGUg4oCcQ2xvY2tpbmcgQ29uZmlndXJhdGlvbuKAnQo+ID4gICAJCSAqICAg
ICAgKOKAnENMS0NGR+KAnSkgTUNIQkFSIHJlZ2lzdGVyKQo+ID4gICAJCSAqLwo+ID4gLQkJcmV0
dXJuIGRldl9wcml2LT5yYXdjbGtfZnJlcSAvIDE2Owo+ID4gLQl9IGVsc2UgaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPD0gOCkgewo+ID4gKwkJcmV0dXJuIGk5MTUtPnJhd2Nsa19mcmVxIC8gMTY7
Cj4gPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDgpIHsKPiA+ICAgCQkvKiBQUk1z
IHNheToKPiA+ICAgCQkgKgo+ID4gICAJCSAqICAgICAiVGhlIFBDVSBUU0MgY291bnRzIDEwbnMg
aW5jcmVtZW50czsgdGhpcyB0aW1lc3RhbXAKPiA+IEBAIC02OTcsMTQgKzY5NywxNCBAQCBzdGF0
aWMgdTMyIHJlYWRfdGltZXN0YW1wX2ZyZXF1ZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiAgIAkJICogICAgICByb2xsaW5nIG92ZXIgZXZlcnkgMS41IGhvdXJzKS4K
PiA+ICAgCQkgKi8KPiA+ICAgCQlyZXR1cm4gZjEyXzVfbWh6Owo+ID4gLQl9IGVsc2UgaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPD0gOSkgewo+ID4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1
KSA8PSA5KSB7Cj4gPiAgIAkJdTMyIGN0Y19yZWcgPSBJOTE1X1JFQUQoQ1RDX01PREUpOwo+ID4g
ICAJCXUzMiBmcmVxID0gMDsKPiA+ICAgCQlpZiAoKGN0Y19yZWcgJiBDVENfU09VUkNFX1BBUkFN
RVRFUl9NQVNLKSA9PSBDVENfU09VUkNFX0RJVklERV9MT0dJQykgewo+ID4gLQkJCWZyZXEgPSBy
ZWFkX3JlZmVyZW5jZV90c19mcmVxKGRldl9wcml2KTsKPiA+ICsJCQlmcmVxID0gcmVhZF9yZWZl
cmVuY2VfdHNfZnJlcShpOTE1KTsKPiA+ICAgCQl9IGVsc2Ugewo+ID4gLQkJCWZyZXEgPSBJU19H
RU45X0xQKGRldl9wcml2KSA/IGYxOV8yX21oeiA6IGYyNF9taHo7Cj4gPiArCQkJZnJlcSA9IElT
X0dFTjlfTFAoaTkxNSkgPyBmMTlfMl9taHogOiBmMjRfbWh6Owo+ID4gICAJCQkvKiBOb3cgZmln
dXJlIG91dCBob3cgdGhlIGNvbW1hbmQgc3RyZWFtJ3MgdGltZXN0YW1wCj4gPiAgIAkJCSAqIHJl
Z2lzdGVyIGluY3JlbWVudHMgZnJvbSB0aGlzIGZyZXF1ZW5jeSAoaXQgbWlnaHQKPiA+IEBAIC03
MTUsNyArNzE1LDcgQEAgc3RhdGljIHUzMiByZWFkX3RpbWVzdGFtcF9mcmVxdWVuY3koc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCX0KPiA+ICAgCQlyZXR1cm4gZnJl
cTsKPiA+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDExKSB7Cj4gPiArCX0g
ZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDExKSB7Cj4gPiAgIAkJdTMyIGN0Y19yZWcgPSBJ
OTE1X1JFQUQoQ1RDX01PREUpOwo+ID4gICAJCXUzMiBmcmVxID0gMDsKPiA+IEBAIC03MjUsMTUg
KzcyNSwxNSBAQCBzdGF0aWMgdTMyIHJlYWRfdGltZXN0YW1wX2ZyZXF1ZW5jeShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICogdGVsbHMgdXMgd2hpY2ggb25lIHdl
IHNob3VsZCB1c2UuCj4gPiAgIAkJICovCj4gPiAgIAkJaWYgKChjdGNfcmVnICYgQ1RDX1NPVVJD
RV9QQVJBTUVURVJfTUFTSykgPT0gQ1RDX1NPVVJDRV9ESVZJREVfTE9HSUMpIHsKPiA+IC0JCQlm
cmVxID0gcmVhZF9yZWZlcmVuY2VfdHNfZnJlcShkZXZfcHJpdik7Cj4gPiArCQkJZnJlcSA9IHJl
YWRfcmVmZXJlbmNlX3RzX2ZyZXEoaTkxNSk7Cj4gPiAgIAkJfSBlbHNlIHsKPiA+ICAgCQkJdTMy
IHJwbV9jb25maWdfcmVnID0gSTkxNV9SRUFEKFJQTV9DT05GSUcwKTsKPiA+IC0JCQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA8PSAxMCkKPiA+IC0JCQkJZnJlcSA9IGdlbjEwX2dldF9jcnlzdGFs
X2Nsb2NrX2ZyZXEoZGV2X3ByaXYsCj4gPiArCQkJaWYgKElOVEVMX0dFTihpOTE1KSA8PSAxMCkK
PiA+ICsJCQkJZnJlcSA9IGdlbjEwX2dldF9jcnlzdGFsX2Nsb2NrX2ZyZXEoaTkxNSwKPiA+ICAg
CQkJCQkJCQlycG1fY29uZmlnX3JlZyk7Cj4gPiAgIAkJCWVsc2UKPiA+IC0JCQkJZnJlcSA9IGdl
bjExX2dldF9jcnlzdGFsX2Nsb2NrX2ZyZXEoZGV2X3ByaXYsCj4gPiArCQkJCWZyZXEgPSBnZW4x
MV9nZXRfY3J5c3RhbF9jbG9ja19mcmVxKGk5MTUsCj4gPiAgIAkJCQkJCQkJcnBtX2NvbmZpZ19y
ZWcpOwo+ID4gICAJCQkvKiBOb3cgZmlndXJlIG91dCBob3cgdGhlIGNvbW1hbmQgc3RyZWFtJ3Mg
dGltZXN0YW1wCj4gPiBAQCAtODQxLDcgKzg0MSw3IEBAIHZvaWQgaW50ZWxfZGV2aWNlX2luZm9f
c3VicGxhdGZvcm1faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgLyoq
Cj4gPiAgICAqIGludGVsX2RldmljZV9pbmZvX3J1bnRpbWVfaW5pdCAtIGluaXRpYWxpemUgcnVu
dGltZSBpbmZvCj4gPiAtICogQGRldl9wcml2OiB0aGUgaTkxNSBkZXZpY2UKPiA+ICsgKiBAaTkx
NTogdGhlIGk5MTUgZGV2aWNlCj4gPiAgICAqCj4gPiAgICAqIERldGVybWluZSB2YXJpb3VzIGlu
dGVsX2RldmljZV9pbmZvIGZpZWxkcyBhdCBydW50aW1lLgo+ID4gICAgKgo+ID4gQEAgLTg1NSwx
NiArODU1LDE2IEBAIHZvaWQgaW50ZWxfZGV2aWNlX2luZm9fc3VicGxhdGZvcm1faW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgICogICAtIGFmdGVyIHRoZSBQQ0ggaGFz
IGJlZW4gZGV0ZWN0ZWQsCj4gPiAgICAqICAgLSBiZWZvcmUgdGhlIGZpcnN0IHVzYWdlIG9mIHRo
ZSBmaWVsZHMgaXQgY2FuIHR3ZWFrLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2RldmljZV9p
bmZvX3J1bnRpbWVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAr
dm9pZCBpbnRlbF9kZXZpY2VfaW5mb19ydW50aW1lX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX2RldmljZV9pbmZvICppbmZvID0g
bWt3cml0ZV9kZXZpY2VfaW5mbyhkZXZfcHJpdik7Cj4gPiAtCXN0cnVjdCBpbnRlbF9ydW50aW1l
X2luZm8gKnJ1bnRpbWUgPSBSVU5USU1FX0lORk8oZGV2X3ByaXYpOwo+ID4gKwlzdHJ1Y3QgaW50
ZWxfZGV2aWNlX2luZm8gKmluZm8gPSBta3dyaXRlX2RldmljZV9pbmZvKGk5MTUpOwo+ID4gKwlz
dHJ1Y3QgaW50ZWxfcnVudGltZV9pbmZvICpydW50aW1lID0gUlVOVElNRV9JTkZPKGk5MTUpOwo+
ID4gICAJZW51bSBwaXBlIHBpcGU7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEw
KSB7Cj4gPiAtCQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKQo+ID4gKwlpZiAoSU5URUxf
R0VOKGk5MTUpID49IDEwKSB7Cj4gPiArCQlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpCj4gPiAg
IAkJCXJ1bnRpbWUtPm51bV9zY2FsZXJzW3BpcGVdID0gMjsKPiA+IC0JfSBlbHNlIGlmIChJU19H
RU4oZGV2X3ByaXYsIDkpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDkpKSB7Cj4g
PiAgIAkJcnVudGltZS0+bnVtX3NjYWxlcnNbUElQRV9BXSA9IDI7Cj4gPiAgIAkJcnVudGltZS0+
bnVtX3NjYWxlcnNbUElQRV9CXSA9IDI7Cj4gPiAgIAkJcnVudGltZS0+bnVtX3NjYWxlcnNbUElQ
RV9DXSA9IDE7Cj4gPiBAQCAtODcyLDEzICs4NzIsMTMgQEAgdm9pZCBpbnRlbF9kZXZpY2VfaW5m
b19ydW50aW1lX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJ
QlVJTERfQlVHX09OKEJJVFNfUEVSX1RZUEUoaW50ZWxfZW5naW5lX21hc2tfdCkgPCBJOTE1X05V
TV9FTkdJTkVTKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gPiAtCQlm
b3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49
IDExKQo+ID4gKwkJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+ID4gICAJCQlydW50aW1lLT5u
dW1fc3ByaXRlc1twaXBlXSA9IDY7Cj4gPiAtCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMTAp
IHx8IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+ID4gLQkJZm9yX2VhY2hfcGlwZShkZXZfcHJp
diwgcGlwZSkKPiA+ICsJZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDEwKSB8fCBJU19HRU1JTklMQUtF
KGk5MTUpKQo+ID4gKwkJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+ID4gICAJCQlydW50aW1l
LT5udW1fc3ByaXRlc1twaXBlXSA9IDM7Cj4gPiAtCWVsc2UgaWYgKElTX0JST1hUT04oZGV2X3By
aXYpKSB7Cj4gPiArCWVsc2UgaWYgKElTX0JST1hUT04oaTkxNSkpIHsKPiA+ICAgCQkvKgo+ID4g
ICAJCSAqIFNreWxha2UgYW5kIEJyb3h0b24gY3VycmVudGx5IGRvbid0IGV4cG9zZSB0aGUgdG9w
bW9zdCBwbGFuZSBhcyBpdHMKPiA+ICAgCQkgKiB1c2UgaXMgZXhjbHVzaXZlIHdpdGggdGhlIGxl
Z2FjeSBjdXJzb3IgYW5kIHdlIG9ubHkgd2FudCB0byBleHBvc2UKPiA+IEBAIC04OTEsMjAgKzg5
MSwyMCBAQCB2b2lkIGludGVsX2RldmljZV9pbmZvX3J1bnRpbWVfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJcnVudGltZS0+bnVtX3Nwcml0ZXNbUElQRV9B
XSA9IDI7Cj4gPiAgIAkJcnVudGltZS0+bnVtX3Nwcml0ZXNbUElQRV9CXSA9IDI7Cj4gPiAgIAkJ
cnVudGltZS0+bnVtX3Nwcml0ZXNbUElQRV9DXSA9IDE7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfVkFM
TEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+IC0JCWZv
cl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpCj4gPiArCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklF
VyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiArCQlmb3JfZWFjaF9waXBlKGk5
MTUsIHBpcGUpCj4gPiAgIAkJCXJ1bnRpbWUtPm51bV9zcHJpdGVzW3BpcGVdID0gMjsKPiA+IC0J
fSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDUgfHwgSVNfRzRYKGRldl9wcml2KSkg
ewo+ID4gLQkJZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkKPiA+ICsJfSBlbHNlIGlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gNSB8fCBJU19HNFgoaTkxNSkpIHsKPiA+ICsJCWZvcl9lYWNoX3Bp
cGUoaTkxNSwgcGlwZSkKPiA+ICAgCQkJcnVudGltZS0+bnVtX3Nwcml0ZXNbcGlwZV0gPSAxOwo+
ID4gICAJfQo+ID4gICAJaWYgKGk5MTVfbW9kcGFyYW1zLmRpc2FibGVfZGlzcGxheSkgewo+ID4g
ICAJCURSTV9JTkZPKCJEaXNwbGF5IGRpc2FibGVkIChtb2R1bGUgcGFyYW1ldGVyKVxuIik7Cj4g
PiAgIAkJaW5mby0+bnVtX3BpcGVzID0gMDsKPiA+IC0JfSBlbHNlIGlmIChIQVNfRElTUExBWShk
ZXZfcHJpdikgJiYKPiA+IC0JCSAgIChJU19HRU5fUkFOR0UoZGV2X3ByaXYsIDcsIDgpKSAmJgo+
ID4gLQkJICAgSEFTX1BDSF9TUExJVChkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChIQVNf
RElTUExBWShpOTE1KSAmJgo+ID4gKwkJICAgKElTX0dFTl9SQU5HRShpOTE1LCA3LCA4KSkgJiYK
PiA+ICsJCSAgIEhBU19QQ0hfU1BMSVQoaTkxNSkpIHsKPiA+ICAgCQl1MzIgZnVzZV9zdHJhcCA9
IEk5MTVfUkVBRChGVVNFX1NUUkFQKTsKPiA+ICAgCQl1MzIgc2Z1c2Vfc3RyYXAgPSBJOTE1X1JF
QUQoU0ZVU0VfU1RSQVApOwo+ID4gQEAgLTkxOSw3ICs5MTksNyBAQCB2b2lkIGludGVsX2Rldmlj
ZV9pbmZvX3J1bnRpbWVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiAgIAkJICovCj4gPiAgIAkJaWYgKGZ1c2Vfc3RyYXAgJiBJTEtfSU5URVJOQUxfRElTUExBWV9E
SVNBQkxFIHx8Cj4gPiAgIAkJICAgIHNmdXNlX3N0cmFwICYgU0ZVU0VfU1RSQVBfRElTUExBWV9E
SVNBQkxFRCB8fAo+ID4gLQkJICAgIChIQVNfUENIX0NQVChkZXZfcHJpdikgJiYKPiA+ICsJCSAg
ICAoSEFTX1BDSF9DUFQoaTkxNSkgJiYKPiA+ICAgCQkgICAgICEoc2Z1c2Vfc3RyYXAgJiBTRlVT
RV9TVFJBUF9GVVNFX0xPQ0spKSkgewo+ID4gICAJCQlEUk1fSU5GTygiRGlzcGxheSBmdXNlZCBv
ZmYsIGRpc2FibGluZ1xuIik7Cj4gPiAgIAkJCWluZm8tPm51bV9waXBlcyA9IDA7Cj4gPiBAQCAt
OTI3LDcgKzkyNyw3IEBAIHZvaWQgaW50ZWxfZGV2aWNlX2luZm9fcnVudGltZV9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkJRFJNX0lORk8oIlBpcGVDIGZ1
c2VkIG9mZlxuIik7Cj4gPiAgIAkJCWluZm8tPm51bV9waXBlcyAtPSAxOwo+ID4gICAJCX0KPiA+
IC0JfSBlbHNlIGlmIChIQVNfRElTUExBWShkZXZfcHJpdikgJiYgSU5URUxfR0VOKGRldl9wcml2
KSA+PSA5KSB7Cj4gPiArCX0gZWxzZSBpZiAoSEFTX0RJU1BMQVkoaTkxNSkgJiYgSU5URUxfR0VO
KGk5MTUpID49IDkpIHsKPiA+ICAgCQl1MzIgZGZzbSA9IEk5MTVfUkVBRChTS0xfREZTTSk7Cj4g
PiAgIAkJdTggZGlzYWJsZWRfbWFzayA9IDA7Cj4gPiAgIAkJYm9vbCBpbnZhbGlkOwo+ID4gQEAg
LTk2MSwyNiArOTYxLDI2IEBAIHZvaWQgaW50ZWxfZGV2aWNlX2luZm9fcnVudGltZV9pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCX0KPiA+ICAgCS8qIEluaXRp
YWxpemUgc2xpY2Uvc3Vic2xpY2UvRVUgaW5mbyAqLwo+ID4gLQlpZiAoSVNfSEFTV0VMTChkZXZf
cHJpdikpCj4gPiAtCQloYXN3ZWxsX3NzZXVfaW5mb19pbml0KGRldl9wcml2KTsKPiA+IC0JZWxz
ZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiAtCQljaGVycnl2aWV3X3NzZXVfaW5m
b19pbml0KGRldl9wcml2KTsKPiA+IC0JZWxzZSBpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkK
PiA+IC0JCWJyb2Fkd2VsbF9zc2V1X2luZm9faW5pdChkZXZfcHJpdik7Cj4gPiAtCWVsc2UgaWYg
KElTX0dFTihkZXZfcHJpdiwgOSkpCj4gPiAtCQlnZW45X3NzZXVfaW5mb19pbml0KGRldl9wcml2
KTsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCAxMCkpCj4gPiAtCQlnZW4xMF9zc2V1
X2luZm9faW5pdChkZXZfcHJpdik7Cj4gPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gMTEpCj4gPiAtCQlnZW4xMV9zc2V1X2luZm9faW5pdChkZXZfcHJpdik7Cj4gPiAtCj4gPiAt
CWlmIChJU19HRU4oZGV2X3ByaXYsIDYpICYmIGludGVsX3Z0ZF9hY3RpdmUoKSkgewo+ID4gKwlp
ZiAoSVNfSEFTV0VMTChpOTE1KSkKPiA+ICsJCWhhc3dlbGxfc3NldV9pbmZvX2luaXQoaTkxNSk7
Cj4gPiArCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiArCQljaGVycnl2aWV3X3Nz
ZXVfaW5mb19pbml0KGk5MTUpOwo+ID4gKwllbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpCj4g
PiArCQlicm9hZHdlbGxfc3NldV9pbmZvX2luaXQoaTkxNSk7Cj4gPiArCWVsc2UgaWYgKElTX0dF
TihpOTE1LCA5KSkKPiA+ICsJCWdlbjlfc3NldV9pbmZvX2luaXQoaTkxNSk7Cj4gPiArCWVsc2Ug
aWYgKElTX0dFTihpOTE1LCAxMCkpCj4gPiArCQlnZW4xMF9zc2V1X2luZm9faW5pdChpOTE1KTsK
PiA+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ID4gKwkJZ2VuMTFfc3NldV9p
bmZvX2luaXQoaTkxNSk7Cj4gPiArCj4gPiArCWlmIChJU19HRU4oaTkxNSwgNikgJiYgaW50ZWxf
dnRkX2FjdGl2ZSgpKSB7Cj4gPiAgIAkJRFJNX0lORk8oIkRpc2FibGluZyBwcEdUVCBmb3IgVlQt
ZCBzdXBwb3J0XG4iKTsKPiA+ICAgCQlpbmZvLT5wcGd0dF90eXBlID0gSU5URUxfUFBHVFRfTk9O
RTsKPiA+ICAgCX0KPiA+ICAgCS8qIEluaXRpYWxpemUgY29tbWFuZCBzdHJlYW0gdGltZXN0YW1w
IGZyZXF1ZW5jeSAqLwo+ID4gLQlydW50aW1lLT5jc190aW1lc3RhbXBfZnJlcXVlbmN5X2toeiA9
IHJlYWRfdGltZXN0YW1wX2ZyZXF1ZW5jeShkZXZfcHJpdik7Cj4gPiArCXJ1bnRpbWUtPmNzX3Rp
bWVzdGFtcF9mcmVxdWVuY3lfa2h6ID0gcmVhZF90aW1lc3RhbXBfZnJlcXVlbmN5KGk5MTUpOwo+
ID4gICB9Cj4gPiAgIHZvaWQgaW50ZWxfZHJpdmVyX2NhcHNfcHJpbnQoY29uc3Qgc3RydWN0IGlu
dGVsX2RyaXZlcl9jYXBzICpjYXBzLAo+ID4gQEAgLTk5NywxNiArOTk3LDE2IEBAIHZvaWQgaW50
ZWxfZHJpdmVyX2NhcHNfcHJpbnQoY29uc3Qgc3RydWN0IGludGVsX2RyaXZlcl9jYXBzICpjYXBz
LAo+ID4gICAgKiB0aGlzIHBvaW50IChidXQgbGF0ZXIgd2UgbmVlZCB0byBwcnVuZSB0aGUgZm9y
Y2V3YWtlIGRvbWFpbnMgZm9yIGVuZ2luZXMgdGhhdAo+ID4gICAgKiBhcmUgaW5kZWVkIGZ1c2Vk
IG9mZikuCj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfZGV2aWNlX2luZm9faW5pdF9tbWlvKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGludGVsX2RldmljZV9p
bmZvX2luaXRfbW1pbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgaW50ZWxfZGV2aWNlX2luZm8gKmluZm8gPSBta3dyaXRlX2RldmljZV9pbmZvKGRl
dl9wcml2KTsKPiA+ICsJc3RydWN0IGludGVsX2RldmljZV9pbmZvICppbmZvID0gbWt3cml0ZV9k
ZXZpY2VfaW5mbyhpOTE1KTsKPiA+ICAgCXVuc2lnbmVkIGludCBsb2dpY2FsX3ZkYm94ID0gMDsK
PiA+ICAgCXVuc2lnbmVkIGludCBpOwo+ID4gICAJdTMyIG1lZGlhX2Z1c2U7Cj4gPiAgIAl1MTYg
dmRib3hfbWFzazsKPiA+ICAgCXUxNiB2ZWJveF9tYXNrOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA8IDExKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgMTEpCj4gPiAgIAkJcmV0
dXJuOwo+ID4gICAJbWVkaWFfZnVzZSA9IH5JOTE1X1JFQUQoR0VOMTFfR1RfVkVCT1hfVkRCT1hf
RElTQUJMRSk7Cj4gPiBAQCAtMTAxNiw3ICsxMDE2LDcgQEAgdm9pZCBpbnRlbF9kZXZpY2VfaW5m
b19pbml0X21taW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCSAg
ICAgIEdFTjExX0dUX1ZFQk9YX0RJU0FCTEVfU0hJRlQ7Cj4gPiAgIAlmb3IgKGkgPSAwOyBpIDwg
STkxNV9NQVhfVkNTOyBpKyspIHsKPiA+IC0JCWlmICghSEFTX0VOR0lORShkZXZfcHJpdiwgX1ZD
UyhpKSkpCj4gPiArCQlpZiAoIUhBU19FTkdJTkUoaTkxNSwgX1ZDUyhpKSkpCj4gPiAgIAkJCWNv
bnRpbnVlOwo+ID4gICAJCWlmICghKEJJVChpKSAmIHZkYm94X21hc2spKSB7Cj4gPiBAQCAtMTAz
MCwxNCArMTAzMCwxNCBAQCB2b2lkIGludGVsX2RldmljZV9pbmZvX2luaXRfbW1pbyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICogaG9va2VkIHVwIHRvIGFuIFNG
QyAoU2NhbGVyICYgRm9ybWF0IENvbnZlcnRlcikgdW5pdC4KPiA+ICAgCQkgKi8KPiA+ICAgCQlp
ZiAobG9naWNhbF92ZGJveCsrICUgMiA9PSAwKQo+ID4gLQkJCVJVTlRJTUVfSU5GTyhkZXZfcHJp
diktPnZkYm94X3NmY19hY2Nlc3MgfD0gQklUKGkpOwo+ID4gKwkJCVJVTlRJTUVfSU5GTyhpOTE1
KS0+dmRib3hfc2ZjX2FjY2VzcyB8PSBCSVQoaSk7Cj4gPiAgIAl9Cj4gPiAgIAlEUk1fREVCVUdf
RFJJVkVSKCJ2ZGJveCBlbmFibGU6ICUwNHgsIGluc3RhbmNlczogJTA0bHhcbiIsCj4gPiAtCQkJ
IHZkYm94X21hc2ssIFZEQk9YX01BU0soZGV2X3ByaXYpKTsKPiA+IC0JR0VNX0JVR19PTih2ZGJv
eF9tYXNrICE9IFZEQk9YX01BU0soZGV2X3ByaXYpKTsKPiA+ICsJCQkgdmRib3hfbWFzaywgVkRC
T1hfTUFTSyhpOTE1KSk7Cj4gPiArCUdFTV9CVUdfT04odmRib3hfbWFzayAhPSBWREJPWF9NQVNL
KGk5MTUpKTsKPiA+ICAgCWZvciAoaSA9IDA7IGkgPCBJOTE1X01BWF9WRUNTOyBpKyspIHsKPiA+
IC0JCWlmICghSEFTX0VOR0lORShkZXZfcHJpdiwgX1ZFQ1MoaSkpKQo+ID4gKwkJaWYgKCFIQVNf
RU5HSU5FKGk5MTUsIF9WRUNTKGkpKSkKPiA+ICAgCQkJY29udGludWU7Cj4gPiAgIAkJaWYgKCEo
QklUKGkpICYgdmVib3hfbWFzaykpIHsKPiA+IEBAIC0xMDQ2LDYgKzEwNDYsNiBAQCB2b2lkIGlu
dGVsX2RldmljZV9pbmZvX2luaXRfbW1pbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiAgIAkJfQo+ID4gICAJfQo+ID4gICAJRFJNX0RFQlVHX0RSSVZFUigidmVib3ggZW5h
YmxlOiAlMDR4LCBpbnN0YW5jZXM6ICUwNGx4XG4iLAo+ID4gLQkJCSB2ZWJveF9tYXNrLCBWRUJP
WF9NQVNLKGRldl9wcml2KSk7Cj4gPiAtCUdFTV9CVUdfT04odmVib3hfbWFzayAhPSBWRUJPWF9N
QVNLKGRldl9wcml2KSk7Cj4gPiArCQkJIHZlYm94X21hc2ssIFZFQk9YX01BU0soaTkxNSkpOwo+
ID4gKwlHRU1fQlVHX09OKHZlYm94X21hc2sgIT0gVkVCT1hfTUFTSyhpOTE1KSk7Cj4gPiAgIH0K
PiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kZXZpY2VfaW5mby5o
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uaAo+ID4gaW5kZXggM2Vh
OTUzYTIzMGIzLi45M2U1Y2M5NWU1YzAgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kZXZpY2VfaW5mby5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9kZXZpY2VfaW5mby5oCj4gPiBAQCAtMjE4LDggKzIxOCw4IEBAIHN0cnVjdCBpbnRlbF9k
cml2ZXJfY2FwcyB7Cj4gPiAgIGNvbnN0IGNoYXIgKmludGVsX3BsYXRmb3JtX25hbWUoZW51bSBp
bnRlbF9wbGF0Zm9ybSBwbGF0Zm9ybSk7Cj4gPiAtdm9pZCBpbnRlbF9kZXZpY2VfaW5mb19zdWJw
bGF0Zm9ybV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9p
ZCBpbnRlbF9kZXZpY2VfaW5mb19ydW50aW1lX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiA+ICt2b2lkIGludGVsX2RldmljZV9pbmZvX3N1YnBsYXRmb3JtX2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfZGV2aWNlX2lu
Zm9fcnVudGltZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgdm9p
ZCBpbnRlbF9kZXZpY2VfaW5mb19kdW1wX2ZsYWdzKGNvbnN0IHN0cnVjdCBpbnRlbF9kZXZpY2Vf
aW5mbyAqaW5mbywKPiA+ICAgCQkJCSAgc3RydWN0IGRybV9wcmludGVyICpwKTsKPiA+ICAgdm9p
ZCBpbnRlbF9kZXZpY2VfaW5mb19kdW1wX3J1bnRpbWUoY29uc3Qgc3RydWN0IGludGVsX3J1bnRp
bWVfaW5mbyAqaW5mbywKPiA+IEBAIC0yMjcsNyArMjI3LDcgQEAgdm9pZCBpbnRlbF9kZXZpY2Vf
aW5mb19kdW1wX3J1bnRpbWUoY29uc3Qgc3RydWN0IGludGVsX3J1bnRpbWVfaW5mbyAqaW5mbywK
PiA+ICAgdm9pZCBpbnRlbF9kZXZpY2VfaW5mb19kdW1wX3RvcG9sb2d5KGNvbnN0IHN0cnVjdCBz
c2V1X2Rldl9pbmZvICpzc2V1LAo+ID4gICAJCQkJICAgICBzdHJ1Y3QgZHJtX3ByaW50ZXIgKnAp
Owo+ID4gLXZvaWQgaW50ZWxfZGV2aWNlX2luZm9faW5pdF9tbWlvKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBpbnRlbF9kZXZpY2VfaW5mb19pbml0X21taW8o
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICB2b2lkIGludGVsX2RyaXZlcl9j
YXBzX3ByaW50KGNvbnN0IHN0cnVjdCBpbnRlbF9kcml2ZXJfY2FwcyAqY2FwcywKPiA+ICAgCQkJ
ICAgICBzdHJ1Y3QgZHJtX3ByaW50ZXIgKnApOwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rp
c3BsYXkuYwo+ID4gaW5kZXggMWIxZGRiNDhjYTdhLi5iZTI2YWQ5ZmMxOTQgMTAwNjQ0Cj4gPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5LmMKPiA+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuYwo+ID4gQEAgLTE1NiwyNCArMTU2LDI0IEBA
IHN0cnVjdCBpbnRlbF9saW1pdCB7Cj4gPiAgIH07Cj4gPiAgIC8qIHJldHVybnMgSFBMTCBmcmVx
dWVuY3kgaW4ga0h6ICovCj4gPiAtaW50IHZsdl9nZXRfaHBsbF92Y28oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludCB2bHZfZ2V0X2hwbGxfdmNvKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlpbnQgaHBsbF9mcmVxLCB2Y29fZnJl
cVtdID0geyA4MDAsIDE2MDAsIDIwMDAsIDI0MDAgfTsKPiA+ICAgCS8qIE9idGFpbiBTS1UgaW5m
b3JtYXRpb24gKi8KPiA+IC0JaHBsbF9mcmVxID0gdmx2X2Nja19yZWFkKGRldl9wcml2LCBDQ0tf
RlVTRV9SRUcpICYKPiA+ICsJaHBsbF9mcmVxID0gdmx2X2Nja19yZWFkKGk5MTUsIENDS19GVVNF
X1JFRykgJgo+ID4gICAJCUNDS19GVVNFX0hQTExfRlJFUV9NQVNLOwo+ID4gICAJcmV0dXJuIHZj
b19mcmVxW2hwbGxfZnJlcV0gKiAxMDAwOwo+ID4gICB9Cj4gPiAtaW50IHZsdl9nZXRfY2NrX2Ns
b2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpbnQgdmx2X2dldF9j
Y2tfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICAgY29u
c3QgY2hhciAqbmFtZSwgdTMyIHJlZywgaW50IHJlZl9mcmVxKQo+ID4gICB7Cj4gPiAgIAl1MzIg
dmFsOwo+ID4gICAJaW50IGRpdmlkZXI7Cj4gPiAtCXZhbCA9IHZsdl9jY2tfcmVhZChkZXZfcHJp
diwgcmVnKTsKPiA+ICsJdmFsID0gdmx2X2Nja19yZWFkKGk5MTUsIHJlZyk7Cj4gPiAgIAlkaXZp
ZGVyID0gdmFsICYgQ0NLX0ZSRVFVRU5DWV9WQUxVRVM7Cj4gPiAgIAlXQVJOKCh2YWwgJiBDQ0tf
RlJFUVVFTkNZX1NUQVRVUykgIT0KPiA+IEBAIC0xODMsNDIgKzE4Myw0MiBAQCBpbnQgdmx2X2dl
dF9jY2tfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJcmV0
dXJuIERJVl9ST1VORF9DTE9TRVNUKHJlZl9mcmVxIDw8IDEsIGRpdmlkZXIgKyAxKTsKPiA+ICAg
fQo+ID4gLWludCB2bHZfZ2V0X2Nja19jbG9ja19ocGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtpbnQgdmx2X2dldF9jY2tfY2xvY2tfaHBsbChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgY29uc3QgY2hhciAqbmFtZSwgdTMyIHJlZykK
PiA+ICAgewo+ID4gICAJaW50IGhwbGw7Cj4gPiAtCXZsdl9jY2tfZ2V0KGRldl9wcml2KTsKPiA+
ICsJdmx2X2Nja19nZXQoaTkxNSk7Cj4gPiAtCWlmIChkZXZfcHJpdi0+aHBsbF9mcmVxID09IDAp
Cj4gPiAtCQlkZXZfcHJpdi0+aHBsbF9mcmVxID0gdmx2X2dldF9ocGxsX3ZjbyhkZXZfcHJpdik7
Cj4gPiArCWlmIChpOTE1LT5ocGxsX2ZyZXEgPT0gMCkKPiA+ICsJCWk5MTUtPmhwbGxfZnJlcSA9
IHZsdl9nZXRfaHBsbF92Y28oaTkxNSk7Cj4gPiAtCWhwbGwgPSB2bHZfZ2V0X2Nja19jbG9jayhk
ZXZfcHJpdiwgbmFtZSwgcmVnLCBkZXZfcHJpdi0+aHBsbF9mcmVxKTsKPiA+ICsJaHBsbCA9IHZs
dl9nZXRfY2NrX2Nsb2NrKGk5MTUsIG5hbWUsIHJlZywgaTkxNS0+aHBsbF9mcmVxKTsKPiA+IC0J
dmx2X2Nja19wdXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfY2NrX3B1dChpOTE1KTsKPiA+ICAgCXJl
dHVybiBocGxsOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaW50ZWxfdXBkYXRlX2N6Y2xrKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbnRlbF91
cGRhdGVfY3pjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0J
aWYgKCEoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikp
KQo+ID4gKwlpZiAoIShJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkp
KQo+ID4gICAJCXJldHVybjsKPiA+IC0JZGV2X3ByaXYtPmN6Y2xrX2ZyZXEgPSB2bHZfZ2V0X2Nj
a19jbG9ja19ocGxsKGRldl9wcml2LCAiY3pjbGsiLAo+ID4gKwlpOTE1LT5jemNsa19mcmVxID0g
dmx2X2dldF9jY2tfY2xvY2tfaHBsbChpOTE1LCAiY3pjbGsiLAo+ID4gICAJCQkJCQkgICAgICBD
Q0tfQ1pfQ0xPQ0tfQ09OVFJPTCk7Cj4gPiAtCURSTV9ERUJVR19EUklWRVIoIkNaIGNsb2NrIHJh
dGU6ICVkIGtIelxuIiwgZGV2X3ByaXYtPmN6Y2xrX2ZyZXEpOwo+ID4gKwlEUk1fREVCVUdfRFJJ
VkVSKCJDWiBjbG9jayByYXRlOiAlZCBrSHpcbiIsIGk5MTUtPmN6Y2xrX2ZyZXEpOwo+ID4gICB9
Cj4gPiAgIHN0YXRpYyBpbmxpbmUgdTMyIC8qIHVuaXRzIG9mIDEwME1IeiAqLwo+ID4gLWludGVs
X2ZkaV9saW5rX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2lu
dGVsX2ZkaV9saW5rX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJ
ICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+
ID4gLQlpZiAoSEFTX0RESShkZXZfcHJpdikpCj4gPiArCWlmIChIQVNfRERJKGk5MTUpKQo+ID4g
ICAJCXJldHVybiBwaXBlX2NvbmZpZy0+cG9ydF9jbG9jazsgLyogU1BMTCAqLwo+ID4gICAJZWxz
ZQo+ID4gLQkJcmV0dXJuIGRldl9wcml2LT5mZGlfcGxsX2ZyZXE7Cj4gPiArCQlyZXR1cm4gaTkx
NS0+ZmRpX3BsbF9mcmVxOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxf
bGltaXQgaW50ZWxfbGltaXRzX2k4eHhfZGFjID0gewo+ID4gQEAgLTQ4OCw3ICs0ODgsNyBAQCBz
dGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2xpbWl0IGludGVsX2xpbWl0c19ieHQgPSB7Cj4gPiAg
IC8qIFdBIERpc3BsYXkgIzA4Mjc6IEdlbjk6YWxsICovCj4gPiAgIHN0YXRpYyB2b2lkCj4gPiAt
c2tsX3dhXzgyNyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBwaXBlLCBi
b29sIGVuYWJsZSkKPiA+ICtza2xfd2FfODI3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LCBpbnQgcGlwZSwgYm9vbCBlbmFibGUpCj4gPiAgIHsKPiA+ICAgCWlmIChlbmFibGUpCj4gPiAg
IAkJSTkxNV9XUklURShDTEtHQVRFX0RJU19QU0wocGlwZSksCj4gPiBAQCAtNTAyLDcgKzUwMiw3
IEBAIHNrbF93YV84Mjcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgcGlw
ZSwgYm9vbCBlbmFibGUpCj4gPiAgIC8qIFdhXzIwMDY2MDQzMTI6aWNsICovCj4gPiAgIHN0YXRp
YyB2b2lkCj4gPiAtaWNsX3dhX3NjYWxlcmNsa2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlLAo+ID4gK2ljbF93YV9zY2FsZXJjbGtnYXRpbmco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcGlwZSBwaXBlLAo+ID4gICAJCSAg
ICAgICBib29sIGVuYWJsZSkKPiA+ICAgewo+ID4gICAJaWYgKGVuYWJsZSkKPiA+IEBAIC01ODgs
NyArNTg4LDcgQEAgaW50IGNodl9jYWxjX2RwbGxfcGFyYW1zKGludCByZWZjbGssIHN0cnVjdCBk
cGxsICpjbG9jaykKPiA+ICAgICogUmV0dXJucyB3aGV0aGVyIHRoZSBnaXZlbiBzZXQgb2YgZGl2
aXNvcnMgYXJlIHZhbGlkIGZvciBhIGdpdmVuIHJlZmNsayB3aXRoCj4gPiAgICAqIHRoZSBnaXZl
biBjb25uZWN0b3JzLgo+ID4gICAgKi8KPiA+IC1zdGF0aWMgYm9vbCBpbnRlbF9QTExfaXNfdmFs
aWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIGlu
dGVsX1BMTF9pc192YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJ
ICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9saW1pdCAqbGltaXQsCj4gPiAgIAkJCSAgICAgICBj
b25zdCBzdHJ1Y3QgZHBsbCAqY2xvY2spCj4gPiAgIHsKPiA+IEBAIC02MDEsMTMgKzYwMSwxMyBA
QCBzdGF0aWMgYm9vbCBpbnRlbF9QTExfaXNfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gICAJaWYgKGNsb2NrLT5tMSAgPCBsaW1pdC0+bTEubWluICB8fCBsaW1p
dC0+bTEubWF4ICA8IGNsb2NrLT5tMSkKPiA+ICAgCQlJTlRFTFBsbEludmFsaWQoIm0xIG91dCBv
ZiByYW5nZVxuIik7Cj4gPiAtCWlmICghSVNfUElORVZJRVcoZGV2X3ByaXYpICYmICFJU19WQUxM
RVlWSUVXKGRldl9wcml2KSAmJgo+ID4gLQkgICAgIUlTX0NIRVJSWVZJRVcoZGV2X3ByaXYpICYm
ICFJU19HRU45X0xQKGRldl9wcml2KSkKPiA+ICsJaWYgKCFJU19QSU5FVklFVyhpOTE1KSAmJiAh
SVNfVkFMTEVZVklFVyhpOTE1KSAmJgo+ID4gKwkgICAgIUlTX0NIRVJSWVZJRVcoaTkxNSkgJiYg
IUlTX0dFTjlfTFAoaTkxNSkpCj4gPiAgIAkJaWYgKGNsb2NrLT5tMSA8PSBjbG9jay0+bTIpCj4g
PiAgIAkJCUlOVEVMUGxsSW52YWxpZCgibTEgPD0gbTJcbiIpOwo+ID4gLQlpZiAoIUlTX1ZBTExF
WVZJRVcoZGV2X3ByaXYpICYmICFJU19DSEVSUllWSUVXKGRldl9wcml2KSAmJgo+ID4gLQkgICAg
IUlTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Cj4gPiArCWlmICghSVNfVkFMTEVZVklFVyhpOTE1KSAm
JiAhSVNfQ0hFUlJZVklFVyhpOTE1KSAmJgo+ID4gKwkgICAgIUlTX0dFTjlfTFAoaTkxNSkpIHsK
PiA+ICAgCQlpZiAoY2xvY2stPnAgPCBsaW1pdC0+cC5taW4gfHwgbGltaXQtPnAubWF4IDwgY2xv
Y2stPnApCj4gPiAgIAkJCUlOVEVMUGxsSW52YWxpZCgicCBvdXQgb2YgcmFuZ2VcbiIpOwo+ID4g
ICAJCWlmIChjbG9jay0+bSA8IGxpbWl0LT5tLm1pbiB8fCBsaW1pdC0+bS5tYXggPCBjbG9jay0+
bSkKPiA+IEBAIC02MzAsNyArNjMwLDcgQEAgaTl4eF9zZWxlY3RfcDJfZGl2KGNvbnN0IHN0cnVj
dCBpbnRlbF9saW1pdCAqbGltaXQsCj4gPiAgIAkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJICAgaW50IHRhcmdldCkKPiA+ICAgewo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJh
c2UuY3J0Yy0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICAgCWlmIChpbnRlbF9jcnRjX2hh
c190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9MVkRTKSkgewo+ID4gICAJCS8qCj4gPiBA
QCAtNjM4LDcgKzYzOCw3IEBAIGk5eHhfc2VsZWN0X3AyX2Rpdihjb25zdCBzdHJ1Y3QgaW50ZWxf
bGltaXQgKmxpbWl0LAo+ID4gICAJCSAqIFdlIGhhdmVuJ3QgZmlndXJlZCBvdXQgaG93IHRvIHJl
bGlhYmx5IHNldCB1cCBkaWZmZXJlbnQKPiA+ICAgCQkgKiBzaW5nbGUvZHVhbCBjaGFubmVsIHN0
YXRlLCBpZiB3ZSBldmVuIGNhbi4KPiA+ICAgCQkgKi8KPiA+IC0JCWlmIChpbnRlbF9pc19kdWFs
X2xpbmtfbHZkcyhkZXZfcHJpdikpCj4gPiArCQlpZiAoaW50ZWxfaXNfZHVhbF9saW5rX2x2ZHMo
aTkxNSkpCj4gPiAgIAkJCXJldHVybiBsaW1pdC0+cDIucDJfZmFzdDsKPiA+ICAgCQllbHNlCj4g
PiAgIAkJCXJldHVybiBsaW1pdC0+cDIucDJfc2xvdzsKPiA+IEBAIC0xMDE2LDIyICsxMDE2LDIy
IEBAIGJvb2wgaW50ZWxfY3J0Y19hY3RpdmUoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAg
IAkJY3J0Yy0+Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19jbG9jazsKPiA+ICAgfQo+
ID4gLWVudW0gdHJhbnNjb2RlciBpbnRlbF9waXBlX3RvX2NwdV90cmFuc2NvZGVyKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtlbnVtIHRyYW5zY29kZXIgaW50ZWxfcGlw
ZV90b19jcHVfdHJhbnNjb2RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJCQkgICAgIGVudW0gcGlwZSBwaXBlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGk5MTUsIHBp
cGUpOwo+ID4gICAJcmV0dXJuIGNydGMtPmNvbmZpZy0+Y3B1X3RyYW5zY29kZXI7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgYm9vbCBwaXBlX3NjYW5saW5lX2lzX21vdmluZyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGJvb2wgcGlwZV9zY2FubGluZV9pc19tb3Zp
bmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgZW51bSBwaXBl
IHBpcGUpCj4gPiAgIHsKPiA+ICAgCWk5MTVfcmVnX3QgcmVnID0gUElQRURTTChwaXBlKTsKPiA+
ICAgCXUzMiBsaW5lMSwgbGluZTI7Cj4gPiAgIAl1MzIgbGluZV9tYXNrOwo+ID4gLQlpZiAoSVNf
R0VOKGRldl9wcml2LCAyKSkKPiA+ICsJaWYgKElTX0dFTihpOTE1LCAyKSkKPiA+ICAgCQlsaW5l
X21hc2sgPSBEU0xfTElORU1BU0tfR0VOMjsKPiA+ICAgCWVsc2UKPiA+ICAgCQlsaW5lX21hc2sg
PSBEU0xfTElORU1BU0tfR0VOMzsKPiA+IEBAIC0xMDQ1LDExICsxMDQ1LDExIEBAIHN0YXRpYyBi
b29sIHBpcGVfc2NhbmxpbmVfaXNfbW92aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICAgc3RhdGljIHZvaWQgd2FpdF9mb3JfcGlwZV9zY2FubGluZV9tb3Zpbmcoc3Ry
dWN0IGludGVsX2NydGMgKmNydGMsIGJvb2wgc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAkvKiBXYWl0IGZvciB0
aGUgZGlzcGxheSBsaW5lIHRvIHNldHRsZS9zdGFydCBtb3ZpbmcgKi8KPiA+IC0JaWYgKHdhaXRf
Zm9yKHBpcGVfc2NhbmxpbmVfaXNfbW92aW5nKGRldl9wcml2LCBwaXBlKSA9PSBzdGF0ZSwgMTAw
KSkKPiA+ICsJaWYgKHdhaXRfZm9yKHBpcGVfc2NhbmxpbmVfaXNfbW92aW5nKGk5MTUsIHBpcGUp
ID09IHN0YXRlLCAxMDApKQo+ID4gICAJCURSTV9FUlJPUigicGlwZSAlYyBzY2FubGluZSAlcyB3
YWl0IHRpbWVkIG91dFxuIiwKPiA+ICAgCQkJICBwaXBlX25hbWUocGlwZSksIG9ub2ZmKHN0YXRl
KSk7Cj4gPiAgIH0KPiA+IEBAIC0xMDY4LDE0ICsxMDY4LDE0IEBAIHN0YXRpYyB2b2lkCj4gPiAg
IGludGVsX3dhaXRfZm9yX3BpcGVfb2ZmKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpv
bGRfY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsK
PiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkgewo+ID4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDQpIHsKPiA+ICAgCQllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBv
bGRfY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gPiAgIAkJaTkxNV9yZWdfdCByZWcgPSBQ
SVBFQ09ORihjcHVfdHJhbnNjb2Rlcik7Cj4gPiAgIAkJLyogV2FpdCBmb3IgdGhlIFBpcGUgU3Rh
dGUgdG8gZ28gb2ZmICovCj4gPiAtCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9w
cml2LT51bmNvcmUsCj4gPiArCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVu
Y29yZSwKPiA+ICAgCQkJCQkgICAgcmVnLCBJOTY1X1BJUEVDT05GX0FDVElWRSwgMCwKPiA+ICAg
CQkJCQkgICAgMTAwKSkKPiA+ICAgCQkJV0FSTigxLCAicGlwZV9vZmYgd2FpdCB0aW1lZCBvdXRc
biIpOwo+ID4gQEAgLTEwODUsNyArMTA4NSw3IEBAIGludGVsX3dhaXRfZm9yX3BpcGVfb2ZmKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiA+ICAgfQo+ID4g
ICAvKiBPbmx5IGZvciBwcmUtSUxLIGNvbmZpZ3MgKi8KPiA+IC12b2lkIGFzc2VydF9wbGwoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgYXNzZXJ0X3BsbChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQllbnVtIHBpcGUgcGlwZSwgYm9vbCBz
dGF0ZSkKPiA+ICAgewo+ID4gICAJdTMyIHZhbDsKPiA+IEBAIC0xMDk5LDE0ICsxMDk5LDE0IEBA
IHZvaWQgYXNzZXJ0X3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAg
IH0KPiA+ICAgLyogWFhYOiB0aGUgZHNpIHBsbCBpcyBzaGFyZWQgYmV0d2VlbiBNSVBJIERTSSBw
b3J0cyAqLwo+ID4gLXZvaWQgYXNzZXJ0X2RzaV9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCBib29sIHN0YXRlKQo+ID4gK3ZvaWQgYXNzZXJ0X2RzaV9wbGwoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7
Cj4gPiAgIAlib29sIGN1cl9zdGF0ZTsKPiA+IC0Jdmx2X2Nja19nZXQoZGV2X3ByaXYpOwo+ID4g
LQl2YWwgPSB2bHZfY2NrX3JlYWQoZGV2X3ByaXYsIENDS19SRUdfRFNJX1BMTF9DT05UUk9MKTsK
PiA+IC0Jdmx2X2Nja19wdXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfY2NrX2dldChpOTE1KTsKPiA+
ICsJdmFsID0gdmx2X2Nja19yZWFkKGk5MTUsIENDS19SRUdfRFNJX1BMTF9DT05UUk9MKTsKPiA+
ICsJdmx2X2Nja19wdXQoaTkxNSk7Cj4gPiAgIAljdXJfc3RhdGUgPSB2YWwgJiBEU0lfUExMX1ZD
T19FTjsKPiA+ICAgCUk5MTVfU1RBVEVfV0FSTihjdXJfc3RhdGUgIT0gc3RhdGUsCj4gPiBAQCAt
MTExNCwxNCArMTExNCwxNCBAQCB2b2lkIGFzc2VydF9kc2lfcGxsKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgYm9vbCBzdGF0ZSkKPiA+ICAgCQkJb25vZmYoc3RhdGUpLCBvbm9m
ZihjdXJfc3RhdGUpKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGFzc2VydF9mZGlfdHgoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGFzc2VydF9m
ZGlfdHgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgZW51bSBwaXBl
IHBpcGUsIGJvb2wgc3RhdGUpCj4gPiAgIHsKPiA+ICAgCWJvb2wgY3VyX3N0YXRlOwo+ID4gLQll
bnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBpbnRlbF9waXBlX3RvX2NwdV90cmFuc2Nv
ZGVyKGRldl9wcml2LAo+ID4gKwllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBpbnRl
bF9waXBlX3RvX2NwdV90cmFuc2NvZGVyKGk5MTUsCj4gPiAgIAkJCQkJCQkJICAgICAgcGlwZSk7
Cj4gPiAtCWlmIChIQVNfRERJKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX0RESShpOTE1KSkg
ewo+ID4gICAJCS8qIERESSBkb2VzIG5vdCBoYXZlIGEgc3BlY2lmaWMgRkRJX1RYIHJlZ2lzdGVy
ICovCj4gPiAgIAkJdTMyIHZhbCA9IEk5MTVfUkVBRChUUkFOU19ERElfRlVOQ19DVEwoY3B1X3Ry
YW5zY29kZXIpKTsKPiA+ICAgCQljdXJfc3RhdGUgPSAhISh2YWwgJiBUUkFOU19ERElfRlVOQ19F
TkFCTEUpOwo+ID4gQEAgLTExMzYsNyArMTEzNiw3IEBAIHN0YXRpYyB2b2lkIGFzc2VydF9mZGlf
dHgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAjZGVmaW5lIGFzc2Vy
dF9mZGlfdHhfZW5hYmxlZChkLCBwKSBhc3NlcnRfZmRpX3R4KGQsIHAsIHRydWUpCj4gPiAgICNk
ZWZpbmUgYXNzZXJ0X2ZkaV90eF9kaXNhYmxlZChkLCBwKSBhc3NlcnRfZmRpX3R4KGQsIHAsIGZh
bHNlKQo+ID4gLXN0YXRpYyB2b2lkIGFzc2VydF9mZGlfcngoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGFzc2VydF9mZGlfcngoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgZW51bSBwaXBlIHBpcGUsIGJvb2wgc3RhdGUp
Cj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7Cj4gPiBAQCAtMTE1MSwyNCArMTE1MSwyNCBAQCBzdGF0
aWMgdm9pZCBhc3NlcnRfZmRpX3J4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICAgI2RlZmluZSBhc3NlcnRfZmRpX3J4X2VuYWJsZWQoZCwgcCkgYXNzZXJ0X2ZkaV9yeChk
LCBwLCB0cnVlKQo+ID4gICAjZGVmaW5lIGFzc2VydF9mZGlfcnhfZGlzYWJsZWQoZCwgcCkgYXNz
ZXJ0X2ZkaV9yeChkLCBwLCBmYWxzZSkKPiA+IC1zdGF0aWMgdm9pZCBhc3NlcnRfZmRpX3R4X3Bs
bF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMg
dm9pZCBhc3NlcnRfZmRpX3R4X3BsbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ID4gICAJCQkJICAgICAgZW51bSBwaXBlIHBpcGUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2
YWw7Cj4gPiAgIAkvKiBJTEsgRkRJIFBMTCBpcyBhbHdheXMgZW5hYmxlZCAqLwo+ID4gLQlpZiAo
SVNfR0VOKGRldl9wcml2LCA1KSkKPiA+ICsJaWYgKElTX0dFTihpOTE1LCA1KSkKPiA+ICAgCQly
ZXR1cm47Cj4gPiAgIAkvKiBPbiBIYXN3ZWxsLCBEREkgcG9ydHMgYXJlIHJlc3BvbnNpYmxlIGZv
ciB0aGUgRkRJIFBMTCBzZXR1cCAqLwo+ID4gLQlpZiAoSEFTX0RESShkZXZfcHJpdikpCj4gPiAr
CWlmIChIQVNfRERJKGk5MTUpKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCXZhbCA9IEk5MTVfUkVB
RChGRElfVFhfQ1RMKHBpcGUpKTsKPiA+ICAgCUk5MTVfU1RBVEVfV0FSTighKHZhbCAmIEZESV9U
WF9QTExfRU5BQkxFKSwgIkZESSBUWCBQTEwgYXNzZXJ0aW9uIGZhaWx1cmUsIHNob3VsZCBiZSBh
Y3RpdmUgYnV0IGlzIGRpc2FibGVkXG4iKTsKPiA+ICAgfQo+ID4gLXZvaWQgYXNzZXJ0X2ZkaV9y
eF9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgYXNzZXJ0
X2ZkaV9yeF9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICAg
IGVudW0gcGlwZSBwaXBlLCBib29sIHN0YXRlKQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4g
QEAgLTExODEsMTcgKzExODEsMTcgQEAgdm9pZCBhc3NlcnRfZmRpX3J4X3BsbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJCW9ub2ZmKHN0YXRlKSwgb25vZmYoY3Vy
X3N0YXRlKSk7Cj4gPiAgIH0KPiA+IC12b2lkIGFzc2VydF9wYW5lbF91bmxvY2tlZChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ID4gK3ZvaWQgYXNz
ZXJ0X3BhbmVsX3VubG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBp
cGUgcGlwZSkKPiA+ICAgewo+ID4gICAJaTkxNV9yZWdfdCBwcF9yZWc7Cj4gPiAgIAl1MzIgdmFs
Owo+ID4gICAJZW51bSBwaXBlIHBhbmVsX3BpcGUgPSBJTlZBTElEX1BJUEU7Cj4gPiAgIAlib29s
IGxvY2tlZCA9IHRydWU7Cj4gPiAtCWlmIChXQVJOX09OKEhBU19EREkoZGV2X3ByaXYpKSkKPiA+
ICsJaWYgKFdBUk5fT04oSEFTX0RESShpOTE1KSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlpZiAo
SEFTX1BDSF9TUExJVChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkp
IHsKPiA+ICAgCQl1MzIgcG9ydF9zZWw7Cj4gPiAgIAkJcHBfcmVnID0gUFBfQ09OVFJPTCgwKTsK
PiA+IEBAIC0xMTk5LDIyICsxMTk5LDIyIEBAIHZvaWQgYXNzZXJ0X3BhbmVsX3VubG9ja2VkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4gPiAgIAkJ
c3dpdGNoIChwb3J0X3NlbCkgewo+ID4gICAJCWNhc2UgUEFORUxfUE9SVF9TRUxFQ1RfTFZEUzoK
PiA+IC0JCQlpbnRlbF9sdmRzX3BvcnRfZW5hYmxlZChkZXZfcHJpdiwgUENIX0xWRFMsICZwYW5l
bF9waXBlKTsKPiA+ICsJCQlpbnRlbF9sdmRzX3BvcnRfZW5hYmxlZChpOTE1LCBQQ0hfTFZEUywg
JnBhbmVsX3BpcGUpOwo+ID4gICAJCQlicmVhazsKPiA+ICAgCQljYXNlIFBBTkVMX1BPUlRfU0VM
RUNUX0RQQToKPiA+IC0JCQlpbnRlbF9kcF9wb3J0X2VuYWJsZWQoZGV2X3ByaXYsIERQX0EsIFBP
UlRfQSwgJnBhbmVsX3BpcGUpOwo+ID4gKwkJCWludGVsX2RwX3BvcnRfZW5hYmxlZChpOTE1LCBE
UF9BLCBQT1JUX0EsICZwYW5lbF9waXBlKTsKPiA+ICAgCQkJYnJlYWs7Cj4gPiAgIAkJY2FzZSBQ
QU5FTF9QT1JUX1NFTEVDVF9EUEM6Cj4gPiAtCQkJaW50ZWxfZHBfcG9ydF9lbmFibGVkKGRldl9w
cml2LCBQQ0hfRFBfQywgUE9SVF9DLCAmcGFuZWxfcGlwZSk7Cj4gPiArCQkJaW50ZWxfZHBfcG9y
dF9lbmFibGVkKGk5MTUsIFBDSF9EUF9DLCBQT1JUX0MsICZwYW5lbF9waXBlKTsKPiA+ICAgCQkJ
YnJlYWs7Cj4gPiAgIAkJY2FzZSBQQU5FTF9QT1JUX1NFTEVDVF9EUEQ6Cj4gPiAtCQkJaW50ZWxf
ZHBfcG9ydF9lbmFibGVkKGRldl9wcml2LCBQQ0hfRFBfRCwgUE9SVF9ELCAmcGFuZWxfcGlwZSk7
Cj4gPiArCQkJaW50ZWxfZHBfcG9ydF9lbmFibGVkKGk5MTUsIFBDSF9EUF9ELCBQT1JUX0QsICZw
YW5lbF9waXBlKTsKPiA+ICAgCQkJYnJlYWs7Cj4gPiAgIAkJZGVmYXVsdDoKPiA+ICAgCQkJTUlT
U0lOR19DQVNFKHBvcnRfc2VsKTsKPiA+ICAgCQkJYnJlYWs7Cj4gPiAgIAkJfQo+ID4gLQl9IGVs
c2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYp
KSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVX
KGk5MTUpKSB7Cj4gPiAgIAkJLyogcHJlc3VtYWJseSB3cml0ZSBsb2NrIGRlcGVuZHMgb24gcGlw
ZSwgbm90IHBvcnQgc2VsZWN0ICovCj4gPiAgIAkJcHBfcmVnID0gUFBfQ09OVFJPTChwaXBlKTsK
PiA+ICAgCQlwYW5lbF9waXBlID0gcGlwZTsKPiA+IEBAIC0xMjI1LDcgKzEyMjUsNyBAQCB2b2lk
IGFzc2VydF9wYW5lbF91bmxvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IGVudW0gcGlwZSBwaXBlKQo+ID4gICAJCXBvcnRfc2VsID0gSTkxNV9SRUFEKFBQX09OX0RFTEFZ
UygwKSkgJiBQQU5FTF9QT1JUX1NFTEVDVF9NQVNLOwo+ID4gICAJCVdBUk5fT04ocG9ydF9zZWwg
IT0gUEFORUxfUE9SVF9TRUxFQ1RfTFZEUyk7Cj4gPiAtCQlpbnRlbF9sdmRzX3BvcnRfZW5hYmxl
ZChkZXZfcHJpdiwgTFZEUywgJnBhbmVsX3BpcGUpOwo+ID4gKwkJaW50ZWxfbHZkc19wb3J0X2Vu
YWJsZWQoaTkxNSwgTFZEUywgJnBhbmVsX3BpcGUpOwo+ID4gICAJfQo+ID4gICAJdmFsID0gSTkx
NV9SRUFEKHBwX3JlZyk7Cj4gPiBAQCAtMTIzOCwyNiArMTIzOCwyNiBAQCB2b2lkIGFzc2VydF9w
YW5lbF91bmxvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlw
ZSBwaXBlKQo+ID4gICAJICAgICBwaXBlX25hbWUocGlwZSkpOwo+ID4gICB9Cj4gPiAtdm9pZCBh
c3NlcnRfcGlwZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBh
c3NlcnRfcGlwZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkgZW51bSBw
aXBlIHBpcGUsIGJvb2wgc3RhdGUpCj4gPiAgIHsKPiA+ICAgCWJvb2wgY3VyX3N0YXRlOwo+ID4g
LQllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBpbnRlbF9waXBlX3RvX2NwdV90cmFu
c2NvZGVyKGRldl9wcml2LAo+ID4gKwllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBp
bnRlbF9waXBlX3RvX2NwdV90cmFuc2NvZGVyKGk5MTUsCj4gPiAgIAkJCQkJCQkJICAgICAgcGlw
ZSk7Cj4gPiAgIAllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIHBvd2VyX2RvbWFpbjsK
PiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJLyogd2Uga2VlcCBib3RoIHBp
cGVzIGVuYWJsZWQgb24gODMwICovCj4gPiAtCWlmIChJU19JODMwKGRldl9wcml2KSkKPiA+ICsJ
aWYgKElTX0k4MzAoaTkxNSkpCj4gPiAgIAkJc3RhdGUgPSB0cnVlOwo+ID4gICAJcG93ZXJfZG9t
YWluID0gUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVIoY3B1X3RyYW5zY29kZXIpOwo+ID4gLQl3YWtl
cmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJf
ZG9tYWluKTsKPiA+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJs
ZWQoaTkxNSwgcG93ZXJfZG9tYWluKTsKPiA+ICAgCWlmICh3YWtlcmVmKSB7Cj4gPiAgIAkJdTMy
IHZhbCA9IEk5MTVfUkVBRChQSVBFQ09ORihjcHVfdHJhbnNjb2RlcikpOwo+ID4gICAJCWN1cl9z
dGF0ZSA9ICEhKHZhbCAmIFBJUEVDT05GX0VOQUJMRSk7Cj4gPiAtCQlpbnRlbF9kaXNwbGF5X3Bv
d2VyX3B1dChkZXZfcHJpdiwgcG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiA+ICsJCWludGVsX2Rp
c3BsYXlfcG93ZXJfcHV0KGk5MTUsIHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiAgIAl9IGVs
c2Ugewo+ID4gICAJCWN1cl9zdGF0ZSA9IGZhbHNlOwo+ID4gICAJfQo+ID4gQEAgLTEyODQsMTAg
KzEyODQsMTAgQEAgc3RhdGljIHZvaWQgYXNzZXJ0X3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAq
cGxhbmUsIGJvb2wgc3RhdGUpCj4gPiAgIHN0YXRpYyB2b2lkIGFzc2VydF9wbGFuZXNfZGlzYWJs
ZWQoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lOwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9wbGFuZV9v
bl9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRjLCBwbGFuZSkKPiA+ICsJZm9yX2VhY2hfaW50ZWxf
cGxhbmVfb25fY3J0YygmaTkxNS0+ZHJtLCBjcnRjLCBwbGFuZSkKPiA+ICAgCQlhc3NlcnRfcGxh
bmVfZGlzYWJsZWQocGxhbmUpOwo+ID4gICB9Cj4gPiBAQCAtMTI5Nyw3ICsxMjk3LDcgQEAgc3Rh
dGljIHZvaWQgYXNzZXJ0X3ZibGFua19kaXNhYmxlZChzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCj4g
PiAgIAkJZHJtX2NydGNfdmJsYW5rX3B1dChjcnRjKTsKPiA+ICAgfQo+ID4gLXZvaWQgYXNzZXJ0
X3BjaF90cmFuc2NvZGVyX2Rpc2FibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICt2b2lkIGFzc2VydF9wY2hfdHJhbnNjb2Rlcl9kaXNhYmxlZChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+
ID4gICAJdTMyIHZhbDsKPiA+IEBAIC0xMzEwLDc4ICsxMzEwLDc4IEBAIHZvaWQgYXNzZXJ0X3Bj
aF90cmFuc2NvZGVyX2Rpc2FibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICAgCSAgICAgcGlwZV9uYW1lKHBpcGUpKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGFz
c2VydF9wY2hfZHBfZGlzYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3N0YXRpYyB2b2lkIGFzc2VydF9wY2hfZHBfZGlzYWJsZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICBlbnVtIHBpcGUgcGlwZSwgZW51bSBwb3J0IHBvcnQs
Cj4gPiAgIAkJCQkgICBpOTE1X3JlZ190IGRwX3JlZykKPiA+ICAgewo+ID4gICAJZW51bSBwaXBl
IHBvcnRfcGlwZTsKPiA+ICAgCWJvb2wgc3RhdGU7Cj4gPiAtCXN0YXRlID0gaW50ZWxfZHBfcG9y
dF9lbmFibGVkKGRldl9wcml2LCBkcF9yZWcsIHBvcnQsICZwb3J0X3BpcGUpOwo+ID4gKwlzdGF0
ZSA9IGludGVsX2RwX3BvcnRfZW5hYmxlZChpOTE1LCBkcF9yZWcsIHBvcnQsICZwb3J0X3BpcGUp
Owo+ID4gICAJSTkxNV9TVEFURV9XQVJOKHN0YXRlICYmIHBvcnRfcGlwZSA9PSBwaXBlLAo+ID4g
ICAJCQkiUENIIERQICVjIGVuYWJsZWQgb24gdHJhbnNjb2RlciAlYywgc2hvdWxkIGJlIGRpc2Fi
bGVkXG4iLAo+ID4gICAJCQlwb3J0X25hbWUocG9ydCksIHBpcGVfbmFtZShwaXBlKSk7Cj4gPiAt
CUk5MTVfU1RBVEVfV0FSTihIQVNfUENIX0lCWChkZXZfcHJpdikgJiYgIXN0YXRlICYmIHBvcnRf
cGlwZSA9PSBQSVBFX0IsCj4gPiArCUk5MTVfU1RBVEVfV0FSTihIQVNfUENIX0lCWChpOTE1KSAm
JiAhc3RhdGUgJiYgcG9ydF9waXBlID09IFBJUEVfQiwKPiA+ICAgCQkJIklCWCBQQ0ggRFAgJWMg
c3RpbGwgdXNpbmcgdHJhbnNjb2RlciBCXG4iLAo+ID4gICAJCQlwb3J0X25hbWUocG9ydCkpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgYXNzZXJ0X3BjaF9oZG1pX2Rpc2FibGVkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBhc3NlcnRfcGNoX2hk
bWlfZGlzYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAg
IGVudW0gcGlwZSBwaXBlLCBlbnVtIHBvcnQgcG9ydCwKPiA+ICAgCQkJCSAgICAgaTkxNV9yZWdf
dCBoZG1pX3JlZykKPiA+ICAgewo+ID4gICAJZW51bSBwaXBlIHBvcnRfcGlwZTsKPiA+ICAgCWJv
b2wgc3RhdGU7Cj4gPiAtCXN0YXRlID0gaW50ZWxfc2R2b19wb3J0X2VuYWJsZWQoZGV2X3ByaXYs
IGhkbWlfcmVnLCAmcG9ydF9waXBlKTsKPiA+ICsJc3RhdGUgPSBpbnRlbF9zZHZvX3BvcnRfZW5h
YmxlZChpOTE1LCBoZG1pX3JlZywgJnBvcnRfcGlwZSk7Cj4gPiAgIAlJOTE1X1NUQVRFX1dBUk4o
c3RhdGUgJiYgcG9ydF9waXBlID09IHBpcGUsCj4gPiAgIAkJCSJQQ0ggSERNSSAlYyBlbmFibGVk
IG9uIHRyYW5zY29kZXIgJWMsIHNob3VsZCBiZSBkaXNhYmxlZFxuIiwKPiA+ICAgCQkJcG9ydF9u
YW1lKHBvcnQpLCBwaXBlX25hbWUocGlwZSkpOwo+ID4gLQlJOTE1X1NUQVRFX1dBUk4oSEFTX1BD
SF9JQlgoZGV2X3ByaXYpICYmICFzdGF0ZSAmJiBwb3J0X3BpcGUgPT0gUElQRV9CLAo+ID4gKwlJ
OTE1X1NUQVRFX1dBUk4oSEFTX1BDSF9JQlgoaTkxNSkgJiYgIXN0YXRlICYmIHBvcnRfcGlwZSA9
PSBQSVBFX0IsCj4gPiAgIAkJCSJJQlggUENIIEhETUkgJWMgc3RpbGwgdXNpbmcgdHJhbnNjb2Rl
ciBCXG4iLAo+ID4gICAJCQlwb3J0X25hbWUocG9ydCkpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgYXNzZXJ0X3BjaF9wb3J0c19kaXNhYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgYXNzZXJ0X3BjaF9wb3J0c19kaXNhYmxlZChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgIGVudW0gcGlwZSBwaXBlKQo+
ID4gICB7Cj4gPiAgIAllbnVtIHBpcGUgcG9ydF9waXBlOwo+ID4gLQlhc3NlcnRfcGNoX2RwX2Rp
c2FibGVkKGRldl9wcml2LCBwaXBlLCBQT1JUX0IsIFBDSF9EUF9CKTsKPiA+IC0JYXNzZXJ0X3Bj
aF9kcF9kaXNhYmxlZChkZXZfcHJpdiwgcGlwZSwgUE9SVF9DLCBQQ0hfRFBfQyk7Cj4gPiAtCWFz
c2VydF9wY2hfZHBfZGlzYWJsZWQoZGV2X3ByaXYsIHBpcGUsIFBPUlRfRCwgUENIX0RQX0QpOwo+
ID4gKwlhc3NlcnRfcGNoX2RwX2Rpc2FibGVkKGk5MTUsIHBpcGUsIFBPUlRfQiwgUENIX0RQX0Ip
Owo+ID4gKwlhc3NlcnRfcGNoX2RwX2Rpc2FibGVkKGk5MTUsIHBpcGUsIFBPUlRfQywgUENIX0RQ
X0MpOwo+ID4gKwlhc3NlcnRfcGNoX2RwX2Rpc2FibGVkKGk5MTUsIHBpcGUsIFBPUlRfRCwgUENI
X0RQX0QpOwo+ID4gLQlJOTE1X1NUQVRFX1dBUk4oaW50ZWxfY3J0X3BvcnRfZW5hYmxlZChkZXZf
cHJpdiwgUENIX0FEUEEsICZwb3J0X3BpcGUpICYmCj4gPiArCUk5MTVfU1RBVEVfV0FSTihpbnRl
bF9jcnRfcG9ydF9lbmFibGVkKGk5MTUsIFBDSF9BRFBBLCAmcG9ydF9waXBlKSAmJgo+ID4gICAJ
CQlwb3J0X3BpcGUgPT0gcGlwZSwKPiA+ICAgCQkJIlBDSCBWR0EgZW5hYmxlZCBvbiB0cmFuc2Nv
ZGVyICVjLCBzaG91bGQgYmUgZGlzYWJsZWRcbiIsCj4gPiAgIAkJCXBpcGVfbmFtZShwaXBlKSk7
Cj4gPiAtCUk5MTVfU1RBVEVfV0FSTihpbnRlbF9sdmRzX3BvcnRfZW5hYmxlZChkZXZfcHJpdiwg
UENIX0xWRFMsICZwb3J0X3BpcGUpICYmCj4gPiArCUk5MTVfU1RBVEVfV0FSTihpbnRlbF9sdmRz
X3BvcnRfZW5hYmxlZChpOTE1LCBQQ0hfTFZEUywgJnBvcnRfcGlwZSkgJiYKPiA+ICAgCQkJcG9y
dF9waXBlID09IHBpcGUsCj4gPiAgIAkJCSJQQ0ggTFZEUyBlbmFibGVkIG9uIHRyYW5zY29kZXIg
JWMsIHNob3VsZCBiZSBkaXNhYmxlZFxuIiwKPiA+ICAgCQkJcGlwZV9uYW1lKHBpcGUpKTsKPiA+
ICAgCS8qIFBDSCBTRFZPQiBtdWx0aXBsZXggd2l0aCBIRE1JQiAqLwo+ID4gLQlhc3NlcnRfcGNo
X2hkbWlfZGlzYWJsZWQoZGV2X3ByaXYsIHBpcGUsIFBPUlRfQiwgUENIX0hETUlCKTsKPiA+IC0J
YXNzZXJ0X3BjaF9oZG1pX2Rpc2FibGVkKGRldl9wcml2LCBwaXBlLCBQT1JUX0MsIFBDSF9IRE1J
Qyk7Cj4gPiAtCWFzc2VydF9wY2hfaGRtaV9kaXNhYmxlZChkZXZfcHJpdiwgcGlwZSwgUE9SVF9E
LCBQQ0hfSERNSUQpOwo+ID4gKwlhc3NlcnRfcGNoX2hkbWlfZGlzYWJsZWQoaTkxNSwgcGlwZSwg
UE9SVF9CLCBQQ0hfSERNSUIpOwo+ID4gKwlhc3NlcnRfcGNoX2hkbWlfZGlzYWJsZWQoaTkxNSwg
cGlwZSwgUE9SVF9DLCBQQ0hfSERNSUMpOwo+ID4gKwlhc3NlcnRfcGNoX2hkbWlfZGlzYWJsZWQo
aTkxNSwgcGlwZSwgUE9SVF9ELCBQQ0hfSERNSUQpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lk
IF92bHZfZW5hYmxlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJICAgIGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+ICAgCUk5MTVf
V1JJVEUoRFBMTChwaXBlKSwgcGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGUuZHBsbCk7Cj4gPiAg
IAlQT1NUSU5HX1JFQUQoRFBMTChwaXBlKSk7Cj4gPiAgIAl1ZGVsYXkoMTUwKTsKPiA+IC0JaWYg
KGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ID4gKwlpZiAoaW50
ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiA+ICAgCQkJCSAgICBEUExMKHBp
cGUpLAo+ID4gICAJCQkJICAgIERQTExfTE9DS19WTFYsCj4gPiAgIAkJCQkgICAgRFBMTF9MT0NL
X1ZMViwKPiA+IEBAIC0xMzkyLDEzICsxMzkyLDEzIEBAIHN0YXRpYyB2b2lkIF92bHZfZW5hYmxl
X3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgc3RhdGljIHZvaWQgdmx2X2VuYWJs
ZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCSAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+
ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+IC0JYXNzZXJ0X3BpcGVfZGlzYWJs
ZWQoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlhc3NlcnRfcGlwZV9kaXNhYmxlZChpOTE1LCBwaXBl
KTsKPiA+ICAgCS8qIFBMTCBpcyBwcm90ZWN0ZWQgYnkgcGFuZWwsIG1ha2Ugc3VyZSB3ZSBjYW4g
d3JpdGUgaXQgKi8KPiA+IC0JYXNzZXJ0X3BhbmVsX3VubG9ja2VkKGRldl9wcml2LCBwaXBlKTsK
PiA+ICsJYXNzZXJ0X3BhbmVsX3VubG9ja2VkKGk5MTUsIHBpcGUpOwo+ID4gICAJaWYgKHBpcGVf
Y29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGwgJiBEUExMX1ZDT19FTkFCTEUpCj4gPiAgIAkJX3Zs
dl9lbmFibGVfcGxsKGNydGMsIHBpcGVfY29uZmlnKTsKPiA+IEBAIC0xNDExLDE5ICsxNDExLDE5
IEBAIHN0YXRpYyB2b2lkIHZsdl9lbmFibGVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+
ID4gICBzdGF0aWMgdm9pZCBfY2h2X2VuYWJsZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMs
Cj4gPiAgIAkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBp
cGU7Cj4gPiAgIAllbnVtIGRwaW9fY2hhbm5lbCBwb3J0ID0gdmx2X3BpcGVfdG9fY2hhbm5lbChw
aXBlKTsKPiA+ICAgCXUzMiB0bXA7Cj4gPiAtCXZsdl9kcGlvX2dldChkZXZfcHJpdik7Cj4gPiAr
CXZsdl9kcGlvX2dldChpOTE1KTsKPiA+ICAgCS8qIEVuYWJsZSBiYWNrIHRoZSAxMGJpdCBjbG9j
ayB0byBkaXNwbGF5IGNvbnRyb2xsZXIgKi8KPiA+IC0JdG1wID0gdmx2X2RwaW9fcmVhZChkZXZf
cHJpdiwgcGlwZSwgQ0hWX0NNTl9EVzE0KHBvcnQpKTsKPiA+ICsJdG1wID0gdmx2X2RwaW9fcmVh
ZChpOTE1LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9ydCkpOwo+ID4gICAJdG1wIHw9IERQSU9fRENM
S1BfRU47Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTQo
cG9ydCksIHRtcCk7Cj4gPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIENIVl9DTU5fRFcx
NChwb3J0KSwgdG1wKTsKPiA+IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKPiA+ICsJdmx2X2Rw
aW9fcHV0KGk5MTUpOwo+ID4gICAJLyoKPiA+ICAgCSAqIE5lZWQgdG8gd2FpdCA+IDEwMG5zIGJl
dHdlZW4gZGNsa3AgY2xvY2sgZW5hYmxlIGJpdCBhbmQgUExMIGVuYWJsZS4KPiA+IEBAIC0xNDM0
LDcgKzE0MzQsNyBAQCBzdGF0aWMgdm9pZCBfY2h2X2VuYWJsZV9wbGwoc3RydWN0IGludGVsX2Ny
dGMgKmNydGMsCj4gPiAgIAlJOTE1X1dSSVRFKERQTEwocGlwZSksIHBpcGVfY29uZmlnLT5kcGxs
X2h3X3N0YXRlLmRwbGwpOwo+ID4gICAJLyogQ2hlY2sgUExMIGlzIGxvY2tlZCAqLwo+ID4gLQlp
ZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCWlmIChp
bnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJICAgIERQTEwo
cGlwZSksIERQTExfTE9DS19WTFYsIERQTExfTE9DS19WTFYsCj4gPiAgIAkJCQkgICAgMSkpCj4g
PiAgIAkJRFJNX0VSUk9SKCJQTEwgJWQgZmFpbGVkIHRvIGxvY2tcbiIsIHBpcGUpOwo+ID4gQEAg
LTE0NDMsMTMgKzE0NDMsMTMgQEAgc3RhdGljIHZvaWQgX2Nodl9lbmFibGVfcGxsKHN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjLAo+ID4gICBzdGF0aWMgdm9pZCBjaHZfZW5hYmxlX3BsbChzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKnBpcGVfY29uZmlnKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwaXBl
IHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gLQlhc3NlcnRfcGlwZV9kaXNhYmxlZChkZXZfcHJpdiwg
cGlwZSk7Cj4gPiArCWFzc2VydF9waXBlX2Rpc2FibGVkKGk5MTUsIHBpcGUpOwo+ID4gICAJLyog
UExMIGlzIHByb3RlY3RlZCBieSBwYW5lbCwgbWFrZSBzdXJlIHdlIGNhbiB3cml0ZSBpdCAqLwo+
ID4gLQlhc3NlcnRfcGFuZWxfdW5sb2NrZWQoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlhc3NlcnRf
cGFuZWxfdW5sb2NrZWQoaTkxNSwgcGlwZSk7Cj4gPiAgIAlpZiAocGlwZV9jb25maWctPmRwbGxf
aHdfc3RhdGUuZHBsbCAmIERQTExfVkNPX0VOQUJMRSkKPiA+ICAgCQlfY2h2X2VuYWJsZV9wbGwo
Y3J0YywgcGlwZV9jb25maWcpOwo+ID4gQEAgLTE0NjQsNyArMTQ2NCw3IEBAIHN0YXRpYyB2b2lk
IGNodl9lbmFibGVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCUk5MTVfV1JJ
VEUoQ0JSNF9WTFYsIENCUl9EUExMQk1EX1BJUEUocGlwZSkpOwo+ID4gICAJCUk5MTVfV1JJVEUo
RFBMTF9NRChQSVBFX0IpLCBwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZS5kcGxsX21kKTsKPiA+
ICAgCQlJOTE1X1dSSVRFKENCUjRfVkxWLCAwKTsKPiA+IC0JCWRldl9wcml2LT5jaHZfZHBsbF9t
ZFtwaXBlXSA9IHBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGxfbWQ7Cj4gPiArCQlpOTE1
LT5jaHZfZHBsbF9tZFtwaXBlXSA9IHBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGxfbWQ7
Cj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBEUExMQiBWR0EgbW9kZSBhbHNvIHNlZW1zIHRvIGNhdXNl
IHByb2JsZW1zLgo+ID4gQEAgLTE0NzcsMjcgKzE0NzcsMjcgQEAgc3RhdGljIHZvaWQgY2h2X2Vu
YWJsZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1z
dGF0aWMgYm9vbCBpOXh4X2hhc19wcHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gK3N0YXRpYyBib29sIGk5eHhfaGFzX3BwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoSVNfSTgzMChkZXZfcHJpdikpCj4gPiArCWlmIChJU19J
ODMwKGk5MTUpKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IC0JcmV0dXJuIElTX1BJTkVWSUVX
KGRldl9wcml2KSB8fCBJU19NT0JJTEUoZGV2X3ByaXYpOwo+ID4gKwlyZXR1cm4gSVNfUElORVZJ
RVcoaTkxNSkgfHwgSVNfTU9CSUxFKGk5MTUpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGk5
eHhfZW5hYmxlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJICAgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+ID4gICAJaTkxNV9yZWdfdCByZWcgPSBEUExMKGNydGMtPnBpcGUpOwo+ID4gICAJdTMy
IGRwbGwgPSBjcnRjX3N0YXRlLT5kcGxsX2h3X3N0YXRlLmRwbGw7Cj4gPiAgIAlpbnQgaTsKPiA+
IC0JYXNzZXJ0X3BpcGVfZGlzYWJsZWQoZGV2X3ByaXYsIGNydGMtPnBpcGUpOwo+ID4gKwlhc3Nl
cnRfcGlwZV9kaXNhYmxlZChpOTE1LCBjcnRjLT5waXBlKTsKPiA+ICAgCS8qIFBMTCBpcyBwcm90
ZWN0ZWQgYnkgcGFuZWwsIG1ha2Ugc3VyZSB3ZSBjYW4gd3JpdGUgaXQgKi8KPiA+IC0JaWYgKGk5
eHhfaGFzX3BwcyhkZXZfcHJpdikpCj4gPiAtCQlhc3NlcnRfcGFuZWxfdW5sb2NrZWQoZGV2X3By
aXYsIGNydGMtPnBpcGUpOwo+ID4gKwlpZiAoaTl4eF9oYXNfcHBzKGk5MTUpKQo+ID4gKwkJYXNz
ZXJ0X3BhbmVsX3VubG9ja2VkKGk5MTUsIGNydGMtPnBpcGUpOwo+ID4gICAJLyoKPiA+ICAgCSAq
IEFwcGFyZW50bHkgd2UgbmVlZCB0byBoYXZlIFZHQSBtb2RlIGVuYWJsZWQgcHJpb3IgdG8gY2hh
bmdpbmcKPiA+IEBAIC0xNTExLDcgKzE1MTEsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X2VuYWJsZV9w
bGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAlQT1NUSU5HX1JFQUQocmVnKTsKPiA+
ICAgCXVkZWxheSgxNTApOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KSB7Cj4g
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkgewo+ID4gICAJCUk5MTVfV1JJVEUoRFBMTF9N
RChjcnRjLT5waXBlKSwKPiA+ICAgCQkJICAgY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5kcGxs
X21kKTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiBAQCAtMTUzNCwyNiArMTUzNCwyNiBAQCBzdGF0aWMg
dm9pZCBpOXh4X2VuYWJsZV9wbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIHN0YXRp
YyB2b2lkIGk5eHhfZGlzYWJsZV9wbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWVu
dW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+ICAgCS8qIERvbid0IGRpc2FibGUgcGlwZSBv
ciBwaXBlIFBMTHMgaWYgbmVlZGVkICovCj4gPiAtCWlmIChJU19JODMwKGRldl9wcml2KSkKPiA+
ICsJaWYgKElTX0k4MzAoaTkxNSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJLyogTWFrZSBzdXJl
IHRoZSBwaXBlIGlzbid0IHN0aWxsIHJlbHlpbmcgb24gdXMgKi8KPiA+IC0JYXNzZXJ0X3BpcGVf
ZGlzYWJsZWQoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlhc3NlcnRfcGlwZV9kaXNhYmxlZChpOTE1
LCBwaXBlKTsKPiA+ICAgCUk5MTVfV1JJVEUoRFBMTChwaXBlKSwgRFBMTF9WR0FfTU9ERV9ESVMp
Owo+ID4gICAJUE9TVElOR19SRUFEKERQTEwocGlwZSkpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgdmx2X2Rpc2FibGVfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51
bSBwaXBlIHBpcGUpCj4gPiArc3RhdGljIHZvaWQgdmx2X2Rpc2FibGVfcGxsKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gICAJdTMyIHZh
bDsKPiA+ICAgCS8qIE1ha2Ugc3VyZSB0aGUgcGlwZSBpc24ndCBzdGlsbCByZWx5aW5nIG9uIHVz
ICovCj4gPiAtCWFzc2VydF9waXBlX2Rpc2FibGVkKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJYXNz
ZXJ0X3BpcGVfZGlzYWJsZWQoaTkxNSwgcGlwZSk7Cj4gPiAgIAl2YWwgPSBEUExMX0lOVEVHUkFU
RURfUkVGX0NMS19WTFYgfAo+ID4gICAJCURQTExfUkVGX0NMS19FTkFCTEVfVkxWIHwgRFBMTF9W
R0FfTU9ERV9ESVM7Cj4gPiBAQCAtMTU2NCwxMyArMTU2NCwxMyBAQCBzdGF0aWMgdm9pZCB2bHZf
ZGlzYWJsZV9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUg
cGlwZSkKPiA+ICAgCVBPU1RJTkdfUkVBRChEUExMKHBpcGUpKTsKPiA+ICAgfQo+ID4gLXN0YXRp
YyB2b2lkIGNodl9kaXNhYmxlX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IGVudW0gcGlwZSBwaXBlKQo+ID4gK3N0YXRpYyB2b2lkIGNodl9kaXNhYmxlX3BsbChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwaXBlIHBpcGUpCj4gPiAgIHsKPiA+ICAgCWVu
dW0gZHBpb19jaGFubmVsIHBvcnQgPSB2bHZfcGlwZV90b19jaGFubmVsKHBpcGUpOwo+ID4gICAJ
dTMyIHZhbDsKPiA+ICAgCS8qIE1ha2Ugc3VyZSB0aGUgcGlwZSBpc24ndCBzdGlsbCByZWx5aW5n
IG9uIHVzICovCj4gPiAtCWFzc2VydF9waXBlX2Rpc2FibGVkKGRldl9wcml2LCBwaXBlKTsKPiA+
ICsJYXNzZXJ0X3BpcGVfZGlzYWJsZWQoaTkxNSwgcGlwZSk7Cj4gPiAgIAl2YWwgPSBEUExMX1NT
Q19SRUZfQ0xLX0NIViB8Cj4gPiAgIAkJRFBMTF9SRUZfQ0xLX0VOQUJMRV9WTFYgfCBEUExMX1ZH
QV9NT0RFX0RJUzsKPiA+IEBAIC0xNTgwLDE3ICsxNTgwLDE3IEBAIHN0YXRpYyB2b2lkIGNodl9k
aXNhYmxlX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBw
aXBlKQo+ID4gICAJSTkxNV9XUklURShEUExMKHBpcGUpLCB2YWwpOwo+ID4gICAJUE9TVElOR19S
RUFEKERQTEwocGlwZSkpOwo+ID4gLQl2bHZfZHBpb19nZXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZf
ZHBpb19nZXQoaTkxNSk7Cj4gPiAgIAkvKiBEaXNhYmxlIDEwYml0IGNsb2NrIHRvIGRpc3BsYXkg
Y29udHJvbGxlciAqLwo+ID4gLQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBD
SFZfQ01OX0RXMTQocG9ydCkpOwo+ID4gKwl2YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUs
IENIVl9DTU5fRFcxNChwb3J0KSk7Cj4gPiAgIAl2YWwgJj0gfkRQSU9fRENMS1BfRU47Cj4gPiAt
CXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9ydCksIHZhbCk7
Cj4gPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIENIVl9DTU5fRFcxNChwb3J0KSwgdmFs
KTsKPiA+IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKPiA+ICsJdmx2X2RwaW9fcHV0KGk5MTUp
Owo+ID4gICB9Cj4gPiAtdm9pZCB2bHZfd2FpdF9wb3J0X3JlYWR5KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIHZsdl93YWl0X3BvcnRfcmVhZHkoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSBzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICpkcG9ydCwKPiA+ICAgCQkJIHVuc2lnbmVkIGludCBleHBlY3RlZF9tYXNrKQo+ID4gICB7Cj4g
PiBAQCAtMTYxNSw3ICsxNjE1LDcgQEAgdm9pZCB2bHZfd2FpdF9wb3J0X3JlYWR5KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQlCVUcoKTsKPiA+ICAgCX0KPiA+IC0J
aWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ID4gKwlpZiAo
aW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiA+ICAgCQkJCSAgICBkcGxs
X3JlZywgcG9ydF9tYXNrLCBleHBlY3RlZF9tYXNrLAo+ID4gICAJCQkJICAgIDEwMDApKQo+ID4g
ICAJCVdBUk4oMSwgInRpbWVkIG91dCB3YWl0aW5nIGZvciBwb3J0ICVjIHJlYWR5OiBnb3QgMHgl
eCwgZXhwZWN0ZWQgMHgleFxuIiwKPiA+IEBAIC0xNjI2LDE5ICsxNjI2LDE5IEBAIHZvaWQgdmx2
X3dhaXRfcG9ydF9yZWFkeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAg
IHN0YXRpYyB2b2lkIGlyb25sYWtlX2VuYWJsZV9wY2hfdHJhbnNjb2Rlcihjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJaTkx
NV9yZWdfdCByZWc7Cj4gPiAgIAl1MzIgdmFsLCBwaXBlY29uZl92YWw7Cj4gPiAgIAkvKiBNYWtl
IHN1cmUgUENIIERQTEwgaXMgZW5hYmxlZCAqLwo+ID4gLQlhc3NlcnRfc2hhcmVkX2RwbGxfZW5h
YmxlZChkZXZfcHJpdiwgY3J0Y19zdGF0ZS0+c2hhcmVkX2RwbGwpOwo+ID4gKwlhc3NlcnRfc2hh
cmVkX2RwbGxfZW5hYmxlZChpOTE1LCBjcnRjX3N0YXRlLT5zaGFyZWRfZHBsbCk7Cj4gPiAgIAkv
KiBGREkgbXVzdCBiZSBmZWVkaW5nIHVzIGJpdHMgZm9yIFBDSCBwb3J0cyAqLwo+ID4gLQlhc3Nl
cnRfZmRpX3R4X2VuYWJsZWQoZGV2X3ByaXYsIHBpcGUpOwo+ID4gLQlhc3NlcnRfZmRpX3J4X2Vu
YWJsZWQoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlhc3NlcnRfZmRpX3R4X2VuYWJsZWQoaTkxNSwg
cGlwZSk7Cj4gPiArCWFzc2VydF9mZGlfcnhfZW5hYmxlZChpOTE1LCBwaXBlKTsKPiA+IC0JaWYg
KEhBU19QQ0hfQ1BUKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX1BDSF9DUFQoaTkxNSkpIHsK
PiA+ICAgCQkvKiBXb3JrYXJvdW5kOiBTZXQgdGhlIHRpbWluZyBvdmVycmlkZSBiaXQgYmVmb3Jl
IGVuYWJsaW5nIHRoZQo+ID4gICAJCSAqIHBjaCB0cmFuc2NvZGVyLiAqLwo+ID4gICAJCXJlZyA9
IFRSQU5TX0NISUNLRU4yKHBpcGUpOwo+ID4gQEAgLTE2NTEsNyArMTY1MSw3IEBAIHN0YXRpYyB2
b2lkIGlyb25sYWtlX2VuYWJsZV9wY2hfdHJhbnNjb2Rlcihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zCj4gPiAgIAl2YWwgPSBJOTE1X1JFQUQocmVnKTsKPiA+ICAgCXBpcGVj
b25mX3ZhbCA9IEk5MTVfUkVBRChQSVBFQ09ORihwaXBlKSk7Cj4gPiAtCWlmIChIQVNfUENIX0lC
WChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19QQ0hfSUJYKGk5MTUpKSB7Cj4gPiAgIAkJLyoK
PiA+ICAgCQkgKiBNYWtlIHRoZSBCUEMgaW4gdHJhbnNjb2RlciBiZSBjb25zaXN0ZW50IHdpdGgK
PiA+ICAgCQkgKiB0aGF0IGluIHBpcGVjb25mIHJlZy4gRm9yIEhETUkgd2UgbXVzdCB1c2UgOGJw
Ywo+ID4gQEAgLTE2NjYsNyArMTY2Niw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2VuYWJsZV9w
Y2hfdHJhbnNjb2Rlcihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zCj4gPiAg
IAl2YWwgJj0gflRSQU5TX0lOVEVSTEFDRV9NQVNLOwo+ID4gICAJaWYgKChwaXBlY29uZl92YWwg
JiBQSVBFQ09ORl9JTlRFUkxBQ0VfTUFTSykgPT0gUElQRUNPTkZfSU5URVJMQUNFRF9JTEspIHsK
PiA+IC0JCWlmIChIQVNfUENIX0lCWChkZXZfcHJpdikgJiYKPiA+ICsJCWlmIChIQVNfUENIX0lC
WChpOTE1KSAmJgo+ID4gICAJCSAgICBpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElO
VEVMX09VVFBVVF9TRFZPKSkKPiA+ICAgCQkJdmFsIHw9IFRSQU5TX0xFR0FDWV9JTlRFUkxBQ0VE
X0lMSzsKPiA+ICAgCQllbHNlCj4gPiBAQCAtMTY3NiwyMCArMTY3NiwyMCBAQCBzdGF0aWMgdm9p
ZCBpcm9ubGFrZV9lbmFibGVfcGNoX3RyYW5zY29kZXIoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfcwo+ID4gICAJfQo+ID4gICAJSTkxNV9XUklURShyZWcsIHZhbCB8IFRSQU5T
X0VOQUJMRSk7Cj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVu
Y29yZSwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4g
PiAgIAkJCQkgICAgcmVnLCBUUkFOU19TVEFURV9FTkFCTEUsIFRSQU5TX1NUQVRFX0VOQUJMRSwK
PiA+ICAgCQkJCSAgICAxMDApKQo+ID4gICAJCURSTV9FUlJPUigiZmFpbGVkIHRvIGVuYWJsZSB0
cmFuc2NvZGVyICVjXG4iLCBwaXBlX25hbWUocGlwZSkpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgbHB0X2VuYWJsZV9wY2hfdHJhbnNjb2RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgbHB0X2VuYWJsZV9wY2hfdHJhbnNjb2RlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgIGVudW0gdHJhbnNjb2RlciBj
cHVfdHJhbnNjb2RlcikKPiA+ICAgewo+ID4gICAJdTMyIHZhbCwgcGlwZWNvbmZfdmFsOwo+ID4g
ICAJLyogRkRJIG11c3QgYmUgZmVlZGluZyB1cyBiaXRzIGZvciBQQ0ggcG9ydHMgKi8KPiA+IC0J
YXNzZXJ0X2ZkaV90eF9lbmFibGVkKGRldl9wcml2LCAoZW51bSBwaXBlKSBjcHVfdHJhbnNjb2Rl
cik7Cj4gPiAtCWFzc2VydF9mZGlfcnhfZW5hYmxlZChkZXZfcHJpdiwgUElQRV9BKTsKPiA+ICsJ
YXNzZXJ0X2ZkaV90eF9lbmFibGVkKGk5MTUsIChlbnVtIHBpcGUpIGNwdV90cmFuc2NvZGVyKTsK
PiA+ICsJYXNzZXJ0X2ZkaV9yeF9lbmFibGVkKGk5MTUsIFBJUEVfQSk7Cj4gPiAgIAkvKiBXb3Jr
YXJvdW5kOiBzZXQgdGltaW5nIG92ZXJyaWRlIGJpdC4gKi8KPiA+ICAgCXZhbCA9IEk5MTVfUkVB
RChUUkFOU19DSElDS0VOMihQSVBFX0EpKTsKPiA+IEBAIC0xNzA2LDcgKzE3MDYsNyBAQCBzdGF0
aWMgdm9pZCBscHRfZW5hYmxlX3BjaF90cmFuc2NvZGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICAgCQl2YWwgfD0gVFJBTlNfUFJPR1JFU1NJVkU7Cj4gPiAgIAlJOTE1
X1dSSVRFKExQVF9UUkFOU0NPTkYsIHZhbCk7Cj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdp
c3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVy
KCZpOTE1LT51bmNvcmUsCj4gPiAgIAkJCQkgICAgTFBUX1RSQU5TQ09ORiwKPiA+ICAgCQkJCSAg
ICBUUkFOU19TVEFURV9FTkFCTEUsCj4gPiAgIAkJCQkgICAgVFJBTlNfU1RBVEVfRU5BQkxFLAo+
ID4gQEAgLTE3MTQsMzAgKzE3MTQsMzAgQEAgc3RhdGljIHZvaWQgbHB0X2VuYWJsZV9wY2hfdHJh
bnNjb2RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJRFJNX0VS
Uk9SKCJGYWlsZWQgdG8gZW5hYmxlIFBDSCB0cmFuc2NvZGVyXG4iKTsKPiA+ICAgfQo+ID4gLXN0
YXRpYyB2b2lkIGlyb25sYWtlX2Rpc2FibGVfcGNoX3RyYW5zY29kZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGlyb25sYWtlX2Rpc2FibGVfcGNo
X3RyYW5zY29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJICAg
IGVudW0gcGlwZSBwaXBlKQo+ID4gICB7Cj4gPiAgIAlpOTE1X3JlZ190IHJlZzsKPiA+ICAgCXUz
MiB2YWw7Cj4gPiAgIAkvKiBGREkgcmVsaWVzIG9uIHRoZSB0cmFuc2NvZGVyICovCj4gPiAtCWFz
c2VydF9mZGlfdHhfZGlzYWJsZWQoZGV2X3ByaXYsIHBpcGUpOwo+ID4gLQlhc3NlcnRfZmRpX3J4
X2Rpc2FibGVkKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJYXNzZXJ0X2ZkaV90eF9kaXNhYmxlZChp
OTE1LCBwaXBlKTsKPiA+ICsJYXNzZXJ0X2ZkaV9yeF9kaXNhYmxlZChpOTE1LCBwaXBlKTsKPiA+
ICAgCS8qIFBvcnRzIG11c3QgYmUgb2ZmIGFzIHdlbGwgKi8KPiA+IC0JYXNzZXJ0X3BjaF9wb3J0
c19kaXNhYmxlZChkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCWFzc2VydF9wY2hfcG9ydHNfZGlzYWJs
ZWQoaTkxNSwgcGlwZSk7Cj4gPiAgIAlyZWcgPSBQQ0hfVFJBTlNDT05GKHBpcGUpOwo+ID4gICAJ
dmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4gPiAgIAl2YWwgJj0gflRSQU5TX0VOQUJMRTsKPiA+ICAg
CUk5MTVfV1JJVEUocmVnLCB2YWwpOwo+ID4gICAJLyogd2FpdCBmb3IgUENIIHRyYW5zY29kZXIg
b2ZmLCB0cmFuc2NvZGVyIHN0YXRlICovCj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rl
cigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZp
OTE1LT51bmNvcmUsCj4gPiAgIAkJCQkgICAgcmVnLCBUUkFOU19TVEFURV9FTkFCTEUsIDAsCj4g
PiAgIAkJCQkgICAgNTApKQo+ID4gICAJCURSTV9FUlJPUigiZmFpbGVkIHRvIGRpc2FibGUgdHJh
bnNjb2RlciAlY1xuIiwgcGlwZV9uYW1lKHBpcGUpKTsKPiA+IC0JaWYgKEhBU19QQ0hfQ1BUKGRl
dl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX1BDSF9DUFQoaTkxNSkpIHsKPiA+ICAgCQkvKiBXb3Jr
YXJvdW5kOiBDbGVhciB0aGUgdGltaW5nIG92ZXJyaWRlIGNoaWNrZW4gYml0IGFnYWluLiAqLwo+
ID4gICAJCXJlZyA9IFRSQU5TX0NISUNLRU4yKHBpcGUpOwo+ID4gICAJCXZhbCA9IEk5MTVfUkVB
RChyZWcpOwo+ID4gQEAgLTE3NDYsNyArMTc0Niw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2Rp
c2FibGVfcGNoX3RyYW5zY29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gICAJfQo+ID4gICB9Cj4gPiAtdm9pZCBscHRfZGlzYWJsZV9wY2hfdHJhbnNjb2RlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBscHRfZGlzYWJsZV9wY2hf
dHJhbnNjb2RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJ
dTMyIHZhbDsKPiA+IEBAIC0xNzU0LDcgKzE3NTQsNyBAQCB2b2lkIGxwdF9kaXNhYmxlX3BjaF90
cmFuc2NvZGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXZhbCAm
PSB+VFJBTlNfRU5BQkxFOwo+ID4gICAJSTkxNV9XUklURShMUFRfVFJBTlNDT05GLCB2YWwpOwo+
ID4gICAJLyogd2FpdCBmb3IgUENIIHRyYW5zY29kZXIgb2ZmLCB0cmFuc2NvZGVyIHN0YXRlICov
Cj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiA+
ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gPiAgIAkJCQkg
ICAgTFBUX1RSQU5TQ09ORiwgVFJBTlNfU1RBVEVfRU5BQkxFLCAwLAo+ID4gICAJCQkJICAgIDUw
KSkKPiA+ICAgCQlEUk1fRVJST1IoIkZhaWxlZCB0byBkaXNhYmxlIFBDSCB0cmFuc2NvZGVyXG4i
KTsKPiA+IEBAIC0xNzY3LDkgKzE3NjcsOSBAQCB2b2lkIGxwdF9kaXNhYmxlX3BjaF90cmFuc2Nv
ZGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgZW51bSBwaXBlIGlu
dGVsX2NydGNfcGNoX3RyYW5zY29kZXIoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gPiAtCWlmIChIQVNfUENIX0xQVChkZXZfcHJpdikpCj4gPiArCWlm
IChIQVNfUENIX0xQVChpOTE1KSkKPiA+ICAgCQlyZXR1cm4gUElQRV9BOwo+ID4gICAJZWxzZQo+
ID4gICAJCXJldHVybiBjcnRjLT5waXBlOwo+ID4gQEAgLTE3NzcsMTkgKzE3NzcsMTkgQEAgZW51
bSBwaXBlIGludGVsX2NydGNfcGNoX3RyYW5zY29kZXIoc3RydWN0IGludGVsX2NydGMgKmNydGMp
Cj4gPiAgIHN0YXRpYyB1MzIgaW50ZWxfY3J0Y19tYXhfdmJsYW5rX2NvdW50KGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19z
dGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gICAJLyoKPiA+ICAgCSAqIE9uIGk5NjVnbSB0aGUg
aGFyZHdhcmUgZnJhbWUgY291bnRlciByZWFkcwo+ID4gICAJICogemVybyB3aGVuIHRoZSBUViBl
bmNvZGVyIGlzIGVuYWJsZWQgOigKPiA+ICAgCSAqLwo+ID4gLQlpZiAoSVNfSTk2NUdNKGRldl9w
cml2KSAmJgo+ID4gKwlpZiAoSVNfSTk2NUdNKGk5MTUpICYmCj4gPiAgIAkgICAgKGNydGNfc3Rh
dGUtPm91dHB1dF90eXBlcyAmIEJJVChJTlRFTF9PVVRQVVRfVFZPVVQpKSkKPiA+ICAgCQlyZXR1
cm4gMDsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSB8fCBJU19HNFgoZGV2X3By
aXYpKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDUgfHwgSVNfRzRYKGk5MTUpKQo+ID4g
ICAJCXJldHVybiAweGZmZmZmZmZmOyAvKiBmdWxsIDMyIGJpdCBjb3VudGVyICovCj4gPiAtCWVs
c2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMykKPiA+ICsJZWxzZSBpZiAoSU5URUxfR0VO
KGk5MTUpID49IDMpCj4gPiAgIAkJcmV0dXJuIDB4ZmZmZmZmOyAvKiBvbmx5IDI0IGJpdHMgb2Yg
ZnJhbWUgY291bnQgKi8KPiA+ICAgCWVsc2UKPiA+ICAgCQlyZXR1cm4gMDsgLyogR2VuMiBkb2Vz
bid0IGhhdmUgYSBoYXJkd2FyZSBmcmFtZSBjb3VudGVyICovCj4gPiBAQCAtMTgwNyw3ICsxODA3
LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfY3J0Y192Ymxhbmtfb24oY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9w
aXBlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPiA+ICAg
ewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRj
X3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gdHJhbnNjb2Rl
ciBjcHVfdHJhbnNjb2RlciA9IG5ld19jcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiA+ICAg
CWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+ICAgCWk5MTVfcmVnX3QgcmVnOwo+ID4g
QEAgLTE4MjIsMjkgKzE4MjIsMjkgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX3BpcGUoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ID4gICAJICogYSBw
bGFuZS4gIE9uIElMSysgdGhlIHBpcGUgUExMcyBhcmUgaW50ZWdyYXRlZCwgc28gd2UgZG9uJ3QK
PiA+ICAgCSAqIG5lZWQgdGhlIGNoZWNrLgo+ID4gICAJICovCj4gPiAtCWlmIChIQVNfR01DSChk
ZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19HTUNIKGk5MTUpKSB7Cj4gPiAgIAkJaWYgKGludGVs
X2NydGNfaGFzX3R5cGUobmV3X2NydGNfc3RhdGUsIElOVEVMX09VVFBVVF9EU0kpKQo+ID4gLQkJ
CWFzc2VydF9kc2lfcGxsX2VuYWJsZWQoZGV2X3ByaXYpOwo+ID4gKwkJCWFzc2VydF9kc2lfcGxs
X2VuYWJsZWQoaTkxNSk7Cj4gPiAgIAkJZWxzZQo+ID4gLQkJCWFzc2VydF9wbGxfZW5hYmxlZChk
ZXZfcHJpdiwgcGlwZSk7Cj4gPiArCQkJYXNzZXJ0X3BsbF9lbmFibGVkKGk5MTUsIHBpcGUpOwo+
ID4gICAJfSBlbHNlIHsKPiA+ICAgCQlpZiAobmV3X2NydGNfc3RhdGUtPmhhc19wY2hfZW5jb2Rl
cikgewo+ID4gICAJCQkvKiBpZiBkcml2aW5nIHRoZSBQQ0gsIHdlIG5lZWQgRkRJIGVuYWJsZWQg
Ki8KPiA+IC0JCQlhc3NlcnRfZmRpX3J4X3BsbF9lbmFibGVkKGRldl9wcml2LAo+ID4gKwkJCWFz
c2VydF9mZGlfcnhfcGxsX2VuYWJsZWQoaTkxNSwKPiA+ICAgCQkJCQkJICBpbnRlbF9jcnRjX3Bj
aF90cmFuc2NvZGVyKGNydGMpKTsKPiA+IC0JCQlhc3NlcnRfZmRpX3R4X3BsbF9lbmFibGVkKGRl
dl9wcml2LAo+ID4gKwkJCWFzc2VydF9mZGlfdHhfcGxsX2VuYWJsZWQoaTkxNSwKPiA+ICAgCQkJ
CQkJICAoZW51bSBwaXBlKSBjcHVfdHJhbnNjb2Rlcik7Cj4gPiAgIAkJfQo+ID4gICAJCS8qIEZJ
WE1FOiBhc3NlcnQgQ1BVIHBvcnQgY29uZGl0aW9ucyBmb3IgU05CKyAqLwo+ID4gICAJfQo+ID4g
LQl0cmFjZV9pbnRlbF9waXBlX2VuYWJsZShkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCXRyYWNlX2lu
dGVsX3BpcGVfZW5hYmxlKGk5MTUsIHBpcGUpOwo+ID4gICAJcmVnID0gUElQRUNPTkYoY3B1X3Ry
YW5zY29kZXIpOwo+ID4gICAJdmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4gPiAgIAlpZiAodmFsICYg
UElQRUNPTkZfRU5BQkxFKSB7Cj4gPiAgIAkJLyogd2Uga2VlcCBib3RoIHBpcGVzIGVuYWJsZWQg
b24gODMwICovCj4gPiAtCQlXQVJOX09OKCFJU19JODMwKGRldl9wcml2KSk7Cj4gPiArCQlXQVJO
X09OKCFJU19JODMwKGk5MTUpKTsKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiBAQCAtMTg2
NSw3ICsxODY1LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX3BpcGUoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ID4gICBzdGF0aWMgdm9pZCBpbnRl
bF9kaXNhYmxlX3BpcGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0
YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJZW51
bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gb2xkX2NydGNfc3RhdGUtPmNwdV90cmFuc2Nv
ZGVyOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJaTkxNV9yZWdf
dCByZWc7Cj4gPiBAQCAtMTg3OSw3ICsxODc5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJs
ZV9waXBlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiA+
ICAgCSAqLwo+ID4gICAJYXNzZXJ0X3BsYW5lc19kaXNhYmxlZChjcnRjKTsKPiA+IC0JdHJhY2Vf
aW50ZWxfcGlwZV9kaXNhYmxlKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJdHJhY2VfaW50ZWxfcGlw
ZV9kaXNhYmxlKGk5MTUsIHBpcGUpOwo+ID4gICAJcmVnID0gUElQRUNPTkYoY3B1X3RyYW5zY29k
ZXIpOwo+ID4gICAJdmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4gPiBAQCAtMTg5NCw3ICsxODk0LDcg
QEAgc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJsZV9waXBlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiA+ICAgCQl2YWwgJj0gflBJUEVDT05GX0RPVUJMRV9X
SURFOwo+ID4gICAJLyogRG9uJ3QgZGlzYWJsZSBwaXBlIG9yIHBpcGUgUExMcyBpZiBuZWVkZWQg
Ki8KPiA+IC0JaWYgKCFJU19JODMwKGRldl9wcml2KSkKPiA+ICsJaWYgKCFJU19JODMwKGk5MTUp
KQo+ID4gICAJCXZhbCAmPSB+UElQRUNPTkZfRU5BQkxFOwo+ID4gICAJSTkxNV9XUklURShyZWcs
IHZhbCk7Cj4gPiBAQCAtMTkwMiwyMiArMTkwMiwyMiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kaXNh
YmxlX3BpcGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKQo+
ID4gICAJCWludGVsX3dhaXRfZm9yX3BpcGVfb2ZmKG9sZF9jcnRjX3N0YXRlKTsKPiA+ICAgfQo+
ID4gLXN0YXRpYyB1bnNpZ25lZCBpbnQgaW50ZWxfdGlsZV9zaXplKGNvbnN0IHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdW5zaWduZWQgaW50IGludGVsX3Rp
bGVfc2l6ZShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4g
LQlyZXR1cm4gSVNfR0VOKGRldl9wcml2LCAyKSA/IDIwNDggOiA0MDk2Owo+ID4gKwlyZXR1cm4g
SVNfR0VOKGk5MTUsIDIpID8gMjA0OCA6IDQwOTY7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHVuc2ln
bmVkIGludAo+ID4gICBpbnRlbF90aWxlX3dpZHRoX2J5dGVzKGNvbnN0IHN0cnVjdCBkcm1fZnJh
bWVidWZmZXIgKmZiLCBpbnQgY29sb3JfcGxhbmUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShmYi0+ZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGZiLT5kZXYpOwo+ID4gICAJdW5zaWduZWQg
aW50IGNwcCA9IGZiLT5mb3JtYXQtPmNwcFtjb2xvcl9wbGFuZV07Cj4gPiAgIAlzd2l0Y2ggKGZi
LT5tb2RpZmllcikgewo+ID4gICAJY2FzZSBEUk1fRk9STUFUX01PRF9MSU5FQVI6Cj4gPiAtCQly
ZXR1cm4gaW50ZWxfdGlsZV9zaXplKGRldl9wcml2KTsKPiA+ICsJCXJldHVybiBpbnRlbF90aWxl
X3NpemUoaTkxNSk7Cj4gPiAgIAljYXNlIEk5MTVfRk9STUFUX01PRF9YX1RJTEVEOgo+ID4gLQkJ
aWYgKElTX0dFTihkZXZfcHJpdiwgMikpCj4gPiArCQlpZiAoSVNfR0VOKGk5MTUsIDIpKQo+ID4g
ICAJCQlyZXR1cm4gMTI4Owo+ID4gICAJCWVsc2UKPiA+ICAgCQkJcmV0dXJuIDUxMjsKPiA+IEBA
IC0xOTI2LDcgKzE5MjYsNyBAQCBpbnRlbF90aWxlX3dpZHRoX2J5dGVzKGNvbnN0IHN0cnVjdCBk
cm1fZnJhbWVidWZmZXIgKmZiLCBpbnQgY29sb3JfcGxhbmUpCj4gPiAgIAkJCXJldHVybiAxMjg7
Cj4gPiAgIAkJLyogZmFsbCB0aHJvdWdoICovCj4gPiAgIAljYXNlIEk5MTVfRk9STUFUX01PRF9Z
X1RJTEVEOgo+ID4gLQkJaWYgKElTX0dFTihkZXZfcHJpdiwgMikgfHwgSEFTXzEyOF9CWVRFX1lf
VElMSU5HKGRldl9wcml2KSkKPiA+ICsJCWlmIChJU19HRU4oaTkxNSwgMikgfHwgSEFTXzEyOF9C
WVRFX1lfVElMSU5HKGk5MTUpKQo+ID4gICAJCQlyZXR1cm4gMTI4Owo+ID4gICAJCWVsc2UKPiA+
ICAgCQkJcmV0dXJuIDUxMjsKPiA+IEBAIC0yMDE3LDI2ICsyMDE3LDI2IEBAIGludGVsX2ZpbGxf
ZmJfZ2d0dF92aWV3KHN0cnVjdCBpOTE1X2dndHRfdmlldyAqdmlldywKPiA+ICAgCX0KPiA+ICAg
fQo+ID4gLXN0YXRpYyB1bnNpZ25lZCBpbnQgaW50ZWxfY3Vyc29yX2FsaWdubWVudChjb25zdCBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHVuc2lnbmVkIGlu
dCBpbnRlbF9jdXJzb3JfYWxpZ25tZW50KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAtCWlmIChJU19JODMwKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0k4
MzAoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIDE2ICogMTAyNDsKPiA+IC0JZWxzZSBpZiAoSVNfSTg1
WChkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElTX0k4NVgoaTkxNSkpCj4gPiAgIAkJcmV0dXJu
IDI1NjsKPiA+IC0JZWxzZSBpZiAoSVNfSTg0NUcoZGV2X3ByaXYpIHx8IElTX0k4NjVHKGRldl9w
cml2KSkKPiA+ICsJZWxzZSBpZiAoSVNfSTg0NUcoaTkxNSkgfHwgSVNfSTg2NUcoaTkxNSkpCj4g
PiAgIAkJcmV0dXJuIDMyOwo+ID4gICAJZWxzZQo+ID4gICAJCXJldHVybiA0ICogMTAyNDsKPiA+
ICAgfQo+ID4gLXN0YXRpYyB1bnNpZ25lZCBpbnQgaW50ZWxfbGluZWFyX2FsaWdubWVudChjb25z
dCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHVuc2lnbmVk
IGludCBpbnRlbF9saW5lYXJfYWxpZ25tZW50KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ID4gICB7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiAr
CWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiA+ICAgCQlyZXR1cm4gMjU2ICogMTAyNDsKPiA+
IC0JZWxzZSBpZiAoSVNfSTk2NUcoZGV2X3ByaXYpIHx8IElTX0k5NjVHTShkZXZfcHJpdikgfHwK
PiA+IC0JCSBJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2
KSkKPiA+ICsJZWxzZSBpZiAoSVNfSTk2NUcoaTkxNSkgfHwgSVNfSTk2NUdNKGk5MTUpIHx8Cj4g
PiArCQkgSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKQo+ID4gICAJ
CXJldHVybiAxMjggKiAxMDI0Owo+ID4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDQpCj4gPiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KQo+ID4gICAJCXJldHVybiA0
ICogMTAyNDsKPiA+ICAgCWVsc2UKPiA+ICAgCQlyZXR1cm4gMDsKPiA+IEBAIC0yMDQ1LDcgKzIw
NDUsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGludGVsX2xpbmVhcl9hbGlnbm1lbnQoY29uc3Qg
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcgo+ID4gICBzdGF0aWMgdW5zaWduZWQgaW50
IGludGVsX3N1cmZfYWxpZ25tZW50KGNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAo+
ID4gICAJCQkJCSBpbnQgY29sb3JfcGxhbmUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShmYi0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGZiLT5kZXYpOwo+ID4gICAJLyogQVVYX0RJU1Qg
bmVlZHMgb25seSA0SyBhbGlnbm1lbnQgKi8KPiA+ICAgCWlmIChjb2xvcl9wbGFuZSA9PSAxKQo+
ID4gQEAgLTIwNTMsOSArMjA1Myw5IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgaW50ZWxfc3VyZl9h
bGlnbm1lbnQoY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsCj4gPiAgIAlzd2l0Y2gg
KGZiLT5tb2RpZmllcikgewo+ID4gICAJY2FzZSBEUk1fRk9STUFUX01PRF9MSU5FQVI6Cj4gPiAt
CQlyZXR1cm4gaW50ZWxfbGluZWFyX2FsaWdubWVudChkZXZfcHJpdik7Cj4gPiArCQlyZXR1cm4g
aW50ZWxfbGluZWFyX2FsaWdubWVudChpOTE1KTsKPiA+ICAgCWNhc2UgSTkxNV9GT1JNQVRfTU9E
X1hfVElMRUQ6Cj4gPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ID4gKwkJaWYg
KElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gICAJCQlyZXR1cm4gMjU2ICogMTAyNDsKPiA+ICAg
CQlyZXR1cm4gMDsKPiA+ICAgCWNhc2UgSTkxNV9GT1JNQVRfTU9EX1lfVElMRURfQ0NTOgo+ID4g
QEAgLTIwNzIsOSArMjA3Miw5IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgaW50ZWxfc3VyZl9hbGln
bm1lbnQoY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsCj4gPiAgIHN0YXRpYyBib29s
IGludGVsX3BsYW5lX3VzZXNfZmVuY2UoY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpw
bGFuZV9zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRv
X2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lKTsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsK
PiA+IC0JcmV0dXJuIElOVEVMX0dFTihkZXZfcHJpdikgPCA0IHx8Cj4gPiArCXJldHVybiBJTlRF
TF9HRU4oaTkxNSkgPCA0IHx8Cj4gPiAgIAkJKHBsYW5lLT5oYXNfZmJjICYmCj4gPiAgIAkJIHBs
YW5lX3N0YXRlLT52aWV3LnR5cGUgPT0gSTkxNV9HR1RUX1ZJRVdfTk9STUFMKTsKPiA+ICAgfQo+
ID4gQEAgLTIwODYsNyArMjA4Niw3IEBAIGludGVsX3Bpbl9hbmRfZmVuY2VfZmJfb2JqKHN0cnVj
dCBkcm1fZnJhbWVidWZmZXIgKmZiLAo+ID4gICAJCQkgICB1bnNpZ25lZCBsb25nICpvdXRfZmxh
Z3MpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBmYi0+ZGV2Owo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGludGVsX2ZiX29iaihmYik7Cj4gPiAgIAlp
bnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwo+ID4g
QEAgLTIxMDIsNyArMjEwMiw3IEBAIGludGVsX3Bpbl9hbmRfZmVuY2VfZmJfb2JqKHN0cnVjdCBk
cm1fZnJhbWVidWZmZXIgKmZiLAo+ID4gICAJICogd2Ugc2hvdWxkIGFsd2F5cyBoYXZlIHZhbGlk
IFBURSBmb2xsb3dpbmcgdGhlIHNjYW5vdXQgcHJldmVudGluZwo+ID4gICAJICogdGhlIFZULWQg
d2FybmluZy4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoaW50ZWxfc2Nhbm91dF9uZWVkc192dGRfd2Eo
ZGV2X3ByaXYpICYmIGFsaWdubWVudCA8IDI1NiAqIDEwMjQpCj4gPiArCWlmIChpbnRlbF9zY2Fu
b3V0X25lZWRzX3Z0ZF93YShpOTE1KSAmJiBhbGlnbm1lbnQgPCAyNTYgKiAxMDI0KQo+ID4gICAJ
CWFsaWdubWVudCA9IDI1NiAqIDEwMjQ7Cj4gPiAgIAkvKgo+ID4gQEAgLTIxMTIsMTAgKzIxMTIs
MTAgQEAgaW50ZWxfcGluX2FuZF9mZW5jZV9mYl9vYmooc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAq
ZmIsCj4gPiAgIAkgKiBpbnRlbF9ydW50aW1lX3BtX3B1dCgpLCBzbyBpdCBpcyBjb3JyZWN0IHRv
IHdyYXAgb25seSB0aGUKPiA+ICAgCSAqIHBpbi91bnBpbi9mZW5jZSBhbmQgbm90IG1vcmUuCj4g
PiAgIAkgKi8KPiA+IC0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsK
PiA+ICsJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ID4gICAJaTkxNV9n
ZW1fb2JqZWN0X2xvY2sob2JqKTsKPiA+IC0JYXRvbWljX2luYygmZGV2X3ByaXYtPmdwdV9lcnJv
ci5wZW5kaW5nX2ZiX3Bpbik7Cj4gPiArCWF0b21pY19pbmMoJmk5MTUtPmdwdV9lcnJvci5wZW5k
aW5nX2ZiX3Bpbik7Cj4gPiAgIAlwaW5jdGwgPSAwOwo+ID4gQEAgLTIxMjYsNyArMjEyNiw3IEBA
IGludGVsX3Bpbl9hbmRfZmVuY2VfZmJfb2JqKHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAo+
ID4gICAJICogY29tcGxpY2F0ZWQgdGhhbiB0aGlzLiBGb3IgZXhhbXBsZSwgQ2hlcnJ5dmlldyBh
cHBlYXJzIHF1aXRlCj4gPiAgIAkgKiBoYXBweSB0byBzY2Fub3V0IGZyb20gYW55d2hlcmUgd2l0
aGluIGl0cyBnbG9iYWwgYXBlcnR1cmUuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKEhBU19HTUNIKGRl
dl9wcml2KSkKPiA+ICsJaWYgKEhBU19HTUNIKGk5MTUpKQo+ID4gICAJCXBpbmN0bCB8PSBQSU5f
TUFQUEFCTEU7Cj4gPiAgIAl2bWEgPSBpOTE1X2dlbV9vYmplY3RfcGluX3RvX2Rpc3BsYXlfcGxh
bmUob2JqLAo+ID4gQEAgLTIxNTQsNyArMjE1NCw3IEBAIGludGVsX3Bpbl9hbmRfZmVuY2VfZmJf
b2JqKHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAo+ID4gICAJCSAqIG1vZGUgdGhhdCBtYXRj
aGVzIHRoZSB1c2VyIGNvbmZpZ3VyYXRpb24uCj4gPiAgIAkJICovCj4gPiAgIAkJcmV0ID0gaTkx
NV92bWFfcGluX2ZlbmNlKHZtYSk7Cj4gPiAtCQlpZiAocmV0ICE9IDAgJiYgSU5URUxfR0VOKGRl
dl9wcml2KSA8IDQpIHsKPiA+ICsJCWlmIChyZXQgIT0gMCAmJiBJTlRFTF9HRU4oaTkxNSkgPCA0
KSB7Cj4gPiAgIAkJCWk5MTVfZ2VtX29iamVjdF91bnBpbl9mcm9tX2Rpc3BsYXlfcGxhbmUodm1h
KTsKPiA+ICAgCQkJdm1hID0gRVJSX1BUUihyZXQpOwo+ID4gICAJCQlnb3RvIGVycjsKPiA+IEBA
IC0yMTY2LDEwICsyMTY2LDEwIEBAIGludGVsX3Bpbl9hbmRfZmVuY2VfZmJfb2JqKHN0cnVjdCBk
cm1fZnJhbWVidWZmZXIgKmZiLAo+ID4gICAJaTkxNV92bWFfZ2V0KHZtYSk7Cj4gPiAgIGVycjoK
PiA+IC0JYXRvbWljX2RlYygmZGV2X3ByaXYtPmdwdV9lcnJvci5wZW5kaW5nX2ZiX3Bpbik7Cj4g
PiArCWF0b21pY19kZWMoJmk5MTUtPmdwdV9lcnJvci5wZW5kaW5nX2ZiX3Bpbik7Cj4gPiAgIAlp
OTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRl
dl9wcml2LCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJl
Zik7Cj4gPiAgIAlyZXR1cm4gdm1hOwo+ID4gICB9Cj4gPiBAQCAtMjI2NSw3ICsyMjY1LDcgQEAg
c3RhdGljIHUzMiBpbnRlbF9hZGp1c3RfYWxpZ25lZF9vZmZzZXQoaW50ICp4LCBpbnQgKnksCj4g
PiAgIAkJCQkgICAgICAgdW5zaWduZWQgaW50IHBpdGNoLAo+ID4gICAJCQkJICAgICAgIHUzMiBv
bGRfb2Zmc2V0LCB1MzIgbmV3X29mZnNldCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGZiLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZmItPmRldik7Cj4gPiAgIAl1bnNpZ25lZCBpbnQg
Y3BwID0gZmItPmZvcm1hdC0+Y3BwW2NvbG9yX3BsYW5lXTsKPiA+ICAgCVdBUk5fT04obmV3X29m
ZnNldCA+IG9sZF9vZmZzZXQpOwo+ID4gQEAgLTIyNzQsNyArMjI3NCw3IEBAIHN0YXRpYyB1MzIg
aW50ZWxfYWRqdXN0X2FsaWduZWRfb2Zmc2V0KGludCAqeCwgaW50ICp5LAo+ID4gICAJCXVuc2ln
bmVkIGludCB0aWxlX3NpemUsIHRpbGVfd2lkdGgsIHRpbGVfaGVpZ2h0Owo+ID4gICAJCXVuc2ln
bmVkIGludCBwaXRjaF90aWxlczsKPiA+IC0JCXRpbGVfc2l6ZSA9IGludGVsX3RpbGVfc2l6ZShk
ZXZfcHJpdik7Cj4gPiArCQl0aWxlX3NpemUgPSBpbnRlbF90aWxlX3NpemUoaTkxNSk7Cj4gPiAg
IAkJaW50ZWxfdGlsZV9kaW1zKGZiLCBjb2xvcl9wbGFuZSwgJnRpbGVfd2lkdGgsICZ0aWxlX2hl
aWdodCk7Cj4gPiAgIAkJaWYgKGRybV9yb3RhdGlvbl85MF9vcl8yNzAocm90YXRpb24pKSB7Cj4g
PiBAQCAtMjMyNiw3ICsyMzI2LDcgQEAgc3RhdGljIHUzMiBpbnRlbF9wbGFuZV9hZGp1c3RfYWxp
Z25lZF9vZmZzZXQoaW50ICp4LCBpbnQgKnksCj4gPiAgICAqIHVzZWQuIFRoaXMgaXMgd2h5IHRo
ZSB1c2VyIGhhcyB0byBwYXNzIGluIHRoZSBwaXRjaCBzaW5jZSBpdAo+ID4gICAgKiBpcyBzcGVj
aWZpZWQgaW4gdGhlIHJvdGF0ZWQgb3JpZW50YXRpb24uCj4gPiAgICAqLwo+ID4gLXN0YXRpYyB1
MzIgaW50ZWxfY29tcHV0ZV9hbGlnbmVkX29mZnNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiArc3RhdGljIHUzMiBpbnRlbF9jb21wdXRlX2FsaWduZWRfb2Zmc2V0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJCWludCAqeCwgaW50ICp5LAo+
ID4gICAJCQkJCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAo+ID4gICAJCQkJCWlu
dCBjb2xvcl9wbGFuZSwKPiA+IEBAIC0yMzQ0LDcgKzIzNDQsNyBAQCBzdGF0aWMgdTMyIGludGVs
X2NvbXB1dGVfYWxpZ25lZF9vZmZzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gICAJCXVuc2lnbmVkIGludCB0aWxlX3NpemUsIHRpbGVfd2lkdGgsIHRpbGVfaGVpZ2h0
Owo+ID4gICAJCXVuc2lnbmVkIGludCB0aWxlX3Jvd3MsIHRpbGVzLCBwaXRjaF90aWxlczsKPiA+
IC0JCXRpbGVfc2l6ZSA9IGludGVsX3RpbGVfc2l6ZShkZXZfcHJpdik7Cj4gPiArCQl0aWxlX3Np
emUgPSBpbnRlbF90aWxlX3NpemUoaTkxNSk7Cj4gPiAgIAkJaW50ZWxfdGlsZV9kaW1zKGZiLCBj
b2xvcl9wbGFuZSwgJnRpbGVfd2lkdGgsICZ0aWxlX2hlaWdodCk7Cj4gPiAgIAkJaWYgKGRybV9y
b3RhdGlvbl85MF9vcl8yNzAocm90YXRpb24pKSB7Cj4gPiBAQCAtMjM4MiwxOCArMjM4MiwxOCBA
QCBzdGF0aWMgdTMyIGludGVsX3BsYW5lX2NvbXB1dGVfYWxpZ25lZF9vZmZzZXQoaW50ICp4LCBp
bnQgKnksCj4gPiAgIAkJCQkJICAgICAgaW50IGNvbG9yX3BsYW5lKQo+ID4gICB7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfcGxhbmUgKmludGVsX3BsYW5lID0gdG9faW50ZWxfcGxhbmUoc3RhdGUtPmJh
c2UucGxhbmUpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGludGVsX3BsYW5lLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShpbnRlbF9wbGFuZS0+YmFzZS5kZXYpOwo+ID4gICAJY29uc3Qgc3Ry
dWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBzdGF0ZS0+YmFzZS5mYjsKPiA+ICAgCXVuc2lnbmVk
IGludCByb3RhdGlvbiA9IHN0YXRlLT5iYXNlLnJvdGF0aW9uOwo+ID4gICAJaW50IHBpdGNoID0g
c3RhdGUtPmNvbG9yX3BsYW5lW2NvbG9yX3BsYW5lXS5zdHJpZGU7Cj4gPiAgIAl1MzIgYWxpZ25t
ZW50Owo+ID4gICAJaWYgKGludGVsX3BsYW5lLT5pZCA9PSBQTEFORV9DVVJTT1IpCj4gPiAtCQlh
bGlnbm1lbnQgPSBpbnRlbF9jdXJzb3JfYWxpZ25tZW50KGRldl9wcml2KTsKPiA+ICsJCWFsaWdu
bWVudCA9IGludGVsX2N1cnNvcl9hbGlnbm1lbnQoaTkxNSk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJ
YWxpZ25tZW50ID0gaW50ZWxfc3VyZl9hbGlnbm1lbnQoZmIsIGNvbG9yX3BsYW5lKTsKPiA+IC0J
cmV0dXJuIGludGVsX2NvbXB1dGVfYWxpZ25lZF9vZmZzZXQoZGV2X3ByaXYsIHgsIHksIGZiLCBj
b2xvcl9wbGFuZSwKPiA+ICsJcmV0dXJuIGludGVsX2NvbXB1dGVfYWxpZ25lZF9vZmZzZXQoaTkx
NSwgeCwgeSwgZmIsIGNvbG9yX3BsYW5lLAo+ID4gICAJCQkJCSAgICBwaXRjaCwgcm90YXRpb24s
IGFsaWdubWVudCk7Cj4gPiAgIH0KPiA+IEBAIC0yNDAyLDExICsyNDAyLDExIEBAIHN0YXRpYyBp
bnQgaW50ZWxfZmJfb2Zmc2V0X3RvX3h5KGludCAqeCwgaW50ICp5LAo+ID4gICAJCQkJIGNvbnN0
IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAo+ID4gICAJCQkJIGludCBjb2xvcl9wbGFuZSkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGZiLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZmItPmRldik7Cj4gPiAgIAl1bnNpZ25lZCBpbnQgaGVpZ2h0Owo+ID4gICAJaWYgKGZiLT5tb2Rp
ZmllciAhPSBEUk1fRk9STUFUX01PRF9MSU5FQVIgJiYKPiA+IC0JICAgIGZiLT5vZmZzZXRzW2Nv
bG9yX3BsYW5lXSAlIGludGVsX3RpbGVfc2l6ZShkZXZfcHJpdikpIHsKPiA+ICsJICAgIGZiLT5v
ZmZzZXRzW2NvbG9yX3BsYW5lXSAlIGludGVsX3RpbGVfc2l6ZShpOTE1KSkgewo+ID4gICAJCURS
TV9ERUJVR19LTVMoIk1pc2FsaWduZWQgb2Zmc2V0IDB4JTA4eCBmb3IgY29sb3IgcGxhbmUgJWRc
biIsCj4gPiAgIAkJCSAgICAgIGZiLT5vZmZzZXRzW2NvbG9yX3BsYW5lXSwgY29sb3JfcGxhbmUp
Owo+ID4gICAJCXJldHVybiAtRUlOVkFMOwo+ID4gQEAgLTI1MDcsNyArMjUwNyw3IEBAIGJvb2wg
aXNfY2NzX21vZGlmaWVyKHU2NCBtb2RpZmllcikKPiA+ICAgCSAgICAgICBtb2RpZmllciA9PSBJ
OTE1X0ZPUk1BVF9NT0RfWWZfVElMRURfQ0NTOwo+ID4gICB9Cj4gPiAtdTMyIGludGVsX3BsYW5l
X2ZiX21heF9zdHJpZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3Uz
MiBpbnRlbF9wbGFuZV9mYl9tYXhfc3RyaWRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ID4gICAJCQkgICAgICB1MzIgcGl4ZWxfZm9ybWF0LCB1NjQgbW9kaWZpZXIpCj4gPiAgIHsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ID4gQEAgLTI1MTcsNyArMjUxNyw3IEBA
IHUzMiBpbnRlbF9wbGFuZV9mYl9tYXhfc3RyaWRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCSAqIFdlIGFzc3VtZSB0aGUgcHJpbWFyeSBwbGFuZSBmb3IgcGlwZSBB
IGhhcwo+ID4gICAJICogdGhlIGhpZ2hlc3Qgc3RyaWRlIGxpbWl0cyBvZiB0aGVtIGFsbC4KPiA+
ICAgCSAqLwo+ID4gLQljcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIFBJ
UEVfQSk7Cj4gPiArCWNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBQSVBFX0Ep
Owo+ID4gICAJcGxhbmUgPSB0b19pbnRlbF9wbGFuZShjcnRjLT5iYXNlLnByaW1hcnkpOwo+ID4g
ICAJcmV0dXJuIHBsYW5lLT5tYXhfc3RyaWRlKHBsYW5lLCBwaXhlbF9mb3JtYXQsIG1vZGlmaWVy
LAo+ID4gQEAgLTI1MjUsNyArMjUyNSw3IEBAIHUzMiBpbnRlbF9wbGFuZV9mYl9tYXhfc3RyaWRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgfQo+ID4gICBzdGF0aWMK
PiA+IC11MzIgaW50ZWxfZmJfbWF4X3N0cmlkZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiArdTMyIGludGVsX2ZiX21heF9zdHJpZGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCXUzMiBwaXhlbF9mb3JtYXQsIHU2NCBtb2RpZmllcikKPiA+ICAg
ewo+ID4gICAJLyoKPiA+IEBAIC0yNTM1LDIyICsyNTM1LDIyIEBAIHUzMiBpbnRlbF9mYl9tYXhf
c3RyaWRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCSAqIFRoZSBu
ZXcgQ0NTIGhhc2ggbW9kZSBtYWtlcyByZW1hcHBpbmcgaW1wb3NzaWJsZQo+ID4gICAJICovCj4g
PiAgIAlpZiAoIWlzX2Njc19tb2RpZmllcihtb2RpZmllcikpIHsKPiA+IC0JCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDcpCj4gPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDcpCj4gPiAg
IAkJCXJldHVybiAyNTYqMTAyNDsKPiA+IC0JCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gNCkKPiA+ICsJCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KQo+ID4gICAJCQlyZXR1
cm4gMTI4KjEwMjQ7Cj4gPiAgIAl9Cj4gPiAtCXJldHVybiBpbnRlbF9wbGFuZV9mYl9tYXhfc3Ry
aWRlKGRldl9wcml2LCBwaXhlbF9mb3JtYXQsIG1vZGlmaWVyKTsKPiA+ICsJcmV0dXJuIGludGVs
X3BsYW5lX2ZiX21heF9zdHJpZGUoaTkxNSwgcGl4ZWxfZm9ybWF0LCBtb2RpZmllcik7Cj4gPiAg
IH0KPiA+ICAgc3RhdGljIHUzMgo+ID4gICBpbnRlbF9mYl9zdHJpZGVfYWxpZ25tZW50KGNvbnN0
IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLCBpbnQgY29sb3JfcGxhbmUpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShmYi0+ZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGZiLT5kZXYpOwo+
ID4gICAJaWYgKGZiLT5tb2RpZmllciA9PSBEUk1fRk9STUFUX01PRF9MSU5FQVIpIHsKPiA+IC0J
CXUzMiBtYXhfc3RyaWRlID0gaW50ZWxfcGxhbmVfZmJfbWF4X3N0cmlkZShkZXZfcHJpdiwKPiA+
ICsJCXUzMiBtYXhfc3RyaWRlID0gaW50ZWxfcGxhbmVfZmJfbWF4X3N0cmlkZShpOTE1LAo+ID4g
ICAJCQkJCQkJICAgZmItPmZvcm1hdC0+Zm9ybWF0LAo+ID4gICAJCQkJCQkJICAgZmItPm1vZGlm
aWVyKTsKPiA+IEBAIC0yNTU5LDcgKzI1NTksNyBAQCBpbnRlbF9mYl9zdHJpZGVfYWxpZ25tZW50
KGNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLCBpbnQgY29sb3JfcGxhbmUpCj4gPiAg
IAkJICogd2UgbmVlZCB0aGUgc3RyaWRlIHRvIGJlIHBhZ2UgYWxpZ25lZC4KPiA+ICAgCQkgKi8K
PiA+ICAgCQlpZiAoZmItPnBpdGNoZXNbY29sb3JfcGxhbmVdID4gbWF4X3N0cmlkZSkKPiA+IC0J
CQlyZXR1cm4gaW50ZWxfdGlsZV9zaXplKGRldl9wcml2KTsKPiA+ICsJCQlyZXR1cm4gaW50ZWxf
dGlsZV9zaXplKGk5MTUpOwo+ID4gICAJCWVsc2UKPiA+ICAgCQkJcmV0dXJuIDY0Owo+ID4gICAJ
fSBlbHNlIHsKPiA+IEBAIC0yNTcwLDcgKzI1NzAsNyBAQCBpbnRlbF9mYl9zdHJpZGVfYWxpZ25t
ZW50KGNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLCBpbnQgY29sb3JfcGxhbmUpCj4g
PiAgIGJvb2wgaW50ZWxfcGxhbmVfY2FuX3JlbWFwKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9z
dGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxh
bmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNl
LmRldik7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0
YXRlLT5iYXNlLmZiOwo+ID4gICAJaW50IGk7Cj4gPiBAQCAtMjU4NCw3ICsyNTg0LDcgQEAgYm9v
bCBpbnRlbF9wbGFuZV9jYW5fcmVtYXAoY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpw
bGFuZV9zdGF0ZSkKPiA+ICAgCSAqIFdvdWxkIGFsc28gbmVlZCB0byBkZWFsIHdpdGggdGhlIGZl
bmNlIFBPVCBhbGlnbm1lbnQKPiA+ICAgCSAqIGFuZCBnZW4yIDJLaUIgR1RUIHRpbGUgc2l6ZS4K
PiA+ICAgCSAqLwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDQpCj4gPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPCA0KQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+ICAgCS8qCj4gPiBA
QCAtMjU5Niw3ICsyNTk2LDcgQEAgYm9vbCBpbnRlbF9wbGFuZV9jYW5fcmVtYXAoY29uc3Qgc3Ry
dWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiA+ICAgCS8qIExpbmVhciBuZWVk
cyBhIHBhZ2UgYWxpZ25lZCBzdHJpZGUgZm9yIHJlbWFwcGluZyAqLwo+ID4gICAJaWYgKGZiLT5t
b2RpZmllciA9PSBEUk1fRk9STUFUX01PRF9MSU5FQVIpIHsKPiA+IC0JCXVuc2lnbmVkIGludCBh
bGlnbm1lbnQgPSBpbnRlbF90aWxlX3NpemUoZGV2X3ByaXYpIC0gMTsKPiA+ICsJCXVuc2lnbmVk
IGludCBhbGlnbm1lbnQgPSBpbnRlbF90aWxlX3NpemUoaTkxNSkgLSAxOwo+ID4gICAJCWZvciAo
aSA9IDA7IGkgPCBmYi0+Zm9ybWF0LT5udW1fcGxhbmVzOyBpKyspIHsKPiA+ICAgCQkJaWYgKGZi
LT5waXRjaGVzW2ldICYgYWxpZ25tZW50KQo+ID4gQEAgLTI2MzYsNyArMjYzNiw3IEBAIHN0YXRp
YyBib29sIGludGVsX3BsYW5lX25lZWRzX3JlbWFwKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9z
dGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIH0KPiA+ICAgc3RhdGljIGludAo+ID4gLWludGVsX2Zp
bGxfZmJfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAraW50ZWxf
ZmlsbF9mYl9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCSAgIHN0
cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZnJh
bWVidWZmZXIgKmludGVsX2ZiID0gdG9faW50ZWxfZnJhbWVidWZmZXIoZmIpOwo+ID4gQEAgLTI2
NDUsNyArMjY0NSw3IEBAIGludGVsX2ZpbGxfZmJfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiAgIAl1MzIgZ3R0X29mZnNldF9yb3RhdGVkID0gMDsKPiA+ICAgCXVu
c2lnbmVkIGludCBtYXhfc2l6ZSA9IDA7Cj4gPiAgIAlpbnQgaSwgbnVtX3BsYW5lcyA9IGZiLT5m
b3JtYXQtPm51bV9wbGFuZXM7Cj4gPiAtCXVuc2lnbmVkIGludCB0aWxlX3NpemUgPSBpbnRlbF90
aWxlX3NpemUoZGV2X3ByaXYpOwo+ID4gKwl1bnNpZ25lZCBpbnQgdGlsZV9zaXplID0gaW50ZWxf
dGlsZV9zaXplKGk5MTUpOwo+ID4gICAJZm9yIChpID0gMDsgaSA8IG51bV9wbGFuZXM7IGkrKykg
ewo+ID4gICAJCXVuc2lnbmVkIGludCB3aWR0aCwgaGVpZ2h0Owo+ID4gQEAgLTI3MTksNyArMjcx
OSw3IEBAIGludGVsX2ZpbGxfZmJfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAgIAkJaW50ZWxfZmItPm5vcm1hbFtpXS54ID0geDsKPiA+ICAgCQlpbnRlbF9mYi0+
bm9ybWFsW2ldLnkgPSB5Owo+ID4gLQkJb2Zmc2V0ID0gaW50ZWxfY29tcHV0ZV9hbGlnbmVkX29m
ZnNldChkZXZfcHJpdiwgJngsICZ5LCBmYiwgaSwKPiA+ICsJCW9mZnNldCA9IGludGVsX2NvbXB1
dGVfYWxpZ25lZF9vZmZzZXQoaTkxNSwgJngsICZ5LCBmYiwgaSwKPiA+ICAgCQkJCQkJICAgICAg
ZmItPnBpdGNoZXNbaV0sCj4gPiAgIAkJCQkJCSAgICAgIERSTV9NT0RFX1JPVEFURV8wLAo+ID4g
ICAJCQkJCQkgICAgICB0aWxlX3NpemUpOwo+ID4gQEAgLTI4MDMsMTQgKzI4MDMsMTQgQEAgaW50
ZWxfZmlsbF9mYl9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAg
c3RhdGljIHZvaWQKPiA+ICAgaW50ZWxfcGxhbmVfcmVtYXBfZ3R0KHN0cnVjdCBpbnRlbF9wbGFu
ZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ID4g
ICAJCXRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUtPmRldik7Cj4gPiAgIAlzdHJ1Y3Qg
ZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5iYXNlLmZiOwo+ID4gICAJc3RydWN0
IGludGVsX2ZyYW1lYnVmZmVyICppbnRlbF9mYiA9IHRvX2ludGVsX2ZyYW1lYnVmZmVyKGZiKTsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9yb3RhdGlvbl9pbmZvICppbmZvID0gJnBsYW5lX3N0YXRlLT52
aWV3LnJvdGF0ZWQ7Cj4gPiAgIAl1bnNpZ25lZCBpbnQgcm90YXRpb24gPSBwbGFuZV9zdGF0ZS0+
YmFzZS5yb3RhdGlvbjsKPiA+ICAgCWludCBpLCBudW1fcGxhbmVzID0gZmItPmZvcm1hdC0+bnVt
X3BsYW5lczsKPiA+IC0JdW5zaWduZWQgaW50IHRpbGVfc2l6ZSA9IGludGVsX3RpbGVfc2l6ZShk
ZXZfcHJpdik7Cj4gPiArCXVuc2lnbmVkIGludCB0aWxlX3NpemUgPSBpbnRlbF90aWxlX3NpemUo
aTkxNSk7Cj4gPiAgIAl1bnNpZ25lZCBpbnQgc3JjX3gsIHNyY195Owo+ID4gICAJdW5zaWduZWQg
aW50IHNyY193LCBzcmNfaDsKPiA+ICAgCXUzMiBndHRfb2Zmc2V0ID0gMDsKPiA+IEBAIC0yODYw
LDcgKzI4NjAsNyBAQCBpbnRlbF9wbGFuZV9yZW1hcF9ndHQoc3RydWN0IGludGVsX3BsYW5lX3N0
YXRlICpwbGFuZV9zdGF0ZSkKPiA+ICAgCQl4ICs9IGludGVsX2ZiLT5ub3JtYWxbaV0ueDsKPiA+
ICAgCQl5ICs9IGludGVsX2ZiLT5ub3JtYWxbaV0ueTsKPiA+IC0JCW9mZnNldCA9IGludGVsX2Nv
bXB1dGVfYWxpZ25lZF9vZmZzZXQoZGV2X3ByaXYsICZ4LCAmeSwKPiA+ICsJCW9mZnNldCA9IGlu
dGVsX2NvbXB1dGVfYWxpZ25lZF9vZmZzZXQoaTkxNSwgJngsICZ5LAo+ID4gICAJCQkJCQkgICAg
ICBmYiwgaSwgZmItPnBpdGNoZXNbaV0sCj4gPiAgIAkJCQkJCSAgICAgIERSTV9NT0RFX1JPVEFU
RV8wLCB0aWxlX3NpemUpOwo+ID4gICAJCW9mZnNldCAvPSB0aWxlX3NpemU7Cj4gPiBAQCAtMzA0
Niw3ICszMDQ2LDcgQEAgaW50ZWxfYWxsb2NfaW5pdGlhbF9wbGFuZV9vYmooc3RydWN0IGludGVs
X2NydGMgKmNydGMsCj4gPiAgIAkJCSAgICAgIHN0cnVjdCBpbnRlbF9pbml0aWFsX3BsYW5lX2Nv
bmZpZyAqcGxhbmVfY29uZmlnKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gTlVM
TDsKPiA+ICAgCXN0cnVjdCBkcm1fbW9kZV9mYl9jbWQyIG1vZGVfY21kID0geyAwIH07Cj4gPiAg
IAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9ICZwbGFuZV9jb25maWctPmZiLT5iYXNlOwo+
ID4gQEAgLTMwNjIsNyArMzA2Miw3IEBAIGludGVsX2FsbG9jX2luaXRpYWxfcGxhbmVfb2JqKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJLyogSWYgdGhlIEZCIGlzIHRvbyBiaWcsIGp1
c3QgZG9uJ3QgdXNlIGl0IHNpbmNlIGZiZGV2IGlzIG5vdCB2ZXJ5Cj4gPiAgIAkgKiBpbXBvcnRh
bnQgYW5kIHdlIHNob3VsZCBwcm9iYWJseSB1c2UgdGhhdCBzcGFjZSB3aXRoIEZCQyBvciBvdGhl
cgo+ID4gICAJICogZmVhdHVyZXMuICovCj4gPiAtCWlmIChzaXplX2FsaWduZWQgKiAyID4gZGV2
X3ByaXYtPnN0b2xlbl91c2FibGVfc2l6ZSkKPiA+ICsJaWYgKHNpemVfYWxpZ25lZCAqIDIgPiBp
OTE1LT5zdG9sZW5fdXNhYmxlX3NpemUpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gICAJc3dp
dGNoIChmYi0+bW9kaWZpZXIpIHsKPiA+IEBAIC0zMDc3LDcgKzMwNzcsNyBAQCBpbnRlbF9hbGxv
Y19pbml0aWFsX3BsYW5lX29iaihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCX0KPiA+
ICAgCW11dGV4X2xvY2soJmRldi0+c3RydWN0X211dGV4KTsKPiA+IC0Jb2JqID0gaTkxNV9nZW1f
b2JqZWN0X2NyZWF0ZV9zdG9sZW5fZm9yX3ByZWFsbG9jYXRlZChkZXZfcHJpdiwKPiA+ICsJb2Jq
ID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW5fZm9yX3ByZWFsbG9jYXRlZChpOTE1LAo+
ID4gICAJCQkJCQkJICAgICBiYXNlX2FsaWduZWQsCj4gPiAgIAkJCQkJCQkgICAgIGJhc2VfYWxp
Z25lZCwKPiA+ICAgCQkJCQkJCSAgICAgc2l6ZV9hbGlnbmVkKTsKPiA+IEBAIC0zMTM1LDcgKzMx
MzUsNyBAQCBpbnRlbF9zZXRfcGxhbmVfdmlzaWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPiA+ICAgc3RhdGljIHZvaWQgZml4dXBfYWN0aXZlX3BsYW5lcyhzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICAgCXN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lOwo+ID4g
ICAJLyoKPiA+IEBAIC0zMTQ1LDcgKzMxNDUsNyBAQCBzdGF0aWMgdm9pZCBmaXh1cF9hY3RpdmVf
cGxhbmVzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICAJICovCj4g
PiAgIAljcnRjX3N0YXRlLT5hY3RpdmVfcGxhbmVzID0gMDsKPiA+IC0JZHJtX2Zvcl9lYWNoX3Bs
YW5lX21hc2socGxhbmUsICZkZXZfcHJpdi0+ZHJtLAo+ID4gKwlkcm1fZm9yX2VhY2hfcGxhbmVf
bWFzayhwbGFuZSwgJmk5MTUtPmRybSwKPiA+ICAgCQkJCWNydGNfc3RhdGUtPmJhc2UucGxhbmVf
bWFzaykKPiA+ICAgCQljcnRjX3N0YXRlLT5hY3RpdmVfcGxhbmVzIHw9IEJJVCh0b19pbnRlbF9w
bGFuZShwbGFuZSktPmlkKTsKPiA+ICAgfQo+ID4gQEAgLTMxNzcsNyArMzE3Nyw3IEBAIGludGVs
X2ZpbmRfaW5pdGlhbF9wbGFuZV9vYmooc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCj4g
PiAgIAkJCSAgICAgc3RydWN0IGludGVsX2luaXRpYWxfcGxhbmVfY29uZmlnICpwbGFuZV9jb25m
aWcpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBpbnRlbF9jcnRjLT5i
YXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2
KTsKPiA+ICAgCXN0cnVjdCBkcm1fY3J0YyAqYzsKPiA+ICAgCXN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmo7Cj4gPiAgIAlzdHJ1Y3QgZHJtX3BsYW5lICpwcmltYXJ5ID0gaW50ZWxfY3J0
Yy0+YmFzZS5wcmltYXJ5Owo+ID4gQEAgLTMyNzIsNyArMzI3Miw3IEBAIGludGVsX2ZpbmRfaW5p
dGlhbF9wbGFuZV9vYmooc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCj4gPiAgIAlpbnRl
bF9zdGF0ZS0+YmFzZS5kc3QgPSBkcm1fcGxhbmVfc3RhdGVfZGVzdChwbGFuZV9zdGF0ZSk7Cj4g
PiAgIAlpZiAoaTkxNV9nZW1fb2JqZWN0X2lzX3RpbGVkKG9iaikpCj4gPiAtCQlkZXZfcHJpdi0+
cHJlc2VydmVfYmlvc19zd2l6emxlID0gdHJ1ZTsKPiA+ICsJCWk5MTUtPnByZXNlcnZlX2Jpb3Nf
c3dpenpsZSA9IHRydWU7Cj4gPiAgIAlwbGFuZV9zdGF0ZS0+ZmIgPSBmYjsKPiA+ICAgCXBsYW5l
X3N0YXRlLT5jcnRjID0gJmludGVsX2NydGMtPmJhc2U7Cj4gPiBAQCAtMzM4MSw3ICszMzgxLDcg
QEAgc3RhdGljIGJvb2wgc2tsX2NoZWNrX21haW5fY2NzX2Nvb3JkaW5hdGVzKHN0cnVjdCBpbnRl
bF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUKPiA+ICAgc3RhdGljIGludCBza2xfY2hlY2tfbWFp
bl9zdXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZV9z
dGF0ZS0+YmFzZS5wbGFuZS0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lLT5kZXYpOwo+ID4gICAJY29uc3Qg
c3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+YmFzZS5mYjsKPiA+ICAg
CXVuc2lnbmVkIGludCByb3RhdGlvbiA9IHBsYW5lX3N0YXRlLT5iYXNlLnJvdGF0aW9uOwo+ID4g
ICAJaW50IHggPSBwbGFuZV9zdGF0ZS0+YmFzZS5zcmMueDEgPj4gMTY7Cj4gPiBAQCAtMzM5Miw5
ICszMzkyLDkgQEAgc3RhdGljIGludCBza2xfY2hlY2tfbWFpbl9zdXJmYWNlKHN0cnVjdCBpbnRl
bF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIAlpbnQgbWF4X2hlaWdodCA9IDQwOTY7
Cj4gPiAgIAl1MzIgYWxpZ25tZW50LCBvZmZzZXQsIGF1eF9vZmZzZXQgPSBwbGFuZV9zdGF0ZS0+
Y29sb3JfcGxhbmVbMV0ub2Zmc2V0Owo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAx
MSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICAgCQltYXhfd2lkdGggPSBp
Y2xfbWF4X3BsYW5lX3dpZHRoKGZiLCAwLCByb3RhdGlvbik7Cj4gPiAtCWVsc2UgaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gPiArCWVs
c2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGk5MTUpKQo+ID4g
ICAJCW1heF93aWR0aCA9IGdsa19tYXhfcGxhbmVfd2lkdGgoZmIsIDAsIHJvdGF0aW9uKTsKPiA+
ICAgCWVsc2UKPiA+ICAgCQltYXhfd2lkdGggPSBza2xfbWF4X3BsYW5lX3dpZHRoKGZiLCAwLCBy
b3RhdGlvbik7Cj4gPiBAQCAtMzU2NCwxNiArMzU2NCwxNiBAQCBpOXh4X3BsYW5lX21heF9zdHJp
ZGUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCQkgICAgICB1MzIgcGl4ZWxfZm9y
bWF0LCB1NjQgbW9kaWZpZXIsCj4gPiAgIAkJICAgICAgdW5zaWduZWQgaW50IHJvdGF0aW9uKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
cGxhbmUtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gPiAtCWlmICghSEFTX0dNQ0goZGV2X3ByaXYpKSB7
Cj4gPiArCWlmICghSEFTX0dNQ0goaTkxNSkpIHsKPiA+ICAgCQlyZXR1cm4gMzIqMTAyNDsKPiA+
IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpIHsKPiA+ICsJfSBlbHNlIGlm
IChJTlRFTF9HRU4oaTkxNSkgPj0gNCkgewo+ID4gICAJCWlmIChtb2RpZmllciA9PSBJOTE1X0ZP
Uk1BVF9NT0RfWF9USUxFRCkKPiA+ICAgCQkJcmV0dXJuIDE2KjEwMjQ7Cj4gPiAgIAkJZWxzZQo+
ID4gICAJCQlyZXR1cm4gMzIqMTAyNDsKPiA+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDMpIHsKPiA+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMykgewo+ID4g
ICAJCWlmIChtb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWF9USUxFRCkKPiA+ICAgCQkJcmV0
dXJuIDgqMTAyNDsKPiA+ICAgCQllbHNlCj4gPiBAQCAtMzU4OSw3ICszNTg5LDcgQEAgaTl4eF9w
bGFuZV9tYXhfc3RyaWRlKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIHN0YXRpYyB1
MzIgaTl4eF9wbGFuZV9jdGxfY3J0Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJdTMy
IGRzcGNudHIgPSAwOwo+ID4gICAJaWYgKGNydGNfc3RhdGUtPmdhbW1hX2VuYWJsZSkKPiA+IEBA
IC0zNTk4LDcgKzM1OTgsNyBAQCBzdGF0aWMgdTMyIGk5eHhfcGxhbmVfY3RsX2NydGMoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIAlpZiAoY3J0Y19zdGF0
ZS0+Y3NjX2VuYWJsZSkKPiA+ICAgCQlkc3BjbnRyIHw9IERJU1BQTEFORV9QSVBFX0NTQ19FTkFC
TEU7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNSkKPiA+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA8IDUpCj4gPiAgIAkJZHNwY250ciB8PSBESVNQUExBTkVfU0VMX1BJUEUoY3J0Yy0+
cGlwZSk7Cj4gPiAgIAlyZXR1cm4gZHNwY250cjsKPiA+IEBAIC0zNjA3LDcgKzM2MDcsNyBAQCBz
dGF0aWMgdTMyIGk5eHhfcGxhbmVfY3RsX2NydGMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4gPiAgIHN0YXRpYyB1MzIgaTl4eF9wbGFuZV9jdGwoY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCSAgY29uc3Qgc3RydWN0
IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9Cj4gPiAgIAkJdG9faTkxNShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZS0+ZGV2KTsKPiA+
ICAgCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2Uu
ZmI7Cj4gPiAgIAl1bnNpZ25lZCBpbnQgcm90YXRpb24gPSBwbGFuZV9zdGF0ZS0+YmFzZS5yb3Rh
dGlvbjsKPiA+IEBAIC0zNjE1LDggKzM2MTUsOCBAQCBzdGF0aWMgdTMyIGk5eHhfcGxhbmVfY3Rs
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJZHNwY250
ciA9IERJU1BMQVlfUExBTkVfRU5BQkxFOwo+ID4gLQlpZiAoSVNfRzRYKGRldl9wcml2KSB8fCBJ
U19HRU4oZGV2X3ByaXYsIDUpIHx8Cj4gPiAtCSAgICBJU19HRU4oZGV2X3ByaXYsIDYpIHx8IElT
X0lWWUJSSURHRShkZXZfcHJpdikpCj4gPiArCWlmIChJU19HNFgoaTkxNSkgfHwgSVNfR0VOKGk5
MTUsIDUpIHx8Cj4gPiArCSAgICBJU19HRU4oaTkxNSwgNikgfHwgSVNfSVZZQlJJREdFKGk5MTUp
KQo+ID4gICAJCWRzcGNudHIgfD0gRElTUFBMQU5FX1RSSUNLTEVfRkVFRF9ESVNBQkxFOwo+ID4g
ICAJc3dpdGNoIChmYi0+Zm9ybWF0LT5mb3JtYXQpIHsKPiA+IEBAIC0zNjQ2LDcgKzM2NDYsNyBA
QCBzdGF0aWMgdTMyIGk5eHhfcGxhbmVfY3RsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+ID4gICAJCXJldHVybiAwOwo+ID4gICAJfQo+ID4gLQlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA0ICYmCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCAmJgo+
ID4gICAJICAgIGZiLT5tb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWF9USUxFRCkKPiA+ICAg
CQlkc3BjbnRyIHw9IERJU1BQTEFORV9USUxFRDsKPiA+IEBAIC0zNjYxLDcgKzM2NjEsNyBAQCBz
dGF0aWMgdTMyIGk5eHhfcGxhbmVfY3RsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAo+ID4gICBpbnQgaTl4eF9jaGVja19wbGFuZV9zdXJmYWNlKHN0cnVjdCBpbnRl
bF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PQo+ID4gICAJCXRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUtPmRldik7Cj4gPiAgIAlp
bnQgc3JjX3gsIHNyY195Owo+ID4gICAJdTMyIG9mZnNldDsKPiA+IEBAIC0zNjc5LDcgKzM2Nzks
NyBAQCBpbnQgaTl4eF9jaGVja19wbGFuZV9zdXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0
ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIAlpbnRlbF9hZGRfZmJfb2Zmc2V0cygmc3JjX3gsICZzcmNf
eSwgcGxhbmVfc3RhdGUsIDApOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KQo+
ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpCj4gPiAgIAkJb2Zmc2V0ID0gaW50ZWxfcGxh
bmVfY29tcHV0ZV9hbGlnbmVkX29mZnNldCgmc3JjX3gsICZzcmNfeSwKPiA+ICAgCQkJCQkJCSAg
ICBwbGFuZV9zdGF0ZSwgMCk7Cj4gPiAgIAllbHNlCj4gPiBAQCAtMzY5NCw3ICszNjk0LDcgQEAg
aW50IGk5eHhfY2hlY2tfcGxhbmVfc3VyZmFjZShzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBs
YW5lX3N0YXRlKQo+ID4gICAJCQkgICAoc3JjX3kgPDwgMTYpIC0gcGxhbmVfc3RhdGUtPmJhc2Uu
c3JjLnkxKTsKPiA+ICAgCS8qIEhTVy9CRFcgZG8gdGhpcyBhdXRvbWFnaWNhbGx5IGluIGhhcmR3
YXJlICovCj4gPiAtCWlmICghSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgIUlTX0JST0FEV0VMTChk
ZXZfcHJpdikpIHsKPiA+ICsJaWYgKCFJU19IQVNXRUxMKGk5MTUpICYmICFJU19CUk9BRFdFTEwo
aTkxNSkpIHsKPiA+ICAgCQl1bnNpZ25lZCBpbnQgcm90YXRpb24gPSBwbGFuZV9zdGF0ZS0+YmFz
ZS5yb3RhdGlvbjsKPiA+ICAgCQlpbnQgc3JjX3cgPSBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3Rh
dGUtPmJhc2Uuc3JjKSA+PiAxNjsKPiA+ICAgCQlpbnQgc3JjX2ggPSBkcm1fcmVjdF9oZWlnaHQo
JnBsYW5lX3N0YXRlLT5iYXNlLnNyYykgPj4gMTY7Cj4gPiBAQCAtMzc1Miw3ICszNzUyLDcgQEAg
c3RhdGljIHZvaWQgaTl4eF91cGRhdGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwK
PiA+ICAgCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3Rh
dGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gaTl4eF9wbGFuZV9pZCBp
OXh4X3BsYW5lID0gcGxhbmUtPmk5eHhfcGxhbmU7Cj4gPiAgIAl1MzIgbGluZWFyX29mZnNldDsK
PiA+ICAgCWludCB4ID0gcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzBdLng7Cj4gPiBAQCAtMzc2
NSwxNiArMzc2NSwxNiBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV9wbGFuZShzdHJ1Y3QgaW50
ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJbGluZWFyX29mZnNldCA9IGludGVsX2ZiX3h5X3RvX2xp
bmVhcih4LCB5LCBwbGFuZV9zdGF0ZSwgMCk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDQpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkKPiA+ICAgCQlkc3BhZGRyX29m
ZnNldCA9IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5vZmZzZXQ7Cj4gPiAgIAllbHNlCj4g
PiAgIAkJZHNwYWRkcl9vZmZzZXQgPSBsaW5lYXJfb2Zmc2V0Owo+ID4gLQlzcGluX2xvY2tfaXJx
c2F2ZSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gPiArCXNwaW5fbG9ja19p
cnFzYXZlKCZpOTE1LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gICAJSTkxNV9XUklURV9G
VyhEU1BTVFJJREUoaTl4eF9wbGFuZSksIHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5zdHJp
ZGUpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDQpIHsKPiA+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA8IDQpIHsKPiA+ICAgCQkvKiBwaXBlc3JjIGFuZCBkc3BzaXplIGNvbnRyb2wg
dGhlIHNpemUgdGhhdCBpcyBzY2FsZWQgZnJvbSwKPiA+ICAgCQkgKiB3aGljaCBzaG91bGQgYWx3
YXlzIGJlIHRoZSB1c2VyJ3MgcmVxdWVzdGVkIHNpemUuCj4gPiAgIAkJICovCj4gPiBAQCAtMzc4
Miw3ICszNzgyLDcgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfcGxhbmUoc3RydWN0IGludGVs
X3BsYW5lICpwbGFuZSwKPiA+ICAgCQlJOTE1X1dSSVRFX0ZXKERTUFNJWkUoaTl4eF9wbGFuZSks
Cj4gPiAgIAkJCSAgICAgICgoY3J0Y19zdGF0ZS0+cGlwZV9zcmNfaCAtIDEpIDw8IDE2KSB8Cj4g
PiAgIAkJCSAgICAgIChjcnRjX3N0YXRlLT5waXBlX3NyY193IC0gMSkpOwo+ID4gLQl9IGVsc2Ug
aWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpICYmIGk5eHhfcGxhbmUgPT0gUExBTkVfQikgewo+
ID4gKwl9IGVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkgJiYgaTl4eF9wbGFuZSA9PSBQTEFO
RV9CKSB7Cj4gPiAgIAkJSTkxNV9XUklURV9GVyhQUklNUE9TKGk5eHhfcGxhbmUpLCAwKTsKPiA+
ICAgCQlJOTE1X1dSSVRFX0ZXKFBSSU1TSVpFKGk5eHhfcGxhbmUpLAo+ID4gICAJCQkgICAgICAo
KGNydGNfc3RhdGUtPnBpcGVfc3JjX2ggLSAxKSA8PCAxNikgfAo+ID4gQEAgLTM3OTAsOSArMzc5
MCw5IEBAIHN0YXRpYyB2b2lkIGk5eHhfdXBkYXRlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAq
cGxhbmUsCj4gPiAgIAkJSTkxNV9XUklURV9GVyhQUklNQ05TVEFMUEhBKGk5eHhfcGxhbmUpLCAw
KTsKPiA+ICAgCX0KPiA+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VM
TChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURXRUxM
KGk5MTUpKSB7Cj4gPiAgIAkJSTkxNV9XUklURV9GVyhEU1BPRkZTRVQoaTl4eF9wbGFuZSksICh5
IDw8IDE2KSB8IHgpOwo+ID4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkg
ewo+ID4gKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KSB7Cj4gPiAgIAkJSTkxNV9X
UklURV9GVyhEU1BMSU5PRkYoaTl4eF9wbGFuZSksIGxpbmVhcl9vZmZzZXQpOwo+ID4gICAJCUk5
MTVfV1JJVEVfRlcoRFNQVElMRU9GRihpOXh4X3BsYW5lKSwgKHkgPDwgMTYpIHwgeCk7Cj4gPiAg
IAl9Cj4gPiBAQCAtMzgwMyw3ICszODAzLDcgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfcGxh
bmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCSAqIHRoZSBjb250cm9sIHJlZ2lz
dGVyIGp1c3QgYmVmb3JlIHRoZSBzdXJmYWNlIHJlZ2lzdGVyLgo+ID4gICAJICovCj4gPiAgIAlJ
OTE1X1dSSVRFX0ZXKERTUENOVFIoaTl4eF9wbGFuZSksIGRzcGNudHIpOwo+ID4gLQlpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA0KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpCj4g
PiAgIAkJSTkxNV9XUklURV9GVyhEU1BTVVJGKGk5eHhfcGxhbmUpLAo+ID4gICAJCQkgICAgICBp
bnRlbF9wbGFuZV9nZ3R0X29mZnNldChwbGFuZV9zdGF0ZSkgKwo+ID4gICAJCQkgICAgICBkc3Bh
ZGRyX29mZnNldCk7Cj4gPiBAQCAtMzgxMiwxMyArMzgxMiwxMyBAQCBzdGF0aWMgdm9pZCBpOXh4
X3VwZGF0ZV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJCQkgICAgICBp
bnRlbF9wbGFuZV9nZ3R0X29mZnNldChwbGFuZV9zdGF0ZSkgKwo+ID4gICAJCQkgICAgICBkc3Bh
ZGRyX29mZnNldCk7Cj4gPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT51bmNv
cmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT51
bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGk5eHhfZGlz
YWJsZV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJCQkgICAgICAgY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJh
c2UuZGV2KTsKPiA+ICAgCWVudW0gaTl4eF9wbGFuZV9pZCBpOXh4X3BsYW5lID0gcGxhbmUtPmk5
eHhfcGxhbmU7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIGlycWZsYWdzOwo+ID4gICAJdTMyIGRzcGNu
dHI7Cj4gPiBAQCAtMzgzNSwyMSArMzgzNSwyMSBAQCBzdGF0aWMgdm9pZCBpOXh4X2Rpc2FibGVf
cGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCSAqLwo+ID4gICAJZHNwY250
ciA9IGk5eHhfcGxhbmVfY3RsX2NydGMoY3J0Y19zdGF0ZSk7Cj4gPiAtCXNwaW5fbG9ja19pcnFz
YXZlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICsJc3Bpbl9sb2NrX2ly
cXNhdmUoJmk5MTUtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gPiAgIAlJOTE1X1dSSVRFX0ZX
KERTUENOVFIoaTl4eF9wbGFuZSksIGRzcGNudHIpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA0KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpCj4gPiAgIAkJSTkxNV9X
UklURV9GVyhEU1BTVVJGKGk5eHhfcGxhbmUpLCAwKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlJOTE1
X1dSSVRFX0ZXKERTUEFERFIoaTl4eF9wbGFuZSksIDApOwo+ID4gLQlzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICsJc3Bpbl91bmxv
Y2tfaXJxcmVzdG9yZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICAgfQo+ID4g
ICBzdGF0aWMgYm9vbCBpOXh4X3BsYW5lX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfcGxhbmUg
KnBsYW5lLAo+ID4gICAJCQkJICAgIGVudW0gcGlwZSAqcGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFz
ZS5kZXYpOwo+ID4gICAJZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBwb3dlcl9kb21h
aW47Cj4gPiAgIAllbnVtIGk5eHhfcGxhbmVfaWQgaTl4eF9wbGFuZSA9IHBsYW5lLT5pOXh4X3Bs
YW5lOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiBAQCAtMzg2Miw3ICszODYy
LDcgQEAgc3RhdGljIGJvb2wgaTl4eF9wbGFuZV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX3Bs
YW5lICpwbGFuZSwKPiA+ICAgCSAqIGRpc3BsYXkgcG93ZXIgd2VsbHMuCj4gPiAgIAkgKi8KPiA+
ICAgCXBvd2VyX2RvbWFpbiA9IFBPV0VSX0RPTUFJTl9QSVBFKHBsYW5lLT5waXBlKTsKPiA+IC0J
d2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBv
d2VyX2RvbWFpbik7Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9l
bmFibGVkKGk5MTUsIHBvd2VyX2RvbWFpbik7Cj4gPiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJ
cmV0dXJuIGZhbHNlOwo+ID4gQEAgLTM4NzAsMTMgKzM4NzAsMTMgQEAgc3RhdGljIGJvb2wgaTl4
eF9wbGFuZV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCXJl
dCA9IHZhbCAmIERJU1BMQVlfUExBTkVfRU5BQkxFOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA1KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDUpCj4gPiAgIAkJKnBpcGUg
PSBwbGFuZS0+cGlwZTsKPiA+ICAgCWVsc2UKPiA+ICAgCQkqcGlwZSA9ICh2YWwgJiBESVNQUExB
TkVfU0VMX1BJUEVfTUFTSykgPj4KPiA+ICAgCQkJRElTUFBMQU5FX1NFTF9QSVBFX1NISUZUOwo+
ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgcG93ZXJfZG9tYWluLCB3YWtl
cmVmKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgcG93ZXJfZG9tYWluLCB3
YWtlcmVmKTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IEBAIC0zODg0LDcgKzM4ODQs
NyBAQCBzdGF0aWMgYm9vbCBpOXh4X3BsYW5lX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfcGxh
bmUgKnBsYW5lLAo+ID4gICBzdGF0aWMgdm9pZCBza2xfZGV0YWNoX3NjYWxlcihzdHJ1Y3QgaW50
ZWxfY3J0YyAqaW50ZWxfY3J0YywgaW50IGlkKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gaW50ZWxfY3J0Yy0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlJOTE1X1dSSVRFKFNLTF9QU19DVFJM
KGludGVsX2NydGMtPnBpcGUsIGlkKSwgMCk7Cj4gPiAgIAlJOTE1X1dSSVRFKFNLTF9QU19XSU5f
UE9TKGludGVsX2NydGMtPnBpcGUsIGlkKSwgMCk7Cj4gPiBAQCAtNDA5MSwxMCArNDA5MSwxMCBA
QCBzdGF0aWMgdTMyIGNubF9wbGFuZV9jdGxfZmxpcCh1bnNpZ25lZCBpbnQgcmVmbGVjdCkKPiA+
ICAgdTMyIHNrbF9wbGFuZV9jdGxfY3J0Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2
KTsKPiA+ICAgCXUzMiBwbGFuZV9jdGwgPSAwOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSkKPiA+ICsJaWYgKElOVEVMX0dFTihp
OTE1KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGk5MTUpKQo+ID4gICAJCXJldHVybiBwbGFuZV9j
dGw7Cj4gPiAgIAlpZiAoY3J0Y19zdGF0ZS0+Z2FtbWFfZW5hYmxlKQo+ID4gQEAgLTQxMDksNyAr
NDEwOSw3IEBAIHUzMiBza2xfcGxhbmVfY3RsX2NydGMoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHUzMiBza2xfcGxhbmVfY3RsKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCSAgY29uc3Qgc3RydWN0IGludGVs
X3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
Cj4gPiAgIAkJdG9faTkxNShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZS0+ZGV2KTsKPiA+ICAgCWNv
bnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7Cj4g
PiAgIAl1bnNpZ25lZCBpbnQgcm90YXRpb24gPSBwbGFuZV9zdGF0ZS0+YmFzZS5yb3RhdGlvbjsK
PiA+IEBAIC00MTE4LDcgKzQxMTgsNyBAQCB1MzIgc2tsX3BsYW5lX2N0bChjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCXBsYW5lX2N0bCA9IFBMQU5FX0NU
TF9FTkFCTEU7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTAgJiYgIUlTX0dFTUlO
SUxBS0UoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCAxMCAmJiAhSVNf
R0VNSU5JTEFLRShpOTE1KSkgewo+ID4gICAJCXBsYW5lX2N0bCB8PSBza2xfcGxhbmVfY3RsX2Fs
cGhhKHBsYW5lX3N0YXRlKTsKPiA+ICAgCQlwbGFuZV9jdGwgfD0gUExBTkVfQ1RMX1BMQU5FX0dB
TU1BX0RJU0FCTEU7Cj4gPiBAQCAtNDEzMyw3ICs0MTMzLDcgQEAgdTMyIHNrbF9wbGFuZV9jdGwo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAlwbGFuZV9j
dGwgfD0gc2tsX3BsYW5lX2N0bF90aWxpbmcoZmItPm1vZGlmaWVyKTsKPiA+ICAgCXBsYW5lX2N0
bCB8PSBza2xfcGxhbmVfY3RsX3JvdGF0ZShyb3RhdGlvbiAmIERSTV9NT0RFX1JPVEFURV9NQVNL
KTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApCj4gPiArCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gMTApCj4gPiAgIAkJcGxhbmVfY3RsIHw9IGNubF9wbGFuZV9jdGxfZmxpcChy
b3RhdGlvbiAmCj4gPiAgIAkJCQkJCURSTV9NT0RFX1JFRkxFQ1RfTUFTSyk7Cj4gPiBAQCAtNDE0
NywxMCArNDE0NywxMCBAQCB1MzIgc2tsX3BsYW5lX2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgdTMyIGdsa19wbGFuZV9jb2xvcl9jdGxfY3J0Yyhj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJh
c2UuY3J0Yy0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICAgCXUzMiBwbGFuZV9jb2xvcl9j
dGwgPSAwOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiA+ICsJaWYgKElO
VEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICAgCQlyZXR1cm4gcGxhbmVfY29sb3JfY3RsOwo+ID4g
ICAJaWYgKGNydGNfc3RhdGUtPmdhbW1hX2VuYWJsZSkKPiA+IEBAIC00MTY1LDcgKzQxNjUsNyBA
QCB1MzIgZ2xrX3BsYW5lX2NvbG9yX2N0bF9jcnRjKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+ID4gICB1MzIgZ2xrX3BsYW5lX2NvbG9yX2N0bChjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJY29uc3Qgc3RydWN0IGlu
dGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9Cj4gPiAgIAkJdG9faTkxNShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZS0+ZGV2KTsKPiA+ICAg
CWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVf
c3RhdGUtPmJhc2UucGxhbmUpOwo+ID4gQEAgLTQxNzQsNyArNDE3NCw3IEBAIHUzMiBnbGtfcGxh
bmVfY29sb3JfY3RsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ID4gICAJcGxhbmVfY29sb3JfY3RsIHw9IFBMQU5FX0NPTE9SX1BMQU5FX0dBTU1BX0RJU0FCTEU7
Cj4gPiAgIAlwbGFuZV9jb2xvcl9jdGwgfD0gZ2xrX3BsYW5lX2NvbG9yX2N0bF9hbHBoYShwbGFu
ZV9zdGF0ZSk7Cj4gPiAtCWlmIChmYi0+Zm9ybWF0LT5pc195dXYgJiYgIWljbF9pc19oZHJfcGxh
bmUoZGV2X3ByaXYsIHBsYW5lLT5pZCkpIHsKPiA+ICsJaWYgKGZiLT5mb3JtYXQtPmlzX3l1diAm
JiAhaWNsX2lzX2hkcl9wbGFuZShpOTE1LCBwbGFuZS0+aWQpKSB7Cj4gPiAgIAkJaWYgKHBsYW5l
X3N0YXRlLT5iYXNlLmNvbG9yX2VuY29kaW5nID09IERSTV9DT0xPUl9ZQ0JDUl9CVDcwOSkKPiA+
ICAgCQkJcGxhbmVfY29sb3JfY3RsIHw9IFBMQU5FX0NPTE9SX0NTQ19NT0RFX1lVVjcwOV9UT19S
R0I3MDk7Cj4gPiAgIAkJZWxzZQo+ID4gQEAgLTQyMjgsMzEgKzQyMjgsMzEgQEAgX19pbnRlbF9k
aXNwbGF5X3Jlc3VtZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ID4gICAJcmV0dXJuIHJldDsK
PiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIGdwdV9yZXNldF9jbG9iYmVyc19kaXNwbGF5KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgYm9vbCBncHVfcmVzZXRf
Y2xvYmJlcnNfZGlzcGxheShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+
ID4gLQlyZXR1cm4gKElOVEVMX0lORk8oZGV2X3ByaXYpLT5ncHVfcmVzZXRfY2xvYmJlcnNfZGlz
cGxheSAmJgo+ID4gLQkJaW50ZWxfaGFzX2dwdV9yZXNldChkZXZfcHJpdikpOwo+ID4gKwlyZXR1
cm4gKElOVEVMX0lORk8oaTkxNSktPmdwdV9yZXNldF9jbG9iYmVyc19kaXNwbGF5ICYmCj4gPiAr
CQlpbnRlbF9oYXNfZ3B1X3Jlc2V0KGk5MTUpKTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfcHJl
cGFyZV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBp
bnRlbF9wcmVwYXJlX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiA+IC0Jc3Ry
dWN0IGRybV9tb2Rlc2V0X2FjcXVpcmVfY3R4ICpjdHggPSAmZGV2X3ByaXYtPnJlc2V0X2N0eDsK
PiA+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZpOTE1LT5kcm07Cj4gPiArCXN0cnVjdCBk
cm1fbW9kZXNldF9hY3F1aXJlX2N0eCAqY3R4ID0gJmk5MTUtPnJlc2V0X2N0eDsKPiA+ICAgCXN0
cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZTsKPiA+ICAgCWludCByZXQ7Cj4gPiAgIAkvKiBy
ZXNldCBkb2Vzbid0IHRvdWNoIHRoZSBkaXNwbGF5ICovCj4gPiAgIAlpZiAoIWk5MTVfbW9kcGFy
YW1zLmZvcmNlX3Jlc2V0X21vZGVzZXRfdGVzdCAmJgo+ID4gLQkgICAgIWdwdV9yZXNldF9jbG9i
YmVyc19kaXNwbGF5KGRldl9wcml2KSkKPiA+ICsJICAgICFncHVfcmVzZXRfY2xvYmJlcnNfZGlz
cGxheShpOTE1KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAkvKiBXZSBoYXZlIGEgbW9kZXNldCB2
cyByZXNldCBkZWFkbG9jaywgZGVmZW5zaXZlbHkgdW5icmVhayBpdC4gKi8KPiA+IC0Jc2V0X2Jp
dChJOTE1X1JFU0VUX01PREVTRVQsICZkZXZfcHJpdi0+Z3B1X2Vycm9yLmZsYWdzKTsKPiA+IC0J
d2FrZV91cF9hbGwoJmRldl9wcml2LT5ncHVfZXJyb3Iud2FpdF9xdWV1ZSk7Cj4gPiArCXNldF9i
aXQoSTkxNV9SRVNFVF9NT0RFU0VULCAmaTkxNS0+Z3B1X2Vycm9yLmZsYWdzKTsKPiA+ICsJd2Fr
ZV91cF9hbGwoJmk5MTUtPmdwdV9lcnJvci53YWl0X3F1ZXVlKTsKPiA+IC0JaWYgKGF0b21pY19y
ZWFkKCZkZXZfcHJpdi0+Z3B1X2Vycm9yLnBlbmRpbmdfZmJfcGluKSkgewo+ID4gKwlpZiAoYXRv
bWljX3JlYWQoJmk5MTUtPmdwdV9lcnJvci5wZW5kaW5nX2ZiX3BpbikpIHsKPiA+ICAgCQlEUk1f
REVCVUdfS01TKCJNb2Rlc2V0IHBvdGVudGlhbGx5IHN0dWNrLCB1bmJyZWFraW5nIHRocm91Z2gg
d2VkZ2luZ1xuIik7Cj4gPiAtCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGRldl9wcml2KTsKPiA+ICsJ
CWk5MTVfZ2VtX3NldF93ZWRnZWQoaTkxNSk7Cj4gPiAgIAl9Cj4gPiAgIAkvKgo+ID4gQEAgLTQy
ODYsMjcgKzQyODYsMjcgQEAgdm9pZCBpbnRlbF9wcmVwYXJlX3Jlc2V0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiAtCWRldl9w
cml2LT5tb2Rlc2V0X3Jlc3RvcmVfc3RhdGUgPSBzdGF0ZTsKPiA+ICsJaTkxNS0+bW9kZXNldF9y
ZXN0b3JlX3N0YXRlID0gc3RhdGU7Cj4gPiAgIAlzdGF0ZS0+YWNxdWlyZV9jdHggPSBjdHg7Cj4g
PiAgIH0KPiA+IC12b2lkIGludGVsX2ZpbmlzaF9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9maW5pc2hfcmVzZXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZk
ZXZfcHJpdi0+ZHJtOwo+ID4gLQlzdHJ1Y3QgZHJtX21vZGVzZXRfYWNxdWlyZV9jdHggKmN0eCA9
ICZkZXZfcHJpdi0+cmVzZXRfY3R4Owo+ID4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5
MTUtPmRybTsKPiA+ICsJc3RydWN0IGRybV9tb2Rlc2V0X2FjcXVpcmVfY3R4ICpjdHggPSAmaTkx
NS0+cmVzZXRfY3R4Owo+ID4gICAJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlOwo+ID4g
ICAJaW50IHJldDsKPiA+ICAgCS8qIHJlc2V0IGRvZXNuJ3QgdG91Y2ggdGhlIGRpc3BsYXkgKi8K
PiA+IC0JaWYgKCF0ZXN0X2JpdChJOTE1X1JFU0VUX01PREVTRVQsICZkZXZfcHJpdi0+Z3B1X2Vy
cm9yLmZsYWdzKSkKPiA+ICsJaWYgKCF0ZXN0X2JpdChJOTE1X1JFU0VUX01PREVTRVQsICZpOTE1
LT5ncHVfZXJyb3IuZmxhZ3MpKQo+ID4gICAJCXJldHVybjsKPiA+IC0Jc3RhdGUgPSBmZXRjaF9h
bmRfemVybygmZGV2X3ByaXYtPm1vZGVzZXRfcmVzdG9yZV9zdGF0ZSk7Cj4gPiArCXN0YXRlID0g
ZmV0Y2hfYW5kX3plcm8oJmk5MTUtPm1vZGVzZXRfcmVzdG9yZV9zdGF0ZSk7Cj4gPiAgIAlpZiAo
IXN0YXRlKQo+ID4gICAJCWdvdG8gdW5sb2NrOwo+ID4gICAJLyogcmVzZXQgZG9lc24ndCB0b3Vj
aCB0aGUgZGlzcGxheSAqLwo+ID4gLQlpZiAoIWdwdV9yZXNldF9jbG9iYmVyc19kaXNwbGF5KGRl
dl9wcml2KSkgewo+ID4gKwlpZiAoIWdwdV9yZXNldF9jbG9iYmVyc19kaXNwbGF5KGk5MTUpKSB7
Cj4gPiAgIAkJLyogZm9yIHRlc3Rpbmcgb25seSByZXN0b3JlIHRoZSBkaXNwbGF5ICovCj4gPiAg
IAkJcmV0ID0gX19pbnRlbF9kaXNwbGF5X3Jlc3VtZShkZXYsIHN0YXRlLCBjdHgpOwo+ID4gICAJ
CWlmIChyZXQpCj4gPiBAQCAtNDMxNiwyMCArNDMxNiwyMCBAQCB2b2lkIGludGVsX2ZpbmlzaF9y
ZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICogVGhlIGRp
c3BsYXkgaGFzIGJlZW4gcmVzZXQgYXMgd2VsbCwKPiA+ICAgCQkgKiBzbyBuZWVkIGEgZnVsbCBy
ZS1pbml0aWFsaXphdGlvbi4KPiA+ICAgCQkgKi8KPiA+IC0JCWludGVsX3Bwc191bmxvY2tfcmVn
c193YShkZXZfcHJpdik7Cj4gPiArCQlpbnRlbF9wcHNfdW5sb2NrX3JlZ3Nfd2EoaTkxNSk7Cj4g
PiAgIAkJaW50ZWxfbW9kZXNldF9pbml0X2h3KGRldik7Cj4gPiAtCQlpbnRlbF9pbml0X2Nsb2Nr
X2dhdGluZyhkZXZfcHJpdik7Cj4gPiArCQlpbnRlbF9pbml0X2Nsb2NrX2dhdGluZyhpOTE1KTsK
PiA+IC0JCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAtCQlpZiAoZGV2
X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCkKPiA+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5o
cGRfaXJxX3NldHVwKGRldl9wcml2KTsKPiA+IC0JCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYt
PmlycV9sb2NrKTsKPiA+ICsJCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICsJ
CWlmIChpOTE1LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXApCj4gPiArCQkJaTkxNS0+ZGlzcGxheS5o
cGRfaXJxX3NldHVwKGk5MTUpOwo+ID4gKwkJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9j
ayk7Cj4gPiAgIAkJcmV0ID0gX19pbnRlbF9kaXNwbGF5X3Jlc3VtZShkZXYsIHN0YXRlLCBjdHgp
Owo+ID4gICAJCWlmIChyZXQpCj4gPiAgIAkJCURSTV9FUlJPUigiUmVzdG9yaW5nIG9sZCBzdGF0
ZSBmYWlsZWQgd2l0aCAlaVxuIiwgcmV0KTsKPiA+IC0JCWludGVsX2hwZF9pbml0KGRldl9wcml2
KTsKPiA+ICsJCWludGVsX2hwZF9pbml0KGk5MTUpOwo+ID4gICAJfQo+ID4gICAJZHJtX2F0b21p
Y19zdGF0ZV9wdXQoc3RhdGUpOwo+ID4gQEAgLTQzMzgsMTIgKzQzMzgsMTIgQEAgdm9pZCBpbnRl
bF9maW5pc2hfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJ
ZHJtX21vZGVzZXRfYWNxdWlyZV9maW5pKGN0eCk7Cj4gPiAgIAltdXRleF91bmxvY2soJmRldi0+
bW9kZV9jb25maWcubXV0ZXgpOwo+ID4gLQljbGVhcl9iaXQoSTkxNV9SRVNFVF9NT0RFU0VULCAm
ZGV2X3ByaXYtPmdwdV9lcnJvci5mbGFncyk7Cj4gPiArCWNsZWFyX2JpdChJOTE1X1JFU0VUX01P
REVTRVQsICZpOTE1LT5ncHVfZXJyb3IuZmxhZ3MpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lk
IGljbF9zZXRfcGlwZV9jaGlja2VuKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFz
ZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJ
dTMyIHRtcDsKPiA+IEBAIC00MzY5LDcgKzQzNjksNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF91cGRh
dGVfcGlwZV9jb25maWcoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0
YQo+ID4gICAJCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNf
c3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAkv
KiBkcm1fYXRvbWljX2hlbHBlcl91cGRhdGVfbGVnYWN5X21vZGVzZXRfc3RhdGUgbWlnaHQgbm90
IGJlIGNhbGxlZC4gKi8KPiA+ICAgCWNydGMtPmJhc2UubW9kZSA9IG5ld19jcnRjX3N0YXRlLT5i
YXNlLm1vZGU7Cj4gPiBAQCAtNDM4OCwyNiArNDM4OCwyNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF91
cGRhdGVfcGlwZV9jb25maWcoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRj
X3N0YQo+ID4gICAJCSAgIChuZXdfY3J0Y19zdGF0ZS0+cGlwZV9zcmNfaCAtIDEpKTsKPiA+ICAg
CS8qIG9uIHNreWxha2UgdGhpcyBpcyBkb25lIGJ5IGRldGFjaGluZyBzY2FsZXJzICovCj4gPiAt
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSA5KSB7Cj4gPiAgIAkJc2tsX2RldGFjaF9zY2FsZXJzKG5ld19jcnRjX3N0YXRlKTsKPiA+
ICAgCQlpZiAobmV3X2NydGNfc3RhdGUtPnBjaF9wZml0LmVuYWJsZWQpCj4gPiAgIAkJCXNreWxh
a2VfcGZpdF9lbmFibGUobmV3X2NydGNfc3RhdGUpOwo+ID4gLQl9IGVsc2UgaWYgKEhBU19QQ0hf
U1BMSVQoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkg
ewo+ID4gICAJCWlmIChuZXdfY3J0Y19zdGF0ZS0+cGNoX3BmaXQuZW5hYmxlZCkKPiA+ICAgCQkJ
aXJvbmxha2VfcGZpdF9lbmFibGUobmV3X2NydGNfc3RhdGUpOwo+ID4gICAJCWVsc2UgaWYgKG9s
ZF9jcnRjX3N0YXRlLT5wY2hfcGZpdC5lbmFibGVkKQo+ID4gICAJCQlpcm9ubGFrZV9wZml0X2Rp
c2FibGUob2xkX2NydGNfc3RhdGUpOwo+ID4gICAJfQo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSAxMSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICAgCQlpY2xf
c2V0X3BpcGVfY2hpY2tlbihjcnRjKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9m
ZGlfbm9ybWFsX3RyYWluKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ID4gICB7Cj4gPiAgIAlz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlpbnQgcGlwZSA9IGNydGMt
PnBpcGU7Cj4gPiAgIAlpOTE1X3JlZ190IHJlZzsKPiA+ICAgCXUzMiB0ZW1wOwo+ID4gQEAgLTQ0
MTUsNyArNDQxNSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2ZkaV9ub3JtYWxfdHJhaW4oc3RydWN0
IGludGVsX2NydGMgKmNydGMpCj4gPiAgIAkvKiBlbmFibGUgbm9ybWFsIHRyYWluICovCj4gPiAg
IAlyZWcgPSBGRElfVFhfQ1RMKHBpcGUpOwo+ID4gICAJdGVtcCA9IEk5MTVfUkVBRChyZWcpOwo+
ID4gLQlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfSVZZQlJJREdF
KGk5MTUpKSB7Cj4gPiAgIAkJdGVtcCAmPSB+RkRJX0xJTktfVFJBSU5fTk9ORV9JVkI7Cj4gPiAg
IAkJdGVtcCB8PSBGRElfTElOS19UUkFJTl9OT05FX0lWQiB8IEZESV9UWF9FTkhBTkNFX0ZSQU1F
X0VOQUJMRTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiBAQCAtNDQyNiw3ICs0NDI2LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfZmRpX25vcm1hbF90cmFpbihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiA+
ICAgCXJlZyA9IEZESV9SWF9DVEwocGlwZSk7Cj4gPiAgIAl0ZW1wID0gSTkxNV9SRUFEKHJlZyk7
Cj4gPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19QQ0hfQ1BU
KGk5MTUpKSB7Cj4gPiAgIAkJdGVtcCAmPSB+RkRJX0xJTktfVFJBSU5fUEFUVEVSTl9NQVNLX0NQ
VDsKPiA+ICAgCQl0ZW1wIHw9IEZESV9MSU5LX1RSQUlOX05PUk1BTF9DUFQ7Cj4gPiAgIAl9IGVs
c2Ugewo+ID4gQEAgLTQ0NDAsNyArNDQ0MCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2ZkaV9ub3Jt
YWxfdHJhaW4oc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIAl1ZGVsYXkoMTAwMCk7Cj4g
PiAgIAkvKiBJVkIgd2FudHMgZXJyb3IgY29ycmVjdGlvbiBlbmFibGVkICovCj4gPiAtCWlmIChJ
U19JVllCUklER0UoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfSVZZQlJJREdFKGk5MTUpKQo+ID4g
ICAJCUk5MTVfV1JJVEUocmVnLCBJOTE1X1JFQUQocmVnKSB8IEZESV9GU19FUlJDX0VOQUJMRSB8
Cj4gPiAgIAkJCSAgIEZESV9GRV9FUlJDX0VOQUJMRSk7Cj4gPiAgIH0KPiA+IEBAIC00NDUwLDEz
ICs0NDUwLDEzIEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2ZkaV9saW5rX3RyYWluKHN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0g
Y3J0Yy0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRldik7Cj4gPiAgIAlpbnQgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAlpOTE1X3JlZ190
IHJlZzsKPiA+ICAgCXUzMiB0ZW1wLCB0cmllczsKPiA+ICAgCS8qIEZESSBuZWVkcyBiaXRzIGZy
b20gcGlwZSBmaXJzdCAqLwo+ID4gLQlhc3NlcnRfcGlwZV9lbmFibGVkKGRldl9wcml2LCBwaXBl
KTsKPiA+ICsJYXNzZXJ0X3BpcGVfZW5hYmxlZChpOTE1LCBwaXBlKTsKPiA+ICAgCS8qIFRyYWlu
IDE6IHVtYXNrIEZESSBSWCBJbnRlcnJ1cHQgc3ltYm9sX2xvY2sgYW5kIGJpdF9sb2NrIGJpdAo+
ID4gICAJICAgZm9yIHRyYWluIHJlc3VsdCAqLwo+ID4gQEAgLTQ1NTEsNyArNDU1MSw3IEBAIHN0
YXRpYyB2b2lkIGdlbjZfZmRpX2xpbmtfdHJhaW4oc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4g
PiAgIAkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAg
ewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJaW50IHBp
cGUgPSBjcnRjLT5waXBlOwo+ID4gICAJaTkxNV9yZWdfdCByZWc7Cj4gPiAgIAl1MzIgdGVtcCwg
aSwgcmV0cnk7Cj4gPiBAQCAtNDU4NCw3ICs0NTg0LDcgQEAgc3RhdGljIHZvaWQgZ2VuNl9mZGlf
bGlua190cmFpbihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCXJlZyA9IEZESV9SWF9D
VEwocGlwZSk7Cj4gPiAgIAl0ZW1wID0gSTkxNV9SRUFEKHJlZyk7Cj4gPiAtCWlmIChIQVNfUENI
X0NQVChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19QQ0hfQ1BUKGk5MTUpKSB7Cj4gPiAgIAkJ
dGVtcCAmPSB+RkRJX0xJTktfVFJBSU5fUEFUVEVSTl9NQVNLX0NQVDsKPiA+ICAgCQl0ZW1wIHw9
IEZESV9MSU5LX1RSQUlOX1BBVFRFUk5fMV9DUFQ7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gQEAgLTQ2
MjgsNyArNDYyOCw3IEBAIHN0YXRpYyB2b2lkIGdlbjZfZmRpX2xpbmtfdHJhaW4oc3RydWN0IGlu
dGVsX2NydGMgKmNydGMsCj4gPiAgIAl0ZW1wID0gSTkxNV9SRUFEKHJlZyk7Cj4gPiAgIAl0ZW1w
ICY9IH5GRElfTElOS19UUkFJTl9OT05FOwo+ID4gICAJdGVtcCB8PSBGRElfTElOS19UUkFJTl9Q
QVRURVJOXzI7Cj4gPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDYpKSB7Cj4gPiArCWlmIChJU19H
RU4oaTkxNSwgNikpIHsKPiA+ICAgCQl0ZW1wICY9IH5GRElfTElOS19UUkFJTl9WT0xfRU1QX01B
U0s7Cj4gPiAgIAkJLyogU05CLUIgKi8KPiA+ICAgCQl0ZW1wIHw9IEZESV9MSU5LX1RSQUlOXzQw
ME1WXzBEQl9TTkJfQjsKPiA+IEBAIC00NjM3LDcgKzQ2MzcsNyBAQCBzdGF0aWMgdm9pZCBnZW42
X2ZkaV9saW5rX3RyYWluKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJcmVnID0gRkRJ
X1JYX0NUTChwaXBlKTsKPiA+ICAgCXRlbXAgPSBJOTE1X1JFQUQocmVnKTsKPiA+IC0JaWYgKEhB
U19QQ0hfQ1BUKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX1BDSF9DUFQoaTkxNSkpIHsKPiA+
ICAgCQl0ZW1wICY9IH5GRElfTElOS19UUkFJTl9QQVRURVJOX01BU0tfQ1BUOwo+ID4gICAJCXRl
bXAgfD0gRkRJX0xJTktfVFJBSU5fUEFUVEVSTl8yX0NQVDsKPiA+ICAgCX0gZWxzZSB7Cj4gPiBA
QCAtNDY4NCw3ICs0Njg0LDcgQEAgc3RhdGljIHZvaWQgaXZiX21hbnVhbF9mZGlfbGlua190cmFp
bihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJCSAgICAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlpbnQgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAg
IAlpOTE1X3JlZ190IHJlZzsKPiA+ICAgCXUzMiB0ZW1wLCBpLCBqOwo+ID4gQEAgLTQ4MDIsNyAr
NDgwMiw3IEBAIHN0YXRpYyB2b2lkIGl2Yl9tYW51YWxfZmRpX2xpbmtfdHJhaW4oc3RydWN0IGlu
dGVsX2NydGMgKmNydGMsCj4gPiAgIHN0YXRpYyB2b2lkIGlyb25sYWtlX2ZkaV9wbGxfZW5hYmxl
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShpbnRlbF9jcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShpbnRlbF9jcnRjLT5iYXNlLmRldik7Cj4gPiAgIAlpbnQgcGlw
ZSA9IGludGVsX2NydGMtPnBpcGU7Cj4gPiAgIAlpOTE1X3JlZ190IHJlZzsKPiA+ICAgCXUzMiB0
ZW1wOwo+ID4gQEAgLTQ4MzksNyArNDgzOSw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2ZkaV9w
bGxfZW5hYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4g
ICBzdGF0aWMgdm9pZCBpcm9ubGFrZV9mZGlfcGxsX2Rpc2FibGUoc3RydWN0IGludGVsX2NydGMg
KmludGVsX2NydGMpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBpbnRl
bF9jcnRjLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZGV2KTsKPiA+ICAgCWludCBwaXBlID0gaW50ZWxfY3J0Yy0+cGlwZTsKPiA+ICAgCWk5
MTVfcmVnX3QgcmVnOwo+ID4gICAJdTMyIHRlbXA7Cj4gPiBAQCAtNDg2OSw3ICs0ODY5LDcgQEAg
c3RhdGljIHZvaWQgaXJvbmxha2VfZmRpX3BsbF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9jcnRjICpp
bnRlbF9jcnRjKQo+ID4gICBzdGF0aWMgdm9pZCBpcm9ubGFrZV9mZGlfZGlzYWJsZShzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGMpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBj
cnRjLT5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRl
dik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Yyk7Cj4gPiAgIAlpbnQgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7Cj4gPiAgIAlpOTE1X3Jl
Z190IHJlZzsKPiA+IEBAIC00ODkxLDcgKzQ4OTEsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9m
ZGlfZGlzYWJsZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCj4gPiAgIAl1ZGVsYXkoMTAwKTsKPiA+
ICAgCS8qIElyb25sYWtlIHdvcmthcm91bmQsIGRpc2FibGUgY2xvY2sgcG9pbnRlciBhZnRlciBk
b3duaW5nIEZESSAqLwo+ID4gLQlpZiAoSEFTX1BDSF9JQlgoZGV2X3ByaXYpKQo+ID4gKwlpZiAo
SEFTX1BDSF9JQlgoaTkxNSkpCj4gPiAgIAkJSTkxNV9XUklURShGRElfUlhfQ0hJQ0tFTihwaXBl
KSwgRkRJX1JYX1BIQVNFX1NZTkNfUE9JTlRFUl9PVlIpOwo+ID4gICAJLyogc3RpbGwgc2V0IHRy
YWluIHBhdHRlcm4gMSAqLwo+ID4gQEAgLTQ5MDMsNyArNDkwMyw3IEBAIHN0YXRpYyB2b2lkIGly
b25sYWtlX2ZkaV9kaXNhYmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKPiA+ICAgCXJlZyA9IEZE
SV9SWF9DVEwocGlwZSk7Cj4gPiAgIAl0ZW1wID0gSTkxNV9SRUFEKHJlZyk7Cj4gPiAtCWlmIChI
QVNfUENIX0NQVChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19QQ0hfQ1BUKGk5MTUpKSB7Cj4g
PiAgIAkJdGVtcCAmPSB+RkRJX0xJTktfVFJBSU5fUEFUVEVSTl9NQVNLX0NQVDsKPiA+ICAgCQl0
ZW1wIHw9IEZESV9MSU5LX1RSQUlOX1BBVFRFUk5fMV9DUFQ7Cj4gPiAgIAl9IGVsc2Ugewo+ID4g
QEAgLTQ5MTksMTIgKzQ5MTksMTIgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfZmRpX2Rpc2FibGUo
c3RydWN0IGRybV9jcnRjICpjcnRjKQo+ID4gICAJdWRlbGF5KDEwMCk7Cj4gPiAgIH0KPiA+IC1i
b29sIGludGVsX2hhc19wZW5kaW5nX2ZiX3VucGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtib29sIGludGVsX2hhc19wZW5kaW5nX2ZiX3VucGluKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGM7
Cj4gPiAgIAlib29sIGNsZWFudXBfZG9uZTsKPiA+IC0JZHJtX2Zvcl9lYWNoX2NydGMoY3J0Yywg
JmRldl9wcml2LT5kcm0pIHsKPiA+ICsJZHJtX2Zvcl9lYWNoX2NydGMoY3J0YywgJmk5MTUtPmRy
bSkgewo+ID4gICAJCXN0cnVjdCBkcm1fY3J0Y19jb21taXQgKmNvbW1pdDsKPiA+ICAgCQlzcGlu
X2xvY2soJmNydGMtPmNvbW1pdF9sb2NrKTsKPiA+ICAgCQljb21taXQgPSBsaXN0X2ZpcnN0X2Vu
dHJ5X29yX251bGwoJmNydGMtPmNvbW1pdF9saXN0LAo+ID4gQEAgLTQ5NDQsMzEgKzQ5NDQsMzEg
QEAgYm9vbCBpbnRlbF9oYXNfcGVuZGluZ19mYl91bnBpbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiAgIAlyZXR1cm4gZmFsc2U7Cj4gPiAgIH0KPiA+IC12b2lkIGxwdF9k
aXNhYmxlX2ljbGtpcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9p
ZCBscHRfZGlzYWJsZV9pY2xraXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAg
IHsKPiA+ICAgCXUzMiB0ZW1wOwo+ID4gICAJSTkxNV9XUklURShQSVhDTEtfR0FURSwgUElYQ0xL
X0dBVEVfR0FURSk7Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5zYl9sb2NrKTsKPiA+ICsJ
bXV0ZXhfbG9jaygmaTkxNS0+c2JfbG9jayk7Cj4gPiAtCXRlbXAgPSBpbnRlbF9zYmlfcmVhZChk
ZXZfcHJpdiwgU0JJX1NTQ0NUTDYsIFNCSV9JQ0xLKTsKPiA+ICsJdGVtcCA9IGludGVsX3NiaV9y
ZWFkKGk5MTUsIFNCSV9TU0NDVEw2LCBTQklfSUNMSyk7Cj4gPiAgIAl0ZW1wIHw9IFNCSV9TU0ND
VExfRElTQUJMRTsKPiA+IC0JaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCBTQklfU1NDQ1RMNiwg
dGVtcCwgU0JJX0lDTEspOwo+ID4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgU0JJX1NTQ0NUTDYs
IHRlbXAsIFNCSV9JQ0xLKTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+c2JfbG9jayk7
Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+c2JfbG9jayk7Cj4gPiAgIH0KPiA+ICAgLyogUHJv
Z3JhbSBpQ0xLSVAgY2xvY2sgdG8gdGhlIGRlc2lyZWQgZnJlcXVlbmN5ICovCj4gPiAgIHN0YXRp
YyB2b2lkIGxwdF9wcm9ncmFtX2ljbGtpcChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJ
aW50IGNsb2NrID0gY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7Cj4g
PiAgIAl1MzIgZGl2c2VsLCBwaGFzZWluYywgYXV4ZGl2LCBwaGFzZWRpciA9IDA7Cj4gPiAgIAl1
MzIgdGVtcDsKPiA+IC0JbHB0X2Rpc2FibGVfaWNsa2lwKGRldl9wcml2KTsKPiA+ICsJbHB0X2Rp
c2FibGVfaWNsa2lwKGk5MTUpOwo+ID4gICAJLyogVGhlIGlDTEsgdmlydHVhbCBjbG9jayByb290
IGZyZXF1ZW5jeSBpcyBpbiBNSHosCj4gPiAgIAkgKiBidXQgdGhlIGFkanVzdGVkX21vZGUtPmNy
dGNfY2xvY2sgaW4gaW4gS0h6LiBUbyBnZXQgdGhlCj4gPiBAQCAtNTAwNywzMCArNTAwNywzMCBA
QCBzdGF0aWMgdm9pZCBscHRfcHJvZ3JhbV9pY2xraXAoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIAkJCXBoYXNlZGlyLAo+ID4gICAJCQlwaGFzZWluYyk7
Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5zYl9sb2NrKTsKPiA+ICsJbXV0ZXhfbG9jaygm
aTkxNS0+c2JfbG9jayk7Cj4gPiAgIAkvKiBQcm9ncmFtIFNTQ0RJVklOVFBIQVNFNiAqLwo+ID4g
LQl0ZW1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIFNCSV9TU0NESVZJTlRQSEFTRTYsIFNC
SV9JQ0xLKTsKPiA+ICsJdGVtcCA9IGludGVsX3NiaV9yZWFkKGk5MTUsIFNCSV9TU0NESVZJTlRQ
SEFTRTYsIFNCSV9JQ0xLKTsKPiA+ICAgCXRlbXAgJj0gflNCSV9TU0NESVZJTlRQSEFTRV9ESVZT
RUxfTUFTSzsKPiA+ICAgCXRlbXAgfD0gU0JJX1NTQ0RJVklOVFBIQVNFX0RJVlNFTChkaXZzZWwp
Owo+ID4gICAJdGVtcCAmPSB+U0JJX1NTQ0RJVklOVFBIQVNFX0lOQ1ZBTF9NQVNLOwo+ID4gICAJ
dGVtcCB8PSBTQklfU1NDRElWSU5UUEhBU0VfSU5DVkFMKHBoYXNlaW5jKTsKPiA+ICAgCXRlbXAg
fD0gU0JJX1NTQ0RJVklOVFBIQVNFX0RJUihwaGFzZWRpcik7Cj4gPiAgIAl0ZW1wIHw9IFNCSV9T
U0NESVZJTlRQSEFTRV9QUk9QQUdBVEU7Cj4gPiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJpdiwg
U0JJX1NTQ0RJVklOVFBIQVNFNiwgdGVtcCwgU0JJX0lDTEspOwo+ID4gKwlpbnRlbF9zYmlfd3Jp
dGUoaTkxNSwgU0JJX1NTQ0RJVklOVFBIQVNFNiwgdGVtcCwgU0JJX0lDTEspOwo+ID4gICAJLyog
UHJvZ3JhbSBTU0NBVVhESVYgKi8KPiA+IC0JdGVtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2
LCBTQklfU1NDQVVYRElWNiwgU0JJX0lDTEspOwo+ID4gKwl0ZW1wID0gaW50ZWxfc2JpX3JlYWQo
aTkxNSwgU0JJX1NTQ0FVWERJVjYsIFNCSV9JQ0xLKTsKPiA+ICAgCXRlbXAgJj0gflNCSV9TU0NB
VVhESVZfRklOQUxESVYyU0VMKDEpOwo+ID4gICAJdGVtcCB8PSBTQklfU1NDQVVYRElWX0ZJTkFM
RElWMlNFTChhdXhkaXYpOwo+ID4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIFNCSV9TU0NB
VVhESVY2LCB0ZW1wLCBTQklfSUNMSyk7Cj4gPiArCWludGVsX3NiaV93cml0ZShpOTE1LCBTQklf
U1NDQVVYRElWNiwgdGVtcCwgU0JJX0lDTEspOwo+ID4gICAJLyogRW5hYmxlIG1vZHVsYXRvciBh
bmQgYXNzb2NpYXRlZCBkaXZpZGVyICovCj4gPiAtCXRlbXAgPSBpbnRlbF9zYmlfcmVhZChkZXZf
cHJpdiwgU0JJX1NTQ0NUTDYsIFNCSV9JQ0xLKTsKPiA+ICsJdGVtcCA9IGludGVsX3NiaV9yZWFk
KGk5MTUsIFNCSV9TU0NDVEw2LCBTQklfSUNMSyk7Cj4gPiAgIAl0ZW1wICY9IH5TQklfU1NDQ1RM
X0RJU0FCTEU7Cj4gPiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJpdiwgU0JJX1NTQ0NUTDYsIHRl
bXAsIFNCSV9JQ0xLKTsKPiA+ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIFNCSV9TU0NDVEw2LCB0
ZW1wLCBTQklfSUNMSyk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnNiX2xvY2spOwo+
ID4gKwltdXRleF91bmxvY2soJmk5MTUtPnNiX2xvY2spOwo+ID4gICAJLyogV2FpdCBmb3IgaW5p
dGlhbGl6YXRpb24gdGltZSAqLwo+ID4gICAJdWRlbGF5KDI0KTsKPiA+IEBAIC01MDM4LDcgKzUw
MzgsNyBAQCBzdGF0aWMgdm9pZCBscHRfcHJvZ3JhbV9pY2xraXAoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIAlJOTE1X1dSSVRFKFBJWENMS19HQVRFLCBQ
SVhDTEtfR0FURV9VTkdBVEUpOwo+ID4gICB9Cj4gPiAtaW50IGxwdF9nZXRfaWNsa2lwKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQgbHB0X2dldF9pY2xraXAoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiBkaXZzZWwsIHBo
YXNlaW5jLCBhdXhkaXY7Cj4gPiAgIAl1MzIgaWNsa192aXJ0dWFsX3Jvb3RfZnJlcSA9IDE3Mjgw
MCAqIDEwMDA7Cj4gPiBAQCAtNTA0OSwyNSArNTA0OSwyNSBAQCBpbnQgbHB0X2dldF9pY2xraXAo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJaWYgKChJOTE1X1JFQUQo
UElYQ0xLX0dBVEUpICYgUElYQ0xLX0dBVEVfVU5HQVRFKSA9PSAwKQo+ID4gICAJCXJldHVybiAw
Owo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+c2JfbG9jayk7Cj4gPiArCW11dGV4X2xvY2so
Jmk5MTUtPnNiX2xvY2spOwo+ID4gLQl0ZW1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIFNC
SV9TU0NDVEw2LCBTQklfSUNMSyk7Cj4gPiArCXRlbXAgPSBpbnRlbF9zYmlfcmVhZChpOTE1LCBT
QklfU1NDQ1RMNiwgU0JJX0lDTEspOwo+ID4gICAJaWYgKHRlbXAgJiBTQklfU1NDQ1RMX0RJU0FC
TEUpIHsKPiA+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnNiX2xvY2spOwo+ID4gKwkJbXV0
ZXhfdW5sb2NrKCZpOTE1LT5zYl9sb2NrKTsKPiA+ICAgCQlyZXR1cm4gMDsKPiA+ICAgCX0KPiA+
IC0JdGVtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCBTQklfU1NDRElWSU5UUEhBU0U2LCBT
QklfSUNMSyk7Cj4gPiArCXRlbXAgPSBpbnRlbF9zYmlfcmVhZChpOTE1LCBTQklfU1NDRElWSU5U
UEhBU0U2LCBTQklfSUNMSyk7Cj4gPiAgIAlkaXZzZWwgPSAodGVtcCAmIFNCSV9TU0NESVZJTlRQ
SEFTRV9ESVZTRUxfTUFTSykgPj4KPiA+ICAgCQlTQklfU1NDRElWSU5UUEhBU0VfRElWU0VMX1NI
SUZUOwo+ID4gICAJcGhhc2VpbmMgPSAodGVtcCAmIFNCSV9TU0NESVZJTlRQSEFTRV9JTkNWQUxf
TUFTSykgPj4KPiA+ICAgCQlTQklfU1NDRElWSU5UUEhBU0VfSU5DVkFMX1NISUZUOwo+ID4gLQl0
ZW1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIFNCSV9TU0NBVVhESVY2LCBTQklfSUNMSyk7
Cj4gPiArCXRlbXAgPSBpbnRlbF9zYmlfcmVhZChpOTE1LCBTQklfU1NDQVVYRElWNiwgU0JJX0lD
TEspOwo+ID4gICAJYXV4ZGl2ID0gKHRlbXAgJiBTQklfU1NDQVVYRElWX0ZJTkFMRElWMlNFTF9N
QVNLKSA+Pgo+ID4gICAJCVNCSV9TU0NBVVhESVZfRklOQUxESVYyU0VMX1NISUZUOwo+ID4gLQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5zYl9sb2NrKTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1
LT5zYl9sb2NrKTsKPiA+ICAgCWRlc2lyZWRfZGl2aXNvciA9IChkaXZzZWwgKyAyKSAqIGljbGtf
cGlfcmFuZ2UgKyBwaGFzZWluYzsKPiA+IEBAIC01MDc5LDcgKzUwNzksNyBAQCBzdGF0aWMgdm9p
ZCBpcm9ubGFrZV9wY2hfdHJhbnNjb2Rlcl9zZXRfdGltaW5ncyhjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqYwo+ID4gICAJCQkJCQllbnVtIHBpcGUgcGNoX3RyYW5zY29kZXIpCj4gPiAg
IHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gdHJhbnNjb2RlciBj
cHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+ID4gICAJSTkxNV9X
UklURShQQ0hfVFJBTlNfSFRPVEFMKHBjaF90cmFuc2NvZGVyKSwKPiA+IEBAIC01MDk5LDcgKzUw
OTksNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9wY2hfdHJhbnNjb2Rlcl9zZXRfdGltaW5ncyhj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqYwo+ID4gICAJCSAgIEk5MTVfUkVBRChWU1lO
Q1NISUZUKGNwdV90cmFuc2NvZGVyKSkpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgY3B0X3Nl
dF9mZGlfYmNfYmlmdXJjYXRpb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBi
b29sIGVuYWJsZSkKPiA+ICtzdGF0aWMgdm9pZCBjcHRfc2V0X2ZkaV9iY19iaWZ1cmNhdGlvbihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgYm9vbCBlbmFibGUpCj4gPiAgIHsKPiA+ICAg
CXUzMiB0ZW1wOwo+ID4gQEAgLTUxMjIsMjAgKzUxMjIsMjAgQEAgc3RhdGljIHZvaWQgY3B0X3Nl
dF9mZGlfYmNfYmlmdXJjYXRpb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBi
b29sIGUKPiA+ICAgc3RhdGljIHZvaWQgaXZ5YnJpZGdlX3VwZGF0ZV9mZGlfYmNfYmlmdXJjYXRp
b24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCXN3aXRjaCAoY3J0Yy0+cGlwZSkgewo+
ID4gICAJY2FzZSBQSVBFX0E6Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIFBJUEVfQjoKPiA+
ICAgCQlpZiAoY3J0Y19zdGF0ZS0+ZmRpX2xhbmVzID4gMikKPiA+IC0JCQljcHRfc2V0X2ZkaV9i
Y19iaWZ1cmNhdGlvbihkZXZfcHJpdiwgZmFsc2UpOwo+ID4gKwkJCWNwdF9zZXRfZmRpX2JjX2Jp
ZnVyY2F0aW9uKGk5MTUsIGZhbHNlKTsKPiA+ICAgCQllbHNlCj4gPiAtCQkJY3B0X3NldF9mZGlf
YmNfYmlmdXJjYXRpb24oZGV2X3ByaXYsIHRydWUpOwo+ID4gKwkJCWNwdF9zZXRfZmRpX2JjX2Jp
ZnVyY2F0aW9uKGk5MTUsIHRydWUpOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSBQSVBFX0M6
Cj4gPiAtCQljcHRfc2V0X2ZkaV9iY19iaWZ1cmNhdGlvbihkZXZfcHJpdiwgdHJ1ZSk7Cj4gPiAr
CQljcHRfc2V0X2ZkaV9iY19iaWZ1cmNhdGlvbihpOTE1LCB0cnVlKTsKPiA+ICAgCQlicmVhazsK
PiA+ICAgCWRlZmF1bHQ6Cj4gPiBAQCAtNTE4NSwxMyArNTE4NSwxMyBAQCBzdGF0aWMgdm9pZCBp
cm9ubGFrZV9wY2hfZW5hYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
LAo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBj
cnRjLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZGV2KTsKPiA+ICAgCWludCBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+ICAgCXUzMiB0ZW1wOwo+
ID4gLQlhc3NlcnRfcGNoX3RyYW5zY29kZXJfZGlzYWJsZWQoZGV2X3ByaXYsIHBpcGUpOwo+ID4g
Kwlhc3NlcnRfcGNoX3RyYW5zY29kZXJfZGlzYWJsZWQoaTkxNSwgcGlwZSk7Cj4gPiAtCWlmIChJ
U19JVllCUklER0UoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfSVZZQlJJREdFKGk5MTUpKQo+ID4g
ICAJCWl2eWJyaWRnZV91cGRhdGVfZmRpX2JjX2JpZnVyY2F0aW9uKGNydGNfc3RhdGUpOwo+ID4g
ICAJLyogV3JpdGUgdGhlIFRVIHNpemUgYml0cyBiZWZvcmUgZmRpIGxpbmsgdHJhaW5pbmcsIHNv
IHRoYXQgZXJyb3IKPiA+IEBAIC01MjAwLDE4ICs1MjAwLDE4IEBAIHN0YXRpYyB2b2lkIGlyb25s
YWtlX3BjaF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4g
PiAgIAkJICAgSTkxNV9SRUFEKFBJUEVfREFUQV9NMShwaXBlKSkgJiBUVV9TSVpFX01BU0spOwo+
ID4gICAJLyogRm9yIFBDSCBvdXRwdXQsIHRyYWluaW5nIEZESSBsaW5rICovCj4gPiAtCWRldl9w
cml2LT5kaXNwbGF5LmZkaV9saW5rX3RyYWluKGNydGMsIGNydGNfc3RhdGUpOwo+ID4gKwlpOTE1
LT5kaXNwbGF5LmZkaV9saW5rX3RyYWluKGNydGMsIGNydGNfc3RhdGUpOwo+ID4gICAJLyogV2Ug
bmVlZCB0byBwcm9ncmFtIHRoZSByaWdodCBjbG9jayBzZWxlY3Rpb24gYmVmb3JlIHdyaXRpbmcg
dGhlIHBpeGVsCj4gPiAgIAkgKiBtdXRsaXBsaWVyIGludG8gdGhlIERQTEwuICovCj4gPiAtCWlm
IChIQVNfUENIX0NQVChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19QQ0hfQ1BUKGk5MTUpKSB7
Cj4gPiAgIAkJdTMyIHNlbDsKPiA+ICAgCQl0ZW1wID0gSTkxNV9SRUFEKFBDSF9EUExMX1NFTCk7
Cj4gPiAgIAkJdGVtcCB8PSBUUkFOU19EUExMX0VOQUJMRShwaXBlKTsKPiA+ICAgCQlzZWwgPSBU
UkFOU19EUExMQl9TRUwocGlwZSk7Cj4gPiAgIAkJaWYgKGNydGNfc3RhdGUtPnNoYXJlZF9kcGxs
ID09Cj4gPiAtCQkgICAgaW50ZWxfZ2V0X3NoYXJlZF9kcGxsX2J5X2lkKGRldl9wcml2LCBEUExM
X0lEX1BDSF9QTExfQikpCj4gPiArCQkgICAgaW50ZWxfZ2V0X3NoYXJlZF9kcGxsX2J5X2lkKGk5
MTUsIERQTExfSURfUENIX1BMTF9CKSkKPiA+ICAgCQkJdGVtcCB8PSBzZWw7Cj4gPiAgIAkJZWxz
ZQo+ID4gICAJCQl0ZW1wICY9IH5zZWw7Cj4gPiBAQCAtNTIyOCwxMyArNTIyOCwxMyBAQCBzdGF0
aWMgdm9pZCBpcm9ubGFrZV9wY2hfZW5hYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9hdG9taWNfc3Rh
dGUgKnN0YXRlLAo+ID4gICAJaW50ZWxfZW5hYmxlX3NoYXJlZF9kcGxsKGNydGNfc3RhdGUpOwo+
ID4gICAJLyogc2V0IHRyYW5zY29kZXIgdGltaW5nLCBwYW5lbCBtdXN0IGFsbG93IGl0ICovCj4g
PiAtCWFzc2VydF9wYW5lbF91bmxvY2tlZChkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCWFzc2VydF9w
YW5lbF91bmxvY2tlZChpOTE1LCBwaXBlKTsKPiA+ICAgCWlyb25sYWtlX3BjaF90cmFuc2NvZGVy
X3NldF90aW1pbmdzKGNydGNfc3RhdGUsIHBpcGUpOwo+ID4gICAJaW50ZWxfZmRpX25vcm1hbF90
cmFpbihjcnRjKTsKPiA+ICAgCS8qIEZvciBQQ0ggRFAsIGVuYWJsZSBUUkFOU19EUF9DVEwgKi8K
PiA+IC0JaWYgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSAmJgo+ID4gKwlpZiAoSEFTX1BDSF9DUFQo
aTkxNSkgJiYKPiA+ICAgCSAgICBpbnRlbF9jcnRjX2hhc19kcF9lbmNvZGVyKGNydGNfc3RhdGUp
KSB7Cj4gPiAgIAkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUg
PQo+ID4gICAJCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ID4gQEAgLTUyNjgs
MjIgKzUyNjgsMjIgQEAgc3RhdGljIHZvaWQgbHB0X3BjaF9lbmFibGUoY29uc3Qgc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gPiAgIAkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Cj4gPiAgIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5j
cHVfdHJhbnNjb2RlcjsKPiA+IC0JYXNzZXJ0X3BjaF90cmFuc2NvZGVyX2Rpc2FibGVkKGRldl9w
cml2LCBQSVBFX0EpOwo+ID4gKwlhc3NlcnRfcGNoX3RyYW5zY29kZXJfZGlzYWJsZWQoaTkxNSwg
UElQRV9BKTsKPiA+ICAgCWxwdF9wcm9ncmFtX2ljbGtpcChjcnRjX3N0YXRlKTsKPiA+ICAgCS8q
IFNldCB0cmFuc2NvZGVyIHRpbWluZy4gKi8KPiA+ICAgCWlyb25sYWtlX3BjaF90cmFuc2NvZGVy
X3NldF90aW1pbmdzKGNydGNfc3RhdGUsIFBJUEVfQSk7Cj4gPiAtCWxwdF9lbmFibGVfcGNoX3Ry
YW5zY29kZXIoZGV2X3ByaXYsIGNwdV90cmFuc2NvZGVyKTsKPiA+ICsJbHB0X2VuYWJsZV9wY2hf
dHJhbnNjb2RlcihpOTE1LCBjcHVfdHJhbnNjb2Rlcik7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZv
aWQgY3B0X3ZlcmlmeV9tb2Rlc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIGludCBwaXBlKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7
Cj4gPiAgIAlpOTE1X3JlZ190IGRzbHJlZyA9IFBJUEVEU0wocGlwZSk7Cj4gPiAgIAl1MzIgdGVt
cDsKPiA+IEBAIC01Mzg1LDcgKzUzODUsNyBAQCBza2xfdXBkYXRlX3NjYWxlcihzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwgYm9vbCBmb3JjZV9kZXRhY2gsCj4gPiAgIAkJJmNy
dGNfc3RhdGUtPnNjYWxlcl9zdGF0ZTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9j
cnRjID0KPiA+ICAgCQl0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoaW50ZWxfY3J0Yy0+
YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
aW50ZWxfY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKmFkanVzdGVkX21vZGUgPQo+ID4gICAJCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21v
ZGU7Cj4gPiBAQCAtNTQwMyw3ICs1NDAzLDcgQEAgc2tsX3VwZGF0ZV9zY2FsZXIoc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsIGJvb2wgZm9yY2VfZGV0YWNoLAo+ID4gICAJICog
T25jZSBOVjEyIGlzIGVuYWJsZWQsIGhhbmRsZSBpdCBoZXJlIHdoaWxlIGFsbG9jYXRpbmcgc2Nh
bGVyCj4gPiAgIAkgKiBmb3IgTlYxMi4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSA5ICYmIGNydGNfc3RhdGUtPmJhc2UuZW5hYmxlICYmCj4gPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gOSAmJiBjcnRjX3N0YXRlLT5iYXNlLmVuYWJsZSAmJgo+ID4gICAJICAg
IG5lZWRfc2NhbGVyICYmIGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19JTlRF
UkxBQ0UpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJQaXBlL1BsYW5lIHNjYWxpbmcgbm90IHN1
cHBvcnRlZCB3aXRoIElGLUlEIG1vZGVcbiIpOwo+ID4gICAJCXJldHVybiAtRUlOVkFMOwo+ID4g
QEAgLTU0NDIsMTAgKzU0NDIsMTAgQEAgc2tsX3VwZGF0ZV9zY2FsZXIoc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsIGJvb2wgZm9yY2VfZGV0YWNoLAo+ID4gICAJLyogcmFuZ2Ug
Y2hlY2tzICovCj4gPiAgIAlpZiAoc3JjX3cgPCBTS0xfTUlOX1NSQ19XIHx8IHNyY19oIDwgU0tM
X01JTl9TUkNfSCB8fAo+ID4gICAJICAgIGRzdF93IDwgU0tMX01JTl9EU1RfVyB8fCBkc3RfaCA8
IFNLTF9NSU5fRFNUX0ggfHwKPiA+IC0JICAgIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExICYm
Cj4gPiArCSAgICAoSU5URUxfR0VOKGk5MTUpID49IDExICYmCj4gPiAgIAkgICAgIChzcmNfdyA+
IElDTF9NQVhfU1JDX1cgfHwgc3JjX2ggPiBJQ0xfTUFYX1NSQ19IIHx8Cj4gPiAgIAkgICAgICBk
c3RfdyA+IElDTF9NQVhfRFNUX1cgfHwgZHN0X2ggPiBJQ0xfTUFYX0RTVF9IKSkgfHwKPiA+IC0J
ICAgIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEgJiYKPiA+ICsJICAgIChJTlRFTF9HRU4oaTkx
NSkgPCAxMSAmJgo+ID4gICAJICAgICAoc3JjX3cgPiBTS0xfTUFYX1NSQ19XIHx8IHNyY19oID4g
U0tMX01BWF9TUkNfSCB8fAo+ID4gICAJICAgICAgZHN0X3cgPiBTS0xfTUFYX0RTVF9XIHx8IGRz
dF9oID4gU0tMX01BWF9EU1RfSCkpKQl7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygic2NhbGVyX3Vz
ZXIgaW5kZXggJXUuJXU6IHNyYyAldXgldSBkc3QgJXV4JXUgIgo+ID4gQEAgLTU1MDIsMTQgKzU1
MDIsMTQgQEAgc3RhdGljIGludCBza2xfdXBkYXRlX3NjYWxlcl9wbGFuZShzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX3BsYW5l
ICppbnRlbF9wbGFuZSA9Cj4gPiAgIAkJdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2Uu
cGxhbmUpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGludGVsX3BsYW5lLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShpbnRlbF9wbGFuZS0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGRybV9m
cmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+YmFzZS5mYjsKPiA+ICAgCWludCByZXQ7Cj4g
PiAgIAlib29sIGZvcmNlX2RldGFjaCA9ICFmYiB8fCAhcGxhbmVfc3RhdGUtPmJhc2UudmlzaWJs
ZTsKPiA+ICAgCWJvb2wgbmVlZF9zY2FsZXIgPSBmYWxzZTsKPiA+ICAgCS8qIFByZS1nZW4xMSBh
bmQgU0RSIHBsYW5lcyBhbHdheXMgbmVlZCBhIHNjYWxlciBmb3IgcGxhbmFyIGZvcm1hdHMuICov
Cj4gPiAtCWlmICghaWNsX2lzX2hkcl9wbGFuZShkZXZfcHJpdiwgaW50ZWxfcGxhbmUtPmlkKSAm
Jgo+ID4gKwlpZiAoIWljbF9pc19oZHJfcGxhbmUoaTkxNSwgaW50ZWxfcGxhbmUtPmlkKSAmJgo+
ID4gICAJICAgIGZiICYmIGlzX3BsYW5hcl95dXZfZm9ybWF0KGZiLT5mb3JtYXQtPmZvcm1hdCkp
Cj4gPiAgIAkJbmVlZF9zY2FsZXIgPSB0cnVlOwo+ID4gQEAgLTU1ODIsNyArNTU4Miw3IEBAIHN0
YXRpYyB2b2lkIHNreWxha2Vfc2NhbGVyX2Rpc2FibGUoc3RydWN0IGludGVsX2NydGMgKmNydGMp
Cj4gPiAgIHN0YXRpYyB2b2lkIHNreWxha2VfcGZpdF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+ICAgCWNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3NjYWxlcl9zdGF0ZSAqc2NhbGVyX3N0YXRlID0KPiA+ICAgCQkmY3J0
Y19zdGF0ZS0+c2NhbGVyX3N0YXRlOwo+ID4gQEAgLTU2MTksNyArNTYxOSw3IEBAIHN0YXRpYyB2
b2lkIHNreWxha2VfcGZpdF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gPiAgIHN0YXRpYyB2b2lkIGlyb25sYWtlX3BmaXRfZW5hYmxlKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gPiAgIAlpbnQgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAlpZiAo
Y3J0Y19zdGF0ZS0+cGNoX3BmaXQuZW5hYmxlZCkgewo+ID4gQEAgLTU2MjcsNyArNTYyNyw3IEBA
IHN0YXRpYyB2b2lkIGlyb25sYWtlX3BmaXRfZW5hYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICAJCSAqIGFzIHNvbWUgcHJlLXByb2dyYW1tZWQgdmFs
dWVzIGFyZSBicm9rZW4sCj4gPiAgIAkJICogZS5nLiB4MjAxLgo+ID4gICAJCSAqLwo+ID4gLQkJ
aWYgKElTX0lWWUJSSURHRShkZXZfcHJpdikgfHwgSVNfSEFTV0VMTChkZXZfcHJpdikpCj4gPiAr
CQlpZiAoSVNfSVZZQlJJREdFKGk5MTUpIHx8IElTX0hBU1dFTEwoaTkxNSkpCj4gPiAgIAkJCUk5
MTVfV1JJVEUoUEZfQ1RMKHBpcGUpLCBQRl9FTkFCTEUgfCBQRl9GSUxURVJfTUVEXzN4MyB8Cj4g
PiAgIAkJCQkJCSBQRl9QSVBFX1NFTF9JVkIocGlwZSkpOwo+ID4gICAJCWVsc2UKPiA+IEBAIC01
NjQxLDcgKzU2NDEsNyBAQCB2b2lkIGhzd19lbmFibGVfaXBzKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCWlmICghY3J0Y19zdGF0ZS0+aXBz
X2VuYWJsZWQpCj4gPiAgIAkJcmV0dXJuOwo+ID4gQEAgLTU2NTMsOCArNTY1Myw4IEBAIHZvaWQg
aHN3X2VuYWJsZV9pcHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gPiAgIAkgKi8KPiA+ICAgCVdBUk5fT04oIShjcnRjX3N0YXRlLT5hY3RpdmVfcGxhbmVzICYg
fkJJVChQTEFORV9DVVJTT1IpKSk7Cj4gPiAtCWlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7
Cj4gPiAtCQlXQVJOX09OKHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGRldl9wcml2LCBESVNQTEFZ
X0lQU19DT05UUk9MLAo+ID4gKwlpZiAoSVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gPiArCQlXQVJO
X09OKHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGk5MTUsIERJU1BMQVlfSVBTX0NPTlRST0wsCj4g
PiAgIAkJCQkJCUlQU19FTkFCTEUgfCBJUFNfUENPREVfQ09OVFJPTCkpOwo+ID4gICAJCS8qIFF1
b3RpbmcgQXJ0IFJ1bnlhbjogIml0cyBub3Qgc2FmZSB0byBleHBlY3QgYW55IHBhcnRpY3VsYXIK
PiA+ICAgCQkgKiB2YWx1ZSBpbiBJUFNfQ1RMIGJpdCAzMSBhZnRlciBlbmFibGluZyBJUFMgdGhy
b3VnaCB0aGUKPiA+IEBAIC01NjY4LDcgKzU2NjgsNyBAQCB2b2lkIGhzd19lbmFibGVfaXBzKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICAJCSAqIGFuZCBk
b24ndCB3YWl0IGZvciB2YmxhbmtzIHVudGlsIHRoZSBlbmQgb2YgY3J0Y19lbmFibGUsIHRoZW4K
PiA+ICAgCQkgKiB0aGUgSFcgc3RhdGUgcmVhZG91dCBjb2RlIHdpbGwgY29tcGxhaW4gdGhhdCB0
aGUgZXhwZWN0ZWQKPiA+ICAgCQkgKiBJUFNfQ1RMIHZhbHVlIGlzIG5vdCB0aGUgb25lIHdlIHJl
YWQuICovCj4gPiAtCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNv
cmUsCj4gPiArCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiA+
ICAgCQkJCQkgICAgSVBTX0NUTCwgSVBTX0VOQUJMRSwgSVBTX0VOQUJMRSwKPiA+ICAgCQkJCQkg
ICAgNTApKQo+ID4gICAJCQlEUk1fRVJST1IoIlRpbWVkIG91dCB3YWl0aW5nIGZvciBJUFMgZW5h
YmxlXG4iKTsKPiA+IEBAIC01Njc5LDE5ICs1Njc5LDE5IEBAIHZvaWQgaHN3X2Rpc2FibGVfaXBz
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjKTsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAg
CWlmICghY3J0Y19zdGF0ZS0+aXBzX2VuYWJsZWQpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlpZiAo
SVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ID4gLQkJV0FSTl9PTihzYW5keWJyaWRnZV9wY29k
ZV93cml0ZShkZXZfcHJpdiwgRElTUExBWV9JUFNfQ09OVFJPTCwgMCkpOwo+ID4gKwlpZiAoSVNf
QlJPQURXRUxMKGk5MTUpKSB7Cj4gPiArCQlXQVJOX09OKHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRl
KGk5MTUsIERJU1BMQVlfSVBTX0NPTlRST0wsIDApKTsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIFdh
aXQgZm9yIFBDT0RFIHRvIGZpbmlzaCBkaXNhYmxpbmcgSVBTLiBUaGUgQlNwZWMgc3BlY2lmaWVk
Cj4gPiAgIAkJICogNDJtcyB0aW1lb3V0IHZhbHVlIGxlYWRzIHRvIG9jY2FzaW9uYWwgdGltZW91
dHMgc28gdXNlIDEwMG1zCj4gPiAgIAkJICogaW5zdGVhZC4KPiA+ICAgCQkgKi8KPiA+IC0JCWlm
IChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJCWlmIChp
bnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJCSAgICBJUFNf
Q1RMLCBJUFNfRU5BQkxFLCAwLAo+ID4gICAJCQkJCSAgICAxMDApKQo+ID4gICAJCQlEUk1fRVJS
T1IoIlRpbWVkIG91dCB3YWl0aW5nIGZvciBJUFMgZGlzYWJsZVxuIik7Cj4gPiBAQCAtNTcwMSw3
ICs1NzAxLDcgQEAgdm9pZCBoc3dfZGlzYWJsZV9pcHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIAl9Cj4gPiAgIAkvKiBXZSBuZWVkIHRvIHdhaXQgZm9y
IGEgdmJsYW5rIGJlZm9yZSB3ZSBjYW4gZGlzYWJsZSB0aGUgcGxhbmUuICovCj4gPiAtCWludGVs
X3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4gPiArCWludGVsX3dhaXRf
Zm9yX3ZibGFuayhpOTE1LCBjcnRjLT5waXBlKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBp
bnRlbF9jcnRjX2RwbXNfb3ZlcmxheV9kaXNhYmxlKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9j
cnRjKQo+ID4gQEAgLTU3MzUsNyArNTczNSw3IEBAIGludGVsX3Bvc3RfZW5hYmxlX3ByaW1hcnko
c3RydWN0IGRybV9jcnRjICpjcnRjLAo+ID4gICAJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9IGNydGMtPmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjKTsKPiA+ICAgCWludCBwaXBlID0gaW50ZWxfY3J0Yy0+cGlwZTsKPiA+IEBA
IC01NzQ2LDEyICs1NzQ2LDEyIEBAIGludGVsX3Bvc3RfZW5hYmxlX3ByaW1hcnkoc3RydWN0IGRy
bV9jcnRjICpjcnRjLAo+ID4gICAJICogRklYTUU6IE5lZWQgdG8gZml4IHRoZSBsb2dpYyB0byB3
b3JrIHdoZW4gd2UgdHVybiBvZmYgYWxsIHBsYW5lcwo+ID4gICAJICogYnV0IGxlYXZlIHRoZSBw
aXBlIHJ1bm5pbmcuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgMikpCj4g
PiAtCQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2LCBwaXBl
LCB0cnVlKTsKPiA+ICsJaWYgKElTX0dFTihpOTE1LCAyKSkKPiA+ICsJCWludGVsX3NldF9jcHVf
Zmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoaTkxNSwgcGlwZSwgdHJ1ZSk7Cj4gPiAgIAkvKiBVbmRl
cnJ1bnMgZG9uJ3QgYWx3YXlzIHJhaXNlIGludGVycnVwdHMsIHNvIGNoZWNrIG1hbnVhbGx5LiAq
Lwo+ID4gLQlpbnRlbF9jaGVja19jcHVfZmlmb191bmRlcnJ1bnMoZGV2X3ByaXYpOwo+ID4gLQlp
bnRlbF9jaGVja19wY2hfZmlmb191bmRlcnJ1bnMoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9jaGVj
a19jcHVfZmlmb191bmRlcnJ1bnMoaTkxNSk7Cj4gPiArCWludGVsX2NoZWNrX3BjaF9maWZvX3Vu
ZGVycnVucyhpOTE1KTsKPiA+ICAgfQo+ID4gICAvKiBGSVhNRSBnZXQgcmlkIG9mIHRoaXMgYW5k
IHVzZSBwcmVfcGxhbmVfdXBkYXRlICovCj4gPiBAQCAtNTc1OSw3ICs1NzU5LDcgQEAgc3RhdGlj
IHZvaWQKPiA+ICAgaW50ZWxfcHJlX2Rpc2FibGVfcHJpbWFyeV9ub2F0b21pYyhzdHJ1Y3QgZHJt
X2NydGMgKmNydGMpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRj
LT5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Yyk7Cj4gPiAgIAlpbnQgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7Cj4gPiBAQCAtNTc2Nyw4ICs1
NzY3LDggQEAgaW50ZWxfcHJlX2Rpc2FibGVfcHJpbWFyeV9ub2F0b21pYyhzdHJ1Y3QgZHJtX2Ny
dGMgKmNydGMpCj4gPiAgIAkgKiBHZW4yIHJlcG9ydHMgcGlwZSB1bmRlcnJ1bnMgd2hlbmV2ZXIg
YWxsIHBsYW5lcyBhcmUgZGlzYWJsZWQuCj4gPiAgIAkgKiBTbyBkaXNhYmxlIHVuZGVycnVuIHJl
cG9ydGluZyBiZWZvcmUgYWxsIHRoZSBwbGFuZXMgZ2V0IGRpc2FibGVkLgo+ID4gICAJICovCj4g
PiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKQo+ID4gLQkJaW50ZWxfc2V0X2NwdV9maWZvX3Vu
ZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgcGlwZSwgZmFsc2UpOwo+ID4gKwlpZiAoSVNfR0VO
KGk5MTUsIDIpKQo+ID4gKwkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhp
OTE1LCBwaXBlLCBmYWxzZSk7Cj4gPiAgIAloc3dfZGlzYWJsZV9pcHModG9faW50ZWxfY3J0Y19z
dGF0ZShjcnRjLT5zdGF0ZSkpOwo+ID4gQEAgLTU3ODEsMTYgKzU3ODEsMTYgQEAgaW50ZWxfcHJl
X2Rpc2FibGVfcHJpbWFyeV9ub2F0b21pYyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCj4gPiAgIAkg
KiBldmVudCB3aGljaCBpcyBhZnRlciB0aGUgdmJsYW5rIHN0YXJ0IGV2ZW50LCBzbyB3ZSBuZWVk
IHRvIGhhdmUgYQo+ID4gICAJICogd2FpdC1mb3ItdmJsYW5rIGJldHdlZW4gZGlzYWJsaW5nIHRo
ZSBwbGFuZSBhbmQgdGhlIHBpcGUuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKEhBU19HTUNIKGRldl9w
cml2KSAmJgo+ID4gLQkgICAgaW50ZWxfc2V0X21lbW9yeV9jeHNyKGRldl9wcml2LCBmYWxzZSkp
Cj4gPiAtCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlpZiAo
SEFTX0dNQ0goaTkxNSkgJiYKPiA+ICsJICAgIGludGVsX3NldF9tZW1vcnlfY3hzcihpOTE1LCBm
YWxzZSkpCj4gPiArCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoaTkxNSwgcGlwZSk7Cj4gPiAgIH0K
PiA+ICAgc3RhdGljIGJvb2wgaHN3X3ByZV91cGRhdGVfZGlzYWJsZV9pcHMoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ID4gICAJCQkJICAgICAgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWlmICghb2xkX2NydGNfc3RhdGUtPmlw
c19lbmFibGVkKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IEBAIC01ODA0LDcgKzU4MDQsNyBA
QCBzdGF0aWMgYm9vbCBoc3dfcHJlX3VwZGF0ZV9kaXNhYmxlX2lwcyhjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfcwo+ID4gICAJICoKPiA+ICAgCSAqIERpc2FibGUgSVBT
IGJlZm9yZSB3ZSBwcm9ncmFtIHRoZSBMVVQuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX0hBU1dF
TEwoZGV2X3ByaXYpICYmCj4gPiArCWlmIChJU19IQVNXRUxMKGk5MTUpICYmCj4gPiAgIAkgICAg
KG5ld19jcnRjX3N0YXRlLT5iYXNlLmNvbG9yX21nbXRfY2hhbmdlZCB8fAo+ID4gICAJICAgICBu
ZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3BpcGUpICYmCj4gPiAgIAkgICAgbmV3X2NydGNfc3RhdGUt
PmdhbW1hX21vZGUgPT0gR0FNTUFfTU9ERV9NT0RFX1NQTElUKQo+ID4gQEAgLTU4MTcsNyArNTgx
Nyw3IEBAIHN0YXRpYyBib29sIGhzd19wb3N0X3VwZGF0ZV9lbmFibGVfaXBzKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zCj4gPiAgIAkJCQkgICAgICAgY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJaWYgKCFuZXdfY3J0Y19zdGF0ZS0+aXBzX2Vu
YWJsZWQpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTU4MzEsNyArNTgzMSw3IEBAIHN0
YXRpYyBib29sIGhzd19wb3N0X3VwZGF0ZV9lbmFibGVfaXBzKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpvbGRfY3J0Y19zCj4gPiAgIAkgKgo+ID4gICAJICogUmUtZW5hYmxlIElQUyBh
ZnRlciB0aGUgTFVUIGhhcyBiZWVuIHByb2dyYW1tZWQuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElT
X0hBU1dFTEwoZGV2X3ByaXYpICYmCj4gPiArCWlmIChJU19IQVNXRUxMKGk5MTUpICYmCj4gPiAg
IAkgICAgKG5ld19jcnRjX3N0YXRlLT5iYXNlLmNvbG9yX21nbXRfY2hhbmdlZCB8fAo+ID4gICAJ
ICAgICBuZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3BpcGUpICYmCj4gPiAgIAkgICAgbmV3X2NydGNf
c3RhdGUtPmdhbW1hX21vZGUgPT0gR0FNTUFfTU9ERV9NT0RFX1NQTElUKQo+ID4gQEAgLTU4NDgs
MjQgKzU4NDgsMjQgQEAgc3RhdGljIGJvb2wgaHN3X3Bvc3RfdXBkYXRlX2VuYWJsZV9pcHMoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3MKPiA+ICAgCXJldHVybiAhb2xk
X2NydGNfc3RhdGUtPmlwc19lbmFibGVkOwo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wgbmVlZHNf
bnYxMl93YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGJv
b2wgbmVlZHNfbnYxMl93YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJ
ICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4g
ICAJaWYgKCFjcnRjX3N0YXRlLT5udjEyX3BsYW5lcykKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4g
PiAgIAkvKiBXQSBEaXNwbGF5ICMwODI3OiBHZW45OmFsbCAqLwo+ID4gLQlpZiAoSVNfR0VOKGRl
dl9wcml2LCA5KSAmJiAhSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gPiArCWlmIChJU19HRU4o
aTkxNSwgOSkgJiYgIUlTX0dFTUlOSUxBS0UoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4g
PiAgIAlyZXR1cm4gZmFsc2U7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBuZWVkc19zY2FsZXJj
bGtfd2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29s
IG5lZWRzX3NjYWxlcmNsa193YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4g
ICB7Cj4gPiAgIAkvKiBXYV8yMDA2NjA0MzEyOmljbCAqLwo+ID4gLQlpZiAoY3J0Y19zdGF0ZS0+
c2NhbGVyX3N0YXRlLnNjYWxlcl91c2VycyA+IDAgJiYgSVNfSUNFTEFLRShkZXZfcHJpdikpCj4g
PiArCWlmIChjcnRjX3N0YXRlLT5zY2FsZXJfc3RhdGUuc2NhbGVyX3VzZXJzID4gMCAmJiBJU19J
Q0VMQUtFKGk5MTUpKQo+ID4gICAJCXJldHVybiB0cnVlOwo+ID4gICAJcmV0dXJuIGZhbHNlOwo+
ID4gQEAgLTU4NzUsNyArNTg3NSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bvc3RfcGxhbmVfdXBk
YXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4g
ICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2Uu
ZGV2Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+
ID4gICAJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKm9sZF9zdGF0ZSA9IG9sZF9jcnRjX3N0YXRl
LT5iYXNlLnN0YXRlOwo+ID4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmln
ID0KPiA+ICAgCQlpbnRlbF9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRlKHRvX2ludGVsX2F0b21p
Y19zdGF0ZShvbGRfc3RhdGUpLAo+ID4gQEAgLTU5MDQsMTMgKzU5MDQsMTMgQEAgc3RhdGljIHZv
aWQgaW50ZWxfcG9zdF9wbGFuZV91cGRhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3N0YXRlKQo+ID4gICAJCQlpbnRlbF9wb3N0X2VuYWJsZV9wcmltYXJ5KCZjcnRjLT5iYXNl
LCBwaXBlX2NvbmZpZyk7Cj4gPiAgIAl9Cj4gPiAtCWlmIChuZWVkc19udjEyX3dhKGRldl9wcml2
LCBvbGRfY3J0Y19zdGF0ZSkgJiYKPiA+IC0JICAgICFuZWVkc19udjEyX3dhKGRldl9wcml2LCBw
aXBlX2NvbmZpZykpCj4gPiAtCQlza2xfd2FfODI3KGRldl9wcml2LCBjcnRjLT5waXBlLCBmYWxz
ZSk7Cj4gPiArCWlmIChuZWVkc19udjEyX3dhKGk5MTUsIG9sZF9jcnRjX3N0YXRlKSAmJgo+ID4g
KwkgICAgIW5lZWRzX252MTJfd2EoaTkxNSwgcGlwZV9jb25maWcpKQo+ID4gKwkJc2tsX3dhXzgy
NyhpOTE1LCBjcnRjLT5waXBlLCBmYWxzZSk7Cj4gPiAtCWlmIChuZWVkc19zY2FsZXJjbGtfd2Eo
ZGV2X3ByaXYsIG9sZF9jcnRjX3N0YXRlKSAmJgo+ID4gLQkgICAgIW5lZWRzX3NjYWxlcmNsa193
YShkZXZfcHJpdiwgcGlwZV9jb25maWcpKQo+ID4gLQkJaWNsX3dhX3NjYWxlcmNsa2dhdGluZyhk
ZXZfcHJpdiwgY3J0Yy0+cGlwZSwgZmFsc2UpOwo+ID4gKwlpZiAobmVlZHNfc2NhbGVyY2xrX3dh
KGk5MTUsIG9sZF9jcnRjX3N0YXRlKSAmJgo+ID4gKwkgICAgIW5lZWRzX3NjYWxlcmNsa193YShp
OTE1LCBwaXBlX2NvbmZpZykpCj4gPiArCQlpY2xfd2Ffc2NhbGVyY2xrZ2F0aW5nKGk5MTUsIGNy
dGMtPnBpcGUsIGZhbHNlKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9wcmVfcGxh
bmVfdXBkYXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiA+IEBA
IC01OTE4LDcgKzU5MTgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wcmVfcGxhbmVfdXBkYXRlKHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiA+ICAgewo+ID4gICAJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNl
LmNydGMpOwo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJ
c3RydWN0IGRybV9hdG9taWNfc3RhdGUgKm9sZF9zdGF0ZSA9IG9sZF9jcnRjX3N0YXRlLT5iYXNl
LnN0YXRlOwo+ID4gICAJc3RydWN0IGRybV9wbGFuZSAqcHJpbWFyeSA9IGNydGMtPmJhc2UucHJp
bWFyeTsKPiA+ICAgCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9wcmltYXJ5X3N0YXRlID0K
PiA+IEBAIC01OTQwLDIwICs1OTQwLDIwIEBAIHN0YXRpYyB2b2lkIGludGVsX3ByZV9wbGFuZV91
cGRhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ID4gICAJCSAq
IEdlbjIgcmVwb3J0cyBwaXBlIHVuZGVycnVucyB3aGVuZXZlciBhbGwgcGxhbmVzIGFyZSBkaXNh
YmxlZC4KPiA+ICAgCQkgKiBTbyBkaXNhYmxlIHVuZGVycnVuIHJlcG9ydGluZyBiZWZvcmUgYWxs
IHRoZSBwbGFuZXMgZ2V0IGRpc2FibGVkLgo+ID4gICAJCSAqLwo+ID4gLQkJaWYgKElTX0dFTihk
ZXZfcHJpdiwgMikgJiYgb2xkX3ByaW1hcnlfc3RhdGUtPnZpc2libGUgJiYKPiA+ICsJCWlmIChJ
U19HRU4oaTkxNSwgMikgJiYgb2xkX3ByaW1hcnlfc3RhdGUtPnZpc2libGUgJiYKPiA+ICAgCQkg
ICAgKG1vZGVzZXQgfHwgIW5ld19wcmltYXJ5X3N0YXRlLT5iYXNlLnZpc2libGUpKQo+ID4gLQkJ
CWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIGNydGMtPnBp
cGUsIGZhbHNlKTsKPiA+ICsJCQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5n
KGk5MTUsIGNydGMtPnBpcGUsIGZhbHNlKTsKPiA+ICAgCX0KPiA+ICAgCS8qIERpc3BsYXkgV0Eg
ODI3ICovCj4gPiAtCWlmICghbmVlZHNfbnYxMl93YShkZXZfcHJpdiwgb2xkX2NydGNfc3RhdGUp
ICYmCj4gPiAtCSAgICBuZWVkc19udjEyX3dhKGRldl9wcml2LCBwaXBlX2NvbmZpZykpCj4gPiAt
CQlza2xfd2FfODI3KGRldl9wcml2LCBjcnRjLT5waXBlLCB0cnVlKTsKPiA+ICsJaWYgKCFuZWVk
c19udjEyX3dhKGk5MTUsIG9sZF9jcnRjX3N0YXRlKSAmJgo+ID4gKwkgICAgbmVlZHNfbnYxMl93
YShpOTE1LCBwaXBlX2NvbmZpZykpCj4gPiArCQlza2xfd2FfODI3KGk5MTUsIGNydGMtPnBpcGUs
IHRydWUpOwo+ID4gICAJLyogV2FfMjAwNjYwNDMxMjppY2wgKi8KPiA+IC0JaWYgKCFuZWVkc19z
Y2FsZXJjbGtfd2EoZGV2X3ByaXYsIG9sZF9jcnRjX3N0YXRlKSAmJgo+ID4gLQkgICAgbmVlZHNf
c2NhbGVyY2xrX3dhKGRldl9wcml2LCBwaXBlX2NvbmZpZykpCj4gPiAtCQlpY2xfd2Ffc2NhbGVy
Y2xrZ2F0aW5nKGRldl9wcml2LCBjcnRjLT5waXBlLCB0cnVlKTsKPiA+ICsJaWYgKCFuZWVkc19z
Y2FsZXJjbGtfd2EoaTkxNSwgb2xkX2NydGNfc3RhdGUpICYmCj4gPiArCSAgICBuZWVkc19zY2Fs
ZXJjbGtfd2EoaTkxNSwgcGlwZV9jb25maWcpKQo+ID4gKwkJaWNsX3dhX3NjYWxlcmNsa2dhdGlu
ZyhpOTE1LCBjcnRjLT5waXBlLCB0cnVlKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBWYmxhbmsgdGlt
ZSB1cGRhdGVzIGZyb20gdGhlIHNoYWRvdyB0byBsaXZlIHBsYW5lIGNvbnRyb2wgcmVnaXN0ZXIK
PiA+IEBAIC01OTY0LDkgKzU5NjQsOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wcmVfcGxhbmVfdXBk
YXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiA+ICAgCSAqIGV2
ZW50IHdoaWNoIGlzIGFmdGVyIHRoZSB2Ymxhbmsgc3RhcnQgZXZlbnQsIHNvIHdlIG5lZWQgdG8g
aGF2ZSBhCj4gPiAgIAkgKiB3YWl0LWZvci12YmxhbmsgYmV0d2VlbiBkaXNhYmxpbmcgdGhlIHBs
YW5lIGFuZCB0aGUgcGlwZS4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSEFTX0dNQ0goZGV2X3ByaXYp
ICYmIG9sZF9jcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSAmJgo+ID4gLQkgICAgcGlwZV9jb25maWct
PmRpc2FibGVfY3hzciAmJiBpbnRlbF9zZXRfbWVtb3J5X2N4c3IoZGV2X3ByaXYsIGZhbHNlKSkK
PiA+IC0JCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4gPiAr
CWlmIChIQVNfR01DSChpOTE1KSAmJiBvbGRfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUgJiYKPiA+
ICsJICAgIHBpcGVfY29uZmlnLT5kaXNhYmxlX2N4c3IgJiYgaW50ZWxfc2V0X21lbW9yeV9jeHNy
KGk5MTUsIGZhbHNlKSkKPiA+ICsJCWludGVsX3dhaXRfZm9yX3ZibGFuayhpOTE1LCBjcnRjLT5w
aXBlKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBJVkIgd29ya2Fyb3VuZDogbXVzdCBkaXNhYmxlIGxv
dyBwb3dlciB3YXRlcm1hcmtzIGZvciBhdCBsZWFzdAo+ID4gQEAgLTU5NzcsNyArNTk3Nyw3IEBA
IHN0YXRpYyB2b2lkIGludGVsX3ByZV9wbGFuZV91cGRhdGUoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKm9sZF9jcnRjX3N0YXRlLAo+ID4gICAJICovCj4gPiAgIAlpZiAocGlwZV9jb25maWctPmRp
c2FibGVfbHBfd20gJiYgaWxrX2Rpc2FibGVfbHBfd20oZGV2KSAmJgo+ID4gICAJICAgIG9sZF9j
cnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPiA+IC0JCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZf
cHJpdiwgY3J0Yy0+cGlwZSk7Cj4gPiArCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoaTkxNSwgY3J0
Yy0+cGlwZSk7Cj4gPiAgIAkvKgo+ID4gICAJICogSWYgd2UncmUgZG9pbmcgYSBtb2Rlc2V0LCB3
ZSdyZSBkb25lLiAgTm8gbmVlZCB0byBkbyBhbnkgcHJlLXZibGFuawo+ID4gQEAgLTYwMDAsOCAr
NjAwMCw4IEBAIHN0YXRpYyB2b2lkIGludGVsX3ByZV9wbGFuZV91cGRhdGUoc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ID4gICAJICogd2UnbGwgY29udGludWUgdG8g
dXBkYXRlIHdhdGVybWFya3MgdGhlIG9sZCB3YXksIGlmIGZsYWdzIHRlbGwKPiA+ICAgCSAqIHVz
IHRvLgo+ID4gICAJICovCj4gPiAtCWlmIChkZXZfcHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVy
bWFya3MgIT0gTlVMTCkKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJr
cyhvbGRfaW50ZWxfc3RhdGUsCj4gPiArCWlmIChpOTE1LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJt
YXJrcyAhPSBOVUxMKQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3Mob2xk
X2ludGVsX3N0YXRlLAo+ID4gICAJCQkJCQkgICAgIHBpcGVfY29uZmlnKTsKPiA+ICAgCWVsc2Ug
aWYgKHBpcGVfY29uZmlnLT51cGRhdGVfd21fcHJlKQo+ID4gICAJCWludGVsX3VwZGF0ZV93YXRl
cm1hcmtzKGNydGMpOwo+ID4gQEAgLTYwMTAsNyArNjAxMCw3IEBAIHN0YXRpYyB2b2lkIGludGVs
X3ByZV9wbGFuZV91cGRhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRl
LAo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2Rpc2FibGVfcGxhbmVzKHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ID4gICAJCQkJICAgICAgc3RydWN0IGludGVsX2NydGMg
KmNydGMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUgPQo+ID4gICAJCWludGVsX2F0b21pY19nZXRfbmV3
X2NydGNfc3RhdGUoc3RhdGUsIGNydGMpOwo+ID4gICAJdW5zaWduZWQgaW50IHVwZGF0ZV9tYXNr
ID0gbmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9wbGFuZXM7Cj4gPiBAQCAtNjAzMiw3ICs2MDMyLDcg
QEAgc3RhdGljIHZvaWQgaW50ZWxfY3J0Y19kaXNhYmxlX3BsYW5lcyhzdHJ1Y3QgaW50ZWxfYXRv
bWljX3N0YXRlICpzdGF0ZSwKPiA+ICAgCQkJZmJfYml0cyB8PSBwbGFuZS0+ZnJvbnRidWZmZXJf
Yml0Owo+ID4gICAJfQo+ID4gLQlpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwKGRldl9wcml2LCBmYl9i
aXRzKTsKPiA+ICsJaW50ZWxfZnJvbnRidWZmZXJfZmxpcChpOTE1LCBmYl9iaXRzKTsKPiA+ICAg
fQo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9lbmNvZGVyc19wcmVfcGxsX2VuYWJsZShzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGMsCj4gPiBAQCAtNjE5MCw3ICs2MTkwLDcgQEAgc3RhdGljIHZvaWQgaXJv
bmxha2VfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+
ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBwaXBlX2NvbmZpZy0+YmFzZS5j
cnRjOwo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmRldjsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjKTsKPiA+ICAgCWludCBw
aXBlID0gaW50ZWxfY3J0Yy0+cGlwZTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUg
Km9sZF9pbnRlbF9zdGF0ZSA9Cj4gPiBAQCAtNjIwOSw4ICs2MjA5LDggQEAgc3RhdGljIHZvaWQg
aXJvbmxha2VfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmln
LAo+ID4gICAJICoKPiA+ICAgCSAqIFNwdXJpb3VzIFBDSCB1bmRlcnJ1bnMgYWxzbyBvY2N1ciBk
dXJpbmcgUENIIGVuYWJsaW5nLgo+ID4gICAJICovCj4gPiAtCWludGVsX3NldF9jcHVfZmlmb191
bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIHBpcGUsIGZhbHNlKTsKPiA+IC0JaW50ZWxfc2V0
X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgcGlwZSwgZmFsc2UpOwo+ID4g
KwlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIHBpcGUsIGZhbHNl
KTsKPiA+ICsJaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBwaXBl
LCBmYWxzZSk7Cj4gPiAgIAlpZiAocGlwZV9jb25maWctPmhhc19wY2hfZW5jb2RlcikKPiA+ICAg
CQlpbnRlbF9wcmVwYXJlX3NoYXJlZF9kcGxsKHBpcGVfY29uZmlnKTsKPiA+IEBAIC02MjM4LDgg
KzYyMzgsOCBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gPiAgIAkJICogZW5hYmxpbmcuICovCj4gPiAgIAkJ
aXJvbmxha2VfZmRpX3BsbF9lbmFibGUocGlwZV9jb25maWcpOwo+ID4gICAJfSBlbHNlIHsKPiA+
IC0JCWFzc2VydF9mZGlfdHhfZGlzYWJsZWQoZGV2X3ByaXYsIHBpcGUpOwo+ID4gLQkJYXNzZXJ0
X2ZkaV9yeF9kaXNhYmxlZChkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCQlhc3NlcnRfZmRpX3R4X2Rp
c2FibGVkKGk5MTUsIHBpcGUpOwo+ID4gKwkJYXNzZXJ0X2ZkaV9yeF9kaXNhYmxlZChpOTE1LCBw
aXBlKTsKPiA+ICAgCX0KPiA+ICAgCWlyb25sYWtlX3BmaXRfZW5hYmxlKHBpcGVfY29uZmlnKTsK
PiA+IEBAIC02MjUzLDggKzYyNTMsOCBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9jcnRjX2VuYWJs
ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gPiAgIAkvKiB1cGRhdGUg
RFNQQ05UUiB0byBjb25maWd1cmUgZ2FtbWEgZm9yIHBpcGUgYm90dG9tIGNvbG9yICovCj4gPiAg
IAlpbnRlbF9kaXNhYmxlX3ByaW1hcnlfcGxhbmUocGlwZV9jb25maWcpOwo+ID4gLQlpZiAoZGV2
X3ByaXYtPmRpc3BsYXkuaW5pdGlhbF93YXRlcm1hcmtzICE9IE5VTEwpCj4gPiAtCQlkZXZfcHJp
di0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3Mob2xkX2ludGVsX3N0YXRlLCBwaXBlX2NvbmZp
Zyk7Cj4gPiArCWlmIChpOTE1LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJrcyAhPSBOVUxMKQo+
ID4gKwkJaTkxNS0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3Mob2xkX2ludGVsX3N0YXRlLCBw
aXBlX2NvbmZpZyk7Cj4gPiAgIAlpbnRlbF9lbmFibGVfcGlwZShwaXBlX2NvbmZpZyk7Cj4gPiAg
IAlpZiAocGlwZV9jb25maWctPmhhc19wY2hfZW5jb2RlcikKPiA+IEBAIC02MjY1LDcgKzYyNjUs
NyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqcGlwZV9jb25maWcsCj4gPiAgIAlpbnRlbF9lbmNvZGVyc19lbmFibGUoY3J0YywgcGlw
ZV9jb25maWcsIG9sZF9zdGF0ZSk7Cj4gPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikpCj4g
PiArCWlmIChIQVNfUENIX0NQVChpOTE1KSkKPiA+ICAgCQljcHRfdmVyaWZ5X21vZGVzZXQoZGV2
LCBpbnRlbF9jcnRjLT5waXBlKTsKPiA+ICAgCS8qCj4gPiBAQCAtNjI3NSwxMSArNjI3NSwxMSBA
QCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqcGlwZV9jb25maWcsCj4gPiAgIAkgKiBpbiBjYXNlIHRoZXJlIGFyZSBtb3JlIGNvcm5lciBj
YXNlcyB3ZSBkb24ndCBrbm93IGFib3V0Lgo+ID4gICAJICovCj4gPiAgIAlpZiAocGlwZV9jb25m
aWctPmhhc19wY2hfZW5jb2Rlcikgewo+ID4gLQkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9w
cml2LCBwaXBlKTsKPiA+IC0JCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgcGlwZSk7
Cj4gPiArCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoaTkxNSwgcGlwZSk7Cj4gPiArCQlpbnRlbF93
YWl0X2Zvcl92YmxhbmsoaTkxNSwgcGlwZSk7Cj4gPiAgIAl9Cj4gPiAtCWludGVsX3NldF9jcHVf
Zmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIHBpcGUsIHRydWUpOwo+ID4gLQlpbnRl
bF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2LCBwaXBlLCB0cnVlKTsK
PiA+ICsJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBwaXBlLCB0
cnVlKTsKPiA+ICsJaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBw
aXBlLCB0cnVlKTsKPiA+ICAgfQo+ID4gICAvKiBJUFMgb25seSBleGlzdHMgb24gVUxUIG1hY2hp
bmVzIGFuZCBpcyB0aWVkIHRvIHBpcGUgQS4gKi8KPiA+IEBAIC02Mjg4LDcgKzYyODgsNyBAQCBz
dGF0aWMgYm9vbCBoc3dfY3J0Y19zdXBwb3J0c19pcHMoc3RydWN0IGludGVsX2NydGMgKmNydGMp
Cj4gPiAgIAlyZXR1cm4gSEFTX0lQUyh0b19pOTE1KGNydGMtPmJhc2UuZGV2KSkgJiYgY3J0Yy0+
cGlwZSA9PSBQSVBFX0E7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnbGtfcGlwZV9zY2FsZXJf
Y2xvY2tfZ2F0aW5nX3dhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtz
dGF0aWMgdm9pZCBnbGtfcGlwZV9zY2FsZXJfY2xvY2tfZ2F0aW5nX3dhKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJCSAgICBlbnVtIHBpcGUgcGlwZSwgYm9vbCBhcHBs
eSkKPiA+ICAgewo+ID4gICAJdTMyIHZhbCA9IEk5MTVfUkVBRChDTEtHQVRFX0RJU19QU0wocGlw
ZSkpOwo+ID4gQEAgLTYzMDQsNyArNjMwNCw3IEBAIHN0YXRpYyB2b2lkIGdsa19waXBlX3NjYWxl
cl9jbG9ja19nYXRpbmdfd2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
ICBzdGF0aWMgdm9pZCBpY2xfcGlwZV9tYnVzX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+
cGlwZTsKPiA+ICAgCXUzMiB2YWw7Cj4gPiBAQCAtNjMxOSw3ICs2MzE5LDcgQEAgc3RhdGljIHZv
aWQgaGFzd2VsbF9jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25m
aWcsCj4gPiAgIAkJCQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqb2xkX3N0YXRlKQo+ID4gICB7
Cj4gPiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBwaXBlX2NvbmZpZy0+YmFzZS5jcnRjOwo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5k
ZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRj
KGNydGMpOwo+ID4gICAJaW50IHBpcGUgPSBpbnRlbF9jcnRjLT5waXBlLCBoc3dfd29ya2Fyb3Vu
ZF9waXBlOwo+ID4gICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gcGlwZV9jb25m
aWctPmNwdV90cmFuc2NvZGVyOwo+ID4gQEAgLTYzNTksMTggKzYzNTksMTggQEAgc3RhdGljIHZv
aWQgaGFzd2VsbF9jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25m
aWcsCj4gPiAgIAlpZiAoIXRyYW5zY29kZXJfaXNfZHNpKGNwdV90cmFuc2NvZGVyKSkKPiA+ICAg
CQloYXN3ZWxsX3NldF9waXBlY29uZihwaXBlX2NvbmZpZyk7Cj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDkgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiA+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSA5IHx8IElTX0JST0FEV0VMTChpOTE1KSkKPiA+ICAgCQliZHdfc2V0X3Bp
cGVtaXNjKHBpcGVfY29uZmlnKTsKPiA+ICAgCWludGVsX2NydGMtPmFjdGl2ZSA9IHRydWU7Cj4g
PiAgIAkvKiBEaXNwbGF5IFdBICMxMTgwOiBXYURpc2FibGVTY2FsYXJDbG9ja0dhdGluZzogZ2xr
LCBjbmwgKi8KPiA+IC0JcHNsX2Nsa2dhdGVfd2EgPSAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikg
fHwgSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikpICYmCj4gPiArCXBzbF9jbGtnYXRlX3dhID0gKElT
X0dFTUlOSUxBS0UoaTkxNSkgfHwgSVNfQ0FOTk9OTEFLRShpOTE1KSkgJiYKPiA+ICAgCQkJIHBp
cGVfY29uZmlnLT5wY2hfcGZpdC5lbmFibGVkOwo+ID4gICAJaWYgKHBzbF9jbGtnYXRlX3dhKQo+
ID4gLQkJZ2xrX3BpcGVfc2NhbGVyX2Nsb2NrX2dhdGluZ193YShkZXZfcHJpdiwgcGlwZSwgdHJ1
ZSk7Cj4gPiArCQlnbGtfcGlwZV9zY2FsZXJfY2xvY2tfZ2F0aW5nX3dhKGk5MTUsIHBpcGUsIHRy
dWUpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ID4gKwlpZiAoSU5URUxf
R0VOKGk5MTUpID49IDkpCj4gPiAgIAkJc2t5bGFrZV9wZml0X2VuYWJsZShwaXBlX2NvbmZpZyk7
Cj4gPiAgIAllbHNlCj4gPiAgIAkJaXJvbmxha2VfcGZpdF9lbmFibGUocGlwZV9jb25maWcpOwo+
ID4gQEAgLTYzODIsMjAgKzYzODIsMjAgQEAgc3RhdGljIHZvaWQgaGFzd2VsbF9jcnRjX2VuYWJs
ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gPiAgIAlpbnRlbF9jb2xv
cl9sb2FkX2x1dHMocGlwZV9jb25maWcpOwo+ID4gICAJaW50ZWxfY29sb3JfY29tbWl0KHBpcGVf
Y29uZmlnKTsKPiA+ICAgCS8qIHVwZGF0ZSBEU1BDTlRSIHRvIGNvbmZpZ3VyZSBnYW1tYS9jc2Mg
Zm9yIHBpcGUgYm90dG9tIGNvbG9yICovCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwg
OSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDkpCj4gPiAgIAkJaW50ZWxfZGlzYWJsZV9w
cmltYXJ5X3BsYW5lKHBpcGVfY29uZmlnKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gMTEpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gPiAgIAkJaWNsX3NldF9w
aXBlX2NoaWNrZW4oaW50ZWxfY3J0Yyk7Cj4gPiAgIAlpbnRlbF9kZGlfc2V0X3BpcGVfc2V0dGlu
Z3MocGlwZV9jb25maWcpOwo+ID4gICAJaWYgKCF0cmFuc2NvZGVyX2lzX2RzaShjcHVfdHJhbnNj
b2RlcikpCj4gPiAgIAkJaW50ZWxfZGRpX2VuYWJsZV90cmFuc2NvZGVyX2Z1bmMocGlwZV9jb25m
aWcpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmRpc3BsYXkuaW5pdGlhbF93YXRlcm1hcmtzICE9IE5V
TEwpCj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3Mob2xkX2ludGVs
X3N0YXRlLCBwaXBlX2NvbmZpZyk7Cj4gPiArCWlmIChpOTE1LT5kaXNwbGF5LmluaXRpYWxfd2F0
ZXJtYXJrcyAhPSBOVUxMKQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3Mo
b2xkX2ludGVsX3N0YXRlLCBwaXBlX2NvbmZpZyk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDExKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ID4gICAJCWljbF9w
aXBlX21idXNfZW5hYmxlKGludGVsX2NydGMpOwo+ID4gICAJLyogWFhYOiBEbyB0aGUgcGlwZSBh
c3NlcnRpb25zIGF0IHRoZSByaWdodCBwbGFjZSBmb3IgQlhUIERTSS4gKi8KPiA+IEBAIC02NDE0
LDIzICs2NDE0LDIzIEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfY3J0Y19lbmFibGUoc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ID4gICAJaW50ZWxfZW5jb2RlcnNfZW5hYmxl
KGNydGMsIHBpcGVfY29uZmlnLCBvbGRfc3RhdGUpOwo+ID4gICAJaWYgKHBzbF9jbGtnYXRlX3dh
KSB7Cj4gPiAtCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoZGV2X3ByaXYsIHBpcGUpOwo+ID4gLQkJ
Z2xrX3BpcGVfc2NhbGVyX2Nsb2NrX2dhdGluZ193YShkZXZfcHJpdiwgcGlwZSwgZmFsc2UpOwo+
ID4gKwkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsIHBpcGUpOwo+ID4gKwkJZ2xrX3BpcGVf
c2NhbGVyX2Nsb2NrX2dhdGluZ193YShpOTE1LCBwaXBlLCBmYWxzZSk7Cj4gPiAgIAl9Cj4gPiAg
IAkvKiBJZiB3ZSBjaGFuZ2UgdGhlIHJlbGF0aXZlIG9yZGVyIGJldHdlZW4gcGlwZS9wbGFuZXMg
ZW5hYmxpbmcsIHdlIG5lZWQKPiA+ICAgCSAqIHRvIGNoYW5nZSB0aGUgd29ya2Fyb3VuZC4gKi8K
PiA+ICAgCWhzd193b3JrYXJvdW5kX3BpcGUgPSBwaXBlX2NvbmZpZy0+aHN3X3dvcmthcm91bmRf
cGlwZTsKPiA+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpICYmIGhzd193b3JrYXJvdW5kX3Bp
cGUgIT0gSU5WQUxJRF9QSVBFKSB7Cj4gPiAtCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoZGV2X3By
aXYsIGhzd193b3JrYXJvdW5kX3BpcGUpOwo+ID4gLQkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRl
dl9wcml2LCBoc3dfd29ya2Fyb3VuZF9waXBlKTsKPiA+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkg
JiYgaHN3X3dvcmthcm91bmRfcGlwZSAhPSBJTlZBTElEX1BJUEUpIHsKPiA+ICsJCWludGVsX3dh
aXRfZm9yX3ZibGFuayhpOTE1LCBoc3dfd29ya2Fyb3VuZF9waXBlKTsKPiA+ICsJCWludGVsX3dh
aXRfZm9yX3ZibGFuayhpOTE1LCBoc3dfd29ya2Fyb3VuZF9waXBlKTsKPiA+ICAgCX0KPiA+ICAg
fQo+ID4gICBzdGF0aWMgdm9pZCBpcm9ubGFrZV9wZml0X2Rpc2FibGUoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4g
ICAJLyogVG8gYXZvaWQgdXBzZXR0aW5nIHRoZSBwb3dlciB3ZWxsIG9uIGhhc3dlbGwgb25seSBk
aXNhYmxlIHRoZSBwZml0IGlmCj4gPiBAQCAtNjQ0Nyw3ICs2NDQ3LDcgQEAgc3RhdGljIHZvaWQg
aXJvbmxha2VfY3J0Y19kaXNhYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19z
dGF0ZSwKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9jcnRjICpjcnRjID0gb2xkX2NydGNfc3Rh
dGUtPmJhc2UuY3J0YzsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5kZXY7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4g
PiAgIAlpbnQgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7Cj4gPiBAQCAtNjQ1Niw4ICs2NDU2LDgg
QEAgc3RhdGljIHZvaWQgaXJvbmxha2VfY3J0Y19kaXNhYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiA+ICAgCSAqIHBpcGUgaXMgYWxyZWFkeSBkaXNhYmxlZCwg
YnV0IEZESSBSWC9UWCBpcyBzdGlsbCBlbmFibGVkLgo+ID4gICAJICogSGFwcGVucyBhdCBsZWFz
dCB3aXRoIFZHQStIRE1JIGNsb25pbmcuIFN1cHByZXNzIHRoZW0uCj4gPiAgIAkgKi8KPiA+IC0J
aW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgcGlwZSwgZmFs
c2UpOwo+ID4gLQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2
LCBwaXBlLCBmYWxzZSk7Cj4gPiArCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRp
bmcoaTkxNSwgcGlwZSwgZmFsc2UpOwo+ID4gKwlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5f
cmVwb3J0aW5nKGk5MTUsIHBpcGUsIGZhbHNlKTsKPiA+ICAgCWludGVsX2VuY29kZXJzX2Rpc2Fi
bGUoY3J0Yywgb2xkX2NydGNfc3RhdGUsIG9sZF9zdGF0ZSk7Cj4gPiBAQCAtNjQ3NCw5ICs2NDc0
LDkgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfY3J0Y19kaXNhYmxlKHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiA+ICAgCWludGVsX2VuY29kZXJzX3Bvc3RfZGlzYWJs
ZShjcnRjLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX3N0YXRlKTsKPiA+ICAgCWlmIChvbGRfY3J0Y19z
dGF0ZS0+aGFzX3BjaF9lbmNvZGVyKSB7Cj4gPiAtCQlpcm9ubGFrZV9kaXNhYmxlX3BjaF90cmFu
c2NvZGVyKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJCWlyb25sYWtlX2Rpc2FibGVfcGNoX3RyYW5z
Y29kZXIoaTkxNSwgcGlwZSk7Cj4gPiAtCQlpZiAoSEFTX1BDSF9DUFQoZGV2X3ByaXYpKSB7Cj4g
PiArCQlpZiAoSEFTX1BDSF9DUFQoaTkxNSkpIHsKPiA+ICAgCQkJaTkxNV9yZWdfdCByZWc7Cj4g
PiAgIAkJCXUzMiB0ZW1wOwo+ID4gQEAgLTY0OTcsMTUgKzY0OTcsMTUgQEAgc3RhdGljIHZvaWQg
aXJvbmxha2VfY3J0Y19kaXNhYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19z
dGF0ZSwKPiA+ICAgCQlpcm9ubGFrZV9mZGlfcGxsX2Rpc2FibGUoaW50ZWxfY3J0Yyk7Cj4gPiAg
IAl9Cj4gPiAtCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYs
IHBpcGUsIHRydWUpOwo+ID4gLQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5n
KGRldl9wcml2LCBwaXBlLCB0cnVlKTsKPiA+ICsJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVu
X3JlcG9ydGluZyhpOTE1LCBwaXBlLCB0cnVlKTsKPiA+ICsJaW50ZWxfc2V0X3BjaF9maWZvX3Vu
ZGVycnVuX3JlcG9ydGluZyhpOTE1LCBwaXBlLCB0cnVlKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMg
dm9pZCBoYXN3ZWxsX2NydGNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2Ny
dGNfc3RhdGUsCj4gPiAgIAkJCQkgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKm9sZF9zdGF0ZSkK
PiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9jcnRjICpjcnRjID0gb2xkX2NydGNfc3RhdGUtPmJh
c2UuY3J0YzsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoY3J0Yy0+ZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9f
aW50ZWxfY3J0YyhjcnRjKTsKPiA+ICAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9
IG9sZF9jcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPiA+IEBAIC02NTI2LDcgKzY1MjYsNyBA
QCBzdGF0aWMgdm9pZCBoYXN3ZWxsX2NydGNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqb2xkX2NydGNfc3RhdGUsCj4gPiAgIAlpbnRlbF9kc2NfZGlzYWJsZShvbGRfY3J0Y19zdGF0
ZSk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiArCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gOSkKPiA+ICAgCQlza3lsYWtlX3NjYWxlcl9kaXNhYmxlKGludGVsX2NydGMp
Owo+ID4gICAJZWxzZQo+ID4gICAJCWlyb25sYWtlX3BmaXRfZGlzYWJsZShvbGRfY3J0Y19zdGF0
ZSk7Cj4gPiBAQCAtNjUzOSw3ICs2NTM5LDcgQEAgc3RhdGljIHZvaWQgaGFzd2VsbF9jcnRjX2Rp
c2FibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ID4gICBzdGF0
aWMgdm9pZCBpOXh4X3BmaXRfZW5hYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAlp
ZiAoIWNydGNfc3RhdGUtPmdtY2hfcGZpdC5jb250cm9sKQo+ID4gICAJCXJldHVybjsKPiA+IEBA
IC02NTQ5LDcgKzY1NDksNyBAQCBzdGF0aWMgdm9pZCBpOXh4X3BmaXRfZW5hYmxlKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICAJICogYWNjb3JkaW5nIHRv
IHJlZ2lzdGVyIGRlc2NyaXB0aW9uIGFuZCBQUk0uCj4gPiAgIAkgKi8KPiA+ICAgCVdBUk5fT04o
STkxNV9SRUFEKFBGSVRfQ09OVFJPTCkgJiBQRklUX0VOQUJMRSk7Cj4gPiAtCWFzc2VydF9waXBl
X2Rpc2FibGVkKGRldl9wcml2LCBjcnRjLT5waXBlKTsKPiA+ICsJYXNzZXJ0X3BpcGVfZGlzYWJs
ZWQoaTkxNSwgY3J0Yy0+cGlwZSk7Cj4gPiAgIAlJOTE1X1dSSVRFKFBGSVRfUEdNX1JBVElPUywg
Y3J0Y19zdGF0ZS0+Z21jaF9wZml0LnBnbV9yYXRpb3MpOwo+ID4gICAJSTkxNV9XUklURShQRklU
X0NPTlRST0wsIGNydGNfc3RhdGUtPmdtY2hfcGZpdC5jb250cm9sKTsKPiA+IEBAIC02NTU5LDMx
ICs2NTU5LDMxIEBAIHN0YXRpYyB2b2lkIGk5eHhfcGZpdF9lbmFibGUoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIAlJOTE1X1dSSVRFKEJDTFJQQVQoY3J0
Yy0+cGlwZSksIDApOwo+ID4gICB9Cj4gPiAtYm9vbCBpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpCj4gPiArYm9v
bCBpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBl
bnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+ID4gICAJaWYgKHBvcnQgPT0gUE9SVF9OT05FKQo+ID4g
ICAJCXJldHVybiBmYWxzZTsKPiA+IC0JaWYgKElTX0VMS0hBUlRMQUtFKGRldl9wcml2KSkKPiA+
ICsJaWYgKElTX0VMS0hBUlRMQUtFKGk5MTUpKQo+ID4gICAJCXJldHVybiBwb3J0IDw9IFBPUlRf
QzsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gPiArCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gMTEpCj4gPiAgIAkJcmV0dXJuIHBvcnQgPD0gUE9SVF9COwo+ID4gICAJcmV0
dXJuIGZhbHNlOwo+ID4gICB9Cj4gPiAtYm9vbCBpbnRlbF9wb3J0X2lzX3RjKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpCj4gPiArYm9vbCBpbnRlbF9w
b3J0X2lzX3RjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCkK
PiA+ICAgewo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSAmJiAhSVNfRUxLSEFS
VExBS0UoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExICYmICFJU19F
TEtIQVJUTEFLRShpOTE1KSkKPiA+ICAgCQlyZXR1cm4gcG9ydCA+PSBQT1JUX0MgJiYgcG9ydCA8
PSBQT1JUX0Y7Cj4gPiAgIAlyZXR1cm4gZmFsc2U7Cj4gPiAgIH0KPiA+IC1lbnVtIHRjX3BvcnQg
aW50ZWxfcG9ydF90b190YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0g
cG9ydCBwb3J0KQo+ID4gK2VudW0gdGNfcG9ydCBpbnRlbF9wb3J0X3RvX3RjKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+ID4gLQlpZiAoIWlu
dGVsX3BvcnRfaXNfdGMoZGV2X3ByaXYsIHBvcnQpKQo+ID4gKwlpZiAoIWludGVsX3BvcnRfaXNf
dGMoaTkxNSwgcG9ydCkpCj4gPiAgIAkJcmV0dXJuIFBPUlRfVENfTk9ORTsKPiA+ICAgCXJldHVy
biBwb3J0IC0gUE9SVF9DOwo+ID4gQEAgLTY2MzYsNyArNjYzNiw3IEBAIHN0YXRpYyB1NjQgZ2V0
X2NydGNfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gPiAgIAkJCQkgIHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+ZGV2Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVy
Owo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNy
dGMpOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBpbnRlbF9jcnRjLT5waXBlOwo+ID4gQEAgLTY2
NTgsNyArNjY1OCw3IEBAIHN0YXRpYyB1NjQgZ2V0X2NydGNfcG93ZXJfZG9tYWlucyhzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGMsCj4gPiAgIAkJbWFzayB8PSBCSVRfVUxMKGludGVsX2VuY29kZXItPnBv
d2VyX2RvbWFpbik7Cj4gPiAgIAl9Cj4gPiAtCWlmIChIQVNfRERJKGRldl9wcml2KSAmJiBjcnRj
X3N0YXRlLT5oYXNfYXVkaW8pCj4gPiArCWlmIChIQVNfRERJKGk5MTUpICYmIGNydGNfc3RhdGUt
Pmhhc19hdWRpbykKPiA+ICAgCQltYXNrIHw9IEJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVRElPKTsK
PiA+ICAgCWlmIChjcnRjX3N0YXRlLT5zaGFyZWRfZHBsbCkKPiA+IEBAIC02NjcxLDcgKzY2NzEs
NyBAQCBzdGF0aWMgdTY0Cj4gPiAgIG1vZGVzZXRfZ2V0X2NydGNfcG93ZXJfZG9tYWlucyhzdHJ1
Y3QgZHJtX2NydGMgKmNydGMsCj4gPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGNydGMtPmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmlu
dGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+ID4gICAJZW51bSBpbnRlbF9kaXNwbGF5
X3Bvd2VyX2RvbWFpbiBkb21haW47Cj4gPiAgIAl1NjQgZG9tYWlucywgbmV3X2RvbWFpbnMsIG9s
ZF9kb21haW5zOwo+ID4gQEAgLTY2ODMsMTggKzY2ODMsMTggQEAgbW9kZXNldF9nZXRfY3J0Y19w
b3dlcl9kb21haW5zKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKPiA+ICAgCWRvbWFpbnMgPSBuZXdf
ZG9tYWlucyAmIH5vbGRfZG9tYWluczsKPiA+ICAgCWZvcl9lYWNoX3Bvd2VyX2RvbWFpbihkb21h
aW4sIGRvbWFpbnMpCj4gPiAtCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwgZG9t
YWluKTsKPiA+ICsJCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5MTUsIGRvbWFpbik7Cj4gPiAg
IAlyZXR1cm4gb2xkX2RvbWFpbnMgJiB+bmV3X2RvbWFpbnM7Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
dm9pZCBtb2Rlc2V0X3B1dF9wb3dlcl9kb21haW5zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBtb2Rlc2V0X3B1dF9wb3dlcl9kb21haW5zKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgdTY0IGRvbWFpbnMpCj4g
PiAgIHsKPiA+ICAgCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluOwo+ID4g
ICAJZm9yX2VhY2hfcG93ZXJfZG9tYWluKGRvbWFpbiwgZG9tYWlucykKPiA+IC0JCWludGVsX2Rp
c3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChkZXZfcHJpdiwgZG9tYWluKTsKPiA+ICsJCWludGVs
X2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChpOTE1LCBkb21haW4pOwo+ID4gICB9Cj4gPiAg
IHN0YXRpYyB2b2lkIHZhbGxleXZpZXdfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKnBpcGVfY29uZmlnLAo+ID4gQEAgLTY3MDQsNyArNjcwNCw3IEBAIHN0YXRpYyB2b2lkIHZh
bGxleXZpZXdfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmln
LAo+ID4gICAJCXRvX2ludGVsX2F0b21pY19zdGF0ZShvbGRfc3RhdGUpOwo+ID4gICAJc3RydWN0
IGRybV9jcnRjICpjcnRjID0gcGlwZV9jb25maWctPmJhc2UuY3J0YzsKPiA+ICAgCXN0cnVjdCBk
cm1fZGV2aWNlICpkZXYgPSBjcnRjLT5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4gPiAgIAlpbnQgcGlwZSA9IGludGVsX2NydGMtPnBp
cGU7Cj4gPiBAQCAtNjcxNyw3ICs2NzE3LDcgQEAgc3RhdGljIHZvaWQgdmFsbGV5dmlld19jcnRj
X2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gPiAgIAlpbnRl
bF9zZXRfcGlwZV90aW1pbmdzKHBpcGVfY29uZmlnKTsKPiA+ICAgCWludGVsX3NldF9waXBlX3Ny
Y19zaXplKHBpcGVfY29uZmlnKTsKPiA+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpICYm
IHBpcGUgPT0gUElQRV9CKSB7Cj4gPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpICYmIHBpcGUg
PT0gUElQRV9CKSB7Cj4gPiAgIAkJSTkxNV9XUklURShDSFZfQkxFTkQocGlwZSksIENIVl9CTEVO
RF9MRUdBQ1kpOwo+ID4gICAJCUk5MTVfV1JJVEUoQ0hWX0NBTlZBUyhwaXBlKSwgMCk7Cj4gPiAg
IAl9Cj4gPiBAQCAtNjcyNiwxMSArNjcyNiwxMSBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2Ny
dGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiA+ICAgCWlu
dGVsX2NydGMtPmFjdGl2ZSA9IHRydWU7Cj4gPiAtCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1
bl9yZXBvcnRpbmcoZGV2X3ByaXYsIHBpcGUsIHRydWUpOwo+ID4gKwlpbnRlbF9zZXRfY3B1X2Zp
Zm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIHBpcGUsIHRydWUpOwo+ID4gICAJaW50ZWxfZW5j
b2RlcnNfcHJlX3BsbF9lbmFibGUoY3J0YywgcGlwZV9jb25maWcsIG9sZF9zdGF0ZSk7Cj4gPiAt
CWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfQ0hFUlJZVklFVyhp
OTE1KSkgewo+ID4gICAJCWNodl9wcmVwYXJlX3BsbChpbnRlbF9jcnRjLCBwaXBlX2NvbmZpZyk7
Cj4gPiAgIAkJY2h2X2VuYWJsZV9wbGwoaW50ZWxfY3J0YywgcGlwZV9jb25maWcpOwo+ID4gICAJ
fSBlbHNlIHsKPiA+IEBAIC02NzQ3LDcgKzY3NDcsNyBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3
X2NydGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiA+ICAg
CS8qIHVwZGF0ZSBEU1BDTlRSIHRvIGNvbmZpZ3VyZSBnYW1tYSBmb3IgcGlwZSBib3R0b20gY29s
b3IgKi8KPiA+ICAgCWludGVsX2Rpc2FibGVfcHJpbWFyeV9wbGFuZShwaXBlX2NvbmZpZyk7Cj4g
PiAtCWRldl9wcml2LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJrcyhvbGRfaW50ZWxfc3RhdGUs
Cj4gPiArCWk5MTUtPmRpc3BsYXkuaW5pdGlhbF93YXRlcm1hcmtzKG9sZF9pbnRlbF9zdGF0ZSwK
PiA+ICAgCQkJCQkgICAgIHBpcGVfY29uZmlnKTsKPiA+ICAgCWludGVsX2VuYWJsZV9waXBlKHBp
cGVfY29uZmlnKTsKPiA+IEBAIC02NzYwLDcgKzY3NjAsNyBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2
aWV3X2NydGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiA+
ICAgc3RhdGljIHZvaWQgaTl4eF9zZXRfcGxsX2RpdmlkZXJzKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Cj4gPiAgIAlJOTE1X1dSSVRFKEZQMChjcnRjLT5waXBlKSwgY3J0Y19zdGF0ZS0+ZHBsbF9o
d19zdGF0ZS5mcDApOwo+ID4gICAJSTkxNV9XUklURShGUDEoY3J0Yy0+cGlwZSksIGNydGNfc3Rh
dGUtPmRwbGxfaHdfc3RhdGUuZnAxKTsKPiA+IEBAIC02NzczLDcgKzY3NzMsNyBAQCBzdGF0aWMg
dm9pZCBpOXh4X2NydGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZp
ZywKPiA+ICAgCQl0b19pbnRlbF9hdG9taWNfc3RhdGUob2xkX3N0YXRlKTsKPiA+ICAgCXN0cnVj
dCBkcm1fY3J0YyAqY3J0YyA9IHBpcGVfY29uZmlnLT5iYXNlLmNydGM7Cj4gPiAgIAlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+ZGV2Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2Ny
dGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBpbnRlbF9j
cnRjLT5waXBlOwo+ID4gQEAgLTY3OTIsOCArNjc5Miw4IEBAIHN0YXRpYyB2b2lkIGk5eHhfY3J0
Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ID4gICAJaW50
ZWxfY3J0Yy0+YWN0aXZlID0gdHJ1ZTsKPiA+IC0JaWYgKCFJU19HRU4oZGV2X3ByaXYsIDIpKQo+
ID4gLQkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgcGlw
ZSwgdHJ1ZSk7Cj4gPiArCWlmICghSVNfR0VOKGk5MTUsIDIpKQo+ID4gKwkJaW50ZWxfc2V0X2Nw
dV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBwaXBlLCB0cnVlKTsKPiA+ICAgCWludGVs
X2VuY29kZXJzX3ByZV9lbmFibGUoY3J0YywgcGlwZV9jb25maWcsIG9sZF9zdGF0ZSk7Cj4gPiBA
QCAtNjgwNiw4ICs2ODA2LDggQEAgc3RhdGljIHZvaWQgaTl4eF9jcnRjX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gPiAgIAkvKiB1cGRhdGUgRFNQQ05UUiB0
byBjb25maWd1cmUgZ2FtbWEgZm9yIHBpcGUgYm90dG9tIGNvbG9yICovCj4gPiAgIAlpbnRlbF9k
aXNhYmxlX3ByaW1hcnlfcGxhbmUocGlwZV9jb25maWcpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmRp
c3BsYXkuaW5pdGlhbF93YXRlcm1hcmtzICE9IE5VTEwpCj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxh
eS5pbml0aWFsX3dhdGVybWFya3Mob2xkX2ludGVsX3N0YXRlLAo+ID4gKwlpZiAoaTkxNS0+ZGlz
cGxheS5pbml0aWFsX3dhdGVybWFya3MgIT0gTlVMTCkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuaW5p
dGlhbF93YXRlcm1hcmtzKG9sZF9pbnRlbF9zdGF0ZSwKPiA+ICAgCQkJCQkJICAgICBwaXBlX2Nv
bmZpZyk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJaW50ZWxfdXBkYXRlX3dhdGVybWFya3MoaW50ZWxf
Y3J0Yyk7Cj4gPiBAQCAtNjgyMiwxMiArNjgyMiwxMiBAQCBzdGF0aWMgdm9pZCBpOXh4X2NydGNf
ZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiA+ICAgc3RhdGlj
IHZvaWQgaTl4eF9wZml0X2Rpc2FibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9s
ZF9jcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ID4gICAJaWYgKCFvbGRfY3J0Y19zdGF0ZS0+Z21jaF9wZml0LmNvbnRyb2wpCj4gPiAgIAkJcmV0
dXJuOwo+ID4gLQlhc3NlcnRfcGlwZV9kaXNhYmxlZChkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4g
PiArCWFzc2VydF9waXBlX2Rpc2FibGVkKGk5MTUsIGNydGMtPnBpcGUpOwo+ID4gICAJRFJNX0RF
QlVHX0tNUygiZGlzYWJsaW5nIHBmaXQsIGN1cnJlbnQ6IDB4JTA4eFxuIiwKPiA+ICAgCQkgICAg
ICBJOTE1X1JFQUQoUEZJVF9DT05UUk9MKSk7Cj4gPiBAQCAtNjgzOSw3ICs2ODM5LDcgQEAgc3Rh
dGljIHZvaWQgaTl4eF9jcnRjX2Rpc2FibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3N0YXRlLAo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBvbGRfY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjOwo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMt
PmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShk
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRj
KTsKPiA+ICAgCWludCBwaXBlID0gaW50ZWxfY3J0Yy0+cGlwZTsKPiA+IEBAIC02ODQ3LDggKzY4
NDcsOCBAQCBzdGF0aWMgdm9pZCBpOXh4X2NydGNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4gPiAgIAkgKiBPbiBnZW4yIHBsYW5lcyBhcmUgZG91Ymxl
IGJ1ZmZlcmVkIGJ1dCB0aGUgcGlwZSBpc24ndCwgc28gd2UgbXVzdAo+ID4gICAJICogd2FpdCBm
b3IgcGxhbmVzIHRvIGZ1bGx5IHR1cm4gb2ZmIGJlZm9yZSBkaXNhYmxpbmcgdGhlIHBpcGUuCj4g
PiAgIAkgKi8KPiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgMikpCj4gPiAtCQlpbnRlbF93YWl0
X2Zvcl92YmxhbmsoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDIpKQo+
ID4gKwkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsIHBpcGUpOwo+ID4gICAJaW50ZWxfZW5j
b2RlcnNfZGlzYWJsZShjcnRjLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX3N0YXRlKTsKPiA+IEBAIC02
ODYyLDI1ICs2ODYyLDI1IEBAIHN0YXRpYyB2b2lkIGk5eHhfY3J0Y19kaXNhYmxlKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPiA+ICAgCWludGVsX2VuY29kZXJzX3Bv
c3RfZGlzYWJsZShjcnRjLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX3N0YXRlKTsKPiA+ICAgCWlmICgh
aW50ZWxfY3J0Y19oYXNfdHlwZShvbGRfY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0RTSSkpIHsK
PiA+IC0JCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+IC0JCQljaHZfZGlzYWJsZV9w
bGwoZGV2X3ByaXYsIHBpcGUpOwo+ID4gLQkJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJp
dikpCj4gPiAtCQkJdmx2X2Rpc2FibGVfcGxsKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJCWlmIChJ
U19DSEVSUllWSUVXKGk5MTUpKQo+ID4gKwkJCWNodl9kaXNhYmxlX3BsbChpOTE1LCBwaXBlKTsK
PiA+ICsJCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCj4gPiArCQkJdmx2X2Rpc2FibGVf
cGxsKGk5MTUsIHBpcGUpOwo+ID4gICAJCWVsc2UKPiA+ICAgCQkJaTl4eF9kaXNhYmxlX3BsbChv
bGRfY3J0Y19zdGF0ZSk7Cj4gPiAgIAl9Cj4gPiAgIAlpbnRlbF9lbmNvZGVyc19wb3N0X3BsbF9k
aXNhYmxlKGNydGMsIG9sZF9jcnRjX3N0YXRlLCBvbGRfc3RhdGUpOwo+ID4gLQlpZiAoIUlTX0dF
TihkZXZfcHJpdiwgMikpCj4gPiAtCQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0
aW5nKGRldl9wcml2LCBwaXBlLCBmYWxzZSk7Cj4gPiArCWlmICghSVNfR0VOKGk5MTUsIDIpKQo+
ID4gKwkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBwaXBlLCBm
YWxzZSk7Cj4gPiAtCWlmICghZGV2X3ByaXYtPmRpc3BsYXkuaW5pdGlhbF93YXRlcm1hcmtzKQo+
ID4gKwlpZiAoIWk5MTUtPmRpc3BsYXkuaW5pdGlhbF93YXRlcm1hcmtzKQo+ID4gICAJCWludGVs
X3VwZGF0ZV93YXRlcm1hcmtzKGludGVsX2NydGMpOwo+ID4gICAJLyogY2xvY2sgdGhlIHBpcGUg
ZG93biB0byA2NDB4NDgwQDYwIHRvIHBvdGVudGlhbGx5IHNhdmUgcG93ZXIgKi8KPiA+IC0JaWYg
KElTX0k4MzAoZGV2X3ByaXYpKQo+ID4gLQkJaTgzMF9lbmFibGVfcGlwZShkZXZfcHJpdiwgcGlw
ZSk7Cj4gPiArCWlmIChJU19JODMwKGk5MTUpKQo+ID4gKwkJaTgzMF9lbmFibGVfcGlwZShpOTE1
LCBwaXBlKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2Rpc2FibGVfbm9h
dG9taWMoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ID4gQEAgLTY4ODgsOSArNjg4OCw5IEBAIHN0
YXRpYyB2b2lkIGludGVsX2NydGNfZGlzYWJsZV9ub2F0b21pYyhzdHJ1Y3QgZHJtX2NydGMgKmNy
dGMsCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ID4gICAJ
c3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5kZXYp
Owo+ID4gICAJc3RydWN0IGludGVsX2J3X3N0YXRlICpid19zdGF0ZSA9Cj4gPiAtCQl0b19pbnRl
bF9id19zdGF0ZShkZXZfcHJpdi0+Yndfb2JqLnN0YXRlKTsKPiA+ICsJCXRvX2ludGVsX2J3X3N0
YXRlKGk5MTUtPmJ3X29iai5zdGF0ZSk7Cj4gPiAgIAllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJf
ZG9tYWluIGRvbWFpbjsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmU7Cj4gPiAgIAl1
NjQgZG9tYWluczsKPiA+IEBAIC02OTAxLDcgKzY5MDEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9j
cnRjX2Rpc2FibGVfbm9hdG9taWMoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ID4gICAJaWYgKCFp
bnRlbF9jcnRjLT5hY3RpdmUpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9w
bGFuZV9vbl9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBpbnRlbF9jcnRjLCBwbGFuZSkgewo+ID4gKwlm
b3JfZWFjaF9pbnRlbF9wbGFuZV9vbl9jcnRjKCZpOTE1LT5kcm0sIGludGVsX2NydGMsIHBsYW5l
KSB7Cj4gPiAgIAkJY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSA9
Cj4gPiAgIAkJCXRvX2ludGVsX3BsYW5lX3N0YXRlKHBsYW5lLT5iYXNlLnN0YXRlKTsKPiA+IEBA
IC02OTI0LDcgKzY5MjQsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2Rpc2FibGVfbm9hdG9t
aWMoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ID4gICAJV0FSTl9PTihJU19FUlIoY3J0Y19zdGF0
ZSkgfHwgcmV0KTsKPiA+IC0JZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19kaXNhYmxlKGNydGNfc3Rh
dGUsIHN0YXRlKTsKPiA+ICsJaTkxNS0+ZGlzcGxheS5jcnRjX2Rpc2FibGUoY3J0Y19zdGF0ZSwg
c3RhdGUpOwo+ID4gICAJZHJtX2F0b21pY19zdGF0ZV9wdXQoc3RhdGUpOwo+ID4gQEAgLTY5NDcs
MTIgKzY5NDcsMTIgQEAgc3RhdGljIHZvaWQgaW50ZWxfY3J0Y19kaXNhYmxlX25vYXRvbWljKHN0
cnVjdCBkcm1fY3J0YyAqY3J0YywKPiA+ICAgCWRvbWFpbnMgPSBpbnRlbF9jcnRjLT5lbmFibGVk
X3Bvd2VyX2RvbWFpbnM7Cj4gPiAgIAlmb3JfZWFjaF9wb3dlcl9kb21haW4oZG9tYWluLCBkb21h
aW5zKQo+ID4gLQkJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKGRldl9wcml2LCBk
b21haW4pOwo+ID4gKwkJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKGk5MTUsIGRv
bWFpbik7Cj4gPiAgIAlpbnRlbF9jcnRjLT5lbmFibGVkX3Bvd2VyX2RvbWFpbnMgPSAwOwo+ID4g
LQlkZXZfcHJpdi0+YWN0aXZlX2NydGNzICY9IH4oMSA8PCBpbnRlbF9jcnRjLT5waXBlKTsKPiA+
IC0JZGV2X3ByaXYtPm1pbl9jZGNsa1tpbnRlbF9jcnRjLT5waXBlXSA9IDA7Cj4gPiAtCWRldl9w
cml2LT5taW5fdm9sdGFnZV9sZXZlbFtpbnRlbF9jcnRjLT5waXBlXSA9IDA7Cj4gPiArCWk5MTUt
PmFjdGl2ZV9jcnRjcyAmPSB+KDEgPDwgaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gPiArCWk5MTUtPm1p
bl9jZGNsa1tpbnRlbF9jcnRjLT5waXBlXSA9IDA7Cj4gPiArCWk5MTUtPm1pbl92b2x0YWdlX2xl
dmVsW2ludGVsX2NydGMtPnBpcGVdID0gMDsKPiA+ICAgCWJ3X3N0YXRlLT5kYXRhX3JhdGVbaW50
ZWxfY3J0Yy0+cGlwZV0gPSAwOwo+ID4gICAJYndfc3RhdGUtPm51bV9hY3RpdmVfcGxhbmVzW2lu
dGVsX2NydGMtPnBpcGVdID0gMDsKPiA+IEBAIC02OTY0LDcgKzY5NjQsNyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9jcnRjX2Rpc2FibGVfbm9hdG9taWMoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ID4g
ICAgKi8KPiA+ICAgaW50IGludGVsX2Rpc3BsYXlfc3VzcGVuZChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGRldik7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGU7Cj4gPiAgIAlpbnQg
cmV0Owo+ID4gQEAgLTY5NzMsNyArNjk3Myw3IEBAIGludCBpbnRlbF9kaXNwbGF5X3N1c3BlbmQo
c3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJRFJNX0VSUk9S
KCJTdXNwZW5kaW5nIGNydGMncyBmYWlsZWQgd2l0aCAlaVxuIiwgcmV0KTsKPiA+ICAgCWVsc2UK
PiA+IC0JCWRldl9wcml2LT5tb2Rlc2V0X3Jlc3RvcmVfc3RhdGUgPSBzdGF0ZTsKPiA+ICsJCWk5
MTUtPm1vZGVzZXRfcmVzdG9yZV9zdGF0ZSA9IHN0YXRlOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+
ICAgfQo+ID4gQEAgLTcwMzUsNyArNzAzNSw3IEBAIHN0YXRpYyBpbnQgcGlwZV9yZXF1aXJlZF9m
ZGlfbGFuZXMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHN0YXRp
YyBpbnQgaXJvbmxha2VfY2hlY2tfZmRpX2xhbmVzKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIGVu
dW0gcGlwZSBwaXBlLAo+ID4gICAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlw
ZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IHBpcGVf
Y29uZmlnLT5iYXNlLnN0YXRlOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKm90aGVyX2NydGM7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb3RoZXJfY3J0Y19zdGF0ZTsKPiA+IEBA
IC03MDQ4LDcgKzcwNDgsNyBAQCBzdGF0aWMgaW50IGlyb25sYWtlX2NoZWNrX2ZkaV9sYW5lcyhz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBlbnVtIHBpcGUgcGlwZSwKPiA+ICAgCQlyZXR1cm4gLUVJ
TlZBTDsKPiA+ICAgCX0KPiA+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FE
V0VMTChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURX
RUxMKGk5MTUpKSB7Cj4gPiAgIAkJaWYgKHBpcGVfY29uZmlnLT5mZGlfbGFuZXMgPiAyKSB7Cj4g
PiAgIAkJCURSTV9ERUJVR19LTVMoIm9ubHkgMiBsYW5lcyBvbiBoYXN3ZWxsLCByZXF1aXJlZDog
JWkgbGFuZXNcbiIsCj4gPiAgIAkJCQkgICAgICBwaXBlX2NvbmZpZy0+ZmRpX2xhbmVzKTsKPiA+
IEBAIC03MDU4LDcgKzcwNTgsNyBAQCBzdGF0aWMgaW50IGlyb25sYWtlX2NoZWNrX2ZkaV9sYW5l
cyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBlbnVtIHBpcGUgcGlwZSwKPiA+ICAgCQl9Cj4gPiAg
IAl9Cj4gPiAtCWlmIChJTlRFTF9JTkZPKGRldl9wcml2KS0+bnVtX3BpcGVzID09IDIpCj4gPiAr
CWlmIChJTlRFTF9JTkZPKGk5MTUpLT5udW1fcGlwZXMgPT0gMikKPiA+ICAgCQlyZXR1cm4gMDsK
PiA+ICAgCS8qIEl2eWJyaWRnZSAzIHBpcGUgaXMgcmVhbGx5IGNvbXBsaWNhdGVkICovCj4gPiBA
QCAtNzA2OSw3ICs3MDY5LDcgQEAgc3RhdGljIGludCBpcm9ubGFrZV9jaGVja19mZGlfbGFuZXMo
c3RydWN0IGRybV9kZXZpY2UgKmRldiwgZW51bSBwaXBlIHBpcGUsCj4gPiAgIAkJaWYgKHBpcGVf
Y29uZmlnLT5mZGlfbGFuZXMgPD0gMikKPiA+ICAgCQkJcmV0dXJuIDA7Cj4gPiAtCQlvdGhlcl9j
cnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIFBJUEVfQyk7Cj4gPiArCQlv
dGhlcl9jcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoaTkxNSwgUElQRV9DKTsKPiA+ICAg
CQlvdGhlcl9jcnRjX3N0YXRlID0KPiA+ICAgCQkJaW50ZWxfYXRvbWljX2dldF9jcnRjX3N0YXRl
KHN0YXRlLCBvdGhlcl9jcnRjKTsKPiA+ICAgCQlpZiAoSVNfRVJSKG90aGVyX2NydGNfc3RhdGUp
KQo+ID4gQEAgLTcwODgsNyArNzA4OCw3IEBAIHN0YXRpYyBpbnQgaXJvbmxha2VfY2hlY2tfZmRp
X2xhbmVzKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIGVudW0gcGlwZSBwaXBlLAo+ID4gICAJCQly
ZXR1cm4gLUVJTlZBTDsKPiA+ICAgCQl9Cj4gPiAtCQlvdGhlcl9jcnRjID0gaW50ZWxfZ2V0X2Ny
dGNfZm9yX3BpcGUoZGV2X3ByaXYsIFBJUEVfQik7Cj4gPiArCQlvdGhlcl9jcnRjID0gaW50ZWxf
Z2V0X2NydGNfZm9yX3BpcGUoaTkxNSwgUElQRV9CKTsKPiA+ICAgCQlvdGhlcl9jcnRjX3N0YXRl
ID0KPiA+ICAgCQkJaW50ZWxfYXRvbWljX2dldF9jcnRjX3N0YXRlKHN0YXRlLCBvdGhlcl9jcnRj
KTsKPiA+ICAgCQlpZiAoSVNfRVJSKG90aGVyX2NydGNfc3RhdGUpKQo+ID4gQEAgLTcxNTYsNyAr
NzE1Niw3IEBAIHN0YXRpYyBpbnQgaXJvbmxha2VfZmRpX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBp
bnRlbF9jcnRjICppbnRlbF9jcnRjLAo+ID4gICBib29sIGhzd19jcnRjX3N0YXRlX2lwc19jYXBh
YmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAkvKiBJUFMgb25seSBleGlzdHMgb24g
VUxUIG1hY2hpbmVzIGFuZCBpcyB0aWVkIHRvIHBpcGUgQS4gKi8KPiA+ICAgCWlmICghaHN3X2Ny
dGNfc3VwcG9ydHNfaXBzKGNydGMpKQo+ID4gQEAgLTcxNzUsOCArNzE3NSw4IEBAIGJvb2wgaHN3
X2NydGNfc3RhdGVfaXBzX2NhcGFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4gPiAgIAkgKgo+ID4gICAJICogU2hvdWxkIG1lYXN1cmUgd2hldGhlciB1c2lu
ZyBhIGxvd2VyIGNkY2xrIHcvbyBJUFMKPiA+ICAgCSAqLwo+ID4gLQlpZiAoSVNfQlJPQURXRUxM
KGRldl9wcml2KSAmJgo+ID4gLQkgICAgY3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZSA+IGRldl9wcml2
LT5tYXhfY2RjbGtfZnJlcSAqIDk1IC8gMTAwKQo+ID4gKwlpZiAoSVNfQlJPQURXRUxMKGk5MTUp
ICYmCj4gPiArCSAgICBjcnRjX3N0YXRlLT5waXhlbF9yYXRlID4gaTkxNS0+bWF4X2NkY2xrX2Zy
ZXEgKiA5NSAvIDEwMCkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAlyZXR1cm4gdHJ1ZTsK
PiA+IEBAIC03MTg0LDcgKzcxODQsNyBAQCBib29sIGhzd19jcnRjX3N0YXRlX2lwc19jYXBhYmxl
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICBzdGF0aWMg
Ym9vbCBoc3dfY29tcHV0ZV9pcHNfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0KPiA+ICAgCQl0b19pOTE1KGNy
dGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3Rh
dGUgKmludGVsX3N0YXRlID0KPiA+ICAgCQl0b19pbnRlbF9hdG9taWNfc3RhdGUoY3J0Y19zdGF0
ZS0+YmFzZS5zdGF0ZSk7Cj4gPiBAQCAtNzIwNiw3ICs3MjA2LDcgQEAgc3RhdGljIGJvb2wgaHN3
X2NvbXB1dGVfaXBzX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAkvKiBwaXhlbCByYXRlIG11c3RuJ3QgZXhjZWVk
IDk1JSBvZiBjZGNsayB3aXRoIElQUyBvbiBCRFcgKi8KPiA+IC0JaWYgKElTX0JST0FEV0VMTChk
ZXZfcHJpdikgJiYKPiA+ICsJaWYgKElTX0JST0FEV0VMTChpOTE1KSAmJgo+ID4gICAJICAgIGNy
dGNfc3RhdGUtPnBpeGVsX3JhdGUgPiBpbnRlbF9zdGF0ZS0+Y2RjbGsubG9naWNhbC5jZGNsayAq
IDk1IC8gMTAwKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IEBAIC03MjE1LDExICs3MjE1LDEx
IEBAIHN0YXRpYyBib29sIGhzd19jb21wdXRlX2lwc19jb25maWcoc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHN0YXRpYyBib29sIGludGVsX2NydGNfc3VwcG9ydHNf
ZG91YmxlX3dpZGUoY29uc3Qgc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIHsKPiA+IC0J
Y29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gPiArCWNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAkvKiBHREcgZG91YmxlIHdpZGUgb24gZWl0aGVy
IHBpcGUsIG90aGVyd2lzZSBwaXBlIEEgb25seSAqLwo+ID4gLQlyZXR1cm4gSU5URUxfR0VOKGRl
dl9wcml2KSA8IDQgJiYKPiA+IC0JCShjcnRjLT5waXBlID09IFBJUEVfQSB8fCBJU19JOTE1Ryhk
ZXZfcHJpdikpOwo+ID4gKwlyZXR1cm4gSU5URUxfR0VOKGk5MTUpIDwgNCAmJgo+ID4gKwkJKGNy
dGMtPnBpcGUgPT0gUElQRV9BIHx8IElTX0k5MTVHKGk5MTUpKTsKPiA+ICAgfQo+ID4gICBzdGF0
aWMgdTMyIGlsa19waXBlX3BpeGVsX3JhdGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KnBpcGVfY29uZmlnKQo+ID4gQEAgLTcyNTksOSArNzI1OSw5IEBAIHN0YXRpYyB1MzIgaWxrX3Bp
cGVfcGl4ZWxfcmF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcp
Cj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2NydGNfY29tcHV0ZV9waXhlbF9yYXRlKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gLQlpZiAoSEFTX0dNQ0goZGV2X3ByaXYpKQo+ID4gKwlp
ZiAoSEFTX0dNQ0goaTkxNSkpCj4gPiAgIAkJLyogRklYTUUgY2FsY3VsYXRlIHByb3BlciBwaXBl
IHBpeGVsIHJhdGUgZm9yIEdNQ0ggcGZpdCAqLwo+ID4gICAJCWNydGNfc3RhdGUtPnBpeGVsX3Jh
dGUgPQo+ID4gICAJCQljcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19jbG9jazsK
PiA+IEBAIC03MjczLDEyICs3MjczLDEyIEBAIHN0YXRpYyB2b2lkIGludGVsX2NydGNfY29tcHV0
ZV9waXhlbF9yYXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICBz
dGF0aWMgaW50IGludGVsX2NydGNfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2NydGMgKmNy
dGMsCj4gPiAgIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4g
PiAtCWludCBjbG9ja19saW1pdCA9IGRldl9wcml2LT5tYXhfZG90Y2xrX2ZyZXE7Cj4gPiArCWlu
dCBjbG9ja19saW1pdCA9IGk5MTUtPm1heF9kb3RjbGtfZnJlcTsKPiA+IC0JaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPCA0KSB7Cj4gPiAtCQljbG9ja19saW1pdCA9IGRldl9wcml2LT5tYXhfY2Rj
bGtfZnJlcSAqIDkgLyAxMDsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDQpIHsKPiA+ICsJ
CWNsb2NrX2xpbWl0ID0gaTkxNS0+bWF4X2NkY2xrX2ZyZXEgKiA5IC8gMTA7Cj4gPiAgIAkJLyoK
PiA+ICAgCQkgKiBFbmFibGUgZG91YmxlIHdpZGUgbW9kZSB3aGVuIHRoZSBkb3QgY2xvY2sKPiA+
IEBAIC03Mjg2LDcgKzcyODYsNyBAQCBzdGF0aWMgaW50IGludGVsX2NydGNfY29tcHV0ZV9jb25m
aWcoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJICovCj4gPiAgIAkJaWYgKGludGVs
X2NydGNfc3VwcG9ydHNfZG91YmxlX3dpZGUoY3J0YykgJiYKPiA+ICAgCQkgICAgYWRqdXN0ZWRf
bW9kZS0+Y3J0Y19jbG9jayA+IGNsb2NrX2xpbWl0KSB7Cj4gPiAtCQkJY2xvY2tfbGltaXQgPSBk
ZXZfcHJpdi0+bWF4X2RvdGNsa19mcmVxOwo+ID4gKwkJCWNsb2NrX2xpbWl0ID0gaTkxNS0+bWF4
X2RvdGNsa19mcmVxOwo+ID4gICAJCQlwaXBlX2NvbmZpZy0+ZG91YmxlX3dpZGUgPSB0cnVlOwo+
ID4gICAJCX0KPiA+ICAgCX0KPiA+IEBAIC03MzIzLDcgKzczMjMsNyBAQCBzdGF0aWMgaW50IGlu
dGVsX2NydGNfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJ
fQo+ID4gICAJCWlmIChpbnRlbF9jcnRjX2hhc190eXBlKHBpcGVfY29uZmlnLCBJTlRFTF9PVVRQ
VVRfTFZEUykgJiYKPiA+IC0JCSAgICBpbnRlbF9pc19kdWFsX2xpbmtfbHZkcyhkZXZfcHJpdikp
IHsKPiA+ICsJCSAgICBpbnRlbF9pc19kdWFsX2xpbmtfbHZkcyhpOTE1KSkgewo+ID4gICAJCQlE
Uk1fREVCVUdfS01TKCJPZGQgcGlwZSBzb3VyY2Ugd2lkdGggbm90IHN1cHBvcnRlZCB3aXRoIGR1
YWwgbGluayBMVkRTXG4iKTsKPiA+ICAgCQkJcmV0dXJuIC1FSU5WQUw7Cj4gPiAgIAkJfQo+ID4g
QEAgLTczMzIsNyArNzMzMiw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19jb21wdXRlX2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCS8qIENhbnRpZ2ErIGNhbm5vdCBoYW5k
bGUgbW9kZXMgd2l0aCBhIGhzeW5jIGZyb250IHBvcmNoIG9mIDAuCj4gPiAgIAkgKiBXYVBydW5l
TW9kZVdpdGhJbmNvcnJlY3RIc3luY09mZnNldDpjdGcsZWxrLGlsayxzbmIsaXZiLHZsdixoc3cu
Cj4gPiAgIAkgKi8KPiA+IC0JaWYgKChJTlRFTF9HRU4oZGV2X3ByaXYpID4gNCB8fCBJU19HNFgo
ZGV2X3ByaXYpKSAmJgo+ID4gKwlpZiAoKElOVEVMX0dFTihpOTE1KSA+IDQgfHwgSVNfRzRYKGk5
MTUpKSAmJgo+ID4gICAJCWFkanVzdGVkX21vZGUtPmNydGNfaHN5bmNfc3RhcnQgPT0gYWRqdXN0
ZWRfbW9kZS0+Y3J0Y19oZGlzcGxheSkKPiA+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+IEBAIC03
MzkyLDEyICs3MzkyLDEyIEBAIGludGVsX2xpbmtfY29tcHV0ZV9tX24odTE2IGJpdHNfcGVyX3Bp
eGVsLCBpbnQgbmxhbmVzLAo+ID4gICAJCSAgICBjb25zdGFudF9uKTsKPiA+ICAgfQo+ID4gLXN0
YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9wYW5lbF91c2Vfc3NjKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfcGFuZWxfdXNlX3Nz
YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJaWYgKGk5MTVf
bW9kcGFyYW1zLnBhbmVsX3VzZV9zc2MgPj0gMCkKPiA+ICAgCQlyZXR1cm4gaTkxNV9tb2RwYXJh
bXMucGFuZWxfdXNlX3NzYyAhPSAwOwo+ID4gLQlyZXR1cm4gZGV2X3ByaXYtPnZidC5sdmRzX3Vz
ZV9zc2MKPiA+IC0JCSYmICEoZGV2X3ByaXYtPnF1aXJrcyAmIFFVSVJLX0xWRFNfU1NDX0RJU0FC
TEUpOwo+ID4gKwlyZXR1cm4gaTkxNS0+dmJ0Lmx2ZHNfdXNlX3NzYwo+ID4gKwkJJiYgIShpOTE1
LT5xdWlya3MgJiBRVUlSS19MVkRTX1NTQ19ESVNBQkxFKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMg
dTMyIHBudl9kcGxsX2NvbXB1dGVfZnAoc3RydWN0IGRwbGwgKmRwbGwpCj4gPiBAQCAtNzQxNCwx
MCArNzQxNCwxMCBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV9wbGxfZGl2aWRlcnMoc3RydWN0
IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+ID4gICAJCQkJICAgICBzdHJ1Y3QgZHBsbCAqcmVkdWNlZF9jbG9jaykK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCXUzMiBmcCwgZnAyID0gMDsKPiA+IC0JaWYg
KElTX1BJTkVWSUVXKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfUElORVZJRVcoaTkxNSkpIHsK
PiA+ICAgCQlmcCA9IHBudl9kcGxsX2NvbXB1dGVfZnAoJmNydGNfc3RhdGUtPmRwbGwpOwo+ID4g
ICAJCWlmIChyZWR1Y2VkX2Nsb2NrKQo+ID4gICAJCQlmcDIgPSBwbnZfZHBsbF9jb21wdXRlX2Zw
KHJlZHVjZWRfY2xvY2spOwo+ID4gQEAgLTc0MzcsNyArNzQzNyw3IEBAIHN0YXRpYyB2b2lkIGk5
eHhfdXBkYXRlX3BsbF9kaXZpZGVycyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCX0K
PiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHZsdl9wbGxiX3JlY2FsX29wYW1wKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlCj4gPiArc3RhdGljIHZvaWQgdmx2X3Bs
bGJfcmVjYWxfb3BhbXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcGlwZQo+
ID4gICAJCXBpcGUpCj4gPiAgIHsKPiA+ICAgCXUzMiByZWdfdmFsOwo+ID4gQEAgLTc0NDYsMzEg
Kzc0NDYsMzEgQEAgc3RhdGljIHZvaWQgdmx2X3BsbGJfcmVjYWxfb3BhbXAoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUKPiA+ICAgCSAqIFBMTEIgb3BhbXAgYWx3
YXlzIGNhbGlicmF0ZXMgdG8gbWF4IHZhbHVlIG9mIDB4M2YsIGZvcmNlIGVuYWJsZSBpdAo+ID4g
ICAJICogYW5kIHNldCBpdCB0byBhIHJlYXNvbmFibGUgdmFsdWUgaW5zdGVhZC4KPiA+ICAgCSAq
Lwo+ID4gLQlyZWdfdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9E
VzkoMSkpOwo+ID4gKwlyZWdfdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBWTFZfUExM
X0RXOSgxKSk7Cj4gPiAgIAlyZWdfdmFsICY9IDB4ZmZmZmZmMDA7Cj4gPiAgIAlyZWdfdmFsIHw9
IDB4MDAwMDAwMzA7Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUExM
X0RXOSgxKSwgcmVnX3ZhbCk7Cj4gPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9Q
TExfRFc5KDEpLCByZWdfdmFsKTsKPiA+IC0JcmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3By
aXYsIHBpcGUsIFZMVl9SRUZfRFcxMyk7Cj4gPiArCXJlZ192YWwgPSB2bHZfZHBpb19yZWFkKGk5
MTUsIHBpcGUsIFZMVl9SRUZfRFcxMyk7Cj4gPiAgIAlyZWdfdmFsICY9IDB4MDBmZmZmZmY7Cj4g
PiAgIAlyZWdfdmFsIHw9IDB4OGMwMDAwMDA7Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2
LCBwaXBlLCBWTFZfUkVGX0RXMTMsIHJlZ192YWwpOwo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1
LCBwaXBlLCBWTFZfUkVGX0RXMTMsIHJlZ192YWwpOwo+ID4gLQlyZWdfdmFsID0gdmx2X2RwaW9f
cmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzkoMSkpOwo+ID4gKwlyZWdfdmFsID0gdmx2
X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBWTFZfUExMX0RXOSgxKSk7Cj4gPiAgIAlyZWdfdmFsICY9
IDB4ZmZmZmZmMDA7Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUExM
X0RXOSgxKSwgcmVnX3ZhbCk7Cj4gPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9Q
TExfRFc5KDEpLCByZWdfdmFsKTsKPiA+IC0JcmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3By
aXYsIHBpcGUsIFZMVl9SRUZfRFcxMyk7Cj4gPiArCXJlZ192YWwgPSB2bHZfZHBpb19yZWFkKGk5
MTUsIHBpcGUsIFZMVl9SRUZfRFcxMyk7Cj4gPiAgIAlyZWdfdmFsICY9IDB4MDBmZmZmZmY7Cj4g
PiAgIAlyZWdfdmFsIHw9IDB4YjAwMDAwMDA7Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2
LCBwaXBlLCBWTFZfUkVGX0RXMTMsIHJlZ192YWwpOwo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1
LCBwaXBlLCBWTFZfUkVGX0RXMTMsIHJlZ192YWwpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lk
IGludGVsX3BjaF90cmFuc2NvZGVyX3NldF9tX24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9saW5rX21fbiAq
bV9uKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBp
cGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAlJOTE1X1dSSVRFKFBDSF9UUkFOU19EQVRBX00x
KHBpcGUpLCBUVV9TSVpFKG1fbi0+dHUpIHwgbV9uLT5nbWNoX20pOwo+ID4gQEAgLTc0NzksMTcg
Kzc0NzksMTcgQEAgc3RhdGljIHZvaWQgaW50ZWxfcGNoX3RyYW5zY29kZXJfc2V0X21fbihjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGEKPiA+ICAgCUk5MTVfV1JJVEUoUENI
X1RSQU5TX0xJTktfTjEocGlwZSksIG1fbi0+bGlua19uKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBi
b29sIHRyYW5zY29kZXJfaGFzX20yX24yKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICtzdGF0aWMgYm9vbCB0cmFuc2NvZGVyX2hhc19tMl9uMihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSBlbnVtIHRyYW5zY29kZXIgdHJhbnNjb2RlcikKPiA+
ICAgewo+ID4gLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikpCj4gPiArCWlmIChJU19IQVNXRUxM
KGk5MTUpKQo+ID4gICAJCXJldHVybiB0cmFuc2NvZGVyID09IFRSQU5TQ09ERVJfRURQOwo+ID4g
ICAJLyoKPiA+ICAgCSAqIFN0cmljdGx5IHNwZWFraW5nIHNvbWUgcmVnaXN0ZXJzIGFyZSBhdmFp
bGFibGUgYmVmb3JlCj4gPiAgIAkgKiBnZW43LCBidXQgd2Ugb25seSBzdXBwb3J0IERSUlMgb24g
Z2VuNysKPiA+ICAgCSAqLwo+ID4gLQlyZXR1cm4gSVNfR0VOKGRldl9wcml2LCA3KSB8fCBJU19D
SEVSUllWSUVXKGRldl9wcml2KTsKPiA+ICsJcmV0dXJuIElTX0dFTihpOTE1LCA3KSB8fCBJU19D
SEVSUllWSUVXKGk5MTUpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2NwdV90cmFu
c2NvZGVyX3NldF9tX24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gPiBAQCAtNzQ5NywxMSArNzQ5NywxMSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jcHVfdHJhbnNj
b2Rlcl9zZXRfbV9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YQo+ID4g
ICAJCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfbGlua19tX24gKm0yX24yKQo+ID4gICB7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBp
cGU7Cj4gPiAgIAllbnVtIHRyYW5zY29kZXIgdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90
cmFuc2NvZGVyOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA1KSB7Cj4gPiArCWlm
IChJTlRFTF9HRU4oaTkxNSkgPj0gNSkgewo+ID4gICAJCUk5MTVfV1JJVEUoUElQRV9EQVRBX00x
KHRyYW5zY29kZXIpLCBUVV9TSVpFKG1fbi0+dHUpIHwgbV9uLT5nbWNoX20pOwo+ID4gICAJCUk5
MTVfV1JJVEUoUElQRV9EQVRBX04xKHRyYW5zY29kZXIpLCBtX24tPmdtY2hfbik7Cj4gPiAgIAkJ
STkxNV9XUklURShQSVBFX0xJTktfTTEodHJhbnNjb2RlciksIG1fbi0+bGlua19tKTsKPiA+IEBA
IC03NTExLDcgKzc1MTEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jcHVfdHJhbnNjb2Rlcl9zZXRf
bV9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YQo+ID4gICAJCSAqICh0
byBtYWtlIHN1cmUgdGhlIHJlZ2lzdGVycyBhcmUgbm90IHVubmVjZXNzYXJpbHkgYWNjZXNzZWQp
Lgo+ID4gICAJCSAqLwo+ID4gICAJCWlmIChtMl9uMiAmJiBjcnRjX3N0YXRlLT5oYXNfZHJycyAm
Jgo+ID4gLQkJICAgIHRyYW5zY29kZXJfaGFzX20yX24yKGRldl9wcml2LCB0cmFuc2NvZGVyKSkg
ewo+ID4gKwkJICAgIHRyYW5zY29kZXJfaGFzX20yX24yKGk5MTUsIHRyYW5zY29kZXIpKSB7Cj4g
PiAgIAkJCUk5MTVfV1JJVEUoUElQRV9EQVRBX00yKHRyYW5zY29kZXIpLAo+ID4gICAJCQkJCVRV
X1NJWkUobTJfbjItPnR1KSB8IG0yX24yLT5nbWNoX20pOwo+ID4gICAJCQlJOTE1X1dSSVRFKFBJ
UEVfREFUQV9OMih0cmFuc2NvZGVyKSwgbTJfbjItPmdtY2hfbik7Cj4gPiBAQCAtNzU4OCw3ICs3
NTg4LDcgQEAgc3RhdGljIHZvaWQgdmx2X3ByZXBhcmVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+ID4gICAJCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29u
ZmlnKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5k
ZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4g
PiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAl1MzIgbWRpdjsKPiA+ICAg
CXUzMiBiZXN0biwgYmVzdG0xLCBiZXN0bTIsIGJlc3RwMSwgYmVzdHAyOwo+ID4gQEAgLTc2MDMs
NyArNzYwMyw3IEBAIHN0YXRpYyB2b2lkIHZsdl9wcmVwYXJlX3BsbChzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKPiA+ICAgCWlmICgocGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGUuZHBsbCAmIERQ
TExfVkNPX0VOQUJMRSkgPT0gMCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCXZsdl9kcGlvX2dldChk
ZXZfcHJpdik7Cj4gPiArCXZsdl9kcGlvX2dldChpOTE1KTsKPiA+ICAgCWJlc3RuID0gcGlwZV9j
b25maWctPmRwbGwubjsKPiA+ICAgCWJlc3RtMSA9IHBpcGVfY29uZmlnLT5kcGxsLm0xOwo+ID4g
QEAgLTc2MTUsMTggKzc2MTUsMTggQEAgc3RhdGljIHZvaWQgdmx2X3ByZXBhcmVfcGxsKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJLyogUExMIEIgbmVlZHMgc3BlY2lhbCBoYW5kbGlu
ZyAqLwo+ID4gICAJaWYgKHBpcGUgPT0gUElQRV9CKQo+ID4gLQkJdmx2X3BsbGJfcmVjYWxfb3Bh
bXAoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwkJdmx2X3BsbGJfcmVjYWxfb3BhbXAoaTkxNSwgcGlw
ZSk7Cj4gPiAgIAkvKiBTZXQgdXAgVHggdGFyZ2V0IGZvciBwZXJpb2RpYyBSY29tcCB1cGRhdGUg
Ki8KPiA+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QTExfRFc5X0JDQVNU
LCAweDAxMDAwMDBmKTsKPiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BMTF9E
VzlfQkNBU1QsIDB4MDEwMDAwMGYpOwo+ID4gICAJLyogRGlzYWJsZSB0YXJnZXQgSVJlZiBvbiBQ
TEwgKi8KPiA+IC0JcmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9Q
TExfRFc4KHBpcGUpKTsKPiA+ICsJcmVnX3ZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwg
VkxWX1BMTF9EVzgocGlwZSkpOwo+ID4gICAJcmVnX3ZhbCAmPSAweDAwZmZmZmZmOwo+ID4gLQl2
bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzgocGlwZSksIHJlZ192YWwp
Owo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUExMX0RXOChwaXBlKSwgcmVn
X3ZhbCk7Cj4gPiAgIAkvKiBEaXNhYmxlIGZhc3QgbG9jayAqLwo+ID4gLQl2bHZfZHBpb193cml0
ZShkZXZfcHJpdiwgcGlwZSwgVkxWX0NNTl9EVzAsIDB4NjEwKTsKPiA+ICsJdmx2X2RwaW9fd3Jp
dGUoaTkxNSwgcGlwZSwgVkxWX0NNTl9EVzAsIDB4NjEwKTsKPiA+ICAgCS8qIFNldCBpZHRhZmNy
ZWNhbCBiZWZvcmUgUExMIGlzIGVuYWJsZWQgKi8KPiA+ICAgCW1kaXYgPSAoKGJlc3RtMSA8PCBE
UElPX00xRElWX1NISUZUKSB8IChiZXN0bTIgJiBEUElPX00yRElWX01BU0spKTsKPiA+IEBAIC03
NjQwLDU1ICs3NjQwLDU1IEBAIHN0YXRpYyB2b2lkIHZsdl9wcmVwYXJlX3BsbChzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YywKPiA+ICAgCSAqIE5vdGU6IGRvbid0IHVzZSB0aGUgREFDIHBvc3QgZGl2
aWRlciBhcyBpdCBzZWVtcyB1bnN0YWJsZS4KPiA+ICAgCSAqLwo+ID4gICAJbWRpdiB8PSAoRFBJ
T19QT1NUX0RJVl9IRE1JRFAgPDwgRFBJT19QT1NUX0RJVl9TSElGVCk7Cj4gPiAtCXZsdl9kcGlv
X3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUExMX0RXMyhwaXBlKSwgbWRpdik7Cj4gPiArCXZs
dl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QTExfRFczKHBpcGUpLCBtZGl2KTsKPiA+ICAg
CW1kaXYgfD0gRFBJT19FTkFCTEVfQ0FMSUJSQVRJT047Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRl
dl9wcml2LCBwaXBlLCBWTFZfUExMX0RXMyhwaXBlKSwgbWRpdik7Cj4gPiArCXZsdl9kcGlvX3dy
aXRlKGk5MTUsIHBpcGUsIFZMVl9QTExfRFczKHBpcGUpLCBtZGl2KTsKPiA+ICAgCS8qIFNldCBI
QlIgYW5kIFJCUiBMUEYgY29lZmZpY2llbnRzICovCj4gPiAgIAlpZiAocGlwZV9jb25maWctPnBv
cnRfY2xvY2sgPT0gMTYyMDAwIHx8Cj4gPiAgIAkgICAgaW50ZWxfY3J0Y19oYXNfdHlwZShwaXBl
X2NvbmZpZywgSU5URUxfT1VUUFVUX0FOQUxPRykgfHwKPiA+ICAgCSAgICBpbnRlbF9jcnRjX2hh
c190eXBlKHBpcGVfY29uZmlnLCBJTlRFTF9PVVRQVVRfSERNSSkpCj4gPiAtCQl2bHZfZHBpb193
cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzEwKHBpcGUpLAo+ID4gKwkJdmx2X2RwaW9f
d3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BMTF9EVzEwKHBpcGUpLAo+ID4gICAJCQkJIDB4MDA5ZjAw
MDMpOwo+ID4gICAJZWxzZQo+ID4gLQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZM
Vl9QTExfRFcxMChwaXBlKSwKPiA+ICsJCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9Q
TExfRFcxMChwaXBlKSwKPiA+ICAgCQkJCSAweDAwZDAwMDBmKTsKPiA+ICAgCWlmIChpbnRlbF9j
cnRjX2hhc19kcF9lbmNvZGVyKHBpcGVfY29uZmlnKSkgewo+ID4gICAJCS8qIFVzZSBTU0Mgc291
cmNlICovCj4gPiAgIAkJaWYgKHBpcGUgPT0gUElQRV9BKQo+ID4gLQkJCXZsdl9kcGlvX3dyaXRl
KGRldl9wcml2LCBwaXBlLCBWTFZfUExMX0RXNShwaXBlKSwKPiA+ICsJCQl2bHZfZHBpb193cml0
ZShpOTE1LCBwaXBlLCBWTFZfUExMX0RXNShwaXBlKSwKPiA+ICAgCQkJCQkgMHgwZGY0MDAwMCk7
Cj4gPiAgIAkJZWxzZQo+ID4gLQkJCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZf
UExMX0RXNShwaXBlKSwKPiA+ICsJCQl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUExM
X0RXNShwaXBlKSwKPiA+ICAgCQkJCQkgMHgwZGY3MDAwMCk7Cj4gPiAgIAl9IGVsc2UgeyAvKiBI
RE1JIG9yIFZHQSAqLwo+ID4gICAJCS8qIFVzZSBiZW5kIHNvdXJjZSAqLwo+ID4gICAJCWlmIChw
aXBlID09IFBJUEVfQSkKPiA+IC0JCQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxW
X1BMTF9EVzUocGlwZSksCj4gPiArCQkJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BM
TF9EVzUocGlwZSksCj4gPiAgIAkJCQkJIDB4MGRmNzAwMDApOwo+ID4gICAJCWVsc2UKPiA+IC0J
CQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzUocGlwZSksCj4gPiAr
CQkJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BMTF9EVzUocGlwZSksCj4gPiAgIAkJ
CQkJIDB4MGRmNDAwMDApOwo+ID4gICAJfQo+ID4gLQljb3JlY2xrID0gdmx2X2RwaW9fcmVhZChk
ZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzcocGlwZSkpOwo+ID4gKwljb3JlY2xrID0gdmx2X2Rw
aW9fcmVhZChpOTE1LCBwaXBlLCBWTFZfUExMX0RXNyhwaXBlKSk7Cj4gPiAgIAljb3JlY2xrID0g
KGNvcmVjbGsgJiAweDAwMDBmZjAwKSB8IDB4MDFjMDAwMDA7Cj4gPiAgIAlpZiAoaW50ZWxfY3J0
Y19oYXNfZHBfZW5jb2RlcihwaXBlX2NvbmZpZykpCj4gPiAgIAkJY29yZWNsayB8PSAweDAxMDAw
MDAwOwo+ID4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BMTF9EVzcocGlw
ZSksIGNvcmVjbGspOwo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUExMX0RX
NyhwaXBlKSwgY29yZWNsayk7Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBW
TFZfUExMX0RXMTEocGlwZSksIDB4ODc4NzEwMDApOwo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1
LCBwaXBlLCBWTFZfUExMX0RXMTEocGlwZSksIDB4ODc4NzEwMDApOwo+ID4gLQl2bHZfZHBpb19w
dXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfZHBpb19wdXQoaTkxNSk7Cj4gPiAgIH0KPiA+ICAgc3Rh
dGljIHZvaWQgY2h2X3ByZXBhcmVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJ
CQkgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ID4gICB7
Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAllbnVtIHBp
cGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAllbnVtIGRwaW9fY2hhbm5lbCBwb3J0ID0gdmx2
X3BpcGVfdG9fY2hhbm5lbChwaXBlKTsKPiA+ICAgCXUzMiBsb29wZmlsdGVyLCB0cmlidWZfY2Fs
Y250cjsKPiA+IEBAIC03NzE0LDQyICs3NzE0LDQyIEBAIHN0YXRpYyB2b2lkIGNodl9wcmVwYXJl
X3BsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCWRwaW9fdmFsID0gMDsKPiA+ICAg
CWxvb3BmaWx0ZXIgPSAwOwo+ID4gLQl2bHZfZHBpb19nZXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZf
ZHBpb19nZXQoaTkxNSk7Cj4gPiAgIAkvKiBwMSBhbmQgcDIgZGl2aWRlciAqLwo+ID4gLQl2bHZf
ZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX0NNTl9EVzEzKHBvcnQpLAo+ID4gKwl2bHZf
ZHBpb193cml0ZShpOTE1LCBwaXBlLCBDSFZfQ01OX0RXMTMocG9ydCksCj4gPiAgIAkJCTUgPDwg
RFBJT19DSFZfUzFfRElWX1NISUZUIHwKPiA+ICAgCQkJYmVzdHAxIDw8IERQSU9fQ0hWX1AxX0RJ
Vl9TSElGVCB8Cj4gPiAgIAkJCWJlc3RwMiA8PCBEUElPX0NIVl9QMl9ESVZfU0hJRlQgfAo+ID4g
ICAJCQkxIDw8IERQSU9fQ0hWX0tfRElWX1NISUZUKTsKPiA+ICAgCS8qIEZlZWRiYWNrIHBvc3Qt
ZGl2aWRlciAtIG0yICovCj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZf
UExMX0RXMChwb3J0KSwgYmVzdG0yKTsKPiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwg
Q0hWX1BMTF9EVzAocG9ydCksIGJlc3RtMik7Cj4gPiAgIAkvKiBGZWVkYmFjayByZWZjbGsgZGl2
aWRlciAtIG4gYW5kIG0xICovCj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBD
SFZfUExMX0RXMShwb3J0KSwKPiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgQ0hWX1BM
TF9EVzEocG9ydCksCj4gPiAgIAkJCURQSU9fQ0hWX00xX0RJVl9CWV8yIHwKPiA+ICAgCQkJMSA8
PCBEUElPX0NIVl9OX0RJVl9TSElGVCk7Cj4gPiAgIAkvKiBNMiBmcmFjdGlvbiBkaXZpc2lvbiAq
Lwo+ID4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX1BMTF9EVzIocG9ydCks
IGJlc3RtMl9mcmFjKTsKPiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgQ0hWX1BMTF9E
VzIocG9ydCksIGJlc3RtMl9mcmFjKTsKPiA+ICAgCS8qIE0yIGZyYWN0aW9uIGRpdmlzaW9uIGVu
YWJsZSAqLwo+ID4gLQlkcGlvX3ZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIENI
Vl9QTExfRFczKHBvcnQpKTsKPiA+ICsJZHBpb192YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBp
cGUsIENIVl9QTExfRFczKHBvcnQpKTsKPiA+ICAgCWRwaW9fdmFsICY9IH4oRFBJT19DSFZfRkVF
REZXRF9HQUlOX01BU0sgfCBEUElPX0NIVl9GUkFDX0RJVl9FTik7Cj4gPiAgIAlkcGlvX3ZhbCB8
PSAoMiA8PCBEUElPX0NIVl9GRUVERldEX0dBSU5fU0hJRlQpOwo+ID4gICAJaWYgKGJlc3RtMl9m
cmFjKQo+ID4gICAJCWRwaW9fdmFsIHw9IERQSU9fQ0hWX0ZSQUNfRElWX0VOOwo+ID4gLQl2bHZf
ZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX1BMTF9EVzMocG9ydCksIGRwaW9fdmFsKTsK
PiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgQ0hWX1BMTF9EVzMocG9ydCksIGRwaW9f
dmFsKTsKPiA+ICAgCS8qIFByb2dyYW0gZGlnaXRhbCBsb2NrIGRldGVjdCB0aHJlc2hvbGQgKi8K
PiA+IC0JZHBpb192YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfUExMX0RX
OShwb3J0KSk7Cj4gPiArCWRwaW9fdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBDSFZf
UExMX0RXOShwb3J0KSk7Cj4gPiAgIAlkcGlvX3ZhbCAmPSB+KERQSU9fQ0hWX0lOVF9MT0NLX1RI
UkVTSE9MRF9NQVNLIHwKPiA+ICAgCQkJCQlEUElPX0NIVl9JTlRfTE9DS19USFJFU0hPTERfU0VM
X0NPQVJTRSk7Cj4gPiAgIAlkcGlvX3ZhbCB8PSAoMHg1IDw8IERQSU9fQ0hWX0lOVF9MT0NLX1RI
UkVTSE9MRF9TSElGVCk7Cj4gPiAgIAlpZiAoIWJlc3RtMl9mcmFjKQo+ID4gICAJCWRwaW9fdmFs
IHw9IERQSU9fQ0hWX0lOVF9MT0NLX1RIUkVTSE9MRF9TRUxfQ09BUlNFOwo+ID4gLQl2bHZfZHBp
b193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX1BMTF9EVzkocG9ydCksIGRwaW9fdmFsKTsKPiA+
ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgQ0hWX1BMTF9EVzkocG9ydCksIGRwaW9fdmFs
KTsKPiA+ICAgCS8qIExvb3AgZmlsdGVyICovCj4gPiAgIAlpZiAodmNvID09IDU0MDAwMDApIHsK
PiA+IEBAIC03Nzc0LDI0ICs3Nzc0LDI0IEBAIHN0YXRpYyB2b2lkIGNodl9wcmVwYXJlX3BsbChz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQlsb29wZmlsdGVyIHw9ICgweDMgPDwgRFBJ
T19DSFZfR0FJTl9DVFJMX1NISUZUKTsKPiA+ICAgCQl0cmlidWZfY2FsY250ciA9IDA7Cj4gPiAg
IAl9Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfUExMX0RXNihwb3J0
KSwgbG9vcGZpbHRlcik7Cj4gPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIENIVl9QTExf
RFc2KHBvcnQpLCBsb29wZmlsdGVyKTsKPiA+IC0JZHBpb192YWwgPSB2bHZfZHBpb19yZWFkKGRl
dl9wcml2LCBwaXBlLCBDSFZfUExMX0RXOChwb3J0KSk7Cj4gPiArCWRwaW9fdmFsID0gdmx2X2Rw
aW9fcmVhZChpOTE1LCBwaXBlLCBDSFZfUExMX0RXOChwb3J0KSk7Cj4gPiAgIAlkcGlvX3ZhbCAm
PSB+RFBJT19DSFZfVERDX1RBUkdFVF9DTlRfTUFTSzsKPiA+ICAgCWRwaW9fdmFsIHw9ICh0cmli
dWZfY2FsY250ciA8PCBEUElPX0NIVl9URENfVEFSR0VUX0NOVF9TSElGVCk7Cj4gPiAtCXZsdl9k
cGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfUExMX0RXOChwb3J0KSwgZHBpb192YWwpOwo+
ID4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBDSFZfUExMX0RXOChwb3J0KSwgZHBpb192
YWwpOwo+ID4gICAJLyogQUZDIFJlY2FsICovCj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2
LCBwaXBlLCBDSFZfQ01OX0RXMTQocG9ydCksCj4gPiAtCQkJdmx2X2RwaW9fcmVhZChkZXZfcHJp
diwgcGlwZSwgQ0hWX0NNTl9EVzE0KHBvcnQpKSB8Cj4gPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUs
IHBpcGUsIENIVl9DTU5fRFcxNChwb3J0KSwKPiA+ICsJCQl2bHZfZHBpb19yZWFkKGk5MTUsIHBp
cGUsIENIVl9DTU5fRFcxNChwb3J0KSkgfAo+ID4gICAJCQlEUElPX0FGQ19SRUNBTCk7Cj4gPiAt
CXZsdl9kcGlvX3B1dChkZXZfcHJpdik7Cj4gPiArCXZsdl9kcGlvX3B1dChpOTE1KTsKPiA+ICAg
fQo+ID4gICAvKioKPiA+ICAgICogdmx2X2ZvcmNlX3BsbF9vbiAtIGZvcmNpYmx5IGVuYWJsZSBq
dXN0IHRoZSBQTEwKPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgcHJpdmF0ZSBzdHJ1Y3R1cmUKPiA+
ICsgKiBAaTkxNTogaTkxNSBwcml2YXRlIHN0cnVjdHVyZQo+ID4gICAgKiBAcGlwZTogcGlwZSBQ
TEwgdG8gZW5hYmxlCj4gPiAgICAqIEBkcGxsOiBQTEwgY29uZmlndXJhdGlvbgo+ID4gICAgKgo+
ID4gQEAgLTc3OTksMTAgKzc3OTksMTAgQEAgc3RhdGljIHZvaWQgY2h2X3ByZXBhcmVfcGxsKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAgKiBpbiBjYXNlcyB3aGVyZSB3ZSBuZWVkIHRo
ZSBQTEwgZW5hYmxlZCBldmVuIHdoZW4gQHBpcGUgaXMgbm90IGdvaW5nIHRvCj4gPiAgICAqIGJl
IGVuYWJsZWQuCj4gPiAgICAqLwo+ID4gLWludCB2bHZfZm9yY2VfcGxsX29uKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUsCj4gPiAraW50IHZsdl9mb3Jj
ZV9wbGxfb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcGlwZSBwaXBlLAo+
ID4gICAJCSAgICAgY29uc3Qgc3RydWN0IGRwbGwgKmRwbGwpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgcGlw
ZSk7Cj4gPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3Bp
cGUoaTkxNSwgcGlwZSk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25m
aWc7Cj4gPiAgIAlwaXBlX2NvbmZpZyA9IGt6YWxsb2Moc2l6ZW9mKCpwaXBlX2NvbmZpZyksIEdG
UF9LRVJORUwpOwo+ID4gQEAgLTc4MTMsNyArNzgxMyw3IEBAIGludCB2bHZfZm9yY2VfcGxsX29u
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUsCj4gPiAg
IAlwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllciA9IDE7Cj4gPiAgIAlwaXBlX2NvbmZpZy0+
ZHBsbCA9ICpkcGxsOwo+ID4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+ICsJ
aWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+ICAgCQljaHZfY29tcHV0ZV9kcGxsKGNydGMs
IHBpcGVfY29uZmlnKTsKPiA+ICAgCQljaHZfcHJlcGFyZV9wbGwoY3J0YywgcGlwZV9jb25maWcp
Owo+ID4gICAJCWNodl9lbmFibGVfcGxsKGNydGMsIHBpcGVfY29uZmlnKTsKPiA+IEBAIC03ODMw
LDI1ICs3ODMwLDI1IEBAIGludCB2bHZfZm9yY2VfcGxsX29uKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUsCj4gPiAgIC8qKgo+ID4gICAgKiB2bHZfZm9y
Y2VfcGxsX29mZiAtIGZvcmNpYmx5IGRpc2FibGUganVzdCB0aGUgUExMCj4gPiAtICogQGRldl9w
cml2OiBpOTE1IHByaXZhdGUgc3RydWN0dXJlCj4gPiArICogQGk5MTU6IGk5MTUgcHJpdmF0ZSBz
dHJ1Y3R1cmUKPiA+ICAgICogQHBpcGU6IHBpcGUgUExMIHRvIGRpc2FibGUKPiA+ICAgICoKPiA+
ICAgICogRGlzYWJsZSB0aGUgUExMIGZvciBAcGlwZS4gVG8gYmUgdXNlZCBpbiBjYXNlcyB3aGVy
ZSB3ZSBuZWVkCj4gPiAgICAqIHRoZSBQTEwgZW5hYmxlZCBldmVuIHdoZW4gQHBpcGUgaXMgbm90
IGdvaW5nIHRvIGJlIGVuYWJsZWQuCj4gPiAgICAqLwo+ID4gLXZvaWQgdmx2X2ZvcmNlX3BsbF9v
ZmYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkKPiA+
ICt2b2lkIHZsdl9mb3JjZV9wbGxfb2ZmKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBl
bnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikp
Cj4gPiAtCQljaHZfZGlzYWJsZV9wbGwoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlpZiAoSVNfQ0hF
UlJZVklFVyhpOTE1KSkKPiA+ICsJCWNodl9kaXNhYmxlX3BsbChpOTE1LCBwaXBlKTsKPiA+ICAg
CWVsc2UKPiA+IC0JCXZsdl9kaXNhYmxlX3BsbChkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCQl2bHZf
ZGlzYWJsZV9wbGwoaTkxNSwgcGlwZSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgaTl4eF9j
b21wdXRlX2RwbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCSAgICAgIHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkgICAgICBzdHJ1Y3QgZHBs
bCAqcmVkdWNlZF9jbG9jaykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCXUzMiBkcGxs
Owo+ID4gICAJc3RydWN0IGRwbGwgKmNsb2NrID0gJmNydGNfc3RhdGUtPmRwbGw7Cj4gPiBAQCAt
Nzg2MSw4ICs3ODYxLDggQEAgc3RhdGljIHZvaWQgaTl4eF9jb21wdXRlX2RwbGwoc3RydWN0IGlu
dGVsX2NydGMgKmNydGMsCj4gPiAgIAllbHNlCj4gPiAgIAkJZHBsbCB8PSBEUExMQl9NT0RFX0RB
Q19TRVJJQUw7Cj4gPiAtCWlmIChJU19JOTQ1RyhkZXZfcHJpdikgfHwgSVNfSTk0NUdNKGRldl9w
cml2KSB8fAo+ID4gLQkgICAgSVNfRzMzKGRldl9wcml2KSB8fCBJU19QSU5FVklFVyhkZXZfcHJp
dikpIHsKPiA+ICsJaWYgKElTX0k5NDVHKGk5MTUpIHx8IElTX0k5NDVHTShpOTE1KSB8fAo+ID4g
KwkgICAgSVNfRzMzKGk5MTUpIHx8IElTX1BJTkVWSUVXKGk5MTUpKSB7Cj4gPiAgIAkJZHBsbCB8
PSAoY3J0Y19zdGF0ZS0+cGl4ZWxfbXVsdGlwbGllciAtIDEpCj4gPiAgIAkJCTw8IFNEVk9fTVVM
VElQTElFUl9TSElGVF9ISVJFUzsKPiA+ICAgCX0KPiA+IEBAIC03ODc1LDExICs3ODc1LDExIEBA
IHN0YXRpYyB2b2lkIGk5eHhfY29tcHV0ZV9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+
ID4gICAJCWRwbGwgfD0gRFBMTF9TRFZPX0hJR0hfU1BFRUQ7Cj4gPiAgIAkvKiBjb21wdXRlIGJp
dG1hc2sgZnJvbSBwMSB2YWx1ZSAqLwo+ID4gLQlpZiAoSVNfUElORVZJRVcoZGV2X3ByaXYpKQo+
ID4gKwlpZiAoSVNfUElORVZJRVcoaTkxNSkpCj4gPiAgIAkJZHBsbCB8PSAoMSA8PCAoY2xvY2st
PnAxIC0gMSkpIDw8IERQTExfRlBBMDFfUDFfUE9TVF9ESVZfU0hJRlRfUElORVZJRVc7Cj4gPiAg
IAllbHNlIHsKPiA+ICAgCQlkcGxsIHw9ICgxIDw8IChjbG9jay0+cDEgLSAxKSkgPDwgRFBMTF9G
UEEwMV9QMV9QT1NUX0RJVl9TSElGVDsKPiA+IC0JCWlmIChJU19HNFgoZGV2X3ByaXYpICYmIHJl
ZHVjZWRfY2xvY2spCj4gPiArCQlpZiAoSVNfRzRYKGk5MTUpICYmIHJlZHVjZWRfY2xvY2spCj4g
PiAgIAkJCWRwbGwgfD0gKDEgPDwgKHJlZHVjZWRfY2xvY2stPnAxIC0gMSkpIDw8IERQTExfRlBB
MV9QMV9QT1NUX0RJVl9TSElGVDsKPiA+ICAgCX0KPiA+ICAgCXN3aXRjaCAoY2xvY2stPnAyKSB7
Cj4gPiBAQCAtNzg5NiwxMyArNzg5NiwxMyBAQCBzdGF0aWMgdm9pZCBpOXh4X2NvbXB1dGVfZHBs
bChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQlkcGxsIHw9IERQTExCX0xWRFNfUDJf
Q0xPQ0tfRElWXzE0Owo+ID4gICAJCWJyZWFrOwo+ID4gICAJfQo+ID4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA0KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpCj4gPiAgIAkJ
ZHBsbCB8PSAoNiA8PCBQTExfTE9BRF9QVUxTRV9QSEFTRV9TSElGVCk7Cj4gPiAgIAlpZiAoY3J0
Y19zdGF0ZS0+c2R2b190dl9jbG9jaykKPiA+ICAgCQlkcGxsIHw9IFBMTF9SRUZfSU5QVVRfVFZD
TEtJTkJDOwo+ID4gICAJZWxzZSBpZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJ
TlRFTF9PVVRQVVRfTFZEUykgJiYKPiA+IC0JCSBpbnRlbF9wYW5lbF91c2Vfc3NjKGRldl9wcml2
KSkKPiA+ICsJCSBpbnRlbF9wYW5lbF91c2Vfc3NjKGk5MTUpKQo+ID4gICAJCWRwbGwgfD0gUExM
Ql9SRUZfSU5QVVRfU1BSRUFEU1BFQ1RSVU1JTjsKPiA+ICAgCWVsc2UKPiA+ICAgCQlkcGxsIHw9
IFBMTF9SRUZfSU5QVVRfRFJFRkNMSzsKPiA+IEBAIC03OTEwLDcgKzc5MTAsNyBAQCBzdGF0aWMg
dm9pZCBpOXh4X2NvbXB1dGVfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCWRw
bGwgfD0gRFBMTF9WQ09fRU5BQkxFOwo+ID4gICAJY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5k
cGxsID0gZHBsbDsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkgewo+ID4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDQpIHsKPiA+ICAgCQl1MzIgZHBsbF9tZCA9IChjcnRjX3N0
YXRlLT5waXhlbF9tdWx0aXBsaWVyIC0gMSkKPiA+ICAgCQkJPDwgRFBMTF9NRF9VRElfTVVMVElQ
TElFUl9TSElGVDsKPiA+ICAgCQljcnRjX3N0YXRlLT5kcGxsX2h3X3N0YXRlLmRwbGxfbWQgPSBk
cGxsX21kOwo+ID4gQEAgLTc5MjIsNyArNzkyMiw3IEBAIHN0YXRpYyB2b2lkIGk4eHhfY29tcHV0
ZV9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkgICAgICBzdHJ1Y3QgZHBs
bCAqcmVkdWNlZF9jbG9jaykKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9
IGNydGMtPmJhc2UuZGV2Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShkZXYpOwo+ID4gICAJdTMyIGRwbGw7Cj4gPiAgIAlzdHJ1Y3QgZHBsbCAqY2xvY2sgPSAm
Y3J0Y19zdGF0ZS0+ZHBsbDsKPiA+IEBAIC03OTUzLDEyICs3OTUzLDEyIEBAIHN0YXRpYyB2b2lk
IGk4eHhfY29tcHV0ZV9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJICogYm90
aCBEUExMUy4gVGhlIHNwZWMgc2F5cyB3ZSBzaG91bGQgZGlzYWJsZSB0aGUgRFZPIDJYIGNsb2Nr
Cj4gPiAgIAkgKiB3aGVuIG5vdCBuZWVkZWQsIGJ1dCB0aGlzIHNlZW1zIHRvIHdvcmsgZmluZSBp
biBwcmFjdGljZS4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSVNfSTgzMChkZXZfcHJpdikgfHwKPiA+
ICsJaWYgKElTX0k4MzAoaTkxNSkgfHwKPiA+ICAgCSAgICBpbnRlbF9jcnRjX2hhc190eXBlKGNy
dGNfc3RhdGUsIElOVEVMX09VVFBVVF9EVk8pKQo+ID4gICAJCWRwbGwgfD0gRFBMTF9EVk9fMlhf
TU9ERTsKPiA+ICAgCWlmIChpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElOVEVMX09V
VFBVVF9MVkRTKSAmJgo+ID4gLQkgICAgaW50ZWxfcGFuZWxfdXNlX3NzYyhkZXZfcHJpdikpCj4g
PiArCSAgICBpbnRlbF9wYW5lbF91c2Vfc3NjKGk5MTUpKQo+ID4gICAJCWRwbGwgfD0gUExMQl9S
RUZfSU5QVVRfU1BSRUFEU1BFQ1RSVU1JTjsKPiA+ICAgCWVsc2UKPiA+ICAgCQlkcGxsIHw9IFBM
TF9SRUZfSU5QVVRfRFJFRkNMSzsKPiA+IEBAIC03OTcwLDcgKzc5NzAsNyBAQCBzdGF0aWMgdm9p
ZCBpOHh4X2NvbXB1dGVfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgc3RhdGlj
IHZvaWQgaW50ZWxfc2V0X3BpcGVfdGltaW5ncyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4g
ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJZW51bSB0cmFuc2NvZGVyIGNw
dV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4gPiAgIAljb25zdCBz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5iYXNl
LmFkanVzdGVkX21vZGU7Cj4gPiBAQCAtNzk5Niw3ICs3OTk2LDcgQEAgc3RhdGljIHZvaWQgaW50
ZWxfc2V0X3BpcGVfdGltaW5ncyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPiA+ICAgCQkJdnN5bmNzaGlmdCArPSBhZGp1c3RlZF9tb2RlLT5jcnRjX2h0b3RhbDsK
PiA+ICAgCX0KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPiAzKQo+ID4gKwlpZiAoSU5U
RUxfR0VOKGk5MTUpID4gMykKPiA+ICAgCQlJOTE1X1dSSVRFKFZTWU5DU0hJRlQoY3B1X3RyYW5z
Y29kZXIpLCB2c3luY3NoaWZ0KTsKPiA+ICAgCUk5MTVfV1JJVEUoSFRPVEFMKGNwdV90cmFuc2Nv
ZGVyKSwKPiA+IEBAIC04MDIzLDcgKzgwMjMsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zZXRfcGlw
ZV90aW1pbmdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4g
ICAJICogcHJvZ3JhbW1lZCB3aXRoIHRoZSBWVE9UQUxfRURQIHZhbHVlLiBTYW1lIGZvciBWVE9U
QUxfQy4gVGhpcyBpcwo+ID4gICAJICogZG9jdW1lbnRlZCBvbiB0aGUgRERJX0ZVTkNfQ1RMIHJl
Z2lzdGVyIGRlc2NyaXB0aW9uLCBFRFAgSW5wdXQgU2VsZWN0Cj4gPiAgIAkgKiBiaXRzLiAqLwo+
ID4gLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgY3B1X3RyYW5zY29kZXIgPT0gVFJBTlND
T0RFUl9FRFAgJiYKPiA+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkgJiYgY3B1X3RyYW5zY29kZXIg
PT0gVFJBTlNDT0RFUl9FRFAgJiYKPiA+ICAgCSAgICAocGlwZSA9PSBQSVBFX0IgfHwgcGlwZSA9
PSBQSVBFX0MpKQo+ID4gICAJCUk5MTVfV1JJVEUoVlRPVEFMKHBpcGUpLCBJOTE1X1JFQUQoVlRP
VEFMKGNwdV90cmFuc2NvZGVyKSkpOwo+ID4gQEAgLTgwMzIsNyArODAzMiw3IEBAIHN0YXRpYyB2
b2lkIGludGVsX3NldF9waXBlX3RpbWluZ3MoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX3NldF9waXBlX3NyY19zaXplKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7
Cj4gPiAgIAkvKiBwaXBlc3JjIGNvbnRyb2xzIHRoZSBzaXplIHRoYXQgaXMgc2NhbGVkIGZyb20s
IHdoaWNoIHNob3VsZAo+ID4gQEAgLTgwNDcsNyArODA0Nyw3IEBAIHN0YXRpYyB2b2lkIGludGVs
X2dldF9waXBlX3RpbWluZ3Moc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCQkgICBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+ICAgCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCWVudW0gdHJhbnNjb2RlciBjcHVf
dHJhbnNjb2RlciA9IHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlcjsKPiA+ICAgCXUzMiB0bXA7
Cj4gPiBAQCAtODA5Miw3ICs4MDkyLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZ2V0X3BpcGVfc3Jj
X3NpemUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCQkgICAgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAl1MzIgdG1wOwo+ID4gICAJdG1wID0gSTkxNV9SRUFE
KFBJUEVTUkMoY3J0Yy0+cGlwZSkpOwo+ID4gQEAgLTgxMjksMjEgKzgxMjksMjEgQEAgdm9pZCBp
bnRlbF9tb2RlX2Zyb21fcGlwZV9jb25maWcoc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUs
Cj4gPiAgIHN0YXRpYyB2b2lkIGk5eHhfc2V0X3BpcGVjb25mKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Cj4gPiAgIAl1MzIgcGlwZWNvbmY7Cj4gPiAgIAlwaXBlY29uZiA9IDA7Cj4gPiAgIAkvKiB3
ZSBrZWVwIGJvdGggcGlwZXMgZW5hYmxlZCBvbiA4MzAgKi8KPiA+IC0JaWYgKElTX0k4MzAoZGV2
X3ByaXYpKQo+ID4gKwlpZiAoSVNfSTgzMChpOTE1KSkKPiA+ICAgCQlwaXBlY29uZiB8PSBJOTE1
X1JFQUQoUElQRUNPTkYoY3J0Yy0+cGlwZSkpICYgUElQRUNPTkZfRU5BQkxFOwo+ID4gICAJaWYg
KGNydGNfc3RhdGUtPmRvdWJsZV93aWRlKQo+ID4gICAJCXBpcGVjb25mIHw9IFBJUEVDT05GX0RP
VUJMRV9XSURFOwo+ID4gICAJLyogb25seSBnNHggYW5kIGxhdGVyIGhhdmUgZmFuY3kgYnBjL2Rp
dGhlciBjb250cm9scyAqLwo+ID4gLQlpZiAoSVNfRzRYKGRldl9wcml2KSB8fCBJU19WQUxMRVlW
SUVXKGRldl9wcml2KSB8fAo+ID4gLQkgICAgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+
ICsJaWYgKElTX0c0WChpOTE1KSB8fCBJU19WQUxMRVlWSUVXKGk5MTUpIHx8Cj4gPiArCSAgICBJ
U19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiAgIAkJLyogQnNwZWMgY2xhaW1zIHRoYXQgd2UgY2Fu
J3QgdXNlIGRpdGhlcmluZyBmb3IgMzBicHAgcGlwZXMuICovCj4gPiAgIAkJaWYgKGNydGNfc3Rh
dGUtPmRpdGhlciAmJiBjcnRjX3N0YXRlLT5waXBlX2JwcCAhPSAzMCkKPiA+ICAgCQkJcGlwZWNv
bmYgfD0gUElQRUNPTkZfRElUSEVSX0VOIHwKPiA+IEBAIC04MTY2LDcgKzgxNjYsNyBAQCBzdGF0
aWMgdm9pZCBpOXh4X3NldF9waXBlY29uZihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPiA+ICAgCX0KPiA+ICAgCWlmIChjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVk
X21vZGUuZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0lOVEVSTEFDRSkgewo+ID4gLQkJaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPCA0IHx8Cj4gPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNCB8fAo+
ID4gICAJCSAgICBpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9T
RFZPKSkKPiA+ICAgCQkJcGlwZWNvbmYgfD0gUElQRUNPTkZfSU5URVJMQUNFX1dfRklFTERfSU5E
SUNBVElPTjsKPiA+ICAgCQllbHNlCj4gPiBAQCAtODE3NSw3ICs4MTc1LDcgQEAgc3RhdGljIHZv
aWQgaTl4eF9zZXRfcGlwZWNvbmYoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpCj4gPiAgIAkJcGlwZWNvbmYgfD0gUElQRUNPTkZfUFJPR1JFU1NJVkU7Cj4gPiAgIAl9
Cj4gPiAtCWlmICgoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpICYmCj4gPiArCWlmICgoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVX
KGk5MTUpKSAmJgo+ID4gICAJICAgICBjcnRjX3N0YXRlLT5saW1pdGVkX2NvbG9yX3JhbmdlKQo+
ID4gICAJCXBpcGVjb25mIHw9IFBJUEVDT05GX0NPTE9SX1JBTkdFX1NFTEVDVDsKPiA+IEBAIC04
MTg5LDcgKzgxODksNyBAQCBzdGF0aWMgaW50IGk4eHhfY3J0Y19jb21wdXRlX2Nsb2NrKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkJICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRj
LT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGV2KTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9saW1pdCAqbGltaXQ7Cj4gPiAgIAlpbnQg
cmVmY2xrID0gNDgwMDA7Cj4gPiBAQCAtODE5Nyw4ICs4MTk3LDggQEAgc3RhdGljIGludCBpOHh4
X2NydGNfY29tcHV0ZV9jbG9jayhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCSAgICAg
ICBzaXplb2YoY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZSkpOwo+ID4gICAJaWYgKGludGVsX2Ny
dGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0xWRFMpKSB7Cj4gPiAtCQlpZiAo
aW50ZWxfcGFuZWxfdXNlX3NzYyhkZXZfcHJpdikpIHsKPiA+IC0JCQlyZWZjbGsgPSBkZXZfcHJp
di0+dmJ0Lmx2ZHNfc3NjX2ZyZXE7Cj4gPiArCQlpZiAoaW50ZWxfcGFuZWxfdXNlX3NzYyhpOTE1
KSkgewo+ID4gKwkJCXJlZmNsayA9IGk5MTUtPnZidC5sdmRzX3NzY19mcmVxOwo+ID4gICAJCQlE
Uk1fREVCVUdfS01TKCJ1c2luZyBTU0MgcmVmZXJlbmNlIGNsb2NrIG9mICVkIGtIelxuIiwgcmVm
Y2xrKTsKPiA+ICAgCQl9Cj4gPiBAQCAtODIyNCw3ICs4MjI0LDcgQEAgc3RhdGljIGludCBpOHh4
X2NydGNfY29tcHV0ZV9jbG9jayhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgc3RhdGlj
IGludCBnNHhfY3J0Y19jb21wdXRlX2Nsb2NrKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4g
ICAJCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9saW1pdCAqbGltaXQ7Cj4gPiAg
IAlpbnQgcmVmY2xrID0gOTYwMDA7Cj4gPiBAQCAtODIzMiwxMiArODIzMiwxMiBAQCBzdGF0aWMg
aW50IGc0eF9jcnRjX2NvbXB1dGVfY2xvY2soc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAg
IAkgICAgICAgc2l6ZW9mKGNydGNfc3RhdGUtPmRwbGxfaHdfc3RhdGUpKTsKPiA+ICAgCWlmIChp
bnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9MVkRTKSkgewo+ID4g
LQkJaWYgKGludGVsX3BhbmVsX3VzZV9zc2MoZGV2X3ByaXYpKSB7Cj4gPiAtCQkJcmVmY2xrID0g
ZGV2X3ByaXYtPnZidC5sdmRzX3NzY19mcmVxOwo+ID4gKwkJaWYgKGludGVsX3BhbmVsX3VzZV9z
c2MoaTkxNSkpIHsKPiA+ICsJCQlyZWZjbGsgPSBpOTE1LT52YnQubHZkc19zc2NfZnJlcTsKPiA+
ICAgCQkJRFJNX0RFQlVHX0tNUygidXNpbmcgU1NDIHJlZmVyZW5jZSBjbG9jayBvZiAlZCBrSHpc
biIsIHJlZmNsayk7Cj4gPiAgIAkJfQo+ID4gLQkJaWYgKGludGVsX2lzX2R1YWxfbGlua19sdmRz
KGRldl9wcml2KSkKPiA+ICsJCWlmIChpbnRlbF9pc19kdWFsX2xpbmtfbHZkcyhpOTE1KSkKPiA+
ICAgCQkJbGltaXQgPSAmaW50ZWxfbGltaXRzX2c0eF9kdWFsX2NoYW5uZWxfbHZkczsKPiA+ICAg
CQllbHNlCj4gPiAgIAkJCWxpbWl0ID0gJmludGVsX2xpbWl0c19nNHhfc2luZ2xlX2NoYW5uZWxf
bHZkczsKPiA+IEBAIC04MjY3LDcgKzgyNjcsNyBAQCBzdGF0aWMgaW50IHBudl9jcnRjX2NvbXB1
dGVfY2xvY2soc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCQkgIHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfbGltaXQgKmxpbWl0
Owo+ID4gICAJaW50IHJlZmNsayA9IDk2MDAwOwo+ID4gQEAgLTgyNzUsOCArODI3NSw4IEBAIHN0
YXRpYyBpbnQgcG52X2NydGNfY29tcHV0ZV9jbG9jayhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiA+ICAgCSAgICAgICBzaXplb2YoY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZSkpOwo+ID4gICAJ
aWYgKGludGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0xWRFMpKSB7
Cj4gPiAtCQlpZiAoaW50ZWxfcGFuZWxfdXNlX3NzYyhkZXZfcHJpdikpIHsKPiA+IC0JCQlyZWZj
bGsgPSBkZXZfcHJpdi0+dmJ0Lmx2ZHNfc3NjX2ZyZXE7Cj4gPiArCQlpZiAoaW50ZWxfcGFuZWxf
dXNlX3NzYyhpOTE1KSkgewo+ID4gKwkJCXJlZmNsayA9IGk5MTUtPnZidC5sdmRzX3NzY19mcmVx
Owo+ID4gICAJCQlEUk1fREVCVUdfS01TKCJ1c2luZyBTU0MgcmVmZXJlbmNlIGNsb2NrIG9mICVk
IGtIelxuIiwgcmVmY2xrKTsKPiA+ICAgCQl9Cj4gPiBAQCAtODMwMSw3ICs4MzAxLDcgQEAgc3Rh
dGljIGludCBpOXh4X2NydGNfY29tcHV0ZV9jbG9jayhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiA+ICAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7
Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAljb25zdCBz
dHJ1Y3QgaW50ZWxfbGltaXQgKmxpbWl0Owo+ID4gICAJaW50IHJlZmNsayA9IDk2MDAwOwo+ID4g
QEAgLTgzMDksOCArODMwOSw4IEBAIHN0YXRpYyBpbnQgaTl4eF9jcnRjX2NvbXB1dGVfY2xvY2so
c3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkgICAgICAgc2l6ZW9mKGNydGNfc3RhdGUt
PmRwbGxfaHdfc3RhdGUpKTsKPiA+ICAgCWlmIChpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3Rh
dGUsIElOVEVMX09VVFBVVF9MVkRTKSkgewo+ID4gLQkJaWYgKGludGVsX3BhbmVsX3VzZV9zc2Mo
ZGV2X3ByaXYpKSB7Cj4gPiAtCQkJcmVmY2xrID0gZGV2X3ByaXYtPnZidC5sdmRzX3NzY19mcmVx
Owo+ID4gKwkJaWYgKGludGVsX3BhbmVsX3VzZV9zc2MoaTkxNSkpIHsKPiA+ICsJCQlyZWZjbGsg
PSBpOTE1LT52YnQubHZkc19zc2NfZnJlcTsKPiA+ICAgCQkJRFJNX0RFQlVHX0tNUygidXNpbmcg
U1NDIHJlZmVyZW5jZSBjbG9jayBvZiAlZCBrSHpcbiIsIHJlZmNsayk7Cj4gPiAgIAkJfQo+ID4g
QEAgLTgzNzMsMjIgKzgzNzMsMjIgQEAgc3RhdGljIGludCB2bHZfY3J0Y19jb21wdXRlX2Nsb2Nr
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IC1z
dGF0aWMgYm9vbCBpOXh4X2hhc19wZml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICtzdGF0aWMgYm9vbCBpOXh4X2hhc19wZml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ID4gICB7Cj4gPiAtCWlmIChJU19JODMwKGRldl9wcml2KSkKPiA+ICsJaWYgKElT
X0k4MzAoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gLQlyZXR1cm4gSU5URUxfR0VO
KGRldl9wcml2KSA+PSA0IHx8Cj4gPiAtCQlJU19QSU5FVklFVyhkZXZfcHJpdikgfHwgSVNfTU9C
SUxFKGRldl9wcml2KTsKPiA+ICsJcmV0dXJuIElOVEVMX0dFTihpOTE1KSA+PSA0IHx8Cj4gPiAr
CQlJU19QSU5FVklFVyhpOTE1KSB8fCBJU19NT0JJTEUoaTkxNSk7Cj4gPiAgIH0KPiA+ICAgc3Rh
dGljIHZvaWQgaTl4eF9nZXRfcGZpdF9jb25maWcoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4g
PiAgIAkJCQkgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFz
ZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ID4gICAJdTMyIHRtcDsKPiA+IC0JaWYgKCFpOXh4X2hhc19wZml0KGRl
dl9wcml2KSkKPiA+ICsJaWYgKCFpOXh4X2hhc19wZml0KGk5MTUpKQo+ID4gICAJCXJldHVybjsK
PiA+ICAgCXRtcCA9IEk5MTVfUkVBRChQRklUX0NPTlRST0wpOwo+ID4gQEAgLTgzOTYsNyArODM5
Niw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfZ2V0X3BmaXRfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjLAo+ID4gICAJCXJldHVybjsKPiA+ICAgCS8qIENoZWNrIHdoZXRoZXIgdGhlIHBmaXQg
aXMgYXR0YWNoZWQgdG8gb3VyIHBpcGUuICovCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
IDwgNCkgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNCkgewo+ID4gICAJCWlmIChjcnRj
LT5waXBlICE9IFBJUEVfQikKPiA+ICAgCQkJcmV0dXJuOwo+ID4gICAJfSBlbHNlIHsKPiA+IEBA
IC04NDEyLDcgKzg0MTIsNyBAQCBzdGF0aWMgdm9pZCB2bHZfY3J0Y19jbG9ja19nZXQoc3RydWN0
IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBj
cnRjLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZGV2KTsKPiA+ICAgCWludCBwaXBlID0gcGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVyOwo+
ID4gICAJc3RydWN0IGRwbGwgY2xvY2s7Cj4gPiAgIAl1MzIgbWRpdjsKPiA+IEBAIC04NDIyLDkg
Kzg0MjIsOSBAQCBzdGF0aWMgdm9pZCB2bHZfY3J0Y19jbG9ja19nZXQoc3RydWN0IGludGVsX2Ny
dGMgKmNydGMsCj4gPiAgIAlpZiAoKHBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGwgJiBE
UExMX1ZDT19FTkFCTEUpID09IDApCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQl2bHZfZHBpb19nZXQo
ZGV2X3ByaXYpOwo+ID4gLQltZGl2ID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxW
X1BMTF9EVzMocGlwZSkpOwo+ID4gLQl2bHZfZHBpb19wdXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZf
ZHBpb19nZXQoaTkxNSk7Cj4gPiArCW1kaXYgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIFZM
Vl9QTExfRFczKHBpcGUpKTsKPiA+ICsJdmx2X2RwaW9fcHV0KGk5MTUpOwo+ID4gICAJY2xvY2su
bTEgPSAobWRpdiA+PiBEUElPX00xRElWX1NISUZUKSAmIDc7Cj4gPiAgIAljbG9jay5tMiA9IG1k
aXYgJiBEUElPX00yRElWX01BU0s7Cj4gPiBAQCAtODQ0MCw3ICs4NDQwLDcgQEAgaTl4eF9nZXRf
aW5pdGlhbF9wbGFuZV9jb25maWcoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCSAg
ICAgIHN0cnVjdCBpbnRlbF9pbml0aWFsX3BsYW5lX2NvbmZpZyAqcGxhbmVfY29uZmlnKQo+ID4g
ICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUoY3J0Yy0+YmFzZS5wcmltYXJ5
KTsKPiA+ICAgCWVudW0gaTl4eF9wbGFuZV9pZCBpOXh4X3BsYW5lID0gcGxhbmUtPmk5eHhfcGxh
bmU7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZTsKPiA+IEBAIC04NDY3LDcgKzg0NjcsNyBAQCBpOXh4
X2dldF9pbml0aWFsX3BsYW5lX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAg
CXZhbCA9IEk5MTVfUkVBRChEU1BDTlRSKGk5eHhfcGxhbmUpKTsKPiA+IC0JaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gNCkgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpIHsKPiA+
ICAgCQlpZiAodmFsICYgRElTUFBMQU5FX1RJTEVEKSB7Cj4gPiAgIAkJCXBsYW5lX2NvbmZpZy0+
dGlsaW5nID0gSTkxNV9USUxJTkdfWDsKPiA+ICAgCQkJZmItPm1vZGlmaWVyID0gSTkxNV9GT1JN
QVRfTU9EX1hfVElMRUQ7Cj4gPiBAQCAtODQ3Nyw3ICs4NDc3LDcgQEAgaTl4eF9nZXRfaW5pdGlh
bF9wbGFuZV9jb25maWcoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCXBsYW5lX2Nv
bmZpZy0+cm90YXRpb24gPSBEUk1fTU9ERV9ST1RBVEVfMTgwOwo+ID4gICAJfQo+ID4gLQlpZiAo
SVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgJiYgcGlwZSA9PSBQSVBFX0IgJiYKPiA+ICsJaWYgKElT
X0NIRVJSWVZJRVcoaTkxNSkgJiYgcGlwZSA9PSBQSVBFX0IgJiYKPiA+ICAgCSAgICB2YWwgJiBE
SVNQUExBTkVfTUlSUk9SKQo+ID4gICAJCXBsYW5lX2NvbmZpZy0+cm90YXRpb24gfD0gRFJNX01P
REVfUkVGTEVDVF9YOwo+ID4gQEAgLTg0ODUsMTAgKzg0ODUsMTAgQEAgaTl4eF9nZXRfaW5pdGlh
bF9wbGFuZV9jb25maWcoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAlmb3VyY2MgPSBp
OXh4X2Zvcm1hdF90b19mb3VyY2MocGl4ZWxfZm9ybWF0KTsKPiA+ICAgCWZiLT5mb3JtYXQgPSBk
cm1fZm9ybWF0X2luZm8oZm91cmNjKTsKPiA+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8
IElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwg
SVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gPiAgIAkJb2Zmc2V0ID0gSTkxNV9SRUFEKERTUE9GRlNF
VChpOXh4X3BsYW5lKSk7Cj4gPiAgIAkJYmFzZSA9IEk5MTVfUkVBRChEU1BTVVJGKGk5eHhfcGxh
bmUpKSAmIDB4ZmZmZmYwMDA7Cj4gPiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA0KSB7Cj4gPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpIHsKPiA+ICAgCQlp
ZiAocGxhbmVfY29uZmlnLT50aWxpbmcpCj4gPiAgIAkJCW9mZnNldCA9IEk5MTVfUkVBRChEU1BU
SUxFT0ZGKGk5eHhfcGxhbmUpKTsKPiA+ICAgCQllbHNlCj4gPiBAQCAtODUyMiw3ICs4NTIyLDcg
QEAgc3RhdGljIHZvaWQgY2h2X2NydGNfY2xvY2tfZ2V0KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
LAo+ID4gICAJCQkgICAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+
ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlp
bnQgcGlwZSA9IHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlcjsKPiA+ICAgCWVudW0gZHBpb19j
aGFubmVsIHBvcnQgPSB2bHZfcGlwZV90b19jaGFubmVsKHBpcGUpOwo+ID4gICAJc3RydWN0IGRw
bGwgY2xvY2s7Cj4gPiBAQCAtODUzMywxMyArODUzMywxMyBAQCBzdGF0aWMgdm9pZCBjaHZfY3J0
Y19jbG9ja19nZXQoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAlpZiAoKHBpcGVfY29u
ZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGwgJiBEUExMX1ZDT19FTkFCTEUpID09IDApCj4gPiAgIAkJ
cmV0dXJuOwo+ID4gLQl2bHZfZHBpb19nZXQoZGV2X3ByaXYpOwo+ID4gLQljbW5fZHcxMyA9IHZs
dl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIENIVl9DTU5fRFcxMyhwb3J0KSk7Cj4gPiAtCXBs
bF9kdzAgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfUExMX0RXMChwb3J0KSk7
Cj4gPiAtCXBsbF9kdzEgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfUExMX0RX
MShwb3J0KSk7Cj4gPiAtCXBsbF9kdzIgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBD
SFZfUExMX0RXMihwb3J0KSk7Cj4gPiAtCXBsbF9kdzMgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2
LCBwaXBlLCBDSFZfUExMX0RXMyhwb3J0KSk7Cj4gPiAtCXZsdl9kcGlvX3B1dChkZXZfcHJpdik7
Cj4gPiArCXZsdl9kcGlvX2dldChpOTE1KTsKPiA+ICsJY21uX2R3MTMgPSB2bHZfZHBpb19yZWFk
KGk5MTUsIHBpcGUsIENIVl9DTU5fRFcxMyhwb3J0KSk7Cj4gPiArCXBsbF9kdzAgPSB2bHZfZHBp
b19yZWFkKGk5MTUsIHBpcGUsIENIVl9QTExfRFcwKHBvcnQpKTsKPiA+ICsJcGxsX2R3MSA9IHZs
dl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgQ0hWX1BMTF9EVzEocG9ydCkpOwo+ID4gKwlwbGxfZHcy
ID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBDSFZfUExMX0RXMihwb3J0KSk7Cj4gPiArCXBs
bF9kdzMgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIENIVl9QTExfRFczKHBvcnQpKTsKPiA+
ICsJdmx2X2RwaW9fcHV0KGk5MTUpOwo+ID4gICAJY2xvY2subTEgPSAocGxsX2R3MSAmIDB4Nykg
PT0gRFBJT19DSFZfTTFfRElWX0JZXzIgPyAyIDogMDsKPiA+ICAgCWNsb2NrLm0yID0gKHBsbF9k
dzAgJiAweGZmKSA8PCAyMjsKPiA+IEBAIC04NTU1LDEyICs4NTU1LDEyIEBAIHN0YXRpYyB2b2lk
IGNodl9jcnRjX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgc3RhdGlj
IHZvaWQgaW50ZWxfZ2V0X2NydGNfeWNiY3JfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
LAo+ID4gICAJCQkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gaW50ZWxfb3V0cHV0X2Zvcm1hdCBvdXRwdXQg
PSBJTlRFTF9PVVRQVVRfRk9STUFUX1JHQjsKPiA+ICAgCXBpcGVfY29uZmlnLT5sc3Bjb25fZG93
bnNhbXBsaW5nID0gZmFsc2U7Cj4gPiAtCWlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpIHx8IElO
VEVMX0dFTihkZXZfcHJpdikgPj0gOSkgewo+ID4gKwlpZiAoSVNfQlJPQURXRUxMKGk5MTUpIHx8
IElOVEVMX0dFTihpOTE1KSA+PSA5KSB7Cj4gPiAgIAkJdTMyIHRtcCA9IEk5MTVfUkVBRChQSVBF
TUlTQyhjcnRjLT5waXBlKSk7Cj4gPiAgIAkJaWYgKHRtcCAmIFBJUEVNSVNDX09VVFBVVF9DT0xP
UlNQQUNFX1lVVikgewo+ID4gQEAgLTg1NzEsOCArODU3MSw4IEBAIHN0YXRpYyB2b2lkIGludGVs
X2dldF9jcnRjX3ljYmNyX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJ
CS8qIFdlIHN1cHBvcnQgNDoyOjAgaW4gZnVsbCBibGVuZCBtb2RlIG9ubHkgKi8KPiA+ICAgCQkJ
CWlmICghYmxlbmQpCj4gPiAgIAkJCQkJb3V0cHV0ID0gSU5URUxfT1VUUFVUX0ZPUk1BVF9JTlZB
TElEOwo+ID4gLQkJCQllbHNlIGlmICghKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8Cj4gPiAt
CQkJCQkgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSkKPiA+ICsJCQkJZWxzZSBpZiAoIShJ
U19HRU1JTklMQUtFKGk5MTUpIHx8Cj4gPiArCQkJCQkgICBJTlRFTF9HRU4oaTkxNSkgPj0gMTAp
KQo+ID4gICAJCQkJCW91dHB1dCA9IElOVEVMX09VVFBVVF9GT1JNQVRfSU5WQUxJRDsKPiA+ICAg
CQkJCWVsc2UKPiA+ICAgCQkJCQlvdXRwdXQgPSBJTlRFTF9PVVRQVVRfRk9STUFUX1lDQkNSNDIw
Owo+ID4gQEAgLTg1OTksNyArODU5OSw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfZ2V0X3BpcGVfY29s
b3JfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9w
bGFuZShjcnRjLT5iYXNlLnByaW1hcnkpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gaTl4
eF9wbGFuZV9pZCBpOXh4X3BsYW5lID0gcGxhbmUtPmk5eHhfcGxhbmU7Cj4gPiAgIAl1MzIgdG1w
Owo+ID4gQEAgLTg2MDgsNyArODYwOCw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfZ2V0X3BpcGVfY29s
b3JfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICAJaWYg
KHRtcCAmIERJU1BQTEFORV9HQU1NQV9FTkFCTEUpCj4gPiAgIAkJY3J0Y19zdGF0ZS0+Z2FtbWFf
ZW5hYmxlID0gdHJ1ZTsKPiA+IC0JaWYgKCFIQVNfR01DSChkZXZfcHJpdikgJiYKPiA+ICsJaWYg
KCFIQVNfR01DSChpOTE1KSAmJgo+ID4gICAJICAgIHRtcCAmIERJU1BQTEFORV9QSVBFX0NTQ19F
TkFCTEUpCj4gPiAgIAkJY3J0Y19zdGF0ZS0+Y3NjX2VuYWJsZSA9IHRydWU7Cj4gPiAgIH0KPiA+
IEBAIC04NjE2LDE0ICs4NjE2LDE0IEBAIHN0YXRpYyB2b2lkIGk5eHhfZ2V0X3BpcGVfY29sb3Jf
Y29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICBzdGF0aWMg
Ym9vbCBpOXh4X2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAg
CQkJCSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gPiAgIAllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIHBvd2VyX2Rv
bWFpbjsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJdTMyIHRtcDsKPiA+
ICAgCWJvb2wgcmV0Owo+ID4gICAJcG93ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1BJUEUoY3J0
Yy0+cGlwZSk7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFi
bGVkKGRldl9wcml2LCBwb3dlcl9kb21haW4pOwo+ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxh
eV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LCBwb3dlcl9kb21haW4pOwo+ID4gICAJaWYgKCF3
YWtlcmVmKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IEBAIC04NjM3LDggKzg2MzcsOCBAQCBz
dGF0aWMgYm9vbCBpOXh4X2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiA+ICAgCWlmICghKHRtcCAmIFBJUEVDT05GX0VOQUJMRSkpCj4gPiAgIAkJZ290byBvdXQ7Cj4g
PiAtCWlmIChJU19HNFgoZGV2X3ByaXYpIHx8IElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8Cj4g
PiAtCSAgICBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfRzRYKGk5MTUp
IHx8IElTX1ZBTExFWVZJRVcoaTkxNSkgfHwKPiA+ICsJICAgIElTX0NIRVJSWVZJRVcoaTkxNSkp
IHsKPiA+ICAgCQlzd2l0Y2ggKHRtcCAmIFBJUEVDT05GX0JQQ19NQVNLKSB7Cj4gPiAgIAkJY2Fz
ZSBQSVBFQ09ORl82QlBDOgo+ID4gICAJCQlwaXBlX2NvbmZpZy0+cGlwZV9icHAgPSAxODsKPiA+
IEBAIC04NjU0LDIwICs4NjU0LDIwIEBAIHN0YXRpYyBib29sIGk5eHhfZ2V0X3BpcGVfY29uZmln
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCX0KPiA+ICAgCX0KPiA+IC0JaWYgKChJ
U19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgJiYKPiA+
ICsJaWYgKChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpICYmCj4g
PiAgIAkgICAgKHRtcCAmIFBJUEVDT05GX0NPTE9SX1JBTkdFX1NFTEVDVCkpCj4gPiAgIAkJcGlw
ZV9jb25maWctPmxpbWl0ZWRfY29sb3JfcmFuZ2UgPSB0cnVlOwo+ID4gICAJcGlwZV9jb25maWct
PmdhbW1hX21vZGUgPSAodG1wICYgUElQRUNPTkZfR0FNTUFfTU9ERV9NQVNLX0k5WFgpID4+Cj4g
PiAgIAkJUElQRUNPTkZfR0FNTUFfTU9ERV9TSElGVDsKPiA+IC0JaWYgKElTX0NIRVJSWVZJRVco
ZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICAgCQlwaXBlX2Nv
bmZpZy0+Y2dtX21vZGUgPSBJOTE1X1JFQUQoQ0dNX1BJUEVfTU9ERShjcnRjLT5waXBlKSk7Cj4g
PiAgIAlpOXh4X2dldF9waXBlX2NvbG9yX2NvbmZpZyhwaXBlX2NvbmZpZyk7Cj4gPiAgIAlpbnRl
bF9jb2xvcl9nZXRfY29uZmlnKHBpcGVfY29uZmlnKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPCA0KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNCkKPiA+ICAgCQlwaXBlX2Nv
bmZpZy0+ZG91YmxlX3dpZGUgPSB0bXAgJiBQSVBFQ09ORl9ET1VCTEVfV0lERTsKPiA+ICAgCWlu
dGVsX2dldF9waXBlX3RpbWluZ3MoY3J0YywgcGlwZV9jb25maWcpOwo+ID4gQEAgLTg2NzUsMTgg
Kzg2NzUsMTggQEAgc3RhdGljIGJvb2wgaTl4eF9nZXRfcGlwZV9jb25maWcoc3RydWN0IGludGVs
X2NydGMgKmNydGMsCj4gPiAgIAlpOXh4X2dldF9wZml0X2NvbmZpZyhjcnRjLCBwaXBlX2NvbmZp
Zyk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpIHsKPiA+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSA0KSB7Cj4gPiAgIAkJLyogTm8gd2F5IHRvIHJlYWQgaXQgb3V0IG9uIHBp
cGVzIEIgYW5kIEMgKi8KPiA+IC0JCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSAmJiBjcnRj
LT5waXBlICE9IFBJUEVfQSkKPiA+IC0JCQl0bXAgPSBkZXZfcHJpdi0+Y2h2X2RwbGxfbWRbY3J0
Yy0+cGlwZV07Cj4gPiArCQlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSAmJiBjcnRjLT5waXBlICE9
IFBJUEVfQSkKPiA+ICsJCQl0bXAgPSBpOTE1LT5jaHZfZHBsbF9tZFtjcnRjLT5waXBlXTsKPiA+
ICAgCQllbHNlCj4gPiAgIAkJCXRtcCA9IEk5MTVfUkVBRChEUExMX01EKGNydGMtPnBpcGUpKTsK
PiA+ICAgCQlwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllciA9Cj4gPiAgIAkJCSgodG1wICYg
RFBMTF9NRF9VRElfTVVMVElQTElFUl9NQVNLKQo+ID4gICAJCQkgPj4gRFBMTF9NRF9VRElfTVVM
VElQTElFUl9TSElGVCkgKyAxOwo+ID4gICAJCXBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmRw
bGxfbWQgPSB0bXA7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfSTk0NUcoZGV2X3ByaXYpIHx8IElTX0k5
NDVHTShkZXZfcHJpdikgfHwKPiA+IC0JCSAgIElTX0czMyhkZXZfcHJpdikgfHwgSVNfUElORVZJ
RVcoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfSTk0NUcoaTkxNSkgfHwgSVNfSTk0
NUdNKGk5MTUpIHx8Cj4gPiArCQkgICBJU19HMzMoaTkxNSkgfHwgSVNfUElORVZJRVcoaTkxNSkp
IHsKPiA+ICAgCQl0bXAgPSBJOTE1X1JFQUQoRFBMTChjcnRjLT5waXBlKSk7Cj4gPiAgIAkJcGlw
ZV9jb25maWctPnBpeGVsX211bHRpcGxpZXIgPQo+ID4gICAJCQkoKHRtcCAmIFNEVk9fTVVMVElQ
TElFUl9NQVNLKQo+ID4gQEAgLTg2OTgsNyArODY5OCw3IEBAIHN0YXRpYyBib29sIGk5eHhfZ2V0
X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCXBpcGVfY29uZmln
LT5waXhlbF9tdWx0aXBsaWVyID0gMTsKPiA+ICAgCX0KPiA+ICAgCXBpcGVfY29uZmlnLT5kcGxs
X2h3X3N0YXRlLmRwbGwgPSBJOTE1X1JFQUQoRFBMTChjcnRjLT5waXBlKSk7Cj4gPiAtCWlmICgh
SVNfVkFMTEVZVklFVyhkZXZfcHJpdikgJiYgIUlTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4g
PiArCWlmICghSVNfVkFMTEVZVklFVyhpOTE1KSAmJiAhSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+
ID4gICAJCXBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmZwMCA9IEk5MTVfUkVBRChGUDAoY3J0
Yy0+cGlwZSkpOwo+ID4gICAJCXBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmZwMSA9IEk5MTVf
UkVBRChGUDEoY3J0Yy0+cGlwZSkpOwo+ID4gICAJfSBlbHNlIHsKPiA+IEBAIC04NzA4LDkgKzg3
MDgsOSBAQCBzdGF0aWMgYm9vbCBpOXh4X2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKPiA+ICAgCQkJCQkJICAgICBEUExMX1BPUlRCX1JFQURZX01BU0spOwo+ID4gICAJ
fQo+ID4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiArCWlmIChJU19DSEVSUllW
SUVXKGk5MTUpKQo+ID4gICAJCWNodl9jcnRjX2Nsb2NrX2dldChjcnRjLCBwaXBlX2NvbmZpZyk7
Cj4gPiAtCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJ
U19WQUxMRVlWSUVXKGk5MTUpKQo+ID4gICAJCXZsdl9jcnRjX2Nsb2NrX2dldChjcnRjLCBwaXBl
X2NvbmZpZyk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJaTl4eF9jcnRjX2Nsb2NrX2dldChjcnRjLCBw
aXBlX2NvbmZpZyk7Cj4gPiBAQCAtODcyNiwxMiArODcyNiwxMiBAQCBzdGF0aWMgYm9vbCBpOXh4
X2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCXJldCA9IHRy
dWU7Cj4gPiAgIG91dDoKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIHBv
d2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUs
IHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiAt
c3RhdGljIHZvaWQgaXJvbmxha2VfaW5pdF9wY2hfcmVmY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpcm9ubGFrZV9pbml0X3BjaF9yZWZjbGso
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyOwo+ID4gICAJaW50IGk7Cj4gPiBAQCAtODc0NCw3ICs4NzQ0LDcg
QEAgc3RhdGljIHZvaWQgaXJvbmxha2VfaW5pdF9wY2hfcmVmY2xrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICAgCWJvb2wgdXNpbmdfc3NjX3NvdXJjZSA9IGZhbHNlOwo+
ID4gICAJLyogV2UgbmVlZCB0byB0YWtlIHRoZSBnbG9iYWwgY29uZmlnIGludG8gYWNjb3VudCAq
Lwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9lbmNvZGVyKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7
Cj4gPiArCWZvcl9lYWNoX2ludGVsX2VuY29kZXIoJmk5MTUtPmRybSwgZW5jb2Rlcikgewo+ID4g
ICAJCXN3aXRjaCAoZW5jb2Rlci0+dHlwZSkgewo+ID4gICAJCWNhc2UgSU5URUxfT1VUUFVUX0xW
RFM6Cj4gPiAgIAkJCWhhc19wYW5lbCA9IHRydWU7Cj4gPiBAQCAtODc2MCw4ICs4NzYwLDggQEAg
c3RhdGljIHZvaWQgaXJvbmxha2VfaW5pdF9wY2hfcmVmY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICAgCQl9Cj4gPiAgIAl9Cj4gPiAtCWlmIChIQVNfUENIX0lCWChk
ZXZfcHJpdikpIHsKPiA+IC0JCWhhc19jazUwNSA9IGRldl9wcml2LT52YnQuZGlzcGxheV9jbG9j
a19tb2RlOwo+ID4gKwlpZiAoSEFTX1BDSF9JQlgoaTkxNSkpIHsKPiA+ICsJCWhhc19jazUwNSA9
IGk5MTUtPnZidC5kaXNwbGF5X2Nsb2NrX21vZGU7Cj4gPiAgIAkJY2FuX3NzYyA9IGhhc19jazUw
NTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAgIAkJaGFzX2NrNTA1ID0gZmFsc2U7Cj4gPiBAQCAtODc2
OSw3ICs4NzY5LDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfaW5pdF9wY2hfcmVmY2xrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCX0KPiA+ICAgCS8qIENoZWNrIGlm
IGFueSBEUExMcyBhcmUgdXNpbmcgdGhlIFNTQyBzb3VyY2UgKi8KPiA+IC0JZm9yIChpID0gMDsg
aSA8IGRldl9wcml2LT5udW1fc2hhcmVkX2RwbGw7IGkrKykgewo+ID4gKwlmb3IgKGkgPSAwOyBp
IDwgaTkxNS0+bnVtX3NoYXJlZF9kcGxsOyBpKyspIHsKPiA+ICAgCQl1MzIgdGVtcCA9IEk5MTVf
UkVBRChQQ0hfRFBMTChpKSk7Cj4gPiAgIAkJaWYgKCEodGVtcCAmIERQTExfVkNPX0VOQUJMRSkp
Cj4gPiBAQCAtODgxMCwxMSArODgxMCwxMSBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9pbml0X3Bj
aF9yZWZjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJaWYgKGhh
c19wYW5lbCkgewo+ID4gICAJCWZpbmFsIHw9IERSRUZfU1NDX1NPVVJDRV9FTkFCTEU7Cj4gPiAt
CQlpZiAoaW50ZWxfcGFuZWxfdXNlX3NzYyhkZXZfcHJpdikgJiYgY2FuX3NzYykKPiA+ICsJCWlm
IChpbnRlbF9wYW5lbF91c2Vfc3NjKGk5MTUpICYmIGNhbl9zc2MpCj4gPiAgIAkJCWZpbmFsIHw9
IERSRUZfU1NDMV9FTkFCTEU7Cj4gPiAgIAkJaWYgKGhhc19jcHVfZWRwKSB7Cj4gPiAtCQkJaWYg
KGludGVsX3BhbmVsX3VzZV9zc2MoZGV2X3ByaXYpICYmIGNhbl9zc2MpCj4gPiArCQkJaWYgKGlu
dGVsX3BhbmVsX3VzZV9zc2MoaTkxNSkgJiYgY2FuX3NzYykKPiA+ICAgCQkJCWZpbmFsIHw9IERS
RUZfQ1BVX1NPVVJDRV9PVVRQVVRfRE9XTlNQUkVBRDsKPiA+ICAgCQkJZWxzZQo+ID4gICAJCQkJ
ZmluYWwgfD0gRFJFRl9DUFVfU09VUkNFX09VVFBVVF9OT05TUFJFQUQ7Cj4gPiBAQCAtODg0MSw3
ICs4ODQxLDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfaW5pdF9wY2hfcmVmY2xrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQl2YWwgfD0gRFJFRl9TU0NfU09VUkNF
X0VOQUJMRTsKPiA+ICAgCQkvKiBTU0MgbXVzdCBiZSB0dXJuZWQgb24gYmVmb3JlIGVuYWJsaW5n
IHRoZSBDUFUgb3V0cHV0ICAqLwo+ID4gLQkJaWYgKGludGVsX3BhbmVsX3VzZV9zc2MoZGV2X3By
aXYpICYmIGNhbl9zc2MpIHsKPiA+ICsJCWlmIChpbnRlbF9wYW5lbF91c2Vfc3NjKGk5MTUpICYm
IGNhbl9zc2MpIHsKPiA+ICAgCQkJRFJNX0RFQlVHX0tNUygiVXNpbmcgU1NDIG9uIHBhbmVsXG4i
KTsKPiA+ICAgCQkJdmFsIHw9IERSRUZfU1NDMV9FTkFCTEU7Cj4gPiAgIAkJfSBlbHNlCj4gPiBA
QCAtODg1Niw3ICs4ODU2LDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfaW5pdF9wY2hfcmVmY2xr
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkvKiBFbmFibGUgQ1BV
IHNvdXJjZSBvbiBDUFUgYXR0YWNoZWQgZURQICovCj4gPiAgIAkJaWYgKGhhc19jcHVfZWRwKSB7
Cj4gPiAtCQkJaWYgKGludGVsX3BhbmVsX3VzZV9zc2MoZGV2X3ByaXYpICYmIGNhbl9zc2MpIHsK
PiA+ICsJCQlpZiAoaW50ZWxfcGFuZWxfdXNlX3NzYyhpOTE1KSAmJiBjYW5fc3NjKSB7Cj4gPiAg
IAkJCQlEUk1fREVCVUdfS01TKCJVc2luZyBTU0Mgb24gZURQXG4iKTsKPiA+ICAgCQkJCXZhbCB8
PSBEUkVGX0NQVV9TT1VSQ0VfT1VUUFVUX0RPV05TUFJFQUQ7Cj4gPiAgIAkJCX0gZWxzZQo+ID4g
QEAgLTg4OTgsNyArODg5OCw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2luaXRfcGNoX3JlZmNs
ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlCVUdfT04odmFsICE9
IGZpbmFsKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGxwdF9yZXNldF9mZGlfbXBoeShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgbHB0X3Jlc2V0
X2ZkaV9tcGh5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1
MzIgdG1wOwo+ID4gQEAgLTg5MjAsNzggKzg5MjAsNzggQEAgc3RhdGljIHZvaWQgbHB0X3Jlc2V0
X2ZkaV9tcGh5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgfQo+ID4g
ICAvKiBXYU1QaHlQcm9ncmFtbWluZzpoc3cgKi8KPiA+IC1zdGF0aWMgdm9pZCBscHRfcHJvZ3Jh
bV9mZGlfbXBoeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGlj
IHZvaWQgbHB0X3Byb2dyYW1fZmRpX21waHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+ICAgCXUzMiB0bXA7Cj4gPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9w
cml2LCAweDgwMDgsIFNCSV9NUEhZKTsKPiA+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwg
MHg4MDA4LCBTQklfTVBIWSk7Cj4gPiAgIAl0bXAgJj0gfigweEZGIDw8IDI0KTsKPiA+ICAgCXRt
cCB8PSAoMHgxMiA8PCAyNCk7Cj4gPiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJpdiwgMHg4MDA4
LCB0bXAsIFNCSV9NUEhZKTsKPiA+ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIDB4ODAwOCwgdG1w
LCBTQklfTVBIWSk7Cj4gPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCAweDIwMDgs
IFNCSV9NUEhZKTsKPiA+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgMHgyMDA4LCBTQklf
TVBIWSk7Cj4gPiAgIAl0bXAgfD0gKDEgPDwgMTEpOwo+ID4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2
X3ByaXYsIDB4MjAwOCwgdG1wLCBTQklfTVBIWSk7Cj4gPiArCWludGVsX3NiaV93cml0ZShpOTE1
LCAweDIwMDgsIHRtcCwgU0JJX01QSFkpOwo+ID4gLQl0bXAgPSBpbnRlbF9zYmlfcmVhZChkZXZf
cHJpdiwgMHgyMTA4LCBTQklfTVBIWSk7Cj4gPiArCXRtcCA9IGludGVsX3NiaV9yZWFkKGk5MTUs
IDB4MjEwOCwgU0JJX01QSFkpOwo+ID4gICAJdG1wIHw9ICgxIDw8IDExKTsKPiA+IC0JaW50ZWxf
c2JpX3dyaXRlKGRldl9wcml2LCAweDIxMDgsIHRtcCwgU0JJX01QSFkpOwo+ID4gKwlpbnRlbF9z
Ymlfd3JpdGUoaTkxNSwgMHgyMTA4LCB0bXAsIFNCSV9NUEhZKTsKPiA+IC0JdG1wID0gaW50ZWxf
c2JpX3JlYWQoZGV2X3ByaXYsIDB4MjA2QywgU0JJX01QSFkpOwo+ID4gKwl0bXAgPSBpbnRlbF9z
YmlfcmVhZChpOTE1LCAweDIwNkMsIFNCSV9NUEhZKTsKPiA+ICAgCXRtcCB8PSAoMSA8PCAyNCkg
fCAoMSA8PCAyMSkgfCAoMSA8PCAxOCk7Cj4gPiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJpdiwg
MHgyMDZDLCB0bXAsIFNCSV9NUEhZKTsKPiA+ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIDB4MjA2
QywgdG1wLCBTQklfTVBIWSk7Cj4gPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCAw
eDIxNkMsIFNCSV9NUEhZKTsKPiA+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgMHgyMTZD
LCBTQklfTVBIWSk7Cj4gPiAgIAl0bXAgfD0gKDEgPDwgMjQpIHwgKDEgPDwgMjEpIHwgKDEgPDwg
MTgpOwo+ID4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIDB4MjE2QywgdG1wLCBTQklfTVBI
WSk7Cj4gPiArCWludGVsX3NiaV93cml0ZShpOTE1LCAweDIxNkMsIHRtcCwgU0JJX01QSFkpOwo+
ID4gLQl0bXAgPSBpbnRlbF9zYmlfcmVhZChkZXZfcHJpdiwgMHgyMDgwLCBTQklfTVBIWSk7Cj4g
PiArCXRtcCA9IGludGVsX3NiaV9yZWFkKGk5MTUsIDB4MjA4MCwgU0JJX01QSFkpOwo+ID4gICAJ
dG1wICY9IH4oNyA8PCAxMyk7Cj4gPiAgIAl0bXAgfD0gKDUgPDwgMTMpOwo+ID4gLQlpbnRlbF9z
Ymlfd3JpdGUoZGV2X3ByaXYsIDB4MjA4MCwgdG1wLCBTQklfTVBIWSk7Cj4gPiArCWludGVsX3Ni
aV93cml0ZShpOTE1LCAweDIwODAsIHRtcCwgU0JJX01QSFkpOwo+ID4gLQl0bXAgPSBpbnRlbF9z
YmlfcmVhZChkZXZfcHJpdiwgMHgyMTgwLCBTQklfTVBIWSk7Cj4gPiArCXRtcCA9IGludGVsX3Ni
aV9yZWFkKGk5MTUsIDB4MjE4MCwgU0JJX01QSFkpOwo+ID4gICAJdG1wICY9IH4oNyA8PCAxMyk7
Cj4gPiAgIAl0bXAgfD0gKDUgPDwgMTMpOwo+ID4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYs
IDB4MjE4MCwgdG1wLCBTQklfTVBIWSk7Cj4gPiArCWludGVsX3NiaV93cml0ZShpOTE1LCAweDIx
ODAsIHRtcCwgU0JJX01QSFkpOwo+ID4gLQl0bXAgPSBpbnRlbF9zYmlfcmVhZChkZXZfcHJpdiwg
MHgyMDhDLCBTQklfTVBIWSk7Cj4gPiArCXRtcCA9IGludGVsX3NiaV9yZWFkKGk5MTUsIDB4MjA4
QywgU0JJX01QSFkpOwo+ID4gICAJdG1wICY9IH4weEZGOwo+ID4gICAJdG1wIHw9IDB4MUM7Cj4g
PiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJpdiwgMHgyMDhDLCB0bXAsIFNCSV9NUEhZKTsKPiA+
ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIDB4MjA4QywgdG1wLCBTQklfTVBIWSk7Cj4gPiAtCXRt
cCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCAweDIxOEMsIFNCSV9NUEhZKTsKPiA+ICsJdG1w
ID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgMHgyMThDLCBTQklfTVBIWSk7Cj4gPiAgIAl0bXAgJj0g
fjB4RkY7Cj4gPiAgIAl0bXAgfD0gMHgxQzsKPiA+IC0JaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2
LCAweDIxOEMsIHRtcCwgU0JJX01QSFkpOwo+ID4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgMHgy
MThDLCB0bXAsIFNCSV9NUEhZKTsKPiA+IC0JdG1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYs
IDB4MjA5OCwgU0JJX01QSFkpOwo+ID4gKwl0bXAgPSBpbnRlbF9zYmlfcmVhZChpOTE1LCAweDIw
OTgsIFNCSV9NUEhZKTsKPiA+ICAgCXRtcCAmPSB+KDB4RkYgPDwgMTYpOwo+ID4gICAJdG1wIHw9
ICgweDFDIDw8IDE2KTsKPiA+IC0JaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCAweDIwOTgsIHRt
cCwgU0JJX01QSFkpOwo+ID4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgMHgyMDk4LCB0bXAsIFNC
SV9NUEhZKTsKPiA+IC0JdG1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIDB4MjE5OCwgU0JJ
X01QSFkpOwo+ID4gKwl0bXAgPSBpbnRlbF9zYmlfcmVhZChpOTE1LCAweDIxOTgsIFNCSV9NUEhZ
KTsKPiA+ICAgCXRtcCAmPSB+KDB4RkYgPDwgMTYpOwo+ID4gICAJdG1wIHw9ICgweDFDIDw8IDE2
KTsKPiA+IC0JaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCAweDIxOTgsIHRtcCwgU0JJX01QSFkp
Owo+ID4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgMHgyMTk4LCB0bXAsIFNCSV9NUEhZKTsKPiA+
IC0JdG1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIDB4MjBDNCwgU0JJX01QSFkpOwo+ID4g
Kwl0bXAgPSBpbnRlbF9zYmlfcmVhZChpOTE1LCAweDIwQzQsIFNCSV9NUEhZKTsKPiA+ICAgCXRt
cCB8PSAoMSA8PCAyNyk7Cj4gPiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJpdiwgMHgyMEM0LCB0
bXAsIFNCSV9NUEhZKTsKPiA+ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIDB4MjBDNCwgdG1wLCBT
QklfTVBIWSk7Cj4gPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCAweDIxQzQsIFNC
SV9NUEhZKTsKPiA+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgMHgyMUM0LCBTQklfTVBI
WSk7Cj4gPiAgIAl0bXAgfD0gKDEgPDwgMjcpOwo+ID4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3By
aXYsIDB4MjFDNCwgdG1wLCBTQklfTVBIWSk7Cj4gPiArCWludGVsX3NiaV93cml0ZShpOTE1LCAw
eDIxQzQsIHRtcCwgU0JJX01QSFkpOwo+ID4gLQl0bXAgPSBpbnRlbF9zYmlfcmVhZChkZXZfcHJp
diwgMHgyMEVDLCBTQklfTVBIWSk7Cj4gPiArCXRtcCA9IGludGVsX3NiaV9yZWFkKGk5MTUsIDB4
MjBFQywgU0JJX01QSFkpOwo+ID4gICAJdG1wICY9IH4oMHhGIDw8IDI4KTsKPiA+ICAgCXRtcCB8
PSAoNCA8PCAyOCk7Cj4gPiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJpdiwgMHgyMEVDLCB0bXAs
IFNCSV9NUEhZKTsKPiA+ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIDB4MjBFQywgdG1wLCBTQklf
TVBIWSk7Cj4gPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2LCAweDIxRUMsIFNCSV9N
UEhZKTsKPiA+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgMHgyMUVDLCBTQklfTVBIWSk7
Cj4gPiAgIAl0bXAgJj0gfigweEYgPDwgMjgpOwo+ID4gICAJdG1wIHw9ICg0IDw8IDI4KTsKPiA+
IC0JaW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCAweDIxRUMsIHRtcCwgU0JJX01QSFkpOwo+ID4g
KwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgMHgyMUVDLCB0bXAsIFNCSV9NUEhZKTsKPiA+ICAgfQo+
ID4gICAvKiBJbXBsZW1lbnRzIDMgZGlmZmVyZW50IHNlcXVlbmNlcyBmcm9tIEJTcGVjIGNoYXB0
ZXIgIkRpc3BsYXkgaUNMSwo+ID4gQEAgLTkwMDAsNjkgKzkwMDAsNjkgQEAgc3RhdGljIHZvaWQg
bHB0X3Byb2dyYW1fZmRpX21waHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gICAgKiAtIFNlcXVlbmNlIHRvIGVuYWJsZSBDTEtPVVRfRFAgd2l0aG91dCBzcHJlYWQKPiA+
ICAgICogLSBTZXF1ZW5jZSB0byBlbmFibGUgQ0xLT1VUX0RQIGZvciBGREkgdXNhZ2UgYW5kIGNv
bmZpZ3VyZSBQQ0ggRkRJIEkvTwo+ID4gICAgKi8KPiA+IC1zdGF0aWMgdm9pZCBscHRfZW5hYmxl
X2Nsa291dF9kcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGlj
IHZvaWQgbHB0X2VuYWJsZV9jbGtvdXRfZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gPiAgIAkJCQkgYm9vbCB3aXRoX3NwcmVhZCwgYm9vbCB3aXRoX2ZkaSkKPiA+ICAgewo+ID4g
ICAJdTMyIHJlZywgdG1wOwo+ID4gICAJaWYgKFdBUk4od2l0aF9mZGkgJiYgIXdpdGhfc3ByZWFk
LCAiRkRJIHJlcXVpcmVzIGRvd25zcHJlYWRcbiIpKQo+ID4gICAJCXdpdGhfc3ByZWFkID0gdHJ1
ZTsKPiA+IC0JaWYgKFdBUk4oSEFTX1BDSF9MUFRfTFAoZGV2X3ByaXYpICYmCj4gPiArCWlmIChX
QVJOKEhBU19QQ0hfTFBUX0xQKGk5MTUpICYmCj4gPiAgIAkgICAgd2l0aF9mZGksICJMUCBQQ0gg
ZG9lc24ndCBoYXZlIEZESVxuIikpCj4gPiAgIAkJd2l0aF9mZGkgPSBmYWxzZTsKPiA+IC0JbXV0
ZXhfbG9jaygmZGV2X3ByaXYtPnNiX2xvY2spOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5zYl9s
b2NrKTsKPiA+IC0JdG1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIFNCSV9TU0NDVEwsIFNC
SV9JQ0xLKTsKPiA+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgU0JJX1NTQ0NUTCwgU0JJ
X0lDTEspOwo+ID4gICAJdG1wICY9IH5TQklfU1NDQ1RMX0RJU0FCTEU7Cj4gPiAgIAl0bXAgfD0g
U0JJX1NTQ0NUTF9QQVRIQUxUOwo+ID4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIFNCSV9T
U0NDVEwsIHRtcCwgU0JJX0lDTEspOwo+ID4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgU0JJX1NT
Q0NUTCwgdG1wLCBTQklfSUNMSyk7Cj4gPiAgIAl1ZGVsYXkoMjQpOwo+ID4gICAJaWYgKHdpdGhf
c3ByZWFkKSB7Cj4gPiAtCQl0bXAgPSBpbnRlbF9zYmlfcmVhZChkZXZfcHJpdiwgU0JJX1NTQ0NU
TCwgU0JJX0lDTEspOwo+ID4gKwkJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgU0JJX1NTQ0NU
TCwgU0JJX0lDTEspOwo+ID4gICAJCXRtcCAmPSB+U0JJX1NTQ0NUTF9QQVRIQUxUOwo+ID4gLQkJ
aW50ZWxfc2JpX3dyaXRlKGRldl9wcml2LCBTQklfU1NDQ1RMLCB0bXAsIFNCSV9JQ0xLKTsKPiA+
ICsJCWludGVsX3NiaV93cml0ZShpOTE1LCBTQklfU1NDQ1RMLCB0bXAsIFNCSV9JQ0xLKTsKPiA+
ICAgCQlpZiAod2l0aF9mZGkpIHsKPiA+IC0JCQlscHRfcmVzZXRfZmRpX21waHkoZGV2X3ByaXYp
Owo+ID4gLQkJCWxwdF9wcm9ncmFtX2ZkaV9tcGh5KGRldl9wcml2KTsKPiA+ICsJCQlscHRfcmVz
ZXRfZmRpX21waHkoaTkxNSk7Cj4gPiArCQkJbHB0X3Byb2dyYW1fZmRpX21waHkoaTkxNSk7Cj4g
PiAgIAkJfQo+ID4gICAJfQo+ID4gLQlyZWcgPSBIQVNfUENIX0xQVF9MUChkZXZfcHJpdikgPyBT
QklfR0VOMCA6IFNCSV9EQlVGRjA7Cj4gPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2
LCByZWcsIFNCSV9JQ0xLKTsKPiA+ICsJcmVnID0gSEFTX1BDSF9MUFRfTFAoaTkxNSkgPyBTQklf
R0VOMCA6IFNCSV9EQlVGRjA7Cj4gPiArCXRtcCA9IGludGVsX3NiaV9yZWFkKGk5MTUsIHJlZywg
U0JJX0lDTEspOwo+ID4gICAJdG1wIHw9IFNCSV9HRU4wX0NGR19CVUZGRU5BQkxFX0RJU0FCTEU7
Cj4gPiAtCWludGVsX3NiaV93cml0ZShkZXZfcHJpdiwgcmVnLCB0bXAsIFNCSV9JQ0xLKTsKPiA+
ICsJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIHJlZywgdG1wLCBTQklfSUNMSyk7Cj4gPiAtCW11dGV4
X3VubG9jaygmZGV2X3ByaXYtPnNiX2xvY2spOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPnNi
X2xvY2spOwo+ID4gICB9Cj4gPiAgIC8qIFNlcXVlbmNlIHRvIGRpc2FibGUgQ0xLT1VUX0RQICov
Cj4gPiAtdm9pZCBscHRfZGlzYWJsZV9jbGtvdXRfZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gK3ZvaWQgbHB0X2Rpc2FibGVfY2xrb3V0X2RwKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIgcmVnLCB0bXA7Cj4gPiAtCW11dGV4
X2xvY2soJmRldl9wcml2LT5zYl9sb2NrKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+c2JfbG9j
ayk7Cj4gPiAtCXJlZyA9IEhBU19QQ0hfTFBUX0xQKGRldl9wcml2KSA/IFNCSV9HRU4wIDogU0JJ
X0RCVUZGMDsKPiA+IC0JdG1wID0gaW50ZWxfc2JpX3JlYWQoZGV2X3ByaXYsIHJlZywgU0JJX0lD
TEspOwo+ID4gKwlyZWcgPSBIQVNfUENIX0xQVF9MUChpOTE1KSA/IFNCSV9HRU4wIDogU0JJX0RC
VUZGMDsKPiA+ICsJdG1wID0gaW50ZWxfc2JpX3JlYWQoaTkxNSwgcmVnLCBTQklfSUNMSyk7Cj4g
PiAgIAl0bXAgJj0gflNCSV9HRU4wX0NGR19CVUZGRU5BQkxFX0RJU0FCTEU7Cj4gPiAtCWludGVs
X3NiaV93cml0ZShkZXZfcHJpdiwgcmVnLCB0bXAsIFNCSV9JQ0xLKTsKPiA+ICsJaW50ZWxfc2Jp
X3dyaXRlKGk5MTUsIHJlZywgdG1wLCBTQklfSUNMSyk7Cj4gPiAtCXRtcCA9IGludGVsX3NiaV9y
ZWFkKGRldl9wcml2LCBTQklfU1NDQ1RMLCBTQklfSUNMSyk7Cj4gPiArCXRtcCA9IGludGVsX3Ni
aV9yZWFkKGk5MTUsIFNCSV9TU0NDVEwsIFNCSV9JQ0xLKTsKPiA+ICAgCWlmICghKHRtcCAmIFNC
SV9TU0NDVExfRElTQUJMRSkpIHsKPiA+ICAgCQlpZiAoISh0bXAgJiBTQklfU1NDQ1RMX1BBVEhB
TFQpKSB7Cj4gPiAgIAkJCXRtcCB8PSBTQklfU1NDQ1RMX1BBVEhBTFQ7Cj4gPiAtCQkJaW50ZWxf
c2JpX3dyaXRlKGRldl9wcml2LCBTQklfU1NDQ1RMLCB0bXAsIFNCSV9JQ0xLKTsKPiA+ICsJCQlp
bnRlbF9zYmlfd3JpdGUoaTkxNSwgU0JJX1NTQ0NUTCwgdG1wLCBTQklfSUNMSyk7Cj4gPiAgIAkJ
CXVkZWxheSgzMik7Cj4gPiAgIAkJfQo+ID4gICAJCXRtcCB8PSBTQklfU1NDQ1RMX0RJU0FCTEU7
Cj4gPiAtCQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIFNCSV9TU0NDVEwsIHRtcCwgU0JJX0lD
TEspOwo+ID4gKwkJaW50ZWxfc2JpX3dyaXRlKGk5MTUsIFNCSV9TU0NDVEwsIHRtcCwgU0JJX0lD
TEspOwo+ID4gICAJfQo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5zYl9sb2NrKTsKPiA+
ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5zYl9sb2NrKTsKPiA+ICAgfQo+ID4gICAjZGVmaW5lIEJF
TkRfSURYKHN0ZXBzKSAoKDUwICsgKHN0ZXBzKSkgLyA1KQo+ID4gQEAgLTkwOTcsNyArOTA5Nyw3
IEBAIHN0YXRpYyBjb25zdCB1MTYgc3NjZGl2aW50cGhhc2VbXSA9IHsKPiA+ICAgICogPCAwIHNs
b3cgZG93biB0aGUgY2xvY2ssID4gMCBzcGVlZCB1cCB0aGUgY2xvY2ssIDAgPT0gbm8gYmVuZCAo
MTM1TUh6KQo+ID4gICAgKiBjaGFuZ2UgaW4gY2xvY2sgcGVyaW9kID0gLShzdGVwcyAvIDEwKSAq
IDUuNzg3IHBzCj4gPiAgICAqLwo+ID4gLXN0YXRpYyB2b2lkIGxwdF9iZW5kX2Nsa291dF9kcChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCBzdGVwcykKPiA+ICtzdGF0aWMg
dm9pZCBscHRfYmVuZF9jbGtvdXRfZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGlu
dCBzdGVwcykKPiA+ICAgewo+ID4gICAJdTMyIHRtcDsKPiA+ICAgCWludCBpZHggPSBCRU5EX0lE
WChzdGVwcyk7Cj4gPiBAQCAtOTEwOCwyNSArOTEwOCwyNSBAQCBzdGF0aWMgdm9pZCBscHRfYmVu
ZF9jbGtvdXRfZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgc3RlcHMp
Cj4gPiAgIAlpZiAoV0FSTl9PTihpZHggPj0gQVJSQVlfU0laRShzc2NkaXZpbnRwaGFzZSkpKQo+
ID4gICAJCXJldHVybjsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnNiX2xvY2spOwo+ID4g
KwltdXRleF9sb2NrKCZpOTE1LT5zYl9sb2NrKTsKPiA+ICAgCWlmIChzdGVwcyAlIDEwICE9IDAp
Cj4gPiAgIAkJdG1wID0gMHhBQUFBQUFBQjsKPiA+ICAgCWVsc2UKPiA+ICAgCQl0bXAgPSAweDAw
MDAwMDAwOwo+ID4gLQlpbnRlbF9zYmlfd3JpdGUoZGV2X3ByaXYsIFNCSV9TU0NESVRIUEhBU0Us
IHRtcCwgU0JJX0lDTEspOwo+ID4gKwlpbnRlbF9zYmlfd3JpdGUoaTkxNSwgU0JJX1NTQ0RJVEhQ
SEFTRSwgdG1wLCBTQklfSUNMSyk7Cj4gPiAtCXRtcCA9IGludGVsX3NiaV9yZWFkKGRldl9wcml2
LCBTQklfU1NDRElWSU5UUEhBU0UsIFNCSV9JQ0xLKTsKPiA+ICsJdG1wID0gaW50ZWxfc2JpX3Jl
YWQoaTkxNSwgU0JJX1NTQ0RJVklOVFBIQVNFLCBTQklfSUNMSyk7Cj4gPiAgIAl0bXAgJj0gMHhm
ZmZmMDAwMDsKPiA+ICAgCXRtcCB8PSBzc2NkaXZpbnRwaGFzZVtpZHhdOwo+ID4gLQlpbnRlbF9z
Ymlfd3JpdGUoZGV2X3ByaXYsIFNCSV9TU0NESVZJTlRQSEFTRSwgdG1wLCBTQklfSUNMSyk7Cj4g
PiArCWludGVsX3NiaV93cml0ZShpOTE1LCBTQklfU1NDRElWSU5UUEhBU0UsIHRtcCwgU0JJX0lD
TEspOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5zYl9sb2NrKTsKPiA+ICsJbXV0ZXhf
dW5sb2NrKCZpOTE1LT5zYl9sb2NrKTsKPiA+ICAgfQo+ID4gICAjdW5kZWYgQkVORF9JRFgKPiA+
IC1zdGF0aWMgYm9vbCBzcGxsX3VzZXNfcGNoX3NzYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiArc3RhdGljIGJvb2wgc3BsbF91c2VzX3BjaF9zc2Moc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiBmdXNlX3N0cmFwID0gSTkxNV9S
RUFEKEZVU0VfU1RSQVApOwo+ID4gICAJdTMyIGN0bCA9IEk5MTVfUkVBRChTUExMX0NUTCk7Cj4g
PiBAQCAtOTEzOCwxNCArOTEzOCwxNCBAQCBzdGF0aWMgYm9vbCBzcGxsX3VzZXNfcGNoX3NzYyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgICAgKGZ1c2Vfc3RyYXAg
JiBIU1dfQ1BVX1NTQ19FTkFCTEUpID09IDApCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAtCWlm
IChJU19CUk9BRFdFTEwoZGV2X3ByaXYpICYmCj4gPiArCWlmIChJU19CUk9BRFdFTEwoaTkxNSkg
JiYKPiA+ICAgCSAgICAoY3RsICYgU1BMTF9SRUZfTUFTSykgPT0gU1BMTF9SRUZfUENIX1NTQ19C
RFcpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAgIAlyZXR1cm4gZmFsc2U7Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgYm9vbCB3cnBsbF91c2VzX3BjaF9zc2Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIHdycGxsX3VzZXNfcGNoX3NzYyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgIGVudW0gaW50ZWxfZHBsbF9pZCBp
ZCkKPiA+ICAgewo+ID4gICAJdTMyIGZ1c2Vfc3RyYXAgPSBJOTE1X1JFQUQoRlVTRV9TVFJBUCk7
Cj4gPiBAQCAtOTE1Nyw3ICs5MTU3LDcgQEAgc3RhdGljIGJvb2wgd3JwbGxfdXNlc19wY2hfc3Nj
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWlmICgoY3RsICYgV1JQ
TExfUkVGX01BU0spID09IFdSUExMX1JFRl9QQ0hfU1NDKQo+ID4gICAJCXJldHVybiB0cnVlOwo+
ID4gLQlpZiAoKElTX0JST0FEV0VMTChkZXZfcHJpdikgfHwgSVNfSFNXX1VMVChkZXZfcHJpdikp
ICYmCj4gPiArCWlmICgoSVNfQlJPQURXRUxMKGk5MTUpIHx8IElTX0hTV19VTFQoaTkxNSkpICYm
Cj4gPiAgIAkgICAgKGN0bCAmIFdSUExMX1JFRl9NQVNLKSA9PSBXUlBMTF9SRUZfTVVYRURfU1ND
X0JEVyAmJgo+ID4gICAJICAgIChmdXNlX3N0cmFwICYgSFNXX0NQVV9TU0NfRU5BQkxFKSA9PSAw
KQo+ID4gICAJCXJldHVybiB0cnVlOwo+ID4gQEAgLTkxNjUsMTMgKzkxNjUsMTMgQEAgc3RhdGlj
IGJvb2wgd3JwbGxfdXNlc19wY2hfc3NjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgCXJldHVybiBmYWxzZTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGxwdF9pbml0
X3BjaF9yZWZjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRp
YyB2b2lkIGxwdF9pbml0X3BjaF9yZWZjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ID4gICAJYm9v
bCBwY2hfc3NjX2luX3VzZSA9IGZhbHNlOwo+ID4gICAJYm9vbCBoYXNfZmRpID0gZmFsc2U7Cj4g
PiAtCWZvcl9lYWNoX2ludGVsX2VuY29kZXIoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsKPiA+
ICsJZm9yX2VhY2hfaW50ZWxfZW5jb2RlcigmaTkxNS0+ZHJtLCBlbmNvZGVyKSB7Cj4gPiAgIAkJ
c3dpdGNoIChlbmNvZGVyLT50eXBlKSB7Cj4gPiAgIAkJY2FzZSBJTlRFTF9PVVRQVVRfQU5BTE9H
Ogo+ID4gICAJCQloYXNfZmRpID0gdHJ1ZTsKPiA+IEBAIC05MTk2LDE3ICs5MTk2LDE3IEBAIHN0
YXRpYyB2b2lkIGxwdF9pbml0X3BjaF9yZWZjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJICogY2xvY2sgaGllcmFyY2h5LiBUaGF0IHdvdWxkIGFsc28gYWxsb3cg
dXMgdG8gZG8KPiA+ICAgCSAqIGNsb2NrIGJlbmRpbmcgZmluYWxseS4KPiA+ICAgCSAqLwo+ID4g
LQlpZiAoc3BsbF91c2VzX3BjaF9zc2MoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChzcGxsX3VzZXNf
cGNoX3NzYyhpOTE1KSkgewo+ID4gICAJCURSTV9ERUJVR19LTVMoIlNQTEwgdXNpbmcgUENIIFNT
Q1xuIik7Cj4gPiAgIAkJcGNoX3NzY19pbl91c2UgPSB0cnVlOwo+ID4gICAJfQo+ID4gLQlpZiAo
d3JwbGxfdXNlc19wY2hfc3NjKGRldl9wcml2LCBEUExMX0lEX1dSUExMMSkpIHsKPiA+ICsJaWYg
KHdycGxsX3VzZXNfcGNoX3NzYyhpOTE1LCBEUExMX0lEX1dSUExMMSkpIHsKPiA+ICAgCQlEUk1f
REVCVUdfS01TKCJXUlBMTDEgdXNpbmcgUENIIFNTQ1xuIik7Cj4gPiAgIAkJcGNoX3NzY19pbl91
c2UgPSB0cnVlOwo+ID4gICAJfQo+ID4gLQlpZiAod3JwbGxfdXNlc19wY2hfc3NjKGRldl9wcml2
LCBEUExMX0lEX1dSUExMMikpIHsKPiA+ICsJaWYgKHdycGxsX3VzZXNfcGNoX3NzYyhpOTE1LCBE
UExMX0lEX1dSUExMMikpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJXUlBMTDIgdXNpbmcgUENI
IFNTQ1xuIik7Cj4gPiAgIAkJcGNoX3NzY19pbl91c2UgPSB0cnVlOwo+ID4gICAJfQo+ID4gQEAg
LTkyMTUsMjggKzkyMTUsMjggQEAgc3RhdGljIHZvaWQgbHB0X2luaXRfcGNoX3JlZmNsayhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJaWYg
KGhhc19mZGkpIHsKPiA+IC0JCWxwdF9iZW5kX2Nsa291dF9kcChkZXZfcHJpdiwgMCk7Cj4gPiAt
CQlscHRfZW5hYmxlX2Nsa291dF9kcChkZXZfcHJpdiwgdHJ1ZSwgdHJ1ZSk7Cj4gPiArCQlscHRf
YmVuZF9jbGtvdXRfZHAoaTkxNSwgMCk7Cj4gPiArCQlscHRfZW5hYmxlX2Nsa291dF9kcChpOTE1
LCB0cnVlLCB0cnVlKTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAtCQlscHRfZGlzYWJsZV9jbGtvdXRf
ZHAoZGV2X3ByaXYpOwo+ID4gKwkJbHB0X2Rpc2FibGVfY2xrb3V0X2RwKGk5MTUpOwo+ID4gICAJ
fQo+ID4gICB9Cj4gPiAgIC8qCj4gPiAgICAqIEluaXRpYWxpemUgcmVmZXJlbmNlIGNsb2NrcyB3
aGVuIHRoZSBkcml2ZXIgbG9hZHMKPiA+ICAgICovCj4gPiAtdm9pZCBpbnRlbF9pbml0X3BjaF9y
ZWZjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxf
aW5pdF9wY2hfcmVmY2xrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAtCWlmIChIQVNfUENIX0lCWChkZXZfcHJpdikgfHwgSEFTX1BDSF9DUFQoZGV2X3ByaXYpKQo+
ID4gLQkJaXJvbmxha2VfaW5pdF9wY2hfcmVmY2xrKGRldl9wcml2KTsKPiA+IC0JZWxzZSBpZiAo
SEFTX1BDSF9MUFQoZGV2X3ByaXYpKQo+ID4gLQkJbHB0X2luaXRfcGNoX3JlZmNsayhkZXZfcHJp
dik7Cj4gPiArCWlmIChIQVNfUENIX0lCWChpOTE1KSB8fCBIQVNfUENIX0NQVChpOTE1KSkKPiA+
ICsJCWlyb25sYWtlX2luaXRfcGNoX3JlZmNsayhpOTE1KTsKPiA+ICsJZWxzZSBpZiAoSEFTX1BD
SF9MUFQoaTkxNSkpCj4gPiArCQlscHRfaW5pdF9wY2hfcmVmY2xrKGk5MTUpOwo+ID4gICB9Cj4g
PiAgIHN0YXRpYyB2b2lkIGlyb25sYWtlX3NldF9waXBlY29uZihjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJdTMyIHZhbDsK
PiA+IEBAIC05MjgwLDExICs5MjgwLDExIEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX3NldF9waXBl
Y29uZihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgc3Rh
dGljIHZvaWQgaGFzd2VsbF9zZXRfcGlwZWNvbmYoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+
ICAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFu
c2NvZGVyOwo+ID4gICAJdTMyIHZhbCA9IDA7Cj4gPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2
KSAmJiBjcnRjX3N0YXRlLT5kaXRoZXIpCj4gPiArCWlmIChJU19IQVNXRUxMKGk5MTUpICYmIGNy
dGNfc3RhdGUtPmRpdGhlcikKPiA+ICAgCQl2YWwgfD0gKFBJUEVDT05GX0RJVEhFUl9FTiB8IFBJ
UEVDT05GX0RJVEhFUl9UWVBFX1NQKTsKPiA+ICAgCWlmIChjcnRjX3N0YXRlLT5iYXNlLmFkanVz
dGVkX21vZGUuZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0lOVEVSTEFDRSkKPiA+IEBAIC05Mjk5LDcg
KzkyOTksNyBAQCBzdGF0aWMgdm9pZCBoYXN3ZWxsX3NldF9waXBlY29uZihjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgc3RhdGljIHZvaWQgYmR3X3NldF9w
aXBlbWlzYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAg
ewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJdTMyIHZhbCA9IDA7Cj4gPiAg
IAlzd2l0Y2ggKGNydGNfc3RhdGUtPnBpcGVfYnBwKSB7Cj4gPiBAQCAtOTMzMSw3ICs5MzMxLDcg
QEAgc3RhdGljIHZvaWQgYmR3X3NldF9waXBlbWlzYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgCQl2YWwgfD0gUElQRU1JU0NfWVVWNDIwX0VOQUJMRSB8
Cj4gPiAgIAkJCVBJUEVNSVNDX1lVVjQyMF9NT0RFX0ZVTExfQkxFTkQ7Cj4gPiAtCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDExICYmCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEg
JiYKPiA+ICAgCSAgICAoY3J0Y19zdGF0ZS0+YWN0aXZlX3BsYW5lcyAmIH4oaWNsX2hkcl9wbGFu
ZV9tYXNrKCkgfAo+ID4gICAJCQkJCSAgIEJJVChQTEFORV9DVVJTT1IpKSkgPT0gMCkKPiA+ICAg
CQl2YWwgfD0gUElQRU1JU0NfSERSX01PREVfUFJFQ0lTSU9OOwo+ID4gQEAgLTkzNDEsNyArOTM0
MSw3IEBAIHN0YXRpYyB2b2lkIGJkd19zZXRfcGlwZW1pc2MoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIGludCBiZHdfZ2V0X3BpcGVtaXNjX2JwcChzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCXUzMiB0
bXA7Cj4gPiAgIAl0bXAgPSBJOTE1X1JFQUQoUElQRU1JU0MoY3J0Yy0+cGlwZSkpOwo+ID4gQEAg
LTkzODEsMTcgKzkzODEsMTcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfY29tcHV0ZV9kcGxsKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJCSAgc3RydWN0IGRwbGwgKnJlZHVjZWRfY2xvY2spCj4g
PiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAl1MzIgZHBsbCwgZnAsIGZwMjsKPiA+ICAgCWlu
dCBmYWN0b3I7Cj4gPiAgIAkvKiBFbmFibGUgYXV0b3R1bmluZyBvZiB0aGUgUExMIGNsb2NrIChp
ZiBwZXJtaXNzaWJsZSkgKi8KPiA+ICAgCWZhY3RvciA9IDIxOwo+ID4gICAJaWYgKGludGVsX2Ny
dGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0xWRFMpKSB7Cj4gPiAtCQlpZiAo
KGludGVsX3BhbmVsX3VzZV9zc2MoZGV2X3ByaXYpICYmCj4gPiAtCQkgICAgIGRldl9wcml2LT52
YnQubHZkc19zc2NfZnJlcSA9PSAxMDAwMDApIHx8Cj4gPiAtCQkgICAgKEhBU19QQ0hfSUJYKGRl
dl9wcml2KSAmJgo+ID4gLQkJICAgICBpbnRlbF9pc19kdWFsX2xpbmtfbHZkcyhkZXZfcHJpdikp
KQo+ID4gKwkJaWYgKChpbnRlbF9wYW5lbF91c2Vfc3NjKGk5MTUpICYmCj4gPiArCQkgICAgIGk5
MTUtPnZidC5sdmRzX3NzY19mcmVxID09IDEwMDAwMCkgfHwKPiA+ICsJCSAgICAoSEFTX1BDSF9J
QlgoaTkxNSkgJiYKPiA+ICsJCSAgICAgaW50ZWxfaXNfZHVhbF9saW5rX2x2ZHMoaTkxNSkpKQo+
ID4gICAJCQlmYWN0b3IgPSAyNTsKPiA+ICAgCX0gZWxzZSBpZiAoY3J0Y19zdGF0ZS0+c2R2b190
dl9jbG9jaykgewo+ID4gICAJCWZhY3RvciA9IDIwOwo+ID4gQEAgLTk0NDIsNyArOTQ0Miw3IEBA
IHN0YXRpYyB2b2lkIGlyb25sYWtlX2NvbXB1dGVfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YywKPiA+ICAgCSAqIGNsZWFyIGlmIGl0JydzIGEgd2luIG9yIGxvc3MgcG93ZXIgd2lzZS4gTm8g
cG9pbnQgaW4gZG9pbmcKPiA+ICAgCSAqIHRoaXMgb24gSUxLIGF0IGFsbCBzaW5jZSBpdCBoYXMg
YSBmaXhlZCBEUExMPC0+cGlwZSBtYXBwaW5nLgo+ID4gICAJICovCj4gPiAtCWlmIChJTlRFTF9J
TkZPKGRldl9wcml2KS0+bnVtX3BpcGVzID09IDMgJiYKPiA+ICsJaWYgKElOVEVMX0lORk8oaTkx
NSktPm51bV9waXBlcyA9PSAzICYmCj4gPiAgIAkgICAgaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRj
X3N0YXRlLCBJTlRFTF9PVVRQVVRfQU5BTE9HKSkKPiA+ICAgCQlkcGxsIHw9IERQTExfU0RWT19I
SUdIX1NQRUVEOwo+ID4gQEAgLTk0NjcsNyArOTQ2Nyw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtl
X2NvbXB1dGVfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCX0KPiA+ICAgCWlm
IChpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9MVkRTKSAmJgo+
ID4gLQkgICAgaW50ZWxfcGFuZWxfdXNlX3NzYyhkZXZfcHJpdikpCj4gPiArCSAgICBpbnRlbF9w
YW5lbF91c2Vfc3NjKGk5MTUpKQo+ID4gICAJCWRwbGwgfD0gUExMQl9SRUZfSU5QVVRfU1BSRUFE
U1BFQ1RSVU1JTjsKPiA+ICAgCWVsc2UKPiA+ICAgCQlkcGxsIHw9IFBMTF9SRUZfSU5QVVRfRFJF
RkNMSzsKPiA+IEBAIC05NDgyLDcgKzk0ODIsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9jb21w
dXRlX2RwbGwoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIHN0YXRpYyBpbnQgaXJvbmxh
a2VfY3J0Y19jb21wdXRlX2Nsb2NrKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkJ
ICAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ID4gICAJY29uc3Qgc3RydWN0IGludGVsX2xpbWl0ICpsaW1pdDsKPiA+ICAg
CWludCByZWZjbGsgPSAxMjAwMDA7Cj4gPiBAQCAtOTQ5NCwxMyArOTQ5NCwxMyBAQCBzdGF0aWMg
aW50IGlyb25sYWtlX2NydGNfY29tcHV0ZV9jbG9jayhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiA+ICAgCQlyZXR1cm4gMDsKPiA+ICAgCWlmIChpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3Rh
dGUsIElOVEVMX09VVFBVVF9MVkRTKSkgewo+ID4gLQkJaWYgKGludGVsX3BhbmVsX3VzZV9zc2Mo
ZGV2X3ByaXYpKSB7Cj4gPiArCQlpZiAoaW50ZWxfcGFuZWxfdXNlX3NzYyhpOTE1KSkgewo+ID4g
ICAJCQlEUk1fREVCVUdfS01TKCJ1c2luZyBTU0MgcmVmZXJlbmNlIGNsb2NrIG9mICVkIGtIelxu
IiwKPiA+IC0JCQkJICAgICAgZGV2X3ByaXYtPnZidC5sdmRzX3NzY19mcmVxKTsKPiA+IC0JCQly
ZWZjbGsgPSBkZXZfcHJpdi0+dmJ0Lmx2ZHNfc3NjX2ZyZXE7Cj4gPiArCQkJCSAgICAgIGk5MTUt
PnZidC5sdmRzX3NzY19mcmVxKTsKPiA+ICsJCQlyZWZjbGsgPSBpOTE1LT52YnQubHZkc19zc2Nf
ZnJlcTsKPiA+ICAgCQl9Cj4gPiAtCQlpZiAoaW50ZWxfaXNfZHVhbF9saW5rX2x2ZHMoZGV2X3By
aXYpKSB7Cj4gPiArCQlpZiAoaW50ZWxfaXNfZHVhbF9saW5rX2x2ZHMoaTkxNSkpIHsKPiA+ICAg
CQkJaWYgKHJlZmNsayA9PSAxMDAwMDApCj4gPiAgIAkJCQlsaW1pdCA9ICZpbnRlbF9saW1pdHNf
aXJvbmxha2VfZHVhbF9sdmRzXzEwMG07Cj4gPiAgIAkJCWVsc2UKPiA+IEBAIC05NTM3LDcgKzk1
MzcsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wY2hfdHJhbnNjb2Rlcl9nZXRfbV9uKHN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkJCSBzdHJ1Y3QgaW50ZWxfbGlua19tX24gKm1fbikK
PiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJ
ZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJbV9uLT5saW5rX20gPSBJOTE1X1JF
QUQoUENIX1RSQU5TX0xJTktfTTEocGlwZSkpOwo+ID4gQEAgLTk1NTQsMTAgKzk1NTQsMTAgQEAg
c3RhdGljIHZvaWQgaW50ZWxfY3B1X3RyYW5zY29kZXJfZ2V0X21fbihzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKPiA+ICAgCQkJCQkgc3RydWN0IGludGVsX2xpbmtfbV9uICptX24sCj4gPiAgIAkJ
CQkJIHN0cnVjdCBpbnRlbF9saW5rX21fbiAqbTJfbjIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDUpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA1KSB7Cj4gPiAg
IAkJbV9uLT5saW5rX20gPSBJOTE1X1JFQUQoUElQRV9MSU5LX00xKHRyYW5zY29kZXIpKTsKPiA+
ICAgCQltX24tPmxpbmtfbiA9IEk5MTVfUkVBRChQSVBFX0xJTktfTjEodHJhbnNjb2RlcikpOwo+
ID4gICAJCW1fbi0+Z21jaF9tID0gSTkxNV9SRUFEKFBJUEVfREFUQV9NMSh0cmFuc2NvZGVyKSkK
PiA+IEBAIC05NTY2LDcgKzk1NjYsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jcHVfdHJhbnNjb2Rl
cl9nZXRfbV9uKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCW1fbi0+dHUgPSAoKEk5
MTVfUkVBRChQSVBFX0RBVEFfTTEodHJhbnNjb2RlcikpCj4gPiAgIAkJCSAgICAmIFRVX1NJWkVf
TUFTSykgPj4gVFVfU0laRV9TSElGVCkgKyAxOwo+ID4gLQkJaWYgKG0yX24yICYmIHRyYW5zY29k
ZXJfaGFzX20yX24yKGRldl9wcml2LCB0cmFuc2NvZGVyKSkgewo+ID4gKwkJaWYgKG0yX24yICYm
IHRyYW5zY29kZXJfaGFzX20yX24yKGk5MTUsIHRyYW5zY29kZXIpKSB7Cj4gPiAgIAkJCW0yX24y
LT5saW5rX20gPSBJOTE1X1JFQUQoUElQRV9MSU5LX00yKHRyYW5zY29kZXIpKTsKPiA+ICAgCQkJ
bTJfbjItPmxpbmtfbiA9CUk5MTVfUkVBRChQSVBFX0xJTktfTjIodHJhbnNjb2RlcikpOwo+ID4g
ICAJCQltMl9uMi0+Z21jaF9tID0JSTkxNV9SRUFEKFBJUEVfREFUQV9NMih0cmFuc2NvZGVyKSkK
PiA+IEBAIC05NjA4LDcgKzk2MDgsNyBAQCBzdGF0aWMgdm9pZCBza3lsYWtlX2dldF9wZml0X2Nv
bmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJCSAgICBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3NjYWxlcl9zdGF0ZSAq
c2NhbGVyX3N0YXRlID0gJnBpcGVfY29uZmlnLT5zY2FsZXJfc3RhdGU7Cj4gPiAgIAl1MzIgcHNf
Y3RybCA9IDA7Cj4gPiAgIAlpbnQgaWQgPSAtMTsKPiA+IEBAIC05NjQwLDcgKzk2NDAsNyBAQCBz
a3lsYWtlX2dldF9pbml0aWFsX3BsYW5lX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiA+ICAgCQkJCSBzdHJ1Y3QgaW50ZWxfaW5pdGlhbF9wbGFuZV9jb25maWcgKnBsYW5lX2NvbmZp
ZykKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2
Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4g
ICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKGNydGMtPmJhc2Uu
cHJpbWFyeSk7Cj4gPiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gcGxhbmUtPmlkOwo+ID4g
ICAJZW51bSBwaXBlIHBpcGU7Cj4gPiBAQCAtOTY2NywxMiArOTY2NywxMiBAQCBza3lsYWtlX2dl
dF9pbml0aWFsX3BsYW5lX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCXZh
bCA9IEk5MTVfUkVBRChQTEFORV9DVEwocGlwZSwgcGxhbmVfaWQpKTsKPiA+IC0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTEpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4g
PiAgIAkJcGl4ZWxfZm9ybWF0ID0gdmFsICYgSUNMX1BMQU5FX0NUTF9GT1JNQVRfTUFTSzsKPiA+
ICAgCWVsc2UKPiA+ICAgCQlwaXhlbF9mb3JtYXQgPSB2YWwgJiBQTEFORV9DVExfRk9STUFUX01B
U0s7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwIHx8IElTX0dFTUlOSUxBS0Uo
ZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTAgfHwgSVNfR0VNSU5J
TEFLRShpOTE1KSkgewo+ID4gICAJCWFscGhhID0gSTkxNV9SRUFEKFBMQU5FX0NPTE9SX0NUTChw
aXBlLCBwbGFuZV9pZCkpOwo+ID4gICAJCWFscGhhICY9IFBMQU5FX0NPTE9SX0FMUEhBX01BU0s7
Cj4gPiAgIAl9IGVsc2Ugewo+ID4gQEAgLTk3MjksNyArOTcyOSw3IEBAIHNreWxha2VfZ2V0X2lu
aXRpYWxfcGxhbmVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCWJyZWFr
Owo+ID4gICAJfQo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCAmJgo+ID4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDEwICYmCj4gPiAgIAkgICAgdmFsICYgUExBTkVfQ1RMX0ZM
SVBfSE9SSVpPTlRBTCkKPiA+ICAgCQlwbGFuZV9jb25maWctPnJvdGF0aW9uIHw9IERSTV9NT0RF
X1JFRkxFQ1RfWDsKPiA+IEBAIC05NzY2LDcgKzk3NjYsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFr
ZV9nZXRfcGZpdF9jb25maWcoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCQkgICAg
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+ID4gICAJc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJdTMyIHRtcDsKPiA+ICAgCXRt
cCA9IEk5MTVfUkVBRChQRl9DVEwoY3J0Yy0+cGlwZSkpOwo+ID4gQEAgLTk3NzksNyArOTc3OSw3
IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2dldF9wZml0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKPiA+ICAgCQkvKiBXZSBjdXJyZW50bHkgZG8gbm90IGZyZWUgYXNzaWduZW1lbnRz
IG9mIHBhbmVsIGZpdHRlcnMgb24KPiA+ICAgCQkgKiBpdmIvaHN3IChzaW5jZSB3ZSBkb24ndCB1
c2UgdGhlIGhpZ2hlciB1cHNjYWxpbmcgbW9kZXMgd2hpY2gKPiA+ICAgCQkgKiBkaWZmZXJlbnRp
YXRlcyB0aGVtKSBzbyBqdXN0IFdBUk4gYWJvdXQgdGhpcyBjYXNlIGZvciBub3cuICovCj4gPiAt
CQlpZiAoSVNfR0VOKGRldl9wcml2LCA3KSkgewo+ID4gKwkJaWYgKElTX0dFTihpOTE1LCA3KSkg
ewo+ID4gICAJCQlXQVJOX09OKCh0bXAgJiBQRl9QSVBFX1NFTF9NQVNLX0lWQikgIT0KPiA+ICAg
CQkJCVBGX1BJUEVfU0VMX0lWQihjcnRjLT5waXBlKSk7Cj4gPiAgIAkJfQo+ID4gQEAgLTk3OTAs
MTQgKzk3OTAsMTQgQEAgc3RhdGljIGJvb2wgaXJvbmxha2VfZ2V0X3BpcGVfY29uZmlnKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBj
cnRjLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZGV2KTsKPiA+ICAgCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9t
YWluOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAgIAl1MzIgdG1wOwo+ID4g
ICAJYm9vbCByZXQ7Cj4gPiAgIAlwb3dlcl9kb21haW4gPSBQT1dFUl9ET01BSU5fUElQRShjcnRj
LT5waXBlKTsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJs
ZWQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbik7Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5
X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUsIHBvd2VyX2RvbWFpbik7Cj4gPiAgIAlpZiAoIXdh
a2VyZWYpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTk4NTAsNyArOTg1MCw3IEBAIHN0
YXRpYyBib29sIGlyb25sYWtlX2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YywKPiA+ICAgCQlpcm9ubGFrZV9nZXRfZmRpX21fbl9jb25maWcoY3J0YywgcGlwZV9jb25maWcp
Owo+ID4gLQkJaWYgKEhBU19QQ0hfSUJYKGRldl9wcml2KSkgewo+ID4gKwkJaWYgKEhBU19QQ0hf
SUJYKGk5MTUpKSB7Cj4gPiAgIAkJCS8qCj4gPiAgIAkJCSAqIFRoZSBwaXBlLT5wY2ggdHJhbnNj
b2RlciBhbmQgcGNoIHRyYW5zY29kZXItPnBsbAo+ID4gICAJCQkgKiBtYXBwaW5nIGlzIGZpeGVk
Lgo+ID4gQEAgLTk4NjUsMTAgKzk4NjUsMTAgQEAgc3RhdGljIGJvb2wgaXJvbmxha2VfZ2V0X3Bp
cGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCX0KPiA+ICAgCQlwaXBl
X2NvbmZpZy0+c2hhcmVkX2RwbGwgPQo+ID4gLQkJCWludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9p
ZChkZXZfcHJpdiwgcGxsX2lkKTsKPiA+ICsJCQlpbnRlbF9nZXRfc2hhcmVkX2RwbGxfYnlfaWQo
aTkxNSwgcGxsX2lkKTsKPiA+ICAgCQlwbGwgPSBwaXBlX2NvbmZpZy0+c2hhcmVkX2RwbGw7Cj4g
PiAtCQlXQVJOX09OKCFwbGwtPmluZm8tPmZ1bmNzLT5nZXRfaHdfc3RhdGUoZGV2X3ByaXYsIHBs
bCwKPiA+ICsJCVdBUk5fT04oIXBsbC0+aW5mby0+ZnVuY3MtPmdldF9od19zdGF0ZShpOTE1LCBw
bGwsCj4gPiAgIAkJCQkJCSZwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZSkpOwo+ID4gICAJCXRt
cCA9IHBpcGVfY29uZmlnLT5kcGxsX2h3X3N0YXRlLmRwbGw7Cj4gPiBAQCAtOTg4OSwxOSArOTg4
OSwxOSBAQCBzdGF0aWMgYm9vbCBpcm9ubGFrZV9nZXRfcGlwZV9jb25maWcoc3RydWN0IGludGVs
X2NydGMgKmNydGMsCj4gPiAgIAlyZXQgPSB0cnVlOwo+ID4gICBvdXQ6Cj4gPiAtCWludGVsX2Rp
c3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ID4gKwlp
bnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ID4g
ICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW50IGhhc3dlbGxfY3J0Y19jb21w
dXRlX2Nsb2NrKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkJICAgICAgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSA9Cj4gPiAgIAkJdG9faW50ZWxf
YXRvbWljX3N0YXRlKGNydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+ID4gICAJaWYgKCFpbnRlbF9j
cnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9EU0kpIHx8Cj4gPiAtCSAgICBJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiArCSAgICBJTlRFTF9HRU4oaTkxNSkgPj0g
MTEpIHsKPiA+ICAgCQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciA9Cj4gPiAgIAkJCWlu
dGVsX2dldF9jcnRjX25ld19lbmNvZGVyKHN0YXRlLCBjcnRjX3N0YXRlKTsKPiA+IEBAIC05OTE1
LDcgKzk5MTUsNyBAQCBzdGF0aWMgaW50IGhhc3dlbGxfY3J0Y19jb21wdXRlX2Nsb2NrKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
dm9pZCBjYW5ub25sYWtlX2dldF9kZGlfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBjYW5ub25sYWtlX2dldF9kZGlfcGxsKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgZW51bSBwb3J0IHBvcnQsCj4gPiAgIAkJ
CQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IEBA
IC05OTI4LDEwICs5OTI4LDEwIEBAIHN0YXRpYyB2b2lkIGNhbm5vbmxha2VfZ2V0X2RkaV9wbGwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJaWYgKFdBUk5fT04oaWQg
PCBTS0xfRFBMTDAgfHwgaWQgPiBTS0xfRFBMTDIpKQo+ID4gICAJCXJldHVybjsKPiA+IC0JcGlw
ZV9jb25maWctPnNoYXJlZF9kcGxsID0gaW50ZWxfZ2V0X3NoYXJlZF9kcGxsX2J5X2lkKGRldl9w
cml2LCBpZCk7Cj4gPiArCXBpcGVfY29uZmlnLT5zaGFyZWRfZHBsbCA9IGludGVsX2dldF9zaGFy
ZWRfZHBsbF9ieV9pZChpOTE1LCBpZCk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpY2VsYWtl
X2dldF9kZGlfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0
aWMgdm9pZCBpY2VsYWtlX2dldF9kZGlfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ID4gICAJCQkJZW51bSBwb3J0IHBvcnQsCj4gPiAgIAkJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IEBAIC05OTM5LDIxICs5OTM5LDIxIEBAIHN0
YXRpYyB2b2lkIGljZWxha2VfZ2V0X2RkaV9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAJdTMyIHRlbXA7Cj4gPiAgIAkvKiBUT0RPOiBUQlQgcGxsIG5vdCBpbXBs
ZW1lbnRlZC4gKi8KPiA+IC0JaWYgKGludGVsX3BvcnRfaXNfY29tYm9waHkoZGV2X3ByaXYsIHBv
cnQpKSB7Cj4gPiArCWlmIChpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KGk5MTUsIHBvcnQpKSB7Cj4g
PiAgIAkJdGVtcCA9IEk5MTVfUkVBRChEUENMS0FfQ0ZHQ1IwX0lDTCkgJgo+ID4gICAJCSAgICAg
ICBEUENMS0FfQ0ZHQ1IwX0RESV9DTEtfU0VMX01BU0socG9ydCk7Cj4gPiAgIAkJaWQgPSB0ZW1w
ID4+IERQQ0xLQV9DRkdDUjBfRERJX0NMS19TRUxfU0hJRlQocG9ydCk7Cj4gPiAtCX0gZWxzZSBp
ZiAoaW50ZWxfcG9ydF9pc190YyhkZXZfcHJpdiwgcG9ydCkpIHsKPiA+IC0JCWlkID0gaWNsX3Rj
X3BvcnRfdG9fcGxsX2lkKGludGVsX3BvcnRfdG9fdGMoZGV2X3ByaXYsIHBvcnQpKTsKPiA+ICsJ
fSBlbHNlIGlmIChpbnRlbF9wb3J0X2lzX3RjKGk5MTUsIHBvcnQpKSB7Cj4gPiArCQlpZCA9IGlj
bF90Y19wb3J0X3RvX3BsbF9pZChpbnRlbF9wb3J0X3RvX3RjKGk5MTUsIHBvcnQpKTsKPiA+ICAg
CX0gZWxzZSB7Cj4gPiAgIAkJV0FSTigxLCAiSW52YWxpZCBwb3J0ICV4XG4iLCBwb3J0KTsKPiA+
ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiAtCXBpcGVfY29uZmlnLT5zaGFyZWRfZHBsbCA9IGlu
dGVsX2dldF9zaGFyZWRfZHBsbF9ieV9pZChkZXZfcHJpdiwgaWQpOwo+ID4gKwlwaXBlX2NvbmZp
Zy0+c2hhcmVkX2RwbGwgPSBpbnRlbF9nZXRfc2hhcmVkX2RwbGxfYnlfaWQoaTkxNSwgaWQpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgYnh0X2dldF9kZGlfcGxsKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBieHRfZ2V0X2RkaV9wbGwoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQllbnVtIHBvcnQgcG9ydCwKPiA+ICAg
CQkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+ID4gQEAg
LTk5NzQsMTAgKzk5NzQsMTAgQEAgc3RhdGljIHZvaWQgYnh0X2dldF9kZGlfcGxsKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiAt
CXBpcGVfY29uZmlnLT5zaGFyZWRfZHBsbCA9IGludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9pZChk
ZXZfcHJpdiwgaWQpOwo+ID4gKwlwaXBlX2NvbmZpZy0+c2hhcmVkX2RwbGwgPSBpbnRlbF9nZXRf
c2hhcmVkX2RwbGxfYnlfaWQoaTkxNSwgaWQpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgc2t5
bGFrZV9nZXRfZGRpX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAr
c3RhdGljIHZvaWQgc2t5bGFrZV9nZXRfZGRpX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJCWVudW0gcG9ydCBwb3J0LAo+ID4gICAJCQkJc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ID4gICB7Cj4gPiBAQCAtOTk5MCwxMCArOTk5MCwxMCBA
QCBzdGF0aWMgdm9pZCBza3lsYWtlX2dldF9kZGlfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICAgCWlmIChXQVJOX09OKGlkIDwgU0tMX0RQTEwwIHx8IGlkID4gU0tM
X0RQTEwzKSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCXBpcGVfY29uZmlnLT5zaGFyZWRfZHBsbCA9
IGludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9pZChkZXZfcHJpdiwgaWQpOwo+ID4gKwlwaXBlX2Nv
bmZpZy0+c2hhcmVkX2RwbGwgPSBpbnRlbF9nZXRfc2hhcmVkX2RwbGxfYnlfaWQoaTkxNSwgaWQp
Owo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaGFzd2VsbF9nZXRfZGRpX3BsbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaGFzd2VsbF9nZXRfZGRp
X3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCWVudW0gcG9ydCBw
b3J0LAo+ID4gICAJCQkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ID4g
ICB7Cj4gPiBAQCAtMTAwMjYsNyArMTAwMjYsNyBAQCBzdGF0aWMgdm9pZCBoYXN3ZWxsX2dldF9k
ZGlfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQlyZXR1cm47
Cj4gPiAgIAl9Cj4gPiAtCXBpcGVfY29uZmlnLT5zaGFyZWRfZHBsbCA9IGludGVsX2dldF9zaGFy
ZWRfZHBsbF9ieV9pZChkZXZfcHJpdiwgaWQpOwo+ID4gKwlwaXBlX2NvbmZpZy0+c2hhcmVkX2Rw
bGwgPSBpbnRlbF9nZXRfc2hhcmVkX2RwbGxfYnlfaWQoaTkxNSwgaWQpOwo+ID4gICB9Cj4gPiAg
IHN0YXRpYyBib29sIGhzd19nZXRfdHJhbnNjb2Rlcl9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKPiA+IEBAIC0xMDAzNSw3ICsxMDAzNSw3IEBAIHN0YXRpYyBib29sIGhzd19nZXRfdHJh
bnNjb2Rlcl9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJCSAgICAgaW50
ZWxfd2FrZXJlZl90ICp3YWtlcmVmcykKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9IGNydGMtPmJhc2UuZGV2Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShkZXYpOwo+ID4gICAJZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBw
b3dlcl9kb21haW47Cj4gPiAgIAl1bnNpZ25lZCBsb25nIHBhbmVsX3RyYW5zY29kZXJfbWFzayA9
IDA7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIGVuYWJsZWRfcGFuZWxfdHJhbnNjb2RlcnMgPSAwOwo+
ID4gQEAgLTEwMDQzLDExICsxMDA0MywxMSBAQCBzdGF0aWMgYm9vbCBoc3dfZ2V0X3RyYW5zY29k
ZXJfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qg
d2Y7Cj4gPiAgIAl1MzIgdG1wOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkK
PiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICAgCQlwYW5lbF90cmFuc2NvZGVy
X21hc2sgfD0KPiA+ICAgCQkJQklUKFRSQU5TQ09ERVJfRFNJXzApIHwgQklUKFRSQU5TQ09ERVJf
RFNJXzEpOwo+ID4gLQlpZiAoSEFTX1RSQU5TQ09ERVJfRURQKGRldl9wcml2KSkKPiA+ICsJaWYg
KEhBU19UUkFOU0NPREVSX0VEUChpOTE1KSkKPiA+ICAgCQlwYW5lbF90cmFuc2NvZGVyX21hc2sg
fD0gQklUKFRSQU5TQ09ERVJfRURQKTsKPiA+ICAgCS8qCj4gPiBAQCAtMTAwNjIsNyArMTAwNjIs
NyBAQCBzdGF0aWMgYm9vbCBoc3dfZ2V0X3RyYW5zY29kZXJfc3RhdGUoc3RydWN0IGludGVsX2Ny
dGMgKmNydGMsCj4gPiAgIAkgKi8KPiA+ICAgCWZvcl9lYWNoX3NldF9iaXQocGFuZWxfdHJhbnNj
b2RlciwKPiA+ICAgCQkJICZwYW5lbF90cmFuc2NvZGVyX21hc2ssCj4gPiAtCQkJIEFSUkFZX1NJ
WkUoSU5URUxfSU5GTyhkZXZfcHJpdiktPnRyYW5zX29mZnNldHMpKSB7Cj4gPiArCQkJIEFSUkFZ
X1NJWkUoSU5URUxfSU5GTyhpOTE1KS0+dHJhbnNfb2Zmc2V0cykpIHsKPiA+ICAgCQlib29sIGZv
cmNlX3RocnUgPSBmYWxzZTsKPiA+ICAgCQllbnVtIHBpcGUgdHJhbnNfcGlwZTsKPiA+IEBAIC0x
MDExMyw3ICsxMDExMyw3IEBAIHN0YXRpYyBib29sIGhzd19nZXRfdHJhbnNjb2Rlcl9zdGF0ZShz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCXBvd2VyX2RvbWFpbiA9IFBPV0VSX0RPTUFJ
Tl9UUkFOU0NPREVSKHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2Rlcik7Cj4gPiAgIAlXQVJOX09O
KCpwb3dlcl9kb21haW5fbWFzayAmIEJJVF9VTEwocG93ZXJfZG9tYWluKSk7Cj4gPiAtCXdmID0g
aW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJfZG9tYWlu
KTsKPiA+ICsJd2YgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUsIHBv
d2VyX2RvbWFpbik7Cj4gPiAgIAlpZiAoIXdmKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IEBA
IC0xMDEzMSw3ICsxMDEzMSw3IEBAIHN0YXRpYyBib29sIGJ4dF9nZXRfZHNpX3RyYW5zY29kZXJf
c3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCQkJIGludGVsX3dha2VyZWZf
dCAqd2FrZXJlZnMpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRj
LT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGV2KTsKPiA+ICAgCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9tYWlu
Owo+ID4gICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyOwo+ID4gICAJaW50ZWxfd2Fr
ZXJlZl90IHdmOwo+ID4gQEAgLTEwMTQ3LDcgKzEwMTQ3LDcgQEAgc3RhdGljIGJvb2wgYnh0X2dl
dF9kc2lfdHJhbnNjb2Rlcl9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQlw
b3dlcl9kb21haW4gPSBQT1dFUl9ET01BSU5fVFJBTlNDT0RFUihjcHVfdHJhbnNjb2Rlcik7Cj4g
PiAgIAkJV0FSTl9PTigqcG93ZXJfZG9tYWluX21hc2sgJiBCSVRfVUxMKHBvd2VyX2RvbWFpbikp
Owo+ID4gLQkJd2YgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2
LCBwb3dlcl9kb21haW4pOwo+ID4gKwkJd2YgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9l
bmFibGVkKGk5MTUsIHBvd2VyX2RvbWFpbik7Cj4gPiAgIAkJaWYgKCF3ZikKPiA+ICAgCQkJY29u
dGludWU7Cj4gPiBAQCAtMTAxNjEsNyArMTAxNjEsNyBAQCBzdGF0aWMgYm9vbCBieHRfZ2V0X2Rz
aV90cmFuc2NvZGVyX3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCSAqIHJl
Z2lzdGVycy9NSVBJW0JYVF0uIFdlIGNhbiBicmVhayBvdXQgaGVyZSBlYXJseSwgc2luY2Ugd2UK
PiA+ICAgCQkgKiBuZWVkIHRoZSBzYW1lIERTSSBQTEwgdG8gYmUgZW5hYmxlZCBmb3IgYm90aCBE
U0kgcG9ydHMuCj4gPiAgIAkJICovCj4gPiAtCQlpZiAoIWJ4dF9kc2lfcGxsX2lzX2VuYWJsZWQo
ZGV2X3ByaXYpKQo+ID4gKwkJaWYgKCFieHRfZHNpX3BsbF9pc19lbmFibGVkKGk5MTUpKQo+ID4g
ICAJCQlicmVhazsKPiA+ICAgCQkvKiBYWFg6IHRoaXMgd29ya3MgZm9yIHZpZGVvIG1vZGUgb25s
eSAqLwo+ID4gQEAgLTEwMTgzLDcgKzEwMTgzLDcgQEAgc3RhdGljIGJvb2wgYnh0X2dldF9kc2lf
dHJhbnNjb2Rlcl9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgc3RhdGljIHZv
aWQgaGFzd2VsbF9nZXRfZGRpX3BvcnRfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4g
PiAgIAkJCQkgICAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGw7
Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+ICAgCXUzMiB0bXA7Cj4gPiBAQCAtMTAxOTIsMjAg
KzEwMTkyLDIwIEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfZ2V0X2RkaV9wb3J0X3N0YXRlKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJcG9ydCA9ICh0bXAgJiBUUkFOU19ERElfUE9SVF9N
QVNLKSA+PiBUUkFOU19ERElfUE9SVF9TSElGVDsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPj0gMTEpCj4gPiAtCQlpY2VsYWtlX2dldF9kZGlfcGxsKGRldl9wcml2LCBwb3J0LCBwaXBl
X2NvbmZpZyk7Cj4gPiAtCWVsc2UgaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKQo+ID4gLQkJ
Y2Fubm9ubGFrZV9nZXRfZGRpX3BsbChkZXZfcHJpdiwgcG9ydCwgcGlwZV9jb25maWcpOwo+ID4g
LQllbHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2KSkKPiA+IC0JCXNreWxha2VfZ2V0X2RkaV9w
bGwoZGV2X3ByaXYsIHBvcnQsIHBpcGVfY29uZmlnKTsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOOV9M
UChkZXZfcHJpdikpCj4gPiAtCQlieHRfZ2V0X2RkaV9wbGwoZGV2X3ByaXYsIHBvcnQsIHBpcGVf
Y29uZmlnKTsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICsJCWljZWxha2Vf
Z2V0X2RkaV9wbGwoaTkxNSwgcG9ydCwgcGlwZV9jb25maWcpOwo+ID4gKwllbHNlIGlmIChJU19D
QU5OT05MQUtFKGk5MTUpKQo+ID4gKwkJY2Fubm9ubGFrZV9nZXRfZGRpX3BsbChpOTE1LCBwb3J0
LCBwaXBlX2NvbmZpZyk7Cj4gPiArCWVsc2UgaWYgKElTX0dFTjlfQkMoaTkxNSkpCj4gPiArCQlz
a3lsYWtlX2dldF9kZGlfcGxsKGk5MTUsIHBvcnQsIHBpcGVfY29uZmlnKTsKPiA+ICsJZWxzZSBp
ZiAoSVNfR0VOOV9MUChpOTE1KSkKPiA+ICsJCWJ4dF9nZXRfZGRpX3BsbChpOTE1LCBwb3J0LCBw
aXBlX2NvbmZpZyk7Cj4gPiAgIAllbHNlCj4gPiAtCQloYXN3ZWxsX2dldF9kZGlfcGxsKGRldl9w
cml2LCBwb3J0LCBwaXBlX2NvbmZpZyk7Cj4gPiArCQloYXN3ZWxsX2dldF9kZGlfcGxsKGk5MTUs
IHBvcnQsIHBpcGVfY29uZmlnKTsKPiA+ICAgCXBsbCA9IHBpcGVfY29uZmlnLT5zaGFyZWRfZHBs
bDsKPiA+ICAgCWlmIChwbGwpIHsKPiA+IC0JCVdBUk5fT04oIXBsbC0+aW5mby0+ZnVuY3MtPmdl
dF9od19zdGF0ZShkZXZfcHJpdiwgcGxsLAo+ID4gKwkJV0FSTl9PTighcGxsLT5pbmZvLT5mdW5j
cy0+Z2V0X2h3X3N0YXRlKGk5MTUsIHBsbCwKPiA+ICAgCQkJCQkJJnBpcGVfY29uZmlnLT5kcGxs
X2h3X3N0YXRlKSk7Cj4gPiAgIAl9Cj4gPiBAQCAtMTAyMTQsNyArMTAyMTQsNyBAQCBzdGF0aWMg
dm9pZCBoYXN3ZWxsX2dldF9kZGlfcG9ydF9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiA+ICAgCSAqIERESSBFLiBTbyBqdXN0IGNoZWNrIHdoZXRoZXIgdGhpcyBwaXBlIGlzIHdpcmVk
IHRvIERESSBFIGFuZCB3aGV0aGVyCj4gPiAgIAkgKiB0aGUgUENIIHRyYW5zY29kZXIgaXMgb24u
Cj4gPiAgIAkgKi8KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA5ICYmCj4gPiArCWlm
IChJTlRFTF9HRU4oaTkxNSkgPCA5ICYmCj4gPiAgIAkgICAgKHBvcnQgPT0gUE9SVF9FKSAmJiBJ
OTE1X1JFQUQoTFBUX1RSQU5TQ09ORikgJiBUUkFOU19FTkFCTEUpIHsKPiA+ICAgCQlwaXBlX2Nv
bmZpZy0+aGFzX3BjaF9lbmNvZGVyID0gdHJ1ZTsKPiA+IEBAIC0xMDIyOSw3ICsxMDIyOSw3IEBA
IHN0YXRpYyB2b2lkIGhhc3dlbGxfZ2V0X2RkaV9wb3J0X3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjLAo+ID4gICBzdGF0aWMgYm9vbCBoYXN3ZWxsX2dldF9waXBlX2NvbmZpZyhzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJCSAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
cGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAlpbnRlbF93YWtlcmVm
X3Qgd2FrZXJlZnNbUE9XRVJfRE9NQUlOX05VTV0sIHdmOwo+ID4gICAJZW51bSBpbnRlbF9kaXNw
bGF5X3Bvd2VyX2RvbWFpbiBwb3dlcl9kb21haW47Cj4gPiAgIAl1NjQgcG93ZXJfZG9tYWluX21h
c2s7Cj4gPiBAQCAtMTAyMzgsNyArMTAyMzgsNyBAQCBzdGF0aWMgYm9vbCBoYXN3ZWxsX2dldF9w
aXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCWludGVsX2NydGNfaW5p
dF9zY2FsZXJzKGNydGMsIHBpcGVfY29uZmlnKTsKPiA+ICAgCXBvd2VyX2RvbWFpbiA9IFBPV0VS
X0RPTUFJTl9QSVBFKGNydGMtPnBpcGUpOwo+ID4gLQl3ZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJf
Z2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbik7Cj4gPiArCXdmID0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LCBwb3dlcl9kb21haW4pOwo+ID4gICAJ
aWYgKCF3ZikKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiBAQCAtMTAyNTAsNyArMTAyNTAsNyBA
QCBzdGF0aWMgYm9vbCBoYXN3ZWxsX2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKPiA+ICAgCWFjdGl2ZSA9IGhzd19nZXRfdHJhbnNjb2Rlcl9zdGF0ZShjcnRjLCBwaXBl
X2NvbmZpZywKPiA+ICAgCQkJCQkgICZwb3dlcl9kb21haW5fbWFzaywgd2FrZXJlZnMpOwo+ID4g
LQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikgJiYKPiA+ICsJaWYgKElTX0dFTjlfTFAoaTkxNSkg
JiYKPiA+ICAgCSAgICBieHRfZ2V0X2RzaV90cmFuc2NvZGVyX3N0YXRlKGNydGMsIHBpcGVfY29u
ZmlnLAo+ID4gICAJCQkJCSAmcG93ZXJfZG9tYWluX21hc2ssIHdha2VyZWZzKSkgewo+ID4gICAJ
CVdBUk5fT04oYWN0aXZlKTsKPiA+IEBAIC0xMDI2MSw3ICsxMDI2MSw3IEBAIHN0YXRpYyBib29s
IGhhc3dlbGxfZ2V0X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJ
CWdvdG8gb3V0Owo+ID4gICAJaWYgKCF0cmFuc2NvZGVyX2lzX2RzaShwaXBlX2NvbmZpZy0+Y3B1
X3RyYW5zY29kZXIpIHx8Cj4gPiAtCSAgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKSB7Cj4g
PiArCSAgICBJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsKPiA+ICAgCQloYXN3ZWxsX2dldF9kZGlf
cG9ydF9zdGF0ZShjcnRjLCBwaXBlX2NvbmZpZyk7Cj4gPiAgIAkJaW50ZWxfZ2V0X3BpcGVfdGlt
aW5ncyhjcnRjLCBwaXBlX2NvbmZpZyk7Cj4gPiAgIAl9Cj4gPiBAQCAtMTAyNzMsNyArMTAyNzMs
NyBAQCBzdGF0aWMgYm9vbCBoYXN3ZWxsX2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKPiA+ICAgCXBpcGVfY29uZmlnLT5jc2NfbW9kZSA9IEk5MTVfUkVBRChQSVBFX0NT
Q19NT0RFKGNydGMtPnBpcGUpKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkg
ewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpIHsKPiA+ICAgCQl1MzIgdG1wID0gSTkx
NV9SRUFEKFNLTF9CT1RUT01fQ09MT1IoY3J0Yy0+cGlwZSkpOwo+ID4gICAJCWlmICh0bXAgJiBT
S0xfQk9UVE9NX0NPTE9SX0dBTU1BX0VOQUJMRSkKPiA+IEBAIC0xMDI5MCwxOSArMTAyOTAsMTkg
QEAgc3RhdGljIGJvb2wgaGFzd2VsbF9nZXRfcGlwZV9jb25maWcoc3RydWN0IGludGVsX2NydGMg
KmNydGMsCj4gPiAgIAlwb3dlcl9kb21haW4gPSBQT1dFUl9ET01BSU5fUElQRV9QQU5FTF9GSVRU
RVIoY3J0Yy0+cGlwZSk7Cj4gPiAgIAlXQVJOX09OKHBvd2VyX2RvbWFpbl9tYXNrICYgQklUX1VM
TChwb3dlcl9kb21haW4pKTsKPiA+IC0Jd2YgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9l
bmFibGVkKGRldl9wcml2LCBwb3dlcl9kb21haW4pOwo+ID4gKwl3ZiA9IGludGVsX2Rpc3BsYXlf
cG93ZXJfZ2V0X2lmX2VuYWJsZWQoaTkxNSwgcG93ZXJfZG9tYWluKTsKPiA+ICAgCWlmICh3Zikg
ewo+ID4gICAJCXdha2VyZWZzW3Bvd2VyX2RvbWFpbl0gPSB3ZjsKPiA+ICAgCQlwb3dlcl9kb21h
aW5fbWFzayB8PSBCSVRfVUxMKHBvd2VyX2RvbWFpbik7Cj4gPiAtCQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSA5KQo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gICAJCQlz
a3lsYWtlX2dldF9wZml0X2NvbmZpZyhjcnRjLCBwaXBlX2NvbmZpZyk7Cj4gPiAgIAkJZWxzZQo+
ID4gICAJCQlpcm9ubGFrZV9nZXRfcGZpdF9jb25maWcoY3J0YywgcGlwZV9jb25maWcpOwo+ID4g
ICAJfQo+ID4gICAJaWYgKGhzd19jcnRjX3N1cHBvcnRzX2lwcyhjcnRjKSkgewo+ID4gLQkJaWYg
KElTX0hBU1dFTEwoZGV2X3ByaXYpKQo+ID4gKwkJaWYgKElTX0hBU1dFTEwoaTkxNSkpCj4gPiAg
IAkJCXBpcGVfY29uZmlnLT5pcHNfZW5hYmxlZCA9IEk5MTVfUkVBRChJUFNfQ1RMKSAmIElQU19F
TkFCTEU7Cj4gPiAgIAkJZWxzZSB7Cj4gPiAgIAkJCS8qCj4gPiBAQCAtMTAzMjQsNyArMTAzMjQs
NyBAQCBzdGF0aWMgYm9vbCBoYXN3ZWxsX2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKPiA+ICAgb3V0Ogo+ID4gICAJZm9yX2VhY2hfcG93ZXJfZG9tYWluKHBvd2VyX2Rv
bWFpbiwgcG93ZXJfZG9tYWluX21hc2spCj4gPiAtCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChk
ZXZfcHJpdiwKPiA+ICsJCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsCj4gPiAgIAkJCQkJ
cG93ZXJfZG9tYWluLCB3YWtlcmVmc1twb3dlcl9kb21haW5dKTsKPiA+ICAgCXJldHVybiBhY3Rp
dmU7Cj4gPiBAQCAtMTAzMzIsMTMgKzEwMzMyLDEzIEBAIHN0YXRpYyBib29sIGhhc3dlbGxfZ2V0
X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICBzdGF0aWMgdTMyIGlu
dGVsX2N1cnNvcl9iYXNlKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3Rh
dGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ID4gICAJCXRvX2k5MTUocGxhbmVf
c3RhdGUtPmJhc2UucGxhbmUtPmRldik7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVm
ZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5iYXNlLmZiOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iaiA9IGludGVsX2ZiX29iaihmYik7Cj4gPiAgIAl1MzIgYmFzZTsK
PiA+IC0JaWYgKElOVEVMX0lORk8oZGV2X3ByaXYpLT5kaXNwbGF5LmN1cnNvcl9uZWVkc19waHlz
aWNhbCkKPiA+ICsJaWYgKElOVEVMX0lORk8oaTkxNSktPmRpc3BsYXkuY3Vyc29yX25lZWRzX3Bo
eXNpY2FsKQo+ID4gICAJCWJhc2UgPSBvYmotPnBoeXNfaGFuZGxlLT5idXNhZGRyOwo+ID4gICAJ
ZWxzZQo+ID4gICAJCWJhc2UgPSBpbnRlbF9wbGFuZV9nZ3R0X29mZnNldChwbGFuZV9zdGF0ZSk7
Cj4gPiBAQCAtMTAzNDYsNyArMTAzNDYsNyBAQCBzdGF0aWMgdTMyIGludGVsX2N1cnNvcl9iYXNl
KGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIAliYXNl
ICs9IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5vZmZzZXQ7Cj4gPiAgIAkvKiBJTEsrIGRv
IHRoaXMgYXV0b21hZ2ljYWxseSAqLwo+ID4gLQlpZiAoSEFTX0dNQ0goZGV2X3ByaXYpICYmCj4g
PiArCWlmIChIQVNfR01DSChpOTE1KSAmJgo+ID4gICAJICAgIHBsYW5lX3N0YXRlLT5iYXNlLnJv
dGF0aW9uICYgRFJNX01PREVfUk9UQVRFXzE4MCkKPiA+ICAgCQliYXNlICs9IChwbGFuZV9zdGF0
ZS0+YmFzZS5jcnRjX2ggKgo+ID4gICAJCQkgcGxhbmVfc3RhdGUtPmJhc2UuY3J0Y193IC0gMSkg
KiBmYi0+Zm9ybWF0LT5jcHBbMF07Cj4gPiBAQCAtMTA1MzIsNyArMTA1MzIsNyBAQCBzdGF0aWMg
dm9pZCBpODQ1X3VwZGF0ZV9jdXJzb3Ioc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAg
CQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4g
ICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KHBsYW5lLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gICAJdTMyIGNudGwgPSAwLCBiYXNlID0gMCwg
cG9zID0gMCwgc2l6ZSA9IDA7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIGlycWZsYWdzOwo+ID4gQEAg
LTEwNTQ5LDcgKzEwNTQ5LDcgQEAgc3RhdGljIHZvaWQgaTg0NV91cGRhdGVfY3Vyc29yKHN0cnVj
dCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIAkJcG9zID0gaW50ZWxfY3Vyc29yX3Bvc2l0aW9u
KHBsYW5lX3N0YXRlKTsKPiA+ICAgCX0KPiA+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2
LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+
dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICAgCS8qIE9uIHRoZXNlIGNoaXBzZXRzIHdlIGNh
biBvbmx5IG1vZGlmeSB0aGUgYmFzZS9zaXplL3N0cmlkZQo+ID4gICAJICogd2hpbHN0IHRoZSBj
dXJzb3IgaXMgZGlzYWJsZWQuCj4gPiBAQCAtMTA1NzAsNyArMTA1NzAsNyBAQCBzdGF0aWMgdm9p
ZCBpODQ1X3VwZGF0ZV9jdXJzb3Ioc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCQlJ
OTE1X1dSSVRFX0ZXKENVUlBPUyhQSVBFX0EpLCBwb3MpOwo+ID4gICAJfQo+ID4gLQlzcGluX3Vu
bG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICsJ
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+
ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBpODQ1X2Rpc2FibGVfY3Vyc29yKHN0cnVjdCBpbnRlbF9w
bGFuZSAqcGxhbmUsCj4gPiBAQCAtMTA1ODIsMTMgKzEwNTgyLDEzIEBAIHN0YXRpYyB2b2lkIGk4
NDVfZGlzYWJsZV9jdXJzb3Ioc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgc3RhdGlj
IGJvb2wgaTg0NV9jdXJzb3JfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUs
Cj4gPiAgIAkJCQkgICAgIGVudW0gcGlwZSAqcGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYp
Owo+ID4gICAJZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBwb3dlcl9kb21haW47Cj4g
PiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCWJvb2wgcmV0Owo+ID4gICAJcG93
ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1BJUEUoUElQRV9BKTsKPiA+IC0Jd2FrZXJlZiA9IGlu
dGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbik7
Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUs
IHBvd2VyX2RvbWFpbik7Cj4gPiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuIGZhbHNl
Owo+ID4gQEAgLTEwNTk2LDcgKzEwNTk2LDcgQEAgc3RhdGljIGJvb2wgaTg0NV9jdXJzb3JfZ2V0
X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIAkqcGlwZSA9IFBJUEVf
QTsKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbiwg
d2FrZXJlZik7Cj4gPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIHBvd2VyX2RvbWFp
biwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtMTA2MTIsMTAg
KzEwNjEyLDEwIEBAIGk5eHhfY3Vyc29yX21heF9zdHJpZGUoc3RydWN0IGludGVsX3BsYW5lICpw
bGFuZSwKPiA+ICAgc3RhdGljIHUzMiBpOXh4X2N1cnNvcl9jdGxfY3J0Yyhjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ID4gICAJdTMyIGNudGwgPSAwOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSAxMSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICAgCQlyZXR1
cm4gY250bDsKPiA+ICAgCWlmIChjcnRjX3N0YXRlLT5nYW1tYV9lbmFibGUpCj4gPiBAQCAtMTA2
MjQsNyArMTA2MjQsNyBAQCBzdGF0aWMgdTMyIGk5eHhfY3Vyc29yX2N0bF9jcnRjKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICAJaWYgKGNydGNfc3RhdGUt
PmNzY19lbmFibGUpCj4gPiAgIAkJY250bCB8PSBNQ1VSU09SX1BJUEVfQ1NDX0VOQUJMRTsKPiA+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA1ICYmICFJU19HNFgoZGV2X3ByaXYpKQo+ID4g
KwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNSAmJiAhSVNfRzRYKGk5MTUpKQo+ID4gICAJCWNudGwg
fD0gTUNVUlNPUl9QSVBFX1NFTEVDVChjcnRjLT5waXBlKTsKPiA+ICAgCXJldHVybiBjbnRsOwo+
ID4gQEAgLTEwNjMzLDExICsxMDYzMywxMSBAQCBzdGF0aWMgdTMyIGk5eHhfY3Vyc29yX2N0bF9j
cnRjKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICBzdGF0
aWMgdTMyIGk5eHhfY3Vyc29yX2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwKPiA+ICAgCQkJICAgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFu
ZV9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gPiAgIAkJdG9faTkxNShw
bGFuZV9zdGF0ZS0+YmFzZS5wbGFuZS0+ZGV2KTsKPiA+ICAgCXUzMiBjbnRsID0gMDsKPiA+IC0J
aWYgKElTX0dFTihkZXZfcHJpdiwgNikgfHwgSVNfSVZZQlJJREdFKGRldl9wcml2KSkKPiA+ICsJ
aWYgKElTX0dFTihpOTE1LCA2KSB8fCBJU19JVllCUklER0UoaTkxNSkpCj4gPiAgIAkJY250bCB8
PSBNQ1VSU09SX1RSSUNLTEVfRkVFRF9ESVNBQkxFOwo+ID4gICAJc3dpdGNoIChwbGFuZV9zdGF0
ZS0+YmFzZS5jcnRjX3cpIHsKPiA+IEBAIC0xMDY2Myw3ICsxMDY2Myw3IEBAIHN0YXRpYyB1MzIg
aTl4eF9jdXJzb3JfY3RsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
LAo+ID4gICBzdGF0aWMgYm9vbCBpOXh4X2N1cnNvcl9zaXplX29rKGNvbnN0IHN0cnVjdCBpbnRl
bF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PQo+ID4gICAJCXRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUtPmRldik7Cj4gPiAgIAlp
bnQgd2lkdGggPSBwbGFuZV9zdGF0ZS0+YmFzZS5jcnRjX3c7Cj4gPiAgIAlpbnQgaGVpZ2h0ID0g
cGxhbmVfc3RhdGUtPmJhc2UuY3J0Y19oOwo+ID4gQEAgLTEwNjg3LDcgKzEwNjg3LDcgQEAgc3Rh
dGljIGJvb2wgaTl4eF9jdXJzb3Jfc2l6ZV9vayhjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3Rh
dGUgKnBsYW5lX3N0YXRlKQo+ID4gICAJICogY3Vyc29yIGlzIG5vdCByb3RhdGVkLiBFdmVyeXRo
aW5nIGVsc2UgcmVxdWlyZXMgc3F1YXJlCj4gPiAgIAkgKiBjdXJzb3JzLgo+ID4gICAJICovCj4g
PiAtCWlmIChIQVNfQ1VSX0ZCQyhkZXZfcHJpdikgJiYKPiA+ICsJaWYgKEhBU19DVVJfRkJDKGk5
MTUpICYmCj4gPiAgIAkgICAgcGxhbmVfc3RhdGUtPmJhc2Uucm90YXRpb24gJiBEUk1fTU9ERV9S
T1RBVEVfMCkgewo+ID4gICAJCWlmIChoZWlnaHQgPCA4IHx8IGhlaWdodCA+IHdpZHRoKQo+ID4g
ICAJCQlyZXR1cm4gZmFsc2U7Cj4gPiBAQCAtMTA3MDMsNyArMTA3MDMsNyBAQCBzdGF0aWMgaW50
IGk5eHhfY2hlY2tfY3Vyc29yKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ID4gICAJCQkgICAgIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAg
IHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFu
ZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gPiAgIAljb25zdCBzdHJ1
Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5iYXNlLmZiOwo+ID4gICAJZW51
bSBwaXBlIHBpcGUgPSBwbGFuZS0+cGlwZTsKPiA+ICAgCWludCByZXQ7Cj4gPiBAQCAtMTA3NDMs
NyArMTA3NDMsNyBAQCBzdGF0aWMgaW50IGk5eHhfY2hlY2tfY3Vyc29yKHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJICogZGlzcGxheSBwb3dlciB3ZWxsIG11c3Qg
YmUgdHVybmVkIG9mZiBhbmQgb24gYWdhaW4uCj4gPiAgIAkgKiBSZWZ1c2UgdGhlIHB1dCB0aGUg
Y3Vyc29yIGludG8gdGhhdCBjb21wcm9taXNlZCBwb3NpdGlvbi4KPiA+ICAgCSAqLwo+ID4gLQlp
ZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgJiYgcGlwZSA9PSBQSVBFX0MgJiYKPiA+ICsJaWYg
KElTX0NIRVJSWVZJRVcoaTkxNSkgJiYgcGlwZSA9PSBQSVBFX0MgJiYKPiA+ICAgCSAgICBwbGFu
ZV9zdGF0ZS0+YmFzZS52aXNpYmxlICYmIHBsYW5lX3N0YXRlLT5iYXNlLmNydGNfeCA8IDApIHsK
PiA+ICAgCQlEUk1fREVCVUdfS01TKCJDSFYgY3Vyc29yIEMgbm90IGFsbG93ZWQgdG8gc3RyYWRk
bGUgdGhlIGxlZnQgc2NyZWVuIGVkZ2VcbiIpOwo+ID4gICAJCXJldHVybiAtRUlOVkFMOwo+ID4g
QEAgLTEwNzU4LDcgKzEwNzU4LDcgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfY3Vyc29yKHN0
cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsK
PiA+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7Cj4gPiAgIAl1MzIgY250bCA9IDAs
IGJhc2UgPSAwLCBwb3MgPSAwLCBmYmNfY3RsID0gMDsKPiA+ICAgCXVuc2lnbmVkIGxvbmcgaXJx
ZmxhZ3M7Cj4gPiBAQCAtMTA3NzQsNyArMTA3NzQsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0
ZV9jdXJzb3Ioc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCQlwb3MgPSBpbnRlbF9j
dXJzb3JfcG9zaXRpb24ocGxhbmVfc3RhdGUpOwo+ID4gICAJfQo+ID4gLQlzcGluX2xvY2tfaXJx
c2F2ZSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gPiArCXNwaW5fbG9ja19p
cnFzYXZlKCZpOTE1LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gICAJLyoKPiA+ICAgCSAq
IE9uIHNvbWUgcGxhdGZvcm1zIHdyaXRpbmcgQ1VSQ05UUiBmaXJzdCB3aWxsIGFsc28KPiA+IEBA
IC0xMDc5NiwxMyArMTA3OTYsMTMgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfY3Vyc29yKHN0
cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIAkgKiB0aGUgQ1VSQ05UUiB3cml0ZSBhcm1z
IHRoZSB1cGRhdGUuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
OSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gICAJCXNrbF93cml0ZV9jdXJz
b3Jfd20ocGxhbmUsIGNydGNfc3RhdGUpOwo+ID4gICAJaWYgKHBsYW5lLT5jdXJzb3IuYmFzZSAh
PSBiYXNlIHx8Cj4gPiAgIAkgICAgcGxhbmUtPmN1cnNvci5zaXplICE9IGZiY19jdGwgfHwKPiA+
ICAgCSAgICBwbGFuZS0+Y3Vyc29yLmNudGwgIT0gY250bCkgewo+ID4gLQkJaWYgKEhBU19DVVJf
RkJDKGRldl9wcml2KSkKPiA+ICsJCWlmIChIQVNfQ1VSX0ZCQyhpOTE1KSkKPiA+ICAgCQkJSTkx
NV9XUklURV9GVyhDVVJfRkJDX0NUTChwaXBlKSwgZmJjX2N0bCk7Cj4gPiAgIAkJSTkxNV9XUklU
RV9GVyhDVVJDTlRSKHBpcGUpLCBjbnRsKTsKPiA+ICAgCQlJOTE1X1dSSVRFX0ZXKENVUlBPUyhw
aXBlKSwgcG9zKTsKPiA+IEBAIC0xMDgxNiw3ICsxMDgxNiw3IEBAIHN0YXRpYyB2b2lkIGk5eHhf
dXBkYXRlX2N1cnNvcihzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJCUk5MTVfV1JJ
VEVfRlcoQ1VSQkFTRShwaXBlKSwgYmFzZSk7Cj4gPiAgIAl9Cj4gPiAtCXNwaW5fdW5sb2NrX2ly
cXJlc3RvcmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gKwlzcGluX3Vu
bG9ja19pcnFyZXN0b3JlKCZpOTE1LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gICB9Cj4g
PiAgIHN0YXRpYyB2b2lkIGk5eHhfZGlzYWJsZV9jdXJzb3Ioc3RydWN0IGludGVsX3BsYW5lICpw
bGFuZSwKPiA+IEBAIC0xMDgyOCw3ICsxMDgyOCw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfZGlzYWJs
ZV9jdXJzb3Ioc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgc3RhdGljIGJvb2wgaTl4
eF9jdXJzb3JfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIAkJ
CQkgICAgIGVudW0gcGlwZSAqcGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gICAJ
ZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBwb3dlcl9kb21haW47Cj4gPiAgIAlpbnRl
bF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCWJvb2wgcmV0Owo+ID4gQEAgLTEwODQwLDcgKzEw
ODQwLDcgQEAgc3RhdGljIGJvb2wgaTl4eF9jdXJzb3JfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRl
bF9wbGFuZSAqcGxhbmUsCj4gPiAgIAkgKiBkaXNwbGF5IHBvd2VyIHdlbGxzLgo+ID4gICAJICov
Cj4gPiAgIAlwb3dlcl9kb21haW4gPSBQT1dFUl9ET01BSU5fUElQRShwbGFuZS0+cGlwZSk7Cj4g
PiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2
LCBwb3dlcl9kb21haW4pOwo+ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRf
aWZfZW5hYmxlZChpOTE1LCBwb3dlcl9kb21haW4pOwo+ID4gICAJaWYgKCF3YWtlcmVmKQo+ID4g
ICAJCXJldHVybiBmYWxzZTsKPiA+IEBAIC0xMDg0OCwxMyArMTA4NDgsMTMgQEAgc3RhdGljIGJv
b2wgaTl4eF9jdXJzb3JfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4g
PiAgIAlyZXQgPSB2YWwgJiBNQ1VSU09SX01PREU7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDUgfHwgSVNfRzRYKGRldl9wcml2KSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+
PSA1IHx8IElTX0c0WChpOTE1KSkKPiA+ICAgCQkqcGlwZSA9IHBsYW5lLT5waXBlOwo+ID4gICAJ
ZWxzZQo+ID4gICAJCSpwaXBlID0gKHZhbCAmIE1DVVJTT1JfUElQRV9TRUxFQ1RfTUFTSykgPj4K
PiA+ICAgCQkJTUNVUlNPUl9QSVBFX1NFTEVDVF9TSElGVDsKPiA+IC0JaW50ZWxfZGlzcGxheV9w
b3dlcl9wdXQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiArCWludGVsX2Rp
c3BsYXlfcG93ZXJfcHV0KGk5MTUsIHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1
cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtMTA5MjQsNyArMTA5MjQsNyBAQCBpbnQgaW50ZWxfZ2V0
X2xvYWRfZGV0ZWN0X3BpcGUoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAg
CXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciA9ICZpbnRlbF9lbmNvZGVyLT5iYXNlOwo+ID4g
ICAJc3RydWN0IGRybV9jcnRjICpjcnRjID0gTlVMTDsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSBlbmNvZGVyLT5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgZHJtX21vZGVfY29uZmlnICpjb25maWcgPSAm
ZGV2LT5tb2RlX2NvbmZpZzsKPiA+ICAgCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9
IE5VTEwsICpyZXN0b3JlX3N0YXRlID0gTlVMTDsKPiA+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9y
X3N0YXRlICpjb25uZWN0b3Jfc3RhdGU7Cj4gPiBAQCAtMTEwNTEsNyArMTEwNTEsNyBAQCBpbnQg
aW50ZWxfZ2V0X2xvYWRfZGV0ZWN0X3BpcGUoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rv
ciwKPiA+ICAgCWRybV9hdG9taWNfc3RhdGVfcHV0KHN0YXRlKTsKPiA+ICAgCS8qIGxldCB0aGUg
Y29ubmVjdG9yIGdldCB0aHJvdWdoIG9uZSBmdWxsIGN5Y2xlIGJlZm9yZSB0ZXN0aW5nICovCj4g
PiAtCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgaW50ZWxfY3J0Yy0+cGlwZSk7Cj4g
PiArCWludGVsX3dhaXRfZm9yX3ZibGFuayhpOTE1LCBpbnRlbF9jcnRjLT5waXBlKTsKPiA+ICAg
CXJldHVybiB0cnVlOwo+ID4gICBmYWlsOgo+ID4gQEAgLTExMDk2LDE0ICsxMTA5NiwxNCBAQCB2
b2lkIGludGVsX3JlbGVhc2VfbG9hZF9kZXRlY3RfcGlwZShzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAq
Y29ubmVjdG9yLAo+ID4gICBzdGF0aWMgaW50IGk5eHhfcGxsX3JlZmNsayhzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LAo+ID4gICAJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlw
ZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZGV2KTsKPiA+ICAgCXUzMiBkcGxsID0gcGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGUu
ZHBsbDsKPiA+ICAgCWlmICgoZHBsbCAmIFBMTF9SRUZfSU5QVVRfTUFTSykgPT0gUExMQl9SRUZf
SU5QVVRfU1BSRUFEU1BFQ1RSVU1JTikKPiA+IC0JCXJldHVybiBkZXZfcHJpdi0+dmJ0Lmx2ZHNf
c3NjX2ZyZXE7Cj4gPiAtCWVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKQo+ID4gKwkJ
cmV0dXJuIGk5MTUtPnZidC5sdmRzX3NzY19mcmVxOwo+ID4gKwllbHNlIGlmIChIQVNfUENIX1NQ
TElUKGk5MTUpKQo+ID4gICAJCXJldHVybiAxMjAwMDA7Cj4gPiAtCWVsc2UgaWYgKCFJU19HRU4o
ZGV2X3ByaXYsIDIpKQo+ID4gKwllbHNlIGlmICghSVNfR0VOKGk5MTUsIDIpKQo+ID4gICAJCXJl
dHVybiA5NjAwMDsKPiA+ICAgCWVsc2UKPiA+ICAgCQlyZXR1cm4gNDgwMDA7Cj4gPiBAQCAtMTEx
MTQsNyArMTExMTQsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X2NydGNfY2xvY2tfZ2V0KHN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVf
Y29uZmlnKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFz
ZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7
Cj4gPiAgIAlpbnQgcGlwZSA9IHBpcGVfY29uZmlnLT5jcHVfdHJhbnNjb2RlcjsKPiA+ICAgCXUz
MiBkcGxsID0gcGlwZV9jb25maWctPmRwbGxfaHdfc3RhdGUuZHBsbDsKPiA+ICAgCXUzMiBmcDsK
PiA+IEBAIC0xMTEyOCw3ICsxMTEyOCw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfY3J0Y19jbG9ja19n
ZXQoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJZnAgPSBwaXBlX2NvbmZpZy0+ZHBs
bF9od19zdGF0ZS5mcDE7Cj4gPiAgIAljbG9jay5tMSA9IChmcCAmIEZQX00xX0RJVl9NQVNLKSA+
PiBGUF9NMV9ESVZfU0hJRlQ7Cj4gPiAtCWlmIChJU19QSU5FVklFVyhkZXZfcHJpdikpIHsKPiA+
ICsJaWYgKElTX1BJTkVWSUVXKGk5MTUpKSB7Cj4gPiAgIAkJY2xvY2subiA9IGZmcygoZnAgJiBG
UF9OX1BJTkVWSUVXX0RJVl9NQVNLKSA+PiBGUF9OX0RJVl9TSElGVCkgLSAxOwo+ID4gICAJCWNs
b2NrLm0yID0gKGZwICYgRlBfTTJfUElORVZJRVdfRElWX01BU0spID4+IEZQX00yX0RJVl9TSElG
VDsKPiA+ICAgCX0gZWxzZSB7Cj4gPiBAQCAtMTExMzYsOCArMTExMzYsOCBAQCBzdGF0aWMgdm9p
ZCBpOXh4X2NydGNfY2xvY2tfZ2V0KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCWNs
b2NrLm0yID0gKGZwICYgRlBfTTJfRElWX01BU0spID4+IEZQX00yX0RJVl9TSElGVDsKPiA+ICAg
CX0KPiA+IC0JaWYgKCFJU19HRU4oZGV2X3ByaXYsIDIpKSB7Cj4gPiAtCQlpZiAoSVNfUElORVZJ
RVcoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUlTX0dFTihpOTE1LCAyKSkgewo+ID4gKwkJaWYgKElT
X1BJTkVWSUVXKGk5MTUpKQo+ID4gICAJCQljbG9jay5wMSA9IGZmcygoZHBsbCAmIERQTExfRlBB
MDFfUDFfUE9TVF9ESVZfTUFTS19QSU5FVklFVykgPj4KPiA+ICAgCQkJCURQTExfRlBBMDFfUDFf
UE9TVF9ESVZfU0hJRlRfUElORVZJRVcpOwo+ID4gICAJCWVsc2UKPiA+IEBAIC0xMTE1OSwxMiAr
MTExNTksMTIgQEAgc3RhdGljIHZvaWQgaTl4eF9jcnRjX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiA+ICAgCQkJcmV0dXJuOwo+ID4gICAJCX0KPiA+IC0JCWlmIChJU19QSU5F
VklFVyhkZXZfcHJpdikpCj4gPiArCQlpZiAoSVNfUElORVZJRVcoaTkxNSkpCj4gPiAgIAkJCXBv
cnRfY2xvY2sgPSBwbnZfY2FsY19kcGxsX3BhcmFtcyhyZWZjbGssICZjbG9jayk7Cj4gPiAgIAkJ
ZWxzZQo+ID4gICAJCQlwb3J0X2Nsb2NrID0gaTl4eF9jYWxjX2RwbGxfcGFyYW1zKHJlZmNsaywg
JmNsb2NrKTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAtCQl1MzIgbHZkcyA9IElTX0k4MzAoZGV2X3By
aXYpID8gMCA6IEk5MTVfUkVBRChMVkRTKTsKPiA+ICsJCXUzMiBsdmRzID0gSVNfSTgzMChpOTE1
KSA/IDAgOiBJOTE1X1JFQUQoTFZEUyk7Cj4gPiAgIAkJYm9vbCBpc19sdmRzID0gKHBpcGUgPT0g
MSkgJiYgKGx2ZHMgJiBMVkRTX1BPUlRfRU4pOwo+ID4gICAJCWlmIChpc19sdmRzKSB7Cj4gPiBA
QCAtMTEyMjEsNyArMTEyMjEsNyBAQCBpbnQgaW50ZWxfZG90Y2xvY2tfY2FsY3VsYXRlKGludCBs
aW5rX2ZyZXEsCj4gPiAgIHN0YXRpYyB2b2lkIGlyb25sYWtlX3BjaF9jbG9ja19nZXQoc3RydWN0
IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
cGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAkvKiByZWFkIG91dCBw
b3J0X2Nsb2NrIGZyb20gdGhlIERQTEwgKi8KPiA+ICAgCWk5eHhfY3J0Y19jbG9ja19nZXQoY3J0
YywgcGlwZV9jb25maWcpOwo+ID4gQEAgLTExMjMyLDcgKzExMjMyLDcgQEAgc3RhdGljIHZvaWQg
aXJvbmxha2VfcGNoX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCSAq
IENhbGN1bGF0ZSBvbmUgYmFzZWQgb24gdGhlIEZESSBjb25maWd1cmF0aW9uLgo+ID4gICAJICov
Cj4gPiAgIAlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPQo+ID4g
LQkJaW50ZWxfZG90Y2xvY2tfY2FsY3VsYXRlKGludGVsX2ZkaV9saW5rX2ZyZXEoZGV2X3ByaXYs
IHBpcGVfY29uZmlnKSwKPiA+ICsJCWludGVsX2RvdGNsb2NrX2NhbGN1bGF0ZShpbnRlbF9mZGlf
bGlua19mcmVxKGk5MTUsIHBpcGVfY29uZmlnKSwKPiA+ICAgCQkJCQkgJnBpcGVfY29uZmlnLT5m
ZGlfbV9uKTsKPiA+ICAgfQo+ID4gQEAgLTExMjQwLDcgKzExMjQwLDcgQEAgc3RhdGljIHZvaWQg
aXJvbmxha2VfcGNoX2Nsb2NrX2dldChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgKgo+ID4gICBpbnRlbF9lbmNvZGVyX2N1cnJlbnRfbW9kZShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOwo+ID4gICAJc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YzsKPiA+IEBAIC0xMTI0OSw3ICsxMTI0OSw3IEBAIGludGVsX2VuY29kZXJfY3VycmVudF9tb2Rl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICAJaWYgKCFlbmNvZGVyLT5nZXRf
aHdfc3RhdGUoZW5jb2RlciwgJnBpcGUpKQo+ID4gICAJCXJldHVybiBOVUxMOwo+ID4gLQljcnRj
ID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwljcnRjID0g
aW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoaTkxNSwgcGlwZSk7Cj4gPiAgIAltb2RlID0ga3phbGxv
YyhzaXplb2YoKm1vZGUpLCBHRlBfS0VSTkVMKTsKPiA+ICAgCWlmICghbW9kZSkKPiA+IEBAIC0x
MTI2Myw3ICsxMTI2Myw3IEBAIGludGVsX2VuY29kZXJfY3VycmVudF9tb2RlKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICAJY3J0Y19zdGF0ZS0+YmFzZS5jcnRjID0gJmNydGMt
PmJhc2U7Cj4gPiAtCWlmICghZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmlnKGNydGMs
IGNydGNfc3RhdGUpKSB7Cj4gPiArCWlmICghaTkxNS0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWco
Y3J0YywgY3J0Y19zdGF0ZSkpIHsKPiA+ICAgCQlrZnJlZShjcnRjX3N0YXRlKTsKPiA+ICAgCQlr
ZnJlZShtb2RlKTsKPiA+ICAgCQlyZXR1cm4gTlVMTDsKPiA+IEBAIC0xMTMzNyw3ICsxMTMzNyw3
IEBAIGludCBpbnRlbF9wbGFuZV9hdG9taWNfY2FsY19jaGFuZ2VzKGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50
ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUg
KnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPnBsYW5lKTsKPiA+ICAgCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlib29sIG1vZGVfY2hhbmdlZCA9IG5lZWRz
X21vZGVzZXQoY3J0Y19zdGF0ZSk7Cj4gPiAgIAlib29sIHdhc19jcnRjX2VuYWJsZWQgPSBvbGRf
Y3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmU7Cj4gPiAgIAlib29sIGlzX2NydGNfZW5hYmxlZCA9IGNy
dGNfc3RhdGUtPmFjdGl2ZTsKPiA+IEBAIC0xMTM0NSw3ICsxMTM0NSw3IEBAIGludCBpbnRlbF9w
bGFuZV9hdG9taWNfY2FsY19jaGFuZ2VzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpv
bGRfY3J0Y19zdGF0Cj4gPiAgIAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0
YXRlLT5mYjsKPiA+ICAgCWludCByZXQ7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDkgJiYgcGxhbmUtPmlkICE9IFBMQU5FX0NVUlNPUikgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5
MTUpID49IDkgJiYgcGxhbmUtPmlkICE9IFBMQU5FX0NVUlNPUikgewo+ID4gICAJCXJldCA9IHNr
bF91cGRhdGVfc2NhbGVyX3BsYW5lKAo+ID4gICAJCQl0b19pbnRlbF9jcnRjX3N0YXRlKGNydGNf
c3RhdGUpLAo+ID4gICAJCQl0b19pbnRlbF9wbGFuZV9zdGF0ZShwbGFuZV9zdGF0ZSkpOwo+ID4g
QEAgLTExMzk1LDE0ICsxMTM5NSwxNCBAQCBpbnQgaW50ZWxfcGxhbmVfYXRvbWljX2NhbGNfY2hh
bmdlcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdAo+ID4gICAJ
CQkgdHVybl9vZmYsIHR1cm5fb24sIG1vZGVfY2hhbmdlZCk7Cj4gPiAgIAlpZiAodHVybl9vbikg
ewo+ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA1ICYmICFJU19HNFgoZGV2X3ByaXYp
KQo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8IDUgJiYgIUlTX0c0WChpOTE1KSkKPiA+ICAg
CQkJcGlwZV9jb25maWctPnVwZGF0ZV93bV9wcmUgPSB0cnVlOwo+ID4gICAJCS8qIG11c3QgZGlz
YWJsZSBjeHNyIGFyb3VuZCBwbGFuZSBlbmFibGUvZGlzYWJsZSAqLwo+ID4gICAJCWlmIChwbGFu
ZS0+aWQgIT0gUExBTkVfQ1VSU09SKQo+ID4gICAJCQlwaXBlX2NvbmZpZy0+ZGlzYWJsZV9jeHNy
ID0gdHJ1ZTsKPiA+ICAgCX0gZWxzZSBpZiAodHVybl9vZmYpIHsKPiA+IC0JCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpIDwgNSAmJiAhSVNfRzRYKGRldl9wcml2KSkKPiA+ICsJCWlmIChJTlRFTF9H
RU4oaTkxNSkgPCA1ICYmICFJU19HNFgoaTkxNSkpCj4gPiAgIAkJCXBpcGVfY29uZmlnLT51cGRh
dGVfd21fcG9zdCA9IHRydWU7Cj4gPiAgIAkJLyogbXVzdCBkaXNhYmxlIGN4c3IgYXJvdW5kIHBs
YW5lIGVuYWJsZS9kaXNhYmxlICovCj4gPiBAQCAtMTE0MTAsNyArMTE0MTAsNyBAQCBpbnQgaW50
ZWxfcGxhbmVfYXRvbWljX2NhbGNfY2hhbmdlcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqb2xkX2NydGNfc3RhdAo+ID4gICAJCQlwaXBlX2NvbmZpZy0+ZGlzYWJsZV9jeHNyID0gdHJ1
ZTsKPiA+ICAgCX0gZWxzZSBpZiAoaW50ZWxfd21fbmVlZF91cGRhdGUodG9faW50ZWxfcGxhbmVf
c3RhdGUocGxhbmUtPmJhc2Uuc3RhdGUpLAo+ID4gICAJCQkJCXRvX2ludGVsX3BsYW5lX3N0YXRl
KHBsYW5lX3N0YXRlKSkpIHsKPiA+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNSAmJiAh
SVNfRzRYKGRldl9wcml2KSkgewo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8IDUgJiYgIUlT
X0c0WChpOTE1KSkgewo+ID4gICAJCQkvKiBGSVhNRSBib2xsb2NrcyAqLwo+ID4gICAJCQlwaXBl
X2NvbmZpZy0+dXBkYXRlX3dtX3ByZSA9IHRydWU7Cj4gPiAgIAkJCXBpcGVfY29uZmlnLT51cGRh
dGVfd21fcG9zdCA9IHRydWU7Cj4gPiBAQCAtMTE0NTQsOCArMTE0NTQsOCBAQCBpbnQgaW50ZWxf
cGxhbmVfYXRvbWljX2NhbGNfY2hhbmdlcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
b2xkX2NydGNfc3RhdAo+ID4gICAJICogcGxhbmUsIG5vdCBvbmx5IHNwcml0ZSBwbGFuZS4KPiA+
ICAgCSAqLwo+ID4gICAJaWYgKHBsYW5lLT5pZCAhPSBQTEFORV9DVVJTT1IgJiYKPiA+IC0JICAg
IChJU19HRU5fUkFOR0UoZGV2X3ByaXYsIDUsIDYpIHx8Cj4gPiAtCSAgICAgSVNfSVZZQlJJREdF
KGRldl9wcml2KSkgJiYKPiA+ICsJICAgIChJU19HRU5fUkFOR0UoaTkxNSwgNSwgNikgfHwKPiA+
ICsJICAgICBJU19JVllCUklER0UoaTkxNSkpICYmCj4gPiAgIAkgICAgKHR1cm5fb24gfHwgKCFu
ZWVkc19zY2FsaW5nKG9sZF9wbGFuZV9zdGF0ZSkgJiYKPiA+ICAgCQkJIG5lZWRzX3NjYWxpbmco
dG9faW50ZWxfcGxhbmVfc3RhdGUocGxhbmVfc3RhdGUpKSkpKQo+ID4gICAJCXBpcGVfY29uZmln
LT5kaXNhYmxlX2xwX3dtID0gdHJ1ZTsKPiA+IEBAIC0xMTUxOSwxMyArMTE1MTksMTMgQEAgc3Rh
dGljIGludCBpY2xfYWRkX2xpbmtlZF9wbGFuZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUpCj4gPiAgIHN0YXRpYyBpbnQgaWNsX2NoZWNrX252MTJfcGxhbmVzKHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSA9IHRvX2ludGVs
X2F0b21pY19zdGF0ZShjcnRjX3N0YXRlLT5iYXNlLnN0YXRlKTsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9wbGFuZSAqcGxhbmUsICpsaW5rZWQ7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUg
KnBsYW5lX3N0YXRlOwo+ID4gICAJaW50IGk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
IDwgMTEpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCAxMSkKPiA+ICAgCQlyZXR1cm4gMDsK
PiA+ICAgCS8qCj4gPiBAQCAtMTE1NTUsNyArMTE1NTUsNyBAQCBzdGF0aWMgaW50IGljbF9jaGVj
a19udjEyX3BsYW5lcyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAg
CQkgICAgIShjcnRjX3N0YXRlLT5udjEyX3BsYW5lcyAmIEJJVChwbGFuZS0+aWQpKSkKPiA+ICAg
CQkJY29udGludWU7Cj4gPiAtCQlmb3JfZWFjaF9pbnRlbF9wbGFuZV9vbl9jcnRjKCZkZXZfcHJp
di0+ZHJtLCBjcnRjLCBsaW5rZWQpIHsKPiA+ICsJCWZvcl9lYWNoX2ludGVsX3BsYW5lX29uX2Ny
dGMoJmk5MTUtPmRybSwgY3J0YywgbGlua2VkKSB7Cj4gPiAgIAkJCWlmICghaWNsX2lzX252MTJf
eV9wbGFuZShsaW5rZWQtPmlkKSkKPiA+ICAgCQkJCWNvbnRpbnVlOwo+ID4gQEAgLTExNjAyLDIx
ICsxMTYwMiwyMSBAQCBzdGF0aWMgYm9vbCBjOF9wbGFuZXNfY2hhbmdlZChjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCj4gPiAgIHN0YXRpYyBpbnQgaW50ZWxf
Y3J0Y19hdG9taWNfY2hlY2soc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ID4gICAJCQkJICAgc3Ry
dWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmRldik7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcgPQo+ID4gICAJCXRvX2ludGVsX2Ny
dGNfc3RhdGUoY3J0Y19zdGF0ZSk7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gICAJYm9vbCBtb2RlX2No
YW5nZWQgPSBuZWVkc19tb2Rlc2V0KGNydGNfc3RhdGUpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA8IDUgJiYgIUlTX0c0WChkZXZfcHJpdikgJiYKPiA+ICsJaWYgKElOVEVMX0dFTihp
OTE1KSA8IDUgJiYgIUlTX0c0WChpOTE1KSAmJgo+ID4gICAJICAgIG1vZGVfY2hhbmdlZCAmJiAh
Y3J0Y19zdGF0ZS0+YWN0aXZlKQo+ID4gICAJCXBpcGVfY29uZmlnLT51cGRhdGVfd21fcG9zdCA9
IHRydWU7Cj4gPiAgIAlpZiAobW9kZV9jaGFuZ2VkICYmIGNydGNfc3RhdGUtPmVuYWJsZSAmJgo+
ID4gLQkgICAgZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19jb21wdXRlX2Nsb2NrICYmCj4gPiArCSAg
ICBpOTE1LT5kaXNwbGF5LmNydGNfY29tcHV0ZV9jbG9jayAmJgo+ID4gICAJICAgICFXQVJOX09O
KHBpcGVfY29uZmlnLT5zaGFyZWRfZHBsbCkpIHsKPiA+IC0JCXJldCA9IGRldl9wcml2LT5kaXNw
bGF5LmNydGNfY29tcHV0ZV9jbG9jayhpbnRlbF9jcnRjLAo+ID4gKwkJcmV0ID0gaTkxNS0+ZGlz
cGxheS5jcnRjX2NvbXB1dGVfY2xvY2soaW50ZWxfY3J0YywKPiA+ICAgCQkJCQkJCSAgIHBpcGVf
Y29uZmlnKTsKPiA+ICAgCQlpZiAocmV0KQo+ID4gICAJCQlyZXR1cm4gcmV0Owo+ID4gQEAgLTEx
NjM3LDE2ICsxMTYzNywxNiBAQCBzdGF0aWMgaW50IGludGVsX2NydGNfYXRvbWljX2NoZWNrKHN0
cnVjdCBkcm1fY3J0YyAqY3J0YywKPiA+ICAgCX0KPiA+ICAgCXJldCA9IDA7Cj4gPiAtCWlmIChk
ZXZfcHJpdi0+ZGlzcGxheS5jb21wdXRlX3BpcGVfd20pIHsKPiA+IC0JCXJldCA9IGRldl9wcml2
LT5kaXNwbGF5LmNvbXB1dGVfcGlwZV93bShwaXBlX2NvbmZpZyk7Cj4gPiArCWlmIChpOTE1LT5k
aXNwbGF5LmNvbXB1dGVfcGlwZV93bSkgewo+ID4gKwkJcmV0ID0gaTkxNS0+ZGlzcGxheS5jb21w
dXRlX3BpcGVfd20ocGlwZV9jb25maWcpOwo+ID4gICAJCWlmIChyZXQpIHsKPiA+ICAgCQkJRFJN
X0RFQlVHX0tNUygiVGFyZ2V0IHBpcGUgd2F0ZXJtYXJrcyBhcmUgaW52YWxpZFxuIik7Cj4gPiAg
IAkJCXJldHVybiByZXQ7Cj4gPiAgIAkJfQo+ID4gICAJfQo+ID4gLQlpZiAoZGV2X3ByaXYtPmRp
c3BsYXkuY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20pIHsKPiA+IC0JCWlmIChXQVJOX09OKCFkZXZf
cHJpdi0+ZGlzcGxheS5jb21wdXRlX3BpcGVfd20pKQo+ID4gKwlpZiAoaTkxNS0+ZGlzcGxheS5j
b21wdXRlX2ludGVybWVkaWF0ZV93bSkgewo+ID4gKwkJaWYgKFdBUk5fT04oIWk5MTUtPmRpc3Bs
YXkuY29tcHV0ZV9waXBlX3dtKSkKPiA+ICAgCQkJcmV0dXJuIDA7Cj4gPiAgIAkJLyoKPiA+IEBA
IC0xMTY1NCwxNCArMTE2NTQsMTQgQEAgc3RhdGljIGludCBpbnRlbF9jcnRjX2F0b21pY19jaGVj
ayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gPiAgIAkJICogb2xkIHN0YXRlIGFuZCB0aGUgbmV3
IHN0YXRlLiAgV2UgY2FuIHByb2dyYW0gdGhlc2UKPiA+ICAgCQkgKiBpbW1lZGlhdGVseS4KPiA+
ICAgCQkgKi8KPiA+IC0JCXJldCA9IGRldl9wcml2LT5kaXNwbGF5LmNvbXB1dGVfaW50ZXJtZWRp
YXRlX3dtKHBpcGVfY29uZmlnKTsKPiA+ICsJCXJldCA9IGk5MTUtPmRpc3BsYXkuY29tcHV0ZV9p
bnRlcm1lZGlhdGVfd20ocGlwZV9jb25maWcpOwo+ID4gICAJCWlmIChyZXQpIHsKPiA+ICAgCQkJ
RFJNX0RFQlVHX0tNUygiTm8gdmFsaWQgaW50ZXJtZWRpYXRlIHBpcGUgd2F0ZXJtYXJrcyBhcmUg
cG9zc2libGVcbiIpOwo+ID4gICAJCQlyZXR1cm4gcmV0Owo+ID4gICAJCX0KPiA+ICAgCX0KPiA+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5
MTUpID49IDkpIHsKPiA+ICAgCQlpZiAobW9kZV9jaGFuZ2VkIHx8IHBpcGVfY29uZmlnLT51cGRh
dGVfcGlwZSkKPiA+ICAgCQkJcmV0ID0gc2tsX3VwZGF0ZV9zY2FsZXJfY3J0YyhwaXBlX2NvbmZp
Zyk7Cj4gPiBAQCAtMTE2NzEsMTEgKzExNjcxLDExIEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19h
dG9taWNfY2hlY2soc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ID4gICAJCQlyZXQgPSBza2xfY2hl
Y2tfcGlwZV9tYXhfcGl4ZWxfcmF0ZShpbnRlbF9jcnRjLAo+ID4gICAJCQkJCQkJICAgIHBpcGVf
Y29uZmlnKTsKPiA+ICAgCQlpZiAoIXJldCkKPiA+IC0JCQlyZXQgPSBpbnRlbF9hdG9taWNfc2V0
dXBfc2NhbGVycyhkZXZfcHJpdiwgaW50ZWxfY3J0YywKPiA+ICsJCQlyZXQgPSBpbnRlbF9hdG9t
aWNfc2V0dXBfc2NhbGVycyhpOTE1LCBpbnRlbF9jcnRjLAo+ID4gICAJCQkJCQkJIHBpcGVfY29u
ZmlnKTsKPiA+ICAgCX0KPiA+IC0JaWYgKEhBU19JUFMoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFT
X0lQUyhpOTE1KSkKPiA+ICAgCQlwaXBlX2NvbmZpZy0+aXBzX2VuYWJsZWQgPSBoc3dfY29tcHV0
ZV9pcHNfY29uZmlnKHBpcGVfY29uZmlnKTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiBAQCAtMTE3
NTIsMTYgKzExNzUyLDE2IEBAIHN0YXRpYyBpbnQKPiA+ICAgY29tcHV0ZV9iYXNlbGluZV9waXBl
X2JwcChzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJICBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1
Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBwaXBlX2NvbmZpZy0+YmFzZS5zdGF0ZTsKPiA+
ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9zdGF0ZSAqY29ubmVjdG9yX3N0YXRlOwo+ID4gICAJaW50IGJwcCwgaTsKPiA+IC0J
aWYgKChJU19HNFgoZGV2X3ByaXYpIHx8IElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8Cj4gPiAt
CSAgICBJU19DSEVSUllWSUVXKGRldl9wcml2KSkpCj4gPiArCWlmICgoSVNfRzRYKGk5MTUpIHx8
IElTX1ZBTExFWVZJRVcoaTkxNSkgfHwKPiA+ICsJICAgIElTX0NIRVJSWVZJRVcoaTkxNSkpKQo+
ID4gICAJCWJwcCA9IDEwKjM7Cj4gPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
NSkKPiA+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDUpCj4gPiAgIAkJYnBwID0gMTIq
MzsKPiA+ICAgCWVsc2UKPiA+ICAgCQlicHAgPSA4KjM7Cj4gPiBAQCAtMTE4MDcsMTMgKzExODA3
LDEzIEBAIGludGVsX2R1bXBfbV9uX2NvbmZpZyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqcGlwZV9jb25maWcsCj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQKPiA+IC1pbnRlbF9kdW1w
X2luZm9mcmFtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAraW50ZWxf
ZHVtcF9pbmZvZnJhbWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAg
ICBjb25zdCB1bmlvbiBoZG1pX2luZm9mcmFtZSAqZnJhbWUpCj4gPiAgIHsKPiA+ICAgCWlmICgo
ZHJtX2RlYnVnICYgRFJNX1VUX0tNUykgPT0gMCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWhkbWlf
aW5mb2ZyYW1lX2xvZyhLRVJOX0RFQlVHLCBkZXZfcHJpdi0+ZHJtLmRldiwgZnJhbWUpOwo+ID4g
KwloZG1pX2luZm9mcmFtZV9sb2coS0VSTl9ERUJVRywgaTkxNS0+ZHJtLmRldiwgZnJhbWUpOwo+
ID4gICB9Cj4gPiAgICNkZWZpbmUgT1VUUFVUX1RZUEUoeCkgW0lOVEVMX09VVFBVVF8gIyMgeF0g
PSAjeAo+ID4gQEAgLTExOTA3LDcgKzExOTA3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHVtcF9w
aXBlX2NvbmZpZyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4g
PiAgIAkJCQkgICBjb25zdCBjaGFyICpjb250ZXh0KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFz
ZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ID4gICAJY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFu
ZV9zdGF0ZTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmU7Cj4gPiAgIAljaGFyIGJ1
Zls2NF07Cj4gPiBAQCAtMTE5NTMsMTMgKzExOTUzLDEzIEBAIHN0YXRpYyB2b2lkIGludGVsX2R1
bXBfcGlwZV9jb25maWcoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmln
LAo+ID4gICAJCURSTV9ERUJVR19LTVMoIkdDUDogMHgleFxuIiwgcGlwZV9jb25maWctPmluZm9m
cmFtZXMuZ2NwKTsKPiA+ICAgCWlmIChwaXBlX2NvbmZpZy0+aW5mb2ZyYW1lcy5lbmFibGUgJgo+
ID4gICAJICAgIGludGVsX2hkbWlfaW5mb2ZyYW1lX2VuYWJsZShIRE1JX0lORk9GUkFNRV9UWVBF
X0FWSSkpCj4gPiAtCQlpbnRlbF9kdW1wX2luZm9mcmFtZShkZXZfcHJpdiwgJnBpcGVfY29uZmln
LT5pbmZvZnJhbWVzLmF2aSk7Cj4gPiArCQlpbnRlbF9kdW1wX2luZm9mcmFtZShpOTE1LCAmcGlw
ZV9jb25maWctPmluZm9mcmFtZXMuYXZpKTsKPiA+ICAgCWlmIChwaXBlX2NvbmZpZy0+aW5mb2Zy
YW1lcy5lbmFibGUgJgo+ID4gICAJICAgIGludGVsX2hkbWlfaW5mb2ZyYW1lX2VuYWJsZShIRE1J
X0lORk9GUkFNRV9UWVBFX1NQRCkpCj4gPiAtCQlpbnRlbF9kdW1wX2luZm9mcmFtZShkZXZfcHJp
diwgJnBpcGVfY29uZmlnLT5pbmZvZnJhbWVzLnNwZCk7Cj4gPiArCQlpbnRlbF9kdW1wX2luZm9m
cmFtZShpOTE1LCAmcGlwZV9jb25maWctPmluZm9mcmFtZXMuc3BkKTsKPiA+ICAgCWlmIChwaXBl
X2NvbmZpZy0+aW5mb2ZyYW1lcy5lbmFibGUgJgo+ID4gICAJICAgIGludGVsX2hkbWlfaW5mb2Zy
YW1lX2VuYWJsZShIRE1JX0lORk9GUkFNRV9UWVBFX1ZFTkRPUikpCj4gPiAtCQlpbnRlbF9kdW1w
X2luZm9mcmFtZShkZXZfcHJpdiwgJnBpcGVfY29uZmlnLT5pbmZvZnJhbWVzLmhkbWkpOwo+ID4g
KwkJaW50ZWxfZHVtcF9pbmZvZnJhbWUoaTkxNSwgJnBpcGVfY29uZmlnLT5pbmZvZnJhbWVzLmhk
bWkpOwo+ID4gICAJRFJNX0RFQlVHX0tNUygicmVxdWVzdGVkIG1vZGU6XG4iKTsKPiA+ICAgCWRy
bV9tb2RlX2RlYnVnX3ByaW50bW9kZWxpbmUoJnBpcGVfY29uZmlnLT5iYXNlLm1vZGUpOwo+ID4g
QEAgLTExOTcxLDEzICsxMTk3MSwxMyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kdW1wX3BpcGVfY29u
ZmlnKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiA+ICAgCQkg
ICAgICBwaXBlX2NvbmZpZy0+cGlwZV9zcmNfdywgcGlwZV9jb25maWctPnBpcGVfc3JjX2gsCj4g
PiAgIAkJICAgICAgcGlwZV9jb25maWctPnBpeGVsX3JhdGUpOwo+ID4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSA5KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCj4gPiAgIAkJ
RFJNX0RFQlVHX0tNUygibnVtX3NjYWxlcnM6ICVkLCBzY2FsZXJfdXNlcnM6IDB4JXgsIHNjYWxl
cl9pZDogJWRcbiIsCj4gPiAgIAkJCSAgICAgIGNydGMtPm51bV9zY2FsZXJzLAo+ID4gICAJCQkg
ICAgICBwaXBlX2NvbmZpZy0+c2NhbGVyX3N0YXRlLnNjYWxlcl91c2VycywKPiA+ICAgCQkgICAg
ICAgICAgICAgIHBpcGVfY29uZmlnLT5zY2FsZXJfc3RhdGUuc2NhbGVyX2lkKTsKPiA+IC0JaWYg
KEhBU19HTUNIKGRldl9wcml2KSkKPiA+ICsJaWYgKEhBU19HTUNIKGk5MTUpKQo+ID4gICAJCURS
TV9ERUJVR19LTVMoImdtY2ggcGZpdDogY29udHJvbDogMHglMDh4LCByYXRpb3M6IDB4JTA4eCwg
bHZkcyBib3JkZXI6IDB4JTA4eFxuIiwKPiA+ICAgCQkJICAgICAgcGlwZV9jb25maWctPmdtY2hf
cGZpdC5jb250cm9sLAo+ID4gICAJCQkgICAgICBwaXBlX2NvbmZpZy0+Z21jaF9wZml0LnBnbV9y
YXRpb3MsCj4gPiBAQCAtMTE5OTIsNyArMTE5OTIsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kdW1w
X3BpcGVfY29uZmlnKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywK
PiA+ICAgCURSTV9ERUJVR19LTVMoImlwczogJWksIGRvdWJsZSB3aWRlOiAlaVxuIiwKPiA+ICAg
CQkgICAgICBwaXBlX2NvbmZpZy0+aXBzX2VuYWJsZWQsIHBpcGVfY29uZmlnLT5kb3VibGVfd2lk
ZSk7Cj4gPiAtCWludGVsX2RwbGxfZHVtcF9od19zdGF0ZShkZXZfcHJpdiwgJnBpcGVfY29uZmln
LT5kcGxsX2h3X3N0YXRlKTsKPiA+ICsJaW50ZWxfZHBsbF9kdW1wX2h3X3N0YXRlKGk5MTUsICZw
aXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZSk7Cj4gPiAgIGR1bXBfcGxhbmVzOgo+ID4gICAJaWYg
KCFzdGF0ZSkKPiA+IEBAIC0xMjA3Myw3ICsxMjA3Myw3IEBAIHN0YXRpYyBib29sIGNoZWNrX2Rp
Z2l0YWxfcG9ydF9jb25mbGljdHMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4g
PiAgIHN0YXRpYyBpbnQKPiA+ICAgY2xlYXJfaW50ZWxfY3J0Y19zdGF0ZShzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4g
PiAgIAkJdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqc2F2ZWRfc3RhdGU7Cj4gPiBAQCAtMTIwOTAsOCArMTIwOTAsOCBA
QCBjbGVhcl9pbnRlbF9jcnRjX3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ID4gICAJc2F2ZWRfc3RhdGUtPnNoYXJlZF9kcGxsID0gY3J0Y19zdGF0ZS0+c2hhcmVk
X2RwbGw7Cj4gPiAgIAlzYXZlZF9zdGF0ZS0+ZHBsbF9od19zdGF0ZSA9IGNydGNfc3RhdGUtPmRw
bGxfaHdfc3RhdGU7Cj4gPiAgIAlzYXZlZF9zdGF0ZS0+Y3JjX2VuYWJsZWQgPSBjcnRjX3N0YXRl
LT5jcmNfZW5hYmxlZDsKPiA+IC0JaWYgKElTX0c0WChkZXZfcHJpdikgfHwKPiA+IC0JICAgIElT
X1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwlp
ZiAoSVNfRzRYKGk5MTUpIHx8Cj4gPiArCSAgICBJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NI
RVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJc2F2ZWRfc3RhdGUtPndtID0gY3J0Y19zdGF0ZS0+d207
Cj4gPiAgIAkvKiBLZWVwIGJhc2UgZHJtX2NydGNfc3RhdGUgaW50YWN0LCBvbmx5IGNsZWFyIG91
ciBleHRlbmRlZCBzdHJ1Y3QgKi8KPiA+IEBAIC0xMjMxNiw3ICsxMjMxNiw3IEBAIGludGVsX2Nv
bXBhcmVfaW5mb2ZyYW1lKGNvbnN0IHVuaW9uIGhkbWlfaW5mb2ZyYW1lICphLAo+ID4gICB9Cj4g
PiAgIHN0YXRpYyB2b2lkCj4gPiAtcGlwZV9jb25maWdfaW5mb2ZyYW1lX2VycihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArcGlwZV9jb25maWdfaW5mb2ZyYW1lX2Vycihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICBib29sIGFkanVzdCwgY29u
c3QgY2hhciAqbmFtZSwKPiA+ICAgCQkJICBjb25zdCB1bmlvbiBoZG1pX2luZm9mcmFtZSAqYSwK
PiA+ICAgCQkJICBjb25zdCB1bmlvbiBoZG1pX2luZm9mcmFtZSAqYikKPiA+IEBAIC0xMjMyNywx
NSArMTIzMjcsMTUgQEAgcGlwZV9jb25maWdfaW5mb2ZyYW1lX2VycihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJZHJtX2RiZyhEUk1fVVRfS01TLCAibWlzbWF0Y2gg
aW4gJXMgaW5mb2ZyYW1lIiwgbmFtZSk7Cj4gPiAgIAkJZHJtX2RiZyhEUk1fVVRfS01TLCAiZXhw
ZWN0ZWQ6Iik7Cj4gPiAtCQloZG1pX2luZm9mcmFtZV9sb2coS0VSTl9ERUJVRywgZGV2X3ByaXYt
PmRybS5kZXYsIGEpOwo+ID4gKwkJaGRtaV9pbmZvZnJhbWVfbG9nKEtFUk5fREVCVUcsIGk5MTUt
PmRybS5kZXYsIGEpOwo+ID4gICAJCWRybV9kYmcoRFJNX1VUX0tNUywgImZvdW5kIik7Cj4gPiAt
CQloZG1pX2luZm9mcmFtZV9sb2coS0VSTl9ERUJVRywgZGV2X3ByaXYtPmRybS5kZXYsIGIpOwo+
ID4gKwkJaGRtaV9pbmZvZnJhbWVfbG9nKEtFUk5fREVCVUcsIGk5MTUtPmRybS5kZXYsIGIpOwo+
ID4gICAJfSBlbHNlIHsKPiA+ICAgCQlkcm1fZXJyKCJtaXNtYXRjaCBpbiAlcyBpbmZvZnJhbWUi
LCBuYW1lKTsKPiA+ICAgCQlkcm1fZXJyKCJleHBlY3RlZDoiKTsKPiA+IC0JCWhkbWlfaW5mb2Zy
YW1lX2xvZyhLRVJOX0VSUiwgZGV2X3ByaXYtPmRybS5kZXYsIGEpOwo+ID4gKwkJaGRtaV9pbmZv
ZnJhbWVfbG9nKEtFUk5fRVJSLCBpOTE1LT5kcm0uZGV2LCBhKTsKPiA+ICAgCQlkcm1fZXJyKCJm
b3VuZCIpOwo+ID4gLQkJaGRtaV9pbmZvZnJhbWVfbG9nKEtFUk5fRVJSLCBkZXZfcHJpdi0+ZHJt
LmRldiwgYik7Cj4gPiArCQloZG1pX2luZm9mcmFtZV9sb2coS0VSTl9FUlIsIGk5MTUtPmRybS5k
ZXYsIGIpOwo+ID4gICAJfQo+ID4gICB9Cj4gPiBAQCAtMTIzNTcsMTcgKzEyMzU3LDE3IEBAIHBp
cGVfY29uZmlnX2Vycihib29sIGFkanVzdCwgY29uc3QgY2hhciAqbmFtZSwgY29uc3QgY2hhciAq
Zm9ybWF0LCAuLi4pCj4gPiAgIAl2YV9lbmQoYXJncyk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9v
bCBmYXN0Ym9vdF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICtzdGF0aWMgYm9vbCBmYXN0Ym9vdF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAgIAlpZiAoaTkxNV9tb2RwYXJhbXMuZmFzdGJvb3QgIT0gLTEpCj4g
PiAgIAkJcmV0dXJuIGk5MTVfbW9kcGFyYW1zLmZhc3Rib290Owo+ID4gICAJLyogRW5hYmxlIGZh
c3Rib290IGJ5IGRlZmF1bHQgb24gU2t5bGFrZSBhbmQgbmV3ZXIgKi8KPiA+IC0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gOSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4g
ICAJCXJldHVybiB0cnVlOwo+ID4gICAJLyogRW5hYmxlIGZhc3Rib290IGJ5IGRlZmF1bHQgb24g
VkxWIGFuZCBDSFYgKi8KPiA+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NI
RVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19D
SEVSUllWSUVXKGk5MTUpKQo+ID4gICAJCXJldHVybiB0cnVlOwo+ID4gICAJLyogRGlzYWJsZWQg
YnkgZGVmYXVsdCBvbiBhbGwgb3RoZXJzICovCj4gPiBAQCAtMTIzNzUsNyArMTIzNzUsNyBAQCBz
dGF0aWMgYm9vbCBmYXN0Ym9vdF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICAgfQo+ID4gICBzdGF0aWMgYm9vbAo+ID4gLWludGVsX3BpcGVfY29uZmlnX2Nv
bXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2ludGVsX3BpcGVf
Y29uZmlnX2NvbXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmN1cnJlbnRfY29uZmlnLAo+ID4gICAJCQkgIHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiA+ICAgCQkJICBib29sIGFkanVzdCkK
PiA+IEBAIC0xMjM4NSw3ICsxMjM4NSw3IEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCShjdXJyZW50X2NvbmZpZy0+
YmFzZS5tb2RlLnByaXZhdGVfZmxhZ3MgJiBJOTE1X01PREVfRkxBR19JTkhFUklURUQpICYmCj4g
PiAgIAkJIShwaXBlX2NvbmZpZy0+YmFzZS5tb2RlLnByaXZhdGVfZmxhZ3MgJiBJOTE1X01PREVf
RkxBR19JTkhFUklURUQpOwo+ID4gLQlpZiAoZml4dXBfaW5oZXJpdGVkICYmICFmYXN0Ym9vdF9l
bmFibGVkKGRldl9wcml2KSkgewo+ID4gKwlpZiAoZml4dXBfaW5oZXJpdGVkICYmICFmYXN0Ym9v
dF9lbmFibGVkKGk5MTUpKSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiaW5pdGlhbCBtb2Rlc2V0
IGFuZCBmYXN0Ym9vdCBub3Qgc2V0XG4iKTsKPiA+ICAgCQlyZXQgPSBmYWxzZTsKPiA+ICAgCX0K
PiA+IEBAIC0xMjUyNSw3ICsxMjUyNSw3IEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAjZGVmaW5lIFBJUEVfQ09ORl9D
SEVDS19JTkZPRlJBTUUobmFtZSkgZG8geyBcCj4gPiAgIAlpZiAoIWludGVsX2NvbXBhcmVfaW5m
b2ZyYW1lKCZjdXJyZW50X2NvbmZpZy0+aW5mb2ZyYW1lcy5uYW1lLCBcCj4gPiAgIAkJCQkgICAg
ICZwaXBlX2NvbmZpZy0+aW5mb2ZyYW1lcy5uYW1lKSkgeyBcCj4gPiAtCQlwaXBlX2NvbmZpZ19p
bmZvZnJhbWVfZXJyKGRldl9wcml2LCBhZGp1c3QsIF9fc3RyaW5naWZ5KG5hbWUpLCBcCj4gPiAr
CQlwaXBlX2NvbmZpZ19pbmZvZnJhbWVfZXJyKGk5MTUsIGFkanVzdCwgX19zdHJpbmdpZnkobmFt
ZSksIFwKPiA+ICAgCQkJCQkgICZjdXJyZW50X2NvbmZpZy0+aW5mb2ZyYW1lcy5uYW1lLCBcCj4g
PiAgIAkJCQkJICAmcGlwZV9jb25maWctPmluZm9mcmFtZXMubmFtZSk7IFwKPiA+ICAgCQlyZXQg
PSBmYWxzZTsgXAo+ID4gQEAgLTEyNTQ0LDcgKzEyNTQ0LDcgQEAgaW50ZWxfcGlwZV9jb25maWdf
Y29tcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlQSVBFX0NP
TkZfQ0hFQ0tfSShsYW5lX2NvdW50KTsKPiA+ICAgCVBJUEVfQ09ORl9DSEVDS19YKGxhbmVfbGF0
X29wdGltX21hc2spOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDgpIHsKPiA+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA8IDgpIHsKPiA+ICAgCQlQSVBFX0NPTkZfQ0hFQ0tfTV9OKGRw
X21fbik7Cj4gPiAgIAkJaWYgKGN1cnJlbnRfY29uZmlnLT5oYXNfZHJycykKPiA+IEBAIC0xMjU3
MSw4ICsxMjU3MSw4IEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJUElQRV9DT05GX0NIRUNLX0kocGl4ZWxfbXVsdGlw
bGllcik7Cj4gPiAgIAlQSVBFX0NPTkZfQ0hFQ0tfSShvdXRwdXRfZm9ybWF0KTsKPiA+ICAgCVBJ
UEVfQ09ORl9DSEVDS19CT09MKGhhc19oZG1pX3NpbmspOwo+ID4gLQlpZiAoKElOVEVMX0dFTihk
ZXZfcHJpdikgPCA4ICYmICFJU19IQVNXRUxMKGRldl9wcml2KSkgfHwKPiA+IC0JICAgIElTX1ZB
TExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwlpZiAo
KElOVEVMX0dFTihpOTE1KSA8IDggJiYgIUlTX0hBU1dFTEwoaTkxNSkpIHx8Cj4gPiArCSAgICBJ
U19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJUElQRV9D
T05GX0NIRUNLX0JPT0wobGltaXRlZF9jb2xvcl9yYW5nZSk7Cj4gPiAgIAlQSVBFX0NPTkZfQ0hF
Q0tfQk9PTChoZG1pX3NjcmFtYmxpbmcpOwo+ID4gQEAgLTEyNTk3LDcgKzEyNTk3LDcgQEAgaW50
ZWxfcGlwZV9jb25maWdfY29tcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiAgIAlQSVBFX0NPTkZfQ0hFQ0tfWChnbWNoX3BmaXQuY29udHJvbCk7Cj4gPiAgIAkvKiBw
Zml0IHJhdGlvcyBhcmUgYXV0b2NvbXB1dGVkIGJ5IHRoZSBodyBvbiBnZW40KyAqLwo+ID4gLQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDQpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA0
KQo+ID4gICAJCVBJUEVfQ09ORl9DSEVDS19YKGdtY2hfcGZpdC5wZ21fcmF0aW9zKTsKPiA+ICAg
CVBJUEVfQ09ORl9DSEVDS19YKGdtY2hfcGZpdC5sdmRzX2JvcmRlcl9iaXRzKTsKPiA+IEBAIC0x
MjYyMSw3ICsxMjYyMSw3IEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCVBJUEVfQ09ORl9DSEVDS19DTE9DS19GVVpa
WShwaXhlbF9yYXRlKTsKPiA+ICAgCQlQSVBFX0NPTkZfQ0hFQ0tfWChnYW1tYV9tb2RlKTsKPiA+
IC0JCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+ICsJCWlmIChJU19DSEVSUllWSUVX
KGk5MTUpKQo+ID4gICAJCQlQSVBFX0NPTkZfQ0hFQ0tfWChjZ21fbW9kZSk7Cj4gPiAgIAkJZWxz
ZQo+ID4gICAJCQlQSVBFX0NPTkZfQ0hFQ0tfWChjc2NfbW9kZSk7Cj4gPiBAQCAtMTI2NjcsNyAr
MTI2NjcsNyBAQCBpbnRlbF9waXBlX2NvbmZpZ19jb21wYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICAgCVBJUEVfQ09ORl9DSEVDS19YKGRzaV9wbGwuY3RybCk7Cj4g
PiAgIAlQSVBFX0NPTkZfQ0hFQ0tfWChkc2lfcGxsLmRpdik7Cj4gPiAtCWlmIChJU19HNFgoZGV2
X3ByaXYpIHx8IElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSkKPiA+ICsJaWYgKElTX0c0WChpOTE1
KSB8fCBJTlRFTF9HRU4oaTkxNSkgPj0gNSkKPiA+ICAgCQlQSVBFX0NPTkZfQ0hFQ0tfSShwaXBl
X2JwcCk7Cj4gPiAgIAlQSVBFX0NPTkZfQ0hFQ0tfQ0xPQ0tfRlVaWlkoYmFzZS5hZGp1c3RlZF9t
b2RlLmNydGNfY2xvY2spOwo+ID4gQEAgLTEyNjk0LDExICsxMjY5NCwxMSBAQCBpbnRlbF9waXBl
X2NvbmZpZ19jb21wYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAg
CXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9waXBlX2NvbmZpZ19z
YW5pdHlfY2hlY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRp
YyB2b2lkIGludGVsX3BpcGVfY29uZmlnX3Nhbml0eV9jaGVjayhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
cGlwZV9jb25maWcpCj4gPiAgIHsKPiA+ICAgCWlmIChwaXBlX2NvbmZpZy0+aGFzX3BjaF9lbmNv
ZGVyKSB7Cj4gPiAtCQlpbnQgZmRpX2RvdGNsb2NrID0gaW50ZWxfZG90Y2xvY2tfY2FsY3VsYXRl
KGludGVsX2ZkaV9saW5rX2ZyZXEoZGV2X3ByaXYsIHBpcGVfY29uZmlnKSwKPiA+ICsJCWludCBm
ZGlfZG90Y2xvY2sgPSBpbnRlbF9kb3RjbG9ja19jYWxjdWxhdGUoaW50ZWxfZmRpX2xpbmtfZnJl
cShpOTE1LCBwaXBlX2NvbmZpZyksCj4gPiAgIAkJCQkJCQkgICAgJnBpcGVfY29uZmlnLT5mZGlf
bV9uKTsKPiA+ICAgCQlpbnQgZG90Y2xvY2sgPSBwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9t
b2RlLmNydGNfY2xvY2s7Cj4gPiBAQCAtMTI3MTUsNyArMTI3MTUsNyBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9waXBlX2NvbmZpZ19zYW5pdHlfY2hlY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICBzdGF0aWMgdm9pZCB2ZXJpZnlfd21fc3RhdGUoc3RydWN0IGRybV9jcnRj
ICpjcnRjLAo+ID4gICAJCQkgICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpuZXdfc3RhdGUpCj4g
PiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
Y3J0Yy0+ZGV2KTsKPiA+ICAgCXN0cnVjdCBza2xfaHdfc3RhdGUgewo+ID4gICAJCXN0cnVjdCBz
a2xfZGRiX2VudHJ5IGRkYl95W0k5MTVfTUFYX1BMQU5FU107Cj4gPiAgIAkJc3RydWN0IHNrbF9k
ZGJfZW50cnkgZGRiX3V2W0k5MTVfTUFYX1BMQU5FU107Cj4gPiBAQCAtMTI3MjcsOSArMTI3Mjcs
OSBAQCBzdGF0aWMgdm9pZCB2ZXJpZnlfd21fc3RhdGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+
ID4gICAJc3RydWN0IHNrbF9kZGJfZW50cnkgKmh3X2RkYl9lbnRyeSwgKnN3X2RkYl9lbnRyeTsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRj
KTsKPiA+ICAgCWNvbnN0IGVudW0gcGlwZSBwaXBlID0gaW50ZWxfY3J0Yy0+cGlwZTsKPiA+IC0J
aW50IHBsYW5lLCBsZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZlbChkZXZfcHJpdik7
Cj4gPiArCWludCBwbGFuZSwgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoaTkx
NSk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgOSB8fCAhbmV3X3N0YXRlLT5hY3Rp
dmUpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA5IHx8ICFuZXdfc3RhdGUtPmFjdGl2ZSkK
PiA+ICAgCQlyZXR1cm47Cj4gPiAgIAlodyA9IGt6YWxsb2Moc2l6ZW9mKCpodyksIEdGUF9LRVJO
RUwpOwo+ID4gQEAgLTEyNzQxLDE3ICsxMjc0MSwxNyBAQCBzdGF0aWMgdm9pZCB2ZXJpZnlfd21f
c3RhdGUoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ID4gICAJc2tsX3BpcGVfZGRiX2dldF9od19z
dGF0ZShpbnRlbF9jcnRjLCBody0+ZGRiX3ksIGh3LT5kZGJfdXYpOwo+ID4gLQlza2xfZGRiX2dl
dF9od19zdGF0ZShkZXZfcHJpdiwgJmh3LT5kZGIpOwo+ID4gLQlzd19kZGIgPSAmZGV2X3ByaXYt
PndtLnNrbF9ody5kZGI7Cj4gPiArCXNrbF9kZGJfZ2V0X2h3X3N0YXRlKGk5MTUsICZody0+ZGRi
KTsKPiA+ICsJc3dfZGRiID0gJmk5MTUtPndtLnNrbF9ody5kZGI7Cj4gPiAtCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDExICYmCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEgJiYK
PiA+ICAgCSAgICBody0+ZGRiLmVuYWJsZWRfc2xpY2VzICE9IHN3X2RkYi0+ZW5hYmxlZF9zbGlj
ZXMpCj4gPiAgIAkJRFJNX0VSUk9SKCJtaXNtYXRjaCBpbiBEQlVGIFNsaWNlcyAoZXhwZWN0ZWQg
JXUsIGdvdCAldSlcbiIsCj4gPiAgIAkJCSAgc3dfZGRiLT5lbmFibGVkX3NsaWNlcywKPiA+ICAg
CQkJICBody0+ZGRiLmVuYWJsZWRfc2xpY2VzKTsKPiA+ICAgCS8qIHBsYW5lcyAqLwo+ID4gLQlm
b3JfZWFjaF91bml2ZXJzYWxfcGxhbmUoZGV2X3ByaXYsIHBpcGUsIHBsYW5lKSB7Cj4gPiArCWZv
cl9lYWNoX3VuaXZlcnNhbF9wbGFuZShpOTE1LCBwaXBlLCBwbGFuZSkgewo+ID4gICAJCXN0cnVj
dCBza2xfcGxhbmVfd20gKmh3X3BsYW5lX3dtLCAqc3dfcGxhbmVfd207Cj4gPiAgIAkJaHdfcGxh
bmVfd20gPSAmaHctPndtLnBsYW5lc1twbGFuZV07Cj4gPiBAQCAtMTI5MzMsNyArMTI5MzMsNyBA
QCB2ZXJpZnlfY3J0Y19zdGF0ZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gPiAgIAkJICBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+ZGV2Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXI7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Yyk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsICpzd19j
b25maWc7Cj4gPiBAQCAtMTI5NDksMTAgKzEyOTQ5LDEwIEBAIHZlcmlmeV9jcnRjX3N0YXRlKHN0
cnVjdCBkcm1fY3J0YyAqY3J0YywKPiA+ICAgCURSTV9ERUJVR19LTVMoIltDUlRDOiVkOiVzXVxu
IiwgY3J0Yy0+YmFzZS5pZCwgY3J0Yy0+bmFtZSk7Cj4gPiAtCWFjdGl2ZSA9IGRldl9wcml2LT5k
aXNwbGF5LmdldF9waXBlX2NvbmZpZyhpbnRlbF9jcnRjLCBwaXBlX2NvbmZpZyk7Cj4gPiArCWFj
dGl2ZSA9IGk5MTUtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmlnKGludGVsX2NydGMsIHBpcGVfY29u
ZmlnKTsKPiA+ICAgCS8qIHdlIGtlZXAgYm90aCBwaXBlcyBlbmFibGVkIG9uIDgzMCAqLwo+ID4g
LQlpZiAoSVNfSTgzMChkZXZfcHJpdikpCj4gPiArCWlmIChJU19JODMwKGk5MTUpKQo+ID4gICAJ
CWFjdGl2ZSA9IG5ld19jcnRjX3N0YXRlLT5hY3RpdmU7Cj4gPiAgIAlJOTE1X1NUQVRFX1dBUk4o
bmV3X2NydGNfc3RhdGUtPmFjdGl2ZSAhPSBhY3RpdmUsCj4gPiBAQCAtMTI5ODQsMTAgKzEyOTg0
LDEwIEBAIHZlcmlmeV9jcnRjX3N0YXRlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKPiA+ICAgCWlm
ICghbmV3X2NydGNfc3RhdGUtPmFjdGl2ZSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWludGVsX3Bp
cGVfY29uZmlnX3Nhbml0eV9jaGVjayhkZXZfcHJpdiwgcGlwZV9jb25maWcpOwo+ID4gKwlpbnRl
bF9waXBlX2NvbmZpZ19zYW5pdHlfY2hlY2soaTkxNSwgcGlwZV9jb25maWcpOwo+ID4gICAJc3df
Y29uZmlnID0gdG9faW50ZWxfY3J0Y19zdGF0ZShuZXdfY3J0Y19zdGF0ZSk7Cj4gPiAtCWlmICgh
aW50ZWxfcGlwZV9jb25maWdfY29tcGFyZShkZXZfcHJpdiwgc3dfY29uZmlnLAo+ID4gKwlpZiAo
IWludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoaTkxNSwgc3dfY29uZmlnLAo+ID4gICAJCQkJICAg
ICAgIHBpcGVfY29uZmlnLCBmYWxzZSkpIHsKPiA+ICAgCQlJOTE1X1NUQVRFX1dBUk4oMSwgInBp
cGUgc3RhdGUgZG9lc24ndCBtYXRjaCFcbiIpOwo+ID4gICAJCWludGVsX2R1bXBfcGlwZV9jb25m
aWcocGlwZV9jb25maWcsIE5VTEwsICJbaHcgc3RhdGVdIik7Cj4gPiBAQCAtMTMwMDksNyArMTMw
MDksNyBAQCBpbnRlbF92ZXJpZnlfcGxhbmVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0
YXRlKQo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkCj4gPiAtdmVyaWZ5X3NpbmdsZV9kcGxsX3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2ZXJpZnlfc2luZ2xl
X2RwbGxfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSBzdHJ1
Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiA+ICAgCQkJIHN0cnVjdCBkcm1fY3J0YyAqY3J0
YywKPiA+ICAgCQkJIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqbmV3X3N0YXRlKQo+ID4gQEAgLTEz
MDIyLDcgKzEzMDIyLDcgQEAgdmVyaWZ5X3NpbmdsZV9kcGxsX3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCURSTV9ERUJVR19LTVMoIiVzXG4iLCBwbGwtPmlu
Zm8tPm5hbWUpOwo+ID4gLQlhY3RpdmUgPSBwbGwtPmluZm8tPmZ1bmNzLT5nZXRfaHdfc3RhdGUo
ZGV2X3ByaXYsIHBsbCwgJmRwbGxfaHdfc3RhdGUpOwo+ID4gKwlhY3RpdmUgPSBwbGwtPmluZm8t
PmZ1bmNzLT5nZXRfaHdfc3RhdGUoaTkxNSwgcGxsLCAmZHBsbF9od19zdGF0ZSk7Cj4gPiAgIAlp
ZiAoIShwbGwtPmluZm8tPmZsYWdzICYgSU5URUxfRFBMTF9BTFdBWVNfT04pKSB7Cj4gPiAgIAkJ
STkxNV9TVEFURV9XQVJOKCFwbGwtPm9uICYmIHBsbC0+YWN0aXZlX21hc2ssCj4gPiBAQCAtMTMw
NjgsMTIgKzEzMDY4LDEyIEBAIHZlcmlmeV9zaGFyZWRfZHBsbF9zdGF0ZShzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gPiAgIAkJCSBzdHJ1Y3QgZHJtX2Ny
dGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ID4gICAJCQkgc3RydWN0IGRybV9jcnRjX3N0YXRl
ICpuZXdfY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9z
dGF0ZSA9IHRvX2ludGVsX2NydGNfc3RhdGUob2xkX2NydGNfc3RhdGUpOwo+ID4gICAJc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKm5ld19zdGF0ZSA9IHRvX2ludGVsX2NydGNfc3RhdGUobmV3X2Ny
dGNfc3RhdGUpOwo+ID4gICAJaWYgKG5ld19zdGF0ZS0+c2hhcmVkX2RwbGwpCj4gPiAtCQl2ZXJp
Znlfc2luZ2xlX2RwbGxfc3RhdGUoZGV2X3ByaXYsIG5ld19zdGF0ZS0+c2hhcmVkX2RwbGwsIGNy
dGMsIG5ld19jcnRjX3N0YXRlKTsKPiA+ICsJCXZlcmlmeV9zaW5nbGVfZHBsbF9zdGF0ZShpOTE1
LCBuZXdfc3RhdGUtPnNoYXJlZF9kcGxsLCBjcnRjLCBuZXdfY3J0Y19zdGF0ZSk7Cj4gPiAgIAlp
ZiAob2xkX3N0YXRlLT5zaGFyZWRfZHBsbCAmJgo+ID4gICAJICAgIG9sZF9zdGF0ZS0+c2hhcmVk
X2RwbGwgIT0gbmV3X3N0YXRlLT5zaGFyZWRfZHBsbCkgewo+ID4gQEAgLTEzMTA4LDExICsxMzEw
OCwxMSBAQCBpbnRlbF9tb2Rlc2V0X3ZlcmlmeV9jcnRjKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywK
PiA+ICAgc3RhdGljIHZvaWQKPiA+ICAgdmVyaWZ5X2Rpc2FibGVkX2RwbGxfc3RhdGUoc3RydWN0
IGRybV9kZXZpY2UgKmRldikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJaW50IGk7Cj4gPiAtCWZvciAoaSA9IDA7IGkgPCBk
ZXZfcHJpdi0+bnVtX3NoYXJlZF9kcGxsOyBpKyspCj4gPiAtCQl2ZXJpZnlfc2luZ2xlX2RwbGxf
c3RhdGUoZGV2X3ByaXYsICZkZXZfcHJpdi0+c2hhcmVkX2RwbGxzW2ldLCBOVUxMLCBOVUxMKTsK
PiA+ICsJZm9yIChpID0gMDsgaSA8IGk5MTUtPm51bV9zaGFyZWRfZHBsbDsgaSsrKQo+ID4gKwkJ
dmVyaWZ5X3NpbmdsZV9kcGxsX3N0YXRlKGk5MTUsICZpOTE1LT5zaGFyZWRfZHBsbHNbaV0sIE5V
TEwsIE5VTEwpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkCj4gPiBAQCAtMTMxMjcsNyArMTMx
MjcsNyBAQCBpbnRlbF9tb2Rlc2V0X3ZlcmlmeV9kaXNhYmxlZChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LAo+ID4gICBzdGF0aWMgdm9pZCB1cGRhdGVfc2NhbmxpbmVfb2Zmc2V0KGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gPiAgIAkvKgo+ID4gICAJICogVGhlIHNjYW5saW5lIGNvdW50ZXIgaW5j
cmVtZW50cyBhdCB0aGUgbGVhZGluZyBlZGdlIG9mIGhzeW5jLgo+ID4gQEAgLTEzMTU2LDcgKzEz
MTU2LDcgQEAgc3RhdGljIHZvaWQgdXBkYXRlX3NjYW5saW5lX29mZnNldChjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgCSAqIEhvd2V2ZXIgaWYgcXVlcmll
ZCBqdXN0IGJlZm9yZSB0aGUgc3RhcnQgb2YgdmJsYW5rIHdlJ2xsIGdldCBhbgo+ID4gICAJICog
YW5zd2VyIHRoYXQncyBzbGlnaHRseSBpbiB0aGUgZnV0dXJlLgo+ID4gICAJICovCj4gPiAtCWlm
IChJU19HRU4oZGV2X3ByaXYsIDIpKSB7Cj4gPiArCWlmIChJU19HRU4oaTkxNSwgMikpIHsKPiA+
ICAgCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZjcnRj
X3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gPiAgIAkJaW50IHZ0b3RhbDsKPiA+IEBAIC0x
MzE2NSw3ICsxMzE2NSw3IEBAIHN0YXRpYyB2b2lkIHVwZGF0ZV9zY2FubGluZV9vZmZzZXQoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIAkJCXZ0b3RhbCAv
PSAyOwo+ID4gICAJCWNydGMtPnNjYW5saW5lX29mZnNldCA9IHZ0b3RhbCAtIDE7Cj4gPiAtCX0g
ZWxzZSBpZiAoSEFTX0RESShkZXZfcHJpdikgJiYKPiA+ICsJfSBlbHNlIGlmIChIQVNfRERJKGk5
MTUpICYmCj4gPiAgIAkJICAgaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9P
VVRQVVRfSERNSSkpIHsKPiA+ICAgCQljcnRjLT5zY2FubGluZV9vZmZzZXQgPSAyOwo+ID4gICAJ
fSBlbHNlCj4gPiBAQCAtMTMxNzQsMTIgKzEzMTc0LDEyIEBAIHN0YXRpYyB2b2lkIHVwZGF0ZV9z
Y2FubGluZV9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX21vZGVzZXRfY2xlYXJfcGxscyhzdHJ1Y3QgaW50ZWxf
YXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ID4gICAJc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLCAqbmV3X2NydGNfc3RhdGU7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiA+ICAgCWludCBpOwo+ID4gLQlpZiAoIWRl
dl9wcml2LT5kaXNwbGF5LmNydGNfY29tcHV0ZV9jbG9jaykKPiA+ICsJaWYgKCFpOTE1LT5kaXNw
bGF5LmNydGNfY29tcHV0ZV9jbG9jaykKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAlmb3JfZWFjaF9v
bGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsCj4g
PiBAQCAtMTMzMTEsNyArMTMzMTEsNyBAQCBzdGF0aWMgaW50IGludGVsX21vZGVzZXRfYWxsX3Bp
cGVzKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgc3RhdGljIGludCBpbnRl
bF9tb2Rlc2V0X2NoZWNrcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHN0YXRl
LT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShzdGF0ZS0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3N0YXRlLCAqbmV3X2NydGNfc3RhdGU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YzsKPiA+ICAgCWludCByZXQgPSAwLCBpOwo+ID4gQEAgLTEzMzIzLDEyICsxMzMyMywxMiBAQCBz
dGF0aWMgaW50IGludGVsX21vZGVzZXRfY2hlY2tzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUg
KnN0YXRlKQo+ID4gICAJLyoga2VlcCB0aGUgY3VycmVudCBzZXR0aW5nICovCj4gPiAgIAlpZiAo
IXN0YXRlLT5jZGNsay5mb3JjZV9taW5fY2RjbGtfY2hhbmdlZCkKPiA+IC0JCXN0YXRlLT5jZGNs
ay5mb3JjZV9taW5fY2RjbGsgPSBkZXZfcHJpdi0+Y2RjbGsuZm9yY2VfbWluX2NkY2xrOwo+ID4g
KwkJc3RhdGUtPmNkY2xrLmZvcmNlX21pbl9jZGNsayA9IGk5MTUtPmNkY2xrLmZvcmNlX21pbl9j
ZGNsazsKPiA+ICAgCXN0YXRlLT5tb2Rlc2V0ID0gdHJ1ZTsKPiA+IC0Jc3RhdGUtPmFjdGl2ZV9j
cnRjcyA9IGRldl9wcml2LT5hY3RpdmVfY3J0Y3M7Cj4gPiAtCXN0YXRlLT5jZGNsay5sb2dpY2Fs
ID0gZGV2X3ByaXYtPmNkY2xrLmxvZ2ljYWw7Cj4gPiAtCXN0YXRlLT5jZGNsay5hY3R1YWwgPSBk
ZXZfcHJpdi0+Y2RjbGsuYWN0dWFsOwo+ID4gKwlzdGF0ZS0+YWN0aXZlX2NydGNzID0gaTkxNS0+
YWN0aXZlX2NydGNzOwo+ID4gKwlzdGF0ZS0+Y2RjbGsubG9naWNhbCA9IGk5MTUtPmNkY2xrLmxv
Z2ljYWw7Cj4gPiArCXN0YXRlLT5jZGNsay5hY3R1YWwgPSBpOTE1LT5jZGNsay5hY3R1YWw7Cj4g
PiAgIAlzdGF0ZS0+Y2RjbGsucGlwZSA9IElOVkFMSURfUElQRTsKPiA+ICAgCWZvcl9lYWNoX29s
ZG5ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBvbGRfY3J0Y19zdGF0ZSwKPiA+
IEBAIC0xMzM0OSwxOSArMTMzNDksMTkgQEAgc3RhdGljIGludCBpbnRlbF9tb2Rlc2V0X2NoZWNr
cyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgCSAqIG1vZGUgc2V0IG9u
IHRoaXMgY3J0Yy4gIEZvciBvdGhlciBjcnRjcyB3ZSBuZWVkIHRvIHVzZSB0aGUKPiA+ICAgCSAq
IGFkanVzdGVkX21vZGUgYml0cyBpbiB0aGUgY3J0YyBkaXJlY3RseS4KPiA+ICAgCSAqLwo+ID4g
LQlpZiAoZGV2X3ByaXYtPmRpc3BsYXkubW9kZXNldF9jYWxjX2NkY2xrKSB7Cj4gPiArCWlmIChp
OTE1LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19jZGNsaykgewo+ID4gICAJCWVudW0gcGlwZSBwaXBl
Owo+ID4gLQkJcmV0ID0gZGV2X3ByaXYtPmRpc3BsYXkubW9kZXNldF9jYWxjX2NkY2xrKHN0YXRl
KTsKPiA+ICsJCXJldCA9IGk5MTUtPmRpc3BsYXkubW9kZXNldF9jYWxjX2NkY2xrKHN0YXRlKTsK
PiA+ICAgCQlpZiAocmV0IDwgMCkKPiA+ICAgCQkJcmV0dXJuIHJldDsKPiA+ICAgCQkvKgo+ID4g
LQkJICogV3JpdGVzIHRvIGRldl9wcml2LT5jZGNsay5sb2dpY2FsIG11c3QgcHJvdGVjdGVkIGJ5
Cj4gPiArCQkgKiBXcml0ZXMgdG8gaTkxNS0+Y2RjbGsubG9naWNhbCBtdXN0IHByb3RlY3RlZCBi
eQo+ID4gICAJCSAqIGhvbGRpbmcgYWxsIHRoZSBjcnRjIGxvY2tzLCBldmVuIGlmIHdlIGRvbid0
IGVuZCB1cAo+ID4gICAJCSAqIHRvdWNoaW5nIHRoZSBoYXJkd2FyZQo+ID4gICAJCSAqLwo+ID4g
LQkJaWYgKGludGVsX2NkY2xrX2NoYW5nZWQoJmRldl9wcml2LT5jZGNsay5sb2dpY2FsLAo+ID4g
KwkJaWYgKGludGVsX2NkY2xrX2NoYW5nZWQoJmk5MTUtPmNkY2xrLmxvZ2ljYWwsCj4gPiAgIAkJ
CQkJJnN0YXRlLT5jZGNsay5sb2dpY2FsKSkgewo+ID4gICAJCQlyZXQgPSBpbnRlbF9sb2NrX2Fs
bF9waXBlcygmc3RhdGUtPmJhc2UpOwo+ID4gICAJCQlpZiAocmV0IDwgMCkKPiA+IEBAIC0xMzM3
Myw3ICsxMzM3Myw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfbW9kZXNldF9jaGVja3Moc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIAkJCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZTsKPiA+ICAgCQkJcGlwZSA9IGlsb2cyKHN0YXRlLT5hY3RpdmVfY3J0Y3MpOwo+
ID4gLQkJCWNydGMgPSAmaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpLT5i
YXNlOwo+ID4gKwkJCWNydGMgPSAmaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoaTkxNSwgcGlwZSkt
PmJhc2U7Cj4gPiAgIAkJCWNydGNfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0
ZSgmc3RhdGUtPmJhc2UsIGNydGMpOwo+ID4gICAJCQlpZiAoY3J0Y19zdGF0ZSAmJiBuZWVkc19t
b2Rlc2V0KGNydGNfc3RhdGUpKQo+ID4gICAJCQkJcGlwZSA9IElOVkFMSURfUElQRTsKPiA+IEBA
IC0xMzM4MywxNSArMTMzODMsMTUgQEAgc3RhdGljIGludCBpbnRlbF9tb2Rlc2V0X2NoZWNrcyhz
dHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgCQkvKiBBbGwgcGlwZXMgbXVz
dCBiZSBzd2l0Y2hlZCBvZmYgd2hpbGUgd2UgY2hhbmdlIHRoZSBjZGNsay4gKi8KPiA+ICAgCQlp
ZiAocGlwZSAhPSBJTlZBTElEX1BJUEUgJiYKPiA+IC0JCSAgICBpbnRlbF9jZGNsa19uZWVkc19j
ZDJ4X3VwZGF0ZShkZXZfcHJpdiwKPiA+IC0JCQkJCQkgICZkZXZfcHJpdi0+Y2RjbGsuYWN0dWFs
LAo+ID4gKwkJICAgIGludGVsX2NkY2xrX25lZWRzX2NkMnhfdXBkYXRlKGk5MTUsCj4gPiArCQkJ
CQkJICAmaTkxNS0+Y2RjbGsuYWN0dWFsLAo+ID4gICAJCQkJCQkgICZzdGF0ZS0+Y2RjbGsuYWN0
dWFsKSkgewo+ID4gICAJCQlyZXQgPSBpbnRlbF9sb2NrX2FsbF9waXBlcygmc3RhdGUtPmJhc2Up
Owo+ID4gICAJCQlpZiAocmV0IDwgMCkKPiA+ICAgCQkJCXJldHVybiByZXQ7Cj4gPiAgIAkJCXN0
YXRlLT5jZGNsay5waXBlID0gcGlwZTsKPiA+IC0JCX0gZWxzZSBpZiAoaW50ZWxfY2RjbGtfbmVl
ZHNfbW9kZXNldCgmZGV2X3ByaXYtPmNkY2xrLmFjdHVhbCwKPiA+ICsJCX0gZWxzZSBpZiAoaW50
ZWxfY2RjbGtfbmVlZHNfbW9kZXNldCgmaTkxNS0+Y2RjbGsuYWN0dWFsLAo+ID4gICAJCQkJCQkg
ICAgICZzdGF0ZS0+Y2RjbGsuYWN0dWFsKSkgewo+ID4gICAJCQlyZXQgPSBpbnRlbF9tb2Rlc2V0
X2FsbF9waXBlcygmc3RhdGUtPmJhc2UpOwo+ID4gICAJCQlpZiAocmV0IDwgMCkKPiA+IEBAIC0x
MzQxMCw3ICsxMzQxMCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfbW9kZXNldF9jaGVja3Moc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIAlpbnRlbF9tb2Rlc2V0X2NsZWFyX3Bs
bHMoc3RhdGUpOwo+ID4gLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikpCj4gPiArCWlmIChJU19I
QVNXRUxMKGk5MTUpKQo+ID4gICAJCXJldHVybiBoYXN3ZWxsX21vZGVfc2V0X3BsYW5lc193b3Jr
YXJvdW5kKHN0YXRlKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gQEAgLTEzNDI0LDExICsxMzQyNCwx
MSBAQCBzdGF0aWMgaW50IGludGVsX21vZGVzZXRfY2hlY2tzKHN0cnVjdCBpbnRlbF9hdG9taWNf
c3RhdGUgKnN0YXRlKQo+ID4gICBzdGF0aWMgaW50IGNhbGNfd2F0ZXJtYXJrX2RhdGEoc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSBzdGF0ZS0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAkvKiBJcyB0aGVyZSBwbGF0Zm9ybS1zcGVjaWZp
YyB3YXRlcm1hcmsgaW5mb3JtYXRpb24gdG8gY2FsY3VsYXRlPyAqLwo+ID4gLQlpZiAoZGV2X3By
aXYtPmRpc3BsYXkuY29tcHV0ZV9nbG9iYWxfd2F0ZXJtYXJrcykKPiA+IC0JCXJldHVybiBkZXZf
cHJpdi0+ZGlzcGxheS5jb21wdXRlX2dsb2JhbF93YXRlcm1hcmtzKHN0YXRlKTsKPiA+ICsJaWYg
KGk5MTUtPmRpc3BsYXkuY29tcHV0ZV9nbG9iYWxfd2F0ZXJtYXJrcykKPiA+ICsJCXJldHVybiBp
OTE1LT5kaXNwbGF5LmNvbXB1dGVfZ2xvYmFsX3dhdGVybWFya3Moc3RhdGUpOwo+ID4gICAJcmV0
dXJuIDA7Cj4gPiAgIH0KPiA+IEBAIC0xMzQ0MSw3ICsxMzQ0MSw3IEBAIHN0YXRpYyBpbnQgY2Fs
Y193YXRlcm1hcmtfZGF0YShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAg
c3RhdGljIGludCBpbnRlbF9hdG9taWNfY2hlY2soc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiA+
ICAgCQkJICAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKl9zdGF0ZSkKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3Ry
dWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUgPSB0b19pbnRlbF9hdG9taWNfc3RhdGUoX3N0
YXRlKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwgKm5l
d19jcnRjX3N0YXRlOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gPiBAQCAtMTM0
NzQsNyArMTM0NzQsNyBAQCBzdGF0aWMgaW50IGludGVsX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LAo+ID4gICAJCWlmIChyZXQpCj4gPiAgIAkJCWdvdG8gZmFpbDsKPiA+IC0J
CWlmIChpbnRlbF9waXBlX2NvbmZpZ19jb21wYXJlKGRldl9wcml2LCBvbGRfY3J0Y19zdGF0ZSwK
PiA+ICsJCWlmIChpbnRlbF9waXBlX2NvbmZpZ19jb21wYXJlKGk5MTUsIG9sZF9jcnRjX3N0YXRl
LAo+ID4gICAJCQkJCSAgICAgIG5ld19jcnRjX3N0YXRlLCB0cnVlKSkgewo+ID4gICAJCQluZXdf
Y3J0Y19zdGF0ZS0+YmFzZS5tb2RlX2NoYW5nZWQgPSBmYWxzZTsKPiA+ICAgCQkJbmV3X2NydGNf
c3RhdGUtPnVwZGF0ZV9waXBlID0gdHJ1ZTsKPiA+IEBAIC0xMzQ5Myw3ICsxMzQ5Myw3IEBAIHN0
YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAg
IAkJaWYgKHJldCkKPiA+ICAgCQkJZ290byBmYWlsOwo+ID4gICAJfSBlbHNlIHsKPiA+IC0JCXN0
YXRlLT5jZGNsay5sb2dpY2FsID0gZGV2X3ByaXYtPmNkY2xrLmxvZ2ljYWw7Cj4gPiArCQlzdGF0
ZS0+Y2RjbGsubG9naWNhbCA9IGk5MTUtPmNkY2xrLmxvZ2ljYWw7Cj4gPiAgIAl9Cj4gPiAgIAly
ZXQgPSBpY2xfYWRkX2xpbmtlZF9wbGFuZXMoc3RhdGUpOwo+ID4gQEAgLTEzNTA0LDcgKzEzNTA0
LDcgQEAgc3RhdGljIGludCBpbnRlbF9hdG9taWNfY2hlY2soc3RydWN0IGRybV9kZXZpY2UgKmRl
diwKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJZ290byBmYWlsOwo+ID4gLQlpbnRlbF9mYmNfY2hv
b3NlX2NydGMoZGV2X3ByaXYsIHN0YXRlKTsKPiA+ICsJaW50ZWxfZmJjX2Nob29zZV9jcnRjKGk5
MTUsIHN0YXRlKTsKPiA+ICAgCXJldCA9IGNhbGNfd2F0ZXJtYXJrX2RhdGEoc3RhdGUpOwo+ID4g
ICAJaWYgKHJldCkKPiA+ICAgCQlnb3RvIGZhaWw7Cj4gPiBAQCAtMTM1NjQsNyArMTM1NjQsNyBA
QCBzdGF0aWMgdm9pZCBpbnRlbF91cGRhdGVfY3J0YyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4g
PiAgIAkJCSAgICAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCj4gPiAg
IHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5kZXY7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcgPSB0b19pbnRlbF9jcnRjX3N0YXRlKG5ld19j
cnRjX3N0YXRlKTsKPiA+ICAgCWJvb2wgbW9kZXNldCA9IG5lZWRzX21vZGVzZXQobmV3X2NydGNf
c3RhdGUpOwo+ID4gQEAgLTEzNTc0LDcgKzEzNTc0LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfdXBk
YXRlX2NydGMoc3RydWN0IGRybV9jcnRjICpjcnRjLAo+ID4gICAJaWYgKG1vZGVzZXQpIHsKPiA+
ICAgCQl1cGRhdGVfc2NhbmxpbmVfb2Zmc2V0KHBpcGVfY29uZmlnKTsKPiA+IC0JCWRldl9wcml2
LT5kaXNwbGF5LmNydGNfZW5hYmxlKHBpcGVfY29uZmlnLCBzdGF0ZSk7Cj4gPiArCQlpOTE1LT5k
aXNwbGF5LmNydGNfZW5hYmxlKHBpcGVfY29uZmlnLCBzdGF0ZSk7Cj4gPiAgIAkJLyogdmJsYW5r
cyB3b3JrIGFnYWluLCByZS1lbmFibGUgcGlwZSBDUkMuICovCj4gPiAgIAkJaW50ZWxfY3J0Y19l
bmFibGVfcGlwZV9jcmMoaW50ZWxfY3J0Yyk7Cj4gPiBAQCAtMTM1OTMsNyArMTM1OTMsNyBAQCBz
dGF0aWMgdm9pZCBpbnRlbF91cGRhdGVfY3J0YyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gPiAg
IAlpbnRlbF9iZWdpbl9jcnRjX2NvbW1pdCh0b19pbnRlbF9hdG9taWNfc3RhdGUoc3RhdGUpLCBp
bnRlbF9jcnRjKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiA+ICsJaWYg
KElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gICAJCXNrbF91cGRhdGVfcGxhbmVzX29uX2NydGMo
dG9faW50ZWxfYXRvbWljX3N0YXRlKHN0YXRlKSwgaW50ZWxfY3J0Yyk7Cj4gPiAgIAllbHNlCj4g
PiAgIAkJaTl4eF91cGRhdGVfcGxhbmVzX29uX2NydGModG9faW50ZWxfYXRvbWljX3N0YXRlKHN0
YXRlKSwgaW50ZWxfY3J0Yyk7Cj4gPiBAQCAtMTM2MTgsNyArMTM2MTgsNyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF91cGRhdGVfY3J0Y3Moc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4g
ICBzdGF0aWMgdm9pZCBza2xfdXBkYXRlX2NydGNzKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpz
dGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KHN0YXRlLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoc3RhdGUtPmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpp
bnRlbF9zdGF0ZSA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShzdGF0ZSk7Cj4gPiAgIAlzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGM7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YzsKPiA+
IEBAIC0xMzYyOCw3ICsxMzYyOCw3IEBAIHN0YXRpYyB2b2lkIHNrbF91cGRhdGVfY3J0Y3Moc3Ry
dWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICAJYm9vbCBwcm9ncmVzczsKPiA+ICAg
CWVudW0gcGlwZSBwaXBlOwo+ID4gICAJaW50IGk7Cj4gPiAtCXU4IGh3X2VuYWJsZWRfc2xpY2Vz
ID0gZGV2X3ByaXYtPndtLnNrbF9ody5kZGIuZW5hYmxlZF9zbGljZXM7Cj4gPiArCXU4IGh3X2Vu
YWJsZWRfc2xpY2VzID0gaTkxNS0+d20uc2tsX2h3LmRkYi5lbmFibGVkX3NsaWNlczsKPiA+ICAg
CXU4IHJlcXVpcmVkX3NsaWNlcyA9IGludGVsX3N0YXRlLT53bV9yZXN1bHRzLmRkYi5lbmFibGVk
X3NsaWNlczsKPiA+ICAgCXN0cnVjdCBza2xfZGRiX2VudHJ5IGVudHJpZXNbSTkxNV9NQVhfUElQ
RVNdID0ge307Cj4gPiBAQCAtMTM2MzgsOCArMTM2MzgsOCBAQCBzdGF0aWMgdm9pZCBza2xfdXBk
YXRlX2NydGNzKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgCQkJZW50cmll
c1tpXSA9IHRvX2ludGVsX2NydGNfc3RhdGUob2xkX2NydGNfc3RhdGUpLT53bS5za2wuZGRiOwo+
ID4gICAJLyogSWYgMm5kIERCdWYgc2xpY2UgcmVxdWlyZWQsIGVuYWJsZSBpdCBoZXJlICovCj4g
PiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExICYmIHJlcXVpcmVkX3NsaWNlcyA+IGh3
X2VuYWJsZWRfc2xpY2VzKQo+ID4gLQkJaWNsX2RidWZfc2xpY2VzX3VwZGF0ZShkZXZfcHJpdiwg
cmVxdWlyZWRfc2xpY2VzKTsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSAmJiByZXF1
aXJlZF9zbGljZXMgPiBod19lbmFibGVkX3NsaWNlcykKPiA+ICsJCWljbF9kYnVmX3NsaWNlc191
cGRhdGUoaTkxNSwgcmVxdWlyZWRfc2xpY2VzKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBXaGVuZXZl
ciB0aGUgbnVtYmVyIG9mIGFjdGl2ZSBwaXBlcyBjaGFuZ2VzLCB3ZSBuZWVkIHRvIG1ha2Ugc3Vy
ZSB3ZQo+ID4gQEAgLTEzNjYzLDcgKzEzNjYzLDcgQEAgc3RhdGljIHZvaWQgc2tsX3VwZGF0ZV9j
cnRjcyhzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIAkJCWlmIChza2xfZGRi
X2FsbG9jYXRpb25fb3ZlcmxhcHMoJmNzdGF0ZS0+d20uc2tsLmRkYiwKPiA+ICAgCQkJCQkJCWVu
dHJpZXMsCj4gPiAtCQkJCQkJCUlOVEVMX0lORk8oZGV2X3ByaXYpLT5udW1fcGlwZXMsIGkpKQo+
ID4gKwkJCQkJCQlJTlRFTF9JTkZPKGk5MTUpLT5udW1fcGlwZXMsIGkpKQo+ID4gICAJCQkJY29u
dGludWU7Cj4gPiAgIAkJCXVwZGF0ZWQgfD0gY21hc2s7Cj4gPiBAQCAtMTM2ODUsNTcgKzEzNjg1
LDU3IEBAIHN0YXRpYyB2b2lkIHNrbF91cGRhdGVfY3J0Y3Moc3RydWN0IGRybV9hdG9taWNfc3Rh
dGUgKnN0YXRlKQo+ID4gICAJCQkJCSAgbmV3X2NydGNfc3RhdGUpOwo+ID4gICAJCQlpZiAodmJs
X3dhaXQpCj4gPiAtCQkJCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgcGlwZSk7Cj4g
PiArCQkJCWludGVsX3dhaXRfZm9yX3ZibGFuayhpOTE1LCBwaXBlKTsKPiA+ICAgCQkJcHJvZ3Jl
c3MgPSB0cnVlOwo+ID4gICAJCX0KPiA+ICAgCX0gd2hpbGUgKHByb2dyZXNzKTsKPiA+ICAgCS8q
IElmIDJuZCBEQnVmIHNsaWNlIGlzIG5vIG1vcmUgcmVxdWlyZWQgZGlzYWJsZSBpdCAqLwo+ID4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSAmJiByZXF1aXJlZF9zbGljZXMgPCBod19l
bmFibGVkX3NsaWNlcykKPiA+IC0JCWljbF9kYnVmX3NsaWNlc191cGRhdGUoZGV2X3ByaXYsIHJl
cXVpcmVkX3NsaWNlcyk7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEgJiYgcmVxdWly
ZWRfc2xpY2VzIDwgaHdfZW5hYmxlZF9zbGljZXMpCj4gPiArCQlpY2xfZGJ1Zl9zbGljZXNfdXBk
YXRlKGk5MTUsIHJlcXVpcmVkX3NsaWNlcyk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRl
bF9hdG9taWNfaGVscGVyX2ZyZWVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gK3N0YXRpYyB2b2lkIGludGVsX2F0b21pY19oZWxwZXJfZnJlZV9zdGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2F0
b21pY19zdGF0ZSAqc3RhdGUsICpuZXh0Owo+ID4gICAJc3RydWN0IGxsaXN0X25vZGUgKmZyZWVk
Owo+ID4gLQlmcmVlZCA9IGxsaXN0X2RlbF9hbGwoJmRldl9wcml2LT5hdG9taWNfaGVscGVyLmZy
ZWVfbGlzdCk7Cj4gPiArCWZyZWVkID0gbGxpc3RfZGVsX2FsbCgmaTkxNS0+YXRvbWljX2hlbHBl
ci5mcmVlX2xpc3QpOwo+ID4gICAJbGxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShzdGF0ZSwgbmV4
dCwgZnJlZWQsIGZyZWVkKQo+ID4gICAJCWRybV9hdG9taWNfc3RhdGVfcHV0KCZzdGF0ZS0+YmFz
ZSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2hlbHBlcl9mcmVlX3N0
YXRlX3dvcmtlcihzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiA+IC0JCWNvbnRhaW5lcl9vZih3b3JrLCB0
eXBlb2YoKmRldl9wcml2KSwgYXRvbWljX2hlbHBlci5mcmVlX3dvcmspOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gPiArCQljb250YWluZXJfb2Yod29yaywgdHlwZW9m
KCppOTE1KSwgYXRvbWljX2hlbHBlci5mcmVlX3dvcmspOwo+ID4gLQlpbnRlbF9hdG9taWNfaGVs
cGVyX2ZyZWVfc3RhdGUoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9hdG9taWNfaGVscGVyX2ZyZWVf
c3RhdGUoaTkxNSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1p
dF9mZW5jZV93YWl0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0YXRlKQo+ID4g
ICB7Cj4gPiAgIAlzdHJ1Y3Qgd2FpdF9xdWV1ZV9lbnRyeSB3YWl0X2ZlbmNlLCB3YWl0X3Jlc2V0
Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVs
X3N0YXRlLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShpbnRlbF9zdGF0ZS0+YmFzZS5kZXYpOwo+ID4gICAJaW5pdF93YWl0X2VudHJ5KCZ3
YWl0X2ZlbmNlLCAwKTsKPiA+ICAgCWluaXRfd2FpdF9lbnRyeSgmd2FpdF9yZXNldCwgMCk7Cj4g
PiAgIAlmb3IgKDs7KSB7Cj4gPiAgIAkJcHJlcGFyZV90b193YWl0KCZpbnRlbF9zdGF0ZS0+Y29t
bWl0X3JlYWR5LndhaXQsCj4gPiAgIAkJCQkmd2FpdF9mZW5jZSwgVEFTS19VTklOVEVSUlVQVElC
TEUpOwo+ID4gLQkJcHJlcGFyZV90b193YWl0KCZkZXZfcHJpdi0+Z3B1X2Vycm9yLndhaXRfcXVl
dWUsCj4gPiArCQlwcmVwYXJlX3RvX3dhaXQoJmk5MTUtPmdwdV9lcnJvci53YWl0X3F1ZXVlLAo+
ID4gICAJCQkJJndhaXRfcmVzZXQsIFRBU0tfVU5JTlRFUlJVUFRJQkxFKTsKPiA+ICAgCQlpZiAo
aTkxNV9zd19mZW5jZV9kb25lKCZpbnRlbF9zdGF0ZS0+Y29tbWl0X3JlYWR5KQo+ID4gLQkJICAg
IHx8IHRlc3RfYml0KEk5MTVfUkVTRVRfTU9ERVNFVCwgJmRldl9wcml2LT5ncHVfZXJyb3IuZmxh
Z3MpKQo+ID4gKwkJICAgIHx8IHRlc3RfYml0KEk5MTVfUkVTRVRfTU9ERVNFVCwgJmk5MTUtPmdw
dV9lcnJvci5mbGFncykpCj4gPiAgIAkJCWJyZWFrOwo+ID4gICAJCXNjaGVkdWxlKCk7Cj4gPiAg
IAl9Cj4gPiAgIAlmaW5pc2hfd2FpdCgmaW50ZWxfc3RhdGUtPmNvbW1pdF9yZWFkeS53YWl0LCAm
d2FpdF9mZW5jZSk7Cj4gPiAtCWZpbmlzaF93YWl0KCZkZXZfcHJpdi0+Z3B1X2Vycm9yLndhaXRf
cXVldWUsICZ3YWl0X3Jlc2V0KTsKPiA+ICsJZmluaXNoX3dhaXQoJmk5MTUtPmdwdV9lcnJvci53
YWl0X3F1ZXVlLCAmd2FpdF9yZXNldCk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxf
YXRvbWljX2NsZWFudXBfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiBAQCAtMTM3
NTUsNyArMTM3NTUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9hdG9taWNfY29tbWl0X3RhaWwoc3Ry
dWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gc3RhdGUtPmRldjsKPiA+ICAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUg
KmludGVsX3N0YXRlID0gdG9faW50ZWxfYXRvbWljX3N0YXRlKHN0YXRlKTsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBkcm1f
Y3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsICpuZXdfY3J0Y19zdGF0ZTsKPiA+ICAgCXN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfaW50ZWxfY3J0Y19zdGF0ZSwgKm9sZF9pbnRlbF9jcnRj
X3N0YXRlOwo+ID4gICAJc3RydWN0IGRybV9jcnRjICpjcnRjOwo+ID4gQEAgLTEzNzY5LDcgKzEz
NzY5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1pdF90YWlsKHN0cnVjdCBkcm1f
YXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgCWRybV9hdG9taWNfaGVscGVyX3dhaXRfZm9yX2Rl
cGVuZGVuY2llcyhzdGF0ZSk7Cj4gPiAgIAlpZiAoaW50ZWxfc3RhdGUtPm1vZGVzZXQpCj4gPiAt
CQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJ
Tl9NT0RFU0VUKTsKPiA+ICsJCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1
LCBQT1dFUl9ET01BSU5fTU9ERVNFVCk7Cj4gPiAgIAlmb3JfZWFjaF9vbGRuZXdfY3J0Y19pbl9z
dGF0ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsIG5ld19jcnRjX3N0YXRlLCBpKSB7Cj4g
PiAgIAkJb2xkX2ludGVsX2NydGNfc3RhdGUgPSB0b19pbnRlbF9jcnRjX3N0YXRlKG9sZF9jcnRj
X3N0YXRlKTsKPiA+IEBAIC0xMzc5OCw3ICsxMzc5OCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0
b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIAkJ
CSAqLwo+ID4gICAJCQlpbnRlbF9jcnRjX2Rpc2FibGVfcGlwZV9jcmMoaW50ZWxfY3J0Yyk7Cj4g
PiAtCQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19kaXNhYmxlKG9sZF9pbnRlbF9jcnRjX3N0YXRl
LCBzdGF0ZSk7Cj4gPiArCQkJaTkxNS0+ZGlzcGxheS5jcnRjX2Rpc2FibGUob2xkX2ludGVsX2Ny
dGNfc3RhdGUsIHN0YXRlKTsKPiA+ICAgCQkJaW50ZWxfY3J0Yy0+YWN0aXZlID0gZmFsc2U7Cj4g
PiAgIAkJCWludGVsX2ZiY19kaXNhYmxlKGludGVsX2NydGMpOwo+ID4gICAJCQlpbnRlbF9kaXNh
YmxlX3NoYXJlZF9kcGxsKG9sZF9pbnRlbF9jcnRjX3N0YXRlKTsKPiA+IEBAIC0xMzgwNywxNCAr
MTM4MDcsMTQgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1pdF90YWlsKHN0cnVjdCBk
cm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgCQkJICogVW5kZXJydW5zIGRvbid0IGFsd2F5
cyByYWlzZQo+ID4gICAJCQkgKiBpbnRlcnJ1cHRzLCBzbyBjaGVjayBtYW51YWxseS4KPiA+ICAg
CQkJICovCj4gPiAtCQkJaW50ZWxfY2hlY2tfY3B1X2ZpZm9fdW5kZXJydW5zKGRldl9wcml2KTsK
PiA+IC0JCQlpbnRlbF9jaGVja19wY2hfZmlmb191bmRlcnJ1bnMoZGV2X3ByaXYpOwo+ID4gKwkJ
CWludGVsX2NoZWNrX2NwdV9maWZvX3VuZGVycnVucyhpOTE1KTsKPiA+ICsJCQlpbnRlbF9jaGVj
a19wY2hfZmlmb191bmRlcnJ1bnMoaTkxNSk7Cj4gPiAgIAkJCS8qIEZJWE1FIHVuaWZ5IHRoaXMg
Zm9yIGFsbCBwbGF0Zm9ybXMgKi8KPiA+ICAgCQkJaWYgKCFuZXdfY3J0Y19zdGF0ZS0+YWN0aXZl
ICYmCj4gPiAtCQkJICAgICFIQVNfR01DSChkZXZfcHJpdikgJiYKPiA+IC0JCQkgICAgZGV2X3By
aXYtPmRpc3BsYXkuaW5pdGlhbF93YXRlcm1hcmtzKQo+ID4gLQkJCQlkZXZfcHJpdi0+ZGlzcGxh
eS5pbml0aWFsX3dhdGVybWFya3MoaW50ZWxfc3RhdGUsCj4gPiArCQkJICAgICFIQVNfR01DSChp
OTE1KSAmJgo+ID4gKwkJCSAgICBpOTE1LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJrcykKPiA+
ICsJCQkJaTkxNS0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3MoaW50ZWxfc3RhdGUsCj4gPiAg
IAkJCQkJCQkJICAgICBuZXdfaW50ZWxfY3J0Y19zdGF0ZSk7Cj4gPiAgIAkJfQo+ID4gICAJfQo+
ID4gQEAgLTEzODI2LDkgKzEzODI2LDkgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1p
dF90YWlsKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgCWlmIChpbnRlbF9z
dGF0ZS0+bW9kZXNldCkgewo+ID4gICAJCWRybV9hdG9taWNfaGVscGVyX3VwZGF0ZV9sZWdhY3lf
bW9kZXNldF9zdGF0ZShzdGF0ZS0+ZGV2LCBzdGF0ZSk7Cj4gPiAtCQlpbnRlbF9zZXRfY2RjbGtf
cHJlX3BsYW5lX3VwZGF0ZShkZXZfcHJpdiwKPiA+ICsJCWludGVsX3NldF9jZGNsa19wcmVfcGxh
bmVfdXBkYXRlKGk5MTUsCj4gPiAgIAkJCQkJCSAmaW50ZWxfc3RhdGUtPmNkY2xrLmFjdHVhbCwK
PiA+IC0JCQkJCQkgJmRldl9wcml2LT5jZGNsay5hY3R1YWwsCj4gPiArCQkJCQkJICZpOTE1LT5j
ZGNsay5hY3R1YWwsCj4gPiAgIAkJCQkJCSBpbnRlbF9zdGF0ZS0+Y2RjbGsucGlwZSk7Cj4gPiAg
IAkJLyoKPiA+IEBAIC0xMzgzNiw3ICsxMzgzNiw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21p
Y19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIAkJICog
aGF2ZSBtb3JlIHRoZW4gb25lIHBpcGUgZW5hYmxlZAo+ID4gICAJCSAqLwo+ID4gICAJCWlmICgh
aW50ZWxfY2FuX2VuYWJsZV9zYWd2KHN0YXRlKSkKPiA+IC0JCQlpbnRlbF9kaXNhYmxlX3NhZ3Yo
ZGV2X3ByaXYpOwo+ID4gKwkJCWludGVsX2Rpc2FibGVfc2FndihpOTE1KTsKPiA+ICAgCQlpbnRl
bF9tb2Rlc2V0X3ZlcmlmeV9kaXNhYmxlZChkZXYsIHN0YXRlKTsKPiA+ICAgCX0KPiA+IEBAIC0x
Mzg1NiwxMiArMTM4NTYsMTIgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1pdF90YWls
KHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgCX0KPiA+ICAgCS8qIE5vdyBl
bmFibGUgdGhlIGNsb2NrcywgcGxhbmUsIHBpcGUsIGFuZCBjb25uZWN0b3JzIHRoYXQgd2Ugc2V0
IHVwLiAqLwo+ID4gLQlkZXZfcHJpdi0+ZGlzcGxheS51cGRhdGVfY3J0Y3Moc3RhdGUpOwo+ID4g
KwlpOTE1LT5kaXNwbGF5LnVwZGF0ZV9jcnRjcyhzdGF0ZSk7Cj4gPiAgIAlpZiAoaW50ZWxfc3Rh
dGUtPm1vZGVzZXQpCj4gPiAtCQlpbnRlbF9zZXRfY2RjbGtfcG9zdF9wbGFuZV91cGRhdGUoZGV2
X3ByaXYsCj4gPiArCQlpbnRlbF9zZXRfY2RjbGtfcG9zdF9wbGFuZV91cGRhdGUoaTkxNSwKPiA+
ICAgCQkJCQkJICAmaW50ZWxfc3RhdGUtPmNkY2xrLmFjdHVhbCwKPiA+IC0JCQkJCQkgICZkZXZf
cHJpdi0+Y2RjbGsuYWN0dWFsLAo+ID4gKwkJCQkJCSAgJmk5MTUtPmNkY2xrLmFjdHVhbCwKPiA+
ICAgCQkJCQkJICBpbnRlbF9zdGF0ZS0+Y2RjbGsucGlwZSk7Cj4gPiAgIAkvKiBGSVhNRTogV2Ug
c2hvdWxkIGNhbGwgZHJtX2F0b21pY19oZWxwZXJfY29tbWl0X2h3X2RvbmUoKSBoZXJlCj4gPiBA
QCAtMTM4OTUsOCArMTM4OTUsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9hdG9taWNfY29tbWl0X3Rh
aWwoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICAJZm9yX2VhY2hfbmV3X2Ny
dGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG5ld19jcnRjX3N0YXRlLCBpKSB7Cj4gPiAgIAkJbmV3
X2ludGVsX2NydGNfc3RhdGUgPSB0b19pbnRlbF9jcnRjX3N0YXRlKG5ld19jcnRjX3N0YXRlKTsK
PiA+IC0JCWlmIChkZXZfcHJpdi0+ZGlzcGxheS5vcHRpbWl6ZV93YXRlcm1hcmtzKQo+ID4gLQkJ
CWRldl9wcml2LT5kaXNwbGF5Lm9wdGltaXplX3dhdGVybWFya3MoaW50ZWxfc3RhdGUsCj4gPiAr
CQlpZiAoaTkxNS0+ZGlzcGxheS5vcHRpbWl6ZV93YXRlcm1hcmtzKQo+ID4gKwkJCWk5MTUtPmRp
c3BsYXkub3B0aW1pemVfd2F0ZXJtYXJrcyhpbnRlbF9zdGF0ZSwKPiA+ICAgCQkJCQkJCSAgICAg
IG5ld19pbnRlbF9jcnRjX3N0YXRlKTsKPiA+ICAgCX0KPiA+IEBAIC0xMzkwNCw3ICsxMzkwNCw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0b21p
Y19zdGF0ZSAqc3RhdGUpCj4gPiAgIAkJaW50ZWxfcG9zdF9wbGFuZV91cGRhdGUodG9faW50ZWxf
Y3J0Y19zdGF0ZShvbGRfY3J0Y19zdGF0ZSkpOwo+ID4gICAJCWlmIChwdXRfZG9tYWluc1tpXSkK
PiA+IC0JCQltb2Rlc2V0X3B1dF9wb3dlcl9kb21haW5zKGRldl9wcml2LCBwdXRfZG9tYWluc1tp
XSk7Cj4gPiArCQkJbW9kZXNldF9wdXRfcG93ZXJfZG9tYWlucyhpOTE1LCBwdXRfZG9tYWluc1tp
XSk7Cj4gPiAgIAkJaW50ZWxfbW9kZXNldF92ZXJpZnlfY3J0YyhjcnRjLCBzdGF0ZSwgb2xkX2Ny
dGNfc3RhdGUsIG5ld19jcnRjX3N0YXRlKTsKPiA+ICAgCX0KPiA+IEBAIC0xMzkxMyw3ICsxMzkx
Myw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21taXRfdGFpbChzdHJ1Y3QgZHJtX2F0
b21pY19zdGF0ZSAqc3RhdGUpCj4gPiAgIAkJaW50ZWxfdmVyaWZ5X3BsYW5lcyhpbnRlbF9zdGF0
ZSk7Cj4gPiAgIAlpZiAoaW50ZWxfc3RhdGUtPm1vZGVzZXQgJiYgaW50ZWxfY2FuX2VuYWJsZV9z
YWd2KHN0YXRlKSkKPiA+IC0JCWludGVsX2VuYWJsZV9zYWd2KGRldl9wcml2KTsKPiA+ICsJCWlu
dGVsX2VuYWJsZV9zYWd2KGk5MTUpOwo+ID4gICAJZHJtX2F0b21pY19oZWxwZXJfY29tbWl0X2h3
X2RvbmUoc3RhdGUpOwo+ID4gQEAgLTEzOTI0LDEwICsxMzkyNCwxMCBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9hdG9taWNfY29tbWl0X3RhaWwoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+
ID4gICAJCSAqIHNvIGVuYWJsZSBkZWJ1Z2dpbmcgZm9yIHRoZSBuZXh0IG1vZGVzZXQgLSBhbmQg
aG9wZSB3ZSBjYXRjaAo+ID4gICAJCSAqIHRoZSBjdWxwcml0Lgo+ID4gICAJCSAqLwo+ID4gLQkJ
aW50ZWxfdW5jb3JlX2FybV91bmNsYWltZWRfbW1pb19kZXRlY3Rpb24oJmRldl9wcml2LT51bmNv
cmUpOwo+ID4gLQkJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJ
Tl9NT0RFU0VULCB3YWtlcmVmKTsKPiA+ICsJCWludGVsX3VuY29yZV9hcm1fdW5jbGFpbWVkX21t
aW9fZGV0ZWN0aW9uKCZpOTE1LT51bmNvcmUpOwo+ID4gKwkJaW50ZWxfZGlzcGxheV9wb3dlcl9w
dXQoaTkxNSwgUE9XRVJfRE9NQUlOX01PREVTRVQsIHdha2VyZWYpOwo+ID4gICAJfQo+ID4gLQlp
bnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgaW50ZWxfc3RhdGUtPndha2VyZWYpOwo+ID4g
KwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCBpbnRlbF9zdGF0ZS0+d2FrZXJlZik7Cj4gPiAg
IAkvKgo+ID4gICAJICogRGVmZXIgdGhlIGNsZWFudXAgb2YgdGhlIG9sZCBzdGF0ZSB0byBhIHNl
cGFyYXRlIHdvcmtlciB0byBub3QKPiA+IEBAIC0xNDAwMywxMCArMTQwMDMsMTAgQEAgc3RhdGlj
IGludCBpbnRlbF9hdG9taWNfY29tbWl0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgIAkJ
CSAgICAgICBib29sIG5vbmJsb2NrKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfYXRvbWlj
X3N0YXRlICppbnRlbF9zdGF0ZSA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShzdGF0ZSk7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlpbnQg
cmV0ID0gMDsKPiA+IC0JaW50ZWxfc3RhdGUtPndha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dl
dChkZXZfcHJpdik7Cj4gPiArCWludGVsX3N0YXRlLT53YWtlcmVmID0gaW50ZWxfcnVudGltZV9w
bV9nZXQoaTkxNSk7Cj4gPiAgIAlkcm1fYXRvbWljX3N0YXRlX2dldChzdGF0ZSk7Cj4gPiAgIAlp
OTE1X3N3X2ZlbmNlX2luaXQoJmludGVsX3N0YXRlLT5jb21taXRfcmVhZHksCj4gPiBAQCAtMTQw
MjksNyArMTQwMjksNyBAQCBzdGF0aWMgaW50IGludGVsX2F0b21pY19jb21taXQoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwKPiA+ICAgCSAqIEZJWE1FIGRvaW5nIHdhdGVybWFya3MgYW5kIGZiIGNs
ZWFudXAgZnJvbSBhIHZibGFuayB3b3JrZXIKPiA+ICAgCSAqIChhc3N1bWluZyB3ZSBoYWQgYW55
KSB3b3VsZCBzb2x2ZSB0aGVzZSBwcm9ibGVtcy4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA8IDkgJiYgc3RhdGUtPmxlZ2FjeV9jdXJzb3JfdXBkYXRlKSB7Cj4gPiAr
CWlmIChJTlRFTF9HRU4oaTkxNSkgPCA5ICYmIHN0YXRlLT5sZWdhY3lfY3Vyc29yX3VwZGF0ZSkg
ewo+ID4gICAJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZTsKPiA+ICAg
CQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiA+ICAgCQlpbnQgaTsKPiA+IEBAIC0xNDA0NCw3
ICsxNDA0NCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NvbW1pdChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LAo+ID4gICAJaWYgKHJldCkgewo+ID4gICAJCURSTV9ERUJVR19BVE9NSUMoIlBy
ZXBhcmluZyBzdGF0ZSBmYWlsZWQgd2l0aCAlaVxuIiwgcmV0KTsKPiA+ICAgCQlpOTE1X3N3X2Zl
bmNlX2NvbW1pdCgmaW50ZWxfc3RhdGUtPmNvbW1pdF9yZWFkeSk7Cj4gPiAtCQlpbnRlbF9ydW50
aW1lX3BtX3B1dChkZXZfcHJpdiwgaW50ZWxfc3RhdGUtPndha2VyZWYpOwo+ID4gKwkJaW50ZWxf
cnVudGltZV9wbV9wdXQoaTkxNSwgaW50ZWxfc3RhdGUtPndha2VyZWYpOwo+ID4gICAJCXJldHVy
biByZXQ7Cj4gPiAgIAl9Cj4gPiBAQCAtMTQwNTYsMjEgKzE0MDU2LDIxIEBAIHN0YXRpYyBpbnQg
aW50ZWxfYXRvbWljX2NvbW1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ID4gICAJCWk5MTVf
c3dfZmVuY2VfY29tbWl0KCZpbnRlbF9zdGF0ZS0+Y29tbWl0X3JlYWR5KTsKPiA+ICAgCQlkcm1f
YXRvbWljX2hlbHBlcl9jbGVhbnVwX3BsYW5lcyhkZXYsIHN0YXRlKTsKPiA+IC0JCWludGVsX3J1
bnRpbWVfcG1fcHV0KGRldl9wcml2LCBpbnRlbF9zdGF0ZS0+d2FrZXJlZik7Cj4gPiArCQlpbnRl
bF9ydW50aW1lX3BtX3B1dChpOTE1LCBpbnRlbF9zdGF0ZS0+d2FrZXJlZik7Cj4gPiAgIAkJcmV0
dXJuIHJldDsKPiA+ICAgCX0KPiA+IC0JZGV2X3ByaXYtPndtLmRpc3RydXN0X2Jpb3Nfd20gPSBm
YWxzZTsKPiA+ICsJaTkxNS0+d20uZGlzdHJ1c3RfYmlvc193bSA9IGZhbHNlOwo+ID4gICAJaW50
ZWxfc2hhcmVkX2RwbGxfc3dhcF9zdGF0ZShzdGF0ZSk7Cj4gPiAgIAlpbnRlbF9hdG9taWNfdHJh
Y2tfZmJzKHN0YXRlKTsKPiA+ICAgCWlmIChpbnRlbF9zdGF0ZS0+bW9kZXNldCkgewo+ID4gLQkJ
bWVtY3B5KGRldl9wcml2LT5taW5fY2RjbGssIGludGVsX3N0YXRlLT5taW5fY2RjbGssCj4gPiAr
CQltZW1jcHkoaTkxNS0+bWluX2NkY2xrLCBpbnRlbF9zdGF0ZS0+bWluX2NkY2xrLAo+ID4gICAJ
CSAgICAgICBzaXplb2YoaW50ZWxfc3RhdGUtPm1pbl9jZGNsaykpOwo+ID4gLQkJbWVtY3B5KGRl
dl9wcml2LT5taW5fdm9sdGFnZV9sZXZlbCwKPiA+ICsJCW1lbWNweShpOTE1LT5taW5fdm9sdGFn
ZV9sZXZlbCwKPiA+ICAgCQkgICAgICAgaW50ZWxfc3RhdGUtPm1pbl92b2x0YWdlX2xldmVsLAo+
ID4gICAJCSAgICAgICBzaXplb2YoaW50ZWxfc3RhdGUtPm1pbl92b2x0YWdlX2xldmVsKSk7Cj4g
PiAtCQlkZXZfcHJpdi0+YWN0aXZlX2NydGNzID0gaW50ZWxfc3RhdGUtPmFjdGl2ZV9jcnRjczsK
PiA+IC0JCWRldl9wcml2LT5jZGNsay5mb3JjZV9taW5fY2RjbGsgPQo+ID4gKwkJaTkxNS0+YWN0
aXZlX2NydGNzID0gaW50ZWxfc3RhdGUtPmFjdGl2ZV9jcnRjczsKPiA+ICsJCWk5MTUtPmNkY2xr
LmZvcmNlX21pbl9jZGNsayA9Cj4gPiAgIAkJCWludGVsX3N0YXRlLT5jZGNsay5mb3JjZV9taW5f
Y2RjbGs7Cj4gPiAgIAkJaW50ZWxfY2RjbGtfc3dhcF9zdGF0ZShpbnRlbF9zdGF0ZSk7Cj4gPiBA
QCAtMTQwODEsMTIgKzE0MDgxLDEyIEBAIHN0YXRpYyBpbnQgaW50ZWxfYXRvbWljX2NvbW1pdChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ID4gICAJaTkxNV9zd19mZW5jZV9jb21taXQoJmludGVs
X3N0YXRlLT5jb21taXRfcmVhZHkpOwo+ID4gICAJaWYgKG5vbmJsb2NrICYmIGludGVsX3N0YXRl
LT5tb2Rlc2V0KSB7Cj4gPiAtCQlxdWV1ZV93b3JrKGRldl9wcml2LT5tb2Rlc2V0X3dxLCAmc3Rh
dGUtPmNvbW1pdF93b3JrKTsKPiA+ICsJCXF1ZXVlX3dvcmsoaTkxNS0+bW9kZXNldF93cSwgJnN0
YXRlLT5jb21taXRfd29yayk7Cj4gPiAgIAl9IGVsc2UgaWYgKG5vbmJsb2NrKSB7Cj4gPiAgIAkJ
cXVldWVfd29yayhzeXN0ZW1fdW5ib3VuZF93cSwgJnN0YXRlLT5jb21taXRfd29yayk7Cj4gPiAg
IAl9IGVsc2Ugewo+ID4gICAJCWlmIChpbnRlbF9zdGF0ZS0+bW9kZXNldCkKPiA+IC0JCQlmbHVz
aF93b3JrcXVldWUoZGV2X3ByaXYtPm1vZGVzZXRfd3EpOwo+ID4gKwkJCWZsdXNoX3dvcmtxdWV1
ZShpOTE1LT5tb2Rlc2V0X3dxKTsKPiA+ICAgCQlpbnRlbF9hdG9taWNfY29tbWl0X3RhaWwoc3Rh
dGUpOwo+ID4gICAJfQo+ID4gQEAgLTE0MTY2LDE0ICsxNDE2NiwxNCBAQCBzdGF0aWMgdm9pZCBh
ZGRfcnBzX2Jvb3N0X2FmdGVyX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gPiAgIHN0
YXRpYyBpbnQgaW50ZWxfcGxhbmVfcGluX2ZiKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxh
bmVfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19p
bnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4g
PiAgIAlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5iYXNlLmZiOwo+
ID4gICAJc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gPiAgIAlpZiAocGxhbmUtPmlkID09IFBMQU5F
X0NVUlNPUiAmJgo+ID4gLQkgICAgSU5URUxfSU5GTyhkZXZfcHJpdiktPmRpc3BsYXkuY3Vyc29y
X25lZWRzX3BoeXNpY2FsKSB7Cj4gPiArCSAgICBJTlRFTF9JTkZPKGk5MTUpLT5kaXNwbGF5LmN1
cnNvcl9uZWVkc19waHlzaWNhbCkgewo+ID4gICAJCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmogPSBpbnRlbF9mYl9vYmooZmIpOwo+ID4gLQkJY29uc3QgaW50IGFsaWduID0gaW50ZWxf
Y3Vyc29yX2FsaWdubWVudChkZXZfcHJpdik7Cj4gPiArCQljb25zdCBpbnQgYWxpZ24gPSBpbnRl
bF9jdXJzb3JfYWxpZ25tZW50KGk5MTUpOwo+ID4gICAJCWludCBlcnI7Cj4gPiAgIAkJZXJyID0g
aTkxNV9nZW1fb2JqZWN0X2F0dGFjaF9waHlzKG9iaiwgYWxpZ24pOwo+ID4gQEAgLTE0MjMxLDcg
KzE0MjMxLDcgQEAgaW50ZWxfcHJlcGFyZV9wbGFuZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFu
ZSwKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqaW50ZWxfc3RhdGUg
PQo+ID4gICAJCXRvX2ludGVsX2F0b21pY19zdGF0ZShuZXdfc3RhdGUtPnN0YXRlKTsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+ZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5lLT5kZXYp
Owo+ID4gICAJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBuZXdfc3RhdGUtPmZiOwo+ID4g
ICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGludGVsX2ZiX29iaihmYik7Cj4g
PiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2xkX29iaiA9IGludGVsX2ZiX29iaihw
bGFuZS0+c3RhdGUtPmZiKTsKPiA+IEBAIC0xNDI3OSw3ICsxNDI3OSw3IEBAIGludGVsX3ByZXBh
cmVfcGxhbmVfZmIoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCj4gPiAgIAlpZiAocmV0KQo+ID4g
ICAJCXJldHVybiByZXQ7Cj4gPiAtCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZGV2
X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVw
dGlibGUoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICAJaWYgKHJldCkgewo+ID4gICAJ
CWk5MTVfZ2VtX29iamVjdF91bnBpbl9wYWdlcyhvYmopOwo+ID4gICAJCXJldHVybiByZXQ7Cj4g
PiBAQCAtMTQyODcsNyArMTQyODcsNyBAQCBpbnRlbF9wcmVwYXJlX3BsYW5lX2ZiKHN0cnVjdCBk
cm1fcGxhbmUgKnBsYW5lLAo+ID4gICAJcmV0ID0gaW50ZWxfcGxhbmVfcGluX2ZiKHRvX2ludGVs
X3BsYW5lX3N0YXRlKG5ld19zdGF0ZSkpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5k
cm0uc3RydWN0X211dGV4KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKPiA+ICAgCWk5MTVfZ2VtX29iamVjdF91bnBpbl9wYWdlcyhvYmopOwo+ID4gICAJaWYg
KHJldCkKPiA+ICAgCQlyZXR1cm4gcmV0Owo+ID4gQEAgLTE0MzIzLDcgKzE0MzIzLDcgQEAgaW50
ZWxfcHJlcGFyZV9wbGFuZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKPiA+ICAgCSAqIG1h
eGltdW0gY2xvY2tzIGZvbGxvd2luZyBhIHZibGFuayBtaXNzIChzZWUgZG9fcnBzX2Jvb3N0KCkp
Lgo+ID4gICAJICovCj4gPiAgIAlpZiAoIWludGVsX3N0YXRlLT5ycHNfaW50ZXJhY3RpdmUpIHsK
PiA+IC0JCWludGVsX3Jwc19tYXJrX2ludGVyYWN0aXZlKGRldl9wcml2LCB0cnVlKTsKPiA+ICsJ
CWludGVsX3Jwc19tYXJrX2ludGVyYWN0aXZlKGk5MTUsIHRydWUpOwo+ID4gICAJCWludGVsX3N0
YXRlLT5ycHNfaW50ZXJhY3RpdmUgPSB0cnVlOwo+ID4gICAJfQo+ID4gQEAgLTE0MzQ1LDE3ICsx
NDM0NSwxNyBAQCBpbnRlbF9jbGVhbnVwX3BsYW5lX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5l
LAo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICppbnRlbF9zdGF0ZSA9
Cj4gPiAgIAkJdG9faW50ZWxfYXRvbWljX3N0YXRlKG9sZF9zdGF0ZS0+c3RhdGUpOwo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5kZXYpOwo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmRldik7
Cj4gPiAgIAlpZiAoaW50ZWxfc3RhdGUtPnJwc19pbnRlcmFjdGl2ZSkgewo+ID4gLQkJaW50ZWxf
cnBzX21hcmtfaW50ZXJhY3RpdmUoZGV2X3ByaXYsIGZhbHNlKTsKPiA+ICsJCWludGVsX3Jwc19t
YXJrX2ludGVyYWN0aXZlKGk5MTUsIGZhbHNlKTsKPiA+ICAgCQlpbnRlbF9zdGF0ZS0+cnBzX2lu
dGVyYWN0aXZlID0gZmFsc2U7Cj4gPiAgIAl9Cj4gPiAgIAkvKiBTaG91bGQgb25seSBiZSBjYWxs
ZWQgYWZ0ZXIgYSBzdWNjZXNzZnVsIGludGVsX3ByZXBhcmVfcGxhbmVfZmIoKSEgKi8KPiA+IC0J
bXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwltdXRleF9sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICAgCWludGVsX3BsYW5lX3VucGluX2ZiKHRv
X2ludGVsX3BsYW5lX3N0YXRlKG9sZF9zdGF0ZSkpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9w
cml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKPiA+ICAgfQo+ID4gICBpbnQKPiA+IEBAIC0xNDM2Myw3ICsxNDM2Myw3IEBA
IHNrbF9tYXhfc2NhbGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gPiAgIAkgICAgICB1MzIgcGl4ZWxfZm9ybWF0KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gPiAgIAlpbnQgbWF4X3NjYWxlLCBtdWx0Owo+ID4gICAJaW50IGNydGNf
Y2xvY2ssIG1heF9kb3RjbGssIHRtcGNsazEsIHRtcGNsazI7Cj4gPiBAQCAtMTQzNzMsNyArMTQz
NzMsNyBAQCBza2xfbWF4X3NjYWxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAo+ID4gICAJY3J0Y19jbG9jayA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9k
ZS5jcnRjX2Nsb2NrOwo+ID4gICAJbWF4X2RvdGNsayA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShj
cnRjX3N0YXRlLT5iYXNlLnN0YXRlKS0+Y2RjbGsubG9naWNhbC5jZGNsazsKPiA+IC0JaWYgKElT
X0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApCj4gPiAr
CWlmIChJU19HRU1JTklMQUtFKGk5MTUpIHx8IElOVEVMX0dFTihpOTE1KSA+PSAxMCkKPiA+ICAg
CQltYXhfZG90Y2xrICo9IDI7Cj4gPiAgIAlpZiAoV0FSTl9PTl9PTkNFKCFjcnRjX2Nsb2NrIHx8
IG1heF9kb3RjbGsgPCBjcnRjX2Nsb2NrKSkKPiA+IEBAIC0xNDM5Niw3ICsxNDM5Niw3IEBAIHNr
bF9tYXhfc2NhbGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4g
PiAgIHN0YXRpYyB2b2lkIGludGVsX2JlZ2luX2NydGNfY29tbWl0KHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlLAo+ID4gICAJCQkJICAgIHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9s
ZF9jcnRjX3N0YXRlID0KPiA+ICAgCQlpbnRlbF9hdG9taWNfZ2V0X29sZF9jcnRjX3N0YXRlKHN0
YXRlLCBjcnRjKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0
ZSA9Cj4gPiBAQCAtMTQ0MTUsMzEgKzE0NDE1LDMxIEBAIHN0YXRpYyB2b2lkIGludGVsX2JlZ2lu
X2NydGNfY29tbWl0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ID4gICAJaWYg
KG5ld19jcnRjX3N0YXRlLT51cGRhdGVfcGlwZSkKPiA+ICAgCQlpbnRlbF91cGRhdGVfcGlwZV9j
b25maWcob2xkX2NydGNfc3RhdGUsIG5ld19jcnRjX3N0YXRlKTsKPiA+IC0JZWxzZSBpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ID4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0g
OSkKPiA+ICAgCQlza2xfZGV0YWNoX3NjYWxlcnMobmV3X2NydGNfc3RhdGUpOwo+ID4gLQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSA5IHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpCj4gPiAr
CWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gPiAgIAkJ
YmR3X3NldF9waXBlbWlzYyhuZXdfY3J0Y19zdGF0ZSk7Cj4gPiAgIG91dDoKPiA+IC0JaWYgKGRl
dl9wcml2LT5kaXNwbGF5LmF0b21pY191cGRhdGVfd2F0ZXJtYXJrcykKPiA+IC0JCWRldl9wcml2
LT5kaXNwbGF5LmF0b21pY191cGRhdGVfd2F0ZXJtYXJrcyhzdGF0ZSwKPiA+ICsJaWYgKGk5MTUt
PmRpc3BsYXkuYXRvbWljX3VwZGF0ZV93YXRlcm1hcmtzKQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5h
dG9taWNfdXBkYXRlX3dhdGVybWFya3Moc3RhdGUsCj4gPiAgIAkJCQkJCQkgICBuZXdfY3J0Y19z
dGF0ZSk7Cj4gPiAgIH0KPiA+ICAgdm9pZCBpbnRlbF9jcnRjX2FybV9maWZvX3VuZGVycnVuKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+IC0JaWYgKCFJU19HRU4o
ZGV2X3ByaXYsIDIpKQo+ID4gLQkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGlu
ZyhkZXZfcHJpdiwgY3J0Yy0+cGlwZSwgdHJ1ZSk7Cj4gPiArCWlmICghSVNfR0VOKGk5MTUsIDIp
KQo+ID4gKwkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBjcnRj
LT5waXBlLCB0cnVlKTsKPiA+ICAgCWlmIChjcnRjX3N0YXRlLT5oYXNfcGNoX2VuY29kZXIpIHsK
PiA+ICAgCQllbnVtIHBpcGUgcGNoX3RyYW5zY29kZXIgPQo+ID4gICAJCQlpbnRlbF9jcnRjX3Bj
aF90cmFuc2NvZGVyKGNydGMpOwo+ID4gLQkJaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3Jl
cG9ydGluZyhkZXZfcHJpdiwgcGNoX3RyYW5zY29kZXIsIHRydWUpOwo+ID4gKwkJaW50ZWxfc2V0
X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBwY2hfdHJhbnNjb2RlciwgdHJ1ZSk7
Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IEBAIC0xNDU1OSw3ICsxNDU1OSw3IEBAIGludGVsX2xlZ2Fj
eV9jdXJzb3JfdXBkYXRlKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAo+ID4gICAJCQkgICB1MzIg
c3JjX3csIHUzMiBzcmNfaCwKPiA+ICAgCQkJICAgc3RydWN0IGRybV9tb2Rlc2V0X2FjcXVpcmVf
Y3R4ICpjdHgpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiA+ICAgCWludCByZXQ7Cj4gPiAgIAlzdHJ1Y3QgZHJt
X3BsYW5lX3N0YXRlICpvbGRfcGxhbmVfc3RhdGUsICpuZXdfcGxhbmVfc3RhdGU7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfcGxhbmUgKmludGVsX3BsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmUpOwo+
ID4gQEAgLTE0NjI2LDcgKzE0NjI2LDcgQEAgaW50ZWxfbGVnYWN5X2N1cnNvcl91cGRhdGUoc3Ry
dWN0IGRybV9wbGFuZSAqcGxhbmUsCj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCWdvdG8gb3V0X2Zy
ZWU7Cj4gPiAtCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZGV2X3ByaXYtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwo+ID4gKwlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICAJaWYgKHJldCkKPiA+ICAgCQlnb3RvIG91dF9mcmVl
Owo+ID4gQEAgLTE0NjY0LDcgKzE0NjY0LDcgQEAgaW50ZWxfbGVnYWN5X2N1cnNvcl91cGRhdGUo
c3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCj4gPiAgIAlpbnRlbF9wbGFuZV91bnBpbl9mYih0b19p
bnRlbF9wbGFuZV9zdGF0ZShvbGRfcGxhbmVfc3RhdGUpKTsKPiA+ICAgb3V0X3VubG9jazoKPiA+
IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCW11dGV4
X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAgIG91dF9mcmVlOgo+ID4gICAJ
aWYgKG5ld19jcnRjX3N0YXRlKQo+ID4gICAJCWludGVsX2NydGNfZGVzdHJveV9zdGF0ZShjcnRj
LCAmbmV3X2NydGNfc3RhdGUtPmJhc2UpOwo+ID4gQEAgLTE0NjkxLDI1ICsxNDY5MSwyNSBAQCBz
dGF0aWMgY29uc3Qgc3RydWN0IGRybV9wbGFuZV9mdW5jcyBpbnRlbF9jdXJzb3JfcGxhbmVfZnVu
Y3MgPSB7Cj4gPiAgIAkuZm9ybWF0X21vZF9zdXBwb3J0ZWQgPSBpbnRlbF9jdXJzb3JfZm9ybWF0
X21vZF9zdXBwb3J0ZWQsCj4gPiAgIH07Cj4gPiAtc3RhdGljIGJvb2wgaTl4eF9wbGFuZV9oYXNf
ZmJjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgYm9vbCBp
OXh4X3BsYW5lX2hhc19mYmMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJ
CSAgICAgICBlbnVtIGk5eHhfcGxhbmVfaWQgaTl4eF9wbGFuZSkKPiA+ICAgewo+ID4gLQlpZiAo
IUhBU19GQkMoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19GQkMoaTkxNSkpCj4gPiAgIAkJcmV0
dXJuIGZhbHNlOwo+ID4gLQlpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSB8fCBJU19IQVNXRUxM
KGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0JST0FEV0VMTChpOTE1KSB8fCBJU19IQVNXRUxMKGk5
MTUpKQo+ID4gICAJCXJldHVybiBpOXh4X3BsYW5lID09IFBMQU5FX0E7IC8qIHRpZWQgdG8gcGlw
ZSBBICovCj4gPiAtCWVsc2UgaWYgKElTX0lWWUJSSURHRShkZXZfcHJpdikpCj4gPiArCWVsc2Ug
aWYgKElTX0lWWUJSSURHRShpOTE1KSkKPiA+ICAgCQlyZXR1cm4gaTl4eF9wbGFuZSA9PSBQTEFO
RV9BIHx8IGk5eHhfcGxhbmUgPT0gUExBTkVfQiB8fAo+ID4gICAJCQlpOXh4X3BsYW5lID09IFBM
QU5FX0M7Cj4gPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkKPiA+ICsJZWxz
ZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDQpCj4gPiAgIAkJcmV0dXJuIGk5eHhfcGxhbmUgPT0g
UExBTkVfQSB8fCBpOXh4X3BsYW5lID09IFBMQU5FX0I7Cj4gPiAgIAllbHNlCj4gPiAgIAkJcmV0
dXJuIGk5eHhfcGxhbmUgPT0gUExBTkVfQTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgc3RydWN0IGlu
dGVsX3BsYW5lICoKPiA+IC1pbnRlbF9wcmltYXJ5X3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ID4gK2ludGVsX3ByaW1hcnlf
cGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlw
ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKPiA+ICAgCWNvbnN0
IHN0cnVjdCBkcm1fcGxhbmVfZnVuY3MgKnBsYW5lX2Z1bmNzOwo+ID4gQEAgLTE0NzIwLDggKzE0
NzIwLDggQEAgaW50ZWxfcHJpbWFyeV9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgCWludCBudW1fZm9ybWF0czsKPiA+
ICAgCWludCByZXQ7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiAtCQly
ZXR1cm4gc2tsX3VuaXZlcnNhbF9wbGFuZV9jcmVhdGUoZGV2X3ByaXYsIHBpcGUsCj4gPiArCWlm
IChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiA+ICsJCXJldHVybiBza2xfdW5pdmVyc2FsX3BsYW5l
X2NyZWF0ZShpOTE1LCBwaXBlLAo+ID4gICAJCQkJCQkgIFBMQU5FX1BSSU1BUlkpOwo+ID4gICAJ
cGxhbmUgPSBpbnRlbF9wbGFuZV9hbGxvYygpOwo+ID4gQEAgLTE0NzMzLDIxICsxNDczMywyMSBA
QCBpbnRlbF9wcmltYXJ5X3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ID4gICAJICogT24gZ2VuMi8zIG9ubHkgcGxhbmUgQSBj
YW4gZG8gRkJDLCBidXQgdGhlIHBhbmVsIGZpdHRlciBhbmQgTFZEUwo+ID4gICAJICogcG9ydCBp
cyBob29rZWQgdG8gcGlwZSBCLiBIZW5jZSB3ZSB3YW50IHBsYW5lIEEgZmVlZGluZyBwaXBlIEIu
Cj4gPiAgIAkgKi8KPiA+IC0JaWYgKEhBU19GQkMoZGV2X3ByaXYpICYmIElOVEVMX0dFTihkZXZf
cHJpdikgPCA0KQo+ID4gKwlpZiAoSEFTX0ZCQyhpOTE1KSAmJiBJTlRFTF9HRU4oaTkxNSkgPCA0
KQo+ID4gICAJCXBsYW5lLT5pOXh4X3BsYW5lID0gKGVudW0gaTl4eF9wbGFuZV9pZCkgIXBpcGU7
Cj4gPiAgIAllbHNlCj4gPiAgIAkJcGxhbmUtPmk5eHhfcGxhbmUgPSAoZW51bSBpOXh4X3BsYW5l
X2lkKSBwaXBlOwo+ID4gICAJcGxhbmUtPmlkID0gUExBTkVfUFJJTUFSWTsKPiA+ICAgCXBsYW5l
LT5mcm9udGJ1ZmZlcl9iaXQgPSBJTlRFTF9GUk9OVEJVRkZFUihwaXBlLCBwbGFuZS0+aWQpOwo+
ID4gLQlwbGFuZS0+aGFzX2ZiYyA9IGk5eHhfcGxhbmVfaGFzX2ZiYyhkZXZfcHJpdiwgcGxhbmUt
Pmk5eHhfcGxhbmUpOwo+ID4gKwlwbGFuZS0+aGFzX2ZiYyA9IGk5eHhfcGxhbmVfaGFzX2ZiYyhp
OTE1LCBwbGFuZS0+aTl4eF9wbGFuZSk7Cj4gPiAgIAlpZiAocGxhbmUtPmhhc19mYmMpIHsKPiA+
IC0JCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ID4gKwkJc3RydWN0
IGludGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiA+ICAgCQlmYmMtPnBvc3NpYmxlX2ZyYW1l
YnVmZmVyX2JpdHMgfD0gcGxhbmUtPmZyb250YnVmZmVyX2JpdDsKPiA+ICAgCX0KPiA+IC0JaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49
IDQpIHsKPiA+ICAgCQlmb3JtYXRzID0gaTk2NV9wcmltYXJ5X2Zvcm1hdHM7Cj4gPiAgIAkJbnVt
X2Zvcm1hdHMgPSBBUlJBWV9TSVpFKGk5NjVfcHJpbWFyeV9mb3JtYXRzKTsKPiA+ICAgCQltb2Rp
ZmllcnMgPSBpOXh4X2Zvcm1hdF9tb2RpZmllcnM7Cj4gPiBAQCAtMTQ3NzUsMTQgKzE0Nzc1LDE0
IEBAIGludGVsX3ByaW1hcnlfcGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4gPiAgIAlwb3NzaWJsZV9jcnRjcyA9IEJJVChwaXBl
KTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSB8fCBJU19HNFgoZGV2X3ByaXYp
KQo+ID4gLQkJcmV0ID0gZHJtX3VuaXZlcnNhbF9wbGFuZV9pbml0KCZkZXZfcHJpdi0+ZHJtLCAm
cGxhbmUtPmJhc2UsCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNSB8fCBJU19HNFgoaTkx
NSkpCj4gPiArCQlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2luaXQoJmk5MTUtPmRybSwgJnBs
YW5lLT5iYXNlLAo+ID4gICAJCQkJCSAgICAgICBwb3NzaWJsZV9jcnRjcywgcGxhbmVfZnVuY3Ms
Cj4gPiAgIAkJCQkJICAgICAgIGZvcm1hdHMsIG51bV9mb3JtYXRzLCBtb2RpZmllcnMsCj4gPiAg
IAkJCQkJICAgICAgIERSTV9QTEFORV9UWVBFX1BSSU1BUlksCj4gPiAgIAkJCQkJICAgICAgICJw
cmltYXJ5ICVjIiwgcGlwZV9uYW1lKHBpcGUpKTsKPiA+ICAgCWVsc2UKPiA+IC0JCXJldCA9IGRy
bV91bml2ZXJzYWxfcGxhbmVfaW5pdCgmZGV2X3ByaXYtPmRybSwgJnBsYW5lLT5iYXNlLAo+ID4g
KwkJcmV0ID0gZHJtX3VuaXZlcnNhbF9wbGFuZV9pbml0KCZpOTE1LT5kcm0sICZwbGFuZS0+YmFz
ZSwKPiA+ICAgCQkJCQkgICAgICAgcG9zc2libGVfY3J0Y3MsIHBsYW5lX2Z1bmNzLAo+ID4gICAJ
CQkJCSAgICAgICBmb3JtYXRzLCBudW1fZm9ybWF0cywgbW9kaWZpZXJzLAo+ID4gICAJCQkJCSAg
ICAgICBEUk1fUExBTkVfVFlQRV9QUklNQVJZLAo+ID4gQEAgLTE0NzkxLDE4ICsxNDc5MSwxOCBA
QCBpbnRlbF9wcmltYXJ5X3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ID4gICAJaWYgKHJldCkKPiA+ICAgCQlnb3RvIGZhaWw7
Cj4gPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSAmJiBwaXBlID09IFBJUEVfQikgewo+
ID4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSAmJiBwaXBlID09IFBJUEVfQikgewo+ID4gICAJ
CXN1cHBvcnRlZF9yb3RhdGlvbnMgPQo+ID4gICAJCQlEUk1fTU9ERV9ST1RBVEVfMCB8IERSTV9N
T0RFX1JPVEFURV8xODAgfAo+ID4gICAJCQlEUk1fTU9ERV9SRUZMRUNUX1g7Cj4gPiAtCX0gZWxz
ZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KSB7Cj4gPiArCX0gZWxzZSBpZiAoSU5URUxf
R0VOKGk5MTUpID49IDQpIHsKPiA+ICAgCQlzdXBwb3J0ZWRfcm90YXRpb25zID0KPiA+ICAgCQkJ
RFJNX01PREVfUk9UQVRFXzAgfCBEUk1fTU9ERV9ST1RBVEVfMTgwOwo+ID4gICAJfSBlbHNlIHsK
PiA+ICAgCQlzdXBwb3J0ZWRfcm90YXRpb25zID0gRFJNX01PREVfUk9UQVRFXzA7Cj4gPiAgIAl9
Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpCj4gPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gNCkKPiA+ICAgCQlkcm1fcGxhbmVfY3JlYXRlX3JvdGF0aW9uX3Byb3BlcnR5KCZw
bGFuZS0+YmFzZSwKPiA+ICAgCQkJCQkJICAgRFJNX01PREVfUk9UQVRFXzAsCj4gPiAgIAkJCQkJ
CSAgIHN1cHBvcnRlZF9yb3RhdGlvbnMpOwo+ID4gQEAgLTE0ODE4LDcgKzE0ODE4LDcgQEAgaW50
ZWxfcHJpbWFyeV9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgfQo+ID4gICBzdGF0aWMgc3RydWN0IGludGVsX3BsYW5l
ICoKPiA+IC1pbnRlbF9jdXJzb3JfcGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtpbnRlbF9jdXJzb3JfcGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgIGVudW0gcGlwZSBwaXBlKQo+ID4gICB7Cj4gPiAg
IAl1bnNpZ25lZCBpbnQgcG9zc2libGVfY3J0Y3M7Cj4gPiBAQCAtMTQ4MzQsNyArMTQ4MzQsNyBA
QCBpbnRlbF9jdXJzb3JfcGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICAgCWN1cnNvci0+aWQgPSBQTEFORV9DVVJTT1I7Cj4gPiAgIAljdXJzb3ItPmZy
b250YnVmZmVyX2JpdCA9IElOVEVMX0ZST05UQlVGRkVSKHBpcGUsIGN1cnNvci0+aWQpOwo+ID4g
LQlpZiAoSVNfSTg0NUcoZGV2X3ByaXYpIHx8IElTX0k4NjVHKGRldl9wcml2KSkgewo+ID4gKwlp
ZiAoSVNfSTg0NUcoaTkxNSkgfHwgSVNfSTg2NUcoaTkxNSkpIHsKPiA+ICAgCQljdXJzb3ItPm1h
eF9zdHJpZGUgPSBpODQ1X2N1cnNvcl9tYXhfc3RyaWRlOwo+ID4gICAJCWN1cnNvci0+dXBkYXRl
X3BsYW5lID0gaTg0NV91cGRhdGVfY3Vyc29yOwo+ID4gICAJCWN1cnNvci0+ZGlzYWJsZV9wbGFu
ZSA9IGk4NDVfZGlzYWJsZV9jdXJzb3I7Cj4gPiBAQCAtMTQ4NTEsMTIgKzE0ODUxLDEyIEBAIGlu
dGVsX2N1cnNvcl9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gICAJY3Vyc29yLT5jdXJzb3IuYmFzZSA9IH4wOwo+ID4gICAJY3Vyc29yLT5jdXJzb3Iu
Y250bCA9IH4wOwo+ID4gLQlpZiAoSVNfSTg0NUcoZGV2X3ByaXYpIHx8IElTX0k4NjVHKGRldl9w
cml2KSB8fCBIQVNfQ1VSX0ZCQyhkZXZfcHJpdikpCj4gPiArCWlmIChJU19JODQ1RyhpOTE1KSB8
fCBJU19JODY1RyhpOTE1KSB8fCBIQVNfQ1VSX0ZCQyhpOTE1KSkKPiA+ICAgCQljdXJzb3ItPmN1
cnNvci5zaXplID0gfjA7Cj4gPiAgIAlwb3NzaWJsZV9jcnRjcyA9IEJJVChwaXBlKTsKPiA+IC0J
cmV0ID0gZHJtX3VuaXZlcnNhbF9wbGFuZV9pbml0KCZkZXZfcHJpdi0+ZHJtLCAmY3Vyc29yLT5i
YXNlLAo+ID4gKwlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2luaXQoJmk5MTUtPmRybSwgJmN1
cnNvci0+YmFzZSwKPiA+ICAgCQkJCSAgICAgICBwb3NzaWJsZV9jcnRjcywgJmludGVsX2N1cnNv
cl9wbGFuZV9mdW5jcywKPiA+ICAgCQkJCSAgICAgICBpbnRlbF9jdXJzb3JfZm9ybWF0cywKPiA+
ICAgCQkJCSAgICAgICBBUlJBWV9TSVpFKGludGVsX2N1cnNvcl9mb3JtYXRzKSwKPiA+IEBAIC0x
NDg2Niw3ICsxNDg2Niw3IEBAIGludGVsX2N1cnNvcl9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJaWYgKHJldCkKPiA+ICAgCQlnb3RvIGZhaWw7
Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpCj4gPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gNCkKPiA+ICAgCQlkcm1fcGxhbmVfY3JlYXRlX3JvdGF0aW9uX3Byb3BlcnR5KCZj
dXJzb3ItPmJhc2UsCj4gPiAgIAkJCQkJCSAgIERSTV9NT0RFX1JPVEFURV8wLAo+ID4gICAJCQkJ
CQkgICBEUk1fTU9ERV9ST1RBVEVfMCB8Cj4gPiBAQCAtMTQ4ODcsMTAgKzE0ODg3LDEwIEBAIHN0
YXRpYyB2b2lkIGludGVsX2NydGNfaW5pdF9zY2FsZXJzKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
LAo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zY2FsZXJfc3RhdGUgKnNjYWxlcl9z
dGF0ZSA9Cj4gPiAgIAkJJmNydGNfc3RhdGUtPnNjYWxlcl9zdGF0ZTsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4gPiAgIAlpbnQgaTsKPiA+IC0JY3J0Yy0+bnVtX3NjYWxlcnMgPSBSVU5USU1FX0lORk8oZGV2
X3ByaXYpLT5udW1fc2NhbGVyc1tjcnRjLT5waXBlXTsKPiA+ICsJY3J0Yy0+bnVtX3NjYWxlcnMg
PSBSVU5USU1FX0lORk8oaTkxNSktPm51bV9zY2FsZXJzW2NydGMtPnBpcGVdOwo+ID4gICAJaWYg
KCFjcnRjLT5udW1fc2NhbGVycykKPiA+ICAgCQlyZXR1cm47Cj4gPiBAQCAtMTQ5MDQsNyArMTQ5
MDQsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2luaXRfc2NhbGVycyhzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiA+ICAgCXNjYWxlcl9zdGF0ZS0+c2NhbGVyX2lkID0gLTE7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgaW50IGludGVsX2NydGNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ID4gK3N0YXRpYyBpbnQgaW50ZWxfY3J0Y19pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+
ID4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGM7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IE5VTEw7Cj4gPiBAQCAtMTQ5MjQsMTcgKzE0OTI0LDE3
IEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4gPiAgIAlfX2RybV9hdG9taWNfaGVscGVyX2NydGNf
cmVzZXQoJmludGVsX2NydGMtPmJhc2UsICZjcnRjX3N0YXRlLT5iYXNlKTsKPiA+ICAgCWludGVs
X2NydGMtPmNvbmZpZyA9IGNydGNfc3RhdGU7Cj4gPiAtCXByaW1hcnkgPSBpbnRlbF9wcmltYXJ5
X3BsYW5lX2NyZWF0ZShkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCXByaW1hcnkgPSBpbnRlbF9wcmlt
YXJ5X3BsYW5lX2NyZWF0ZShpOTE1LCBwaXBlKTsKPiA+ICAgCWlmIChJU19FUlIocHJpbWFyeSkp
IHsKPiA+ICAgCQlyZXQgPSBQVFJfRVJSKHByaW1hcnkpOwo+ID4gICAJCWdvdG8gZmFpbDsKPiA+
ICAgCX0KPiA+ICAgCWludGVsX2NydGMtPnBsYW5lX2lkc19tYXNrIHw9IEJJVChwcmltYXJ5LT5p
ZCk7Cj4gPiAtCWZvcl9lYWNoX3Nwcml0ZShkZXZfcHJpdiwgcGlwZSwgc3ByaXRlKSB7Cj4gPiAr
CWZvcl9lYWNoX3Nwcml0ZShpOTE1LCBwaXBlLCBzcHJpdGUpIHsKPiA+ICAgCQlzdHJ1Y3QgaW50
ZWxfcGxhbmUgKnBsYW5lOwo+ID4gLQkJcGxhbmUgPSBpbnRlbF9zcHJpdGVfcGxhbmVfY3JlYXRl
KGRldl9wcml2LCBwaXBlLCBzcHJpdGUpOwo+ID4gKwkJcGxhbmUgPSBpbnRlbF9zcHJpdGVfcGxh
bmVfY3JlYXRlKGk5MTUsIHBpcGUsIHNwcml0ZSk7Cj4gPiAgIAkJaWYgKElTX0VSUihwbGFuZSkp
IHsKPiA+ICAgCQkJcmV0ID0gUFRSX0VSUihwbGFuZSk7Cj4gPiAgIAkJCWdvdG8gZmFpbDsKPiA+
IEBAIC0xNDk0MiwxNCArMTQ5NDIsMTQgQEAgc3RhdGljIGludCBpbnRlbF9jcnRjX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgCQlp
bnRlbF9jcnRjLT5wbGFuZV9pZHNfbWFzayB8PSBCSVQocGxhbmUtPmlkKTsKPiA+ICAgCX0KPiA+
IC0JY3Vyc29yID0gaW50ZWxfY3Vyc29yX3BsYW5lX2NyZWF0ZShkZXZfcHJpdiwgcGlwZSk7Cj4g
PiArCWN1cnNvciA9IGludGVsX2N1cnNvcl9wbGFuZV9jcmVhdGUoaTkxNSwgcGlwZSk7Cj4gPiAg
IAlpZiAoSVNfRVJSKGN1cnNvcikpIHsKPiA+ICAgCQlyZXQgPSBQVFJfRVJSKGN1cnNvcik7Cj4g
PiAgIAkJZ290byBmYWlsOwo+ID4gICAJfQo+ID4gICAJaW50ZWxfY3J0Yy0+cGxhbmVfaWRzX21h
c2sgfD0gQklUKGN1cnNvci0+aWQpOwo+ID4gLQlyZXQgPSBkcm1fY3J0Y19pbml0X3dpdGhfcGxh
bmVzKCZkZXZfcHJpdi0+ZHJtLCAmaW50ZWxfY3J0Yy0+YmFzZSwKPiA+ICsJcmV0ID0gZHJtX2Ny
dGNfaW5pdF93aXRoX3BsYW5lcygmaTkxNS0+ZHJtLCAmaW50ZWxfY3J0Yy0+YmFzZSwKPiA+ICAg
CQkJCQkmcHJpbWFyeS0+YmFzZSwgJmN1cnNvci0+YmFzZSwKPiA+ICAgCQkJCQkmaW50ZWxfY3J0
Y19mdW5jcywKPiA+ICAgCQkJCQkicGlwZSAlYyIsIHBpcGVfbmFtZShwaXBlKSk7Cj4gPiBAQCAt
MTQ5NjEsMTYgKzE0OTYxLDE2IEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4gPiAgIAkvKiBpbml0
aWFsaXplIHNoYXJlZCBzY2FsZXJzICovCj4gPiAgIAlpbnRlbF9jcnRjX2luaXRfc2NhbGVycyhp
bnRlbF9jcnRjLCBjcnRjX3N0YXRlKTsKPiA+IC0JQlVHX09OKHBpcGUgPj0gQVJSQVlfU0laRShk
ZXZfcHJpdi0+cGlwZV90b19jcnRjX21hcHBpbmcpIHx8Cj4gPiAtCSAgICAgICBkZXZfcHJpdi0+
cGlwZV90b19jcnRjX21hcHBpbmdbcGlwZV0gIT0gTlVMTCk7Cj4gPiAtCWRldl9wcml2LT5waXBl
X3RvX2NydGNfbWFwcGluZ1twaXBlXSA9IGludGVsX2NydGM7Cj4gPiArCUJVR19PTihwaXBlID49
IEFSUkFZX1NJWkUoaTkxNS0+cGlwZV90b19jcnRjX21hcHBpbmcpIHx8Cj4gPiArCSAgICAgICBp
OTE1LT5waXBlX3RvX2NydGNfbWFwcGluZ1twaXBlXSAhPSBOVUxMKTsKPiA+ICsJaTkxNS0+cGlw
ZV90b19jcnRjX21hcHBpbmdbcGlwZV0gPSBpbnRlbF9jcnRjOwo+ID4gLQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA8IDkpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDkpIHsKPiA+ICAg
CQllbnVtIGk5eHhfcGxhbmVfaWQgaTl4eF9wbGFuZSA9IHByaW1hcnktPmk5eHhfcGxhbmU7Cj4g
PiAtCQlCVUdfT04oaTl4eF9wbGFuZSA+PSBBUlJBWV9TSVpFKGRldl9wcml2LT5wbGFuZV90b19j
cnRjX21hcHBpbmcpIHx8Cj4gPiAtCQkgICAgICAgZGV2X3ByaXYtPnBsYW5lX3RvX2NydGNfbWFw
cGluZ1tpOXh4X3BsYW5lXSAhPSBOVUxMKTsKPiA+IC0JCWRldl9wcml2LT5wbGFuZV90b19jcnRj
X21hcHBpbmdbaTl4eF9wbGFuZV0gPSBpbnRlbF9jcnRjOwo+ID4gKwkJQlVHX09OKGk5eHhfcGxh
bmUgPj0gQVJSQVlfU0laRShpOTE1LT5wbGFuZV90b19jcnRjX21hcHBpbmcpIHx8Cj4gPiArCQkg
ICAgICAgaTkxNS0+cGxhbmVfdG9fY3J0Y19tYXBwaW5nW2k5eHhfcGxhbmVdICE9IE5VTEwpOwo+
ID4gKwkJaTkxNS0+cGxhbmVfdG9fY3J0Y19tYXBwaW5nW2k5eHhfcGxhbmVdID0gaW50ZWxfY3J0
YzsKPiA+ICAgCX0KPiA+ICAgCWRybV9jcnRjX2hlbHBlcl9hZGQoJmludGVsX2NydGMtPmJhc2Us
ICZpbnRlbF9oZWxwZXJfZnVuY3MpOwo+ID4gQEAgLTE1MDI2LDI5ICsxNTAyNiwyOSBAQCBzdGF0
aWMgaW50IGludGVsX2VuY29kZXJfY2xvbmVzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
KQo+ID4gICAJcmV0dXJuIGluZGV4X21hc2s7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBpbGtf
aGFzX2VkcF9hKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMg
Ym9vbCBpbGtfaGFzX2VkcF9hKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7
Cj4gPiAtCWlmICghSVNfTU9CSUxFKGRldl9wcml2KSkKPiA+ICsJaWYgKCFJU19NT0JJTEUoaTkx
NSkpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gICAJaWYgKChJOTE1X1JFQUQoRFBfQSkgJiBE
UF9ERVRFQ1RFRCkgPT0gMCkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAtCWlmIChJU19HRU4o
ZGV2X3ByaXYsIDUpICYmIChJOTE1X1JFQUQoRlVTRV9TVFJBUCkgJiBJTEtfZURQX0FfRElTQUJM
RSkpCj4gPiArCWlmIChJU19HRU4oaTkxNSwgNSkgJiYgKEk5MTVfUkVBRChGVVNFX1NUUkFQKSAm
IElMS19lRFBfQV9ESVNBQkxFKSkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAlyZXR1cm4g
dHJ1ZTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIGludGVsX2RkaV9jcnRfcHJlc2VudChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGJvb2wgaW50ZWxfZGRp
X2NydF9wcmVzZW50KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAt
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gOSkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAtCWlmIChJU19IU1dfVUxUKGRldl9wcml2
KSB8fCBJU19CRFdfVUxUKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0hTV19VTFQoaTkxNSkgfHwg
SVNfQkRXX1VMVChpOTE1KSkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAtCWlmIChIQVNfUENI
X0xQVF9IKGRldl9wcml2KSAmJgo+ID4gKwlpZiAoSEFTX1BDSF9MUFRfSChpOTE1KSAmJgo+ID4g
ICAJICAgIEk5MTVfUkVBRChTRlVTRV9TVFJBUCkgJiBTRlVTRV9TVFJBUF9DUlRfRElTQUJMRUQp
Cj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTE1MDU2LDI0ICsxNTA1NiwyNCBAQCBzdGF0
aWMgYm9vbCBpbnRlbF9kZGlfY3J0X3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJaWYgKEk5MTVfUkVBRChERElfQlVGX0NUTChQT1JUX0EpKSAmIERESV9B
XzRfTEFORVMpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gLQlpZiAoIWRldl9wcml2LT52YnQu
aW50X2NydF9zdXBwb3J0KQo+ID4gKwlpZiAoIWk5MTUtPnZidC5pbnRfY3J0X3N1cHBvcnQpCj4g
PiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gICAJcmV0dXJuIHRydWU7Cj4gPiAgIH0KPiA+IC12b2lk
IGludGVsX3Bwc191bmxvY2tfcmVnc193YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiArdm9pZCBpbnRlbF9wcHNfdW5sb2NrX3JlZ3Nfd2Eoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWludCBwcHNfbnVtOwo+ID4gICAJaW50IHBwc19p
ZHg7Cj4gPiAtCWlmIChIQVNfRERJKGRldl9wcml2KSkKPiA+ICsJaWYgKEhBU19EREkoaTkxNSkp
Cj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJLyoKPiA+ICAgCSAqIFRoaXMgdy9hIGlzIG5lZWRlZCBh
dCBsZWFzdCBvbiBDUFQvUFBULCBidXQgdG8gYmUgc3VyZSBhcHBseSBpdAo+ID4gICAJICogZXZl
cnl3aGVyZSB3aGVyZSByZWdpc3RlcnMgY2FuIGJlIHdyaXRlIHByb3RlY3RlZC4KPiA+ICAgCSAq
Lwo+ID4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpCj4gPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkx
NSkpCj4gPiAgIAkJcHBzX251bSA9IDI7Cj4gPiAgIAllbHNlCj4gPiAgIAkJcHBzX251bSA9IDE7
Cj4gPiBAQCAtMTUwODYsNjUgKzE1MDg2LDY1IEBAIHZvaWQgaW50ZWxfcHBzX3VubG9ja19yZWdz
X3dhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCX0KPiA+ICAgfQo+
ID4gLXN0YXRpYyB2b2lkIGludGVsX3Bwc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9wcHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikg
fHwgSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gPiAtCQlkZXZfcHJpdi0+cHBzX21taW9fYmFzZSA9
IFBDSF9QUFNfQkFTRTsKPiA+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwg
SVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiAtCQlkZXZfcHJpdi0+cHBzX21taW9fYmFzZSA9
IFZMVl9QUFNfQkFTRTsKPiA+ICsJaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkgfHwgSVNfR0VOOV9M
UChpOTE1KSkKPiA+ICsJCWk5MTUtPnBwc19tbWlvX2Jhc2UgPSBQQ0hfUFBTX0JBU0U7Cj4gPiAr
CWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+
ICsJCWk5MTUtPnBwc19tbWlvX2Jhc2UgPSBWTFZfUFBTX0JBU0U7Cj4gPiAgIAllbHNlCj4gPiAt
CQlkZXZfcHJpdi0+cHBzX21taW9fYmFzZSA9IFBQU19CQVNFOwo+ID4gKwkJaTkxNS0+cHBzX21t
aW9fYmFzZSA9IFBQU19CQVNFOwo+ID4gLQlpbnRlbF9wcHNfdW5sb2NrX3JlZ3Nfd2EoZGV2X3By
aXYpOwo+ID4gKwlpbnRlbF9wcHNfdW5sb2NrX3JlZ3Nfd2EoaTkxNSk7Cj4gPiAgIH0KPiA+IC1z
dGF0aWMgdm9pZCBpbnRlbF9zZXR1cF9vdXRwdXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9zZXR1cF9vdXRwdXRzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlcjsKPiA+ICAgCWJvb2wgZHBkX2lzX2VkcCA9IGZhbHNlOwo+ID4gLQlpbnRlbF9wcHNf
aW5pdChkZXZfcHJpdik7Cj4gPiArCWludGVsX3Bwc19pbml0KGk5MTUpOwo+ID4gLQlpZiAoIUhB
U19ESVNQTEFZKGRldl9wcml2KSkKPiA+ICsJaWYgKCFIQVNfRElTUExBWShpOTE1KSkKPiA+ICAg
CQlyZXR1cm47Cj4gPiAtCWlmIChJU19FTEtIQVJUTEFLRShkZXZfcHJpdikpIHsKPiA+IC0JCWlu
dGVsX2RkaV9pbml0KGRldl9wcml2LCBQT1JUX0EpOwo+ID4gLQkJaW50ZWxfZGRpX2luaXQoZGV2
X3ByaXYsIFBPUlRfQik7Cj4gPiAtCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJpdiwgUE9SVF9DKTsK
PiA+IC0JCWljbF9kc2lfaW5pdChkZXZfcHJpdik7Cj4gPiAtCX0gZWxzZSBpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMSkgewo+ID4gLQkJaW50ZWxfZGRpX2luaXQoZGV2X3ByaXYsIFBPUlRf
QSk7Cj4gPiAtCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJpdiwgUE9SVF9CKTsKPiA+IC0JCWludGVs
X2RkaV9pbml0KGRldl9wcml2LCBQT1JUX0MpOwo+ID4gLQkJaW50ZWxfZGRpX2luaXQoZGV2X3By
aXYsIFBPUlRfRCk7Cj4gPiAtCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJpdiwgUE9SVF9FKTsKPiA+
ICsJaWYgKElTX0VMS0hBUlRMQUtFKGk5MTUpKSB7Cj4gPiArCQlpbnRlbF9kZGlfaW5pdChpOTE1
LCBQT1JUX0EpOwo+ID4gKwkJaW50ZWxfZGRpX2luaXQoaTkxNSwgUE9SVF9CKTsKPiA+ICsJCWlu
dGVsX2RkaV9pbml0KGk5MTUsIFBPUlRfQyk7Cj4gPiArCQlpY2xfZHNpX2luaXQoaTkxNSk7Cj4g
PiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKSB7Cj4gPiArCQlpbnRlbF9kZGlf
aW5pdChpOTE1LCBQT1JUX0EpOwo+ID4gKwkJaW50ZWxfZGRpX2luaXQoaTkxNSwgUE9SVF9CKTsK
PiA+ICsJCWludGVsX2RkaV9pbml0KGk5MTUsIFBPUlRfQyk7Cj4gPiArCQlpbnRlbF9kZGlfaW5p
dChpOTE1LCBQT1JUX0QpOwo+ID4gKwkJaW50ZWxfZGRpX2luaXQoaTkxNSwgUE9SVF9FKTsKPiA+
ICAgCQkvKgo+ID4gICAJCSAqIE9uIHNvbWUgSUNMIFNLVXMgcG9ydCBGIGlzIG5vdCBwcmVzZW50
LiBObyBzdHJhcCBiaXRzIGZvcgo+ID4gICAJCSAqIHRoaXMsIHNvIHJlbHkgb24gVkJULgo+ID4g
ICAJCSAqIFdvcmsgYXJvdW5kIGJyb2tlbiBWQlRzIG9uIFNLVXMga25vd24gdG8gaGF2ZSBubyBw
b3J0IEYuCj4gPiAgIAkJICovCj4gPiAtCQlpZiAoSVNfSUNMX1dJVEhfUE9SVF9GKGRldl9wcml2
KSAmJgo+ID4gLQkJICAgIGludGVsX2Jpb3NfaXNfcG9ydF9wcmVzZW50KGRldl9wcml2LCBQT1JU
X0YpKQo+ID4gLQkJCWludGVsX2RkaV9pbml0KGRldl9wcml2LCBQT1JUX0YpOwo+ID4gKwkJaWYg
KElTX0lDTF9XSVRIX1BPUlRfRihpOTE1KSAmJgo+ID4gKwkJICAgIGludGVsX2Jpb3NfaXNfcG9y
dF9wcmVzZW50KGk5MTUsIFBPUlRfRikpCj4gPiArCQkJaW50ZWxfZGRpX2luaXQoaTkxNSwgUE9S
VF9GKTsKPiA+IC0JCWljbF9kc2lfaW5pdChkZXZfcHJpdik7Cj4gPiAtCX0gZWxzZSBpZiAoSVNf
R0VOOV9MUChkZXZfcHJpdikpIHsKPiA+ICsJCWljbF9kc2lfaW5pdChpOTE1KTsKPiA+ICsJfSBl
bHNlIGlmIChJU19HRU45X0xQKGk5MTUpKSB7Cj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBGSVhNRTog
QnJveHRvbiBkb2Vzbid0IHN1cHBvcnQgcG9ydCBkZXRlY3Rpb24gdmlhIHRoZQo+ID4gICAJCSAq
IERESV9CVUZfQ1RMX0Egb3IgU0ZVU0VfU1RSQVAgcmVnaXN0ZXJzLCBmaW5kIGFub3RoZXIgd2F5
IHRvCj4gPiAgIAkJICogZGV0ZWN0IHRoZSBwb3J0cy4KPiA+ICAgCQkgKi8KPiA+IC0JCWludGVs
X2RkaV9pbml0KGRldl9wcml2LCBQT1JUX0EpOwo+ID4gLQkJaW50ZWxfZGRpX2luaXQoZGV2X3By
aXYsIFBPUlRfQik7Cj4gPiAtCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJpdiwgUE9SVF9DKTsKPiA+
ICsJCWludGVsX2RkaV9pbml0KGk5MTUsIFBPUlRfQSk7Cj4gPiArCQlpbnRlbF9kZGlfaW5pdChp
OTE1LCBQT1JUX0IpOwo+ID4gKwkJaW50ZWxfZGRpX2luaXQoaTkxNSwgUE9SVF9DKTsKPiA+IC0J
CXZsdl9kc2lfaW5pdChkZXZfcHJpdik7Cj4gPiAtCX0gZWxzZSBpZiAoSEFTX0RESShkZXZfcHJp
dikpIHsKPiA+ICsJCXZsdl9kc2lfaW5pdChpOTE1KTsKPiA+ICsJfSBlbHNlIGlmIChIQVNfRERJ
KGk5MTUpKSB7Cj4gPiAgIAkJaW50IGZvdW5kOwo+ID4gLQkJaWYgKGludGVsX2RkaV9jcnRfcHJl
c2VudChkZXZfcHJpdikpCj4gPiAtCQkJaW50ZWxfY3J0X2luaXQoZGV2X3ByaXYpOwo+ID4gKwkJ
aWYgKGludGVsX2RkaV9jcnRfcHJlc2VudChpOTE1KSkKPiA+ICsJCQlpbnRlbF9jcnRfaW5pdChp
OTE1KTsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIEhhc3dlbGwgdXNlcyBEREkgZnVuY3Rpb25zIHRv
IGRldGVjdCBkaWdpdGFsIG91dHB1dHMuCj4gPiBAQCAtMTUxNTMsMjkgKzE1MTUzLDI5IEBAIHN0
YXRpYyB2b2lkIGludGVsX3NldHVwX291dHB1dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJCSAqLwo+ID4gICAJCWZvdW5kID0gSTkxNV9SRUFEKERESV9CVUZfQ1RM
KFBPUlRfQSkpICYgRERJX0lOSVRfRElTUExBWV9ERVRFQ1RFRDsKPiA+ICAgCQkvKiBXYUlnbm9y
ZURESUFTdHJhcDogc2tsICovCj4gPiAtCQlpZiAoZm91bmQgfHwgSVNfR0VOOV9CQyhkZXZfcHJp
dikpCj4gPiAtCQkJaW50ZWxfZGRpX2luaXQoZGV2X3ByaXYsIFBPUlRfQSk7Cj4gPiArCQlpZiAo
Zm91bmQgfHwgSVNfR0VOOV9CQyhpOTE1KSkKPiA+ICsJCQlpbnRlbF9kZGlfaW5pdChpOTE1LCBQ
T1JUX0EpOwo+ID4gICAJCS8qIERESSBCLCBDLCBELCBhbmQgRiBkZXRlY3Rpb24gaXMgaW5kaWNh
dGVkIGJ5IHRoZSBTRlVTRV9TVFJBUAo+ID4gICAJCSAqIHJlZ2lzdGVyICovCj4gPiAgIAkJZm91
bmQgPSBJOTE1X1JFQUQoU0ZVU0VfU1RSQVApOwo+ID4gICAJCWlmIChmb3VuZCAmIFNGVVNFX1NU
UkFQX0RESUJfREVURUNURUQpCj4gPiAtCQkJaW50ZWxfZGRpX2luaXQoZGV2X3ByaXYsIFBPUlRf
Qik7Cj4gPiArCQkJaW50ZWxfZGRpX2luaXQoaTkxNSwgUE9SVF9CKTsKPiA+ICAgCQlpZiAoZm91
bmQgJiBTRlVTRV9TVFJBUF9ERElDX0RFVEVDVEVEKQo+ID4gLQkJCWludGVsX2RkaV9pbml0KGRl
dl9wcml2LCBQT1JUX0MpOwo+ID4gKwkJCWludGVsX2RkaV9pbml0KGk5MTUsIFBPUlRfQyk7Cj4g
PiAgIAkJaWYgKGZvdW5kICYgU0ZVU0VfU1RSQVBfRERJRF9ERVRFQ1RFRCkKPiA+IC0JCQlpbnRl
bF9kZGlfaW5pdChkZXZfcHJpdiwgUE9SVF9EKTsKPiA+ICsJCQlpbnRlbF9kZGlfaW5pdChpOTE1
LCBQT1JUX0QpOwo+ID4gICAJCWlmIChmb3VuZCAmIFNGVVNFX1NUUkFQX0RESUZfREVURUNURUQp
Cj4gPiAtCQkJaW50ZWxfZGRpX2luaXQoZGV2X3ByaXYsIFBPUlRfRik7Cj4gPiArCQkJaW50ZWxf
ZGRpX2luaXQoaTkxNSwgUE9SVF9GKTsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIE9uIFNLTCB3ZSBk
b24ndCBoYXZlIGEgd2F5IHRvIGRldGVjdCBEREktRSBzbyB3ZSByZWx5IG9uIFZCVC4KPiA+ICAg
CQkgKi8KPiA+IC0JCWlmIChJU19HRU45X0JDKGRldl9wcml2KSAmJgo+ID4gLQkJICAgIGludGVs
X2Jpb3NfaXNfcG9ydF9wcmVzZW50KGRldl9wcml2LCBQT1JUX0UpKQo+ID4gLQkJCWludGVsX2Rk
aV9pbml0KGRldl9wcml2LCBQT1JUX0UpOwo+ID4gKwkJaWYgKElTX0dFTjlfQkMoaTkxNSkgJiYK
PiA+ICsJCSAgICBpbnRlbF9iaW9zX2lzX3BvcnRfcHJlc2VudChpOTE1LCBQT1JUX0UpKQo+ID4g
KwkJCWludGVsX2RkaV9pbml0KGk5MTUsIFBPUlRfRSk7Cj4gPiAtCX0gZWxzZSBpZiAoSEFTX1BD
SF9TUExJVChkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChIQVNfUENIX1NQTElUKGk5MTUp
KSB7Cj4gPiAgIAkJaW50IGZvdW5kOwo+ID4gICAJCS8qCj4gPiBAQCAtMTUxODMsMzkgKzE1MTgz
LDM5IEBAIHN0YXRpYyB2b2lkIGludGVsX3NldHVwX291dHB1dHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gICAJCSAqIHRvIHByZXZlbnQgdGhlIHJlZ2lzdHJhdGlvbiBv
ZiBib3RoIGVEUCBhbmQgTFZEUyBhbmQgdGhlCj4gPiAgIAkJICogaW5jb3JyZWN0IHNoYXJpbmcg
b2YgdGhlIFBQUy4KPiA+ICAgCQkgKi8KPiA+IC0JCWludGVsX2x2ZHNfaW5pdChkZXZfcHJpdik7
Cj4gPiAtCQlpbnRlbF9jcnRfaW5pdChkZXZfcHJpdik7Cj4gPiArCQlpbnRlbF9sdmRzX2luaXQo
aTkxNSk7Cj4gPiArCQlpbnRlbF9jcnRfaW5pdChpOTE1KTsKPiA+IC0JCWRwZF9pc19lZHAgPSBp
bnRlbF9kcF9pc19wb3J0X2VkcChkZXZfcHJpdiwgUE9SVF9EKTsKPiA+ICsJCWRwZF9pc19lZHAg
PSBpbnRlbF9kcF9pc19wb3J0X2VkcChpOTE1LCBQT1JUX0QpOwo+ID4gLQkJaWYgKGlsa19oYXNf
ZWRwX2EoZGV2X3ByaXYpKQo+ID4gLQkJCWludGVsX2RwX2luaXQoZGV2X3ByaXYsIERQX0EsIFBP
UlRfQSk7Cj4gPiArCQlpZiAoaWxrX2hhc19lZHBfYShpOTE1KSkKPiA+ICsJCQlpbnRlbF9kcF9p
bml0KGk5MTUsIERQX0EsIFBPUlRfQSk7Cj4gPiAgIAkJaWYgKEk5MTVfUkVBRChQQ0hfSERNSUIp
ICYgU0RWT19ERVRFQ1RFRCkgewo+ID4gICAJCQkvKiBQQ0ggU0RWT0IgbXVsdGlwbGV4IHdpdGgg
SERNSUIgKi8KPiA+IC0JCQlmb3VuZCA9IGludGVsX3Nkdm9faW5pdChkZXZfcHJpdiwgUENIX1NE
Vk9CLCBQT1JUX0IpOwo+ID4gKwkJCWZvdW5kID0gaW50ZWxfc2R2b19pbml0KGk5MTUsIFBDSF9T
RFZPQiwgUE9SVF9CKTsKPiA+ICAgCQkJaWYgKCFmb3VuZCkKPiA+IC0JCQkJaW50ZWxfaGRtaV9p
bml0KGRldl9wcml2LCBQQ0hfSERNSUIsIFBPUlRfQik7Cj4gPiArCQkJCWludGVsX2hkbWlfaW5p
dChpOTE1LCBQQ0hfSERNSUIsIFBPUlRfQik7Cj4gPiAgIAkJCWlmICghZm91bmQgJiYgKEk5MTVf
UkVBRChQQ0hfRFBfQikgJiBEUF9ERVRFQ1RFRCkpCj4gPiAtCQkJCWludGVsX2RwX2luaXQoZGV2
X3ByaXYsIFBDSF9EUF9CLCBQT1JUX0IpOwo+ID4gKwkJCQlpbnRlbF9kcF9pbml0KGk5MTUsIFBD
SF9EUF9CLCBQT1JUX0IpOwo+ID4gICAJCX0KPiA+ICAgCQlpZiAoSTkxNV9SRUFEKFBDSF9IRE1J
QykgJiBTRFZPX0RFVEVDVEVEKQo+ID4gLQkJCWludGVsX2hkbWlfaW5pdChkZXZfcHJpdiwgUENI
X0hETUlDLCBQT1JUX0MpOwo+ID4gKwkJCWludGVsX2hkbWlfaW5pdChpOTE1LCBQQ0hfSERNSUMs
IFBPUlRfQyk7Cj4gPiAgIAkJaWYgKCFkcGRfaXNfZWRwICYmIEk5MTVfUkVBRChQQ0hfSERNSUQp
ICYgU0RWT19ERVRFQ1RFRCkKPiA+IC0JCQlpbnRlbF9oZG1pX2luaXQoZGV2X3ByaXYsIFBDSF9I
RE1JRCwgUE9SVF9EKTsKPiA+ICsJCQlpbnRlbF9oZG1pX2luaXQoaTkxNSwgUENIX0hETUlELCBQ
T1JUX0QpOwo+ID4gICAJCWlmIChJOTE1X1JFQUQoUENIX0RQX0MpICYgRFBfREVURUNURUQpCj4g
PiAtCQkJaW50ZWxfZHBfaW5pdChkZXZfcHJpdiwgUENIX0RQX0MsIFBPUlRfQyk7Cj4gPiArCQkJ
aW50ZWxfZHBfaW5pdChpOTE1LCBQQ0hfRFBfQywgUE9SVF9DKTsKPiA+ICAgCQlpZiAoSTkxNV9S
RUFEKFBDSF9EUF9EKSAmIERQX0RFVEVDVEVEKQo+ID4gLQkJCWludGVsX2RwX2luaXQoZGV2X3By
aXYsIFBDSF9EUF9ELCBQT1JUX0QpOwo+ID4gLQl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2
X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiArCQkJaW50ZWxfZHBfaW5p
dChpOTE1LCBQQ0hfRFBfRCwgUE9SVF9EKTsKPiA+ICsJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVX
KGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+ICAgCQlib29sIGhhc19lZHAsIGhh
c19wb3J0Owo+ID4gLQkJaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpICYmIGRldl9wcml2LT52
YnQuaW50X2NydF9zdXBwb3J0KQo+ID4gLQkJCWludGVsX2NydF9pbml0KGRldl9wcml2KTsKPiA+
ICsJCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpICYmIGk5MTUtPnZidC5pbnRfY3J0X3N1cHBvcnQp
Cj4gPiArCQkJaW50ZWxfY3J0X2luaXQoaTkxNSk7Cj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBUaGUg
RFBfREVURUNURUQgYml0IGlzIHRoZSBsYXRjaGVkIHN0YXRlIG9mIHRoZSBEREMKPiA+IEBAIC0x
NTIzMiw5NyArMTUyMzIsOTcgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2V0dXBfb3V0cHV0cyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICogdHJ1c3QgdGhlIHBvcnQg
dHlwZSB0aGUgVkJUIGRlY2xhcmVzIGFzIHdlJ3ZlIHNlZW4gYXQgbGVhc3QKPiA+ICAgCQkgKiBI
RE1JIHBvcnRzIHRoYXQgdGhlIFZCVCBjbGFpbSBhcmUgRFAgb3IgZURQLgo+ID4gICAJCSAqLwo+
ID4gLQkJaGFzX2VkcCA9IGludGVsX2RwX2lzX3BvcnRfZWRwKGRldl9wcml2LCBQT1JUX0IpOwo+
ID4gLQkJaGFzX3BvcnQgPSBpbnRlbF9iaW9zX2lzX3BvcnRfcHJlc2VudChkZXZfcHJpdiwgUE9S
VF9CKTsKPiA+ICsJCWhhc19lZHAgPSBpbnRlbF9kcF9pc19wb3J0X2VkcChpOTE1LCBQT1JUX0Ip
Owo+ID4gKwkJaGFzX3BvcnQgPSBpbnRlbF9iaW9zX2lzX3BvcnRfcHJlc2VudChpOTE1LCBQT1JU
X0IpOwo+ID4gICAJCWlmIChJOTE1X1JFQUQoVkxWX0RQX0IpICYgRFBfREVURUNURUQgfHwgaGFz
X3BvcnQpCj4gPiAtCQkJaGFzX2VkcCAmPSBpbnRlbF9kcF9pbml0KGRldl9wcml2LCBWTFZfRFBf
QiwgUE9SVF9CKTsKPiA+ICsJCQloYXNfZWRwICY9IGludGVsX2RwX2luaXQoaTkxNSwgVkxWX0RQ
X0IsIFBPUlRfQik7Cj4gPiAgIAkJaWYgKChJOTE1X1JFQUQoVkxWX0hETUlCKSAmIFNEVk9fREVU
RUNURUQgfHwgaGFzX3BvcnQpICYmICFoYXNfZWRwKQo+ID4gLQkJCWludGVsX2hkbWlfaW5pdChk
ZXZfcHJpdiwgVkxWX0hETUlCLCBQT1JUX0IpOwo+ID4gKwkJCWludGVsX2hkbWlfaW5pdChpOTE1
LCBWTFZfSERNSUIsIFBPUlRfQik7Cj4gPiAtCQloYXNfZWRwID0gaW50ZWxfZHBfaXNfcG9ydF9l
ZHAoZGV2X3ByaXYsIFBPUlRfQyk7Cj4gPiAtCQloYXNfcG9ydCA9IGludGVsX2Jpb3NfaXNfcG9y
dF9wcmVzZW50KGRldl9wcml2LCBQT1JUX0MpOwo+ID4gKwkJaGFzX2VkcCA9IGludGVsX2RwX2lz
X3BvcnRfZWRwKGk5MTUsIFBPUlRfQyk7Cj4gPiArCQloYXNfcG9ydCA9IGludGVsX2Jpb3NfaXNf
cG9ydF9wcmVzZW50KGk5MTUsIFBPUlRfQyk7Cj4gPiAgIAkJaWYgKEk5MTVfUkVBRChWTFZfRFBf
QykgJiBEUF9ERVRFQ1RFRCB8fCBoYXNfcG9ydCkKPiA+IC0JCQloYXNfZWRwICY9IGludGVsX2Rw
X2luaXQoZGV2X3ByaXYsIFZMVl9EUF9DLCBQT1JUX0MpOwo+ID4gKwkJCWhhc19lZHAgJj0gaW50
ZWxfZHBfaW5pdChpOTE1LCBWTFZfRFBfQywgUE9SVF9DKTsKPiA+ICAgCQlpZiAoKEk5MTVfUkVB
RChWTFZfSERNSUMpICYgU0RWT19ERVRFQ1RFRCB8fCBoYXNfcG9ydCkgJiYgIWhhc19lZHApCj4g
PiAtCQkJaW50ZWxfaGRtaV9pbml0KGRldl9wcml2LCBWTFZfSERNSUMsIFBPUlRfQyk7Cj4gPiAr
CQkJaW50ZWxfaGRtaV9pbml0KGk5MTUsIFZMVl9IRE1JQywgUE9SVF9DKTsKPiA+IC0JCWlmIChJ
U19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4gKwkJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkp
IHsKPiA+ICAgCQkJLyoKPiA+ICAgCQkJICogZURQIG5vdCBzdXBwb3J0ZWQgb24gcG9ydCBELAo+
ID4gICAJCQkgKiBzbyBubyBuZWVkIHRvIHdvcnJ5IGFib3V0IGl0Cj4gPiAgIAkJCSAqLwo+ID4g
LQkJCWhhc19wb3J0ID0gaW50ZWxfYmlvc19pc19wb3J0X3ByZXNlbnQoZGV2X3ByaXYsIFBPUlRf
RCk7Cj4gPiArCQkJaGFzX3BvcnQgPSBpbnRlbF9iaW9zX2lzX3BvcnRfcHJlc2VudChpOTE1LCBQ
T1JUX0QpOwo+ID4gICAJCQlpZiAoSTkxNV9SRUFEKENIVl9EUF9EKSAmIERQX0RFVEVDVEVEIHx8
IGhhc19wb3J0KQo+ID4gLQkJCQlpbnRlbF9kcF9pbml0KGRldl9wcml2LCBDSFZfRFBfRCwgUE9S
VF9EKTsKPiA+ICsJCQkJaW50ZWxfZHBfaW5pdChpOTE1LCBDSFZfRFBfRCwgUE9SVF9EKTsKPiA+
ICAgCQkJaWYgKEk5MTVfUkVBRChDSFZfSERNSUQpICYgU0RWT19ERVRFQ1RFRCB8fCBoYXNfcG9y
dCkKPiA+IC0JCQkJaW50ZWxfaGRtaV9pbml0KGRldl9wcml2LCBDSFZfSERNSUQsIFBPUlRfRCk7
Cj4gPiArCQkJCWludGVsX2hkbWlfaW5pdChpOTE1LCBDSFZfSERNSUQsIFBPUlRfRCk7Cj4gPiAg
IAkJfQo+ID4gLQkJdmx2X2RzaV9pbml0KGRldl9wcml2KTsKPiA+IC0JfSBlbHNlIGlmIChJU19Q
SU5FVklFVyhkZXZfcHJpdikpIHsKPiA+IC0JCWludGVsX2x2ZHNfaW5pdChkZXZfcHJpdik7Cj4g
PiAtCQlpbnRlbF9jcnRfaW5pdChkZXZfcHJpdik7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfR0VOX1JB
TkdFKGRldl9wcml2LCAzLCA0KSkgewo+ID4gKwkJdmx2X2RzaV9pbml0KGk5MTUpOwo+ID4gKwl9
IGVsc2UgaWYgKElTX1BJTkVWSUVXKGk5MTUpKSB7Cj4gPiArCQlpbnRlbF9sdmRzX2luaXQoaTkx
NSk7Cj4gPiArCQlpbnRlbF9jcnRfaW5pdChpOTE1KTsKPiA+ICsJfSBlbHNlIGlmIChJU19HRU5f
UkFOR0UoaTkxNSwgMywgNCkpIHsKPiA+ICAgCQlib29sIGZvdW5kID0gZmFsc2U7Cj4gPiAtCQlp
ZiAoSVNfTU9CSUxFKGRldl9wcml2KSkKPiA+IC0JCQlpbnRlbF9sdmRzX2luaXQoZGV2X3ByaXYp
Owo+ID4gKwkJaWYgKElTX01PQklMRShpOTE1KSkKPiA+ICsJCQlpbnRlbF9sdmRzX2luaXQoaTkx
NSk7Cj4gPiAtCQlpbnRlbF9jcnRfaW5pdChkZXZfcHJpdik7Cj4gPiArCQlpbnRlbF9jcnRfaW5p
dChpOTE1KTsKPiA+ICAgCQlpZiAoSTkxNV9SRUFEKEdFTjNfU0RWT0IpICYgU0RWT19ERVRFQ1RF
RCkgewo+ID4gICAJCQlEUk1fREVCVUdfS01TKCJwcm9iaW5nIFNEVk9CXG4iKTsKPiA+IC0JCQlm
b3VuZCA9IGludGVsX3Nkdm9faW5pdChkZXZfcHJpdiwgR0VOM19TRFZPQiwgUE9SVF9CKTsKPiA+
IC0JCQlpZiAoIWZvdW5kICYmIElTX0c0WChkZXZfcHJpdikpIHsKPiA+ICsJCQlmb3VuZCA9IGlu
dGVsX3Nkdm9faW5pdChpOTE1LCBHRU4zX1NEVk9CLCBQT1JUX0IpOwo+ID4gKwkJCWlmICghZm91
bmQgJiYgSVNfRzRYKGk5MTUpKSB7Cj4gPiAgIAkJCQlEUk1fREVCVUdfS01TKCJwcm9iaW5nIEhE
TUkgb24gU0RWT0JcbiIpOwo+ID4gLQkJCQlpbnRlbF9oZG1pX2luaXQoZGV2X3ByaXYsIEdFTjRf
SERNSUIsIFBPUlRfQik7Cj4gPiArCQkJCWludGVsX2hkbWlfaW5pdChpOTE1LCBHRU40X0hETUlC
LCBQT1JUX0IpOwo+ID4gICAJCQl9Cj4gPiAtCQkJaWYgKCFmb3VuZCAmJiBJU19HNFgoZGV2X3By
aXYpKQo+ID4gLQkJCQlpbnRlbF9kcF9pbml0KGRldl9wcml2LCBEUF9CLCBQT1JUX0IpOwo+ID4g
KwkJCWlmICghZm91bmQgJiYgSVNfRzRYKGk5MTUpKQo+ID4gKwkJCQlpbnRlbF9kcF9pbml0KGk5
MTUsIERQX0IsIFBPUlRfQik7Cj4gPiAgIAkJfQo+ID4gICAJCS8qIEJlZm9yZSBHNFggU0RWT0Mg
ZG9lc24ndCBoYXZlIGl0cyBvd24gZGV0ZWN0IHJlZ2lzdGVyICovCj4gPiAgIAkJaWYgKEk5MTVf
UkVBRChHRU4zX1NEVk9CKSAmIFNEVk9fREVURUNURUQpIHsKPiA+ICAgCQkJRFJNX0RFQlVHX0tN
UygicHJvYmluZyBTRFZPQ1xuIik7Cj4gPiAtCQkJZm91bmQgPSBpbnRlbF9zZHZvX2luaXQoZGV2
X3ByaXYsIEdFTjNfU0RWT0MsIFBPUlRfQyk7Cj4gPiArCQkJZm91bmQgPSBpbnRlbF9zZHZvX2lu
aXQoaTkxNSwgR0VOM19TRFZPQywgUE9SVF9DKTsKPiA+ICAgCQl9Cj4gPiAgIAkJaWYgKCFmb3Vu
ZCAmJiAoSTkxNV9SRUFEKEdFTjNfU0RWT0MpICYgU0RWT19ERVRFQ1RFRCkpIHsKPiA+IC0JCQlp
ZiAoSVNfRzRYKGRldl9wcml2KSkgewo+ID4gKwkJCWlmIChJU19HNFgoaTkxNSkpIHsKPiA+ICAg
CQkJCURSTV9ERUJVR19LTVMoInByb2JpbmcgSERNSSBvbiBTRFZPQ1xuIik7Cj4gPiAtCQkJCWlu
dGVsX2hkbWlfaW5pdChkZXZfcHJpdiwgR0VONF9IRE1JQywgUE9SVF9DKTsKPiA+ICsJCQkJaW50
ZWxfaGRtaV9pbml0KGk5MTUsIEdFTjRfSERNSUMsIFBPUlRfQyk7Cj4gPiAgIAkJCX0KPiA+IC0J
CQlpZiAoSVNfRzRYKGRldl9wcml2KSkKPiA+IC0JCQkJaW50ZWxfZHBfaW5pdChkZXZfcHJpdiwg
RFBfQywgUE9SVF9DKTsKPiA+ICsJCQlpZiAoSVNfRzRYKGk5MTUpKQo+ID4gKwkJCQlpbnRlbF9k
cF9pbml0KGk5MTUsIERQX0MsIFBPUlRfQyk7Cj4gPiAgIAkJfQo+ID4gLQkJaWYgKElTX0c0WChk
ZXZfcHJpdikgJiYgKEk5MTVfUkVBRChEUF9EKSAmIERQX0RFVEVDVEVEKSkKPiA+IC0JCQlpbnRl
bF9kcF9pbml0KGRldl9wcml2LCBEUF9ELCBQT1JUX0QpOwo+ID4gKwkJaWYgKElTX0c0WChpOTE1
KSAmJiAoSTkxNV9SRUFEKERQX0QpICYgRFBfREVURUNURUQpKQo+ID4gKwkJCWludGVsX2RwX2lu
aXQoaTkxNSwgRFBfRCwgUE9SVF9EKTsKPiA+IC0JCWlmIChTVVBQT1JUU19UVihkZXZfcHJpdikp
Cj4gPiAtCQkJaW50ZWxfdHZfaW5pdChkZXZfcHJpdik7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfR0VO
KGRldl9wcml2LCAyKSkgewo+ID4gLQkJaWYgKElTX0k4NVgoZGV2X3ByaXYpKQo+ID4gLQkJCWlu
dGVsX2x2ZHNfaW5pdChkZXZfcHJpdik7Cj4gPiArCQlpZiAoU1VQUE9SVFNfVFYoaTkxNSkpCj4g
PiArCQkJaW50ZWxfdHZfaW5pdChpOTE1KTsKPiA+ICsJfSBlbHNlIGlmIChJU19HRU4oaTkxNSwg
MikpIHsKPiA+ICsJCWlmIChJU19JODVYKGk5MTUpKQo+ID4gKwkJCWludGVsX2x2ZHNfaW5pdChp
OTE1KTsKPiA+IC0JCWludGVsX2NydF9pbml0KGRldl9wcml2KTsKPiA+IC0JCWludGVsX2R2b19p
bml0KGRldl9wcml2KTsKPiA+ICsJCWludGVsX2NydF9pbml0KGk5MTUpOwo+ID4gKwkJaW50ZWxf
ZHZvX2luaXQoaTkxNSk7Cj4gPiAgIAl9Cj4gPiAtCWludGVsX3Bzcl9pbml0KGRldl9wcml2KTsK
PiA+ICsJaW50ZWxfcHNyX2luaXQoaTkxNSk7Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2VuY29kZXIo
JmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsKPiA+ICsJZm9yX2VhY2hfaW50ZWxfZW5jb2Rlcigm
aTkxNS0+ZHJtLCBlbmNvZGVyKSB7Cj4gPiAgIAkJZW5jb2Rlci0+YmFzZS5wb3NzaWJsZV9jcnRj
cyA9IGVuY29kZXItPmNydGNfbWFzazsKPiA+ICAgCQllbmNvZGVyLT5iYXNlLnBvc3NpYmxlX2Ns
b25lcyA9Cj4gPiAgIAkJCWludGVsX2VuY29kZXJfY2xvbmVzKGVuY29kZXIpOwo+ID4gICAJfQo+
ID4gLQlpbnRlbF9pbml0X3BjaF9yZWZjbGsoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9pbml0X3Bj
aF9yZWZjbGsoaTkxNSk7Cj4gPiAtCWRybV9oZWxwZXJfbW92ZV9wYW5lbF9jb25uZWN0b3JzX3Rv
X2hlYWQoJmRldl9wcml2LT5kcm0pOwo+ID4gKwlkcm1faGVscGVyX21vdmVfcGFuZWxfY29ubmVj
dG9yc190b19oZWFkKCZpOTE1LT5kcm0pOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGludGVs
X3VzZXJfZnJhbWVidWZmZXJfZGVzdHJveShzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYikKPiA+
IEBAIC0xNTM3OSw3ICsxNTM3OSw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZnJhbWVidWZmZXJfaW5p
dChzdHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIgKmludGVsX2ZiLAo+ID4gICAJCQkJICBzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+ID4gICAJCQkJICBzdHJ1Y3QgZHJtX21vZGVfZmJf
Y21kMiAqbW9kZV9jbWQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGRybV9m
cmFtZWJ1ZmZlciAqZmIgPSAmaW50ZWxfZmItPmJhc2U7Cj4gPiAgIAl1MzIgbWF4X3N0cmlkZTsK
PiA+ICAgCXVuc2lnbmVkIGludCB0aWxpbmcsIHN0cmlkZTsKPiA+IEBAIC0xNTQxMSw3ICsxNTQx
MSw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZnJhbWVidWZmZXJfaW5pdChzdHJ1Y3QgaW50ZWxfZnJh
bWVidWZmZXIgKmludGVsX2ZiLAo+ID4gICAJCX0KPiA+ICAgCX0KPiA+IC0JaWYgKCFkcm1fYW55
X3BsYW5lX2hhc19mb3JtYXQoJmRldl9wcml2LT5kcm0sCj4gPiArCWlmICghZHJtX2FueV9wbGFu
ZV9oYXNfZm9ybWF0KCZpOTE1LT5kcm0sCj4gPiAgIAkJCQkgICAgICBtb2RlX2NtZC0+cGl4ZWxf
Zm9ybWF0LAo+ID4gICAJCQkJICAgICAgbW9kZV9jbWQtPm1vZGlmaWVyWzBdKSkgewo+ID4gICAJ
CXN0cnVjdCBkcm1fZm9ybWF0X25hbWVfYnVmIGZvcm1hdF9uYW1lOwo+ID4gQEAgLTE1NDI3LDEz
ICsxNTQyNywxMyBAQCBzdGF0aWMgaW50IGludGVsX2ZyYW1lYnVmZmVyX2luaXQoc3RydWN0IGlu
dGVsX2ZyYW1lYnVmZmVyICppbnRlbF9mYiwKPiA+ICAgCSAqIGdlbjIvMyBkaXNwbGF5IGVuZ2lu
ZSB1c2VzIHRoZSBmZW5jZSBpZiBwcmVzZW50LAo+ID4gICAJICogc28gdGhlIHRpbGluZyBtb2Rl
IG11c3QgbWF0Y2ggdGhlIGZiIG1vZGlmaWVyIGV4YWN0bHkuCj4gPiAgIAkgKi8KPiA+IC0JaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPCA0ICYmCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA0
ICYmCj4gPiAgIAkgICAgdGlsaW5nICE9IGludGVsX2ZiX21vZGlmaWVyX3RvX3RpbGluZyhtb2Rl
X2NtZC0+bW9kaWZpZXJbMF0pKSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygidGlsaW5nX21vZGUg
bXVzdCBtYXRjaCBmYiBtb2RpZmllciBleGFjdGx5IG9uIGdlbjIvM1xuIik7Cj4gPiAgIAkJZ290
byBlcnI7Cj4gPiAgIAl9Cj4gPiAtCW1heF9zdHJpZGUgPSBpbnRlbF9mYl9tYXhfc3RyaWRlKGRl
dl9wcml2LCBtb2RlX2NtZC0+cGl4ZWxfZm9ybWF0LAo+ID4gKwltYXhfc3RyaWRlID0gaW50ZWxf
ZmJfbWF4X3N0cmlkZShpOTE1LCBtb2RlX2NtZC0+cGl4ZWxfZm9ybWF0LAo+ID4gICAJCQkJCSBt
b2RlX2NtZC0+bW9kaWZpZXJbMF0pOwo+ID4gICAJaWYgKG1vZGVfY21kLT5waXRjaGVzWzBdID4g
bWF4X3N0cmlkZSkgewo+ID4gICAJCURSTV9ERUJVR19LTVMoIiVzIHBpdGNoICgldSkgbXVzdCBi
ZSBhdCBtb3N0ICVkXG4iLAo+ID4gQEAgLTE1NDU3LDcgKzE1NDU3LDcgQEAgc3RhdGljIGludCBp
bnRlbF9mcmFtZWJ1ZmZlcl9pbml0KHN0cnVjdCBpbnRlbF9mcmFtZWJ1ZmZlciAqaW50ZWxfZmIs
Cj4gPiAgIAlpZiAobW9kZV9jbWQtPm9mZnNldHNbMF0gIT0gMCkKPiA+ICAgCQlnb3RvIGVycjsK
PiA+IC0JZHJtX2hlbHBlcl9tb2RlX2ZpbGxfZmJfc3RydWN0KCZkZXZfcHJpdi0+ZHJtLCBmYiwg
bW9kZV9jbWQpOwo+ID4gKwlkcm1faGVscGVyX21vZGVfZmlsbF9mYl9zdHJ1Y3QoJmk5MTUtPmRy
bSwgZmIsIG1vZGVfY21kKTsKPiA+ICAgCWZvciAoaSA9IDA7IGkgPCBmYi0+Zm9ybWF0LT5udW1f
cGxhbmVzOyBpKyspIHsKPiA+ICAgCQl1MzIgc3RyaWRlX2FsaWdubWVudDsKPiA+IEBAIC0xNTQ3
OCw3ICsxNTQ3OCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZnJhbWVidWZmZXJfaW5pdChzdHJ1Y3Qg
aW50ZWxfZnJhbWVidWZmZXIgKmludGVsX2ZiLAo+ID4gICAJCSAqIHJlcXVpcmUgdGhlIGVudGly
ZSBmYiB0byBhY2NvbW1vZGF0ZSB0aGF0IHRvIGF2b2lkCj4gPiAgIAkJICogcG90ZW50aWFsIHJ1
bnRpbWUgZXJyb3JzIGF0IHBsYW5lIGNvbmZpZ3VyYXRpb24gdGltZS4KPiA+ICAgCQkgKi8KPiA+
IC0JCWlmIChJU19HRU4oZGV2X3ByaXYsIDkpICYmIGkgPT0gMCAmJiBmYi0+d2lkdGggPiAzODQw
ICYmCj4gPiArCQlpZiAoSVNfR0VOKGk5MTUsIDkpICYmIGkgPT0gMCAmJiBmYi0+d2lkdGggPiAz
ODQwICYmCj4gPiAgIAkJICAgIGlzX2Njc19tb2RpZmllcihmYi0+bW9kaWZpZXIpKQo+ID4gICAJ
CQlzdHJpZGVfYWxpZ25tZW50ICo9IDQ7Cj4gPiBAQCAtMTU0OTEsMTEgKzE1NDkxLDExIEBAIHN0
YXRpYyBpbnQgaW50ZWxfZnJhbWVidWZmZXJfaW5pdChzdHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIg
KmludGVsX2ZiLAo+ID4gICAJCWZiLT5vYmpbaV0gPSAmb2JqLT5iYXNlOwo+ID4gICAJfQo+ID4g
LQlyZXQgPSBpbnRlbF9maWxsX2ZiX2luZm8oZGV2X3ByaXYsIGZiKTsKPiA+ICsJcmV0ID0gaW50
ZWxfZmlsbF9mYl9pbmZvKGk5MTUsIGZiKTsKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJZ290byBl
cnI7Cj4gPiAtCXJldCA9IGRybV9mcmFtZWJ1ZmZlcl9pbml0KCZkZXZfcHJpdi0+ZHJtLCBmYiwg
JmludGVsX2ZiX2Z1bmNzKTsKPiA+ICsJcmV0ID0gZHJtX2ZyYW1lYnVmZmVyX2luaXQoJmk5MTUt
PmRybSwgZmIsICZpbnRlbF9mYl9mdW5jcyk7Cj4gPiAgIAlpZiAocmV0KSB7Cj4gPiAgIAkJRFJN
X0VSUk9SKCJmcmFtZWJ1ZmZlciBpbml0IGZhaWxlZCAlZFxuIiwgcmV0KTsKPiA+ICAgCQlnb3Rv
IGVycjsKPiA+IEBAIC0xNTU0NSw3ICsxNTU0NSw3IEBAIHN0YXRpYyBlbnVtIGRybV9tb2RlX3N0
YXR1cwo+ID4gICBpbnRlbF9tb2RlX3ZhbGlkKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAg
IAkJIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlpbnQgaGRp
c3BsYXlfbWF4LCBodG90YWxfbWF4Owo+ID4gICAJaW50IHZkaXNwbGF5X21heCwgdnRvdGFsX21h
eDsKPiA+IEBAIC0xNTU3OCwxMyArMTU1NzgsMTMgQEAgaW50ZWxfbW9kZV92YWxpZChzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LAo+ID4gICAJCQkgICBEUk1fTU9ERV9GTEFHX0NMS0RJVjIpKQo+ID4g
ICAJCXJldHVybiBNT0RFX0JBRDsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSB8
fAo+ID4gLQkgICAgSVNfQlJPQURXRUxMKGRldl9wcml2KSB8fCBJU19IQVNXRUxMKGRldl9wcml2
KSkgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkgfHwKPiA+ICsJICAgIElTX0JST0FE
V0VMTChpOTE1KSB8fCBJU19IQVNXRUxMKGk5MTUpKSB7Cj4gPiAgIAkJaGRpc3BsYXlfbWF4ID0g
ODE5MjsgLyogRkRJIG1heCA0MDk2IGhhbmRsZWQgZWxzZXdoZXJlICovCj4gPiAgIAkJdmRpc3Bs
YXlfbWF4ID0gNDA5NjsKPiA+ICAgCQlodG90YWxfbWF4ID0gODE5MjsKPiA+ICAgCQl2dG90YWxf
bWF4ID0gODE5MjsKPiA+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDMpIHsK
PiA+ICsJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMykgewo+ID4gICAJCWhkaXNwbGF5
X21heCA9IDQwOTY7Cj4gPiAgIAkJdmRpc3BsYXlfbWF4ID0gNDA5NjsKPiA+ICAgCQlodG90YWxf
bWF4ID0gODE5MjsKPiA+IEBAIC0xNTYyNSwxMTMgKzE1NjI1LDExMyBAQCBzdGF0aWMgY29uc3Qg
c3RydWN0IGRybV9tb2RlX2NvbmZpZ19mdW5jcyBpbnRlbF9tb2RlX2Z1bmNzID0gewo+ID4gICAv
KioKPiA+ICAgICogaW50ZWxfaW5pdF9kaXNwbGF5X2hvb2tzIC0gaW5pdGlhbGl6ZSB0aGUgZGlz
cGxheSBtb2Rlc2V0dGluZyBob29rcwo+ID4gLSAqIEBkZXZfcHJpdjogZGV2aWNlIHByaXZhdGUK
PiA+ICsgKiBAaTkxNTogZGV2aWNlIHByaXZhdGUKPiA+ICAgICovCj4gPiAtdm9pZCBpbnRlbF9p
bml0X2Rpc3BsYXlfaG9va3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K3ZvaWQgaW50ZWxfaW5pdF9kaXNwbGF5X2hvb2tzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAtCWludGVsX2luaXRfY2RjbGtfaG9va3MoZGV2X3ByaXYpOwo+ID4g
KwlpbnRlbF9pbml0X2NkY2xrX2hvb2tzKGk5MTUpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA5KSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWcgPSBo
YXN3ZWxsX2dldF9waXBlX2NvbmZpZzsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9pbml0
aWFsX3BsYW5lX2NvbmZpZyA9Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ID4g
KwkJaTkxNS0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWcgPSBoYXN3ZWxsX2dldF9waXBlX2NvbmZp
ZzsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnID0KPiA+ICAg
CQkJc2t5bGFrZV9nZXRfaW5pdGlhbF9wbGFuZV9jb25maWc7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlz
cGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgPQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5jcnRjX2NvbXB1
dGVfY2xvY2sgPQo+ID4gICAJCQloYXN3ZWxsX2NydGNfY29tcHV0ZV9jbG9jazsKPiA+IC0JCWRl
dl9wcml2LT5kaXNwbGF5LmNydGNfZW5hYmxlID0gaGFzd2VsbF9jcnRjX2VuYWJsZTsKPiA+IC0J
CWRldl9wcml2LT5kaXNwbGF5LmNydGNfZGlzYWJsZSA9IGhhc3dlbGxfY3J0Y19kaXNhYmxlOwo+
ID4gLQl9IGVsc2UgaWYgKEhBU19EREkoZGV2X3ByaXYpKSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlz
cGxheS5nZXRfcGlwZV9jb25maWcgPSBoYXN3ZWxsX2dldF9waXBlX2NvbmZpZzsKPiA+IC0JCWRl
dl9wcml2LT5kaXNwbGF5LmdldF9pbml0aWFsX3BsYW5lX2NvbmZpZyA9Cj4gPiArCQlpOTE1LT5k
aXNwbGF5LmNydGNfZW5hYmxlID0gaGFzd2VsbF9jcnRjX2VuYWJsZTsKPiA+ICsJCWk5MTUtPmRp
c3BsYXkuY3J0Y19kaXNhYmxlID0gaGFzd2VsbF9jcnRjX2Rpc2FibGU7Cj4gPiArCX0gZWxzZSBp
ZiAoSEFTX0RESShpOTE1KSkgewo+ID4gKwkJaTkxNS0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWcg
PSBoYXN3ZWxsX2dldF9waXBlX2NvbmZpZzsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2luaXRp
YWxfcGxhbmVfY29uZmlnID0KPiA+ICAgCQkJaTl4eF9nZXRfaW5pdGlhbF9wbGFuZV9jb25maWc7
Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgPQo+ID4gKwkJaTkx
NS0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgPQo+ID4gICAJCQloYXN3ZWxsX2NydGNfY29t
cHV0ZV9jbG9jazsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNydGNfZW5hYmxlID0gaGFzd2Vs
bF9jcnRjX2VuYWJsZTsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNydGNfZGlzYWJsZSA9IGhh
c3dlbGxfY3J0Y19kaXNhYmxlOwo+ID4gLQl9IGVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3By
aXYpKSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWcgPSBpcm9ubGFr
ZV9nZXRfcGlwZV9jb25maWc7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfaW5pdGlhbF9w
bGFuZV9jb25maWcgPQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5jcnRjX2VuYWJsZSA9IGhhc3dlbGxf
Y3J0Y19lbmFibGU7Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfZGlzYWJsZSA9IGhhc3dlbGxf
Y3J0Y19kaXNhYmxlOwo+ID4gKwl9IGVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpIHsKPiA+
ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmlnID0gaXJvbmxha2VfZ2V0X3BpcGVfY29u
ZmlnOwo+ID4gKwkJaTkxNS0+ZGlzcGxheS5nZXRfaW5pdGlhbF9wbGFuZV9jb25maWcgPQo+ID4g
ICAJCQlpOXh4X2dldF9pbml0aWFsX3BsYW5lX2NvbmZpZzsKPiA+IC0JCWRldl9wcml2LT5kaXNw
bGF5LmNydGNfY29tcHV0ZV9jbG9jayA9Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfY29tcHV0
ZV9jbG9jayA9Cj4gPiAgIAkJCWlyb25sYWtlX2NydGNfY29tcHV0ZV9jbG9jazsKPiA+IC0JCWRl
dl9wcml2LT5kaXNwbGF5LmNydGNfZW5hYmxlID0gaXJvbmxha2VfY3J0Y19lbmFibGU7Cj4gPiAt
CQlkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2Rpc2FibGUgPSBpcm9ubGFrZV9jcnRjX2Rpc2FibGU7
Cj4gPiAtCX0gZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+IC0JCWRldl9w
cml2LT5kaXNwbGF5LmdldF9waXBlX2NvbmZpZyA9IGk5eHhfZ2V0X3BpcGVfY29uZmlnOwo+ID4g
LQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnID0KPiA+ICsJCWk5
MTUtPmRpc3BsYXkuY3J0Y19lbmFibGUgPSBpcm9ubGFrZV9jcnRjX2VuYWJsZTsKPiA+ICsJCWk5
MTUtPmRpc3BsYXkuY3J0Y19kaXNhYmxlID0gaXJvbmxha2VfY3J0Y19kaXNhYmxlOwo+ID4gKwl9
IGVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0
X3BpcGVfY29uZmlnID0gaTl4eF9nZXRfcGlwZV9jb25maWc7Cj4gPiArCQlpOTE1LT5kaXNwbGF5
LmdldF9pbml0aWFsX3BsYW5lX2NvbmZpZyA9Cj4gPiAgIAkJCWk5eHhfZ2V0X2luaXRpYWxfcGxh
bmVfY29uZmlnOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19jb21wdXRlX2Nsb2NrID0g
Y2h2X2NydGNfY29tcHV0ZV9jbG9jazsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNydGNfZW5h
YmxlID0gdmFsbGV5dmlld19jcnRjX2VuYWJsZTsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNy
dGNfZGlzYWJsZSA9IGk5eHhfY3J0Y19kaXNhYmxlOwo+ID4gLQl9IGVsc2UgaWYgKElTX1ZBTExF
WVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfcGlwZV9jb25m
aWcgPSBpOXh4X2dldF9waXBlX2NvbmZpZzsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9p
bml0aWFsX3BsYW5lX2NvbmZpZyA9Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfY29tcHV0ZV9j
bG9jayA9IGNodl9jcnRjX2NvbXB1dGVfY2xvY2s7Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmNydGNf
ZW5hYmxlID0gdmFsbGV5dmlld19jcnRjX2VuYWJsZTsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuY3J0
Y19kaXNhYmxlID0gaTl4eF9jcnRjX2Rpc2FibGU7Cj4gPiArCX0gZWxzZSBpZiAoSVNfVkFMTEVZ
VklFVyhpOTE1KSkgewo+ID4gKwkJaTkxNS0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWcgPSBpOXh4
X2dldF9waXBlX2NvbmZpZzsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVf
Y29uZmlnID0KPiA+ICAgCQkJaTl4eF9nZXRfaW5pdGlhbF9wbGFuZV9jb25maWc7Cj4gPiAtCQlk
ZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgPSB2bHZfY3J0Y19jb21wdXRlX2Ns
b2NrOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19lbmFibGUgPSB2YWxsZXl2aWV3X2Ny
dGNfZW5hYmxlOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0Y19kaXNhYmxlID0gaTl4eF9j
cnRjX2Rpc2FibGU7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfRzRYKGRldl9wcml2KSkgewo+ID4gLQkJ
ZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmlnID0gaTl4eF9nZXRfcGlwZV9jb25maWc7
Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfaW5pdGlhbF9wbGFuZV9jb25maWcgPQo+ID4g
KwkJaTkxNS0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgPSB2bHZfY3J0Y19jb21wdXRlX2Ns
b2NrOwo+ID4gKwkJaTkxNS0+ZGlzcGxheS5jcnRjX2VuYWJsZSA9IHZhbGxleXZpZXdfY3J0Y19l
bmFibGU7Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfZGlzYWJsZSA9IGk5eHhfY3J0Y19kaXNh
YmxlOwo+ID4gKwl9IGVsc2UgaWYgKElTX0c0WChpOTE1KSkgewo+ID4gKwkJaTkxNS0+ZGlzcGxh
eS5nZXRfcGlwZV9jb25maWcgPSBpOXh4X2dldF9waXBlX2NvbmZpZzsKPiA+ICsJCWk5MTUtPmRp
c3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnID0KPiA+ICAgCQkJaTl4eF9nZXRfaW5pdGlh
bF9wbGFuZV9jb25maWc7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xv
Y2sgPSBnNHhfY3J0Y19jb21wdXRlX2Nsb2NrOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0
Y19lbmFibGUgPSBpOXh4X2NydGNfZW5hYmxlOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY3J0
Y19kaXNhYmxlID0gaTl4eF9jcnRjX2Rpc2FibGU7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfUElORVZJ
RVcoZGV2X3ByaXYpKSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfcGlwZV9jb25maWcg
PSBpOXh4X2dldF9waXBlX2NvbmZpZzsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmdldF9pbml0
aWFsX3BsYW5lX2NvbmZpZyA9Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfY29tcHV0ZV9jbG9j
ayA9IGc0eF9jcnRjX2NvbXB1dGVfY2xvY2s7Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmNydGNfZW5h
YmxlID0gaTl4eF9jcnRjX2VuYWJsZTsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuY3J0Y19kaXNhYmxl
ID0gaTl4eF9jcnRjX2Rpc2FibGU7Cj4gPiArCX0gZWxzZSBpZiAoSVNfUElORVZJRVcoaTkxNSkp
IHsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X3BpcGVfY29uZmlnID0gaTl4eF9nZXRfcGlwZV9j
b25maWc7Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmdldF9pbml0aWFsX3BsYW5lX2NvbmZpZyA9Cj4g
PiAgIAkJCWk5eHhfZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnOwo+ID4gLQkJZGV2X3ByaXYtPmRp
c3BsYXkuY3J0Y19jb21wdXRlX2Nsb2NrID0gcG52X2NydGNfY29tcHV0ZV9jbG9jazsKPiA+IC0J
CWRldl9wcml2LT5kaXNwbGF5LmNydGNfZW5hYmxlID0gaTl4eF9jcnRjX2VuYWJsZTsKPiA+IC0J
CWRldl9wcml2LT5kaXNwbGF5LmNydGNfZGlzYWJsZSA9IGk5eHhfY3J0Y19kaXNhYmxlOwo+ID4g
LQl9IGVsc2UgaWYgKCFJU19HRU4oZGV2X3ByaXYsIDIpKSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlz
cGxheS5nZXRfcGlwZV9jb25maWcgPSBpOXh4X2dldF9waXBlX2NvbmZpZzsKPiA+IC0JCWRldl9w
cml2LT5kaXNwbGF5LmdldF9pbml0aWFsX3BsYW5lX2NvbmZpZyA9Cj4gPiArCQlpOTE1LT5kaXNw
bGF5LmNydGNfY29tcHV0ZV9jbG9jayA9IHBudl9jcnRjX2NvbXB1dGVfY2xvY2s7Cj4gPiArCQlp
OTE1LT5kaXNwbGF5LmNydGNfZW5hYmxlID0gaTl4eF9jcnRjX2VuYWJsZTsKPiA+ICsJCWk5MTUt
PmRpc3BsYXkuY3J0Y19kaXNhYmxlID0gaTl4eF9jcnRjX2Rpc2FibGU7Cj4gPiArCX0gZWxzZSBp
ZiAoIUlTX0dFTihpOTE1LCAyKSkgewo+ID4gKwkJaTkxNS0+ZGlzcGxheS5nZXRfcGlwZV9jb25m
aWcgPSBpOXh4X2dldF9waXBlX2NvbmZpZzsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2luaXRp
YWxfcGxhbmVfY29uZmlnID0KPiA+ICAgCQkJaTl4eF9nZXRfaW5pdGlhbF9wbGFuZV9jb25maWc7
Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgPSBpOXh4X2NydGNf
Y29tcHV0ZV9jbG9jazsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNydGNfZW5hYmxlID0gaTl4
eF9jcnRjX2VuYWJsZTsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNydGNfZGlzYWJsZSA9IGk5
eHhfY3J0Y19kaXNhYmxlOwo+ID4gKwkJaTkxNS0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sg
PSBpOXh4X2NydGNfY29tcHV0ZV9jbG9jazsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuY3J0Y19lbmFi
bGUgPSBpOXh4X2NydGNfZW5hYmxlOwo+ID4gKwkJaTkxNS0+ZGlzcGxheS5jcnRjX2Rpc2FibGUg
PSBpOXh4X2NydGNfZGlzYWJsZTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlz
cGxheS5nZXRfcGlwZV9jb25maWcgPSBpOXh4X2dldF9waXBlX2NvbmZpZzsKPiA+IC0JCWRldl9w
cml2LT5kaXNwbGF5LmdldF9pbml0aWFsX3BsYW5lX2NvbmZpZyA9Cj4gPiArCQlpOTE1LT5kaXNw
bGF5LmdldF9waXBlX2NvbmZpZyA9IGk5eHhfZ2V0X3BpcGVfY29uZmlnOwo+ID4gKwkJaTkxNS0+
ZGlzcGxheS5nZXRfaW5pdGlhbF9wbGFuZV9jb25maWcgPQo+ID4gICAJCQlpOXh4X2dldF9pbml0
aWFsX3BsYW5lX2NvbmZpZzsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmNydGNfY29tcHV0ZV9j
bG9jayA9IGk4eHhfY3J0Y19jb21wdXRlX2Nsb2NrOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXku
Y3J0Y19lbmFibGUgPSBpOXh4X2NydGNfZW5hYmxlOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXku
Y3J0Y19kaXNhYmxlID0gaTl4eF9jcnRjX2Rpc2FibGU7Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmNy
dGNfY29tcHV0ZV9jbG9jayA9IGk4eHhfY3J0Y19jb21wdXRlX2Nsb2NrOwo+ID4gKwkJaTkxNS0+
ZGlzcGxheS5jcnRjX2VuYWJsZSA9IGk5eHhfY3J0Y19lbmFibGU7Cj4gPiArCQlpOTE1LT5kaXNw
bGF5LmNydGNfZGlzYWJsZSA9IGk5eHhfY3J0Y19kaXNhYmxlOwo+ID4gICAJfQo+ID4gLQlpZiAo
SVNfR0VOKGRldl9wcml2LCA1KSkgewo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuZmRpX2xpbmtf
dHJhaW4gPSBpcm9ubGFrZV9mZGlfbGlua190cmFpbjsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU4o
ZGV2X3ByaXYsIDYpKSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5mZGlfbGlua190cmFpbiA9
IGdlbjZfZmRpX2xpbmtfdHJhaW47Cj4gPiAtCX0gZWxzZSBpZiAoSVNfSVZZQlJJREdFKGRldl9w
cml2KSkgewo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDUpKSB7Cj4gPiArCQlpOTE1LT5kaXNwbGF5
LmZkaV9saW5rX3RyYWluID0gaXJvbmxha2VfZmRpX2xpbmtfdHJhaW47Cj4gPiArCX0gZWxzZSBp
ZiAoSVNfR0VOKGk5MTUsIDYpKSB7Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmZkaV9saW5rX3RyYWlu
ID0gZ2VuNl9mZGlfbGlua190cmFpbjsKPiA+ICsJfSBlbHNlIGlmIChJU19JVllCUklER0UoaTkx
NSkpIHsKPiA+ICAgCQkvKiBGSVhNRTogZGV0ZWN0IEIwKyBzdGVwcGluZyBhbmQgdXNlIGF1dG8g
dHJhaW5pbmcgKi8KPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmZkaV9saW5rX3RyYWluID0gaXZi
X21hbnVhbF9mZGlfbGlua190cmFpbjsKPiA+IC0JfSBlbHNlIGlmIChJU19IQVNXRUxMKGRldl9w
cml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxh
eS5mZGlfbGlua190cmFpbiA9IGhzd19mZGlfbGlua190cmFpbjsKPiA+ICsJCWk5MTUtPmRpc3Bs
YXkuZmRpX2xpbmtfdHJhaW4gPSBpdmJfbWFudWFsX2ZkaV9saW5rX3RyYWluOwo+ID4gKwl9IGVs
c2UgaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gPiArCQlp
OTE1LT5kaXNwbGF5LmZkaV9saW5rX3RyYWluID0gaHN3X2ZkaV9saW5rX3RyYWluOwo+ID4gICAJ
fQo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ID4gLQkJZGV2X3ByaXYtPmRp
c3BsYXkudXBkYXRlX2NydGNzID0gc2tsX3VwZGF0ZV9jcnRjczsKPiA+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA5KQo+ID4gKwkJaTkxNS0+ZGlzcGxheS51cGRhdGVfY3J0Y3MgPSBza2xfdXBk
YXRlX2NydGNzOwo+ID4gICAJZWxzZQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkudXBkYXRlX2Ny
dGNzID0gaW50ZWxfdXBkYXRlX2NydGNzOwo+ID4gKwkJaTkxNS0+ZGlzcGxheS51cGRhdGVfY3J0
Y3MgPSBpbnRlbF91cGRhdGVfY3J0Y3M7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaTkxNV9yZWdfdCBp
OTE1X3ZnYWNudHJsX3JlZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAr
c3RhdGljIGk5MTVfcmVnX3QgaTkxNV92Z2FjbnRybF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElT
X0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJ
U19DSEVSUllWSUVXKGk5MTUpKQo+ID4gICAJCXJldHVybiBWTFZfVkdBQ05UUkw7Cj4gPiAtCWVs
c2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSkKPiA+ICsJZWxzZSBpZiAoSU5URUxfR0VO
KGk5MTUpID49IDUpCj4gPiAgIAkJcmV0dXJuIENQVV9WR0FDTlRSTDsKPiA+ICAgCWVsc2UKPiA+
ICAgCQlyZXR1cm4gVkdBQ05UUkw7Cj4gPiAgIH0KPiA+ICAgLyogRGlzYWJsZSB0aGUgVkdBIHBs
YW5lIHRoYXQgd2UgbmV2ZXIgdXNlICovCj4gPiAtc3RhdGljIHZvaWQgaTkxNV9kaXNhYmxlX3Zn
YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaTkx
NV9kaXNhYmxlX3ZnYShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiA+ICsJc3RydWN0
IHBjaV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKPiA+ICAgCXU4IHNyMTsKPiA+IC0JaTkx
NV9yZWdfdCB2Z2FfcmVnID0gaTkxNV92Z2FjbnRybF9yZWcoZGV2X3ByaXYpOwo+ID4gKwlpOTE1
X3JlZ190IHZnYV9yZWcgPSBpOTE1X3ZnYWNudHJsX3JlZyhpOTE1KTsKPiA+ICAgCS8qIFdhRW5h
YmxlVkdBQWNjZXNzVGhyb3VnaElPUG9ydDpjdGcsZWxrLGlsayxzbmIsaXZiLHZsdixoc3cgKi8K
PiA+ICAgCXZnYV9nZXRfdW5pbnRlcnJ1cHRpYmxlKHBkZXYsIFZHQV9SU1JDX0xFR0FDWV9JTyk7
Cj4gPiBAQCAtMTU3NDcsMTEgKzE1NzQ3LDExIEBAIHN0YXRpYyB2b2lkIGk5MTVfZGlzYWJsZV92
Z2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICB2b2lkIGludGVsX21v
ZGVzZXRfaW5pdF9odyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAtCWludGVsX3VwZGF0
ZV9jZGNsayhkZXZfcHJpdik7Cj4gPiAtCWludGVsX2R1bXBfY2RjbGtfc3RhdGUoJmRldl9wcml2
LT5jZGNsay5odywgIkN1cnJlbnQgQ0RDTEsiKTsKPiA+IC0JZGV2X3ByaXYtPmNkY2xrLmxvZ2lj
YWwgPSBkZXZfcHJpdi0+Y2RjbGsuYWN0dWFsID0gZGV2X3ByaXYtPmNkY2xrLmh3Owo+ID4gKwlp
bnRlbF91cGRhdGVfY2RjbGsoaTkxNSk7Cj4gPiArCWludGVsX2R1bXBfY2RjbGtfc3RhdGUoJmk5
MTUtPmNkY2xrLmh3LCAiQ3VycmVudCBDRENMSyIpOwo+ID4gKwlpOTE1LT5jZGNsay5sb2dpY2Fs
ID0gaTkxNS0+Y2RjbGsuYWN0dWFsID0gaTkxNS0+Y2RjbGsuaHc7Cj4gPiAgIH0KPiA+ICAgLyoK
PiA+IEBAIC0xNTc2Niw3ICsxNTc2Niw3IEBAIHZvaWQgaW50ZWxfbW9kZXNldF9pbml0X2h3KHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgdm9pZCBzYW5pdGl6
ZV93YXRlcm1hcmtzKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBkcm1f
YXRvbWljX3N0YXRlICpzdGF0ZTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmlu
dGVsX3N0YXRlOwo+ID4gICAJc3RydWN0IGRybV9jcnRjICpjcnRjOwo+ID4gQEAgLTE1Nzc2LDcg
KzE1Nzc2LDcgQEAgc3RhdGljIHZvaWQgc2FuaXRpemVfd2F0ZXJtYXJrcyhzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2KQo+ID4gICAJaW50IGk7Cj4gPiAgIAkvKiBPbmx5IHN1cHBvcnRlZCBvbiBwbGF0
Zm9ybXMgdGhhdCB1c2UgYXRvbWljIHdhdGVybWFyayBkZXNpZ24gKi8KPiA+IC0JaWYgKCFkZXZf
cHJpdi0+ZGlzcGxheS5vcHRpbWl6ZV93YXRlcm1hcmtzKQo+ID4gKwlpZiAoIWk5MTUtPmRpc3Bs
YXkub3B0aW1pemVfd2F0ZXJtYXJrcykKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAkvKgo+ID4gQEAg
LTE1ODA0LDcgKzE1ODA0LDcgQEAgc3RhdGljIHZvaWQgc2FuaXRpemVfd2F0ZXJtYXJrcyhzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICAJICogaW50ZXJtZWRpYXRlIHdhdGVybWFya3MgKHNp
bmNlIHdlIGRvbid0IHRydXN0IHRoZSBjdXJyZW50Cj4gPiAgIAkgKiB3YXRlcm1hcmtzKS4KPiA+
ICAgCSAqLwo+ID4gLQlpZiAoIUhBU19HTUNIKGRldl9wcml2KSkKPiA+ICsJaWYgKCFIQVNfR01D
SChpOTE1KSkKPiA+ICAgCQlpbnRlbF9zdGF0ZS0+c2tpcF9pbnRlcm1lZGlhdGVfd20gPSB0cnVl
Owo+ID4gICAJcmV0ID0gaW50ZWxfYXRvbWljX2NoZWNrKGRldiwgc3RhdGUpOwo+ID4gQEAgLTE1
ODI5LDcgKzE1ODI5LDcgQEAgc3RhdGljIHZvaWQgc2FuaXRpemVfd2F0ZXJtYXJrcyhzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2KQo+ID4gICAJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcyA9IHRv
X2ludGVsX2NydGNfc3RhdGUoY3N0YXRlKTsKPiA+ICAgCQljcy0+d20ubmVlZF9wb3N0dmJsX3Vw
ZGF0ZSA9IHRydWU7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5vcHRpbWl6ZV93YXRlcm1hcmtz
KGludGVsX3N0YXRlLCBjcyk7Cj4gPiArCQlpOTE1LT5kaXNwbGF5Lm9wdGltaXplX3dhdGVybWFy
a3MoaW50ZWxfc3RhdGUsIGNzKTsKPiA+ICAgCQl0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPnN0
YXRlKS0+d20gPSBjcy0+d207Cj4gPiAgIAl9Cj4gPiBAQCAtMTU4NDEsMjAgKzE1ODQxLDIwIEBA
IHN0YXRpYyB2b2lkIHNhbml0aXplX3dhdGVybWFya3Moc3RydWN0IGRybV9kZXZpY2UgKmRldikK
PiA+ICAgCWRybV9tb2Rlc2V0X2FjcXVpcmVfZmluaSgmY3R4KTsKPiA+ICAgfQo+ID4gLXN0YXRp
YyB2b2lkIGludGVsX3VwZGF0ZV9mZGlfcGxsX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGludGVsX3VwZGF0ZV9mZGlfcGxsX2ZyZXEoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JaWYgKElTX0dFTihkZXZf
cHJpdiwgNSkpIHsKPiA+ICsJaWYgKElTX0dFTihpOTE1LCA1KSkgewo+ID4gICAJCXUzMiBmZGlf
cGxsX2NsayA9Cj4gPiAgIAkJCUk5MTVfUkVBRChGRElfUExMX0JJT1NfMCkgJiBGRElfUExMX0ZC
X0NMT0NLX01BU0s7Cj4gPiAtCQlkZXZfcHJpdi0+ZmRpX3BsbF9mcmVxID0gKGZkaV9wbGxfY2xr
ICsgMikgKiAxMDAwMDsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDYpIHx8IElT
X0lWWUJSSURHRShkZXZfcHJpdikpIHsKPiA+IC0JCWRldl9wcml2LT5mZGlfcGxsX2ZyZXEgPSAy
NzAwMDA7Cj4gPiArCQlpOTE1LT5mZGlfcGxsX2ZyZXEgPSAoZmRpX3BsbF9jbGsgKyAyKSAqIDEw
MDAwOwo+ID4gKwl9IGVsc2UgaWYgKElTX0dFTihpOTE1LCA2KSB8fCBJU19JVllCUklER0UoaTkx
NSkpIHsKPiA+ICsJCWk5MTUtPmZkaV9wbGxfZnJlcSA9IDI3MDAwMDsKPiA+ICAgCX0gZWxzZSB7
Cj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJfQo+ID4gLQlEUk1fREVCVUdfRFJJVkVSKCJGREkgUExM
IGZyZXE9JWRcbiIsIGRldl9wcml2LT5mZGlfcGxsX2ZyZXEpOwo+ID4gKwlEUk1fREVCVUdfRFJJ
VkVSKCJGREkgUExMIGZyZXE9JWRcbiIsIGk5MTUtPmZkaV9wbGxfZnJlcSk7Cj4gPiAgIH0KPiA+
ICAgc3RhdGljIGludCBpbnRlbF9pbml0aWFsX2NvbW1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
KQo+ID4gQEAgLTE1OTE1LDE3ICsxNTkxNSwxNyBAQCBzdGF0aWMgaW50IGludGVsX2luaXRpYWxf
Y29tbWl0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIGludCBpbnRlbF9tb2Rlc2V0X2lu
aXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiAtCXN0cnVjdCBpOTE1X2dndHQg
KmdndHQgPSAmZGV2X3ByaXYtPmdndHQ7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmk5MTUt
PmdndHQ7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjOwo+ID4gICAJaW50IHJldDsKPiA+IC0JZGV2X3ByaXYtPm1vZGVzZXRfd3EgPSBhbGxvY19v
cmRlcmVkX3dvcmtxdWV1ZSgiaTkxNV9tb2Rlc2V0IiwgMCk7Cj4gPiArCWk5MTUtPm1vZGVzZXRf
d3EgPSBhbGxvY19vcmRlcmVkX3dvcmtxdWV1ZSgiaTkxNV9tb2Rlc2V0IiwgMCk7Cj4gPiAgIAlk
cm1fbW9kZV9jb25maWdfaW5pdChkZXYpOwo+ID4gLQlyZXQgPSBpbnRlbF9id19pbml0KGRldl9w
cml2KTsKPiA+ICsJcmV0ID0gaW50ZWxfYndfaW5pdChpOTE1KTsKPiA+ICAgCWlmIChyZXQpCj4g
PiAgIAkJcmV0dXJuIHJldDsKPiA+IEBAIC0xNTkzOSwxNSArMTU5MzksMTUgQEAgaW50IGludGVs
X21vZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICAJZGV2LT5tb2RlX2Nv
bmZpZy5mdW5jcyA9ICZpbnRlbF9tb2RlX2Z1bmNzOwo+ID4gLQlpbml0X2xsaXN0X2hlYWQoJmRl
dl9wcml2LT5hdG9taWNfaGVscGVyLmZyZWVfbGlzdCk7Cj4gPiAtCUlOSVRfV09SSygmZGV2X3By
aXYtPmF0b21pY19oZWxwZXIuZnJlZV93b3JrLAo+ID4gKwlpbml0X2xsaXN0X2hlYWQoJmk5MTUt
PmF0b21pY19oZWxwZXIuZnJlZV9saXN0KTsKPiA+ICsJSU5JVF9XT1JLKCZpOTE1LT5hdG9taWNf
aGVscGVyLmZyZWVfd29yaywKPiA+ICAgCQkgIGludGVsX2F0b21pY19oZWxwZXJfZnJlZV9zdGF0
ZV93b3JrZXIpOwo+ID4gLQlpbnRlbF9pbml0X3F1aXJrcyhkZXZfcHJpdik7Cj4gPiArCWludGVs
X2luaXRfcXVpcmtzKGk5MTUpOwo+ID4gLQlpbnRlbF9mYmNfaW5pdChkZXZfcHJpdik7Cj4gPiAr
CWludGVsX2ZiY19pbml0KGk5MTUpOwo+ID4gLQlpbnRlbF9pbml0X3BtKGRldl9wcml2KTsKPiA+
ICsJaW50ZWxfaW5pdF9wbShpOTE1KTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBUaGVyZSBtYXkgYmUg
bm8gVkJUOyBhbmQgaWYgdGhlIEJJT1MgZW5hYmxlZCBTU0Mgd2UgY2FuCj4gPiBAQCAtMTU5NTUs
MTUgKzE1OTU1LDE1IEBAIGludCBpbnRlbF9tb2Rlc2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2Ug
KmRldikKPiA+ICAgCSAqIEJJT1MgaXNuJ3QgdXNpbmcgaXQsIGRvbid0IGFzc3VtZSBpdCB3aWxs
IHdvcmsgZXZlbiBpZiB0aGUgVkJUCj4gPiAgIAkgKiBpbmRpY2F0ZXMgYXMgbXVjaC4KPiA+ICAg
CSAqLwo+ID4gLQlpZiAoSEFTX1BDSF9JQlgoZGV2X3ByaXYpIHx8IEhBU19QQ0hfQ1BUKGRldl9w
cml2KSkgewo+ID4gKwlpZiAoSEFTX1BDSF9JQlgoaTkxNSkgfHwgSEFTX1BDSF9DUFQoaTkxNSkp
IHsKPiA+ICAgCQlib29sIGJpb3NfbHZkc191c2Vfc3NjID0gISEoSTkxNV9SRUFEKFBDSF9EUkVG
X0NPTlRST0wpICYKPiA+ICAgCQkJCQkgICAgRFJFRl9TU0MxX0VOQUJMRSk7Cj4gPiAtCQlpZiAo
ZGV2X3ByaXYtPnZidC5sdmRzX3VzZV9zc2MgIT0gYmlvc19sdmRzX3VzZV9zc2MpIHsKPiA+ICsJ
CWlmIChpOTE1LT52YnQubHZkc191c2Vfc3NjICE9IGJpb3NfbHZkc191c2Vfc3NjKSB7Cj4gPiAg
IAkJCURSTV9ERUJVR19LTVMoIlNTQyAlc2FibGVkIGJ5IEJJT1MsIG92ZXJyaWRpbmcgVkJUIHdo
aWNoIHNheXMgJXNhYmxlZFxuIiwKPiA+ICAgCQkJCSAgICAgYmlvc19sdmRzX3VzZV9zc2MgPyAi
ZW4iIDogImRpcyIsCj4gPiAtCQkJCSAgICAgZGV2X3ByaXYtPnZidC5sdmRzX3VzZV9zc2MgPyAi
ZW4iIDogImRpcyIpOwo+ID4gLQkJCWRldl9wcml2LT52YnQubHZkc191c2Vfc3NjID0gYmlvc19s
dmRzX3VzZV9zc2M7Cj4gPiArCQkJCSAgICAgaTkxNS0+dmJ0Lmx2ZHNfdXNlX3NzYyA/ICJlbiIg
OiAiZGlzIik7Cj4gPiArCQkJaTkxNS0+dmJ0Lmx2ZHNfdXNlX3NzYyA9IGJpb3NfbHZkc191c2Vf
c3NjOwo+ID4gICAJCX0KPiA+ICAgCX0KPiA+IEBAIC0xNTk3MSwxMyArMTU5NzEsMTMgQEAgaW50
IGludGVsX21vZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICAJICogTWF4
aW11bSBmcmFtZWJ1ZmZlciBkaW1lbnNpb25zLCBjaG9zZW4gdG8gbWF0Y2gKPiA+ICAgCSAqIHRo
ZSBtYXhpbXVtIHJlbmRlciBlbmdpbmUgc3VyZmFjZSBzaXplIG9uIGdlbjQrLgo+ID4gICAJICov
Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDcpIHsKPiA+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA3KSB7Cj4gPiAgIAkJZGV2LT5tb2RlX2NvbmZpZy5tYXhfd2lkdGggPSAxNjM4
NDsKPiA+ICAgCQlkZXYtPm1vZGVfY29uZmlnLm1heF9oZWlnaHQgPSAxNjM4NDsKPiA+IC0JfSBl
bHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpIHsKPiA+ICsJfSBlbHNlIGlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gNCkgewo+ID4gICAJCWRldi0+bW9kZV9jb25maWcubWF4X3dpZHRoID0g
ODE5MjsKPiA+ICAgCQlkZXYtPm1vZGVfY29uZmlnLm1heF9oZWlnaHQgPSA4MTkyOwo+ID4gLQl9
IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMykpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19HRU4o
aTkxNSwgMykpIHsKPiA+ICAgCQlkZXYtPm1vZGVfY29uZmlnLm1heF93aWR0aCA9IDQwOTY7Cj4g
PiAgIAkJZGV2LT5tb2RlX2NvbmZpZy5tYXhfaGVpZ2h0ID0gNDA5NjsKPiA+ICAgCX0gZWxzZSB7
Cj4gPiBAQCAtMTU5ODUsMTAgKzE1OTg1LDEwIEBAIGludCBpbnRlbF9tb2Rlc2V0X2luaXQoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgCQlkZXYtPm1vZGVfY29uZmlnLm1heF9oZWlnaHQg
PSAyMDQ4Owo+ID4gICAJfQo+ID4gLQlpZiAoSVNfSTg0NUcoZGV2X3ByaXYpIHx8IElTX0k4NjVH
KGRldl9wcml2KSkgewo+ID4gLQkJZGV2LT5tb2RlX2NvbmZpZy5jdXJzb3Jfd2lkdGggPSBJU19J
ODQ1RyhkZXZfcHJpdikgPyA2NCA6IDUxMjsKPiA+ICsJaWYgKElTX0k4NDVHKGk5MTUpIHx8IElT
X0k4NjVHKGk5MTUpKSB7Cj4gPiArCQlkZXYtPm1vZGVfY29uZmlnLmN1cnNvcl93aWR0aCA9IElT
X0k4NDVHKGk5MTUpID8gNjQgOiA1MTI7Cj4gPiAgIAkJZGV2LT5tb2RlX2NvbmZpZy5jdXJzb3Jf
aGVpZ2h0ID0gMTAyMzsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDIpKSB7Cj4g
PiArCX0gZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDIpKSB7Cj4gPiAgIAkJZGV2LT5tb2RlX2NvbmZp
Zy5jdXJzb3Jfd2lkdGggPSA2NDsKPiA+ICAgCQlkZXYtPm1vZGVfY29uZmlnLmN1cnNvcl9oZWln
aHQgPSA2NDsKPiA+ICAgCX0gZWxzZSB7Cj4gPiBAQCAtMTU5OTksMTEgKzE1OTk5LDExIEBAIGlu
dCBpbnRlbF9tb2Rlc2V0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgCWRldi0+
bW9kZV9jb25maWcuZmJfYmFzZSA9IGdndHQtPmdtYWRyLnN0YXJ0Owo+ID4gICAJRFJNX0RFQlVH
X0tNUygiJWQgZGlzcGxheSBwaXBlJXMgYXZhaWxhYmxlLlxuIiwKPiA+IC0JCSAgICAgIElOVEVM
X0lORk8oZGV2X3ByaXYpLT5udW1fcGlwZXMsCj4gPiAtCQkgICAgICBJTlRFTF9JTkZPKGRldl9w
cml2KS0+bnVtX3BpcGVzID4gMSA/ICJzIiA6ICIiKTsKPiA+ICsJCSAgICAgIElOVEVMX0lORk8o
aTkxNSktPm51bV9waXBlcywKPiA+ICsJCSAgICAgIElOVEVMX0lORk8oaTkxNSktPm51bV9waXBl
cyA+IDEgPyAicyIgOiAiIik7Cj4gPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsK
PiA+IC0JCXJldCA9IGludGVsX2NydGNfaW5pdChkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCWZvcl9l
YWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ID4gKwkJcmV0ID0gaW50ZWxfY3J0Y19pbml0KGk5MTUs
IHBpcGUpOwo+ID4gICAJCWlmIChyZXQpIHsKPiA+ICAgCQkJZHJtX21vZGVfY29uZmlnX2NsZWFu
dXAoZGV2KTsKPiA+ICAgCQkJcmV0dXJuIHJldDsKPiA+IEBAIC0xNjAxMSwxOSArMTYwMTEsMTkg
QEAgaW50IGludGVsX21vZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICAJ
fQo+ID4gICAJaW50ZWxfc2hhcmVkX2RwbGxfaW5pdChkZXYpOwo+ID4gLQlpbnRlbF91cGRhdGVf
ZmRpX3BsbF9mcmVxKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfdXBkYXRlX2ZkaV9wbGxfZnJlcShp
OTE1KTsKPiA+IC0JaW50ZWxfdXBkYXRlX2N6Y2xrKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfdXBk
YXRlX2N6Y2xrKGk5MTUpOwo+ID4gICAJaW50ZWxfbW9kZXNldF9pbml0X2h3KGRldik7Cj4gPiAt
CWludGVsX2hkY3BfY29tcG9uZW50X2luaXQoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9oZGNwX2Nv
bXBvbmVudF9pbml0KGk5MTUpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPm1heF9jZGNsa19mcmVxID09
IDApCj4gPiAtCQlpbnRlbF91cGRhdGVfbWF4X2NkY2xrKGRldl9wcml2KTsKPiA+ICsJaWYgKGk5
MTUtPm1heF9jZGNsa19mcmVxID09IDApCj4gPiArCQlpbnRlbF91cGRhdGVfbWF4X2NkY2xrKGk5
MTUpOwo+ID4gICAJLyogSnVzdCBkaXNhYmxlIGl0IG9uY2UgYXQgc3RhcnR1cCAqLwo+ID4gLQlp
OTE1X2Rpc2FibGVfdmdhKGRldl9wcml2KTsKPiA+IC0JaW50ZWxfc2V0dXBfb3V0cHV0cyhkZXZf
cHJpdik7Cj4gPiArCWk5MTVfZGlzYWJsZV92Z2EoaTkxNSk7Cj4gPiArCWludGVsX3NldHVwX291
dHB1dHMoaTkxNSk7Cj4gPiAgIAlkcm1fbW9kZXNldF9sb2NrX2FsbChkZXYpOwo+ID4gICAJaW50
ZWxfbW9kZXNldF9zZXR1cF9od19zdGF0ZShkZXYsIGRldi0+bW9kZV9jb25maWcuYWNxdWlyZV9j
dHgpOwo+ID4gQEAgLTE2MDQyLDcgKzE2MDQyLDcgQEAgaW50IGludGVsX21vZGVzZXRfaW5pdChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICAJCSAqIGNhbiBldmVuIGFsbG93IGZvciBzbW9v
dGggYm9vdCB0cmFuc2l0aW9ucyBpZiB0aGUgQklPUwo+ID4gICAJCSAqIGZiIGlzIGxhcmdlIGVu
b3VnaCBmb3IgdGhlIGFjdGl2ZSBwaXBlIGNvbmZpZ3VyYXRpb24uCj4gPiAgIAkJICovCj4gPiAt
CQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfaW5pdGlhbF9wbGFuZV9jb25maWcoY3J0YywKPiA+ICsJ
CWk5MTUtPmRpc3BsYXkuZ2V0X2luaXRpYWxfcGxhbmVfY29uZmlnKGNydGMsCj4gPiAgIAkJCQkJ
CQkgICAmcGxhbmVfY29uZmlnKTsKPiA+ICAgCQkvKgo+ID4gQEAgLTE2MDU3LDcgKzE2MDU3LDcg
QEAgaW50IGludGVsX21vZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICAJ
ICogTm90ZSB0aGF0IHdlIG5lZWQgdG8gZG8gdGhpcyBhZnRlciByZWNvbnN0cnVjdGluZyB0aGUg
QklPUyBmYidzCj4gPiAgIAkgKiBzaW5jZSB0aGUgd2F0ZXJtYXJrIGNhbGN1bGF0aW9uIGRvbmUg
aGVyZSB3aWxsIHVzZSBwc3RhdGUtPmZiLgo+ID4gICAJICovCj4gPiAtCWlmICghSEFTX0dNQ0go
ZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19HTUNIKGk5MTUpKQo+ID4gICAJCXNhbml0aXplX3dh
dGVybWFya3MoZGV2KTsKPiA+ICAgCS8qCj4gPiBAQCAtMTYwNzMsOSArMTYwNzMsOSBAQCBpbnQg
aW50ZWxfbW9kZXNldF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIAlyZXR1cm4g
MDsKPiA+ICAgfQo+ID4gLXZvaWQgaTgzMF9lbmFibGVfcGlwZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ID4gK3ZvaWQgaTgzMF9lbmFibGVfcGlw
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwaXBlIHBpcGUpCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShk
ZXZfcHJpdiwgcGlwZSk7Cj4gPiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gaW50ZWxfZ2V0
X2NydGNfZm9yX3BpcGUoaTkxNSwgcGlwZSk7Cj4gPiAgIAkvKiA2NDB4NDgwQDYwSHosIH4yNTE3
NSBrSHogKi8KPiA+ICAgCXN0cnVjdCBkcGxsIGNsb2NrID0gewo+ID4gICAJCS5tMSA9IDE4LAo+
ID4gQEAgLTE2MTQzLDkgKzE2MTQzLDkgQEAgdm9pZCBpODMwX2VuYWJsZV9waXBlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4gPiAgIAlpbnRlbF93
YWl0X2Zvcl9waXBlX3NjYW5saW5lX21vdmluZyhjcnRjKTsKPiA+ICAgfQo+ID4gLXZvaWQgaTgz
MF9kaXNhYmxlX3BpcGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBp
cGUgcGlwZSkKPiA+ICt2b2lkIGk4MzBfZGlzYWJsZV9waXBlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBw
aXBlKTsKPiA+ICAgCURSTV9ERUJVR19LTVMoImRpc2FibGluZyBwaXBlICVjIGR1ZSB0byBmb3Jj
ZSBxdWlya1xuIiwKPiA+ICAgCQkgICAgICBwaXBlX25hbWUocGlwZSkpOwo+ID4gQEAgLTE2MTY2
LDE0ICsxNjE2NiwxNCBAQCB2b2lkIGk4MzBfZGlzYWJsZV9waXBlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4gPiAgIH0KPiA+ICAgc3RhdGljIHZv
aWQKPiA+IC1pbnRlbF9zYW5pdGl6ZV9wbGFuZV9tYXBwaW5nKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtpbnRlbF9zYW5pdGl6ZV9wbGFuZV9tYXBwaW5nKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YzsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkKPiA+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSA0KQo+ID4gICAJCXJldHVybjsKPiA+IC0JZm9yX2VhY2hfaW50ZWxfY3J0
YygmZGV2X3ByaXYtPmRybSwgY3J0Yykgewo+ID4gKwlmb3JfZWFjaF9pbnRlbF9jcnRjKCZpOTE1
LT5kcm0sIGNydGMpIHsKPiA+ICAgCQlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0KPiA+ICAg
CQkJdG9faW50ZWxfcGxhbmUoY3J0Yy0+YmFzZS5wcmltYXJ5KTsKPiA+ICAgCQlzdHJ1Y3QgaW50
ZWxfY3J0YyAqcGxhbmVfY3J0YzsKPiA+IEBAIC0xNjE4OCw3ICsxNjE4OCw3IEBAIGludGVsX3Nh
bml0aXplX3BsYW5lX21hcHBpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gICAJCURSTV9ERUJVR19LTVMoIltQTEFORTolZDolc10gYXR0YWNoZWQgdG8gdGhlIHdyb25n
IHBpcGUsIGRpc2FibGluZyBwbGFuZVxuIiwKPiA+ICAgCQkJICAgICAgcGxhbmUtPmJhc2UuYmFz
ZS5pZCwgcGxhbmUtPmJhc2UubmFtZSk7Cj4gPiAtCQlwbGFuZV9jcnRjID0gaW50ZWxfZ2V0X2Ny
dGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwkJcGxhbmVfY3J0YyA9IGludGVsX2dl
dF9jcnRjX2Zvcl9waXBlKGk5MTUsIHBpcGUpOwo+ID4gICAJCWludGVsX3BsYW5lX2Rpc2FibGVf
bm9hdG9taWMocGxhbmVfY3J0YywgcGxhbmUpOwo+ID4gICAJfQo+ID4gICB9Cj4gPiBAQCAtMTYy
MTUsMTggKzE2MjE1LDE4IEBAIHN0YXRpYyBzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICppbnRlbF9l
bmNvZGVyX2ZpbmRfY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9lbmNvZGVyCj4gPiAgIAlyZXR1cm4g
TlVMTDsKPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIGhhc19wY2hfdHJhbmNvZGVyKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgYm9vbCBoYXNfcGNoX3RyYW5j
b2RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgZW51bSBw
aXBlIHBjaF90cmFuc2NvZGVyKQo+ID4gICB7Cj4gPiAtCXJldHVybiBIQVNfUENIX0lCWChkZXZf
cHJpdikgfHwgSEFTX1BDSF9DUFQoZGV2X3ByaXYpIHx8Cj4gPiAtCQkoSEFTX1BDSF9MUFRfSChk
ZXZfcHJpdikgJiYgcGNoX3RyYW5zY29kZXIgPT0gUElQRV9BKTsKPiA+ICsJcmV0dXJuIEhBU19Q
Q0hfSUJYKGk5MTUpIHx8IEhBU19QQ0hfQ1BUKGk5MTUpIHx8Cj4gPiArCQkoSEFTX1BDSF9MUFRf
SChpOTE1KSAmJiBwY2hfdHJhbnNjb2RlciA9PSBQSVBFX0EpOwo+ID4gICB9Cj4gPiAgIHN0YXRp
YyB2b2lkIGludGVsX3Nhbml0aXplX2NydGMoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAg
IAkJCQlzdHJ1Y3QgZHJtX21vZGVzZXRfYWNxdWlyZV9jdHggKmN0eCkKPiA+ICAgewo+ID4gICAJ
c3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUgPSB0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uuc3Rh
dGUpOwo+ID4gICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+
Y3B1X3RyYW5zY29kZXI7Cj4gPiBAQCAtMTYyNTUsNyArMTYyNTUsNyBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9zYW5pdGl6ZV9jcnRjKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCSAqIERp
c2FibGUgYW55IGJhY2tncm91bmQgY29sb3Igc2V0IGJ5IHRoZSBCSU9TLCBidXQgZW5hYmxlIHRo
ZQo+ID4gICAJCSAqIGdhbW1hIGFuZCBDU0MgdG8gbWF0Y2ggaG93IHdlIHByb2dyYW0gb3VyIHBs
YW5lcy4KPiA+ICAgCQkgKi8KPiA+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4g
PiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCj4gPiAgIAkJCUk5MTVfV1JJVEUoU0tMX0JP
VFRPTV9DT0xPUihjcnRjLT5waXBlKSwKPiA+ICAgCQkJCSAgIFNLTF9CT1RUT01fQ09MT1JfR0FN
TUFfRU5BQkxFIHwKPiA+ICAgCQkJCSAgIFNLTF9CT1RUT01fQ09MT1JfQ1NDX0VOQUJMRSk7Cj4g
PiBAQCAtMTYyNjYsNyArMTYyNjYsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zYW5pdGl6ZV9jcnRj
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJaWYgKGNydGNfc3RhdGUtPmJhc2UuYWN0
aXZlICYmICFpbnRlbF9jcnRjX2hhc19lbmNvZGVycyhjcnRjKSkKPiA+ICAgCQlpbnRlbF9jcnRj
X2Rpc2FibGVfbm9hdG9taWMoJmNydGMtPmJhc2UsIGN0eCk7Cj4gPiAtCWlmIChjcnRjX3N0YXRl
LT5iYXNlLmFjdGl2ZSB8fCBIQVNfR01DSChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKGNydGNfc3Rh
dGUtPmJhc2UuYWN0aXZlIHx8IEhBU19HTUNIKGk5MTUpKSB7Cj4gPiAgIAkJLyoKPiA+ICAgCQkg
KiBXZSBzdGFydCBvdXQgd2l0aCB1bmRlcnJ1biByZXBvcnRpbmcgZGlzYWJsZWQgdG8gYXZvaWQg
cmFjZXMuCj4gPiAgIAkJICogRm9yIGNvcnJlY3QgYm9va2tlZXBpbmcgbWFyayB0aGlzIG9uIGFj
dGl2ZSBjcnRjcy4KPiA+IEBAIC0xNjI5MCwxNCArMTYyOTAsMTQgQEAgc3RhdGljIHZvaWQgaW50
ZWxfc2FuaXRpemVfY3J0YyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkgKiBQQ0gg
dHJhbnNjb2RlcnMgQiBhbmQgQyB3b3VsZCBwcmV2ZW50IGVuYWJsaW5nIHRoZSBzb3V0aAo+ID4g
ICAJCSAqIGVycm9yIGludGVycnVwdCAoc2VlIGNwdF9jYW5fZW5hYmxlX3NlcnJfaW50KCkpLgo+
ID4gICAJCSAqLwo+ID4gLQkJaWYgKGhhc19wY2hfdHJhbmNvZGVyKGRldl9wcml2LCBjcnRjLT5w
aXBlKSkKPiA+ICsJCWlmIChoYXNfcGNoX3RyYW5jb2RlcihpOTE1LCBjcnRjLT5waXBlKSkKPiA+
ICAgCQkJY3J0Yy0+cGNoX2ZpZm9fdW5kZXJydW5fZGlzYWJsZWQgPSB0cnVlOwo+ID4gICAJfQo+
ID4gICB9Cj4gPiAgIHN0YXRpYyBib29sIGhhc19ib2d1c19kcGxsX2NvbmZpZyhjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNf
c3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBTb21lIFNOQiBCSU9T
ZW4gKGVnLiBBU1VTIEs1M1NWKSBhcmUga25vd24gdG8gbWlzcHJvZ3JhbQo+ID4gQEAgLTE2MzA5
LDcgKzE2MzA5LDcgQEAgc3RhdGljIGJvb2wgaGFzX2JvZ3VzX2RwbGxfY29uZmlnKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICAJICogd2l0aG91dCBzZXZl
cmFsIFdBUk5zLCBidXQgZm9yIG5vdyBsZXQncyB0YWtlIHRoZSBlYXN5Cj4gPiAgIAkgKiByb2Fk
Lgo+ID4gICAJICovCj4gPiAtCXJldHVybiBJU19HRU4oZGV2X3ByaXYsIDYpICYmCj4gPiArCXJl
dHVybiBJU19HRU4oaTkxNSwgNikgJiYKPiA+ICAgCQljcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSAm
Jgo+ID4gICAJCWNydGNfc3RhdGUtPnNoYXJlZF9kcGxsICYmCj4gPiAgIAkJY3J0Y19zdGF0ZS0+
cG9ydF9jbG9jayA9PSAwOwo+ID4gQEAgLTE2MzE3LDcgKzE2MzE3LDcgQEAgc3RhdGljIGJvb2wg
aGFzX2JvZ3VzX2RwbGxfY29uZmlnKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9zYW5pdGl6ZV9lbmNvZGVyKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4g
ICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yOwo+ID4gICAJc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGVuY29kZXItPmJhc2UuY3J0Yyk7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9IGNydGMgPwo+ID4gQEAgLTE2Mzc4
LDIxICsxNjM3OCwyMSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zYW5pdGl6ZV9lbmNvZGVyKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICAJLyogbm90aWZ5IG9wcmVnaW9uIG9mIHRo
ZSBzYW5pdGl6ZWQgZW5jb2RlciBzdGF0ZSAqLwo+ID4gICAJaW50ZWxfb3ByZWdpb25fbm90aWZ5
X2VuY29kZXIoZW5jb2RlciwgY29ubmVjdG9yICYmIGhhc19hY3RpdmVfY3J0Yyk7Cj4gPiAtCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49
IDExKQo+ID4gICAJCWljbF9zYW5pdGl6ZV9lbmNvZGVyX3BsbF9tYXBwaW5nKGVuY29kZXIpOwo+
ID4gICB9Cj4gPiAtdm9pZCBpOTE1X3JlZGlzYWJsZV92Z2FfcG93ZXJfb24oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaTkxNV9yZWRpc2FibGVfdmdhX3Bvd2Vy
X29uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWk5MTVfcmVn
X3QgdmdhX3JlZyA9IGk5MTVfdmdhY250cmxfcmVnKGRldl9wcml2KTsKPiA+ICsJaTkxNV9yZWdf
dCB2Z2FfcmVnID0gaTkxNV92Z2FjbnRybF9yZWcoaTkxNSk7Cj4gPiAgIAlpZiAoIShJOTE1X1JF
QUQodmdhX3JlZykgJiBWR0FfRElTUF9ESVNBQkxFKSkgewo+ID4gICAJCURSTV9ERUJVR19LTVMo
IlNvbWV0aGluZyBlbmFibGVkIFZHQSBwbGFuZSwgZGlzYWJsaW5nIGl0XG4iKTsKPiA+IC0JCWk5
MTVfZGlzYWJsZV92Z2EoZGV2X3ByaXYpOwo+ID4gKwkJaTkxNV9kaXNhYmxlX3ZnYShpOTE1KTsK
PiA+ICAgCX0KPiA+ICAgfQo+ID4gLXZvaWQgaTkxNV9yZWRpc2FibGVfdmdhKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGk5MTVfcmVkaXNhYmxlX3ZnYShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJaW50ZWxfd2FrZXJlZl90
IHdha2VyZWY7Cj4gPiBAQCAtMTY0MDUsMjMgKzE2NDA1LDIzIEBAIHZvaWQgaTkxNV9yZWRpc2Fi
bGVfdmdhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIGZvbGxv
dyB0aGUgImRvbid0IHRvdWNoIHRoZSBwb3dlciB3ZWxsIGlmIHdlIGRvbid0IG5lZWQgaXQiIHBv
bGljeQo+ID4gICAJICogdGhlIHJlc3Qgb2YgdGhlIGRyaXZlciB1c2VzLgo+ID4gICAJICovCj4g
PiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2
LAo+ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1
LAo+ID4gICAJCQkJCQkgICAgIFBPV0VSX0RPTUFJTl9WR0EpOwo+ID4gICAJaWYgKCF3YWtlcmVm
KQo+ID4gICAJCXJldHVybjsKPiA+IC0JaTkxNV9yZWRpc2FibGVfdmdhX3Bvd2VyX29uKGRldl9w
cml2KTsKPiA+ICsJaTkxNV9yZWRpc2FibGVfdmdhX3Bvd2VyX29uKGk5MTUpOwo+ID4gLQlpbnRl
bF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX1ZHQSwgd2FrZXJlZik7
Cj4gPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIFBPV0VSX0RPTUFJTl9WR0EsIHdh
a2VyZWYpOwo+ID4gICB9Cj4gPiAgIC8qIEZJWE1FIHJlYWQgb3V0IGZ1bGwgcGxhbmUgc3RhdGUg
Zm9yIGFsbCBwbGFuZXMgKi8KPiA+IC1zdGF0aWMgdm9pZCByZWFkb3V0X3BsYW5lX3N0YXRlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCByZWFkb3V0
X3BsYW5lX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNy
dGM7Cj4gPiAtCWZvcl9lYWNoX2ludGVsX3BsYW5lKCZkZXZfcHJpdi0+ZHJtLCBwbGFuZSkgewo+
ID4gKwlmb3JfZWFjaF9pbnRlbF9wbGFuZSgmaTkxNS0+ZHJtLCBwbGFuZSkgewo+ID4gICAJCXN0
cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUgPQo+ID4gICAJCQl0b19pbnRlbF9w
bGFuZV9zdGF0ZShwbGFuZS0+YmFzZS5zdGF0ZSk7Cj4gPiAgIAkJc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGU7Cj4gPiBAQCAtMTY0MzAsNyArMTY0MzAsNyBAQCBzdGF0aWMgdm9p
ZCByZWFkb3V0X3BsYW5lX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgCQl2aXNpYmxlID0gcGxhbmUtPmdldF9od19zdGF0ZShwbGFuZSwgJnBpcGUpOwo+ID4g
LQkJY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKTsKPiA+ICsJ
CWNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwaXBlKTsKPiA+ICAgCQljcnRj
X3N0YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiA+ICAgCQlp
bnRlbF9zZXRfcGxhbmVfdmlzaWJsZShjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSwgdmlzaWJsZSk7
Cj4gPiBAQCAtMTY0NDAsNyArMTY0NDAsNyBAQCBzdGF0aWMgdm9pZCByZWFkb3V0X3BsYW5lX3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkJICAgICAgZW5h
YmxlZGRpc2FibGVkKHZpc2libGUpLCBwaXBlX25hbWUocGlwZSkpOwo+ID4gICAJfQo+ID4gLQlm
b3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRjKSB7Cj4gPiArCWZvcl9lYWNo
X2ludGVsX2NydGMoJmk5MTUtPmRybSwgY3J0Yykgewo+ID4gICAJCXN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlID0KPiA+ICAgCQkJdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5i
YXNlLnN0YXRlKTsKPiA+IEBAIC0xNjQ1MCw3ICsxNjQ1MCw3IEBAIHN0YXRpYyB2b2lkIHJlYWRv
dXRfcGxhbmVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICBz
dGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZp
Y2UgKmRldikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShkZXYpOwo+ID4gICAJZW51bSBwaXBlIHBpcGU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YzsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ID4gQEAgLTE2
NDU4LDcgKzE2NDU4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfbW9kZXNldF9yZWFkb3V0X2h3X3N0
YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9s
aXN0X2l0ZXIgY29ubl9pdGVyOwo+ID4gICAJaW50IGk7Cj4gPiAtCWRldl9wcml2LT5hY3RpdmVf
Y3J0Y3MgPSAwOwo+ID4gKwlpOTE1LT5hY3RpdmVfY3J0Y3MgPSAwOwo+ID4gICAJZm9yX2VhY2hf
aW50ZWxfY3J0YyhkZXYsIGNydGMpIHsKPiA+ICAgCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSA9Cj4gPiBAQCAtMTY0NjksMjUgKzE2NDY5LDI1IEBAIHN0YXRpYyB2b2lkIGlu
dGVsX21vZGVzZXRfcmVhZG91dF9od19zdGF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4g
ICAJCV9fZHJtX2F0b21pY19oZWxwZXJfY3J0Y19yZXNldCgmY3J0Yy0+YmFzZSwgJmNydGNfc3Rh
dGUtPmJhc2UpOwo+ID4gICAJCWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlID0gY3J0Y19zdGF0ZS0+
YmFzZS5lbmFibGUgPQo+ID4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmdldF9waXBlX2NvbmZpZyhj
cnRjLCBjcnRjX3N0YXRlKTsKPiA+ICsJCQlpOTE1LT5kaXNwbGF5LmdldF9waXBlX2NvbmZpZyhj
cnRjLCBjcnRjX3N0YXRlKTsKPiA+ICAgCQljcnRjLT5iYXNlLmVuYWJsZWQgPSBjcnRjX3N0YXRl
LT5iYXNlLmVuYWJsZTsKPiA+ICAgCQljcnRjLT5hY3RpdmUgPSBjcnRjX3N0YXRlLT5iYXNlLmFj
dGl2ZTsKPiA+ICAgCQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpCj4gPiAtCQkJZGV2X3By
aXYtPmFjdGl2ZV9jcnRjcyB8PSAxIDw8IGNydGMtPnBpcGU7Cj4gPiArCQkJaTkxNS0+YWN0aXZl
X2NydGNzIHw9IDEgPDwgY3J0Yy0+cGlwZTsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJbQ1JUQzol
ZDolc10gaHcgc3RhdGUgcmVhZG91dDogJXNcbiIsCj4gPiAgIAkJCSAgICAgIGNydGMtPmJhc2Uu
YmFzZS5pZCwgY3J0Yy0+YmFzZS5uYW1lLAo+ID4gICAJCQkgICAgICBlbmFibGVkZGlzYWJsZWQo
Y3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpKTsKPiA+ICAgCX0KPiA+IC0JcmVhZG91dF9wbGFuZV9z
dGF0ZShkZXZfcHJpdik7Cj4gPiArCXJlYWRvdXRfcGxhbmVfc3RhdGUoaTkxNSk7Cj4gPiAtCWZv
ciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+bnVtX3NoYXJlZF9kcGxsOyBpKyspIHsKPiA+IC0JCXN0
cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsID0gJmRldl9wcml2LT5zaGFyZWRfZHBsbHNbaV07
Cj4gPiArCWZvciAoaSA9IDA7IGkgPCBpOTE1LT5udW1fc2hhcmVkX2RwbGw7IGkrKykgewo+ID4g
KwkJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwgPSAmaTkxNS0+c2hhcmVkX2RwbGxzW2ld
Owo+ID4gLQkJcGxsLT5vbiA9IHBsbC0+aW5mby0+ZnVuY3MtPmdldF9od19zdGF0ZShkZXZfcHJp
diwgcGxsLAo+ID4gKwkJcGxsLT5vbiA9IHBsbC0+aW5mby0+ZnVuY3MtPmdldF9od19zdGF0ZShp
OTE1LCBwbGwsCj4gPiAgIAkJCQkJCQkmcGxsLT5zdGF0ZS5od19zdGF0ZSk7Cj4gPiAgIAkJcGxs
LT5zdGF0ZS5jcnRjX21hc2sgPSAwOwo+ID4gICAJCWZvcl9lYWNoX2ludGVsX2NydGMoZGV2LCBj
cnRjKSB7Cj4gPiBAQCAtMTY1MTAsNyArMTY1MTAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rl
c2V0X3JlYWRvdXRfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgCQlpZiAo
ZW5jb2Rlci0+Z2V0X2h3X3N0YXRlKGVuY29kZXIsICZwaXBlKSkgewo+ID4gICAJCQlzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiA+IC0JCQljcnRjID0gaW50ZWxfZ2V0X2Ny
dGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwkJCWNydGMgPSBpbnRlbF9nZXRfY3J0
Y19mb3JfcGlwZShpOTE1LCBwaXBlKTsKPiA+ICAgCQkJY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2Ny
dGNfc3RhdGUoY3J0Yy0+YmFzZS5zdGF0ZSk7Cj4gPiAgIAkJCWVuY29kZXItPmJhc2UuY3J0YyA9
ICZjcnRjLT5iYXNlOwo+ID4gQEAgLTE2NTU4LDcgKzE2NTU4LDcgQEAgc3RhdGljIHZvaWQgaW50
ZWxfbW9kZXNldF9yZWFkb3V0X2h3X3N0YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAg
IAlmb3JfZWFjaF9pbnRlbF9jcnRjKGRldiwgY3J0Yykgewo+ID4gICAJCXN0cnVjdCBpbnRlbF9i
d19zdGF0ZSAqYndfc3RhdGUgPQo+ID4gLQkJCXRvX2ludGVsX2J3X3N0YXRlKGRldl9wcml2LT5i
d19vYmouc3RhdGUpOwo+ID4gKwkJCXRvX2ludGVsX2J3X3N0YXRlKGk5MTUtPmJ3X29iai5zdGF0
ZSk7Cj4gPiAgIAkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPQo+ID4gICAJ
CQl0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uuc3RhdGUpOwo+ID4gICAJCXN0cnVjdCBp
bnRlbF9wbGFuZSAqcGxhbmU7Cj4gPiBAQCAtMTY1ODUsNyArMTY1ODUsNyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikK
PiA+ICAgCQkJaW50ZWxfY3J0Y19jb21wdXRlX3BpeGVsX3JhdGUoY3J0Y19zdGF0ZSk7Cj4gPiAt
CQkJaWYgKGRldl9wcml2LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19jZGNsaykgewo+ID4gKwkJCWlm
IChpOTE1LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19jZGNsaykgewo+ID4gICAJCQkJbWluX2NkY2xr
ID0gaW50ZWxfY3J0Y19jb21wdXRlX21pbl9jZGNsayhjcnRjX3N0YXRlKTsKPiA+ICAgCQkJCWlm
IChXQVJOX09OKG1pbl9jZGNsayA8IDApKQo+ID4gICAJCQkJCW1pbl9jZGNsayA9IDA7Cj4gPiBA
QCAtMTY1OTYsMTEgKzE2NTk2LDExIEBAIHN0YXRpYyB2b2lkIGludGVsX21vZGVzZXRfcmVhZG91
dF9od19zdGF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQo+ID4gICAJCQl1cGRhdGVfc2Nhbmxp
bmVfb2Zmc2V0KGNydGNfc3RhdGUpOwo+ID4gICAJCX0KPiA+IC0JCWRldl9wcml2LT5taW5fY2Rj
bGtbY3J0Yy0+cGlwZV0gPSBtaW5fY2RjbGs7Cj4gPiAtCQlkZXZfcHJpdi0+bWluX3ZvbHRhZ2Vf
bGV2ZWxbY3J0Yy0+cGlwZV0gPQo+ID4gKwkJaTkxNS0+bWluX2NkY2xrW2NydGMtPnBpcGVdID0g
bWluX2NkY2xrOwo+ID4gKwkJaTkxNS0+bWluX3ZvbHRhZ2VfbGV2ZWxbY3J0Yy0+cGlwZV0gPQo+
ID4gICAJCQljcnRjX3N0YXRlLT5taW5fdm9sdGFnZV9sZXZlbDsKPiA+IC0JCWZvcl9lYWNoX2lu
dGVsX3BsYW5lX29uX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMsIHBsYW5lKSB7Cj4gPiArCQlm
b3JfZWFjaF9pbnRlbF9wbGFuZV9vbl9jcnRjKCZpOTE1LT5kcm0sIGNydGMsIHBsYW5lKSB7Cj4g
PiAgIAkJCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUgPQo+ID4g
ICAJCQkJdG9faW50ZWxfcGxhbmVfc3RhdGUocGxhbmUtPmJhc2Uuc3RhdGUpOwo+ID4gQEAgLTE2
NjE1LDE2ICsxNjYxNSwxNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdf
c3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgCQlpbnRlbF9id19jcnRjX3VwZGF0
ZShid19zdGF0ZSwgY3J0Y19zdGF0ZSk7Cj4gPiAtCQlpbnRlbF9waXBlX2NvbmZpZ19zYW5pdHlf
Y2hlY2soZGV2X3ByaXYsIGNydGNfc3RhdGUpOwo+ID4gKwkJaW50ZWxfcGlwZV9jb25maWdfc2Fu
aXR5X2NoZWNrKGk5MTUsIGNydGNfc3RhdGUpOwo+ID4gICAJfQo+ID4gICB9Cj4gPiAgIHN0YXRp
YyB2b2lkCj4gPiAtZ2V0X2VuY29kZXJfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiArZ2V0X2VuY29kZXJfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXI7Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2VuY29kZXIoJmRldl9wcml2LT5kcm0sIGVu
Y29kZXIpIHsKPiA+ICsJZm9yX2VhY2hfaW50ZWxfZW5jb2RlcigmaTkxNS0+ZHJtLCBlbmNvZGVy
KSB7Cj4gPiAgIAkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGU7Cj4gPiAgIAkJ
aWYgKCFlbmNvZGVyLT5nZXRfcG93ZXJfZG9tYWlucykKPiA+IEBAIC0xNjY0MiwxNCArMTY2NDIs
MTQgQEAgZ2V0X2VuY29kZXJfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9lYXJseV9k
aXNwbGF5X3dhcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGlj
IHZvaWQgaW50ZWxfZWFybHlfZGlzcGxheV93YXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gPiAgIHsKPiA+ICAgCS8qIERpc3BsYXkgV0EgIzExODUgV2FEaXNhYmxlREFSQkZDbGtH
YXRpbmc6Y25sLGdsayAqLwo+ID4gLQlpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikgfHwgSVNf
R0VNSU5JTEFLRShkZXZfcHJpdikpCj4gPiArCWlmIChJU19DQU5OT05MQUtFKGk5MTUpIHx8IElT
X0dFTUlOSUxBS0UoaTkxNSkpCj4gPiAgIAkJSTkxNV9XUklURShHRU45X0NMS0dBVEVfRElTXzAs
IEk5MTVfUkVBRChHRU45X0NMS0dBVEVfRElTXzApIHwKPiA+ICAgCQkJICAgREFSQkZfR0FUSU5H
X0RJUyk7Cj4gPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfSEFT
V0VMTChpOTE1KSkgewo+ID4gICAJCS8qCj4gPiAgIAkJICogV2FSc1BrZ0NTdGF0ZURpc3BsYXlQ
TVJlcTpoc3cKPiA+ICAgCQkgKiBTeXN0ZW0gaGFuZyBpZiB0aGlzIGlzbid0IGRvbmUgYmVmb3Jl
IGRpc2FibGluZyBhbGwgcGxhbmVzIQo+ID4gQEAgLTE2NjU5LDcgKzE2NjU5LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfZWFybHlfZGlzcGxheV93YXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJfQo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaWJ4X3Nhbml0aXplX3Bj
aF9oZG1pX3BvcnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRp
YyB2b2lkIGlieF9zYW5pdGl6ZV9wY2hfaGRtaV9wb3J0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ID4gICAJCQkJICAgICAgIGVudW0gcG9ydCBwb3J0LCBpOTE1X3JlZ190IGhkbWlf
cmVnKQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKGhkbWlfcmVnKTsKPiA+IEBA
IC0xNjY3Nyw3ICsxNjY3Nyw3IEBAIHN0YXRpYyB2b2lkIGlieF9zYW5pdGl6ZV9wY2hfaGRtaV9w
b3J0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCUk5MTVfV1JJVEUo
aGRtaV9yZWcsIHZhbCk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpYnhfc2FuaXRpemVfcGNo
X2RwX3BvcnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2
b2lkIGlieF9zYW5pdGl6ZV9wY2hfZHBfcG9ydChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICAgCQkJCSAgICAgZW51bSBwb3J0IHBvcnQsIGk5MTVfcmVnX3QgZHBfcmVnKQo+ID4g
ICB7Cj4gPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKGRwX3JlZyk7Cj4gPiBAQCAtMTY2OTUsNyAr
MTY2OTUsNyBAQCBzdGF0aWMgdm9pZCBpYnhfc2FuaXRpemVfcGNoX2RwX3BvcnQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJSTkxNV9XUklURShkcF9yZWcsIHZhbCk7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpYnhfc2FuaXRpemVfcGNoX3BvcnRzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpYnhfc2FuaXRpemVf
cGNoX3BvcnRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAkv
Kgo+ID4gICAJICogVGhlIEJJT1MgbWF5IHNlbGVjdCB0cmFuc2NvZGVyIEIgb24gc29tZSBvZiB0
aGUgUENICj4gPiBAQCAtMTY3MDgsMTQgKzE2NzA4LDE0IEBAIHN0YXRpYyB2b2lkIGlieF9zYW5p
dGl6ZV9wY2hfcG9ydHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJ
ICogKHNlZS4gaW50ZWxfZHBfbGlua19kb3duKCksIGludGVsX2Rpc2FibGVfaGRtaSgpLAo+ID4g
ICAJICogaW50ZWxfZGlzYWJsZV9zZHZvKCkpLgo+ID4gICAJICovCj4gPiAtCWlieF9zYW5pdGl6
ZV9wY2hfZHBfcG9ydChkZXZfcHJpdiwgUE9SVF9CLCBQQ0hfRFBfQik7Cj4gPiAtCWlieF9zYW5p
dGl6ZV9wY2hfZHBfcG9ydChkZXZfcHJpdiwgUE9SVF9DLCBQQ0hfRFBfQyk7Cj4gPiAtCWlieF9z
YW5pdGl6ZV9wY2hfZHBfcG9ydChkZXZfcHJpdiwgUE9SVF9ELCBQQ0hfRFBfRCk7Cj4gPiArCWli
eF9zYW5pdGl6ZV9wY2hfZHBfcG9ydChpOTE1LCBQT1JUX0IsIFBDSF9EUF9CKTsKPiA+ICsJaWJ4
X3Nhbml0aXplX3BjaF9kcF9wb3J0KGk5MTUsIFBPUlRfQywgUENIX0RQX0MpOwo+ID4gKwlpYnhf
c2FuaXRpemVfcGNoX2RwX3BvcnQoaTkxNSwgUE9SVF9ELCBQQ0hfRFBfRCk7Cj4gPiAgIAkvKiBQ
Q0ggU0RWT0IgbXVsdGlwbGV4IHdpdGggSERNSUIgKi8KPiA+IC0JaWJ4X3Nhbml0aXplX3BjaF9o
ZG1pX3BvcnQoZGV2X3ByaXYsIFBPUlRfQiwgUENIX0hETUlCKTsKPiA+IC0JaWJ4X3Nhbml0aXpl
X3BjaF9oZG1pX3BvcnQoZGV2X3ByaXYsIFBPUlRfQywgUENIX0hETUlDKTsKPiA+IC0JaWJ4X3Nh
bml0aXplX3BjaF9oZG1pX3BvcnQoZGV2X3ByaXYsIFBPUlRfRCwgUENIX0hETUlEKTsKPiA+ICsJ
aWJ4X3Nhbml0aXplX3BjaF9oZG1pX3BvcnQoaTkxNSwgUE9SVF9CLCBQQ0hfSERNSUIpOwo+ID4g
KwlpYnhfc2FuaXRpemVfcGNoX2hkbWlfcG9ydChpOTE1LCBQT1JUX0MsIFBDSF9IRE1JQyk7Cj4g
PiArCWlieF9zYW5pdGl6ZV9wY2hfaGRtaV9wb3J0KGk5MTUsIFBPUlRfRCwgUENIX0hETUlEKTsK
PiA+ICAgfQo+ID4gICAvKiBTY2FuIG91dCB0aGUgY3VycmVudCBodyBtb2Rlc2V0IHN0YXRlLAo+
ID4gQEAgLTE2NzI1LDI5ICsxNjcyNSwyOSBAQCBzdGF0aWMgdm9pZAo+ID4gICBpbnRlbF9tb2Rl
c2V0X3NldHVwX2h3X3N0YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgIAkJCSAgICAg
c3RydWN0IGRybV9tb2Rlc2V0X2FjcXVpcmVfY3R4ICpjdHgpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOwo+ID4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXI7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiA+ICAgCWludGVsX3dha2Vy
ZWZfdCB3YWtlcmVmOwo+ID4gICAJaW50IGk7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5
X3Bvd2VyX2dldChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0lOSVQpOwo+ID4gKwl3YWtlcmVmID0g
aW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgUE9XRVJfRE9NQUlOX0lOSVQpOwo+ID4gLQlp
bnRlbF9lYXJseV9kaXNwbGF5X3dhcyhkZXZfcHJpdik7Cj4gPiArCWludGVsX2Vhcmx5X2Rpc3Bs
YXlfd2FzKGk5MTUpOwo+ID4gICAJaW50ZWxfbW9kZXNldF9yZWFkb3V0X2h3X3N0YXRlKGRldik7
Cj4gPiAgIAkvKiBIVyBzdGF0ZSBpcyByZWFkIG91dCwgbm93IHdlIG5lZWQgdG8gc2FuaXRpemUg
dGhpcyBtZXNzLiAqLwo+ID4gLQlnZXRfZW5jb2Rlcl9wb3dlcl9kb21haW5zKGRldl9wcml2KTsK
PiA+ICsJZ2V0X2VuY29kZXJfcG93ZXJfZG9tYWlucyhpOTE1KTsKPiA+IC0JaWYgKEhBU19QQ0hf
SUJYKGRldl9wcml2KSkKPiA+IC0JCWlieF9zYW5pdGl6ZV9wY2hfcG9ydHMoZGV2X3ByaXYpOwo+
ID4gKwlpZiAoSEFTX1BDSF9JQlgoaTkxNSkpCj4gPiArCQlpYnhfc2FuaXRpemVfcGNoX3BvcnRz
KGk5MTUpOwo+ID4gICAJLyoKPiA+ICAgCSAqIGludGVsX3Nhbml0aXplX3BsYW5lX21hcHBpbmco
KSBtYXkgbmVlZCB0byBkbyB2YmxhbmsKPiA+ICAgCSAqIHdhaXRzLCBzbyB3ZSBuZWVkIHZibGFu
ayBpbnRlcnJ1cHRzIHJlc3RvcmVkIGJlZm9yZWhhbmQuCj4gPiAgIAkgKi8KPiA+IC0JZm9yX2Vh
Y2hfaW50ZWxfY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0Yykgewo+ID4gKwlmb3JfZWFjaF9pbnRl
bF9jcnRjKCZpOTE1LT5kcm0sIGNydGMpIHsKPiA+ICAgCQljcnRjX3N0YXRlID0gdG9faW50ZWxf
Y3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiA+ICAgCQlkcm1fY3J0Y192YmxhbmtfcmVz
ZXQoJmNydGMtPmJhc2UpOwo+ID4gQEAgLTE2NzU2LDEyICsxNjc1NiwxMiBAQCBpbnRlbF9tb2Rl
c2V0X3NldHVwX2h3X3N0YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgIAkJCWludGVs
X2NydGNfdmJsYW5rX29uKGNydGNfc3RhdGUpOwo+ID4gICAJfQo+ID4gLQlpbnRlbF9zYW5pdGl6
ZV9wbGFuZV9tYXBwaW5nKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfc2FuaXRpemVfcGxhbmVfbWFw
cGluZyhpOTE1KTsKPiA+ICAgCWZvcl9lYWNoX2ludGVsX2VuY29kZXIoZGV2LCBlbmNvZGVyKQo+
ID4gICAJCWludGVsX3Nhbml0aXplX2VuY29kZXIoZW5jb2Rlcik7Cj4gPiAtCWZvcl9lYWNoX2lu
dGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpIHsKPiA+ICsJZm9yX2VhY2hfaW50ZWxfY3J0
YygmaTkxNS0+ZHJtLCBjcnRjKSB7Cj4gPiAgIAkJY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2NydGNf
c3RhdGUoY3J0Yy0+YmFzZS5zdGF0ZSk7Cj4gPiAgIAkJaW50ZWxfc2FuaXRpemVfY3J0YyhjcnRj
LCBjdHgpOwo+ID4gICAJCWludGVsX2R1bXBfcGlwZV9jb25maWcoY3J0Y19zdGF0ZSwgTlVMTCwg
IltzZXR1cF9od19zdGF0ZV0iKTsKPiA+IEBAIC0xNjc2OSw4ICsxNjc2OSw4IEBAIGludGVsX21v
ZGVzZXRfc2V0dXBfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiA+ICAgCWludGVs
X21vZGVzZXRfdXBkYXRlX2Nvbm5lY3Rvcl9hdG9taWNfc3RhdGUoZGV2KTsKPiA+IC0JZm9yIChp
ID0gMDsgaSA8IGRldl9wcml2LT5udW1fc2hhcmVkX2RwbGw7IGkrKykgewo+ID4gLQkJc3RydWN0
IGludGVsX3NoYXJlZF9kcGxsICpwbGwgPSAmZGV2X3ByaXYtPnNoYXJlZF9kcGxsc1tpXTsKPiA+
ICsJZm9yIChpID0gMDsgaSA8IGk5MTUtPm51bV9zaGFyZWRfZHBsbDsgaSsrKSB7Cj4gPiArCQlz
dHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCA9ICZpOTE1LT5zaGFyZWRfZHBsbHNbaV07Cj4g
PiAgIAkJaWYgKCFwbGwtPm9uIHx8IHBsbC0+YWN0aXZlX21hc2spCj4gPiAgIAkJCWNvbnRpbnVl
Owo+ID4gQEAgLTE2Nzc4LDIwICsxNjc3OCwyMCBAQCBpbnRlbF9tb2Rlc2V0X3NldHVwX2h3X3N0
YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiJXMgZW5h
YmxlZCBidXQgbm90IGluIHVzZSwgZGlzYWJsaW5nXG4iLAo+ID4gICAJCQkgICAgICBwbGwtPmlu
Zm8tPm5hbWUpOwo+ID4gLQkJcGxsLT5pbmZvLT5mdW5jcy0+ZGlzYWJsZShkZXZfcHJpdiwgcGxs
KTsKPiA+ICsJCXBsbC0+aW5mby0+ZnVuY3MtPmRpc2FibGUoaTkxNSwgcGxsKTsKPiA+ICAgCQlw
bGwtPm9uID0gZmFsc2U7Cj4gPiAgIAl9Cj4gPiAtCWlmIChJU19HNFgoZGV2X3ByaXYpKSB7Cj4g
PiAtCQlnNHhfd21fZ2V0X2h3X3N0YXRlKGRldl9wcml2KTsKPiA+IC0JCWc0eF93bV9zYW5pdGl6
ZShkZXZfcHJpdik7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwg
SVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+IC0JCXZsdl93bV9nZXRfaHdfc3RhdGUoZGV2
X3ByaXYpOwo+ID4gLQkJdmx2X3dtX3Nhbml0aXplKGRldl9wcml2KTsKPiA+IC0JfSBlbHNlIGlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKPiA+IC0JCXNrbF93bV9nZXRfaHdfc3RhdGUo
ZGV2X3ByaXYpOwo+ID4gLQl9IGVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKSB7Cj4g
PiAtCQlpbGtfd21fZ2V0X2h3X3N0YXRlKGRldl9wcml2KTsKPiA+ICsJaWYgKElTX0c0WChpOTE1
KSkgewo+ID4gKwkJZzR4X3dtX2dldF9od19zdGF0ZShpOTE1KTsKPiA+ICsJCWc0eF93bV9zYW5p
dGl6ZShpOTE1KTsKPiA+ICsJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NI
RVJSWVZJRVcoaTkxNSkpIHsKPiA+ICsJCXZsdl93bV9nZXRfaHdfc3RhdGUoaTkxNSk7Cj4gPiAr
CQl2bHZfd21fc2FuaXRpemUoaTkxNSk7Cj4gPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDkpIHsKPiA+ICsJCXNrbF93bV9nZXRfaHdfc3RhdGUoaTkxNSk7Cj4gPiArCX0gZWxzZSBp
ZiAoSEFTX1BDSF9TUExJVChpOTE1KSkgewo+ID4gKwkJaWxrX3dtX2dldF9od19zdGF0ZShpOTE1
KTsKPiA+ICAgCX0KPiA+ICAgCWZvcl9lYWNoX2ludGVsX2NydGMoZGV2LCBjcnRjKSB7Cj4gPiBA
QCAtMTY4MDAsMjIgKzE2ODAwLDIyIEBAIGludGVsX21vZGVzZXRfc2V0dXBfaHdfc3RhdGUoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwKPiA+ICAgCQljcnRjX3N0YXRlID0gdG9faW50ZWxfY3J0Y19z
dGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiA+ICAgCQlwdXRfZG9tYWlucyA9IG1vZGVzZXRfZ2V0
X2NydGNfcG93ZXJfZG9tYWlucygmY3J0Yy0+YmFzZSwgY3J0Y19zdGF0ZSk7Cj4gPiAgIAkJaWYg
KFdBUk5fT04ocHV0X2RvbWFpbnMpKQo+ID4gLQkJCW1vZGVzZXRfcHV0X3Bvd2VyX2RvbWFpbnMo
ZGV2X3ByaXYsIHB1dF9kb21haW5zKTsKPiA+ICsJCQltb2Rlc2V0X3B1dF9wb3dlcl9kb21haW5z
KGk5MTUsIHB1dF9kb21haW5zKTsKPiA+ICAgCX0KPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9w
dXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9JTklULCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfZGlz
cGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9NQUlOX0lOSVQsIHdha2VyZWYpOwo+ID4gLQlp
bnRlbF9mYmNfaW5pdF9waXBlX3N0YXRlKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfZmJjX2luaXRf
cGlwZV9zdGF0ZShpOTE1KTsKPiA+ICAgfQo+ID4gICB2b2lkIGludGVsX2Rpc3BsYXlfcmVzdW1l
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gLQlzdHJ1Y3QgZHJtX2F0b21pY19z
dGF0ZSAqc3RhdGUgPSBkZXZfcHJpdi0+bW9kZXNldF9yZXN0b3JlX3N0YXRlOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlID0gaTkxNS0+bW9kZXNldF9yZXN0b3JlX3N0YXRlOwo+ID4g
ICAJc3RydWN0IGRybV9tb2Rlc2V0X2FjcXVpcmVfY3R4IGN0eDsKPiA+ICAgCWludCByZXQ7Cj4g
PiAtCWRldl9wcml2LT5tb2Rlc2V0X3Jlc3RvcmVfc3RhdGUgPSBOVUxMOwo+ID4gKwlpOTE1LT5t
b2Rlc2V0X3Jlc3RvcmVfc3RhdGUgPSBOVUxMOwo+ID4gICAJaWYgKHN0YXRlKQo+ID4gICAJCXN0
YXRlLT5hY3F1aXJlX2N0eCA9ICZjdHg7Cj4gPiBAQCAtMTY4MzIsNyArMTY4MzIsNyBAQCB2b2lk
IGludGVsX2Rpc3BsYXlfcmVzdW1lKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIAlpZiAo
IXJldCkKPiA+ICAgCQlyZXQgPSBfX2ludGVsX2Rpc3BsYXlfcmVzdW1lKGRldiwgc3RhdGUsICZj
dHgpOwo+ID4gLQlpbnRlbF9lbmFibGVfaXBjKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfZW5hYmxl
X2lwYyhpOTE1KTsKPiA+ICAgCWRybV9tb2Rlc2V0X2Ryb3BfbG9ja3MoJmN0eCk7Cj4gPiAgIAlk
cm1fbW9kZXNldF9hY3F1aXJlX2ZpbmkoJmN0eCk7Cj4gPiBAQCAtMTY4NjIsMTkgKzE2ODYyLDE5
IEBAIHN0YXRpYyB2b2lkIGludGVsX2hwZF9wb2xsX2Zpbmkoc3RydWN0IGRybV9kZXZpY2UgKmRl
dikKPiA+ICAgdm9pZCBpbnRlbF9tb2Rlc2V0X2NsZWFudXAoc3RydWN0IGRybV9kZXZpY2UgKmRl
dikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShk
ZXYpOwo+ID4gLQlmbHVzaF93b3JrcXVldWUoZGV2X3ByaXYtPm1vZGVzZXRfd3EpOwo+ID4gKwlm
bHVzaF93b3JrcXVldWUoaTkxNS0+bW9kZXNldF93cSk7Cj4gPiAtCWZsdXNoX3dvcmsoJmRldl9w
cml2LT5hdG9taWNfaGVscGVyLmZyZWVfd29yayk7Cj4gPiAtCVdBUk5fT04oIWxsaXN0X2VtcHR5
KCZkZXZfcHJpdi0+YXRvbWljX2hlbHBlci5mcmVlX2xpc3QpKTsKPiA+ICsJZmx1c2hfd29yaygm
aTkxNS0+YXRvbWljX2hlbHBlci5mcmVlX3dvcmspOwo+ID4gKwlXQVJOX09OKCFsbGlzdF9lbXB0
eSgmaTkxNS0+YXRvbWljX2hlbHBlci5mcmVlX2xpc3QpKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBJ
bnRlcnJ1cHRzIGFuZCBwb2xsaW5nIGFzIHRoZSBmaXJzdCB0aGluZyB0byBhdm9pZCBjcmVhdGlu
ZyBoYXZvYy4KPiA+ICAgCSAqIFRvbyBtdWNoIHN0dWZmIGhlcmUgKHR1cm5pbmcgb2YgY29ubmVj
dG9ycywgLi4uKSB3b3VsZAo+ID4gICAJICogZXhwZXJpZW5jZSBmYW5jeSByYWNlcyBvdGhlcndp
c2UuCj4gPiAgIAkgKi8KPiA+IC0JaW50ZWxfaXJxX3VuaW5zdGFsbChkZXZfcHJpdik7Cj4gPiAr
CWludGVsX2lycV91bmluc3RhbGwoaTkxNSk7Cj4gPiAgIAkvKgo+ID4gICAJICogRHVlIHRvIHRo
ZSBocGQgaXJxIHN0b3JtIGhhbmRsaW5nIHRoZSBob3RwbHVnIHdvcmsgY2FuIHJlLWFybSB0aGUK
PiA+IEBAIC0xNjg4MywzNyArMTY4ODMsMzcgQEAgdm9pZCBpbnRlbF9tb2Rlc2V0X2NsZWFudXAo
c3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgCWludGVsX2hwZF9wb2xsX2ZpbmkoZGV2KTsK
PiA+ICAgCS8qIHBvbGwgd29yayBjYW4gY2FsbCBpbnRvIGZiZGV2LCBoZW5jZSBjbGVhbiB0aGF0
IHVwIGFmdGVyd2FyZHMgKi8KPiA+IC0JaW50ZWxfZmJkZXZfZmluaShkZXZfcHJpdik7Cj4gPiAr
CWludGVsX2ZiZGV2X2ZpbmkoaTkxNSk7Cj4gPiAgIAlpbnRlbF91bnJlZ2lzdGVyX2RzbV9oYW5k
bGVyKCk7Cj4gPiAtCWludGVsX2ZiY19nbG9iYWxfZGlzYWJsZShkZXZfcHJpdik7Cj4gPiArCWlu
dGVsX2ZiY19nbG9iYWxfZGlzYWJsZShpOTE1KTsKPiA+ICAgCS8qIGZsdXNoIGFueSBkZWxheWVk
IHRhc2tzIG9yIHBlbmRpbmcgd29yayAqLwo+ID4gICAJZmx1c2hfc2NoZWR1bGVkX3dvcmsoKTsK
PiA+IC0JaW50ZWxfaGRjcF9jb21wb25lbnRfZmluaShkZXZfcHJpdik7Cj4gPiArCWludGVsX2hk
Y3BfY29tcG9uZW50X2ZpbmkoaTkxNSk7Cj4gPiAgIAlkcm1fbW9kZV9jb25maWdfY2xlYW51cChk
ZXYpOwo+ID4gLQlpbnRlbF9vdmVybGF5X2NsZWFudXAoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9v
dmVybGF5X2NsZWFudXAoaTkxNSk7Cj4gPiAtCWludGVsX2dtYnVzX3RlYXJkb3duKGRldl9wcml2
KTsKPiA+ICsJaW50ZWxfZ21idXNfdGVhcmRvd24oaTkxNSk7Cj4gPiAtCWRlc3Ryb3lfd29ya3F1
ZXVlKGRldl9wcml2LT5tb2Rlc2V0X3dxKTsKPiA+ICsJZGVzdHJveV93b3JrcXVldWUoaTkxNS0+
bW9kZXNldF93cSk7Cj4gPiAtCWludGVsX2ZiY19jbGVhbnVwX2NmYihkZXZfcHJpdik7Cj4gPiAr
CWludGVsX2ZiY19jbGVhbnVwX2NmYihpOTE1KTsKPiA+ICAgfQo+ID4gICAvKgo+ID4gICAgKiBz
ZXQgdmdhIGRlY29kZSBzdGF0ZSAtIHRydWUgPT0gZW5hYmxlIFZHQSBkZWNvZGUKPiA+ICAgICov
Cj4gPiAtaW50IGludGVsX21vZGVzZXRfdmdhX3NldF9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIGJvb2wgc3RhdGUpCj4gPiAraW50IGludGVsX21vZGVzZXRfdmdhX3Nl
dF9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgYm9vbCBzdGF0ZSkKPiA+ICAg
ewo+ID4gLQl1bnNpZ25lZCByZWcgPSBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYgPyBTTkJfR01D
SF9DVFJMIDogSU5URUxfR01DSF9DVFJMOwo+ID4gKwl1bnNpZ25lZCByZWcgPSBJTlRFTF9HRU4o
aTkxNSkgPj0gNiA/IFNOQl9HTUNIX0NUUkwgOiBJTlRFTF9HTUNIX0NUUkw7Cj4gPiAgIAl1MTYg
Z21jaF9jdHJsOwo+ID4gLQlpZiAocGNpX3JlYWRfY29uZmlnX3dvcmQoZGV2X3ByaXYtPmJyaWRn
ZV9kZXYsIHJlZywgJmdtY2hfY3RybCkpIHsKPiA+ICsJaWYgKHBjaV9yZWFkX2NvbmZpZ193b3Jk
KGk5MTUtPmJyaWRnZV9kZXYsIHJlZywgJmdtY2hfY3RybCkpIHsKPiA+ICAgCQlEUk1fRVJST1Io
ImZhaWxlZCB0byByZWFkIGNvbnRyb2wgd29yZFxuIik7Cj4gPiAgIAkJcmV0dXJuIC1FSU87Cj4g
PiAgIAl9Cj4gPiBAQCAtMTY5MjYsNyArMTY5MjYsNyBAQCBpbnQgaW50ZWxfbW9kZXNldF92Z2Ff
c2V0X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBzdGF0ZSkK
PiA+ICAgCWVsc2UKPiA+ICAgCQlnbWNoX2N0cmwgfD0gSU5URUxfR01DSF9WR0FfRElTQUJMRTsK
PiA+IC0JaWYgKHBjaV93cml0ZV9jb25maWdfd29yZChkZXZfcHJpdi0+YnJpZGdlX2RldiwgcmVn
LCBnbWNoX2N0cmwpKSB7Cj4gPiArCWlmIChwY2lfd3JpdGVfY29uZmlnX3dvcmQoaTkxNS0+YnJp
ZGdlX2RldiwgcmVnLCBnbWNoX2N0cmwpKSB7Cj4gPiAgIAkJRFJNX0VSUk9SKCJmYWlsZWQgdG8g
d3JpdGUgY29udHJvbCB3b3JkXG4iKTsKPiA+ICAgCQlyZXR1cm4gLUVJTzsKPiA+ICAgCX0KPiA+
IEBAIC0xNjk4MCw3ICsxNjk4MCw3IEBAIHN0cnVjdCBpbnRlbF9kaXNwbGF5X2Vycm9yX3N0YXRl
IHsKPiA+ICAgfTsKPiA+ICAgc3RydWN0IGludGVsX2Rpc3BsYXlfZXJyb3Jfc3RhdGUgKgo+ID4g
LWludGVsX2Rpc3BsYXlfY2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiAraW50ZWxfZGlzcGxheV9jYXB0dXJlX2Vycm9yX3N0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlz
cGxheV9lcnJvcl9zdGF0ZSAqZXJyb3I7Cj4gPiAgIAlpbnQgdHJhbnNjb2RlcnNbXSA9IHsKPiA+
IEBAIC0xNjk5MywxOSArMTY5OTMsMTkgQEAgaW50ZWxfZGlzcGxheV9jYXB0dXJlX2Vycm9yX3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCUJVSUxEX0JVR19P
TihBUlJBWV9TSVpFKHRyYW5zY29kZXJzKSAhPSBBUlJBWV9TSVpFKGVycm9yLT50cmFuc2NvZGVy
KSk7Cj4gPiAtCWlmICghSEFTX0RJU1BMQVkoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19ESVNQ
TEFZKGk5MTUpKQo+ID4gICAJCXJldHVybiBOVUxMOwo+ID4gICAJZXJyb3IgPSBremFsbG9jKHNp
emVvZigqZXJyb3IpLCBHRlBfQVRPTUlDKTsKPiA+ICAgCWlmIChlcnJvciA9PSBOVUxMKQo+ID4g
ICAJCXJldHVybiBOVUxMOwo+ID4gLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJP
QURXRUxMKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURX
RUxMKGk5MTUpKQo+ID4gICAJCWVycm9yLT5wb3dlcl93ZWxsX2RyaXZlciA9IEk5MTVfUkVBRChI
U1dfUFdSX1dFTExfQ1RMMik7Cj4gPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIGkpIHsKPiA+
ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBpKSB7Cj4gPiAgIAkJZXJyb3ItPnBpcGVbaV0ucG93ZXJf
ZG9tYWluX29uID0KPiA+IC0JCQlfX2ludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5hYmxlZChkZXZf
cHJpdiwKPiA+ICsJCQlfX2ludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5hYmxlZChpOTE1LAo+ID4g
ICAJCQkJCQkJIFBPV0VSX0RPTUFJTl9QSVBFKGkpKTsKPiA+ICAgCQlpZiAoIWVycm9yLT5waXBl
W2ldLnBvd2VyX2RvbWFpbl9vbikKPiA+ICAgCQkJY29udGludWU7Cj4gPiBAQCAtMTcwMTYsMzIg
KzE3MDE2LDMyIEBAIGludGVsX2Rpc3BsYXlfY2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJZXJyb3ItPnBsYW5lW2ldLmNvbnRyb2wg
PSBJOTE1X1JFQUQoRFNQQ05UUihpKSk7Cj4gPiAgIAkJZXJyb3ItPnBsYW5lW2ldLnN0cmlkZSA9
IEk5MTVfUkVBRChEU1BTVFJJREUoaSkpOwo+ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
PD0gMykgewo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8PSAzKSB7Cj4gPiAgIAkJCWVycm9y
LT5wbGFuZVtpXS5zaXplID0gSTkxNV9SRUFEKERTUFNJWkUoaSkpOwo+ID4gICAJCQllcnJvci0+
cGxhbmVbaV0ucG9zID0gSTkxNV9SRUFEKERTUFBPUyhpKSk7Cj4gPiAgIAkJfQo+ID4gLQkJaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPD0gNyAmJiAhSVNfSEFTV0VMTChkZXZfcHJpdikpCj4gPiAr
CQlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDcgJiYgIUlTX0hBU1dFTEwoaTkxNSkpCj4gPiAgIAkJ
CWVycm9yLT5wbGFuZVtpXS5hZGRyID0gSTkxNV9SRUFEKERTUEFERFIoaSkpOwo+ID4gLQkJaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkgewo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+
PSA0KSB7Cj4gPiAgIAkJCWVycm9yLT5wbGFuZVtpXS5zdXJmYWNlID0gSTkxNV9SRUFEKERTUFNV
UkYoaSkpOwo+ID4gICAJCQllcnJvci0+cGxhbmVbaV0udGlsZV9vZmZzZXQgPSBJOTE1X1JFQUQo
RFNQVElMRU9GRihpKSk7Cj4gPiAgIAkJfQo+ID4gICAJCWVycm9yLT5waXBlW2ldLnNvdXJjZSA9
IEk5MTVfUkVBRChQSVBFU1JDKGkpKTsKPiA+IC0JCWlmIChIQVNfR01DSChkZXZfcHJpdikpCj4g
PiArCQlpZiAoSEFTX0dNQ0goaTkxNSkpCj4gPiAgIAkJCWVycm9yLT5waXBlW2ldLnN0YXQgPSBJ
OTE1X1JFQUQoUElQRVNUQVQoaSkpOwo+ID4gICAJfQo+ID4gICAJZm9yIChpID0gMDsgaSA8IEFS
UkFZX1NJWkUoZXJyb3ItPnRyYW5zY29kZXIpOyBpKyspIHsKPiA+ICAgCQllbnVtIHRyYW5zY29k
ZXIgY3B1X3RyYW5zY29kZXIgPSB0cmFuc2NvZGVyc1tpXTsKPiA+IC0JCWlmICghSU5URUxfSU5G
TyhkZXZfcHJpdiktPnRyYW5zX29mZnNldHNbY3B1X3RyYW5zY29kZXJdKQo+ID4gKwkJaWYgKCFJ
TlRFTF9JTkZPKGk5MTUpLT50cmFuc19vZmZzZXRzW2NwdV90cmFuc2NvZGVyXSkKPiA+ICAgCQkJ
Y29udGludWU7Cj4gPiAgIAkJZXJyb3ItPnRyYW5zY29kZXJbaV0uYXZhaWxhYmxlID0gdHJ1ZTsK
PiA+ICAgCQllcnJvci0+dHJhbnNjb2RlcltpXS5wb3dlcl9kb21haW5fb24gPQo+ID4gLQkJCV9f
aW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGRldl9wcml2LAo+ID4gKwkJCV9faW50ZWxf
ZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGk5MTUsCj4gPiAgIAkJCQlQT1dFUl9ET01BSU5fVFJB
TlNDT0RFUihjcHVfdHJhbnNjb2RlcikpOwo+ID4gICAJCWlmICghZXJyb3ItPnRyYW5zY29kZXJb
aV0ucG93ZXJfZG9tYWluX29uKQo+ID4gICAJCQljb250aW51ZTsKPiA+IEBAIC0xNzA2NiwxNyAr
MTcwNjYsMTcgQEAgdm9pZAo+ID4gICBpbnRlbF9kaXNwbGF5X3ByaW50X2Vycm9yX3N0YXRlKHN0
cnVjdCBkcm1faTkxNV9lcnJvcl9zdGF0ZV9idWYgKm0sCj4gPiAgIAkJCQlzdHJ1Y3QgaW50ZWxf
ZGlzcGxheV9lcnJvcl9zdGF0ZSAqZXJyb3IpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gbS0+aTkxNTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBtLT5pOTE1Owo+ID4gICAJaW50IGk7Cj4gPiAgIAlpZiAoIWVycm9yKQo+ID4g
ICAJCXJldHVybjsKPiA+IC0JZXJyX3ByaW50ZihtLCAiTnVtIFBpcGVzOiAlZFxuIiwgSU5URUxf
SU5GTyhkZXZfcHJpdiktPm51bV9waXBlcyk7Cj4gPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2
KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ID4gKwllcnJfcHJpbnRmKG0sICJOdW0gUGlw
ZXM6ICVkXG4iLCBJTlRFTF9JTkZPKGk5MTUpLT5udW1fcGlwZXMpOwo+ID4gKwlpZiAoSVNfSEFT
V0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gPiAgIAkJZXJyX3ByaW50ZihtLCAi
UFdSX1dFTExfQ1RMMjogJTA4eFxuIiwKPiA+ICAgCQkJICAgZXJyb3ItPnBvd2VyX3dlbGxfZHJp
dmVyKTsKPiA+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgaSkgewo+ID4gKwlmb3JfZWFjaF9w
aXBlKGk5MTUsIGkpIHsKPiA+ICAgCQllcnJfcHJpbnRmKG0sICJQaXBlIFslZF06XG4iLCBpKTsK
PiA+ICAgCQllcnJfcHJpbnRmKG0sICIgIFBvd2VyOiAlc1xuIiwKPiA+ICAgCQkJICAgb25vZmYo
ZXJyb3ItPnBpcGVbaV0ucG93ZXJfZG9tYWluX29uKSk7Cj4gPiBAQCAtMTcwODYsMTMgKzE3MDg2
LDEzIEBAIGludGVsX2Rpc3BsYXlfcHJpbnRfZXJyb3Jfc3RhdGUoc3RydWN0IGRybV9pOTE1X2Vy
cm9yX3N0YXRlX2J1ZiAqbSwKPiA+ICAgCQllcnJfcHJpbnRmKG0sICJQbGFuZSBbJWRdOlxuIiwg
aSk7Cj4gPiAgIAkJZXJyX3ByaW50ZihtLCAiICBDTlRSOiAlMDh4XG4iLCBlcnJvci0+cGxhbmVb
aV0uY29udHJvbCk7Cj4gPiAgIAkJZXJyX3ByaW50ZihtLCAiICBTVFJJREU6ICUwOHhcbiIsIGVy
cm9yLT5wbGFuZVtpXS5zdHJpZGUpOwo+ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0g
Mykgewo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8PSAzKSB7Cj4gPiAgIAkJCWVycl9wcmlu
dGYobSwgIiAgU0laRTogJTA4eFxuIiwgZXJyb3ItPnBsYW5lW2ldLnNpemUpOwo+ID4gICAJCQll
cnJfcHJpbnRmKG0sICIgIFBPUzogJTA4eFxuIiwgZXJyb3ItPnBsYW5lW2ldLnBvcyk7Cj4gPiAg
IAkJfQo+ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNyAmJiAhSVNfSEFTV0VMTChk
ZXZfcHJpdikpCj4gPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDcgJiYgIUlTX0hBU1dFTEwo
aTkxNSkpCj4gPiAgIAkJCWVycl9wcmludGYobSwgIiAgQUREUjogJTA4eFxuIiwgZXJyb3ItPnBs
YW5lW2ldLmFkZHIpOwo+ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkgewo+ID4g
KwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KSB7Cj4gPiAgIAkJCWVycl9wcmludGYobSwgIiAg
U1VSRjogJTA4eFxuIiwgZXJyb3ItPnBsYW5lW2ldLnN1cmZhY2UpOwo+ID4gICAJCQllcnJfcHJp
bnRmKG0sICIgIFRJTEVPRkY6ICUwOHhcbiIsIGVycm9yLT5wbGFuZVtpXS50aWxlX29mZnNldCk7
Cj4gPiAgIAkJfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rp
c3BsYXkuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuaAo+ID4gaW5kZXgg
ZWU2YjgxOTRhNDU5Li43ZTRiNGIxYzBhYzYgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9kaXNwbGF5LmgKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2Rpc3BsYXkuaAo+ID4gQEAgLTEyNSw3ICsxMjUsNyBAQCBlbnVtIGk5eHhfcGxhbmVfaWQg
ewo+ID4gICB9Owo+ID4gICAjZGVmaW5lIHBsYW5lX25hbWUocCkgKChwKSArICdBJykKPiA+IC0j
ZGVmaW5lIHNwcml0ZV9uYW1lKHAsIHMpICgocCkgKiBSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5u
dW1fc3ByaXRlc1socCldICsgKHMpICsgJ0EnKQo+ID4gKyNkZWZpbmUgc3ByaXRlX25hbWUocCwg
cykgKChwKSAqIFJVTlRJTUVfSU5GTyhpOTE1KS0+bnVtX3Nwcml0ZXNbKHApXSArIChzKSArICdB
JykKPiA+ICAgLyoKPiA+ICAgICogUGVyLXBpcGUgcGxhbmUgaWRlbnRpZmllci4KPiA+IEBAIC0z
NTMsOCArMzUzLDggQEAgdm9pZCBpbnRlbF9saW5rX2NvbXB1dGVfbV9uKHUxNiBicHAsIGludCBu
bGFuZXMsCj4gPiAgIAkJCSAgICBzdHJ1Y3QgaW50ZWxfbGlua19tX24gKm1fbiwKPiA+ICAgCQkJ
ICAgIGJvb2wgY29uc3RhbnRfbik7Cj4gPiAgIGJvb2wgaXNfY2NzX21vZGlmaWVyKHU2NCBtb2Rp
Zmllcik7Cj4gPiAtdm9pZCBscHRfZGlzYWJsZV9jbGtvdXRfZHAoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KTsKPiA+IC11MzIgaW50ZWxfcGxhbmVfZmJfbWF4X3N0cmlkZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBscHRfZGlzYWJsZV9jbGtv
dXRfZHAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3UzMiBpbnRlbF9wbGFu
ZV9mYl9tYXhfc3RyaWRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkg
ICAgICB1MzIgcGl4ZWxfZm9ybWF0LCB1NjQgbW9kaWZpZXIpOwo+ID4gICBib29sIGludGVsX3Bs
YW5lX2Nhbl9yZW1hcChjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRl
KTsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bv
d2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMKPiA+IGlu
ZGV4IGJiOWVmMWNlYTVkYi4uOWFjZmFkNWM4M2VmIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheV9wb3dlci5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMKPiA+IEBAIC0xNyw3ICsxNyw3IEBACj4gPiAg
ICNpbmNsdWRlICJpbnRlbF9ob3RwbHVnLmgiCj4gPiAgICNpbmNsdWRlICJpbnRlbF9zaWRlYmFu
ZC5oIgo+ID4gLWJvb2wgaW50ZWxfZGlzcGxheV9wb3dlcl93ZWxsX2lzX2VuYWJsZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2Jvb2wgaW50ZWxfZGlzcGxheV9wb3dl
cl93ZWxsX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJ
CQkJIGVudW0gaTkxNV9wb3dlcl93ZWxsX2lkIHBvd2VyX3dlbGxfaWQpOwo+ID4gICBjb25zdCBj
aGFyICoKPiA+IEBAIC0xMjIsNDIgKzEyMiw0MiBAQCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFp
bl9zdHIoZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pCj4gPiAgIAl9Cj4g
PiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaW50ZWxfcG93ZXJfd2Vs
bF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgc3Ry
dWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiA+ICAgewo+ID4gICAJRFJNX0RFQlVH
X0tNUygiZW5hYmxpbmcgJXNcbiIsIHBvd2VyX3dlbGwtPmRlc2MtPm5hbWUpOwo+ID4gLQlwb3dl
cl93ZWxsLT5kZXNjLT5vcHMtPmVuYWJsZShkZXZfcHJpdiwgcG93ZXJfd2VsbCk7Cj4gPiArCXBv
d2VyX3dlbGwtPmRlc2MtPm9wcy0+ZW5hYmxlKGk5MTUsIHBvd2VyX3dlbGwpOwo+ID4gICAJcG93
ZXJfd2VsbC0+aHdfZW5hYmxlZCA9IHRydWU7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRl
bF9wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3N0YXRpYyB2b2lkIGludGVsX3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93
ZXJfd2VsbCkKPiA+ICAgewo+ID4gICAJRFJNX0RFQlVHX0tNUygiZGlzYWJsaW5nICVzXG4iLCBw
b3dlcl93ZWxsLT5kZXNjLT5uYW1lKTsKPiA+ICAgCXBvd2VyX3dlbGwtPmh3X2VuYWJsZWQgPSBm
YWxzZTsKPiA+IC0JcG93ZXJfd2VsbC0+ZGVzYy0+b3BzLT5kaXNhYmxlKGRldl9wcml2LCBwb3dl
cl93ZWxsKTsKPiA+ICsJcG93ZXJfd2VsbC0+ZGVzYy0+b3BzLT5kaXNhYmxlKGk5MTUsIHBvd2Vy
X3dlbGwpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaW50ZWxfcG93ZXJfd2VsbF9nZXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGludGVsX3Bv
d2VyX3dlbGxfZ2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJIHN0
cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gPiAgIHsKPiA+ICAgCWlmICghcG93
ZXJfd2VsbC0+Y291bnQrKykKPiA+IC0JCWludGVsX3Bvd2VyX3dlbGxfZW5hYmxlKGRldl9wcml2
LCBwb3dlcl93ZWxsKTsKPiA+ICsJCWludGVsX3Bvd2VyX3dlbGxfZW5hYmxlKGk5MTUsIHBvd2Vy
X3dlbGwpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaW50ZWxfcG93ZXJfd2VsbF9wdXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGludGVsX3Bv
d2VyX3dlbGxfcHV0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJIHN0
cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gPiAgIHsKPiA+ICAgCVdBUk4oIXBv
d2VyX3dlbGwtPmNvdW50LCAiVXNlIGNvdW50IG9uIHBvd2VyIHdlbGwgJXMgaXMgYWxyZWFkeSB6
ZXJvIiwKPiA+ICAgCSAgICAgcG93ZXJfd2VsbC0+ZGVzYy0+bmFtZSk7Cj4gPiAgIAlpZiAoIS0t
cG93ZXJfd2VsbC0+Y291bnQpCj4gPiAtCQlpbnRlbF9wb3dlcl93ZWxsX2Rpc2FibGUoZGV2X3By
aXYsIHBvd2VyX3dlbGwpOwo+ID4gKwkJaW50ZWxfcG93ZXJfd2VsbF9kaXNhYmxlKGk5MTUsIHBv
d2VyX3dlbGwpOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBfX2ludGVsX2Rpc3BsYXlfcG93
ZXJfaXNfZW5hYmxlZCAtIHVubG9ja2VkIGNoZWNrIGZvciBhIHBvd2VyIGRvbWFpbgo+ID4gLSAq
IEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZp
Y2UgaW5zdGFuY2UKPiA+ICAgICogQGRvbWFpbjogcG93ZXIgZG9tYWluIHRvIGNoZWNrCj4gPiAg
ICAqCj4gPiAgICAqIFRoaXMgaXMgdGhlIHVubG9ja2VkIHZlcnNpb24gb2YgaW50ZWxfZGlzcGxh
eV9wb3dlcl9pc19lbmFibGVkKCkgYW5kIHNob3VsZAo+ID4gQEAgLTE2NywxOCArMTY3LDE4IEBA
IHN0YXRpYyB2b2lkIGludGVsX3Bvd2VyX3dlbGxfcHV0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICAgICogUmV0dXJuczoKPiA+ICAgICogVHJ1ZSB3aGVuIHRoZSBwb3dl
ciBkb21haW4gaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLgo+ID4gICAgKi8KPiA+IC1ib29s
IF9faW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtib29sIF9faW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgZW51bSBpbnRlbF9k
aXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpOTE1X3Bv
d2VyX3dlbGwgKnBvd2VyX3dlbGw7Cj4gPiAgIAlib29sIGlzX2VuYWJsZWQ7Cj4gPiAtCWlmIChk
ZXZfcHJpdi0+cnVudGltZV9wbS5zdXNwZW5kZWQpCj4gPiArCWlmIChpOTE1LT5ydW50aW1lX3Bt
LnN1c3BlbmRlZCkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAlpc19lbmFibGVkID0gdHJ1
ZTsKPiA+IC0JZm9yX2VhY2hfcG93ZXJfZG9tYWluX3dlbGxfcmV2ZXJzZShkZXZfcHJpdiwgcG93
ZXJfd2VsbCwgQklUX1VMTChkb21haW4pKSB7Cj4gPiArCWZvcl9lYWNoX3Bvd2VyX2RvbWFpbl93
ZWxsX3JldmVyc2UoaTkxNSwgcG93ZXJfd2VsbCwgQklUX1VMTChkb21haW4pKSB7Cj4gPiAgIAkJ
aWYgKHBvd2VyX3dlbGwtPmRlc2MtPmFsd2F5c19vbikKPiA+ICAgCQkJY29udGludWU7Cj4gPiBA
QCAtMTkzLDcgKzE5Myw3IEBAIGJvb2wgX19pbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAvKioKPiA+ICAgICogaW50
ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkIC0gY2hlY2sgZm9yIGEgcG93ZXIgZG9tYWluCj4g
PiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1OiBpOTE1
IGRldmljZSBpbnN0YW5jZQo+ID4gICAgKiBAZG9tYWluOiBwb3dlciBkb21haW4gdG8gY2hlY2sK
PiA+ICAgICoKPiA+ICAgICogVGhpcyBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBjaGVjayB0aGUg
aHcgcG93ZXIgZG9tYWluIHN0YXRlLiBJdCBpcyBtb3N0bHkKPiA+IEBAIC0yMDgsMTYgKzIwOCwx
NiBAQCBib29sIF9faW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgICogUmV0dXJuczoKPiA+ICAgICogVHJ1ZSB3aGVu
IHRoZSBwb3dlciBkb21haW4gaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLgo+ID4gICAgKi8K
PiA+IC1ib29sIGludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArYm9vbCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJs
ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgZW51bSBpbnRl
bF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpOTE1
X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnM7Cj4gPiAgIAlib29sIHJldDsKPiA+IC0JcG93
ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKPiA+ICsJcG93ZXJfZG9tYWlu
cyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOwo+ID4gICAJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlu
cy0+bG9jayk7Cj4gPiAtCXJldCA9IF9faW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGRl
dl9wcml2LCBkb21haW4pOwo+ID4gKwlyZXQgPSBfX2ludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5h
YmxlZChpOTE1LCBkb21haW4pOwo+ID4gICAJbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5s
b2NrKTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiBAQCAtMjI5LDEwICsyMjksMTAgQEAgYm9vbCBp
bnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAgKiB0byBiZSBlbmFibGVkLCBhbmQgaXQgd2lsbCBvbmx5IGJlIGRpc2Fi
bGVkIGlmIG5vbmUgb2YgdGhlIHJlZ2lzdGVycyBpcwo+ID4gICAgKiByZXF1ZXN0aW5nIGl0IHRv
IGJlIGVuYWJsZWQuCj4gPiAgICAqLwo+ID4gLXN0YXRpYyB2b2lkIGhzd19wb3dlcl93ZWxsX3Bv
c3RfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMg
dm9pZCBoc3dfcG93ZXJfd2VsbF9wb3N0X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJCSAgICAgICB1OCBpcnFfcGlwZV9tYXNrLCBib29sIGhhc192Z2EpCj4g
PiAgIHsKPiA+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4g
PiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiAgIAkvKgo+ID4g
ICAJICogQWZ0ZXIgd2UgcmUtZW5hYmxlIHRoZSBwb3dlciB3ZWxsLCBpZiB3ZSB0b3VjaCBWR0Eg
cmVnaXN0ZXIgMHgzZDUKPiA+IEBAIC0yNTEsMzEgKzI1MSwzMSBAQCBzdGF0aWMgdm9pZCBoc3df
cG93ZXJfd2VsbF9wb3N0X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiAgIAl9Cj4gPiAgIAlpZiAoaXJxX3BpcGVfbWFzaykKPiA+IC0JCWdlbjhfaXJxX3Bvd2Vy
X3dlbGxfcG9zdF9lbmFibGUoZGV2X3ByaXYsIGlycV9waXBlX21hc2spOwo+ID4gKwkJZ2VuOF9p
cnFfcG93ZXJfd2VsbF9wb3N0X2VuYWJsZShpOTE1LCBpcnFfcGlwZV9tYXNrKTsKPiA+ICAgfQo+
ID4gLXN0YXRpYyB2b2lkIGhzd19wb3dlcl93ZWxsX3ByZV9kaXNhYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBoc3dfcG93ZXJfd2VsbF9wcmVf
ZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgICB1
OCBpcnFfcGlwZV9tYXNrKQo+ID4gICB7Cj4gPiAgIAlpZiAoaXJxX3BpcGVfbWFzaykKPiA+IC0J
CWdlbjhfaXJxX3Bvd2VyX3dlbGxfcHJlX2Rpc2FibGUoZGV2X3ByaXYsIGlycV9waXBlX21hc2sp
Owo+ID4gKwkJZ2VuOF9pcnFfcG93ZXJfd2VsbF9wcmVfZGlzYWJsZShpOTE1LCBpcnFfcGlwZV9t
YXNrKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGhzd193YWl0X2Zvcl9wb3dlcl93ZWxsX2Vu
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQg
aHN3X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ID4gICAJCQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4g
PiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyAqcmVncyA9IHBv
d2VyX3dlbGwtPmRlc2MtPmhzdy5yZWdzOwo+ID4gICAJaW50IHB3X2lkeCA9IHBvd2VyX3dlbGwt
PmRlc2MtPmhzdy5pZHg7Cj4gPiAgIAkvKiBUaW1lb3V0IGZvciBQVzE6MTAgdXMsIEFVWDpub3Qg
c3BlY2lmaWVkLCBvdGhlciBQV3M6MjAgdXMuICovCj4gPiAtCVdBUk5fT04oaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCVdBUk5fT04oaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiA+ICAgCQkJCQlyZWdzLT5kcml2ZXIsCj4gPiAg
IAkJCQkJSFNXX1BXUl9XRUxMX0NUTF9TVEFURShwd19pZHgpLAo+ID4gICAJCQkJCUhTV19QV1Jf
V0VMTF9DVExfU1RBVEUocHdfaWR4KSwKPiA+ICAgCQkJCQkxKSk7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgdTMyIGhzd19wb3dlcl93ZWxsX3JlcXVlc3RlcnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gK3N0YXRpYyB1MzIgaHN3X3Bvd2VyX3dlbGxfcmVxdWVzdGVycyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgY29uc3Qgc3RydWN0IGk5
MTVfcG93ZXJfd2VsbF9yZWdzICpyZWdzLAo+ID4gICAJCQkJICAgICBpbnQgcHdfaWR4KQo+ID4g
ICB7Cj4gPiBAQCAtMjkxLDcgKzI5MSw3IEBAIHN0YXRpYyB1MzIgaHN3X3Bvd2VyX3dlbGxfcmVx
dWVzdGVycyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXR1cm4g
cmV0Owo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaHN3X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZGlz
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQg
aHN3X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJCQkgICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkK
PiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzICpyZWdzID0g
cG93ZXJfd2VsbC0+ZGVzYy0+aHN3LnJlZ3M7Cj4gPiBAQCAtMzEwLDcgKzMxMCw3IEBAIHN0YXRp
YyB2b2lkIGhzd193YWl0X2Zvcl9wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gICAJICovCj4gPiAgIAl3YWl0X2ZvcigoZGlzYWJsZWQgPSAh
KEk5MTVfUkVBRChyZWdzLT5kcml2ZXIpICYKPiA+ICAgCQkJICAgICAgIEhTV19QV1JfV0VMTF9D
VExfU1RBVEUocHdfaWR4KSkpIHx8Cj4gPiAtCQkgKHJlcXMgPSBoc3dfcG93ZXJfd2VsbF9yZXF1
ZXN0ZXJzKGRldl9wcml2LCByZWdzLCBwd19pZHgpKSwgMSk7Cj4gPiArCQkgKHJlcXMgPSBoc3df
cG93ZXJfd2VsbF9yZXF1ZXN0ZXJzKGk5MTUsIHJlZ3MsIHB3X2lkeCkpLCAxKTsKPiA+ICAgCWlm
IChkaXNhYmxlZCkKPiA+ICAgCQlyZXR1cm47Cj4gPiBAQCAtMzE5LDE2ICszMTksMTYgQEAgc3Rh
dGljIHZvaWQgaHN3X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJICAgICAgISEocmVxcyAmIDEpLCAhIShyZXFzICYg
MiksICEhKHJlcXMgJiA0KSwgISEocmVxcyAmIDgpKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lk
IGdlbjlfd2FpdF9mb3JfcG93ZXJfd2VsbF9mdXNlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgZ2VuOV93YWl0X2Zvcl9wb3dlcl93ZWxsX2Z1c2Vz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJCSAgIGVudW0gc2tsX3Bv
d2VyX2dhdGUgcGcpCj4gPiAgIHsKPiA+ICAgCS8qIFRpbWVvdXQgNXVzIGZvciBQRyMwLCBmb3Ig
b3RoZXIgUEdzIDF1cyAqLwo+ID4gLQlXQVJOX09OKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZk
ZXZfcHJpdi0+dW5jb3JlLCBTS0xfRlVTRV9TVEFUVVMsCj4gPiArCVdBUk5fT04oaW50ZWxfd2Fp
dF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwgU0tMX0ZVU0VfU1RBVFVTLAo+ID4gICAJCQkJ
CVNLTF9GVVNFX1BHX0RJU1RfU1RBVFVTKHBnKSwKPiA+ICAgCQkJCQlTS0xfRlVTRV9QR19ESVNU
X1NUQVRVUyhwZyksIDEpKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGhzd19wb3dlcl93ZWxs
X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZv
aWQgaHN3X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ID4gICAJCQkJICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ID4gICB7Cj4g
PiAgIAljb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX3JlZ3MgKnJlZ3MgPSBwb3dlcl93ZWxs
LT5kZXNjLT5oc3cucmVnczsKPiA+IEBAIC0zMzgsNyArMzM4LDcgQEAgc3RhdGljIHZvaWQgaHN3
X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICAgCXUzMiB2YWw7Cj4gPiAgIAlpZiAod2FpdF9mdXNlcykgewo+ID4gLQkJcGcgPSBJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDExID8gSUNMX1BXX0NUTF9JRFhfVE9fUEcocHdfaWR4KSA6Cj4gPiAr
CQlwZyA9IElOVEVMX0dFTihpOTE1KSA+PSAxMSA/IElDTF9QV19DVExfSURYX1RPX1BHKHB3X2lk
eCkgOgo+ID4gICAJCQkJCQkgU0tMX1BXX0NUTF9JRFhfVE9fUEcocHdfaWR4KTsKPiA+ICAgCQkv
Kgo+ID4gICAJCSAqIEZvciBQVzEgd2UgaGF2ZSB0byB3YWl0IGJvdGggZm9yIHRoZSBQVzAvUEcw
IGZ1c2Ugc3RhdGUKPiA+IEBAIC0zNDgsMTUgKzM0OCwxNSBAQCBzdGF0aWMgdm9pZCBoc3dfcG93
ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
CSAqIGFmdGVyIHRoZSBlbmFibGluZy4KPiA+ICAgCQkgKi8KPiA+ICAgCQlpZiAocGcgPT0gU0tM
X1BHMSkKPiA+IC0JCQlnZW45X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZnVzZXMoZGV2X3ByaXYsIFNL
TF9QRzApOwo+ID4gKwkJCWdlbjlfd2FpdF9mb3JfcG93ZXJfd2VsbF9mdXNlcyhpOTE1LCBTS0xf
UEcwKTsKPiA+ICAgCX0KPiA+ICAgCXZhbCA9IEk5MTVfUkVBRChyZWdzLT5kcml2ZXIpOwo+ID4g
ICAJSTkxNV9XUklURShyZWdzLT5kcml2ZXIsIHZhbCB8IEhTV19QV1JfV0VMTF9DVExfUkVRKHB3
X2lkeCkpOwo+ID4gLQloc3dfd2FpdF9mb3JfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHBv
d2VyX3dlbGwpOwo+ID4gKwloc3dfd2FpdF9mb3JfcG93ZXJfd2VsbF9lbmFibGUoaTkxNSwgcG93
ZXJfd2VsbCk7Cj4gPiAgIAkvKiBEaXNwbGF5IFdBICMxMTc4OiBjbmwgKi8KPiA+IC0JaWYgKElT
X0NBTk5PTkxBS0UoZGV2X3ByaXYpICYmCj4gPiArCWlmIChJU19DQU5OT05MQUtFKGk5MTUpICYm
Cj4gPiAgIAkgICAgcHdfaWR4ID49IEdMS19QV19DVExfSURYX0FVWF9CICYmCj4gPiAgIAkgICAg
cHdfaWR4IDw9IENOTF9QV19DVExfSURYX0FVWF9GKSB7Cj4gPiAgIAkJdmFsID0gSTkxNV9SRUFE
KENOTF9BVVhfQU5BT1ZSRDEocHdfaWR4KSk7Cj4gPiBAQCAtMzY1LDMyICszNjUsMzIgQEAgc3Rh
dGljIHZvaWQgaHN3X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCX0KPiA+ICAgCWlmICh3YWl0X2Z1c2VzKQo+ID4gLQkJZ2VuOV93YWl0
X2Zvcl9wb3dlcl93ZWxsX2Z1c2VzKGRldl9wcml2LCBwZyk7Cj4gPiArCQlnZW45X3dhaXRfZm9y
X3Bvd2VyX3dlbGxfZnVzZXMoaTkxNSwgcGcpOwo+ID4gLQloc3dfcG93ZXJfd2VsbF9wb3N0X2Vu
YWJsZShkZXZfcHJpdiwKPiA+ICsJaHN3X3Bvd2VyX3dlbGxfcG9zdF9lbmFibGUoaTkxNSwKPiA+
ICAgCQkJCSAgIHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5pcnFfcGlwZV9tYXNrLAo+ID4gICAJCQkJ
ICAgcG93ZXJfd2VsbC0+ZGVzYy0+aHN3Lmhhc192Z2EpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgaHN3X3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiArc3RhdGljIHZvaWQgaHN3X3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBv
d2VyX3dlbGwpCj4gPiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVn
cyAqcmVncyA9IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5yZWdzOwo+ID4gICAJaW50IHB3X2lkeCA9
IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5pZHg7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQloc3dfcG93
ZXJfd2VsbF9wcmVfZGlzYWJsZShkZXZfcHJpdiwKPiA+ICsJaHN3X3Bvd2VyX3dlbGxfcHJlX2Rp
c2FibGUoaTkxNSwKPiA+ICAgCQkJCSAgIHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5pcnFfcGlwZV9t
YXNrKTsKPiA+ICAgCXZhbCA9IEk5MTVfUkVBRChyZWdzLT5kcml2ZXIpOwo+ID4gICAJSTkxNV9X
UklURShyZWdzLT5kcml2ZXIsIHZhbCAmIH5IU1dfUFdSX1dFTExfQ1RMX1JFUShwd19pZHgpKTsK
PiA+IC0JaHN3X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZGlzYWJsZShkZXZfcHJpdiwgcG93ZXJfd2Vs
bCk7Cj4gPiArCWhzd193YWl0X2Zvcl9wb3dlcl93ZWxsX2Rpc2FibGUoaTkxNSwgcG93ZXJfd2Vs
bCk7Cj4gPiAgIH0KPiA+ICAgI2RlZmluZSBJQ0xfQVVYX1BXX1RPX1BPUlQocHdfaWR4KQkoKHB3
X2lkeCkgLSBJQ0xfUFdfQ1RMX0lEWF9BVVhfQSkKPiA+ICAgc3RhdGljIHZvaWQKPiA+IC1pY2xf
Y29tYm9fcGh5X2F1eF9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiAraWNsX2NvbWJvX3BoeV9hdXhfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgc3RydWN0IGk5MTVfcG93ZXJf
d2VsbCAqcG93ZXJfd2VsbCkKPiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJf
d2VsbF9yZWdzICpyZWdzID0gcG93ZXJfd2VsbC0+ZGVzYy0+aHN3LnJlZ3M7Cj4gPiBAQCAtNDA0
LDEyICs0MDQsMTIgQEAgaWNsX2NvbWJvX3BoeV9hdXhfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJdmFsID0gSTkxNV9SRUFEKElDTF9Q
T1JUX0NMX0RXMTIocG9ydCkpOwo+ID4gICAJSTkxNV9XUklURShJQ0xfUE9SVF9DTF9EVzEyKHBv
cnQpLCB2YWwgfCBJQ0xfTEFORV9FTkFCTEVfQVVYKTsKPiA+IC0JaHN3X3dhaXRfZm9yX3Bvd2Vy
X3dlbGxfZW5hYmxlKGRldl9wcml2LCBwb3dlcl93ZWxsKTsKPiA+ICsJaHN3X3dhaXRfZm9yX3Bv
d2VyX3dlbGxfZW5hYmxlKGk5MTUsIHBvd2VyX3dlbGwpOwo+ID4gICAJLyogRGlzcGxheSBXQSAj
MTE3ODogaWNsICovCj4gPiAtCWlmIChJU19JQ0VMQUtFKGRldl9wcml2KSAmJgo+ID4gKwlpZiAo
SVNfSUNFTEFLRShpOTE1KSAmJgo+ID4gICAJICAgIHB3X2lkeCA+PSBJQ0xfUFdfQ1RMX0lEWF9B
VVhfQSAmJiBwd19pZHggPD0gSUNMX1BXX0NUTF9JRFhfQVVYX0IgJiYKPiA+IC0JICAgICFpbnRl
bF9iaW9zX2lzX3BvcnRfZWRwKGRldl9wcml2LCBwb3J0KSkgewo+ID4gKwkgICAgIWludGVsX2Jp
b3NfaXNfcG9ydF9lZHAoaTkxNSwgcG9ydCkpIHsKPiA+ICAgCQl2YWwgPSBJOTE1X1JFQUQoSUNM
X0FVWF9BTkFPVlJEMShwd19pZHgpKTsKPiA+ICAgCQl2YWwgfD0gSUNMX0FVWF9BTkFPVlJEMV9F
TkFCTEUgfCBJQ0xfQVVYX0FOQU9WUkQxX0xET19CWVBBU1M7Cj4gPiAgIAkJSTkxNV9XUklURShJ
Q0xfQVVYX0FOQU9WUkQxKHB3X2lkeCksIHZhbCk7Cj4gPiBAQCAtNDE3LDcgKzQxNyw3IEBAIGlj
bF9jb21ib19waHlfYXV4X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZAo+ID4gLWljbF9jb21ib19waHlf
YXV4X3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiAraWNsX2NvbWJvX3BoeV9hdXhfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpw
b3dlcl93ZWxsKQo+ID4gICB7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX3Jl
Z3MgKnJlZ3MgPSBwb3dlcl93ZWxsLT5kZXNjLT5oc3cucmVnczsKPiA+IEBAIC00MzEsMTQgKzQz
MSwxNCBAQCBpY2xfY29tYm9fcGh5X2F1eF9wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJdmFsID0gSTkxNV9SRUFEKHJlZ3MtPmRyaXZl
cik7Cj4gPiAgIAlJOTE1X1dSSVRFKHJlZ3MtPmRyaXZlciwgdmFsICYgfkhTV19QV1JfV0VMTF9D
VExfUkVRKHB3X2lkeCkpOwo+ID4gLQloc3dfd2FpdF9mb3JfcG93ZXJfd2VsbF9kaXNhYmxlKGRl
dl9wcml2LCBwb3dlcl93ZWxsKTsKPiA+ICsJaHN3X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZGlzYWJs
ZShpOTE1LCBwb3dlcl93ZWxsKTsKPiA+ICAgfQo+ID4gICAjZGVmaW5lIElDTF9BVVhfUFdfVE9f
Q0gocHdfaWR4KQlcCj4gPiAgIAkoKHB3X2lkeCkgLSBJQ0xfUFdfQ1RMX0lEWF9BVVhfQSArIEFV
WF9DSF9BKQo+ID4gICBzdGF0aWMgdm9pZAo+ID4gLWljbF90Y19waHlfYXV4X3Bvd2VyX3dlbGxf
ZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpY2xfdGNfcGh5
X2F1eF9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+
ICAgCQkJCSBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ID4gICB7Cj4gPiAg
IAllbnVtIGF1eF9jaCBhdXhfY2ggPSBJQ0xfQVVYX1BXX1RPX0NIKHBvd2VyX3dlbGwtPmRlc2Mt
Pmhzdy5pZHgpOwo+ID4gQEAgLTQ1MCw3ICs0NTAsNyBAQCBpY2xfdGNfcGh5X2F1eF9wb3dlcl93
ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJdmFs
IHw9IERQX0FVWF9DSF9DVExfVEJUX0lPOwo+ID4gICAJSTkxNV9XUklURShEUF9BVVhfQ0hfQ1RM
KGF1eF9jaCksIHZhbCk7Cj4gPiAtCWhzd19wb3dlcl93ZWxsX2VuYWJsZShkZXZfcHJpdiwgcG93
ZXJfd2VsbCk7Cj4gPiArCWhzd19wb3dlcl93ZWxsX2VuYWJsZShpOTE1LCBwb3dlcl93ZWxsKTsK
PiA+ICAgfQo+ID4gICAvKgo+ID4gQEAgLTQ1OCw3ICs0NTgsNyBAQCBpY2xfdGNfcGh5X2F1eF9w
b3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAg
ICAqIGVuYWJsZSBpdCwgc28gY2hlY2sgaWYgaXQncyBlbmFibGVkIGFuZCBhbHNvIGNoZWNrIGlm
IHdlJ3ZlIHJlcXVlc3RlZCBpdCB0bwo+ID4gICAgKiBiZSBlbmFibGVkLgo+ID4gICAgKi8KPiA+
IC1zdGF0aWMgYm9vbCBoc3dfcG93ZXJfd2VsbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgYm9vbCBoc3dfcG93ZXJfd2VsbF9lbmFibGVkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgc3RydWN0IGk5MTVfcG93
ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0IGk5MTVfcG93
ZXJfd2VsbF9yZWdzICpyZWdzID0gcG93ZXJfd2VsbC0+ZGVzYy0+aHN3LnJlZ3M7Cj4gPiBAQCAt
NDc2LDE0ICs0NzYsMTQgQEAgc3RhdGljIGJvb2wgaHN3X3Bvd2VyX3dlbGxfZW5hYmxlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkgKiBCSU9TJ3Mgb3duIHJlcXVl
c3QgYml0cywgd2hpY2ggYXJlIGZvcmNlZC1vbiBmb3IgdGhlc2UgcG93ZXIgd2VsbHMKPiA+ICAg
CSAqIHdoZW4gZXhpdGluZyBEQzUvNi4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSVNfR0VOKGRldl9w
cml2LCA5KSAmJiAhSVNfR0VOOV9MUChkZXZfcHJpdikgJiYKPiA+ICsJaWYgKElTX0dFTihpOTE1
LCA5KSAmJiAhSVNfR0VOOV9MUChpOTE1KSAmJgo+ID4gICAJICAgIChpZCA9PSBTS0xfRElTUF9Q
V18xIHx8IGlkID09IFNLTF9ESVNQX1BXX01JU0NfSU8pKQo+ID4gICAJCXZhbCB8PSBJOTE1X1JF
QUQocmVncy0+Ymlvcyk7Cj4gPiAgIAlyZXR1cm4gKHZhbCAmIG1hc2spID09IG1hc2s7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCBhc3NlcnRfY2FuX2VuYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGFzc2VydF9jYW5fZW5hYmxlX2Rj
OShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJV0FSTl9PTkNF
KChJOTE1X1JFQUQoRENfU1RBVEVfRU4pICYgRENfU1RBVEVfRU5fREM5KSwKPiA+ICAgCQkgICJE
QzkgYWxyZWFkeSBwcm9ncmFtbWVkIHRvIGJlIGVuYWJsZWQuXG4iKTsKPiA+IEBAIC00OTIsNyAr
NDkyLDcgQEAgc3RhdGljIHZvaWQgYXNzZXJ0X2Nhbl9lbmFibGVfZGM5KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCVdBUk5fT05DRShJOTE1X1JFQUQoSFNXX1BXUl9X
RUxMX0NUTDIpICYKPiA+ICAgCQkgIEhTV19QV1JfV0VMTF9DVExfUkVRKFNLTF9QV19DVExfSURY
X1BXXzIpLAo+ID4gICAJCSAgIlBvd2VyIHdlbGwgMiBvbi5cbiIpOwo+ID4gLQlXQVJOX09OQ0Uo
aW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSwKPiA+ICsJV0FSTl9PTkNFKGludGVsX2lycXNf
ZW5hYmxlZChpOTE1KSwKPiA+ICAgCQkgICJJbnRlcnJ1cHRzIG5vdCBkaXNhYmxlZCB5ZXQuXG4i
KTsKPiA+ICAgCSAvKgo+ID4gQEAgLTUwNCw5ICs1MDQsOSBAQCBzdGF0aWMgdm9pZCBhc3NlcnRf
Y2FuX2VuYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJ
ICAqLwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgYXNzZXJ0X2Nhbl9kaXNhYmxlX2RjOShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgYXNzZXJ0X2Nh
bl9kaXNhYmxlX2RjOShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4g
LQlXQVJOX09OQ0UoaW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSwKPiA+ICsJV0FSTl9PTkNF
KGludGVsX2lycXNfZW5hYmxlZChpOTE1KSwKPiA+ICAgCQkgICJJbnRlcnJ1cHRzIG5vdCBkaXNh
YmxlZCB5ZXQuXG4iKTsKPiA+ICAgCVdBUk5fT05DRShJOTE1X1JFQUQoRENfU1RBVEVfRU4pICYg
RENfU1RBVEVfRU5fVVBUT19EQzUsCj4gPiAgIAkJICAiREM1IHN0aWxsIG5vdCBkaXNhYmxlZC5c
biIpOwo+ID4gQEAgLTUyMCw3ICs1MjAsNyBAQCBzdGF0aWMgdm9pZCBhc3NlcnRfY2FuX2Rpc2Fi
bGVfZGM5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAgKi8KPiA+
ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGdlbjlfd3JpdGVfZGNfc3RhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGdlbjlfd3JpdGVfZGNfc3RhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQl1MzIgc3RhdGUpCj4gPiAg
IHsKPiA+ICAgCWludCByZXdyaXRlcyA9IDA7Cj4gPiBAQCAtNTU3LDE0ICs1NTcsMTQgQEAgc3Rh
dGljIHZvaWQgZ2VuOV93cml0ZV9kY19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAgIAkJCSAgICAgIHN0YXRlLCByZXdyaXRlcyk7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgdTMyIGdlbjlfZGNfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiArc3RhdGljIHUzMiBnZW45X2RjX21hc2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+ICAgCXUzMiBtYXNrOwo+ID4gICAJbWFzayA9IERDX1NUQVRFX0VOX1VQVE9f
REM1Owo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiA+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSAxMSkKPiA+ICAgCQltYXNrIHw9IERDX1NUQVRFX0VOX1VQVE9fREM2IHwg
RENfU1RBVEVfRU5fREM5Owo+ID4gLQllbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkKPiA+
ICsJZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiA+ICAgCQltYXNrIHw9IERDX1NUQVRFX0VO
X0RDOTsKPiA+ICAgCWVsc2UKPiA+ICAgCQltYXNrIHw9IERDX1NUQVRFX0VOX1VQVE9fREM2Owo+
ID4gQEAgLTU3MiwyMCArNTcyLDIwIEBAIHN0YXRpYyB1MzIgZ2VuOV9kY19tYXNrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXJldHVybiBtYXNrOwo+ID4gICB9Cj4g
PiAtdm9pZCBnZW45X3Nhbml0aXplX2RjX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICt2b2lkIGdlbjlfc2FuaXRpemVfZGNfc3RhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAtCXZhbCA9IEk5MTVf
UkVBRChEQ19TVEFURV9FTikgJiBnZW45X2RjX21hc2soZGV2X3ByaXYpOwo+ID4gKwl2YWwgPSBJ
OTE1X1JFQUQoRENfU1RBVEVfRU4pICYgZ2VuOV9kY19tYXNrKGk5MTUpOwo+ID4gICAJRFJNX0RF
QlVHX0tNUygiUmVzZXR0aW5nIERDIHN0YXRlIHRyYWNraW5nIGZyb20gJTAyeCB0byAlMDJ4XG4i
LAo+ID4gLQkJICAgICAgZGV2X3ByaXYtPmNzci5kY19zdGF0ZSwgdmFsKTsKPiA+IC0JZGV2X3By
aXYtPmNzci5kY19zdGF0ZSA9IHZhbDsKPiA+ICsJCSAgICAgIGk5MTUtPmNzci5kY19zdGF0ZSwg
dmFsKTsKPiA+ICsJaTkxNS0+Y3NyLmRjX3N0YXRlID0gdmFsOwo+ID4gICB9Cj4gPiAgIC8qKgo+
ID4gICAgKiBnZW45X3NldF9kY19zdGF0ZSAtIHNldCB0YXJnZXQgZGlzcGxheSBDIHBvd2VyIHN0
YXRlCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1
OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gICAgKiBAc3RhdGU6IHRhcmdldCBEQyBwb3dlciBz
dGF0ZQo+ID4gICAgKiAtIERDX1NUQVRFX0RJU0FCTEUKPiA+ICAgICogLSBEQ19TVEFURV9FTl9V
UFRPX0RDNQo+ID4gQEAgLTYwNiwzNSArNjA2LDM1IEBAIHZvaWQgZ2VuOV9zYW5pdGl6ZV9kY19z
dGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgICAqIGJhY2sgb24g
YW5kIHJlZ2lzdGVyIHN0YXRlIGlzIHJlc3RvcmVkLiBUaGlzIGlzIGd1YXJhbnRlZWQgYnkgdGhl
IE1NSU8gd3JpdGUKPiA+ICAgICogdG8gRENfU1RBVEVfRU4gYmxvY2tpbmcgdW50aWwgdGhlIHN0
YXRlIGlzIHJlc3RvcmVkLgo+ID4gICAgKi8KPiA+IC1zdGF0aWMgdm9pZCBnZW45X3NldF9kY19z
dGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBzdGF0ZSkKPiA+ICtz
dGF0aWMgdm9pZCBnZW45X3NldF9kY19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwgdTMyIHN0YXRlKQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gICAJdTMyIG1hc2s7Cj4g
PiAtCWlmIChXQVJOX09OX09OQ0Uoc3RhdGUgJiB+ZGV2X3ByaXYtPmNzci5hbGxvd2VkX2RjX21h
c2spKQo+ID4gLQkJc3RhdGUgJj0gZGV2X3ByaXYtPmNzci5hbGxvd2VkX2RjX21hc2s7Cj4gPiAr
CWlmIChXQVJOX09OX09OQ0Uoc3RhdGUgJiB+aTkxNS0+Y3NyLmFsbG93ZWRfZGNfbWFzaykpCj4g
PiArCQlzdGF0ZSAmPSBpOTE1LT5jc3IuYWxsb3dlZF9kY19tYXNrOwo+ID4gICAJdmFsID0gSTkx
NV9SRUFEKERDX1NUQVRFX0VOKTsKPiA+IC0JbWFzayA9IGdlbjlfZGNfbWFzayhkZXZfcHJpdik7
Cj4gPiArCW1hc2sgPSBnZW45X2RjX21hc2soaTkxNSk7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJT
ZXR0aW5nIERDIHN0YXRlIGZyb20gJTAyeCB0byAlMDJ4XG4iLAo+ID4gICAJCSAgICAgIHZhbCAm
IG1hc2ssIHN0YXRlKTsKPiA+ICAgCS8qIENoZWNrIGlmIERNQyBpcyBpZ25vcmluZyBvdXIgREMg
c3RhdGUgcmVxdWVzdHMgKi8KPiA+IC0JaWYgKCh2YWwgJiBtYXNrKSAhPSBkZXZfcHJpdi0+Y3Ny
LmRjX3N0YXRlKQo+ID4gKwlpZiAoKHZhbCAmIG1hc2spICE9IGk5MTUtPmNzci5kY19zdGF0ZSkK
PiA+ICAgCQlEUk1fRVJST1IoIkRDIHN0YXRlIG1pc21hdGNoICgweCV4IC0+IDB4JXgpXG4iLAo+
ID4gLQkJCSAgZGV2X3ByaXYtPmNzci5kY19zdGF0ZSwgdmFsICYgbWFzayk7Cj4gPiArCQkJICBp
OTE1LT5jc3IuZGNfc3RhdGUsIHZhbCAmIG1hc2spOwo+ID4gICAJdmFsICY9IH5tYXNrOwo+ID4g
ICAJdmFsIHw9IHN0YXRlOwo+ID4gLQlnZW45X3dyaXRlX2RjX3N0YXRlKGRldl9wcml2LCB2YWwp
Owo+ID4gKwlnZW45X3dyaXRlX2RjX3N0YXRlKGk5MTUsIHZhbCk7Cj4gPiAtCWRldl9wcml2LT5j
c3IuZGNfc3RhdGUgPSB2YWwgJiBtYXNrOwo+ID4gKwlpOTE1LT5jc3IuZGNfc3RhdGUgPSB2YWwg
JiBtYXNrOwo+ID4gICB9Cj4gPiAtdm9pZCBieHRfZW5hYmxlX2RjOShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBieHRfZW5hYmxlX2RjOShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlhc3NlcnRfY2FuX2VuYWJsZV9kYzkoZGV2
X3ByaXYpOwo+ID4gKwlhc3NlcnRfY2FuX2VuYWJsZV9kYzkoaTkxNSk7Cj4gPiAgIAlEUk1fREVC
VUdfS01TKCJFbmFibGluZyBEQzlcbiIpOwo+ID4gICAJLyoKPiA+IEBAIC02NDIsMjMgKzY0Miwy
MyBAQCB2b2lkIGJ4dF9lbmFibGVfZGM5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICAgCSAqIHBsYXRmb3JtcyB3aXRoIFNvdXRoIERpc3BsYXkgRW5naW5lIG9uIFBDSCwK
PiA+ICAgCSAqIGJlY2F1c2UgUFBTIHJlZ2lzdGVycyBhcmUgYWx3YXlzIG9uLgo+ID4gICAJICov
Cj4gPiAtCWlmICghSEFTX1BDSF9TUExJVChkZXZfcHJpdikpCj4gPiAtCQlpbnRlbF9wb3dlcl9z
ZXF1ZW5jZXJfcmVzZXQoZGV2X3ByaXYpOwo+ID4gLQlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJp
diwgRENfU1RBVEVfRU5fREM5KTsKPiA+ICsJaWYgKCFIQVNfUENIX1NQTElUKGk5MTUpKQo+ID4g
KwkJaW50ZWxfcG93ZXJfc2VxdWVuY2VyX3Jlc2V0KGk5MTUpOwo+ID4gKwlnZW45X3NldF9kY19z
dGF0ZShpOTE1LCBEQ19TVEFURV9FTl9EQzkpOwo+ID4gICB9Cj4gPiAtdm9pZCBieHRfZGlzYWJs
ZV9kYzkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgYnh0X2Rp
c2FibGVfZGM5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWFz
c2VydF9jYW5fZGlzYWJsZV9kYzkoZGV2X3ByaXYpOwo+ID4gKwlhc3NlcnRfY2FuX2Rpc2FibGVf
ZGM5KGk5MTUpOwo+ID4gICAJRFJNX0RFQlVHX0tNUygiRGlzYWJsaW5nIERDOVxuIik7Cj4gPiAt
CWdlbjlfc2V0X2RjX3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9ESVNBQkxFKTsKPiA+ICsJZ2Vu
OV9zZXRfZGNfc3RhdGUoaTkxNSwgRENfU1RBVEVfRElTQUJMRSk7Cj4gPiAtCWludGVsX3Bwc191
bmxvY2tfcmVnc193YShkZXZfcHJpdik7Cj4gPiArCWludGVsX3Bwc191bmxvY2tfcmVnc193YShp
OTE1KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGFzc2VydF9jc3JfbG9hZGVkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBhc3NlcnRfY3NyX2xv
YWRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJV0FSTl9P
TkNFKCFJOTE1X1JFQUQoQ1NSX1BST0dSQU0oMCkpLAo+ID4gICAJCSAgIkNTUiBwcm9ncmFtIHN0
b3JhZ2Ugc3RhcnQgaXMgTlVMTFxuIik7Cj4gPiBAQCAtNjY3LDEyICs2NjcsMTIgQEAgc3RhdGlj
IHZvaWQgYXNzZXJ0X2Nzcl9sb2FkZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gICB9Cj4gPiAgIHN0YXRpYyBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICoKPiA+IC1sb29r
dXBfcG93ZXJfd2VsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArbG9v
a3VwX3Bvd2VyX3dlbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICBl
bnVtIGk5MTVfcG93ZXJfd2VsbF9pZCBwb3dlcl93ZWxsX2lkKQo+ID4gICB7Cj4gPiAgIAlzdHJ1
Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsOwo+ID4gLQlmb3JfZWFjaF9wb3dlcl93ZWxs
KGRldl9wcml2LCBwb3dlcl93ZWxsKQo+ID4gKwlmb3JfZWFjaF9wb3dlcl93ZWxsKGk5MTUsIHBv
d2VyX3dlbGwpCj4gPiAgIAkJaWYgKHBvd2VyX3dlbGwtPmRlc2MtPmlkID09IHBvd2VyX3dlbGxf
aWQpCj4gPiAgIAkJCXJldHVybiBwb3dlcl93ZWxsOwo+ID4gQEAgLTY4NCw2MiArNjg0LDYyIEBA
IGxvb2t1cF9wb3dlcl93ZWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICAgCSAqIG91ciBkcml2ZXIuCj4gPiAgIAkgKi8KPiA+ICAgCVdBUk4oMSwgIlBvd2VyIHdlbGwg
JWQgbm90IGRlZmluZWQgZm9yIHRoaXMgcGxhdGZvcm1cbiIsIHBvd2VyX3dlbGxfaWQpOwo+ID4g
LQlyZXR1cm4gJmRldl9wcml2LT5wb3dlcl9kb21haW5zLnBvd2VyX3dlbGxzWzBdOwo+ID4gKwly
ZXR1cm4gJmk5MTUtPnBvd2VyX2RvbWFpbnMucG93ZXJfd2VsbHNbMF07Cj4gPiAgIH0KPiA+IC1z
dGF0aWMgdm9pZCBhc3NlcnRfY2FuX2VuYWJsZV9kYzUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGFzc2VydF9jYW5fZW5hYmxlX2RjNShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlib29sIHBnMl9lbmFibGVkID0g
aW50ZWxfZGlzcGxheV9wb3dlcl93ZWxsX2lzX2VuYWJsZWQoZGV2X3ByaXYsCj4gPiArCWJvb2wg
cGcyX2VuYWJsZWQgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX3dlbGxfaXNfZW5hYmxlZChpOTE1LAo+
ID4gICAJCQkJCVNLTF9ESVNQX1BXXzIpOwo+ID4gICAJV0FSTl9PTkNFKHBnMl9lbmFibGVkLCAi
UEcyIG5vdCBkaXNhYmxlZCB0byBlbmFibGUgREM1LlxuIik7Cj4gPiAgIAlXQVJOX09OQ0UoKEk5
MTVfUkVBRChEQ19TVEFURV9FTikgJiBEQ19TVEFURV9FTl9VUFRPX0RDNSksCj4gPiAgIAkJICAi
REM1IGFscmVhZHkgcHJvZ3JhbW1lZCB0byBiZSBlbmFibGVkLlxuIik7Cj4gPiAtCWFzc2VydF9y
cG1fd2FrZWxvY2tfaGVsZChkZXZfcHJpdik7Cj4gPiArCWFzc2VydF9ycG1fd2FrZWxvY2tfaGVs
ZChpOTE1KTsKPiA+IC0JYXNzZXJ0X2Nzcl9sb2FkZWQoZGV2X3ByaXYpOwo+ID4gKwlhc3NlcnRf
Y3NyX2xvYWRlZChpOTE1KTsKPiA+ICAgfQo+ID4gLXZvaWQgZ2VuOV9lbmFibGVfZGM1KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGdlbjlfZW5hYmxlX2RjNShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlhc3NlcnRfY2FuX2Vu
YWJsZV9kYzUoZGV2X3ByaXYpOwo+ID4gKwlhc3NlcnRfY2FuX2VuYWJsZV9kYzUoaTkxNSk7Cj4g
PiAgIAlEUk1fREVCVUdfS01TKCJFbmFibGluZyBEQzVcbiIpOwo+ID4gICAJLyogV2EgRGlzcGxh
eSAjMTE4Mzogc2tsLGtibCxjZmwgKi8KPiA+IC0JaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKQo+
ID4gKwlpZiAoSVNfR0VOOV9CQyhpOTE1KSkKPiA+ICAgCQlJOTE1X1dSSVRFKEdFTjhfQ0hJQ0tF
Tl9EQ1BSXzEsIEk5MTVfUkVBRChHRU44X0NISUNLRU5fRENQUl8xKSB8Cj4gPiAgIAkJCSAgIFNL
TF9TRUxFQ1RfQUxURVJOQVRFX0RDX0VYSVQpOwo+ID4gLQlnZW45X3NldF9kY19zdGF0ZShkZXZf
cHJpdiwgRENfU1RBVEVfRU5fVVBUT19EQzUpOwo+ID4gKwlnZW45X3NldF9kY19zdGF0ZShpOTE1
LCBEQ19TVEFURV9FTl9VUFRPX0RDNSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBhc3NlcnRf
Y2FuX2VuYWJsZV9kYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0
YXRpYyB2b2lkIGFzc2VydF9jYW5fZW5hYmxlX2RjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gICAJV0FSTl9PTkNFKEk5MTVfUkVBRChVVElMX1BJTl9DVEwpICYg
VVRJTF9QSU5fRU5BQkxFLAo+ID4gICAJCSAgIkJhY2tsaWdodCBpcyBub3QgZGlzYWJsZWQuXG4i
KTsKPiA+ICAgCVdBUk5fT05DRSgoSTkxNV9SRUFEKERDX1NUQVRFX0VOKSAmIERDX1NUQVRFX0VO
X1VQVE9fREM2KSwKPiA+ICAgCQkgICJEQzYgYWxyZWFkeSBwcm9ncmFtbWVkIHRvIGJlIGVuYWJs
ZWQuXG4iKTsKPiA+IC0JYXNzZXJ0X2Nzcl9sb2FkZWQoZGV2X3ByaXYpOwo+ID4gKwlhc3NlcnRf
Y3NyX2xvYWRlZChpOTE1KTsKPiA+ICAgfQo+ID4gLXZvaWQgc2tsX2VuYWJsZV9kYzYoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgc2tsX2VuYWJsZV9kYzYoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JYXNzZXJ0X2Nhbl9lbmFi
bGVfZGM2KGRldl9wcml2KTsKPiA+ICsJYXNzZXJ0X2Nhbl9lbmFibGVfZGM2KGk5MTUpOwo+ID4g
ICAJRFJNX0RFQlVHX0tNUygiRW5hYmxpbmcgREM2XG4iKTsKPiA+ICAgCS8qIFdhIERpc3BsYXkg
IzExODM6IHNrbCxrYmwsY2ZsICovCj4gPiAtCWlmIChJU19HRU45X0JDKGRldl9wcml2KSkKPiA+
ICsJaWYgKElTX0dFTjlfQkMoaTkxNSkpCj4gPiAgIAkJSTkxNV9XUklURShHRU44X0NISUNLRU5f
RENQUl8xLCBJOTE1X1JFQUQoR0VOOF9DSElDS0VOX0RDUFJfMSkgfAo+ID4gICAJCQkgICBTS0xf
U0VMRUNUX0FMVEVSTkFURV9EQ19FWElUKTsKPiA+IC0JZ2VuOV9zZXRfZGNfc3RhdGUoZGV2X3By
aXYsIERDX1NUQVRFX0VOX1VQVE9fREM2KTsKPiA+ICsJZ2VuOV9zZXRfZGNfc3RhdGUoaTkxNSwg
RENfU1RBVEVfRU5fVVBUT19EQzYpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaHN3X3Bvd2Vy
X3dlbGxfc3luY19odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3Rh
dGljIHZvaWQgaHN3X3Bvd2VyX3dlbGxfc3luY19odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4g
PiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyAqcmVncyA9IHBv
d2VyX3dlbGwtPmRlc2MtPmhzdy5yZWdzOwo+ID4gQEAgLTc1Nyw1MiArNzU3LDUyIEBAIHN0YXRp
YyB2b2lkIGhzd19wb3dlcl93ZWxsX3N5bmNfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAJfQo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgYnh0X2RwaW9fY21uX3Bv
d2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtz
dGF0aWMgdm9pZCBieHRfZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93
ZXJfd2VsbCkKPiA+ICAgewo+ID4gLQlieHRfZGRpX3BoeV9pbml0KGRldl9wcml2LCBwb3dlcl93
ZWxsLT5kZXNjLT5ieHQucGh5KTsKPiA+ICsJYnh0X2RkaV9waHlfaW5pdChpOTE1LCBwb3dlcl93
ZWxsLT5kZXNjLT5ieHQucGh5KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGJ4dF9kcGlvX2Nt
bl9wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3N0YXRpYyB2b2lkIGJ4dF9kcGlvX2Ntbl9wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJICAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dl
bGwgKnBvd2VyX3dlbGwpCj4gPiAgIHsKPiA+IC0JYnh0X2RkaV9waHlfdW5pbml0KGRldl9wcml2
LCBwb3dlcl93ZWxsLT5kZXNjLT5ieHQucGh5KTsKPiA+ICsJYnh0X2RkaV9waHlfdW5pbml0KGk5
MTUsIHBvd2VyX3dlbGwtPmRlc2MtPmJ4dC5waHkpOwo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wg
Ynh0X2RwaW9fY21uX3Bvd2VyX3dlbGxfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiArc3RhdGljIGJvb2wgYnh0X2RwaW9fY21uX3Bvd2VyX3dlbGxfZW5hYmxl
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICAgc3RydWN0IGk5
MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiA+ICAgewo+ID4gLQlyZXR1cm4gYnh0X2RkaV9w
aHlfaXNfZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJfd2VsbC0+ZGVzYy0+Ynh0LnBoeSk7Cj4gPiAr
CXJldHVybiBieHRfZGRpX3BoeV9pc19lbmFibGVkKGk5MTUsIHBvd2VyX3dlbGwtPmRlc2MtPmJ4
dC5waHkpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgYnh0X3ZlcmlmeV9kZGlfcGh5X3Bvd2Vy
X3dlbGxzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9p
ZCBieHRfdmVyaWZ5X2RkaV9waHlfcG93ZXJfd2VsbHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGw7
Cj4gPiAtCXBvd2VyX3dlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgQlhUX0RJU1Bf
UFdfRFBJT19DTU5fQSk7Cj4gPiArCXBvd2VyX3dlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChpOTE1
LCBCWFRfRElTUF9QV19EUElPX0NNTl9BKTsKPiA+ICAgCWlmIChwb3dlcl93ZWxsLT5jb3VudCA+
IDApCj4gPiAtCQlieHRfZGRpX3BoeV92ZXJpZnlfc3RhdGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwt
PmRlc2MtPmJ4dC5waHkpOwo+ID4gKwkJYnh0X2RkaV9waHlfdmVyaWZ5X3N0YXRlKGk5MTUsIHBv
d2VyX3dlbGwtPmRlc2MtPmJ4dC5waHkpOwo+ID4gLQlwb3dlcl93ZWxsID0gbG9va3VwX3Bvd2Vy
X3dlbGwoZGV2X3ByaXYsIFZMVl9ESVNQX1BXX0RQSU9fQ01OX0JDKTsKPiA+ICsJcG93ZXJfd2Vs
bCA9IGxvb2t1cF9wb3dlcl93ZWxsKGk5MTUsIFZMVl9ESVNQX1BXX0RQSU9fQ01OX0JDKTsKPiA+
ICAgCWlmIChwb3dlcl93ZWxsLT5jb3VudCA+IDApCj4gPiAtCQlieHRfZGRpX3BoeV92ZXJpZnlf
c3RhdGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwtPmRlc2MtPmJ4dC5waHkpOwo+ID4gKwkJYnh0X2Rk
aV9waHlfdmVyaWZ5X3N0YXRlKGk5MTUsIHBvd2VyX3dlbGwtPmRlc2MtPmJ4dC5waHkpOwo+ID4g
LQlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiA+IC0JCXBvd2VyX3dlbGwgPSBsb29r
dXBfcG93ZXJfd2VsbChkZXZfcHJpdiwKPiA+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpIHsK
PiA+ICsJCXBvd2VyX3dlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChpOTE1LAo+ID4gICAJCQkJCSAg
ICAgICBHTEtfRElTUF9QV19EUElPX0NNTl9DKTsKPiA+ICAgCQlpZiAocG93ZXJfd2VsbC0+Y291
bnQgPiAwKQo+ID4gLQkJCWJ4dF9kZGlfcGh5X3ZlcmlmeV9zdGF0ZShkZXZfcHJpdiwKPiA+ICsJ
CQlieHRfZGRpX3BoeV92ZXJpZnlfc3RhdGUoaTkxNSwKPiA+ICAgCQkJCQkJIHBvd2VyX3dlbGwt
PmRlc2MtPmJ4dC5waHkpOwo+ID4gICAJfQo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wgZ2VuOV9k
Y19vZmZfcG93ZXJfd2VsbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICtzdGF0aWMgYm9vbCBnZW45X2RjX29mZl9wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJICAgc3RydWN0IGk5MTVfcG93ZXJf
d2VsbCAqcG93ZXJfd2VsbCkKPiA+ICAgewo+ID4gICAJcmV0dXJuIChJOTE1X1JFQUQoRENfU1RB
VEVfRU4pICYgRENfU1RBVEVfRU5fVVBUT19EQzVfREM2X01BU0spID09IDA7Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgdm9pZCBnZW45X2Fzc2VydF9kYnVmX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGdlbjlfYXNzZXJ0X2RidWZfZW5hYmxl
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIHRtcCA9
IEk5MTVfUkVBRChEQlVGX0NUTCk7Cj4gPiBAQCAtODExLDkyICs4MTEsOTIgQEAgc3RhdGljIHZv
aWQgZ2VuOV9hc3NlcnRfZGJ1Zl9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICAgCSAgICAgIlVuZXhwZWN0ZWQgREJ1ZiBwb3dlciBwb3dlciBzdGF0ZSAoMHgl
MDh4KVxuIiwgdG1wKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGdlbjlfZGNfb2ZmX3Bvd2Vy
X3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0
aWMgdm9pZCBnZW45X2RjX29mZl9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dl
bGwpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jZGNsa19zdGF0ZSBjZGNsa19zdGF0ZSA9
IHt9Owo+ID4gLQlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVfRElTQUJMRSk7
Cj4gPiArCWdlbjlfc2V0X2RjX3N0YXRlKGk5MTUsIERDX1NUQVRFX0RJU0FCTEUpOwo+ID4gLQlk
ZXZfcHJpdi0+ZGlzcGxheS5nZXRfY2RjbGsoZGV2X3ByaXYsICZjZGNsa19zdGF0ZSk7Cj4gPiAr
CWk5MTUtPmRpc3BsYXkuZ2V0X2NkY2xrKGk5MTUsICZjZGNsa19zdGF0ZSk7Cj4gPiAgIAkvKiBD
YW4ndCByZWFkIG91dCB2b2x0YWdlX2xldmVsIHNvIGNhbid0IHVzZSBpbnRlbF9jZGNsa19jaGFu
Z2VkKCkgKi8KPiA+IC0JV0FSTl9PTihpbnRlbF9jZGNsa19uZWVkc19tb2Rlc2V0KCZkZXZfcHJp
di0+Y2RjbGsuaHcsICZjZGNsa19zdGF0ZSkpOwo+ID4gKwlXQVJOX09OKGludGVsX2NkY2xrX25l
ZWRzX21vZGVzZXQoJmk5MTUtPmNkY2xrLmh3LCAmY2RjbGtfc3RhdGUpKTsKPiA+IC0JZ2VuOV9h
c3NlcnRfZGJ1Zl9lbmFibGVkKGRldl9wcml2KTsKPiA+ICsJZ2VuOV9hc3NlcnRfZGJ1Zl9lbmFi
bGVkKGk5MTUpOwo+ID4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gPiAtCQlieHRfdmVy
aWZ5X2RkaV9waHlfcG93ZXJfd2VsbHMoZGV2X3ByaXYpOwo+ID4gKwlpZiAoSVNfR0VOOV9MUChp
OTE1KSkKPiA+ICsJCWJ4dF92ZXJpZnlfZGRpX3BoeV9wb3dlcl93ZWxscyhpOTE1KTsKPiA+IC0J
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gMTEpCj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBETUMgcmV0YWlucyBIVyBjb250ZXh0IG9ubHkg
Zm9yIHBvcnQgQSwgdGhlIG90aGVyIGNvbWJvCj4gPiAgIAkJICogUEhZJ3MgSFcgY29udGV4dCBm
b3IgcG9ydCBCIGlzIGxvc3QgYWZ0ZXIgREMgdHJhbnNpdGlvbnMsCj4gPiAgIAkJICogc28gd2Ug
bmVlZCB0byByZXN0b3JlIGl0IG1hbnVhbGx5Lgo+ID4gICAJCSAqLwo+ID4gLQkJaW50ZWxfY29t
Ym9fcGh5X2luaXQoZGV2X3ByaXYpOwo+ID4gKwkJaW50ZWxfY29tYm9fcGh5X2luaXQoaTkxNSk7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW45X2RjX29mZl9wb3dlcl93ZWxsX2Rpc2FibGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGdlbjlf
ZGNfb2ZmX3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiA+ICAgCQkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ID4gICB7
Cj4gPiAtCWlmICghZGV2X3ByaXYtPmNzci5kbWNfcGF5bG9hZCkKPiA+ICsJaWYgKCFpOTE1LT5j
c3IuZG1jX3BheWxvYWQpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmNzci5h
bGxvd2VkX2RjX21hc2sgJiBEQ19TVEFURV9FTl9VUFRPX0RDNikKPiA+IC0JCXNrbF9lbmFibGVf
ZGM2KGRldl9wcml2KTsKPiA+IC0JZWxzZSBpZiAoZGV2X3ByaXYtPmNzci5hbGxvd2VkX2RjX21h
c2sgJiBEQ19TVEFURV9FTl9VUFRPX0RDNSkKPiA+IC0JCWdlbjlfZW5hYmxlX2RjNShkZXZfcHJp
dik7Cj4gPiArCWlmIChpOTE1LT5jc3IuYWxsb3dlZF9kY19tYXNrICYgRENfU1RBVEVfRU5fVVBU
T19EQzYpCj4gPiArCQlza2xfZW5hYmxlX2RjNihpOTE1KTsKPiA+ICsJZWxzZSBpZiAoaTkxNS0+
Y3NyLmFsbG93ZWRfZGNfbWFzayAmIERDX1NUQVRFX0VOX1VQVE9fREM1KQo+ID4gKwkJZ2VuOV9l
bmFibGVfZGM1KGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaTl4eF9wb3dlcl93ZWxs
X3N5bmNfaHdfbm9vcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3Rh
dGljIHZvaWQgaTl4eF9wb3dlcl93ZWxsX3N5bmNfaHdfbm9vcChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2Vs
bCkKPiA+ICAgewo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaTl4eF9hbHdheXNfb25fcG93ZXJf
d2VsbF9ub29wKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMg
dm9pZCBpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX25vb3Aoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCQkJICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2Vs
bCkKPiA+ICAgewo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wgaTl4eF9hbHdheXNfb25fcG93ZXJf
d2VsbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0
aWMgYm9vbCBpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJICAgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpw
b3dlcl93ZWxsKQo+ID4gICB7Cj4gPiAgIAlyZXR1cm4gdHJ1ZTsKPiA+ICAgfQo+ID4gLXN0YXRp
YyB2b2lkIGk4MzBfcGlwZXNfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGk4MzBfcGlwZXNfcG93ZXJfd2VsbF9lbmFi
bGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJIHN0cnVjdCBpOTE1
X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gPiAgIHsKPiA+ICAgCWlmICgoSTkxNV9SRUFEKFBJ
UEVDT05GKFBJUEVfQSkpICYgUElQRUNPTkZfRU5BQkxFKSA9PSAwKQo+ID4gLQkJaTgzMF9lbmFi
bGVfcGlwZShkZXZfcHJpdiwgUElQRV9BKTsKPiA+ICsJCWk4MzBfZW5hYmxlX3BpcGUoaTkxNSwg
UElQRV9BKTsKPiA+ICAgCWlmICgoSTkxNV9SRUFEKFBJUEVDT05GKFBJUEVfQikpICYgUElQRUNP
TkZfRU5BQkxFKSA9PSAwKQo+ID4gLQkJaTgzMF9lbmFibGVfcGlwZShkZXZfcHJpdiwgUElQRV9C
KTsKPiA+ICsJCWk4MzBfZW5hYmxlX3BpcGUoaTkxNSwgUElQRV9CKTsKPiA+ICAgfQo+ID4gLXN0
YXRpYyB2b2lkIGk4MzBfcGlwZXNfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBpODMwX3BpcGVzX3Bvd2VyX3dlbGxf
ZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgIHN0cnVj
dCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gPiAgIHsKPiA+IC0JaTgzMF9kaXNhYmxl
X3BpcGUoZGV2X3ByaXYsIFBJUEVfQik7Cj4gPiAtCWk4MzBfZGlzYWJsZV9waXBlKGRldl9wcml2
LCBQSVBFX0EpOwo+ID4gKwlpODMwX2Rpc2FibGVfcGlwZShpOTE1LCBQSVBFX0IpOwo+ID4gKwlp
ODMwX2Rpc2FibGVfcGlwZShpOTE1LCBQSVBFX0EpOwo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wg
aTgzMF9waXBlc19wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gK3N0YXRpYyBib29sIGk4MzBfcGlwZXNfcG93ZXJfd2VsbF9lbmFibGVkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJCSAgc3RydWN0IGk5MTVfcG93
ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiA+ICAgewo+ID4gICAJcmV0dXJuIEk5MTVfUkVBRChQSVBF
Q09ORihQSVBFX0EpKSAmIFBJUEVDT05GX0VOQUJMRSAmJgo+ID4gICAJCUk5MTVfUkVBRChQSVBF
Q09ORihQSVBFX0IpKSAmIFBJUEVDT05GX0VOQUJMRTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lk
IGk4MzBfcGlwZXNfcG93ZXJfd2VsbF9zeW5jX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBpODMwX3BpcGVzX3Bvd2VyX3dlbGxfc3luY19odyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgIHN0cnVjdCBpOTE1X3Bv
d2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gPiAgIHsKPiA+ICAgCWlmIChwb3dlcl93ZWxsLT5jb3Vu
dCA+IDApCj4gPiAtCQlpODMwX3BpcGVzX3Bvd2VyX3dlbGxfZW5hYmxlKGRldl9wcml2LCBwb3dl
cl93ZWxsKTsKPiA+ICsJCWk4MzBfcGlwZXNfcG93ZXJfd2VsbF9lbmFibGUoaTkxNSwgcG93ZXJf
d2VsbCk7Cj4gPiAgIAllbHNlCj4gPiAtCQlpODMwX3BpcGVzX3Bvd2VyX3dlbGxfZGlzYWJsZShk
ZXZfcHJpdiwgcG93ZXJfd2VsbCk7Cj4gPiArCQlpODMwX3BpcGVzX3Bvd2VyX3dlbGxfZGlzYWJs
ZShpOTE1LCBwb3dlcl93ZWxsKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHZsdl9zZXRfcG93
ZXJfd2VsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZv
aWQgdmx2X3NldF9wb3dlcl93ZWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4g
ICAJCQkgICAgICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCwgYm9vbCBlbmFi
bGUpCj4gPiAgIHsKPiA+ICAgCWludCBwd19pZHggPSBwb3dlcl93ZWxsLT5kZXNjLT52bHYuaWR4
Owo+ID4gQEAgLTkwOCw0MyArOTA4LDQzIEBAIHN0YXRpYyB2b2lkIHZsdl9zZXRfcG93ZXJfd2Vs
bChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlzdGF0ZSA9IGVuYWJs
ZSA/IFBVTklUX1BXUkdUX1BXUl9PTihwd19pZHgpIDoKPiA+ICAgCQkJIFBVTklUX1BXUkdUX1BX
Ul9HQVRFKHB3X2lkeCk7Cj4gPiAtCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZf
cHVuaXRfZ2V0KGk5MTUpOwo+ID4gICAjZGVmaW5lIENPTkQgXAo+ID4gLQkoKHZsdl9wdW5pdF9y
ZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfUFdSR1RfU1RBVFVTKSAmIG1hc2spID09IHN0YXRlKQo+
ID4gKwkoKHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19QV1JHVF9TVEFUVVMpICYgbWFz
aykgPT0gc3RhdGUpCj4gPiAgIAlpZiAoQ09ORCkKPiA+ICAgCQlnb3RvIG91dDsKPiA+IC0JY3Ry
bCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfUFdSR1RfQ1RSTCk7Cj4gPiAr
CWN0cmwgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfUFdSR1RfQ1RSTCk7Cj4gPiAg
IAljdHJsICY9IH5tYXNrOwo+ID4gICAJY3RybCB8PSBzdGF0ZTsKPiA+IC0Jdmx2X3B1bml0X3dy
aXRlKGRldl9wcml2LCBQVU5JVF9SRUdfUFdSR1RfQ1RSTCwgY3RybCk7Cj4gPiArCXZsdl9wdW5p
dF93cml0ZShpOTE1LCBQVU5JVF9SRUdfUFdSR1RfQ1RSTCwgY3RybCk7Cj4gPiAgIAlpZiAod2Fp
dF9mb3IoQ09ORCwgMTAwKSkKPiA+ICAgCQlEUk1fRVJST1IoInRpbWVvdXQgc2V0dGluZyBwb3dl
ciB3ZWxsIHN0YXRlICUwOHggKCUwOHgpXG4iLAo+ID4gICAJCQkgIHN0YXRlLAo+ID4gLQkJCSAg
dmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19QV1JHVF9DVFJMKSk7Cj4gPiArCQkJ
ICB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfUFdSR1RfQ1RSTCkpOwo+ID4gICAjdW5k
ZWYgQ09ORAo+ID4gICBvdXQ6Cj4gPiAtCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYpOwo+ID4gKwl2
bHZfcHVuaXRfcHV0KGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgdmx2X3Bvd2VyX3dl
bGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMg
dm9pZCB2bHZfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gPiAgIAkJCQkgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gPiAgIHsK
PiA+IC0Jdmx2X3NldF9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxsLCB0cnVlKTsKPiA+
ICsJdmx2X3NldF9wb3dlcl93ZWxsKGk5MTUsIHBvd2VyX3dlbGwsIHRydWUpOwo+ID4gICB9Cj4g
PiAtc3RhdGljIHZvaWQgdmx2X3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgdmx2X3Bvd2VyX3dlbGxfZGlzYWJsZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgIHN0cnVjdCBpOTE1X3Bv
d2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gPiAgIHsKPiA+IC0Jdmx2X3NldF9wb3dlcl93ZWxsKGRl
dl9wcml2LCBwb3dlcl93ZWxsLCBmYWxzZSk7Cj4gPiArCXZsdl9zZXRfcG93ZXJfd2VsbChpOTE1
LCBwb3dlcl93ZWxsLCBmYWxzZSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCB2bHZfcG93ZXJf
d2VsbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0
aWMgYm9vbCB2bHZfcG93ZXJfd2VsbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ID4gICAJCQkJICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiA+
ICAgewo+ID4gICAJaW50IHB3X2lkeCA9IHBvd2VyX3dlbGwtPmRlc2MtPnZsdi5pZHg7Cj4gPiBA
QCAtOTU2LDkgKzk1Niw5IEBAIHN0YXRpYyBib29sIHZsdl9wb3dlcl93ZWxsX2VuYWJsZWQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJbWFzayA9IFBVTklUX1BXUkdU
X01BU0socHdfaWR4KTsKPiA+ICAgCWN0cmwgPSBQVU5JVF9QV1JHVF9QV1JfT04ocHdfaWR4KTsK
PiA+IC0Jdmx2X3B1bml0X2dldChkZXZfcHJpdik7Cj4gPiArCXZsdl9wdW5pdF9nZXQoaTkxNSk7
Cj4gPiAtCXN0YXRlID0gdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19QV1JHVF9T
VEFUVVMpICYgbWFzazsKPiA+ICsJc3RhdGUgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9S
RUdfUFdSR1RfU1RBVFVTKSAmIG1hc2s7Cj4gPiAgIAkvKgo+ID4gICAJICogV2Ugb25seSBldmVy
IHNldCB0aGUgcG93ZXItb24gYW5kIHBvd2VyLWdhdGUgc3RhdGVzLCBhbnl0aGluZwo+ID4gICAJ
ICogZWxzZSBpcyB1bmV4cGVjdGVkLgo+ID4gQEAgLTk3MiwxNSArOTcyLDE1IEBAIHN0YXRpYyBi
b29sIHZsdl9wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gICAJICogQSB0cmFuc2llbnQgc3RhdGUgYXQgdGhpcyBwb2ludCB3b3VsZCBtZWFu
IHNvbWUgdW5leHBlY3RlZCBwYXJ0eQo+ID4gICAJICogaXMgcG9raW5nIGF0IHRoZSBwb3dlciBj
b250cm9scyB0b28uCj4gPiAgIAkgKi8KPiA+IC0JY3RybCA9IHZsdl9wdW5pdF9yZWFkKGRldl9w
cml2LCBQVU5JVF9SRUdfUFdSR1RfQ1RSTCkgJiBtYXNrOwo+ID4gKwljdHJsID0gdmx2X3B1bml0
X3JlYWQoaTkxNSwgUFVOSVRfUkVHX1BXUkdUX0NUUkwpICYgbWFzazsKPiA+ICAgCVdBUk5fT04o
Y3RybCAhPSBzdGF0ZSk7Cj4gPiAtCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZf
cHVuaXRfcHV0KGk5MTUpOwo+ID4gICAJcmV0dXJuIGVuYWJsZWQ7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgdm9pZCB2bHZfaW5pdF9kaXNwbGF5X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgdmx2X2luaXRfZGlzcGxheV9jbG9ja19n
YXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2
YWw7Cj4gPiBAQCAtMTAwMSwxMyArMTAwMSwxMyBAQCBzdGF0aWMgdm9pZCB2bHZfaW5pdF9kaXNw
bGF5X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAg
IAlJOTE1X1dSSVRFKE1JX0FSQl9WTFYsIE1JX0FSQl9ESVNQTEFZX1RSSUNLTEVfRkVFRF9ESVNB
QkxFKTsKPiA+ICAgCUk5MTVfV1JJVEUoQ0JSMV9WTFYsIDApOwo+ID4gLQlXQVJOX09OKGRldl9w
cml2LT5yYXdjbGtfZnJlcSA9PSAwKTsKPiA+ICsJV0FSTl9PTihpOTE1LT5yYXdjbGtfZnJlcSA9
PSAwKTsKPiA+ICAgCUk5MTVfV1JJVEUoUkFXQ0xLX0ZSRVFfVkxWLAo+ID4gLQkJICAgRElWX1JP
VU5EX0NMT1NFU1QoZGV2X3ByaXYtPnJhd2Nsa19mcmVxLCAxMDAwKSk7Cj4gPiArCQkgICBESVZf
Uk9VTkRfQ0xPU0VTVChpOTE1LT5yYXdjbGtfZnJlcSwgMTAwMCkpOwo+ID4gICB9Cj4gPiAtc3Rh
dGljIHZvaWQgdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCB2bHZfZGlzcGxheV9wb3dlcl93ZWxsX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ID4gICAJZW51bSBwaXBlIHBpcGU7Cj4gPiBAQCAtMTAy
MCw3ICsxMDIwLDcgQEAgc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqCj4gPiAgIAkgKiBDSFYg
RFBMTCBCL0MgaGF2ZSBzb21lIGlzc3VlcyBpZiBWR0EgbW9kZSBpcyBlbmFibGVkLgo+ID4gICAJ
ICovCj4gPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKPiA+ICsJZm9yX2VhY2hf
cGlwZShpOTE1LCBwaXBlKSB7Cj4gPiAgIAkJdTMyIHZhbCA9IEk5MTVfUkVBRChEUExMKHBpcGUp
KTsKPiA+ICAgCQl2YWwgfD0gRFBMTF9SRUZfQ0xLX0VOQUJMRV9WTFYgfCBEUExMX1ZHQV9NT0RF
X0RJUzsKPiA+IEBAIC0xMDMwLDcxICsxMDMwLDcxIEBAIHN0YXRpYyB2b2lkIHZsdl9kaXNwbGF5
X3Bvd2VyX3dlbGxfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAg
IAkJSTkxNV9XUklURShEUExMKHBpcGUpLCB2YWwpOwo+ID4gICAJfQo+ID4gLQl2bHZfaW5pdF9k
aXNwbGF5X2Nsb2NrX2dhdGluZyhkZXZfcHJpdik7Cj4gPiArCXZsdl9pbml0X2Rpc3BsYXlfY2xv
Y2tfZ2F0aW5nKGk5MTUpOwo+ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2sp
Owo+ID4gLQl2YWxsZXl2aWV3X2VuYWJsZV9kaXNwbGF5X2lycXMoZGV2X3ByaXYpOwo+ID4gLQlz
cGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5fbG9ja19pcnEo
Jmk5MTUtPmlycV9sb2NrKTsKPiA+ICsJdmFsbGV5dmlld19lbmFibGVfZGlzcGxheV9pcnFzKGk5
MTUpOwo+ID4gKwlzcGluX3VubG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICAgCS8qCj4g
PiAgIAkgKiBEdXJpbmcgZHJpdmVyIGluaXRpYWxpemF0aW9uL3Jlc3VtZSB3ZSBjYW4gYXZvaWQg
cmVzdG9yaW5nIHRoZQo+ID4gICAJICogcGFydCBvZiB0aGUgSFcvU1cgc3RhdGUgdGhhdCB3aWxs
IGJlIGluaXRlZCBhbnl3YXkgZXhwbGljaXRseS4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoZGV2X3By
aXYtPnBvd2VyX2RvbWFpbnMuaW5pdGlhbGl6aW5nKQo+ID4gKwlpZiAoaTkxNS0+cG93ZXJfZG9t
YWlucy5pbml0aWFsaXppbmcpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlpbnRlbF9ocGRfaW5pdChk
ZXZfcHJpdik7Cj4gPiArCWludGVsX2hwZF9pbml0KGk5MTUpOwo+ID4gICAJLyogUmUtZW5hYmxl
IHRoZSBBRFBBLCBpZiB3ZSBoYXZlIG9uZSAqLwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9lbmNvZGVy
KCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7Cj4gPiArCWZvcl9lYWNoX2ludGVsX2VuY29kZXIo
Jmk5MTUtPmRybSwgZW5jb2Rlcikgewo+ID4gICAJCWlmIChlbmNvZGVyLT50eXBlID09IElOVEVM
X09VVFBVVF9BTkFMT0cpCj4gPiAgIAkJCWludGVsX2NydF9yZXNldCgmZW5jb2Rlci0+YmFzZSk7
Cj4gPiAgIAl9Cj4gPiAtCWk5MTVfcmVkaXNhYmxlX3ZnYV9wb3dlcl9vbihkZXZfcHJpdik7Cj4g
PiArCWk5MTVfcmVkaXNhYmxlX3ZnYV9wb3dlcl9vbihpOTE1KTsKPiA+IC0JaW50ZWxfcHBzX3Vu
bG9ja19yZWdzX3dhKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfcHBzX3VubG9ja19yZWdzX3dhKGk5
MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9kZWlu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIHZs
dl9kaXNwbGF5X3Bvd2VyX3dlbGxfZGVpbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ID4gICB7Cj4gPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAt
CXZhbGxleXZpZXdfZGlzYWJsZV9kaXNwbGF5X2lycXMoZGV2X3ByaXYpOwo+ID4gLQlzcGluX3Vu
bG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5fbG9ja19pcnEoJmk5MTUt
PmlycV9sb2NrKTsKPiA+ICsJdmFsbGV5dmlld19kaXNhYmxlX2Rpc3BsYXlfaXJxcyhpOTE1KTsK
PiA+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAgIAkvKiBtYWtlIHN1
cmUgd2UncmUgZG9uZSBwcm9jZXNzaW5nIGRpc3BsYXkgaXJxcyAqLwo+ID4gLQlzeW5jaHJvbml6
ZV9pcnEoZGV2X3ByaXYtPmRybS5pcnEpOwo+ID4gKwlzeW5jaHJvbml6ZV9pcnEoaTkxNS0+ZHJt
LmlycSk7Cj4gPiAtCWludGVsX3Bvd2VyX3NlcXVlbmNlcl9yZXNldChkZXZfcHJpdik7Cj4gPiAr
CWludGVsX3Bvd2VyX3NlcXVlbmNlcl9yZXNldChpOTE1KTsKPiA+ICAgCS8qIFByZXZlbnQgdXMg
ZnJvbSByZS1lbmFibGluZyBwb2xsaW5nIG9uIGFjY2lkZW50IGluIGxhdGUgc3VzcGVuZCAqLwo+
ID4gLQlpZiAoIWRldl9wcml2LT5kcm0uZGV2LT5wb3dlci5pc19zdXNwZW5kZWQpCj4gPiAtCQlp
bnRlbF9ocGRfcG9sbF9pbml0KGRldl9wcml2KTsKPiA+ICsJaWYgKCFpOTE1LT5kcm0uZGV2LT5w
b3dlci5pc19zdXNwZW5kZWQpCj4gPiArCQlpbnRlbF9ocGRfcG9sbF9pbml0KGk5MTUpOwo+ID4g
ICB9Cj4gPiAtc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIHZsdl9kaXNwbGF5
X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJ
CQkJCSAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiA+ICAgewo+ID4gLQl2
bHZfc2V0X3Bvd2VyX3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIHRydWUpOwo+ID4gKwl2bHZf
c2V0X3Bvd2VyX3dlbGwoaTkxNSwgcG93ZXJfd2VsbCwgdHJ1ZSk7Cj4gPiAtCXZsdl9kaXNwbGF5
X3Bvd2VyX3dlbGxfaW5pdChkZXZfcHJpdik7Cj4gPiArCXZsdl9kaXNwbGF5X3Bvd2VyX3dlbGxf
aW5pdChpOTE1KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHZsdl9kaXNwbGF5X3Bvd2VyX3dl
bGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGlj
IHZvaWQgdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ID4gICAJCQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dl
bGwpCj4gPiAgIHsKPiA+IC0Jdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9kZWluaXQoZGV2X3ByaXYp
Owo+ID4gKwl2bHZfZGlzcGxheV9wb3dlcl93ZWxsX2RlaW5pdChpOTE1KTsKPiA+IC0Jdmx2X3Nl
dF9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxsLCBmYWxzZSk7Cj4gPiArCXZsdl9zZXRf
cG93ZXJfd2VsbChpOTE1LCBwb3dlcl93ZWxsLCBmYWxzZSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
dm9pZCB2bHZfZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIHZsdl9kcGlvX2Ntbl9wb3dlcl93ZWxsX2Vu
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICBzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ID4gICB7Cj4gPiAgIAkvKiBzaW5jZSByZWYv
Y3JpIGNsb2NrIHdhcyBlbmFibGVkICovCj4gPiAgIAl1ZGVsYXkoMSk7IC8qID4xMG5zIGZvciBj
bW5yZXNldCwgPjBucyBmb3Igc2lkZXJlc2V0ICovCj4gPiAtCXZsdl9zZXRfcG93ZXJfd2VsbChk
ZXZfcHJpdiwgcG93ZXJfd2VsbCwgdHJ1ZSk7Cj4gPiArCXZsdl9zZXRfcG93ZXJfd2VsbChpOTE1
LCBwb3dlcl93ZWxsLCB0cnVlKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBGcm9tIFZMVjJBMF9EUF9l
RFBfRFBJT19kcml2ZXJfdmJpb3Nfbm90ZXNfMTAuZG9jeCAtCj4gPiBAQCAtMTExMCwzMSArMTEx
MCwzMSBAQCBzdGF0aWMgdm9pZCB2bHZfZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJSTkxNV9XUklURShEUElPX0NUTCwg
STkxNV9SRUFEKERQSU9fQ1RMKSB8IERQSU9fQ01OUlNUKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2
b2lkIHZsdl9kcGlvX2Ntbl9wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIHZsdl9kcGlvX2Ntbl9wb3dlcl93ZWxsX2Rp
c2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJICAgIHN0cnVj
dCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gPiAgIHsKPiA+ICAgCWVudW0gcGlwZSBw
aXBlOwo+ID4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKQo+ID4gLQkJYXNzZXJ0X3Bs
bF9kaXNhYmxlZChkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlw
ZSkKPiA+ICsJCWFzc2VydF9wbGxfZGlzYWJsZWQoaTkxNSwgcGlwZSk7Cj4gPiAgIAkvKiBBc3Nl
cnQgY29tbW9uIHJlc2V0ICovCj4gPiAgIAlJOTE1X1dSSVRFKERQSU9fQ1RMLCBJOTE1X1JFQUQo
RFBJT19DVEwpICYgfkRQSU9fQ01OUlNUKTsKPiA+IC0Jdmx2X3NldF9wb3dlcl93ZWxsKGRldl9w
cml2LCBwb3dlcl93ZWxsLCBmYWxzZSk7Cj4gPiArCXZsdl9zZXRfcG93ZXJfd2VsbChpOTE1LCBw
b3dlcl93ZWxsLCBmYWxzZSk7Cj4gPiAgIH0KPiA+ICAgI2RlZmluZSBQT1dFUl9ET01BSU5fTUFT
SyAoR0VOTUFTS19VTEwoUE9XRVJfRE9NQUlOX05VTSAtIDEsIDApKQo+ID4gICAjZGVmaW5lIEJJ
VFNfU0VUKHZhbCwgYml0cykgKCgodmFsKSAmIChiaXRzKSkgPT0gKGJpdHMpKQo+ID4gLXN0YXRp
YyB2b2lkIGFzc2VydF9jaHZfcGh5X3N0YXR1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgYXNzZXJ0X2Nodl9waHlfc3RhdHVzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxs
ICpjbW5fYmMgPQo+ID4gLQkJbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFZMVl9ESVNQX1BX
X0RQSU9fQ01OX0JDKTsKPiA+ICsJCWxvb2t1cF9wb3dlcl93ZWxsKGk5MTUsIFZMVl9ESVNQX1BX
X0RQSU9fQ01OX0JDKTsKPiA+ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKmNtbl9kID0KPiA+
IC0JCWxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBDSFZfRElTUF9QV19EUElPX0NNTl9EKTsK
PiA+IC0JdTMyIHBoeV9jb250cm9sID0gZGV2X3ByaXYtPmNodl9waHlfY29udHJvbDsKPiA+ICsJ
CWxvb2t1cF9wb3dlcl93ZWxsKGk5MTUsIENIVl9ESVNQX1BXX0RQSU9fQ01OX0QpOwo+ID4gKwl1
MzIgcGh5X2NvbnRyb2wgPSBpOTE1LT5jaHZfcGh5X2NvbnRyb2w7Cj4gPiAgIAl1MzIgcGh5X3N0
YXR1cyA9IDA7Cj4gPiAgIAl1MzIgcGh5X3N0YXR1c19tYXNrID0gMHhmZmZmZmZmZjsKPiA+IEBA
IC0xMTQ1LDcgKzExNDUsNyBAQCBzdGF0aWMgdm9pZCBhc3NlcnRfY2h2X3BoeV9zdGF0dXMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICogcmVzZXQgKGllLiB0aGUg
cG93ZXIgd2VsbCBoYXMgYmVlbiBkaXNhYmxlZCBhdAo+ID4gICAJICogbGVhc3Qgb25jZSkuCj4g
PiAgIAkgKi8KPiA+IC0JaWYgKCFkZXZfcHJpdi0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkwXSkK
PiA+ICsJaWYgKCFpOTE1LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTBdKQo+ID4gICAJCXBoeV9z
dGF0dXNfbWFzayAmPSB+KFBIWV9TVEFUVVNfQ01OX0xETyhEUElPX1BIWTAsIERQSU9fQ0gwKSB8
Cj4gPiAgIAkJCQkgICAgIFBIWV9TVEFUVVNfU1BMSU5FX0xETyhEUElPX1BIWTAsIERQSU9fQ0gw
LCAwKSB8Cj4gPiAgIAkJCQkgICAgIFBIWV9TVEFUVVNfU1BMSU5FX0xETyhEUElPX1BIWTAsIERQ
SU9fQ0gwLCAxKSB8Cj4gPiBAQCAtMTE1MywxMiArMTE1MywxMiBAQCBzdGF0aWMgdm9pZCBhc3Nl
cnRfY2h2X3BoeV9zdGF0dXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
ICAJCQkJICAgICBQSFlfU1RBVFVTX1NQTElORV9MRE8oRFBJT19QSFkwLCBEUElPX0NIMSwgMCkg
fAo+ID4gICAJCQkJICAgICBQSFlfU1RBVFVTX1NQTElORV9MRE8oRFBJT19QSFkwLCBEUElPX0NI
MSwgMSkpOwo+ID4gLQlpZiAoIWRldl9wcml2LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTFdKQo+
ID4gKwlpZiAoIWk5MTUtPmNodl9waHlfYXNzZXJ0W0RQSU9fUEhZMV0pCj4gPiAgIAkJcGh5X3N0
YXR1c19tYXNrICY9IH4oUEhZX1NUQVRVU19DTU5fTERPKERQSU9fUEhZMSwgRFBJT19DSDApIHwK
PiA+ICAgCQkJCSAgICAgUEhZX1NUQVRVU19TUExJTkVfTERPKERQSU9fUEhZMSwgRFBJT19DSDAs
IDApIHwKPiA+ICAgCQkJCSAgICAgUEhZX1NUQVRVU19TUExJTkVfTERPKERQSU9fUEhZMSwgRFBJ
T19DSDAsIDEpKTsKPiA+IC0JaWYgKGNtbl9iYy0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9w
cml2LCBjbW5fYmMpKSB7Cj4gPiArCWlmIChjbW5fYmMtPmRlc2MtPm9wcy0+aXNfZW5hYmxlZChp
OTE1LCBjbW5fYmMpKSB7Cj4gPiAgIAkJcGh5X3N0YXR1cyB8PSBQSFlfUE9XRVJHT09EKERQSU9f
UEhZMCk7Cj4gPiAgIAkJLyogdGhpcyBhc3N1bWVzIG92ZXJyaWRlIGlzIG9ubHkgdXNlZCB0byBl
bmFibGUgbGFuZXMgKi8KPiA+IEBAIC0xMTk5LDcgKzExOTksNyBAQCBzdGF0aWMgdm9pZCBhc3Nl
cnRfY2h2X3BoeV9zdGF0dXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
ICAJCQlwaHlfc3RhdHVzIHw9IFBIWV9TVEFUVVNfU1BMSU5FX0xETyhEUElPX1BIWTAsIERQSU9f
Q0gxLCAxKTsKPiA+ICAgCX0KPiA+IC0JaWYgKGNtbl9kLT5kZXNjLT5vcHMtPmlzX2VuYWJsZWQo
ZGV2X3ByaXYsIGNtbl9kKSkgewo+ID4gKwlpZiAoY21uX2QtPmRlc2MtPm9wcy0+aXNfZW5hYmxl
ZChpOTE1LCBjbW5fZCkpIHsKPiA+ICAgCQlwaHlfc3RhdHVzIHw9IFBIWV9QT1dFUkdPT0QoRFBJ
T19QSFkxKTsKPiA+ICAgCQkvKiB0aGlzIGFzc3VtZXMgb3ZlcnJpZGUgaXMgb25seSB1c2VkIHRv
IGVuYWJsZSBsYW5lcyAqLwo+ID4gQEAgLTEyMjQsMTkgKzEyMjQsMTkgQEAgc3RhdGljIHZvaWQg
YXNzZXJ0X2Nodl9waHlfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgCSAqIFRoZSBQSFkgbWF5IGJlIGJ1c3kgd2l0aCBzb21lIGluaXRpYWwgY2FsaWJyYXRp
b24gYW5kIHdoYXRub3QsCj4gPiAgIAkgKiBzbyB0aGUgcG93ZXIgc3RhdGUgY2FuIHRha2UgYSB3
aGlsZSB0byBhY3R1YWxseSBjaGFuZ2UuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKGludGVsX3dhaXRf
Zm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ID4gKwlpZiAoaW50ZWxfd2FpdF9mb3Jf
cmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiA+ICAgCQkJCSAgICBESVNQTEFZX1BIWV9TVEFUVVMs
Cj4gPiAgIAkJCQkgICAgcGh5X3N0YXR1c19tYXNrLAo+ID4gICAJCQkJICAgIHBoeV9zdGF0dXMs
Cj4gPiAgIAkJCQkgICAgMTApKQo+ID4gICAJCURSTV9FUlJPUigiVW5leHBlY3RlZCBQSFlfU1RB
VFVTIDB4JTA4eCwgZXhwZWN0ZWQgMHglMDh4IChQSFlfQ09OVFJPTD0weCUwOHgpXG4iLAo+ID4g
ICAJCQkgIEk5MTVfUkVBRChESVNQTEFZX1BIWV9TVEFUVVMpICYgcGh5X3N0YXR1c19tYXNrLAo+
ID4gLQkJCSAgIHBoeV9zdGF0dXMsIGRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wpOwo+ID4gKwkJ
CSAgIHBoeV9zdGF0dXMsIGk5MTUtPmNodl9waHlfY29udHJvbCk7Cj4gPiAgIH0KPiA+ICAgI3Vu
ZGVmIEJJVFNfU0VUCj4gPiAtc3RhdGljIHZvaWQgY2h2X2RwaW9fY21uX3Bvd2VyX3dlbGxfZW5h
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBj
aHZfZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJCQkJICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiA+
ICAgewo+ID4gICAJZW51bSBkcGlvX3BoeSBwaHk7Cj4gPiBAQCAtMTI1Niw1MSArMTI1Niw1MSBA
QCBzdGF0aWMgdm9pZCBjaHZfZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJLyogc2luY2UgcmVmL2NyaSBjbG9jayB3YXMg
ZW5hYmxlZCAqLwo+ID4gICAJdWRlbGF5KDEpOyAvKiA+MTBucyBmb3IgY21ucmVzZXQsID4wbnMg
Zm9yIHNpZGVyZXNldCAqLwo+ID4gLQl2bHZfc2V0X3Bvd2VyX3dlbGwoZGV2X3ByaXYsIHBvd2Vy
X3dlbGwsIHRydWUpOwo+ID4gKwl2bHZfc2V0X3Bvd2VyX3dlbGwoaTkxNSwgcG93ZXJfd2VsbCwg
dHJ1ZSk7Cj4gPiAgIAkvKiBQb2xsIGZvciBwaHlwd3Jnb29kIHNpZ25hbCAqLwo+ID4gLQlpZiAo
aW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCWlmIChpbnRl
bF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJICAgIERJU1BMQVlf
UEhZX1NUQVRVUywKPiA+ICAgCQkJCSAgICBQSFlfUE9XRVJHT09EKHBoeSksCj4gPiAgIAkJCQkg
ICAgUEhZX1BPV0VSR09PRChwaHkpLAo+ID4gICAJCQkJICAgIDEpKQo+ID4gICAJCURSTV9FUlJP
UigiRGlzcGxheSBQSFkgJWQgaXMgbm90IHBvd2VyIHVwXG4iLCBwaHkpOwo+ID4gLQl2bHZfZHBp
b19nZXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfZHBpb19nZXQoaTkxNSk7Cj4gPiAgIAkvKiBFbmFi
bGUgZHluYW1pYyBwb3dlciBkb3duICovCj4gPiAtCXRtcCA9IHZsdl9kcGlvX3JlYWQoZGV2X3By
aXYsIHBpcGUsIENIVl9DTU5fRFcyOCk7Cj4gPiArCXRtcCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwg
cGlwZSwgQ0hWX0NNTl9EVzI4KTsKPiA+ICAgCXRtcCB8PSBEUElPX0RZTlBXUkRPV05FTl9DSDAg
fCBEUElPX0NMMVBPV0VSRE9XTkVOIHwKPiA+ICAgCQlEUElPX1NVU19DTEtfQ09ORklHX0dBVEVf
Q0xLUkVROwo+ID4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX0NNTl9EVzI4
LCB0bXApOwo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBDSFZfQ01OX0RXMjgsIHRt
cCk7Cj4gPiAgIAlpZiAocG93ZXJfd2VsbC0+ZGVzYy0+aWQgPT0gVkxWX0RJU1BfUFdfRFBJT19D
TU5fQkMpIHsKPiA+IC0JCXRtcCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIF9DSFZf
Q01OX0RXNl9DSDEpOwo+ID4gKwkJdG1wID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBfQ0hW
X0NNTl9EVzZfQ0gxKTsKPiA+ICAgCQl0bXAgfD0gRFBJT19EWU5QV1JET1dORU5fQ0gxOwo+ID4g
LQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIF9DSFZfQ01OX0RXNl9DSDEsIHRtcCk7
Cj4gPiArCQl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBfQ0hWX0NNTl9EVzZfQ0gxLCB0bXAp
Owo+ID4gICAJfSBlbHNlIHsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIEZvcmNlIHRoZSBub24tZXhp
c3RpbmcgQ0wyIG9mZi4gQlhUIGRvZXMgdGhpcwo+ID4gICAJCSAqIHRvbywgc28gbWF5YmUgaXQg
c2F2ZXMgc29tZSBwb3dlciBldmVuIHRob3VnaAo+ID4gICAJCSAqIENMMiBkb2Vzbid0IGV4aXN0
Pwo+ID4gICAJCSAqLwo+ID4gLQkJdG1wID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwg
Q0hWX0NNTl9EVzMwKTsKPiA+ICsJCXRtcCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgQ0hW
X0NNTl9EVzMwKTsKPiA+ICAgCQl0bXAgfD0gRFBJT19DTDJfTERPRlVTRV9QV1JFTkI7Cj4gPiAt
CQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX0NNTl9EVzMwLCB0bXApOwo+ID4g
KwkJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgQ0hWX0NNTl9EVzMwLCB0bXApOwo+ID4gICAJ
fQo+ID4gLQl2bHZfZHBpb19wdXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfZHBpb19wdXQoaTkxNSk7
Cj4gPiAtCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgfD0gUEhZX0NPTV9MQU5FX1JFU0VUX0RF
QVNTRVJUKHBoeSk7Cj4gPiAtCUk5MTVfV1JJVEUoRElTUExBWV9QSFlfQ09OVFJPTCwgZGV2X3By
aXYtPmNodl9waHlfY29udHJvbCk7Cj4gPiArCWk5MTUtPmNodl9waHlfY29udHJvbCB8PSBQSFlf
Q09NX0xBTkVfUkVTRVRfREVBU1NFUlQocGh5KTsKPiA+ICsJSTkxNV9XUklURShESVNQTEFZX1BI
WV9DT05UUk9MLCBpOTE1LT5jaHZfcGh5X2NvbnRyb2wpOwo+ID4gICAJRFJNX0RFQlVHX0tNUygi
RW5hYmxlZCBEUElPIFBIWSVkIChQSFlfQ09OVFJPTD0weCUwOHgpXG4iLAo+ID4gLQkJICAgICAg
cGh5LCBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sKTsKPiA+ICsJCSAgICAgIHBoeSwgaTkxNS0+
Y2h2X3BoeV9jb250cm9sKTsKPiA+IC0JYXNzZXJ0X2Nodl9waHlfc3RhdHVzKGRldl9wcml2KTsK
PiA+ICsJYXNzZXJ0X2Nodl9waHlfc3RhdHVzKGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgY2h2X2RwaW9fY21uX3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgY2h2X2RwaW9fY21uX3Bvd2VyX3dlbGxfZGlz
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICAgc3RydWN0
IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiA+ICAgewo+ID4gICAJZW51bSBkcGlvX3Bo
eSBwaHk7Cj4gPiBAQCAtMTMxMCwyOCArMTMxMCwyOCBAQCBzdGF0aWMgdm9pZCBjaHZfZHBpb19j
bW5fcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICAgCWlmIChwb3dlcl93ZWxsLT5kZXNjLT5pZCA9PSBWTFZfRElTUF9QV19EUElPX0NNTl9C
Qykgewo+ID4gICAJCXBoeSA9IERQSU9fUEhZMDsKPiA+IC0JCWFzc2VydF9wbGxfZGlzYWJsZWQo
ZGV2X3ByaXYsIFBJUEVfQSk7Cj4gPiAtCQlhc3NlcnRfcGxsX2Rpc2FibGVkKGRldl9wcml2LCBQ
SVBFX0IpOwo+ID4gKwkJYXNzZXJ0X3BsbF9kaXNhYmxlZChpOTE1LCBQSVBFX0EpOwo+ID4gKwkJ
YXNzZXJ0X3BsbF9kaXNhYmxlZChpOTE1LCBQSVBFX0IpOwo+ID4gICAJfSBlbHNlIHsKPiA+ICAg
CQlwaHkgPSBEUElPX1BIWTE7Cj4gPiAtCQlhc3NlcnRfcGxsX2Rpc2FibGVkKGRldl9wcml2LCBQ
SVBFX0MpOwo+ID4gKwkJYXNzZXJ0X3BsbF9kaXNhYmxlZChpOTE1LCBQSVBFX0MpOwo+ID4gICAJ
fQo+ID4gLQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sICY9IH5QSFlfQ09NX0xBTkVfUkVTRVRf
REVBU1NFUlQocGh5KTsKPiA+IC0JSTkxNV9XUklURShESVNQTEFZX1BIWV9DT05UUk9MLCBkZXZf
cHJpdi0+Y2h2X3BoeV9jb250cm9sKTsKPiA+ICsJaTkxNS0+Y2h2X3BoeV9jb250cm9sICY9IH5Q
SFlfQ09NX0xBTkVfUkVTRVRfREVBU1NFUlQocGh5KTsKPiA+ICsJSTkxNV9XUklURShESVNQTEFZ
X1BIWV9DT05UUk9MLCBpOTE1LT5jaHZfcGh5X2NvbnRyb2wpOwo+ID4gLQl2bHZfc2V0X3Bvd2Vy
X3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIGZhbHNlKTsKPiA+ICsJdmx2X3NldF9wb3dlcl93
ZWxsKGk5MTUsIHBvd2VyX3dlbGwsIGZhbHNlKTsKPiA+ICAgCURSTV9ERUJVR19LTVMoIkRpc2Fi
bGVkIERQSU8gUEhZJWQgKFBIWV9DT05UUk9MPTB4JTA4eClcbiIsCj4gPiAtCQkgICAgICBwaHks
IGRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wpOwo+ID4gKwkJICAgICAgcGh5LCBpOTE1LT5jaHZf
cGh5X2NvbnRyb2wpOwo+ID4gICAJLyogUEhZIGlzIGZ1bGx5IHJlc2V0IG5vdywgc28gd2UgY2Fu
IGVuYWJsZSB0aGUgUEhZIHN0YXRlIGFzc2VydHMgKi8KPiA+IC0JZGV2X3ByaXYtPmNodl9waHlf
YXNzZXJ0W3BoeV0gPSB0cnVlOwo+ID4gKwlpOTE1LT5jaHZfcGh5X2Fzc2VydFtwaHldID0gdHJ1
ZTsKPiA+IC0JYXNzZXJ0X2Nodl9waHlfc3RhdHVzKGRldl9wcml2KTsKPiA+ICsJYXNzZXJ0X2No
dl9waHlfc3RhdHVzKGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgYXNzZXJ0X2Nodl9w
aHlfcG93ZXJnYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBkcGlv
X3BoeSBwaHksCj4gPiArc3RhdGljIHZvaWQgYXNzZXJ0X2Nodl9waHlfcG93ZXJnYXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIGRwaW9fcGh5IHBoeSwKPiA+ICAgCQkJCSAg
ICAgZW51bSBkcGlvX2NoYW5uZWwgY2gsIGJvb2wgb3ZlcnJpZGUsIHVuc2lnbmVkIGludCBtYXNr
KQo+ID4gICB7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IHBoeSA9PSBEUElPX1BIWTAgPyBQSVBF
X0EgOiBQSVBFX0M7Cj4gPiBAQCAtMTM0NCw3ICsxMzQ0LDcgQEAgc3RhdGljIHZvaWQgYXNzZXJ0
X2Nodl9waHlfcG93ZXJnYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51
bSBkcGkKPiA+ICAgCSAqIHJlc2V0IChpZS4gdGhlIHBvd2VyIHdlbGwgaGFzIGJlZW4gZGlzYWJs
ZWQgYXQKPiA+ICAgCSAqIGxlYXN0IG9uY2UpLgo+ID4gICAJICovCj4gPiAtCWlmICghZGV2X3By
aXYtPmNodl9waHlfYXNzZXJ0W3BoeV0pCj4gPiArCWlmICghaTkxNS0+Y2h2X3BoeV9hc3NlcnRb
cGh5XSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAlpZiAoY2ggPT0gRFBJT19DSDApCj4gPiBAQCAt
MTM1Miw5ICsxMzUyLDkgQEAgc3RhdGljIHZvaWQgYXNzZXJ0X2Nodl9waHlfcG93ZXJnYXRlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBkcGkKPiA+ICAgCWVsc2UKPiA+
ICAgCQlyZWcgPSBfQ0hWX0NNTl9EVzZfQ0gxOwo+ID4gLQl2bHZfZHBpb19nZXQoZGV2X3ByaXYp
Owo+ID4gLQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCByZWcpOwo+ID4gLQl2
bHZfZHBpb19wdXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfZHBpb19nZXQoaTkxNSk7Cj4gPiArCXZh
bCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgcmVnKTsKPiA+ICsJdmx2X2RwaW9fcHV0KGk5
MTUpOwo+ID4gICAJLyoKPiA+ICAgCSAqIFRoaXMgYXNzdW1lcyAhb3ZlcnJpZGUgaXMgb25seSB1
c2VkIHdoZW4gdGhlIHBvcnQgaXMgZGlzYWJsZWQuCj4gPiBAQCAtMTM5MywzMCArMTM5MywzMCBA
QCBzdGF0aWMgdm9pZCBhc3NlcnRfY2h2X3BoeV9wb3dlcmdhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCBlbnVtIGRwaQo+ID4gICAJICAgICByZWcsIHZhbCk7Cj4gPiAgIH0K
PiA+IC1ib29sIGNodl9waHlfcG93ZXJnYXRlX2NoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgZW51bSBkcGlvX3BoeSBwaHksCj4gPiArYm9vbCBjaHZfcGh5X3Bvd2VyZ2F0ZV9j
aChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBkcGlvX3BoeSBwaHksCj4gPiAg
IAkJCSAgZW51bSBkcGlvX2NoYW5uZWwgY2gsIGJvb2wgb3ZlcnJpZGUpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93
ZXJfZG9tYWluczsKPiA+ICsJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlu
cyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOwo+ID4gICAJYm9vbCB3YXNfb3ZlcnJpZGU7Cj4gPiAg
IAltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiA+IC0Jd2FzX292ZXJyaWRlID0g
ZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCAmIFBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4ocGh5
LCBjaCk7Cj4gPiArCXdhc19vdmVycmlkZSA9IGk5MTUtPmNodl9waHlfY29udHJvbCAmIFBIWV9D
SF9QT1dFUl9ET1dOX09WUkRfRU4ocGh5LCBjaCk7Cj4gPiAgIAlpZiAob3ZlcnJpZGUgPT0gd2Fz
X292ZXJyaWRlKQo+ID4gICAJCWdvdG8gb3V0Owo+ID4gICAJaWYgKG92ZXJyaWRlKQo+ID4gLQkJ
ZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCB8PSBQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEX0VOKHBo
eSwgY2gpOwo+ID4gKwkJaTkxNS0+Y2h2X3BoeV9jb250cm9sIHw9IFBIWV9DSF9QT1dFUl9ET1dO
X09WUkRfRU4ocGh5LCBjaCk7Cj4gPiAgIAllbHNlCj4gPiAtCQlkZXZfcHJpdi0+Y2h2X3BoeV9j
b250cm9sICY9IH5QSFlfQ0hfUE9XRVJfRE9XTl9PVlJEX0VOKHBoeSwgY2gpOwo+ID4gKwkJaTkx
NS0+Y2h2X3BoeV9jb250cm9sICY9IH5QSFlfQ0hfUE9XRVJfRE9XTl9PVlJEX0VOKHBoeSwgY2gp
Owo+ID4gLQlJOTE1X1dSSVRFKERJU1BMQVlfUEhZX0NPTlRST0wsIGRldl9wcml2LT5jaHZfcGh5
X2NvbnRyb2wpOwo+ID4gKwlJOTE1X1dSSVRFKERJU1BMQVlfUEhZX0NPTlRST0wsIGk5MTUtPmNo
dl9waHlfY29udHJvbCk7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJQb3dlciBnYXRpbmcgRFBJTyBQ
SFklZCBDSCVkIChEUElPX1BIWV9DT05UUk9MPTB4JTA4eClcbiIsCj4gPiAtCQkgICAgICBwaHks
IGNoLCBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sKTsKPiA+ICsJCSAgICAgIHBoeSwgY2gsIGk5
MTUtPmNodl9waHlfY29udHJvbCk7Cj4gPiAtCWFzc2VydF9jaHZfcGh5X3N0YXR1cyhkZXZfcHJp
dik7Cj4gPiArCWFzc2VydF9jaHZfcGh5X3N0YXR1cyhpOTE1KTsKPiA+ICAgb3V0Ogo+ID4gICAJ
bXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiA+IEBAIC0xNDI3LDQzICsxNDI3
LDQzIEBAIGJvb2wgY2h2X3BoeV9wb3dlcmdhdGVfY2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCBlbnVtIGRwaW9fcGh5IHBoeSwKPiA+ICAgdm9pZCBjaHZfcGh5X3Bvd2VyZ2F0
ZV9sYW5lcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgICBib29s
IG92ZXJyaWRlLCB1bnNpZ25lZCBpbnQgbWFzaykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+IC0J
c3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93
ZXJfZG9tYWluczsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93
ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOwo+ID4gICAJZW51bSBkcGlvX3BoeSBw
aHkgPSB2bHZfZHBvcnRfdG9fcGh5KGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSkpOwo+
ID4gICAJZW51bSBkcGlvX2NoYW5uZWwgY2ggPSB2bHZfZHBvcnRfdG9fY2hhbm5lbChlbmNfdG9f
ZGlnX3BvcnQoJmVuY29kZXItPmJhc2UpKTsKPiA+ICAgCW11dGV4X2xvY2soJnBvd2VyX2RvbWFp
bnMtPmxvY2spOwo+ID4gLQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sICY9IH5QSFlfQ0hfUE9X
RVJfRE9XTl9PVlJEKDB4ZiwgcGh5LCBjaCk7Cj4gPiAtCWRldl9wcml2LT5jaHZfcGh5X2NvbnRy
b2wgfD0gUEhZX0NIX1BPV0VSX0RPV05fT1ZSRChtYXNrLCBwaHksIGNoKTsKPiA+ICsJaTkxNS0+
Y2h2X3BoeV9jb250cm9sICY9IH5QSFlfQ0hfUE9XRVJfRE9XTl9PVlJEKDB4ZiwgcGh5LCBjaCk7
Cj4gPiArCWk5MTUtPmNodl9waHlfY29udHJvbCB8PSBQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEKG1h
c2ssIHBoeSwgY2gpOwo+ID4gICAJaWYgKG92ZXJyaWRlKQo+ID4gLQkJZGV2X3ByaXYtPmNodl9w
aHlfY29udHJvbCB8PSBQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEX0VOKHBoeSwgY2gpOwo+ID4gKwkJ
aTkxNS0+Y2h2X3BoeV9jb250cm9sIHw9IFBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4ocGh5LCBj
aCk7Cj4gPiAgIAllbHNlCj4gPiAtCQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sICY9IH5QSFlf
Q0hfUE9XRVJfRE9XTl9PVlJEX0VOKHBoeSwgY2gpOwo+ID4gKwkJaTkxNS0+Y2h2X3BoeV9jb250
cm9sICY9IH5QSFlfQ0hfUE9XRVJfRE9XTl9PVlJEX0VOKHBoeSwgY2gpOwo+ID4gLQlJOTE1X1dS
SVRFKERJU1BMQVlfUEhZX0NPTlRST0wsIGRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wpOwo+ID4g
KwlJOTE1X1dSSVRFKERJU1BMQVlfUEhZX0NPTlRST0wsIGk5MTUtPmNodl9waHlfY29udHJvbCk7
Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJQb3dlciBnYXRpbmcgRFBJTyBQSFklZCBDSCVkIGxhbmVz
IDB4JXggKFBIWV9DT05UUk9MPTB4JTA4eClcbiIsCj4gPiAtCQkgICAgICBwaHksIGNoLCBtYXNr
LCBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sKTsKPiA+ICsJCSAgICAgIHBoeSwgY2gsIG1hc2ss
IGk5MTUtPmNodl9waHlfY29udHJvbCk7Cj4gPiAtCWFzc2VydF9jaHZfcGh5X3N0YXR1cyhkZXZf
cHJpdik7Cj4gPiArCWFzc2VydF9jaHZfcGh5X3N0YXR1cyhpOTE1KTsKPiA+IC0JYXNzZXJ0X2No
dl9waHlfcG93ZXJnYXRlKGRldl9wcml2LCBwaHksIGNoLCBvdmVycmlkZSwgbWFzayk7Cj4gPiAr
CWFzc2VydF9jaHZfcGh5X3Bvd2VyZ2F0ZShpOTE1LCBwaHksIGNoLCBvdmVycmlkZSwgbWFzayk7
Cj4gPiAgIAltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+ID4gICB9Cj4gPiAt
c3RhdGljIGJvb2wgY2h2X3BpcGVfcG93ZXJfd2VsbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgYm9vbCBjaHZfcGlwZV9wb3dlcl93ZWxsX2Vu
YWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJc3RydWN0IGk5
MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKPiA+ICAgewo+ID4gICAJZW51bSBwaXBlIHBpcGUg
PSBQSVBFX0E7Cj4gPiAgIAlib29sIGVuYWJsZWQ7Cj4gPiAgIAl1MzIgc3RhdGUsIGN0cmw7Cj4g
PiAtCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfcHVuaXRfZ2V0KGk5MTUpOwo+
ID4gLQlzdGF0ZSA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSkg
JiBEUF9TU1NfTUFTSyhwaXBlKTsKPiA+ICsJc3RhdGUgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQ
VU5JVF9SRUdfRFNQU1NQTSkgJiBEUF9TU1NfTUFTSyhwaXBlKTsKPiA+ICAgCS8qCj4gPiAgIAkg
KiBXZSBvbmx5IGV2ZXIgc2V0IHRoZSBwb3dlci1vbiBhbmQgcG93ZXItZ2F0ZSBzdGF0ZXMsIGFu
eXRoaW5nCj4gPiAgIAkgKiBlbHNlIGlzIHVuZXhwZWN0ZWQuCj4gPiBAQCAtMTQ3NSwxNSArMTQ3
NSwxNSBAQCBzdGF0aWMgYm9vbCBjaHZfcGlwZV9wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJICogQSB0cmFuc2llbnQgc3RhdGUgYXQg
dGhpcyBwb2ludCB3b3VsZCBtZWFuIHNvbWUgdW5leHBlY3RlZCBwYXJ0eQo+ID4gICAJICogaXMg
cG9raW5nIGF0IHRoZSBwb3dlciBjb250cm9scyB0b28uCj4gPiAgIAkgKi8KPiA+IC0JY3RybCA9
IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSkgJiBEUF9TU0NfTUFT
SyhwaXBlKTsKPiA+ICsJY3RybCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19EU1BT
U1BNKSAmIERQX1NTQ19NQVNLKHBpcGUpOwo+ID4gICAJV0FSTl9PTihjdHJsIDw8IDE2ICE9IHN0
YXRlKTsKPiA+IC0Jdmx2X3B1bml0X3B1dChkZXZfcHJpdik7Cj4gPiArCXZsdl9wdW5pdF9wdXQo
aTkxNSk7Cj4gPiAgIAlyZXR1cm4gZW5hYmxlZDsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGNo
dl9zZXRfcGlwZV9wb3dlcl93ZWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICtzdGF0aWMgdm9pZCBjaHZfc2V0X3BpcGVfcG93ZXJfd2VsbChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dl
cl93ZWxsLAo+ID4gICAJCQkJICAgIGJvb2wgZW5hYmxlKQo+ID4gICB7Cj4gPiBAQCAtMTQ5Myw0
NCArMTQ5Myw0NCBAQCBzdGF0aWMgdm9pZCBjaHZfc2V0X3BpcGVfcG93ZXJfd2VsbChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlzdGF0ZSA9IGVuYWJsZSA/IERQX1NT
U19QV1JfT04ocGlwZSkgOiBEUF9TU1NfUFdSX0dBVEUocGlwZSk7Cj4gPiAtCXZsdl9wdW5pdF9n
ZXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfcHVuaXRfZ2V0KGk5MTUpOwo+ID4gICAjZGVmaW5lIENP
TkQgXAo+ID4gLQkoKHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSkg
JiBEUF9TU1NfTUFTSyhwaXBlKSkgPT0gc3RhdGUpCj4gPiArCSgodmx2X3B1bml0X3JlYWQoaTkx
NSwgUFVOSVRfUkVHX0RTUFNTUE0pICYgRFBfU1NTX01BU0socGlwZSkpID09IHN0YXRlKQo+ID4g
ICAJaWYgKENPTkQpCj4gPiAgIAkJZ290byBvdXQ7Cj4gPiAtCWN0cmwgPSB2bHZfcHVuaXRfcmVh
ZChkZXZfcHJpdiwgUFVOSVRfUkVHX0RTUFNTUE0pOwo+ID4gKwljdHJsID0gdmx2X3B1bml0X3Jl
YWQoaTkxNSwgUFVOSVRfUkVHX0RTUFNTUE0pOwo+ID4gICAJY3RybCAmPSB+RFBfU1NDX01BU0so
cGlwZSk7Cj4gPiAgIAljdHJsIHw9IGVuYWJsZSA/IERQX1NTQ19QV1JfT04ocGlwZSkgOiBEUF9T
U0NfUFdSX0dBVEUocGlwZSk7Cj4gPiAtCXZsdl9wdW5pdF93cml0ZShkZXZfcHJpdiwgUFVOSVRf
UkVHX0RTUFNTUE0sIGN0cmwpOwo+ID4gKwl2bHZfcHVuaXRfd3JpdGUoaTkxNSwgUFVOSVRfUkVH
X0RTUFNTUE0sIGN0cmwpOwo+ID4gICAJaWYgKHdhaXRfZm9yKENPTkQsIDEwMCkpCj4gPiAgIAkJ
RFJNX0VSUk9SKCJ0aW1lb3V0IHNldHRpbmcgcG93ZXIgd2VsbCBzdGF0ZSAlMDh4ICglMDh4KVxu
IiwKPiA+ICAgCQkJICBzdGF0ZSwKPiA+IC0JCQkgIHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQ
VU5JVF9SRUdfRFNQU1NQTSkpOwo+ID4gKwkJCSAgdmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRf
UkVHX0RTUFNTUE0pKTsKPiA+ICAgI3VuZGVmIENPTkQKPiA+ICAgb3V0Ogo+ID4gLQl2bHZfcHVu
aXRfcHV0KGRldl9wcml2KTsKPiA+ICsJdmx2X3B1bml0X3B1dChpOTE1KTsKPiA+ICAgfQo+ID4g
LXN0YXRpYyB2b2lkIGNodl9waXBlX3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBjaHZfcGlwZV9wb3dlcl93ZWxsX2Vu
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgICBzdHJ1
Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQo+ID4gICB7Cj4gPiAtCWNodl9zZXRfcGlw
ZV9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxsLCB0cnVlKTsKPiA+ICsJY2h2X3NldF9w
aXBlX3Bvd2VyX3dlbGwoaTkxNSwgcG93ZXJfd2VsbCwgdHJ1ZSk7Cj4gPiAtCXZsdl9kaXNwbGF5
X3Bvd2VyX3dlbGxfaW5pdChkZXZfcHJpdik7Cj4gPiArCXZsdl9kaXNwbGF5X3Bvd2VyX3dlbGxf
aW5pdChpOTE1KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGNodl9waXBlX3Bvd2VyX3dlbGxf
ZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZv
aWQgY2h2X3BpcGVfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ID4gICAJCQkJCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCj4gPiAg
IHsKPiA+IC0Jdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9kZWluaXQoZGV2X3ByaXYpOwo+ID4gKwl2
bHZfZGlzcGxheV9wb3dlcl93ZWxsX2RlaW5pdChpOTE1KTsKPiA+IC0JY2h2X3NldF9waXBlX3Bv
d2VyX3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIGZhbHNlKTsKPiA+ICsJY2h2X3NldF9waXBl
X3Bvd2VyX3dlbGwoaTkxNSwgcG93ZXJfd2VsbCwgZmFsc2UpOwo+ID4gICB9Cj4gPiAgIHN0YXRp
YyB1NjQgX19hc3luY19wdXRfZG9tYWluc19tYXNrKHN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMg
KnBvd2VyX2RvbWFpbnMpCj4gPiBAQCAtMTYyNywxMCArMTYyNywxMCBAQCBhc3luY19wdXRfZG9t
YWluc19jbGVhcl9kb21haW4oc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlu
cywKPiA+ICAgfQo+ID4gICBzdGF0aWMgYm9vbAo+ID4gLWludGVsX2Rpc3BsYXlfcG93ZXJfZ3Jh
Yl9hc3luY19wdXRfcmVmKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtp
bnRlbF9kaXNwbGF5X3Bvd2VyX2dyYWJfYXN5bmNfcHV0X3JlZihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9t
YWluIGRvbWFpbikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dl
cl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwo+ID4gKwlzdHJ1Y3QgaTkxNV9w
b3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gPiAg
IAlib29sIHJldCA9IGZhbHNlOwo+ID4gICAJaWYgKCEoYXN5bmNfcHV0X2RvbWFpbnNfbWFzayhw
b3dlcl9kb21haW5zKSAmIEJJVF9VTEwoZG9tYWluKSkpCj4gPiBAQCAtMTY0NCw3ICsxNjQ0LDcg
QEAgaW50ZWxfZGlzcGxheV9wb3dlcl9ncmFiX2FzeW5jX3B1dF9yZWYoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCWdvdG8gb3V0X3ZlcmlmeTsKPiA+ICAgCWNhbmNl
bF9kZWxheWVkX3dvcmsoJnBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF93b3JrKTsKPiA+IC0JaW50
ZWxfcnVudGltZV9wbV9wdXRfcmF3KGRldl9wcml2LAo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX3B1
dF9yYXcoaTkxNSwKPiA+ICAgCQkJCSBmZXRjaF9hbmRfemVybygmcG93ZXJfZG9tYWlucy0+YXN5
bmNfcHV0X3dha2VyZWYpKTsKPiA+ICAgb3V0X3ZlcmlmeToKPiA+ICAgCXZlcmlmeV9hc3luY19w
dXRfZG9tYWluc19zdGF0ZShwb3dlcl9kb21haW5zKTsKPiA+IEBAIC0xNjUzLDI0ICsxNjUzLDI0
IEBAIGludGVsX2Rpc3BsYXlfcG93ZXJfZ3JhYl9hc3luY19wdXRfcmVmKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZAo+ID4gLV9faW50
ZWxfZGlzcGxheV9wb3dlcl9nZXRfZG9tYWluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICtfX2ludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2RvbWFpbihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9t
YWluIGRvbWFpbikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dl
cl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwo+ID4gKwlzdHJ1Y3QgaTkxNV9w
b3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gPiAg
IAlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsOwo+ID4gLQlpZiAoaW50ZWxfZGlz
cGxheV9wb3dlcl9ncmFiX2FzeW5jX3B1dF9yZWYoZGV2X3ByaXYsIGRvbWFpbikpCj4gPiArCWlm
IChpbnRlbF9kaXNwbGF5X3Bvd2VyX2dyYWJfYXN5bmNfcHV0X3JlZihpOTE1LCBkb21haW4pKQo+
ID4gICAJCXJldHVybjsKPiA+IC0JZm9yX2VhY2hfcG93ZXJfZG9tYWluX3dlbGwoZGV2X3ByaXYs
IHBvd2VyX3dlbGwsIEJJVF9VTEwoZG9tYWluKSkKPiA+IC0JCWludGVsX3Bvd2VyX3dlbGxfZ2V0
KGRldl9wcml2LCBwb3dlcl93ZWxsKTsKPiA+ICsJZm9yX2VhY2hfcG93ZXJfZG9tYWluX3dlbGwo
aTkxNSwgcG93ZXJfd2VsbCwgQklUX1VMTChkb21haW4pKQo+ID4gKwkJaW50ZWxfcG93ZXJfd2Vs
bF9nZXQoaTkxNSwgcG93ZXJfd2VsbCk7Cj4gPiAgIAlwb3dlcl9kb21haW5zLT5kb21haW5fdXNl
X2NvdW50W2RvbWFpbl0rKzsKPiA+ICAgfQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfZGlzcGxh
eV9wb3dlcl9nZXQgLSBncmFiIGEgcG93ZXIgZG9tYWluIHJlZmVyZW5jZQo+ID4gLSAqIEBkZXZf
cHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5z
dGFuY2UKPiA+ICAgICogQGRvbWFpbjogcG93ZXIgZG9tYWluIHRvIHJlZmVyZW5jZQo+ID4gICAg
Kgo+ID4gICAgKiBUaGlzIGZ1bmN0aW9uIGdyYWJzIGEgcG93ZXIgZG9tYWluIHJlZmVyZW5jZSBm
b3IgQGRvbWFpbiBhbmQgZW5zdXJlcyB0aGF0IHRoZQo+ID4gQEAgLTE2ODAsMTQgKzE2ODAsMTQg
QEAgX19pbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9kb21haW4oc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gICAgKiBBbnkgcG93ZXIgZG9tYWluIHJlZmVyZW5jZSBvYnRhaW5l
ZCBieSB0aGlzIGZ1bmN0aW9uIG11c3QgaGF2ZSBhIHN5bW1ldHJpYwo+ID4gICAgKiBjYWxsIHRv
IGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KCkgdG8gcmVsZWFzZSB0aGUgcmVmZXJlbmNlIGFnYWlu
Lgo+ID4gICAgKi8KPiA+IC1pbnRlbF93YWtlcmVmX3QgaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2ludGVsX3dha2VyZWZfdCBp
bnRlbF9kaXNwbGF5X3Bvd2VyX2dldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+
ICAgCQkJCQllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbikKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2
LT5wb3dlcl9kb21haW5zOwo+ID4gLQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZiA9IGludGVsX3J1
bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKPiA+ICsJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAq
cG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOwo+ID4gKwlpbnRlbF93YWtlcmVm
X3Qgd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ID4gICAJbXV0ZXhfbG9j
aygmcG93ZXJfZG9tYWlucy0+bG9jayk7Cj4gPiAtCV9faW50ZWxfZGlzcGxheV9wb3dlcl9nZXRf
ZG9tYWluKGRldl9wcml2LCBkb21haW4pOwo+ID4gKwlfX2ludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0
X2RvbWFpbihpOTE1LCBkb21haW4pOwo+ID4gICAJbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5z
LT5sb2NrKTsKPiA+ICAgCXJldHVybiB3YWtlcmVmOwo+ID4gQEAgLTE2OTUsNyArMTY5NSw3IEBA
IGludGVsX3dha2VyZWZfdCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2dldF9pZl9lbmFibGVkIC0gZ3JhYiBhIHJlZmVyZW5jZSBmb3IgYW4gZW5hYmxlZCBkaXNwbGF5
IHBvd2VyIGRvbWFpbgo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+
ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICAgICogQGRvbWFpbjogcG93ZXIg
ZG9tYWluIHRvIHJlZmVyZW5jZQo+ID4gICAgKgo+ID4gICAgKiBUaGlzIGZ1bmN0aW9uIGdyYWJz
IGEgcG93ZXIgZG9tYWluIHJlZmVyZW5jZSBmb3IgQGRvbWFpbiBhbmQgZW5zdXJlcyB0aGF0IHRo
ZQo+ID4gQEAgLTE3MDYsMjEgKzE3MDYsMjEgQEAgaW50ZWxfd2FrZXJlZl90IGludGVsX2Rpc3Bs
YXlfcG93ZXJfZ2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgICog
Y2FsbCB0byBpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dCgpIHRvIHJlbGVhc2UgdGhlIHJlZmVyZW5j
ZSBhZ2Fpbi4KPiA+ICAgICovCj4gPiAgIGludGVsX3dha2VyZWZfdAo+ID4gLWludGVsX2Rpc3Bs
YXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gK2ludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9t
YWluIGRvbWFpbikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dl
cl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwo+ID4gKwlzdHJ1Y3QgaTkxNV9w
b3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gPiAg
IAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCWJvb2wgaXNfZW5hYmxlZDsKPiA+IC0J
d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShkZXZfcHJpdik7Cj4gPiAr
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoaTkxNSk7Cj4gPiAgIAlp
ZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gICAJbXV0ZXhfbG9jaygmcG93
ZXJfZG9tYWlucy0+bG9jayk7Cj4gPiAtCWlmIChfX2ludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5h
YmxlZChkZXZfcHJpdiwgZG9tYWluKSkgewo+ID4gLQkJX19pbnRlbF9kaXNwbGF5X3Bvd2VyX2dl
dF9kb21haW4oZGV2X3ByaXYsIGRvbWFpbik7Cj4gPiArCWlmIChfX2ludGVsX2Rpc3BsYXlfcG93
ZXJfaXNfZW5hYmxlZChpOTE1LCBkb21haW4pKSB7Cj4gPiArCQlfX2ludGVsX2Rpc3BsYXlfcG93
ZXJfZ2V0X2RvbWFpbihpOTE1LCBkb21haW4pOwo+ID4gICAJCWlzX2VuYWJsZWQgPSB0cnVlOwo+
ID4gICAJfSBlbHNlIHsKPiA+ICAgCQlpc19lbmFibGVkID0gZmFsc2U7Cj4gPiBAQCAtMTcyOSw3
ICsxNzI5LDcgQEAgaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAltdXRleF91bmxvY2soJnBvd2VyX2RvbWFp
bnMtPmxvY2spOwo+ID4gICAJaWYgKCFpc19lbmFibGVkKSB7Cj4gPiAtCQlpbnRlbF9ydW50aW1l
X3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7Cj4gPiArCQlpbnRlbF9ydW50aW1lX3BtX3B1dChp
OTE1LCB3YWtlcmVmKTsKPiA+ICAgCQl3YWtlcmVmID0gMDsKPiA+ICAgCX0KPiA+IEBAIC0xNzM3
LDE0ICsxNzM3LDE0IEBAIGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkCj4g
PiAtX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF9kb21haW4oc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK19faW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfZG9tYWluKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJIGVudW0gaW50ZWxfZGlzcGxheV9w
b3dlcl9kb21haW4gZG9tYWluKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21h
aW5zICpwb3dlcl9kb21haW5zOwo+ID4gICAJc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJf
d2VsbDsKPiA+ICAgCWNvbnN0IGNoYXIgKm5hbWUgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFp
bl9zdHIoZG9tYWluKTsKPiA+IC0JcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9t
YWluczsKPiA+ICsJcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOwo+ID4gICAJ
V0FSTighcG93ZXJfZG9tYWlucy0+ZG9tYWluX3VzZV9jb3VudFtkb21haW5dLAo+ID4gICAJICAg
ICAiVXNlIGNvdW50IG9uIGRvbWFpbiAlcyBpcyBhbHJlYWR5IHplcm9cbiIsCj4gPiBAQCAtMTc1
NSwyMyArMTc1NSwyMyBAQCBfX2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2RvbWFpbihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlwb3dlcl9kb21haW5zLT5kb21haW5f
dXNlX2NvdW50W2RvbWFpbl0tLTsKPiA+IC0JZm9yX2VhY2hfcG93ZXJfZG9tYWluX3dlbGxfcmV2
ZXJzZShkZXZfcHJpdiwgcG93ZXJfd2VsbCwgQklUX1VMTChkb21haW4pKQo+ID4gLQkJaW50ZWxf
cG93ZXJfd2VsbF9wdXQoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwo+ID4gKwlmb3JfZWFjaF9wb3dl
cl9kb21haW5fd2VsbF9yZXZlcnNlKGk5MTUsIHBvd2VyX3dlbGwsIEJJVF9VTEwoZG9tYWluKSkK
PiA+ICsJCWludGVsX3Bvd2VyX3dlbGxfcHV0KGk5MTUsIHBvd2VyX3dlbGwpOwo+ID4gICB9Cj4g
PiAtc3RhdGljIHZvaWQgX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgX19pbnRlbF9kaXNwbGF5X3Bvd2Vy
X3B1dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgIGVudW0g
aW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBp
OTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFp
bnM7Cj4gPiArCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkx
NS0+cG93ZXJfZG9tYWluczsKPiA+ICAgCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2sp
Owo+ID4gLQlfX2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2RvbWFpbihkZXZfcHJpdiwgZG9tYWlu
KTsKPiA+ICsJX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF9kb21haW4oaTkxNSwgZG9tYWluKTsK
PiA+ICAgCW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Cj4gPiAgIH0KPiA+ICAg
LyoqCj4gPiAgICAqIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZCAtIHJlbGVhc2Ug
YW4gdW5jaGVja2VkIHBvd2VyIGRvbWFpbiByZWZlcmVuY2UKPiA+IC0gKiBAZGV2X3ByaXY6IGk5
MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4g
PiAgICAqIEBkb21haW46IHBvd2VyIGRvbWFpbiB0byByZWZlcmVuY2UKPiA+ICAgICoKPiA+ICAg
ICogVGhpcyBmdW5jdGlvbiBkcm9wcyB0aGUgcG93ZXIgZG9tYWluIHJlZmVyZW5jZSBvYnRhaW5l
ZCBieQo+ID4gQEAgLTE3ODIsMTEgKzE3ODIsMTEgQEAgc3RhdGljIHZvaWQgX19pbnRlbF9kaXNw
bGF5X3Bvd2VyX3B1dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgICAq
IG5ldyBjb2RlLCBhcyB0aGUgY29ycmVjdG5lc3Mgb2YgaXRzIHVzZSBjYW5ub3QgYmUgY2hlY2tl
ZC4gQWx3YXlzIHVzZQo+ID4gICAgKiBpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dCgpIGluc3RlYWQu
Cj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2Rpc3BsYXlf
cG93ZXJfcHV0X3VuY2hlY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJCSAgICAgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbikKPiA+ICAg
ewo+ID4gLQlfX2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBkb21haW4pOwo+ID4g
LQlpbnRlbF9ydW50aW1lX3BtX3B1dF91bmNoZWNrZWQoZGV2X3ByaXYpOwo+ID4gKwlfX2ludGVs
X2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIGRvbWFpbik7Cj4gPiArCWludGVsX3J1bnRpbWVfcG1f
cHV0X3VuY2hlY2tlZChpOTE1KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZAo+ID4gQEAgLTE4
MDMsNyArMTgwMyw3IEBAIHF1ZXVlX2FzeW5jX3B1dF9kb21haW5zX3dvcmsoc3RydWN0IGk5MTVf
cG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucywKPiA+ICAgc3RhdGljIHZvaWQKPiA+ICAgcmVs
ZWFzZV9hc3luY19wdXRfZG9tYWlucyhzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9k
b21haW5zLCB1NjQgbWFzaykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gPiAgIAkJ
Y29udGFpbmVyX29mKHBvd2VyX2RvbWFpbnMsIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlLAo+ID4g
ICAJCQkgICAgIHBvd2VyX2RvbWFpbnMpOwo+ID4gICAJZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2RvbWFpbiBkb21haW47Cj4gPiBAQCAtMTgxNCwyNiArMTgxNCwyNiBAQCByZWxlYXNlX2FzeW5j
X3B1dF9kb21haW5zKHN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMsIHU2
NCBtYXNrKQo+ID4gICAJICogd2FrZXJlZiB0byBtYWtlIHRoZSBzdGF0ZSBjaGVja2VyIGhhcHB5
IGFib3V0IHRoZSBIVyBhY2Nlc3MgZHVyaW5nCj4gPiAgIAkgKiBwb3dlciB3ZWxsIGRpc2FibGlu
Zy4KPiA+ICAgCSAqLwo+ID4gLQlhc3NlcnRfcnBtX3Jhd193YWtlcmVmX2hlbGQoZGV2X3ByaXYp
Owo+ID4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ID4gKwlh
c3NlcnRfcnBtX3Jhd193YWtlcmVmX2hlbGQoaTkxNSk7Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9y
dW50aW1lX3BtX2dldChpOTE1KTsKPiA+ICAgCWZvcl9lYWNoX3Bvd2VyX2RvbWFpbihkb21haW4s
IG1hc2spIHsKPiA+ICAgCQkvKiBDbGVhciBiZWZvcmUgcHV0LCBzbyBwdXQncyBzYW5pdHkgY2hl
Y2sgaXMgaGFwcHkuICovCj4gPiAgIAkJYXN5bmNfcHV0X2RvbWFpbnNfY2xlYXJfZG9tYWluKHBv
d2VyX2RvbWFpbnMsIGRvbWFpbik7Cj4gPiAtCQlfX2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2Rv
bWFpbihkZXZfcHJpdiwgZG9tYWluKTsKPiA+ICsJCV9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXRf
ZG9tYWluKGk5MTUsIGRvbWFpbik7Cj4gPiAgIAl9Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0
KGRldl9wcml2LCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2Fr
ZXJlZik7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQKPiA+ICAgaW50ZWxfZGlzcGxheV9wb3dl
cl9wdXRfYXN5bmNfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPQo+ID4gICAJCWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSwKPiA+ICAgCQkJICAgICBwb3dlcl9kb21haW5zLmFzeW5jX3B1dF93b3JrLndv
cmspOwo+ID4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmRl
dl9wcml2LT5wb3dlcl9kb21haW5zOwo+ID4gLQlpbnRlbF93YWtlcmVmX3QgbmV3X3dvcmtfd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X3JhdyhkZXZfcHJpdik7Cj4gPiArCXN0cnVjdCBp
OTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93ZXJfZG9tYWluczsK
PiA+ICsJaW50ZWxfd2FrZXJlZl90IG5ld193b3JrX3dha2VyZWYgPSBpbnRlbF9ydW50aW1lX3Bt
X2dldF9yYXcoaTkxNSk7Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgb2xkX3dvcmtfd2FrZXJlZiA9
IDA7Cj4gPiAgIAltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiA+IEBAIC0xODYz
LDkgKzE4NjMsOSBAQCBpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF9hc3luY193b3JrKHN0cnVjdCB3
b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgCW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlucy0+bG9j
ayk7Cj4gPiAgIAlpZiAob2xkX3dvcmtfd2FrZXJlZikKPiA+IC0JCWludGVsX3J1bnRpbWVfcG1f
cHV0X3JhdyhkZXZfcHJpdiwgb2xkX3dvcmtfd2FrZXJlZik7Cj4gPiArCQlpbnRlbF9ydW50aW1l
X3BtX3B1dF9yYXcoaTkxNSwgb2xkX3dvcmtfd2FrZXJlZik7Cj4gPiAgIAlpZiAobmV3X3dvcmtf
d2FrZXJlZikKPiA+IC0JCWludGVsX3J1bnRpbWVfcG1fcHV0X3JhdyhkZXZfcHJpdiwgbmV3X3dv
cmtfd2FrZXJlZik7Cj4gPiArCQlpbnRlbF9ydW50aW1lX3BtX3B1dF9yYXcoaTkxNSwgbmV3X3dv
cmtfd2FrZXJlZik7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiBAQCAtMTk3NCw3ICsxOTc0LDcgQEAg
aW50ZWxfZGlzcGxheV9wb3dlcl9mbHVzaF93b3JrX3N5bmMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gPiAgICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19SVU5U
SU1FX1BNKQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQgLSByZWxl
YXNlIGEgcG93ZXIgZG9tYWluIHJlZmVyZW5jZQo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZp
Y2UgaW5zdGFuY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICAgICog
QGRvbWFpbjogcG93ZXIgZG9tYWluIHRvIHJlZmVyZW5jZQo+ID4gICAgKiBAd2FrZXJlZjogd2Fr
ZXJlZiBhY3F1aXJlZCBmb3IgdGhlIHJlZmVyZW5jZSB0aGF0IGlzIGJlaW5nIHJlbGVhc2VkCj4g
PiAgICAqCj4gPiBAQCAtMTk4MiwxMiArMTk4MiwxMiBAQCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2Zs
dXNoX3dvcmtfc3luYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgICogaW50
ZWxfZGlzcGxheV9wb3dlcl9nZXQoKSBhbmQgbWlnaHQgcG93ZXIgZG93biB0aGUgY29ycmVzcG9u
ZGluZyBoYXJkd2FyZQo+ID4gICAgKiBibG9jayByaWdodCBhd2F5IGlmIHRoaXMgaXMgdGhlIGxh
c3QgcmVmZXJlbmNlLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2Rpc3Bs
YXlfcG93ZXJfcHV0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAg
IGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluLAo+ID4gICAJCQkgICAgIGlu
dGVsX3dha2VyZWZfdCB3YWtlcmVmKQo+ID4gICB7Cj4gPiAtCV9faW50ZWxfZGlzcGxheV9wb3dl
cl9wdXQoZGV2X3ByaXYsIGRvbWFpbik7Cj4gPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9w
cml2LCB3YWtlcmVmKTsKPiA+ICsJX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBkb21h
aW4pOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiA+ICAgfQo+
ID4gICAjZW5kaWYKPiA+IEBAIC0yNjU1LDE0ICsyNjU1LDE0IEBAIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgaTkxNV9wb3dlcl93ZWxsX2Rlc2MgY2h2X3Bvd2VyX3dlbGxzW10gPSB7Cj4gPiAgIAl9LAo+
ID4gICB9Owo+ID4gLWJvb2wgaW50ZWxfZGlzcGxheV9wb3dlcl93ZWxsX2lzX2VuYWJsZWQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2Jvb2wgaW50ZWxfZGlzcGxheV9w
b3dlcl93ZWxsX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAg
IAkJCQkJIGVudW0gaTkxNV9wb3dlcl93ZWxsX2lkIHBvd2VyX3dlbGxfaWQpCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGw7Cj4gPiAgIAlib29sIHJldDsK
PiA+IC0JcG93ZXJfd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxs
X2lkKTsKPiA+IC0JcmV0ID0gcG93ZXJfd2VsbC0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9w
cml2LCBwb3dlcl93ZWxsKTsKPiA+ICsJcG93ZXJfd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGk5
MTUsIHBvd2VyX3dlbGxfaWQpOwo+ID4gKwlyZXQgPSBwb3dlcl93ZWxsLT5kZXNjLT5vcHMtPmlz
X2VuYWJsZWQoaTkxNSwgcG93ZXJfd2VsbCk7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4g
PiBAQCAtMzM1Miw3ICszMzUyLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dl
bGxfZGVzYyBpY2xfcG93ZXJfd2VsbHNbXSA9IHsKPiA+ICAgfTsKPiA+ICAgc3RhdGljIGludAo+
ID4gLXNhbml0aXplX2Rpc2FibGVfcG93ZXJfd2VsbF9vcHRpb24oY29uc3Qgc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3Nhbml0aXplX2Rpc2FibGVfcG93ZXJfd2VsbF9v
cHRpb24oY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICBp
bnQgZGlzYWJsZV9wb3dlcl93ZWxsKQo+ID4gICB7Cj4gPiAgIAlpZiAoZGlzYWJsZV9wb3dlcl93
ZWxsID49IDApCj4gPiBAQCAtMzM2MSwxNCArMzM2MSwxNCBAQCBzYW5pdGl6ZV9kaXNhYmxlX3Bv
d2VyX3dlbGxfb3B0aW9uKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICAgCXJldHVybiAxOwo+ID4gICB9Cj4gPiAtc3RhdGljIHUzMiBnZXRfYWxsb3dlZF9kY19t
YXNrKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMg
dTMyIGdldF9hbGxvd2VkX2RjX21hc2soY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJCSAgICAgICBpbnQgZW5hYmxlX2RjKQo+ID4gICB7Cj4gPiAgIAl1MzIgbWFz
azsKPiA+ICAgCWludCByZXF1ZXN0ZWRfZGM7Cj4gPiAgIAlpbnQgbWF4X2RjOwo+ID4gLQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49
IDExKSB7Cj4gPiAgIAkJbWF4X2RjID0gMjsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIERDOSBoYXMg
YSBzZXBhcmF0ZSBIVyBmbG93IGZyb20gdGhlIHJlc3Qgb2YgdGhlIERDIHN0YXRlcywKPiA+IEBA
IC0zMzc2LDEwICszMzc2LDEwIEBAIHN0YXRpYyB1MzIgZ2V0X2FsbG93ZWRfZGNfbWFzayhjb25z
dCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJICogc3VzcGVuZC9y
ZXN1bWUsIHNvIGFsbG93IGl0IHVuY29uZGl0aW9uYWxseS4KPiA+ICAgCQkgKi8KPiA+ICAgCQlt
YXNrID0gRENfU1RBVEVfRU5fREM5Owo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwg
MTApIHx8IElTX0dFTjlfQkMoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfR0VOKGk5
MTUsIDEwKSB8fCBJU19HRU45X0JDKGk5MTUpKSB7Cj4gPiAgIAkJbWF4X2RjID0gMjsKPiA+ICAg
CQltYXNrID0gMDsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewo+ID4g
Kwl9IGVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiA+ICAgCQltYXhfZGMgPSAxOwo+ID4g
ICAJCW1hc2sgPSBEQ19TVEFURV9FTl9EQzk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gQEAgLTM0NTEs
MjEgKzM0NTEsMjEgQEAgX19zZXRfcG93ZXJfd2VsbHMoc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlu
cyAqcG93ZXJfZG9tYWlucywKPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX3Bvd2VyX2RvbWFpbnNf
aW5pdCAtIGluaXRpYWxpemVzIHRoZSBwb3dlciBkb21haW4gc3RydWN0dXJlcwo+ID4gLSAqIEBk
ZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2Ug
aW5zdGFuY2UKPiA+ICAgICoKPiA+IC0gKiBJbml0aWFsaXplcyB0aGUgcG93ZXIgZG9tYWluIHN0
cnVjdHVyZXMgZm9yIEBkZXZfcHJpdiBkZXBlbmRpbmcgdXBvbiB0aGUKPiA+ICsgKiBJbml0aWFs
aXplcyB0aGUgcG93ZXIgZG9tYWluIHN0cnVjdHVyZXMgZm9yIEBpOTE1IGRlcGVuZGluZyB1cG9u
IHRoZQo+ID4gICAgKiBzdXBwb3J0ZWQgcGxhdGZvcm0uCj4gPiAgICAqLwo+ID4gLWludCBpbnRl
bF9wb3dlcl9kb21haW5zX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gK2ludCBpbnRlbF9wb3dlcl9kb21haW5zX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9t
YWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKPiA+ICsJc3RydWN0IGk5MTVfcG93ZXJf
ZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOwo+ID4gICAJaW50
IGVycjsKPiA+ICAgCWk5MTVfbW9kcGFyYW1zLmRpc2FibGVfcG93ZXJfd2VsbCA9Cj4gPiAtCQlz
YW5pdGl6ZV9kaXNhYmxlX3Bvd2VyX3dlbGxfb3B0aW9uKGRldl9wcml2LAo+ID4gKwkJc2FuaXRp
emVfZGlzYWJsZV9wb3dlcl93ZWxsX29wdGlvbihpOTE1LAo+ID4gICAJCQkJCQkgICBpOTE1X21v
ZHBhcmFtcy5kaXNhYmxlX3Bvd2VyX3dlbGwpOwo+ID4gLQlkZXZfcHJpdi0+Y3NyLmFsbG93ZWRf
ZGNfbWFzayA9Cj4gPiAtCQlnZXRfYWxsb3dlZF9kY19tYXNrKGRldl9wcml2LCBpOTE1X21vZHBh
cmFtcy5lbmFibGVfZGMpOwo+ID4gKwlpOTE1LT5jc3IuYWxsb3dlZF9kY19tYXNrID0KPiA+ICsJ
CWdldF9hbGxvd2VkX2RjX21hc2soaTkxNSwgaTkxNV9tb2RwYXJhbXMuZW5hYmxlX2RjKTsKPiA+
ICAgCUJVSUxEX0JVR19PTihQT1dFUl9ET01BSU5fTlVNID4gNjQpOwo+ID4gQEAgLTM0NzgsOSAr
MzQ3OCw5IEBAIGludCBpbnRlbF9wb3dlcl9kb21haW5zX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gICAJICogVGhlIGVuYWJsaW5nIG9yZGVyIHdpbGwgYmUgZnJv
bSBsb3dlciB0byBoaWdoZXIgaW5kZXhlZCB3ZWxscywKPiA+ICAgCSAqIHRoZSBkaXNhYmxpbmcg
b3JkZXIgaXMgcmV2ZXJzZWQuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwg
MTEpKSB7Cj4gPiArCWlmIChJU19HRU4oaTkxNSwgMTEpKSB7Cj4gPiAgIAkJZXJyID0gc2V0X3Bv
d2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMsIGljbF9wb3dlcl93ZWxscyk7Cj4gPiAtCX0gZWxzZSBp
ZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19DQU5OT05M
QUtFKGk5MTUpKSB7Cj4gPiAgIAkJZXJyID0gc2V0X3Bvd2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMs
IGNubF9wb3dlcl93ZWxscyk7Cj4gPiAgIAkJLyoKPiA+IEBAIC0zNDg5LDIzICszNDg5LDIzIEBA
IGludCBpbnRlbF9wb3dlcl9kb21haW5zX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJCSAqIHRpbWVvdXRzLCBsZXRzIHJlbW92ZSB0aGVtIGZyb20gdGhlIGxp
c3QKPiA+ICAgCQkgKiBmb3IgdGhlIFNLVXMgd2l0aG91dCBwb3J0IEYuCj4gPiAgIAkJICovCj4g
PiAtCQlpZiAoIUlTX0NOTF9XSVRIX1BPUlRfRihkZXZfcHJpdikpCj4gPiArCQlpZiAoIUlTX0NO
TF9XSVRIX1BPUlRfRihpOTE1KSkKPiA+ICAgCQkJcG93ZXJfZG9tYWlucy0+cG93ZXJfd2VsbF9j
b3VudCAtPSAyOwo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4g
PiArCX0gZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkgewo+ID4gICAJCWVyciA9IHNldF9w
b3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBnbGtfcG93ZXJfd2VsbHMpOwo+ID4gLQl9IGVsc2Ug
aWYgKElTX0JST1hUT04oZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfQlJPWFRPTihp
OTE1KSkgewo+ID4gICAJCWVyciA9IHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBieHRf
cG93ZXJfd2VsbHMpOwo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKSB7Cj4g
PiArCX0gZWxzZSBpZiAoSVNfR0VOOV9CQyhpOTE1KSkgewo+ID4gICAJCWVyciA9IHNldF9wb3dl
cl93ZWxscyhwb3dlcl9kb21haW5zLCBza2xfcG93ZXJfd2VsbHMpOwo+ID4gLQl9IGVsc2UgaWYg
KElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfQ0hFUlJZVklF
VyhpOTE1KSkgewo+ID4gICAJCWVyciA9IHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBj
aHZfcG93ZXJfd2VsbHMpOwo+ID4gLQl9IGVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikp
IHsKPiA+ICsJfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkpIHsKPiA+ICAgCQllcnIgPSBz
ZXRfcG93ZXJfd2VsbHMocG93ZXJfZG9tYWlucywgYmR3X3Bvd2VyX3dlbGxzKTsKPiA+IC0JfSBl
bHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0hBU1dF
TEwoaTkxNSkpIHsKPiA+ICAgCQllcnIgPSBzZXRfcG93ZXJfd2VsbHMocG93ZXJfZG9tYWlucywg
aHN3X3Bvd2VyX3dlbGxzKTsKPiA+IC0JfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2
KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpIHsKPiA+ICAgCQllcnIg
PSBzZXRfcG93ZXJfd2VsbHMocG93ZXJfZG9tYWlucywgdmx2X3Bvd2VyX3dlbGxzKTsKPiA+IC0J
fSBlbHNlIGlmIChJU19JODMwKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0k4MzAo
aTkxNSkpIHsKPiA+ICAgCQllcnIgPSBzZXRfcG93ZXJfd2VsbHMocG93ZXJfZG9tYWlucywgaTgz
MF9wb3dlcl93ZWxscyk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCWVyciA9IHNldF9wb3dlcl93
ZWxscyhwb3dlcl9kb21haW5zLCBpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsKTsKPiA+IEBAIC0z
NTE2LDMxICszNTE2LDMxIEBAIGludCBpbnRlbF9wb3dlcl9kb21haW5zX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfcG93ZXJf
ZG9tYWluc19jbGVhbnVwIC0gY2xlYW4gdXAgcG93ZXIgZG9tYWlucyByZXNvdXJjZXMKPiA+IC0g
KiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2
aWNlIGluc3RhbmNlCj4gPiAgICAqCj4gPiAgICAqIFJlbGVhc2UgYW55IHJlc291cmNlcyBhY3F1
aXJlZCBieSBpbnRlbF9wb3dlcl9kb21haW5zX2luaXQoKQo+ID4gICAgKi8KPiA+IC12b2lkIGlu
dGVsX3Bvd2VyX2RvbWFpbnNfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiArdm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX2NsZWFudXAoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Ja2ZyZWUoZGV2X3ByaXYtPnBvd2VyX2RvbWFp
bnMucG93ZXJfd2VsbHMpOwo+ID4gKwlrZnJlZShpOTE1LT5wb3dlcl9kb21haW5zLnBvd2VyX3dl
bGxzKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfc3luY19o
dyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaW50
ZWxfcG93ZXJfZG9tYWluc19zeW5jX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAm
ZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Cj4gPiArCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMg
KnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93ZXJfZG9tYWluczsKPiA+ICAgCXN0cnVjdCBpOTE1
X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGw7Cj4gPiAgIAltdXRleF9sb2NrKCZwb3dlcl9kb21haW5z
LT5sb2NrKTsKPiA+IC0JZm9yX2VhY2hfcG93ZXJfd2VsbChkZXZfcHJpdiwgcG93ZXJfd2VsbCkg
ewo+ID4gLQkJcG93ZXJfd2VsbC0+ZGVzYy0+b3BzLT5zeW5jX2h3KGRldl9wcml2LCBwb3dlcl93
ZWxsKTsKPiA+ICsJZm9yX2VhY2hfcG93ZXJfd2VsbChpOTE1LCBwb3dlcl93ZWxsKSB7Cj4gPiAr
CQlwb3dlcl93ZWxsLT5kZXNjLT5vcHMtPnN5bmNfaHcoaTkxNSwgcG93ZXJfd2VsbCk7Cj4gPiAg
IAkJcG93ZXJfd2VsbC0+aHdfZW5hYmxlZCA9Cj4gPiAtCQkJcG93ZXJfd2VsbC0+ZGVzYy0+b3Bz
LT5pc19lbmFibGVkKGRldl9wcml2LCBwb3dlcl93ZWxsKTsKPiA+ICsJCQlwb3dlcl93ZWxsLT5k
ZXNjLT5vcHMtPmlzX2VuYWJsZWQoaTkxNSwgcG93ZXJfd2VsbCk7Cj4gPiAgIAl9Cj4gPiAgIAlt
dXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBp
bmxpbmUKPiA+IC1ib29sIGludGVsX2RidWZfc2xpY2Vfc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICtib29sIGludGVsX2RidWZfc2xpY2Vfc2V0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgIGk5MTVfcmVnX3QgcmVnLCBib29sIGVuYWJs
ZSkKPiA+ICAgewo+ID4gICAJdTMyIHZhbCwgc3RhdHVzOwo+ID4gQEAgLTM1NjAsMzAgKzM1NjAs
MzAgQEAgYm9vbCBpbnRlbF9kYnVmX3NsaWNlX3NldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiAgIAlyZXR1cm4gdHJ1ZTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGdl
bjlfZGJ1Zl9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0
YXRpYyB2b2lkIGdlbjlfZGJ1Zl9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+IC0JaW50ZWxfZGJ1Zl9zbGljZV9zZXQoZGV2X3ByaXYsIERCVUZfQ1RMLCB0
cnVlKTsKPiA+ICsJaW50ZWxfZGJ1Zl9zbGljZV9zZXQoaTkxNSwgREJVRl9DVEwsIHRydWUpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuOV9kYnVmX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGdlbjlfZGJ1Zl9kaXNhYmxlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWludGVsX2RidWZfc2xp
Y2Vfc2V0KGRldl9wcml2LCBEQlVGX0NUTCwgZmFsc2UpOwo+ID4gKwlpbnRlbF9kYnVmX3NsaWNl
X3NldChpOTE1LCBEQlVGX0NUTCwgZmFsc2UpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHU4IGludGVs
X2RidWZfbWF4X3NsaWNlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAr
c3RhdGljIHU4IGludGVsX2RidWZfbWF4X3NsaWNlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDExKQo+ID4gKwlp
ZiAoSU5URUxfR0VOKGk5MTUpIDwgMTEpCj4gPiAgIAkJcmV0dXJuIDE7Cj4gPiAgIAlyZXR1cm4g
MjsKPiA+ICAgfQo+ID4gLXZvaWQgaWNsX2RidWZfc2xpY2VzX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpY2xfZGJ1Zl9zbGljZXNfdXBkYXRlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgdTggcmVxX3NsaWNlcykK
PiA+ICAgewo+ID4gLQljb25zdCB1OCBod19lbmFibGVkX3NsaWNlcyA9IGRldl9wcml2LT53bS5z
a2xfaHcuZGRiLmVuYWJsZWRfc2xpY2VzOwo+ID4gKwljb25zdCB1OCBod19lbmFibGVkX3NsaWNl
cyA9IGk5MTUtPndtLnNrbF9ody5kZGIuZW5hYmxlZF9zbGljZXM7Cj4gPiAgIAlib29sIHJldDsK
PiA+IC0JaWYgKHJlcV9zbGljZXMgPiBpbnRlbF9kYnVmX21heF9zbGljZXMoZGV2X3ByaXYpKSB7
Cj4gPiArCWlmIChyZXFfc2xpY2VzID4gaW50ZWxfZGJ1Zl9tYXhfc2xpY2VzKGk5MTUpKSB7Cj4g
PiAgIAkJRFJNX0VSUk9SKCJJbnZhbGlkIG51bWJlciBvZiBkYnVmIHNsaWNlcyByZXF1ZXN0ZWRc
biIpOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IEBAIC0zNTkyLDE1ICszNTkyLDE1IEBA
IHZvaWQgaWNsX2RidWZfc2xpY2VzX3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJaWYgKHJlcV9zbGljZXMgPiBod19lbmFibGVk
X3NsaWNlcykKPiA+IC0JCXJldCA9IGludGVsX2RidWZfc2xpY2Vfc2V0KGRldl9wcml2LCBEQlVG
X0NUTF9TMiwgdHJ1ZSk7Cj4gPiArCQlyZXQgPSBpbnRlbF9kYnVmX3NsaWNlX3NldChpOTE1LCBE
QlVGX0NUTF9TMiwgdHJ1ZSk7Cj4gPiAgIAllbHNlCj4gPiAtCQlyZXQgPSBpbnRlbF9kYnVmX3Ns
aWNlX3NldChkZXZfcHJpdiwgREJVRl9DVExfUzIsIGZhbHNlKTsKPiA+ICsJCXJldCA9IGludGVs
X2RidWZfc2xpY2Vfc2V0KGk5MTUsIERCVUZfQ1RMX1MyLCBmYWxzZSk7Cj4gPiAgIAlpZiAocmV0
KQo+ID4gLQkJZGV2X3ByaXYtPndtLnNrbF9ody5kZGIuZW5hYmxlZF9zbGljZXMgPSByZXFfc2xp
Y2VzOwo+ID4gKwkJaTkxNS0+d20uc2tsX2h3LmRkYi5lbmFibGVkX3NsaWNlcyA9IHJlcV9zbGlj
ZXM7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpY2xfZGJ1Zl9lbmFibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGljbF9kYnVmX2VuYWJsZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJSTkxNV9XUklURShE
QlVGX0NUTF9TMSwgSTkxNV9SRUFEKERCVUZfQ1RMX1MxKSB8IERCVUZfUE9XRVJfUkVRVUVTVCk7
Cj4gPiAgIAlJOTE1X1dSSVRFKERCVUZfQ1RMX1MyLCBJOTE1X1JFQUQoREJVRl9DVExfUzIpIHwg
REJVRl9QT1dFUl9SRVFVRVNUKTsKPiA+IEBAIC0zNjE2LDEwICszNjE2LDEwIEBAIHN0YXRpYyB2
b2lkIGljbF9kYnVmX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiAgIAkJICogRklYTUU6IGZvciBub3cgcHJldGVuZCB0aGF0IHdlIG9ubHkgaGF2ZSAxIHNsaWNl
LCBzZWUKPiA+ICAgCQkgKiBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bSgpLgo+ID4gICAJ
CSAqLwo+ID4gLQkJZGV2X3ByaXYtPndtLnNrbF9ody5kZGIuZW5hYmxlZF9zbGljZXMgPSAxOwo+
ID4gKwkJaTkxNS0+d20uc2tsX2h3LmRkYi5lbmFibGVkX3NsaWNlcyA9IDE7Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgdm9pZCBpY2xfZGJ1Zl9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpY2xfZGJ1Zl9kaXNhYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlJOTE1X1dSSVRFKERCVUZfQ1RMX1MxLCBJ
OTE1X1JFQUQoREJVRl9DVExfUzEpICYgfkRCVUZfUE9XRVJfUkVRVUVTVCk7Cj4gPiAgIAlJOTE1
X1dSSVRFKERCVUZfQ1RMX1MyLCBJOTE1X1JFQUQoREJVRl9DVExfUzIpICYgfkRCVUZfUE9XRVJf
UkVRVUVTVCk7Cj4gPiBAQCAtMzYzNSwxMCArMzYzNSwxMCBAQCBzdGF0aWMgdm9pZCBpY2xfZGJ1
Zl9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgKiBG
SVhNRTogZm9yIG5vdyBwcmV0ZW5kIHRoYXQgdGhlIGZpcnN0IHNsaWNlIGlzIGFsd2F5cwo+ID4g
ICAJCSAqIGVuYWJsZWQsIHNlZSBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bSgpLgo+ID4g
ICAJCSAqLwo+ID4gLQkJZGV2X3ByaXYtPndtLnNrbF9ody5kZGIuZW5hYmxlZF9zbGljZXMgPSAx
Owo+ID4gKwkJaTkxNS0+d20uc2tsX2h3LmRkYi5lbmFibGVkX3NsaWNlcyA9IDE7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgdm9pZCBpY2xfbWJ1c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpY2xfbWJ1c19pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gQEAgLTM2NTAsNyArMzY1
MCw3IEBAIHN0YXRpYyB2b2lkIGljbF9tYnVzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gICAJSTkxNV9XUklURShNQlVTX0FCT1hfQ1RMLCB2YWwpOwo+ID4gICB9
Cj4gPiAtc3RhdGljIHZvaWQgaHN3X2Fzc2VydF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaHN3X2Fzc2VydF9jZGNsayhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIHZhbCA9IEk5MTVfUkVBRChM
Q1BMTF9DVEwpOwo+ID4gQEAgLTM2NzAsOSArMzY3MCw5IEBAIHN0YXRpYyB2b2lkIGhzd19hc3Nl
cnRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCURSTV9F
UlJPUigiTENQTEwgbm90IHVzaW5nIG5vbi1TU0MgcmVmZXJlbmNlXG4iKTsKPiA+ICAgfQo+ID4g
LXN0YXRpYyB2b2lkIGFzc2VydF9jYW5fZGlzYWJsZV9sY3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgYXNzZXJ0X2Nhbl9kaXNhYmxlX2xjcGxs
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiA+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9ICZpOTE1LT5kcm07Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiA+ICAgCWZv
cl9lYWNoX2ludGVsX2NydGMoZGV2LCBjcnRjKQo+ID4gQEAgLTM2OTEsNyArMzY5MSw3IEBAIHN0
YXRpYyB2b2lkIGFzc2VydF9jYW5fZGlzYWJsZV9sY3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiAgIAkJCSJQYW5lbCBwb3dlciBvblxuIik7Cj4gPiAgIAlJOTE1X1NU
QVRFX1dBUk4oSTkxNV9SRUFEKEJMQ19QV01fQ1BVX0NUTDIpICYgQkxNX1BXTV9FTkFCTEUsCj4g
PiAgIAkJCSJDUFUgUFdNMSBlbmFibGVkXG4iKTsKPiA+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3By
aXYpKQo+ID4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSkKPiA+ICAgCQlJOTE1X1NUQVRFX1dBUk4o
STkxNV9SRUFEKEhTV19CTENfUFdNMl9DVEwpICYgQkxNX1BXTV9FTkFCTEUsCj4gPiAgIAkJCQki
Q1BVIFBXTTIgZW5hYmxlZFxuIik7Cj4gPiAgIAlJOTE1X1NUQVRFX1dBUk4oSTkxNV9SRUFEKEJM
Q19QV01fUENIX0NUTDEpICYgQkxNX1BDSF9QV01fRU5BQkxFLAo+ID4gQEAgLTM3MDcsMjEgKzM3
MDcsMjEgQEAgc3RhdGljIHZvaWQgYXNzZXJ0X2Nhbl9kaXNhYmxlX2xjcGxsKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIGdlbi1zcGVjaWZpYyBhbmQgc2luY2Ug
d2Ugb25seSBkaXNhYmxlIExDUExMIGFmdGVyIHdlIGZ1bGx5IGRpc2FibGUKPiA+ICAgCSAqIHRo
ZSBpbnRlcnJ1cHRzLCB0aGUgY2hlY2sgYmVsb3cgc2hvdWxkIGJlIGVub3VnaC4KPiA+ICAgCSAq
Lwo+ID4gLQlJOTE1X1NUQVRFX1dBUk4oaW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSwgIklS
UXMgZW5hYmxlZFxuIik7Cj4gPiArCUk5MTVfU1RBVEVfV0FSTihpbnRlbF9pcnFzX2VuYWJsZWQo
aTkxNSksICJJUlFzIGVuYWJsZWRcbiIpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHUzMiBoc3dfcmVh
ZF9kY29tcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHUz
MiBoc3dfcmVhZF9kY29tcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+
ID4gLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikpCj4gPiArCWlmIChJU19IQVNXRUxMKGk5MTUp
KQo+ID4gICAJCXJldHVybiBJOTE1X1JFQUQoRF9DT01QX0hTVyk7Cj4gPiAgIAllbHNlCj4gPiAg
IAkJcmV0dXJuIEk5MTVfUkVBRChEX0NPTVBfQkRXKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lk
IGhzd193cml0ZV9kY29tcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiB2
YWwpCj4gPiArc3RhdGljIHZvaWQgaHN3X3dyaXRlX2Rjb21wKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCB1MzIgdmFsKQo+ID4gICB7Cj4gPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2
KSkgewo+ID4gLQkJaWYgKHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGRldl9wcml2LAo+ID4gKwlp
ZiAoSVNfSEFTV0VMTChpOTE1KSkgewo+ID4gKwkJaWYgKHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRl
KGk5MTUsCj4gPiAgIAkJCQkJICAgIEdFTjZfUENPREVfV1JJVEVfRF9DT01QLCB2YWwpKQo+ID4g
ICAJCQlEUk1fREVCVUdfS01TKCJGYWlsZWQgdG8gd3JpdGUgdG8gRF9DT01QXG4iKTsKPiA+ICAg
CX0gZWxzZSB7Cj4gPiBAQCAtMzczOCwxMiArMzczOCwxMiBAQCBzdGF0aWMgdm9pZCBoc3dfd3Jp
dGVfZGNvbXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgdmFsKQo+ID4g
ICAgKiByZWdpc3Rlci4gQ2FsbGVycyBzaG91bGQgdGFrZSBjYXJlIG9mIGRpc2FibGluZyBhbGwg
dGhlIGRpc3BsYXkgZW5naW5lCj4gPiAgICAqIGZ1bmN0aW9ucywgZG9pbmcgdGhlIG1vZGUgdW5z
ZXQsIGZpeGluZyBpbnRlcnJ1cHRzLCBldGMuCj4gPiAgICAqLwo+ID4gLXN0YXRpYyB2b2lkIGhz
d19kaXNhYmxlX2xjcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtz
dGF0aWMgdm9pZCBoc3dfZGlzYWJsZV9sY3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICAgCQkJICAgICAgYm9vbCBzd2l0Y2hfdG9fZmNsaywgYm9vbCBhbGxvd19wb3dlcl9k
b3duKQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQlhc3NlcnRfY2FuX2Rpc2FibGVfbGNw
bGwoZGV2X3ByaXYpOwo+ID4gKwlhc3NlcnRfY2FuX2Rpc2FibGVfbGNwbGwoaTkxNSk7Cj4gPiAg
IAl2YWwgPSBJOTE1X1JFQUQoTENQTExfQ1RMKTsKPiA+IEBAIC0zNzYyLDE2ICszNzYyLDE2IEBA
IHN0YXRpYyB2b2lkIGhzd19kaXNhYmxlX2xjcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCUk5MTVfV1JJVEUoTENQTExfQ1RMLCB2YWwpOwo+ID4gICAJUE9TVElO
R19SRUFEKExDUExMX0NUTCk7Cj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2
X3ByaXYtPnVuY29yZSwgTENQTExfQ1RMLAo+ID4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0
ZXIoJmk5MTUtPnVuY29yZSwgTENQTExfQ1RMLAo+ID4gICAJCQkJICAgIExDUExMX1BMTF9MT0NL
LCAwLCAxKSkKPiA+ICAgCQlEUk1fRVJST1IoIkxDUExMIHN0aWxsIGxvY2tlZFxuIik7Cj4gPiAt
CXZhbCA9IGhzd19yZWFkX2Rjb21wKGRldl9wcml2KTsKPiA+ICsJdmFsID0gaHN3X3JlYWRfZGNv
bXAoaTkxNSk7Cj4gPiAgIAl2YWwgfD0gRF9DT01QX0NPTVBfRElTQUJMRTsKPiA+IC0JaHN3X3dy
aXRlX2Rjb21wKGRldl9wcml2LCB2YWwpOwo+ID4gKwloc3dfd3JpdGVfZGNvbXAoaTkxNSwgdmFs
KTsKPiA+ICAgCW5kZWxheSgxMDApOwo+ID4gLQlpZiAod2FpdF9mb3IoKGhzd19yZWFkX2Rjb21w
KGRldl9wcml2KSAmCj4gPiArCWlmICh3YWl0X2ZvcigoaHN3X3JlYWRfZGNvbXAoaTkxNSkgJgo+
ID4gICAJCSAgICAgIERfQ09NUF9SQ09NUF9JTl9QUk9HUkVTUykgPT0gMCwgMSkpCj4gPiAgIAkJ
RFJNX0VSUk9SKCJEX0NPTVAgUkNPTVAgc3RpbGwgaW4gcHJvZ3Jlc3NcbiIpOwo+ID4gQEAgLTM3
ODcsNyArMzc4Nyw3IEBAIHN0YXRpYyB2b2lkIGhzd19kaXNhYmxlX2xjcGxsKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgICogRnVsbHkgcmVzdG9yZXMgTENQTEwsIGRp
c2FsbG93aW5nIHBvd2VyIGRvd24gYW5kIHN3aXRjaGluZyBiYWNrIHRvIExDUExMCj4gPiAgICAq
IHNvdXJjZS4KPiA+ICAgICovCj4gPiAtc3RhdGljIHZvaWQgaHN3X3Jlc3RvcmVfbGNwbGwoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGhzd19yZXN0
b3JlX2xjcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1
MzIgdmFsOwo+ID4gQEAgLTM4MDEsNyArMzgwMSw3IEBAIHN0YXRpYyB2b2lkIGhzd19yZXN0b3Jl
X2xjcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIE1ha2Ug
c3VyZSB3ZSdyZSBub3Qgb24gUEM4IHN0YXRlIGJlZm9yZSBkaXNhYmxpbmcgUEM4LCBvdGhlcndp
c2UKPiA+ICAgCSAqIHdlJ2xsIGhhbmcgdGhlIG1hY2hpbmUuIFRvIHByZXZlbnQgUEM4IHN0YXRl
LCBqdXN0IGVuYWJsZSBmb3JjZV93YWtlLgo+ID4gICAJICovCj4gPiAtCWludGVsX3VuY29yZV9m
b3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICsJaW50
ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4g
PiAgIAlpZiAodmFsICYgTENQTExfUE9XRVJfRE9XTl9BTExPVykgewo+ID4gICAJCXZhbCAmPSB+
TENQTExfUE9XRVJfRE9XTl9BTExPVzsKPiA+IEBAIC0zODA5LDE2ICszODA5LDE2IEBAIHN0YXRp
YyB2b2lkIGhzd19yZXN0b3JlX2xjcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICAgCQlQT1NUSU5HX1JFQUQoTENQTExfQ1RMKTsKPiA+ICAgCX0KPiA+IC0JdmFsID0g
aHN3X3JlYWRfZGNvbXAoZGV2X3ByaXYpOwo+ID4gKwl2YWwgPSBoc3dfcmVhZF9kY29tcChpOTE1
KTsKPiA+ICAgCXZhbCB8PSBEX0NPTVBfQ09NUF9GT1JDRTsKPiA+ICAgCXZhbCAmPSB+RF9DT01Q
X0NPTVBfRElTQUJMRTsKPiA+IC0JaHN3X3dyaXRlX2Rjb21wKGRldl9wcml2LCB2YWwpOwo+ID4g
Kwloc3dfd3JpdGVfZGNvbXAoaTkxNSwgdmFsKTsKPiA+ICAgCXZhbCA9IEk5MTVfUkVBRChMQ1BM
TF9DVEwpOwo+ID4gICAJdmFsICY9IH5MQ1BMTF9QTExfRElTQUJMRTsKPiA+ICAgCUk5MTVfV1JJ
VEUoTENQTExfQ1RMLCB2YWwpOwo+ID4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRl
dl9wcml2LT51bmNvcmUsIExDUExMX0NUTCwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lz
dGVyKCZpOTE1LT51bmNvcmUsIExDUExMX0NUTCwKPiA+ICAgCQkJCSAgICBMQ1BMTF9QTExfTE9D
SywgTENQTExfUExMX0xPQ0ssIDUpKQo+ID4gICAJCURSTV9FUlJPUigiTENQTEwgbm90IGxvY2tl
ZCB5ZXRcbiIpOwo+ID4gQEAgLTM4MzIsMTAgKzM4MzIsMTAgQEAgc3RhdGljIHZvaWQgaHN3X3Jl
c3RvcmVfbGNwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCQlE
Uk1fRVJST1IoIlN3aXRjaGluZyBiYWNrIHRvIExDUExMIGZhaWxlZFxuIik7Cj4gPiAgIAl9Cj4g
PiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdB
S0VfQUxMKTsKPiA+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwg
Rk9SQ0VXQUtFX0FMTCk7Cj4gPiAtCWludGVsX3VwZGF0ZV9jZGNsayhkZXZfcHJpdik7Cj4gPiAt
CWludGVsX2R1bXBfY2RjbGtfc3RhdGUoJmRldl9wcml2LT5jZGNsay5odywgIkN1cnJlbnQgQ0RD
TEsiKTsKPiA+ICsJaW50ZWxfdXBkYXRlX2NkY2xrKGk5MTUpOwo+ID4gKwlpbnRlbF9kdW1wX2Nk
Y2xrX3N0YXRlKCZpOTE1LT5jZGNsay5odywgIkN1cnJlbnQgQ0RDTEsiKTsKPiA+ICAgfQo+ID4g
ICAvKgo+ID4gQEAgLTM4NjEsNDUgKzM4NjEsNDUgQEAgc3RhdGljIHZvaWQgaHN3X3Jlc3RvcmVf
bGNwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAgKiBGb3IgbW9y
ZSwgcmVhZCAiRGlzcGxheSBTZXF1ZW5jZXMgZm9yIFBhY2thZ2UgQzgiIG9uIHRoZSBoYXJkd2Fy
ZQo+ID4gICAgKiBkb2N1bWVudGF0aW9uLgo+ID4gICAgKi8KPiA+IC12b2lkIGhzd19lbmFibGVf
cGM4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGhzd19lbmFi
bGVfcGM4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIg
dmFsOwo+ID4gICAJRFJNX0RFQlVHX0tNUygiRW5hYmxpbmcgcGFja2FnZSBDOCtcbiIpOwo+ID4g
LQlpZiAoSEFTX1BDSF9MUFRfTFAoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChIQVNfUENIX0xQVF9M
UChpOTE1KSkgewo+ID4gICAJCXZhbCA9IEk5MTVfUkVBRChTT1VUSF9EU1BDTEtfR0FURV9EKTsK
PiA+ICAgCQl2YWwgJj0gflBDSF9MUF9QQVJUSVRJT05fTEVWRUxfRElTQUJMRTsKPiA+ICAgCQlJ
OTE1X1dSSVRFKFNPVVRIX0RTUENMS19HQVRFX0QsIHZhbCk7Cj4gPiAgIAl9Cj4gPiAtCWxwdF9k
aXNhYmxlX2Nsa291dF9kcChkZXZfcHJpdik7Cj4gPiAtCWhzd19kaXNhYmxlX2xjcGxsKGRldl9w
cml2LCB0cnVlLCB0cnVlKTsKPiA+ICsJbHB0X2Rpc2FibGVfY2xrb3V0X2RwKGk5MTUpOwo+ID4g
Kwloc3dfZGlzYWJsZV9sY3BsbChpOTE1LCB0cnVlLCB0cnVlKTsKPiA+ICAgfQo+ID4gLXZvaWQg
aHN3X2Rpc2FibGVfcGM4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2
b2lkIGhzd19kaXNhYmxlX3BjOChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAg
ewo+ID4gICAJdTMyIHZhbDsKPiA+ICAgCURSTV9ERUJVR19LTVMoIkRpc2FibGluZyBwYWNrYWdl
IEM4K1xuIik7Cj4gPiAtCWhzd19yZXN0b3JlX2xjcGxsKGRldl9wcml2KTsKPiA+IC0JaW50ZWxf
aW5pdF9wY2hfcmVmY2xrKGRldl9wcml2KTsKPiA+ICsJaHN3X3Jlc3RvcmVfbGNwbGwoaTkxNSk7
Cj4gPiArCWludGVsX2luaXRfcGNoX3JlZmNsayhpOTE1KTsKPiA+IC0JaWYgKEhBU19QQ0hfTFBU
X0xQKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX1BDSF9MUFRfTFAoaTkxNSkpIHsKPiA+ICAg
CQl2YWwgPSBJOTE1X1JFQUQoU09VVEhfRFNQQ0xLX0dBVEVfRCk7Cj4gPiAgIAkJdmFsIHw9IFBD
SF9MUF9QQVJUSVRJT05fTEVWRUxfRElTQUJMRTsKPiA+ICAgCQlJOTE1X1dSSVRFKFNPVVRIX0RT
UENMS19HQVRFX0QsIHZhbCk7Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRl
bF9wY2hfcmVzZXRfaGFuZHNoYWtlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9wY2hfcmVzZXRfaGFuZHNoYWtlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgYm9vbCBlbmFibGUpCj4gPiAgIHsKPiA+
ICAgCWk5MTVfcmVnX3QgcmVnOwo+ID4gICAJdTMyIHJlc2V0X2JpdHMsIHZhbDsKPiA+IC0JaWYg
KElTX0lWWUJSSURHRShkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0lWWUJSSURHRShpOTE1KSkg
ewo+ID4gICAJCXJlZyA9IEdFTjdfTVNHX0NUTDsKPiA+ICAgCQlyZXNldF9iaXRzID0gV0FJVF9G
T1JfUENIX0ZMUl9BQ0sgfCBXQUlUX0ZPUl9QQ0hfUkVTRVRfQUNLOwo+ID4gICAJfSBlbHNlIHsK
PiA+IEBAIC0zOTE3LDQ2ICszOTE3LDQ2IEBAIHN0YXRpYyB2b2lkIGludGVsX3BjaF9yZXNldF9o
YW5kc2hha2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJSTkxNV9X
UklURShyZWcsIHZhbCk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBza2xfZGlzcGxheV9jb3Jl
X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lk
IHNrbF9kaXNwbGF5X2NvcmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+
ICAgCQkJCSAgYm9vbCByZXN1bWUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGk5MTVfcG93ZXJfZG9t
YWlucyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKPiA+ICsJc3Ry
dWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21h
aW5zOwo+ID4gICAJc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqd2VsbDsKPiA+IC0JZ2VuOV9zZXRf
ZGNfc3RhdGUoZGV2X3ByaXYsIERDX1NUQVRFX0RJU0FCTEUpOwo+ID4gKwlnZW45X3NldF9kY19z
dGF0ZShpOTE1LCBEQ19TVEFURV9ESVNBQkxFKTsKPiA+ICAgCS8qIGVuYWJsZSBQQ0ggcmVzZXQg
aGFuZHNoYWtlICovCj4gPiAtCWludGVsX3BjaF9yZXNldF9oYW5kc2hha2UoZGV2X3ByaXYsICFI
QVNfUENIX05PUChkZXZfcHJpdikpOwo+ID4gKwlpbnRlbF9wY2hfcmVzZXRfaGFuZHNoYWtlKGk5
MTUsICFIQVNfUENIX05PUChpOTE1KSk7Cj4gPiAgIAkvKiBlbmFibGUgUEcxIGFuZCBNaXNjIEkv
TyAqLwo+ID4gICAJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Cj4gPiAtCXdlbGwg
PSBsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgU0tMX0RJU1BfUFdfMSk7Cj4gPiAtCWludGVs
X3Bvd2VyX3dlbGxfZW5hYmxlKGRldl9wcml2LCB3ZWxsKTsKPiA+ICsJd2VsbCA9IGxvb2t1cF9w
b3dlcl93ZWxsKGk5MTUsIFNLTF9ESVNQX1BXXzEpOwo+ID4gKwlpbnRlbF9wb3dlcl93ZWxsX2Vu
YWJsZShpOTE1LCB3ZWxsKTsKPiA+IC0Jd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2
LCBTS0xfRElTUF9QV19NSVNDX0lPKTsKPiA+IC0JaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoZGV2
X3ByaXYsIHdlbGwpOwo+ID4gKwl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoaTkxNSwgU0tMX0RJ
U1BfUFdfTUlTQ19JTyk7Cj4gPiArCWludGVsX3Bvd2VyX3dlbGxfZW5hYmxlKGk5MTUsIHdlbGwp
Owo+ID4gICAJbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiA+IC0JaW50ZWxf
Y2RjbGtfaW5pdChkZXZfcHJpdik7Cj4gPiArCWludGVsX2NkY2xrX2luaXQoaTkxNSk7Cj4gPiAt
CWdlbjlfZGJ1Zl9lbmFibGUoZGV2X3ByaXYpOwo+ID4gKwlnZW45X2RidWZfZW5hYmxlKGk5MTUp
Owo+ID4gLQlpZiAocmVzdW1lICYmIGRldl9wcml2LT5jc3IuZG1jX3BheWxvYWQpCj4gPiAtCQlp
bnRlbF9jc3JfbG9hZF9wcm9ncmFtKGRldl9wcml2KTsKPiA+ICsJaWYgKHJlc3VtZSAmJiBpOTE1
LT5jc3IuZG1jX3BheWxvYWQpCj4gPiArCQlpbnRlbF9jc3JfbG9hZF9wcm9ncmFtKGk5MTUpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgc2tsX2Rpc3BsYXlfY29yZV91bmluaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIHNrbF9kaXNwbGF5X2Nv
cmVfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2Vy
X2RvbWFpbnM7Cj4gPiArCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMg
PSAmaTkxNS0+cG93ZXJfZG9tYWluczsKPiA+ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKndl
bGw7Cj4gPiAtCWdlbjlfc2V0X2RjX3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9ESVNBQkxFKTsK
PiA+ICsJZ2VuOV9zZXRfZGNfc3RhdGUoaTkxNSwgRENfU1RBVEVfRElTQUJMRSk7Cj4gPiAtCWdl
bjlfZGJ1Zl9kaXNhYmxlKGRldl9wcml2KTsKPiA+ICsJZ2VuOV9kYnVmX2Rpc2FibGUoaTkxNSk7
Cj4gPiAtCWludGVsX2NkY2xrX3VuaW5pdChkZXZfcHJpdik7Cj4gPiArCWludGVsX2NkY2xrX3Vu
aW5pdChpOTE1KTsKPiA+ICAgCS8qIFRoZSBzcGVjIGRvZXNuJ3QgY2FsbCBmb3IgcmVtb3Zpbmcg
dGhlIHJlc2V0IGhhbmRzaGFrZSBmbGFnICovCj4gPiAgIAkvKiBkaXNhYmxlIFBHMSBhbmQgTWlz
YyBJL08gKi8KPiA+IEBAIC0zOTY5LDIxICszOTY5LDIxIEBAIHN0YXRpYyB2b2lkIHNrbF9kaXNw
bGF5X2NvcmVfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAg
CSAqIE5vdGUgdGhhdCBldmVuIHRob3VnaCB0aGUgZHJpdmVyJ3MgcmVxdWVzdCBpcyByZW1vdmVk
IHBvd2VyIHdlbGwgMQo+ID4gICAJICogbWF5IHN0YXkgZW5hYmxlZCBhZnRlciB0aGlzIGR1ZSB0
byBETUMncyBvd24gcmVxdWVzdCBvbiBpdC4KPiA+ICAgCSAqLwo+ID4gLQl3ZWxsID0gbG9va3Vw
X3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFNLTF9ESVNQX1BXXzEpOwo+ID4gLQlpbnRlbF9wb3dlcl93
ZWxsX2Rpc2FibGUoZGV2X3ByaXYsIHdlbGwpOwo+ID4gKwl3ZWxsID0gbG9va3VwX3Bvd2VyX3dl
bGwoaTkxNSwgU0tMX0RJU1BfUFdfMSk7Cj4gPiArCWludGVsX3Bvd2VyX3dlbGxfZGlzYWJsZShp
OTE1LCB3ZWxsKTsKPiA+ICAgCW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Cj4g
PiAgIAl1c2xlZXBfcmFuZ2UoMTAsIDMwKTsJCS8qIDEwIHVzIGRlbGF5IHBlciBCc3BlYyAqLwo+
ID4gICB9Cj4gPiAtdm9pZCBieHRfZGlzcGxheV9jb3JlX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgYnh0X2Rpc3BsYXlfY29yZV9pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICBib29sIHJlc3VtZSkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2
LT5wb3dlcl9kb21haW5zOwo+ID4gKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9k
b21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9wb3dlcl93
ZWxsICp3ZWxsOwo+ID4gLQlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVfRElT
QUJMRSk7Cj4gPiArCWdlbjlfc2V0X2RjX3N0YXRlKGk5MTUsIERDX1NUQVRFX0RJU0FCTEUpOwo+
ID4gICAJLyoKPiA+ICAgCSAqIE5ERV9SU1RXUk5fT1BUIFJTVCBQQ0ggSGFuZHNoYWtlIEVuIG11
c3QgYWx3YXlzIGJlIDBiIG9uIEJYVAo+ID4gQEAgLTM5OTEsMzQgKzM5OTEsMzQgQEAgdm9pZCBi
eHRfZGlzcGxheV9jb3JlX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gICAJICogTW92ZSB0aGUgaGFuZHNoYWtlIHByb2dyYW1taW5nIHRvIGluaXRpYWxpemF0aW9u
IHNlcXVlbmNlLgo+ID4gICAJICogUHJldmlvdXNseSB3YXMgbGVmdCB1cCB0byBCSU9TLgo+ID4g
ICAJICovCj4gPiAtCWludGVsX3BjaF9yZXNldF9oYW5kc2hha2UoZGV2X3ByaXYsIGZhbHNlKTsK
PiA+ICsJaW50ZWxfcGNoX3Jlc2V0X2hhbmRzaGFrZShpOTE1LCBmYWxzZSk7Cj4gPiAgIAkvKiBF
bmFibGUgUEcxICovCj4gPiAgIAltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiA+
IC0Jd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBTS0xfRElTUF9QV18xKTsKPiA+
IC0JaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHdlbGwpOwo+ID4gKwl3ZWxsID0g
bG9va3VwX3Bvd2VyX3dlbGwoaTkxNSwgU0tMX0RJU1BfUFdfMSk7Cj4gPiArCWludGVsX3Bvd2Vy
X3dlbGxfZW5hYmxlKGk5MTUsIHdlbGwpOwo+ID4gICAJbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21h
aW5zLT5sb2NrKTsKPiA+IC0JaW50ZWxfY2RjbGtfaW5pdChkZXZfcHJpdik7Cj4gPiArCWludGVs
X2NkY2xrX2luaXQoaTkxNSk7Cj4gPiAtCWdlbjlfZGJ1Zl9lbmFibGUoZGV2X3ByaXYpOwo+ID4g
KwlnZW45X2RidWZfZW5hYmxlKGk5MTUpOwo+ID4gLQlpZiAocmVzdW1lICYmIGRldl9wcml2LT5j
c3IuZG1jX3BheWxvYWQpCj4gPiAtCQlpbnRlbF9jc3JfbG9hZF9wcm9ncmFtKGRldl9wcml2KTsK
PiA+ICsJaWYgKHJlc3VtZSAmJiBpOTE1LT5jc3IuZG1jX3BheWxvYWQpCj4gPiArCQlpbnRlbF9j
c3JfbG9hZF9wcm9ncmFtKGk5MTUpOwo+ID4gICB9Cj4gPiAtdm9pZCBieHRfZGlzcGxheV9jb3Jl
X3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBieHRf
ZGlzcGxheV9jb3JlX3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9w
cml2LT5wb3dlcl9kb21haW5zOwo+ID4gKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dl
cl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9wb3dl
cl93ZWxsICp3ZWxsOwo+ID4gLQlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVf
RElTQUJMRSk7Cj4gPiArCWdlbjlfc2V0X2RjX3N0YXRlKGk5MTUsIERDX1NUQVRFX0RJU0FCTEUp
Owo+ID4gLQlnZW45X2RidWZfZGlzYWJsZShkZXZfcHJpdik7Cj4gPiArCWdlbjlfZGJ1Zl9kaXNh
YmxlKGk5MTUpOwo+ID4gLQlpbnRlbF9jZGNsa191bmluaXQoZGV2X3ByaXYpOwo+ID4gKwlpbnRl
bF9jZGNsa191bmluaXQoaTkxNSk7Cj4gPiAgIAkvKiBUaGUgc3BlYyBkb2Vzbid0IGNhbGwgZm9y
IHJlbW92aW5nIHRoZSByZXNldCBoYW5kc2hha2UgZmxhZyAqLwo+ID4gQEAgLTQwMjksNjAgKzQw
MjksNjAgQEAgdm9pZCBieHRfZGlzcGxheV9jb3JlX3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKi8KPiA+ICAgCW11dGV4X2xvY2soJnBvd2VyX2RvbWFp
bnMtPmxvY2spOwo+ID4gLQl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFNLTF9E
SVNQX1BXXzEpOwo+ID4gLQlpbnRlbF9wb3dlcl93ZWxsX2Rpc2FibGUoZGV2X3ByaXYsIHdlbGwp
Owo+ID4gKwl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoaTkxNSwgU0tMX0RJU1BfUFdfMSk7Cj4g
PiArCWludGVsX3Bvd2VyX3dlbGxfZGlzYWJsZShpOTE1LCB3ZWxsKTsKPiA+ICAgCW11dGV4X3Vu
bG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Cj4gPiAgIAl1c2xlZXBfcmFuZ2UoMTAsIDMwKTsJ
CS8qIDEwIHVzIGRlbGF5IHBlciBCc3BlYyAqLwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgY25s
X2Rpc3BsYXlfY29yZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9v
bCByZXN1bWUpCj4gPiArc3RhdGljIHZvaWQgY25sX2Rpc3BsYXlfY29yZV9pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCBib29sIHJlc3VtZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
aTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21h
aW5zOwo+ID4gKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5
MTUtPnBvd2VyX2RvbWFpbnM7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICp3ZWxsOwo+
ID4gLQlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVfRElTQUJMRSk7Cj4gPiAr
CWdlbjlfc2V0X2RjX3N0YXRlKGk5MTUsIERDX1NUQVRFX0RJU0FCTEUpOwo+ID4gICAJLyogMS4g
RW5hYmxlIFBDSCBSZXNldCBIYW5kc2hha2UgKi8KPiA+IC0JaW50ZWxfcGNoX3Jlc2V0X2hhbmRz
aGFrZShkZXZfcHJpdiwgIUhBU19QQ0hfTk9QKGRldl9wcml2KSk7Cj4gPiArCWludGVsX3BjaF9y
ZXNldF9oYW5kc2hha2UoaTkxNSwgIUhBU19QQ0hfTk9QKGk5MTUpKTsKPiA+ICAgCS8qIDItMy4g
Ki8KPiA+IC0JaW50ZWxfY29tYm9fcGh5X2luaXQoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9jb21i
b19waHlfaW5pdChpOTE1KTsKPiA+ICAgCS8qCj4gPiAgIAkgKiA0LiBFbmFibGUgUG93ZXIgV2Vs
bCAxIChQRzEpLgo+ID4gICAJICogICAgVGhlIEFVWCBJTyBwb3dlciB3ZWxscyB3aWxsIGJlIGVu
YWJsZWQgb24gZGVtYW5kLgo+ID4gICAJICovCj4gPiAgIAltdXRleF9sb2NrKCZwb3dlcl9kb21h
aW5zLT5sb2NrKTsKPiA+IC0Jd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBTS0xf
RElTUF9QV18xKTsKPiA+IC0JaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHdlbGwp
Owo+ID4gKwl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoaTkxNSwgU0tMX0RJU1BfUFdfMSk7Cj4g
PiArCWludGVsX3Bvd2VyX3dlbGxfZW5hYmxlKGk5MTUsIHdlbGwpOwo+ID4gICAJbXV0ZXhfdW5s
b2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiA+ICAgCS8qIDUuIEVuYWJsZSBDRCBjbG9jayAq
Lwo+ID4gLQlpbnRlbF9jZGNsa19pbml0KGRldl9wcml2KTsKPiA+ICsJaW50ZWxfY2RjbGtfaW5p
dChpOTE1KTsKPiA+ICAgCS8qIDYuIEVuYWJsZSBEQlVGICovCj4gPiAtCWdlbjlfZGJ1Zl9lbmFi
bGUoZGV2X3ByaXYpOwo+ID4gKwlnZW45X2RidWZfZW5hYmxlKGk5MTUpOwo+ID4gLQlpZiAocmVz
dW1lICYmIGRldl9wcml2LT5jc3IuZG1jX3BheWxvYWQpCj4gPiAtCQlpbnRlbF9jc3JfbG9hZF9w
cm9ncmFtKGRldl9wcml2KTsKPiA+ICsJaWYgKHJlc3VtZSAmJiBpOTE1LT5jc3IuZG1jX3BheWxv
YWQpCj4gPiArCQlpbnRlbF9jc3JfbG9hZF9wcm9ncmFtKGk5MTUpOwo+ID4gICB9Cj4gPiAtc3Rh
dGljIHZvaWQgY25sX2Rpc3BsYXlfY29yZV91bmluaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGNubF9kaXNwbGF5X2NvcmVfdW5pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpOTE1X3Bvd2Vy
X2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Cj4gPiAr
CXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93ZXJf
ZG9tYWluczsKPiA+ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKndlbGw7Cj4gPiAtCWdlbjlf
c2V0X2RjX3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9ESVNBQkxFKTsKPiA+ICsJZ2VuOV9zZXRf
ZGNfc3RhdGUoaTkxNSwgRENfU1RBVEVfRElTQUJMRSk7Cj4gPiAgIAkvKiAxLiBEaXNhYmxlIGFs
bCBkaXNwbGF5IGVuZ2luZSBmdW5jdGlvbnMgLT4gYXJlYWR5IGRvbmUgKi8KPiA+ICAgCS8qIDIu
IERpc2FibGUgREJVRiAqLwo+ID4gLQlnZW45X2RidWZfZGlzYWJsZShkZXZfcHJpdik7Cj4gPiAr
CWdlbjlfZGJ1Zl9kaXNhYmxlKGk5MTUpOwo+ID4gICAJLyogMy4gRGlzYWJsZSBDRCBjbG9jayAq
Lwo+ID4gLQlpbnRlbF9jZGNsa191bmluaXQoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9jZGNsa191
bmluaXQoaTkxNSk7Cj4gPiAgIAkvKgo+ID4gICAJICogNC4gRGlzYWJsZSBQb3dlciBXZWxsIDEg
KFBHMSkuCj4gPiBAQCAtNDA5MCw2NiArNDA5MCw2NiBAQCBzdGF0aWMgdm9pZCBjbmxfZGlzcGxh
eV9jb3JlX3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkg
KiAgICBkaXNhYmxlZCBhdCB0aGlzIHBvaW50Lgo+ID4gICAJICovCj4gPiAgIAltdXRleF9sb2Nr
KCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiA+IC0Jd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRl
dl9wcml2LCBTS0xfRElTUF9QV18xKTsKPiA+IC0JaW50ZWxfcG93ZXJfd2VsbF9kaXNhYmxlKGRl
dl9wcml2LCB3ZWxsKTsKPiA+ICsJd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGk5MTUsIFNLTF9E
SVNQX1BXXzEpOwo+ID4gKwlpbnRlbF9wb3dlcl93ZWxsX2Rpc2FibGUoaTkxNSwgd2VsbCk7Cj4g
PiAgIAltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+ID4gICAJdXNsZWVwX3Jh
bmdlKDEwLCAzMCk7CQkvKiAxMCB1cyBkZWxheSBwZXIgQnNwZWMgKi8KPiA+ICAgCS8qIDUuICov
Cj4gPiAtCWludGVsX2NvbWJvX3BoeV91bmluaXQoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9jb21i
b19waHlfdW5pbml0KGk5MTUpOwo+ID4gICB9Cj4gPiAtdm9pZCBpY2xfZGlzcGxheV9jb3JlX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgaWNsX2Rpc3Bs
YXlfY29yZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICBi
b29sIHJlc3VtZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dl
cl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwo+ID4gKwlzdHJ1Y3QgaTkxNV9w
b3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gPiAg
IAlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICp3ZWxsOwo+ID4gLQlnZW45X3NldF9kY19zdGF0ZShk
ZXZfcHJpdiwgRENfU1RBVEVfRElTQUJMRSk7Cj4gPiArCWdlbjlfc2V0X2RjX3N0YXRlKGk5MTUs
IERDX1NUQVRFX0RJU0FCTEUpOwo+ID4gICAJLyogMS4gRW5hYmxlIFBDSCByZXNldCBoYW5kc2hh
a2UuICovCj4gPiAtCWludGVsX3BjaF9yZXNldF9oYW5kc2hha2UoZGV2X3ByaXYsICFIQVNfUENI
X05PUChkZXZfcHJpdikpOwo+ID4gKwlpbnRlbF9wY2hfcmVzZXRfaGFuZHNoYWtlKGk5MTUsICFI
QVNfUENIX05PUChpOTE1KSk7Cj4gPiAgIAkvKiAyLiBJbml0aWFsaXplIGFsbCBjb21ibyBwaHlz
ICovCj4gPiAtCWludGVsX2NvbWJvX3BoeV9pbml0KGRldl9wcml2KTsKPiA+ICsJaW50ZWxfY29t
Ym9fcGh5X2luaXQoaTkxNSk7Cj4gPiAgIAkvKgo+ID4gICAJICogMy4gRW5hYmxlIFBvd2VyIFdl
bGwgMSAoUEcxKS4KPiA+ICAgCSAqICAgIFRoZSBBVVggSU8gcG93ZXIgd2VsbHMgd2lsbCBiZSBl
bmFibGVkIG9uIGRlbWFuZC4KPiA+ICAgCSAqLwo+ID4gICAJbXV0ZXhfbG9jaygmcG93ZXJfZG9t
YWlucy0+bG9jayk7Cj4gPiAtCXdlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgU0tM
X0RJU1BfUFdfMSk7Cj4gPiAtCWludGVsX3Bvd2VyX3dlbGxfZW5hYmxlKGRldl9wcml2LCB3ZWxs
KTsKPiA+ICsJd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGk5MTUsIFNLTF9ESVNQX1BXXzEpOwo+
ID4gKwlpbnRlbF9wb3dlcl93ZWxsX2VuYWJsZShpOTE1LCB3ZWxsKTsKPiA+ICAgCW11dGV4X3Vu
bG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Cj4gPiAgIAkvKiA0LiBFbmFibGUgQ0RDTEsuICov
Cj4gPiAtCWludGVsX2NkY2xrX2luaXQoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9jZGNsa19pbml0
KGk5MTUpOwo+ID4gICAJLyogNS4gRW5hYmxlIERCVUYuICovCj4gPiAtCWljbF9kYnVmX2VuYWJs
ZShkZXZfcHJpdik7Cj4gPiArCWljbF9kYnVmX2VuYWJsZShpOTE1KTsKPiA+ICAgCS8qIDYuIFNl
dHVwIE1CVVMuICovCj4gPiAtCWljbF9tYnVzX2luaXQoZGV2X3ByaXYpOwo+ID4gKwlpY2xfbWJ1
c19pbml0KGk5MTUpOwo+ID4gLQlpZiAocmVzdW1lICYmIGRldl9wcml2LT5jc3IuZG1jX3BheWxv
YWQpCj4gPiAtCQlpbnRlbF9jc3JfbG9hZF9wcm9ncmFtKGRldl9wcml2KTsKPiA+ICsJaWYgKHJl
c3VtZSAmJiBpOTE1LT5jc3IuZG1jX3BheWxvYWQpCj4gPiArCQlpbnRlbF9jc3JfbG9hZF9wcm9n
cmFtKGk5MTUpOwo+ID4gICB9Cj4gPiAtdm9pZCBpY2xfZGlzcGxheV9jb3JlX3VuaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpY2xfZGlzcGxheV9jb3Jl
X3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9k
b21haW5zOwo+ID4gKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0g
Jmk5MTUtPnBvd2VyX2RvbWFpbnM7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICp3ZWxs
Owo+ID4gLQlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVfRElTQUJMRSk7Cj4g
PiArCWdlbjlfc2V0X2RjX3N0YXRlKGk5MTUsIERDX1NUQVRFX0RJU0FCTEUpOwo+ID4gICAJLyog
MS4gRGlzYWJsZSBhbGwgZGlzcGxheSBlbmdpbmUgZnVuY3Rpb25zIC0+IGFyZWFkeSBkb25lICov
Cj4gPiAgIAkvKiAyLiBEaXNhYmxlIERCVUYgKi8KPiA+IC0JaWNsX2RidWZfZGlzYWJsZShkZXZf
cHJpdik7Cj4gPiArCWljbF9kYnVmX2Rpc2FibGUoaTkxNSk7Cj4gPiAgIAkvKiAzLiBEaXNhYmxl
IENEIGNsb2NrICovCj4gPiAtCWludGVsX2NkY2xrX3VuaW5pdChkZXZfcHJpdik7Cj4gPiArCWlu
dGVsX2NkY2xrX3VuaW5pdChpOTE1KTsKPiA+ICAgCS8qCj4gPiAgIAkgKiA0LiBEaXNhYmxlIFBv
d2VyIFdlbGwgMSAoUEcxKS4KPiA+IEBAIC00MTU3LDIwICs0MTU3LDIwIEBAIHZvaWQgaWNsX2Rp
c3BsYXlfY29yZV91bmluaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
ICAJICogICAgZGlzYWJsZWQgYXQgdGhpcyBwb2ludC4KPiA+ICAgCSAqLwo+ID4gICAJbXV0ZXhf
bG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Cj4gPiAtCXdlbGwgPSBsb29rdXBfcG93ZXJfd2Vs
bChkZXZfcHJpdiwgU0tMX0RJU1BfUFdfMSk7Cj4gPiAtCWludGVsX3Bvd2VyX3dlbGxfZGlzYWJs
ZShkZXZfcHJpdiwgd2VsbCk7Cj4gPiArCXdlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChpOTE1LCBT
S0xfRElTUF9QV18xKTsKPiA+ICsJaW50ZWxfcG93ZXJfd2VsbF9kaXNhYmxlKGk5MTUsIHdlbGwp
Owo+ID4gICAJbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKPiA+ICAgCS8qIDUu
ICovCj4gPiAtCWludGVsX2NvbWJvX3BoeV91bmluaXQoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9j
b21ib19waHlfdW5pbml0KGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgY2h2X3BoeV9j
b250cm9sX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRp
YyB2b2lkIGNodl9waHlfY29udHJvbF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpjbW5fYmMgPQo+ID4gLQkJ
bG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFZMVl9ESVNQX1BXX0RQSU9fQ01OX0JDKTsKPiA+
ICsJCWxvb2t1cF9wb3dlcl93ZWxsKGk5MTUsIFZMVl9ESVNQX1BXX0RQSU9fQ01OX0JDKTsKPiA+
ICAgCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKmNtbl9kID0KPiA+IC0JCWxvb2t1cF9wb3dlcl93
ZWxsKGRldl9wcml2LCBDSFZfRElTUF9QV19EUElPX0NNTl9EKTsKPiA+ICsJCWxvb2t1cF9wb3dl
cl93ZWxsKGk5MTUsIENIVl9ESVNQX1BXX0RQSU9fQ01OX0QpOwo+ID4gICAJLyoKPiA+ICAgCSAq
IERJU1BMQVlfUEhZX0NPTlRST0wgY2FuIGdldCBjb3JydXB0ZWQgaWYgcmVhZC4gQXMgYQo+ID4g
QEAgLTQxNzksNyArNDE3OSw3IEBAIHN0YXRpYyB2b2lkIGNodl9waHlfY29udHJvbF9pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIHBvd2VyIHdlbGwgc3Rh
dGUgYW5kIGxhbmUgc3RhdHVzIHRvIHJlY29uc3RydWN0IHRoZQo+ID4gICAJICogZXhwZWN0ZWQg
aW5pdGlhbCB2YWx1ZS4KPiA+ICAgCSAqLwo+ID4gLQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9s
ID0KPiA+ICsJaTkxNS0+Y2h2X3BoeV9jb250cm9sID0KPiA+ICAgCQlQSFlfTERPX1NFUV9ERUxB
WShQSFlfTERPX0RFTEFZXzYwME5TLCBEUElPX1BIWTApIHwKPiA+ICAgCQlQSFlfTERPX1NFUV9E
RUxBWShQSFlfTERPX0RFTEFZXzYwME5TLCBEUElPX1BIWTEpIHwKPiA+ICAgCQlQSFlfQ0hfUE9X
RVJfTU9ERShQSFlfQ0hfREVFUF9QU1IsIERQSU9fUEhZMCwgRFBJT19DSDApIHwKPiA+IEBAIC00
MTkzLDcgKzQxOTMsNyBAQCBzdGF0aWMgdm9pZCBjaHZfcGh5X2NvbnRyb2xfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiBvdmVycmlkZSBhbmQgc2V0IHRo
ZSBsYW5lIHBvd2VyZG93biBiaXRzIGFjY2RpbmcgdG8gdGhlCj4gPiAgIAkgKiBjdXJyZW50IGxh
bmUgc3RhdHVzLgo+ID4gICAJICovCj4gPiAtCWlmIChjbW5fYmMtPmRlc2MtPm9wcy0+aXNfZW5h
YmxlZChkZXZfcHJpdiwgY21uX2JjKSkgewo+ID4gKwlpZiAoY21uX2JjLT5kZXNjLT5vcHMtPmlz
X2VuYWJsZWQoaTkxNSwgY21uX2JjKSkgewo+ID4gICAJCXUzMiBzdGF0dXMgPSBJOTE1X1JFQUQo
RFBMTChQSVBFX0EpKTsKPiA+ICAgCQl1bnNpZ25lZCBpbnQgbWFzazsKPiA+IEBAIC00MjAxLDMw
ICs0MjAxLDMwIEBAIHN0YXRpYyB2b2lkIGNodl9waHlfY29udHJvbF9pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQlpZiAobWFzayA9PSAweGYpCj4gPiAgIAkJ
CW1hc2sgPSAweDA7Cj4gPiAgIAkJZWxzZQo+ID4gLQkJCWRldl9wcml2LT5jaHZfcGh5X2NvbnRy
b2wgfD0KPiA+ICsJCQlpOTE1LT5jaHZfcGh5X2NvbnRyb2wgfD0KPiA+ICAgCQkJCVBIWV9DSF9Q
T1dFUl9ET1dOX09WUkRfRU4oRFBJT19QSFkwLCBEUElPX0NIMCk7Cj4gPiAtCQlkZXZfcHJpdi0+
Y2h2X3BoeV9jb250cm9sIHw9Cj4gPiArCQlpOTE1LT5jaHZfcGh5X2NvbnRyb2wgfD0KPiA+ICAg
CQkJUEhZX0NIX1BPV0VSX0RPV05fT1ZSRChtYXNrLCBEUElPX1BIWTAsIERQSU9fQ0gwKTsKPiA+
ICAgCQltYXNrID0gKHN0YXR1cyAmIERQTExfUE9SVENfUkVBRFlfTUFTSykgPj4gNDsKPiA+ICAg
CQlpZiAobWFzayA9PSAweGYpCj4gPiAgIAkJCW1hc2sgPSAweDA7Cj4gPiAgIAkJZWxzZQo+ID4g
LQkJCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgfD0KPiA+ICsJCQlpOTE1LT5jaHZfcGh5X2Nv
bnRyb2wgfD0KPiA+ICAgCQkJCVBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4oRFBJT19QSFkwLCBE
UElPX0NIMSk7Cj4gPiAtCQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9Cj4gPiArCQlpOTE1
LT5jaHZfcGh5X2NvbnRyb2wgfD0KPiA+ICAgCQkJUEhZX0NIX1BPV0VSX0RPV05fT1ZSRChtYXNr
LCBEUElPX1BIWTAsIERQSU9fQ0gxKTsKPiA+IC0JCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wg
fD0gUEhZX0NPTV9MQU5FX1JFU0VUX0RFQVNTRVJUKERQSU9fUEhZMCk7Cj4gPiArCQlpOTE1LT5j
aHZfcGh5X2NvbnRyb2wgfD0gUEhZX0NPTV9MQU5FX1JFU0VUX0RFQVNTRVJUKERQSU9fUEhZMCk7
Cj4gPiAtCQlkZXZfcHJpdi0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkwXSA9IGZhbHNlOwo+ID4g
KwkJaTkxNS0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkwXSA9IGZhbHNlOwo+ID4gICAJfSBlbHNl
IHsKPiA+IC0JCWRldl9wcml2LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTBdID0gdHJ1ZTsKPiA+
ICsJCWk5MTUtPmNodl9waHlfYXNzZXJ0W0RQSU9fUEhZMF0gPSB0cnVlOwo+ID4gICAJfQo+ID4g
LQlpZiAoY21uX2QtPmRlc2MtPm9wcy0+aXNfZW5hYmxlZChkZXZfcHJpdiwgY21uX2QpKSB7Cj4g
PiArCWlmIChjbW5fZC0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGk5MTUsIGNtbl9kKSkgewo+ID4g
ICAJCXUzMiBzdGF0dXMgPSBJOTE1X1JFQUQoRFBJT19QSFlfU1RBVFVTKTsKPiA+ICAgCQl1bnNp
Z25lZCBpbnQgbWFzazsKPiA+IEBAIC00MjMzLDQyICs0MjMzLDQyIEBAIHN0YXRpYyB2b2lkIGNo
dl9waHlfY29udHJvbF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCQlpZiAobWFzayA9PSAweGYpCj4gPiAgIAkJCW1hc2sgPSAweDA7Cj4gPiAgIAkJZWxzZQo+
ID4gLQkJCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgfD0KPiA+ICsJCQlpOTE1LT5jaHZfcGh5
X2NvbnRyb2wgfD0KPiA+ICAgCQkJCVBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4oRFBJT19QSFkx
LCBEUElPX0NIMCk7Cj4gPiAtCQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9Cj4gPiArCQlp
OTE1LT5jaHZfcGh5X2NvbnRyb2wgfD0KPiA+ICAgCQkJUEhZX0NIX1BPV0VSX0RPV05fT1ZSRCht
YXNrLCBEUElPX1BIWTEsIERQSU9fQ0gwKTsKPiA+IC0JCWRldl9wcml2LT5jaHZfcGh5X2NvbnRy
b2wgfD0gUEhZX0NPTV9MQU5FX1JFU0VUX0RFQVNTRVJUKERQSU9fUEhZMSk7Cj4gPiArCQlpOTE1
LT5jaHZfcGh5X2NvbnRyb2wgfD0gUEhZX0NPTV9MQU5FX1JFU0VUX0RFQVNTRVJUKERQSU9fUEhZ
MSk7Cj4gPiAtCQlkZXZfcHJpdi0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkxXSA9IGZhbHNlOwo+
ID4gKwkJaTkxNS0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkxXSA9IGZhbHNlOwo+ID4gICAJfSBl
bHNlIHsKPiA+IC0JCWRldl9wcml2LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTFdID0gdHJ1ZTsK
PiA+ICsJCWk5MTUtPmNodl9waHlfYXNzZXJ0W0RQSU9fUEhZMV0gPSB0cnVlOwo+ID4gICAJfQo+
ID4gLQlJOTE1X1dSSVRFKERJU1BMQVlfUEhZX0NPTlRST0wsIGRldl9wcml2LT5jaHZfcGh5X2Nv
bnRyb2wpOwo+ID4gKwlJOTE1X1dSSVRFKERJU1BMQVlfUEhZX0NPTlRST0wsIGk5MTUtPmNodl9w
aHlfY29udHJvbCk7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJJbml0aWFsIFBIWV9DT05UUk9MPTB4
JTA4eFxuIiwKPiA+IC0JCSAgICAgIGRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wpOwo+ID4gKwkJ
ICAgICAgaTkxNS0+Y2h2X3BoeV9jb250cm9sKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHZs
dl9jbW5sYW5lX3dhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0
aWMgdm9pZCB2bHZfY21ubGFuZV93YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+
ICAgewo+ID4gICAJc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqY21uID0KPiA+IC0JCWxvb2t1cF9w
b3dlcl93ZWxsKGRldl9wcml2LCBWTFZfRElTUF9QV19EUElPX0NNTl9CQyk7Cj4gPiArCQlsb29r
dXBfcG93ZXJfd2VsbChpOTE1LCBWTFZfRElTUF9QV19EUElPX0NNTl9CQyk7Cj4gPiAgIAlzdHJ1
Y3QgaTkxNV9wb3dlcl93ZWxsICpkaXNwMmQgPQo+ID4gLQkJbG9va3VwX3Bvd2VyX3dlbGwoZGV2
X3ByaXYsIFZMVl9ESVNQX1BXX0RJU1AyRCk7Cj4gPiArCQlsb29rdXBfcG93ZXJfd2VsbChpOTE1
LCBWTFZfRElTUF9QV19ESVNQMkQpOwo+ID4gICAJLyogSWYgdGhlIGRpc3BsYXkgbWlnaHQgYmUg
YWxyZWFkeSBhY3RpdmUgc2tpcCB0aGlzICovCj4gPiAtCWlmIChjbW4tPmRlc2MtPm9wcy0+aXNf
ZW5hYmxlZChkZXZfcHJpdiwgY21uKSAmJgo+ID4gLQkgICAgZGlzcDJkLT5kZXNjLT5vcHMtPmlz
X2VuYWJsZWQoZGV2X3ByaXYsIGRpc3AyZCkgJiYKPiA+ICsJaWYgKGNtbi0+ZGVzYy0+b3BzLT5p
c19lbmFibGVkKGk5MTUsIGNtbikgJiYKPiA+ICsJICAgIGRpc3AyZC0+ZGVzYy0+b3BzLT5pc19l
bmFibGVkKGk5MTUsIGRpc3AyZCkgJiYKPiA+ICAgCSAgICBJOTE1X1JFQUQoRFBJT19DVEwpICYg
RFBJT19DTU5SU1QpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJRFJNX0RFQlVHX0tNUygidG9nZ2xp
bmcgZGlzcGxheSBQSFkgc2lkZSByZXNldFxuIik7Cj4gPiAgIAkvKiBjbW5sYW5lIG5lZWRzIERQ
TEwgcmVnaXN0ZXJzICovCj4gPiAtCWRpc3AyZC0+ZGVzYy0+b3BzLT5lbmFibGUoZGV2X3ByaXYs
IGRpc3AyZCk7Cj4gPiArCWRpc3AyZC0+ZGVzYy0+b3BzLT5lbmFibGUoaTkxNSwgZGlzcDJkKTsK
PiA+ICAgCS8qCj4gPiAgIAkgKiBGcm9tIFZMVjJBMF9EUF9lRFBfSERNSV9EUElPX2RyaXZlcl92
Ymlvc19ub3Rlc18xMS5kb2N4Ogo+ID4gQEAgLTQyNzcsMjcgKzQyNzcsMjcgQEAgc3RhdGljIHZv
aWQgdmx2X2NtbmxhbmVfd2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
ICAJICogU2ltcGx5IHVuZ2F0aW5nIGlzbid0IGVub3VnaCB0byByZXNldCB0aGUgUEhZIGVub3Vn
aCB0byBnZXQKPiA+ICAgCSAqIHBvcnRzIGFuZCBsYW5lcyBydW5uaW5nLgo+ID4gICAJICovCj4g
PiAtCWNtbi0+ZGVzYy0+b3BzLT5kaXNhYmxlKGRldl9wcml2LCBjbW4pOwo+ID4gKwljbW4tPmRl
c2MtPm9wcy0+ZGlzYWJsZShpOTE1LCBjbW4pOwo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wgdmx2
X3B1bml0X2lzX3Bvd2VyX2dhdGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
dTMyIHJlZzApCj4gPiArc3RhdGljIGJvb2wgdmx2X3B1bml0X2lzX3Bvd2VyX2dhdGVkKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcmVnMCkKPiA+ICAgewo+ID4gICAJYm9vbCBy
ZXQ7Cj4gPiAtCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOwo+ID4gLQlyZXQgPSAodmx2X3B1bml0
X3JlYWQoZGV2X3ByaXYsIHJlZzApICYgU1NQTTBfU1NDX01BU0spID09IFNTUE0wX1NTQ19QV1Jf
R0FURTsKPiA+IC0Jdmx2X3B1bml0X3B1dChkZXZfcHJpdik7Cj4gPiArCXZsdl9wdW5pdF9nZXQo
aTkxNSk7Cj4gPiArCXJldCA9ICh2bHZfcHVuaXRfcmVhZChpOTE1LCByZWcwKSAmIFNTUE0wX1NT
Q19NQVNLKSA9PSBTU1BNMF9TU0NfUFdSX0dBVEU7Cj4gPiArCXZsdl9wdW5pdF9wdXQoaTkxNSk7
Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgYXNzZXJ0X3ZlZF9w
b3dlcl9nYXRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGlj
IHZvaWQgYXNzZXJ0X3ZlZF9wb3dlcl9nYXRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiA+ICAgewo+ID4gLQlXQVJOKCF2bHZfcHVuaXRfaXNfcG93ZXJfZ2F0ZWQoZGV2X3ByaXYs
IFBVTklUX1JFR19WRURTU1BNMCksCj4gPiArCVdBUk4oIXZsdl9wdW5pdF9pc19wb3dlcl9nYXRl
ZChpOTE1LCBQVU5JVF9SRUdfVkVEU1NQTTApLAo+ID4gICAJICAgICAiVkVEIG5vdCBwb3dlciBn
YXRlZFxuIik7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBhc3NlcnRfaXNwX3Bvd2VyX2dhdGVk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBhc3Nl
cnRfaXNwX3Bvd2VyX2dhdGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7
Cj4gPiAgIAlzdGF0aWMgY29uc3Qgc3RydWN0IHBjaV9kZXZpY2VfaWQgaXNwX2lkc1tdID0gewo+
ID4gICAJCXtQQ0lfREVWSUNFKFBDSV9WRU5ET1JfSURfSU5URUwsIDB4MGYzOCl9LAo+ID4gQEAg
LTQzMDYsMTEgKzQzMDYsMTEgQEAgc3RhdGljIHZvaWQgYXNzZXJ0X2lzcF9wb3dlcl9nYXRlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAl9Owo+ID4gICAJV0FSTigh
cGNpX2Rldl9wcmVzZW50KGlzcF9pZHMpICYmCj4gPiAtCSAgICAgIXZsdl9wdW5pdF9pc19wb3dl
cl9nYXRlZChkZXZfcHJpdiwgUFVOSVRfUkVHX0lTUFNTUE0wKSwKPiA+ICsJICAgICAhdmx2X3B1
bml0X2lzX3Bvd2VyX2dhdGVkKGk5MTUsIFBVTklUX1JFR19JU1BTU1BNMCksCj4gPiAgIAkgICAg
ICJJU1Agbm90IHBvd2VyIGdhdGVkXG4iKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGludGVs
X3Bvd2VyX2RvbWFpbnNfdmVyaWZ5X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdik7Cj4gPiArc3RhdGljIHZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc192ZXJpZnlfc3RhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAvKioKPiA+ICAgICogaW50ZWxf
cG93ZXJfZG9tYWluc19pbml0X2h3IC0gaW5pdGlhbGl6ZSBoYXJkd2FyZSBwb3dlciBkb21haW4g
c3RhdGUKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5
X3Bvd2VyLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmgKPiA+
IGluZGV4IGZmNTdiMGE3ZmU1OS4uMDMxMGZlMTE0ZWNjIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheV9wb3dlci5oCj4gPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmgKPiA+IEBAIC04MCwyMyArODAsMjMgQEAg
c3RydWN0IGk5MTVfcG93ZXJfd2VsbF9vcHMgewo+ID4gICAJICogZHVyaW5nIGRyaXZlciBpbml0
IGFuZCByZXN1bWUgdGltZSwgcG9zc2libHkgYWZ0ZXIgZmlyc3QgY2FsbGluZwo+ID4gICAJICog
dGhlIGVuYWJsZS9kaXNhYmxlIGhhbmRsZXJzLgo+ID4gICAJICovCj4gPiAtCXZvaWQgKCpzeW5j
X2h3KShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArCXZvaWQgKCpzeW5j
X2h3KShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJc3RydWN0IGk5MTVf
cG93ZXJfd2VsbCAqcG93ZXJfd2VsbCk7Cj4gPiAgIAkvKgo+ID4gICAJICogRW5hYmxlIHRoZSB3
ZWxsIGFuZCByZXNvdXJjZXMgdGhhdCBkZXBlbmQgb24gaXQgKGZvciBleGFtcGxlCj4gPiAgIAkg
KiBpbnRlcnJ1cHRzIGxvY2F0ZWQgb24gdGhlIHdlbGwpLiBDYWxsZWQgYWZ0ZXIgdGhlIDAtPjEg
cmVmY291bnQKPiA+ICAgCSAqIHRyYW5zaXRpb24uCj4gPiAgIAkgKi8KPiA+IC0Jdm9pZCAoKmVu
YWJsZSkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gKwl2b2lkICgqZW5h
YmxlKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkgICAgICAgc3RydWN0
IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCk7Cj4gPiAgIAkvKgo+ID4gICAJICogRGlzYWJs
ZSB0aGUgd2VsbCBhbmQgcmVzb3VyY2VzIHRoYXQgZGVwZW5kIG9uIGl0LiBDYWxsZWQgYWZ0ZXIK
PiA+ICAgCSAqIHRoZSAxLT4wIHJlZmNvdW50IHRyYW5zaXRpb24uCj4gPiAgIAkgKi8KPiA+IC0J
dm9pZCAoKmRpc2FibGUpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICsJ
dm9pZCAoKmRpc2FibGUpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQlz
dHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKTsKPiA+ICAgCS8qIFJldHVybnMgdGhl
IGh3IGVuYWJsZWQgc3RhdGUuICovCj4gPiAtCWJvb2wgKCppc19lbmFibGVkKShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArCWJvb2wgKCppc19lbmFibGVkKShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgc3RydWN0IGk5MTVfcG93ZXJfd2Vs
bCAqcG93ZXJfd2VsbCk7Cj4gPiAgIH07Cj4gPiBAQCAtMjA0LDQ4ICsyMDQsNDggQEAgc3RydWN0
IGk5MTVfcG93ZXJfZG9tYWlucyB7Cj4gPiAgIAlmb3JfZWFjaF9wb3dlcl93ZWxsX3JldmVyc2Uo
X19kZXZfcHJpdiwgX19wb3dlcl93ZWxsKQkJICAgICAgICBcCj4gPiAgIAkJZm9yX2VhY2hfaWYo
KF9fcG93ZXJfd2VsbCktPmRlc2MtPmRvbWFpbnMgJiAoX19kb21haW5fbWFzaykpCj4gPiAtdm9p
ZCBza2xfZW5hYmxlX2RjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4g
LXZvaWQgZ2VuOV9zYW5pdGl6ZV9kY19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwo+ID4gLXZvaWQgYnh0X2VuYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiA+IC12b2lkIGJ4dF9kaXNhYmxlX2RjOShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgZ2VuOV9lbmFibGVfZGM1KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBza2xfZW5hYmxlX2RjNihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBnZW45X3Nhbml0aXplX2RjX3N0YXRlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGJ4dF9lbmFibGVfZGM5KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGJ4dF9kaXNhYmxlX2RjOShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBnZW45X2VuYWJsZV9kYzUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gLWludCBpbnRlbF9wb3dlcl9kb21h
aW5zX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGlu
dGVsX3Bvd2VyX2RvbWFpbnNfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwo+ID4gLXZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19pbml0X2h3KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCByZXN1bWUpOwo+ID4gLXZvaWQgaW50ZWxfcG93ZXJf
ZG9tYWluc19maW5pX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAt
dm9pZCBpY2xfZGlzcGxheV9jb3JlX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCBib29sIHJlc3VtZSk7Cj4gPiAtdm9pZCBpY2xfZGlzcGxheV9jb3JlX3VuaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgaW50ZWxfcG93ZXJfZG9t
YWluc19lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lk
IGludGVsX3Bvd2VyX2RvbWFpbnNfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwo+ID4gLXZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19zdXNwZW5kKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpbnQgaW50ZWxfcG93ZXJfZG9tYWluc19pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX3Bvd2VyX2Rv
bWFpbnNfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBp
bnRlbF9wb3dlcl9kb21haW5zX2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IGJvb2wgcmVzdW1lKTsKPiA+ICt2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfZmluaV9odyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBpY2xfZGlzcGxheV9jb3JlX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgcmVzdW1lKTsKPiA+ICt2b2lk
IGljbF9kaXNwbGF5X2NvcmVfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiA+ICt2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfZGlzYWJsZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX3N1
c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgZW51bSBpOTE1
X2RybV9zdXNwZW5kX21vZGUpOwo+ID4gLXZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19yZXN1bWUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGhzd19lbmFibGVf
cGM4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBoc3dfZGlz
YWJsZV9wYzgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGJ4
dF9kaXNwbGF5X2NvcmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJv
b2wgcmVzdW1lKTsKPiA+IC12b2lkIGJ4dF9kaXNwbGF5X2NvcmVfdW5pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX3Jl
c3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBoc3dfZW5hYmxl
X3BjOChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBoc3dfZGlzYWJs
ZV9wYzgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgYnh0X2Rpc3Bs
YXlfY29yZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBib29sIHJlc3VtZSk7
Cj4gPiArdm9pZCBieHRfZGlzcGxheV9jb3JlX3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSk7Cj4gPiAgIGNvbnN0IGNoYXIgKgo+ID4gICBpbnRlbF9kaXNwbGF5X3Bvd2VyX2Rv
bWFpbl9zdHIoZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pOwo+ID4gLWJv
b2wgaW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtib29sIGludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5hYmxlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICBlbnVtIGludGVsX2Rpc3Bs
YXlfcG93ZXJfZG9tYWluIGRvbWFpbik7Cj4gPiAtYm9vbCBfX2ludGVsX2Rpc3BsYXlfcG93ZXJf
aXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArYm9vbCBf
X2ludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJCSAgICAgIGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9t
YWluKTsKPiA+IC1pbnRlbF93YWtlcmVmX3QgaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2ludGVsX3dha2VyZWZfdCBpbnRlbF9k
aXNwbGF5X3Bvd2VyX2dldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJ
CQllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbik7Cj4gPiAgIGludGVsX3dh
a2VyZWZfdAo+ID4gLWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2ludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lm
X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICBlbnVt
IGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbik7Cj4gPiAtdm9pZCBpbnRlbF9kaXNw
bGF5X3Bvd2VyX3B1dF91bmNoZWNrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gK3ZvaWQgaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgIGVudW0gaW50ZWxfZGlzcGxheV9w
b3dlcl9kb21haW4gZG9tYWluKTsKPiA+ICAgdm9pZCBfX2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0
X2FzeW5jKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICBlbnVt
IGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbiwKPiA+ICAgCQkJCSAgICAgaW50ZWxf
d2FrZXJlZl90IHdha2VyZWYpOwo+ID4gICB2b2lkIGludGVsX2Rpc3BsYXlfcG93ZXJfZmx1c2hf
d29yayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgICNpZiBJU19FTkFCTEVE
KENPTkZJR19EUk1fSTkxNV9ERUJVR19SVU5USU1FX1BNKQo+ID4gLXZvaWQgaW50ZWxfZGlzcGxh
eV9wb3dlcl9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQg
aW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgIAkJCSAgICAgZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4sCj4gPiAg
IAkJCSAgICAgaW50ZWxfd2FrZXJlZl90IHdha2VyZWYpOwo+ID4gICBzdGF0aWMgaW5saW5lIHZv
aWQKPiA+IEBAIC0yNzcsMTIgKzI3NywxMiBAQCBpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF9hc3lu
YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCWZvciAoKHdmKSA9IGludGVs
X2Rpc3BsYXlfcG93ZXJfZ2V0KChpOTE1KSwgKGRvbWFpbikpOyAod2YpOyBcCj4gPiAgIAkgICAg
IGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jKChpOTE1KSwgKGRvbWFpbiksICh3ZikpLCAo
d2YpID0gMCkKPiA+IC12b2lkIGljbF9kYnVmX3NsaWNlc191cGRhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgaWNsX2RidWZfc2xpY2VzX3VwZGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgIHU4IHJlcV9zbGljZXMpOwo+
ID4gICB2b2lkIGNodl9waHlfcG93ZXJnYXRlX2xhbmVzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ID4gICAJCQkgICAgIGJvb2wgb3ZlcnJpZGUsIHVuc2lnbmVkIGludCBtYXNrKTsK
PiA+IC1ib29sIGNodl9waHlfcG93ZXJnYXRlX2NoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgZW51bSBkcGlvX3BoeSBwaHksCj4gPiArYm9vbCBjaHZfcGh5X3Bvd2VyZ2F0ZV9j
aChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBkcGlvX3BoeSBwaHksCj4gPiAg
IAkJCSAgZW51bSBkcGlvX2NoYW5uZWwgY2gsIGJvb2wgb3ZlcnJpZGUpOwo+ID4gICAjZW5kaWYg
LyogX19JTlRFTF9ESVNQTEFZX1BPV0VSX0hfXyAqLwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2RwLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcC5j
Cj4gPiBpbmRleCA0MzM2ZGY0NmZlNzguLmQ0ZGMyYjk1MDZlNSAxMDA2NDQKPiA+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2RwLmMKPiA+IEBAIC0xNjAsNyArMTYwLDcgQEAgc3RhdGljIGJvb2wgZWRwX3Bh
bmVsX3ZkZF9vbihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsKPiA+ICAgc3RhdGljIHZvaWQg
ZWRwX3BhbmVsX3ZkZF9vZmYoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgYm9vbCBzeW5jKTsK
PiA+ICAgc3RhdGljIHZvaWQgdmx2X2luaXRfcGFuZWxfcG93ZXJfc2VxdWVuY2VyKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKPiA+IC1zdGF0aWMgdm9pZCB2bHZfc3RlYWxfcG93ZXJf
c2VxdWVuY2VyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMg
dm9pZCB2bHZfc3RlYWxfcG93ZXJfc2VxdWVuY2VyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ID4gICAJCQkJICAgICAgZW51bSBwaXBlIHBpcGUpOwo+ID4gICBzdGF0aWMgdm9pZCBp
bnRlbF9kcF91bnNldF9lZGlkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApOwo+ID4gQEAgLTIx
NCw4ICsyMTQsOCBAQCBzdGF0aWMgaW50IGludGVsX2RwX21heF9jb21tb25fcmF0ZShzdHJ1Y3Qg
aW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICBzdGF0aWMgaW50IGludGVsX2RwX2dldF9maWFfc3Vw
cG9ydGVkX2xhbmVfY291bnQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgewo+ID4g
ICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChp
bnRlbF9kcCk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ID4gLQllbnVtIHRjX3BvcnQgdGNfcG9ydCA9
IGludGVsX3BvcnRfdG9fdGMoZGV2X3ByaXYsIGRpZ19wb3J0LT5iYXNlLnBvcnQpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFz
ZS5kZXYpOwo+ID4gKwllbnVtIHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoaTkx
NSwgZGlnX3BvcnQtPmJhc2UucG9ydCk7Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsK
PiA+ICAgCXUzMiBsYW5lX2luZm87Cj4gPiBAQCAtMjIzLDcgKzIyMyw3IEBAIHN0YXRpYyBpbnQg
aW50ZWxfZHBfZ2V0X2ZpYV9zdXBwb3J0ZWRfbGFuZV9jb3VudChzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwKQo+ID4gICAJCXJldHVybiA0Owo+ID4gICAJbGFuZV9pbmZvID0gMDsKPiA+IC0Jd2l0
aF9pbnRlbF9kaXNwbGF5X3Bvd2VyKGRldl9wcml2LCBQT1dFUl9ET01BSU5fRElTUExBWV9DT1JF
LCB3YWtlcmVmKQo+ID4gKwl3aXRoX2ludGVsX2Rpc3BsYXlfcG93ZXIoaTkxNSwgUE9XRVJfRE9N
QUlOX0RJU1BMQVlfQ09SRSwgd2FrZXJlZikKPiA+ICAgCQlsYW5lX2luZm8gPSAoSTkxNV9SRUFE
KFBPUlRfVFhfREZMRVhEUFNQKSAmCj4gPiAgIAkJCSAgICAgRFBfTEFORV9BU1NJR05NRU5UX01B
U0sodGNfcG9ydCkpID4+Cj4gPiAgIAkJCQlEUF9MQU5FX0FTU0lHTk1FTlRfU0hJRlQodGNfcG9y
dCk7Cj4gPiBAQCAtMjg0LDggKzI4NCw4IEBAIGludGVsX2RwX2Rvd25zdHJlYW1fbWF4X2RvdGNs
b2NrKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHAp
Owo+ID4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIgPSAmaW50ZWxfZGlnX3BvcnQt
PmJhc2U7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gLQlpbnQgbWF4X2RvdGNsayA9IGRldl9wcml2LT5tYXhf
ZG90Y2xrX2ZyZXE7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCWludCBtYXhfZG90Y2xrID0gaTkxNS0+bWF4X2Rv
dGNsa19mcmVxOwo+ID4gICAJaW50IGRzX21heF9kb3RjbGs7Cj4gPiAgIAlpbnQgdHlwZSA9IGlu
dGVsX2RwLT5kb3duc3RyZWFtX3BvcnRzWzBdICYgRFBfRFNfUE9SVF9UWVBFX01BU0s7Cj4gPiBA
QCAtMzA1LDcgKzMwNSw3IEBAIGludGVsX2RwX2Rvd25zdHJlYW1fbWF4X2RvdGNsb2NrKHN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHN0YXRpYyBpbnQgY25sX21heF9zb3VyY2VfcmF0
ZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkaWdfcG9ydC0+YmFz
ZS5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGRpZ19w
b3J0LT5iYXNlLnBvcnQ7Cj4gPiAgIAl1MzIgdm9sdGFnZSA9IEk5MTVfUkVBRChDTkxfUE9SVF9D
T01QX0RXMykgJiBWT0xUQUdFX0lORk9fTUFTSzsKPiA+IEBAIC0zMTUsNyArMzE1LDcgQEAgc3Rh
dGljIGludCBjbmxfbWF4X3NvdXJjZV9yYXRlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4g
PiAgIAkJcmV0dXJuIDU0MDAwMDsKPiA+ICAgCS8qIEZvciB0aGlzIFNLVSA4LjFHIGlzIHN1cHBv
cnRlZCBpbiBhbGwgcG9ydHMgKi8KPiA+IC0JaWYgKElTX0NOTF9XSVRIX1BPUlRfRihkZXZfcHJp
dikpCj4gPiArCWlmIChJU19DTkxfV0lUSF9QT1JUX0YoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIDgx
MDAwMDsKPiA+ICAgCS8qIEZvciBvdGhlciBTS1VzLCBtYXggcmF0ZSBvbiBwb3J0cyBBIGFuZCBE
IGlzIDUuNEcgKi8KPiA+IEBAIC0zMjgsMTEgKzMyOCwxMSBAQCBzdGF0aWMgaW50IGNubF9tYXhf
c291cmNlX3JhdGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgc3RhdGljIGludCBp
Y2xfbWF4X3NvdXJjZV9yYXRlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQo
aW50ZWxfZHApOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiA+ICAgCWVudW0g
cG9ydCBwb3J0ID0gZGlnX3BvcnQtPmJhc2UucG9ydDsKPiA+IC0JaWYgKGludGVsX3BvcnRfaXNf
Y29tYm9waHkoZGV2X3ByaXYsIHBvcnQpICYmCj4gPiAtCSAgICAhSVNfRUxLSEFSVExBS0UoZGV2
X3ByaXYpICYmCj4gPiArCWlmIChpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KGk5MTUsIHBvcnQpICYm
Cj4gPiArCSAgICAhSVNfRUxLSEFSVExBS0UoaTkxNSkgJiYKPiA+ICAgCSAgICAhaW50ZWxfZHBf
aXNfZWRwKGludGVsX2RwKSkKPiA+ICAgCQlyZXR1cm4gNTQwMDAwOwo+ID4gQEAgLTM1OSwzMCAr
MzU5LDMwIEBAIGludGVsX2RwX3NldF9zb3VyY2VfcmF0ZXMoc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCkKPiA+ICAgCQkxNjIwMDAsIDI3MDAwMAo+ID4gICAJfTsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRpZ19wb3J0LT5i
YXNlLmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBkZGlfdmJ0
X3BvcnRfaW5mbyAqaW5mbyA9Cj4gPiAtCQkmZGV2X3ByaXYtPnZidC5kZGlfcG9ydF9pbmZvW2Rp
Z19wb3J0LT5iYXNlLnBvcnRdOwo+ID4gKwkJJmk5MTUtPnZidC5kZGlfcG9ydF9pbmZvW2RpZ19w
b3J0LT5iYXNlLnBvcnRdOwo+ID4gICAJY29uc3QgaW50ICpzb3VyY2VfcmF0ZXM7Cj4gPiAgIAlp
bnQgc2l6ZSwgbWF4X3JhdGUgPSAwLCB2YnRfbWF4X3JhdGUgPSBpbmZvLT5kcF9tYXhfbGlua19y
YXRlOwo+ID4gICAJLyogVGhpcyBzaG91bGQgb25seSBiZSBkb25lIG9uY2UgKi8KPiA+ICAgCVdB
Uk5fT04oaW50ZWxfZHAtPnNvdXJjZV9yYXRlcyB8fCBpbnRlbF9kcC0+bnVtX3NvdXJjZV9yYXRl
cyk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSB7Cj4gPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gMTApIHsKPiA+ICAgCQlzb3VyY2VfcmF0ZXMgPSBjbmxfcmF0ZXM7Cj4g
PiAgIAkJc2l6ZSA9IEFSUkFZX1NJWkUoY25sX3JhdGVzKTsKPiA+IC0JCWlmIChJU19HRU4oZGV2
X3ByaXYsIDEwKSkKPiA+ICsJCWlmIChJU19HRU4oaTkxNSwgMTApKQo+ID4gICAJCQltYXhfcmF0
ZSA9IGNubF9tYXhfc291cmNlX3JhdGUoaW50ZWxfZHApOwo+ID4gICAJCWVsc2UKPiA+ICAgCQkJ
bWF4X3JhdGUgPSBpY2xfbWF4X3NvdXJjZV9yYXRlKGludGVsX2RwKTsKPiA+IC0JfSBlbHNlIGlm
IChJU19HRU45X0xQKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0dFTjlfTFAoaTkx
NSkpIHsKPiA+ICAgCQlzb3VyY2VfcmF0ZXMgPSBieHRfcmF0ZXM7Cj4gPiAgIAkJc2l6ZSA9IEFS
UkFZX1NJWkUoYnh0X3JhdGVzKTsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2
KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0dFTjlfQkMoaTkxNSkpIHsKPiA+ICAgCQlzb3VyY2Vf
cmF0ZXMgPSBza2xfcmF0ZXM7Cj4gPiAgIAkJc2l6ZSA9IEFSUkFZX1NJWkUoc2tsX3JhdGVzKTsK
PiA+IC0JfSBlbHNlIGlmICgoSVNfSEFTV0VMTChkZXZfcHJpdikgJiYgIUlTX0hTV19VTFgoZGV2
X3ByaXYpKSB8fAo+ID4gLQkJICAgSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ID4gKwl9IGVs
c2UgaWYgKChJU19IQVNXRUxMKGk5MTUpICYmICFJU19IU1dfVUxYKGk5MTUpKSB8fAo+ID4gKwkJ
ICAgSVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gPiAgIAkJc291cmNlX3JhdGVzID0gaHN3X3JhdGVz
Owo+ID4gICAJCXNpemUgPSBBUlJBWV9TSVpFKGhzd19yYXRlcyk7Cj4gPiAgIAl9IGVsc2Ugewo+
ID4gQEAgLTUzMiw3ICs1MzIsNyBAQCBpbnRlbF9kcF9tb2RlX3ZhbGlkKHN0cnVjdCBkcm1fY29u
bmVjdG9yICpjb25uZWN0b3IsCj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gaW50
ZWxfYXR0YWNoZWRfZHAoY29ubmVjdG9yKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmludGVsX2Nvbm5lY3RvciA9IHRvX2ludGVsX2Nvbm5lY3Rvcihjb25uZWN0b3IpOwo+ID4gICAJ
c3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGUgPSBpbnRlbF9jb25uZWN0b3ItPnBh
bmVsLmZpeGVkX21vZGU7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ID4gICAJaW50IHRhcmdldF9jbG9jayA9
IG1vZGUtPmNsb2NrOwo+ID4gICAJaW50IG1heF9yYXRlLCBtb2RlX3JhdGUsIG1heF9sYW5lcywg
bWF4X2xpbmtfY2xvY2s7Cj4gPiAgIAlpbnQgbWF4X2RvdGNsazsKPiA+IEBAIC01NjQsNyArNTY0
LDcgQEAgaW50ZWxfZHBfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9y
LAo+ID4gICAJICogT3V0cHV0IGJwcCBpcyBzdG9yZWQgaW4gNi40IGZvcm1hdCBzbyByaWdodCBz
aGlmdCBieSA0IHRvIGdldCB0aGUKPiA+ICAgCSAqIGludGVnZXIgdmFsdWUgc2luY2Ugd2Ugc3Vw
cG9ydCBvbmx5IGludGVnZXIgdmFsdWVzIG9mIGJwcC4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoKElO
VEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpICYmCj4g
PiArCWlmICgoSU5URUxfR0VOKGk5MTUpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoaTkxNSkpICYm
Cj4gPiAgIAkgICAgZHJtX2RwX3Npbmtfc3VwcG9ydHNfZHNjKGludGVsX2RwLT5kc2NfZHBjZCkp
IHsKPiA+ICAgCQlpZiAoaW50ZWxfZHBfaXNfZWRwKGludGVsX2RwKSkgewo+ID4gICAJCQlkc2Nf
bWF4X291dHB1dF9icHAgPQo+ID4gQEAgLTYzMCwxNyArNjMwLDE3IEBAIGludGVsX2RwX3Bwc19p
bml0KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApOwo+ID4gICBzdGF0aWMgaW50ZWxfd2FrZXJl
Zl90Cj4gPiAgIHBwc19sb2NrKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9k
cCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRl
bF9kcCk7Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCS8qCj4gPiAgIAkg
KiBTZWUgaW50ZWxfcG93ZXJfc2VxdWVuY2VyX3Jlc2V0KCkgd2h5IHdlIG5lZWQKPiA+ICAgCSAq
IGEgcG93ZXIgZG9tYWluIHJlZmVyZW5jZSBoZXJlLgo+ID4gICAJICovCj4gPiAtCXdha2VyZWYg
PSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwKPiA+ICsJd2FrZXJlZiA9IGludGVs
X2Rpc3BsYXlfcG93ZXJfZ2V0KGk5MTUsCj4gPiAgIAkJCQkJICBpbnRlbF9hdXhfcG93ZXJfZG9t
YWluKGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKSkpOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJp
di0+cHBzX211dGV4KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+cHBzX211dGV4KTsKPiA+ICAg
CXJldHVybiB3YWtlcmVmOwo+ID4gICB9Cj4gPiBAQCAtNjQ4LDEwICs2NDgsMTAgQEAgcHBzX2xv
Y2soc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgc3RhdGljIGludGVsX3dha2VyZWZf
dAo+ID4gICBwcHNfdW5sb2NrKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIGludGVsX3dha2Vy
ZWZfdCB3YWtlcmVmKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9w
cml2LT5wcHNfbXV0ZXgpOwo+ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwK
PiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5wcHNfbXV0ZXgpOwo+ID4gKwlpbnRlbF9kaXNwbGF5
X3Bvd2VyX3B1dChpOTE1LAo+ID4gICAJCQkJaW50ZWxfYXV4X3Bvd2VyX2RvbWFpbihkcF90b19k
aWdfcG9ydChpbnRlbF9kcCkpLAo+ID4gICAJCQkJd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4gMDsK
PiA+IEBAIC02NjMsNyArNjYzLDcgQEAgcHBzX3VubG9jayhzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwLCBpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZikKPiA+ICAgc3RhdGljIHZvaWQKPiA+ICAgdmx2
X3Bvd2VyX3NlcXVlbmNlcl9raWNrKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRl
bF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9y
dCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gaW50
ZWxfZHAtPnBwc19waXBlOwo+ID4gICAJYm9vbCBwbGxfZW5hYmxlZCwgcmVsZWFzZV9jbF9vdmVy
cmlkZSA9IGZhbHNlOwo+ID4gQEAgLTY4Nyw3ICs2ODcsNyBAQCB2bHZfcG93ZXJfc2VxdWVuY2Vy
X2tpY2soc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgCURQIHw9IERQX1BPUlRfV0lE
VEgoMSk7Cj4gPiAgIAlEUCB8PSBEUF9MSU5LX1RSQUlOX1BBVF8xOwo+ID4gLQlpZiAoSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpCj4gPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKQo+ID4gICAJ
CURQIHw9IERQX1BJUEVfU0VMX0NIVihwaXBlKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlEUCB8PSBE
UF9QSVBFX1NFTChwaXBlKTsKPiA+IEBAIC02OTksMTAgKzY5OSwxMCBAQCB2bHZfcG93ZXJfc2Vx
dWVuY2VyX2tpY2soc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgCSAqIFNvIGVuYWJs
ZSB0ZW1wb3JhcmlseSBpdCBpZiBpdCdzIG5vdCBhbHJlYWR5IGVuYWJsZWQuCj4gPiAgIAkgKi8K
PiA+ICAgCWlmICghcGxsX2VuYWJsZWQpIHsKPiA+IC0JCXJlbGVhc2VfY2xfb3ZlcnJpZGUgPSBJ
U19DSEVSUllWSUVXKGRldl9wcml2KSAmJgo+ID4gLQkJCSFjaHZfcGh5X3Bvd2VyZ2F0ZV9jaChk
ZXZfcHJpdiwgcGh5LCBjaCwgdHJ1ZSk7Cj4gPiArCQlyZWxlYXNlX2NsX292ZXJyaWRlID0gSVNf
Q0hFUlJZVklFVyhpOTE1KSAmJgo+ID4gKwkJCSFjaHZfcGh5X3Bvd2VyZ2F0ZV9jaChpOTE1LCBw
aHksIGNoLCB0cnVlKTsKPiA+IC0JCWlmICh2bHZfZm9yY2VfcGxsX29uKGRldl9wcml2LCBwaXBl
LCBJU19DSEVSUllWSUVXKGRldl9wcml2KSA/Cj4gPiArCQlpZiAodmx2X2ZvcmNlX3BsbF9vbihp
OTE1LCBwaXBlLCBJU19DSEVSUllWSUVXKGk5MTUpID8KPiA+ICAgCQkJCSAgICAgJmNodl9kcGxs
WzBdLmRwbGwgOiAmdmx2X2RwbGxbMF0uZHBsbCkpIHsKPiA+ICAgCQkJRFJNX0VSUk9SKCJGYWls
ZWQgdG8gZm9yY2Ugb24gcGxsIGZvciBwaXBlICVjIVxuIiwKPiA+ICAgCQkJCSAgcGlwZV9uYW1l
KHBpcGUpKTsKPiA+IEBAIC03MjYsMTQgKzcyNiwxNCBAQCB2bHZfcG93ZXJfc2VxdWVuY2VyX2tp
Y2soc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgCVBPU1RJTkdfUkVBRChpbnRlbF9k
cC0+b3V0cHV0X3JlZyk7Cj4gPiAgIAlpZiAoIXBsbF9lbmFibGVkKSB7Cj4gPiAtCQl2bHZfZm9y
Y2VfcGxsX29mZihkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCQl2bHZfZm9yY2VfcGxsX29mZihpOTE1
LCBwaXBlKTsKPiA+ICAgCQlpZiAocmVsZWFzZV9jbF9vdmVycmlkZSkKPiA+IC0JCQljaHZfcGh5
X3Bvd2VyZ2F0ZV9jaChkZXZfcHJpdiwgcGh5LCBjaCwgZmFsc2UpOwo+ID4gKwkJCWNodl9waHlf
cG93ZXJnYXRlX2NoKGk5MTUsIHBoeSwgY2gsIGZhbHNlKTsKPiA+ICAgCX0KPiA+ICAgfQo+ID4g
LXN0YXRpYyBlbnVtIHBpcGUgdmx2X2ZpbmRfZnJlZV9wcHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBlbnVtIHBpcGUgdmx2X2ZpbmRfZnJlZV9wcHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyOwo+ID4gICAJdW5zaWduZWQgaW50IHBpcGVzID0gKDEgPDwgUElQRV9B
KSB8ICgxIDw8IFBJUEVfQik7Cj4gPiBAQCAtNzQyLDcgKzc0Miw3IEBAIHN0YXRpYyBlbnVtIHBp
cGUgdmx2X2ZpbmRfZnJlZV9wcHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gICAJICogV2UgZG9uJ3QgaGF2ZSBwb3dlciBzZXF1ZW5jZXIgY3VycmVudGx5Lgo+ID4gICAJ
ICogUGljayBvbmUgdGhhdCdzIG5vdCB1c2VkIGJ5IG90aGVyIHBvcnRzLgo+ID4gICAJICovCj4g
PiAtCWZvcl9lYWNoX2ludGVsX2RwKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7Cj4gPiArCWZv
cl9lYWNoX2ludGVsX2RwKCZpOTE1LT5kcm0sIGVuY29kZXIpIHsKPiA+ICAgCQlzdHJ1Y3QgaW50
ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAg
CQlpZiAoZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfRURQKSB7Cj4gPiBAQCAtNzY4LDEx
ICs3NjgsMTEgQEAgc3RhdGljIGVudW0gcGlwZSB2bHZfZmluZF9mcmVlX3BwcyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIHN0YXRpYyBlbnVtIHBpcGUKPiA+ICAgdmx2
X3Bvd2VyX3NlcXVlbmNlcl9waXBlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRl
bF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9y
dCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlOwo+ID4g
LQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+cHBzX211dGV4KTsKPiA+ICsJbG9ja2Rl
cF9hc3NlcnRfaGVsZCgmaTkxNS0+cHBzX211dGV4KTsKPiA+ICAgCS8qIFdlIHNob3VsZCBuZXZl
ciBsYW5kIGhlcmUgd2l0aCByZWd1bGFyIERQIHBvcnRzICovCj4gPiAgIAlXQVJOX09OKCFpbnRl
bF9kcF9pc19lZHAoaW50ZWxfZHApKTsKPiA+IEBAIC03ODMsNyArNzgzLDcgQEAgdmx2X3Bvd2Vy
X3NlcXVlbmNlcl9waXBlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIAlpZiAoaW50
ZWxfZHAtPnBwc19waXBlICE9IElOVkFMSURfUElQRSkKPiA+ICAgCQlyZXR1cm4gaW50ZWxfZHAt
PnBwc19waXBlOwo+ID4gLQlwaXBlID0gdmx2X2ZpbmRfZnJlZV9wcHMoZGV2X3ByaXYpOwo+ID4g
KwlwaXBlID0gdmx2X2ZpbmRfZnJlZV9wcHMoaTkxNSk7Cj4gPiAgIAkvKgo+ID4gICAJICogRGlk
bid0IGZpbmQgb25lLiBUaGlzIHNob3VsZCBub3QgaGFwcGVuIHNpbmNlIHRoZXJlCj4gPiBAQCAt
NzkyLDcgKzc5Miw3IEBAIHZsdl9wb3dlcl9zZXF1ZW5jZXJfcGlwZShzdHJ1Y3QgaW50ZWxfZHAg
KmludGVsX2RwKQo+ID4gICAJaWYgKFdBUk5fT04ocGlwZSA9PSBJTlZBTElEX1BJUEUpKQo+ID4g
ICAJCXBpcGUgPSBQSVBFX0E7Cj4gPiAtCXZsdl9zdGVhbF9wb3dlcl9zZXF1ZW5jZXIoZGV2X3By
aXYsIHBpcGUpOwo+ID4gKwl2bHZfc3RlYWxfcG93ZXJfc2VxdWVuY2VyKGk5MTUsIHBpcGUpOwo+
ID4gICAJaW50ZWxfZHAtPnBwc19waXBlID0gcGlwZTsKPiA+ICAgCURSTV9ERUJVR19LTVMoInBp
Y2tlZCBwaXBlICVjIHBvd2VyIHNlcXVlbmNlciBmb3IgcG9ydCAlY1xuIiwKPiA+IEBAIC04MTUs
MTAgKzgxNSwxMCBAQCB2bHZfcG93ZXJfc2VxdWVuY2VyX3BpcGUoc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCkKPiA+ICAgc3RhdGljIGludAo+ID4gICBieHRfcG93ZXJfc2VxdWVuY2VyX2lkeChz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gLQlpbnQgYmFja2xp
Z2h0X2NvbnRyb2xsZXIgPSBkZXZfcHJpdi0+dmJ0LmJhY2tsaWdodC5jb250cm9sbGVyOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+
ID4gKwlpbnQgYmFja2xpZ2h0X2NvbnRyb2xsZXIgPSBpOTE1LT52YnQuYmFja2xpZ2h0LmNvbnRy
b2xsZXI7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+
ID4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5wcHNfbXV0ZXgpOwo+ID4gICAJLyogV2Ug
c2hvdWxkIG5ldmVyIGxhbmQgaGVyZSB3aXRoIHJlZ3VsYXIgRFAgcG9ydHMgKi8KPiA+ICAgCVdB
Uk5fT04oIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpOwo+ID4gQEAgLTgzNywyOSArODM3LDI5
IEBAIGJ4dF9wb3dlcl9zZXF1ZW5jZXJfaWR4KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4g
PiAgIAlyZXR1cm4gYmFja2xpZ2h0X2NvbnRyb2xsZXI7Cj4gPiAgIH0KPiA+IC10eXBlZGVmIGJv
b2wgKCp2bHZfcGlwZV9jaGVjaykoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3R5cGVkZWYgYm9vbCAoKnZsdl9waXBlX2NoZWNrKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgIGVudW0gcGlwZSBwaXBlKTsKPiA+IC1zdGF0aWMgYm9v
bCB2bHZfcGlwZV9oYXNfcHBfb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3N0YXRpYyBib29sIHZsdl9waXBlX2hhc19wcF9vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgIGVudW0gcGlwZSBwaXBlKQo+ID4gICB7Cj4gPiAgIAly
ZXR1cm4gSTkxNV9SRUFEKFBQX1NUQVRVUyhwaXBlKSkgJiBQUF9PTjsKPiA+ICAgfQo+ID4gLXN0
YXRpYyBib29sIHZsdl9waXBlX2hhc192ZGRfb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gK3N0YXRpYyBib29sIHZsdl9waXBlX2hhc192ZGRfb24oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQllbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4g
ICAJcmV0dXJuIEk5MTVfUkVBRChQUF9DT05UUk9MKHBpcGUpKSAmIEVEUF9GT1JDRV9WREQ7Cj4g
PiAgIH0KPiA+IC1zdGF0aWMgYm9vbCB2bHZfcGlwZV9hbnkoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIHZsdl9waXBlX2FueShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJIGVudW0gcGlwZSBwaXBlKQo+ID4gICB7Cj4gPiAg
IAlyZXR1cm4gdHJ1ZTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgZW51bSBwaXBlCj4gPiAtdmx2X2lu
aXRpYWxfcHBzX3BpcGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3Zs
dl9pbml0aWFsX3Bwc19waXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJ
CSAgICAgZW51bSBwb3J0IHBvcnQsCj4gPiAgIAkJICAgICB2bHZfcGlwZV9jaGVjayBwaXBlX2No
ZWNrKQo+ID4gICB7Cj4gPiBAQCAtODcyLDcgKzg3Miw3IEBAIHZsdl9pbml0aWFsX3Bwc19waXBl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQlpZiAocG9ydF9zZWwg
IT0gUEFORUxfUE9SVF9TRUxFQ1RfVkxWKHBvcnQpKQo+ID4gICAJCQljb250aW51ZTsKPiA+IC0J
CWlmICghcGlwZV9jaGVjayhkZXZfcHJpdiwgcGlwZSkpCj4gPiArCQlpZiAoIXBpcGVfY2hlY2so
aTkxNSwgcGlwZSkpCj4gPiAgIAkJCWNvbnRpbnVlOwo+ID4gICAJCXJldHVybiBwaXBlOwo+ID4g
QEAgLTg4NCwyMyArODg0LDIzIEBAIHZsdl9pbml0aWFsX3Bwc19waXBlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgc3RhdGljIHZvaWQKPiA+ICAgdmx2X2luaXRpYWxf
cG93ZXJfc2VxdWVuY2VyX3NldHVwKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRl
bF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9y
dCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50
ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3By
aXYtPnBwc19tdXRleCk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPnBwc19tdXRl
eCk7Cj4gPiAgIAkvKiB0cnkgdG8gZmluZCBhIHBpcGUgd2l0aCB0aGlzIHBvcnQgc2VsZWN0ZWQg
Ki8KPiA+ICAgCS8qIGZpcnN0IHBpY2sgb25lIHdoZXJlIHRoZSBwYW5lbCBpcyBvbiAqLwo+ID4g
LQlpbnRlbF9kcC0+cHBzX3BpcGUgPSB2bHZfaW5pdGlhbF9wcHNfcGlwZShkZXZfcHJpdiwgcG9y
dCwKPiA+ICsJaW50ZWxfZHAtPnBwc19waXBlID0gdmx2X2luaXRpYWxfcHBzX3BpcGUoaTkxNSwg
cG9ydCwKPiA+ICAgCQkJCQkJICB2bHZfcGlwZV9oYXNfcHBfb24pOwo+ID4gICAJLyogZGlkbid0
IGZpbmQgb25lPyBwaWNrIG9uZSB3aGVyZSB2ZGQgaXMgb24gKi8KPiA+ICAgCWlmIChpbnRlbF9k
cC0+cHBzX3BpcGUgPT0gSU5WQUxJRF9QSVBFKQo+ID4gLQkJaW50ZWxfZHAtPnBwc19waXBlID0g
dmx2X2luaXRpYWxfcHBzX3BpcGUoZGV2X3ByaXYsIHBvcnQsCj4gPiArCQlpbnRlbF9kcC0+cHBz
X3BpcGUgPSB2bHZfaW5pdGlhbF9wcHNfcGlwZShpOTE1LCBwb3J0LAo+ID4gICAJCQkJCQkJICB2
bHZfcGlwZV9oYXNfdmRkX29uKTsKPiA+ICAgCS8qIGRpZG4ndCBmaW5kIG9uZT8gcGljayBvbmUg
d2l0aCBqdXN0IHRoZSBjb3JyZWN0IHBvcnQgKi8KPiA+ICAgCWlmIChpbnRlbF9kcC0+cHBzX3Bp
cGUgPT0gSU5WQUxJRF9QSVBFKQo+ID4gLQkJaW50ZWxfZHAtPnBwc19waXBlID0gdmx2X2luaXRp
YWxfcHBzX3BpcGUoZGV2X3ByaXYsIHBvcnQsCj4gPiArCQlpbnRlbF9kcC0+cHBzX3BpcGUgPSB2
bHZfaW5pdGlhbF9wcHNfcGlwZShpOTE1LCBwb3J0LAo+ID4gICAJCQkJCQkJICB2bHZfcGlwZV9h
bnkpOwo+ID4gICAJLyogZGlkbid0IGZpbmQgb25lPyBqdXN0IGxldCB2bHZfcG93ZXJfc2VxdWVu
Y2VyX3BpcGUoKSBwaWNrIG9uZSB3aGVuIG5lZWRlZCAqLwo+ID4gQEAgLTkxNywxMiArOTE3LDEy
IEBAIHZsdl9pbml0aWFsX3Bvd2VyX3NlcXVlbmNlcl9zZXR1cChzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwKQo+ID4gICAJaW50ZWxfZHBfaW5pdF9wYW5lbF9wb3dlcl9zZXF1ZW5jZXJfcmVnaXN0
ZXJzKGludGVsX2RwLCBmYWxzZSk7Cj4gPiAgIH0KPiA+IC12b2lkIGludGVsX3Bvd2VyX3NlcXVl
bmNlcl9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBp
bnRlbF9wb3dlcl9zZXF1ZW5jZXJfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ID4gLQlpZiAo
V0FSTl9PTighSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgJiYgIUlTX0NIRVJSWVZJRVcoZGV2X3By
aXYpICYmCj4gPiAtCQkgICAgIUlTX0dFTjlfTFAoZGV2X3ByaXYpKSkKPiA+ICsJaWYgKFdBUk5f
T04oIUlTX1ZBTExFWVZJRVcoaTkxNSkgJiYgIUlTX0NIRVJSWVZJRVcoaTkxNSkgJiYKPiA+ICsJ
CSAgICAhSVNfR0VOOV9MUChpOTE1KSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJLyoKPiA+IEBA
IC05MzUsNyArOTM1LDcgQEAgdm9pZCBpbnRlbF9wb3dlcl9zZXF1ZW5jZXJfcmVzZXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICogc2hvdWxkIHVzZSB0aGVtIGFs
d2F5cy4KPiA+ICAgCSAqLwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9kcCgmZGV2X3ByaXYtPmRybSwg
ZW5jb2Rlcikgewo+ID4gKwlmb3JfZWFjaF9pbnRlbF9kcCgmaTkxNS0+ZHJtLCBlbmNvZGVyKSB7
Cj4gPiAgIAkJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGVuY190b19pbnRlbF9kcCgmZW5j
b2Rlci0+YmFzZSk7Cj4gPiAgIAkJV0FSTl9PTihpbnRlbF9kcC0+YWN0aXZlX3BpcGUgIT0gSU5W
QUxJRF9QSVBFKTsKPiA+IEBAIC05NDMsNyArOTQzLDcgQEAgdm9pZCBpbnRlbF9wb3dlcl9zZXF1
ZW5jZXJfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCWlm
IChlbmNvZGVyLT50eXBlICE9IElOVEVMX09VVFBVVF9FRFApCj4gPiAgIAkJCWNvbnRpbnVlOwo+
ID4gLQkJaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ID4gKwkJaWYgKElTX0dFTjlfTFAoaTkx
NSkpCj4gPiAgIAkJCWludGVsX2RwLT5wcHNfcmVzZXQgPSB0cnVlOwo+ID4gICAJCWVsc2UKPiA+
ICAgCQkJaW50ZWxfZHAtPnBwc19waXBlID0gSU5WQUxJRF9QSVBFOwo+ID4gQEAgLTk2MSwxNCAr
OTYxLDE0IEBAIHN0cnVjdCBwcHNfcmVnaXN0ZXJzIHsKPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxf
cHBzX2dldF9yZWdpc3RlcnMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+ICAgCQkJCSAg
ICBzdHJ1Y3QgcHBzX3JlZ2lzdGVycyAqcmVncykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICAgCWlu
dCBwcHNfaWR4ID0gMDsKPiA+ICAgCW1lbXNldChyZWdzLCAwLCBzaXplb2YoKnJlZ3MpKTsKPiA+
IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSkK
PiA+ICAgCQlwcHNfaWR4ID0gYnh0X3Bvd2VyX3NlcXVlbmNlcl9pZHgoaW50ZWxfZHApOwo+ID4g
LQllbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9w
cml2KSkKPiA+ICsJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVX
KGk5MTUpKQo+ID4gICAJCXBwc19pZHggPSB2bHZfcG93ZXJfc2VxdWVuY2VyX3BpcGUoaW50ZWxf
ZHApOwo+ID4gICAJcmVncy0+cHBfY3RybCA9IFBQX0NPTlRST0wocHBzX2lkeCk7Cj4gPiBAQCAt
OTc3LDcgKzk3Nyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bwc19nZXRfcmVnaXN0ZXJzKHN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIAlyZWdzLT5wcF9vZmYgPSBQUF9PRkZfREVMQVlT
KHBwc19pZHgpOwo+ID4gICAJLyogQ3ljbGUgZGVsYXkgbW92ZWQgZnJvbSBQUF9ESVZJU09SIHRv
IFBQX0NPTlRST0wgKi8KPiA+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpIHx8IElOVEVMX1BD
SF9UWVBFKGRldl9wcml2KSA+PSBQQ0hfQ05QKQo+ID4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSB8
fCBJTlRFTF9QQ0hfVFlQRShpOTE1KSA+PSBQQ0hfQ05QKQo+ID4gICAJCXJlZ3MtPnBwX2RpdiA9
IElOVkFMSURfTU1JT19SRUc7Cj4gPiAgIAllbHNlCj4gPiAgIAkJcmVncy0+cHBfZGl2ID0gUFBf
RElWSVNPUihwcHNfaWR4KTsKPiA+IEBAIC0xMDEwLDE0ICsxMDEwLDE0IEBAIHN0YXRpYyBpbnQg
ZWRwX25vdGlmeV9oYW5kbGVyKHN0cnVjdCBub3RpZmllcl9ibG9jayAqdGhpcywgdW5zaWduZWQg
bG9uZyBjb2RlLAo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gY29u
dGFpbmVyX29mKHRoaXMsIHR5cGVvZigqIGludGVsX2RwKSwKPiA+ICAgCQkJCQkJIGVkcF9ub3Rp
Zmllcik7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5
MTUoaW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3Rv
X2k5MTUoaW50ZWxfZHApOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAgIAlp
ZiAoIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkgfHwgY29kZSAhPSBTWVNfUkVTVEFSVCkKPiA+
ICAgCQlyZXR1cm4gMDsKPiA+ICAgCXdpdGhfcHBzX2xvY2soaW50ZWxfZHAsIHdha2VyZWYpIHsK
PiA+IC0JCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9w
cml2KSkgewo+ID4gKwkJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhp
OTE1KSkgewo+ID4gICAJCQllbnVtIHBpcGUgcGlwZSA9IHZsdl9wb3dlcl9zZXF1ZW5jZXJfcGlw
ZShpbnRlbF9kcCk7Cj4gPiAgIAkJCWk5MTVfcmVnX3QgcHBfY3RybF9yZWcsIHBwX2Rpdl9yZWc7
Cj4gPiAgIAkJCXUzMiBwcF9kaXY7Cj4gPiBAQCAtMTAzOSwxMSArMTAzOSwxMSBAQCBzdGF0aWMg
aW50IGVkcF9ub3RpZnlfaGFuZGxlcihzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKnRoaXMsIHVuc2ln
bmVkIGxvbmcgY29kZSwKPiA+ICAgc3RhdGljIGJvb2wgZWRwX2hhdmVfcGFuZWxfcG93ZXIoc3Ry
dWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+IC0JbG9ja2RlcF9h
c3NlcnRfaGVsZCgmZGV2X3ByaXYtPnBwc19tdXRleCk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hl
bGQoJmk5MTUtPnBwc19tdXRleCk7Cj4gPiAtCWlmICgoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikg
fHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpICYmCj4gPiArCWlmICgoSVNfVkFMTEVZVklFVyhp
OTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSAmJgo+ID4gICAJICAgIGludGVsX2RwLT5wcHNf
cGlwZSA9PSBJTlZBTElEX1BJUEUpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTEwNTIs
MTEgKzEwNTIsMTEgQEAgc3RhdGljIGJvb2wgZWRwX2hhdmVfcGFuZWxfcG93ZXIoc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCkKPiA+ICAgc3RhdGljIGJvb2wgZWRwX2hhdmVfcGFuZWxfdmRkKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAtCWxvY2tkZXBf
YXNzZXJ0X2hlbGQoJmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+ID4gKwlsb2NrZGVwX2Fzc2VydF9o
ZWxkKCZpOTE1LT5wcHNfbXV0ZXgpOwo+ID4gLQlpZiAoKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYp
IHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSAmJgo+ID4gKwlpZiAoKElTX1ZBTExFWVZJRVco
aTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgJiYKPiA+ICAgCSAgICBpbnRlbF9kcC0+cHBz
X3BpcGUgPT0gSU5WQUxJRF9QSVBFKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IEBAIC0xMDY2
LDcgKzEwNjYsNyBAQCBzdGF0aWMgYm9vbCBlZHBfaGF2ZV9wYW5lbF92ZGQoc3RydWN0IGludGVs
X2RwICppbnRlbF9kcCkKPiA+ICAgc3RhdGljIHZvaWQKPiA+ICAgaW50ZWxfZHBfY2hlY2tfZWRw
KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAlpZiAo
IWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gQEAgLTExMDMs
NyArMTEwMyw3IEBAIGludGVsX2RwX2F1eF93YWl0X2RvbmUoc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCkKPiA+ICAgc3RhdGljIHUzMiBnNHhfZ2V0X2F1eF9jbG9ja19kaXZpZGVyKHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHAsIGludCBpbmRleCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICAgCWlm
IChpbmRleCkKPiA+ICAgCQlyZXR1cm4gMDsKPiA+IEBAIC0xMTEyLDEyICsxMTEyLDEyIEBAIHN0
YXRpYyB1MzIgZzR4X2dldF9hdXhfY2xvY2tfZGl2aWRlcihzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwLCBpbnQgaW5kZXgpCj4gPiAgIAkgKiBUaGUgY2xvY2sgZGl2aWRlciBpcyBiYXNlZCBvZmYg
dGhlIGhyYXdjbGssIGFuZCB3b3VsZCBsaWtlIHRvIHJ1biBhdAo+ID4gICAJICogMk1Iei4gIFNv
LCB0YWtlIHRoZSBocmF3Y2xrIHZhbHVlIGFuZCBkaXZpZGUgYnkgMjAwMCBhbmQgdXNlIHRoYXQK
PiA+ICAgCSAqLwo+ID4gLQlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QoZGV2X3ByaXYtPnJhd2Ns
a19mcmVxLCAyMDAwKTsKPiA+ICsJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKGk5MTUtPnJhd2Ns
a19mcmVxLCAyMDAwKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdTMyIGlsa19nZXRfYXV4X2Nsb2Nr
X2RpdmlkZXIoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgaW50IGluZGV4KQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxf
ZHApOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50
ZWxfZHApOwo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90
b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gPiAgIAlpZiAoaW5kZXgpCj4gPiBAQCAtMTEyOSwxNyAr
MTEyOSwxNyBAQCBzdGF0aWMgdTMyIGlsa19nZXRfYXV4X2Nsb2NrX2RpdmlkZXIoc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCwgaW50IGluZGV4KQo+ID4gICAJICogZGl2aWRlIGJ5IDIwMDAgYW5k
IHVzZSB0aGF0Cj4gPiAgIAkgKi8KPiA+ICAgCWlmIChkaWdfcG9ydC0+YXV4X2NoID09IEFVWF9D
SF9BKQo+ID4gLQkJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKGRldl9wcml2LT5jZGNsay5ody5j
ZGNsaywgMjAwMCk7Cj4gPiArCQlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QoaTkxNS0+Y2RjbGsu
aHcuY2RjbGssIDIwMDApOwo+ID4gICAJZWxzZQo+ID4gLQkJcmV0dXJuIERJVl9ST1VORF9DTE9T
RVNUKGRldl9wcml2LT5yYXdjbGtfZnJlcSwgMjAwMCk7Cj4gPiArCQlyZXR1cm4gRElWX1JPVU5E
X0NMT1NFU1QoaTkxNS0+cmF3Y2xrX2ZyZXEsIDIwMDApOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB1
MzIgaHN3X2dldF9hdXhfY2xvY2tfZGl2aWRlcihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCBp
bnQgaW5kZXgpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9w
b3J0ICpkaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiA+IC0JaWYgKGRpZ19w
b3J0LT5hdXhfY2ggIT0gQVVYX0NIX0EgJiYgSEFTX1BDSF9MUFRfSChkZXZfcHJpdikpIHsKPiA+
ICsJaWYgKGRpZ19wb3J0LT5hdXhfY2ggIT0gQVVYX0NIX0EgJiYgSEFTX1BDSF9MUFRfSChpOTE1
KSkgewo+ID4gICAJCS8qIFdvcmthcm91bmQgZm9yIG5vbi1VTFQgSFNXICovCj4gPiAgIAkJc3dp
dGNoIChpbmRleCkgewo+ID4gICAJCWNhc2UgMDogcmV0dXJuIDYzOwo+ID4gQEAgLTExNjYsMTYg
KzExNjYsMTYgQEAgc3RhdGljIHUzMiBnNHhfZ2V0X2F1eF9zZW5kX2N0bChzdHJ1Y3QgaW50ZWxf
ZHAgKmludGVsX2RwLAo+ID4gICAJCQkJdTMyIGF1eF9jbG9ja19kaXZpZGVyKQo+ID4gICB7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCA9IGRwX3RvX2Rp
Z19wb3J0KGludGVsX2RwKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ID4gICAJCQl0b19pOTE1
KGludGVsX2RpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiA+ICAgCXUzMiBwcmVjaGFyZ2UsIHRp
bWVvdXQ7Cj4gPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDYpKQo+ID4gKwlpZiAoSVNfR0VOKGk5
MTUsIDYpKQo+ID4gICAJCXByZWNoYXJnZSA9IDM7Cj4gPiAgIAllbHNlCj4gPiAgIAkJcHJlY2hh
cmdlID0gNTsKPiA+IC0JaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpCj4gPiArCWlmIChJU19C
Uk9BRFdFTEwoaTkxNSkpCj4gPiAgIAkJdGltZW91dCA9IERQX0FVWF9DSF9DVExfVElNRV9PVVRf
NjAwdXM7Cj4gPiAgIAllbHNlCj4gPiAgIAkJdGltZW91dCA9IERQX0FVWF9DSF9DVExfVElNRV9P
VVRfNDAwdXM7Cj4gPiBAQCAtMTQ4MSw3ICsxNDgxLDcgQEAgaW50ZWxfZHBfYXV4X3RyYW5zZmVy
KHN0cnVjdCBkcm1fZHBfYXV4ICphdXgsIHN0cnVjdCBkcm1fZHBfYXV4X21zZyAqbXNnKQo+ID4g
ICBzdGF0aWMgaTkxNV9yZWdfdCBnNHhfYXV4X2N0bF9yZWcoc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBk
cF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmRpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ID4gICAJZW51bSBhdXhfY2gg
YXV4X2NoID0gZGlnX3BvcnQtPmF1eF9jaDsKPiA+IEBAIC0xNDk4LDcgKzE0OTgsNyBAQCBzdGF0
aWMgaTkxNV9yZWdfdCBnNHhfYXV4X2N0bF9yZWcoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkK
PiA+ICAgc3RhdGljIGk5MTVfcmVnX3QgZzR4X2F1eF9kYXRhX3JlZyhzdHJ1Y3QgaW50ZWxfZHAg
KmludGVsX2RwLCBpbnQgaW5kZXgpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiA+
ICAgCWVudW0gYXV4X2NoIGF1eF9jaCA9IGRpZ19wb3J0LT5hdXhfY2g7Cj4gPiBAQCAtMTUxNSw3
ICsxNTE1LDcgQEAgc3RhdGljIGk5MTVfcmVnX3QgZzR4X2F1eF9kYXRhX3JlZyhzdHJ1Y3QgaW50
ZWxfZHAgKmludGVsX2RwLCBpbnQgaW5kZXgpCj4gPiAgIHN0YXRpYyBpOTE1X3JlZ190IGlsa19h
dXhfY3RsX3JlZyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+
ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90b19kaWdfcG9y
dChpbnRlbF9kcCk7Cj4gPiAgIAllbnVtIGF1eF9jaCBhdXhfY2ggPSBkaWdfcG9ydC0+YXV4X2No
Owo+ID4gQEAgLTE1MzQsNyArMTUzNCw3IEBAIHN0YXRpYyBpOTE1X3JlZ190IGlsa19hdXhfY3Rs
X3JlZyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICBzdGF0aWMgaTkxNV9yZWdfdCBp
bGtfYXV4X2RhdGFfcmVnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIGludCBpbmRleCkKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1
KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19p
OTE1KGludGVsX2RwKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0
ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ID4gICAJZW51bSBhdXhfY2ggYXV4X2NoID0g
ZGlnX3BvcnQtPmF1eF9jaDsKPiA+IEBAIC0xNTUzLDcgKzE1NTMsNyBAQCBzdGF0aWMgaTkxNV9y
ZWdfdCBpbGtfYXV4X2RhdGFfcmVnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIGludCBpbmRl
eCkKPiA+ICAgc3RhdGljIGk5MTVfcmVnX3Qgc2tsX2F1eF9jdGxfcmVnKHN0cnVjdCBpbnRlbF9k
cCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRh
bF9wb3J0ICpkaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiA+ICAgCWVudW0g
YXV4X2NoIGF1eF9jaCA9IGRpZ19wb3J0LT5hdXhfY2g7Cj4gPiBAQCAtMTU3Myw3ICsxNTczLDcg
QEAgc3RhdGljIGk5MTVfcmVnX3Qgc2tsX2F1eF9jdGxfcmVnKHN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHApCj4gPiAgIHN0YXRpYyBpOTE1X3JlZ190IHNrbF9hdXhfZGF0YV9yZWcoc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCwgaW50IGluZGV4KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gICAJc3Ry
dWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9k
cCk7Cj4gPiAgIAllbnVtIGF1eF9jaCBhdXhfY2ggPSBkaWdfcG9ydC0+YXV4X2NoOwo+ID4gQEAg
LTE2MDAsMTQgKzE2MDAsMTQgQEAgaW50ZWxfZHBfYXV4X2Zpbmkoc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCkKPiA+ICAgc3RhdGljIHZvaWQKPiA+ICAgaW50ZWxfZHBfYXV4X2luaXQoc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ID4g
ICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIgPSAmZGlnX3BvcnQtPmJhc2U7Cj4gPiAt
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1
KSA+PSA5KSB7Cj4gPiAgIAkJaW50ZWxfZHAtPmF1eF9jaF9jdGxfcmVnID0gc2tsX2F1eF9jdGxf
cmVnOwo+ID4gICAJCWludGVsX2RwLT5hdXhfY2hfZGF0YV9yZWcgPSBza2xfYXV4X2RhdGFfcmVn
Owo+ID4gLQl9IGVsc2UgaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxz
ZSBpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkgewo+ID4gICAJCWludGVsX2RwLT5hdXhfY2hfY3Rs
X3JlZyA9IGlsa19hdXhfY3RsX3JlZzsKPiA+ICAgCQlpbnRlbF9kcC0+YXV4X2NoX2RhdGFfcmVn
ID0gaWxrX2F1eF9kYXRhX3JlZzsKPiA+ICAgCX0gZWxzZSB7Cj4gPiBAQCAtMTYxNSwxNiArMTYx
NSwxNiBAQCBpbnRlbF9kcF9hdXhfaW5pdChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4g
ICAJCWludGVsX2RwLT5hdXhfY2hfZGF0YV9yZWcgPSBnNHhfYXV4X2RhdGFfcmVnOwo+ID4gICAJ
fQo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQo+ID4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDkpCj4gPiAgIAkJaW50ZWxfZHAtPmdldF9hdXhfY2xvY2tfZGl2aWRlciA9IHNr
bF9nZXRfYXV4X2Nsb2NrX2RpdmlkZXI7Cj4gPiAtCWVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZf
cHJpdikgfHwgSVNfSEFTV0VMTChkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElTX0JST0FEV0VM
TChpOTE1KSB8fCBJU19IQVNXRUxMKGk5MTUpKQo+ID4gICAJCWludGVsX2RwLT5nZXRfYXV4X2Ns
b2NrX2RpdmlkZXIgPSBoc3dfZ2V0X2F1eF9jbG9ja19kaXZpZGVyOwo+ID4gLQllbHNlIGlmIChI
QVNfUENIX1NQTElUKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSEFTX1BDSF9TUExJVChpOTE1
KSkKPiA+ICAgCQlpbnRlbF9kcC0+Z2V0X2F1eF9jbG9ja19kaXZpZGVyID0gaWxrX2dldF9hdXhf
Y2xvY2tfZGl2aWRlcjsKPiA+ICAgCWVsc2UKPiA+ICAgCQlpbnRlbF9kcC0+Z2V0X2F1eF9jbG9j
a19kaXZpZGVyID0gZzR4X2dldF9hdXhfY2xvY2tfZGl2aWRlcjsKPiA+IC0JaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gOSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gICAJ
CWludGVsX2RwLT5nZXRfYXV4X3NlbmRfY3RsID0gc2tsX2dldF9hdXhfc2VuZF9jdGw7Cj4gPiAg
IAllbHNlCj4gPiAgIAkJaW50ZWxfZHAtPmdldF9hdXhfc2VuZF9jdGwgPSBnNHhfZ2V0X2F1eF9z
ZW5kX2N0bDsKPiA+IEBAIC0xNjU1LDIwICsxNjU1LDIwIEBAIHN0YXRpYyB2b2lkCj4gPiAgIGlu
dGVsX2RwX3NldF9jbG9jayhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkg
ICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZHBfbGlua19kcGxsICpkaXZpc29yID0g
TlVMTDsKPiA+ICAgCWludCBpLCBjb3VudCA9IDA7Cj4gPiAtCWlmIChJU19HNFgoZGV2X3ByaXYp
KSB7Cj4gPiArCWlmIChJU19HNFgoaTkxNSkpIHsKPiA+ICAgCQlkaXZpc29yID0gZzR4X2RwbGw7
Cj4gPiAgIAkJY291bnQgPSBBUlJBWV9TSVpFKGc0eF9kcGxsKTsKPiA+IC0JfSBlbHNlIGlmIChI
QVNfUENIX1NQTElUKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKEhBU19QQ0hfU1BMSVQo
aTkxNSkpIHsKPiA+ICAgCQlkaXZpc29yID0gcGNoX2RwbGw7Cj4gPiAgIAkJY291bnQgPSBBUlJB
WV9TSVpFKHBjaF9kcGxsKTsKPiA+IC0JfSBlbHNlIGlmIChJU19DSEVSUllWSUVXKGRldl9wcml2
KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+ICAgCQlkaXZp
c29yID0gY2h2X2RwbGw7Cj4gPiAgIAkJY291bnQgPSBBUlJBWV9TSVpFKGNodl9kcGxsKTsKPiA+
IC0JfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYg
KElTX1ZBTExFWVZJRVcoaTkxNSkpIHsKPiA+ICAgCQlkaXZpc29yID0gdmx2X2RwbGw7Cj4gPiAg
IAkJY291bnQgPSBBUlJBWV9TSVpFKHZsdl9kcGxsKTsKPiA+ICAgCX0KPiA+IEBAIC0xNzYwLDkg
KzE3NjAsOSBAQCB2b2lkIGludGVsX2RwX2NvbXB1dGVfcmF0ZShzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwLCBpbnQgcG9ydF9jbG9jaywKPiA+ICAgc3RhdGljIGJvb2wgaW50ZWxfZHBfc291cmNl
X3N1cHBvcnRzX2ZlYyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ID4gICAJCQkJCSBjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7
Cj4gPiAtCXJldHVybiBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExICYmCj4gPiArCXJldHVybiBJ
TlRFTF9HRU4oaTkxNSkgPj0gMTEgJiYKPiA+ICAgCQlwaXBlX2NvbmZpZy0+Y3B1X3RyYW5zY29k
ZXIgIT0gVFJBTlNDT0RFUl9BOwo+ID4gICB9Cj4gPiBAQCAtMTc3Niw5ICsxNzc2LDkgQEAgc3Rh
dGljIGJvb2wgaW50ZWxfZHBfc3VwcG9ydHNfZmVjKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAs
Cj4gPiAgIHN0YXRpYyBib29sIGludGVsX2RwX3NvdXJjZV9zdXBwb3J0c19kc2Moc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCwKPiA+ICAgCQkJCQkgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKnBpcGVfY29uZmlnKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gLQlyZXR1cm4gSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMCAmJgo+ID4gKwlyZXR1cm4gSU5URUxfR0VOKGk5MTUpID49IDEwICYm
Cj4gPiAgIAkJcGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVyICE9IFRSQU5TQ09ERVJfQTsKPiA+
ICAgfQo+ID4gQEAgLTE3OTUsNyArMTc5NSw3IEBAIHN0YXRpYyBib29sIGludGVsX2RwX3N1cHBv
cnRzX2RzYyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ID4gICBzdGF0aWMgaW50IGludGVs
X2RwX2NvbXB1dGVfYnBwKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIAkJCQlzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICppbnRlbF9jb25uZWN0b3IgPSBpbnRlbF9kcC0+YXR0
YWNoZWRfY29ubmVjdG9yOwo+ID4gICAJaW50IGJwcCwgYnBjOwo+ID4gQEAgLTE4MDgsMTAgKzE4
MDgsMTAgQEAgc3RhdGljIGludCBpbnRlbF9kcF9jb21wdXRlX2JwcChzdHJ1Y3QgaW50ZWxfZHAg
KmludGVsX2RwLAo+ID4gICAJaWYgKGludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpIHsKPiA+ICAg
CQkvKiBHZXQgYnBwIGZyb20gdmJ0IG9ubHkgZm9yIHBhbmVscyB0aGF0IGRvbnQgaGF2ZSBicHAg
aW4gZWRpZCAqLwo+ID4gICAJCWlmIChpbnRlbF9jb25uZWN0b3ItPmJhc2UuZGlzcGxheV9pbmZv
LmJwYyA9PSAwICYmCj4gPiAtCQkgICAgZGV2X3ByaXYtPnZidC5lZHAuYnBwICYmIGRldl9wcml2
LT52YnQuZWRwLmJwcCA8IGJwcCkgewo+ID4gKwkJICAgIGk5MTUtPnZidC5lZHAuYnBwICYmIGk5
MTUtPnZidC5lZHAuYnBwIDwgYnBwKSB7Cj4gPiAgIAkJCURSTV9ERUJVR19LTVMoImNsYW1waW5n
IGJwcCBmb3IgZURQIHBhbmVsIHRvIEJJT1MtcHJvdmlkZWQgJWlcbiIsCj4gPiAtCQkJCSAgICAg
IGRldl9wcml2LT52YnQuZWRwLmJwcCk7Cj4gPiAtCQkJYnBwID0gZGV2X3ByaXYtPnZidC5lZHAu
YnBwOwo+ID4gKwkJCQkgICAgICBpOTE1LT52YnQuZWRwLmJwcCk7Cj4gPiArCQkJYnBwID0gaTkx
NS0+dmJ0LmVkcC5icHA7Cj4gPiAgIAkJfQo+ID4gICAJfQo+ID4gQEAgLTE5MjQsNyArMTkyNCw3
IEBAIHN0YXRpYyBpbnQgaW50ZWxfZHBfZHNjX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9k
cCAqaW50ZWxfZHAsCj4gPiAgIAkJCQkgICAgICAgc3RydWN0IGxpbmtfY29uZmlnX2xpbWl0cyAq
bGltaXRzKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9y
dCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNl
LmRldik7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZw
aXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ID4gICAJdTggZHNjX21heF9icGM7Cj4g
PiAgIAlpbnQgcGlwZV9icHA7Cj4gPiBAQCAtMTk4OCw3ICsxOTg4LDcgQEAgc3RhdGljIGludCBp
bnRlbF9kcF9kc2NfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+
ICAgCSAqIGlzIGdyZWF0ZXIgdGhhbiB0aGUgbWF4aW11bSBDZGNsb2NrIGFuZCBpZiBzbGljZSBj
b3VudCBpcyBldmVuCj4gPiAgIAkgKiB0aGVuIHdlIG5lZWQgdG8gdXNlIDIgVkRTQyBpbnN0YW5j
ZXMuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKGFkanVzdGVkX21vZGUtPmNydGNfY2xvY2sgPiBkZXZf
cHJpdi0+bWF4X2NkY2xrX2ZyZXEpIHsKPiA+ICsJaWYgKGFkanVzdGVkX21vZGUtPmNydGNfY2xv
Y2sgPiBpOTE1LT5tYXhfY2RjbGtfZnJlcSkgewo+ID4gICAJCWlmIChwaXBlX2NvbmZpZy0+ZHNj
X3BhcmFtcy5zbGljZV9jb3VudCA+IDEpIHsKPiA+ICAgCQkJcGlwZV9jb25maWctPmRzY19wYXJh
bXMuZHNjX3NwbGl0ID0gdHJ1ZTsKPiA+ICAgCQl9IGVsc2Ugewo+ID4gQEAgLTIxNjgsNyArMjE2
OCw3IEBAIGludGVsX2RwX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAo+ID4gICAJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gPiAg
IAkJCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVk
X21vZGUgPSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2UpOwo+ID4g
ICAJc3RydWN0IGludGVsX2xzcGNvbiAqbHNwY29uID0gZW5jX3RvX2ludGVsX2xzcGNvbigmZW5j
b2Rlci0+YmFzZSk7Cj4gPiBAQCAtMjE4MSw3ICsyMTgxLDcgQEAgaW50ZWxfZHBfY29tcHV0ZV9j
b25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkJICAgRFBfRFBD
RF9RVUlSS19DT05TVEFOVF9OKTsKPiA+ICAgCWludCByZXQgPSAwLCBvdXRwdXRfYnBwOwo+ID4g
LQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikgJiYgIUhBU19EREkoZGV2X3ByaXYpICYmIHBv
cnQgIT0gUE9SVF9BKQo+ID4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1KSAmJiAhSEFTX0RESShp
OTE1KSAmJiBwb3J0ICE9IFBPUlRfQSkKPiA+ICAgCQlwaXBlX2NvbmZpZy0+aGFzX3BjaF9lbmNv
ZGVyID0gdHJ1ZTsKPiA+ICAgCXBpcGVfY29uZmlnLT5vdXRwdXRfZm9ybWF0ID0gSU5URUxfT1VU
UFVUX0ZPUk1BVF9SR0I7Cj4gPiBAQCAtMjE5NSw3ICsyMTk1LDcgQEAgaW50ZWxfZHBfY29tcHV0
ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJcmV0dXJuIHJl
dDsKPiA+ICAgCXBpcGVfY29uZmlnLT5oYXNfZHJycyA9IGZhbHNlOwo+ID4gLQlpZiAoSVNfRzRY
KGRldl9wcml2KSB8fCBwb3J0ID09IFBPUlRfQSkKPiA+ICsJaWYgKElTX0c0WChpOTE1KSB8fCBw
b3J0ID09IFBPUlRfQSkKPiA+ICAgCQlwaXBlX2NvbmZpZy0+aGFzX2F1ZGlvID0gZmFsc2U7Cj4g
PiAgIAllbHNlIGlmIChpbnRlbF9jb25uX3N0YXRlLT5mb3JjZV9hdWRpbyA9PSBIRE1JX0FVRElP
X0FVVE8pCj4gPiAgIAkJcGlwZV9jb25maWctPmhhc19hdWRpbyA9IGludGVsX2RwLT5oYXNfYXVk
aW87Cj4gPiBAQCAtMjIwNiwxMyArMjIwNiwxMyBAQCBpbnRlbF9kcF9jb21wdXRlX2NvbmZpZyhz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQlpbnRlbF9maXhlZF9wYW5lbF9t
b2RlKGludGVsX2Nvbm5lY3Rvci0+cGFuZWwuZml4ZWRfbW9kZSwKPiA+ICAgCQkJCSAgICAgICBh
ZGp1c3RlZF9tb2RlKTsKPiA+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKPiA+
ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkgewo+ID4gICAJCQlyZXQgPSBza2xfdXBkYXRl
X3NjYWxlcl9jcnRjKHBpcGVfY29uZmlnKTsKPiA+ICAgCQkJaWYgKHJldCkKPiA+ICAgCQkJCXJl
dHVybiByZXQ7Cj4gPiAgIAkJfQo+ID4gLQkJaWYgKEhBU19HTUNIKGRldl9wcml2KSkKPiA+ICsJ
CWlmIChIQVNfR01DSChpOTE1KSkKPiA+ICAgCQkJaW50ZWxfZ21jaF9wYW5lbF9maXR0aW5nKGlu
dGVsX2NydGMsIHBpcGVfY29uZmlnLAo+ID4gICAJCQkJCQkgY29ubl9zdGF0ZS0+c2NhbGluZ19t
b2RlKTsKPiA+ICAgCQllbHNlCj4gPiBAQCAtMjIyMyw3ICsyMjIzLDcgQEAgaW50ZWxfZHBfY29t
cHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAlpZiAoYWRq
dXN0ZWRfbW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0RCTFNDQU4pCj4gPiAgIAkJcmV0dXJu
IC1FSU5WQUw7Cj4gPiAtCWlmIChIQVNfR01DSChkZXZfcHJpdikgJiYKPiA+ICsJaWYgKEhBU19H
TUNIKGk5MTUpICYmCj4gPiAgIAkgICAgYWRqdXN0ZWRfbW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9G
TEFHX0lOVEVSTEFDRSkKPiA+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+IEBAIC0yMjUwLDcgKzIy
NTAsNyBAQCBpbnRlbF9kcF9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPiA+ICAgCQkJICAgICAgIGNvbnN0YW50X24pOwo+ID4gICAJaWYgKGludGVsX2Nvbm5l
Y3Rvci0+cGFuZWwuZG93bmNsb2NrX21vZGUgIT0gTlVMTCAmJgo+ID4gLQkJZGV2X3ByaXYtPmRy
cnMudHlwZSA9PSBTRUFNTEVTU19EUlJTX1NVUFBPUlQpIHsKPiA+ICsJCWk5MTUtPmRycnMudHlw
ZSA9PSBTRUFNTEVTU19EUlJTX1NVUFBPUlQpIHsKPiA+ICAgCQkJcGlwZV9jb25maWctPmhhc19k
cnJzID0gdHJ1ZTsKPiA+ICAgCQkJaW50ZWxfbGlua19jb21wdXRlX21fbihvdXRwdXRfYnBwLAo+
ID4gICAJCQkJCSAgICAgICBwaXBlX2NvbmZpZy0+bGFuZV9jb3VudCwKPiA+IEBAIC0yMjYwLDcg
KzIyNjAsNyBAQCBpbnRlbF9kcF9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKPiA+ICAgCQkJCQkgICAgICAgY29uc3RhbnRfbik7Cj4gPiAgIAl9Cj4gPiAtCWlm
ICghSEFTX0RESShkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX0RESShpOTE1KSkKPiA+ICAgCQlp
bnRlbF9kcF9zZXRfY2xvY2soZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ID4gICAJaW50ZWxfcHNy
X2NvbXB1dGVfY29uZmlnKGludGVsX2RwLCBwaXBlX2NvbmZpZyk7Cj4gPiBAQCAtMjI4MSw3ICsy
MjgxLDcgQEAgdm9pZCBpbnRlbF9kcF9zZXRfbGlua19wYXJhbXMoc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCwKPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfZHBfcHJlcGFyZShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNl
KTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsK
PiA+IEBAIC0yMzIwLDcgKzIzMjAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kcF9wcmVwYXJlKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJLyogU3BsaXQgb3V0IHRoZSBJQlgv
Q1BVIHZzIENQVCBzZXR0aW5ncyAqLwo+ID4gLQlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSAm
JiBwb3J0ID09IFBPUlRfQSkgewo+ID4gKwlpZiAoSVNfSVZZQlJJREdFKGk5MTUpICYmIHBvcnQg
PT0gUE9SVF9BKSB7Cj4gPiAgIAkJaWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVf
RkxBR19QSFNZTkMpCj4gPiAgIAkJCWludGVsX2RwLT5EUCB8PSBEUF9TWU5DX0hTX0hJR0g7Cj4g
PiAgIAkJaWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19QVlNZTkMpCj4g
PiBAQCAtMjMzMSw3ICsyMzMxLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHBfcHJlcGFyZShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJaW50ZWxfZHAtPkRQIHw9IERQX0VO
SEFOQ0VEX0ZSQU1JTkc7Cj4gPiAgIAkJaW50ZWxfZHAtPkRQIHw9IERQX1BJUEVfU0VMX0lWQihj
cnRjLT5waXBlKTsKPiA+IC0JfSBlbHNlIGlmIChIQVNfUENIX0NQVChkZXZfcHJpdikgJiYgcG9y
dCAhPSBQT1JUX0EpIHsKPiA+ICsJfSBlbHNlIGlmIChIQVNfUENIX0NQVChpOTE1KSAmJiBwb3J0
ICE9IFBPUlRfQSkgewo+ID4gICAJCXUzMiB0cmFuc19kcDsKPiA+ICAgCQlpbnRlbF9kcC0+RFAg
fD0gRFBfTElOS19UUkFJTl9PRkZfQ1BUOwo+ID4gQEAgLTIzNDMsNyArMjM0Myw3IEBAIHN0YXRp
YyB2b2lkIGludGVsX2RwX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
PiAgIAkJCXRyYW5zX2RwICY9IH5UUkFOU19EUF9FTkhfRlJBTUlORzsKPiA+ICAgCQlJOTE1X1dS
SVRFKFRSQU5TX0RQX0NUTChjcnRjLT5waXBlKSwgdHJhbnNfZHApOwo+ID4gICAJfSBlbHNlIHsK
PiA+IC0JCWlmIChJU19HNFgoZGV2X3ByaXYpICYmIHBpcGVfY29uZmlnLT5saW1pdGVkX2NvbG9y
X3JhbmdlKQo+ID4gKwkJaWYgKElTX0c0WChpOTE1KSAmJiBwaXBlX2NvbmZpZy0+bGltaXRlZF9j
b2xvcl9yYW5nZSkKPiA+ICAgCQkJaW50ZWxfZHAtPkRQIHw9IERQX0NPTE9SX1JBTkdFXzE2XzIz
NTsKPiA+ICAgCQlpZiAoYWRqdXN0ZWRfbW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX1BIU1lO
QykKPiA+IEBAIC0yMzU1LDcgKzIzNTUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kcF9wcmVwYXJl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCWlmIChkcm1fZHBfZW5oYW5j
ZWRfZnJhbWVfY2FwKGludGVsX2RwLT5kcGNkKSkKPiA+ICAgCQkJaW50ZWxfZHAtPkRQIHw9IERQ
X0VOSEFOQ0VEX0ZSQU1JTkc7Cj4gPiAtCQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4g
PiArCQlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICAgCQkJaW50ZWxfZHAtPkRQIHw9IERQ
X1BJUEVfU0VMX0NIVihjcnRjLT5waXBlKTsKPiA+ICAgCQllbHNlCj4gPiAgIAkJCWludGVsX2Rw
LT5EUCB8PSBEUF9QSVBFX1NFTChjcnRjLT5waXBlKTsKPiA+IEBAIC0yMzc3LDEwICsyMzc3LDEw
IEBAIHN0YXRpYyB2b2lkIHdhaXRfcGFuZWxfc3RhdHVzKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHAsCj4gPiAgIAkJCQkgICAgICAgdTMyIG1hc2ssCj4gPiAgIAkJCQkgICAgICAgdTMyIHZhbHVl
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3Rv
X2k5MTUoaW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRw
X3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gICAJaTkxNV9yZWdfdCBwcF9zdGF0X3JlZywgcHBfY3Ry
bF9yZWc7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+
ID4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5wcHNfbXV0ZXgpOwo+ID4gICAJaW50ZWxf
cHBzX3ZlcmlmeV9zdGF0ZShpbnRlbF9kcCk7Cj4gPiBAQCAtMjM5Miw3ICsyMzkyLDcgQEAgc3Rh
dGljIHZvaWQgd2FpdF9wYW5lbF9zdGF0dXMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+
ICAgCQkJSTkxNV9SRUFEKHBwX3N0YXRfcmVnKSwKPiA+ICAgCQkJSTkxNV9SRUFEKHBwX2N0cmxf
cmVnKSk7Cj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29y
ZSwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gPiAg
IAkJCQkgICAgcHBfc3RhdF9yZWcsIG1hc2ssIHZhbHVlLAo+ID4gICAJCQkJICAgIDUwMDApKQo+
ID4gICAJCURSTV9FUlJPUigiUGFuZWwgc3RhdHVzIHRpbWVvdXQ6IHN0YXR1cyAlMDh4IGNvbnRy
b2wgJTA4eFxuIiwKPiA+IEBAIC0yNDUzLDEzICsyNDUzLDEzIEBAIHN0YXRpYyB2b2lkIGVkcF93
YWl0X2JhY2tsaWdodF9vZmYoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgc3RhdGlj
ICB1MzIgaXJvbmxha2VfZ2V0X3BwX2NvbnRyb2woc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19p
OTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90
b19pOTE1KGludGVsX2RwKTsKPiA+ICAgCXUzMiBjb250cm9sOwo+ID4gLQlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZkZXZfcHJpdi0+cHBzX211dGV4KTsKPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgm
aTkxNS0+cHBzX211dGV4KTsKPiA+ICAgCWNvbnRyb2wgPSBJOTE1X1JFQUQoX3BwX2N0cmxfcmVn
KGludGVsX2RwKSk7Cj4gPiAtCWlmIChXQVJOX09OKCFIQVNfRERJKGRldl9wcml2KSAmJgo+ID4g
KwlpZiAoV0FSTl9PTighSEFTX0RESShpOTE1KSAmJgo+ID4gICAJCSAgICAoY29udHJvbCAmIFBB
TkVMX1VOTE9DS19NQVNLKSAhPSBQQU5FTF9VTkxPQ0tfUkVHUykpIHsKPiA+ICAgCQljb250cm9s
ICY9IH5QQU5FTF9VTkxPQ0tfTUFTSzsKPiA+ICAgCQljb250cm9sIHw9IFBBTkVMX1VOTE9DS19S
RUdTOwo+ID4gQEAgLTI0NzQsMTMgKzI0NzQsMTMgQEAgc3RhdGljICB1MzIgaXJvbmxha2VfZ2V0
X3BwX2NvbnRyb2woc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgICovCj4gPiAgIHN0
YXRpYyBib29sIGVkcF9wYW5lbF92ZGRfb24oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1
KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19p
OTE1KGludGVsX2RwKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2Rp
Z19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ID4gICAJdTMyIHBwOwo+ID4gICAJ
aTkxNV9yZWdfdCBwcF9zdGF0X3JlZywgcHBfY3RybF9yZWc7Cj4gPiAgIAlib29sIG5lZWRfdG9f
ZGlzYWJsZSA9ICFpbnRlbF9kcC0+d2FudF9wYW5lbF92ZGQ7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+ID4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZp
OTE1LT5wcHNfbXV0ZXgpOwo+ID4gICAJaWYgKCFpbnRlbF9kcF9pc19lZHAoaW50ZWxfZHApKQo+
ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IEBAIC0yNDkxLDcgKzI0OTEsNyBAQCBzdGF0aWMgYm9v
bCBlZHBfcGFuZWxfdmRkX29uKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIAlpZiAo
ZWRwX2hhdmVfcGFuZWxfdmRkKGludGVsX2RwKSkKPiA+ICAgCQlyZXR1cm4gbmVlZF90b19kaXNh
YmxlOwo+ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwKPiA+ICsJaW50ZWxf
ZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwKPiA+ICAgCQkJCWludGVsX2F1eF9wb3dlcl9kb21haW4o
aW50ZWxfZGlnX3BvcnQpKTsKPiA+ICAgCURSTV9ERUJVR19LTVMoIlR1cm5pbmcgZURQIHBvcnQg
JWMgVkREIG9uXG4iLAo+ID4gQEAgLTI1NDYsMTMgKzI1NDYsMTMgQEAgdm9pZCBpbnRlbF9lZHBf
cGFuZWxfdmRkX29uKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHN0YXRpYyB2b2lk
IGVkcF9wYW5lbF92ZGRfb2ZmX3N5bmMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGlu
dGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1
KGludGVsX2RwKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19w
b3J0ID0KPiA+ICAgCQlkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gPiAgIAl1MzIgcHA7Cj4g
PiAgIAlpOTE1X3JlZ190IHBwX3N0YXRfcmVnLCBwcF9jdHJsX3JlZzsKPiA+IC0JbG9ja2RlcF9h
c3NlcnRfaGVsZCgmZGV2X3ByaXYtPnBwc19tdXRleCk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hl
bGQoJmk5MTUtPnBwc19tdXRleCk7Cj4gPiAgIAlXQVJOX09OKGludGVsX2RwLT53YW50X3BhbmVs
X3ZkZCk7Cj4gPiBAQCAtMjU3OCw3ICsyNTc4LDcgQEAgc3RhdGljIHZvaWQgZWRwX3BhbmVsX3Zk
ZF9vZmZfc3luYyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICAJaWYgKChwcCAmIFBB
TkVMX1BPV0VSX09OKSA9PSAwKQo+ID4gICAJCWludGVsX2RwLT5wYW5lbF9wb3dlcl9vZmZfdGlt
ZSA9IGt0aW1lX2dldF9ib290dGltZSgpOwo+ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF91
bmNoZWNrZWQoZGV2X3ByaXYsCj4gPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tl
ZChpOTE1LAo+ID4gICAJCQkJCSAgaW50ZWxfYXV4X3Bvd2VyX2RvbWFpbihpbnRlbF9kaWdfcG9y
dCkpOwo+ID4gICB9Cj4gPiBAQCAtMjYxNSw5ICsyNjE1LDkgQEAgc3RhdGljIHZvaWQgZWRwX3Bh
bmVsX3ZkZF9zY2hlZHVsZV9vZmYoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgICov
Cj4gPiAgIHN0YXRpYyB2b2lkIGVkcF9wYW5lbF92ZGRfb2ZmKHN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHAsIGJvb2wgc3luYykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+IC0JbG9ja2RlcF9hc3NlcnRf
aGVsZCgmZGV2X3ByaXYtPnBwc19tdXRleCk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5
MTUtPnBwc19tdXRleCk7Cj4gPiAgIAlpZiAoIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpCj4g
PiAgIAkJcmV0dXJuOwo+ID4gQEAgLTI2MzUsMTEgKzI2MzUsMTEgQEAgc3RhdGljIHZvaWQgZWRw
X3BhbmVsX3ZkZF9vZmYoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgYm9vbCBzeW5jKQo+ID4g
ICBzdGF0aWMgdm9pZCBlZHBfcGFuZWxfb24oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1
KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19p
OTE1KGludGVsX2RwKTsKPiA+ICAgCXUzMiBwcDsKPiA+ICAgCWk5MTVfcmVnX3QgcHBfY3RybF9y
ZWc7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+ID4g
Kwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5wcHNfbXV0ZXgpOwo+ID4gICAJaWYgKCFpbnRl
bF9kcF9pc19lZHAoaW50ZWxfZHApKQo+ID4gICAJCXJldHVybjsKPiA+IEBAIC0yNjU2LDcgKzI2
NTYsNyBAQCBzdGF0aWMgdm9pZCBlZHBfcGFuZWxfb24oc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCkKPiA+ICAgCXBwX2N0cmxfcmVnID0gX3BwX2N0cmxfcmVnKGludGVsX2RwKTsKPiA+ICAgCXBw
ID0gaXJvbmxha2VfZ2V0X3BwX2NvbnRyb2woaW50ZWxfZHApOwo+ID4gLQlpZiAoSVNfR0VOKGRl
dl9wcml2LCA1KSkgewo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDUpKSB7Cj4gPiAgIAkJLyogSUxL
IHdvcmthcm91bmQ6IGRpc2FibGUgcmVzZXQgYXJvdW5kIHBvd2VyIHNlcXVlbmNlICovCj4gPiAg
IAkJcHAgJj0gflBBTkVMX1BPV0VSX1JFU0VUOwo+ID4gICAJCUk5MTVfV1JJVEUocHBfY3RybF9y
ZWcsIHBwKTsKPiA+IEBAIC0yNjY0LDcgKzI2NjQsNyBAQCBzdGF0aWMgdm9pZCBlZHBfcGFuZWxf
b24oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgCX0KPiA+ICAgCXBwIHw9IFBBTkVM
X1BPV0VSX09OOwo+ID4gLQlpZiAoIUlTX0dFTihkZXZfcHJpdiwgNSkpCj4gPiArCWlmICghSVNf
R0VOKGk5MTUsIDUpKQo+ID4gICAJCXBwIHw9IFBBTkVMX1BPV0VSX1JFU0VUOwo+ID4gICAJSTkx
NV9XUklURShwcF9jdHJsX3JlZywgcHApOwo+ID4gQEAgLTI2NzMsNyArMjY3Myw3IEBAIHN0YXRp
YyB2b2lkIGVkcF9wYW5lbF9vbihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICAJd2Fp
dF9wYW5lbF9vbihpbnRlbF9kcCk7Cj4gPiAgIAlpbnRlbF9kcC0+bGFzdF9wb3dlcl9vbiA9IGpp
ZmZpZXM7Cj4gPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDUpKSB7Cj4gPiArCWlmIChJU19HRU4o
aTkxNSwgNSkpIHsKPiA+ICAgCQlwcCB8PSBQQU5FTF9QT1dFUl9SRVNFVDsgLyogcmVzdG9yZSBw
YW5lbCByZXNldCBiaXQgKi8KPiA+ICAgCQlJOTE1X1dSSVRFKHBwX2N0cmxfcmVnLCBwcCk7Cj4g
PiAgIAkJUE9TVElOR19SRUFEKHBwX2N0cmxfcmVnKTsKPiA+IEBAIC0yNjk0LDEyICsyNjk0LDEy
IEBAIHZvaWQgaW50ZWxfZWRwX3BhbmVsX29uKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4g
PiAgIHN0YXRpYyB2b2lkIGVkcF9wYW5lbF9vZmYoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19p
OTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90
b19pOTE1KGludGVsX2RwKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19w
b3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ID4gICAJdTMyIHBwOwo+ID4gICAJaTkx
NV9yZWdfdCBwcF9jdHJsX3JlZzsKPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYt
PnBwc19tdXRleCk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPnBwc19tdXRleCk7
Cj4gPiAgIAlpZiAoIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpCj4gPiAgIAkJcmV0dXJuOwo+
ID4gQEAgLTI3MjcsNyArMjcyNyw3IEBAIHN0YXRpYyB2b2lkIGVkcF9wYW5lbF9vZmYoc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgCWludGVsX2RwLT5wYW5lbF9wb3dlcl9vZmZfdGlt
ZSA9IGt0aW1lX2dldF9ib290dGltZSgpOwo+ID4gICAJLyogV2UgZ290IGEgcmVmZXJlbmNlIHdo
ZW4gd2UgZW5hYmxlZCB0aGUgVkRELiAqLwo+ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF91
bmNoZWNrZWQoZGV2X3ByaXYsIGludGVsX2F1eF9wb3dlcl9kb21haW4oZGlnX3BvcnQpKTsKPiA+
ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKGk5MTUsIGludGVsX2F1eF9wb3dl
cl9kb21haW4oZGlnX3BvcnQpKTsKPiA+ICAgfQo+ID4gICB2b2lkIGludGVsX2VkcF9wYW5lbF9v
ZmYoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+IEBAIC0yNzQ0LDcgKzI3NDQsNyBAQCB2
b2lkIGludGVsX2VkcF9wYW5lbF9vZmYoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAg
LyogRW5hYmxlIGJhY2tsaWdodCBpbiB0aGUgcGFuZWwgcG93ZXIgY29udHJvbC4gKi8KPiA+ICAg
c3RhdGljIHZvaWQgX2ludGVsX2VkcF9iYWNrbGlnaHRfb24oc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBk
cF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+
ID4gICAJLyoKPiA+IEBAIC0yNzg1LDcgKzI3ODUsNyBAQCB2b2lkIGludGVsX2VkcF9iYWNrbGln
aHRfb24oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIC8q
IERpc2FibGUgYmFja2xpZ2h0IGluIHRoZSBwYW5lbCBwb3dlciBjb250cm9sLiAqLwo+ID4gICBz
dGF0aWMgdm9pZCBfaW50ZWxfZWRwX2JhY2tsaWdodF9vZmYoc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBk
cF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+
ID4gICAJaWYgKCFpbnRlbF9kcF9pc19lZHAoaW50ZWxfZHApKQo+ID4gQEAgLTI4NDksNyArMjg0
OSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2VkcF9iYWNrbGlnaHRfcG93ZXIoc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ID4gICBzdGF0aWMgdm9pZCBhc3NlcnRfZHBfcG9ydChz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCBib29sIHN0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2Rw
KTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkaWdf
cG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gPiAgIAlib29sIGN1cl9zdGF0
ZSA9IEk5MTVfUkVBRChpbnRlbF9kcC0+b3V0cHV0X3JlZykgJiBEUF9QT1JUX0VOOwo+ID4gICAJ
STkxNV9TVEFURV9XQVJOKGN1cl9zdGF0ZSAhPSBzdGF0ZSwKPiA+IEBAIC0yODU5LDcgKzI4NTks
NyBAQCBzdGF0aWMgdm9pZCBhc3NlcnRfZHBfcG9ydChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
LCBib29sIHN0YXRlKQo+ID4gICB9Cj4gPiAgICNkZWZpbmUgYXNzZXJ0X2RwX3BvcnRfZGlzYWJs
ZWQoZCkgYXNzZXJ0X2RwX3BvcnQoKGQpLCBmYWxzZSkKPiA+IC1zdGF0aWMgdm9pZCBhc3NlcnRf
ZWRwX3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgc3RhdGUpCj4g
PiArc3RhdGljIHZvaWQgYXNzZXJ0X2VkcF9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsIGJvb2wgc3RhdGUpCj4gPiAgIHsKPiA+ICAgCWJvb2wgY3VyX3N0YXRlID0gSTkxNV9SRUFE
KERQX0EpICYgRFBfUExMX0VOQUJMRTsKPiA+IEBAIC0yODc0LDExICsyODc0LDExIEBAIHN0YXRp
YyB2b2lkIGlyb25sYWtlX2VkcF9wbGxfb24oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+
ICAgCQkJCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAg
ewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29u
ZmlnLT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+IC0JYXNzZXJ0X3BpcGVfZGlzYWJs
ZWQoZGV2X3ByaXYsIGNydGMtPnBpcGUpOwo+ID4gKwlhc3NlcnRfcGlwZV9kaXNhYmxlZChpOTE1
LCBjcnRjLT5waXBlKTsKPiA+ICAgCWFzc2VydF9kcF9wb3J0X2Rpc2FibGVkKGludGVsX2RwKTsK
PiA+IC0JYXNzZXJ0X2VkcF9wbGxfZGlzYWJsZWQoZGV2X3ByaXYpOwo+ID4gKwlhc3NlcnRfZWRw
X3BsbF9kaXNhYmxlZChpOTE1KTsKPiA+ICAgCURSTV9ERUJVR19LTVMoImVuYWJsaW5nIGVEUCBQ
TEwgZm9yIGNsb2NrICVkXG4iLAo+ID4gICAJCSAgICAgIHBpcGVfY29uZmlnLT5wb3J0X2Nsb2Nr
KTsKPiA+IEBAIC0yOTAwLDggKzI5MDAsOCBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9lZHBfcGxs
X29uKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIAkgKiAxLiBXYWl0IGZvciB0aGUg
c3RhcnQgb2YgdmVydGljYWwgYmxhbmsgb24gdGhlIGVuYWJsZWQgcGlwZSBnb2luZyB0byBGREkK
PiA+ICAgCSAqIDIuIFByb2dyYW0gRFAgUExMIGVuYWJsZQo+ID4gICAJICovCj4gPiAtCWlmIChJ
U19HRU4oZGV2X3ByaXYsIDUpKQo+ID4gLQkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rX2lmX2FjdGl2
ZShkZXZfcHJpdiwgIWNydGMtPnBpcGUpOwo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDUpKQo+ID4g
KwkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rX2lmX2FjdGl2ZShpOTE1LCAhY3J0Yy0+cGlwZSk7Cj4g
PiAgIAlpbnRlbF9kcC0+RFAgfD0gRFBfUExMX0VOQUJMRTsKPiA+IEBAIC0yOTE0LDExICsyOTE0
LDExIEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2VkcF9wbGxfb2ZmKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHAsCj4gPiAgIAkJCQkgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4g
LQlhc3NlcnRfcGlwZV9kaXNhYmxlZChkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4gPiArCWFzc2Vy
dF9waXBlX2Rpc2FibGVkKGk5MTUsIGNydGMtPnBpcGUpOwo+ID4gICAJYXNzZXJ0X2RwX3BvcnRf
ZGlzYWJsZWQoaW50ZWxfZHApOwo+ID4gLQlhc3NlcnRfZWRwX3BsbF9lbmFibGVkKGRldl9wcml2
KTsKPiA+ICsJYXNzZXJ0X2VkcF9wbGxfZW5hYmxlZChpOTE1KTsKPiA+ICAgCURSTV9ERUJVR19L
TVMoImRpc2FibGluZyBlRFAgUExMXG4iKTsKPiA+IEBAIC0yOTk5LDEyICsyOTk5LDEyIEBAIHZv
aWQgaW50ZWxfZHBfc2lua19kcG1zKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIGludCBtb2Rl
KQo+ID4gICAJCQkgICAgICBtb2RlID09IERSTV9NT0RFX0RQTVNfT04gPyAiZW5hYmxlIiA6ICJk
aXNhYmxlIik7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBjcHRfZHBfcG9ydF9zZWxlY3RlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGJvb2wgY3B0X2Rw
X3BvcnRfc2VsZWN0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkg
ZW51bSBwb3J0IHBvcnQsIGVudW0gcGlwZSAqcGlwZSkKPiA+ICAgewo+ID4gICAJZW51bSBwaXBl
IHA7Cj4gPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHApIHsKPiA+ICsJZm9yX2VhY2hfcGlw
ZShpOTE1LCBwKSB7Cj4gPiAgIAkJdTMyIHZhbCA9IEk5MTVfUkVBRChUUkFOU19EUF9DVEwocCkp
Owo+ID4gICAJCWlmICgodmFsICYgVFJBTlNfRFBfUE9SVF9TRUxfTUFTSykgPT0gVFJBTlNfRFBf
UE9SVF9TRUwocG9ydCkpIHsKPiA+IEBAIC0zMDIxLDcgKzMwMjEsNyBAQCBzdGF0aWMgYm9vbCBj
cHRfZHBfcG9ydF9zZWxlY3RlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiAgIAlyZXR1cm4gZmFsc2U7Cj4gPiAgIH0KPiA+IC1ib29sIGludGVsX2RwX3BvcnRfZW5hYmxl
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArYm9vbCBpbnRlbF9kcF9w
b3J0X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgIGk5
MTVfcmVnX3QgZHBfcmVnLCBlbnVtIHBvcnQgcG9ydCwKPiA+ICAgCQkJICAgZW51bSBwaXBlICpw
aXBlKQo+ID4gICB7Cj4gPiBAQCAtMzAzMywxMSArMzAzMywxMSBAQCBib29sIGludGVsX2RwX3Bv
cnRfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXQg
PSB2YWwgJiBEUF9QT1JUX0VOOwo+ID4gICAJLyogYXNzZXJ0cyB3YW50IHRvIGtub3cgdGhlIHBp
cGUgZXZlbiBpZiB0aGUgcG9ydCBpcyBkaXNhYmxlZCAqLwo+ID4gLQlpZiAoSVNfSVZZQlJJREdF
KGRldl9wcml2KSAmJiBwb3J0ID09IFBPUlRfQSkKPiA+ICsJaWYgKElTX0lWWUJSSURHRShpOTE1
KSAmJiBwb3J0ID09IFBPUlRfQSkKPiA+ICAgCQkqcGlwZSA9ICh2YWwgJiBEUF9QSVBFX1NFTF9N
QVNLX0lWQikgPj4gRFBfUElQRV9TRUxfU0hJRlRfSVZCOwo+ID4gLQllbHNlIGlmIChIQVNfUENI
X0NQVChkZXZfcHJpdikgJiYgcG9ydCAhPSBQT1JUX0EpCj4gPiAtCQlyZXQgJj0gY3B0X2RwX3Bv
cnRfc2VsZWN0ZWQoZGV2X3ByaXYsIHBvcnQsIHBpcGUpOwo+ID4gLQllbHNlIGlmIChJU19DSEVS
UllWSUVXKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSEFTX1BDSF9DUFQoaTkxNSkgJiYgcG9y
dCAhPSBQT1JUX0EpCj4gPiArCQlyZXQgJj0gY3B0X2RwX3BvcnRfc2VsZWN0ZWQoaTkxNSwgcG9y
dCwgcGlwZSk7Cj4gPiArCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJKnBp
cGUgPSAodmFsICYgRFBfUElQRV9TRUxfTUFTS19DSFYpID4+IERQX1BJUEVfU0VMX1NISUZUX0NI
VjsKPiA+ICAgCWVsc2UKPiA+ICAgCQkqcGlwZSA9ICh2YWwgJiBEUF9QSVBFX1NFTF9NQVNLKSA+
PiBEUF9QSVBFX1NFTF9TSElGVDsKPiA+IEBAIC0zMDQ4LDIwICszMDQ4LDIwIEBAIGJvb2wgaW50
ZWxfZHBfcG9ydF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICAgc3RhdGljIGJvb2wgaW50ZWxfZHBfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ID4gICAJCQkJICBlbnVtIHBpcGUgKnBpcGUpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2lu
dGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+
ID4gICAJYm9vbCByZXQ7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9p
Zl9lbmFibGVkKGRldl9wcml2LAo+ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9n
ZXRfaWZfZW5hYmxlZChpOTE1LAo+ID4gICAJCQkJCQkgICAgIGVuY29kZXItPnBvd2VyX2RvbWFp
bik7Cj4gPiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gLQlyZXQg
PSBpbnRlbF9kcF9wb3J0X2VuYWJsZWQoZGV2X3ByaXYsIGludGVsX2RwLT5vdXRwdXRfcmVnLAo+
ID4gKwlyZXQgPSBpbnRlbF9kcF9wb3J0X2VuYWJsZWQoaTkxNSwgaW50ZWxfZHAtPm91dHB1dF9y
ZWcsCj4gPiAgIAkJCQkgICAgZW5jb2Rlci0+cG9ydCwgcGlwZSk7Cj4gPiAtCWludGVsX2Rpc3Bs
YXlfcG93ZXJfcHV0KGRldl9wcml2LCBlbmNvZGVyLT5wb3dlcl9kb21haW4sIHdha2VyZWYpOwo+
ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBlbmNvZGVyLT5wb3dlcl9kb21haW4s
IHdha2VyZWYpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTMwNjksNyArMzA2
OSw3IEBAIHN0YXRpYyBib29sIGludGVsX2RwX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfZHBfZ2V0X2NvbmZpZyhzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2Up
Owo+ID4gICAJdTMyIHRtcCwgZmxhZ3MgPSAwOwo+ID4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNv
ZGVyLT5wb3J0Owo+ID4gQEAgLTMwODQsNyArMzA4NCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rw
X2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAlwaXBlX2Nv
bmZpZy0+aGFzX2F1ZGlvID0gdG1wICYgRFBfQVVESU9fT1VUUFVUX0VOQUJMRSAmJiBwb3J0ICE9
IFBPUlRfQTsKPiA+IC0JaWYgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSAmJiBwb3J0ICE9IFBPUlRf
QSkgewo+ID4gKwlpZiAoSEFTX1BDSF9DUFQoaTkxNSkgJiYgcG9ydCAhPSBQT1JUX0EpIHsKPiA+
ICAgCQl1MzIgdHJhbnNfZHAgPSBJOTE1X1JFQUQoVFJBTlNfRFBfQ1RMKGNydGMtPnBpcGUpKTsK
PiA+ICAgCQlpZiAodHJhbnNfZHAgJiBUUkFOU19EUF9IU1lOQ19BQ1RJVkVfSElHSCkKPiA+IEBA
IC0zMTEwLDcgKzMxMTAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kcF9nZXRfY29uZmlnKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJcGlwZV9jb25maWctPmJhc2UuYWRqdXN0
ZWRfbW9kZS5mbGFncyB8PSBmbGFnczsKPiA+IC0JaWYgKElTX0c0WChkZXZfcHJpdikgJiYgdG1w
ICYgRFBfQ09MT1JfUkFOR0VfMTZfMjM1KQo+ID4gKwlpZiAoSVNfRzRYKGk5MTUpICYmIHRtcCAm
IERQX0NPTE9SX1JBTkdFXzE2XzIzNSkKPiA+ICAgCQlwaXBlX2NvbmZpZy0+bGltaXRlZF9jb2xv
cl9yYW5nZSA9IHRydWU7Cj4gPiAgIAlwaXBlX2NvbmZpZy0+bGFuZV9jb3VudCA9Cj4gPiBAQCAt
MzEyOSw4ICszMTI5LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZHBfZ2V0X2NvbmZpZyhzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQlpbnRlbF9kb3RjbG9ja19jYWxjdWxhdGUo
cGlwZV9jb25maWctPnBvcnRfY2xvY2ssCj4gPiAgIAkJCQkJICZwaXBlX2NvbmZpZy0+ZHBfbV9u
KTsKPiA+IC0JaWYgKGludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkgJiYgZGV2X3ByaXYtPnZidC5l
ZHAuYnBwICYmCj4gPiAtCSAgICBwaXBlX2NvbmZpZy0+cGlwZV9icHAgPiBkZXZfcHJpdi0+dmJ0
LmVkcC5icHApIHsKPiA+ICsJaWYgKGludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkgJiYgaTkxNS0+
dmJ0LmVkcC5icHAgJiYKPiA+ICsJICAgIHBpcGVfY29uZmlnLT5waXBlX2JwcCA+IGk5MTUtPnZi
dC5lZHAuYnBwKSB7Cj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBUaGlzIGlzIGEgYmlnIGZhdCB1Z2x5
IGhhY2suCj4gPiAgIAkJICoKPiA+IEBAIC0zMTQ1LDggKzMxNDUsOCBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9kcF9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJ
CSAqIGxvYWQuCj4gPiAgIAkJICovCj4gPiAgIAkJRFJNX0RFQlVHX0tNUygicGlwZSBoYXMgJWQg
YnBwIGZvciBlRFAgcGFuZWwsIG92ZXJyaWRpbmcgQklPUy1wcm92aWRlZCBtYXggJWQgYnBwXG4i
LAo+ID4gLQkJCSAgICAgIHBpcGVfY29uZmlnLT5waXBlX2JwcCwgZGV2X3ByaXYtPnZidC5lZHAu
YnBwKTsKPiA+IC0JCWRldl9wcml2LT52YnQuZWRwLmJwcCA9IHBpcGVfY29uZmlnLT5waXBlX2Jw
cDsKPiA+ICsJCQkgICAgICBwaXBlX2NvbmZpZy0+cGlwZV9icHAsIGk5MTUtPnZidC5lZHAuYnBw
KTsKPiA+ICsJCWk5MTUtPnZidC5lZHAuYnBwID0gcGlwZV9jb25maWctPnBpcGVfYnBwOwo+ID4g
ICAJfQo+ID4gICB9Cj4gPiBAQCAtMzIxNSwxNiArMzIxNSwxNiBAQCBzdGF0aWMgdm9pZCBjaHZf
cG9zdF9kaXNhYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJ
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ID4gICAJCQkJ
Y29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJaW50ZWxfZHBfbGlua19kb3duKGVuY29kZXIs
IG9sZF9jcnRjX3N0YXRlKTsKPiA+IC0Jdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKPiA+ICsJdmx2
X2RwaW9fZ2V0KGk5MTUpOwo+ID4gICAJLyogQXNzZXJ0IGRhdGEgbGFuZSByZXNldCAqLwo+ID4g
ICAJY2h2X2RhdGFfbGFuZV9zb2Z0X3Jlc2V0KGVuY29kZXIsIG9sZF9jcnRjX3N0YXRlLCB0cnVl
KTsKPiA+IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKPiA+ICsJdmx2X2RwaW9fcHV0KGk5MTUp
Owo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkCj4gPiBAQCAtMzIzMiw3ICszMjMyLDcgQEAgX2lu
dGVsX2RwX3NldF9saW5rX3RyYWluKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIAkJ
CSB1MzIgKkRQLAo+ID4gICAJCQkgdTggZHBfdHJhaW5fcGF0KQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+
ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBkcF90b19k
aWdfcG9ydChpbnRlbF9kcCk7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGludGVsX2RpZ19wb3J0
LT5iYXNlLnBvcnQ7Cj4gPiAgIAl1OCB0cmFpbl9wYXRfbWFzayA9IGRybV9kcF90cmFpbmluZ19w
YXR0ZXJuX21hc2soaW50ZWxfZHAtPmRwY2QpOwo+ID4gQEAgLTMyNDEsNyArMzI0MSw3IEBAIF9p
bnRlbF9kcF9zZXRfbGlua190cmFpbihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ID4gICAJ
CURSTV9ERUJVR19LTVMoIlVzaW5nIERQIHRyYWluaW5nIHBhdHRlcm4gVFBTJWRcbiIsCj4gPiAg
IAkJCSAgICAgIGRwX3RyYWluX3BhdCAmIHRyYWluX3BhdF9tYXNrKTsKPiA+IC0JaWYgKEhBU19E
REkoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChIQVNfRERJKGk5MTUpKSB7Cj4gPiAgIAkJdTMyIHRl
bXAgPSBJOTE1X1JFQUQoRFBfVFBfQ1RMKHBvcnQpKTsKPiA+ICAgCQlpZiAoZHBfdHJhaW5fcGF0
ICYgRFBfTElOS19TQ1JBTUJMSU5HX0RJU0FCTEUpCj4gPiBAQCAtMzI3MCw4ICszMjcwLDggQEAg
X2ludGVsX2RwX3NldF9saW5rX3RyYWluKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAg
IAkJfQo+ID4gICAJCUk5MTVfV1JJVEUoRFBfVFBfQ1RMKHBvcnQpLCB0ZW1wKTsKPiA+IC0JfSBl
bHNlIGlmICgoSVNfSVZZQlJJREdFKGRldl9wcml2KSAmJiBwb3J0ID09IFBPUlRfQSkgfHwKPiA+
IC0JCSAgIChIQVNfUENIX0NQVChkZXZfcHJpdikgJiYgcG9ydCAhPSBQT1JUX0EpKSB7Cj4gPiAr
CX0gZWxzZSBpZiAoKElTX0lWWUJSSURHRShpOTE1KSAmJiBwb3J0ID09IFBPUlRfQSkgfHwKPiA+
ICsJCSAgIChIQVNfUENIX0NQVChpOTE1KSAmJiBwb3J0ICE9IFBPUlRfQSkpIHsKPiA+ICAgCQkq
RFAgJj0gfkRQX0xJTktfVFJBSU5fTUFTS19DUFQ7Cj4gPiAgIAkJc3dpdGNoIChkcF90cmFpbl9w
YXQgJiBEUF9UUkFJTklOR19QQVRURVJOX01BU0spIHsKPiA+IEBAIC0zMzE0LDcgKzMzMTQsNyBA
QCBfaW50ZWxfZHBfc2V0X2xpbmtfdHJhaW4oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+
ICAgc3RhdGljIHZvaWQgaW50ZWxfZHBfZW5hYmxlX3BvcnQoc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCwKPiA+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNf
c3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
ZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAkvKiBlbmFibGUgd2l0aCBwYXR0ZXJuIDEg
KGFzIHBlciBzcGVjKSAqLwo+ID4gQEAgLTMzMzgsNyArMzMzOCw3IEBAIHN0YXRpYyB2b2lkIGlu
dGVsX2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiA+ICAgCQkJICAg
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGVu
Y190b19pbnRlbF9kcCgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gPiAgIAl1MzIg
ZHBfcmVnID0gSTkxNV9SRUFEKGludGVsX2RwLT5vdXRwdXRfcmVnKTsKPiA+IEBAIC0zMzQ5LDcg
KzMzNDksNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfZHAoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJd2l0aF9wcHNfbG9jayhpbnRlbF9k
cCwgd2FrZXJlZikgewo+ID4gLQkJaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NI
RVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwkJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNf
Q0hFUlJZVklFVyhpOTE1KSkKPiA+ICAgCQkJdmx2X2luaXRfcGFuZWxfcG93ZXJfc2VxdWVuY2Vy
KGVuY29kZXIsIHBpcGVfY29uZmlnKTsKPiA+ICAgCQlpbnRlbF9kcF9lbmFibGVfcG9ydChpbnRl
bF9kcCwgcGlwZV9jb25maWcpOwo+ID4gQEAgLTMzNTksMTMgKzMzNTksMTMgQEAgc3RhdGljIHZv
aWQgaW50ZWxfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJ
CWVkcF9wYW5lbF92ZGRfb2ZmKGludGVsX2RwLCB0cnVlKTsKPiA+ICAgCX0KPiA+IC0JaWYgKElT
X1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiAr
CWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+ICAg
CQl1bnNpZ25lZCBpbnQgbGFuZV9tYXNrID0gMHgwOwo+ID4gLQkJaWYgKElTX0NIRVJSWVZJRVco
ZGV2X3ByaXYpKQo+ID4gKwkJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJCWxhbmVf
bWFzayA9IGludGVsX2RwX3VudXNlZF9sYW5lX21hc2socGlwZV9jb25maWctPmxhbmVfY291bnQp
Owo+ID4gLQkJdmx2X3dhaXRfcG9ydF9yZWFkeShkZXZfcHJpdiwgZHBfdG9fZGlnX3BvcnQoaW50
ZWxfZHApLAo+ID4gKwkJdmx2X3dhaXRfcG9ydF9yZWFkeShpOTE1LCBkcF90b19kaWdfcG9ydChp
bnRlbF9kcCksCj4gPiAgIAkJCQkgICAgbGFuZV9tYXNrKTsKPiA+ICAgCX0KPiA+IEBAIC0zNDEy
LDcgKzM0MTIsNyBAQCBzdGF0aWMgdm9pZCBnNHhfcHJlX2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIHZvaWQgdmx2X2RldGFjaF9wb3dlcl9zZXF1
ZW5jZXIoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9k
cCk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoaW50
ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+ID4gICAJ
ZW51bSBwaXBlIHBpcGUgPSBpbnRlbF9kcC0+cHBzX3BpcGU7Cj4gPiAgIAlpOTE1X3JlZ190IHBw
X29uX3JlZyA9IFBQX09OX0RFTEFZUyhwaXBlKTsKPiA+IEBAIC0zNDQwLDE0ICszNDQwLDE0IEBA
IHN0YXRpYyB2b2lkIHZsdl9kZXRhY2hfcG93ZXJfc2VxdWVuY2VyKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHApCj4gPiAgIAlpbnRlbF9kcC0+cHBzX3BpcGUgPSBJTlZBTElEX1BJUEU7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCB2bHZfc3RlYWxfcG93ZXJfc2VxdWVuY2VyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCB2bHZfc3RlYWxfcG93ZXJf
c2VxdWVuY2VyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAg
ZW51bSBwaXBlIHBpcGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyOwo+ID4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+cHBzX211dGV4KTsKPiA+
ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+cHBzX211dGV4KTsKPiA+IC0JZm9yX2VhY2hf
aW50ZWxfZHAoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsKPiA+ICsJZm9yX2VhY2hfaW50ZWxf
ZHAoJmk5MTUtPmRybSwgZW5jb2Rlcikgewo+ID4gICAJCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2UpOwo+ID4gICAJCWVudW0gcG9ydCBw
b3J0ID0gZW5jb2Rlci0+cG9ydDsKPiA+IEBAIC0zNDY5LDExICszNDY5LDExIEBAIHN0YXRpYyB2
b2lkIHZsdl9zdGVhbF9wb3dlcl9zZXF1ZW5jZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICBzdGF0aWMgdm9pZCB2bHZfaW5pdF9wYW5lbF9wb3dlcl9zZXF1ZW5jZXIo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkJICAgY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKCZl
bmNvZGVyLT5iYXNlKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZk
ZXZfcHJpdi0+cHBzX211dGV4KTsKPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+cHBz
X211dGV4KTsKPiA+ICAgCVdBUk5fT04oaW50ZWxfZHAtPmFjdGl2ZV9waXBlICE9IElOVkFMSURf
UElQRSk7Cj4gPiBAQCAtMzQ5MSw3ICszNDkxLDcgQEAgc3RhdGljIHZvaWQgdmx2X2luaXRfcGFu
ZWxfcG93ZXJfc2VxdWVuY2VyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJ
ICogV2UgbWF5IGJlIHN0ZWFsaW5nIHRoZSBwb3dlcgo+ID4gICAJICogc2VxdWVuY2VyIGZyb20g
YW5vdGhlciBwb3J0Lgo+ID4gICAJICovCj4gPiAtCXZsdl9zdGVhbF9wb3dlcl9zZXF1ZW5jZXIo
ZGV2X3ByaXYsIGNydGMtPnBpcGUpOwo+ID4gKwl2bHZfc3RlYWxfcG93ZXJfc2VxdWVuY2VyKGk5
MTUsIGNydGMtPnBpcGUpOwo+ID4gICAJaW50ZWxfZHAtPmFjdGl2ZV9waXBlID0gY3J0Yy0+cGlw
ZTsKPiA+IEBAIC0zNTcwLDE3ICszNTcwLDE3IEBAIGludGVsX2RwX2dldF9saW5rX3N0YXR1cyhz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLCB1OCBsaW5rX3N0YXR1c1tEUF9MSU5LX1NUQVRVCj4g
PiAgIHU4Cj4gPiAgIGludGVsX2RwX3ZvbHRhZ2VfbWF4KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHApCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBf
dG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
ZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciA9ICZkcF90b19kaWdfcG9ydChpbnRlbF9kcCktPmJhc2U7Cj4gPiAgIAllbnVtIHBvcnQgcG9y
dCA9IGVuY29kZXItPnBvcnQ7Cj4gPiAtCWlmIChIQVNfRERJKGRldl9wcml2KSkKPiA+ICsJaWYg
KEhBU19EREkoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIGludGVsX2RkaV9kcF92b2x0YWdlX21heChl
bmNvZGVyKTsKPiA+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwg
SVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICAgCQlyZXR1cm4gRFBfVFJBSU5fVk9MVEFHRV9TV0lO
R19MRVZFTF8zOwo+ID4gLQllbHNlIGlmIChJU19JVllCUklER0UoZGV2X3ByaXYpICYmIHBvcnQg
PT0gUE9SVF9BKQo+ID4gKwllbHNlIGlmIChJU19JVllCUklER0UoaTkxNSkgJiYgcG9ydCA9PSBQ
T1JUX0EpCj4gPiAgIAkJcmV0dXJuIERQX1RSQUlOX1ZPTFRBR0VfU1dJTkdfTEVWRUxfMjsKPiA+
IC0JZWxzZSBpZiAoSEFTX1BDSF9DUFQoZGV2X3ByaXYpICYmIHBvcnQgIT0gUE9SVF9BKQo+ID4g
KwllbHNlIGlmIChIQVNfUENIX0NQVChpOTE1KSAmJiBwb3J0ICE9IFBPUlRfQSkKPiA+ICAgCQly
ZXR1cm4gRFBfVFJBSU5fVk9MVEFHRV9TV0lOR19MRVZFTF8zOwo+ID4gICAJZWxzZQo+ID4gICAJ
CXJldHVybiBEUF9UUkFJTl9WT0xUQUdFX1NXSU5HX0xFVkVMXzI7Cj4gPiBAQCAtMzU4OSwxMyAr
MzU4OSwxMyBAQCBpbnRlbF9kcF92b2x0YWdlX21heChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
KQo+ID4gICB1OAo+ID4gICBpbnRlbF9kcF9wcmVfZW1waGFzaXNfbWF4KHN0cnVjdCBpbnRlbF9k
cCAqaW50ZWxfZHAsIHU4IHZvbHRhZ2Vfc3dpbmcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciA9ICZkcF90b19kaWdfcG9ydChpbnRlbF9kcCkt
PmJhc2U7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4gPiAtCWlmIChI
QVNfRERJKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX0RESShpOTE1KSkgewo+ID4gICAJCXJl
dHVybiBpbnRlbF9kZGlfZHBfcHJlX2VtcGhhc2lzX21heChlbmNvZGVyLCB2b2x0YWdlX3N3aW5n
KTsKPiA+IC0JfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllW
SUVXKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwg
SVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ID4gICAJCXN3aXRjaCAodm9sdGFnZV9zd2luZyAmIERQ
X1RSQUlOX1ZPTFRBR0VfU1dJTkdfTUFTSykgewo+ID4gICAJCWNhc2UgRFBfVFJBSU5fVk9MVEFH
RV9TV0lOR19MRVZFTF8wOgo+ID4gICAJCQlyZXR1cm4gRFBfVFJBSU5fUFJFX0VNUEhfTEVWRUxf
MzsKPiA+IEBAIC0zNjA3LDcgKzM2MDcsNyBAQCBpbnRlbF9kcF9wcmVfZW1waGFzaXNfbWF4KHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIHU4IHZvbHRhZ2Vfc3dpbmcpCj4gPiAgIAkJZGVmYXVs
dDoKPiA+ICAgCQkJcmV0dXJuIERQX1RSQUlOX1BSRV9FTVBIX0xFVkVMXzA7Cj4gPiAgIAkJfQo+
ID4gLQl9IGVsc2UgaWYgKElTX0lWWUJSSURHRShkZXZfcHJpdikgJiYgcG9ydCA9PSBQT1JUX0Ep
IHsKPiA+ICsJfSBlbHNlIGlmIChJU19JVllCUklER0UoaTkxNSkgJiYgcG9ydCA9PSBQT1JUX0Ep
IHsKPiA+ICAgCQlzd2l0Y2ggKHZvbHRhZ2Vfc3dpbmcgJiBEUF9UUkFJTl9WT0xUQUdFX1NXSU5H
X01BU0spIHsKPiA+ICAgCQljYXNlIERQX1RSQUlOX1ZPTFRBR0VfU1dJTkdfTEVWRUxfMDoKPiA+
ICAgCQkJcmV0dXJuIERQX1RSQUlOX1BSRV9FTVBIX0xFVkVMXzI7Cj4gPiBAQCAtMzkwMSwyNSAr
MzkwMSwyNSBAQCBpdmJfY3B1X2VkcF9zaWduYWxfbGV2ZWxzKHU4IHRyYWluX3NldCkKPiA+ICAg
dm9pZAo+ID4gICBpbnRlbF9kcF9zZXRfc2lnbmFsX2xldmVscyhzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9y
dCAqaW50ZWxfZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gPiAgIAllbnVt
IHBvcnQgcG9ydCA9IGludGVsX2RpZ19wb3J0LT5iYXNlLnBvcnQ7Cj4gPiAgIAl1MzIgc2lnbmFs
X2xldmVscywgbWFzayA9IDA7Cj4gPiAgIAl1OCB0cmFpbl9zZXQgPSBpbnRlbF9kcC0+dHJhaW5f
c2V0WzBdOwo+ID4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikgfHwgSU5URUxfR0VOKGRldl9w
cml2KSA+PSAxMCkgewo+ID4gKwlpZiAoSVNfR0VOOV9MUChpOTE1KSB8fCBJTlRFTF9HRU4oaTkx
NSkgPj0gMTApIHsKPiA+ICAgCQlzaWduYWxfbGV2ZWxzID0gYnh0X3NpZ25hbF9sZXZlbHMoaW50
ZWxfZHApOwo+ID4gLQl9IGVsc2UgaWYgKEhBU19EREkoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxz
ZSBpZiAoSEFTX0RESShpOTE1KSkgewo+ID4gICAJCXNpZ25hbF9sZXZlbHMgPSBkZGlfc2lnbmFs
X2xldmVscyhpbnRlbF9kcCk7Cj4gPiAgIAkJbWFzayA9IERESV9CVUZfRU1QX01BU0s7Cj4gPiAt
CX0gZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJ
U19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiAgIAkJc2lnbmFsX2xldmVscyA9IGNodl9zaWduYWxf
bGV2ZWxzKGludGVsX2RwKTsKPiA+IC0JfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2
KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpIHsKPiA+ICAgCQlzaWdu
YWxfbGV2ZWxzID0gdmx2X3NpZ25hbF9sZXZlbHMoaW50ZWxfZHApOwo+ID4gLQl9IGVsc2UgaWYg
KElTX0lWWUJSSURHRShkZXZfcHJpdikgJiYgcG9ydCA9PSBQT1JUX0EpIHsKPiA+ICsJfSBlbHNl
IGlmIChJU19JVllCUklER0UoaTkxNSkgJiYgcG9ydCA9PSBQT1JUX0EpIHsKPiA+ICAgCQlzaWdu
YWxfbGV2ZWxzID0gaXZiX2NwdV9lZHBfc2lnbmFsX2xldmVscyh0cmFpbl9zZXQpOwo+ID4gICAJ
CW1hc2sgPSBFRFBfTElOS19UUkFJTl9WT0xfRU1QX01BU0tfSVZCOwo+ID4gLQl9IGVsc2UgaWYg
KElTX0dFTihkZXZfcHJpdiwgNikgJiYgcG9ydCA9PSBQT1JUX0EpIHsKPiA+ICsJfSBlbHNlIGlm
IChJU19HRU4oaTkxNSwgNikgJiYgcG9ydCA9PSBQT1JUX0EpIHsKPiA+ICAgCQlzaWduYWxfbGV2
ZWxzID0gc25iX2NwdV9lZHBfc2lnbmFsX2xldmVscyh0cmFpbl9zZXQpOwo+ID4gICAJCW1hc2sg
PSBFRFBfTElOS19UUkFJTl9WT0xfRU1QX01BU0tfU05COwo+ID4gICAJfSBlbHNlIHsKPiA+IEBA
IC0zOTQ3LDcgKzM5NDcsNyBAQCBpbnRlbF9kcF9wcm9ncmFtX2xpbmtfdHJhaW5pbmdfcGF0dGVy
bihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ID4gICAJCQkJICAgICAgIHU4IGRwX3RyYWlu
X3BhdCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGln
X3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0K
PiA+ICAgCQl0b19pOTE1KGludGVsX2RpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiA+ICAgCV9p
bnRlbF9kcF9zZXRfbGlua190cmFpbihpbnRlbF9kcCwgJmludGVsX2RwLT5EUCwgZHBfdHJhaW5f
cGF0KTsKPiA+IEBAIC0zOTU4LDEyICszOTU4LDEyIEBAIGludGVsX2RwX3Byb2dyYW1fbGlua190
cmFpbmluZ19wYXR0ZXJuKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIHZvaWQgaW50
ZWxfZHBfc2V0X2lkbGVfbGlua190cmFpbihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUo
aW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5
MTUoaW50ZWxfZHApOwo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGln
X3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9
IGludGVsX2RpZ19wb3J0LT5iYXNlLnBvcnQ7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQlpZiAoIUhB
U19EREkoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19EREkoaTkxNSkpCj4gPiAgIAkJcmV0dXJu
Owo+ID4gICAJdmFsID0gSTkxNV9SRUFEKERQX1RQX0NUTChwb3J0KSk7Cj4gPiBAQCAtMzk4MSw3
ICszOTgxLDcgQEAgdm9pZCBpbnRlbF9kcF9zZXRfaWRsZV9saW5rX3RyYWluKHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHApCj4gPiAgIAlpZiAocG9ydCA9PSBQT1JUX0EpCj4gPiAgIAkJcmV0dXJu
Owo+ID4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsIERQ
X1RQX1NUQVRVUyhwb3J0KSwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1
LT51bmNvcmUsIERQX1RQX1NUQVRVUyhwb3J0KSwKPiA+ICAgCQkJCSAgICBEUF9UUF9TVEFUVVNf
SURMRV9ET05FLAo+ID4gICAJCQkJICAgIERQX1RQX1NUQVRVU19JRExFX0RPTkUsCj4gPiAgIAkJ
CQkgICAgMSkpCj4gPiBAQCAtMzk5Miw3ICszOTkyLDcgQEAgc3RhdGljIHZvaWQKPiA+ICAgaW50
ZWxfZHBfbGlua19kb3duKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCSAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBl
bmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2UpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gICAJ
ZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+ID4gQEAgLTQwMDMsOCArNDAwMyw4IEBA
IGludGVsX2RwX2xpbmtfZG93bihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAg
CURSTV9ERUJVR19LTVMoIlxuIik7Cj4gPiAtCWlmICgoSVNfSVZZQlJJREdFKGRldl9wcml2KSAm
JiBwb3J0ID09IFBPUlRfQSkgfHwKPiA+IC0JICAgIChIQVNfUENIX0NQVChkZXZfcHJpdikgJiYg
cG9ydCAhPSBQT1JUX0EpKSB7Cj4gPiArCWlmICgoSVNfSVZZQlJJREdFKGk5MTUpICYmIHBvcnQg
PT0gUE9SVF9BKSB8fAo+ID4gKwkgICAgKEhBU19QQ0hfQ1BUKGk5MTUpICYmIHBvcnQgIT0gUE9S
VF9BKSkgewo+ID4gICAJCURQICY9IH5EUF9MSU5LX1RSQUlOX01BU0tfQ1BUOwo+ID4gICAJCURQ
IHw9IERQX0xJTktfVFJBSU5fUEFUX0lETEVfQ1BUOwo+ID4gICAJfSBlbHNlIHsKPiA+IEBAIC00
MDIzLDEzICs0MDIzLDEzIEBAIGludGVsX2RwX2xpbmtfZG93bihzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiA+ICAgCSAqIHRvIHRyYW5zY29kZXIgQSBhZnRlciBkaXNhYmxpbmcgaXQg
dG8gYWxsb3cgdGhlCj4gPiAgIAkgKiBtYXRjaGluZyBIRE1JIHBvcnQgdG8gYmUgZW5hYmxlZCBv
biB0cmFuc2NvZGVyIEEuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKEhBU19QQ0hfSUJYKGRldl9wcml2
KSAmJiBjcnRjLT5waXBlID09IFBJUEVfQiAmJiBwb3J0ICE9IFBPUlRfQSkgewo+ID4gKwlpZiAo
SEFTX1BDSF9JQlgoaTkxNSkgJiYgY3J0Yy0+cGlwZSA9PSBQSVBFX0IgJiYgcG9ydCAhPSBQT1JU
X0EpIHsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIFdlIGdldCBDUFUvUENIIEZJRk8gdW5kZXJydW5z
IG9uIHRoZSBvdGhlciBwaXBlIHdoZW4KPiA+ICAgCQkgKiBkb2luZyB0aGUgd29ya2Fyb3VuZC4g
U3dlZXAgdGhlbSB1bmRlciB0aGUgcnVnLgo+ID4gICAJCSAqLwo+ID4gLQkJaW50ZWxfc2V0X2Nw
dV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgUElQRV9BLCBmYWxzZSk7Cj4gPiAt
CQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2LCBQSVBFX0Es
IGZhbHNlKTsKPiA+ICsJCWludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoaTkx
NSwgUElQRV9BLCBmYWxzZSk7Cj4gPiArCQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVw
b3J0aW5nKGk5MTUsIFBJUEVfQSwgZmFsc2UpOwo+ID4gICAJCS8qIGFsd2F5cyBlbmFibGUgd2l0
aCBwYXR0ZXJuIDEgKGFzIHBlciBzcGVjKSAqLwo+ID4gICAJCURQICY9IH4oRFBfUElQRV9TRUxf
TUFTSyB8IERQX0xJTktfVFJBSU5fTUFTSyk7Cj4gPiBAQCAtNDA0MiwxNiArNDA0MiwxNiBAQCBp
bnRlbF9kcF9saW5rX2Rvd24oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJ
STkxNV9XUklURShpbnRlbF9kcC0+b3V0cHV0X3JlZywgRFApOwo+ID4gICAJCVBPU1RJTkdfUkVB
RChpbnRlbF9kcC0+b3V0cHV0X3JlZyk7Cj4gPiAtCQlpbnRlbF93YWl0X2Zvcl92YmxhbmtfaWZf
YWN0aXZlKGRldl9wcml2LCBQSVBFX0EpOwo+ID4gLQkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVy
cnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgUElQRV9BLCB0cnVlKTsKPiA+IC0JCWludGVsX3NldF9w
Y2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIFBJUEVfQSwgdHJ1ZSk7Cj4gPiAr
CQlpbnRlbF93YWl0X2Zvcl92YmxhbmtfaWZfYWN0aXZlKGk5MTUsIFBJUEVfQSk7Cj4gPiArCQlp
bnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIFBJUEVfQSwgdHJ1ZSk7
Cj4gPiArCQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIFBJUEVf
QSwgdHJ1ZSk7Cj4gPiAgIAl9Cj4gPiAgIAltc2xlZXAoaW50ZWxfZHAtPnBhbmVsX3Bvd2VyX2Rv
d25fZGVsYXkpOwo+ID4gICAJaW50ZWxfZHAtPkRQID0gRFA7Cj4gPiAtCWlmIChJU19WQUxMRVlW
SUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNf
VkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiAgIAkJaW50ZWxf
d2FrZXJlZl90IHdha2VyZWY7Cj4gPiAgIAkJd2l0aF9wcHNfbG9jayhpbnRlbF9kcCwgd2FrZXJl
ZikKPiA+IEBAIC00MTU2LDcgKzQxNTYsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kcF9nZXRfZHNj
X3NpbmtfY2FwKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHN0YXRpYyBib29sCj4g
PiAgIGludGVsX2VkcF9pbml0X2RwY2Qoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gPiAgIAkJdG9faTkxNShkcF90b19kaWdfcG9ydChp
bnRlbF9kcCktPmJhc2UuYmFzZS5kZXYpOwo+ID4gICAJLyogdGhpcyBmdW5jdGlvbiBpcyBtZWFu
dCB0byBiZSBjYWxsZWQgb25seSBvbmNlICovCj4gPiBAQCAtNDE2OSw3ICs0MTY5LDcgQEAgaW50
ZWxfZWRwX2luaXRfZHBjZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICAJCQkgZHJt
X2RwX2lzX2JyYW5jaChpbnRlbF9kcC0+ZHBjZCkpOwo+ID4gICAJaWYgKGludGVsX2RwLT5kcGNk
W0RQX0RQQ0RfUkVWXSA+PSAweDExKQo+ID4gLQkJZGV2X3ByaXYtPm5vX2F1eF9oYW5kc2hha2Ug
PSBpbnRlbF9kcC0+ZHBjZFtEUF9NQVhfRE9XTlNQUkVBRF0gJgo+ID4gKwkJaTkxNS0+bm9fYXV4
X2hhbmRzaGFrZSA9IGludGVsX2RwLT5kcGNkW0RQX01BWF9ET1dOU1BSRUFEXSAmCj4gPiAgIAkJ
CURQX05PX0FVWF9IQU5EU0hBS0VfTElOS19UUkFJTklORzsKPiA+ICAgCS8qCj4gPiBAQCAtNDIz
MCw3ICs0MjMwLDcgQEAgaW50ZWxfZWRwX2luaXRfZHBjZChzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwKQo+ID4gICAJaW50ZWxfZHBfc2V0X2NvbW1vbl9yYXRlcyhpbnRlbF9kcCk7Cj4gPiAgIAkv
KiBSZWFkIHRoZSBlRFAgRFNDIERQQ0QgcmVnaXN0ZXJzICovCj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSU5U
RUxfR0VOKGk5MTUpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoaTkxNSkpCj4gPiAgIAkJaW50ZWxf
ZHBfZ2V0X2RzY19zaW5rX2NhcChpbnRlbF9kcCk7Cj4gPiAgIAlyZXR1cm4gdHJ1ZTsKPiA+IEBA
IC00ODA0LDcgKzQ4MDQsNyBAQCBpbnRlbF9kcF9uZWVkc19saW5rX3JldHJhaW4oc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCkKPiA+ICAgaW50IGludGVsX2RwX3JldHJhaW5fbGluayhzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICBzdHJ1Y3QgZHJtX21vZGVzZXRfYWNx
dWlyZV9jdHggKmN0eCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2UpOwo+
ID4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gaW50ZWxfZHAtPmF0dGFj
aGVkX2Nvbm5lY3RvcjsKPiA+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0
YXRlOwo+ID4gQEAgLTQ4MTcsNyArNDgxNyw3IEBAIGludCBpbnRlbF9kcF9yZXRyYWluX2xpbmso
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAlpZiAoIWNvbm5lY3RvciB8fCBj
b25uZWN0b3ItPmJhc2Uuc3RhdHVzICE9IGNvbm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkKQo+ID4g
ICAJCXJldHVybiAwOwo+ID4gLQlyZXQgPSBkcm1fbW9kZXNldF9sb2NrKCZkZXZfcHJpdi0+ZHJt
Lm1vZGVfY29uZmlnLmNvbm5lY3Rpb25fbXV0ZXgsCj4gPiArCXJldCA9IGRybV9tb2Rlc2V0X2xv
Y2soJmk5MTUtPmRybS5tb2RlX2NvbmZpZy5jb25uZWN0aW9uX211dGV4LAo+ID4gICAJCQkgICAg
ICAgY3R4KTsKPiA+ICAgCWlmIChyZXQpCj4gPiAgIAkJcmV0dXJuIHJldDsKPiA+IEBAIC00ODQ3
LDIwICs0ODQ3LDIwIEBAIGludCBpbnRlbF9kcF9yZXRyYWluX2xpbmsoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAgIAkvKiBTdXBwcmVzcyB1bmRl
cnJ1bnMgY2F1c2VkIGJ5IHJlLXRyYWluaW5nICovCj4gPiAtCWludGVsX3NldF9jcHVfZmlmb191
bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIGNydGMtPnBpcGUsIGZhbHNlKTsKPiA+ICsJaW50
ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBjcnRjLT5waXBlLCBmYWxz
ZSk7Cj4gPiAgIAlpZiAoY3J0Y19zdGF0ZS0+aGFzX3BjaF9lbmNvZGVyKQo+ID4gLQkJaW50ZWxf
c2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwKPiA+ICsJCWludGVsX3Nl
dF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoaTkxNSwKPiA+ICAgCQkJCQkJICAgICAgaW50
ZWxfY3J0Y19wY2hfdHJhbnNjb2RlcihjcnRjKSwgZmFsc2UpOwo+ID4gICAJaW50ZWxfZHBfc3Rh
cnRfbGlua190cmFpbihpbnRlbF9kcCk7Cj4gPiAgIAlpbnRlbF9kcF9zdG9wX2xpbmtfdHJhaW4o
aW50ZWxfZHApOwo+ID4gICAJLyogS2VlcCB1bmRlcnJ1biByZXBvcnRpbmcgZGlzYWJsZWQgdW50
aWwgdGhpbmdzIGFyZSBzdGFibGUgKi8KPiA+IC0JaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9w
cml2LCBjcnRjLT5waXBlKTsKPiA+ICsJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsIGNydGMt
PnBpcGUpOwo+ID4gLQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9w
cml2LCBjcnRjLT5waXBlLCB0cnVlKTsKPiA+ICsJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVu
X3JlcG9ydGluZyhpOTE1LCBjcnRjLT5waXBlLCB0cnVlKTsKPiA+ICAgCWlmIChjcnRjX3N0YXRl
LT5oYXNfcGNoX2VuY29kZXIpCj4gPiAtCQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVw
b3J0aW5nKGRldl9wcml2LAo+ID4gKwkJaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9y
dGluZyhpOTE1LAo+ID4gICAJCQkJCQkgICAgICBpbnRlbF9jcnRjX3BjaF90cmFuc2NvZGVyKGNy
dGMpLCB0cnVlKTsKPiA+ICAgCXJldHVybiAwOwo+ID4gQEAgLTQ5NDYsNyArNDk0Niw3IEBAIHN0
YXRpYyB2b2lkIGludGVsX2RwX2NoZWNrX3NlcnZpY2VfaXJxKHN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHApCj4gPiAgIHN0YXRpYyBib29sCj4gPiAgIGludGVsX2RwX3Nob3J0X3B1bHNlKHN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAl1OCBvbGRfc2lu
a19jb3VudCA9IGludGVsX2RwLT5zaW5rX2NvdW50Owo+ID4gICAJYm9vbCByZXQ7Cj4gPiBAQCAt
NDk4Myw3ICs0OTgzLDcgQEAgaW50ZWxfZHBfc2hvcnRfcHVsc2Uoc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCkKPiA+ICAgCWlmIChpbnRlbF9kcC0+Y29tcGxpYW5jZS50ZXN0X3R5cGUgPT0gRFBf
VEVTVF9MSU5LX1RSQUlOSU5HKSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiTGluayBUcmFpbmlu
ZyBDb21wbGlhbmNlIFRlc3QgcmVxdWVzdGVkXG4iKTsKPiA+ICAgCQkvKiBTZW5kIGEgSG90cGx1
ZyBVZXZlbnQgdG8gdXNlcnNwYWNlIHRvIHN0YXJ0IG1vZGVzZXQgKi8KPiA+IC0JCWRybV9rbXNf
aGVscGVyX2hvdHBsdWdfZXZlbnQoJmRldl9wcml2LT5kcm0pOwo+ID4gKwkJZHJtX2ttc19oZWxw
ZXJfaG90cGx1Z19ldmVudCgmaTkxNS0+ZHJtKTsKPiA+ICAgCX0KPiA+ICAgCXJldHVybiB0cnVl
Owo+ID4gQEAgLTUwNTIsNyArNTA1Miw3IEBAIGVkcF9kZXRlY3Qoc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCkKPiA+ICAgc3RhdGljIGJvb2wgaWJ4X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiAgIAl1MzIgYml0Owo+ID4gICAJc3dpdGNoIChlbmNvZGVyLT5ocGRfcGluKSB7Cj4gPiBA
QCAtNTA3NSw3ICs1MDc1LDcgQEAgc3RhdGljIGJvb2wgaWJ4X2RpZ2l0YWxfcG9ydF9jb25uZWN0
ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHN0YXRpYyBib29sIGNwdF9k
aWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJdTMyIGJpdDsKPiA+ICAgCXN3aXRjaCAo
ZW5jb2Rlci0+aHBkX3Bpbikgewo+ID4gQEAgLTUwOTgsNyArNTA5OCw3IEBAIHN0YXRpYyBib29s
IGNwdF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
KQo+ID4gICBzdGF0aWMgYm9vbCBzcHRfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAg
CXUzMiBiaXQ7Cj4gPiAgIAlzd2l0Y2ggKGVuY29kZXItPmhwZF9waW4pIHsKPiA+IEBAIC01MTE3
LDcgKzUxMTcsNyBAQCBzdGF0aWMgYm9vbCBzcHRfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgc3RhdGljIGJvb2wgZzR4X2RpZ2l0YWxf
cG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAl1MzIgYml0Owo+ID4gICAJc3dpdGNoIChlbmNvZGVy
LT5ocGRfcGluKSB7Cj4gPiBAQCAtNTE0MCw3ICs1MTQwLDcgQEAgc3RhdGljIGJvb2wgZzR4X2Rp
Z2l0YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAg
IHN0YXRpYyBib29sIGdtNDVfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXUzMiBi
aXQ7Cj4gPiAgIAlzd2l0Y2ggKGVuY29kZXItPmhwZF9waW4pIHsKPiA+IEBAIC01MTYzLDcgKzUx
NjMsNyBAQCBzdGF0aWMgYm9vbCBnbTQ1X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHN0YXRpYyBib29sIGlsa19kaWdpdGFsX3BvcnRf
Y29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ID4gICAJaWYgKGVuY29kZXItPmhwZF9waW4gPT0gSFBEX1BPUlRfQSkK
PiA+ICAgCQlyZXR1cm4gSTkxNV9SRUFEKERFSVNSKSAmIERFX0RQX0FfSE9UUExVRzsKPiA+IEBA
IC01MTczLDcgKzUxNzMsNyBAQCBzdGF0aWMgYm9vbCBpbGtfZGlnaXRhbF9wb3J0X2Nvbm5lY3Rl
ZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgc3RhdGljIGJvb2wgc25iX2Rp
Z2l0YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlpZiAoZW5jb2Rlci0+aHBkX3BpbiA9PSBI
UERfUE9SVF9BKQo+ID4gICAJCXJldHVybiBJOTE1X1JFQUQoREVJU1IpICYgREVfRFBfQV9IT1RQ
TFVHOwo+ID4gQEAgLTUxODMsNyArNTE4Myw3IEBAIHN0YXRpYyBib29sIHNuYl9kaWdpdGFsX3Bv
cnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICBzdGF0aWMg
Ym9vbCBpdmJfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWlmIChlbmNvZGVyLT5o
cGRfcGluID09IEhQRF9QT1JUX0EpCj4gPiAgIAkJcmV0dXJuIEk5MTVfUkVBRChERUlTUikgJiBE
RV9EUF9BX0hPVFBMVUdfSVZCOwo+ID4gQEAgLTUxOTMsNyArNTE5Myw3IEBAIHN0YXRpYyBib29s
IGl2Yl9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
KQo+ID4gICBzdGF0aWMgYm9vbCBiZHdfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAg
CWlmIChlbmNvZGVyLT5ocGRfcGluID09IEhQRF9QT1JUX0EpCj4gPiAgIAkJcmV0dXJuIEk5MTVf
UkVBRChHRU44X0RFX1BPUlRfSVNSKSAmIEdFTjhfUE9SVF9EUF9BX0hPVFBMVUc7Cj4gPiBAQCAt
NTIwMyw3ICs1MjAzLDcgQEAgc3RhdGljIGJvb2wgYmR3X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHN0YXRpYyBib29sIGJ4dF9kaWdp
dGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJdTMyIGJpdDsKPiA+ICAgCXN3aXRjaCAoZW5j
b2Rlci0+aHBkX3Bpbikgewo+ID4gQEAgLTUyMjQsNyArNTIyNCw3IEBAIHN0YXRpYyBib29sIGJ4
dF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+
ID4gICAJcmV0dXJuIEk5MTVfUkVBRChHRU44X0RFX1BPUlRfSVNSKSAmIGJpdDsKPiA+ICAgfQo+
ID4gLXN0YXRpYyBib29sIGljbF9jb21ib19wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGJvb2wgaWNsX2NvbWJvX3BvcnRfY29ubmVj
dGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICBzdHJ1Y3Qg
aW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCkKPiA+ICAgewo+ID4gICAJZW51bSBw
b3J0IHBvcnQgPSBpbnRlbF9kaWdfcG9ydC0+YmFzZS5wb3J0Owo+ID4gQEAgLTUyNDcsNyArNTI0
Nyw3IEBAIHN0YXRpYyBjb25zdCBjaGFyICp0Y190eXBlX25hbWUoZW51bSB0Y19wb3J0X3R5cGUg
dHlwZSkKPiA+ICAgCXJldHVybiBuYW1lc1t0eXBlXTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lk
IGljbF91cGRhdGVfdGNfcG9ydF90eXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICtzdGF0aWMgdm9pZCBpY2xfdXBkYXRlX3RjX3BvcnRfdHlwZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICBzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICppbnRlbF9kaWdfcG9ydCwKPiA+ICAgCQkJCSAgICBib29sIGlzX2xlZ2FjeSwgYm9vbCBpc190
eXBlYywgYm9vbCBpc190YnQpCj4gPiAgIHsKPiA+IEBAIC01Mjk1LDEwICs1Mjk1LDEwIEBAIHN0
YXRpYyB2b2lkIGljbF91cGRhdGVfdGNfcG9ydF90eXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICAgICogd2lsbCByZXF1aXJlIGEgbG90IG9mIGNvb3JkaW5hdGlvbiB3
aXRoIHVzZXIgc3BhY2UgYW5kIHRob3JvdWdoIHRlc3RpbmcgZm9yCj4gPiAgICAqIHRoZSBleHRy
YSBwb3NzaWJsZSBjYXNlcy4KPiA+ICAgICovCj4gPiAtc3RhdGljIGJvb2wgaWNsX3RjX3BoeV9j
b25uZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgYm9v
bCBpY2xfdGNfcGh5X2Nvbm5lY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAg
IAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkKPiA+ICAgewo+
ID4gLQllbnVtIHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoZGV2X3ByaXYsIGRp
Z19wb3J0LT5iYXNlLnBvcnQpOwo+ID4gKwllbnVtIHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3Bv
cnRfdG9fdGMoaTkxNSwgZGlnX3BvcnQtPmJhc2UucG9ydCk7Cj4gPiAgIAl1MzIgdmFsOwo+ID4g
ICAJaWYgKGRpZ19wb3J0LT50Y190eXBlICE9IFRDX1BPUlRfTEVHQUNZICYmCj4gPiBAQCAtNTMy
OSw3ICs1MzI5LDcgQEAgc3RhdGljIGJvb2wgaWNsX3RjX3BoeV9jb25uZWN0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWlmIChkaWdfcG9ydC0+dGNfdHlwZSA9PSBU
Q19QT1JUX1RZUEVDICYmCj4gPiAgIAkgICAgIShJOTE1X1JFQUQoUE9SVF9UWF9ERkxFWERQU1Ap
ICYgVENfTElWRV9TVEFURV9UQyh0Y19wb3J0KSkpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJU
QyBQSFkgJWQgc3VkZGVuIGRpc2Nvbm5lY3QuXG4iLCB0Y19wb3J0KTsKPiA+IC0JCWljbF90Y19w
aHlfZGlzY29ubmVjdChkZXZfcHJpdiwgZGlnX3BvcnQpOwo+ID4gKwkJaWNsX3RjX3BoeV9kaXNj
b25uZWN0KGk5MTUsIGRpZ19wb3J0KTsKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAl9Cj4g
PiBAQCAtNTM0MCwxMCArNTM0MCwxMCBAQCBzdGF0aWMgYm9vbCBpY2xfdGNfcGh5X2Nvbm5lY3Qo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAgKiBTZWUgdGhlIGNvbW1l
bnQgYXQgdGhlIGNvbm5lY3QgZnVuY3Rpb24uIFRoaXMgaW1wbGVtZW50cyB0aGUgRGlzY29ubmVj
dAo+ID4gICAgKiBGbG93Lgo+ID4gICAgKi8KPiA+IC12b2lkIGljbF90Y19waHlfZGlzY29ubmVj
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpY2xfdGNfcGh5
X2Rpc2Nvbm5lY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgIHN0
cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQo+ID4gICB7Cj4gPiAtCWVudW0gdGNf
cG9ydCB0Y19wb3J0ID0gaW50ZWxfcG9ydF90b190YyhkZXZfcHJpdiwgZGlnX3BvcnQtPmJhc2Uu
cG9ydCk7Cj4gPiArCWVudW0gdGNfcG9ydCB0Y19wb3J0ID0gaW50ZWxfcG9ydF90b190YyhpOTE1
LCBkaWdfcG9ydC0+YmFzZS5wb3J0KTsKPiA+ICAgCWlmIChkaWdfcG9ydC0+dGNfdHlwZSA9PSBU
Q19QT1JUX1VOS05PV04pCj4gPiAgIAkJcmV0dXJuOwo+ID4gQEAgLTUzNzgsMTEgKzUzNzgsMTEg
QEAgdm9pZCBpY2xfdGNfcGh5X2Rpc2Nvbm5lY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAgKiBjb25uZWN0ZWQgcG9ydHMgYXJlIHVzYWJsZSwgYW5kIGF2b2lkcyBl
eHBvc2luZyB0byB0aGUgdXNlcnMgb2JqZWN0cyB0aGV5Cj4gPiAgICAqIGNhbid0IHJlYWxseSB1
c2UuCj4gPiAgICAqLwo+ID4gLXN0YXRpYyBib29sIGljbF90Y19wb3J0X2Nvbm5lY3RlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGJvb2wgaWNsX3RjX3Bv
cnRfY29ubmVjdGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICBz
dHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCkKPiA+ICAgewo+ID4gICAJ
ZW51bSBwb3J0IHBvcnQgPSBpbnRlbF9kaWdfcG9ydC0+YmFzZS5wb3J0Owo+ID4gLQllbnVtIHRj
X3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoZGV2X3ByaXYsIHBvcnQpOwo+ID4gKwll
bnVtIHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoaTkxNSwgcG9ydCk7Cj4gPiAg
IAlib29sIGlzX2xlZ2FjeSwgaXNfdHlwZWMsIGlzX3RidDsKPiA+ICAgCXUzMiBkcHNwOwo+ID4g
QEAgLTU0MDcsMTUgKzU0MDcsMTUgQEAgc3RhdGljIGJvb2wgaWNsX3RjX3BvcnRfY29ubmVjdGVk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWlzX3RidCA9IGRwc3Ag
JiBUQ19MSVZFX1NUQVRFX1RCVCh0Y19wb3J0KTsKPiA+ICAgCWlmICghaXNfbGVnYWN5ICYmICFp
c190eXBlYyAmJiAhaXNfdGJ0KSB7Cj4gPiAtCQlpY2xfdGNfcGh5X2Rpc2Nvbm5lY3QoZGV2X3By
aXYsIGludGVsX2RpZ19wb3J0KTsKPiA+ICsJCWljbF90Y19waHlfZGlzY29ubmVjdChpOTE1LCBp
bnRlbF9kaWdfcG9ydCk7Cj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gICAJfQo+ID4gLQlpY2xf
dXBkYXRlX3RjX3BvcnRfdHlwZShkZXZfcHJpdiwgaW50ZWxfZGlnX3BvcnQsIGlzX2xlZ2FjeSwg
aXNfdHlwZWMsCj4gPiArCWljbF91cGRhdGVfdGNfcG9ydF90eXBlKGk5MTUsIGludGVsX2RpZ19w
b3J0LCBpc19sZWdhY3ksIGlzX3R5cGVjLAo+ID4gICAJCQkJaXNfdGJ0KTsKPiA+IC0JaWYgKCFp
Y2xfdGNfcGh5X2Nvbm5lY3QoZGV2X3ByaXYsIGludGVsX2RpZ19wb3J0KSkKPiA+ICsJaWYgKCFp
Y2xfdGNfcGh5X2Nvbm5lY3QoaTkxNSwgaW50ZWxfZGlnX3BvcnQpKQo+ID4gICAJCXJldHVybiBm
YWxzZTsKPiA+ICAgCXJldHVybiB0cnVlOwo+ID4gQEAgLTU0MjMsMTMgKzU0MjMsMTMgQEAgc3Rh
dGljIGJvb2wgaWNsX3RjX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgc3RhdGljIGJvb2wgaWNsX2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGVuY190b19kaWdf
cG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAtCWlmIChpbnRlbF9wb3J0X2lzX2NvbWJvcGh5KGRl
dl9wcml2LCBlbmNvZGVyLT5wb3J0KSkKPiA+IC0JCXJldHVybiBpY2xfY29tYm9fcG9ydF9jb25u
ZWN0ZWQoZGV2X3ByaXYsIGRpZ19wb3J0KTsKPiA+IC0JZWxzZSBpZiAoaW50ZWxfcG9ydF9pc190
YyhkZXZfcHJpdiwgZW5jb2Rlci0+cG9ydCkpCj4gPiAtCQlyZXR1cm4gaWNsX3RjX3BvcnRfY29u
bmVjdGVkKGRldl9wcml2LCBkaWdfcG9ydCk7Cj4gPiArCWlmIChpbnRlbF9wb3J0X2lzX2NvbWJv
cGh5KGk5MTUsIGVuY29kZXItPnBvcnQpKQo+ID4gKwkJcmV0dXJuIGljbF9jb21ib19wb3J0X2Nv
bm5lY3RlZChpOTE1LCBkaWdfcG9ydCk7Cj4gPiArCWVsc2UgaWYgKGludGVsX3BvcnRfaXNfdGMo
aTkxNSwgZW5jb2Rlci0+cG9ydCkpCj4gPiArCQlyZXR1cm4gaWNsX3RjX3BvcnRfY29ubmVjdGVk
KGk5MTUsIGRpZ19wb3J0KTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlNSVNTSU5HX0NBU0UoZW5jb2Rl
ci0+aHBkX3Bpbik7Cj4gPiBAQCAtNTQ0OSw0MSArNTQ0OSw0MSBAQCBzdGF0aWMgYm9vbCBpY2xf
ZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+
ICAgICovCj4gPiAgIHN0YXRpYyBib29sIF9faW50ZWxfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZChz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2KSkgewo+ID4gLQkJaWYgKElTX0dNNDUoZGV2
X3ByaXYpKQo+ID4gKwlpZiAoSEFTX0dNQ0goaTkxNSkpIHsKPiA+ICsJCWlmIChJU19HTTQ1KGk5
MTUpKQo+ID4gICAJCQlyZXR1cm4gZ200NV9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKGVuY29kZXIp
Owo+ID4gICAJCWVsc2UKPiA+ICAgCQkJcmV0dXJuIGc0eF9kaWdpdGFsX3BvcnRfY29ubmVjdGVk
KGVuY29kZXIpOwo+ID4gICAJfQo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkK
PiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICAgCQlyZXR1cm4gaWNsX2RpZ2l0
YWxfcG9ydF9jb25uZWN0ZWQoZW5jb2Rlcik7Cj4gPiAtCWVsc2UgaWYgKElTX0dFTihkZXZfcHJp
diwgMTApIHx8IElTX0dFTjlfQkMoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19HRU4oaTkx
NSwgMTApIHx8IElTX0dFTjlfQkMoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIHNwdF9kaWdpdGFsX3Bv
cnRfY29ubmVjdGVkKGVuY29kZXIpOwo+ID4gLQllbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2
KSkKPiA+ICsJZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiA+ICAgCQlyZXR1cm4gYnh0X2Rp
Z2l0YWxfcG9ydF9jb25uZWN0ZWQoZW5jb2Rlcik7Cj4gPiAtCWVsc2UgaWYgKElTX0dFTihkZXZf
cHJpdiwgOCkpCj4gPiArCWVsc2UgaWYgKElTX0dFTihpOTE1LCA4KSkKPiA+ICAgCQlyZXR1cm4g
YmR3X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoZW5jb2Rlcik7Cj4gPiAtCWVsc2UgaWYgKElTX0dF
TihkZXZfcHJpdiwgNykpCj4gPiArCWVsc2UgaWYgKElTX0dFTihpOTE1LCA3KSkKPiA+ICAgCQly
ZXR1cm4gaXZiX2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoZW5jb2Rlcik7Cj4gPiAtCWVsc2UgaWYg
KElTX0dFTihkZXZfcHJpdiwgNikpCj4gPiArCWVsc2UgaWYgKElTX0dFTihpOTE1LCA2KSkKPiA+
ICAgCQlyZXR1cm4gc25iX2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoZW5jb2Rlcik7Cj4gPiAtCWVs
c2UgaWYgKElTX0dFTihkZXZfcHJpdiwgNSkpCj4gPiArCWVsc2UgaWYgKElTX0dFTihpOTE1LCA1
KSkKPiA+ICAgCQlyZXR1cm4gaWxrX2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoZW5jb2Rlcik7Cj4g
PiAtCU1JU1NJTkdfQ0FTRShJTlRFTF9HRU4oZGV2X3ByaXYpKTsKPiA+ICsJTUlTU0lOR19DQVNF
KElOVEVMX0dFTihpOTE1KSk7Cj4gPiAgIAlyZXR1cm4gZmFsc2U7Cj4gPiAgIH0KPiA+ICAgYm9v
bCBpbnRlbF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJYm9vbCBpc19jb25uZWN0
ZWQgPSBmYWxzZTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gLQl3aXRoX2lu
dGVsX2Rpc3BsYXlfcG93ZXIoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUsIHdh
a2VyZWYpCj4gPiArCXdpdGhfaW50ZWxfZGlzcGxheV9wb3dlcihpOTE1LCBQT1dFUl9ET01BSU5f
RElTUExBWV9DT1JFLCB3YWtlcmVmKQo+ID4gICAJCWlzX2Nvbm5lY3RlZCA9IF9faW50ZWxfZGln
aXRhbF9wb3J0X2Nvbm5lY3RlZChlbmNvZGVyKTsKPiA+ICAgCXJldHVybiBpc19jb25uZWN0ZWQ7
Cj4gPiBAQCAtNTUzNyw3ICs1NTM3LDcgQEAgaW50ZWxfZHBfZGV0ZWN0KHN0cnVjdCBkcm1fY29u
bmVjdG9yICpjb25uZWN0b3IsCj4gPiAgIAkJc3RydWN0IGRybV9tb2Rlc2V0X2FjcXVpcmVfY3R4
ICpjdHgsCj4gPiAgIAkJYm9vbCBmb3JjZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICAg
CXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBpbnRlbF9hdHRhY2hlZF9kcChjb25uZWN0b3Ip
Owo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90b19kaWdf
cG9ydChpbnRlbF9kcCk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciA9ICZk
aWdfcG9ydC0+YmFzZTsKPiA+IEBAIC01NTQ1LDcgKzU1NDUsNyBAQCBpbnRlbF9kcF9kZXRlY3Qo
c3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgCURSTV9ERUJVR19LTVMoIltD
T05ORUNUT1I6JWQ6JXNdXG4iLAo+ID4gICAJCSAgICAgIGNvbm5lY3Rvci0+YmFzZS5pZCwgY29u
bmVjdG9yLT5uYW1lKTsKPiA+IC0JV0FSTl9PTighZHJtX21vZGVzZXRfaXNfbG9ja2VkKCZkZXZf
cHJpdi0+ZHJtLm1vZGVfY29uZmlnLmNvbm5lY3Rpb25fbXV0ZXgpKTsKPiA+ICsJV0FSTl9PTigh
ZHJtX21vZGVzZXRfaXNfbG9ja2VkKCZpOTE1LT5kcm0ubW9kZV9jb25maWcuY29ubmVjdGlvbl9t
dXRleCkpOwo+ID4gICAJLyogQ2FuJ3QgZGlzY29ubmVjdCBlRFAgKi8KPiA+ICAgCWlmIChpbnRl
bF9kcF9pc19lZHAoaW50ZWxfZHApKQo+ID4gQEAgLTU1ODQsNyArNTU4NCw3IEBAIGludGVsX2Rw
X2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ID4gICAJaW50ZWxfZHBf
cHJpbnRfcmF0ZXMoaW50ZWxfZHApOwo+ID4gICAJLyogUmVhZCBEUCBTaW5rIERTQyBDYXAgRFBD
RCByZWdzIGZvciBEUCB2MS40ICovCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEx
KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ID4gICAJCWludGVsX2RwX2dldF9k
c2Nfc2lua19jYXAoaW50ZWxfZHApOwo+ID4gICAJZHJtX2RwX3JlYWRfZGVzYygmaW50ZWxfZHAt
PmF1eCwgJmludGVsX2RwLT5kZXNjLAo+ID4gQEAgLTU2NDIsNyArNTY0Miw3IEBAIGludGVsX2Rw
X2ZvcmNlKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfZHAgKmludGVsX2RwID0gaW50ZWxfYXR0YWNoZWRfZHAoY29ubmVjdG9yKTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxf
ZHApOwo+ID4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIgPSAmZGlnX3Bv
cnQtPmJhc2U7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoaW50ZWxfZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBp
bnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBhdXhfZG9tYWluID0KPiA+ICAgCQlpbnRlbF9hdXhf
cG93ZXJfZG9tYWluKGRpZ19wb3J0KTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+
ID4gQEAgLTU2NTQsMTEgKzU2NTQsMTEgQEAgaW50ZWxfZHBfZm9yY2Uoc3RydWN0IGRybV9jb25u
ZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgCWlmIChjb25uZWN0b3ItPnN0YXR1cyAhPSBjb25uZWN0
b3Jfc3RhdHVzX2Nvbm5lY3RlZCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCXdha2VyZWYgPSBpbnRl
bF9kaXNwbGF5X3Bvd2VyX2dldChkZXZfcHJpdiwgYXV4X2RvbWFpbik7Cj4gPiArCXdha2VyZWYg
PSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBhdXhfZG9tYWluKTsKPiA+ICAgCWludGVs
X2RwX3NldF9lZGlkKGludGVsX2RwKTsKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2
X3ByaXYsIGF1eF9kb21haW4sIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1
dChpOTE1LCBhdXhfZG9tYWluLCB3YWtlcmVmKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW50IGlu
dGVsX2RwX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gQEAg
LTYzNjIsMTAgKzYzNjIsMTAgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9oZGNwX3NoaW0g
aW50ZWxfZHBfaGRjcF9zaGltID0gewo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9lZHBfcGFuZWxf
dmRkX3Nhbml0aXplKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCA9IGRwX3RvX2RpZ19w
b3J0KGludGVsX2RwKTsKPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPnBwc19t
dXRleCk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPnBwc19tdXRleCk7Cj4gPiAg
IAlpZiAoIWVkcF9oYXZlX3BhbmVsX3ZkZChpbnRlbF9kcCkpCj4gPiAgIAkJcmV0dXJuOwo+ID4g
QEAgLTYzNzcsMTggKzYzNzcsMTggQEAgc3RhdGljIHZvaWQgaW50ZWxfZWRwX3BhbmVsX3ZkZF9z
YW5pdGl6ZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICAJICogaW5kZWZpbml0ZWx5
Lgo+ID4gICAJICovCj4gPiAgIAlEUk1fREVCVUdfS01TKCJWREQgbGVmdCBvbiBieSBCSU9TLCBh
ZGp1c3Rpbmcgc3RhdGUgdHJhY2tpbmdcbiIpOwo+ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dl
dChkZXZfcHJpdiwgaW50ZWxfYXV4X3Bvd2VyX2RvbWFpbihkaWdfcG9ydCkpOwo+ID4gKwlpbnRl
bF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBpbnRlbF9hdXhfcG93ZXJfZG9tYWluKGRpZ19wb3J0
KSk7Cj4gPiAgIAllZHBfcGFuZWxfdmRkX3NjaGVkdWxlX29mZihpbnRlbF9kcCk7Cj4gPiAgIH0K
PiA+ICAgc3RhdGljIGVudW0gcGlwZSB2bHZfYWN0aXZlX3BpcGUoc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyID0gJmRwX3RvX2RpZ19wb3J0KGludGVsX2RwKS0+YmFzZTsKPiA+ICAgCWVudW0gcGlw
ZSBwaXBlOwo+ID4gLQlpZiAoaW50ZWxfZHBfcG9ydF9lbmFibGVkKGRldl9wcml2LCBpbnRlbF9k
cC0+b3V0cHV0X3JlZywKPiA+ICsJaWYgKGludGVsX2RwX3BvcnRfZW5hYmxlZChpOTE1LCBpbnRl
bF9kcC0+b3V0cHV0X3JlZywKPiA+ICAgCQkJCSAgZW5jb2Rlci0+cG9ydCwgJnBpcGUpKQo+ID4g
ICAJCXJldHVybiBwaXBlOwo+ID4gQEAgLTYzOTcsMTIgKzYzOTcsMTIgQEAgc3RhdGljIGVudW0g
cGlwZSB2bHZfYWN0aXZlX3BpcGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgdm9p
ZCBpbnRlbF9kcF9lbmNvZGVyX3Jlc2V0KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVu
Y29kZXItPmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShlbmNvZGVyLT5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGVuY190
b19pbnRlbF9kcChlbmNvZGVyKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9sc3Bjb24gKmxzcGNvbiA9
IGRwX3RvX2xzcGNvbihpbnRlbF9kcCk7Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsK
PiA+IC0JaWYgKCFIQVNfRERJKGRldl9wcml2KSkKPiA+ICsJaWYgKCFIQVNfRERJKGk5MTUpKQo+
ID4gICAJCWludGVsX2RwLT5EUCA9IEk5MTVfUkVBRChpbnRlbF9kcC0+b3V0cHV0X3JlZyk7Cj4g
PiAgIAlpZiAobHNwY29uLT5hY3RpdmUpCj4gPiBAQCAtNjQxMCwxMiArNjQxMCwxMiBAQCB2b2lk
IGludGVsX2RwX2VuY29kZXJfcmVzZXQoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQo+ID4g
ICAJaW50ZWxfZHAtPnJlc2V0X2xpbmtfcGFyYW1zID0gdHJ1ZTsKPiA+IC0JaWYgKCFJU19WQUxM
RVlWSUVXKGRldl9wcml2KSAmJiAhSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgJiYKPiA+ICsJaWYg
KCFJU19WQUxMRVlWSUVXKGk5MTUpICYmICFJU19DSEVSUllWSUVXKGk5MTUpICYmCj4gPiAgIAkg
ICAgIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJd2l0
aF9wcHNfbG9jayhpbnRlbF9kcCwgd2FrZXJlZikgewo+ID4gLQkJaWYgKElTX1ZBTExFWVZJRVco
ZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwkJaWYgKElTX1ZBTExF
WVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICAgCQkJaW50ZWxfZHAtPmFj
dGl2ZV9waXBlID0gdmx2X2FjdGl2ZV9waXBlKGludGVsX2RwKTsKPiA+ICAgCQlpZiAoaW50ZWxf
ZHBfaXNfZWRwKGludGVsX2RwKSkgewo+ID4gQEAgLTY1MDgsNDEgKzY1MDgsNDEgQEAgaW50ZWxf
ZHBfaHBkX3B1bHNlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LCBi
b29sIGxvbmdfaHBkKQo+ID4gICB9Cj4gPiAgIC8qIGNoZWNrIHRoZSBWQlQgdG8gc2VlIHdoZXRo
ZXIgdGhlIGVEUCBpcyBvbiBhbm90aGVyIHBvcnQgKi8KPiA+IC1ib29sIGludGVsX2RwX2lzX3Bv
cnRfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQp
Cj4gPiArYm9vbCBpbnRlbF9kcF9pc19wb3J0X2VkcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwgZW51bSBwb3J0IHBvcnQpCj4gPiAgIHsKPiA+ICAgCS8qCj4gPiAgIAkgKiBlRFAgbm90
IHN1cHBvcnRlZCBvbiBnNHguIHNvIGJhaWwgb3V0IGVhcmx5IGp1c3QKPiA+ICAgCSAqIGZvciBh
IGJpdCBleHRyYSBzYWZldHkgaW4gY2FzZSB0aGUgVkJUIGlzIGJvbmtlcnMuCj4gPiAgIAkgKi8K
PiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA1KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5
MTUpIDwgNSkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpIDwgOSAmJiBwb3J0ID09IFBPUlRfQSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDkg
JiYgcG9ydCA9PSBQT1JUX0EpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAtCXJldHVybiBpbnRl
bF9iaW9zX2lzX3BvcnRfZWRwKGRldl9wcml2LCBwb3J0KTsKPiA+ICsJcmV0dXJuIGludGVsX2Jp
b3NfaXNfcG9ydF9lZHAoaTkxNSwgcG9ydCk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQKPiA+
ICAgaW50ZWxfZHBfYWRkX3Byb3BlcnRpZXMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgc3Ry
dWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+
ICAgCWVudW0gcG9ydCBwb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApLT5iYXNlLnBvcnQ7
Cj4gPiAtCWlmICghSVNfRzRYKGRldl9wcml2KSAmJiBwb3J0ICE9IFBPUlRfQSkKPiA+ICsJaWYg
KCFJU19HNFgoaTkxNSkgJiYgcG9ydCAhPSBQT1JUX0EpCj4gPiAgIAkJaW50ZWxfYXR0YWNoX2Zv
cmNlX2F1ZGlvX3Byb3BlcnR5KGNvbm5lY3Rvcik7Cj4gPiAgIAlpbnRlbF9hdHRhY2hfYnJvYWRj
YXN0X3JnYl9wcm9wZXJ0eShjb25uZWN0b3IpOwo+ID4gLQlpZiAoSEFTX0dNQ0goZGV2X3ByaXYp
KQo+ID4gKwlpZiAoSEFTX0dNQ0goaTkxNSkpCj4gPiAgIAkJZHJtX2Nvbm5lY3Rvcl9hdHRhY2hf
bWF4X2JwY19wcm9wZXJ0eShjb25uZWN0b3IsIDYsIDEwKTsKPiA+IC0JZWxzZSBpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA1KQo+ID4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNSkK
PiA+ICAgCQlkcm1fY29ubmVjdG9yX2F0dGFjaF9tYXhfYnBjX3Byb3BlcnR5KGNvbm5lY3Rvciwg
NiwgMTIpOwo+ID4gICAJaWYgKGludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpIHsKPiA+ICAgCQl1
MzIgYWxsb3dlZF9zY2FsZXJzOwo+ID4gICAJCWFsbG93ZWRfc2NhbGVycyA9IEJJVChEUk1fTU9E
RV9TQ0FMRV9BU1BFQ1QpIHwgQklUKERSTV9NT0RFX1NDQUxFX0ZVTExTQ1JFRU4pOwo+ID4gLQkJ
aWYgKCFIQVNfR01DSChkZXZfcHJpdikpCj4gPiArCQlpZiAoIUhBU19HTUNIKGk5MTUpKQo+ID4g
ICAJCQlhbGxvd2VkX3NjYWxlcnMgfD0gQklUKERSTV9NT0RFX1NDQUxFX0NFTlRFUik7Cj4gPiAg
IAkJZHJtX2Nvbm5lY3Rvcl9hdHRhY2hfc2NhbGluZ19tb2RlX3Byb3BlcnR5KGNvbm5lY3Rvciwg
YWxsb3dlZF9zY2FsZXJzKTsKPiA+IEBAIC02NTYyLDcgKzY1NjIsNyBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9kcF9pbml0X3BhbmVsX3Bvd2VyX3RpbWVzdGFtcHMoc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCkKPiA+ICAgc3RhdGljIHZvaWQKPiA+ICAgaW50ZWxfcHBzX3JlYWRvdXRfaHdfc3RhdGUo
c3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgc3RydWN0IGVkcF9wb3dlcl9zZXEgKnNlcSkKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1
KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19p
OTE1KGludGVsX2RwKTsKPiA+ICAgCXUzMiBwcF9vbiwgcHBfb2ZmLCBwcF9jdGw7Cj4gPiAgIAlz
dHJ1Y3QgcHBzX3JlZ2lzdGVycyByZWdzOwo+ID4gQEAgLTY1NzEsNyArNjU3MSw3IEBAIGludGVs
X3Bwc19yZWFkb3V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsIHN0cnVjdCBl
ZHBfcG93ZXJfc2VxICpzZXEpCj4gPiAgIAlwcF9jdGwgPSBpcm9ubGFrZV9nZXRfcHBfY29udHJv
bChpbnRlbF9kcCk7Cj4gPiAgIAkvKiBFbnN1cmUgUFBTIGlzIHVubG9ja2VkICovCj4gPiAtCWlm
ICghSEFTX0RESShkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX0RESShpOTE1KSkKPiA+ICAgCQlJ
OTE1X1dSSVRFKHJlZ3MucHBfY3RybCwgcHBfY3RsKTsKPiA+ICAgCXBwX29uID0gSTkxNV9SRUFE
KHJlZ3MucHBfb24pOwo+ID4gQEAgLTY2MjEsMTEgKzY2MjEsMTEgQEAgaW50ZWxfcHBzX3Zlcmlm
eV9zdGF0ZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICBzdGF0aWMgdm9pZAo+ID4g
ICBpbnRlbF9kcF9pbml0X3BhbmVsX3Bvd2VyX3NlcXVlbmNlcihzdHJ1Y3QgaW50ZWxfZHAgKmlu
dGVsX2RwKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gICAJc3RydWN0IGVkcF9wb3dlcl9zZXEgY3Vy
LCB2YnQsIHNwZWMsCj4gPiAgIAkJKmZpbmFsID0gJmludGVsX2RwLT5wcHNfZGVsYXlzOwo+ID4g
LQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+cHBzX211dGV4KTsKPiA+ICsJbG9ja2Rl
cF9hc3NlcnRfaGVsZCgmaTkxNS0+cHBzX211dGV4KTsKPiA+ICAgCS8qIGFscmVhZHkgaW5pdGlh
bGl6ZWQ/ICovCj4gPiAgIAlpZiAoZmluYWwtPnQxMV90MTIgIT0gMCkKPiA+IEBAIC02NjM1LDEz
ICs2NjM1LDEzIEBAIGludGVsX2RwX2luaXRfcGFuZWxfcG93ZXJfc2VxdWVuY2VyKHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIAlpbnRlbF9wcHNfZHVtcF9zdGF0ZSgiY3VyIiwgJmN1
cik7Cj4gPiAtCXZidCA9IGRldl9wcml2LT52YnQuZWRwLnBwczsKPiA+ICsJdmJ0ID0gaTkxNS0+
dmJ0LmVkcC5wcHM7Cj4gPiAgIAkvKiBPbiBUb3NoaWJhIFNhdGVsbGl0ZSBQNTAtQy0xOEMgc3lz
dGVtIHRoZSBWQlQgVDEyIGRlbGF5Cj4gPiAgIAkgKiBvZiA1MDBtcyBhcHBlYXJzIHRvIGJlIHRv
byBzaG9ydC4gT2Nhc3Npb25hbGx5IHRoZSBwYW5lbAo+ID4gICAJICoganVzdCBmYWlscyB0byBw
b3dlciBiYWNrIG9uLiBJbmNyZWFzaW5nIHRoZSBkZWxheSB0byA4MDBtcwo+ID4gICAJICogc2Vl
bXMgc3VmZmljaWVudCB0byBhdm9pZCB0aGlzIHByb2JsZW0uCj4gPiAgIAkgKi8KPiA+IC0JaWYg
KGRldl9wcml2LT5xdWlya3MgJiBRVUlSS19JTkNSRUFTRV9UMTJfREVMQVkpIHsKPiA+ICsJaWYg
KGk5MTUtPnF1aXJrcyAmIFFVSVJLX0lOQ1JFQVNFX1QxMl9ERUxBWSkgewo+ID4gICAJCXZidC50
MTFfdDEyID0gbWF4X3QodTE2LCB2YnQudDExX3QxMiwgMTMwMCAqIDEwKTsKPiA+ICAgCQlEUk1f
REVCVUdfS01TKCJJbmNyZWFzaW5nIFQxMiBwYW5lbCBkZWxheSBhcyBwZXIgdGhlIHF1aXJrIHRv
ICVkXG4iLAo+ID4gICAJCQkgICAgICB2YnQudDExX3QxMik7Cj4gPiBAQCAtNjcxNCwxNCArNjcx
NCwxNCBAQCBzdGF0aWMgdm9pZAo+ID4gICBpbnRlbF9kcF9pbml0X3BhbmVsX3Bvd2VyX3NlcXVl
bmNlcl9yZWdpc3RlcnMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+ICAgCQkJCQkgICAg
ICBib29sIGZvcmNlX2Rpc2FibGVfdmRkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gICAJdTMyIHBw
X29uLCBwcF9vZmYsIHBvcnRfc2VsID0gMDsKPiA+IC0JaW50IGRpdiA9IGRldl9wcml2LT5yYXdj
bGtfZnJlcSAvIDEwMDA7Cj4gPiArCWludCBkaXYgPSBpOTE1LT5yYXdjbGtfZnJlcSAvIDEwMDA7
Cj4gPiAgIAlzdHJ1Y3QgcHBzX3JlZ2lzdGVycyByZWdzOwo+ID4gICAJZW51bSBwb3J0IHBvcnQg
PSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCktPmJhc2UucG9ydDsKPiA+ICAgCWNvbnN0IHN0cnVj
dCBlZHBfcG93ZXJfc2VxICpzZXEgPSAmaW50ZWxfZHAtPnBwc19kZWxheXM7Cj4gPiAtCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5wcHNfbXV0ZXgpOwo+ID4gKwlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZpOTE1LT5wcHNfbXV0ZXgpOwo+ID4gICAJaW50ZWxfcHBzX2dldF9yZWdpc3RlcnMo
aW50ZWxfZHAsICZyZWdzKTsKPiA+IEBAIC02NzU3LDkgKzY3NTcsOSBAQCBpbnRlbF9kcF9pbml0
X3BhbmVsX3Bvd2VyX3NlcXVlbmNlcl9yZWdpc3RlcnMoc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCwKPiA+ICAgCS8qIEhhc3dlbGwgZG9lc24ndCBoYXZlIGFueSBwb3J0IHNlbGVjdGlvbiBiaXRz
IGZvciB0aGUgcGFuZWwKPiA+ICAgCSAqIHBvd2VyIHNlcXVlbmNlciBhbnkgbW9yZS4gKi8KPiA+
IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYp
KSB7Cj4gPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkp
IHsKPiA+ICAgCQlwb3J0X3NlbCA9IFBBTkVMX1BPUlRfU0VMRUNUX1ZMVihwb3J0KTsKPiA+IC0J
fSBlbHNlIGlmIChIQVNfUENIX0lCWChkZXZfcHJpdikgfHwgSEFTX1BDSF9DUFQoZGV2X3ByaXYp
KSB7Cj4gPiArCX0gZWxzZSBpZiAoSEFTX1BDSF9JQlgoaTkxNSkgfHwgSEFTX1BDSF9DUFQoaTkx
NSkpIHsKPiA+ICAgCQlzd2l0Y2ggKHBvcnQpIHsKPiA+ICAgCQljYXNlIFBPUlRfQToKPiA+ICAg
CQkJcG9ydF9zZWwgPSBQQU5FTF9QT1JUX1NFTEVDVF9EUEE7Cj4gPiBAQCAtNjgwNyw5ICs2ODA3
LDkgQEAgaW50ZWxfZHBfaW5pdF9wYW5lbF9wb3dlcl9zZXF1ZW5jZXJfcmVnaXN0ZXJzKHN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2RwX3Bwc19pbml0
KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAtCWlmIChJ
U19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4g
KwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiAg
IAkJdmx2X2luaXRpYWxfcG93ZXJfc2VxdWVuY2VyX3NldHVwKGludGVsX2RwKTsKPiA+ICAgCX0g
ZWxzZSB7Cj4gPiAgIAkJaW50ZWxfZHBfaW5pdF9wYW5lbF9wb3dlcl9zZXF1ZW5jZXIoaW50ZWxf
ZHApOwo+ID4gQEAgLTY4MTksNyArNjgxOSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3Bwc19p
bml0KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9k
cF9zZXRfZHJyc19zdGF0ZSAtIHByb2dyYW0gcmVnaXN0ZXJzIGZvciBSUiBzd2l0Y2ggdG8gdGFr
ZSBlZmZlY3QKPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlCj4gPiArICogQGk5MTU6IGk5
MTUgZGV2aWNlCj4gPiAgICAqIEBjcnRjX3N0YXRlOiBhIHBvaW50ZXIgdG8gdGhlIGFjdGl2ZSBp
bnRlbF9jcnRjX3N0YXRlCj4gPiAgICAqIEByZWZyZXNoX3JhdGU6IFJSIHRvIGJlIHByb2dyYW1t
ZWQKPiA+ICAgICoKPiA+IEBAIC02ODI4LDE1ICs2ODI4LDE1IEBAIHN0YXRpYyB2b2lkIGludGVs
X2RwX3Bwc19pbml0KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgICAqIHN1cHBvcnRl
ZCBieSB0aGUgcGFuZWwgb3IgdG8gYW55IG90aGVyIFJSIGJhc2VkIG9uIG1lZGlhIHBsYXliYWNr
IChpbgo+ID4gICAgKiB0aGlzIGNhc2UsIFJSIHZhbHVlIG5lZWRzIHRvIGJlIHBhc3NlZCBmcm9t
IHVzZXIgc3BhY2UpLgo+ID4gICAgKgo+ID4gLSAqIFRoZSBjYWxsZXIgb2YgdGhpcyBmdW5jdGlv
biBuZWVkcyB0byB0YWtlIGEgbG9jayBvbiBkZXZfcHJpdi0+ZHJycy4KPiA+ICsgKiBUaGUgY2Fs
bGVyIG9mIHRoaXMgZnVuY3Rpb24gbmVlZHMgdG8gdGFrZSBhIGxvY2sgb24gaTkxNS0+ZHJycy4K
PiA+ICAgICovCj4gPiAtc3RhdGljIHZvaWQgaW50ZWxfZHBfc2V0X2RycnNfc3RhdGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGludGVsX2RwX3Nl
dF9kcnJzX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkJICAg
IGludCByZWZyZXNoX3JhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyOwo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBOVUxM
Owo+ID4gLQlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZGV2X3ByaXYtPmRycnMuZHA7Cj4g
PiArCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBpOTE1LT5kcnJzLmRwOwo+ID4gICAJc3Ry
dWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gPiAgIAllbnVtIGRycnNfcmVmcmVzaF9yYXRlX3R5cGUgaW5kZXggPSBEUlJT
X0hJR0hfUlI7Cj4gPiBAQCAtNjg1OCw3ICs2ODU4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHBf
c2V0X2RycnNfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
CXJldHVybjsKPiA+ICAgCX0KPiA+IC0JaWYgKGRldl9wcml2LT5kcnJzLnR5cGUgPCBTRUFNTEVT
U19EUlJTX1NVUFBPUlQpIHsKPiA+ICsJaWYgKGk5MTUtPmRycnMudHlwZSA8IFNFQU1MRVNTX0RS
UlNfU1VQUE9SVCkgewo+ID4gICAJCURSTV9ERUJVR19LTVMoIk9ubHkgU2VhbWxlc3MgRFJSUyBz
dXBwb3J0ZWQuXG4iKTsKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiBAQCAtNjg2Nyw3ICs2
ODY3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHBfc2V0X2RycnNfc3RhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCQlyZWZyZXNoX3JhdGUpCj4gPiAgIAkJaW5k
ZXggPSBEUlJTX0xPV19SUjsKPiA+IC0JaWYgKGluZGV4ID09IGRldl9wcml2LT5kcnJzLnJlZnJl
c2hfcmF0ZV90eXBlKSB7Cj4gPiArCWlmIChpbmRleCA9PSBpOTE1LT5kcnJzLnJlZnJlc2hfcmF0
ZV90eXBlKSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygKPiA+ICAgCQkJIkRSUlMgcmVxdWVzdGVk
IGZvciBwcmV2aW91c2x5IHNldCBSUi4uLmlnbm9yaW5nXG4iKTsKPiA+ICAgCQlyZXR1cm47Cj4g
PiBAQCAtNjg3OCw3ICs2ODc4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHBfc2V0X2RycnNfc3Rh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCXJldHVybjsKPiA+
ICAgCX0KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCAmJiAhSVNfQ0hFUlJZVklF
VyhkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4ICYmICFJU19DSEVS
UllWSUVXKGk5MTUpKSB7Cj4gPiAgIAkJc3dpdGNoIChpbmRleCkgewo+ID4gICAJCWNhc2UgRFJS
U19ISUdIX1JSOgo+ID4gICAJCQlpbnRlbF9kcF9zZXRfbV9uKGNydGNfc3RhdGUsIE0xX04xKTsK
PiA+IEBAIC02ODkwLDE4ICs2ODkwLDE4IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3NldF9kcnJz
X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQlkZWZhdWx0
Ogo+ID4gICAJCQlEUk1fRVJST1IoIlVuc3VwcG9ydGVkIHJlZnJlc2hyYXRlIHR5cGVcbiIpOwo+
ID4gICAJCX0KPiA+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID4gNikgewo+ID4g
Kwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+IDYpIHsKPiA+ICAgCQlpOTE1X3JlZ190IHJl
ZyA9IFBJUEVDT05GKGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKTsKPiA+ICAgCQl1MzIgdmFs
Owo+ID4gICAJCXZhbCA9IEk5MTVfUkVBRChyZWcpOwo+ID4gICAJCWlmIChpbmRleCA+IERSUlNf
SElHSF9SUikgewo+ID4gLQkJCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVS
UllWSUVXKGRldl9wcml2KSkKPiA+ICsJCQlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19D
SEVSUllWSUVXKGk5MTUpKQo+ID4gICAJCQkJdmFsIHw9IFBJUEVDT05GX0VEUF9SUl9NT0RFX1NX
SVRDSF9WTFY7Cj4gPiAgIAkJCWVsc2UKPiA+ICAgCQkJCXZhbCB8PSBQSVBFQ09ORl9FRFBfUlJf
TU9ERV9TV0lUQ0g7Cj4gPiAgIAkJfSBlbHNlIHsKPiA+IC0JCQlpZiAoSVNfVkFMTEVZVklFVyhk
ZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiArCQkJaWYgKElTX1ZBTExF
WVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICAgCQkJCXZhbCAmPSB+UElQ
RUNPTkZfRURQX1JSX01PREVfU1dJVENIX1ZMVjsKPiA+ICAgCQkJZWxzZQo+ID4gICAJCQkJdmFs
ICY9IH5QSVBFQ09ORl9FRFBfUlJfTU9ERV9TV0lUQ0g7Cj4gPiBAQCAtNjkwOSw3ICs2OTA5LDcg
QEAgc3RhdGljIHZvaWQgaW50ZWxfZHBfc2V0X2RycnNfc3RhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gICAJCUk5MTVfV1JJVEUocmVnLCB2YWwpOwo+ID4gICAJfQo+
ID4gLQlkZXZfcHJpdi0+ZHJycy5yZWZyZXNoX3JhdGVfdHlwZSA9IGluZGV4Owo+ID4gKwlpOTE1
LT5kcnJzLnJlZnJlc2hfcmF0ZV90eXBlID0gaW5kZXg7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJl
RFAgUmVmcmVzaCBSYXRlIHNldCB0byA6ICVkSHpcbiIsIHJlZnJlc2hfcmF0ZSk7Cj4gPiAgIH0K
PiA+IEBAIC02OTI0LDMwICs2OTI0LDMwIEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3NldF9kcnJz
X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgdm9pZCBpbnRl
bF9lZHBfZHJyc19lbmFibGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+ICAgCQkJICAg
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9k
cCk7Cj4gPiAgIAlpZiAoIWNydGNfc3RhdGUtPmhhc19kcnJzKSB7Cj4gPiAgIAkJRFJNX0RFQlVH
X0tNUygiUGFuZWwgZG9lc24ndCBzdXBwb3J0IERSUlNcbiIpOwo+ID4gICAJCXJldHVybjsKPiA+
ICAgCX0KPiA+IC0JaWYgKGRldl9wcml2LT5wc3IuZW5hYmxlZCkgewo+ID4gKwlpZiAoaTkxNS0+
cHNyLmVuYWJsZWQpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJQU1IgZW5hYmxlZC4gTm90IGVu
YWJsaW5nIERSUlMuXG4iKTsKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiAtCW11dGV4X2xv
Y2soJmRldl9wcml2LT5kcnJzLm11dGV4KTsKPiA+IC0JaWYgKGRldl9wcml2LT5kcnJzLmRwKSB7
Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmRycnMubXV0ZXgpOwo+ID4gKwlpZiAoaTkxNS0+ZHJy
cy5kcCkgewo+ID4gICAJCURSTV9ERUJVR19LTVMoIkRSUlMgYWxyZWFkeSBlbmFibGVkXG4iKTsK
PiA+ICAgCQlnb3RvIHVubG9jazsKPiA+ICAgCX0KPiA+IC0JZGV2X3ByaXYtPmRycnMuYnVzeV9m
cm9udGJ1ZmZlcl9iaXRzID0gMDsKPiA+ICsJaTkxNS0+ZHJycy5idXN5X2Zyb250YnVmZmVyX2Jp
dHMgPSAwOwo+ID4gLQlkZXZfcHJpdi0+ZHJycy5kcCA9IGludGVsX2RwOwo+ID4gKwlpOTE1LT5k
cnJzLmRwID0gaW50ZWxfZHA7Cj4gPiAgIHVubG9jazoKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+ZHJycy5tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJycy5tdXRleCk7
Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiBAQCAtNjk1OSwzNiArNjk1OSwzNiBAQCB2b2lkIGludGVs
X2VkcF9kcnJzX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ID4gICB2b2lkIGlu
dGVsX2VkcF9kcnJzX2Rpc2FibGUoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+ICAgCQkJ
ICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGlu
dGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1
KGludGVsX2RwKTsKPiA+ICAgCWlmICghb2xkX2NydGNfc3RhdGUtPmhhc19kcnJzKQo+ID4gICAJ
CXJldHVybjsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRycnMubXV0ZXgpOwo+ID4gLQlp
ZiAoIWRldl9wcml2LT5kcnJzLmRwKSB7Cj4gPiAtCQltdXRleF91bmxvY2soJmRldl9wcml2LT5k
cnJzLm11dGV4KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJycy5tdXRleCk7Cj4gPiArCWlm
ICghaTkxNS0+ZHJycy5kcCkgewo+ID4gKwkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcnJzLm11dGV4
KTsKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiAtCWlmIChkZXZfcHJpdi0+ZHJycy5yZWZy
ZXNoX3JhdGVfdHlwZSA9PSBEUlJTX0xPV19SUikKPiA+IC0JCWludGVsX2RwX3NldF9kcnJzX3N0
YXRlKGRldl9wcml2LCBvbGRfY3J0Y19zdGF0ZSwKPiA+ICsJaWYgKGk5MTUtPmRycnMucmVmcmVz
aF9yYXRlX3R5cGUgPT0gRFJSU19MT1dfUlIpCj4gPiArCQlpbnRlbF9kcF9zZXRfZHJyc19zdGF0
ZShpOTE1LCBvbGRfY3J0Y19zdGF0ZSwKPiA+ICAgCQkJaW50ZWxfZHAtPmF0dGFjaGVkX2Nvbm5l
Y3Rvci0+cGFuZWwuZml4ZWRfbW9kZS0+dnJlZnJlc2gpOwo+ID4gLQlkZXZfcHJpdi0+ZHJycy5k
cCA9IE5VTEw7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRycnMubXV0ZXgpOwo+ID4g
KwlpOTE1LT5kcnJzLmRwID0gTlVMTDsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcnJzLm11
dGV4KTsKPiA+IC0JY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZkZXZfcHJpdi0+ZHJycy53b3Jr
KTsKPiA+ICsJY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZpOTE1LT5kcnJzLndvcmspOwo+ID4g
ICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2VkcF9kcnJzX2Rvd25jbG9ja193b3JrKHN0cnVj
dCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPQo+ID4gLQkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqZGV2X3ByaXYp
LCBkcnJzLndvcmsud29yayk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0K
PiA+ICsJCWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmk5MTUpLCBkcnJzLndvcmsud29yayk7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwOwo+ID4gLQltdXRleF9sb2NrKCZkZXZf
cHJpdi0+ZHJycy5tdXRleCk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmRycnMubXV0ZXgpOwo+
ID4gLQlpbnRlbF9kcCA9IGRldl9wcml2LT5kcnJzLmRwOwo+ID4gKwlpbnRlbF9kcCA9IGk5MTUt
PmRycnMuZHA7Cj4gPiAgIAlpZiAoIWludGVsX2RwKQo+ID4gICAJCWdvdG8gdW5sb2NrOwo+ID4g
QEAgLTY5OTgsMjMgKzY5OTgsMjMgQEAgc3RhdGljIHZvaWQgaW50ZWxfZWRwX2RycnNfZG93bmNs
b2NrX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ID4gICAJICogcmVjaGVjay4KPiA+
ICAgCSAqLwo+ID4gLQlpZiAoZGV2X3ByaXYtPmRycnMuYnVzeV9mcm9udGJ1ZmZlcl9iaXRzKQo+
ID4gKwlpZiAoaTkxNS0+ZHJycy5idXN5X2Zyb250YnVmZmVyX2JpdHMpCj4gPiAgIAkJZ290byB1
bmxvY2s7Cj4gPiAtCWlmIChkZXZfcHJpdi0+ZHJycy5yZWZyZXNoX3JhdGVfdHlwZSAhPSBEUlJT
X0xPV19SUikgewo+ID4gKwlpZiAoaTkxNS0+ZHJycy5yZWZyZXNoX3JhdGVfdHlwZSAhPSBEUlJT
X0xPV19SUikgewo+ID4gICAJCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IGRwX3RvX2RpZ19wb3J0
KGludGVsX2RwKS0+YmFzZS5iYXNlLmNydGM7Cj4gPiAtCQlpbnRlbF9kcF9zZXRfZHJyc19zdGF0
ZShkZXZfcHJpdiwgdG9faW50ZWxfY3J0YyhjcnRjKS0+Y29uZmlnLAo+ID4gKwkJaW50ZWxfZHBf
c2V0X2RycnNfc3RhdGUoaTkxNSwgdG9faW50ZWxfY3J0YyhjcnRjKS0+Y29uZmlnLAo+ID4gICAJ
CQlpbnRlbF9kcC0+YXR0YWNoZWRfY29ubmVjdG9yLT5wYW5lbC5kb3duY2xvY2tfbW9kZS0+dnJl
ZnJlc2gpOwo+ID4gICAJfQo+ID4gICB1bmxvY2s6Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPmRycnMubXV0ZXgpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmRycnMubXV0ZXgpOwo+
ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9lZHBfZHJyc19pbnZhbGlkYXRlIC0gRGlz
YWJsZSBJZGxlbmVzcyBEUlJTCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZQo+ID4gKyAq
IEBpOTE1OiBpOTE1IGRldmljZQo+ID4gICAgKiBAZnJvbnRidWZmZXJfYml0czogZnJvbnRidWZm
ZXIgcGxhbmUgdHJhY2tpbmcgYml0cwo+ID4gICAgKgo+ID4gICAgKiBUaGlzIGZ1bmN0aW9uIGdl
dHMgY2FsbGVkIGV2ZXJ5dGltZSByZW5kZXJpbmcgb24gdGhlIGdpdmVuIHBsYW5lcyBzdGFydC4K
PiA+IEBAIC03MDIyLDQwICs3MDIyLDQwIEBAIHN0YXRpYyB2b2lkIGludGVsX2VkcF9kcnJzX2Rv
d25jbG9ja193b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgICoKPiA+ICAgICog
RGlydHkgZnJvbnRidWZmZXJzIHJlbGV2YW50IHRvIERSUlMgYXJlIHRyYWNrZWQgaW4gYnVzeV9m
cm9udGJ1ZmZlcl9iaXRzLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2VkcF9kcnJzX2ludmFs
aWRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgaW50ZWxf
ZWRwX2RycnNfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJICAgICAgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzKQo+ID4gICB7Cj4gPiAgIAlz
dHJ1Y3QgZHJtX2NydGMgKmNydGM7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZTsKPiA+IC0JaWYgKGRl
dl9wcml2LT5kcnJzLnR5cGUgPT0gRFJSU19OT1RfU1VQUE9SVEVEKQo+ID4gKwlpZiAoaTkxNS0+
ZHJycy50eXBlID09IERSUlNfTk9UX1NVUFBPUlRFRCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWNh
bmNlbF9kZWxheWVkX3dvcmsoJmRldl9wcml2LT5kcnJzLndvcmspOwo+ID4gKwljYW5jZWxfZGVs
YXllZF93b3JrKCZpOTE1LT5kcnJzLndvcmspOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+
ZHJycy5tdXRleCk7Cj4gPiAtCWlmICghZGV2X3ByaXYtPmRycnMuZHApIHsKPiA+IC0JCW11dGV4
X3VubG9jaygmZGV2X3ByaXYtPmRycnMubXV0ZXgpOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5k
cnJzLm11dGV4KTsKPiA+ICsJaWYgKCFpOTE1LT5kcnJzLmRwKSB7Cj4gPiArCQltdXRleF91bmxv
Y2soJmk5MTUtPmRycnMubXV0ZXgpOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0JY3J0
YyA9IGRwX3RvX2RpZ19wb3J0KGRldl9wcml2LT5kcnJzLmRwKS0+YmFzZS5iYXNlLmNydGM7Cj4g
PiArCWNydGMgPSBkcF90b19kaWdfcG9ydChpOTE1LT5kcnJzLmRwKS0+YmFzZS5iYXNlLmNydGM7
Cj4gPiAgIAlwaXBlID0gdG9faW50ZWxfY3J0YyhjcnRjKS0+cGlwZTsKPiA+ICAgCWZyb250YnVm
ZmVyX2JpdHMgJj0gSU5URUxfRlJPTlRCVUZGRVJfQUxMX01BU0socGlwZSk7Cj4gPiAtCWRldl9w
cml2LT5kcnJzLmJ1c3lfZnJvbnRidWZmZXJfYml0cyB8PSBmcm9udGJ1ZmZlcl9iaXRzOwo+ID4g
KwlpOTE1LT5kcnJzLmJ1c3lfZnJvbnRidWZmZXJfYml0cyB8PSBmcm9udGJ1ZmZlcl9iaXRzOwo+
ID4gICAJLyogaW52YWxpZGF0ZSBtZWFucyBidXN5IHNjcmVlbiBoZW5jZSB1cGNsb2NrICovCj4g
PiAtCWlmIChmcm9udGJ1ZmZlcl9iaXRzICYmIGRldl9wcml2LT5kcnJzLnJlZnJlc2hfcmF0ZV90
eXBlID09IERSUlNfTE9XX1JSKQo+ID4gLQkJaW50ZWxfZHBfc2V0X2RycnNfc3RhdGUoZGV2X3By
aXYsIHRvX2ludGVsX2NydGMoY3J0YyktPmNvbmZpZywKPiA+IC0JCQlkZXZfcHJpdi0+ZHJycy5k
cC0+YXR0YWNoZWRfY29ubmVjdG9yLT5wYW5lbC5maXhlZF9tb2RlLT52cmVmcmVzaCk7Cj4gPiAr
CWlmIChmcm9udGJ1ZmZlcl9iaXRzICYmIGk5MTUtPmRycnMucmVmcmVzaF9yYXRlX3R5cGUgPT0g
RFJSU19MT1dfUlIpCj4gPiArCQlpbnRlbF9kcF9zZXRfZHJyc19zdGF0ZShpOTE1LCB0b19pbnRl
bF9jcnRjKGNydGMpLT5jb25maWcsCj4gPiArCQkJaTkxNS0+ZHJycy5kcC0+YXR0YWNoZWRfY29u
bmVjdG9yLT5wYW5lbC5maXhlZF9tb2RlLT52cmVmcmVzaCk7Cj4gPiAtCW11dGV4X3VubG9jaygm
ZGV2X3ByaXYtPmRycnMubXV0ZXgpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmRycnMubXV0
ZXgpOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9lZHBfZHJyc19mbHVzaCAtIFJl
c3RhcnQgSWRsZW5lc3MgRFJSUwo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiA+ICsg
KiBAaTkxNTogaTkxNSBkZXZpY2UKPiA+ICAgICogQGZyb250YnVmZmVyX2JpdHM6IGZyb250YnVm
ZmVyIHBsYW5lIHRyYWNraW5nIGJpdHMKPiA+ICAgICoKPiA+ICAgICogVGhpcyBmdW5jdGlvbiBn
ZXRzIGNhbGxlZCBldmVyeSB0aW1lIHJlbmRlcmluZyBvbiB0aGUgZ2l2ZW4gcGxhbmVzIGhhcwo+
ID4gQEAgLTcwNjUsNDIgKzcwNjUsNDIgQEAgdm9pZCBpbnRlbF9lZHBfZHJyc19pbnZhbGlkYXRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgICoKPiA+ICAgICogRGly
dHkgZnJvbnRidWZmZXJzIHJlbGV2YW50IHRvIERSUlMgYXJlIHRyYWNrZWQgaW4gYnVzeV9mcm9u
dGJ1ZmZlcl9iaXRzLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2VkcF9kcnJzX2ZsdXNoKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2VkcF9kcnJz
X2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgIHVuc2lnbmVk
IGludCBmcm9udGJ1ZmZlcl9iaXRzKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNy
dGM7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZTsKPiA+IC0JaWYgKGRldl9wcml2LT5kcnJzLnR5cGUg
PT0gRFJSU19OT1RfU1VQUE9SVEVEKQo+ID4gKwlpZiAoaTkxNS0+ZHJycy50eXBlID09IERSUlNf
Tk9UX1NVUFBPUlRFRCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWNhbmNlbF9kZWxheWVkX3dvcmso
JmRldl9wcml2LT5kcnJzLndvcmspOwo+ID4gKwljYW5jZWxfZGVsYXllZF93b3JrKCZpOTE1LT5k
cnJzLndvcmspOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJycy5tdXRleCk7Cj4gPiAt
CWlmICghZGV2X3ByaXYtPmRycnMuZHApIHsKPiA+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYt
PmRycnMubXV0ZXgpOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5kcnJzLm11dGV4KTsKPiA+ICsJ
aWYgKCFpOTE1LT5kcnJzLmRwKSB7Cj4gPiArCQltdXRleF91bmxvY2soJmk5MTUtPmRycnMubXV0
ZXgpOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0JY3J0YyA9IGRwX3RvX2RpZ19wb3J0
KGRldl9wcml2LT5kcnJzLmRwKS0+YmFzZS5iYXNlLmNydGM7Cj4gPiArCWNydGMgPSBkcF90b19k
aWdfcG9ydChpOTE1LT5kcnJzLmRwKS0+YmFzZS5iYXNlLmNydGM7Cj4gPiAgIAlwaXBlID0gdG9f
aW50ZWxfY3J0YyhjcnRjKS0+cGlwZTsKPiA+ICAgCWZyb250YnVmZmVyX2JpdHMgJj0gSU5URUxf
RlJPTlRCVUZGRVJfQUxMX01BU0socGlwZSk7Cj4gPiAtCWRldl9wcml2LT5kcnJzLmJ1c3lfZnJv
bnRidWZmZXJfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKPiA+ICsJaTkxNS0+ZHJycy5idXN5
X2Zyb250YnVmZmVyX2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Cj4gPiAgIAkvKiBmbHVzaCBt
ZWFucyBidXN5IHNjcmVlbiBoZW5jZSB1cGNsb2NrICovCj4gPiAtCWlmIChmcm9udGJ1ZmZlcl9i
aXRzICYmIGRldl9wcml2LT5kcnJzLnJlZnJlc2hfcmF0ZV90eXBlID09IERSUlNfTE9XX1JSKQo+
ID4gLQkJaW50ZWxfZHBfc2V0X2RycnNfc3RhdGUoZGV2X3ByaXYsIHRvX2ludGVsX2NydGMoY3J0
YyktPmNvbmZpZywKPiA+IC0JCQkJZGV2X3ByaXYtPmRycnMuZHAtPmF0dGFjaGVkX2Nvbm5lY3Rv
ci0+cGFuZWwuZml4ZWRfbW9kZS0+dnJlZnJlc2gpOwo+ID4gKwlpZiAoZnJvbnRidWZmZXJfYml0
cyAmJiBpOTE1LT5kcnJzLnJlZnJlc2hfcmF0ZV90eXBlID09IERSUlNfTE9XX1JSKQo+ID4gKwkJ
aW50ZWxfZHBfc2V0X2RycnNfc3RhdGUoaTkxNSwgdG9faW50ZWxfY3J0YyhjcnRjKS0+Y29uZmln
LAo+ID4gKwkJCQlpOTE1LT5kcnJzLmRwLT5hdHRhY2hlZF9jb25uZWN0b3ItPnBhbmVsLmZpeGVk
X21vZGUtPnZyZWZyZXNoKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBmbHVzaCBhbHNvIG1lYW5zIG5v
IG1vcmUgYWN0aXZpdHkgaGVuY2Ugc2NoZWR1bGUgZG93bmNsb2NrLCBpZiBhbGwKPiA+ICAgCSAq
IG90aGVyIGZicyBhcmUgcXVpZXNjZW50IHRvbwo+ID4gICAJICovCj4gPiAtCWlmICghZGV2X3By
aXYtPmRycnMuYnVzeV9mcm9udGJ1ZmZlcl9iaXRzKQo+ID4gLQkJc2NoZWR1bGVfZGVsYXllZF93
b3JrKCZkZXZfcHJpdi0+ZHJycy53b3JrLAo+ID4gKwlpZiAoIWk5MTUtPmRycnMuYnVzeV9mcm9u
dGJ1ZmZlcl9iaXRzKQo+ID4gKwkJc2NoZWR1bGVfZGVsYXllZF93b3JrKCZpOTE1LT5kcnJzLndv
cmssCj4gPiAgIAkJCQltc2Vjc190b19qaWZmaWVzKDEwMDApKTsKPiA+IC0JbXV0ZXhfdW5sb2Nr
KCZkZXZfcHJpdi0+ZHJycy5tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJycy5t
dXRleCk7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiBAQCAtNzE1NywxOCArNzE1NywxOCBAQCBzdGF0
aWMgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKgo+ID4gICBpbnRlbF9kcF9kcnJzX2luaXQoc3Ry
dWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ID4gICAJCSAgIHN0cnVjdCBkcm1fZGlz
cGxheV9tb2RlICpmaXhlZF9tb2RlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsK
PiA+ICAgCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpkb3duY2xvY2tfbW9kZSA9IE5VTEw7Cj4g
PiAtCUlOSVRfREVMQVlFRF9XT1JLKCZkZXZfcHJpdi0+ZHJycy53b3JrLCBpbnRlbF9lZHBfZHJy
c19kb3duY2xvY2tfd29yayk7Cj4gPiAtCW11dGV4X2luaXQoJmRldl9wcml2LT5kcnJzLm11dGV4
KTsKPiA+ICsJSU5JVF9ERUxBWUVEX1dPUksoJmk5MTUtPmRycnMud29yaywgaW50ZWxfZWRwX2Ry
cnNfZG93bmNsb2NrX3dvcmspOwo+ID4gKwltdXRleF9pbml0KCZpOTE1LT5kcnJzLm11dGV4KTsK
PiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNikgewo+ID4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpIDw9IDYpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJEUlJTIHN1cHBvcnRlZCBmb3Ig
R2VuNyBhbmQgYWJvdmVcbiIpOwo+ID4gICAJCXJldHVybiBOVUxMOwo+ID4gICAJfQo+ID4gLQlp
ZiAoZGV2X3ByaXYtPnZidC5kcnJzX3R5cGUgIT0gU0VBTUxFU1NfRFJSU19TVVBQT1JUKSB7Cj4g
PiArCWlmIChpOTE1LT52YnQuZHJyc190eXBlICE9IFNFQU1MRVNTX0RSUlNfU1VQUE9SVCkgewo+
ID4gICAJCURSTV9ERUJVR19LTVMoIlZCVCBkb2Vzbid0IHN1cHBvcnQgRFJSU1xuIik7Cj4gPiAg
IAkJcmV0dXJuIE5VTEw7Cj4gPiAgIAl9Cj4gPiBAQCAtNzE3OSw5ICs3MTc5LDkgQEAgaW50ZWxf
ZHBfZHJyc19pbml0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgCQly
ZXR1cm4gTlVMTDsKPiA+ICAgCX0KPiA+IC0JZGV2X3ByaXYtPmRycnMudHlwZSA9IGRldl9wcml2
LT52YnQuZHJyc190eXBlOwo+ID4gKwlpOTE1LT5kcnJzLnR5cGUgPSBpOTE1LT52YnQuZHJyc190
eXBlOwo+ID4gLQlkZXZfcHJpdi0+ZHJycy5yZWZyZXNoX3JhdGVfdHlwZSA9IERSUlNfSElHSF9S
UjsKPiA+ICsJaTkxNS0+ZHJycy5yZWZyZXNoX3JhdGVfdHlwZSA9IERSUlNfSElHSF9SUjsKPiA+
ICAgCURSTV9ERUJVR19LTVMoInNlYW1sZXNzIERSUlMgc3VwcG9ydGVkIGZvciBlRFAgcGFuZWwu
XG4iKTsKPiA+ICAgCXJldHVybiBkb3duY2xvY2tfbW9kZTsKPiA+ICAgfQo+ID4gQEAgLTcxODks
OCArNzE4OSw4IEBAIGludGVsX2RwX2RycnNfaW5pdChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpj
b25uZWN0b3IsCj4gPiAgIHN0YXRpYyBib29sIGludGVsX2VkcF9pbml0X2Nvbm5lY3RvcihzdHJ1
Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ID4gICAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfY29ubmVj
dG9yICppbnRlbF9jb25uZWN0b3IpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAtCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9ICZpOTE1LT5kcm07Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0g
JmludGVsX2Nvbm5lY3Rvci0+YmFzZTsKPiA+ICAgCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpm
aXhlZF9tb2RlID0gTlVMTDsKPiA+ICAgCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpkb3duY2xv
Y2tfbW9kZSA9IE5VTEw7Cj4gPiBAQCAtNzIxMCw4ICs3MjEwLDggQEAgc3RhdGljIGJvb2wgaW50
ZWxfZWRwX2luaXRfY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIAkg
KiBlRFAgYW5kIExWRFMgYmFpbCBvdXQgZWFybHkgaW4gdGhpcyBjYXNlIHRvIHByZXZlbnQgaW50
ZXJmZXJpbmcKPiA+ICAgCSAqIHdpdGggYW4gYWxyZWFkeSBwb3dlcmVkLW9uIExWRFMgcG93ZXIg
c2VxdWVuY2VyLgo+ID4gICAJICovCj4gPiAtCWlmIChpbnRlbF9nZXRfbHZkc19lbmNvZGVyKGRl
dl9wcml2KSkgewo+ID4gLQkJV0FSTl9PTighKEhBU19QQ0hfSUJYKGRldl9wcml2KSB8fCBIQVNf
UENIX0NQVChkZXZfcHJpdikpKTsKPiA+ICsJaWYgKGludGVsX2dldF9sdmRzX2VuY29kZXIoaTkx
NSkpIHsKPiA+ICsJCVdBUk5fT04oIShIQVNfUENIX0lCWChpOTE1KSB8fCBIQVNfUENIX0NQVChp
OTE1KSkpOwo+ID4gICAJCURSTV9JTkZPKCJMVkRTIHdhcyBkZXRlY3RlZCwgbm90IHJlZ2lzdGVy
aW5nIGVEUFxuIik7Cj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTcyNTYsNyArNzI1Niw3
IEBAIHN0YXRpYyBib29sIGludGVsX2VkcF9pbml0X2Nvbm5lY3RvcihzdHJ1Y3QgaW50ZWxfZHAg
KmludGVsX2RwLAo+ID4gICAJCWZpeGVkX21vZGUgPSBpbnRlbF9wYW5lbF92YnRfZml4ZWRfbW9k
ZShpbnRlbF9jb25uZWN0b3IpOwo+ID4gICAJbXV0ZXhfdW5sb2NrKCZkZXYtPm1vZGVfY29uZmln
Lm11dGV4KTsKPiA+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJS
WVZJRVcoaTkxNSkpIHsKPiA+ICAgCQlpbnRlbF9kcC0+ZWRwX25vdGlmaWVyLm5vdGlmaWVyX2Nh
bGwgPSBlZHBfbm90aWZ5X2hhbmRsZXI7Cj4gPiAgIAkJcmVnaXN0ZXJfcmVib290X25vdGlmaWVy
KCZpbnRlbF9kcC0+ZWRwX25vdGlmaWVyKTsKPiA+IEBAIC03MzMwLDcgKzczMzAsNyBAQCBpbnRl
bF9kcF9pbml0X2Nvbm5lY3RvcihzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdf
cG9ydCwKPiA+ICAgCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSAmaW50ZWxfZGlnX3BvcnQt
PmRwOwo+ID4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIgPSAmaW50ZWxf
ZGlnX3BvcnQtPmJhc2U7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gaW50ZWxfZW5j
b2Rlci0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRldik7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGludGVsX2VuY29kZXItPnBvcnQ7Cj4g
PiAgIAlpbnQgdHlwZTsKPiA+IEBAIC03MzUzLDE4ICs3MzUzLDE4IEBAIGludGVsX2RwX2luaXRf
Y29ubmVjdG9yKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ID4g
ICAJaW50ZWxfZHAtPkRQID0gSTkxNV9SRUFEKGludGVsX2RwLT5vdXRwdXRfcmVnKTsKPiA+ICAg
CWludGVsX2RwLT5hdHRhY2hlZF9jb25uZWN0b3IgPSBpbnRlbF9jb25uZWN0b3I7Cj4gPiAtCWlm
IChpbnRlbF9kcF9pc19wb3J0X2VkcChkZXZfcHJpdiwgcG9ydCkpIHsKPiA+ICsJaWYgKGludGVs
X2RwX2lzX3BvcnRfZWRwKGk5MTUsIHBvcnQpKSB7Cj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBDdXJy
ZW50bHkgd2UgZG9uJ3Qgc3VwcG9ydCBlRFAgb24gVHlwZUMgcG9ydHMsIGFsdGhvdWdoIGluCj4g
PiAgIAkJICogdGhlb3J5IGl0IGNvdWxkIHdvcmsgb24gVHlwZUMgbGVnYWN5IHBvcnRzLgo+ID4g
ICAJCSAqLwo+ID4gLQkJV0FSTl9PTihpbnRlbF9wb3J0X2lzX3RjKGRldl9wcml2LCBwb3J0KSk7
Cj4gPiArCQlXQVJOX09OKGludGVsX3BvcnRfaXNfdGMoaTkxNSwgcG9ydCkpOwo+ID4gICAJCXR5
cGUgPSBEUk1fTU9ERV9DT05ORUNUT1JfZURQOwo+ID4gICAJfSBlbHNlIHsKPiA+ICAgCQl0eXBl
ID0gRFJNX01PREVfQ09OTkVDVE9SX0Rpc3BsYXlQb3J0Owo+ID4gICAJfQo+ID4gLQlpZiAoSVNf
VkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiArCWlm
IChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJaW50
ZWxfZHAtPmFjdGl2ZV9waXBlID0gdmx2X2FjdGl2ZV9waXBlKGludGVsX2RwKTsKPiA+ICAgCS8q
Cj4gPiBAQCAtNzM3Niw3ICs3Mzc2LDcgQEAgaW50ZWxfZHBfaW5pdF9jb25uZWN0b3Ioc3RydWN0
IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gPiAgIAkJaW50ZWxfZW5jb2Rl
ci0+dHlwZSA9IElOVEVMX09VVFBVVF9FRFA7Cj4gPiAgIAkvKiBlRFAgb25seSBvbiBwb3J0IEIg
YW5kL29yIEMgb24gdmx2L2NodiAqLwo+ID4gLQlpZiAoV0FSTl9PTigoSVNfVkFMTEVZVklFVyhk
ZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpICYmCj4gPiArCWlmIChXQVJOX09O
KChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpICYmCj4gPiAgIAkJ
ICAgIGludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkgJiYKPiA+ICAgCQkgICAgcG9ydCAhPSBQT1JU
X0IgJiYgcG9ydCAhPSBQT1JUX0MpKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IEBAIC03Mzg4
LDI2ICs3Mzg4LDI2IEBAIGludGVsX2RwX2luaXRfY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ID4gICAJZHJtX2Nvbm5lY3Rvcl9pbml0KGRldiwg
Y29ubmVjdG9yLCAmaW50ZWxfZHBfY29ubmVjdG9yX2Z1bmNzLCB0eXBlKTsKPiA+ICAgCWRybV9j
b25uZWN0b3JfaGVscGVyX2FkZChjb25uZWN0b3IsICZpbnRlbF9kcF9jb25uZWN0b3JfaGVscGVy
X2Z1bmNzKTsKPiA+IC0JaWYgKCFIQVNfR01DSChkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX0dN
Q0goaTkxNSkpCj4gPiAgIAkJY29ubmVjdG9yLT5pbnRlcmxhY2VfYWxsb3dlZCA9IHRydWU7Cj4g
PiAgIAljb25uZWN0b3ItPmRvdWJsZXNjYW5fYWxsb3dlZCA9IDA7Cj4gPiAtCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDExKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ID4g
ICAJCWNvbm5lY3Rvci0+eWNiY3JfNDIwX2FsbG93ZWQgPSB0cnVlOwo+ID4gLQlpbnRlbF9lbmNv
ZGVyLT5ocGRfcGluID0gaW50ZWxfaHBkX3Bpbl9kZWZhdWx0KGRldl9wcml2LCBwb3J0KTsKPiA+
ICsJaW50ZWxfZW5jb2Rlci0+aHBkX3BpbiA9IGludGVsX2hwZF9waW5fZGVmYXVsdChpOTE1LCBw
b3J0KTsKPiA+ICAgCWludGVsX2RwX2F1eF9pbml0KGludGVsX2RwKTsKPiA+ICAgCWludGVsX2Nv
bm5lY3Rvcl9hdHRhY2hfZW5jb2RlcihpbnRlbF9jb25uZWN0b3IsIGludGVsX2VuY29kZXIpOwo+
ID4gLQlpZiAoSEFTX0RESShkZXZfcHJpdikpCj4gPiArCWlmIChIQVNfRERJKGk5MTUpKQo+ID4g
ICAJCWludGVsX2Nvbm5lY3Rvci0+Z2V0X2h3X3N0YXRlID0gaW50ZWxfZGRpX2Nvbm5lY3Rvcl9n
ZXRfaHdfc3RhdGU7Cj4gPiAgIAllbHNlCj4gPiAgIAkJaW50ZWxfY29ubmVjdG9yLT5nZXRfaHdf
c3RhdGUgPSBpbnRlbF9jb25uZWN0b3JfZ2V0X2h3X3N0YXRlOwo+ID4gICAJLyogaW5pdCBNU1Qg
b24gcG9ydHMgdGhhdCBjYW4gc3VwcG9ydCBpdCAqLwo+ID4gLQlpZiAoSEFTX0RQX01TVChkZXZf
cHJpdikgJiYgIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkgJiYKPiA+ICsJaWYgKEhBU19EUF9N
U1QoaTkxNSkgJiYgIWludGVsX2RwX2lzX2VkcChpbnRlbF9kcCkgJiYKPiA+ICAgCSAgICAocG9y
dCA9PSBQT1JUX0IgfHwgcG9ydCA9PSBQT1JUX0MgfHwKPiA+ICAgCSAgICAgcG9ydCA9PSBQT1JU
X0QgfHwgcG9ydCA9PSBQT1JUX0YpKQo+ID4gICAJCWludGVsX2RwX21zdF9lbmNvZGVyX2luaXQo
aW50ZWxfZGlnX3BvcnQsCj4gPiBAQCAtNzQyMSw3ICs3NDIxLDcgQEAgaW50ZWxfZHBfaW5pdF9j
b25uZWN0b3Ioc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gPiAg
IAlpbnRlbF9kcF9hZGRfcHJvcGVydGllcyhpbnRlbF9kcCwgY29ubmVjdG9yKTsKPiA+IC0JaWYg
KGlzX2hkY3Bfc3VwcG9ydGVkKGRldl9wcml2LCBwb3J0KSAmJiAhaW50ZWxfZHBfaXNfZWRwKGlu
dGVsX2RwKSkgewo+ID4gKwlpZiAoaXNfaGRjcF9zdXBwb3J0ZWQoaTkxNSwgcG9ydCkgJiYgIWlu
dGVsX2RwX2lzX2VkcChpbnRlbF9kcCkpIHsKPiA+ICAgCQlpbnQgcmV0ID0gaW50ZWxfaGRjcF9p
bml0KGludGVsX2Nvbm5lY3RvciwgJmludGVsX2RwX2hkY3Bfc2hpbSk7Cj4gPiAgIAkJaWYgKHJl
dCkKPiA+ICAgCQkJRFJNX0RFQlVHX0tNUygiSERDUCBpbml0IGZhaWxlZCwgc2tpcHBpbmcuXG4i
KTsKPiA+IEBAIC03NDMxLDcgKzc0MzEsNyBAQCBpbnRlbF9kcF9pbml0X2Nvbm5lY3RvcihzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCwKPiA+ICAgCSAqIDB4ZC4gIEZh
aWx1cmUgdG8gZG8gc28gd2lsbCByZXN1bHQgaW4gc3B1cmlvdXMgaW50ZXJydXB0cyBiZWluZwo+
ID4gICAJICogZ2VuZXJhdGVkIG9uIHRoZSBwb3J0IHdoZW4gYSBjYWJsZSBpcyBub3QgYXR0YWNo
ZWQuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX0c0NShkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElT
X0c0NShpOTE1KSkgewo+ID4gICAJCXUzMiB0ZW1wID0gSTkxNV9SRUFEKFBFR19CQU5EX0dBUF9E
QVRBKTsKPiA+ICAgCQlJOTE1X1dSSVRFKFBFR19CQU5EX0dBUF9EQVRBLCAodGVtcCAmIH4weGYp
IHwgMHhkKTsKPiA+ICAgCX0KPiA+IEBAIC03NDQ0LDcgKzc0NDQsNyBAQCBpbnRlbF9kcF9pbml0
X2Nvbm5lY3RvcihzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCwKPiA+
ICAgCXJldHVybiBmYWxzZTsKPiA+ICAgfQo+ID4gLWJvb2wgaW50ZWxfZHBfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArYm9vbCBpbnRlbF9kcF9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCSAgIGk5MTVfcmVnX3Qgb3V0cHV0X3Jl
ZywKPiA+ICAgCQkgICBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+ID4gQEAgLTc0NjQsNyArNzQ2
NCw3IEBAIGJvb2wgaW50ZWxfZHBfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAgIAlpbnRlbF9lbmNvZGVyID0gJmludGVsX2RpZ19wb3J0LT5iYXNlOwo+ID4gICAJ
ZW5jb2RlciA9ICZpbnRlbF9lbmNvZGVyLT5iYXNlOwo+ID4gLQlpZiAoZHJtX2VuY29kZXJfaW5p
dCgmZGV2X3ByaXYtPmRybSwgJmludGVsX2VuY29kZXItPmJhc2UsCj4gPiArCWlmIChkcm1fZW5j
b2Rlcl9pbml0KCZpOTE1LT5kcm0sICZpbnRlbF9lbmNvZGVyLT5iYXNlLAo+ID4gICAJCQkgICAg
ICZpbnRlbF9kcF9lbmNfZnVuY3MsIERSTV9NT0RFX0VOQ09ERVJfVE1EUywKPiA+ICAgCQkJICAg
ICAiRFAgJWMiLCBwb3J0X25hbWUocG9ydCkpKQo+ID4gICAJCWdvdG8gZXJyX2VuY29kZXJfaW5p
dDsKPiA+IEBAIC03NDc1LDE0ICs3NDc1LDE0IEBAIGJvb2wgaW50ZWxfZHBfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlpbnRlbF9lbmNvZGVyLT5nZXRfY29u
ZmlnID0gaW50ZWxfZHBfZ2V0X2NvbmZpZzsKPiA+ICAgCWludGVsX2VuY29kZXItPnVwZGF0ZV9w
aXBlID0gaW50ZWxfcGFuZWxfdXBkYXRlX2JhY2tsaWdodDsKPiA+ICAgCWludGVsX2VuY29kZXIt
PnN1c3BlbmQgPSBpbnRlbF9kcF9lbmNvZGVyX3N1c3BlbmQ7Cj4gPiAtCWlmIChJU19DSEVSUllW
SUVXKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ID4gICAJ
CWludGVsX2VuY29kZXItPnByZV9wbGxfZW5hYmxlID0gY2h2X2RwX3ByZV9wbGxfZW5hYmxlOwo+
ID4gICAJCWludGVsX2VuY29kZXItPnByZV9lbmFibGUgPSBjaHZfcHJlX2VuYWJsZV9kcDsKPiA+
ICAgCQlpbnRlbF9lbmNvZGVyLT5lbmFibGUgPSB2bHZfZW5hYmxlX2RwOwo+ID4gICAJCWludGVs
X2VuY29kZXItPmRpc2FibGUgPSB2bHZfZGlzYWJsZV9kcDsKPiA+ICAgCQlpbnRlbF9lbmNvZGVy
LT5wb3N0X2Rpc2FibGUgPSBjaHZfcG9zdF9kaXNhYmxlX2RwOwo+ID4gICAJCWludGVsX2VuY29k
ZXItPnBvc3RfcGxsX2Rpc2FibGUgPSBjaHZfZHBfcG9zdF9wbGxfZGlzYWJsZTsKPiA+IC0JfSBl
bHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX1ZB
TExFWVZJRVcoaTkxNSkpIHsKPiA+ICAgCQlpbnRlbF9lbmNvZGVyLT5wcmVfcGxsX2VuYWJsZSA9
IHZsdl9kcF9wcmVfcGxsX2VuYWJsZTsKPiA+ICAgCQlpbnRlbF9lbmNvZGVyLT5wcmVfZW5hYmxl
ID0gdmx2X3ByZV9lbmFibGVfZHA7Cj4gPiAgIAkJaW50ZWxfZW5jb2Rlci0+ZW5hYmxlID0gdmx2
X2VuYWJsZV9kcDsKPiA+IEBAIC03NTAwLDcgKzc1MDAsNyBAQCBib29sIGludGVsX2RwX2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJaW50ZWxfZW5jb2Rlci0+
dHlwZSA9IElOVEVMX09VVFBVVF9EUDsKPiA+ICAgCWludGVsX2VuY29kZXItPnBvd2VyX2RvbWFp
biA9IGludGVsX3BvcnRfdG9fcG93ZXJfZG9tYWluKHBvcnQpOwo+ID4gLQlpZiAoSVNfQ0hFUlJZ
VklFVyhkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+ICAg
CQlpZiAocG9ydCA9PSBQT1JUX0QpCj4gPiAgIAkJCWludGVsX2VuY29kZXItPmNydGNfbWFzayA9
IDEgPDwgMjsKPiA+ICAgCQllbHNlCj4gPiBAQCAtNzUxNiw3ICs3NTE2LDcgQEAgYm9vbCBpbnRl
bF9kcF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWlmIChw
b3J0ICE9IFBPUlRfQSkKPiA+ICAgCQlpbnRlbF9pbmZvZnJhbWVfaW5pdChpbnRlbF9kaWdfcG9y
dCk7Cj4gPiAtCWludGVsX2RpZ19wb3J0LT5hdXhfY2ggPSBpbnRlbF9iaW9zX3BvcnRfYXV4X2No
KGRldl9wcml2LCBwb3J0KTsKPiA+ICsJaW50ZWxfZGlnX3BvcnQtPmF1eF9jaCA9IGludGVsX2Jp
b3NfcG9ydF9hdXhfY2goaTkxNSwgcG9ydCk7Cj4gPiAgIAlpZiAoIWludGVsX2RwX2luaXRfY29u
bmVjdG9yKGludGVsX2RpZ19wb3J0LCBpbnRlbF9jb25uZWN0b3IpKQo+ID4gICAJCWdvdG8gZXJy
X2luaXRfY29ubmVjdG9yOwo+ID4gQEAgLTc1MzEsMTEgKzc1MzEsMTEgQEAgYm9vbCBpbnRlbF9k
cF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXJldHVybiBm
YWxzZTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfZHBfbXN0X3N1c3BlbmQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfZHBfbXN0X3N1c3BlbmQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyOwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9lbmNvZGVyKCZkZXZfcHJpdi0+
ZHJtLCBlbmNvZGVyKSB7Cj4gPiArCWZvcl9lYWNoX2ludGVsX2VuY29kZXIoJmk5MTUtPmRybSwg
ZW5jb2Rlcikgewo+ID4gICAJCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHA7Cj4gPiAgIAkJaWYg
KGVuY29kZXItPnR5cGUgIT0gSU5URUxfT1VUUFVUX0RESSkKPiA+IEBAIC03NTUxLDExICs3NTUx
LDExIEBAIHZvaWQgaW50ZWxfZHBfbXN0X3N1c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gICAJfQo+ID4gICB9Cj4gPiAtdm9pZCBpbnRlbF9kcF9tc3RfcmVzdW1l
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGludGVsX2RwX21z
dF9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9lbmNvZGVy
KCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7Cj4gPiArCWZvcl9lYWNoX2ludGVsX2VuY29kZXIo
Jmk5MTUtPmRybSwgZW5jb2Rlcikgewo+ID4gICAJCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHA7
Cj4gPiAgIAkJaW50IHJldDsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9kcC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHAuaAo+ID4gaW5kZXggZGE3
MGIxYTQxYzgzLi5iNmZlY2IxODViMjMgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kcC5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcC5o
Cj4gPiBAQCAtMzUsMTAgKzM1LDEwIEBAIHZvaWQgaW50ZWxfZHBfYWRqdXN0X2NvbXBsaWFuY2Vf
Y29uZmlnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIGJvb2wgaW50ZWxfZHBfbGlt
aXRlZF9jb2xvcl9yYW5nZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKPiA+ICAgCQkJCSAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3Rh
dGUpOwo+ID4gICBpbnQgaW50ZWxfZHBfbWluX2JwcChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gPiAtYm9vbCBpbnRlbF9kcF9wb3J0X2VuYWJsZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2Jvb2wgaW50ZWxfZHBfcG9ydF9lbmFi
bGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICBpOTE1X3JlZ190
IGRwX3JlZywgZW51bSBwb3J0IHBvcnQsCj4gPiAgIAkJCSAgIGVudW0gcGlwZSAqcGlwZSk7Cj4g
PiAtYm9vbCBpbnRlbF9kcF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
aTkxNV9yZWdfdCBvdXRwdXRfcmVnLAo+ID4gK2Jvb2wgaW50ZWxfZHBfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwgaTkxNV9yZWdfdCBvdXRwdXRfcmVnLAo+ID4gICAJCSAgIGVu
dW0gcG9ydCBwb3J0KTsKPiA+ICAgYm9vbCBpbnRlbF9kcF9pbml0X2Nvbm5lY3RvcihzdHJ1Y3Qg
aW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCwKPiA+ICAgCQkJICAgICBzdHJ1Y3Qg
aW50ZWxfY29ubmVjdG9yICppbnRlbF9jb25uZWN0b3IpOwo+ID4gQEAgLTYwLDcgKzYwLDcgQEAg
aW50IGludGVsX2RwX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ID4gICAJCQkgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ID4g
ICAJCQkgICAgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpOwo+ID4gICBi
b29sIGludGVsX2RwX2lzX2VkcChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsKPiA+IC1ib29s
IGludGVsX2RwX2lzX3BvcnRfZWRwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
ZW51bSBwb3J0IHBvcnQpOwo+ID4gK2Jvb2wgaW50ZWxfZHBfaXNfcG9ydF9lZHAoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcG9ydCBwb3J0KTsKPiA+ICAgZW51bSBpcnFyZXR1
cm4gaW50ZWxfZHBfaHBkX3B1bHNlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2Rp
Z19wb3J0LAo+ID4gICAJCQkJICBib29sIGxvbmdfaHBkKTsKPiA+ICAgdm9pZCBpbnRlbF9lZHBf
YmFja2xpZ2h0X29uKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ID4gQEAgLTY5LDIxICs2OSwyMSBAQCB2b2lkIGludGVsX2VkcF9iYWNrbGlnaHRfb2ZmKGNvbnN0
IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKTsKPiA+ICAgdm9pZCBpbnRl
bF9lZHBfcGFuZWxfdmRkX29uKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApOwo+ID4gICB2b2lk
IGludGVsX2VkcF9wYW5lbF9vbihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsKPiA+ICAgdm9p
ZCBpbnRlbF9lZHBfcGFuZWxfb2ZmKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApOwo+ID4gLXZv
aWQgaW50ZWxfZHBfbXN0X3N1c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiA+IC12b2lkIGludGVsX2RwX21zdF9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiA+ICt2b2lkIGludGVsX2RwX21zdF9zdXNwZW5kKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX2RwX21zdF9yZXN1bWUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICBpbnQgaW50ZWxfZHBfbWF4X2xpbmtfcmF0ZShz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKTsKPiA+ICAgaW50IGludGVsX2RwX21heF9sYW5lX2Nv
dW50KHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApOwo+ID4gICBpbnQgaW50ZWxfZHBfcmF0ZV9z
ZWxlY3Qoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwgaW50IHJhdGUpOwo+ID4gLXZvaWQgaW50
ZWxfcG93ZXJfc2VxdWVuY2VyX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dik7Cj4gPiArdm9pZCBpbnRlbF9wb3dlcl9zZXF1ZW5jZXJfcmVzZXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpOwo+ID4gICB1MzIgaW50ZWxfZHBfcGFja19hdXgoY29uc3QgdTggKnNy
YywgaW50IHNyY19ieXRlcyk7Cj4gPiAgIHZvaWQgaW50ZWxfZWRwX2RycnNfZW5hYmxlKHN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIAkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKTsKPiA+ICAgdm9pZCBpbnRlbF9lZHBfZHJyc19kaXNhYmxlKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIAkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gPiAtdm9pZCBpbnRlbF9lZHBfZHJyc19pbnZhbGlk
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2Vk
cF9kcnJzX2ludmFsaWRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJ
CSAgICAgICB1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0cyk7Cj4gPiAtdm9pZCBpbnRlbF9l
ZHBfZHJyc19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9p
ZCBpbnRlbF9lZHBfZHJyc19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+
ICAgCQkJICB1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0cyk7Cj4gPiAgIHZvaWQKPiA+IEBA
IC0xMTIsNyArMTEyLDcgQEAgYm9vbCBpbnRlbF9kcF9nZXRfY29sb3JpbWV0cnlfc3RhdHVzKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApOwo+ID4gICBpbnQgaW50ZWxfZHBfbGlua19yZXF1aXJl
ZChpbnQgcGl4ZWxfY2xvY2ssIGludCBicHApOwo+ID4gICBpbnQgaW50ZWxfZHBfbWF4X2RhdGFf
cmF0ZShpbnQgbWF4X2xpbmtfY2xvY2ssIGludCBtYXhfbGFuZXMpOwo+ID4gICBib29sIGludGVs
X2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpOwo+
ID4gLXZvaWQgaWNsX3RjX3BoeV9kaXNjb25uZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICt2b2lkIGljbF90Y19waHlfZGlzY29ubmVjdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGln
X3BvcnQpOwo+ID4gICBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBpbnRlbF9kcF91bnVzZWRf
bGFuZV9tYXNrKGludCBsYW5lX2NvdW50KQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX2RwX2F1eF9iYWNrbGlnaHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2RwX2F1eF9iYWNrbGlnaHQuYwo+ID4gaW5kZXggN2RlZDk1YTMzNGRiLi43YTNiZDI5ZGNm
MGIgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcF9hdXhfYmFj
a2xpZ2h0LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwX2F1eF9iYWNr
bGlnaHQuYwo+ID4gQEAgLTEwOSw3ICsxMDksNyBAQCBpbnRlbF9kcF9hdXhfc2V0X2JhY2tsaWdo
dChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSwgdTMyIGxldgo+
ID4gICAgKi8KPiA+ICAgc3RhdGljIGJvb2wgaW50ZWxfZHBfYXV4X3NldF9wd21fZnJlcShzdHJ1
Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFz
ZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGVuY190b19pbnRlbF9k
cCgmY29ubmVjdG9yLT5lbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWludCBmcmVxLCBmeHAsIGZ4cF9t
aW4sIGZ4cF9tYXgsIGZ4cF9hY3R1YWwsIGYgPSAxOwo+ID4gICAJdTggcG4sIHBuX21pbiwgcG5f
bWF4Owo+ID4gQEAgLTExOCw3ICsxMTgsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9kcF9hdXhfc2V0
X3B3bV9mcmVxKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgCSAqIE5v
dGUgdGhhdCwgaWYgRiB4IFAgaXMgb3V0IG9mIHN1cHBvcnRlZCByYW5nZSwgdGhlIG1heGltdW0g
dmFsdWUgb3IKPiA+ICAgCSAqIG1pbmltdW0gdmFsdWUgd2lsbCBhcHBsaWVkIGF1dG9tYXRpY2Fs
bHkuIFNvIG5vIG5lZWQgdG8gY2hlY2sgdGhhdC4KPiA+ICAgCSAqLwo+ID4gLQlmcmVxID0gZGV2
X3ByaXYtPnZidC5iYWNrbGlnaHQucHdtX2ZyZXFfaHo7Cj4gPiArCWZyZXEgPSBpOTE1LT52YnQu
YmFja2xpZ2h0LnB3bV9mcmVxX2h6Owo+ID4gICAJRFJNX0RFQlVHX0tNUygiVkJUIGRlZmluZWQg
YmFja2xpZ2h0IGZyZXF1ZW5jeSAldSBIelxuIiwgZnJlcSk7Cj4gPiAgIAlpZiAoIWZyZXEpIHsK
PiA+ICAgCQlEUk1fREVCVUdfS01TKCJVc2UgcGFuZWwgZGVmYXVsdCBiYWNrbGlnaHQgZnJlcXVl
bmN5XG4iKTsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcF9t
c3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwX21zdC5jCj4gPiBpbmRleCAwY2Fm
NjQ1ZmJiYjguLmFiMjFkYzY5MGM5ZiAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2RwX21zdC5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9k
cF9tc3QuYwo+ID4gQEAgLTkxLDcgKzkxLDcgQEAgc3RhdGljIGludCBpbnRlbF9kcF9tc3RfY29t
cHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkgICAg
ICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+ID4gICAJCQkJICAgICAg
IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RwX21zdF9lbmNvZGVyICppbnRlbF9t
c3QgPSBlbmNfdG9fbXN0KCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHAgPSAmaW50ZWxfbXN0LT5wcmltYXJ5LT5kcDsKPiA+ICAgCXN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvciA9Cj4gPiBAQCAtMTQwLDExICsxNDAsMTEgQEAgc3RhdGljIGlu
dCBpbnRlbF9kcF9tc3RfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gPiAgIAlwaXBlX2NvbmZpZy0+bGltaXRlZF9jb2xvcl9yYW5nZSA9Cj4gPiAgIAkJaW50
ZWxfZHBfbGltaXRlZF9jb2xvcl9yYW5nZShwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7Cj4gPiAt
CWlmIChJU19HRU45X0xQKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4g
PiAgIAkJcGlwZV9jb25maWctPmxhbmVfbGF0X29wdGltX21hc2sgPQo+ID4gICAJCQlieHRfZGRp
X3BoeV9jYWxjX2xhbmVfbGF0X29wdGltX21hc2socGlwZV9jb25maWctPmxhbmVfY291bnQpOwo+
ID4gLQlpbnRlbF9kZGlfY29tcHV0ZV9taW5fdm9sdGFnZV9sZXZlbChkZXZfcHJpdiwgcGlwZV9j
b25maWcpOwo+ID4gKwlpbnRlbF9kZGlfY29tcHV0ZV9taW5fdm9sdGFnZV9sZXZlbChpOTE1LCBw
aXBlX2NvbmZpZyk7Cj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4gQEAgLTI4NSw3ICsyODUs
NyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tc3RfcHJlX2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiA+ICAgCXN0cnVjdCBpbnRlbF9kcF9tc3RfZW5jb2RlciAqaW50ZWxf
bXN0ID0gZW5jX3RvX21zdCgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGln
aXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCA9IGludGVsX21zdC0+cHJpbWFyeTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSAmaW50ZWxfZGlnX3BvcnQtPmRwOwo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2Uu
cG9ydDsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9Cj4gPiAgIAkJ
dG9faW50ZWxfY29ubmVjdG9yKGNvbm5fc3RhdGUtPmNvbm5lY3Rvcik7Cj4gPiBAQCAtMzMyLDEy
ICszMzIsMTIgQEAgc3RhdGljIHZvaWQgaW50ZWxfbXN0X2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCXN0cnVjdCBpbnRlbF9kcF9tc3RfZW5jb2RlciAqaW50
ZWxfbXN0ID0gZW5jX3RvX21zdCgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCA9IGludGVsX21zdC0+cHJpbWFyeTsKPiA+ICAg
CXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSAmaW50ZWxfZGlnX3BvcnQtPmRwOwo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2Uu
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29k
ZXItPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJh
c2UucG9ydDsKPiA+ICAgCURSTV9ERUJVR19LTVMoImFjdGl2ZSBsaW5rcyAlZFxuIiwgaW50ZWxf
ZHAtPmFjdGl2ZV9tc3RfbGlua3MpOwo+ID4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIo
JmRldl9wcml2LT51bmNvcmUsCj4gPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkx
NS0+dW5jb3JlLAo+ID4gICAJCQkJICAgIERQX1RQX1NUQVRVUyhwb3J0KSwKPiA+ICAgCQkJCSAg
ICBEUF9UUF9TVEFUVVNfQUNUX1NFTlQsCj4gPiAgIAkJCQkgICAgRFBfVFBfU1RBVFVTX0FDVF9T
RU5ULAo+ID4gQEAgLTQ5NSw3ICs0OTUsNyBAQCBzdGF0aWMgc3RydWN0IGRybV9jb25uZWN0b3Ig
KmludGVsX2RwX2FkZF9tc3RfY29ubmVjdG9yKHN0cnVjdCBkcm1fZHBfbXN0X3RvcG9sbwo+ID4g
ICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGNvbnRhaW5lcl9vZihtZ3IsIHN0cnVjdCBp
bnRlbF9kcCwgbXN0X21ncik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRl
bF9kaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPiA+ICAgCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYgPSBpbnRlbF9kaWdfcG9ydC0+YmFzZS5iYXNlLmRldjsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvcjsKPiA+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9y
ICpjb25uZWN0b3I7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZTsKPiA+IEBAIC01MjAsNyArNTIwLDcg
QEAgc3RhdGljIHN0cnVjdCBkcm1fY29ubmVjdG9yICppbnRlbF9kcF9hZGRfbXN0X2Nvbm5lY3Rv
cihzdHJ1Y3QgZHJtX2RwX21zdF90b3BvbG8KPiA+ICAgCWRybV9jb25uZWN0b3JfaGVscGVyX2Fk
ZChjb25uZWN0b3IsICZpbnRlbF9kcF9tc3RfY29ubmVjdG9yX2hlbHBlcl9mdW5jcyk7Cj4gPiAt
CWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKPiA+ICsJZm9yX2VhY2hfcGlwZShpOTE1
LCBwaXBlKSB7Cj4gPiAgIAkJc3RydWN0IGRybV9lbmNvZGVyICplbmMgPQo+ID4gICAJCQkmaW50
ZWxfZHAtPm1zdF9lbmNvZGVyc1twaXBlXS0+YmFzZS5iYXNlOwo+ID4gQEAgLTU0OSwxMCArNTQ5
LDEwIEBAIHN0YXRpYyBzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqaW50ZWxfZHBfYWRkX21zdF9jb25u
ZWN0b3Ioc3RydWN0IGRybV9kcF9tc3RfdG9wb2xvCj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2Rw
X3JlZ2lzdGVyX21zdF9jb25uZWN0b3Ioc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+IC0JaWYgKGRldl9wcml2LT5mYmRldikKPiA+IC0J
CWRybV9mYl9oZWxwZXJfYWRkX29uZV9jb25uZWN0b3IoJmRldl9wcml2LT5mYmRldi0+aGVscGVy
LAo+ID4gKwlpZiAoaTkxNS0+ZmJkZXYpCj4gPiArCQlkcm1fZmJfaGVscGVyX2FkZF9vbmVfY29u
bmVjdG9yKCZpOTE1LT5mYmRldi0+aGVscGVyLAo+ID4gICAJCQkJCQljb25uZWN0b3IpOwo+ID4g
ICAJZHJtX2Nvbm5lY3Rvcl9yZWdpc3Rlcihjb25uZWN0b3IpOwo+ID4gQEAgLTU2MSwxMyArNTYx
LDEzIEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3JlZ2lzdGVyX21zdF9jb25uZWN0b3Ioc3RydWN0
IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfZHBfZGVz
dHJveV9tc3RfY29ubmVjdG9yKHN0cnVjdCBkcm1fZHBfbXN0X3RvcG9sb2d5X21nciAqbWdyLAo+
ID4gICAJCQkJCSAgIHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3It
PmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25u
ZWN0b3ItPmRldik7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJbQ09OTkVDVE9SOiVkOiVzXVxuIiwg
Y29ubmVjdG9yLT5iYXNlLmlkLCBjb25uZWN0b3ItPm5hbWUpOwo+ID4gICAJZHJtX2Nvbm5lY3Rv
cl91bnJlZ2lzdGVyKGNvbm5lY3Rvcik7Cj4gPiAtCWlmIChkZXZfcHJpdi0+ZmJkZXYpCj4gPiAt
CQlkcm1fZmJfaGVscGVyX3JlbW92ZV9vbmVfY29ubmVjdG9yKCZkZXZfcHJpdi0+ZmJkZXYtPmhl
bHBlciwKPiA+ICsJaWYgKGk5MTUtPmZiZGV2KQo+ID4gKwkJZHJtX2ZiX2hlbHBlcl9yZW1vdmVf
b25lX2Nvbm5lY3RvcigmaTkxNS0+ZmJkZXYtPmhlbHBlciwKPiA+ICAgCQkJCQkJICAgY29ubmVj
dG9yKTsKPiA+ICAgCWRybV9jb25uZWN0b3JfcHV0KGNvbm5lY3Rvcik7Cj4gPiBAQCAtNjIyLDEw
ICs2MjIsMTAgQEAgc3RhdGljIGJvb2wKPiA+ICAgaW50ZWxfZHBfY3JlYXRlX2Zha2VfbXN0X2Vu
Y29kZXJzKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0KQo+ID4gICB7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gJmludGVsX2RpZ19wb3J0LT5kcDsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShpbnRlbF9k
aWdfcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShpbnRlbF9kaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7Cj4gPiAgIAllbnVt
IHBpcGUgcGlwZTsKPiA+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkKPiA+ICsJZm9y
X2VhY2hfcGlwZShpOTE1LCBwaXBlKQo+ID4gICAJCWludGVsX2RwLT5tc3RfZW5jb2RlcnNbcGlw
ZV0gPSBpbnRlbF9kcF9jcmVhdGVfZmFrZV9tc3RfZW5jb2RlcihpbnRlbF9kaWdfcG9ydCwgcGlw
ZSk7Cj4gPiAgIAlyZXR1cm4gdHJ1ZTsKPiA+ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2RwaW9fcGh5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9kcGlvX3BoeS5jCj4gPiBpbmRleCBiZGJlNDE3NTk4MjcuLmM4NTY3MmJiMWE3ZCAxMDA2NDQK
PiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwaW9fcGh5LmMKPiA+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwaW9fcGh5LmMKPiA+IEBAIC0yMTIsOSArMjEy
LDkgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBieHRfZGRpX3BoeV9pbmZvIGdsa19kZGlfcGh5X2lu
Zm9bXSA9IHsKPiA+ICAgfTsKPiA+ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBieHRfZGRpX3BoeV9p
bmZvICoKPiA+IC1ieHRfZ2V0X3BoeV9saXN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgaW50ICpjb3VudCkKPiA+ICtieHRfZ2V0X3BoeV9saXN0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBpbnQgKmNvdW50KQo+ID4gICB7Cj4gPiAtCWlmIChJU19HRU1JTklMQUtF
KGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkgewo+ID4gICAJCSpj
b3VudCA9ICBBUlJBWV9TSVpFKGdsa19kZGlfcGh5X2luZm8pOwo+ID4gICAJCXJldHVybiBnbGtf
ZGRpX3BoeV9pbmZvOwo+ID4gICAJfSBlbHNlIHsKPiA+IEBAIC0yMjQsMjIgKzIyNCwyMiBAQCBi
eHRfZ2V0X3BoeV9saXN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50ICpj
b3VudCkKPiA+ICAgfQo+ID4gICBzdGF0aWMgY29uc3Qgc3RydWN0IGJ4dF9kZGlfcGh5X2luZm8g
Kgo+ID4gLWJ4dF9nZXRfcGh5X2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBlbnVtIGRwaW9fcGh5IHBoeSkKPiA+ICtieHRfZ2V0X3BoeV9pbmZvKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LCBlbnVtIGRwaW9fcGh5IHBoeSkKPiA+ICAgewo+ID4gICAJaW50IGNv
dW50Owo+ID4gICAJY29uc3Qgc3RydWN0IGJ4dF9kZGlfcGh5X2luZm8gKnBoeV9saXN0ID0KPiA+
IC0JCWJ4dF9nZXRfcGh5X2xpc3QoZGV2X3ByaXYsICZjb3VudCk7Cj4gPiArCQlieHRfZ2V0X3Bo
eV9saXN0KGk5MTUsICZjb3VudCk7Cj4gPiAgIAlyZXR1cm4gJnBoeV9saXN0W3BoeV07Cj4gPiAg
IH0KPiA+IC12b2lkIGJ4dF9wb3J0X3RvX3BoeV9jaGFubmVsKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQsCj4gPiArdm9pZCBieHRfcG9ydF90b19waHlf
Y2hhbm5lbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0IHBvcnQsCj4g
PiAgIAkJCSAgICAgZW51bSBkcGlvX3BoeSAqcGh5LCBlbnVtIGRwaW9fY2hhbm5lbCAqY2gpCj4g
PiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVjdCBieHRfZGRpX3BoeV9pbmZvICpwaHlfaW5mbywgKnBo
eXM7Cj4gPiAgIAlpbnQgaSwgY291bnQ7Cj4gPiAtCXBoeXMgPSBieHRfZ2V0X3BoeV9saXN0KGRl
dl9wcml2LCAmY291bnQpOwo+ID4gKwlwaHlzID0gYnh0X2dldF9waHlfbGlzdChpOTE1LCAmY291
bnQpOwo+ID4gICAJZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKPiA+ICAgCQlwaHlfaW5m
byA9ICZwaHlzW2ldOwo+ID4gQEAgLTI2Myw3ICsyNjMsNyBAQCB2b2lkIGJ4dF9wb3J0X3RvX3Bo
eV9jaGFubmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBv
cnQsCj4gPiAgIAkqY2ggPSBEUElPX0NIMDsKPiA+ICAgfQo+ID4gLXZvaWQgYnh0X2RkaV9waHlf
c2V0X3NpZ25hbF9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAr
dm9pZCBieHRfZGRpX3BoeV9zZXRfc2lnbmFsX2xldmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ID4gICAJCQkJICBlbnVtIHBvcnQgcG9ydCwgdTMyIG1hcmdpbiwgdTMyIHNjYWxl
LAo+ID4gICAJCQkJICB1MzIgZW5hYmxlLCB1MzIgZGVlbXBoYXNpcykKPiA+ICAgewo+ID4gQEAg
LTI3MSw3ICsyNzEsNyBAQCB2b2lkIGJ4dF9kZGlfcGh5X3NldF9zaWduYWxfbGV2ZWwoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJZW51bSBkcGlvX3BoeSBwaHk7Cj4g
PiAgIAllbnVtIGRwaW9fY2hhbm5lbCBjaDsKPiA+IC0JYnh0X3BvcnRfdG9fcGh5X2NoYW5uZWwo
ZGV2X3ByaXYsIHBvcnQsICZwaHksICZjaCk7Cj4gPiArCWJ4dF9wb3J0X3RvX3BoeV9jaGFubmVs
KGk5MTUsIHBvcnQsICZwaHksICZjaCk7Cj4gPiAgIAkvKgo+ID4gICAJICogV2hpbGUgd2Ugd3Jp
dGUgdG8gdGhlIGdyb3VwIHJlZ2lzdGVyIHRvIHByb2dyYW0gYWxsIGxhbmVzIGF0IG9uY2Ugd2UK
PiA+IEBAIC0zMDYsMTIgKzMwNiwxMiBAQCB2b2lkIGJ4dF9kZGlfcGh5X3NldF9zaWduYWxfbGV2
ZWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJSTkxNV9XUklURShC
WFRfUE9SVF9QQ1NfRFcxMF9HUlAocGh5LCBjaCksIHZhbCk7Cj4gPiAgIH0KPiA+IC1ib29sIGJ4
dF9kZGlfcGh5X2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK2Jvb2wgYnh0X2RkaV9waHlfaXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJICAgIGVudW0gZHBpb19waHkgcGh5KQo+ID4gICB7Cj4gPiAgIAljb25z
dCBzdHJ1Y3QgYnh0X2RkaV9waHlfaW5mbyAqcGh5X2luZm87Cj4gPiAtCXBoeV9pbmZvID0gYnh0
X2dldF9waHlfaW5mbyhkZXZfcHJpdiwgcGh5KTsKPiA+ICsJcGh5X2luZm8gPSBieHRfZ2V0X3Bo
eV9pbmZvKGk5MTUsIHBoeSk7Cj4gPiAgIAlpZiAoIShJOTE1X1JFQUQoQlhUX1BfQ1JfR1RfRElT
UF9QV1JPTikgJiBwaHlfaW5mby0+cHdyb25fbWFzaykpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+
ID4gQEAgLTMzNCwzNyArMzM0LDM3IEBAIGJvb2wgYnh0X2RkaV9waHlfaXNfZW5hYmxlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXR1cm4gdHJ1ZTsKPiA+ICAg
fQo+ID4gLXN0YXRpYyB1MzIgYnh0X2dldF9ncmMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LCBlbnVtIGRwaW9fcGh5IHBoeSkKPiA+ICtzdGF0aWMgdTMyIGJ4dF9nZXRfZ3JjKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIGRwaW9fcGh5IHBoeSkKPiA+ICAgewo+
ID4gICAJdTMyIHZhbCA9IEk5MTVfUkVBRChCWFRfUE9SVF9SRUZfRFc2KHBoeSkpOwo+ID4gICAJ
cmV0dXJuICh2YWwgJiBHUkNfQ09ERV9NQVNLKSA+PiBHUkNfQ09ERV9TSElGVDsKPiA+ICAgfQo+
ID4gLXN0YXRpYyB2b2lkIGJ4dF9waHlfd2FpdF9ncmNfZG9uZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgYnh0X3BoeV93YWl0X2dyY19kb25lKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICBlbnVtIGRwaW9fcGh5IHBo
eSkKPiA+ICAgewo+ID4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51
bmNvcmUsCj4gPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+
ID4gICAJCQkJICAgIEJYVF9QT1JUX1JFRl9EVzMocGh5KSwKPiA+ICAgCQkJCSAgICBHUkNfRE9O
RSwgR1JDX0RPTkUsCj4gPiAgIAkJCQkgICAgMTApKQo+ID4gICAJCURSTV9FUlJPUigidGltZW91
dCB3YWl0aW5nIGZvciBQSFklZCBHUkNcbiIsIHBoeSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9p
ZCBfYnh0X2RkaV9waHlfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiArc3RhdGljIHZvaWQgX2J4dF9kZGlfcGh5X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gPiAgIAkJCSAgICAgIGVudW0gZHBpb19waHkgcGh5KQo+ID4gICB7Cj4gPiAgIAlj
b25zdCBzdHJ1Y3QgYnh0X2RkaV9waHlfaW5mbyAqcGh5X2luZm87Cj4gPiAgIAl1MzIgdmFsOwo+
ID4gLQlwaHlfaW5mbyA9IGJ4dF9nZXRfcGh5X2luZm8oZGV2X3ByaXYsIHBoeSk7Cj4gPiArCXBo
eV9pbmZvID0gYnh0X2dldF9waHlfaW5mbyhpOTE1LCBwaHkpOwo+ID4gLQlpZiAoYnh0X2RkaV9w
aHlfaXNfZW5hYmxlZChkZXZfcHJpdiwgcGh5KSkgewo+ID4gKwlpZiAoYnh0X2RkaV9waHlfaXNf
ZW5hYmxlZChpOTE1LCBwaHkpKSB7Cj4gPiAgIAkJLyogU3RpbGwgcmVhZCBvdXQgdGhlIEdSQyB2
YWx1ZSBmb3Igc3RhdGUgdmVyaWZpY2F0aW9uICovCj4gPiAgIAkJaWYgKHBoeV9pbmZvLT5yY29t
cF9waHkgIT0gLTEpCj4gPiAtCQkJZGV2X3ByaXYtPmJ4dF9waHlfZ3JjID0gYnh0X2dldF9ncmMo
ZGV2X3ByaXYsIHBoeSk7Cj4gPiArCQkJaTkxNS0+Ynh0X3BoeV9ncmMgPSBieHRfZ2V0X2dyYyhp
OTE1LCBwaHkpOwo+ID4gLQkJaWYgKGJ4dF9kZGlfcGh5X3ZlcmlmeV9zdGF0ZShkZXZfcHJpdiwg
cGh5KSkgewo+ID4gKwkJaWYgKGJ4dF9kZGlfcGh5X3ZlcmlmeV9zdGF0ZShpOTE1LCBwaHkpKSB7
Cj4gPiAgIAkJCURSTV9ERUJVR19EUklWRVIoIkRESSBQSFkgJWQgYWxyZWFkeSBlbmFibGVkLCAi
Cj4gPiAgIAkJCQkJICJ3b24ndCByZXByb2dyYW0gaXRcbiIsIHBoeSk7Cj4gPiAgIAkJCXJldHVy
bjsKPiA+IEBAIC0zODYsNyArMzg2LDcgQEAgc3RhdGljIHZvaWQgX2J4dF9kZGlfcGh5X2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJICogVGhlIGZsYWcgc2hv
dWxkIGdldCBzZXQgaW4gMTAwdXMgYWNjb3JkaW5nIHRvIHRoZSBIVyB0ZWFtLCBidXQKPiA+ICAg
CSAqIHVzZSAxbXMgZHVlIHRvIG9jY2FzaW9uYWwgdGltZW91dHMgb2JzZXJ2ZWQgd2l0aCB0aGF0
Lgo+ID4gICAJICovCj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcl9mdygmZGV2X3By
aXYtPnVuY29yZSwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyX2Z3KCZpOTE1LT51
bmNvcmUsCj4gPiAgIAkJCQkgICAgICAgQlhUX1BPUlRfQ0wxQ01fRFcwKHBoeSksCj4gPiAgIAkJ
CQkgICAgICAgUEhZX1JFU0VSVkVEIHwgUEhZX1BPV0VSX0dPT0QsCj4gPiAgIAkJCQkgICAgICAg
UEhZX1BPV0VSX0dPT0QsCj4gPiBAQCAtNDE5LDE0ICs0MTksMTQgQEAgc3RhdGljIHZvaWQgX2J4
dF9kZGlfcGh5X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
aWYgKHBoeV9pbmZvLT5yY29tcF9waHkgIT0gLTEpIHsKPiA+ICAgCQl1MzIgZ3JjX2NvZGU7Cj4g
PiAtCQlieHRfcGh5X3dhaXRfZ3JjX2RvbmUoZGV2X3ByaXYsIHBoeV9pbmZvLT5yY29tcF9waHkp
Owo+ID4gKwkJYnh0X3BoeV93YWl0X2dyY19kb25lKGk5MTUsIHBoeV9pbmZvLT5yY29tcF9waHkp
Owo+ID4gICAJCS8qCj4gPiAgIAkJICogUEhZMCBpc24ndCBjb25uZWN0ZWQgdG8gYW4gUkNPTVAg
cmVzaXN0b3Igc28gY29weSBvdmVyCj4gPiAgIAkJICogdGhlIGNvcnJlc3BvbmRpbmcgY2FsaWJy
YXRlZCB2YWx1ZSBmcm9tIFBIWTEsIGFuZCBkaXNhYmxlCj4gPiAgIAkJICogdGhlIGF1dG9tYXRp
YyBjYWxpYnJhdGlvbiBvbiBQSFkwLgo+ID4gICAJCSAqLwo+ID4gLQkJdmFsID0gZGV2X3ByaXYt
PmJ4dF9waHlfZ3JjID0gYnh0X2dldF9ncmMoZGV2X3ByaXYsCj4gPiArCQl2YWwgPSBpOTE1LT5i
eHRfcGh5X2dyYyA9IGJ4dF9nZXRfZ3JjKGk5MTUsCj4gPiAgIAkJCQkJCQkgIHBoeV9pbmZvLT5y
Y29tcF9waHkpOwo+ID4gICAJCWdyY19jb2RlID0gdmFsIDw8IEdSQ19DT0RFX0ZBU1RfU0hJRlQg
fAo+ID4gICAJCQkgICB2YWwgPDwgR1JDX0NPREVfU0xPV19TSElGVCB8Cj4gPiBAQCAtNDQ2LDEy
ICs0NDYsMTIgQEAgc3RhdGljIHZvaWQgX2J4dF9kZGlfcGh5X2luaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJSTkxNV9XUklURShCWFRfUEhZX0NUTF9GQU1JTFko
cGh5KSwgdmFsKTsKPiA+ICAgfQo+ID4gLXZvaWQgYnh0X2RkaV9waHlfdW5pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBkcGlvX3BoeSBwaHkpCj4gPiArdm9pZCBi
eHRfZGRpX3BoeV91bmluaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gZHBp
b19waHkgcGh5KQo+ID4gICB7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgYnh0X2RkaV9waHlfaW5mbyAq
cGh5X2luZm87Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQlwaHlfaW5mbyA9IGJ4dF9nZXRfcGh5X2lu
Zm8oZGV2X3ByaXYsIHBoeSk7Cj4gPiArCXBoeV9pbmZvID0gYnh0X2dldF9waHlfaW5mbyhpOTE1
LCBwaHkpOwo+ID4gICAJdmFsID0gSTkxNV9SRUFEKEJYVF9QSFlfQ1RMX0ZBTUlMWShwaHkpKTsK
PiA+ICAgCXZhbCAmPSB+Q09NTU9OX1JFU0VUX0RJUzsKPiA+IEBAIC00NjIsMzQgKzQ2MiwzNCBA
QCB2b2lkIGJ4dF9kZGlfcGh5X3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIGVudW0gZHBpb19waHkgcGh5KQo+ID4gICAJSTkxNV9XUklURShCWFRfUF9DUl9HVF9ESVNQ
X1BXUk9OLCB2YWwpOwo+ID4gICB9Cj4gPiAtdm9pZCBieHRfZGRpX3BoeV9pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBkcGlvX3BoeSBwaHkpCj4gPiArdm9pZCBi
eHRfZGRpX3BoeV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIGRwaW9f
cGh5IHBoeSkKPiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0IGJ4dF9kZGlfcGh5X2luZm8gKnBo
eV9pbmZvID0KPiA+IC0JCWJ4dF9nZXRfcGh5X2luZm8oZGV2X3ByaXYsIHBoeSk7Cj4gPiArCQli
eHRfZ2V0X3BoeV9pbmZvKGk5MTUsIHBoeSk7Cj4gPiAgIAllbnVtIGRwaW9fcGh5IHJjb21wX3Bo
eSA9IHBoeV9pbmZvLT5yY29tcF9waHk7Cj4gPiAgIAlib29sIHdhc19lbmFibGVkOwo+ID4gLQls
b2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+cG93ZXJfZG9tYWlucy5sb2NrKTsKPiA+ICsJ
bG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+cG93ZXJfZG9tYWlucy5sb2NrKTsKPiA+ICAgCXdh
c19lbmFibGVkID0gdHJ1ZTsKPiA+ICAgCWlmIChyY29tcF9waHkgIT0gLTEpCj4gPiAtCQl3YXNf
ZW5hYmxlZCA9IGJ4dF9kZGlfcGh5X2lzX2VuYWJsZWQoZGV2X3ByaXYsIHJjb21wX3BoeSk7Cj4g
PiArCQl3YXNfZW5hYmxlZCA9IGJ4dF9kZGlfcGh5X2lzX2VuYWJsZWQoaTkxNSwgcmNvbXBfcGh5
KTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBXZSBuZWVkIHRvIGNvcHkgdGhlIEdSQyBjYWxpYnJhdGlv
biB2YWx1ZSBmcm9tIHJjb21wX3BoeSwKPiA+ICAgCSAqIHNvIG1ha2Ugc3VyZSBpdCdzIHBvd2Vy
ZWQgdXAuCj4gPiAgIAkgKi8KPiA+ICAgCWlmICghd2FzX2VuYWJsZWQpCj4gPiAtCQlfYnh0X2Rk
aV9waHlfaW5pdChkZXZfcHJpdiwgcmNvbXBfcGh5KTsKPiA+ICsJCV9ieHRfZGRpX3BoeV9pbml0
KGk5MTUsIHJjb21wX3BoeSk7Cj4gPiAtCV9ieHRfZGRpX3BoeV9pbml0KGRldl9wcml2LCBwaHkp
Owo+ID4gKwlfYnh0X2RkaV9waHlfaW5pdChpOTE1LCBwaHkpOwo+ID4gICAJaWYgKCF3YXNfZW5h
YmxlZCkKPiA+IC0JCWJ4dF9kZGlfcGh5X3VuaW5pdChkZXZfcHJpdiwgcmNvbXBfcGh5KTsKPiA+
ICsJCWJ4dF9kZGlfcGh5X3VuaW5pdChpOTE1LCByY29tcF9waHkpOwo+ID4gICB9Cj4gPiAgIHN0
YXRpYyBib29sIF9fcHJpbnRmKDYsIDcpCj4gPiAtX19waHlfcmVnX3ZlcmlmeV9zdGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gZHBpb19waHkgcGh5LAo+ID4gK19f
cGh5X3JlZ192ZXJpZnlfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0g
ZHBpb19waHkgcGh5LAo+ID4gICAJCSAgICAgICBpOTE1X3JlZ190IHJlZywgdTMyIG1hc2ssIHUz
MiBleHBlY3RlZCwKPiA+ICAgCQkgICAgICAgY29uc3QgY2hhciAqcmVnX2ZtdCwgLi4uKQo+ID4g
ICB7Cj4gPiBAQCAtNTE1LDIwICs1MTUsMjAgQEAgX19waHlfcmVnX3ZlcmlmeV9zdGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gZHBpb19waHkgcGh5LAo+ID4gICAJ
cmV0dXJuIGZhbHNlOwo+ID4gICB9Cj4gPiAtYm9vbCBieHRfZGRpX3BoeV92ZXJpZnlfc3RhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2Jvb2wgYnh0X2RkaV9waHlf
dmVyaWZ5X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAg
ICBlbnVtIGRwaW9fcGh5IHBoeSkKPiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0IGJ4dF9kZGlf
cGh5X2luZm8gKnBoeV9pbmZvOwo+ID4gICAJdTMyIG1hc2s7Cj4gPiAgIAlib29sIG9rOwo+ID4g
LQlwaHlfaW5mbyA9IGJ4dF9nZXRfcGh5X2luZm8oZGV2X3ByaXYsIHBoeSk7Cj4gPiArCXBoeV9p
bmZvID0gYnh0X2dldF9waHlfaW5mbyhpOTE1LCBwaHkpOwo+ID4gICAjZGVmaW5lIF9DSEsocmVn
LCBtYXNrLCBleHAsIGZtdCwgLi4uKQkJCQkJXAo+ID4gLQlfX3BoeV9yZWdfdmVyaWZ5X3N0YXRl
KGRldl9wcml2LCBwaHksIHJlZywgbWFzaywgZXhwLCBmbXQsCVwKPiA+ICsJX19waHlfcmVnX3Zl
cmlmeV9zdGF0ZShpOTE1LCBwaHksIHJlZywgbWFzaywgZXhwLCBmbXQsCVwKPiA+ICAgCQkJICAg
ICAgICMjIF9fVkFfQVJHU19fKQo+ID4gLQlpZiAoIWJ4dF9kZGlfcGh5X2lzX2VuYWJsZWQoZGV2
X3ByaXYsIHBoeSkpCj4gPiArCWlmICghYnh0X2RkaV9waHlfaXNfZW5hYmxlZChpOTE1LCBwaHkp
KQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+ICAgCW9rID0gdHJ1ZTsKPiA+IEBAIC01NTIsNyAr
NTUyLDcgQEAgYm9vbCBieHRfZGRpX3BoeV92ZXJpZnlfc3RhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gICAJCQkgICAiQlhUX1BPUlRfQ0wyQ01fRFc2KCVkKSIsIHBo
eSk7Cj4gPiAgIAlpZiAocGh5X2luZm8tPnJjb21wX3BoeSAhPSAtMSkgewo+ID4gLQkJdTMyIGdy
Y19jb2RlID0gZGV2X3ByaXYtPmJ4dF9waHlfZ3JjOwo+ID4gKwkJdTMyIGdyY19jb2RlID0gaTkx
NS0+Ynh0X3BoeV9ncmM7Cj4gPiAgIAkJZ3JjX2NvZGUgPSBncmNfY29kZSA8PCBHUkNfQ09ERV9G
QVNUX1NISUZUIHwKPiA+ICAgCQkJICAgZ3JjX2NvZGUgPDwgR1JDX0NPREVfU0xPV19TSElGVCB8
Cj4gPiBAQCAtNTkxLDEzICs1OTEsMTMgQEAgYnh0X2RkaV9waHlfY2FsY19sYW5lX2xhdF9vcHRp
bV9tYXNrKHU4IGxhbmVfY291bnQpCj4gPiAgIHZvaWQgYnh0X2RkaV9waHlfc2V0X2xhbmVfb3B0
aW1fbWFzayhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCSAgICAgdTgg
bGFuZV9sYXRfb3B0aW1fbWFzaykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAg
CWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiA+ICAgCWVudW0gZHBpb19waHkgcGh5
Owo+ID4gICAJZW51bSBkcGlvX2NoYW5uZWwgY2g7Cj4gPiAgIAlpbnQgbGFuZTsKPiA+IC0JYnh0
X3BvcnRfdG9fcGh5X2NoYW5uZWwoZGV2X3ByaXYsIHBvcnQsICZwaHksICZjaCk7Cj4gPiArCWJ4
dF9wb3J0X3RvX3BoeV9jaGFubmVsKGk5MTUsIHBvcnQsICZwaHksICZjaCk7Cj4gPiAgIAlmb3Ig
KGxhbmUgPSAwOyBsYW5lIDwgNDsgbGFuZSsrKSB7Cj4gPiAgIAkJdTMyIHZhbCA9IEk5MTVfUkVB
RChCWFRfUE9SVF9UWF9EVzE0X0xOKHBoeSwgY2gsIGxhbmUpKTsKPiA+IEBAIC02MTcsMTQgKzYx
NywxNCBAQCB2b2lkIGJ4dF9kZGlfcGh5X3NldF9sYW5lX29wdGltX21hc2soc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIHU4Cj4gPiAgIGJ4dF9kZGlfcGh5X2dldF9sYW5lX2xh
dF9vcHRpbV9tYXNrKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICB7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+
ID4gICAJZW51bSBkcGlvX3BoeSBwaHk7Cj4gPiAgIAllbnVtIGRwaW9fY2hhbm5lbCBjaDsKPiA+
ICAgCWludCBsYW5lOwo+ID4gICAJdTggbWFzazsKPiA+IC0JYnh0X3BvcnRfdG9fcGh5X2NoYW5u
ZWwoZGV2X3ByaXYsIHBvcnQsICZwaHksICZjaCk7Cj4gPiArCWJ4dF9wb3J0X3RvX3BoeV9jaGFu
bmVsKGk5MTUsIHBvcnQsICZwaHksICZjaCk7Cj4gPiAgIAltYXNrID0gMDsKPiA+ICAgCWZvciAo
bGFuZSA9IDA7IGxhbmUgPCA0OyBsYW5lKyspIHsKPiA+IEBAIC02NDIsNyArNjQyLDcgQEAgdm9p
ZCBjaHZfc2V0X3BoeV9zaWduYWxfbGV2ZWwoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gPiAgIAkJCSAgICAgIHUzMiBkZWVtcGhfcmVnX3ZhbHVlLCB1MzIgbWFyZ2luX3JlZ192YWx1
ZSwKPiA+ICAgCQkJICAgICAgYm9vbCB1bmlxX3RyYW5zX3NjYWxlKQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQgPSBl
bmNfdG9fZGlnX3BvcnQoJmVuY29kZXItPmJhc2UpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMg
KmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGVuY29kZXItPmJhc2UuY3J0Yyk7Cj4gPiAgIAll
bnVtIGRwaW9fY2hhbm5lbCBjaCA9IHZsdl9kcG9ydF90b19jaGFubmVsKGRwb3J0KTsKPiA+IEBA
IC02NTAsNDYgKzY1MCw0NiBAQCB2b2lkIGNodl9zZXRfcGh5X3NpZ25hbF9sZXZlbChzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCXUzMiB2YWw7Cj4gPiAgIAlpbnQgaTsKPiA+
IC0Jdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKPiA+ICsJdmx2X2RwaW9fZ2V0KGk5MTUpOwo+ID4g
ICAJLyogQ2xlYXIgY2FsYyBpbml0ICovCj4gPiAtCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3By
aXYsIHBpcGUsIFZMVl9QQ1MwMV9EVzEwKGNoKSk7Cj4gPiArCXZhbCA9IHZsdl9kcGlvX3JlYWQo
aTkxNSwgcGlwZSwgVkxWX1BDUzAxX0RXMTAoY2gpKTsKPiA+ICAgCXZhbCAmPSB+KERQSU9fUENT
X1NXSU5HX0NBTENfVFgwX1RYMiB8IERQSU9fUENTX1NXSU5HX0NBTENfVFgxX1RYMyk7Cj4gPiAg
IAl2YWwgJj0gfihEUElPX1BDU19UWDFERUVNUF9NQVNLIHwgRFBJT19QQ1NfVFgyREVFTVBfTUFT
Syk7Cj4gPiAgIAl2YWwgfD0gRFBJT19QQ1NfVFgxREVFTVBfOVA1IHwgRFBJT19QQ1NfVFgyREVF
TVBfOVA1Owo+ID4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BDUzAxX0RX
MTAoY2gpLCB2YWwpOwo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUENTMDFf
RFcxMChjaCksIHZhbCk7Cj4gPiAgIAlpZiAoaW50ZWxfY3J0Yy0+Y29uZmlnLT5sYW5lX2NvdW50
ID4gMikgewo+ID4gLQkJdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1BD
UzIzX0RXMTAoY2gpKTsKPiA+ICsJCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgVkxW
X1BDUzIzX0RXMTAoY2gpKTsKPiA+ICAgCQl2YWwgJj0gfihEUElPX1BDU19TV0lOR19DQUxDX1RY
MF9UWDIgfCBEUElPX1BDU19TV0lOR19DQUxDX1RYMV9UWDMpOwo+ID4gICAJCXZhbCAmPSB+KERQ
SU9fUENTX1RYMURFRU1QX01BU0sgfCBEUElPX1BDU19UWDJERUVNUF9NQVNLKTsKPiA+ICAgCQl2
YWwgfD0gRFBJT19QQ1NfVFgxREVFTVBfOVA1IHwgRFBJT19QQ1NfVFgyREVFTVBfOVA1Owo+ID4g
LQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MyM19EVzEwKGNoKSwgdmFs
KTsKPiA+ICsJCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QQ1MyM19EVzEwKGNoKSwg
dmFsKTsKPiA+ICAgCX0KPiA+IC0JdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwg
VkxWX1BDUzAxX0RXOShjaCkpOwo+ID4gKwl2YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUs
IFZMVl9QQ1MwMV9EVzkoY2gpKTsKPiA+ICAgCXZhbCAmPSB+KERQSU9fUENTX1RYMU1BUkdJTl9N
QVNLIHwgRFBJT19QQ1NfVFgyTUFSR0lOX01BU0spOwo+ID4gICAJdmFsIHw9IERQSU9fUENTX1RY
MU1BUkdJTl8wMDAgfCBEUElPX1BDU19UWDJNQVJHSU5fMDAwOwo+ID4gLQl2bHZfZHBpb193cml0
ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BDUzAxX0RXOShjaCksIHZhbCk7Cj4gPiArCXZsdl9kcGlv
X3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QQ1MwMV9EVzkoY2gpLCB2YWwpOwo+ID4gICAJaWYgKGlu
dGVsX2NydGMtPmNvbmZpZy0+bGFuZV9jb3VudCA+IDIpIHsKPiA+IC0JCXZhbCA9IHZsdl9kcGlv
X3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MyM19EVzkoY2gpKTsKPiA+ICsJCXZhbCA9IHZs
dl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgVkxWX1BDUzIzX0RXOShjaCkpOwo+ID4gICAJCXZhbCAm
PSB+KERQSU9fUENTX1RYMU1BUkdJTl9NQVNLIHwgRFBJT19QQ1NfVFgyTUFSR0lOX01BU0spOwo+
ID4gICAJCXZhbCB8PSBEUElPX1BDU19UWDFNQVJHSU5fMDAwIHwgRFBJT19QQ1NfVFgyTUFSR0lO
XzAwMDsKPiA+IC0JCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMjNfRFc5
KGNoKSwgdmFsKTsKPiA+ICsJCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QQ1MyM19E
VzkoY2gpLCB2YWwpOwo+ID4gICAJfQo+ID4gICAJLyogUHJvZ3JhbSBzd2luZyBkZWVtcGggKi8K
PiA+ICAgCWZvciAoaSA9IDA7IGkgPCBpbnRlbF9jcnRjLT5jb25maWctPmxhbmVfY291bnQ7IGkr
Kykgewo+ID4gLQkJdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgQ0hWX1RYX0RX
NChjaCwgaSkpOwo+ID4gKwkJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBDSFZfVFhf
RFc0KGNoLCBpKSk7Cj4gPiAgIAkJdmFsICY9IH5EUElPX1NXSU5HX0RFRU1QSDlQNV9NQVNLOwo+
ID4gICAJCXZhbCB8PSBkZWVtcGhfcmVnX3ZhbHVlIDw8IERQSU9fU1dJTkdfREVFTVBIOVA1X1NI
SUZUOwo+ID4gLQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIENIVl9UWF9EVzQoY2gs
IGkpLCB2YWwpOwo+ID4gKwkJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgQ0hWX1RYX0RXNChj
aCwgaSksIHZhbCk7Cj4gPiAgIAl9Cj4gPiAgIAkvKiBQcm9ncmFtIHN3aW5nIG1hcmdpbiAqLwo+
ID4gICAJZm9yIChpID0gMDsgaSA8IGludGVsX2NydGMtPmNvbmZpZy0+bGFuZV9jb3VudDsgaSsr
KSB7Cj4gPiAtCQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfVFhfRFcy
KGNoLCBpKSk7Cj4gPiArCQl2YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIENIVl9UWF9E
VzIoY2gsIGkpKTsKPiA+ICAgCQl2YWwgJj0gfkRQSU9fU1dJTkdfTUFSR0lOMDAwX01BU0s7Cj4g
PiAgIAkJdmFsIHw9IG1hcmdpbl9yZWdfdmFsdWUgPDwgRFBJT19TV0lOR19NQVJHSU4wMDBfU0hJ
RlQ7Cj4gPiBAQCAtNzAyLDcgKzcwMiw3IEBAIHZvaWQgY2h2X3NldF9waHlfc2lnbmFsX2xldmVs
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCXZhbCAmPSB+KDB4ZmYgPDwg
RFBJT19VTklRX1RSQU5TX1NDQUxFX1NISUZUKTsKPiA+ICAgCQl2YWwgfD0gMHg5YSA8PCBEUElP
X1VOSVFfVFJBTlNfU0NBTEVfU0hJRlQ7Cj4gPiAtCQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwg
cGlwZSwgQ0hWX1RYX0RXMihjaCwgaSksIHZhbCk7Cj4gPiArCQl2bHZfZHBpb193cml0ZShpOTE1
LCBwaXBlLCBDSFZfVFhfRFcyKGNoLCBpKSwgdmFsKTsKPiA+ICAgCX0KPiA+ICAgCS8qCj4gPiBA
QCAtNzEyLDcwICs3MTIsNzAgQEAgdm9pZCBjaHZfc2V0X3BoeV9zaWduYWxfbGV2ZWwoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkgKiAyNyBmb3IgY2gwIGFuZCBjaDEuCj4g
PiAgIAkgKi8KPiA+ICAgCWZvciAoaSA9IDA7IGkgPCBpbnRlbF9jcnRjLT5jb25maWctPmxhbmVf
Y291bnQ7IGkrKykgewo+ID4gLQkJdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwg
Q0hWX1RYX0RXMyhjaCwgaSkpOwo+ID4gKwkJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBl
LCBDSFZfVFhfRFczKGNoLCBpKSk7Cj4gPiAgIAkJaWYgKHVuaXFfdHJhbnNfc2NhbGUpCj4gPiAg
IAkJCXZhbCB8PSBEUElPX1RYX1VOSVFfVFJBTlNfU0NBTEVfRU47Cj4gPiAgIAkJZWxzZQo+ID4g
ICAJCQl2YWwgJj0gfkRQSU9fVFhfVU5JUV9UUkFOU19TQ0FMRV9FTjsKPiA+IC0JCXZsdl9kcGlv
X3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfVFhfRFczKGNoLCBpKSwgdmFsKTsKPiA+ICsJCXZs
dl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIENIVl9UWF9EVzMoY2gsIGkpLCB2YWwpOwo+ID4gICAJ
fQo+ID4gICAJLyogU3RhcnQgc3dpbmcgY2FsY3VsYXRpb24gKi8KPiA+IC0JdmFsID0gdmx2X2Rw
aW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1BDUzAxX0RXMTAoY2gpKTsKPiA+ICsJdmFsID0g
dmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBWTFZfUENTMDFfRFcxMChjaCkpOwo+ID4gICAJdmFs
IHw9IERQSU9fUENTX1NXSU5HX0NBTENfVFgwX1RYMiB8IERQSU9fUENTX1NXSU5HX0NBTENfVFgx
X1RYMzsKPiA+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MwMV9EVzEw
KGNoKSwgdmFsKTsKPiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDUzAxX0RX
MTAoY2gpLCB2YWwpOwo+ID4gICAJaWYgKGludGVsX2NydGMtPmNvbmZpZy0+bGFuZV9jb3VudCA+
IDIpIHsKPiA+IC0JCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1My
M19EVzEwKGNoKSk7Cj4gPiArCQl2YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIFZMVl9Q
Q1MyM19EVzEwKGNoKSk7Cj4gPiAgIAkJdmFsIHw9IERQSU9fUENTX1NXSU5HX0NBTENfVFgwX1RY
MiB8IERQSU9fUENTX1NXSU5HX0NBTENfVFgxX1RYMzsKPiA+IC0JCXZsdl9kcGlvX3dyaXRlKGRl
dl9wcml2LCBwaXBlLCBWTFZfUENTMjNfRFcxMChjaCksIHZhbCk7Cj4gPiArCQl2bHZfZHBpb193
cml0ZShpOTE1LCBwaXBlLCBWTFZfUENTMjNfRFcxMChjaCksIHZhbCk7Cj4gPiAgIAl9Cj4gPiAt
CXZsdl9kcGlvX3B1dChkZXZfcHJpdik7Cj4gPiArCXZsdl9kcGlvX3B1dChpOTE1KTsKPiA+ICAg
fQo+ID4gICB2b2lkIGNodl9kYXRhX2xhbmVfc29mdF9yZXNldChzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiA+ICAgCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUsCj4gPiAgIAkJCSAgICAgIGJvb2wgcmVzZXQpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIGRwaW9fY2hhbm5lbCBjaCA9IHZsdl9kcG9ydF90b19j
aGFubmVsKGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSkpOwo+ID4gICAJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4g
PiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQl2
YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMDFfRFcwKGNoKSk7Cj4g
PiArCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgVkxWX1BDUzAxX0RXMChjaCkpOwo+
ID4gICAJaWYgKHJlc2V0KQo+ID4gICAJCXZhbCAmPSB+KERQSU9fUENTX1RYX0xBTkUyX1JFU0VU
IHwgRFBJT19QQ1NfVFhfTEFORTFfUkVTRVQpOwo+ID4gICAJZWxzZQo+ID4gICAJCXZhbCB8PSBE
UElPX1BDU19UWF9MQU5FMl9SRVNFVCB8IERQSU9fUENTX1RYX0xBTkUxX1JFU0VUOwo+ID4gLQl2
bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BDUzAxX0RXMChjaCksIHZhbCk7Cj4g
PiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QQ1MwMV9EVzAoY2gpLCB2YWwpOwo+
ID4gICAJaWYgKGNydGNfc3RhdGUtPmxhbmVfY291bnQgPiAyKSB7Cj4gPiAtCQl2YWwgPSB2bHZf
ZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMjNfRFcwKGNoKSk7Cj4gPiArCQl2YWwg
PSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIFZMVl9QQ1MyM19EVzAoY2gpKTsKPiA+ICAgCQlp
ZiAocmVzZXQpCj4gPiAgIAkJCXZhbCAmPSB+KERQSU9fUENTX1RYX0xBTkUyX1JFU0VUIHwgRFBJ
T19QQ1NfVFhfTEFORTFfUkVTRVQpOwo+ID4gICAJCWVsc2UKPiA+ICAgCQkJdmFsIHw9IERQSU9f
UENTX1RYX0xBTkUyX1JFU0VUIHwgRFBJT19QQ1NfVFhfTEFORTFfUkVTRVQ7Cj4gPiAtCQl2bHZf
ZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BDUzIzX0RXMChjaCksIHZhbCk7Cj4gPiAr
CQl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUENTMjNfRFcwKGNoKSwgdmFsKTsKPiA+
ICAgCX0KPiA+IC0JdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1BDUzAx
X0RXMShjaCkpOwo+ID4gKwl2YWwgPSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIFZMVl9QQ1Mw
MV9EVzEoY2gpKTsKPiA+ICAgCXZhbCB8PSBDSFZfUENTX1JFUV9TT0ZUUkVTRVRfRU47Cj4gPiAg
IAlpZiAocmVzZXQpCj4gPiAgIAkJdmFsICY9IH5EUElPX1BDU19DTEtfU09GVF9SRVNFVDsKPiA+
ICAgCWVsc2UKPiA+ICAgCQl2YWwgfD0gRFBJT19QQ1NfQ0xLX1NPRlRfUkVTRVQ7Cj4gPiAtCXZs
dl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMDFfRFcxKGNoKSwgdmFsKTsKPiA+
ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDUzAxX0RXMShjaCksIHZhbCk7Cj4g
PiAgIAlpZiAoY3J0Y19zdGF0ZS0+bGFuZV9jb3VudCA+IDIpIHsKPiA+IC0JCXZhbCA9IHZsdl9k
cGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MyM19EVzEoY2gpKTsKPiA+ICsJCXZhbCA9
IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgVkxWX1BDUzIzX0RXMShjaCkpOwo+ID4gICAJCXZh
bCB8PSBDSFZfUENTX1JFUV9TT0ZUUkVTRVRfRU47Cj4gPiAgIAkJaWYgKHJlc2V0KQo+ID4gICAJ
CQl2YWwgJj0gfkRQSU9fUENTX0NMS19TT0ZUX1JFU0VUOwo+ID4gICAJCWVsc2UKPiA+ICAgCQkJ
dmFsIHw9IERQSU9fUENTX0NMS19TT0ZUX1JFU0VUOwo+ID4gLQkJdmx2X2RwaW9fd3JpdGUoZGV2
X3ByaXYsIHBpcGUsIFZMVl9QQ1MyM19EVzEoY2gpLCB2YWwpOwo+ID4gKwkJdmx2X2RwaW9fd3Jp
dGUoaTkxNSwgcGlwZSwgVkxWX1BDUzIzX0RXMShjaCksIHZhbCk7Cj4gPiAgIAl9Cj4gPiAgIH0K
PiA+IEBAIC03ODMsNyArNzgzLDcgQEAgdm9pZCBjaHZfcGh5X3ByZV9wbGxfZW5hYmxlKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkgICAgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmRwb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCWVudW0gZHBpb19jaGFubmVsIGNo
ID0gdmx2X2Rwb3J0X3RvX2NoYW5uZWwoZHBvcnQpOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBj
cnRjLT5waXBlOwo+ID4gQEAgLTc5Nyw1MSArNzk3LDUxIEBAIHZvaWQgY2h2X3BoeV9wcmVfcGxs
X2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCSAqLwo+ID4gICAJ
aWYgKGNoID09IERQSU9fQ0gwICYmIHBpcGUgPT0gUElQRV9CKQo+ID4gICAJCWRwb3J0LT5yZWxl
YXNlX2NsMl9vdmVycmlkZSA9Cj4gPiAtCQkJIWNodl9waHlfcG93ZXJnYXRlX2NoKGRldl9wcml2
LCBEUElPX1BIWTAsIERQSU9fQ0gxLCB0cnVlKTsKPiA+ICsJCQkhY2h2X3BoeV9wb3dlcmdhdGVf
Y2goaTkxNSwgRFBJT19QSFkwLCBEUElPX0NIMSwgdHJ1ZSk7Cj4gPiAgIAljaHZfcGh5X3Bvd2Vy
Z2F0ZV9sYW5lcyhlbmNvZGVyLCB0cnVlLCBsYW5lX21hc2spOwo+ID4gLQl2bHZfZHBpb19nZXQo
ZGV2X3ByaXYpOwo+ID4gKwl2bHZfZHBpb19nZXQoaTkxNSk7Cj4gPiAgIAkvKiBBc3NlcnQgZGF0
YSBsYW5lIHJlc2V0ICovCj4gPiAgIAljaHZfZGF0YV9sYW5lX3NvZnRfcmVzZXQoZW5jb2Rlciwg
Y3J0Y19zdGF0ZSwgdHJ1ZSk7Cj4gPiAgIAkvKiBwcm9ncmFtIGxlZnQvcmlnaHQgY2xvY2sgZGlz
dHJpYnV0aW9uICovCj4gPiAgIAlpZiAocGlwZSAhPSBQSVBFX0IpIHsKPiA+IC0JCXZhbCA9IHZs
dl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIF9DSFZfQ01OX0RXNV9DSDApOwo+ID4gKwkJdmFs
ID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBfQ0hWX0NNTl9EVzVfQ0gwKTsKPiA+ICAgCQl2
YWwgJj0gfihDSFZfQlVGTEVGVEVOQTFfTUFTSyB8IENIVl9CVUZSSUdIVEVOQTFfTUFTSyk7Cj4g
PiAgIAkJaWYgKGNoID09IERQSU9fQ0gwKQo+ID4gICAJCQl2YWwgfD0gQ0hWX0JVRkxFRlRFTkEx
X0ZPUkNFOwo+ID4gICAJCWlmIChjaCA9PSBEUElPX0NIMSkKPiA+ICAgCQkJdmFsIHw9IENIVl9C
VUZSSUdIVEVOQTFfRk9SQ0U7Cj4gPiAtCQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwg
X0NIVl9DTU5fRFc1X0NIMCwgdmFsKTsKPiA+ICsJCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUs
IF9DSFZfQ01OX0RXNV9DSDAsIHZhbCk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gLQkJdmFsID0gdmx2
X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgX0NIVl9DTU5fRFcxX0NIMSk7Cj4gPiArCQl2YWwg
PSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIF9DSFZfQ01OX0RXMV9DSDEpOwo+ID4gICAJCXZh
bCAmPSB+KENIVl9CVUZMRUZURU5BMl9NQVNLIHwgQ0hWX0JVRlJJR0hURU5BMl9NQVNLKTsKPiA+
ICAgCQlpZiAoY2ggPT0gRFBJT19DSDApCj4gPiAgIAkJCXZhbCB8PSBDSFZfQlVGTEVGVEVOQTJf
Rk9SQ0U7Cj4gPiAgIAkJaWYgKGNoID09IERQSU9fQ0gxKQo+ID4gICAJCQl2YWwgfD0gQ0hWX0JV
RlJJR0hURU5BMl9GT1JDRTsKPiA+IC0JCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBf
Q0hWX0NNTl9EVzFfQ0gxLCB2YWwpOwo+ID4gKwkJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwg
X0NIVl9DTU5fRFcxX0NIMSwgdmFsKTsKPiA+ICAgCX0KPiA+ICAgCS8qIHByb2dyYW0gY2xvY2sg
Y2hhbm5lbCB1c2FnZSAqLwo+ID4gLQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBl
LCBWTFZfUENTMDFfRFc4KGNoKSk7Cj4gPiArCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlw
ZSwgVkxWX1BDUzAxX0RXOChjaCkpOwo+ID4gICAJdmFsIHw9IENIVl9QQ1NfVVNFRENMS0NIQU5O
RUxfT1ZSUklERTsKPiA+ICAgCWlmIChwaXBlICE9IFBJUEVfQikKPiA+ICAgCQl2YWwgJj0gfkNI
Vl9QQ1NfVVNFRENMS0NIQU5ORUw7Cj4gPiAgIAllbHNlCj4gPiAgIAkJdmFsIHw9IENIVl9QQ1Nf
VVNFRENMS0NIQU5ORUw7Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZf
UENTMDFfRFc4KGNoKSwgdmFsKTsKPiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxW
X1BDUzAxX0RXOChjaCksIHZhbCk7Cj4gPiAgIAlpZiAoY3J0Y19zdGF0ZS0+bGFuZV9jb3VudCA+
IDIpIHsKPiA+IC0JCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1My
M19EVzgoY2gpKTsKPiA+ICsJCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgVkxWX1BD
UzIzX0RXOChjaCkpOwo+ID4gICAJCXZhbCB8PSBDSFZfUENTX1VTRURDTEtDSEFOTkVMX09WUlJJ
REU7Cj4gPiAgIAkJaWYgKHBpcGUgIT0gUElQRV9CKQo+ID4gICAJCQl2YWwgJj0gfkNIVl9QQ1Nf
VVNFRENMS0NIQU5ORUw7Cj4gPiAgIAkJZWxzZQo+ID4gICAJCQl2YWwgfD0gQ0hWX1BDU19VU0VE
Q0xLQ0hBTk5FTDsKPiA+IC0JCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENT
MjNfRFc4KGNoKSwgdmFsKTsKPiA+ICsJCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9Q
Q1MyM19EVzgoY2gpLCB2YWwpOwo+ID4gICAJfQo+ID4gICAJLyoKPiA+IEBAIC04NDksMTQgKzg0
OSwxNCBAQCB2b2lkIGNodl9waHlfcHJlX3BsbF9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gPiAgIAkgKiBtYXRjaGVzIHRoZSBwaXBlLCBidXQgaGVyZSB3ZSBuZWVkIHRv
Cj4gPiAgIAkgKiBwaWNrIHRoZSBDTCBiYXNlZCBvbiB0aGUgcG9ydC4KPiA+ICAgCSAqLwo+ID4g
LQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTkoY2gpKTsK
PiA+ICsJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBDSFZfQ01OX0RXMTkoY2gpKTsK
PiA+ICAgCWlmIChwaXBlICE9IFBJUEVfQikKPiA+ICAgCQl2YWwgJj0gfkNIVl9DTU5fVVNFRENM
S0NIQU5ORUw7Cj4gPiAgIAllbHNlCj4gPiAgIAkJdmFsIHw9IENIVl9DTU5fVVNFRENMS0NIQU5O
RUw7Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMTkoY2gp
LCB2YWwpOwo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBDSFZfQ01OX0RXMTkoY2gp
LCB2YWwpOwo+ID4gLQl2bHZfZHBpb19wdXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfZHBpb19wdXQo
aTkxNSk7Cj4gPiAgIH0KPiA+ICAgdm9pZCBjaHZfcGh5X3ByZV9lbmNvZGVyX2VuYWJsZShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+IEBAIC04NjQsMjQgKzg2NCwyNCBAQCB2b2lk
IGNodl9waHlfcHJlX2VuY29kZXJfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVs
X2RwKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRw
b3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+ID4gICAJZW51bSBkcGlvX2NoYW5uZWwgY2ggPSB2bHZfZHBvcnRfdG9fY2hh
bm5lbChkcG9ydCk7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAlp
bnQgZGF0YSwgaSwgc3RhZ2dlcjsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAtCXZsdl9kcGlvX2dldChk
ZXZfcHJpdik7Cj4gPiArCXZsdl9kcGlvX2dldChpOTE1KTsKPiA+ICAgCS8qIGFsbG93IGhhcmR3
YXJlIHRvIG1hbmFnZSBUWCBGSUZPIHJlc2V0IHNvdXJjZSAqLwo+ID4gLQl2YWwgPSB2bHZfZHBp
b19yZWFkKGRldl9wcml2LCBwaXBlLCBWTFZfUENTMDFfRFcxMShjaCkpOwo+ID4gKwl2YWwgPSB2
bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIFZMVl9QQ1MwMV9EVzExKGNoKSk7Cj4gPiAgIAl2YWwg
Jj0gfkRQSU9fTEFORURFU0tFV19TVFJBUF9PVlJEOwo+ID4gLQl2bHZfZHBpb193cml0ZShkZXZf
cHJpdiwgcGlwZSwgVkxWX1BDUzAxX0RXMTEoY2gpLCB2YWwpOwo+ID4gKwl2bHZfZHBpb193cml0
ZShpOTE1LCBwaXBlLCBWTFZfUENTMDFfRFcxMShjaCksIHZhbCk7Cj4gPiAgIAlpZiAoY3J0Y19z
dGF0ZS0+bGFuZV9jb3VudCA+IDIpIHsKPiA+IC0JCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3By
aXYsIHBpcGUsIFZMVl9QQ1MyM19EVzExKGNoKSk7Cj4gPiArCQl2YWwgPSB2bHZfZHBpb19yZWFk
KGk5MTUsIHBpcGUsIFZMVl9QQ1MyM19EVzExKGNoKSk7Cj4gPiAgIAkJdmFsICY9IH5EUElPX0xB
TkVERVNLRVdfU1RSQVBfT1ZSRDsKPiA+IC0JCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBl
LCBWTFZfUENTMjNfRFcxMShjaCksIHZhbCk7Cj4gPiArCQl2bHZfZHBpb193cml0ZShpOTE1LCBw
aXBlLCBWTFZfUENTMjNfRFcxMShjaCksIHZhbCk7Cj4gPiAgIAl9Cj4gPiAgIAkvKiBQcm9ncmFt
IFR4IGxhbmUgbGF0ZW5jeSBvcHRpbWFsIHNldHRpbmcqLwo+ID4gQEAgLTg5MSw3ICs4OTEsNyBA
QCB2b2lkIGNodl9waHlfcHJlX2VuY29kZXJfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ID4gICAJCQlkYXRhID0gMHgwOwo+ID4gICAJCWVsc2UKPiA+ICAgCQkJZGF0YSA9
IChpID09IDEpID8gMHgwIDogMHgxOwo+ID4gLQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBp
cGUsIENIVl9UWF9EVzE0KGNoLCBpKSwKPiA+ICsJCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUs
IENIVl9UWF9EVzE0KGNoLCBpKSwKPiA+ICAgCQkJCWRhdGEgPDwgRFBJT19VUEFSX1NISUZUKTsK
PiA+ICAgCX0KPiA+IEBAIC05MDcsMTcgKzkwNywxNyBAQCB2b2lkIGNodl9waHlfcHJlX2VuY29k
ZXJfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJZWxzZQo+ID4g
ICAJCXN0YWdnZXIgPSAweDI7Cj4gPiAtCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBp
cGUsIFZMVl9QQ1MwMV9EVzExKGNoKSk7Cj4gPiArCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwg
cGlwZSwgVkxWX1BDUzAxX0RXMTEoY2gpKTsKPiA+ICAgCXZhbCB8PSBEUElPX1RYMl9TVEFHR0VS
X01BU0soMHgxZik7Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENT
MDFfRFcxMShjaCksIHZhbCk7Cj4gPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9Q
Q1MwMV9EVzExKGNoKSwgdmFsKTsKPiA+ICAgCWlmIChjcnRjX3N0YXRlLT5sYW5lX2NvdW50ID4g
Mikgewo+ID4gLQkJdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgVkxWX1BDUzIz
X0RXMTEoY2gpKTsKPiA+ICsJCXZhbCA9IHZsdl9kcGlvX3JlYWQoaTkxNSwgcGlwZSwgVkxWX1BD
UzIzX0RXMTEoY2gpKTsKPiA+ICAgCQl2YWwgfD0gRFBJT19UWDJfU1RBR0dFUl9NQVNLKDB4MWYp
Owo+ID4gLQkJdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MyM19EVzExKGNo
KSwgdmFsKTsKPiA+ICsJCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QQ1MyM19EVzEx
KGNoKSwgdmFsKTsKPiA+ICAgCX0KPiA+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUs
IFZMVl9QQ1MwMV9EVzEyKGNoKSwKPiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxW
X1BDUzAxX0RXMTIoY2gpLAo+ID4gICAJCSAgICAgICBEUElPX0xBTkVTVEFHR0VSX1NUUkFQKHN0
YWdnZXIpIHwKPiA+ICAgCQkgICAgICAgRFBJT19MQU5FU1RBR0dFUl9TVFJBUF9PVlJEIHwKPiA+
ICAgCQkgICAgICAgRFBJT19UWDFfU1RBR0dFUl9NQVNLKDB4MWYpIHwKPiA+IEBAIC05MjUsNyAr
OTI1LDcgQEAgdm9pZCBjaHZfcGh5X3ByZV9lbmNvZGVyX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiA+ICAgCQkgICAgICAgRFBJT19UWDJfU1RBR0dFUl9NVUxUKDApKTsK
PiA+ICAgCWlmIChjcnRjX3N0YXRlLT5sYW5lX2NvdW50ID4gMikgewo+ID4gLQkJdmx2X2RwaW9f
d3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MyM19EVzEyKGNoKSwKPiA+ICsJCXZsdl9kcGlv
X3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QQ1MyM19EVzEyKGNoKSwKPiA+ICAgCQkJICAgICAgIERQ
SU9fTEFORVNUQUdHRVJfU1RSQVAoc3RhZ2dlcikgfAo+ID4gICAJCQkgICAgICAgRFBJT19MQU5F
U1RBR0dFUl9TVFJBUF9PVlJEIHwKPiA+ICAgCQkJICAgICAgIERQSU9fVFgxX1NUQUdHRVJfTUFT
SygweDFmKSB8Cj4gPiBAQCAtOTM2LDE2ICs5MzYsMTYgQEAgdm9pZCBjaHZfcGh5X3ByZV9lbmNv
ZGVyX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCS8qIERlYXNz
ZXJ0IGRhdGEgbGFuZSByZXNldCAqLwo+ID4gICAJY2h2X2RhdGFfbGFuZV9zb2Z0X3Jlc2V0KGVu
Y29kZXIsIGNydGNfc3RhdGUsIGZhbHNlKTsKPiA+IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsK
PiA+ICsJdmx2X2RwaW9fcHV0KGk5MTUpOwo+ID4gICB9Cj4gPiAgIHZvaWQgY2h2X3BoeV9yZWxl
YXNlX2NsMl9vdmVycmlkZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+
ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQgPSBlbmNfdG9fZGlnX3BvcnQo
JmVuY29kZXItPmJhc2UpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWlmIChkcG9ydC0+
cmVsZWFzZV9jbDJfb3ZlcnJpZGUpIHsKPiA+IC0JCWNodl9waHlfcG93ZXJnYXRlX2NoKGRldl9w
cml2LCBEUElPX1BIWTAsIERQSU9fQ0gxLCBmYWxzZSk7Cj4gPiArCQljaHZfcGh5X3Bvd2VyZ2F0
ZV9jaChpOTE1LCBEUElPX1BIWTAsIERQSU9fQ0gxLCBmYWxzZSk7Cj4gPiAgIAkJZHBvcnQtPnJl
bGVhc2VfY2wyX292ZXJyaWRlID0gZmFsc2U7Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IEBAIC05NTMs
MjQgKzk1MywyNCBAQCB2b2lkIGNodl9waHlfcmVsZWFzZV9jbDJfb3ZlcnJpZGUoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHZvaWQgY2h2X3BoeV9wb3N0X3BsbF9kaXNhYmxl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkgICAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IHRvX2ludGVsX2NydGMob2xkX2NydGNf
c3RhdGUtPmJhc2UuY3J0YyktPnBpcGU7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQl2bHZfZHBpb19n
ZXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfZHBpb19nZXQoaTkxNSk7Cj4gPiAgIAkvKiBkaXNhYmxl
IGxlZnQvcmlnaHQgY2xvY2sgZGlzdHJpYnV0aW9uICovCj4gPiAgIAlpZiAocGlwZSAhPSBQSVBF
X0IpIHsKPiA+IC0JCXZhbCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIF9DSFZfQ01O
X0RXNV9DSDApOwo+ID4gKwkJdmFsID0gdmx2X2RwaW9fcmVhZChpOTE1LCBwaXBlLCBfQ0hWX0NN
Tl9EVzVfQ0gwKTsKPiA+ICAgCQl2YWwgJj0gfihDSFZfQlVGTEVGVEVOQTFfTUFTSyB8IENIVl9C
VUZSSUdIVEVOQTFfTUFTSyk7Cj4gPiAtCQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwg
X0NIVl9DTU5fRFc1X0NIMCwgdmFsKTsKPiA+ICsJCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUs
IF9DSFZfQ01OX0RXNV9DSDAsIHZhbCk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gLQkJdmFsID0gdmx2
X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgX0NIVl9DTU5fRFcxX0NIMSk7Cj4gPiArCQl2YWwg
PSB2bHZfZHBpb19yZWFkKGk5MTUsIHBpcGUsIF9DSFZfQ01OX0RXMV9DSDEpOwo+ID4gICAJCXZh
bCAmPSB+KENIVl9CVUZMRUZURU5BMl9NQVNLIHwgQ0hWX0JVRlJJR0hURU5BMl9NQVNLKTsKPiA+
IC0JCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBfQ0hWX0NNTl9EVzFfQ0gxLCB2YWwp
Owo+ID4gKwkJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgX0NIVl9DTU5fRFcxX0NIMSwgdmFs
KTsKPiA+ICAgCX0KPiA+IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKPiA+ICsJdmx2X2RwaW9f
cHV0KGk5MTUpOwo+ID4gICAJLyoKPiA+ICAgCSAqIExlYXZlIHRoZSBwb3dlciBkb3duIGJpdCBj
bGVhcmVkIGZvciBhdCBsZWFzdCBvbmUKPiA+IEBAIC05ODgsNTcgKzk4OCw1NyBAQCB2b2lkIHZs
dl9zZXRfcGh5X3NpZ25hbF9sZXZlbChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+
ICAgCQkJICAgICAgdTMyIGRlbXBoX3JlZ192YWx1ZSwgdTMyIHByZWVtcGhfcmVnX3ZhbHVlLAo+
ID4gICAJCQkgICAgICB1MzIgdW5pcXRyYW5zY2FsZV9yZWdfdmFsdWUsIHUzMiB0eDNfZGVtcGgp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
aW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoZW5jb2Rlci0+YmFzZS5jcnRjKTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRwb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVy
LT5iYXNlKTsKPiA+ICAgCWVudW0gZHBpb19jaGFubmVsIHBvcnQgPSB2bHZfZHBvcnRfdG9fY2hh
bm5lbChkcG9ydCk7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7Cj4g
PiAtCXZsdl9kcGlvX2dldChkZXZfcHJpdik7Cj4gPiArCXZsdl9kcGlvX2dldChpOTE1KTsKPiA+
IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBpcGUsIFZMVl9UWF9EVzUocG9ydCksIDB4MDAw
MDAwMDApOwo+ID4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1RYX0RXNChw
b3J0KSwgZGVtcGhfcmVnX3ZhbHVlKTsKPiA+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3ByaXYsIHBp
cGUsIFZMVl9UWF9EVzIocG9ydCksCj4gPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZM
Vl9UWF9EVzUocG9ydCksIDB4MDAwMDAwMDApOwo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBw
aXBlLCBWTFZfVFhfRFc0KHBvcnQpLCBkZW1waF9yZWdfdmFsdWUpOwo+ID4gKwl2bHZfZHBpb193
cml0ZShpOTE1LCBwaXBlLCBWTFZfVFhfRFcyKHBvcnQpLAo+ID4gICAJCQkgdW5pcXRyYW5zY2Fs
ZV9yZWdfdmFsdWUpOwo+ID4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1RY
X0RXMyhwb3J0KSwgMHgwQzc4MjA0MCk7Cj4gPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUs
IFZMVl9UWF9EVzMocG9ydCksIDB4MEM3ODIwNDApOwo+ID4gICAJaWYgKHR4M19kZW1waCkKPiA+
IC0JCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfVFgzX0RXNChwb3J0KSwgdHgz
X2RlbXBoKTsKPiA+ICsJCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9UWDNfRFc0KHBv
cnQpLCB0eDNfZGVtcGgpOwo+ID4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxW
X1BDU19EVzExKHBvcnQpLCAweDAwMDMwMDAwKTsKPiA+IC0Jdmx2X2RwaW9fd3JpdGUoZGV2X3By
aXYsIHBpcGUsIFZMVl9QQ1NfRFc5KHBvcnQpLCBwcmVlbXBoX3JlZ192YWx1ZSk7Cj4gPiAtCXZs
dl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfVFhfRFc1KHBvcnQpLCBEUElPX1RYX09D
QUxJTklUX0VOKTsKPiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDU19EVzEx
KHBvcnQpLCAweDAwMDMwMDAwKTsKPiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxW
X1BDU19EVzkocG9ydCksIHByZWVtcGhfcmVnX3ZhbHVlKTsKPiA+ICsJdmx2X2RwaW9fd3JpdGUo
aTkxNSwgcGlwZSwgVkxWX1RYX0RXNShwb3J0KSwgRFBJT19UWF9PQ0FMSU5JVF9FTik7Cj4gPiAt
CXZsdl9kcGlvX3B1dChkZXZfcHJpdik7Cj4gPiArCXZsdl9kcGlvX3B1dChpOTE1KTsKPiA+ICAg
fQo+ID4gICB2b2lkIHZsdl9waHlfcHJlX3BsbF9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4gPiAgIAkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQg
PSBlbmNfdG9fZGlnX3BvcnQoJmVuY29kZXItPmJhc2UpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+ID4gICAJZW51bSBkcGlvX2NoYW5uZWwgcG9ydCA9IHZsdl9kcG9ydF90
b19jaGFubmVsKGRwb3J0KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+
ICAgCS8qIFByb2dyYW0gVHggbGFuZSByZXNldHMgdG8gZGVmYXVsdCAqLwo+ID4gLQl2bHZfZHBp
b19nZXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfZHBpb19nZXQoaTkxNSk7Cj4gPiAtCXZsdl9kcGlv
X3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENTX0RXMChwb3J0KSwKPiA+ICsJdmx2X2RwaW9f
d3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDU19EVzAocG9ydCksCj4gPiAgIAkJCSBEUElPX1BDU19U
WF9MQU5FMl9SRVNFVCB8Cj4gPiAgIAkJCSBEUElPX1BDU19UWF9MQU5FMV9SRVNFVCk7Cj4gPiAt
CXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENTX0RXMShwb3J0KSwKPiA+ICsJ
dmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDU19EVzEocG9ydCksCj4gPiAgIAkJCSBE
UElPX1BDU19DTEtfQ1JJX1JYRUJfRUlPU19FTiB8Cj4gPiAgIAkJCSBEUElPX1BDU19DTEtfQ1JJ
X1JYRElHRklMVFNHX0VOIHwKPiA+ICAgCQkJICgxPDxEUElPX1BDU19DTEtfREFUQVdJRFRIX1NI
SUZUKSB8Cj4gPiAgIAkJCQkgRFBJT19QQ1NfQ0xLX1NPRlRfUkVTRVQpOwo+ID4gICAJLyogRml4
IHVwIGludGVyLXBhaXIgc2tldyBmYWlsdXJlICovCj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9w
cml2LCBwaXBlLCBWTFZfUENTX0RXMTIocG9ydCksIDB4MDA3NTBmMDApOwo+ID4gLQl2bHZfZHBp
b193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1RYX0RXMTEocG9ydCksIDB4MDAwMDE1MDApOwo+
ID4gLQl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1RYX0RXMTQocG9ydCksIDB4
NDA0MDAwMDApOwo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZfUENTX0RXMTIo
cG9ydCksIDB4MDA3NTBmMDApOwo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBWTFZf
VFhfRFcxMShwb3J0KSwgMHgwMDAwMTUwMCk7Cj4gPiArCXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBp
cGUsIFZMVl9UWF9EVzE0KHBvcnQpLCAweDQwNDAwMDAwKTsKPiA+IC0Jdmx2X2RwaW9fcHV0KGRl
dl9wcml2KTsKPiA+ICsJdmx2X2RwaW9fcHV0KGk5MTUpOwo+ID4gICB9Cj4gPiAgIHZvaWQgdmx2
X3BoeV9wcmVfZW5jb2Rlcl9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4g
PiBAQCAtMTA0Niw0MiArMTA0Niw0MiBAQCB2b2lkIHZsdl9waHlfcHJlX2VuY29kZXJfZW5hYmxl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAg
CXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRwb3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxf
ZHApOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gICAJZW51bSBkcGlv
X2NoYW5uZWwgcG9ydCA9IHZsdl9kcG9ydF90b19jaGFubmVsKGRwb3J0KTsKPiA+ICAgCWVudW0g
cGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAtCXZsdl9kcGlvX2dl
dChkZXZfcHJpdik7Cj4gPiArCXZsdl9kcGlvX2dldChpOTE1KTsKPiA+ICAgCS8qIEVuYWJsZSBj
bG9jayBjaGFubmVscyBmb3IgdGhpcyBwb3J0ICovCj4gPiAtCXZhbCA9IHZsdl9kcGlvX3JlYWQo
ZGV2X3ByaXYsIHBpcGUsIFZMVl9QQ1MwMV9EVzgocG9ydCkpOwo+ID4gKwl2YWwgPSB2bHZfZHBp
b19yZWFkKGk5MTUsIHBpcGUsIFZMVl9QQ1MwMV9EVzgocG9ydCkpOwo+ID4gICAJdmFsID0gMDsK
PiA+ICAgCWlmIChwaXBlKQo+ID4gICAJCXZhbCB8PSAoMTw8MjEpOwo+ID4gICAJZWxzZQo+ID4g
ICAJCXZhbCAmPSB+KDE8PDIxKTsKPiA+ICAgCXZhbCB8PSAweDAwMTAwMGM0Owo+ID4gLQl2bHZf
ZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BDU19EVzgocG9ydCksIHZhbCk7Cj4gPiAr
CXZsdl9kcGlvX3dyaXRlKGk5MTUsIHBpcGUsIFZMVl9QQ1NfRFc4KHBvcnQpLCB2YWwpOwo+ID4g
ICAJLyogUHJvZ3JhbSBsYW5lIGNsb2NrICovCj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2
LCBwaXBlLCBWTFZfUENTX0RXMTQocG9ydCksIDB4MDA3NjAwMTgpOwo+ID4gLQl2bHZfZHBpb193
cml0ZShkZXZfcHJpdiwgcGlwZSwgVkxWX1BDU19EVzIzKHBvcnQpLCAweDAwNDAwODg4KTsKPiA+
ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDU19EVzE0KHBvcnQpLCAweDAwNzYw
MDE4KTsKPiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDU19EVzIzKHBvcnQp
LCAweDAwNDAwODg4KTsKPiA+IC0Jdmx2X2RwaW9fcHV0KGRldl9wcml2KTsKPiA+ICsJdmx2X2Rw
aW9fcHV0KGk5MTUpOwo+ID4gICB9Cj4gPiAgIHZvaWQgdmx2X3BoeV9yZXNldF9sYW5lcyhzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2Rp
Z2l0YWxfcG9ydCAqZHBvcnQgPSBlbmNfdG9fZGlnX3BvcnQoJmVuY29kZXItPmJhc2UpOwo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCWVudW0gZHBpb19jaGFu
bmVsIHBvcnQgPSB2bHZfZHBvcnRfdG9fY2hhbm5lbChkcG9ydCk7Cj4gPiAgIAllbnVtIHBpcGUg
cGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAtCXZsdl9kcGlvX2dldChkZXZfcHJpdik7Cj4gPiAtCXZs
dl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENTX0RXMChwb3J0KSwgMHgwMDAwMDAw
MCk7Cj4gPiAtCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBWTFZfUENTX0RXMShwb3J0
KSwgMHgwMGUwMDA2MCk7Cj4gPiAtCXZsdl9kcGlvX3B1dChkZXZfcHJpdik7Cj4gPiArCXZsdl9k
cGlvX2dldChpOTE1KTsKPiA+ICsJdmx2X2RwaW9fd3JpdGUoaTkxNSwgcGlwZSwgVkxWX1BDU19E
VzAocG9ydCksIDB4MDAwMDAwMDApOwo+ID4gKwl2bHZfZHBpb193cml0ZShpOTE1LCBwaXBlLCBW
TFZfUENTX0RXMShwb3J0KSwgMHgwMGUwMDA2MCk7Cj4gPiArCXZsdl9kcGlvX3B1dChpOTE1KTsK
PiA+ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RwaW9f
cGh5LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcGlvX3BoeS5oCj4gPiBpbmRleCBm
NDE4YWFiOTBiN2UuLmQ0YzkzOTNiZWJjZSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX2RwaW9fcGh5LmgKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2RwaW9fcGh5LmgKPiA+IEBAIC0xNSwxNiArMTUsMTYgQEAgc3RydWN0IGRybV9pOTE1X3By
aXZhdGU7Cj4gPiAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlOwo+ID4gICBzdHJ1Y3QgaW50ZWxf
ZW5jb2RlcjsKPiA+IC12b2lkIGJ4dF9wb3J0X3RvX3BoeV9jaGFubmVsKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQsCj4gPiArdm9pZCBieHRfcG9ydF90
b19waHlfY2hhbm5lbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0IHBv
cnQsCj4gPiAgIAkJCSAgICAgZW51bSBkcGlvX3BoeSAqcGh5LCBlbnVtIGRwaW9fY2hhbm5lbCAq
Y2gpOwo+ID4gLXZvaWQgYnh0X2RkaV9waHlfc2V0X3NpZ25hbF9sZXZlbChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBieHRfZGRpX3BoeV9zZXRfc2lnbmFsX2xl
dmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICBlbnVtIHBvcnQg
cG9ydCwgdTMyIG1hcmdpbiwgdTMyIHNjYWxlLAo+ID4gICAJCQkJICB1MzIgZW5hYmxlLCB1MzIg
ZGVlbXBoYXNpcyk7Cj4gPiAtdm9pZCBieHRfZGRpX3BoeV9pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgZW51bSBkcGlvX3BoeSBwaHkpOwo+ID4gLXZvaWQgYnh0X2RkaV9w
aHlfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBkcGlvX3Bo
eSBwaHkpOwo+ID4gLWJvb2wgYnh0X2RkaV9waHlfaXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBieHRfZGRpX3BoeV9pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LCBlbnVtIGRwaW9fcGh5IHBoeSk7Cj4gPiArdm9pZCBieHRfZGRp
X3BoeV91bmluaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gZHBpb19waHkg
cGh5KTsKPiA+ICtib29sIGJ4dF9kZGlfcGh5X2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICBlbnVtIGRwaW9fcGh5IHBoeSk7Cj4gPiAtYm9vbCBi
eHRfZGRpX3BoeV92ZXJpZnlfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gK2Jvb2wgYnh0X2RkaV9waHlfdmVyaWZ5X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ID4gICAJCQkgICAgICBlbnVtIGRwaW9fcGh5IHBoeSk7Cj4gPiAgIHU4IGJ4
dF9kZGlfcGh5X2NhbGNfbGFuZV9sYXRfb3B0aW1fbWFzayh1OCBsYW5lX2NvdW50KTsKPiA+ICAg
dm9pZCBieHRfZGRpX3BoeV9zZXRfbGFuZV9vcHRpbV9tYXNrKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rw
bGxfbWdyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcGxsX21nci5jCj4gPiBpbmRl
eCAyZDRlN2I5YTdiOWQuLjJkYWJjZGYyN2RmNCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2RwbGxfbWdyLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2RwbGxfbWdyLmMKPiA+IEBAIC00NSwxNCArNDUsMTQgQEAKPiA+ICAgICovCj4gPiAg
IHN0YXRpYyB2b2lkCj4gPiAtaW50ZWxfYXRvbWljX2R1cGxpY2F0ZV9kcGxsX3N0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpbnRlbF9hdG9taWNfZHVwbGljYXRl
X2RwbGxfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgIHN0
cnVjdCBpbnRlbF9zaGFyZWRfZHBsbF9zdGF0ZSAqc2hhcmVkX2RwbGwpCj4gPiAgIHsKPiA+ICAg
CWVudW0gaW50ZWxfZHBsbF9pZCBpOwo+ID4gICAJLyogQ29weSBzaGFyZWQgZHBsbCBzdGF0ZSAq
Lwo+ID4gLQlmb3IgKGkgPSAwOyBpIDwgZGV2X3ByaXYtPm51bV9zaGFyZWRfZHBsbDsgaSsrKSB7
Cj4gPiAtCQlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCA9ICZkZXZfcHJpdi0+c2hhcmVk
X2RwbGxzW2ldOwo+ID4gKwlmb3IgKGkgPSAwOyBpIDwgaTkxNS0+bnVtX3NoYXJlZF9kcGxsOyBp
KyspIHsKPiA+ICsJCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsID0gJmk5MTUtPnNoYXJl
ZF9kcGxsc1tpXTsKPiA+ICAgCQlzaGFyZWRfZHBsbFtpXSA9IHBsbC0+c3RhdGU7Cj4gPiAgIAl9
Cj4gPiBAQCAtNzcsNDAgKzc3LDQwIEBAIGludGVsX2F0b21pY19nZXRfc2hhcmVkX2RwbGxfc3Rh
dGUoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnMpCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9n
ZXRfc2hhcmVkX2RwbGxfYnlfaWQgLSBnZXQgYSBEUExMIGdpdmVuIGl0cyBpZAo+ID4gLSAqIEBk
ZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2Ug
aW5zdGFuY2UKPiA+ICAgICogQGlkOiBwbGwgaWQKPiA+ICAgICoKPiA+ICAgICogUmV0dXJuczoK
PiA+ICAgICogQSBwb2ludGVyIHRvIHRoZSBEUExMIHdpdGggQGlkCj4gPiAgICAqLwo+ID4gICBz
dHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKgo+ID4gLWludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9p
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAraW50ZWxfZ2V0X3NoYXJl
ZF9kcGxsX2J5X2lkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAg
ZW51bSBpbnRlbF9kcGxsX2lkIGlkKQo+ID4gICB7Cj4gPiAtCXJldHVybiAmZGV2X3ByaXYtPnNo
YXJlZF9kcGxsc1tpZF07Cj4gPiArCXJldHVybiAmaTkxNS0+c2hhcmVkX2RwbGxzW2lkXTsKPiA+
ICAgfQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfZ2V0X3NoYXJlZF9kcGxsX2lkIC0gZ2V0IHRo
ZSBpZCBvZiBhIERQTEwKPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4g
PiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiAgICAqIEBwbGw6IHRoZSBEUExM
Cj4gPiAgICAqCj4gPiAgICAqIFJldHVybnM6Cj4gPiAgICAqIFRoZSBpZCBvZiBAcGxsCj4gPiAg
ICAqLwo+ID4gICBlbnVtIGludGVsX2RwbGxfaWQKPiA+IC1pbnRlbF9nZXRfc2hhcmVkX2RwbGxf
aWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2ludGVsX2dldF9zaGFy
ZWRfZHBsbF9pZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJIHN0cnVj
dCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKQo+ID4gICB7Cj4gPiAtCWlmIChXQVJOX09OKHBsbCA8
IGRldl9wcml2LT5zaGFyZWRfZHBsbHN8fAo+ID4gLQkJICAgIHBsbCA+ICZkZXZfcHJpdi0+c2hh
cmVkX2RwbGxzW2Rldl9wcml2LT5udW1fc2hhcmVkX2RwbGxdKSkKPiA+ICsJaWYgKFdBUk5fT04o
cGxsIDwgaTkxNS0+c2hhcmVkX2RwbGxzfHwKPiA+ICsJCSAgICBwbGwgPiAmaTkxNS0+c2hhcmVk
X2RwbGxzW2k5MTUtPm51bV9zaGFyZWRfZHBsbF0pKQo+ID4gICAJCXJldHVybiAtMTsKPiA+IC0J
cmV0dXJuIChlbnVtIGludGVsX2RwbGxfaWQpIChwbGwgLSBkZXZfcHJpdi0+c2hhcmVkX2RwbGxz
KTsKPiA+ICsJcmV0dXJuIChlbnVtIGludGVsX2RwbGxfaWQpIChwbGwgLSBpOTE1LT5zaGFyZWRf
ZHBsbHMpOwo+ID4gICB9Cj4gPiAgIC8qIEZvciBJTEsrICovCj4gPiAtdm9pZCBhc3NlcnRfc2hh
cmVkX2RwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgYXNz
ZXJ0X3NoYXJlZF9kcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQlz
dHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiA+ICAgCQkJYm9vbCBzdGF0ZSkKPiA+ICAg
ewo+ID4gQEAgLTEyMCw3ICsxMjAsNyBAQCB2b2lkIGFzc2VydF9zaGFyZWRfZHBsbChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlpZiAoV0FSTighcGxsLCAiYXNzZXJ0
aW5nIERQTEwgJXMgd2l0aCBubyBEUExMXG4iLCBvbm9mZihzdGF0ZSkpKQo+ID4gICAJCXJldHVy
bjsKPiA+IC0JY3VyX3N0YXRlID0gcGxsLT5pbmZvLT5mdW5jcy0+Z2V0X2h3X3N0YXRlKGRldl9w
cml2LCBwbGwsICZod19zdGF0ZSk7Cj4gPiArCWN1cl9zdGF0ZSA9IHBsbC0+aW5mby0+ZnVuY3Mt
PmdldF9od19zdGF0ZShpOTE1LCBwbGwsICZod19zdGF0ZSk7Cj4gPiAgIAlJOTE1X1NUQVRFX1dB
Uk4oY3VyX3N0YXRlICE9IHN0YXRlLAo+ID4gICAJICAgICAiJXMgYXNzZXJ0aW9uIGZhaWx1cmUg
KGV4cGVjdGVkICVzLCBjdXJyZW50ICVzKVxuIiwKPiA+ICAgCQkJcGxsLT5pbmZvLT5uYW1lLCBv
bm9mZihzdGF0ZSksIG9ub2ZmKGN1cl9zdGF0ZSkpOwo+ID4gQEAgLTEzNiwyMiArMTM2LDIyIEBA
IHZvaWQgYXNzZXJ0X3NoYXJlZF9kcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgdm9pZCBpbnRlbF9wcmVwYXJlX3NoYXJlZF9kcGxsKGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCA9IGNydGNfc3RhdGUt
PnNoYXJlZF9kcGxsOwo+ID4gICAJaWYgKFdBUk5fT04ocGxsID09IE5VTEwpKQo+ID4gICAJCXJl
dHVybjsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRwbGxfbG9jayk7Cj4gPiArCW11dGV4
X2xvY2soJmk5MTUtPmRwbGxfbG9jayk7Cj4gPiAgIAlXQVJOX09OKCFwbGwtPnN0YXRlLmNydGNf
bWFzayk7Cj4gPiAgIAlpZiAoIXBsbC0+YWN0aXZlX21hc2spIHsKPiA+ICAgCQlEUk1fREVCVUdf
RFJJVkVSKCJzZXR0aW5nIHVwICVzXG4iLCBwbGwtPmluZm8tPm5hbWUpOwo+ID4gICAJCVdBUk5f
T04ocGxsLT5vbik7Cj4gPiAtCQlhc3NlcnRfc2hhcmVkX2RwbGxfZGlzYWJsZWQoZGV2X3ByaXYs
IHBsbCk7Cj4gPiArCQlhc3NlcnRfc2hhcmVkX2RwbGxfZGlzYWJsZWQoaTkxNSwgcGxsKTsKPiA+
IC0JCXBsbC0+aW5mby0+ZnVuY3MtPnByZXBhcmUoZGV2X3ByaXYsIHBsbCk7Cj4gPiArCQlwbGwt
PmluZm8tPmZ1bmNzLT5wcmVwYXJlKGk5MTUsIHBsbCk7Cj4gPiAgIAl9Cj4gPiAtCW11dGV4X3Vu
bG9jaygmZGV2X3ByaXYtPmRwbGxfbG9jayk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHBs
bF9sb2NrKTsKPiA+ICAgfQo+ID4gICAvKioKPiA+IEBAIC0xNjMsNyArMTYzLDcgQEAgdm9pZCBp
bnRlbF9wcmVwYXJlX3NoYXJlZF9kcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+ID4gICB2b2lkIGludGVsX2VuYWJsZV9zaGFyZWRfZHBsbChjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFz
ZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwgPSBjcnRj
X3N0YXRlLT5zaGFyZWRfZHBsbDsKPiA+ICAgCXVuc2lnbmVkIGludCBjcnRjX21hc2sgPSBkcm1f
Y3J0Y19tYXNrKCZjcnRjLT5iYXNlKTsKPiA+ICAgCXVuc2lnbmVkIGludCBvbGRfbWFzazsKPiA+
IEBAIC0xNzEsNyArMTcxLDcgQEAgdm9pZCBpbnRlbF9lbmFibGVfc2hhcmVkX2RwbGwoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIAlpZiAoV0FSTl9PTihw
bGwgPT0gTlVMTCkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+
ZHBsbF9sb2NrKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHBsbF9sb2NrKTsKPiA+ICAgCW9s
ZF9tYXNrID0gcGxsLT5hY3RpdmVfbWFzazsKPiA+ICAgCWlmIChXQVJOX09OKCEocGxsLT5zdGF0
ZS5jcnRjX21hc2sgJiBjcnRjX21hc2spKSB8fAo+ID4gQEAgLTE4NiwxNyArMTg2LDE3IEBAIHZv
aWQgaW50ZWxfZW5hYmxlX3NoYXJlZF9kcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKQo+ID4gICAJaWYgKG9sZF9tYXNrKSB7Cj4gPiAgIAkJV0FSTl9PTighcGxs
LT5vbik7Cj4gPiAtCQlhc3NlcnRfc2hhcmVkX2RwbGxfZW5hYmxlZChkZXZfcHJpdiwgcGxsKTsK
PiA+ICsJCWFzc2VydF9zaGFyZWRfZHBsbF9lbmFibGVkKGk5MTUsIHBsbCk7Cj4gPiAgIAkJZ290
byBvdXQ7Cj4gPiAgIAl9Cj4gPiAgIAlXQVJOX09OKHBsbC0+b24pOwo+ID4gICAJRFJNX0RFQlVH
X0tNUygiZW5hYmxpbmcgJXNcbiIsIHBsbC0+aW5mby0+bmFtZSk7Cj4gPiAtCXBsbC0+aW5mby0+
ZnVuY3MtPmVuYWJsZShkZXZfcHJpdiwgcGxsKTsKPiA+ICsJcGxsLT5pbmZvLT5mdW5jcy0+ZW5h
YmxlKGk5MTUsIHBsbCk7Cj4gPiAgIAlwbGwtPm9uID0gdHJ1ZTsKPiA+ICAgb3V0Ogo+ID4gLQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5kcGxsX2xvY2spOwo+ID4gKwltdXRleF91bmxvY2soJmk5
MTUtPmRwbGxfbG9jayk7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiBAQCAtMjA4LDE4ICsyMDgsMTgg
QEAgdm9pZCBpbnRlbF9lbmFibGVfc2hhcmVkX2RwbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHZvaWQgaW50ZWxfZGlzYWJsZV9zaGFyZWRfZHBsbChj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpw
bGwgPSBjcnRjX3N0YXRlLT5zaGFyZWRfZHBsbDsKPiA+ICAgCXVuc2lnbmVkIGludCBjcnRjX21h
c2sgPSBkcm1fY3J0Y19tYXNrKCZjcnRjLT5iYXNlKTsKPiA+ICAgCS8qIFBDSCBvbmx5IGF2YWls
YWJsZSBvbiBJTEsrICovCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNSkKPiA+ICsJ
aWYgKElOVEVMX0dFTihpOTE1KSA8IDUpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJaWYgKHBsbCA9
PSBOVUxMKQo+ID4gICAJCXJldHVybjsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRwbGxf
bG9jayk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmRwbGxfbG9jayk7Cj4gPiAgIAlpZiAoV0FS
Tl9PTighKHBsbC0+YWN0aXZlX21hc2sgJiBjcnRjX21hc2spKSkKPiA+ICAgCQlnb3RvIG91dDsK
PiA+IEBAIC0yMjcsNyArMjI3LDcgQEAgdm9pZCBpbnRlbF9kaXNhYmxlX3NoYXJlZF9kcGxsKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICAJCSAgICAgIHBs
bC0+aW5mby0+bmFtZSwgcGxsLT5hY3RpdmVfbWFzaywgcGxsLT5vbiwKPiA+ICAgCQkgICAgICBj
cnRjLT5iYXNlLmJhc2UuaWQpOwo+ID4gLQlhc3NlcnRfc2hhcmVkX2RwbGxfZW5hYmxlZChkZXZf
cHJpdiwgcGxsKTsKPiA+ICsJYXNzZXJ0X3NoYXJlZF9kcGxsX2VuYWJsZWQoaTkxNSwgcGxsKTsK
PiA+ICAgCVdBUk5fT04oIXBsbC0+b24pOwo+ID4gICAJcGxsLT5hY3RpdmVfbWFzayAmPSB+Y3J0
Y19tYXNrOwo+ID4gQEAgLTIzNSwxMSArMjM1LDExIEBAIHZvaWQgaW50ZWxfZGlzYWJsZV9zaGFy
ZWRfZHBsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAg
CQlnb3RvIG91dDsKPiA+ICAgCURSTV9ERUJVR19LTVMoImRpc2FibGluZyAlc1xuIiwgcGxsLT5p
bmZvLT5uYW1lKTsKPiA+IC0JcGxsLT5pbmZvLT5mdW5jcy0+ZGlzYWJsZShkZXZfcHJpdiwgcGxs
KTsKPiA+ICsJcGxsLT5pbmZvLT5mdW5jcy0+ZGlzYWJsZShpOTE1LCBwbGwpOwo+ID4gICAJcGxs
LT5vbiA9IGZhbHNlOwo+ID4gICBvdXQ6Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRw
bGxfbG9jayk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHBsbF9sb2NrKTsKPiA+ICAgfQo+
ID4gICBzdGF0aWMgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICoKPiA+IEBAIC0yNDgsNyArMjQ4
LDcgQEAgaW50ZWxfZmluZF9zaGFyZWRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwKPiA+ICAgCQkgICAgICAgZW51bSBpbnRlbF9kcGxsX2lkIHJhbmdlX21heCkKPiA+
ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3No
YXJlZF9kcGxsICpwbGwsICp1bnVzZWRfcGxsID0gTlVMTDsKPiA+ICAgCXN0cnVjdCBpbnRlbF9z
aGFyZWRfZHBsbF9zdGF0ZSAqc2hhcmVkX2RwbGw7Cj4gPiAgIAllbnVtIGludGVsX2RwbGxfaWQg
aTsKPiA+IEBAIC0yNTYsNyArMjU2LDcgQEAgaW50ZWxfZmluZF9zaGFyZWRfZHBsbChzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCXNoYXJlZF9kcGxsID0gaW50ZWxf
YXRvbWljX2dldF9zaGFyZWRfZHBsbF9zdGF0ZShjcnRjX3N0YXRlLT5iYXNlLnN0YXRlKTsKPiA+
ICAgCWZvciAoaSA9IHJhbmdlX21pbjsgaSA8PSByYW5nZV9tYXg7IGkrKykgewo+ID4gLQkJcGxs
ID0gJmRldl9wcml2LT5zaGFyZWRfZHBsbHNbaV07Cj4gPiArCQlwbGwgPSAmaTkxNS0+c2hhcmVk
X2RwbGxzW2ldOwo+ID4gICAJCS8qIE9ubHkgd2FudCB0byBjaGVjayBlbmFibGVkIHRpbWluZ3Mg
Zmlyc3QgKi8KPiA+ICAgCQlpZiAoc2hhcmVkX2RwbGxbaV0uY3J0Y19tYXNrID09IDApIHsKPiA+
IEBAIC0zMjIsNyArMzIyLDcgQEAgaW50ZWxfcmVmZXJlbmNlX3NoYXJlZF9kcGxsKHN0cnVjdCBp
bnRlbF9zaGFyZWRfZHBsbCAqcGxsLAo+ID4gICAgKi8KPiA+ICAgdm9pZCBpbnRlbF9zaGFyZWRf
ZHBsbF9zd2FwX3N0YXRlKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHN0YXRlLT5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoc3RhdGUt
PmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGxfc3RhdGUgKnNoYXJlZF9kcGxs
Owo+ID4gICAJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGw7Cj4gPiAgIAllbnVtIGludGVs
X2RwbGxfaWQgaTsKPiA+IEBAIC0zMzEsMTAgKzMzMSwxMCBAQCB2b2lkIGludGVsX3NoYXJlZF9k
cGxsX3N3YXBfc3RhdGUoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICAJCXJl
dHVybjsKPiA+ICAgCXNoYXJlZF9kcGxsID0gdG9faW50ZWxfYXRvbWljX3N0YXRlKHN0YXRlKS0+
c2hhcmVkX2RwbGw7Cj4gPiAtCWZvciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+bnVtX3NoYXJlZF9k
cGxsOyBpKyspIHsKPiA+ICsJZm9yIChpID0gMDsgaSA8IGk5MTUtPm51bV9zaGFyZWRfZHBsbDsg
aSsrKSB7Cj4gPiAgIAkJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsX3N0YXRlIHRtcDsKPiA+IC0J
CXBsbCA9ICZkZXZfcHJpdi0+c2hhcmVkX2RwbGxzW2ldOwo+ID4gKwkJcGxsID0gJmk5MTUtPnNo
YXJlZF9kcGxsc1tpXTsKPiA+ICAgCQl0bXAgPSBwbGwtPnN0YXRlOwo+ID4gICAJCXBsbC0+c3Rh
dGUgPSBzaGFyZWRfZHBsbFtpXTsKPiA+IEBAIC0zNDIsNyArMzQyLDcgQEAgdm9pZCBpbnRlbF9z
aGFyZWRfZHBsbF9zd2FwX3N0YXRlKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+
ICAgCX0KPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIGlieF9wY2hfZHBsbF9nZXRfaHdfc3RhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIGlieF9w
Y2hfZHBsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAg
IAkJCQkgICAgICBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiA+ICAgCQkJCSAgICAg
IHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19zdGF0ZSkKPiA+ICAgewo+ID4gQEAgLTM1
MCw3ICszNTAsNyBAQCBzdGF0aWMgYm9vbCBpYnhfcGNoX2RwbGxfZ2V0X2h3X3N0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtl
cmVmOwo+ID4gICAJdTMyIHZhbDsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJf
Z2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsCj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2dldF9pZl9lbmFibGVkKGk5MTUsCj4gPiAgIAkJCQkJCSAgICAgUE9XRVJfRE9NQUlOX0RJ
U1BMQVlfQ09SRSk7Cj4gPiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+
ID4gQEAgLTM2MCwxMiArMzYwLDEyIEBAIHN0YXRpYyBib29sIGlieF9wY2hfZHBsbF9nZXRfaHdf
c3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJaHdfc3RhdGUt
PmZwMCA9IEk5MTVfUkVBRChQQ0hfRlAwKGlkKSk7Cj4gPiAgIAlod19zdGF0ZS0+ZnAxID0gSTkx
NV9SRUFEKFBDSF9GUDEoaWQpKTsKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3By
aXYsIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUsIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9kaXNw
bGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9ET01BSU5fRElTUExBWV9DT1JFLCB3YWtlcmVmKTsK
PiA+ICAgCXJldHVybiB2YWwgJiBEUExMX1ZDT19FTkFCTEU7Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
dm9pZCBpYnhfcGNoX2RwbGxfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiArc3RhdGljIHZvaWQgaWJ4X3BjaF9kcGxsX3ByZXBhcmUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwp
Cj4gPiAgIHsKPiA+ICAgCWNvbnN0IGVudW0gaW50ZWxfZHBsbF9pZCBpZCA9IHBsbC0+aW5mby0+
aWQ7Cj4gPiBAQCAtMzc0LDEyICszNzQsMTIgQEAgc3RhdGljIHZvaWQgaWJ4X3BjaF9kcGxsX3By
ZXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJSTkxNV9XUklU
RShQQ0hfRlAxKGlkKSwgcGxsLT5zdGF0ZS5od19zdGF0ZS5mcDEpOwo+ID4gICB9Cj4gPiAtc3Rh
dGljIHZvaWQgaWJ4X2Fzc2VydF9wY2hfcmVmY2xrX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGlieF9hc3NlcnRfcGNoX3JlZmNsa19l
bmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIg
dmFsOwo+ID4gICAJYm9vbCBlbmFibGVkOwo+ID4gLQlJOTE1X1NUQVRFX1dBUk5fT04oIShIQVNf
UENIX0lCWChkZXZfcHJpdikgfHwgSEFTX1BDSF9DUFQoZGV2X3ByaXYpKSk7Cj4gPiArCUk5MTVf
U1RBVEVfV0FSTl9PTighKEhBU19QQ0hfSUJYKGk5MTUpIHx8IEhBU19QQ0hfQ1BUKGk5MTUpKSk7
Cj4gPiAgIAl2YWwgPSBJOTE1X1JFQUQoUENIX0RSRUZfQ09OVFJPTCk7Cj4gPiAgIAllbmFibGVk
ID0gISEodmFsICYgKERSRUZfU1NDX1NPVVJDRV9NQVNLIHwgRFJFRl9OT05TUFJFQURfU09VUkNF
X01BU0sgfAo+ID4gQEAgLTM4NywxMyArMzg3LDEzIEBAIHN0YXRpYyB2b2lkIGlieF9hc3NlcnRf
cGNoX3JlZmNsa19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCUk5MTVfU1RBVEVfV0FSTighZW5hYmxlZCwgIlBDSCByZWZjbGsgYXNzZXJ0aW9uIGZhaWx1
cmUsIHNob3VsZCBiZSBhY3RpdmUgYnV0IGlzIGRpc2FibGVkXG4iKTsKPiA+ICAgfQo+ID4gLXN0
YXRpYyB2b2lkIGlieF9wY2hfZHBsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGlieF9wY2hfZHBsbF9lbmFibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBs
bCkKPiA+ICAgewo+ID4gICAJY29uc3QgZW51bSBpbnRlbF9kcGxsX2lkIGlkID0gcGxsLT5pbmZv
LT5pZDsKPiA+ICAgCS8qIFBDSCByZWZjbG9jayBtdXN0IGJlIGVuYWJsZWQgZmlyc3QgKi8KPiA+
IC0JaWJ4X2Fzc2VydF9wY2hfcmVmY2xrX2VuYWJsZWQoZGV2X3ByaXYpOwo+ID4gKwlpYnhfYXNz
ZXJ0X3BjaF9yZWZjbGtfZW5hYmxlZChpOTE1KTsKPiA+ICAgCUk5MTVfV1JJVEUoUENIX0RQTEwo
aWQpLCBwbGwtPnN0YXRlLmh3X3N0YXRlLmRwbGwpOwo+ID4gQEAgLTQxMSw3ICs0MTEsNyBAQCBz
dGF0aWMgdm9pZCBpYnhfcGNoX2RwbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCXVkZWxheSgyMDApOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaWJ4
X3BjaF9kcGxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
K3N0YXRpYyB2b2lkIGlieF9wY2hfZHBsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ID4gICAJCQkJIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKQo+ID4gICB7
Cj4gPiAgIAljb25zdCBlbnVtIGludGVsX2RwbGxfaWQgaWQgPSBwbGwtPmluZm8tPmlkOwo+ID4g
QEAgLTQyNiwxNCArNDI2LDE0IEBAIGlieF9nZXRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCSAgICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIp
Cj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9zaGFyZWRfZHBsbCAqcGxsOwo+ID4gICAJZW51bSBpbnRlbF9kcGxsX2lkIGk7Cj4gPiAtCWlm
IChIQVNfUENIX0lCWChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19QQ0hfSUJYKGk5MTUpKSB7
Cj4gPiAgIAkJLyogSXJvbmxha2UgUENIIGhhcyBhIGZpeGVkIFBMTC0+UENIIHBpcGUgbWFwcGlu
Zy4gKi8KPiA+ICAgCQlpID0gKGVudW0gaW50ZWxfZHBsbF9pZCkgY3J0Yy0+cGlwZTsKPiA+IC0J
CXBsbCA9ICZkZXZfcHJpdi0+c2hhcmVkX2RwbGxzW2ldOwo+ID4gKwkJcGxsID0gJmk5MTUtPnNo
YXJlZF9kcGxsc1tpXTsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJbQ1JUQzolZDolc10gdXNpbmcg
cHJlLWFsbG9jYXRlZCAlc1xuIiwKPiA+ICAgCQkJICAgICAgY3J0Yy0+YmFzZS5iYXNlLmlkLCBj
cnRjLT5iYXNlLm5hbWUsCj4gPiBAQCAtNDUzLDcgKzQ1Myw3IEBAIGlieF9nZXRfZHBsbChzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCXJldHVybiBwbGw7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCBpYnhfZHVtcF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaWJ4X2R1bXBfaHdfc3RhdGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRl
bF9kcGxsX2h3X3N0YXRlICpod19zdGF0ZSkKPiA+ICAgewo+ID4gICAJRFJNX0RFQlVHX0tNUygi
ZHBsbF9od19zdGF0ZTogZHBsbDogMHgleCwgZHBsbF9tZDogMHgleCwgIgo+ID4gQEAgLTQ3MSw3
ICs0NzEsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsX2Z1bmNzIGli
eF9wY2hfZHBsbF9mdW5jcyA9IHsKPiA+ICAgCS5nZXRfaHdfc3RhdGUgPSBpYnhfcGNoX2RwbGxf
Z2V0X2h3X3N0YXRlLAo+ID4gICB9Owo+ID4gLXN0YXRpYyB2b2lkIGhzd19kZGlfd3JwbGxfZW5h
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBo
c3dfZGRpX3dycGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJICAgICAgIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKQo+ID4gICB7Cj4gPiAgIAlj
b25zdCBlbnVtIGludGVsX2RwbGxfaWQgaWQgPSBwbGwtPmluZm8tPmlkOwo+ID4gQEAgLTQ4MSw3
ICs0ODEsNyBAQCBzdGF0aWMgdm9pZCBoc3dfZGRpX3dycGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAl1ZGVsYXkoMjApOwo+ID4gICB9Cj4gPiAtc3Rh
dGljIHZvaWQgaHN3X2RkaV9zcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaHN3X2RkaV9zcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxs
KQo+ID4gICB7Cj4gPiAgIAlJOTE1X1dSSVRFKFNQTExfQ1RMLCBwbGwtPnN0YXRlLmh3X3N0YXRl
LnNwbGwpOwo+ID4gQEAgLTQ4OSw3ICs0ODksNyBAQCBzdGF0aWMgdm9pZCBoc3dfZGRpX3NwbGxf
ZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXVkZWxheSgy
MCk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBoc3dfZGRpX3dycGxsX2Rpc2FibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGhzd19kZGlfd3Jw
bGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgc3Ry
dWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwpCj4gPiAgIHsKPiA+ICAgCWNvbnN0IGVudW0gaW50
ZWxfZHBsbF9pZCBpZCA9IHBsbC0+aW5mby0+aWQ7Cj4gPiBAQCAtNTAwLDcgKzUwMCw3IEBAIHN0
YXRpYyB2b2lkIGhzd19kZGlfd3JwbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiAgIAlQT1NUSU5HX1JFQUQoV1JQTExfQ1RMKGlkKSk7Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgdm9pZCBoc3dfZGRpX3NwbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaHN3X2RkaV9zcGxsX2Rpc2FibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgc3RydWN0IGludGVsX3NoYXJlZF9k
cGxsICpwbGwpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7Cj4gPiBAQCAtNTEwLDcgKzUxMCw3IEBA
IHN0YXRpYyB2b2lkIGhzd19kZGlfc3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICAgCVBPU1RJTkdfUkVBRChTUExMX0NUTCk7Cj4gPiAgIH0KPiA+IC1z
dGF0aWMgYm9vbCBoc3dfZGRpX3dycGxsX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGJvb2wgaHN3X2RkaV93cnBsbF9nZXRfaHdfc3Rh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgICAgc3RydWN0
IGludGVsX3NoYXJlZF9kcGxsICpwbGwsCj4gPiAgIAkJCQkgICAgICAgc3RydWN0IGludGVsX2Rw
bGxfaHdfc3RhdGUgKmh3X3N0YXRlKQo+ID4gICB7Cj4gPiBAQCAtNTE4LDcgKzUxOCw3IEBAIHN0
YXRpYyBib29sIGhzd19kZGlfd3JwbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJdTMy
IHZhbDsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQo
ZGV2X3ByaXYsCj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFi
bGVkKGk5MTUsCj4gPiAgIAkJCQkJCSAgICAgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09SRSk7Cj4g
PiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTUyNiwxOSAr
NTI2LDE5IEBAIHN0YXRpYyBib29sIGhzd19kZGlfd3JwbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXZhbCA9IEk5MTVfUkVBRChXUlBMTF9D
VEwoaWQpKTsKPiA+ICAgCWh3X3N0YXRlLT53cnBsbCA9IHZhbDsKPiA+IC0JaW50ZWxfZGlzcGxh
eV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUsIHdha2VyZWYp
Owo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9ET01BSU5fRElTUExB
WV9DT1JFLCB3YWtlcmVmKTsKPiA+ICAgCXJldHVybiB2YWwgJiBXUlBMTF9QTExfRU5BQkxFOwo+
ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wgaHN3X2RkaV9zcGxsX2dldF9od19zdGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGJvb2wgaHN3X2RkaV9zcGxs
X2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAg
ICAgIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsLAo+ID4gICAJCQkJICAgICAgc3RydWN0
IGludGVsX2RwbGxfaHdfc3RhdGUgKmh3X3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlpbnRlbF93YWtl
cmVmX3Qgd2FrZXJlZjsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNw
bGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2LAo+ID4gKwl3YWtlcmVmID0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LAo+ID4gICAJCQkJCQkgICAgIFBPV0VS
X0RPTUFJTl9ESVNQTEFZX0NPUkUpOwo+ID4gICAJaWYgKCF3YWtlcmVmKQo+ID4gICAJCXJldHVy
biBmYWxzZTsKPiA+IEBAIC01NDYsNyArNTQ2LDcgQEAgc3RhdGljIGJvb2wgaHN3X2RkaV9zcGxs
X2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAl2
YWwgPSBJOTE1X1JFQUQoU1BMTF9DVEwpOwo+ID4gICAJaHdfc3RhdGUtPnNwbGwgPSB2YWw7Cj4g
PiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQT1dFUl9ET01BSU5fRElTUExB
WV9DT1JFLCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9X
RVJfRE9NQUlOX0RJU1BMQVlfQ09SRSwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4gdmFsICYgU1BM
TF9QTExfRU5BQkxFOwo+ID4gICB9Cj4gPiBAQCAtNzkzLDcgKzc5Myw3IEBAIHN0YXRpYyBzdHJ1
Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKmhzd19kZGlfaGRtaV9nZXRfZHBsbChzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqCj4gPiAgIHN0YXRpYyBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKgo+ID4g
ICBoc3dfZGRpX2RwX2dldF9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gICAJ
c3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGw7Cj4gPiAgIAllbnVtIGludGVsX2RwbGxfaWQg
cGxsX2lkOwo+ID4gICAJaW50IGNsb2NrID0gY3J0Y19zdGF0ZS0+cG9ydF9jbG9jazsKPiA+IEBA
IC04MTMsNyArODEzLDcgQEAgaHN3X2RkaV9kcF9nZXRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgCQlyZXR1cm4gTlVMTDsKPiA+ICAgCX0KPiA+IC0JcGxs
ID0gaW50ZWxfZ2V0X3NoYXJlZF9kcGxsX2J5X2lkKGRldl9wcml2LCBwbGxfaWQpOwo+ID4gKwlw
bGwgPSBpbnRlbF9nZXRfc2hhcmVkX2RwbGxfYnlfaWQoaTkxNSwgcGxsX2lkKTsKPiA+ICAgCWlm
ICghcGxsKQo+ID4gICAJCXJldHVybiBOVUxMOwo+ID4gQEAgLTg1NSw3ICs4NTUsNyBAQCBoc3df
Z2V0X2RwbGwoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAlyZXR1
cm4gcGxsOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaHN3X2R1bXBfaHdfc3RhdGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGhzd19kdW1wX2h3
X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgICBjb25z
dCBzdHJ1Y3QgaW50ZWxfZHBsbF9od19zdGF0ZSAqaHdfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCURS
TV9ERUJVR19LTVMoImRwbGxfaHdfc3RhdGU6IHdycGxsOiAweCV4IHNwbGw6IDB4JXhcbiIsCj4g
PiBAQCAtODc0LDE3ICs4NzQsMTcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9zaGFyZWRf
ZHBsbF9mdW5jcyBoc3dfZGRpX3NwbGxfZnVuY3MgPSB7Cj4gPiAgIAkuZ2V0X2h3X3N0YXRlID0g
aHN3X2RkaV9zcGxsX2dldF9od19zdGF0ZSwKPiA+ICAgfTsKPiA+IC1zdGF0aWMgdm9pZCBoc3df
ZGRpX2xjcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAr
c3RhdGljIHZvaWQgaHN3X2RkaV9sY3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gPiAgIAkJCQkgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwpCj4gPiAgIHsK
PiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGhzd19kZGlfbGNwbGxfZGlzYWJsZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaHN3X2RkaV9sY3BsbF9k
aXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICBzdHJ1Y3Qg
aW50ZWxfc2hhcmVkX2RwbGwgKnBsbCkKPiA+ICAgewo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wg
aHN3X2RkaV9sY3BsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK3N0YXRpYyBib29sIGhzd19kZGlfbGNwbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgIHN0cnVjdCBpbnRlbF9zaGFy
ZWRfZHBsbCAqcGxsLAo+ID4gICAJCQkJICAgICAgIHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRl
ICpod19zdGF0ZSkKPiA+ICAgewo+ID4gQEAgLTkyOCw3ICs5MjgsNyBAQCBzdGF0aWMgY29uc3Qg
c3RydWN0IHNrbF9kcGxsX3JlZ3Mgc2tsX2RwbGxfcmVnc1s0XSA9IHsKPiA+ICAgCX0sCj4gPiAg
IH07Cj4gPiAtc3RhdGljIHZvaWQgc2tsX2RkaV9wbGxfd3JpdGVfY3RybDEoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIHNrbF9kZGlfcGxsX3dyaXRl
X2N0cmwxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgIHN0cnVj
dCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKQo+ID4gICB7Cj4gPiAgIAljb25zdCBlbnVtIGludGVs
X2RwbGxfaWQgaWQgPSBwbGwtPmluZm8tPmlkOwo+ID4gQEAgLTk0NSwxMyArOTQ1LDEzIEBAIHN0
YXRpYyB2b2lkIHNrbF9kZGlfcGxsX3dyaXRlX2N0cmwxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICAgCVBPU1RJTkdfUkVBRChEUExMX0NUUkwxKTsKPiA+ICAgfQo+ID4g
LXN0YXRpYyB2b2lkIHNrbF9kZGlfcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgc2tsX2RkaV9wbGxfZW5hYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgICAgc3RydWN0IGludGVsX3NoYXJlZF9k
cGxsICpwbGwpCj4gPiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVjdCBza2xfZHBsbF9yZWdzICpyZWdz
ID0gc2tsX2RwbGxfcmVnczsKPiA+ICAgCWNvbnN0IGVudW0gaW50ZWxfZHBsbF9pZCBpZCA9IHBs
bC0+aW5mby0+aWQ7Cj4gPiAtCXNrbF9kZGlfcGxsX3dyaXRlX2N0cmwxKGRldl9wcml2LCBwbGwp
Owo+ID4gKwlza2xfZGRpX3BsbF93cml0ZV9jdHJsMShpOTE1LCBwbGwpOwo+ID4gICAJSTkxNV9X
UklURShyZWdzW2lkXS5jZmdjcjEsIHBsbC0+c3RhdGUuaHdfc3RhdGUuY2ZnY3IxKTsKPiA+ICAg
CUk5MTVfV1JJVEUocmVnc1tpZF0uY2ZnY3IyLCBwbGwtPnN0YXRlLmh3X3N0YXRlLmNmZ2NyMik7
Cj4gPiBAQCAtOTYyLDcgKzk2Miw3IEBAIHN0YXRpYyB2b2lkIHNrbF9kZGlfcGxsX2VuYWJsZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlJOTE1X1dSSVRFKHJlZ3Nb
aWRdLmN0bCwKPiA+ICAgCQkgICBJOTE1X1JFQUQocmVnc1tpZF0uY3RsKSB8IExDUExMX1BMTF9F
TkFCTEUpOwo+ID4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNv
cmUsCj4gPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4g
ICAJCQkJICAgIERQTExfU1RBVFVTLAo+ID4gICAJCQkJICAgIERQTExfTE9DSyhpZCksCj4gPiAg
IAkJCQkgICAgRFBMTF9MT0NLKGlkKSwKPiA+IEBAIC05NzAsMTMgKzk3MCwxMyBAQCBzdGF0aWMg
dm9pZCBza2xfZGRpX3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gICAJCURSTV9FUlJPUigiRFBMTCAlZCBub3QgbG9ja2VkXG4iLCBpZCk7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgdm9pZCBza2xfZGRpX2RwbGwwX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgc2tsX2RkaV9kcGxsMF9lbmFibGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgc3RydWN0IGludGVsX3NoYXJl
ZF9kcGxsICpwbGwpCj4gPiAgIHsKPiA+IC0Jc2tsX2RkaV9wbGxfd3JpdGVfY3RybDEoZGV2X3By
aXYsIHBsbCk7Cj4gPiArCXNrbF9kZGlfcGxsX3dyaXRlX2N0cmwxKGk5MTUsIHBsbCk7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCBza2xfZGRpX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBza2xfZGRpX3BsbF9kaXNhYmxlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJc3RydWN0IGludGVsX3NoYXJl
ZF9kcGxsICpwbGwpCj4gPiAgIHsKPiA+ICAgCWNvbnN0IHN0cnVjdCBza2xfZHBsbF9yZWdzICpy
ZWdzID0gc2tsX2RwbGxfcmVnczsKPiA+IEBAIC05ODgsMTIgKzk4OCwxMiBAQCBzdGF0aWMgdm9p
ZCBza2xfZGRpX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICAgCVBPU1RJTkdfUkVBRChyZWdzW2lkXS5jdGwpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgc2tsX2RkaV9kcGxsMF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICtzdGF0aWMgdm9pZCBza2xfZGRpX2RwbGwwX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxs
KQo+ID4gICB7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBza2xfZGRpX3BsbF9nZXRfaHdfc3Rh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIHNr
bF9kZGlfcGxsX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+
ICAgCQkJCSAgICAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwsCj4gPiAgIAkJCQkgICAg
IHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19zdGF0ZSkKPiA+ICAgewo+ID4gQEAgLTEw
MDMsNyArMTAwMyw3IEBAIHN0YXRpYyBib29sIHNrbF9kZGlfcGxsX2dldF9od19zdGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2Fr
ZXJlZjsKPiA+ICAgCWJvb2wgcmV0Owo+ID4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dl
cl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwKPiA+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlf
cG93ZXJfZ2V0X2lmX2VuYWJsZWQoaTkxNSwKPiA+ICAgCQkJCQkJICAgICBQT1dFUl9ET01BSU5f
RElTUExBWV9DT1JFKTsKPiA+ICAgCWlmICghd2FrZXJlZikKPiA+ICAgCQlyZXR1cm4gZmFsc2U7
Cj4gPiBAQCAtMTAyNSwxMiArMTAyNSwxMiBAQCBzdGF0aWMgYm9vbCBza2xfZGRpX3BsbF9nZXRf
aHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJcmV0ID0g
dHJ1ZTsKPiA+ICAgb3V0Ogo+ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwg
UE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09SRSwgd2FrZXJlZik7Cj4gPiArCWludGVsX2Rpc3BsYXlf
cG93ZXJfcHV0KGk5MTUsIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUsIHdha2VyZWYpOwo+ID4g
ICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIHNrbF9kZGlfZHBsbDBfZ2V0
X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMg
Ym9vbCBza2xfZGRpX2RwbGwwX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiA+
ICAgCQkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfZHBsbF9od19zdGF0ZSAqaHdfc3RhdGUpCj4gPiAg
IHsKPiA+IEBAIC0xMDQwLDcgKzEwNDAsNyBAQCBzdGF0aWMgYm9vbCBza2xfZGRpX2RwbGwwX2dl
dF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAl1MzIg
dmFsOwo+ID4gICAJYm9vbCByZXQ7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2dldF9pZl9lbmFibGVkKGRldl9wcml2LAo+ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9w
b3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LAo+ID4gICAJCQkJCQkgICAgIFBPV0VSX0RPTUFJTl9E
SVNQTEFZX0NPUkUpOwo+ID4gICAJaWYgKCF3YWtlcmVmKQo+ID4gICAJCXJldHVybiBmYWxzZTsK
PiA+IEBAIC0xMDU4LDcgKzEwNTgsNyBAQCBzdGF0aWMgYm9vbCBza2xfZGRpX2RwbGwwX2dldF9o
d19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXQgPSB0
cnVlOwo+ID4gICBvdXQ6Cj4gPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQ
T1dFUl9ET01BSU5fRElTUExBWV9DT1JFLCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9w
b3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09SRSwgd2FrZXJlZik7Cj4gPiAg
IAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtMTQyNCw3ICsxNDI0LDcgQEAgc2tsX2dldF9k
cGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJcmV0dXJuIHBs
bDsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHNrbF9kdW1wX2h3X3N0YXRlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBza2xfZHVtcF9od19zdGF0
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgY29uc3Qgc3Ry
dWN0IGludGVsX2RwbGxfaHdfc3RhdGUgKmh3X3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlEUk1fREVC
VUdfS01TKCJkcGxsX2h3X3N0YXRlOiAiCj4gPiBAQCAtMTQ0Niw3ICsxNDQ2LDcgQEAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbF9mdW5jcyBza2xfZGRpX2RwbGwwX2Z1bmNz
ID0gewo+ID4gICAJLmdldF9od19zdGF0ZSA9IHNrbF9kZGlfZHBsbDBfZ2V0X2h3X3N0YXRlLAo+
ID4gICB9Owo+ID4gLXN0YXRpYyB2b2lkIGJ4dF9kZGlfcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgYnh0X2RkaV9wbGxfZW5hYmxl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJc3RydWN0IGludGVsX3No
YXJlZF9kcGxsICpwbGwpCj4gPiAgIHsKPiA+ICAgCXUzMiB0ZW1wOwo+ID4gQEAgLTE0NTQsMTQg
KzE0NTQsMTQgQEAgc3RhdGljIHZvaWQgYnh0X2RkaV9wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWVudW0gZHBpb19waHkgcGh5Owo+ID4gICAJZW51
bSBkcGlvX2NoYW5uZWwgY2g7Cj4gPiAtCWJ4dF9wb3J0X3RvX3BoeV9jaGFubmVsKGRldl9wcml2
LCBwb3J0LCAmcGh5LCAmY2gpOwo+ID4gKwlieHRfcG9ydF90b19waHlfY2hhbm5lbChpOTE1LCBw
b3J0LCAmcGh5LCAmY2gpOwo+ID4gICAJLyogTm9uLVNTQyByZWZlcmVuY2UgKi8KPiA+ICAgCXRl
bXAgPSBJOTE1X1JFQUQoQlhUX1BPUlRfUExMX0VOQUJMRShwb3J0KSk7Cj4gPiAgIAl0ZW1wIHw9
IFBPUlRfUExMX1JFRl9TRUw7Cj4gPiAgIAlJOTE1X1dSSVRFKEJYVF9QT1JUX1BMTF9FTkFCTEUo
cG9ydCksIHRlbXApOwo+ID4gLQlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPiA+ICsJ
aWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpIHsKPiA+ICAgCQl0ZW1wID0gSTkxNV9SRUFEKEJYVF9Q
T1JUX1BMTF9FTkFCTEUocG9ydCkpOwo+ID4gICAJCXRlbXAgfD0gUE9SVF9QTExfUE9XRVJfRU5B
QkxFOwo+ID4gICAJCUk5MTVfV1JJVEUoQlhUX1BPUlRfUExMX0VOQUJMRShwb3J0KSwgdGVtcCk7
Cj4gPiBAQCAtMTU0OSw3ICsxNTQ5LDcgQEAgc3RhdGljIHZvaWQgYnh0X2RkaV9wbGxfZW5hYmxl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQkJMjAwKSkKPiA+ICAg
CQlEUk1fRVJST1IoIlBMTCAlZCBub3QgbG9ja2VkXG4iLCBwb3J0KTsKPiA+IC0JaWYgKElTX0dF
TUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19HRU1JTklMQUtFKGk5MTUpKSB7Cj4g
PiAgIAkJdGVtcCA9IEk5MTVfUkVBRChCWFRfUE9SVF9UWF9EVzVfTE4wKHBoeSwgY2gpKTsKPiA+
ICAgCQl0ZW1wIHw9IERDQ19ERUxBWV9SQU5HRV8yOwo+ID4gICAJCUk5MTVfV1JJVEUoQlhUX1BP
UlRfVFhfRFc1X0dSUChwaHksIGNoKSwgdGVtcCk7Cj4gPiBAQCAtMTU2Niw3ICsxNTY2LDcgQEAg
c3RhdGljIHZvaWQgYnh0X2RkaV9wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCUk5MTVfV1JJVEUoQlhUX1BPUlRfUENTX0RXMTJfR1JQKHBoeSwgY2gp
LCB0ZW1wKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGJ4dF9kZGlfcGxsX2Rpc2FibGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGJ4dF9kZGlf
cGxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJc3Ry
dWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwpCj4gPiAgIHsKPiA+ICAgCWVudW0gcG9ydCBwb3J0
ID0gKGVudW0gcG9ydClwbGwtPmluZm8tPmlkOyAvKiAxOjEgcG9ydC0+UExMIG1hcHBpbmcgKi8K
PiA+IEBAIC0xNTc3LDcgKzE1NzcsNyBAQCBzdGF0aWMgdm9pZCBieHRfZGRpX3BsbF9kaXNhYmxl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCUk5MTVfV1JJVEUoQlhU
X1BPUlRfUExMX0VOQUJMRShwb3J0KSwgdGVtcCk7Cj4gPiAgIAlQT1NUSU5HX1JFQUQoQlhUX1BP
UlRfUExMX0VOQUJMRShwb3J0KSk7Cj4gPiAtCWlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSkg
ewo+ID4gKwlpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkgewo+ID4gICAJCXRlbXAgPSBJOTE1X1JF
QUQoQlhUX1BPUlRfUExMX0VOQUJMRShwb3J0KSk7Cj4gPiAgIAkJdGVtcCAmPSB+UE9SVF9QTExf
UE9XRVJfRU5BQkxFOwo+ID4gICAJCUk5MTVfV1JJVEUoQlhUX1BPUlRfUExMX0VOQUJMRShwb3J0
KSwgdGVtcCk7Cj4gPiBAQCAtMTU4OCw3ICsxNTg4LDcgQEAgc3RhdGljIHZvaWQgYnh0X2RkaV9w
bGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAl9Cj4g
PiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBieHRfZGRpX3BsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIGJ4dF9kZGlfcGxsX2dl
dF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQlzdHJ1
Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiA+ICAgCQkJCQlzdHJ1Y3QgaW50ZWxfZHBsbF9o
d19zdGF0ZSAqaHdfc3RhdGUpCj4gPiAgIHsKPiA+IEBAIC0xNTk5LDkgKzE1OTksOSBAQCBzdGF0
aWMgYm9vbCBieHRfZGRpX3BsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gICAJdTMyIHZhbDsKPiA+ICAgCWJvb2wgcmV0Owo+ID4gLQlieHRfcG9y
dF90b19waHlfY2hhbm5lbChkZXZfcHJpdiwgcG9ydCwgJnBoeSwgJmNoKTsKPiA+ICsJYnh0X3Bv
cnRfdG9fcGh5X2NoYW5uZWwoaTkxNSwgcG9ydCwgJnBoeSwgJmNoKTsKPiA+IC0Jd2FrZXJlZiA9
IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsCj4gPiArCXdha2Vy
ZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUsCj4gPiAgIAkJCQkJ
CSAgICAgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09SRSk7Cj4gPiAgIAlpZiAoIXdha2VyZWYpCj4g
PiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTE2NjAsNyArMTY2MCw3IEBAIHN0YXRpYyBib29s
IGJ4dF9kZGlfcGxsX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAgIAlyZXQgPSB0cnVlOwo+ID4gICBvdXQ6Cj4gPiAtCWludGVsX2Rpc3BsYXlfcG93
ZXJfcHV0KGRldl9wcml2LCBQT1dFUl9ET01BSU5fRElTUExBWV9DT1JFLCB3YWtlcmVmKTsKPiA+
ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09S
RSwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtMTgzMiw3ICsx
ODMyLDcgQEAgYnh0X2dldF9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
LAo+ID4gICAJICAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4g
ICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3NoYXJlZF9kcGxs
ICpwbGw7Cj4gPiAgIAllbnVtIGludGVsX2RwbGxfaWQgaWQ7Cj4gPiBAQCAtMTg0Niw3ICsxODQ2
LDcgQEAgYnh0X2dldF9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ID4gICAJLyogMToxIG1hcHBpbmcgYmV0d2VlbiBwb3J0cyBhbmQgUExMcyAqLwo+ID4gICAJaWQg
PSAoZW51bSBpbnRlbF9kcGxsX2lkKSBlbmNvZGVyLT5wb3J0Owo+ID4gLQlwbGwgPSBpbnRlbF9n
ZXRfc2hhcmVkX2RwbGxfYnlfaWQoZGV2X3ByaXYsIGlkKTsKPiA+ICsJcGxsID0gaW50ZWxfZ2V0
X3NoYXJlZF9kcGxsX2J5X2lkKGk5MTUsIGlkKTsKPiA+ICAgCURSTV9ERUJVR19LTVMoIltDUlRD
OiVkOiVzXSB1c2luZyBwcmUtYWxsb2NhdGVkICVzXG4iLAo+ID4gICAJCSAgICAgIGNydGMtPmJh
c2UuYmFzZS5pZCwgY3J0Yy0+YmFzZS5uYW1lLCBwbGwtPmluZm8tPm5hbWUpOwo+ID4gQEAgLTE4
NTYsNyArMTg1Niw3IEBAIGJ4dF9nZXRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwKPiA+ICAgCXJldHVybiBwbGw7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBieHRf
ZHVtcF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3Rh
dGljIHZvaWQgYnh0X2R1bXBfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19zdGF0
ZSkKPiA+ICAgewo+ID4gICAJRFJNX0RFQlVHX0tNUygiZHBsbF9od19zdGF0ZTogZWJiMDogMHgl
eCwgZWJiNDogMHgleCwiCj4gPiBAQCAtMTg4Nyw3ICsxODg3LDcgQEAgc3RydWN0IGludGVsX2Rw
bGxfbWdyIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqKCpnZXRfZHBsbCkoc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQkJICAgICAgc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIpOwo+ID4gLQl2b2lkICgqZHVtcF9od19zdGF0ZSkoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gKwl2b2lkICgqZHVtcF9od19zdGF0
ZSkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgIGNvbnN0IHN0
cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19zdGF0ZSk7Cj4gPiAgIH07Cj4gPiBAQCAtMTk0
Niw3ICsxOTQ2LDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kcGxsX21nciBieHRfcGxs
X21nciA9IHsKPiA+ICAgCS5kdW1wX2h3X3N0YXRlID0gYnh0X2R1bXBfaHdfc3RhdGUsCj4gPiAg
IH07Cj4gPiAtc3RhdGljIHZvaWQgY25sX2RkaV9wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBjbmxfZGRpX3BsbF9lbmFibGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxf
c2hhcmVkX2RwbGwgKnBsbCkKPiA+ICAgewo+ID4gICAJY29uc3QgZW51bSBpbnRlbF9kcGxsX2lk
IGlkID0gcGxsLT5pbmZvLT5pZDsKPiA+IEBAIC0xOTU4LDcgKzE5NTgsNyBAQCBzdGF0aWMgdm9p
ZCBjbmxfZGRpX3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gICAJSTkxNV9XUklURShDTkxfRFBMTF9FTkFCTEUoaWQpLCB2YWwpOwo+ID4gICAJLyogMi4g
V2FpdCBmb3IgRFBMTCBwb3dlciBzdGF0ZSBlbmFibGVkIGluIERQTExfRU5BQkxFLiAqLwo+ID4g
LQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCWlm
IChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJICAgIENO
TF9EUExMX0VOQUJMRShpZCksCj4gPiAgIAkJCQkgICAgUExMX1BPV0VSX1NUQVRFLAo+ID4gICAJ
CQkJICAgIFBMTF9QT1dFUl9TVEFURSwKPiA+IEBAIC0xOTk5LDcgKzE5OTksNyBAQCBzdGF0aWMg
dm9pZCBjbmxfZGRpX3BsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gICAJSTkxNV9XUklURShDTkxfRFBMTF9FTkFCTEUoaWQpLCB2YWwpOwo+ID4gICAJLyog
Ny4gV2FpdCBmb3IgUExMIGxvY2sgc3RhdHVzIGluIERQTExfRU5BQkxFLiAqLwo+ID4gLQlpZiAo
aW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCWlmIChpbnRl
bF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJICAgIENOTF9EUExM
X0VOQUJMRShpZCksCj4gPiAgIAkJCQkgICAgUExMX0xPQ0ssCj4gPiAgIAkJCQkgICAgUExMX0xP
Q0ssCj4gPiBAQCAtMjAyMSw3ICsyMDIxLDcgQEAgc3RhdGljIHZvaWQgY25sX2RkaV9wbGxfZW5h
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCSAqLwo+ID4gICB9
Cj4gPiAtc3RhdGljIHZvaWQgY25sX2RkaV9wbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgY25sX2RkaV9wbGxfZGlzYWJsZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCXN0cnVjdCBpbnRlbF9zaGFyZWRf
ZHBsbCAqcGxsKQo+ID4gICB7Cj4gPiAgIAljb25zdCBlbnVtIGludGVsX2RwbGxfaWQgaWQgPSBw
bGwtPmluZm8tPmlkOwo+ID4gQEAgLTIwNDcsNyArMjA0Nyw3IEBAIHN0YXRpYyB2b2lkIGNubF9k
ZGlfcGxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
STkxNV9XUklURShDTkxfRFBMTF9FTkFCTEUoaWQpLCB2YWwpOwo+ID4gICAJLyogNC4gV2FpdCBm
b3IgUExMIG5vdCBsb2NrZWQgc3RhdHVzIGluIERQTExfRU5BQkxFLiAqLwo+ID4gLQlpZiAoaW50
ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCWlmIChpbnRlbF93
YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJICAgIENOTF9EUExMX0VO
QUJMRShpZCksCj4gPiAgIAkJCQkgICAgUExMX0xPQ0ssCj4gPiAgIAkJCQkgICAgMCwKPiA+IEBA
IC0yMDY5LDcgKzIwNjksNyBAQCBzdGF0aWMgdm9pZCBjbmxfZGRpX3BsbF9kaXNhYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCUk5MTVfV1JJVEUoQ05MX0RQTExf
RU5BQkxFKGlkKSwgdmFsKTsKPiA+ICAgCS8qIDcuIFdhaXQgZm9yIERQTEwgcG93ZXIgc3RhdGUg
ZGlzYWJsZWQgaW4gRFBMTF9FTkFCTEUuICovCj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdp
c3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVy
KCZpOTE1LT51bmNvcmUsCj4gPiAgIAkJCQkgICAgQ05MX0RQTExfRU5BQkxFKGlkKSwKPiA+ICAg
CQkJCSAgICBQTExfUE9XRVJfU1RBVEUsCj4gPiAgIAkJCQkgICAgMCwKPiA+IEBAIC0yMDc3LDcg
KzIwNzcsNyBAQCBzdGF0aWMgdm9pZCBjbmxfZGRpX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQlEUk1fRVJST1IoIlBMTCAlZCBQb3dlciBub3Qg
ZGlzYWJsZWRcbiIsIGlkKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIGNubF9kZGlfcGxsX2dl
dF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGlj
IGJvb2wgY25sX2RkaV9wbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ID4gICAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiA+ICAg
CQkJCSAgICAgc3RydWN0IGludGVsX2RwbGxfaHdfc3RhdGUgKmh3X3N0YXRlKQo+ID4gICB7Cj4g
PiBAQCAtMjA4Niw3ICsyMDg2LDcgQEAgc3RhdGljIGJvb2wgY25sX2RkaV9wbGxfZ2V0X2h3X3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXUzMiB2YWw7Cj4g
PiAgIAlib29sIHJldDsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lm
X2VuYWJsZWQoZGV2X3ByaXYsCj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dl
dF9pZl9lbmFibGVkKGk5MTUsCj4gPiAgIAkJCQkJCSAgICAgUE9XRVJfRE9NQUlOX0RJU1BMQVlf
Q09SRSk7Cj4gPiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAg
LTIxMDcsNyArMjEwNyw3IEBAIHN0YXRpYyBib29sIGNubF9kZGlfcGxsX2dldF9od19zdGF0ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXQgPSB0cnVlOwo+ID4g
ICBvdXQ6Cj4gPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQT1dFUl9ET01B
SU5fRElTUExBWV9DT1JFLCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQo
aTkxNSwgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09SRSwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4g
cmV0Owo+ID4gICB9Cj4gPiBAQCAtMjE5OSwxNSArMjE5OSwxNSBAQCBzdGF0aWMgdm9pZCBjbmxf
d3JwbGxfcGFyYW1zX3BvcHVsYXRlKHN0cnVjdCBza2xfd3JwbGxfcGFyYW1zICpwYXJhbXMsCj4g
PiAgIAlwYXJhbXMtPmRjb19mcmFjdGlvbiA9IGRjbyAmIDB4N2ZmZjsKPiA+ICAgfQo+ID4gLWlu
dCBjbmxfaGRtaV9wbGxfcmVmX2Nsb2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICtpbnQgY25sX2hkbWlfcGxsX3JlZl9jbG9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpbnQgcmVmX2Nsb2NrID0gZGV2X3ByaXYtPmNkY2xrLmh3
LnJlZjsKPiA+ICsJaW50IHJlZl9jbG9jayA9IGk5MTUtPmNkY2xrLmh3LnJlZjsKPiA+ICAgCS8q
Cj4gPiAgIAkgKiBGb3IgSUNMKywgdGhlIHNwZWMgc3RhdGVzOiBpZiByZWZlcmVuY2UgZnJlcXVl
bmN5IGlzIDM4LjQsCj4gPiAgIAkgKiB1c2UgMTkuMiBiZWNhdXNlIHRoZSBEUExMIGF1dG9tYXRp
Y2FsbHkgZGl2aWRlcyB0aGF0IGJ5IDIuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gMTEgJiYgcmVmX2Nsb2NrID09IDM4NDAwKQo+ID4gKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDExICYmIHJlZl9jbG9jayA9PSAzODQwMCkKPiA+ICAgCQlyZWZfY2xvY2sgPSAx
OTIwMDsKPiA+ICAgCXJldHVybiByZWZfY2xvY2s7Cj4gPiBAQCAtMjIxNyw3ICsyMjE3LDcgQEAg
c3RhdGljIGJvb2wKPiA+ICAgY25sX2RkaV9jYWxjdWxhdGVfd3JwbGwoc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCXN0cnVjdCBza2xfd3JwbGxfcGFyYW1zICp3
cnBsbF9wYXJhbXMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRl
dik7Cj4gPiAgIAl1MzIgYWZlX2Nsb2NrID0gY3J0Y19zdGF0ZS0+cG9ydF9jbG9jayAqIDU7Cj4g
PiAgIAl1MzIgcmVmX2Nsb2NrOwo+ID4gICAJdTMyIGRjb19taW4gPSA3OTk4MDAwOwo+ID4gQEAg
LTIyNTIsNyArMjI1Miw3IEBAIGNubF9kZGlfY2FsY3VsYXRlX3dycGxsKHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJY25sX3dycGxsX2dldF9tdWx0aXBsaWVycyhi
ZXN0X2RpdiwgJnBkaXYsICZxZGl2LCAma2Rpdik7Cj4gPiAtCXJlZl9jbG9jayA9IGNubF9oZG1p
X3BsbF9yZWZfY2xvY2soZGV2X3ByaXYpOwo+ID4gKwlyZWZfY2xvY2sgPSBjbmxfaGRtaV9wbGxf
cmVmX2Nsb2NrKGk5MTUpOwo+ID4gICAJY25sX3dycGxsX3BhcmFtc19wb3B1bGF0ZSh3cnBsbF9w
YXJhbXMsIGJlc3RfZGNvLCByZWZfY2xvY2ssCj4gPiAgIAkJCQkgIHBkaXYsIHFkaXYsIGtkaXYp
Owo+ID4gQEAgLTIzNzAsNyArMjM3MCw3IEBAIGNubF9nZXRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCXJldHVybiBwbGw7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgdm9pZCBjbmxfZHVtcF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiArc3RhdGljIHZvaWQgY25sX2R1bXBfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0
YXRlICpod19zdGF0ZSkKPiA+ICAgewo+ID4gICAJRFJNX0RFQlVHX0tNUygiZHBsbF9od19zdGF0
ZTogIgo+ID4gQEAgLTI0NzYsOSArMjQ3Niw5IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc2tsX3dy
cGxsX3BhcmFtcyBpY2xfdGJ0X3BsbF8xOV8yTUh6X3ZhbHVlcyA9IHsKPiA+ICAgc3RhdGljIGJv
b2wgaWNsX2NhbGNfZHBfY29tYm9fcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAo+ID4gICAJCQkJICBzdHJ1Y3Qgc2tsX3dycGxsX3BhcmFtcyAqcGxsX3BhcmFtcykKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNy
dGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICAgCWNvbnN0
IHN0cnVjdCBpY2xfY29tYm9fcGxsX3BhcmFtcyAqcGFyYW1zID0KPiA+IC0JCWRldl9wcml2LT5j
ZGNsay5ody5yZWYgPT0gMjQwMDAgPwo+ID4gKwkJaTkxNS0+Y2RjbGsuaHcucmVmID09IDI0MDAw
ID8KPiA+ICAgCQlpY2xfZHBfY29tYm9fcGxsXzI0TUh6X3ZhbHVlcyA6Cj4gPiAgIAkJaWNsX2Rw
X2NvbWJvX3BsbF8xOV8yTUh6X3ZhbHVlczsKPiA+ICAgCWludCBjbG9jayA9IGNydGNfc3RhdGUt
PnBvcnRfY2xvY2s7Cj4gPiBAQCAtMjQ5OCw5ICsyNDk4LDkgQEAgc3RhdGljIGJvb2wgaWNsX2Nh
bGNfZHBfY29tYm9fcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4g
ICBzdGF0aWMgYm9vbCBpY2xfY2FsY190YnRfcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAo+ID4gICAJCQkgICAgIHN0cnVjdCBza2xfd3JwbGxfcGFyYW1zICpwbGxfcGFy
YW1zKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4g
LQkqcGxsX3BhcmFtcyA9IGRldl9wcml2LT5jZGNsay5ody5yZWYgPT0gMjQwMDAgPwo+ID4gKwkq
cGxsX3BhcmFtcyA9IGk5MTUtPmNkY2xrLmh3LnJlZiA9PSAyNDAwMCA/Cj4gPiAgIAkJCWljbF90
YnRfcGxsXzI0TUh6X3ZhbHVlcyA6IGljbF90YnRfcGxsXzE5XzJNSHpfdmFsdWVzOwo+ID4gICAJ
cmV0dXJuIHRydWU7Cj4gPiAgIH0KPiA+IEBAIC0yNTA4LDEyICsyNTA4LDEyIEBAIHN0YXRpYyBi
b29sIGljbF9jYWxjX3RidF9wbGwoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gPiAgIHN0YXRpYyBib29sIGljbF9jYWxjX2RwbGxfc3RhdGUoc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
cikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICAg
CXUzMiBjZmdjcjAsIGNmZ2NyMTsKPiA+ICAgCXN0cnVjdCBza2xfd3JwbGxfcGFyYW1zIHBsbF9w
YXJhbXMgPSB7IDAgfTsKPiA+ICAgCWJvb2wgcmV0Owo+ID4gLQlpZiAoaW50ZWxfcG9ydF9pc190
YyhkZXZfcHJpdiwgZW5jb2Rlci0+cG9ydCkpCj4gPiArCWlmIChpbnRlbF9wb3J0X2lzX3RjKGk5
MTUsIGVuY29kZXItPnBvcnQpKQo+ID4gICAJCXJldCA9IGljbF9jYWxjX3RidF9wbGwoY3J0Y19z
dGF0ZSwgJnBsbF9wYXJhbXMpOwo+ID4gICAJZWxzZSBpZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShj
cnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfSERNSSkgfHwKPiA+ICAgCQkgaW50ZWxfY3J0Y19oYXNf
dHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfRFNJKSkKPiA+IEBAIC0yNjI5LDkgKzI2Mjks
OSBAQCBzdGF0aWMgYm9vbCBpY2xfbWdfcGxsX2ZpbmRfZGl2aXNvcnMoaW50IGNsb2NrX2toeiwg
Ym9vbCBpc19kcCwgYm9vbCB1c2Vfc3NjLAo+ID4gICAgKi8KPiA+ICAgc3RhdGljIGJvb2wgaWNs
X2NhbGNfbWdfcGxsX3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gICAJc3Ry
dWN0IGludGVsX2RwbGxfaHdfc3RhdGUgKnBsbF9zdGF0ZSA9ICZjcnRjX3N0YXRlLT5kcGxsX2h3
X3N0YXRlOwo+ID4gLQlpbnQgcmVmY2xrX2toeiA9IGRldl9wcml2LT5jZGNsay5ody5yZWY7Cj4g
PiArCWludCByZWZjbGtfa2h6ID0gaTkxNS0+Y2RjbGsuaHcucmVmOwo+ID4gICAJaW50IGNsb2Nr
ID0gY3J0Y19zdGF0ZS0+cG9ydF9jbG9jazsKPiA+ICAgCXUzMiBkY29fa2h6LCBtMWRpdiwgbTJk
aXZfaW50LCBtMmRpdl9yZW0sIG0yZGl2X2ZyYWM7Cj4gPiAgIAl1MzIgaXJlZl9uZGl2LCBpcmVm
X3RyaW0sIGlyZWZfcHVsc2VfdzsKPiA+IEBAIC0yNzk2LDE4ICsyNzk2LDE4IEBAIHN0YXRpYyBz
dHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKgo+ID4gICBpY2xfZ2V0X2RwbGwoc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkgICAgIHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYp
Owo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQ7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbDsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0g
ZW5jb2Rlci0+cG9ydDsKPiA+ICAgCWVudW0gaW50ZWxfZHBsbF9pZCBtaW4sIG1heDsKPiA+ICAg
CWJvb2wgcmV0Owo+ID4gLQlpZiAoaW50ZWxfcG9ydF9pc19jb21ib3BoeShkZXZfcHJpdiwgcG9y
dCkpIHsKPiA+ICsJaWYgKGludGVsX3BvcnRfaXNfY29tYm9waHkoaTkxNSwgcG9ydCkpIHsKPiA+
ICAgCQltaW4gPSBEUExMX0lEX0lDTF9EUExMMDsKPiA+ICAgCQltYXggPSBEUExMX0lEX0lDTF9E
UExMMTsKPiA+ICAgCQlyZXQgPSBpY2xfY2FsY19kcGxsX3N0YXRlKGNydGNfc3RhdGUsIGVuY29k
ZXIpOwo+ID4gLQl9IGVsc2UgaWYgKGludGVsX3BvcnRfaXNfdGMoZGV2X3ByaXYsIHBvcnQpKSB7
Cj4gPiArCX0gZWxzZSBpZiAoaW50ZWxfcG9ydF9pc190YyhpOTE1LCBwb3J0KSkgewo+ID4gICAJ
CWlmIChlbmNvZGVyLT50eXBlID09IElOVEVMX09VVFBVVF9EUF9NU1QpIHsKPiA+ICAgCQkJc3Ry
dWN0IGludGVsX2RwX21zdF9lbmNvZGVyICptc3RfZW5jb2RlcjsKPiA+IEBAIC0yODI0LDcgKzI4
MjQsNyBAQCBpY2xfZ2V0X2RwbGwoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gPiAgIAkJfSBlbHNlIHsKPiA+ICAgCQkJZW51bSB0Y19wb3J0IHRjX3BvcnQ7Cj4gPiAtCQkJ
dGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoZGV2X3ByaXYsIHBvcnQpOwo+ID4gKwkJCXRjX3Bv
cnQgPSBpbnRlbF9wb3J0X3RvX3RjKGk5MTUsIHBvcnQpOwo+ID4gICAJCQltaW4gPSBpY2xfdGNf
cG9ydF90b19wbGxfaWQodGNfcG9ydCk7Cj4gPiAgIAkJCW1heCA9IG1pbjsKPiA+ICAgCQkJcmV0
ID0gaWNsX2NhbGNfbWdfcGxsX3N0YXRlKGNydGNfc3RhdGUpOwo+ID4gQEAgLTI4NTEsNyArMjg1
MSw3IEBAIGljbF9nZXRfZHBsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwK
PiA+ICAgCXJldHVybiBwbGw7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBtZ19wbGxfZ2V0X2h3
X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgYm9v
bCBtZ19wbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4g
ICAJCQkJc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwsCj4gPiAgIAkJCQlzdHJ1Y3QgaW50
ZWxfZHBsbF9od19zdGF0ZSAqaHdfc3RhdGUpCj4gPiAgIHsKPiA+IEBAIC0yODYxLDcgKzI4NjEs
NyBAQCBzdGF0aWMgYm9vbCBtZ19wbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICAgCWJvb2wgcmV0ID0gZmFsc2U7Cj4gPiAgIAl1MzIgdmFsOwo+
ID4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJp
diwKPiA+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoaTkx
NSwKPiA+ICAgCQkJCQkJICAgICBQT1dFUl9ET01BSU5fRElTUExBWV9DT1JFKTsKPiA+ICAgCWlm
ICghd2FrZXJlZikKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiBAQCAtMjg5Niw3ICsyODk2LDcg
QEAgc3RhdGljIGJvb2wgbWdfcGxsX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiAgIAlod19zdGF0ZS0+bWdfcGxsX3RkY19jb2xkc3RfYmlhcyA9Cj4g
PiAgIAkJSTkxNV9SRUFEKE1HX1BMTF9URENfQ09MRFNUX0JJQVModGNfcG9ydCkpOwo+ID4gLQlp
ZiAoZGV2X3ByaXYtPmNkY2xrLmh3LnJlZiA9PSAzODQwMCkgewo+ID4gKwlpZiAoaTkxNS0+Y2Rj
bGsuaHcucmVmID09IDM4NDAwKSB7Cj4gPiAgIAkJaHdfc3RhdGUtPm1nX3BsbF90ZGNfY29sZHN0
X2JpYXNfbWFzayA9IE1HX1BMTF9URENfQ09MRFNUX0NPTERTVEFSVDsKPiA+ICAgCQlod19zdGF0
ZS0+bWdfcGxsX2JpYXNfbWFzayA9IDA7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gQEAgLTI5MDksMTEg
KzI5MDksMTEgQEAgc3RhdGljIGJvb2wgbWdfcGxsX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXQgPSB0cnVlOwo+ID4gICBvdXQ6Cj4gPiAt
CWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQT1dFUl9ET01BSU5fRElTUExBWV9D
T1JFLCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJf
RE9NQUlOX0RJU1BMQVlfQ09SRSwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9
Cj4gPiAtc3RhdGljIGJvb2wgaWNsX3BsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIGljbF9wbGxfZ2V0X2h3X3N0YXRlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJIHN0cnVjdCBpbnRlbF9zaGFy
ZWRfZHBsbCAqcGxsLAo+ID4gICAJCQkJIHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19z
dGF0ZSwKPiA+ICAgCQkJCSBpOTE1X3JlZ190IGVuYWJsZV9yZWcpCj4gPiBAQCAtMjkyMyw3ICsy
OTIzLDcgQEAgc3RhdGljIGJvb2wgaWNsX3BsbF9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJYm9vbCByZXQgPSBmYWxzZTsKPiA+ICAgCXUzMiB2
YWw7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRl
dl9wcml2LAo+ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxl
ZChpOTE1LAo+ID4gICAJCQkJCQkgICAgIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUpOwo+ID4g
ICAJaWYgKCF3YWtlcmVmKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IEBAIC0yOTM3LDI2ICsy
OTM3LDI2IEBAIHN0YXRpYyBib29sIGljbF9wbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXJldCA9IHRydWU7Cj4gPiAgIG91dDoKPiA+IC0J
aW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NP
UkUsIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9E
T01BSU5fRElTUExBWV9DT1JFLCB3YWtlcmVmKTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgYm9vbCBjb21ib19wbGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgYm9vbCBjb21ib19wbGxfZ2V0X2h3X3N0YXRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgc3RydWN0IGludGVs
X3NoYXJlZF9kcGxsICpwbGwsCj4gPiAgIAkJCQkgICBzdHJ1Y3QgaW50ZWxfZHBsbF9od19zdGF0
ZSAqaHdfc3RhdGUpCj4gPiAgIHsKPiA+IC0JcmV0dXJuIGljbF9wbGxfZ2V0X2h3X3N0YXRlKGRl
dl9wcml2LCBwbGwsIGh3X3N0YXRlLAo+ID4gKwlyZXR1cm4gaWNsX3BsbF9nZXRfaHdfc3RhdGUo
aTkxNSwgcGxsLCBod19zdGF0ZSwKPiA+ICAgCQkJCSAgICBDTkxfRFBMTF9FTkFCTEUocGxsLT5p
bmZvLT5pZCkpOwo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wgdGJ0X3BsbF9nZXRfaHdfc3RhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIHRidF9w
bGxfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJ
IHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsLAo+ID4gICAJCQkJIHN0cnVjdCBpbnRlbF9k
cGxsX2h3X3N0YXRlICpod19zdGF0ZSkKPiA+ICAgewo+ID4gLQlyZXR1cm4gaWNsX3BsbF9nZXRf
aHdfc3RhdGUoZGV2X3ByaXYsIHBsbCwgaHdfc3RhdGUsIFRCVF9QTExfRU5BQkxFKTsKPiA+ICsJ
cmV0dXJuIGljbF9wbGxfZ2V0X2h3X3N0YXRlKGk5MTUsIHBsbCwgaHdfc3RhdGUsIFRCVF9QTExf
RU5BQkxFKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGljbF9kcGxsX3dyaXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBpY2xfZHBsbF93cml0
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgc3RydWN0IGludGVs
X3NoYXJlZF9kcGxsICpwbGwpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0
YXRlICpod19zdGF0ZSA9ICZwbGwtPnN0YXRlLmh3X3N0YXRlOwo+ID4gQEAgLTI5NjcsNyArMjk2
Nyw3IEBAIHN0YXRpYyB2b2lkIGljbF9kcGxsX3dyaXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICAgCVBPU1RJTkdfUkVBRChJQ0xfRFBMTF9DRkdDUjEoaWQpKTsKPiA+
ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGljbF9tZ19wbGxfd3JpdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGljbF9tZ19wbGxfd3JpdGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgc3RydWN0IGludGVsX3NoYXJl
ZF9kcGxsICpwbGwpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpo
d19zdGF0ZSA9ICZwbGwtPnN0YXRlLmh3X3N0YXRlOwo+ID4gQEAgLTMwMTcsNyArMzAxNyw3IEBA
IHN0YXRpYyB2b2lkIGljbF9tZ19wbGxfd3JpdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAJUE9TVElOR19SRUFEKE1HX1BMTF9URENfQ09MRFNUX0JJQVModGNfcG9y
dCkpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaWNsX3BsbF9wb3dlcl9lbmFibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGljbF9wbGxfcG93
ZXJfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJIHN0cnVj
dCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsLAo+ID4gICAJCQkJIGk5MTVfcmVnX3QgZW5hYmxlX3Jl
ZykKPiA+ICAgewo+ID4gQEAgLTMwMzEsMTIgKzMwMzEsMTIgQEAgc3RhdGljIHZvaWQgaWNsX3Bs
bF9wb3dlcl9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
ICogVGhlIHNwZWMgc2F5cyB3ZSBuZWVkIHRvICJ3YWl0IiBidXQgaXQgYWxzbyBzYXlzIGl0IHNo
b3VsZCBiZQo+ID4gICAJICogaW1tZWRpYXRlLgo+ID4gICAJICovCj4gPiAtCWlmIChpbnRlbF93
YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwgZW5hYmxlX3JlZywKPiA+ICsJaWYg
KGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsIGVuYWJsZV9yZWcsCj4gPiAg
IAkJCQkgICAgUExMX1BPV0VSX1NUQVRFLCBQTExfUE9XRVJfU1RBVEUsIDEpKQo+ID4gICAJCURS
TV9FUlJPUigiUExMICVkIFBvd2VyIG5vdCBlbmFibGVkXG4iLCBwbGwtPmluZm8tPmlkKTsKPiA+
ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGljbF9wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBpY2xfcGxsX2VuYWJsZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxs
ICpwbGwsCj4gPiAgIAkJCSAgIGk5MTVfcmVnX3QgZW5hYmxlX3JlZykKPiA+ICAgewo+ID4gQEAg
LTMwNDcsMTkgKzMwNDcsMTkgQEAgc3RhdGljIHZvaWQgaWNsX3BsbF9lbmFibGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJSTkxNV9XUklURShlbmFibGVfcmVnLCB2
YWwpOwo+ID4gICAJLyogVGltZW91dCBpcyBhY3R1YWxseSA2MDB1cy4gKi8KPiA+IC0JaWYgKGlu
dGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLCBlbmFibGVfcmVnLAo+ID4g
KwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwgZW5hYmxlX3JlZywK
PiA+ICAgCQkJCSAgICBQTExfTE9DSywgUExMX0xPQ0ssIDEpKQo+ID4gICAJCURSTV9FUlJPUigi
UExMICVkIG5vdCBsb2NrZWRcbiIsIHBsbC0+aW5mby0+aWQpOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IHZvaWQgY29tYm9fcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiArc3RhdGljIHZvaWQgY29tYm9fcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKPiA+ICAgCQkJICAgICBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKnBsbCkKPiA+
ICAgewo+ID4gICAJaTkxNV9yZWdfdCBlbmFibGVfcmVnID0gQ05MX0RQTExfRU5BQkxFKHBsbC0+
aW5mby0+aWQpOwo+ID4gLQlpY2xfcGxsX3Bvd2VyX2VuYWJsZShkZXZfcHJpdiwgcGxsLCBlbmFi
bGVfcmVnKTsKPiA+ICsJaWNsX3BsbF9wb3dlcl9lbmFibGUoaTkxNSwgcGxsLCBlbmFibGVfcmVn
KTsKPiA+IC0JaWNsX2RwbGxfd3JpdGUoZGV2X3ByaXYsIHBsbCk7Cj4gPiArCWljbF9kcGxsX3dy
aXRlKGk5MTUsIHBsbCk7Cj4gPiAgIAkvKgo+ID4gICAJICogRFZGUyBwcmUgc2VxdWVuY2Ugd291
bGQgYmUgaGVyZSwgYnV0IGluIG91ciBkcml2ZXIgdGhlIGNkY2xrIGNvZGUKPiA+IEBAIC0zMDY3
LDE3ICszMDY3LDE3IEBAIHN0YXRpYyB2b2lkIGNvbWJvX3BsbF9lbmFibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJICogbm90aGluZyBoZXJlLgo+ID4gICAJICov
Cj4gPiAtCWljbF9wbGxfZW5hYmxlKGRldl9wcml2LCBwbGwsIGVuYWJsZV9yZWcpOwo+ID4gKwlp
Y2xfcGxsX2VuYWJsZShpOTE1LCBwbGwsIGVuYWJsZV9yZWcpOwo+ID4gICAJLyogRFZGUyBwb3N0
IHNlcXVlbmNlIHdvdWxkIGJlIGhlcmUuIFNlZSB0aGUgY29tbWVudCBhYm92ZS4gKi8KPiA+ICAg
fQo+ID4gLXN0YXRpYyB2b2lkIHRidF9wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCB0YnRfcGxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpw
bGwpCj4gPiAgIHsKPiA+IC0JaWNsX3BsbF9wb3dlcl9lbmFibGUoZGV2X3ByaXYsIHBsbCwgVEJU
X1BMTF9FTkFCTEUpOwo+ID4gKwlpY2xfcGxsX3Bvd2VyX2VuYWJsZShpOTE1LCBwbGwsIFRCVF9Q
TExfRU5BQkxFKTsKPiA+IC0JaWNsX2RwbGxfd3JpdGUoZGV2X3ByaXYsIHBsbCk7Cj4gPiArCWlj
bF9kcGxsX3dyaXRlKGk5MTUsIHBsbCk7Cj4gPiAgIAkvKgo+ID4gICAJICogRFZGUyBwcmUgc2Vx
dWVuY2Ugd291bGQgYmUgaGVyZSwgYnV0IGluIG91ciBkcml2ZXIgdGhlIGNkY2xrIGNvZGUKPiA+
IEBAIC0zMDg1LDIwICszMDg1LDIwIEBAIHN0YXRpYyB2b2lkIHRidF9wbGxfZW5hYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCSAqIG5vdGhpbmcgaGVyZS4KPiA+
ICAgCSAqLwo+ID4gLQlpY2xfcGxsX2VuYWJsZShkZXZfcHJpdiwgcGxsLCBUQlRfUExMX0VOQUJM
RSk7Cj4gPiArCWljbF9wbGxfZW5hYmxlKGk5MTUsIHBsbCwgVEJUX1BMTF9FTkFCTEUpOwo+ID4g
ICAJLyogRFZGUyBwb3N0IHNlcXVlbmNlIHdvdWxkIGJlIGhlcmUuIFNlZSB0aGUgY29tbWVudCBh
Ym92ZS4gKi8KPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIG1nX3BsbF9lbmFibGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIG1nX3BsbF9lbmFibGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgc3RydWN0IGludGVsX3No
YXJlZF9kcGxsICpwbGwpCj4gPiAgIHsKPiA+ICAgCWk5MTVfcmVnX3QgZW5hYmxlX3JlZyA9Cj4g
PiAgIAkJTUdfUExMX0VOQUJMRShpY2xfcGxsX2lkX3RvX3RjX3BvcnQocGxsLT5pbmZvLT5pZCkp
Owo+ID4gLQlpY2xfcGxsX3Bvd2VyX2VuYWJsZShkZXZfcHJpdiwgcGxsLCBlbmFibGVfcmVnKTsK
PiA+ICsJaWNsX3BsbF9wb3dlcl9lbmFibGUoaTkxNSwgcGxsLCBlbmFibGVfcmVnKTsKPiA+IC0J
aWNsX21nX3BsbF93cml0ZShkZXZfcHJpdiwgcGxsKTsKPiA+ICsJaWNsX21nX3BsbF93cml0ZShp
OTE1LCBwbGwpOwo+ID4gICAJLyoKPiA+ICAgCSAqIERWRlMgcHJlIHNlcXVlbmNlIHdvdWxkIGJl
IGhlcmUsIGJ1dCBpbiBvdXIgZHJpdmVyIHRoZSBjZGNsayBjb2RlCj4gPiBAQCAtMzEwNiwxMiAr
MzEwNiwxMiBAQCBzdGF0aWMgdm9pZCBtZ19wbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICAgCSAqIG5vdGhpbmcgaGVyZS4KPiA+ICAgCSAqLwo+ID4gLQlp
Y2xfcGxsX2VuYWJsZShkZXZfcHJpdiwgcGxsLCBlbmFibGVfcmVnKTsKPiA+ICsJaWNsX3BsbF9l
bmFibGUoaTkxNSwgcGxsLCBlbmFibGVfcmVnKTsKPiA+ICAgCS8qIERWRlMgcG9zdCBzZXF1ZW5j
ZSB3b3VsZCBiZSBoZXJlLiBTZWUgdGhlIGNvbW1lbnQgYWJvdmUuICovCj4gPiAgIH0KPiA+IC1z
dGF0aWMgdm9pZCBpY2xfcGxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK3N0YXRpYyB2b2lkIGljbF9wbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsLAo+
ID4gICAJCQkgICAgaTkxNV9yZWdfdCBlbmFibGVfcmVnKQo+ID4gICB7Cj4gPiBAQCAtMzEzMCw3
ICszMTMwLDcgQEAgc3RhdGljIHZvaWQgaWNsX3BsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCUk5MTVfV1JJVEUoZW5hYmxlX3JlZywgdmFsKTsKPiA+
ICAgCS8qIFRpbWVvdXQgaXMgYWN0dWFsbHkgMXVzLiAqLwo+ID4gLQlpZiAoaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCWlmIChpbnRlbF93YWl0X2Zvcl9y
ZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJICAgIGVuYWJsZV9yZWcsIFBMTF9MT0NL
LCAwLCAxKSkKPiA+ICAgCQlEUk1fRVJST1IoIlBMTCAlZCBsb2NrZWRcbiIsIHBsbC0+aW5mby0+
aWQpOwo+ID4gQEAgLTMxNDQsMzMgKzMxNDQsMzMgQEAgc3RhdGljIHZvaWQgaWNsX3BsbF9kaXNh
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCSAqIFRoZSBzcGVj
IHNheXMgd2UgbmVlZCB0byAid2FpdCIgYnV0IGl0IGFsc28gc2F5cyBpdCBzaG91bGQgYmUKPiA+
ICAgCSAqIGltbWVkaWF0ZS4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVn
aXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rl
cigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJICAgIGVuYWJsZV9yZWcsIFBMTF9QT1dFUl9TVEFU
RSwgMCwgMSkpCj4gPiAgIAkJRFJNX0VSUk9SKCJQTEwgJWQgUG93ZXIgbm90IGRpc2FibGVkXG4i
LCBwbGwtPmluZm8tPmlkKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGNvbWJvX3BsbF9kaXNh
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBj
b21ib19wbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJ
ICAgICAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwpCj4gPiAgIHsKPiA+IC0JaWNsX3Bs
bF9kaXNhYmxlKGRldl9wcml2LCBwbGwsIENOTF9EUExMX0VOQUJMRShwbGwtPmluZm8tPmlkKSk7
Cj4gPiArCWljbF9wbGxfZGlzYWJsZShpOTE1LCBwbGwsIENOTF9EUExMX0VOQUJMRShwbGwtPmlu
Zm8tPmlkKSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCB0YnRfcGxsX2Rpc2FibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIHRidF9wbGxfZGlz
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgIHN0cnVjdCBp
bnRlbF9zaGFyZWRfZHBsbCAqcGxsKQo+ID4gICB7Cj4gPiAtCWljbF9wbGxfZGlzYWJsZShkZXZf
cHJpdiwgcGxsLCBUQlRfUExMX0VOQUJMRSk7Cj4gPiArCWljbF9wbGxfZGlzYWJsZShpOTE1LCBw
bGwsIFRCVF9QTExfRU5BQkxFKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIG1nX3BsbF9kaXNh
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBt
Z19wbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAg
c3RydWN0IGludGVsX3NoYXJlZF9kcGxsICpwbGwpCj4gPiAgIHsKPiA+ICAgCWk5MTVfcmVnX3Qg
ZW5hYmxlX3JlZyA9Cj4gPiAgIAkJTUdfUExMX0VOQUJMRShpY2xfcGxsX2lkX3RvX3RjX3BvcnQo
cGxsLT5pbmZvLT5pZCkpOwo+ID4gLQlpY2xfcGxsX2Rpc2FibGUoZGV2X3ByaXYsIHBsbCwgZW5h
YmxlX3JlZyk7Cj4gPiArCWljbF9wbGxfZGlzYWJsZShpOTE1LCBwbGwsIGVuYWJsZV9yZWcpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaWNsX2R1bXBfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGljbF9kdW1wX2h3X3N0YXRlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfZHBsbF9od19zdGF0ZSAqaHdfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCURSTV9ERUJVR19L
TVMoImRwbGxfaHdfc3RhdGU6IGNmZ2NyMDogMHgleCwgY2ZnY3IxOiAweCV4LCAiCj4gPiBAQCAt
MzI0NywyOCArMzI0NywyOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGludGVsX2RwbGxfbWdyIGVo
bF9wbGxfbWdyID0gewo+ID4gICAgKi8KPiA+ICAgdm9pZCBpbnRlbF9zaGFyZWRfZHBsbF9pbml0
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9kcGxs
X21nciAqZHBsbF9tZ3IgPSBOVUxMOwo+ID4gICAJY29uc3Qgc3RydWN0IGRwbGxfaW5mbyAqZHBs
bF9pbmZvOwo+ID4gICAJaW50IGk7Cj4gPiAtCWlmIChJU19FTEtIQVJUTEFLRShkZXZfcHJpdikp
Cj4gPiArCWlmIChJU19FTEtIQVJUTEFLRShpOTE1KSkKPiA+ICAgCQlkcGxsX21nciA9ICZlaGxf
cGxsX21ncjsKPiA+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiA+ICsJ
ZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ID4gICAJCWRwbGxfbWdyID0gJmljbF9w
bGxfbWdyOwo+ID4gLQllbHNlIGlmIChJU19DQU5OT05MQUtFKGRldl9wcml2KSkKPiA+ICsJZWxz
ZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkKPiA+ICAgCQlkcGxsX21nciA9ICZjbmxfcGxsX21n
cjsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElT
X0dFTjlfQkMoaTkxNSkpCj4gPiAgIAkJZHBsbF9tZ3IgPSAmc2tsX3BsbF9tZ3I7Cj4gPiAtCWVs
c2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19HRU45X0xQKGk5
MTUpKQo+ID4gICAJCWRwbGxfbWdyID0gJmJ4dF9wbGxfbWdyOwo+ID4gLQllbHNlIGlmIChIQVNf
RERJKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSEFTX0RESShpOTE1KSkKPiA+ICAgCQlkcGxs
X21nciA9ICZoc3dfcGxsX21ncjsKPiA+IC0JZWxzZSBpZiAoSEFTX1BDSF9JQlgoZGV2X3ByaXYp
IHx8IEhBU19QQ0hfQ1BUKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSEFTX1BDSF9JQlgoaTkx
NSkgfHwgSEFTX1BDSF9DUFQoaTkxNSkpCj4gPiAgIAkJZHBsbF9tZ3IgPSAmcGNoX3BsbF9tZ3I7
Cj4gPiAgIAlpZiAoIWRwbGxfbWdyKSB7Cj4gPiAtCQlkZXZfcHJpdi0+bnVtX3NoYXJlZF9kcGxs
ID0gMDsKPiA+ICsJCWk5MTUtPm51bV9zaGFyZWRfZHBsbCA9IDA7Cj4gPiAgIAkJcmV0dXJuOwo+
ID4gICAJfQo+ID4gQEAgLTMyNzYsMTQgKzMyNzYsMTQgQEAgdm9pZCBpbnRlbF9zaGFyZWRfZHBs
bF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAgIAlmb3IgKGkgPSAwOyBkcGxsX2lu
Zm9baV0ubmFtZTsgaSsrKSB7Cj4gPiAgIAkJV0FSTl9PTihpICE9IGRwbGxfaW5mb1tpXS5pZCk7
Cj4gPiAtCQlkZXZfcHJpdi0+c2hhcmVkX2RwbGxzW2ldLmluZm8gPSAmZHBsbF9pbmZvW2ldOwo+
ID4gKwkJaTkxNS0+c2hhcmVkX2RwbGxzW2ldLmluZm8gPSAmZHBsbF9pbmZvW2ldOwo+ID4gICAJ
fQo+ID4gLQlkZXZfcHJpdi0+ZHBsbF9tZ3IgPSBkcGxsX21ncjsKPiA+IC0JZGV2X3ByaXYtPm51
bV9zaGFyZWRfZHBsbCA9IGk7Cj4gPiAtCW11dGV4X2luaXQoJmRldl9wcml2LT5kcGxsX2xvY2sp
Owo+ID4gKwlpOTE1LT5kcGxsX21nciA9IGRwbGxfbWdyOwo+ID4gKwlpOTE1LT5udW1fc2hhcmVk
X2RwbGwgPSBpOwo+ID4gKwltdXRleF9pbml0KCZpOTE1LT5kcGxsX2xvY2spOwo+ID4gLQlCVUdf
T04oZGV2X3ByaXYtPm51bV9zaGFyZWRfZHBsbCA+IEk5MTVfTlVNX1BMTFMpOwo+ID4gKwlCVUdf
T04oaTkxNS0+bnVtX3NoYXJlZF9kcGxsID4gSTkxNV9OVU1fUExMUyk7Cj4gPiAgIH0KPiA+ICAg
LyoqCj4gPiBAQCAtMzMwNCw4ICszMzA0LDggQEAgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICoK
PiA+ICAgaW50ZWxfZ2V0X3NoYXJlZF9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAo+ID4gICAJCSAgICAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gLQljb25zdCBzdHJ1Y3QgaW50ZWxfZHBsbF9t
Z3IgKmRwbGxfbWdyID0gZGV2X3ByaXYtPmRwbGxfbWdyOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4g
Kwljb25zdCBzdHJ1Y3QgaW50ZWxfZHBsbF9tZ3IgKmRwbGxfbWdyID0gaTkxNS0+ZHBsbF9tZ3I7
Cj4gPiAgIAlpZiAoV0FSTl9PTighZHBsbF9tZ3IpKQo+ID4gICAJCXJldHVybiBOVUxMOwo+ID4g
QEAgLTMzMzUsMTYgKzMzMzUsMTYgQEAgdm9pZCBpbnRlbF9yZWxlYXNlX3NoYXJlZF9kcGxsKHN0
cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqZHBsbCwKPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX3No
YXJlZF9kcGxsX2R1bXBfaHdfc3RhdGUgLSB3cml0ZSBod19zdGF0ZSB0byBkbWVzZwo+ID4gLSAq
IEBkZXZfcHJpdjogaTkxNSBkcm0gZGV2aWNlCj4gPiArICogQGk5MTU6IGk5MTUgZHJtIGRldmlj
ZQo+ID4gICAgKiBAaHdfc3RhdGU6IGh3IHN0YXRlIHRvIGJlIHdyaXR0ZW4gdG8gdGhlIGxvZwo+
ID4gICAgKgo+ID4gICAgKiBXcml0ZSB0aGUgcmVsZXZhbnQgdmFsdWVzIGluIEBod19zdGF0ZSB0
byBkbWVzZyB1c2luZyBEUk1fREVCVUdfS01TLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2Rw
bGxfZHVtcF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAr
dm9pZCBpbnRlbF9kcGxsX2R1bXBfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9kcGxsX2h3X3N0YXRlICpod19z
dGF0ZSkKPiA+ICAgewo+ID4gLQlpZiAoZGV2X3ByaXYtPmRwbGxfbWdyKSB7Cj4gPiAtCQlkZXZf
cHJpdi0+ZHBsbF9tZ3ItPmR1bXBfaHdfc3RhdGUoZGV2X3ByaXYsIGh3X3N0YXRlKTsKPiA+ICsJ
aWYgKGk5MTUtPmRwbGxfbWdyKSB7Cj4gPiArCQlpOTE1LT5kcGxsX21nci0+ZHVtcF9od19zdGF0
ZShpOTE1LCBod19zdGF0ZSk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCS8qIGZhbGxiYWNrIGZv
ciBwbGF0Zm9ybXMgdGhhdCBkb24ndCB1c2UgdGhlIHNoYXJlZCBkcGxsCj4gPiAgIAkJICogaW5m
cmFzdHJ1Y3R1cmUKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9k
cGxsX21nci5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHBsbF9tZ3IuaAo+ID4gaW5k
ZXggZDA1NzA0MTRmM2QxLi5iMDY4Yzg0NDEzMjggMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9kcGxsX21nci5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9kcGxsX21nci5oCj4gPiBAQCAtMjIxLDcgKzIyMSw3IEBAIHN0cnVjdCBpbnRlbF9z
aGFyZWRfZHBsbF9mdW5jcyB7Cj4gPiAgIAkgKiBDYWxsZWQgZnJvbSBpbnRlbF9wcmVwYXJlX3No
YXJlZF9kcGxsKCkgZnVuY3Rpb24gdW5sZXNzIHRoZSBQTEwKPiA+ICAgCSAqIGlzIGFscmVhZHkg
ZW5hYmxlZC4KPiA+ICAgCSAqLwo+ID4gLQl2b2lkICgqcHJlcGFyZSkoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gKwl2b2lkICgqcHJlcGFyZSkoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCXN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCAqcGxsKTsK
PiA+ICAgCS8qKgo+ID4gQEAgLTIzMCw3ICsyMzAsNyBAQCBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2Rw
bGxfZnVuY3Mgewo+ID4gICAJICogSG9vayBmb3IgZW5hYmxpbmcgdGhlIHBsbCwgY2FsbGVkIGZy
b20gaW50ZWxfZW5hYmxlX3NoYXJlZF9kcGxsKCkKPiA+ICAgCSAqIGlmIHRoZSBwbGwgaXMgbm90
IGFscmVhZHkgZW5hYmxlZC4KPiA+ICAgCSAqLwo+ID4gLQl2b2lkICgqZW5hYmxlKShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArCXZvaWQgKCplbmFibGUpKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCSAgICAgICBzdHJ1Y3QgaW50ZWxfc2hhcmVk
X2RwbGwgKnBsbCk7Cj4gPiAgIAkvKioKPiA+IEBAIC0yNDAsNyArMjQwLDcgQEAgc3RydWN0IGlu
dGVsX3NoYXJlZF9kcGxsX2Z1bmNzIHsKPiA+ICAgCSAqIG9ubHkgd2hlbiBpdCBpcyBzYWZlIHRv
IGRpc2FibGUgdGhlIHBsbCwgaS5lLiwgdGhlcmUgYXJlIG5vIG1vcmUKPiA+ICAgCSAqIHRyYWNr
ZWQgdXNlcnMgZm9yIGl0Lgo+ID4gICAJICovCj4gPiAtCXZvaWQgKCpkaXNhYmxlKShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArCXZvaWQgKCpkaXNhYmxlKShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJc3RydWN0IGludGVsX3NoYXJlZF9kcGxs
ICpwbGwpOwo+ID4gICAJLyoqCj4gPiBAQCAtMjUwLDcgKzI1MCw3IEBAIHN0cnVjdCBpbnRlbF9z
aGFyZWRfZHBsbF9mdW5jcyB7Cj4gPiAgIAkgKiByZWdpc3RlcnMuIFRoaXMgaXMgdXNlZCBmb3Ig
aW5pdGlhbCBodyBzdGF0ZSByZWFkb3V0IGFuZCBzdGF0ZQo+ID4gICAJICogdmVyaWZpY2F0aW9u
IGFmdGVyIGEgbW9kZSBzZXQuCj4gPiAgIAkgKi8KPiA+IC0JYm9vbCAoKmdldF9od19zdGF0ZSko
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gKwlib29sICgqZ2V0X2h3X3N0
YXRlKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICBzdHJ1Y3Qg
aW50ZWxfc2hhcmVkX2RwbGwgKnBsbCwKPiA+ICAgCQkJICAgICBzdHJ1Y3QgaW50ZWxfZHBsbF9o
d19zdGF0ZSAqaHdfc3RhdGUpOwo+ID4gICB9Owo+ID4gQEAgLTI3MSw3ICsyNzEsNyBAQCBzdHJ1
Y3QgZHBsbF9pbmZvIHsKPiA+ICAgCS8qKgo+ID4gICAJICogQGlkOiB1bmlxdWUgaW5kZW50aWZp
ZXIgZm9yIHRoaXMgRFBMTDsgc2hvdWxkIG1hdGNoIHRoZSBpbmRleCBpbiB0aGUKPiA+IC0JICog
ZGV2X3ByaXYtPnNoYXJlZF9kcGxscyBhcnJheQo+ID4gKwkgKiBpOTE1LT5zaGFyZWRfZHBsbHMg
YXJyYXkKPiA+ICAgCSAqLwo+ID4gICAJZW51bSBpbnRlbF9kcGxsX2lkIGlkOwo+ID4gQEAgLTMy
MSwxMiArMzIxLDEyIEBAIHN0cnVjdCBpbnRlbF9zaGFyZWRfZHBsbCB7Cj4gPiAgIC8qIHNoYXJl
ZCBkcGxsIGZ1bmN0aW9ucyAqLwo+ID4gICBzdHJ1Y3QgaW50ZWxfc2hhcmVkX2RwbGwgKgo+ID4g
LWludGVsX2dldF9zaGFyZWRfZHBsbF9ieV9pZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAraW50ZWxfZ2V0X3NoYXJlZF9kcGxsX2J5X2lkKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgZW51bSBpbnRlbF9kcGxsX2lkIGlkKTsKPiA+ICAg
ZW51bSBpbnRlbF9kcGxsX2lkCj4gPiAtaW50ZWxfZ2V0X3NoYXJlZF9kcGxsX2lkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpbnRlbF9nZXRfc2hhcmVkX2RwbGxfaWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSBzdHJ1Y3QgaW50ZWxfc2hh
cmVkX2RwbGwgKnBsbCk7Cj4gPiAtdm9pZCBhc3NlcnRfc2hhcmVkX2RwbGwoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgYXNzZXJ0X3NoYXJlZF9kcGxsKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQlzdHJ1Y3QgaW50ZWxfc2hhcmVkX2Rw
bGwgKnBsbCwKPiA+ICAgCQkJYm9vbCBzdGF0ZSk7Cj4gPiAgICNkZWZpbmUgYXNzZXJ0X3NoYXJl
ZF9kcGxsX2VuYWJsZWQoZCwgcCkgYXNzZXJ0X3NoYXJlZF9kcGxsKGQsIHAsIHRydWUpCj4gPiBA
QCAtMzQyLDkgKzM0Miw5IEBAIHZvaWQgaW50ZWxfZGlzYWJsZV9zaGFyZWRfZHBsbChjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gPiAgIHZvaWQgaW50ZWxfc2hh
cmVkX2RwbGxfc3dhcF9zdGF0ZShzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpOwo+ID4g
ICB2b2lkIGludGVsX3NoYXJlZF9kcGxsX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldik7Cj4g
PiAtdm9pZCBpbnRlbF9kcGxsX2R1bXBfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gK3ZvaWQgaW50ZWxfZHBsbF9kdW1wX2h3X3N0YXRlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZHBs
bF9od19zdGF0ZSAqaHdfc3RhdGUpOwo+ID4gLWludCBjbmxfaGRtaV9wbGxfcmVmX2Nsb2NrKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAraW50IGNubF9oZG1pX3BsbF9y
ZWZfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICBlbnVtIGludGVs
X2RwbGxfaWQgaWNsX3RjX3BvcnRfdG9fcGxsX2lkKGVudW0gdGNfcG9ydCB0Y19wb3J0KTsKPiA+
ICAgYm9vbCBpbnRlbF9kcGxsX2lzX2NvbWJvcGh5KGVudW0gaW50ZWxfZHBsbF9pZCBpZCk7Cj4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9kcnYuaAo+ID4gaW5kZXggM2UzMzczMTdmNzdlLi4yMzA2NWRk
YTgyZDkgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kcnYuaAo+
ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmgKPiA+IEBAIC05NjMsNyAr
OTYzLDcgQEAgc3RydWN0IGludGVsX2NydGMgewo+ID4gICAJc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNvbmZpZzsKPiA+IC0JLyogQWNjZXNzIHRvIHRoZXNlIHNob3VsZCBiZSBwcm90ZWN0ZWQg
YnkgZGV2X3ByaXYtPmlycV9sb2NrLiAqLwo+ID4gKwkvKiBBY2Nlc3MgdG8gdGhlc2Ugc2hvdWxk
IGJlIHByb3RlY3RlZCBieSBpOTE1LT5pcnFfbG9jay4gKi8KPiA+ICAgCWJvb2wgY3B1X2ZpZm9f
dW5kZXJydW5fZGlzYWJsZWQ7Cj4gPiAgIAlib29sIHBjaF9maWZvX3VuZGVycnVuX2Rpc2FibGVk
Owo+ID4gQEAgLTEyOTMsMTUgKzEyOTMsMTUgQEAgdmx2X3BpcGVfdG9fY2hhbm5lbChlbnVtIHBp
cGUgcGlwZSkKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW5saW5lIHN0cnVjdCBpbnRlbF9jcnRjICoK
PiA+IC1pbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIGVudW0gcGlwZSBwaXBlKQo+ID4gK2ludGVsX2dldF9jcnRjX2Zvcl9waXBlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gLQly
ZXR1cm4gZGV2X3ByaXYtPnBpcGVfdG9fY3J0Y19tYXBwaW5nW3BpcGVdOwo+ID4gKwlyZXR1cm4g
aTkxNS0+cGlwZV90b19jcnRjX21hcHBpbmdbcGlwZV07Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGlu
bGluZSBzdHJ1Y3QgaW50ZWxfY3J0YyAqCj4gPiAtaW50ZWxfZ2V0X2NydGNfZm9yX3BsYW5lKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBpOXh4X3BsYW5lX2lkIHBsYW5l
KQo+ID4gK2ludGVsX2dldF9jcnRjX2Zvcl9wbGFuZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwgZW51bSBpOXh4X3BsYW5lX2lkIHBsYW5lKQo+ID4gICB7Cj4gPiAtCXJldHVybiBkZXZf
cHJpdi0+cGxhbmVfdG9fY3J0Y19tYXBwaW5nW3BsYW5lXTsKPiA+ICsJcmV0dXJuIGk5MTUtPnBs
YW5lX3RvX2NydGNfbWFwcGluZ1twbGFuZV07Cj4gPiAgIH0KPiA+ICAgc3RydWN0IGludGVsX2xv
YWRfZGV0ZWN0X3BpcGUgewo+ID4gQEAgLTE0NDcsMTcgKzE0NDcsMTcgQEAgaW50ZWxfYXRvbWlj
X2dldF9uZXdfY3J0Y19zdGF0ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPiA+
ICAgLyogaW50ZWxfZGlzcGxheS5jICovCj4gPiAgIHZvaWQgaW50ZWxfcGxhbmVfZGVzdHJveShz
dHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSk7Cj4gPiAtdm9pZCBpODMwX2VuYWJsZV9waXBlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpOwo+ID4gLXZvaWQg
aTgzMF9kaXNhYmxlX3BpcGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVt
IHBpcGUgcGlwZSk7Cj4gPiArdm9pZCBpODMwX2VuYWJsZV9waXBlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSk7Cj4gPiArdm9pZCBpODMwX2Rpc2FibGVfcGlw
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwaXBlIHBpcGUpOwo+ID4gICBl
bnVtIHBpcGUgaW50ZWxfY3J0Y19wY2hfdHJhbnNjb2RlcihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
Yyk7Cj4gPiAtaW50IHZsdl9nZXRfaHBsbF92Y28oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKPiA+IC1pbnQgdmx2X2dldF9jY2tfY2xvY2soc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK2ludCB2bHZfZ2V0X2hwbGxfdmNvKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KTsKPiA+ICtpbnQgdmx2X2dldF9jY2tfY2xvY2soc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICAgY29uc3QgY2hhciAqbmFtZSwgdTMyIHJlZywg
aW50IHJlZl9mcmVxKTsKPiA+IC1pbnQgdmx2X2dldF9jY2tfY2xvY2tfaHBsbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAraW50IHZsdl9nZXRfY2NrX2Nsb2NrX2hwbGwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgIGNvbnN0IGNoYXIgKm5h
bWUsIHUzMiByZWcpOwo+ID4gLXZvaWQgbHB0X2Rpc2FibGVfcGNoX3RyYW5zY29kZXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGxwdF9kaXNhYmxlX2ljbGtp
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgaW50ZWxfaW5p
dF9kaXNwbGF5X2hvb2tzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAr
dm9pZCBscHRfZGlzYWJsZV9wY2hfdHJhbnNjb2RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7Cj4gPiArdm9pZCBscHRfZGlzYWJsZV9pY2xraXAoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfaW5pdF9kaXNwbGF5X2hvb2tzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgdW5zaWduZWQgaW50IGludGVsX2ZiX3h5X3RvX2xp
bmVhcihpbnQgeCwgaW50IHksCj4gPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVf
c3RhdGUgKnN0YXRlLAo+ID4gICAJCQkJICAgaW50IHBsYW5lKTsKPiA+IEBAIC0xNDY3LDE5ICsx
NDY3LDE5IEBAIHZvaWQgaW50ZWxfYWRkX2ZiX29mZnNldHMoaW50ICp4LCBpbnQgKnksCj4gPiAg
IAkJCSAgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpzdGF0ZSwgaW50IHBsYW5lKTsK
PiA+ICAgdW5zaWduZWQgaW50IGludGVsX3JvdGF0aW9uX2luZm9fc2l6ZShjb25zdCBzdHJ1Y3Qg
aW50ZWxfcm90YXRpb25faW5mbyAqcm90X2luZm8pOwo+ID4gICB1bnNpZ25lZCBpbnQgaW50ZWxf
cmVtYXBwZWRfaW5mb19zaXplKGNvbnN0IHN0cnVjdCBpbnRlbF9yZW1hcHBlZF9pbmZvICpyZW1f
aW5mbyk7Cj4gPiAtYm9vbCBpbnRlbF9oYXNfcGVuZGluZ19mYl91bnBpbihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK2Jvb2wgaW50ZWxfaGFzX3BlbmRpbmdfZmJfdW5w
aW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICBpbnQgaW50ZWxfZGlzcGxh
eV9zdXNwZW5kKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwo+ID4gLXZvaWQgaW50ZWxfcHBzX3Vu
bG9ja19yZWdzX3dhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9p
ZCBpbnRlbF9wcHNfdW5sb2NrX3JlZ3Nfd2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Owo+ID4gICB2b2lkIGludGVsX2VuY29kZXJfZGVzdHJveShzdHJ1Y3QgZHJtX2VuY29kZXIgKmVu
Y29kZXIpOwo+ID4gICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqCj4gPiAgIGludGVsX2VuY29k
ZXJfY3VycmVudF9tb2RlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKTsKPiA+IC1ib29s
IGludGVsX3BvcnRfaXNfY29tYm9waHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBlbnVtIHBvcnQgcG9ydCk7Cj4gPiAtYm9vbCBpbnRlbF9wb3J0X2lzX3RjKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpOwo+ID4gLWVudW0gdGNfcG9y
dCBpbnRlbF9wb3J0X3RvX3RjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICtib29sIGludGVsX3BvcnRfaXNfY29tYm9waHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsIGVudW0gcG9ydCBwb3J0KTsKPiA+ICtib29sIGludGVsX3BvcnRfaXNfdGMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcG9ydCBwb3J0KTsKPiA+ICtlbnVtIHRjX3BvcnQg
aW50ZWxfcG9ydF90b190YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJ
ICAgICAgZW51bSBwb3J0IHBvcnQpOwo+ID4gICBpbnQgaW50ZWxfZ2V0X3BpcGVfZnJvbV9jcnRj
X2lkX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAgIAkJCQkg
ICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdik7Cj4gPiAtZW51bSB0cmFuc2NvZGVyIGlu
dGVsX3BpcGVfdG9fY3B1X3RyYW5zY29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK2VudW0gdHJhbnNjb2RlciBpbnRlbF9waXBlX3RvX2NwdV90cmFuc2NvZGVyKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJCSAgICAgZW51bSBwaXBlIHBp
cGUpOwo+ID4gICBzdGF0aWMgaW5saW5lIGJvb2wKPiA+ICAgaW50ZWxfY3J0Y19oYXNfdHlwZShj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+IEBAIC0xNDk2LDIz
ICsxNDk2LDIzIEBAIGludGVsX2NydGNfaGFzX2RwX2VuY29kZXIoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIAkJICgxIDw8IElOVEVMX09VVFBVVF9FRFAp
KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW5saW5lIHZvaWQKPiA+IC1pbnRlbF93YWl0X2Zvcl92
Ymxhbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkK
PiA+ICtpbnRlbF93YWl0X2Zvcl92Ymxhbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IGVudW0gcGlwZSBwaXBlKQo+ID4gICB7Cj4gPiAtCWRybV93YWl0X29uZV92YmxhbmsoJmRldl9w
cml2LT5kcm0sIHBpcGUpOwo+ID4gKwlkcm1fd2FpdF9vbmVfdmJsYW5rKCZpOTE1LT5kcm0sIHBp
cGUpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbmxpbmUgdm9pZAo+ID4gLWludGVsX3dhaXRfZm9y
X3ZibGFua19pZl9hY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQg
cGlwZSkKPiA+ICtpbnRlbF93YWl0X2Zvcl92YmxhbmtfaWZfYWN0aXZlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LCBpbnQgcGlwZSkKPiA+ICAgewo+ID4gLQljb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKTsK
PiA+ICsJY29uc3Qgc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3Jf
cGlwZShpOTE1LCBwaXBlKTsKPiA+ICAgCWlmIChjcnRjLT5hY3RpdmUpCj4gPiAtCQlpbnRlbF93
YWl0X2Zvcl92YmxhbmsoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwkJaW50ZWxfd2FpdF9mb3JfdmJs
YW5rKGk5MTUsIHBpcGUpOwo+ID4gICB9Cj4gPiAgIHUzMiBpbnRlbF9jcnRjX2dldF92Ymxhbmtf
Y291bnRlcihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0Yyk7Cj4gPiAgIGludCBpcm9ubGFrZV9nZXRf
bGFuZXNfcmVxdWlyZWQoaW50IHRhcmdldF9jbG9jaywgaW50IGxpbmtfYncsIGludCBicHApOwo+
ID4gLXZvaWQgdmx2X3dhaXRfcG9ydF9yZWFkeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiArdm9pZCB2bHZfd2FpdF9wb3J0X3JlYWR5KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ID4gICAJCQkgc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZHBvcnQsCj4g
PiAgIAkJCSB1bnNpZ25lZCBpbnQgZXhwZWN0ZWRfbWFzayk7Cj4gPiAgIGludCBpbnRlbF9nZXRf
bG9hZF9kZXRlY3RfcGlwZShzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ID4gQEAg
LTE1MzYsMzQgKzE1MzYsMzQgQEAgaW50IGludGVsX3ByZXBhcmVfcGxhbmVfZmIoc3RydWN0IGRy
bV9wbGFuZSAqcGxhbmUsCj4gPiAgIHZvaWQgaW50ZWxfY2xlYW51cF9wbGFuZV9mYihzdHJ1Y3Qg
ZHJtX3BsYW5lICpwbGFuZSwKPiA+ICAgCQkJICAgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9s
ZF9zdGF0ZSk7Cj4gPiAtdm9pZCBhc3NlcnRfcGNoX3RyYW5zY29kZXJfZGlzYWJsZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgYXNzZXJ0X3BjaF90cmFuc2Nv
ZGVyX2Rpc2FibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAg
IGVudW0gcGlwZSBwaXBlKTsKPiA+IC1pbnQgdmx2X2ZvcmNlX3BsbF9vbihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBlLAo+ID4gK2ludCB2bHZfZm9yY2Vf
cGxsX29uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSwKPiA+
ICAgCQkgICAgIGNvbnN0IHN0cnVjdCBkcGxsICpkcGxsKTsKPiA+IC12b2lkIHZsdl9mb3JjZV9w
bGxfb2ZmKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUp
Owo+ID4gLWludCBscHRfZ2V0X2ljbGtpcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwo+ID4gK3ZvaWQgdmx2X2ZvcmNlX3BsbF9vZmYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsIGVudW0gcGlwZSBwaXBlKTsKPiA+ICtpbnQgbHB0X2dldF9pY2xraXAoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICBib29sIGludGVsX2Z1enp5X2Nsb2NrX2NoZWNr
KGludCBjbG9jazEsIGludCBjbG9jazIpOwo+ID4gICAvKiBtb2Rlc2V0dGluZyBhc3NlcnRzICov
Cj4gPiAtdm9pZCBhc3NlcnRfcGFuZWxfdW5sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gK3ZvaWQgYXNzZXJ0X3BhbmVsX3VubG9ja2VkKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICBlbnVtIHBpcGUgcGlwZSk7Cj4gPiAtdm9pZCBh
c3NlcnRfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGFz
c2VydF9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJZW51bSBwaXBl
IHBpcGUsIGJvb2wgc3RhdGUpOwo+ID4gICAjZGVmaW5lIGFzc2VydF9wbGxfZW5hYmxlZChkLCBw
KSBhc3NlcnRfcGxsKGQsIHAsIHRydWUpCj4gPiAgICNkZWZpbmUgYXNzZXJ0X3BsbF9kaXNhYmxl
ZChkLCBwKSBhc3NlcnRfcGxsKGQsIHAsIGZhbHNlKQo+ID4gLXZvaWQgYXNzZXJ0X2RzaV9wbGwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIHN0YXRlKTsKPiA+ICt2b2lk
IGFzc2VydF9kc2lfcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBib29sIHN0YXRl
KTsKPiA+ICAgI2RlZmluZSBhc3NlcnRfZHNpX3BsbF9lbmFibGVkKGQpIGFzc2VydF9kc2lfcGxs
KGQsIHRydWUpCj4gPiAgICNkZWZpbmUgYXNzZXJ0X2RzaV9wbGxfZGlzYWJsZWQoZCkgYXNzZXJ0
X2RzaV9wbGwoZCwgZmFsc2UpCj4gPiAtdm9pZCBhc3NlcnRfZmRpX3J4X3BsbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBhc3NlcnRfZmRpX3J4X3BsbChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkgICAgICAgZW51bSBwaXBlIHBpcGUs
IGJvb2wgc3RhdGUpOwo+ID4gICAjZGVmaW5lIGFzc2VydF9mZGlfcnhfcGxsX2VuYWJsZWQoZCwg
cCkgYXNzZXJ0X2ZkaV9yeF9wbGwoZCwgcCwgdHJ1ZSkKPiA+ICAgI2RlZmluZSBhc3NlcnRfZmRp
X3J4X3BsbF9kaXNhYmxlZChkLCBwKSBhc3NlcnRfZmRpX3J4X3BsbChkLCBwLCBmYWxzZSkKPiA+
IC12b2lkIGFzc2VydF9waXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51
bSBwaXBlIHBpcGUsIGJvb2wgc3RhdGUpOwo+ID4gK3ZvaWQgYXNzZXJ0X3BpcGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gcGlwZSBwaXBlLCBib29sIHN0YXRlKTsKPiA+ICAg
I2RlZmluZSBhc3NlcnRfcGlwZV9lbmFibGVkKGQsIHApIGFzc2VydF9waXBlKGQsIHAsIHRydWUp
Cj4gPiAgICNkZWZpbmUgYXNzZXJ0X3BpcGVfZGlzYWJsZWQoZCwgcCkgYXNzZXJ0X3BpcGUoZCwg
cCwgZmFsc2UpCj4gPiAtdm9pZCBpbnRlbF9wcmVwYXJlX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpbnRlbF9maW5pc2hfcmVzZXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICt2b2lkIGludGVsX3ByZXBhcmVfcmVzZXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfZmluaXNoX3Jl
c2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgdm9pZCBpbnRlbF9kcF9n
ZXRfbV9uKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCSAgICAgIHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZyk7Cj4gPiAgIHZvaWQgaW50ZWxfZHBfc2V0X21fbihj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2RzaS5jCj4gPiBpbmRleCA1ZmVjMDJhY2VhZWQuLjA5NDE0ZGEzZDgxOCAxMDA2NDQK
PiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RzaS5jCj4gPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2kuYwo+ID4gQEAgLTExMywxNCArMTEzLDE0IEBAIHN0
cnVjdCBpbnRlbF9kc2lfaG9zdCAqaW50ZWxfZHNpX2hvc3RfaW5pdChzdHJ1Y3QgaW50ZWxfZHNp
ICppbnRlbF9kc2ksCj4gPiAgIGVudW0gZHJtX3BhbmVsX29yaWVudGF0aW9uCj4gPiAgIGludGVs
X2RzaV9nZXRfcGFuZWxfb3JpZW50YXRpb24oc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gZHJtX3Bh
bmVsX29yaWVudGF0aW9uIG9yaWVudGF0aW9uOwo+ID4gLQlvcmllbnRhdGlvbiA9IGRldl9wcml2
LT52YnQuZHNpLm9yaWVudGF0aW9uOwo+ID4gKwlvcmllbnRhdGlvbiA9IGk5MTUtPnZidC5kc2ku
b3JpZW50YXRpb247Cj4gPiAgIAlpZiAob3JpZW50YXRpb24gIT0gRFJNX01PREVfUEFORUxfT1JJ
RU5UQVRJT05fVU5LTk9XTikKPiA+ICAgCQlyZXR1cm4gb3JpZW50YXRpb247Cj4gPiAtCW9yaWVu
dGF0aW9uID0gZGV2X3ByaXYtPnZidC5vcmllbnRhdGlvbjsKPiA+ICsJb3JpZW50YXRpb24gPSBp
OTE1LT52YnQub3JpZW50YXRpb247Cj4gPiAgIAlpZiAob3JpZW50YXRpb24gIT0gRFJNX01PREVf
UEFORUxfT1JJRU5UQVRJT05fVU5LTk9XTikKPiA+ICAgCQlyZXR1cm4gb3JpZW50YXRpb247Cj4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHNpLmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9kc2kuaAo+ID4gaW5kZXggNmQyMDQzNDYzNmNkLi4yZjQ3NzI2
M2QxZjYgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2kuaAo+
ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHNpLmgKPiA+IEBAIC0xNTUsNyAr
MTU1LDcgQEAgc3RhdGljIGlubGluZSB1MTYgaW50ZWxfZHNpX2VuY29kZXJfcG9ydHMoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIH0KPiA+ICAgLyogaWNsX2RzaS5jICovCj4g
PiAtdm9pZCBpY2xfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsK
PiA+ICt2b2lkIGljbF9kc2lfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4g
PiAgIC8qIGludGVsX2RzaS5jICovCj4gPiAgIGludCBpbnRlbF9kc2lfYml0cmF0ZShjb25zdCBz
dHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kpOwo+ID4gQEAgLTE3Miw3ICsxNzIsNyBAQCBlbnVt
IGRybV9tb2RlX3N0YXR1cyBpbnRlbF9kc2lfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yLAo+ID4gICBzdHJ1Y3QgaW50ZWxfZHNpX2hvc3QgKmludGVsX2RzaV9ob3N0
X2luaXQoc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpLAo+ID4gICAJCQkJCSAgIGNvbnN0IHN0
cnVjdCBtaXBpX2RzaV9ob3N0X29wcyAqZnVuY3MsCj4gPiAgIAkJCQkJICAgZW51bSBwb3J0IHBv
cnQpOwo+ID4gLXZvaWQgdmx2X2RzaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdik7Cj4gPiArdm9pZCB2bHZfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpOwo+ID4gICAvKiB2bHZfZHNpX3BsbC5jICovCj4gPiAgIGludCB2bHZfZHNpX3BsbF9jb21w
dXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gQEAgLTE4NCw3ICsxODQsNyBA
QCB1MzIgdmx2X2RzaV9nZXRfcGNsayhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+
ICAgCQkgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjb25maWcpOwo+ID4gICB2b2lkIHZs
dl9kc2lfcmVzZXRfY2xvY2tzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLCBlbnVtIHBv
cnQgcG9ydCk7Cj4gPiAtYm9vbCBieHRfZHNpX3BsbF9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArYm9vbCBieHRfZHNpX3BsbF9pc19lbmFibGVkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgaW50IGJ4dF9kc2lfcGxsX2NvbXB1
dGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCXN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjb25maWcpOwo+ID4gICB2b2lkIGJ4dF9kc2lfcGxsX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kc2lfZGNzX2JhY2tsaWdodC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfZHNpX2Rjc19iYWNrbGlnaHQuYwo+ID4gaW5kZXggOGMzMzI2MmNiMGIyLi5lNWRkNDk2Mjcw
NWMgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2lfZGNzX2Jh
Y2tsaWdodC5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kc2lfZGNzX2Jh
Y2tsaWdodC5jCj4gPiBAQCAtMTU5LDExICsxNTksMTEgQEAgc3RhdGljIGludCBkY3Nfc2V0dXBf
YmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgaW50IGlu
dGVsX2RzaV9kY3NfaW5pdF9iYWNrbGlnaHRfZnVuY3Moc3RydWN0IGludGVsX2Nvbm5lY3RvciAq
aW50ZWxfY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0g
aW50ZWxfY29ubmVjdG9yLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
ID0gaW50ZWxfY29ubmVjdG9yLT5lbmNvZGVyOwo+ID4gICAJc3RydWN0IGludGVsX3BhbmVsICpw
YW5lbCA9ICZpbnRlbF9jb25uZWN0b3ItPnBhbmVsOwo+ID4gLQlpZiAoZGV2X3ByaXYtPnZidC5i
YWNrbGlnaHQudHlwZSAhPSBJTlRFTF9CQUNLTElHSFRfRFNJX0RDUykKPiA+ICsJaWYgKGk5MTUt
PnZidC5iYWNrbGlnaHQudHlwZSAhPSBJTlRFTF9CQUNLTElHSFRfRFNJX0RDUykKPiA+ICAgCQly
ZXR1cm4gLUVOT0RFVjsKPiA+ICAgCWlmIChXQVJOX09OKGVuY29kZXItPnR5cGUgIT0gSU5URUxf
T1VUUFVUX0RTSSkpCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
ZHNpX3ZidC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHNpX3ZidC5jCj4gPiBpbmRl
eCBlNWIxNzg2NjA0MDguLmQ0NGViZGZkODc2MCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2RzaV92YnQuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZHNpX3ZidC5jCj4gPiBAQCAtMTIxLDcgKzEyMSw3IEBAIHN0YXRpYyBpbmxpbmUgZW51
bSBwb3J0IGludGVsX2RzaV9zZXFfcG9ydF90b19wb3J0KHU4IHBvcnQpCj4gPiAgIHN0YXRpYyBj
b25zdCB1OCAqbWlwaV9leGVjX3NlbmRfcGFja2V0KHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2Rz
aSwKPiA+ICAgCQkJCSAgICAgICBjb25zdCB1OCAqZGF0YSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2RzaS0+YmFzZS5iYXNl
LmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShpbnRl
bF9kc2ktPmJhc2UuYmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZHNp
X2RldmljZTsKPiA+ICAgCXU4IHR5cGUsIGZsYWdzLCBzZXFfcG9ydDsKPiA+ICAgCXUxNiBsZW47
Cj4gPiBAQCAtMTkyLDcgKzE5Miw3IEBAIHN0YXRpYyBjb25zdCB1OCAqbWlwaV9leGVjX3NlbmRf
cGFja2V0KHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSwKPiA+ICAgCQlicmVhazsKPiA+ICAg
CX0KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCAxMSkKPiA+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA8IDExKQo+ID4gICAJCXZsdl9kc2lfd2FpdF9mb3JfZmlmb19lbXB0eShpbnRlbF9k
c2ksIHBvcnQpOwo+ID4gICBvdXQ6Cj4gPiBAQCAtMjEzLDcgKzIxMyw3IEBAIHN0YXRpYyBjb25z
dCB1OCAqbWlwaV9leGVjX2RlbGF5KHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSwgY29uc3Qg
dTggKmRhdGEpCj4gPiAgIAlyZXR1cm4gZGF0YTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHZs
dl9leGVjX2dwaW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRp
YyB2b2lkIHZsdl9leGVjX2dwaW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAg
IAkJCSAgdTggZ3Bpb19zb3VyY2UsIHU4IGdwaW9faW5kZXgsIGJvb2wgdmFsdWUpCj4gPiAgIHsK
PiA+ICAgCXN0cnVjdCBncGlvX21hcCAqbWFwOwo+ID4gQEAgLTIyOCw3ICsyMjgsNyBAQCBzdGF0
aWMgdm9pZCB2bHZfZXhlY19ncGlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICAgCW1hcCA9ICZ2bHZfZ3Bpb190YWJsZVtncGlvX2luZGV4XTsKPiA+IC0JaWYgKGRldl9w
cml2LT52YnQuZHNpLnNlcV92ZXJzaW9uID49IDMpIHsKPiA+ICsJaWYgKGk5MTUtPnZidC5kc2ku
c2VxX3ZlcnNpb24gPj0gMykgewo+ID4gICAJCS8qIFhYWDogdGhpcyBhc3N1bWVzIHZsdl9ncGlv
X3RhYmxlIG9ubHkgaGFzIE5DIEdQSU9zLiAqLwo+ID4gICAJCXBvcnQgPSBJT1NGX1BPUlRfR1BJ
T19OQzsKPiA+ICAgCX0gZWxzZSB7Cj4gPiBAQCAtMjQ2LDI2ICsyNDYsMjYgQEAgc3RhdGljIHZv
aWQgdmx2X2V4ZWNfZ3BpbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAg
IAlwY29uZjAgPSBWTFZfR1BJT19QQ09ORjAobWFwLT5iYXNlX29mZnNldCk7Cj4gPiAgIAlwYWR2
YWwgPSBWTFZfR1BJT19QQURfVkFMKG1hcC0+YmFzZV9vZmZzZXQpOwo+ID4gLQl2bHZfaW9zZl9z
Yl9nZXQoZGV2X3ByaXYsIEJJVChWTFZfSU9TRl9TQl9HUElPKSk7Cj4gPiArCXZsdl9pb3NmX3Ni
X2dldChpOTE1LCBCSVQoVkxWX0lPU0ZfU0JfR1BJTykpOwo+ID4gICAJaWYgKCFtYXAtPmluaXQp
IHsKPiA+ICAgCQkvKiBGSVhNRTogcmVtb3ZlIGNvbnN0YW50IGJlbG93ICovCj4gPiAtCQl2bHZf
aW9zZl9zYl93cml0ZShkZXZfcHJpdiwgcG9ydCwgcGNvbmYwLCAweDIwMDBDQzAwKTsKPiA+ICsJ
CXZsdl9pb3NmX3NiX3dyaXRlKGk5MTUsIHBvcnQsIHBjb25mMCwgMHgyMDAwQ0MwMCk7Cj4gPiAg
IAkJbWFwLT5pbml0ID0gdHJ1ZTsKPiA+ICAgCX0KPiA+ICAgCXRtcCA9IDB4NCB8IHZhbHVlOwo+
ID4gLQl2bHZfaW9zZl9zYl93cml0ZShkZXZfcHJpdiwgcG9ydCwgcGFkdmFsLCB0bXApOwo+ID4g
LQl2bHZfaW9zZl9zYl9wdXQoZGV2X3ByaXYsIEJJVChWTFZfSU9TRl9TQl9HUElPKSk7Cj4gPiAr
CXZsdl9pb3NmX3NiX3dyaXRlKGk5MTUsIHBvcnQsIHBhZHZhbCwgdG1wKTsKPiA+ICsJdmx2X2lv
c2Zfc2JfcHV0KGk5MTUsIEJJVChWTFZfSU9TRl9TQl9HUElPKSk7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgdm9pZCBjaHZfZXhlY19ncGlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICtzdGF0aWMgdm9pZCBjaHZfZXhlY19ncGlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ID4gICAJCQkgIHU4IGdwaW9fc291cmNlLCB1OCBncGlvX2luZGV4LCBib29sIHZhbHVl
KQo+ID4gICB7Cj4gPiAgIAl1MTYgY2ZnMCwgY2ZnMTsKPiA+ICAgCXUxNiBmYW1pbHlfbnVtOwo+
ID4gICAJdTggcG9ydDsKPiA+IC0JaWYgKGRldl9wcml2LT52YnQuZHNpLnNlcV92ZXJzaW9uID49
IDMpIHsKPiA+ICsJaWYgKGk5MTUtPnZidC5kc2kuc2VxX3ZlcnNpb24gPj0gMykgewo+ID4gICAJ
CWlmIChncGlvX2luZGV4ID49IENIVl9HUElPX0lEWF9TVEFSVF9TRSkgewo+ID4gICAJCQkvKiBY
WFg6IGl0J3MgdW5jbGVhciB3aGV0aGVyIDI1NS0+NTcgaXMgcGFydCBvZiBTRS4gKi8KPiA+ICAg
CQkJZ3Bpb19pbmRleCAtPSBDSFZfR1BJT19JRFhfU1RBUlRfU0U7Cj4gPiBAQCAtMzAxLDE1ICsz
MDEsMTUgQEAgc3RhdGljIHZvaWQgY2h2X2V4ZWNfZ3BpbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiAgIAljZmcwID0gQ0hWX0dQSU9fUEFEX0NGRzAoZmFtaWx5X251bSwg
Z3Bpb19pbmRleCk7Cj4gPiAgIAljZmcxID0gQ0hWX0dQSU9fUEFEX0NGRzEoZmFtaWx5X251bSwg
Z3Bpb19pbmRleCk7Cj4gPiAtCXZsdl9pb3NmX3NiX2dldChkZXZfcHJpdiwgQklUKFZMVl9JT1NG
X1NCX0dQSU8pKTsKPiA+IC0Jdmx2X2lvc2Zfc2Jfd3JpdGUoZGV2X3ByaXYsIHBvcnQsIGNmZzEs
IDApOwo+ID4gLQl2bHZfaW9zZl9zYl93cml0ZShkZXZfcHJpdiwgcG9ydCwgY2ZnMCwKPiA+ICsJ
dmx2X2lvc2Zfc2JfZ2V0KGk5MTUsIEJJVChWTFZfSU9TRl9TQl9HUElPKSk7Cj4gPiArCXZsdl9p
b3NmX3NiX3dyaXRlKGk5MTUsIHBvcnQsIGNmZzEsIDApOwo+ID4gKwl2bHZfaW9zZl9zYl93cml0
ZShpOTE1LCBwb3J0LCBjZmcwLAo+ID4gICAJCQkgIENIVl9HUElPX0dQSU9FTiB8IENIVl9HUElP
X0dQSU9DRkdfR1BPIHwKPiA+ICAgCQkJICBDSFZfR1BJT19HUElPVFhTVEFURSh2YWx1ZSkpOwo+
ID4gLQl2bHZfaW9zZl9zYl9wdXQoZGV2X3ByaXYsIEJJVChWTFZfSU9TRl9TQl9HUElPKSk7Cj4g
PiArCXZsdl9pb3NmX3NiX3B1dChpOTE1LCBCSVQoVkxWX0lPU0ZfU0JfR1BJTykpOwo+ID4gICB9
Cj4gPiAtc3RhdGljIHZvaWQgYnh0X2V4ZWNfZ3BpbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgYnh0X2V4ZWNfZ3BpbyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICB1OCBncGlvX3NvdXJjZSwgdTggZ3Bpb19pbmRleCwg
Ym9vbCB2YWx1ZSkKPiA+ICAgewo+ID4gICAJLyogWFhYOiB0aGlzIHRhYmxlIGlzIGEgcXVpY2sg
dWdseSBoYWNrLiAqLwo+ID4gQEAgLTMxNyw3ICszMTcsNyBAQCBzdGF0aWMgdm9pZCBieHRfZXhl
Y19ncGlvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXN0cnVjdCBn
cGlvX2Rlc2MgKmdwaW9fZGVzYyA9IGJ4dF9ncGlvX3RhYmxlW2dwaW9faW5kZXhdOwo+ID4gICAJ
aWYgKCFncGlvX2Rlc2MpIHsKPiA+IC0JCWdwaW9fZGVzYyA9IGRldm1fZ3Bpb2RfZ2V0X2luZGV4
KGRldl9wcml2LT5kcm0uZGV2LAo+ID4gKwkJZ3Bpb19kZXNjID0gZGV2bV9ncGlvZF9nZXRfaW5k
ZXgoaTkxNS0+ZHJtLmRldiwKPiA+ICAgCQkJCQkJIE5VTEwsIGdwaW9faW5kZXgsCj4gPiAgIAkJ
CQkJCSB2YWx1ZSA/IEdQSU9EX09VVF9MT1cgOgo+ID4gICAJCQkJCQkgR1BJT0RfT1VUX0hJR0gp
Owo+ID4gQEAgLTMzNCw3ICszMzQsNyBAQCBzdGF0aWMgdm9pZCBieHRfZXhlY19ncGlvKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWdwaW9kX3NldF92YWx1ZShncGlv
X2Rlc2MsIHZhbHVlKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGljbF9leGVjX2dwaW8oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGljbF9leGVj
X2dwaW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgdTggZ3Bpb19z
b3VyY2UsIHU4IGdwaW9faW5kZXgsIGJvb2wgdmFsdWUpCj4gPiAgIHsKPiA+ICAgCURSTV9ERUJV
R19LTVMoIlNraXBwaW5nIElDTCBHUElPIGVsZW1lbnQgZXhlY3V0aW9uXG4iKTsKPiA+IEBAIC0z
NDMsMTkgKzM0MywxOSBAQCBzdGF0aWMgdm9pZCBpY2xfZXhlY19ncGlvKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgc3RhdGljIGNvbnN0IHU4ICptaXBpX2V4ZWNfZ3Bp
byhzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2ksIGNvbnN0IHU4ICpkYXRhKQo+ID4gICB7Cj4g
PiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gaW50ZWxfZHNpLT5iYXNlLmJhc2UuZGV2Owo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJ
dTggZ3Bpb19zb3VyY2UsIGdwaW9faW5kZXggPSAwLCBncGlvX251bWJlcjsKPiA+ICAgCWJvb2wg
dmFsdWU7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJcbiIpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPnZi
dC5kc2kuc2VxX3ZlcnNpb24gPj0gMykKPiA+ICsJaWYgKGk5MTUtPnZidC5kc2kuc2VxX3ZlcnNp
b24gPj0gMykKPiA+ICAgCQlncGlvX2luZGV4ID0gKmRhdGErKzsKPiA+ICAgCWdwaW9fbnVtYmVy
ID0gKmRhdGErKzsKPiA+ICAgCS8qIGdwaW8gc291cmNlIGluIHNlcXVlbmNlIHYyIG9ubHkgKi8K
PiA+IC0JaWYgKGRldl9wcml2LT52YnQuZHNpLnNlcV92ZXJzaW9uID09IDIpCj4gPiArCWlmIChp
OTE1LT52YnQuZHNpLnNlcV92ZXJzaW9uID09IDIpCj4gPiAgIAkJZ3Bpb19zb3VyY2UgPSAoKmRh
dGEgPj4gMSkgJiAzOwo+ID4gICAJZWxzZQo+ID4gICAJCWdwaW9fc291cmNlID0gMDsKPiA+IEBA
IC0zNjMsMTQgKzM2MywxNCBAQCBzdGF0aWMgY29uc3QgdTggKm1pcGlfZXhlY19ncGlvKHN0cnVj
dCBpbnRlbF9kc2kgKmludGVsX2RzaSwgY29uc3QgdTggKmRhdGEpCj4gPiAgIAkvKiBwdWxsIHVw
L2Rvd24gKi8KPiA+ICAgCXZhbHVlID0gKmRhdGErKyAmIDE7Cj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDExKQo+ID4gLQkJaWNsX2V4ZWNfZ3BpbyhkZXZfcHJpdiwgZ3Bpb19zb3Vy
Y2UsIGdwaW9faW5kZXgsIHZhbHVlKTsKPiA+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZf
cHJpdikpCj4gPiAtCQl2bHZfZXhlY19ncGlvKGRldl9wcml2LCBncGlvX3NvdXJjZSwgZ3Bpb19u
dW1iZXIsIHZhbHVlKTsKPiA+IC0JZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4g
PiAtCQljaHZfZXhlY19ncGlvKGRldl9wcml2LCBncGlvX3NvdXJjZSwgZ3Bpb19udW1iZXIsIHZh
bHVlKTsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICsJCWljbF9leGVjX2dw
aW8oaTkxNSwgZ3Bpb19zb3VyY2UsIGdwaW9faW5kZXgsIHZhbHVlKTsKPiA+ICsJZWxzZSBpZiAo
SVNfVkFMTEVZVklFVyhpOTE1KSkKPiA+ICsJCXZsdl9leGVjX2dwaW8oaTkxNSwgZ3Bpb19zb3Vy
Y2UsIGdwaW9fbnVtYmVyLCB2YWx1ZSk7Cj4gPiArCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkx
NSkpCj4gPiArCQljaHZfZXhlY19ncGlvKGk5MTUsIGdwaW9fc291cmNlLCBncGlvX251bWJlciwg
dmFsdWUpOwo+ID4gICAJZWxzZQo+ID4gLQkJYnh0X2V4ZWNfZ3BpbyhkZXZfcHJpdiwgZ3Bpb19z
b3VyY2UsIGdwaW9faW5kZXgsIHZhbHVlKTsKPiA+ICsJCWJ4dF9leGVjX2dwaW8oaTkxNSwgZ3Bp
b19zb3VyY2UsIGdwaW9faW5kZXgsIHZhbHVlKTsKPiA+ICAgCXJldHVybiBkYXRhOwo+ID4gICB9
Cj4gPiBAQCAtNDU2LDE0ICs0NTYsMTQgQEAgc3RhdGljIGNvbnN0IGNoYXIgKnNlcXVlbmNlX25h
bWUoZW51bSBtaXBpX3NlcSBzZXFfaWQpCj4gPiAgIHZvaWQgaW50ZWxfZHNpX3ZidF9leGVjX3Nl
cXVlbmNlKHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSwKPiA+ICAgCQkJCSBlbnVtIG1pcGlf
c2VxIHNlcV9pZCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGludGVsX2RzaS0+YmFzZS5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShpbnRlbF9kc2ktPmJhc2UuYmFzZS5kZXYpOwo+
ID4gICAJY29uc3QgdTggKmRhdGE7Cj4gPiAgIAlmbl9taXBpX2VsZW1fZXhlYyBtaXBpX2VsZW1f
ZXhlYzsKPiA+IC0JaWYgKFdBUk5fT04oc2VxX2lkID49IEFSUkFZX1NJWkUoZGV2X3ByaXYtPnZi
dC5kc2kuc2VxdWVuY2UpKSkKPiA+ICsJaWYgKFdBUk5fT04oc2VxX2lkID49IEFSUkFZX1NJWkUo
aTkxNS0+dmJ0LmRzaS5zZXF1ZW5jZSkpKQo+ID4gICAJCXJldHVybjsKPiA+IC0JZGF0YSA9IGRl
dl9wcml2LT52YnQuZHNpLnNlcXVlbmNlW3NlcV9pZF07Cj4gPiArCWRhdGEgPSBpOTE1LT52YnQu
ZHNpLnNlcXVlbmNlW3NlcV9pZF07Cj4gPiAgIAlpZiAoIWRhdGEpCj4gPiAgIAkJcmV0dXJuOwo+
ID4gQEAgLTQ3Niw3ICs0NzYsNyBAQCB2b2lkIGludGVsX2RzaV92YnRfZXhlY19zZXF1ZW5jZShz
dHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2ksCj4gPiAgIAlkYXRhKys7Cj4gPiAgIAkvKiBTa2lw
IFNpemUgb2YgU2VxdWVuY2UuICovCj4gPiAtCWlmIChkZXZfcHJpdi0+dmJ0LmRzaS5zZXFfdmVy
c2lvbiA+PSAzKQo+ID4gKwlpZiAoaTkxNS0+dmJ0LmRzaS5zZXFfdmVyc2lvbiA+PSAzKQo+ID4g
ICAJCWRhdGEgKz0gNDsKPiA+ICAgCXdoaWxlICgxKSB7Cj4gPiBAQCAtNDkyLDcgKzQ5Miw3IEBA
IHZvaWQgaW50ZWxfZHNpX3ZidF9leGVjX3NlcXVlbmNlKHN0cnVjdCBpbnRlbF9kc2kgKmludGVs
X2RzaSwKPiA+ICAgCQkJbWlwaV9lbGVtX2V4ZWMgPSBOVUxMOwo+ID4gICAJCS8qIFNpemUgb2Yg
T3BlcmF0aW9uLiAqLwo+ID4gLQkJaWYgKGRldl9wcml2LT52YnQuZHNpLnNlcV92ZXJzaW9uID49
IDMpCj4gPiArCQlpZiAoaTkxNS0+dmJ0LmRzaS5zZXFfdmVyc2lvbiA+PSAzKQo+ID4gICAJCQlv
cGVyYXRpb25fc2l6ZSA9ICpkYXRhKys7Cj4gPiAgIAkJaWYgKG1pcGlfZWxlbV9leGVjKSB7Cj4g
PiBAQCAtNTIxLDEwICs1MjEsMTAgQEAgdm9pZCBpbnRlbF9kc2lfdmJ0X2V4ZWNfc2VxdWVuY2Uo
c3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpLAo+ID4gICB2b2lkIGludGVsX2RzaV9tc2xlZXAo
c3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpLCBpbnQgbXNlYykKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2RzaS0+YmFzZS5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShp
bnRlbF9kc2ktPmJhc2UuYmFzZS5kZXYpOwo+ID4gICAJLyogRm9yIHYzIFZCVHMgaW4gdmlkLW1v
ZGUgdGhlIGRlbGF5cyBhcmUgcGFydCBvZiB0aGUgVkJUIHNlcXVlbmNlcyAqLwo+ID4gLQlpZiAo
aXNfdmlkX21vZGUoaW50ZWxfZHNpKSAmJiBkZXZfcHJpdi0+dmJ0LmRzaS5zZXFfdmVyc2lvbiA+
PSAzKQo+ID4gKwlpZiAoaXNfdmlkX21vZGUoaW50ZWxfZHNpKSAmJiBpOTE1LT52YnQuZHNpLnNl
cV92ZXJzaW9uID49IDMpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJbXNsZWVwKG1zZWMpOwo+ID4g
QEAgLTU3MSwxMCArNTcxLDEwIEBAIHZvaWQgaW50ZWxfZHNpX2xvZ19wYXJhbXMoc3RydWN0IGlu
dGVsX2RzaSAqaW50ZWxfZHNpKQo+ID4gICBib29sIGludGVsX2RzaV92YnRfaW5pdChzdHJ1Y3Qg
aW50ZWxfZHNpICppbnRlbF9kc2ksIHUxNiBwYW5lbF9pZCkKPiA+ICAgewo+ID4gICAJc3RydWN0
IGRybV9kZXZpY2UgKmRldiA9IGludGVsX2RzaS0+YmFzZS5iYXNlLmRldjsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gLQlzdHJ1Y3Qg
bWlwaV9jb25maWcgKm1pcGlfY29uZmlnID0gZGV2X3ByaXYtPnZidC5kc2kuY29uZmlnOwo+ID4g
LQlzdHJ1Y3QgbWlwaV9wcHNfZGF0YSAqcHBzID0gZGV2X3ByaXYtPnZidC5kc2kucHBzOwo+ID4g
LQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSA9IGRldl9wcml2LT52YnQubGZwX2x2ZHNf
dmJ0X21vZGU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShk
ZXYpOwo+ID4gKwlzdHJ1Y3QgbWlwaV9jb25maWcgKm1pcGlfY29uZmlnID0gaTkxNS0+dmJ0LmRz
aS5jb25maWc7Cj4gPiArCXN0cnVjdCBtaXBpX3Bwc19kYXRhICpwcHMgPSBpOTE1LT52YnQuZHNp
LnBwczsKPiA+ICsJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUgPSBpOTE1LT52YnQubGZw
X2x2ZHNfdmJ0X21vZGU7Cj4gPiAgIAl1MTYgYnVyc3RfbW9kZV9yYXRpbzsKPiA+ICAgCWVudW0g
cG9ydCBwb3J0Owo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2
by5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHZvLmMKPiA+IGluZGV4IDIyNjY2ZDI4
ZjRhYS4uNmNlZDk1YjczNTM4IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZHZvLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2by5jCj4g
PiBAQCAtMTMzLDcgKzEzMyw3IEBAIHN0YXRpYyBzdHJ1Y3QgaW50ZWxfZHZvICppbnRlbF9hdHRh
Y2hlZF9kdm8oc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgc3RhdGljIGJv
b2wgaW50ZWxfZHZvX2Nvbm5lY3Rvcl9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY29u
bmVjdG9yLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kdm8gKmludGVsX2R2byA9IGludGVsX2F0
dGFjaGVkX2R2bygmY29ubmVjdG9yLT5iYXNlKTsKPiA+ICAgCXUzMiB0bXA7Cj4gPiBAQCAtMTQ4
LDcgKzE0OCw3IEBAIHN0YXRpYyBib29sIGludGVsX2R2b19jb25uZWN0b3JfZ2V0X2h3X3N0YXRl
KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgc3RhdGljIGJvb2wgaW50
ZWxfZHZvX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAg
CQkJCSAgIGVudW0gcGlwZSAqcGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9kdm8gKmludGVsX2R2byA9IGVuY190b19kdm8oZW5jb2Rlcik7Cj4g
PiAgIAl1MzIgdG1wOwo+ID4gQEAgLTE2Miw3ICsxNjIsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9k
dm9fZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICBzdGF0
aWMgdm9pZCBpbnRlbF9kdm9fZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiA+ICAgCQkJCSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHZvICppbnRlbF9k
dm8gPSBlbmNfdG9fZHZvKGVuY29kZXIpOwo+ID4gICAJdTMyIHRtcCwgZmxhZ3MgPSAwOwo+ID4g
QEAgLTE4Nyw3ICsxODcsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX2R2byhzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ID4gICAJCQkgICAgICBjb25zdCBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHZvICppbnRlbF9kdm8gPSBlbmNfdG9fZHZv
KGVuY29kZXIpOwo+ID4gICAJaTkxNV9yZWdfdCBkdm9fcmVnID0gaW50ZWxfZHZvLT5kZXYuZHZv
X3JlZzsKPiA+ICAgCXUzMiB0ZW1wID0gSTkxNV9SRUFEKGR2b19yZWcpOwo+ID4gQEAgLTIwMSw3
ICsyMDEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfZHZvKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+ID4gICAJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpwaXBlX2NvbmZpZywKPiA+ICAgCQkJICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9kdm8gKmludGVsX2R2byA9IGVuY190b19kdm8oZW5jb2Rlcik7Cj4gPiAgIAlp
OTE1X3JlZ190IGR2b19yZWcgPSBpbnRlbF9kdm8tPmRldi5kdm9fcmVnOwo+ID4gICAJdTMyIHRl
bXAgPSBJOTE1X1JFQUQoZHZvX3JlZyk7Cj4gPiBAQCAtMjc2LDcgKzI3Niw3IEBAIHN0YXRpYyB2
b2lkIGludGVsX2R2b19wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ID4gICAJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiA+
ICAgCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPiA+ICAgCWNvbnN0IHN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5iYXNl
LmFkanVzdGVkX21vZGU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHZvICppbnRlbF9kdm8gPSBlbmNf
dG9fZHZvKGVuY29kZXIpOwo+ID4gQEAgLTMxOSw3ICszMTksNyBAQCBpbnRlbF9kdm9fZGV0ZWN0
KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsIGJvb2wgZm9yY2UpCj4gPiAgIHN0YXRp
YyBpbnQgaW50ZWxfZHZvX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9y
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY29ubmVjdG9yLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5
X21vZGUgKmZpeGVkX21vZGUgPQo+ID4gICAJCXRvX2ludGVsX2Nvbm5lY3Rvcihjb25uZWN0b3Ip
LT5wYW5lbC5maXhlZF9tb2RlOwo+ID4gQEAgLTMzMCw3ICszMzAsNyBAQCBzdGF0aWMgaW50IGlu
dGVsX2R2b19nZXRfbW9kZXMoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAg
CSAqIHRoYXQncyBub3QgdGhlIGNhc2UuCj4gPiAgIAkgKi8KPiA+ICAgCWludGVsX2RkY19nZXRf
bW9kZXMoY29ubmVjdG9yLAo+ID4gLQkJCSAgICBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihkZXZf
cHJpdiwgR01CVVNfUElOX0RQQykpOwo+ID4gKwkJCSAgICBpbnRlbF9nbWJ1c19nZXRfYWRhcHRl
cihpOTE1LCBHTUJVU19QSU5fRFBDKSk7Cj4gPiAgIAlpZiAoIWxpc3RfZW1wdHkoJmNvbm5lY3Rv
ci0+cHJvYmVkX21vZGVzKSkKPiA+ICAgCQlyZXR1cm4gMTsKPiA+IEBAIC00MDYsNyArNDA2LDcg
QEAgc3RhdGljIGVudW0gcG9ydCBpbnRlbF9kdm9fcG9ydChpOTE1X3JlZ190IGR2b19yZWcpCj4g
PiAgIAkJcmV0dXJuIFBPUlRfQzsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfZHZvX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfZHZvX2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9lbmNvZGVyICppbnRlbF9lbmNvZGVyOwo+ID4gICAJc3RydWN0IGludGVsX2R2byAqaW50ZWxf
ZHZvOwo+ID4gQEAgLTQ1Miw3ICs0NTIsNyBAQCB2b2lkIGludGVsX2R2b19pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgKiBzcGVjaWFsIGNhc2VzLCBidXQg
b3RoZXJ3aXNlIGRlZmF1bHQgdG8gd2hhdCdzIGRlZmluZWQKPiA+ICAgCQkgKiBpbiB0aGUgc3Bl
Yy4KPiA+ICAgCQkgKi8KPiA+IC0JCWlmIChpbnRlbF9nbWJ1c19pc192YWxpZF9waW4oZGV2X3By
aXYsIGR2by0+Z3BpbykpCj4gPiArCQlpZiAoaW50ZWxfZ21idXNfaXNfdmFsaWRfcGluKGk5MTUs
IGR2by0+Z3BpbykpCj4gPiAgIAkJCWdwaW8gPSBkdm8tPmdwaW87Cj4gPiAgIAkJZWxzZSBpZiAo
ZHZvLT50eXBlID09IElOVEVMX0RWT19DSElQX0xWRFMpCj4gPiAgIAkJCWdwaW8gPSBHTUJVU19Q
SU5fU1NDOwo+ID4gQEAgLTQ2NCw3ICs0NjQsNyBAQCB2b2lkIGludGVsX2R2b19pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgKiBJdCBhcHBlYXJzIHRoYXQg
ZXZlcnl0aGluZyBpcyBvbiBHUElPRSBleGNlcHQgZm9yIHBhbmVscwo+ID4gICAJCSAqIG9uIGk4
MzAgbGFwdG9wcywgd2hpY2ggYXJlIG9uIEdQSU9CIChEVk9BKS4KPiA+ICAgCQkgKi8KPiA+IC0J
CWkyYyA9IGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGRldl9wcml2LCBncGlvKTsKPiA+ICsJCWky
YyA9IGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGk5MTUsIGdwaW8pOwo+ID4gICAJCWludGVsX2R2
by0+ZGV2ID0gKmR2bzsKPiA+IEBAIC00ODAsNyArNDgwLDcgQEAgdm9pZCBpbnRlbF9kdm9faW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICogaGF2ZSB0aGUg
Y2xvY2sgZW5hYmxlZCBiZWZvcmUgd2UgYXR0ZW1wdCB0bwo+ID4gICAJCSAqIGluaXRpYWxpemUg
dGhlIGRldmljZS4KPiA+ICAgCQkgKi8KPiA+IC0JCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBp
cGUpIHsKPiA+ICsJCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ID4gICAJCQlkcGxsW3Bp
cGVdID0gSTkxNV9SRUFEKERQTEwocGlwZSkpOwo+ID4gICAJCQlJOTE1X1dSSVRFKERQTEwocGlw
ZSksIGRwbGxbcGlwZV0gfCBEUExMX0RWT18yWF9NT0RFKTsKPiA+ICAgCQl9Cj4gPiBAQCAtNDg4
LDcgKzQ4OCw3IEBAIHZvaWQgaW50ZWxfZHZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gICAJCWR2b2luaXQgPSBkdm8tPmRldl9vcHMtPmluaXQoJmludGVsX2R2
by0+ZGV2LCBpMmMpOwo+ID4gICAJCS8qIHJlc3RvcmUgdGhlIERWTyAyeCBjbG9jayBzdGF0ZSB0
byBvcmlnaW5hbCAqLwo+ID4gLQkJZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ID4g
KwkJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gPiAgIAkJCUk5MTVfV1JJVEUoRFBMTChw
aXBlKSwgZHBsbFtwaXBlXSk7Cj4gPiAgIAkJfQo+ID4gQEAgLTQ5OCw3ICs0OTgsNyBAQCB2b2lk
IGludGVsX2R2b19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAg
CQkJY29udGludWU7Cj4gPiAgIAkJcG9ydCA9IGludGVsX2R2b19wb3J0KGR2by0+ZHZvX3JlZyk7
Cj4gPiAtCQlkcm1fZW5jb2Rlcl9pbml0KCZkZXZfcHJpdi0+ZHJtLCAmaW50ZWxfZW5jb2Rlci0+
YmFzZSwKPiA+ICsJCWRybV9lbmNvZGVyX2luaXQoJmk5MTUtPmRybSwgJmludGVsX2VuY29kZXIt
PmJhc2UsCj4gPiAgIAkJCQkgJmludGVsX2R2b19lbmNfZnVuY3MsIGVuY29kZXJfdHlwZSwKPiA+
ICAgCQkJCSAiRFZPICVjIiwgcG9ydF9uYW1lKHBvcnQpKTsKPiA+IEBAIC01MTEsMTQgKzUxMSwx
NCBAQCB2b2lkIGludGVsX2R2b19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICAgCQljYXNlIElOVEVMX0RWT19DSElQX1RNRFM6Cj4gPiAgIAkJCWludGVsX2VuY29k
ZXItPmNsb25lYWJsZSA9ICgxIDw8IElOVEVMX09VVFBVVF9BTkFMT0cpIHwKPiA+ICAgCQkJCSgx
IDw8IElOVEVMX09VVFBVVF9EVk8pOwo+ID4gLQkJCWRybV9jb25uZWN0b3JfaW5pdCgmZGV2X3By
aXYtPmRybSwgY29ubmVjdG9yLAo+ID4gKwkJCWRybV9jb25uZWN0b3JfaW5pdCgmaTkxNS0+ZHJt
LCBjb25uZWN0b3IsCj4gPiAgIAkJCQkJICAgJmludGVsX2R2b19jb25uZWN0b3JfZnVuY3MsCj4g
PiAgIAkJCQkJICAgRFJNX01PREVfQ09OTkVDVE9SX0RWSUkpOwo+ID4gICAJCQllbmNvZGVyX3R5
cGUgPSBEUk1fTU9ERV9FTkNPREVSX1RNRFM7Cj4gPiAgIAkJCWJyZWFrOwo+ID4gICAJCWNhc2Ug
SU5URUxfRFZPX0NISVBfTFZEUzoKPiA+ICAgCQkJaW50ZWxfZW5jb2Rlci0+Y2xvbmVhYmxlID0g
MDsKPiA+IC0JCQlkcm1fY29ubmVjdG9yX2luaXQoJmRldl9wcml2LT5kcm0sIGNvbm5lY3RvciwK
PiA+ICsJCQlkcm1fY29ubmVjdG9yX2luaXQoJmk5MTUtPmRybSwgY29ubmVjdG9yLAo+ID4gICAJ
CQkJCSAgICZpbnRlbF9kdm9fY29ubmVjdG9yX2Z1bmNzLAo+ID4gICAJCQkJCSAgIERSTV9NT0RF
X0NPTk5FQ1RPUl9MVkRTKTsKPiA+ICAgCQkJZW5jb2Rlcl90eXBlID0gRFJNX01PREVfRU5DT0RF
Ul9MVkRTOwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2by5o
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHZvLmgKPiA+IGluZGV4IDNlZDBmZGY4ZWZm
Zi4uZDg2NWNkNDM5YmI3IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfZHZvLmgKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2by5oCj4gPiBA
QCAtOCw2ICs4LDYgQEAKPiA+ICAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7Cj4gPiAtdm9pZCBp
bnRlbF9kdm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3Zv
aWQgaW50ZWxfZHZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICAj
ZW5kaWYgLyogX19JTlRFTF9EVk9fSF9fICovCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfZHZvX2Rldi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHZv
X2Rldi5oCj4gPiBpbmRleCA5NGE2YWUxZTAyOTIuLjFkMTg0ZGM3OTIyYiAxMDA2NDQKPiA+IC0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2R2b19kZXYuaAo+ID4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfZHZvX2Rldi5oCj4gPiBAQCAtNDAsNyArNDAsNyBAQCBzdHJ1
Y3QgaW50ZWxfZHZvX2RldmljZSB7Cj4gPiAgIAlpbnQgc2xhdmVfYWRkcjsKPiA+ICAgCWNvbnN0
IHN0cnVjdCBpbnRlbF9kdm9fZGV2X29wcyAqZGV2X29wczsKPiA+IC0Jdm9pZCAqZGV2X3ByaXY7
Cj4gPiArCXZvaWQgKmk5MTU7Cj4gPiAgIAlzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmkyY19idXM7Cj4g
PiAgIH07Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZmJjLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmMuYwo+ID4gaW5kZXggNTY3OWYyZmZmYjdj
Li42MjdmZWQyYTU1ZDIgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9mYmMuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZmJjLmMKPiA+IEBA
IC00NSwxNCArNDUsMTQgQEAKPiA+ICAgI2luY2x1ZGUgImludGVsX2ZiYy5oIgo+ID4gICAjaW5j
bHVkZSAiaW50ZWxfZnJvbnRidWZmZXIuaCIKPiA+IC1zdGF0aWMgaW5saW5lIGJvb2wgZmJjX3N1
cHBvcnRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGlu
bGluZSBib29sIGZiY19zdXBwb3J0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+IC0JcmV0dXJuIEhBU19GQkMoZGV2X3ByaXYpOwo+ID4gKwlyZXR1cm4gSEFTX0ZC
QyhpOTE1KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbmxpbmUgYm9vbCBub19mYmNfb25fbXVsdGlw
bGVfcGlwZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBp
bmxpbmUgYm9vbCBub19mYmNfb25fbXVsdGlwbGVfcGlwZXMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JcmV0dXJuIElOVEVMX0dFTihkZXZfcHJpdikgPD0gMzsK
PiA+ICsJcmV0dXJuIElOVEVMX0dFTihpOTE1KSA8PSAzOwo+ID4gICB9Cj4gPiAgIC8qCj4gPiBA
QCAtODIsMjIgKzgyLDIyIEBAIHN0YXRpYyB2b2lkIGludGVsX2ZiY19nZXRfcGxhbmVfc291cmNl
X3NpemUoc3RydWN0IGludGVsX2ZiY19zdGF0ZV9jYWNoZSAqY2FjaGUsCj4gPiAgIAkJKmhlaWdo
dCA9IGNhY2hlLT5wbGFuZS5zcmNfaDsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQgaW50ZWxfZmJj
X2NhbGN1bGF0ZV9jZmJfc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiArc3RhdGljIGludCBpbnRlbF9mYmNfY2FsY3VsYXRlX2NmYl9zaXplKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJCXN0cnVjdCBpbnRlbF9mYmNfc3RhdGVfY2FjaGUg
KmNhY2hlKQo+ID4gICB7Cj4gPiAgIAlpbnQgbGluZXM7Cj4gPiAgIAlpbnRlbF9mYmNfZ2V0X3Bs
YW5lX3NvdXJjZV9zaXplKGNhY2hlLCBOVUxMLCAmbGluZXMpOwo+ID4gLQlpZiAoSVNfR0VOKGRl
dl9wcml2LCA3KSkKPiA+ICsJaWYgKElTX0dFTihpOTE1LCA3KSkKPiA+ICAgCQlsaW5lcyA9IG1p
bihsaW5lcywgMjA0OCk7Cj4gPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkK
PiA+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpCj4gPiAgIAkJbGluZXMgPSBtaW4o
bGluZXMsIDI1NjApOwo+ID4gICAJLyogSGFyZHdhcmUgbmVlZHMgdGhlIGZ1bGwgYnVmZmVyIHN0
cmlkZSwgbm90IGp1c3QgdGhlIGFjdGl2ZSBhcmVhLiAqLwo+ID4gICAJcmV0dXJuIGxpbmVzICog
Y2FjaGUtPmZiLnN0cmlkZTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGk4eHhfZmJjX2RlYWN0
aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lk
IGk4eHhfZmJjX2RlYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAg
IHsKPiA+ICAgCXUzMiBmYmNfY3RsOwo+ID4gQEAgLTExMCw3ICsxMTAsNyBAQCBzdGF0aWMgdm9p
ZCBpOHh4X2ZiY19kZWFjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgCUk5MTVfV1JJVEUoRkJDX0NPTlRST0wsIGZiY19jdGwpOwo+ID4gICAJLyogV2FpdCBm
b3IgY29tcHJlc3NpbmcgYml0IHRvIGNsZWFyICovCj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9y
ZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lz
dGVyKCZpOTE1LT51bmNvcmUsCj4gPiAgIAkJCQkgICAgRkJDX1NUQVRVUywgRkJDX1NUQVRfQ09N
UFJFU1NJTkcsIDAsCj4gPiAgIAkJCQkgICAgMTApKSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygi
RkJDIGlkbGUgdGltZWQgb3V0XG4iKTsKPiA+IEBAIC0xMTgsOSArMTE4LDkgQEAgc3RhdGljIHZv
aWQgaTh4eF9mYmNfZGVhY3RpdmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpOHh4X2ZiY19hY3RpdmF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaTh4eF9mYmNf
YWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGludGVsX2ZiY19yZWdfcGFyYW1zICpwYXJhbXMgPSAmZGV2X3ByaXYtPmZiYy5wYXJhbXM7
Cj4gPiArCXN0cnVjdCBpbnRlbF9mYmNfcmVnX3BhcmFtcyAqcGFyYW1zID0gJmk5MTUtPmZiYy5w
YXJhbXM7Cj4gPiAgIAlpbnQgY2ZiX3BpdGNoOwo+ID4gICAJaW50IGk7Cj4gPiAgIAl1MzIgZmJj
X2N0bDsKPiA+IEBAIC0xMzEsNyArMTMxLDcgQEAgc3RhdGljIHZvaWQgaTh4eF9mYmNfYWN0aXZh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCWNmYl9waXRjaCA9
IHBhcmFtcy0+ZmIuc3RyaWRlOwo+ID4gICAJLyogRkJDX0NUTCB3YW50cyAzMkIgb3IgNjRCIHVu
aXRzICovCj4gPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKQo+ID4gKwlpZiAoSVNfR0VOKGk5
MTUsIDIpKQo+ID4gICAJCWNmYl9waXRjaCA9IChjZmJfcGl0Y2ggLyAzMikgLSAxOwo+ID4gICAJ
ZWxzZQo+ID4gICAJCWNmYl9waXRjaCA9IChjZmJfcGl0Y2ggLyA2NCkgLSAxOwo+ID4gQEAgLTE0
MCw3ICsxNDAsNyBAQCBzdGF0aWMgdm9pZCBpOHh4X2ZiY19hY3RpdmF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlmb3IgKGkgPSAwOyBpIDwgKEZCQ19MTF9TSVpF
IC8gMzIpICsgMTsgaSsrKQo+ID4gICAJCUk5MTVfV1JJVEUoRkJDX1RBRyhpKSwgMCk7Cj4gPiAt
CWlmIChJU19HRU4oZGV2X3ByaXYsIDQpKSB7Cj4gPiArCWlmIChJU19HRU4oaTkxNSwgNCkpIHsK
PiA+ICAgCQl1MzIgZmJjX2N0bDI7Cj4gPiAgIAkJLyogU2V0IGl0IHVwLi4uICovCj4gPiBAQCAt
MTU0LDIxICsxNTQsMjEgQEAgc3RhdGljIHZvaWQgaTh4eF9mYmNfYWN0aXZhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJZmJjX2N0bCA9IEk5MTVfUkVBRChGQkNf
Q09OVFJPTCk7Cj4gPiAgIAlmYmNfY3RsICY9IDB4M2ZmZiA8PCBGQkNfQ1RMX0lOVEVSVkFMX1NI
SUZUOwo+ID4gICAJZmJjX2N0bCB8PSBGQkNfQ1RMX0VOIHwgRkJDX0NUTF9QRVJJT0RJQzsKPiA+
IC0JaWYgKElTX0k5NDVHTShkZXZfcHJpdikpCj4gPiArCWlmIChJU19JOTQ1R00oaTkxNSkpCj4g
PiAgIAkJZmJjX2N0bCB8PSBGQkNfQ1RMX0MzX0lETEU7IC8qIDk0NSBuZWVkcyBzcGVjaWFsIFNS
IGhhbmRsaW5nICovCj4gPiAgIAlmYmNfY3RsIHw9IChjZmJfcGl0Y2ggJiAweGZmKSA8PCBGQkNf
Q1RMX1NUUklERV9TSElGVDsKPiA+ICAgCWZiY19jdGwgfD0gcGFyYW1zLT52bWEtPmZlbmNlLT5p
ZDsKPiA+ICAgCUk5MTVfV1JJVEUoRkJDX0NPTlRST0wsIGZiY19jdGwpOwo+ID4gICB9Cj4gPiAt
c3RhdGljIGJvb2wgaTh4eF9mYmNfaXNfYWN0aXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtzdGF0aWMgYm9vbCBpOHh4X2ZiY19pc19hY3RpdmUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXJldHVybiBJOTE1X1JFQUQoRkJDX0NP
TlRST0wpICYgRkJDX0NUTF9FTjsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGc0eF9mYmNfYWN0
aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lk
IGc0eF9mYmNfYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGludGVsX2ZiY19yZWdfcGFyYW1zICpwYXJhbXMgPSAmZGV2X3ByaXYtPmZi
Yy5wYXJhbXM7Cj4gPiArCXN0cnVjdCBpbnRlbF9mYmNfcmVnX3BhcmFtcyAqcGFyYW1zID0gJmk5
MTUtPmZiYy5wYXJhbXM7Cj4gPiAgIAl1MzIgZHBmY19jdGw7Cj4gPiAgIAlkcGZjX2N0bCA9IERQ
RkNfQ1RMX1BMQU5FKHBhcmFtcy0+Y3J0Yy5pOXh4X3BsYW5lKSB8IERQRkNfU1JfRU47Cj4gPiBA
QCAtMTg4LDcgKzE4OCw3IEBAIHN0YXRpYyB2b2lkIGc0eF9mYmNfYWN0aXZhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJSTkxNV9XUklURShEUEZDX0NPTlRST0ws
IGRwZmNfY3RsIHwgRFBGQ19DVExfRU4pOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZzR4X2Zi
Y19kZWFjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0
aWMgdm9pZCBnNHhfZmJjX2RlYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+ICAgCXUzMiBkcGZjX2N0bDsKPiA+IEBAIC0yMDAsMjMgKzIwMCwyMyBAQCBz
dGF0aWMgdm9pZCBnNHhfZmJjX2RlYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJfQo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wgZzR4X2ZiY19pc19hY3Rp
dmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBib29sIGc0
eF9mYmNfaXNfYWN0aXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAgIAlyZXR1cm4gSTkxNV9SRUFEKERQRkNfQ09OVFJPTCkgJiBEUEZDX0NUTF9FTjsKPiA+ICAg
fQo+ID4gICAvKiBUaGlzIGZ1bmN0aW9uIGZvcmNlcyBhIENGQiByZWNvbXByZXNzaW9uIHRocm91
Z2ggdGhlIG51a2Ugb3BlcmF0aW9uLiAqLwo+ID4gLXN0YXRpYyB2b2lkIGludGVsX2ZiY19yZWNv
bXByZXNzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9p
ZCBpbnRlbF9mYmNfcmVjb21wcmVzcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+
ICAgewo+ID4gICAJSTkxNV9XUklURShNU0dfRkJDX1JFTkRfU1RBVEUsIEZCQ19SRU5EX05VS0Up
Owo+ID4gICAJUE9TVElOR19SRUFEKE1TR19GQkNfUkVORF9TVEFURSk7Cj4gPiAgIH0KPiA+IC1z
dGF0aWMgdm9pZCBpbGtfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbGtfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9mYmNfcmVnX3BhcmFtcyAq
cGFyYW1zID0gJmRldl9wcml2LT5mYmMucGFyYW1zOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfZmJjX3Jl
Z19wYXJhbXMgKnBhcmFtcyA9ICZpOTE1LT5mYmMucGFyYW1zOwo+ID4gICAJdTMyIGRwZmNfY3Rs
Owo+ID4gLQlpbnQgdGhyZXNob2xkID0gZGV2X3ByaXYtPmZiYy50aHJlc2hvbGQ7Cj4gPiArCWlu
dCB0aHJlc2hvbGQgPSBpOTE1LT5mYmMudGhyZXNob2xkOwo+ID4gICAJZHBmY19jdGwgPSBEUEZD
X0NUTF9QTEFORShwYXJhbXMtPmNydGMuaTl4eF9wbGFuZSk7Cj4gPiAgIAlpZiAocGFyYW1zLT5m
Yi5mb3JtYXQtPmNwcFswXSA9PSAyKQo+ID4gQEAgLTIzNyw5ICsyMzcsOSBAQCBzdGF0aWMgdm9p
ZCBpbGtfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCWlmIChwYXJhbXMtPmZsYWdzICYgUExBTkVfSEFTX0ZFTkNFKSB7Cj4gPiAgIAkJZHBmY19j
dGwgfD0gRFBGQ19DVExfRkVOQ0VfRU47Cj4gPiAtCQlpZiAoSVNfR0VOKGRldl9wcml2LCA1KSkK
PiA+ICsJCWlmIChJU19HRU4oaTkxNSwgNSkpCj4gPiAgIAkJCWRwZmNfY3RsIHw9IHBhcmFtcy0+
dm1hLT5mZW5jZS0+aWQ7Cj4gPiAtCQlpZiAoSVNfR0VOKGRldl9wcml2LCA2KSkgewo+ID4gKwkJ
aWYgKElTX0dFTihpOTE1LCA2KSkgewo+ID4gICAJCQlJOTE1X1dSSVRFKFNOQl9EUEZDX0NUTF9T
QSwKPiA+ICAgCQkJCSAgIFNOQl9DUFVfRkVOQ0VfRU5BQkxFIHwKPiA+ICAgCQkJCSAgIHBhcmFt
cy0+dm1hLT5mZW5jZS0+aWQpOwo+ID4gQEAgLTI0Nyw3ICsyNDcsNyBAQCBzdGF0aWMgdm9pZCBp
bGtfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAg
CQkJCSAgIHBhcmFtcy0+Y3J0Yy5mZW5jZV95X29mZnNldCk7Cj4gPiAgIAkJfQo+ID4gICAJfSBl
bHNlIHsKPiA+IC0JCWlmIChJU19HRU4oZGV2X3ByaXYsIDYpKSB7Cj4gPiArCQlpZiAoSVNfR0VO
KGk5MTUsIDYpKSB7Cj4gPiAgIAkJCUk5MTVfV1JJVEUoU05CX0RQRkNfQ1RMX1NBLCAwKTsKPiA+
ICAgCQkJSTkxNV9XUklURShEUEZDX0NQVV9GRU5DRV9PRkZTRVQsIDApOwo+ID4gICAJCX0KPiA+
IEBAIC0yNTksMTAgKzI1OSwxMCBAQCBzdGF0aWMgdm9pZCBpbGtfZmJjX2FjdGl2YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCS8qIGVuYWJsZSBpdC4uLiAqLwo+
ID4gICAJSTkxNV9XUklURShJTEtfRFBGQ19DT05UUk9MLCBkcGZjX2N0bCB8IERQRkNfQ1RMX0VO
KTsKPiA+IC0JaW50ZWxfZmJjX3JlY29tcHJlc3MoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9mYmNf
cmVjb21wcmVzcyhpOTE1KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGlsa19mYmNfZGVhY3Rp
dmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQg
aWxrX2ZiY19kZWFjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7
Cj4gPiAgIAl1MzIgZHBmY19jdGw7Cj4gPiBAQCAtMjc0LDE5ICsyNzQsMTkgQEAgc3RhdGljIHZv
aWQgaWxrX2ZiY19kZWFjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgCX0KPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIGlsa19mYmNfaXNfYWN0aXZlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgYm9vbCBpbGtfZmJjX2lz
X2FjdGl2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJcmV0
dXJuIEk5MTVfUkVBRChJTEtfRFBGQ19DT05UUk9MKSAmIERQRkNfQ1RMX0VOOwo+ID4gICB9Cj4g
PiAtc3RhdGljIHZvaWQgZ2VuN19mYmNfYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGdlbjdfZmJjX2FjdGl2YXRlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9mYmNfcmVnX3Bh
cmFtcyAqcGFyYW1zID0gJmRldl9wcml2LT5mYmMucGFyYW1zOwo+ID4gKwlzdHJ1Y3QgaW50ZWxf
ZmJjX3JlZ19wYXJhbXMgKnBhcmFtcyA9ICZpOTE1LT5mYmMucGFyYW1zOwo+ID4gICAJdTMyIGRw
ZmNfY3RsOwo+ID4gLQlpbnQgdGhyZXNob2xkID0gZGV2X3ByaXYtPmZiYy50aHJlc2hvbGQ7Cj4g
PiArCWludCB0aHJlc2hvbGQgPSBpOTE1LT5mYmMudGhyZXNob2xkOwo+ID4gICAJLyogRGlzcGxh
eSBXQSAjMDUyOTogc2tsLCBrYmwsIGJ4dC4gKi8KPiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwg
OSkgJiYgIUlTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19HRU4oaTkxNSwg
OSkgJiYgIUlTX0dFTUlOSUxBS0UoaTkxNSkpIHsKPiA+ICAgCQl1MzIgdmFsID0gSTkxNV9SRUFE
KENISUNLRU5fTUlTQ180KTsKPiA+ICAgCQl2YWwgJj0gfihGQkNfU1RSSURFX09WRVJSSURFIHwg
RkJDX1NUUklERV9NQVNLKTsKPiA+IEBAIC0yOTksNyArMjk5LDcgQEAgc3RhdGljIHZvaWQgZ2Vu
N19mYmNfYWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJ
fQo+ID4gICAJZHBmY19jdGwgPSAwOwo+ID4gLQlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkK
PiA+ICsJaWYgKElTX0lWWUJSSURHRShpOTE1KSkKPiA+ICAgCQlkcGZjX2N0bCB8PSBJVkJfRFBG
Q19DVExfUExBTkUocGFyYW1zLT5jcnRjLmk5eHhfcGxhbmUpOwo+ID4gICAJaWYgKHBhcmFtcy0+
ZmIuZm9ybWF0LT5jcHBbMF0gPT0gMikKPiA+IEBAIC0zMjksMTUgKzMyOSwxNSBAQCBzdGF0aWMg
dm9pZCBnZW43X2ZiY19hY3RpdmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAgIAkJSTkxNV9XUklURShEUEZDX0NQVV9GRU5DRV9PRkZTRVQsIDApOwo+ID4gICAJfQo+
ID4gLQlpZiAoZGV2X3ByaXYtPmZiYy5mYWxzZV9jb2xvcikKPiA+ICsJaWYgKGk5MTUtPmZiYy5m
YWxzZV9jb2xvcikKPiA+ICAgCQlkcGZjX2N0bCB8PSBGQkNfQ1RMX0ZBTFNFX0NPTE9SOwo+ID4g
LQlpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfSVZZQlJJREdFKGk5
MTUpKSB7Cj4gPiAgIAkJLyogV2FGYmNBc3luY2hGbGlwRGlzYWJsZUZiY1F1ZXVlOml2YiAqLwo+
ID4gICAJCUk5MTVfV1JJVEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjEsCj4gPiAgIAkJCSAgIEk5MTVf
UkVBRChJTEtfRElTUExBWV9DSElDS0VOMSkgfAo+ID4gICAJCQkgICBJTEtfRkJDUV9ESVMpOwo+
ID4gLQl9IGVsc2UgaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZf
cHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VM
TChpOTE1KSkgewo+ID4gICAJCS8qIFdhRmJjQXN5bmNoRmxpcERpc2FibGVGYmNRdWV1ZTpoc3cs
YmR3ICovCj4gPiAgIAkJSTkxNV9XUklURShDSElDS0VOX1BJUEVTTF8xKHBhcmFtcy0+Y3J0Yy5w
aXBlKSwKPiA+ICAgCQkJICAgSTkxNV9SRUFEKENISUNLRU5fUElQRVNMXzEocGFyYW1zLT5jcnRj
LnBpcGUpKSB8Cj4gPiBAQCAtMzQ2LDcyICszNDYsNzIgQEAgc3RhdGljIHZvaWQgZ2VuN19mYmNf
YWN0aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJSTkxNV9X
UklURShJTEtfRFBGQ19DT05UUk9MLCBkcGZjX2N0bCB8IERQRkNfQ1RMX0VOKTsKPiA+IC0JaW50
ZWxfZmJjX3JlY29tcHJlc3MoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9mYmNfcmVjb21wcmVzcyhp
OTE1KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIGludGVsX2ZiY19od19pc19hY3RpdmUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBib29sIGludGVsX2Zi
Y19od19pc19hY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSkKPiA+IC0JCXJldHVybiBpbGtfZmJjX2lz
X2FjdGl2ZShkZXZfcHJpdik7Cj4gPiAtCWVsc2UgaWYgKElTX0dNNDUoZGV2X3ByaXYpKQo+ID4g
LQkJcmV0dXJuIGc0eF9mYmNfaXNfYWN0aXZlKGRldl9wcml2KTsKPiA+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA1KQo+ID4gKwkJcmV0dXJuIGlsa19mYmNfaXNfYWN0aXZlKGk5MTUpOwo+ID4g
KwllbHNlIGlmIChJU19HTTQ1KGk5MTUpKQo+ID4gKwkJcmV0dXJuIGc0eF9mYmNfaXNfYWN0aXZl
KGk5MTUpOwo+ID4gICAJZWxzZQo+ID4gLQkJcmV0dXJuIGk4eHhfZmJjX2lzX2FjdGl2ZShkZXZf
cHJpdik7Cj4gPiArCQlyZXR1cm4gaTh4eF9mYmNfaXNfYWN0aXZlKGk5MTUpOwo+ID4gICB9Cj4g
PiAtc3RhdGljIHZvaWQgaW50ZWxfZmJjX2h3X2FjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9mYmNfaHdfYWN0aXZhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX2Zi
YyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gPiArCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZp
OTE1LT5mYmM7Cj4gPiAgIAlmYmMtPmFjdGl2ZSA9IHRydWU7Cj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDcpCj4gPiAtCQlnZW43X2ZiY19hY3RpdmF0ZShkZXZfcHJpdik7Cj4gPiAt
CWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSkKPiA+IC0JCWlsa19mYmNfYWN0aXZh
dGUoZGV2X3ByaXYpOwo+ID4gLQllbHNlIGlmIChJU19HTTQ1KGRldl9wcml2KSkKPiA+IC0JCWc0
eF9mYmNfYWN0aXZhdGUoZGV2X3ByaXYpOwo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDcp
Cj4gPiArCQlnZW43X2ZiY19hY3RpdmF0ZShpOTE1KTsKPiA+ICsJZWxzZSBpZiAoSU5URUxfR0VO
KGk5MTUpID49IDUpCj4gPiArCQlpbGtfZmJjX2FjdGl2YXRlKGk5MTUpOwo+ID4gKwllbHNlIGlm
IChJU19HTTQ1KGk5MTUpKQo+ID4gKwkJZzR4X2ZiY19hY3RpdmF0ZShpOTE1KTsKPiA+ICAgCWVs
c2UKPiA+IC0JCWk4eHhfZmJjX2FjdGl2YXRlKGRldl9wcml2KTsKPiA+ICsJCWk4eHhfZmJjX2Fj
dGl2YXRlKGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaW50ZWxfZmJjX2h3X2RlYWN0
aXZhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lk
IGludGVsX2ZiY19od19kZWFjdGl2YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ID4g
KwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+ZmJjOwo+ID4gICAJZmJjLT5hY3RpdmUg
PSBmYWxzZTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNSkKPiA+IC0JCWlsa19m
YmNfZGVhY3RpdmF0ZShkZXZfcHJpdik7Cj4gPiAtCWVsc2UgaWYgKElTX0dNNDUoZGV2X3ByaXYp
KQo+ID4gLQkJZzR4X2ZiY19kZWFjdGl2YXRlKGRldl9wcml2KTsKPiA+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA1KQo+ID4gKwkJaWxrX2ZiY19kZWFjdGl2YXRlKGk5MTUpOwo+ID4gKwllbHNl
IGlmIChJU19HTTQ1KGk5MTUpKQo+ID4gKwkJZzR4X2ZiY19kZWFjdGl2YXRlKGk5MTUpOwo+ID4g
ICAJZWxzZQo+ID4gLQkJaTh4eF9mYmNfZGVhY3RpdmF0ZShkZXZfcHJpdik7Cj4gPiArCQlpOHh4
X2ZiY19kZWFjdGl2YXRlKGk5MTUpOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9m
YmNfaXNfYWN0aXZlIC0gSXMgRkJDIGFjdGl2ZT8KPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2
aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiAgICAq
Cj4gPiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byB2ZXJpZnkgdGhlIGN1cnJlbnQgc3Rh
dGUgb2YgRkJDLgo+ID4gICAgKgo+ID4gICAgKiBGSVhNRTogVGhpcyBzaG91bGQgYmUgdHJhY2tl
ZCBpbiB0aGUgcGxhbmUgY29uZmlnIGV2ZW50dWFsbHkKPiA+ICAgICogaW5zdGVhZCBvZiBxdWVy
aWVkIGF0IHJ1bnRpbWUgZm9yIG1vc3QgY2FsbGVycy4KPiA+ICAgICovCj4gPiAtYm9vbCBpbnRl
bF9mYmNfaXNfYWN0aXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICti
b29sIGludGVsX2ZiY19pc19hY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+IC0JcmV0dXJuIGRldl9wcml2LT5mYmMuYWN0aXZlOwo+ID4gKwlyZXR1cm4gaTkx
NS0+ZmJjLmFjdGl2ZTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGludGVsX2ZiY19kZWFjdGl2
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBp
bnRlbF9mYmNfZGVhY3RpdmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJCSBjb25zdCBjaGFyICpyZWFzb24pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX2ZiYyAq
ZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gPiArCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZpOTE1
LT5mYmM7Cj4gPiAgIAlXQVJOX09OKCFtdXRleF9pc19sb2NrZWQoJmZiYy0+bG9jaykpOwo+ID4g
ICAJaWYgKGZiYy0+YWN0aXZlKQo+ID4gLQkJaW50ZWxfZmJjX2h3X2RlYWN0aXZhdGUoZGV2X3By
aXYpOwo+ID4gKwkJaW50ZWxfZmJjX2h3X2RlYWN0aXZhdGUoaTkxNSk7Cj4gPiAgIAlmYmMtPm5v
X2ZiY19yZWFzb24gPSByZWFzb247Cj4gPiAgIH0KPiA+IEBAIC00MTksMTIgKzQxOSwxMiBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9mYmNfZGVhY3RpdmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiAgIHN0YXRpYyBib29sIG11bHRpcGxlX3BpcGVzX29rKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLAo+ID4gICAJCQkgICAgICBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBs
YW5lX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMg
PSAmZGV2X3ByaXYtPmZiYzsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5
MTUtPmZiYzsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+ICAgCS8qIERv
bid0IGV2ZW4gYm90aGVyIHRyYWNraW5nIGFueXRoaW5nIHdlIGRvbid0IG5lZWQuICovCj4gPiAt
CWlmICghbm9fZmJjX29uX211bHRpcGxlX3BpcGVzKGRldl9wcml2KSkKPiA+ICsJaWYgKCFub19m
YmNfb25fbXVsdGlwbGVfcGlwZXMoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAgIAlp
ZiAocGxhbmVfc3RhdGUtPmJhc2UudmlzaWJsZSkKPiA+IEBAIC00MzUsNyArNDM1LDcgQEAgc3Rh
dGljIGJvb2wgbXVsdGlwbGVfcGlwZXNfb2soc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAg
IAlyZXR1cm4gKGZiYy0+dmlzaWJsZV9waXBlc19tYXNrICYgfigxIDw8IHBpcGUpKSAhPSAwOwo+
ID4gICB9Cj4gPiAtc3RhdGljIGludCBmaW5kX2NvbXByZXNzaW9uX3RocmVzaG9sZChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGludCBmaW5kX2NvbXByZXNz
aW9uX3RocmVzaG9sZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAg
ICAgIHN0cnVjdCBkcm1fbW1fbm9kZSAqbm9kZSwKPiA+ICAgCQkJCSAgICAgIGludCBzaXplLAo+
ID4gICAJCQkJICAgICAgaW50IGZiX2NwcCkKPiA+IEBAIC00NDgsOCArNDQ4LDggQEAgc3RhdGlj
IGludCBmaW5kX2NvbXByZXNzaW9uX3RocmVzaG9sZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiAgIAkgKiByZXNlcnZlZCByYW5nZSBzaXplLCBzbyBpdCBhbHdheXMgYXNz
dW1lcyB0aGUgbWF4aW11bSAoOG1iKSBpcyB1c2VkLgo+ID4gICAJICogSWYgd2UgZW5hYmxlIEZC
QyB1c2luZyBhIENGQiBvbiB0aGF0IG1lbW9yeSByYW5nZSB3ZSdsbCBnZXQgRklGTwo+ID4gICAJ
ICogdW5kZXJydW5zLCBldmVuIGlmIHRoYXQgcmFuZ2UgaXMgbm90IHJlc2VydmVkIGJ5IHRoZSBC
SU9TLiAqLwo+ID4gLQlpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSB8fCBJU19HRU45X0JDKGRl
dl9wcml2KSkKPiA+IC0JCWVuZCA9IHJlc291cmNlX3NpemUoJmRldl9wcml2LT5kc20pIC0gOCAq
IDEwMjQgKiAxMDI0Owo+ID4gKwlpZiAoSVNfQlJPQURXRUxMKGk5MTUpIHx8IElTX0dFTjlfQkMo
aTkxNSkpCj4gPiArCQllbmQgPSByZXNvdXJjZV9zaXplKCZpOTE1LT5kc20pIC0gOCAqIDEwMjQg
KiAxMDI0Owo+ID4gICAJZWxzZQo+ID4gICAJCWVuZCA9IFU2NF9NQVg7Cj4gPiBAQCAtNDYxLDcg
KzQ2MSw3IEBAIHN0YXRpYyBpbnQgZmluZF9jb21wcmVzc2lvbl90aHJlc2hvbGQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJICovCj4gPiAgIAkvKiBUcnkgdG8gb3Zl
ci1hbGxvY2F0ZSB0byByZWR1Y2UgcmVhbGxvY2F0aW9ucyBhbmQgZnJhZ21lbnRhdGlvbi4gKi8K
PiA+IC0JcmV0ID0gaTkxNV9nZW1fc3RvbGVuX2luc2VydF9ub2RlX2luX3JhbmdlKGRldl9wcml2
LCBub2RlLCBzaXplIDw8PSAxLAo+ID4gKwlyZXQgPSBpOTE1X2dlbV9zdG9sZW5faW5zZXJ0X25v
ZGVfaW5fcmFuZ2UoaTkxNSwgbm9kZSwgc2l6ZSA8PD0gMSwKPiA+ICAgCQkJCQkJICAgNDA5Niwg
MCwgZW5kKTsKPiA+ICAgCWlmIChyZXQgPT0gMCkKPiA+ICAgCQlyZXR1cm4gY29tcHJlc3Npb25f
dGhyZXNob2xkOwo+ID4gQEAgLTQ3Miw5ICs0NzIsOSBAQCBzdGF0aWMgaW50IGZpbmRfY29tcHJl
c3Npb25fdGhyZXNob2xkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAg
CSAgICAoZmJfY3BwID09IDIgJiYgY29tcHJlc3Npb25fdGhyZXNob2xkID09IDIpKQo+ID4gICAJ
CXJldHVybiAwOwo+ID4gLQlyZXQgPSBpOTE1X2dlbV9zdG9sZW5faW5zZXJ0X25vZGVfaW5fcmFu
Z2UoZGV2X3ByaXYsIG5vZGUsIHNpemUgPj49IDEsCj4gPiArCXJldCA9IGk5MTVfZ2VtX3N0b2xl
bl9pbnNlcnRfbm9kZV9pbl9yYW5nZShpOTE1LCBub2RlLCBzaXplID4+PSAxLAo+ID4gICAJCQkJ
CQkgICA0MDk2LCAwLCBlbmQpOwo+ID4gLQlpZiAocmV0ICYmIElOVEVMX0dFTihkZXZfcHJpdikg
PD0gNCkgewo+ID4gKwlpZiAocmV0ICYmIElOVEVMX0dFTihpOTE1KSA8PSA0KSB7Cj4gPiAgIAkJ
cmV0dXJuIDA7Cj4gPiAgIAl9IGVsc2UgaWYgKHJldCkgewo+ID4gICAJCWNvbXByZXNzaW9uX3Ro
cmVzaG9sZCA8PD0gMTsKPiA+IEBAIC00ODYsMTcgKzQ4NiwxNyBAQCBzdGF0aWMgaW50IGZpbmRf
Y29tcHJlc3Npb25fdGhyZXNob2xkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICAgc3RhdGljIGludCBpbnRlbF9mYmNfYWxsb2NfY2ZiKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmZGV2
X3ByaXYtPmZiYzsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZi
YzsKPiA+ICAgCXN0cnVjdCBkcm1fbW1fbm9kZSAqdW5pbml0aWFsaXplZF92YXIoY29tcHJlc3Nl
ZF9sbGIpOwo+ID4gICAJaW50IHNpemUsIGZiX2NwcCwgcmV0Owo+ID4gICAJV0FSTl9PTihkcm1f
bW1fbm9kZV9hbGxvY2F0ZWQoJmZiYy0+Y29tcHJlc3NlZF9mYikpOwo+ID4gLQlzaXplID0gaW50
ZWxfZmJjX2NhbGN1bGF0ZV9jZmJfc2l6ZShkZXZfcHJpdiwgJmZiYy0+c3RhdGVfY2FjaGUpOwo+
ID4gKwlzaXplID0gaW50ZWxfZmJjX2NhbGN1bGF0ZV9jZmJfc2l6ZShpOTE1LCAmZmJjLT5zdGF0
ZV9jYWNoZSk7Cj4gPiAgIAlmYl9jcHAgPSBmYmMtPnN0YXRlX2NhY2hlLmZiLmZvcm1hdC0+Y3Bw
WzBdOwo+ID4gLQlyZXQgPSBmaW5kX2NvbXByZXNzaW9uX3RocmVzaG9sZChkZXZfcHJpdiwgJmZi
Yy0+Y29tcHJlc3NlZF9mYiwKPiA+ICsJcmV0ID0gZmluZF9jb21wcmVzc2lvbl90aHJlc2hvbGQo
aTkxNSwgJmZiYy0+Y29tcHJlc3NlZF9mYiwKPiA+ICAgCQkJCQkgc2l6ZSwgZmJfY3BwKTsKPiA+
ICAgCWlmICghcmV0KQo+ID4gICAJCWdvdG8gZXJyX2xsYjsKPiA+IEBAIC01MDcsMzIgKzUwNywz
MiBAQCBzdGF0aWMgaW50IGludGVsX2ZiY19hbGxvY19jZmIoc3RydWN0IGludGVsX2NydGMgKmNy
dGMpCj4gPiAgIAlmYmMtPnRocmVzaG9sZCA9IHJldDsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPj0gNSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA1KQo+ID4gICAJCUk5MTVf
V1JJVEUoSUxLX0RQRkNfQ0JfQkFTRSwgZmJjLT5jb21wcmVzc2VkX2ZiLnN0YXJ0KTsKPiA+IC0J
ZWxzZSBpZiAoSVNfR000NShkZXZfcHJpdikpIHsKPiA+ICsJZWxzZSBpZiAoSVNfR000NShpOTE1
KSkgewo+ID4gICAJCUk5MTVfV1JJVEUoRFBGQ19DQl9CQVNFLCBmYmMtPmNvbXByZXNzZWRfZmIu
c3RhcnQpOwo+ID4gICAJfSBlbHNlIHsKPiA+ICAgCQljb21wcmVzc2VkX2xsYiA9IGt6YWxsb2Mo
c2l6ZW9mKCpjb21wcmVzc2VkX2xsYiksIEdGUF9LRVJORUwpOwo+ID4gICAJCWlmICghY29tcHJl
c3NlZF9sbGIpCj4gPiAgIAkJCWdvdG8gZXJyX2ZiOwo+ID4gLQkJcmV0ID0gaTkxNV9nZW1fc3Rv
bGVuX2luc2VydF9ub2RlKGRldl9wcml2LCBjb21wcmVzc2VkX2xsYiwKPiA+ICsJCXJldCA9IGk5
MTVfZ2VtX3N0b2xlbl9pbnNlcnRfbm9kZShpOTE1LCBjb21wcmVzc2VkX2xsYiwKPiA+ICAgCQkJ
CQkJICA0MDk2LCA0MDk2KTsKPiA+ICAgCQlpZiAocmV0KQo+ID4gICAJCQlnb3RvIGVycl9mYjsK
PiA+ICAgCQlmYmMtPmNvbXByZXNzZWRfbGxiID0gY29tcHJlc3NlZF9sbGI7Cj4gPiAtCQlHRU1f
QlVHX09OKHJhbmdlX292ZXJmbG93c190KHU2NCwgZGV2X3ByaXYtPmRzbS5zdGFydCwKPiA+ICsJ
CUdFTV9CVUdfT04ocmFuZ2Vfb3ZlcmZsb3dzX3QodTY0LCBpOTE1LT5kc20uc3RhcnQsCj4gPiAg
IAkJCQkJICAgICBmYmMtPmNvbXByZXNzZWRfZmIuc3RhcnQsCj4gPiAgIAkJCQkJICAgICBVMzJf
TUFYKSk7Cj4gPiAtCQlHRU1fQlVHX09OKHJhbmdlX292ZXJmbG93c190KHU2NCwgZGV2X3ByaXYt
PmRzbS5zdGFydCwKPiA+ICsJCUdFTV9CVUdfT04ocmFuZ2Vfb3ZlcmZsb3dzX3QodTY0LCBpOTE1
LT5kc20uc3RhcnQsCj4gPiAgIAkJCQkJICAgICBmYmMtPmNvbXByZXNzZWRfbGxiLT5zdGFydCwK
PiA+ICAgCQkJCQkgICAgIFUzMl9NQVgpKTsKPiA+ICAgCQlJOTE1X1dSSVRFKEZCQ19DRkJfQkFT
RSwKPiA+IC0JCQkgICBkZXZfcHJpdi0+ZHNtLnN0YXJ0ICsgZmJjLT5jb21wcmVzc2VkX2ZiLnN0
YXJ0KTsKPiA+ICsJCQkgICBpOTE1LT5kc20uc3RhcnQgKyBmYmMtPmNvbXByZXNzZWRfZmIuc3Rh
cnQpOwo+ID4gICAJCUk5MTVfV1JJVEUoRkJDX0xMX0JBU0UsCj4gPiAtCQkJICAgZGV2X3ByaXYt
PmRzbS5zdGFydCArIGNvbXByZXNzZWRfbGxiLT5zdGFydCk7Cj4gPiArCQkJICAgaTkxNS0+ZHNt
LnN0YXJ0ICsgY29tcHJlc3NlZF9sbGItPnN0YXJ0KTsKPiA+ICAgCX0KPiA+ICAgCURSTV9ERUJV
R19LTVMoInJlc2VydmVkICVsbHUgYnl0ZXMgb2YgY29udGlndW91cyBzdG9sZW4gc3BhY2UgZm9y
IEZCQywgdGhyZXNob2xkOiAlZFxuIiwKPiA+IEBAIC01NDIsMzkgKzU0MiwzOSBAQCBzdGF0aWMg
aW50IGludGVsX2ZiY19hbGxvY19jZmIoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIGVy
cl9mYjoKPiA+ICAgCWtmcmVlKGNvbXByZXNzZWRfbGxiKTsKPiA+IC0JaTkxNV9nZW1fc3RvbGVu
X3JlbW92ZV9ub2RlKGRldl9wcml2LCAmZmJjLT5jb21wcmVzc2VkX2ZiKTsKPiA+ICsJaTkxNV9n
ZW1fc3RvbGVuX3JlbW92ZV9ub2RlKGk5MTUsICZmYmMtPmNvbXByZXNzZWRfZmIpOwo+ID4gICBl
cnJfbGxiOgo+ID4gLQlpZiAoZHJtX21tX2luaXRpYWxpemVkKCZkZXZfcHJpdi0+bW0uc3RvbGVu
KSkKPiA+ICsJaWYgKGRybV9tbV9pbml0aWFsaXplZCgmaTkxNS0+bW0uc3RvbGVuKSkKPiA+ICAg
CQlwcl9pbmZvX29uY2UoImRybTogbm90IGVub3VnaCBzdG9sZW4gc3BhY2UgZm9yIGNvbXByZXNz
ZWQgYnVmZmVyIChuZWVkICVkIG1vcmUgYnl0ZXMpLCBkaXNhYmxpbmcuIEhpbnQ6IHlvdSBtYXkg
YmUgYWJsZSB0byBpbmNyZWFzZSBzdG9sZW4gbWVtb3J5IHNpemUgaW4gdGhlIEJJT1MgdG8gYXZv
aWQgdGhpcy5cbiIsIHNpemUpOwo+ID4gICAJcmV0dXJuIC1FTk9TUEM7Cj4gPiAgIH0KPiA+IC1z
dGF0aWMgdm9pZCBfX2ludGVsX2ZiY19jbGVhbnVwX2NmYihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgX19pbnRlbF9mYmNfY2xlYW51cF9jZmIoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX2Zi
YyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gPiArCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZp
OTE1LT5mYmM7Cj4gPiAgIAlpZiAoZHJtX21tX25vZGVfYWxsb2NhdGVkKCZmYmMtPmNvbXByZXNz
ZWRfZmIpKQo+ID4gLQkJaTkxNV9nZW1fc3RvbGVuX3JlbW92ZV9ub2RlKGRldl9wcml2LCAmZmJj
LT5jb21wcmVzc2VkX2ZiKTsKPiA+ICsJCWk5MTVfZ2VtX3N0b2xlbl9yZW1vdmVfbm9kZShpOTE1
LCAmZmJjLT5jb21wcmVzc2VkX2ZiKTsKPiA+ICAgCWlmIChmYmMtPmNvbXByZXNzZWRfbGxiKSB7
Cj4gPiAtCQlpOTE1X2dlbV9zdG9sZW5fcmVtb3ZlX25vZGUoZGV2X3ByaXYsIGZiYy0+Y29tcHJl
c3NlZF9sbGIpOwo+ID4gKwkJaTkxNV9nZW1fc3RvbGVuX3JlbW92ZV9ub2RlKGk5MTUsIGZiYy0+
Y29tcHJlc3NlZF9sbGIpOwo+ID4gICAJCWtmcmVlKGZiYy0+Y29tcHJlc3NlZF9sbGIpOwo+ID4g
ICAJfQo+ID4gICB9Cj4gPiAtdm9pZCBpbnRlbF9mYmNfY2xlYW51cF9jZmIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfZmJjX2NsZWFudXBfY2ZiKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9m
YmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAm
aTkxNS0+ZmJjOwo+ID4gLQlpZiAoIWZiY19zdXBwb3J0ZWQoZGV2X3ByaXYpKQo+ID4gKwlpZiAo
IWZiY19zdXBwb3J0ZWQoaTkxNSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJbXV0ZXhfbG9jaygm
ZmJjLT5sb2NrKTsKPiA+IC0JX19pbnRlbF9mYmNfY2xlYW51cF9jZmIoZGV2X3ByaXYpOwo+ID4g
KwlfX2ludGVsX2ZiY19jbGVhbnVwX2NmYihpOTE1KTsKPiA+ICAgCW11dGV4X3VubG9jaygmZmJj
LT5sb2NrKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIHN0cmlkZV9pc192YWxpZChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGJvb2wgc3RyaWRlX2lzX3Zh
bGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgdW5zaWduZWQg
aW50IHN0cmlkZSkKPiA+ICAgewo+ID4gICAJLyogVGhpcyBzaG91bGQgaGF2ZSBiZWVuIGNhdWdo
dCBlYXJsaWVyLiAqLwo+ID4gQEAgLTU4NSwxMCArNTg1LDEwIEBAIHN0YXRpYyBib29sIHN0cmlk
ZV9pc192YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlpZiAo
c3RyaWRlIDwgNTEyKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IC0JaWYgKElTX0dFTihkZXZf
cHJpdiwgMikgfHwgSVNfR0VOKGRldl9wcml2LCAzKSkKPiA+ICsJaWYgKElTX0dFTihpOTE1LCAy
KSB8fCBJU19HRU4oaTkxNSwgMykpCj4gPiAgIAkJcmV0dXJuIHN0cmlkZSA9PSA0MDk2IHx8IHN0
cmlkZSA9PSA4MTkyOwo+ID4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA0KSAmJiAhSVNfRzRYKGRl
dl9wcml2KSAmJiBzdHJpZGUgPCAyMDQ4KQo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDQpICYmICFJ
U19HNFgoaTkxNSkgJiYgc3RyaWRlIDwgMjA0OCkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAg
IAlpZiAoc3RyaWRlID4gMTYzODQpCj4gPiBAQCAtNTk3LDcgKzU5Nyw3IEBAIHN0YXRpYyBib29s
IHN0cmlkZV9pc192YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAg
IAlyZXR1cm4gdHJ1ZTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIHBpeGVsX2Zvcm1hdF9pc192
YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGJvb2wg
cGl4ZWxfZm9ybWF0X2lzX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4g
ICAJCQkJICB1MzIgcGl4ZWxfZm9ybWF0KQo+ID4gICB7Cj4gPiAgIAlzd2l0Y2ggKHBpeGVsX2Zv
cm1hdCkgewo+ID4gQEAgLTYwNywxMCArNjA3LDEwIEBAIHN0YXRpYyBib29sIHBpeGVsX2Zvcm1h
dF9pc192YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAljYXNl
IERSTV9GT1JNQVRfWFJHQjE1NTU6Cj4gPiAgIAljYXNlIERSTV9GT1JNQVRfUkdCNTY1Ogo+ID4g
ICAJCS8qIDE2YnBwIG5vdCBzdXBwb3J0ZWQgb24gZ2VuMiAqLwo+ID4gLQkJaWYgKElTX0dFTihk
ZXZfcHJpdiwgMikpCj4gPiArCQlpZiAoSVNfR0VOKGk5MTUsIDIpKQo+ID4gICAJCQlyZXR1cm4g
ZmFsc2U7Cj4gPiAgIAkJLyogV2FGYmNPbmx5MXRvMVJhdGlvOmN0ZyAqLwo+ID4gLQkJaWYgKElT
X0c0WChkZXZfcHJpdikpCj4gPiArCQlpZiAoSVNfRzRYKGk5MTUpKQo+ID4gICAJCQlyZXR1cm4g
ZmFsc2U7Cj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAgIAlkZWZhdWx0Ogo+ID4gQEAgLTYyNiwx
NyArNjI2LDE3IEBAIHN0YXRpYyBib29sIHBpeGVsX2Zvcm1hdF9pc192YWxpZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgYm9vbCBpbnRl
bF9mYmNfaHdfdHJhY2tpbmdfY292ZXJzX3NjcmVlbihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPiA+IC0Jc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2
LT5mYmM7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZpOTE1LT5mYmM7Cj4g
PiAgIAl1bnNpZ25lZCBpbnQgZWZmZWN0aXZlX3csIGVmZmVjdGl2ZV9oLCBtYXhfdywgbWF4X2g7
Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoZGV2
X3ByaXYpKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTAgfHwgSVNfR0VNSU5JTEFL
RShpOTE1KSkgewo+ID4gICAJCW1heF93ID0gNTEyMDsKPiA+ICAgCQltYXhfaCA9IDQwOTY7Cj4g
PiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4IHx8IElTX0hBU1dFTEwoZGV2
X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDggfHwgSVNfSEFT
V0VMTChpOTE1KSkgewo+ID4gICAJCW1heF93ID0gNDA5NjsKPiA+ICAgCQltYXhfaCA9IDQwOTY7
Cj4gPiAtCX0gZWxzZSBpZiAoSVNfRzRYKGRldl9wcml2KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDUpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19HNFgoaTkxNSkgfHwgSU5URUxfR0VOKGk5MTUp
ID49IDUpIHsKPiA+ICAgCQltYXhfdyA9IDQwOTY7Cj4gPiAgIAkJbWF4X2ggPSAyMDQ4Owo+ID4g
ICAJfSBlbHNlIHsKPiA+IEBAIC02NTYsOCArNjU2LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZmJj
X3VwZGF0ZV9zdGF0ZV9jYWNoZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJCQkg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQkJIHN0cnVjdCBp
bnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAtCXN0
cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3Qg
aW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+ZmJjOwo+ID4gICAJc3RydWN0IGludGVsX2ZiY19zdGF0
ZV9jYWNoZSAqY2FjaGUgPSAmZmJjLT5zdGF0ZV9jYWNoZTsKPiA+ICAgCXN0cnVjdCBkcm1fZnJh
bWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7Cj4gPiBAQCAtNjY1LDcgKzY2NSw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX2ZiY191cGRhdGVfc3RhdGVfY2FjaGUoc3RydWN0IGludGVs
X2NydGMgKmNydGMsCj4gPiAgIAljYWNoZS0+ZmxhZ3MgPSAwOwo+ID4gICAJY2FjaGUtPmNydGMu
bW9kZV9mbGFncyA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFnczsKPiA+IC0J
aWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpCj4gPiAr
CWlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkKPiA+ICAgCQljYWNo
ZS0+Y3J0Yy5oc3dfYmR3X3BpeGVsX3JhdGUgPSBjcnRjX3N0YXRlLT5waXhlbF9yYXRlOwo+ID4g
ICAJY2FjaGUtPnBsYW5lLnJvdGF0aW9uID0gcGxhbmVfc3RhdGUtPmJhc2Uucm90YXRpb247Cj4g
PiBAQCAtNjk3LDggKzY5Nyw4IEBAIHN0YXRpYyB2b2lkIGludGVsX2ZiY191cGRhdGVfc3RhdGVf
Y2FjaGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIHN0YXRpYyBib29sIGludGVsX2Zi
Y19jYW5fYWN0aXZhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4gPiAtCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4g
KwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+ZmJjOwo+ID4gICAJc3RydWN0IGludGVs
X2ZiY19zdGF0ZV9jYWNoZSAqY2FjaGUgPSAmZmJjLT5zdGF0ZV9jYWNoZTsKPiA+ICAgCS8qIFdl
IGRvbid0IG5lZWQgdG8gdXNlIGEgc3RhdGUgY2FjaGUgaGVyZSBzaW5jZSB0aGlzIGluZm9ybWF0
aW9uIGlzCj4gPiBAQCAtNzQxLDE4ICs3NDEsMTggQEAgc3RhdGljIGJvb2wgaW50ZWxfZmJjX2Nh
bl9hY3RpdmF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiA+ICAgCQlmYmMtPm5vX2ZiY19y
ZWFzb24gPSAiZnJhbWVidWZmZXIgbm90IHRpbGVkIG9yIGZlbmNlZCI7Cj4gPiAgIAkJcmV0dXJu
IGZhbHNlOwo+ID4gICAJfQo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8PSA0ICYmICFJ
U19HNFgoZGV2X3ByaXYpICYmCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPD0gNCAmJiAhSVNf
RzRYKGk5MTUpICYmCj4gPiAgIAkgICAgY2FjaGUtPnBsYW5lLnJvdGF0aW9uICE9IERSTV9NT0RF
X1JPVEFURV8wKSB7Cj4gPiAgIAkJZmJjLT5ub19mYmNfcmVhc29uID0gInJvdGF0aW9uIHVuc3Vw
cG9ydGVkIjsKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAl9Cj4gPiAtCWlmICghc3RyaWRl
X2lzX3ZhbGlkKGRldl9wcml2LCBjYWNoZS0+ZmIuc3RyaWRlKSkgewo+ID4gKwlpZiAoIXN0cmlk
ZV9pc192YWxpZChpOTE1LCBjYWNoZS0+ZmIuc3RyaWRlKSkgewo+ID4gICAJCWZiYy0+bm9fZmJj
X3JlYXNvbiA9ICJmcmFtZWJ1ZmZlciBzdHJpZGUgbm90IHN1cHBvcnRlZCI7Cj4gPiAgIAkJcmV0
dXJuIGZhbHNlOwo+ID4gICAJfQo+ID4gLQlpZiAoIXBpeGVsX2Zvcm1hdF9pc192YWxpZChkZXZf
cHJpdiwgY2FjaGUtPmZiLmZvcm1hdC0+Zm9ybWF0KSkgewo+ID4gKwlpZiAoIXBpeGVsX2Zvcm1h
dF9pc192YWxpZChpOTE1LCBjYWNoZS0+ZmIuZm9ybWF0LT5mb3JtYXQpKSB7Cj4gPiAgIAkJZmJj
LT5ub19mYmNfcmVhc29uID0gInBpeGVsIGZvcm1hdCBpcyBpbnZhbGlkIjsKPiA+ICAgCQlyZXR1
cm4gZmFsc2U7Cj4gPiAgIAl9Cj4gPiBAQCAtNzY0LDggKzc2NCw4IEBAIHN0YXRpYyBib29sIGlu
dGVsX2ZiY19jYW5fYWN0aXZhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIAl9Cj4g
PiAgIAkvKiBXYUZiY0V4Y2VlZENkQ2xvY2tUaHJlc2hvbGQ6aHN3LGJkdyAqLwo+ID4gLQlpZiAo
KElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpICYmCj4gPiAt
CSAgICBjYWNoZS0+Y3J0Yy5oc3dfYmR3X3BpeGVsX3JhdGUgPj0gZGV2X3ByaXYtPmNkY2xrLmh3
LmNkY2xrICogOTUgLyAxMDApIHsKPiA+ICsJaWYgKChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JS
T0FEV0VMTChpOTE1KSkgJiYKPiA+ICsJICAgIGNhY2hlLT5jcnRjLmhzd19iZHdfcGl4ZWxfcmF0
ZSA+PSBpOTE1LT5jZGNsay5ody5jZGNsayAqIDk1IC8gMTAwKSB7Cj4gPiAgIAkJZmJjLT5ub19m
YmNfcmVhc29uID0gInBpeGVsIHJhdGUgaXMgdG9vIGJpZyI7Cj4gPiAgIAkJcmV0dXJuIGZhbHNl
Owo+ID4gICAJfQo+ID4gQEAgLTc4MCw3ICs3ODAsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9mYmNf
Y2FuX2FjdGl2YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ID4gICAJICogd2UgZGlkbid0
IGdldCBhbnkgaW52YWxpZGF0ZS9kZWFjdGl2YXRlIGNhbGxzLCBidXQgdGhpcyB3b3VsZCByZXF1
aXJlCj4gPiAgIAkgKiBhIGxvdCBvZiB0cmFja2luZyBqdXN0IGZvciBhIHNwZWNpZmljIGNhc2Uu
IElmIHdlIGNvbmNsdWRlIGl0J3MgYW4KPiA+ICAgCSAqIGltcG9ydGFudCBjYXNlLCB3ZSBjYW4g
aW1wbGVtZW50IGl0IGxhdGVyLiAqLwo+ID4gLQlpZiAoaW50ZWxfZmJjX2NhbGN1bGF0ZV9jZmJf
c2l6ZShkZXZfcHJpdiwgJmZiYy0+c3RhdGVfY2FjaGUpID4KPiA+ICsJaWYgKGludGVsX2ZiY19j
YWxjdWxhdGVfY2ZiX3NpemUoaTkxNSwgJmZiYy0+c3RhdGVfY2FjaGUpID4KPiA+ICAgCSAgICBm
YmMtPmNvbXByZXNzZWRfZmIuc2l6ZSAqIGZiYy0+dGhyZXNob2xkKSB7Cj4gPiAgIAkJZmJjLT5u
b19mYmNfcmVhc29uID0gIkNGQiByZXF1aXJlbWVudHMgY2hhbmdlZCI7Cj4gPiAgIAkJcmV0dXJu
IGZhbHNlOwo+ID4gQEAgLTc5MSw3ICs3OTEsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9mYmNfY2Fu
X2FjdGl2YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ID4gICAJICogaGF2aW5nIGEgWSBv
ZmZzZXQgdGhhdCBpc24ndCBkaXZpc2libGUgYnkgNCBjYXVzZXMgRklGTyB1bmRlcnJ1bgo+ID4g
ICAJICogYW5kIHNjcmVlbiBmbGlja2VyLgo+ID4gICAJICovCj4gPiAtCWlmIChJU19HRU5fUkFO
R0UoZGV2X3ByaXYsIDksIDEwKSAmJgo+ID4gKwlpZiAoSVNfR0VOX1JBTkdFKGk5MTUsIDksIDEw
KSAmJgo+ID4gICAJICAgIChmYmMtPnN0YXRlX2NhY2hlLnBsYW5lLmFkanVzdGVkX3kgJiAzKSkg
ewo+ID4gICAJCWZiYy0+bm9fZmJjX3JlYXNvbiA9ICJwbGFuZSBZIG9mZnNldCBpcyBtaXNhbGln
bmVkIjsKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiBAQCAtODAwLDExICs4MDAsMTEgQEAgc3Rh
dGljIGJvb2wgaW50ZWxfZmJjX2Nhbl9hY3RpdmF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykK
PiA+ICAgCXJldHVybiB0cnVlOwo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wgaW50ZWxfZmJjX2Nh
bl9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBi
b29sIGludGVsX2ZiY19jYW5fZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ID4g
KwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+ZmJjOwo+ID4gLQlpZiAoaW50ZWxfdmdw
dV9hY3RpdmUoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShpOTE1KSkg
ewo+ID4gICAJCWZiYy0+bm9fZmJjX3JlYXNvbiA9ICJWR1BVIGlzIGFjdGl2ZSI7Cj4gPiAgIAkJ
cmV0dXJuIGZhbHNlOwo+ID4gICAJfQo+ID4gQEAgLTgyNSw4ICs4MjUsOCBAQCBzdGF0aWMgYm9v
bCBpbnRlbF9mYmNfY2FuX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2ZiY19nZXRfcmVnX3BhcmFtcyhzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiA+ICAgCQkJCSAgICAgc3RydWN0IGludGVsX2ZiY19yZWdfcGFyYW1zICpw
YXJhbXMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAtCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZk
ZXZfcHJpdi0+ZmJjOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+
ZmJjOwo+ID4gICAJc3RydWN0IGludGVsX2ZiY19zdGF0ZV9jYWNoZSAqY2FjaGUgPSAmZmJjLT5z
dGF0ZV9jYWNoZTsKPiA+ICAgCS8qIFNpbmNlIGFsbCBvdXIgZmllbGRzIGFyZSBpbnRlZ2VyIHR5
cGVzLCB1c2UgbWVtc2V0IGhlcmUgc28gdGhlCj4gPiBAQCAtODQ0LDkgKzg0NCw5IEBAIHN0YXRp
YyB2b2lkIGludGVsX2ZiY19nZXRfcmVnX3BhcmFtcyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywK
PiA+ICAgCXBhcmFtcy0+ZmIuZm9ybWF0ID0gY2FjaGUtPmZiLmZvcm1hdDsKPiA+ICAgCXBhcmFt
cy0+ZmIuc3RyaWRlID0gY2FjaGUtPmZiLnN0cmlkZTsKPiA+IC0JcGFyYW1zLT5jZmJfc2l6ZSA9
IGludGVsX2ZiY19jYWxjdWxhdGVfY2ZiX3NpemUoZGV2X3ByaXYsIGNhY2hlKTsKPiA+ICsJcGFy
YW1zLT5jZmJfc2l6ZSA9IGludGVsX2ZiY19jYWxjdWxhdGVfY2ZiX3NpemUoaTkxNSwgY2FjaGUp
Owo+ID4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA5KSAmJiAhSVNfR0VNSU5JTEFLRShkZXZfcHJp
dikpCj4gPiArCWlmIChJU19HRU4oaTkxNSwgOSkgJiYgIUlTX0dFTUlOSUxBS0UoaTkxNSkpCj4g
PiAgIAkJcGFyYW1zLT5nZW45X3dhX2NmYl9zdHJpZGUgPSBESVZfUk9VTkRfVVAoY2FjaGUtPnBs
YW5lLnNyY193LAo+ID4gICAJCQkJCQkzMiAqIGZiYy0+dGhyZXNob2xkKSAqIDg7Cj4gPiAgIH0K
PiA+IEBAIC04NTUsMTEgKzg1NSwxMSBAQCB2b2lkIGludGVsX2ZiY19wcmVfdXBkYXRlKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAo+ID4gICAJCQkgIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3Rh
dGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAtCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZf
cHJpdi0+ZmJjOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmaTkxNS0+ZmJj
Owo+ID4gICAJY29uc3QgY2hhciAqcmVhc29uID0gInVwZGF0ZSBwZW5kaW5nIjsKPiA+IC0JaWYg
KCFmYmNfc3VwcG9ydGVkKGRldl9wcml2KSkKPiA+ICsJaWYgKCFmYmNfc3VwcG9ydGVkKGk5MTUp
KQo+ID4gICAJCXJldHVybjsKPiA+ICAgCW11dGV4X2xvY2soJmZiYy0+bG9jayk7Cj4gPiBAQCAt
ODc2LDIxICs4NzYsMjEgQEAgdm9pZCBpbnRlbF9mYmNfcHJlX3VwZGF0ZShzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPiA+ICAgCWZiYy0+ZmxpcF9wZW5kaW5nID0gdHJ1ZTsKPiA+ICAgZGVhY3Rp
dmF0ZToKPiA+IC0JaW50ZWxfZmJjX2RlYWN0aXZhdGUoZGV2X3ByaXYsIHJlYXNvbik7Cj4gPiAr
CWludGVsX2ZiY19kZWFjdGl2YXRlKGk5MTUsIHJlYXNvbik7Cj4gPiAgIHVubG9jazoKPiA+ICAg
CW11dGV4X3VubG9jaygmZmJjLT5sb2NrKTsKPiA+ICAgfQo+ID4gICAvKioKPiA+ICAgICogX19p
bnRlbF9mYmNfZGlzYWJsZSAtIGRpc2FibGUgRkJDCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRl
dmljZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gICAg
Kgo+ID4gICAgKiBUaGlzIGlzIHRoZSBsb3cgbGV2ZWwgZnVuY3Rpb24gdGhhdCBhY3R1YWxseSBk
aXNhYmxlcyBGQkMuIENhbGxlcnMgc2hvdWxkCj4gPiAgICAqIGdyYWIgdGhlIEZCQyBsb2NrLgo+
ID4gICAgKi8KPiA+IC1zdGF0aWMgdm9pZCBfX2ludGVsX2ZiY19kaXNhYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBfX2ludGVsX2ZiY19kaXNh
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBp
bnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpm
YmMgPSAmaTkxNS0+ZmJjOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBmYmMtPmNy
dGM7Cj4gPiAgIAlXQVJOX09OKCFtdXRleF9pc19sb2NrZWQoJmZiYy0+bG9jaykpOwo+ID4gQEAg
LTg5OSw3ICs4OTksNyBAQCBzdGF0aWMgdm9pZCBfX2ludGVsX2ZiY19kaXNhYmxlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCURSTV9ERUJVR19LTVMoIkRpc2FibGlu
ZyBGQkMgb24gcGlwZSAlY1xuIiwgcGlwZV9uYW1lKGNydGMtPnBpcGUpKTsKPiA+IC0JX19pbnRl
bF9mYmNfY2xlYW51cF9jZmIoZGV2X3ByaXYpOwo+ID4gKwlfX2ludGVsX2ZiY19jbGVhbnVwX2Nm
YihpOTE1KTsKPiA+ICAgCWZiYy0+ZW5hYmxlZCA9IGZhbHNlOwo+ID4gICAJZmJjLT5jcnRjID0g
TlVMTDsKPiA+IEBAIC05MDcsOCArOTA3LDggQEAgc3RhdGljIHZvaWQgX19pbnRlbF9mYmNfZGlz
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIHN0YXRpYyB2b2lk
IF9faW50ZWxfZmJjX3Bvc3RfdXBkYXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+ID4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmZGV2X3ByaXYtPmZiYzsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPiA+ICsJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiA+ICAgCVdB
Uk5fT04oIW11dGV4X2lzX2xvY2tlZCgmZmJjLT5sb2NrKSk7Cj4gPiBAQCAtOTE5LDggKzkxOSw4
IEBAIHN0YXRpYyB2b2lkIF9faW50ZWxfZmJjX3Bvc3RfdXBkYXRlKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjKQo+ID4gICAJV0FSTl9PTihmYmMtPmFjdGl2ZSk7Cj4gPiAgIAlpZiAoIWk5MTVfbW9k
cGFyYW1zLmVuYWJsZV9mYmMpIHsKPiA+IC0JCWludGVsX2ZiY19kZWFjdGl2YXRlKGRldl9wcml2
LCAiZGlzYWJsZWQgYXQgcnVudGltZSBwZXIgbW9kdWxlIHBhcmFtIik7Cj4gPiAtCQlfX2ludGVs
X2ZiY19kaXNhYmxlKGRldl9wcml2KTsKPiA+ICsJCWludGVsX2ZiY19kZWFjdGl2YXRlKGk5MTUs
ICJkaXNhYmxlZCBhdCBydW50aW1lIHBlciBtb2R1bGUgcGFyYW0iKTsKPiA+ICsJCV9faW50ZWxf
ZmJjX2Rpc2FibGUoaTkxNSk7Cj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJfQo+ID4gQEAgLTkzMSwx
OCArOTMxLDE4IEBAIHN0YXRpYyB2b2lkIF9faW50ZWxfZmJjX3Bvc3RfdXBkYXRlKHN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCWlmICghZmJjLT5idXN5X2Jp
dHMpIHsKPiA+IC0JCWludGVsX2ZiY19kZWFjdGl2YXRlKGRldl9wcml2LCAiRkJDIGVuYWJsZWQg
KGFjdGl2ZSBvciBzY2hlZHVsZWQpIik7Cj4gPiAtCQlpbnRlbF9mYmNfaHdfYWN0aXZhdGUoZGV2
X3ByaXYpOwo+ID4gKwkJaW50ZWxfZmJjX2RlYWN0aXZhdGUoaTkxNSwgIkZCQyBlbmFibGVkIChh
Y3RpdmUgb3Igc2NoZWR1bGVkKSIpOwo+ID4gKwkJaW50ZWxfZmJjX2h3X2FjdGl2YXRlKGk5MTUp
Owo+ID4gICAJfSBlbHNlCj4gPiAtCQlpbnRlbF9mYmNfZGVhY3RpdmF0ZShkZXZfcHJpdiwgImZy
b250YnVmZmVyIHdyaXRlIik7Cj4gPiArCQlpbnRlbF9mYmNfZGVhY3RpdmF0ZShpOTE1LCAiZnJv
bnRidWZmZXIgd3JpdGUiKTsKPiA+ICAgfQo+ID4gICB2b2lkIGludGVsX2ZiY19wb3N0X3VwZGF0
ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+IC0Jc3RydWN0
IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBpbnRl
bF9mYmMgKmZiYyA9ICZpOTE1LT5mYmM7Cj4gPiAtCWlmICghZmJjX3N1cHBvcnRlZChkZXZfcHJp
dikpCj4gPiArCWlmICghZmJjX3N1cHBvcnRlZChpOTE1KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAg
IAltdXRleF9sb2NrKCZmYmMtPmxvY2spOwo+ID4gQEAgLTk1OCwxMyArOTU4LDEzIEBAIHN0YXRp
YyB1bnNpZ25lZCBpbnQgaW50ZWxfZmJjX2dldF9mcm9udGJ1ZmZlcl9iaXQoc3RydWN0IGludGVs
X2ZiYyAqZmJjKQo+ID4gICAJCXJldHVybiBmYmMtPnBvc3NpYmxlX2ZyYW1lYnVmZmVyX2JpdHM7
Cj4gPiAgIH0KPiA+IC12b2lkIGludGVsX2ZiY19pbnZhbGlkYXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2ZiY19pbnZhbGlkYXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZl
cl9iaXRzLAo+ID4gICAJCQkgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbikKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmZGV2X3ByaXYtPmZiYzsKPiA+ICsJc3RydWN0IGlu
dGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiA+IC0JaWYgKCFmYmNfc3VwcG9ydGVkKGRldl9w
cml2KSkKPiA+ICsJaWYgKCFmYmNfc3VwcG9ydGVkKGk5MTUpKQo+ID4gICAJCXJldHVybjsKPiA+
ICAgCWlmIChvcmlnaW4gPT0gT1JJR0lOX0dUVCB8fCBvcmlnaW4gPT0gT1JJR0lOX0ZMSVApCj4g
PiBAQCAtOTc1LDE3ICs5NzUsMTcgQEAgdm9pZCBpbnRlbF9mYmNfaW52YWxpZGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlmYmMtPmJ1c3lfYml0cyB8PSBpbnRl
bF9mYmNfZ2V0X2Zyb250YnVmZmVyX2JpdChmYmMpICYgZnJvbnRidWZmZXJfYml0czsKPiA+ICAg
CWlmIChmYmMtPmVuYWJsZWQgJiYgZmJjLT5idXN5X2JpdHMpCj4gPiAtCQlpbnRlbF9mYmNfZGVh
Y3RpdmF0ZShkZXZfcHJpdiwgImZyb250YnVmZmVyIHdyaXRlIik7Cj4gPiArCQlpbnRlbF9mYmNf
ZGVhY3RpdmF0ZShpOTE1LCAiZnJvbnRidWZmZXIgd3JpdGUiKTsKPiA+ICAgCW11dGV4X3VubG9j
aygmZmJjLT5sb2NrKTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfZmJjX2ZsdXNoKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2ZiY19mbHVzaChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkgICAgIHVuc2lnbmVkIGludCBmcm9u
dGJ1ZmZlcl9iaXRzLCBlbnVtIGZiX29wX29yaWdpbiBvcmlnaW4pCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gPiArCXN0cnVjdCBpbnRlbF9m
YmMgKmZiYyA9ICZpOTE1LT5mYmM7Cj4gPiAtCWlmICghZmJjX3N1cHBvcnRlZChkZXZfcHJpdikp
Cj4gPiArCWlmICghZmJjX3N1cHBvcnRlZChpOTE1KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAlt
dXRleF9sb2NrKCZmYmMtPmxvY2spOwo+ID4gQEAgLTk5OCw3ICs5OTgsNyBAQCB2b2lkIGludGVs
X2ZiY19mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlpZiAo
IWZiYy0+YnVzeV9iaXRzICYmIGZiYy0+ZW5hYmxlZCAmJgo+ID4gICAJICAgIChmcm9udGJ1ZmZl
cl9iaXRzICYgaW50ZWxfZmJjX2dldF9mcm9udGJ1ZmZlcl9iaXQoZmJjKSkpIHsKPiA+ICAgCQlp
ZiAoZmJjLT5hY3RpdmUpCj4gPiAtCQkJaW50ZWxfZmJjX3JlY29tcHJlc3MoZGV2X3ByaXYpOwo+
ID4gKwkJCWludGVsX2ZiY19yZWNvbXByZXNzKGk5MTUpOwo+ID4gICAJCWVsc2UgaWYgKCFmYmMt
PmZsaXBfcGVuZGluZykKPiA+ICAgCQkJX19pbnRlbF9mYmNfcG9zdF91cGRhdGUoZmJjLT5jcnRj
KTsKPiA+ICAgCX0KPiA+IEBAIC0xMDA5LDcgKzEwMDksNyBAQCB2b2lkIGludGVsX2ZiY19mbHVz
aChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIC8qKgo+ID4gICAgKiBp
bnRlbF9mYmNfY2hvb3NlX2NydGMgLSBzZWxlY3QgYSBDUlRDIHRvIGVuYWJsZSBGQkMgb24KPiA+
IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUg
ZGV2aWNlIGluc3RhbmNlCj4gPiAgICAqIEBzdGF0ZTogdGhlIGF0b21pYyBzdGF0ZSBzdHJ1Y3R1
cmUKPiA+ICAgICoKPiA+ICAgICogVGhpcyBmdW5jdGlvbiBsb29rcyBhdCB0aGUgcHJvcG9zZWQg
c3RhdGUgZm9yIENSVENzIGFuZCBwbGFuZXMsIHRoZW4gY2hvb3Nlcwo+ID4gQEAgLTEwMTcsMTIg
KzEwMTcsMTIgQEAgdm9pZCBpbnRlbF9mYmNfZmx1c2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gICAgKiB0cnVlLgo+ID4gICAgKgo+ID4gICAgKiBMYXRlciwgaW50ZWxf
ZmJjX2VuYWJsZSBpcyBnb2luZyB0byBsb29rIGZvciBzdGF0ZS0+ZW5hYmxlX2ZiYyBhbmQgdGhl
biBtYXliZQo+ID4gLSAqIGVuYWJsZSBGQkMgZm9yIHRoZSBjaG9zZW4gQ1JUQy4gSWYgaXQgZG9l
cywgaXQgd2lsbCBzZXQgZGV2X3ByaXYtPmZiYy5jcnRjLgo+ID4gKyAqIGVuYWJsZSBGQkMgZm9y
IHRoZSBjaG9zZW4gQ1JUQy4gSWYgaXQgZG9lcywgaXQgd2lsbCBzZXQgaTkxNS0+ZmJjLmNydGMu
Cj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfZmJjX2Nob29zZV9jcnRjKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2ZiY19jaG9vc2VfY3J0YyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgc3RydWN0IGludGVsX2F0b21p
Y19zdGF0ZSAqc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRl
dl9wcml2LT5mYmM7Cj4gPiArCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZpOTE1LT5mYmM7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lOwo+ID4gICAJc3RydWN0IGludGVsX3BsYW5l
X3N0YXRlICpwbGFuZV9zdGF0ZTsKPiA+ICAgCWJvb2wgY3J0Y19jaG9zZW4gPSBmYWxzZTsKPiA+
IEBAIC0xMDM1LDcgKzEwMzUsNyBAQCB2b2lkIGludGVsX2ZiY19jaG9vc2VfY3J0YyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkgICAgIWludGVsX2F0b21pY19nZXRf
bmV3X2NydGNfc3RhdGUoc3RhdGUsIGZiYy0+Y3J0YykpCj4gPiAgIAkJZ290byBvdXQ7Cj4gPiAt
CWlmICghaW50ZWxfZmJjX2Nhbl9lbmFibGUoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIWludGVsX2Zi
Y19jYW5fZW5hYmxlKGk5MTUpKQo+ID4gICAJCWdvdG8gb3V0Owo+ID4gICAJLyogU2ltcGx5IGNo
b29zZSB0aGUgZmlyc3QgQ1JUQyB0aGF0IGlzIGNvbXBhdGlibGUgYW5kIGhhcyBhIHZpc2libGUK
PiA+IEBAIC0xMDgxLDEwICsxMDgxLDEwIEBAIHZvaWQgaW50ZWxfZmJjX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPiA+ICAgCQkgICAgICBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAm
ZGV2X3ByaXYtPmZiYzsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUt
PmZiYzsKPiA+IC0JaWYgKCFmYmNfc3VwcG9ydGVkKGRldl9wcml2KSkKPiA+ICsJaWYgKCFmYmNf
c3VwcG9ydGVkKGk5MTUpKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCW11dGV4X2xvY2soJmZiYy0+
bG9jayk7Cj4gPiBAQCAtMTEyNyw0NCArMTEyNyw0NCBAQCB2b2lkIGludGVsX2ZiY19lbmFibGUo
c3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgICAqLwo+ID4gICB2b2lkIGludGVsX2ZiY19k
aXNhYmxlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gLQlz
dHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmZGV2X3ByaXYtPmZiYzsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0
IGludGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiA+IC0JaWYgKCFmYmNfc3VwcG9ydGVkKGRl
dl9wcml2KSkKPiA+ICsJaWYgKCFmYmNfc3VwcG9ydGVkKGk5MTUpKQo+ID4gICAJCXJldHVybjsK
PiA+ICAgCW11dGV4X2xvY2soJmZiYy0+bG9jayk7Cj4gPiAgIAlpZiAoZmJjLT5jcnRjID09IGNy
dGMpCj4gPiAtCQlfX2ludGVsX2ZiY19kaXNhYmxlKGRldl9wcml2KTsKPiA+ICsJCV9faW50ZWxf
ZmJjX2Rpc2FibGUoaTkxNSk7Cj4gPiAgIAltdXRleF91bmxvY2soJmZiYy0+bG9jayk7Cj4gPiAg
IH0KPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2ZiY19nbG9iYWxfZGlzYWJsZSAtIGdsb2JhbGx5
IGRpc2FibGUgRkJDCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4g
KyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gICAgKgo+ID4gICAgKiBUaGlzIGZ1
bmN0aW9uIGRpc2FibGVzIEZCQyByZWdhcmRsZXNzIG9mIHdoaWNoIENSVEMgaXMgYXNzb2NpYXRl
ZCB3aXRoIGl0Lgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2ZiY19nbG9iYWxfZGlzYWJsZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9mYmNfZ2xv
YmFsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gPiArCXN0cnVjdCBpbnRl
bF9mYmMgKmZiYyA9ICZpOTE1LT5mYmM7Cj4gPiAtCWlmICghZmJjX3N1cHBvcnRlZChkZXZfcHJp
dikpCj4gPiArCWlmICghZmJjX3N1cHBvcnRlZChpOTE1KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAg
IAltdXRleF9sb2NrKCZmYmMtPmxvY2spOwo+ID4gICAJaWYgKGZiYy0+ZW5hYmxlZCkgewo+ID4g
ICAJCVdBUk5fT04oZmJjLT5jcnRjLT5hY3RpdmUpOwo+ID4gLQkJX19pbnRlbF9mYmNfZGlzYWJs
ZShkZXZfcHJpdik7Cj4gPiArCQlfX2ludGVsX2ZiY19kaXNhYmxlKGk5MTUpOwo+ID4gICAJfQo+
ID4gICAJbXV0ZXhfdW5sb2NrKCZmYmMtPmxvY2spOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lk
IGludGVsX2ZiY191bmRlcnJ1bl93b3JrX2ZuKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gPiAgIAkJY29udGFpbmVyX29mKHdvcmssIHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlLCBmYmMudW5kZXJydW5fd29yayk7Cj4gPiAtCXN0cnVjdCBp
bnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfZmJjICpm
YmMgPSAmaTkxNS0+ZmJjOwo+ID4gICAJbXV0ZXhfbG9jaygmZmJjLT5sb2NrKTsKPiA+IEBAIC0x
MTc1LDQyICsxMTc1LDQyIEBAIHN0YXRpYyB2b2lkIGludGVsX2ZiY191bmRlcnJ1bl93b3JrX2Zu
KHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgCURSTV9ERUJVR19LTVMoIkRpc2FibGlu
ZyBGQkMgZHVlIHRvIEZJRk8gdW5kZXJydW4uXG4iKTsKPiA+ICAgCWZiYy0+dW5kZXJydW5fZGV0
ZWN0ZWQgPSB0cnVlOwo+ID4gLQlpbnRlbF9mYmNfZGVhY3RpdmF0ZShkZXZfcHJpdiwgIkZJRk8g
dW5kZXJydW4iKTsKPiA+ICsJaW50ZWxfZmJjX2RlYWN0aXZhdGUoaTkxNSwgIkZJRk8gdW5kZXJy
dW4iKTsKPiA+ICAgb3V0Ogo+ID4gICAJbXV0ZXhfdW5sb2NrKCZmYmMtPmxvY2spOwo+ID4gICB9
Cj4gPiAgIC8qCj4gPiAgICAqIGludGVsX2ZiY19yZXNldF91bmRlcnJ1biAtIHJlc2V0IEZCQyBm
aWZvIHVuZGVycnVuIHN0YXR1cy4KPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3Rh
bmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiAgICAqCj4gPiAgICAq
IFNlZSBpbnRlbF9mYmNfaGFuZGxlX2ZpZm9fdW5kZXJydW5faXJxKCkuIEZvciBhdXRvbWF0ZWQg
dGVzdGluZyB3ZQo+ID4gICAgKiB3YW50IHRvIHJlLWVuYWJsZSBGQkMgYWZ0ZXIgYW4gdW5kZXJy
dW4gdG8gaW5jcmVhc2UgdGVzdCBjb3ZlcmFnZS4KPiA+ICAgICovCj4gPiAtaW50IGludGVsX2Zi
Y19yZXNldF91bmRlcnJ1bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAr
aW50IGludGVsX2ZiY19yZXNldF91bmRlcnJ1bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiA+ICAgewo+ID4gICAJaW50IHJldDsKPiA+IC0JY2FuY2VsX3dvcmtfc3luYygmZGV2X3By
aXYtPmZiYy51bmRlcnJ1bl93b3JrKTsKPiA+ICsJY2FuY2VsX3dvcmtfc3luYygmaTkxNS0+ZmJj
LnVuZGVycnVuX3dvcmspOwo+ID4gLQlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmRl
dl9wcml2LT5mYmMubG9jayk7Cj4gPiArCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgm
aTkxNS0+ZmJjLmxvY2spOwo+ID4gICAJaWYgKHJldCkKPiA+ICAgCQlyZXR1cm4gcmV0Owo+ID4g
LQlpZiAoZGV2X3ByaXYtPmZiYy51bmRlcnJ1bl9kZXRlY3RlZCkgewo+ID4gKwlpZiAoaTkxNS0+
ZmJjLnVuZGVycnVuX2RldGVjdGVkKSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiUmUtYWxsb3dp
bmcgRkJDIGFmdGVyIGZpZm8gdW5kZXJydW5cbiIpOwo+ID4gLQkJZGV2X3ByaXYtPmZiYy5ub19m
YmNfcmVhc29uID0gIkZJRk8gdW5kZXJydW4gY2xlYXJlZCI7Cj4gPiArCQlpOTE1LT5mYmMubm9f
ZmJjX3JlYXNvbiA9ICJGSUZPIHVuZGVycnVuIGNsZWFyZWQiOwo+ID4gICAJfQo+ID4gLQlkZXZf
cHJpdi0+ZmJjLnVuZGVycnVuX2RldGVjdGVkID0gZmFsc2U7Cj4gPiAtCW11dGV4X3VubG9jaygm
ZGV2X3ByaXYtPmZiYy5sb2NrKTsKPiA+ICsJaTkxNS0+ZmJjLnVuZGVycnVuX2RldGVjdGVkID0g
ZmFsc2U7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZmJjLmxvY2spOwo+ID4gICAJcmV0dXJu
IDA7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2ZiY19oYW5kbGVfZmlmb191bmRl
cnJ1bl9pcnEgLSBkaXNhYmxlIEZCQyB3aGVuIHdlIGdldCBhIEZJRk8gdW5kZXJydW4KPiA+IC0g
KiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2
aWNlIGluc3RhbmNlCj4gPiAgICAqCj4gPiAgICAqIFdpdGhvdXQgRkJDLCBtb3N0IHVuZGVycnVu
cyBhcmUgaGFybWxlc3MgYW5kIGRvbid0IHJlYWxseSBjYXVzZSB0b28gbWFueQo+ID4gICAgKiBw
cm9ibGVtcywgZXhjZXB0IGZvciBhbiBhbm5veWluZyBtZXNzYWdlIG9uIGRtZXNnLiBXaXRoIEZC
QywgdW5kZXJydW5zIGNhbgo+ID4gQEAgLTEyMjIsMTEgKzEyMjIsMTEgQEAgaW50IGludGVsX2Zi
Y19yZXNldF91bmRlcnJ1bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAg
ICAqCj4gPiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGZyb20gdGhlIElSUSBoYW5kbGVy
Lgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2ZiY19oYW5kbGVfZmlmb191bmRlcnJ1bl9pcnEo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfZmJjX2hh
bmRsZV9maWZvX3VuZGVycnVuX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfZmJjICpmYmMgPSAmZGV2X3ByaXYtPmZiYzsKPiA+ICsJ
c3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiA+IC0JaWYgKCFmYmNfc3VwcG9y
dGVkKGRldl9wcml2KSkKPiA+ICsJaWYgKCFmYmNfc3VwcG9ydGVkKGk5MTUpKQo+ID4gICAJCXJl
dHVybjsKPiA+ICAgCS8qIFRoZXJlJ3Mgbm8gZ3VhcmFudGVlIHRoYXQgdW5kZXJydW5fZGV0ZWN0
ZWQgd29uJ3QgYmUgc2V0IHRvIHRydWUKPiA+IEBAIC0xMjQzLDI0ICsxMjQzLDI0IEBAIHZvaWQg
aW50ZWxfZmJjX2hhbmRsZV9maWZvX3VuZGVycnVuX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9mYmNfaW5pdF9waXBlX3N0YXRl
IC0gaW5pdGlhbGl6ZSBGQkMncyBDUlRDIHZpc2liaWxpdHkgdHJhY2tpbmcKPiA+IC0gKiBAZGV2
X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGlu
c3RhbmNlCj4gPiAgICAqCj4gPiAgICAqIFRoZSBGQkMgY29kZSBuZWVkcyB0byB0cmFjayBDUlRD
IHZpc2liaWxpdHkgc2luY2UgdGhlIG9sZGVyIHBsYXRmb3JtcyBjYW4ndAo+ID4gICAgKiBoYXZl
IEZCQyBlbmFibGVkIHdoaWxlIG11bHRpcGxlIHBpcGVzIGFyZSB1c2VkLiBUaGlzIGZ1bmN0aW9u
IGRvZXMgdGhlCj4gPiAgICAqIGluaXRpYWwgc2V0dXAgYXQgZHJpdmVyIGxvYWQgdG8gbWFrZSBz
dXJlIEZCQyBpcyBtYXRjaGluZyB0aGUgcmVhbCBoYXJkd2FyZS4KPiA+ICAgICovCj4gPiAtdm9p
ZCBpbnRlbF9mYmNfaW5pdF9waXBlX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICt2b2lkIGludGVsX2ZiY19pbml0X3BpcGVfc3RhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+
ID4gICAJLyogRG9uJ3QgZXZlbiBib3RoZXIgdHJhY2tpbmcgYW55dGhpbmcgaWYgd2UgZG9uJ3Qg
bmVlZC4gKi8KPiA+IC0JaWYgKCFub19mYmNfb25fbXVsdGlwbGVfcGlwZXMoZGV2X3ByaXYpKQo+
ID4gKwlpZiAoIW5vX2ZiY19vbl9tdWx0aXBsZV9waXBlcyhpOTE1KSkKPiA+ICAgCQlyZXR1cm47
Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpCj4gPiArCWZv
cl9lYWNoX2ludGVsX2NydGMoJmk5MTUtPmRybSwgY3J0YykKPiA+ICAgCQlpZiAoaW50ZWxfY3J0
Y19hY3RpdmUoY3J0YykgJiYKPiA+ICAgCQkgICAgY3J0Yy0+YmFzZS5wcmltYXJ5LT5zdGF0ZS0+
dmlzaWJsZSkKPiA+IC0JCQlkZXZfcHJpdi0+ZmJjLnZpc2libGVfcGlwZXNfbWFzayB8PSAoMSA8
PCBjcnRjLT5waXBlKTsKPiA+ICsJCQlpOTE1LT5mYmMudmlzaWJsZV9waXBlc19tYXNrIHw9ICgx
IDw8IGNydGMtPnBpcGUpOwo+ID4gICB9Cj4gPiAgIC8qCj4gPiBAQCAtMTI3MiwyOSArMTI3Miwy
OSBAQCB2b2lkIGludGVsX2ZiY19pbml0X3BpcGVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gICAgKiBzcGFjZSB0byBjaGFuZ2UgdGhlIHZhbHVlIGR1cmluZyBy
dW50aW1lIHdpdGhvdXQgc2FuaXRpemluZyBpdCBhZ2Fpbi4gSUdUCj4gPiAgICAqIHJlbGllcyBv
biBiZWluZyBhYmxlIHRvIGNoYW5nZSBpOTE1LmVuYWJsZV9mYmMgYXQgcnVudGltZS4KPiA+ICAg
ICovCj4gPiAtc3RhdGljIGludCBpbnRlbF9zYW5pdGl6ZV9mYmNfb3B0aW9uKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgaW50IGludGVsX3Nhbml0aXplX2Zi
Y19vcHRpb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWlm
IChpOTE1X21vZHBhcmFtcy5lbmFibGVfZmJjID49IDApCj4gPiAgIAkJcmV0dXJuICEhaTkxNV9t
b2RwYXJhbXMuZW5hYmxlX2ZiYzsKPiA+IC0JaWYgKCFIQVNfRkJDKGRldl9wcml2KSkKPiA+ICsJ
aWYgKCFIQVNfRkJDKGk5MTUpKQo+ID4gICAJCXJldHVybiAwOwo+ID4gICAJLyogaHR0cHM6Ly9i
dWdzLmZyZWVkZXNrdG9wLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTA4MDg1ICovCj4gPiAtCWlmIChJ
U19HRU1JTklMQUtFKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpCj4g
PiAgIAkJcmV0dXJuIDA7Cj4gPiAtCWlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpIHx8IElOVEVM
X0dFTihkZXZfcHJpdikgPj0gOSkKPiA+ICsJaWYgKElTX0JST0FEV0VMTChpOTE1KSB8fCBJTlRF
TF9HRU4oaTkxNSkgPj0gOSkKPiA+ICAgCQlyZXR1cm4gMTsKPiA+ICAgCXJldHVybiAwOwo+ID4g
ICB9Cj4gPiAtc3RhdGljIGJvb2wgbmVlZF9mYmNfdnRkX3dhKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgYm9vbCBuZWVkX2ZiY192dGRfd2Eoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCS8qIFdhRmJjVHVybk9mZkZiY1do
ZW5IeXBlclZpc29ySXNVc2VkOnNrbCxieHQgKi8KPiA+ICAgCWlmIChpbnRlbF92dGRfYWN0aXZl
KCkgJiYKPiA+IC0JICAgIChJU19TS1lMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9w
cml2KSkpIHsKPiA+ICsJICAgIChJU19TS1lMQUtFKGk5MTUpIHx8IElTX0JST1hUT04oaTkxNSkp
KSB7Cj4gPiAgIAkJRFJNX0lORk8oIkRpc2FibGluZyBmcmFtZWJ1ZmZlciBjb21wcmVzc2lvbiAo
RkJDKSB0byBwcmV2ZW50IHNjcmVlbiBmbGlja2VyIHdpdGggVlQtZCBlbmFibGVkXG4iKTsKPiA+
ICAgCQlyZXR1cm4gdHJ1ZTsKPiA+ICAgCX0KPiA+IEBAIC0xMzA0LDM4ICsxMzA0LDM4IEBAIHN0
YXRpYyBib29sIG5lZWRfZmJjX3Z0ZF93YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9mYmNfaW5pdCAtIEluaXRpYWxpemUgRkJDCj4g
PiAtICogQGRldl9wcml2OiB0aGUgaTkxNSBkZXZpY2UKPiA+ICsgKiBAaTkxNTogdGhlIGk5MTUg
ZGV2aWNlCj4gPiAgICAqCj4gPiAgICAqIFRoaXMgZnVuY3Rpb24gbWlnaHQgYmUgY2FsbGVkIGR1
cmluZyBQTSBpbml0IHByb2Nlc3MuCj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfZmJjX2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfZmJjX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGlu
dGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7Cj4gPiArCXN0cnVjdCBpbnRlbF9mYmMgKmZi
YyA9ICZpOTE1LT5mYmM7Cj4gPiAgIAlJTklUX1dPUksoJmZiYy0+dW5kZXJydW5fd29yaywgaW50
ZWxfZmJjX3VuZGVycnVuX3dvcmtfZm4pOwo+ID4gICAJbXV0ZXhfaW5pdCgmZmJjLT5sb2NrKTsK
PiA+ICAgCWZiYy0+ZW5hYmxlZCA9IGZhbHNlOwo+ID4gICAJZmJjLT5hY3RpdmUgPSBmYWxzZTsK
PiA+IC0JaWYgKG5lZWRfZmJjX3Z0ZF93YShkZXZfcHJpdikpCj4gPiAtCQlta3dyaXRlX2Rldmlj
ZV9pbmZvKGRldl9wcml2KS0+ZGlzcGxheS5oYXNfZmJjID0gZmFsc2U7Cj4gPiArCWlmIChuZWVk
X2ZiY192dGRfd2EoaTkxNSkpCj4gPiArCQlta3dyaXRlX2RldmljZV9pbmZvKGk5MTUpLT5kaXNw
bGF5Lmhhc19mYmMgPSBmYWxzZTsKPiA+IC0JaTkxNV9tb2RwYXJhbXMuZW5hYmxlX2ZiYyA9IGlu
dGVsX3Nhbml0aXplX2ZiY19vcHRpb24oZGV2X3ByaXYpOwo+ID4gKwlpOTE1X21vZHBhcmFtcy5l
bmFibGVfZmJjID0gaW50ZWxfc2FuaXRpemVfZmJjX29wdGlvbihpOTE1KTsKPiA+ICAgCURSTV9E
RUJVR19LTVMoIlNhbml0aXplZCBlbmFibGVfZmJjIHZhbHVlOiAlZFxuIiwKPiA+ICAgCQkgICAg
ICBpOTE1X21vZHBhcmFtcy5lbmFibGVfZmJjKTsKPiA+IC0JaWYgKCFIQVNfRkJDKGRldl9wcml2
KSkgewo+ID4gKwlpZiAoIUhBU19GQkMoaTkxNSkpIHsKPiA+ICAgCQlmYmMtPm5vX2ZiY19yZWFz
b24gPSAidW5zdXBwb3J0ZWQgYnkgdGhpcyBjaGlwc2V0IjsKPiA+ICAgCQlyZXR1cm47Cj4gPiAg
IAl9Cj4gPiAgIAkvKiBUaGlzIHZhbHVlIHdhcyBwdWxsZWQgb3V0IG9mIHNvbWVvbmUncyBoYXQg
Ki8KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNCAmJiAhSVNfR000NShkZXZfcHJp
dikpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPD0gNCAmJiAhSVNfR000NShpOTE1KSkKPiA+
ICAgCQlJOTE1X1dSSVRFKEZCQ19DT05UUk9MLCA1MDAgPDwgRkJDX0NUTF9JTlRFUlZBTF9TSElG
VCk7Cj4gPiAgIAkvKiBXZSBzdGlsbCBkb24ndCBoYXZlIGFueSBzb3J0IG9mIGhhcmR3YXJlIHN0
YXRlIHJlYWRvdXQgZm9yIEZCQywgc28KPiA+ICAgCSAqIGRlYWN0aXZhdGUgaXQgaW4gY2FzZSB0
aGUgQklPUyBhY3RpdmF0ZWQgaXQgdG8gbWFrZSBzdXJlIHNvZnR3YXJlCj4gPiAgIAkgKiBtYXRj
aGVzIHRoZSBoYXJkd2FyZSBzdGF0ZS4gKi8KPiA+IC0JaWYgKGludGVsX2ZiY19od19pc19hY3Rp
dmUoZGV2X3ByaXYpKQo+ID4gLQkJaW50ZWxfZmJjX2h3X2RlYWN0aXZhdGUoZGV2X3ByaXYpOwo+
ID4gKwlpZiAoaW50ZWxfZmJjX2h3X2lzX2FjdGl2ZShpOTE1KSkKPiA+ICsJCWludGVsX2ZiY19o
d19kZWFjdGl2YXRlKGk5MTUpOwo+ID4gICB9Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfZmJjLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmMuaAo+
ID4gaW5kZXggNTAyNzJlZGE4ZDQzLi5iN2RjNmNiNDM0OTcgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmMuaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfZmJjLmgKPiA+IEBAIC0xNiwyNyArMTYsMjcgQEAgc3RydWN0IGludGVsX2NydGM7
Cj4gPiAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlOwo+ID4gICBzdHJ1Y3QgaW50ZWxfcGxhbmVf
c3RhdGU7Cj4gPiAtdm9pZCBpbnRlbF9mYmNfY2hvb3NlX2NydGMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgaW50ZWxfZmJjX2Nob29zZV9jcnRjKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICBzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSk7Cj4gPiAtYm9vbCBpbnRlbF9mYmNfaXNfYWN0aXZlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArYm9vbCBpbnRlbF9mYmNfaXNfYWN0aXZlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgdm9pZCBpbnRlbF9mYmNfcHJlX3VwZGF0
ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+ICAgCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJICBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBs
YW5lX3N0YXRlKTsKPiA+ICAgdm9pZCBpbnRlbF9mYmNfcG9zdF91cGRhdGUoc3RydWN0IGludGVs
X2NydGMgKmNydGMpOwo+ID4gLXZvaWQgaW50ZWxfZmJjX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGludGVsX2ZiY19pbml0X3BpcGVfc3RhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICt2b2lkIGludGVsX2ZiY19pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX2ZiY19pbml0
X3BpcGVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICB2b2lkIGlu
dGVsX2ZiY19lbmFibGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJICAgICAgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJICAgICAgc3RydWN0IGlu
dGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSk7Cj4gPiAgIHZvaWQgaW50ZWxfZmJjX2Rpc2Fi
bGUoc3RydWN0IGludGVsX2NydGMgKmNydGMpOwo+ID4gLXZvaWQgaW50ZWxfZmJjX2dsb2JhbF9k
aXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpbnRl
bF9mYmNfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAr
dm9pZCBpbnRlbF9mYmNfZ2xvYmFsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpOwo+ID4gK3ZvaWQgaW50ZWxfZmJjX2ludmFsaWRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCSAgdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMsCj4gPiAg
IAkJCSAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKTsKPiA+IC12b2lkIGludGVsX2ZiY19mbHVz
aChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpbnRlbF9mYmNf
Zmx1c2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICB1bnNpZ25l
ZCBpbnQgZnJvbnRidWZmZXJfYml0cywgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKTsKPiA+IC12
b2lkIGludGVsX2ZiY19jbGVhbnVwX2NmYihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwo+ID4gLXZvaWQgaW50ZWxfZmJjX2hhbmRsZV9maWZvX3VuZGVycnVuX2lycShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLWludCBpbnRlbF9mYmNfcmVzZXRfdW5k
ZXJydW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICt2b2lkIGludGVs
X2ZiY19jbGVhbnVwX2NmYihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9p
ZCBpbnRlbF9mYmNfaGFuZGxlX2ZpZm9fdW5kZXJydW5faXJxKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiA+ICtpbnQgaW50ZWxfZmJjX3Jlc2V0X3VuZGVycnVuKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgI2VuZGlmIC8qIF9fSU5URUxfRkJDX0hfXyAqLwo+
ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZiZGV2LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmRldi5jCj4gPiBpbmRleCAwZDNhNmZhNjc0ZTYuLjkz
ZGVlOWZmNWE1OCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Zi
ZGV2LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZiZGV2LmMKPiA+IEBA
IC0xMTcsNyArMTE3LDcgQEAgc3RhdGljIGludCBpbnRlbGZiX2FsbG9jKHN0cnVjdCBkcm1fZmJf
aGVscGVyICpoZWxwZXIsCj4gPiAgIAkJY29udGFpbmVyX29mKGhlbHBlciwgc3RydWN0IGludGVs
X2ZiZGV2LCBoZWxwZXIpOwo+ID4gICAJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmI7Cj4gPiAg
IAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gaGVscGVyLT5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgZHJtX21vZGVf
ZmJfY21kMiBtb2RlX2NtZCA9IHt9Owo+ID4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iajsKPiA+ICAgCWludCBzaXplLCByZXQ7Cj4gPiBAQCAtMTQxLDEwICsxNDEsMTAgQEAgc3Rh
dGljIGludCBpbnRlbGZiX2FsbG9jKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCj4gPiAg
IAkgKiBpbXBvcnRhbnQgYW5kIHdlIHNob3VsZCBwcm9iYWJseSB1c2UgdGhhdCBzcGFjZSB3aXRo
IEZCQyBvciBvdGhlcgo+ID4gICAJICogZmVhdHVyZXMuICovCj4gPiAgIAlvYmogPSBOVUxMOwo+
ID4gLQlpZiAoc2l6ZSAqIDIgPCBkZXZfcHJpdi0+c3RvbGVuX3VzYWJsZV9zaXplKQo+ID4gLQkJ
b2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW4oZGV2X3ByaXYsIHNpemUpOwo+ID4g
KwlpZiAoc2l6ZSAqIDIgPCBpOTE1LT5zdG9sZW5fdXNhYmxlX3NpemUpCj4gPiArCQlvYmogPSBp
OTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbihpOTE1LCBzaXplKTsKPiA+ICAgCWlmIChvYmog
PT0gTlVMTCkKPiA+IC0JCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0oZGV2X3By
aXYsIHNpemUpOwo+ID4gKwkJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShpOTE1
LCBzaXplKTsKPiA+ICAgCWlmIChJU19FUlIob2JqKSkgewo+ID4gICAJCURSTV9FUlJPUigiZmFp
bGVkIHRvIGFsbG9jYXRlIGZyYW1lYnVmZmVyXG4iKTsKPiA+ICAgCQlyZXQgPSBQVFJfRVJSKG9i
aik7Cj4gPiBAQCAtMTc0LDkgKzE3NCw5IEBAIHN0YXRpYyBpbnQgaW50ZWxmYl9jcmVhdGUoc3Ry
dWN0IGRybV9mYl9oZWxwZXIgKmhlbHBlciwKPiA+ICAgCQljb250YWluZXJfb2YoaGVscGVyLCBz
dHJ1Y3QgaW50ZWxfZmJkZXYsIGhlbHBlcik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZnJhbWVidWZm
ZXIgKmludGVsX2ZiID0gaWZiZGV2LT5mYjsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYg
PSBoZWxwZXItPmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwo+ID4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0u
cGRldjsKPiA+IC0Jc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9ICZkZXZfcHJpdi0+Z2d0dDsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0
cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiArCXN0cnVjdCBpOTE1X2dn
dHQgKmdndHQgPSAmaTkxNS0+Z2d0dDsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpOTE1X2dndHRfdmll
dyB2aWV3ID0gewo+ID4gICAJCS50eXBlID0gSTkxNV9HR1RUX1ZJRVdfTk9STUFMLAo+ID4gICAJ
fTsKPiA+IEBAIC0yMTMsNyArMjEzLDcgQEAgc3RhdGljIGludCBpbnRlbGZiX2NyZWF0ZShzdHJ1
Y3QgZHJtX2ZiX2hlbHBlciAqaGVscGVyLAo+ID4gICAJfQo+ID4gICAJbXV0ZXhfbG9jaygmZGV2
LT5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2
X3ByaXYpOwo+ID4gKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7Cj4gPiAg
IAkvKiBQaW4gdGhlIEdHVFQgdm1hIGZvciBvdXIgYWNjZXNzIHZpYSBpbmZvLT5zY3JlZW5fYmFz
ZS4KPiA+ICAgCSAqIFRoaXMgYWxzbyB2YWxpZGF0ZXMgdGhhdCBhbnkgZXhpc3RpbmcgZmIgaW5o
ZXJpdGVkIGZyb20gdGhlCj4gPiBAQCAtMjcyLDcgKzI3Miw3IEBAIHN0YXRpYyBpbnQgaW50ZWxm
Yl9jcmVhdGUoc3RydWN0IGRybV9mYl9oZWxwZXIgKmhlbHBlciwKPiA+ICAgCWlmYmRldi0+dm1h
ID0gdm1hOwo+ID4gICAJaWZiZGV2LT52bWFfZmxhZ3MgPSBmbGFnczsKPiA+IC0JaW50ZWxfcnVu
dGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9ydW50aW1lX3BtX3B1
dChpOTE1LCB3YWtlcmVmKTsKPiA+ICAgCW11dGV4X3VubG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgp
Owo+ID4gICAJdmdhX3N3aXRjaGVyb29fY2xpZW50X2ZiX3NldChwZGV2LCBpbmZvKTsKPiA+ICAg
CXJldHVybiAwOwo+ID4gQEAgLTI4MCw3ICsyODAsNyBAQCBzdGF0aWMgaW50IGludGVsZmJfY3Jl
YXRlKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCj4gPiAgIG91dF91bnBpbjoKPiA+ICAg
CWludGVsX3VucGluX2ZiX3ZtYSh2bWEsIGZsYWdzKTsKPiA+ICAgb3V0X3VubG9jazoKPiA+IC0J
aW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9ydW50
aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKPiA+ICAgCW11dGV4X3VubG9jaygmZGV2LT5zdHJ1
Y3RfbXV0ZXgpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTQ0NywxMSArNDQ3
LDExIEBAIHN0YXRpYyB2b2lkIGludGVsX2ZiZGV2X3N1c3BlbmRfd29ya2VyKHN0cnVjdCB3b3Jr
X3N0cnVjdCAqd29yaykKPiA+ICAgaW50IGludGVsX2ZiZGV2X2luaXQoc3RydWN0IGRybV9kZXZp
Y2UgKmRldikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2ZiZGV2ICppZmJkZXY7Cj4gPiAgIAlpbnQg
cmV0Owo+ID4gLQlpZiAoV0FSTl9PTighSEFTX0RJU1BMQVkoZGV2X3ByaXYpKSkKPiA+ICsJaWYg
KFdBUk5fT04oIUhBU19ESVNQTEFZKGk5MTUpKSkKPiA+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiA+
ICAgCWlmYmRldiA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBpbnRlbF9mYmRldiksIEdGUF9LRVJO
RUwpOwo+ID4gQEAgLTQ3MCw4ICs0NzAsOCBAQCBpbnQgaW50ZWxfZmJkZXZfaW5pdChzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2KQo+ID4gICAJCXJldHVybiByZXQ7Cj4gPiAgIAl9Cj4gPiAtCWRldl9w
cml2LT5mYmRldiA9IGlmYmRldjsKPiA+IC0JSU5JVF9XT1JLKCZkZXZfcHJpdi0+ZmJkZXZfc3Vz
cGVuZF93b3JrLCBpbnRlbF9mYmRldl9zdXNwZW5kX3dvcmtlcik7Cj4gPiArCWk5MTUtPmZiZGV2
ID0gaWZiZGV2Owo+ID4gKwlJTklUX1dPUksoJmk5MTUtPmZiZGV2X3N1c3BlbmRfd29yaywgaW50
ZWxfZmJkZXZfc3VzcGVuZF93b3JrZXIpOwo+ID4gICAJZHJtX2ZiX2hlbHBlcl9zaW5nbGVfYWRk
X2FsbF9jb25uZWN0b3JzKCZpZmJkZXYtPmhlbHBlcik7Cj4gPiBAQCAtNTA4LDIzICs1MDgsMjMg
QEAgc3RhdGljIHZvaWQgaW50ZWxfZmJkZXZfc3luYyhzdHJ1Y3QgaW50ZWxfZmJkZXYgKmlmYmRl
dikKPiA+ICAgCWlmYmRldi0+Y29va2llID0gMDsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfZmJk
ZXZfdW5yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9p
ZCBpbnRlbF9mYmRldl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9mYmRldiAqaWZiZGV2ID0gZGV2X3ByaXYtPmZiZGV2
Owo+ID4gKwlzdHJ1Y3QgaW50ZWxfZmJkZXYgKmlmYmRldiA9IGk5MTUtPmZiZGV2Owo+ID4gICAJ
aWYgKCFpZmJkZXYpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQljYW5jZWxfd29ya19zeW5jKCZkZXZf
cHJpdi0+ZmJkZXZfc3VzcGVuZF93b3JrKTsKPiA+ICsJY2FuY2VsX3dvcmtfc3luYygmaTkxNS0+
ZmJkZXZfc3VzcGVuZF93b3JrKTsKPiA+ICAgCWlmICghY3VycmVudF9pc19hc3luYygpKQo+ID4g
ICAJCWludGVsX2ZiZGV2X3N5bmMoaWZiZGV2KTsKPiA+ICAgCWRybV9mYl9oZWxwZXJfdW5yZWdp
c3Rlcl9mYmkoJmlmYmRldi0+aGVscGVyKTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfZmJkZXZf
ZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9m
YmRldl9maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBpbnRlbF9mYmRldiAqaWZiZGV2ID0gZmV0Y2hfYW5kX3plcm8oJmRldl9wcml2LT5mYmRl
dik7Cj4gPiArCXN0cnVjdCBpbnRlbF9mYmRldiAqaWZiZGV2ID0gZmV0Y2hfYW5kX3plcm8oJmk5
MTUtPmZiZGV2KTsKPiA+ICAgCWlmICghaWZiZGV2KQo+ID4gICAJCXJldHVybjsKPiA+IEBAIC01
NTQsOCArNTU0LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZmJkZXZfaHBkX3NldF9zdXNwZW5kKHN0
cnVjdCBpbnRlbF9mYmRldiAqaWZiZGV2LCBpbnQgc3RhdGUpCj4gPiAgIHZvaWQgaW50ZWxfZmJk
ZXZfc2V0X3N1c3BlbmQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgaW50IHN0YXRlLCBib29sIHN5
bmNocm9ub3VzKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPiA+IC0Jc3RydWN0IGludGVsX2ZiZGV2ICppZmJkZXYgPSBkZXZf
cHJpdi0+ZmJkZXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShkZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfZmJkZXYgKmlmYmRldiA9IGk5MTUtPmZiZGV2Owo+
ID4gICAJc3RydWN0IGZiX2luZm8gKmluZm87Cj4gPiAgIAlpZiAoIWlmYmRldiB8fCAhaWZiZGV2
LT52bWEpCj4gPiBAQCAtNTcyLDcgKzU3Miw3IEBAIHZvaWQgaW50ZWxfZmJkZXZfc2V0X3N1c3Bl
bmQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgaW50IHN0YXRlLCBib29sIHN5bmNocm9ub3VzCj4g
PiAgIAkJICogb3Vyc2VsdmVzLCBzbyBvbmx5IGZsdXNoIG91dHN0YW5kaW5nIHdvcmsgdXBvbiBz
dXNwZW5kIQo+ID4gICAJCSAqLwo+ID4gICAJCWlmIChzdGF0ZSAhPSBGQklORk9fU1RBVEVfUlVO
TklORykKPiA+IC0JCQlmbHVzaF93b3JrKCZkZXZfcHJpdi0+ZmJkZXZfc3VzcGVuZF93b3JrKTsK
PiA+ICsJCQlmbHVzaF93b3JrKCZpOTE1LT5mYmRldl9zdXNwZW5kX3dvcmspOwo+ID4gICAJCWNv
bnNvbGVfbG9jaygpOwo+ID4gICAJfSBlbHNlIHsKPiA+IEBAIC01ODYsNyArNTg2LDcgQEAgdm9p
ZCBpbnRlbF9mYmRldl9zZXRfc3VzcGVuZChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBpbnQgc3Rh
dGUsIGJvb2wgc3luY2hyb25vdXMKPiA+ICAgCQkJLyogRG9uJ3QgYmxvY2sgb3VyIG93biB3b3Jr
cXVldWUgYXMgdGhpcyBjYW4KPiA+ICAgCQkJICogYmUgcnVuIGluIHBhcmFsbGVsIHdpdGggb3Ro
ZXIgaTkxNS5rbyB0YXNrcy4KPiA+ICAgCQkJICovCj4gPiAtCQkJc2NoZWR1bGVfd29yaygmZGV2
X3ByaXYtPmZiZGV2X3N1c3BlbmRfd29yayk7Cj4gPiArCQkJc2NoZWR1bGVfd29yaygmaTkxNS0+
ZmJkZXZfc3VzcGVuZF93b3JrKTsKPiA+ICAgCQkJcmV0dXJuOwo+ID4gICAJCX0KPiA+ICAgCX0K
PiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmRldi5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZmJkZXYuaAo+ID4gaW5kZXggZGU3Yzg0MjUwZWI1Li40
ZDBjOGM4NTFhNWUgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9m
YmRldi5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmRldi5oCj4gPiBA
QCAtMTQsOCArMTQsOCBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiA+ICAgI2lmZGVmIENP
TkZJR19EUk1fRkJERVZfRU1VTEFUSU9OCj4gPiAgIGludCBpbnRlbF9mYmRldl9pbml0KHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYpOwo+ID4gICB2b2lkIGludGVsX2ZiZGV2X2luaXRpYWxfY29uZmln
X2FzeW5jKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwo+ID4gLXZvaWQgaW50ZWxfZmJkZXZfdW5y
ZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgaW50
ZWxfZmJkZXZfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3Zv
aWQgaW50ZWxfZmJkZXZfdW5yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gPiArdm9pZCBpbnRlbF9mYmRldl9maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KTsKPiA+ICAgdm9pZCBpbnRlbF9mYmRldl9zZXRfc3VzcGVuZChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LCBpbnQgc3RhdGUsIGJvb2wgc3luY2hyb25vdXMpOwo+ID4gICB2b2lkIGludGVsX2ZiZGV2
X291dHB1dF9wb2xsX2NoYW5nZWQoc3RydWN0IGRybV9kZXZpY2UgKmRldik7Cj4gPiAgIHZvaWQg
aW50ZWxfZmJkZXZfcmVzdG9yZV9tb2RlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwo+ID4gQEAg
LTI5LDExICsyOSwxMSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfZmJkZXZfaW5pdGlhbF9j
b25maWdfYXN5bmMoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgewo+ID4gICB9Cj4gPiAt
c3RhdGljIGlubGluZSB2b2lkIGludGVsX2ZiZGV2X3VucmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9mYmRldl91
bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfZmJkZXZfZmluaShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGlubGluZSB2b2lkIGludGVsX2ZiZGV2X2Zp
bmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgfQo+ID4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZpZm9fdW5kZXJydW4uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZpZm9fdW5kZXJydW4uYwo+ID4gaW5kZXggODU0NWFk
MzJiYjUwLi4wOGYwOTJhZGRhZTIgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9maWZvX3VuZGVycnVuLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2ZpZm9fdW5kZXJydW4uYwo+ID4gQEAgLTUyLDE0ICs1MiwxNCBAQAo+ID4gICBzdGF0aWMg
Ym9vbCBpdmJfY2FuX2VuYWJsZV9lcnJfaW50KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ID4gICAJZW51bSBwaXBlIHBpcGU7Cj4gPiAt
CWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCWxvY2tkZXBf
YXNzZXJ0X2hlbGQoJmk5MTUtPmlycV9sb2NrKTsKPiA+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJp
diwgcGlwZSkgewo+ID4gLQkJY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2
LCBwaXBlKTsKPiA+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gPiArCQljcnRjID0g
aW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoaTkxNSwgcGlwZSk7Cj4gPiAgIAkJaWYgKGNydGMtPmNw
dV9maWZvX3VuZGVycnVuX2Rpc2FibGVkKQo+ID4gICAJCQlyZXR1cm4gZmFsc2U7Cj4gPiBAQCAt
NzAsMTQgKzcwLDE0IEBAIHN0YXRpYyBib29sIGl2Yl9jYW5fZW5hYmxlX2Vycl9pbnQoc3RydWN0
IGRybV9kZXZpY2UgKmRldikKPiA+ICAgc3RhdGljIGJvb2wgY3B0X2Nhbl9lbmFibGVfc2Vycl9p
bnQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJZW51bSBwaXBlIHBpcGU7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2
X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+aXJxX2xv
Y2spOwo+ID4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gPiAtCQljcnRjID0g
aW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlmb3JfZWFjaF9w
aXBlKGk5MTUsIHBpcGUpIHsKPiA+ICsJCWNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShp
OTE1LCBwaXBlKTsKPiA+ICAgCQlpZiAoY3J0Yy0+cGNoX2ZpZm9fdW5kZXJydW5fZGlzYWJsZWQp
Cj4gPiAgIAkJCXJldHVybiBmYWxzZTsKPiA+IEBAIC04OCwyMCArODgsMjAgQEAgc3RhdGljIGJv
b2wgY3B0X2Nhbl9lbmFibGVfc2Vycl9pbnQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPiA+ICAg
c3RhdGljIHZvaWQgaTl4eF9jaGVja19maWZvX3VuZGVycnVucyhzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWk5MTVfcmVnX3QgcmVnID0gUElQ
RVNUQVQoY3J0Yy0+cGlwZSk7Cj4gPiAgIAl1MzIgZW5hYmxlX21hc2s7Cj4gPiAtCWxvY2tkZXBf
YXNzZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hl
bGQoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICAgCWlmICgoSTkxNV9SRUFEKHJlZykgJiBQSVBFX0ZJ
Rk9fVU5ERVJSVU5fU1RBVFVTKSA9PSAwKQo+ID4gICAJCXJldHVybjsKPiA+IC0JZW5hYmxlX21h
c2sgPSBpOTE1X3BpcGVzdGF0X2VuYWJsZV9tYXNrKGRldl9wcml2LCBjcnRjLT5waXBlKTsKPiA+
ICsJZW5hYmxlX21hc2sgPSBpOTE1X3BpcGVzdGF0X2VuYWJsZV9tYXNrKGk5MTUsIGNydGMtPnBp
cGUpOwo+ID4gICAJSTkxNV9XUklURShyZWcsIGVuYWJsZV9tYXNrIHwgUElQRV9GSUZPX1VOREVS
UlVOX1NUQVRVUyk7Cj4gPiAgIAlQT1NUSU5HX1JFQUQocmVnKTsKPiA+IC0JdHJhY2VfaW50ZWxf
Y3B1X2ZpZm9fdW5kZXJydW4oZGV2X3ByaXYsIGNydGMtPnBpcGUpOwo+ID4gKwl0cmFjZV9pbnRl
bF9jcHVfZmlmb191bmRlcnJ1bihpOTE1LCBjcnRjLT5waXBlKTsKPiA+ICAgCURSTV9FUlJPUigi
cGlwZSAlYyB1bmRlcnJ1blxuIiwgcGlwZV9uYW1lKGNydGMtPnBpcGUpKTsKPiA+ICAgfQo+ID4g
QEAgLTEwOSwxMyArMTA5LDEzIEBAIHN0YXRpYyB2b2lkIGk5eHhfc2V0X2ZpZm9fdW5kZXJydW5f
cmVwb3J0aW5nKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgIAkJCQkJICAgICBlbnVtIHBp
cGUgcGlwZSwKPiA+ICAgCQkJCQkgICAgIGJvb2wgZW5hYmxlLCBib29sIG9sZCkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJ
aTkxNV9yZWdfdCByZWcgPSBQSVBFU1RBVChwaXBlKTsKPiA+IC0JbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+
aXJxX2xvY2spOwo+ID4gICAJaWYgKGVuYWJsZSkgewo+ID4gLQkJdTMyIGVuYWJsZV9tYXNrID0g
aTkxNV9waXBlc3RhdF9lbmFibGVfbWFzayhkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCQl1MzIgZW5h
YmxlX21hc2sgPSBpOTE1X3BpcGVzdGF0X2VuYWJsZV9tYXNrKGk5MTUsIHBpcGUpOwo+ID4gICAJ
CUk5MTVfV1JJVEUocmVnLCBlbmFibGVfbWFzayB8IFBJUEVfRklGT19VTkRFUlJVTl9TVEFUVVMp
Owo+ID4gICAJCVBPU1RJTkdfUkVBRChyZWcpOwo+ID4gQEAgLTEyOCwyMyArMTI4LDIzIEBAIHN0
YXRpYyB2b2lkIGk5eHhfc2V0X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsCj4gPiAgIHN0YXRpYyB2b2lkIGlyb25sYWtlX3NldF9maWZvX3VuZGVycnVuX3Jl
cG9ydGluZyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ID4gICAJCQkJCQkgZW51bSBwaXBlIHBp
cGUsIGJvb2wgZW5hYmxlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAl1MzIgYml0ID0gKHBpcGUgPT0gUElQRV9BKSA/Cj4g
PiAgIAkJREVfUElQRUFfRklGT19VTkRFUlJVTiA6IERFX1BJUEVCX0ZJRk9fVU5ERVJSVU47Cj4g
PiAgIAlpZiAoZW5hYmxlKQo+ID4gLQkJaWxrX2VuYWJsZV9kaXNwbGF5X2lycShkZXZfcHJpdiwg
Yml0KTsKPiA+ICsJCWlsa19lbmFibGVfZGlzcGxheV9pcnEoaTkxNSwgYml0KTsKPiA+ICAgCWVs
c2UKPiA+IC0JCWlsa19kaXNhYmxlX2Rpc3BsYXlfaXJxKGRldl9wcml2LCBiaXQpOwo+ID4gKwkJ
aWxrX2Rpc2FibGVfZGlzcGxheV9pcnEoaTkxNSwgYml0KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMg
dm9pZCBpdnlicmlkZ2VfY2hlY2tfZmlmb191bmRlcnJ1bnMoc3RydWN0IGludGVsX2NydGMgKmNy
dGMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMt
PnBpcGU7Cj4gPiAgIAl1MzIgZXJyX2ludCA9IEk5MTVfUkVBRChHRU43X0VSUl9JTlQpOwo+ID4g
LQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlsb2NrZGVw
X2Fzc2VydF9oZWxkKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAgIAlpZiAoKGVycl9pbnQgJiBFUlJf
SU5UX0ZJRk9fVU5ERVJSVU4ocGlwZSkpID09IDApCj4gPiAgIAkJcmV0dXJuOwo+ID4gQEAgLTE1
Miw3ICsxNTIsNyBAQCBzdGF0aWMgdm9pZCBpdnlicmlkZ2VfY2hlY2tfZmlmb191bmRlcnJ1bnMo
c3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIAlJOTE1X1dSSVRFKEdFTjdfRVJSX0lOVCwg
RVJSX0lOVF9GSUZPX1VOREVSUlVOKHBpcGUpKTsKPiA+ICAgCVBPU1RJTkdfUkVBRChHRU43X0VS
Ul9JTlQpOwo+ID4gLQl0cmFjZV9pbnRlbF9jcHVfZmlmb191bmRlcnJ1bihkZXZfcHJpdiwgcGlw
ZSk7Cj4gPiArCXRyYWNlX2ludGVsX2NwdV9maWZvX3VuZGVycnVuKGk5MTUsIHBpcGUpOwo+ID4g
ICAJRFJNX0VSUk9SKCJmaWZvIHVuZGVycnVuIG9uIHBpcGUgJWNcbiIsIHBpcGVfbmFtZShwaXBl
KSk7Cj4gPiAgIH0KPiA+IEBAIC0xNjAsMTYgKzE2MCwxNiBAQCBzdGF0aWMgdm9pZCBpdnlicmlk
Z2Vfc2V0X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4g
PiAgIAkJCQkJCSAgZW51bSBwaXBlIHBpcGUsCj4gPiAgIAkJCQkJCSAgYm9vbCBlbmFibGUsIGJv
b2wgb2xkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRldik7Cj4gPiAgIAlpZiAoZW5hYmxlKSB7Cj4gPiAgIAkJSTkxNV9XUklURShHRU43X0VS
Ul9JTlQsIEVSUl9JTlRfRklGT19VTkRFUlJVTihwaXBlKSk7Cj4gPiAgIAkJaWYgKCFpdmJfY2Fu
X2VuYWJsZV9lcnJfaW50KGRldikpCj4gPiAgIAkJCXJldHVybjsKPiA+IC0JCWlsa19lbmFibGVf
ZGlzcGxheV9pcnEoZGV2X3ByaXYsIERFX0VSUl9JTlRfSVZCKTsKPiA+ICsJCWlsa19lbmFibGVf
ZGlzcGxheV9pcnEoaTkxNSwgREVfRVJSX0lOVF9JVkIpOwo+ID4gICAJfSBlbHNlIHsKPiA+IC0J
CWlsa19kaXNhYmxlX2Rpc3BsYXlfaXJxKGRldl9wcml2LCBERV9FUlJfSU5UX0lWQik7Cj4gPiAr
CQlpbGtfZGlzYWJsZV9kaXNwbGF5X2lycShpOTE1LCBERV9FUlJfSU5UX0lWQik7Cj4gPiAgIAkJ
aWYgKG9sZCAmJgo+ID4gICAJCSAgICBJOTE1X1JFQUQoR0VON19FUlJfSU5UKSAmIEVSUl9JTlRf
RklGT19VTkRFUlJVTihwaXBlKSkgewo+ID4gQEAgLTE4MiwzNSArMTgyLDM1IEBAIHN0YXRpYyB2
b2lkIGl2eWJyaWRnZV9zZXRfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwKPiA+ICAgc3RhdGljIHZvaWQgYnJvYWR3ZWxsX3NldF9maWZvX3VuZGVycnVuX3Jl
cG9ydGluZyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+ID4gICAJCQkJCQkgIGVudW0gcGlwZSBw
aXBlLCBib29sIGVuYWJsZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJaWYgKGVuYWJsZSkKPiA+IC0JCWJkd19lbmFibGVf
cGlwZV9pcnEoZGV2X3ByaXYsIHBpcGUsIEdFTjhfUElQRV9GSUZPX1VOREVSUlVOKTsKPiA+ICsJ
CWJkd19lbmFibGVfcGlwZV9pcnEoaTkxNSwgcGlwZSwgR0VOOF9QSVBFX0ZJRk9fVU5ERVJSVU4p
Owo+ID4gICAJZWxzZQo+ID4gLQkJYmR3X2Rpc2FibGVfcGlwZV9pcnEoZGV2X3ByaXYsIHBpcGUs
IEdFTjhfUElQRV9GSUZPX1VOREVSUlVOKTsKPiA+ICsJCWJkd19kaXNhYmxlX3BpcGVfaXJxKGk5
MTUsIHBpcGUsIEdFTjhfUElQRV9GSUZPX1VOREVSUlVOKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMg
dm9pZCBpYnhfc2V0X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsCj4gPiAgIAkJCQkJICAgIGVudW0gcGlwZSBwY2hfdHJhbnNjb2RlciwKPiA+ICAgCQkJCQkg
ICAgYm9vbCBlbmFibGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXUzMiBiaXQgPSAocGNoX3RyYW5zY29kZXIgPT0gUElQ
RV9BKSA/Cj4gPiAgIAkJU0RFX1RSQU5TQV9GSUZPX1VOREVSIDogU0RFX1RSQU5TQl9GSUZPX1VO
REVSOwo+ID4gICAJaWYgKGVuYWJsZSkKPiA+IC0JCWlieF9lbmFibGVfZGlzcGxheV9pbnRlcnJ1
cHQoZGV2X3ByaXYsIGJpdCk7Cj4gPiArCQlpYnhfZW5hYmxlX2Rpc3BsYXlfaW50ZXJydXB0KGk5
MTUsIGJpdCk7Cj4gPiAgIAllbHNlCj4gPiAtCQlpYnhfZGlzYWJsZV9kaXNwbGF5X2ludGVycnVw
dChkZXZfcHJpdiwgYml0KTsKPiA+ICsJCWlieF9kaXNhYmxlX2Rpc3BsYXlfaW50ZXJydXB0KGk5
MTUsIGJpdCk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgY3B0X2NoZWNrX3BjaF9maWZvX3Vu
ZGVycnVucyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsK
PiA+ICAgCWVudW0gcGlwZSBwY2hfdHJhbnNjb2RlciA9IGNydGMtPnBpcGU7Cj4gPiAgIAl1MzIg
c2Vycl9pbnQgPSBJOTE1X1JFQUQoU0VSUl9JTlQpOwo+ID4gLQlsb2NrZGVwX2Fzc2VydF9oZWxk
KCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5p
cnFfbG9jayk7Cj4gPiAgIAlpZiAoKHNlcnJfaW50ICYgU0VSUl9JTlRfVFJBTlNfRklGT19VTkRF
UlJVTihwY2hfdHJhbnNjb2RlcikpID09IDApCj4gPiAgIAkJcmV0dXJuOwo+ID4gQEAgLTIxOCw3
ICsyMTgsNyBAQCBzdGF0aWMgdm9pZCBjcHRfY2hlY2tfcGNoX2ZpZm9fdW5kZXJydW5zKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjKQo+ID4gICAJSTkxNV9XUklURShTRVJSX0lOVCwgU0VSUl9JTlRf
VFJBTlNfRklGT19VTkRFUlJVTihwY2hfdHJhbnNjb2RlcikpOwo+ID4gICAJUE9TVElOR19SRUFE
KFNFUlJfSU5UKTsKPiA+IC0JdHJhY2VfaW50ZWxfcGNoX2ZpZm9fdW5kZXJydW4oZGV2X3ByaXYs
IHBjaF90cmFuc2NvZGVyKTsKPiA+ICsJdHJhY2VfaW50ZWxfcGNoX2ZpZm9fdW5kZXJydW4oaTkx
NSwgcGNoX3RyYW5zY29kZXIpOwo+ID4gICAJRFJNX0VSUk9SKCJwY2ggZmlmbyB1bmRlcnJ1biBv
biBwY2ggdHJhbnNjb2RlciAlY1xuIiwKPiA+ICAgCQkgIHBpcGVfbmFtZShwY2hfdHJhbnNjb2Rl
cikpOwo+ID4gICB9Cj4gPiBAQCAtMjI3LDcgKzIyNyw3IEBAIHN0YXRpYyB2b2lkIGNwdF9zZXRf
Zmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPiA+ICAgCQkJ
CQkgICAgZW51bSBwaXBlIHBjaF90cmFuc2NvZGVyLAo+ID4gICAJCQkJCSAgICBib29sIGVuYWJs
ZSwgYm9vbCBvbGQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoZGV2KTsKPiA+ICAgCWlmIChlbmFibGUpIHsKPiA+ICAgCQlJOTE1X1dSSVRFKFNF
UlJfSU5ULAo+ID4gQEAgLTIzNiw5ICsyMzYsOSBAQCBzdGF0aWMgdm9pZCBjcHRfc2V0X2ZpZm9f
dW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgIAkJaWYgKCFj
cHRfY2FuX2VuYWJsZV9zZXJyX2ludChkZXYpKQo+ID4gICAJCQlyZXR1cm47Cj4gPiAtCQlpYnhf
ZW5hYmxlX2Rpc3BsYXlfaW50ZXJydXB0KGRldl9wcml2LCBTREVfRVJST1JfQ1BUKTsKPiA+ICsJ
CWlieF9lbmFibGVfZGlzcGxheV9pbnRlcnJ1cHQoaTkxNSwgU0RFX0VSUk9SX0NQVCk7Cj4gPiAg
IAl9IGVsc2Ugewo+ID4gLQkJaWJ4X2Rpc2FibGVfZGlzcGxheV9pbnRlcnJ1cHQoZGV2X3ByaXYs
IFNERV9FUlJPUl9DUFQpOwo+ID4gKwkJaWJ4X2Rpc2FibGVfZGlzcGxheV9pbnRlcnJ1cHQoaTkx
NSwgU0RFX0VSUk9SX0NQVCk7Cj4gPiAgIAkJaWYgKG9sZCAmJiBJOTE1X1JFQUQoU0VSUl9JTlQp
ICYKPiA+ICAgCQkgICAgU0VSUl9JTlRfVFJBTlNfRklGT19VTkRFUlJVTihwY2hfdHJhbnNjb2Rl
cikpIHsKPiA+IEBAIC0yNTEsMjIgKzI1MSwyMiBAQCBzdGF0aWMgdm9pZCBjcHRfc2V0X2ZpZm9f
dW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgIHN0YXRpYyBi
b29sIF9faW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LAo+ID4gICAJCQkJCQkgICAgZW51bSBwaXBlIHBpcGUsIGJvb2wgZW5hYmxlKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZGV2KTsKPiA+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3Jf
cGlwZShkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGludGVsX2dl
dF9jcnRjX2Zvcl9waXBlKGk5MTUsIHBpcGUpOwo+ID4gICAJYm9vbCBvbGQ7Cj4gPiAtCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICAgCW9sZCA9ICFjcnRjLT5jcHVfZmlmb191bmRl
cnJ1bl9kaXNhYmxlZDsKPiA+ICAgCWNydGMtPmNwdV9maWZvX3VuZGVycnVuX2Rpc2FibGVkID0g
IWVuYWJsZTsKPiA+IC0JaWYgKEhBU19HTUNIKGRldl9wcml2KSkKPiA+ICsJaWYgKEhBU19HTUNI
KGk5MTUpKQo+ID4gICAJCWk5eHhfc2V0X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldiwgcGlw
ZSwgZW5hYmxlLCBvbGQpOwo+ID4gLQllbHNlIGlmIChJU19HRU5fUkFOR0UoZGV2X3ByaXYsIDUs
IDYpKQo+ID4gKwllbHNlIGlmIChJU19HRU5fUkFOR0UoaTkxNSwgNSwgNikpCj4gPiAgIAkJaXJv
bmxha2Vfc2V0X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldiwgcGlwZSwgZW5hYmxlKTsKPiA+
IC0JZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA3KSkKPiA+ICsJZWxzZSBpZiAoSVNfR0VOKGk5
MTUsIDcpKQo+ID4gICAJCWl2eWJyaWRnZV9zZXRfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2
LCBwaXBlLCBlbmFibGUsIG9sZCk7Cj4gPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gOCkKPiA+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpCj4gPiAgIAkJYnJvYWR3
ZWxsX3NldF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXYsIHBpcGUsIGVuYWJsZSk7Cj4gPiAg
IAlyZXR1cm4gb2xkOwo+ID4gQEAgLTI3NCw3ICsyNzQsNyBAQCBzdGF0aWMgYm9vbCBfX2ludGVs
X3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9kZXZpY2UgKmRldiwK
PiA+ICAgLyoqCj4gPiAgICAqIGludGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcg
LSBzZXQgY3B1IGZpZm8gdW5kZXJycnVuIHJlcG9ydGluZyBzdGF0ZQo+ID4gLSAqIEBkZXZfcHJp
djogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFu
Y2UKPiA+ICAgICogQHBpcGU6IChDUFUpIHBpcGUgdG8gc2V0IHN0YXRlIGZvcgo+ID4gICAgKiBA
ZW5hYmxlOiB3aGV0aGVyIHVuZGVycnVucyBzaG91bGQgYmUgcmVwb3J0ZWQgb3Igbm90Cj4gPiAg
ICAqCj4gPiBAQCAtMjg4LDIzICsyODgsMjMgQEAgc3RhdGljIGJvb2wgX19pbnRlbF9zZXRfY3B1
X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgICAq
Cj4gPiAgICAqIFJldHVybnMgdGhlIHByZXZpb3VzIHN0YXRlIG9mIHVuZGVycnVuIHJlcG9ydGlu
Zy4KPiA+ICAgICovCj4gPiAtYm9vbCBpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0
aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtib29sIGludGVsX3Nl
dF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJCQkJICAgZW51bSBwaXBlIHBpcGUsIGJvb2wgZW5hYmxlKQo+ID4gICB7Cj4g
PiAgIAl1bnNpZ25lZCBsb25nIGZsYWdzOwo+ID4gICAJYm9vbCByZXQ7Cj4gPiAtCXNwaW5fbG9j
a19pcnFzYXZlKCZkZXZfcHJpdi0+aXJxX2xvY2ssIGZsYWdzKTsKPiA+IC0JcmV0ID0gX19pbnRl
bF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKCZkZXZfcHJpdi0+ZHJtLCBwaXBlLAo+
ID4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+aXJxX2xvY2ssIGZsYWdzKTsKPiA+ICsJcmV0
ID0gX19pbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKCZpOTE1LT5kcm0sIHBp
cGUsCj4gPiAgIAkJCQkJCSAgICAgIGVuYWJsZSk7Cj4gPiAtCXNwaW5fdW5sb2NrX2lycXJlc3Rv
cmUoJmRldl9wcml2LT5pcnFfbG9jaywgZmxhZ3MpOwo+ID4gKwlzcGluX3VubG9ja19pcnFyZXN0
b3JlKCZpOTE1LT5pcnFfbG9jaywgZmxhZ3MpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+
ID4gICAvKioKPiA+ICAgICogaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyAt
IHNldCBQQ0ggZmlmbyB1bmRlcnJ1biByZXBvcnRpbmcgc3RhdGUKPiA+IC0gKiBAZGV2X3ByaXY6
IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNl
Cj4gPiAgICAqIEBwY2hfdHJhbnNjb2RlcjogdGhlIFBDSCB0cmFuc2NvZGVyIChzYW1lIGFzIHBp
cGUgb24gSVZCIGFuZCBvbGRlcikKPiA+ICAgICogQGVuYWJsZTogd2hldGhlciB1bmRlcnJ1bnMg
c2hvdWxkIGJlIHJlcG9ydGVkIG9yIG5vdAo+ID4gICAgKgo+ID4gQEAgLTMxNiwxMiArMzE2LDEy
IEBAIGJvb2wgaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgICAqCj4gPiAgICAqIFJldHVybnMgdGhlIHBy
ZXZpb3VzIHN0YXRlIG9mIHVuZGVycnVuIHJlcG9ydGluZy4KPiA+ICAgICovCj4gPiAtYm9vbCBp
bnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICtib29sIGludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBv
cnRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJICAgZW51bSBw
aXBlIHBjaF90cmFuc2NvZGVyLAo+ID4gICAJCQkJCSAgIGJvb2wgZW5hYmxlKQo+ID4gICB7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9Cj4gPiAtCQlpbnRlbF9nZXRfY3J0Y19mb3Jf
cGlwZShkZXZfcHJpdiwgcGNoX3RyYW5zY29kZXIpOwo+ID4gKwkJaW50ZWxfZ2V0X2NydGNfZm9y
X3BpcGUoaTkxNSwgcGNoX3RyYW5zY29kZXIpOwo+ID4gICAJdW5zaWduZWQgbG9uZyBmbGFnczsK
PiA+ICAgCWJvb2wgb2xkOwo+ID4gQEAgLTMzNCw3MSArMzM0LDcxIEBAIGJvb2wgaW50ZWxfc2V0
X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAgIAkgKiBjcnRjIG9uIExQVCB3b24ndCBjYXVzZSBpc3N1ZXMuCj4gPiAgIAkg
Ki8KPiA+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT5pcnFfbG9jaywgZmxhZ3MpOwo+
ID4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+aXJxX2xvY2ssIGZsYWdzKTsKPiA+ICAgCW9s
ZCA9ICFjcnRjLT5wY2hfZmlmb191bmRlcnJ1bl9kaXNhYmxlZDsKPiA+ICAgCWNydGMtPnBjaF9m
aWZvX3VuZGVycnVuX2Rpc2FibGVkID0gIWVuYWJsZTsKPiA+IC0JaWYgKEhBU19QQ0hfSUJYKGRl
dl9wcml2KSkKPiA+IC0JCWlieF9zZXRfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoJmRldl9wcml2
LT5kcm0sCj4gPiArCWlmIChIQVNfUENIX0lCWChpOTE1KSkKPiA+ICsJCWlieF9zZXRfZmlmb191
bmRlcnJ1bl9yZXBvcnRpbmcoJmk5MTUtPmRybSwKPiA+ICAgCQkJCQkJcGNoX3RyYW5zY29kZXIs
Cj4gPiAgIAkJCQkJCWVuYWJsZSk7Cj4gPiAgIAllbHNlCj4gPiAtCQljcHRfc2V0X2ZpZm9fdW5k
ZXJydW5fcmVwb3J0aW5nKCZkZXZfcHJpdi0+ZHJtLAo+ID4gKwkJY3B0X3NldF9maWZvX3VuZGVy
cnVuX3JlcG9ydGluZygmaTkxNS0+ZHJtLAo+ID4gICAJCQkJCQlwY2hfdHJhbnNjb2RlciwKPiA+
ICAgCQkJCQkJZW5hYmxlLCBvbGQpOwo+ID4gLQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZf
cHJpdi0+aXJxX2xvY2ssIGZsYWdzKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkx
NS0+aXJxX2xvY2ssIGZsYWdzKTsKPiA+ICAgCXJldHVybiBvbGQ7Cj4gPiAgIH0KPiA+ICAgLyoq
Cj4gPiAgICAqIGludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyIC0gaGFuZGxlIENQ
VSBmaWZvIHVuZGVycnVuIGludGVycnVwdAo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2Ug
aW5zdGFuY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICAgICogQHBp
cGU6IChDUFUpIHBpcGUgdG8gc2V0IHN0YXRlIGZvcgo+ID4gICAgKgo+ID4gICAgKiBUaGlzIGhh
bmRsZXMgYSBDUFUgZmlmbyB1bmRlcnJ1biBpbnRlcnJ1cHQsIGdlbmVyYXRpbmcgYW4gdW5kZXJy
dW4gd2FybmluZwo+ID4gICAgKiBpbnRvIGRtZXNnIGlmIHVuZGVycnVuIHJlcG9ydGluZyBpcyBl
bmFibGVkIGFuZCB0aGVuIGRpc2FibGVzIHRoZSB1bmRlcnJ1bgo+ID4gICAgKiBpbnRlcnJ1cHQg
dG8gYXZvaWQgYW4gaXJxIHN0b3JtLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2NwdV9maWZv
X3VuZGVycnVuX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICt2b2lkIGludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJCSBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRl
dl9wcml2LCBwaXBlKTsKPiA+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBpbnRlbF9nZXRf
Y3J0Y19mb3JfcGlwZShpOTE1LCBwaXBlKTsKPiA+ICAgCS8qIFdlIG1heSBiZSBjYWxsZWQgdG9v
IGVhcmx5IGluIGluaXQsIHRoYW5rcyBCSU9TISAqLwo+ID4gICAJaWYgKGNydGMgPT0gTlVMTCkK
PiA+ICAgCQlyZXR1cm47Cj4gPiAgIAkvKiBHTUNIIGNhbid0IGRpc2FibGUgZmlmbyB1bmRlcnJ1
bnMsIGZpbHRlciB0aGVtLiAqLwo+ID4gLQlpZiAoSEFTX0dNQ0goZGV2X3ByaXYpICYmCj4gPiAr
CWlmIChIQVNfR01DSChpOTE1KSAmJgo+ID4gICAJICAgIGNydGMtPmNwdV9maWZvX3VuZGVycnVu
X2Rpc2FibGVkKQo+ID4gICAJCXJldHVybjsKPiA+IC0JaWYgKGludGVsX3NldF9jcHVfZmlmb191
bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIHBpcGUsIGZhbHNlKSkgewo+ID4gLQkJdHJhY2Vf
aW50ZWxfY3B1X2ZpZm9fdW5kZXJydW4oZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlpZiAoaW50ZWxf
c2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBwaXBlLCBmYWxzZSkpIHsKPiA+
ICsJCXRyYWNlX2ludGVsX2NwdV9maWZvX3VuZGVycnVuKGk5MTUsIHBpcGUpOwo+ID4gICAJCURS
TV9FUlJPUigiQ1BVIHBpcGUgJWMgRklGTyB1bmRlcnJ1blxuIiwKPiA+ICAgCQkJICBwaXBlX25h
bWUocGlwZSkpOwo+ID4gICAJfQo+ID4gLQlpbnRlbF9mYmNfaGFuZGxlX2ZpZm9fdW5kZXJydW5f
aXJxKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfZmJjX2hhbmRsZV9maWZvX3VuZGVycnVuX2lycShp
OTE1KTsKPiA+ICAgfQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfcGNoX2ZpZm9fdW5kZXJydW5f
aXJxX2hhbmRsZXIgLSBoYW5kbGUgUENIIGZpZm8gdW5kZXJydW4gaW50ZXJydXB0Cj4gPiAtICog
QGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmlj
ZSBpbnN0YW5jZQo+ID4gICAgKiBAcGNoX3RyYW5zY29kZXI6IHRoZSBQQ0ggdHJhbnNjb2RlciAo
c2FtZSBhcyBwaXBlIG9uIElWQiBhbmQgb2xkZXIpCj4gPiAgICAqCj4gPiAgICAqIFRoaXMgaGFu
ZGxlcyBhIFBDSCBmaWZvIHVuZGVycnVuIGludGVycnVwdCwgZ2VuZXJhdGluZyBhbiB1bmRlcnJ1
biB3YXJuaW5nCj4gPiAgICAqIGludG8gZG1lc2cgaWYgdW5kZXJydW4gcmVwb3J0aW5nIGlzIGVu
YWJsZWQgYW5kIHRoZW4gZGlzYWJsZXMgdGhlIHVuZGVycnVuCj4gPiAgICAqIGludGVycnVwdCB0
byBhdm9pZCBhbiBpcnEgc3Rvcm0uCj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfcGNoX2ZpZm9f
dW5kZXJydW5faXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3ZvaWQgaW50ZWxfcGNoX2ZpZm9fdW5kZXJydW5faXJxX2hhbmRsZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJIGVudW0gcGlwZSBwY2hfdHJhbnNjb2RlcikK
PiA+ICAgewo+ID4gLQlpZiAoaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhk
ZXZfcHJpdiwgcGNoX3RyYW5zY29kZXIsCj4gPiArCWlmIChpbnRlbF9zZXRfcGNoX2ZpZm9fdW5k
ZXJydW5fcmVwb3J0aW5nKGk5MTUsIHBjaF90cmFuc2NvZGVyLAo+ID4gICAJCQkJCQkgIGZhbHNl
KSkgewo+ID4gLQkJdHJhY2VfaW50ZWxfcGNoX2ZpZm9fdW5kZXJydW4oZGV2X3ByaXYsIHBjaF90
cmFuc2NvZGVyKTsKPiA+ICsJCXRyYWNlX2ludGVsX3BjaF9maWZvX3VuZGVycnVuKGk5MTUsIHBj
aF90cmFuc2NvZGVyKTsKPiA+ICAgCQlEUk1fRVJST1IoIlBDSCB0cmFuc2NvZGVyICVjIEZJRk8g
dW5kZXJydW5cbiIsCj4gPiAgIAkJCSAgcGlwZV9uYW1lKHBjaF90cmFuc2NvZGVyKSk7Cj4gPiAg
IAl9Cj4gPiBAQCAtNDA2LDUzICs0MDYsNTMgQEAgdm9pZCBpbnRlbF9wY2hfZmlmb191bmRlcnJ1
bl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIC8q
Kgo+ID4gICAgKiBpbnRlbF9jaGVja19jcHVfZmlmb191bmRlcnJ1bnMgLSBjaGVjayBmb3IgQ1BV
IGZpZm8gdW5kZXJydW5zIGltbWVkaWF0ZWx5Cj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRldmlj
ZSBpbnN0YW5jZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQo+ID4gICAgKgo+
ID4gICAgKiBDaGVjayBmb3IgQ1BVIGZpZm8gdW5kZXJydW5zIGltbWVkaWF0ZWx5LiBVc2VmdWwg
b24gSVZCL0hTVyB3aGVyZSB0aGUgc2hhcmVkCj4gPiAgICAqIGVycm9yIGludGVycnVwdCBtYXkg
aGF2ZSBiZWVuIGRpc2FibGVkLCBhbmQgc28gQ1BVIGZpZm8gdW5kZXJydW5zIHdvbid0Cj4gPiAg
ICAqIG5lY2Vzc2FyaWx5IHJhaXNlIGFuIGludGVycnVwdCwgYW5kIG9uIEdNQ0ggcGxhdGZvcm1z
IHdoZXJlIHVuZGVycnVucyBuZXZlcgo+ID4gICAgKiByYWlzZSBhbiBpbnRlcnJ1cHQuCj4gPiAg
ICAqLwo+ID4gLXZvaWQgaW50ZWxfY2hlY2tfY3B1X2ZpZm9fdW5kZXJydW5zKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGludGVsX2NoZWNrX2NwdV9maWZvX3Vu
ZGVycnVucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJc3Ry
dWN0IGludGVsX2NydGMgKmNydGM7Cj4gPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFf
bG9jayk7Cj4gPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+IC0JZm9yX2Vh
Y2hfaW50ZWxfY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0Yykgewo+ID4gKwlmb3JfZWFjaF9pbnRl
bF9jcnRjKCZpOTE1LT5kcm0sIGNydGMpIHsKPiA+ICAgCQlpZiAoY3J0Yy0+Y3B1X2ZpZm9fdW5k
ZXJydW5fZGlzYWJsZWQpCj4gPiAgIAkJCWNvbnRpbnVlOwo+ID4gLQkJaWYgKEhBU19HTUNIKGRl
dl9wcml2KSkKPiA+ICsJCWlmIChIQVNfR01DSChpOTE1KSkKPiA+ICAgCQkJaTl4eF9jaGVja19m
aWZvX3VuZGVycnVucyhjcnRjKTsKPiA+IC0JCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgNykp
Cj4gPiArCQllbHNlIGlmIChJU19HRU4oaTkxNSwgNykpCj4gPiAgIAkJCWl2eWJyaWRnZV9jaGVj
a19maWZvX3VuZGVycnVucyhjcnRjKTsKPiA+ICAgCX0KPiA+IC0Jc3Bpbl91bmxvY2tfaXJxKCZk
ZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGluX3VubG9ja19pcnEoJmk5MTUtPmlycV9sb2Nr
KTsKPiA+ICAgfQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfY2hlY2tfcGNoX2ZpZm9fdW5kZXJy
dW5zIC0gY2hlY2sgZm9yIFBDSCBmaWZvIHVuZGVycnVucyBpbW1lZGlhdGVseQo+ID4gLSAqIEBk
ZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2Ug
aW5zdGFuY2UKPiA+ICAgICoKPiA+ICAgICogQ2hlY2sgZm9yIFBDSCBmaWZvIHVuZGVycnVucyBp
bW1lZGlhdGVseS4gVXNlZnVsIG9uIENQVC9QUFQgd2hlcmUgdGhlIHNoYXJlZAo+ID4gICAgKiBl
cnJvciBpbnRlcnJ1cHQgbWF5IGhhdmUgYmVlbiBkaXNhYmxlZCwgYW5kIHNvIFBDSCBmaWZvIHVu
ZGVycnVucyB3b24ndAo+ID4gICAgKiBuZWNlc3NhcmlseSByYWlzZSBhbiBpbnRlcnJ1cHQuCj4g
PiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfY2hlY2tfcGNoX2ZpZm9fdW5kZXJydW5zKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGludGVsX2NoZWNrX3BjaF9maWZv
X3VuZGVycnVucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJ
c3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gPiAtCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5p
cnFfbG9jayk7Cj4gPiArCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+IC0JZm9y
X2VhY2hfaW50ZWxfY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0Yykgewo+ID4gKwlmb3JfZWFjaF9p
bnRlbF9jcnRjKCZpOTE1LT5kcm0sIGNydGMpIHsKPiA+ICAgCQlpZiAoY3J0Yy0+cGNoX2ZpZm9f
dW5kZXJydW5fZGlzYWJsZWQpCj4gPiAgIAkJCWNvbnRpbnVlOwo+ID4gLQkJaWYgKEhBU19QQ0hf
Q1BUKGRldl9wcml2KSkKPiA+ICsJCWlmIChIQVNfUENIX0NQVChpOTE1KSkKPiA+ICAgCQkJY3B0
X2NoZWNrX3BjaF9maWZvX3VuZGVycnVucyhjcnRjKTsKPiA+ICAgCX0KPiA+IC0Jc3Bpbl91bmxv
Y2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGluX3VubG9ja19pcnEoJmk5MTUt
PmlycV9sb2NrKTsKPiA+ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2ZpZm9fdW5kZXJydW4uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZpZm9f
dW5kZXJydW4uaAo+ID4gaW5kZXggZTA0ZjIyYWMxZjQ5Li4yOTA5MDlhNjdkZTggMTAwNjQ0Cj4g
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9maWZvX3VuZGVycnVuLmgKPiA+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2ZpZm9fdW5kZXJydW4uaAo+ID4gQEAgLTEy
LDE2ICsxMiwxNiBAQAo+ID4gICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiA+IC1ib29sIGlu
dGVsX3NldF9jcHVfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK2Jvb2wgaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9y
dGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgICBlbnVtIHBp
cGUgcGlwZSwgYm9vbCBlbmFibGUpOwo+ID4gLWJvb2wgaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVy
cnVuX3JlcG9ydGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArYm9v
bCBpbnRlbF9zZXRfcGNoX2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ID4gICAJCQkJCSAgIGVudW0gcGlwZSBwY2hfdHJhbnNjb2RlciwKPiA+
ICAgCQkJCQkgICBib29sIGVuYWJsZSk7Cj4gPiAtdm9pZCBpbnRlbF9jcHVfZmlmb191bmRlcnJ1
bl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9p
ZCBpbnRlbF9jcHVfZmlmb191bmRlcnJ1bl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQkgZW51bSBwaXBlIHBpcGUpOwo+ID4gLXZvaWQgaW50ZWxf
cGNoX2ZpZm9fdW5kZXJydW5faXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gK3ZvaWQgaW50ZWxfcGNoX2ZpZm9fdW5kZXJydW5faXJxX2hhbmRsZXIoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJIGVudW0gcGlwZSBwY2hfdHJh
bnNjb2Rlcik7Cj4gPiAtdm9pZCBpbnRlbF9jaGVja19jcHVfZmlmb191bmRlcnJ1bnMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGludGVsX2NoZWNrX3BjaF9m
aWZvX3VuZGVycnVucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3Zv
aWQgaW50ZWxfY2hlY2tfY3B1X2ZpZm9fdW5kZXJydW5zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KTsKPiA+ICt2b2lkIGludGVsX2NoZWNrX3BjaF9maWZvX3VuZGVycnVucyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgICNlbmRpZiAvKiBfX0lOVEVMX0ZJRk9fVU5E
RVJSVU5fSF9fICovCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
ZnJvbnRidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Zyb250YnVmZmVyLmMK
PiA+IGluZGV4IGQ2MDM2YjlhZDE2YS4uMTYxMTM5ZGUzZjI4IDEwMDY0NAo+ID4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZnJvbnRidWZmZXIuYwo+ID4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfZnJvbnRidWZmZXIuYwo+ID4gQEAgLTY2LDI0ICs2NiwyNCBAQCB2
b2lkIF9faW50ZWxfZmJfb2JqX2ludmFsaWRhdGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaiwKPiA+ICAgCQkJICAgICAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwKPiA+ICAgCQkJ
ICAgICAgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2
KTsKPiA+ICAgCWlmIChvcmlnaW4gPT0gT1JJR0lOX0NTKSB7Cj4gPiAtCQlzcGluX2xvY2soJmRl
dl9wcml2LT5mYl90cmFja2luZy5sb2NrKTsKPiA+IC0JCWRldl9wcml2LT5mYl90cmFja2luZy5i
dXN5X2JpdHMgfD0gZnJvbnRidWZmZXJfYml0czsKPiA+IC0JCWRldl9wcml2LT5mYl90cmFja2lu
Zy5mbGlwX2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Cj4gPiAtCQlzcGluX3VubG9jaygmZGV2
X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwo+ID4gKwkJc3Bpbl9sb2NrKCZpOTE1LT5mYl90cmFj
a2luZy5sb2NrKTsKPiA+ICsJCWk5MTUtPmZiX3RyYWNraW5nLmJ1c3lfYml0cyB8PSBmcm9udGJ1
ZmZlcl9iaXRzOwo+ID4gKwkJaTkxNS0+ZmJfdHJhY2tpbmcuZmxpcF9iaXRzICY9IH5mcm9udGJ1
ZmZlcl9iaXRzOwo+ID4gKwkJc3Bpbl91bmxvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwo+
ID4gICAJfQo+ID4gICAJbWlnaHRfc2xlZXAoKTsKPiA+IC0JaW50ZWxfcHNyX2ludmFsaWRhdGUo
ZGV2X3ByaXYsIGZyb250YnVmZmVyX2JpdHMsIG9yaWdpbik7Cj4gPiAtCWludGVsX2VkcF9kcnJz
X2ludmFsaWRhdGUoZGV2X3ByaXYsIGZyb250YnVmZmVyX2JpdHMpOwo+ID4gLQlpbnRlbF9mYmNf
aW52YWxpZGF0ZShkZXZfcHJpdiwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsKPiA+ICsJaW50
ZWxfcHNyX2ludmFsaWRhdGUoaTkxNSwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsKPiA+ICsJ
aW50ZWxfZWRwX2RycnNfaW52YWxpZGF0ZShpOTE1LCBmcm9udGJ1ZmZlcl9iaXRzKTsKPiA+ICsJ
aW50ZWxfZmJjX2ludmFsaWRhdGUoaTkxNSwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsKPiA+
ICAgfQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfZnJvbnRidWZmZXJfZmx1c2ggLSBmbHVzaCBm
cm9udGJ1ZmZlcgo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKPiA+ICsgKiBAaTkxNTog
aTkxNSBkZXZpY2UKPiA+ICAgICogQGZyb250YnVmZmVyX2JpdHM6IGZyb250YnVmZmVyIHBsYW5l
IHRyYWNraW5nIGJpdHMKPiA+ICAgICogQG9yaWdpbjogd2hpY2ggb3BlcmF0aW9uIGNhdXNlZCB0
aGUgZmx1c2gKPiA+ICAgICoKPiA+IEBAIC05Myw0NSArOTMsNDUgQEAgdm9pZCBfX2ludGVsX2Zi
X29ial9pbnZhbGlkYXRlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gPiAgICAq
Cj4gPiAgICAqIENhbiBiZSBjYWxsZWQgd2l0aG91dCBhbnkgbG9ja3MgaGVsZC4KPiA+ICAgICov
Cj4gPiAtc3RhdGljIHZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmx1c2goc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGludGVsX2Zyb250YnVmZmVyX2Zs
dXNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgIHVuc2lnbmVk
IGZyb250YnVmZmVyX2JpdHMsCj4gPiAgIAkJCQkgICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2lu
KQo+ID4gICB7Cj4gPiAgIAkvKiBEZWxheSBmbHVzaGluZyB3aGVuIHJpbmdzIGFyZSBzdGlsbCBi
dXN5LiovCj4gPiAtCXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwo+ID4g
LQlmcm9udGJ1ZmZlcl9iaXRzICY9IH5kZXZfcHJpdi0+ZmJfdHJhY2tpbmcuYnVzeV9iaXRzOwo+
ID4gLQlzcGluX3VubG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwo+ID4gKwlzcGlu
X2xvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwo+ID4gKwlmcm9udGJ1ZmZlcl9iaXRzICY9
IH5pOTE1LT5mYl90cmFja2luZy5idXN5X2JpdHM7Cj4gPiArCXNwaW5fdW5sb2NrKCZpOTE1LT5m
Yl90cmFja2luZy5sb2NrKTsKPiA+ICAgCWlmICghZnJvbnRidWZmZXJfYml0cykKPiA+ICAgCQly
ZXR1cm47Cj4gPiAgIAltaWdodF9zbGVlcCgpOwo+ID4gLQlpbnRlbF9lZHBfZHJyc19mbHVzaChk
ZXZfcHJpdiwgZnJvbnRidWZmZXJfYml0cyk7Cj4gPiAtCWludGVsX3Bzcl9mbHVzaChkZXZfcHJp
diwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsKPiA+IC0JaW50ZWxfZmJjX2ZsdXNoKGRldl9w
cml2LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwo+ID4gKwlpbnRlbF9lZHBfZHJyc19mbHVz
aChpOTE1LCBmcm9udGJ1ZmZlcl9iaXRzKTsKPiA+ICsJaW50ZWxfcHNyX2ZsdXNoKGk5MTUsIGZy
b250YnVmZmVyX2JpdHMsIG9yaWdpbik7Cj4gPiArCWludGVsX2ZiY19mbHVzaChpOTE1LCBmcm9u
dGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwo+ID4gICB9Cj4gPiAgIHZvaWQgX19pbnRlbF9mYl9vYmpf
Zmx1c2goc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiA+ICAgCQkJICBlbnVtIGZi
X29wX29yaWdpbiBvcmlnaW4sCj4gPiAgIAkJCSAgdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2Jp
dHMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShvYmotPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwo+ID4gICAJaWYgKG9yaWdpbiA9PSBPUklHSU5fQ1Mp
IHsKPiA+IC0JCXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwo+ID4gKwkJ
c3Bpbl9sb2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKPiA+ICAgCQkvKiBGaWx0ZXIgb3V0
IG5ldyBiaXRzIHNpbmNlIHJlbmRlcmluZyBzdGFydGVkLiAqLwo+ID4gLQkJZnJvbnRidWZmZXJf
Yml0cyAmPSBkZXZfcHJpdi0+ZmJfdHJhY2tpbmcuYnVzeV9iaXRzOwo+ID4gLQkJZGV2X3ByaXYt
PmZiX3RyYWNraW5nLmJ1c3lfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKPiA+IC0JCXNwaW5f
dW5sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Cj4gPiArCQlmcm9udGJ1ZmZlcl9i
aXRzICY9IGk5MTUtPmZiX3RyYWNraW5nLmJ1c3lfYml0czsKPiA+ICsJCWk5MTUtPmZiX3RyYWNr
aW5nLmJ1c3lfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKPiA+ICsJCXNwaW5fdW5sb2NrKCZp
OTE1LT5mYl90cmFja2luZy5sb2NrKTsKPiA+ICAgCX0KPiA+ICAgCWlmIChmcm9udGJ1ZmZlcl9i
aXRzKQo+ID4gLQkJaW50ZWxfZnJvbnRidWZmZXJfZmx1c2goZGV2X3ByaXYsIGZyb250YnVmZmVy
X2JpdHMsIG9yaWdpbik7Cj4gPiArCQlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaChpOTE1LCBmcm9u
dGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9m
cm9udGJ1ZmZlcl9mbGlwX3ByZXBhcmUgLSBwcmVwYXJlIGFzeW5jaHJvbm91cyBmcm9udGJ1ZmZl
ciBmbGlwCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZQo+ID4gKyAqIEBpOTE1OiBpOTE1
IGRldmljZQo+ID4gICAgKiBAZnJvbnRidWZmZXJfYml0czogZnJvbnRidWZmZXIgcGxhbmUgdHJh
Y2tpbmcgYml0cwo+ID4gICAgKgo+ID4gICAgKiBUaGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIGFm
dGVyIHNjaGVkdWxpbmcgYSBmbGlwIG9uIEBvYmouIFRoZSBhY3R1YWwKPiA+IEBAIC0xNDEsMTkg
KzE0MSwxOSBAQCB2b2lkIF9faW50ZWxfZmJfb2JqX2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmosCj4gPiAgICAqCj4gPiAgICAqIENhbiBiZSBjYWxsZWQgd2l0aG91dCBhbnkg
bG9ja3MgaGVsZC4KPiA+ICAgICovCj4gPiAtdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX3By
ZXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgaW50ZWxf
ZnJvbnRidWZmZXJfZmxpcF9wcmVwYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ID4gICAJCQkJICAgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMpCj4gPiAgIHsKPiA+IC0Jc3Bp
bl9sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Cj4gPiAtCWRldl9wcml2LT5mYl90
cmFja2luZy5mbGlwX2JpdHMgfD0gZnJvbnRidWZmZXJfYml0czsKPiA+ICsJc3Bpbl9sb2NrKCZp
OTE1LT5mYl90cmFja2luZy5sb2NrKTsKPiA+ICsJaTkxNS0+ZmJfdHJhY2tpbmcuZmxpcF9iaXRz
IHw9IGZyb250YnVmZmVyX2JpdHM7Cj4gPiAgIAkvKiBSZW1vdmUgc3RhbGUgYnVzeSBiaXRzIGR1
ZSB0byB0aGUgb2xkIGJ1ZmZlci4gKi8KPiA+IC0JZGV2X3ByaXYtPmZiX3RyYWNraW5nLmJ1c3lf
Yml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKPiA+IC0Jc3Bpbl91bmxvY2soJmRldl9wcml2LT5m
Yl90cmFja2luZy5sb2NrKTsKPiA+ICsJaTkxNS0+ZmJfdHJhY2tpbmcuYnVzeV9iaXRzICY9IH5m
cm9udGJ1ZmZlcl9iaXRzOwo+ID4gKwlzcGluX3VubG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9j
ayk7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfY29t
cGxldGUgLSBjb21wbGV0ZSBhc3luY2hyb25vdXMgZnJvbnRidWZmZXIgZmxpcAo+ID4gLSAqIEBk
ZXZfcHJpdjogaTkxNSBkZXZpY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UKPiA+ICAgICog
QGZyb250YnVmZmVyX2JpdHM6IGZyb250YnVmZmVyIHBsYW5lIHRyYWNraW5nIGJpdHMKPiA+ICAg
ICoKPiA+ICAgICogVGhpcyBmdW5jdGlvbiBnZXRzIGNhbGxlZCBhZnRlciB0aGUgZmxpcCBoYXMg
YmVlbiBsYXRjaGVkIGFuZCB3aWxsIGNvbXBsZXRlCj4gPiBAQCAtMTYxLDIzICsxNjEsMjMgQEAg
dm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX3ByZXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gICAgKgo+ID4gICAgKiBDYW4gYmUgY2FsbGVkIHdpdGhvdXQgYW55
IGxvY2tzIGhlbGQuCj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9j
b21wbGV0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpbnRl
bF9mcm9udGJ1ZmZlcl9mbGlwX2NvbXBsZXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ID4gICAJCQkJICAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzKQo+ID4gICB7Cj4gPiAt
CXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwo+ID4gKwlzcGluX2xvY2so
Jmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwo+ID4gICAJLyogTWFzayBhbnkgY2FuY2VsbGVkIGZs
aXBzLiAqLwo+ID4gLQlmcm9udGJ1ZmZlcl9iaXRzICY9IGRldl9wcml2LT5mYl90cmFja2luZy5m
bGlwX2JpdHM7Cj4gPiAtCWRldl9wcml2LT5mYl90cmFja2luZy5mbGlwX2JpdHMgJj0gfmZyb250
YnVmZmVyX2JpdHM7Cj4gPiAtCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9j
ayk7Cj4gPiArCWZyb250YnVmZmVyX2JpdHMgJj0gaTkxNS0+ZmJfdHJhY2tpbmcuZmxpcF9iaXRz
Owo+ID4gKwlpOTE1LT5mYl90cmFja2luZy5mbGlwX2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7
Cj4gPiArCXNwaW5fdW5sb2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKPiA+ICAgCWlmIChm
cm9udGJ1ZmZlcl9iaXRzKQo+ID4gLQkJaW50ZWxfZnJvbnRidWZmZXJfZmx1c2goZGV2X3ByaXYs
Cj4gPiArCQlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaChpOTE1LAo+ID4gICAJCQkJCWZyb250YnVm
ZmVyX2JpdHMsIE9SSUdJTl9GTElQKTsKPiA+ICAgfQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxf
ZnJvbnRidWZmZXJfZmxpcCAtIHN5bmNocm9ub3VzIGZyb250YnVmZmVyIGZsaXAKPiA+IC0gKiBA
ZGV2X3ByaXY6IGk5MTUgZGV2aWNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlCj4gPiAgICAq
IEBmcm9udGJ1ZmZlcl9iaXRzOiBmcm9udGJ1ZmZlciBwbGFuZSB0cmFja2luZyBiaXRzCj4gPiAg
ICAqCj4gPiAgICAqIFRoaXMgZnVuY3Rpb24gZ2V0cyBjYWxsZWQgYWZ0ZXIgc2NoZWR1bGluZyBh
IGZsaXAgb24gQG9iai4gVGhpcyBpcyBmb3IKPiA+IEBAIC0xODYsMTMgKzE4NiwxMyBAQCB2b2lk
IGludGVsX2Zyb250YnVmZmVyX2ZsaXBfY29tcGxldGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gICAgKgo+ID4gICAgKiBDYW4gYmUgY2FsbGVkIHdpdGhvdXQgYW55IGxv
Y2tzIGhlbGQuCj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpbnRlbF9mcm9udGJ1ZmZl
cl9mbGlwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgdW5zaWdu
ZWQgZnJvbnRidWZmZXJfYml0cykKPiA+ICAgewo+ID4gLQlzcGluX2xvY2soJmRldl9wcml2LT5m
Yl90cmFja2luZy5sb2NrKTsKPiA+ICsJc3Bpbl9sb2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2Nr
KTsKPiA+ICAgCS8qIFJlbW92ZSBzdGFsZSBidXN5IGJpdHMgZHVlIHRvIHRoZSBvbGQgYnVmZmVy
LiAqLwo+ID4gLQlkZXZfcHJpdi0+ZmJfdHJhY2tpbmcuYnVzeV9iaXRzICY9IH5mcm9udGJ1ZmZl
cl9iaXRzOwo+ID4gLQlzcGluX3VubG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwo+
ID4gKwlpOTE1LT5mYl90cmFja2luZy5idXN5X2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Cj4g
PiArCXNwaW5fdW5sb2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKPiA+IC0JaW50ZWxfZnJv
bnRidWZmZXJfZmx1c2goZGV2X3ByaXYsIGZyb250YnVmZmVyX2JpdHMsIE9SSUdJTl9GTElQKTsK
PiA+ICsJaW50ZWxfZnJvbnRidWZmZXJfZmx1c2goaTkxNSwgZnJvbnRidWZmZXJfYml0cywgT1JJ
R0lOX0ZMSVApOwo+ID4gICB9Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfZnJvbnRidWZmZXIuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Zyb250YnVm
ZmVyLmgKPiA+IGluZGV4IDU3MjczMjBjODA4NC4uNTVjNDJlZmVlN2NlIDEwMDY0NAo+ID4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZnJvbnRidWZmZXIuaAo+ID4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZnJvbnRidWZmZXIuaAo+ID4gQEAgLTM3LDExICszNywx
MSBAQCBlbnVtIGZiX29wX29yaWdpbiB7Cj4gPiAgIAlPUklHSU5fRElSVFlGQiwKPiA+ICAgfTsK
PiA+IC12b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX3ByZXBh
cmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgdW5zaWduZWQg
ZnJvbnRidWZmZXJfYml0cyk7Cj4gPiAtdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX2NvbXBs
ZXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2Zy
b250YnVmZmVyX2ZsaXBfY29tcGxldGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgIAkJCQkgICAgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMpOwo+ID4gLXZvaWQgaW50ZWxf
ZnJvbnRidWZmZXJfZmxpcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAr
dm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ID4gICAJCQkgICAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cyk7Cj4gPiAgIHZvaWQgX19p
bnRlbF9mYl9vYmpfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+
ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2dtYnVzLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9nbWJ1cy5jCj4gPiBpbmRleCBhYTg4ZTZlN2NjNjUuLmYx
Yjk4NDRiNTkxZSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2dt
YnVzLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2dtYnVzLmMKPiA+IEBA
IC04OSw0MiArODksNDIgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBnbWJ1c19waW4gZ21idXNfcGlu
c19pY3BbXSA9IHsKPiA+ICAgfTsKPiA+ICAgLyogcGluIGlzIGV4cGVjdGVkIHRvIGJlIHZhbGlk
ICovCj4gPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBnbWJ1c19waW4gKmdldF9nbWJ1c19waW4oc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBjb25zdCBzdHJ1Y3Qg
Z21idXNfcGluICpnZXRfZ21idXNfcGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ID4gICAJCQkJCSAgICAgdW5zaWduZWQgaW50IHBpbikKPiA+ICAgewo+ID4gLQlpZiAoSEFTX1BD
SF9JQ1AoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFTX1BDSF9JQ1AoaTkxNSkpCj4gPiAgIAkJcmV0
dXJuICZnbWJ1c19waW5zX2ljcFtwaW5dOwo+ID4gLQllbHNlIGlmIChIQVNfUENIX0NOUChkZXZf
cHJpdikpCj4gPiArCWVsc2UgaWYgKEhBU19QQ0hfQ05QKGk5MTUpKQo+ID4gICAJCXJldHVybiAm
Z21idXNfcGluc19jbnBbcGluXTsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikp
Cj4gPiArCWVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gPiAgIAkJcmV0dXJuICZnbWJ1c19w
aW5zX2J4dFtwaW5dOwo+ID4gLQllbHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2KSkKPiA+ICsJ
ZWxzZSBpZiAoSVNfR0VOOV9CQyhpOTE1KSkKPiA+ICAgCQlyZXR1cm4gJmdtYnVzX3BpbnNfc2ts
W3Bpbl07Cj4gPiAtCWVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpCj4gPiArCWVsc2Ug
aWYgKElTX0JST0FEV0VMTChpOTE1KSkKPiA+ICAgCQlyZXR1cm4gJmdtYnVzX3BpbnNfYmR3W3Bp
bl07Cj4gPiAgIAllbHNlCj4gPiAgIAkJcmV0dXJuICZnbWJ1c19waW5zW3Bpbl07Cj4gPiAgIH0K
PiA+IC1ib29sIGludGVsX2dtYnVzX2lzX3ZhbGlkX3BpbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiArYm9vbCBpbnRlbF9nbWJ1c19pc192YWxpZF9waW4oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgIHVuc2lnbmVkIGludCBwaW4pCj4g
PiAgIHsKPiA+ICAgCXVuc2lnbmVkIGludCBzaXplOwo+ID4gLQlpZiAoSEFTX1BDSF9JQ1AoZGV2
X3ByaXYpKQo+ID4gKwlpZiAoSEFTX1BDSF9JQ1AoaTkxNSkpCj4gPiAgIAkJc2l6ZSA9IEFSUkFZ
X1NJWkUoZ21idXNfcGluc19pY3ApOwo+ID4gLQllbHNlIGlmIChIQVNfUENIX0NOUChkZXZfcHJp
dikpCj4gPiArCWVsc2UgaWYgKEhBU19QQ0hfQ05QKGk5MTUpKQo+ID4gICAJCXNpemUgPSBBUlJB
WV9TSVpFKGdtYnVzX3BpbnNfY25wKTsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJp
dikpCj4gPiArCWVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gPiAgIAkJc2l6ZSA9IEFSUkFZ
X1NJWkUoZ21idXNfcGluc19ieHQpOwo+ID4gLQllbHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2
KSkKPiA+ICsJZWxzZSBpZiAoSVNfR0VOOV9CQyhpOTE1KSkKPiA+ICAgCQlzaXplID0gQVJSQVlf
U0laRShnbWJ1c19waW5zX3NrbCk7Cj4gPiAtCWVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJp
dikpCj4gPiArCWVsc2UgaWYgKElTX0JST0FEV0VMTChpOTE1KSkKPiA+ICAgCQlzaXplID0gQVJS
QVlfU0laRShnbWJ1c19waW5zX2Jkdyk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJc2l6ZSA9IEFSUkFZ
X1NJWkUoZ21idXNfcGlucyk7Cj4gPiAtCXJldHVybiBwaW4gPCBzaXplICYmIGdldF9nbWJ1c19w
aW4oZGV2X3ByaXYsIHBpbiktPm5hbWU7Cj4gPiArCXJldHVybiBwaW4gPCBzaXplICYmIGdldF9n
bWJ1c19waW4oaTkxNSwgcGluKS0+bmFtZTsKPiA+ICAgfQo+ID4gICAvKiBJbnRlbCBHUElPIGFj
Y2VzcyBmdW5jdGlvbnMgKi8KPiA+IEBAIC0xMzgsMTMgKzEzOCwxMyBAQCB0b19pbnRlbF9nbWJ1
cyhzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmkyYykKPiA+ICAgfQo+ID4gICB2b2lkCj4gPiAtaW50ZWxf
Z21idXNfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludGVs
X2dtYnVzX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAg
IAlJOTE1X1dSSVRFKEdNQlVTMCwgMCk7Cj4gPiAgIAlJOTE1X1dSSVRFKEdNQlVTNCwgMCk7Cj4g
PiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBwbnZfZ21idXNfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBwbnZfZ21idXNfY2xvY2tf
Z2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgYm9vbCBl
bmFibGUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7Cj4gPiBAQCAtMTU4LDcgKzE1OCw3IEBAIHN0
YXRpYyB2b2lkIHBudl9nbWJ1c19jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gICAJSTkxNV9XUklURShEU1BDTEtfR0FURV9ELCB2YWwpOwo+ID4gICB9
Cj4gPiAtc3RhdGljIHZvaWQgcGNoX2dtYnVzX2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgcGNoX2dtYnVzX2Nsb2NrX2dhdGlu
ZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgIGJvb2wgZW5hYmxl
KQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gQEAgLTE3MSw3ICsxNzEsNyBAQCBzdGF0aWMg
dm9pZCBwY2hfZ21idXNfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICAgCUk5MTVfV1JJVEUoU09VVEhfRFNQQ0xLX0dBVEVfRCwgdmFsKTsKPiA+ICAg
fQo+ID4gLXN0YXRpYyB2b2lkIGJ4dF9nbWJ1c19jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGJ4dF9nbWJ1c19jbG9ja19nYXRp
bmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICBib29sIGVuYWJs
ZSkKPiA+ICAgewo+ID4gICAJdTMyIHZhbDsKPiA+IEBAIC0xODYsNyArMTg2LDcgQEAgc3RhdGlj
IHZvaWQgYnh0X2dtYnVzX2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAgIHN0YXRpYyB1MzIgZ2V0X3Jlc2VydmVkKHN0cnVjdCBpbnRlbF9nbWJ1cyAq
YnVzKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYnVzLT5k
ZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBidXMtPmk5MTU7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ID4g
ICAJdTMyIHJlc2VydmVkID0gMDsKPiA+IEBAIC0yMDIsNyArMjAyLDcgQEAgc3RhdGljIHUzMiBn
ZXRfcmVzZXJ2ZWQoc3RydWN0IGludGVsX2dtYnVzICpidXMpCj4gPiAgIHN0YXRpYyBpbnQgZ2V0
X2Nsb2NrKHZvaWQgKmRhdGEpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9nbWJ1cyAqYnVz
ID0gZGF0YTsKPiA+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmJ1cy0+ZGV2X3By
aXYtPnVuY29yZTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmJ1cy0+aTkx
NS0+dW5jb3JlOwo+ID4gICAJdTMyIHJlc2VydmVkID0gZ2V0X3Jlc2VydmVkKGJ1cyk7Cj4gPiAg
IAlpbnRlbF91bmNvcmVfd3JpdGVfbm90cmFjZSh1bmNvcmUsCj4gPiBAQCAtMjE3LDcgKzIxNyw3
IEBAIHN0YXRpYyBpbnQgZ2V0X2Nsb2NrKHZvaWQgKmRhdGEpCj4gPiAgIHN0YXRpYyBpbnQgZ2V0
X2RhdGEodm9pZCAqZGF0YSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2dtYnVzICpidXMg
PSBkYXRhOwo+ID4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmYnVzLT5kZXZfcHJp
di0+dW5jb3JlOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmYnVzLT5pOTE1
LT51bmNvcmU7Cj4gPiAgIAl1MzIgcmVzZXJ2ZWQgPSBnZXRfcmVzZXJ2ZWQoYnVzKTsKPiA+ICAg
CWludGVsX3VuY29yZV93cml0ZV9ub3RyYWNlKHVuY29yZSwKPiA+IEBAIC0yMzIsNyArMjMyLDcg
QEAgc3RhdGljIGludCBnZXRfZGF0YSh2b2lkICpkYXRhKQo+ID4gICBzdGF0aWMgdm9pZCBzZXRf
Y2xvY2sodm9pZCAqZGF0YSwgaW50IHN0YXRlX2hpZ2gpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9nbWJ1cyAqYnVzID0gZGF0YTsKPiA+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3Jl
ID0gJmJ1cy0+ZGV2X3ByaXYtPnVuY29yZTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5j
b3JlID0gJmJ1cy0+aTkxNS0+dW5jb3JlOwo+ID4gICAJdTMyIHJlc2VydmVkID0gZ2V0X3Jlc2Vy
dmVkKGJ1cyk7Cj4gPiAgIAl1MzIgY2xvY2tfYml0czsKPiA+IEBAIC0yNTEsNyArMjUxLDcgQEAg
c3RhdGljIHZvaWQgc2V0X2Nsb2NrKHZvaWQgKmRhdGEsIGludCBzdGF0ZV9oaWdoKQo+ID4gICBz
dGF0aWMgdm9pZCBzZXRfZGF0YSh2b2lkICpkYXRhLCBpbnQgc3RhdGVfaGlnaCkKPiA+ICAgewo+
ID4gICAJc3RydWN0IGludGVsX2dtYnVzICpidXMgPSBkYXRhOwo+ID4gLQlzdHJ1Y3QgaW50ZWxf
dW5jb3JlICp1bmNvcmUgPSAmYnVzLT5kZXZfcHJpdi0+dW5jb3JlOwo+ID4gKwlzdHJ1Y3QgaW50
ZWxfdW5jb3JlICp1bmNvcmUgPSAmYnVzLT5pOTE1LT51bmNvcmU7Cj4gPiAgIAl1MzIgcmVzZXJ2
ZWQgPSBnZXRfcmVzZXJ2ZWQoYnVzKTsKPiA+ICAgCXUzMiBkYXRhX2JpdHM7Cj4gPiBAQCAtMjcx
LDEyICsyNzEsMTIgQEAgaW50ZWxfZ3Bpb19wcmVfeGZlcihzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFk
YXB0ZXIpCj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZ21idXMgKmJ1cyA9IGNvbnRhaW5lcl9vZihhZGFw
dGVyLAo+ID4gICAJCQkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfZ21idXMsCj4gPiAgIAkJCQkJICAg
ICAgIGFkYXB0ZXIpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBi
dXMtPmRldl9wcml2Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGJ1cy0+
aTkxNTsKPiA+IC0JaW50ZWxfZ21idXNfcmVzZXQoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9nbWJ1
c19yZXNldChpOTE1KTsKPiA+IC0JaWYgKElTX1BJTkVWSUVXKGRldl9wcml2KSkKPiA+IC0JCXBu
dl9nbWJ1c19jbG9ja19nYXRpbmcoZGV2X3ByaXYsIGZhbHNlKTsKPiA+ICsJaWYgKElTX1BJTkVW
SUVXKGk5MTUpKQo+ID4gKwkJcG52X2dtYnVzX2Nsb2NrX2dhdGluZyhpOTE1LCBmYWxzZSk7Cj4g
PiAgIAlzZXRfZGF0YShidXMsIDEpOwo+ID4gICAJc2V0X2Nsb2NrKGJ1cywgMSk7Cj4gPiBAQCAt
MjkwLDI0ICsyOTAsMjQgQEAgaW50ZWxfZ3Bpb19wb3N0X3hmZXIoc3RydWN0IGkyY19hZGFwdGVy
ICphZGFwdGVyKQo+ID4gICAJc3RydWN0IGludGVsX2dtYnVzICpidXMgPSBjb250YWluZXJfb2Yo
YWRhcHRlciwKPiA+ICAgCQkJCQkgICAgICAgc3RydWN0IGludGVsX2dtYnVzLAo+ID4gICAJCQkJ
CSAgICAgICBhZGFwdGVyKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gYnVzLT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBi
dXMtPmk5MTU7Cj4gPiAgIAlzZXRfZGF0YShidXMsIDEpOwo+ID4gICAJc2V0X2Nsb2NrKGJ1cywg
MSk7Cj4gPiAtCWlmIChJU19QSU5FVklFVyhkZXZfcHJpdikpCj4gPiAtCQlwbnZfZ21idXNfY2xv
Y2tfZ2F0aW5nKGRldl9wcml2LCB0cnVlKTsKPiA+ICsJaWYgKElTX1BJTkVWSUVXKGk5MTUpKQo+
ID4gKwkJcG52X2dtYnVzX2Nsb2NrX2dhdGluZyhpOTE1LCB0cnVlKTsKPiA+ICAgfQo+ID4gICBz
dGF0aWMgdm9pZAo+ID4gICBpbnRlbF9ncGlvX3NldHVwKHN0cnVjdCBpbnRlbF9nbWJ1cyAqYnVz
LCB1bnNpZ25lZCBpbnQgcGluKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGJ1cy0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gYnVzLT5pOTE1Owo+ID4gICAJc3RydWN0IGkyY19hbGdvX2JpdF9kYXRhICphbGdv
Owo+ID4gICAJYWxnbyA9ICZidXMtPmJpdF9hbGdvOwo+ID4gLQlidXMtPmdwaW9fcmVnID0gR1BJ
TyhnZXRfZ21idXNfcGluKGRldl9wcml2LCBwaW4pLT5ncGlvKTsKPiA+ICsJYnVzLT5ncGlvX3Jl
ZyA9IEdQSU8oZ2V0X2dtYnVzX3BpbihpOTE1LCBwaW4pLT5ncGlvKTsKPiA+ICAgCWJ1cy0+YWRh
cHRlci5hbGdvX2RhdGEgPSBhbGdvOwo+ID4gICAJYWxnby0+c2V0c2RhID0gc2V0X2RhdGE7Cj4g
PiAgIAlhbGdvLT5zZXRzY2wgPSBzZXRfY2xvY2s7Cj4gPiBAQCAtMzIwLDcgKzMyMCw3IEBAIGlu
dGVsX2dwaW9fc2V0dXAoc3RydWN0IGludGVsX2dtYnVzICpidXMsIHVuc2lnbmVkIGludCBwaW4p
Cj4gPiAgIAlhbGdvLT5kYXRhID0gYnVzOwo+ID4gICB9Cj4gPiAtc3RhdGljIGludCBnbWJ1c193
YWl0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHN0YXR1cywgdTMyIGly
cV9lbikKPiA+ICtzdGF0aWMgaW50IGdtYnVzX3dhaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsIHUzMiBzdGF0dXMsIHUzMiBpcnFfZW4pCj4gPiAgIHsKPiA+ICAgCURFRklORV9XQUlU
KHdhaXQpOwo+ID4gICAJdTMyIGdtYnVzMjsKPiA+IEBAIC0zMzAsMTAgKzMzMCwxMCBAQCBzdGF0
aWMgaW50IGdtYnVzX3dhaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIg
c3RhdHVzLCB1MzIgaXJxX2VuKQo+ID4gICAJICogd2UgYWxzbyBuZWVkIHRvIGNoZWNrIGZvciBO
QUtzIGJlc2lkZXMgdGhlIGh3IHJlYWR5L2lkbGUgc2lnbmFsLCB3ZQo+ID4gICAJICogbmVlZCB0
byB3YWtlIHVwIHBlcmlvZGljYWxseSBhbmQgY2hlY2sgdGhhdCBvdXJzZWx2ZXMuCj4gPiAgIAkg
Ki8KPiA+IC0JaWYgKCFIQVNfR01CVVNfSVJRKGRldl9wcml2KSkKPiA+ICsJaWYgKCFIQVNfR01C
VVNfSVJRKGk5MTUpKQo+ID4gICAJCWlycV9lbiA9IDA7Cj4gPiAtCWFkZF93YWl0X3F1ZXVlKCZk
ZXZfcHJpdi0+Z21idXNfd2FpdF9xdWV1ZSwgJndhaXQpOwo+ID4gKwlhZGRfd2FpdF9xdWV1ZSgm
aTkxNS0+Z21idXNfd2FpdF9xdWV1ZSwgJndhaXQpOwo+ID4gICAJSTkxNV9XUklURV9GVyhHTUJV
UzQsIGlycV9lbik7Cj4gPiAgIAlzdGF0dXMgfD0gR01CVVNfU0FUT0VSOwo+ID4gQEAgLTM0Miw3
ICszNDIsNyBAQCBzdGF0aWMgaW50IGdtYnVzX3dhaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCB1MzIgc3RhdHVzLCB1MzIgaXJxX2VuKQo+ID4gICAJCXJldCA9IHdhaXRfZm9y
KChnbWJ1czIgPSBJOTE1X1JFQURfRlcoR01CVVMyKSkgJiBzdGF0dXMsIDUwKTsKPiA+ICAgCUk5
MTVfV1JJVEVfRlcoR01CVVM0LCAwKTsKPiA+IC0JcmVtb3ZlX3dhaXRfcXVldWUoJmRldl9wcml2
LT5nbWJ1c193YWl0X3F1ZXVlLCAmd2FpdCk7Cj4gPiArCXJlbW92ZV93YWl0X3F1ZXVlKCZpOTE1
LT5nbWJ1c193YWl0X3F1ZXVlLCAmd2FpdCk7Cj4gPiAgIAlpZiAoZ21idXMyICYgR01CVVNfU0FU
T0VSKQo+ID4gICAJCXJldHVybiAtRU5YSU87Cj4gPiBAQCAtMzUxLDcgKzM1MSw3IEBAIHN0YXRp
YyBpbnQgZ21idXNfd2FpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBz
dGF0dXMsIHUzMiBpcnFfZW4pCj4gPiAgIH0KPiA+ICAgc3RhdGljIGludAo+ID4gLWdtYnVzX3dh
aXRfaWRsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArZ21idXNfd2Fp
dF9pZGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlERUZJ
TkVfV0FJVCh3YWl0KTsKPiA+ICAgCXUzMiBpcnFfZW5hYmxlOwo+ID4gQEAgLTM1OSwzNiArMzU5
LDM2IEBAIGdtYnVzX3dhaXRfaWRsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAgIAkvKiBJbXBvcnRhbnQ6IFRoZSBodyBoYW5kbGVzIG9ubHkgdGhlIGZpcnN0IGJpdCwg
c28gc2V0IG9ubHkgb25lISAqLwo+ID4gICAJaXJxX2VuYWJsZSA9IDA7Cj4gPiAtCWlmIChIQVNf
R01CVVNfSVJRKGRldl9wcml2KSkKPiA+ICsJaWYgKEhBU19HTUJVU19JUlEoaTkxNSkpCj4gPiAg
IAkJaXJxX2VuYWJsZSA9IEdNQlVTX0lETEVfRU47Cj4gPiAtCWFkZF93YWl0X3F1ZXVlKCZkZXZf
cHJpdi0+Z21idXNfd2FpdF9xdWV1ZSwgJndhaXQpOwo+ID4gKwlhZGRfd2FpdF9xdWV1ZSgmaTkx
NS0+Z21idXNfd2FpdF9xdWV1ZSwgJndhaXQpOwo+ID4gICAJSTkxNV9XUklURV9GVyhHTUJVUzQs
IGlycV9lbmFibGUpOwo+ID4gLQlyZXQgPSBpbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcl9mdygmZGV2
X3ByaXYtPnVuY29yZSwKPiA+ICsJcmV0ID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXJfZncoJmk5
MTUtPnVuY29yZSwKPiA+ICAgCQkJCQkgR01CVVMyLCBHTUJVU19BQ1RJVkUsIDAsCj4gPiAgIAkJ
CQkJIDEwKTsKPiA+ICAgCUk5MTVfV1JJVEVfRlcoR01CVVM0LCAwKTsKPiA+IC0JcmVtb3ZlX3dh
aXRfcXVldWUoJmRldl9wcml2LT5nbWJ1c193YWl0X3F1ZXVlLCAmd2FpdCk7Cj4gPiArCXJlbW92
ZV93YWl0X3F1ZXVlKCZpOTE1LT5nbWJ1c193YWl0X3F1ZXVlLCAmd2FpdCk7Cj4gPiAgIAlyZXR1
cm4gcmV0Owo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbmxpbmUKPiA+IC11bnNpZ25lZCBpbnQgZ21i
dXNfbWF4X3hmZXJfc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAr
dW5zaWduZWQgaW50IGdtYnVzX21heF94ZmVyX3NpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gPiAgIHsKPiA+IC0JcmV0dXJuIElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSA/IEdF
TjlfR01CVVNfQllURV9DT1VOVF9NQVggOgo+ID4gKwlyZXR1cm4gSU5URUxfR0VOKGk5MTUpID49
IDkgPyBHRU45X0dNQlVTX0JZVEVfQ09VTlRfTUFYIDoKPiA+ICAgCSAgICAgICBHTUJVU19CWVRF
X0NPVU5UX01BWDsKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW50Cj4gPiAtZ21idXNfeGZlcl9yZWFk
X2NodW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtnbWJ1c194ZmVy
X3JlYWRfY2h1bmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICAg
dW5zaWduZWQgc2hvcnQgYWRkciwgdTggKmJ1ZiwgdW5zaWduZWQgaW50IGxlbiwKPiA+ICAgCQkg
ICAgICB1MzIgZ21idXMwX3JlZywgdTMyIGdtYnVzMV9pbmRleCkKPiA+ICAgewo+ID4gICAJdW5z
aWduZWQgaW50IHNpemUgPSBsZW47Cj4gPiAtCWJvb2wgYnVyc3RfcmVhZCA9IGxlbiA+IGdtYnVz
X21heF94ZmVyX3NpemUoZGV2X3ByaXYpOwo+ID4gKwlib29sIGJ1cnN0X3JlYWQgPSBsZW4gPiBn
bWJ1c19tYXhfeGZlcl9zaXplKGk5MTUpOwo+ID4gICAJYm9vbCBleHRyYV9ieXRlX2FkZGVkID0g
ZmFsc2U7Cj4gPiAgIAlpZiAoYnVyc3RfcmVhZCkgewo+ID4gQEAgLTQxNCw3ICs0MTQsNyBAQCBn
bWJ1c194ZmVyX3JlYWRfY2h1bmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gICAJCWludCByZXQ7Cj4gPiAgIAkJdTMyIHZhbCwgbG9vcCA9IDA7Cj4gPiAtCQlyZXQgPSBn
bWJ1c193YWl0KGRldl9wcml2LCBHTUJVU19IV19SRFksIEdNQlVTX0hXX1JEWV9FTik7Cj4gPiAr
CQlyZXQgPSBnbWJ1c193YWl0KGk5MTUsIEdNQlVTX0hXX1JEWSwgR01CVVNfSFdfUkRZX0VOKTsK
PiA+ICAgCQlpZiAocmV0KQo+ID4gICAJCQlyZXR1cm4gcmV0Owo+ID4gQEAgLTQ0Niw3ICs0NDYs
NyBAQCBnbWJ1c194ZmVyX3JlYWRfY2h1bmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gICAjZGVmaW5lIElOVEVMX0dNQlVTX0JVUlNUX1JFQURfTUFYX0xFTgkJNzY3VQo+
ID4gICBzdGF0aWMgaW50Cj4gPiAtZ21idXNfeGZlcl9yZWFkKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgc3RydWN0IGkyY19tc2cgKm1zZywKPiA+ICtnbWJ1c194ZmVyX3JlYWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBpMmNfbXNnICptc2csCj4gPiAg
IAkJdTMyIGdtYnVzMF9yZWcsIHUzMiBnbWJ1czFfaW5kZXgpCj4gPiAgIHsKPiA+ICAgCXU4ICpi
dWYgPSBtc2ctPmJ1ZjsKPiA+IEBAIC00NTUsMTIgKzQ1NSwxMiBAQCBnbWJ1c194ZmVyX3JlYWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBzdHJ1Y3QgaTJjX21zZyAqbXNnLAo+
ID4gICAJaW50IHJldDsKPiA+ICAgCWRvIHsKPiA+IC0JCWlmIChIQVNfR01CVVNfQlVSU1RfUkVB
RChkZXZfcHJpdikpCj4gPiArCQlpZiAoSEFTX0dNQlVTX0JVUlNUX1JFQUQoaTkxNSkpCj4gPiAg
IAkJCWxlbiA9IG1pbihyeF9zaXplLCBJTlRFTF9HTUJVU19CVVJTVF9SRUFEX01BWF9MRU4pOwo+
ID4gICAJCWVsc2UKPiA+IC0JCQlsZW4gPSBtaW4ocnhfc2l6ZSwgZ21idXNfbWF4X3hmZXJfc2l6
ZShkZXZfcHJpdikpOwo+ID4gKwkJCWxlbiA9IG1pbihyeF9zaXplLCBnbWJ1c19tYXhfeGZlcl9z
aXplKGk5MTUpKTsKPiA+IC0JCXJldCA9IGdtYnVzX3hmZXJfcmVhZF9jaHVuayhkZXZfcHJpdiwg
bXNnLT5hZGRyLCBidWYsIGxlbiwKPiA+ICsJCXJldCA9IGdtYnVzX3hmZXJfcmVhZF9jaHVuayhp
OTE1LCBtc2ctPmFkZHIsIGJ1ZiwgbGVuLAo+ID4gICAJCQkJCSAgICBnbWJ1czBfcmVnLCBnbWJ1
czFfaW5kZXgpOwo+ID4gICAJCWlmIChyZXQpCj4gPiAgIAkJCXJldHVybiByZXQ7Cj4gPiBAQCAt
NDczLDcgKzQ3Myw3IEBAIGdtYnVzX3hmZXJfcmVhZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIHN0cnVjdCBpMmNfbXNnICptc2csCj4gPiAgIH0KPiA+ICAgc3RhdGljIGludAo+
ID4gLWdtYnVzX3hmZXJfd3JpdGVfY2h1bmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK2dtYnVzX3hmZXJfd3JpdGVfY2h1bmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gPiAgIAkJICAgICAgIHVuc2lnbmVkIHNob3J0IGFkZHIsIHU4ICpidWYsIHVuc2ln
bmVkIGludCBsZW4sCj4gPiAgIAkJICAgICAgIHUzMiBnbWJ1czFfaW5kZXgpCj4gPiAgIHsKPiA+
IEBAIC01MDIsNyArNTAyLDcgQEAgZ21idXNfeGZlcl93cml0ZV9jaHVuayhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJSTkxNV9XUklURV9GVyhHTUJVUzMsIHZhbCk7
Cj4gPiAtCQlyZXQgPSBnbWJ1c193YWl0KGRldl9wcml2LCBHTUJVU19IV19SRFksIEdNQlVTX0hX
X1JEWV9FTik7Cj4gPiArCQlyZXQgPSBnbWJ1c193YWl0KGk5MTUsIEdNQlVTX0hXX1JEWSwgR01C
VVNfSFdfUkRZX0VOKTsKPiA+ICAgCQlpZiAocmV0KQo+ID4gICAJCQlyZXR1cm4gcmV0Owo+ID4g
ICAJfQo+ID4gQEAgLTUxMSw3ICs1MTEsNyBAQCBnbWJ1c194ZmVyX3dyaXRlX2NodW5rKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW50Cj4g
PiAtZ21idXNfeGZlcl93cml0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHN0
cnVjdCBpMmNfbXNnICptc2csCj4gPiArZ21idXNfeGZlcl93cml0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgc3RydWN0IGkyY19tc2cgKm1zZywKPiA+ICAgCQkgdTMyIGdtYnVzMV9p
bmRleCkKPiA+ICAgewo+ID4gICAJdTggKmJ1ZiA9IG1zZy0+YnVmOwo+ID4gQEAgLTUyMCw5ICs1
MjAsOSBAQCBnbWJ1c194ZmVyX3dyaXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgc3RydWN0IGkyY19tc2cgKm1zZywKPiA+ICAgCWludCByZXQ7Cj4gPiAgIAlkbyB7Cj4gPiAt
CQlsZW4gPSBtaW4odHhfc2l6ZSwgZ21idXNfbWF4X3hmZXJfc2l6ZShkZXZfcHJpdikpOwo+ID4g
KwkJbGVuID0gbWluKHR4X3NpemUsIGdtYnVzX21heF94ZmVyX3NpemUoaTkxNSkpOwo+ID4gLQkJ
cmV0ID0gZ21idXNfeGZlcl93cml0ZV9jaHVuayhkZXZfcHJpdiwgbXNnLT5hZGRyLCBidWYsIGxl
biwKPiA+ICsJCXJldCA9IGdtYnVzX3hmZXJfd3JpdGVfY2h1bmsoaTkxNSwgbXNnLT5hZGRyLCBi
dWYsIGxlbiwKPiA+ICAgCQkJCQkgICAgIGdtYnVzMV9pbmRleCk7Cj4gPiAgIAkJaWYgKHJldCkK
PiA+ICAgCQkJcmV0dXJuIHJldDsKPiA+IEBAIC01NDksNyArNTQ5LDcgQEAgZ21idXNfaXNfaW5k
ZXhfeGZlcihzdHJ1Y3QgaTJjX21zZyAqbXNncywgaW50IGksIGludCBudW0pCj4gPiAgIH0KPiA+
ICAgc3RhdGljIGludAo+ID4gLWdtYnVzX2luZGV4X3hmZXIoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCBzdHJ1Y3QgaTJjX21zZyAqbXNncywKPiA+ICtnbWJ1c19pbmRleF94ZmVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBzdHJ1Y3QgaTJjX21zZyAqbXNncywKPiA+
ICAgCQkgdTMyIGdtYnVzMF9yZWcpCj4gPiAgIHsKPiA+ICAgCXUzMiBnbWJ1czFfaW5kZXggPSAw
Owo+ID4gQEAgLTU2OCwxMCArNTY4LDEwIEBAIGdtYnVzX2luZGV4X3hmZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCBzdHJ1Y3QgaTJjX21zZyAqbXNncywKPiA+ICAgCQlJOTE1
X1dSSVRFX0ZXKEdNQlVTNSwgZ21idXM1KTsKPiA+ICAgCWlmIChtc2dzWzFdLmZsYWdzICYgSTJD
X01fUkQpCj4gPiAtCQlyZXQgPSBnbWJ1c194ZmVyX3JlYWQoZGV2X3ByaXYsICZtc2dzWzFdLCBn
bWJ1czBfcmVnLAo+ID4gKwkJcmV0ID0gZ21idXNfeGZlcl9yZWFkKGk5MTUsICZtc2dzWzFdLCBn
bWJ1czBfcmVnLAo+ID4gICAJCQkJICAgICAgZ21idXMxX2luZGV4KTsKPiA+ICAgCWVsc2UKPiA+
IC0JCXJldCA9IGdtYnVzX3hmZXJfd3JpdGUoZGV2X3ByaXYsICZtc2dzWzFdLCBnbWJ1czFfaW5k
ZXgpOwo+ID4gKwkJcmV0ID0gZ21idXNfeGZlcl93cml0ZShpOTE1LCAmbXNnc1sxXSwgZ21idXMx
X2luZGV4KTsKPiA+ICAgCS8qIENsZWFyIEdNQlVTNSBhZnRlciBlYWNoIGluZGV4IHRyYW5zZmVy
ICovCj4gPiAgIAlpZiAoZ21idXM1KQo+ID4gQEAgLTU4NywxNSArNTg3LDE1IEBAIGRvX2dtYnVz
X3hmZXIoc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyLCBzdHJ1Y3QgaTJjX21zZyAqbXNncywg
aW50IG51bSwKPiA+ICAgCXN0cnVjdCBpbnRlbF9nbWJ1cyAqYnVzID0gY29udGFpbmVyX29mKGFk
YXB0ZXIsCj4gPiAgIAkJCQkJICAgICAgIHN0cnVjdCBpbnRlbF9nbWJ1cywKPiA+ICAgCQkJCQkg
ICAgICAgYWRhcHRlcik7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IGJ1cy0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYnVz
LT5pOTE1Owo+ID4gICAJaW50IGkgPSAwLCBpbmMsIHRyeSA9IDA7Cj4gPiAgIAlpbnQgcmV0ID0g
MDsKPiA+ICAgCS8qIERpc3BsYXkgV0EgIzA4Njg6IHNrbCxieHQsa2JsLGNmbCxnbGssY25sICov
Cj4gPiAtCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkKPiA+IC0JCWJ4dF9nbWJ1c19jbG9ja19n
YXRpbmcoZGV2X3ByaXYsIGZhbHNlKTsKPiA+IC0JZWxzZSBpZiAoSEFTX1BDSF9TUFQoZGV2X3By
aXYpIHx8IEhBU19QQ0hfQ05QKGRldl9wcml2KSkKPiA+IC0JCXBjaF9nbWJ1c19jbG9ja19nYXRp
bmcoZGV2X3ByaXYsIGZhbHNlKTsKPiA+ICsJaWYgKElTX0dFTjlfTFAoaTkxNSkpCj4gPiArCQli
eHRfZ21idXNfY2xvY2tfZ2F0aW5nKGk5MTUsIGZhbHNlKTsKPiA+ICsJZWxzZSBpZiAoSEFTX1BD
SF9TUFQoaTkxNSkgfHwgSEFTX1BDSF9DTlAoaTkxNSkpCj4gPiArCQlwY2hfZ21idXNfY2xvY2tf
Z2F0aW5nKGk5MTUsIGZhbHNlKTsKPiA+ICAgcmV0cnk6Cj4gPiAgIAlJOTE1X1dSSVRFX0ZXKEdN
QlVTMCwgZ21idXMwX3NvdXJjZSB8IGJ1cy0+cmVnMCk7Cj4gPiBAQCAtNjAzLDE4ICs2MDMsMTgg
QEAgZG9fZ21idXNfeGZlcihzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIsIHN0cnVjdCBpMmNf
bXNnICptc2dzLCBpbnQgbnVtLAo+ID4gICAJZm9yICg7IGkgPCBudW07IGkgKz0gaW5jKSB7Cj4g
PiAgIAkJaW5jID0gMTsKPiA+ICAgCQlpZiAoZ21idXNfaXNfaW5kZXhfeGZlcihtc2dzLCBpLCBu
dW0pKSB7Cj4gPiAtCQkJcmV0ID0gZ21idXNfaW5kZXhfeGZlcihkZXZfcHJpdiwgJm1zZ3NbaV0s
Cj4gPiArCQkJcmV0ID0gZ21idXNfaW5kZXhfeGZlcihpOTE1LCAmbXNnc1tpXSwKPiA+ICAgCQkJ
CQkgICAgICAgZ21idXMwX3NvdXJjZSB8IGJ1cy0+cmVnMCk7Cj4gPiAgIAkJCWluYyA9IDI7IC8q
IGFuIGluZGV4IHRyYW5zbWlzc2lvbiBpcyB0d28gbXNncyAqLwo+ID4gICAJCX0gZWxzZSBpZiAo
bXNnc1tpXS5mbGFncyAmIEkyQ19NX1JEKSB7Cj4gPiAtCQkJcmV0ID0gZ21idXNfeGZlcl9yZWFk
KGRldl9wcml2LCAmbXNnc1tpXSwKPiA+ICsJCQlyZXQgPSBnbWJ1c194ZmVyX3JlYWQoaTkxNSwg
Jm1zZ3NbaV0sCj4gPiAgIAkJCQkJICAgICAgZ21idXMwX3NvdXJjZSB8IGJ1cy0+cmVnMCwgMCk7
Cj4gPiAgIAkJfSBlbHNlIHsKPiA+IC0JCQlyZXQgPSBnbWJ1c194ZmVyX3dyaXRlKGRldl9wcml2
LCAmbXNnc1tpXSwgMCk7Cj4gPiArCQkJcmV0ID0gZ21idXNfeGZlcl93cml0ZShpOTE1LCAmbXNn
c1tpXSwgMCk7Cj4gPiAgIAkJfQo+ID4gICAJCWlmICghcmV0KQo+ID4gLQkJCXJldCA9IGdtYnVz
X3dhaXQoZGV2X3ByaXYsCj4gPiArCQkJcmV0ID0gZ21idXNfd2FpdChpOTE1LAo+ID4gICAJCQkJ
CSBHTUJVU19IV19XQUlUX1BIQVNFLCBHTUJVU19IV19XQUlUX0VOKTsKPiA+ICAgCQlpZiAocmV0
ID09IC1FVElNRURPVVQpCj4gPiAgIAkJCWdvdG8gdGltZW91dDsKPiA+IEBAIC02MzIsNyArNjMy
LDcgQEAgZG9fZ21idXNfeGZlcihzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIsIHN0cnVjdCBp
MmNfbXNnICptc2dzLCBpbnQgbnVtLAo+ID4gICAJICogV2Ugd2lsbCByZS1lbmFibGUgaXQgYXQg
dGhlIHN0YXJ0IG9mIHRoZSBuZXh0IHhmZXIsCj4gPiAgIAkgKiB0aWxsIHRoZW4gbGV0IGl0IHNs
ZWVwLgo+ID4gICAJICovCj4gPiAtCWlmIChnbWJ1c193YWl0X2lkbGUoZGV2X3ByaXYpKSB7Cj4g
PiArCWlmIChnbWJ1c193YWl0X2lkbGUoaTkxNSkpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJH
TUJVUyBbJXNdIHRpbWVkIG91dCB3YWl0aW5nIGZvciBpZGxlXG4iLAo+ID4gICAJCQkgYWRhcHRl
ci0+bmFtZSk7Cj4gPiAgIAkJcmV0ID0gLUVUSU1FRE9VVDsKPiA+IEBAIC02NTYsNyArNjU2LDcg
QEAgZG9fZ21idXNfeGZlcihzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIsIHN0cnVjdCBpMmNf
bXNnICptc2dzLCBpbnQgbnVtLAo+ID4gICAJICogaXQncyBzbG93IHJlc3BvbmRpbmcgYW5kIG9u
bHkgYW5zd2VycyBvbiB0aGUgMm5kIHJldHJ5Lgo+ID4gICAJICovCj4gPiAgIAlyZXQgPSAtRU5Y
SU87Cj4gPiAtCWlmIChnbWJ1c193YWl0X2lkbGUoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChnbWJ1
c193YWl0X2lkbGUoaTkxNSkpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJHTUJVUyBbJXNdIHRp
bWVkIG91dCBhZnRlciBOQUtcbiIsCj4gPiAgIAkJCSAgICAgIGFkYXB0ZXItPm5hbWUpOwo+ID4g
ICAJCXJldCA9IC1FVElNRURPVVQ7Cj4gPiBAQCAtNzAxLDEwICs3MDEsMTAgQEAgZG9fZ21idXNf
eGZlcihzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIsIHN0cnVjdCBpMmNfbXNnICptc2dzLCBp
bnQgbnVtLAo+ID4gICBvdXQ6Cj4gPiAgIAkvKiBEaXNwbGF5IFdBICMwODY4OiBza2wsYnh0LGti
bCxjZmwsZ2xrLGNubCAqLwo+ID4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gPiAtCQli
eHRfZ21idXNfY2xvY2tfZ2F0aW5nKGRldl9wcml2LCB0cnVlKTsKPiA+IC0JZWxzZSBpZiAoSEFT
X1BDSF9TUFQoZGV2X3ByaXYpIHx8IEhBU19QQ0hfQ05QKGRldl9wcml2KSkKPiA+IC0JCXBjaF9n
bWJ1c19jbG9ja19nYXRpbmcoZGV2X3ByaXYsIHRydWUpOwo+ID4gKwlpZiAoSVNfR0VOOV9MUChp
OTE1KSkKPiA+ICsJCWJ4dF9nbWJ1c19jbG9ja19nYXRpbmcoaTkxNSwgdHJ1ZSk7Cj4gPiArCWVs
c2UgaWYgKEhBU19QQ0hfU1BUKGk5MTUpIHx8IEhBU19QQ0hfQ05QKGk5MTUpKQo+ID4gKwkJcGNo
X2dtYnVzX2Nsb2NrX2dhdGluZyhpOTE1LCB0cnVlKTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAg
IH0KPiA+IEBAIC03MTQsMTEgKzcxNCwxMSBAQCBnbWJ1c194ZmVyKHN0cnVjdCBpMmNfYWRhcHRl
ciAqYWRhcHRlciwgc3RydWN0IGkyY19tc2cgKm1zZ3MsIGludCBudW0pCj4gPiAgIHsKPiA+ICAg
CXN0cnVjdCBpbnRlbF9nbWJ1cyAqYnVzID0KPiA+ICAgCQljb250YWluZXJfb2YoYWRhcHRlciwg
c3RydWN0IGludGVsX2dtYnVzLCBhZGFwdGVyKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gYnVzLT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBidXMtPmk5MTU7Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+
ICAgCWludCByZXQ7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChkZXZf
cHJpdiwgUE9XRVJfRE9NQUlOX0dNQlVTKTsKPiA+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlf
cG93ZXJfZ2V0KGk5MTUsIFBPV0VSX0RPTUFJTl9HTUJVUyk7Cj4gPiAgIAlpZiAoYnVzLT5mb3Jj
ZV9iaXQpIHsKPiA+ICAgCQlyZXQgPSBpMmNfYml0X2FsZ28ubWFzdGVyX3hmZXIoYWRhcHRlciwg
bXNncywgbnVtKTsKPiA+IEBAIC03MzAsNyArNzMwLDcgQEAgZ21idXNfeGZlcihzdHJ1Y3QgaTJj
X2FkYXB0ZXIgKmFkYXB0ZXIsIHN0cnVjdCBpMmNfbXNnICptc2dzLCBpbnQgbnVtKQo+ID4gICAJ
CQlidXMtPmZvcmNlX2JpdCB8PSBHTUJVU19GT1JDRV9CSVRfUkVUUlk7Cj4gPiAgIAl9Cj4gPiAt
CWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBQT1dFUl9ET01BSU5fR01CVVMsIHdh
a2VyZWYpOwo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9ET01BSU5f
R01CVVMsIHdha2VyZWYpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTczOSw3
ICs3MzksNyBAQCBpbnQgaW50ZWxfZ21idXNfb3V0cHV0X2Frc3Yoc3RydWN0IGkyY19hZGFwdGVy
ICphZGFwdGVyKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZ21idXMgKmJ1cyA9Cj4gPiAg
IAkJY29udGFpbmVyX29mKGFkYXB0ZXIsIHN0cnVjdCBpbnRlbF9nbWJ1cywgYWRhcHRlcik7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGJ1cy0+ZGV2X3ByaXY7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYnVzLT5pOTE1Owo+ID4gICAJdTgg
Y21kID0gRFJNX0hEQ1BfRERDX0FLU1Y7Cj4gPiAgIAl1OCBidWZbRFJNX0hEQ1BfS1NWX0xFTl0g
PSB7IDAgfTsKPiA+ICAgCXN0cnVjdCBpMmNfbXNnIG1zZ3NbXSA9IHsKPiA+IEBAIC03NTksOCAr
NzU5LDggQEAgaW50IGludGVsX2dtYnVzX291dHB1dF9ha3N2KHN0cnVjdCBpMmNfYWRhcHRlciAq
YWRhcHRlcikKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJaW50IHJldDsK
PiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9wcml2LCBQT1dFUl9E
T01BSU5fR01CVVMpOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+Z21idXNfbXV0ZXgpOwo+
ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgUE9XRVJfRE9NQUlO
X0dNQlVTKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+Z21idXNfbXV0ZXgpOwo+ID4gICAJLyoK
PiA+ICAgCSAqIEluIG9yZGVyIHRvIG91dHB1dCBBa3N2IHRvIHRoZSByZWNlaXZlciwgdXNlIGFu
IGluZGV4ZWQgd3JpdGUgdG8KPiA+IEBAIC03NjksOCArNzY5LDggQEAgaW50IGludGVsX2dtYnVz
X291dHB1dF9ha3N2KHN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlcikKPiA+ICAgCSAqLwo+ID4g
ICAJcmV0ID0gZG9fZ21idXNfeGZlcihhZGFwdGVyLCBtc2dzLCBBUlJBWV9TSVpFKG1zZ3MpLCBH
TUJVU19BS1NWX1NFTEVDVCk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmdtYnVzX211
dGV4KTsKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJ
Tl9HTUJVUywgd2FrZXJlZik7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+Z21idXNfbXV0ZXgp
Owo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9ET01BSU5fR01CVVMs
IHdha2VyZWYpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTc5MywyNyArNzkz
LDI3IEBAIHN0YXRpYyB2b2lkIGdtYnVzX2xvY2tfYnVzKHN0cnVjdCBpMmNfYWRhcHRlciAqYWRh
cHRlciwKPiA+ICAgCQkJICAgdW5zaWduZWQgaW50IGZsYWdzKQo+ID4gICB7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfZ21idXMgKmJ1cyA9IHRvX2ludGVsX2dtYnVzKGFkYXB0ZXIpOwo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBidXMtPmRldl9wcml2Owo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGJ1cy0+aTkxNTsKPiA+IC0JbXV0ZXhfbG9jaygm
ZGV2X3ByaXYtPmdtYnVzX211dGV4KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+Z21idXNfbXV0
ZXgpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgZ21idXNfdHJ5bG9ja19idXMoc3RydWN0IGky
Y19hZGFwdGVyICphZGFwdGVyLAo+ID4gICAJCQkgICAgIHVuc2lnbmVkIGludCBmbGFncykKPiA+
ICAgewo+ID4gICAJc3RydWN0IGludGVsX2dtYnVzICpidXMgPSB0b19pbnRlbF9nbWJ1cyhhZGFw
dGVyKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gYnVzLT5kZXZf
cHJpdjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBidXMtPmk5MTU7Cj4g
PiAtCXJldHVybiBtdXRleF90cnlsb2NrKCZkZXZfcHJpdi0+Z21idXNfbXV0ZXgpOwo+ID4gKwly
ZXR1cm4gbXV0ZXhfdHJ5bG9jaygmaTkxNS0+Z21idXNfbXV0ZXgpOwo+ID4gICB9Cj4gPiAgIHN0
YXRpYyB2b2lkIGdtYnVzX3VubG9ja19idXMoc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyLAo+
ID4gICAJCQkgICAgIHVuc2lnbmVkIGludCBmbGFncykKPiA+ICAgewo+ID4gICAJc3RydWN0IGlu
dGVsX2dtYnVzICpidXMgPSB0b19pbnRlbF9nbWJ1cyhhZGFwdGVyKTsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gYnVzLT5kZXZfcHJpdjsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBidXMtPmk5MTU7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2
X3ByaXYtPmdtYnVzX211dGV4KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5nbWJ1c19tdXRl
eCk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGNvbnN0IHN0cnVjdCBpMmNfbG9ja19vcGVyYXRpb25z
IGdtYnVzX2xvY2tfb3BzID0gewo+ID4gQEAgLTgyNCw0NSArODI0LDQ1IEBAIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgaTJjX2xvY2tfb3BlcmF0aW9ucyBnbWJ1c19sb2NrX29wcyA9IHsKPiA+ICAgLyoq
Cj4gPiAgICAqIGludGVsX2dtYnVzX3NldHVwIC0gaW5zdGFudGlhdGUgYWxsIEludGVsIGkyYyBH
TUJ1c2VzCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRldmljZSBwcml2YXRlCj4gPiArICogQGk5
MTU6IGk5MTUgZGV2aWNlIHByaXZhdGUKPiA+ICAgICovCj4gPiAtaW50IGludGVsX2dtYnVzX3Nl
dHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQgaW50ZWxfZ21i
dXNfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7Cj4gPiArCXN0cnVjdCBwY2lf
ZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZ21idXMgKmJ1
czsKPiA+ICAgCXVuc2lnbmVkIGludCBwaW47Cj4gPiAgIAlpbnQgcmV0Owo+ID4gLQlpZiAoIUhB
U19ESVNQTEFZKGRldl9wcml2KSkKPiA+ICsJaWYgKCFIQVNfRElTUExBWShpOTE1KSkKPiA+ICAg
CQlyZXR1cm4gMDsKPiA+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJS
WVZJRVcoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYtPmdwaW9fbW1pb19iYXNlID0gVkxWX0RJ
U1BMQVlfQkFTRTsKPiA+IC0JZWxzZSBpZiAoIUhBU19HTUNIKGRldl9wcml2KSkKPiA+ICsJaWYg
KElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICsJCWk5MTUt
PmdwaW9fbW1pb19iYXNlID0gVkxWX0RJU1BMQVlfQkFTRTsKPiA+ICsJZWxzZSBpZiAoIUhBU19H
TUNIKGk5MTUpKQo+ID4gICAJCS8qCj4gPiAgIAkJICogQnJveHRvbiB1c2VzIHRoZSBzYW1lIFBD
SCBvZmZzZXRzIGZvciBTb3V0aCBEaXNwbGF5IEVuZ2luZSwKPiA+ICAgCQkgKiBldmVuIHRob3Vn
aCBpdCBkb2Vzbid0IGhhdmUgYSBQQ0guCj4gPiAgIAkJICovCj4gPiAtCQlkZXZfcHJpdi0+Z3Bp
b19tbWlvX2Jhc2UgPSBQQ0hfRElTUExBWV9CQVNFOwo+ID4gKwkJaTkxNS0+Z3Bpb19tbWlvX2Jh
c2UgPSBQQ0hfRElTUExBWV9CQVNFOwo+ID4gLQltdXRleF9pbml0KCZkZXZfcHJpdi0+Z21idXNf
bXV0ZXgpOwo+ID4gLQlpbml0X3dhaXRxdWV1ZV9oZWFkKCZkZXZfcHJpdi0+Z21idXNfd2FpdF9x
dWV1ZSk7Cj4gPiArCW11dGV4X2luaXQoJmk5MTUtPmdtYnVzX211dGV4KTsKPiA+ICsJaW5pdF93
YWl0cXVldWVfaGVhZCgmaTkxNS0+Z21idXNfd2FpdF9xdWV1ZSk7Cj4gPiAtCWZvciAocGluID0g
MDsgcGluIDwgQVJSQVlfU0laRShkZXZfcHJpdi0+Z21idXMpOyBwaW4rKykgewo+ID4gLQkJaWYg
KCFpbnRlbF9nbWJ1c19pc192YWxpZF9waW4oZGV2X3ByaXYsIHBpbikpCj4gPiArCWZvciAocGlu
ID0gMDsgcGluIDwgQVJSQVlfU0laRShpOTE1LT5nbWJ1cyk7IHBpbisrKSB7Cj4gPiArCQlpZiAo
IWludGVsX2dtYnVzX2lzX3ZhbGlkX3BpbihpOTE1LCBwaW4pKQo+ID4gICAJCQljb250aW51ZTsK
PiA+IC0JCWJ1cyA9ICZkZXZfcHJpdi0+Z21idXNbcGluXTsKPiA+ICsJCWJ1cyA9ICZpOTE1LT5n
bWJ1c1twaW5dOwo+ID4gICAJCWJ1cy0+YWRhcHRlci5vd25lciA9IFRISVNfTU9EVUxFOwo+ID4g
ICAJCWJ1cy0+YWRhcHRlci5jbGFzcyA9IEkyQ19DTEFTU19EREM7Cj4gPiAgIAkJc25wcmludGYo
YnVzLT5hZGFwdGVyLm5hbWUsCj4gPiAgIAkJCSBzaXplb2YoYnVzLT5hZGFwdGVyLm5hbWUpLAo+
ID4gICAJCQkgImk5MTUgZ21idXMgJXMiLAo+ID4gLQkJCSBnZXRfZ21idXNfcGluKGRldl9wcml2
LCBwaW4pLT5uYW1lKTsKPiA+ICsJCQkgZ2V0X2dtYnVzX3BpbihpOTE1LCBwaW4pLT5uYW1lKTsK
PiA+ICAgCQlidXMtPmFkYXB0ZXIuZGV2LnBhcmVudCA9ICZwZGV2LT5kZXY7Cj4gPiAtCQlidXMt
PmRldl9wcml2ID0gZGV2X3ByaXY7Cj4gPiArCQlidXMtPmk5MTUgPSBpOTE1Owo+ID4gICAJCWJ1
cy0+YWRhcHRlci5hbGdvID0gJmdtYnVzX2FsZ29yaXRobTsKPiA+ICAgCQlidXMtPmFkYXB0ZXIu
bG9ja19vcHMgPSAmZ21idXNfbG9ja19vcHM7Cj4gPiBAQCAtODc3LDcgKzg3Nyw3IEBAIGludCBp
bnRlbF9nbWJ1c19zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAg
IAkJYnVzLT5yZWcwID0gcGluIHwgR01CVVNfUkFURV8xMDBLSFo7Cj4gPiAgIAkJLyogZ21idXMg
c2VlbXMgdG8gYmUgYnJva2VuIG9uIGk4MzAgKi8KPiA+IC0JCWlmIChJU19JODMwKGRldl9wcml2
KSkKPiA+ICsJCWlmIChJU19JODMwKGk5MTUpKQo+ID4gICAJCQlidXMtPmZvcmNlX2JpdCA9IDE7
Cj4gPiAgIAkJaW50ZWxfZ3Bpb19zZXR1cChidXMsIHBpbik7Cj4gPiBAQCAtODg3LDI4ICs4ODcs
MjggQEAgaW50IGludGVsX2dtYnVzX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICAgCQkJZ290byBlcnI7Cj4gPiAgIAl9Cj4gPiAtCWludGVsX2dtYnVzX3Jlc2V0
KGRldl9wcml2KTsKPiA+ICsJaW50ZWxfZ21idXNfcmVzZXQoaTkxNSk7Cj4gPiAgIAlyZXR1cm4g
MDsKPiA+ICAgZXJyOgo+ID4gICAJd2hpbGUgKHBpbi0tKSB7Cj4gPiAtCQlpZiAoIWludGVsX2dt
YnVzX2lzX3ZhbGlkX3BpbihkZXZfcHJpdiwgcGluKSkKPiA+ICsJCWlmICghaW50ZWxfZ21idXNf
aXNfdmFsaWRfcGluKGk5MTUsIHBpbikpCj4gPiAgIAkJCWNvbnRpbnVlOwo+ID4gLQkJYnVzID0g
JmRldl9wcml2LT5nbWJ1c1twaW5dOwo+ID4gKwkJYnVzID0gJmk5MTUtPmdtYnVzW3Bpbl07Cj4g
PiAgIAkJaTJjX2RlbF9hZGFwdGVyKCZidXMtPmFkYXB0ZXIpOwo+ID4gICAJfQo+ID4gICAJcmV0
dXJuIHJldDsKPiA+ICAgfQo+ID4gLXN0cnVjdCBpMmNfYWRhcHRlciAqaW50ZWxfZ21idXNfZ2V0
X2FkYXB0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0cnVjdCBp
MmNfYWRhcHRlciAqaW50ZWxfZ21idXNfZ2V0X2FkYXB0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCQkJICAgIHVuc2lnbmVkIGludCBwaW4pCj4gPiAgIHsKPiA+IC0J
aWYgKFdBUk5fT04oIWludGVsX2dtYnVzX2lzX3ZhbGlkX3BpbihkZXZfcHJpdiwgcGluKSkpCj4g
PiArCWlmIChXQVJOX09OKCFpbnRlbF9nbWJ1c19pc192YWxpZF9waW4oaTkxNSwgcGluKSkpCj4g
PiAgIAkJcmV0dXJuIE5VTEw7Cj4gPiAtCXJldHVybiAmZGV2X3ByaXYtPmdtYnVzW3Bpbl0uYWRh
cHRlcjsKPiA+ICsJcmV0dXJuICZpOTE1LT5nbWJ1c1twaW5dLmFkYXB0ZXI7Cj4gPiAgIH0KPiA+
ICAgdm9pZCBpbnRlbF9nbWJ1c19zZXRfc3BlZWQoc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVy
LCBpbnQgc3BlZWQpCj4gPiBAQCAtOTIxLDE2ICs5MjEsMTYgQEAgdm9pZCBpbnRlbF9nbWJ1c19z
ZXRfc3BlZWQoc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyLCBpbnQgc3BlZWQpCj4gPiAgIHZv
aWQgaW50ZWxfZ21idXNfZm9yY2VfYml0KHN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlciwgYm9v
bCBmb3JjZV9iaXQpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9nbWJ1cyAqYnVzID0gdG9f
aW50ZWxfZ21idXMoYWRhcHRlcik7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IGJ1cy0+ZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gYnVzLT5pOTE1Owo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+Z21idXNfbXV0ZXgpOwo+
ID4gKwltdXRleF9sb2NrKCZpOTE1LT5nbWJ1c19tdXRleCk7Cj4gPiAgIAlidXMtPmZvcmNlX2Jp
dCArPSBmb3JjZV9iaXQgPyAxIDogLTE7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCIlc2FibGluZyBi
aXQtYmFuZ2luZyBvbiAlcy4gZm9yY2UgYml0IG5vdyAlZFxuIiwKPiA+ICAgCQkgICAgICBmb3Jj
ZV9iaXQgPyAiZW4iIDogImRpcyIsIGFkYXB0ZXItPm5hbWUsCj4gPiAgIAkJICAgICAgYnVzLT5m
b3JjZV9iaXQpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5nbWJ1c19tdXRleCk7Cj4g
PiArCW11dGV4X3VubG9jaygmaTkxNS0+Z21idXNfbXV0ZXgpOwo+ID4gICB9Cj4gPiAgIGJvb2wg
aW50ZWxfZ21idXNfaXNfZm9yY2VkX2JpdChzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIpCj4g
PiBAQCAtOTQwLDE2ICs5NDAsMTYgQEAgYm9vbCBpbnRlbF9nbWJ1c19pc19mb3JjZWRfYml0KHN0
cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlcikKPiA+ICAgCXJldHVybiBidXMtPmZvcmNlX2JpdDsK
PiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfZ21idXNfdGVhcmRvd24oc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfZ21idXNfdGVhcmRvd24oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9nbWJ1cyAq
YnVzOwo+ID4gICAJdW5zaWduZWQgaW50IHBpbjsKPiA+IC0JZm9yIChwaW4gPSAwOyBwaW4gPCBB
UlJBWV9TSVpFKGRldl9wcml2LT5nbWJ1cyk7IHBpbisrKSB7Cj4gPiAtCQlpZiAoIWludGVsX2dt
YnVzX2lzX3ZhbGlkX3BpbihkZXZfcHJpdiwgcGluKSkKPiA+ICsJZm9yIChwaW4gPSAwOyBwaW4g
PCBBUlJBWV9TSVpFKGk5MTUtPmdtYnVzKTsgcGluKyspIHsKPiA+ICsJCWlmICghaW50ZWxfZ21i
dXNfaXNfdmFsaWRfcGluKGk5MTUsIHBpbikpCj4gPiAgIAkJCWNvbnRpbnVlOwo+ID4gLQkJYnVz
ID0gJmRldl9wcml2LT5nbWJ1c1twaW5dOwo+ID4gKwkJYnVzID0gJmk5MTUtPmdtYnVzW3Bpbl07
Cj4gPiAgIAkJaTJjX2RlbF9hZGFwdGVyKCZidXMtPmFkYXB0ZXIpOwo+ID4gICAJfQo+ID4gICB9
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ21idXMuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2dtYnVzLmgKPiA+IGluZGV4IGQ5ODkwODViOGQyMi4u
NGE0MTk2Y2E4MzQzIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
Z21idXMuaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ21idXMuaAo+ID4g
QEAgLTExLDE3ICsxMSwxNyBAQAo+ID4gICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiA+ICAg
c3RydWN0IGkyY19hZGFwdGVyOwo+ID4gLWludCBpbnRlbF9nbWJ1c19zZXR1cChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgaW50ZWxfZ21idXNfdGVhcmRvd24o
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC1ib29sIGludGVsX2dtYnVz
X2lzX3ZhbGlkX3BpbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAraW50
IGludGVsX2dtYnVzX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2
b2lkIGludGVsX2dtYnVzX3RlYXJkb3duKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiA+ICtib29sIGludGVsX2dtYnVzX2lzX3ZhbGlkX3BpbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgdW5zaWduZWQgaW50IHBpbik7Cj4gPiAgIGludCBpbnRl
bF9nbWJ1c19vdXRwdXRfYWtzdihzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIpOwo+ID4gICBz
dHJ1Y3QgaTJjX2FkYXB0ZXIgKgo+ID4gLWludGVsX2dtYnVzX2dldF9hZGFwdGVyKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdW5zaWduZWQgaW50IHBpbik7Cj4gPiAraW50ZWxf
Z21idXNfZ2V0X2FkYXB0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHVuc2lnbmVk
IGludCBwaW4pOwo+ID4gICB2b2lkIGludGVsX2dtYnVzX3NldF9zcGVlZChzdHJ1Y3QgaTJjX2Fk
YXB0ZXIgKmFkYXB0ZXIsIGludCBzcGVlZCk7Cj4gPiAgIHZvaWQgaW50ZWxfZ21idXNfZm9yY2Vf
Yml0KHN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlciwgYm9vbCBmb3JjZV9iaXQpOwo+ID4gICBi
b29sIGludGVsX2dtYnVzX2lzX2ZvcmNlZF9iaXQoc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVy
KTsKPiA+IC12b2lkIGludGVsX2dtYnVzX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gPiArdm9pZCBpbnRlbF9nbWJ1c19yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSk7Cj4gPiAgICNlbmRpZiAvKiBfX0lOVEVMX0dNQlVTX0hfXyAqLwo+ID4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Yy5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfZ3VjLmMKPiA+IGluZGV4IGM0MGE2ZWZkZDMzYS4uZjA4YWMyOWMyYTRm
IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjLmMKPiA+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Yy5jCj4gPiBAQCAtMjksMTQgKzI5LDE0
IEBACj4gPiAgIHN0YXRpYyB2b2lkIGdlbjhfZ3VjX3JhaXNlX2lycShzdHJ1Y3QgaW50ZWxfZ3Vj
ICpndWMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
Z3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBn
dWNfdG9faTkxNShndWMpOwo+ID4gICAJSTkxNV9XUklURShHVUNfU0VORF9JTlRFUlJVUFQsIEdV
Q19TRU5EX1RSSUdHRVIpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGdlbjExX2d1Y19yYWlz
ZV9pcnEoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICAgCUk5MTVfV1JJVEUo
R0VOMTFfR1VDX0hPU1RfSU5URVJSVVBULCAwKTsKPiA+ICAgfQo+ID4gQEAgLTUyLDExICs1Miwx
MSBAQCBzdGF0aWMgaW5saW5lIGk5MTVfcmVnX3QgZ3VjX3NlbmRfcmVnKHN0cnVjdCBpbnRlbF9n
dWMgKmd1YywgdTMyIGkpCj4gPiAgIHZvaWQgaW50ZWxfZ3VjX2luaXRfc2VuZF9yZWdzKHN0cnVj
dCBpbnRlbF9ndWMgKmd1YykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gPiAgIAllbnVtIGZvcmNld2FrZV9kb21haW5z
IGZ3X2RvbWFpbnMgPSAwOwo+ID4gICAJdW5zaWduZWQgaW50IGk7Cj4gPiAtCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDExKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsK
PiA+ICAgCQlndWMtPnNlbmRfcmVncy5iYXNlID0KPiA+ICAgCQkJCWk5MTVfbW1pb19yZWdfb2Zm
c2V0KEdFTjExX1NPRlRfU0NSQVRDSCgwKSk7Cj4gPiAgIAkJZ3VjLT5zZW5kX3JlZ3MuY291bnQg
PSBHRU4xMV9TT0ZUX1NDUkFUQ0hfQ09VTlQ7Cj4gPiBAQCAtNjcsNyArNjcsNyBAQCB2b2lkIGlu
dGVsX2d1Y19pbml0X3NlbmRfcmVncyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gPiAgIAl9Cj4g
PiAgIAlmb3IgKGkgPSAwOyBpIDwgZ3VjLT5zZW5kX3JlZ3MuY291bnQ7IGkrKykgewo+ID4gLQkJ
ZndfZG9tYWlucyB8PSBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2Zvcl9yZWcoJmRldl9wcml2LT51
bmNvcmUsCj4gPiArCQlmd19kb21haW5zIHw9IGludGVsX3VuY29yZV9mb3JjZXdha2VfZm9yX3Jl
ZygmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJCWd1Y19zZW5kX3JlZyhndWMsIGkpLAo+ID4gICAJ
CQkJCUZXX1JFR19SRUFEIHwgRldfUkVHX1dSSVRFKTsKPiA+ICAgCX0KPiA+IEBAIC0xMDEsNyAr
MTAxLDcgQEAgdm9pZCBpbnRlbF9ndWNfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMp
Cj4gPiAgIHN0YXRpYyBpbnQgZ3VjX2luaXRfd3Eoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1Y190b19pOTE1
KGd1Yyk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3VjX3RvX2k5MTUo
Z3VjKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBHdUMgbG9nIGJ1ZmZlciBmbHVzaCB3b3JrIGl0ZW0g
aGFzIHRvIGRvIHJlZ2lzdGVyIGFjY2VzcyB0bwo+ID4gQEAgLTEzNSw4ICsxMzUsOCBAQCBzdGF0
aWMgaW50IGd1Y19pbml0X3dxKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiA+ICAgCSAqIHRvIG1h
a2Ugc3VyZSB3ZSdyZSBhbHdheXMgc2VuZGluZyBhIHNpbmdsZSBwcmVlbXB0aW9uIHJlcXVlc3Qg
d2l0aCBhCj4gPiAgIAkgKiBzaW5nbGUgd29ya2l0ZW0uCj4gPiAgIAkgKi8KPiA+IC0JaWYgKEhB
U19MT0dJQ0FMX1JJTkdfUFJFRU1QVElPTihkZXZfcHJpdikgJiYKPiA+IC0JICAgIFVTRVNfR1VD
X1NVQk1JU1NJT04oZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChIQVNfTE9HSUNBTF9SSU5HX1BSRUVN
UFRJT04oaTkxNSkgJiYKPiA+ICsJICAgIFVTRVNfR1VDX1NVQk1JU1NJT04oaTkxNSkpIHsKPiA+
ICAgCQlndWMtPnByZWVtcHRfd3EgPSBhbGxvY19vcmRlcmVkX3dvcmtxdWV1ZSgiaTkxNS1ndWNf
cHJlZW1wdCIsCj4gPiAgIAkJCQkJCQkgIFdRX0hJR0hQUkkpOwo+ID4gICAJCWlmICghZ3VjLT5w
cmVlbXB0X3dxKSB7Cj4gPiBAQCAtMjExLDcgKzIxMSw3IEBAIHN0YXRpYyB2b2lkIGd1Y19zaGFy
ZWRfZGF0YV9kZXN0cm95KHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiA+ICAgaW50IGludGVsX2d1
Y19pbml0KHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gPiAgIAlpbnQgcmV0Owo+
ID4gICAJcmV0ID0gaW50ZWxfdWNfZndfaW5pdCgmZ3VjLT5mdyk7Cj4gPiBAQCAtMjM3LDcgKzIz
Nyw3IEBAIGludCBpbnRlbF9ndWNfaW5pdChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gPiAgIAkJ
Z290byBlcnJfYWRzOwo+ID4gICAJLyogV2UgbmVlZCB0byBub3RpZnkgdGhlIGd1YyB3aGVuZXZl
ciB3ZSBjaGFuZ2UgdGhlIEdHVFQgKi8KPiA+IC0JaTkxNV9nZ3R0X2VuYWJsZV9ndWMoZGV2X3By
aXYpOwo+ID4gKwlpOTE1X2dndHRfZW5hYmxlX2d1YyhpOTE1KTsKPiA+ICAgCXJldHVybiAwOwo+
ID4gQEAgLTI1Niw5ICsyNTYsOSBAQCBpbnQgaW50ZWxfZ3VjX2luaXQoc3RydWN0IGludGVsX2d1
YyAqZ3VjKQo+ID4gICB2b2lkIGludGVsX2d1Y19maW5pKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9f
aTkxNShndWMpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19p
OTE1KGd1Yyk7Cj4gPiAtCWk5MTVfZ2d0dF9kaXNhYmxlX2d1YyhkZXZfcHJpdik7Cj4gPiArCWk5
MTVfZ2d0dF9kaXNhYmxlX2d1YyhpOTE1KTsKPiA+ICAgCWludGVsX2d1Y19jdF9maW5pKCZndWMt
PmN0KTsKPiA+IEBAIC0zNjYsNyArMzY2LDcgQEAgc3RhdGljIHUzMiBndWNfY3RsX2Fkc19mbGFn
cyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gPiAgICAqLwo+ID4gICB2b2lkIGludGVsX2d1Y19p
bml0X3BhcmFtcyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ID4gICAJdTMyIHBh
cmFtc1tHVUNfQ1RMX01BWF9EV09SRFNdOwo+ID4gICAJaW50IGk7Cj4gPiBAQCAtMzg2LDE0ICsz
ODYsMTQgQEAgdm9pZCBpbnRlbF9ndWNfaW5pdF9wYXJhbXMoc3RydWN0IGludGVsX2d1YyAqZ3Vj
KQo+ID4gICAJICogdGhleSBhcmUgcG93ZXIgY29udGV4dCBzYXZlZCBzbyBpdCdzIG9rIHRvIHJl
bGVhc2UgZm9yY2V3YWtlCj4gPiAgIAkgKiB3aGVuIHdlIGFyZSBkb25lIGhlcmUgYW5kIHRha2Ug
aXQgYWdhaW4gYXQgeGZlciB0aW1lLgo+ID4gICAJICovCj4gPiAtCWludGVsX3VuY29yZV9mb3Jj
ZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQkxJVFRFUik7Cj4gPiArCWlu
dGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9CTElUVEVS
KTsKPiA+ICAgCUk5MTVfV1JJVEUoU09GVF9TQ1JBVENIKDApLCAwKTsKPiA+ICAgCWZvciAoaSA9
IDA7IGkgPCBHVUNfQ1RMX01BWF9EV09SRFM7IGkrKykKPiA+ICAgCQlJOTE1X1dSSVRFKFNPRlRf
U0NSQVRDSCgxICsgaSksIHBhcmFtc1tpXSk7Cj4gPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2Vf
cHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQkxJVFRFUik7Cj4gPiArCWludGVsX3Vu
Y29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9CTElUVEVSKTsKPiA+
ICAgfQo+ID4gICBpbnQgaW50ZWxfZ3VjX3NlbmRfbm9wKHN0cnVjdCBpbnRlbF9ndWMgKmd1Yywg
Y29uc3QgdTMyICphY3Rpb24sIHUzMiBsZW4sCj4gPiBAQCAtNDE0LDggKzQxNCw4IEBAIHZvaWQg
aW50ZWxfZ3VjX3RvX2hvc3RfZXZlbnRfaGFuZGxlcl9ub3Aoc3RydWN0IGludGVsX2d1YyAqZ3Vj
KQo+ID4gICBpbnQgaW50ZWxfZ3VjX3NlbmRfbW1pbyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMsIGNv
bnN0IHUzMiAqYWN0aW9uLCB1MzIgbGVuLAo+ID4gICAJCQl1MzIgKnJlc3BvbnNlX2J1ZiwgdTMy
IHJlc3BvbnNlX2J1Zl9zaXplKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gPiAtCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVu
Y29yZSA9ICZpOTE1LT51bmNvcmU7Cj4gPiAgIAl1MzIgc3RhdHVzOwo+ID4gICAJaW50IGk7Cj4g
PiAgIAlpbnQgcmV0Owo+ID4gQEAgLTQ5NywxMiArNDk3LDEyIEBAIGludCBpbnRlbF9ndWNfdG9f
aG9zdF9wcm9jZXNzX3JlY3ZfbXNnKHN0cnVjdCBpbnRlbF9ndWMgKmd1YywKPiA+ICAgaW50IGlu
dGVsX2d1Y19zYW1wbGVfZm9yY2V3YWtlKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1Yyk7
Cj4gPiAgIAl1MzIgYWN0aW9uWzJdOwo+ID4gICAJYWN0aW9uWzBdID0gSU5URUxfR1VDX0FDVElP
Tl9TQU1QTEVfRk9SQ0VXQUtFOwo+ID4gICAJLyogV2FSc0Rpc2FibGVDb2Fyc2VQb3dlckdhdGlu
Zzpza2wsY25sICovCj4gPiAtCWlmICghSEFTX1JDNihkZXZfcHJpdikgfHwgTkVFRFNfV2FSc0Rp
c2FibGVDb2Fyc2VQb3dlckdhdGluZyhkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX1JDNihpOTE1
KSB8fCBORUVEU19XYVJzRGlzYWJsZUNvYXJzZVBvd2VyR2F0aW5nKGk5MTUpKQo+ID4gICAJCWFj
dGlvblsxXSA9IDA7Cj4gPiAgIAllbHNlCj4gPiAgIAkJLyogYml0IDAgYW5kIDEgYXJlIGZvciBS
ZW5kZXIgYW5kIE1lZGlhIGRvbWFpbiBzZXBhcmF0ZWx5ICovCj4gPiBAQCAtNTM4LDcgKzUzOCw3
IEBAIGludCBpbnRlbF9ndWNfYXV0aF9odWMoc3RydWN0IGludGVsX2d1YyAqZ3VjLCB1MzIgcnNh
X29mZnNldCkKPiA+ICAgICovCj4gPiAgIGludCBpbnRlbF9ndWNfc3VzcGVuZChzdHJ1Y3QgaW50
ZWxfZ3VjICpndWMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBndWNfdG9faTkxNShndWMpOwo+ID4gICAJaW50IHJldDsKPiA+ICAgCXUzMiBzdGF0dXM7
Cj4gPiAgIAl1MzIgYWN0aW9uW10gPSB7Cj4gPiBAQCAtNTYyLDcgKzU2Miw3IEBAIGludCBpbnRl
bF9ndWNfc3VzcGVuZChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gPiAgIAlpZiAocmV0KQo+ID4g
ICAJCXJldHVybiByZXQ7Cj4gPiAtCXJldCA9IF9faW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRl
dl9wcml2LT51bmNvcmUsIFNPRlRfU0NSQVRDSCgxNCksCj4gPiArCXJldCA9IF9faW50ZWxfd2Fp
dF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwgU09GVF9TQ1JBVENIKDE0KSwKPiA+ICAgCQkJ
CQlJTlRFTF9HVUNfU0xFRVBfU1RBVEVfSU5WQUxJRF9NQVNLLAo+ID4gICAJCQkJCTAsIDAsIDEw
LCAmc3RhdHVzKTsKPiA+ICAgCWlmIChyZXQpCj4gPiBAQCAtNjU4LDE3ICs2NTgsMTcgQEAgaW50
IGludGVsX2d1Y19yZXN1bWUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ID4gICAgKi8KPiA+ICAg
c3RydWN0IGk5MTVfdm1hICppbnRlbF9ndWNfYWxsb2NhdGVfdm1hKHN0cnVjdCBpbnRlbF9ndWMg
Kmd1YywgdTMyIHNpemUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ID4gICAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iajsKPiA+ICAgCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwo+ID4gICAJdTY0IGZsYWdzOwo+
ID4gICAJaW50IHJldDsKPiA+IC0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShk
ZXZfcHJpdiwgc2l6ZSk7Cj4gPiArCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0o
aTkxNSwgc2l6ZSk7Cj4gPiAgIAlpZiAoSVNfRVJSKG9iaikpCj4gPiAgIAkJcmV0dXJuIEVSUl9D
QVNUKG9iaik7Cj4gPiAtCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgJmRldl9wcml2LT5n
Z3R0LnZtLCBOVUxMKTsKPiA+ICsJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCAmaTkxNS0+
Z2d0dC52bSwgTlVMTCk7Cj4gPiAgIAlpZiAoSVNfRVJSKHZtYSkpCj4gPiAgIAkJZ290byBlcnI7
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Fkcy5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Fkcy5jCj4gPiBpbmRleCBlY2I2OWZjOTQy
MTguLjRhYzllZDJkZDQ2NyAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2d1Y19hZHMuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Fk
cy5jCj4gPiBAQCAtODUsNyArODUsNyBAQCBzdHJ1Y3QgX19ndWNfYWRzX2Jsb2Igewo+ID4gICBz
dGF0aWMgaW50IF9fZ3VjX2Fkc19pbml0KHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1Yyk7
Cj4gPiAgIAlzdHJ1Y3QgX19ndWNfYWRzX2Jsb2IgKmJsb2I7Cj4gPiAgIAljb25zdCB1MzIgc2tp
cHBlZF9zaXplID0gTFJDX1BQSFdTUF9TWiAqIFBBR0VfU0laRSArIExSX0hXX0NPTlRFWFRfU0la
RTsKPiA+ICAgCXUzMiBiYXNlOwo+ID4gQEAgLTExNSwxOCArMTE1LDE4IEBAIHN0YXRpYyBpbnQg
X19ndWNfYWRzX2luaXQoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ID4gICAJCSAqLwo+ID4gICAJ
CWJsb2ItPmFkcy5nb2xkZW5fY29udGV4dF9scmNhW2VuZ2luZV9jbGFzc10gPSAwOwo+ID4gICAJ
CWJsb2ItPmFkcy5lbmdfc3RhdGVfc2l6ZVtlbmdpbmVfY2xhc3NdID0KPiA+IC0JCQlpbnRlbF9l
bmdpbmVfY29udGV4dF9zaXplKGRldl9wcml2LCBlbmdpbmVfY2xhc3MpIC0KPiA+ICsJCQlpbnRl
bF9lbmdpbmVfY29udGV4dF9zaXplKGk5MTUsIGVuZ2luZV9jbGFzcykgLQo+ID4gICAJCQlza2lw
cGVkX3NpemU7Cj4gPiAgIAl9Cj4gPiAgIAkvKiBTeXN0ZW0gaW5mbyAqLwo+ID4gLQlibG9iLT5z
eXN0ZW1faW5mby5zbGljZV9lbmFibGVkID0gaHdlaWdodDgoUlVOVElNRV9JTkZPKGRldl9wcml2
KS0+c3NldS5zbGljZV9tYXNrKTsKPiA+ICsJYmxvYi0+c3lzdGVtX2luZm8uc2xpY2VfZW5hYmxl
ZCA9IGh3ZWlnaHQ4KFJVTlRJTUVfSU5GTyhpOTE1KS0+c3NldS5zbGljZV9tYXNrKTsKPiA+ICAg
CWJsb2ItPnN5c3RlbV9pbmZvLnJjc19lbmFibGVkID0gMTsKPiA+ICAgCWJsb2ItPnN5c3RlbV9p
bmZvLmJjc19lbmFibGVkID0gMTsKPiA+IC0JYmxvYi0+c3lzdGVtX2luZm8udmRib3hfZW5hYmxl
X21hc2sgPSBWREJPWF9NQVNLKGRldl9wcml2KTsKPiA+IC0JYmxvYi0+c3lzdGVtX2luZm8udmVi
b3hfZW5hYmxlX21hc2sgPSBWRUJPWF9NQVNLKGRldl9wcml2KTsKPiA+IC0JYmxvYi0+c3lzdGVt
X2luZm8udmRib3hfc2ZjX3N1cHBvcnRfbWFzayA9IFJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPnZk
Ym94X3NmY19hY2Nlc3M7Cj4gPiArCWJsb2ItPnN5c3RlbV9pbmZvLnZkYm94X2VuYWJsZV9tYXNr
ID0gVkRCT1hfTUFTSyhpOTE1KTsKPiA+ICsJYmxvYi0+c3lzdGVtX2luZm8udmVib3hfZW5hYmxl
X21hc2sgPSBWRUJPWF9NQVNLKGk5MTUpOwo+ID4gKwlibG9iLT5zeXN0ZW1faW5mby52ZGJveF9z
ZmNfc3VwcG9ydF9tYXNrID0gUlVOVElNRV9JTkZPKGk5MTUpLT52ZGJveF9zZmNfYWNjZXNzOwo+
ID4gICAJYmFzZSA9IGludGVsX2d1Y19nZ3R0X29mZnNldChndWMsIGd1Yy0+YWRzX3ZtYSk7Cj4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Z3LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfZncuYwo+ID4gaW5kZXggNzJjZGFmZDk2MzZhLi4y
YmViOTBjNjJhNDAgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9n
dWNfZncuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2Z3LmMKPiA+
IEBAIC0xMjUsNyArMTI1LDcgQEAgdm9pZCBpbnRlbF9ndWNfZndfaW5pdF9lYXJseShzdHJ1Y3Qg
aW50ZWxfZ3VjICpndWMpCj4gPiAgIHN0YXRpYyB2b2lkIGd1Y19wcmVwYXJlX3hmZXIoc3RydWN0
IGludGVsX2d1YyAqZ3VjKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICAgCS8qIE11c3QgcHJvZ3JhbSB0aGlzIHJl
Z2lzdGVyIGJlZm9yZSBsb2FkaW5nIHRoZSB1Y29kZSB3aXRoIERNQSAqLwo+ID4gICAJSTkxNV9X
UklURShHVUNfU0hJTV9DT05UUk9MLCBHVUNfRElTQUJMRV9TUkFNX0lOSVRfVE9fWkVST0VTIHwK
PiA+IEBAIC0xMzUsMTIgKzEzNSwxMiBAQCBzdGF0aWMgdm9pZCBndWNfcHJlcGFyZV94ZmVyKHN0
cnVjdCBpbnRlbF9ndWMgKmd1YykKPiA+ICAgCQkJCSAgICAgR1VDX0VOQUJMRV9SRUFEX0NBQ0hF
X0ZPUl9XT1BDTV9EQVRBIHwKPiA+ICAgCQkJCSAgICAgR1VDX0VOQUJMRV9NSUFfQ0xPQ0tfR0FU
SU5HKTsKPiA+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfR0VOOV9M
UChpOTE1KSkKPiA+ICAgCQlJOTE1X1dSSVRFKEdFTjlMUF9HVF9QTV9DT05GSUcsIEdUX0RPT1JC
RUxMX0VOQUJMRSk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJSTkxNV9XUklURShHRU45X0dUX1BNX0NP
TkZJRywgR1RfRE9PUkJFTExfRU5BQkxFKTsKPiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgOSkp
IHsKPiA+ICsJaWYgKElTX0dFTihpOTE1LCA5KSkgewo+ID4gICAJCS8qIERPUCBDbG9jayBHYXRp
bmcgRW5hYmxlIGZvciBHdUMgY2xvY2tzICovCj4gPiAgIAkJSTkxNV9XUklURShHRU43X01JU0ND
UENUTCwgKEdFTjhfRE9QX0NMT0NLX0dBVEVfR1VDX0VOQUJMRSB8Cj4gPiAgIAkJCQkJICAgIEk5
MTVfUkVBRChHRU43X01JU0NDUENUTCkpKTsKPiA+IEBAIC0xNTMsNyArMTUzLDcgQEAgc3RhdGlj
IHZvaWQgZ3VjX3ByZXBhcmVfeGZlcihzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gPiAgIC8qIENv
cHkgUlNBIHNpZ25hdHVyZSBmcm9tIHRoZSBmdyBpbWFnZSB0byBIVyBmb3IgdmVyaWZpY2F0aW9u
ICovCj4gPiAgIHN0YXRpYyB2b2lkIGd1Y194ZmVyX3JzYShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3Rv
X2k5MTUoZ3VjKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9f
aTkxNShndWMpOwo+ID4gICAJc3RydWN0IGludGVsX3VjX2Z3ICpmdyA9ICZndWMtPmZ3Owo+ID4g
ICAJc3RydWN0IHNnX3RhYmxlICpwYWdlcyA9IGZ3LT5vYmotPm1tLnBhZ2VzOwo+ID4gICAJdTMy
IHJzYVtVT1NfUlNBX1NDUkFUQ0hfQ09VTlRdOwo+ID4gQEAgLTE2OCw3ICsxNjgsNyBAQCBzdGF0
aWMgdm9pZCBndWNfeGZlcl9yc2Eoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ID4gICBzdGF0aWMg
Ym9vbCBndWNfeGZlcl9jb21wbGV0ZWQoc3RydWN0IGludGVsX2d1YyAqZ3VjLCB1MzIgKnN0YXR1
cykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNf
dG9faTkxNShndWMpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190
b19pOTE1KGd1Yyk7Cj4gPiAgIAkvKiBEaWQgd2UgY29tcGxldGUgdGhlIHhmZXI/ICovCj4gPiAg
IAkqc3RhdHVzID0gSTkxNV9SRUFEKERNQV9DVFJMKTsKPiA+IEBAIC0xODYsNyArMTg2LDcgQEAg
c3RhdGljIGJvb2wgZ3VjX3hmZXJfY29tcGxldGVkKHN0cnVjdCBpbnRlbF9ndWMgKmd1YywgdTMy
ICpzdGF0dXMpCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgaW5saW5lIGJvb2wgZ3VjX3JlYWR5KHN0
cnVjdCBpbnRlbF9ndWMgKmd1YywgdTMyICpzdGF0dXMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ID4gICAJdTMyIHZh
bCA9IEk5MTVfUkVBRChHVUNfU1RBVFVTKTsKPiA+ICAgCXUzMiB1a192YWwgPSB2YWwgJiBHU19V
S0VSTkVMX01BU0s7Cj4gPiBAQCAtMjM0LDcgKzIzNCw3IEBAIHN0YXRpYyBpbnQgZ3VjX3dhaXRf
dWNvZGUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ID4gICAgKi8KPiA+ICAgc3RhdGljIGludCBn
dWNfeGZlcl91Y29kZShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ID4gICAJc3Ry
dWN0IGludGVsX3VjX2Z3ICpndWNfZncgPSAmZ3VjLT5mdzsKPiA+ICAgCXVuc2lnbmVkIGxvbmcg
b2Zmc2V0Owo+ID4gQEAgLTI2NywxMiArMjY3LDEyIEBAIHN0YXRpYyBpbnQgZ3VjX3hmZXJfdWNv
ZGUoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ID4gICBzdGF0aWMgaW50IGd1Y19md194ZmVyKHN0
cnVjdCBpbnRlbF91Y19mdyAqZ3VjX2Z3KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZ3Vj
ICpndWMgPSBjb250YWluZXJfb2YoZ3VjX2Z3LCBzdHJ1Y3QgaW50ZWxfZ3VjLCBmdyk7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1Y190b19pOTE1KGd1Yyk7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+
ICAgCWludCByZXQ7Cj4gPiAgIAlHRU1fQlVHX09OKGd1Y19mdy0+dHlwZSAhPSBJTlRFTF9VQ19G
V19UWVBFX0dVQyk7Cj4gPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+
dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQo
Jmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiAgIAlndWNfcHJlcGFyZV94ZmVyKGd1
Yyk7Cj4gPiBAQCAtMjg1LDcgKzI4NSw3IEBAIHN0YXRpYyBpbnQgZ3VjX2Z3X3hmZXIoc3RydWN0
IGludGVsX3VjX2Z3ICpndWNfZncpCj4gPiAgIAlyZXQgPSBndWNfeGZlcl91Y29kZShndWMpOwo+
ID4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VX
QUtFX0FMTCk7Cj4gPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUs
IEZPUkNFV0FLRV9BTEwpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19sb2cuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX2d1Y19sb2cuYwo+ID4gaW5kZXggNjdlYWRjODJjMzk2Li4zMDBlZDk0MGYw
YjcgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfbG9nLmMK
PiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19sb2cuYwo+ID4gQEAgLTM5
MCw3ICszOTAsNyBAQCB2b2lkIGludGVsX2d1Y19sb2dfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxf
Z3VjX2xvZyAqbG9nKQo+ID4gICBzdGF0aWMgaW50IGd1Y19sb2dfcmVsYXlfY3JlYXRlKHN0cnVj
dCBpbnRlbF9ndWNfbG9nICpsb2cpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9ndWMgKmd1
YyA9IGxvZ190b19ndWMobG9nKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBndWNfdG9faTkxNShndWMpOwo+ID4gICAJc3RydWN0IHJjaGFuICpndWNfbG9nX3JlbGF5
X2NoYW47Cj4gPiAgIAlzaXplX3Qgbl9zdWJidWZzLCBzdWJidWZfc2l6ZTsKPiA+ICAgCWludCBy
ZXQ7Cj4gPiBAQCAtNDA5LDkgKzQwOSw5IEBAIHN0YXRpYyBpbnQgZ3VjX2xvZ19yZWxheV9jcmVh
dGUoc3RydWN0IGludGVsX2d1Y19sb2cgKmxvZykKPiA+ICAgCW5fc3ViYnVmcyA9IDg7Cj4gPiAg
IAlndWNfbG9nX3JlbGF5X2NoYW4gPSByZWxheV9vcGVuKCJndWNfbG9nIiwKPiA+IC0JCQkJCWRl
dl9wcml2LT5kcm0ucHJpbWFyeS0+ZGVidWdmc19yb290LAo+ID4gKwkJCQkJaTkxNS0+ZHJtLnBy
aW1hcnktPmRlYnVnZnNfcm9vdCwKPiA+ICAgCQkJCQlzdWJidWZfc2l6ZSwgbl9zdWJidWZzLAo+
ID4gLQkJCQkJJnJlbGF5X2NhbGxiYWNrcywgZGV2X3ByaXYpOwo+ID4gKwkJCQkJJnJlbGF5X2Nh
bGxiYWNrcywgaTkxNSk7Cj4gPiAgIAlpZiAoIWd1Y19sb2dfcmVsYXlfY2hhbikgewo+ID4gICAJ
CURSTV9FUlJPUigiQ291bGRuJ3QgY3JlYXRlIHJlbGF5IGNoYW4gZm9yIEd1QyBsb2dnaW5nXG4i
KTsKPiA+IEBAIC00MzYsNyArNDM2LDcgQEAgc3RhdGljIHZvaWQgZ3VjX2xvZ19yZWxheV9kZXN0
cm95KHN0cnVjdCBpbnRlbF9ndWNfbG9nICpsb2cpCj4gPiAgIHN0YXRpYyB2b2lkIGd1Y19sb2df
Y2FwdHVyZV9sb2dzKHN0cnVjdCBpbnRlbF9ndWNfbG9nICpsb2cpCj4gPiAgIHsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9ndWMgKmd1YyA9IGxvZ190b19ndWMobG9nKTsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ID4gICAJaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7Cj4gPiAgIAlndWNfcmVhZF91cGRhdGVfbG9nX2J1ZmZlcihsb2cpOwo+
ID4gQEAgLTQ0NSw3ICs0NDUsNyBAQCBzdGF0aWMgdm9pZCBndWNfbG9nX2NhcHR1cmVfbG9ncyhz
dHJ1Y3QgaW50ZWxfZ3VjX2xvZyAqbG9nKQo+ID4gICAJICogR2VuZXJhbGx5IGRldmljZSBpcyBl
eHBlY3RlZCB0byBiZSBhY3RpdmUgb25seSBhdCB0aGlzCj4gPiAgIAkgKiB0aW1lLCBzbyBnZXQv
cHV0IHNob3VsZCBiZSByZWFsbHkgcXVpY2suCj4gPiAgIAkgKi8KPiA+IC0Jd2l0aF9pbnRlbF9y
dW50aW1lX3BtKGRldl9wcml2LCB3YWtlcmVmKQo+ID4gKwl3aXRoX2ludGVsX3J1bnRpbWVfcG0o
aTkxNSwgd2FrZXJlZikKPiA+ICAgCQlndWNfYWN0aW9uX2ZsdXNoX2xvZ19jb21wbGV0ZShndWMp
Owo+ID4gICB9Cj4gPiBAQCAtNTA1LDcgKzUwNSw3IEBAIHZvaWQgaW50ZWxfZ3VjX2xvZ19kZXN0
cm95KHN0cnVjdCBpbnRlbF9ndWNfbG9nICpsb2cpCj4gPiAgIGludCBpbnRlbF9ndWNfbG9nX3Nl
dF9sZXZlbChzdHJ1Y3QgaW50ZWxfZ3VjX2xvZyAqbG9nLCB1MzIgbGV2ZWwpCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9ndWMgKmd1YyA9IGxvZ190b19ndWMobG9nKTsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwo+ID4gICAJaW50
ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAgIAlpbnQgcmV0ID0gMDsKPiA+IEBAIC01MTksMTIg
KzUxOSwxMiBAQCBpbnQgaW50ZWxfZ3VjX2xvZ19zZXRfbGV2ZWwoc3RydWN0IGludGVsX2d1Y19s
b2cgKmxvZywgdTMyIGxldmVsKQo+ID4gICAJaWYgKGxldmVsIDwgR1VDX0xPR19MRVZFTF9ESVNB
QkxFRCB8fCBsZXZlbCA+IEdVQ19MT0dfTEVWRUxfTUFYKQo+ID4gICAJCXJldHVybiAtRUlOVkFM
Owo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCW11
dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICAJaWYgKGxvZy0+bGV2ZWwg
PT0gbGV2ZWwpCj4gPiAgIAkJZ290byBvdXRfdW5sb2NrOwo+ID4gLQl3aXRoX2ludGVsX3J1bnRp
bWVfcG0oZGV2X3ByaXYsIHdha2VyZWYpCj4gPiArCXdpdGhfaW50ZWxfcnVudGltZV9wbShpOTE1
LCB3YWtlcmVmKQo+ID4gICAJCXJldCA9IGd1Y19hY3Rpb25fY29udHJvbF9sb2coZ3VjLAo+ID4g
ICAJCQkJCSAgICAgR1VDX0xPR19MRVZFTF9JU19WRVJCT1NFKGxldmVsKSwKPiA+ICAgCQkJCQkg
ICAgIEdVQ19MT0dfTEVWRUxfSVNfRU5BQkxFRChsZXZlbCksCj4gPiBAQCAtNTM3LDcgKzUzNyw3
IEBAIGludCBpbnRlbF9ndWNfbG9nX3NldF9sZXZlbChzdHJ1Y3QgaW50ZWxfZ3VjX2xvZyAqbG9n
LCB1MzIgbGV2ZWwpCj4gPiAgIAlsb2ctPmxldmVsID0gbGV2ZWw7Cj4gPiAgIG91dF91bmxvY2s6
Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gKwlt
dXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gICAJcmV0dXJuIHJldDsK
PiA+ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19z
dWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfc3VibWlzc2lvbi5j
Cj4gPiBpbmRleCA5N2Y2OTcwZDhkYTguLjAxM2Q4NTI3ODI3MCAxMDA2NDQKPiA+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKPiA+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKPiA+IEBAIC0yMDMsNyArMjAz
LDcgQEAgc3RhdGljIHN0cnVjdCBndWNfZG9vcmJlbGxfaW5mbyAqX19nZXRfZG9vcmJlbGwoc3Ry
dWN0IGludGVsX2d1Y19jbGllbnQgKmNsaWVudCkKPiA+ICAgc3RhdGljIGJvb2wgX19kb29yYmVs
bF92YWxpZChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMsIHUxNiBkYl9pZCkKPiA+ICAgewo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1Yyk7Cj4gPiAg
IAlHRU1fQlVHX09OKGRiX2lkID49IEdVQ19OVU1fRE9PUkJFTExTKTsKPiA+ICAgCXJldHVybiBJ
OTE1X1JFQUQoR0VOOF9EUkJSRUdMKGRiX2lkKSkgJiBHRU44X0RSQl9WQUxJRDsKPiA+IEBAIC0x
MDE0LDcgKzEwMTQsNyBAQCBzdGF0aWMgYm9vbCBndWNfdmVyaWZ5X2Rvb3JiZWxscyhzdHJ1Y3Qg
aW50ZWxfZ3VjICpndWMpCj4gPiAgIC8qKgo+ID4gICAgKiBndWNfY2xpZW50X2FsbG9jKCkgLSBB
bGxvY2F0ZSBhbiBpbnRlbF9ndWNfY2xpZW50Cj4gPiAtICogQGRldl9wcml2Oglkcml2ZXIgcHJp
dmF0ZSBkYXRhIHN0cnVjdHVyZQo+ID4gKyAqIEBpOTE1Oglkcml2ZXIgcHJpdmF0ZSBkYXRhIHN0
cnVjdHVyZQo+ID4gICAgKiBAZW5naW5lczoJVGhlIHNldCBvZiBlbmdpbmVzIHRvIGVuYWJsZSBm
b3IgdGhpcyBjbGllbnQKPiA+ICAgICogQHByaW9yaXR5Oglmb3VyIGxldmVscyBwcmlvcml0eSBf
Q1JJVElDQUwsIF9ISUdILCBfTk9STUFMIGFuZCBfTE9XCj4gPiAgICAqCQlUaGUga2VybmVsIGNs
aWVudCB0byByZXBsYWNlIEV4ZWNMaXN0IHN1Ym1pc3Npb24gaXMgY3JlYXRlZCB3aXRoCj4gPiBA
QCAtMTAyNiwxMyArMTAyNiwxMyBAQCBzdGF0aWMgYm9vbCBndWNfdmVyaWZ5X2Rvb3JiZWxscyhz
dHJ1Y3QgaW50ZWxfZ3VjICpndWMpCj4gPiAgICAqIFJldHVybjoJQW4gaW50ZWxfZ3VjX2NsaWVu
dCBvYmplY3QgaWYgc3VjY2VzcywgZWxzZSBOVUxMLgo+ID4gICAgKi8KPiA+ICAgc3RhdGljIHN0
cnVjdCBpbnRlbF9ndWNfY2xpZW50ICoKPiA+IC1ndWNfY2xpZW50X2FsbG9jKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtndWNfY2xpZW50X2FsbG9jKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCSB1MzIgZW5naW5lcywKPiA+ICAgCQkgdTMyIHBy
aW9yaXR5LAo+ID4gICAJCSBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQo+ID4gICB7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfZ3VjX2NsaWVudCAqY2xpZW50Owo+ID4gLQlzdHJ1Y3QgaW50ZWxf
Z3VjICpndWMgPSAmZGV2X3ByaXYtPmd1YzsKPiA+ICsJc3RydWN0IGludGVsX2d1YyAqZ3VjID0g
Jmk5MTUtPmd1YzsKPiA+ICAgCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwo+ID4gICAJdm9pZCAqdmFk
ZHI7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gQEAgLTExMjksMjcgKzExMjksMjcgQEAgc3RhdGljIGlu
bGluZSBib29sIGN0eF9zYXZlX3Jlc3RvcmVfZGlzYWJsZWQoc3RydWN0IGludGVsX2NvbnRleHQg
KmNlKQo+ID4gICBzdGF0aWMgaW50IGd1Y19jbGllbnRzX2NyZWF0ZShzdHJ1Y3QgaW50ZWxfZ3Vj
ICpndWMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
Z3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBn
dWNfdG9faTkxNShndWMpOwo+ID4gICAJc3RydWN0IGludGVsX2d1Y19jbGllbnQgKmNsaWVudDsK
PiA+ICAgCUdFTV9CVUdfT04oZ3VjLT5leGVjYnVmX2NsaWVudCk7Cj4gPiAgIAlHRU1fQlVHX09O
KGd1Yy0+cHJlZW1wdF9jbGllbnQpOwo+ID4gLQljbGllbnQgPSBndWNfY2xpZW50X2FsbG9jKGRl
dl9wcml2LAo+ID4gLQkJCQkgIElOVEVMX0lORk8oZGV2X3ByaXYpLT5lbmdpbmVfbWFzaywKPiA+
ICsJY2xpZW50ID0gZ3VjX2NsaWVudF9hbGxvYyhpOTE1LAo+ID4gKwkJCQkgIElOVEVMX0lORk8o
aTkxNSktPmVuZ2luZV9tYXNrLAo+ID4gICAJCQkJICBHVUNfQ0xJRU5UX1BSSU9SSVRZX0tNRF9O
T1JNQUwsCj4gPiAtCQkJCSAgZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0KTsKPiA+ICsJCQkJICBp
OTE1LT5rZXJuZWxfY29udGV4dCk7Cj4gPiAgIAlpZiAoSVNfRVJSKGNsaWVudCkpIHsKPiA+ICAg
CQlEUk1fRVJST1IoIkZhaWxlZCB0byBjcmVhdGUgR3VDIGNsaWVudCBmb3Igc3VibWlzc2lvbiFc
biIpOwo+ID4gICAJCXJldHVybiBQVFJfRVJSKGNsaWVudCk7Cj4gPiAgIAl9Cj4gPiAgIAlndWMt
PmV4ZWNidWZfY2xpZW50ID0gY2xpZW50Owo+ID4gLQlpZiAoZGV2X3ByaXYtPnByZWVtcHRfY29u
dGV4dCkgewo+ID4gLQkJY2xpZW50ID0gZ3VjX2NsaWVudF9hbGxvYyhkZXZfcHJpdiwKPiA+IC0J
CQkJCSAgSU5URUxfSU5GTyhkZXZfcHJpdiktPmVuZ2luZV9tYXNrLAo+ID4gKwlpZiAoaTkxNS0+
cHJlZW1wdF9jb250ZXh0KSB7Cj4gPiArCQljbGllbnQgPSBndWNfY2xpZW50X2FsbG9jKGk5MTUs
Cj4gPiArCQkJCQkgIElOVEVMX0lORk8oaTkxNSktPmVuZ2luZV9tYXNrLAo+ID4gICAJCQkJCSAg
R1VDX0NMSUVOVF9QUklPUklUWV9LTURfSElHSCwKPiA+IC0JCQkJCSAgZGV2X3ByaXYtPnByZWVt
cHRfY29udGV4dCk7Cj4gPiArCQkJCQkgIGk5MTUtPnByZWVtcHRfY29udGV4dCk7Cj4gPiAgIAkJ
aWYgKElTX0VSUihjbGllbnQpKSB7Cj4gPiAgIAkJCURSTV9FUlJPUigiRmFpbGVkIHRvIGNyZWF0
ZSBHdUMgY2xpZW50IGZvciBwcmVlbXB0aW9uIVxuIik7Cj4gPiAgIAkJCWd1Y19jbGllbnRfZnJl
ZShndWMtPmV4ZWNidWZfY2xpZW50KTsKPiA+IEBAIC0xMjQ0LDcgKzEyNDQsNyBAQCBzdGF0aWMg
dm9pZCBndWNfY2xpZW50c19kaXNhYmxlKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKPiA+ICAgICov
Cj4gPiAgIGludCBpbnRlbF9ndWNfc3VibWlzc2lvbl9pbml0KHN0cnVjdCBpbnRlbF9ndWMgKmd1
YykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNf
dG9faTkxNShndWMpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190
b19pOTE1KGd1Yyk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gPiAg
IAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiA+ICAgCWludCByZXQ7Cj4gPiBAQCAtMTI2Niw3
ICsxMjY2LDcgQEAgaW50IGludGVsX2d1Y19zdWJtaXNzaW9uX2luaXQoc3RydWN0IGludGVsX2d1
YyAqZ3VjKQo+ID4gICAJaWYgKHJldCkKPiA+ICAgCQlnb3RvIGVycl9wb29sOwo+ID4gLQlmb3Jf
ZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpIHsKPiA+ICsJZm9yX2VhY2hfZW5naW5l
KGVuZ2luZSwgaTkxNSwgaWQpIHsKPiA+ICAgCQlndWMtPnByZWVtcHRfd29ya1tpZF0uZW5naW5l
ID0gZW5naW5lOwo+ID4gICAJCUlOSVRfV09SSygmZ3VjLT5wcmVlbXB0X3dvcmtbaWRdLndvcmss
IGluamVjdF9wcmVlbXB0X2NvbnRleHQpOwo+ID4gICAJfQo+ID4gQEAgLTEyODAsMTEgKzEyODAs
MTEgQEAgaW50IGludGVsX2d1Y19zdWJtaXNzaW9uX2luaXQoc3RydWN0IGludGVsX2d1YyAqZ3Vj
KQo+ID4gICB2b2lkIGludGVsX2d1Y19zdWJtaXNzaW9uX2Zpbmkoc3RydWN0IGludGVsX2d1YyAq
Z3VjKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd1
Y190b19pOTE1KGd1Yyk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3Vj
X3RvX2k5MTUoZ3VjKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiA+
ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ID4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5l
LCBkZXZfcHJpdiwgaWQpCj4gPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQo+
ID4gICAJCWNhbmNlbF93b3JrX3N5bmMoJmd1Yy0+cHJlZW1wdF93b3JrW2lkXS53b3JrKTsKPiA+
ICAgCWd1Y19jbGllbnRzX2Rlc3Ryb3koZ3VjKTsKPiA+IEBAIC0xMjk0LDkgKzEyOTQsOSBAQCB2
b2lkIGludGVsX2d1Y19zdWJtaXNzaW9uX2Zpbmkoc3RydWN0IGludGVsX2d1YyAqZ3VjKQo+ID4g
ICAJCWd1Y19zdGFnZV9kZXNjX3Bvb2xfZGVzdHJveShndWMpOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IHZvaWQgZ3VjX2ludGVycnVwdHNfY2FwdHVyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgZ3VjX2ludGVycnVwdHNfY2FwdHVyZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMg
PSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiA+ICsJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5
MTUtPmd0X3BtLnJwczsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiA+
ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ID4gICAJaW50IGlycXM7Cj4gPiBAQCAtMTMw
NSw3ICsxMzA1LDcgQEAgc3RhdGljIHZvaWQgZ3VjX2ludGVycnVwdHNfY2FwdHVyZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiB0byBHdUMKPiA+ICAgCSAqLwo+
ID4gICAJaXJxcyA9IF9NQVNLRURfQklUX0VOQUJMRShHRlhfSU5URVJSVVBUX1NURUVSSU5HKTsK
PiA+IC0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKQo+ID4gKwlmb3JfZWFj
aF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkKPiA+ICAgCQlFTkdJTkVfV1JJVEUoZW5naW5lLCBS
SU5HX01PREVfR0VONywgaXJxcyk7Cj4gPiAgIAkvKiByb3V0ZSBVU0VSX0lOVEVSUlVQVCB0byBI
b3N0LCBhbGwgb3RoZXJzIGFyZSBzZW50IHRvIEd1Qy4gKi8KPiA+IEBAIC0xMzM5LDkgKzEzMzks
OSBAQCBzdGF0aWMgdm9pZCBndWNfaW50ZXJydXB0c19jYXB0dXJlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXJwcy0+cG1faW50cm1za19tYnogJj0gfkdFTjhfUE1J
TlRSX0RJU0FCTEVfUkVESVJFQ1RfVE9fR1VDOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ3Vj
X2ludGVycnVwdHNfcmVsZWFzZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiArc3RhdGljIHZvaWQgZ3VjX2ludGVycnVwdHNfcmVsZWFzZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3By
aXYtPmd0X3BtLnJwczsKPiA+ICsJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0X3Bt
LnJwczsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiA+ICAgCWVudW0g
aW50ZWxfZW5naW5lX2lkIGlkOwo+ID4gICAJaW50IGlycXM7Cj4gPiBAQCAtMTM1Miw3ICsxMzUy
LDcgQEAgc3RhdGljIHZvaWQgZ3VjX2ludGVycnVwdHNfcmVsZWFzZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKi8KPiA+ICAgCWlycXMgPSBfTUFTS0VEX0ZJRUxE
KEdGWF9GT1JXQVJEX1ZCTEFOS19NQVNLLCBHRlhfRk9SV0FSRF9WQkxBTktfTkVWRVIpOwo+ID4g
ICAJaXJxcyB8PSBfTUFTS0VEX0JJVF9ESVNBQkxFKEdGWF9JTlRFUlJVUFRfU1RFRVJJTkcpOwo+
ID4gLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCj4gPiArCWZvcl9lYWNo
X2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQo+ID4gICAJCUVOR0lORV9XUklURShlbmdpbmUsIFJJ
TkdfTU9ERV9HRU43LCBpcnFzKTsKPiA+ICAgCS8qIHJvdXRlIGFsbCBHVCBpbnRlcnJ1cHRzIHRv
IHRoZSBob3N0ICovCj4gPiBAQCAtMTQwOCw3ICsxNDA4LDcgQEAgc3RhdGljIHZvaWQgZ3VjX3Nl
dF9kZWZhdWx0X3N1Ym1pc3Npb24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ID4g
ICBpbnQgaW50ZWxfZ3VjX3N1Ym1pc3Npb25fZW5hYmxlKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9f
aTkxNShndWMpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19p
OTE1KGd1Yyk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gPiAgIAll
bnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiA+ICAgCWludCBlcnI7Cj4gPiBAQCAtMTQzMyw5ICsx
NDMzLDkgQEAgaW50IGludGVsX2d1Y19zdWJtaXNzaW9uX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZ3Vj
ICpndWMpCj4gPiAgIAkJcmV0dXJuIGVycjsKPiA+ICAgCS8qIFRha2Ugb3ZlciBmcm9tIG1hbnVh
bCBjb250cm9sIG9mIEVMU1AgKGV4ZWNsaXN0cykgKi8KPiA+IC0JZ3VjX2ludGVycnVwdHNfY2Fw
dHVyZShkZXZfcHJpdik7Cj4gPiArCWd1Y19pbnRlcnJ1cHRzX2NhcHR1cmUoaTkxNSk7Cj4gPiAt
CWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkgewo+ID4gKwlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewo+ID4gICAJCWVuZ2luZS0+c2V0X2RlZmF1bHRfc3Vi
bWlzc2lvbiA9IGd1Y19zZXRfZGVmYXVsdF9zdWJtaXNzaW9uOwo+ID4gICAJCWVuZ2luZS0+c2V0
X2RlZmF1bHRfc3VibWlzc2lvbihlbmdpbmUpOwo+ID4gICAJfQo+ID4gQEAgLTE0NDUsMTEgKzE0
NDUsMTEgQEAgaW50IGludGVsX2d1Y19zdWJtaXNzaW9uX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZ3Vj
ICpndWMpCj4gPiAgIHZvaWQgaW50ZWxfZ3VjX3N1Ym1pc3Npb25fZGlzYWJsZShzdHJ1Y3QgaW50
ZWxfZ3VjICpndWMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBndWNfdG9faTkxNShndWMpOwo+ID4gLQlHRU1fQlVHX09OKGRldl9wcml2LT5ndC5hd2Fr
ZSk7IC8qIEdUIHNob3VsZCBiZSBwYXJrZWQgZmlyc3QgKi8KPiA+ICsJR0VNX0JVR19PTihpOTE1
LT5ndC5hd2FrZSk7IC8qIEdUIHNob3VsZCBiZSBwYXJrZWQgZmlyc3QgKi8KPiA+IC0JZ3VjX2lu
dGVycnVwdHNfcmVsZWFzZShkZXZfcHJpdik7Cj4gPiArCWd1Y19pbnRlcnJ1cHRzX3JlbGVhc2Uo
aTkxNSk7Cj4gPiAgIAlndWNfY2xpZW50c19kaXNhYmxlKGd1Yyk7Cj4gPiAgIH0KPiA+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndnQuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX2d2dC5jCj4gPiBpbmRleCAxZDdkMjZlNGNmMTQuLmI1MGQzMWEyZTA5NSAx
MDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d2dC5jCj4gPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndnQuYwo+ID4gQEAgLTM5LDE3ICszOSwxNyBA
QAo+ID4gICAgKiBkb2MgaXMgYXZhaWxhYmxlIG9uIGh0dHBzOi8vMDEub3JnL2dyb3VwLzIyMzAv
ZG9jdW1lbnRhdGlvbi1saXN0Lgo+ID4gICAgKi8KPiA+IC1zdGF0aWMgYm9vbCBpc19zdXBwb3J0
ZWRfZGV2aWNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMg
Ym9vbCBpc19zdXBwb3J0ZWRfZGV2aWNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAtCWlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfQlJP
QURXRUxMKGk5MTUpKQo+ID4gICAJCXJldHVybiB0cnVlOwo+ID4gLQlpZiAoSVNfU0tZTEFLRShk
ZXZfcHJpdikpCj4gPiArCWlmIChJU19TS1lMQUtFKGk5MTUpKQo+ID4gICAJCXJldHVybiB0cnVl
Owo+ID4gLQlpZiAoSVNfS0FCWUxBS0UoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfS0FCWUxBS0Uo
aTkxNSkpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAtCWlmIChJU19CUk9YVE9OKGRldl9wcml2
KSkKPiA+ICsJaWYgKElTX0JST1hUT04oaTkxNSkpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAt
CWlmIChJU19DT0ZGRUVMQUtFKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0NPRkZFRUxBS0UoaTkx
NSkpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAgIAlyZXR1cm4gZmFsc2U7Cj4gPiBAQCAtNTcs
MjEgKzU3LDIxIEBAIHN0YXRpYyBib29sIGlzX3N1cHBvcnRlZF9kZXZpY2Uoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfZ3Z0X3Nhbml0
aXplX29wdGlvbnMgLSBzYW5pdGl6ZSBHVlQgcmVsYXRlZCBvcHRpb25zCj4gPiAtICogQGRldl9w
cml2OiBkcm0gaTkxNSBwcml2YXRlIGRhdGEKPiA+ICsgKiBAaTkxNTogZHJtIGk5MTUgcHJpdmF0
ZSBkYXRhCj4gPiAgICAqCj4gPiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGF0IHRoZSBp
OTE1IG9wdGlvbnMgc2FuaXRpemUgc3RhZ2UuCj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfZ3Z0
X3Nhbml0aXplX29wdGlvbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K3ZvaWQgaW50ZWxfZ3Z0X3Nhbml0aXplX29wdGlvbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gPiAgIHsKPiA+ICAgCWlmICghaTkxNV9tb2RwYXJhbXMuZW5hYmxlX2d2dCkKPiA+
ICAgCQlyZXR1cm47Cj4gPiAtCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShkZXZfcHJpdikpIHsKPiA+
ICsJaWYgKGludGVsX3ZncHVfYWN0aXZlKGk5MTUpKSB7Cj4gPiAgIAkJRFJNX0lORk8oIkdWVC1n
IGlzIGRpc2FibGVkIGZvciBndWVzdFxuIik7Cj4gPiAgIAkJZ290byBiYWlsOwo+ID4gICAJfQo+
ID4gLQlpZiAoIWlzX3N1cHBvcnRlZF9kZXZpY2UoZGV2X3ByaXYpKSB7Cj4gPiArCWlmICghaXNf
c3VwcG9ydGVkX2RldmljZShpOTE1KSkgewo+ID4gICAJCURSTV9JTkZPKCJVbnN1cHBvcnRlZCBk
ZXZpY2UuIEdWVC1nIGlzIGRpc2FibGVkXG4iKTsKPiA+ICAgCQlnb3RvIGJhaWw7Cj4gPiAgIAl9
Cj4gPiBAQCAtODMsNyArODMsNyBAQCB2b2lkIGludGVsX2d2dF9zYW5pdGl6ZV9vcHRpb25zKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgLyoqCj4gPiAgICAqIGludGVs
X2d2dF9pbml0IC0gaW5pdGlhbGl6ZSBHVlQgY29tcG9uZW50cwo+ID4gLSAqIEBkZXZfcHJpdjog
ZHJtIGk5MTUgcHJpdmF0ZSBkYXRhCj4gPiArICogQGk5MTU6IGRybSBpOTE1IHByaXZhdGUgZGF0
YQo+ID4gICAgKgo+ID4gICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhdCB0aGUgaW5pdGlh
bGl6YXRpb24gc3RhZ2UgdG8gY3JlYXRlIGEgR1ZUIGRldmljZS4KPiA+ICAgICoKPiA+IEBAIC05
MSw3ICs5MSw3IEBAIHZvaWQgaW50ZWxfZ3Z0X3Nhbml0aXplX29wdGlvbnMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAgKiBaZXJvIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZl
IGVycm9yIGNvZGUgaWYgZmFpbGVkLgo+ID4gICAgKgo+ID4gICAgKi8KPiA+IC1pbnQgaW50ZWxf
Z3Z0X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludCBpbnRl
bF9ndnRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJ
aW50IHJldDsKPiA+IEBAIC0xMDMsMTIgKzEwMywxMiBAQCBpbnQgaW50ZWxfZ3Z0X2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCXJldHVybiAwOwo+ID4gICAJ
fQo+ID4gLQlpZiAoVVNFU19HVUNfU1VCTUlTU0lPTihkZXZfcHJpdikpIHsKPiA+ICsJaWYgKFVT
RVNfR1VDX1NVQk1JU1NJT04oaTkxNSkpIHsKPiA+ICAgCQlEUk1fRVJST1IoImk5MTUgR1ZULWcg
bG9hZGluZyBmYWlsZWQgZHVlIHRvIEdyYXBoaWNzIHZpcnR1YWxpemF0aW9uIGlzIG5vdCB5ZXQg
c3VwcG9ydGVkIHdpdGggR3VDIHN1Ym1pc3Npb25cbiIpOwo+ID4gICAJCXJldHVybiAtRUlPOwo+
ID4gICAJfQo+ID4gLQlyZXQgPSBpbnRlbF9ndnRfaW5pdF9kZXZpY2UoZGV2X3ByaXYpOwo+ID4g
KwlyZXQgPSBpbnRlbF9ndnRfaW5pdF9kZXZpY2UoaTkxNSk7Cj4gPiAgIAlpZiAocmV0KSB7Cj4g
PiAgIAkJRFJNX0RFQlVHX0RSSVZFUigiRmFpbCB0byBpbml0IEdWVCBkZXZpY2VcbiIpOwo+ID4g
ICAJCWdvdG8gYmFpbDsKPiA+IEBAIC0xMjMsMTUgKzEyMywxNSBAQCBpbnQgaW50ZWxfZ3Z0X2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAvKioKPiA+ICAgICog
aW50ZWxfZ3Z0X2NsZWFudXAgLSBjbGVhbnVwIEdWVCBjb21wb25lbnRzIHdoZW4gaTkxNSBkcml2
ZXIgaXMgdW5sb2FkaW5nCj4gPiAtICogQGRldl9wcml2OiBkcm0gaTkxNSBwcml2YXRlICoKPiA+
ICsgKiBAaTkxNTogZHJtIGk5MTUgcHJpdmF0ZSAqCj4gPiAgICAqCj4gPiAgICAqIFRoaXMgZnVu
Y3Rpb24gaXMgY2FsbGVkIGF0IHRoZSBpOTE1IGRyaXZlciB1bmxvYWRpbmcgc3RhZ2UsIHRvIHNo
dXRkb3duCj4gPiAgICAqIEdWVCBjb21wb25lbnRzIGFuZCByZWxlYXNlIHRoZSByZWxhdGVkIHJl
c291cmNlcy4KPiA+ICAgICovCj4gPiAtdm9pZCBpbnRlbF9ndnRfY2xlYW51cChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9ndnRfY2xlYW51cChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoIWludGVsX2d2dF9h
Y3RpdmUoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIWludGVsX2d2dF9hY3RpdmUoaTkxNSkpCj4gPiAg
IAkJcmV0dXJuOwo+ID4gLQlpbnRlbF9ndnRfY2xlYW5fZGV2aWNlKGRldl9wcml2KTsKPiA+ICsJ
aW50ZWxfZ3Z0X2NsZWFuX2RldmljZShpOTE1KTsKPiA+ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d2dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfZ3Z0LmgKPiA+IGluZGV4IDYxYjI0NjQ3MDI4Mi4uNmY4MWUyNmNiOWFkIDEwMDY0NAo+ID4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3Z0LmgKPiA+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2d2dC5oCj4gPiBAQCAtMjcsMjIgKzI3LDIyIEBACj4gPiAgIHN0
cnVjdCBpbnRlbF9ndnQ7Cj4gPiAgICNpZmRlZiBDT05GSUdfRFJNX0k5MTVfR1ZUCj4gPiAtaW50
IGludGVsX2d2dF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAt
dm9pZCBpbnRlbF9ndnRfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+ID4gLWludCBpbnRlbF9ndnRfaW5pdF9kZXZpY2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKPiA+IC12b2lkIGludGVsX2d2dF9jbGVhbl9kZXZpY2Uoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtpbnQgaW50ZWxfZ3Z0X2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfZ3Z0X2NsZWFudXAoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK2ludCBpbnRlbF9ndnRfaW5pdF9kZXZpY2Uo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfZ3Z0X2NsZWFu
X2RldmljZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIGludCBpbnRlbF9n
dnRfaW5pdF9ob3N0KHZvaWQpOwo+ID4gLXZvaWQgaW50ZWxfZ3Z0X3Nhbml0aXplX29wdGlvbnMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICt2b2lkIGludGVsX2d2dF9z
YW5pdGl6ZV9vcHRpb25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgI2Vs
c2UKPiA+IC1zdGF0aWMgaW5saW5lIGludCBpbnRlbF9ndnRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGlubGluZSBpbnQgaW50ZWxfZ3Z0X2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXJldHVybiAwOwo+
ID4gICB9Cj4gPiAtc3RhdGljIGlubGluZSB2b2lkIGludGVsX2d2dF9jbGVhbnVwKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxf
Z3Z0X2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAg
fQo+ID4gLXN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9ndnRfc2FuaXRpemVfb3B0aW9ucyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGlubGluZSB2b2lkIGlu
dGVsX2d2dF9zYW5pdGl6ZV9vcHRpb25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAgIH0KPiA+ICAgI2VuZGlmCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfaGRjcC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaGRjcC5j
Cj4gPiBpbmRleCBiYzNhOTRkNDkxYzQuLjdkZjVmMTliNTJkNSAxMDA2NDQKPiA+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hkY3AuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfaGRjcC5jCj4gPiBAQCAtODEsNyArODEsNyBAQCBib29sIGludGVsX2hkY3Bf
Y2FwYWJsZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIC8qIElzIEhE
Q1AyLjIgY2FwYWJsZSBvbiBQbGF0Zm9ybSBhbmQgU2luayAqLwo+ID4gICBib29sIGludGVsX2hk
Y3AyX2NhcGFibGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9y
LT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmludGVsX2RpZ19wb3J0ID0gY29ubl90b19kaWdfcG9ydChjb25uZWN0b3IpOwo+ID4gICAJc3Ry
dWN0IGludGVsX2hkY3AgKmhkY3AgPSAmY29ubmVjdG9yLT5oZGNwOwo+ID4gICAJYm9vbCBjYXBh
YmxlID0gZmFsc2U7Cj4gPiBAQCAtOTEsMTIgKzkxLDEyIEBAIGJvb2wgaW50ZWxfaGRjcDJfY2Fw
YWJsZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIAkJcmV0dXJuIGZh
bHNlOwo+ID4gICAJLyogTUVJIGludGVyZmFjZSBpcyBzb2xpZCAqLwo+ID4gLQltdXRleF9sb2Nr
KCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiA+IC0JaWYgKCFkZXZfcHJpdi0+aGRjcF9j
b21wX2FkZGVkIHx8ICAhZGV2X3ByaXYtPmhkY3BfbWFzdGVyKSB7Cj4gPiAtCQltdXRleF91bmxv
Y2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5o
ZGNwX2NvbXBfbXV0ZXgpOwo+ID4gKwlpZiAoIWk5MTUtPmhkY3BfY29tcF9hZGRlZCB8fCAgIWk5
MTUtPmhkY3BfbWFzdGVyKSB7Cj4gPiArCQltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9t
dXRleCk7Cj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gICAJfQo+ID4gLQltdXRleF91bmxvY2so
JmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmhk
Y3BfY29tcF9tdXRleCk7Cj4gPiAgIAkvKiBTaW5rJ3MgY2FwYWJpbGl0eSBmb3IgSERDUDIuMiAq
Lwo+ID4gICAJaGRjcC0+c2hpbS0+aGRjcF8yXzJfY2FwYWJsZShpbnRlbF9kaWdfcG9ydCwgJmNh
cGFibGUpOwo+ID4gQEAgLTEwNiw3ICsxMDYsNyBAQCBib29sIGludGVsX2hkY3AyX2NhcGFibGUo
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICBzdGF0aWMgaW5saW5lIGJv
b2wgaW50ZWxfaGRjcF9pbl91c2Uoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0g
Y29ubmVjdG9yLT5lbmNvZGVyLT5wb3J0Owo+ID4gICAJdTMyIHJlZzsKPiA+IEBAIC0xMTYsNyAr
MTE2LDcgQEAgc3RhdGljIGlubGluZSBib29sIGludGVsX2hkY3BfaW5fdXNlKHN0cnVjdCBpbnRl
bF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgc3RhdGljIGlubGluZSBib29sIGludGVsX2hk
Y3AyX2luX3VzZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3It
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwb3J0IHBvcnQgPSBjb25uZWN0b3It
PmVuY29kZXItPnBvcnQ7Cj4gPiAgIAl1MzIgcmVnOwo+ID4gQEAgLTE0NSw5ICsxNDUsOSBAQCBz
dGF0aWMgaW50IGludGVsX2hkY3BfcG9sbF9rc3ZfZmlmbyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9w
b3J0ICppbnRlbF9kaWdfcG9ydCwKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IGJvb2wgaGRjcF9rZXlfbG9hZGFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gK3N0YXRpYyBib29sIGhkY3Bfa2V5X2xvYWRhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2Vy
X2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Cj4gPiArCXN0cnVjdCBpOTE1X3Bv
d2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93ZXJfZG9tYWluczsKPiA+ICAg
CXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGw7Cj4gPiAgIAllbnVtIGk5MTVfcG93
ZXJfd2VsbF9pZCBpZDsKPiA+ICAgCWJvb2wgZW5hYmxlZCA9IGZhbHNlOwo+ID4gQEAgLTE1Niw3
ICsxNTYsNyBAQCBzdGF0aWMgYm9vbCBoZGNwX2tleV9sb2FkYWJsZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiBPbiBIU1cgYW5kIEJEVywgRGlzcGxheSBIVyBs
b2FkcyB0aGUgS2V5IGFzIHNvb24gYXMgRGlzcGxheSByZXN1bWVzLgo+ID4gICAJICogT24gYWxs
IEJYVCssIFNXIGNhbiBsb2FkIHRoZSBrZXlzIG9ubHkgd2hlbiB0aGUgUFcjMSBpcyB0dXJuZWQg
b24uCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FE
V0VMTChkZXZfcHJpdikpCj4gPiArCWlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VM
TChpOTE1KSkKPiA+ICAgCQlpZCA9IEhTV19ESVNQX1BXX0dMT0JBTDsKPiA+ICAgCWVsc2UKPiA+
ICAgCQlpZCA9IFNLTF9ESVNQX1BXXzE7Cj4gPiBAQCAtMTY0LDkgKzE2NCw5IEBAIHN0YXRpYyBi
b29sIGhkY3Bfa2V5X2xvYWRhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwo+ID4gICAJLyogUEcxIChw
b3dlciB3ZWxsICMxKSBuZWVkcyB0byBiZSBlbmFibGVkICovCj4gPiAtCWZvcl9lYWNoX3Bvd2Vy
X3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwpIHsKPiA+ICsJZm9yX2VhY2hfcG93ZXJfd2VsbChp
OTE1LCBwb3dlcl93ZWxsKSB7Cj4gPiAgIAkJaWYgKHBvd2VyX3dlbGwtPmRlc2MtPmlkID09IGlk
KSB7Cj4gPiAtCQkJZW5hYmxlZCA9IHBvd2VyX3dlbGwtPmRlc2MtPm9wcy0+aXNfZW5hYmxlZChk
ZXZfcHJpdiwKPiA+ICsJCQllbmFibGVkID0gcG93ZXJfd2VsbC0+ZGVzYy0+b3BzLT5pc19lbmFi
bGVkKGk5MTUsCj4gPiAgIAkJCQkJCQkJICAgIHBvd2VyX3dlbGwpOwo+ID4gICAJCQlicmVhazsK
PiA+ICAgCQl9Cj4gPiBAQCAtMTgyLDE0ICsxODIsMTQgQEAgc3RhdGljIGJvb2wgaGRjcF9rZXlf
bG9hZGFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJcmV0dXJu
IGVuYWJsZWQ7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9oZGNwX2NsZWFyX2tleXMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGludGVs
X2hkY3BfY2xlYXJfa2V5cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+
ID4gICAJSTkxNV9XUklURShIRENQX0tFWV9DT05GLCBIRENQX0NMRUFSX0tFWVNfVFJJR0dFUik7
Cj4gPiAgIAlJOTE1X1dSSVRFKEhEQ1BfS0VZX1NUQVRVUywgSERDUF9LRVlfTE9BRF9ET05FIHwg
SERDUF9LRVlfTE9BRF9TVEFUVVMgfAo+ID4gICAJCSAgIEhEQ1BfRlVTRV9JTl9QUk9HUkVTUyB8
IEhEQ1BfRlVTRV9FUlJPUiB8IEhEQ1BfRlVTRV9ET05FKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBp
bnQgaW50ZWxfaGRjcF9sb2FkX2tleXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gK3N0YXRpYyBpbnQgaW50ZWxfaGRjcF9sb2FkX2tleXMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWludCByZXQ7Cj4gPiAgIAl1MzIgdmFsOwo+ID4g
QEAgLTIwMiw3ICsyMDIsNyBAQCBzdGF0aWMgaW50IGludGVsX2hkY3BfbG9hZF9rZXlzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIE9uIEhTVyBhbmQgQkRXIEhX
IGxvYWRzIHRoZSBIRENQMS40IEtleSB3aGVuIERpc3BsYXkgY29tZXMKPiA+ICAgCSAqIG91dCBv
ZiByZXNldC4gU28gaWYgS2V5IGlzIG5vdCBhbHJlYWR5IGxvYWRlZCwgaXRzIGFuIGVycm9yIHN0
YXRlLgo+ID4gICAJICovCj4gPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9B
RFdFTEwoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdF
TEwoaTkxNSkpCj4gPiAgIAkJaWYgKCEoSTkxNV9SRUFEKEhEQ1BfS0VZX1NUQVRVUykgJiBIRENQ
X0tFWV9MT0FEX0RPTkUpKQo+ID4gICAJCQlyZXR1cm4gLUVOWElPOwo+ID4gQEAgLTIxMyw4ICsy
MTMsOCBAQCBzdGF0aWMgaW50IGludGVsX2hkY3BfbG9hZF9rZXlzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIHBsYXRmb3JtcyBleGNlcHQgQlhUIGFuZCBHTEss
IGRpZmZlciBpbiB0aGUga2V5IGxvYWQgdHJpZ2dlciBwcm9jZXNzCj4gPiAgIAkgKiBmcm9tIG90
aGVyIHBsYXRmb3Jtcy4gU28gR0VOOV9CQyB1c2VzIHRoZSBHVCBEcml2ZXIgTWFpbGJveCBpL2Yu
Cj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKSB7Cj4gPiAtCQlyZXQg
PSBzYW5keWJyaWRnZV9wY29kZV93cml0ZShkZXZfcHJpdiwKPiA+ICsJaWYgKElTX0dFTjlfQkMo
aTkxNSkpIHsKPiA+ICsJCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGk5MTUsCj4gPiAg
IAkJCQkJICAgICAgU0tMX1BDT0RFX0xPQURfSERDUF9LRVlTLCAxKTsKPiA+ICAgCQlpZiAocmV0
KSB7Cj4gPiAgIAkJCURSTV9FUlJPUigiRmFpbGVkIHRvIGluaXRpYXRlIEhEQ1Aga2V5IGxvYWQg
KCVkKVxuIiwKPiA+IEBAIC0yMjYsNyArMjI2LDcgQEAgc3RhdGljIGludCBpbnRlbF9oZGNwX2xv
YWRfa2V5cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAl9Cj4gPiAg
IAkvKiBXYWl0IGZvciB0aGUga2V5cyB0byBsb2FkICg1MDB1cykgKi8KPiA+IC0JcmV0ID0gX19p
bnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwgSERDUF9LRVlfU1RBVFVT
LAo+ID4gKwlyZXQgPSBfX2ludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsIEhE
Q1BfS0VZX1NUQVRVUywKPiA+ICAgCQkJCQlIRENQX0tFWV9MT0FEX0RPTkUsIEhEQ1BfS0VZX0xP
QURfRE9ORSwKPiA+ICAgCQkJCQkxMCwgMSwgJnZhbCk7Cj4gPiAgIAlpZiAocmV0KQo+ID4gQEAg
LTI0MSwxMCArMjQxLDEwIEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRjcF9sb2FkX2tleXMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICB9Cj4gPiAgIC8qIFJldHVybnMgdXBk
YXRlZCBTSEEtMSBpbmRleCAqLwo+ID4gLXN0YXRpYyBpbnQgaW50ZWxfd3JpdGVfc2hhX3RleHQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgc2hhX3RleHQpCj4gPiArc3Rh
dGljIGludCBpbnRlbF93cml0ZV9zaGFfdGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwgdTMyIHNoYV90ZXh0KQo+ID4gICB7Cj4gPiAgIAlJOTE1X1dSSVRFKEhEQ1BfU0hBX1RFWFQs
IHNoYV90ZXh0KTsKPiA+IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+
dW5jb3JlLCBIRENQX1JFUF9DVEwsCj4gPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcigm
aTkxNS0+dW5jb3JlLCBIRENQX1JFUF9DVEwsCj4gPiAgIAkJCQkgICAgSERDUF9TSEExX1JFQURZ
LCBIRENQX1NIQTFfUkVBRFksIDEpKSB7Cj4gPiAgIAkJRFJNX0VSUk9SKCJUaW1lZCBvdXQgd2Fp
dGluZyBmb3IgU0hBMSByZWFkeVxuIik7Cj4gPiAgIAkJcmV0dXJuIC1FVElNRURPVVQ7Cj4gPiBA
QCAtMjc5LDExICsyNzksMTEgQEAgaW50IGludGVsX2hkY3BfdmFsaWRhdGVfdl9wcmltZShzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCwKPiA+ICAgCQkJCWNvbnN0IHN0
cnVjdCBpbnRlbF9oZGNwX3NoaW0gKnNoaW0sCj4gPiAgIAkJCQl1OCAqa3N2X2ZpZm8sIHU4IG51
bV9kb3duc3RyZWFtLCB1OCAqYnN0YXR1cykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1Owo+
ID4gICAJdTMyIHZwcmltZSwgc2hhX3RleHQsIHNoYV9sZWZ0b3ZlcnMsIHJlcF9jdGw7Cj4gPiAg
IAlpbnQgcmV0LCBpLCBqLCBzaGFfaWR4Owo+ID4gLQlkZXZfcHJpdiA9IGludGVsX2RpZ19wb3J0
LT5iYXNlLmJhc2UuZGV2LT5kZXZfcHJpdmF0ZTsKPiA+ICsJaTkxNSA9IGludGVsX2RpZ19wb3J0
LT5iYXNlLmJhc2UuZGV2LT5kZXZfcHJpdmF0ZTsKPiA+ICAgCS8qIFByb2Nlc3MgVicgdmFsdWVz
IGZyb20gdGhlIHJlY2VpdmVyICovCj4gPiAgIAlmb3IgKGkgPSAwOyBpIDwgRFJNX0hEQ1BfVl9Q
UklNRV9OVU1fUEFSVFM7IGkrKykgewo+ID4gQEAgLTMxNyw3ICszMTcsNyBAQCBpbnQgaW50ZWxf
aGRjcF92YWxpZGF0ZV92X3ByaW1lKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2Rp
Z19wb3J0LAo+ID4gICAJCWZvciAoaiA9IDA7IGogPCBzaGFfZW1wdHk7IGorKykKPiA+ICAgCQkJ
c2hhX3RleHQgfD0ga3N2W2pdIDw8ICgoc2l6ZW9mKHNoYV90ZXh0KSAtIGogLSAxKSAqIDgpOwo+
ID4gLQkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoZGV2X3ByaXYsIHNoYV90ZXh0KTsKPiA+
ICsJCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGk5MTUsIHNoYV90ZXh0KTsKPiA+ICAgCQlp
ZiAocmV0IDwgMCkKPiA+ICAgCQkJcmV0dXJuIHJldDsKPiA+IEBAIC0zNDAsNyArMzQwLDcgQEAg
aW50IGludGVsX2hkY3BfdmFsaWRhdGVfdl9wcmltZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICppbnRlbF9kaWdfcG9ydCwKPiA+ICAgCQlpZiAoc2l6ZW9mKHNoYV90ZXh0KSA+IHNoYV9sZWZ0
b3ZlcnMpCj4gPiAgIAkJCWNvbnRpbnVlOwo+ID4gLQkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3Rl
eHQoZGV2X3ByaXYsIHNoYV90ZXh0KTsKPiA+ICsJCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0
KGk5MTUsIHNoYV90ZXh0KTsKPiA+ICAgCQlpZiAocmV0IDwgMCkKPiA+ICAgCQkJcmV0dXJuIHJl
dDsKPiA+ICAgCQlzaGFfbGVmdG92ZXJzID0gMDsKPiA+IEBAIC0zNTcsNyArMzU3LDcgQEAgaW50
IGludGVsX2hkY3BfdmFsaWRhdGVfdl9wcmltZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpp
bnRlbF9kaWdfcG9ydCwKPiA+ICAgCWlmIChzaGFfbGVmdG92ZXJzID09IDApIHsKPiA+ICAgCQkv
KiBXcml0ZSAxNiBiaXRzIG9mIHRleHQsIDE2IGJpdHMgb2YgTTAgKi8KPiA+ICAgCQlJOTE1X1dS
SVRFKEhEQ1BfUkVQX0NUTCwgcmVwX2N0bCB8IEhEQ1BfU0hBMV9URVhUXzE2KTsKPiA+IC0JCXJl
dCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGRldl9wcml2LAo+ID4gKwkJcmV0ID0gaW50ZWxfd3Jp
dGVfc2hhX3RleHQoaTkxNSwKPiA+ICAgCQkJCQkgICBic3RhdHVzWzBdIDw8IDggfCBic3RhdHVz
WzFdKTsKPiA+ICAgCQlpZiAocmV0IDwgMCkKPiA+ICAgCQkJcmV0dXJuIHJldDsKPiA+IEBAIC0z
NjUsMTQgKzM2NSwxNCBAQCBpbnQgaW50ZWxfaGRjcF92YWxpZGF0ZV92X3ByaW1lKHN0cnVjdCBp
bnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ID4gICAJCS8qIFdyaXRlIDMyIGJp
dHMgb2YgTTAgKi8KPiA+ICAgCQlJOTE1X1dSSVRFKEhEQ1BfUkVQX0NUTCwgcmVwX2N0bCB8IEhE
Q1BfU0hBMV9URVhUXzApOwo+ID4gLQkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoZGV2X3By
aXYsIDApOwo+ID4gKwkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoaTkxNSwgMCk7Cj4gPiAg
IAkJaWYgKHJldCA8IDApCj4gPiAgIAkJCXJldHVybiByZXQ7Cj4gPiAgIAkJc2hhX2lkeCArPSBz
aXplb2Yoc2hhX3RleHQpOwo+ID4gICAJCS8qIFdyaXRlIDE2IGJpdHMgb2YgTTAgKi8KPiA+ICAg
CQlJOTE1X1dSSVRFKEhEQ1BfUkVQX0NUTCwgcmVwX2N0bCB8IEhEQ1BfU0hBMV9URVhUXzE2KTsK
PiA+IC0JCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGRldl9wcml2LCAwKTsKPiA+ICsJCXJl
dCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGk5MTUsIDApOwo+ID4gICAJCWlmIChyZXQgPCAwKQo+
ID4gICAJCQlyZXR1cm4gcmV0Owo+ID4gICAJCXNoYV9pZHggKz0gc2l6ZW9mKHNoYV90ZXh0KTsK
PiA+IEBAIC0zODMsMjEgKzM4MywyMSBAQCBpbnQgaW50ZWxfaGRjcF92YWxpZGF0ZV92X3ByaW1l
KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ID4gICAJCXNoYV90
ZXh0IHw9IGJzdGF0dXNbMF0gPDwgMTYgfCBic3RhdHVzWzFdIDw8IDg7Cj4gPiAgIAkJLyogT25s
eSAyNC1iaXRzIG9mIGRhdGEsIG11c3QgYmUgaW4gdGhlIExTQiAqLwo+ID4gICAJCXNoYV90ZXh0
ID0gKHNoYV90ZXh0ICYgMHhmZmZmZmYwMCkgPj4gODsKPiA+IC0JCXJldCA9IGludGVsX3dyaXRl
X3NoYV90ZXh0KGRldl9wcml2LCBzaGFfdGV4dCk7Cj4gPiArCQlyZXQgPSBpbnRlbF93cml0ZV9z
aGFfdGV4dChpOTE1LCBzaGFfdGV4dCk7Cj4gPiAgIAkJaWYgKHJldCA8IDApCj4gPiAgIAkJCXJl
dHVybiByZXQ7Cj4gPiAgIAkJc2hhX2lkeCArPSBzaXplb2Yoc2hhX3RleHQpOwo+ID4gICAJCS8q
IFdyaXRlIDMyIGJpdHMgb2YgTTAgKi8KPiA+ICAgCQlJOTE1X1dSSVRFKEhEQ1BfUkVQX0NUTCwg
cmVwX2N0bCB8IEhEQ1BfU0hBMV9URVhUXzApOwo+ID4gLQkJcmV0ID0gaW50ZWxfd3JpdGVfc2hh
X3RleHQoZGV2X3ByaXYsIDApOwo+ID4gKwkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoaTkx
NSwgMCk7Cj4gPiAgIAkJaWYgKHJldCA8IDApCj4gPiAgIAkJCXJldHVybiByZXQ7Cj4gPiAgIAkJ
c2hhX2lkeCArPSBzaXplb2Yoc2hhX3RleHQpOwo+ID4gICAJCS8qIFdyaXRlIDI0IGJpdHMgb2Yg
TTAgKi8KPiA+ICAgCQlJOTE1X1dSSVRFKEhEQ1BfUkVQX0NUTCwgcmVwX2N0bCB8IEhEQ1BfU0hB
MV9URVhUXzgpOwo+ID4gLQkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoZGV2X3ByaXYsIDAp
Owo+ID4gKwkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoaTkxNSwgMCk7Cj4gPiAgIAkJaWYg
KHJldCA8IDApCj4gPiAgIAkJCXJldHVybiByZXQ7Cj4gPiAgIAkJc2hhX2lkeCArPSBzaXplb2Yo
c2hhX3RleHQpOwo+ID4gQEAgLTQwNiw3ICs0MDYsNyBAQCBpbnQgaW50ZWxfaGRjcF92YWxpZGF0
ZV92X3ByaW1lKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ID4g
ICAJCS8qIFdyaXRlIDMyIGJpdHMgb2YgdGV4dCAqLwo+ID4gICAJCUk5MTVfV1JJVEUoSERDUF9S
RVBfQ1RMLCByZXBfY3RsIHwgSERDUF9TSEExX1RFWFRfMzIpOwo+ID4gICAJCXNoYV90ZXh0IHw9
IGJzdGF0dXNbMF0gPDwgMjQgfCBic3RhdHVzWzFdIDw8IDE2Owo+ID4gLQkJcmV0ID0gaW50ZWxf
d3JpdGVfc2hhX3RleHQoZGV2X3ByaXYsIHNoYV90ZXh0KTsKPiA+ICsJCXJldCA9IGludGVsX3dy
aXRlX3NoYV90ZXh0KGk5MTUsIHNoYV90ZXh0KTsKPiA+ICAgCQlpZiAocmV0IDwgMCkKPiA+ICAg
CQkJcmV0dXJuIHJldDsKPiA+ICAgCQlzaGFfaWR4ICs9IHNpemVvZihzaGFfdGV4dCk7Cj4gPiBA
QCAtNDE0LDcgKzQxNCw3IEBAIGludCBpbnRlbF9oZGNwX3ZhbGlkYXRlX3ZfcHJpbWUoc3RydWN0
IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gPiAgIAkJLyogV3JpdGUgNjQg
Yml0cyBvZiBNMCAqLwo+ID4gICAJCUk5MTVfV1JJVEUoSERDUF9SRVBfQ1RMLCByZXBfY3RsIHwg
SERDUF9TSEExX1RFWFRfMCk7Cj4gPiAgIAkJZm9yIChpID0gMDsgaSA8IDI7IGkrKykgewo+ID4g
LQkJCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGRldl9wcml2LCAwKTsKPiA+ICsJCQlyZXQg
PSBpbnRlbF93cml0ZV9zaGFfdGV4dChpOTE1LCAwKTsKPiA+ICAgCQkJaWYgKHJldCA8IDApCj4g
PiAgIAkJCQlyZXR1cm4gcmV0Owo+ID4gICAJCQlzaGFfaWR4ICs9IHNpemVvZihzaGFfdGV4dCk7
Cj4gPiBAQCAtNDIzLDI4ICs0MjMsMjggQEAgaW50IGludGVsX2hkY3BfdmFsaWRhdGVfdl9wcmlt
ZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCwKPiA+ICAgCQkvKiBX
cml0ZSAzMiBiaXRzIG9mIHRleHQgKi8KPiA+ICAgCQlJOTE1X1dSSVRFKEhEQ1BfUkVQX0NUTCwg
cmVwX2N0bCB8IEhEQ1BfU0hBMV9URVhUXzMyKTsKPiA+ICAgCQlzaGFfdGV4dCB8PSBic3RhdHVz
WzBdIDw8IDI0Owo+ID4gLQkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoZGV2X3ByaXYsIHNo
YV90ZXh0KTsKPiA+ICsJCXJldCA9IGludGVsX3dyaXRlX3NoYV90ZXh0KGk5MTUsIHNoYV90ZXh0
KTsKPiA+ICAgCQlpZiAocmV0IDwgMCkKPiA+ICAgCQkJcmV0dXJuIHJldDsKPiA+ICAgCQlzaGFf
aWR4ICs9IHNpemVvZihzaGFfdGV4dCk7Cj4gPiAgIAkJLyogV3JpdGUgOCBiaXRzIG9mIHRleHQs
IDI0IGJpdHMgb2YgTTAgKi8KPiA+ICAgCQlJOTE1X1dSSVRFKEhEQ1BfUkVQX0NUTCwgcmVwX2N0
bCB8IEhEQ1BfU0hBMV9URVhUXzgpOwo+ID4gLQkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQo
ZGV2X3ByaXYsIGJzdGF0dXNbMV0pOwo+ID4gKwkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQo
aTkxNSwgYnN0YXR1c1sxXSk7Cj4gPiAgIAkJaWYgKHJldCA8IDApCj4gPiAgIAkJCXJldHVybiBy
ZXQ7Cj4gPiAgIAkJc2hhX2lkeCArPSBzaXplb2Yoc2hhX3RleHQpOwo+ID4gICAJCS8qIFdyaXRl
IDMyIGJpdHMgb2YgTTAgKi8KPiA+ICAgCQlJOTE1X1dSSVRFKEhEQ1BfUkVQX0NUTCwgcmVwX2N0
bCB8IEhEQ1BfU0hBMV9URVhUXzApOwo+ID4gLQkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQo
ZGV2X3ByaXYsIDApOwo+ID4gKwkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoaTkxNSwgMCk7
Cj4gPiAgIAkJaWYgKHJldCA8IDApCj4gPiAgIAkJCXJldHVybiByZXQ7Cj4gPiAgIAkJc2hhX2lk
eCArPSBzaXplb2Yoc2hhX3RleHQpOwo+ID4gICAJCS8qIFdyaXRlIDggYml0cyBvZiBNMCAqLwo+
ID4gICAJCUk5MTVfV1JJVEUoSERDUF9SRVBfQ1RMLCByZXBfY3RsIHwgSERDUF9TSEExX1RFWFRf
MjQpOwo+ID4gLQkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoZGV2X3ByaXYsIDApOwo+ID4g
KwkJcmV0ID0gaW50ZWxfd3JpdGVfc2hhX3RleHQoaTkxNSwgMCk7Cj4gPiAgIAkJaWYgKHJldCA8
IDApCj4gPiAgIAkJCXJldHVybiByZXQ7Cj4gPiAgIAkJc2hhX2lkeCArPSBzaXplb2Yoc2hhX3Rl
eHQpOwo+ID4gQEAgLTQ1Nyw3ICs0NTcsNyBAQCBpbnQgaW50ZWxfaGRjcF92YWxpZGF0ZV92X3By
aW1lKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ID4gICAJSTkx
NV9XUklURShIRENQX1JFUF9DVEwsIHJlcF9jdGwgfCBIRENQX1NIQTFfVEVYVF8zMik7Cj4gPiAg
IAkvKiBGaWxsIHVwIHRvIDY0LTQgYnl0ZXMgd2l0aCB6ZXJvcyAobGVhdmUgdGhlIGxhc3Qgd3Jp
dGUgZm9yIGxlbmd0aCkgKi8KPiA+ICAgCXdoaWxlICgoc2hhX2lkeCAlIDY0KSA8ICg2NCAtIHNp
emVvZihzaGFfdGV4dCkpKSB7Cj4gPiAtCQlyZXQgPSBpbnRlbF93cml0ZV9zaGFfdGV4dChkZXZf
cHJpdiwgMCk7Cj4gPiArCQlyZXQgPSBpbnRlbF93cml0ZV9zaGFfdGV4dChpOTE1LCAwKTsKPiA+
ICAgCQlpZiAocmV0IDwgMCkKPiA+ICAgCQkJcmV0dXJuIHJldDsKPiA+ICAgCQlzaGFfaWR4ICs9
IHNpemVvZihzaGFfdGV4dCk7Cj4gPiBAQCAtNDY5LDEzICs0NjksMTMgQEAgaW50IGludGVsX2hk
Y3BfdmFsaWRhdGVfdl9wcmltZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdf
cG9ydCwKPiA+ICAgCSAqICAtIDEwIGJ5dGVzIGZvciBCSU5GTy9CU1RBVFVTKDIpLCBNMCg4KQo+
ID4gICAJICovCj4gPiAgIAlzaGFfdGV4dCA9IChudW1fZG93bnN0cmVhbSAqIDUgKyAxMCkgKiA4
Owo+ID4gLQlyZXQgPSBpbnRlbF93cml0ZV9zaGFfdGV4dChkZXZfcHJpdiwgc2hhX3RleHQpOwo+
ID4gKwlyZXQgPSBpbnRlbF93cml0ZV9zaGFfdGV4dChpOTE1LCBzaGFfdGV4dCk7Cj4gPiAgIAlp
ZiAocmV0IDwgMCkKPiA+ICAgCQlyZXR1cm4gcmV0Owo+ID4gICAJLyogVGVsbCB0aGUgSFcgd2Un
cmUgZG9uZSB3aXRoIHRoZSBoYXNoIGFuZCB3YWl0IGZvciBpdCB0byBBQ0sgKi8KPiA+ICAgCUk5
MTVfV1JJVEUoSERDUF9SRVBfQ1RMLCByZXBfY3RsIHwgSERDUF9TSEExX0NPTVBMRVRFX0hBU0gp
Owo+ID4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsIEhE
Q1BfUkVQX0NUTCwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNv
cmUsIEhEQ1BfUkVQX0NUTCwKPiA+ICAgCQkJCSAgICBIRENQX1NIQTFfQ09NUExFVEUsCj4gPiAg
IAkJCQkgICAgSERDUF9TSEExX0NPTVBMRVRFLCAxKSkgewo+ID4gICAJCURSTV9FUlJPUigiVGlt
ZWQgb3V0IHdhaXRpbmcgZm9yIFNIQTEgY29tcGxldGVcbiIpOwo+ID4gQEAgLTU3MSw3ICs1NzEs
NyBAQCBzdGF0aWMgaW50IGludGVsX2hkY3BfYXV0aChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpj
b25uZWN0b3IpCj4gPiAgIAlzdHJ1Y3QgaW50ZWxfaGRjcCAqaGRjcCA9ICZjb25uZWN0b3ItPmhk
Y3A7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY29ubmVjdG9yLT5iYXNlLmRldjsK
PiA+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9oZGNwX3NoaW0gKnNoaW0gPSBoZGNwLT5zaGltOwo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXY7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1Owo+ID4gICAJZW51bSBwb3J0IHBvcnQ7Cj4gPiAgIAl1bnNpZ25l
ZCBsb25nIHIwX3ByaW1lX2dlbl9zdGFydDsKPiA+ICAgCWludCByZXQsIGksIHRyaWVzID0gMjsK
PiA+IEBAIC01ODksNyArNTg5LDcgQEAgc3RhdGljIGludCBpbnRlbF9oZGNwX2F1dGgoc3RydWN0
IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICAJfSByaTsKPiA+ICAgCWJvb2wgcmVw
ZWF0ZXJfcHJlc2VudCwgaGRjcF9jYXBhYmxlOwo+ID4gLQlkZXZfcHJpdiA9IGludGVsX2RpZ19w
b3J0LT5iYXNlLmJhc2UuZGV2LT5kZXZfcHJpdmF0ZTsKPiA+ICsJaTkxNSA9IGludGVsX2RpZ19w
b3J0LT5iYXNlLmJhc2UuZGV2LT5kZXZfcHJpdmF0ZTsKPiA+ICAgCXBvcnQgPSBpbnRlbF9kaWdf
cG9ydC0+YmFzZS5wb3J0Owo+ID4gQEAgLTYxNSw3ICs2MTUsNyBAQCBzdGF0aWMgaW50IGludGVs
X2hkY3BfYXV0aChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIAlJOTE1
X1dSSVRFKFBPUlRfSERDUF9DT05GKHBvcnQpLCBIRENQX0NPTkZfQ0FQVFVSRV9BTik7Cj4gPiAg
IAkvKiBXYWl0IGZvciBBbiB0byBiZSBhY3F1aXJlZCAqLwo+ID4gLQlpZiAoaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsIFBPUlRfSERDUF9TVEFUVVMocG9ydCksCj4g
PiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLCBQT1JUX0hEQ1Bf
U1RBVFVTKHBvcnQpLAo+ID4gICAJCQkJICAgIEhEQ1BfU1RBVFVTX0FOX1JFQURZLAo+ID4gICAJ
CQkJICAgIEhEQ1BfU1RBVFVTX0FOX1JFQURZLCAxKSkgewo+ID4gICAJCURSTV9FUlJPUigiVGlt
ZWQgb3V0IHdhaXRpbmcgZm9yIEFuXG4iKTsKPiA+IEBAIC03MDEsNyArNzAxLDcgQEAgc3RhdGlj
IGludCBpbnRlbF9oZGNwX2F1dGgoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+
ID4gICAJfQo+ID4gICAJLyogV2FpdCBmb3IgZW5jcnlwdGlvbiBjb25maXJtYXRpb24gKi8KPiA+
IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLCBQT1JUX0hE
Q1BfU1RBVFVTKHBvcnQpLAo+ID4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUt
PnVuY29yZSwgUE9SVF9IRENQX1NUQVRVUyhwb3J0KSwKPiA+ICAgCQkJCSAgICBIRENQX1NUQVRV
U19FTkMsIEhEQ1BfU1RBVFVTX0VOQywKPiA+ICAgCQkJCSAgICBFTkNSWVBUX1NUQVRVU19DSEFO
R0VfVElNRU9VVF9NUykpIHsKPiA+ICAgCQlEUk1fRVJST1IoIlRpbWVkIG91dCB3YWl0aW5nIGZv
ciBlbmNyeXB0aW9uXG4iKTsKPiA+IEBAIC03MjMsNyArNzIzLDcgQEAgc3RhdGljIGludCBpbnRl
bF9oZGNwX2F1dGgoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICBzdGF0
aWMgaW50IF9pbnRlbF9oZGNwX2Rpc2FibGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfaGRjcCAqaGRjcCA9ICZjb25uZWN0b3It
PmhkY3A7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGNvbm5lY3Rv
ci0+YmFzZS5kZXYtPmRldl9wcml2YXRlOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IGNvbm5lY3Rvci0+YmFzZS5kZXYtPmRldl9wcml2YXRlOwo+ID4gICAJc3RydWN0IGlu
dGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBjb25uX3RvX2RpZ19wb3J0KGNvbm5l
Y3Rvcik7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGludGVsX2RpZ19wb3J0LT5iYXNlLnBvcnQ7
Cj4gPiAgIAlpbnQgcmV0Owo+ID4gQEAgLTczMyw3ICs3MzMsNyBAQCBzdGF0aWMgaW50IF9pbnRl
bF9oZGNwX2Rpc2FibGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICAJ
aGRjcC0+aGRjcF9lbmNyeXB0ZWQgPSBmYWxzZTsKPiA+ICAgCUk5MTVfV1JJVEUoUE9SVF9IRENQ
X0NPTkYocG9ydCksIDApOwo+ID4gLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9w
cml2LT51bmNvcmUsCj4gPiArCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5j
b3JlLAo+ID4gICAJCQkJICAgIFBPUlRfSERDUF9TVEFUVVMocG9ydCksIH4wLCAwLAo+ID4gICAJ
CQkJICAgIEVOQ1JZUFRfU1RBVFVTX0NIQU5HRV9USU1FT1VUX01TKSkgewo+ID4gICAJCURSTV9F
UlJPUigiRmFpbGVkIHRvIGRpc2FibGUgSERDUCwgdGltZW91dCBjbGVhcmluZyBzdGF0dXNcbiIp
Owo+ID4gQEAgLTc1MywyMiArNzUzLDIyIEBAIHN0YXRpYyBpbnQgX2ludGVsX2hkY3BfZGlzYWJs
ZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHN0YXRpYyBpbnQgX2lu
dGVsX2hkY3BfZW5hYmxlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAg
ewo+ID4gICAJc3RydWN0IGludGVsX2hkY3AgKmhkY3AgPSAmY29ubmVjdG9yLT5oZGNwOwo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBjb25uZWN0b3ItPmJhc2UuZGV2
LT5kZXZfcHJpdmF0ZTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBjb25u
ZWN0b3ItPmJhc2UuZGV2LT5kZXZfcHJpdmF0ZTsKPiA+ICAgCWludCBpLCByZXQsIHRyaWVzID0g
MzsKPiA+ICAgCURSTV9ERUJVR19LTVMoIlslczolZF0gSERDUCBpcyBiZWluZyBlbmFibGVkLi4u
XG4iLAo+ID4gICAJCSAgICAgIGNvbm5lY3Rvci0+YmFzZS5uYW1lLCBjb25uZWN0b3ItPmJhc2Uu
YmFzZS5pZCk7Cj4gPiAtCWlmICghaGRjcF9rZXlfbG9hZGFibGUoZGV2X3ByaXYpKSB7Cj4gPiAr
CWlmICghaGRjcF9rZXlfbG9hZGFibGUoaTkxNSkpIHsKPiA+ICAgCQlEUk1fRVJST1IoIkhEQ1Ag
a2V5IExvYWQgaXMgbm90IHBvc3NpYmxlXG4iKTsKPiA+ICAgCQlyZXR1cm4gLUVOWElPOwo+ID4g
ICAJfQo+ID4gICAJZm9yIChpID0gMDsgaSA8IEtFWV9MT0FEX1RSSUVTOyBpKyspIHsKPiA+IC0J
CXJldCA9IGludGVsX2hkY3BfbG9hZF9rZXlzKGRldl9wcml2KTsKPiA+ICsJCXJldCA9IGludGVs
X2hkY3BfbG9hZF9rZXlzKGk5MTUpOwo+ID4gICAJCWlmICghcmV0KQo+ID4gICAJCQlicmVhazsK
PiA+IC0JCWludGVsX2hkY3BfY2xlYXJfa2V5cyhkZXZfcHJpdik7Cj4gPiArCQlpbnRlbF9oZGNw
X2NsZWFyX2tleXMoaTkxNSk7Cj4gPiAgIAl9Cj4gPiAgIAlpZiAocmV0KSB7Cj4gPiAgIAkJRFJN
X0VSUk9SKCJDb3VsZCBub3QgbG9hZCBIRENQIGtleXMsICglZClcbiIsIHJldCk7Cj4gPiBAQCAt
ODAzLDcgKzgwMyw3IEBAIHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmludGVsX2hkY3BfdG9fY29u
bmVjdG9yKHN0cnVjdCBpbnRlbF9oZGNwICpoZGNwKQo+ID4gICBzdGF0aWMgaW50IGludGVsX2hk
Y3BfY2hlY2tfbGluayhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9oZGNwICpoZGNwID0gJmNvbm5lY3Rvci0+aGRjcDsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gY29ubmVjdG9yLT5iYXNlLmRldi0+
ZGV2X3ByaXZhdGU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY29ubmVj
dG9yLT5iYXNlLmRldi0+ZGV2X3ByaXZhdGU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9w
b3J0ICppbnRlbF9kaWdfcG9ydCA9IGNvbm5fdG9fZGlnX3BvcnQoY29ubmVjdG9yKTsKPiA+ICAg
CWVudW0gcG9ydCBwb3J0ID0gaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKPiA+ICAgCWludCBy
ZXQgPSAwOwo+ID4gQEAgLTg4NCwxMCArODg0LDEwIEBAIHN0YXRpYyB2b2lkIGludGVsX2hkY3Bf
cHJvcF93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgCWRybV9tb2Rlc2V0X3Vu
bG9jaygmZGV2LT5tb2RlX2NvbmZpZy5jb25uZWN0aW9uX211dGV4KTsKPiA+ICAgfQo+ID4gLWJv
b2wgaXNfaGRjcF9zdXBwb3J0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBl
bnVtIHBvcnQgcG9ydCkKPiA+ICtib29sIGlzX2hkY3Bfc3VwcG9ydGVkKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+ID4gICAJLyogUE9SVCBF
IGRvZXNuJ3QgaGF2ZSBIRENQLCBhbmQgUE9SVCBGIGlzIGRpc2FibGVkICovCj4gPiAtCXJldHVy
biBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkgJiYgcG9ydCA8IFBPUlRfRTsKPiA+ICsJcmV0dXJu
IElOVEVMX0dFTihpOTE1KSA+PSA5ICYmIHBvcnQgPCBQT1JUX0U7Cj4gPiAgIH0KPiA+ICAgc3Rh
dGljIGludAo+ID4gQEAgLTg5NSwyMiArODk1LDIyIEBAIGhkY3AyX3ByZXBhcmVfYWtlX2luaXQo
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ID4gICAJCSAgICAgICBzdHJ1Y3Qg
aGRjcDJfYWtlX2luaXQgKmFrZV9kYXRhKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaGRjcF9wb3J0
X2RhdGEgKmRhdGEgPSAmY29ubmVjdG9yLT5oZGNwLnBvcnRfZGF0YTsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+
YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGk5MTVfaGRjcF9jb21wX21hc3RlciAqY29tcDsKPiA+
ICAgCWludCByZXQ7Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgp
Owo+ID4gLQljb21wID0gZGV2X3ByaXYtPmhkY3BfbWFzdGVyOwo+ID4gKwltdXRleF9sb2NrKCZp
OTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gKwljb21wID0gaTkxNS0+aGRjcF9tYXN0ZXI7Cj4g
PiAgIAlpZiAoIWNvbXAgfHwgIWNvbXAtPm9wcykgewo+ID4gLQkJbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiA+ICsJCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9j
b21wX211dGV4KTsKPiA+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICAgCX0KPiA+ICAgCXJldCA9
IGNvbXAtPm9wcy0+aW5pdGlhdGVfaGRjcDJfc2Vzc2lvbihjb21wLT5tZWlfZGV2LCBkYXRhLCBh
a2VfZGF0YSk7Cj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCURSTV9ERUJVR19LTVMoIlByZXBhcmVf
YWtlX2luaXQgZmFpbGVkLiAlZFxuIiwgcmV0KTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJp
di0+aGRjcF9jb21wX211dGV4KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5oZGNwX2NvbXBf
bXV0ZXgpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTkyMywxNSArOTIzLDE1
IEBAIGhkY3AyX3ZlcmlmeV9yeF9jZXJ0X3ByZXBhcmVfa20oc3RydWN0IGludGVsX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yLAo+ID4gICAJCQkJc2l6ZV90ICptc2dfc3opCj4gPiAgIHsKPiA+ICAgCXN0
cnVjdCBoZGNwX3BvcnRfZGF0YSAqZGF0YSA9ICZjb25uZWN0b3ItPmhkY3AucG9ydF9kYXRhOwo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rv
ci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9oZGNwX2NvbXBfbWFz
dGVyICpjb21wOwo+ID4gICAJaW50IHJldDsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmhk
Y3BfY29tcF9tdXRleCk7Cj4gPiAtCWNvbXAgPSBkZXZfcHJpdi0+aGRjcF9tYXN0ZXI7Cj4gPiAr
CW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiArCWNvbXAgPSBpOTE1LT5o
ZGNwX21hc3RlcjsKPiA+ICAgCWlmICghY29tcCB8fCAhY29tcC0+b3BzKSB7Cj4gPiAtCQltdXRl
eF91bmxvY2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gKwkJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gICAJCXJldHVybiAtRUlOVkFMOwo+ID4gICAJ
fQo+ID4gQEAgLTk0MCw3ICs5NDAsNyBAQCBoZGNwMl92ZXJpZnlfcnhfY2VydF9wcmVwYXJlX2tt
KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgCQkJCQkJCSBla19wdWJf
a20sIG1zZ19zeik7Cj4gPiAgIAlpZiAocmV0IDwgMCkKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJW
ZXJpZnkgcnhfY2VydCBmYWlsZWQuICVkXG4iLCByZXQpOwo+ID4gLQltdXRleF91bmxvY2soJmRl
dl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmhkY3Bf
Y29tcF9tdXRleCk7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtOTQ5LDIyICs5
NDksMjIgQEAgc3RhdGljIGludCBoZGNwMl92ZXJpZnlfaHByaW1lKHN0cnVjdCBpbnRlbF9jb25u
ZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgCQkJICAgICAgIHN0cnVjdCBoZGNwMl9ha2Vfc2VuZF9o
cHJpbWUgKnJ4X2hwcmltZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGhkY3BfcG9ydF9kYXRhICpk
YXRhID0gJmNvbm5lY3Rvci0+aGRjcC5wb3J0X2RhdGE7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2
KTsKPiA+ICAgCXN0cnVjdCBpOTE1X2hkY3BfY29tcF9tYXN0ZXIgKmNvbXA7Cj4gPiAgIAlpbnQg
cmV0Owo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiA+IC0J
Y29tcCA9IGRldl9wcml2LT5oZGNwX21hc3RlcjsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+aGRj
cF9jb21wX211dGV4KTsKPiA+ICsJY29tcCA9IGk5MTUtPmhkY3BfbWFzdGVyOwo+ID4gICAJaWYg
KCFjb21wIHx8ICFjb21wLT5vcHMpIHsKPiA+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhk
Y3BfY29tcF9tdXRleCk7Cj4gPiArCQltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRl
eCk7Cj4gPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gPiAgIAl9Cj4gPiAgIAlyZXQgPSBjb21wLT5v
cHMtPnZlcmlmeV9ocHJpbWUoY29tcC0+bWVpX2RldiwgZGF0YSwgcnhfaHByaW1lKTsKPiA+ICAg
CWlmIChyZXQgPCAwKQo+ID4gICAJCURSTV9ERUJVR19LTVMoIlZlcmlmeSBocHJpbWUgZmFpbGVk
LiAlZFxuIiwgcmV0KTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211
dGV4KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gICAJ
cmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTk3NCwyMiArOTc0LDIyIEBAIGhkY3AyX3N0b3Jl
X3BhaXJpbmdfaW5mbyhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsCj4gPiAgIAkJ
CSBzdHJ1Y3QgaGRjcDJfYWtlX3NlbmRfcGFpcmluZ19pbmZvICpwYWlyaW5nX2luZm8pCj4gPiAg
IHsKPiA+ICAgCXN0cnVjdCBoZGNwX3BvcnRfZGF0YSAqZGF0YSA9ICZjb25uZWN0b3ItPmhkY3Au
cG9ydF9kYXRhOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9o
ZGNwX2NvbXBfbWFzdGVyICpjb21wOwo+ID4gICAJaW50IHJldDsKPiA+IC0JbXV0ZXhfbG9jaygm
ZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiAtCWNvbXAgPSBkZXZfcHJpdi0+aGRjcF9t
YXN0ZXI7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiArCWNv
bXAgPSBpOTE1LT5oZGNwX21hc3RlcjsKPiA+ICAgCWlmICghY29tcCB8fCAhY29tcC0+b3BzKSB7
Cj4gPiAtCQltdXRleF91bmxvY2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gKwkJ
bXV0ZXhfdW5sb2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gICAJCXJldHVybiAtRUlO
VkFMOwo+ID4gICAJfQo+ID4gICAJcmV0ID0gY29tcC0+b3BzLT5zdG9yZV9wYWlyaW5nX2luZm8o
Y29tcC0+bWVpX2RldiwgZGF0YSwgcGFpcmluZ19pbmZvKTsKPiA+ICAgCWlmIChyZXQgPCAwKQo+
ID4gICAJCURSTV9ERUJVR19LTVMoIlN0b3JlIHBhaXJpbmcgaW5mbyBmYWlsZWQuICVkXG4iLCBy
ZXQpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4g
KwltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiAgIAlyZXR1cm4gcmV0
Owo+ID4gICB9Cj4gPiBAQCAtOTk5LDIyICs5OTksMjIgQEAgaGRjcDJfcHJlcGFyZV9sY19pbml0
KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgCQkgICAgICBzdHJ1Y3Qg
aGRjcDJfbGNfaW5pdCAqbGNfaW5pdCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGhkY3BfcG9ydF9k
YXRhICpkYXRhID0gJmNvbm5lY3Rvci0+aGRjcC5wb3J0X2RhdGE7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJh
c2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpOTE1X2hkY3BfY29tcF9tYXN0ZXIgKmNvbXA7Cj4gPiAg
IAlpbnQgcmV0Owo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsK
PiA+IC0JY29tcCA9IGRldl9wcml2LT5oZGNwX21hc3RlcjsKPiA+ICsJbXV0ZXhfbG9jaygmaTkx
NS0+aGRjcF9jb21wX211dGV4KTsKPiA+ICsJY29tcCA9IGk5MTUtPmhkY3BfbWFzdGVyOwo+ID4g
ICAJaWYgKCFjb21wIHx8ICFjb21wLT5vcHMpIHsKPiA+IC0JCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiArCQltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29t
cF9tdXRleCk7Cj4gPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gPiAgIAl9Cj4gPiAgIAlyZXQgPSBj
b21wLT5vcHMtPmluaXRpYXRlX2xvY2FsaXR5X2NoZWNrKGNvbXAtPm1laV9kZXYsIGRhdGEsIGxj
X2luaXQpOwo+ID4gICAJaWYgKHJldCA8IDApCj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiUHJlcGFy
ZSBsY19pbml0IGZhaWxlZC4gJWRcbiIsIHJldCk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9jb21w
X211dGV4KTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IEBAIC0xMDI0LDIyICsxMDI0
LDIyIEBAIGhkY3AyX3ZlcmlmeV9scHJpbWUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yLAo+ID4gICAJCSAgICBzdHJ1Y3QgaGRjcDJfbGNfc2VuZF9scHJpbWUgKnJ4X2xwcmltZSkK
PiA+ICAgewo+ID4gICAJc3RydWN0IGhkY3BfcG9ydF9kYXRhICpkYXRhID0gJmNvbm5lY3Rvci0+
aGRjcC5wb3J0X2RhdGE7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBp
OTE1X2hkY3BfY29tcF9tYXN0ZXIgKmNvbXA7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gLQltdXRleF9s
b2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiA+IC0JY29tcCA9IGRldl9wcml2LT5o
ZGNwX21hc3RlcjsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiA+
ICsJY29tcCA9IGk5MTUtPmhkY3BfbWFzdGVyOwo+ID4gICAJaWYgKCFjb21wIHx8ICFjb21wLT5v
cHMpIHsKPiA+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4g
PiArCQltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiAgIAkJcmV0dXJu
IC1FSU5WQUw7Cj4gPiAgIAl9Cj4gPiAgIAlyZXQgPSBjb21wLT5vcHMtPnZlcmlmeV9scHJpbWUo
Y29tcC0+bWVpX2RldiwgZGF0YSwgcnhfbHByaW1lKTsKPiA+ICAgCWlmIChyZXQgPCAwKQo+ID4g
ICAJCURSTV9ERUJVR19LTVMoIlZlcmlmeSBMX1ByaW1lIGZhaWxlZC4gJWRcbiIsIHJldCk7Cj4g
PiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiArCW11dGV4
X3VubG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAg
IH0KPiA+IEBAIC0xMDQ4LDIyICsxMDQ4LDIyIEBAIHN0YXRpYyBpbnQgaGRjcDJfcHJlcGFyZV9z
a2V5KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgCQkJICAgICAgc3Ry
dWN0IGhkY3AyX3NrZV9zZW5kX2VrcyAqc2tlX2RhdGEpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBo
ZGNwX3BvcnRfZGF0YSAqZGF0YSA9ICZjb25uZWN0b3ItPmhkY3AucG9ydF9kYXRhOwo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFz
ZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29u
bmVjdG9yLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9oZGNwX2NvbXBfbWFzdGVyICpj
b21wOwo+ID4gICAJaW50IHJldDsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmhkY3BfY29t
cF9tdXRleCk7Cj4gPiAtCWNvbXAgPSBkZXZfcHJpdi0+aGRjcF9tYXN0ZXI7Cj4gPiArCW11dGV4
X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiArCWNvbXAgPSBpOTE1LT5oZGNwX21h
c3RlcjsKPiA+ICAgCWlmICghY29tcCB8fCAhY29tcC0+b3BzKSB7Cj4gPiAtCQltdXRleF91bmxv
Y2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gKwkJbXV0ZXhfdW5sb2NrKCZpOTE1
LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gICAJCXJldHVybiAtRUlOVkFMOwo+ID4gICAJfQo+ID4g
ICAJcmV0ID0gY29tcC0+b3BzLT5nZXRfc2Vzc2lvbl9rZXkoY29tcC0+bWVpX2RldiwgZGF0YSwg
c2tlX2RhdGEpOwo+ID4gICAJaWYgKHJldCA8IDApCj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiR2V0
IHNlc3Npb24ga2V5IGZhaWxlZC4gJWRcbiIsIHJldCk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2
X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9j
b21wX211dGV4KTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IEBAIC0xMDc1LDE1ICsx
MDc1LDE1IEBAIGhkY3AyX3ZlcmlmeV9yZXBfdG9wb2xvZ3lfcHJlcGFyZV9hY2soc3RydWN0IGlu
dGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ID4gICAJCQkJICAgICAgc3RydWN0IGhkY3AyX3Jl
cF9zZW5kX2FjayAqcmVwX3NlbmRfYWNrKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaGRjcF9wb3J0
X2RhdGEgKmRhdGEgPSAmY29ubmVjdG9yLT5oZGNwLnBvcnRfZGF0YTsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+
YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGk5MTVfaGRjcF9jb21wX21hc3RlciAqY29tcDsKPiA+
ICAgCWludCByZXQ7Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgp
Owo+ID4gLQljb21wID0gZGV2X3ByaXYtPmhkY3BfbWFzdGVyOwo+ID4gKwltdXRleF9sb2NrKCZp
OTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gKwljb21wID0gaTkxNS0+aGRjcF9tYXN0ZXI7Cj4g
PiAgIAlpZiAoIWNvbXAgfHwgIWNvbXAtPm9wcykgewo+ID4gLQkJbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiA+ICsJCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9j
b21wX211dGV4KTsKPiA+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICAgCX0KPiA+IEBAIC0xMDky
LDcgKzEwOTIsNyBAQCBoZGNwMl92ZXJpZnlfcmVwX3RvcG9sb2d5X3ByZXBhcmVfYWNrKHN0cnVj
dCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgCQkJCQkJCSByZXBfc2VuZF9hY2sp
Owo+ID4gICAJaWYgKHJldCA8IDApCj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiVmVyaWZ5IHJlcCB0
b3BvbG9neSBmYWlsZWQuICVkXG4iLCByZXQpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2
LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9t
dXRleCk7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtMTEwMiwyMiArMTEwMiwy
MiBAQCBoZGNwMl92ZXJpZnlfbXByaW1lKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3Rv
ciwKPiA+ICAgCQkgICAgc3RydWN0IGhkY3AyX3JlcF9zdHJlYW1fcmVhZHkgKnN0cmVhbV9yZWFk
eSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGhkY3BfcG9ydF9kYXRhICpkYXRhID0gJmNvbm5lY3Rv
ci0+aGRjcC5wb3J0X2RhdGE7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVj
dCBpOTE1X2hkY3BfY29tcF9tYXN0ZXIgKmNvbXA7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gLQltdXRl
eF9sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiA+IC0JY29tcCA9IGRldl9wcml2
LT5oZGNwX21hc3RlcjsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsK
PiA+ICsJY29tcCA9IGk5MTUtPmhkY3BfbWFzdGVyOwo+ID4gICAJaWYgKCFjb21wIHx8ICFjb21w
LT5vcHMpIHsKPiA+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7
Cj4gPiArCQltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiAgIAkJcmV0
dXJuIC1FSU5WQUw7Cj4gPiAgIAl9Cj4gPiAgIAlyZXQgPSBjb21wLT5vcHMtPnZlcmlmeV9tcHJp
bWUoY29tcC0+bWVpX2RldiwgZGF0YSwgc3RyZWFtX3JlYWR5KTsKPiA+ICAgCWlmIChyZXQgPCAw
KQo+ID4gICAJCURSTV9ERUJVR19LTVMoIlZlcmlmeSBtcHJpbWUgZmFpbGVkLiAlZFxuIiwgcmV0
KTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiA+ICsJ
bXV0ZXhfdW5sb2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gICAJcmV0dXJuIHJldDsK
PiA+ICAgfQo+ID4gQEAgLTExMjUsNDMgKzExMjUsNDMgQEAgaGRjcDJfdmVyaWZ5X21wcmltZShz
dHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsCj4gPiAgIHN0YXRpYyBpbnQgaGRjcDJf
YXV0aGVudGljYXRlX3BvcnQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4g
ICB7Cj4gPiAgIAlzdHJ1Y3QgaGRjcF9wb3J0X2RhdGEgKmRhdGEgPSAmY29ubmVjdG9yLT5oZGNw
LnBvcnRfZGF0YTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGk5MTVf
aGRjcF9jb21wX21hc3RlciAqY29tcDsKPiA+ICAgCWludCByZXQ7Cj4gPiAtCW11dGV4X2xvY2so
JmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gLQljb21wID0gZGV2X3ByaXYtPmhkY3Bf
bWFzdGVyOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gKwlj
b21wID0gaTkxNS0+aGRjcF9tYXN0ZXI7Cj4gPiAgIAlpZiAoIWNvbXAgfHwgIWNvbXAtPm9wcykg
ewo+ID4gLQkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiA+ICsJ
CW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiA+ICAgCQlyZXR1cm4gLUVJ
TlZBTDsKPiA+ICAgCX0KPiA+ICAgCXJldCA9IGNvbXAtPm9wcy0+ZW5hYmxlX2hkY3BfYXV0aGVu
dGljYXRpb24oY29tcC0+bWVpX2RldiwgZGF0YSk7Cj4gPiAgIAlpZiAocmV0IDwgMCkKPiA+ICAg
CQlEUk1fREVCVUdfS01TKCJFbmFibGUgaGRjcCBhdXRoIGZhaWxlZC4gJWRcbiIsIHJldCk7Cj4g
PiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiArCW11dGV4
X3VubG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAg
IH0KPiA+ICAgc3RhdGljIGludCBoZGNwMl9jbG9zZV9tZWlfc2Vzc2lvbihzdHJ1Y3QgaW50ZWxf
Y29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+
ID4gICAJc3RydWN0IGk5MTVfaGRjcF9jb21wX21hc3RlciAqY29tcDsKPiA+ICAgCWludCByZXQ7
Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gLQljb21w
ID0gZGV2X3ByaXYtPmhkY3BfbWFzdGVyOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5oZGNwX2Nv
bXBfbXV0ZXgpOwo+ID4gKwljb21wID0gaTkxNS0+aGRjcF9tYXN0ZXI7Cj4gPiAgIAlpZiAoIWNv
bXAgfHwgIWNvbXAtPm9wcykgewo+ID4gLQkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9j
b21wX211dGV4KTsKPiA+ICsJCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsK
PiA+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICAgCX0KPiA+ICAgCXJldCA9IGNvbXAtPm9wcy0+
Y2xvc2VfaGRjcF9zZXNzaW9uKGNvbXAtPm1laV9kZXYsCj4gPiAgIAkJCQkJICAgICAmY29ubmVj
dG9yLT5oZGNwLnBvcnRfZGF0YSk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhkY3Bf
Y29tcF9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsK
PiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IEBAIC0xNDg4LDcgKzE0ODgsNyBAQCBzdGF0
aWMgaW50IGhkY3AyX2F1dGhlbnRpY2F0ZV9zaW5rKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNv
bm5lY3RvcikKPiA+ICAgc3RhdGljIGludCBoZGNwMl9lbmFibGVfZW5jcnlwdGlvbihzdHJ1Y3Qg
aW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9k
aWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0gY29ubl90b19kaWdfcG9ydChjb25uZWN0b3Ip
Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5l
Y3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfaGRjcCAqaGRj
cCA9ICZjb25uZWN0b3ItPmhkY3A7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydCA9IGNvbm5lY3Rvci0+
ZW5jb2Rlci0+cG9ydDsKPiA+ICAgCWludCByZXQ7Cj4gPiBAQCAtMTUxMSw3ICsxNTExLDcgQEAg
c3RhdGljIGludCBoZGNwMl9lbmFibGVfZW5jcnlwdGlvbihzdHJ1Y3QgaW50ZWxfY29ubmVjdG9y
ICpjb25uZWN0b3IpCj4gPiAgIAkJCSAgIENUTF9MSU5LX0VOQ1JZUFRJT05fUkVRKTsKPiA+ICAg
CX0KPiA+IC0JcmV0ID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUs
IEhEQ1AyX1NUQVRVU19EREkocG9ydCksCj4gPiArCXJldCA9IGludGVsX3dhaXRfZm9yX3JlZ2lz
dGVyKCZpOTE1LT51bmNvcmUsIEhEQ1AyX1NUQVRVU19EREkocG9ydCksCj4gPiAgIAkJCQkgICAg
ICBMSU5LX0VOQ1JZUFRJT05fU1RBVFVTLAo+ID4gICAJCQkJICAgICAgTElOS19FTkNSWVBUSU9O
X1NUQVRVUywKPiA+ICAgCQkJCSAgICAgIEVOQ1JZUFRfU1RBVFVTX0NIQU5HRV9USU1FT1VUX01T
KTsKPiA+IEBAIC0xNTIyLDcgKzE1MjIsNyBAQCBzdGF0aWMgaW50IGhkY3AyX2VuYWJsZV9lbmNy
eXB0aW9uKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgc3RhdGljIGlu
dCBoZGNwMl9kaXNhYmxlX2VuY3J5cHRpb24oc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdf
cG9ydCA9IGNvbm5fdG9fZGlnX3BvcnQoY29ubmVjdG9yKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5k
ZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2hkY3AgKmhkY3AgPSAmY29ubmVjdG9yLT5oZGNwOwo+
ID4gICAJZW51bSBwb3J0IHBvcnQgPSBjb25uZWN0b3ItPmVuY29kZXItPnBvcnQ7Cj4gPiAgIAlp
bnQgcmV0Owo+ID4gQEAgLTE1MzIsNyArMTUzMiw3IEBAIHN0YXRpYyBpbnQgaGRjcDJfZGlzYWJs
ZV9lbmNyeXB0aW9uKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgCUk5
MTVfV1JJVEUoSERDUDJfQ1RMX0RESShwb3J0KSwKPiA+ICAgCQkgICBJOTE1X1JFQUQoSERDUDJf
Q1RMX0RESShwb3J0KSkgJiB+Q1RMX0xJTktfRU5DUllQVElPTl9SRVEpOwo+ID4gLQlyZXQgPSBp
bnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwgSERDUDJfU1RBVFVTX0RE
SShwb3J0KSwKPiA+ICsJcmV0ID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29y
ZSwgSERDUDJfU1RBVFVTX0RESShwb3J0KSwKPiA+ICAgCQkJCSAgICAgIExJTktfRU5DUllQVElP
Tl9TVEFUVVMsIDB4MCwKPiA+ICAgCQkJCSAgICAgIEVOQ1JZUFRfU1RBVFVTX0NIQU5HRV9USU1F
T1VUX01TKTsKPiA+ICAgCWlmIChyZXQgPT0gLUVUSU1FRE9VVCkKPiA+IEBAIC0xNjI4LDcgKzE2
MjgsNyBAQCBzdGF0aWMgaW50IF9pbnRlbF9oZGNwMl9kaXNhYmxlKHN0cnVjdCBpbnRlbF9jb25u
ZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgc3RhdGljIGludCBpbnRlbF9oZGNwMl9jaGVja19saW5r
KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgewo+ID4gICAJc3RydWN0
IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBjb25uX3RvX2RpZ19wb3J0KGNv
bm5lY3Rvcik7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9o
ZGNwICpoZGNwID0gJmNvbm5lY3Rvci0+aGRjcDsKPiA+ICAgCWVudW0gcG9ydCBwb3J0ID0gY29u
bmVjdG9yLT5lbmNvZGVyLT5wb3J0Owo+ID4gICAJaW50IHJldCA9IDA7Cj4gPiBAQCAtMTcyMSwx
MyArMTcyMSwxMyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9oZGNwX2NoZWNrX3dvcmsoc3RydWN0IHdv
cmtfc3RydWN0ICp3b3JrKQo+ID4gICBzdGF0aWMgaW50IGk5MTVfaGRjcF9jb21wb25lbnRfYmlu
ZChzdHJ1Y3QgZGV2aWNlICppOTE1X2tkZXYsCj4gPiAgIAkJCQkgICAgc3RydWN0IGRldmljZSAq
bWVpX2tkZXYsIHZvaWQgKmRhdGEpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0ga2Rldl90b19pOTE1KGk5MTVfa2Rldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl90b19pOTE1KGk5MTVfa2Rldik7Cj4gPiAgIAlEUk1f
REVCVUcoIkk5MTUgSERDUCBjb21wIGJpbmRcbiIpOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJp
di0+aGRjcF9jb21wX211dGV4KTsKPiA+IC0JZGV2X3ByaXYtPmhkY3BfbWFzdGVyID0gKHN0cnVj
dCBpOTE1X2hkY3BfY29tcF9tYXN0ZXIgKilkYXRhOwo+ID4gLQlkZXZfcHJpdi0+aGRjcF9tYXN0
ZXItPm1laV9kZXYgPSBtZWlfa2RldjsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRj
cF9jb21wX211dGV4KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsK
PiA+ICsJaTkxNS0+aGRjcF9tYXN0ZXIgPSAoc3RydWN0IGk5MTVfaGRjcF9jb21wX21hc3RlciAq
KWRhdGE7Cj4gPiArCWk5MTUtPmhkY3BfbWFzdGVyLT5tZWlfZGV2ID0gbWVpX2tkZXY7Cj4gPiAr
CW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4KTsKPiA+ICAgCXJldHVybiAwOwo+
ID4gICB9Cj4gPiBAQCAtMTczNSwxMiArMTczNSwxMiBAQCBzdGF0aWMgaW50IGk5MTVfaGRjcF9j
b21wb25lbnRfYmluZChzdHJ1Y3QgZGV2aWNlICppOTE1X2tkZXYsCj4gPiAgIHN0YXRpYyB2b2lk
IGk5MTVfaGRjcF9jb21wb25lbnRfdW5iaW5kKHN0cnVjdCBkZXZpY2UgKmk5MTVfa2RldiwKPiA+
ICAgCQkJCSAgICAgICBzdHJ1Y3QgZGV2aWNlICptZWlfa2Rldiwgdm9pZCAqZGF0YSkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X3RvX2k5MTUo
aTkxNV9rZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBrZGV2X3Rv
X2k5MTUoaTkxNV9rZGV2KTsKPiA+ICAgCURSTV9ERUJVRygiSTkxNSBIRENQIGNvbXAgdW5iaW5k
XG4iKTsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiAt
CWRldl9wcml2LT5oZGNwX21hc3RlciA9IE5VTEw7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9t
dXRleCk7Cj4gPiArCWk5MTUtPmhkY3BfbWFzdGVyID0gTlVMTDsKPiA+ICsJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgY29tcG9uZW50X29wcyBpOTE1X2hkY3BfY29tcG9uZW50X29wcyA9IHsKPiA+IEBAIC0xNzcz
LDM0ICsxNzczLDM0IEBAIHN0YXRpYyBpbmxpbmUgaW50IGluaXRpYWxpemVfaGRjcF9wb3J0X2Rh
dGEoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICAJcmV0dXJuIDA7Cj4g
PiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBpc19oZGNwMl9zdXBwb3J0ZWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBib29sIGlzX2hkY3AyX3N1cHBvcnRlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJaWYgKCFJU19FTkFC
TEVEKENPTkZJR19JTlRFTF9NRUlfSERDUCkpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gLQly
ZXR1cm4gKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJp
dikgfHwKPiA+IC0JCUlTX0tBQllMQUtFKGRldl9wcml2KSk7Cj4gPiArCXJldHVybiAoSU5URUxf
R0VOKGk5MTUpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoaTkxNSkgfHwKPiA+ICsJCUlTX0tBQllM
QUtFKGk5MTUpKTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfaGRjcF9jb21wb25lbnRfaW5pdChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9oZGNwX2Nv
bXBvbmVudF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAg
IAlpbnQgcmV0Owo+ID4gLQlpZiAoIWlzX2hkY3AyX3N1cHBvcnRlZChkZXZfcHJpdikpCj4gPiAr
CWlmICghaXNfaGRjcDJfc3VwcG9ydGVkKGk5MTUpKQo+ID4gICAJCXJldHVybjsKPiA+IC0JbXV0
ZXhfbG9jaygmZGV2X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiAtCVdBUk5fT04oZGV2X3By
aXYtPmhkY3BfY29tcF9hZGRlZCk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9t
dXRleCk7Cj4gPiArCVdBUk5fT04oaTkxNS0+aGRjcF9jb21wX2FkZGVkKTsKPiA+IC0JZGV2X3By
aXYtPmhkY3BfY29tcF9hZGRlZCA9IHRydWU7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYt
PmhkY3BfY29tcF9tdXRleCk7Cj4gPiAtCXJldCA9IGNvbXBvbmVudF9hZGRfdHlwZWQoZGV2X3By
aXYtPmRybS5kZXYsICZpOTE1X2hkY3BfY29tcG9uZW50X29wcywKPiA+ICsJaTkxNS0+aGRjcF9j
b21wX2FkZGVkID0gdHJ1ZTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5oZGNwX2NvbXBfbXV0
ZXgpOwo+ID4gKwlyZXQgPSBjb21wb25lbnRfYWRkX3R5cGVkKGk5MTUtPmRybS5kZXYsICZpOTE1
X2hkY3BfY29tcG9uZW50X29wcywKPiA+ICAgCQkJCSAgSTkxNV9DT01QT05FTlRfSERDUCk7Cj4g
PiAgIAlpZiAocmV0IDwgMCkgewo+ID4gICAJCURSTV9ERUJVR19LTVMoIkZhaWxlZCBhdCBjb21w
b25lbnQgYWRkKCVkKVxuIiwgcmV0KTsKPiA+IC0JCW11dGV4X2xvY2soJmRldl9wcml2LT5oZGNw
X2NvbXBfbXV0ZXgpOwo+ID4gLQkJZGV2X3ByaXYtPmhkY3BfY29tcF9hZGRlZCA9IGZhbHNlOwo+
ID4gLQkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+aGRjcF9jb21wX211dGV4KTsKPiA+ICsJCW11
dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiArCQlpOTE1LT5oZGNwX2NvbXBf
YWRkZWQgPSBmYWxzZTsKPiA+ICsJCW11dGV4X3VubG9jaygmaTkxNS0+aGRjcF9jb21wX211dGV4
KTsKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IEBAIC0xODIyLDcgKzE4MjIs
NyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9oZGNwMl9pbml0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmNvbm5lY3RvcikKPiA+ICAgaW50IGludGVsX2hkY3BfaW5pdChzdHJ1Y3QgaW50ZWxfY29ubmVj
dG9yICpjb25uZWN0b3IsCj4gPiAgIAkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9oZGNwX3NoaW0g
KnNoaW0pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGlu
dGVsX2hkY3AgKmhkY3AgPSAmY29ubmVjdG9yLT5oZGNwOwo+ID4gICAJaW50IHJldDsKPiA+IEBA
IC0xODM4LDcgKzE4MzgsNyBAQCBpbnQgaW50ZWxfaGRjcF9pbml0KHN0cnVjdCBpbnRlbF9jb25u
ZWN0b3IgKmNvbm5lY3RvciwKPiA+ICAgCUlOSVRfREVMQVlFRF9XT1JLKCZoZGNwLT5jaGVja193
b3JrLCBpbnRlbF9oZGNwX2NoZWNrX3dvcmspOwo+ID4gICAJSU5JVF9XT1JLKCZoZGNwLT5wcm9w
X3dvcmssIGludGVsX2hkY3BfcHJvcF93b3JrKTsKPiA+IC0JaWYgKGlzX2hkY3AyX3N1cHBvcnRl
ZChkZXZfcHJpdikpCj4gPiArCWlmIChpc19oZGNwMl9zdXBwb3J0ZWQoaTkxNSkpCj4gPiAgIAkJ
aW50ZWxfaGRjcDJfaW5pdChjb25uZWN0b3IpOwo+ID4gICAJaW5pdF93YWl0cXVldWVfaGVhZCgm
aGRjcC0+Y3BfaXJxX3F1ZXVlKTsKPiA+IEBAIC0xOTA1LDE4ICsxOTA1LDE4IEBAIGludCBpbnRl
bF9oZGNwX2Rpc2FibGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICAJ
cmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfaGRjcF9jb21wb25lbnRfZmluaShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9oZGNwX2Nv
bXBvbmVudF9maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAt
CW11dGV4X2xvY2soJmRldl9wcml2LT5oZGNwX2NvbXBfbXV0ZXgpOwo+ID4gLQlpZiAoIWRldl9w
cml2LT5oZGNwX2NvbXBfYWRkZWQpIHsKPiA+IC0JCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmhk
Y3BfY29tcF9tdXRleCk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7
Cj4gPiArCWlmICghaTkxNS0+aGRjcF9jb21wX2FkZGVkKSB7Cj4gPiArCQltdXRleF91bmxvY2so
Jmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJfQo+ID4gLQlk
ZXZfcHJpdi0+aGRjcF9jb21wX2FkZGVkID0gZmFsc2U7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2
X3ByaXYtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiArCWk5MTUtPmhkY3BfY29tcF9hZGRlZCA9IGZh
bHNlOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmhkY3BfY29tcF9tdXRleCk7Cj4gPiAtCWNv
bXBvbmVudF9kZWwoZGV2X3ByaXYtPmRybS5kZXYsICZpOTE1X2hkY3BfY29tcG9uZW50X29wcyk7
Cj4gPiArCWNvbXBvbmVudF9kZWwoaTkxNS0+ZHJtLmRldiwgJmk5MTVfaGRjcF9jb21wb25lbnRf
b3BzKTsKPiA+ICAgfQo+ID4gICB2b2lkIGludGVsX2hkY3BfY2xlYW51cChzdHJ1Y3QgaW50ZWxf
Y29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfaGRjcC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaGRjcC5oCj4gPiBp
bmRleCBiZThkYTg1Yzg2NmEuLjI0MDc5ZGRhMWFjNCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2hkY3AuaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfaGRjcC5oCj4gPiBAQCAtMjMsMTEgKzIzLDExIEBAIGludCBpbnRlbF9oZGNwX2luaXQo
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ID4gICAJCSAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfaGRjcF9zaGltICpoZGNwX3NoaW0pOwo+ID4gICBpbnQgaW50ZWxfaGRjcF9lbmFi
bGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKTsKPiA+ICAgaW50IGludGVsX2hk
Y3BfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpOwo+ID4gLWJvb2wg
aXNfaGRjcF9zdXBwb3J0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVt
IHBvcnQgcG9ydCk7Cj4gPiArYm9vbCBpc19oZGNwX3N1cHBvcnRlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0IHBvcnQpOwo+ID4gICBib29sIGludGVsX2hkY3BfY2Fw
YWJsZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpOwo+ID4gICBib29sIGludGVs
X2hkY3AyX2NhcGFibGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKTsKPiA+IC12
b2lkIGludGVsX2hkY3BfY29tcG9uZW50X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKPiA+IC12b2lkIGludGVsX2hkY3BfY29tcG9uZW50X2Zpbmkoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICt2b2lkIGludGVsX2hkY3BfY29tcG9uZW50X2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfaGRjcF9j
b21wb25lbnRfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIHZvaWQg
aW50ZWxfaGRjcF9jbGVhbnVwKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3Rvcik7Cj4g
PiAgIHZvaWQgaW50ZWxfaGRjcF9oYW5kbGVfY3BfaXJxKHN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmNvbm5lY3Rvcik7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
aGRtaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaGRtaS5jCj4gPiBpbmRleCAxODdh
MmI4MjhiOTcuLmM1YmU0MWJhMzZkYSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2hkbWkuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaGRt
aS5jCj4gPiBAQCAtNjcsMTcgKzY3LDE3IEBAIHN0YXRpYyB2b2lkCj4gPiAgIGFzc2VydF9oZG1p
X3BvcnRfZGlzYWJsZWQoc3RydWN0IGludGVsX2hkbWkgKmludGVsX2hkbWkpCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBpbnRlbF9oZG1pX3RvX2RldihpbnRlbF9oZG1p
KTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+
ICAgCXUzMiBlbmFibGVkX2JpdHM7Cj4gPiAtCWVuYWJsZWRfYml0cyA9IEhBU19EREkoZGV2X3By
aXYpID8gRERJX0JVRl9DVExfRU5BQkxFIDogU0RWT19FTkFCTEU7Cj4gPiArCWVuYWJsZWRfYml0
cyA9IEhBU19EREkoaTkxNSkgPyBERElfQlVGX0NUTF9FTkFCTEUgOiBTRFZPX0VOQUJMRTsKPiA+
ICAgCVdBUk4oSTkxNV9SRUFEKGludGVsX2hkbWktPmhkbWlfcmVnKSAmIGVuYWJsZWRfYml0cywK
PiA+ICAgCSAgICAgIkhETUkgcG9ydCBlbmFibGVkLCBleHBlY3RpbmcgZGlzYWJsZWRcbiIpOwo+
ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkCj4gPiAtYXNzZXJ0X2hkbWlfdHJhbnNjb2Rlcl9mdW5j
X2Rpc2FibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICthc3NlcnRf
aGRtaV90cmFuc2NvZGVyX2Z1bmNfZGlzYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJCQkgICAgIGVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlcikKPiA+ICAg
ewo+ID4gICAJV0FSTihJOTE1X1JFQUQoVFJBTlNfRERJX0ZVTkNfQ1RMKGNwdV90cmFuc2NvZGVy
KSkgJgo+ID4gQEAgLTE2Myw3ICsxNjMsNyBAQCBzdGF0aWMgdTMyIGhzd19pbmZvZnJhbWVfZW5h
YmxlKHVuc2lnbmVkIGludCB0eXBlKQo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpOTE1X3JlZ190Cj4g
PiAtaHN3X2RpcF9kYXRhX3JlZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiAraHN3X2RpcF9kYXRhX3JlZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkgZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyLAo+ID4gICAJCSB1bnNpZ25lZCBpbnQg
dHlwZSwKPiA+ICAgCQkgaW50IGkpCj4gPiBAQCAtMjA3LDcgKzIwNyw3IEBAIHN0YXRpYyB2b2lk
IGc0eF93cml0ZV9pbmZvZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAg
IAkJCQljb25zdCB2b2lkICpmcmFtZSwgc3NpemVfdCBsZW4pCj4gPiAgIHsKPiA+ICAgCWNvbnN0
IHUzMiAqZGF0YSA9IGZyYW1lOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXUzMiB2YWwg
PSBJOTE1X1JFQUQoVklERU9fRElQX0NUTCk7Cj4gPiAgIAlpbnQgaTsKPiA+IEBAIC0yNDEsNyAr
MjQxLDcgQEAgc3RhdGljIHZvaWQgZzR4X3JlYWRfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+ID4gICAJCQkgICAgICAgdW5zaWduZWQgaW50IHR5cGUsCj4gPiAgIAkJ
CSAgICAgICB2b2lkICpmcmFtZSwgc3NpemVfdCBsZW4pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gPiAgIAl1MzIgdmFsLCAqZGF0YSA9IGZyYW1lOwo+ID4gICAJaW50IGk7Cj4gPiBA
QCAtMjU5LDcgKzI1OSw3IEBAIHN0YXRpYyB2b2lkIGc0eF9yZWFkX2luZm9mcmFtZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIHUzMiBnNHhfaW5mb2ZyYW1lc19l
bmFibGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJICBjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKFZJREVPX0RJUF9DVEwpOwo+ID4g
ICAJaWYgKCh2YWwgJiBWSURFT19ESVBfRU5BQkxFKSA9PSAwKQo+ID4gQEAgLTI3OCw3ICsyNzgs
NyBAQCBzdGF0aWMgdm9pZCBpYnhfd3JpdGVfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ID4gICAJCQkJY29uc3Qgdm9pZCAqZnJhbWUsIHNzaXplX3QgbGVuKQo+ID4g
ICB7Cj4gPiAgIAljb25zdCB1MzIgKmRhdGEgPSBmcmFtZTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCWk5MTVfcmVnX3QgcmVnID0gVFZJREVPX0RJUF9D
VEwoaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4g
PiBAQCAtMzE0LDcgKzMxNCw3IEBAIHN0YXRpYyB2b2lkIGlieF9yZWFkX2luZm9mcmFtZShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgICAgIHVuc2lnbmVkIGludCB0
eXBlLAo+ID4gICAJCQkgICAgICAgdm9pZCAqZnJhbWUsIHNzaXplX3QgbGVuKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAgIAl1MzIgdmFsLCAqZGF0YSA9
IGZyYW1lOwo+ID4gICAJaW50IGk7Cj4gPiBAQCAtMzMzLDcgKzMzMyw3IEBAIHN0YXRpYyB2b2lk
IGlieF9yZWFkX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAg
c3RhdGljIHUzMiBpYnhfaW5mb2ZyYW1lc19lbmFibGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ID4gICAJCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9j
b25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBpcGUgcGlw
ZSA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0YyktPnBpcGU7Cj4gPiAgIAlp
OTE1X3JlZ190IHJlZyA9IFRWSURFT19ESVBfQ1RMKHBpcGUpOwo+ID4gICAJdTMyIHZhbCA9IEk5
MTVfUkVBRChyZWcpOwo+ID4gQEAgLTM1NSw3ICszNTUsNyBAQCBzdGF0aWMgdm9pZCBjcHRfd3Jp
dGVfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJY29u
c3Qgdm9pZCAqZnJhbWUsIHNzaXplX3QgbGVuKQo+ID4gICB7Cj4gPiAgIAljb25zdCB1MzIgKmRh
dGEgPSBmcmFtZTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0
YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+
ICAgCWk5MTVfcmVnX3QgcmVnID0gVFZJREVPX0RJUF9DVEwoaW50ZWxfY3J0Yy0+cGlwZSk7Cj4g
PiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4gPiBAQCAtMzk0LDcgKzM5NCw3IEBAIHN0
YXRpYyB2b2lkIGNwdF9yZWFkX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiA+ICAgCQkJICAgICAgIHVuc2lnbmVkIGludCB0eXBlLAo+ID4gICAJCQkgICAgICAgdm9p
ZCAqZnJhbWUsIHNzaXplX3QgbGVuKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4g
ICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gPiAgIAl1MzIgdmFsLCAqZGF0YSA9IGZyYW1lOwo+ID4gICAJaW50IGk7Cj4g
PiBAQCAtNDEzLDcgKzQxMyw3IEBAIHN0YXRpYyB2b2lkIGNwdF9yZWFkX2luZm9mcmFtZShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIHUzMiBjcHRfaW5mb2ZyYW1l
c19lbmFibGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJICBjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVy
LT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IHRvX2ludGVsX2NydGMocGlwZV9j
b25maWctPmJhc2UuY3J0YyktPnBpcGU7Cj4gPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKFRWSURF
T19ESVBfQ1RMKHBpcGUpKTsKPiA+IEBAIC00MzEsNyArNDMxLDcgQEAgc3RhdGljIHZvaWQgdmx2
X3dyaXRlX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJ
CWNvbnN0IHZvaWQgKmZyYW1lLCBzc2l6ZV90IGxlbikKPiA+ICAgewo+ID4gICAJY29uc3QgdTMy
ICpkYXRhID0gZnJhbWU7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVs
X2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gPiAgIAlpOTE1X3JlZ190IHJlZyA9IFZMVl9UVklERU9fRElQX0NUTChpbnRlbF9jcnRjLT5w
aXBlKTsKPiA+ICAgCXUzMiB2YWwgPSBJOTE1X1JFQUQocmVnKTsKPiA+IEBAIC00NjcsNyArNDY3
LDcgQEAgc3RhdGljIHZvaWQgdmx2X3JlYWRfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAo+ID4gICAJCQkgICAgICAgdW5zaWduZWQgaW50IHR5cGUsCj4gPiAgIAkJCSAg
ICAgICB2b2lkICpmcmFtZSwgc3NpemVfdCBsZW4pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19z
dGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCXUzMiB2YWwsICpkYXRhID0gZnJhbWU7Cj4gPiAgIAlp
bnQgaTsKPiA+IEBAIC00ODYsNyArNDg2LDcgQEAgc3RhdGljIHZvaWQgdmx2X3JlYWRfaW5mb2Zy
YW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICBzdGF0aWMgdTMyIHZsdl9p
bmZvZnJhbWVzX2VuYWJsZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJ
CQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0
YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKS0+cGlwZTsKPiA+ICAgCXUzMiB2YWwgPSBJOTE1X1JF
QUQoVkxWX1RWSURFT19ESVBfQ1RMKHBpcGUpKTsKPiA+IEBAIC01MDcsNyArNTA3LDcgQEAgc3Rh
dGljIHZvaWQgaHN3X3dyaXRlX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiA+ICAgCQkJCWNvbnN0IHZvaWQgKmZyYW1lLCBzc2l6ZV90IGxlbikKPiA+ICAgewo+ID4g
ICAJY29uc3QgdTMyICpkYXRhID0gZnJhbWU7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJ
ZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29k
ZXI7Cj4gPiAgIAlpOTE1X3JlZ190IGN0bF9yZWcgPSBIU1dfVFZJREVPX0RJUF9DVEwoY3B1X3Ry
YW5zY29kZXIpOwo+ID4gICAJaW50IGRhdGFfc2l6ZTsKPiA+IEBAIC01MjAsMTMgKzUyMCwxMyBA
QCBzdGF0aWMgdm9pZCBoc3dfd3JpdGVfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ID4gICAJSTkxNV9XUklURShjdGxfcmVnLCB2YWwpOwo+ID4gICAJZm9yIChpID0g
MDsgaSA8IGxlbjsgaSArPSA0KSB7Cj4gPiAtCQlJOTE1X1dSSVRFKGhzd19kaXBfZGF0YV9yZWco
ZGV2X3ByaXYsIGNwdV90cmFuc2NvZGVyLAo+ID4gKwkJSTkxNV9XUklURShoc3dfZGlwX2RhdGFf
cmVnKGk5MTUsIGNwdV90cmFuc2NvZGVyLAo+ID4gICAJCQkJCSAgICB0eXBlLCBpID4+IDIpLCAq
ZGF0YSk7Cj4gPiAgIAkJZGF0YSsrOwo+ID4gICAJfQo+ID4gICAJLyogV3JpdGUgZXZlcnkgcG9z
c2libGUgZGF0YSBieXRlIHRvIGZvcmNlIGNvcnJlY3QgRUNDIGNhbGN1bGF0aW9uLiAqLwo+ID4g
ICAJZm9yICg7IGkgPCBkYXRhX3NpemU7IGkgKz0gNCkKPiA+IC0JCUk5MTVfV1JJVEUoaHN3X2Rp
cF9kYXRhX3JlZyhkZXZfcHJpdiwgY3B1X3RyYW5zY29kZXIsCj4gPiArCQlJOTE1X1dSSVRFKGhz
d19kaXBfZGF0YV9yZWcoaTkxNSwgY3B1X3RyYW5zY29kZXIsCj4gPiAgIAkJCQkJICAgIHR5cGUs
IGkgPj4gMiksIDApOwo+ID4gICAJdmFsIHw9IGhzd19pbmZvZnJhbWVfZW5hYmxlKHR5cGUpOwo+
ID4gQEAgLTUzOSw3ICs1MzksNyBAQCBzdGF0aWMgdm9pZCBoc3dfcmVhZF9pbmZvZnJhbWUoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgICAgICB1bnNpZ25lZCBpbnQg
dHlwZSwKPiA+ICAgCQkJICAgICAgIHZvaWQgKmZyYW1lLCBzc2l6ZV90IGxlbikKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2Rl
ciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+ID4gICAJdTMyIHZhbCwgKmRhdGEgPSBm
cmFtZTsKPiA+ICAgCWludCBpOwo+ID4gQEAgLTU0NywxNCArNTQ3LDE0IEBAIHN0YXRpYyB2b2lk
IGhzd19yZWFkX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAg
CXZhbCA9IEk5MTVfUkVBRChIU1dfVFZJREVPX0RJUF9DVEwoY3B1X3RyYW5zY29kZXIpKTsKPiA+
ICAgCWZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkKPiA+IC0JCSpkYXRhKysgPSBJOTE1X1JF
QUQoaHN3X2RpcF9kYXRhX3JlZyhkZXZfcHJpdiwgY3B1X3RyYW5zY29kZXIsCj4gPiArCQkqZGF0
YSsrID0gSTkxNV9SRUFEKGhzd19kaXBfZGF0YV9yZWcoaTkxNSwgY3B1X3RyYW5zY29kZXIsCj4g
PiAgIAkJCQkJCSAgICAgdHlwZSwgaSA+PiAyKSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHUzMiBo
c3dfaW5mb2ZyYW1lc19lbmFibGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4g
ICAJCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKEhTV19U
VklERU9fRElQX0NUTChwaXBlX2NvbmZpZy0+Y3B1X3RyYW5zY29kZXIpKTsKPiA+ICAgCXUzMiBt
YXNrOwo+ID4gQEAgLTU2Miw3ICs1NjIsNyBAQCBzdGF0aWMgdTMyIGhzd19pbmZvZnJhbWVzX2Vu
YWJsZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJVklERU9fRElQX0VO
QUJMRV9HQ1BfSFNXIHwgVklERU9fRElQX0VOQUJMRV9WU19IU1cgfAo+ID4gICAJCVZJREVPX0RJ
UF9FTkFCTEVfR01QX0hTVyB8IFZJREVPX0RJUF9FTkFCTEVfU1BEX0hTVyk7Cj4gPiAtCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+ID4g
KwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoaTkxNSkpCj4gPiAg
IAkJbWFzayB8PSBWSURFT19ESVBfRU5BQkxFX0RSTV9HTEs7Cj4gPiAgIAlyZXR1cm4gdmFsICYg
bWFzazsKPiA+IEBAIC01OTMsNyArNTkzLDcgQEAgdTMyIGludGVsX2hkbWlfaW5mb2ZyYW1lX2Vu
YWJsZSh1bnNpZ25lZCBpbnQgdHlwZSkKPiA+ICAgdTMyIGludGVsX2hkbWlfaW5mb2ZyYW1lc19l
bmFibGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJICBjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0gZW5j
X3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCXUzMiB2YWwsIHJldCA9IDA7Cj4g
PiAgIAlpbnQgaTsKPiA+IEBAIC02MDQsNyArNjA0LDcgQEAgdTMyIGludGVsX2hkbWlfaW5mb2Zy
YW1lc19lbmFibGVkKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJZm9yIChp
ID0gMDsgaSA8IEFSUkFZX1NJWkUoaW5mb2ZyYW1lX3R5cGVfdG9faWR4KTsgaSsrKSB7Cj4gPiAg
IAkJdW5zaWduZWQgaW50IHR5cGUgPSBpbmZvZnJhbWVfdHlwZV90b19pZHhbaV07Cj4gPiAtCQlp
ZiAoSEFTX0RESShkZXZfcHJpdikpIHsKPiA+ICsJCWlmIChIQVNfRERJKGk5MTUpKSB7Cj4gPiAg
IAkJCWlmICh2YWwgJiBoc3dfaW5mb2ZyYW1lX2VuYWJsZSh0eXBlKSkKPiA+ICAgCQkJCXJldCB8
PSBCSVQoaSk7Cj4gPiAgIAkJfSBlbHNlIHsKPiA+IEBAIC04MDQsMTAgKzgwNCwxMCBAQCBpbnRl
bF9oZG1pX2NvbXB1dGVfZHJtX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiA+ICAgCQkJCSBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+
ICAgewo+ID4gICAJc3RydWN0IGhkbWlfZHJtX2luZm9mcmFtZSAqZnJhbWUgPSAmY3J0Y19zdGF0
ZS0+aW5mb2ZyYW1lcy5kcm0uZHJtOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWludCBy
ZXQ7Cj4gPiAtCWlmICghKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFL
RShkZXZfcHJpdikpKQo+ID4gKwlpZiAoIShJTlRFTF9HRU4oaTkxNSkgPj0gMTAgfHwgSVNfR0VN
SU5JTEFLRShpOTE1KSkpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAgIAlpZiAoIWNydGNfc3Rh
dGUtPmhhc19pbmZvZnJhbWUpCj4gPiBAQCAtODM3LDcgKzgzNyw3IEBAIHN0YXRpYyB2b2lkIGc0
eF9zZXRfaW5mb2ZyYW1lcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJ
ICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJ
CQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4g
PiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9w
b3J0ICppbnRlbF9kaWdfcG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9ICZpbnRlbF9kaWdfcG9ydC0+aGRt
aTsKPiA+ICAgCWk5MTVfcmVnX3QgcmVnID0gVklERU9fRElQX0NUTDsKPiA+IEBAIC05NDcsNyAr
OTQ3LDcgQEAgc3RhdGljIGJvb2wgaW50ZWxfaGRtaV9zZXRfZ2NwX2luZm9mcmFtZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCQkgY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVj
dG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4g
ICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gPiAgIAlpOTE1X3JlZ190IHJlZzsKPiA+IEBAIC05NTUsMTEgKzk1NSwxMSBA
QCBzdGF0aWMgYm9vbCBpbnRlbF9oZG1pX3NldF9nY3BfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ID4gICAJICAgICBpbnRlbF9oZG1pX2luZm9mcmFtZV9lbmFibGUo
SERNSV9QQUNLRVRfVFlQRV9HRU5FUkFMX0NPTlRST0wpKSA9PSAwKQo+ID4gICAJCXJldHVybiBm
YWxzZTsKPiA+IC0JaWYgKEhBU19EREkoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFTX0RESShpOTE1
KSkKPiA+ICAgCQlyZWcgPSBIU1dfVFZJREVPX0RJUF9HQ1AoY3J0Y19zdGF0ZS0+Y3B1X3RyYW5z
Y29kZXIpOwo+ID4gLQllbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVS
UllWSUVXKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJ
U19DSEVSUllWSUVXKGk5MTUpKQo+ID4gICAJCXJlZyA9IFZMVl9UVklERU9fRElQX0dDUChjcnRj
LT5waXBlKTsKPiA+IC0JZWxzZSBpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpCj4gPiArCWVs
c2UgaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpCj4gPiAgIAkJcmVnID0gVFZJREVPX0RJUF9HQ1Ao
Y3J0Yy0+cGlwZSk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTk3
Miw3ICs5NzIsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9oZG1pX3NldF9nY3BfaW5mb2ZyYW1lKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICB2b2lkIGludGVsX2hkbWlfcmVhZF9n
Y3BfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJICAg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCWk5MTVfcmVnX3QgcmVnOwo+ID4gQEAgLTk4
MCwxMSArOTgwLDExIEBAIHZvaWQgaW50ZWxfaGRtaV9yZWFkX2djcF9pbmZvZnJhbWUoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkgICAgIGludGVsX2hkbWlfaW5mb2ZyYW1l
X2VuYWJsZShIRE1JX1BBQ0tFVF9UWVBFX0dFTkVSQUxfQ09OVFJPTCkpID09IDApCj4gPiAgIAkJ
cmV0dXJuOwo+ID4gLQlpZiAoSEFTX0RESShkZXZfcHJpdikpCj4gPiArCWlmIChIQVNfRERJKGk5
MTUpKQo+ID4gICAJCXJlZyA9IEhTV19UVklERU9fRElQX0dDUChjcnRjX3N0YXRlLT5jcHVfdHJh
bnNjb2Rlcik7Cj4gPiAtCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NI
RVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8
IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiAgIAkJcmVnID0gVkxWX1RWSURFT19ESVBfR0NQKGNy
dGMtPnBpcGUpOwo+ID4gLQllbHNlIGlmIChIQVNfUENIX1NQTElUKGRldl9wcml2KSkKPiA+ICsJ
ZWxzZSBpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkKPiA+ICAgCQlyZWcgPSBUVklERU9fRElQX0dD
UChjcnRjLT5waXBlKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlyZXR1cm47Cj4gPiBAQCAtOTk2LDkg
Kzk5Niw5IEBAIHN0YXRpYyB2b2lkIGludGVsX2hkbWlfY29tcHV0ZV9nY3BfaW5mb2ZyYW1lKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJCSAgICAgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQkJICAgICBzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+
IC0JaWYgKElTX0c0WChkZXZfcHJpdikgfHwgIWNydGNfc3RhdGUtPmhhc19pbmZvZnJhbWUpCj4g
PiArCWlmIChJU19HNFgoaTkxNSkgfHwgIWNydGNfc3RhdGUtPmhhc19pbmZvZnJhbWUpCj4gPiAg
IAkJcmV0dXJuOwo+ID4gICAJY3J0Y19zdGF0ZS0+aW5mb2ZyYW1lcy5lbmFibGUgfD0KPiA+IEBA
IC0xMDE5LDcgKzEwMTksNyBAQCBzdGF0aWMgdm9pZCBpYnhfc2V0X2luZm9mcmFtZXMoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBk
cm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICppbnRlbF9kaWdfcG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9ICZpbnRlbF9kaWdfcG9ydC0+aGRtaTsK
PiA+IEBAIC0xMDc4LDcgKzEwNzgsNyBAQCBzdGF0aWMgdm9pZCBjcHRfc2V0X2luZm9mcmFtZXMo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJICAgICAgIGNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfaGRtaSAq
aW50ZWxfaGRtaSA9IGVuY190b19pbnRlbF9oZG1pKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWk5
MTVfcmVnX3QgcmVnID0gVFZJREVPX0RJUF9DVEwoaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gPiBAQCAt
MTEyNyw3ICsxMTI3LDcgQEAgc3RhdGljIHZvaWQgdmx2X3NldF9pbmZvZnJhbWVzKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gICAJc3RydWN0IGludGVsX2hkbWkgKmludGVsX2hk
bWkgPSBlbmNfdG9faW50ZWxfaGRtaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAlpOTE1X3JlZ190
IHJlZyA9IFZMVl9UVklERU9fRElQX0NUTChpbnRlbF9jcnRjLT5waXBlKTsKPiA+IEBAIC0xMTg1
LDExICsxMTg1LDExIEBAIHN0YXRpYyB2b2lkIGhzd19zZXRfaW5mb2ZyYW1lcyhzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9j
b25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiAgIAlpOTE1X3JlZ190IHJlZyA9IEhTV19UVklERU9fRElQX0NUTChjcnRjX3N0YXRlLT5j
cHVfdHJhbnNjb2Rlcik7Cj4gPiAgIAl1MzIgdmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4gPiAtCWFz
c2VydF9oZG1pX3RyYW5zY29kZXJfZnVuY19kaXNhYmxlZChkZXZfcHJpdiwKPiA+ICsJYXNzZXJ0
X2hkbWlfdHJhbnNjb2Rlcl9mdW5jX2Rpc2FibGVkKGk5MTUsCj4gPiAgIAkJCQkJICAgICBjcnRj
X3N0YXRlLT5jcHVfdHJhbnNjb2Rlcik7Cj4gPiAgIAl2YWwgJj0gfihWSURFT19ESVBfRU5BQkxF
X1ZTQ19IU1cgfCBWSURFT19ESVBfRU5BQkxFX0FWSV9IU1cgfAo+ID4gQEAgLTEyMjUsOSArMTIy
NSw5IEBAIHN0YXRpYyB2b2lkIGhzd19zZXRfaW5mb2ZyYW1lcyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiA+ICAgdm9pZCBpbnRlbF9kcF9kdWFsX21vZGVfc2V0X3RtZHNfb3V0cHV0
KHN0cnVjdCBpbnRlbF9oZG1pICpoZG1pLCBib29sIGVuYWJsZSkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2hkbWlfdG9fZGV2
KGhkbWkpKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGlu
dGVsX2hkbWlfdG9fZGV2KGhkbWkpKTsKPiA+ICAgCXN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRl
ciA9Cj4gPiAtCQlpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihkZXZfcHJpdiwgaGRtaS0+ZGRjX2J1
cyk7Cj4gPiArCQlpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihpOTE1LCBoZG1pLT5kZGNfYnVzKTsK
PiA+ICAgCWlmIChoZG1pLT5kcF9kdWFsX21vZGUudHlwZSA8IERSTV9EUF9EVUFMX01PREVfVFlQ
RTJfRFZJKQo+ID4gICAJCXJldHVybjsKPiA+IEBAIC0xMjQzLDkgKzEyNDMsOSBAQCBzdGF0aWMg
aW50IGludGVsX2hkbWlfaGRjcF9yZWFkKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVs
X2RpZ19wb3J0LAo+ID4gICAJCQkJdW5zaWduZWQgaW50IG9mZnNldCwgdm9pZCAqYnVmZmVyLCBz
aXplX3Qgc2l6ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2hkbWkgKmhkbWkgPSAmaW50
ZWxfZGlnX3BvcnQtPmhkbWk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0KPiA+ICAgCQlpbnRlbF9k
aWdfcG9ydC0+YmFzZS5iYXNlLmRldi0+ZGV2X3ByaXZhdGU7Cj4gPiAtCXN0cnVjdCBpMmNfYWRh
cHRlciAqYWRhcHRlciA9IGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGRldl9wcml2LAo+ID4gKwlz
dHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIgPSBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihpOTE1
LAo+ID4gICAJCQkJCQkJICAgICAgaGRtaS0+ZGRjX2J1cyk7Cj4gPiAgIAlpbnQgcmV0Owo+ID4g
ICAJdTggc3RhcnQgPSBvZmZzZXQgJiAweGZmOwo+ID4gQEAgLTEyNzMsOSArMTI3Myw5IEBAIHN0
YXRpYyBpbnQgaW50ZWxfaGRtaV9oZGNwX3dyaXRlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmludGVsX2RpZ19wb3J0LAo+ID4gICAJCQkJIHVuc2lnbmVkIGludCBvZmZzZXQsIHZvaWQgKmJ1
ZmZlciwgc2l6ZV90IHNpemUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICpoZG1p
ID0gJmludGVsX2RpZ19wb3J0LT5oZG1pOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gPiAgIAkJ
aW50ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYtPmRldl9wcml2YXRlOwo+ID4gLQlzdHJ1Y3Qg
aTJjX2FkYXB0ZXIgKmFkYXB0ZXIgPSBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihkZXZfcHJpdiwK
PiA+ICsJc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0gaW50ZWxfZ21idXNfZ2V0X2FkYXB0
ZXIoaTkxNSwKPiA+ICAgCQkJCQkJCSAgICAgIGhkbWktPmRkY19idXMpOwo+ID4gICAJaW50IHJl
dDsKPiA+ICAgCXU4ICp3cml0ZV9idWY7Cj4gPiBAQCAtMTMwOCw5ICsxMzA4LDkgQEAgaW50IGlu
dGVsX2hkbWlfaGRjcF93cml0ZV9hbl9ha3N2KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmlu
dGVsX2RpZ19wb3J0LAo+ID4gICAJCQkJICB1OCAqYW4pCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9oZG1pICpoZG1pID0gJmludGVsX2RpZ19wb3J0LT5oZG1pOwo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9Cj4gPiAgIAkJaW50ZWxfZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYtPmRldl9wcml2YXRl
Owo+ID4gLQlzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIgPSBpbnRlbF9nbWJ1c19nZXRfYWRh
cHRlcihkZXZfcHJpdiwKPiA+ICsJc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyID0gaW50ZWxf
Z21idXNfZ2V0X2FkYXB0ZXIoaTkxNSwKPiA+ICAgCQkJCQkJCSAgICAgIGhkbWktPmRkY19idXMp
Owo+ID4gICAJaW50IHJldDsKPiA+IEBAIC0xNDI4LDcgKzE0MjgsNyBAQCBpbnQgaW50ZWxfaGRt
aV9oZGNwX3JlYWRfdl9wcmltZV9wYXJ0KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVs
X2RpZ19wb3J0LAo+ID4gICBzdGF0aWMgaW50IGtibF9yZXBvc2l0aW9uaW5nX2VuY19lbl9zaWdu
YWwoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0
b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2Rp
Z19wb3J0ID0gY29ubl90b19kaWdfcG9ydChjb25uZWN0b3IpOwo+ID4gICAJc3RydWN0IGRybV9j
cnRjICpjcnRjID0gY29ubmVjdG9yLT5iYXNlLnN0YXRlLT5jcnRjOwo+ID4gICAJc3RydWN0IGlu
dGVsX2NydGMgKmludGVsX2NydGMgPSBjb250YWluZXJfb2YoY3J0YywKPiA+IEBAIC0xNDYzLDcg
KzE0NjMsNyBAQCBpbnQgaW50ZWxfaGRtaV9oZGNwX3RvZ2dsZV9zaWduYWxsaW5nKHN0cnVjdCBp
bnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfaGRtaSAqaGRtaSA9ICZpbnRlbF9kaWdfcG9ydC0+aGRtaTsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9IGhkbWktPmF0dGFjaGVkX2Nvbm5lY3RvcjsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3It
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJaW50IHJldDsKPiA+ICAgCWlmICghZW5hYmxl
KQo+ID4gQEAgLTE0ODAsNyArMTQ4MCw3IEBAIGludCBpbnRlbF9oZG1pX2hkY3BfdG9nZ2xlX3Np
Z25hbGxpbmcoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gPiAg
IAkgKiBXQTogVG8gZml4IGluY29ycmVjdCBwb3NpdGlvbmluZyBvZiB0aGUgd2luZG93IG9mCj4g
PiAgIAkgKiBvcHBvcnR1bml0eSBhbmQgZW5jX2VuIHNpZ25hbGxpbmcgaW4gS0FCWUxBS0UuCj4g
PiAgIAkgKi8KPiA+IC0JaWYgKElTX0tBQllMQUtFKGRldl9wcml2KSAmJiBlbmFibGUpCj4gPiAr
CWlmIChJU19LQUJZTEFLRShpOTE1KSAmJiBlbmFibGUpCj4gPiAgIAkJcmV0dXJuIGtibF9yZXBv
c2l0aW9uaW5nX2VuY19lbl9zaWduYWwoY29ubmVjdG9yKTsKPiA+ICAgCXJldHVybiAwOwo+ID4g
QEAgLTE0ODksNyArMTQ4OSw3IEBAIGludCBpbnRlbF9oZG1pX2hkY3BfdG9nZ2xlX3NpZ25hbGxp
bmcoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gPiAgIHN0YXRp
Ywo+ID4gICBib29sIGludGVsX2hkbWlfaGRjcF9jaGVja19saW5rKHN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmludGVsX2RpZ19wb3J0KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0K
PiA+ICAgCQlpbnRlbF9kaWdfcG9ydC0+YmFzZS5iYXNlLmRldi0+ZGV2X3ByaXZhdGU7Cj4gPiAg
IAllbnVtIHBvcnQgcG9ydCA9IGludGVsX2RpZ19wb3J0LT5iYXNlLnBvcnQ7Cj4gPiAgIAlpbnQg
cmV0Owo+ID4gQEAgLTE3MjAsNyArMTcyMCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2hkbWlfcHJl
cGFyZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgICAgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gZW5jb2Rlci0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0gZW5jX3RvX2ludGVsX2hkbWkoJmVuY29kZXIt
PmJhc2UpOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21v
ZGUgPSAmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ID4gQEAgLTE3MjksNyArMTcy
OSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2hkbWlfcHJlcGFyZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiA+ICAgCWludGVsX2RwX2R1YWxfbW9kZV9zZXRfdG1kc19vdXRwdXQoaW50
ZWxfaGRtaSwgdHJ1ZSk7Cj4gPiAgIAloZG1pX3ZhbCA9IFNEVk9fRU5DT0RJTkdfSERNSTsKPiA+
IC0JaWYgKCFIQVNfUENIX1NQTElUKGRldl9wcml2KSAmJiBjcnRjX3N0YXRlLT5saW1pdGVkX2Nv
bG9yX3JhbmdlKQo+ID4gKwlpZiAoIUhBU19QQ0hfU1BMSVQoaTkxNSkgJiYgY3J0Y19zdGF0ZS0+
bGltaXRlZF9jb2xvcl9yYW5nZSkKPiA+ICAgCQloZG1pX3ZhbCB8PSBIRE1JX0NPTE9SX1JBTkdF
XzE2XzIzNTsKPiA+ICAgCWlmIChhZGp1c3RlZF9tb2RlLT5mbGFncyAmIERSTV9NT0RFX0ZMQUdf
UFZTWU5DKQo+ID4gICAJCWhkbWlfdmFsIHw9IFNEVk9fVlNZTkNfQUNUSVZFX0hJR0g7Cj4gPiBA
QCAtMTc0NCw5ICsxNzQ0LDkgQEAgc3RhdGljIHZvaWQgaW50ZWxfaGRtaV9wcmVwYXJlKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJaWYgKGNydGNfc3RhdGUtPmhhc19oZG1p
X3NpbmspCj4gPiAgIAkJaGRtaV92YWwgfD0gSERNSV9NT0RFX1NFTEVDVF9IRE1JOwo+ID4gLQlp
ZiAoSEFTX1BDSF9DUFQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFTX1BDSF9DUFQoaTkxNSkpCj4g
PiAgIAkJaGRtaV92YWwgfD0gU0RWT19QSVBFX1NFTF9DUFQoY3J0Yy0+cGlwZSk7Cj4gPiAtCWVs
c2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19DSEVSUllW
SUVXKGk5MTUpKQo+ID4gICAJCWhkbWlfdmFsIHw9IFNEVk9fUElQRV9TRUxfQ0hWKGNydGMtPnBp
cGUpOwo+ID4gICAJZWxzZQo+ID4gICAJCWhkbWlfdmFsIHw9IFNEVk9fUElQRV9TRUwoY3J0Yy0+
cGlwZSk7Cj4gPiBAQCAtMTc1OCwxOSArMTc1OCwxOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9oZG1p
X3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIHN0YXRpYyBib29s
IGludGVsX2hkbWlfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ID4gICAJCQkJICAgIGVudW0gcGlwZSAqcGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0gZW5jX3RvX2ludGVsX2hk
bWkoJmVuY29kZXItPmJhc2UpOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAg
IAlib29sIHJldDsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2Vu
YWJsZWQoZGV2X3ByaXYsCj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9p
Zl9lbmFibGVkKGk5MTUsCj4gPiAgIAkJCQkJCSAgICAgZW5jb2Rlci0+cG93ZXJfZG9tYWluKTsK
PiA+ICAgCWlmICghd2FrZXJlZikKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAtCXJldCA9IGlu
dGVsX3Nkdm9fcG9ydF9lbmFibGVkKGRldl9wcml2LCBpbnRlbF9oZG1pLT5oZG1pX3JlZywgcGlw
ZSk7Cj4gPiArCXJldCA9IGludGVsX3Nkdm9fcG9ydF9lbmFibGVkKGk5MTUsIGludGVsX2hkbWkt
PmhkbWlfcmVnLCBwaXBlKTsKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYs
IGVuY29kZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiArCWludGVsX2Rpc3BsYXlfcG93
ZXJfcHV0KGk5MTUsIGVuY29kZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1
cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtMTc4MCw3ICsxNzgwLDcgQEAgc3RhdGljIHZvaWQgaW50
ZWxfaGRtaV9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICB7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9IGVuY190b19pbnRlbF9oZG1p
KCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBlbmNvZGVy
LT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGV2KTsKPiA+ICAgCXUzMiB0bXAsIGZsYWdzID0gMDsKPiA+ICAgCWludCBkb3RjbG9jazsKPiA+
IEBAIC0xODEwLDcgKzE4MTAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9oZG1pX2dldF9jb25maWco
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAlpZiAodG1wICYgSERNSV9BVURJ
T19FTkFCTEUpCj4gPiAgIAkJcGlwZV9jb25maWctPmhhc19hdWRpbyA9IHRydWU7Cj4gPiAtCWlm
ICghSEFTX1BDSF9TUExJVChkZXZfcHJpdikgJiYKPiA+ICsJaWYgKCFIQVNfUENIX1NQTElUKGk5
MTUpICYmCj4gPiAgIAkgICAgdG1wICYgSERNSV9DT0xPUl9SQU5HRV8xNl8yMzUpCj4gPiAgIAkJ
cGlwZV9jb25maWctPmxpbWl0ZWRfY29sb3JfcmFuZ2UgPSB0cnVlOwo+ID4gQEAgLTE4NTgsNyAr
MTg1OCw3IEBAIHN0YXRpYyB2b2lkIGc0eF9lbmFibGVfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiA+ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRl
ICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gZW5j
b2Rlci0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9IGVuY190b19p
bnRlbF9oZG1pKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCXUzMiB0ZW1wOwo+ID4gQEAgLTE4ODAs
NyArMTg4MCw3IEBAIHN0YXRpYyB2b2lkIGlieF9lbmFibGVfaGRtaShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0
YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0g
ZW5jb2Rlci0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9IGVuY190
b19pbnRlbF9oZG1pKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCXUzMiB0ZW1wOwo+ID4gQEAgLTE5
MzAsNyArMTkzMCw3IEBAIHN0YXRpYyB2b2lkIGNwdF9lbmFibGVfaGRtaShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9y
X3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gZW5jb2Rlci0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfaGRtaSAq
aW50ZWxfaGRtaSA9IGVuY190b19pbnRlbF9oZG1pKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWVu
dW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+IEBAIC0xOTkxLDcgKzE5OTEsNyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9kaXNhYmxlX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4gPiAgIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nv
bm5fc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBlbmNvZGVy
LT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0gZW5jX3RvX2ludGVs
X2hkbWkoJmVuY29kZXItPmJhc2UpOwo+ID4gICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAq
aW50ZWxfZGlnX3BvcnQgPQo+ID4gICAJCWhkbWlfdG9fZGlnX3BvcnQoaW50ZWxfaGRtaSk7Cj4g
PiBAQCAtMjAwOSwxMyArMjAwOSwxMyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX2hkbWko
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkgKiB0byB0cmFuc2NvZGVyIEEg
YWZ0ZXIgZGlzYWJsaW5nIGl0IHRvIGFsbG93IHRoZQo+ID4gICAJICogbWF0Y2hpbmcgRFAgcG9y
dCB0byBiZSBlbmFibGVkIG9uIHRyYW5zY29kZXIgQS4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSEFT
X1BDSF9JQlgoZGV2X3ByaXYpICYmIGNydGMtPnBpcGUgPT0gUElQRV9CKSB7Cj4gPiArCWlmIChI
QVNfUENIX0lCWChpOTE1KSAmJiBjcnRjLT5waXBlID09IFBJUEVfQikgewo+ID4gICAJCS8qCj4g
PiAgIAkJICogV2UgZ2V0IENQVS9QQ0ggRklGTyB1bmRlcnJ1bnMgb24gdGhlIG90aGVyIHBpcGUg
d2hlbgo+ID4gICAJCSAqIGRvaW5nIHRoZSB3b3JrYXJvdW5kLiBTd2VlcCB0aGVtIHVuZGVyIHRo
ZSBydWcuCj4gPiAgIAkJICovCj4gPiAtCQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVw
b3J0aW5nKGRldl9wcml2LCBQSVBFX0EsIGZhbHNlKTsKPiA+IC0JCWludGVsX3NldF9wY2hfZmlm
b191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIFBJUEVfQSwgZmFsc2UpOwo+ID4gKwkJaW50
ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhpOTE1LCBQSVBFX0EsIGZhbHNlKTsK
PiA+ICsJCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoaTkxNSwgUElQRV9B
LCBmYWxzZSk7Cj4gPiAgIAkJdGVtcCAmPSB+U0RWT19QSVBFX1NFTF9NQVNLOwo+ID4gICAJCXRl
bXAgfD0gU0RWT19FTkFCTEUgfCBTRFZPX1BJUEVfU0VMKFBJUEVfQSk7Cj4gPiBAQCAtMjAzMiw5
ICsyMDMyLDkgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ID4gICAJCUk5MTVfV1JJVEUoaW50ZWxfaGRtaS0+aGRtaV9yZWcs
IHRlbXApOwo+ID4gICAJCVBPU1RJTkdfUkVBRChpbnRlbF9oZG1pLT5oZG1pX3JlZyk7Cj4gPiAt
CQlpbnRlbF93YWl0X2Zvcl92YmxhbmtfaWZfYWN0aXZlKGRldl9wcml2LCBQSVBFX0EpOwo+ID4g
LQkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwgUElQRV9B
LCB0cnVlKTsKPiA+IC0JCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2
X3ByaXYsIFBJUEVfQSwgdHJ1ZSk7Cj4gPiArCQlpbnRlbF93YWl0X2Zvcl92YmxhbmtfaWZfYWN0
aXZlKGk5MTUsIFBJUEVfQSk7Cj4gPiArCQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVw
b3J0aW5nKGk5MTUsIFBJUEVfQSwgdHJ1ZSk7Cj4gPiArCQlpbnRlbF9zZXRfcGNoX2ZpZm9fdW5k
ZXJydW5fcmVwb3J0aW5nKGk5MTUsIFBJUEVfQSwgdHJ1ZSk7Cj4gPiAgIAl9Cj4gPiAgIAlpbnRl
bF9kaWdfcG9ydC0+c2V0X2luZm9mcmFtZXMoZW5jb2RlciwKPiA+IEBAIC0yMDczLDE2ICsyMDcz
LDE2IEBAIHN0YXRpYyB2b2lkIHBjaF9wb3N0X2Rpc2FibGVfaGRtaShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIGludCBpbnRlbF9oZG1pX3NvdXJjZV9tYXhfdG1k
c19jbG9jayhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBkZGlfdmJ0X3BvcnRfaW5mbyAqaW5mbyA9
Cj4gPiAtCQkmZGV2X3ByaXYtPnZidC5kZGlfcG9ydF9pbmZvW2VuY29kZXItPnBvcnRdOwo+ID4g
KwkJJmk5MTUtPnZidC5kZGlfcG9ydF9pbmZvW2VuY29kZXItPnBvcnRdOwo+ID4gICAJaW50IG1h
eF90bWRzX2Nsb2NrOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCB8fCBJU19H
RU1JTklMQUtFKGRldl9wcml2KSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCB8fCBJ
U19HRU1JTklMQUtFKGk5MTUpKQo+ID4gICAJCW1heF90bWRzX2Nsb2NrID0gNTk0MDAwOwo+ID4g
LQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDggfHwgSVNfSEFTV0VMTChkZXZfcHJp
dikpCj4gPiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4IHx8IElTX0hBU1dFTEwoaTkx
NSkpCj4gPiAgIAkJbWF4X3RtZHNfY2xvY2sgPSAzMDAwMDA7Cj4gPiAtCWVsc2UgaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gNSkKPiA+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDUp
Cj4gPiAgIAkJbWF4X3RtZHNfY2xvY2sgPSAyMjUwMDA7Cj4gPiAgIAllbHNlCj4gPiAgIAkJbWF4
X3RtZHNfY2xvY2sgPSAxNjUwMDA7Cj4gPiBAQCAtMjEyMyw3ICsyMTIzLDcgQEAgaGRtaV9wb3J0
X2Nsb2NrX3ZhbGlkKHN0cnVjdCBpbnRlbF9oZG1pICpoZG1pLAo+ID4gICAJCSAgICAgIGludCBj
bG9jaywgYm9vbCByZXNwZWN0X2Rvd25zdHJlYW1fbGltaXRzLAo+ID4gICAJCSAgICAgIGJvb2wg
Zm9yY2VfZHZpKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoaW50ZWxfaGRtaV90b19kZXYoaGRtaSkpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfaGRtaV90b19kZXYoaGRtaSkpOwo+ID4g
ICAJaWYgKGNsb2NrIDwgMjUwMDApCj4gPiAgIAkJcmV0dXJuIE1PREVfQ0xPQ0tfTE9XOwo+ID4g
QEAgLTIxMzEsMTEgKzIxMzEsMTEgQEAgaGRtaV9wb3J0X2Nsb2NrX3ZhbGlkKHN0cnVjdCBpbnRl
bF9oZG1pICpoZG1pLAo+ID4gICAJCXJldHVybiBNT0RFX0NMT0NLX0hJR0g7Cj4gPiAgIAkvKiBC
WFQgRFBMTCBjYW4ndCBnZW5lcmF0ZSAyMjMtMjQwIE1IeiAqLwo+ID4gLQlpZiAoSVNfR0VOOV9M
UChkZXZfcHJpdikgJiYgY2xvY2sgPiAyMjMzMzMgJiYgY2xvY2sgPCAyNDAwMDApCj4gPiArCWlm
IChJU19HRU45X0xQKGk5MTUpICYmIGNsb2NrID4gMjIzMzMzICYmIGNsb2NrIDwgMjQwMDAwKQo+
ID4gICAJCXJldHVybiBNT0RFX0NMT0NLX1JBTkdFOwo+ID4gICAJLyogQ0hWIERQTEwgY2FuJ3Qg
Z2VuZXJhdGUgMjE2LTI0MCBNSHogKi8KPiA+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYp
ICYmIGNsb2NrID4gMjE2MDAwICYmIGNsb2NrIDwgMjQwMDAwKQo+ID4gKwlpZiAoSVNfQ0hFUlJZ
VklFVyhpOTE1KSAmJiBjbG9jayA+IDIxNjAwMCAmJiBjbG9jayA8IDI0MDAwMCkKPiA+ICAgCQly
ZXR1cm4gTU9ERV9DTE9DS19SQU5HRTsKPiA+ICAgCXJldHVybiBNT0RFX09LOwo+ID4gQEAgLTIx
NDcsNyArMjE0Nyw3IEBAIGludGVsX2hkbWlfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yLAo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfaGRtaSAqaGRtaSA9IGlu
dGVsX2F0dGFjaGVkX2hkbWkoY29ubmVjdG9yKTsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSBpbnRlbF9oZG1pX3RvX2RldihoZG1pKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCWVudW0gZHJtX21vZGVfc3RhdHVzIHN0YXR1
czsKPiA+ICAgCWludCBjbG9jazsKPiA+ICAgCWludCBtYXhfZG90Y2xrID0gdG9faTkxNShjb25u
ZWN0b3ItPmRldiktPm1heF9kb3RjbGtfZnJlcTsKPiA+IEBAIC0yMTc2LDEyICsyMTc2LDEyIEBA
IGludGVsX2hkbWlfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+
ID4gICAJaWYgKGhkbWktPmhhc19oZG1pX3NpbmsgJiYgIWZvcmNlX2R2aSkgewo+ID4gICAJCS8q
IGlmIHdlIGNhbid0IGRvIDhicGMgd2UgbWF5IHN0aWxsIGJlIGFibGUgdG8gZG8gMTJicGMgKi8K
PiA+IC0JCWlmIChzdGF0dXMgIT0gTU9ERV9PSyAmJiAhSEFTX0dNQ0goZGV2X3ByaXYpKQo+ID4g
KwkJaWYgKHN0YXR1cyAhPSBNT0RFX09LICYmICFIQVNfR01DSChpOTE1KSkKPiA+ICAgCQkJc3Rh
dHVzID0gaGRtaV9wb3J0X2Nsb2NrX3ZhbGlkKGhkbWksIGNsb2NrICogMyAvIDIsCj4gPiAgIAkJ
CQkJCSAgICAgICB0cnVlLCBmb3JjZV9kdmkpOwo+ID4gICAJCS8qIGlmIHdlIGNhbid0IGRvIDgs
MTJicGMgd2UgbWF5IHN0aWxsIGJlIGFibGUgdG8gZG8gMTBicGMgKi8KPiA+IC0JCWlmIChzdGF0
dXMgIT0gTU9ERV9PSyAmJiBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ID4gKwkJaWYgKHN0
YXR1cyAhPSBNT0RFX09LICYmIElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICAgCQkJc3RhdHVz
ID0gaGRtaV9wb3J0X2Nsb2NrX3ZhbGlkKGhkbWksIGNsb2NrICogNSAvIDQsCj4gPiAgIAkJCQkJ
CSAgICAgICB0cnVlLCBmb3JjZV9kdmkpOwo+ID4gICAJfQo+ID4gQEAgLTIxOTIsNyArMjE5Miw3
IEBAIGludGVsX2hkbWlfbW9kZV92YWxpZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9y
LAo+ID4gICBzdGF0aWMgYm9vbCBoZG1pX2RlZXBfY29sb3JfcG9zc2libGUoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQkgICAgIGludCBicGMpCj4g
PiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ID4gICAJCXRvX2k5MTUoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjLT5kZXYpOwo+ID4gICAJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0g
Y3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiA+ICAgCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRl
ICpjb25uZWN0b3Jfc3RhdGU7Cj4gPiBAQCAtMjIwMSwxMCArMjIwMSwxMCBAQCBzdGF0aWMgYm9v
bCBoZG1pX2RlZXBfY29sb3JfcG9zc2libGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUsCj4gPiAgIAkJJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiA+
ICAgCWludCBpOwo+ID4gLQlpZiAoSEFTX0dNQ0goZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFTX0dN
Q0goaTkxNSkpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gLQlpZiAoYnBjID09IDEwICYmIElO
VEVMX0dFTihkZXZfcHJpdikgPCAxMSkKPiA+ICsJaWYgKGJwYyA9PSAxMCAmJiBJTlRFTF9HRU4o
aTkxNSkgPCAxMSkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAlpZiAoY3J0Y19zdGF0ZS0+
cGlwZV9icHAgPCBicGMgKiAzKQo+ID4gQEAgLTIyNDYsMTMgKzIyNDYsMTMgQEAgc3RhdGljIGJv
b2wgaGRtaV9kZWVwX2NvbG9yX3Bvc3NpYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+ID4gICAJfQo+ID4gICAJLyogRGlzcGxheSBXQSAjMTEzOTogZ2xrICov
Cj4gPiAtCWlmIChicGMgPT0gMTIgJiYgSVNfR0xLX1JFVklEKGRldl9wcml2LCAwLCBHTEtfUkVW
SURfQTEpICYmCj4gPiArCWlmIChicGMgPT0gMTIgJiYgSVNfR0xLX1JFVklEKGk5MTUsIDAsIEdM
S19SRVZJRF9BMSkgJiYKPiA+ICAgCSAgICBhZGp1c3RlZF9tb2RlLT5odG90YWwgPiA1NDYwKQo+
ID4gICAJCXJldHVybiBmYWxzZTsKPiA+ICAgCS8qIERpc3BsYXkgV2FfMTQwNTUxMDA1NzppY2wg
Ki8KPiA+ICAgCWlmIChjcnRjX3N0YXRlLT5vdXRwdXRfZm9ybWF0ID09IElOVEVMX09VVFBVVF9G
T1JNQVRfWUNCQ1I0MjAgJiYKPiA+IC0JICAgIGJwYyA9PSAxMCAmJiBJTlRFTF9HRU4oZGV2X3By
aXYpID49IDExICYmCj4gPiArCSAgICBicGMgPT0gMTAgJiYgSU5URUxfR0VOKGk5MTUpID49IDEx
ICYmCj4gPiAgIAkgICAgKGFkanVzdGVkX21vZGUtPmNydGNfaGJsYW5rX2VuZCAtCj4gPiAgIAkg
ICAgIGFkanVzdGVkX21vZGUtPmNydGNfaGJsYW5rX3N0YXJ0KSAlIDggPT0gMikKPiA+ICAgCQly
ZXR1cm4gZmFsc2U7Cj4gPiBAQCAtMjI5Nyw3ICsyMjk3LDcgQEAgaW50IGludGVsX2hkbWlfY29t
cHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCSAgICAg
IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9IGVuY190b19pbnRlbF9oZG1pKCZlbmNvZGVy
LT5iYXNlKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+
ID4gICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IGNvbm5fc3RhdGUtPmNvbm5l
Y3RvcjsKPiA+ICAgCXN0cnVjdCBkcm1fc2NkYyAqc2NkYyA9ICZjb25uZWN0b3ItPmRpc3BsYXlf
aW5mby5oZG1pLnNjZGM7Cj4gPiBAQCAtMjM0NSw3ICsyMzQ1LDcgQEAgaW50IGludGVsX2hkbWlf
Y29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJfQo+
ID4gICAJfQo+ID4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikgJiYgIUhBU19EREkoZGV2
X3ByaXYpKQo+ID4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1KSAmJiAhSEFTX0RESShpOTE1KSkK
PiA+ICAgCQlwaXBlX2NvbmZpZy0+aGFzX3BjaF9lbmNvZGVyID0gdHJ1ZTsKPiA+ICAgCWlmIChw
aXBlX2NvbmZpZy0+aGFzX2hkbWlfc2luaykgewo+ID4gQEAgLTIzOTksOCArMjM5OSw4IEBAIGlu
dCBpbnRlbF9oZG1pX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ID4gICAJcGlwZV9jb25maWctPmxhbmVfY291bnQgPSA0Owo+ID4gLQlpZiAoc2NkYy0+c2Ny
YW1ibGluZy5zdXBwb3J0ZWQgJiYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwKPiA+IC0J
CQkJCSAgIElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSkgewo+ID4gKwlpZiAoc2NkYy0+c2NyYW1i
bGluZy5zdXBwb3J0ZWQgJiYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCB8fAo+ID4gKwkJCQkJICAg
SVNfR0VNSU5JTEFLRShpOTE1KSkpIHsKPiA+ICAgCQlpZiAoc2NkYy0+c2NyYW1ibGluZy5sb3df
cmF0ZXMpCj4gPiAgIAkJCXBpcGVfY29uZmlnLT5oZG1pX3NjcmFtYmxpbmcgPSB0cnVlOwo+ID4g
QEAgLTI0NTMsMTEgKzI0NTMsMTEgQEAgaW50ZWxfaGRtaV91bnNldF9lZGlkKHN0cnVjdCBkcm1f
Y29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHN0YXRpYyB2b2lkCj4gPiAgIGludGVsX2hkbWlf
ZHBfZHVhbF9tb2RlX2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBib29s
IGhhc19lZGlkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2hk
bWkgKmhkbWkgPSBpbnRlbF9hdHRhY2hlZF9oZG1pKGNvbm5lY3Rvcik7Cj4gPiAgIAllbnVtIHBv
cnQgcG9ydCA9IGhkbWlfdG9fZGlnX3BvcnQoaGRtaSktPmJhc2UucG9ydDsKPiA+ICAgCXN0cnVj
dCBpMmNfYWRhcHRlciAqYWRhcHRlciA9Cj4gPiAtCQlpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihk
ZXZfcHJpdiwgaGRtaS0+ZGRjX2J1cyk7Cj4gPiArCQlpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihp
OTE1LCBoZG1pLT5kZGNfYnVzKTsKPiA+ICAgCWVudW0gZHJtX2RwX2R1YWxfbW9kZV90eXBlIHR5
cGUgPSBkcm1fZHBfZHVhbF9tb2RlX2RldGVjdChhZGFwdGVyKTsKPiA+ICAgCS8qCj4gPiBAQCAt
MjQ3Nyw3ICsyNDc3LDcgQEAgaW50ZWxfaGRtaV9kcF9kdWFsX21vZGVfZGV0ZWN0KHN0cnVjdCBk
cm1fY29ubmVjdG9yICpjb25uZWN0b3IsIGJvb2wgaGFzX2VkaWQpCj4gPiAgIAkJICogTWFrZSBz
dXJlIG5vdCB0byBzZXQgbGltaXRzIGZvciB0aGF0IHBvcnQuCj4gPiAgIAkJICovCj4gPiAgIAkJ
aWYgKGhhc19lZGlkICYmICFjb25uZWN0b3ItPm92ZXJyaWRlX2VkaWQgJiYKPiA+IC0JCSAgICBp
bnRlbF9iaW9zX2lzX3BvcnRfZHBfZHVhbF9tb2RlKGRldl9wcml2LCBwb3J0KSkgewo+ID4gKwkJ
ICAgIGludGVsX2Jpb3NfaXNfcG9ydF9kcF9kdWFsX21vZGUoaTkxNSwgcG9ydCkpIHsKPiA+ICAg
CQkJRFJNX0RFQlVHX0tNUygiQXNzdW1pbmcgRFAgZHVhbCBtb2RlIGFkYXB0b3IgcHJlc2VuY2Ug
YmFzZWQgb24gVkJUXG4iKTsKPiA+ICAgCQkJdHlwZSA9IERSTV9EUF9EVUFMX01PREVfVFlQRTFf
RFZJOwo+ID4gICAJCX0gZWxzZSB7Cj4gPiBAQCAtMjUwMCwxNiArMjUwMCwxNiBAQCBpbnRlbF9o
ZG1pX2RwX2R1YWxfbW9kZV9kZXRlY3Qoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rvciwg
Ym9vbCBoYXNfZWRpZCkKPiA+ICAgc3RhdGljIGJvb2wKPiA+ICAgaW50ZWxfaGRtaV9zZXRfZWRp
ZChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYp
Owo+ID4gICAJc3RydWN0IGludGVsX2hkbWkgKmludGVsX2hkbWkgPSBpbnRlbF9hdHRhY2hlZF9o
ZG1pKGNvbm5lY3Rvcik7Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCXN0
cnVjdCBlZGlkICplZGlkOwo+ID4gICAJYm9vbCBjb25uZWN0ZWQgPSBmYWxzZTsKPiA+ICAgCXN0
cnVjdCBpMmNfYWRhcHRlciAqaTJjOwo+ID4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dl
cl9nZXQoZGV2X3ByaXYsIFBPV0VSX0RPTUFJTl9HTUJVUyk7Cj4gPiArCXdha2VyZWYgPSBpbnRl
bF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBQT1dFUl9ET01BSU5fR01CVVMpOwo+ID4gLQlpMmMg
PSBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihkZXZfcHJpdiwgaW50ZWxfaGRtaS0+ZGRjX2J1cyk7
Cj4gPiArCWkyYyA9IGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGk5MTUsIGludGVsX2hkbWktPmRk
Y19idXMpOwo+ID4gICAJZWRpZCA9IGRybV9nZXRfZWRpZChjb25uZWN0b3IsIGkyYyk7Cj4gPiBA
QCAtMjUyMiw3ICsyNTIyLDcgQEAgaW50ZWxfaGRtaV9zZXRfZWRpZChzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvciAqY29ubmVjdG9yKQo+ID4gICAJaW50ZWxfaGRtaV9kcF9kdWFsX21vZGVfZGV0ZWN0KGNv
bm5lY3RvciwgZWRpZCAhPSBOVUxMKTsKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2
X3ByaXYsIFBPV0VSX0RPTUFJTl9HTUJVUywgd2FrZXJlZik7Cj4gPiArCWludGVsX2Rpc3BsYXlf
cG93ZXJfcHV0KGk5MTUsIFBPV0VSX0RPTUFJTl9HTUJVUywgd2FrZXJlZik7Cj4gPiAgIAl0b19p
bnRlbF9jb25uZWN0b3IoY29ubmVjdG9yKS0+ZGV0ZWN0X2VkaWQgPSBlZGlkOwo+ID4gICAJaWYg
KGVkaWQgJiYgZWRpZC0+aW5wdXQgJiBEUk1fRURJRF9JTlBVVF9ESUdJVEFMKSB7Cj4gPiBAQCAt
MjU0MSw3ICsyNTQxLDcgQEAgc3RhdGljIGVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0dXMKPiA+ICAg
aW50ZWxfaGRtaV9kZXRlY3Qoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwgYm9vbCBm
b3JjZSkKPiA+ICAgewo+ID4gICAJZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1cyBzdGF0dXMgPSBj
b25uZWN0b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZDsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9IGludGVsX2F0dGFjaGVkX2hkbWkoY29ubmVjdG9y
KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyID0gJmhkbWlfdG9fZGlnX3Bv
cnQoaW50ZWxfaGRtaSktPmJhc2U7Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+
IEBAIC0yNTQ5LDkgKzI1NDksOSBAQCBpbnRlbF9oZG1pX2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvciAqY29ubmVjdG9yLCBib29sIGZvcmNlKQo+ID4gICAJRFJNX0RFQlVHX0tNUygiW0NPTk5F
Q1RPUjolZDolc11cbiIsCj4gPiAgIAkJICAgICAgY29ubmVjdG9yLT5iYXNlLmlkLCBjb25uZWN0
b3ItPm5hbWUpOwo+ID4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3By
aXYsIFBPV0VSX0RPTUFJTl9HTUJVUyk7Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2dldChpOTE1LCBQT1dFUl9ET01BSU5fR01CVVMpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSAxMSAmJgo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExICYmCj4gPiAg
IAkgICAgIWludGVsX2RpZ2l0YWxfcG9ydF9jb25uZWN0ZWQoZW5jb2RlcikpCj4gPiAgIAkJZ290
byBvdXQ7Cj4gPiBAQCAtMjU2MSw3ICsyNTYxLDcgQEAgaW50ZWxfaGRtaV9kZXRlY3Qoc3RydWN0
IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwgYm9vbCBmb3JjZSkKPiA+ICAgCQlzdGF0dXMgPSBj
b25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZDsKPiA+ICAgb3V0Ogo+ID4gLQlpbnRlbF9kaXNwbGF5
X3Bvd2VyX3B1dChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0dNQlVTLCB3YWtlcmVmKTsKPiA+ICsJ
aW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwgUE9XRVJfRE9NQUlOX0dNQlVTLCB3YWtlcmVm
KTsKPiA+ICAgCWlmIChzdGF0dXMgIT0gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQpCj4gPiAg
IAkJY2VjX25vdGlmaWVyX3BoeXNfYWRkcl9pbnZhbGlkYXRlKGludGVsX2hkbWktPmNlY19ub3Rp
Zmllcik7Cj4gPiBAQCAtMjYxMyw3ICsyNjEzLDcgQEAgc3RhdGljIHZvaWQgdmx2X2hkbWlfcHJl
X2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCWNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkcG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+
YmFzZSk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJdmx2X3BoeV9wcmVfZW5jb2Rlcl9l
bmFibGUoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ID4gQEAgLTI2MjcsNyArMjYyNyw3IEBAIHN0
YXRpYyB2b2lkIHZsdl9oZG1pX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gPiAgIAlnNHhfZW5hYmxlX2hkbWkoZW5jb2RlciwgcGlwZV9jb25maWcsIGNvbm5fc3Rh
dGUpOwo+ID4gLQl2bHZfd2FpdF9wb3J0X3JlYWR5KGRldl9wcml2LCBkcG9ydCwgMHgwKTsKPiA+
ICsJdmx2X3dhaXRfcG9ydF9yZWFkeShpOTE1LCBkcG9ydCwgMHgwKTsKPiA+ICAgfQo+ID4gICBz
dGF0aWMgdm9pZCB2bHZfaGRtaV9wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKPiA+IEBAIC0yNjY4LDE0ICsyNjY4LDE0IEBAIHN0YXRpYyB2b2lkIGNodl9oZG1p
X3Bvc3RfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCSAg
Y29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQo+ID4gICB7
Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gZW5jb2Rlci0+YmFzZS5kZXY7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAtCXZsdl9k
cGlvX2dldChkZXZfcHJpdik7Cj4gPiArCXZsdl9kcGlvX2dldChpOTE1KTsKPiA+ICAgCS8qIEFz
c2VydCBkYXRhIGxhbmUgcmVzZXQgKi8KPiA+ICAgCWNodl9kYXRhX2xhbmVfc29mdF9yZXNldChl
bmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgdHJ1ZSk7Cj4gPiAtCXZsdl9kcGlvX3B1dChkZXZfcHJp
dik7Cj4gPiArCXZsdl9kcGlvX3B1dChpOTE1KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBj
aHZfaGRtaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gQEAg
LTI2ODQsNyArMjY4NCw3IEBAIHN0YXRpYyB2b2lkIGNodl9oZG1pX3ByZV9lbmFibGUoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmRwb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAg
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBlbmNvZGVyLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCWNodl9waHlfcHJl
X2VuY29kZXJfZW5hYmxlKGVuY29kZXIsIHBpcGVfY29uZmlnKTsKPiA+IEBAIC0yNjk4LDcgKzI2
OTgsNyBAQCBzdGF0aWMgdm9pZCBjaHZfaGRtaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+ID4gICAJZzR4X2VuYWJsZV9oZG1pKGVuY29kZXIsIHBpcGVfY29uZmln
LCBjb25uX3N0YXRlKTsKPiA+IC0Jdmx2X3dhaXRfcG9ydF9yZWFkeShkZXZfcHJpdiwgZHBvcnQs
IDB4MCk7Cj4gPiArCXZsdl93YWl0X3BvcnRfcmVhZHkoaTkxNSwgZHBvcnQsIDB4MCk7Cj4gPiAg
IAkvKiBTZWNvbmQgY29tbW9uIGxhbmUgd2lsbCBzdGF5IGFsaXZlIG9uIGl0cyBvd24gbm93ICov
Cj4gPiAgIAljaHZfcGh5X3JlbGVhc2VfY2wyX292ZXJyaWRlKGVuY29kZXIpOwo+ID4gQEAgLTI3
MDcsMTAgKzI3MDcsMTAgQEAgc3RhdGljIHZvaWQgY2h2X2hkbWlfcHJlX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIHN0cnVjdCBpMmNfYWRhcHRlciAq
Cj4gPiAgIGludGVsX2hkbWlfZ2V0X2kyY19hZGFwdGVyKHN0cnVjdCBkcm1fY29ubmVjdG9yICpj
b25uZWN0b3IpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfaGRt
aSAqaW50ZWxfaGRtaSA9IGludGVsX2F0dGFjaGVkX2hkbWkoY29ubmVjdG9yKTsKPiA+IC0JcmV0
dXJuIGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGRldl9wcml2LCBpbnRlbF9oZG1pLT5kZGNfYnVz
KTsKPiA+ICsJcmV0dXJuIGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGk5MTUsIGludGVsX2hkbWkt
PmRkY19idXMpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2hkbWlfY3JlYXRlX2ky
Y19zeW1saW5rKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiBAQCAtMjc5MSw3
ICsyNzkxLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9mdW5jcyBpbnRlbF9o
ZG1pX2VuY19mdW5jcyA9IHsKPiA+ICAgc3RhdGljIHZvaWQKPiA+ICAgaW50ZWxfaGRtaV9hZGRf
cHJvcGVydGllcyhzdHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSwgc3RydWN0IGRybV9jb25u
ZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0KPiA+ICAgCQkJCWhkbWlfdG9fZGln
X3BvcnQoaW50ZWxfaGRtaSk7Cj4gPiBAQCAtMjgxMCwxMSArMjgxMCwxMSBAQCBpbnRlbF9oZG1p
X2FkZF9wcm9wZXJ0aWVzKHN0cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pLCBzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqYwo+ID4gICAJZHJtX2Nvbm5lY3Rvcl9hdHRhY2hfY29udGVudF90eXBlX3By
b3BlcnR5KGNvbm5lY3Rvcik7Cj4gPiAgIAljb25uZWN0b3ItPnN0YXRlLT5waWN0dXJlX2FzcGVj
dF9yYXRpbyA9IEhETUlfUElDVFVSRV9BU1BFQ1RfTk9ORTsKPiA+IC0JaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShpOTE1KSkKPiA+ICAgCQlkcm1fb2Jq
ZWN0X2F0dGFjaF9wcm9wZXJ0eSgmY29ubmVjdG9yLT5iYXNlLAo+ID4gICAJCQljb25uZWN0b3It
PmRldi0+bW9kZV9jb25maWcuaGRyX291dHB1dF9tZXRhZGF0YV9wcm9wZXJ0eSwgMCk7Cj4gPiAt
CWlmICghSEFTX0dNQ0goZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19HTUNIKGk5MTUpKQo+ID4g
ICAJCWRybV9jb25uZWN0b3JfYXR0YWNoX21heF9icGNfcHJvcGVydHkoY29ubmVjdG9yLCA4LCAx
Mik7Cj4gPiAgIH0KPiA+IEBAIC0yODQxLDEyICsyODQxLDEyIEBAIGJvb2wgaW50ZWxfaGRtaV9o
YW5kbGVfc2lua19zY3JhbWJsaW5nKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4g
ICAJCQkJICAgICAgIGJvb2wgaGlnaF90bWRzX2Nsb2NrX3JhdGlvLAo+ID4gICAJCQkJICAgICAg
IGJvb2wgc2NyYW1ibGluZykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9oZG1pICppbnRlbF9oZG1pID0gZW5jX3RvX2ludGVsX2hkbWkoJmVuY29kZXIt
PmJhc2UpOwo+ID4gICAJc3RydWN0IGRybV9zY3JhbWJsaW5nICpzaW5rX3NjcmFtYmxpbmcgPQo+
ID4gICAJCSZjb25uZWN0b3ItPmRpc3BsYXlfaW5mby5oZG1pLnNjZGMuc2NyYW1ibGluZzsKPiA+
ICAgCXN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlciA9Cj4gPiAtCQlpbnRlbF9nbWJ1c19nZXRf
YWRhcHRlcihkZXZfcHJpdiwgaW50ZWxfaGRtaS0+ZGRjX2J1cyk7Cj4gPiArCQlpbnRlbF9nbWJ1
c19nZXRfYWRhcHRlcihpOTE1LCBpbnRlbF9oZG1pLT5kZGNfYnVzKTsKPiA+ICAgCWlmICghc2lu
a19zY3JhbWJsaW5nLT5zdXBwb3J0ZWQpCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiBAQCAtMjg2
MSw3ICsyODYxLDcgQEAgYm9vbCBpbnRlbF9oZG1pX2hhbmRsZV9zaW5rX3NjcmFtYmxpbmcoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJZHJtX3NjZGNfc2V0X3NjcmFtYmxp
bmcoYWRhcHRlciwgc2NyYW1ibGluZyk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTggY2h2X3BvcnRf
dG9fZGRjX3BpbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBw
b3J0KQo+ID4gK3N0YXRpYyB1OCBjaHZfcG9ydF90b19kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+ID4gICAJdTggZGRjX3BpbjsK
PiA+IEBAIC0yODgzLDcgKzI4ODMsNyBAQCBzdGF0aWMgdTggY2h2X3BvcnRfdG9fZGRjX3Bpbihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KQo+ID4gICAJ
cmV0dXJuIGRkY19waW47Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTggYnh0X3BvcnRfdG9fZGRjX3Bp
bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KQo+ID4g
K3N0YXRpYyB1OCBieHRfcG9ydF90b19kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+ID4gICAJdTggZGRjX3BpbjsKPiA+IEBAIC0y
OTAyLDcgKzI5MDIsNyBAQCBzdGF0aWMgdTggYnh0X3BvcnRfdG9fZGRjX3BpbihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcG9ydCBwb3J0KQo+ID4gICAJcmV0dXJuIGRk
Y19waW47Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTggY25wX3BvcnRfdG9fZGRjX3BpbihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHU4IGNucF9wb3J0X3RvX2Rk
Y19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgIGVudW0g
cG9ydCBwb3J0KQo+ID4gICB7Cj4gPiAgIAl1OCBkZGNfcGluOwo+ID4gQEAgLTI5MjgsNyArMjky
OCw3IEBAIHN0YXRpYyB1OCBjbnBfcG9ydF90b19kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICAgCXJldHVybiBkZGNfcGluOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IHU4IGljbF9wb3J0X3RvX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBlbnVtIHBvcnQgcG9ydCkKPiA+ICtzdGF0aWMgdTggaWNsX3BvcnRfdG9fZGRjX3BpbihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgZW51bSBwb3J0IHBvcnQpCj4gPiAgIHsKPiA+ICAg
CXU4IGRkY19waW47Cj4gPiBAQCAtMjk1OSw3ICsyOTU5LDcgQEAgc3RhdGljIHU4IGljbF9wb3J0
X3RvX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQg
cG9ydCkKPiA+ICAgCXJldHVybiBkZGNfcGluOwo+ID4gICB9Cj4gPiAtc3RhdGljIHU4IGc0eF9w
b3J0X3RvX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0
YXRpYyB1OCBnNHhfcG9ydF90b19kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ID4gICAJCQkgICAgICBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+ID4gICAJdTggZGRjX3Bp
bjsKPiA+IEBAIC0yOTgyLDExICsyOTgyLDExIEBAIHN0YXRpYyB1OCBnNHhfcG9ydF90b19kZGNf
cGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXJldHVybiBkZGNf
cGluOwo+ID4gICB9Cj4gPiAtc3RhdGljIHU4IGludGVsX2hkbWlfZGRjX3BpbihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHU4IGludGVsX2hkbWlfZGRjX3Bp
bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICBlbnVtIHBvcnQg
cG9ydCkKPiA+ICAgewo+ID4gICAJY29uc3Qgc3RydWN0IGRkaV92YnRfcG9ydF9pbmZvICppbmZv
ID0KPiA+IC0JCSZkZXZfcHJpdi0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF07Cj4gPiArCQkmaTkx
NS0+dmJ0LmRkaV9wb3J0X2luZm9bcG9ydF07Cj4gPiAgIAl1OCBkZGNfcGluOwo+ID4gICAJaWYg
KGluZm8tPmFsdGVybmF0ZV9kZGNfcGluKSB7Cj4gPiBAQCAtMjk5NSwxNiArMjk5NSwxNiBAQCBz
dGF0aWMgdTggaW50ZWxfaGRtaV9kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICAgCQlyZXR1cm4gaW5mby0+YWx0ZXJuYXRlX2RkY19waW47Cj4gPiAgIAl9Cj4g
PiAtCWlmIChIQVNfUENIX0lDUChkZXZfcHJpdikpCj4gPiAtCQlkZGNfcGluID0gaWNsX3BvcnRf
dG9fZGRjX3BpbihkZXZfcHJpdiwgcG9ydCk7Cj4gPiAtCWVsc2UgaWYgKEhBU19QQ0hfQ05QKGRl
dl9wcml2KSkKPiA+IC0JCWRkY19waW4gPSBjbnBfcG9ydF90b19kZGNfcGluKGRldl9wcml2LCBw
b3J0KTsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gPiAtCQlkZGNfcGlu
ID0gYnh0X3BvcnRfdG9fZGRjX3BpbihkZXZfcHJpdiwgcG9ydCk7Cj4gPiAtCWVsc2UgaWYgKElT
X0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gLQkJZGRjX3BpbiA9IGNodl9wb3J0X3RvX2RkY19w
aW4oZGV2X3ByaXYsIHBvcnQpOwo+ID4gKwlpZiAoSEFTX1BDSF9JQ1AoaTkxNSkpCj4gPiArCQlk
ZGNfcGluID0gaWNsX3BvcnRfdG9fZGRjX3BpbihpOTE1LCBwb3J0KTsKPiA+ICsJZWxzZSBpZiAo
SEFTX1BDSF9DTlAoaTkxNSkpCj4gPiArCQlkZGNfcGluID0gY25wX3BvcnRfdG9fZGRjX3Bpbihp
OTE1LCBwb3J0KTsKPiA+ICsJZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiA+ICsJCWRkY19w
aW4gPSBieHRfcG9ydF90b19kZGNfcGluKGk5MTUsIHBvcnQpOwo+ID4gKwllbHNlIGlmIChJU19D
SEVSUllWSUVXKGk5MTUpKQo+ID4gKwkJZGRjX3BpbiA9IGNodl9wb3J0X3RvX2RkY19waW4oaTkx
NSwgcG9ydCk7Cj4gPiAgIAllbHNlCj4gPiAtCQlkZGNfcGluID0gZzR4X3BvcnRfdG9fZGRjX3Bp
bihkZXZfcHJpdiwgcG9ydCk7Cj4gPiArCQlkZGNfcGluID0gZzR4X3BvcnRfdG9fZGRjX3Bpbihp
OTE1LCBwb3J0KTsKPiA+ICAgCURSTV9ERUJVR19LTVMoIlVzaW5nIEREQyBwaW4gMHgleCBmb3Ig
cG9ydCAlYyAocGxhdGZvcm0gZGVmYXVsdClcbiIsCj4gPiAgIAkJICAgICAgZGRjX3BpbiwgcG9y
dF9uYW1lKHBvcnQpKTsKPiA+IEBAIC0zMDE0LDIwICszMDE0LDIwIEBAIHN0YXRpYyB1OCBpbnRl
bF9oZG1pX2RkY19waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICB2
b2lkIGludGVsX2luZm9mcmFtZV9pbml0KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVs
X2RpZ19wb3J0KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0KPiA+ICAgCQl0b19pOTE1
KGludGVsX2RpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKPiA+IC0JaWYgKElTX1ZBTExFWVZJRVco
ZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19WQUxM
RVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+ICAgCQlpbnRlbF9kaWdf
cG9ydC0+d3JpdGVfaW5mb2ZyYW1lID0gdmx2X3dyaXRlX2luZm9mcmFtZTsKPiA+ICAgCQlpbnRl
bF9kaWdfcG9ydC0+cmVhZF9pbmZvZnJhbWUgPSB2bHZfcmVhZF9pbmZvZnJhbWU7Cj4gPiAgIAkJ
aW50ZWxfZGlnX3BvcnQtPnNldF9pbmZvZnJhbWVzID0gdmx2X3NldF9pbmZvZnJhbWVzOwo+ID4g
ICAJCWludGVsX2RpZ19wb3J0LT5pbmZvZnJhbWVzX2VuYWJsZWQgPSB2bHZfaW5mb2ZyYW1lc19l
bmFibGVkOwo+ID4gLQl9IGVsc2UgaWYgKElTX0c0WChkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNl
IGlmIChJU19HNFgoaTkxNSkpIHsKPiA+ICAgCQlpbnRlbF9kaWdfcG9ydC0+d3JpdGVfaW5mb2Zy
YW1lID0gZzR4X3dyaXRlX2luZm9mcmFtZTsKPiA+ICAgCQlpbnRlbF9kaWdfcG9ydC0+cmVhZF9p
bmZvZnJhbWUgPSBnNHhfcmVhZF9pbmZvZnJhbWU7Cj4gPiAgIAkJaW50ZWxfZGlnX3BvcnQtPnNl
dF9pbmZvZnJhbWVzID0gZzR4X3NldF9pbmZvZnJhbWVzOwo+ID4gICAJCWludGVsX2RpZ19wb3J0
LT5pbmZvZnJhbWVzX2VuYWJsZWQgPSBnNHhfaW5mb2ZyYW1lc19lbmFibGVkOwo+ID4gLQl9IGVs
c2UgaWYgKEhBU19EREkoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSEFTX0RESShpOTE1
KSkgewo+ID4gICAJCWlmIChpbnRlbF9kaWdfcG9ydC0+bHNwY29uLmFjdGl2ZSkgewo+ID4gICAJ
CQlpbnRlbF9kaWdfcG9ydC0+d3JpdGVfaW5mb2ZyYW1lID0gbHNwY29uX3dyaXRlX2luZm9mcmFt
ZTsKPiA+ICAgCQkJaW50ZWxfZGlnX3BvcnQtPnJlYWRfaW5mb2ZyYW1lID0gbHNwY29uX3JlYWRf
aW5mb2ZyYW1lOwo+ID4gQEAgLTMwMzksNyArMzAzOSw3IEBAIHZvaWQgaW50ZWxfaW5mb2ZyYW1l
X2luaXQoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQpCj4gPiAgIAkJ
CWludGVsX2RpZ19wb3J0LT5zZXRfaW5mb2ZyYW1lcyA9IGhzd19zZXRfaW5mb2ZyYW1lczsKPiA+
ICAgCQkJaW50ZWxfZGlnX3BvcnQtPmluZm9mcmFtZXNfZW5hYmxlZCA9IGhzd19pbmZvZnJhbWVz
X2VuYWJsZWQ7Cj4gPiAgIAkJfQo+ID4gLQl9IGVsc2UgaWYgKEhBU19QQ0hfSUJYKGRldl9wcml2
KSkgewo+ID4gKwl9IGVsc2UgaWYgKEhBU19QQ0hfSUJYKGk5MTUpKSB7Cj4gPiAgIAkJaW50ZWxf
ZGlnX3BvcnQtPndyaXRlX2luZm9mcmFtZSA9IGlieF93cml0ZV9pbmZvZnJhbWU7Cj4gPiAgIAkJ
aW50ZWxfZGlnX3BvcnQtPnJlYWRfaW5mb2ZyYW1lID0gaWJ4X3JlYWRfaW5mb2ZyYW1lOwo+ID4g
ICAJCWludGVsX2RpZ19wb3J0LT5zZXRfaW5mb2ZyYW1lcyA9IGlieF9zZXRfaW5mb2ZyYW1lczsK
PiA+IEBAIC0zMDU5LDcgKzMwNTksNyBAQCB2b2lkIGludGVsX2hkbWlfaW5pdF9jb25uZWN0b3Io
c3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9ICZpbnRlbF9kaWdfcG9ydC0+aGRtaTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyID0gJmludGVsX2RpZ19wb3J0LT5iYXNl
Owo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVsX2VuY29kZXItPmJhc2UuZGV2
Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4g
ICAJZW51bSBwb3J0IHBvcnQgPSBpbnRlbF9lbmNvZGVyLT5wb3J0Owo+ID4gICAJRFJNX0RFQlVH
X0tNUygiQWRkaW5nIEhETUkgY29ubmVjdG9yIG9uIHBvcnQgJWNcbiIsCj4gPiBAQCAtMzA3OCwx
NiArMzA3OCwxNiBAQCB2b2lkIGludGVsX2hkbWlfaW5pdF9jb25uZWN0b3Ioc3RydWN0IGludGVs
X2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gPiAgIAljb25uZWN0b3ItPmRvdWJsZXNj
YW5fYWxsb3dlZCA9IDA7Cj4gPiAgIAljb25uZWN0b3ItPnN0ZXJlb19hbGxvd2VkID0gMTsKPiA+
IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJp
dikpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShpOTE1
KSkKPiA+ICAgCQljb25uZWN0b3ItPnljYmNyXzQyMF9hbGxvd2VkID0gdHJ1ZTsKPiA+IC0JaW50
ZWxfaGRtaS0+ZGRjX2J1cyA9IGludGVsX2hkbWlfZGRjX3BpbihkZXZfcHJpdiwgcG9ydCk7Cj4g
PiArCWludGVsX2hkbWktPmRkY19idXMgPSBpbnRlbF9oZG1pX2RkY19waW4oaTkxNSwgcG9ydCk7
Cj4gPiAgIAlpZiAoV0FSTl9PTihwb3J0ID09IFBPUlRfQSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4g
LQlpbnRlbF9lbmNvZGVyLT5ocGRfcGluID0gaW50ZWxfaHBkX3Bpbl9kZWZhdWx0KGRldl9wcml2
LCBwb3J0KTsKPiA+ICsJaW50ZWxfZW5jb2Rlci0+aHBkX3BpbiA9IGludGVsX2hwZF9waW5fZGVm
YXVsdChpOTE1LCBwb3J0KTsKPiA+IC0JaWYgKEhBU19EREkoZGV2X3ByaXYpKQo+ID4gKwlpZiAo
SEFTX0RESShpOTE1KSkKPiA+ICAgCQlpbnRlbF9jb25uZWN0b3ItPmdldF9od19zdGF0ZSA9IGlu
dGVsX2RkaV9jb25uZWN0b3JfZ2V0X2h3X3N0YXRlOwo+ID4gICAJZWxzZQo+ID4gICAJCWludGVs
X2Nvbm5lY3Rvci0+Z2V0X2h3X3N0YXRlID0gaW50ZWxfY29ubmVjdG9yX2dldF9od19zdGF0ZTsK
PiA+IEBAIC0zMDk3LDcgKzMwOTcsNyBAQCB2b2lkIGludGVsX2hkbWlfaW5pdF9jb25uZWN0b3Io
c3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gPiAgIAlpbnRlbF9j
b25uZWN0b3JfYXR0YWNoX2VuY29kZXIoaW50ZWxfY29ubmVjdG9yLCBpbnRlbF9lbmNvZGVyKTsK
PiA+ICAgCWludGVsX2hkbWktPmF0dGFjaGVkX2Nvbm5lY3RvciA9IGludGVsX2Nvbm5lY3RvcjsK
PiA+IC0JaWYgKGlzX2hkY3Bfc3VwcG9ydGVkKGRldl9wcml2LCBwb3J0KSkgewo+ID4gKwlpZiAo
aXNfaGRjcF9zdXBwb3J0ZWQoaTkxNSwgcG9ydCkpIHsKPiA+ICAgCQlpbnQgcmV0ID0gaW50ZWxf
aGRjcF9pbml0KGludGVsX2Nvbm5lY3RvciwKPiA+ICAgCQkJCQkgICZpbnRlbF9oZG1pX2hkY3Bf
c2hpbSk7Cj4gPiAgIAkJaWYgKHJldCkKPiA+IEBAIC0zMTA4LDcgKzMxMDgsNyBAQCB2b2lkIGlu
dGVsX2hkbWlfaW5pdF9jb25uZWN0b3Ioc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxf
ZGlnX3BvcnQsCj4gPiAgIAkgKiAweGQuICBGYWlsdXJlIHRvIGRvIHNvIHdpbGwgcmVzdWx0IGlu
IHNwdXJpb3VzIGludGVycnVwdHMgYmVpbmcKPiA+ICAgCSAqIGdlbmVyYXRlZCBvbiB0aGUgcG9y
dCB3aGVuIGEgY2FibGUgaXMgbm90IGF0dGFjaGVkLgo+ID4gICAJICovCj4gPiAtCWlmIChJU19H
NDUoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19HNDUoaTkxNSkpIHsKPiA+ICAgCQl1MzIgdGVt
cCA9IEk5MTVfUkVBRChQRUdfQkFORF9HQVBfREFUQSk7Cj4gPiAgIAkJSTkxNV9XUklURShQRUdf
QkFORF9HQVBfREFUQSwgKHRlbXAgJiB+MHhmKSB8IDB4ZCk7Cj4gPiAgIAl9Cj4gPiBAQCAtMzEx
OSw3ICszMTE5LDcgQEAgdm9pZCBpbnRlbF9oZG1pX2luaXRfY29ubmVjdG9yKHN0cnVjdCBpbnRl
bF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0LAo+ID4gICAJCURSTV9ERUJVR19LTVMoIkNF
QyBub3RpZmllciBnZXQgZmFpbGVkXG4iKTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfaGRtaV9p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2hk
bWlfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkgICAgIGk5MTVf
cmVnX3QgaGRtaV9yZWcsIGVudW0gcG9ydCBwb3J0KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydDsKPiA+IEBAIC0zMTM4LDEzICszMTM4LDEz
IEBAIHZvaWQgaW50ZWxfaGRtaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgCWludGVsX2VuY29kZXIgPSAmaW50ZWxfZGlnX3BvcnQtPmJhc2U7Cj4gPiAtCWRy
bV9lbmNvZGVyX2luaXQoJmRldl9wcml2LT5kcm0sICZpbnRlbF9lbmNvZGVyLT5iYXNlLAo+ID4g
Kwlkcm1fZW5jb2Rlcl9pbml0KCZpOTE1LT5kcm0sICZpbnRlbF9lbmNvZGVyLT5iYXNlLAo+ID4g
ICAJCQkgJmludGVsX2hkbWlfZW5jX2Z1bmNzLCBEUk1fTU9ERV9FTkNPREVSX1RNRFMsCj4gPiAg
IAkJCSAiSERNSSAlYyIsIHBvcnRfbmFtZShwb3J0KSk7Cj4gPiAgIAlpbnRlbF9lbmNvZGVyLT5o
b3RwbHVnID0gaW50ZWxfZW5jb2Rlcl9ob3RwbHVnOwo+ID4gICAJaW50ZWxfZW5jb2Rlci0+Y29t
cHV0ZV9jb25maWcgPSBpbnRlbF9oZG1pX2NvbXB1dGVfY29uZmlnOwo+ID4gLQlpZiAoSEFTX1BD
SF9TUExJVChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpIHsKPiA+
ICAgCQlpbnRlbF9lbmNvZGVyLT5kaXNhYmxlID0gcGNoX2Rpc2FibGVfaGRtaTsKPiA+ICAgCQlp
bnRlbF9lbmNvZGVyLT5wb3N0X2Rpc2FibGUgPSBwY2hfcG9zdF9kaXNhYmxlX2hkbWk7Cj4gPiAg
IAl9IGVsc2Ugewo+ID4gQEAgLTMxNTIsMjIgKzMxNTIsMjIgQEAgdm9pZCBpbnRlbF9oZG1pX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJfQo+ID4gICAJaW50
ZWxfZW5jb2Rlci0+Z2V0X2h3X3N0YXRlID0gaW50ZWxfaGRtaV9nZXRfaHdfc3RhdGU7Cj4gPiAg
IAlpbnRlbF9lbmNvZGVyLT5nZXRfY29uZmlnID0gaW50ZWxfaGRtaV9nZXRfY29uZmlnOwo+ID4g
LQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0NIRVJSWVZJRVco
aTkxNSkpIHsKPiA+ICAgCQlpbnRlbF9lbmNvZGVyLT5wcmVfcGxsX2VuYWJsZSA9IGNodl9oZG1p
X3ByZV9wbGxfZW5hYmxlOwo+ID4gICAJCWludGVsX2VuY29kZXItPnByZV9lbmFibGUgPSBjaHZf
aGRtaV9wcmVfZW5hYmxlOwo+ID4gICAJCWludGVsX2VuY29kZXItPmVuYWJsZSA9IHZsdl9lbmFi
bGVfaGRtaTsKPiA+ICAgCQlpbnRlbF9lbmNvZGVyLT5wb3N0X2Rpc2FibGUgPSBjaHZfaGRtaV9w
b3N0X2Rpc2FibGU7Cj4gPiAgIAkJaW50ZWxfZW5jb2Rlci0+cG9zdF9wbGxfZGlzYWJsZSA9IGNo
dl9oZG1pX3Bvc3RfcGxsX2Rpc2FibGU7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhk
ZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKSB7Cj4gPiAg
IAkJaW50ZWxfZW5jb2Rlci0+cHJlX3BsbF9lbmFibGUgPSB2bHZfaGRtaV9wcmVfcGxsX2VuYWJs
ZTsKPiA+ICAgCQlpbnRlbF9lbmNvZGVyLT5wcmVfZW5hYmxlID0gdmx2X2hkbWlfcHJlX2VuYWJs
ZTsKPiA+ICAgCQlpbnRlbF9lbmNvZGVyLT5lbmFibGUgPSB2bHZfZW5hYmxlX2hkbWk7Cj4gPiAg
IAkJaW50ZWxfZW5jb2Rlci0+cG9zdF9kaXNhYmxlID0gdmx2X2hkbWlfcG9zdF9kaXNhYmxlOwo+
ID4gICAJfSBlbHNlIHsKPiA+ICAgCQlpbnRlbF9lbmNvZGVyLT5wcmVfZW5hYmxlID0gaW50ZWxf
aGRtaV9wcmVfZW5hYmxlOwo+ID4gLQkJaWYgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSkKPiA+ICsJ
CWlmIChIQVNfUENIX0NQVChpOTE1KSkKPiA+ICAgCQkJaW50ZWxfZW5jb2Rlci0+ZW5hYmxlID0g
Y3B0X2VuYWJsZV9oZG1pOwo+ID4gLQkJZWxzZSBpZiAoSEFTX1BDSF9JQlgoZGV2X3ByaXYpKQo+
ID4gKwkJZWxzZSBpZiAoSEFTX1BDSF9JQlgoaTkxNSkpCj4gPiAgIAkJCWludGVsX2VuY29kZXIt
PmVuYWJsZSA9IGlieF9lbmFibGVfaGRtaTsKPiA+ICAgCQllbHNlCj4gPiAgIAkJCWludGVsX2Vu
Y29kZXItPmVuYWJsZSA9IGc0eF9lbmFibGVfaGRtaTsKPiA+IEBAIC0zMTc2LDcgKzMxNzYsNyBA
QCB2b2lkIGludGVsX2hkbWlfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiAgIAlpbnRlbF9lbmNvZGVyLT50eXBlID0gSU5URUxfT1VUUFVUX0hETUk7Cj4gPiAgIAlp
bnRlbF9lbmNvZGVyLT5wb3dlcl9kb21haW4gPSBpbnRlbF9wb3J0X3RvX3Bvd2VyX2RvbWFpbihw
b3J0KTsKPiA+ICAgCWludGVsX2VuY29kZXItPnBvcnQgPSBwb3J0Owo+ID4gLQlpZiAoSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+
ICAgCQlpZiAocG9ydCA9PSBQT1JUX0QpCj4gPiAgIAkJCWludGVsX2VuY29kZXItPmNydGNfbWFz
ayA9IDEgPDwgMjsKPiA+ICAgCQllbHNlCj4gPiBAQCAtMzE5MCw3ICszMTkwLDcgQEAgdm9pZCBp
bnRlbF9oZG1pX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
ICogdG8gd29yayBvbiByZWFsIGhhcmR3YXJlLiBBbmQgc2luY2UgZzR4IGNhbiBzZW5kIGluZm9m
cmFtZXMgdG8KPiA+ICAgCSAqIG9ubHkgb25lIHBvcnQgYW55d2F5LCBub3RoaW5nIGlzIGxvc3Qg
YnkgYWxsb3dpbmcgaXQuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX0c0WChkZXZfcHJpdikpCj4g
PiArCWlmIChJU19HNFgoaTkxNSkpCj4gPiAgIAkJaW50ZWxfZW5jb2Rlci0+Y2xvbmVhYmxlIHw9
IDEgPDwgSU5URUxfT1VUUFVUX0hETUk7Cj4gPiAgIAlpbnRlbF9kaWdfcG9ydC0+aGRtaS5oZG1p
X3JlZyA9IGhkbWlfcmVnOwo+ID4gQEAgLTMxOTksNiArMzE5OSw2IEBAIHZvaWQgaW50ZWxfaGRt
aV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWludGVsX2lu
Zm9mcmFtZV9pbml0KGludGVsX2RpZ19wb3J0KTsKPiA+IC0JaW50ZWxfZGlnX3BvcnQtPmF1eF9j
aCA9IGludGVsX2Jpb3NfcG9ydF9hdXhfY2goZGV2X3ByaXYsIHBvcnQpOwo+ID4gKwlpbnRlbF9k
aWdfcG9ydC0+YXV4X2NoID0gaW50ZWxfYmlvc19wb3J0X2F1eF9jaChpOTE1LCBwb3J0KTsKPiA+
ICAgCWludGVsX2hkbWlfaW5pdF9jb25uZWN0b3IoaW50ZWxfZGlnX3BvcnQsIGludGVsX2Nvbm5l
Y3Rvcik7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9oZG1pLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9oZG1pLmgKPiA+IGluZGV4IDEw
NmMyZTBiYzNjOS4uNDZmMDMzNTZiNTRiIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfaGRtaS5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9o
ZG1pLmgKPiA+IEBAIC0yNCw3ICsyNCw3IEBAIHN0cnVjdCBpbnRlbF9oZG1pOwo+ID4gICBzdHJ1
Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZTsKPiA+ICAgdW5pb24gaGRtaV9pbmZvZnJhbWU7Cj4gPiAt
dm9pZCBpbnRlbF9oZG1pX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBp
OTE1X3JlZ190IGhkbWlfcmVnLAo+ID4gK3ZvaWQgaW50ZWxfaGRtaV9pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LCBpOTE1X3JlZ190IGhkbWlfcmVnLAo+ID4gICAJCSAgICAgZW51
bSBwb3J0IHBvcnQpOwo+ID4gICB2b2lkIGludGVsX2hkbWlfaW5pdF9jb25uZWN0b3Ioc3RydWN0
IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQsCj4gPiAgIAkJCSAgICAgICBzdHJ1
Y3QgaW50ZWxfY29ubmVjdG9yICppbnRlbF9jb25uZWN0b3IpOwo+ID4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hvdHBsdWcuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2hvdHBsdWcuYwo+ID4gaW5kZXggZmY5ZWIzYzg1NWQzLi5hNTUxYjlhYjJlMTcgMTAw
NjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ob3RwbHVnLmMKPiA+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2hvdHBsdWcuYwo+ID4gQEAgLTc4LDcgKzc4
LDcgQEAKPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2hwZF9waW5fZGVmYXVsdCAtIHJldHVybiBk
ZWZhdWx0IHBpbiBhc3NvY2lhdGVkIHdpdGggY2VydGFpbiBwb3J0Lgo+ID4gLSAqIEBkZXZfcHJp
djogcHJpdmF0ZSBkcml2ZXIgZGF0YSBwb2ludGVyCj4gPiArICogQGk5MTU6IHByaXZhdGUgZHJp
dmVyIGRhdGEgcG9pbnRlcgo+ID4gICAgKiBAcG9ydDogdGhlIGhwZCBwb3J0IHRvIGdldCBhc3Nv
Y2lhdGVkIHBpbgo+ID4gICAgKgo+ID4gICAgKiBJdCBpcyBvbmx5IHZhbGlkIGFuZCB1c2VkIGJ5
IGRpZ2l0YWwgcG9ydCBlbmNvZGVyLgo+ID4gQEAgLTg2LDcgKzg2LDcgQEAKPiA+ICAgICogUmV0
dXJuIHBpbiB0aGF0IGlzIGFzc29jaWF0YWRlIHdpdGggQHBvcnQgYW5kIEhEUF9OT05FIGlmIG5v
IHBpbiBpcwo+ID4gICAgKiBoYXJkIGFzc29jaWF0ZWQgd2l0aCB0aGF0IEBwb3J0Lgo+ID4gICAg
Ki8KPiA+IC1lbnVtIGhwZF9waW4gaW50ZWxfaHBkX3Bpbl9kZWZhdWx0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtlbnVtIGhwZF9waW4gaW50ZWxfaHBkX3Bpbl9kZWZh
dWx0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgZW51bSBwb3J0
IHBvcnQpCj4gPiAgIHsKPiA+ICAgCXN3aXRjaCAocG9ydCkgewo+ID4gQEAgLTEwMSw3ICsxMDEs
NyBAQCBlbnVtIGhwZF9waW4gaW50ZWxfaHBkX3Bpbl9kZWZhdWx0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWNhc2UgUE9SVF9FOgo+ID4gICAJCXJldHVybiBIUERf
UE9SVF9FOwo+ID4gICAJY2FzZSBQT1JUX0Y6Cj4gPiAtCQlpZiAoSVNfQ05MX1dJVEhfUE9SVF9G
KGRldl9wcml2KSkKPiA+ICsJCWlmIChJU19DTkxfV0lUSF9QT1JUX0YoaTkxNSkpCj4gPiAgIAkJ
CXJldHVybiBIUERfUE9SVF9FOwo+ID4gICAJCXJldHVybiBIUERfUE9SVF9GOwo+ID4gICAJZGVm
YXVsdDoKPiA+IEBAIC0xMTUsNyArMTE1LDcgQEAgZW51bSBocGRfcGluIGludGVsX2hwZF9waW5f
ZGVmYXVsdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIC8qKgo+ID4g
ICAgKiBpbnRlbF9ocGRfaXJxX3N0b3JtX2RldGVjdCAtIGdhdGhlciBzdGF0cyBhbmQgZGV0ZWN0
IEhQRCBJUlEgc3Rvcm0gb24gYSBwaW4KPiA+IC0gKiBAZGV2X3ByaXY6IHByaXZhdGUgZHJpdmVy
IGRhdGEgcG9pbnRlcgo+ID4gKyAqIEBpOTE1OiBwcml2YXRlIGRyaXZlciBkYXRhIHBvaW50ZXIK
PiA+ICAgICogQHBpbjogdGhlIHBpbiB0byBnYXRoZXIgc3RhdHMgb24KPiA+ICAgICogQGxvbmdf
aHBkOiB3aGV0aGVyIHRoZSBIUEQgSVJRIHdhcyBsb25nIG9yIHNob3J0Cj4gPiAgICAqCj4gPiBA
QCAtMTI0LDEzICsxMjQsMTMgQEAgZW51bSBocGRfcGluIGludGVsX2hwZF9waW5fZGVmYXVsdChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgICAqIHJlc3BvbnNpYmxlIGZv
ciBmdXJ0aGVyIGFjdGlvbi4KPiA+ICAgICoKPiA+ICAgICogVGhlIG51bWJlciBvZiBJUlFzIHRo
YXQgYXJlIGFsbG93ZWQgd2l0aGluIEBIUERfU1RPUk1fREVURUNUX1BFUklPRCBpcwo+ID4gLSAq
IHN0b3JlZCBpbiBAZGV2X3ByaXYtPmhvdHBsdWcuaHBkX3N0b3JtX3RocmVzaG9sZCB3aGljaCBk
ZWZhdWx0cyB0bwo+ID4gKyAqIHN0b3JlZCBpbiBAaTkxNS0+aG90cGx1Zy5ocGRfc3Rvcm1fdGhy
ZXNob2xkIHdoaWNoIGRlZmF1bHRzIHRvCj4gPiAgICAqIEBIUERfU1RPUk1fREVGQVVMVF9USFJF
U0hPTEQuIExvbmcgSVJRcyBjb3VudCBhcyArMTAgdG8gdGhpcyB0aHJlc2hvbGQsIGFuZAo+ID4g
ICAgKiBzaG9ydCBJUlFzIGNvdW50IGFzICsxLiBJZiB0aGlzIHRocmVzaG9sZCBpcyBleGNlZWRl
ZCwgaXQncyBjb25zaWRlcmVkIGFuCj4gPiAgICAqIElSUSBzdG9ybSBhbmQgdGhlIElSUSBzdGF0
ZSBpcyBzZXQgdG8gQEhQRF9NQVJLX0RJU0FCTEVELgo+ID4gICAgKgo+ID4gICAgKiBCeSBkZWZh
dWx0LCBtb3N0IHN5c3RlbXMgd2lsbCBvbmx5IGNvdW50IGxvbmcgSVJRcyB0b3dhcmRzCj4gPiAt
ICogJmRldl9wcml2LT5ob3RwbHVnLmhwZF9zdG9ybV90aHJlc2hvbGQuIEhvd2V2ZXIsIHNvbWUg
b2xkZXIgc3lzdGVtcyBhbHNvCj4gPiArICogJmk5MTUtPmhvdHBsdWcuaHBkX3N0b3JtX3RocmVz
aG9sZC4gSG93ZXZlciwgc29tZSBvbGRlciBzeXN0ZW1zIGFsc28KPiA+ICAgICogc3VmZmVyIGZy
b20gc2hvcnQgSVJRIHN0b3JtcyBhbmQgbXVzdCBhbHNvIHRyYWNrIHRoZXNlLiBCZWNhdXNlIHNo
b3J0IElSUQo+ID4gICAgKiBzdG9ybXMgYXJlIG5hdHVyYWxseSBjYXVzZWQgYnkgc2lkZWJhbmQg
aW50ZXJhY3Rpb25zIHdpdGggRFAgTVNUIGRldmljZXMsCj4gPiAgICAqIHNob3J0IElSUSBkZXRl
Y3Rpb24gaXMgb25seSBlbmFibGVkIGZvciBzeXN0ZW1zIHdpdGhvdXQgRFAgTVNUIHN1cHBvcnQu
Cj4gPiBAQCAtMTQyLDEwICsxNDIsMTAgQEAgZW51bSBocGRfcGluIGludGVsX2hwZF9waW5fZGVm
YXVsdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgICAqCj4gPiAgICAq
IFJldHVybiB0cnVlIGlmIGFuIElSUSBzdG9ybSB3YXMgZGV0ZWN0ZWQgb24gQHBpbi4KPiA+ICAg
ICovCj4gPiAtc3RhdGljIGJvb2wgaW50ZWxfaHBkX2lycV9zdG9ybV9kZXRlY3Qoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBib29sIGludGVsX2hwZF9pcnFf
c3Rvcm1fZGV0ZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAg
ICAgIGVudW0gaHBkX3BpbiBwaW4sIGJvb2wgbG9uZ19ocGQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGk5MTVfaG90cGx1ZyAqaHBkID0gJmRldl9wcml2LT5ob3RwbHVnOwo+ID4gKwlzdHJ1Y3QgaTkx
NV9ob3RwbHVnICpocGQgPSAmaTkxNS0+aG90cGx1ZzsKPiA+ICAgCXVuc2lnbmVkIGxvbmcgc3Rh
cnQgPSBocGQtPnN0YXRzW3Bpbl0ubGFzdF9qaWZmaWVzOwo+ID4gICAJdW5zaWduZWQgbG9uZyBl
bmQgPSBzdGFydCArIG1zZWNzX3RvX2ppZmZpZXMoSFBEX1NUT1JNX0RFVEVDVF9QRVJJT0QpOwo+
ID4gICAJY29uc3QgaW50IGluY3JlbWVudCA9IGxvbmdfaHBkID8gMTAgOiAxOwo+ID4gQEAgLTE1
Myw3ICsxNTMsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9ocGRfaXJxX3N0b3JtX2RldGVjdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlib29sIHN0b3JtID0gZmFsc2U7
Cj4gPiAgIAlpZiAoIXRocmVzaG9sZCB8fAo+ID4gLQkgICAgKCFsb25nX2hwZCAmJiAhZGV2X3By
aXYtPmhvdHBsdWcuaHBkX3Nob3J0X3N0b3JtX2VuYWJsZWQpKQo+ID4gKwkgICAgKCFsb25nX2hw
ZCAmJiAhaTkxNS0+aG90cGx1Zy5ocGRfc2hvcnRfc3Rvcm1fZW5hYmxlZCkpCj4gPiAgIAkJcmV0
dXJuIGZhbHNlOwo+ID4gICAJaWYgKCF0aW1lX2luX3JhbmdlKGppZmZpZXMsIHN0YXJ0LCBlbmQp
KSB7Cj4gPiBAQCAtMTc1LDkgKzE3NSw5IEBAIHN0YXRpYyBib29sIGludGVsX2hwZF9pcnFfc3Rv
cm1fZGV0ZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgfQo+ID4g
ICBzdGF0aWMgdm9pZAo+ID4gLWludGVsX2hwZF9pcnFfc3Rvcm1fc3dpdGNoX3RvX3BvbGxpbmco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludGVsX2hwZF9pcnFfc3Rv
cm1fc3dpdGNoX3RvX3BvbGxpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+ID4gKwlz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmludGVsX2Nvbm5lY3RvcjsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICpp
bnRlbF9lbmNvZGVyOwo+ID4gICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcjsKPiA+
IEBAIC0xODUsNyArMTg1LDcgQEAgaW50ZWxfaHBkX2lycV9zdG9ybV9zd2l0Y2hfdG9fcG9sbGlu
ZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAllbnVtIGhwZF9waW4g
cGluOwo+ID4gICAJYm9vbCBocGRfZGlzYWJsZWQgPSBmYWxzZTsKPiA+IC0JbG9ja2RlcF9hc3Nl
cnRfaGVsZCgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgm
aTkxNS0+aXJxX2xvY2spOwo+ID4gICAJZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXJfYmVnaW4oZGV2
LCAmY29ubl9pdGVyKTsKPiA+ICAgCWRybV9mb3JfZWFjaF9jb25uZWN0b3JfaXRlcihjb25uZWN0
b3IsICZjb25uX2l0ZXIpIHsKPiA+IEBAIC0xOTksMTQgKzE5OSwxNCBAQCBpbnRlbF9ocGRfaXJx
X3N0b3JtX3N3aXRjaF90b19wb2xsaW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICAgCQlwaW4gPSBpbnRlbF9lbmNvZGVyLT5ocGRfcGluOwo+ID4gICAJCWlmIChwaW4g
PT0gSFBEX05PTkUgfHwKPiA+IC0JCSAgICBkZXZfcHJpdi0+aG90cGx1Zy5zdGF0c1twaW5dLnN0
YXRlICE9IEhQRF9NQVJLX0RJU0FCTEVEKQo+ID4gKwkJICAgIGk5MTUtPmhvdHBsdWcuc3RhdHNb
cGluXS5zdGF0ZSAhPSBIUERfTUFSS19ESVNBQkxFRCkKPiA+ICAgCQkJY29udGludWU7Cj4gPiAg
IAkJRFJNX0lORk8oIkhQRCBpbnRlcnJ1cHQgc3Rvcm0gZGV0ZWN0ZWQgb24gY29ubmVjdG9yICVz
OiAiCj4gPiAgIAkJCSAic3dpdGNoaW5nIGZyb20gaG90cGx1ZyBkZXRlY3Rpb24gdG8gcG9sbGlu
Z1xuIiwKPiA+ICAgCQkJIGNvbm5lY3Rvci0+bmFtZSk7Cj4gPiAtCQlkZXZfcHJpdi0+aG90cGx1
Zy5zdGF0c1twaW5dLnN0YXRlID0gSFBEX0RJU0FCTEVEOwo+ID4gKwkJaTkxNS0+aG90cGx1Zy5z
dGF0c1twaW5dLnN0YXRlID0gSFBEX0RJU0FCTEVEOwo+ID4gICAJCWNvbm5lY3Rvci0+cG9sbGVk
ID0gRFJNX0NPTk5FQ1RPUl9QT0xMX0NPTk5FQ1QKPiA+ICAgCQkJfCBEUk1fQ09OTkVDVE9SX1BP
TExfRElTQ09OTkVDVDsKPiA+ICAgCQlocGRfZGlzYWJsZWQgPSB0cnVlOwo+ID4gQEAgLTIxNiwz
MSArMjE2LDMxIEBAIGludGVsX2hwZF9pcnFfc3Rvcm1fc3dpdGNoX3RvX3BvbGxpbmcoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJLyogRW5hYmxlIHBvbGxpbmcgYW5k
IHF1ZXVlIGhvdHBsdWcgcmUtZW5hYmxpbmcuICovCj4gPiAgIAlpZiAoaHBkX2Rpc2FibGVkKSB7
Cj4gPiAgIAkJZHJtX2ttc19oZWxwZXJfcG9sbF9lbmFibGUoZGV2KTsKPiA+IC0JCW1vZF9kZWxh
eWVkX3dvcmsoc3lzdGVtX3dxLCAmZGV2X3ByaXYtPmhvdHBsdWcucmVlbmFibGVfd29yaywKPiA+
ICsJCW1vZF9kZWxheWVkX3dvcmsoc3lzdGVtX3dxLCAmaTkxNS0+aG90cGx1Zy5yZWVuYWJsZV93
b3JrLAo+ID4gICAJCQkJIG1zZWNzX3RvX2ppZmZpZXMoSFBEX1NUT1JNX1JFRU5BQkxFX0RFTEFZ
KSk7Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfaHBkX2lycV9zdG9y
bV9yZWVuYWJsZV93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgewo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gLQkJY29udGFpbmVyX29mKHdv
cmssIHR5cGVvZigqZGV2X3ByaXYpLAo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9Cj4gPiArCQljb250YWluZXJfb2Yod29yaywgdHlwZW9mKCppOTE1KSwKPiA+ICAgCQkJICAg
ICBob3RwbHVnLnJlZW5hYmxlX3dvcmsud29yayk7Cj4gPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSAmZGV2X3ByaXYtPmRybTsKPiA+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZpOTE1
LT5kcm07Cj4gPiAgIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCWVudW0gaHBkX3Bp
biBwaW47Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7Cj4g
PiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiA+IC0Jc3Bpbl9sb2Nr
X2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJx
X2xvY2spOwo+ID4gICAJZm9yX2VhY2hfaHBkX3BpbihwaW4pIHsKPiA+ICAgCQlzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yOwo+ID4gICAJCXN0cnVjdCBkcm1fY29ubmVjdG9yX2xpc3Rf
aXRlciBjb25uX2l0ZXI7Cj4gPiAtCQlpZiAoZGV2X3ByaXYtPmhvdHBsdWcuc3RhdHNbcGluXS5z
dGF0ZSAhPSBIUERfRElTQUJMRUQpCj4gPiArCQlpZiAoaTkxNS0+aG90cGx1Zy5zdGF0c1twaW5d
LnN0YXRlICE9IEhQRF9ESVNBQkxFRCkKPiA+ICAgCQkJY29udGludWU7Cj4gPiAtCQlkZXZfcHJp
di0+aG90cGx1Zy5zdGF0c1twaW5dLnN0YXRlID0gSFBEX0VOQUJMRUQ7Cj4gPiArCQlpOTE1LT5o
b3RwbHVnLnN0YXRzW3Bpbl0uc3RhdGUgPSBIUERfRU5BQkxFRDsKPiA+ICAgCQlkcm1fY29ubmVj
dG9yX2xpc3RfaXRlcl9iZWdpbihkZXYsICZjb25uX2l0ZXIpOwo+ID4gICAJCWRybV9mb3JfZWFj
aF9jb25uZWN0b3JfaXRlcihjb25uZWN0b3IsICZjb25uX2l0ZXIpIHsKPiA+IEBAIC0yNTksMTEg
KzI1OSwxMSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9ocGRfaXJxX3N0b3JtX3JlZW5hYmxlX3dvcmso
c3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ID4gICAJCX0KPiA+ICAgCQlkcm1fY29ubmVjdG9y
X2xpc3RfaXRlcl9lbmQoJmNvbm5faXRlcik7Cj4gPiAgIAl9Cj4gPiAtCWlmIChkZXZfcHJpdi0+
ZGlzcGxheV9pcnFzX2VuYWJsZWQgJiYgZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCkK
PiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAoZGV2X3ByaXYpOwo+ID4gLQlz
cGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCWlmIChpOTE1LT5kaXNw
bGF5X2lycXNfZW5hYmxlZCAmJiBpOTE1LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXApCj4gPiArCQlp
OTE1LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAoaTkxNSk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycSgm
aTkxNS0+aXJxX2xvY2spOwo+ID4gLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2Fr
ZXJlZik7Cj4gPiArCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOwo+ID4gICB9
Cj4gPiAgIGJvb2wgaW50ZWxfZW5jb2Rlcl9ob3RwbHVnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ID4gQEAgLTI5OCwyMCArMjk4LDIwIEBAIHN0YXRpYyBib29sIGludGVsX2VuY29k
ZXJfaGFzX2hwZF9wdWxzZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgc3Rh
dGljIHZvaWQgaTkxNV9kaWdwb3J0X3dvcmtfZnVuYyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmsp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ID4gICAJCWNvbnRhaW5lcl9vZih3b3Jr
LCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwgaG90cGx1Zy5kaWdfcG9ydF93b3JrKTsKPiA+ICAg
CXUzMiBsb25nX3BvcnRfbWFzaywgc2hvcnRfcG9ydF9tYXNrOwo+ID4gICAJc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXI7Cj4gPiAgIAl1MzIgb2xkX2JpdHMgPSAwOwo+ID4gLQlzcGluX2xv
Y2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gLQlsb25nX3BvcnRfbWFzayA9IGRldl9w
cml2LT5ob3RwbHVnLmxvbmdfcG9ydF9tYXNrOwo+ID4gLQlkZXZfcHJpdi0+aG90cGx1Zy5sb25n
X3BvcnRfbWFzayA9IDA7Cj4gPiAtCXNob3J0X3BvcnRfbWFzayA9IGRldl9wcml2LT5ob3RwbHVn
LnNob3J0X3BvcnRfbWFzazsKPiA+IC0JZGV2X3ByaXYtPmhvdHBsdWcuc2hvcnRfcG9ydF9tYXNr
ID0gMDsKPiA+IC0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlz
cGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiArCWxvbmdfcG9ydF9tYXNrID0gaTkx
NS0+aG90cGx1Zy5sb25nX3BvcnRfbWFzazsKPiA+ICsJaTkxNS0+aG90cGx1Zy5sb25nX3BvcnRf
bWFzayA9IDA7Cj4gPiArCXNob3J0X3BvcnRfbWFzayA9IGk5MTUtPmhvdHBsdWcuc2hvcnRfcG9y
dF9tYXNrOwo+ID4gKwlpOTE1LT5ob3RwbHVnLnNob3J0X3BvcnRfbWFzayA9IDA7Cj4gPiArCXNw
aW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9lbmNv
ZGVyKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7Cj4gPiArCWZvcl9lYWNoX2ludGVsX2VuY29k
ZXIoJmk5MTUtPmRybSwgZW5jb2Rlcikgewo+ID4gICAJCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3Bv
cnQgKmRpZ19wb3J0Owo+ID4gICAJCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPiA+
ICAgCQlib29sIGxvbmdfaHBkLCBzaG9ydF9ocGQ7Cj4gPiBAQCAtMzM2LDEwICszMzYsMTAgQEAg
c3RhdGljIHZvaWQgaTkxNV9kaWdwb3J0X3dvcmtfZnVuYyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndv
cmspCj4gPiAgIAl9Cj4gPiAgIAlpZiAob2xkX2JpdHMpIHsKPiA+IC0JCXNwaW5fbG9ja19pcnEo
JmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAtCQlkZXZfcHJpdi0+aG90cGx1Zy5ldmVudF9iaXRz
IHw9IG9sZF9iaXRzOwo+ID4gLQkJc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2sp
Owo+ID4gLQkJc2NoZWR1bGVfd29yaygmZGV2X3ByaXYtPmhvdHBsdWcuaG90cGx1Z193b3JrKTsK
PiA+ICsJCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICsJCWk5MTUtPmhvdHBs
dWcuZXZlbnRfYml0cyB8PSBvbGRfYml0czsKPiA+ICsJCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+
aXJxX2xvY2spOwo+ID4gKwkJc2NoZWR1bGVfd29yaygmaTkxNS0+aG90cGx1Zy5ob3RwbHVnX3dv
cmspOwo+ID4gICAJfQo+ID4gICB9Cj4gPiBAQCAtMzQ4LDkgKzM0OCw5IEBAIHN0YXRpYyB2b2lk
IGk5MTVfZGlncG9ydF93b3JrX2Z1bmMoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ID4gICAg
Ki8KPiA+ICAgc3RhdGljIHZvaWQgaTkxNV9ob3RwbHVnX3dvcmtfZnVuYyhzdHJ1Y3Qgd29ya19z
dHJ1Y3QgKndvcmspCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ID4gICAJCWNvbnRh
aW5lcl9vZih3b3JrLCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwgaG90cGx1Zy5ob3RwbHVnX3dv
cmspOwo+ID4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gPiAr
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ID4gICAJc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9yOwo+ID4gICAJc3RydWN0IGludGVsX2VuY29kZXIg
KmludGVsX2VuY29kZXI7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yOwo+
ID4gQEAgLTM2MSwxNSArMzYxLDE1IEBAIHN0YXRpYyB2b2lkIGk5MTVfaG90cGx1Z193b3JrX2Z1
bmMoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQo+ID4gICAJbXV0ZXhfbG9jaygmZGV2LT5tb2Rl
X2NvbmZpZy5tdXRleCk7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJydW5uaW5nIGVuY29kZXIgaG90
cGx1ZyBmdW5jdGlvbnNcbiIpOwo+ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xv
Y2spOwo+ID4gKwlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAtCWhwZF9ldmVu
dF9iaXRzID0gZGV2X3ByaXYtPmhvdHBsdWcuZXZlbnRfYml0czsKPiA+IC0JZGV2X3ByaXYtPmhv
dHBsdWcuZXZlbnRfYml0cyA9IDA7Cj4gPiArCWhwZF9ldmVudF9iaXRzID0gaTkxNS0+aG90cGx1
Zy5ldmVudF9iaXRzOwo+ID4gKwlpOTE1LT5ob3RwbHVnLmV2ZW50X2JpdHMgPSAwOwo+ID4gICAJ
LyogRW5hYmxlIHBvbGxpbmcgZm9yIGNvbm5lY3RvcnMgd2hpY2ggaGFkIEhQRCBJUlEgc3Rvcm1z
ICovCj4gPiAtCWludGVsX2hwZF9pcnFfc3Rvcm1fc3dpdGNoX3RvX3BvbGxpbmcoZGV2X3ByaXYp
Owo+ID4gKwlpbnRlbF9ocGRfaXJxX3N0b3JtX3N3aXRjaF90b19wb2xsaW5nKGk5MTUpOwo+ID4g
LQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCXNwaW5fdW5sb2Nr
X2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gICAJZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXJfYmVn
aW4oZGV2LCAmY29ubl9pdGVyKTsKPiA+ICAgCWRybV9mb3JfZWFjaF9jb25uZWN0b3JfaXRlcihj
b25uZWN0b3IsICZjb25uX2l0ZXIpIHsKPiA+IEBAIC0zOTUsNyArMzk1LDcgQEAgc3RhdGljIHZv
aWQgaTkxNV9ob3RwbHVnX3dvcmtfZnVuYyhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiAg
IC8qKgo+ID4gICAgKiBpbnRlbF9ocGRfaXJxX2hhbmRsZXIgLSBtYWluIGhvdHBsdWcgaXJxIGhh
bmRsZXIKPiA+IC0gKiBAZGV2X3ByaXY6IGRybV9pOTE1X3ByaXZhdGUKPiA+ICsgKiBAaTkxNTog
ZHJtX2k5MTVfcHJpdmF0ZQo+ID4gICAgKiBAcGluX21hc2s6IGEgbWFzayBvZiBocGQgcGlucyB0
aGF0IGhhdmUgdHJpZ2dlcmVkIHRoZSBpcnEKPiA+ICAgICogQGxvbmdfbWFzazogYSBtYXNrIG9m
IGhwZCBwaW5zIHRoYXQgbWF5IGJlIGxvbmcgaHBkIHB1bHNlcwo+ID4gICAgKgo+ID4gQEAgLTQw
OSw3ICs0MDksNyBAQCBzdGF0aWMgdm9pZCBpOTE1X2hvdHBsdWdfd29ya19mdW5jKHN0cnVjdCB3
b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgICogSGVyZSwgd2UgZG8gaG90cGx1ZyBpcnEgc3Rvcm0g
ZGV0ZWN0aW9uIGFuZCBtaXRpZ2F0aW9uLCBhbmQgcGFzcyBmdXJ0aGVyCj4gPiAgICAqIHByb2Nl
c3NpbmcgdG8gYXBwcm9wcmlhdGUgYm90dG9tIGhhbHZlcy4KPiA+ICAgICovCj4gPiAtdm9pZCBp
bnRlbF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3ZvaWQgaW50ZWxfaHBkX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ID4gICAJCQkgICB1MzIgcGluX21hc2ssIHUzMiBsb25nX21hc2spCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ID4gQEAgLTQyMiw3ICs0MjIsNyBA
QCB2b2lkIGludGVsX2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAgIAlpZiAoIXBpbl9tYXNrKQo+ID4gICAJCXJldHVybjsKPiA+IC0Jc3Bpbl9s
b2NrKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGluX2xvY2soJmk5MTUtPmlycV9sb2Nr
KTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBEZXRlcm1pbmUgd2hldGhlciAtPmhwZF9wdWxzZSgpIGV4
aXN0cyBmb3IgZWFjaCBwaW4sIGFuZAo+ID4gQEAgLTQzMCw3ICs0MzAsNyBAQCB2b2lkIGludGVs
X2hwZF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAg
IAkgKiBhcyBlYWNoIHBpbiBtYXkgaGF2ZSB1cCB0byB0d28gZW5jb2RlcnMgKEhETUkgYW5kIERQ
KSBhbmQKPiA+ICAgCSAqIG9ubHkgdGhlIG9uZSBvZiB0aGVtIChEUCkgd2lsbCBoYXZlIC0+aHBk
X3B1bHNlKCkuCj4gPiAgIAkgKi8KPiA+IC0JZm9yX2VhY2hfaW50ZWxfZW5jb2RlcigmZGV2X3By
aXYtPmRybSwgZW5jb2Rlcikgewo+ID4gKwlmb3JfZWFjaF9pbnRlbF9lbmNvZGVyKCZpOTE1LT5k
cm0sIGVuY29kZXIpIHsKPiA+ICAgCQlib29sIGhhc19ocGRfcHVsc2UgPSBpbnRlbF9lbmNvZGVy
X2hhc19ocGRfcHVsc2UoZW5jb2Rlcik7Cj4gPiAgIAkJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVy
LT5wb3J0Owo+ID4gICAJCWJvb2wgbG9uZ19ocGQ7Cj4gPiBAQCAtNDUwLDEwICs0NTAsMTAgQEAg
dm9pZCBpbnRlbF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gICAJCWlmIChsb25nX2hwZCkgewo+ID4gICAJCQlsb25nX2hwZF9wdWxzZV9tYXNr
IHw9IEJJVChwaW4pOwo+ID4gLQkJCWRldl9wcml2LT5ob3RwbHVnLmxvbmdfcG9ydF9tYXNrIHw9
IEJJVChwb3J0KTsKPiA+ICsJCQlpOTE1LT5ob3RwbHVnLmxvbmdfcG9ydF9tYXNrIHw9IEJJVChw
b3J0KTsKPiA+ICAgCQl9IGVsc2Ugewo+ID4gICAJCQlzaG9ydF9ocGRfcHVsc2VfbWFzayB8PSBC
SVQocGluKTsKPiA+IC0JCQlkZXZfcHJpdi0+aG90cGx1Zy5zaG9ydF9wb3J0X21hc2sgfD0gQklU
KHBvcnQpOwo+ID4gKwkJCWk5MTUtPmhvdHBsdWcuc2hvcnRfcG9ydF9tYXNrIHw9IEJJVChwb3J0
KTsKPiA+ICAgCQl9Cj4gPiAgIAl9Cj4gPiBAQCAtNDY0LDE5ICs0NjQsMTkgQEAgdm9pZCBpbnRl
bF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
ICAJCWlmICghKEJJVChwaW4pICYgcGluX21hc2spKQo+ID4gICAJCQljb250aW51ZTsKPiA+IC0J
CWlmIChkZXZfcHJpdi0+aG90cGx1Zy5zdGF0c1twaW5dLnN0YXRlID09IEhQRF9ESVNBQkxFRCkg
ewo+ID4gKwkJaWYgKGk5MTUtPmhvdHBsdWcuc3RhdHNbcGluXS5zdGF0ZSA9PSBIUERfRElTQUJM
RUQpIHsKPiA+ICAgCQkJLyoKPiA+ICAgCQkJICogT24gR01DSCBwbGF0Zm9ybXMgdGhlIGludGVy
cnVwdCBtYXNrIGJpdHMgb25seQo+ID4gICAJCQkgKiBwcmV2ZW50IGlycSBnZW5lcmF0aW9uLCBu
b3QgdGhlIHNldHRpbmcgb2YgdGhlCj4gPiAgIAkJCSAqIGhvdHBsdWcgYml0cyBpdHNlbGYuIFNv
IG9ubHkgV0FSTiBhYm91dCB1bmV4cGVjdGVkCj4gPiAgIAkJCSAqIGludGVycnVwdHMgb24gc2Fu
ZXIgcGxhdGZvcm1zLgo+ID4gICAJCQkgKi8KPiA+IC0JCQlXQVJOX09OQ0UoIUhBU19HTUNIKGRl
dl9wcml2KSwKPiA+ICsJCQlXQVJOX09OQ0UoIUhBU19HTUNIKGk5MTUpLAo+ID4gICAJCQkJICAi
UmVjZWl2ZWQgSFBEIGludGVycnVwdCBvbiBwaW4gJWQgYWx0aG91Z2ggZGlzYWJsZWRcbiIsIHBp
bik7Cj4gPiAgIAkJCWNvbnRpbnVlOwo+ID4gICAJCX0KPiA+IC0JCWlmIChkZXZfcHJpdi0+aG90
cGx1Zy5zdGF0c1twaW5dLnN0YXRlICE9IEhQRF9FTkFCTEVEKQo+ID4gKwkJaWYgKGk5MTUtPmhv
dHBsdWcuc3RhdHNbcGluXS5zdGF0ZSAhPSBIUERfRU5BQkxFRCkKPiA+ICAgCQkJY29udGludWU7
Cj4gPiAgIAkJLyoKPiA+IEBAIC00ODcsMTMgKzQ4NywxMyBAQCB2b2lkIGludGVsX2hwZF9pcnFf
aGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJaWYgKCgo
c2hvcnRfaHBkX3B1bHNlX21hc2sgfCBsb25nX2hwZF9wdWxzZV9tYXNrKSAmIEJJVChwaW4pKSkg
ewo+ID4gICAJCQlsb25nX2hwZCA9IGxvbmdfaHBkX3B1bHNlX21hc2sgJiBCSVQocGluKTsKPiA+
ICAgCQl9IGVsc2Ugewo+ID4gLQkJCWRldl9wcml2LT5ob3RwbHVnLmV2ZW50X2JpdHMgfD0gQklU
KHBpbik7Cj4gPiArCQkJaTkxNS0+aG90cGx1Zy5ldmVudF9iaXRzIHw9IEJJVChwaW4pOwo+ID4g
ICAJCQlsb25nX2hwZCA9IHRydWU7Cj4gPiAgIAkJCXF1ZXVlX2hwID0gdHJ1ZTsKPiA+ICAgCQl9
Cj4gPiAtCQlpZiAoaW50ZWxfaHBkX2lycV9zdG9ybV9kZXRlY3QoZGV2X3ByaXYsIHBpbiwgbG9u
Z19ocGQpKSB7Cj4gPiAtCQkJZGV2X3ByaXYtPmhvdHBsdWcuZXZlbnRfYml0cyAmPSB+QklUKHBp
bik7Cj4gPiArCQlpZiAoaW50ZWxfaHBkX2lycV9zdG9ybV9kZXRlY3QoaTkxNSwgcGluLCBsb25n
X2hwZCkpIHsKPiA+ICsJCQlpOTE1LT5ob3RwbHVnLmV2ZW50X2JpdHMgJj0gfkJJVChwaW4pOwo+
ID4gICAJCQlzdG9ybV9kZXRlY3RlZCA9IHRydWU7Cj4gPiAgIAkJCXF1ZXVlX2hwID0gdHJ1ZTsK
PiA+ICAgCQl9Cj4gPiBAQCAtNTAzLDkgKzUwMyw5IEBAIHZvaWQgaW50ZWxfaHBkX2lycV9oYW5k
bGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCSAqIERpc2FibGUg
YW55IElSUXMgdGhhdCBzdG9ybXMgd2VyZSBkZXRlY3RlZCBvbi4gUG9sbGluZyBlbmFibGVtZW50
Cj4gPiAgIAkgKiBoYXBwZW5zIGxhdGVyIGluIG91ciBob3RwbHVnIHdvcmsuCj4gPiAgIAkgKi8K
PiA+IC0JaWYgKHN0b3JtX2RldGVjdGVkICYmIGRldl9wcml2LT5kaXNwbGF5X2lycXNfZW5hYmxl
ZCkKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAoZGV2X3ByaXYpOwo+ID4g
LQlzcGluX3VubG9jaygmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJaWYgKHN0b3JtX2RldGVj
dGVkICYmIGk5MTUtPmRpc3BsYXlfaXJxc19lbmFibGVkKQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5o
cGRfaXJxX3NldHVwKGk5MTUpOwo+ID4gKwlzcGluX3VubG9jaygmaTkxNS0+aXJxX2xvY2spOwo+
ID4gICAJLyoKPiA+ICAgCSAqIE91ciBob3RwbHVnIGhhbmRsZXIgY2FuIGdyYWIgbW9kZXNldCBs
b2NrcyAoYnkgY2FsbGluZyBkb3duIGludG8gdGhlCj4gPiBAQCAtNTE0LDE0ICs1MTQsMTQgQEAg
dm9pZCBpbnRlbF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gICAJICogZGVhZGxvY2suCj4gPiAgIAkgKi8KPiA+ICAgCWlmIChxdWV1ZV9kaWcp
Cj4gPiAtCQlxdWV1ZV93b3JrKGRldl9wcml2LT5ob3RwbHVnLmRwX3dxLCAmZGV2X3ByaXYtPmhv
dHBsdWcuZGlnX3BvcnRfd29yayk7Cj4gPiArCQlxdWV1ZV93b3JrKGk5MTUtPmhvdHBsdWcuZHBf
d3EsICZpOTE1LT5ob3RwbHVnLmRpZ19wb3J0X3dvcmspOwo+ID4gICAJaWYgKHF1ZXVlX2hwKQo+
ID4gLQkJc2NoZWR1bGVfd29yaygmZGV2X3ByaXYtPmhvdHBsdWcuaG90cGx1Z193b3JrKTsKPiA+
ICsJCXNjaGVkdWxlX3dvcmsoJmk5MTUtPmhvdHBsdWcuaG90cGx1Z193b3JrKTsKPiA+ICAgfQo+
ID4gICAvKioKPiA+ICAgICogaW50ZWxfaHBkX2luaXQgLSBpbml0aWFsaXplcyBhbmQgZW5hYmxl
cyBocGQgc3VwcG9ydAo+ID4gLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+
ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKPiA+ICAgICoKPiA+ICAgICogVGhpcyBm
dW5jdGlvbiBlbmFibGVzIHRoZSBob3RwbHVnIHN1cHBvcnQuIEl0IHJlcXVpcmVzIHRoYXQgaW50
ZXJydXB0cyBoYXZlCj4gPiAgICAqIGFscmVhZHkgYmVlbiBlbmFibGVkIHdpdGggaW50ZWxfaXJx
X2luaXRfaHcoKS4gRnJvbSB0aGlzIHBvaW50IG9uIGhvdHBsdWcgYW5kCj4gPiBAQCAtNTMzLDQz
ICs1MzMsNDMgQEAgdm9pZCBpbnRlbF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gICAgKgo+ID4gICAgKiBBbHNvIHNlZTogaW50ZWxfaHBkX3Bv
bGxfaW5pdCgpLCB3aGljaCBlbmFibGVzIGNvbm5lY3RvciBwb2xsaW5nCj4gPiAgICAqLwo+ID4g
LXZvaWQgaW50ZWxfaHBkX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gK3ZvaWQgaW50ZWxfaHBkX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+ICAgCWludCBpOwo+ID4gICAJZm9yX2VhY2hfaHBkX3BpbihpKSB7Cj4gPiAtCQlk
ZXZfcHJpdi0+aG90cGx1Zy5zdGF0c1tpXS5jb3VudCA9IDA7Cj4gPiAtCQlkZXZfcHJpdi0+aG90
cGx1Zy5zdGF0c1tpXS5zdGF0ZSA9IEhQRF9FTkFCTEVEOwo+ID4gKwkJaTkxNS0+aG90cGx1Zy5z
dGF0c1tpXS5jb3VudCA9IDA7Cj4gPiArCQlpOTE1LT5ob3RwbHVnLnN0YXRzW2ldLnN0YXRlID0g
SFBEX0VOQUJMRUQ7Cj4gPiAgIAl9Cj4gPiAtCVdSSVRFX09OQ0UoZGV2X3ByaXYtPmhvdHBsdWcu
cG9sbF9lbmFibGVkLCBmYWxzZSk7Cj4gPiAtCXNjaGVkdWxlX3dvcmsoJmRldl9wcml2LT5ob3Rw
bHVnLnBvbGxfaW5pdF93b3JrKTsKPiA+ICsJV1JJVEVfT05DRShpOTE1LT5ob3RwbHVnLnBvbGxf
ZW5hYmxlZCwgZmFsc2UpOwo+ID4gKwlzY2hlZHVsZV93b3JrKCZpOTE1LT5ob3RwbHVnLnBvbGxf
aW5pdF93b3JrKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBJbnRlcnJ1cHQgc2V0dXAgaXMgYWxyZWFk
eSBndWFyYW50ZWVkIHRvIGJlIHNpbmdsZS10aHJlYWRlZCwgdGhpcyBpcwo+ID4gICAJICoganVz
dCB0byBtYWtlIHRoZSBhc3NlcnRfc3Bpbl9sb2NrZWQgY2hlY2tzIGhhcHB5Lgo+ID4gICAJICov
Cj4gPiAtCWlmIChkZXZfcHJpdi0+ZGlzcGxheV9pcnFzX2VuYWJsZWQgJiYgZGV2X3ByaXYtPmRp
c3BsYXkuaHBkX2lycV9zZXR1cCkgewo+ID4gLQkJc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmly
cV9sb2NrKTsKPiA+IC0JCWlmIChkZXZfcHJpdi0+ZGlzcGxheV9pcnFzX2VuYWJsZWQpCj4gPiAt
CQkJZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cChkZXZfcHJpdik7Cj4gPiAtCQlzcGlu
X3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiArCWlmIChpOTE1LT5kaXNwbGF5
X2lycXNfZW5hYmxlZCAmJiBpOTE1LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXApIHsKPiA+ICsJCXNw
aW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICsJCWlmIChpOTE1LT5kaXNwbGF5X2ly
cXNfZW5hYmxlZCkKPiA+ICsJCQlpOTE1LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAoaTkxNSk7Cj4g
PiArCQlzcGluX3VubG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKPiA+ICAgCX0KPiA+ICAgfQo+
ID4gICBzdGF0aWMgdm9pZCBpOTE1X2hwZF9wb2xsX2luaXRfd29yayhzdHJ1Y3Qgd29ya19zdHJ1
Y3QgKndvcmspCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQo+ID4gICAJCWNvbnRhaW5l
cl9vZih3b3JrLCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwKPiA+ICAgCQkJICAgICBob3RwbHVn
LnBvbGxfaW5pdF93b3JrKTsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJp
di0+ZHJtOwo+ID4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiA+ICAg
CXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9saXN0X2l0ZXIgY29ubl9pdGVyOwo+ID4gICAJYm9vbCBlbmFibGVkOwo+ID4gICAJbXV0
ZXhfbG9jaygmZGV2LT5tb2RlX2NvbmZpZy5tdXRleCk7Cj4gPiAtCWVuYWJsZWQgPSBSRUFEX09O
Q0UoZGV2X3ByaXYtPmhvdHBsdWcucG9sbF9lbmFibGVkKTsKPiA+ICsJZW5hYmxlZCA9IFJFQURf
T05DRShpOTE1LT5ob3RwbHVnLnBvbGxfZW5hYmxlZCk7Cj4gPiAgIAlkcm1fY29ubmVjdG9yX2xp
c3RfaXRlcl9iZWdpbihkZXYsICZjb25uX2l0ZXIpOwo+ID4gICAJZHJtX2Zvcl9lYWNoX2Nvbm5l
Y3Rvcl9pdGVyKGNvbm5lY3RvciwgJmNvbm5faXRlcikgewo+ID4gQEAgLTU4Miw3ICs1ODIsNyBA
QCBzdGF0aWMgdm9pZCBpOTE1X2hwZF9wb2xsX2luaXRfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3Qg
KndvcmspCj4gPiAgIAkJaWYgKGludGVsX2Nvbm5lY3Rvci0+bXN0X3BvcnQpCj4gPiAgIAkJCWNv
bnRpbnVlOwo+ID4gLQkJaWYgKCFjb25uZWN0b3ItPnBvbGxlZCAmJiBJOTE1X0hBU19IT1RQTFVH
KGRldl9wcml2KSAmJgo+ID4gKwkJaWYgKCFjb25uZWN0b3ItPnBvbGxlZCAmJiBJOTE1X0hBU19I
T1RQTFVHKGk5MTUpICYmCj4gPiAgIAkJICAgIGludGVsX2Nvbm5lY3Rvci0+ZW5jb2Rlci0+aHBk
X3BpbiA+IEhQRF9OT05FKSB7Cj4gPiAgIAkJCWNvbm5lY3Rvci0+cG9sbGVkID0gZW5hYmxlZCA/
Cj4gPiAgIAkJCQlEUk1fQ09OTkVDVE9SX1BPTExfQ09OTkVDVCB8Cj4gPiBAQCAtNjA3LDcgKzYw
Nyw3IEBAIHN0YXRpYyB2b2lkIGk5MTVfaHBkX3BvbGxfaW5pdF93b3JrKHN0cnVjdCB3b3JrX3N0
cnVjdCAqd29yaykKPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2hwZF9wb2xsX2luaXQgLSBlbmFi
bGVzL2Rpc2FibGVzIHBvbGxpbmcgZm9yIGNvbm5lY3RvcnMgd2l0aCBocGQKPiA+IC0gKiBAZGV2
X3ByaXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCj4gPiArICogQGk5MTU6IGk5MTUgZGV2aWNlIGlu
c3RhbmNlCj4gPiAgICAqCj4gPiAgICAqIFRoaXMgZnVuY3Rpb24gZW5hYmxlcyBwb2xsaW5nIGZv
ciBhbGwgY29ubmVjdG9ycywgcmVnYXJkbGVzcyBvZiB3aGV0aGVyIG9yCj4gPiAgICAqIG5vdCB0
aGV5IHN1cHBvcnQgaG90cGx1ZyBkZXRlY3Rpb24uIFVuZGVyIGNlcnRhaW4gY29uZGl0aW9ucyBI
UEQgbWF5IG5vdCBiZQo+ID4gQEAgLTYyMSw5ICs2MjEsOSBAQCBzdGF0aWMgdm9pZCBpOTE1X2hw
ZF9wb2xsX2luaXRfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiAgICAqCj4gPiAg
ICAqIEFsc28gc2VlOiBpbnRlbF9ocGRfaW5pdCgpLCB3aGljaCByZXN0b3JlcyBocGQgaGFuZGxp
bmcuCj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfaHBkX3BvbGxfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9ocGRfcG9sbF9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCVdSSVRFX09OQ0UoZGV2X3By
aXYtPmhvdHBsdWcucG9sbF9lbmFibGVkLCB0cnVlKTsKPiA+ICsJV1JJVEVfT05DRShpOTE1LT5o
b3RwbHVnLnBvbGxfZW5hYmxlZCwgdHJ1ZSk7Cj4gPiAgIAkvKgo+ID4gICAJICogV2UgbWlnaHQg
YWxyZWFkeSBiZSBob2xkaW5nIGRldi0+bW9kZV9jb25maWcubXV0ZXgsIHNvIGRvIHRoaXMgaW4g
YQo+ID4gQEAgLTYzMSw1NyArNjMxLDU3IEBAIHZvaWQgaW50ZWxfaHBkX3BvbGxfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiBBcyB3ZWxsLCB0aGVyZSdz
IG5vIGlzc3VlIGlmIHdlIHJhY2UgaGVyZSBzaW5jZSB3ZSBhbHdheXMgcmVzY2hlZHVsZQo+ID4g
ICAJICogdGhpcyB3b3JrZXIgYW55d2F5Cj4gPiAgIAkgKi8KPiA+IC0Jc2NoZWR1bGVfd29yaygm
ZGV2X3ByaXYtPmhvdHBsdWcucG9sbF9pbml0X3dvcmspOwo+ID4gKwlzY2hlZHVsZV93b3JrKCZp
OTE1LT5ob3RwbHVnLnBvbGxfaW5pdF93b3JrKTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfaHBk
X2luaXRfd29yayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBp
bnRlbF9ocGRfaW5pdF93b3JrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7
Cj4gPiAtCUlOSVRfV09SSygmZGV2X3ByaXYtPmhvdHBsdWcuaG90cGx1Z193b3JrLCBpOTE1X2hv
dHBsdWdfd29ya19mdW5jKTsKPiA+IC0JSU5JVF9XT1JLKCZkZXZfcHJpdi0+aG90cGx1Zy5kaWdf
cG9ydF93b3JrLCBpOTE1X2RpZ3BvcnRfd29ya19mdW5jKTsKPiA+IC0JSU5JVF9XT1JLKCZkZXZf
cHJpdi0+aG90cGx1Zy5wb2xsX2luaXRfd29yaywgaTkxNV9ocGRfcG9sbF9pbml0X3dvcmspOwo+
ID4gLQlJTklUX0RFTEFZRURfV09SSygmZGV2X3ByaXYtPmhvdHBsdWcucmVlbmFibGVfd29yaywK
PiA+ICsJSU5JVF9XT1JLKCZpOTE1LT5ob3RwbHVnLmhvdHBsdWdfd29yaywgaTkxNV9ob3RwbHVn
X3dvcmtfZnVuYyk7Cj4gPiArCUlOSVRfV09SSygmaTkxNS0+aG90cGx1Zy5kaWdfcG9ydF93b3Jr
LCBpOTE1X2RpZ3BvcnRfd29ya19mdW5jKTsKPiA+ICsJSU5JVF9XT1JLKCZpOTE1LT5ob3RwbHVn
LnBvbGxfaW5pdF93b3JrLCBpOTE1X2hwZF9wb2xsX2luaXRfd29yayk7Cj4gPiArCUlOSVRfREVM
QVlFRF9XT1JLKCZpOTE1LT5ob3RwbHVnLnJlZW5hYmxlX3dvcmssCj4gPiAgIAkJCSAgaW50ZWxf
aHBkX2lycV9zdG9ybV9yZWVuYWJsZV93b3JrKTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfaHBk
X2NhbmNlbF93b3JrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lk
IGludGVsX2hwZF9jYW5jZWxfd29yayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+
ICAgewo+ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwlzcGlu
X2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Cj4gPiAtCWRldl9wcml2LT5ob3RwbHVnLmxvbmdf
cG9ydF9tYXNrID0gMDsKPiA+IC0JZGV2X3ByaXYtPmhvdHBsdWcuc2hvcnRfcG9ydF9tYXNrID0g
MDsKPiA+IC0JZGV2X3ByaXYtPmhvdHBsdWcuZXZlbnRfYml0cyA9IDA7Cj4gPiArCWk5MTUtPmhv
dHBsdWcubG9uZ19wb3J0X21hc2sgPSAwOwo+ID4gKwlpOTE1LT5ob3RwbHVnLnNob3J0X3BvcnRf
bWFzayA9IDA7Cj4gPiArCWk5MTUtPmhvdHBsdWcuZXZlbnRfYml0cyA9IDA7Cj4gPiAtCXNwaW5f
dW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxKCZp
OTE1LT5pcnFfbG9jayk7Cj4gPiAtCWNhbmNlbF93b3JrX3N5bmMoJmRldl9wcml2LT5ob3RwbHVn
LmRpZ19wb3J0X3dvcmspOwo+ID4gLQljYW5jZWxfd29ya19zeW5jKCZkZXZfcHJpdi0+aG90cGx1
Zy5ob3RwbHVnX3dvcmspOwo+ID4gLQljYW5jZWxfd29ya19zeW5jKCZkZXZfcHJpdi0+aG90cGx1
Zy5wb2xsX2luaXRfd29yayk7Cj4gPiAtCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmZGV2X3By
aXYtPmhvdHBsdWcucmVlbmFibGVfd29yayk7Cj4gPiArCWNhbmNlbF93b3JrX3N5bmMoJmk5MTUt
PmhvdHBsdWcuZGlnX3BvcnRfd29yayk7Cj4gPiArCWNhbmNlbF93b3JrX3N5bmMoJmk5MTUtPmhv
dHBsdWcuaG90cGx1Z193b3JrKTsKPiA+ICsJY2FuY2VsX3dvcmtfc3luYygmaTkxNS0+aG90cGx1
Zy5wb2xsX2luaXRfd29yayk7Cj4gPiArCWNhbmNlbF9kZWxheWVkX3dvcmtfc3luYygmaTkxNS0+
aG90cGx1Zy5yZWVuYWJsZV93b3JrKTsKPiA+ICAgfQo+ID4gLWJvb2wgaW50ZWxfaHBkX2Rpc2Fi
bGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIGhwZF9waW4gcGluKQo+
ID4gK2Jvb2wgaW50ZWxfaHBkX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IGVudW0gaHBkX3BpbiBwaW4pCj4gPiAgIHsKPiA+ICAgCWJvb2wgcmV0ID0gZmFsc2U7Cj4gPiAg
IAlpZiAocGluID09IEhQRF9OT05FKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IC0Jc3Bpbl9s
b2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+IC0JaWYgKGRldl9wcml2LT5ob3RwbHVn
LnN0YXRzW3Bpbl0uc3RhdGUgPT0gSFBEX0VOQUJMRUQpIHsKPiA+IC0JCWRldl9wcml2LT5ob3Rw
bHVnLnN0YXRzW3Bpbl0uc3RhdGUgPSBIUERfRElTQUJMRUQ7Cj4gPiArCXNwaW5fbG9ja19pcnEo
Jmk5MTUtPmlycV9sb2NrKTsKPiA+ICsJaWYgKGk5MTUtPmhvdHBsdWcuc3RhdHNbcGluXS5zdGF0
ZSA9PSBIUERfRU5BQkxFRCkgewo+ID4gKwkJaTkxNS0+aG90cGx1Zy5zdGF0c1twaW5dLnN0YXRl
ID0gSFBEX0RJU0FCTEVEOwo+ID4gICAJCXJldCA9IHRydWU7Cj4gPiAgIAl9Cj4gPiAtCXNwaW5f
dW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxKCZp
OTE1LT5pcnFfbG9jayk7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiAtdm9pZCBpbnRl
bF9ocGRfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBocGRf
cGluIHBpbikKPiA+ICt2b2lkIGludGVsX2hwZF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsIGVudW0gaHBkX3BpbiBwaW4pCj4gPiAgIHsKPiA+ICAgCWlmIChwaW4gPT0gSFBE
X05PTkUpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJx
X2xvY2spOwo+ID4gLQlkZXZfcHJpdi0+aG90cGx1Zy5zdGF0c1twaW5dLnN0YXRlID0gSFBEX0VO
QUJMRUQ7Cj4gPiAtCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKPiA+ICsJ
c3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4gKwlpOTE1LT5ob3RwbHVnLnN0YXRz
W3Bpbl0uc3RhdGUgPSBIUERfRU5BQkxFRDsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5p
cnFfbG9jayk7Cj4gPiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9ob3RwbHVnLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ob3RwbHVnLmgKPiA+
IGluZGV4IDgwNWY4OTdkYmI3YS4uMmZjYzMxNDhiMzY5IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfaG90cGx1Zy5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9ob3RwbHVnLmgKPiA+IEBAIC0xNCwxNyArMTQsMTcgQEAgc3RydWN0IGRybV9p
OTE1X3ByaXZhdGU7Cj4gPiAgIHN0cnVjdCBpbnRlbF9jb25uZWN0b3I7Cj4gPiAgIHN0cnVjdCBp
bnRlbF9lbmNvZGVyOwo+ID4gLXZvaWQgaW50ZWxfaHBkX3BvbGxfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3ZvaWQgaW50ZWxfaHBkX3BvbGxfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIGJvb2wgaW50ZWxfZW5jb2Rlcl9ob3Rw
bHVnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkgICBzdHJ1Y3QgaW50
ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpOwo+ID4gLXZvaWQgaW50ZWxfaHBkX2lycV9oYW5kbGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2hwZF9p
cnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgdTMy
IHBpbl9tYXNrLCB1MzIgbG9uZ19tYXNrKTsKPiA+IC12b2lkIGludGVsX2hwZF9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpbnRlbF9ocGRfaW5pdF93
b3JrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpbnRlbF9o
cGRfY2FuY2VsX3dvcmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC1l
bnVtIGhwZF9waW4gaW50ZWxfaHBkX3Bpbl9kZWZhdWx0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICt2b2lkIGludGVsX2hwZF9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX2hwZF9pbml0X3dvcmsoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfaHBkX2NhbmNlbF93b3JrKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICtlbnVtIGhwZF9waW4gaW50ZWxfaHBkX3Bpbl9k
ZWZhdWx0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgZW51bSBw
b3J0IHBvcnQpOwo+ID4gLWJvb2wgaW50ZWxfaHBkX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCBlbnVtIGhwZF9waW4gcGluKTsKPiA+IC12b2lkIGludGVsX2hwZF9l
bmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIGhwZF9waW4gcGlu
KTsKPiA+ICtib29sIGludGVsX2hwZF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBlbnVtIGhwZF9waW4gcGluKTsKPiA+ICt2b2lkIGludGVsX2hwZF9lbmFibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGVudW0gaHBkX3BpbiBwaW4pOwo+ID4gICAjZW5kaWYg
LyogX19JTlRFTF9IT1RQTFVHX0hfXyAqLwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX2h1Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaHVjLmMKPiA+
IGluZGV4IDg1NzJhMDU4OGVmYy4uMmIyMzY2MjY5OGE5IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfaHVjLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2h1Yy5jCj4gPiBAQCAtMTY3LDE0ICsxNjcsMTQgQEAgaW50IGludGVsX2h1Y19hdXRo
KHN0cnVjdCBpbnRlbF9odWMgKmh1YykKPiA+ICAgICovCj4gPiAgIGludCBpbnRlbF9odWNfY2hl
Y2tfc3RhdHVzKHN0cnVjdCBpbnRlbF9odWMgKmh1YykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBodWNfdG9faTkxNShodWMpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGh1Y190b19pOTE1KGh1Yyk7Cj4gPiAgIAlpbnRlbF93
YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCWJvb2wgc3RhdHVzID0gZmFsc2U7Cj4gPiAtCWlmICgh
SEFTX0hVQyhkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX0hVQyhpOTE1KSkKPiA+ICAgCQlyZXR1
cm4gLUVOT0RFVjsKPiA+IC0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKGRldl9wcml2LCB3YWtlcmVm
KQo+ID4gKwl3aXRoX2ludGVsX3J1bnRpbWVfcG0oaTkxNSwgd2FrZXJlZikKPiA+ICAgCQlzdGF0
dXMgPSAoSTkxNV9SRUFEKGh1Yy0+c3RhdHVzLnJlZykgJiBodWMtPnN0YXR1cy5tYXNrKSA9PQo+
ID4gICAJCQkgIGh1Yy0+c3RhdHVzLnZhbHVlOwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX2h1Y19mdy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaHVj
X2Z3LmMKPiA+IGluZGV4IDA1Y2JmODMzOGY1My4uMDNhZWQwNjY0NzI2IDEwMDY0NAo+ID4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaHVjX2Z3LmMKPiA+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2h1Y19mdy5jCj4gPiBAQCAtNjksMzQgKzY5LDM0IEBAIE1PRFVM
RV9GSVJNV0FSRShJOTE1X0lDTF9IVUNfVUNPREUpOwo+ID4gICBzdGF0aWMgdm9pZCBodWNfZndf
c2VsZWN0KHN0cnVjdCBpbnRlbF91Y19mdyAqaHVjX2Z3KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfaHVjICpodWMgPSBjb250YWluZXJfb2YoaHVjX2Z3LCBzdHJ1Y3QgaW50ZWxfaHVjLCBm
dyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGh1Y190b19pOTE1
KGh1Yyk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gaHVjX3RvX2k5MTUo
aHVjKTsKPiA+ICAgCUdFTV9CVUdfT04oaHVjX2Z3LT50eXBlICE9IElOVEVMX1VDX0ZXX1RZUEVf
SFVDKTsKPiA+IC0JaWYgKCFIQVNfSFVDKGRldl9wcml2KSkKPiA+ICsJaWYgKCFIQVNfSFVDKGk5
MTUpKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCWlmIChpOTE1X21vZHBhcmFtcy5odWNfZmlybXdh
cmVfcGF0aCkgewo+ID4gICAJCWh1Y19mdy0+cGF0aCA9IGk5MTVfbW9kcGFyYW1zLmh1Y19maXJt
d2FyZV9wYXRoOwo+ID4gICAJCWh1Y19mdy0+bWFqb3JfdmVyX3dhbnRlZCA9IDA7Cj4gPiAgIAkJ
aHVjX2Z3LT5taW5vcl92ZXJfd2FudGVkID0gMDsKPiA+IC0JfSBlbHNlIGlmIChJU19TS1lMQUtF
KGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX1NLWUxBS0UoaTkxNSkpIHsKPiA+ICAg
CQlodWNfZnctPnBhdGggPSBJOTE1X1NLTF9IVUNfVUNPREU7Cj4gPiAgIAkJaHVjX2Z3LT5tYWpv
cl92ZXJfd2FudGVkID0gU0tMX0hVQ19GV19NQUpPUjsKPiA+ICAgCQlodWNfZnctPm1pbm9yX3Zl
cl93YW50ZWQgPSBTS0xfSFVDX0ZXX01JTk9SOwo+ID4gLQl9IGVsc2UgaWYgKElTX0JST1hUT04o
ZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfQlJPWFRPTihpOTE1KSkgewo+ID4gICAJ
CWh1Y19mdy0+cGF0aCA9IEk5MTVfQlhUX0hVQ19VQ09ERTsKPiA+ICAgCQlodWNfZnctPm1ham9y
X3Zlcl93YW50ZWQgPSBCWFRfSFVDX0ZXX01BSk9SOwo+ID4gICAJCWh1Y19mdy0+bWlub3JfdmVy
X3dhbnRlZCA9IEJYVF9IVUNfRldfTUlOT1I7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfS0FCWUxBS0Uo
ZGV2X3ByaXYpIHx8IElTX0NPRkZFRUxBS0UoZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAo
SVNfS0FCWUxBS0UoaTkxNSkgfHwgSVNfQ09GRkVFTEFLRShpOTE1KSkgewo+ID4gICAJCWh1Y19m
dy0+cGF0aCA9IEk5MTVfS0JMX0hVQ19VQ09ERTsKPiA+ICAgCQlodWNfZnctPm1ham9yX3Zlcl93
YW50ZWQgPSBLQkxfSFVDX0ZXX01BSk9SOwo+ID4gICAJCWh1Y19mdy0+bWlub3JfdmVyX3dhbnRl
ZCA9IEtCTF9IVUNfRldfTUlOT1I7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShkZXZf
cHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19HRU1JTklMQUtFKGk5MTUpKSB7Cj4gPiAgIAkJ
aHVjX2Z3LT5wYXRoID0gSTkxNV9HTEtfSFVDX1VDT0RFOwo+ID4gICAJCWh1Y19mdy0+bWFqb3Jf
dmVyX3dhbnRlZCA9IEdMS19IVUNfRldfTUFKT1I7Cj4gPiAgIAkJaHVjX2Z3LT5taW5vcl92ZXJf
d2FudGVkID0gR0xLX0hVQ19GV19NSU5PUjsKPiA+IC0JfSBlbHNlIGlmIChJU19JQ0VMQUtFKGRl
dl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0lDRUxBS0UoaTkxNSkpIHsKPiA+ICAgCQlo
dWNfZnctPnBhdGggPSBJOTE1X0lDTF9IVUNfVUNPREU7Cj4gPiAgIAkJaHVjX2Z3LT5tYWpvcl92
ZXJfd2FudGVkID0gSUNMX0hVQ19GV19NQUpPUjsKPiA+ICAgCQlodWNfZnctPm1pbm9yX3Zlcl93
YW50ZWQgPSBJQ0xfSFVDX0ZXX01JTk9SOwo+ID4gQEAgLTEzNSw4ICsxMzUsOCBAQCBzdGF0aWMg
dm9pZCBodWNfeGZlcl9yc2Eoc3RydWN0IGludGVsX2h1YyAqaHVjKQo+ID4gICBzdGF0aWMgaW50
IGh1Y194ZmVyX3Vjb2RlKHN0cnVjdCBpbnRlbF9odWMgKmh1YykKPiA+ICAgewo+ID4gICAJc3Ry
dWN0IGludGVsX3VjX2Z3ICpodWNfZncgPSAmaHVjLT5mdzsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gaHVjX3RvX2k5MTUoaHVjKTsKPiA+IC0Jc3RydWN0IGludGVs
X3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gaHVjX3RvX2k5MTUoaHVjKTsKPiA+ICsJc3RydWN0IGludGVsX3Vu
Y29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiA+ICAgCXVuc2lnbmVkIGxvbmcgb2Zmc2V0
ID0gMDsKPiA+ICAgCXUzMiBzaXplOwo+ID4gICAJaW50IHJldDsKPiA+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9scGVfYXVkaW8uYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2xwZV9hdWRpby5jCj4gPiBpbmRleCBiMTk4MDBiNTg0NDIuLmQ5NWFlMDVjY2Vi
YyAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2xwZV9hdWRpby5j
Cj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9scGVfYXVkaW8uYwo+ID4gQEAg
LTczLDEyICs3MywxMiBAQAo+ID4gICAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKPiA+ICAgI2luY2x1
ZGUgImludGVsX2xwZV9hdWRpby5oIgo+ID4gLSNkZWZpbmUgSEFTX0xQRV9BVURJTyhkZXZfcHJp
dikgKChkZXZfcHJpdiktPmxwZV9hdWRpby5wbGF0ZGV2ICE9IE5VTEwpCj4gPiArI2RlZmluZSBI
QVNfTFBFX0FVRElPKGk5MTUpICgoaTkxNSktPmxwZV9hdWRpby5wbGF0ZGV2ICE9IE5VTEwpCj4g
PiAgIHN0YXRpYyBzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICoKPiA+IC1scGVfYXVkaW9fcGxhdGRl
dl9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2xwZV9hdWRp
b19wbGF0ZGV2X2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gPiArCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ID4gICAJc3RydWN0IHBsYXRmb3JtX2Rl
dmljZV9pbmZvIHBpbmZvID0ge307Cj4gPiAgIAlzdHJ1Y3QgcmVzb3VyY2UgKnJzYzsKPiA+ICAg
CXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBsYXRkZXY7Cj4gPiBAQCAtOTQsNyArOTQsNyBAQCBs
cGVfYXVkaW9fcGxhdGRldl9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gICAJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ID4gICAJfQo+ID4gLQlyc2NbMF0u
c3RhcnQgICAgPSByc2NbMF0uZW5kID0gZGV2X3ByaXYtPmxwZV9hdWRpby5pcnE7Cj4gPiArCXJz
Y1swXS5zdGFydCAgICA9IHJzY1swXS5lbmQgPSBpOTE1LT5scGVfYXVkaW8uaXJxOwo+ID4gICAJ
cnNjWzBdLmZsYWdzICAgID0gSU9SRVNPVVJDRV9JUlE7Cj4gPiAgIAlyc2NbMF0ubmFtZSAgICAg
PSAiaGRtaS1scGUtYXVkaW8taXJxIjsKPiA+IEBAIC0xMTQsOCArMTE0LDggQEAgbHBlX2F1ZGlv
X3BsYXRkZXZfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAg
CXBpbmZvLnNpemVfZGF0YSA9IHNpemVvZigqcGRhdGEpOwo+ID4gICAJcGluZm8uZG1hX21hc2sg
PSBETUFfQklUX01BU0soMzIpOwo+ID4gLQlwZGF0YS0+bnVtX3BpcGVzID0gSU5URUxfSU5GTyhk
ZXZfcHJpdiktPm51bV9waXBlczsKPiA+IC0JcGRhdGEtPm51bV9wb3J0cyA9IElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpID8gMyA6IDI7IC8qIEIsQyxEIG9yIEIsQyAqLwo+ID4gKwlwZGF0YS0+bnVt
X3BpcGVzID0gSU5URUxfSU5GTyhpOTE1KS0+bnVtX3BpcGVzOwo+ID4gKwlwZGF0YS0+bnVtX3Bv
cnRzID0gSVNfQ0hFUlJZVklFVyhpOTE1KSA/IDMgOiAyOyAvKiBCLEMsRCBvciBCLEMgKi8KPiA+
ICAgCXBkYXRhLT5wb3J0WzBdLnBpcGUgPSAtMTsKPiA+ICAgCXBkYXRhLT5wb3J0WzFdLnBpcGUg
PSAtMTsKPiA+ICAgCXBkYXRhLT5wb3J0WzJdLnBpcGUgPSAtMTsKPiA+IEBAIC0xMzUsNyArMTM1
LDcgQEAgbHBlX2F1ZGlvX3BsYXRkZXZfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICAgCXJldHVybiBwbGF0ZGV2Owo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQg
bHBlX2F1ZGlvX3BsYXRkZXZfZGVzdHJveShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiArc3RhdGljIHZvaWQgbHBlX2F1ZGlvX3BsYXRkZXZfZGVzdHJveShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJLyogWFhYIE5vdGUgdGhhdCBwbGF0
Zm9ybV9kZXZpY2VfcmVnaXN0ZXJfZnVsbCgpIGFsbG9jYXRlcyBhIGRtYV9tYXNrCj4gPiAgIAkg
KiBhbmQgbmV2ZXIgZnJlZXMgaXQuIFdlIGNhbid0IGZyZWUgaXQgaGVyZSBhcyB3ZSBjYW5ub3Qg
Z3VhcmFudGVlCj4gPiBAQCAtMTQ1LDcgKzE0NSw3IEBAIHN0YXRpYyB2b2lkIGxwZV9hdWRpb19w
bGF0ZGV2X2Rlc3Ryb3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJ
ICogdGhhbiB1cyBmaWRkbGUgd2l0aCBpdHMgaW50ZXJuYWxzLgo+ID4gICAJICovCj4gPiAtCXBs
YXRmb3JtX2RldmljZV91bnJlZ2lzdGVyKGRldl9wcml2LT5scGVfYXVkaW8ucGxhdGRldik7Cj4g
PiArCXBsYXRmb3JtX2RldmljZV91bnJlZ2lzdGVyKGk5MTUtPmxwZV9hdWRpby5wbGF0ZGV2KTsK
PiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBscGVfYXVkaW9faXJxX3VubWFzayhzdHJ1Y3QgaXJx
X2RhdGEgKmQpCj4gPiBAQCAtMTYyLDI0ICsxNjIsMjQgQEAgc3RhdGljIHN0cnVjdCBpcnFfY2hp
cCBscGVfYXVkaW9faXJxY2hpcCA9IHsKPiA+ICAgCS5pcnFfdW5tYXNrID0gbHBlX2F1ZGlvX2ly
cV91bm1hc2ssCj4gPiAgIH07Cj4gPiAtc3RhdGljIGludCBscGVfYXVkaW9faXJxX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBpbnQgbHBlX2F1ZGlv
X2lycV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCWlu
dCBpcnEgPSBkZXZfcHJpdi0+bHBlX2F1ZGlvLmlycTsKPiA+ICsJaW50IGlycSA9IGk5MTUtPmxw
ZV9hdWRpby5pcnE7Cj4gPiAtCVdBUk5fT04oIWludGVsX2lycXNfZW5hYmxlZChkZXZfcHJpdikp
Owo+ID4gKwlXQVJOX09OKCFpbnRlbF9pcnFzX2VuYWJsZWQoaTkxNSkpOwo+ID4gICAJaXJxX3Nl
dF9jaGlwX2FuZF9oYW5kbGVyX25hbWUoaXJxLAo+ID4gICAJCQkJJmxwZV9hdWRpb19pcnFjaGlw
LAo+ID4gICAJCQkJaGFuZGxlX3NpbXBsZV9pcnEsCj4gPiAgIAkJCQkiaGRtaV9scGVfYXVkaW9f
aXJxX2hhbmRsZXIiKTsKPiA+IC0JcmV0dXJuIGlycV9zZXRfY2hpcF9kYXRhKGlycSwgZGV2X3By
aXYpOwo+ID4gKwlyZXR1cm4gaXJxX3NldF9jaGlwX2RhdGEoaXJxLCBpOTE1KTsKPiA+ICAgfQo+
ID4gLXN0YXRpYyBib29sIGxwZV9hdWRpb19kZXRlY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gK3N0YXRpYyBib29sIGxwZV9hdWRpb19kZXRlY3Qoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWludCBscGVfcHJlc2VudCA9IGZhbHNl
Owo+ID4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpIHsKPiA+ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhp
OTE1KSkgewo+ID4gICAJCXN0YXRpYyBjb25zdCBzdHJ1Y3QgcGNpX2RldmljZV9pZCBhdG9tX2hk
YXVkaW9faWRzW10gPSB7Cj4gPiAgIAkJCS8qIEJheXRyYWlsICovCj4gPiAgIAkJCXtQQ0lfREVW
SUNFKFBDSV9WRU5ET1JfSURfSU5URUwsIDB4MGYwNCl9LAo+ID4gQEAgLTE5NiwyMSArMTk2LDIx
IEBAIHN0YXRpYyBib29sIGxwZV9hdWRpb19kZXRlY3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gICAJcmV0dXJuIGxwZV9wcmVzZW50Owo+ID4gICB9Cj4gPiAtc3RhdGlj
IGludCBscGVfYXVkaW9fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gK3N0YXRpYyBpbnQgbHBlX2F1ZGlvX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gLQlkZXZfcHJpdi0+bHBlX2F1ZGlvLmly
cSA9IGlycV9hbGxvY19kZXNjKDApOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmxwZV9hdWRpby5pcnEg
PCAwKSB7Cj4gPiArCWk5MTUtPmxwZV9hdWRpby5pcnEgPSBpcnFfYWxsb2NfZGVzYygwKTsKPiA+
ICsJaWYgKGk5MTUtPmxwZV9hdWRpby5pcnEgPCAwKSB7Cj4gPiAgIAkJRFJNX0VSUk9SKCJGYWls
ZWQgdG8gYWxsb2NhdGUgSVJRIGRlc2M6ICVkXG4iLAo+ID4gLQkJCWRldl9wcml2LT5scGVfYXVk
aW8uaXJxKTsKPiA+IC0JCXJldCA9IGRldl9wcml2LT5scGVfYXVkaW8uaXJxOwo+ID4gKwkJCWk5
MTUtPmxwZV9hdWRpby5pcnEpOwo+ID4gKwkJcmV0ID0gaTkxNS0+bHBlX2F1ZGlvLmlycTsKPiA+
ICAgCQlnb3RvIGVycjsKPiA+ICAgCX0KPiA+IC0JRFJNX0RFQlVHKCJpcnEgPSAlZFxuIiwgZGV2
X3ByaXYtPmxwZV9hdWRpby5pcnEpOwo+ID4gKwlEUk1fREVCVUcoImlycSA9ICVkXG4iLCBpOTE1
LT5scGVfYXVkaW8uaXJxKTsKPiA+IC0JcmV0ID0gbHBlX2F1ZGlvX2lycV9pbml0KGRldl9wcml2
KTsKPiA+ICsJcmV0ID0gbHBlX2F1ZGlvX2lycV9pbml0KGk5MTUpOwo+ID4gICAJaWYgKHJldCkg
ewo+ID4gICAJCURSTV9FUlJPUigiRmFpbGVkIHRvIGluaXRpYWxpemUgaXJxY2hpcCBmb3IgbHBl
IGF1ZGlvOiAlZFxuIiwKPiA+IEBAIC0yMTgsMTAgKzIxOCwxMCBAQCBzdGF0aWMgaW50IGxwZV9h
dWRpb19zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJZ290
byBlcnJfZnJlZV9pcnE7Cj4gPiAgIAl9Cj4gPiAtCWRldl9wcml2LT5scGVfYXVkaW8ucGxhdGRl
diA9IGxwZV9hdWRpb19wbGF0ZGV2X2NyZWF0ZShkZXZfcHJpdik7Cj4gPiArCWk5MTUtPmxwZV9h
dWRpby5wbGF0ZGV2ID0gbHBlX2F1ZGlvX3BsYXRkZXZfY3JlYXRlKGk5MTUpOwo+ID4gLQlpZiAo
SVNfRVJSKGRldl9wcml2LT5scGVfYXVkaW8ucGxhdGRldikpIHsKPiA+IC0JCXJldCA9IFBUUl9F
UlIoZGV2X3ByaXYtPmxwZV9hdWRpby5wbGF0ZGV2KTsKPiA+ICsJaWYgKElTX0VSUihpOTE1LT5s
cGVfYXVkaW8ucGxhdGRldikpIHsKPiA+ICsJCXJldCA9IFBUUl9FUlIoaTkxNS0+bHBlX2F1ZGlv
LnBsYXRkZXYpOwo+ID4gICAJCURSTV9FUlJPUigiRmFpbGVkIHRvIGNyZWF0ZSBscGUgYXVkaW8g
cGxhdGZvcm0gZGV2aWNlOiAlZFxuIiwKPiA+ICAgCQkJcmV0KTsKPiA+ICAgCQlnb3RvIGVycl9m
cmVlX2lycTsKPiA+IEBAIC0yMzQsMjggKzIzNCwyOCBAQCBzdGF0aWMgaW50IGxwZV9hdWRpb19z
ZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlyZXR1cm4gMDsK
PiA+ICAgZXJyX2ZyZWVfaXJxOgo+ID4gLQlpcnFfZnJlZV9kZXNjKGRldl9wcml2LT5scGVfYXVk
aW8uaXJxKTsKPiA+ICsJaXJxX2ZyZWVfZGVzYyhpOTE1LT5scGVfYXVkaW8uaXJxKTsKPiA+ICAg
ZXJyOgo+ID4gLQlkZXZfcHJpdi0+bHBlX2F1ZGlvLmlycSA9IC0xOwo+ID4gLQlkZXZfcHJpdi0+
bHBlX2F1ZGlvLnBsYXRkZXYgPSBOVUxMOwo+ID4gKwlpOTE1LT5scGVfYXVkaW8uaXJxID0gLTE7
Cj4gPiArCWk5MTUtPmxwZV9hdWRpby5wbGF0ZGV2ID0gTlVMTDsKPiA+ICAgCXJldHVybiByZXQ7
Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2xwZV9hdWRpb19pcnFfaGFuZGxlcigp
IC0gZm9yd2FyZHMgdGhlIExQRSBhdWRpbyBpcnEKPiA+IC0gKiBAZGV2X3ByaXY6IHRoZSBpOTE1
IGRybSBkZXZpY2UgcHJpdmF0ZSBkYXRhCj4gPiArICogQGk5MTU6IHRoZSBpOTE1IGRybSBkZXZp
Y2UgcHJpdmF0ZSBkYXRhCj4gPiAgICAqCj4gPiAgICAqIHRoZSBMUEUgQXVkaW8gaXJxIGlzIGZv
cndhcmRlZCB0byB0aGUgaXJxIGhhbmRsZXIgcmVnaXN0ZXJlZCBieSBMUEUgYXVkaW8KPiA+ICAg
ICogZHJpdmVyLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX2xwZV9hdWRpb19pcnFfaGFuZGxl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9scGVf
YXVkaW9faXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsK
PiA+ICAgCWludCByZXQ7Cj4gPiAtCWlmICghSEFTX0xQRV9BVURJTyhkZXZfcHJpdikpCj4gPiAr
CWlmICghSEFTX0xQRV9BVURJTyhpOTE1KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCXJldCA9IGdl
bmVyaWNfaGFuZGxlX2lycShkZXZfcHJpdi0+bHBlX2F1ZGlvLmlycSk7Cj4gPiArCXJldCA9IGdl
bmVyaWNfaGFuZGxlX2lycShpOTE1LT5scGVfYXVkaW8uaXJxKTsKPiA+ICAgCWlmIChyZXQpCj4g
PiAgIAkJRFJNX0VSUk9SX1JBVEVMSU1JVEVEKCJlcnJvciBoYW5kbGluZyBMUEUgYXVkaW8gaXJx
OiAlZFxuIiwKPiA+ICAgCQkJCXJldCk7Cj4gPiBAQCAtMjY0LDE3ICsyNjQsMTcgQEAgdm9pZCBp
bnRlbF9scGVfYXVkaW9faXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfbHBlX2F1ZGlvX2luaXQoKSAtIGRldGVjdCBh
bmQgc2V0dXAgdGhlIGJyaWRnZSBiZXR3ZWVuIEhETUkgTFBFIEF1ZGlvCj4gPiAgICAqIGRyaXZl
ciBhbmQgaTkxNQo+ID4gLSAqIEBkZXZfcHJpdjogdGhlIGk5MTUgZHJtIGRldmljZSBwcml2YXRl
IGRhdGEKPiA+ICsgKiBAaTkxNTogdGhlIGk5MTUgZHJtIGRldmljZSBwcml2YXRlIGRhdGEKPiA+
ICAgICoKPiA+ICAgICogUmV0dXJuOiAwIGlmIHN1Y2Nlc3NmdWwuIG5vbi16ZXJvIGlmIGRldGVj
dGlvbiBvcgo+ID4gICAgKiBsbG9jYXRpb24vaW5pdGlhbGl6YXRpb24gZmFpbHMKPiA+ICAgICov
Cj4gPiAtaW50IGludGVsX2xwZV9hdWRpb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtpbnQgaW50ZWxfbHBlX2F1ZGlvX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWludCByZXQgPSAtRU5PREVWOwo+ID4gLQlpZiAo
bHBlX2F1ZGlvX2RldGVjdChkZXZfcHJpdikpIHsKPiA+IC0JCXJldCA9IGxwZV9hdWRpb19zZXR1
cChkZXZfcHJpdik7Cj4gPiArCWlmIChscGVfYXVkaW9fZGV0ZWN0KGk5MTUpKSB7Cj4gPiArCQly
ZXQgPSBscGVfYXVkaW9fc2V0dXAoaTkxNSk7Cj4gPiAgIAkJaWYgKHJldCA8IDApCj4gPiAgIAkJ
CURSTV9FUlJPUigiZmFpbGVkIHRvIHNldHVwIExQRSBBdWRpbyBicmlkZ2VcbiIpOwo+ID4gICAJ
fQo+ID4gQEAgLTI4NCwzMSArMjg0LDMxIEBAIGludCBpbnRlbF9scGVfYXVkaW9faW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9s
cGVfYXVkaW9fdGVhcmRvd24oKSAtIGRlc3Ryb3kgdGhlIGJyaWRnZSBiZXR3ZWVuIEhETUkgTFBF
Cj4gPiAgICAqIGF1ZGlvIGRyaXZlciBhbmQgaTkxNQo+ID4gLSAqIEBkZXZfcHJpdjogdGhlIGk5
MTUgZHJtIGRldmljZSBwcml2YXRlIGRhdGEKPiA+ICsgKiBAaTkxNTogdGhlIGk5MTUgZHJtIGRl
dmljZSBwcml2YXRlIGRhdGEKPiA+ICAgICoKPiA+ICAgICogcmVsZWFzZSBhbGwgdGhlIHJlc291
cmNlcyBmb3IgTFBFIGF1ZGlvIDwtPiBpOTE1IGJyaWRnZS4KPiA+ICAgICovCj4gPiAtdm9pZCBp
bnRlbF9scGVfYXVkaW9fdGVhcmRvd24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gK3ZvaWQgaW50ZWxfbHBlX2F1ZGlvX3RlYXJkb3duKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2M7Cj4gPiAtCWlm
ICghSEFTX0xQRV9BVURJTyhkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX0xQRV9BVURJTyhpOTE1
KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWRlc2MgPSBpcnFfdG9fZGVzYyhkZXZfcHJpdi0+bHBl
X2F1ZGlvLmlycSk7Cj4gPiArCWRlc2MgPSBpcnFfdG9fZGVzYyhpOTE1LT5scGVfYXVkaW8uaXJx
KTsKPiA+IC0JbHBlX2F1ZGlvX3BsYXRkZXZfZGVzdHJveShkZXZfcHJpdik7Cj4gPiArCWxwZV9h
dWRpb19wbGF0ZGV2X2Rlc3Ryb3koaTkxNSk7Cj4gPiAtCWlycV9mcmVlX2Rlc2MoZGV2X3ByaXYt
PmxwZV9hdWRpby5pcnEpOwo+ID4gKwlpcnFfZnJlZV9kZXNjKGk5MTUtPmxwZV9hdWRpby5pcnEp
Owo+ID4gLQlkZXZfcHJpdi0+bHBlX2F1ZGlvLmlycSA9IC0xOwo+ID4gLQlkZXZfcHJpdi0+bHBl
X2F1ZGlvLnBsYXRkZXYgPSBOVUxMOwo+ID4gKwlpOTE1LT5scGVfYXVkaW8uaXJxID0gLTE7Cj4g
PiArCWk5MTUtPmxwZV9hdWRpby5wbGF0ZGV2ID0gTlVMTDsKPiA+ICAgfQo+ID4gICAvKioKPiA+
ICAgICogaW50ZWxfbHBlX2F1ZGlvX25vdGlmeSgpIC0gbm90aWZ5IGxwZSBhdWRpbyBldmVudAo+
ID4gICAgKiBhdWRpbyBkcml2ZXIgYW5kIGk5MTUKPiA+IC0gKiBAZGV2X3ByaXY6IHRoZSBpOTE1
IGRybSBkZXZpY2UgcHJpdmF0ZSBkYXRhCj4gPiArICogQGk5MTU6IHRoZSBpOTE1IGRybSBkZXZp
Y2UgcHJpdmF0ZSBkYXRhCj4gPiAgICAqIEBwaXBlOiBwaXBlCj4gPiAgICAqIEBwb3J0OiBwb3J0
Cj4gPiAgICAqIEBlbGQgOiBFTEQgZGF0YQo+ID4gQEAgLTMxNyw3ICszMTcsNyBAQCB2b2lkIGlu
dGVsX2xwZV9hdWRpb190ZWFyZG93bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAgICAqCj4gPiAgICAqIE5vdGlmeSBscGUgYXVkaW8gZHJpdmVyIG9mIGVsZCBjaGFuZ2Uu
Cj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfbHBlX2F1ZGlvX25vdGlmeShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpbnRlbF9scGVfYXVkaW9fbm90aWZ5KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgZW51bSBwaXBlIHBpcGUs
IGVudW0gcG9ydCBwb3J0LAo+ID4gICAJCQkgICAgY29uc3Qgdm9pZCAqZWxkLCBpbnQgbHNfY2xv
Y2ssIGJvb2wgZHBfb3V0cHV0KQo+ID4gICB7Cj4gPiBAQCAtMzI2LDEwICszMjYsMTAgQEAgdm9p
ZCBpbnRlbF9scGVfYXVkaW9fbm90aWZ5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgCXN0cnVjdCBpbnRlbF9oZG1pX2xwZV9hdWRpb19wb3J0X3BkYXRhICpwcGRhdGE7
Cj4gPiAgIAl1MzIgYXVkaW9fZW5hYmxlOwo+ID4gLQlpZiAoIUhBU19MUEVfQVVESU8oZGV2X3By
aXYpKQo+ID4gKwlpZiAoIUhBU19MUEVfQVVESU8oaTkxNSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4g
LQlwZGF0YSA9IGRldl9nZXRfcGxhdGRhdGEoJmRldl9wcml2LT5scGVfYXVkaW8ucGxhdGRldi0+
ZGV2KTsKPiA+ICsJcGRhdGEgPSBkZXZfZ2V0X3BsYXRkYXRhKCZpOTE1LT5scGVfYXVkaW8ucGxh
dGRldi0+ZGV2KTsKPiA+ICAgCXBwZGF0YSA9ICZwZGF0YS0+cG9ydFtwb3J0IC0gUE9SVF9CXTsK
PiA+ICAgCXNwaW5fbG9ja19pcnFzYXZlKCZwZGF0YS0+bHBlX2F1ZGlvX3Nsb2NrLCBpcnFmbGFn
cyk7Cj4gPiBAQCAtMzU3LDcgKzM1Nyw3IEBAIHZvaWQgaW50ZWxfbHBlX2F1ZGlvX25vdGlmeShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAl9Cj4gPiAgIAlpZiAocGRh
dGEtPm5vdGlmeV9hdWRpb19scGUpCj4gPiAtCQlwZGF0YS0+bm90aWZ5X2F1ZGlvX2xwZShkZXZf
cHJpdi0+bHBlX2F1ZGlvLnBsYXRkZXYsIHBvcnQgLSBQT1JUX0IpOwo+ID4gKwkJcGRhdGEtPm5v
dGlmeV9hdWRpb19scGUoaTkxNS0+bHBlX2F1ZGlvLnBsYXRkZXYsIHBvcnQgLSBQT1JUX0IpOwo+
ID4gICAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmcGRhdGEtPmxwZV9hdWRpb19zbG9jaywgaXJx
ZmxhZ3MpOwo+ID4gICB9Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfbHBlX2F1ZGlvLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9scGVfYXVkaW8uaAo+
ID4gaW5kZXggZjg0OGM1MDM4NzE0Li5kZjQzYWJjZTNjOTUgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9scGVfYXVkaW8uaAo+ID4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfbHBlX2F1ZGlvLmgKPiA+IEBAIC0xMiwxMCArMTIsMTAgQEAgZW51bSBw
aXBlOwo+ID4gICBlbnVtIHBvcnQ7Cj4gPiAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwo+ID4g
LWludCAgaW50ZWxfbHBlX2F1ZGlvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsKPiA+IC12b2lkIGludGVsX2xwZV9hdWRpb190ZWFyZG93bihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgaW50ZWxfbHBlX2F1ZGlvX2lycV9oYW5kbGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpbnRlbF9scGVf
YXVkaW9fbm90aWZ5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpbnQg
IGludGVsX2xwZV9hdWRpb19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+
ICt2b2lkIGludGVsX2xwZV9hdWRpb190ZWFyZG93bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7Cj4gPiArdm9pZCBpbnRlbF9scGVfYXVkaW9faXJxX2hhbmRsZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfbHBlX2F1ZGlvX25vdGlmeShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgIGVudW0gcGlwZSBwaXBlLCBl
bnVtIHBvcnQgcG9ydCwKPiA+ICAgCQkJICAgIGNvbnN0IHZvaWQgKmVsZCwgaW50IGxzX2Nsb2Nr
LCBib29sIGRwX291dHB1dCk7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfbHNwY29uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9sc3Bjb24uYwo+ID4g
aW5kZXggNzAyOGQwY2YzYmIxLi42OTU0NjVmOTcxOTUgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9sc3Bjb24uYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfbHNwY29uLmMKPiA+IEBAIC01NTUsMTAgKzU1NSwxMCBAQCBib29sIGxzcGNvbl9p
bml0KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0KQo+ID4gICAJc3Ry
dWN0IGludGVsX2RwICpkcCA9ICZpbnRlbF9kaWdfcG9ydC0+ZHA7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfbHNwY29uICpsc3Bjb24gPSAmaW50ZWxfZGlnX3BvcnQtPmxzcGNvbjsKPiA+ICAgCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSBpbnRlbF9kaWdfcG9ydC0+YmFzZS5iYXNlLmRldjsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVj
dCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IgPSAmZHAtPmF0dGFjaGVkX2Nvbm5lY3Rvci0+YmFz
ZTsKPiA+IC0JaWYgKCFIQVNfTFNQQ09OKGRldl9wcml2KSkgewo+ID4gKwlpZiAoIUhBU19MU1BD
T04oaTkxNSkpIHsKPiA+ICAgCQlEUk1fRVJST1IoIkxTUENPTiBpcyBub3Qgc3VwcG9ydGVkIG9u
IHRoaXMgcGxhdGZvcm1cbiIpOwo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+ICAgCX0KPiA+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9sdmRzLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9sdmRzLmMKPiA+IGluZGV4IGVmZWZlZDYyYTdmOC4uMDQwNWY5ODM0
ODI3IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHZkcy5jCj4g
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9sdmRzLmMKPiA+IEBAIC04MCw3ICs4
MCw3IEBAIHN0YXRpYyBzdHJ1Y3QgaW50ZWxfbHZkc19lbmNvZGVyICp0b19sdmRzX2VuY29kZXIo
c3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQo+ID4gICAJcmV0dXJuIGNvbnRhaW5lcl9vZihl
bmNvZGVyLCBzdHJ1Y3QgaW50ZWxfbHZkc19lbmNvZGVyLCBiYXNlLmJhc2UpOwo+ID4gICB9Cj4g
PiAtYm9vbCBpbnRlbF9sdmRzX3BvcnRfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiArYm9vbCBpbnRlbF9sdmRzX3BvcnRfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICBpOTE1X3JlZ190IGx2ZHNfcmVnLCBlbnVt
IHBpcGUgKnBpcGUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7Cj4gPiBAQCAtODgsNyArODgsNyBA
QCBib29sIGludGVsX2x2ZHNfcG9ydF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCXZhbCA9IEk5MTVfUkVBRChsdmRzX3JlZyk7Cj4gPiAgIAkvKiBhc3Nl
cnRzIHdhbnQgdG8ga25vdyB0aGUgcGlwZSBldmVuIGlmIHRoZSBwb3J0IGlzIGRpc2FibGVkICov
Cj4gPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikpCj4gPiArCWlmIChIQVNfUENIX0NQVChp
OTE1KSkKPiA+ICAgCQkqcGlwZSA9ICh2YWwgJiBMVkRTX1BJUEVfU0VMX01BU0tfQ1BUKSA+PiBM
VkRTX1BJUEVfU0VMX1NISUZUX0NQVDsKPiA+ICAgCWVsc2UKPiA+ICAgCQkqcGlwZSA9ICh2YWwg
JiBMVkRTX1BJUEVfU0VMX01BU0spID4+IExWRFNfUElQRV9TRUxfU0hJRlQ7Cj4gPiBAQCAtOTks
MTkgKzk5LDE5IEBAIGJvb2wgaW50ZWxfbHZkc19wb3J0X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICBzdGF0aWMgYm9vbCBpbnRlbF9sdmRzX2dldF9od19z
dGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCSAgICBlbnVtIHBp
cGUgKnBpcGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfbHZkc19lbmNvZGVyICpsdmRzX2VuY29kZXIgPSB0b19sdmRzX2VuY29kZXIoJmVuY29kZXIt
PmJhc2UpOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAgIAlib29sIHJldDsK
PiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3By
aXYsCj4gPiArCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5
MTUsCj4gPiAgIAkJCQkJCSAgICAgZW5jb2Rlci0+cG93ZXJfZG9tYWluKTsKPiA+ICAgCWlmICgh
d2FrZXJlZikKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAtCXJldCA9IGludGVsX2x2ZHNfcG9y
dF9lbmFibGVkKGRldl9wcml2LCBsdmRzX2VuY29kZXItPnJlZywgcGlwZSk7Cj4gPiArCXJldCA9
IGludGVsX2x2ZHNfcG9ydF9lbmFibGVkKGk5MTUsIGx2ZHNfZW5jb2Rlci0+cmVnLCBwaXBlKTsK
PiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIGVuY29kZXItPnBvd2VyX2Rv
bWFpbiwgd2FrZXJlZik7Cj4gPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIGVuY29k
ZXItPnBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4g
PiBAQCAtMTE5LDcgKzExOSw3IEBAIHN0YXRpYyBib29sIGludGVsX2x2ZHNfZ2V0X2h3X3N0YXRl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9s
dmRzX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkg
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9sdmRzX2VuY29kZXIgKmx2ZHNfZW5jb2Rl
ciA9IHRvX2x2ZHNfZW5jb2RlcigmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAl1MzIgdG1wLCBmbGFn
cyA9IDA7Cj4gPiBAQCAtMTM3LDEyICsxMzcsMTIgQEAgc3RhdGljIHZvaWQgaW50ZWxfbHZkc19n
ZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJcGlwZV9jb25m
aWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBmbGFnczsKPiA+IC0JaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPCA1KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNSkKPiA+ICAgCQlw
aXBlX2NvbmZpZy0+Z21jaF9wZml0Lmx2ZHNfYm9yZGVyX2JpdHMgPQo+ID4gICAJCQl0bXAgJiBM
VkRTX0JPUkRFUl9FTkFCTEU7Cj4gPiAgIAkvKiBnZW4yLzMgc3RvcmUgZGl0aGVyIHN0YXRlIGlu
IHBmaXQgY29udHJvbCwgbmVlZHMgdG8gbWF0Y2ggKi8KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPCA0KSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA0KSB7Cj4gPiAgIAkJdG1w
ID0gSTkxNV9SRUFEKFBGSVRfQ09OVFJPTCk7Cj4gPiAgIAkJcGlwZV9jb25maWctPmdtY2hfcGZp
dC5jb250cm9sIHw9IHRtcCAmIFBBTkVMXzhUTzZfRElUSEVSX0VOQUJMRTsKPiA+IEBAIC0xNTEs
NyArMTUxLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfbHZkc19nZXRfY29uZmlnKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9k
ZS5jcnRjX2Nsb2NrID0gcGlwZV9jb25maWctPnBvcnRfY2xvY2s7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgdm9pZCBpbnRlbF9sdmRzX3Bwc19nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGludGVsX2x2ZHNfcHBzX2dldF9od19zdGF0
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCQlzdHJ1Y3QgaW50ZWxf
bHZkc19wcHMgKnBwcykKPiA+ICAgewo+ID4gICAJdTMyIHZhbDsKPiA+IEBAIC0xODAsNyArMTgw
LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfbHZkc19wcHNfZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCS8qIENvbnZlcnQgZnJvbSAxMDBtcyB0byAx
MDB1cyB1bml0cyAqLwo+ID4gICAJcHBzLT50NCA9IHZhbCAqIDEwMDA7Cj4gPiAtCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpIDw9IDQgJiYKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8PSA0ICYm
Cj4gPiAgIAkgICAgcHBzLT50MV90MiA9PSAwICYmIHBwcy0+dDUgPT0gMCAmJiBwcHMtPnQzID09
IDAgJiYgcHBzLT50eCA9PSAwKSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiUGFuZWwgcG93ZXIg
dGltaW5ncyB1bmluaXRpYWxpemVkLCAiCj4gPiAgIAkJCSAgICAgICJzZXR0aW5nIGRlZmF1bHRz
XG4iKTsKPiA+IEBAIC0xOTgsNyArMTk4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfbHZkc19wcHNf
Z2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQkJ
IHBwcy0+ZGl2aWRlciwgcHBzLT5wb3J0LCBwcHMtPnBvd2VyZG93bl9vbl9yZXNldCk7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9sdmRzX3Bwc19pbml0X2h3KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9sdmRzX3Bwc19pbml0
X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgc3RydWN0IGlu
dGVsX2x2ZHNfcHBzICpwcHMpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7Cj4gPiBAQCAtMjI5LDI2
ICsyMjksMjYgQEAgc3RhdGljIHZvaWQgaW50ZWxfcHJlX2VuYWJsZV9sdmRzKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
cl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2x2ZHNfZW5j
b2RlciAqbHZkc19lbmNvZGVyID0gdG9fbHZkc19lbmNvZGVyKCZlbmNvZGVyLT5iYXNlKTsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3Rl
ZF9tb2RlOwo+ID4gICAJaW50IHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJdTMyIHRlbXA7Cj4g
PiAtCWlmIChIQVNfUENIX1NQTElUKGRldl9wcml2KSkgewo+ID4gLQkJYXNzZXJ0X2ZkaV9yeF9w
bGxfZGlzYWJsZWQoZGV2X3ByaXYsIHBpcGUpOwo+ID4gLQkJYXNzZXJ0X3NoYXJlZF9kcGxsX2Rp
c2FibGVkKGRldl9wcml2LAo+ID4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkgewo+ID4gKwkJ
YXNzZXJ0X2ZkaV9yeF9wbGxfZGlzYWJsZWQoaTkxNSwgcGlwZSk7Cj4gPiArCQlhc3NlcnRfc2hh
cmVkX2RwbGxfZGlzYWJsZWQoaTkxNSwKPiA+ICAgCQkJCQkgICAgcGlwZV9jb25maWctPnNoYXJl
ZF9kcGxsKTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAtCQlhc3NlcnRfcGxsX2Rpc2FibGVkKGRldl9w
cml2LCBwaXBlKTsKPiA+ICsJCWFzc2VydF9wbGxfZGlzYWJsZWQoaTkxNSwgcGlwZSk7Cj4gPiAg
IAl9Cj4gPiAtCWludGVsX2x2ZHNfcHBzX2luaXRfaHcoZGV2X3ByaXYsICZsdmRzX2VuY29kZXIt
PmluaXRfcHBzKTsKPiA+ICsJaW50ZWxfbHZkc19wcHNfaW5pdF9odyhpOTE1LCAmbHZkc19lbmNv
ZGVyLT5pbml0X3Bwcyk7Cj4gPiAgIAl0ZW1wID0gbHZkc19lbmNvZGVyLT5pbml0X2x2ZHNfdmFs
Owo+ID4gICAJdGVtcCB8PSBMVkRTX1BPUlRfRU4gfCBMVkRTX0EwQTJfQ0xLQV9QT1dFUl9VUDsK
PiA+IC0JaWYgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX1BDSF9DUFQo
aTkxNSkpIHsKPiA+ICAgCQl0ZW1wICY9IH5MVkRTX1BJUEVfU0VMX01BU0tfQ1BUOwo+ID4gICAJ
CXRlbXAgfD0gTFZEU19QSVBFX1NFTF9DUFQocGlwZSk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gQEAg
LTI4Myw3ICsyODMsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wcmVfZW5hYmxlX2x2ZHMoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkgKiBzcGVjaWFsIGx2ZHMgZGl0aGVyIGNv
bnRyb2wgYml0IG9uIHBjaC1zcGxpdCBwbGF0Zm9ybXMsIGRpdGhlcmluZyBpcwo+ID4gICAJICog
b25seSBjb250cm9sbGVkIHRocm91Z2ggdGhlIFBJUEVDT05GIHJlZy4KPiA+ICAgCSAqLwo+ID4g
LQlpZiAoSVNfR0VOKGRldl9wcml2LCA0KSkgewo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDQpKSB7
Cj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBCc3BlYyB3b3JkaW5nIHN1Z2dlc3RzIHRoYXQgTFZEUyBw
b3J0IGRpdGhlcmluZyBvbmx5IGV4aXN0cwo+ID4gICAJCSAqIGZvciAxOGJwcCBwYW5lbHMuCj4g
PiBAQCAtMzExLDE0ICszMTEsMTQgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2x2ZHMoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXYgPSBlbmNvZGVyLT5iYXNlLmRldjsKPiA+ICAgCXN0cnVjdCBpbnRlbF9sdmRzX2Vu
Y29kZXIgKmx2ZHNfZW5jb2RlciA9IHRvX2x2ZHNfZW5jb2RlcigmZW5jb2Rlci0+YmFzZSk7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlJ
OTE1X1dSSVRFKGx2ZHNfZW5jb2Rlci0+cmVnLCBJOTE1X1JFQUQobHZkc19lbmNvZGVyLT5yZWcp
IHwgTFZEU19QT1JUX0VOKTsKPiA+ICAgCUk5MTVfV1JJVEUoUFBfQ09OVFJPTCgwKSwgSTkxNV9S
RUFEKFBQX0NPTlRST0woMCkpIHwgUEFORUxfUE9XRVJfT04pOwo+ID4gICAJUE9TVElOR19SRUFE
KGx2ZHNfZW5jb2Rlci0+cmVnKTsKPiA+IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZk
ZXZfcHJpdi0+dW5jb3JlLAo+ID4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUt
PnVuY29yZSwKPiA+ICAgCQkJCSAgICBQUF9TVEFUVVMoMCksIFBQX09OLCBQUF9PTiwgNTAwMCkp
Cj4gPiAgIAkJRFJNX0VSUk9SKCJ0aW1lZCBvdXQgd2FpdGluZyBmb3IgcGFuZWwgdG8gcG93ZXIg
b25cbiIpOwo+ID4gQEAgLTMzMCwxMCArMzMwLDEwIEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2Fi
bGVfbHZkcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgICAgIGNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKPiA+ICAgewo+
ID4gICAJc3RydWN0IGludGVsX2x2ZHNfZW5jb2RlciAqbHZkc19lbmNvZGVyID0gdG9fbHZkc19l
bmNvZGVyKCZlbmNvZGVyLT5iYXNlKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlJOTE1
X1dSSVRFKFBQX0NPTlRST0woMCksIEk5MTVfUkVBRChQUF9DT05UUk9MKDApKSAmIH5QQU5FTF9Q
T1dFUl9PTik7Cj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVu
Y29yZSwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4g
PiAgIAkJCQkgICAgUFBfU1RBVFVTKDApLCBQUF9PTiwgMCwgMTAwMCkpCj4gPiAgIAkJRFJNX0VS
Uk9SKCJ0aW1lZCBvdXQgd2FpdGluZyBmb3IgcGFuZWwgdG8gcG93ZXIgb2ZmXG4iKTsKPiA+IEBA
IC0zODksNyArMzg5LDcgQEAgc3RhdGljIGludCBpbnRlbF9sdmRzX2NvbXB1dGVfY29uZmlnKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+ID4gICAJCQkJICAgICBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gPiAgIAkJCQkgICAgIHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoaW50ZWxfZW5jb2Rlci0+YmFzZS5kZXYpOwo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2x2ZHNfZW5jb2RlciAqbHZkc19lbmNv
ZGVyID0KPiA+ICAgCQl0b19sdmRzX2VuY29kZXIoJmludGVsX2VuY29kZXItPmJhc2UpOwo+ID4g
ICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9yID0KPiA+IEBAIC0zOTks
NyArMzk5LDcgQEAgc3RhdGljIGludCBpbnRlbF9sdmRzX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+ID4gICAJdW5zaWduZWQgaW50IGx2ZHNfYnBw
Owo+ID4gICAJLyogU2hvdWxkIG5ldmVyIGhhcHBlbiEhICovCj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpIDwgNCAmJiBpbnRlbF9jcnRjLT5waXBlID09IDApIHsKPiA+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA8IDQgJiYgaW50ZWxfY3J0Yy0+cGlwZSA9PSAwKSB7Cj4gPiAgIAkJRFJNX0VS
Uk9SKCJDYW4ndCBzdXBwb3J0IExWRFMgb24gcGlwZSBBXG4iKTsKPiA+ICAgCQlyZXR1cm4gLUVJ
TlZBTDsKPiA+ICAgCX0KPiA+IEBAIC00MjksNyArNDI5LDcgQEAgc3RhdGljIGludCBpbnRlbF9s
dmRzX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+
ID4gICAJaWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19EQkxTQ0FOKQo+
ID4gICAJCXJldHVybiAtRUlOVkFMOwo+ID4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikp
IHsKPiA+ICsJaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpIHsKPiA+ICAgCQlwaXBlX2NvbmZpZy0+
aGFzX3BjaF9lbmNvZGVyID0gdHJ1ZTsKPiA+ICAgCQlpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhp
bnRlbF9jcnRjLCBwaXBlX2NvbmZpZywKPiA+IEBAIC03NTEsMTEgKzc1MSwxMSBAQCBzdGF0aWMg
Y29uc3Qgc3RydWN0IGRtaV9zeXN0ZW1faWQgaW50ZWxfZHVhbF9saW5rX2x2ZHNbXSA9IHsKPiA+
ICAgCXsgfQkvKiB0ZXJtaW5hdGluZyBlbnRyeSAqLwo+ID4gICB9Owo+ID4gLXN0cnVjdCBpbnRl
bF9lbmNvZGVyICppbnRlbF9nZXRfbHZkc19lbmNvZGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiA+ICtzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZ2V0X2x2ZHNfZW5j
b2RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXI7Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2VuY29kZXIoJmRl
dl9wcml2LT5kcm0sIGVuY29kZXIpIHsKPiA+ICsJZm9yX2VhY2hfaW50ZWxfZW5jb2RlcigmaTkx
NS0+ZHJtLCBlbmNvZGVyKSB7Cj4gPiAgIAkJaWYgKGVuY29kZXItPnR5cGUgPT0gSU5URUxfT1VU
UFVUX0xWRFMpCj4gPiAgIAkJCXJldHVybiBlbmNvZGVyOwo+ID4gICAJfQo+ID4gQEAgLTc2Myw5
ICs3NjMsOSBAQCBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZ2V0X2x2ZHNfZW5jb2Rlcihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlyZXR1cm4gTlVMTDsKPiA+
ICAgfQo+ID4gLWJvb2wgaW50ZWxfaXNfZHVhbF9saW5rX2x2ZHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK2Jvb2wgaW50ZWxfaXNfZHVhbF9saW5rX2x2ZHMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIgPSBpbnRlbF9nZXRfbHZkc19lbmNvZGVyKGRldl9wcml2KTsKPiA+ICsJc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIgPSBpbnRlbF9nZXRfbHZkc19lbmNvZGVyKGk5MTUp
Owo+ID4gICAJcmV0dXJuIGVuY29kZXIgJiYgdG9fbHZkc19lbmNvZGVyKCZlbmNvZGVyLT5iYXNl
KS0+aXNfZHVhbF9saW5rOwo+ID4gICB9Cj4gPiBAQCAtNzc0LDcgKzc3NCw3IEBAIHN0YXRpYyBi
b29sIGNvbXB1dGVfaXNfZHVhbF9saW5rX2x2ZHMoc3RydWN0IGludGVsX2x2ZHNfZW5jb2RlciAq
bHZkc19lbmNvZGVyKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gbHZk
c19lbmNvZGVyLT5iYXNlLmJhc2UuZGV2Owo+ID4gICAJdW5zaWduZWQgaW50IHZhbDsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCS8qIHVz
ZSB0aGUgbW9kdWxlIG9wdGlvbiB2YWx1ZSBpZiBzcGVjaWZpZWQgKi8KPiA+ICAgCWlmIChpOTE1
X21vZHBhcmFtcy5sdmRzX2NoYW5uZWxfbW9kZSA+IDApCj4gPiBAQCAtNzk0LDI2ICs3OTQsMjYg
QEAgc3RhdGljIGJvb2wgY29tcHV0ZV9pc19kdWFsX2xpbmtfbHZkcyhzdHJ1Y3QgaW50ZWxfbHZk
c19lbmNvZGVyICpsdmRzX2VuY29kZXIpCj4gPiAgIAkgKiByZWdpc3RlciBpcyB1bmluaXRpYWxp
emVkLgo+ID4gICAJICovCj4gPiAgIAl2YWwgPSBJOTE1X1JFQUQobHZkc19lbmNvZGVyLT5yZWcp
Owo+ID4gLQlpZiAoSEFTX1BDSF9DUFQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFTX1BDSF9DUFQo
aTkxNSkpCj4gPiAgIAkJdmFsICY9IH4oTFZEU19ERVRFQ1RFRCB8IExWRFNfUElQRV9TRUxfTUFT
S19DUFQpOwo+ID4gICAJZWxzZQo+ID4gICAJCXZhbCAmPSB+KExWRFNfREVURUNURUQgfCBMVkRT
X1BJUEVfU0VMX01BU0spOwo+ID4gICAJaWYgKHZhbCA9PSAwKQo+ID4gLQkJdmFsID0gZGV2X3By
aXYtPnZidC5iaW9zX2x2ZHNfdmFsOwo+ID4gKwkJdmFsID0gaTkxNS0+dmJ0LmJpb3NfbHZkc192
YWw7Cj4gPiAgIAlyZXR1cm4gKHZhbCAmIExWRFNfQ0xLQl9QT1dFUl9NQVNLKSA9PSBMVkRTX0NM
S0JfUE9XRVJfVVA7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX2x2ZHNfaW5pdCAt
IHNldHVwIExWRFMgY29ubmVjdG9ycyBvbiB0aGlzIGRldmljZQo+ID4gLSAqIEBkZXZfcHJpdjog
aTkxNSBkZXZpY2UKPiA+ICsgKiBAaTkxNTogaTkxNSBkZXZpY2UKPiA+ICAgICoKPiA+ICAgICog
Q3JlYXRlIHRoZSBjb25uZWN0b3IsIHJlZ2lzdGVyIHRoZSBMVkRTIEREQyBidXMsIGFuZCB0cnkg
dG8gZmlndXJlIG91dCB3aGF0Cj4gPiAgICAqIG1vZGVzIHdlIGNhbiBkaXNwbGF5IG9uIHRoZSBM
VkRTIHBhbmVsIChpZiBwcmVzZW50KS4KPiA+ICAgICovCj4gPiAtdm9pZCBpbnRlbF9sdmRzX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfbHZk
c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKPiA+ICsJc3RydWN0IGRybV9kZXZp
Y2UgKmRldiA9ICZpOTE1LT5kcm07Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfbHZkc19lbmNvZGVyICps
dmRzX2VuY29kZXI7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlcjsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvcjsKPiA+IEBAIC04
MjksMzAgKzgyOSwzMCBAQCB2b2lkIGludGVsX2x2ZHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkvKiBTa2lwIGluaXQgb24gbWFjaGluZXMgd2Uga25vdyBm
YWxzZWx5IHJlcG9ydCBMVkRTICovCj4gPiAgIAlpZiAoZG1pX2NoZWNrX3N5c3RlbShpbnRlbF9u
b19sdmRzKSkgewo+ID4gLQkJV0FSTighZGV2X3ByaXYtPnZidC5pbnRfbHZkc19zdXBwb3J0LAo+
ID4gKwkJV0FSTighaTkxNS0+dmJ0LmludF9sdmRzX3N1cHBvcnQsCj4gPiAgIAkJICAgICAiVXNl
bGVzcyBETUkgbWF0Y2guIEludGVybmFsIExWRFMgc3VwcG9ydCBkaXNhYmxlZCBieSBWQlRcbiIp
Owo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0JaWYgKCFkZXZfcHJpdi0+dmJ0LmludF9s
dmRzX3N1cHBvcnQpIHsKPiA+ICsJaWYgKCFpOTE1LT52YnQuaW50X2x2ZHNfc3VwcG9ydCkgewo+
ID4gICAJCURSTV9ERUJVR19LTVMoIkludGVybmFsIExWRFMgc3VwcG9ydCBkaXNhYmxlZCBieSBW
QlRcbiIpOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0JaWYgKEhBU19QQ0hfU1BMSVQo
ZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkKPiA+ICAgCQlsdmRzX3Jl
ZyA9IFBDSF9MVkRTOwo+ID4gICAJZWxzZQo+ID4gICAJCWx2ZHNfcmVnID0gTFZEUzsKPiA+ICAg
CWx2ZHMgPSBJOTE1X1JFQUQobHZkc19yZWcpOwo+ID4gLQlpZiAoSEFTX1BDSF9TUExJVChkZXZf
cHJpdikpIHsKPiA+ICsJaWYgKEhBU19QQ0hfU1BMSVQoaTkxNSkpIHsKPiA+ICAgCQlpZiAoKGx2
ZHMgJiBMVkRTX0RFVEVDVEVEKSA9PSAwKQo+ID4gICAJCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiAg
IAlwaW4gPSBHTUJVU19QSU5fUEFORUw7Cj4gPiAtCWlmICghaW50ZWxfYmlvc19pc19sdmRzX3By
ZXNlbnQoZGV2X3ByaXYsICZwaW4pKSB7Cj4gPiArCWlmICghaW50ZWxfYmlvc19pc19sdmRzX3By
ZXNlbnQoaTkxNSwgJnBpbikpIHsKPiA+ICAgCQlpZiAoKGx2ZHMgJiBMVkRTX1BPUlRfRU4pID09
IDApIHsKPiA+ICAgCQkJRFJNX0RFQlVHX0tNUygiTFZEUyBpcyBub3QgcHJlc2VudCBpbiBWQlRc
biIpOwo+ID4gICAJCQlyZXR1cm47Cj4gPiBAQCAtODg0LDcgKzg4NCw3IEBAIHZvaWQgaW50ZWxf
bHZkc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCWludGVs
X2VuY29kZXItPmVuYWJsZSA9IGludGVsX2VuYWJsZV9sdmRzOwo+ID4gICAJaW50ZWxfZW5jb2Rl
ci0+cHJlX2VuYWJsZSA9IGludGVsX3ByZV9lbmFibGVfbHZkczsKPiA+ICAgCWludGVsX2VuY29k
ZXItPmNvbXB1dGVfY29uZmlnID0gaW50ZWxfbHZkc19jb21wdXRlX2NvbmZpZzsKPiA+IC0JaWYg
KEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChIQVNfUENIX1NQTElUKGk5MTUp
KSB7Cj4gPiAgIAkJaW50ZWxfZW5jb2Rlci0+ZGlzYWJsZSA9IHBjaF9kaXNhYmxlX2x2ZHM7Cj4g
PiAgIAkJaW50ZWxfZW5jb2Rlci0+cG9zdF9kaXNhYmxlID0gcGNoX3Bvc3RfZGlzYWJsZV9sdmRz
Owo+ID4gICAJfSBlbHNlIHsKPiA+IEBAIC05MDEsOSArOTAxLDkgQEAgdm9pZCBpbnRlbF9sdmRz
X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJaW50ZWxfZW5j
b2Rlci0+cG93ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1BPUlRfT1RIRVI7Cj4gPiAgIAlpbnRl
bF9lbmNvZGVyLT5wb3J0ID0gUE9SVF9OT05FOwo+ID4gICAJaW50ZWxfZW5jb2Rlci0+Y2xvbmVh
YmxlID0gMDsKPiA+IC0JaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFT
X1BDSF9TUExJVChpOTE1KSkKPiA+ICAgCQlpbnRlbF9lbmNvZGVyLT5jcnRjX21hc2sgPSAoMSA8
PCAwKSB8ICgxIDw8IDEpIHwgKDEgPDwgMik7Cj4gPiAtCWVsc2UgaWYgKElTX0dFTihkZXZfcHJp
diwgNCkpCj4gPiArCWVsc2UgaWYgKElTX0dFTihpOTE1LCA0KSkKPiA+ICAgCQlpbnRlbF9lbmNv
ZGVyLT5jcnRjX21hc2sgPSAoMSA8PCAwKSB8ICgxIDw8IDEpOwo+ID4gICAJZWxzZQo+ID4gICAJ
CWludGVsX2VuY29kZXItPmNydGNfbWFzayA9ICgxIDw8IDEpOwo+ID4gQEAgLTkyMiw3ICs5MjIs
NyBAQCB2b2lkIGludGVsX2x2ZHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiAgIAlkcm1fY29ubmVjdG9yX2F0dGFjaF9zY2FsaW5nX21vZGVfcHJvcGVydHkoY29u
bmVjdG9yLCBhbGxvd2VkX3NjYWxlcnMpOwo+ID4gICAJY29ubmVjdG9yLT5zdGF0ZS0+c2NhbGlu
Z19tb2RlID0gRFJNX01PREVfU0NBTEVfQVNQRUNUOwo+ID4gLQlpbnRlbF9sdmRzX3Bwc19nZXRf
aHdfc3RhdGUoZGV2X3ByaXYsICZsdmRzX2VuY29kZXItPmluaXRfcHBzKTsKPiA+ICsJaW50ZWxf
bHZkc19wcHNfZ2V0X2h3X3N0YXRlKGk5MTUsICZsdmRzX2VuY29kZXItPmluaXRfcHBzKTsKPiA+
ICAgCWx2ZHNfZW5jb2Rlci0+aW5pdF9sdmRzX3ZhbCA9IGx2ZHM7Cj4gPiAgIAkvKgo+ID4gQEAg
LTk0MCwxMCArOTQwLDEwIEBAIHZvaWQgaW50ZWxfbHZkc19pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICAgCW11dGV4X2xvY2soJmRldi0+bW9kZV9jb25maWcubXV0
ZXgpOwo+ID4gICAJaWYgKHZnYV9zd2l0Y2hlcm9vX2hhbmRsZXJfZmxhZ3MoKSAmIFZHQV9TV0lU
Q0hFUk9PX0NBTl9TV0lUQ0hfRERDKQo+ID4gICAJCWVkaWQgPSBkcm1fZ2V0X2VkaWRfc3dpdGNo
ZXJvbyhjb25uZWN0b3IsCj4gPiAtCQkJCSAgICBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihkZXZf
cHJpdiwgcGluKSk7Cj4gPiArCQkJCSAgICBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihpOTE1LCBw
aW4pKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQllZGlkID0gZHJtX2dldF9lZGlkKGNvbm5lY3RvciwK
PiA+IC0JCQkJICAgIGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGRldl9wcml2LCBwaW4pKTsKPiA+
ICsJCQkJICAgIGludGVsX2dtYnVzX2dldF9hZGFwdGVyKGk5MTUsIHBpbikpOwo+ID4gICAJaWYg
KGVkaWQpIHsKPiA+ICAgCQlpZiAoZHJtX2FkZF9lZGlkX21vZGVzKGNvbm5lY3RvciwgZWRpZCkp
IHsKPiA+ICAgCQkJZHJtX2Nvbm5lY3Rvcl91cGRhdGVfZWRpZF9wcm9wZXJ0eShjb25uZWN0b3Is
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHZkcy5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHZkcy5oCj4gPiBpbmRleCBiYzljOGI4NGJhMmYuLjRh
ZmRjYjRkNjM1MiAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2x2
ZHMuaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfbHZkcy5oCj4gPiBAQCAt
MTMsMTAgKzEzLDEwIEBACj4gPiAgIGVudW0gcGlwZTsKPiA+ICAgc3RydWN0IGRybV9pOTE1X3By
aXZhdGU7Cj4gPiAtYm9vbCBpbnRlbF9sdmRzX3BvcnRfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArYm9vbCBpbnRlbF9sdmRzX3BvcnRfZW5hYmxlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICBpOTE1X3JlZ190IGx2ZHNf
cmVnLCBlbnVtIHBpcGUgKnBpcGUpOwo+ID4gLXZvaWQgaW50ZWxfbHZkc19pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtc3RydWN0IGludGVsX2VuY29kZXIgKmlu
dGVsX2dldF9sdmRzX2VuY29kZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsK
PiA+IC1ib29sIGludGVsX2lzX2R1YWxfbGlua19sdmRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cj4gPiArdm9pZCBpbnRlbF9sdmRzX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ID4gK3N0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9nZXRfbHZkc19l
bmNvZGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICtib29sIGludGVsX2lz
X2R1YWxfbGlua19sdmRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgI2Vu
ZGlmIC8qIF9fSU5URUxfTFZEU19IX18gKi8KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9vcHJlZ2lvbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3By
ZWdpb24uYwo+ID4gaW5kZXggOGZhMTE1OWQwOTdmLi42Y2JlNzc1ZDc1MzcgMTAwNjQ0Cj4gPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vcHJlZ2lvbi5jCj4gPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vcHJlZ2lvbi5jCj4gPiBAQCAtMjY2LDExICsyNjYsMTEg
QEAgc3RydWN0IG9wcmVnaW9uX2FzbGVfZXh0IHsKPiA+ICAgI2RlZmluZSBNQVhfRFNMUAkxNTAw
Cj4gPiAtc3RhdGljIGludCBzd3NjaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiArc3RhdGljIGludCBzd3NjaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+
ICAgCQkgdTMyIGZ1bmN0aW9uLCB1MzIgcGFybSwgdTMyICpwYXJtX291dCkKPiA+ICAgewo+ID4g
LQlzdHJ1Y3Qgb3ByZWdpb25fc3dzY2kgKnN3c2NpID0gZGV2X3ByaXYtPm9wcmVnaW9uLnN3c2Np
Owo+ID4gLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRldl9wcml2LT5kcm0ucGRldjsKPiA+ICsJ
c3RydWN0IG9wcmVnaW9uX3N3c2NpICpzd3NjaSA9IGk5MTUtPm9wcmVnaW9uLnN3c2NpOwo+ID4g
KwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2Owo+ID4gICAJdTMyIG1haW5f
ZnVuY3Rpb24sIHN1Yl9mdW5jdGlvbiwgc2NpYzsKPiA+ICAgCXUxNiBzd3NjaV92YWw7Cj4gPiAg
IAl1MzIgZHNscDsKPiA+IEBAIC0yODUsMTEgKzI4NSwxMSBAQCBzdGF0aWMgaW50IHN3c2NpKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCS8qIENoZWNrIGlmIHdlIGNh
biBjYWxsIHRoZSBmdW5jdGlvbi4gU2VlIHN3c2NpX3NldHVwIGZvciBkZXRhaWxzLiAqLwo+ID4g
ICAJaWYgKG1haW5fZnVuY3Rpb24gPT0gU1dTQ0lfU0JDQikgewo+ID4gLQkJaWYgKChkZXZfcHJp
di0+b3ByZWdpb24uc3dzY2lfc2JjYl9zdWJfZnVuY3Rpb25zICYKPiA+ICsJCWlmICgoaTkxNS0+
b3ByZWdpb24uc3dzY2lfc2JjYl9zdWJfZnVuY3Rpb25zICYKPiA+ICAgCQkgICAgICgxIDw8IHN1
Yl9mdW5jdGlvbikpID09IDApCj4gPiAgIAkJCXJldHVybiAtRUlOVkFMOwo+ID4gICAJfSBlbHNl
IGlmIChtYWluX2Z1bmN0aW9uID09IFNXU0NJX0dCREEpIHsKPiA+IC0JCWlmICgoZGV2X3ByaXYt
Pm9wcmVnaW9uLnN3c2NpX2diZGFfc3ViX2Z1bmN0aW9ucyAmCj4gPiArCQlpZiAoKGk5MTUtPm9w
cmVnaW9uLnN3c2NpX2diZGFfc3ViX2Z1bmN0aW9ucyAmCj4gPiAgIAkJICAgICAoMSA8PCBzdWJf
ZnVuY3Rpb24pKSA9PSAwKQo+ID4gICAJCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICAgCX0KPiA+IEBA
IC0zNjMsMTMgKzM2MywxMyBAQCBzdGF0aWMgaW50IHN3c2NpKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICAgaW50IGludGVsX29wcmVnaW9uX25vdGlmeV9lbmNvZGVyKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+ID4gICAJCQkJICBib29sIGVuYWJs
ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGludGVsX2VuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGludGVsX2VuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXUzMiBw
YXJtID0gMDsKPiA+ICAgCXUzMiB0eXBlID0gMDsKPiA+ICAgCXUzMiBwb3J0Owo+ID4gICAJLyog
ZG9uJ3QgY2FyZSBhYm91dCBvbGQgc3R1ZmYgZm9yIG5vdyAqLwo+ID4gLQlpZiAoIUhBU19EREko
ZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19EREkoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIDA7Cj4g
PiAgIAlpZiAoaW50ZWxfZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9PVVRQVVRfRFNJKQo+ID4gQEAg
LTQwOSw3ICs0MDksNyBAQCBpbnQgaW50ZWxfb3ByZWdpb25fbm90aWZ5X2VuY29kZXIoc3RydWN0
IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCj4gPiAgIAlwYXJtIHw9IHR5cGUgPDwgKDE2
ICsgcG9ydCAqIDMpOwo+ID4gLQlyZXR1cm4gc3dzY2koZGV2X3ByaXYsIFNXU0NJX1NCQ0JfRElT
UExBWV9QT1dFUl9TVEFURSwgcGFybSwgTlVMTCk7Cj4gPiArCXJldHVybiBzd3NjaShpOTE1LCBT
V1NDSV9TQkNCX0RJU1BMQVlfUE9XRVJfU1RBVEUsIHBhcm0sIE5VTEwpOwo+ID4gICB9Cj4gPiAg
IHN0YXRpYyBjb25zdCBzdHJ1Y3Qgewo+ID4gQEAgLTQyMywyOSArNDIzLDI5IEBAIHN0YXRpYyBj
b25zdCBzdHJ1Y3Qgewo+ID4gICAJeyBQQ0lfRDNjb2xkLAkweDA0IH0sCj4gPiAgIH07Cj4gPiAt
aW50IGludGVsX29wcmVnaW9uX25vdGlmeV9hZGFwdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtpbnQgaW50ZWxfb3ByZWdpb25fbm90aWZ5X2FkYXB0ZXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgIHBjaV9wb3dlcl90IHN0YXRlKQo+
ID4gICB7Cj4gPiAgIAlpbnQgaTsKPiA+IC0JaWYgKCFIQVNfRERJKGRldl9wcml2KSkKPiA+ICsJ
aWYgKCFIQVNfRERJKGk5MTUpKQo+ID4gICAJCXJldHVybiAwOwo+ID4gICAJZm9yIChpID0gMDsg
aSA8IEFSUkFZX1NJWkUocG93ZXJfc3RhdGVfbWFwKTsgaSsrKSB7Cj4gPiAgIAkJaWYgKHN0YXRl
ID09IHBvd2VyX3N0YXRlX21hcFtpXS5wY2lfcG93ZXJfc3RhdGUpCj4gPiAtCQkJcmV0dXJuIHN3
c2NpKGRldl9wcml2LCBTV1NDSV9TQkNCX0FEQVBURVJfUE9XRVJfU1RBVEUsCj4gPiArCQkJcmV0
dXJuIHN3c2NpKGk5MTUsIFNXU0NJX1NCQ0JfQURBUFRFUl9QT1dFUl9TVEFURSwKPiA+ICAgCQkJ
CSAgICAgcG93ZXJfc3RhdGVfbWFwW2ldLnBhcm0sIE5VTEwpOwo+ID4gICAJfQo+ID4gICAJcmV0
dXJuIC1FSU5WQUw7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTMyIGFzbGVfc2V0X2JhY2tsaWdodChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBiY2xwKQo+ID4gK3N0YXRpYyB1
MzIgYXNsZV9zZXRfYmFja2xpZ2h0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIg
YmNscCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yOwo+
ID4gICAJc3RydWN0IGRybV9jb25uZWN0b3JfbGlzdF9pdGVyIGNvbm5faXRlcjsKPiA+IC0Jc3Ry
dWN0IG9wcmVnaW9uX2FzbGUgKmFzbGUgPSBkZXZfcHJpdi0+b3ByZWdpb24uYXNsZTsKPiA+IC0J
c3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOwo+ID4gKwlzdHJ1Y3Qgb3By
ZWdpb25fYXNsZSAqYXNsZSA9IGk5MTUtPm9wcmVnaW9uLmFzbGU7Cj4gPiArCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYgPSAmaTkxNS0+ZHJtOwo+ID4gICAJRFJNX0RFQlVHX0RSSVZFUigiYmNscCA9
IDB4JTA4eFxuIiwgYmNscCk7Cj4gPiBAQCAtNDgwLDcgKzQ4MCw3IEBAIHN0YXRpYyB1MzIgYXNs
ZV9zZXRfYmFja2xpZ2h0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGJj
bHApCj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4gLXN0YXRpYyB1MzIgYXNsZV9zZXRfYWxz
X2lsbHVtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGFsc2kpCj4gPiAr
c3RhdGljIHUzMiBhc2xlX3NldF9hbHNfaWxsdW0oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsIHUzMiBhbHNpKQo+ID4gICB7Cj4gPiAgIAkvKiBhbHNpIGlzIHRoZSBjdXJyZW50IEFMUyBy
ZWFkaW5nIGluIGx1eC4gMCBpbmRpY2F0ZXMgYmVsb3cgc2Vuc29yCj4gPiAgIAkgICByYW5nZSwg
MHhmZmZmIGluZGljYXRlcyBhYm92ZSBzZW5zb3IgcmFuZ2UuIDEtMHhmZmZlIGFyZSB2YWxpZCAq
Lwo+ID4gQEAgLTQ4OCwxMyArNDg4LDEzIEBAIHN0YXRpYyB1MzIgYXNsZV9zZXRfYWxzX2lsbHVt
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGFsc2kpCj4gPiAgIAlyZXR1
cm4gQVNMQ19BTFNfSUxMVU1fRkFJTEVEOwo+ID4gICB9Cj4gPiAtc3RhdGljIHUzMiBhc2xlX3Nl
dF9wd21fZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwZm1iKQo+
ID4gK3N0YXRpYyB1MzIgYXNsZV9zZXRfcHdtX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsIHUzMiBwZm1iKQo+ID4gICB7Cj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJQV00gZnJl
cSBpcyBub3Qgc3VwcG9ydGVkXG4iKTsKPiA+ICAgCXJldHVybiBBU0xDX1BXTV9GUkVRX0ZBSUxF
RDsKPiA+ICAgfQo+ID4gLXN0YXRpYyB1MzIgYXNsZV9zZXRfcGZpdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwZml0KQo+ID4gK3N0YXRpYyB1MzIgYXNsZV9zZXRfcGZp
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIHBmaXQpCj4gPiAgIHsKPiA+ICAg
CS8qIFBhbmVsIGZpdHRpbmcgaXMgY3VycmVudGx5IGNvbnRyb2xsZWQgYnkgdGhlIFggY29kZSwg
c28gdGhpcyBpcyBhCj4gPiAgIAkgICBub29wIHVudGlsIG1vZGVzZXR0aW5nIHN1cHBvcnQgd29y
a3MgZnVsbHkgKi8KPiA+IEBAIC01MDIsMTMgKzUwMiwxMyBAQCBzdGF0aWMgdTMyIGFzbGVfc2V0
X3BmaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcGZpdCkKPiA+ICAg
CXJldHVybiBBU0xDX1BGSVRfRkFJTEVEOwo+ID4gICB9Cj4gPiAtc3RhdGljIHUzMiBhc2xlX3Nl
dF9zdXBwb3J0ZWRfcm90YXRpb25fYW5nbGVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgdTMyIHNyb3QpCj4gPiArc3RhdGljIHUzMiBhc2xlX3NldF9zdXBwb3J0ZWRfcm90YXRp
b25fYW5nbGVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgc3JvdCkKPiA+ICAg
ewo+ID4gICAJRFJNX0RFQlVHX0RSSVZFUigiU1JPVCBpcyBub3Qgc3VwcG9ydGVkXG4iKTsKPiA+
ICAgCXJldHVybiBBU0xDX1JPVEFUSU9OX0FOR0xFU19GQUlMRUQ7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgdTMyIGFzbGVfc2V0X2J1dHRvbl9hcnJheShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIHUzMiBpdWVyKQo+ID4gK3N0YXRpYyB1MzIgYXNsZV9zZXRfYnV0dG9uX2FycmF5KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgaXVlcikKPiA+ICAgewo+ID4gICAJaWYg
KCFpdWVyKQo+ID4gICAJCURSTV9ERUJVR19EUklWRVIoIkJ1dHRvbiBhcnJheSBldmVudCBpcyBu
b3Qgc3VwcG9ydGVkIChub3RoaW5nKVxuIik7Cj4gPiBAQCAtNTI2LDcgKzUyNiw3IEBAIHN0YXRp
YyB1MzIgYXNsZV9zZXRfYnV0dG9uX2FycmF5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgdTMyIGl1ZXIpCj4gPiAgIAlyZXR1cm4gQVNMQ19CVVRUT05fQVJSQVlfRkFJTEVEOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHUzMiBhc2xlX3NldF9jb252ZXJ0aWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBpdWVyKQo+ID4gK3N0YXRpYyB1MzIgYXNsZV9zZXRf
Y29udmVydGlibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBpdWVyKQo+ID4g
ICB7Cj4gPiAgIAlpZiAoaXVlciAmIEFTTEVfSVVFUl9DT05WRVJUSUJMRSkKPiA+ICAgCQlEUk1f
REVCVUdfRFJJVkVSKCJDb252ZXJ0aWJsZSBpcyBub3Qgc3VwcG9ydGVkIChjbGFtc2hlbGwpXG4i
KTsKPiA+IEBAIC01MzYsNyArNTM2LDcgQEAgc3RhdGljIHUzMiBhc2xlX3NldF9jb252ZXJ0aWJs
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBpdWVyKQo+ID4gICAJcmV0
dXJuIEFTTENfQ09OVkVSVElCTEVfRkFJTEVEOwo+ID4gICB9Cj4gPiAtc3RhdGljIHUzMiBhc2xl
X3NldF9kb2NraW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIGl1ZXIp
Cj4gPiArc3RhdGljIHUzMiBhc2xlX3NldF9kb2NraW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCB1MzIgaXVlcikKPiA+ICAgewo+ID4gICAJaWYgKGl1ZXIgJiBBU0xFX0lVRVJfRE9D
S0lORykKPiA+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJEb2NraW5nIGlzIG5vdCBzdXBwb3J0ZWQg
KGRvY2tlZClcbiIpOwo+ID4gQEAgLTU0Niw3ICs1NDYsNyBAQCBzdGF0aWMgdTMyIGFzbGVfc2V0
X2RvY2tpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgaXVlcikKPiA+
ICAgCXJldHVybiBBU0xDX0RPQ0tJTkdfRkFJTEVEOwo+ID4gICB9Cj4gPiAtc3RhdGljIHUzMiBh
c2xlX2lzY3Rfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0
YXRpYyB1MzIgYXNsZV9pc2N0X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJJU0NUIGlzIG5vdCBzdXBwb3J0ZWRcbiIp
Owo+ID4gICAJcmV0dXJuIEFTTENfSVNDVF9TVEFURV9GQUlMRUQ7Cj4gPiBAQCAtNTU2LDkgKzU1
Niw5IEBAIHN0YXRpYyB2b2lkIGFzbGVfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4g
PiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9vcHJlZ2lvbiAqb3ByZWdpb24gPQo+ID4gICAJCWNv
bnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgaW50ZWxfb3ByZWdpb24sIGFzbGVfd29yayk7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0KPiA+ICAgCQljb250YWluZXJfb2Yob3ByZWdpb24sIHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlLCBvcHJlZ2lvbik7Cj4gPiAtCXN0cnVjdCBvcHJlZ2lvbl9hc2xlICph
c2xlID0gZGV2X3ByaXYtPm9wcmVnaW9uLmFzbGU7Cj4gPiArCXN0cnVjdCBvcHJlZ2lvbl9hc2xl
ICphc2xlID0gaTkxNS0+b3ByZWdpb24uYXNsZTsKPiA+ICAgCXUzMiBhc2xjX3N0YXQgPSAwOwo+
ID4gICAJdTMyIGFzbGNfcmVxOwo+ID4gQEAgLTU3NCw0MCArNTc0LDQwIEBAIHN0YXRpYyB2b2lk
IGFzbGVfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCj4gPiAgIAl9Cj4gPiAgIAlpZiAo
YXNsY19yZXEgJiBBU0xDX1NFVF9BTFNfSUxMVU0pCj4gPiAtCQlhc2xjX3N0YXQgfD0gYXNsZV9z
ZXRfYWxzX2lsbHVtKGRldl9wcml2LCBhc2xlLT5hbHNpKTsKPiA+ICsJCWFzbGNfc3RhdCB8PSBh
c2xlX3NldF9hbHNfaWxsdW0oaTkxNSwgYXNsZS0+YWxzaSk7Cj4gPiAgIAlpZiAoYXNsY19yZXEg
JiBBU0xDX1NFVF9CQUNLTElHSFQpCj4gPiAtCQlhc2xjX3N0YXQgfD0gYXNsZV9zZXRfYmFja2xp
Z2h0KGRldl9wcml2LCBhc2xlLT5iY2xwKTsKPiA+ICsJCWFzbGNfc3RhdCB8PSBhc2xlX3NldF9i
YWNrbGlnaHQoaTkxNSwgYXNsZS0+YmNscCk7Cj4gPiAgIAlpZiAoYXNsY19yZXEgJiBBU0xDX1NF
VF9QRklUKQo+ID4gLQkJYXNsY19zdGF0IHw9IGFzbGVfc2V0X3BmaXQoZGV2X3ByaXYsIGFzbGUt
PnBmaXQpOwo+ID4gKwkJYXNsY19zdGF0IHw9IGFzbGVfc2V0X3BmaXQoaTkxNSwgYXNsZS0+cGZp
dCk7Cj4gPiAgIAlpZiAoYXNsY19yZXEgJiBBU0xDX1NFVF9QV01fRlJFUSkKPiA+IC0JCWFzbGNf
c3RhdCB8PSBhc2xlX3NldF9wd21fZnJlcShkZXZfcHJpdiwgYXNsZS0+cGZtYik7Cj4gPiArCQlh
c2xjX3N0YXQgfD0gYXNsZV9zZXRfcHdtX2ZyZXEoaTkxNSwgYXNsZS0+cGZtYik7Cj4gPiAgIAlp
ZiAoYXNsY19yZXEgJiBBU0xDX1NVUFBPUlRFRF9ST1RBVElPTl9BTkdMRVMpCj4gPiAtCQlhc2xj
X3N0YXQgfD0gYXNsZV9zZXRfc3VwcG9ydGVkX3JvdGF0aW9uX2FuZ2xlcyhkZXZfcHJpdiwKPiA+
ICsJCWFzbGNfc3RhdCB8PSBhc2xlX3NldF9zdXBwb3J0ZWRfcm90YXRpb25fYW5nbGVzKGk5MTUs
Cj4gPiAgIAkJCQkJCQlhc2xlLT5zcm90KTsKPiA+ICAgCWlmIChhc2xjX3JlcSAmIEFTTENfQlVU
VE9OX0FSUkFZKQo+ID4gLQkJYXNsY19zdGF0IHw9IGFzbGVfc2V0X2J1dHRvbl9hcnJheShkZXZf
cHJpdiwgYXNsZS0+aXVlcik7Cj4gPiArCQlhc2xjX3N0YXQgfD0gYXNsZV9zZXRfYnV0dG9uX2Fy
cmF5KGk5MTUsIGFzbGUtPml1ZXIpOwo+ID4gICAJaWYgKGFzbGNfcmVxICYgQVNMQ19DT05WRVJU
SUJMRV9JTkRJQ0FUT1IpCj4gPiAtCQlhc2xjX3N0YXQgfD0gYXNsZV9zZXRfY29udmVydGlibGUo
ZGV2X3ByaXYsIGFzbGUtPml1ZXIpOwo+ID4gKwkJYXNsY19zdGF0IHw9IGFzbGVfc2V0X2NvbnZl
cnRpYmxlKGk5MTUsIGFzbGUtPml1ZXIpOwo+ID4gICAJaWYgKGFzbGNfcmVxICYgQVNMQ19ET0NL
SU5HX0lORElDQVRPUikKPiA+IC0JCWFzbGNfc3RhdCB8PSBhc2xlX3NldF9kb2NraW5nKGRldl9w
cml2LCBhc2xlLT5pdWVyKTsKPiA+ICsJCWFzbGNfc3RhdCB8PSBhc2xlX3NldF9kb2NraW5nKGk5
MTUsIGFzbGUtPml1ZXIpOwo+ID4gICAJaWYgKGFzbGNfcmVxICYgQVNMQ19JU0NUX1NUQVRFX0NI
QU5HRSkKPiA+IC0JCWFzbGNfc3RhdCB8PSBhc2xlX2lzY3Rfc3RhdGUoZGV2X3ByaXYpOwo+ID4g
KwkJYXNsY19zdGF0IHw9IGFzbGVfaXNjdF9zdGF0ZShpOTE1KTsKPiA+ICAgCWFzbGUtPmFzbGMg
PSBhc2xjX3N0YXQ7Cj4gPiAgIH0KPiA+IC12b2lkIGludGVsX29wcmVnaW9uX2FzbGVfaW50cihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9vcHJlZ2lv
bl9hc2xlX2ludHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0J
aWYgKGRldl9wcml2LT5vcHJlZ2lvbi5hc2xlKQo+ID4gLQkJc2NoZWR1bGVfd29yaygmZGV2X3By
aXYtPm9wcmVnaW9uLmFzbGVfd29yayk7Cj4gPiArCWlmIChpOTE1LT5vcHJlZ2lvbi5hc2xlKQo+
ID4gKwkJc2NoZWR1bGVfd29yaygmaTkxNS0+b3ByZWdpb24uYXNsZV93b3JrKTsKPiA+ICAgfQo+
ID4gICAjZGVmaW5lIEFDUElfRVZfRElTUExBWV9TV0lUQ0ggKDE8PDApCj4gPiBAQCAtNzAyLDkg
KzcwMiw5IEBAIHN0YXRpYyB1MzIgYWNwaV9kaXNwbGF5X3R5cGUoc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yKQo+ID4gICAJcmV0dXJuIGRpc3BsYXlfdHlwZTsKPiA+ICAgfQo+ID4g
LXN0YXRpYyB2b2lkIGludGVsX2RpZGxfb3V0cHV0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaW50ZWxfZGlkbF9vdXRwdXRzKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9vcHJlZ2lvbiAq
b3ByZWdpb24gPSAmZGV2X3ByaXYtPm9wcmVnaW9uOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfb3ByZWdp
b24gKm9wcmVnaW9uID0gJmk5MTUtPm9wcmVnaW9uOwo+ID4gICAJc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yOwo+ID4gICAJc3RydWN0IGRybV9jb25uZWN0b3JfbGlzdF9pdGVyIGNv
bm5faXRlcjsKPiA+ICAgCWludCBpID0gMCwgbWF4X291dHB1dHM7Cj4gPiBAQCAtNzIwLDcgKzcy
MCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RpZGxfb3V0cHV0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAltYXhfb3V0cHV0cyA9IEFSUkFZX1NJWkUob3ByZWdpb24t
PmFjcGktPmRpZGwpICsKPiA+ICAgCQlBUlJBWV9TSVpFKG9wcmVnaW9uLT5hY3BpLT5kaWQyKTsK
PiA+IC0JZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXJfYmVnaW4oJmRldl9wcml2LT5kcm0sICZjb25u
X2l0ZXIpOwo+ID4gKwlkcm1fY29ubmVjdG9yX2xpc3RfaXRlcl9iZWdpbigmaTkxNS0+ZHJtLCAm
Y29ubl9pdGVyKTsKPiA+ICAgCWZvcl9lYWNoX2ludGVsX2Nvbm5lY3Rvcl9pdGVyKGNvbm5lY3Rv
ciwgJmNvbm5faXRlcikgewo+ID4gICAJCXUzMiBkZXZpY2VfaWQsIHR5cGU7Cj4gPiBAQCAtNzQ5
LDkgKzc0OSw5IEBAIHN0YXRpYyB2b2lkIGludGVsX2RpZGxfb3V0cHV0cyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJc2V0X2RpZChvcHJlZ2lvbiwgaSwgMCk7Cj4g
PiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9zZXR1cF9jYWRscyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaW50ZWxfc2V0dXBfY2FkbHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX29w
cmVnaW9uICpvcHJlZ2lvbiA9ICZkZXZfcHJpdi0+b3ByZWdpb247Cj4gPiArCXN0cnVjdCBpbnRl
bF9vcHJlZ2lvbiAqb3ByZWdpb24gPSAmaTkxNS0+b3ByZWdpb247Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfY29ubmVjdG9yICpjb25uZWN0b3I7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9saXN0
X2l0ZXIgY29ubl9pdGVyOwo+ID4gICAJaW50IGkgPSAwOwo+ID4gQEAgLTc2Niw3ICs3NjYsNyBA
QCBzdGF0aWMgdm9pZCBpbnRlbF9zZXR1cF9jYWRscyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiAgIAkgKiBOb3RlIHRoYXQgaW50ZXJuYWwgcGFuZWxzIHNob3VsZCBiZSBh
dCB0aGUgZnJvbnQgb2YgdGhlIGNvbm5lY3Rvcgo+ID4gICAJICogbGlzdCBhbHJlYWR5LCBlbnN1
cmluZyB0aGV5J3JlIG5vdCBsZWZ0IG91dC4KPiA+ICAgCSAqLwo+ID4gLQlkcm1fY29ubmVjdG9y
X2xpc3RfaXRlcl9iZWdpbigmZGV2X3ByaXYtPmRybSwgJmNvbm5faXRlcik7Cj4gPiArCWRybV9j
b25uZWN0b3JfbGlzdF9pdGVyX2JlZ2luKCZpOTE1LT5kcm0sICZjb25uX2l0ZXIpOwo+ID4gICAJ
Zm9yX2VhY2hfaW50ZWxfY29ubmVjdG9yX2l0ZXIoY29ubmVjdG9yLCAmY29ubl9pdGVyKSB7Cj4g
PiAgIAkJaWYgKGkgPj0gQVJSQVlfU0laRShvcHJlZ2lvbi0+YWNwaS0+Y2FkbCkpCj4gPiAgIAkJ
CWJyZWFrOwo+ID4gQEAgLTc3OSw5ICs3NzksOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zZXR1cF9j
YWRscyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJb3ByZWdpb24t
PmFjcGktPmNhZGxbaV0gPSAwOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgc3dzY2lfc2V0dXAo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIHN3c2Np
X3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBpbnRlbF9vcHJlZ2lvbiAqb3ByZWdpb24gPSAmZGV2X3ByaXYtPm9wcmVnaW9uOwo+ID4gKwlz
dHJ1Y3QgaW50ZWxfb3ByZWdpb24gKm9wcmVnaW9uID0gJmk5MTUtPm9wcmVnaW9uOwo+ID4gICAJ
Ym9vbCByZXF1ZXN0ZWRfY2FsbGJhY2tzID0gZmFsc2U7Cj4gPiAgIAl1MzIgdG1wOwo+ID4gQEAg
LTc5MCw3ICs3OTAsNyBAQCBzdGF0aWMgdm9pZCBzd3NjaV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlvcHJlZ2lvbi0+c3dzY2lfc2JjYl9zdWJfZnVuY3Rp
b25zID0gMTsKPiA+ICAgCS8qIFdlIHVzZSBHQkRBIHRvIGFzayBmb3Igc3VwcG9ydGVkIEdCREEg
Y2FsbHMuICovCj4gPiAtCWlmIChzd3NjaShkZXZfcHJpdiwgU1dTQ0lfR0JEQV9TVVBQT1JURURf
Q0FMTFMsIDAsICZ0bXApID09IDApIHsKPiA+ICsJaWYgKHN3c2NpKGk5MTUsIFNXU0NJX0dCREFf
U1VQUE9SVEVEX0NBTExTLCAwLCAmdG1wKSA9PSAwKSB7Cj4gPiAgIAkJLyogbWFrZSB0aGUgYml0
cyBtYXRjaCB0aGUgc3ViLWZ1bmN0aW9uIGNvZGVzICovCj4gPiAgIAkJdG1wIDw8PSAxOwo+ID4g
ICAJCW9wcmVnaW9uLT5zd3NjaV9nYmRhX3N1Yl9mdW5jdGlvbnMgfD0gdG1wOwo+ID4gQEAgLTgw
MSw3ICs4MDEsNyBAQCBzdGF0aWMgdm9pZCBzd3NjaV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiBtdXN0IG5vdCBjYWxsIGludGVyZmFjZXMgdGhhdCBh
cmUgbm90IHNwZWNpZmljYWxseSByZXF1ZXN0ZWQgYnkgdGhlCj4gPiAgIAkgKiBiaW9zLgo+ID4g
ICAJICovCj4gPiAtCWlmIChzd3NjaShkZXZfcHJpdiwgU1dTQ0lfR0JEQV9SRVFVRVNURURfQ0FM
TEJBQ0tTLCAwLCAmdG1wKSA9PSAwKSB7Cj4gPiArCWlmIChzd3NjaShpOTE1LCBTV1NDSV9HQkRB
X1JFUVVFU1RFRF9DQUxMQkFDS1MsIDAsICZ0bXApID09IDApIHsKPiA+ICAgCQkvKiBoZXJlLCB0
aGUgYml0cyBhbHJlYWR5IG1hdGNoIHN1Yi1mdW5jdGlvbiBjb2RlcyAqLwo+ID4gICAJCW9wcmVn
aW9uLT5zd3NjaV9zYmNiX3N1Yl9mdW5jdGlvbnMgfD0gdG1wOwo+ID4gICAJCXJlcXVlc3RlZF9j
YWxsYmFja3MgPSB0cnVlOwo+ID4gQEAgLTgxMiw3ICs4MTIsNyBAQCBzdGF0aWMgdm9pZCBzd3Nj
aV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiB0aGUg
Y2FsbGJhY2sgaXMgX3JlcXVlc3RlZF8uIEJ1dCB3ZSBzdGlsbCBjYW4ndCBjYWxsIGludGVyZmFj
ZXMgdGhhdAo+ID4gICAJICogYXJlIG5vdCByZXF1ZXN0ZWQuCj4gPiAgIAkgKi8KPiA+IC0JaWYg
KHN3c2NpKGRldl9wcml2LCBTV1NDSV9TQkNCX1NVUFBPUlRFRF9DQUxMQkFDS1MsIDAsICZ0bXAp
ID09IDApIHsKPiA+ICsJaWYgKHN3c2NpKGk5MTUsIFNXU0NJX1NCQ0JfU1VQUE9SVEVEX0NBTExC
QUNLUywgMCwgJnRtcCkgPT0gMCkgewo+ID4gICAJCS8qIG1ha2UgdGhlIGJpdHMgbWF0Y2ggdGhl
IHN1Yi1mdW5jdGlvbiBjb2RlcyAqLwo+ID4gICAJCXUzMiBsb3cgPSB0bXAgJiAweDdmZjsKPiA+
ICAgCQl1MzIgaGlnaCA9IHRtcCAmIH4weGZmZjsgLyogYml0IDExIGlzIHJlc2VydmVkICovCj4g
PiBAQCAtODU0LDkgKzg1NCw5IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZG1pX3N5c3RlbV9pZCBp
bnRlbF9ub19vcHJlZ2lvbl92YnRbXSA9IHsKPiA+ICAgCXsgfQo+ID4gICB9Owo+ID4gLXN0YXRp
YyBpbnQgaW50ZWxfbG9hZF92YnRfZmlybXdhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gK3N0YXRpYyBpbnQgaW50ZWxfbG9hZF92YnRfZmlybXdhcmUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX29wcmVnaW9u
ICpvcHJlZ2lvbiA9ICZkZXZfcHJpdi0+b3ByZWdpb247Cj4gPiArCXN0cnVjdCBpbnRlbF9vcHJl
Z2lvbiAqb3ByZWdpb24gPSAmaTkxNS0+b3ByZWdpb247Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZmly
bXdhcmUgKmZ3ID0gTlVMTDsKPiA+ICAgCWNvbnN0IGNoYXIgKm5hbWUgPSBpOTE1X21vZHBhcmFt
cy52YnRfZmlybXdhcmU7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gQEAgLTg2NCw3ICs4NjQsNyBAQCBz
dGF0aWMgaW50IGludGVsX2xvYWRfdmJ0X2Zpcm13YXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiA+ICAgCWlmICghbmFtZSB8fCAhKm5hbWUpCj4gPiAgIAkJcmV0dXJuIC1F
Tk9FTlQ7Cj4gPiAtCXJldCA9IHJlcXVlc3RfZmlybXdhcmUoJmZ3LCBuYW1lLCAmZGV2X3ByaXYt
PmRybS5wZGV2LT5kZXYpOwo+ID4gKwlyZXQgPSByZXF1ZXN0X2Zpcm13YXJlKCZmdywgbmFtZSwg
Jmk5MTUtPmRybS5wZGV2LT5kZXYpOwo+ID4gICAJaWYgKHJldCkgewo+ID4gICAJCURSTV9FUlJP
UigiUmVxdWVzdGluZyBWQlQgZmlybXdhcmUgXCIlc1wiIGZhaWxlZCAoJWQpXG4iLAo+ID4gICAJ
CQkgIG5hbWUsIHJldCk7Cj4gPiBAQCAtODkxLDEwICs4OTEsMTAgQEAgc3RhdGljIGludCBpbnRl
bF9sb2FkX3ZidF9maXJtd2FyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiAtaW50IGludGVsX29wcmVnaW9uX3NldHVwKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQgaW50ZWxfb3ByZWdpb25f
c2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGludGVsX29wcmVnaW9uICpvcHJlZ2lvbiA9ICZkZXZfcHJpdi0+b3ByZWdpb247Cj4gPiAtCXN0
cnVjdCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRybS5wZGV2Owo+ID4gKwlzdHJ1Y3QgaW50
ZWxfb3ByZWdpb24gKm9wcmVnaW9uID0gJmk5MTUtPm9wcmVnaW9uOwo+ID4gKwlzdHJ1Y3QgcGNp
X2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2Owo+ID4gICAJdTMyIGFzbHMsIG1ib3hlczsKPiA+
ICAgCWNoYXIgYnVmW3NpemVvZihPUFJFR0lPTl9TSUdOQVRVUkUpXTsKPiA+ICAgCWludCBlcnIg
PSAwOwo+ID4gQEAgLTk0NSw3ICs5NDUsNyBAQCBpbnQgaW50ZWxfb3ByZWdpb25fc2V0dXAoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJaWYgKG1ib3hlcyAmIE1CT1hf
U1dTQ0kpIHsKPiA+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJTV1NDSSBzdXBwb3J0ZWRcbiIpOwo+
ID4gICAJCW9wcmVnaW9uLT5zd3NjaSA9IGJhc2UgKyBPUFJFR0lPTl9TV1NDSV9PRkZTRVQ7Cj4g
PiAtCQlzd3NjaV9zZXR1cChkZXZfcHJpdik7Cj4gPiArCQlzd3NjaV9zZXR1cChpOTE1KTsKPiA+
ICAgCX0KPiA+ICAgCWlmIChtYm94ZXMgJiBNQk9YX0FTTEUpIHsKPiA+IEBAIC05NTgsNyArOTU4
LDcgQEAgaW50IGludGVsX29wcmVnaW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICAgCWlmIChtYm94ZXMgJiBNQk9YX0FTTEVfRVhUKQo+ID4gICAJCURSTV9E
RUJVR19EUklWRVIoIkFTTEUgZXh0ZW5zaW9uIHN1cHBvcnRlZFxuIik7Cj4gPiAtCWlmIChpbnRl
bF9sb2FkX3ZidF9maXJtd2FyZShkZXZfcHJpdikgPT0gMCkKPiA+ICsJaWYgKGludGVsX2xvYWRf
dmJ0X2Zpcm13YXJlKGk5MTUpID09IDApCj4gPiAgIAkJZ290byBvdXQ7Cj4gPiAgIAlpZiAoZG1p
X2NoZWNrX3N5c3RlbShpbnRlbF9ub19vcHJlZ2lvbl92YnQpKQo+ID4gQEAgLTEwNDMsMTIgKzEw
NDMsMTIgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkbWlfc3lzdGVtX2lkIGludGVsX3VzZV9vcHJl
Z2lvbl9wYW5lbF90eXBlW10gPSB7Cj4gPiAgIH07Cj4gPiAgIGludAo+ID4gLWludGVsX29wcmVn
aW9uX2dldF9wYW5lbF90eXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICtpbnRlbF9vcHJlZ2lvbl9nZXRfcGFuZWxfdHlwZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIHBhbmVsX2RldGFpbHM7Cj4gPiAgIAlpbnQgcmV0Owo+
ID4gLQlyZXQgPSBzd3NjaShkZXZfcHJpdiwgU1dTQ0lfR0JEQV9QQU5FTF9ERVRBSUxTLCAweDAs
ICZwYW5lbF9kZXRhaWxzKTsKPiA+ICsJcmV0ID0gc3dzY2koaTkxNSwgU1dTQ0lfR0JEQV9QQU5F
TF9ERVRBSUxTLCAweDAsICZwYW5lbF9kZXRhaWxzKTsKPiA+ICAgCWlmIChyZXQpIHsKPiA+ICAg
CQlEUk1fREVCVUdfS01TKCJGYWlsZWQgdG8gZ2V0IHBhbmVsIGRldGFpbHMgZnJvbSBPcFJlZ2lv
biAoJWQpXG4iLAo+ID4gICAJCQkgICAgICByZXQpOwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX29wcmVnaW9uLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9vcHJlZ2lvbi5oCj4gPiBpbmRleCA0YWE2OGZmYmQzMGUuLjhlMGI3YmRlY2JlNCAxMDA2NDQK
PiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX29wcmVnaW9uLmgKPiA+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX29wcmVnaW9uLmgKPiA+IEBAIC01Niw0NyArNTYs
NDcgQEAgc3RydWN0IGludGVsX29wcmVnaW9uIHsKPiA+ICAgI2lmZGVmIENPTkZJR19BQ1BJCj4g
PiAtaW50IGludGVsX29wcmVnaW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdik7Cj4gPiAraW50IGludGVsX29wcmVnaW9uX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiA+IC12b2lkIGludGVsX29wcmVnaW9uX3JlZ2lzdGVyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpbnRlbF9vcHJlZ2lvbl91bnJlZ2lz
dGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBpbnRlbF9v
cHJlZ2lvbl9yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9p
ZCBpbnRlbF9vcHJlZ2lvbl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KTsKPiA+IC12b2lkIGludGVsX29wcmVnaW9uX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgaW50ZWxfb3ByZWdpb25fc3VzcGVuZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBpbnRlbF9vcHJlZ2lvbl9yZXN1bWUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfb3ByZWdpb25f
c3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgIHBjaV9w
b3dlcl90IHN0YXRlKTsKPiA+IC12b2lkIGludGVsX29wcmVnaW9uX2FzbGVfaW50cihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3ZvaWQgaW50ZWxfb3ByZWdpb25fYXNs
ZV9pbnRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgaW50IGludGVsX29w
cmVnaW9uX25vdGlmeV9lbmNvZGVyKHN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVy
LAo+ID4gICAJCQkJICBib29sIGVuYWJsZSk7Cj4gPiAtaW50IGludGVsX29wcmVnaW9uX25vdGlm
eV9hZGFwdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpbnQgaW50
ZWxfb3ByZWdpb25fbm90aWZ5X2FkYXB0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gPiAgIAkJCQkgIHBjaV9wb3dlcl90IHN0YXRlKTsKPiA+IC1pbnQgaW50ZWxfb3ByZWdpb25f
Z2V0X3BhbmVsX3R5cGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+ICtp
bnQgaW50ZWxfb3ByZWdpb25fZ2V0X3BhbmVsX3R5cGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwo+ID4gICAjZWxzZSAvKiBDT05GSUdfQUNQSSovCj4gPiAtc3RhdGljIGlubGluZSBp
bnQgaW50ZWxfb3ByZWdpb25fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gK3N0YXRpYyBpbmxpbmUgaW50IGludGVsX29wcmVnaW9uX3NldHVwKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4g
LXN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9vcHJlZ2lvbl9yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGlubGluZSB2b2lkIGludGVsX29wcmVn
aW9uX3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfb3ByZWdpb25fdW5yZWdpc3RlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGlubGluZSB2b2lkIGlu
dGVsX29wcmVnaW9uX3VucmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9vcHJlZ2lvbl9yZXN1
bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBpbmxpbmUg
dm9pZCBpbnRlbF9vcHJlZ2lvbl9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9vcHJlZ2lvbl9z
dXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW5s
aW5lIHZvaWQgaW50ZWxfb3ByZWdpb25fc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJCQkgIHBjaV9wb3dlcl90IHN0YXRlKQo+ID4gICB7Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfb3ByZWdpb25fYXNsZV9pbnRyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfb3By
ZWdpb25fYXNsZV9pbnRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAgIH0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vdmVybGF5
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vdmVybGF5LmMKPiA+IGluZGV4IGEyYWMw
NmEwODcxNS4uODAyYmM0YzcyZWNkIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfb3ZlcmxheS5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9v
dmVybGF5LmMKPiA+IEBAIC0xOTMsMTAgKzE5MywxMCBAQCBzdHJ1Y3QgaW50ZWxfb3ZlcmxheSB7
Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCBsYXN0X2ZsaXA7Cj4gPiAgIH07Cj4g
PiAtc3RhdGljIHZvaWQgaTgzMF9vdmVybGF5X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaTgzMF9vdmVybGF5X2Nsb2NrX2dh
dGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgIGJvb2wg
ZW5hYmxlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gZGV2X3ByaXYtPmRy
bS5wZGV2Owo+ID4gKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2Owo+ID4g
ICAJdTggdmFsOwo+ID4gICAJLyogV0FfT1ZFUkxBWV9DTEtHQVRFOmFsbSAqLwo+ID4gQEAgLTI0
Nyw3ICsyNDcsNyBAQCBzdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVzdCAqYWxsb2NfcmVxdWVzdChz
dHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSkKPiA+ICAgLyogb3ZlcmxheSBuZWVkcyB0byBi
ZSBkaXNhYmxlIGluIE9DTUQgcmVnICovCj4gPiAgIHN0YXRpYyBpbnQgaW50ZWxfb3ZlcmxheV9v
bihzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBvdmVybGF5LT5pOTE1Owo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG92ZXJsYXktPmk5MTU7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycTsKPiA+ICAgCXUzMiAqY3M7Cj4gPiBAQCAtMjY1LDggKzI2NSw4IEBAIHN0YXRp
YyBpbnQgaW50ZWxfb3ZlcmxheV9vbihzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSkKPiA+
ICAgCW92ZXJsYXktPmFjdGl2ZSA9IHRydWU7Cj4gPiAtCWlmIChJU19JODMwKGRldl9wcml2KSkK
PiA+IC0JCWk4MzBfb3ZlcmxheV9jbG9ja19nYXRpbmcoZGV2X3ByaXYsIGZhbHNlKTsKPiA+ICsJ
aWYgKElTX0k4MzAoaTkxNSkpCj4gPiArCQlpODMwX292ZXJsYXlfY2xvY2tfZ2F0aW5nKGk5MTUs
IGZhbHNlKTsKPiA+ICAgCSpjcysrID0gTUlfT1ZFUkxBWV9GTElQIHwgTUlfT1ZFUkxBWV9PTjsK
PiA+ICAgCSpjcysrID0gb3ZlcmxheS0+ZmxpcF9hZGRyIHwgT0ZDX1VQREFURTsKPiA+IEBAIC0z
MDMsNyArMzAzLDcgQEAgc3RhdGljIGludCBpbnRlbF9vdmVybGF5X2NvbnRpbnVlKHN0cnVjdCBp
bnRlbF9vdmVybGF5ICpvdmVybGF5LAo+ID4gICAJCQkJICBzdHJ1Y3QgaTkxNV92bWEgKnZtYSwK
PiA+ICAgCQkJCSAgYm9vbCBsb2FkX3BvbHlwaGFzZV9maWx0ZXIpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gb3ZlcmxheS0+aTkxNTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBvdmVybGF5LT5pOTE1Owo+ID4gICAJc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnE7Cj4gPiAgIAl1MzIgZmxpcF9hZGRyID0gb3ZlcmxheS0+ZmxpcF9h
ZGRyOwo+ID4gICAJdTMyIHRtcCwgKmNzOwo+ID4gQEAgLTM2OSw3ICszNjksNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9vdmVybGF5X29mZl90YWlsKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICph
Y3RpdmUsCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5ID0KPiA+
ICAgCQljb250YWluZXJfb2YoYWN0aXZlLCB0eXBlb2YoKm92ZXJsYXkpLCBsYXN0X2ZsaXApOwo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBvdmVybGF5LT5pOTE1Owo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG92ZXJsYXktPmk5MTU7Cj4gPiAg
IAlpbnRlbF9vdmVybGF5X3JlbGVhc2Vfb2xkX3ZtYShvdmVybGF5KTsKPiA+IEBAIC0zNzcsOCAr
Mzc3LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfb3ZlcmxheV9vZmZfdGFpbChzdHJ1Y3QgaTkxNV9h
Y3RpdmVfcmVxdWVzdCAqYWN0aXZlLAo+ID4gICAJb3ZlcmxheS0+Y3J0YyA9IE5VTEw7Cj4gPiAg
IAlvdmVybGF5LT5hY3RpdmUgPSBmYWxzZTsKPiA+IC0JaWYgKElTX0k4MzAoZGV2X3ByaXYpKQo+
ID4gLQkJaTgzMF9vdmVybGF5X2Nsb2NrX2dhdGluZyhkZXZfcHJpdiwgdHJ1ZSk7Cj4gPiArCWlm
IChJU19JODMwKGk5MTUpKQo+ID4gKwkJaTgzMF9vdmVybGF5X2Nsb2NrX2dhdGluZyhpOTE1LCB0
cnVlKTsKPiA+ICAgfQo+ID4gICAvKiBvdmVybGF5IG5lZWRzIHRvIGJlIGRpc2FibGVkIGluIE9D
TUQgcmVnICovCj4gPiBAQCAtNDM3LDExICs0MzcsMTEgQEAgc3RhdGljIGludCBpbnRlbF9vdmVy
bGF5X3JlY292ZXJfZnJvbV9pbnRlcnJ1cHQoc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXkp
Cj4gPiAgICAqLwo+ID4gICBzdGF0aWMgaW50IGludGVsX292ZXJsYXlfcmVsZWFzZV9vbGRfdmlk
KHN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG92ZXJsYXktPmk5MTU7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gb3ZlcmxheS0+aTkxNTsKPiA+ICAgCXUzMiAqY3M7Cj4gPiAg
IAlpbnQgcmV0Owo+ID4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+ZHJtLnN0cnVj
dF9tdXRleCk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwo+ID4gICAJLyogT25seSB3YWl0IGlmIHRoZXJlIGlzIGFjdHVhbGx5IGFuIG9sZCBmcmFt
ZSB0byByZWxlYXNlIHRvCj4gPiAgIAkgKiBndWFyYW50ZWUgZm9yd2FyZCBwcm9ncmVzcy4KPiA+
IEBAIC00NzcsOSArNDc3LDkgQEAgc3RhdGljIGludCBpbnRlbF9vdmVybGF5X3JlbGVhc2Vfb2xk
X3ZpZChzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSkKPiA+ICAgCXJldHVybiAwOwo+ID4g
ICB9Cj4gPiAtdm9pZCBpbnRlbF9vdmVybGF5X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiA+ICt2b2lkIGludGVsX292ZXJsYXlfcmVzZXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJs
YXkgPSBkZXZfcHJpdi0+b3ZlcmxheTsKPiA+ICsJc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJs
YXkgPSBpOTE1LT5vdmVybGF5Owo+ID4gICAJaWYgKCFvdmVybGF5KQo+ID4gICAJCXJldHVybjsK
PiA+IEBAIC01NDAsMTEgKzU0MCwxMSBAQCBzdGF0aWMgaW50IHV2X3ZzdWJzYW1wbGluZyh1MzIg
Zm9ybWF0KQo+ID4gICAJfQo+ID4gICB9Cj4gPiAtc3RhdGljIHUzMiBjYWxjX3N3aWR0aHN3KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIG9mZnNldCwgdTMyIHdpZHRoKQo+
ID4gK3N0YXRpYyB1MzIgY2FsY19zd2lkdGhzdyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwgdTMyIG9mZnNldCwgdTMyIHdpZHRoKQo+ID4gICB7Cj4gPiAgIAl1MzIgc3c7Cj4gPiAtCWlm
IChJU19HRU4oZGV2X3ByaXYsIDIpKQo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDIpKQo+ID4gICAJ
CXN3ID0gQUxJR04oKG9mZnNldCAmIDMxKSArIHdpZHRoLCAzMik7Cj4gPiAgIAllbHNlCj4gPiAg
IAkJc3cgPSBBTElHTigob2Zmc2V0ICYgNjMpICsgd2lkdGgsIDY0KTsKPiA+IEBAIC03NDksMjEg
Kzc0OSwyMSBAQCBzdGF0aWMgaW50IGludGVsX292ZXJsYXlfZG9fcHV0X2ltYWdlKHN0cnVjdCBp
bnRlbF9vdmVybGF5ICpvdmVybGF5LAo+ID4gICAJCQkJICAgICAgc3RydWN0IGRybV9pbnRlbF9v
dmVybGF5X3B1dF9pbWFnZSAqcGFyYW1zKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3Qgb3ZlcmxheV9y
ZWdpc3RlcnMgX19pb21lbSAqcmVncyA9IG92ZXJsYXktPnJlZ3M7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG92ZXJsYXktPmk5MTU7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gb3ZlcmxheS0+aTkxNTsKPiA+ICAgCXUzMiBzd2lkdGgsIHN3
aWR0aHN3LCBzaGVpZ2h0LCBvc3RyaWRlOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBvdmVybGF5
LT5jcnRjLT5waXBlOwo+ID4gICAJYm9vbCBzY2FsZV9jaGFuZ2VkID0gZmFsc2U7Cj4gPiAgIAlz
dHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiA+ICAgCWludCByZXQsIHRtcF93aWR0aDsKPiA+IC0JbG9j
a2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQlXQVJO
X09OKCFkcm1fbW9kZXNldF9pc19sb2NrZWQoJmRldl9wcml2LT5kcm0ubW9kZV9jb25maWcuY29u
bmVjdGlvbl9tdXRleCkpOwo+ID4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKPiA+ICsJV0FSTl9PTighZHJtX21vZGVzZXRfaXNfbG9ja2VkKCZpOTE1LT5k
cm0ubW9kZV9jb25maWcuY29ubmVjdGlvbl9tdXRleCkpOwo+ID4gICAJcmV0ID0gaW50ZWxfb3Zl
cmxheV9yZWxlYXNlX29sZF92aWQob3ZlcmxheSk7Cj4gPiAgIAlpZiAocmV0ICE9IDApCj4gPiAg
IAkJcmV0dXJuIHJldDsKPiA+IC0JYXRvbWljX2luYygmZGV2X3ByaXYtPmdwdV9lcnJvci5wZW5k
aW5nX2ZiX3Bpbik7Cj4gPiArCWF0b21pY19pbmMoJmk5MTUtPmdwdV9lcnJvci5wZW5kaW5nX2Zi
X3Bpbik7Cj4gPiAgIAlpOTE1X2dlbV9vYmplY3RfbG9jayhuZXdfYm8pOwo+ID4gICAJdm1hID0g
aTkxNV9nZW1fb2JqZWN0X3Bpbl90b19kaXNwbGF5X3BsYW5lKG5ld19ibywKPiA+IEBAIC03ODMs
NyArNzgzLDcgQEAgc3RhdGljIGludCBpbnRlbF9vdmVybGF5X2RvX3B1dF9pbWFnZShzdHJ1Y3Qg
aW50ZWxfb3ZlcmxheSAqb3ZlcmxheSwKPiA+ICAgCQl1MzIgb2NvbmZpZzsKPiA+ICAgCQlvY29u
ZmlnID0gT0NPTkZfQ0NfT1VUXzhCSVQ7Cj4gPiAtCQlpZiAoSVNfR0VOKGRldl9wcml2LCA0KSkK
PiA+ICsJCWlmIChJU19HRU4oaTkxNSwgNCkpCj4gPiAgIAkJCW9jb25maWcgfD0gT0NPTkZfQ1ND
X01PREVfQlQ3MDk7Cj4gPiAgIAkJb2NvbmZpZyB8PSBwaXBlID09IDAgPwo+ID4gICAJCQlPQ09O
Rl9QSVBFX0EgOiBPQ09ORl9QSVBFX0I7Cj4gPiBAQCAtODA0LDcgKzgwNCw3IEBAIHN0YXRpYyBp
bnQgaW50ZWxfb3ZlcmxheV9kb19wdXRfaW1hZ2Uoc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJs
YXksCj4gPiAgIAkJdG1wX3dpZHRoID0gcGFyYW1zLT5zcmNfd2lkdGg7Cj4gPiAgIAlzd2lkdGgg
PSBwYXJhbXMtPnNyY193aWR0aDsKPiA+IC0Jc3dpZHRoc3cgPSBjYWxjX3N3aWR0aHN3KGRldl9w
cml2LCBwYXJhbXMtPm9mZnNldF9ZLCB0bXBfd2lkdGgpOwo+ID4gKwlzd2lkdGhzdyA9IGNhbGNf
c3dpZHRoc3coaTkxNSwgcGFyYW1zLT5vZmZzZXRfWSwgdG1wX3dpZHRoKTsKPiA+ICAgCXNoZWln
aHQgPSBwYXJhbXMtPnNyY19oZWlnaHQ7Cj4gPiAgIAlpb3dyaXRlMzIoaTkxNV9nZ3R0X29mZnNl
dCh2bWEpICsgcGFyYW1zLT5vZmZzZXRfWSwgJnJlZ3MtPk9CVUZfMFkpOwo+ID4gICAJb3N0cmlk
ZSA9IHBhcmFtcy0+c3RyaWRlX1k7Cj4gPiBAQCAtODE3LDkgKzgxNyw5IEBAIHN0YXRpYyBpbnQg
aW50ZWxfb3ZlcmxheV9kb19wdXRfaW1hZ2Uoc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXks
Cj4gPiAgIAkJc3dpZHRoIHw9IChwYXJhbXMtPnNyY193aWR0aCAvIHV2X2hzY2FsZSkgPDwgMTY7
Cj4gPiAgIAkJc2hlaWdodCB8PSAocGFyYW1zLT5zcmNfaGVpZ2h0IC8gdXZfdnNjYWxlKSA8PCAx
NjsKPiA+IC0JCXRtcF9VID0gY2FsY19zd2lkdGhzdyhkZXZfcHJpdiwgcGFyYW1zLT5vZmZzZXRf
VSwKPiA+ICsJCXRtcF9VID0gY2FsY19zd2lkdGhzdyhpOTE1LCBwYXJhbXMtPm9mZnNldF9VLAo+
ID4gICAJCQkJICAgICAgcGFyYW1zLT5zcmNfd2lkdGggLyB1dl9oc2NhbGUpOwo+ID4gLQkJdG1w
X1YgPSBjYWxjX3N3aWR0aHN3KGRldl9wcml2LCBwYXJhbXMtPm9mZnNldF9WLAo+ID4gKwkJdG1w
X1YgPSBjYWxjX3N3aWR0aHN3KGk5MTUsIHBhcmFtcy0+b2Zmc2V0X1YsCj4gPiAgIAkJCQkgICAg
ICBwYXJhbXMtPnNyY193aWR0aCAvIHV2X2hzY2FsZSk7Cj4gPiAgIAkJc3dpZHRoc3cgfD0gbWF4
KHRtcF9VLCB0bXBfVikgPDwgMTY7Cj4gPiBAQCAtODUxLDE4ICs4NTEsMTggQEAgc3RhdGljIGlu
dCBpbnRlbF9vdmVybGF5X2RvX3B1dF9pbWFnZShzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3Zlcmxh
eSwKPiA+ICAgb3V0X3VucGluOgo+ID4gICAJaTkxNV9nZW1fb2JqZWN0X3VucGluX2Zyb21fZGlz
cGxheV9wbGFuZSh2bWEpOwo+ID4gICBvdXRfcGluX3NlY3Rpb246Cj4gPiAtCWF0b21pY19kZWMo
JmRldl9wcml2LT5ncHVfZXJyb3IucGVuZGluZ19mYl9waW4pOwo+ID4gKwlhdG9taWNfZGVjKCZp
OTE1LT5ncHVfZXJyb3IucGVuZGluZ19mYl9waW4pOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAg
fQo+ID4gICBpbnQgaW50ZWxfb3ZlcmxheV9zd2l0Y2hfb2ZmKHN0cnVjdCBpbnRlbF9vdmVybGF5
ICpvdmVybGF5KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IG92ZXJsYXktPmk5MTU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
b3ZlcmxheS0+aTkxNTsKPiA+ICAgCWludCByZXQ7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQo
JmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+IC0JV0FSTl9PTighZHJtX21vZGVzZXRf
aXNfbG9ja2VkKCZkZXZfcHJpdi0+ZHJtLm1vZGVfY29uZmlnLmNvbm5lY3Rpb25fbXV0ZXgpKTsK
PiA+ICsJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAr
CVdBUk5fT04oIWRybV9tb2Rlc2V0X2lzX2xvY2tlZCgmaTkxNS0+ZHJtLm1vZGVfY29uZmlnLmNv
bm5lY3Rpb25fbXV0ZXgpKTsKPiA+ICAgCXJldCA9IGludGVsX292ZXJsYXlfcmVjb3Zlcl9mcm9t
X2ludGVycnVwdChvdmVybGF5KTsKPiA+ICAgCWlmIChyZXQgIT0gMCkKPiA+IEBAIC04OTUsMTQg
Kzg5NSwxNCBAQCBzdGF0aWMgaW50IGNoZWNrX292ZXJsYXlfcG9zc2libGVfb25fY3J0YyhzdHJ1
Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheSwKPiA+ICAgc3RhdGljIHZvaWQgdXBkYXRlX3BmaXRf
dnNjYWxlX3JhdGlvKHN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5KQo+ID4gICB7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG92ZXJsYXktPmk5MTU7Cj4gPiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gb3ZlcmxheS0+aTkxNTsKPiA+ICAgCXUz
MiBwZml0X2NvbnRyb2wgPSBJOTE1X1JFQUQoUEZJVF9DT05UUk9MKTsKPiA+ICAgCXUzMiByYXRp
bzsKPiA+ICAgCS8qIFhYWDogVGhpcyBpcyBub3QgdGhlIHNhbWUgbG9naWMgYXMgaW4gdGhlIHhv
cmcgZHJpdmVyLCBidXQgbW9yZSBpbgo+ID4gICAJICogbGluZSB3aXRoIHRoZSBpbnRlbCBkb2N1
bWVudGF0aW9uIGZvciB0aGUgaTk2NQo+ID4gICAJICovCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpID49IDQpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KSB7Cj4gPiAgIAkJ
Lyogb24gaTk2NSB1c2UgdGhlIFBHTSByZWcgdG8gcmVhZCBvdXQgdGhlIGF1dG9zY2FsZXIgdmFs
dWVzICovCj4gPiAgIAkJcmF0aW8gPSBJOTE1X1JFQUQoUEZJVF9QR01fUkFUSU9TKSA+PiBQRklU
X1ZFUlRfU0NBTEVfU0hJRlRfOTY1Owo+ID4gICAJfSBlbHNlIHsKPiA+IEBAIC05NDcsNyArOTQ3
LDcgQEAgc3RhdGljIGludCBjaGVja19vdmVybGF5X3NjYWxpbmcoc3RydWN0IGRybV9pbnRlbF9v
dmVybGF5X3B1dF9pbWFnZSAqcmVjKQo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgaW50IGNoZWNrX292ZXJsYXlfc3JjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICtzdGF0aWMgaW50IGNoZWNrX292ZXJsYXlfc3JjKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ID4gICAJCQkgICAgIHN0cnVjdCBkcm1faW50ZWxfb3ZlcmxheV9wdXRfaW1h
Z2UgKnJlYywKPiA+ICAgCQkJICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqbmV3X2Jv
KQo+ID4gICB7Cj4gPiBAQCAtOTU4LDcgKzk1OCw3IEBAIHN0YXRpYyBpbnQgY2hlY2tfb3Zlcmxh
eV9zcmMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJdTMyIHRtcDsK
PiA+ICAgCS8qIGNoZWNrIHNyYyBkaW1lbnNpb25zICovCj4gPiAtCWlmIChJU19JODQ1RyhkZXZf
cHJpdikgfHwgSVNfSTgzMChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0k4NDVHKGk5MTUpIHx8
IElTX0k4MzAoaTkxNSkpIHsKPiA+ICAgCQlpZiAocmVjLT5zcmNfaGVpZ2h0ID4gSU1BR0VfTUFY
X0hFSUdIVF9MRUdBQ1kgfHwKPiA+ICAgCQkgICAgcmVjLT5zcmNfd2lkdGggID4gSU1BR0VfTUFY
X1dJRFRIX0xFR0FDWSkKPiA+ICAgCQkJcmV0dXJuIC1FSU5WQUw7Cj4gPiBAQCAtMTAxMCwxNCAr
MTAxMCwxNCBAQCBzdGF0aWMgaW50IGNoZWNrX292ZXJsYXlfc3JjKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICAgCS8qIHN0cmlk
ZSBjaGVja2luZyAqLwo+ID4gLQlpZiAoSVNfSTgzMChkZXZfcHJpdikgfHwgSVNfSTg0NUcoZGV2
X3ByaXYpKQo+ID4gKwlpZiAoSVNfSTgzMChpOTE1KSB8fCBJU19JODQ1RyhpOTE1KSkKPiA+ICAg
CQlzdHJpZGVfbWFzayA9IDI1NTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlzdHJpZGVfbWFzayA9IDYz
Owo+ID4gICAJaWYgKHJlYy0+c3RyaWRlX1kgJiBzdHJpZGVfbWFzayB8fCByZWMtPnN0cmlkZV9V
ViAmIHN0cmlkZV9tYXNrKQo+ID4gICAJCXJldHVybiAtRUlOVkFMOwo+ID4gLQlpZiAoSVNfR0VO
KGRldl9wcml2LCA0KSAmJiByZWMtPnN0cmlkZV9ZIDwgNTEyKQo+ID4gKwlpZiAoSVNfR0VOKGk5
MTUsIDQpICYmIHJlYy0+c3RyaWRlX1kgPCA1MTIpCj4gPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4g
PiAgIAl0bXAgPSAocmVjLT5mbGFncyAmIEk5MTVfT1ZFUkxBWV9UWVBFX01BU0spID09IEk5MTVf
T1ZFUkxBWV9ZVVZfUExBTkFSID8KPiA+IEBAIC0xMDYyLDE0ICsxMDYyLDE0IEBAIGludCBpbnRl
bF9vdmVybGF5X3B1dF9pbWFnZV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpk
YXRhLAo+ID4gICAJCQkJICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdikKPiA+ICAgewo+ID4g
ICAJc3RydWN0IGRybV9pbnRlbF9vdmVybGF5X3B1dF9pbWFnZSAqcGFyYW1zID0gZGF0YTsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5Owo+ID4gICAJc3RydWN0IGRybV9jcnRjICpkcm1t
b2RlX2NydGM7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiA+ICAgCXN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpuZXdfYm87Cj4gPiAgIAlpbnQgcmV0Owo+ID4gLQlvdmVybGF5
ID0gZGV2X3ByaXYtPm92ZXJsYXk7Cj4gPiArCW92ZXJsYXkgPSBpOTE1LT5vdmVybGF5Owo+ID4g
ICAJaWYgKCFvdmVybGF5KSB7Cj4gPiAgIAkJRFJNX0RFQlVHKCJ1c2Vyc3BhY2UgYnVnOiBubyBv
dmVybGF5XG4iKTsKPiA+ICAgCQlyZXR1cm4gLUVOT0RFVjsKPiA+IEBAIC0xMTQ4LDcgKzExNDgs
NyBAQCBpbnQgaW50ZWxfb3ZlcmxheV9wdXRfaW1hZ2VfaW9jdGwoc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwKPiA+ICAgCQlnb3RvIG91dF91bmxvY2s7Cj4gPiAgIAl9Cj4gPiAt
CXJldCA9IGNoZWNrX292ZXJsYXlfc3JjKGRldl9wcml2LCBwYXJhbXMsIG5ld19ibyk7Cj4gPiAr
CXJldCA9IGNoZWNrX292ZXJsYXlfc3JjKGk5MTUsIHBhcmFtcywgbmV3X2JvKTsKPiA+ICAgCWlm
IChyZXQgIT0gMCkKPiA+ICAgCQlnb3RvIG91dF91bmxvY2s7Cj4gPiBAQCAtMTIzMSwxMSArMTIz
MSwxMSBAQCBpbnQgaW50ZWxfb3ZlcmxheV9hdHRyc19pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LCB2b2lkICpkYXRhLAo+ID4gICAJCQkgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJp
dikKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9pbnRlbF9vdmVybGF5X2F0dHJzICphdHRycyA9
IGRhdGE7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAqb3ZlcmxheTsKPiA+ICAgCWludCByZXQ7Cj4g
PiAtCW92ZXJsYXkgPSBkZXZfcHJpdi0+b3ZlcmxheTsKPiA+ICsJb3ZlcmxheSA9IGk5MTUtPm92
ZXJsYXk7Cj4gPiAgIAlpZiAoIW92ZXJsYXkpIHsKPiA+ICAgCQlEUk1fREVCVUcoInVzZXJzcGFj
ZSBidWc6IG5vIG92ZXJsYXlcbiIpOwo+ID4gICAJCXJldHVybiAtRU5PREVWOwo+ID4gQEAgLTEy
NTEsNyArMTI1MSw3IEBAIGludCBpbnRlbF9vdmVybGF5X2F0dHJzX2lvY3RsKHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAgIAkJYXR0cnMtPmNvbnRyYXN0ICAgPSBvdmVy
bGF5LT5jb250cmFzdDsKPiA+ICAgCQlhdHRycy0+c2F0dXJhdGlvbiA9IG92ZXJsYXktPnNhdHVy
YXRpb247Cj4gPiAtCQlpZiAoIUlTX0dFTihkZXZfcHJpdiwgMikpIHsKPiA+ICsJCWlmICghSVNf
R0VOKGk5MTUsIDIpKSB7Cj4gPiAgIAkJCWF0dHJzLT5nYW1tYTAgPSBJOTE1X1JFQUQoT0dBTUMw
KTsKPiA+ICAgCQkJYXR0cnMtPmdhbW1hMSA9IEk5MTVfUkVBRChPR0FNQzEpOwo+ID4gICAJCQlh
dHRycy0+Z2FtbWEyID0gSTkxNV9SRUFEKE9HQU1DMik7Cj4gPiBAQCAtMTI3NSw3ICsxMjc1LDcg
QEAgaW50IGludGVsX292ZXJsYXlfYXR0cnNfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwg
dm9pZCAqZGF0YSwKPiA+ICAgCQl1cGRhdGVfcmVnX2F0dHJzKG92ZXJsYXksIG92ZXJsYXktPnJl
Z3MpOwo+ID4gICAJCWlmIChhdHRycy0+ZmxhZ3MgJiBJOTE1X09WRVJMQVlfVVBEQVRFX0dBTU1B
KSB7Cj4gPiAtCQkJaWYgKElTX0dFTihkZXZfcHJpdiwgMikpCj4gPiArCQkJaWYgKElTX0dFTihp
OTE1LCAyKSkKPiA+ICAgCQkJCWdvdG8gb3V0X3VubG9jazsKPiA+ICAgCQkJaWYgKG92ZXJsYXkt
PmFjdGl2ZSkgewo+ID4gQEAgLTEzNTEsMTkgKzEzNTEsMTkgQEAgc3RhdGljIGludCBnZXRfcmVn
aXN0ZXJzKHN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5LCBib29sIHVzZV9waHlzKQo+ID4g
ICAJcmV0dXJuIGVycjsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfb3ZlcmxheV9zZXR1cChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9vdmVybGF5X3Nl
dHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfb3ZlcmxheSAqb3ZlcmxheTsKPiA+ICAgCWludCByZXQ7Cj4gPiAtCWlmICghSEFTX09W
RVJMQVkoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19PVkVSTEFZKGk5MTUpKQo+ID4gICAJCXJl
dHVybjsKPiA+ICAgCW92ZXJsYXkgPSBremFsbG9jKHNpemVvZigqb3ZlcmxheSksIEdGUF9LRVJO
RUwpOwo+ID4gICAJaWYgKCFvdmVybGF5KQo+ID4gICAJCXJldHVybjsKPiA+IC0Jb3ZlcmxheS0+
aTkxNSA9IGRldl9wcml2Owo+ID4gKwlvdmVybGF5LT5pOTE1ID0gaTkxNTsKPiA+ICAgCW92ZXJs
YXktPmNvbG9yX2tleSA9IDB4MDEwMWZlOwo+ID4gICAJb3ZlcmxheS0+Y29sb3Jfa2V5X2VuYWJs
ZWQgPSB0cnVlOwo+ID4gQEAgLTEzNzMsNyArMTM3Myw3IEBAIHZvaWQgaW50ZWxfb3ZlcmxheV9z
ZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlJTklUX0FDVElW
RV9SRVFVRVNUKCZvdmVybGF5LT5sYXN0X2ZsaXApOwo+ID4gLQlyZXQgPSBnZXRfcmVnaXN0ZXJz
KG92ZXJsYXksIE9WRVJMQVlfTkVFRFNfUEhZU0lDQUwoZGV2X3ByaXYpKTsKPiA+ICsJcmV0ID0g
Z2V0X3JlZ2lzdGVycyhvdmVybGF5LCBPVkVSTEFZX05FRURTX1BIWVNJQ0FMKGk5MTUpKTsKPiA+
ICAgCWlmIChyZXQpCj4gPiAgIAkJZ290byBvdXRfZnJlZTsKPiA+IEBAIC0xMzg3LDcgKzEzODcs
NyBAQCB2b2lkIGludGVsX292ZXJsYXlfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJdXBkYXRlX3BvbHlwaGFzZV9maWx0ZXIob3ZlcmxheS0+cmVncyk7Cj4g
PiAgIAl1cGRhdGVfcmVnX2F0dHJzKG92ZXJsYXksIG92ZXJsYXktPnJlZ3MpOwo+ID4gLQlkZXZf
cHJpdi0+b3ZlcmxheSA9IG92ZXJsYXk7Cj4gPiArCWk5MTUtPm92ZXJsYXkgPSBvdmVybGF5Owo+
ID4gICAJRFJNX0lORk8oIkluaXRpYWxpemVkIG92ZXJsYXkgc3VwcG9ydC5cbiIpOwo+ID4gICAJ
cmV0dXJuOwo+ID4gQEAgLTEzOTcsMTEgKzEzOTcsMTEgQEAgdm9pZCBpbnRlbF9vdmVybGF5X3Nl
dHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCWtmcmVlKG92ZXJs
YXkpOwo+ID4gICB9Cj4gPiAtdm9pZCBpbnRlbF9vdmVybGF5X2NsZWFudXAoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfb3ZlcmxheV9jbGVhbnVwKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxf
b3ZlcmxheSAqb3ZlcmxheTsKPiA+IC0Jb3ZlcmxheSA9IGZldGNoX2FuZF96ZXJvKCZkZXZfcHJp
di0+b3ZlcmxheSk7Cj4gPiArCW92ZXJsYXkgPSBmZXRjaF9hbmRfemVybygmaTkxNS0+b3Zlcmxh
eSk7Cj4gPiAgIAlpZiAoIW92ZXJsYXkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gQEAgLTE0MjcsOSAr
MTQyNyw5IEBAIHN0cnVjdCBpbnRlbF9vdmVybGF5X2Vycm9yX3N0YXRlIHsKPiA+ICAgfTsKPiA+
ICAgc3RydWN0IGludGVsX292ZXJsYXlfZXJyb3Jfc3RhdGUgKgo+ID4gLWludGVsX292ZXJsYXlf
Y2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiAraW50ZWxfb3ZlcmxheV9jYXB0dXJlX2Vycm9yX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5ID0g
ZGV2X3ByaXYtPm92ZXJsYXk7Cj4gPiArCXN0cnVjdCBpbnRlbF9vdmVybGF5ICpvdmVybGF5ID0g
aTkxNS0+b3ZlcmxheTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9vdmVybGF5X2Vycm9yX3N0YXRlICpl
cnJvcjsKPiA+ICAgCWlmICghb3ZlcmxheSB8fCAhb3ZlcmxheS0+YWN0aXZlKQo+ID4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX292ZXJsYXkuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX292ZXJsYXkuaAo+ID4gaW5kZXggYTE2N2MyOGFjZDI3Li4yZTg3NzFj
ZmZlZTkgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vdmVybGF5
LmgKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX292ZXJsYXkuaAo+ID4gQEAg
LTEzLDE2ICsxMywxNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiA+ICAgc3RydWN0IGlu
dGVsX292ZXJsYXk7Cj4gPiAgIHN0cnVjdCBpbnRlbF9vdmVybGF5X2Vycm9yX3N0YXRlOwo+ID4g
LXZvaWQgaW50ZWxfb3ZlcmxheV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwo+ID4gLXZvaWQgaW50ZWxfb3ZlcmxheV9jbGVhbnVwKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBpbnRlbF9vdmVybGF5X3NldHVwKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX292ZXJsYXlfY2xlYW51cChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIGludCBpbnRlbF9vdmVybGF5X3N3aXRj
aF9vZmYoc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXkpOwo+ID4gICBpbnQgaW50ZWxfb3Zl
cmxheV9wdXRfaW1hZ2VfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
PiA+ICAgCQkJCSAgc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYpOwo+ID4gICBpbnQgaW50ZWxf
b3ZlcmxheV9hdHRyc19pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+
ID4gICAJCQkgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdik7Cj4gPiAtdm9pZCBpbnRl
bF9vdmVybGF5X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAr
dm9pZCBpbnRlbF9vdmVybGF5X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiA+ICAgc3RydWN0IGludGVsX292ZXJsYXlfZXJyb3Jfc3RhdGUgKgo+ID4gLWludGVsX292ZXJs
YXlfY2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+ID4gK2ludGVsX292ZXJsYXlfY2FwdHVyZV9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIHZvaWQgaW50ZWxfb3ZlcmxheV9wcmludF9lcnJvcl9zdGF0
ZShzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jfc3RhdGVfYnVmICplLAo+ID4gICAJCQkJICAgICBzdHJ1
Y3QgaW50ZWxfb3ZlcmxheV9lcnJvcl9zdGF0ZSAqZXJyb3IpOwo+ID4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BhbmVsLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9wYW5lbC5jCj4gPiBpbmRleCA5Y2Q0ZTM3ZTM5MzQuLmQ4MDExNTA4OTQ0NSAxMDA2NDQK
PiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BhbmVsLmMKPiA+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BhbmVsLmMKPiA+IEBAIC02NSw3ICs2NSw3IEBAIHN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICoKPiA+ICAgaW50ZWxfcGFuZWxfZWRpZF9kb3duY2xvY2tf
bW9kZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsCj4gPiAgIAkJCQljb25zdCBz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqZml4ZWRfbW9kZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9y
LT5iYXNlLmRldik7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqc2Nhbiwg
KmJlc3RfbW9kZSA9IE5VTEw7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqZG93bmNs
b2NrX21vZGU7Cj4gPiAgIAlpbnQgYmVzdF9jbG9jayA9IGZpeGVkX21vZGUtPmNsb2NrOwo+ID4g
QEAgLTkyLDcgKzkyLDcgQEAgaW50ZWxfcGFuZWxfZWRpZF9kb3duY2xvY2tfbW9kZShzdHJ1Y3Qg
aW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsCj4gPiAgIAlpZiAoIWJlc3RfbW9kZSkKPiA+ICAg
CQlyZXR1cm4gTlVMTDsKPiA+IC0JZG93bmNsb2NrX21vZGUgPSBkcm1fbW9kZV9kdXBsaWNhdGUo
JmRldl9wcml2LT5kcm0sIGJlc3RfbW9kZSk7Cj4gPiArCWRvd25jbG9ja19tb2RlID0gZHJtX21v
ZGVfZHVwbGljYXRlKCZpOTE1LT5kcm0sIGJlc3RfbW9kZSk7Cj4gPiAgIAlpZiAoIWRvd25jbG9j
a19tb2RlKQo+ID4gICAJCXJldHVybiBOVUxMOwo+ID4gQEAgLTEwNiw3ICsxMDYsNyBAQCBpbnRl
bF9wYW5lbF9lZGlkX2Rvd25jbG9ja19tb2RlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5l
Y3RvciwKPiA+ICAgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKgo+ID4gICBpbnRlbF9wYW5lbF9l
ZGlkX2ZpeGVkX21vZGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVj
dG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxh
eV9tb2RlICpzY2FuOwo+ID4gICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGU7
Cj4gPiBAQCAtMTE4LDcgKzExOCw3IEBAIGludGVsX3BhbmVsX2VkaWRfZml4ZWRfbW9kZShzdHJ1
Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIAkJaWYgKChzY2FuLT50eXBlICYg
RFJNX01PREVfVFlQRV9QUkVGRVJSRUQpID09IDApCj4gPiAgIAkJCWNvbnRpbnVlOwo+ID4gLQkJ
Zml4ZWRfbW9kZSA9IGRybV9tb2RlX2R1cGxpY2F0ZSgmZGV2X3ByaXYtPmRybSwgc2Nhbik7Cj4g
PiArCQlmaXhlZF9tb2RlID0gZHJtX21vZGVfZHVwbGljYXRlKCZpOTE1LT5kcm0sIHNjYW4pOwo+
ID4gICAJCWlmICghZml4ZWRfbW9kZSkKPiA+ICAgCQkJcmV0dXJuIE5VTEw7Cj4gPiBAQCAtMTMy
LDcgKzEzMiw3IEBAIGludGVsX3BhbmVsX2VkaWRfZml4ZWRfbW9kZShzdHJ1Y3QgaW50ZWxfY29u
bmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIAlzY2FuID0gbGlzdF9maXJzdF9lbnRyeSgmY29ubmVj
dG9yLT5iYXNlLnByb2JlZF9tb2RlcywKPiA+ICAgCQkJCXR5cGVvZigqc2NhbiksIGhlYWQpOwo+
ID4gLQlmaXhlZF9tb2RlID0gZHJtX21vZGVfZHVwbGljYXRlKCZkZXZfcHJpdi0+ZHJtLCBzY2Fu
KTsKPiA+ICsJZml4ZWRfbW9kZSA9IGRybV9tb2RlX2R1cGxpY2F0ZSgmaTkxNS0+ZHJtLCBzY2Fu
KTsKPiA+ICAgCWlmICghZml4ZWRfbW9kZSkKPiA+ICAgCQlyZXR1cm4gTlVMTDsKPiA+IEBAIC0x
NDgsMTUgKzE0OCwxNSBAQCBpbnRlbF9wYW5lbF9lZGlkX2ZpeGVkX21vZGUoc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqCj4g
PiAgIGludGVsX3BhbmVsX3ZidF9maXhlZF9tb2RlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNv
bm5lY3RvcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3Qg
ZHJtX2Rpc3BsYXlfaW5mbyAqaW5mbyA9ICZjb25uZWN0b3ItPmJhc2UuZGlzcGxheV9pbmZvOwo+
ID4gICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGU7Cj4gPiAtCWlmICghZGV2
X3ByaXYtPnZidC5sZnBfbHZkc192YnRfbW9kZSkKPiA+ICsJaWYgKCFpOTE1LT52YnQubGZwX2x2
ZHNfdmJ0X21vZGUpCj4gPiAgIAkJcmV0dXJuIE5VTEw7Cj4gPiAtCWZpeGVkX21vZGUgPSBkcm1f
bW9kZV9kdXBsaWNhdGUoJmRldl9wcml2LT5kcm0sCj4gPiAtCQkJCQlkZXZfcHJpdi0+dmJ0Lmxm
cF9sdmRzX3ZidF9tb2RlKTsKPiA+ICsJZml4ZWRfbW9kZSA9IGRybV9tb2RlX2R1cGxpY2F0ZSgm
aTkxNS0+ZHJtLAo+ID4gKwkJCQkJaTkxNS0+dmJ0LmxmcF9sdmRzX3ZidF9tb2RlKTsKPiA+ICAg
CWlmICghZml4ZWRfbW9kZSkKPiA+ICAgCQlyZXR1cm4gTlVMTDsKPiA+IEBAIC0zNzgsNyArMzc4
LDcgQEAgdm9pZCBpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVsX2NydGMgKmlu
dGVsX2NydGMsCj4gPiAgIAkJCSAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2Nv
bmZpZywKPiA+ICAgCQkJICAgICAgaW50IGZpdHRpbmdfbW9kZSkKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2NydGMtPmJhc2Uu
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGludGVs
X2NydGMtPmJhc2UuZGV2KTsKPiA+ICAgCXUzMiBwZml0X2NvbnRyb2wgPSAwLCBwZml0X3BnbV9y
YXRpb3MgPSAwLCBib3JkZXIgPSAwOwo+ID4gICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFk
anVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiA+IEBAIC0z
OTksNyArMzk5LDcgQEAgdm9pZCBpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVs
X2NydGMgKmludGVsX2NydGMsCj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIERSTV9NT0RFX1ND
QUxFX0FTUEVDVDoKPiA+ICAgCQkvKiBTY2FsZSBidXQgcHJlc2VydmUgdGhlIGFzcGVjdCByYXRp
byAqLwo+ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkKPiA+ICsJCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gNCkKPiA+ICAgCQkJaTk2NV9zY2FsZV9hc3BlY3QocGlwZV9jb25maWcs
ICZwZml0X2NvbnRyb2wpOwo+ID4gICAJCWVsc2UKPiA+ICAgCQkJaTl4eF9zY2FsZV9hc3BlY3Qo
cGlwZV9jb25maWcsICZwZml0X2NvbnRyb2wsCj4gPiBAQCAtNDEzLDcgKzQxMyw3IEBAIHZvaWQg
aW50ZWxfZ21jaF9wYW5lbF9maXR0aW5nKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAo+
ID4gICAJCWlmIChwaXBlX2NvbmZpZy0+cGlwZV9zcmNfaCAhPSBhZGp1c3RlZF9tb2RlLT5jcnRj
X3ZkaXNwbGF5IHx8Cj4gPiAgIAkJICAgIHBpcGVfY29uZmlnLT5waXBlX3NyY193ICE9IGFkanVz
dGVkX21vZGUtPmNydGNfaGRpc3BsYXkpIHsKPiA+ICAgCQkJcGZpdF9jb250cm9sIHw9IFBGSVRf
RU5BQkxFOwo+ID4gLQkJCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDQpCj4gPiArCQkJaWYg
KElOVEVMX0dFTihpOTE1KSA+PSA0KQo+ID4gICAJCQkJcGZpdF9jb250cm9sIHw9IFBGSVRfU0NB
TElOR19BVVRPOwo+ID4gICAJCQllbHNlCj4gPiAgIAkJCQlwZml0X2NvbnRyb2wgfD0gKFZFUlRf
QVVUT19TQ0FMRSB8Cj4gPiBAQCAtNDI5LDcgKzQyOSw3IEBAIHZvaWQgaW50ZWxfZ21jaF9wYW5l
bF9maXR0aW5nKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAo+ID4gICAJLyogOTY1KyB3
YW50cyBmdXp6eSBmaXR0aW5nICovCj4gPiAgIAkvKiBGSVhNRTogaGFuZGxlIG11bHRpcGxlIHBh
bmVscyBieSBmYWlsaW5nIGdyYWNlZnVsbHkgKi8KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPj0gNCkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0KQo+ID4gICAJCXBmaXRfY29u
dHJvbCB8PSAoKGludGVsX2NydGMtPnBpcGUgPDwgUEZJVF9QSVBFX1NISUZUKSB8Cj4gPiAgIAkJ
CQkgUEZJVF9GSUxURVJfRlVaWlkpOwo+ID4gQEAgLTQ0MCw3ICs0NDAsNyBAQCB2b2lkIGludGVs
X2dtY2hfcGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywKPiA+ICAg
CX0KPiA+ICAgCS8qIE1ha2Ugc3VyZSBwcmUtOTY1IHNldCBkaXRoZXIgY29ycmVjdGx5IGZvciAx
OGJwcCBwYW5lbHMuICovCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNCAmJiBwaXBl
X2NvbmZpZy0+cGlwZV9icHAgPT0gMTgpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA0ICYm
IHBpcGVfY29uZmlnLT5waXBlX2JwcCA9PSAxOCkKPiA+ICAgCQlwZml0X2NvbnRyb2wgfD0gUEFO
RUxfOFRPNl9ESVRIRVJfRU5BQkxFOwo+ID4gICAJcGlwZV9jb25maWctPmdtY2hfcGZpdC5jb250
cm9sID0gcGZpdF9jb250cm9sOwo+ID4gQEAgLTUxNyw3ICs1MTcsNyBAQCBzdGF0aWMgaW5saW5l
IHUzMiBzY2FsZV9od190b191c2VyKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwK
PiA+ICAgc3RhdGljIHUzMiBpbnRlbF9wYW5lbF9jb21wdXRlX2JyaWdodG5lc3Moc3RydWN0IGlu
dGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAo+ID4gICAJCQkJCSAgdTMyIHZhbCkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rv
ci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVs
ID0gJmNvbm5lY3Rvci0+cGFuZWw7Cj4gPiAgIAlXQVJOX09OKHBhbmVsLT5iYWNrbGlnaHQubWF4
ID09IDApOwo+ID4gQEAgLTUyNiw3ICs1MjYsNyBAQCBzdGF0aWMgdTMyIGludGVsX3BhbmVsX2Nv
bXB1dGVfYnJpZ2h0bmVzcyhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsCj4gPiAg
IAkJcmV0dXJuIHZhbDsKPiA+ICAgCWlmIChpOTE1X21vZHBhcmFtcy5pbnZlcnRfYnJpZ2h0bmVz
cyA+IDAgfHwKPiA+IC0JICAgIGRldl9wcml2LT5xdWlya3MgJiBRVUlSS19JTlZFUlRfQlJJR0hU
TkVTUykgewo+ID4gKwkgICAgaTkxNS0+cXVpcmtzICYgUVVJUktfSU5WRVJUX0JSSUdIVE5FU1Mp
IHsKPiA+ICAgCQlyZXR1cm4gcGFuZWwtPmJhY2tsaWdodC5tYXggLSB2YWwgKyBwYW5lbC0+YmFj
a2xpZ2h0Lm1pbjsKPiA+ICAgCX0KPiA+IEBAIC01MzUsMzkgKzUzNSwzOSBAQCBzdGF0aWMgdTMy
IGludGVsX3BhbmVsX2NvbXB1dGVfYnJpZ2h0bmVzcyhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpj
b25uZWN0b3IsCj4gPiAgIHN0YXRpYyB1MzIgbHB0X2dldF9iYWNrbGlnaHQoc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsK
PiA+ICAgCXJldHVybiBJOTE1X1JFQUQoQkxDX1BXTV9QQ0hfQ1RMMikgJiBCQUNLTElHSFRfRFVU
WV9DWUNMRV9NQVNLOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB1MzIgcGNoX2dldF9iYWNrbGlnaHQo
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3It
PmJhc2UuZGV2KTsKPiA+ICAgCXJldHVybiBJOTE1X1JFQUQoQkxDX1BXTV9DUFVfQ1RMKSAmIEJB
Q0tMSUdIVF9EVVRZX0NZQ0xFX01BU0s7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHUzMiBpOXh4X2dl
dF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9y
LT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwg
PSAmY29ubmVjdG9yLT5wYW5lbDsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAgIAl2YWwgPSBJOTE1X1JF
QUQoQkxDX1BXTV9DVEwpICYgQkFDS0xJR0hUX0RVVFlfQ1lDTEVfTUFTSzsKPiA+IC0JaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPCA0KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpIDwgNCkKPiA+
ICAgCQl2YWwgPj49IDE7Cj4gPiAgIAlpZiAocGFuZWwtPmJhY2tsaWdodC5jb21iaW5hdGlvbl9t
b2RlKSB7Cj4gPiAgIAkJdTggbGJwYzsKPiA+IC0JCXBjaV9yZWFkX2NvbmZpZ19ieXRlKGRldl9w
cml2LT5kcm0ucGRldiwgTEJQQywgJmxicGMpOwo+ID4gKwkJcGNpX3JlYWRfY29uZmlnX2J5dGUo
aTkxNS0+ZHJtLnBkZXYsIExCUEMsICZsYnBjKTsKPiA+ICAgCQl2YWwgKj0gbGJwYzsKPiA+ICAg
CX0KPiA+ICAgCXJldHVybiB2YWw7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTMyIF92bHZfZ2V0X2Jh
Y2tsaWdodChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBl
KQo+ID4gK3N0YXRpYyB1MzIgX3Zsdl9nZXRfYmFja2xpZ2h0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gICAJaWYgKFdBUk5fT04ocGlw
ZSAhPSBQSVBFX0EgJiYgcGlwZSAhPSBQSVBFX0IpKQo+ID4gICAJCXJldHVybiAwOwo+ID4gQEAg
LTU3NywxNSArNTc3LDE1IEBAIHN0YXRpYyB1MzIgX3Zsdl9nZXRfYmFja2xpZ2h0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCj4gPiAgIHN0YXRpYyB1
MzIgdmx2X2dldF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0g
aW50ZWxfY29ubmVjdG9yX2dldF9waXBlKGNvbm5lY3Rvcik7Cj4gPiAtCXJldHVybiBfdmx2X2dl
dF9iYWNrbGlnaHQoZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwlyZXR1cm4gX3Zsdl9nZXRfYmFja2xp
Z2h0KGk5MTUsIHBpcGUpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB1MzIgYnh0X2dldF9iYWNrbGln
aHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0
b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVj
dG9yLT5wYW5lbDsKPiA+ICAgCXJldHVybiBJOTE1X1JFQUQoQlhUX0JMQ19QV01fRFVUWShwYW5l
bC0+YmFja2xpZ2h0LmNvbnRyb2xsZXIpKTsKPiA+IEBAIC02MDMsNyArNjAzLDcgQEAgc3RhdGlj
IHUzMiBwd21fZ2V0X2JhY2tsaWdodChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3Ip
Cj4gPiAgIHN0YXRpYyB2b2lkIGxwdF9zZXRfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBkcm1fY29u
bmVjdG9yX3N0YXRlICpjb25uX3N0YXRlLCB1MzIgbGV2ZWwpCj4gPiAgIHsKPiA+ICAgCXN0cnVj
dCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHRvX2ludGVsX2Nvbm5lY3Rvcihjb25uX3N0
YXRlLT5jb25uZWN0b3IpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiAgIAl1MzIgdmFs
ID0gSTkxNV9SRUFEKEJMQ19QV01fUENIX0NUTDIpICYgfkJBQ0tMSUdIVF9EVVRZX0NZQ0xFX01B
U0s7Cj4gPiAgIAlJOTE1X1dSSVRFKEJMQ19QV01fUENIX0NUTDIsIHZhbCB8IGxldmVsKTsKPiA+
IEBAIC02MTIsNyArNjEyLDcgQEAgc3RhdGljIHZvaWQgbHB0X3NldF9iYWNrbGlnaHQoY29uc3Qg
c3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUsIHUzMgo+ID4gICBzdGF0aWMg
dm9pZCBwY2hfc2V0X2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSwgdTMyIGxldmVsKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVj
dG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9y
KTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25u
ZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJdTMyIHRtcDsKPiA+ICAgCXRtcCA9
IEk5MTVfUkVBRChCTENfUFdNX0NQVV9DVEwpICYgfkJBQ0tMSUdIVF9EVVRZX0NZQ0xFX01BU0s7
Cj4gPiBAQCAtNjIyLDcgKzYyMiw3IEBAIHN0YXRpYyB2b2lkIHBjaF9zZXRfYmFja2xpZ2h0KGNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlLCB1MzIKPiA+ICAgc3Rh
dGljIHZvaWQgaTl4eF9zZXRfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0
YXRlICpjb25uX3N0YXRlLCB1MzIgbGV2ZWwpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvciA9IHRvX2ludGVsX2Nvbm5lY3Rvcihjb25uX3N0YXRlLT5jb25u
ZWN0b3IpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGFu
ZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7Cj4gPiAgIAl1MzIgdG1wLCBtYXNrOwo+ID4g
QEAgLTYzMywxMCArNjMzLDEwIEBAIHN0YXRpYyB2b2lkIGk5eHhfc2V0X2JhY2tsaWdodChjb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSwgdTMyCj4gPiAgIAkJbGJw
YyA9IGxldmVsICogMHhmZSAvIHBhbmVsLT5iYWNrbGlnaHQubWF4ICsgMTsKPiA+ICAgCQlsZXZl
bCAvPSBsYnBjOwo+ID4gLQkJcGNpX3dyaXRlX2NvbmZpZ19ieXRlKGRldl9wcml2LT5kcm0ucGRl
diwgTEJQQywgbGJwYyk7Cj4gPiArCQlwY2lfd3JpdGVfY29uZmlnX2J5dGUoaTkxNS0+ZHJtLnBk
ZXYsIExCUEMsIGxicGMpOwo+ID4gICAJfQo+ID4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCA0KSkg
ewo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDQpKSB7Cj4gPiAgIAkJbWFzayA9IEJBQ0tMSUdIVF9E
VVRZX0NZQ0xFX01BU0s7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCWxldmVsIDw8PSAxOwo+ID4g
QEAgLTY1MCw3ICs2NTAsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X3NldF9iYWNrbGlnaHQoY29uc3Qg
c3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUsIHUzMgo+ID4gICBzdGF0aWMg
dm9pZCB2bHZfc2V0X2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSwgdTMyIGxldmVsKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVj
dG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9y
KTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25u
ZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSB0b19p
bnRlbF9jcnRjKGNvbm5fc3RhdGUtPmNydGMpLT5waXBlOwo+ID4gICAJdTMyIHRtcDsKPiA+IEBA
IC02NjEsNyArNjYxLDcgQEAgc3RhdGljIHZvaWQgdmx2X3NldF9iYWNrbGlnaHQoY29uc3Qgc3Ry
dWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUsIHUzMgo+ID4gICBzdGF0aWMgdm9p
ZCBieHRfc2V0X2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29u
bl9zdGF0ZSwgdTMyIGxldmVsKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9y
ICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0
b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5l
bCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ID4gICAJSTkxNV9XUklURShCWFRfQkxDX1BXTV9EVVRZ
KHBhbmVsLT5iYWNrbGlnaHQuY29udHJvbGxlciksIGxldmVsKTsKPiA+IEBAIC02OTQsNyArNjk0
LDcgQEAgdm9pZCBpbnRlbF9wYW5lbF9zZXRfYmFja2xpZ2h0X2FjcGkoY29uc3Qgc3RydWN0IGRy
bV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUKPiA+ICAgCQkJCSAgICB1MzIgdXNlcl9sZXZl
bCwgdTMyIHVzZXJfbWF4KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpj
b25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3It
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9
ICZjb25uZWN0b3ItPnBhbmVsOwo+ID4gICAJdTMyIGh3X2xldmVsOwo+ID4gQEAgLTcwNyw3ICs3
MDcsNyBAQCB2b2lkIGludGVsX3BhbmVsX3NldF9iYWNrbGlnaHRfYWNwaShjb25zdCBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZQo+ID4gICAJaWYgKCFwYW5lbC0+YmFja2xp
Z2h0LnByZXNlbnQgfHwgIWNvbm5fc3RhdGUtPmNydGMpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlt
dXRleF9sb2NrKCZkZXZfcHJpdi0+YmFja2xpZ2h0X2xvY2spOwo+ID4gKwltdXRleF9sb2NrKCZp
OTE1LT5iYWNrbGlnaHRfbG9jayk7Cj4gPiAgIAlXQVJOX09OKHBhbmVsLT5iYWNrbGlnaHQubWF4
ID09IDApOwo+ID4gQEAgLTcyMywxMyArNzIzLDEzIEBAIHZvaWQgaW50ZWxfcGFuZWxfc2V0X2Jh
Y2tsaWdodF9hY3BpKGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRl
Cj4gPiAgIAlpZiAocGFuZWwtPmJhY2tsaWdodC5lbmFibGVkKQo+ID4gICAJCWludGVsX3BhbmVs
X2FjdHVhbGx5X3NldF9iYWNrbGlnaHQoY29ubl9zdGF0ZSwgaHdfbGV2ZWwpOwo+ID4gLQltdXRl
eF91bmxvY2soJmRldl9wcml2LT5iYWNrbGlnaHRfbG9jayk7Cj4gPiArCW11dGV4X3VubG9jaygm
aTkxNS0+YmFja2xpZ2h0X2xvY2spOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIGxwdF9kaXNh
YmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5f
c3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9
IHRvX2ludGVsX2Nvbm5lY3RvcihvbGRfY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2Uu
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5l
Y3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJdTMyIHRtcDsKPiA+ICAgCWludGVsX3BhbmVsX2FjdHVh
bGx5X3NldF9iYWNrbGlnaHQob2xkX2Nvbm5fc3RhdGUsIDApOwo+ID4gQEAgLTc1NSw3ICs3NTUs
NyBAQCBzdGF0aWMgdm9pZCBscHRfZGlzYWJsZV9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGRybV9j
b25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YQo+ID4gICBzdGF0aWMgdm9pZCBwY2hfZGlzYWJs
ZV9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0
YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0
b19pbnRlbF9jb25uZWN0b3Iob2xkX2Nvbm5fc3RhdGUtPmNvbm5lY3Rvcik7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0
b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXUzMiB0bXA7Cj4gPiAgIAlpbnRlbF9wYW5lbF9hY3R1YWxs
eV9zZXRfYmFja2xpZ2h0KG9sZF9jb25uX3N0YXRlLCAwKTsKPiA+IEBAIC03NzQsNyArNzc0LDcg
QEAgc3RhdGljIHZvaWQgaTl4eF9kaXNhYmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3QKPiA+ICAgc3RhdGljIHZvaWQgaTk2NV9kaXNhYmxl
X2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3Rh
dGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShvbGRfY29ubl9zdGF0ZS0+Y29ubmVjdG9yLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2xkX2Nvbm5fc3RhdGUtPmNvbm5lY3Rvci0+ZGV2
KTsKPiA+ICAgCXUzMiB0bXA7Cj4gPiAgIAlpbnRlbF9wYW5lbF9hY3R1YWxseV9zZXRfYmFja2xp
Z2h0KG9sZF9jb25uX3N0YXRlLCAwKTsKPiA+IEBAIC03ODYsNyArNzg2LDcgQEAgc3RhdGljIHZv
aWQgaTk2NV9kaXNhYmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0
ZSAqb2xkX2Nvbm5fc3QKPiA+ICAgc3RhdGljIHZvaWQgdmx2X2Rpc2FibGVfYmFja2xpZ2h0KGNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKPiA+ICAgewo+
ID4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50ZWxfY29ubmVj
dG9yKG9sZF9jb25uX3N0YXRlLT5jb25uZWN0b3IpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7
Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IHRvX2ludGVsX2NydGMob2xkX2Nvbm5fc3RhdGUtPmNy
dGMpLT5waXBlOwo+ID4gICAJdTMyIHRtcDsKPiA+IEBAIC03OTksNyArNzk5LDcgQEAgc3RhdGlj
IHZvaWQgdmx2X2Rpc2FibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0
YXRlICpvbGRfY29ubl9zdGEKPiA+ICAgc3RhdGljIHZvaWQgYnh0X2Rpc2FibGVfYmFja2xpZ2h0
KGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKPiA+ICAg
ewo+ID4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50ZWxfY29u
bmVjdG9yKG9sZF9jb25uX3N0YXRlLT5jb25uZWN0b3IpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRl
dik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7
Cj4gPiAgIAl1MzIgdG1wLCB2YWw7Cj4gPiBAQCAtODE5LDcgKzgxOSw3IEBAIHN0YXRpYyB2b2lk
IGJ4dF9kaXNhYmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
b2xkX2Nvbm5fc3RhCj4gPiAgIHN0YXRpYyB2b2lkIGNucF9kaXNhYmxlX2JhY2tsaWdodChjb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHRvX2ludGVsX2Nvbm5lY3Rv
cihvbGRfY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+
ID4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ID4g
ICAJdTMyIHRtcDsKPiA+IEBAIC04NDQsNyArODQ0LDcgQEAgc3RhdGljIHZvaWQgcHdtX2Rpc2Fi
bGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9z
dGEKPiA+ICAgdm9pZCBpbnRlbF9wYW5lbF9kaXNhYmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVj
dCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHRvX2ludGVsX2Nvbm5lY3RvcihvbGRfY29u
bl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJc3Ry
dWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ID4gICAJaWYgKCFw
YW5lbC0+YmFja2xpZ2h0LnByZXNlbnQpCj4gPiBAQCAtODU2LDI2ICs4NTYsMjYgQEAgdm9pZCBp
bnRlbF9wYW5lbF9kaXNhYmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqb2xkX2Nvbm5fc3QKPiA+ICAgCSAqIGJhY2tsaWdodC4gVGhpcyB3aWxsIGxlYXZlIHRo
ZSBiYWNrbGlnaHQgb24gdW5uZWNlc3NhcmlseSB3aGVuCj4gPiAgIAkgKiBhbm90aGVyIGNsaWVu
dCBpcyBub3QgYWN0aXZhdGVkLgo+ID4gICAJICovCj4gPiAtCWlmIChkZXZfcHJpdi0+ZHJtLnN3
aXRjaF9wb3dlcl9zdGF0ZSA9PSBEUk1fU1dJVENIX1BPV0VSX0NIQU5HSU5HKSB7Cj4gPiArCWlm
IChpOTE1LT5kcm0uc3dpdGNoX3Bvd2VyX3N0YXRlID09IERSTV9TV0lUQ0hfUE9XRVJfQ0hBTkdJ
TkcpIHsKPiA+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJTa2lwcGluZyBiYWNrbGlnaHQgZGlzYWJs
ZSBvbiB2Z2Egc3dpdGNoXG4iKTsKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiAtCW11dGV4
X2xvY2soJmRldl9wcml2LT5iYWNrbGlnaHRfbG9jayk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUt
PmJhY2tsaWdodF9sb2NrKTsKPiA+ICAgCWlmIChwYW5lbC0+YmFja2xpZ2h0LmRldmljZSkKPiA+
ICAgCQlwYW5lbC0+YmFja2xpZ2h0LmRldmljZS0+cHJvcHMucG93ZXIgPSBGQl9CTEFOS19QT1dF
UkRPV047Cj4gPiAgIAlwYW5lbC0+YmFja2xpZ2h0LmVuYWJsZWQgPSBmYWxzZTsKPiA+ICAgCXBh
bmVsLT5iYWNrbGlnaHQuZGlzYWJsZShvbGRfY29ubl9zdGF0ZSk7Cj4gPiAtCW11dGV4X3VubG9j
aygmZGV2X3ByaXYtPmJhY2tsaWdodF9sb2NrKTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5i
YWNrbGlnaHRfbG9jayk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgbHB0X2VuYWJsZV9iYWNr
bGlnaHQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJ
CQkgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gPiAgIHsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHRvX2ludGVsX2Nvbm5l
Y3Rvcihjb25uX3N0YXRlLT5jb25uZWN0b3IpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7Cj4gPiAg
IAl1MzIgcGNoX2N0bDEsIHBjaF9jdGwyLCBzY2hpY2tlbjsKPiA+IEBAIC04ODYsNyArODg2LDcg
QEAgc3RhdGljIHZvaWQgbHB0X2VuYWJsZV9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJSTkxNV9XUklURShCTENfUFdNX1BDSF9DVEwx
LCBwY2hfY3RsMSk7Cj4gPiAgIAl9Cj4gPiAtCWlmIChIQVNfUENIX0xQVChkZXZfcHJpdikpIHsK
PiA+ICsJaWYgKEhBU19QQ0hfTFBUKGk5MTUpKSB7Cj4gPiAgIAkJc2NoaWNrZW4gPSBJOTE1X1JF
QUQoU09VVEhfQ0hJQ0tFTjIpOwo+ID4gICAJCWlmIChwYW5lbC0+YmFja2xpZ2h0LmFsdGVybmF0
ZV9wd21faW5jcmVtZW50KQo+ID4gICAJCQlzY2hpY2tlbiB8PSBMUFRfUFdNX0dSQU5VTEFSSVRZ
Owo+ID4gQEAgLTkxMCw3ICs5MTAsNyBAQCBzdGF0aWMgdm9pZCBscHRfZW5hYmxlX2JhY2tsaWdo
dChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQlwY2hf
Y3RsMSB8PSBCTE1fUENIX1BPTEFSSVRZOwo+ID4gICAJLyogQWZ0ZXIgTFBULCBvdmVycmlkZSBp
cyB0aGUgZGVmYXVsdC4gKi8KPiA+IC0JaWYgKEhBU19QQ0hfTFBUKGRldl9wcml2KSkKPiA+ICsJ
aWYgKEhBU19QQ0hfTFBUKGk5MTUpKQo+ID4gICAJCXBjaF9jdGwxIHw9IEJMTV9QQ0hfT1ZFUlJJ
REVfRU5BQkxFOwo+ID4gICAJSTkxNV9XUklURShCTENfUFdNX1BDSF9DVEwxLCBwY2hfY3RsMSk7
Cj4gPiBAQCAtOTI1LDcgKzkyNSw3IEBAIHN0YXRpYyB2b2lkIHBjaF9lbmFibGVfYmFja2xpZ2h0
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkJIGNv
bnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3Io
Y29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJ
c3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ID4gICAJZW51
bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7
Cj4gPiAgIAl1MzIgY3B1X2N0bDIsIHBjaF9jdGwxLCBwY2hfY3RsMjsKPiA+IEBAIC05NzEsNyAr
OTcxLDcgQEAgc3RhdGljIHZvaWQgaTl4eF9lbmFibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkJICBjb25zdCBzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50ZWxfY29ubmVjdG9yKGNvbm5fc3RhdGUtPmNv
bm5lY3Rvcik7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9w
YW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiA+ICAgCXUzMiBjdGwsIGZyZXE7Cj4g
PiBAQCAtOTg4LDcgKzk4OCw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfZW5hYmxlX2JhY2tsaWdodChj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCWN0bCA9IGZy
ZXEgPDwgMTc7Cj4gPiAgIAlpZiAocGFuZWwtPmJhY2tsaWdodC5jb21iaW5hdGlvbl9tb2RlKQo+
ID4gICAJCWN0bCB8PSBCTE1fTEVHQUNZX01PREU7Cj4gPiAtCWlmIChJU19QSU5FVklFVyhkZXZf
cHJpdikgJiYgcGFuZWwtPmJhY2tsaWdodC5hY3RpdmVfbG93X3B3bSkKPiA+ICsJaWYgKElTX1BJ
TkVWSUVXKGk5MTUpICYmIHBhbmVsLT5iYWNrbGlnaHQuYWN0aXZlX2xvd19wd20pCj4gPiAgIAkJ
Y3RsIHw9IEJMTV9QT0xBUklUWV9QTlY7Cj4gPiAgIAlJOTE1X1dSSVRFKEJMQ19QV01fQ1RMLCBj
dGwpOwo+ID4gQEAgLTEwMDIsNyArMTAwMiw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfZW5hYmxlX2Jh
Y2tsaWdodChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAg
CSAqIDg1NWdtIG9ubHksIGJ1dCBjaGVja2luZyBmb3IgZ2VuMiBpcyBzYWZlLCBhcyA4NTVnbSBp
cyB0aGUgb25seSBnZW4yCj4gPiAgIAkgKiB0aGF0IGhhcyBiYWNrbGlnaHQuCj4gPiAgIAkgKi8K
PiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgMikpCj4gPiArCWlmIChJU19HRU4oaTkxNSwgMikp
Cj4gPiAgIAkJSTkxNV9XUklURShCTENfSElTVF9DVEwsIEJMTV9ISVNUT0dSQU1fRU5BQkxFKTsK
PiA+ICAgfQo+ID4gQEAgLTEwMTAsNyArMTAxMCw3IEBAIHN0YXRpYyB2b2lkIGk5NjVfZW5hYmxl
X2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+
ICAgCQkJCSAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4g
PiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHRvX2ludGVs
X2Nvbm5lY3Rvcihjb25uX3N0YXRlLT5jb25uZWN0b3IpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRl
dik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7
Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IHRvX2ludGVsX2NydGMoY29ubl9zdGF0ZS0+Y3J0Yykt
PnBpcGU7Cj4gPiAgIAl1MzIgY3RsLCBjdGwyLCBmcmVxOwo+ID4gQEAgLTEwNDUsNyArMTA0NSw3
IEBAIHN0YXRpYyB2b2lkIHZsdl9lbmFibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVj
dG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVj
dG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9y
KTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25u
ZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3BhbmVsICpw
YW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0YyktPnBpcGU7Cj4gPiAgIAl1MzIgY3RsLCBjdGwy
Owo+ID4gQEAgLTEwNzUsNyArMTA3NSw3IEBAIHN0YXRpYyB2b2lkIGJ4dF9lbmFibGVfYmFja2xp
Z2h0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkJ
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0
b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4g
ICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ID4gICAJ
ZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0YyktPnBp
cGU7Cj4gPiAgIAl1MzIgcHdtX2N0bCwgdmFsOwo+ID4gQEAgLTExMjMsNyArMTEyMyw3IEBAIHN0
YXRpYyB2b2lkIGNucF9lbmFibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0
YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpj
b25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3It
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9
ICZjb25uZWN0b3ItPnBhbmVsOwo+ID4gICAJdTMyIHB3bV9jdGw7Cj4gPiBAQCAtMTE4Nyw3ICsx
MTg3LDcgQEAgdm9pZCBpbnRlbF9wYW5lbF9lbmFibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkJICBjb25zdCBzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50ZWxfY29ubmVjdG9yKGNvbm5fc3RhdGUtPmNv
bm5lY3Rvcik7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9w
YW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0g
dG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpLT5waXBlOwo+ID4gQEAgLTExOTYs
MjggKzExOTYsMjggQEAgdm9pZCBpbnRlbF9wYW5lbF9lbmFibGVfYmFja2xpZ2h0KGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJRFJNX0RFQlVHX0tNUygi
cGlwZSAlY1xuIiwgcGlwZV9uYW1lKHBpcGUpKTsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYt
PmJhY2tsaWdodF9sb2NrKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+YmFja2xpZ2h0X2xvY2sp
Owo+ID4gICAJX19pbnRlbF9wYW5lbF9lbmFibGVfYmFja2xpZ2h0KGNydGNfc3RhdGUsIGNvbm5f
c3RhdGUpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5iYWNrbGlnaHRfbG9jayk7Cj4g
PiArCW11dGV4X3VubG9jaygmaTkxNS0+YmFja2xpZ2h0X2xvY2spOwo+ID4gICB9Cj4gPiAgICNp
ZiBJU19FTkFCTEVEKENPTkZJR19CQUNLTElHSFRfQ0xBU1NfREVWSUNFKQo+ID4gICBzdGF0aWMg
dTMyIGludGVsX3BhbmVsX2dldF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29u
bmVjdG9yKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiA+ICAgCXUzMiB2YWwgPSAw
Owo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+YmFja2xpZ2h0X2xvY2spOwo+ID4gKwltdXRl
eF9sb2NrKCZpOTE1LT5iYWNrbGlnaHRfbG9jayk7Cj4gPiAgIAlpZiAocGFuZWwtPmJhY2tsaWdo
dC5lbmFibGVkKSB7Cj4gPiAgIAkJdmFsID0gcGFuZWwtPmJhY2tsaWdodC5nZXQoY29ubmVjdG9y
KTsKPiA+ICAgCQl2YWwgPSBpbnRlbF9wYW5lbF9jb21wdXRlX2JyaWdodG5lc3MoY29ubmVjdG9y
LCB2YWwpOwo+ID4gICAJfQo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5iYWNrbGlnaHRf
bG9jayk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+YmFja2xpZ2h0X2xvY2spOwo+ID4gICAJ
RFJNX0RFQlVHX0RSSVZFUigiZ2V0IGJhY2tsaWdodCBQV00gPSAlZFxuIiwgdmFsKTsKPiA+ICAg
CXJldHVybiB2YWw7Cj4gPiBAQCAtMTIyOCwxNCArMTIyOCwxNCBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9wYW5lbF9zZXRfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpj
b25uX3N0YQo+ID4gICAJCQkJICAgICAgdTMyIHVzZXJfbGV2ZWwsIHUzMiB1c2VyX21heCkKPiA+
ICAgewo+ID4gICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50ZWxf
Y29ubmVjdG9yKGNvbm5fc3RhdGUtPmNvbm5lY3Rvcik7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2
KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsK
PiA+ICAgCXUzMiBod19sZXZlbDsKPiA+ICAgCWlmICghcGFuZWwtPmJhY2tsaWdodC5wcmVzZW50
KQo+ID4gICAJCXJldHVybjsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmJhY2tsaWdodF9s
b2NrKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+YmFja2xpZ2h0X2xvY2spOwo+ID4gICAJV0FS
Tl9PTihwYW5lbC0+YmFja2xpZ2h0Lm1heCA9PSAwKTsKPiA+IEBAIC0xMjQ1LDcgKzEyNDUsNyBA
QCBzdGF0aWMgdm9pZCBpbnRlbF9wYW5lbF9zZXRfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uX3N0YQo+ID4gICAJaWYgKHBhbmVsLT5iYWNrbGlnaHQuZW5h
YmxlZCkKPiA+ICAgCQlpbnRlbF9wYW5lbF9hY3R1YWxseV9zZXRfYmFja2xpZ2h0KGNvbm5fc3Rh
dGUsIGh3X2xldmVsKTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+YmFja2xpZ2h0X2xv
Y2spOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmJhY2tsaWdodF9sb2NrKTsKPiA+ICAgfQo+
ID4gICBzdGF0aWMgaW50IGludGVsX2JhY2tsaWdodF9kZXZpY2VfdXBkYXRlX3N0YXR1cyhzdHJ1
Y3QgYmFja2xpZ2h0X2RldmljZSAqYmQpCj4gPiBAQCAtMTI4NCwxMSArMTI4NCwxMSBAQCBzdGF0
aWMgaW50IGludGVsX2JhY2tsaWdodF9kZXZpY2VfZ2V0X2JyaWdodG5lc3Moc3RydWN0IGJhY2ts
aWdodF9kZXZpY2UgKmJkKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpj
b25uZWN0b3IgPSBibF9nZXRfZGF0YShiZCk7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gY29ubmVjdG9yLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJ
aW50IHJldCA9IDA7Cj4gPiAtCXdpdGhfaW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJl
Zikgewo+ID4gKwl3aXRoX2ludGVsX3J1bnRpbWVfcG0oaTkxNSwgd2FrZXJlZikgewo+ID4gICAJ
CXUzMiBod19sZXZlbDsKPiA+ICAgCQlkcm1fbW9kZXNldF9sb2NrKCZkZXYtPm1vZGVfY29uZmln
LmNvbm5lY3Rpb25fbXV0ZXgsIE5VTEwpOwo+ID4gQEAgLTEzNzgsOSArMTM3OCw5IEBAIHZvaWQg
aW50ZWxfYmFja2xpZ2h0X2RldmljZV91bnJlZ2lzdGVyKHN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmNvbm5lY3RvcikKPiA+ICAgICovCj4gPiAgIHN0YXRpYyB1MzIgY25wX2h6X3RvX3B3bShzdHJ1
Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsIHUzMiBwd21fZnJlcV9oeikKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rv
ci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiAtCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChL
SHooZGV2X3ByaXYtPnJhd2Nsa19mcmVxKSwgcHdtX2ZyZXFfaHopOwo+ID4gKwlyZXR1cm4gRElW
X1JPVU5EX0NMT1NFU1QoS0h6KGk5MTUtPnJhd2Nsa19mcmVxKSwgcHdtX2ZyZXFfaHopOwo+ID4g
ICB9Cj4gPiAgIC8qCj4gPiBAQCAtMTQxNiw3ICsxNDE2LDcgQEAgc3RhdGljIHUzMiBzcHRfaHpf
dG9fcHdtKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwgdTMyIHB3bV9mcmVxX2h6
KQo+ID4gICAgKi8KPiA+ICAgc3RhdGljIHUzMiBscHRfaHpfdG9fcHdtKHN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvciwgdTMyIHB3bV9mcmVxX2h6KQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0
b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVj
dG9yLT5wYW5lbDsKPiA+ICAgCXUzMiBtdWwsIGNsb2NrOwo+ID4gQEAgLTE0MjUsNyArMTQyNSw3
IEBAIHN0YXRpYyB1MzIgbHB0X2h6X3RvX3B3bShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25u
ZWN0b3IsIHUzMiBwd21fZnJlcV9oeikKPiA+ICAgCWVsc2UKPiA+ICAgCQltdWwgPSAxMjg7Cj4g
PiAtCWlmIChIQVNfUENIX0xQVF9IKGRldl9wcml2KSkKPiA+ICsJaWYgKEhBU19QQ0hfTFBUX0go
aTkxNSkpCj4gPiAgIAkJY2xvY2sgPSBNSHooMTM1KTsgLyogTFBUOkggKi8KPiA+ICAgCWVsc2UK
PiA+ICAgCQljbG9jayA9IE1IeigyNCk7IC8qIExQVDpMUCAqLwo+ID4gQEAgLTE0MzksOSArMTQz
OSw5IEBAIHN0YXRpYyB1MzIgbHB0X2h6X3RvX3B3bShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpj
b25uZWN0b3IsIHUzMiBwd21fZnJlcV9oeikKPiA+ICAgICovCj4gPiAgIHN0YXRpYyB1MzIgcGNo
X2h6X3RvX3B3bShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsIHUzMiBwd21fZnJl
cV9oeikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiAtCXJldHVybiBESVZf
Uk9VTkRfQ0xPU0VTVChLSHooZGV2X3ByaXYtPnJhd2Nsa19mcmVxKSwgcHdtX2ZyZXFfaHogKiAx
MjgpOwo+ID4gKwlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QoS0h6KGk5MTUtPnJhd2Nsa19mcmVx
KSwgcHdtX2ZyZXFfaHogKiAxMjgpOwo+ID4gICB9Cj4gPiAgIC8qCj4gPiBAQCAtMTQ1NCwxMyAr
MTQ1NCwxMyBAQCBzdGF0aWMgdTMyIHBjaF9oel90b19wd20oc3RydWN0IGludGVsX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yLCB1MzIgcHdtX2ZyZXFfaHopCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgdTMy
IGk5eHhfaHpfdG9fcHdtKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwgdTMyIHB3
bV9mcmVxX2h6KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCWludCBj
bG9jazsKPiA+IC0JaWYgKElTX1BJTkVWSUVXKGRldl9wcml2KSkKPiA+IC0JCWNsb2NrID0gS0h6
KGRldl9wcml2LT5yYXdjbGtfZnJlcSk7Cj4gPiArCWlmIChJU19QSU5FVklFVyhpOTE1KSkKPiA+
ICsJCWNsb2NrID0gS0h6KGk5MTUtPnJhd2Nsa19mcmVxKTsKPiA+ICAgCWVsc2UKPiA+IC0JCWNs
b2NrID0gS0h6KGRldl9wcml2LT5jZGNsay5ody5jZGNsayk7Cj4gPiArCQljbG9jayA9IEtIeihp
OTE1LT5jZGNsay5ody5jZGNsayk7Cj4gPiAgIAlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QoY2xv
Y2ssIHB3bV9mcmVxX2h6ICogMzIpOwo+ID4gICB9Cj4gPiBAQCAtMTQ3MiwxMyArMTQ3MiwxMyBA
QCBzdGF0aWMgdTMyIGk5eHhfaHpfdG9fcHdtKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5l
Y3RvciwgdTMyIHB3bV9mcmVxX2h6KQo+ID4gICAgKi8KPiA+ICAgc3RhdGljIHUzMiBpOTY1X2h6
X3RvX3B3bShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsIHUzMiBwd21fZnJlcV9o
eikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiAgIAlpbnQgY2xvY2s7Cj4g
PiAtCWlmIChJU19HNFgoZGV2X3ByaXYpKQo+ID4gLQkJY2xvY2sgPSBLSHooZGV2X3ByaXYtPnJh
d2Nsa19mcmVxKTsKPiA+ICsJaWYgKElTX0c0WChpOTE1KSkKPiA+ICsJCWNsb2NrID0gS0h6KGk5
MTUtPnJhd2Nsa19mcmVxKTsKPiA+ICAgCWVsc2UKPiA+IC0JCWNsb2NrID0gS0h6KGRldl9wcml2
LT5jZGNsay5ody5jZGNsayk7Cj4gPiArCQljbG9jayA9IEtIeihpOTE1LT5jZGNsay5ody5jZGNs
ayk7Cj4gPiAgIAlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QoY2xvY2ssIHB3bV9mcmVxX2h6ICog
MTI4KTsKPiA+ICAgfQo+ID4gQEAgLTE0OTAsMTcgKzE0OTAsMTcgQEAgc3RhdGljIHUzMiBpOTY1
X2h6X3RvX3B3bShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsIHUzMiBwd21fZnJl
cV9oeikKPiA+ICAgICovCj4gPiAgIHN0YXRpYyB1MzIgdmx2X2h6X3RvX3B3bShzdHJ1Y3QgaW50
ZWxfY29ubmVjdG9yICpjb25uZWN0b3IsIHUzMiBwd21fZnJlcV9oeikKPiA+ICAgewo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFz
ZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29u
bmVjdG9yLT5iYXNlLmRldik7Cj4gPiAgIAlpbnQgbXVsLCBjbG9jazsKPiA+ICAgCWlmICgoSTkx
NV9SRUFEKENCUjFfVkxWKSAmIENCUl9QV01fQ0xPQ0tfTVVYX1NFTEVDVCkgPT0gMCkgewo+ID4g
LQkJaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwkJaWYgKElTX0NIRVJSWVZJRVco
aTkxNSkpCj4gPiAgIAkJCWNsb2NrID0gS0h6KDE5MjAwKTsKPiA+ICAgCQllbHNlCj4gPiAgIAkJ
CWNsb2NrID0gTUh6KDI1KTsKPiA+ICAgCQltdWwgPSAxNjsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAt
CQljbG9jayA9IEtIeihkZXZfcHJpdi0+cmF3Y2xrX2ZyZXEpOwo+ID4gKwkJY2xvY2sgPSBLSHoo
aTkxNS0+cmF3Y2xrX2ZyZXEpOwo+ID4gICAJCW11bCA9IDEyODsKPiA+ICAgCX0KPiA+IEBAIC0x
NTA5LDkgKzE1MDksOSBAQCBzdGF0aWMgdTMyIHZsdl9oel90b19wd20oc3RydWN0IGludGVsX2Nv
bm5lY3RvciAqY29ubmVjdG9yLCB1MzIgcHdtX2ZyZXFfaHopCj4gPiAgIHN0YXRpYyB1MzIgZ2V0
X2JhY2tsaWdodF9tYXhfdmJ0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+
ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNv
bm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwg
KnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7Cj4gPiAtCXUxNiBwd21fZnJlcV9oeiA9IGRldl9w
cml2LT52YnQuYmFja2xpZ2h0LnB3bV9mcmVxX2h6Owo+ID4gKwl1MTYgcHdtX2ZyZXFfaHogPSBp
OTE1LT52YnQuYmFja2xpZ2h0LnB3bV9mcmVxX2h6Owo+ID4gICAJdTMyIHB3bTsKPiA+ICAgCWlm
ICghcGFuZWwtPmJhY2tsaWdodC5oel90b19wd20pIHsKPiA+IEBAIC0xNTQyLDcgKzE1NDIsNyBA
QCBzdGF0aWMgdTMyIGdldF9iYWNrbGlnaHRfbWF4X3ZidChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9y
ICpjb25uZWN0b3IpCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgdTMyIGdldF9iYWNrbGlnaHRfbWlu
X3ZidChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2Uu
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5l
Y3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25u
ZWN0b3ItPnBhbmVsOwo+ID4gICAJaW50IG1pbjsKPiA+IEBAIC0xNTU1LDEwICsxNTU1LDEwIEBA
IHN0YXRpYyB1MzIgZ2V0X2JhY2tsaWdodF9taW5fdmJ0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmNvbm5lY3RvcikKPiA+ICAgCSAqIGFnYWluc3QgdGhpcyBieSBsZXR0aW5nIHRoZSBtaW5pbXVt
IGJlIGF0IG1vc3QgKGFyYml0cmFyaWx5IGNob3NlbikKPiA+ICAgCSAqIDI1JSBvZiB0aGUgbWF4
Lgo+ID4gICAJICovCj4gPiAtCW1pbiA9IGNsYW1wX3QoaW50LCBkZXZfcHJpdi0+dmJ0LmJhY2ts
aWdodC5taW5fYnJpZ2h0bmVzcywgMCwgNjQpOwo+ID4gLQlpZiAobWluICE9IGRldl9wcml2LT52
YnQuYmFja2xpZ2h0Lm1pbl9icmlnaHRuZXNzKSB7Cj4gPiArCW1pbiA9IGNsYW1wX3QoaW50LCBp
OTE1LT52YnQuYmFja2xpZ2h0Lm1pbl9icmlnaHRuZXNzLCAwLCA2NCk7Cj4gPiArCWlmIChtaW4g
IT0gaTkxNS0+dmJ0LmJhY2tsaWdodC5taW5fYnJpZ2h0bmVzcykgewo+ID4gICAJCURSTV9ERUJV
R19LTVMoImNsYW1waW5nIFZCVCBtaW4gYmFja2xpZ2h0ICVkLzI1NSB0byAlZC8yNTVcbiIsCj4g
PiAtCQkJICAgICAgZGV2X3ByaXYtPnZidC5iYWNrbGlnaHQubWluX2JyaWdodG5lc3MsIG1pbik7
Cj4gPiArCQkJICAgICAgaTkxNS0+dmJ0LmJhY2tsaWdodC5taW5fYnJpZ2h0bmVzcywgbWluKTsK
PiA+ICAgCX0KPiA+ICAgCS8qIHZidCB2YWx1ZSBpcyBhIGNvZWZmaWNpZW50IGluIHJhbmdlIFsw
Li4yNTVdICovCj4gPiBAQCAtMTU2NywxMiArMTU2NywxMiBAQCBzdGF0aWMgdTMyIGdldF9iYWNr
bGlnaHRfbWluX3ZidChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHN0
YXRpYyBpbnQgbHB0X3NldHVwX2JhY2tsaWdodChzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25u
ZWN0b3IsIGVudW0gcGlwZSB1bnVzZWQpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYp
Owo+ID4gICAJc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+
ID4gICAJdTMyIGNwdV9jdGwyLCBwY2hfY3RsMSwgcGNoX2N0bDIsIHZhbDsKPiA+ICAgCWJvb2wg
YWx0LCBjcHVfbW9kZTsKPiA+IC0JaWYgKEhBU19QQ0hfTFBUKGRldl9wcml2KSkKPiA+ICsJaWYg
KEhBU19QQ0hfTFBUKGk5MTUpKQo+ID4gICAJCWFsdCA9IEk5MTVfUkVBRChTT1VUSF9DSElDS0VO
MikgJiBMUFRfUFdNX0dSQU5VTEFSSVRZOwo+ID4gICAJZWxzZQo+ID4gICAJCWFsdCA9IEk5MTVf
UkVBRChTT1VUSF9DSElDS0VOMSkgJiBTUFRfUFdNX0dSQU5VTEFSSVRZOwo+ID4gQEAgLTE1OTYs
NyArMTU5Niw3IEBAIHN0YXRpYyBpbnQgbHB0X3NldHVwX2JhY2tsaWdodChzdHJ1Y3QgaW50ZWxf
Y29ubmVjdG9yICpjb25uZWN0b3IsIGVudW0gcGlwZSB1bnVzCj4gPiAgIAlwYW5lbC0+YmFja2xp
Z2h0LmVuYWJsZWQgPSBwY2hfY3RsMSAmIEJMTV9QQ0hfUFdNX0VOQUJMRTsKPiA+IC0JY3B1X21v
ZGUgPSBwYW5lbC0+YmFja2xpZ2h0LmVuYWJsZWQgJiYgSEFTX1BDSF9MUFQoZGV2X3ByaXYpICYm
Cj4gPiArCWNwdV9tb2RlID0gcGFuZWwtPmJhY2tsaWdodC5lbmFibGVkICYmIEhBU19QQ0hfTFBU
KGk5MTUpICYmCj4gPiAgIAkJICAgIShwY2hfY3RsMSAmIEJMTV9QQ0hfT1ZFUlJJREVfRU5BQkxF
KSAmJgo+ID4gICAJCSAgIChjcHVfY3RsMiAmIEJMTV9QV01fRU5BQkxFKTsKPiA+ICAgCWlmIChj
cHVfbW9kZSkKPiA+IEBAIC0xNjIyLDcgKzE2MjIsNyBAQCBzdGF0aWMgaW50IGxwdF9zZXR1cF9i
YWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUgdW51
cwo+ID4gICBzdGF0aWMgaW50IHBjaF9zZXR1cF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUgdW51c2VkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7
Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3It
PmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVjdG9y
LT5wYW5lbDsKPiA+ICAgCXUzMiBjcHVfY3RsMiwgcGNoX2N0bDEsIHBjaF9jdGwyLCB2YWw7Cj4g
PiBAQCAtMTY1NCwxNiArMTY1NCwxNiBAQCBzdGF0aWMgaW50IHBjaF9zZXR1cF9iYWNrbGlnaHQo
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUgdW51cwo+ID4gICBz
dGF0aWMgaW50IGk5eHhfc2V0dXBfYmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNv
bm5lY3RvciwgZW51bSBwaXBlIHVudXNlZCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRl
dik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7
Cj4gPiAgIAl1MzIgY3RsLCB2YWw7Cj4gPiAgIAljdGwgPSBJOTE1X1JFQUQoQkxDX1BXTV9DVEwp
Owo+ID4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCAyKSB8fCBJU19JOTE1R00oZGV2X3ByaXYpIHx8
IElTX0k5NDVHTShkZXZfcHJpdikpCj4gPiArCWlmIChJU19HRU4oaTkxNSwgMikgfHwgSVNfSTkx
NUdNKGk5MTUpIHx8IElTX0k5NDVHTShpOTE1KSkKPiA+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LmNv
bWJpbmF0aW9uX21vZGUgPSBjdGwgJiBCTE1fTEVHQUNZX01PREU7Cj4gPiAtCWlmIChJU19QSU5F
VklFVyhkZXZfcHJpdikpCj4gPiArCWlmIChJU19QSU5FVklFVyhpOTE1KSkKPiA+ICAgCQlwYW5l
bC0+YmFja2xpZ2h0LmFjdGl2ZV9sb3dfcHdtID0gY3RsICYgQkxNX1BPTEFSSVRZX1BOVjsKPiA+
ICAgCXBhbmVsLT5iYWNrbGlnaHQubWF4ID0gY3RsID4+IDE3Owo+ID4gQEAgLTE2OTMsNyArMTY5
Myw3IEBAIHN0YXRpYyBpbnQgaTl4eF9zZXR1cF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUgdW51Cj4gPiAgIHN0YXRpYyBpbnQgaTk2NV9zZXR1
cF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUg
dW51c2VkKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiA+ICAgCXUzMiBjdGwsIGN0
bDIsIHZhbDsKPiA+IEBAIC0xNzI3LDcgKzE3MjcsNyBAQCBzdGF0aWMgaW50IGk5NjVfc2V0dXBf
YmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwgZW51bSBwaXBlIHVu
dQo+ID4gICBzdGF0aWMgaW50IHZsdl9zZXR1cF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5l
Y3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5i
YXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+
cGFuZWw7Cj4gPiAgIAl1MzIgY3RsLCBjdGwyLCB2YWw7Cj4gPiBAQCAtMTc0OCw3ICsxNzQ4LDcg
QEAgc3RhdGljIGludCB2bHZfc2V0dXBfYmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmNvbm5lY3RvciwgZW51bSBwaXBlIHBpcGUKPiA+ICAgCXBhbmVsLT5iYWNrbGlnaHQubWluID0g
Z2V0X2JhY2tsaWdodF9taW5fdmJ0KGNvbm5lY3Rvcik7Cj4gPiAtCXZhbCA9IF92bHZfZ2V0X2Jh
Y2tsaWdodChkZXZfcHJpdiwgcGlwZSk7Cj4gPiArCXZhbCA9IF92bHZfZ2V0X2JhY2tsaWdodChp
OTE1LCBwaXBlKTsKPiA+ICAgCXZhbCA9IGludGVsX3BhbmVsX2NvbXB1dGVfYnJpZ2h0bmVzcyhj
b25uZWN0b3IsIHZhbCk7Cj4gPiAgIAlwYW5lbC0+YmFja2xpZ2h0LmxldmVsID0gY2xhbXAodmFs
LCBwYW5lbC0+YmFja2xpZ2h0Lm1pbiwKPiA+ICAgCQkJCSAgICAgICBwYW5lbC0+YmFja2xpZ2h0
Lm1heCk7Cj4gPiBAQCAtMTc2MSwxMSArMTc2MSwxMSBAQCBzdGF0aWMgaW50IHZsdl9zZXR1cF9i
YWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUgcGlw
ZQo+ID4gICBzdGF0aWMgaW50Cj4gPiAgIGJ4dF9zZXR1cF9iYWNrbGlnaHQoc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUgdW51c2VkKQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNl
LmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25u
ZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwgPSAmY29u
bmVjdG9yLT5wYW5lbDsKPiA+ICAgCXUzMiBwd21fY3RsLCB2YWw7Cj4gPiAtCXBhbmVsLT5iYWNr
bGlnaHQuY29udHJvbGxlciA9IGRldl9wcml2LT52YnQuYmFja2xpZ2h0LmNvbnRyb2xsZXI7Cj4g
PiArCXBhbmVsLT5iYWNrbGlnaHQuY29udHJvbGxlciA9IGk5MTUtPnZidC5iYWNrbGlnaHQuY29u
dHJvbGxlcjsKPiA+ICAgCXB3bV9jdGwgPSBJOTE1X1JFQUQoQlhUX0JMQ19QV01fQ1RMKHBhbmVs
LT5iYWNrbGlnaHQuY29udHJvbGxlcikpOwo+ID4gQEAgLTE4MDEsNyArMTgwMSw3IEBAIGJ4dF9z
ZXR1cF9iYWNrbGlnaHQoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBp
cGUgdW51c2VkKQo+ID4gICBzdGF0aWMgaW50Cj4gPiAgIGNucF9zZXR1cF9iYWNrbGlnaHQoc3Ry
dWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUgdW51c2VkKQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVj
dG9yLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wYW5lbCAqcGFu
ZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPiA+ICAgCXUzMiBwd21fY3RsLCB2YWw7Cj4gPiBAQCAt
MTg4MSwyOCArMTg4MSwyOCBAQCB2b2lkIGludGVsX3BhbmVsX3VwZGF0ZV9iYWNrbGlnaHQoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkgIGNvbnN0IHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxf
Y29ubmVjdG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29u
bmVjdG9yKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3Bh
bmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+ID4gICAJaWYgKCFwYW5lbC0+YmFja2xp
Z2h0LnByZXNlbnQpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+
YmFja2xpZ2h0X2xvY2spOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5iYWNrbGlnaHRfbG9jayk7
Cj4gPiAgIAlpZiAoIXBhbmVsLT5iYWNrbGlnaHQuZW5hYmxlZCkKPiA+ICAgCQlfX2ludGVsX3Bh
bmVsX2VuYWJsZV9iYWNrbGlnaHQoY3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSk7Cj4gPiAtCW11dGV4
X3VubG9jaygmZGV2X3ByaXYtPmJhY2tsaWdodF9sb2NrKTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZp
OTE1LT5iYWNrbGlnaHRfbG9jayk7Cj4gPiAgIH0KPiA+ICAgaW50IGludGVsX3BhbmVsX3NldHVw
X2JhY2tsaWdodChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBlbnVtIHBpcGUgcGlw
ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3Ig
KmludGVsX2Nvbm5lY3RvciA9IHRvX2ludGVsX2Nvbm5lY3Rvcihjb25uZWN0b3IpOwo+ID4gICAJ
c3RydWN0IGludGVsX3BhbmVsICpwYW5lbCA9ICZpbnRlbF9jb25uZWN0b3ItPnBhbmVsOwo+ID4g
ICAJaW50IHJldDsKPiA+IC0JaWYgKCFkZXZfcHJpdi0+dmJ0LmJhY2tsaWdodC5wcmVzZW50KSB7
Cj4gPiAtCQlpZiAoZGV2X3ByaXYtPnF1aXJrcyAmIFFVSVJLX0JBQ0tMSUdIVF9QUkVTRU5UKSB7
Cj4gPiArCWlmICghaTkxNS0+dmJ0LmJhY2tsaWdodC5wcmVzZW50KSB7Cj4gPiArCQlpZiAoaTkx
NS0+cXVpcmtzICYgUVVJUktfQkFDS0xJR0hUX1BSRVNFTlQpIHsKPiA+ICAgCQkJRFJNX0RFQlVH
X0tNUygibm8gYmFja2xpZ2h0IHByZXNlbnQgcGVyIFZCVCwgYnV0IHByZXNlbnQgcGVyIHF1aXJr
XG4iKTsKPiA+ICAgCQl9IGVsc2Ugewo+ID4gICAJCQlEUk1fREVCVUdfS01TKCJubyBiYWNrbGln
aHQgcHJlc2VudCBwZXIgVkJUXG4iKTsKPiA+IEBAIC0xOTE1LDkgKzE5MTUsOSBAQCBpbnQgaW50
ZWxfcGFuZWxfc2V0dXBfYmFja2xpZ2h0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3Is
IGVudW0gcGlwZSBwaXBlKQo+ID4gICAJCXJldHVybiAtRU5PREVWOwo+ID4gICAJLyogc2V0IGxl
dmVsIGFuZCBtYXggaW4gcGFuZWwgc3RydWN0ICovCj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2
LT5iYWNrbGlnaHRfbG9jayk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmJhY2tsaWdodF9sb2Nr
KTsKPiA+ICAgCXJldCA9IHBhbmVsLT5iYWNrbGlnaHQuc2V0dXAoaW50ZWxfY29ubmVjdG9yLCBw
aXBlKTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+YmFja2xpZ2h0X2xvY2spOwo+ID4g
KwltdXRleF91bmxvY2soJmk5MTUtPmJhY2tsaWdodF9sb2NrKTsKPiA+ICAgCWlmIChyZXQpIHsK
PiA+ICAgCQlEUk1fREVCVUdfS01TKCJmYWlsZWQgdG8gc2V0dXAgYmFja2xpZ2h0IGZvciBjb25u
ZWN0b3IgJXNcbiIsCj4gPiBAQCAtMTk1MCw3ICsxOTUwLDcgQEAgaW50ZWxfcGFuZWxfaW5pdF9i
YWNrbGlnaHRfZnVuY3Moc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCkKPiA+ICAgewo+ID4gICAJ
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0KPiA+ICAgCQljb250YWluZXJfb2Yo
cGFuZWwsIHN0cnVjdCBpbnRlbF9jb25uZWN0b3IsIHBhbmVsKTsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFz
ZS5kZXYpOwo+ID4gICAJaWYgKGNvbm5lY3Rvci0+YmFzZS5jb25uZWN0b3JfdHlwZSA9PSBEUk1f
TU9ERV9DT05ORUNUT1JfZURQICYmCj4gPiAgIAkgICAgaW50ZWxfZHBfYXV4X2luaXRfYmFja2xp
Z2h0X2Z1bmNzKGNvbm5lY3RvcikgPT0gMCkKPiA+IEBAIC0xOTYwLDM4ICsxOTYwLDM4IEBAIGlu
dGVsX3BhbmVsX2luaXRfYmFja2xpZ2h0X2Z1bmNzKHN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwp
Cj4gPiAgIAkgICAgaW50ZWxfZHNpX2Rjc19pbml0X2JhY2tsaWdodF9mdW5jcyhjb25uZWN0b3Ip
ID09IDApCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsK
PiA+ICsJaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiA+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LnNl
dHVwID0gYnh0X3NldHVwX2JhY2tsaWdodDsKPiA+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LmVuYWJs
ZSA9IGJ4dF9lbmFibGVfYmFja2xpZ2h0Owo+ID4gICAJCXBhbmVsLT5iYWNrbGlnaHQuZGlzYWJs
ZSA9IGJ4dF9kaXNhYmxlX2JhY2tsaWdodDsKPiA+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LnNldCA9
IGJ4dF9zZXRfYmFja2xpZ2h0Owo+ID4gICAJCXBhbmVsLT5iYWNrbGlnaHQuZ2V0ID0gYnh0X2dl
dF9iYWNrbGlnaHQ7Cj4gPiAgIAkJcGFuZWwtPmJhY2tsaWdodC5oel90b19wd20gPSBieHRfaHpf
dG9fcHdtOwo+ID4gLQl9IGVsc2UgaWYgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA+PSBQQ0hf
Q05QKSB7Cj4gPiArCX0gZWxzZSBpZiAoSU5URUxfUENIX1RZUEUoaTkxNSkgPj0gUENIX0NOUCkg
ewo+ID4gICAJCXBhbmVsLT5iYWNrbGlnaHQuc2V0dXAgPSBjbnBfc2V0dXBfYmFja2xpZ2h0Owo+
ID4gICAJCXBhbmVsLT5iYWNrbGlnaHQuZW5hYmxlID0gY25wX2VuYWJsZV9iYWNrbGlnaHQ7Cj4g
PiAgIAkJcGFuZWwtPmJhY2tsaWdodC5kaXNhYmxlID0gY25wX2Rpc2FibGVfYmFja2xpZ2h0Owo+
ID4gICAJCXBhbmVsLT5iYWNrbGlnaHQuc2V0ID0gYnh0X3NldF9iYWNrbGlnaHQ7Cj4gPiAgIAkJ
cGFuZWwtPmJhY2tsaWdodC5nZXQgPSBieHRfZ2V0X2JhY2tsaWdodDsKPiA+ICAgCQlwYW5lbC0+
YmFja2xpZ2h0Lmh6X3RvX3B3bSA9IGNucF9oel90b19wd207Cj4gPiAtCX0gZWxzZSBpZiAoSU5U
RUxfUENIX1RZUEUoZGV2X3ByaXYpID49IFBDSF9MUFQpIHsKPiA+ICsJfSBlbHNlIGlmIChJTlRF
TF9QQ0hfVFlQRShpOTE1KSA+PSBQQ0hfTFBUKSB7Cj4gPiAgIAkJcGFuZWwtPmJhY2tsaWdodC5z
ZXR1cCA9IGxwdF9zZXR1cF9iYWNrbGlnaHQ7Cj4gPiAgIAkJcGFuZWwtPmJhY2tsaWdodC5lbmFi
bGUgPSBscHRfZW5hYmxlX2JhY2tsaWdodDsKPiA+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LmRpc2Fi
bGUgPSBscHRfZGlzYWJsZV9iYWNrbGlnaHQ7Cj4gPiAgIAkJcGFuZWwtPmJhY2tsaWdodC5zZXQg
PSBscHRfc2V0X2JhY2tsaWdodDsKPiA+ICAgCQlwYW5lbC0+YmFja2xpZ2h0LmdldCA9IGxwdF9n
ZXRfYmFja2xpZ2h0Owo+ID4gLQkJaWYgKEhBU19QQ0hfTFBUKGRldl9wcml2KSkKPiA+ICsJCWlm
IChIQVNfUENIX0xQVChpOTE1KSkKPiA+ICAgCQkJcGFuZWwtPmJhY2tsaWdodC5oel90b19wd20g
PSBscHRfaHpfdG9fcHdtOwo+ID4gICAJCWVsc2UKPiA+ICAgCQkJcGFuZWwtPmJhY2tsaWdodC5o
el90b19wd20gPSBzcHRfaHpfdG9fcHdtOwo+ID4gLQl9IGVsc2UgaWYgKEhBU19QQ0hfU1BMSVQo
ZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSEFTX1BDSF9TUExJVChpOTE1KSkgewo+ID4g
ICAJCXBhbmVsLT5iYWNrbGlnaHQuc2V0dXAgPSBwY2hfc2V0dXBfYmFja2xpZ2h0Owo+ID4gICAJ
CXBhbmVsLT5iYWNrbGlnaHQuZW5hYmxlID0gcGNoX2VuYWJsZV9iYWNrbGlnaHQ7Cj4gPiAgIAkJ
cGFuZWwtPmJhY2tsaWdodC5kaXNhYmxlID0gcGNoX2Rpc2FibGVfYmFja2xpZ2h0Owo+ID4gICAJ
CXBhbmVsLT5iYWNrbGlnaHQuc2V0ID0gcGNoX3NldF9iYWNrbGlnaHQ7Cj4gPiAgIAkJcGFuZWwt
PmJhY2tsaWdodC5nZXQgPSBwY2hfZ2V0X2JhY2tsaWdodDsKPiA+ICAgCQlwYW5lbC0+YmFja2xp
Z2h0Lmh6X3RvX3B3bSA9IHBjaF9oel90b19wd207Cj4gPiAtCX0gZWxzZSBpZiAoSVNfVkFMTEVZ
VklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNl
IGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+ICAg
CQlpZiAoY29ubmVjdG9yLT5iYXNlLmNvbm5lY3Rvcl90eXBlID09IERSTV9NT0RFX0NPTk5FQ1RP
Ul9EU0kpIHsKPiA+ICAgCQkJcGFuZWwtPmJhY2tsaWdodC5zZXR1cCA9IHB3bV9zZXR1cF9iYWNr
bGlnaHQ7Cj4gPiAgIAkJCXBhbmVsLT5iYWNrbGlnaHQuZW5hYmxlID0gcHdtX2VuYWJsZV9iYWNr
bGlnaHQ7Cj4gPiBAQCAtMjAwNiw3ICsyMDA2LDcgQEAgaW50ZWxfcGFuZWxfaW5pdF9iYWNrbGln
aHRfZnVuY3Moc3RydWN0IGludGVsX3BhbmVsICpwYW5lbCkKPiA+ICAgCQkJcGFuZWwtPmJhY2ts
aWdodC5nZXQgPSB2bHZfZ2V0X2JhY2tsaWdodDsKPiA+ICAgCQkJcGFuZWwtPmJhY2tsaWdodC5o
el90b19wd20gPSB2bHZfaHpfdG9fcHdtOwo+ID4gICAJCX0KPiA+IC0JfSBlbHNlIGlmIChJU19H
RU4oZGV2X3ByaXYsIDQpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDQpKSB7Cj4g
PiAgIAkJcGFuZWwtPmJhY2tsaWdodC5zZXR1cCA9IGk5NjVfc2V0dXBfYmFja2xpZ2h0Owo+ID4g
ICAJCXBhbmVsLT5iYWNrbGlnaHQuZW5hYmxlID0gaTk2NV9lbmFibGVfYmFja2xpZ2h0Owo+ID4g
ICAJCXBhbmVsLT5iYWNrbGlnaHQuZGlzYWJsZSA9IGk5NjVfZGlzYWJsZV9iYWNrbGlnaHQ7Cj4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcGlwZV9jcmMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BpcGVfY3JjLmMKPiA+IGluZGV4IDFlMmM0MzA3ZDA1
YS4uNGE0NDA5ZjQwNzZmIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfcGlwZV9jcmMuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcGlwZV9j
cmMuYwo+ID4gQEAgLTcwLDExICs3MCwxMSBAQCBzdGF0aWMgaW50IGk4eHhfcGlwZV9jcmNfY3Rs
X3JlZyhlbnVtIGludGVsX3BpcGVfY3JjX3NvdXJjZSAqc291cmNlLAo+ID4gICAJcmV0dXJuIDA7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IGk5eHhfcGlwZV9jcmNfYXV0b19zb3VyY2Uoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBpbnQgaTl4eF9waXBlX2Ny
Y19hdXRvX3NvdXJjZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAg
ICAgZW51bSBwaXBlIHBpcGUsCj4gPiAgIAkJCQkgICAgIGVudW0gaW50ZWxfcGlwZV9jcmNfc291
cmNlICpzb3VyY2UpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZf
cHJpdi0+ZHJtOwo+ID4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwo+ID4gICAJc3RydWN0IGludGVsX2Ny
dGMgKmNydGM7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydDsKPiA+
IEBAIC0xMjQsNyArMTI0LDcgQEAgc3RhdGljIGludCBpOXh4X3BpcGVfY3JjX2F1dG9fc291cmNl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXJldHVybiByZXQ7Cj4g
PiAgIH0KPiA+IC1zdGF0aWMgaW50IHZsdl9waXBlX2NyY19jdGxfcmVnKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW50IHZsdl9waXBlX2NyY19jdGxfcmVn
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJZW51bSBwaXBlIHBpcGUs
Cj4gPiAgIAkJCQllbnVtIGludGVsX3BpcGVfY3JjX3NvdXJjZSAqc291cmNlLAo+ID4gICAJCQkJ
dTMyICp2YWwpCj4gPiBAQCAtMTMyLDcgKzEzMiw3IEBAIHN0YXRpYyBpbnQgdmx2X3BpcGVfY3Jj
X2N0bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJYm9vbCBu
ZWVkX3N0YWJsZV9zeW1ib2xzID0gZmFsc2U7Cj4gPiAgIAlpZiAoKnNvdXJjZSA9PSBJTlRFTF9Q
SVBFX0NSQ19TT1VSQ0VfQVVUTykgewo+ID4gLQkJaW50IHJldCA9IGk5eHhfcGlwZV9jcmNfYXV0
b19zb3VyY2UoZGV2X3ByaXYsIHBpcGUsIHNvdXJjZSk7Cj4gPiArCQlpbnQgcmV0ID0gaTl4eF9w
aXBlX2NyY19hdXRvX3NvdXJjZShpOTE1LCBwaXBlLCBzb3VyY2UpOwo+ID4gICAJCWlmIChyZXQp
Cj4gPiAgIAkJCXJldHVybiByZXQ7Cj4gPiAgIAl9Cj4gPiBAQCAtMTUwLDcgKzE1MCw3IEBAIHN0
YXRpYyBpbnQgdmx2X3BpcGVfY3JjX2N0bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gICAJCW5lZWRfc3RhYmxlX3N5bWJvbHMgPSB0cnVlOwo+ID4gICAJCWJyZWFr
Owo+ID4gICAJY2FzZSBJTlRFTF9QSVBFX0NSQ19TT1VSQ0VfRFBfRDoKPiA+IC0JCWlmICghSVNf
Q0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiArCQlpZiAoIUlTX0NIRVJSWVZJRVcoaTkxNSkpCj4g
PiAgIAkJCXJldHVybiAtRUlOVkFMOwo+ID4gICAJCSp2YWwgPSBQSVBFX0NSQ19FTkFCTEUgfCBQ
SVBFX0NSQ19TT1VSQ0VfRFBfRF9WTFY7Cj4gPiAgIAkJbmVlZF9zdGFibGVfc3ltYm9scyA9IHRy
dWU7Cj4gPiBAQCAtMTk0LDEzICsxOTQsMTMgQEAgc3RhdGljIGludCB2bHZfcGlwZV9jcmNfY3Rs
X3JlZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXR1cm4gMDsK
PiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQgaTl4eF9waXBlX2NyY19jdGxfcmVnKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW50IGk5eHhfcGlwZV9jcmNfY3Rs
X3JlZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSBlbnVtIHBpcGUg
cGlwZSwKPiA+ICAgCQkJCSBlbnVtIGludGVsX3BpcGVfY3JjX3NvdXJjZSAqc291cmNlLAo+ID4g
ICAJCQkJIHUzMiAqdmFsKQo+ID4gICB7Cj4gPiAgIAlpZiAoKnNvdXJjZSA9PSBJTlRFTF9QSVBF
X0NSQ19TT1VSQ0VfQVVUTykgewo+ID4gLQkJaW50IHJldCA9IGk5eHhfcGlwZV9jcmNfYXV0b19z
b3VyY2UoZGV2X3ByaXYsIHBpcGUsIHNvdXJjZSk7Cj4gPiArCQlpbnQgcmV0ID0gaTl4eF9waXBl
X2NyY19hdXRvX3NvdXJjZShpOTE1LCBwaXBlLCBzb3VyY2UpOwo+ID4gICAJCWlmIChyZXQpCj4g
PiAgIAkJCXJldHVybiByZXQ7Cj4gPiAgIAl9Cj4gPiBAQCAtMjEwLDcgKzIxMCw3IEBAIHN0YXRp
YyBpbnQgaTl4eF9waXBlX2NyY19jdGxfcmVnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICAgCQkqdmFsID0gUElQRV9DUkNfRU5BQkxFIHwgUElQRV9DUkNfU09VUkNFX1BJ
UEVfSTlYWDsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgSU5URUxfUElQRV9DUkNfU09VUkNF
X1RWOgo+ID4gLQkJaWYgKCFTVVBQT1JUU19UVihkZXZfcHJpdikpCj4gPiArCQlpZiAoIVNVUFBP
UlRTX1RWKGk5MTUpKQo+ID4gICAJCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICAgCQkqdmFsID0gUElQ
RV9DUkNfRU5BQkxFIHwgUElQRV9DUkNfU09VUkNFX1RWX1BSRTsKPiA+ICAgCQlicmVhazsKPiA+
IEBAIC0yMzQsNyArMjM0LDcgQEAgc3RhdGljIGludCBpOXh4X3BpcGVfY3JjX2N0bF9yZWcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgdm9pZCB2bHZfdW5kb19waXBlX3NjcmFtYmxlX3Jlc2V0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCB2bHZfdW5kb19waXBlX3Nj
cmFtYmxlX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJCSBl
bnVtIHBpcGUgcGlwZSkKPiA+ICAgewo+ID4gICAJdTMyIHRtcCA9IEk5MTVfUkVBRChQT1JUX0RG
VDJfRzRYKTsKPiA+IEBAIC0yODYsNyArMjg2LDcgQEAgc3RhdGljIGludCBpbGtfcGlwZV9jcmNf
Y3RsX3JlZyhlbnVtIGludGVsX3BpcGVfY3JjX3NvdXJjZSAqc291cmNlLAo+ID4gICBzdGF0aWMg
dm9pZAo+ID4gICBpbnRlbF9jcnRjX2NyY19zZXR1cF93b3JrYXJvdW5kcyhzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywgYm9vbCBlbmFibGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWc7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2F0
b21pY19zdGF0ZSAqc3RhdGU7Cj4gPiAgIAlzdHJ1Y3QgZHJtX21vZGVzZXRfYWNxdWlyZV9jdHgg
Y3R4Owo+ID4gQEAgLTI5NCw3ICsyOTQsNyBAQCBpbnRlbF9jcnRjX2NyY19zZXR1cF93b3JrYXJv
dW5kcyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywgYm9vbCBlbmFibGUpCj4gPiAgIAlkcm1fbW9k
ZXNldF9hY3F1aXJlX2luaXQoJmN0eCwgMCk7Cj4gPiAtCXN0YXRlID0gZHJtX2F0b21pY19zdGF0
ZV9hbGxvYygmZGV2X3ByaXYtPmRybSk7Cj4gPiArCXN0YXRlID0gZHJtX2F0b21pY19zdGF0ZV9h
bGxvYygmaTkxNS0+ZHJtKTsKPiA+ICAgCWlmICghc3RhdGUpIHsKPiA+ICAgCQlyZXQgPSAtRU5P
TUVNOwo+ID4gICAJCWdvdG8gdW5sb2NrOwo+ID4gQEAgLTMxMiw3ICszMTIsNyBAQCBpbnRlbF9j
cnRjX2NyY19zZXR1cF93b3JrYXJvdW5kcyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywgYm9vbCBl
bmFibGUpCj4gPiAgIAlwaXBlX2NvbmZpZy0+YmFzZS5tb2RlX2NoYW5nZWQgPSBwaXBlX2NvbmZp
Zy0+aGFzX3BzcjsKPiA+ICAgCXBpcGVfY29uZmlnLT5jcmNfZW5hYmxlZCA9IGVuYWJsZTsKPiA+
IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpICYmCj4gPiArCWlmIChJU19IQVNXRUxMKGk5MTUp
ICYmCj4gPiAgIAkgICAgcGlwZV9jb25maWctPmJhc2UuYWN0aXZlICYmIGNydGMtPnBpcGUgPT0g
UElQRV9BICYmCj4gPiAgIAkgICAgcGlwZV9jb25maWctPmNwdV90cmFuc2NvZGVyID09IFRSQU5T
Q09ERVJfRURQKQo+ID4gICAJCXBpcGVfY29uZmlnLT5iYXNlLm1vZGVfY2hhbmdlZCA9IHRydWU7
Cj4gPiBAQCAtMzMzLDcgKzMzMyw3IEBAIGludGVsX2NydGNfY3JjX3NldHVwX3dvcmthcm91bmRz
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLCBib29sIGVuYWJsZSkKPiA+ICAgCWRybV9tb2Rlc2V0
X2FjcXVpcmVfZmluaSgmY3R4KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQgaXZiX3BpcGVfY3Jj
X2N0bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBp
bnQgaXZiX3BpcGVfY3JjX2N0bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgIAkJCQllbnVtIHBpcGUgcGlwZSwKPiA+ICAgCQkJCWVudW0gaW50ZWxfcGlwZV9jcmNfc291
cmNlICpzb3VyY2UsCj4gPiAgIAkJCQl1MzIgKnZhbCkKPiA+IEBAIC0zNjEsNyArMzYxLDcgQEAg
c3RhdGljIGludCBpdmJfcGlwZV9jcmNfY3RsX3JlZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiAgIAlyZXR1cm4gMDsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQgc2tsX3Bp
cGVfY3JjX2N0bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0
YXRpYyBpbnQgc2tsX3BpcGVfY3JjX2N0bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJCQllbnVtIHBpcGUgcGlwZSwKPiA+ICAgCQkJCWVudW0gaW50ZWxfcGlwZV9j
cmNfc291cmNlICpzb3VyY2UsCj4gPiAgIAkJCQl1MzIgKnZhbCkKPiA+IEBAIC00MDQsMjIgKzQw
NCwyMiBAQCBzdGF0aWMgaW50IHNrbF9waXBlX2NyY19jdGxfcmVnKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiAtc3RhdGljIGlu
dCBnZXRfbmV3X2NyY19jdGxfcmVnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
PiA+ICtzdGF0aWMgaW50IGdldF9uZXdfY3JjX2N0bF9yZWcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgICBlbnVtIHBpcGUgcGlwZSwKPiA+ICAgCQkJICAgICAg
IGVudW0gaW50ZWxfcGlwZV9jcmNfc291cmNlICpzb3VyY2UsIHUzMiAqdmFsKQo+ID4gICB7Cj4g
PiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKQo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDIpKQo+
ID4gICAJCXJldHVybiBpOHh4X3BpcGVfY3JjX2N0bF9yZWcoc291cmNlLCB2YWwpOwo+ID4gLQll
bHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNSkKPiA+IC0JCXJldHVybiBpOXh4X3BpcGVf
Y3JjX2N0bF9yZWcoZGV2X3ByaXYsIHBpcGUsIHNvdXJjZSwgdmFsKTsKPiA+IC0JZWxzZSBpZiAo
SVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiAt
CQlyZXR1cm4gdmx2X3BpcGVfY3JjX2N0bF9yZWcoZGV2X3ByaXYsIHBpcGUsIHNvdXJjZSwgdmFs
KTsKPiA+IC0JZWxzZSBpZiAoSVNfR0VOX1JBTkdFKGRldl9wcml2LCA1LCA2KSkKPiA+ICsJZWxz
ZSBpZiAoSU5URUxfR0VOKGk5MTUpIDwgNSkKPiA+ICsJCXJldHVybiBpOXh4X3BpcGVfY3JjX2N0
bF9yZWcoaTkxNSwgcGlwZSwgc291cmNlLCB2YWwpOwo+ID4gKwllbHNlIGlmIChJU19WQUxMRVlW
SUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiArCQlyZXR1cm4gdmx2X3BpcGVf
Y3JjX2N0bF9yZWcoaTkxNSwgcGlwZSwgc291cmNlLCB2YWwpOwo+ID4gKwllbHNlIGlmIChJU19H
RU5fUkFOR0UoaTkxNSwgNSwgNikpCj4gPiAgIAkJcmV0dXJuIGlsa19waXBlX2NyY19jdGxfcmVn
KHNvdXJjZSwgdmFsKTsKPiA+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDkpCj4g
PiAtCQlyZXR1cm4gaXZiX3BpcGVfY3JjX2N0bF9yZWcoZGV2X3ByaXYsIHBpcGUsIHNvdXJjZSwg
dmFsKTsKPiA+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpIDwgOSkKPiA+ICsJCXJldHVybiBp
dmJfcGlwZV9jcmNfY3RsX3JlZyhpOTE1LCBwaXBlLCBzb3VyY2UsIHZhbCk7Cj4gPiAgIAllbHNl
Cj4gPiAtCQlyZXR1cm4gc2tsX3BpcGVfY3JjX2N0bF9yZWcoZGV2X3ByaXYsIHBpcGUsIHNvdXJj
ZSwgdmFsKTsKPiA+ICsJCXJldHVybiBza2xfcGlwZV9jcmNfY3RsX3JlZyhpOTE1LCBwaXBlLCBz
b3VyY2UsIHZhbCk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGludAo+ID4gQEAgLTQ0MCwxOCArNDQw
LDE4IEBAIGRpc3BsYXlfY3JjX2N0bF9wYXJzZV9zb3VyY2UoY29uc3QgY2hhciAqYnVmLCBlbnVt
IGludGVsX3BpcGVfY3JjX3NvdXJjZSAqcykKPiA+ICAgCXJldHVybiAwOwo+ID4gICB9Cj4gPiAt
dm9pZCBpbnRlbF9kaXNwbGF5X2NyY19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICt2b2lkIGludGVsX2Rpc3BsYXlfY3JjX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWVudW0gcGlwZSBwaXBlOwo+ID4gLQlmb3JfZWFj
aF9waXBlKGRldl9wcml2LCBwaXBlKSB7Cj4gPiAtCQlzdHJ1Y3QgaW50ZWxfcGlwZV9jcmMgKnBp
cGVfY3JjID0gJmRldl9wcml2LT5waXBlX2NyY1twaXBlXTsKPiA+ICsJZm9yX2VhY2hfcGlwZShp
OTE1LCBwaXBlKSB7Cj4gPiArCQlzdHJ1Y3QgaW50ZWxfcGlwZV9jcmMgKnBpcGVfY3JjID0gJmk5
MTUtPnBpcGVfY3JjW3BpcGVdOwo+ID4gICAJCXNwaW5fbG9ja19pbml0KCZwaXBlX2NyYy0+bG9j
ayk7Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IGk4eHhfY3JjX3NvdXJjZV92YWxp
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGludCBpOHh4
X2NyY19zb3VyY2VfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJ
CQkgY29uc3QgZW51bSBpbnRlbF9waXBlX2NyY19zb3VyY2Ugc291cmNlKQo+ID4gICB7Cj4gPiAg
IAlzd2l0Y2ggKHNvdXJjZSkgewo+ID4gQEAgLTQ2Myw3ICs0NjMsNyBAQCBzdGF0aWMgaW50IGk4
eHhfY3JjX3NvdXJjZV92YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IGk5eHhfY3JjX3NvdXJjZV92YWxpZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGludCBpOXh4X2NyY19z
b3VyY2VfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgY29u
c3QgZW51bSBpbnRlbF9waXBlX2NyY19zb3VyY2Ugc291cmNlKQo+ID4gICB7Cj4gPiAgIAlzd2l0
Y2ggKHNvdXJjZSkgewo+ID4gQEAgLTQ3Niw3ICs0NzYsNyBAQCBzdGF0aWMgaW50IGk5eHhfY3Jj
X3NvdXJjZV92YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAl9
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IHZsdl9jcmNfc291cmNlX3ZhbGlkKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW50IHZsdl9jcmNfc291cmNlX3Zh
bGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJY29uc3QgZW51bSBp
bnRlbF9waXBlX2NyY19zb3VyY2Ugc291cmNlKQo+ID4gICB7Cj4gPiAgIAlzd2l0Y2ggKHNvdXJj
ZSkgewo+ID4gQEAgLTQ5MSw3ICs0OTEsNyBAQCBzdGF0aWMgaW50IHZsdl9jcmNfc291cmNlX3Zh
bGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCX0KPiA+ICAgfQo+
ID4gLXN0YXRpYyBpbnQgaWxrX2NyY19zb3VyY2VfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBpbnQgaWxrX2NyY19zb3VyY2VfdmFsaWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQljb25zdCBlbnVtIGludGVsX3BpcGVf
Y3JjX3NvdXJjZSBzb3VyY2UpCj4gPiAgIHsKPiA+ICAgCXN3aXRjaCAoc291cmNlKSB7Cj4gPiBA
QCAtNTA1LDcgKzUwNSw3IEBAIHN0YXRpYyBpbnQgaWxrX2NyY19zb3VyY2VfdmFsaWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJfQo+ID4gICB9Cj4gPiAtc3RhdGlj
IGludCBpdmJfY3JjX3NvdXJjZV92YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiArc3RhdGljIGludCBpdmJfY3JjX3NvdXJjZV92YWxpZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCWNvbnN0IGVudW0gaW50ZWxfcGlwZV9jcmNfc291cmNl
IHNvdXJjZSkKPiA+ICAgewo+ID4gICAJc3dpdGNoIChzb3VyY2UpIHsKPiA+IEBAIC01MTksNyAr
NTE5LDcgQEAgc3RhdGljIGludCBpdmJfY3JjX3NvdXJjZV92YWxpZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IHNrbF9j
cmNfc291cmNlX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtz
dGF0aWMgaW50IHNrbF9jcmNfc291cmNlX3ZhbGlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAo+ID4gICAJCQkJY29uc3QgZW51bSBpbnRlbF9waXBlX2NyY19zb3VyY2Ugc291cmNlKQo+
ID4gICB7Cj4gPiAgIAlzd2l0Y2ggKHNvdXJjZSkgewo+ID4gQEAgLTUzOSwyMSArNTM5LDIxIEBA
IHN0YXRpYyBpbnQgc2tsX2NyY19zb3VyY2VfdmFsaWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQKPiA+IC1pbnRlbF9pc192YWxpZF9j
cmNfc291cmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpbnRlbF9p
c192YWxpZF9jcmNfc291cmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJ
CQkgIGNvbnN0IGVudW0gaW50ZWxfcGlwZV9jcmNfc291cmNlIHNvdXJjZSkKPiA+ICAgewo+ID4g
LQlpZiAoSVNfR0VOKGRldl9wcml2LCAyKSkKPiA+IC0JCXJldHVybiBpOHh4X2NyY19zb3VyY2Vf
dmFsaWQoZGV2X3ByaXYsIHNvdXJjZSk7Cj4gPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPCA1KQo+ID4gLQkJcmV0dXJuIGk5eHhfY3JjX3NvdXJjZV92YWxpZChkZXZfcHJpdiwgc291
cmNlKTsKPiA+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZ
VklFVyhkZXZfcHJpdikpCj4gPiAtCQlyZXR1cm4gdmx2X2NyY19zb3VyY2VfdmFsaWQoZGV2X3By
aXYsIHNvdXJjZSk7Cj4gPiAtCWVsc2UgaWYgKElTX0dFTl9SQU5HRShkZXZfcHJpdiwgNSwgNikp
Cj4gPiAtCQlyZXR1cm4gaWxrX2NyY19zb3VyY2VfdmFsaWQoZGV2X3ByaXYsIHNvdXJjZSk7Cj4g
PiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA5KQo+ID4gLQkJcmV0dXJuIGl2Yl9j
cmNfc291cmNlX3ZhbGlkKGRldl9wcml2LCBzb3VyY2UpOwo+ID4gKwlpZiAoSVNfR0VOKGk5MTUs
IDIpKQo+ID4gKwkJcmV0dXJuIGk4eHhfY3JjX3NvdXJjZV92YWxpZChpOTE1LCBzb3VyY2UpOwo+
ID4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPCA1KQo+ID4gKwkJcmV0dXJuIGk5eHhfY3Jj
X3NvdXJjZV92YWxpZChpOTE1LCBzb3VyY2UpOwo+ID4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVX
KGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiArCQlyZXR1cm4gdmx2X2NyY19zb3Vy
Y2VfdmFsaWQoaTkxNSwgc291cmNlKTsKPiA+ICsJZWxzZSBpZiAoSVNfR0VOX1JBTkdFKGk5MTUs
IDUsIDYpKQo+ID4gKwkJcmV0dXJuIGlsa19jcmNfc291cmNlX3ZhbGlkKGk5MTUsIHNvdXJjZSk7
Cj4gPiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA8IDkpCj4gPiArCQlyZXR1cm4gaXZiX2Ny
Y19zb3VyY2VfdmFsaWQoaTkxNSwgc291cmNlKTsKPiA+ICAgCWVsc2UKPiA+IC0JCXJldHVybiBz
a2xfY3JjX3NvdXJjZV92YWxpZChkZXZfcHJpdiwgc291cmNlKTsKPiA+ICsJCXJldHVybiBza2xf
Y3JjX3NvdXJjZV92YWxpZChpOTE1LCBzb3VyY2UpOwo+ID4gICB9Cj4gPiAgIGNvbnN0IGNoYXIg
KmNvbnN0ICppbnRlbF9jcnRjX2dldF9jcmNfc291cmNlcyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMs
Cj4gPiBAQCAtNTY2LDcgKzU2Niw3IEBAIGNvbnN0IGNoYXIgKmNvbnN0ICppbnRlbF9jcnRjX2dl
dF9jcmNfc291cmNlcyhzdHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gPiAgIGludCBpbnRlbF9jcnRj
X3ZlcmlmeV9jcmNfc291cmNlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywgY29uc3QgY2hhciAqc291
cmNlX25hbWUsCj4gPiAgIAkJCQkgc2l6ZV90ICp2YWx1ZXNfY250KQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiA+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmRldik7Cj4g
PiAgIAllbnVtIGludGVsX3BpcGVfY3JjX3NvdXJjZSBzb3VyY2U7Cj4gPiAgIAlpZiAoZGlzcGxh
eV9jcmNfY3RsX3BhcnNlX3NvdXJjZShzb3VyY2VfbmFtZSwgJnNvdXJjZSkgPCAwKSB7Cj4gPiBA
QCAtNTc1LDcgKzU3NSw3IEBAIGludCBpbnRlbF9jcnRjX3ZlcmlmeV9jcmNfc291cmNlKHN0cnVj
dCBkcm1fY3J0YyAqY3J0YywgY29uc3QgY2hhciAqc291cmNlX25hbWUsCj4gPiAgIAl9Cj4gPiAg
IAlpZiAoc291cmNlID09IElOVEVMX1BJUEVfQ1JDX1NPVVJDRV9BVVRPIHx8Cj4gPiAtCSAgICBp
bnRlbF9pc192YWxpZF9jcmNfc291cmNlKGRldl9wcml2LCBzb3VyY2UpID09IDApIHsKPiA+ICsJ
ICAgIGludGVsX2lzX3ZhbGlkX2NyY19zb3VyY2UoaTkxNSwgc291cmNlKSA9PSAwKSB7Cj4gPiAg
IAkJKnZhbHVlc19jbnQgPSA1Owo+ID4gICAJCXJldHVybiAwOwo+ID4gICAJfQo+ID4gQEAgLTU4
NSw4ICs1ODUsOCBAQCBpbnQgaW50ZWxfY3J0Y192ZXJpZnlfY3JjX3NvdXJjZShzdHJ1Y3QgZHJt
X2NydGMgKmNydGMsIGNvbnN0IGNoYXIgKnNvdXJjZV9uYW1lLAo+ID4gICBpbnQgaW50ZWxfY3J0
Y19zZXRfY3JjX3NvdXJjZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIGNvbnN0IGNoYXIgKnNvdXJj
ZV9uYW1lKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiA+IC0Jc3RydWN0IGludGVsX3BpcGVfY3JjICpwaXBlX2Ny
YyA9ICZkZXZfcHJpdi0+cGlwZV9jcmNbY3J0Yy0+aW5kZXhdOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiA+ICsJc3RydWN0IGludGVs
X3BpcGVfY3JjICpwaXBlX2NyYyA9ICZpOTE1LT5waXBlX2NyY1tjcnRjLT5pbmRleF07Cj4gPiAg
IAllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIHBvd2VyX2RvbWFpbjsKPiA+ICAgCWVu
dW0gaW50ZWxfcGlwZV9jcmNfc291cmNlIHNvdXJjZTsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3
YWtlcmVmOwo+ID4gQEAgLTYwMCw3ICs2MDAsNyBAQCBpbnQgaW50ZWxfY3J0Y19zZXRfY3JjX3Nv
dXJjZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIGNvbnN0IGNoYXIgKnNvdXJjZV9uYW1lKQo+ID4g
ICAJfQo+ID4gICAJcG93ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1BJUEUoY3J0Yy0+aW5kZXgp
Owo+ID4gLQl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZf
cHJpdiwgcG93ZXJfZG9tYWluKTsKPiA+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJf
Z2V0X2lmX2VuYWJsZWQoaTkxNSwgcG93ZXJfZG9tYWluKTsKPiA+ICAgCWlmICghd2FrZXJlZikg
ewo+ID4gICAJCURSTV9ERUJVR19LTVMoIlRyeWluZyB0byBjYXB0dXJlIENSQyB3aGlsZSBwaXBl
IGlzIG9mZlxuIik7Cj4gPiAgIAkJcmV0dXJuIC1FSU87Cj4gPiBAQCAtNjEwLDcgKzYxMCw3IEBA
IGludCBpbnRlbF9jcnRjX3NldF9jcmNfc291cmNlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywgY29u
c3QgY2hhciAqc291cmNlX25hbWUpCj4gPiAgIAlpZiAoZW5hYmxlKQo+ID4gICAJCWludGVsX2Ny
dGNfY3JjX3NldHVwX3dvcmthcm91bmRzKHRvX2ludGVsX2NydGMoY3J0YyksIHRydWUpOwo+ID4g
LQlyZXQgPSBnZXRfbmV3X2NyY19jdGxfcmVnKGRldl9wcml2LCBjcnRjLT5pbmRleCwgJnNvdXJj
ZSwgJnZhbCk7Cj4gPiArCXJldCA9IGdldF9uZXdfY3JjX2N0bF9yZWcoaTkxNSwgY3J0Yy0+aW5k
ZXgsICZzb3VyY2UsICZ2YWwpOwo+ID4gICAJaWYgKHJldCAhPSAwKQo+ID4gICAJCWdvdG8gb3V0
Owo+ID4gQEAgLTYxOSw4ICs2MTksOCBAQCBpbnQgaW50ZWxfY3J0Y19zZXRfY3JjX3NvdXJjZShz
dHJ1Y3QgZHJtX2NydGMgKmNydGMsIGNvbnN0IGNoYXIgKnNvdXJjZV9uYW1lKQo+ID4gICAJUE9T
VElOR19SRUFEKFBJUEVfQ1JDX0NUTChjcnRjLT5pbmRleCkpOwo+ID4gICAJaWYgKCFzb3VyY2Up
IHsKPiA+IC0JCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRl
dl9wcml2KSkKPiA+IC0JCQl2bHZfdW5kb19waXBlX3NjcmFtYmxlX3Jlc2V0KGRldl9wcml2LCBj
cnRjLT5pbmRleCk7Cj4gPiArCQlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllW
SUVXKGk5MTUpKQo+ID4gKwkJCXZsdl91bmRvX3BpcGVfc2NyYW1ibGVfcmVzZXQoaTkxNSwgY3J0
Yy0+aW5kZXgpOwo+ID4gICAJfQo+ID4gICAJcGlwZV9jcmMtPnNraXBwZWQgPSAwOwo+ID4gQEAg
LTYyOSw3ICs2MjksNyBAQCBpbnQgaW50ZWxfY3J0Y19zZXRfY3JjX3NvdXJjZShzdHJ1Y3QgZHJt
X2NydGMgKmNydGMsIGNvbnN0IGNoYXIgKnNvdXJjZV9uYW1lKQo+ID4gICAJaWYgKCFlbmFibGUp
Cj4gPiAgIAkJaW50ZWxfY3J0Y19jcmNfc2V0dXBfd29ya2Fyb3VuZHModG9faW50ZWxfY3J0Yyhj
cnRjKSwgZmFsc2UpOwo+ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgcG93
ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiA+ICsJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoaTkxNSwg
cG93ZXJfZG9tYWluLCB3YWtlcmVmKTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IEBA
IC02MzcsMTQgKzYzNywxNCBAQCBpbnQgaW50ZWxfY3J0Y19zZXRfY3JjX3NvdXJjZShzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGMsIGNvbnN0IGNoYXIgKnNvdXJjZV9uYW1lKQo+ID4gICB2b2lkIGludGVs
X2NydGNfZW5hYmxlX3BpcGVfY3JjKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjKQo+ID4g
ICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAmaW50ZWxfY3J0Yy0+YmFzZTsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5kZXYp
Owo+ID4gLQlzdHJ1Y3QgaW50ZWxfcGlwZV9jcmMgKnBpcGVfY3JjID0gJmRldl9wcml2LT5waXBl
X2NyY1tjcnRjLT5pbmRleF07Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShjcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcGlwZV9jcmMgKnBpcGVfY3Jj
ID0gJmk5MTUtPnBpcGVfY3JjW2NydGMtPmluZGV4XTsKPiA+ICAgCXUzMiB2YWwgPSAwOwo+ID4g
ICAJaWYgKCFjcnRjLT5jcmMub3BlbmVkKQo+ID4gICAJCXJldHVybjsKPiA+IC0JaWYgKGdldF9u
ZXdfY3JjX2N0bF9yZWcoZGV2X3ByaXYsIGNydGMtPmluZGV4LCAmcGlwZV9jcmMtPnNvdXJjZSwg
JnZhbCkgPCAwKQo+ID4gKwlpZiAoZ2V0X25ld19jcmNfY3RsX3JlZyhpOTE1LCBjcnRjLT5pbmRl
eCwgJnBpcGVfY3JjLT5zb3VyY2UsICZ2YWwpIDwgMCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAkv
KiBEb24ndCBuZWVkIHBpcGVfY3JjLT5sb2NrIGhlcmUsIElSUXMgYXJlIG5vdCBnZW5lcmF0ZWQu
ICovCj4gPiBAQCAtNjU3LDggKzY1Nyw4IEBAIHZvaWQgaW50ZWxfY3J0Y19lbmFibGVfcGlwZV9j
cmMoc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMpCj4gPiAgIHZvaWQgaW50ZWxfY3J0Y19k
aXNhYmxlX3BpcGVfY3JjKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjKQo+ID4gICB7Cj4g
PiAgIAlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAmaW50ZWxfY3J0Yy0+YmFzZTsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+ID4g
LQlzdHJ1Y3QgaW50ZWxfcGlwZV9jcmMgKnBpcGVfY3JjID0gJmRldl9wcml2LT5waXBlX2NyY1tj
cnRjLT5pbmRleF07Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShjcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcGlwZV9jcmMgKnBpcGVfY3JjID0gJmk5
MTUtPnBpcGVfY3JjW2NydGMtPmluZGV4XTsKPiA+ICAgCS8qIFN3YWxsb3cgY3JjJ3MgdW50aWwg
d2Ugc3RvcCBnZW5lcmF0aW5nIHRoZW0uICovCj4gPiAgIAlzcGluX2xvY2tfaXJxKCZwaXBlX2Ny
Yy0+bG9jayk7Cj4gPiBAQCAtNjY3LDUgKzY2Nyw1IEBAIHZvaWQgaW50ZWxfY3J0Y19kaXNhYmxl
X3BpcGVfY3JjKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjKQo+ID4gICAJSTkxNV9XUklU
RShQSVBFX0NSQ19DVEwoY3J0Yy0+aW5kZXgpLCAwKTsKPiA+ICAgCVBPU1RJTkdfUkVBRChQSVBF
X0NSQ19DVEwoY3J0Yy0+aW5kZXgpKTsKPiA+IC0Jc3luY2hyb25pemVfaXJxKGRldl9wcml2LT5k
cm0uaXJxKTsKPiA+ICsJc3luY2hyb25pemVfaXJxKGk5MTUtPmRybS5pcnEpOwo+ID4gICB9Cj4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcGlwZV9jcmMuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BpcGVfY3JjLmgKPiA+IGluZGV4IGRiMjU4YTc1NmZj
Ni4uNDIwNDhhYjEzOTFhIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfcGlwZV9jcmMuaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcGlwZV9j
cmMuaAo+ID4gQEAgLTEzLDcgKzEzLDcgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7Cj4gPiAg
IHN0cnVjdCBpbnRlbF9jcnRjOwo+ID4gICAjaWZkZWYgQ09ORklHX0RFQlVHX0ZTCj4gPiAtdm9p
ZCBpbnRlbF9kaXNwbGF5X2NyY19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dik7Cj4gPiArdm9pZCBpbnRlbF9kaXNwbGF5X2NyY19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiA+ICAgaW50IGludGVsX2NydGNfc2V0X2NyY19zb3VyY2Uoc3RydWN0IGRy
bV9jcnRjICpjcnRjLCBjb25zdCBjaGFyICpzb3VyY2VfbmFtZSk7Cj4gPiAgIGludCBpbnRlbF9j
cnRjX3ZlcmlmeV9jcmNfc291cmNlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKPiA+ICAgCQkJCSBj
b25zdCBjaGFyICpzb3VyY2VfbmFtZSwgc2l6ZV90ICp2YWx1ZXNfY250KTsKPiA+IEBAIC0yMiw3
ICsyMiw3IEBAIGNvbnN0IGNoYXIgKmNvbnN0ICppbnRlbF9jcnRjX2dldF9jcmNfc291cmNlcyhz
dHJ1Y3QgZHJtX2NydGMgKmNydGMsCj4gPiAgIHZvaWQgaW50ZWxfY3J0Y19kaXNhYmxlX3BpcGVf
Y3JjKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKTsKPiA+ICAgdm9pZCBpbnRlbF9jcnRjX2VuYWJs
ZV9waXBlX2NyYyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0Yyk7Cj4gPiAgICNlbHNlCj4gPiAtc3Rh
dGljIGlubGluZSB2b2lkIGludGVsX2Rpc3BsYXlfY3JjX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KSB7fQo+ID4gK3N0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9kaXNwbGF5
X2NyY19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KSB7fQo+ID4gICAjZGVmaW5l
IGludGVsX2NydGNfc2V0X2NyY19zb3VyY2UgTlVMTAo+ID4gICAjZGVmaW5lIGludGVsX2NydGNf
dmVyaWZ5X2NyY19zb3VyY2UgTlVMTAo+ID4gICAjZGVmaW5lIGludGVsX2NydGNfZ2V0X2NyY19z
b3VyY2VzIE5VTEwKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9w
bS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwo+ID4gaW5kZXggMmM3ZjNlYmMw
MTE3Li40YjkzOTE2MGNkOTUgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9wbS5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCj4gPiBA
QCAtNjMsOSArNjMsOSBAQAo+ID4gICAgKiByZXF1aXJlIGhpZ2hlciBsYXRlbmN5IHRvIHN3aXRj
aCB0byBhbmQgd2FrZSB1cC4KPiA+ICAgICovCj4gPiAtc3RhdGljIHZvaWQgZ2VuOV9pbml0X2Ns
b2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGlj
IHZvaWQgZ2VuOV9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiA+ICAgewo+ID4gLQlpZiAoSEFTX0xMQyhkZXZfcHJpdikpIHsKPiA+ICsJaWYgKEhBU19M
TEMoaTkxNSkpIHsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIFdhQ29tcHJlc3NlZFJlc291cmNlRGlz
cGxheU5ld0hhc2hNb2RlOnNrbCxrYmwKPiA+ICAgCQkgKiBEaXNwbGF5IFdBICMwMzkwOiBza2ws
a2JsCj4gPiBAQCAtOTYsMTYgKzk2LDE2IEBAIHN0YXRpYyB2b2lkIGdlbjlfaW5pdF9jbG9ja19n
YXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJSTkxNV9XUklU
RShJTEtfRFBGQ19DSElDS0VOLCBJOTE1X1JFQUQoSUxLX0RQRkNfQ0hJQ0tFTikgfAo+ID4gICAJ
CSAgIElMS19EUEZDX0RJU0FCTEVfRFVNTVkwKTsKPiA+IC0JaWYgKElTX1NLWUxBS0UoZGV2X3By
aXYpKSB7Cj4gPiArCWlmIChJU19TS1lMQUtFKGk5MTUpKSB7Cj4gPiAgIAkJLyogV2FEaXNhYmxl
RG9wQ2xvY2tHYXRpbmcgKi8KPiA+ICAgCQlJOTE1X1dSSVRFKEdFTjdfTUlTQ0NQQ1RMLCBJOTE1
X1JFQUQoR0VON19NSVNDQ1BDVEwpCj4gPiAgIAkJCSAgICYgfkdFTjdfRE9QX0NMT0NLX0dBVEVf
RU5BQkxFKTsKPiA+ICAgCX0KPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGJ4dF9pbml0X2Nsb2Nr
X2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZv
aWQgYnh0X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAtCWdlbjlfaW5pdF9jbG9ja19nYXRpbmcoZGV2X3ByaXYpOwo+ID4gKwlnZW45
X2luaXRfY2xvY2tfZ2F0aW5nKGk5MTUpOwo+ID4gICAJLyogV2FEaXNhYmxlU0RFVW5pdENsb2Nr
R2F0aW5nOmJ4dCAqLwo+ID4gICAJSTkxNV9XUklURShHRU44X1VDR0NUTDYsIEk5MTVfUkVBRChH
RU44X1VDR0NUTDYpIHwKPiA+IEBAIC0xMjYsOSArMTI2LDkgQEAgc3RhdGljIHZvaWQgYnh0X2lu
aXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAg
CQkgICBQV00xX0dBVElOR19ESVMgfCBQV00yX0dBVElOR19ESVMpOwo+ID4gICB9Cj4gPiAtc3Rh
dGljIHZvaWQgZ2xrX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnbGtfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JZ2VuOV9pbml0X2Nsb2NrX2dhdGlu
ZyhkZXZfcHJpdik7Cj4gPiArCWdlbjlfaW5pdF9jbG9ja19nYXRpbmcoaTkxNSk7Cj4gPiAgIAkv
Kgo+ID4gICAJICogV2FEaXNhYmxlUFdNQ2xvY2tHYXRpbmc6Z2xrCj4gPiBAQCAtMTM5LDcgKzEz
OSw3IEBAIHN0YXRpYyB2b2lkIGdsa19pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICAgUFdNMV9HQVRJTkdfRElTIHwgUFdNMl9HQVRJ
TkdfRElTKTsKPiA+ICAgCS8qIFdhRERJSU9UaW1lb3V0OmdsayAqLwo+ID4gLQlpZiAoSVNfR0xL
X1JFVklEKGRldl9wcml2LCAwLCBHTEtfUkVWSURfQTEpKSB7Cj4gPiArCWlmIChJU19HTEtfUkVW
SUQoaTkxNSwgMCwgR0xLX1JFVklEX0ExKSkgewo+ID4gICAJCXUzMiB2YWwgPSBJOTE1X1JFQUQo
Q0hJQ0tFTl9NSVNDXzIpOwo+ID4gICAJCXZhbCAmPSB+KEdMS19DTDBfUFdSX0RPV04gfAo+ID4g
ICAJCQkgR0xLX0NMMV9QV1JfRE9XTiB8Cj4gPiBAQCAtMTQ5LDcgKzE0OSw3IEBAIHN0YXRpYyB2
b2lkIGdsa19pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpOTE1X3BpbmV2aWV3X2dldF9tZW1fZnJlcShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaTkxNV9w
aW5ldmlld19nZXRfbWVtX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAg
IHsKPiA+ICAgCXUzMiB0bXA7Cj4gPiBAQCAtMTU3LDEwMCArMTU3LDEwMCBAQCBzdGF0aWMgdm9p
ZCBpOTE1X3BpbmV2aWV3X2dldF9tZW1fZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiAgIAlzd2l0Y2ggKHRtcCAmIENMS0NGR19GU0JfTUFTSykgewo+ID4gICAJY2Fz
ZSBDTEtDRkdfRlNCXzUzMzoKPiA+IC0JCWRldl9wcml2LT5mc2JfZnJlcSA9IDUzMzsgLyogMTMz
KjQgKi8KPiA+ICsJCWk5MTUtPmZzYl9mcmVxID0gNTMzOyAvKiAxMzMqNCAqLwo+ID4gICAJCWJy
ZWFrOwo+ID4gICAJY2FzZSBDTEtDRkdfRlNCXzgwMDoKPiA+IC0JCWRldl9wcml2LT5mc2JfZnJl
cSA9IDgwMDsgLyogMjAwKjQgKi8KPiA+ICsJCWk5MTUtPmZzYl9mcmVxID0gODAwOyAvKiAyMDAq
NCAqLwo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSBDTEtDRkdfRlNCXzY2NzoKPiA+IC0JCWRl
dl9wcml2LT5mc2JfZnJlcSA9ICA2Njc7IC8qIDE2Nyo0ICovCj4gPiArCQlpOTE1LT5mc2JfZnJl
cSA9ICA2Njc7IC8qIDE2Nyo0ICovCj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIENMS0NGR19G
U0JfNDAwOgo+ID4gLQkJZGV2X3ByaXYtPmZzYl9mcmVxID0gNDAwOyAvKiAxMDAqNCAqLwo+ID4g
KwkJaTkxNS0+ZnNiX2ZyZXEgPSA0MDA7IC8qIDEwMCo0ICovCj4gPiAgIAkJYnJlYWs7Cj4gPiAg
IAl9Cj4gPiAgIAlzd2l0Y2ggKHRtcCAmIENMS0NGR19NRU1fTUFTSykgewo+ID4gICAJY2FzZSBD
TEtDRkdfTUVNXzUzMzoKPiA+IC0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDUzMzsKPiA+ICsJCWk5
MTUtPm1lbV9mcmVxID0gNTMzOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSBDTEtDRkdfTUVN
XzY2NzoKPiA+IC0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDY2NzsKPiA+ICsJCWk5MTUtPm1lbV9m
cmVxID0gNjY3Owo+ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSBDTEtDRkdfTUVNXzgwMDoKPiA+
IC0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDgwMDsKPiA+ICsJCWk5MTUtPm1lbV9mcmVxID0gODAw
Owo+ID4gICAJCWJyZWFrOwo+ID4gICAJfQo+ID4gICAJLyogZGV0ZWN0IHBpbmV2aWV3IEREUjMg
c2V0dGluZyAqLwo+ID4gICAJdG1wID0gSTkxNV9SRUFEKENTSFJERFIzQ1RMKTsKPiA+IC0JZGV2
X3ByaXYtPmlzX2RkcjMgPSAodG1wICYgQ1NIUkREUjNDVExfRERSMykgPyAxIDogMDsKPiA+ICsJ
aTkxNS0+aXNfZGRyMyA9ICh0bXAgJiBDU0hSRERSM0NUTF9ERFIzKSA/IDEgOiAwOwo+ID4gICB9
Cj4gPiAtc3RhdGljIHZvaWQgaTkxNV9pcm9ubGFrZV9nZXRfbWVtX2ZyZXEoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGk5MTVfaXJvbmxha2VfZ2V0
X21lbV9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1
MTYgZGRycGxsLCBjc2lwbGw7Cj4gPiAtCWRkcnBsbCA9IGludGVsX3VuY29yZV9yZWFkMTYoJmRl
dl9wcml2LT51bmNvcmUsIEREUk1QTEwxKTsKPiA+IC0JY3NpcGxsID0gaW50ZWxfdW5jb3JlX3Jl
YWQxNigmZGV2X3ByaXYtPnVuY29yZSwgQ1NJUExMMCk7Cj4gPiArCWRkcnBsbCA9IGludGVsX3Vu
Y29yZV9yZWFkMTYoJmk5MTUtPnVuY29yZSwgRERSTVBMTDEpOwo+ID4gKwljc2lwbGwgPSBpbnRl
bF91bmNvcmVfcmVhZDE2KCZpOTE1LT51bmNvcmUsIENTSVBMTDApOwo+ID4gICAJc3dpdGNoIChk
ZHJwbGwgJiAweGZmKSB7Cj4gPiAgIAljYXNlIDB4YzoKPiA+IC0JCWRldl9wcml2LT5tZW1fZnJl
cSA9IDgwMDsKPiA+ICsJCWk5MTUtPm1lbV9mcmVxID0gODAwOwo+ID4gICAJCWJyZWFrOwo+ID4g
ICAJY2FzZSAweDEwOgo+ID4gLQkJZGV2X3ByaXYtPm1lbV9mcmVxID0gMTA2NjsKPiA+ICsJCWk5
MTUtPm1lbV9mcmVxID0gMTA2NjsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgMHgxNDoKPiA+
IC0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDEzMzM7Cj4gPiArCQlpOTE1LT5tZW1fZnJlcSA9IDEz
MzM7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIDB4MTg6Cj4gPiAtCQlkZXZfcHJpdi0+bWVt
X2ZyZXEgPSAxNjAwOwo+ID4gKwkJaTkxNS0+bWVtX2ZyZXEgPSAxNjAwOwo+ID4gICAJCWJyZWFr
Owo+ID4gICAJZGVmYXVsdDoKPiA+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJ1bmtub3duIG1lbW9y
eSBmcmVxdWVuY3kgMHglMDJ4XG4iLAo+ID4gICAJCQkJIGRkcnBsbCAmIDB4ZmYpOwo+ID4gLQkJ
ZGV2X3ByaXYtPm1lbV9mcmVxID0gMDsKPiA+ICsJCWk5MTUtPm1lbV9mcmVxID0gMDsKPiA+ICAg
CQlicmVhazsKPiA+ICAgCX0KPiA+IC0JZGV2X3ByaXYtPmlwcy5yX3QgPSBkZXZfcHJpdi0+bWVt
X2ZyZXE7Cj4gPiArCWk5MTUtPmlwcy5yX3QgPSBpOTE1LT5tZW1fZnJlcTsKPiA+ICAgCXN3aXRj
aCAoY3NpcGxsICYgMHgzZmYpIHsKPiA+ICAgCWNhc2UgMHgwMGM6Cj4gPiAtCQlkZXZfcHJpdi0+
ZnNiX2ZyZXEgPSAzMjAwOwo+ID4gKwkJaTkxNS0+ZnNiX2ZyZXEgPSAzMjAwOwo+ID4gICAJCWJy
ZWFrOwo+ID4gICAJY2FzZSAweDAwZToKPiA+IC0JCWRldl9wcml2LT5mc2JfZnJlcSA9IDM3MzM7
Cj4gPiArCQlpOTE1LT5mc2JfZnJlcSA9IDM3MzM7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNl
IDB4MDEwOgo+ID4gLQkJZGV2X3ByaXYtPmZzYl9mcmVxID0gNDI2NjsKPiA+ICsJCWk5MTUtPmZz
Yl9mcmVxID0gNDI2NjsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgMHgwMTI6Cj4gPiAtCQlk
ZXZfcHJpdi0+ZnNiX2ZyZXEgPSA0ODAwOwo+ID4gKwkJaTkxNS0+ZnNiX2ZyZXEgPSA0ODAwOwo+
ID4gICAJCWJyZWFrOwo+ID4gICAJY2FzZSAweDAxNDoKPiA+IC0JCWRldl9wcml2LT5mc2JfZnJl
cSA9IDUzMzM7Cj4gPiArCQlpOTE1LT5mc2JfZnJlcSA9IDUzMzM7Cj4gPiAgIAkJYnJlYWs7Cj4g
PiAgIAljYXNlIDB4MDE2Ogo+ID4gLQkJZGV2X3ByaXYtPmZzYl9mcmVxID0gNTg2NjsKPiA+ICsJ
CWk5MTUtPmZzYl9mcmVxID0gNTg2NjsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgMHgwMTg6
Cj4gPiAtCQlkZXZfcHJpdi0+ZnNiX2ZyZXEgPSA2NDAwOwo+ID4gKwkJaTkxNS0+ZnNiX2ZyZXEg
PSA2NDAwOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJZGVmYXVsdDoKPiA+ICAgCQlEUk1fREVCVUdf
RFJJVkVSKCJ1bmtub3duIGZzYiBmcmVxdWVuY3kgMHglMDR4XG4iLAo+ID4gICAJCQkJIGNzaXBs
bCAmIDB4M2ZmKTsKPiA+IC0JCWRldl9wcml2LT5mc2JfZnJlcSA9IDA7Cj4gPiArCQlpOTE1LT5m
c2JfZnJlcSA9IDA7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAl9Cj4gPiAtCWlmIChkZXZfcHJpdi0+
ZnNiX2ZyZXEgPT0gMzIwMCkgewo+ID4gLQkJZGV2X3ByaXYtPmlwcy5jX20gPSAwOwo+ID4gLQl9
IGVsc2UgaWYgKGRldl9wcml2LT5mc2JfZnJlcSA+IDMyMDAgJiYgZGV2X3ByaXYtPmZzYl9mcmVx
IDw9IDQ4MDApIHsKPiA+IC0JCWRldl9wcml2LT5pcHMuY19tID0gMTsKPiA+ICsJaWYgKGk5MTUt
PmZzYl9mcmVxID09IDMyMDApIHsKPiA+ICsJCWk5MTUtPmlwcy5jX20gPSAwOwo+ID4gKwl9IGVs
c2UgaWYgKGk5MTUtPmZzYl9mcmVxID4gMzIwMCAmJiBpOTE1LT5mc2JfZnJlcSA8PSA0ODAwKSB7
Cj4gPiArCQlpOTE1LT5pcHMuY19tID0gMTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAtCQlkZXZfcHJp
di0+aXBzLmNfbSA9IDI7Cj4gPiArCQlpOTE1LT5pcHMuY19tID0gMjsKPiA+ICAgCX0KPiA+ICAg
fQo+ID4gQEAgLTMxNiw2MSArMzE2LDYxIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY3hzcl9sYXRl
bmN5ICppbnRlbF9nZXRfY3hzcl9sYXRlbmN5KGJvb2wgaXNfZGVza3RvcCwKPiA+ICAgCXJldHVy
biBOVUxMOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgY2h2X3NldF9tZW1vcnlfZHZmcyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgZW5hYmxlKQo+ID4gK3N0YXRpYyB2
b2lkIGNodl9zZXRfbWVtb3J5X2R2ZnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJv
b2wgZW5hYmxlKQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQl2bHZfcHVuaXRfZ2V0KGRl
dl9wcml2KTsKPiA+ICsJdmx2X3B1bml0X2dldChpOTE1KTsKPiA+IC0JdmFsID0gdmx2X3B1bml0
X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19ERFJfU0VUVVAyKTsKPiA+ICsJdmFsID0gdmx2X3B1
bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0REUl9TRVRVUDIpOwo+ID4gICAJaWYgKGVuYWJsZSkK
PiA+ICAgCQl2YWwgJj0gfkZPUkNFX0REUl9ISUdIX0ZSRVE7Cj4gPiAgIAllbHNlCj4gPiAgIAkJ
dmFsIHw9IEZPUkNFX0REUl9ISUdIX0ZSRVE7Cj4gPiAgIAl2YWwgJj0gfkZPUkNFX0REUl9MT1df
RlJFUTsKPiA+ICAgCXZhbCB8PSBGT1JDRV9ERFJfRlJFUV9SRVFfQUNLOwo+ID4gLQl2bHZfcHVu
aXRfd3JpdGUoZGV2X3ByaXYsIFBVTklUX1JFR19ERFJfU0VUVVAyLCB2YWwpOwo+ID4gKwl2bHZf
cHVuaXRfd3JpdGUoaTkxNSwgUFVOSVRfUkVHX0REUl9TRVRVUDIsIHZhbCk7Cj4gPiAtCWlmICh3
YWl0X2Zvcigodmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19ERFJfU0VUVVAyKSAm
Cj4gPiArCWlmICh3YWl0X2Zvcigodmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0REUl9T
RVRVUDIpICYKPiA+ICAgCQkgICAgICBGT1JDRV9ERFJfRlJFUV9SRVFfQUNLKSA9PSAwLCAzKSkK
PiA+ICAgCQlEUk1fRVJST1IoInRpbWVkIG91dCB3YWl0aW5nIGZvciBQdW5pdCBERFIgRFZGUyBy
ZXF1ZXN0XG4iKTsKPiA+IC0Jdmx2X3B1bml0X3B1dChkZXZfcHJpdik7Cj4gPiArCXZsdl9wdW5p
dF9wdXQoaTkxNSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBjaHZfc2V0X21lbW9yeV9wbTUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIGVuYWJsZSkKPiA+ICtzdGF0
aWMgdm9pZCBjaHZfc2V0X21lbW9yeV9wbTUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IGJvb2wgZW5hYmxlKQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQl2bHZfcHVuaXRfZ2V0
KGRldl9wcml2KTsKPiA+ICsJdmx2X3B1bml0X2dldChpOTE1KTsKPiA+IC0JdmFsID0gdmx2X3B1
bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19EU1BTU1BNKTsKPiA+ICsJdmFsID0gdmx2X3B1
bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0RTUFNTUE0pOwo+ID4gICAJaWYgKGVuYWJsZSkKPiA+
ICAgCQl2YWwgfD0gRFNQX01BWEZJRk9fUE01X0VOQUJMRTsKPiA+ICAgCWVsc2UKPiA+ICAgCQl2
YWwgJj0gfkRTUF9NQVhGSUZPX1BNNV9FTkFCTEU7Cj4gPiAtCXZsdl9wdW5pdF93cml0ZShkZXZf
cHJpdiwgUFVOSVRfUkVHX0RTUFNTUE0sIHZhbCk7Cj4gPiArCXZsdl9wdW5pdF93cml0ZShpOTE1
LCBQVU5JVF9SRUdfRFNQU1NQTSwgdmFsKTsKPiA+IC0Jdmx2X3B1bml0X3B1dChkZXZfcHJpdik7
Cj4gPiArCXZsdl9wdW5pdF9wdXQoaTkxNSk7Cj4gPiAgIH0KPiA+ICAgI2RlZmluZSBGV19XTSh2
YWx1ZSwgcGxhbmUpIFwKPiA+ICAgCSgoKHZhbHVlKSA8PCBEU1BGV18gIyMgcGxhbmUgIyMgX1NI
SUZUKSAmIERTUEZXXyAjIyBwbGFuZSAjIyBfTUFTSykKPiA+IC1zdGF0aWMgYm9vbCBfaW50ZWxf
c2V0X21lbW9yeV9jeHNyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBl
bmFibGUpCj4gPiArc3RhdGljIGJvb2wgX2ludGVsX3NldF9tZW1vcnlfY3hzcihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwgYm9vbCBlbmFibGUpCj4gPiAgIHsKPiA+ICAgCWJvb2wgd2Fz
X2VuYWJsZWQ7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJp
dikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX1ZBTExFWVZJRVco
aTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ID4gICAJCXdhc19lbmFibGVkID0gSTkx
NV9SRUFEKEZXX0JMQ19TRUxGX1ZMVikgJiBGV19DU1BXUkRXTkVOOwo+ID4gICAJCUk5MTVfV1JJ
VEUoRldfQkxDX1NFTEZfVkxWLCBlbmFibGUgPyBGV19DU1BXUkRXTkVOIDogMCk7Cj4gPiAgIAkJ
UE9TVElOR19SRUFEKEZXX0JMQ19TRUxGX1ZMVik7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfRzRYKGRl
dl9wcml2KSB8fCBJU19JOTY1R00oZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfRzRY
KGk5MTUpIHx8IElTX0k5NjVHTShpOTE1KSkgewo+ID4gICAJCXdhc19lbmFibGVkID0gSTkxNV9S
RUFEKEZXX0JMQ19TRUxGKSAmIEZXX0JMQ19TRUxGX0VOOwo+ID4gICAJCUk5MTVfV1JJVEUoRldf
QkxDX1NFTEYsIGVuYWJsZSA/IEZXX0JMQ19TRUxGX0VOIDogMCk7Cj4gPiAgIAkJUE9TVElOR19S
RUFEKEZXX0JMQ19TRUxGKTsKPiA+IC0JfSBlbHNlIGlmIChJU19QSU5FVklFVyhkZXZfcHJpdikp
IHsKPiA+ICsJfSBlbHNlIGlmIChJU19QSU5FVklFVyhpOTE1KSkgewo+ID4gICAJCXZhbCA9IEk5
MTVfUkVBRChEU1BGVzMpOwo+ID4gICAJCXdhc19lbmFibGVkID0gdmFsICYgUElORVZJRVdfU0VM
Rl9SRUZSRVNIX0VOOwo+ID4gICAJCWlmIChlbmFibGUpCj4gPiBAQCAtMzc5LDEzICszNzksMTMg
QEAgc3RhdGljIGJvb2wgX2ludGVsX3NldF9tZW1vcnlfY3hzcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIGJvb2wgZW5hYmwKPiA+ICAgCQkJdmFsICY9IH5QSU5FVklFV19TRUxG
X1JFRlJFU0hfRU47Cj4gPiAgIAkJSTkxNV9XUklURShEU1BGVzMsIHZhbCk7Cj4gPiAgIAkJUE9T
VElOR19SRUFEKERTUEZXMyk7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfSTk0NUcoZGV2X3ByaXYpIHx8
IElTX0k5NDVHTShkZXZfcHJpdikpIHsKPiA+ICsJfSBlbHNlIGlmIChJU19JOTQ1RyhpOTE1KSB8
fCBJU19JOTQ1R00oaTkxNSkpIHsKPiA+ICAgCQl3YXNfZW5hYmxlZCA9IEk5MTVfUkVBRChGV19C
TENfU0VMRikgJiBGV19CTENfU0VMRl9FTjsKPiA+ICAgCQl2YWwgPSBlbmFibGUgPyBfTUFTS0VE
X0JJVF9FTkFCTEUoRldfQkxDX1NFTEZfRU4pIDoKPiA+ICAgCQkJICAgICAgIF9NQVNLRURfQklU
X0RJU0FCTEUoRldfQkxDX1NFTEZfRU4pOwo+ID4gICAJCUk5MTVfV1JJVEUoRldfQkxDX1NFTEYs
IHZhbCk7Cj4gPiAgIAkJUE9TVElOR19SRUFEKEZXX0JMQ19TRUxGKTsKPiA+IC0JfSBlbHNlIGlm
IChJU19JOTE1R00oZGV2X3ByaXYpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfSTkxNUdNKGk5MTUp
KSB7Cj4gPiAgIAkJLyoKPiA+ICAgCQkgKiBGSVhNRSBjYW4ndCBmaW5kIGEgYml0IGxpa2UgdGhp
cyBmb3IgOTE1RywgYW5kCj4gPiAgIAkJICogYW5kIHlldCBpdCBkb2VzIGhhdmUgdGhlIHJlbGF0
ZWQgd2F0ZXJtYXJrIGluCj4gPiBAQCAtNDAwLDcgKzQwMCw3IEBAIHN0YXRpYyBib29sIF9pbnRl
bF9zZXRfbWVtb3J5X2N4c3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29s
IGVuYWJsCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gICAJfQo+ID4gLQl0cmFjZV9pbnRlbF9t
ZW1vcnlfY3hzcihkZXZfcHJpdiwgd2FzX2VuYWJsZWQsIGVuYWJsZSk7Cj4gPiArCXRyYWNlX2lu
dGVsX21lbW9yeV9jeHNyKGk5MTUsIHdhc19lbmFibGVkLCBlbmFibGUpOwo+ID4gICAJRFJNX0RF
QlVHX0tNUygibWVtb3J5IHNlbGYtcmVmcmVzaCBpcyAlcyAod2FzICVzKVxuIiwKPiA+ICAgCQkg
ICAgICBlbmFibGVkZGlzYWJsZWQoZW5hYmxlKSwKPiA+IEBAIC00MTEsNyArNDExLDcgQEAgc3Rh
dGljIGJvb2wgX2ludGVsX3NldF9tZW1vcnlfY3hzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIGJvb2wgZW5hYmwKPiA+ICAgLyoqCj4gPiAgICAqIGludGVsX3NldF9tZW1vcnlf
Y3hzciAtIENvbmZpZ3VyZSBDeFNSIHN0YXRlCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRldmlj
ZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZQo+ID4gICAgKiBAZW5hYmxlOiBBbGxvdyB2cy4g
ZGlzYWxsb3cgQ3hTUgo+ID4gICAgKgo+ID4gICAgKiBBbGxvdyBvciBkaXNhbGxvdyB0aGUgc3lz
dGVtIHRvIGVudGVyIGEgc3BlY2lhbCBDeFNSCj4gPiBAQCAtNDQ2LDE3ICs0NDYsMTcgQEAgc3Rh
dGljIGJvb2wgX2ludGVsX3NldF9tZW1vcnlfY3hzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIGJvb2wgZW5hYmwKPiA+ICAgICogdGhlIGhhcmR3YXJlIHcuci50LiBIUExMIFNS
IHdoZW4gd3JpdGluZyB0byBwbGFuZSByZWdpc3RlcnMuCj4gPiAgICAqIERpc2FsbG93aW5nIGp1
c3QgQ3hTUiBpcyBzdWZmaWNpZW50Lgo+ID4gICAgKi8KPiA+IC1ib29sIGludGVsX3NldF9tZW1v
cnlfY3hzcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGJvb2wgZW5hYmxlKQo+
ID4gK2Jvb2wgaW50ZWxfc2V0X21lbW9yeV9jeHNyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBib29sIGVuYWJsZSkKPiA+ICAgewo+ID4gICAJYm9vbCByZXQ7Cj4gPiAtCW11dGV4X2xv
Y2soJmRldl9wcml2LT53bS53bV9tdXRleCk7Cj4gPiAtCXJldCA9IF9pbnRlbF9zZXRfbWVtb3J5
X2N4c3IoZGV2X3ByaXYsIGVuYWJsZSk7Cj4gPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2
KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+IC0JCWRldl9wcml2LT53bS52bHYuY3hz
ciA9IGVuYWJsZTsKPiA+IC0JZWxzZSBpZiAoSVNfRzRYKGRldl9wcml2KSkKPiA+IC0JCWRldl9w
cml2LT53bS5nNHguY3hzciA9IGVuYWJsZTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+
d20ud21fbXV0ZXgpOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT53bS53bV9tdXRleCk7Cj4gPiAr
CXJldCA9IF9pbnRlbF9zZXRfbWVtb3J5X2N4c3IoaTkxNSwgZW5hYmxlKTsKPiA+ICsJaWYgKElT
X1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICsJCWk5MTUtPndt
LnZsdi5jeHNyID0gZW5hYmxlOwo+ID4gKwllbHNlIGlmIChJU19HNFgoaTkxNSkpCj4gPiArCQlp
OTE1LT53bS5nNHguY3hzciA9IGVuYWJsZTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT53bS53
bV9tdXRleCk7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4gPiBAQCAtNDgzLDcgKzQ4Myw3
IEBAIHN0YXRpYyBjb25zdCBpbnQgcGVzc2ltYWxfbGF0ZW5jeV9ucyA9IDUwMDA7Cj4gPiAgIHN0
YXRpYyB2b2lkIHZsdl9nZXRfZmlmb19zaXplKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1
Y3Qgdmx2X2ZpZm9fc3RhdGUgKmZpZm9fc3RhdGUgPSAmY3J0Y19zdGF0ZS0+d20udmx2LmZpZm9f
c3RhdGU7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiAgIAlpbnQgc3By
aXRlMF9zdGFydCwgc3ByaXRlMV9zdGFydDsKPiA+IEBAIC01MTksNyArNTE5LDcgQEAgc3RhdGlj
IHZvaWQgdmx2X2dldF9maWZvX3NpemUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gPiAgIAlmaWZvX3N0YXRlLT5wbGFuZVtQTEFORV9DVVJTT1JdID0gNjM7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgaW50IGk5eHhfZ2V0X2ZpZm9fc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGludCBpOXh4X2dldF9maWZvX3NpemUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgIGVudW0gaTl4eF9wbGFuZV9pZCBp
OXh4X3BsYW5lKQo+ID4gICB7Cj4gPiAgIAl1MzIgZHNwYXJiID0gSTkxNV9SRUFEKERTUEFSQik7
Cj4gPiBAQCAtNTM1LDcgKzUzNSw3IEBAIHN0YXRpYyBpbnQgaTl4eF9nZXRfZmlmb19zaXplKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXJldHVybiBzaXplOwo+ID4g
ICB9Cj4gPiAtc3RhdGljIGludCBpODMwX2dldF9maWZvX3NpemUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBpbnQgaTgzMF9nZXRfZmlmb19zaXplKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgICBlbnVtIGk5eHhfcGxhbmVf
aWQgaTl4eF9wbGFuZSkKPiA+ICAgewo+ID4gICAJdTMyIGRzcGFyYiA9IEk5MTVfUkVBRChEU1BB
UkIpOwo+ID4gQEAgLTU1Miw3ICs1NTIsNyBAQCBzdGF0aWMgaW50IGk4MzBfZ2V0X2ZpZm9fc2l6
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXR1cm4gc2l6ZTsK
PiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQgaTg0NV9nZXRfZmlmb19zaXplKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW50IGk4NDVfZ2V0X2ZpZm9fc2l6ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgZW51bSBpOXh4X3Bs
YW5lX2lkIGk5eHhfcGxhbmUpCj4gPiAgIHsKPiA+ICAgCXUzMiBkc3BhcmIgPSBJOTE1X1JFQUQo
RFNQQVJCKTsKPiA+IEBAIC04MDUsOSArODA1LDkgQEAgc3RhdGljIGJvb2wgaXNfZW5hYmxpbmco
aW50IG9sZCwgaW50IG5ldywgaW50IHRocmVzaG9sZCkKPiA+ICAgCXJldHVybiBvbGQgPCB0aHJl
c2hvbGQgJiYgbmV3ID49IHRocmVzaG9sZDsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQgaW50ZWxf
d21fbnVtX2xldmVscyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3Rh
dGljIGludCBpbnRlbF93bV9udW1fbGV2ZWxzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ID4gICB7Cj4gPiAtCXJldHVybiBkZXZfcHJpdi0+d20ubWF4X2xldmVsICsgMTsKPiA+ICsJ
cmV0dXJuIGk5MTUtPndtLm1heF9sZXZlbCArIDE7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGJvb2wg
aW50ZWxfd21fcGxhbmVfdmlzaWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwKPiA+IEBAIC04MzMsMTEgKzgzMywxMSBAQCBzdGF0aWMgYm9vbCBpbnRlbF93bV9w
bGFuZV92aXNpYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ID4gICAJCXJldHVybiBwbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlOwo+ID4gICB9Cj4gPiAtc3Rh
dGljIHN0cnVjdCBpbnRlbF9jcnRjICpzaW5nbGVfZW5hYmxlZF9jcnRjKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgc3RydWN0IGludGVsX2NydGMgKnNpbmds
ZV9lbmFibGVkX2NydGMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLCAqZW5hYmxlZCA9IE5VTEw7Cj4gPiAtCWZvcl9l
YWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpIHsKPiA+ICsJZm9yX2VhY2hfaW50
ZWxfY3J0YygmaTkxNS0+ZHJtLCBjcnRjKSB7Cj4gPiAgIAkJaWYgKGludGVsX2NydGNfYWN0aXZl
KGNydGMpKSB7Cj4gPiAgIAkJCWlmIChlbmFibGVkKQo+ID4gICAJCQkJcmV0dXJuIE5VTEw7Cj4g
PiBAQCAtODUwLDIzICs4NTAsMjMgQEAgc3RhdGljIHN0cnVjdCBpbnRlbF9jcnRjICpzaW5nbGVf
ZW5hYmxlZF9jcnRjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgc3Rh
dGljIHZvaWQgcGluZXZpZXdfdXBkYXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0
YykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KHVudXNlZF9jcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNSh1bnVzZWRfY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGlu
dGVsX2NydGMgKmNydGM7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgY3hzcl9sYXRlbmN5ICpsYXRlbmN5
Owo+ID4gICAJdTMyIHJlZzsKPiA+ICAgCXVuc2lnbmVkIGludCB3bTsKPiA+IC0JbGF0ZW5jeSA9
IGludGVsX2dldF9jeHNyX2xhdGVuY3koIUlTX01PQklMRShkZXZfcHJpdiksCj4gPiAtCQkJCQkg
ZGV2X3ByaXYtPmlzX2RkcjMsCj4gPiAtCQkJCQkgZGV2X3ByaXYtPmZzYl9mcmVxLAo+ID4gLQkJ
CQkJIGRldl9wcml2LT5tZW1fZnJlcSk7Cj4gPiArCWxhdGVuY3kgPSBpbnRlbF9nZXRfY3hzcl9s
YXRlbmN5KCFJU19NT0JJTEUoaTkxNSksCj4gPiArCQkJCQkgaTkxNS0+aXNfZGRyMywKPiA+ICsJ
CQkJCSBpOTE1LT5mc2JfZnJlcSwKPiA+ICsJCQkJCSBpOTE1LT5tZW1fZnJlcSk7Cj4gPiAgIAlp
ZiAoIWxhdGVuY3kpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJVbmtub3duIEZTQi9NRU0gZm91
bmQsIGRpc2FibGUgQ3hTUlxuIik7Cj4gPiAtCQlpbnRlbF9zZXRfbWVtb3J5X2N4c3IoZGV2X3By
aXYsIGZhbHNlKTsKPiA+ICsJCWludGVsX3NldF9tZW1vcnlfY3hzcihpOTE1LCBmYWxzZSk7Cj4g
PiAgIAkJcmV0dXJuOwo+ID4gICAJfQo+ID4gLQljcnRjID0gc2luZ2xlX2VuYWJsZWRfY3J0Yyhk
ZXZfcHJpdik7Cj4gPiArCWNydGMgPSBzaW5nbGVfZW5hYmxlZF9jcnRjKGk5MTUpOwo+ID4gICAJ
aWYgKGNydGMpIHsKPiA+ICAgCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0
ZWRfbW9kZSA9Cj4gPiAgIAkJCSZjcnRjLT5jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiA+
IEBAIC05MTMsOSArOTEzLDkgQEAgc3RhdGljIHZvaWQgcGluZXZpZXdfdXBkYXRlX3dtKHN0cnVj
dCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKPiA+ICAgCQlJOTE1X1dSSVRFKERTUEZXMywgcmVn
KTsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJEU1BGVzMgcmVnaXN0ZXIgaXMgJXhcbiIsIHJlZyk7
Cj4gPiAtCQlpbnRlbF9zZXRfbWVtb3J5X2N4c3IoZGV2X3ByaXYsIHRydWUpOwo+ID4gKwkJaW50
ZWxfc2V0X21lbW9yeV9jeHNyKGk5MTUsIHRydWUpOwo+ID4gICAJfSBlbHNlIHsKPiA+IC0JCWlu
dGVsX3NldF9tZW1vcnlfY3hzcihkZXZfcHJpdiwgZmFsc2UpOwo+ID4gKwkJaW50ZWxfc2V0X21l
bW9yeV9jeHNyKGk5MTUsIGZhbHNlKTsKPiA+ICAgCX0KPiA+ICAgfQo+ID4gQEAgLTkzNiwxMyAr
OTM2LDEzIEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgZzR4X3RsYl9taXNzX3dhKGludCBmaWZvX3Np
emUsIGludCB3aWR0aCwgaW50IGNwcCkKPiA+ICAgCXJldHVybiBtYXgoMCwgdGxiX21pc3MpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZzR4X3dyaXRlX3dtX3ZhbHVlcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgZzR4X3dyaXRlX3dtX3ZhbHVl
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCWNvbnN0IHN0cnVjdCBn
NHhfd21fdmFsdWVzICp3bSkKPiA+ICAgewo+ID4gICAJZW51bSBwaXBlIHBpcGU7Cj4gPiAtCWZv
cl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpCj4gPiAtCQl0cmFjZV9nNHhfd20oaW50ZWxfZ2V0
X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpLCB3bSk7Cj4gPiArCWZvcl9lYWNoX3BpcGUo
aTkxNSwgcGlwZSkKPiA+ICsJCXRyYWNlX2c0eF93bShpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShp
OTE1LCBwaXBlKSwgd20pOwo+ID4gICAJSTkxNV9XUklURShEU1BGVzEsCj4gPiAgIAkJICAgRldf
V00od20tPnNyLnBsYW5lLCBTUikgfAo+ID4gQEAgLTk2OCwxMyArOTY4LDEzIEBAIHN0YXRpYyB2
b2lkIGc0eF93cml0ZV93bV92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gICAjZGVmaW5lIEZXX1dNX1ZMVih2YWx1ZSwgcGxhbmUpIFwKPiA+ICAgCSgoKHZhbHVl
KSA8PCBEU1BGV18gIyMgcGxhbmUgIyMgX1NISUZUKSAmIERTUEZXXyAjIyBwbGFuZSAjIyBfTUFT
S19WTFYpCj4gPiAtc3RhdGljIHZvaWQgdmx2X3dyaXRlX3dtX3ZhbHVlcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgdmx2X3dyaXRlX3dtX3ZhbHVl
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCWNvbnN0IHN0cnVjdCB2
bHZfd21fdmFsdWVzICp3bSkKPiA+ICAgewo+ID4gICAJZW51bSBwaXBlIHBpcGU7Cj4gPiAtCWZv
cl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKPiA+IC0JCXRyYWNlX3Zsdl93bShpbnRlbF9n
ZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgcGlwZSksIHdtKTsKPiA+ICsJZm9yX2VhY2hfcGlw
ZShpOTE1LCBwaXBlKSB7Cj4gPiArCQl0cmFjZV92bHZfd20oaW50ZWxfZ2V0X2NydGNfZm9yX3Bp
cGUoaTkxNSwgcGlwZSksIHdtKTsKPiA+ICAgCQlJOTE1X1dSSVRFKFZMVl9EREwocGlwZSksCj4g
PiAgIAkJCSAgICh3bS0+ZGRsW3BpcGVdLnBsYW5lW1BMQU5FX0NVUlNPUl0gPDwgRERMX0NVUlNP
Ul9TSElGVCkgfAo+ID4gQEAgLTEwMDYsNyArMTAwNiw3IEBAIHN0YXRpYyB2b2lkIHZsdl93cml0
ZV93bV92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJSTkx
NV9XUklURShEU1BGVzMsCj4gPiAgIAkJICAgRldfV00od20tPnNyLmN1cnNvciwgQ1VSU09SX1NS
KSk7Cj4gPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfQ0hF
UlJZVklFVyhpOTE1KSkgewo+ID4gICAJCUk5MTVfV1JJVEUoRFNQRlc3X0NIViwKPiA+ICAgCQkJ
ICAgRldfV01fVkxWKHdtLT5waXBlW1BJUEVfQl0ucGxhbmVbUExBTkVfU1BSSVRFMV0sIFNQUklU
RUQpIHwKPiA+ICAgCQkJICAgRldfV01fVkxWKHdtLT5waXBlW1BJUEVfQl0ucGxhbmVbUExBTkVf
U1BSSVRFMF0sIFNQUklURUMpKTsKPiA+IEBAIC0xMDQ2LDE0ICsxMDQ2LDE0IEBAIHN0YXRpYyB2
b2lkIHZsdl93cml0ZV93bV92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gICAjdW5kZWYgRldfV01fVkxWCj4gPiAtc3RhdGljIHZvaWQgZzR4X3NldHVwX3dtX2xh
dGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lk
IGc0eF9zZXR1cF93bV9sYXRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4g
ICB7Cj4gPiAgIAkvKiBhbGwgbGF0ZW5jaWVzIGluIHVzZWMgKi8KPiA+IC0JZGV2X3ByaXYtPndt
LnByaV9sYXRlbmN5W0c0WF9XTV9MRVZFTF9OT1JNQUxdID0gNTsKPiA+IC0JZGV2X3ByaXYtPndt
LnByaV9sYXRlbmN5W0c0WF9XTV9MRVZFTF9TUl0gPSAxMjsKPiA+IC0JZGV2X3ByaXYtPndtLnBy
aV9sYXRlbmN5W0c0WF9XTV9MRVZFTF9IUExMXSA9IDM1Owo+ID4gKwlpOTE1LT53bS5wcmlfbGF0
ZW5jeVtHNFhfV01fTEVWRUxfTk9STUFMXSA9IDU7Cj4gPiArCWk5MTUtPndtLnByaV9sYXRlbmN5
W0c0WF9XTV9MRVZFTF9TUl0gPSAxMjsKPiA+ICsJaTkxNS0+d20ucHJpX2xhdGVuY3lbRzRYX1dN
X0xFVkVMX0hQTExdID0gMzU7Cj4gPiAtCWRldl9wcml2LT53bS5tYXhfbGV2ZWwgPSBHNFhfV01f
TEVWRUxfSFBMTDsKPiA+ICsJaTkxNS0+d20ubWF4X2xldmVsID0gRzRYX1dNX0xFVkVMX0hQTEw7
Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGludCBnNHhfcGxhbmVfZmlmb19zaXplKGVudW0gcGxhbmVf
aWQgcGxhbmVfaWQsIGludCBsZXZlbCkKPiA+IEBAIC0xMTAzLDEwICsxMTAzLDEwIEBAIHN0YXRp
YyB1MTYgZzR4X2NvbXB1dGVfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCj4gPiAgIAkJCSAgaW50IGxldmVsKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxf
cGxhbmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUpOwo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShw
bGFuZS0+YmFzZS5kZXYpOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFk
anVzdGVkX21vZGUgPQo+ID4gICAJCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4g
PiAtCXVuc2lnbmVkIGludCBsYXRlbmN5ID0gZGV2X3ByaXYtPndtLnByaV9sYXRlbmN5W2xldmVs
XSAqIDEwOwo+ID4gKwl1bnNpZ25lZCBpbnQgbGF0ZW5jeSA9IGk5MTUtPndtLnByaV9sYXRlbmN5
W2xldmVsXSAqIDEwOwo+ID4gICAJdW5zaWduZWQgaW50IGNsb2NrLCBodG90YWwsIGNwcCwgd2lk
dGgsIHdtOwo+ID4gICAJaWYgKGxhdGVuY3kgPT0gMCkKPiA+IEBAIC0xMTI2LDcgKzExMjYsNyBA
QCBzdGF0aWMgdTE2IGc0eF9jb21wdXRlX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+ID4gICAJICogdGhlIEhQTEwgd2F0ZXJtYXJrLCB3aGljaCBzZWVtcyBh
IGxpdHRsZSBzdHJhbmdlLgo+ID4gICAJICogTGV0J3MgdXNlIDMyYnBwIGZvciB0aGUgSFBMTCB3
YXRlcm1hcmsgYXMgd2VsbC4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSVNfR000NShkZXZfcHJpdikg
JiYgcGxhbmUtPmlkID09IFBMQU5FX1BSSU1BUlkgJiYKPiA+ICsJaWYgKElTX0dNNDUoaTkxNSkg
JiYgcGxhbmUtPmlkID09IFBMQU5FX1BSSU1BUlkgJiYKPiA+ICAgCSAgICBsZXZlbCAhPSBHNFhf
V01fTEVWRUxfTk9STUFMKQo+ID4gICAJCWNwcCA9IDQ7Cj4gPiAgIAllbHNlCj4gPiBAQCAtMTE2
NSwxMCArMTE2NSwxMCBAQCBzdGF0aWMgdTE2IGc0eF9jb21wdXRlX3dtKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICBzdGF0aWMgYm9vbCBnNHhfcmF3X3Bs
YW5lX3dtX3NldChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJ
CSBpbnQgbGV2ZWwsIGVudW0gcGxhbmVfaWQgcGxhbmVfaWQsIHUxNiB2YWx1ZSkKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICAgCWJvb2wgZGlydHkg
PSBmYWxzZTsKPiA+IC0JZm9yICg7IGxldmVsIDwgaW50ZWxfd21fbnVtX2xldmVscyhkZXZfcHJp
dik7IGxldmVsKyspIHsKPiA+ICsJZm9yICg7IGxldmVsIDwgaW50ZWxfd21fbnVtX2xldmVscyhp
OTE1KTsgbGV2ZWwrKykgewo+ID4gICAJCXN0cnVjdCBnNHhfcGlwZV93bSAqcmF3ID0gJmNydGNf
c3RhdGUtPndtLmc0eC5yYXdbbGV2ZWxdOwo+ID4gICAJCWRpcnR5IHw9IHJhdy0+cGxhbmVbcGxh
bmVfaWRdICE9IHZhbHVlOwo+ID4gQEAgLTExODEsMTMgKzExODEsMTMgQEAgc3RhdGljIGJvb2wg
ZzR4X3Jhd19wbGFuZV93bV9zZXQoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gPiAgIHN0YXRpYyBib29sIGc0eF9yYXdfZmJjX3dtX3NldChzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJICAgICAgIGludCBsZXZlbCwgdTE2IHZhbHVlKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gICAJYm9v
bCBkaXJ0eSA9IGZhbHNlOwo+ID4gICAJLyogTk9STUFMIGxldmVsIGRvZXNuJ3QgaGF2ZSBhbiBG
QkMgd2F0ZXJtYXJrICovCj4gPiAgIAlsZXZlbCA9IG1heChsZXZlbCwgRzRYX1dNX0xFVkVMX1NS
KTsKPiA+IC0JZm9yICg7IGxldmVsIDwgaW50ZWxfd21fbnVtX2xldmVscyhkZXZfcHJpdik7IGxl
dmVsKyspIHsKPiA+ICsJZm9yICg7IGxldmVsIDwgaW50ZWxfd21fbnVtX2xldmVscyhpOTE1KTsg
bGV2ZWwrKykgewo+ID4gICAJCXN0cnVjdCBnNHhfcGlwZV93bSAqcmF3ID0gJmNydGNfc3RhdGUt
PndtLmc0eC5yYXdbbGV2ZWxdOwo+ID4gICAJCWRpcnR5IHw9IHJhdy0+ZmJjICE9IHZhbHVlOwo+
ID4gQEAgLTEyODMsOSArMTI4Myw5IEBAIHN0YXRpYyBib29sIGc0eF9yYXdfcGxhbmVfd21faXNf
dmFsaWQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIHN0
YXRpYyBib29sIGc0eF9yYXdfY3J0Y193bV9pc192YWxpZChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJCSAgICAgaW50IGxldmVsKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gLQlpZiAobGV2ZWwgPiBk
ZXZfcHJpdi0+d20ubWF4X2xldmVsKQo+ID4gKwlpZiAobGV2ZWwgPiBpOTE1LT53bS5tYXhfbGV2
ZWwpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gICAJcmV0dXJuIGc0eF9yYXdfcGxhbmVfd21f
aXNfdmFsaWQoY3J0Y19zdGF0ZSwgUExBTkVfUFJJTUFSWSwgbGV2ZWwpICYmCj4gPiBAQCAtMTQ4
NCw3ICsxNDg0LDcgQEAgc3RhdGljIGludCBnNHhfY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20oc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+ID4gICAJcmV0dXJuIDA7Cj4g
PiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnNHhfbWVyZ2Vfd20oc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGc0eF9tZXJnZV93bShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJIHN0cnVjdCBnNHhfd21fdmFsdWVzICp3bSkKPiA+
ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gPiBAQCAtMTQ5NCw3ICsxNDk0
LDcgQEAgc3RhdGljIHZvaWQgZzR4X21lcmdlX3dtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCXdtLT5ocGxsX2VuID0gdHJ1ZTsKPiA+ICAgCXdtLT5mYmNfZW4gPSB0
cnVlOwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRjKSB7Cj4g
PiArCWZvcl9lYWNoX2ludGVsX2NydGMoJmk5MTUtPmRybSwgY3J0Yykgewo+ID4gICAJCWNvbnN0
IHN0cnVjdCBnNHhfd21fc3RhdGUgKndtX3N0YXRlID0gJmNydGMtPndtLmFjdGl2ZS5nNHg7Cj4g
PiAgIAkJaWYgKCFjcnRjLT5hY3RpdmUpCj4gPiBAQCAtMTUxNiw3ICsxNTE2LDcgQEAgc3RhdGlj
IHZvaWQgZzR4X21lcmdlX3dtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICAgCQl3bS0+ZmJjX2VuID0gZmFsc2U7Cj4gPiAgIAl9Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2Ny
dGMoJmRldl9wcml2LT5kcm0sIGNydGMpIHsKPiA+ICsJZm9yX2VhY2hfaW50ZWxfY3J0YygmaTkx
NS0+ZHJtLCBjcnRjKSB7Cj4gPiAgIAkJY29uc3Qgc3RydWN0IGc0eF93bV9zdGF0ZSAqd21fc3Rh
dGUgPSAmY3J0Yy0+d20uYWN0aXZlLmc0eDsKPiA+ICAgCQllbnVtIHBpcGUgcGlwZSA9IGNydGMt
PnBpcGU7Cj4gPiBAQCAtMTUyOCwyMyArMTUyOCwyMyBAQCBzdGF0aWMgdm9pZCBnNHhfbWVyZ2Vf
d20oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJfQo+ID4gICB9Cj4g
PiAtc3RhdGljIHZvaWQgZzR4X3Byb2dyYW1fd2F0ZXJtYXJrcyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgZzR4X3Byb2dyYW1fd2F0ZXJtYXJrcyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZzR4X3dt
X3ZhbHVlcyAqb2xkX3dtID0gJmRldl9wcml2LT53bS5nNHg7Cj4gPiArCXN0cnVjdCBnNHhfd21f
dmFsdWVzICpvbGRfd20gPSAmaTkxNS0+d20uZzR4Owo+ID4gICAJc3RydWN0IGc0eF93bV92YWx1
ZXMgbmV3X3dtID0ge307Cj4gPiAtCWc0eF9tZXJnZV93bShkZXZfcHJpdiwgJm5ld193bSk7Cj4g
PiArCWc0eF9tZXJnZV93bShpOTE1LCAmbmV3X3dtKTsKPiA+ICAgCWlmIChtZW1jbXAob2xkX3dt
LCAmbmV3X3dtLCBzaXplb2YobmV3X3dtKSkgPT0gMCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAlp
ZiAoaXNfZGlzYWJsaW5nKG9sZF93bS0+Y3hzciwgbmV3X3dtLmN4c3IsIHRydWUpKQo+ID4gLQkJ
X2ludGVsX3NldF9tZW1vcnlfY3hzcihkZXZfcHJpdiwgZmFsc2UpOwo+ID4gKwkJX2ludGVsX3Nl
dF9tZW1vcnlfY3hzcihpOTE1LCBmYWxzZSk7Cj4gPiAtCWc0eF93cml0ZV93bV92YWx1ZXMoZGV2
X3ByaXYsICZuZXdfd20pOwo+ID4gKwlnNHhfd3JpdGVfd21fdmFsdWVzKGk5MTUsICZuZXdfd20p
Owo+ID4gICAJaWYgKGlzX2VuYWJsaW5nKG9sZF93bS0+Y3hzciwgbmV3X3dtLmN4c3IsIHRydWUp
KQo+ID4gLQkJX2ludGVsX3NldF9tZW1vcnlfY3hzcihkZXZfcHJpdiwgdHJ1ZSk7Cj4gPiArCQlf
aW50ZWxfc2V0X21lbW9yeV9jeHNyKGk5MTUsIHRydWUpOwo+ID4gICAJKm9sZF93bSA9IG5ld193
bTsKPiA+ICAgfQo+ID4gQEAgLTE1NTIsMjggKzE1NTIsMjggQEAgc3RhdGljIHZvaWQgZzR4X3By
b2dyYW1fd2F0ZXJtYXJrcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAg
IHN0YXRpYyB2b2lkIGc0eF9pbml0aWFsX3dhdGVybWFya3Moc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUsCj4gPiAgIAkJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ID4g
KwltdXRleF9sb2NrKCZpOTE1LT53bS53bV9tdXRleCk7Cj4gPiAgIAljcnRjLT53bS5hY3RpdmUu
ZzR4ID0gY3J0Y19zdGF0ZS0+d20uZzR4LmludGVybWVkaWF0ZTsKPiA+IC0JZzR4X3Byb2dyYW1f
d2F0ZXJtYXJrcyhkZXZfcHJpdik7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPndtLndt
X211dGV4KTsKPiA+ICsJZzR4X3Byb2dyYW1fd2F0ZXJtYXJrcyhpOTE1KTsKPiA+ICsJbXV0ZXhf
dW5sb2NrKCZpOTE1LT53bS53bV9tdXRleCk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgZzR4
X29wdGltaXplX3dhdGVybWFya3Moc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4g
PiAgIAkJCQkgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0
YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRj
KTsKPiA+ICAgCWlmICghY3J0Y19zdGF0ZS0+d20ubmVlZF9wb3N0dmJsX3VwZGF0ZSkKPiA+ICAg
CQlyZXR1cm47Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT53bS53bV9tdXRleCk7Cj4gPiAr
CW11dGV4X2xvY2soJmk5MTUtPndtLndtX211dGV4KTsKPiA+ICAgCWludGVsX2NydGMtPndtLmFj
dGl2ZS5nNHggPSBjcnRjX3N0YXRlLT53bS5nNHgub3B0aW1hbDsKPiA+IC0JZzR4X3Byb2dyYW1f
d2F0ZXJtYXJrcyhkZXZfcHJpdik7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPndtLndt
X211dGV4KTsKPiA+ICsJZzR4X3Byb2dyYW1fd2F0ZXJtYXJrcyhpOTE1KTsKPiA+ICsJbXV0ZXhf
dW5sb2NrKCZpOTE1LT53bS53bV9tdXRleCk7Cj4gPiAgIH0KPiA+ICAgLyogbGF0ZW5jeSBtdXN0
IGJlIGluIDAuMXVzIHVuaXRzLiAqLwo+ID4gQEAgLTE1OTIsMTggKzE1OTIsMTggQEAgc3RhdGlj
IHVuc2lnbmVkIGludCB2bHZfd21fbWV0aG9kMih1bnNpZ25lZCBpbnQgcGl4ZWxfcmF0ZSwKPiA+
ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCB2bHZfc2V0dXBfd21fbGF0
ZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQg
dmx2X3NldHVwX3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAg
IHsKPiA+ICAgCS8qIGFsbCBsYXRlbmNpZXMgaW4gdXNlYyAqLwo+ID4gLQlkZXZfcHJpdi0+d20u
cHJpX2xhdGVuY3lbVkxWX1dNX0xFVkVMX1BNMl0gPSAzOwo+ID4gKwlpOTE1LT53bS5wcmlfbGF0
ZW5jeVtWTFZfV01fTEVWRUxfUE0yXSA9IDM7Cj4gPiAtCWRldl9wcml2LT53bS5tYXhfbGV2ZWwg
PSBWTFZfV01fTEVWRUxfUE0yOwo+ID4gKwlpOTE1LT53bS5tYXhfbGV2ZWwgPSBWTFZfV01fTEVW
RUxfUE0yOwo+ID4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+IC0JCWRldl9w
cml2LT53bS5wcmlfbGF0ZW5jeVtWTFZfV01fTEVWRUxfUE01XSA9IDEyOwo+ID4gLQkJZGV2X3By
aXYtPndtLnByaV9sYXRlbmN5W1ZMVl9XTV9MRVZFTF9ERFJfRFZGU10gPSAzMzsKPiA+ICsJaWYg
KElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKPiA+ICsJCWk5MTUtPndtLnByaV9sYXRlbmN5W1ZMVl9X
TV9MRVZFTF9QTTVdID0gMTI7Cj4gPiArCQlpOTE1LT53bS5wcmlfbGF0ZW5jeVtWTFZfV01fTEVW
RUxfRERSX0RWRlNdID0gMzM7Cj4gPiAtCQlkZXZfcHJpdi0+d20ubWF4X2xldmVsID0gVkxWX1dN
X0xFVkVMX0REUl9EVkZTOwo+ID4gKwkJaTkxNS0+d20ubWF4X2xldmVsID0gVkxWX1dNX0xFVkVM
X0REUl9EVkZTOwo+ID4gICAJfQo+ID4gICB9Cj4gPiBAQCAtMTYxMiwxMiArMTYxMiwxMiBAQCBz
dGF0aWMgdTE2IHZsdl9jb21wdXRlX3dtX2xldmVsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkJaW50IGxldmVsKQo+ID4gICB7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2Uu
cGxhbmUpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KHBsYW5lLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5
X21vZGUgKmFkanVzdGVkX21vZGUgPQo+ID4gICAJCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVk
X21vZGU7Cj4gPiAgIAl1bnNpZ25lZCBpbnQgY2xvY2ssIGh0b3RhbCwgY3BwLCB3aWR0aCwgd207
Cj4gPiAtCWlmIChkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3lbbGV2ZWxdID09IDApCj4gPiArCWlm
IChpOTE1LT53bS5wcmlfbGF0ZW5jeVtsZXZlbF0gPT0gMCkKPiA+ICAgCQlyZXR1cm4gVVNIUlRf
TUFYOwo+ID4gICAJaWYgKCFpbnRlbF93bV9wbGFuZV92aXNpYmxlKGNydGNfc3RhdGUsIHBsYW5l
X3N0YXRlKSkKPiA+IEBAIC0xNjM4LDcgKzE2MzgsNyBAQCBzdGF0aWMgdTE2IHZsdl9jb21wdXRl
X3dtX2xldmVsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4g
ICAJCXdtID0gNjM7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCXdtID0gdmx2X3dtX21ldGhvZDIo
Y2xvY2ssIGh0b3RhbCwgd2lkdGgsIGNwcCwKPiA+IC0JCQkJICAgIGRldl9wcml2LT53bS5wcmlf
bGF0ZW5jeVtsZXZlbF0gKiAxMCk7Cj4gPiArCQkJCSAgICBpOTE1LT53bS5wcmlfbGF0ZW5jeVts
ZXZlbF0gKiAxMCk7Cj4gPiAgIAl9Cj4gPiAgIAlyZXR1cm4gbWluX3QodW5zaWduZWQgaW50LCB3
bSwgVVNIUlRfTUFYKTsKPiA+IEBAIC0xNzM2LDkgKzE3MzYsOSBAQCBzdGF0aWMgaW50IHZsdl9j
b21wdXRlX2ZpZm8oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHN0
YXRpYyB2b2lkIHZsdl9pbnZhbGlkYXRlX3dtcyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPiA+
ICAgCQkJICAgICAgIHN0cnVjdCB2bHZfd21fc3RhdGUgKndtX3N0YXRlLCBpbnQgbGV2ZWwpCj4g
PiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAtCWZvciAoOyBsZXZlbCA8IGludGVsX3dtX251bV9s
ZXZlbHMoZGV2X3ByaXYpOyBsZXZlbCsrKSB7Cj4gPiArCWZvciAoOyBsZXZlbCA8IGludGVsX3dt
X251bV9sZXZlbHMoaTkxNSk7IGxldmVsKyspIHsKPiA+ICAgCQllbnVtIHBsYW5lX2lkIHBsYW5l
X2lkOwo+ID4gICAJCWZvcl9lYWNoX3BsYW5lX2lkX29uX2NydGMoY3J0YywgcGxhbmVfaWQpCj4g
PiBAQCAtMTc2NCw4ICsxNzY0LDggQEAgc3RhdGljIHUxNiB2bHZfaW52ZXJ0X3dtX3ZhbHVlKHUx
NiB3bSwgdTE2IGZpZm9fc2l6ZSkKPiA+ICAgc3RhdGljIGJvb2wgdmx2X3Jhd19wbGFuZV93bV9z
ZXQoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQkgaW50IGxl
dmVsLCBlbnVtIHBsYW5lX2lkIHBsYW5lX2lkLCB1MTYgdmFsdWUpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNl
LmNydGMtPmRldik7Cj4gPiAtCWludCBudW1fbGV2ZWxzID0gaW50ZWxfd21fbnVtX2xldmVscyhk
ZXZfcHJpdik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
cnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gPiArCWludCBudW1fbGV2ZWxzID0gaW50ZWxf
d21fbnVtX2xldmVscyhpOTE1KTsKPiA+ICAgCWJvb2wgZGlydHkgPSBmYWxzZTsKPiA+ICAgCWZv
ciAoOyBsZXZlbCA8IG51bV9sZXZlbHM7IGxldmVsKyspIHsKPiA+IEBAIC0xODQwLDcgKzE4NDAs
NyBAQCBzdGF0aWMgYm9vbCB2bHZfcmF3X2NydGNfd21faXNfdmFsaWQoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIHN0YXRpYyBpbnQgdmx2X2NvbXB1dGVf
cGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4g
ICAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2F0b21pY19zdGF0
ZSAqc3RhdGUgPQo+ID4gICAJCXRvX2ludGVsX2F0b21pY19zdGF0ZShjcnRjX3N0YXRlLT5iYXNl
LnN0YXRlKTsKPiA+ICAgCXN0cnVjdCB2bHZfd21fc3RhdGUgKndtX3N0YXRlID0gJmNydGNfc3Rh
dGUtPndtLnZsdi5vcHRpbWFsOwo+ID4gQEAgLTE4OTcsNyArMTg5Nyw3IEBAIHN0YXRpYyBpbnQg
dmx2X2NvbXB1dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
PiA+ICAgCX0KPiA+ICAgCS8qIGluaXRpYWxseSBhbGxvdyBhbGwgbGV2ZWxzICovCj4gPiAtCXdt
X3N0YXRlLT5udW1fbGV2ZWxzID0gaW50ZWxfd21fbnVtX2xldmVscyhkZXZfcHJpdik7Cj4gPiAr
CXdtX3N0YXRlLT5udW1fbGV2ZWxzID0gaW50ZWxfd21fbnVtX2xldmVscyhpOTE1KTsKPiA+ICAg
CS8qCj4gPiAgIAkgKiBOb3RlIHRoYXQgZW5hYmxpbmcgY3hzciB3aXRoIG5vIHByaW1hcnkvc3By
aXRlIHBsYW5lcwo+ID4gICAJICogZW5hYmxlZCBjYW4gd2VkZ2UgdGhlIHBpcGUuIEhlbmNlIHdl
IG9ubHkgYWxsb3cgY3hzcgo+ID4gQEAgLTE5MDcsNyArMTkwNyw3IEBAIHN0YXRpYyBpbnQgdmx2
X2NvbXB1dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+
ICAgCWZvciAobGV2ZWwgPSAwOyBsZXZlbCA8IHdtX3N0YXRlLT5udW1fbGV2ZWxzOyBsZXZlbCsr
KSB7Cj4gPiAgIAkJY29uc3Qgc3RydWN0IGc0eF9waXBlX3dtICpyYXcgPSAmY3J0Y19zdGF0ZS0+
d20udmx2LnJhd1tsZXZlbF07Cj4gPiAtCQljb25zdCBpbnQgc3JfZmlmb19zaXplID0gSU5URUxf
SU5GTyhkZXZfcHJpdiktPm51bV9waXBlcyAqIDUxMiAtIDE7Cj4gPiArCQljb25zdCBpbnQgc3Jf
Zmlmb19zaXplID0gSU5URUxfSU5GTyhpOTE1KS0+bnVtX3BpcGVzICogNTEyIC0gMTsKPiA+ICAg
CQlpZiAoIXZsdl9yYXdfY3J0Y193bV9pc192YWxpZChjcnRjX3N0YXRlLCBsZXZlbCkpCj4gPiAg
IAkJCWJyZWFrOwo+ID4gQEAgLTE5NDgsOCArMTk0OCw4IEBAIHN0YXRpYyB2b2lkIHZsdl9hdG9t
aWNfdXBkYXRlX2ZpZm8oc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gPiAgIAkJ
CQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+ID4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2
X3ByaXYtPnVuY29yZTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0g
Jmk5MTUtPnVuY29yZTsKPiA+ICAgCWNvbnN0IHN0cnVjdCB2bHZfZmlmb19zdGF0ZSAqZmlmb19z
dGF0ZSA9Cj4gPiAgIAkJJmNydGNfc3RhdGUtPndtLnZsdi5maWZvX3N0YXRlOwo+ID4gICAJaW50
IHNwcml0ZTBfc3RhcnQsIHNwcml0ZTFfc3RhcnQsIGZpZm9fc2l6ZTsKPiA+IEBAIC0yMDkyLDE2
ICsyMDkyLDE2IEBAIHN0YXRpYyBpbnQgdmx2X2NvbXB1dGVfaW50ZXJtZWRpYXRlX3dtKHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPiA+ICAgCXJldHVybiAwOwo+ID4g
ICB9Cj4gPiAtc3RhdGljIHZvaWQgdmx2X21lcmdlX3dtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCB2bHZfbWVyZ2Vfd20oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSBzdHJ1Y3Qgdmx2X3dtX3ZhbHVlcyAqd20pCj4gPiAg
IHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ID4gICAJaW50IG51bV9hY3RpdmVf
Y3J0Y3MgPSAwOwo+ID4gLQl3bS0+bGV2ZWwgPSBkZXZfcHJpdi0+d20ubWF4X2xldmVsOwo+ID4g
Kwl3bS0+bGV2ZWwgPSBpOTE1LT53bS5tYXhfbGV2ZWw7Cj4gPiAgIAl3bS0+Y3hzciA9IHRydWU7
Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpIHsKPiA+ICsJ
Zm9yX2VhY2hfaW50ZWxfY3J0YygmaTkxNS0+ZHJtLCBjcnRjKSB7Cj4gPiAgIAkJY29uc3Qgc3Ry
dWN0IHZsdl93bV9zdGF0ZSAqd21fc3RhdGUgPSAmY3J0Yy0+d20uYWN0aXZlLnZsdjsKPiA+ICAg
CQlpZiAoIWNydGMtPmFjdGl2ZSkKPiA+IEBAIC0yMTIwLDcgKzIxMjAsNyBAQCBzdGF0aWMgdm9p
ZCB2bHZfbWVyZ2Vfd20oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
aWYgKG51bV9hY3RpdmVfY3J0Y3MgPiAxKQo+ID4gICAJCXdtLT5sZXZlbCA9IFZMVl9XTV9MRVZF
TF9QTTI7Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpIHsK
PiA+ICsJZm9yX2VhY2hfaW50ZWxfY3J0YygmaTkxNS0+ZHJtLCBjcnRjKSB7Cj4gPiAgIAkJY29u
c3Qgc3RydWN0IHZsdl93bV9zdGF0ZSAqd21fc3RhdGUgPSAmY3J0Yy0+d20uYWN0aXZlLnZsdjsK
PiA+ICAgCQllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiBAQCAtMjEzNSwzNSArMjEz
NSwzNSBAQCBzdGF0aWMgdm9pZCB2bHZfbWVyZ2Vfd20oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gICAJfQo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgdmx2X3Byb2dyYW1f
d2F0ZXJtYXJrcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGlj
IHZvaWQgdmx2X3Byb2dyYW1fd2F0ZXJtYXJrcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qgdmx2X3dtX3ZhbHVlcyAqb2xkX3dtID0gJmRldl9wcml2
LT53bS52bHY7Cj4gPiArCXN0cnVjdCB2bHZfd21fdmFsdWVzICpvbGRfd20gPSAmaTkxNS0+d20u
dmx2Owo+ID4gICAJc3RydWN0IHZsdl93bV92YWx1ZXMgbmV3X3dtID0ge307Cj4gPiAtCXZsdl9t
ZXJnZV93bShkZXZfcHJpdiwgJm5ld193bSk7Cj4gPiArCXZsdl9tZXJnZV93bShpOTE1LCAmbmV3
X3dtKTsKPiA+ICAgCWlmIChtZW1jbXAob2xkX3dtLCAmbmV3X3dtLCBzaXplb2YobmV3X3dtKSkg
PT0gMCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAlpZiAoaXNfZGlzYWJsaW5nKG9sZF93bS0+bGV2
ZWwsIG5ld193bS5sZXZlbCwgVkxWX1dNX0xFVkVMX0REUl9EVkZTKSkKPiA+IC0JCWNodl9zZXRf
bWVtb3J5X2R2ZnMoZGV2X3ByaXYsIGZhbHNlKTsKPiA+ICsJCWNodl9zZXRfbWVtb3J5X2R2ZnMo
aTkxNSwgZmFsc2UpOwo+ID4gICAJaWYgKGlzX2Rpc2FibGluZyhvbGRfd20tPmxldmVsLCBuZXdf
d20ubGV2ZWwsIFZMVl9XTV9MRVZFTF9QTTUpKQo+ID4gLQkJY2h2X3NldF9tZW1vcnlfcG01KGRl
dl9wcml2LCBmYWxzZSk7Cj4gPiArCQljaHZfc2V0X21lbW9yeV9wbTUoaTkxNSwgZmFsc2UpOwo+
ID4gICAJaWYgKGlzX2Rpc2FibGluZyhvbGRfd20tPmN4c3IsIG5ld193bS5jeHNyLCB0cnVlKSkK
PiA+IC0JCV9pbnRlbF9zZXRfbWVtb3J5X2N4c3IoZGV2X3ByaXYsIGZhbHNlKTsKPiA+ICsJCV9p
bnRlbF9zZXRfbWVtb3J5X2N4c3IoaTkxNSwgZmFsc2UpOwo+ID4gLQl2bHZfd3JpdGVfd21fdmFs
dWVzKGRldl9wcml2LCAmbmV3X3dtKTsKPiA+ICsJdmx2X3dyaXRlX3dtX3ZhbHVlcyhpOTE1LCAm
bmV3X3dtKTsKPiA+ICAgCWlmIChpc19lbmFibGluZyhvbGRfd20tPmN4c3IsIG5ld193bS5jeHNy
LCB0cnVlKSkKPiA+IC0JCV9pbnRlbF9zZXRfbWVtb3J5X2N4c3IoZGV2X3ByaXYsIHRydWUpOwo+
ID4gKwkJX2ludGVsX3NldF9tZW1vcnlfY3hzcihpOTE1LCB0cnVlKTsKPiA+ICAgCWlmIChpc19l
bmFibGluZyhvbGRfd20tPmxldmVsLCBuZXdfd20ubGV2ZWwsIFZMVl9XTV9MRVZFTF9QTTUpKQo+
ID4gLQkJY2h2X3NldF9tZW1vcnlfcG01KGRldl9wcml2LCB0cnVlKTsKPiA+ICsJCWNodl9zZXRf
bWVtb3J5X3BtNShpOTE1LCB0cnVlKTsKPiA+ICAgCWlmIChpc19lbmFibGluZyhvbGRfd20tPmxl
dmVsLCBuZXdfd20ubGV2ZWwsIFZMVl9XTV9MRVZFTF9ERFJfRFZGUykpCj4gPiAtCQljaHZfc2V0
X21lbW9yeV9kdmZzKGRldl9wcml2LCB0cnVlKTsKPiA+ICsJCWNodl9zZXRfbWVtb3J5X2R2ZnMo
aTkxNSwgdHJ1ZSk7Cj4gPiAgIAkqb2xkX3dtID0gbmV3X3dtOwo+ID4gICB9Cj4gPiBAQCAtMjE3
MSw0MCArMjE3MSw0MCBAQCBzdGF0aWMgdm9pZCB2bHZfcHJvZ3JhbV93YXRlcm1hcmtzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgc3RhdGljIHZvaWQgdmx2X2luaXRp
YWxfd2F0ZXJtYXJrcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPiA+ICAgCQkJ
CSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCW11dGV4
X2xvY2soJmRldl9wcml2LT53bS53bV9tdXRleCk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPndt
LndtX211dGV4KTsKPiA+ICAgCWNydGMtPndtLmFjdGl2ZS52bHYgPSBjcnRjX3N0YXRlLT53bS52
bHYuaW50ZXJtZWRpYXRlOwo+ID4gLQl2bHZfcHJvZ3JhbV93YXRlcm1hcmtzKGRldl9wcml2KTsK
PiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ID4gKwl2bHZfcHJv
Z3JhbV93YXRlcm1hcmtzKGk5MTUpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPndtLndtX211
dGV4KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCB2bHZfb3B0aW1pemVfd2F0ZXJtYXJrcyhz
dHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPiA+ICAgCQkJCSAgICBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUt
PmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0g
dG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gICAJaWYgKCFjcnRjX3N0
YXRlLT53bS5uZWVkX3Bvc3R2YmxfdXBkYXRlKQo+ID4gICAJCXJldHVybjsKPiA+IC0JbXV0ZXhf
bG9jaygmZGV2X3ByaXYtPndtLndtX211dGV4KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+d20u
d21fbXV0ZXgpOwo+ID4gICAJaW50ZWxfY3J0Yy0+d20uYWN0aXZlLnZsdiA9IGNydGNfc3RhdGUt
PndtLnZsdi5vcHRpbWFsOwo+ID4gLQl2bHZfcHJvZ3JhbV93YXRlcm1hcmtzKGRldl9wcml2KTsK
PiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ID4gKwl2bHZfcHJv
Z3JhbV93YXRlcm1hcmtzKGk5MTUpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPndtLndtX211
dGV4KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBpOTY1X3VwZGF0ZV93bShzdHJ1Y3QgaW50
ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNSh1bnVzZWRfY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUodW51c2VkX2NydGMtPmJhc2UuZGV2
KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ID4gICAJaW50IHNyd20gPSAxOwo+
ID4gICAJaW50IGN1cnNvcl9zciA9IDE2Owo+ID4gICAJYm9vbCBjeHNyX2VuYWJsZWQ7Cj4gPiAg
IAkvKiBDYWxjIHNyIGVudHJpZXMgZm9yIG9uZSBwbGFuZSBjb25maWdzICovCj4gPiAtCWNydGMg
PSBzaW5nbGVfZW5hYmxlZF9jcnRjKGRldl9wcml2KTsKPiA+ICsJY3J0YyA9IHNpbmdsZV9lbmFi
bGVkX2NydGMoaTkxNSk7Cj4gPiAgIAlpZiAoY3J0Yykgewo+ID4gICAJCS8qIHNlbGYtcmVmcmVz
aCBoYXMgbXVjaCBoaWdoZXIgbGF0ZW5jeSAqLwo+ID4gICAJCXN0YXRpYyBjb25zdCBpbnQgc3Jf
bGF0ZW5jeV9ucyA9IDEyMDAwOwo+ID4gQEAgLTIyNDYsNyArMjI0Niw3IEBAIHN0YXRpYyB2b2lk
IGk5NjVfdXBkYXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKPiA+ICAgCX0g
ZWxzZSB7Cj4gPiAgIAkJY3hzcl9lbmFibGVkID0gZmFsc2U7Cj4gPiAgIAkJLyogVHVybiBvZmYg
c2VsZiByZWZyZXNoIGlmIGJvdGggcGlwZXMgYXJlIGVuYWJsZWQgKi8KPiA+IC0JCWludGVsX3Nl
dF9tZW1vcnlfY3hzcihkZXZfcHJpdiwgZmFsc2UpOwo+ID4gKwkJaW50ZWxfc2V0X21lbW9yeV9j
eHNyKGk5MTUsIGZhbHNlKTsKPiA+ICAgCX0KPiA+ICAgCURSTV9ERUJVR19LTVMoIlNldHRpbmcg
RklGTyB3YXRlcm1hcmtzIC0gQTogOCwgQjogOCwgQzogOCwgU1IgJWRcbiIsCj4gPiBAQCAtMjI2
MywxNCArMjI2MywxNCBAQCBzdGF0aWMgdm9pZCBpOTY1X3VwZGF0ZV93bShzdHJ1Y3QgaW50ZWxf
Y3J0YyAqdW51c2VkX2NydGMpCj4gPiAgIAlJOTE1X1dSSVRFKERTUEZXMywgRldfV00oY3Vyc29y
X3NyLCBDVVJTT1JfU1IpKTsKPiA+ICAgCWlmIChjeHNyX2VuYWJsZWQpCj4gPiAtCQlpbnRlbF9z
ZXRfbWVtb3J5X2N4c3IoZGV2X3ByaXYsIHRydWUpOwo+ID4gKwkJaW50ZWxfc2V0X21lbW9yeV9j
eHNyKGk5MTUsIHRydWUpOwo+ID4gICB9Cj4gPiAgICN1bmRlZiBGV19XTQo+ID4gICBzdGF0aWMg
dm9pZCBpOXh4X3VwZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNSh1bnVz
ZWRfY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUodW51c2VkX2NydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpbnRl
bF93YXRlcm1hcmtfcGFyYW1zICp3bV9pbmZvOwo+ID4gICAJdTMyIGZ3YXRlcl9sbzsKPiA+ICAg
CXUzMiBmd2F0ZXJfaGk7Cj4gPiBAQCAtMjI3OSwxNSArMjI3OSwxNSBAQCBzdGF0aWMgdm9pZCBp
OXh4X3VwZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4gPiAgIAlpbnQg
cGxhbmVhX3dtLCBwbGFuZWJfd207Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywgKmVu
YWJsZWQgPSBOVUxMOwo+ID4gLQlpZiAoSVNfSTk0NUdNKGRldl9wcml2KSkKPiA+ICsJaWYgKElT
X0k5NDVHTShpOTE1KSkKPiA+ICAgCQl3bV9pbmZvID0gJmk5NDVfd21faW5mbzsKPiA+IC0JZWxz
ZSBpZiAoIUlTX0dFTihkZXZfcHJpdiwgMikpCj4gPiArCWVsc2UgaWYgKCFJU19HRU4oaTkxNSwg
MikpCj4gPiAgIAkJd21faW5mbyA9ICZpOTE1X3dtX2luZm87Cj4gPiAgIAllbHNlCj4gPiAgIAkJ
d21faW5mbyA9ICZpODMwX2Ffd21faW5mbzsKPiA+IC0JZmlmb19zaXplID0gZGV2X3ByaXYtPmRp
c3BsYXkuZ2V0X2ZpZm9fc2l6ZShkZXZfcHJpdiwgUExBTkVfQSk7Cj4gPiAtCWNydGMgPSBpbnRl
bF9nZXRfY3J0Y19mb3JfcGxhbmUoZGV2X3ByaXYsIFBMQU5FX0EpOwo+ID4gKwlmaWZvX3NpemUg
PSBpOTE1LT5kaXNwbGF5LmdldF9maWZvX3NpemUoaTkxNSwgUExBTkVfQSk7Cj4gPiArCWNydGMg
PSBpbnRlbF9nZXRfY3J0Y19mb3JfcGxhbmUoaTkxNSwgUExBTkVfQSk7Cj4gPiAgIAlpZiAoaW50
ZWxfY3J0Y19hY3RpdmUoY3J0YykpIHsKPiA+ICAgCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4gPiAgIAkJCSZjcnRjLT5jb25maWctPmJhc2UuYWRqdXN0
ZWRfbW9kZTsKPiA+IEBAIC0yMjk1LDcgKzIyOTUsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0
ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4gPiAgIAkJCWNydGMtPmJhc2Uu
cHJpbWFyeS0+c3RhdGUtPmZiOwo+ID4gICAJCWludCBjcHA7Cj4gPiAtCQlpZiAoSVNfR0VOKGRl
dl9wcml2LCAyKSkKPiA+ICsJCWlmIChJU19HRU4oaTkxNSwgMikpCj4gPiAgIAkJCWNwcCA9IDQ7
Cj4gPiAgIAkJZWxzZQo+ID4gICAJCQljcHAgPSBmYi0+Zm9ybWF0LT5jcHBbMF07Cj4gPiBAQCAt
MjMxMCwxMSArMjMxMCwxMSBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV93bShzdHJ1Y3QgaW50
ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4gPiAgIAkJCXBsYW5lYV93bSA9IHdtX2luZm8tPm1heF93
bTsKPiA+ICAgCX0KPiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgMikpCj4gPiArCWlmIChJU19H
RU4oaTkxNSwgMikpCj4gPiAgIAkJd21faW5mbyA9ICZpODMwX2JjX3dtX2luZm87Cj4gPiAtCWZp
Zm9fc2l6ZSA9IGRldl9wcml2LT5kaXNwbGF5LmdldF9maWZvX3NpemUoZGV2X3ByaXYsIFBMQU5F
X0IpOwo+ID4gLQljcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BsYW5lKGRldl9wcml2LCBQTEFO
RV9CKTsKPiA+ICsJZmlmb19zaXplID0gaTkxNS0+ZGlzcGxheS5nZXRfZmlmb19zaXplKGk5MTUs
IFBMQU5FX0IpOwo+ID4gKwljcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BsYW5lKGk5MTUsIFBM
QU5FX0IpOwo+ID4gICAJaWYgKGludGVsX2NydGNfYWN0aXZlKGNydGMpKSB7Cj4gPiAgIAkJY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+ID4gICAJCQkmY3J0
Yy0+Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gPiBAQCAtMjMyMiw3ICsyMzIyLDcgQEAg
c3RhdGljIHZvaWQgaTl4eF91cGRhdGVfd20oc3RydWN0IGludGVsX2NydGMgKnVudXNlZF9jcnRj
KQo+ID4gICAJCQljcnRjLT5iYXNlLnByaW1hcnktPnN0YXRlLT5mYjsKPiA+ICAgCQlpbnQgY3Bw
Owo+ID4gLQkJaWYgKElTX0dFTihkZXZfcHJpdiwgMikpCj4gPiArCQlpZiAoSVNfR0VOKGk5MTUs
IDIpKQo+ID4gICAJCQljcHAgPSA0Owo+ID4gICAJCWVsc2UKPiA+ICAgCQkJY3BwID0gZmItPmZv
cm1hdC0+Y3BwWzBdOwo+ID4gQEAgLTIzNDIsNyArMjM0Miw3IEBAIHN0YXRpYyB2b2lkIGk5eHhf
dXBkYXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKPiA+ICAgCURSTV9ERUJV
R19LTVMoIkZJRk8gd2F0ZXJtYXJrcyAtIEE6ICVkLCBCOiAlZFxuIiwgcGxhbmVhX3dtLCBwbGFu
ZWJfd20pOwo+ID4gLQlpZiAoSVNfSTkxNUdNKGRldl9wcml2KSAmJiBlbmFibGVkKSB7Cj4gPiAr
CWlmIChJU19JOTE1R00oaTkxNSkgJiYgZW5hYmxlZCkgewo+ID4gICAJCXN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmo7Cj4gPiAgIAkJb2JqID0gaW50ZWxfZmJfb2JqKGVuYWJsZWQtPmJh
c2UucHJpbWFyeS0+c3RhdGUtPmZiKTsKPiA+IEBAIC0yMzU4LDEwICsyMzU4LDEwIEBAIHN0YXRp
YyB2b2lkIGk5eHhfdXBkYXRlX3dtKHN0cnVjdCBpbnRlbF9jcnRjICp1bnVzZWRfY3J0YykKPiA+
ICAgCWN3bSA9IDI7Cj4gPiAgIAkvKiBQbGF5IHNhZmUgYW5kIGRpc2FibGUgc2VsZi1yZWZyZXNo
IGJlZm9yZSBhZGp1c3Rpbmcgd2F0ZXJtYXJrcy4gKi8KPiA+IC0JaW50ZWxfc2V0X21lbW9yeV9j
eHNyKGRldl9wcml2LCBmYWxzZSk7Cj4gPiArCWludGVsX3NldF9tZW1vcnlfY3hzcihpOTE1LCBm
YWxzZSk7Cj4gPiAgIAkvKiBDYWxjIHNyIGVudHJpZXMgZm9yIG9uZSBwbGFuZSBjb25maWdzICov
Cj4gPiAtCWlmIChIQVNfRldfQkxDKGRldl9wcml2KSAmJiBlbmFibGVkKSB7Cj4gPiArCWlmIChI
QVNfRldfQkxDKGk5MTUpICYmIGVuYWJsZWQpIHsKPiA+ICAgCQkvKiBzZWxmLXJlZnJlc2ggaGFz
IG11Y2ggaGlnaGVyIGxhdGVuY3kgKi8KPiA+ICAgCQlzdGF0aWMgY29uc3QgaW50IHNyX2xhdGVu
Y3lfbnMgPSA2MDAwOwo+ID4gICAJCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1
c3RlZF9tb2RlID0KPiA+IEBAIC0yMzc0LDcgKzIzNzQsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X3Vw
ZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4gPiAgIAkJaW50IGNwcDsK
PiA+ICAgCQlpbnQgZW50cmllczsKPiA+IC0JCWlmIChJU19JOTE1R00oZGV2X3ByaXYpIHx8IElT
X0k5NDVHTShkZXZfcHJpdikpCj4gPiArCQlpZiAoSVNfSTkxNUdNKGk5MTUpIHx8IElTX0k5NDVH
TShpOTE1KSkKPiA+ICAgCQkJY3BwID0gNDsKPiA+ICAgCQllbHNlCj4gPiAgIAkJCWNwcCA9IGZi
LT5mb3JtYXQtPmNwcFswXTsKPiA+IEBAIC0yMzg3LDcgKzIzODcsNyBAQCBzdGF0aWMgdm9pZCBp
OXh4X3VwZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4gPiAgIAkJaWYg
KHNyd20gPCAwKQo+ID4gICAJCQlzcndtID0gMTsKPiA+IC0JCWlmIChJU19JOTQ1RyhkZXZfcHJp
dikgfHwgSVNfSTk0NUdNKGRldl9wcml2KSkKPiA+ICsJCWlmIChJU19JOTQ1RyhpOTE1KSB8fCBJ
U19JOTQ1R00oaTkxNSkpCj4gPiAgIAkJCUk5MTVfV1JJVEUoRldfQkxDX1NFTEYsCj4gPiAgIAkJ
CQkgICBGV19CTENfU0VMRl9GSUZPX01BU0sgfCAoc3J3bSAmIDB4ZmYpKTsKPiA+ICAgCQllbHNl
Cj4gPiBAQCAtMjQwOCwyNSArMjQwOCwyNSBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV93bShz
dHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4gPiAgIAlJOTE1X1dSSVRFKEZXX0JMQzIs
IGZ3YXRlcl9oaSk7Cj4gPiAgIAlpZiAoZW5hYmxlZCkKPiA+IC0JCWludGVsX3NldF9tZW1vcnlf
Y3hzcihkZXZfcHJpdiwgdHJ1ZSk7Cj4gPiArCQlpbnRlbF9zZXRfbWVtb3J5X2N4c3IoaTkxNSwg
dHJ1ZSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgaTg0NV91cGRhdGVfd20oc3RydWN0IGlu
dGVsX2NydGMgKnVudXNlZF9jcnRjKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUodW51c2VkX2NydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHVudXNlZF9jcnRjLT5iYXNlLmRl
dik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiA+ICAgCWNvbnN0IHN0cnVjdCBk
cm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlOwo+ID4gICAJdTMyIGZ3YXRlcl9sbzsKPiA+
ICAgCWludCBwbGFuZWFfd207Cj4gPiAtCWNydGMgPSBzaW5nbGVfZW5hYmxlZF9jcnRjKGRldl9w
cml2KTsKPiA+ICsJY3J0YyA9IHNpbmdsZV9lbmFibGVkX2NydGMoaTkxNSk7Cj4gPiAgIAlpZiAo
Y3J0YyA9PSBOVUxMKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCWFkanVzdGVkX21vZGUgPSAmY3J0
Yy0+Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gPiAgIAlwbGFuZWFfd20gPSBpbnRlbF9j
YWxjdWxhdGVfd20oYWRqdXN0ZWRfbW9kZS0+Y3J0Y19jbG9jaywKPiA+ICAgCQkJCSAgICAgICAm
aTg0NV93bV9pbmZvLAo+ID4gLQkJCQkgICAgICAgZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2ZpZm9f
c2l6ZShkZXZfcHJpdiwgUExBTkVfQSksCj4gPiArCQkJCSAgICAgICBpOTE1LT5kaXNwbGF5Lmdl
dF9maWZvX3NpemUoaTkxNSwgUExBTkVfQSksCj4gPiAgIAkJCQkgICAgICAgNCwgcGVzc2ltYWxf
bGF0ZW5jeV9ucyk7Cj4gPiAgIAlmd2F0ZXJfbG8gPSBJOTE1X1JFQUQoRldfQkxDKSAmIH4weGZm
ZjsKPiA+ICAgCWZ3YXRlcl9sbyB8PSAoMzw8OCkgfCBwbGFuZWFfd207Cj4gPiBAQCAtMjU4Niwy
NCArMjU4NiwyNCBAQCBzdGF0aWMgdTMyIGlsa19jb21wdXRlX2ZiY193bShjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ID4gICB9Cj4gPiAgIHN0YXRpYyB1bnNpZ25lZCBp
bnQKPiA+IC1pbGtfZGlzcGxheV9maWZvX3NpemUoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gK2lsa19kaXNwbGF5X2ZpZm9fc2l6ZShjb25zdCBzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSA4KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpCj4gPiAgIAkJcmV0dXJuIDMw
NzI7Cj4gPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykKPiA+ICsJZWxzZSBp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDcpCj4gPiAgIAkJcmV0dXJuIDc2ODsKPiA+ICAgCWVsc2UK
PiA+ICAgCQlyZXR1cm4gNTEyOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB1bnNpZ25lZCBpbnQKPiA+
IC1pbGtfcGxhbmVfd21fcmVnX21heChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAraWxrX3BsYW5lX3dtX3JlZ19tYXgoY29uc3Qgc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICBpbnQgbGV2ZWwsIGJvb2wgaXNfc3ByaXRlKQo+ID4g
ICB7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpCj4gPiArCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gOCkKPiA+ICAgCQkvKiBCRFcgcHJpbWFyeS9zcHJpdGUgcGxhbmUgd2F0ZXJt
YXJrcyAqLwo+ID4gICAJCXJldHVybiBsZXZlbCA9PSAwID8gMjU1IDogMjA0NzsKPiA+IC0JZWxz
ZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA3KQo+ID4gKwllbHNlIGlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gNykKPiA+ICAgCQkvKiBJVkIvSFNXIHByaW1hcnkvc3ByaXRlIHBsYW5lIHdhdGVy
bWFya3MgKi8KPiA+ICAgCQlyZXR1cm4gbGV2ZWwgPT0gMCA/IDEyNyA6IDEwMjM7Cj4gPiAgIAll
bHNlIGlmICghaXNfc3ByaXRlKQo+ID4gQEAgLTI2MTUsMzAgKzI2MTUsMzAgQEAgaWxrX3BsYW5l
X3dtX3JlZ19tYXgoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
ICB9Cj4gPiAgIHN0YXRpYyB1bnNpZ25lZCBpbnQKPiA+IC1pbGtfY3Vyc29yX3dtX3JlZ19tYXgo
Y29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgbGV2ZWwpCj4gPiAr
aWxrX2N1cnNvcl93bV9yZWdfbWF4KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LCBpbnQgbGV2ZWwpCj4gPiAgIHsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNykK
PiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA3KQo+ID4gICAJCXJldHVybiBsZXZlbCA9PSAw
ID8gNjMgOiAyNTU7Cj4gPiAgIAllbHNlCj4gPiAgIAkJcmV0dXJuIGxldmVsID09IDAgPyAzMSA6
IDYzOwo+ID4gICB9Cj4gPiAtc3RhdGljIHVuc2lnbmVkIGludCBpbGtfZmJjX3dtX3JlZ19tYXgo
Y29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB1bnNp
Z25lZCBpbnQgaWxrX2ZiY193bV9yZWdfbWF4KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ID4gICB7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpCj4gPiAr
CWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkKPiA+ICAgCQlyZXR1cm4gMzE7Cj4gPiAgIAllbHNl
Cj4gPiAgIAkJcmV0dXJuIDE1Owo+ID4gICB9Cj4gPiAgIC8qIENhbGN1bGF0ZSB0aGUgbWF4aW11
bSBwcmltYXJ5L3Nwcml0ZSBwbGFuZSB3YXRlcm1hcmsgKi8KPiA+IC1zdGF0aWMgdW5zaWduZWQg
aW50IGlsa19wbGFuZV93bV9tYXgoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK3N0YXRpYyB1bnNpZ25lZCBpbnQgaWxrX3BsYW5lX3dtX21heChjb25zdCBzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgaW50IGxldmVsLAo+ID4g
ICAJCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfd21fY29uZmlnICpjb25maWcsCj4gPiAgIAkJ
CQkgICAgIGVudW0gaW50ZWxfZGRiX3BhcnRpdGlvbmluZyBkZGJfcGFydGl0aW9uaW5nLAo+ID4g
ICAJCQkJICAgICBib29sIGlzX3Nwcml0ZSkKPiA+ICAgewo+ID4gLQl1bnNpZ25lZCBpbnQgZmlm
b19zaXplID0gaWxrX2Rpc3BsYXlfZmlmb19zaXplKGRldl9wcml2KTsKPiA+ICsJdW5zaWduZWQg
aW50IGZpZm9fc2l6ZSA9IGlsa19kaXNwbGF5X2ZpZm9fc2l6ZShpOTE1KTsKPiA+ICAgCS8qIGlm
IHNwcml0ZXMgYXJlbid0IGVuYWJsZWQsIHNwcml0ZXMgZ2V0IG5vdGhpbmcgKi8KPiA+ICAgCWlm
IChpc19zcHJpdGUgJiYgIWNvbmZpZy0+c3ByaXRlc19lbmFibGVkKQo+ID4gQEAgLTI2NDYsMTQg
KzI2NDYsMTQgQEAgc3RhdGljIHVuc2lnbmVkIGludCBpbGtfcGxhbmVfd21fbWF4KGNvbnN0IHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCS8qIEhTVyBhbGxvd3MgTFAx
KyB3YXRlcm1hcmtzIGV2ZW4gd2l0aCBtdWx0aXBsZSBwaXBlcyAqLwo+ID4gICAJaWYgKGxldmVs
ID09IDAgfHwgY29uZmlnLT5udW1fcGlwZXNfYWN0aXZlID4gMSkgewo+ID4gLQkJZmlmb19zaXpl
IC89IElOVEVMX0lORk8oZGV2X3ByaXYpLT5udW1fcGlwZXM7Cj4gPiArCQlmaWZvX3NpemUgLz0g
SU5URUxfSU5GTyhpOTE1KS0+bnVtX3BpcGVzOwo+ID4gICAJCS8qCj4gPiAgIAkJICogRm9yIHNv
bWUgcmVhc29uIHRoZSBub24gc2VsZiByZWZyZXNoCj4gPiAgIAkJICogRklGTyBzaXplIGlzIG9u
bHkgaGFsZiBvZiB0aGUgc2VsZgo+ID4gICAJCSAqIHJlZnJlc2ggRklGTyBzaXplIG9uIElMSy9T
TkIuCj4gPiAgIAkJICovCj4gPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8PSA2KQo+ID4g
KwkJaWYgKElOVEVMX0dFTihpOTE1KSA8PSA2KQo+ID4gICAJCQlmaWZvX3NpemUgLz0gMjsKPiA+
ICAgCX0KPiA+IEBAIC0yNjY5LDExICsyNjY5LDExIEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgaWxr
X3BsYW5lX3dtX21heChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4g
PiAgIAl9Cj4gPiAgIAkvKiBjbGFtcCB0byBtYXggdGhhdCB0aGUgcmVnaXN0ZXJzIGNhbiBob2xk
ICovCj4gPiAtCXJldHVybiBtaW4oZmlmb19zaXplLCBpbGtfcGxhbmVfd21fcmVnX21heChkZXZf
cHJpdiwgbGV2ZWwsIGlzX3Nwcml0ZSkpOwo+ID4gKwlyZXR1cm4gbWluKGZpZm9fc2l6ZSwgaWxr
X3BsYW5lX3dtX3JlZ19tYXgoaTkxNSwgbGV2ZWwsIGlzX3Nwcml0ZSkpOwo+ID4gICB9Cj4gPiAg
IC8qIENhbGN1bGF0ZSB0aGUgbWF4aW11bSBjdXJzb3IgcGxhbmUgd2F0ZXJtYXJrICovCj4gPiAt
c3RhdGljIHVuc2lnbmVkIGludCBpbGtfY3Vyc29yX3dtX21heChjb25zdCBzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHVuc2lnbmVkIGludCBpbGtfY3Vyc29y
X3dtX21heChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAg
ICAgIGludCBsZXZlbCwKPiA+ICAgCQkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF93bV9jb25m
aWcgKmNvbmZpZykKPiA+ICAgewo+ID4gQEAgLTI2ODIsMjkgKzI2ODIsMjkgQEAgc3RhdGljIHVu
c2lnbmVkIGludCBpbGtfY3Vyc29yX3dtX21heChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiAgIAkJcmV0dXJuIDY0Owo+ID4gICAJLyogb3RoZXJ3aXNlIGp1c3Qg
cmVwb3J0IG1heCB0aGF0IHJlZ2lzdGVycyBjYW4gaG9sZCAqLwo+ID4gLQlyZXR1cm4gaWxrX2N1
cnNvcl93bV9yZWdfbWF4KGRldl9wcml2LCBsZXZlbCk7Cj4gPiArCXJldHVybiBpbGtfY3Vyc29y
X3dtX3JlZ19tYXgoaTkxNSwgbGV2ZWwpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaWxrX2Nv
bXB1dGVfd21fbWF4aW11bXMoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAo+ID4gK3N0YXRpYyB2b2lkIGlsa19jb21wdXRlX3dtX21heGltdW1zKGNvbnN0IHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgIGludCBsZXZlbCwKPiA+ICAgCQkJ
CSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfd21fY29uZmlnICpjb25maWcsCj4gPiAgIAkJCQkgICAg
ZW51bSBpbnRlbF9kZGJfcGFydGl0aW9uaW5nIGRkYl9wYXJ0aXRpb25pbmcsCj4gPiAgIAkJCQkg
ICAgc3RydWN0IGlsa193bV9tYXhpbXVtcyAqbWF4KQo+ID4gICB7Cj4gPiAtCW1heC0+cHJpID0g
aWxrX3BsYW5lX3dtX21heChkZXZfcHJpdiwgbGV2ZWwsIGNvbmZpZywgZGRiX3BhcnRpdGlvbmlu
ZywgZmFsc2UpOwo+ID4gLQltYXgtPnNwciA9IGlsa19wbGFuZV93bV9tYXgoZGV2X3ByaXYsIGxl
dmVsLCBjb25maWcsIGRkYl9wYXJ0aXRpb25pbmcsIHRydWUpOwo+ID4gLQltYXgtPmN1ciA9IGls
a19jdXJzb3Jfd21fbWF4KGRldl9wcml2LCBsZXZlbCwgY29uZmlnKTsKPiA+IC0JbWF4LT5mYmMg
PSBpbGtfZmJjX3dtX3JlZ19tYXgoZGV2X3ByaXYpOwo+ID4gKwltYXgtPnByaSA9IGlsa19wbGFu
ZV93bV9tYXgoaTkxNSwgbGV2ZWwsIGNvbmZpZywgZGRiX3BhcnRpdGlvbmluZywgZmFsc2UpOwo+
ID4gKwltYXgtPnNwciA9IGlsa19wbGFuZV93bV9tYXgoaTkxNSwgbGV2ZWwsIGNvbmZpZywgZGRi
X3BhcnRpdGlvbmluZywgdHJ1ZSk7Cj4gPiArCW1heC0+Y3VyID0gaWxrX2N1cnNvcl93bV9tYXgo
aTkxNSwgbGV2ZWwsIGNvbmZpZyk7Cj4gPiArCW1heC0+ZmJjID0gaWxrX2ZiY193bV9yZWdfbWF4
KGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaWxrX2NvbXB1dGVfd21fcmVnX21heGlt
dW1zKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMg
dm9pZCBpbGtfY29tcHV0ZV93bV9yZWdfbWF4aW11bXMoY29uc3Qgc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkJaW50IGxldmVsLAo+ID4gICAJCQkJCXN0cnVjdCBpbGtf
d21fbWF4aW11bXMgKm1heCkKPiA+ICAgewo+ID4gLQltYXgtPnByaSA9IGlsa19wbGFuZV93bV9y
ZWdfbWF4KGRldl9wcml2LCBsZXZlbCwgZmFsc2UpOwo+ID4gLQltYXgtPnNwciA9IGlsa19wbGFu
ZV93bV9yZWdfbWF4KGRldl9wcml2LCBsZXZlbCwgdHJ1ZSk7Cj4gPiAtCW1heC0+Y3VyID0gaWxr
X2N1cnNvcl93bV9yZWdfbWF4KGRldl9wcml2LCBsZXZlbCk7Cj4gPiAtCW1heC0+ZmJjID0gaWxr
X2ZiY193bV9yZWdfbWF4KGRldl9wcml2KTsKPiA+ICsJbWF4LT5wcmkgPSBpbGtfcGxhbmVfd21f
cmVnX21heChpOTE1LCBsZXZlbCwgZmFsc2UpOwo+ID4gKwltYXgtPnNwciA9IGlsa19wbGFuZV93
bV9yZWdfbWF4KGk5MTUsIGxldmVsLCB0cnVlKTsKPiA+ICsJbWF4LT5jdXIgPSBpbGtfY3Vyc29y
X3dtX3JlZ19tYXgoaTkxNSwgbGV2ZWwpOwo+ID4gKwltYXgtPmZiYyA9IGlsa19mYmNfd21fcmVn
X21heChpOTE1KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgYm9vbCBpbGtfdmFsaWRhdGVfd21fbGV2
ZWwoaW50IGxldmVsLAo+ID4gQEAgLTI3NDgsNyArMjc0OCw3IEBAIHN0YXRpYyBib29sIGlsa192
YWxpZGF0ZV93bV9sZXZlbChpbnQgbGV2ZWwsCj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4g
PiAtc3RhdGljIHZvaWQgaWxrX2NvbXB1dGVfd21fbGV2ZWwoY29uc3Qgc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGlsa19jb21wdXRlX3dtX2xldmVs
KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJIGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAo+ID4gICAJCQkJIGludCBsZXZlbCwKPiA+ICAg
CQkJCSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ID4gQEAgLTI3NTcsOSArMjc1
Nyw5IEBAIHN0YXRpYyB2b2lkIGlsa19jb21wdXRlX3dtX2xldmVsKGNvbnN0IHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxh
bmVfc3RhdGUgKmN1cnN0YXRlLAo+ID4gICAJCQkJIHN0cnVjdCBpbnRlbF93bV9sZXZlbCAqcmVz
dWx0KQo+ID4gICB7Cj4gPiAtCXUxNiBwcmlfbGF0ZW5jeSA9IGRldl9wcml2LT53bS5wcmlfbGF0
ZW5jeVtsZXZlbF07Cj4gPiAtCXUxNiBzcHJfbGF0ZW5jeSA9IGRldl9wcml2LT53bS5zcHJfbGF0
ZW5jeVtsZXZlbF07Cj4gPiAtCXUxNiBjdXJfbGF0ZW5jeSA9IGRldl9wcml2LT53bS5jdXJfbGF0
ZW5jeVtsZXZlbF07Cj4gPiArCXUxNiBwcmlfbGF0ZW5jeSA9IGk5MTUtPndtLnByaV9sYXRlbmN5
W2xldmVsXTsKPiA+ICsJdTE2IHNwcl9sYXRlbmN5ID0gaTkxNS0+d20uc3ByX2xhdGVuY3lbbGV2
ZWxdOwo+ID4gKwl1MTYgY3VyX2xhdGVuY3kgPSBpOTE1LT53bS5jdXJfbGF0ZW5jeVtsZXZlbF07
Cj4gPiAgIAkvKiBXTTErIGxhdGVuY3kgdmFsdWVzIHN0b3JlZCBpbiAwLjV1cyB1bml0cyAqLwo+
ID4gICAJaWYgKGxldmVsID4gMCkgewo+ID4gQEAgLTI4MTEsMTkgKzI4MTEsMTkgQEAgaHN3X2Nv
bXB1dGVfbGluZXRpbWVfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSkK
PiA+ICAgCSAgICAgICBQSVBFX1dNX0xJTkVUSU1FX1RJTUUobGluZXRpbWUpOwo+ID4gICB9Cj4g
PiAtc3RhdGljIHZvaWQgaW50ZWxfcmVhZF93bV9sYXRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9yZWFkX3dtX2xhdGVuY3koc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgIHUxNiB3bVs4XSkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsK
PiA+ICsJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKPiA+IC0J
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDkpIHsKPiA+ICAgCQl1MzIgdmFsOwo+ID4gICAJCWludCByZXQsIGk7Cj4gPiAtCQlpbnQg
bGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYpOwo+ID4gKwkJaW50
IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGk5MTUpOwo+ID4gICAJCS8qIHJl
YWQgdGhlIGZpcnN0IHNldCBvZiBtZW1vcnkgbGF0ZW5jaWVzWzA6M10gKi8KPiA+ICAgCQl2YWwg
PSAwOyAvKiBkYXRhMCB0byBiZSBwcm9ncmFtbWVkIHRvIDAgZm9yIGZpcnN0IHNldCAqLwo+ID4g
LQkJcmV0ID0gc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChkZXZfcHJpdiwKPiA+ICsJCXJldCA9IHNh
bmR5YnJpZGdlX3Bjb2RlX3JlYWQoaTkxNSwKPiA+ICAgCQkJCQkgICAgIEdFTjlfUENPREVfUkVB
RF9NRU1fTEFURU5DWSwKPiA+ICAgCQkJCQkgICAgICZ2YWwsIE5VTEwpOwo+ID4gQEAgLTI4NDIs
NyArMjg0Miw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3JlYWRfd21fbGF0ZW5jeShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJLyogcmVhZCB0aGUgc2Vjb25kIHNldCBv
ZiBtZW1vcnkgbGF0ZW5jaWVzWzQ6N10gKi8KPiA+ICAgCQl2YWwgPSAxOyAvKiBkYXRhMCB0byBi
ZSBwcm9ncmFtbWVkIHRvIDEgZm9yIHNlY29uZCBzZXQgKi8KPiA+IC0JCXJldCA9IHNhbmR5YnJp
ZGdlX3Bjb2RlX3JlYWQoZGV2X3ByaXYsCj4gPiArCQlyZXQgPSBzYW5keWJyaWRnZV9wY29kZV9y
ZWFkKGk5MTUsCj4gPiAgIAkJCQkJICAgICBHRU45X1BDT0RFX1JFQURfTUVNX0xBVEVOQ1ksCj4g
PiAgIAkJCQkJICAgICAmdmFsLCBOVUxMKTsKPiA+ICAgCQlpZiAocmV0KSB7Cj4gPiBAQCAtMjg5
MywxMCArMjg5MywxMCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9yZWFkX3dtX2xhdGVuY3koc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCSAqIGFueSB1bmRlcnJ1bi4gSWYg
bm90IGFibGUgdG8gZ2V0IERpbW0gaW5mbyBhc3N1bWUgMTZHQiBkaW1tCj4gPiAgIAkJICogdG8g
YXZvaWQgYW55IHVuZGVycnVuLgo+ID4gICAJCSAqLwo+ID4gLQkJaWYgKGRldl9wcml2LT5kcmFt
X2luZm8uaXNfMTZnYl9kaW1tKQo+ID4gKwkJaWYgKGk5MTUtPmRyYW1faW5mby5pc18xNmdiX2Rp
bW0pCj4gPiAgIAkJCXdtWzBdICs9IDE7Cj4gPiAtCX0gZWxzZSBpZiAoSVNfSEFTV0VMTChkZXZf
cHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0hB
U1dFTEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gPiAgIAkJdTY0IHNza3BkID0g
aW50ZWxfdW5jb3JlX3JlYWQ2NCh1bmNvcmUsIE1DSF9TU0tQRCk7Cj4gPiAgIAkJd21bMF0gPSAo
c3NrcGQgPj4gNTYpICYgMHhGRjsKPiA+IEBAIC0yOTA2LDE0ICsyOTA2LDE0IEBAIHN0YXRpYyB2
b2lkIGludGVsX3JlYWRfd21fbGF0ZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAgIAkJd21bMl0gPSAoc3NrcGQgPj4gMTIpICYgMHhGRjsKPiA+ICAgCQl3bVszXSA9
IChzc2twZCA+PiAyMCkgJiAweDFGRjsKPiA+ICAgCQl3bVs0XSA9IChzc2twZCA+PiAzMikgJiAw
eDFGRjsKPiA+IC0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpIHsKPiA+ICsJ
fSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikgewo+ID4gICAJCXUzMiBzc2twZCA9IGlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgTUNIX1NTS1BEKTsKPiA+ICAgCQl3bVswXSA9IChzc2tw
ZCA+PiBTU0tQRF9XTTBfU0hJRlQpICYgU1NLUERfV01fTUFTSzsKPiA+ICAgCQl3bVsxXSA9IChz
c2twZCA+PiBTU0tQRF9XTTFfU0hJRlQpICYgU1NLUERfV01fTUFTSzsKPiA+ICAgCQl3bVsyXSA9
IChzc2twZCA+PiBTU0tQRF9XTTJfU0hJRlQpICYgU1NLUERfV01fTUFTSzsKPiA+ICAgCQl3bVsz
XSA9IChzc2twZCA+PiBTU0tQRF9XTTNfU0hJRlQpICYgU1NLUERfV01fTUFTSzsKPiA+IC0JfSBl
bHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDUpIHsKPiA+ICsJfSBlbHNlIGlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gNSkgewo+ID4gICAJCXUzMiBtbHRyID0gaW50ZWxfdW5jb3JlX3JlYWQo
dW5jb3JlLCBNTFRSX0lMSyk7Cj4gPiAgIAkJLyogSUxLIHByaW1hcnkgTFAwIGxhdGVuY3kgaXMg
NzAwIG5zICovCj4gPiBAQCAtMjkyMSw0NCArMjkyMSw0NCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9y
ZWFkX3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
CXdtWzFdID0gKG1sdHIgPj4gTUxUUl9XTTFfU0hJRlQpICYgSUxLX1NSTFRfTUFTSzsKPiA+ICAg
CQl3bVsyXSA9IChtbHRyID4+IE1MVFJfV00yX1NISUZUKSAmIElMS19TUkxUX01BU0s7Cj4gPiAg
IAl9IGVsc2Ugewo+ID4gLQkJTUlTU0lOR19DQVNFKElOVEVMX0RFVklEKGRldl9wcml2KSk7Cj4g
PiArCQlNSVNTSU5HX0NBU0UoSU5URUxfREVWSUQoaTkxNSkpOwo+ID4gICAJfQo+ID4gICB9Cj4g
PiAtc3RhdGljIHZvaWQgaW50ZWxfZml4dXBfc3ByX3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGludGVsX2ZpeHVwX3Nwcl93bV9s
YXRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgIHUx
NiB3bVs1XSkKPiA+ICAgewo+ID4gICAJLyogSUxLIHNwcml0ZSBMUDAgbGF0ZW5jeSBpcyAxMzAw
IG5zICovCj4gPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDUpKQo+ID4gKwlpZiAoSVNfR0VOKGk5
MTUsIDUpKQo+ID4gICAJCXdtWzBdID0gMTM7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRl
bF9maXh1cF9jdXJfd21fbGF0ZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiArc3RhdGljIHZvaWQgaW50ZWxfZml4dXBfY3VyX3dtX2xhdGVuY3koc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICAgICAgdTE2IHdtWzVdKQo+ID4gICB7Cj4g
PiAgIAkvKiBJTEsgY3Vyc29yIExQMCBsYXRlbmN5IGlzIDEzMDAgbnMgKi8KPiA+IC0JaWYgKElT
X0dFTihkZXZfcHJpdiwgNSkpCj4gPiArCWlmIChJU19HRU4oaTkxNSwgNSkpCj4gPiAgIAkJd21b
MF0gPSAxMzsKPiA+ICAgfQo+ID4gLWludCBpbGtfd21fbWF4X2xldmVsKGNvbnN0IHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtpbnQgaWxrX3dtX21heF9sZXZlbChjb25z
dCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJLyogaG93IG1h
bnkgV00gbGV2ZWxzIGFyZSB3ZSBleHBlY3RpbmcgKi8KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPj0gOSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gICAJCXJldHVy
biA3Owo+ID4gLQllbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwo
ZGV2X3ByaXYpKQo+ID4gKwllbHNlIGlmIChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VM
TChpOTE1KSkKPiA+ICAgCQlyZXR1cm4gNDsKPiA+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA2KQo+ID4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKPiA+ICAgCQly
ZXR1cm4gMzsKPiA+ICAgCWVsc2UKPiA+ICAgCQlyZXR1cm4gMjsKPiA+ICAgfQo+ID4gLXN0YXRp
YyB2b2lkIGludGVsX3ByaW50X3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIGludGVsX3ByaW50X3dtX2xhdGVuY3koc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICBjb25zdCBjaGFyICpuYW1lLAo+ID4g
ICAJCQkJICAgY29uc3QgdTE2IHdtWzhdKQo+ID4gICB7Cj4gPiAtCWludCBsZXZlbCwgbWF4X2xl
dmVsID0gaWxrX3dtX21heF9sZXZlbChkZXZfcHJpdik7Cj4gPiArCWludCBsZXZlbCwgbWF4X2xl
dmVsID0gaWxrX3dtX21heF9sZXZlbChpOTE1KTsKPiA+ICAgCWZvciAobGV2ZWwgPSAwOyBsZXZl
bCA8PSBtYXhfbGV2ZWw7IGxldmVsKyspIHsKPiA+ICAgCQl1bnNpZ25lZCBpbnQgbGF0ZW5jeSA9
IHdtW2xldmVsXTsKPiA+IEBAIC0yOTczLDcgKzI5NzMsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9w
cmludF93bV9sYXRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAg
CQkgKiAtIGxhdGVuY2llcyBhcmUgaW4gdXMgb24gZ2VuOS4KPiA+ICAgCQkgKiAtIGJlZm9yZSB0
aGVuLCBXTTErIGxhdGVuY3kgdmFsdWVzIGFyZSBpbiAwLjV1cyB1bml0cwo+ID4gICAJCSAqLwo+
ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiA+ICsJCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gOSkKPiA+ICAgCQkJbGF0ZW5jeSAqPSAxMDsKPiA+ICAgCQllbHNlIGlmIChsZXZl
bCA+IDApCj4gPiAgIAkJCWxhdGVuY3kgKj0gNTsKPiA+IEBAIC0yOTg0LDEwICsyOTg0LDEwIEBA
IHN0YXRpYyB2b2lkIGludGVsX3ByaW50X3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gICAJfQo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wgaWxrX2luY3Jl
YXNlX3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0
YXRpYyBib29sIGlsa19pbmNyZWFzZV93bV9sYXRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ID4gICAJCQkJICAgIHUxNiB3bVs1XSwgdTE2IG1pbikKPiA+ICAgewo+ID4gLQlp
bnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYpOwo+ID4gKwlp
bnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoaTkxNSk7Cj4gPiAgIAlpZiAo
d21bMF0gPj0gbWluKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IEBAIC0yOTk5LDcgKzI5OTks
NyBAQCBzdGF0aWMgYm9vbCBpbGtfaW5jcmVhc2Vfd21fbGF0ZW5jeShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXR1cm4gdHJ1ZTsKPiA+ICAgfQo+ID4gLXN0YXRp
YyB2b2lkIHNuYl93bV9sYXRlbmN5X3F1aXJrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtzdGF0aWMgdm9pZCBzbmJfd21fbGF0ZW5jeV9xdWlyayhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJYm9vbCBjaGFuZ2VkOwo+ID4gQEAgLTMw
MDcsMjAgKzMwMDcsMjAgQEAgc3RhdGljIHZvaWQgc25iX3dtX2xhdGVuY3lfcXVpcmsoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICogVGhlIEJJT1MgcHJvdmlkZWQg
V00gbWVtb3J5IGxhdGVuY3kgdmFsdWVzIGFyZSBvZnRlbgo+ID4gICAJICogaW5hZGVxdWF0ZSBm
b3IgaGlnaCByZXNvbHV0aW9uIGRpc3BsYXlzLiBBZGp1c3QgdGhlbS4KPiA+ICAgCSAqLwo+ID4g
LQljaGFuZ2VkID0gaWxrX2luY3JlYXNlX3dtX2xhdGVuY3koZGV2X3ByaXYsIGRldl9wcml2LT53
bS5wcmlfbGF0ZW5jeSwgMTIpIHwKPiA+IC0JCWlsa19pbmNyZWFzZV93bV9sYXRlbmN5KGRldl9w
cml2LCBkZXZfcHJpdi0+d20uc3ByX2xhdGVuY3ksIDEyKSB8Cj4gPiAtCQlpbGtfaW5jcmVhc2Vf
d21fbGF0ZW5jeShkZXZfcHJpdiwgZGV2X3ByaXYtPndtLmN1cl9sYXRlbmN5LCAxMik7Cj4gPiAr
CWNoYW5nZWQgPSBpbGtfaW5jcmVhc2Vfd21fbGF0ZW5jeShpOTE1LCBpOTE1LT53bS5wcmlfbGF0
ZW5jeSwgMTIpIHwKPiA+ICsJCWlsa19pbmNyZWFzZV93bV9sYXRlbmN5KGk5MTUsIGk5MTUtPndt
LnNwcl9sYXRlbmN5LCAxMikgfAo+ID4gKwkJaWxrX2luY3JlYXNlX3dtX2xhdGVuY3koaTkxNSwg
aTkxNS0+d20uY3VyX2xhdGVuY3ksIDEyKTsKPiA+ICAgCWlmICghY2hhbmdlZCkKPiA+ICAgCQly
ZXR1cm47Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJXTSBsYXRlbmN5IHZhbHVlcyBpbmNyZWFzZWQg
dG8gYXZvaWQgcG90ZW50aWFsIHVuZGVycnVuc1xuIik7Cj4gPiAtCWludGVsX3ByaW50X3dtX2xh
dGVuY3koZGV2X3ByaXYsICJQcmltYXJ5IiwgZGV2X3ByaXYtPndtLnByaV9sYXRlbmN5KTsKPiA+
IC0JaW50ZWxfcHJpbnRfd21fbGF0ZW5jeShkZXZfcHJpdiwgIlNwcml0ZSIsIGRldl9wcml2LT53
bS5zcHJfbGF0ZW5jeSk7Cj4gPiAtCWludGVsX3ByaW50X3dtX2xhdGVuY3koZGV2X3ByaXYsICJD
dXJzb3IiLCBkZXZfcHJpdi0+d20uY3VyX2xhdGVuY3kpOwo+ID4gKwlpbnRlbF9wcmludF93bV9s
YXRlbmN5KGk5MTUsICJQcmltYXJ5IiwgaTkxNS0+d20ucHJpX2xhdGVuY3kpOwo+ID4gKwlpbnRl
bF9wcmludF93bV9sYXRlbmN5KGk5MTUsICJTcHJpdGUiLCBpOTE1LT53bS5zcHJfbGF0ZW5jeSk7
Cj4gPiArCWludGVsX3ByaW50X3dtX2xhdGVuY3koaTkxNSwgIkN1cnNvciIsIGk5MTUtPndtLmN1
cl9sYXRlbmN5KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHNuYl93bV9scDNfaXJxX3F1aXJr
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBzbmJf
d21fbHAzX2lycV9xdWlyayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+
ID4gICAJLyoKPiA+ICAgCSAqIE9uIHNvbWUgU05CIG1hY2hpbmVzIChUaGlua3BhZCBYMjIwIFRh
YmxldCBhdCBsZWFzdCkKPiA+IEBAIC0zMDMzLDUwICszMDMzLDUwIEBAIHN0YXRpYyB2b2lkIHNu
Yl93bV9scDNfaXJxX3F1aXJrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCSAqIGludGVycnVwdHMgb25seS4gVG8gcGxheSBpdCBzYWZlIHdlIGRpc2FibGUgTFAzCj4g
PiAgIAkgKiB3YXRlcm1hcmtzIGVudGlyZWx5Lgo+ID4gICAJICovCj4gPiAtCWlmIChkZXZfcHJp
di0+d20ucHJpX2xhdGVuY3lbM10gPT0gMCAmJgo+ID4gLQkgICAgZGV2X3ByaXYtPndtLnNwcl9s
YXRlbmN5WzNdID09IDAgJiYKPiA+IC0JICAgIGRldl9wcml2LT53bS5jdXJfbGF0ZW5jeVszXSA9
PSAwKQo+ID4gKwlpZiAoaTkxNS0+d20ucHJpX2xhdGVuY3lbM10gPT0gMCAmJgo+ID4gKwkgICAg
aTkxNS0+d20uc3ByX2xhdGVuY3lbM10gPT0gMCAmJgo+ID4gKwkgICAgaTkxNS0+d20uY3VyX2xh
dGVuY3lbM10gPT0gMCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWRldl9wcml2LT53bS5wcmlfbGF0
ZW5jeVszXSA9IDA7Cj4gPiAtCWRldl9wcml2LT53bS5zcHJfbGF0ZW5jeVszXSA9IDA7Cj4gPiAt
CWRldl9wcml2LT53bS5jdXJfbGF0ZW5jeVszXSA9IDA7Cj4gPiArCWk5MTUtPndtLnByaV9sYXRl
bmN5WzNdID0gMDsKPiA+ICsJaTkxNS0+d20uc3ByX2xhdGVuY3lbM10gPSAwOwo+ID4gKwlpOTE1
LT53bS5jdXJfbGF0ZW5jeVszXSA9IDA7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJMUDMgd2F0ZXJt
YXJrcyBkaXNhYmxlZCBkdWUgdG8gcG90ZW50aWFsIGZvciBsb3N0IGludGVycnVwdHNcbiIpOwo+
ID4gLQlpbnRlbF9wcmludF93bV9sYXRlbmN5KGRldl9wcml2LCAiUHJpbWFyeSIsIGRldl9wcml2
LT53bS5wcmlfbGF0ZW5jeSk7Cj4gPiAtCWludGVsX3ByaW50X3dtX2xhdGVuY3koZGV2X3ByaXYs
ICJTcHJpdGUiLCBkZXZfcHJpdi0+d20uc3ByX2xhdGVuY3kpOwo+ID4gLQlpbnRlbF9wcmludF93
bV9sYXRlbmN5KGRldl9wcml2LCAiQ3Vyc29yIiwgZGV2X3ByaXYtPndtLmN1cl9sYXRlbmN5KTsK
PiA+ICsJaW50ZWxfcHJpbnRfd21fbGF0ZW5jeShpOTE1LCAiUHJpbWFyeSIsIGk5MTUtPndtLnBy
aV9sYXRlbmN5KTsKPiA+ICsJaW50ZWxfcHJpbnRfd21fbGF0ZW5jeShpOTE1LCAiU3ByaXRlIiwg
aTkxNS0+d20uc3ByX2xhdGVuY3kpOwo+ID4gKwlpbnRlbF9wcmludF93bV9sYXRlbmN5KGk5MTUs
ICJDdXJzb3IiLCBpOTE1LT53bS5jdXJfbGF0ZW5jeSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9p
ZCBpbGtfc2V0dXBfd21fbGF0ZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiArc3RhdGljIHZvaWQgaWxrX3NldHVwX3dtX2xhdGVuY3koc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JaW50ZWxfcmVhZF93bV9sYXRlbmN5KGRldl9wcml2
LCBkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3kpOwo+ID4gKwlpbnRlbF9yZWFkX3dtX2xhdGVuY3ko
aTkxNSwgaTkxNS0+d20ucHJpX2xhdGVuY3kpOwo+ID4gLQltZW1jcHkoZGV2X3ByaXYtPndtLnNw
cl9sYXRlbmN5LCBkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3ksCj4gPiAtCSAgICAgICBzaXplb2Yo
ZGV2X3ByaXYtPndtLnByaV9sYXRlbmN5KSk7Cj4gPiAtCW1lbWNweShkZXZfcHJpdi0+d20uY3Vy
X2xhdGVuY3ksIGRldl9wcml2LT53bS5wcmlfbGF0ZW5jeSwKPiA+IC0JICAgICAgIHNpemVvZihk
ZXZfcHJpdi0+d20ucHJpX2xhdGVuY3kpKTsKPiA+ICsJbWVtY3B5KGk5MTUtPndtLnNwcl9sYXRl
bmN5LCBpOTE1LT53bS5wcmlfbGF0ZW5jeSwKPiA+ICsJICAgICAgIHNpemVvZihpOTE1LT53bS5w
cmlfbGF0ZW5jeSkpOwo+ID4gKwltZW1jcHkoaTkxNS0+d20uY3VyX2xhdGVuY3ksIGk5MTUtPndt
LnByaV9sYXRlbmN5LAo+ID4gKwkgICAgICAgc2l6ZW9mKGk5MTUtPndtLnByaV9sYXRlbmN5KSk7
Cj4gPiAtCWludGVsX2ZpeHVwX3Nwcl93bV9sYXRlbmN5KGRldl9wcml2LCBkZXZfcHJpdi0+d20u
c3ByX2xhdGVuY3kpOwo+ID4gLQlpbnRlbF9maXh1cF9jdXJfd21fbGF0ZW5jeShkZXZfcHJpdiwg
ZGV2X3ByaXYtPndtLmN1cl9sYXRlbmN5KTsKPiA+ICsJaW50ZWxfZml4dXBfc3ByX3dtX2xhdGVu
Y3koaTkxNSwgaTkxNS0+d20uc3ByX2xhdGVuY3kpOwo+ID4gKwlpbnRlbF9maXh1cF9jdXJfd21f
bGF0ZW5jeShpOTE1LCBpOTE1LT53bS5jdXJfbGF0ZW5jeSk7Cj4gPiAtCWludGVsX3ByaW50X3dt
X2xhdGVuY3koZGV2X3ByaXYsICJQcmltYXJ5IiwgZGV2X3ByaXYtPndtLnByaV9sYXRlbmN5KTsK
PiA+IC0JaW50ZWxfcHJpbnRfd21fbGF0ZW5jeShkZXZfcHJpdiwgIlNwcml0ZSIsIGRldl9wcml2
LT53bS5zcHJfbGF0ZW5jeSk7Cj4gPiAtCWludGVsX3ByaW50X3dtX2xhdGVuY3koZGV2X3ByaXYs
ICJDdXJzb3IiLCBkZXZfcHJpdi0+d20uY3VyX2xhdGVuY3kpOwo+ID4gKwlpbnRlbF9wcmludF93
bV9sYXRlbmN5KGk5MTUsICJQcmltYXJ5IiwgaTkxNS0+d20ucHJpX2xhdGVuY3kpOwo+ID4gKwlp
bnRlbF9wcmludF93bV9sYXRlbmN5KGk5MTUsICJTcHJpdGUiLCBpOTE1LT53bS5zcHJfbGF0ZW5j
eSk7Cj4gPiArCWludGVsX3ByaW50X3dtX2xhdGVuY3koaTkxNSwgIkN1cnNvciIsIGk5MTUtPndt
LmN1cl9sYXRlbmN5KTsKPiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgNikpIHsKPiA+IC0JCXNu
Yl93bV9sYXRlbmN5X3F1aXJrKGRldl9wcml2KTsKPiA+IC0JCXNuYl93bV9scDNfaXJxX3F1aXJr
KGRldl9wcml2KTsKPiA+ICsJaWYgKElTX0dFTihpOTE1LCA2KSkgewo+ID4gKwkJc25iX3dtX2xh
dGVuY3lfcXVpcmsoaTkxNSk7Cj4gPiArCQlzbmJfd21fbHAzX2lycV9xdWlyayhpOTE1KTsKPiA+
ICAgCX0KPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHNrbF9zZXR1cF93bV9sYXRlbmN5KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBza2xfc2V0dXBf
d21fbGF0ZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlp
bnRlbF9yZWFkX3dtX2xhdGVuY3koZGV2X3ByaXYsIGRldl9wcml2LT53bS5za2xfbGF0ZW5jeSk7
Cj4gPiAtCWludGVsX3ByaW50X3dtX2xhdGVuY3koZGV2X3ByaXYsICJHZW45IFBsYW5lIiwgZGV2
X3ByaXYtPndtLnNrbF9sYXRlbmN5KTsKPiA+ICsJaW50ZWxfcmVhZF93bV9sYXRlbmN5KGk5MTUs
IGk5MTUtPndtLnNrbF9sYXRlbmN5KTsKPiA+ICsJaW50ZWxfcHJpbnRfd21fbGF0ZW5jeShpOTE1
LCAiR2VuOSBQbGFuZSIsIGk5MTUtPndtLnNrbF9sYXRlbmN5KTsKPiA+ICAgfQo+ID4gLXN0YXRp
YyBib29sIGlsa192YWxpZGF0ZV9waXBlX3dtKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgYm9vbCBpbGtfdmFsaWRhdGVfcGlwZV93bShjb25zdCBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSBzdHJ1Y3QgaW50ZWxfcGlw
ZV93bSAqcGlwZV93bSkKPiA+ICAgewo+ID4gICAJLyogTFAwIHdhdGVybWFyayBtYXhpbXVtcyBk
ZXBlbmQgb24gdGhpcyBwaXBlIGFsb25lICovCj4gPiBAQCAtMzA4OCw3ICszMDg4LDcgQEAgc3Rh
dGljIGJvb2wgaWxrX3ZhbGlkYXRlX3BpcGVfd20oY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gICAJc3RydWN0IGlsa193bV9tYXhpbXVtcyBtYXg7Cj4gPiAgIAkv
KiBMUDAgd2F0ZXJtYXJrcyBhbHdheXMgdXNlIDEvMiBEREIgcGFydGl0aW9uaW5nICovCj4gPiAt
CWlsa19jb21wdXRlX3dtX21heGltdW1zKGRldl9wcml2LCAwLCAmY29uZmlnLCBJTlRFTF9EREJf
UEFSVF8xXzIsICZtYXgpOwo+ID4gKwlpbGtfY29tcHV0ZV93bV9tYXhpbXVtcyhpOTE1LCAwLCAm
Y29uZmlnLCBJTlRFTF9EREJfUEFSVF8xXzIsICZtYXgpOwo+ID4gICAJLyogQXQgbGVhc3QgTFAw
IG11c3QgYmUgdmFsaWQgKi8KPiA+ICAgCWlmICghaWxrX3ZhbGlkYXRlX3dtX2xldmVsKDAsICZt
YXgsICZwaXBlX3dtLT53bVswXSkpIHsKPiA+IEBAIC0zMTA2LDEzICszMTA2LDEzIEBAIHN0YXRp
YyBpbnQgaWxrX2NvbXB1dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRl
KQo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNz
dGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9waXBlX3dtICpwaXBlX3dtOwo+
ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IHN0YXRlLT5kZXY7Cj4gPiAtCWNvbnN0IHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJY29u
c3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlz
dHJ1Y3QgZHJtX3BsYW5lICpwbGFuZTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfc3Rh
dGUgKnBsYW5lX3N0YXRlOwo+ID4gICAJY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpw
cmlzdGF0ZSA9IE5VTEw7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnNw
cnN0YXRlID0gTlVMTDsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqY3Vy
c3RhdGUgPSBOVUxMOwo+ID4gLQlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2
ZWwoZGV2X3ByaXYpLCB1c2FibGVfbGV2ZWw7Cj4gPiArCWludCBsZXZlbCwgbWF4X2xldmVsID0g
aWxrX3dtX21heF9sZXZlbChpOTE1KSwgdXNhYmxlX2xldmVsOwo+ID4gICAJc3RydWN0IGlsa193
bV9tYXhpbXVtcyBtYXg7Cj4gPiAgIAlwaXBlX3dtID0gJmNzdGF0ZS0+d20uaWxrLm9wdGltYWw7
Cj4gPiBAQCAtMzEzOSw3ICszMTM5LDcgQEAgc3RhdGljIGludCBpbGtfY29tcHV0ZV9waXBlX3dt
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4gPiAgIAl1c2FibGVfbGV2ZWwgPSBt
YXhfbGV2ZWw7Cj4gPiAgIAkvKiBJTEsvU05COiBMUDIrIHdhdGVybWFya3Mgb25seSB3L28gc3By
aXRlcyAqLwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8PSA2ICYmIHBpcGVfd20tPnNw
cml0ZXNfZW5hYmxlZCkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8PSA2ICYmIHBpcGVfd20t
PnNwcml0ZXNfZW5hYmxlZCkKPiA+ICAgCQl1c2FibGVfbGV2ZWwgPSAxOwo+ID4gICAJLyogSUxL
L1NOQi9JVkI6IExQMSsgd2F0ZXJtYXJrcyBvbmx5IHcvbyBzY2FsaW5nICovCj4gPiBAQCAtMzE0
NywyMSArMzE0NywyMSBAQCBzdGF0aWMgaW50IGlsa19jb21wdXRlX3BpcGVfd20oc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNzdGF0ZSkKPiA+ICAgCQl1c2FibGVfbGV2ZWwgPSAwOwo+ID4gICAJ
bWVtc2V0KCZwaXBlX3dtLT53bSwgMCwgc2l6ZW9mKHBpcGVfd20tPndtKSk7Cj4gPiAtCWlsa19j
b21wdXRlX3dtX2xldmVsKGRldl9wcml2LCBpbnRlbF9jcnRjLCAwLCBjc3RhdGUsCj4gPiArCWls
a19jb21wdXRlX3dtX2xldmVsKGk5MTUsIGludGVsX2NydGMsIDAsIGNzdGF0ZSwKPiA+ICAgCQkJ
ICAgICBwcmlzdGF0ZSwgc3Byc3RhdGUsIGN1cnN0YXRlLCAmcGlwZV93bS0+d21bMF0pOwo+ID4g
LQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiA+
ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKQo+ID4gICAJCXBp
cGVfd20tPmxpbmV0aW1lID0gaHN3X2NvbXB1dGVfbGluZXRpbWVfd20oY3N0YXRlKTsKPiA+IC0J
aWYgKCFpbGtfdmFsaWRhdGVfcGlwZV93bShkZXZfcHJpdiwgcGlwZV93bSkpCj4gPiArCWlmICgh
aWxrX3ZhbGlkYXRlX3BpcGVfd20oaTkxNSwgcGlwZV93bSkpCj4gPiAgIAkJcmV0dXJuIC1FSU5W
QUw7Cj4gPiAtCWlsa19jb21wdXRlX3dtX3JlZ19tYXhpbXVtcyhkZXZfcHJpdiwgMSwgJm1heCk7
Cj4gPiArCWlsa19jb21wdXRlX3dtX3JlZ19tYXhpbXVtcyhpOTE1LCAxLCAmbWF4KTsKPiA+ICAg
CWZvciAobGV2ZWwgPSAxOyBsZXZlbCA8PSB1c2FibGVfbGV2ZWw7IGxldmVsKyspIHsKPiA+ICAg
CQlzdHJ1Y3QgaW50ZWxfd21fbGV2ZWwgKndtID0gJnBpcGVfd20tPndtW2xldmVsXTsKPiA+IC0J
CWlsa19jb21wdXRlX3dtX2xldmVsKGRldl9wcml2LCBpbnRlbF9jcnRjLCBsZXZlbCwgY3N0YXRl
LAo+ID4gKwkJaWxrX2NvbXB1dGVfd21fbGV2ZWwoaTkxNSwgaW50ZWxfY3J0YywgbGV2ZWwsIGNz
dGF0ZSwKPiA+ICAgCQkJCSAgICAgcHJpc3RhdGUsIHNwcnN0YXRlLCBjdXJzdGF0ZSwgd20pOwo+
ID4gICAJCS8qCj4gPiBAQCAtMzE4NiwxNCArMzE4NiwxNCBAQCBzdGF0aWMgaW50IGlsa19jb21w
dXRlX3BpcGVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSkKPiA+ICAgc3RhdGlj
IGludCBpbGtfY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUg
Km5ld3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9
IHRvX2ludGVsX2NydGMobmV3c3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoaW50ZWxfY3J0Yy0+YmFzZS5kZXYpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoaW50ZWxfY3J0Yy0+YmFz
ZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX3BpcGVfd20gKmEgPSAmbmV3c3RhdGUtPndtLmls
ay5pbnRlcm1lZGlhdGU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICppbnRlbF9z
dGF0ZSA9Cj4gPiAgIAkJdG9faW50ZWxfYXRvbWljX3N0YXRlKG5ld3N0YXRlLT5iYXNlLnN0YXRl
KTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRzdGF0ZSA9Cj4gPiAg
IAkJaW50ZWxfYXRvbWljX2dldF9vbGRfY3J0Y19zdGF0ZShpbnRlbF9zdGF0ZSwgaW50ZWxfY3J0
Yyk7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfcGlwZV93bSAqYiA9ICZvbGRzdGF0ZS0+d20u
aWxrLm9wdGltYWw7Cj4gPiAtCWludCBsZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZl
bChkZXZfcHJpdik7Cj4gPiArCWludCBsZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZl
bChpOTE1KTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBTdGFydCB3aXRoIHRoZSBmaW5hbCwgdGFyZ2V0
IHdhdGVybWFya3MsIHRoZW4gY29tYmluZSB3aXRoIHRoZQo+ID4gQEAgLTMyMjYsNyArMzIyNiw3
IEBAIHN0YXRpYyBpbnQgaWxrX2NvbXB1dGVfaW50ZXJtZWRpYXRlX3dtKHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpuZXdzdGF0ZSkKPiA+ICAgCSAqIHRoZXJlJ3Mgbm8gc2FmZSB3YXkgdG8gdHJh
bnNpdGlvbiBmcm9tIHRoZSBvbGQgc3RhdGUgdG8KPiA+ICAgCSAqIHRoZSBuZXcgc3RhdGUsIHNv
IHdlIG5lZWQgdG8gZmFpbCB0aGUgYXRvbWljIHRyYW5zYWN0aW9uLgo+ID4gICAJICovCj4gPiAt
CWlmICghaWxrX3ZhbGlkYXRlX3BpcGVfd20oZGV2X3ByaXYsIGEpKQo+ID4gKwlpZiAoIWlsa192
YWxpZGF0ZV9waXBlX3dtKGk5MTUsIGEpKQo+ID4gICAJCXJldHVybiAtRUlOVkFMOwo+ID4gICAJ
LyoKPiA+IEBAIC0zMjQyLDcgKzMyNDIsNyBAQCBzdGF0aWMgaW50IGlsa19jb21wdXRlX2ludGVy
bWVkaWF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3c3RhdGUpCj4gPiAgIC8qCj4g
PiAgICAqIE1lcmdlIHRoZSB3YXRlcm1hcmtzIGZyb20gYWxsIGFjdGl2ZSBwaXBlcyBmb3IgYSBz
cGVjaWZpYyBsZXZlbC4KPiA+ICAgICovCj4gPiAtc3RhdGljIHZvaWQgaWxrX21lcmdlX3dtX2xl
dmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBp
bGtfbWVyZ2Vfd21fbGV2ZWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJ
CSAgICAgICBpbnQgbGV2ZWwsCj4gPiAgIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfd21fbGV2ZWwg
KnJldF93bSkKPiA+ICAgewo+ID4gQEAgLTMyNTAsNyArMzI1MCw3IEBAIHN0YXRpYyB2b2lkIGls
a19tZXJnZV93bV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAg
IAlyZXRfd20tPmVuYWJsZSA9IHRydWU7Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9w
cml2LT5kcm0sIGludGVsX2NydGMpIHsKPiA+ICsJZm9yX2VhY2hfaW50ZWxfY3J0YygmaTkxNS0+
ZHJtLCBpbnRlbF9jcnRjKSB7Cj4gPiAgIAkJY29uc3Qgc3RydWN0IGludGVsX3BpcGVfd20gKmFj
dGl2ZSA9ICZpbnRlbF9jcnRjLT53bS5hY3RpdmUuaWxrOwo+ID4gICAJCWNvbnN0IHN0cnVjdCBp
bnRlbF93bV9sZXZlbCAqd20gPSAmYWN0aXZlLT53bVtsZXZlbF07Cj4gPiBAQCAtMzI3NSwyNyAr
MzI3NSwyNyBAQCBzdGF0aWMgdm9pZCBpbGtfbWVyZ2Vfd21fbGV2ZWwoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAvKgo+ID4gICAgKiBNZXJnZSBhbGwgbG93IHBvd2Vy
IHdhdGVybWFya3MgZm9yIGFsbCBhY3RpdmUgcGlwZXMuCj4gPiAgICAqLwo+ID4gLXN0YXRpYyB2
b2lkIGlsa193bV9tZXJnZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAr
c3RhdGljIHZvaWQgaWxrX3dtX21lcmdlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+
ID4gICAJCQkgY29uc3Qgc3RydWN0IGludGVsX3dtX2NvbmZpZyAqY29uZmlnLAo+ID4gICAJCQkg
Y29uc3Qgc3RydWN0IGlsa193bV9tYXhpbXVtcyAqbWF4LAo+ID4gICAJCQkgc3RydWN0IGludGVs
X3BpcGVfd20gKm1lcmdlZCkKPiA+ICAgewo+ID4gLQlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGls
a193bV9tYXhfbGV2ZWwoZGV2X3ByaXYpOwo+ID4gKwlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGls
a193bV9tYXhfbGV2ZWwoaTkxNSk7Cj4gPiAgIAlpbnQgbGFzdF9lbmFibGVkX2xldmVsID0gbWF4
X2xldmVsOwo+ID4gICAJLyogSUxLL1NOQi9JVkI6IExQMSsgd2F0ZXJtYXJrcyBvbmx5IHcvIHNp
bmdsZSBwaXBlICovCj4gPiAtCWlmICgoSU5URUxfR0VOKGRldl9wcml2KSA8PSA2IHx8IElTX0lW
WUJSSURHRShkZXZfcHJpdikpICYmCj4gPiArCWlmICgoSU5URUxfR0VOKGk5MTUpIDw9IDYgfHwg
SVNfSVZZQlJJREdFKGk5MTUpKSAmJgo+ID4gICAJICAgIGNvbmZpZy0+bnVtX3BpcGVzX2FjdGl2
ZSA+IDEpCj4gPiAgIAkJbGFzdF9lbmFibGVkX2xldmVsID0gMDsKPiA+ICAgCS8qIElMSzogRkJD
IFdNIG11c3QgYmUgZGlzYWJsZWQgYWx3YXlzICovCj4gPiAtCW1lcmdlZC0+ZmJjX3dtX2VuYWJs
ZWQgPSBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDY7Cj4gPiArCW1lcmdlZC0+ZmJjX3dtX2VuYWJs
ZWQgPSBJTlRFTF9HRU4oaTkxNSkgPj0gNjsKPiA+ICAgCS8qIG1lcmdlIGVhY2ggV00xKyBsZXZl
bCAqLwo+ID4gICAJZm9yIChsZXZlbCA9IDE7IGxldmVsIDw9IG1heF9sZXZlbDsgbGV2ZWwrKykg
ewo+ID4gICAJCXN0cnVjdCBpbnRlbF93bV9sZXZlbCAqd20gPSAmbWVyZ2VkLT53bVtsZXZlbF07
Cj4gPiAtCQlpbGtfbWVyZ2Vfd21fbGV2ZWwoZGV2X3ByaXYsIGxldmVsLCB3bSk7Cj4gPiArCQlp
bGtfbWVyZ2Vfd21fbGV2ZWwoaTkxNSwgbGV2ZWwsIHdtKTsKPiA+ICAgCQlpZiAobGV2ZWwgPiBs
YXN0X2VuYWJsZWRfbGV2ZWwpCj4gPiAgIAkJCXdtLT5lbmFibGUgPSBmYWxzZTsKPiA+IEBAIC0z
MzIwLDggKzMzMjAsOCBAQCBzdGF0aWMgdm9pZCBpbGtfd21fbWVyZ2Uoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJICogV2hhdCB3ZSBzaG91bGQgY2hlY2sgaGVyZSBp
cyB3aGV0aGVyIEZCQyBjYW4gYmUKPiA+ICAgCSAqIGVuYWJsZWQgc29tZXRpbWUgbGF0ZXIuCj4g
PiAgIAkgKi8KPiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgNSkgJiYgIW1lcmdlZC0+ZmJjX3dt
X2VuYWJsZWQgJiYKPiA+IC0JICAgIGludGVsX2ZiY19pc19hY3RpdmUoZGV2X3ByaXYpKSB7Cj4g
PiArCWlmIChJU19HRU4oaTkxNSwgNSkgJiYgIW1lcmdlZC0+ZmJjX3dtX2VuYWJsZWQgJiYKPiA+
ICsJICAgIGludGVsX2ZiY19pc19hY3RpdmUoaTkxNSkpIHsKPiA+ICAgCQlmb3IgKGxldmVsID0g
MjsgbGV2ZWwgPD0gbWF4X2xldmVsOyBsZXZlbCsrKSB7Cj4gPiAgIAkJCXN0cnVjdCBpbnRlbF93
bV9sZXZlbCAqd20gPSAmbWVyZ2VkLT53bVtsZXZlbF07Cj4gPiBAQCAtMzMzNywxNiArMzMzNywx
NiBAQCBzdGF0aWMgaW50IGlsa193bV9scF90b19sZXZlbChpbnQgd21fbHAsIGNvbnN0IHN0cnVj
dCBpbnRlbF9waXBlX3dtICpwaXBlX3dtKQo+ID4gICB9Cj4gPiAgIC8qIFRoZSB2YWx1ZSB3ZSBu
ZWVkIHRvIHByb2dyYW0gaW50byB0aGUgV01fTFB4IGxhdGVuY3kgZmllbGQgKi8KPiA+IC1zdGF0
aWMgdW5zaWduZWQgaW50IGlsa193bV9scF9sYXRlbmN5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdW5zaWduZWQgaW50IGlsa193bV9scF9sYXRlbmN5KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgICAgaW50IGxldmVsKQo+
ID4gICB7Cj4gPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2
X3ByaXYpKQo+ID4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkp
Cj4gPiAgIAkJcmV0dXJuIDIgKiBsZXZlbDsKPiA+ICAgCWVsc2UKPiA+IC0JCXJldHVybiBkZXZf
cHJpdi0+d20ucHJpX2xhdGVuY3lbbGV2ZWxdOwo+ID4gKwkJcmV0dXJuIGk5MTUtPndtLnByaV9s
YXRlbmN5W2xldmVsXTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGlsa19jb21wdXRlX3dtX3Jl
c3VsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lk
IGlsa19jb21wdXRlX3dtX3Jlc3VsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGlwZV93bSAqbWVyZ2VkLAo+ID4gICAJCQkJ
ICAgZW51bSBpbnRlbF9kZGJfcGFydGl0aW9uaW5nIHBhcnRpdGlvbmluZywKPiA+ICAgCQkJCSAg
IHN0cnVjdCBpbGtfd21fdmFsdWVzICpyZXN1bHRzKQo+ID4gQEAgLTMzNzAsMTQgKzMzNzAsMTQg
QEAgc3RhdGljIHZvaWQgaWxrX2NvbXB1dGVfd21fcmVzdWx0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJICogZGlzYWJsZWQuIERvaW5nIG90aGVyd2lzZSBjb3Vs
ZCBjYXVzZSB1bmRlcnJ1bnMuCj4gPiAgIAkJICovCj4gPiAgIAkJcmVzdWx0cy0+d21fbHBbd21f
bHAgLSAxXSA9Cj4gPiAtCQkJKGlsa193bV9scF9sYXRlbmN5KGRldl9wcml2LCBsZXZlbCkgPDwg
V00xX0xQX0xBVEVOQ1lfU0hJRlQpIHwKPiA+ICsJCQkoaWxrX3dtX2xwX2xhdGVuY3koaTkxNSwg
bGV2ZWwpIDw8IFdNMV9MUF9MQVRFTkNZX1NISUZUKSB8Cj4gPiAgIAkJCShyLT5wcmlfdmFsIDw8
IFdNMV9MUF9TUl9TSElGVCkgfAo+ID4gICAJCQlyLT5jdXJfdmFsOwo+ID4gICAJCWlmIChyLT5l
bmFibGUpCj4gPiAgIAkJCXJlc3VsdHMtPndtX2xwW3dtX2xwIC0gMV0gfD0gV00xX0xQX1NSX0VO
Owo+ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkKPiA+ICsJCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gOCkKPiA+ICAgCQkJcmVzdWx0cy0+d21fbHBbd21fbHAgLSAxXSB8PQo+ID4g
ICAJCQkJci0+ZmJjX3ZhbCA8PCBXTTFfTFBfRkJDX1NISUZUX0JEVzsKPiA+ICAgCQllbHNlCj4g
PiBAQCAtMzM4OCw3ICszMzg4LDcgQEAgc3RhdGljIHZvaWQgaWxrX2NvbXB1dGVfd21fcmVzdWx0
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJICogQWx3YXlzIHNl
dCBXTTFTX0xQX0VOIHdoZW4gc3ByX3ZhbCAhPSAwLCBldmVuIGlmIHRoZQo+ID4gICAJCSAqIGxl
dmVsIGlzIGRpc2FibGVkLiBEb2luZyBvdGhlcndpc2UgY291bGQgY2F1c2UgdW5kZXJydW5zLgo+
ID4gICAJCSAqLwo+ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPD0gNiAmJiByLT5zcHJf
dmFsKSB7Cj4gPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDYgJiYgci0+c3ByX3ZhbCkgewo+
ID4gICAJCQlXQVJOX09OKHdtX2xwICE9IDEpOwo+ID4gICAJCQlyZXN1bHRzLT53bV9scF9zcHJb
d21fbHAgLSAxXSA9IFdNMVNfTFBfRU4gfCByLT5zcHJfdmFsOwo+ID4gICAJCX0gZWxzZQo+ID4g
QEAgLTMzOTYsNyArMzM5Niw3IEBAIHN0YXRpYyB2b2lkIGlsa19jb21wdXRlX3dtX3Jlc3VsdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJfQo+ID4gICAJLyogTFAw
IHJlZ2lzdGVyIHZhbHVlcyAqLwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+
ZHJtLCBpbnRlbF9jcnRjKSB7Cj4gPiArCWZvcl9lYWNoX2ludGVsX2NydGMoJmk5MTUtPmRybSwg
aW50ZWxfY3J0Yykgewo+ID4gICAJCWVudW0gcGlwZSBwaXBlID0gaW50ZWxfY3J0Yy0+cGlwZTsK
PiA+ICAgCQljb25zdCBzdHJ1Y3QgaW50ZWxfd21fbGV2ZWwgKnIgPQo+ID4gICAJCQkmaW50ZWxf
Y3J0Yy0+d20uYWN0aXZlLmlsay53bVswXTsKPiA+IEBAIC0zNDE2LDExICszNDE2LDExIEBAIHN0
YXRpYyB2b2lkIGlsa19jb21wdXRlX3dtX3Jlc3VsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gICAvKiBGaW5kIHRoZSByZXN1bHQgd2l0aCB0aGUgaGlnaGVzdCBsZXZl
bCBlbmFibGVkLiBDaGVjayBmb3IgZW5hYmxlX2ZiY193bSBpbgo+ID4gICAgKiBjYXNlIGJvdGgg
YXJlIGF0IHRoZSBzYW1lIGxldmVsLiBQcmVmZXIgcjEgaW4gY2FzZSB0aGV5J3JlIHRoZSBzYW1l
LiAqLwo+ID4gICBzdGF0aWMgc3RydWN0IGludGVsX3BpcGVfd20gKgo+ID4gLWlsa19maW5kX2Jl
c3RfcmVzdWx0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtpbGtfZmlu
ZF9iZXN0X3Jlc3VsdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkgICAg
IHN0cnVjdCBpbnRlbF9waXBlX3dtICpyMSwKPiA+ICAgCQkgICAgIHN0cnVjdCBpbnRlbF9waXBl
X3dtICpyMikKPiA+ICAgewo+ID4gLQlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhf
bGV2ZWwoZGV2X3ByaXYpOwo+ID4gKwlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhf
bGV2ZWwoaTkxNSk7Cj4gPiAgIAlpbnQgbGV2ZWwxID0gMCwgbGV2ZWwyID0gMDsKPiA+ICAgCWZv
ciAobGV2ZWwgPSAxOyBsZXZlbCA8PSBtYXhfbGV2ZWw7IGxldmVsKyspIHsKPiA+IEBAIC0zNDUw
LDcgKzM0NTAsNyBAQCBpbGtfZmluZF9iZXN0X3Jlc3VsdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiAgICNkZWZpbmUgV01fRElSVFlfRkJDICgxIDw8IDI0KQo+ID4gICAj
ZGVmaW5lIFdNX0RJUlRZX0REQiAoMSA8PCAyNSkKPiA+IC1zdGF0aWMgdW5zaWduZWQgaW50IGls
a19jb21wdXRlX3dtX2RpcnR5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+
ICtzdGF0aWMgdW5zaWduZWQgaW50IGlsa19jb21wdXRlX3dtX2RpcnR5KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJCSBjb25zdCBzdHJ1Y3QgaWxrX3dtX3ZhbHVlcyAq
b2xkLAo+ID4gICAJCQkJCSBjb25zdCBzdHJ1Y3QgaWxrX3dtX3ZhbHVlcyAqbmV3KQo+ID4gICB7
Cj4gPiBAQCAtMzQ1OCw3ICszNDU4LDcgQEAgc3RhdGljIHVuc2lnbmVkIGludCBpbGtfY29tcHV0
ZV93bV9kaXJ0eShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAllbnVt
IHBpcGUgcGlwZTsKPiA+ICAgCWludCB3bV9scDsKPiA+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJp
diwgcGlwZSkgewo+ID4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpIHsKPiA+ICAgCQlpZiAo
b2xkLT53bV9saW5ldGltZVtwaXBlXSAhPSBuZXctPndtX2xpbmV0aW1lW3BpcGVdKSB7Cj4gPiAg
IAkJCWRpcnR5IHw9IFdNX0RJUlRZX0xJTkVUSU1FKHBpcGUpOwo+ID4gICAJCQkvKiBNdXN0IGRp
c2FibGUgTFAxKyB3YXRlcm1hcmtzIHRvbyAqLwo+ID4gQEAgLTM1MDIsMTAgKzM1MDIsMTAgQEAg
c3RhdGljIHVuc2lnbmVkIGludCBpbGtfY29tcHV0ZV93bV9kaXJ0eShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlyZXR1cm4gZGlydHk7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgYm9vbCBfaWxrX2Rpc2FibGVfbHBfd20oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK3N0YXRpYyBib29sIF9pbGtfZGlzYWJsZV9scF93bShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICAgIHVuc2lnbmVkIGludCBkaXJ0eSkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgaWxrX3dtX3ZhbHVlcyAqcHJldmlvdXMgPSAmZGV2X3ByaXYtPndtLmh3
Owo+ID4gKwlzdHJ1Y3QgaWxrX3dtX3ZhbHVlcyAqcHJldmlvdXMgPSAmaTkxNS0+d20uaHc7Cj4g
PiAgIAlib29sIGNoYW5nZWQgPSBmYWxzZTsKPiA+ICAgCWlmIChkaXJ0eSAmIFdNX0RJUlRZX0xQ
KDMpICYmIHByZXZpb3VzLT53bV9scFsyXSAmIFdNMV9MUF9TUl9FTikgewo+ID4gQEAgLTM1MzYs
MTggKzM1MzYsMTggQEAgc3RhdGljIGJvb2wgX2lsa19kaXNhYmxlX2xwX3dtKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgICogVGhlIHNwZWMgc2F5cyB3ZSBzaG91bGRu
J3Qgd3JpdGUgd2hlbiB3ZSBkb24ndCBuZWVkLCBiZWNhdXNlIGV2ZXJ5IHdyaXRlCj4gPiAgICAq
IGNhdXNlcyBXTXMgdG8gYmUgcmUtZXZhbHVhdGVkLCBleHBlbmRpbmcgc29tZSBwb3dlci4KPiA+
ICAgICovCj4gPiAtc3RhdGljIHZvaWQgaWxrX3dyaXRlX3dtX3ZhbHVlcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgaWxrX3dyaXRlX3dtX3ZhbHVl
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCXN0cnVjdCBpbGtfd21f
dmFsdWVzICpyZXN1bHRzKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbGtfd21fdmFsdWVzICpwcmV2
aW91cyA9ICZkZXZfcHJpdi0+d20uaHc7Cj4gPiArCXN0cnVjdCBpbGtfd21fdmFsdWVzICpwcmV2
aW91cyA9ICZpOTE1LT53bS5odzsKPiA+ICAgCXVuc2lnbmVkIGludCBkaXJ0eTsKPiA+ICAgCXUz
MiB2YWw7Cj4gPiAtCWRpcnR5ID0gaWxrX2NvbXB1dGVfd21fZGlydHkoZGV2X3ByaXYsIHByZXZp
b3VzLCByZXN1bHRzKTsKPiA+ICsJZGlydHkgPSBpbGtfY29tcHV0ZV93bV9kaXJ0eShpOTE1LCBw
cmV2aW91cywgcmVzdWx0cyk7Cj4gPiAgIAlpZiAoIWRpcnR5KQo+ID4gICAJCXJldHVybjsKPiA+
IC0JX2lsa19kaXNhYmxlX2xwX3dtKGRldl9wcml2LCBkaXJ0eSk7Cj4gPiArCV9pbGtfZGlzYWJs
ZV9scF93bShpOTE1LCBkaXJ0eSk7Cj4gPiAgIAlpZiAoZGlydHkgJiBXTV9ESVJUWV9QSVBFKFBJ
UEVfQSkpCj4gPiAgIAkJSTkxNV9XUklURShXTTBfUElQRUFfSUxLLCByZXN1bHRzLT53bV9waXBl
WzBdKTsKPiA+IEBAIC0zNTY0LDcgKzM1NjQsNyBAQCBzdGF0aWMgdm9pZCBpbGtfd3JpdGVfd21f
dmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQlJOTE1X1dS
SVRFKFBJUEVfV01fTElORVRJTUUoUElQRV9DKSwgcmVzdWx0cy0+d21fbGluZXRpbWVbMl0pOwo+
ID4gICAJaWYgKGRpcnR5ICYgV01fRElSVFlfRERCKSB7Cj4gPiAtCQlpZiAoSVNfSEFTV0VMTChk
ZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewo+ID4gKwkJaWYgKElTX0hBU1dF
TEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gPiAgIAkJCXZhbCA9IEk5MTVfUkVB
RChXTV9NSVNDKTsKPiA+ICAgCQkJaWYgKHJlc3VsdHMtPnBhcnRpdGlvbmluZyA9PSBJTlRFTF9E
REJfUEFSVF8xXzIpCj4gPiAgIAkJCQl2YWwgJj0gfldNX01JU0NfREFUQV9QQVJUSVRJT05fNV82
Owo+ID4gQEAgLTM1OTQsNyArMzU5NCw3IEBAIHN0YXRpYyB2b2lkIGlsa193cml0ZV93bV92YWx1
ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJICAgIHByZXZpb3Vz
LT53bV9scF9zcHJbMF0gIT0gcmVzdWx0cy0+d21fbHBfc3ByWzBdKQo+ID4gICAJCUk5MTVfV1JJ
VEUoV00xU19MUF9JTEssIHJlc3VsdHMtPndtX2xwX3NwclswXSk7Cj4gPiAtCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDcpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA3KSB7Cj4g
PiAgIAkJaWYgKGRpcnR5ICYgV01fRElSVFlfTFAoMikgJiYgcHJldmlvdXMtPndtX2xwX3Nwclsx
XSAhPSByZXN1bHRzLT53bV9scF9zcHJbMV0pCj4gPiAgIAkJCUk5MTVfV1JJVEUoV00yU19MUF9J
VkIsIHJlc3VsdHMtPndtX2xwX3NwclsxXSk7Cj4gPiAgIAkJaWYgKGRpcnR5ICYgV01fRElSVFlf
TFAoMykgJiYgcHJldmlvdXMtPndtX2xwX3NwclsyXSAhPSByZXN1bHRzLT53bV9scF9zcHJbMl0p
Cj4gPiBAQCAtMzYwOCwxNyArMzYwOCwxNyBAQCBzdGF0aWMgdm9pZCBpbGtfd3JpdGVfd21fdmFs
dWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWlmIChkaXJ0eSAm
IFdNX0RJUlRZX0xQKDMpICYmIHByZXZpb3VzLT53bV9scFsyXSAhPSByZXN1bHRzLT53bV9scFsy
XSkKPiA+ICAgCQlJOTE1X1dSSVRFKFdNM19MUF9JTEssIHJlc3VsdHMtPndtX2xwWzJdKTsKPiA+
IC0JZGV2X3ByaXYtPndtLmh3ID0gKnJlc3VsdHM7Cj4gPiArCWk5MTUtPndtLmh3ID0gKnJlc3Vs
dHM7Cj4gPiAgIH0KPiA+ICAgYm9vbCBpbGtfZGlzYWJsZV9scF93bShzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRldik7Cj4gPiAtCXJldHVybiBfaWxrX2Rpc2FibGVfbHBfd20oZGV2X3ByaXYsIFdNX0RJ
UlRZX0xQX0FMTCk7Cj4gPiArCXJldHVybiBfaWxrX2Rpc2FibGVfbHBfd20oaTkxNSwgV01fRElS
VFlfTFBfQUxMKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB1OCBpbnRlbF9lbmFibGVkX2RidWZfc2xp
Y2VzX251bShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHU4
IGludGVsX2VuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAgIAl1OCBlbmFibGVkX3NsaWNlczsKPiA+IEBAIC0zNjI2LDcgKzM2
MjYsNyBAQCBzdGF0aWMgdTggaW50ZWxfZW5hYmxlZF9kYnVmX3NsaWNlc19udW0oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJZW5hYmxlZF9zbGljZXMgPSAxOwo+ID4g
ICAJLyogR2VuIHByaW9yIHRvIEdFTjExIGhhdmUgb25seSBvbmUgREJ1ZiBzbGljZSAqLwo+ID4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDExKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUp
IDwgMTEpCj4gPiAgIAkJcmV0dXJuIGVuYWJsZWRfc2xpY2VzOwo+ID4gICAJLyoKPiA+IEBAIC0z
NjQ0LDE2ICszNjQ0LDE2IEBAIHN0YXRpYyB1OCBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251
bShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgICAqIEZJWE1FOiBXZSBz
dGlsbCBkb24ndCBoYXZlIHRoZSBwcm9wZXIgY29kZSBkZXRlY3QgaWYgd2UgbmVlZCB0byBhcHBs
eSB0aGUgV0EsCj4gPiAgICAqIHNvIGFzc3VtZSB3ZSdsbCBhbHdheXMgbmVlZCBpdCBpbiBvcmRl
ciB0byBhdm9pZCB1bmRlcnJ1bnMuCj4gPiAgICAqLwo+ID4gLXN0YXRpYyBib29sIHNrbF9uZWVk
c19tZW1vcnlfYndfd2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0
YXRpYyBib29sIHNrbF9uZWVkc19tZW1vcnlfYndfd2Eoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gPiAgIHsKPiA+IC0JcmV0dXJuIElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8IElTX0JS
T1hUT04oZGV2X3ByaXYpOwo+ID4gKwlyZXR1cm4gSVNfR0VOOV9CQyhpOTE1KSB8fCBJU19CUk9Y
VE9OKGk5MTUpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBib29sCj4gPiAtaW50ZWxfaGFzX3NhZ3Yo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2ludGVsX2hhc19zYWd2KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXJldHVybiAoSVNfR0VO
OV9CQyhkZXZfcHJpdikgfHwgSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCkgJiYKPiA+IC0JCWRl
dl9wcml2LT5zYWd2X3N0YXR1cyAhPSBJOTE1X1NBR1ZfTk9UX0NPTlRST0xMRUQ7Cj4gPiArCXJl
dHVybiAoSVNfR0VOOV9CQyhpOTE1KSB8fCBJTlRFTF9HRU4oaTkxNSkgPj0gMTApICYmCj4gPiAr
CQlpOTE1LT5zYWd2X3N0YXR1cyAhPSBJOTE1X1NBR1ZfTk9UX0NPTlRST0xMRUQ7Cj4gPiAgIH0K
PiA+ICAgLyoKPiA+IEBAIC0zNjY4LDE4ICszNjY4LDE4IEBAIGludGVsX2hhc19zYWd2KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgICogIC0gV2UncmUgbm90IHVzaW5n
IGFuIGludGVybGFjZWQgZGlzcGxheSBjb25maWd1cmF0aW9uCj4gPiAgICAqLwo+ID4gICBpbnQK
PiA+IC1pbnRlbF9lbmFibGVfc2FndihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAraW50ZWxfZW5hYmxlX3NhZ3Yoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+ICAgCWludCByZXQ7Cj4gPiAtCWlmICghaW50ZWxfaGFzX3NhZ3YoZGV2X3ByaXYp
KQo+ID4gKwlpZiAoIWludGVsX2hhc19zYWd2KGk5MTUpKQo+ID4gICAJCXJldHVybiAwOwo+ID4g
LQlpZiAoZGV2X3ByaXYtPnNhZ3Zfc3RhdHVzID09IEk5MTVfU0FHVl9FTkFCTEVEKQo+ID4gKwlp
ZiAoaTkxNS0+c2Fndl9zdGF0dXMgPT0gSTkxNV9TQUdWX0VOQUJMRUQpCj4gPiAgIAkJcmV0dXJu
IDA7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJFbmFibGluZyBTQUdWXG4iKTsKPiA+IC0JcmV0ID0g
c2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUoZGV2X3ByaXYsIEdFTjlfUENPREVfU0FHVl9DT05UUk9M
LAo+ID4gKwlyZXQgPSBzYW5keWJyaWRnZV9wY29kZV93cml0ZShpOTE1LCBHRU45X1BDT0RFX1NB
R1ZfQ09OVFJPTCwKPiA+ICAgCQkJCSAgICAgIEdFTjlfU0FHVl9FTkFCTEUpOwo+ID4gICAJLyog
V2UgZG9uJ3QgbmVlZCB0byB3YWl0IGZvciBTQUdWIHdoZW4gZW5hYmxpbmcgKi8KPiA+IEBAIC0z
Njg4LDMzICszNjg4LDMzIEBAIGludGVsX2VuYWJsZV9zYWd2KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIFNvbWUgc2tsIHN5c3RlbXMsIHByZS1yZWxlYXNlIG1h
Y2hpbmVzIGluIHBhcnRpY3VsYXIsCj4gPiAgIAkgKiBkb24ndCBhY3R1YWxseSBoYXZlIFNBR1Yu
Cj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX1NLWUxBS0UoZGV2X3ByaXYpICYmIHJldCA9PSAtRU5Y
SU8pIHsKPiA+ICsJaWYgKElTX1NLWUxBS0UoaTkxNSkgJiYgcmV0ID09IC1FTlhJTykgewo+ID4g
ICAJCURSTV9ERUJVR19EUklWRVIoIk5vIFNBR1YgZm91bmQgb24gc3lzdGVtLCBpZ25vcmluZ1xu
Iik7Cj4gPiAtCQlkZXZfcHJpdi0+c2Fndl9zdGF0dXMgPSBJOTE1X1NBR1ZfTk9UX0NPTlRST0xM
RUQ7Cj4gPiArCQlpOTE1LT5zYWd2X3N0YXR1cyA9IEk5MTVfU0FHVl9OT1RfQ09OVFJPTExFRDsK
PiA+ICAgCQlyZXR1cm4gMDsKPiA+ICAgCX0gZWxzZSBpZiAocmV0IDwgMCkgewo+ID4gICAJCURS
TV9FUlJPUigiRmFpbGVkIHRvIGVuYWJsZSBTQUdWXG4iKTsKPiA+ICAgCQlyZXR1cm4gcmV0Owo+
ID4gICAJfQo+ID4gLQlkZXZfcHJpdi0+c2Fndl9zdGF0dXMgPSBJOTE1X1NBR1ZfRU5BQkxFRDsK
PiA+ICsJaTkxNS0+c2Fndl9zdGF0dXMgPSBJOTE1X1NBR1ZfRU5BQkxFRDsKPiA+ICAgCXJldHVy
biAwOwo+ID4gICB9Cj4gPiAgIGludAo+ID4gLWludGVsX2Rpc2FibGVfc2FndihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAraW50ZWxfZGlzYWJsZV9zYWd2KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlpbnQgcmV0Owo+ID4gLQlpZiAo
IWludGVsX2hhc19zYWd2KGRldl9wcml2KSkKPiA+ICsJaWYgKCFpbnRlbF9oYXNfc2FndihpOTE1
KSkKPiA+ICAgCQlyZXR1cm4gMDsKPiA+IC0JaWYgKGRldl9wcml2LT5zYWd2X3N0YXR1cyA9PSBJ
OTE1X1NBR1ZfRElTQUJMRUQpCj4gPiArCWlmIChpOTE1LT5zYWd2X3N0YXR1cyA9PSBJOTE1X1NB
R1ZfRElTQUJMRUQpCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJEaXNh
YmxpbmcgU0FHVlxuIik7Cj4gPiAgIAkvKiBic3BlYyBzYXlzIHRvIGtlZXAgcmV0cnlpbmcgZm9y
IGF0IGxlYXN0IDEgbXMgKi8KPiA+IC0JcmV0ID0gc2tsX3Bjb2RlX3JlcXVlc3QoZGV2X3ByaXYs
IEdFTjlfUENPREVfU0FHVl9DT05UUk9MLAo+ID4gKwlyZXQgPSBza2xfcGNvZGVfcmVxdWVzdChp
OTE1LCBHRU45X1BDT0RFX1NBR1ZfQ09OVFJPTCwKPiA+ICAgCQkJCUdFTjlfU0FHVl9ESVNBQkxF
LAo+ID4gICAJCQkJR0VOOV9TQUdWX0lTX0RJU0FCTEVELCBHRU45X1NBR1ZfSVNfRElTQUJMRUQs
Cj4gPiAgIAkJCQkxKTsKPiA+IEBAIC0zNzIyLDIzICszNzIyLDIzIEBAIGludGVsX2Rpc2FibGVf
c2FndihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiBTb21lIHNr
bCBzeXN0ZW1zLCBwcmUtcmVsZWFzZSBtYWNoaW5lcyBpbiBwYXJ0aWN1bGFyLAo+ID4gICAJICog
ZG9uJ3QgYWN0dWFsbHkgaGF2ZSBTQUdWLgo+ID4gICAJICovCj4gPiAtCWlmIChJU19TS1lMQUtF
KGRldl9wcml2KSAmJiByZXQgPT0gLUVOWElPKSB7Cj4gPiArCWlmIChJU19TS1lMQUtFKGk5MTUp
ICYmIHJldCA9PSAtRU5YSU8pIHsKPiA+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJObyBTQUdWIGZv
dW5kIG9uIHN5c3RlbSwgaWdub3JpbmdcbiIpOwo+ID4gLQkJZGV2X3ByaXYtPnNhZ3Zfc3RhdHVz
ID0gSTkxNV9TQUdWX05PVF9DT05UUk9MTEVEOwo+ID4gKwkJaTkxNS0+c2Fndl9zdGF0dXMgPSBJ
OTE1X1NBR1ZfTk9UX0NPTlRST0xMRUQ7Cj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAgIAl9IGVsc2Ug
aWYgKHJldCA8IDApIHsKPiA+ICAgCQlEUk1fRVJST1IoIkZhaWxlZCB0byBkaXNhYmxlIFNBR1Yg
KCVkKVxuIiwgcmV0KTsKPiA+ICAgCQlyZXR1cm4gcmV0Owo+ID4gICAJfQo+ID4gLQlkZXZfcHJp
di0+c2Fndl9zdGF0dXMgPSBJOTE1X1NBR1ZfRElTQUJMRUQ7Cj4gPiArCWk5MTUtPnNhZ3Zfc3Rh
dHVzID0gSTkxNV9TQUdWX0RJU0FCTEVEOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+ICAg
Ym9vbCBpbnRlbF9jYW5fZW5hYmxlX3NhZ3Yoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRl
KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gc3RhdGUtPmRldjsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0YXRlID0gdG9faW50ZWxfYXRvbWljX3N0
YXRlKHN0YXRlKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ID4gICAJc3RydWN0
IGludGVsX3BsYW5lICpwbGFuZTsKPiA+IEBAIC0zNzQ3LDEyICszNzQ3LDEyIEBAIGJvb2wgaW50
ZWxfY2FuX2VuYWJsZV9zYWd2KHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAg
CWludCBsZXZlbCwgbGF0ZW5jeTsKPiA+ICAgCWludCBzYWd2X2Jsb2NrX3RpbWVfdXM7Cj4gPiAt
CWlmICghaW50ZWxfaGFzX3NhZ3YoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIWludGVsX2hhc19zYWd2
KGk5MTUpKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwg
OSkpCj4gPiArCWlmIChJU19HRU4oaTkxNSwgOSkpCj4gPiAgIAkJc2Fndl9ibG9ja190aW1lX3Vz
ID0gMzA7Cj4gPiAtCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMTApKQo+ID4gKwllbHNlIGlm
IChJU19HRU4oaTkxNSwgMTApKQo+ID4gICAJCXNhZ3ZfYmxvY2tfdGltZV91cyA9IDIwOwo+ID4g
ICAJZWxzZQo+ID4gICAJCXNhZ3ZfYmxvY2tfdGltZV91cyA9IDEwOwo+ID4gQEAgLTM3NzIsNyAr
Mzc3Miw3IEBAIGJvb2wgaW50ZWxfY2FuX2VuYWJsZV9zYWd2KHN0cnVjdCBkcm1fYXRvbWljX3N0
YXRlICpzdGF0ZSkKPiA+ICAgCS8qIFNpbmNlIHdlJ3JlIG5vdyBndWFyYW50ZWVkIHRvIG9ubHkg
aGF2ZSBvbmUgYWN0aXZlIENSVEMuLi4gKi8KPiA+ICAgCXBpcGUgPSBmZnMoaW50ZWxfc3RhdGUt
PmFjdGl2ZV9jcnRjcykgLSAxOwo+ID4gLQljcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUo
ZGV2X3ByaXYsIHBpcGUpOwo+ID4gKwljcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoaTkx
NSwgcGlwZSk7Cj4gPiAgIAljc3RhdGUgPSB0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uu
c3RhdGUpOwo+ID4gICAJaWYgKGNydGMtPmJhc2Uuc3RhdGUtPmFkanVzdGVkX21vZGUuZmxhZ3Mg
JiBEUk1fTU9ERV9GTEFHX0lOVEVSTEFDRSkKPiA+IEBAIC0zNzg3LDEzICszNzg3LDEzIEBAIGJv
b2wgaW50ZWxfY2FuX2VuYWJsZV9zYWd2KHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkK
PiA+ICAgCQkJY29udGludWU7Cj4gPiAgIAkJLyogRmluZCB0aGUgaGlnaGVzdCBlbmFibGVkIHdt
IGxldmVsIGZvciB0aGlzIHBsYW5lICovCj4gPiAtCQlmb3IgKGxldmVsID0gaWxrX3dtX21heF9s
ZXZlbChkZXZfcHJpdik7Cj4gPiArCQlmb3IgKGxldmVsID0gaWxrX3dtX21heF9sZXZlbChpOTE1
KTsKPiA+ICAgCQkgICAgICF3bS0+d21bbGV2ZWxdLnBsYW5lX2VuOyAtLWxldmVsKQo+ID4gICAJ
CSAgICAgeyB9Cj4gPiAtCQlsYXRlbmN5ID0gZGV2X3ByaXYtPndtLnNrbF9sYXRlbmN5W2xldmVs
XTsKPiA+ICsJCWxhdGVuY3kgPSBpOTE1LT53bS5za2xfbGF0ZW5jeVtsZXZlbF07Cj4gPiAtCQlp
ZiAoc2tsX25lZWRzX21lbW9yeV9id193YShkZXZfcHJpdikgJiYKPiA+ICsJCWlmIChza2xfbmVl
ZHNfbWVtb3J5X2J3X3dhKGk5MTUpICYmCj4gPiAgIAkJICAgIHBsYW5lLT5iYXNlLnN0YXRlLT5m
Yi0+bW9kaWZpZXIgPT0KPiA+ICAgCQkgICAgSTkxNV9GT1JNQVRfTU9EX1hfVElMRUQpCj4gPiAg
IAkJCWxhdGVuY3kgKz0gMTU7Cj4gPiBAQCAtMzgxMCw3ICszODEwLDcgQEAgYm9vbCBpbnRlbF9j
YW5fZW5hYmxlX3NhZ3Yoc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICAJcmV0
dXJuIHRydWU7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdTE2IGludGVsX2dldF9kZGJfc2l6ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHUxNiBpbnRlbF9nZXRf
ZGRiX3NpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgIGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gPiAgIAkJCSAgICAgIGNvbnN0
IHU2NCB0b3RhbF9kYXRhX3JhdGUsCj4gPiAgIAkJCSAgICAgIGNvbnN0IGludCBudW1fYWN0aXZl
LAo+ID4gQEAgLTM4MTgsMTEgKzM4MTgsMTEgQEAgc3RhdGljIHUxNiBpbnRlbF9nZXRfZGRiX3Np
emUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICB7Cj4gPiAgIAljb25z
dCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZTsKPiA+ICAgCXU2NCB0b3Rh
bF9kYXRhX2J3Owo+ID4gLQl1MTYgZGRiX3NpemUgPSBJTlRFTF9JTkZPKGRldl9wcml2KS0+ZGRi
X3NpemU7Cj4gPiArCXUxNiBkZGJfc2l6ZSA9IElOVEVMX0lORk8oaTkxNSktPmRkYl9zaXplOwo+
ID4gICAJV0FSTl9PTihkZGJfc2l6ZSA9PSAwKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPCAxMSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA8IDExKQo+ID4gICAJCXJldHVybiBk
ZGJfc2l6ZSAtIDQ7IC8qIDQgYmxvY2tzIGZvciBieXBhc3MgcGF0aCBhbGxvY2F0aW9uICovCj4g
PiAgIAlhZGp1c3RlZF9tb2RlID0gJmNzdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ID4gQEAg
LTM4NDcsNyArMzg0Nyw3IEBAIHN0YXRpYyB1MTYgaW50ZWxfZ2V0X2RkYl9zaXplKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZAo+ID4g
LXNrbF9kZGJfZ2V0X3BpcGVfYWxsb2NhdGlvbl9saW1pdHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK3NrbF9kZGJfZ2V0X3BpcGVfYWxsb2NhdGlvbl9saW1pdHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ID4gICAJCQkJICAgY29uc3QgdTY0IHRvdGFsX2RhdGFf
cmF0ZSwKPiA+ICAgCQkJCSAgIHN0cnVjdCBza2xfZGRiX2FsbG9jYXRpb24gKmRkYiwKPiA+IEBA
IC0zODY3LDE2ICszODY3LDE2IEBAIHNrbF9kZGJfZ2V0X3BpcGVfYWxsb2NhdGlvbl9saW1pdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJaWYgKFdBUk5fT04oIXN0
YXRlKSB8fCAhY3N0YXRlLT5iYXNlLmFjdGl2ZSkgewo+ID4gICAJCWFsbG9jLT5zdGFydCA9IDA7
Cj4gPiAgIAkJYWxsb2MtPmVuZCA9IDA7Cj4gPiAtCQkqbnVtX2FjdGl2ZSA9IGh3ZWlnaHQzMihk
ZXZfcHJpdi0+YWN0aXZlX2NydGNzKTsKPiA+ICsJCSpudW1fYWN0aXZlID0gaHdlaWdodDMyKGk5
MTUtPmFjdGl2ZV9jcnRjcyk7Cj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJfQo+ID4gICAJaWYgKGlu
dGVsX3N0YXRlLT5hY3RpdmVfcGlwZV9jaGFuZ2VzKQo+ID4gICAJCSpudW1fYWN0aXZlID0gaHdl
aWdodDMyKGludGVsX3N0YXRlLT5hY3RpdmVfY3J0Y3MpOwo+ID4gICAJZWxzZQo+ID4gLQkJKm51
bV9hY3RpdmUgPSBod2VpZ2h0MzIoZGV2X3ByaXYtPmFjdGl2ZV9jcnRjcyk7Cj4gPiArCQkqbnVt
X2FjdGl2ZSA9IGh3ZWlnaHQzMihpOTE1LT5hY3RpdmVfY3J0Y3MpOwo+ID4gLQlkZGJfc2l6ZSA9
IGludGVsX2dldF9kZGJfc2l6ZShkZXZfcHJpdiwgY3N0YXRlLCB0b3RhbF9kYXRhX3JhdGUsCj4g
PiArCWRkYl9zaXplID0gaW50ZWxfZ2V0X2RkYl9zaXplKGk5MTUsIGNzdGF0ZSwgdG90YWxfZGF0
YV9yYXRlLAo+ID4gICAJCQkJICAgICAgKm51bV9hY3RpdmUsIGRkYik7Cj4gPiAgIAkvKgo+ID4g
QEAgLTM5MzksOCArMzkzOSw4IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQKPiA+ICAgc2tsX2N1cnNv
cl9hbGxvY2F0aW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ID4gICAJCSAgICAgIGludCBudW1fYWN0aXZlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYp
Owo+ID4gLQlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYp
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gKwlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9t
YXhfbGV2ZWwoaTkxNSk7Cj4gPiAgIAlzdHJ1Y3Qgc2tsX3dtX2xldmVsIHdtID0ge307Cj4gPiAg
IAlpbnQgcmV0LCBtaW5fZGRiX2FsbG9jID0gMDsKPiA+ICAgCXN0cnVjdCBza2xfd21fcGFyYW1z
IHdwOwo+ID4gQEAgLTM5NjMsNyArMzk2Myw3IEBAIHNrbF9jdXJzb3JfYWxsb2NhdGlvbihjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCXJldHVybiBtYXgo
bnVtX2FjdGl2ZSA9PSAxID8gMzIgOiA4LCBtaW5fZGRiX2FsbG9jKTsKPiA+ICAgfQo+ID4gLXN0
YXRpYyB2b2lkIHNrbF9kZGJfZW50cnlfaW5pdF9mcm9tX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBza2xfZGRiX2VudHJ5X2luaXRfZnJvbV9o
dyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAgICBzdHJ1Y3Qg
c2tsX2RkYl9lbnRyeSAqZW50cnksIHUzMiByZWcpCj4gPiAgIHsKPiA+IEBAIC0zOTc1LDcgKzM5
NzUsNyBAQCBzdGF0aWMgdm9pZCBza2xfZGRiX2VudHJ5X2luaXRfZnJvbV9odyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQKPiA+IC1z
a2xfZGRiX2dldF9od19wbGFuZV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiArc2tsX2RkYl9nZXRfaHdfcGxhbmVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCj4gPiAgIAkJCSAgIGNvbnN0IGVudW0gcGlwZSBwaXBlLAo+ID4gICAJCQkgICBj
b25zdCBlbnVtIHBsYW5lX2lkIHBsYW5lX2lkLAo+ID4gICAJCQkgICBzdHJ1Y3Qgc2tsX2RkYl9l
bnRyeSAqZGRiX3ksCj4gPiBAQCAtMzk4Nyw3ICszOTg3LDcgQEAgc2tsX2RkYl9nZXRfaHdfcGxh
bmVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJLyogQ3Vy
c29yIGRvZXNuJ3Qgc3VwcG9ydCBOVjEyL3BsYW5hciwgc28gbm8gZXh0cmEgY2FsY3VsYXRpb24g
bmVlZGVkICovCj4gPiAgIAlpZiAocGxhbmVfaWQgPT0gUExBTkVfQ1VSU09SKSB7Cj4gPiAgIAkJ
dmFsID0gSTkxNV9SRUFEKENVUl9CVUZfQ0ZHKHBpcGUpKTsKPiA+IC0JCXNrbF9kZGJfZW50cnlf
aW5pdF9mcm9tX2h3KGRldl9wcml2LCBkZGJfeSwgdmFsKTsKPiA+ICsJCXNrbF9kZGJfZW50cnlf
aW5pdF9mcm9tX2h3KGk5MTUsIGRkYl95LCB2YWwpOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0K
PiA+IEBAIC0zOTk5LDkgKzM5OTksOSBAQCBza2xfZGRiX2dldF9od19wbGFuZV9zdGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJCQkJICAgICAgdmFsICYgUExB
TkVfQ1RMX09SREVSX1JHQlgsCj4gPiAgIAkJCQkJICAgICAgdmFsICYgUExBTkVfQ1RMX0FMUEhB
X01BU0spOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+ID4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDExKSB7Cj4gPiAgIAkJdmFsID0gSTkxNV9SRUFEKFBMQU5FX0JV
Rl9DRkcocGlwZSwgcGxhbmVfaWQpKTsKPiA+IC0JCXNrbF9kZGJfZW50cnlfaW5pdF9mcm9tX2h3
KGRldl9wcml2LCBkZGJfeSwgdmFsKTsKPiA+ICsJCXNrbF9kZGJfZW50cnlfaW5pdF9mcm9tX2h3
KGk5MTUsIGRkYl95LCB2YWwpOwo+ID4gICAJfSBlbHNlIHsKPiA+ICAgCQl2YWwgPSBJOTE1X1JF
QUQoUExBTkVfQlVGX0NGRyhwaXBlLCBwbGFuZV9pZCkpOwo+ID4gICAJCXZhbDIgPSBJOTE1X1JF
QUQoUExBTkVfTlYxMl9CVUZfQ0ZHKHBpcGUsIHBsYW5lX2lkKSk7Cj4gPiBAQCAtNDAwOSw4ICs0
MDA5LDggQEAgc2tsX2RkYl9nZXRfaHdfcGxhbmVfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gICAJCWlmIChpc19wbGFuYXJfeXV2X2Zvcm1hdChmb3VyY2MpKQo+
ID4gICAJCQlzd2FwKHZhbCwgdmFsMik7Cj4gPiAtCQlza2xfZGRiX2VudHJ5X2luaXRfZnJvbV9o
dyhkZXZfcHJpdiwgZGRiX3ksIHZhbCk7Cj4gPiAtCQlza2xfZGRiX2VudHJ5X2luaXRfZnJvbV9o
dyhkZXZfcHJpdiwgZGRiX3V2LCB2YWwyKTsKPiA+ICsJCXNrbF9kZGJfZW50cnlfaW5pdF9mcm9t
X2h3KGk5MTUsIGRkYl95LCB2YWwpOwo+ID4gKwkJc2tsX2RkYl9lbnRyeV9pbml0X2Zyb21faHco
aTkxNSwgZGRiX3V2LCB2YWwyKTsKPiA+ICAgCX0KPiA+ICAgfQo+ID4gQEAgLTQwMTgsMzAgKzQw
MTgsMzAgQEAgdm9pZCBza2xfcGlwZV9kZGJfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjLAo+ID4gICAJCQkgICAgICAgc3RydWN0IHNrbF9kZGJfZW50cnkgKmRkYl95LAo+ID4g
ICAJCQkgICAgICAgc3RydWN0IHNrbF9kZGJfZW50cnkgKmRkYl91dikKPiA+ICAgewo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMtPmJh
c2UuZGV2KTsKPiA+ICAgCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9t
YWluOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7Cj4gPiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkOwo+ID4gICAJcG93
ZXJfZG9tYWluID0gUE9XRVJfRE9NQUlOX1BJUEUocGlwZSk7Cj4gPiAtCXdha2VyZWYgPSBpbnRl
bF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2LCBwb3dlcl9kb21haW4pOwo+
ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LCBw
b3dlcl9kb21haW4pOwo+ID4gICAJaWYgKCF3YWtlcmVmKQo+ID4gICAJCXJldHVybjsKPiA+ICAg
CWZvcl9lYWNoX3BsYW5lX2lkX29uX2NydGMoY3J0YywgcGxhbmVfaWQpCj4gPiAtCQlza2xfZGRi
X2dldF9od19wbGFuZV9zdGF0ZShkZXZfcHJpdiwgcGlwZSwKPiA+ICsJCXNrbF9kZGJfZ2V0X2h3
X3BsYW5lX3N0YXRlKGk5MTUsIHBpcGUsCj4gPiAgIAkJCQkJICAgcGxhbmVfaWQsCj4gPiAgIAkJ
CQkJICAgJmRkYl95W3BsYW5lX2lkXSwKPiA+ICAgCQkJCQkgICAmZGRiX3V2W3BsYW5lX2lkXSk7
Cj4gPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBwb3dlcl9kb21haW4sIHdh
a2VyZWYpOwo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBwb3dlcl9kb21haW4s
IHdha2VyZWYpOwo+ID4gICB9Cj4gPiAtdm9pZCBza2xfZGRiX2dldF9od19zdGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBza2xfZGRiX2dldF9od19zdGF0
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICBzdHJ1Y3Qgc2tsX2Rk
Yl9hbGxvY2F0aW9uICpkZGIgLyogb3V0ICovKQo+ID4gICB7Cj4gPiAtCWRkYi0+ZW5hYmxlZF9z
bGljZXMgPSBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bShkZXZfcHJpdik7Cj4gPiArCWRk
Yi0+ZW5hYmxlZF9zbGljZXMgPSBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bShpOTE1KTsK
PiA+ICAgfQo+ID4gICAvKgo+ID4gQEAgLTQxMzgsNyArNDEzOCw3IEBAIHNrbF9waXBlX2Rvd25z
Y2FsZV9hbW91bnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4g
PiAgIGludCBza2xfY2hlY2tfcGlwZV9tYXhfcGl4ZWxfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAq
aW50ZWxfY3J0YywKPiA+ICAgCQkJCSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSkK
PiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGludGVsX2NydGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGludGVsX2NydGMtPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBkcm1fY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9ICZjc3RhdGUtPmJhc2U7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2F0
b21pY19zdGF0ZSAqc3RhdGUgPSBjcnRjX3N0YXRlLT5zdGF0ZTsKPiA+ICAgCXN0cnVjdCBkcm1f
cGxhbmUgKnBsYW5lOwo+ID4gQEAgLTQxODEsNyArNDE4MSw3IEBAIGludCBza2xfY2hlY2tfcGlw
ZV9tYXhfcGl4ZWxfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywKPiA+ICAgCWNy
dGNfY2xvY2sgPSBjcnRjX3N0YXRlLT5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7Cj4gPiAgIAlk
b3RjbGsgPSB0b19pbnRlbF9hdG9taWNfc3RhdGUoc3RhdGUpLT5jZGNsay5sb2dpY2FsLmNkY2xr
Owo+ID4gLQlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSU5URUxfR0VOKGRldl9wcml2
KSA+PSAxMCkKPiA+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkgfHwgSU5URUxfR0VOKGk5MTUp
ID49IDEwKQo+ID4gICAJCWRvdGNsayAqPSAyOwo+ID4gICAJcGlwZV9tYXhfcGl4ZWxfcmF0ZSA9
IGRpdl9yb3VuZF91cF91MzJfZml4ZWQxNihkb3RjbGssIHBpcGVfZG93bnNjYWxlKTsKPiA+IEBA
IC00MzQxLDcgKzQzNDEsNyBAQCBza2xfYWxsb2NhdGVfcGlwZV9kZGIoc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNzdGF0ZSwKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9hdG9taWNfc3RhdGUg
KnN0YXRlID0gY3N0YXRlLT5iYXNlLnN0YXRlOwo+ID4gICAJc3RydWN0IGRybV9jcnRjICpjcnRj
ID0gY3N0YXRlLT5iYXNlLmNydGM7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGNydGMtPmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50
ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4gPiAgIAlzdHJ1Y3Qgc2tsX2RkYl9lbnRy
eSAqYWxsb2MgPSAmY3N0YXRlLT53bS5za2wuZGRiOwo+ID4gICAJdTE2IGFsbG9jX3NpemUsIHN0
YXJ0ID0gMDsKPiA+IEBAIC00MzY3LDcgKzQzNjcsNyBAQCBza2xfYWxsb2NhdGVfcGlwZV9kZGIo
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiA+ICAgCQlyZXR1cm4gMDsKPiA+ICAg
CX0KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gPiArCWlmIChJTlRFTF9H
RU4oaTkxNSkgPj0gMTEpCj4gPiAgIAkJdG90YWxfZGF0YV9yYXRlID0KPiA+ICAgCQkJaWNsX2dl
dF90b3RhbF9yZWxhdGl2ZV9kYXRhX3JhdGUoY3N0YXRlLAo+ID4gICAJCQkJCQkJIHBsYW5lX2Rh
dGFfcmF0ZSk7Cj4gPiBAQCAtNDM3OCw3ICs0Mzc4LDcgQEAgc2tsX2FsbG9jYXRlX3BpcGVfZGRi
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gPiAgIAkJCQkJCQkgdXZfcGxhbmVf
ZGF0YV9yYXRlKTsKPiA+IC0Jc2tsX2RkYl9nZXRfcGlwZV9hbGxvY2F0aW9uX2xpbWl0cyhkZXZf
cHJpdiwgY3N0YXRlLCB0b3RhbF9kYXRhX3JhdGUsCj4gPiArCXNrbF9kZGJfZ2V0X3BpcGVfYWxs
b2NhdGlvbl9saW1pdHMoaTkxNSwgY3N0YXRlLCB0b3RhbF9kYXRhX3JhdGUsCj4gPiAgIAkJCQkJ
ICAgZGRiLCBhbGxvYywgJm51bV9hY3RpdmUpOwo+ID4gICAJYWxsb2Nfc2l6ZSA9IHNrbF9kZGJf
ZW50cnlfc2l6ZShhbGxvYyk7Cj4gPiAgIAlpZiAoYWxsb2Nfc2l6ZSA9PSAwKQo+ID4gQEAgLTQz
OTgsNyArNDM5OCw3IEBAIHNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3N0YXRlLAo+ID4gICAJICogRmluZCB0aGUgaGlnaGVzdCB3YXRlcm1hcmsgbGV2ZWwg
Zm9yIHdoaWNoIHdlIGNhbiBzYXRpc2Z5IHRoZSBibG9jawo+ID4gICAJICogcmVxdWlyZW1lbnQg
b2YgYWN0aXZlIHBsYW5lcy4KPiA+ICAgCSAqLwo+ID4gLQlmb3IgKGxldmVsID0gaWxrX3dtX21h
eF9sZXZlbChkZXZfcHJpdik7IGxldmVsID49IDA7IGxldmVsLS0pIHsKPiA+ICsJZm9yIChsZXZl
bCA9IGlsa193bV9tYXhfbGV2ZWwoaTkxNSk7IGxldmVsID49IDA7IGxldmVsLS0pIHsKPiA+ICAg
CQlibG9ja3MgPSAwOwo+ID4gICAJCWZvcl9lYWNoX3BsYW5lX2lkX29uX2NydGMoaW50ZWxfY3J0
YywgcGxhbmVfaWQpIHsKPiA+ICAgCQkJY29uc3Qgc3RydWN0IHNrbF9wbGFuZV93bSAqd20gPQo+
ID4gQEAgLTQ0ODQsNyArNDQ4NCw3IEBAIHNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ID4gICAJCQljb250aW51ZTsKPiA+ICAgCQkvKiBHZW4x
MSsgdXNlcyBhIHNlcGFyYXRlIHBsYW5lIGZvciBVViB3YXRlcm1hcmtzICovCj4gPiAtCQlXQVJO
X09OKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEgJiYgdXZfdG90YWxbcGxhbmVfaWRdKTsKPiA+
ICsJCVdBUk5fT04oSU5URUxfR0VOKGk5MTUpID49IDExICYmIHV2X3RvdGFsW3BsYW5lX2lkXSk7
Cj4gPiAgIAkJLyogTGVhdmUgZGlzYWJsZWQgcGxhbmVzIGF0ICgwLDApICovCj4gPiAgIAkJaWYg
KHRvdGFsW3BsYW5lX2lkXSkgewo+ID4gQEAgLTQ1MDYsNyArNDUwNiw3IEBAIHNrbF9hbGxvY2F0
ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ID4gICAJICogYWxs
IGxldmVscyBhcyAiZW5hYmxlZC4iICBHbyBiYWNrIG5vdyBhbmQgZGlzYWJsZSB0aGUgb25lcwo+
ID4gICAJICogdGhhdCBhcmVuJ3QgYWN0dWFsbHkgcG9zc2libGUuCj4gPiAgIAkgKi8KPiA+IC0J
Zm9yIChsZXZlbCsrOyBsZXZlbCA8PSBpbGtfd21fbWF4X2xldmVsKGRldl9wcml2KTsgbGV2ZWwr
Kykgewo+ID4gKwlmb3IgKGxldmVsKys7IGxldmVsIDw9IGlsa193bV9tYXhfbGV2ZWwoaTkxNSk7
IGxldmVsKyspIHsKPiA+ICAgCQlmb3JfZWFjaF9wbGFuZV9pZF9vbl9jcnRjKGludGVsX2NydGMs
IHBsYW5lX2lkKSB7Cj4gPiAgIAkJCXN0cnVjdCBza2xfcGxhbmVfd20gKndtID0KPiA+ICAgCQkJ
CSZjc3RhdGUtPndtLnNrbC5vcHRpbWFsLnBsYW5lc1twbGFuZV9pZF07Cj4gPiBAQCAtNDUzMSw3
ICs0NTMxLDcgQEAgc2tsX2FsbG9jYXRlX3BpcGVfZGRiKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjc3RhdGUsCj4gPiAgIAkJCSAqIFdhXzE0MDg5NjEwMDg6aWNsLCBlaGwKPiA+ICAgCQkJICog
VW5kZXJydW5zIHdpdGggV00xKyBkaXNhYmxlZAo+ID4gICAJCQkgKi8KPiA+IC0JCQlpZiAoSVNf
R0VOKGRldl9wcml2LCAxMSkgJiYKPiA+ICsJCQlpZiAoSVNfR0VOKGk5MTUsIDExKSAmJgo+ID4g
ICAJCQkgICAgbGV2ZWwgPT0gMSAmJiB3bS0+d21bMF0ucGxhbmVfZW4pIHsKPiA+ICAgCQkJCXdt
LT53bVtsZXZlbF0ucGxhbmVfcmVzX2IgPSB3bS0+d21bMF0ucGxhbmVfcmVzX2I7Cj4gPiAgIAkJ
CQl3bS0+d21bbGV2ZWxdLnBsYW5lX3Jlc19sID0gd20tPndtWzBdLnBsYW5lX3Jlc19sOwo+ID4g
QEAgLTQ1NjIsNyArNDU2Miw3IEBAIHNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3N0YXRlLAo+ID4gICAgKiAyeGNkY2xrIGlzIDEzNTAgTUh6IGFuZCB0aGUg
cGl4ZWwgcmF0ZSBzaG91bGQgbmV2ZXIgZXhjZWVkIHRoYXQuCj4gPiAgICovCj4gPiAgIHN0YXRp
YyB1aW50X2ZpeGVkXzE2XzE2X3QKPiA+IC1za2xfd21fbWV0aG9kMShjb25zdCBzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwaXhlbF9yYXRlLAo+ID4gK3NrbF93bV9tZXRo
b2QxKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcGl4ZWxfcmF0ZSwK
PiA+ICAgCSAgICAgICB1OCBjcHAsIHUzMiBsYXRlbmN5LCB1MzIgZGJ1Zl9ibG9ja19zaXplKQo+
ID4gICB7Cj4gPiAgIAl1MzIgd21faW50ZXJtZWRpYXRlX3ZhbDsKPiA+IEBAIC00NTc0LDcgKzQ1
NzQsNyBAQCBza2xfd21fbWV0aG9kMShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIHUzMiBwaXhlbF9yYXRlLAo+ID4gICAJd21faW50ZXJtZWRpYXRlX3ZhbCA9IGxhdGVu
Y3kgKiBwaXhlbF9yYXRlICogY3BwOwo+ID4gICAJcmV0ID0gZGl2X2ZpeGVkMTYod21faW50ZXJt
ZWRpYXRlX3ZhbCwgMTAwMCAqIGRidWZfYmxvY2tfc2l6ZSk7Cj4gPiAtCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDEwKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwKQo+ID4gICAJ
CXJldCA9IGFkZF9maXhlZDE2X3UzMihyZXQsIDEpOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+IEBA
IC00NjQ4LDcgKzQ2NDgsNyBAQCBza2xfY29tcHV0ZV93bV9wYXJhbXMoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJICAgICAgaW50IGNvbG9yX3BsYW5l
KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAl1MzIgaW50ZXJt
X3BicGw7Cj4gPiAgIAkvKiBvbmx5IHBsYW5hciBmb3JtYXQgaGFzIHR3byBwbGFuZXMgKi8KPiA+
IEBAIC00NjczLDcgKzQ2NzMsNyBAQCBza2xfY29tcHV0ZV93bV9wYXJhbXMoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAl3cC0+Y3BwID0gZm9ybWF0LT5j
cHBbY29sb3JfcGxhbmVdOwo+ID4gICAJd3AtPnBsYW5lX3BpeGVsX3JhdGUgPSBwbGFuZV9waXhl
bF9yYXRlOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSAmJgo+ID4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDExICYmCj4gPiAgIAkgICAgbW9kaWZpZXIgPT0gSTkxNV9GT1JN
QVRfTU9EX1lmX1RJTEVEICAmJiB3cC0+Y3BwID09IDEpCj4gPiAgIAkJd3AtPmRidWZfYmxvY2tf
c2l6ZSA9IDI1NjsKPiA+ICAgCWVsc2UKPiA+IEBAIC00Njk4LDcgKzQ2OTgsNyBAQCBza2xfY29t
cHV0ZV93bV9wYXJhbXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gPiAgIAkJd3AtPnlfbWluX3NjYW5saW5lcyA9IDQ7Cj4gPiAgIAl9Cj4gPiAtCWlmIChza2xf
bmVlZHNfbWVtb3J5X2J3X3dhKGRldl9wcml2KSkKPiA+ICsJaWYgKHNrbF9uZWVkc19tZW1vcnlf
Yndfd2EoaTkxNSkpCj4gPiAgIAkJd3AtPnlfbWluX3NjYW5saW5lcyAqPSAyOwo+ID4gICAJd3At
PnBsYW5lX2J5dGVzX3Blcl9saW5lID0gd3AtPndpZHRoICogd3AtPmNwcDsKPiA+IEBAIC00NzA3
LDEyICs0NzA3LDEyIEBAIHNrbF9jb21wdXRlX3dtX3BhcmFtcyhjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJCQkgICB3cC0+eV9taW5fc2NhbmxpbmVz
LAo+ID4gICAJCQkJCSAgIHdwLT5kYnVmX2Jsb2NrX3NpemUpOwo+ID4gLQkJaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gMTApCj4gPiArCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwKQo+ID4g
ICAJCQlpbnRlcm1fcGJwbCsrOwo+ID4gICAJCXdwLT5wbGFuZV9ibG9ja3NfcGVyX2xpbmUgPSBk
aXZfZml4ZWQxNihpbnRlcm1fcGJwbCwKPiA+ICAgCQkJCQkJCXdwLT55X21pbl9zY2FubGluZXMp
Owo+ID4gLQl9IGVsc2UgaWYgKHdwLT54X3RpbGVkICYmIElTX0dFTihkZXZfcHJpdiwgOSkpIHsK
PiA+ICsJfSBlbHNlIGlmICh3cC0+eF90aWxlZCAmJiBJU19HRU4oaTkxNSwgOSkpIHsKPiA+ICAg
CQlpbnRlcm1fcGJwbCA9IERJVl9ST1VORF9VUCh3cC0+cGxhbmVfYnl0ZXNfcGVyX2xpbmUsCj4g
PiAgIAkJCQkJICAgd3AtPmRidWZfYmxvY2tfc2l6ZSk7Cj4gPiAgIAkJd3AtPnBsYW5lX2Jsb2Nr
c19wZXJfbGluZSA9IHUzMl90b19maXhlZDE2KGludGVybV9wYnBsKTsKPiA+IEBAIC00NzU4LDkg
KzQ3NTgsOSBAQCBza2xfY29tcHV0ZV9wbGFuZV93bV9wYXJhbXMoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCQkgICAgIHdwLCBjb2xvcl9wbGFuZSk7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBza2xfd21faGFzX2xpbmVzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgaW50IGxldmVsKQo+ID4gK3N0YXRpYyBib29sIHNrbF93bV9o
YXNfbGluZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCBsZXZlbCkKPiA+ICAg
ewo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGRl
dl9wcml2KSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCB8fCBJU19HRU1JTklMQUtF
KGk5MTUpKQo+ID4gICAJCXJldHVybiB0cnVlOwo+ID4gICAJLyogVGhlIG51bWJlciBvZiBsaW5l
cyBhcmUgaWdub3JlZCBmb3IgdGhlIGxldmVsIDAgd2F0ZXJtYXJrLiAqLwo+ID4gQEAgLTQ3NzMs
OCArNDc3Myw4IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21wdXRlX3BsYW5lX3dtKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gPiAgIAkJCQkgY29uc3Qgc3RydWN0IHNrbF93
bV9sZXZlbCAqcmVzdWx0X3ByZXYsCj4gPiAgIAkJCQkgc3RydWN0IHNrbF93bV9sZXZlbCAqcmVz
dWx0IC8qIG91dCAqLykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gLQl1MzIgbGF0ZW5j
eSA9IGRldl9wcml2LT53bS5za2xfbGF0ZW5jeVtsZXZlbF07Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICsJ
dTMyIGxhdGVuY3kgPSBpOTE1LT53bS5za2xfbGF0ZW5jeVtsZXZlbF07Cj4gPiAgIAl1aW50X2Zp
eGVkXzE2XzE2X3QgbWV0aG9kMSwgbWV0aG9kMjsKPiA+ICAgCXVpbnRfZml4ZWRfMTZfMTZfdCBz
ZWxlY3RlZF9yZXN1bHQ7Cj4gPiAgIAl1MzIgcmVzX2Jsb2NrcywgcmVzX2xpbmVzLCBtaW5fZGRi
X2FsbG9jID0gMDsKPiA+IEBAIC00Nzg5LDE0ICs0Nzg5LDE0IEBAIHN0YXRpYyB2b2lkIHNrbF9j
b21wdXRlX3BsYW5lX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4g
PiAgIAkgKiBXYUluY3JlYXNlTGF0ZW5jeUlQQ0VuYWJsZWQ6IGtibCxjZmwKPiA+ICAgCSAqIERp
c3BsYXkgV0EgIzExNDE6IGtibCxjZmwKPiA+ICAgCSAqLwo+ID4gLQlpZiAoKElTX0tBQllMQUtF
KGRldl9wcml2KSB8fCBJU19DT0ZGRUVMQUtFKGRldl9wcml2KSkgfHwKPiA+IC0JICAgIGRldl9w
cml2LT5pcGNfZW5hYmxlZCkKPiA+ICsJaWYgKChJU19LQUJZTEFLRShpOTE1KSB8fCBJU19DT0ZG
RUVMQUtFKGk5MTUpKSB8fAo+ID4gKwkgICAgaTkxNS0+aXBjX2VuYWJsZWQpCj4gPiAgIAkJbGF0
ZW5jeSArPSA0Owo+ID4gLQlpZiAoc2tsX25lZWRzX21lbW9yeV9id193YShkZXZfcHJpdikgJiYg
d3AtPnhfdGlsZWQpCj4gPiArCWlmIChza2xfbmVlZHNfbWVtb3J5X2J3X3dhKGk5MTUpICYmIHdw
LT54X3RpbGVkKQo+ID4gICAJCWxhdGVuY3kgKz0gMTU7Cj4gPiAtCW1ldGhvZDEgPSBza2xfd21f
bWV0aG9kMShkZXZfcHJpdiwgd3AtPnBsYW5lX3BpeGVsX3JhdGUsCj4gPiArCW1ldGhvZDEgPSBz
a2xfd21fbWV0aG9kMShpOTE1LCB3cC0+cGxhbmVfcGl4ZWxfcmF0ZSwKPiA+ICAgCQkJCSB3cC0+
Y3BwLCBsYXRlbmN5LCB3cC0+ZGJ1Zl9ibG9ja19zaXplKTsKPiA+ICAgCW1ldGhvZDIgPSBza2xf
d21fbWV0aG9kMih3cC0+cGxhbmVfcGl4ZWxfcmF0ZSwKPiA+ICAgCQkJCSBjc3RhdGUtPmJhc2Uu
YWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCwKPiA+IEBAIC00ODExLDggKzQ4MTEsOCBAQCBzdGF0
aWMgdm9pZCBza2xfY29tcHV0ZV9wbGFuZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3N0YXRlLAo+ID4gICAJCSAgICAgKHdwLT5wbGFuZV9ieXRlc19wZXJfbGluZSAvIHdwLT5k
YnVmX2Jsb2NrX3NpemUgPCAxKSkgewo+ID4gICAJCQlzZWxlY3RlZF9yZXN1bHQgPSBtZXRob2Qy
Owo+ID4gICAJCX0gZWxzZSBpZiAobGF0ZW5jeSA+PSB3cC0+bGluZXRpbWVfdXMpIHsKPiA+IC0J
CQlpZiAoSVNfR0VOKGRldl9wcml2LCA5KSAmJgo+ID4gLQkJCSAgICAhSVNfR0VNSU5JTEFLRShk
ZXZfcHJpdikpCj4gPiArCQkJaWYgKElTX0dFTihpOTE1LCA5KSAmJgo+ID4gKwkJCSAgICAhSVNf
R0VNSU5JTEFLRShpOTE1KSkKPiA+ICAgCQkJCXNlbGVjdGVkX3Jlc3VsdCA9IG1pbl9maXhlZDE2
KG1ldGhvZDEsIG1ldGhvZDIpOwo+ID4gICAJCQllbHNlCj4gPiAgIAkJCQlzZWxlY3RlZF9yZXN1
bHQgPSBtZXRob2QyOwo+ID4gQEAgLTQ4MjUsNyArNDgyNSw3IEBAIHN0YXRpYyB2b2lkIHNrbF9j
b21wdXRlX3BsYW5lX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4g
PiAgIAlyZXNfbGluZXMgPSBkaXZfcm91bmRfdXBfZml4ZWQxNihzZWxlY3RlZF9yZXN1bHQsCj4g
PiAgIAkJCQkJIHdwLT5wbGFuZV9ibG9ja3NfcGVyX2xpbmUpOwo+ID4gLQlpZiAoSVNfR0VOOV9C
QyhkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0dFTjlf
QkMoaTkxNSkgfHwgSVNfQlJPWFRPTihpOTE1KSkgewo+ID4gICAJCS8qIERpc3BsYXkgV0EgIzEx
MjU6IHNrbCxieHQsa2JsICovCj4gPiAgIAkJaWYgKGxldmVsID09IDAgJiYgd3AtPnJjX3N1cmZh
Y2UpCj4gPiAgIAkJCXJlc19ibG9ja3MgKz0KPiA+IEBAIC00ODUyLDcgKzQ4NTIsNyBAQCBzdGF0
aWMgdm9pZCBza2xfY29tcHV0ZV9wbGFuZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3N0YXRlLAo+ID4gICAJCX0KPiA+ICAgCX0KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPj0gMTEpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgewo+ID4gICAJCWlm
ICh3cC0+eV90aWxlZCkgewo+ID4gICAJCQlpbnQgZXh0cmFfbGluZXM7Cj4gPiBAQCAtNDg3MCw3
ICs0ODcwLDcgQEAgc3RhdGljIHZvaWQgc2tsX2NvbXB1dGVfcGxhbmVfd20oY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiA+ICAgCQl9Cj4gPiAgIAl9Cj4gPiAtCWlmICgh
c2tsX3dtX2hhc19saW5lcyhkZXZfcHJpdiwgbGV2ZWwpKQo+ID4gKwlpZiAoIXNrbF93bV9oYXNf
bGluZXMoaTkxNSwgbGV2ZWwpKQo+ID4gICAJCXJlc19saW5lcyA9IDA7Cj4gPiAgIAlpZiAocmVz
X2xpbmVzID4gMzEpIHsKPiA+IEBAIC00ODk3LDggKzQ4OTcsOCBAQCBza2xfY29tcHV0ZV93bV9s
ZXZlbHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiA+ICAgCQkgICAg
ICBjb25zdCBzdHJ1Y3Qgc2tsX3dtX3BhcmFtcyAqd21fcGFyYW1zLAo+ID4gICAJCSAgICAgIHN0
cnVjdCBza2xfd21fbGV2ZWwgKmxldmVscykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4g
LQlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3N0YXRlLT5iYXNlLmNy
dGMtPmRldik7Cj4gPiArCWludCBsZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZlbChp
OTE1KTsKPiA+ICAgCXN0cnVjdCBza2xfd21fbGV2ZWwgKnJlc3VsdF9wcmV2ID0gJmxldmVsc1sw
XTsKPiA+ICAgCWZvciAobGV2ZWwgPSAwOyBsZXZlbCA8PSBtYXhfbGV2ZWw7IGxldmVsKyspIHsK
PiA+IEBAIC00OTE1LDcgKzQ5MTUsNyBAQCBzdGF0aWMgdTMyCj4gPiAgIHNrbF9jb21wdXRlX2xp
bmV0aW1lX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4gPiAgIHsK
PiA+ICAgCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IGNzdGF0ZS0+YmFzZS5zdGF0
ZTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0
ZS0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHN0
YXRlLT5kZXYpOwo+ID4gICAJdWludF9maXhlZF8xNl8xNl90IGxpbmV0aW1lX3VzOwo+ID4gICAJ
dTMyIGxpbmV0aW1lX3dtOwo+ID4gQEAgLTQ5MjMsNyArNDkyMyw3IEBAIHNrbF9jb21wdXRlX2xp
bmV0aW1lX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4gPiAgIAls
aW5ldGltZV93bSA9IGZpeGVkMTZfdG9fdTMyX3JvdW5kX3VwKG11bF91MzJfZml4ZWQxNig4LCBs
aW5ldGltZV91cykpOwo+ID4gICAJLyogRGlzcGxheSBXQSAjMTEzNTogQlhUOkFMTCBHTEs6QUxM
ICovCj4gPiAtCWlmIChJU19HRU45X0xQKGRldl9wcml2KSAmJiBkZXZfcHJpdi0+aXBjX2VuYWJs
ZWQpCj4gPiArCWlmIChJU19HRU45X0xQKGk5MTUpICYmIGk5MTUtPmlwY19lbmFibGVkKQo+ID4g
ICAJCWxpbmV0aW1lX3dtIC89IDI7Cj4gPiAgIAlyZXR1cm4gbGluZXRpbWVfd207Cj4gPiBAQCAt
NDkzNCwyMSArNDkzNCwyMSBAQCBzdGF0aWMgdm9pZCBza2xfY29tcHV0ZV90cmFuc2l0aW9uX3dt
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gPiAgIAkJCQkgICAgICBz
dHJ1Y3Qgc2tsX3BsYW5lX3dtICp3bSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9IGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXY7Cj4gPiAtCWNvbnN0IHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJY29uc3Qgc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAl1MTYgdHJhbnNfbWlu
LCB0cmFuc195X3RpbGVfbWluOwo+ID4gICAJY29uc3QgdTE2IHRyYW5zX2Ftb3VudCA9IDEwOyAv
KiBUaGlzIGlzIGNvbmZpZ3VyYWJsZSBhbW91bnQgKi8KPiA+ICAgCXUxNiB3bTBfc2VsX3Jlc19i
LCB0cmFuc19vZmZzZXRfYiwgcmVzX2Jsb2NrczsKPiA+ICAgCS8qIFRyYW5zaXRpb24gV00gYXJl
IG5vdCByZWNvbW1lbmRlZCBieSBIVyB0ZWFtIGZvciBHRU45ICovCj4gPiAtCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpIDw9IDkpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPD0gOSkKPiA+ICAg
CQlyZXR1cm47Cj4gPiAgIAkvKiBUcmFuc2l0aW9uIFdNIGRvbid0IG1ha2UgYW55IHNlbnNlIGlm
IGlwYyBpcyBkaXNhYmxlZCAqLwo+ID4gLQlpZiAoIWRldl9wcml2LT5pcGNfZW5hYmxlZCkKPiA+
ICsJaWYgKCFpOTE1LT5pcGNfZW5hYmxlZCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAl0cmFuc19t
aW4gPSAxNDsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gPiAgIAkJdHJhbnNfbWluID0gNDsKPiA+ICAgCXRyYW5z
X29mZnNldF9iID0gdHJhbnNfbWluICsgdHJhbnNfYW1vdW50Owo+ID4gQEAgLTQ5NzQsNyArNDk3
NCw3IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21wdXRlX3RyYW5zaXRpb25fd20oY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiA+ICAgCQlyZXNfYmxvY2tzID0gd20wX3NlbF9y
ZXNfYiArIHRyYW5zX29mZnNldF9iOwo+ID4gICAJCS8qIFdBIEJVRzoxOTM4NDY2IGFkZCBvbmUg
YmxvY2sgZm9yIG5vbiB5LXRpbGUgcGxhbmVzICovCj4gPiAtCQlpZiAoSVNfQ05MX1JFVklEKGRl
dl9wcml2LCBDTkxfUkVWSURfQTAsIENOTF9SRVZJRF9BMCkpCj4gPiArCQlpZiAoSVNfQ05MX1JF
VklEKGk5MTUsIENOTF9SRVZJRF9BMCwgQ05MX1JFVklEX0EwKSkKPiA+ICAgCQkJcmVzX2Jsb2Nr
cyArPSAxOwo+ID4gICAJfQo+ID4gQEAgLTUwOTMsNyArNTA5Myw3IEBAIHN0YXRpYyBpbnQgaWNs
X2J1aWxkX3BsYW5lX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4g
ICBzdGF0aWMgaW50IHNrbF9idWlsZF9waXBlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
c3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gICAJc3Ry
dWN0IHNrbF9waXBlX3dtICpwaXBlX3dtID0gJmNzdGF0ZS0+d20uc2tsLm9wdGltYWw7Cj4gPiAg
IAlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPSAmY3N0YXRlLT5iYXNlOwo+ID4g
ICAJc3RydWN0IGRybV9wbGFuZSAqcGxhbmU7Cj4gPiBAQCAtNTExMCw3ICs1MTEwLDcgQEAgc3Rh
dGljIGludCBza2xfYnVpbGRfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRl
KQo+ID4gICAJCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqaW50ZWxfcHN0YXRlID0K
PiA+ICAgCQkJCQkJdG9faW50ZWxfcGxhbmVfc3RhdGUocHN0YXRlKTsKPiA+IC0JCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDExKQo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkK
PiA+ICAgCQkJcmV0ID0gaWNsX2J1aWxkX3BsYW5lX3dtKGNzdGF0ZSwgaW50ZWxfcHN0YXRlKTsK
PiA+ICAgCQllbHNlCj4gPiAgIAkJCXJldCA9IHNrbF9idWlsZF9wbGFuZV93bShjc3RhdGUsIGlu
dGVsX3BzdGF0ZSk7Cj4gPiBAQCAtNTEyMyw3ICs1MTIzLDcgQEAgc3RhdGljIGludCBza2xfYnVp
bGRfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQo+ID4gICAJcmV0dXJu
IDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBza2xfZGRiX2VudHJ5X3dyaXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBza2xfZGRiX2VudHJ5
X3dyaXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkJaTkxNV9yZWdf
dCByZWcsCj4gPiAgIAkJCQljb25zdCBzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSAqZW50cnkpCj4gPiAg
IHsKPiA+IEBAIC01MTMzLDcgKzUxMzMsNyBAQCBzdGF0aWMgdm9pZCBza2xfZGRiX2VudHJ5X3dy
aXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQlJOTE1X1dSSVRF
X0ZXKHJlZywgMCk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBza2xfd3JpdGVfd21fbGV2ZWwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyB2b2lkIHNrbF93
cml0ZV93bV9sZXZlbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAg
ICAgIGk5MTVfcmVnX3QgcmVnLAo+ID4gICAJCQkgICAgICAgY29uc3Qgc3RydWN0IHNrbF93bV9s
ZXZlbCAqbGV2ZWwpCj4gPiAgIHsKPiA+IEBAIC01MTUyLDggKzUxNTIsOCBAQCBzdGF0aWMgdm9p
ZCBza2xfd3JpdGVfd21fbGV2ZWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gICB2b2lkIHNrbF93cml0ZV9wbGFuZV93bShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+
ID4gICAJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5l
LT5iYXNlLmRldik7Cj4gPiAtCWludCBsZXZlbCwgbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZl
bChkZXZfcHJpdik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gKwlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9t
YXhfbGV2ZWwoaTkxNSk7Cj4gPiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gcGxhbmUtPmlk
Owo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBwbGFuZS0+cGlwZTsKPiA+ICAgCWNvbnN0IHN0cnVj
dCBza2xfcGxhbmVfd20gKndtID0KPiA+IEBAIC01MTY0LDE0ICs1MTY0LDE0IEBAIHZvaWQgc2ts
X3dyaXRlX3BsYW5lX3dtKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIAkJJmNydGNf
c3RhdGUtPndtLnNrbC5wbGFuZV9kZGJfdXZbcGxhbmVfaWRdOwo+ID4gICAJZm9yIChsZXZlbCA9
IDA7IGxldmVsIDw9IG1heF9sZXZlbDsgbGV2ZWwrKykgewo+ID4gLQkJc2tsX3dyaXRlX3dtX2xl
dmVsKGRldl9wcml2LCBQTEFORV9XTShwaXBlLCBwbGFuZV9pZCwgbGV2ZWwpLAo+ID4gKwkJc2ts
X3dyaXRlX3dtX2xldmVsKGk5MTUsIFBMQU5FX1dNKHBpcGUsIHBsYW5lX2lkLCBsZXZlbCksCj4g
PiAgIAkJCQkgICAmd20tPndtW2xldmVsXSk7Cj4gPiAgIAl9Cj4gPiAtCXNrbF93cml0ZV93bV9s
ZXZlbChkZXZfcHJpdiwgUExBTkVfV01fVFJBTlMocGlwZSwgcGxhbmVfaWQpLAo+ID4gKwlza2xf
d3JpdGVfd21fbGV2ZWwoaTkxNSwgUExBTkVfV01fVFJBTlMocGlwZSwgcGxhbmVfaWQpLAo+ID4g
ICAJCQkgICAmd20tPnRyYW5zX3dtKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
MTEpIHsKPiA+IC0JCXNrbF9kZGJfZW50cnlfd3JpdGUoZGV2X3ByaXYsCj4gPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gMTEpIHsKPiA+ICsJCXNrbF9kZGJfZW50cnlfd3JpdGUoaTkxNSwKPiA+
ICAgCQkJCSAgICBQTEFORV9CVUZfQ0ZHKHBpcGUsIHBsYW5lX2lkKSwgZGRiX3kpOwo+ID4gICAJ
CXJldHVybjsKPiA+ICAgCX0KPiA+IEBAIC01MTc5LDE3ICs1MTc5LDE3IEBAIHZvaWQgc2tsX3dy
aXRlX3BsYW5lX3dtKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIAlpZiAod20tPmlz
X3BsYW5hcikKPiA+ICAgCQlzd2FwKGRkYl95LCBkZGJfdXYpOwo+ID4gLQlza2xfZGRiX2VudHJ5
X3dyaXRlKGRldl9wcml2LAo+ID4gKwlza2xfZGRiX2VudHJ5X3dyaXRlKGk5MTUsCj4gPiAgIAkJ
CSAgICBQTEFORV9CVUZfQ0ZHKHBpcGUsIHBsYW5lX2lkKSwgZGRiX3kpOwo+ID4gLQlza2xfZGRi
X2VudHJ5X3dyaXRlKGRldl9wcml2LAo+ID4gKwlza2xfZGRiX2VudHJ5X3dyaXRlKGk5MTUsCj4g
PiAgIAkJCSAgICBQTEFORV9OVjEyX0JVRl9DRkcocGlwZSwgcGxhbmVfaWQpLCBkZGJfdXYpOwo+
ID4gICB9Cj4gPiAgIHZvaWQgc2tsX3dyaXRlX2N1cnNvcl93bShzdHJ1Y3QgaW50ZWxfcGxhbmUg
KnBsYW5lLAo+ID4gICAJCQkgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gLQlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193
bV9tYXhfbGV2ZWwoZGV2X3ByaXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICsJaW50IGxldmVsLCBtYXhfbGV2ZWwg
PSBpbGtfd21fbWF4X2xldmVsKGk5MTUpOwo+ID4gICAJZW51bSBwbGFuZV9pZCBwbGFuZV9pZCA9
IHBsYW5lLT5pZDsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7Cj4gPiAgIAlj
b25zdCBzdHJ1Y3Qgc2tsX3BsYW5lX3dtICp3bSA9Cj4gPiBAQCAtNTE5OCwxMiArNTE5OCwxMiBA
QCB2b2lkIHNrbF93cml0ZV9jdXJzb3Jfd20oc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+
ICAgCQkmY3J0Y19zdGF0ZS0+d20uc2tsLnBsYW5lX2RkYl95W3BsYW5lX2lkXTsKPiA+ICAgCWZv
ciAobGV2ZWwgPSAwOyBsZXZlbCA8PSBtYXhfbGV2ZWw7IGxldmVsKyspIHsKPiA+IC0JCXNrbF93
cml0ZV93bV9sZXZlbChkZXZfcHJpdiwgQ1VSX1dNKHBpcGUsIGxldmVsKSwKPiA+ICsJCXNrbF93
cml0ZV93bV9sZXZlbChpOTE1LCBDVVJfV00ocGlwZSwgbGV2ZWwpLAo+ID4gICAJCQkJICAgJndt
LT53bVtsZXZlbF0pOwo+ID4gICAJfQo+ID4gLQlza2xfd3JpdGVfd21fbGV2ZWwoZGV2X3ByaXYs
IENVUl9XTV9UUkFOUyhwaXBlKSwgJndtLT50cmFuc193bSk7Cj4gPiArCXNrbF93cml0ZV93bV9s
ZXZlbChpOTE1LCBDVVJfV01fVFJBTlMocGlwZSksICZ3bS0+dHJhbnNfd20pOwo+ID4gLQlza2xf
ZGRiX2VudHJ5X3dyaXRlKGRldl9wcml2LCBDVVJfQlVGX0NGRyhwaXBlKSwgZGRiKTsKPiA+ICsJ
c2tsX2RkYl9lbnRyeV93cml0ZShpOTE1LCBDVVJfQlVGX0NGRyhwaXBlKSwgZGRiKTsKPiA+ICAg
fQo+ID4gICBib29sIHNrbF93bV9sZXZlbF9lcXVhbHMoY29uc3Qgc3RydWN0IHNrbF93bV9sZXZl
bCAqbDEsCj4gPiBAQCAtNTIxNSwxMSArNTIxNSwxMSBAQCBib29sIHNrbF93bV9sZXZlbF9lcXVh
bHMoY29uc3Qgc3RydWN0IHNrbF93bV9sZXZlbCAqbDEsCj4gPiAgIAkJbDEtPnBsYW5lX3Jlc19i
ID09IGwyLT5wbGFuZV9yZXNfYjsKPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIHNrbF9wbGFuZV93
bV9lcXVhbHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRpYyBi
b29sIHNrbF9wbGFuZV93bV9lcXVhbHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgIAkJCQljb25zdCBzdHJ1Y3Qgc2tsX3BsYW5lX3dtICp3bTEsCj4gPiAgIAkJCQljb25zdCBz
dHJ1Y3Qgc2tsX3BsYW5lX3dtICp3bTIpCj4gPiAgIHsKPiA+IC0JaW50IGxldmVsLCBtYXhfbGV2
ZWwgPSBpbGtfd21fbWF4X2xldmVsKGRldl9wcml2KTsKPiA+ICsJaW50IGxldmVsLCBtYXhfbGV2
ZWwgPSBpbGtfd21fbWF4X2xldmVsKGk5MTUpOwo+ID4gICAJZm9yIChsZXZlbCA9IDA7IGxldmVs
IDw9IG1heF9sZXZlbDsgbGV2ZWwrKykgewo+ID4gICAJCWlmICghc2tsX3dtX2xldmVsX2VxdWFs
cygmd20xLT53bVtsZXZlbF0sICZ3bTItPndtW2xldmVsXSkgfHwKPiA+IEBAIC01MjM0LDExICs1
MjM0LDExIEBAIHN0YXRpYyBib29sIHNrbF9waXBlX3dtX2VxdWFscyhzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YywKPiA+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBza2xfcGlwZV93bSAqd20xLAo+
ID4gICAJCQkgICAgICAgY29uc3Qgc3RydWN0IHNrbF9waXBlX3dtICp3bTIpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkOwo+ID4gICAJZm9yX2Vh
Y2hfcGxhbmVfaWRfb25fY3J0YyhjcnRjLCBwbGFuZV9pZCkgewo+ID4gLQkJaWYgKCFza2xfcGxh
bmVfd21fZXF1YWxzKGRldl9wcml2LAo+ID4gKwkJaWYgKCFza2xfcGxhbmVfd21fZXF1YWxzKGk5
MTUsCj4gPiAgIAkJCQkJICZ3bTEtPnBsYW5lc1twbGFuZV9pZF0sCj4gPiAgIAkJCQkJICZ3bTIt
PnBsYW5lc1twbGFuZV9pZF0pKQo+ID4gICAJCQlyZXR1cm4gZmFsc2U7Cj4gPiBAQCAtNTI4Nywx
MCArNTI4NywxMCBAQCBza2xfZGRiX2FkZF9hZmZlY3RlZF9wbGFuZXMoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShuZXdfY3J0Y19z
dGF0ZS0+YmFzZS5zdGF0ZSk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAtCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4g
ICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKPiA+IC0JZm9yX2VhY2hfaW50ZWxfcGxhbmVf
b25fY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0YywgcGxhbmUpIHsKPiA+ICsJZm9yX2VhY2hfaW50
ZWxfcGxhbmVfb25fY3J0YygmaTkxNS0+ZHJtLCBjcnRjLCBwbGFuZSkgewo+ID4gICAJCXN0cnVj
dCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGU7Cj4gPiAgIAkJZW51bSBwbGFuZV9pZCBw
bGFuZV9pZCA9IHBsYW5lLT5pZDsKPiA+IEBAIC01MzEzLDE0ICs1MzEzLDE0IEBAIHNrbF9kZGJf
YWRkX2FmZmVjdGVkX3BsYW5lcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2Ny
dGNfc3RhdGUsCj4gPiAgIHN0YXRpYyBpbnQKPiA+ICAgc2tsX2NvbXB1dGVfZGRiKHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICB7Cj4gPiAtCWNvbnN0IHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKPiA+ICsJ
Y29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHN0YXRlLT5iYXNl
LmRldik7Cj4gPiAgIAlzdHJ1Y3Qgc2tsX2RkYl9hbGxvY2F0aW9uICpkZGIgPSAmc3RhdGUtPndt
X3Jlc3VsdHMuZGRiOwo+ID4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0
YXRlOwo+ID4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlOwo+ID4g
ICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gPiAgIAlpbnQgcmV0LCBpOwo+ID4gLQltZW1j
cHkoZGRiLCAmZGV2X3ByaXYtPndtLnNrbF9ody5kZGIsIHNpemVvZigqZGRiKSk7Cj4gPiArCW1l
bWNweShkZGIsICZpOTE1LT53bS5za2xfaHcuZGRiLCBzaXplb2YoKmRkYikpOwo+ID4gICAJZm9y
X2VhY2hfb2xkbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG9sZF9jcnRjX3N0
YXRlLAo+ID4gICAJCQkJCSAgICBuZXdfY3J0Y19zdGF0ZSwgaSkgewo+ID4gQEAgLTUzNDUsNyAr
NTM0NSw3IEBAIHN0YXRpYyBjaGFyIGVuYXN0KGJvb2wgZW5hYmxlKQo+ID4gICBzdGF0aWMgdm9p
ZAo+ID4gICBza2xfcHJpbnRfd21fY2hhbmdlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpz
dGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KHN0YXRlLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+ID4gICAJY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlOwo+ID4gICAJY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlOwo+ID4gICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFu
ZTsKPiA+IEBAIC01MzYyLDcgKzUzNjIsNyBAQCBza2xfcHJpbnRfd21fY2hhbmdlcyhzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiA+ICAgCQlvbGRfcGlwZV93bSA9ICZvbGRfY3J0
Y19zdGF0ZS0+d20uc2tsLm9wdGltYWw7Cj4gPiAgIAkJbmV3X3BpcGVfd20gPSAmbmV3X2NydGNf
c3RhdGUtPndtLnNrbC5vcHRpbWFsOwo+ID4gLQkJZm9yX2VhY2hfaW50ZWxfcGxhbmVfb25fY3J0
YygmZGV2X3ByaXYtPmRybSwgY3J0YywgcGxhbmUpIHsKPiA+ICsJCWZvcl9lYWNoX2ludGVsX3Bs
YW5lX29uX2NydGMoJmk5MTUtPmRybSwgY3J0YywgcGxhbmUpIHsKPiA+ICAgCQkJZW51bSBwbGFu
ZV9pZCBwbGFuZV9pZCA9IHBsYW5lLT5pZDsKPiA+ICAgCQkJY29uc3Qgc3RydWN0IHNrbF9kZGJf
ZW50cnkgKm9sZCwgKm5ldzsKPiA+IEBAIC01Mzc4LDE0ICs1Mzc4LDE0IEBAIHNrbF9wcmludF93
bV9jaGFuZ2VzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ID4gICAJCQkJICAg
ICAgc2tsX2RkYl9lbnRyeV9zaXplKG9sZCksIHNrbF9kZGJfZW50cnlfc2l6ZShuZXcpKTsKPiA+
ICAgCQl9Cj4gPiAtCQlmb3JfZWFjaF9pbnRlbF9wbGFuZV9vbl9jcnRjKCZkZXZfcHJpdi0+ZHJt
LCBjcnRjLCBwbGFuZSkgewo+ID4gKwkJZm9yX2VhY2hfaW50ZWxfcGxhbmVfb25fY3J0YygmaTkx
NS0+ZHJtLCBjcnRjLCBwbGFuZSkgewo+ID4gICAJCQllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0g
cGxhbmUtPmlkOwo+ID4gICAJCQljb25zdCBzdHJ1Y3Qgc2tsX3BsYW5lX3dtICpvbGRfd20sICpu
ZXdfd207Cj4gPiAgIAkJCW9sZF93bSA9ICZvbGRfcGlwZV93bS0+cGxhbmVzW3BsYW5lX2lkXTsK
PiA+ICAgCQkJbmV3X3dtID0gJm5ld19waXBlX3dtLT5wbGFuZXNbcGxhbmVfaWRdOwo+ID4gLQkJ
CWlmIChza2xfcGxhbmVfd21fZXF1YWxzKGRldl9wcml2LCBvbGRfd20sIG5ld193bSkpCj4gPiAr
CQkJaWYgKHNrbF9wbGFuZV93bV9lcXVhbHMoaTkxNSwgb2xkX3dtLCBuZXdfd20pKQo+ID4gICAJ
CQkJY29udGludWU7Cj4gPiAgIAkJCURSTV9ERUJVR19LTVMoIltQTEFORTolZDolc10gICBsZXZl
bCAlY3dtMCwlY3dtMSwlY3dtMiwlY3dtMywlY3dtNCwlY3dtNSwlY3dtNiwlY3dtNywlY3R3bSIK
PiA+IEBAIC01NDYwLDcgKzU0NjAsNyBAQCBzdGF0aWMgaW50Cj4gPiAgIHNrbF9kZGJfYWRkX2Fm
ZmVjdGVkX3BpcGVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLCBib29sICpjaGFu
Z2VkKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gc3RhdGUtPmJhc2Uu
ZGV2Owo+ID4gLQljb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7Cj4gPiArCWNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9f
aTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiA+ICAgCXUzMiByZWFsbG9jX3BpcGVzID0g
cGlwZXNfbW9kaWZpZWQoc3RhdGUpOwo+ID4gQEAgLTU0NzAsMTQgKzU0NzAsMTQgQEAgc2tsX2Rk
Yl9hZGRfYWZmZWN0ZWRfcGlwZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsIGJv
b2wgKmNoYW5nZWQpCj4gPiAgIAkgKiBXaGVuIHdlIGRpc3RydXN0IGJpb3Mgd20gd2UgYWx3YXlz
IG5lZWQgdG8gcmVjb21wdXRlIHRvIHNldCB0aGUKPiA+ICAgCSAqIGV4cGVjdGVkIEREQiBhbGxv
Y2F0aW9ucyBmb3IgZWFjaCBDUlRDLgo+ID4gICAJICovCj4gPiAtCWlmIChkZXZfcHJpdi0+d20u
ZGlzdHJ1c3RfYmlvc193bSkKPiA+ICsJaWYgKGk5MTUtPndtLmRpc3RydXN0X2Jpb3Nfd20pCj4g
PiAgIAkJKCpjaGFuZ2VkKSA9IHRydWU7Cj4gPiAgIAkvKgo+ID4gICAJICogSWYgdGhpcyB0cmFu
c2FjdGlvbiBpc24ndCBhY3R1YWxseSB0b3VjaGluZyBhbnkgQ1JUQydzLCBkb24ndAo+ID4gICAJ
ICogYm90aGVyIHdpdGggd2F0ZXJtYXJrIGNhbGN1bGF0aW9uLiAgTm90ZSB0aGF0IGlmIHdlIHBh
c3MgdGhpcwo+ID4gICAJICogdGVzdCwgd2UncmUgZ3VhcmFudGVlZCB0byBob2xkIGF0IGxlYXN0
IG9uZSBDUlRDIHN0YXRlIG11dGV4LAo+ID4gLQkgKiB3aGljaCBtZWFucyB3ZSBjYW4gc2FmZWx5
IHVzZSB2YWx1ZXMgbGlrZSBkZXZfcHJpdi0+YWN0aXZlX2NydGNzCj4gPiArCSAqIHdoaWNoIG1l
YW5zIHdlIGNhbiBzYWZlbHkgdXNlIHZhbHVlcyBsaWtlIGk5MTUtPmFjdGl2ZV9jcnRjcwo+ID4g
ICAJICogc2luY2UgYW55IHJhY2luZyBjb21taXRzIHRoYXQgd2FudCB0byB1cGRhdGUgdGhlbSB3
b3VsZCBuZWVkIHRvCj4gPiAgIAkgKiBob2xkIF9hbGxfIENSVEMgc3RhdGUgbXV0ZXhlcy4KPiA+
ICAgCSAqLwo+ID4gQEAgLTU0OTMsNyArNTQ5Myw3IEBAIHNrbF9kZGJfYWRkX2FmZmVjdGVkX3Bp
cGVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLCBib29sICpjaGFuZ2VkKQo+ID4g
ICAJICogcHJldGVuZCB0aGF0IGFsbCBwaXBlcyBzd2l0Y2hlZCBhY3RpdmUgc3RhdHVzIHNvIHRo
YXQgd2UnbGwKPiA+ICAgCSAqIGVuc3VyZSBhIGZ1bGwgRERCIHJlY29tcHV0ZS4KPiA+ICAgCSAq
Lwo+ID4gLQlpZiAoZGV2X3ByaXYtPndtLmRpc3RydXN0X2Jpb3Nfd20pIHsKPiA+ICsJaWYgKGk5
MTUtPndtLmRpc3RydXN0X2Jpb3Nfd20pIHsKPiA+ICAgCQlyZXQgPSBkcm1fbW9kZXNldF9sb2Nr
KCZkZXYtPm1vZGVfY29uZmlnLmNvbm5lY3Rpb25fbXV0ZXgsCj4gPiAgIAkJCQkgICAgICAgc3Rh
dGUtPmJhc2UuYWNxdWlyZV9jdHgpOwo+ID4gICAJCWlmIChyZXQpCj4gPiBAQCAtNTUwOCw3ICs1
NTA4LDcgQEAgc2tsX2RkYl9hZGRfYWZmZWN0ZWRfcGlwZXMoc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUsIGJvb2wgKmNoYW5nZWQpCj4gPiAgIAkJICogb24gdGhlIGZpcnN0IGNvbW1p
dCB0b28uCj4gPiAgIAkJICovCj4gPiAgIAkJaWYgKCFzdGF0ZS0+bW9kZXNldCkKPiA+IC0JCQlz
dGF0ZS0+YWN0aXZlX2NydGNzID0gZGV2X3ByaXYtPmFjdGl2ZV9jcnRjczsKPiA+ICsJCQlzdGF0
ZS0+YWN0aXZlX2NydGNzID0gaTkxNS0+YWN0aXZlX2NydGNzOwo+ID4gICAJfQo+ID4gICAJLyoK
PiA+IEBAIC01NTY3LDE0ICs1NTY3LDE0IEBAIHNrbF9kZGJfYWRkX2FmZmVjdGVkX3BpcGVzKHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLCBib29sICpjaGFuZ2VkKQo+ID4gICBzdGF0
aWMgaW50IHNrbF93bV9hZGRfYWZmZWN0ZWRfcGxhbmVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3Rh
dGUgKnN0YXRlLAo+ID4gICAJCQkJICAgICAgc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
b2xkX2NydGNfc3RhdGUgPQo+ID4gICAJCWludGVsX2F0b21pY19nZXRfb2xkX2NydGNfc3RhdGUo
c3RhdGUsIGNydGMpOwo+ID4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0
YXRlID0KPiA+ICAgCQlpbnRlbF9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRlKHN0YXRlLCBjcnRj
KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmU7Cj4gPiAtCWZvcl9lYWNoX2ludGVs
X3BsYW5lX29uX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMsIHBsYW5lKSB7Cj4gPiArCWZvcl9l
YWNoX2ludGVsX3BsYW5lX29uX2NydGMoJmk5MTUtPmRybSwgY3J0YywgcGxhbmUpIHsKPiA+ICAg
CQlzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlOwo+ID4gICAJCWVudW0gcGxh
bmVfaWQgcGxhbmVfaWQgPSBwbGFuZS0+aWQ7Cj4gPiBAQCAtNTU4Nyw3ICs1NTg3LDcgQEAgc3Rh
dGljIGludCBza2xfd21fYWRkX2FmZmVjdGVkX3BsYW5lcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSwKPiA+ICAgCQkgKiB3aXRoIHRoZSBzb2Z0d2FyZSBzdGF0ZS4KPiA+ICAgCQkg
Ki8KPiA+ICAgCQlpZiAoIWRybV9hdG9taWNfY3J0Y19uZWVkc19tb2Rlc2V0KCZuZXdfY3J0Y19z
dGF0ZS0+YmFzZSkgJiYKPiA+IC0JCSAgICBza2xfcGxhbmVfd21fZXF1YWxzKGRldl9wcml2LAo+
ID4gKwkJICAgIHNrbF9wbGFuZV93bV9lcXVhbHMoaTkxNSwKPiA+ICAgCQkJCQkmb2xkX2NydGNf
c3RhdGUtPndtLnNrbC5vcHRpbWFsLnBsYW5lc1twbGFuZV9pZF0sCj4gPiAgIAkJCQkJJm5ld19j
cnRjX3N0YXRlLT53bS5za2wub3B0aW1hbC5wbGFuZXNbcGxhbmVfaWRdKSkKPiA+ICAgCQkJY29u
dGludWU7Cj4gPiBAQCAtNTY1NCw3ICs1NjU0LDcgQEAgc3RhdGljIHZvaWQgc2tsX2F0b21pY191
cGRhdGVfY3J0Y193bShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPiA+ICAgCQkJ
CSAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhjc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUt
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KHN0YXRlLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3Qgc2tsX3BpcGVfd20gKnBpcGVfd20gPSAm
Y3N0YXRlLT53bS5za2wub3B0aW1hbDsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlw
ZTsKPiA+IEBAIC01NjY5LDI3ICs1NjY5LDI3IEBAIHN0YXRpYyB2b2lkIHNrbF9pbml0aWFsX3dt
KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3N0YXRlLT5iYXNlLmNydGMp
Owo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVsX2NydGMtPmJhc2UuZGV2Owo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJ
c3RydWN0IHNrbF9kZGJfdmFsdWVzICpyZXN1bHRzID0gJnN0YXRlLT53bV9yZXN1bHRzOwo+ID4g
ICAJaWYgKChyZXN1bHRzLT5kaXJ0eV9waXBlcyAmIGRybV9jcnRjX21hc2soJmludGVsX2NydGMt
PmJhc2UpKSA9PSAwKQo+ID4gICAJCXJldHVybjsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYt
PndtLndtX211dGV4KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+d20ud21fbXV0ZXgpOwo+ID4g
ICAJaWYgKGNzdGF0ZS0+YmFzZS5hY3RpdmVfY2hhbmdlZCkKPiA+ICAgCQlza2xfYXRvbWljX3Vw
ZGF0ZV9jcnRjX3dtKHN0YXRlLCBjc3RhdGUpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2
LT53bS53bV9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+d20ud21fbXV0ZXgpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgaWxrX2NvbXB1dGVfd21fY29uZmlnKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBpbGtfY29tcHV0ZV93bV9j
b25maWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCQkgIHN0cnVjdCBp
bnRlbF93bV9jb25maWcgKmNvbmZpZykKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2NydGMg
KmNydGM7Cj4gPiAgIAkvKiBDb21wdXRlIHRoZSBjdXJyZW50bHkgX2FjdGl2ZV8gY29uZmlnICov
Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpIHsKPiA+ICsJ
Zm9yX2VhY2hfaW50ZWxfY3J0YygmaTkxNS0+ZHJtLCBjcnRjKSB7Cj4gPiAgIAkJY29uc3Qgc3Ry
dWN0IGludGVsX3BpcGVfd20gKndtID0gJmNydGMtPndtLmFjdGl2ZS5pbGs7Cj4gPiAgIAkJaWYg
KCF3bS0+cGlwZV9lbmFibGVkKQo+ID4gQEAgLTU3MDEsNyArNTcwMSw3IEBAIHN0YXRpYyB2b2lk
IGlsa19jb21wdXRlX3dtX2NvbmZpZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbGtfcHJvZ3JhbV93YXRlcm1hcmtz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbGtf
cHJvZ3JhbV93YXRlcm1hcmtzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGlwZV93bSBscF93bV8xXzIgPSB7fSwgbHBfd21fNV82ID0g
e30sICpiZXN0X2xwX3dtOwo+ID4gICAJc3RydWN0IGlsa193bV9tYXhpbXVtcyBtYXg7Cj4gPiBA
QCAtNTcwOSwxOCArNTcwOSwxOCBAQCBzdGF0aWMgdm9pZCBpbGtfcHJvZ3JhbV93YXRlcm1hcmtz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXN0cnVjdCBpbGtfd21f
dmFsdWVzIHJlc3VsdHMgPSB7fTsKPiA+ICAgCWVudW0gaW50ZWxfZGRiX3BhcnRpdGlvbmluZyBw
YXJ0aXRpb25pbmc7Cj4gPiAtCWlsa19jb21wdXRlX3dtX2NvbmZpZyhkZXZfcHJpdiwgJmNvbmZp
Zyk7Cj4gPiArCWlsa19jb21wdXRlX3dtX2NvbmZpZyhpOTE1LCAmY29uZmlnKTsKPiA+IC0JaWxr
X2NvbXB1dGVfd21fbWF4aW11bXMoZGV2X3ByaXYsIDEsICZjb25maWcsIElOVEVMX0REQl9QQVJU
XzFfMiwgJm1heCk7Cj4gPiAtCWlsa193bV9tZXJnZShkZXZfcHJpdiwgJmNvbmZpZywgJm1heCwg
JmxwX3dtXzFfMik7Cj4gPiArCWlsa19jb21wdXRlX3dtX21heGltdW1zKGk5MTUsIDEsICZjb25m
aWcsIElOVEVMX0REQl9QQVJUXzFfMiwgJm1heCk7Cj4gPiArCWlsa193bV9tZXJnZShpOTE1LCAm
Y29uZmlnLCAmbWF4LCAmbHBfd21fMV8yKTsKPiA+ICAgCS8qIDUvNiBzcGxpdCBvbmx5IGluIHNp
bmdsZSBwaXBlIGNvbmZpZyBvbiBJVkIrICovCj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDcgJiYKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA3ICYmCj4gPiAgIAkgICAgY29u
ZmlnLm51bV9waXBlc19hY3RpdmUgPT0gMSAmJiBjb25maWcuc3ByaXRlc19lbmFibGVkKSB7Cj4g
PiAtCQlpbGtfY29tcHV0ZV93bV9tYXhpbXVtcyhkZXZfcHJpdiwgMSwgJmNvbmZpZywgSU5URUxf
RERCX1BBUlRfNV82LCAmbWF4KTsKPiA+IC0JCWlsa193bV9tZXJnZShkZXZfcHJpdiwgJmNvbmZp
ZywgJm1heCwgJmxwX3dtXzVfNik7Cj4gPiArCQlpbGtfY29tcHV0ZV93bV9tYXhpbXVtcyhpOTE1
LCAxLCAmY29uZmlnLCBJTlRFTF9EREJfUEFSVF81XzYsICZtYXgpOwo+ID4gKwkJaWxrX3dtX21l
cmdlKGk5MTUsICZjb25maWcsICZtYXgsICZscF93bV81XzYpOwo+ID4gLQkJYmVzdF9scF93bSA9
IGlsa19maW5kX2Jlc3RfcmVzdWx0KGRldl9wcml2LCAmbHBfd21fMV8yLCAmbHBfd21fNV82KTsK
PiA+ICsJCWJlc3RfbHBfd20gPSBpbGtfZmluZF9iZXN0X3Jlc3VsdChpOTE1LCAmbHBfd21fMV8y
LCAmbHBfd21fNV82KTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAgIAkJYmVzdF9scF93bSA9ICZscF93
bV8xXzI7Cj4gPiAgIAl9Cj4gPiBAQCAtNTcyOCwzNSArNTcyOCwzNSBAQCBzdGF0aWMgdm9pZCBp
bGtfcHJvZ3JhbV93YXRlcm1hcmtzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgCXBhcnRpdGlvbmluZyA9IChiZXN0X2xwX3dtID09ICZscF93bV8xXzIpID8KPiA+ICAg
CQkgICAgICAgSU5URUxfRERCX1BBUlRfMV8yIDogSU5URUxfRERCX1BBUlRfNV82Owo+ID4gLQlp
bGtfY29tcHV0ZV93bV9yZXN1bHRzKGRldl9wcml2LCBiZXN0X2xwX3dtLCBwYXJ0aXRpb25pbmcs
ICZyZXN1bHRzKTsKPiA+ICsJaWxrX2NvbXB1dGVfd21fcmVzdWx0cyhpOTE1LCBiZXN0X2xwX3dt
LCBwYXJ0aXRpb25pbmcsICZyZXN1bHRzKTsKPiA+IC0JaWxrX3dyaXRlX3dtX3ZhbHVlcyhkZXZf
cHJpdiwgJnJlc3VsdHMpOwo+ID4gKwlpbGtfd3JpdGVfd21fdmFsdWVzKGk5MTUsICZyZXN1bHRz
KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBpbGtfaW5pdGlhbF93YXRlcm1hcmtzKHN0cnVj
dCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+ID4gICAJCQkJICAgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNzdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3N0YXRlLT5iYXNlLmNydGMtPmRldik7
Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3N0
YXRlLT5iYXNlLmNydGMpOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgp
Owo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT53bS53bV9tdXRleCk7Cj4gPiAgIAlpbnRlbF9jcnRj
LT53bS5hY3RpdmUuaWxrID0gY3N0YXRlLT53bS5pbGsuaW50ZXJtZWRpYXRlOwo+ID4gLQlpbGtf
cHJvZ3JhbV93YXRlcm1hcmtzKGRldl9wcml2KTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJp
di0+d20ud21fbXV0ZXgpOwo+ID4gKwlpbGtfcHJvZ3JhbV93YXRlcm1hcmtzKGk5MTUpOwo+ID4g
KwltdXRleF91bmxvY2soJmk5MTUtPndtLndtX211dGV4KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMg
dm9pZCBpbGtfb3B0aW1pemVfd2F0ZXJtYXJrcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpz
dGF0ZSwKPiA+ICAgCQkJCSAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3N0
YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gdG9faTkxNShjc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9j
cnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0Yyhjc3RhdGUtPmJhc2UuY3J0Yyk7Cj4gPiAt
CW11dGV4X2xvY2soJmRldl9wcml2LT53bS53bV9tdXRleCk7Cj4gPiArCW11dGV4X2xvY2soJmk5
MTUtPndtLndtX211dGV4KTsKPiA+ICAgCWlmIChjc3RhdGUtPndtLm5lZWRfcG9zdHZibF91cGRh
dGUpIHsKPiA+ICAgCQlpbnRlbF9jcnRjLT53bS5hY3RpdmUuaWxrID0gY3N0YXRlLT53bS5pbGsu
b3B0aW1hbDsKPiA+IC0JCWlsa19wcm9ncmFtX3dhdGVybWFya3MoZGV2X3ByaXYpOwo+ID4gKwkJ
aWxrX3Byb2dyYW1fd2F0ZXJtYXJrcyhpOTE1KTsKPiA+ICAgCX0KPiA+IC0JbXV0ZXhfdW5sb2Nr
KCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPndtLndt
X211dGV4KTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgaW5saW5lIHZvaWQgc2tsX3dtX2xldmVsX2Zy
b21fcmVnX3ZhbCh1MzIgdmFsLAo+ID4gQEAgLTU3NzIsMTMgKzU3NzIsMTMgQEAgc3RhdGljIGlu
bGluZSB2b2lkIHNrbF93bV9sZXZlbF9mcm9tX3JlZ192YWwodTMyIHZhbCwKPiA+ICAgdm9pZCBz
a2xfcGlwZV93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJ
CSAgICAgIHN0cnVjdCBza2xfcGlwZV93bSAqb3V0KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
ID4gICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+ID4gICAJaW50IGxldmVsLCBtYXhf
bGV2ZWw7Cj4gPiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkOwo+ID4gICAJdTMyIHZhbDsKPiA+
IC0JbWF4X2xldmVsID0gaWxrX3dtX21heF9sZXZlbChkZXZfcHJpdik7Cj4gPiArCW1heF9sZXZl
bCA9IGlsa193bV9tYXhfbGV2ZWwoaTkxNSk7Cj4gPiAgIAlmb3JfZWFjaF9wbGFuZV9pZF9vbl9j
cnRjKGNydGMsIHBsYW5lX2lkKSB7Cj4gPiAgIAkJc3RydWN0IHNrbF9wbGFuZV93bSAqd20gPSAm
b3V0LT5wbGFuZXNbcGxhbmVfaWRdOwo+ID4gQEAgLTU4MDYsMTUgKzU4MDYsMTUgQEAgdm9pZCBz
a2xfcGlwZV93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAlv
dXQtPmxpbmV0aW1lID0gSTkxNV9SRUFEKFBJUEVfV01fTElORVRJTUUocGlwZSkpOwo+ID4gICB9
Cj4gPiAtdm9pZCBza2xfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICt2b2lkIHNrbF93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IHNrbF9kZGJfdmFsdWVzICpodyA9ICZk
ZXZfcHJpdi0+d20uc2tsX2h3Owo+ID4gLQlzdHJ1Y3Qgc2tsX2RkYl9hbGxvY2F0aW9uICpkZGIg
PSAmZGV2X3ByaXYtPndtLnNrbF9ody5kZGI7Cj4gPiArCXN0cnVjdCBza2xfZGRiX3ZhbHVlcyAq
aHcgPSAmaTkxNS0+d20uc2tsX2h3Owo+ID4gKwlzdHJ1Y3Qgc2tsX2RkYl9hbGxvY2F0aW9uICpk
ZGIgPSAmaTkxNS0+d20uc2tsX2h3LmRkYjsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
Owo+ID4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZTsKPiA+IC0Jc2tsX2RkYl9n
ZXRfaHdfc3RhdGUoZGV2X3ByaXYsIGRkYik7Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRl
dl9wcml2LT5kcm0sIGNydGMpIHsKPiA+ICsJc2tsX2RkYl9nZXRfaHdfc3RhdGUoaTkxNSwgZGRi
KTsKPiA+ICsJZm9yX2VhY2hfaW50ZWxfY3J0YygmaTkxNS0+ZHJtLCBjcnRjKSB7Cj4gPiAgIAkJ
Y3N0YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiA+ICAgCQlz
a2xfcGlwZV93bV9nZXRfaHdfc3RhdGUoY3J0YywgJmNzdGF0ZS0+d20uc2tsLm9wdGltYWwpOwo+
ID4gQEAgLTU4MjMsMTcgKzU4MjMsMTcgQEAgdm9pZCBza2xfd21fZ2V0X2h3X3N0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkJaHctPmRpcnR5X3BpcGVzIHw9
IGRybV9jcnRjX21hc2soJmNydGMtPmJhc2UpOwo+ID4gICAJfQo+ID4gLQlpZiAoZGV2X3ByaXYt
PmFjdGl2ZV9jcnRjcykgewo+ID4gKwlpZiAoaTkxNS0+YWN0aXZlX2NydGNzKSB7Cj4gPiAgIAkJ
LyogRnVsbHkgcmVjb21wdXRlIEREQiBvbiBmaXJzdCBhdG9taWMgY29tbWl0ICovCj4gPiAtCQlk
ZXZfcHJpdi0+d20uZGlzdHJ1c3RfYmlvc193bSA9IHRydWU7Cj4gPiArCQlpOTE1LT53bS5kaXN0
cnVzdF9iaW9zX3dtID0gdHJ1ZTsKPiA+ICAgCX0KPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZCBp
bGtfcGlwZV93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIHsK
PiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gLQlzdHJ1
Y3QgaWxrX3dtX3ZhbHVlcyAqaHcgPSAmZGV2X3ByaXYtPndtLmh3Owo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGlsa193bV92
YWx1ZXMgKmh3ID0gJmk5MTUtPndtLmh3Owo+ID4gICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNzdGF0ZSA9IHRvX2ludGVsX2NydGNfc3RhdGUoY3J0Yy0+YmFzZS5zdGF0ZSk7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfcGlwZV93bSAqYWN0aXZlID0gJmNzdGF0ZS0+d20uaWxrLm9wdGltYWw7Cj4g
PiAgIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gPiBAQCAtNTg0NCw3ICs1ODQ0LDcg
QEAgc3RhdGljIHZvaWQgaWxrX3BpcGVfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjKQo+ID4gICAJfTsKPiA+ICAgCWh3LT53bV9waXBlW3BpcGVdID0gSTkxNV9SRUFEKHdt
MF9waXBlX3JlZ1twaXBlXSk7Cj4gPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19C
Uk9BRFdFTEwoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9B
RFdFTEwoaTkxNSkpCj4gPiAgIAkJaHctPndtX2xpbmV0aW1lW3BpcGVdID0gSTkxNV9SRUFEKFBJ
UEVfV01fTElORVRJTUUocGlwZSkpOwo+ID4gICAJbWVtc2V0KGFjdGl2ZSwgMCwgc2l6ZW9mKCph
Y3RpdmUpKTsKPiA+IEBAIC01ODY2LDcgKzU4NjYsNyBAQCBzdGF0aWMgdm9pZCBpbGtfcGlwZV93
bV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4gPiAgIAkJYWN0aXZlLT53
bVswXS5jdXJfdmFsID0gdG1wICYgV00wX1BJUEVfQ1VSU09SX01BU0s7Cj4gPiAgIAkJYWN0aXZl
LT5saW5ldGltZSA9IGh3LT53bV9saW5ldGltZVtwaXBlXTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAt
CQlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3ByaXYpOwo+ID4g
KwkJaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGk5MTUpOwo+ID4gICAJ
CS8qCj4gPiAgIAkJICogRm9yIGluYWN0aXZlIHBpcGVzLCBhbGwgd2F0ZXJtYXJrIGxldmVscwo+
ID4gQEAgLTU4ODUsNyArNTg4NSw3IEBAIHN0YXRpYyB2b2lkIGlsa19waXBlX3dtX2dldF9od19z
dGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPiA+ICAgI2RlZmluZSBfRldfV01fVkxWKHZh
bHVlLCBwbGFuZSkgXAo+ID4gICAJKCgodmFsdWUpICYgRFNQRldfICMjIHBsYW5lICMjIF9NQVNL
X1ZMVikgPj4gRFNQRldfICMjIHBsYW5lICMjIF9TSElGVCkKPiA+IC1zdGF0aWMgdm9pZCBnNHhf
cmVhZF93bV92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0
YXRpYyB2b2lkIGc0eF9yZWFkX3dtX3ZhbHVlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICAgCQkJICAgICAgIHN0cnVjdCBnNHhfd21fdmFsdWVzICp3bSkKPiA+ICAgewo+ID4g
ICAJdTMyIHRtcDsKPiA+IEBAIC01OTExLDEzICs1OTExLDEzIEBAIHN0YXRpYyB2b2lkIGc0eF9y
ZWFkX3dtX3ZhbHVlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAl3
bS0+aHBsbC5wbGFuZSA9IF9GV19XTSh0bXAsIEhQTExfU1IpOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IHZvaWQgdmx2X3JlYWRfd21fdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICtzdGF0aWMgdm9pZCB2bHZfcmVhZF93bV92YWx1ZXMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgICBzdHJ1Y3Qgdmx2X3dtX3ZhbHVlcyAqd20pCj4g
PiAgIHsKPiA+ICAgCWVudW0gcGlwZSBwaXBlOwo+ID4gICAJdTMyIHRtcDsKPiA+IC0JZm9yX2Vh
Y2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewo+ID4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUp
IHsKPiA+ICAgCQl0bXAgPSBJOTE1X1JFQUQoVkxWX0RETChwaXBlKSk7Cj4gPiAgIAkJd20tPmRk
bFtwaXBlXS5wbGFuZVtQTEFORV9QUklNQVJZXSA9Cj4gPiBAQCAtNTk0NCw3ICs1OTQ0LDcgQEAg
c3RhdGljIHZvaWQgdmx2X3JlYWRfd21fdmFsdWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCXRtcCA9IEk5MTVfUkVBRChEU1BGVzMpOwo+ID4gICAJd20tPnNyLmN1
cnNvciA9IF9GV19XTSh0bXAsIENVUlNPUl9TUik7Cj4gPiAtCWlmIChJU19DSEVSUllWSUVXKGRl
dl9wcml2KSkgewo+ID4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ID4gICAJCXRtcCA9
IEk5MTVfUkVBRChEU1BGVzdfQ0hWKTsKPiA+ICAgCQl3bS0+cGlwZVtQSVBFX0JdLnBsYW5lW1BM
QU5FX1NQUklURTFdID0gX0ZXX1dNX1ZMVih0bXAsIFNQUklURUQpOwo+ID4gICAJCXdtLT5waXBl
W1BJUEVfQl0ucGxhbmVbUExBTkVfU1BSSVRFMF0gPSBfRldfV01fVkxWKHRtcCwgU1BSSVRFQyk7
Cj4gPiBAQCAtNTk4NywxNiArNTk4NywxNiBAQCBzdGF0aWMgdm9pZCB2bHZfcmVhZF93bV92YWx1
ZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAjdW5kZWYgX0ZXX1dN
Cj4gPiAgICN1bmRlZiBfRldfV01fVkxWCj4gPiAtdm9pZCBnNHhfd21fZ2V0X2h3X3N0YXRlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGc0eF93bV9nZXRfaHdf
c3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGc0eF93bV92YWx1ZXMgKndtID0gJmRldl9wcml2LT53bS5nNHg7Cj4gPiArCXN0cnVjdCBnNHhf
d21fdmFsdWVzICp3bSA9ICZpOTE1LT53bS5nNHg7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YzsKPiA+IC0JZzR4X3JlYWRfd21fdmFsdWVzKGRldl9wcml2LCB3bSk7Cj4gPiArCWc0eF9y
ZWFkX3dtX3ZhbHVlcyhpOTE1LCB3bSk7Cj4gPiAgIAl3bS0+Y3hzciA9IEk5MTVfUkVBRChGV19C
TENfU0VMRikgJiBGV19CTENfU0VMRl9FTjsKPiA+IC0JZm9yX2VhY2hfaW50ZWxfY3J0YygmZGV2
X3ByaXYtPmRybSwgY3J0Yykgewo+ID4gKwlmb3JfZWFjaF9pbnRlbF9jcnRjKCZpOTE1LT5kcm0s
IGNydGMpIHsKPiA+ICAgCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9Cj4g
PiAgIAkJCXRvX2ludGVsX2NydGNfc3RhdGUoY3J0Yy0+YmFzZS5zdGF0ZSk7Cj4gPiAgIAkJc3Ry
dWN0IGc0eF93bV9zdGF0ZSAqYWN0aXZlID0gJmNydGMtPndtLmFjdGl2ZS5nNHg7Cj4gPiBAQCAt
NjA3MSwxNiArNjA3MSwxNiBAQCB2b2lkIGc0eF93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCSAgICAgIHllc25vKHdtLT5jeHNyKSwgeWVz
bm8od20tPmhwbGxfZW4pLCB5ZXNubyh3bS0+ZmJjX2VuKSk7Cj4gPiAgIH0KPiA+IC12b2lkIGc0
eF93bV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9p
ZCBnNHhfd21fc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmU7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YzsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPndtLndtX211dGV4KTsKPiA+ICsJ
bXV0ZXhfbG9jaygmaTkxNS0+d20ud21fbXV0ZXgpOwo+ID4gLQlmb3JfZWFjaF9pbnRlbF9wbGFu
ZSgmZGV2X3ByaXYtPmRybSwgcGxhbmUpIHsKPiA+ICsJZm9yX2VhY2hfaW50ZWxfcGxhbmUoJmk5
MTUtPmRybSwgcGxhbmUpIHsKPiA+ICAgCQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9Cj4gPiAt
CQkJaW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBsYW5lLT5waXBlKTsKPiA+ICsJ
CQlpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwbGFuZS0+cGlwZSk7Cj4gPiAgIAkJc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPQo+ID4gICAJCQl0b19pbnRlbF9jcnRj
X3N0YXRlKGNydGMtPmJhc2Uuc3RhdGUpOwo+ID4gICAJCXN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0
ZSAqcGxhbmVfc3RhdGUgPQo+ID4gQEAgLTYxMTMsNyArNjExMyw3IEBAIHZvaWQgZzR4X3dtX3Nh
bml0aXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQl9Cj4gPiAg
IAl9Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpIHsKPiA+
ICsJZm9yX2VhY2hfaW50ZWxfY3J0YygmaTkxNS0+ZHJtLCBjcnRjKSB7Cj4gPiAgIAkJc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPQo+ID4gICAJCQl0b19pbnRlbF9jcnRjX3N0
YXRlKGNydGMtPmJhc2Uuc3RhdGUpOwo+ID4gQEAgLTYxMjIsMjYgKzYxMjIsMjYgQEAgdm9pZCBn
NHhfd21fc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJ
CWNydGMtPndtLmFjdGl2ZS5nNHggPSBjcnRjX3N0YXRlLT53bS5nNHgub3B0aW1hbDsKPiA+ICAg
CX0KPiA+IC0JZzR4X3Byb2dyYW1fd2F0ZXJtYXJrcyhkZXZfcHJpdik7Cj4gPiArCWc0eF9wcm9n
cmFtX3dhdGVybWFya3MoaTkxNSk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPndtLndt
X211dGV4KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT53bS53bV9tdXRleCk7Cj4gPiAgIH0K
PiA+IC12b2lkIHZsdl93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gK3ZvaWQgdmx2X3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qgdmx2X3dtX3ZhbHVlcyAqd20gPSAmZGV2
X3ByaXYtPndtLnZsdjsKPiA+ICsJc3RydWN0IHZsdl93bV92YWx1ZXMgKndtID0gJmk5MTUtPndt
LnZsdjsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ID4gICAJdTMyIHZhbDsKPiA+
IC0Jdmx2X3JlYWRfd21fdmFsdWVzKGRldl9wcml2LCB3bSk7Cj4gPiArCXZsdl9yZWFkX3dtX3Zh
bHVlcyhpOTE1LCB3bSk7Cj4gPiAgIAl3bS0+Y3hzciA9IEk5MTVfUkVBRChGV19CTENfU0VMRl9W
TFYpICYgRldfQ1NQV1JEV05FTjsKPiA+ICAgCXdtLT5sZXZlbCA9IFZMVl9XTV9MRVZFTF9QTTI7
Cj4gPiAtCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4gLQkJdmx2X3B1bml0X2dl
dChkZXZfcHJpdik7Cj4gPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiArCQl2bHZf
cHVuaXRfZ2V0KGk5MTUpOwo+ID4gLQkJdmFsID0gdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBV
TklUX1JFR19EU1BTU1BNKTsKPiA+ICsJCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklU
X1JFR19EU1BTU1BNKTsKPiA+ICAgCQlpZiAodmFsICYgRFNQX01BWEZJRk9fUE01X0VOQUJMRSkK
PiA+ICAgCQkJd20tPmxldmVsID0gVkxWX1dNX0xFVkVMX1BNNTsKPiA+IEBAIC02MTU0LDI1ICs2
MTU0LDI1IEBAIHZvaWQgdmx2X3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICogSElHSC9MT1cgYml0cyBzbyB0aGF0IHdlIGRvbid0IGFj
dHVhbGx5IGNoYW5nZQo+ID4gICAJCSAqIHRoZSBjdXJyZW50IHN0YXRlLgo+ID4gICAJCSAqLwo+
ID4gLQkJdmFsID0gdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19ERFJfU0VUVVAy
KTsKPiA+ICsJCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19ERFJfU0VUVVAy
KTsKPiA+ICAgCQl2YWwgfD0gRk9SQ0VfRERSX0ZSRVFfUkVRX0FDSzsKPiA+IC0JCXZsdl9wdW5p
dF93cml0ZShkZXZfcHJpdiwgUFVOSVRfUkVHX0REUl9TRVRVUDIsIHZhbCk7Cj4gPiArCQl2bHZf
cHVuaXRfd3JpdGUoaTkxNSwgUFVOSVRfUkVHX0REUl9TRVRVUDIsIHZhbCk7Cj4gPiAtCQlpZiAo
d2FpdF9mb3IoKHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRERSX1NFVFVQMikg
Jgo+ID4gKwkJaWYgKHdhaXRfZm9yKCh2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfRERS
X1NFVFVQMikgJgo+ID4gICAJCQkgICAgICBGT1JDRV9ERFJfRlJFUV9SRVFfQUNLKSA9PSAwLCAz
KSkgewo+ID4gICAJCQlEUk1fREVCVUdfS01TKCJQdW5pdCBub3QgYWNraW5nIEREUiBEVkZTIHJl
cXVlc3QsICIKPiA+ICAgCQkJCSAgICAgICJhc3N1bWluZyBERFIgRFZGUyBpcyBkaXNhYmxlZFxu
Iik7Cj4gPiAtCQkJZGV2X3ByaXYtPndtLm1heF9sZXZlbCA9IFZMVl9XTV9MRVZFTF9QTTU7Cj4g
PiArCQkJaTkxNS0+d20ubWF4X2xldmVsID0gVkxWX1dNX0xFVkVMX1BNNTsKPiA+ICAgCQl9IGVs
c2Ugewo+ID4gLQkJCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRERS
X1NFVFVQMik7Cj4gPiArCQkJdmFsID0gdmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0RE
Ul9TRVRVUDIpOwo+ID4gICAJCQlpZiAoKHZhbCAmIEZPUkNFX0REUl9ISUdIX0ZSRVEpID09IDAp
Cj4gPiAgIAkJCQl3bS0+bGV2ZWwgPSBWTFZfV01fTEVWRUxfRERSX0RWRlM7Cj4gPiAgIAkJfQo+
ID4gLQkJdmx2X3B1bml0X3B1dChkZXZfcHJpdik7Cj4gPiArCQl2bHZfcHVuaXRfcHV0KGk5MTUp
Owo+ID4gICAJfQo+ID4gLQlmb3JfZWFjaF9pbnRlbF9jcnRjKCZkZXZfcHJpdi0+ZHJtLCBjcnRj
KSB7Cj4gPiArCWZvcl9lYWNoX2ludGVsX2NydGMoJmk5MTUtPmRybSwgY3J0Yykgewo+ID4gICAJ
CXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlID0KPiA+ICAgCQkJdG9faW50ZWxf
Y3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiA+ICAgCQlzdHJ1Y3Qgdmx2X3dtX3N0YXRl
ICphY3RpdmUgPSAmY3J0Yy0+d20uYWN0aXZlLnZsdjsKPiA+IEBAIC02MjI0LDE2ICs2MjI0LDE2
IEBAIHZvaWQgdmx2X3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiAgIAkJICAgICAgd20tPnNyLnBsYW5lLCB3bS0+c3IuY3Vyc29yLCB3bS0+bGV2
ZWwsIHdtLT5jeHNyKTsKPiA+ICAgfQo+ID4gLXZvaWQgdmx2X3dtX3Nhbml0aXplKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIHZsdl93bV9zYW5pdGl6ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX3Bs
YW5lICpwbGFuZTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwo+ID4gLQltdXRleF9s
b2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT53bS53
bV9tdXRleCk7Cj4gPiAtCWZvcl9lYWNoX2ludGVsX3BsYW5lKCZkZXZfcHJpdi0+ZHJtLCBwbGFu
ZSkgewo+ID4gKwlmb3JfZWFjaF9pbnRlbF9wbGFuZSgmaTkxNS0+ZHJtLCBwbGFuZSkgewo+ID4g
ICAJCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0KPiA+IC0JCQlpbnRlbF9nZXRfY3J0Y19mb3Jf
cGlwZShkZXZfcHJpdiwgcGxhbmUtPnBpcGUpOwo+ID4gKwkJCWludGVsX2dldF9jcnRjX2Zvcl9w
aXBlKGk5MTUsIHBsYW5lLT5waXBlKTsKPiA+ICAgCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSA9Cj4gPiAgIAkJCXRvX2ludGVsX2NydGNfc3RhdGUoY3J0Yy0+YmFzZS5zdGF0
ZSk7Cj4gPiAgIAkJc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSA9Cj4gPiBA
QCAtNjI1OSw3ICs2MjU5LDcgQEAgdm9pZCB2bHZfd21fc2FuaXRpemUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCX0KPiA+ICAgCX0KPiA+IC0JZm9yX2VhY2hfaW50
ZWxfY3J0YygmZGV2X3ByaXYtPmRybSwgY3J0Yykgewo+ID4gKwlmb3JfZWFjaF9pbnRlbF9jcnRj
KCZpOTE1LT5kcm0sIGNydGMpIHsKPiA+ICAgCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSA9Cj4gPiAgIAkJCXRvX2ludGVsX2NydGNfc3RhdGUoY3J0Yy0+YmFzZS5zdGF0ZSk7
Cj4gPiBAQCAtNjI2OCwxNiArNjI2OCwxNiBAQCB2b2lkIHZsdl93bV9zYW5pdGl6ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJY3J0Yy0+d20uYWN0aXZlLnZsdiA9
IGNydGNfc3RhdGUtPndtLnZsdi5vcHRpbWFsOwo+ID4gICAJfQo+ID4gLQl2bHZfcHJvZ3JhbV93
YXRlcm1hcmtzKGRldl9wcml2KTsKPiA+ICsJdmx2X3Byb2dyYW1fd2F0ZXJtYXJrcyhpOTE1KTsK
PiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ID4gKwltdXRleF91
bmxvY2soJmk5MTUtPndtLndtX211dGV4KTsKPiA+ICAgfQo+ID4gICAvKgo+ID4gICAgKiBGSVhN
RSBzaG91bGQgcHJvYmFibHkga2lsbCB0aGlzIGFuZCBpbXByb3ZlCj4gPiAgICAqIHRoZSByZWFs
IHdhdGVybWFyayByZWFkb3V0L3Nhbml0YXRpb24gaW5zdGVhZAo+ID4gICAgKi8KPiA+IC1zdGF0
aWMgdm9pZCBpbGtfaW5pdF9scF93YXRlcm1hcmtzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbGtfaW5pdF9scF93YXRlcm1hcmtzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlJOTE1X1dSSVRFKFdNM19MUF9J
TEssIEk5MTVfUkVBRChXTTNfTFBfSUxLKSAmIH5XTTFfTFBfU1JfRU4pOwo+ID4gICAJSTkxNV9X
UklURShXTTJfTFBfSUxLLCBJOTE1X1JFQUQoV00yX0xQX0lMSykgJiB+V00xX0xQX1NSX0VOKTsK
PiA+IEBAIC02Mjg5LDE0ICs2Mjg5LDE0IEBAIHN0YXRpYyB2b2lkIGlsa19pbml0X2xwX3dhdGVy
bWFya3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJICovCj4gPiAg
IH0KPiA+IC12b2lkIGlsa193bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gK3ZvaWQgaWxrX3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaWxrX3dtX3ZhbHVlcyAqaHcgPSAm
ZGV2X3ByaXYtPndtLmh3Owo+ID4gKwlzdHJ1Y3QgaWxrX3dtX3ZhbHVlcyAqaHcgPSAmaTkxNS0+
d20uaHc7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKPiA+IC0JaWxrX2luaXRfbHBf
d2F0ZXJtYXJrcyhkZXZfcHJpdik7Cj4gPiArCWlsa19pbml0X2xwX3dhdGVybWFya3MoaTkxNSk7
Cj4gPiAtCWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpCj4gPiArCWZv
cl9lYWNoX2ludGVsX2NydGMoJmk5MTUtPmRybSwgY3J0YykKPiA+ICAgCQlpbGtfcGlwZV93bV9n
ZXRfaHdfc3RhdGUoY3J0Yyk7Cj4gPiAgIAlody0+d21fbHBbMF0gPSBJOTE1X1JFQUQoV00xX0xQ
X0lMSyk7Cj4gPiBAQCAtNjMwNCwxNSArNjMwNCwxNSBAQCB2b2lkIGlsa193bV9nZXRfaHdfc3Rh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJaHctPndtX2xwWzJd
ID0gSTkxNV9SRUFEKFdNM19MUF9JTEspOwo+ID4gICAJaHctPndtX2xwX3NwclswXSA9IEk5MTVf
UkVBRChXTTFTX0xQX0lMSyk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDcpIHsK
PiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA3KSB7Cj4gPiAgIAkJaHctPndtX2xwX3Nwclsx
XSA9IEk5MTVfUkVBRChXTTJTX0xQX0lWQik7Cj4gPiAgIAkJaHctPndtX2xwX3NwclsyXSA9IEk5
MTVfUkVBRChXTTNTX0xQX0lWQik7Cj4gPiAgIAl9Cj4gPiAtCWlmIChJU19IQVNXRUxMKGRldl9w
cml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfSEFTV0VMTChpOTE1
KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gPiAgIAkJaHctPnBhcnRpdGlvbmluZyA9IChJOTE1
X1JFQUQoV01fTUlTQykgJiBXTV9NSVNDX0RBVEFfUEFSVElUSU9OXzVfNikgPwo+ID4gICAJCQlJ
TlRFTF9EREJfUEFSVF81XzYgOiBJTlRFTF9EREJfUEFSVF8xXzI7Cj4gPiAtCWVsc2UgaWYgKElT
X0lWWUJSSURHRShkZXZfcHJpdikpCj4gPiArCWVsc2UgaWYgKElTX0lWWUJSSURHRShpOTE1KSkK
PiA+ICAgCQlody0+cGFydGl0aW9uaW5nID0gKEk5MTVfUkVBRChESVNQX0FSQl9DVEwyKSAmIERJ
U1BfREFUQV9QQVJUSVRJT05fNV82KSA/Cj4gPiAgIAkJCUlOVEVMX0REQl9QQVJUXzVfNiA6IElO
VEVMX0REQl9QQVJUXzFfMjsKPiA+IEBAIC02MzU1LDIyICs2MzU1LDIyIEBAIHZvaWQgaWxrX3dt
X2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgICAq
Lwo+ID4gICB2b2lkIGludGVsX3VwZGF0ZV93YXRlcm1hcmtzKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPmRpc3BsYXku
dXBkYXRlX3dtKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkudXBkYXRlX3dtKGNydGMpOwo+ID4g
KwlpZiAoaTkxNS0+ZGlzcGxheS51cGRhdGVfd20pCj4gPiArCQlpOTE1LT5kaXNwbGF5LnVwZGF0
ZV93bShjcnRjKTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfZW5hYmxlX2lwYyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9lbmFibGVfaXBjKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQlp
ZiAoIUhBU19JUEMoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19JUEMoaTkxNSkpCj4gPiAgIAkJ
cmV0dXJuOwo+ID4gICAJdmFsID0gSTkxNV9SRUFEKERJU1BfQVJCX0NUTDIpOwo+ID4gLQlpZiAo
ZGV2X3ByaXYtPmlwY19lbmFibGVkKQo+ID4gKwlpZiAoaTkxNS0+aXBjX2VuYWJsZWQpCj4gPiAg
IAkJdmFsIHw9IERJU1BfSVBDX0VOQUJMRTsKPiA+ICAgCWVsc2UKPiA+ICAgCQl2YWwgJj0gfkRJ
U1BfSVBDX0VOQUJMRTsKPiA+IEBAIC02Mzc4LDI3ICs2Mzc4LDI3IEBAIHZvaWQgaW50ZWxfZW5h
YmxlX2lwYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlJOTE1X1dS
SVRFKERJU1BfQVJCX0NUTDIsIHZhbCk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBpbnRlbF9j
YW5fZW5hYmxlX2lwYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3Rh
dGljIGJvb2wgaW50ZWxfY2FuX2VuYWJsZV9pcGMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gPiAgIHsKPiA+ICAgCS8qIERpc3BsYXkgV0EgIzA0NzcgV2FEaXNhYmxlSVBDOiBza2wg
Ki8KPiA+IC0JaWYgKElTX1NLWUxBS0UoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfU0tZTEFLRShp
OTE1KSkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAkvKiBEaXNwbGF5IFdBICMxMTQxOiBT
S0w6YWxsIEtCTDphbGwgQ0ZMICovCj4gPiAtCWlmIChJU19LQUJZTEFLRShkZXZfcHJpdikgfHwg
SVNfQ09GRkVFTEFLRShkZXZfcHJpdikpCj4gPiAtCQlyZXR1cm4gZGV2X3ByaXYtPmRyYW1faW5m
by5zeW1tZXRyaWNfbWVtb3J5Owo+ID4gKwlpZiAoSVNfS0FCWUxBS0UoaTkxNSkgfHwgSVNfQ09G
RkVFTEFLRShpOTE1KSkKPiA+ICsJCXJldHVybiBpOTE1LT5kcmFtX2luZm8uc3ltbWV0cmljX21l
bW9yeTsKPiA+ICAgCXJldHVybiB0cnVlOwo+ID4gICB9Cj4gPiAtdm9pZCBpbnRlbF9pbml0X2lw
YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBpbnRlbF9pbml0
X2lwYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoIUhB
U19JUEMoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19JUEMoaTkxNSkpCj4gPiAgIAkJcmV0dXJu
Owo+ID4gLQlkZXZfcHJpdi0+aXBjX2VuYWJsZWQgPSBpbnRlbF9jYW5fZW5hYmxlX2lwYyhkZXZf
cHJpdik7Cj4gPiArCWk5MTUtPmlwY19lbmFibGVkID0gaW50ZWxfY2FuX2VuYWJsZV9pcGMoaTkx
NSk7Cj4gPiAtCWludGVsX2VuYWJsZV9pcGMoZGV2X3ByaXYpOwo+ID4gKwlpbnRlbF9lbmFibGVf
aXBjKGk5MTUpOwo+ID4gICB9Cj4gPiAgIC8qCj4gPiBAQCAtNjQzMCw5ICs2NDMwLDkgQEAgYm9v
bCBpcm9ubGFrZV9zZXRfZHJwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTggdmFs
KQo+ID4gICAJcmV0dXJuIHRydWU7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpcm9ubGFrZV9l
bmFibGVfZHJwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGlj
IHZvaWQgaXJvbmxha2VfZW5hYmxlX2RycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51
bmNvcmU7Cj4gPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7
Cj4gPiAgIAl1MzIgcmd2bW9kZWN0bDsKPiA+ICAgCXU4IGZtYXgsIGZtaW4sIGZzdGFydCwgdnN0
YXJ0Owo+ID4gQEAgLTY0NjMsMTIgKzY0NjMsMTIgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfZW5h
YmxlX2RycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJdnN0YXJ0
ID0gKGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgUFhWRlJFUShmc3RhcnQpKSAmCj4gPiAgIAkJ
ICBQWFZGUkVRX1BYX01BU0spID4+IFBYVkZSRVFfUFhfU0hJRlQ7Cj4gPiAtCWRldl9wcml2LT5p
cHMuZm1heCA9IGZtYXg7IC8qIElQUyBjYWxsYmFjayB3aWxsIGluY3JlYXNlIHRoaXMgKi8KPiA+
IC0JZGV2X3ByaXYtPmlwcy5mc3RhcnQgPSBmc3RhcnQ7Cj4gPiArCWk5MTUtPmlwcy5mbWF4ID0g
Zm1heDsgLyogSVBTIGNhbGxiYWNrIHdpbGwgaW5jcmVhc2UgdGhpcyAqLwo+ID4gKwlpOTE1LT5p
cHMuZnN0YXJ0ID0gZnN0YXJ0Owo+ID4gLQlkZXZfcHJpdi0+aXBzLm1heF9kZWxheSA9IGZzdGFy
dDsKPiA+IC0JZGV2X3ByaXYtPmlwcy5taW5fZGVsYXkgPSBmbWluOwo+ID4gLQlkZXZfcHJpdi0+
aXBzLmN1cl9kZWxheSA9IGZzdGFydDsKPiA+ICsJaTkxNS0+aXBzLm1heF9kZWxheSA9IGZzdGFy
dDsKPiA+ICsJaTkxNS0+aXBzLm1pbl9kZWxheSA9IGZtaW47Cj4gPiArCWk5MTUtPmlwcy5jdXJf
ZGVsYXkgPSBmc3RhcnQ7Cj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJmbWF4OiAlZCwgZm1pbjog
JWQsIGZzdGFydDogJWRcbiIsCj4gPiAgIAkJCSBmbWF4LCBmbWluLCBmc3RhcnQpOwo+ID4gQEAg
LTY0OTIsMTUgKzY0OTIsMTUgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfZW5hYmxlX2RycHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCURSTV9FUlJPUigic3R1Y2sg
dHJ5aW5nIHRvIGNoYW5nZSBwZXJmIG1vZGVcbiIpOwo+ID4gICAJbWRlbGF5KDEpOwo+ID4gLQlp
cm9ubGFrZV9zZXRfZHJwcyhkZXZfcHJpdiwgZnN0YXJ0KTsKPiA+ICsJaXJvbmxha2Vfc2V0X2Ry
cHMoaTkxNSwgZnN0YXJ0KTsKPiA+IC0JZGV2X3ByaXYtPmlwcy5sYXN0X2NvdW50MSA9Cj4gPiAr
CWk5MTUtPmlwcy5sYXN0X2NvdW50MSA9Cj4gPiAgIAkJaW50ZWxfdW5jb3JlX3JlYWQodW5jb3Jl
LCBETUlFQykgKwo+ID4gICAJCWludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgRERSRUMpICsKPiA+
ICAgCQlpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIENTSUVDKTsKPiA+IC0JZGV2X3ByaXYtPmlw
cy5sYXN0X3RpbWUxID0gamlmZmllc190b19tc2VjcyhqaWZmaWVzKTsKPiA+IC0JZGV2X3ByaXYt
Pmlwcy5sYXN0X2NvdW50MiA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0ZYRUMpOwo+ID4g
LQlkZXZfcHJpdi0+aXBzLmxhc3RfdGltZTIgPSBrdGltZV9nZXRfcmF3X25zKCk7Cj4gPiArCWk5
MTUtPmlwcy5sYXN0X3RpbWUxID0gamlmZmllc190b19tc2VjcyhqaWZmaWVzKTsKPiA+ICsJaTkx
NS0+aXBzLmxhc3RfY291bnQyID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRlhFQyk7Cj4g
PiArCWk5MTUtPmlwcy5sYXN0X3RpbWUyID0ga3RpbWVfZ2V0X3Jhd19ucygpOwo+ID4gICAJc3Bp
bl91bmxvY2tfaXJxKCZtY2hkZXZfbG9jayk7Cj4gPiAgIH0KPiA+IEBAIC02NTQzLDkgKzY1NDMs
OSBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9kaXNhYmxlX2RycHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgICAqIG91cnNlbHZlcywgaW5zdGVhZCBvZiBkb2luZyBhIHJtdyBj
eWNsZSAod2hpY2ggbWlnaHQgcmVzdWx0IGluIHVzIGNsZWFyaW5nCj4gPiAgICAqIGFsbCBsaW1p
dHMgYW5kIHRoZSBncHUgc3R1Y2sgYXQgd2hhdGV2ZXIgZnJlcXVlbmN5IGl0IGlzIGF0IGF0bSku
Cj4gPiAgICAqLwo+ID4gLXN0YXRpYyB1MzIgaW50ZWxfcnBzX2xpbWl0cyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCkKPiA+ICtzdGF0aWMgdTMyIGludGVsX3Jwc19s
aW1pdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU4IHZhbCkKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiA+ICsJc3Ry
dWN0IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0X3BtLnJwczsKPiA+ICAgCXUzMiBsaW1pdHM7
Cj4gPiAgIAkvKiBPbmx5IHNldCB0aGUgZG93biBsaW1pdCB3aGVuIHdlJ3ZlIHJlYWNoZWQgdGhl
IGxvd2VzdCBsZXZlbCB0byBhdm9pZAo+ID4gQEAgLTY1NTQsNyArNjU1NCw3IEBAIHN0YXRpYyB1
MzIgaW50ZWxfcnBzX2xpbWl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4
IHZhbCkKPiA+ICAgCSAqIHRoZSBodyBydW5zIGF0IHRoZSBtaW5pbWFsIGNsb2NrIGJlZm9yZSBz
ZWxlY3RpbmcgdGhlIGRlc2lyZWQKPiA+ICAgCSAqIGZyZXF1ZW5jeSwgaWYgdGhlIGRvd24gdGhy
ZXNob2xkIGV4cGlyZXMgaW4gdGhhdCB3aW5kb3cgd2Ugd2lsbCBub3QKPiA+ICAgCSAqIHJlY2Vp
dmUgYSBkb3duIGludGVycnVwdC4gKi8KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
OSkgewo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpIHsKPiA+ICAgCQlsaW1pdHMgPSAo
cnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQpIDw8IDIzOwo+ID4gICAJCWlmICh2YWwgPD0gcnBzLT5t
aW5fZnJlcV9zb2Z0bGltaXQpCj4gPiAgIAkJCWxpbWl0cyB8PSAocnBzLT5taW5fZnJlcV9zb2Z0
bGltaXQpIDw8IDE0Owo+ID4gQEAgLTY1NjcsOSArNjU2Nyw5IEBAIHN0YXRpYyB1MzIgaW50ZWxf
cnBzX2xpbWl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCkKPiA+
ICAgCXJldHVybiBsaW1pdHM7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBycHNfc2V0X3Bvd2Vy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IG5ld19wb3dlcikKPiA+ICtz
dGF0aWMgdm9pZCBycHNfc2V0X3Bvd2VyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBp
bnQgbmV3X3Bvd2VyKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZf
cHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3Rf
cG0ucnBzOwo+ID4gICAJdTMyIHRocmVzaG9sZF91cCA9IDAsIHRocmVzaG9sZF9kb3duID0gMDsg
LyogaW4gJSAqLwo+ID4gICAJdTMyIGVpX3VwID0gMCwgZWlfZG93biA9IDA7Cj4gPiBAQCAtNjYx
NCwyMyArNjYxNCwyMyBAQCBzdGF0aWMgdm9pZCBycHNfc2V0X3Bvd2VyKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgaW50IG5ld19wb3dlcikKPiA+ICAgCS8qIFdoZW4gYnl0IGNh
biBzdXJ2aXZlIHdpdGhvdXQgc3lzdGVtIGhhbmcgd2l0aCBkeW5hbWljCj4gPiAgIAkgKiBzdyBm
cmVxIGFkanVzdG1lbnRzLCB0aGlzIHJlc3RyaWN0aW9uIGNhbiBiZSBsaWZ0ZWQuCj4gPiAgIAkg
Ki8KPiA+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfVkFMTEVZ
VklFVyhpOTE1KSkKPiA+ICAgCQlnb3RvIHNraXBfaHdfd3JpdGU7Cj4gPiAgIAlJOTE1X1dSSVRF
KEdFTjZfUlBfVVBfRUksCj4gPiAtCQkgICBHVF9JTlRFUlZBTF9GUk9NX1VTKGRldl9wcml2LCBl
aV91cCkpOwo+ID4gKwkJICAgR1RfSU5URVJWQUxfRlJPTV9VUyhpOTE1LCBlaV91cCkpOwo+ID4g
ICAJSTkxNV9XUklURShHRU42X1JQX1VQX1RIUkVTSE9MRCwKPiA+IC0JCSAgIEdUX0lOVEVSVkFM
X0ZST01fVVMoZGV2X3ByaXYsCj4gPiArCQkgICBHVF9JTlRFUlZBTF9GUk9NX1VTKGk5MTUsCj4g
PiAgIAkJCQkgICAgICAgZWlfdXAgKiB0aHJlc2hvbGRfdXAgLyAxMDApKTsKPiA+ICAgCUk5MTVf
V1JJVEUoR0VONl9SUF9ET1dOX0VJLAo+ID4gLQkJICAgR1RfSU5URVJWQUxfRlJPTV9VUyhkZXZf
cHJpdiwgZWlfZG93bikpOwo+ID4gKwkJICAgR1RfSU5URVJWQUxfRlJPTV9VUyhpOTE1LCBlaV9k
b3duKSk7Cj4gPiAgIAlJOTE1X1dSSVRFKEdFTjZfUlBfRE9XTl9USFJFU0hPTEQsCj4gPiAtCQkg
ICBHVF9JTlRFUlZBTF9GUk9NX1VTKGRldl9wcml2LAo+ID4gKwkJICAgR1RfSU5URVJWQUxfRlJP
TV9VUyhpOTE1LAo+ID4gICAJCQkJICAgICAgIGVpX2Rvd24gKiB0aHJlc2hvbGRfZG93biAvIDEw
MCkpOwo+ID4gICAJSTkxNV9XUklURShHRU42X1JQX0NPTlRST0wsCj4gPiAtCQkgICAoSU5URUxf
R0VOKGRldl9wcml2KSA+IDkgPyAwIDogR0VONl9SUF9NRURJQV9UVVJCTykgfAo+ID4gKwkJICAg
KElOVEVMX0dFTihpOTE1KSA+IDkgPyAwIDogR0VONl9SUF9NRURJQV9UVVJCTykgfAo+ID4gICAJ
CSAgIEdFTjZfUlBfTUVESUFfSFdfTk9STUFMX01PREUgfAo+ID4gICAJCSAgIEdFTjZfUlBfTUVE
SUFfSVNfR0ZYIHwKPiA+ICAgCQkgICBHRU42X1JQX0VOQUJMRSB8Cj4gPiBAQCAtNjY0Myw5ICs2
NjQzLDkgQEAgc3RhdGljIHZvaWQgcnBzX3NldF9wb3dlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIGludCBuZXdfcG93ZXIpCj4gPiAgIAlycHMtPnBvd2VyLmRvd25fdGhyZXNo
b2xkID0gdGhyZXNob2xkX2Rvd247Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW42X3NldF9y
cHNfdGhyZXNob2xkcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCkK
PiA+ICtzdGF0aWMgdm9pZCBnZW42X3NldF9ycHNfdGhyZXNob2xkcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgdTggdmFsKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9ycHMgKnJw
cyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAm
aTkxNS0+Z3RfcG0ucnBzOwo+ID4gICAJaW50IG5ld19wb3dlcjsKPiA+ICAgCW5ld19wb3dlciA9
IHJwcy0+cG93ZXIubW9kZTsKPiA+IEBAIC02NjgwLDcgKzY2ODAsNyBAQCBzdGF0aWMgdm9pZCBn
ZW42X3NldF9ycHNfdGhyZXNob2xkcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IHU4IHZhbCkKPiA+ICAgCW11dGV4X2xvY2soJnJwcy0+cG93ZXIubXV0ZXgpOwo+ID4gICAJaWYg
KHJwcy0+cG93ZXIuaW50ZXJhY3RpdmUpCj4gPiAgIAkJbmV3X3Bvd2VyID0gSElHSF9QT1dFUjsK
PiA+IC0JcnBzX3NldF9wb3dlcihkZXZfcHJpdiwgbmV3X3Bvd2VyKTsKPiA+ICsJcnBzX3NldF9w
b3dlcihpOTE1LCBuZXdfcG93ZXIpOwo+ID4gICAJbXV0ZXhfdW5sb2NrKCZycHMtPnBvd2VyLm11
dGV4KTsKPiA+ICAgfQo+ID4gQEAgLTY3MDIsOSArNjcwMiw5IEBAIHZvaWQgaW50ZWxfcnBzX21h
cmtfaW50ZXJhY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgaW50ZXJh
Y3RpdmUpCj4gPiAgIAltdXRleF91bmxvY2soJnJwcy0+cG93ZXIubXV0ZXgpOwo+ID4gICB9Cj4g
PiAtc3RhdGljIHUzMiBnZW42X3Jwc19wbV9tYXNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgdTggdmFsKQo+ID4gK3N0YXRpYyB1MzIgZ2VuNl9ycHNfcG1fbWFzayhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTggdmFsKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRl
bF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ID4gICAJdTMyIG1hc2sgPSAwOwo+ID4gICAJLyog
V2UgdXNlIFVQX0VJX0VYUElSRUQgaW50ZXJ1cHRzIGZvciBib3RoIHVwL2Rvd24gaW4gbWFudWFs
IG1vZGUgKi8KPiA+IEBAIC02NzEzLDI4ICs2NzEzLDI4IEBAIHN0YXRpYyB1MzIgZ2VuNl9ycHNf
cG1fbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCkKPiA+ICAg
CWlmICh2YWwgPCBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCkKPiA+ICAgCQltYXNrIHw9IEdFTjZf
UE1fUlBfVVBfRUlfRVhQSVJFRCB8IEdFTjZfUE1fUlBfVVBfVEhSRVNIT0xEOwo+ID4gLQltYXNr
ICY9IGRldl9wcml2LT5wbV9ycHNfZXZlbnRzOwo+ID4gKwltYXNrICY9IGk5MTUtPnBtX3Jwc19l
dmVudHM7Cj4gPiAtCXJldHVybiBnZW42X3Nhbml0aXplX3Jwc19wbV9tYXNrKGRldl9wcml2LCB+
bWFzayk7Cj4gPiArCXJldHVybiBnZW42X3Nhbml0aXplX3Jwc19wbV9tYXNrKGk5MTUsIH5tYXNr
KTsKPiA+ICAgfQo+ID4gICAvKiBnZW42X3NldF9ycHMgaXMgY2FsbGVkIHRvIHVwZGF0ZSB0aGUg
ZnJlcXVlbmN5IHJlcXVlc3QsIGJ1dCBzaG91bGQgYWxzbyBiZQo+ID4gICAgKiBjYWxsZWQgd2hl
biB0aGUgcmFuZ2UgKG1pbl9kZWxheSBhbmQgbWF4X2RlbGF5KSBpcyBtb2RpZmllZCBzbyB0aGF0
IHdlIGNhbgo+ID4gICAgKiB1cGRhdGUgdGhlIEdFTjZfUlBfSU5URVJSVVBUX0xJTUlUUyByZWdp
c3RlciBhY2NvcmRpbmdseS4gKi8KPiA+IC1zdGF0aWMgaW50IGdlbjZfc2V0X3JwcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCkKPiA+ICtzdGF0aWMgaW50IGdlbjZf
c2V0X3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTggdmFsKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlz
dHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ID4gICAJLyogbWluL21h
eCBkZWxheSBtYXkgc3RpbGwgaGF2ZSBiZWVuIG1vZGlmaWVkIHNvIGJlIHN1cmUgdG8KPiA+ICAg
CSAqIHdyaXRlIHRoZSBsaW1pdHMgdmFsdWUuCj4gPiAgIAkgKi8KPiA+ICAgCWlmICh2YWwgIT0g
cnBzLT5jdXJfZnJlcSkgewo+ID4gLQkJZ2VuNl9zZXRfcnBzX3RocmVzaG9sZHMoZGV2X3ByaXYs
IHZhbCk7Cj4gPiArCQlnZW42X3NldF9ycHNfdGhyZXNob2xkcyhpOTE1LCB2YWwpOwo+ID4gLQkJ
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiA+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gOSkKPiA+ICAgCQkJSTkxNV9XUklURShHRU42X1JQTlNXUkVRLAo+ID4gICAJCQkJICAgR0VO
OV9GUkVRVUVOQ1kodmFsKSk7Cj4gPiAtCQllbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8
fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ID4gKwkJZWxzZSBpZiAoSVNfSEFTV0VMTChpOTE1
KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gPiAgIAkJCUk5MTVfV1JJVEUoR0VONl9SUE5TV1JF
USwKPiA+ICAgCQkJCSAgIEhTV19GUkVRVUVOQ1kodmFsKSk7Cj4gPiAgIAkJZWxzZQo+ID4gQEAg
LTY3NDcsMzcgKzY3NDcsMzcgQEAgc3RhdGljIGludCBnZW42X3NldF9ycHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCB2YWwpCj4gPiAgIAkvKiBNYWtlIHN1cmUgd2UgY29u
dGludWUgdG8gZ2V0IGludGVycnVwdHMKPiA+ICAgCSAqIHVudGlsIHdlIGhpdCB0aGUgbWluaW11
bSBvciBtYXhpbXVtIGZyZXF1ZW5jaWVzLgo+ID4gICAJICovCj4gPiAtCUk5MTVfV1JJVEUoR0VO
Nl9SUF9JTlRFUlJVUFRfTElNSVRTLCBpbnRlbF9ycHNfbGltaXRzKGRldl9wcml2LCB2YWwpKTsK
PiA+IC0JSTkxNV9XUklURShHRU42X1BNSU5UUk1TSywgZ2VuNl9ycHNfcG1fbWFzayhkZXZfcHJp
diwgdmFsKSk7Cj4gPiArCUk5MTVfV1JJVEUoR0VONl9SUF9JTlRFUlJVUFRfTElNSVRTLCBpbnRl
bF9ycHNfbGltaXRzKGk5MTUsIHZhbCkpOwo+ID4gKwlJOTE1X1dSSVRFKEdFTjZfUE1JTlRSTVNL
LCBnZW42X3Jwc19wbV9tYXNrKGk5MTUsIHZhbCkpOwo+ID4gICAJcnBzLT5jdXJfZnJlcSA9IHZh
bDsKPiA+IC0JdHJhY2VfaW50ZWxfZ3B1X2ZyZXFfY2hhbmdlKGludGVsX2dwdV9mcmVxKGRldl9w
cml2LCB2YWwpKTsKPiA+ICsJdHJhY2VfaW50ZWxfZ3B1X2ZyZXFfY2hhbmdlKGludGVsX2dwdV9m
cmVxKGk5MTUsIHZhbCkpOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50
IHZhbGxleXZpZXdfc2V0X3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4
IHZhbCkKPiA+ICtzdGF0aWMgaW50IHZhbGxleXZpZXdfc2V0X3JwcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgdTggdmFsKQo+ID4gICB7Cj4gPiAgIAlpbnQgZXJyOwo+ID4gLQlpZiAo
V0FSTl9PTkNFKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpICYmICh2YWwgJiAxKSwKPiA+ICsJaWYg
KFdBUk5fT05DRShJU19DSEVSUllWSUVXKGk5MTUpICYmICh2YWwgJiAxKSwKPiA+ICAgCQkgICAg
ICAiT2RkIEdQVSBmcmVxIHZhbHVlXG4iKSkKPiA+ICAgCQl2YWwgJj0gfjE7Cj4gPiAtCUk5MTVf
V1JJVEUoR0VONl9QTUlOVFJNU0ssIGdlbjZfcnBzX3BtX21hc2soZGV2X3ByaXYsIHZhbCkpOwo+
ID4gKwlJOTE1X1dSSVRFKEdFTjZfUE1JTlRSTVNLLCBnZW42X3Jwc19wbV9tYXNrKGk5MTUsIHZh
bCkpOwo+ID4gLQlpZiAodmFsICE9IGRldl9wcml2LT5ndF9wbS5ycHMuY3VyX2ZyZXEpIHsKPiA+
IC0JCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOwo+ID4gLQkJZXJyID0gdmx2X3B1bml0X3dyaXRl
KGRldl9wcml2LCBQVU5JVF9SRUdfR1BVX0ZSRVFfUkVRLCB2YWwpOwo+ID4gLQkJdmx2X3B1bml0
X3B1dChkZXZfcHJpdik7Cj4gPiArCWlmICh2YWwgIT0gaTkxNS0+Z3RfcG0ucnBzLmN1cl9mcmVx
KSB7Cj4gPiArCQl2bHZfcHVuaXRfZ2V0KGk5MTUpOwo+ID4gKwkJZXJyID0gdmx2X3B1bml0X3dy
aXRlKGk5MTUsIFBVTklUX1JFR19HUFVfRlJFUV9SRVEsIHZhbCk7Cj4gPiArCQl2bHZfcHVuaXRf
cHV0KGk5MTUpOwo+ID4gICAJCWlmIChlcnIpCj4gPiAgIAkJCXJldHVybiBlcnI7Cj4gPiAtCQln
ZW42X3NldF9ycHNfdGhyZXNob2xkcyhkZXZfcHJpdiwgdmFsKTsKPiA+ICsJCWdlbjZfc2V0X3Jw
c190aHJlc2hvbGRzKGk5MTUsIHZhbCk7Cj4gPiAgIAl9Cj4gPiAtCWRldl9wcml2LT5ndF9wbS5y
cHMuY3VyX2ZyZXEgPSB2YWw7Cj4gPiAtCXRyYWNlX2ludGVsX2dwdV9mcmVxX2NoYW5nZShpbnRl
bF9ncHVfZnJlcShkZXZfcHJpdiwgdmFsKSk7Cj4gPiArCWk5MTUtPmd0X3BtLnJwcy5jdXJfZnJl
cSA9IHZhbDsKPiA+ICsJdHJhY2VfaW50ZWxfZ3B1X2ZyZXFfY2hhbmdlKGludGVsX2dwdV9mcmVx
KGk5MTUsIHZhbCkpOwo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IEBAIC02Nzg5LDkgKzY3
ODksOSBAQCBzdGF0aWMgaW50IHZhbGxleXZpZXdfc2V0X3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCkKPiA+ICAgICogMi4gUmVxdWVzdCBpZGxlIGZyZXEuCj4g
PiAgICAqIDMuIFJlbGVhc2UgRm9yY2V3YWtlIG9mIE1lZGlhIHdlbGwuCj4gPiAgICovCj4gPiAt
c3RhdGljIHZvaWQgdmx2X3NldF9ycHNfaWRsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgdmx2X3NldF9ycHNfaWRsZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2
X3ByaXYtPmd0X3BtLnJwczsKPiA+ICsJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0
X3BtLnJwczsKPiA+ICAgCXUzMiB2YWwgPSBycHMtPmlkbGVfZnJlcTsKPiA+ICAgCWludCBlcnI7
Cj4gPiBAQCAtNjgxMCwyOCArNjgxMCwyOCBAQCBzdGF0aWMgdm9pZCB2bHZfc2V0X3Jwc19pZGxl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIHB1bml0IGludG8g
Y29tbWl0dGluZyB0aGUgdm9sdGFnZSBjaGFuZ2UpIGFzIHRoYXQgdGFrZXMgYSBsb3QgbGVzcwo+
ID4gICAJICogcG93ZXIgdGhhbiB0aGUgcmVuZGVyIHBvd2Vyd2VsbC4KPiA+ICAgCSAqLwo+ID4g
LQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtF
X01FRElBKTsKPiA+IC0JZXJyID0gdmFsbGV5dmlld19zZXRfcnBzKGRldl9wcml2LCB2YWwpOwo+
ID4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VX
QUtFX01FRElBKTsKPiA+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUtPnVuY29y
ZSwgRk9SQ0VXQUtFX01FRElBKTsKPiA+ICsJZXJyID0gdmFsbGV5dmlld19zZXRfcnBzKGk5MTUs
IHZhbCk7Cj4gPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZP
UkNFV0FLRV9NRURJQSk7Cj4gPiAgIAlpZiAoZXJyKQo+ID4gICAJCURSTV9FUlJPUigiRmFpbGVk
IHRvIHNldCBSUFMgZm9yIGlkbGVcbiIpOwo+ID4gICB9Cj4gPiAtdm9pZCBnZW42X3Jwc19idXN5
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGdlbjZfcnBzX2J1
c3koc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGlu
dGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gPiArCXN0cnVjdCBpbnRlbF9y
cHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gPiAgIAltdXRleF9sb2NrKCZycHMtPmxvY2sp
Owo+ID4gICAJaWYgKHJwcy0+ZW5hYmxlZCkgewo+ID4gICAJCXU4IGZyZXE7Cj4gPiAtCQlpZiAo
ZGV2X3ByaXYtPnBtX3Jwc19ldmVudHMgJiBHRU42X1BNX1JQX1VQX0VJX0VYUElSRUQpCj4gPiAt
CQkJZ2VuNl9ycHNfcmVzZXRfZWkoZGV2X3ByaXYpOwo+ID4gKwkJaWYgKGk5MTUtPnBtX3Jwc19l
dmVudHMgJiBHRU42X1BNX1JQX1VQX0VJX0VYUElSRUQpCj4gPiArCQkJZ2VuNl9ycHNfcmVzZXRf
ZWkoaTkxNSk7Cj4gPiAgIAkJSTkxNV9XUklURShHRU42X1BNSU5UUk1TSywKPiA+IC0JCQkgICBn
ZW42X3Jwc19wbV9tYXNrKGRldl9wcml2LCBycHMtPmN1cl9mcmVxKSk7Cj4gPiArCQkJICAgZ2Vu
Nl9ycHNfcG1fbWFzayhpOTE1LCBycHMtPmN1cl9mcmVxKSk7Cj4gPiAtCQlnZW42X2VuYWJsZV9y
cHNfaW50ZXJydXB0cyhkZXZfcHJpdik7Cj4gPiArCQlnZW42X2VuYWJsZV9ycHNfaW50ZXJydXB0
cyhpOTE1KTsKPiA+ICAgCQkvKiBVc2UgdGhlIHVzZXIncyBkZXNpcmVkIGZyZXF1ZW5jeSBhcyBh
IGd1aWRlLCBidXQgZm9yIGJldHRlcgo+ID4gICAJCSAqIHBlcmZvcm1hbmNlLCBqdW1wIGRpcmVj
dGx5IHRvIFJQZSBhcyBvdXIgc3RhcnRpbmcgZnJlcXVlbmN5Lgo+ID4gQEAgLTY4MzksNyArNjgz
OSw3IEBAIHZvaWQgZ2VuNl9ycHNfYnVzeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiAgIAkJZnJlcSA9IG1heChycHMtPmN1cl9mcmVxLAo+ID4gICAJCQkgICBycHMtPmVm
ZmljaWVudF9mcmVxKTsKPiA+IC0JCWlmIChpbnRlbF9zZXRfcnBzKGRldl9wcml2LAo+ID4gKwkJ
aWYgKGludGVsX3NldF9ycHMoaTkxNSwKPiA+ICAgCQkJCSAgY2xhbXAoZnJlcSwKPiA+ICAgCQkJ
CQlycHMtPm1pbl9mcmVxX3NvZnRsaW1pdCwKPiA+ICAgCQkJCQlycHMtPm1heF9mcmVxX3NvZnRs
aW1pdCkpKQo+ID4gQEAgLTY4NDgsMjYgKzY4NDgsMjYgQEAgdm9pZCBnZW42X3Jwc19idXN5KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCW11dGV4X3VubG9jaygmcnBz
LT5sb2NrKTsKPiA+ICAgfQo+ID4gLXZvaWQgZ2VuNl9ycHNfaWRsZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArdm9pZCBnZW42X3Jwc19pZGxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZk
ZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+
Z3RfcG0ucnBzOwo+ID4gICAJLyogRmx1c2ggb3VyIGJvdHRvbS1oYWxmIHNvIHRoYXQgaXQgZG9l
cyBub3QgcmFjZSB3aXRoIHVzCj4gPiAgIAkgKiBzZXR0aW5nIHRoZSBpZGxlIGZyZXF1ZW5jeSBh
bmQgc28gdGhhdCBpdCBpcyBib3VuZGVkIGJ5Cj4gPiAgIAkgKiBvdXIgcnBtIHdha2VyZWYuIEFu
ZCB0aGVuIGRpc2FibGUgdGhlIGludGVycnVwdHMgdG8gc3RvcCBhbnkKPiA+ICAgCSAqIGZ1dGhl
ciBSUFMgcmVjbG9ja2luZyB3aGlsc3Qgd2UgYXJlIGFzbGVlcC4KPiA+ICAgCSAqLwo+ID4gLQln
ZW42X2Rpc2FibGVfcnBzX2ludGVycnVwdHMoZGV2X3ByaXYpOwo+ID4gKwlnZW42X2Rpc2FibGVf
cnBzX2ludGVycnVwdHMoaTkxNSk7Cj4gPiAgIAltdXRleF9sb2NrKCZycHMtPmxvY2spOwo+ID4g
ICAJaWYgKHJwcy0+ZW5hYmxlZCkgewo+ID4gLQkJaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYp
IHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gLQkJCXZsdl9zZXRfcnBzX2lkbGUoZGV2
X3ByaXYpOwo+ID4gKwkJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhp
OTE1KSkKPiA+ICsJCQl2bHZfc2V0X3Jwc19pZGxlKGk5MTUpOwo+ID4gICAJCWVsc2UKPiA+IC0J
CQlnZW42X3NldF9ycHMoZGV2X3ByaXYsIHJwcy0+aWRsZV9mcmVxKTsKPiA+ICsJCQlnZW42X3Nl
dF9ycHMoaTkxNSwgcnBzLT5pZGxlX2ZyZXEpOwo+ID4gICAJCXJwcy0+bGFzdF9hZGogPSAwOwo+
ID4gICAJCUk5MTVfV1JJVEUoR0VONl9QTUlOVFJNU0ssCj4gPiAtCQkJICAgZ2VuNl9zYW5pdGl6
ZV9ycHNfcG1fbWFzayhkZXZfcHJpdiwgfjApKTsKPiA+ICsJCQkgICBnZW42X3Nhbml0aXplX3Jw
c19wbV9tYXNrKGk5MTUsIH4wKSk7Cj4gPiAgIAl9Cj4gPiAgIAltdXRleF91bmxvY2soJnJwcy0+
bG9jayk7Cj4gPiAgIH0KPiA+IEBAIC02OTA0LDkgKzY5MDQsOSBAQCB2b2lkIGdlbjZfcnBzX2Jv
b3N0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQo+ID4gICAJYXRvbWljX2luYygmcnBzLT5ib29z
dHMpOwo+ID4gICB9Cj4gPiAtaW50IGludGVsX3NldF9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCB1OCB2YWwpCj4gPiAraW50IGludGVsX3NldF9ycHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsIHU4IHZhbCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKPiA+ICsJc3RydWN0IGludGVsX3JwcyAqcnBz
ID0gJmk5MTUtPmd0X3BtLnJwczsKPiA+ICAgCWludCBlcnI7Cj4gPiAgIAlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZycHMtPmxvY2spOwo+ID4gQEAgLTY5MTgsNjMgKzY5MTgsNjMgQEAgaW50IGludGVs
X3NldF9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCB2YWwpCj4gPiAg
IAkJcmV0dXJuIDA7Cj4gPiAgIAl9Cj4gPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8
fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+IC0JCWVyciA9IHZhbGxleXZpZXdfc2V0X3Jw
cyhkZXZfcHJpdiwgdmFsKTsKPiA+ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hF
UlJZVklFVyhpOTE1KSkKPiA+ICsJCWVyciA9IHZhbGxleXZpZXdfc2V0X3JwcyhpOTE1LCB2YWwp
Owo+ID4gICAJZWxzZQo+ID4gLQkJZXJyID0gZ2VuNl9zZXRfcnBzKGRldl9wcml2LCB2YWwpOwo+
ID4gKwkJZXJyID0gZ2VuNl9zZXRfcnBzKGk5MTUsIHZhbCk7Cj4gPiAgIAlyZXR1cm4gZXJyOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuOV9kaXNhYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgZ2VuOV9kaXNhYmxlX3JjNihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJSTkxNV9XUklURShHRU42
X1JDX0NPTlRST0wsIDApOwo+ID4gICAJSTkxNV9XUklURShHRU45X1BHX0VOQUJMRSwgMCk7Cj4g
PiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW45X2Rpc2FibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnZW45X2Rpc2FibGVfcnBzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlJOTE1X1dSSVRFKEdFTjZf
UlBfQ09OVFJPTCwgMCk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW42X2Rpc2FibGVfcmM2
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnZW42
X2Rpc2FibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAg
IAlJOTE1X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwgMCk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9p
ZCBnZW42X2Rpc2FibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICtzdGF0aWMgdm9pZCBnZW42X2Rpc2FibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAgIAlJOTE1X1dSSVRFKEdFTjZfUlBOU1dSRVEsIDEgPDwgMzEpOwo+
ID4gICAJSTkxNV9XUklURShHRU42X1JQX0NPTlRST0wsIDApOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IHZvaWQgY2hlcnJ5dmlld19kaXNhYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgY2hlcnJ5dmlld19kaXNhYmxlX3JjNihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJSTkxNV9XUklURShHRU42X1JDX0NP
TlRST0wsIDApOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgY2hlcnJ5dmlld19kaXNhYmxlX3Jw
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgY2hl
cnJ5dmlld19kaXNhYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAg
ewo+ID4gICAJSTkxNV9XUklURShHRU42X1JQX0NPTlRST0wsIDApOwo+ID4gICB9Cj4gPiAtc3Rh
dGljIHZvaWQgdmFsbGV5dmlld19kaXNhYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgdmFsbGV5dmlld19kaXNhYmxlX3JjNihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJLyogV2UncmUgZG9pbmcgZm9y
Y2V3YWtlIGJlZm9yZSBEaXNhYmxpbmcgUkM2LAo+ID4gICAJICogVGhpcyB3aGF0IHRoZSBCSU9T
IGV4cGVjdHMgd2hlbiBnb2luZyBpbnRvIHN1c3BlbmQgKi8KPiA+IC0JaW50ZWxfdW5jb3JlX2Zv
cmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gKwlpbnRl
bF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+
ICAgCUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLCAwKTsKPiA+IC0JaW50ZWxfdW5jb3JlX2Zv
cmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gKwlpbnRl
bF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+
ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHZhbGxleXZpZXdfZGlzYWJsZV9ycHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIHZhbGxleXZpZXdfZGlzYWJs
ZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCUk5MTVf
V1JJVEUoR0VONl9SUF9DT05UUk9MLCAwKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBib29sIGJ4dF9j
aGVja19iaW9zX3JjNl9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiArc3RhdGljIGJvb2wgYnh0X2NoZWNrX2Jpb3NfcmM2X3NldHVwKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlib29sIGVuYWJsZV9yYzYgPSB0cnVlOwo+ID4g
ICAJdW5zaWduZWQgbG9uZyByYzZfY3R4X2Jhc2U7Cj4gPiBAQCAtNzAwMCw4ICs3MDAwLDggQEAg
c3RhdGljIGJvb2wgYnh0X2NoZWNrX2Jpb3NfcmM2X3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIGZvciB0aGlzIGNoZWNrLgo+ID4gICAJICovCj4gPiAg
IAlyYzZfY3R4X2Jhc2UgPSBJOTE1X1JFQUQoUkM2X0NUWF9CQVNFKSAmIFJDNl9DVFhfQkFTRV9N
QVNLOwo+ID4gLQlpZiAoISgocmM2X2N0eF9iYXNlID49IGRldl9wcml2LT5kc21fcmVzZXJ2ZWQu
c3RhcnQpICYmCj4gPiAtCSAgICAgIChyYzZfY3R4X2Jhc2UgKyBQQUdFX1NJWkUgPCBkZXZfcHJp
di0+ZHNtX3Jlc2VydmVkLmVuZCkpKSB7Cj4gPiArCWlmICghKChyYzZfY3R4X2Jhc2UgPj0gaTkx
NS0+ZHNtX3Jlc2VydmVkLnN0YXJ0KSAmJgo+ID4gKwkgICAgICAocmM2X2N0eF9iYXNlICsgUEFH
RV9TSVpFIDwgaTkxNS0+ZHNtX3Jlc2VydmVkLmVuZCkpKSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0RS
SVZFUigiUkM2IEJhc2UgYWRkcmVzcyBub3QgYXMgZXhwZWN0ZWQuXG4iKTsKPiA+ICAgCQllbmFi
bGVfcmM2ID0gZmFsc2U7Cj4gPiAgIAl9Cj4gPiBAQCAtNzA2MiwxNCArNzA2MiwxNCBAQCBzdGF0
aWMgYm9vbCBzYW5pdGl6ZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAg
IAlyZXR1cm4gaW5mby0+aGFzX3JjNjsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGdlbjZfaW5p
dF9ycHNfZnJlcXVlbmNpZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
K3N0YXRpYyB2b2lkIGdlbjZfaW5pdF9ycHNfZnJlcXVlbmNpZXMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9w
cml2LT5ndF9wbS5ycHM7Cj4gPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9w
bS5ycHM7Cj4gPiAgIAkvKiBBbGwgb2YgdGhlc2UgdmFsdWVzIGFyZSBpbiB1bml0cyBvZiA1ME1I
eiAqLwo+ID4gICAJLyogc3RhdGljIHZhbHVlcyBmcm9tIEhXOiBSUDAgPiBSUDEgPiBSUG4gKG1p
bl9mcmVxKSAqLwo+ID4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElT
X0dFTjlfTFAoaTkxNSkpIHsKPiA+ICAgCQl1MzIgcnBfc3RhdGVfY2FwID0gSTkxNV9SRUFEKEJY
VF9SUF9TVEFURV9DQVApOwo+ID4gICAJCXJwcy0+cnAwX2ZyZXEgPSAocnBfc3RhdGVfY2FwID4+
IDE2KSAmIDB4ZmY7Cj4gPiAgIAkJcnBzLT5ycDFfZnJlcSA9IChycF9zdGF0ZV9jYXAgPj4gIDgp
ICYgMHhmZjsKPiA+IEBAIC03MDg0LDExICs3MDg0LDExIEBAIHN0YXRpYyB2b2lkIGdlbjZfaW5p
dF9ycHNfZnJlcXVlbmNpZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
ICAJcnBzLT5tYXhfZnJlcSA9IHJwcy0+cnAwX2ZyZXE7Cj4gPiAgIAlycHMtPmVmZmljaWVudF9m
cmVxID0gcnBzLT5ycDFfZnJlcTsKPiA+IC0JaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElT
X0JST0FEV0VMTChkZXZfcHJpdikgfHwKPiA+IC0JICAgIElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8
IElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApIHsKPiA+ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkg
fHwgSVNfQlJPQURXRUxMKGk5MTUpIHx8Cj4gPiArCSAgICBJU19HRU45X0JDKGk5MTUpIHx8IElO
VEVMX0dFTihpOTE1KSA+PSAxMCkgewo+ID4gICAJCXUzMiBkZGNjX3N0YXR1cyA9IDA7Cj4gPiAt
CQlpZiAoc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChkZXZfcHJpdiwKPiA+ICsJCWlmIChzYW5keWJy
aWRnZV9wY29kZV9yZWFkKGk5MTUsCj4gPiAgIAkJCQkJICAgSFNXX1BDT0RFX0RZTkFNSUNfRFVU
WV9DWUNMRV9DT05UUk9MLAo+ID4gICAJCQkJCSAgICZkZGNjX3N0YXR1cywgTlVMTCkgPT0gMCkK
PiA+ICAgCQkJcnBzLT5lZmZpY2llbnRfZnJlcSA9Cj4gPiBAQCAtNzA5OCw3ICs3MDk4LDcgQEAg
c3RhdGljIHZvaWQgZ2VuNl9pbml0X3Jwc19mcmVxdWVuY2llcyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJCQkJcnBzLT5tYXhfZnJlcSk7Cj4gPiAgIAl9Cj4gPiAt
CWlmIChJU19HRU45X0JDKGRldl9wcml2KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSB7
Cj4gPiArCWlmIChJU19HRU45X0JDKGk5MTUpIHx8IElOVEVMX0dFTihpOTE1KSA+PSAxMCkgewo+
ID4gICAJCS8qIFN0b3JlIHRoZSBmcmVxdWVuY3kgdmFsdWVzIGluIDE2LjY2IE1IWiB1bml0cywg
d2hpY2ggaXMKPiA+ICAgCQkgKiB0aGUgbmF0dXJhbCBoYXJkd2FyZSB1bml0IGZvciBTS0wKPiA+
ICAgCQkgKi8KPiA+IEBAIC03MTEwLDQ1ICs3MTEwLDQ1IEBAIHN0YXRpYyB2b2lkIGdlbjZfaW5p
dF9ycHNfZnJlcXVlbmNpZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
ICAJfQo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgcmVzZXRfcnBzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCByZXNldF9ycHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICAgaW50ICgqc2V0KShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqLCB1OCkpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0g
JmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1
LT5ndF9wbS5ycHM7Cj4gPiAgIAl1OCBmcmVxID0gcnBzLT5jdXJfZnJlcTsKPiA+ICAgCS8qIGZv
cmNlIGEgcmVzZXQgKi8KPiA+ICAgCXJwcy0+cG93ZXIubW9kZSA9IC0xOwo+ID4gICAJcnBzLT5j
dXJfZnJlcSA9IC0xOwo+ID4gLQlpZiAoc2V0KGRldl9wcml2LCBmcmVxKSkKPiA+ICsJaWYgKHNl
dChpOTE1LCBmcmVxKSkKPiA+ICAgCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZXNldCBSUFMgdG8g
aW5pdGlhbCB2YWx1ZXNcbiIpOwo+ID4gICB9Cj4gPiAgIC8qIFNlZSB0aGUgR2VuOV9HVF9QTV9Q
cm9ncmFtbWluZ19HdWlkZSBkb2MgZm9yIHRoZSBiZWxvdyAqLwo+ID4gLXN0YXRpYyB2b2lkIGdl
bjlfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3Rh
dGljIHZvaWQgZ2VuOV9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3Jl
LCBGT1JDRVdBS0VfQUxMKTsKPiA+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUt
PnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiAgIAkvKiBQcm9ncmFtIGRlZmF1bHRzIGFuZCB0
aHJlc2hvbGRzIGZvciBSUFMgKi8KPiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgOSkpCj4gPiAr
CWlmIChJU19HRU4oaTkxNSwgOSkpCj4gPiAgIAkJSTkxNV9XUklURShHRU42X1JDX1ZJREVPX0ZS
RVEsCj4gPiAtCQkJR0VOOV9GUkVRVUVOQ1koZGV2X3ByaXYtPmd0X3BtLnJwcy5ycDFfZnJlcSkp
Owo+ID4gKwkJCUdFTjlfRlJFUVVFTkNZKGk5MTUtPmd0X3BtLnJwcy5ycDFfZnJlcSkpOwo+ID4g
ICAJLyogMSBzZWNvbmQgdGltZW91dCovCj4gPiAgIAlJOTE1X1dSSVRFKEdFTjZfUlBfRE9XTl9U
SU1FT1VULAo+ID4gLQkJR1RfSU5URVJWQUxfRlJPTV9VUyhkZXZfcHJpdiwgMTAwMDAwMCkpOwo+
ID4gKwkJR1RfSU5URVJWQUxfRlJPTV9VUyhpOTE1LCAxMDAwMDAwKSk7Cj4gPiAgIAlJOTE1X1dS
SVRFKEdFTjZfUlBfSURMRV9IWVNURVJTSVMsIDB4YSk7Cj4gPiAgIAkvKiBMZWFuaW5nIG9uIHRo
ZSBiZWxvdyBjYWxsIHRvIGdlbjZfc2V0X3JwcyB0byBwcm9ncmFtL3NldHVwIHRoZQo+ID4gICAJ
ICogVXAvRG93biBFSSAmIHRocmVzaG9sZCByZWdpc3RlcnMsIGFzIHdlbGwgYXMgdGhlIFJQX0NP
TlRST0wsCj4gPiAgIAkgKiBSUF9JTlRFUlJVUFRfTElNSVRTICYgUlBOU1dSRVEgcmVnaXN0ZXJz
ICovCj4gPiAtCXJlc2V0X3JwcyhkZXZfcHJpdiwgZ2VuNl9zZXRfcnBzKTsKPiA+ICsJcmVzZXRf
cnBzKGk5MTUsIGdlbjZfc2V0X3Jwcyk7Cj4gPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0
KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICsJaW50ZWxfdW5jb3JlX2Zv
cmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiAgIH0KPiA+IC1z
dGF0aWMgdm9pZCBnZW4xMV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnZW4xMV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmU7Cj4gPiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiA+IEBAIC03MTYwLDcgKzcxNjAs
NyBAQCBzdGF0aWMgdm9pZCBnZW4xMV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPiA+ICAgCSAqIDFiOiBHZXQgZm9yY2V3YWtlIGR1cmluZyBwcm9ncmFtIHNl
cXVlbmNlLiBBbHRob3VnaCB0aGUgZHJpdmVyCj4gPiAgIAkgKiBoYXNuJ3QgZW5hYmxlZCBhIHN0
YXRlIHlldCB3aGVyZSB3ZSBuZWVkIGZvcmNld2FrZSwgQklPUyBtYXkgaGF2ZS4KPiA+ICAgCSAq
Lwo+ID4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9S
Q0VXQUtFX0FMTCk7Cj4gPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNv
cmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gICAJLyogMmE6IERpc2FibGUgUkMgc3RhdGVzLiAqLwo+
ID4gICAJSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsIDApOwo+ID4gQEAgLTcxNzEsMTAgKzcx
NzEsMTAgQEAgc3RhdGljIHZvaWQgZ2VuMTFfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlJOTE1X1dSSVRFKEdFTjZfUkNfRVZBTFVBVElPTl9JTlRF
UlZBTCwgMTI1MDAwKTsgLyogMTI1MDAgKiAxMjgwbnMgKi8KPiA+ICAgCUk5MTVfV1JJVEUoR0VO
Nl9SQ19JRExFX0hZU1RFUlNJUywgMjUpOyAvKiAyNSAqIDEyODBucyAqLwo+ID4gLQlmb3JfZWFj
aF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCj4gPiArCWZvcl9lYWNoX2VuZ2luZShlbmdp
bmUsIGk5MTUsIGlkKQo+ID4gICAJCUk5MTVfV1JJVEUoUklOR19NQVhfSURMRShlbmdpbmUtPm1t
aW9fYmFzZSksIDEwKTsKPiA+IC0JaWYgKEhBU19HVUMoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFT
X0dVQyhpOTE1KSkKPiA+ICAgCQlJOTE1X1dSSVRFKEdVQ19NQVhfSURMRV9DT1VOVCwgMHhBKTsK
PiA+ICAgCUk5MTVfV1JJVEUoR0VONl9SQ19TTEVFUCwgMCk7Cj4gPiBAQCAtNzIxNywxMCArNzIx
NywxMCBAQCBzdGF0aWMgdm9pZCBnZW4xMV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgICBHRU45X01FRElBX1BHX0VOQUJMRSB8Cj4gPiAgIAkJ
ICAgR0VOMTFfTUVESUFfU0FNUExFUl9QR19FTkFCTEUpOwo+ID4gLQlpbnRlbF91bmNvcmVfZm9y
Y2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCWludGVs
X3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4g
ICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuOV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnZW45X2VuYWJsZV9yYzYoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZTsKPiA+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ID4gQEAgLTcyMzEs
MTYgKzcyMzEsMTYgQEAgc3RhdGljIHZvaWQgZ2VuOV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCS8qIDFiOiBHZXQgZm9yY2V3YWtlIGR1cmluZyBw
cm9ncmFtIHNlcXVlbmNlLiBBbHRob3VnaCB0aGUgZHJpdmVyCj4gPiAgIAkgKiBoYXNuJ3QgZW5h
YmxlZCBhIHN0YXRlIHlldCB3aGVyZSB3ZSBuZWVkIGZvcmNld2FrZSwgQklPUyBtYXkgaGF2ZS4q
Lwo+ID4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9S
Q0VXQUtFX0FMTCk7Cj4gPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNv
cmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gICAJLyogMmE6IERpc2FibGUgUkMgc3RhdGVzLiAqLwo+
ID4gICAJSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsIDApOwo+ID4gICAJLyogMmI6IFByb2dy
YW0gUkM2IHRocmVzaG9sZHMuKi8KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAp
IHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMCkgewo+ID4gICAJCUk5MTVfV1JJVEUo
R0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCA1NCA8PCAxNiB8IDg1KTsKPiA+ICAgCQlJOTE1X1dS
SVRFKEdFTjEwX01FRElBX1dBS0VfUkFURV9MSU1JVCwgMTUwKTsKPiA+IC0JfSBlbHNlIGlmIChJ
U19TS1lMQUtFKGRldl9wcml2KSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX1NLWUxBS0UoaTkxNSkp
IHsKPiA+ICAgCQkvKgo+ID4gICAJCSAqIFdhUnNEb3VibGVSYzZXcmxXaXRoQ29hcnNlUG93ZXJH
YXRpbmc6c2tsIERvdWJsaW5nIFdSTCBvbmx5Cj4gPiAgIAkJICogd2hlbiBDUEcgaXMgZW5hYmxl
ZAo+ID4gQEAgLTcyNTIsMTAgKzcyNTIsMTAgQEAgc3RhdGljIHZvaWQgZ2VuOV9lbmFibGVfcmM2
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCUk5MTVfV1JJVEUoR0VO
Nl9SQ19FVkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDApOyAvKiAxMjUwMCAqIDEyODBucyAqLwo+
ID4gICAJSTkxNV9XUklURShHRU42X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7IC8qIDI1ICogMTI4
MG5zICovCj4gPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkKPiA+ICsJ
Zm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCj4gPiAgIAkJSTkxNV9XUklURShSSU5H
X01BWF9JRExFKGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOwo+ID4gLQlpZiAoSEFTX0dVQyhkZXZf
cHJpdikpCj4gPiArCWlmIChIQVNfR1VDKGk5MTUpKQo+ID4gICAJCUk5MTVfV1JJVEUoR1VDX01B
WF9JRExFX0NPVU5ULCAweEEpOwo+ID4gICAJSTkxNV9XUklURShHRU42X1JDX1NMRUVQLCAwKTsK
PiA+IEBAIC03Mjg4LDcgKzcyODgsNyBAQCBzdGF0aWMgdm9pZCBnZW45X2VuYWJsZV9yYzYoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJSTkxNV9XUklURShHRU42X1JD
Nl9USFJFU0hPTEQsIDM3NTAwKTsgLyogMzcuNS8xMjVtcyBwZXIgRUkgKi8KPiA+ICAgCS8qIFdh
UnNVc2VUaW1lb3V0TW9kZTpjbmwgKHByZS1wcm9kKSAqLwo+ID4gLQlpZiAoSVNfQ05MX1JFVklE
KGRldl9wcml2LCBDTkxfUkVWSURfQTAsIENOTF9SRVZJRF9DMCkpCj4gPiArCWlmIChJU19DTkxf
UkVWSUQoaTkxNSwgQ05MX1JFVklEX0EwLCBDTkxfUkVWSURfQzApKQo+ID4gICAJCXJjNl9tb2Rl
ID0gR0VON19SQ19DVExfVE9fTU9ERTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlyYzZfbW9kZSA9IEdF
TjZfUkNfQ1RMX0VJX01PREUoMSk7Cj4gPiBAQCAtNzMwMiwxNiArNzMwMiwxNiBAQCBzdGF0aWMg
dm9pZCBnZW45X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gICAJICogM2I6IEVuYWJsZSBDb2Fyc2UgUG93ZXIgR2F0aW5nIG9ubHkgd2hlbiBSQzYgaXMg
ZW5hYmxlZC4KPiA+ICAgCSAqIFdhUnNEaXNhYmxlQ29hcnNlUG93ZXJHYXRpbmc6c2tsLGNubCAt
IFJlbmRlci9NZWRpYSBQRyBuZWVkIHRvIGJlIGRpc2FibGVkIHdpdGggUkM2Lgo+ID4gICAJICov
Cj4gPiAtCWlmIChORUVEU19XYVJzRGlzYWJsZUNvYXJzZVBvd2VyR2F0aW5nKGRldl9wcml2KSkK
PiA+ICsJaWYgKE5FRURTX1dhUnNEaXNhYmxlQ29hcnNlUG93ZXJHYXRpbmcoaTkxNSkpCj4gPiAg
IAkJSTkxNV9XUklURShHRU45X1BHX0VOQUJMRSwgMCk7Cj4gPiAgIAllbHNlCj4gPiAgIAkJSTkx
NV9XUklURShHRU45X1BHX0VOQUJMRSwKPiA+ICAgCQkJICAgR0VOOV9SRU5ERVJfUEdfRU5BQkxF
IHwgR0VOOV9NRURJQV9QR19FTkFCTEUpOwo+ID4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1
dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCWludGVsX3VuY29yZV9m
b3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gICB9Cj4gPiAt
c3RhdGljIHZvaWQgZ2VuOF9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnZW44X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZTsKPiA+ICAgCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ID4gQEAgLTczMjEsNyArNzMyMSw3
IEBAIHN0YXRpYyB2b2lkIGdlbjhfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiAgIAkvKiAxYjogR2V0IGZvcmNld2FrZSBkdXJpbmcgcHJvZ3JhbSBzZXF1
ZW5jZS4gQWx0aG91Z2ggdGhlIGRyaXZlcgo+ID4gICAJICogaGFzbid0IGVuYWJsZWQgYSBzdGF0
ZSB5ZXQgd2hlcmUgd2UgbmVlZCBmb3JjZXdha2UsIEJJT1MgbWF5IGhhdmUuKi8KPiA+IC0JaW50
ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwp
Owo+ID4gKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdB
S0VfQUxMKTsKPiA+ICAgCS8qIDJhOiBEaXNhYmxlIFJDIHN0YXRlcy4gKi8KPiA+ICAgCUk5MTVf
V1JJVEUoR0VONl9SQ19DT05UUk9MLCAwKTsKPiA+IEBAIC03MzMwLDcgKzczMzAsNyBAQCBzdGF0
aWMgdm9pZCBnZW44X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gICAJSTkxNV9XUklURShHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDQwIDw8IDE2KTsK
PiA+ICAgCUk5MTVfV1JJVEUoR0VONl9SQ19FVkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDApOyAv
KiAxMjUwMCAqIDEyODBucyAqLwo+ID4gICAJSTkxNV9XUklURShHRU42X1JDX0lETEVfSFlTVEVS
U0lTLCAyNSk7IC8qIDI1ICogMTI4MG5zICovCj4gPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUs
IGRldl9wcml2LCBpZCkKPiA+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCj4g
PiAgIAkJSTkxNV9XUklURShSSU5HX01BWF9JRExFKGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOwo+
ID4gICAJSTkxNV9XUklURShHRU42X1JDX1NMRUVQLCAwKTsKPiA+ICAgCUk5MTVfV1JJVEUoR0VO
Nl9SQzZfVEhSRVNIT0xELCA2MjUpOyAvKiA4MDB1cy8xLjI4IGZvciBUTyAqLwo+ID4gQEAgLTcz
NDIsMTQgKzczNDIsMTQgQEAgc3RhdGljIHZvaWQgZ2VuOF9lbmFibGVfcmM2KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgICBHRU43X1JDX0NUTF9UT19NT0RFIHwK
PiA+ICAgCQkgICBHRU42X1JDX0NUTF9SQzZfRU5BQkxFKTsKPiA+IC0JaW50ZWxfdW5jb3JlX2Zv
cmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gKwlpbnRl
bF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+
ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGdlbjhfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgZ2VuOF9lbmFibGVfcnBzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9ycHMgKnJw
cyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAm
aTkxNS0+Z3RfcG0ucnBzOwo+ID4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3By
aXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCWludGVsX3VuY29yZV9mb3JjZXdha2Vf
Z2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gICAJLyogMSBQcm9ncmFtIGRl
ZmF1bHRzIGFuZCB0aHJlc2hvbGRzIGZvciBSUFMqLwo+ID4gICAJSTkxNV9XUklURShHRU42X1JQ
TlNXUkVRLAo+ID4gQEAgLTczODAsMTIgKzczODAsMTIgQEAgc3RhdGljIHZvaWQgZ2VuOF9lbmFi
bGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgICBHRU42
X1JQX1VQX0JVU1lfQVZHIHwKPiA+ICAgCQkgICBHRU42X1JQX0RPV05fSURMRV9BVkcpOwo+ID4g
LQlyZXNldF9ycHMoZGV2X3ByaXYsIGdlbjZfc2V0X3Jwcyk7Cj4gPiArCXJlc2V0X3JwcyhpOTE1
LCBnZW42X3NldF9ycHMpOwo+ID4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3By
aXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCWludGVsX3VuY29yZV9mb3JjZXdha2Vf
cHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZv
aWQgZ2VuNl9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICtzdGF0aWMgdm9pZCBnZW42X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiA+ICAg
CWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ID4gQEAgLTc0MDIsNyArNzQwMiw3IEBAIHN0YXRp
YyB2b2lkIGdlbjZfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAgIAkJSTkxNV9XUklURShHVEZJRk9EQkcsIGd0Zmlmb2RiZyk7Cj4gPiAgIAl9Cj4gPiAt
CWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0Vf
QUxMKTsKPiA+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUtPnVuY29yZSwgRk9S
Q0VXQUtFX0FMTCk7Cj4gPiAgIAkvKiBkaXNhYmxlIHRoZSBjb3VudGVycyBhbmQgc2V0IGRldGVy
bWluaXN0aWMgdGhyZXNob2xkcyAqLwo+ID4gICAJSTkxNV9XUklURShHRU42X1JDX0NPTlRST0ws
IDApOwo+ID4gQEAgLTc0MTMsMTIgKzc0MTMsMTIgQEAgc3RhdGljIHZvaWQgZ2VuNl9lbmFibGVf
cmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCUk5MTVfV1JJVEUo
R0VONl9SQ19FVkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDApOwo+ID4gICAJSTkxNV9XUklURShH
RU42X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7Cj4gPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUs
IGRldl9wcml2LCBpZCkKPiA+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCj4g
PiAgIAkJSTkxNV9XUklURShSSU5HX01BWF9JRExFKGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOwo+
ID4gICAJSTkxNV9XUklURShHRU42X1JDX1NMRUVQLCAwKTsKPiA+ICAgCUk5MTVfV1JJVEUoR0VO
Nl9SQzFlX1RIUkVTSE9MRCwgMTAwMCk7Cj4gPiAtCWlmIChJU19JVllCUklER0UoZGV2X3ByaXYp
KQo+ID4gKwlpZiAoSVNfSVZZQlJJREdFKGk5MTUpKQo+ID4gICAJCUk5MTVfV1JJVEUoR0VONl9S
QzZfVEhSRVNIT0xELCAxMjUwMDApOwo+ID4gICAJZWxzZQo+ID4gICAJCUk5MTVfV1JJVEUoR0VO
Nl9SQzZfVEhSRVNIT0xELCA1MDAwMCk7Cj4gPiBAQCAtNzQyNyw5ICs3NDI3LDkgQEAgc3RhdGlj
IHZvaWQgZ2VuNl9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICAgCS8qIFdlIGRvbid0IHVzZSB0aG9zZSBvbiBIYXN3ZWxsICovCj4gPiAgIAlyYzZfbWFz
ayA9IEdFTjZfUkNfQ1RMX1JDNl9FTkFCTEU7Cj4gPiAtCWlmIChIQVNfUkM2cChkZXZfcHJpdikp
Cj4gPiArCWlmIChIQVNfUkM2cChpOTE1KSkKPiA+ICAgCQlyYzZfbWFzayB8PSBHRU42X1JDX0NU
TF9SQzZwX0VOQUJMRTsKPiA+IC0JaWYgKEhBU19SQzZwcChkZXZfcHJpdikpCj4gPiArCWlmIChI
QVNfUkM2cHAoaTkxNSkpCj4gPiAgIAkJcmM2X21hc2sgfD0gR0VONl9SQ19DVExfUkM2cHBfRU5B
QkxFOwo+ID4gICAJSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsCj4gPiAgIAkJICAgcmM2X21h
c2sgfAo+ID4gQEAgLTc0MzcsMjQgKzc0MzcsMjQgQEAgc3RhdGljIHZvaWQgZ2VuNl9lbmFibGVf
cmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgICBHRU42X1JD
X0NUTF9IV19FTkFCTEUpOwo+ID4gICAJcmM2dmlkcyA9IDA7Cj4gPiAtCXJldCA9IHNhbmR5YnJp
ZGdlX3Bjb2RlX3JlYWQoZGV2X3ByaXYsIEdFTjZfUENPREVfUkVBRF9SQzZWSURTLAo+ID4gKwly
ZXQgPSBzYW5keWJyaWRnZV9wY29kZV9yZWFkKGk5MTUsIEdFTjZfUENPREVfUkVBRF9SQzZWSURT
LAo+ID4gICAJCQkJICAgICAmcmM2dmlkcywgTlVMTCk7Cj4gPiAtCWlmIChJU19HRU4oZGV2X3By
aXYsIDYpICYmIHJldCkgewo+ID4gKwlpZiAoSVNfR0VOKGk5MTUsIDYpICYmIHJldCkgewo+ID4g
ICAJCURSTV9ERUJVR19EUklWRVIoIkNvdWxkbid0IGNoZWNrIGZvciBCSU9TIHdvcmthcm91bmRc
biIpOwo+ID4gLQl9IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgNikgJiYgKEdFTjZfREVDT0RF
X1JDNl9WSUQocmM2dmlkcyAmIDB4ZmYpIDwgNDUwKSkgewo+ID4gKwl9IGVsc2UgaWYgKElTX0dF
TihpOTE1LCA2KSAmJiAoR0VONl9ERUNPREVfUkM2X1ZJRChyYzZ2aWRzICYgMHhmZikgPCA0NTAp
KSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0RSSVZFUigiWW91IHNob3VsZCB1cGRhdGUgeW91ciBCSU9T
LiBDb3JyZWN0aW5nIG1pbmltdW0gcmM2IHZvbHRhZ2UgKCVkbVYtPiVkbVYpXG4iLAo+ID4gICAJ
CQkgIEdFTjZfREVDT0RFX1JDNl9WSUQocmM2dmlkcyAmIDB4ZmYpLCA0NTApOwo+ID4gICAJCXJj
NnZpZHMgJj0gMHhmZmZmMDA7Cj4gPiAgIAkJcmM2dmlkcyB8PSBHRU42X0VOQ09ERV9SQzZfVklE
KDQ1MCk7Cj4gPiAtCQlyZXQgPSBzYW5keWJyaWRnZV9wY29kZV93cml0ZShkZXZfcHJpdiwgR0VO
Nl9QQ09ERV9XUklURV9SQzZWSURTLCByYzZ2aWRzKTsKPiA+ICsJCXJldCA9IHNhbmR5YnJpZGdl
X3Bjb2RlX3dyaXRlKGk5MTUsIEdFTjZfUENPREVfV1JJVEVfUkM2VklEUywgcmM2dmlkcyk7Cj4g
PiAgIAkJaWYgKHJldCkKPiA+ICAgCQkJRFJNX0VSUk9SKCJDb3VsZG4ndCBmaXggaW5jb3JyZWN0
IHJjNiB2b2x0YWdlXG4iKTsKPiA+ICAgCX0KPiA+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9w
dXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gKwlpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICAgfQo+ID4g
LXN0YXRpYyB2b2lkIGdlbjZfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgZ2VuNl9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAkvKiBIZXJlIGJlZ2lucyBhIG1hZ2ljIHNlcXVl
bmNlIG9mIHJlZ2lzdGVyIHdyaXRlcyB0byBlbmFibGUKPiA+ICAgCSAqIGF1dG8tZG93bmNsb2Nr
aW5nLgo+ID4gQEAgLTc0NjIsMjAgKzc0NjIsMjAgQEAgc3RhdGljIHZvaWQgZ2VuNl9lbmFibGVf
cnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIFBlcmhhcHMg
dGhlcmUgbWlnaHQgYmUgc29tZSB2YWx1ZSBpbiBleHBvc2luZyB0aGVzZSB0bwo+ID4gICAJICog
dXNlcnNwYWNlLi4uCj4gPiAgIAkgKi8KPiA+IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQo
JmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gKwlpbnRlbF91bmNvcmVfZm9y
Y2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICAgCS8qIFBvd2Vy
IGRvd24gaWYgY29tcGxldGVseSBpZGxlIGZvciBvdmVyIDUwbXMgKi8KPiA+ICAgCUk5MTVfV1JJ
VEUoR0VONl9SUF9ET1dOX1RJTUVPVVQsIDUwMDAwKTsKPiA+ICAgCUk5MTVfV1JJVEUoR0VONl9S
UF9JRExFX0hZU1RFUlNJUywgMTApOwo+ID4gLQlyZXNldF9ycHMoZGV2X3ByaXYsIGdlbjZfc2V0
X3Jwcyk7Cj4gPiArCXJlc2V0X3JwcyhpOTE1LCBnZW42X3NldF9ycHMpOwo+ID4gLQlpbnRlbF91
bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4g
PiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuNl91cGRhdGVfcmluZ19mcmVxKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnZW42X3VwZGF0
ZV9yaW5nX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gPiArCXN0cnVj
dCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gPiAgIAljb25zdCBpbnQgbWlu
X2ZyZXEgPSAxNTsKPiA+ICAgCWNvbnN0IGludCBzY2FsaW5nX2ZhY3RvciA9IDE4MDsKPiA+ICAg
CXVuc2lnbmVkIGludCBncHVfZnJlcTsKPiA+IEBAIC03NTA5LDcgKzc1MDksNyBAQCBzdGF0aWMg
dm9pZCBnZW42X3VwZGF0ZV9yaW5nX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gICAJbWluX2dwdV9mcmVxID0gcnBzLT5taW5fZnJlcTsKPiA+ICAgCW1heF9ncHVf
ZnJlcSA9IHJwcy0+bWF4X2ZyZXE7Cj4gPiAtCWlmIChJU19HRU45X0JDKGRldl9wcml2KSB8fCBJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSB7Cj4gPiArCWlmIChJU19HRU45X0JDKGk5MTUpIHx8
IElOVEVMX0dFTihpOTE1KSA+PSAxMCkgewo+ID4gICAJCS8qIENvbnZlcnQgR1QgZnJlcXVlbmN5
IHRvIDUwIEhaIHVuaXRzICovCj4gPiAgIAkJbWluX2dwdV9mcmVxIC89IEdFTjlfRlJFUV9TQ0FM
RVI7Cj4gPiAgIAkJbWF4X2dwdV9mcmVxIC89IEdFTjlfRlJFUV9TQ0FMRVI7Cj4gPiBAQCAtNzUy
NCwxNiArNzUyNCwxNiBAQCBzdGF0aWMgdm9pZCBnZW42X3VwZGF0ZV9yaW5nX2ZyZXEoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCWNvbnN0IGludCBkaWZmID0gbWF4
X2dwdV9mcmVxIC0gZ3B1X2ZyZXE7Cj4gPiAgIAkJdW5zaWduZWQgaW50IGlhX2ZyZXEgPSAwLCBy
aW5nX2ZyZXEgPSAwOwo+ID4gLQkJaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8IElOVEVMX0dF
TihkZXZfcHJpdikgPj0gMTApIHsKPiA+ICsJCWlmIChJU19HRU45X0JDKGk5MTUpIHx8IElOVEVM
X0dFTihpOTE1KSA+PSAxMCkgewo+ID4gICAJCQkvKgo+ID4gICAJCQkgKiByaW5nX2ZyZXEgPSAy
ICogR1QuIHJpbmdfZnJlcSBpcyBpbiAxMDBNSHogdW5pdHMKPiA+ICAgCQkJICogTm8gZmxvb3Ig
cmVxdWlyZWQgZm9yIHJpbmcgZnJlcXVlbmN5IG9uIFNLTC4KPiA+ICAgCQkJICovCj4gPiAgIAkJ
CXJpbmdfZnJlcSA9IGdwdV9mcmVxOwo+ID4gLQkJfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDgpIHsKPiA+ICsJCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpIHsKPiA+
ICAgCQkJLyogbWF4KDIgKiBHVCwgRERSKS4gTkI6IEdUIGlzIDUwTUh6IHVuaXRzICovCj4gPiAg
IAkJCXJpbmdfZnJlcSA9IG1heChtaW5fcmluZ19mcmVxLCBncHVfZnJlcSk7Cj4gPiAtCQl9IGVs
c2UgaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKSB7Cj4gPiArCQl9IGVsc2UgaWYgKElTX0hBU1dF
TEwoaTkxNSkpIHsKPiA+ICAgCQkJcmluZ19mcmVxID0gbXVsdF9mcmFjKGdwdV9mcmVxLCA1LCA0
KTsKPiA+ICAgCQkJcmluZ19mcmVxID0gbWF4KG1pbl9yaW5nX2ZyZXEsIHJpbmdfZnJlcSk7Cj4g
PiAgIAkJCS8qIGxlYXZlIGlhX2ZyZXEgYXMgdGhlIGRlZmF1bHQsIGNob3NlbiBieSBjcHVmcmVx
ICovCj4gPiBAQCAtNzU1Miw3ICs3NTUyLDcgQEAgc3RhdGljIHZvaWQgZ2VuNl91cGRhdGVfcmlu
Z19mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkJaWFfZnJl
cSA9IERJVl9ST1VORF9DTE9TRVNUKGlhX2ZyZXEsIDEwMCk7Cj4gPiAgIAkJfQo+ID4gLQkJc2Fu
ZHlicmlkZ2VfcGNvZGVfd3JpdGUoZGV2X3ByaXYsCj4gPiArCQlzYW5keWJyaWRnZV9wY29kZV93
cml0ZShpOTE1LAo+ID4gICAJCQkJCUdFTjZfUENPREVfV1JJVEVfTUlOX0ZSRVFfVEFCTEUsCj4g
PiAgIAkJCQkJaWFfZnJlcSA8PCBHRU42X1BDT0RFX0ZSRVFfSUFfUkFUSU9fU0hJRlQgfAo+ID4g
ICAJCQkJCXJpbmdfZnJlcSA8PCBHRU42X1BDT0RFX0ZSRVFfUklOR19SQVRJT19TSElGVCB8Cj4g
PiBAQCAtNzU2MCwxMyArNzU2MCwxMyBAQCBzdGF0aWMgdm9pZCBnZW42X3VwZGF0ZV9yaW5nX2Zy
ZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJfQo+ID4gICB9Cj4g
PiAtc3RhdGljIGludCBjaGVycnl2aWV3X3Jwc19tYXhfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGludCBjaGVycnl2aWV3X3Jwc19tYXhfZnJlcShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIHZhbCwgcnAw
Owo+ID4gLQl2YWwgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgRkJfR0ZYX0ZNQVhfQVRfVk1B
WF9GVVNFKTsKPiA+ICsJdmFsID0gdmx2X3B1bml0X3JlYWQoaTkxNSwgRkJfR0ZYX0ZNQVhfQVRf
Vk1BWF9GVVNFKTsKPiA+IC0Jc3dpdGNoIChSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1LmV1
X3RvdGFsKSB7Cj4gPiArCXN3aXRjaCAoUlVOVElNRV9JTkZPKGk5MTUpLT5zc2V1LmV1X3RvdGFs
KSB7Cj4gPiAgIAljYXNlIDg6Cj4gPiAgIAkJLyogKDIgKiA0KSBjb25maWcgKi8KPiA+ICAgCQly
cDAgPSAodmFsID4+IEZCX0dGWF9GTUFYX0FUX1ZNQVhfMlNTNEVVX0ZVU0VfU0hJRlQpOwo+ID4g
QEAgLTc1ODgsNTMgKzc1ODgsNTMgQEAgc3RhdGljIGludCBjaGVycnl2aWV3X3Jwc19tYXhfZnJl
cShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlyZXR1cm4gcnAwOwo+
ID4gICB9Cj4gPiAtc3RhdGljIGludCBjaGVycnl2aWV3X3Jwc19ycGVfZnJlcShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGludCBjaGVycnl2aWV3X3Jwc19y
cGVfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMy
IHZhbCwgcnBlOwo+ID4gLQl2YWwgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfR1BV
X0RVVFlDWUNMRV9SRUcpOwo+ID4gKwl2YWwgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9H
UFVfRFVUWUNZQ0xFX1JFRyk7Cj4gPiAgIAlycGUgPSAodmFsID4+IFBVTklUX0dQVV9EVVRZQ1lD
TEVfUlBFX0ZSRVFfU0hJRlQpICYgUFVOSVRfR1BVX0RVVFlDWUNMRV9SUEVfRlJFUV9NQVNLOwo+
ID4gICAJcmV0dXJuIHJwZTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQgY2hlcnJ5dmlld19ycHNf
Z3Vhcl9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMg
aW50IGNoZXJyeXZpZXdfcnBzX2d1YXJfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKPiA+ICAgewo+ID4gICAJdTMyIHZhbCwgcnAxOwo+ID4gLQl2YWwgPSB2bHZfcHVuaXRfcmVh
ZChkZXZfcHJpdiwgRkJfR0ZYX0ZNQVhfQVRfVk1BWF9GVVNFKTsKPiA+ICsJdmFsID0gdmx2X3B1
bml0X3JlYWQoaTkxNSwgRkJfR0ZYX0ZNQVhfQVRfVk1BWF9GVVNFKTsKPiA+ICAgCXJwMSA9ICh2
YWwgJiBGQl9HRlhfRlJFUV9GVVNFX01BU0spOwo+ID4gICAJcmV0dXJuIHJwMTsKPiA+ICAgfQo+
ID4gLXN0YXRpYyB1MzIgY2hlcnJ5dmlld19ycHNfbWluX2ZyZXEoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB1MzIgY2hlcnJ5dmlld19ycHNfbWluX2ZyZXEo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWwsIHJw
bjsKPiA+IC0JdmFsID0gdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIEZCX0dGWF9GTUlOX0FUX1ZN
SU5fRlVTRSk7Cj4gPiArCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIEZCX0dGWF9GTUlOX0FU
X1ZNSU5fRlVTRSk7Cj4gPiAgIAlycG4gPSAoKHZhbCA+PiBGQl9HRlhfRk1JTl9BVF9WTUlOX0ZV
U0VfU0hJRlQpICYKPiA+ICAgCQkgICAgICAgRkJfR0ZYX0ZSRVFfRlVTRV9NQVNLKTsKPiA+ICAg
CXJldHVybiBycG47Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW50IHZhbGxleXZpZXdfcnBzX2d1YXJf
ZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGludCB2
YWxsZXl2aWV3X3Jwc19ndWFyX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+ICAgCXUzMiB2YWwsIHJwMTsKPiA+IC0JdmFsID0gdmx2X25jX3JlYWQoZGV2X3By
aXYsIElPU0ZfTkNfRkJfR0ZYX0ZSRVFfRlVTRSk7Cj4gPiArCXZhbCA9IHZsdl9uY19yZWFkKGk5
MTUsIElPU0ZfTkNfRkJfR0ZYX0ZSRVFfRlVTRSk7Cj4gPiAgIAlycDEgPSAodmFsICYgRkJfR0ZY
X0ZHVUFSQU5URUVEX0ZSRVFfRlVTRV9NQVNLKSA+PiBGQl9HRlhfRkdVQVJBTlRFRURfRlJFUV9G
VVNFX1NISUZUOwo+ID4gICAJcmV0dXJuIHJwMTsKPiA+ICAgfQo+ID4gLXN0YXRpYyBpbnQgdmFs
bGV5dmlld19ycHNfbWF4X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gK3N0YXRpYyBpbnQgdmFsbGV5dmlld19ycHNfbWF4X2ZyZXEoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWwsIHJwMDsKPiA+IC0JdmFsID0gdmx2
X25jX3JlYWQoZGV2X3ByaXYsIElPU0ZfTkNfRkJfR0ZYX0ZSRVFfRlVTRSk7Cj4gPiArCXZhbCA9
IHZsdl9uY19yZWFkKGk5MTUsIElPU0ZfTkNfRkJfR0ZYX0ZSRVFfRlVTRSk7Cj4gPiAgIAlycDAg
PSAodmFsICYgRkJfR0ZYX01BWF9GUkVRX0ZVU0VfTUFTSykgPj4gRkJfR0ZYX01BWF9GUkVRX0ZV
U0VfU0hJRlQ7Cj4gPiAgIAkvKiBDbGFtcCB0byBtYXggKi8KPiA+IEBAIC03NjQzLDIzICs3NjQz
LDIzIEBAIHN0YXRpYyBpbnQgdmFsbGV5dmlld19ycHNfbWF4X2ZyZXEoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJcmV0dXJuIHJwMDsKPiA+ICAgfQo+ID4gLXN0YXRp
YyBpbnQgdmFsbGV5dmlld19ycHNfcnBlX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gK3N0YXRpYyBpbnQgdmFsbGV5dmlld19ycHNfcnBlX2ZyZXEoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWwsIHJwZTsKPiA+IC0J
dmFsID0gdmx2X25jX3JlYWQoZGV2X3ByaXYsIElPU0ZfTkNfRkJfR0ZYX0ZNQVhfRlVTRV9MTyk7
Cj4gPiArCXZhbCA9IHZsdl9uY19yZWFkKGk5MTUsIElPU0ZfTkNfRkJfR0ZYX0ZNQVhfRlVTRV9M
Tyk7Cj4gPiAgIAlycGUgPSAodmFsICYgRkJfRk1BWF9WTUlOX0ZSRVFfTE9fTUFTSykgPj4gRkJf
Rk1BWF9WTUlOX0ZSRVFfTE9fU0hJRlQ7Cj4gPiAtCXZhbCA9IHZsdl9uY19yZWFkKGRldl9wcml2
LCBJT1NGX05DX0ZCX0dGWF9GTUFYX0ZVU0VfSEkpOwo+ID4gKwl2YWwgPSB2bHZfbmNfcmVhZChp
OTE1LCBJT1NGX05DX0ZCX0dGWF9GTUFYX0ZVU0VfSEkpOwo+ID4gICAJcnBlIHw9ICh2YWwgJiBG
Ql9GTUFYX1ZNSU5fRlJFUV9ISV9NQVNLKSA8PCA1Owo+ID4gICAJcmV0dXJuIHJwZTsKPiA+ICAg
fQo+ID4gLXN0YXRpYyBpbnQgdmFsbGV5dmlld19ycHNfbWluX2ZyZXEoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyBpbnQgdmFsbGV5dmlld19ycHNfbWluX2Zy
ZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7
Cj4gPiAtCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfR1BVX0xGTSkg
JiAweGZmOwo+ID4gKwl2YWwgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfR1BVX0xG
TSkgJiAweGZmOwo+ID4gICAJLyoKPiA+ICAgCSAqIEFjY29yZGluZyB0byB0aGUgQllUIFB1bml0
IEdQVSB0dXJibyBIQVMgMS4xLjYuMyB0aGUgbWluaW11bSB2YWx1ZQo+ID4gICAJICogZm9yIHRo
ZSBtaW5pbXVtIGZyZXF1ZW5jeSBpbiBHUExMIG1vZGUgaXMgMHhjMS4gQ29udHJhcnkgdG8gdGhp
cyBvbgo+ID4gQEAgLTc2NzEsMjQgKzc2NzEsMjQgQEAgc3RhdGljIGludCB2YWxsZXl2aWV3X3Jw
c19taW5fZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIH0KPiA+
ICAgLyogQ2hlY2sgdGhhdCB0aGUgcGN0eCBidWZmZXIgd2Fzbid0IG1vdmUgdW5kZXIgdXMuICov
Cj4gPiAtc3RhdGljIHZvaWQgdmFsbGV5dmlld19jaGVja19wY3R4KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2NoZWNrX3BjdHgo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXVuc2lnbmVkIGxv
bmcgcGN0eF9hZGRyID0gSTkxNV9SRUFEKFZMVl9QQ0JSKSAmIH40MDk1Owo+ID4gLQlXQVJOX09O
KHBjdHhfYWRkciAhPSBkZXZfcHJpdi0+ZHNtLnN0YXJ0ICsKPiA+IC0JCQkgICAgIGRldl9wcml2
LT52bHZfcGN0eC0+c3RvbGVuLT5zdGFydCk7Cj4gPiArCVdBUk5fT04ocGN0eF9hZGRyICE9IGk5
MTUtPmRzbS5zdGFydCArCj4gPiArCQkJICAgICBpOTE1LT52bHZfcGN0eC0+c3RvbGVuLT5zdGFy
dCk7Cj4gPiAgIH0KPiA+ICAgLyogQ2hlY2sgdGhhdCB0aGUgcGNiciBhZGRyZXNzIGlzIG5vdCBl
bXB0eS4gKi8KPiA+IC1zdGF0aWMgdm9pZCBjaGVycnl2aWV3X2NoZWNrX3BjdHgoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGNoZXJyeXZpZXdfY2hl
Y2tfcGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdW5z
aWduZWQgbG9uZyBwY3R4X2FkZHIgPSBJOTE1X1JFQUQoVkxWX1BDQlIpICYgfjQwOTU7Cj4gPiAg
IAlXQVJOX09OKChwY3R4X2FkZHIgPj4gVkxWX1BDQlJfQUREUl9TSElGVCkgPT0gMCk7Cj4gPiAg
IH0KPiA+IC1zdGF0aWMgdm9pZCBjaGVycnl2aWV3X3NldHVwX3BjdHgoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGNoZXJyeXZpZXdfc2V0dXBfcGN0
eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJcmVzb3VyY2Vf
c2l6ZV90IHBjdHhfcGFkZHIsIHBhZGRyOwo+ID4gICAJcmVzb3VyY2Vfc2l6ZV90IHBjdHhfc2l6
ZSA9IDMyKjEwMjQ7Cj4gPiBAQCAtNzY5Nyw3ICs3Njk3LDcgQEAgc3RhdGljIHZvaWQgY2hlcnJ5
dmlld19zZXR1cF9wY3R4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAg
CXBjYnIgPSBJOTE1X1JFQUQoVkxWX1BDQlIpOwo+ID4gICAJaWYgKChwY2JyID4+IFZMVl9QQ0JS
X0FERFJfU0hJRlQpID09IDApIHsKPiA+ICAgCQlEUk1fREVCVUdfRFJJVkVSKCJCSU9TIGRpZG4n
dCBzZXQgdXAgUENCUiwgZml4aW5nIHVwXG4iKTsKPiA+IC0JCXBhZGRyID0gZGV2X3ByaXYtPmRz
bS5lbmQgKyAxIC0gcGN0eF9zaXplOwo+ID4gKwkJcGFkZHIgPSBpOTE1LT5kc20uZW5kICsgMSAt
IHBjdHhfc2l6ZTsKPiA+ICAgCQlHRU1fQlVHX09OKHBhZGRyID4gVTMyX01BWCk7Cj4gPiAgIAkJ
cGN0eF9wYWRkciA9IChwYWRkciAmICh+NDA5NSkpOwo+ID4gQEAgLTc3MDcsNyArNzcwNyw3IEBA
IHN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfc2V0dXBfcGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJQQ0JSOiAweCUwOHhcbiIsIEk5
MTVfUkVBRChWTFZfUENCUikpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgdmFsbGV5dmlld19z
ZXR1cF9wY3R4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMg
dm9pZCB2YWxsZXl2aWV3X3NldHVwX3BjdHgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpwY3R4Owo+ID4gICAJ
cmVzb3VyY2Vfc2l6ZV90IHBjdHhfcGFkZHI7Cj4gPiBAQCAtNzcxOSw4ICs3NzE5LDggQEAgc3Rh
dGljIHZvaWQgdmFsbGV5dmlld19zZXR1cF9wY3R4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKPiA+ICAgCQkvKiBCSU9TIHNldCBpdCB1cCBhbHJlYWR5LCBncmFiIHRoZSBwcmUt
YWxsb2MnZCBzcGFjZSAqLwo+ID4gICAJCXJlc291cmNlX3NpemVfdCBwY2JyX29mZnNldDsKPiA+
IC0JCXBjYnJfb2Zmc2V0ID0gKHBjYnIgJiAofjQwOTUpKSAtIGRldl9wcml2LT5kc20uc3RhcnQ7
Cj4gPiAtCQlwY3R4ID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW5fZm9yX3ByZWFsbG9j
YXRlZChkZXZfcHJpdiwKPiA+ICsJCXBjYnJfb2Zmc2V0ID0gKHBjYnIgJiAofjQwOTUpKSAtIGk5
MTUtPmRzbS5zdGFydDsKPiA+ICsJCXBjdHggPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xl
bl9mb3JfcHJlYWxsb2NhdGVkKGk5MTUsCj4gPiAgIAkJCQkJCQkJICAgICAgcGNicl9vZmZzZXQs
Cj4gPiAgIAkJCQkJCQkJICAgICAgSTkxNV9HVFRfT0ZGU0VUX05PTkUsCj4gPiAgIAkJCQkJCQkJ
ICAgICAgcGN0eF9zaXplKTsKPiA+IEBAIC03NzM3LDE0OCArNzczNywxNDggQEAgc3RhdGljIHZv
aWQgdmFsbGV5dmlld19zZXR1cF9wY3R4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICAgCSAqIG92ZXJsYXAgd2l0aCBvdGhlciByYW5nZXMsIHN1Y2ggYXMgdGhlIGZyYW1l
IGJ1ZmZlciwgcHJvdGVjdGVkCj4gPiAgIAkgKiBtZW1vcnksIG9yIGFueSBvdGhlciByZWxldmFu
dCByYW5nZXMuCj4gPiAgIAkgKi8KPiA+IC0JcGN0eCA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVf
c3RvbGVuKGRldl9wcml2LCBwY3R4X3NpemUpOwo+ID4gKwlwY3R4ID0gaTkxNV9nZW1fb2JqZWN0
X2NyZWF0ZV9zdG9sZW4oaTkxNSwgcGN0eF9zaXplKTsKPiA+ICAgCWlmICghcGN0eCkgewo+ID4g
ICAJCURSTV9ERUJVRygibm90IGVub3VnaCBzdG9sZW4gc3BhY2UgZm9yIFBDVFgsIGRpc2FibGlu
Z1xuIik7Cj4gPiAgIAkJZ290byBvdXQ7Cj4gPiAgIAl9Cj4gPiAgIAlHRU1fQlVHX09OKHJhbmdl
X292ZXJmbG93c190KHU2NCwKPiA+IC0JCQkJICAgICBkZXZfcHJpdi0+ZHNtLnN0YXJ0LAo+ID4g
KwkJCQkgICAgIGk5MTUtPmRzbS5zdGFydCwKPiA+ICAgCQkJCSAgICAgcGN0eC0+c3RvbGVuLT5z
dGFydCwKPiA+ICAgCQkJCSAgICAgVTMyX01BWCkpOwo+ID4gLQlwY3R4X3BhZGRyID0gZGV2X3By
aXYtPmRzbS5zdGFydCArIHBjdHgtPnN0b2xlbi0+c3RhcnQ7Cj4gPiArCXBjdHhfcGFkZHIgPSBp
OTE1LT5kc20uc3RhcnQgKyBwY3R4LT5zdG9sZW4tPnN0YXJ0Owo+ID4gICAJSTkxNV9XUklURShW
TFZfUENCUiwgcGN0eF9wYWRkcik7Cj4gPiAgIG91dDoKPiA+ICAgCURSTV9ERUJVR19EUklWRVIo
IlBDQlI6IDB4JTA4eFxuIiwgSTkxNV9SRUFEKFZMVl9QQ0JSKSk7Cj4gPiAtCWRldl9wcml2LT52
bHZfcGN0eCA9IHBjdHg7Cj4gPiArCWk5MTUtPnZsdl9wY3R4ID0gcGN0eDsKPiA+ICAgfQo+ID4g
LXN0YXRpYyB2b2lkIHZhbGxleXZpZXdfY2xlYW51cF9wY3R4KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2NsZWFudXBfcGN0eChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKnBjdHg7Cj4gPiAtCXBjdHggPSBmZXRjaF9hbmRfemVybygmZGV2X3By
aXYtPnZsdl9wY3R4KTsKPiA+ICsJcGN0eCA9IGZldGNoX2FuZF96ZXJvKCZpOTE1LT52bHZfcGN0
eCk7Cj4gPiAgIAlpZiAocGN0eCkKPiA+ICAgCQlpOTE1X2dlbV9vYmplY3RfcHV0KHBjdHgpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgdmx2X2luaXRfZ3BsbF9yZWZfZnJlcShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgdmx2X2luaXRfZ3BsbF9y
ZWZfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlkZXZf
cHJpdi0+Z3RfcG0ucnBzLmdwbGxfcmVmX2ZyZXEgPQo+ID4gLQkJdmx2X2dldF9jY2tfY2xvY2so
ZGV2X3ByaXYsICJHUExMIHJlZiIsCj4gPiArCWk5MTUtPmd0X3BtLnJwcy5ncGxsX3JlZl9mcmVx
ID0KPiA+ICsJCXZsdl9nZXRfY2NrX2Nsb2NrKGk5MTUsICJHUExMIHJlZiIsCj4gPiAgIAkJCQkg
IENDS19HUExMX0NMT0NLX0NPTlRST0wsCj4gPiAtCQkJCSAgZGV2X3ByaXYtPmN6Y2xrX2ZyZXEp
Owo+ID4gKwkJCQkgIGk5MTUtPmN6Y2xrX2ZyZXEpOwo+ID4gICAJRFJNX0RFQlVHX0RSSVZFUigi
R1BMTCByZWZlcmVuY2UgZnJlcTogJWQga0h6XG4iLAo+ID4gLQkJCSBkZXZfcHJpdi0+Z3RfcG0u
cnBzLmdwbGxfcmVmX2ZyZXEpOwo+ID4gKwkJCSBpOTE1LT5ndF9wbS5ycHMuZ3BsbF9yZWZfZnJl
cSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2luaXRfZ3RfcG93ZXJzYXZl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCB2YWxs
ZXl2aWV3X2luaXRfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBz
Owo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ID4gICAJ
dTMyIHZhbDsKPiA+IC0JdmFsbGV5dmlld19zZXR1cF9wY3R4KGRldl9wcml2KTsKPiA+ICsJdmFs
bGV5dmlld19zZXR1cF9wY3R4KGk5MTUpOwo+ID4gLQl2bHZfaW9zZl9zYl9nZXQoZGV2X3ByaXYs
Cj4gPiArCXZsdl9pb3NmX3NiX2dldChpOTE1LAo+ID4gICAJCQlCSVQoVkxWX0lPU0ZfU0JfUFVO
SVQpIHwKPiA+ICAgCQkJQklUKFZMVl9JT1NGX1NCX05DKSB8Cj4gPiAgIAkJCUJJVChWTFZfSU9T
Rl9TQl9DQ0spKTsKPiA+IC0Jdmx2X2luaXRfZ3BsbF9yZWZfZnJlcShkZXZfcHJpdik7Cj4gPiAr
CXZsdl9pbml0X2dwbGxfcmVmX2ZyZXEoaTkxNSk7Cj4gPiAtCXZhbCA9IHZsdl9wdW5pdF9yZWFk
KGRldl9wcml2LCBQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTKTsKPiA+ICsJdmFsID0gdmx2X3B1bml0
X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0dQVV9GUkVRX1NUUyk7Cj4gPiAgIAlzd2l0Y2ggKCh2YWwg
Pj4gNikgJiAzKSB7Cj4gPiAgIAljYXNlIDA6Cj4gPiAgIAljYXNlIDE6Cj4gPiAtCQlkZXZfcHJp
di0+bWVtX2ZyZXEgPSA4MDA7Cj4gPiArCQlpOTE1LT5tZW1fZnJlcSA9IDgwMDsKPiA+ICAgCQli
cmVhazsKPiA+ICAgCWNhc2UgMjoKPiA+IC0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDEwNjY7Cj4g
PiArCQlpOTE1LT5tZW1fZnJlcSA9IDEwNjY7Cj4gPiAgIAkJYnJlYWs7Cj4gPiAgIAljYXNlIDM6
Cj4gPiAtCQlkZXZfcHJpdi0+bWVtX2ZyZXEgPSAxMzMzOwo+ID4gKwkJaTkxNS0+bWVtX2ZyZXEg
PSAxMzMzOwo+ID4gICAJCWJyZWFrOwo+ID4gICAJfQo+ID4gLQlEUk1fREVCVUdfRFJJVkVSKCJE
RFIgc3BlZWQ6ICVkIE1IelxuIiwgZGV2X3ByaXYtPm1lbV9mcmVxKTsKPiA+ICsJRFJNX0RFQlVH
X0RSSVZFUigiRERSIHNwZWVkOiAlZCBNSHpcbiIsIGk5MTUtPm1lbV9mcmVxKTsKPiA+IC0JcnBz
LT5tYXhfZnJlcSA9IHZhbGxleXZpZXdfcnBzX21heF9mcmVxKGRldl9wcml2KTsKPiA+ICsJcnBz
LT5tYXhfZnJlcSA9IHZhbGxleXZpZXdfcnBzX21heF9mcmVxKGk5MTUpOwo+ID4gICAJcnBzLT5y
cDBfZnJlcSA9IHJwcy0+bWF4X2ZyZXE7Cj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJtYXggR1BV
IGZyZXE6ICVkIE1IeiAoJXUpXG4iLAo+ID4gLQkJCSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwg
cnBzLT5tYXhfZnJlcSksCj4gPiArCQkJIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+bWF4X2Zy
ZXEpLAo+ID4gICAJCQkgcnBzLT5tYXhfZnJlcSk7Cj4gPiAtCXJwcy0+ZWZmaWNpZW50X2ZyZXEg
PSB2YWxsZXl2aWV3X3Jwc19ycGVfZnJlcShkZXZfcHJpdik7Cj4gPiArCXJwcy0+ZWZmaWNpZW50
X2ZyZXEgPSB2YWxsZXl2aWV3X3Jwc19ycGVfZnJlcShpOTE1KTsKPiA+ICAgCURSTV9ERUJVR19E
UklWRVIoIlJQZSBHUFUgZnJlcTogJWQgTUh6ICgldSlcbiIsCj4gPiAtCQkJIGludGVsX2dwdV9m
cmVxKGRldl9wcml2LCBycHMtPmVmZmljaWVudF9mcmVxKSwKPiA+ICsJCQkgaW50ZWxfZ3B1X2Zy
ZXEoaTkxNSwgcnBzLT5lZmZpY2llbnRfZnJlcSksCj4gPiAgIAkJCSBycHMtPmVmZmljaWVudF9m
cmVxKTsKPiA+IC0JcnBzLT5ycDFfZnJlcSA9IHZhbGxleXZpZXdfcnBzX2d1YXJfZnJlcShkZXZf
cHJpdik7Cj4gPiArCXJwcy0+cnAxX2ZyZXEgPSB2YWxsZXl2aWV3X3Jwc19ndWFyX2ZyZXEoaTkx
NSk7Cj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJSUDEoR3VhciBGcmVxKSBHUFUgZnJlcTogJWQg
TUh6ICgldSlcbiIsCj4gPiAtCQkJIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPnJwMV9m
cmVxKSwKPiA+ICsJCQkgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBzLT5ycDFfZnJlcSksCj4gPiAg
IAkJCSBycHMtPnJwMV9mcmVxKTsKPiA+IC0JcnBzLT5taW5fZnJlcSA9IHZhbGxleXZpZXdfcnBz
X21pbl9mcmVxKGRldl9wcml2KTsKPiA+ICsJcnBzLT5taW5fZnJlcSA9IHZhbGxleXZpZXdfcnBz
X21pbl9mcmVxKGk5MTUpOwo+ID4gICAJRFJNX0RFQlVHX0RSSVZFUigibWluIEdQVSBmcmVxOiAl
ZCBNSHogKCV1KVxuIiwKPiA+IC0JCQkgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+bWlu
X2ZyZXEpLAo+ID4gKwkJCSBpbnRlbF9ncHVfZnJlcShpOTE1LCBycHMtPm1pbl9mcmVxKSwKPiA+
ICAgCQkJIHJwcy0+bWluX2ZyZXEpOwo+ID4gLQl2bHZfaW9zZl9zYl9wdXQoZGV2X3ByaXYsCj4g
PiArCXZsdl9pb3NmX3NiX3B1dChpOTE1LAo+ID4gICAJCQlCSVQoVkxWX0lPU0ZfU0JfUFVOSVQp
IHwKPiA+ICAgCQkJQklUKFZMVl9JT1NGX1NCX05DKSB8Cj4gPiAgIAkJCUJJVChWTFZfSU9TRl9T
Ql9DQ0spKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfaW5pdF9ndF9wb3dl
cnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lk
IGNoZXJyeXZpZXdfaW5pdF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9w
bS5ycHM7Cj4gPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4g
PiAgIAl1MzIgdmFsOwo+ID4gLQljaGVycnl2aWV3X3NldHVwX3BjdHgoZGV2X3ByaXYpOwo+ID4g
KwljaGVycnl2aWV3X3NldHVwX3BjdHgoaTkxNSk7Cj4gPiAtCXZsdl9pb3NmX3NiX2dldChkZXZf
cHJpdiwKPiA+ICsJdmx2X2lvc2Zfc2JfZ2V0KGk5MTUsCj4gPiAgIAkJCUJJVChWTFZfSU9TRl9T
Ql9QVU5JVCkgfAo+ID4gICAJCQlCSVQoVkxWX0lPU0ZfU0JfTkMpIHwKPiA+ICAgCQkJQklUKFZM
Vl9JT1NGX1NCX0NDSykpOwo+ID4gLQl2bHZfaW5pdF9ncGxsX3JlZl9mcmVxKGRldl9wcml2KTsK
PiA+ICsJdmx2X2luaXRfZ3BsbF9yZWZfZnJlcShpOTE1KTsKPiA+IC0JdmFsID0gdmx2X2Nja19y
ZWFkKGRldl9wcml2LCBDQ0tfRlVTRV9SRUcpOwo+ID4gKwl2YWwgPSB2bHZfY2NrX3JlYWQoaTkx
NSwgQ0NLX0ZVU0VfUkVHKTsKPiA+ICAgCXN3aXRjaCAoKHZhbCA+PiAyKSAmIDB4Nykgewo+ID4g
ICAJY2FzZSAzOgo+ID4gLQkJZGV2X3ByaXYtPm1lbV9mcmVxID0gMjAwMDsKPiA+ICsJCWk5MTUt
Pm1lbV9mcmVxID0gMjAwMDsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWRlZmF1bHQ6Cj4gPiAtCQlk
ZXZfcHJpdi0+bWVtX2ZyZXEgPSAxNjAwOwo+ID4gKwkJaTkxNS0+bWVtX2ZyZXEgPSAxNjAwOwo+
ID4gICAJCWJyZWFrOwo+ID4gICAJfQo+ID4gLQlEUk1fREVCVUdfRFJJVkVSKCJERFIgc3BlZWQ6
ICVkIE1IelxuIiwgZGV2X3ByaXYtPm1lbV9mcmVxKTsKPiA+ICsJRFJNX0RFQlVHX0RSSVZFUigi
RERSIHNwZWVkOiAlZCBNSHpcbiIsIGk5MTUtPm1lbV9mcmVxKTsKPiA+IC0JcnBzLT5tYXhfZnJl
cSA9IGNoZXJyeXZpZXdfcnBzX21heF9mcmVxKGRldl9wcml2KTsKPiA+ICsJcnBzLT5tYXhfZnJl
cSA9IGNoZXJyeXZpZXdfcnBzX21heF9mcmVxKGk5MTUpOwo+ID4gICAJcnBzLT5ycDBfZnJlcSA9
IHJwcy0+bWF4X2ZyZXE7Cj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJtYXggR1BVIGZyZXE6ICVk
IE1IeiAoJXUpXG4iLAo+ID4gLQkJCSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5tYXhf
ZnJlcSksCj4gPiArCQkJIGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+bWF4X2ZyZXEpLAo+ID4g
ICAJCQkgcnBzLT5tYXhfZnJlcSk7Cj4gPiAtCXJwcy0+ZWZmaWNpZW50X2ZyZXEgPSBjaGVycnl2
aWV3X3Jwc19ycGVfZnJlcShkZXZfcHJpdik7Cj4gPiArCXJwcy0+ZWZmaWNpZW50X2ZyZXEgPSBj
aGVycnl2aWV3X3Jwc19ycGVfZnJlcShpOTE1KTsKPiA+ICAgCURSTV9ERUJVR19EUklWRVIoIlJQ
ZSBHUFUgZnJlcTogJWQgTUh6ICgldSlcbiIsCj4gPiAtCQkJIGludGVsX2dwdV9mcmVxKGRldl9w
cml2LCBycHMtPmVmZmljaWVudF9mcmVxKSwKPiA+ICsJCQkgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwg
cnBzLT5lZmZpY2llbnRfZnJlcSksCj4gPiAgIAkJCSBycHMtPmVmZmljaWVudF9mcmVxKTsKPiA+
IC0JcnBzLT5ycDFfZnJlcSA9IGNoZXJyeXZpZXdfcnBzX2d1YXJfZnJlcShkZXZfcHJpdik7Cj4g
PiArCXJwcy0+cnAxX2ZyZXEgPSBjaGVycnl2aWV3X3Jwc19ndWFyX2ZyZXEoaTkxNSk7Cj4gPiAg
IAlEUk1fREVCVUdfRFJJVkVSKCJSUDEoR3VhcikgR1BVIGZyZXE6ICVkIE1IeiAoJXUpXG4iLAo+
ID4gLQkJCSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5ycDFfZnJlcSksCj4gPiArCQkJ
IGludGVsX2dwdV9mcmVxKGk5MTUsIHJwcy0+cnAxX2ZyZXEpLAo+ID4gICAJCQkgcnBzLT5ycDFf
ZnJlcSk7Cj4gPiAtCXJwcy0+bWluX2ZyZXEgPSBjaGVycnl2aWV3X3Jwc19taW5fZnJlcShkZXZf
cHJpdik7Cj4gPiArCXJwcy0+bWluX2ZyZXEgPSBjaGVycnl2aWV3X3Jwc19taW5fZnJlcShpOTE1
KTsKPiA+ICAgCURSTV9ERUJVR19EUklWRVIoIm1pbiBHUFUgZnJlcTogJWQgTUh6ICgldSlcbiIs
Cj4gPiAtCQkJIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPm1pbl9mcmVxKSwKPiA+ICsJ
CQkgaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgcnBzLT5taW5fZnJlcSksCj4gPiAgIAkJCSBycHMtPm1p
bl9mcmVxKTsKPiA+IC0Jdmx2X2lvc2Zfc2JfcHV0KGRldl9wcml2LAo+ID4gKwl2bHZfaW9zZl9z
Yl9wdXQoaTkxNSwKPiA+ICAgCQkJQklUKFZMVl9JT1NGX1NCX1BVTklUKSB8Cj4gPiAgIAkJCUJJ
VChWTFZfSU9TRl9TQl9OQykgfAo+ID4gICAJCQlCSVQoVkxWX0lPU0ZfU0JfQ0NLKSk7Cj4gPiBA
QCAtNzg4OCwxMiArNzg4OCwxMiBAQCBzdGF0aWMgdm9pZCBjaGVycnl2aWV3X2luaXRfZ3RfcG93
ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgICJPZGQg
R1BVIGZyZXEgdmFsdWVzXG4iKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIHZhbGxleXZpZXdf
Y2xlYW51cF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gK3N0YXRpYyB2b2lkIHZhbGxleXZpZXdfY2xlYW51cF9ndF9wb3dlcnNhdmUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0JdmFsbGV5dmlld19jbGVhbnVwX3Bj
dHgoZGV2X3ByaXYpOwo+ID4gKwl2YWxsZXl2aWV3X2NsZWFudXBfcGN0eChpOTE1KTsKPiA+ICAg
fQo+ID4gLXN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgY2hlcnJ5dmlld19lbmFibGVfcmM2
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gPiAgIAllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiA+
IEBAIC03OTA3LDExICs3OTA3LDExIEBAIHN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfZW5hYmxlX3Jj
NihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJSTkxNV9XUklURShH
VEZJRk9EQkcsIGd0Zmlmb2RiZyk7Cj4gPiAgIAl9Cj4gPiAtCWNoZXJyeXZpZXdfY2hlY2tfcGN0
eChkZXZfcHJpdik7Cj4gPiArCWNoZXJyeXZpZXdfY2hlY2tfcGN0eChpOTE1KTsKPiA+ICAgCS8q
IDFhICYgMWI6IEdldCBmb3JjZXdha2UgZHVyaW5nIHByb2dyYW0gc2VxdWVuY2UuIEFsdGhvdWdo
IHRoZSBkcml2ZXIKPiA+ICAgCSAqIGhhc24ndCBlbmFibGVkIGEgc3RhdGUgeWV0IHdoZXJlIHdl
IG5lZWQgZm9yY2V3YWtlLCBCSU9TIG1heSBoYXZlLiovCj4gPiAtCWludGVsX3VuY29yZV9mb3Jj
ZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICsJaW50ZWxf
dW5jb3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiAg
IAkvKiAgRGlzYWJsZSBSQyBzdGF0ZXMuICovCj4gPiAgIAlJOTE1X1dSSVRFKEdFTjZfUkNfQ09O
VFJPTCwgMCk7Cj4gPiBAQCAtNzkyMSw3ICs3OTIxLDcgQEAgc3RhdGljIHZvaWQgY2hlcnJ5dmll
d19lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCUk5
MTVfV1JJVEUoR0VONl9SQ19FVkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDApOyAvKiAxMjUwMCAq
IDEyODBucyAqLwo+ID4gICAJSTkxNV9XUklURShHRU42X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7
IC8qIDI1ICogMTI4MG5zICovCj4gPiAtCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2
LCBpZCkKPiA+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCj4gPiAgIAkJSTkx
NV9XUklURShSSU5HX01BWF9JRExFKGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOwo+ID4gICAJSTkx
NV9XUklURShHRU42X1JDX1NMRUVQLCAwKTsKPiA+IEBAIC03OTQzLDE0ICs3OTQzLDE0IEBAIHN0
YXRpYyB2b2lkIGNoZXJyeXZpZXdfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiAgIAkJcmM2X21vZGUgPSBHRU43X1JDX0NUTF9UT19NT0RFOwo+ID4gICAJ
STkxNV9XUklURShHRU42X1JDX0NPTlRST0wsIHJjNl9tb2RlKTsKPiA+IC0JaW50ZWxfdW5jb3Jl
X2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gKwlp
bnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsK
PiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgY2hlcnJ5dmlld19lbmFi
bGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIg
dmFsOwo+ID4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwg
Rk9SQ0VXQUtFX0FMTCk7Cj4gPiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51
bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gICAJLyogMTogUHJvZ3JhbSBkZWZhdWx0cyBhbmQg
dGhyZXNob2xkcyBmb3IgUlBTKi8KPiA+ICAgCUk5MTVfV1JJVEUoR0VONl9SUF9ET1dOX1RJTUVP
VVQsIDEwMDAwMDApOwo+ID4gQEAgLTc5NzAsMTQgKzc5NzAsMTQgQEAgc3RhdGljIHZvaWQgY2hl
cnJ5dmlld19lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCQkgICBHRU42X1JQX0RPV05fSURMRV9BVkcpOwo+ID4gICAJLyogU2V0dGluZyBGaXhlZCBC
aWFzICovCj4gPiAtCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfcHVuaXRfZ2V0
KGk5MTUpOwo+ID4gICAJdmFsID0gVkxWX09WRVJSSURFX0VOIHwgVkxWX1NPQ19URFBfRU4gfCBD
SFZfQklBU19DUFVfNTBfU09DXzUwOwo+ID4gLQl2bHZfcHVuaXRfd3JpdGUoZGV2X3ByaXYsIFZM
Vl9UVVJCT19TT0NfT1ZFUlJJREUsIHZhbCk7Cj4gPiArCXZsdl9wdW5pdF93cml0ZShpOTE1LCBW
TFZfVFVSQk9fU09DX09WRVJSSURFLCB2YWwpOwo+ID4gLQl2YWwgPSB2bHZfcHVuaXRfcmVhZChk
ZXZfcHJpdiwgUFVOSVRfUkVHX0dQVV9GUkVRX1NUUyk7Cj4gPiArCXZhbCA9IHZsdl9wdW5pdF9y
ZWFkKGk5MTUsIFBVTklUX1JFR19HUFVfRlJFUV9TVFMpOwo+ID4gLQl2bHZfcHVuaXRfcHV0KGRl
dl9wcml2KTsKPiA+ICsJdmx2X3B1bml0X3B1dChpOTE1KTsKPiA+ICAgCS8qIFJQUyBjb2RlIGFz
c3VtZXMgR1BMTCBpcyB1c2VkICovCj4gPiAgIAlXQVJOX09OQ0UoKHZhbCAmIEdQTExFTkFCTEUp
ID09IDAsICJHUExMIG5vdCBlbmFibGVkXG4iKTsKPiA+IEBAIC03OTg1LDE4ICs3OTg1LDE4IEBA
IHN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJHUExMIGVuYWJsZWQ/ICVzXG4i
LCB5ZXNubyh2YWwgJiBHUExMRU5BQkxFKSk7Cj4gPiAgIAlEUk1fREVCVUdfRFJJVkVSKCJHUFUg
c3RhdHVzOiAweCUwOHhcbiIsIHZhbCk7Cj4gPiAtCXJlc2V0X3JwcyhkZXZfcHJpdiwgdmFsbGV5
dmlld19zZXRfcnBzKTsKPiA+ICsJcmVzZXRfcnBzKGk5MTUsIHZhbGxleXZpZXdfc2V0X3Jwcyk7
Cj4gPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JD
RVdBS0VfQUxMKTsKPiA+ICsJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29y
ZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2Vu
YWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2
b2lkIHZhbGxleXZpZXdfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ID4gICAJZW51
bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Cj4gPiAgIAl1MzIgZ3RmaWZvZGJnOwo+ID4gLQl2YWxsZXl2
aWV3X2NoZWNrX3BjdHgoZGV2X3ByaXYpOwo+ID4gKwl2YWxsZXl2aWV3X2NoZWNrX3BjdHgoaTkx
NSk7Cj4gPiAgIAlndGZpZm9kYmcgPSBJOTE1X1JFQUQoR1RGSUZPREJHKTsKPiA+ICAgCWlmIChn
dGZpZm9kYmcpIHsKPiA+IEBAIC04MDA1LDcgKzgwMDUsNyBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2
aWV3X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJ
CUk5MTVfV1JJVEUoR1RGSUZPREJHLCBndGZpZm9kYmcpOwo+ID4gICAJfQo+ID4gLQlpbnRlbF91
bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4g
PiArCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwo+ID4gICAJLyogIERpc2FibGUgUkMgc3RhdGVzLiAqLwo+ID4gICAJSTkxNV9XUklURShH
RU42X1JDX0NPTlRST0wsIDApOwo+ID4gQEAgLTgwMTQsNyArODAxNCw3IEBAIHN0YXRpYyB2b2lk
IHZhbGxleXZpZXdfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAgIAlJOTE1X1dSSVRFKEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsK
PiA+ICAgCUk5MTVfV1JJVEUoR0VONl9SQ19JRExFX0hZU1RFUlNJUywgMjUpOwo+ID4gLQlmb3Jf
ZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCj4gPiArCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGk5MTUsIGlkKQo+ID4gICAJCUk5MTVfV1JJVEUoUklOR19NQVhfSURMRShlbmdpbmUt
Pm1taW9fYmFzZSksIDEwKTsKPiA+ICAgCUk5MTVfV1JJVEUoR0VONl9SQzZfVEhSRVNIT0xELCAw
eDU1Nyk7Cj4gPiBAQCAtODAzMCwxNCArODAzMCwxNCBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3
X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJSTkx
NV9XUklURShHRU42X1JDX0NPTlRST0wsCj4gPiAgIAkJICAgR0VON19SQ19DVExfVE9fTU9ERSB8
IFZMVl9SQ19DVExfQ1RYX1JTVF9QQVJBTExFTCk7Cj4gPiAtCWludGVsX3VuY29yZV9mb3JjZXdh
a2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICsJaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2VuYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIHZhbGxleXZpZXdfZW5hYmxlX3Jwcyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIHZhbDsKPiA+
IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FL
RV9BTEwpOwo+ID4gKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBG
T1JDRVdBS0VfQUxMKTsKPiA+ICAgCUk5MTVfV1JJVEUoR0VONl9SUF9ET1dOX1RJTUVPVVQsIDEw
MDAwMDApOwo+ID4gICAJSTkxNV9XUklURShHRU42X1JQX1VQX1RIUkVTSE9MRCwgNTk0MDApOwo+
ID4gQEAgLTgwNTUsMTUgKzgwNTUsMTUgQEAgc3RhdGljIHZvaWQgdmFsbGV5dmlld19lbmFibGVf
cnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgICBHRU42X1JQ
X1VQX0JVU1lfQVZHIHwKPiA+ICAgCQkgICBHRU42X1JQX0RPV05fSURMRV9DT05UKTsKPiA+IC0J
dmx2X3B1bml0X2dldChkZXZfcHJpdik7Cj4gPiArCXZsdl9wdW5pdF9nZXQoaTkxNSk7Cj4gPiAg
IAkvKiBTZXR0aW5nIEZpeGVkIEJpYXMgKi8KPiA+ICAgCXZhbCA9IFZMVl9PVkVSUklERV9FTiB8
IFZMVl9TT0NfVERQX0VOIHwgVkxWX0JJQVNfQ1BVXzEyNV9TT0NfODc1Owo+ID4gLQl2bHZfcHVu
aXRfd3JpdGUoZGV2X3ByaXYsIFZMVl9UVVJCT19TT0NfT1ZFUlJJREUsIHZhbCk7Cj4gPiArCXZs
dl9wdW5pdF93cml0ZShpOTE1LCBWTFZfVFVSQk9fU09DX09WRVJSSURFLCB2YWwpOwo+ID4gLQl2
YWwgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX0dQVV9GUkVRX1NUUyk7Cj4g
PiArCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19HUFVfRlJFUV9TVFMpOwo+
ID4gLQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKPiA+ICsJdmx2X3B1bml0X3B1dChpOTE1KTsK
PiA+ICAgCS8qIFJQUyBjb2RlIGFzc3VtZXMgR1BMTCBpcyB1c2VkICovCj4gPiAgIAlXQVJOX09O
Q0UoKHZhbCAmIEdQTExFTkFCTEUpID09IDAsICJHUExMIG5vdCBlbmFibGVkXG4iKTsKPiA+IEBA
IC04MDcxLDkgKzgwNzEsOSBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2VuYWJsZV9ycHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJRFJNX0RFQlVHX0RSSVZFUigi
R1BMTCBlbmFibGVkPyAlc1xuIiwgeWVzbm8odmFsICYgR1BMTEVOQUJMRSkpOwo+ID4gICAJRFJN
X0RFQlVHX0RSSVZFUigiR1BVIHN0YXR1czogMHglMDh4XG4iLCB2YWwpOwo+ID4gLQlyZXNldF9y
cHMoZGV2X3ByaXYsIHZhbGxleXZpZXdfc2V0X3Jwcyk7Cj4gPiArCXJlc2V0X3JwcyhpOTE1LCB2
YWxsZXl2aWV3X3NldF9ycHMpOwo+ID4gLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2
X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCWludGVsX3VuY29yZV9mb3JjZXdh
a2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+ID4gICB9Cj4gPiAgIHN0YXRp
YyB1bnNpZ25lZCBsb25nIGludGVsX3B4ZnJlcSh1MzIgdmlkZnJlcSkKPiA+IEBAIC04MTA1LDcg
KzgxMDUsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGNwYXJhbXMgewo+ID4gICAJeyAwLCA4MDAs
IDIzMSwgMjM3ODQgfSwKPiA+ICAgfTsKPiA+IC1zdGF0aWMgdW5zaWduZWQgbG9uZyBfX2k5MTVf
Y2hpcHNldF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRp
YyB1bnNpZ25lZCBsb25nIF9faTkxNV9jaGlwc2V0X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTY0IHRvdGFsX2NvdW50LCBkaWZmLCByZXQ7Cj4gPiAg
IAl1MzIgY291bnQxLCBjb3VudDIsIGNvdW50MywgbSA9IDAsIGMgPSAwOwo+ID4gQEAgLTgxMTQs
NyArODExNCw3IEBAIHN0YXRpYyB1bnNpZ25lZCBsb25nIF9faTkxNV9jaGlwc2V0X3ZhbChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlsb2NrZGVwX2Fzc2VydF9oZWxk
KCZtY2hkZXZfbG9jayk7Cj4gPiAtCWRpZmYxID0gbm93IC0gZGV2X3ByaXYtPmlwcy5sYXN0X3Rp
bWUxOwo+ID4gKwlkaWZmMSA9IG5vdyAtIGk5MTUtPmlwcy5sYXN0X3RpbWUxOwo+ID4gICAJLyog
UHJldmVudCBkaXZpc2lvbi1ieS16ZXJvIGlmIHdlIGFyZSBhc2tpbmcgdG9vIGZhc3QuCj4gPiAg
IAkgKiBBbHNvLCB3ZSBkb24ndCBnZXQgaW50ZXJlc3RpbmcgcmVzdWx0cyBpZiB3ZSBhcmUgcG9s
bGluZwo+ID4gQEAgLTgxMjIsNyArODEyMiw3IEBAIHN0YXRpYyB1bnNpZ25lZCBsb25nIF9faTkx
NV9jaGlwc2V0X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkg
KiBpbiBzdWNoIGNhc2VzLgo+ID4gICAJICovCj4gPiAgIAlpZiAoZGlmZjEgPD0gMTApCj4gPiAt
CQlyZXR1cm4gZGV2X3ByaXYtPmlwcy5jaGlwc2V0X3Bvd2VyOwo+ID4gKwkJcmV0dXJuIGk5MTUt
Pmlwcy5jaGlwc2V0X3Bvd2VyOwo+ID4gICAJY291bnQxID0gSTkxNV9SRUFEKERNSUVDKTsKPiA+
ICAgCWNvdW50MiA9IEk5MTVfUkVBRChERFJFQyk7Cj4gPiBAQCAtODEzMSwxNiArODEzMSwxNiBA
QCBzdGF0aWMgdW5zaWduZWQgbG9uZyBfX2k5MTVfY2hpcHNldF92YWwoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJdG90YWxfY291bnQgPSBjb3VudDEgKyBjb3VudDIg
KyBjb3VudDM7Cj4gPiAgIAkvKiBGSVhNRTogaGFuZGxlIHBlci1jb3VudGVyIG92ZXJmbG93ICov
Cj4gPiAtCWlmICh0b3RhbF9jb3VudCA8IGRldl9wcml2LT5pcHMubGFzdF9jb3VudDEpIHsKPiA+
IC0JCWRpZmYgPSB+MFVMIC0gZGV2X3ByaXYtPmlwcy5sYXN0X2NvdW50MTsKPiA+ICsJaWYgKHRv
dGFsX2NvdW50IDwgaTkxNS0+aXBzLmxhc3RfY291bnQxKSB7Cj4gPiArCQlkaWZmID0gfjBVTCAt
IGk5MTUtPmlwcy5sYXN0X2NvdW50MTsKPiA+ICAgCQlkaWZmICs9IHRvdGFsX2NvdW50Owo+ID4g
ICAJfSBlbHNlIHsKPiA+IC0JCWRpZmYgPSB0b3RhbF9jb3VudCAtIGRldl9wcml2LT5pcHMubGFz
dF9jb3VudDE7Cj4gPiArCQlkaWZmID0gdG90YWxfY291bnQgLSBpOTE1LT5pcHMubGFzdF9jb3Vu
dDE7Cj4gPiAgIAl9Cj4gPiAgIAlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShjcGFyYW1zKTsg
aSsrKSB7Cj4gPiAtCQlpZiAoY3BhcmFtc1tpXS5pID09IGRldl9wcml2LT5pcHMuY19tICYmCj4g
PiAtCQkgICAgY3BhcmFtc1tpXS50ID09IGRldl9wcml2LT5pcHMucl90KSB7Cj4gPiArCQlpZiAo
Y3BhcmFtc1tpXS5pID09IGk5MTUtPmlwcy5jX20gJiYKPiA+ICsJCSAgICBjcGFyYW1zW2ldLnQg
PT0gaTkxNS0+aXBzLnJfdCkgewo+ID4gICAJCQltID0gY3BhcmFtc1tpXS5tOwo+ID4gICAJCQlj
ID0gY3BhcmFtc1tpXS5jOwo+ID4gICAJCQlicmVhazsKPiA+IEBAIC04MTUxLDI1ICs4MTUxLDI1
IEBAIHN0YXRpYyB1bnNpZ25lZCBsb25nIF9faTkxNV9jaGlwc2V0X3ZhbChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlyZXQgPSAoKG0gKiBkaWZmKSArIGMpOwo+ID4g
ICAJcmV0ID0gZGl2X3U2NChyZXQsIDEwKTsKPiA+IC0JZGV2X3ByaXYtPmlwcy5sYXN0X2NvdW50
MSA9IHRvdGFsX2NvdW50Owo+ID4gLQlkZXZfcHJpdi0+aXBzLmxhc3RfdGltZTEgPSBub3c7Cj4g
PiArCWk5MTUtPmlwcy5sYXN0X2NvdW50MSA9IHRvdGFsX2NvdW50Owo+ID4gKwlpOTE1LT5pcHMu
bGFzdF90aW1lMSA9IG5vdzsKPiA+IC0JZGV2X3ByaXYtPmlwcy5jaGlwc2V0X3Bvd2VyID0gcmV0
Owo+ID4gKwlpOTE1LT5pcHMuY2hpcHNldF9wb3dlciA9IHJldDsKPiA+ICAgCXJldHVybiByZXQ7
Cj4gPiAgIH0KPiA+IC11bnNpZ25lZCBsb25nIGk5MTVfY2hpcHNldF92YWwoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3Vuc2lnbmVkIGxvbmcgaTkxNV9jaGlwc2V0X3Zh
bChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIHZhbCA9IDA7Cj4gPiAtCWlmICgh
SVNfR0VOKGRldl9wcml2LCA1KSkKPiA+ICsJaWYgKCFJU19HRU4oaTkxNSwgNSkpCj4gPiAgIAkJ
cmV0dXJuIDA7Cj4gPiAtCXdpdGhfaW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJlZikg
ewo+ID4gKwl3aXRoX2ludGVsX3J1bnRpbWVfcG0oaTkxNSwgd2FrZXJlZikgewo+ID4gICAJCXNw
aW5fbG9ja19pcnEoJm1jaGRldl9sb2NrKTsKPiA+IC0JCXZhbCA9IF9faTkxNV9jaGlwc2V0X3Zh
bChkZXZfcHJpdik7Cj4gPiArCQl2YWwgPSBfX2k5MTVfY2hpcHNldF92YWwoaTkxNSk7Cj4gPiAg
IAkJc3Bpbl91bmxvY2tfaXJxKCZtY2hkZXZfbG9jayk7Cj4gPiAgIAl9Cj4gPiBAQCAtODIwMiwx
OCArODIwMiwxOCBAQCBzdGF0aWMgaW50IF9weHZpZF90b192ZCh1OCBweHZpZCkKPiA+ICAgCXJl
dHVybiAocHh2aWQgKyAyKSAqIDEyNTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB1MzIgcHZpZF90b19l
eHR2aWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCBweHZpZCkKPiA+ICtz
dGF0aWMgdTMyIHB2aWRfdG9fZXh0dmlkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1
OCBweHZpZCkKPiA+ICAgewo+ID4gICAJY29uc3QgaW50IHZkID0gX3B4dmlkX3RvX3ZkKHB4dmlk
KTsKPiA+ICAgCWNvbnN0IGludCB2bSA9IHZkIC0gMTEyNTsKPiA+IC0JaWYgKElOVEVMX0lORk8o
ZGV2X3ByaXYpLT5pc19tb2JpbGUpCj4gPiArCWlmIChJTlRFTF9JTkZPKGk5MTUpLT5pc19tb2Jp
bGUpCj4gPiAgIAkJcmV0dXJuIHZtID4gMCA/IHZtIDogMDsKPiA+ICAgCXJldHVybiB2ZDsKPiA+
ICAgfQo+ID4gLXN0YXRpYyB2b2lkIF9faTkxNV91cGRhdGVfZ2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgX19pOTE1X3VwZGF0ZV9nZnhf
dmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1NjQgbm93
LCBkaWZmLCBkaWZmbXM7Cj4gPiAgIAl1MzIgY291bnQ7Cj4gPiBAQCAtODIyMSw3ICs4MjIxLDcg
QEAgc3RhdGljIHZvaWQgX19pOTE1X3VwZGF0ZV9nZnhfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICAgCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJm1jaGRldl9sb2NrKTsK
PiA+ICAgCW5vdyA9IGt0aW1lX2dldF9yYXdfbnMoKTsKPiA+IC0JZGlmZm1zID0gbm93IC0gZGV2
X3ByaXYtPmlwcy5sYXN0X3RpbWUyOwo+ID4gKwlkaWZmbXMgPSBub3cgLSBpOTE1LT5pcHMubGFz
dF90aW1lMjsKPiA+ICAgCWRvX2RpdihkaWZmbXMsIE5TRUNfUEVSX01TRUMpOwo+ID4gICAJLyog
RG9uJ3QgZGl2aWRlIGJ5IDAgKi8KPiA+IEBAIC04MjMwLDUwICs4MjMwLDUwIEBAIHN0YXRpYyB2
b2lkIF9faTkxNV91cGRhdGVfZ2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiAgIAljb3VudCA9IEk5MTVfUkVBRChHRlhFQyk7Cj4gPiAtCWlmIChjb3VudCA8IGRl
dl9wcml2LT5pcHMubGFzdF9jb3VudDIpIHsKPiA+IC0JCWRpZmYgPSB+MFVMIC0gZGV2X3ByaXYt
Pmlwcy5sYXN0X2NvdW50MjsKPiA+ICsJaWYgKGNvdW50IDwgaTkxNS0+aXBzLmxhc3RfY291bnQy
KSB7Cj4gPiArCQlkaWZmID0gfjBVTCAtIGk5MTUtPmlwcy5sYXN0X2NvdW50MjsKPiA+ICAgCQlk
aWZmICs9IGNvdW50Owo+ID4gICAJfSBlbHNlIHsKPiA+IC0JCWRpZmYgPSBjb3VudCAtIGRldl9w
cml2LT5pcHMubGFzdF9jb3VudDI7Cj4gPiArCQlkaWZmID0gY291bnQgLSBpOTE1LT5pcHMubGFz
dF9jb3VudDI7Cj4gPiAgIAl9Cj4gPiAtCWRldl9wcml2LT5pcHMubGFzdF9jb3VudDIgPSBjb3Vu
dDsKPiA+IC0JZGV2X3ByaXYtPmlwcy5sYXN0X3RpbWUyID0gbm93Owo+ID4gKwlpOTE1LT5pcHMu
bGFzdF9jb3VudDIgPSBjb3VudDsKPiA+ICsJaTkxNS0+aXBzLmxhc3RfdGltZTIgPSBub3c7Cj4g
PiAgIAkvKiBNb3JlIG1hZ2ljIGNvbnN0YW50cy4uLiAqLwo+ID4gICAJZGlmZiA9IGRpZmYgKiAx
MTgxOwo+ID4gICAJZGlmZiA9IGRpdl91NjQoZGlmZiwgZGlmZm1zICogMTApOwo+ID4gLQlkZXZf
cHJpdi0+aXBzLmdmeF9wb3dlciA9IGRpZmY7Cj4gPiArCWk5MTUtPmlwcy5nZnhfcG93ZXIgPSBk
aWZmOwo+ID4gICB9Cj4gPiAtdm9pZCBpOTE1X3VwZGF0ZV9nZnhfdmFsKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGk5MTVfdXBkYXRlX2dmeF92YWwoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3
YWtlcmVmOwo+ID4gLQlpZiAoIUlTX0dFTihkZXZfcHJpdiwgNSkpCj4gPiArCWlmICghSVNfR0VO
KGk5MTUsIDUpKQo+ID4gICAJCXJldHVybjsKPiA+IC0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKGRl
dl9wcml2LCB3YWtlcmVmKSB7Cj4gPiArCXdpdGhfaW50ZWxfcnVudGltZV9wbShpOTE1LCB3YWtl
cmVmKSB7Cj4gPiAgIAkJc3Bpbl9sb2NrX2lycSgmbWNoZGV2X2xvY2spOwo+ID4gLQkJX19pOTE1
X3VwZGF0ZV9nZnhfdmFsKGRldl9wcml2KTsKPiA+ICsJCV9faTkxNV91cGRhdGVfZ2Z4X3ZhbChp
OTE1KTsKPiA+ICAgCQlzcGluX3VubG9ja19pcnEoJm1jaGRldl9sb2NrKTsKPiA+ICAgCX0KPiA+
ICAgfQo+ID4gLXN0YXRpYyB1bnNpZ25lZCBsb25nIF9faTkxNV9nZnhfdmFsKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdW5zaWduZWQgbG9uZyBfX2k5MTVf
Z2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdW5z
aWduZWQgbG9uZyB0LCBjb3JyLCBzdGF0ZTEsIGNvcnIyLCBzdGF0ZTI7Cj4gPiAgIAl1MzIgcHh2
aWQsIGV4dF92Owo+ID4gICAJbG9ja2RlcF9hc3NlcnRfaGVsZCgmbWNoZGV2X2xvY2spOwo+ID4g
LQlweHZpZCA9IEk5MTVfUkVBRChQWFZGUkVRKGRldl9wcml2LT5ndF9wbS5ycHMuY3VyX2ZyZXEp
KTsKPiA+ICsJcHh2aWQgPSBJOTE1X1JFQUQoUFhWRlJFUShpOTE1LT5ndF9wbS5ycHMuY3VyX2Zy
ZXEpKTsKPiA+ICAgCXB4dmlkID0gKHB4dmlkID4+IDI0KSAmIDB4N2Y7Cj4gPiAtCWV4dF92ID0g
cHZpZF90b19leHR2aWQoZGV2X3ByaXYsIHB4dmlkKTsKPiA+ICsJZXh0X3YgPSBwdmlkX3RvX2V4
dHZpZChpOTE1LCBweHZpZCk7Cj4gPiAgIAlzdGF0ZTEgPSBleHRfdjsKPiA+IC0JdCA9IGk5MTVf
bWNoX3ZhbChkZXZfcHJpdik7Cj4gPiArCXQgPSBpOTE1X21jaF92YWwoaTkxNSk7Cj4gPiAgIAkv
KiBSZXZlbCBpbiB0aGUgZW1waXJpY2FsbHkgZGVyaXZlZCBjb25zdGFudHMgKi8KPiA+IEBAIC04
Mjg3LDI3ICs4Mjg3LDI3IEBAIHN0YXRpYyB1bnNpZ25lZCBsb25nIF9faTkxNV9nZnhfdmFsKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCWNvcnIgPSBjb3JyICogKCgx
NTAxNDIgKiBzdGF0ZTEpIC8gMTAwMDAgLSA3ODY0Mik7Cj4gPiAgIAljb3JyIC89IDEwMDAwMDsK
PiA+IC0JY29ycjIgPSAoY29yciAqIGRldl9wcml2LT5pcHMuY29ycik7Cj4gPiArCWNvcnIyID0g
KGNvcnIgKiBpOTE1LT5pcHMuY29ycik7Cj4gPiAgIAlzdGF0ZTIgPSAoY29ycjIgKiBzdGF0ZTEp
IC8gMTAwMDA7Cj4gPiAgIAlzdGF0ZTIgLz0gMTAwOyAvKiBjb252ZXJ0IHRvIG1XICovCj4gPiAt
CV9faTkxNV91cGRhdGVfZ2Z4X3ZhbChkZXZfcHJpdik7Cj4gPiArCV9faTkxNV91cGRhdGVfZ2Z4
X3ZhbChpOTE1KTsKPiA+IC0JcmV0dXJuIGRldl9wcml2LT5pcHMuZ2Z4X3Bvd2VyICsgc3RhdGUy
Owo+ID4gKwlyZXR1cm4gaTkxNS0+aXBzLmdmeF9wb3dlciArIHN0YXRlMjsKPiA+ICAgfQo+ID4g
LXVuc2lnbmVkIGxvbmcgaTkxNV9nZnhfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICt1bnNpZ25lZCBsb25nIGk5MTVfZ2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAg
IAl1bnNpZ25lZCBsb25nIHZhbCA9IDA7Cj4gPiAtCWlmICghSVNfR0VOKGRldl9wcml2LCA1KSkK
PiA+ICsJaWYgKCFJU19HRU4oaTkxNSwgNSkpCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAtCXdpdGhf
aW50ZWxfcnVudGltZV9wbShkZXZfcHJpdiwgd2FrZXJlZikgewo+ID4gKwl3aXRoX2ludGVsX3J1
bnRpbWVfcG0oaTkxNSwgd2FrZXJlZikgewo+ID4gICAJCXNwaW5fbG9ja19pcnEoJm1jaGRldl9s
b2NrKTsKPiA+IC0JCXZhbCA9IF9faTkxNV9nZnhfdmFsKGRldl9wcml2KTsKPiA+ICsJCXZhbCA9
IF9faTkxNV9nZnhfdmFsKGk5MTUpOwo+ID4gICAJCXNwaW5fdW5sb2NrX2lycSgmbWNoZGV2X2xv
Y2spOwo+ID4gICAJfQo+ID4gQEAgLTg0NzEsMTEgKzg0NzEsMTEgQEAgaXBzX3BpbmdfZm9yX2k5
MTVfbG9hZCh2b2lkKQo+ID4gICAJfQo+ID4gICB9Cj4gPiAtdm9pZCBpbnRlbF9ncHVfaXBzX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfZ3B1
X2lwc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAkv
KiBXZSBvbmx5IHJlZ2lzdGVyIHRoZSBpOTE1IGlwcyBwYXJ0IHdpdGggaW50ZWwtaXBzIG9uY2Ug
ZXZlcnl0aGluZyBpcwo+ID4gICAJICogc2V0IHVwLCB0byBhdm9pZCBpbnRlbC1pcHMgc25lYWtp
bmcgaW4gYW5kIHJlYWRpbmcgYm9ndXMgdmFsdWVzLiAqLwo+ID4gLQlyY3VfYXNzaWduX3BvaW50
ZXIoaTkxNV9tY2hfZGV2LCBkZXZfcHJpdik7Cj4gPiArCXJjdV9hc3NpZ25fcG9pbnRlcihpOTE1
X21jaF9kZXYsIGk5MTUpOwo+ID4gICAJaXBzX3BpbmdfZm9yX2k5MTVfbG9hZCgpOwo+ID4gICB9
Cj4gPiBAQCAtODQ4NSw3ICs4NDg1LDcgQEAgdm9pZCBpbnRlbF9ncHVfaXBzX3RlYXJkb3duKHZv
aWQpCj4gPiAgIAlyY3VfYXNzaWduX3BvaW50ZXIoaTkxNV9tY2hfZGV2LCBOVUxMKTsKPiA+ICAg
fQo+ID4gLXN0YXRpYyB2b2lkIGludGVsX2luaXRfZW1vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaW50ZWxfaW5pdF9lbW9uKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIgbGNmdXNlOwo+ID4gICAJdTgg
cHh3WzE2XTsKPiA+IEBAIC04NTUyLDQwICs4NTUyLDQwIEBAIHN0YXRpYyB2b2lkIGludGVsX2lu
aXRfZW1vbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlsY2Z1c2Ug
PSBJOTE1X1JFQUQoTENGVVNFMDIpOwo+ID4gLQlkZXZfcHJpdi0+aXBzLmNvcnIgPSAobGNmdXNl
ICYgTENGVVNFX0hJVl9NQVNLKTsKPiA+ICsJaTkxNS0+aXBzLmNvcnIgPSAobGNmdXNlICYgTENG
VVNFX0hJVl9NQVNLKTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfaW5pdF9ndF9wb3dlcnNhdmUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfaW5pdF9n
dF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Cj4gPiArCXN0cnVj
dCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7Cj4gPiAgIAkvKgo+ID4gICAJICog
UlBNIGRlcGVuZHMgb24gUkM2IHRvIHNhdmUgcmVzdG9yZSB0aGUgR1QgSFcgY29udGV4dCwgc28g
bWFrZSBSQzYgYQo+ID4gICAJICogcmVxdWlyZW1lbnQuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKCFz
YW5pdGl6ZV9yYzYoZGV2X3ByaXYpKSB7Cj4gPiArCWlmICghc2FuaXRpemVfcmM2KGk5MTUpKSB7
Cj4gPiAgIAkJRFJNX0lORk8oIlJDNiBkaXNhYmxlZCwgZGlzYWJsaW5nIHJ1bnRpbWUgUE0gc3Vw
cG9ydFxuIik7Cj4gPiAtCQlwbV9ydW50aW1lX2dldCgmZGV2X3ByaXYtPmRybS5wZGV2LT5kZXYp
Owo+ID4gKwkJcG1fcnVudGltZV9nZXQoJmk5MTUtPmRybS5wZGV2LT5kZXYpOwo+ID4gICAJfQo+
ID4gICAJLyogSW5pdGlhbGl6ZSBSUFMgbGltaXRzIChmb3IgdXNlcnNwYWNlKSAqLwo+ID4gLQlp
ZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiAtCQljaGVycnl2aWV3X2luaXRfZ3RfcG93
ZXJzYXZlKGRldl9wcml2KTsKPiA+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikp
Cj4gPiAtCQl2YWxsZXl2aWV3X2luaXRfZ3RfcG93ZXJzYXZlKGRldl9wcml2KTsKPiA+IC0JZWxz
ZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2KQo+ID4gLQkJZ2VuNl9pbml0X3Jwc19mcmVx
dWVuY2llcyhkZXZfcHJpdik7Cj4gPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKQo+ID4gKwkJ
Y2hlcnJ5dmlld19pbml0X2d0X3Bvd2Vyc2F2ZShpOTE1KTsKPiA+ICsJZWxzZSBpZiAoSVNfVkFM
TEVZVklFVyhpOTE1KSkKPiA+ICsJCXZhbGxleXZpZXdfaW5pdF9ndF9wb3dlcnNhdmUoaTkxNSk7
Cj4gPiArCWVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQo+ID4gKwkJZ2VuNl9pbml0X3Jw
c19mcmVxdWVuY2llcyhpOTE1KTsKPiA+ICAgCS8qIERlcml2ZSBpbml0aWFsIHVzZXIgcHJlZmVy
ZW5jZXMvbGltaXRzIGZyb20gdGhlIGhhcmR3YXJlIGxpbWl0cyAqLwo+ID4gICAJcnBzLT5tYXhf
ZnJlcV9zb2Z0bGltaXQgPSBycHMtPm1heF9mcmVxOwo+ID4gICAJcnBzLT5taW5fZnJlcV9zb2Z0
bGltaXQgPSBycHMtPm1pbl9mcmVxOwo+ID4gICAJLyogQWZ0ZXIgc2V0dGluZyBtYXgtc29mdGxp
bWl0LCBmaW5kIHRoZSBvdmVyY2xvY2sgbWF4IGZyZXEgKi8KPiA+IC0JaWYgKElTX0dFTihkZXZf
cHJpdiwgNikgfHwKPiA+IC0JICAgIElTX0lWWUJSSURHRShkZXZfcHJpdikgfHwgSVNfSEFTV0VM
TChkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0dFTihpOTE1LCA2KSB8fAo+ID4gKwkgICAgSVNf
SVZZQlJJREdFKGk5MTUpIHx8IElTX0hBU1dFTEwoaTkxNSkpIHsKPiA+ICAgCQl1MzIgcGFyYW1z
ID0gMDsKPiA+IC0JCXNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoZGV2X3ByaXYsIEdFTjZfUkVBRF9P
Q19QQVJBTVMsCj4gPiArCQlzYW5keWJyaWRnZV9wY29kZV9yZWFkKGk5MTUsIEdFTjZfUkVBRF9P
Q19QQVJBTVMsCj4gPiAgIAkJCQkgICAgICAgJnBhcmFtcywgTlVMTCk7Cj4gPiAgIAkJaWYgKHBh
cmFtcyAmIEJJVCgzMSkpIHsgLyogT0Mgc3VwcG9ydGVkICovCj4gPiAgIAkJCURSTV9ERUJVR19E
UklWRVIoIk92ZXJjbG9ja2luZyBzdXBwb3J0ZWQsIG1heDogJWRNSHosIG92ZXJjbG9jazogJWRN
SHpcbiIsCj4gPiBAQCAtODYwMSwyNSArODYwMSwyNSBAQCB2b2lkIGludGVsX2luaXRfZ3RfcG93
ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXJwcy0+Y3Vy
X2ZyZXEgPSBycHMtPmlkbGVfZnJlcTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50ZWxfY2xlYW51cF9n
dF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3ZvaWQg
aW50ZWxfY2xlYW51cF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQo+ID4gLQkJdmFsbGV5
dmlld19jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShkZXZfcHJpdik7Cj4gPiArCWlmIChJU19WQUxMRVlW
SUVXKGk5MTUpKQo+ID4gKwkJdmFsbGV5dmlld19jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShpOTE1KTsK
PiA+IC0JaWYgKCFIQVNfUkM2KGRldl9wcml2KSkKPiA+IC0JCXBtX3J1bnRpbWVfcHV0KCZkZXZf
cHJpdi0+ZHJtLnBkZXYtPmRldik7Cj4gPiArCWlmICghSEFTX1JDNihpOTE1KSkKPiA+ICsJCXBt
X3J1bnRpbWVfcHV0KCZpOTE1LT5kcm0ucGRldi0+ZGV2KTsKPiA+ICAgfQo+ID4gLXZvaWQgaW50
ZWxfc2FuaXRpemVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICt2b2lkIGludGVsX3Nhbml0aXplX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlkZXZfcHJpdi0+Z3RfcG0ucnBzLmVuYWJsZWQg
PSB0cnVlOyAvKiBmb3JjZSBSUFMgZGlzYWJsaW5nICovCj4gPiAtCWRldl9wcml2LT5ndF9wbS5y
YzYuZW5hYmxlZCA9IHRydWU7IC8qIGZvcmNlIFJDNiBkaXNhYmxpbmcgKi8KPiA+IC0JaW50ZWxf
ZGlzYWJsZV9ndF9wb3dlcnNhdmUoZGV2X3ByaXYpOwo+ID4gKwlpOTE1LT5ndF9wbS5ycHMuZW5h
YmxlZCA9IHRydWU7IC8qIGZvcmNlIFJQUyBkaXNhYmxpbmcgKi8KPiA+ICsJaTkxNS0+Z3RfcG0u
cmM2LmVuYWJsZWQgPSB0cnVlOyAvKiBmb3JjZSBSQzYgZGlzYWJsaW5nICovCj4gPiArCWludGVs
X2Rpc2FibGVfZ3RfcG93ZXJzYXZlKGk5MTUpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSAxMSkKPiA+IC0JCWdlbjExX3Jlc2V0X3Jwc19pbnRlcnJ1cHRzKGRldl9wcml2KTsKPiA+
IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2KQo+ID4gLQkJZ2VuNl9yZXNldF9y
cHNfaW50ZXJydXB0cyhkZXZfcHJpdik7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEp
Cj4gPiArCQlnZW4xMV9yZXNldF9ycHNfaW50ZXJydXB0cyhpOTE1KTsKPiA+ICsJZWxzZSBpZiAo
SU5URUxfR0VOKGk5MTUpID49IDYpCj4gPiArCQlnZW42X3Jlc2V0X3Jwc19pbnRlcnJ1cHRzKGk5
MTUpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9kaXNhYmxlX2xsY19w
c3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiBAQCAtODYzNCw1NiArODYz
NCw1NiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaW50ZWxfZGlzYWJsZV9sbGNfcHN0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICAJaTkxNS0+Z3RfcG0ubGxjX3BzdGF0ZS5l
bmFibGVkID0gZmFsc2U7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX3Jj
NihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaW50
ZWxfZGlzYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+
IC0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKPiA+ICsJ
bG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+Z3RfcG0ucnBzLmxvY2spOwo+ID4gLQlpZiAoIWRl
dl9wcml2LT5ndF9wbS5yYzYuZW5hYmxlZCkKPiA+ICsJaWYgKCFpOTE1LT5ndF9wbS5yYzYuZW5h
YmxlZCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkp
Cj4gPiAtCQlnZW45X2Rpc2FibGVfcmM2KGRldl9wcml2KTsKPiA+IC0JZWxzZSBpZiAoSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikpCj4gPiAtCQljaGVycnl2aWV3X2Rpc2FibGVfcmM2KGRldl9wcml2
KTsKPiA+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCj4gPiAtCQl2YWxsZXl2
aWV3X2Rpc2FibGVfcmM2KGRldl9wcml2KTsKPiA+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA2KQo+ID4gLQkJZ2VuNl9kaXNhYmxlX3JjNihkZXZfcHJpdik7Cj4gPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gOSkKPiA+ICsJCWdlbjlfZGlzYWJsZV9yYzYoaTkxNSk7Cj4gPiAr
CWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiArCQljaGVycnl2aWV3X2Rpc2FibGVf
cmM2KGk5MTUpOwo+ID4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQo+ID4gKwkJdmFs
bGV5dmlld19kaXNhYmxlX3JjNihpOTE1KTsKPiA+ICsJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDYpCj4gPiArCQlnZW42X2Rpc2FibGVfcmM2KGk5MTUpOwo+ID4gLQlkZXZfcHJpdi0+Z3Rf
cG0ucmM2LmVuYWJsZWQgPSBmYWxzZTsKPiA+ICsJaTkxNS0+Z3RfcG0ucmM2LmVuYWJsZWQgPSBm
YWxzZTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfcnBzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxl
X3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlsb2NrZGVw
X2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+Z3RfcG0ucnBzLmxvY2spOwo+ID4gKwlsb2NrZGVwX2Fz
c2VydF9oZWxkKCZpOTE1LT5ndF9wbS5ycHMubG9jayk7Cj4gPiAtCWlmICghZGV2X3ByaXYtPmd0
X3BtLnJwcy5lbmFibGVkKQo+ID4gKwlpZiAoIWk5MTUtPmd0X3BtLnJwcy5lbmFibGVkKQo+ID4g
ICAJCXJldHVybjsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiA+IC0JCWdl
bjlfZGlzYWJsZV9ycHMoZGV2X3ByaXYpOwo+ID4gLQllbHNlIGlmIChJU19DSEVSUllWSUVXKGRl
dl9wcml2KSkKPiA+IC0JCWNoZXJyeXZpZXdfZGlzYWJsZV9ycHMoZGV2X3ByaXYpOwo+ID4gLQll
bHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiA+IC0JCXZhbGxleXZpZXdfZGlzYWJs
ZV9ycHMoZGV2X3ByaXYpOwo+ID4gLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYp
Cj4gPiAtCQlnZW42X2Rpc2FibGVfcnBzKGRldl9wcml2KTsKPiA+IC0JZWxzZSBpZiAoSVNfSVJP
TkxBS0VfTShkZXZfcHJpdikpCj4gPiAtCQlpcm9ubGFrZV9kaXNhYmxlX2RycHMoZGV2X3ByaXYp
Owo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCj4gPiArCQlnZW45X2Rpc2FibGVfcnBz
KGk5MTUpOwo+ID4gKwllbHNlIGlmIChJU19DSEVSUllWSUVXKGk5MTUpKQo+ID4gKwkJY2hlcnJ5
dmlld19kaXNhYmxlX3JwcyhpOTE1KTsKPiA+ICsJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1
KSkKPiA+ICsJCXZhbGxleXZpZXdfZGlzYWJsZV9ycHMoaTkxNSk7Cj4gPiArCWVsc2UgaWYgKElO
VEVMX0dFTihpOTE1KSA+PSA2KQo+ID4gKwkJZ2VuNl9kaXNhYmxlX3JwcyhpOTE1KTsKPiA+ICsJ
ZWxzZSBpZiAoSVNfSVJPTkxBS0VfTShpOTE1KSkKPiA+ICsJCWlyb25sYWtlX2Rpc2FibGVfZHJw
cyhpOTE1KTsKPiA+IC0JZGV2X3ByaXYtPmd0X3BtLnJwcy5lbmFibGVkID0gZmFsc2U7Cj4gPiAr
CWk5MTUtPmd0X3BtLnJwcy5lbmFibGVkID0gZmFsc2U7Cj4gPiAgIH0KPiA+IC12b2lkIGludGVs
X2Rpc2FibGVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
PiA+ICt2b2lkIGludGVsX2Rpc2FibGVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5ndF9wbS5ycHMu
bG9jayk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmd0X3BtLnJwcy5sb2NrKTsKPiA+IC0JaW50
ZWxfZGlzYWJsZV9yYzYoZGV2X3ByaXYpOwo+ID4gLQlpbnRlbF9kaXNhYmxlX3JwcyhkZXZfcHJp
dik7Cj4gPiAtCWlmIChIQVNfTExDKGRldl9wcml2KSkKPiA+IC0JCWludGVsX2Rpc2FibGVfbGxj
X3BzdGF0ZShkZXZfcHJpdik7Cj4gPiArCWludGVsX2Rpc2FibGVfcmM2KGk5MTUpOwo+ID4gKwlp
bnRlbF9kaXNhYmxlX3JwcyhpOTE1KTsKPiA+ICsJaWYgKEhBU19MTEMoaTkxNSkpCj4gPiArCQlp
bnRlbF9kaXNhYmxlX2xsY19wc3RhdGUoaTkxNSk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPmd0X3BtLnJwcy5sb2NrKTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5ndF9wbS5ycHMu
bG9jayk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGlubGluZSB2b2lkIGludGVsX2VuYWJsZV9sbGNf
cHN0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gQEAgLTg2OTgsNTEgKzg2
OTgsNTEgQEAgc3RhdGljIGlubGluZSB2b2lkIGludGVsX2VuYWJsZV9sbGNfcHN0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICAJaTkxNS0+Z3RfcG0ubGxjX3BzdGF0ZS5l
bmFibGVkID0gdHJ1ZTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9yYzYo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGludGVs
X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0J
bG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKPiA+ICsJbG9j
a2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+Z3RfcG0ucnBzLmxvY2spOwo+ID4gLQlpZiAoZGV2X3By
aXYtPmd0X3BtLnJjNi5lbmFibGVkKQo+ID4gKwlpZiAoaTkxNS0+Z3RfcG0ucmM2LmVuYWJsZWQp
Cj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCj4gPiAt
CQljaGVycnl2aWV3X2VuYWJsZV9yYzYoZGV2X3ByaXYpOwo+ID4gLQllbHNlIGlmIChJU19WQUxM
RVlWSUVXKGRldl9wcml2KSkKPiA+IC0JCXZhbGxleXZpZXdfZW5hYmxlX3JjNihkZXZfcHJpdik7
Cj4gPiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gPiAtCQlnZW4xMV9l
bmFibGVfcmM2KGRldl9wcml2KTsKPiA+IC0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA5KQo+ID4gLQkJZ2VuOV9lbmFibGVfcmM2KGRldl9wcml2KTsKPiA+IC0JZWxzZSBpZiAoSVNf
QlJPQURXRUxMKGRldl9wcml2KSkKPiA+IC0JCWdlbjhfZW5hYmxlX3JjNihkZXZfcHJpdik7Cj4g
PiAtCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikKPiA+IC0JCWdlbjZfZW5hYmxl
X3JjNihkZXZfcHJpdik7Cj4gPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKQo+ID4gKwkJY2hl
cnJ5dmlld19lbmFibGVfcmM2KGk5MTUpOwo+ID4gKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5
MTUpKQo+ID4gKwkJdmFsbGV5dmlld19lbmFibGVfcmM2KGk5MTUpOwo+ID4gKwllbHNlIGlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gMTEpCj4gPiArCQlnZW4xMV9lbmFibGVfcmM2KGk5MTUpOwo+ID4g
KwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiA+ICsJCWdlbjlfZW5hYmxlX3JjNihp
OTE1KTsKPiA+ICsJZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpKQo+ID4gKwkJZ2VuOF9lbmFi
bGVfcmM2KGk5MTUpOwo+ID4gKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKPiA+ICsJ
CWdlbjZfZW5hYmxlX3JjNihpOTE1KTsKPiA+IC0JZGV2X3ByaXYtPmd0X3BtLnJjNi5lbmFibGVk
ID0gdHJ1ZTsKPiA+ICsJaTkxNS0+Z3RfcG0ucmM2LmVuYWJsZWQgPSB0cnVlOwo+ID4gICB9Cj4g
PiAtc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAm
ZGV2X3ByaXYtPmd0X3BtLnJwczsKPiA+ICsJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5MTUt
Pmd0X3BtLnJwczsKPiA+ICAgCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnJwcy0+bG9jayk7Cj4gPiAg
IAlpZiAocnBzLT5lbmFibGVkKQo+ID4gICAJCXJldHVybjsKPiA+IC0JaWYgKElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpKSB7Cj4gPiAtCQljaGVycnl2aWV3X2VuYWJsZV9ycHMoZGV2X3ByaXYpOwo+
ID4gLQl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiAtCQl2YWxsZXl2
aWV3X2VuYWJsZV9ycHMoZGV2X3ByaXYpOwo+ID4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPj0gOSkgewo+ID4gLQkJZ2VuOV9lbmFibGVfcnBzKGRldl9wcml2KTsKPiA+IC0JfSBl
bHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Cj4gPiAtCQlnZW44X2VuYWJsZV9ycHMo
ZGV2X3ByaXYpOwo+ID4gLQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikgewo+
ID4gLQkJZ2VuNl9lbmFibGVfcnBzKGRldl9wcml2KTsKPiA+IC0JfSBlbHNlIGlmIChJU19JUk9O
TEFLRV9NKGRldl9wcml2KSkgewo+ID4gLQkJaXJvbmxha2VfZW5hYmxlX2RycHMoZGV2X3ByaXYp
Owo+ID4gLQkJaW50ZWxfaW5pdF9lbW9uKGRldl9wcml2KTsKPiA+ICsJaWYgKElTX0NIRVJSWVZJ
RVcoaTkxNSkpIHsKPiA+ICsJCWNoZXJyeXZpZXdfZW5hYmxlX3JwcyhpOTE1KTsKPiA+ICsJfSBl
bHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKSB7Cj4gPiArCQl2YWxsZXl2aWV3X2VuYWJsZV9y
cHMoaTkxNSk7Cj4gPiArCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpIHsKPiA+ICsJ
CWdlbjlfZW5hYmxlX3JwcyhpOTE1KTsKPiA+ICsJfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoaTkx
NSkpIHsKPiA+ICsJCWdlbjhfZW5hYmxlX3JwcyhpOTE1KTsKPiA+ICsJfSBlbHNlIGlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gNikgewo+ID4gKwkJZ2VuNl9lbmFibGVfcnBzKGk5MTUpOwo+ID4gKwl9
IGVsc2UgaWYgKElTX0lST05MQUtFX00oaTkxNSkpIHsKPiA+ICsJCWlyb25sYWtlX2VuYWJsZV9k
cnBzKGk5MTUpOwo+ID4gKwkJaW50ZWxfaW5pdF9lbW9uKGk5MTUpOwo+ID4gICAJfQo+ID4gICAJ
V0FSTl9PTihycHMtPm1heF9mcmVxIDwgcnBzLT5taW5fZnJlcSk7Cj4gPiBAQCAtODc1NCwyNSAr
ODc1NCwyNSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICAgCXJwcy0+ZW5hYmxlZCA9IHRydWU7Cj4gPiAgIH0KPiA+
IC12b2lkIGludGVsX2VuYWJsZV9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfZW5hYmxlX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJLyogUG93ZXJzYXZpbmcgaXMgY29u
dHJvbGxlZCBieSB0aGUgaG9zdCB3aGVuIGluc2lkZSBhIFZNICovCj4gPiAtCWlmIChpbnRlbF92
Z3B1X2FjdGl2ZShkZXZfcHJpdikpCj4gPiArCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShpOTE1KSkK
PiA+ICAgCQlyZXR1cm47Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5ndF9wbS5ycHMubG9j
ayk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPmd0X3BtLnJwcy5sb2NrKTsKPiA+IC0JaWYgKEhB
U19SQzYoZGV2X3ByaXYpKQo+ID4gLQkJaW50ZWxfZW5hYmxlX3JjNihkZXZfcHJpdik7Cj4gPiAt
CWlmIChIQVNfUlBTKGRldl9wcml2KSkKPiA+IC0JCWludGVsX2VuYWJsZV9ycHMoZGV2X3ByaXYp
Owo+ID4gLQlpZiAoSEFTX0xMQyhkZXZfcHJpdikpCj4gPiAtCQlpbnRlbF9lbmFibGVfbGxjX3Bz
dGF0ZShkZXZfcHJpdik7Cj4gPiArCWlmIChIQVNfUkM2KGk5MTUpKQo+ID4gKwkJaW50ZWxfZW5h
YmxlX3JjNihpOTE1KTsKPiA+ICsJaWYgKEhBU19SUFMoaTkxNSkpCj4gPiArCQlpbnRlbF9lbmFi
bGVfcnBzKGk5MTUpOwo+ID4gKwlpZiAoSEFTX0xMQyhpOTE1KSkKPiA+ICsJCWludGVsX2VuYWJs
ZV9sbGNfcHN0YXRlKGk5MTUpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5ndF9wbS5y
cHMubG9jayk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+Z3RfcG0ucnBzLmxvY2spOwo+ID4g
ICB9Cj4gPiAtc3RhdGljIHZvaWQgaWJ4X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpYnhfaW5pdF9jbG9ja19nYXRp
bmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCS8qCj4gPiAg
IAkgKiBPbiBJYmV4IFBlYWsgYW5kIENvdWdhciBQb2ludCwgd2UgbmVlZCB0byBkaXNhYmxlIGNs
b2NrCj4gPiBAQCAtODc4MiwxMSArODc4MiwxMSBAQCBzdGF0aWMgdm9pZCBpYnhfaW5pdF9jbG9j
a19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJSTkxNV9X
UklURShTT1VUSF9EU1BDTEtfR0FURV9ELCBQQ0hfRFBMU1VOSVRfQ0xPQ0tfR0FURV9ESVNBQkxF
KTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGc0eF9kaXNhYmxlX3RyaWNrbGVfZmVlZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgZzR4X2Rpc2Fi
bGVfdHJpY2tsZV9mZWVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAgIAllbnVtIHBpcGUgcGlwZTsKPiA+IC0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkg
ewo+ID4gKwlmb3JfZWFjaF9waXBlKGk5MTUsIHBpcGUpIHsKPiA+ICAgCQlJOTE1X1dSSVRFKERT
UENOVFIocGlwZSksCj4gPiAgIAkJCSAgIEk5MTVfUkVBRChEU1BDTlRSKHBpcGUpKSB8Cj4gPiAg
IAkJCSAgIERJU1BQTEFORV9UUklDS0xFX0ZFRURfRElTQUJMRSk7Cj4gPiBAQCAtODc5Niw3ICs4
Nzk2LDcgQEAgc3RhdGljIHZvaWQgZzR4X2Rpc2FibGVfdHJpY2tsZV9mZWVkKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCX0KPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lk
IGlsa19pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiArc3RhdGljIHZvaWQgaWxrX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIgZHNwY2xrX2dhdGUgPSBJTEtfVlJIVU5J
VF9DTE9DS19HQVRFX0RJU0FCTEU7Cj4gPiBAQCAtODgzNiw3ICs4ODM2LDcgQEAgc3RhdGljIHZv
aWQgaWxrX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICAgCSAqIFRoZSBiaXQgMjIgb2YgMHg0MjAwNAo+ID4gICAJICogVGhlIGJpdCA3LDgs
OSBvZiAweDQyMDIwLgo+ID4gICAJICovCj4gPiAtCWlmIChJU19JUk9OTEFLRV9NKGRldl9wcml2
KSkgewo+ID4gKwlpZiAoSVNfSVJPTkxBS0VfTShpOTE1KSkgewo+ID4gICAJCS8qIFdhRmJjQXN5
bmNoRmxpcERpc2FibGVGYmNRdWV1ZTppbGsgKi8KPiA+ICAgCQlJOTE1X1dSSVRFKElMS19ESVNQ
TEFZX0NISUNLRU4xLAo+ID4gICAJCQkgICBJOTE1X1JFQUQoSUxLX0RJU1BMQVlfQ0hJQ0tFTjEp
IHwKPiA+IEBAIC04ODYyLDEyICs4ODYyLDEyIEBAIHN0YXRpYyB2b2lkIGlsa19pbml0X2Nsb2Nr
X2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkvKiBXYURp
c2FibGVfUmVuZGVyQ2FjaGVfT3BlcmF0aW9uYWxGbHVzaDppbGsgKi8KPiA+ICAgCUk5MTVfV1JJ
VEUoQ0FDSEVfTU9ERV8wLCBfTUFTS0VEX0JJVF9ESVNBQkxFKFJDX09QX0ZMVVNIX0VOQUJMRSkp
Owo+ID4gLQlnNHhfZGlzYWJsZV90cmlja2xlX2ZlZWQoZGV2X3ByaXYpOwo+ID4gKwlnNHhfZGlz
YWJsZV90cmlja2xlX2ZlZWQoaTkxNSk7Cj4gPiAtCWlieF9pbml0X2Nsb2NrX2dhdGluZyhkZXZf
cHJpdik7Cj4gPiArCWlieF9pbml0X2Nsb2NrX2dhdGluZyhpOTE1KTsKPiA+ICAgfQo+ID4gLXN0
YXRpYyB2b2lkIGNwdF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgY3B0X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlpbnQgcGlwZTsKPiA+ICAgCXUz
MiB2YWw7Cj4gPiBAQCAtODg4NSwxMSArODg4NSwxMSBAQCBzdGF0aWMgdm9pZCBjcHRfaW5pdF9j
bG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJLyog
VGhlIGJlbG93IGZpeGVzIHRoZSB3ZWlyZCBkaXNwbGF5IGNvcnJ1cHRpb24sIGEgZmV3IHBpeGVs
cyBzaGlmdGVkCj4gPiAgIAkgKiBkb3dud2FyZCwgb24gKG9ubHkpIExWRFMgb2Ygc29tZSBIUCBs
YXB0b3BzIHdpdGggSVZZLgo+ID4gICAJICovCj4gPiAtCWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYs
IHBpcGUpIHsKPiA+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBlKSB7Cj4gPiAgIAkJdmFsID0g
STkxNV9SRUFEKFRSQU5TX0NISUNLRU4yKHBpcGUpKTsKPiA+ICAgCQl2YWwgfD0gVFJBTlNfQ0hJ
Q0tFTjJfVElNSU5HX09WRVJSSURFOwo+ID4gICAJCXZhbCAmPSB+VFJBTlNfQ0hJQ0tFTjJfRkRJ
X1BPTEFSSVRZX1JFVkVSU0VEOwo+ID4gLQkJaWYgKGRldl9wcml2LT52YnQuZmRpX3J4X3BvbGFy
aXR5X2ludmVydGVkKQo+ID4gKwkJaWYgKGk5MTUtPnZidC5mZGlfcnhfcG9sYXJpdHlfaW52ZXJ0
ZWQpCj4gPiAgIAkJCXZhbCB8PSBUUkFOU19DSElDS0VOMl9GRElfUE9MQVJJVFlfUkVWRVJTRUQ7
Cj4gPiAgIAkJdmFsICY9IH5UUkFOU19DSElDS0VOMl9GUkFNRV9TVEFSVF9ERUxBWV9NQVNLOwo+
ID4gICAJCXZhbCAmPSB+VFJBTlNfQ0hJQ0tFTjJfRElTQUJMRV9ERUVQX0NPTE9SX0NPVU5URVI7
Cj4gPiBAQCAtODg5NywxMyArODg5NywxMyBAQCBzdGF0aWMgdm9pZCBjcHRfaW5pdF9jbG9ja19n
YXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCUk5MTVfV1JJ
VEUoVFJBTlNfQ0hJQ0tFTjIocGlwZSksIHZhbCk7Cj4gPiAgIAl9Cj4gPiAgIAkvKiBXQURQMENs
b2NrR2F0aW5nRGlzYWJsZSAqLwo+ID4gLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7
Cj4gPiArCWZvcl9lYWNoX3BpcGUoaTkxNSwgcGlwZSkgewo+ID4gICAJCUk5MTVfV1JJVEUoVFJB
TlNfQ0hJQ0tFTjEocGlwZSksCj4gPiAgIAkJCSAgIFRSQU5TX0NISUNLRU4xX0RQMFVOSVRfR0Nf
RElTQUJMRSk7Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW42X2NoZWNrX21j
aF9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZv
aWQgZ2VuNl9jaGVja19tY2hfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4g
PiAgIHsKPiA+ICAgCXUzMiB0bXA7Cj4gPiBAQCAtODkxMyw3ICs4OTEzLDcgQEAgc3RhdGljIHZv
aWQgZ2VuNl9jaGVja19tY2hfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gICAJCQkgICAgICB0bXApOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuNl9pbml0
X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3Rh
dGljIHZvaWQgZ2VuNl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIGRzcGNsa19nYXRlID0gSUxLX1ZSSFVOSVRfQ0xPQ0tf
R0FURV9ESVNBQkxFOwo+ID4gQEAgLTkwMDAsMTQgKzkwMDAsMTQgQEAgc3RhdGljIHZvaWQgZ2Vu
Nl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiAgIAkJICAgSUxLX0RQQVJCVU5JVF9DTE9DS19HQVRFX0VOQUJMRSAgfAo+ID4gICAJCSAgIElM
S19EUEZEVU5JVF9DTE9DS19HQVRFX0VOQUJMRSk7Cj4gPiAtCWc0eF9kaXNhYmxlX3RyaWNrbGVf
ZmVlZChkZXZfcHJpdik7Cj4gPiArCWc0eF9kaXNhYmxlX3RyaWNrbGVfZmVlZChpOTE1KTsKPiA+
IC0JY3B0X2luaXRfY2xvY2tfZ2F0aW5nKGRldl9wcml2KTsKPiA+ICsJY3B0X2luaXRfY2xvY2tf
Z2F0aW5nKGk5MTUpOwo+ID4gLQlnZW42X2NoZWNrX21jaF9zZXR1cChkZXZfcHJpdik7Cj4gPiAr
CWdlbjZfY2hlY2tfbWNoX3NldHVwKGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2Vu
N19zZXR1cF9maXhlZF9mdW5jX3NjaGVkdWxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgZ2VuN19zZXR1cF9maXhlZF9mdW5jX3NjaGVkdWxlcihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIHJlZyA9IEk5
MTVfUkVBRChHRU43X0ZGX1RIUkVBRF9NT0RFKTsKPiA+IEBAIC05MDI1LDEzICs5MDI1LDEzIEBA
IHN0YXRpYyB2b2lkIGdlbjdfc2V0dXBfZml4ZWRfZnVuY19zY2hlZHVsZXIoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJSTkxNV9XUklURShHRU43X0ZGX1RIUkVBRF9N
T0RFLCByZWcpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgbHB0X2luaXRfY2xvY2tfZ2F0aW5n
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBscHRf
aW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsK
PiA+ICAgCS8qCj4gPiAgIAkgKiBUT0RPOiB0aGlzIGJpdCBzaG91bGQgb25seSBiZSBlbmFibGVk
IHdoZW4gcmVhbGx5IG5lZWRlZCwgdGhlbgo+ID4gICAJICogZGlzYWJsZWQgd2hlbiBub3QgbmVl
ZGVkIGFueW1vcmUgaW4gb3JkZXIgdG8gc2F2ZSBwb3dlci4KPiA+ICAgCSAqLwo+ID4gLQlpZiAo
SEFTX1BDSF9MUFRfTFAoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSEFTX1BDSF9MUFRfTFAoaTkxNSkp
Cj4gPiAgIAkJSTkxNV9XUklURShTT1VUSF9EU1BDTEtfR0FURV9ELAo+ID4gICAJCQkgICBJOTE1
X1JFQUQoU09VVEhfRFNQQ0xLX0dBVEVfRCkgfAo+ID4gICAJCQkgICBQQ0hfTFBfUEFSVElUSU9O
X0xFVkVMX0RJU0FCTEUpOwo+ID4gQEAgLTkwNDIsOSArOTA0Miw5IEBAIHN0YXRpYyB2b2lkIGxw
dF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiAgIAkJICAgVFJBTlNfQ0hJQ0tFTjFfRFAwVU5JVF9HQ19ESVNBQkxFKTsKPiA+ICAgfQo+ID4g
LXN0YXRpYyB2b2lkIGxwdF9zdXNwZW5kX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtzdGF0aWMgdm9pZCBscHRfc3VzcGVuZF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlpZiAoSEFTX1BDSF9MUFRfTFAoZGV2X3ByaXYpKSB7
Cj4gPiArCWlmIChIQVNfUENIX0xQVF9MUChpOTE1KSkgewo+ID4gICAJCXUzMiB2YWwgPSBJOTE1
X1JFQUQoU09VVEhfRFNQQ0xLX0dBVEVfRCk7Cj4gPiAgIAkJdmFsICY9IH5QQ0hfTFBfUEFSVElU
SU9OX0xFVkVMX0RJU0FCTEU7Cj4gPiBAQCAtOTA1Miw3ICs5MDUyLDcgQEAgc3RhdGljIHZvaWQg
bHB0X3N1c3BlbmRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJ
fQo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgZ2VuOF9zZXRfbDNzcWNfY3JlZGl0cyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIHZvaWQgZ2VuOF9zZXRfbDNz
cWNfY3JlZGl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgIGlu
dCBnZW5lcmFsX3ByaW9fY3JlZGl0cywKPiA+ICAgCQkJCSAgIGludCBoaWdoX3ByaW9fY3JlZGl0
cykKPiA+ICAgewo+ID4gQEAgLTkwNzgsNyArOTA3OCw3IEBAIHN0YXRpYyB2b2lkIGdlbjhfc2V0
X2wzc3FjX2NyZWRpdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
STkxNV9XUklURShHRU43X01JU0NDUENUTCwgbWlzY2NwY3RsKTsKPiA+ICAgfQo+ID4gLXN0YXRp
YyB2b2lkIGljbF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaWNsX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAkvKiBUaGlzIGlzIG5vdCBhbiBXYS4g
RW5hYmxlIHRvIHJlZHVjZSBTYW1wbGVyIHBvd2VyICovCj4gPiAgIAlJOTE1X1dSSVRFKEdFTjEw
X0RGUl9SQVRJT19FTl9BTkRfQ0hJQ0tFTiwKPiA+IEBAIC05MDg5LDkgKzkwODksOSBAQCBzdGF0
aWMgdm9pZCBpY2xfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJCSAgIF9NQVNLRURfQklUX0VOQUJMRShHRU4xMV9FTkFCTEVfMzJfUExB
TkVfTU9ERSkpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgY25wX2luaXRfY2xvY2tfZ2F0aW5n
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBjbnBf
aW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsK
PiA+IC0JaWYgKCFIQVNfUENIX0NOUChkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX1BDSF9DTlAo
aTkxNSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJLyogRGlzcGxheSBXQSAjMTE4MSBXYVNvdXRo
RGlzcGxheURpc2FibGVQV01DR0VHYXRpbmc6IGNucCAqLwo+ID4gQEAgLTkwOTksMTAgKzkwOTks
MTAgQEAgc3RhdGljIHZvaWQgY25wX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgICBDTlBfUFdNX0NHRV9HQVRJTkdfRElTQUJMRSk7
Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBjbmxfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGNubF9pbml0X2Nsb2Nr
X2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMy
IHZhbDsKPiA+IC0JY25wX2luaXRfY2xvY2tfZ2F0aW5nKGRldl9wcml2KTsKPiA+ICsJY25wX2lu
aXRfY2xvY2tfZ2F0aW5nKGk5MTUpOwo+ID4gICAJLyogVGhpcyBpcyBub3QgYW4gV2EuIEVuYWJs
ZSBmb3IgYmV0dGVyIGltYWdlIHF1YWxpdHkgKi8KPiA+ICAgCUk5MTVfV1JJVEUoXzNEX0NISUNL
RU4zLAo+ID4gQEAgLTkxMjAsNyArOTEyMCw3IEBAIHN0YXRpYyB2b2lkIGNubF9pbml0X2Nsb2Nr
X2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkvKiBSZWFk
SGl0V3JpdGVPbmx5RGlzYWJsZTpjbmwgKi8KPiA+ICAgCXZhbCB8PSBSQ0NVTklUX0NMS0dBVEVf
RElTOwo+ID4gICAJLyogV2FTYXJiVW5pdENsb2NrR2F0aW5nRGlzYWJsZTpjbmwgKHByZS1wcm9k
KSAqLwo+ID4gLQlpZiAoSVNfQ05MX1JFVklEKGRldl9wcml2LCBDTkxfUkVWSURfQTAsIENOTF9S
RVZJRF9CMCkpCj4gPiArCWlmIChJU19DTkxfUkVWSUQoaTkxNSwgQ05MX1JFVklEX0EwLCBDTkxf
UkVWSURfQjApKQo+ID4gICAJCXZhbCB8PSBTQVJCVU5JVF9DTEtHQVRFX0RJUzsKPiA+ICAgCUk5
MTVfV1JJVEUoU0xJQ0VfVU5JVF9MRVZFTF9DTEtHQVRFLCB2YWwpOwo+ID4gQEAgLTkxMzYsMjcg
KzkxMzYsMjcgQEAgc3RhdGljIHZvaWQgY25sX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCUk5MTVfV1JJVEUoVU5TTElDRV9VTklUX0xF
VkVMX0NMS0dBVEUsIHZhbCk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBjZmxfaW5pdF9jbG9j
a19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2
b2lkIGNmbF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
PiA+ICAgewo+ID4gLQljbnBfaW5pdF9jbG9ja19nYXRpbmcoZGV2X3ByaXYpOwo+ID4gLQlnZW45
X2luaXRfY2xvY2tfZ2F0aW5nKGRldl9wcml2KTsKPiA+ICsJY25wX2luaXRfY2xvY2tfZ2F0aW5n
KGk5MTUpOwo+ID4gKwlnZW45X2luaXRfY2xvY2tfZ2F0aW5nKGk5MTUpOwo+ID4gICAJLyogV2FG
YmNOdWtlT25Ib3N0TW9kaWZ5OmNmbCAqLwo+ID4gICAJSTkxNV9XUklURShJTEtfRFBGQ19DSElD
S0VOLCBJOTE1X1JFQUQoSUxLX0RQRkNfQ0hJQ0tFTikgfAo+ID4gICAJCSAgIElMS19EUEZDX05V
S0VfT05fQU5ZX01PRElGSUNBVElPTik7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBrYmxfaW5p
dF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0
YXRpYyB2b2lkIGtibF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICAgewo+ID4gLQlnZW45X2luaXRfY2xvY2tfZ2F0aW5nKGRldl9wcml2KTsKPiA+
ICsJZ2VuOV9pbml0X2Nsb2NrX2dhdGluZyhpOTE1KTsKPiA+ICAgCS8qIFdhRGlzYWJsZVNERVVu
aXRDbG9ja0dhdGluZzprYmwgKi8KPiA+IC0JaWYgKElTX0tCTF9SRVZJRChkZXZfcHJpdiwgMCwg
S0JMX1JFVklEX0IwKSkKPiA+ICsJaWYgKElTX0tCTF9SRVZJRChpOTE1LCAwLCBLQkxfUkVWSURf
QjApKQo+ID4gICAJCUk5MTVfV1JJVEUoR0VOOF9VQ0dDVEw2LCBJOTE1X1JFQUQoR0VOOF9VQ0dD
VEw2KSB8Cj4gPiAgIAkJCSAgIEdFTjhfU0RFVU5JVF9DTE9DS19HQVRFX0RJU0FCTEUpOwo+ID4g
ICAJLyogV2FEaXNhYmxlR2FtQ2xvY2tHYXRpbmc6a2JsICovCj4gPiAtCWlmIChJU19LQkxfUkVW
SUQoZGV2X3ByaXYsIDAsIEtCTF9SRVZJRF9CMCkpCj4gPiArCWlmIChJU19LQkxfUkVWSUQoaTkx
NSwgMCwgS0JMX1JFVklEX0IwKSkKPiA+ICAgCQlJOTE1X1dSSVRFKEdFTjZfVUNHQ1RMMSwgSTkx
NV9SRUFEKEdFTjZfVUNHQ1RMMSkgfAo+ID4gICAJCQkgICBHRU42X0dBTVVOSVRfQ0xPQ0tfR0FU
RV9ESVNBQkxFKTsKPiA+IEBAIC05MTY1LDkgKzkxNjUsOSBAQCBzdGF0aWMgdm9pZCBrYmxfaW5p
dF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJ
CSAgIElMS19EUEZDX05VS0VfT05fQU5ZX01PRElGSUNBVElPTik7Cj4gPiAgIH0KPiA+IC1zdGF0
aWMgdm9pZCBza2xfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIHNrbF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlnZW45X2luaXRfY2xvY2tfZ2F0aW5n
KGRldl9wcml2KTsKPiA+ICsJZ2VuOV9pbml0X2Nsb2NrX2dhdGluZyhpOTE1KTsKPiA+ICAgCS8q
IFdBQzZlbnRyeWxhdGVuY3k6c2tsICovCj4gPiAgIAlJOTE1X1dSSVRFKEZCQ19MTENfUkVBRF9D
VFJMLCBJOTE1X1JFQUQoRkJDX0xMQ19SRUFEX0NUUkwpIHwKPiA+IEBAIC05MTc4LDEwICs5MTc4
LDEwIEBAIHN0YXRpYyB2b2lkIHNrbF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICAgSUxLX0RQRkNfTlVLRV9PTl9BTllfTU9ESUZJ
Q0FUSU9OKTsKPiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGJkd19pbml0X2Nsb2NrX2dhdGluZyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgYmR3X2lu
aXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4g
PiAgIAkvKiBUaGUgR1RUIGNhY2hlIG11c3QgYmUgZGlzYWJsZWQgaWYgdGhlIHN5c3RlbSBpcyB1
c2luZyAyTSBwYWdlcy4gKi8KPiA+IC0JYm9vbCBjYW5fdXNlX2d0dF9jYWNoZSA9ICFIQVNfUEFH
RV9TSVpFUyhkZXZfcHJpdiwKPiA+ICsJYm9vbCBjYW5fdXNlX2d0dF9jYWNoZSA9ICFIQVNfUEFH
RV9TSVpFUyhpOTE1LAo+ID4gICAJCQkJCQkgSTkxNV9HVFRfUEFHRV9TSVpFXzJNKTsKPiA+ICAg
CWVudW0gcGlwZSBwaXBlOwo+ID4gQEAgLTkxOTMsNyArOTE5Myw3IEBAIHN0YXRpYyB2b2lkIGJk
d19pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4g
PiAgIAkJICAgSTkxNV9SRUFEKENISUNLRU5fUEFSMV8xKSB8IERQQV9NQVNLX1ZCTEFOS19TUkQp
Owo+ID4gICAJLyogV2FQc3JEUFJTVW5tYXNrVkJsYW5rSW5TUkQ6YmR3ICovCj4gPiAtCWZvcl9l
YWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKPiA+ICsJZm9yX2VhY2hfcGlwZShpOTE1LCBwaXBl
KSB7Cj4gPiAgIAkJSTkxNV9XUklURShDSElDS0VOX1BJUEVTTF8xKHBpcGUpLAo+ID4gICAJCQkg
ICBJOTE1X1JFQUQoQ0hJQ0tFTl9QSVBFU0xfMShwaXBlKSkgfAo+ID4gICAJCQkgICBCRFdfRFBS
U19NQVNLX1ZCTEFOS19TUkQpOwo+ID4gQEAgLTkyMTMsNyArOTIxMyw3IEBAIHN0YXRpYyB2b2lk
IGJkd19pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Cj4gPiAgIAkJICAgR0VOOF9TREVVTklUX0NMT0NLX0dBVEVfRElTQUJMRSk7Cj4gPiAgIAkvKiBX
YVByb2dyYW1MM1NxY1JlZzFEZWZhdWx0OmJkdyAqLwo+ID4gLQlnZW44X3NldF9sM3NxY19jcmVk
aXRzKGRldl9wcml2LCAzMCwgMik7Cj4gPiArCWdlbjhfc2V0X2wzc3FjX2NyZWRpdHMoaTkxNSwg
MzAsIDIpOwo+ID4gICAJLyogV2FHdHRDYWNoaW5nT2ZmQnlEZWZhdWx0OmJkdyAqLwo+ID4gICAJ
STkxNV9XUklURShIU1dfR1RUX0NBQ0hFX0VOLCBjYW5fdXNlX2d0dF9jYWNoZSA/IEdUVF9DQUNI
RV9FTl9BTEwgOiAwKTsKPiA+IEBAIC05MjIyLDcgKzkyMjIsNyBAQCBzdGF0aWMgdm9pZCBiZHdf
aW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4g
ICAJSTkxNV9XUklURShDSElDS0VOX1BBUjJfMSwgSTkxNV9SRUFEKENISUNLRU5fUEFSMl8xKQo+
ID4gICAJCSAgIHwgS1ZNX0NPTkZJR19DSEFOR0VfTk9USUZJQ0FUSU9OX1NFTEVDVCk7Cj4gPiAt
CWxwdF9pbml0X2Nsb2NrX2dhdGluZyhkZXZfcHJpdik7Cj4gPiArCWxwdF9pbml0X2Nsb2NrX2dh
dGluZyhpOTE1KTsKPiA+ICAgCS8qIFdhRGlzYWJsZURvcENsb2NrR2F0aW5nOmJkdwo+ID4gICAJ
ICoKPiA+IEBAIC05MjMzLDcgKzkyMzMsNyBAQCBzdGF0aWMgdm9pZCBiZHdfaW5pdF9jbG9ja19n
YXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCSAgIEk5MTVf
UkVBRChHRU42X1VDR0NUTDEpIHwgR0VONl9FVV9UQ1VOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFKTsK
PiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGhzd19pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaHN3X2luaXRfY2xvY2tf
Z2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAkvKiBM
MyBjYWNoaW5nIG9mIGRhdGEgYXRvbWljcyBkb2Vzbid0IHdvcmsgLS0gZGlzYWJsZSBpdC4gKi8K
PiA+ICAgCUk5MTVfV1JJVEUoSFNXX1NDUkFUQ0gxLCBIU1dfU0NSQVRDSDFfTDNfREFUQV9BVE9N
SUNTX0RJU0FCTEUpOwo+ID4gQEAgLTkyNzgsMTAgKzkyNzgsMTAgQEAgc3RhdGljIHZvaWQgaHN3
X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCS8qIFdhU3dpdGNoU29sVmZGQXJiaXRyYXRpb25Qcmlvcml0eTpoc3cgKi8KPiA+ICAgCUk5
MTVfV1JJVEUoR0FNX0VDT0NISywgSTkxNV9SRUFEKEdBTV9FQ09DSEspIHwgSFNXX0VDT0NIS19B
UkJfUFJJT19TT0wpOwo+ID4gLQlscHRfaW5pdF9jbG9ja19nYXRpbmcoZGV2X3ByaXYpOwo+ID4g
KwlscHRfaW5pdF9jbG9ja19nYXRpbmcoaTkxNSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBp
dmJfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gK3N0YXRpYyB2b2lkIGl2Yl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJdTMyIHNucGNyOwo+ID4gQEAgLTkyOTcsNyArOTI5
Nyw3IEBAIHN0YXRpYyB2b2lkIGl2Yl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICAgQ0hJQ0tFTjNfREdNR19ET05FX0ZJWF9ESVNB
QkxFKTsKPiA+ICAgCS8qIFdhRGlzYWJsZVBTRER1YWxEaXNwYXRjaEVuYWJsZTppdmIgKi8KPiA+
IC0JaWYgKElTX0lWQl9HVDEoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfSVZCX0dUMShpOTE1KSkK
PiA+ICAgCQlJOTE1X1dSSVRFKEdFTjdfSEFMRl9TTElDRV9DSElDS0VOMSwKPiA+ICAgCQkJICAg
X01BU0tFRF9CSVRfRU5BQkxFKEdFTjdfUFNEX1NJTkdMRV9QT1JUX0RJU1BBVENIX0VOQUJMRSkp
Owo+ID4gQEAgLTkzMTMsNyArOTMxMyw3IEBAIHN0YXRpYyB2b2lkIGl2Yl9pbml0X2Nsb2NrX2dh
dGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJCUdFTjdfV0Ff
Rk9SX0dFTjdfTDNfQ09OVFJPTCk7Cj4gPiAgIAlJOTE1X1dSSVRFKEdFTjdfTDNfQ0hJQ0tFTl9N
T0RFX1JFR0lTVEVSLAo+ID4gICAJCSAgIEdFTjdfV0FfTDNfQ0hJQ0tFTl9NT0RFKTsKPiA+IC0J
aWYgKElTX0lWQl9HVDEoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfSVZCX0dUMShpOTE1KSkKPiA+
ICAgCQlJOTE1X1dSSVRFKEdFTjdfUk9XX0NISUNLRU4yLAo+ID4gICAJCQkgICBfTUFTS0VEX0JJ
VF9FTkFCTEUoRE9QX0NMT0NLX0dBVElOR19ESVNBQkxFKSk7Cj4gPiAgIAllbHNlIHsKPiA+IEBA
IC05MzQwLDkgKzkzNDAsOSBAQCBzdGF0aWMgdm9pZCBpdmJfaW5pdF9jbG9ja19nYXRpbmcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCQlJOTE1X1JFQUQoR0VON19T
UV9DSElDS0VOX01CQ1VOSVRfQ09ORklHKSB8Cj4gPiAgIAkJCUdFTjdfU1FfQ0hJQ0tFTl9NQkNV
TklUX1NRSU5UTU9CKTsKPiA+IC0JZzR4X2Rpc2FibGVfdHJpY2tsZV9mZWVkKGRldl9wcml2KTsK
PiA+ICsJZzR4X2Rpc2FibGVfdHJpY2tsZV9mZWVkKGk5MTUpOwo+ID4gLQlnZW43X3NldHVwX2Zp
eGVkX2Z1bmNfc2NoZWR1bGVyKGRldl9wcml2KTsKPiA+ICsJZ2VuN19zZXR1cF9maXhlZF9mdW5j
X3NjaGVkdWxlcihpOTE1KTsKPiA+ICAgCWlmICgwKSB7IC8qIGNhdXNlcyBIaVogY29ycnVwdGlv
biBvbiBpdmI6Z3QxICovCj4gPiAgIAkJLyogZW5hYmxlIEhpWiBSYXcgU3RhbGwgT3B0aW1pemF0
aW9uICovCj4gPiBAQCAtOTM3MCwxMyArOTM3MCwxMyBAQCBzdGF0aWMgdm9pZCBpdmJfaW5pdF9j
bG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJc25w
Y3IgfD0gR0VONl9NQkNfU05QQ1JfTUVEOwo+ID4gICAJSTkxNV9XUklURShHRU42X01CQ1VOSVRf
U05QQ1IsIHNucGNyKTsKPiA+IC0JaWYgKCFIQVNfUENIX05PUChkZXZfcHJpdikpCj4gPiAtCQlj
cHRfaW5pdF9jbG9ja19nYXRpbmcoZGV2X3ByaXYpOwo+ID4gKwlpZiAoIUhBU19QQ0hfTk9QKGk5
MTUpKQo+ID4gKwkJY3B0X2luaXRfY2xvY2tfZ2F0aW5nKGk5MTUpOwo+ID4gLQlnZW42X2NoZWNr
X21jaF9zZXR1cChkZXZfcHJpdik7Cj4gPiArCWdlbjZfY2hlY2tfbWNoX3NldHVwKGk5MTUpOwo+
ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgdmx2X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCB2bHZfaW5pdF9jbG9ja19n
YXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCS8qIFdh
RGlzYWJsZUVhcmx5Q3VsbDp2bHYgKi8KPiA+ICAgCUk5MTVfV1JJVEUoXzNEX0NISUNLRU4zLAo+
ID4gQEAgLTk0MDksNyArOTQwOSw3IEBAIHN0YXRpYyB2b2lkIHZsdl9pbml0X2Nsb2NrX2dhdGlu
ZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJICAgSTkxNV9SRUFE
KEdFTjdfU1FfQ0hJQ0tFTl9NQkNVTklUX0NPTkZJRykgfAo+ID4gICAJCSAgIEdFTjdfU1FfQ0hJ
Q0tFTl9NQkNVTklUX1NRSU5UTU9CKTsKPiA+IC0JZ2VuN19zZXR1cF9maXhlZF9mdW5jX3NjaGVk
dWxlcihkZXZfcHJpdik7Cj4gPiArCWdlbjdfc2V0dXBfZml4ZWRfZnVuY19zY2hlZHVsZXIoaTkx
NSk7Cj4gPiAgIAkvKgo+ID4gICAJICogQWNjb3JkaW5nIHRvIHRoZSBzcGVjLCBiaXQgMTMgKFJD
WlVOSVQpIG11c3QgYmUgc2V0IG9uIElWQi4KPiA+IEBAIC05NDU2LDcgKzk0NTYsNyBAQCBzdGF0
aWMgdm9pZCB2bHZfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+ID4gICAJSTkxNV9XUklURShWTFZfR1VOSVRfQ0xPQ0tfR0FURSwgR0NGR19ESVMp
Owo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgY2h2X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBjaHZfaW5pdF9jbG9j
a19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCS8q
IFdhVlNSZWZDb3VudEZ1bGxmb3JjZU1pc3NEaXNhYmxlOmNodiAqLwo+ID4gICAJLyogV2FEU1Jl
ZkNvdW50RnVsbGZvcmNlTWlzc0Rpc2FibGU6Y2h2ICovCj4gPiBAQCAtOTQ4MSw3ICs5NDgxLDcg
QEAgc3RhdGljIHZvaWQgY2h2X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIFNlZSBnZnhzcGVjcy9SZWxhdGVkIERvY3VtZW50cy9Q
ZXJmb3JtYW5jZSBHdWlkZS8KPiA+ICAgCSAqIExTUUMgU2V0dGluZyBSZWNvbW1lbmRhdGlvbnMu
Cj4gPiAgIAkgKi8KPiA+IC0JZ2VuOF9zZXRfbDNzcWNfY3JlZGl0cyhkZXZfcHJpdiwgMzgsIDIp
Owo+ID4gKwlnZW44X3NldF9sM3NxY19jcmVkaXRzKGk5MTUsIDM4LCAyKTsKPiA+ICAgCS8qCj4g
PiAgIAkgKiBHVFQgY2FjaGUgbWF5IG5vdCB3b3JrIHdpdGggYmlnIHBhZ2VzLCBzbyBpZiB0aG9z
ZQo+ID4gQEAgLTk0OTAsNyArOTQ5MCw3IEBAIHN0YXRpYyB2b2lkIGNodl9pbml0X2Nsb2NrX2dh
dGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAlJOTE1X1dSSVRF
KEhTV19HVFRfQ0FDSEVfRU4sIEdUVF9DQUNIRV9FTl9BTEwpOwo+ID4gICB9Cj4gPiAtc3RhdGlj
IHZvaWQgZzR4X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICtzdGF0aWMgdm9pZCBnNHhfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiBkc3BjbGtfZ2F0ZTsKPiA+IEBA
IC05NTAyLDcgKzk1MDIsNyBAQCBzdGF0aWMgdm9pZCBnNHhfaW5pdF9jbG9ja19nYXRpbmcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJZHNwY2xrX2dhdGUgPSBWUkhV
TklUX0NMT0NLX0dBVEVfRElTQUJMRSB8Cj4gPiAgIAkJT1ZSVU5JVF9DTE9DS19HQVRFX0RJU0FC
TEUgfAo+ID4gICAJCU9WQ1VOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFOwo+ID4gLQlpZiAoSVNfR000
NShkZXZfcHJpdikpCj4gPiArCWlmIChJU19HTTQ1KGk5MTUpKQo+ID4gICAJCWRzcGNsa19nYXRl
IHw9IERTU1VOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFOwo+ID4gICAJSTkxNV9XUklURShEU1BDTEtf
R0FURV9ELCBkc3BjbGtfZ2F0ZSk7Cj4gPiBAQCAtOTUxMywxMiArOTUxMywxMiBAQCBzdGF0aWMg
dm9pZCBnNHhfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gICAJLyogV2FEaXNhYmxlX1JlbmRlckNhY2hlX09wZXJhdGlvbmFsRmx1c2g6ZzR4
ICovCj4gPiAgIAlJOTE1X1dSSVRFKENBQ0hFX01PREVfMCwgX01BU0tFRF9CSVRfRElTQUJMRShS
Q19PUF9GTFVTSF9FTkFCTEUpKTsKPiA+IC0JZzR4X2Rpc2FibGVfdHJpY2tsZV9mZWVkKGRldl9w
cml2KTsKPiA+ICsJZzR4X2Rpc2FibGVfdHJpY2tsZV9mZWVkKGk5MTUpOwo+ID4gICB9Cj4gPiAt
c3RhdGljIHZvaWQgaTk2NWdtX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9pZCBpOTY1Z21faW5pdF9jbG9ja19nYXRpbmco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVs
X3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4gPiArCXN0cnVjdCBpbnRlbF91
bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7Cj4gPiAgIAlpbnRlbF91bmNvcmVfd3JpdGUo
dW5jb3JlLCBSRU5DTEtfR0FURV9EMSwgSTk2NV9SQ0NfQ0xPQ0tfR0FURV9ESVNBQkxFKTsKPiA+
ICAgCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIFJFTkNMS19HQVRFX0QyLCAwKTsKPiA+IEBA
IC05NTM1LDcgKzk1MzUsNyBAQCBzdGF0aWMgdm9pZCBpOTY1Z21faW5pdF9jbG9ja19nYXRpbmco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCQkgICBfTUFTS0VEX0JJ
VF9ESVNBQkxFKFJDX09QX0ZMVVNIX0VOQUJMRSkpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQg
aTk2NWdfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gK3N0YXRpYyB2b2lkIGk5NjVnX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAlJOTE1X1dSSVRFKFJFTkNMS19HQVRFX0Qx
LCBJOTY1X1JDWl9DTE9DS19HQVRFX0RJU0FCTEUgfAo+ID4gICAJCSAgIEk5NjVfUkNDX0NMT0NL
X0dBVEVfRElTQUJMRSB8Cj4gPiBAQCAtOTU1MCw3ICs5NTUwLDcgQEAgc3RhdGljIHZvaWQgaTk2
NWdfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ID4gICAJSTkxNV9XUklURShDQUNIRV9NT0RFXzAsIF9NQVNLRURfQklUX0RJU0FCTEUoUkNfT1Bf
RkxVU0hfRU5BQkxFKSk7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBnZW4zX2luaXRfY2xvY2tf
Z2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgdm9p
ZCBnZW4zX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAgIAl1MzIgZHN0YXRlID0gSTkxNV9SRUFEKERfU1RBVEUpOwo+ID4gQEAgLTk1
NTgsNyArOTU1OCw3IEBAIHN0YXRpYyB2b2lkIGdlbjNfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCURTVEFURV9ET1RfQ0xPQ0tfR0FU
SU5HOwo+ID4gICAJSTkxNV9XUklURShEX1NUQVRFLCBkc3RhdGUpOwo+ID4gLQlpZiAoSVNfUElO
RVZJRVcoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfUElORVZJRVcoaTkxNSkpCj4gPiAgIAkJSTkx
NV9XUklURShFQ09TS1BELCBfTUFTS0VEX0JJVF9FTkFCTEUoRUNPX0dBVElOR19DWF9PTkxZKSk7
Cj4gPiAgIAkvKiBJSVIgImZsaXAgcGVuZGluZyIgbWVhbnMgZG9uZSBpZiB0aGlzIGJpdCBpcyBz
ZXQgKi8KPiA+IEBAIC05NTc0LDcgKzk1NzQsNyBAQCBzdGF0aWMgdm9pZCBnZW4zX2luaXRfY2xv
Y2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCQkgICBf
TUFTS0VEX0JJVF9FTkFCTEUoTUlfQVJCX0RJU1BMQVlfVFJJQ0tMRV9GRUVEX0RJU0FCTEUpKTsK
PiA+ICAgfQo+ID4gLXN0YXRpYyB2b2lkIGk4NXhfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lkIGk4NXhfaW5pdF9jbG9j
a19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCUk5
MTVfV1JJVEUoUkVOQ0xLX0dBVEVfRDEsIFNWX0NMT0NLX0dBVEVfRElTQUJMRSk7Cj4gPiBAQCAt
OTU4NiwxNjggKzk1ODYsMTY4IEBAIHN0YXRpYyB2b2lkIGk4NXhfaW5pdF9jbG9ja19nYXRpbmco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gICAJCSAgIF9NQVNLRURfQklU
X0VOQUJMRShNRU1fRElTUExBWV9UUklDS0xFX0ZFRURfRElTQUJMRSkpOwo+ID4gICB9Cj4gPiAt
c3RhdGljIHZvaWQgaTgzMF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaTgzMF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJSTkxNV9XUklURShNRU1f
TU9ERSwKPiA+ICAgCQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoTUVNX0RJU1BMQVlfQV9UUklDS0xF
X0ZFRURfRElTQUJMRSkgfAo+ID4gICAJCSAgIF9NQVNLRURfQklUX0VOQUJMRShNRU1fRElTUExB
WV9CX1RSSUNLTEVfRkVFRF9ESVNBQkxFKSk7Cj4gPiAgIH0KPiA+IC12b2lkIGludGVsX2luaXRf
Y2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lk
IGludGVsX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+
ID4gICB7Cj4gPiAtCWRldl9wcml2LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nKGRldl9wcml2
KTsKPiA+ICsJaTkxNS0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyhpOTE1KTsKPiA+ICAgfQo+
ID4gLXZvaWQgaW50ZWxfc3VzcGVuZF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCj4gPiArdm9pZCBpbnRlbF9zdXNwZW5kX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAtCWlmIChIQVNfUENIX0xQVChkZXZfcHJpdikpCj4gPiAtCQlscHRf
c3VzcGVuZF9odyhkZXZfcHJpdik7Cj4gPiArCWlmIChIQVNfUENIX0xQVChpOTE1KSkKPiA+ICsJ
CWxwdF9zdXNwZW5kX2h3KGk5MTUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgbm9wX2luaXRf
Y2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0
aWMgdm9pZCBub3BfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gPiAgIHsKPiA+ICAgCURSTV9ERUJVR19LTVMoIk5vIGNsb2NrIGdhdGluZyBzZXR0aW5n
cyBvciB3b3JrYXJvdW5kcyBhcHBsaWVkLlxuIik7Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiAgICAq
IGludGVsX2luaXRfY2xvY2tfZ2F0aW5nX2hvb2tzIC0gc2V0dXAgdGhlIGNsb2NrIGdhdGluZyBo
b29rcwo+ID4gLSAqIEBkZXZfcHJpdjogZGV2aWNlIHByaXZhdGUKPiA+ICsgKiBAaTkxNTogZGV2
aWNlIHByaXZhdGUKPiA+ICAgICoKPiA+ICAgICogU2V0dXAgdGhlIGhvb2tzIHRoYXQgY29uZmln
dXJlIHdoaWNoIGNsb2NrcyBvZiBhIGdpdmVuIHBsYXRmb3JtIGNhbiBiZQo+ID4gICAgKiBnYXRl
ZCBhbmQgYWxzbyBhcHBseSB2YXJpb3VzIEdUIGFuZCBkaXNwbGF5IHNwZWNpZmljIHdvcmthcm91
bmRzIGZvciB0aGVzZQo+ID4gICAgKiBwbGF0Zm9ybXMuIE5vdGUgdGhhdCBzb21lIEdUIHNwZWNp
ZmljIHdvcmthcm91bmRzIGFyZSBhcHBsaWVkIHNlcGFyYXRlbHkKPiA+ICAgICogd2hlbiBHUFUg
Y29udGV4dHMgb3IgYmF0Y2hidWZmZXJzIHN0YXJ0IHRoZWlyIGV4ZWN1dGlvbi4KPiA+ICAgICov
Cj4gPiAtdm9pZCBpbnRlbF9pbml0X2Nsb2NrX2dhdGluZ19ob29rcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAtewo+ID4gLQlpZiAoSVNfR0VOKGRldl9wcml2LCAxMSkp
Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGljbF9pbml0X2Ns
b2NrX2dhdGluZzsKPiA+IC0JZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikpCj4gPiAt
CQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGNubF9pbml0X2Nsb2NrX2dh
dGluZzsKPiA+IC0JZWxzZSBpZiAoSVNfQ09GRkVFTEFLRShkZXZfcHJpdikpCj4gPiAtCQlkZXZf
cHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGNmbF9pbml0X2Nsb2NrX2dhdGluZzsK
PiA+IC0JZWxzZSBpZiAoSVNfU0tZTEFLRShkZXZfcHJpdikpCj4gPiAtCQlkZXZfcHJpdi0+ZGlz
cGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IHNrbF9pbml0X2Nsb2NrX2dhdGluZzsKPiA+IC0JZWxz
ZSBpZiAoSVNfS0FCWUxBS0UoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5p
dF9jbG9ja19nYXRpbmcgPSBrYmxfaW5pdF9jbG9ja19nYXRpbmc7Cj4gPiAtCWVsc2UgaWYgKElT
X0JST1hUT04oZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdF9jbG9ja19n
YXRpbmcgPSBieHRfaW5pdF9jbG9ja19nYXRpbmc7Cj4gPiAtCWVsc2UgaWYgKElTX0dFTUlOSUxB
S0UoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcg
PSBnbGtfaW5pdF9jbG9ja19nYXRpbmc7Cj4gPiAtCWVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZf
cHJpdikpCj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGJkd19p
bml0X2Nsb2NrX2dhdGluZzsKPiA+IC0JZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikp
Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGNodl9pbml0X2Ns
b2NrX2dhdGluZzsKPiA+IC0JZWxzZSBpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikpCj4gPiAtCQlk
ZXZfcHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGhzd19pbml0X2Nsb2NrX2dhdGlu
ZzsKPiA+IC0JZWxzZSBpZiAoSVNfSVZZQlJJREdFKGRldl9wcml2KSkKPiA+IC0JCWRldl9wcml2
LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gaXZiX2luaXRfY2xvY2tfZ2F0aW5nOwo+ID4g
LQllbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiA+IC0JCWRldl9wcml2LT5kaXNw
bGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gdmx2X2luaXRfY2xvY2tfZ2F0aW5nOwo+ID4gLQllbHNl
IGlmIChJU19HRU4oZGV2X3ByaXYsIDYpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdF9j
bG9ja19nYXRpbmcgPSBnZW42X2luaXRfY2xvY2tfZ2F0aW5nOwo+ID4gLQllbHNlIGlmIChJU19H
RU4oZGV2X3ByaXYsIDUpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRp
bmcgPSBpbGtfaW5pdF9jbG9ja19nYXRpbmc7Cj4gPiAtCWVsc2UgaWYgKElTX0c0WChkZXZfcHJp
dikpCj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGc0eF9pbml0
X2Nsb2NrX2dhdGluZzsKPiA+IC0JZWxzZSBpZiAoSVNfSTk2NUdNKGRldl9wcml2KSkKPiA+IC0J
CWRldl9wcml2LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gaTk2NWdtX2luaXRfY2xvY2tf
Z2F0aW5nOwo+ID4gLQllbHNlIGlmIChJU19JOTY1RyhkZXZfcHJpdikpCj4gPiAtCQlkZXZfcHJp
di0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGk5NjVnX2luaXRfY2xvY2tfZ2F0aW5nOwo+
ID4gLQllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDMpKQo+ID4gLQkJZGV2X3ByaXYtPmRpc3Bs
YXkuaW5pdF9jbG9ja19nYXRpbmcgPSBnZW4zX2luaXRfY2xvY2tfZ2F0aW5nOwo+ID4gLQllbHNl
IGlmIChJU19JODVYKGRldl9wcml2KSB8fCBJU19JODY1RyhkZXZfcHJpdikpCj4gPiAtCQlkZXZf
cHJpdi0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGk4NXhfaW5pdF9jbG9ja19nYXRpbmc7
Cj4gPiAtCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMikpCj4gPiAtCQlkZXZfcHJpdi0+ZGlz
cGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGk4MzBfaW5pdF9jbG9ja19nYXRpbmc7Cj4gPiArdm9p
ZCBpbnRlbF9pbml0X2Nsb2NrX2dhdGluZ19ob29rcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKPiA+ICt7Cj4gPiArCWlmIChJU19HRU4oaTkxNSwgMTEpKQo+ID4gKwkJaTkxNS0+ZGlz
cGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGljbF9pbml0X2Nsb2NrX2dhdGluZzsKPiA+ICsJZWxz
ZSBpZiAoSVNfQ0FOTk9OTEFLRShpOTE1KSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuaW5pdF9jbG9j
a19nYXRpbmcgPSBjbmxfaW5pdF9jbG9ja19nYXRpbmc7Cj4gPiArCWVsc2UgaWYgKElTX0NPRkZF
RUxBS0UoaTkxNSkpCj4gPiArCQlpOTE1LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gY2Zs
X2luaXRfY2xvY2tfZ2F0aW5nOwo+ID4gKwllbHNlIGlmIChJU19TS1lMQUtFKGk5MTUpKQo+ID4g
KwkJaTkxNS0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IHNrbF9pbml0X2Nsb2NrX2dhdGlu
ZzsKPiA+ICsJZWxzZSBpZiAoSVNfS0FCWUxBS0UoaTkxNSkpCj4gPiArCQlpOTE1LT5kaXNwbGF5
LmluaXRfY2xvY2tfZ2F0aW5nID0ga2JsX2luaXRfY2xvY2tfZ2F0aW5nOwo+ID4gKwllbHNlIGlm
IChJU19CUk9YVE9OKGk5MTUpKQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGlu
ZyA9IGJ4dF9pbml0X2Nsb2NrX2dhdGluZzsKPiA+ICsJZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShp
OTE1KSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSBnbGtfaW5pdF9j
bG9ja19nYXRpbmc7Cj4gPiArCWVsc2UgaWYgKElTX0JST0FEV0VMTChpOTE1KSkKPiA+ICsJCWk5
MTUtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSBiZHdfaW5pdF9jbG9ja19nYXRpbmc7Cj4g
PiArCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCj4gPiArCQlpOTE1LT5kaXNwbGF5Lmlu
aXRfY2xvY2tfZ2F0aW5nID0gY2h2X2luaXRfY2xvY2tfZ2F0aW5nOwo+ID4gKwllbHNlIGlmIChJ
U19IQVNXRUxMKGk5MTUpKQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9
IGhzd19pbml0X2Nsb2NrX2dhdGluZzsKPiA+ICsJZWxzZSBpZiAoSVNfSVZZQlJJREdFKGk5MTUp
KQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGl2Yl9pbml0X2Nsb2Nr
X2dhdGluZzsKPiA+ICsJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkKPiA+ICsJCWk5MTUt
PmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSB2bHZfaW5pdF9jbG9ja19nYXRpbmc7Cj4gPiAr
CWVsc2UgaWYgKElTX0dFTihpOTE1LCA2KSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuaW5pdF9jbG9j
a19nYXRpbmcgPSBnZW42X2luaXRfY2xvY2tfZ2F0aW5nOwo+ID4gKwllbHNlIGlmIChJU19HRU4o
aTkxNSwgNSkpCj4gPiArCQlpOTE1LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gaWxrX2lu
aXRfY2xvY2tfZ2F0aW5nOwo+ID4gKwllbHNlIGlmIChJU19HNFgoaTkxNSkpCj4gPiArCQlpOTE1
LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gZzR4X2luaXRfY2xvY2tfZ2F0aW5nOwo+ID4g
KwllbHNlIGlmIChJU19JOTY1R00oaTkxNSkpCj4gPiArCQlpOTE1LT5kaXNwbGF5LmluaXRfY2xv
Y2tfZ2F0aW5nID0gaTk2NWdtX2luaXRfY2xvY2tfZ2F0aW5nOwo+ID4gKwllbHNlIGlmIChJU19J
OTY1RyhpOTE1KSkKPiA+ICsJCWk5MTUtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSBpOTY1
Z19pbml0X2Nsb2NrX2dhdGluZzsKPiA+ICsJZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDMpKQo+ID4g
KwkJaTkxNS0+ZGlzcGxheS5pbml0X2Nsb2NrX2dhdGluZyA9IGdlbjNfaW5pdF9jbG9ja19nYXRp
bmc7Cj4gPiArCWVsc2UgaWYgKElTX0k4NVgoaTkxNSkgfHwgSVNfSTg2NUcoaTkxNSkpCj4gPiAr
CQlpOTE1LT5kaXNwbGF5LmluaXRfY2xvY2tfZ2F0aW5nID0gaTg1eF9pbml0X2Nsb2NrX2dhdGlu
ZzsKPiA+ICsJZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDIpKQo+ID4gKwkJaTkxNS0+ZGlzcGxheS5p
bml0X2Nsb2NrX2dhdGluZyA9IGk4MzBfaW5pdF9jbG9ja19nYXRpbmc7Cj4gPiAgIAllbHNlIHsK
PiA+IC0JCU1JU1NJTkdfQ0FTRShJTlRFTF9ERVZJRChkZXZfcHJpdikpOwo+ID4gLQkJZGV2X3By
aXYtPmRpc3BsYXkuaW5pdF9jbG9ja19nYXRpbmcgPSBub3BfaW5pdF9jbG9ja19nYXRpbmc7Cj4g
PiArCQlNSVNTSU5HX0NBU0UoSU5URUxfREVWSUQoaTkxNSkpOwo+ID4gKwkJaTkxNS0+ZGlzcGxh
eS5pbml0X2Nsb2NrX2dhdGluZyA9IG5vcF9pbml0X2Nsb2NrX2dhdGluZzsKPiA+ICAgCX0KPiA+
ICAgfQo+ID4gICAvKiBTZXQgdXAgY2hpcCBzcGVjaWZpYyBwb3dlciBtYW5hZ2VtZW50LXJlbGF0
ZWQgZnVuY3Rpb25zICovCj4gPiAtdm9pZCBpbnRlbF9pbml0X3BtKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGludGVsX2luaXRfcG0oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCS8qIEZvciBjeHNyICovCj4gPiAtCWlmIChJ
U19QSU5FVklFVyhkZXZfcHJpdikpCj4gPiAtCQlpOTE1X3BpbmV2aWV3X2dldF9tZW1fZnJlcShk
ZXZfcHJpdik7Cj4gPiAtCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgNSkpCj4gPiAtCQlpOTE1
X2lyb25sYWtlX2dldF9tZW1fZnJlcShkZXZfcHJpdik7Cj4gPiArCWlmIChJU19QSU5FVklFVyhp
OTE1KSkKPiA+ICsJCWk5MTVfcGluZXZpZXdfZ2V0X21lbV9mcmVxKGk5MTUpOwo+ID4gKwllbHNl
IGlmIChJU19HRU4oaTkxNSwgNSkpCj4gPiArCQlpOTE1X2lyb25sYWtlX2dldF9tZW1fZnJlcShp
OTE1KTsKPiA+ICAgCS8qIEZvciBGSUZPIHdhdGVybWFyayB1cGRhdGVzICovCj4gPiAtCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKPiA+IC0JCXNrbF9zZXR1cF93bV9sYXRlbmN5KGRl
dl9wcml2KTsKPiA+IC0JCWRldl9wcml2LT5kaXNwbGF5LmluaXRpYWxfd2F0ZXJtYXJrcyA9IHNr
bF9pbml0aWFsX3dtOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuYXRvbWljX3VwZGF0ZV93YXRl
cm1hcmtzID0gc2tsX2F0b21pY191cGRhdGVfY3J0Y193bTsKPiA+IC0JCWRldl9wcml2LT5kaXNw
bGF5LmNvbXB1dGVfZ2xvYmFsX3dhdGVybWFya3MgPSBza2xfY29tcHV0ZV93bTsKPiA+IC0JfSBl
bHNlIGlmIChIQVNfUENIX1NQTElUKGRldl9wcml2KSkgewo+ID4gLQkJaWxrX3NldHVwX3dtX2xh
dGVuY3koZGV2X3ByaXYpOwo+ID4gLQo+ID4gLQkJaWYgKChJU19HRU4oZGV2X3ByaXYsIDUpICYm
IGRldl9wcml2LT53bS5wcmlfbGF0ZW5jeVsxXSAmJgo+ID4gLQkJICAgICBkZXZfcHJpdi0+d20u
c3ByX2xhdGVuY3lbMV0gJiYgZGV2X3ByaXYtPndtLmN1cl9sYXRlbmN5WzFdKSB8fAo+ID4gLQkJ
ICAgICghSVNfR0VOKGRldl9wcml2LCA1KSAmJiBkZXZfcHJpdi0+d20ucHJpX2xhdGVuY3lbMF0g
JiYKPiA+IC0JCSAgICAgZGV2X3ByaXYtPndtLnNwcl9sYXRlbmN5WzBdICYmIGRldl9wcml2LT53
bS5jdXJfbGF0ZW5jeVswXSkpIHsKPiA+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5jb21wdXRlX3Bp
cGVfd20gPSBpbGtfY29tcHV0ZV9waXBlX3dtOwo+ID4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmNv
bXB1dGVfaW50ZXJtZWRpYXRlX3dtID0KPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KSB7
Cj4gPiArCQlza2xfc2V0dXBfd21fbGF0ZW5jeShpOTE1KTsKPiA+ICsJCWk5MTUtPmRpc3BsYXku
aW5pdGlhbF93YXRlcm1hcmtzID0gc2tsX2luaXRpYWxfd207Cj4gPiArCQlpOTE1LT5kaXNwbGF5
LmF0b21pY191cGRhdGVfd2F0ZXJtYXJrcyA9IHNrbF9hdG9taWNfdXBkYXRlX2NydGNfd207Cj4g
PiArCQlpOTE1LT5kaXNwbGF5LmNvbXB1dGVfZ2xvYmFsX3dhdGVybWFya3MgPSBza2xfY29tcHV0
ZV93bTsKPiA+ICsJfSBlbHNlIGlmIChIQVNfUENIX1NQTElUKGk5MTUpKSB7Cj4gPiArCQlpbGtf
c2V0dXBfd21fbGF0ZW5jeShpOTE1KTsKPiA+ICsKPiA+ICsJCWlmICgoSVNfR0VOKGk5MTUsIDUp
ICYmIGk5MTUtPndtLnByaV9sYXRlbmN5WzFdICYmCj4gPiArCQkgICAgIGk5MTUtPndtLnNwcl9s
YXRlbmN5WzFdICYmIGk5MTUtPndtLmN1cl9sYXRlbmN5WzFdKSB8fAo+ID4gKwkJICAgICghSVNf
R0VOKGk5MTUsIDUpICYmIGk5MTUtPndtLnByaV9sYXRlbmN5WzBdICYmCj4gPiArCQkgICAgIGk5
MTUtPndtLnNwcl9sYXRlbmN5WzBdICYmIGk5MTUtPndtLmN1cl9sYXRlbmN5WzBdKSkgewo+ID4g
KwkJCWk5MTUtPmRpc3BsYXkuY29tcHV0ZV9waXBlX3dtID0gaWxrX2NvbXB1dGVfcGlwZV93bTsK
PiA+ICsJCQlpOTE1LT5kaXNwbGF5LmNvbXB1dGVfaW50ZXJtZWRpYXRlX3dtID0KPiA+ICAgCQkJ
CWlsa19jb21wdXRlX2ludGVybWVkaWF0ZV93bTsKPiA+IC0JCQlkZXZfcHJpdi0+ZGlzcGxheS5p
bml0aWFsX3dhdGVybWFya3MgPQo+ID4gKwkJCWk5MTUtPmRpc3BsYXkuaW5pdGlhbF93YXRlcm1h
cmtzID0KPiA+ICAgCQkJCWlsa19pbml0aWFsX3dhdGVybWFya3M7Cj4gPiAtCQkJZGV2X3ByaXYt
PmRpc3BsYXkub3B0aW1pemVfd2F0ZXJtYXJrcyA9Cj4gPiArCQkJaTkxNS0+ZGlzcGxheS5vcHRp
bWl6ZV93YXRlcm1hcmtzID0KPiA+ICAgCQkJCWlsa19vcHRpbWl6ZV93YXRlcm1hcmtzOwo+ID4g
ICAJCX0gZWxzZSB7Cj4gPiAgIAkJCURSTV9ERUJVR19LTVMoIkZhaWxlZCB0byByZWFkIGRpc3Bs
YXkgcGxhbmUgbGF0ZW5jeS4gIgo+ID4gICAJCQkJICAgICAgIkRpc2FibGUgQ3hTUlxuIik7Cj4g
PiAgIAkJfQo+ID4gLQl9IGVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NI
RVJSWVZJRVcoZGV2X3ByaXYpKSB7Cj4gPiAtCQl2bHZfc2V0dXBfd21fbGF0ZW5jeShkZXZfcHJp
dik7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5jb21wdXRlX3BpcGVfd20gPSB2bHZfY29tcHV0
ZV9waXBlX3dtOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuY29tcHV0ZV9pbnRlcm1lZGlhdGVf
d20gPSB2bHZfY29tcHV0ZV9pbnRlcm1lZGlhdGVfd207Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxh
eS5pbml0aWFsX3dhdGVybWFya3MgPSB2bHZfaW5pdGlhbF93YXRlcm1hcmtzOwo+ID4gLQkJZGV2
X3ByaXYtPmRpc3BsYXkub3B0aW1pemVfd2F0ZXJtYXJrcyA9IHZsdl9vcHRpbWl6ZV93YXRlcm1h
cmtzOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkuYXRvbWljX3VwZGF0ZV93YXRlcm1hcmtzID0g
dmx2X2F0b21pY191cGRhdGVfZmlmbzsKPiA+IC0JfSBlbHNlIGlmIChJU19HNFgoZGV2X3ByaXYp
KSB7Cj4gPiAtCQlnNHhfc2V0dXBfd21fbGF0ZW5jeShkZXZfcHJpdik7Cj4gPiAtCQlkZXZfcHJp
di0+ZGlzcGxheS5jb21wdXRlX3BpcGVfd20gPSBnNHhfY29tcHV0ZV9waXBlX3dtOwo+ID4gLQkJ
ZGV2X3ByaXYtPmRpc3BsYXkuY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20gPSBnNHhfY29tcHV0ZV9p
bnRlcm1lZGlhdGVfd207Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFy
a3MgPSBnNHhfaW5pdGlhbF93YXRlcm1hcmtzOwo+ID4gLQkJZGV2X3ByaXYtPmRpc3BsYXkub3B0
aW1pemVfd2F0ZXJtYXJrcyA9IGc0eF9vcHRpbWl6ZV93YXRlcm1hcmtzOwo+ID4gLQl9IGVsc2Ug
aWYgKElTX1BJTkVWSUVXKGRldl9wcml2KSkgewo+ID4gLQkJaWYgKCFpbnRlbF9nZXRfY3hzcl9s
YXRlbmN5KCFJU19NT0JJTEUoZGV2X3ByaXYpLAo+ID4gLQkJCQkJICAgIGRldl9wcml2LT5pc19k
ZHIzLAo+ID4gLQkJCQkJICAgIGRldl9wcml2LT5mc2JfZnJlcSwKPiA+IC0JCQkJCSAgICBkZXZf
cHJpdi0+bWVtX2ZyZXEpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8
fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiArCQl2bHZfc2V0dXBfd21fbGF0ZW5jeShpOTE1
KTsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuY29tcHV0ZV9waXBlX3dtID0gdmx2X2NvbXB1dGVfcGlw
ZV93bTsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20gPSB2bHZf
Y29tcHV0ZV9pbnRlcm1lZGlhdGVfd207Cj4gPiArCQlpOTE1LT5kaXNwbGF5LmluaXRpYWxfd2F0
ZXJtYXJrcyA9IHZsdl9pbml0aWFsX3dhdGVybWFya3M7Cj4gPiArCQlpOTE1LT5kaXNwbGF5Lm9w
dGltaXplX3dhdGVybWFya3MgPSB2bHZfb3B0aW1pemVfd2F0ZXJtYXJrczsKPiA+ICsJCWk5MTUt
PmRpc3BsYXkuYXRvbWljX3VwZGF0ZV93YXRlcm1hcmtzID0gdmx2X2F0b21pY191cGRhdGVfZmlm
bzsKPiA+ICsJfSBlbHNlIGlmIChJU19HNFgoaTkxNSkpIHsKPiA+ICsJCWc0eF9zZXR1cF93bV9s
YXRlbmN5KGk5MTUpOwo+ID4gKwkJaTkxNS0+ZGlzcGxheS5jb21wdXRlX3BpcGVfd20gPSBnNHhf
Y29tcHV0ZV9waXBlX3dtOwo+ID4gKwkJaTkxNS0+ZGlzcGxheS5jb21wdXRlX2ludGVybWVkaWF0
ZV93bSA9IGc0eF9jb21wdXRlX2ludGVybWVkaWF0ZV93bTsKPiA+ICsJCWk5MTUtPmRpc3BsYXku
aW5pdGlhbF93YXRlcm1hcmtzID0gZzR4X2luaXRpYWxfd2F0ZXJtYXJrczsKPiA+ICsJCWk5MTUt
PmRpc3BsYXkub3B0aW1pemVfd2F0ZXJtYXJrcyA9IGc0eF9vcHRpbWl6ZV93YXRlcm1hcmtzOwo+
ID4gKwl9IGVsc2UgaWYgKElTX1BJTkVWSUVXKGk5MTUpKSB7Cj4gPiArCQlpZiAoIWludGVsX2dl
dF9jeHNyX2xhdGVuY3koIUlTX01PQklMRShpOTE1KSwKPiA+ICsJCQkJCSAgICBpOTE1LT5pc19k
ZHIzLAo+ID4gKwkJCQkJICAgIGk5MTUtPmZzYl9mcmVxLAo+ID4gKwkJCQkJICAgIGk5MTUtPm1l
bV9mcmVxKSkgewo+ID4gICAJCQlEUk1fSU5GTygiZmFpbGVkIHRvIGZpbmQga25vd24gQ3hTUiBs
YXRlbmN5ICIKPiA+ICAgCQkJCSAiKGZvdW5kIGRkciVzIGZzYiBmcmVxICVkLCBtZW0gZnJlcSAl
ZCksICIKPiA+ICAgCQkJCSAiZGlzYWJsaW5nIEN4U1JcbiIsCj4gPiAtCQkJCSAoZGV2X3ByaXYt
PmlzX2RkcjMgPT0gMSkgPyAiMyIgOiAiMiIsCj4gPiAtCQkJCSBkZXZfcHJpdi0+ZnNiX2ZyZXEs
IGRldl9wcml2LT5tZW1fZnJlcSk7Cj4gPiArCQkJCSAoaTkxNS0+aXNfZGRyMyA9PSAxKSA/ICIz
IiA6ICIyIiwKPiA+ICsJCQkJIGk5MTUtPmZzYl9mcmVxLCBpOTE1LT5tZW1fZnJlcSk7Cj4gPiAg
IAkJCS8qIERpc2FibGUgQ3hTUiBhbmQgbmV2ZXIgdXBkYXRlIGl0cyB3YXRlcm1hcmsgYWdhaW4g
Ki8KPiA+IC0JCQlpbnRlbF9zZXRfbWVtb3J5X2N4c3IoZGV2X3ByaXYsIGZhbHNlKTsKPiA+IC0J
CQlkZXZfcHJpdi0+ZGlzcGxheS51cGRhdGVfd20gPSBOVUxMOwo+ID4gKwkJCWludGVsX3NldF9t
ZW1vcnlfY3hzcihpOTE1LCBmYWxzZSk7Cj4gPiArCQkJaTkxNS0+ZGlzcGxheS51cGRhdGVfd20g
PSBOVUxMOwo+ID4gICAJCX0gZWxzZQo+ID4gLQkJCWRldl9wcml2LT5kaXNwbGF5LnVwZGF0ZV93
bSA9IHBpbmV2aWV3X3VwZGF0ZV93bTsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYs
IDQpKSB7Cj4gPiAtCQlkZXZfcHJpdi0+ZGlzcGxheS51cGRhdGVfd20gPSBpOTY1X3VwZGF0ZV93
bTsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDMpKSB7Cj4gPiAtCQlkZXZfcHJp
di0+ZGlzcGxheS51cGRhdGVfd20gPSBpOXh4X3VwZGF0ZV93bTsKPiA+IC0JCWRldl9wcml2LT5k
aXNwbGF5LmdldF9maWZvX3NpemUgPSBpOXh4X2dldF9maWZvX3NpemU7Cj4gPiAtCX0gZWxzZSBp
ZiAoSVNfR0VOKGRldl9wcml2LCAyKSkgewo+ID4gLQkJaWYgKElOVEVMX0lORk8oZGV2X3ByaXYp
LT5udW1fcGlwZXMgPT0gMSkgewo+ID4gLQkJCWRldl9wcml2LT5kaXNwbGF5LnVwZGF0ZV93bSA9
IGk4NDVfdXBkYXRlX3dtOwo+ID4gLQkJCWRldl9wcml2LT5kaXNwbGF5LmdldF9maWZvX3NpemUg
PSBpODQ1X2dldF9maWZvX3NpemU7Cj4gPiArCQkJaTkxNS0+ZGlzcGxheS51cGRhdGVfd20gPSBw
aW5ldmlld191cGRhdGVfd207Cj4gPiArCX0gZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDQpKSB7Cj4g
PiArCQlpOTE1LT5kaXNwbGF5LnVwZGF0ZV93bSA9IGk5NjVfdXBkYXRlX3dtOwo+ID4gKwl9IGVs
c2UgaWYgKElTX0dFTihpOTE1LCAzKSkgewo+ID4gKwkJaTkxNS0+ZGlzcGxheS51cGRhdGVfd20g
PSBpOXh4X3VwZGF0ZV93bTsKPiA+ICsJCWk5MTUtPmRpc3BsYXkuZ2V0X2ZpZm9fc2l6ZSA9IGk5
eHhfZ2V0X2ZpZm9fc2l6ZTsKPiA+ICsJfSBlbHNlIGlmIChJU19HRU4oaTkxNSwgMikpIHsKPiA+
ICsJCWlmIChJTlRFTF9JTkZPKGk5MTUpLT5udW1fcGlwZXMgPT0gMSkgewo+ID4gKwkJCWk5MTUt
PmRpc3BsYXkudXBkYXRlX3dtID0gaTg0NV91cGRhdGVfd207Cj4gPiArCQkJaTkxNS0+ZGlzcGxh
eS5nZXRfZmlmb19zaXplID0gaTg0NV9nZXRfZmlmb19zaXplOwo+ID4gICAJCX0gZWxzZSB7Cj4g
PiAtCQkJZGV2X3ByaXYtPmRpc3BsYXkudXBkYXRlX3dtID0gaTl4eF91cGRhdGVfd207Cj4gPiAt
CQkJZGV2X3ByaXYtPmRpc3BsYXkuZ2V0X2ZpZm9fc2l6ZSA9IGk4MzBfZ2V0X2ZpZm9fc2l6ZTsK
PiA+ICsJCQlpOTE1LT5kaXNwbGF5LnVwZGF0ZV93bSA9IGk5eHhfdXBkYXRlX3dtOwo+ID4gKwkJ
CWk5MTUtPmRpc3BsYXkuZ2V0X2ZpZm9fc2l6ZSA9IGk4MzBfZ2V0X2ZpZm9fc2l6ZTsKPiA+ICAg
CQl9Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCURSTV9FUlJPUigidW5leHBlY3RlZCBmYWxsLXRo
cm91Z2ggaW4gaW50ZWxfaW5pdF9wbVxuIik7Cj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMg
aW50IGJ5dF9ncHVfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCB2
YWwpCj4gPiArc3RhdGljIGludCBieXRfZ3B1X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsIGludCB2YWwpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRl
dl9wcml2LT5ndF9wbS5ycHM7Cj4gPiArCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5n
dF9wbS5ycHM7Cj4gPiAgIAkvKgo+ID4gICAJICogTiA9IHZhbCAtIDB4YjcKPiA+IEBAIC05NzU2
LDE2ICs5NzU2LDE2IEBAIHN0YXRpYyBpbnQgYnl0X2dwdV9mcmVxKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwgaW50IHZhbCkKPiA+ICAgCXJldHVybiBESVZfUk9VTkRfQ0xPU0VT
VChycHMtPmdwbGxfcmVmX2ZyZXEgKiAodmFsIC0gMHhiNyksIDEwMDApOwo+ID4gICB9Cj4gPiAt
c3RhdGljIGludCBieXRfZnJlcV9vcGNvZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCBpbnQgdmFsKQo+ID4gK3N0YXRpYyBpbnQgYnl0X2ZyZXFfb3Bjb2RlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LCBpbnQgdmFsKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9y
cHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpy
cHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwo+ID4gICAJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKDEw
MDAgKiB2YWwsIHJwcy0+Z3BsbF9yZWZfZnJlcSkgKyAweGI3Owo+ID4gICB9Cj4gPiAtc3RhdGlj
IGludCBjaHZfZ3B1X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQg
dmFsKQo+ID4gK3N0YXRpYyBpbnQgY2h2X2dwdV9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LCBpbnQgdmFsKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZk
ZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+
Z3RfcG0ucnBzOwo+ID4gICAJLyoKPiA+ICAgCSAqIE4gPSB2YWwgLyAyCj4gPiBAQCAtOTc3NCw1
MiArOTc3NCw1MiBAQCBzdGF0aWMgaW50IGNodl9ncHVfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIGludCB2YWwpCj4gPiAgIAlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1Qo
cnBzLT5ncGxsX3JlZl9mcmVxICogdmFsLCAyICogMiAqIDEwMDApOwo+ID4gICB9Cj4gPiAtc3Rh
dGljIGludCBjaHZfZnJlcV9vcGNvZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBpbnQgdmFsKQo+ID4gK3N0YXRpYyBpbnQgY2h2X2ZyZXFfb3Bjb2RlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LCBpbnQgdmFsKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBpbnRlbF9ycHMg
KnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwo+ID4gKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMg
PSAmaTkxNS0+Z3RfcG0ucnBzOwo+ID4gICAJLyogQ0hWIG5lZWRzIGV2ZW4gdmFsdWVzICovCj4g
PiAgIAlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QoMiAqIDEwMDAgKiB2YWwsIHJwcy0+Z3BsbF9y
ZWZfZnJlcSkgKiAyOwo+ID4gICB9Cj4gPiAtaW50IGludGVsX2dwdV9mcmVxKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IHZhbCkKPiA+ICtpbnQgaW50ZWxfZ3B1X2ZyZXEo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCB2YWwpCj4gPiAgIHsKPiA+IC0JaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5
KQo+ID4gICAJCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVCh2YWwgKiBHVF9GUkVRVUVOQ1lfTVVM
VElQTElFUiwKPiA+ICAgCQkJCQkgR0VOOV9GUkVRX1NDQUxFUik7Cj4gPiAtCWVsc2UgaWYgKElT
X0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ID4gLQkJcmV0dXJuIGNodl9ncHVfZnJlcShkZXZfcHJp
diwgdmFsKTsKPiA+IC0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCj4gPiAtCQly
ZXR1cm4gYnl0X2dwdV9mcmVxKGRldl9wcml2LCB2YWwpOwo+ID4gKwllbHNlIGlmIChJU19DSEVS
UllWSUVXKGk5MTUpKQo+ID4gKwkJcmV0dXJuIGNodl9ncHVfZnJlcShpOTE1LCB2YWwpOwo+ID4g
KwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQo+ID4gKwkJcmV0dXJuIGJ5dF9ncHVfZnJl
cShpOTE1LCB2YWwpOwo+ID4gICAJZWxzZQo+ID4gICAJCXJldHVybiB2YWwgKiBHVF9GUkVRVUVO
Q1lfTVVMVElQTElFUjsKPiA+ICAgfQo+ID4gLWludCBpbnRlbF9mcmVxX29wY29kZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCB2YWwpCj4gPiAraW50IGludGVsX2ZyZXFf
b3Bjb2RlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnQgdmFsKQo+ID4gICB7Cj4g
PiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gOSkKPiA+ICAgCQlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QodmFsICogR0VOOV9GUkVR
X1NDQUxFUiwKPiA+ICAgCQkJCQkgR1RfRlJFUVVFTkNZX01VTFRJUExJRVIpOwo+ID4gLQllbHNl
IGlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkKPiA+IC0JCXJldHVybiBjaHZfZnJlcV9vcGNv
ZGUoZGV2X3ByaXYsIHZhbCk7Cj4gPiAtCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYp
KQo+ID4gLQkJcmV0dXJuIGJ5dF9mcmVxX29wY29kZShkZXZfcHJpdiwgdmFsKTsKPiA+ICsJZWxz
ZSBpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKPiA+ICsJCXJldHVybiBjaHZfZnJlcV9vcGNvZGUo
aTkxNSwgdmFsKTsKPiA+ICsJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkKPiA+ICsJCXJl
dHVybiBieXRfZnJlcV9vcGNvZGUoaTkxNSwgdmFsKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlyZXR1
cm4gRElWX1JPVU5EX0NMT1NFU1QodmFsLCBHVF9GUkVRVUVOQ1lfTVVMVElQTElFUik7Cj4gPiAg
IH0KPiA+IC12b2lkIGludGVsX3BtX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKPiA+ICt2b2lkIGludGVsX3BtX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQo+ID4gICB7Cj4gPiAtCW11dGV4X2luaXQoJmRldl9wcml2LT5ndF9wbS5ycHMubG9jayk7
Cj4gPiAtCW11dGV4X2luaXQoJmRldl9wcml2LT5ndF9wbS5ycHMucG93ZXIubXV0ZXgpOwo+ID4g
KwltdXRleF9pbml0KCZpOTE1LT5ndF9wbS5ycHMubG9jayk7Cj4gPiArCW11dGV4X2luaXQoJmk5
MTUtPmd0X3BtLnJwcy5wb3dlci5tdXRleCk7Cj4gPiAtCWF0b21pY19zZXQoJmRldl9wcml2LT5n
dF9wbS5ycHMubnVtX3dhaXRlcnMsIDApOwo+ID4gKwlhdG9taWNfc2V0KCZpOTE1LT5ndF9wbS5y
cHMubnVtX3dhaXRlcnMsIDApOwo+ID4gLQlkZXZfcHJpdi0+cnVudGltZV9wbS5zdXNwZW5kZWQg
PSBmYWxzZTsKPiA+IC0JYXRvbWljX3NldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0ud2FrZXJlZl9j
b3VudCwgMCk7Cj4gPiArCWk5MTUtPnJ1bnRpbWVfcG0uc3VzcGVuZGVkID0gZmFsc2U7Cj4gPiAr
CWF0b21pY19zZXQoJmk5MTUtPnJ1bnRpbWVfcG0ud2FrZXJlZl9jb3VudCwgMCk7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgdTY0IHZsdl9yZXNpZGVuY3lfcmF3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdTY0IHZsdl9yZXNpZGVuY3lfcmF3KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICAgIGNvbnN0IGk5MTVfcmVnX3QgcmVnKQo+
ID4gICB7Cj4gPiAgIAl1MzIgbG93ZXIsIHVwcGVyLCB0bXA7Cj4gPiBAQCAtOTgyOSw3ICs5ODI5
LDcgQEAgc3RhdGljIHU2NCB2bHZfcmVzaWRlbmN5X3JhdyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiAgIAkgKiBUaGUgcmVnaXN0ZXIgYWNjZXNzZWQgZG8gbm90IG5lZWQg
Zm9yY2V3YWtlLiBXZSBib3Jyb3cKPiA+ICAgCSAqIHVuY29yZSBsb2NrIHRvIHByZXZlbnQgY29u
Y3VycmVudCBhY2Nlc3MgdG8gcmFuZ2UgcmVnLgo+ID4gICAJICovCj4gPiAtCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJmRldl9wcml2LT51bmNvcmUubG9jayk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0X2hl
bGQoJmk5MTUtPnVuY29yZS5sb2NrKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiB2bHYgYW5kIGNodiBy
ZXNpZGVuY3kgY291bnRlcnMgYXJlIDQwIGJpdHMgaW4gd2lkdGguCj4gPiBAQCAtOTg2NSwxNyAr
OTg2NSwxNyBAQCBzdGF0aWMgdTY0IHZsdl9yZXNpZGVuY3lfcmF3KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXJldHVybiBsb3dlciB8ICh1NjQpdXBwZXIgPDwgODsK
PiA+ICAgfQo+ID4gLXU2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICt1NjQgaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgY29uc3QgaTkxNV9yZWdfdCByZWcp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51
bmNvcmU7Cj4gPiArCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7
Cj4gPiAgIAl1NjQgdGltZV9odywgcHJldl9odywgb3ZlcmZsb3dfaHc7Cj4gPiAgIAl1bnNpZ25l
ZCBpbnQgZndfZG9tYWluczsKPiA+ICAgCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gPiAgIAl1bnNp
Z25lZCBpbnQgaTsKPiA+ICAgCXUzMiBtdWwsIGRpdjsKPiA+IC0JaWYgKCFIQVNfUkM2KGRldl9w
cml2KSkKPiA+ICsJaWYgKCFIQVNfUkM2KGk5MTUpKQo+ID4gICAJCXJldHVybiAwOwo+ID4gICAJ
LyoKPiA+IEBAIC05ODg3LDcgKzk4ODcsNyBAQCB1NjQgaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkgKi8KPiA+ICAgCWkgPSAo
aTkxNV9tbWlvX3JlZ19vZmZzZXQocmVnKSAtCj4gPiAgIAkgICAgIGk5MTVfbW1pb19yZWdfb2Zm
c2V0KEdFTjZfR1RfR0ZYX1JDNl9MT0NLRUQpKSAvIHNpemVvZih1MzIpOwo+ID4gLQlpZiAoV0FS
Tl9PTl9PTkNFKGkgPj0gQVJSQVlfU0laRShkZXZfcHJpdi0+Z3RfcG0ucmM2LmN1cl9yZXNpZGVu
Y3kpKSkKPiA+ICsJaWYgKFdBUk5fT05fT05DRShpID49IEFSUkFZX1NJWkUoaTkxNS0+Z3RfcG0u
cmM2LmN1cl9yZXNpZGVuY3kpKSkKPiA+ICAgCQlyZXR1cm4gMDsKPiA+ICAgCWZ3X2RvbWFpbnMg
PSBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2Zvcl9yZWcodW5jb3JlLCByZWcsIEZXX1JFR19SRUFE
KTsKPiA+IEBAIC05ODk2LDE0ICs5ODk2LDE0IEBAIHU2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X25z
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWludGVsX3VuY29yZV9m
b3JjZXdha2VfZ2V0X19sb2NrZWQodW5jb3JlLCBmd19kb21haW5zKTsKPiA+ICAgCS8qIE9uIFZM
ViBhbmQgQ0hWLCByZXNpZGVuY3kgdGltZSBpcyBpbiBDWiB1bml0cyByYXRoZXIgdGhhbiAxLjI4
dXMgKi8KPiA+IC0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVco
ZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJ
RVcoaTkxNSkpIHsKPiA+ICAgCQltdWwgPSAxMDAwMDAwOwo+ID4gLQkJZGl2ID0gZGV2X3ByaXYt
PmN6Y2xrX2ZyZXE7Cj4gPiArCQlkaXYgPSBpOTE1LT5jemNsa19mcmVxOwo+ID4gICAJCW92ZXJm
bG93X2h3ID0gQklUX1VMTCg0MCk7Cj4gPiAtCQl0aW1lX2h3ID0gdmx2X3Jlc2lkZW5jeV9yYXco
ZGV2X3ByaXYsIHJlZyk7Cj4gPiArCQl0aW1lX2h3ID0gdmx2X3Jlc2lkZW5jeV9yYXcoaTkxNSwg
cmVnKTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiAgIAkJLyogODMzLjMzbnMgdW5pdHMgb24gR2VuOUxQ
LCAxLjI4dXMgZWxzZXdoZXJlLiAqLwo+ID4gLQkJaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7
Cj4gPiArCQlpZiAoSVNfR0VOOV9MUChpOTE1KSkgewo+ID4gICAJCQltdWwgPSAxMDAwMDsKPiA+
ICAgCQkJZGl2ID0gMTI7Cj4gPiAgIAkJfSBlbHNlIHsKPiA+IEBAIC05OTIxLDggKzk5MjEsOCBA
QCB1NjQgaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiAgIAkgKiBCdXQgcmVseWluZyBvbiBhIHN1ZmZpY2llbnQgZnJlcXVlbmN5IG9m
IHF1ZXJpZXMgb3RoZXJ3aXNlIGNvdW50ZXJzCj4gPiAgIAkgKiBjYW4gc3RpbGwgd3JhcC4KPiA+
ICAgCSAqLwo+ID4gLQlwcmV2X2h3ID0gZGV2X3ByaXYtPmd0X3BtLnJjNi5wcmV2X2h3X3Jlc2lk
ZW5jeVtpXTsKPiA+IC0JZGV2X3ByaXYtPmd0X3BtLnJjNi5wcmV2X2h3X3Jlc2lkZW5jeVtpXSA9
IHRpbWVfaHc7Cj4gPiArCXByZXZfaHcgPSBpOTE1LT5ndF9wbS5yYzYucHJldl9od19yZXNpZGVu
Y3lbaV07Cj4gPiArCWk5MTUtPmd0X3BtLnJjNi5wcmV2X2h3X3Jlc2lkZW5jeVtpXSA9IHRpbWVf
aHc7Cj4gPiAgIAkvKiBSQzYgZGVsdGEgZnJvbSBsYXN0IHNhbXBsZS4gKi8KPiA+ICAgCWlmICh0
aW1lX2h3ID49IHByZXZfaHcpCj4gPiBAQCAtOTkzMSw4ICs5OTMxLDggQEAgdTY0IGludGVsX3Jj
Nl9yZXNpZGVuY3lfbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
CXRpbWVfaHcgKz0gb3ZlcmZsb3dfaHcgLSBwcmV2X2h3Owo+ID4gICAJLyogQWRkIGRlbHRhIHRv
IFJDNiBleHRlbmRlZCByYXcgZHJpdmVyIGNvcHkuICovCj4gPiAtCXRpbWVfaHcgKz0gZGV2X3By
aXYtPmd0X3BtLnJjNi5jdXJfcmVzaWRlbmN5W2ldOwo+ID4gLQlkZXZfcHJpdi0+Z3RfcG0ucmM2
LmN1cl9yZXNpZGVuY3lbaV0gPSB0aW1lX2h3Owo+ID4gKwl0aW1lX2h3ICs9IGk5MTUtPmd0X3Bt
LnJjNi5jdXJfcmVzaWRlbmN5W2ldOwo+ID4gKwlpOTE1LT5ndF9wbS5yYzYuY3VyX3Jlc2lkZW5j
eVtpXSA9IHRpbWVfaHc7Cj4gPiAgIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dF9fbG9ja2Vk
KHVuY29yZSwgZndfZG9tYWlucyk7Cj4gPiAgIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ1bmNv
cmUtPmxvY2ssIGZsYWdzKTsKPiA+IEBAIC05OTQwLDE5ICs5OTQwLDE5IEBAIHU2NCBpbnRlbF9y
YzZfcmVzaWRlbmN5X25zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAg
CXJldHVybiBtdWxfdTY0X3UzMl9kaXYodGltZV9odywgbXVsLCBkaXYpOwo+ID4gICB9Cj4gPiAt
dTY0IGludGVsX3JjNl9yZXNpZGVuY3lfdXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK3U2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X3VzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ID4gICAJCQkgICBpOTE1X3JlZ190IHJlZykKPiA+ICAgewo+ID4gLQlyZXR1
cm4gRElWX1JPVU5EX1VQX1VMTChpbnRlbF9yYzZfcmVzaWRlbmN5X25zKGRldl9wcml2LCByZWcp
LCAxMDAwKTsKPiA+ICsJcmV0dXJuIERJVl9ST1VORF9VUF9VTEwoaW50ZWxfcmM2X3Jlc2lkZW5j
eV9ucyhpOTE1LCByZWcpLCAxMDAwKTsKPiA+ICAgfQo+ID4gLXUzMiBpbnRlbF9nZXRfY2FnZihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBycHN0YXQpCj4gPiArdTMyIGlu
dGVsX2dldF9jYWdmKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1MzIgcnBzdGF0KQo+
ID4gICB7Cj4gPiAgIAl1MzIgY2FnZjsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
OSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQo+ID4gICAJCWNhZ2YgPSAocnBzdGF0
ICYgR0VOOV9DQUdGX01BU0spID4+IEdFTjlfQ0FHRl9TSElGVDsKPiA+IC0JZWxzZSBpZiAoSVNf
SEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkKPiA+ICsJZWxzZSBp
ZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gPiAgIAkJY2FnZiA9
IChycHN0YXQgJiBIU1dfQ0FHRl9NQVNLKSA+PiBIU1dfQ0FHRl9TSElGVDsKPiA+ICAgCWVsc2UK
PiA+ICAgCQljYWdmID0gKHJwc3RhdCAmIEdFTjZfQ0FHRl9NQVNLKSA+PiBHRU42X0NBR0ZfU0hJ
RlQ7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uaCBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmgKPiA+IGluZGV4IDFiNDg5ZmEzOTllMS4uZTJj
NGVkZjI2M2Y3IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0u
aAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uaAo+ID4gQEAgLTIyLDM5
ICsyMiwzOSBAQCBzdHJ1Y3Qgc2tsX2RkYl9lbnRyeTsKPiA+ICAgc3RydWN0IHNrbF9waXBlX3dt
Owo+ID4gICBzdHJ1Y3Qgc2tsX3dtX2xldmVsOwo+ID4gLXZvaWQgaW50ZWxfaW5pdF9jbG9ja19n
YXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGludGVs
X3N1c3BlbmRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC1pbnQg
aWxrX3dtX21heF9sZXZlbChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owo+ID4gK3ZvaWQgaW50ZWxfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfc3VzcGVuZF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSk7Cj4gPiAraW50IGlsa193bV9tYXhfbGV2ZWwoY29uc3Qgc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICB2b2lkIGludGVsX3VwZGF0ZV93YXRlcm1hcmtzKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjKTsKPiA+IC12b2lkIGludGVsX2luaXRfcG0oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGludGVsX2luaXRfY2xvY2tfZ2F0
aW5nX2hvb2tzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBp
bnRlbF9wbV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZv
aWQgaW50ZWxfZ3B1X2lwc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cj4gPiArdm9pZCBpbnRlbF9pbml0X3BtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
PiA+ICt2b2lkIGludGVsX2luaXRfY2xvY2tfZ2F0aW5nX2hvb2tzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX3BtX3NldHVwKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX2dwdV9pcHNfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIHZvaWQgaW50ZWxfZ3B1X2lwc190ZWFyZG93bih2b2lk
KTsKPiA+IC12b2lkIGludGVsX2luaXRfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpbnRlbF9jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgaW50ZWxfc2FuaXRpemVf
Z3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9p
ZCBpbnRlbF9lbmFibGVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdik7Cj4gPiAtdm9pZCBpbnRlbF9kaXNhYmxlX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgZ2VuNl9ycHNfYnVzeShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgZ2VuNl9ycHNfaWRsZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3ZvaWQgaW50ZWxfaW5pdF9ndF9wb3dl
cnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfY2xl
YW51cF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3Zv
aWQgaW50ZWxfc2FuaXRpemVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KTsKPiA+ICt2b2lkIGludGVsX2VuYWJsZV9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfZGlzYWJsZV9ndF9wb3dlcnNhdmUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgZ2VuNl9ycHNfYnVzeShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBnZW42X3Jwc19pZGxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgdm9pZCBnZW42X3Jwc19ib29zdChzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpycSk7Cj4gPiAtdm9pZCBnNHhfd21fZ2V0X2h3X3N0YXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCB2bHZfd21fZ2V0X2h3X3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpbGtfd21f
Z2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9p
ZCBza2xfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cj4gPiArdm9pZCBnNHhfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KTsKPiA+ICt2b2lkIHZsdl93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwo+ID4gK3ZvaWQgaWxrX3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBza2xfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgdm9pZCBza2xfcGlwZV9kZGJfZ2V0X2h3X3N0YXRl
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+ID4gICAJCQkgICAgICAgc3RydWN0IHNrbF9kZGJf
ZW50cnkgKmRkYl95LAo+ID4gICAJCQkgICAgICAgc3RydWN0IHNrbF9kZGJfZW50cnkgKmRkYl91
dik7Cj4gPiAtdm9pZCBza2xfZGRiX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBza2xfZGRiX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICBzdHJ1Y3Qgc2tsX2RkYl9hbGxvY2F0aW9uICpk
ZGIgLyogb3V0ICovKTsKPiA+ICAgdm9pZCBza2xfcGlwZV93bV9nZXRfaHdfc3RhdGUoc3RydWN0
IGludGVsX2NydGMgKmNydGMsCj4gPiAgIAkJCSAgICAgIHN0cnVjdCBza2xfcGlwZV93bSAqb3V0
KTsKPiA+IC12b2lkIGc0eF93bV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwo+ID4gLXZvaWQgdmx2X3dtX3Nhbml0aXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cj4gPiArdm9pZCBnNHhfd21fc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgdmx2X3dtX3Nhbml0aXplKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KTsKPiA+ICAgYm9vbCBpbnRlbF9jYW5fZW5hYmxlX3NhZ3Yoc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlKTsKPiA+IC1pbnQgaW50ZWxfZW5hYmxlX3NhZ3Yoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC1pbnQgaW50ZWxfZGlzYWJsZV9zYWd2
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAraW50IGludGVsX2VuYWJs
ZV9zYWd2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICtpbnQgaW50ZWxfZGlz
YWJsZV9zYWd2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgYm9vbCBza2xf
d21fbGV2ZWxfZXF1YWxzKGNvbnN0IHN0cnVjdCBza2xfd21fbGV2ZWwgKmwxLAo+ID4gICAJCQkg
Y29uc3Qgc3RydWN0IHNrbF93bV9sZXZlbCAqbDIpOwo+ID4gICBib29sIHNrbF9kZGJfYWxsb2Nh
dGlvbl9vdmVybGFwcyhjb25zdCBzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSAqZGRiLAo+ID4gQEAgLTY3
LDI0ICs2NywyNCBAQCB2b2lkIHNrbF93cml0ZV9jdXJzb3Jfd20oc3RydWN0IGludGVsX3BsYW5l
ICpwbGFuZSwKPiA+ICAgYm9vbCBpbGtfZGlzYWJsZV9scF93bShzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2KTsKPiA+ICAgaW50IHNrbF9jaGVja19waXBlX21heF9waXhlbF9yYXRlKHN0cnVjdCBpbnRl
bF9jcnRjICppbnRlbF9jcnRjLAo+ID4gICAJCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3N0YXRlKTsKPiA+IC12b2lkIGludGVsX2luaXRfaXBjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpbnRlbF9lbmFibGVfaXBjKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBpbnRlbF9pbml0X2lwYyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBpbnRlbF9lbmFibGVfaXBjKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KTsKPiA+IC1pbnQgaW50ZWxfZ3B1X2ZyZXEoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgdmFsKTsKPiA+IC1pbnQgaW50ZWxfZnJlcV9vcGNv
ZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgdmFsKTsKPiA+IC11NjQg
aW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IGk5MTVfcmVnX3QgcmVnKTsKPiA+IC11NjQgaW50ZWxfcmM2X3Jlc2lkZW5jeV91cyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGk5MTVfcmVnX3QgcmVnKTsKPiA+ICtpbnQgaW50
ZWxfZ3B1X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludCB2YWwpOwo+ID4g
K2ludCBpbnRlbF9mcmVxX29wY29kZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50
IHZhbCk7Cj4gPiArdTY0IGludGVsX3JjNl9yZXNpZGVuY3lfbnMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsIGk5MTVfcmVnX3QgcmVnKTsKPiA+ICt1NjQgaW50ZWxfcmM2X3Jlc2lkZW5j
eV91cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaTkxNV9yZWdfdCByZWcpOwo+ID4g
LXUzMiBpbnRlbF9nZXRfY2FnZihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUz
MiBycHN0YXQxKTsKPiA+ICt1MzIgaW50ZWxfZ2V0X2NhZ2Yoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsIHUzMiBycHN0YXQxKTsKPiA+IC11bnNpZ25lZCBsb25nIGk5MTVfY2hpcHNldF92
YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC11bnNpZ25lZCBsb25n
IGk5MTVfbWNoX3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXVu
c2lnbmVkIGxvbmcgaTkxNV9nZnhfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dik7Cj4gPiAtdm9pZCBpOTE1X3VwZGF0ZV9nZnhfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cj4gPiArdW5zaWduZWQgbG9uZyBpOTE1X2NoaXBzZXRfdmFsKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt1bnNpZ25lZCBsb25nIGk5MTVfbWNoX3ZhbChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdW5zaWduZWQgbG9uZyBpOTE1X2dm
eF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gK3ZvaWQgaTkxNV91cGRh
dGVfZ2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAtYm9vbCBpcm9u
bGFrZV9zZXRfZHJwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCk7
Cj4gPiAtaW50IGludGVsX3NldF9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCB1OCB2YWwpOwo+ID4gK2Jvb2wgaXJvbmxha2Vfc2V0X2RycHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsIHU4IHZhbCk7Cj4gPiAraW50IGludGVsX3NldF9ycHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsIHU4IHZhbCk7Cj4gPiAgIHZvaWQgaW50ZWxfcnBzX21hcmtfaW50
ZXJhY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgaW50ZXJhY3RpdmUp
Owo+ID4gLWJvb2wgaW50ZWxfc2V0X21lbW9yeV9jeHNyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwgYm9vbCBlbmFibGUpOwo+ID4gK2Jvb2wgaW50ZWxfc2V0X21lbW9yeV9jeHNy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBib29sIGVuYWJsZSk7Cj4gPiAgICNlbmRp
ZiAvKiBfX0lOVEVMX1BNX0hfXyAqLwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX3Bzci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcHNyLmMKPiA+IGlu
ZGV4IDAxY2E1MDIwOTlkZi4uMDcyZWVhMDBiMTdhIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfcHNyLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX3Bzci5jCj4gPiBAQCAtNzEsMTQgKzcxLDE0IEBAIHN0YXRpYyBib29sIHBzcl9nbG9iYWxf
ZW5hYmxlZCh1MzIgZGVidWcpCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBpbnRl
bF9wc3IyX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0
YXRpYyBib29sIGludGVsX3BzcjJfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ID4gICB7Cj4gPiAgIAkvKiBDYW5ub3QgZW5hYmxlIERTQyBhbmQgUFNSMiBzaW11bHRh
bmVvdXNseSAqLwo+ID4gICAJV0FSTl9PTihjcnRjX3N0YXRlLT5kc2NfcGFyYW1zLmNvbXByZXNz
aW9uX2VuYWJsZSAmJgo+ID4gICAJCWNydGNfc3RhdGUtPmhhc19wc3IyKTsKPiA+IC0Jc3dpdGNo
IChkZXZfcHJpdi0+cHNyLmRlYnVnICYgSTkxNV9QU1JfREVCVUdfTU9ERV9NQVNLKSB7Cj4gPiAr
CXN3aXRjaCAoaTkxNS0+cHNyLmRlYnVnICYgSTkxNV9QU1JfREVCVUdfTU9ERV9NQVNLKSB7Cj4g
PiAgIAljYXNlIEk5MTVfUFNSX0RFQlVHX0RJU0FCTEU6Cj4gPiAgIAljYXNlIEk5MTVfUFNSX0RF
QlVHX0ZPUkNFX1BTUjE6Cj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTEwNCwyMCArMTA0
LDIwIEBAIHN0YXRpYyBpbnQgZWRwX3Bzcl9zaGlmdChlbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5z
Y29kZXIpCj4gPiAgIAl9Cj4gPiAgIH0KPiA+IC12b2lkIGludGVsX3Bzcl9pcnFfY29udHJvbChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBkZWJ1ZykKPiA+ICt2b2lkIGlu
dGVsX3Bzcl9pcnFfY29udHJvbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTMyIGRl
YnVnKQo+ID4gICB7Cj4gPiAgIAl1MzIgZGVidWdfbWFzaywgbWFzazsKPiA+ICAgCWVudW0gdHJh
bnNjb2RlciBjcHVfdHJhbnNjb2RlcjsKPiA+ICAgCXUzMiB0cmFuc2NvZGVycyA9IEJJVChUUkFO
U0NPREVSX0VEUCk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpCj4gPiArCWlm
IChJTlRFTF9HRU4oaTkxNSkgPj0gOCkKPiA+ICAgCQl0cmFuc2NvZGVycyB8PSBCSVQoVFJBTlND
T0RFUl9BKSB8Cj4gPiAgIAkJCSAgICAgICBCSVQoVFJBTlNDT0RFUl9CKSB8Cj4gPiAgIAkJCSAg
ICAgICBCSVQoVFJBTlNDT0RFUl9DKTsKPiA+ICAgCWRlYnVnX21hc2sgPSAwOwo+ID4gICAJbWFz
ayA9IDA7Cj4gPiAtCWZvcl9lYWNoX2NwdV90cmFuc2NvZGVyX21hc2tlZChkZXZfcHJpdiwgY3B1
X3RyYW5zY29kZXIsIHRyYW5zY29kZXJzKSB7Cj4gPiArCWZvcl9lYWNoX2NwdV90cmFuc2NvZGVy
X21hc2tlZChpOTE1LCBjcHVfdHJhbnNjb2RlciwgdHJhbnNjb2RlcnMpIHsKPiA+ICAgCQlpbnQg
c2hpZnQgPSBlZHBfcHNyX3NoaWZ0KGNwdV90cmFuc2NvZGVyKTsKPiA+ICAgCQltYXNrIHw9IEVE
UF9QU1JfRVJST1Ioc2hpZnQpOwo+ID4gQEAgLTE2OCwyNiArMTY4LDI2IEBAIHN0YXRpYyB2b2lk
IHBzcl9ldmVudF9wcmludCh1MzIgdmFsLCBib29sIHBzcjJfZW5hYmxlZCkKPiA+ICAgCQlEUk1f
REVCVUdfS01TKCJcdFBTUiBkaXNhYmxlZFxuIik7Cj4gPiAgIH0KPiA+IC12b2lkIGludGVsX3Bz
cl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwc3Jf
aWlyKQo+ID4gK3ZvaWQgaW50ZWxfcHNyX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCB1MzIgcHNyX2lpcikKPiA+ICAgewo+ID4gICAJdTMyIHRyYW5zY29kZXJzID0g
QklUKFRSQU5TQ09ERVJfRURQKTsKPiA+ICAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2Rl
cjsKPiA+ICAgCWt0aW1lX3QgdGltZV9ucyA9ICBrdGltZV9nZXQoKTsKPiA+ICAgCXUzMiBtYXNr
ID0gMDsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkKPiA+ICsJaWYgKElOVEVM
X0dFTihpOTE1KSA+PSA4KQo+ID4gICAJCXRyYW5zY29kZXJzIHw9IEJJVChUUkFOU0NPREVSX0Ep
IHwKPiA+ICAgCQkJICAgICAgIEJJVChUUkFOU0NPREVSX0IpIHwKPiA+ICAgCQkJICAgICAgIEJJ
VChUUkFOU0NPREVSX0MpOwo+ID4gLQlmb3JfZWFjaF9jcHVfdHJhbnNjb2Rlcl9tYXNrZWQoZGV2
X3ByaXYsIGNwdV90cmFuc2NvZGVyLCB0cmFuc2NvZGVycykgewo+ID4gKwlmb3JfZWFjaF9jcHVf
dHJhbnNjb2Rlcl9tYXNrZWQoaTkxNSwgY3B1X3RyYW5zY29kZXIsIHRyYW5zY29kZXJzKSB7Cj4g
PiAgIAkJaW50IHNoaWZ0ID0gZWRwX3Bzcl9zaGlmdChjcHVfdHJhbnNjb2Rlcik7Cj4gPiAgIAkJ
aWYgKHBzcl9paXIgJiBFRFBfUFNSX0VSUk9SKHNoaWZ0KSkgewo+ID4gICAJCQlEUk1fV0FSTigi
W3RyYW5zY29kZXIgJXNdIFBTUiBhdXggZXJyb3JcbiIsCj4gPiAgIAkJCQkgdHJhbnNjb2Rlcl9u
YW1lKGNwdV90cmFuc2NvZGVyKSk7Cj4gPiAtCQkJZGV2X3ByaXYtPnBzci5pcnFfYXV4X2Vycm9y
ID0gdHJ1ZTsKPiA+ICsJCQlpOTE1LT5wc3IuaXJxX2F1eF9lcnJvciA9IHRydWU7Cj4gPiAgIAkJ
CS8qCj4gPiAgIAkJCSAqIElmIHRoaXMgaW50ZXJydXB0aW9uIGlzIG5vdCBtYXNrZWQgaXQgd2ls
bCBrZWVwCj4gPiBAQCAtMjAxLDE5ICsyMDEsMTkgQEAgdm9pZCBpbnRlbF9wc3JfaXJxX2hhbmRs
ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcHNyX2lpcikKPiA+ICAg
CQl9Cj4gPiAgIAkJaWYgKHBzcl9paXIgJiBFRFBfUFNSX1BSRV9FTlRSWShzaGlmdCkpIHsKPiA+
IC0JCQlkZXZfcHJpdi0+cHNyLmxhc3RfZW50cnlfYXR0ZW1wdCA9IHRpbWVfbnM7Cj4gPiArCQkJ
aTkxNS0+cHNyLmxhc3RfZW50cnlfYXR0ZW1wdCA9IHRpbWVfbnM7Cj4gPiAgIAkJCURSTV9ERUJV
R19LTVMoIlt0cmFuc2NvZGVyICVzXSBQU1IgZW50cnkgYXR0ZW1wdCBpbiAyIHZibGFua3NcbiIs
Cj4gPiAgIAkJCQkgICAgICB0cmFuc2NvZGVyX25hbWUoY3B1X3RyYW5zY29kZXIpKTsKPiA+ICAg
CQl9Cj4gPiAgIAkJaWYgKHBzcl9paXIgJiBFRFBfUFNSX1BPU1RfRVhJVChzaGlmdCkpIHsKPiA+
IC0JCQlkZXZfcHJpdi0+cHNyLmxhc3RfZXhpdCA9IHRpbWVfbnM7Cj4gPiArCQkJaTkxNS0+cHNy
Lmxhc3RfZXhpdCA9IHRpbWVfbnM7Cj4gPiAgIAkJCURSTV9ERUJVR19LTVMoIlt0cmFuc2NvZGVy
ICVzXSBQU1IgZXhpdCBjb21wbGV0ZWRcbiIsCj4gPiAgIAkJCQkgICAgICB0cmFuc2NvZGVyX25h
bWUoY3B1X3RyYW5zY29kZXIpKTsKPiA+IC0JCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5
KSB7Cj4gPiArCQkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KSB7Cj4gPiAgIAkJCQl1MzIgdmFs
ID0gSTkxNV9SRUFEKFBTUl9FVkVOVChjcHVfdHJhbnNjb2RlcikpOwo+ID4gLQkJCQlib29sIHBz
cjJfZW5hYmxlZCA9IGRldl9wcml2LT5wc3IucHNyMl9lbmFibGVkOwo+ID4gKwkJCQlib29sIHBz
cjJfZW5hYmxlZCA9IGk5MTUtPnBzci5wc3IyX2VuYWJsZWQ7Cj4gPiAgIAkJCQlJOTE1X1dSSVRF
KFBTUl9FVkVOVChjcHVfdHJhbnNjb2RlciksIHZhbCk7Cj4gPiAgIAkJCQlwc3JfZXZlbnRfcHJp
bnQodmFsLCBwc3IyX2VuYWJsZWQpOwo+ID4gQEAgLTIyNSw3ICsyMjUsNyBAQCB2b2lkIGludGVs
X3Bzcl9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBw
c3JfaWlyKQo+ID4gICAJCW1hc2sgfD0gSTkxNV9SRUFEKEVEUF9QU1JfSU1SKTsKPiA+ICAgCQlJ
OTE1X1dSSVRFKEVEUF9QU1JfSU1SLCBtYXNrKTsKPiA+IC0JCXNjaGVkdWxlX3dvcmsoJmRldl9w
cml2LT5wc3Iud29yayk7Cj4gPiArCQlzY2hlZHVsZV93b3JrKCZpOTE1LT5wc3Iud29yayk7Cj4g
PiAgIAl9Cj4gPiAgIH0KPiA+IEBAIC0yNzksNyArMjc5LDcgQEAgc3RhdGljIHUxNiBpbnRlbF9k
cF9nZXRfc3VfeF9ncmFudWxhcnRpeShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICB2
b2lkIGludGVsX3Bzcl9pbml0X2RwY2Qoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAg
ewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gPiAgIAkJdG9faTkxNShkcF90b19kaWdfcG9ydChp
bnRlbF9kcCktPmJhc2UuYmFzZS5kZXYpOwo+ID4gICAJZHJtX2RwX2RwY2RfcmVhZCgmaW50ZWxf
ZHAtPmF1eCwgRFBfUFNSX1NVUFBPUlQsIGludGVsX2RwLT5wc3JfZHBjZCwKPiA+IEBAIC0zMDAs
MTQgKzMwMCwxNCBAQCB2b2lkIGludGVsX3Bzcl9pbml0X2RwY2Qoc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiAtCWRldl9wcml2LT5wc3Iuc2lu
a19zdXBwb3J0ID0gdHJ1ZTsKPiA+IC0JZGV2X3ByaXYtPnBzci5zaW5rX3N5bmNfbGF0ZW5jeSA9
Cj4gPiArCWk5MTUtPnBzci5zaW5rX3N1cHBvcnQgPSB0cnVlOwo+ID4gKwlpOTE1LT5wc3Iuc2lu
a19zeW5jX2xhdGVuY3kgPQo+ID4gICAJCWludGVsX2RwX2dldF9zaW5rX3N5bmNfbGF0ZW5jeShp
bnRlbF9kcCk7Cj4gPiAtCVdBUk5fT04oZGV2X3ByaXYtPnBzci5kcCk7Cj4gPiAtCWRldl9wcml2
LT5wc3IuZHAgPSBpbnRlbF9kcDsKPiA+ICsJV0FSTl9PTihpOTE1LT5wc3IuZHApOwo+ID4gKwlp
OTE1LT5wc3IuZHAgPSBpbnRlbF9kcDsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
OSAmJgo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkgJiYKPiA+ICAgCSAgICAoaW50ZWxf
ZHAtPnBzcl9kcGNkWzBdID09IERQX1BTUjJfV0lUSF9ZX0NPT1JEX0lTX1NVUFBPUlRFRCkpIHsK
PiA+ICAgCQlib29sIHlfcmVxID0gaW50ZWxfZHAtPnBzcl9kcGNkWzFdICYKPiA+ICAgCQkJICAg
ICBEUF9QU1IyX1NVX1lfQ09PUkRJTkFURV9SRVFVSVJFRDsKPiA+IEBAIC0zMjQsMTQgKzMyNCwx
NCBAQCB2b2lkIGludGVsX3Bzcl9pbml0X2RwY2Qoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkK
PiA+ICAgCQkgKiBZLWNvb3JkaW5hdGUgcmVxdWlyZW1lbnQgcGFuZWxzIHdlIHdvdWxkIG5lZWQg
dG8gZW5hYmxlCj4gPiAgIAkJICogR1RDIGZpcnN0Lgo+ID4gICAJCSAqLwo+ID4gLQkJZGV2X3By
aXYtPnBzci5zaW5rX3BzcjJfc3VwcG9ydCA9IHlfcmVxICYmIGFscG07Cj4gPiArCQlpOTE1LT5w
c3Iuc2lua19wc3IyX3N1cHBvcnQgPSB5X3JlcSAmJiBhbHBtOwo+ID4gICAJCURSTV9ERUJVR19L
TVMoIlBTUjIgJXNzdXBwb3J0ZWRcbiIsCj4gPiAtCQkJICAgICAgZGV2X3ByaXYtPnBzci5zaW5r
X3BzcjJfc3VwcG9ydCA/ICIiIDogIm5vdCAiKTsKPiA+ICsJCQkgICAgICBpOTE1LT5wc3Iuc2lu
a19wc3IyX3N1cHBvcnQgPyAiIiA6ICJub3QgIik7Cj4gPiAtCQlpZiAoZGV2X3ByaXYtPnBzci5z
aW5rX3BzcjJfc3VwcG9ydCkgewo+ID4gLQkJCWRldl9wcml2LT5wc3IuY29sb3JpbWV0cnlfc3Vw
cG9ydCA9Cj4gPiArCQlpZiAoaTkxNS0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0KSB7Cj4gPiArCQkJ
aTkxNS0+cHNyLmNvbG9yaW1ldHJ5X3N1cHBvcnQgPQo+ID4gICAJCQkJaW50ZWxfZHBfZ2V0X2Nv
bG9yaW1ldHJ5X3N0YXR1cyhpbnRlbF9kcCk7Cj4gPiAtCQkJZGV2X3ByaXYtPnBzci5zdV94X2dy
YW51bGFyaXR5ID0KPiA+ICsJCQlpOTE1LT5wc3Iuc3VfeF9ncmFudWxhcml0eSA9Cj4gPiAgIAkJ
CQlpbnRlbF9kcF9nZXRfc3VfeF9ncmFudWxhcnRpeShpbnRlbF9kcCk7Cj4gPiAgIAkJfQo+ID4g
ICAJfQo+ID4gQEAgLTM0MSwxNSArMzQxLDE1IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9zZXR1
cF92c2Moc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+ICAgCQkJCWNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRl
bF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShp
bnRlbF9kcCk7Cj4gPiAgIAlzdHJ1Y3QgZHBfc2RwIHBzcl92c2M7Cj4gPiAtCWlmIChkZXZfcHJp
di0+cHNyLnBzcjJfZW5hYmxlZCkgewo+ID4gKwlpZiAoaTkxNS0+cHNyLnBzcjJfZW5hYmxlZCkg
ewo+ID4gICAJCS8qIFByZXBhcmUgVlNDIEhlYWRlciBmb3IgU1UgYXMgcGVyIEVEUCAxLjQgc3Bl
YywgVGFibGUgNi4xMSAqLwo+ID4gICAJCW1lbXNldCgmcHNyX3ZzYywgMCwgc2l6ZW9mKHBzcl92
c2MpKTsKPiA+ICAgCQlwc3JfdnNjLnNkcF9oZWFkZXIuSEIwID0gMDsKPiA+ICAgCQlwc3JfdnNj
LnNkcF9oZWFkZXIuSEIxID0gMHg3Owo+ID4gLQkJaWYgKGRldl9wcml2LT5wc3IuY29sb3JpbWV0
cnlfc3VwcG9ydCkgewo+ID4gKwkJaWYgKGk5MTUtPnBzci5jb2xvcmltZXRyeV9zdXBwb3J0KSB7
Cj4gPiAgIAkJCXBzcl92c2Muc2RwX2hlYWRlci5IQjIgPSAweDU7Cj4gPiAgIAkJCXBzcl92c2Mu
c2RwX2hlYWRlci5IQjMgPSAweDEzOwo+ID4gICAJCX0gZWxzZSB7Cj4gPiBAQCAtMzcyLDcgKzM3
Miw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9zZXR1cF92c2Moc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCwKPiA+ICAgc3RhdGljIHZvaWQgaHN3X3Bzcl9zZXR1cF9hdXgoc3RydWN0IGludGVs
X2RwICppbnRlbF9kcCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICAgCXUzMiBhdXhfY2xvY2tfZGl2
aWRlciwgYXV4X2N0bDsKPiA+ICAgCWludCBpOwo+ID4gICAJc3RhdGljIGNvbnN0IHU4IGF1eF9t
c2dbXSA9IHsKPiA+IEBAIC00MDUsMTkgKzQwNSwxOSBAQCBzdGF0aWMgdm9pZCBoc3dfcHNyX3Nl
dHVwX2F1eChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4gICBzdGF0aWMgdm9pZCBpbnRl
bF9wc3JfZW5hYmxlX3Npbmsoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2Rw
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVs
X2RwKTsKPiA+ICAgCXU4IGRwY2RfdmFsID0gRFBfUFNSX0VOQUJMRTsKPiA+ICAgCS8qIEVuYWJs
ZSBBTFBNIGF0IHNpbmsgZm9yIHBzcjIgKi8KPiA+IC0JaWYgKGRldl9wcml2LT5wc3IucHNyMl9l
bmFibGVkKSB7Cj4gPiArCWlmIChpOTE1LT5wc3IucHNyMl9lbmFibGVkKSB7Cj4gPiAgIAkJZHJt
X2RwX2RwY2Rfd3JpdGViKCZpbnRlbF9kcC0+YXV4LCBEUF9SRUNFSVZFUl9BTFBNX0NPTkZJRywK
PiA+ICAgCQkJCSAgIERQX0FMUE1fRU5BQkxFKTsKPiA+ICAgCQlkcGNkX3ZhbCB8PSBEUF9QU1Jf
RU5BQkxFX1BTUjIgfCBEUF9QU1JfSVJRX0hQRF9XSVRIX0NSQ19FUlJPUlM7Cj4gPiAgIAl9IGVs
c2Ugewo+ID4gLQkJaWYgKGRldl9wcml2LT5wc3IubGlua19zdGFuZGJ5KQo+ID4gKwkJaWYgKGk5
MTUtPnBzci5saW5rX3N0YW5kYnkpCj4gPiAgIAkJCWRwY2RfdmFsIHw9IERQX1BTUl9NQUlOX0xJ
TktfQUNUSVZFOwo+ID4gLQkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkKPiA+ICsJCWlm
IChJTlRFTF9HRU4oaTkxNSkgPj0gOCkKPiA+ICAgCQkJZHBjZF92YWwgfD0gRFBfUFNSX0NSQ19W
RVJJRklDQVRJT047Cj4gPiAgIAl9Cj4gPiBAQCAtNDI4LDI2ICs0MjgsMjYgQEAgc3RhdGljIHZv
aWQgaW50ZWxfcHNyX2VuYWJsZV9zaW5rKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAg
IHN0YXRpYyB1MzIgaW50ZWxfcHNyMV9nZXRfdHBfdGltZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVs
X2RwKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRw
X3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gICAJdTMyIHZhbCA9IDA7Cj4gPiAtCWlmIChJTlRF
TF9HRU4oZGV2X3ByaXYpID49IDExKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+
ID4gICAJCXZhbCB8PSBFRFBfUFNSX1RQNF9USU1FXzBVUzsKPiA+IC0JaWYgKGRldl9wcml2LT52
YnQucHNyLnRwMV93YWtldXBfdGltZV91cyA9PSAwKQo+ID4gKwlpZiAoaTkxNS0+dmJ0LnBzci50
cDFfd2FrZXVwX3RpbWVfdXMgPT0gMCkKPiA+ICAgCQl2YWwgfD0gRURQX1BTUl9UUDFfVElNRV8w
dXM7Cj4gPiAtCWVsc2UgaWYgKGRldl9wcml2LT52YnQucHNyLnRwMV93YWtldXBfdGltZV91cyA8
PSAxMDApCj4gPiArCWVsc2UgaWYgKGk5MTUtPnZidC5wc3IudHAxX3dha2V1cF90aW1lX3VzIDw9
IDEwMCkKPiA+ICAgCQl2YWwgfD0gRURQX1BTUl9UUDFfVElNRV8xMDB1czsKPiA+IC0JZWxzZSBp
ZiAoZGV2X3ByaXYtPnZidC5wc3IudHAxX3dha2V1cF90aW1lX3VzIDw9IDUwMCkKPiA+ICsJZWxz
ZSBpZiAoaTkxNS0+dmJ0LnBzci50cDFfd2FrZXVwX3RpbWVfdXMgPD0gNTAwKQo+ID4gICAJCXZh
bCB8PSBFRFBfUFNSX1RQMV9USU1FXzUwMHVzOwo+ID4gICAJZWxzZQo+ID4gICAJCXZhbCB8PSBF
RFBfUFNSX1RQMV9USU1FXzI1MDB1czsKPiA+IC0JaWYgKGRldl9wcml2LT52YnQucHNyLnRwMl90
cDNfd2FrZXVwX3RpbWVfdXMgPT0gMCkKPiA+ICsJaWYgKGk5MTUtPnZidC5wc3IudHAyX3RwM193
YWtldXBfdGltZV91cyA9PSAwKQo+ID4gICAJCXZhbCB8PSBFRFBfUFNSX1RQMl9UUDNfVElNRV8w
dXM7Cj4gPiAtCWVsc2UgaWYgKGRldl9wcml2LT52YnQucHNyLnRwMl90cDNfd2FrZXVwX3RpbWVf
dXMgPD0gMTAwKQo+ID4gKwllbHNlIGlmIChpOTE1LT52YnQucHNyLnRwMl90cDNfd2FrZXVwX3Rp
bWVfdXMgPD0gMTAwKQo+ID4gICAJCXZhbCB8PSBFRFBfUFNSX1RQMl9UUDNfVElNRV8xMDB1czsK
PiA+IC0JZWxzZSBpZiAoZGV2X3ByaXYtPnZidC5wc3IudHAyX3RwM193YWtldXBfdGltZV91cyA8
PSA1MDApCj4gPiArCWVsc2UgaWYgKGk5MTUtPnZidC5wc3IudHAyX3RwM193YWtldXBfdGltZV91
cyA8PSA1MDApCj4gPiAgIAkJdmFsIHw9IEVEUF9QU1JfVFAyX1RQM19USU1FXzUwMHVzOwo+ID4g
ICAJZWxzZQo+ID4gICAJCXZhbCB8PSBFRFBfUFNSX1RQMl9UUDNfVElNRV8yNTAwdXM7Cj4gPiBA
QCAtNDYzLDMxICs0NjMsMzEgQEAgc3RhdGljIHUzMiBpbnRlbF9wc3IxX2dldF90cF90aW1lKHN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHN0YXRpYyB2b2lkIGhzd19hY3RpdmF0ZV9w
c3IxKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAl1
MzIgbWF4X3NsZWVwX3RpbWUgPSAweDFmOwo+ID4gICAJdTMyIHZhbCA9IEVEUF9QU1JfRU5BQkxF
Owo+ID4gICAJLyogTGV0J3MgdXNlIDYgYXMgdGhlIG1pbmltdW0gdG8gY292ZXIgYWxsIGtub3du
IGNhc2VzIGluY2x1ZGluZyB0aGUKPiA+ICAgCSAqIG9mZi1ieS1vbmUgaXNzdWUgdGhhdCBIVyBo
YXMgaW4gc29tZSBjYXNlcy4KPiA+ICAgCSAqLwo+ID4gLQlpbnQgaWRsZV9mcmFtZXMgPSBtYXgo
NiwgZGV2X3ByaXYtPnZidC5wc3IuaWRsZV9mcmFtZXMpOwo+ID4gKwlpbnQgaWRsZV9mcmFtZXMg
PSBtYXgoNiwgaTkxNS0+dmJ0LnBzci5pZGxlX2ZyYW1lcyk7Cj4gPiAgIAkvKiBzaW5rX3N5bmNf
bGF0ZW5jeSBvZiA4IG1lYW5zIHNvdXJjZSBoYXMgdG8gd2FpdCBmb3IgbW9yZSB0aGFuIDgKPiA+
ICAgCSAqIGZyYW1lcywgd2UnbGwgZ28gd2l0aCA5IGZyYW1lcyBmb3Igbm93Cj4gPiAgIAkgKi8K
PiA+IC0JaWRsZV9mcmFtZXMgPSBtYXgoaWRsZV9mcmFtZXMsIGRldl9wcml2LT5wc3Iuc2lua19z
eW5jX2xhdGVuY3kgKyAxKTsKPiA+ICsJaWRsZV9mcmFtZXMgPSBtYXgoaWRsZV9mcmFtZXMsIGk5
MTUtPnBzci5zaW5rX3N5bmNfbGF0ZW5jeSArIDEpOwo+ID4gICAJdmFsIHw9IGlkbGVfZnJhbWVz
IDw8IEVEUF9QU1JfSURMRV9GUkFNRV9TSElGVDsKPiA+ICAgCXZhbCB8PSBtYXhfc2xlZXBfdGlt
ZSA8PCBFRFBfUFNSX01BWF9TTEVFUF9USU1FX1NISUZUOwo+ID4gLQlpZiAoSVNfSEFTV0VMTChk
ZXZfcHJpdikpCj4gPiArCWlmIChJU19IQVNXRUxMKGk5MTUpKQo+ID4gICAJCXZhbCB8PSBFRFBf
UFNSX01JTl9MSU5LX0VOVFJZX1RJTUVfOF9MSU5FUzsKPiA+IC0JaWYgKGRldl9wcml2LT5wc3Iu
bGlua19zdGFuZGJ5KQo+ID4gKwlpZiAoaTkxNS0+cHNyLmxpbmtfc3RhbmRieSkKPiA+ICAgCQl2
YWwgfD0gRURQX1BTUl9MSU5LX1NUQU5EQlk7Cj4gPiAgIAl2YWwgfD0gaW50ZWxfcHNyMV9nZXRf
dHBfdGltZShpbnRlbF9kcCk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpCj4g
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkKPiA+ICAgCQl2YWwgfD0gRURQX1BTUl9DUkNf
RU5BQkxFOwo+ID4gICAJdmFsIHw9IEk5MTVfUkVBRChFRFBfUFNSX0NUTCkgJiBFRFBfUFNSX1JF
U1RPUkVfUFNSX0FDVElWRV9DVFhfTUFTSzsKPiA+IEBAIC00OTYsMjkgKzQ5NiwyOSBAQCBzdGF0
aWMgdm9pZCBoc3dfYWN0aXZhdGVfcHNyMShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQo+ID4g
ICBzdGF0aWMgdm9pZCBoc3dfYWN0aXZhdGVfcHNyMihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3Rv
X2k5MTUoaW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRw
X3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gICAJdTMyIHZhbDsKPiA+ICAgCS8qIExldCdzIHVzZSA2
IGFzIHRoZSBtaW5pbXVtIHRvIGNvdmVyIGFsbCBrbm93biBjYXNlcyBpbmNsdWRpbmcgdGhlCj4g
PiAgIAkgKiBvZmYtYnktb25lIGlzc3VlIHRoYXQgSFcgaGFzIGluIHNvbWUgY2FzZXMuCj4gPiAg
IAkgKi8KPiA+IC0JaW50IGlkbGVfZnJhbWVzID0gbWF4KDYsIGRldl9wcml2LT52YnQucHNyLmlk
bGVfZnJhbWVzKTsKPiA+ICsJaW50IGlkbGVfZnJhbWVzID0gbWF4KDYsIGk5MTUtPnZidC5wc3Iu
aWRsZV9mcmFtZXMpOwo+ID4gLQlpZGxlX2ZyYW1lcyA9IG1heChpZGxlX2ZyYW1lcywgZGV2X3By
aXYtPnBzci5zaW5rX3N5bmNfbGF0ZW5jeSArIDEpOwo+ID4gKwlpZGxlX2ZyYW1lcyA9IG1heChp
ZGxlX2ZyYW1lcywgaTkxNS0+cHNyLnNpbmtfc3luY19sYXRlbmN5ICsgMSk7Cj4gPiAgIAl2YWwg
PSBpZGxlX2ZyYW1lcyA8PCBFRFBfUFNSMl9JRExFX0ZSQU1FX1NISUZUOwo+ID4gICAJdmFsIHw9
IEVEUF9QU1IyX0VOQUJMRSB8IEVEUF9TVV9UUkFDS19FTkFCTEU7Cj4gPiAtCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+ID4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDEwIHx8IElTX0dFTUlOSUxBS0UoaTkxNSkpCj4gPiAgIAkJdmFs
IHw9IEVEUF9ZX0NPT1JESU5BVEVfRU5BQkxFOwo+ID4gLQl2YWwgfD0gRURQX1BTUjJfRlJBTUVf
QkVGT1JFX1NVKGRldl9wcml2LT5wc3Iuc2lua19zeW5jX2xhdGVuY3kgKyAxKTsKPiA+ICsJdmFs
IHw9IEVEUF9QU1IyX0ZSQU1FX0JFRk9SRV9TVShpOTE1LT5wc3Iuc2lua19zeW5jX2xhdGVuY3kg
KyAxKTsKPiA+IC0JaWYgKGRldl9wcml2LT52YnQucHNyLnBzcjJfdHAyX3RwM193YWtldXBfdGlt
ZV91cyA+PSAwICYmCj4gPiAtCSAgICBkZXZfcHJpdi0+dmJ0LnBzci5wc3IyX3RwMl90cDNfd2Fr
ZXVwX3RpbWVfdXMgPD0gNTApCj4gPiArCWlmIChpOTE1LT52YnQucHNyLnBzcjJfdHAyX3RwM193
YWtldXBfdGltZV91cyA+PSAwICYmCj4gPiArCSAgICBpOTE1LT52YnQucHNyLnBzcjJfdHAyX3Rw
M193YWtldXBfdGltZV91cyA8PSA1MCkKPiA+ICAgCQl2YWwgfD0gRURQX1BTUjJfVFAyX1RJTUVf
NTB1czsKPiA+IC0JZWxzZSBpZiAoZGV2X3ByaXYtPnZidC5wc3IucHNyMl90cDJfdHAzX3dha2V1
cF90aW1lX3VzIDw9IDEwMCkKPiA+ICsJZWxzZSBpZiAoaTkxNS0+dmJ0LnBzci5wc3IyX3RwMl90
cDNfd2FrZXVwX3RpbWVfdXMgPD0gMTAwKQo+ID4gICAJCXZhbCB8PSBFRFBfUFNSMl9UUDJfVElN
RV8xMDB1czsKPiA+IC0JZWxzZSBpZiAoZGV2X3ByaXYtPnZidC5wc3IucHNyMl90cDJfdHAzX3dh
a2V1cF90aW1lX3VzIDw9IDUwMCkKPiA+ICsJZWxzZSBpZiAoaTkxNS0+dmJ0LnBzci5wc3IyX3Rw
Ml90cDNfd2FrZXVwX3RpbWVfdXMgPD0gNTAwKQo+ID4gICAJCXZhbCB8PSBFRFBfUFNSMl9UUDJf
VElNRV81MDB1czsKPiA+ICAgCWVsc2UKPiA+ICAgCQl2YWwgfD0gRURQX1BTUjJfVFAyX1RJTUVf
MjUwMHVzOwo+ID4gQEAgLTUzNSwxMiArNTM1LDEyIEBAIHN0YXRpYyB2b2lkIGhzd19hY3RpdmF0
ZV9wc3IyKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHN0YXRpYyBib29sIGludGVs
X3BzcjJfY29uZmlnX3ZhbGlkKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIAkJCQkg
ICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7
Cj4gPiAgIAlpbnQgY3J0Y19oZGlzcGxheSA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9k
ZS5jcnRjX2hkaXNwbGF5Owo+ID4gICAJaW50IGNydGNfdmRpc3BsYXkgPSBjcnRjX3N0YXRlLT5i
YXNlLmFkanVzdGVkX21vZGUuY3J0Y192ZGlzcGxheTsKPiA+ICAgCWludCBwc3JfbWF4X2ggPSAw
LCBwc3JfbWF4X3YgPSAwOwo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3Iuc2lua19wc3IyX3N1cHBv
cnQpCj4gPiArCWlmICghaTkxNS0+cHNyLnNpbmtfcHNyMl9zdXBwb3J0KQo+ID4gICAJCXJldHVy
biBmYWxzZTsKPiA+ICAgCS8qCj4gPiBAQCAtNTUzLDEwICs1NTMsMTAgQEAgc3RhdGljIGJvb2wg
aW50ZWxfcHNyMl9jb25maWdfdmFsaWQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+ICAg
CQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAl9Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDEwIHx8IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShpOTE1KSkgewo+ID4gICAJCXBzcl9tYXhfaCA9IDQw
OTY7Cj4gPiAgIAkJcHNyX21heF92ID0gMjMwNDsKPiA+IC0JfSBlbHNlIGlmIChJU19HRU4oZGV2
X3ByaXYsIDkpKSB7Cj4gPiArCX0gZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDkpKSB7Cj4gPiAgIAkJ
cHNyX21heF9oID0gMzY0MDsKPiA+ICAgCQlwc3JfbWF4X3YgPSAyMzA0Owo+ID4gICAJfQo+ID4g
QEAgLTU3NCw5ICs1NzQsOSBAQCBzdGF0aWMgYm9vbCBpbnRlbF9wc3IyX2NvbmZpZ192YWxpZChz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ID4gICAJICogb25seSBuZWVkIHRvIHZhbGlkYXRl
IHRoZSBTVSBibG9jayB3aWR0aCBpcyBhIG11bHRpcGxlIG9mCj4gPiAgIAkgKiB4IGdyYW51bGFy
aXR5Lgo+ID4gICAJICovCj4gPiAtCWlmIChjcnRjX2hkaXNwbGF5ICUgZGV2X3ByaXYtPnBzci5z
dV94X2dyYW51bGFyaXR5KSB7Cj4gPiArCWlmIChjcnRjX2hkaXNwbGF5ICUgaTkxNS0+cHNyLnN1
X3hfZ3JhbnVsYXJpdHkpIHsKPiA+ICAgCQlEUk1fREVCVUdfS01TKCJQU1IyIG5vdCBlbmFibGVk
LCBoZGlzcGxheSglZCkgbm90IG11bHRpcGxlIG9mICVkXG4iLAo+ID4gLQkJCSAgICAgIGNydGNf
aGRpc3BsYXksIGRldl9wcml2LT5wc3Iuc3VfeF9ncmFudWxhcml0eSk7Cj4gPiArCQkJICAgICAg
Y3J0Y19oZGlzcGxheSwgaTkxNS0+cHNyLnN1X3hfZ3JhbnVsYXJpdHkpOwo+ID4gICAJCXJldHVy
biBmYWxzZTsKPiA+ICAgCX0KPiA+IEBAIC01OTIsMTUgKzU5MiwxNSBAQCB2b2lkIGludGVsX3Bz
cl9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ID4gICAJCQkgICAg
ICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3Ry
dWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9k
cCk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUo
aW50ZWxfZHApOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5
MTUoaW50ZWxfZHApOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVz
dGVkX21vZGUgPQo+ID4gICAJCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gPiAg
IAlpbnQgcHNyX3NldHVwX3RpbWU7Cj4gPiAtCWlmICghQ0FOX1BTUihkZXZfcHJpdikpCj4gPiAr
CWlmICghQ0FOX1BTUihpOTE1KSkKPiA+ICAgCQlyZXR1cm47Cj4gPiAtCWlmIChpbnRlbF9kcCAh
PSBkZXZfcHJpdi0+cHNyLmRwKQo+ID4gKwlpZiAoaW50ZWxfZHAgIT0gaTkxNS0+cHNyLmRwKQo+
ID4gICAJCXJldHVybjsKPiA+ICAgCS8qCj4gPiBAQCAtNjE1LDcgKzYxNSw3IEBAIHZvaWQgaW50
ZWxfcHNyX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIAkJ
cmV0dXJuOwo+ID4gICAJfQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5zaW5rX25vdF9yZWxpYWJs
ZSkgewo+ID4gKwlpZiAoaTkxNS0+cHNyLnNpbmtfbm90X3JlbGlhYmxlKSB7Cj4gPiAgIAkJRFJN
X0RFQlVHX0tNUygiUFNSIHNpbmsgaW1wbGVtZW50YXRpb24gaXMgbm90IHJlbGlhYmxlXG4iKTsK
PiA+ICAgCQlyZXR1cm47Cj4gPiAgIAl9Cj4gPiBAQCAtNjQ1LDI0ICs2NDUsMjQgQEAgdm9pZCBp
bnRlbF9wc3JfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+ICAg
c3RhdGljIHZvaWQgaW50ZWxfcHNyX2FjdGl2YXRlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9f
aTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBf
dG9faTkxNShpbnRlbF9kcCk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4g
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKPiA+ICAgCQlXQVJOX09OKEk5MTVfUkVBRChF
RFBfUFNSMl9DVEwpICYgRURQX1BTUjJfRU5BQkxFKTsKPiA+ICAgCVdBUk5fT04oSTkxNV9SRUFE
KEVEUF9QU1JfQ1RMKSAmIEVEUF9QU1JfRU5BQkxFKTsKPiA+IC0JV0FSTl9PTihkZXZfcHJpdi0+
cHNyLmFjdGl2ZSk7Cj4gPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5wc3IubG9j
ayk7Cj4gPiArCVdBUk5fT04oaTkxNS0+cHNyLmFjdGl2ZSk7Cj4gPiArCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmk5MTUtPnBzci5sb2NrKTsKPiA+ICAgCS8qIHBzcjEgYW5kIHBzcjIgYXJlIG11dHVh
bGx5IGV4Y2x1c2l2ZS4qLwo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQpCj4g
PiArCWlmIChpOTE1LT5wc3IucHNyMl9lbmFibGVkKQo+ID4gICAJCWhzd19hY3RpdmF0ZV9wc3Iy
KGludGVsX2RwKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQloc3dfYWN0aXZhdGVfcHNyMShpbnRlbF9k
cCk7Cj4gPiAtCWRldl9wcml2LT5wc3IuYWN0aXZlID0gdHJ1ZTsKPiA+ICsJaTkxNS0+cHNyLmFj
dGl2ZSA9IHRydWU7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaTkxNV9yZWdfdCBnZW45X2NoaWNrZW5f
dHJhbnNfcmVnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMg
aTkxNV9yZWdfdCBnZW45X2NoaWNrZW5fdHJhbnNfcmVnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+ID4gICAJCQkJCSBlbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIpCj4gPiAg
IHsKPiA+ICAgCXN0YXRpYyBjb25zdCBpOTE1X3JlZ190IHJlZ3NbXSA9IHsKPiA+IEBAIC02NzIs
NyArNjcyLDcgQEAgc3RhdGljIGk5MTVfcmVnX3QgZ2VuOV9jaGlja2VuX3RyYW5zX3JlZyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJW1RSQU5TQ09ERVJfRURQXSA9
IENISUNLRU5fVFJBTlNfRURQLAo+ID4gICAJfTsKPiA+IC0JV0FSTl9PTihJTlRFTF9HRU4oZGV2
X3ByaXYpIDwgOSk7Cj4gPiArCVdBUk5fT04oSU5URUxfR0VOKGk5MTUpIDwgOSk7Cj4gPiAgIAlp
ZiAoV0FSTl9PTihjcHVfdHJhbnNjb2RlciA+PSBBUlJBWV9TSVpFKHJlZ3MpIHx8Cj4gPiAgIAkJ
ICAgICFyZWdzW2NwdV90cmFuc2NvZGVyXS5yZWcpKQo+ID4gQEAgLTY4NCwxOSArNjg0LDE5IEBA
IHN0YXRpYyBpOTE1X3JlZ190IGdlbjlfY2hpY2tlbl90cmFuc19yZWcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxlX3Nv
dXJjZShzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ID4gICAJCQkJICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOwo+ID4gICAJ
ZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29k
ZXI7Cj4gPiAgIAl1MzIgbWFzazsKPiA+ICAgCS8qIE9ubHkgSFNXIGFuZCBCRFcgaGF2ZSBQU1Ig
QVVYIHJlZ2lzdGVycyB0aGF0IG5lZWQgdG8gYmUgc2V0dXAuIFNLTCsKPiA+ICAgCSAqIHVzZSBo
YXJkY29kZWQgdmFsdWVzIFBTUiBBVVggdHJhbnNhY3Rpb25zCj4gPiAgIAkgKi8KPiA+IC0JaWYg
KElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpCj4gPiArCWlm
IChJU19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkKPiA+ICAgCQloc3dfcHNy
X3NldHVwX2F1eChpbnRlbF9kcCk7Cj4gPiAtCWlmIChkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxl
ZCAmJiAoSVNfR0VOKGRldl9wcml2LCA5KSAmJgo+ID4gLQkJCQkJICAgIUlTX0dFTUlOSUxBS0Uo
ZGV2X3ByaXYpKSkgewo+ID4gLQkJaTkxNV9yZWdfdCByZWcgPSBnZW45X2NoaWNrZW5fdHJhbnNf
cmVnKGRldl9wcml2LAo+ID4gKwlpZiAoaTkxNS0+cHNyLnBzcjJfZW5hYmxlZCAmJiAoSVNfR0VO
KGk5MTUsIDkpICYmCj4gPiArCQkJCQkgICAhSVNfR0VNSU5JTEFLRShpOTE1KSkpIHsKPiA+ICsJ
CWk5MTVfcmVnX3QgcmVnID0gZ2VuOV9jaGlja2VuX3RyYW5zX3JlZyhpOTE1LAo+ID4gICAJCQkJ
CQkJY3B1X3RyYW5zY29kZXIpOwo+ID4gICAJCXUzMiBjaGlja2VuID0gSTkxNV9SRUFEKHJlZyk7
Cj4gPiBAQCAtNzE2LDI5ICs3MTYsMjkgQEAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX2VuYWJsZV9z
b3VyY2Uoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+ICAgCSAgICAgICBFRFBfUFNSX0RF
QlVHX01BU0tfTFBTUCB8Cj4gPiAgIAkgICAgICAgRURQX1BTUl9ERUJVR19NQVNLX01BWF9TTEVF
UDsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCAxMSkKPiA+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA8IDExKQo+ID4gICAJCW1hc2sgfD0gRURQX1BTUl9ERUJVR19NQVNLX0RJU1BfUkVH
X1dSSVRFOwo+ID4gICAJSTkxNV9XUklURShFRFBfUFNSX0RFQlVHLCBtYXNrKTsKPiA+ICAgfQo+
ID4gLXN0YXRpYyB2b2lkIGludGVsX3Bzcl9lbmFibGVfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZW5hYmxlX2xvY2tl
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgaW50
ZWxfZHAgKmludGVsX2RwID0gZGV2X3ByaXYtPnBzci5kcDsKPiA+ICsJc3RydWN0IGludGVsX2Rw
ICppbnRlbF9kcCA9IGk5MTUtPnBzci5kcDsKPiA+IC0JV0FSTl9PTihkZXZfcHJpdi0+cHNyLmVu
YWJsZWQpOwo+ID4gKwlXQVJOX09OKGk5MTUtPnBzci5lbmFibGVkKTsKPiA+IC0JZGV2X3ByaXYt
PnBzci5wc3IyX2VuYWJsZWQgPSBpbnRlbF9wc3IyX2VuYWJsZWQoZGV2X3ByaXYsIGNydGNfc3Rh
dGUpOwo+ID4gLQlkZXZfcHJpdi0+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cyA9IDA7Cj4gPiAt
CWRldl9wcml2LT5wc3IucGlwZSA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRj
KS0+cGlwZTsKPiA+ICsJaTkxNS0+cHNyLnBzcjJfZW5hYmxlZCA9IGludGVsX3BzcjJfZW5hYmxl
ZChpOTE1LCBjcnRjX3N0YXRlKTsKPiA+ICsJaTkxNS0+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0
cyA9IDA7Cj4gPiArCWk5MTUtPnBzci5waXBlID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5i
YXNlLmNydGMpLT5waXBlOwo+ID4gICAJRFJNX0RFQlVHX0tNUygiRW5hYmxpbmcgUFNSJXNcbiIs
Cj4gPiAtCQkgICAgICBkZXZfcHJpdi0+cHNyLnBzcjJfZW5hYmxlZCA/ICIyIiA6ICIxIik7Cj4g
PiArCQkgICAgICBpOTE1LT5wc3IucHNyMl9lbmFibGVkID8gIjIiIDogIjEiKTsKPiA+ICAgCWlu
dGVsX3Bzcl9zZXR1cF92c2MoaW50ZWxfZHAsIGNydGNfc3RhdGUpOwo+ID4gICAJaW50ZWxfcHNy
X2VuYWJsZV9zaW5rKGludGVsX2RwKTsKPiA+ICAgCWludGVsX3Bzcl9lbmFibGVfc291cmNlKGlu
dGVsX2RwLCBjcnRjX3N0YXRlKTsKPiA+IC0JZGV2X3ByaXYtPnBzci5lbmFibGVkID0gdHJ1ZTsK
PiA+ICsJaTkxNS0+cHNyLmVuYWJsZWQgPSB0cnVlOwo+ID4gICAJaW50ZWxfcHNyX2FjdGl2YXRl
KGludGVsX2RwKTsKPiA+ICAgfQo+ID4gQEAgLTc1Myw0MSArNzUzLDQxIEBAIHN0YXRpYyB2b2lk
IGludGVsX3Bzcl9lbmFibGVfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICAgdm9pZCBpbnRlbF9wc3JfZW5hYmxlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAs
Cj4gPiAgIAkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9f
aTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBf
dG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAlpZiAoIWNydGNfc3RhdGUtPmhhc19wc3IpCj4gPiAg
IAkJcmV0dXJuOwo+ID4gLQlpZiAoV0FSTl9PTighQ0FOX1BTUihkZXZfcHJpdikpKQo+ID4gKwlp
ZiAoV0FSTl9PTighQ0FOX1BTUihpOTE1KSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQlXQVJOX09O
KGRldl9wcml2LT5kcnJzLmRwKTsKPiA+ICsJV0FSTl9PTihpOTE1LT5kcnJzLmRwKTsKPiA+IC0J
bXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+
cHNyLmxvY2spOwo+ID4gLQlpZiAoIXBzcl9nbG9iYWxfZW5hYmxlZChkZXZfcHJpdi0+cHNyLmRl
YnVnKSkgewo+ID4gKwlpZiAoIXBzcl9nbG9iYWxfZW5hYmxlZChpOTE1LT5wc3IuZGVidWcpKSB7
Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiUFNSIGRpc2FibGVkIGJ5IGZsYWdcbiIpOwo+ID4gICAJ
CWdvdG8gdW5sb2NrOwo+ID4gICAJfQo+ID4gLQlpbnRlbF9wc3JfZW5hYmxlX2xvY2tlZChkZXZf
cHJpdiwgY3J0Y19zdGF0ZSk7Cj4gPiArCWludGVsX3Bzcl9lbmFibGVfbG9ja2VkKGk5MTUsIGNy
dGNfc3RhdGUpOwo+ID4gICB1bmxvY2s6Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBz
ci5sb2NrKTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5wc3IubG9jayk7Cj4gPiAgIH0KPiA+
IC1zdGF0aWMgdm9pZCBpbnRlbF9wc3JfZXhpdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgaW50ZWxfcHNyX2V4aXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAtCWlmICghZGV2X3ByaXYt
PnBzci5hY3RpdmUpIHsKPiA+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiAr
CWlmICghaTkxNS0+cHNyLmFjdGl2ZSkgewo+ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5
KQo+ID4gICAJCQlXQVJOX09OKEk5MTVfUkVBRChFRFBfUFNSMl9DVEwpICYgRURQX1BTUjJfRU5B
QkxFKTsKPiA+ICAgCQlXQVJOX09OKEk5MTVfUkVBRChFRFBfUFNSX0NUTCkgJiBFRFBfUFNSX0VO
QUJMRSk7Cj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJfQo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5w
c3IyX2VuYWJsZWQpIHsKPiA+ICsJaWYgKGk5MTUtPnBzci5wc3IyX2VuYWJsZWQpIHsKPiA+ICAg
CQl2YWwgPSBJOTE1X1JFQUQoRURQX1BTUjJfQ1RMKTsKPiA+ICAgCQlXQVJOX09OKCEodmFsICYg
RURQX1BTUjJfRU5BQkxFKSk7Cj4gPiAgIAkJSTkxNV9XUklURShFRFBfUFNSMl9DVEwsIHZhbCAm
IH5FRFBfUFNSMl9FTkFCTEUpOwo+ID4gQEAgLTc5NiwyNiArNzk2LDI2IEBAIHN0YXRpYyB2b2lk
IGludGVsX3Bzcl9leGl0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAg
CQlXQVJOX09OKCEodmFsICYgRURQX1BTUl9FTkFCTEUpKTsKPiA+ICAgCQlJOTE1X1dSSVRFKEVE
UF9QU1JfQ1RMLCB2YWwgJiB+RURQX1BTUl9FTkFCTEUpOwo+ID4gICAJfQo+ID4gLQlkZXZfcHJp
di0+cHNyLmFjdGl2ZSA9IGZhbHNlOwo+ID4gKwlpOTE1LT5wc3IuYWN0aXZlID0gZmFsc2U7Cj4g
PiAgIH0KPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfcHNyX2Rpc2FibGVfbG9ja2VkKHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAlpOTE1X3JlZ190IHBz
cl9zdGF0dXM7Cj4gPiAgIAl1MzIgcHNyX3N0YXR1c19tYXNrOwo+ID4gLQlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZkZXZfcHJpdi0+cHNyLmxvY2spOwo+ID4gKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZp
OTE1LT5wc3IubG9jayk7Cj4gPiAtCWlmICghZGV2X3ByaXYtPnBzci5lbmFibGVkKQo+ID4gKwlp
ZiAoIWk5MTUtPnBzci5lbmFibGVkKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCURSTV9ERUJVR19L
TVMoIkRpc2FibGluZyBQU1Ilc1xuIiwKPiA+IC0JCSAgICAgIGRldl9wcml2LT5wc3IucHNyMl9l
bmFibGVkID8gIjIiIDogIjEiKTsKPiA+ICsJCSAgICAgIGk5MTUtPnBzci5wc3IyX2VuYWJsZWQg
PyAiMiIgOiAiMSIpOwo+ID4gLQlpbnRlbF9wc3JfZXhpdChkZXZfcHJpdik7Cj4gPiArCWludGVs
X3Bzcl9leGl0KGk5MTUpOwo+ID4gLQlpZiAoZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQpIHsK
PiA+ICsJaWYgKGk5MTUtPnBzci5wc3IyX2VuYWJsZWQpIHsKPiA+ICAgCQlwc3Jfc3RhdHVzID0g
RURQX1BTUjJfU1RBVFVTOwo+ID4gICAJCXBzcl9zdGF0dXNfbWFzayA9IEVEUF9QU1IyX1NUQVRV
U19TVEFURV9NQVNLOwo+ID4gICAJfSBlbHNlIHsKPiA+IEBAIC04MjQsMTQgKzgyNCwxNCBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9wc3JfZGlzYWJsZV9sb2NrZWQoc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCkKPiA+ICAgCX0KPiA+ICAgCS8qIFdhaXQgdGlsbCBQU1IgaXMgaWRsZSAqLwo+ID4gLQlp
ZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCWlmIChp
bnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJICAgIHBzcl9z
dGF0dXMsIHBzcl9zdGF0dXNfbWFzaywgMCwgMjAwMCkpCj4gPiAgIAkJRFJNX0VSUk9SKCJUaW1l
ZCBvdXQgd2FpdGluZyBQU1IgaWRsZSBzdGF0ZVxuIik7Cj4gPiAgIAkvKiBEaXNhYmxlIFBTUiBv
biBTaW5rICovCj4gPiAgIAlkcm1fZHBfZHBjZF93cml0ZWIoJmludGVsX2RwLT5hdXgsIERQX1BT
Ul9FTl9DRkcsIDApOwo+ID4gLQlkZXZfcHJpdi0+cHNyLmVuYWJsZWQgPSBmYWxzZTsKPiA+ICsJ
aTkxNS0+cHNyLmVuYWJsZWQgPSBmYWxzZTsKPiA+ICAgfQo+ID4gICAvKioKPiA+IEBAIC04NDQs
MjMgKzg0NCwyMyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfZGlzYWJsZV9sb2NrZWQoc3RydWN0
IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgdm9pZCBpbnRlbF9wc3JfZGlzYWJsZShzdHJ1Y3Qg
aW50ZWxfZHAgKmludGVsX2RwLAo+ID4gICAJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAgIAlpZiAoIW9s
ZF9jcnRjX3N0YXRlLT5oYXNfcHNyKQo+ID4gICAJCXJldHVybjsKPiA+IC0JaWYgKFdBUk5fT04o
IUNBTl9QU1IoZGV2X3ByaXYpKSkKPiA+ICsJaWYgKFdBUk5fT04oIUNBTl9QU1IoaTkxNSkpKQo+
ID4gICAJCXJldHVybjsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPnBzci5sb2NrKTsKPiA+
ICsJbXV0ZXhfbG9jaygmaTkxNS0+cHNyLmxvY2spOwo+ID4gICAJaW50ZWxfcHNyX2Rpc2FibGVf
bG9ja2VkKGludGVsX2RwKTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2sp
Owo+ID4gLQljYW5jZWxfd29ya19zeW5jKCZkZXZfcHJpdi0+cHNyLndvcmspOwo+ID4gKwltdXRl
eF91bmxvY2soJmk5MTUtPnBzci5sb2NrKTsKPiA+ICsJY2FuY2VsX3dvcmtfc3luYygmaTkxNS0+
cHNyLndvcmspOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgcHNyX2ZvcmNlX2h3X3RyYWNraW5n
X2V4aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRpYyB2b2lk
IHBzcl9mb3JjZV9od190cmFja2luZ19leGl0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ID4gICB7Cj4gPiAgIAkvKgo+ID4gICAJICogRGlzcGxheSBXQSAjMDg4NDogYWxsCj4gPiBA
QCAtODcxLDcgKzg3MSw3IEBAIHN0YXRpYyB2b2lkIHBzcl9mb3JjZV9od190cmFja2luZ19leGl0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCSAqIGJ1dCBpdCBtYWtl
cyBtb3JlIHNlbnNlIHdyaXRlIHRvIHRoZSBjdXJyZW50IGFjdGl2ZQo+ID4gICAJICogcGlwZS4K
PiA+ICAgCSAqLwo+ID4gLQlJOTE1X1dSSVRFKENVUlNVUkZMSVZFKGRldl9wcml2LT5wc3IucGlw
ZSksIDApOwo+ID4gKwlJOTE1X1dSSVRFKENVUlNVUkZMSVZFKGk5MTUtPnBzci5waXBlKSwgMCk7
Cj4gPiAgIH0KPiA+ICAgLyoqCj4gPiBAQCAtODg2LDIyICs4ODYsMjIgQEAgc3RhdGljIHZvaWQg
cHNyX2ZvcmNlX2h3X3RyYWNraW5nX2V4aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ID4gICB2b2lkIGludGVsX3Bzcl91cGRhdGUoc3RydWN0IGludGVsX2RwICppbnRlbF9k
cCwKPiA+ICAgCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90
b19pOTE1KGludGVsX2RwKTsKPiA+IC0Jc3RydWN0IGk5MTVfcHNyICpwc3IgPSAmZGV2X3ByaXYt
PnBzcjsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGlu
dGVsX2RwKTsKPiA+ICsJc3RydWN0IGk5MTVfcHNyICpwc3IgPSAmaTkxNS0+cHNyOwo+ID4gICAJ
Ym9vbCBlbmFibGUsIHBzcjJfZW5hYmxlOwo+ID4gLQlpZiAoIUNBTl9QU1IoZGV2X3ByaXYpIHx8
IFJFQURfT05DRShwc3ItPmRwKSAhPSBpbnRlbF9kcCkKPiA+ICsJaWYgKCFDQU5fUFNSKGk5MTUp
IHx8IFJFQURfT05DRShwc3ItPmRwKSAhPSBpbnRlbF9kcCkKPiA+ICAgCQlyZXR1cm47Cj4gPiAt
CW11dGV4X2xvY2soJmRldl9wcml2LT5wc3IubG9jayk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUt
PnBzci5sb2NrKTsKPiA+ICAgCWVuYWJsZSA9IGNydGNfc3RhdGUtPmhhc19wc3IgJiYgcHNyX2ds
b2JhbF9lbmFibGVkKHBzci0+ZGVidWcpOwo+ID4gLQlwc3IyX2VuYWJsZSA9IGludGVsX3BzcjJf
ZW5hYmxlZChkZXZfcHJpdiwgY3J0Y19zdGF0ZSk7Cj4gPiArCXBzcjJfZW5hYmxlID0gaW50ZWxf
cHNyMl9lbmFibGVkKGk5MTUsIGNydGNfc3RhdGUpOwo+ID4gICAJaWYgKGVuYWJsZSA9PSBwc3It
PmVuYWJsZWQgJiYgcHNyMl9lbmFibGUgPT0gcHNyLT5wc3IyX2VuYWJsZWQpIHsKPiA+ICAgCQkv
KiBGb3JjZSBhIFBTUiBleGl0IHdoZW4gZW5hYmxpbmcgQ1JDIHRvIGF2b2lkIENSQyB0aW1lb3V0
cyAqLwo+ID4gICAJCWlmIChjcnRjX3N0YXRlLT5jcmNfZW5hYmxlZCAmJiBwc3ItPmVuYWJsZWQp
Cj4gPiAtCQkJcHNyX2ZvcmNlX2h3X3RyYWNraW5nX2V4aXQoZGV2X3ByaXYpOwo+ID4gKwkJCXBz
cl9mb3JjZV9od190cmFja2luZ19leGl0KGk5MTUpOwo+ID4gICAJCWdvdG8gdW5sb2NrOwo+ID4g
ICAJfQo+ID4gQEAgLTkxMCwxMCArOTEwLDEwIEBAIHZvaWQgaW50ZWxfcHNyX3VwZGF0ZShzdHJ1
Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+ID4gICAJCWludGVsX3Bzcl9kaXNhYmxlX2xvY2tlZChp
bnRlbF9kcCk7Cj4gPiAgIAlpZiAoZW5hYmxlKQo+ID4gLQkJaW50ZWxfcHNyX2VuYWJsZV9sb2Nr
ZWQoZGV2X3ByaXYsIGNydGNfc3RhdGUpOwo+ID4gKwkJaW50ZWxfcHNyX2VuYWJsZV9sb2NrZWQo
aTkxNSwgY3J0Y19zdGF0ZSk7Cj4gPiAgIHVubG9jazoKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+cHNyLmxvY2spOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPnBzci5sb2NrKTsKPiA+
ICAgfQo+ID4gICAvKioKPiA+IEBAIC05MzAsMTMgKzkzMCwxMyBAQCBpbnQgaW50ZWxfcHNyX3dh
aXRfZm9yX2lkbGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRl
LAo+ID4gICAJCQkgICAgdTMyICpvdXRfdmFsdWUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4gPiAtCWlmICghZGV2X3ByaXYtPnBzci5lbmFibGVkIHx8ICFuZXdf
Y3J0Y19zdGF0ZS0+aGFzX3BzcikKPiA+ICsJaWYgKCFpOTE1LT5wc3IuZW5hYmxlZCB8fCAhbmV3
X2NydGNfc3RhdGUtPmhhc19wc3IpCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAgIAkvKiBGSVhNRTog
VXBkYXRlIHRoaXMgZm9yIFBTUjIgaWYgd2UgbmVlZCB0byB3YWl0IGZvciBpZGxlICovCj4gPiAt
CWlmIChSRUFEX09OQ0UoZGV2X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQpKQo+ID4gKwlpZiAoUkVB
RF9PTkNFKGk5MTUtPnBzci5wc3IyX2VuYWJsZWQpKQo+ID4gICAJCXJldHVybiAwOwo+ID4gICAJ
LyoKPiA+IEBAIC05NDYsMjIgKzk0NiwyMiBAQCBpbnQgaW50ZWxfcHNyX3dhaXRfZm9yX2lkbGUo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlLAo+ID4gICAJICog
ZGVmZW5zaXZlIGVub3VnaCB0byBjb3ZlciBldmVyeXRoaW5nLgo+ID4gICAJICovCj4gPiAtCXJl
dHVybiBfX2ludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLCBFRFBfUFNS
X1NUQVRVUywKPiA+ICsJcmV0dXJuIF9faW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVu
Y29yZSwgRURQX1BTUl9TVEFUVVMsCj4gPiAgIAkJCQkJIEVEUF9QU1JfU1RBVFVTX1NUQVRFX01B
U0ssCj4gPiAgIAkJCQkJIEVEUF9QU1JfU1RBVFVTX1NUQVRFX0lETEUsIDIsIDUwLAo+ID4gICAJ
CQkJCSBvdXRfdmFsdWUpOwo+ID4gICB9Cj4gPiAtc3RhdGljIGJvb2wgX19wc3Jfd2FpdF9mb3Jf
aWRsZV9sb2NrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK3N0YXRp
YyBib29sIF9fcHNyX3dhaXRfZm9yX2lkbGVfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQo+ID4gICB7Cj4gPiAgIAlpOTE1X3JlZ190IHJlZzsKPiA+ICAgCXUzMiBtYXNrOwo+
ID4gICAJaW50IGVycjsKPiA+IC0JaWYgKCFkZXZfcHJpdi0+cHNyLmVuYWJsZWQpCj4gPiArCWlm
ICghaTkxNS0+cHNyLmVuYWJsZWQpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gLQlpZiAoZGV2
X3ByaXYtPnBzci5wc3IyX2VuYWJsZWQpIHsKPiA+ICsJaWYgKGk5MTUtPnBzci5wc3IyX2VuYWJs
ZWQpIHsKPiA+ICAgCQlyZWcgPSBFRFBfUFNSMl9TVEFUVVM7Cj4gPiAgIAkJbWFzayA9IEVEUF9Q
U1IyX1NUQVRVU19TVEFURV9NQVNLOwo+ID4gICAJfSBlbHNlIHsKPiA+IEBAIC05NjksMjAgKzk2
OSwyMCBAQCBzdGF0aWMgYm9vbCBfX3Bzcl93YWl0X2Zvcl9pZGxlX2xvY2tlZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkJbWFzayA9IEVEUF9QU1JfU1RBVFVTX1NU
QVRFX01BU0s7Cj4gPiAgIAl9Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPnBzci5sb2Nr
KTsKPiA+ICsJbXV0ZXhfdW5sb2NrKCZpOTE1LT5wc3IubG9jayk7Cj4gPiAtCWVyciA9IGludGVs
X3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLCByZWcsIG1hc2ssIDAsIDUwKTsK
PiA+ICsJZXJyID0gaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwgcmVnLCBt
YXNrLCAwLCA1MCk7Cj4gPiAgIAlpZiAoZXJyKQo+ID4gICAJCURSTV9FUlJPUigiVGltZWQgb3V0
IHdhaXRpbmcgZm9yIFBTUiBJZGxlIGZvciByZS1lbmFibGVcbiIpOwo+ID4gICAJLyogQWZ0ZXIg
dGhlIHVubG9ja2VkIHdhaXQsIHZlcmlmeSB0aGF0IFBTUiBpcyBzdGlsbCB3YW50ZWQhICovCj4g
PiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5wc3IubG9jayk7Cj4gPiAtCXJldHVybiBlcnIgPT0g
MCAmJiBkZXZfcHJpdi0+cHNyLmVuYWJsZWQ7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPnBzci5s
b2NrKTsKPiA+ICsJcmV0dXJuIGVyciA9PSAwICYmIGk5MTUtPnBzci5lbmFibGVkOwo+ID4gICB9
Cj4gPiAtc3RhdGljIGludCBpbnRlbF9wc3JfZmFzdHNldF9mb3JjZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGljIGludCBpbnRlbF9wc3JfZmFzdHNldF9mb3Jj
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Cj4gPiArCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSAmaTkxNS0+ZHJtOwo+ID4gICAJc3RydWN0IGRybV9tb2Rlc2V0X2FjcXVpcmVfY3R4IGN0
eDsKPiA+ICAgCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZTsKPiA+ICAgCXN0cnVjdCBk
cm1fY3J0YyAqY3J0YzsKPiA+IEBAIC0xMDMyLDcgKzEwMzIsNyBAQCBzdGF0aWMgaW50IGludGVs
X3Bzcl9mYXN0c2V0X2ZvcmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICAgCXJldHVybiBlcnI7Cj4gPiAgIH0KPiA+IC1pbnQgaW50ZWxfcHNyX2RlYnVnX3NldChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU2NCB2YWwpCj4gPiAraW50IGludGVsX3Bz
cl9kZWJ1Z19zZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU2NCB2YWwpCj4gPiAg
IHsKPiA+ICAgCWNvbnN0IHUzMiBtb2RlID0gdmFsICYgSTkxNV9QU1JfREVCVUdfTU9ERV9NQVNL
Owo+ID4gICAJdTMyIG9sZF9tb2RlOwo+ID4gQEAgLTEwNDQsMjUgKzEwNDQsMjUgQEAgaW50IGlu
dGVsX3Bzcl9kZWJ1Z19zZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1NjQg
dmFsKQo+ID4gICAJCXJldHVybiAtRUlOVkFMOwo+ID4gICAJfQo+ID4gLQlyZXQgPSBtdXRleF9s
b2NrX2ludGVycnVwdGlibGUoJmRldl9wcml2LT5wc3IubG9jayk7Cj4gPiArCXJldCA9IG11dGV4
X2xvY2tfaW50ZXJydXB0aWJsZSgmaTkxNS0+cHNyLmxvY2spOwo+ID4gICAJaWYgKHJldCkKPiA+
ICAgCQlyZXR1cm4gcmV0Owo+ID4gLQlvbGRfbW9kZSA9IGRldl9wcml2LT5wc3IuZGVidWcgJiBJ
OTE1X1BTUl9ERUJVR19NT0RFX01BU0s7Cj4gPiAtCWRldl9wcml2LT5wc3IuZGVidWcgPSB2YWw7
Cj4gPiAtCWludGVsX3Bzcl9pcnFfY29udHJvbChkZXZfcHJpdiwgZGV2X3ByaXYtPnBzci5kZWJ1
Zyk7Cj4gPiArCW9sZF9tb2RlID0gaTkxNS0+cHNyLmRlYnVnICYgSTkxNV9QU1JfREVCVUdfTU9E
RV9NQVNLOwo+ID4gKwlpOTE1LT5wc3IuZGVidWcgPSB2YWw7Cj4gPiArCWludGVsX3Bzcl9pcnFf
Y29udHJvbChpOTE1LCBpOTE1LT5wc3IuZGVidWcpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9w
cml2LT5wc3IubG9jayk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+cHNyLmxvY2spOwo+ID4g
ICAJaWYgKG9sZF9tb2RlICE9IG1vZGUpCj4gPiAtCQlyZXQgPSBpbnRlbF9wc3JfZmFzdHNldF9m
b3JjZShkZXZfcHJpdik7Cj4gPiArCQlyZXQgPSBpbnRlbF9wc3JfZmFzdHNldF9mb3JjZShpOTE1
KTsKPiA+ICAgCXJldHVybiByZXQ7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgdm9pZCBpbnRlbF9wc3Jf
aGFuZGxlX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiArc3RhdGlj
IHZvaWQgaW50ZWxfcHNyX2hhbmRsZV9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
Cj4gPiAgIHsKPiA+IC0Jc3RydWN0IGk5MTVfcHNyICpwc3IgPSAmZGV2X3ByaXYtPnBzcjsKPiA+
ICsJc3RydWN0IGk5MTVfcHNyICpwc3IgPSAmaTkxNS0+cHNyOwo+ID4gICAJaW50ZWxfcHNyX2Rp
c2FibGVfbG9ja2VkKHBzci0+ZHApOwo+ID4gICAJcHNyLT5zaW5rX25vdF9yZWxpYWJsZSA9IHRy
dWU7Cj4gPiBAQCAtMTA3MiwxNiArMTA3MiwxNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3JfaGFu
ZGxlX2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIHN0YXRpYyB2
b2lkIGludGVsX3Bzcl93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gLQkJY29udGFpbmVyX29m
KHdvcmssIHR5cGVvZigqZGV2X3ByaXYpLCBwc3Iud29yayk7Cj4gPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0KPiA+ICsJCWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmk5MTUp
LCBwc3Iud29yayk7Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5wc3IubG9jayk7Cj4gPiAr
CW11dGV4X2xvY2soJmk5MTUtPnBzci5sb2NrKTsKPiA+IC0JaWYgKCFkZXZfcHJpdi0+cHNyLmVu
YWJsZWQpCj4gPiArCWlmICghaTkxNS0+cHNyLmVuYWJsZWQpCj4gPiAgIAkJZ290byB1bmxvY2s7
Cj4gPiAtCWlmIChSRUFEX09OQ0UoZGV2X3ByaXYtPnBzci5pcnFfYXV4X2Vycm9yKSkKPiA+IC0J
CWludGVsX3Bzcl9oYW5kbGVfaXJxKGRldl9wcml2KTsKPiA+ICsJaWYgKFJFQURfT05DRShpOTE1
LT5wc3IuaXJxX2F1eF9lcnJvcikpCj4gPiArCQlpbnRlbF9wc3JfaGFuZGxlX2lycShpOTE1KTsK
PiA+ICAgCS8qCj4gPiAgIAkgKiBXZSBoYXZlIHRvIG1ha2Ugc3VyZSBQU1IgaXMgcmVhZHkgZm9y
IHJlLWVuYWJsZQo+ID4gQEAgLTEwODksNyArMTA4OSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bz
cl93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiA+ICAgCSAqIFBTUiBtaWdodCB0YWtl
IHNvbWUgdGltZSB0byBnZXQgZnVsbHkgZGlzYWJsZWQKPiA+ICAgCSAqIGFuZCBiZSByZWFkeSBm
b3IgcmUtZW5hYmxlLgo+ID4gICAJICovCj4gPiAtCWlmICghX19wc3Jfd2FpdF9mb3JfaWRsZV9s
b2NrZWQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIV9fcHNyX3dhaXRfZm9yX2lkbGVfbG9ja2VkKGk5
MTUpKQo+ID4gICAJCWdvdG8gdW5sb2NrOwo+ID4gICAJLyoKPiA+IEBAIC0xMDk3LDE3ICsxMDk3
LDE3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29y
aykKPiA+ICAgCSAqIHJlY2hlY2suIFNpbmNlIHBzcl9mbHVzaCBmaXJzdCBjbGVhcnMgdGhpcyBh
bmQgdGhlbiByZXNjaGVkdWxlcyB3ZQo+ID4gICAJICogd29uJ3QgZXZlciBtaXNzIGEgZmx1c2gg
d2hlbiBiYWlsaW5nIG91dCBoZXJlLgo+ID4gICAJICovCj4gPiAtCWlmIChkZXZfcHJpdi0+cHNy
LmJ1c3lfZnJvbnRidWZmZXJfYml0cyB8fCBkZXZfcHJpdi0+cHNyLmFjdGl2ZSkKPiA+ICsJaWYg
KGk5MTUtPnBzci5idXN5X2Zyb250YnVmZmVyX2JpdHMgfHwgaTkxNS0+cHNyLmFjdGl2ZSkKPiA+
ICAgCQlnb3RvIHVubG9jazsKPiA+IC0JaW50ZWxfcHNyX2FjdGl2YXRlKGRldl9wcml2LT5wc3Iu
ZHApOwo+ID4gKwlpbnRlbF9wc3JfYWN0aXZhdGUoaTkxNS0+cHNyLmRwKTsKPiA+ICAgdW5sb2Nr
Ogo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5wc3IubG9jayk7Cj4gPiArCW11dGV4X3Vu
bG9jaygmaTkxNS0+cHNyLmxvY2spOwo+ID4gICB9Cj4gPiAgIC8qKgo+ID4gICAgKiBpbnRlbF9w
c3JfaW52YWxpZGF0ZSAtIEludmFsaWRhZGUgUFNSCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRl
dmljZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZQo+ID4gICAgKiBAZnJvbnRidWZmZXJfYml0
czogZnJvbnRidWZmZXIgcGxhbmUgdHJhY2tpbmcgYml0cwo+ID4gICAgKiBAb3JpZ2luOiB3aGlj
aCBvcGVyYXRpb24gY2F1c2VkIHRoZSBpbnZhbGlkYXRlCj4gPiAgICAqCj4gPiBAQCAtMTExOCwz
MyArMTExOCwzMyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wc3Jfd29yayhzdHJ1Y3Qgd29ya19zdHJ1
Y3QgKndvcmspCj4gPiAgICAqCj4gPiAgICAqIERpcnR5IGZyb250YnVmZmVycyByZWxldmFudCB0
byBQU1IgYXJlIHRyYWNrZWQgaW4gYnVzeV9mcm9udGJ1ZmZlcl9iaXRzLiIKPiA+ICAgICovCj4g
PiAtdm9pZCBpbnRlbF9wc3JfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gPiArdm9pZCBpbnRlbF9wc3JfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkJICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzLCBlbnVtIGZi
X29wX29yaWdpbiBvcmlnaW4pCj4gPiAgIHsKPiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSkK
PiA+ICsJaWYgKCFDQU5fUFNSKGk5MTUpKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCWlmIChvcmln
aW4gPT0gT1JJR0lOX0ZMSVApCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQltdXRleF9sb2NrKCZkZXZf
cHJpdi0+cHNyLmxvY2spOwo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3IuZW5hYmxlZCkgewo+ID4g
LQkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOwo+ID4gKwltdXRleF9sb2NrKCZp
OTE1LT5wc3IubG9jayk7Cj4gPiArCWlmICghaTkxNS0+cHNyLmVuYWJsZWQpIHsKPiA+ICsJCW11
dGV4X3VubG9jaygmaTkxNS0+cHNyLmxvY2spOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+
IC0JZnJvbnRidWZmZXJfYml0cyAmPSBJTlRFTF9GUk9OVEJVRkZFUl9BTExfTUFTSyhkZXZfcHJp
di0+cHNyLnBpcGUpOwo+ID4gLQlkZXZfcHJpdi0+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cyB8
PSBmcm9udGJ1ZmZlcl9iaXRzOwo+ID4gKwlmcm9udGJ1ZmZlcl9iaXRzICY9IElOVEVMX0ZST05U
QlVGRkVSX0FMTF9NQVNLKGk5MTUtPnBzci5waXBlKTsKPiA+ICsJaTkxNS0+cHNyLmJ1c3lfZnJv
bnRidWZmZXJfYml0cyB8PSBmcm9udGJ1ZmZlcl9iaXRzOwo+ID4gICAJaWYgKGZyb250YnVmZmVy
X2JpdHMpCj4gPiAtCQlpbnRlbF9wc3JfZXhpdChkZXZfcHJpdik7Cj4gPiArCQlpbnRlbF9wc3Jf
ZXhpdChpOTE1KTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOwo+ID4g
KwltdXRleF91bmxvY2soJmk5MTUtPnBzci5sb2NrKTsKPiA+ICAgfQo+ID4gICAvKioKPiA+ICAg
ICogaW50ZWxfcHNyX2ZsdXNoIC0gRmx1c2ggUFNSCj4gPiAtICogQGRldl9wcml2OiBpOTE1IGRl
dmljZQo+ID4gKyAqIEBpOTE1OiBpOTE1IGRldmljZQo+ID4gICAgKiBAZnJvbnRidWZmZXJfYml0
czogZnJvbnRidWZmZXIgcGxhbmUgdHJhY2tpbmcgYml0cwo+ID4gICAgKiBAb3JpZ2luOiB3aGlj
aCBvcGVyYXRpb24gY2F1c2VkIHRoZSBmbHVzaAo+ID4gICAgKgo+ID4gQEAgLTExNTUsNTUgKzEx
NTUsNTUgQEAgdm9pZCBpbnRlbF9wc3JfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiAgICAqCj4gPiAgICAqIERpcnR5IGZyb250YnVmZmVycyByZWxldmFu
dCB0byBQU1IgYXJlIHRyYWNrZWQgaW4gYnVzeV9mcm9udGJ1ZmZlcl9iaXRzLgo+ID4gICAgKi8K
PiA+IC12b2lkIGludGVsX3Bzcl9mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiArdm9pZCBpbnRlbF9wc3JfZmx1c2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJICAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzLCBlbnVtIGZiX29wX29y
aWdpbiBvcmlnaW4pCj4gPiAgIHsKPiA+IC0JaWYgKCFDQU5fUFNSKGRldl9wcml2KSkKPiA+ICsJ
aWYgKCFDQU5fUFNSKGk5MTUpKQo+ID4gICAJCXJldHVybjsKPiA+ICAgCWlmIChvcmlnaW4gPT0g
T1JJR0lOX0ZMSVApCj4gPiAgIAkJcmV0dXJuOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+
cHNyLmxvY2spOwo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3IuZW5hYmxlZCkgewo+ID4gLQkJbXV0
ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cHNyLmxvY2spOwo+ID4gKwltdXRleF9sb2NrKCZpOTE1LT5w
c3IubG9jayk7Cj4gPiArCWlmICghaTkxNS0+cHNyLmVuYWJsZWQpIHsKPiA+ICsJCW11dGV4X3Vu
bG9jaygmaTkxNS0+cHNyLmxvY2spOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0KPiA+IC0JZnJv
bnRidWZmZXJfYml0cyAmPSBJTlRFTF9GUk9OVEJVRkZFUl9BTExfTUFTSyhkZXZfcHJpdi0+cHNy
LnBpcGUpOwo+ID4gLQlkZXZfcHJpdi0+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cyAmPSB+ZnJv
bnRidWZmZXJfYml0czsKPiA+ICsJZnJvbnRidWZmZXJfYml0cyAmPSBJTlRFTF9GUk9OVEJVRkZF
Ul9BTExfTUFTSyhpOTE1LT5wc3IucGlwZSk7Cj4gPiArCWk5MTUtPnBzci5idXN5X2Zyb250YnVm
ZmVyX2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Cj4gPiAgIAkvKiBCeSBkZWZpbml0aW9uIGZs
dXNoID0gaW52YWxpZGF0ZSArIGZsdXNoICovCj4gPiAgIAlpZiAoZnJvbnRidWZmZXJfYml0cykK
PiA+IC0JCXBzcl9mb3JjZV9od190cmFja2luZ19leGl0KGRldl9wcml2KTsKPiA+ICsJCXBzcl9m
b3JjZV9od190cmFja2luZ19leGl0KGk5MTUpOwo+ID4gLQlpZiAoIWRldl9wcml2LT5wc3IuYWN0
aXZlICYmICFkZXZfcHJpdi0+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cykKPiA+IC0JCXNjaGVk
dWxlX3dvcmsoJmRldl9wcml2LT5wc3Iud29yayk7Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPnBzci5sb2NrKTsKPiA+ICsJaWYgKCFpOTE1LT5wc3IuYWN0aXZlICYmICFpOTE1LT5wc3Iu
YnVzeV9mcm9udGJ1ZmZlcl9iaXRzKQo+ID4gKwkJc2NoZWR1bGVfd29yaygmaTkxNS0+cHNyLndv
cmspOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPnBzci5sb2NrKTsKPiA+ICAgfQo+ID4gICAv
KioKPiA+ICAgICogaW50ZWxfcHNyX2luaXQgLSBJbml0IGJhc2ljIFBTUiB3b3JrIGFuZCBtdXRl
eC4KPiA+IC0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIHByaXZhdGUKPiA+ICsgKiBAaTkxNTog
aTkxNSBkZXZpY2UgcHJpdmF0ZQo+ID4gICAgKgo+ID4gICAgKiBUaGlzIGZ1bmN0aW9uIGlzICBj
YWxsZWQgb25seSBvbmNlIGF0IGRyaXZlciBsb2FkIHRvIGluaXRpYWxpemUgYmFzaWMKPiA+ICAg
ICogUFNSIHN0dWZmLgo+ID4gICAgKi8KPiA+IC12b2lkIGludGVsX3Bzcl9pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICt2b2lkIGludGVsX3Bzcl9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gLQlp
ZiAoIUhBU19QU1IoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19QU1IoaTkxNSkpCj4gPiAgIAkJ
cmV0dXJuOwo+ID4gLQlkZXZfcHJpdi0+cHNyX21taW9fYmFzZSA9IElTX0hBU1dFTEwoZGV2X3By
aXYpID8KPiA+ICsJaTkxNS0+cHNyX21taW9fYmFzZSA9IElTX0hBU1dFTEwoaTkxNSkgPwo+ID4g
ICAJCUhTV19FRFBfUFNSX0JBU0UgOiBCRFdfRURQX1BTUl9CQVNFOwo+ID4gLQlpZiAoIWRldl9w
cml2LT5wc3Iuc2lua19zdXBwb3J0KQo+ID4gKwlpZiAoIWk5MTUtPnBzci5zaW5rX3N1cHBvcnQp
Cj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJaWYgKGk5MTVfbW9kcGFyYW1zLmVuYWJsZV9wc3IgPT0g
LTEpCj4gPiAtCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDkgfHwgIWRldl9wcml2LT52YnQu
cHNyLmVuYWJsZSkKPiA+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA5IHx8ICFpOTE1LT52YnQu
cHNyLmVuYWJsZSkKPiA+ICAgCQkJaTkxNV9tb2RwYXJhbXMuZW5hYmxlX3BzciA9IDA7Cj4gPiAg
IAkvKgo+ID4gQEAgLTEyMTgsMzEgKzEyMTgsMzEgQEAgdm9pZCBpbnRlbF9wc3JfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAl2YWwgJj0gRURQX1BTUl9FUlJP
UihlZHBfcHNyX3NoaWZ0KFRSQU5TQ09ERVJfRURQKSk7Cj4gPiAgIAlpZiAodmFsKSB7Cj4gPiAg
IAkJRFJNX0RFQlVHX0tNUygiUFNSIGludGVycnVwdGlvbiBlcnJvciBzZXRcbiIpOwo+ID4gLQkJ
ZGV2X3ByaXYtPnBzci5zaW5rX25vdF9yZWxpYWJsZSA9IHRydWU7Cj4gPiArCQlpOTE1LT5wc3Iu
c2lua19ub3RfcmVsaWFibGUgPSB0cnVlOwo+ID4gICAJfQo+ID4gICAJLyogU2V0IGxpbmtfc3Rh
bmRieSB4IGxpbmtfb2ZmIGRlZmF1bHRzICovCj4gPiAtCWlmIChJU19IQVNXRUxMKGRldl9wcml2
KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8
fCBJU19CUk9BRFdFTEwoaTkxNSkpCj4gPiAgIAkJLyogSFNXIGFuZCBCRFcgcmVxdWlyZSB3b3Jr
YXJvdW5kcyB0aGF0IHdlIGRvbid0IGltcGxlbWVudC4gKi8KPiA+IC0JCWRldl9wcml2LT5wc3Iu
bGlua19zdGFuZGJ5ID0gZmFsc2U7Cj4gPiArCQlpOTE1LT5wc3IubGlua19zdGFuZGJ5ID0gZmFs
c2U7Cj4gPiAgIAllbHNlCj4gPiAgIAkJLyogRm9yIG5ldyBwbGF0Zm9ybXMgbGV0J3MgcmVzcGVj
dCBWQlQgYmFjayBhZ2FpbiAqLwo+ID4gLQkJZGV2X3ByaXYtPnBzci5saW5rX3N0YW5kYnkgPSBk
ZXZfcHJpdi0+dmJ0LnBzci5mdWxsX2xpbms7Cj4gPiArCQlpOTE1LT5wc3IubGlua19zdGFuZGJ5
ID0gaTkxNS0+dmJ0LnBzci5mdWxsX2xpbms7Cj4gPiAtCUlOSVRfV09SSygmZGV2X3ByaXYtPnBz
ci53b3JrLCBpbnRlbF9wc3Jfd29yayk7Cj4gPiAtCW11dGV4X2luaXQoJmRldl9wcml2LT5wc3Iu
bG9jayk7Cj4gPiArCUlOSVRfV09SSygmaTkxNS0+cHNyLndvcmssIGludGVsX3Bzcl93b3JrKTsK
PiA+ICsJbXV0ZXhfaW5pdCgmaTkxNS0+cHNyLmxvY2spOwo+ID4gICB9Cj4gPiAgIHZvaWQgaW50
ZWxfcHNyX3Nob3J0X3B1bHNlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9k
cCk7Cj4gPiAtCXN0cnVjdCBpOTE1X3BzciAqcHNyID0gJmRldl9wcml2LT5wc3I7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4gPiAr
CXN0cnVjdCBpOTE1X3BzciAqcHNyID0gJmk5MTUtPnBzcjsKPiA+ICAgCXU4IHZhbDsKPiA+ICAg
CWNvbnN0IHU4IGVycm9ycyA9IERQX1BTUl9SRkJfU1RPUkFHRV9FUlJPUiB8Cj4gPiAgIAkJCSAg
RFBfUFNSX1ZTQ19TRFBfVU5DT1JSRUNUQUJMRV9FUlJPUiB8Cj4gPiAgIAkJCSAgRFBfUFNSX0xJ
TktfQ1JDX0VSUk9SOwo+ID4gLQlpZiAoIUNBTl9QU1IoZGV2X3ByaXYpIHx8ICFpbnRlbF9kcF9p
c19lZHAoaW50ZWxfZHApKQo+ID4gKwlpZiAoIUNBTl9QU1IoaTkxNSkgfHwgIWludGVsX2RwX2lz
X2VkcChpbnRlbF9kcCkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJbXV0ZXhfbG9jaygmcHNyLT5s
b2NrKTsKPiA+IEBAIC0xMjg4LDE1ICsxMjg4LDE1IEBAIHZvaWQgaW50ZWxfcHNyX3Nob3J0X3B1
bHNlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCj4gPiAgIGJvb2wgaW50ZWxfcHNyX2VuYWJs
ZWQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBkcF90b19pOTE1KGludGVsX2RwKTsKPiA+ICAgCWJv
b2wgcmV0Owo+ID4gLQlpZiAoIUNBTl9QU1IoZGV2X3ByaXYpIHx8ICFpbnRlbF9kcF9pc19lZHAo
aW50ZWxfZHApKQo+ID4gKwlpZiAoIUNBTl9QU1IoaTkxNSkgfHwgIWludGVsX2RwX2lzX2VkcChp
bnRlbF9kcCkpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gLQltdXRleF9sb2NrKCZkZXZfcHJp
di0+cHNyLmxvY2spOwo+ID4gLQlyZXQgPSAoZGV2X3ByaXYtPnBzci5kcCA9PSBpbnRlbF9kcCAm
JiBkZXZfcHJpdi0+cHNyLmVuYWJsZWQpOwo+ID4gLQltdXRleF91bmxvY2soJmRldl9wcml2LT5w
c3IubG9jayk7Cj4gPiArCW11dGV4X2xvY2soJmk5MTUtPnBzci5sb2NrKTsKPiA+ICsJcmV0ID0g
KGk5MTUtPnBzci5kcCA9PSBpbnRlbF9kcCAmJiBpOTE1LT5wc3IuZW5hYmxlZCk7Cj4gPiArCW11
dGV4X3VubG9jaygmaTkxNS0+cHNyLmxvY2spOwo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+
ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Bzci5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfcHNyLmgKPiA+IGluZGV4IGRjODE4ODI2ZjM2ZC4uOGEzZGRj
NGFlNDRkIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcHNyLmgK
PiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Bzci5oCj4gPiBAQCAtMTIsNyAr
MTIsNyBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiA+ICAgc3RydWN0IGludGVsX2NydGNf
c3RhdGU7Cj4gPiAgIHN0cnVjdCBpbnRlbF9kcDsKPiA+IC0jZGVmaW5lIENBTl9QU1IoZGV2X3By
aXYpIChIQVNfUFNSKGRldl9wcml2KSAmJiBkZXZfcHJpdi0+cHNyLnNpbmtfc3VwcG9ydCkKPiA+
ICsjZGVmaW5lIENBTl9QU1IoaTkxNSkgKEhBU19QU1IoaTkxNSkgJiYgaTkxNS0+cHNyLnNpbmtf
c3VwcG9ydCkKPiA+ICAgdm9pZCBpbnRlbF9wc3JfaW5pdF9kcGNkKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHApOwo+ID4gICB2b2lkIGludGVsX3Bzcl9lbmFibGUoc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCwKPiA+ICAgCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSk7Cj4gPiBAQCAtMjAsMTggKzIwLDE4IEBAIHZvaWQgaW50ZWxfcHNyX2Rpc2FibGUo
c3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPiA+ICAgCQkgICAgICAgY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKTsKPiA+ICAgdm9pZCBpbnRlbF9wc3JfdXBk
YXRlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIAkJICAgICAgY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+ID4gLWludCBpbnRlbF9wc3JfZGVidWdf
c2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTY0IHZhbHVlKTsKPiA+IC12
b2lkIGludGVsX3Bzcl9pbnZhbGlkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiA+ICtpbnQgaW50ZWxfcHNyX2RlYnVnX3NldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwgdTY0IHZhbHVlKTsKPiA+ICt2b2lkIGludGVsX3Bzcl9pbnZhbGlkYXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgIHVuc2lnbmVkIGZyb250YnVmZmVyX2Jp
dHMsCj4gPiAgIAkJCSAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKTsKPiA+IC12b2lkIGludGVs
X3Bzcl9mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArdm9pZCBp
bnRlbF9wc3JfZmx1c2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAg
ICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzLAo+ID4gICAJCSAgICAgZW51bSBmYl9vcF9vcmln
aW4gb3JpZ2luKTsKPiA+IC12b2lkIGludGVsX3Bzcl9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBpbnRlbF9wc3JfaW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSk7Cj4gPiAgIHZvaWQgaW50ZWxfcHNyX2NvbXB1dGVfY29uZmlnKHN0cnVj
dCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4gPiAgIAkJCSAgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKTsKPiA+IC12b2lkIGludGVsX3Bzcl9pcnFfY29udHJvbChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBkZWJ1Zyk7Cj4gPiAtdm9pZCBpbnRlbF9w
c3JfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcHNy
X2lpcik7Cj4gPiArdm9pZCBpbnRlbF9wc3JfaXJxX2NvbnRyb2woc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsIHUzMiBkZWJ1Zyk7Cj4gPiArdm9pZCBpbnRlbF9wc3JfaXJxX2hhbmRsZXIo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHUzMiBwc3JfaWlyKTsKPiA+ICAgdm9pZCBp
bnRlbF9wc3Jfc2hvcnRfcHVsc2Uoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCk7Cj4gPiAgIGlu
dCBpbnRlbF9wc3Jfd2FpdF9mb3JfaWRsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
bmV3X2NydGNfc3RhdGUsCj4gPiAgIAkJCSAgICB1MzIgKm91dF92YWx1ZSk7Cj4gPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcXVpcmtzLmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9xdWlya3MuaAo+ID4gaW5kZXggYjBmY2ZmMTQyYTU2Li5iNjE3Y2EwNDc2
OTUgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9xdWlya3MuaAo+
ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcXVpcmtzLmgKPiA+IEBAIC04LDYg
KzgsNiBAQAo+ID4gICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKPiA+IC12b2lkIGludGVsX2lu
aXRfcXVpcmtzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiArdm9pZCBp
bnRlbF9pbml0X3F1aXJrcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAgICNl
bmRpZiAvKiBfX0lOVEVMX1FVSVJLU19IX18gKi8KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9ydW50aW1lX3BtLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9ydW50aW1lX3BtLmgKPiA+IGluZGV4IGE3YWNjZWIxMzQ3My4uMTA0MmYxYzBiMTI1IDEwMDY0
NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGltZV9wbS5oCj4gPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ydW50aW1lX3BtLmgKPiA+IEBAIC0yMCwx
MCArMjAsMTAgQEAgZW51bSBpOTE1X2RybV9zdXNwZW5kX21vZGUgewo+ID4gICAJSTkxNV9EUk1f
U1VTUEVORF9ISUJFUk5BVEUsCj4gPiAgIH07Cj4gPiAtdm9pZCBpbnRlbF9ydW50aW1lX3BtX2lu
aXRfZWFybHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGlu
dGVsX3J1bnRpbWVfcG1fZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cj4gPiAtdm9pZCBpbnRlbF9ydW50aW1lX3BtX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGludGVsX3J1bnRpbWVfcG1fY2xlYW51cChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3ZvaWQgaW50ZWxfcnVudGltZV9wbV9p
bml0X2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVs
X3J1bnRpbWVfcG1fZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICt2
b2lkIGludGVsX3J1bnRpbWVfcG1fZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSk7Cj4gPiArdm9pZCBpbnRlbF9ydW50aW1lX3BtX2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ID4gICBpbnRlbF93YWtlcmVmX3QgaW50ZWxfcnVudGltZV9wbV9nZXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICBpbnRlbF93YWtlcmVmX3QgaW50
ZWxfcnVudGltZV9wbV9nZXRfaWZfaW5fdXNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KTsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9zZHZvLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9zZHZvLmMKPiA+IGluZGV4IDA4NjBhZTM2YmI4Ny4u
YjkxNmM3OWQ2YjMxIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
c2R2by5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9zZHZvLmMKPiA+IEBA
IC0yMTIsMTggKzIxMiwxOCBAQCBpbnRlbF9zZHZvX2NyZWF0ZV9lbmhhbmNlX3Byb3BlcnR5KHN0
cnVjdCBpbnRlbF9zZHZvICppbnRlbF9zZHZvLAo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9zZHZv
X3dyaXRlX3Nkdm94KHN0cnVjdCBpbnRlbF9zZHZvICppbnRlbF9zZHZvLCB1MzIgdmFsKQo+ID4g
ICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gaW50ZWxfc2R2by0+YmFzZS5iYXNl
LmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShk
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsK
PiA+ICAgCXUzMiBidmFsID0gdmFsLCBjdmFsID0gdmFsOwo+ID4gICAJaW50IGk7Cj4gPiAtCWlm
IChIQVNfUENIX1NQTElUKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSEFTX1BDSF9TUExJVChpOTE1
KSkgewo+ID4gICAJCUk5MTVfV1JJVEUoaW50ZWxfc2R2by0+c2R2b19yZWcsIHZhbCk7Cj4gPiAg
IAkJUE9TVElOR19SRUFEKGludGVsX3Nkdm8tPnNkdm9fcmVnKTsKPiA+ICAgCQkvKgo+ID4gICAJ
CSAqIEhXIHdvcmthcm91bmQsIG5lZWQgdG8gd3JpdGUgdGhpcyB0d2ljZSBmb3IgaXNzdWUKPiA+
ICAgCQkgKiB0aGF0IG1heSByZXN1bHQgaW4gZmlyc3Qgd3JpdGUgZ2V0dGluZyBtYXNrZWQuCj4g
PiAgIAkJICovCj4gPiAtCQlpZiAoSEFTX1BDSF9JQlgoZGV2X3ByaXYpKSB7Cj4gPiArCQlpZiAo
SEFTX1BDSF9JQlgoaTkxNSkpIHsKPiA+ICAgCQkJSTkxNV9XUklURShpbnRlbF9zZHZvLT5zZHZv
X3JlZywgdmFsKTsKPiA+ICAgCQkJUE9TVElOR19SRUFEKGludGVsX3Nkdm8tPnNkdm9fcmVnKTsK
PiA+ICAgCQl9Cj4gPiBAQCAtMTQwMCw3ICsxNDAwLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2R2
b19wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+ID4gICAJ
CQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJ
CSAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gPiAgIHsK
PiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShpbnRlbF9l
bmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShpbnRlbF9lbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+ICAgCWNv
bnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJmNydGNfc3RhdGUt
PmJhc2UuYWRqdXN0ZWRfbW9kZTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBpbnRlbF9zZHZvX2Nvbm5l
Y3Rvcl9zdGF0ZSAqc2R2b19zdGF0ZSA9Cj4gPiBAQCAtMTQ4MSwxMyArMTQ4MSwxMyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9zZHZvX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVs
X2VuY29kZXIsCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJLyogU2V0IHRoZSBTRFZPIGNvbnRyb2wg
cmVncy4gKi8KPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkgewo+ID4gKwlpZiAo
SU5URUxfR0VOKGk5MTUpID49IDQpIHsKPiA+ICAgCQkvKiBUaGUgcmVhbCBtb2RlIHBvbGFyaXR5
IGlzIHNldCBieSB0aGUgU0RWTyBjb21tYW5kcywgdXNpbmcKPiA+ICAgCQkgKiBzdHJ1Y3QgaW50
ZWxfc2R2b19kdGQuICovCj4gPiAgIAkJc2R2b3ggPSBTRFZPX1ZTWU5DX0FDVElWRV9ISUdIIHwg
U0RWT19IU1lOQ19BQ1RJVkVfSElHSDsKPiA+IC0JCWlmICghSEFTX1BDSF9TUExJVChkZXZfcHJp
dikgJiYgY3J0Y19zdGF0ZS0+bGltaXRlZF9jb2xvcl9yYW5nZSkKPiA+ICsJCWlmICghSEFTX1BD
SF9TUExJVChpOTE1KSAmJiBjcnRjX3N0YXRlLT5saW1pdGVkX2NvbG9yX3JhbmdlKQo+ID4gICAJ
CQlzZHZveCB8PSBIRE1JX0NPTE9SX1JBTkdFXzE2XzIzNTsKPiA+IC0JCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpIDwgNSkKPiA+ICsJCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA1KQo+ID4gICAJCQlz
ZHZveCB8PSBTRFZPX0JPUkRFUl9FTkFCTEU7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCXNkdm94
ID0gSTkxNV9SRUFEKGludGVsX3Nkdm8tPnNkdm9fcmVnKTsKPiA+IEBAIC0xNDk4LDE1ICsxNDk4
LDE1IEBAIHN0YXRpYyB2b2lkIGludGVsX3Nkdm9fcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqaW50ZWxfZW5jb2RlciwKPiA+ICAgCQlzZHZveCB8PSAoOSA8PCAxOSkgfCBTRFZPX0JP
UkRFUl9FTkFCTEU7Cj4gPiAgIAl9Cj4gPiAtCWlmIChIQVNfUENIX0NQVChkZXZfcHJpdikpCj4g
PiArCWlmIChIQVNfUENIX0NQVChpOTE1KSkKPiA+ICAgCQlzZHZveCB8PSBTRFZPX1BJUEVfU0VM
X0NQVChjcnRjLT5waXBlKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQlzZHZveCB8PSBTRFZPX1BJUEVf
U0VMKGNydGMtPnBpcGUpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KSB7Cj4g
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCkgewo+ID4gICAJCS8qIGRvbmUgaW4gY3J0Y19t
b2RlX3NldCBhcyB0aGUgZHBsbF9tZCByZWcgbXVzdCBiZSB3cml0dGVuIGVhcmx5ICovCj4gPiAt
CX0gZWxzZSBpZiAoSVNfSTk0NUcoZGV2X3ByaXYpIHx8IElTX0k5NDVHTShkZXZfcHJpdikgfHwK
PiA+IC0JCSAgIElTX0czMyhkZXZfcHJpdikgfHwgSVNfUElORVZJRVcoZGV2X3ByaXYpKSB7Cj4g
PiArCX0gZWxzZSBpZiAoSVNfSTk0NUcoaTkxNSkgfHwgSVNfSTk0NUdNKGk5MTUpIHx8Cj4gPiAr
CQkgICBJU19HMzMoaTkxNSkgfHwgSVNfUElORVZJRVcoaTkxNSkpIHsKPiA+ICAgCQkvKiBkb25l
IGluIGNydGNfbW9kZV9zZXQgYXMgaXQgbGl2ZXMgaW5zaWRlIHRoZSBkcGxsIHJlZ2lzdGVyICov
Cj4gPiAgIAl9IGVsc2Ugewo+ID4gICAJCXNkdm94IHw9IChjcnRjX3N0YXRlLT5waXhlbF9tdWx0
aXBsaWVyIC0gMSkKPiA+IEBAIC0xNTE0LDcgKzE1MTQsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9z
ZHZvX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCj4gPiAg
IAl9Cj4gPiAgIAlpZiAoaW5wdXRfZHRkLnBhcnQyLnNkdm9fZmxhZ3MgJiBTRFZPX05FRURfVE9f
U1RBTEwgJiYKPiA+IC0JICAgIElOVEVMX0dFTihkZXZfcHJpdikgPCA1KQo+ID4gKwkgICAgSU5U
RUxfR0VOKGk5MTUpIDwgNSkKPiA+ICAgCQlzZHZveCB8PSBTRFZPX1NUQUxMX1NFTEVDVDsKPiA+
ICAgCWludGVsX3Nkdm9fd3JpdGVfc2R2b3goaW50ZWxfc2R2bywgc2R2b3gpOwo+ID4gICB9Cj4g
PiBAQCAtMTUzMSw3ICsxNTMxLDcgQEAgc3RhdGljIGJvb2wgaW50ZWxfc2R2b19jb25uZWN0b3Jf
Z2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgCXJl
dHVybiBhY3RpdmVfb3V0cHV0cyAmIGludGVsX3Nkdm9fY29ubmVjdG9yLT5vdXRwdXRfZmxhZzsK
PiA+ICAgfQo+ID4gLWJvb2wgaW50ZWxfc2R2b19wb3J0X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2Jvb2wgaW50ZWxfc2R2b19wb3J0X2VuYWJsZWQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgaTkxNV9yZWdfdCBzZHZv
X3JlZywgZW51bSBwaXBlICpwaXBlKQo+ID4gICB7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gQEAgLTE1
MzksOSArMTUzOSw5IEBAIGJvb2wgaW50ZWxfc2R2b19wb3J0X2VuYWJsZWQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJdmFsID0gSTkxNV9SRUFEKHNkdm9fcmVnKTsK
PiA+ICAgCS8qIGFzc2VydHMgd2FudCB0byBrbm93IHRoZSBwaXBlIGV2ZW4gaWYgdGhlIHBvcnQg
aXMgZGlzYWJsZWQgKi8KPiA+IC0JaWYgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSkKPiA+ICsJaWYg
KEhBU19QQ0hfQ1BUKGk5MTUpKQo+ID4gICAJCSpwaXBlID0gKHZhbCAmIFNEVk9fUElQRV9TRUxf
TUFTS19DUFQpID4+IFNEVk9fUElQRV9TRUxfU0hJRlRfQ1BUOwo+ID4gLQllbHNlIGlmIChJU19D
SEVSUllWSUVXKGRldl9wcml2KSkKPiA+ICsJZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkK
PiA+ICAgCQkqcGlwZSA9ICh2YWwgJiBTRFZPX1BJUEVfU0VMX01BU0tfQ0hWKSA+PiBTRFZPX1BJ
UEVfU0VMX1NISUZUX0NIVjsKPiA+ICAgCWVsc2UKPiA+ICAgCQkqcGlwZSA9ICh2YWwgJiBTRFZP
X1BJUEVfU0VMX01BU0spID4+IFNEVk9fUElQRV9TRUxfU0hJRlQ7Cj4gPiBAQCAtMTU1MiwxNCAr
MTU1MiwxNCBAQCBib29sIGludGVsX3Nkdm9fcG9ydF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICAgc3RhdGljIGJvb2wgaW50ZWxfc2R2b19nZXRfaHdfc3Rh
dGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkgICAgZW51bSBwaXBl
ICpwaXBlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVs
X3Nkdm8gKmludGVsX3Nkdm8gPSB0b19zZHZvKGVuY29kZXIpOwo+ID4gICAJdTE2IGFjdGl2ZV9v
dXRwdXRzID0gMDsKPiA+ICAgCWJvb2wgcmV0Owo+ID4gICAJaW50ZWxfc2R2b19nZXRfYWN0aXZl
X291dHB1dHMoaW50ZWxfc2R2bywgJmFjdGl2ZV9vdXRwdXRzKTsKPiA+IC0JcmV0ID0gaW50ZWxf
c2R2b19wb3J0X2VuYWJsZWQoZGV2X3ByaXYsIGludGVsX3Nkdm8tPnNkdm9fcmVnLCBwaXBlKTsK
PiA+ICsJcmV0ID0gaW50ZWxfc2R2b19wb3J0X2VuYWJsZWQoaTkxNSwgaW50ZWxfc2R2by0+c2R2
b19yZWcsIHBpcGUpOwo+ID4gICAJcmV0dXJuIHJldCB8fCBhY3RpdmVfb3V0cHV0czsKPiA+ICAg
fQo+ID4gQEAgLTE1NjgsNyArMTU2OCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Nkdm9fZ2V0X2Nv
bmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCSAgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gZW5jb2Rlci0+YmFzZS5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfc2R2byAqaW50ZWxf
c2R2byA9IHRvX3Nkdm8oZW5jb2Rlcik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfc2R2b19kdGQgZHRk
Owo+ID4gICAJaW50IGVuY29kZXJfcGl4ZWxfbXVsdGlwbGllciA9IDA7Cj4gPiBAQCAtMTYxMCw3
ICsxNjEwLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2R2b19nZXRfY29uZmlnKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJICogZW5jb2Rlci0+Z2V0X2NvbmZpZyB3ZSBzbyBh
bHJlYWR5IGhhdmUgYSB2YWxpZCBwaXhlbCBtdWx0cGxpZXIgb24gYWxsCj4gPiAgIAkgKiBvdGhl
ciBwbGF0ZnJvbXMuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKElTX0k5MTVHKGRldl9wcml2KSB8fCBJ
U19JOTE1R00oZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19JOTE1RyhpOTE1KSB8fCBJU19JOTE1
R00oaTkxNSkpIHsKPiA+ICAgCQlwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllciA9Cj4gPiAg
IAkJCSgoc2R2b3ggJiBTRFZPX1BPUlRfTVVMVElQTFlfTUFTSykKPiA+ICAgCQkJID4+IFNEVk9f
UE9SVF9NVUxUSVBMWV9TSElGVCkgKyAxOwo+ID4gQEAgLTE2OTMsNyArMTY5Myw3IEBAIHN0YXRp
YyB2b2lkIGludGVsX2Rpc2FibGVfc2R2byhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
PiA+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19z
dGF0ZSwKPiA+ICAgCQkJICAgICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpj
b25uX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGlu
dGVsX3Nkdm8gKmludGVsX3Nkdm8gPSB0b19zZHZvKGVuY29kZXIpOwo+ID4gICAJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+ID4gICAJdTMyIHRlbXA7Cj4gPiBAQCAtMTcxNiwxMyArMTcxNiwxMyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9kaXNhYmxlX3Nkdm8oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAg
IAkgKiB0byB0cmFuc2NvZGVyIEEgYWZ0ZXIgZGlzYWJsaW5nIGl0IHRvIGFsbG93IHRoZQo+ID4g
ICAJICogbWF0Y2hpbmcgRFAgcG9ydCB0byBiZSBlbmFibGVkIG9uIHRyYW5zY29kZXIgQS4KPiA+
ICAgCSAqLwo+ID4gLQlpZiAoSEFTX1BDSF9JQlgoZGV2X3ByaXYpICYmIGNydGMtPnBpcGUgPT0g
UElQRV9CKSB7Cj4gPiArCWlmIChIQVNfUENIX0lCWChpOTE1KSAmJiBjcnRjLT5waXBlID09IFBJ
UEVfQikgewo+ID4gICAJCS8qCj4gPiAgIAkJICogV2UgZ2V0IENQVS9QQ0ggRklGTyB1bmRlcnJ1
bnMgb24gdGhlIG90aGVyIHBpcGUgd2hlbgo+ID4gICAJCSAqIGRvaW5nIHRoZSB3b3JrYXJvdW5k
LiBTd2VlcCB0aGVtIHVuZGVyIHRoZSBydWcuCj4gPiAgIAkJICovCj4gPiAtCQlpbnRlbF9zZXRf
Y3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2LCBQSVBFX0EsIGZhbHNlKTsKPiA+
IC0JCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIFBJUEVf
QSwgZmFsc2UpOwo+ID4gKwkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhp
OTE1LCBQSVBFX0EsIGZhbHNlKTsKPiA+ICsJCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9y
ZXBvcnRpbmcoaTkxNSwgUElQRV9BLCBmYWxzZSk7Cj4gPiAgIAkJdGVtcCAmPSB+U0RWT19QSVBF
X1NFTF9NQVNLOwo+ID4gICAJCXRlbXAgfD0gU0RWT19FTkFCTEUgfCBTRFZPX1BJUEVfU0VMKFBJ
UEVfQSk7Cj4gPiBAQCAtMTczMSw5ICsxNzMxLDkgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJs
ZV9zZHZvKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCXRlbXAgJj0gflNE
Vk9fRU5BQkxFOwo+ID4gICAJCWludGVsX3Nkdm9fd3JpdGVfc2R2b3goaW50ZWxfc2R2bywgdGVt
cCk7Cj4gPiAtCQlpbnRlbF93YWl0X2Zvcl92YmxhbmtfaWZfYWN0aXZlKGRldl9wcml2LCBQSVBF
X0EpOwo+ID4gLQkJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJp
diwgUElQRV9BLCB0cnVlKTsKPiA+IC0JCWludGVsX3NldF9wY2hfZmlmb191bmRlcnJ1bl9yZXBv
cnRpbmcoZGV2X3ByaXYsIFBJUEVfQSwgdHJ1ZSk7Cj4gPiArCQlpbnRlbF93YWl0X2Zvcl92Ymxh
bmtfaWZfYWN0aXZlKGk5MTUsIFBJUEVfQSk7Cj4gPiArCQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5k
ZXJydW5fcmVwb3J0aW5nKGk5MTUsIFBJUEVfQSwgdHJ1ZSk7Cj4gPiArCQlpbnRlbF9zZXRfcGNo
X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGk5MTUsIFBJUEVfQSwgdHJ1ZSk7Cj4gPiAgIAl9Cj4g
PiAgIH0KPiA+IEBAIC0xNzU1LDcgKzE3NTUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVf
c2R2byhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJICAgICAgY29uc3Qg
c3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBlbmNvZGVyLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9z
ZHZvICppbnRlbF9zZHZvID0gdG9fc2R2byhlbmNvZGVyKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9j
cnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsK
PiA+ICAgCXUzMiB0ZW1wOwo+ID4gQEAgLTE3NjgsNyArMTc2OCw3IEBAIHN0YXRpYyB2b2lkIGlu
dGVsX2VuYWJsZV9zZHZvKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJaW50
ZWxfc2R2b193cml0ZV9zZHZveChpbnRlbF9zZHZvLCB0ZW1wKTsKPiA+ICAgCWZvciAoaSA9IDA7
IGkgPCAyOyBpKyspCj4gPiAtCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoZGV2X3ByaXYsIGludGVs
X2NydGMtPnBpcGUpOwo+ID4gKwkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsIGludGVsX2Ny
dGMtPnBpcGUpOwo+ID4gICAJc3VjY2VzcyA9IGludGVsX3Nkdm9fZ2V0X3RyYWluZWRfaW5wdXRz
KGludGVsX3Nkdm8sICZpbnB1dDEsICZpbnB1dDIpOwo+ID4gICAJLyoKPiA+IEBAIC0xODY1LDE3
ICsxODY1LDE3IEBAIHN0YXRpYyBib29sIGludGVsX3Nkdm9fZ2V0X2NhcGFiaWxpdGllcyhzdHJ1
Y3QgaW50ZWxfc2R2byAqaW50ZWxfc2R2bywgc3RydWN0IGluCj4gPiAgIHN0YXRpYyB1MTYgaW50
ZWxfc2R2b19nZXRfaG90cGx1Z19zdXBwb3J0KHN0cnVjdCBpbnRlbF9zZHZvICppbnRlbF9zZHZv
KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoaW50ZWxfc2R2by0+YmFzZS5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShpbnRlbF9zZHZvLT5iYXNlLmJhc2UuZGV2KTsKPiA+ICAgCXUx
NiBob3RwbHVnOwo+ID4gLQlpZiAoIUk5MTVfSEFTX0hPVFBMVUcoZGV2X3ByaXYpKQo+ID4gKwlp
ZiAoIUk5MTVfSEFTX0hPVFBMVUcoaTkxNSkpCj4gPiAgIAkJcmV0dXJuIDA7Cj4gPiAgIAkvKgo+
ID4gICAJICogSFcgRXJyYXR1bTogU0RWTyBIb3RwbHVnIGlzIGJyb2tlbiBvbiBhbGwgaTk0NUcg
Y2hpcHMsIHRoZXJlJ3Mgbm9pc2UKPiA+ICAgCSAqIG9uIHRoZSBsaW5lLgo+ID4gICAJICovCj4g
PiAtCWlmIChJU19JOTQ1RyhkZXZfcHJpdikgfHwgSVNfSTk0NUdNKGRldl9wcml2KSkKPiA+ICsJ
aWYgKElTX0k5NDVHKGk5MTUpIHx8IElTX0k5NDVHTShpOTE1KSkKPiA+ICAgCQlyZXR1cm4gMDsK
PiA+ICAgCWlmICghaW50ZWxfc2R2b19nZXRfdmFsdWUoaW50ZWxfc2R2bywgU0RWT19DTURfR0VU
X0hPVF9QTFVHX1NVUFBPUlQsCj4gPiBAQCAtMTkxOSwxMSArMTkxOSwxMSBAQCBpbnRlbF9zZHZv
X2dldF9lZGlkKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHN0YXRpYyBz
dHJ1Y3QgZWRpZCAqCj4gPiAgIGludGVsX3Nkdm9fZ2V0X2FuYWxvZ19lZGlkKHN0cnVjdCBkcm1f
Y29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gPiArCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjb25uZWN0b3ItPmRldik7Cj4gPiAgIAlyZXR1
cm4gZHJtX2dldF9lZGlkKGNvbm5lY3RvciwKPiA+IC0JCQkgICAgaW50ZWxfZ21idXNfZ2V0X2Fk
YXB0ZXIoZGV2X3ByaXYsCj4gPiAtCQkJCQkJICAgIGRldl9wcml2LT52YnQuY3J0X2RkY19waW4p
KTsKPiA+ICsJCQkgICAgaW50ZWxfZ21idXNfZ2V0X2FkYXB0ZXIoaTkxNSwKPiA+ICsJCQkJCQkg
ICAgaTkxNS0+dmJ0LmNydF9kZGNfcGluKSk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGVudW0gZHJt
X2Nvbm5lY3Rvcl9zdGF0dXMKPiA+IEBAIC0yMTg2LDcgKzIxODYsNyBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9zZHZvX2dldF90dl9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+
ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9zZHZvX2dldF9sdmRzX21vZGVzKHN0cnVjdCBkcm1fY29u
bmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9zZHZvICppbnRl
bF9zZHZvID0gaW50ZWxfYXR0YWNoZWRfc2R2byhjb25uZWN0b3IpOwo+ID4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+ZGV2KTsK
PiA+ICAgCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpuZXdtb2RlOwo+ID4gICAJRFJNX0RFQlVH
X0tNUygiW0NPTk5FQ1RPUjolZDolc11cbiIsCj4gPiBAQCAtMjE5Niw5ICsyMTk2LDkgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfc2R2b19nZXRfbHZkc19tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAq
Y29ubmVjdG9yKQo+ID4gICAJICogRmV0Y2ggbW9kZXMgZnJvbSBWQlQuIEZvciBTRFZPIHByZWZl
ciB0aGUgVkJUIG1vZGUgc2luY2Ugc29tZQo+ID4gICAJICogU0RWTy0+TFZEUyB0cmFuc2NvZGVy
cyBjYW4ndCBjb3BlIHdpdGggdGhlIEVESUQgbW9kZS4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoZGV2
X3ByaXYtPnZidC5zZHZvX2x2ZHNfdmJ0X21vZGUgIT0gTlVMTCkgewo+ID4gKwlpZiAoaTkxNS0+
dmJ0LnNkdm9fbHZkc192YnRfbW9kZSAhPSBOVUxMKSB7Cj4gPiAgIAkJbmV3bW9kZSA9IGRybV9t
b2RlX2R1cGxpY2F0ZShjb25uZWN0b3ItPmRldiwKPiA+IC0JCQkJCSAgICAgZGV2X3ByaXYtPnZi
dC5zZHZvX2x2ZHNfdmJ0X21vZGUpOwo+ID4gKwkJCQkJICAgICBpOTE1LT52YnQuc2R2b19sdmRz
X3ZidF9tb2RlKTsKPiA+ICAgCQlpZiAobmV3bW9kZSAhPSBOVUxMKSB7Cj4gPiAgIAkJCS8qIEd1
YXJhbnRlZSB0aGUgbW9kZSBpcyBwcmVmZXJyZWQgKi8KPiA+ICAgCQkJbmV3bW9kZS0+dHlwZSA9
IChEUk1fTU9ERV9UWVBFX1BSRUZFUlJFRCB8Cj4gPiBAQCAtMjQ4OCwxNSArMjQ4OCwxNSBAQCBp
bnRlbF9zZHZvX2d1ZXNzX2RkY19idXMoc3RydWN0IGludGVsX3Nkdm8gKnNkdm8pCj4gPiAgICAq
IG91dHB1dHMsIHRoZW4gTFZEUyBvdXRwdXRzLgo+ID4gICAgKi8KPiA+ICAgc3RhdGljIHZvaWQK
PiA+IC1pbnRlbF9zZHZvX3NlbGVjdF9kZGNfYnVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICtpbnRlbF9zZHZvX3NlbGVjdF9kZGNfYnVzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ID4gICAJCQkgIHN0cnVjdCBpbnRlbF9zZHZvICpzZHZvKQo+ID4gICB7
Cj4gPiAgIAlzdHJ1Y3Qgc2R2b19kZXZpY2VfbWFwcGluZyAqbWFwcGluZzsKPiA+ICAgCWlmIChz
ZHZvLT5wb3J0ID09IFBPUlRfQikKPiA+IC0JCW1hcHBpbmcgPSAmZGV2X3ByaXYtPnZidC5zZHZv
X21hcHBpbmdzWzBdOwo+ID4gKwkJbWFwcGluZyA9ICZpOTE1LT52YnQuc2R2b19tYXBwaW5nc1sw
XTsKPiA+ICAgCWVsc2UKPiA+IC0JCW1hcHBpbmcgPSAmZGV2X3ByaXYtPnZidC5zZHZvX21hcHBp
bmdzWzFdOwo+ID4gKwkJbWFwcGluZyA9ICZpOTE1LT52YnQuc2R2b19tYXBwaW5nc1sxXTsKPiA+
ICAgCWlmIChtYXBwaW5nLT5pbml0aWFsaXplZCkKPiA+ICAgCQlzZHZvLT5kZGNfYnVzID0gMSA8
PCAoKG1hcHBpbmctPmRkY19waW4gJiAweGYwKSA+PiA0KTsKPiA+IEBAIC0yNTA1LDI0ICsyNTA1
LDI0IEBAIGludGVsX3Nkdm9fc2VsZWN0X2RkY19idXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkCj4gPiAtaW50ZWxfc2R2b19zZWxl
Y3RfaTJjX2J1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAraW50ZWxf
c2R2b19zZWxlY3RfaTJjX2J1cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAg
CQkJICBzdHJ1Y3QgaW50ZWxfc2R2byAqc2R2bykKPiA+ICAgewo+ID4gICAJc3RydWN0IHNkdm9f
ZGV2aWNlX21hcHBpbmcgKm1hcHBpbmc7Cj4gPiAgIAl1OCBwaW47Cj4gPiAgIAlpZiAoc2R2by0+
cG9ydCA9PSBQT1JUX0IpCj4gPiAtCQltYXBwaW5nID0gJmRldl9wcml2LT52YnQuc2R2b19tYXBw
aW5nc1swXTsKPiA+ICsJCW1hcHBpbmcgPSAmaTkxNS0+dmJ0LnNkdm9fbWFwcGluZ3NbMF07Cj4g
PiAgIAllbHNlCj4gPiAtCQltYXBwaW5nID0gJmRldl9wcml2LT52YnQuc2R2b19tYXBwaW5nc1sx
XTsKPiA+ICsJCW1hcHBpbmcgPSAmaTkxNS0+dmJ0LnNkdm9fbWFwcGluZ3NbMV07Cj4gPiAgIAlp
ZiAobWFwcGluZy0+aW5pdGlhbGl6ZWQgJiYKPiA+IC0JICAgIGludGVsX2dtYnVzX2lzX3ZhbGlk
X3BpbihkZXZfcHJpdiwgbWFwcGluZy0+aTJjX3BpbikpCj4gPiArCSAgICBpbnRlbF9nbWJ1c19p
c192YWxpZF9waW4oaTkxNSwgbWFwcGluZy0+aTJjX3BpbikpCj4gPiAgIAkJcGluID0gbWFwcGlu
Zy0+aTJjX3BpbjsKPiA+ICAgCWVsc2UKPiA+ICAgCQlwaW4gPSBHTUJVU19QSU5fRFBCOwo+ID4g
LQlzZHZvLT5pMmMgPSBpbnRlbF9nbWJ1c19nZXRfYWRhcHRlcihkZXZfcHJpdiwgcGluKTsKPiA+
ICsJc2R2by0+aTJjID0gaW50ZWxfZ21idXNfZ2V0X2FkYXB0ZXIoaTkxNSwgcGluKTsKPiA+ICAg
CS8qCj4gPiAgIAkgKiBXaXRoIGdtYnVzIHdlIHNob3VsZCBiZSBhYmxlIHRvIGRyaXZlIHNkdm8g
aTJjIGF0IDJNSHosIGJ1dCBzb21laG93Cj4gPiBAQCAtMjU0NiwxNyArMjU0NiwxNyBAQCBpbnRl
bF9zZHZvX2lzX2hkbWlfY29ubmVjdG9yKHN0cnVjdCBpbnRlbF9zZHZvICppbnRlbF9zZHZvLCBp
bnQgZGV2aWNlKQo+ID4gICB9Cj4gPiAgIHN0YXRpYyB1OAo+ID4gLWludGVsX3Nkdm9fZ2V0X3Ns
YXZlX2FkZHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK2ludGVsX3Nk
dm9fZ2V0X3NsYXZlX2FkZHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJ
CSAgc3RydWN0IGludGVsX3Nkdm8gKnNkdm8pCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBzZHZvX2Rl
dmljZV9tYXBwaW5nICpteV9tYXBwaW5nLCAqb3RoZXJfbWFwcGluZzsKPiA+ICAgCWlmIChzZHZv
LT5wb3J0ID09IFBPUlRfQikgewo+ID4gLQkJbXlfbWFwcGluZyA9ICZkZXZfcHJpdi0+dmJ0LnNk
dm9fbWFwcGluZ3NbMF07Cj4gPiAtCQlvdGhlcl9tYXBwaW5nID0gJmRldl9wcml2LT52YnQuc2R2
b19tYXBwaW5nc1sxXTsKPiA+ICsJCW15X21hcHBpbmcgPSAmaTkxNS0+dmJ0LnNkdm9fbWFwcGlu
Z3NbMF07Cj4gPiArCQlvdGhlcl9tYXBwaW5nID0gJmk5MTUtPnZidC5zZHZvX21hcHBpbmdzWzFd
Owo+ID4gICAJfSBlbHNlIHsKPiA+IC0JCW15X21hcHBpbmcgPSAmZGV2X3ByaXYtPnZidC5zZHZv
X21hcHBpbmdzWzFdOwo+ID4gLQkJb3RoZXJfbWFwcGluZyA9ICZkZXZfcHJpdi0+dmJ0LnNkdm9f
bWFwcGluZ3NbMF07Cj4gPiArCQlteV9tYXBwaW5nID0gJmk5MTUtPnZidC5zZHZvX21hcHBpbmdz
WzFdOwo+ID4gKwkJb3RoZXJfbWFwcGluZyA9ICZpOTE1LT52YnQuc2R2b19tYXBwaW5nc1swXTsK
PiA+ICAgCX0KPiA+ICAgCS8qIElmIHRoZSBCSU9TIGRlc2NyaWJlZCBvdXIgU0RWTyBkZXZpY2Us
IHRha2UgYWR2YW50YWdlIG9mIGl0LiAqLwo+ID4gQEAgLTI2MTYsMTAgKzI2MTYsMTAgQEAgc3Rh
dGljIHZvaWQKPiA+ICAgaW50ZWxfc2R2b19hZGRfaGRtaV9wcm9wZXJ0aWVzKHN0cnVjdCBpbnRl
bF9zZHZvICppbnRlbF9zZHZvLAo+ID4gICAJCQkgICAgICAgc3RydWN0IGludGVsX3Nkdm9fY29u
bmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuYmFzZS5kZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmJhc2Uu
ZGV2KTsKPiA+ICAgCWludGVsX2F0dGFjaF9mb3JjZV9hdWRpb19wcm9wZXJ0eSgmY29ubmVjdG9y
LT5iYXNlLmJhc2UpOwo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0ICYmIElTX01P
QklMRShkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA0ICYmIElTX01P
QklMRShpOTE1KSkgewo+ID4gICAJCWludGVsX2F0dGFjaF9icm9hZGNhc3RfcmdiX3Byb3BlcnR5
KCZjb25uZWN0b3ItPmJhc2UuYmFzZSk7Cj4gPiAgIAl9Cj4gPiAgIAlpbnRlbF9hdHRhY2hfYXNw
ZWN0X3JhdGlvX3Byb3BlcnR5KCZjb25uZWN0b3ItPmJhc2UuYmFzZSk7Cj4gPiBAQCAtMzE4MCw5
ICszMTgwLDkgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpMmNfbG9ja19vcGVyYXRpb25zIHByb3h5
X2xvY2tfb3BzID0gewo+ID4gICBzdGF0aWMgYm9vbAo+ID4gICBpbnRlbF9zZHZvX2luaXRfZGRj
X3Byb3h5KHN0cnVjdCBpbnRlbF9zZHZvICpzZHZvLAo+ID4gLQkJCSAgc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gKwkJCSAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBk
ZXY7Cj4gPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7Cj4gPiAgIAlz
ZHZvLT5kZGMub3duZXIgPSBUSElTX01PRFVMRTsKPiA+ICAgCXNkdm8tPmRkYy5jbGFzcyA9IEky
Q19DTEFTU19EREM7Cj4gPiBAQCAtMzE5NSwyMyArMzE5NSwyMyBAQCBpbnRlbF9zZHZvX2luaXRf
ZGRjX3Byb3h5KHN0cnVjdCBpbnRlbF9zZHZvICpzZHZvLAo+ID4gICAJcmV0dXJuIGkyY19hZGRf
YWRhcHRlcigmc2R2by0+ZGRjKSA9PSAwOwo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgYXNzZXJ0
X3Nkdm9fcG9ydF92YWxpZChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiArc3RhdGljIHZvaWQgYXNzZXJ0X3Nkdm9fcG9ydF92YWxpZChjb25zdCBzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgIGVudW0gcG9ydCBwb3J0KQo+ID4gICB7
Cj4gPiAtCWlmIChIQVNfUENIX1NQTElUKGRldl9wcml2KSkKPiA+ICsJaWYgKEhBU19QQ0hfU1BM
SVQoaTkxNSkpCj4gPiAgIAkJV0FSTl9PTihwb3J0ICE9IFBPUlRfQik7Cj4gPiAgIAllbHNlCj4g
PiAgIAkJV0FSTl9PTihwb3J0ICE9IFBPUlRfQiAmJiBwb3J0ICE9IFBPUlRfQyk7Cj4gPiAgIH0K
PiA+IC1ib29sIGludGVsX3Nkdm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiArYm9vbCBpbnRlbF9zZHZvX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAkJICAgICBpOTE1X3JlZ190IHNkdm9fcmVnLCBlbnVtIHBvcnQgcG9ydCkKPiA+
ICAgewo+ID4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXI7Cj4gPiAgIAlz
dHJ1Y3QgaW50ZWxfc2R2byAqaW50ZWxfc2R2bzsKPiA+ICAgCWludCBpOwo+ID4gLQlhc3NlcnRf
c2R2b19wb3J0X3ZhbGlkKGRldl9wcml2LCBwb3J0KTsKPiA+ICsJYXNzZXJ0X3Nkdm9fcG9ydF92
YWxpZChpOTE1LCBwb3J0KTsKPiA+ICAgCWludGVsX3Nkdm8gPSBremFsbG9jKHNpemVvZigqaW50
ZWxfc2R2byksIEdGUF9LRVJORUwpOwo+ID4gICAJaWYgKCFpbnRlbF9zZHZvKQo+ID4gQEAgLTMy
MjAsOSArMzIyMCw5IEBAIGJvb2wgaW50ZWxfc2R2b19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICAgCWludGVsX3Nkdm8tPnNkdm9fcmVnID0gc2R2b19yZWc7Cj4g
PiAgIAlpbnRlbF9zZHZvLT5wb3J0ID0gcG9ydDsKPiA+ICAgCWludGVsX3Nkdm8tPnNsYXZlX2Fk
ZHIgPQo+ID4gLQkJaW50ZWxfc2R2b19nZXRfc2xhdmVfYWRkcihkZXZfcHJpdiwgaW50ZWxfc2R2
bykgPj4gMTsKPiA+IC0JaW50ZWxfc2R2b19zZWxlY3RfaTJjX2J1cyhkZXZfcHJpdiwgaW50ZWxf
c2R2byk7Cj4gPiAtCWlmICghaW50ZWxfc2R2b19pbml0X2RkY19wcm94eShpbnRlbF9zZHZvLCBk
ZXZfcHJpdikpCj4gPiArCQlpbnRlbF9zZHZvX2dldF9zbGF2ZV9hZGRyKGk5MTUsIGludGVsX3Nk
dm8pID4+IDE7Cj4gPiArCWludGVsX3Nkdm9fc2VsZWN0X2kyY19idXMoaTkxNSwgaW50ZWxfc2R2
byk7Cj4gPiArCWlmICghaW50ZWxfc2R2b19pbml0X2RkY19wcm94eShpbnRlbF9zZHZvLCBpOTE1
KSkKPiA+ICAgCQlnb3RvIGVycl9pMmNfYnVzOwo+ID4gICAJLyogZW5jb2RlciB0eXBlIHdpbGwg
YmUgZGVjaWRlZCBsYXRlciAqLwo+ID4gQEAgLTMyMzAsNyArMzIzMCw3IEBAIGJvb2wgaW50ZWxf
c2R2b19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWludGVs
X2VuY29kZXItPnR5cGUgPSBJTlRFTF9PVVRQVVRfU0RWTzsKPiA+ICAgCWludGVsX2VuY29kZXIt
PnBvd2VyX2RvbWFpbiA9IFBPV0VSX0RPTUFJTl9QT1JUX09USEVSOwo+ID4gICAJaW50ZWxfZW5j
b2Rlci0+cG9ydCA9IHBvcnQ7Cj4gPiAtCWRybV9lbmNvZGVyX2luaXQoJmRldl9wcml2LT5kcm0s
ICZpbnRlbF9lbmNvZGVyLT5iYXNlLAo+ID4gKwlkcm1fZW5jb2Rlcl9pbml0KCZpOTE1LT5kcm0s
ICZpbnRlbF9lbmNvZGVyLT5iYXNlLAo+ID4gICAJCQkgJmludGVsX3Nkdm9fZW5jX2Z1bmNzLCAw
LAo+ID4gICAJCQkgIlNEVk8gJWMiLCBwb3J0X25hbWUocG9ydCkpOwo+ID4gQEAgLTMyNDYsNyAr
MzI0Niw3IEBAIGJvb2wgaW50ZWxfc2R2b19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICAgCX0KPiA+ICAgCWludGVsX2VuY29kZXItPmNvbXB1dGVfY29uZmlnID0g
aW50ZWxfc2R2b19jb21wdXRlX2NvbmZpZzsKPiA+IC0JaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3By
aXYpKSB7Cj4gPiArCWlmIChIQVNfUENIX1NQTElUKGk5MTUpKSB7Cj4gPiAgIAkJaW50ZWxfZW5j
b2Rlci0+ZGlzYWJsZSA9IHBjaF9kaXNhYmxlX3Nkdm87Cj4gPiAgIAkJaW50ZWxfZW5jb2Rlci0+
cG9zdF9kaXNhYmxlID0gcGNoX3Bvc3RfZGlzYWJsZV9zZHZvOwo+ID4gICAJfSBlbHNlIHsKPiA+
IEBAIC0zMjkwLDcgKzMyOTAsNyBAQCBib29sIGludGVsX3Nkdm9faW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkgKi8KPiA+ICAgCWludGVsX3Nkdm8tPmJhc2Uu
Y2xvbmVhYmxlID0gMDsKPiA+IC0JaW50ZWxfc2R2b19zZWxlY3RfZGRjX2J1cyhkZXZfcHJpdiwg
aW50ZWxfc2R2byk7Cj4gPiArCWludGVsX3Nkdm9fc2VsZWN0X2RkY19idXMoaTkxNSwgaW50ZWxf
c2R2byk7Cj4gPiAgIAkvKiBTZXQgdGhlIGlucHV0IHRpbWluZyB0byB0aGUgc2NyZWVuLiBBc3N1
bWUgYWx3YXlzIGlucHV0IDAuICovCj4gPiAgIAlpZiAoIWludGVsX3Nkdm9fc2V0X3RhcmdldF9p
bnB1dChpbnRlbF9zZHZvKSkKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9zZHZvLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9zZHZvLmgKPiA+IGluZGV4
IGM5ZTA1YmNkZDE0MS4uMWVjNjc2NmM1YWUxIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfc2R2by5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9zZHZvLmgKPiA+IEBAIC0xNSw5ICsxNSw5IEBACj4gPiAgIHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlOwo+ID4gICBlbnVtIHBpcGU7Cj4gPiAtYm9vbCBpbnRlbF9zZHZvX3BvcnRfZW5hYmxlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArYm9vbCBpbnRlbF9zZHZvX3Bv
cnRfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICAgICBp
OTE1X3JlZ190IHNkdm9fcmVnLCBlbnVtIHBpcGUgKnBpcGUpOwo+ID4gLWJvb2wgaW50ZWxfc2R2
b19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtib29sIGludGVs
X3Nkdm9faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkgICAgIGk5
MTVfcmVnX3QgcmVnLCBlbnVtIHBvcnQgcG9ydCk7Cj4gPiAgICNlbmRpZiAvKiBfX0lOVEVMX1NE
Vk9fSF9fICovCj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfc3By
aXRlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9zcHJpdGUuYwo+ID4gaW5kZXggYzE4
MDgxNWZhYWJkLi43Mzg3MWU1ZThlMTkgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9zcHJpdGUuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
c3ByaXRlLmMKPiA+IEBAIC05NCwxMiArOTQsMTIgQEAgaW50IGludGVsX3VzZWNzX3RvX3NjYW5s
aW5lcyhjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSwKPiA+ICAg
dm9pZCBpbnRlbF9waXBlX3VwZGF0ZV9zdGFydChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqbmV3X2NydGNfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9
ICZuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ID4gICAJbG9uZyB0aW1lb3V0
ID0gbXNlY3NfdG9famlmZmllc190aW1lb3V0KDEpOwo+ID4gICAJaW50IHNjYW5saW5lLCBtaW4s
IG1heCwgdmJsYW5rX3N0YXJ0Owo+ID4gICAJd2FpdF9xdWV1ZV9oZWFkX3QgKndxID0gZHJtX2Ny
dGNfdmJsYW5rX3dhaXRxdWV1ZSgmY3J0Yy0+YmFzZSk7Cj4gPiAtCWJvb2wgbmVlZF92bHZfZHNp
X3dhID0gKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYp
KSAmJgo+ID4gKwlib29sIG5lZWRfdmx2X2RzaV93YSA9IChJU19WQUxMRVlWSUVXKGk5MTUpIHx8
IElTX0NIRVJSWVZJRVcoaTkxNSkpICYmCj4gPiAgIAkJaW50ZWxfY3J0Y19oYXNfdHlwZShuZXdf
Y3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0RTSSk7Cj4gPiAgIAlERUZJTkVfV0FJVCh3YWl0KTsK
PiA+ICAgCXUzMiBwc3Jfc3RhdHVzOwo+ID4gQEAgLTIwNyw3ICsyMDcsNyBAQCB2b2lkIGludGVs
X3BpcGVfdXBkYXRlX2VuZChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUp
Cj4gPiAgIAlpbnQgc2NhbmxpbmVfZW5kID0gaW50ZWxfZ2V0X2NydGNfc2NhbmxpbmUoY3J0Yyk7
Cj4gPiAgIAl1MzIgZW5kX3ZibF9jb3VudCA9IGludGVsX2NydGNfZ2V0X3ZibGFua19jb3VudGVy
KGNydGMpOwo+ID4gICAJa3RpbWVfdCBlbmRfdmJsX3RpbWUgPSBrdGltZV9nZXQoKTsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4gPiAgIAl0cmFjZV9pOTE1X3BpcGVfdXBkYXRlX2VuZChjcnRjLCBlbmRfdmJs
X2NvdW50LCBzY2FubGluZV9lbmQpOwo+ID4gQEAgLTIyNyw3ICsyMjcsNyBAQCB2b2lkIGludGVs
X3BpcGVfdXBkYXRlX2VuZChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUp
Cj4gPiAgIAlsb2NhbF9pcnFfZW5hYmxlKCk7Cj4gPiAtCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShk
ZXZfcHJpdikpCj4gPiArCWlmIChpbnRlbF92Z3B1X2FjdGl2ZShpOTE1KSkKPiA+ICAgCQlyZXR1
cm47Cj4gPiAgIAlpZiAoY3J0Yy0+ZGVidWcuc3RhcnRfdmJsX2NvdW50ICYmCj4gPiBAQCAtMzUz
LDcgKzM1Myw3IEBAIHNrbF9wcm9ncmFtX3NjYWxlcihzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5l
LAo+ID4gICAJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
ID4gICAJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4g
PiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShw
bGFuZS0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBp
cGU7Cj4gPiAgIAlpbnQgc2NhbGVyX2lkID0gcGxhbmVfc3RhdGUtPnNjYWxlcl9pZDsKPiA+ICAg
CWNvbnN0IHN0cnVjdCBpbnRlbF9zY2FsZXIgKnNjYWxlciA9Cj4gPiBAQCAtMzc1LDcgKzM3NSw3
IEBAIHNrbF9wcm9ncmFtX3NjYWxlcihzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJ
LyogVE9ETzogaGFuZGxlIHN1Yi1waXhlbCBjb29yZGluYXRlcyAqLwo+ID4gICAJaWYgKGlzX3Bs
YW5hcl95dXZfZm9ybWF0KHBsYW5lX3N0YXRlLT5iYXNlLmZiLT5mb3JtYXQtPmZvcm1hdCkgJiYK
PiA+IC0JICAgICFpY2xfaXNfaGRyX3BsYW5lKGRldl9wcml2LCBwbGFuZS0+aWQpKSB7Cj4gPiAr
CSAgICAhaWNsX2lzX2hkcl9wbGFuZShpOTE1LCBwbGFuZS0+aWQpKSB7Cj4gPiAgIAkJeV9ocGhh
c2UgPSBza2xfc2NhbGVyX2NhbGNfcGhhc2UoMSwgaHNjYWxlLCBmYWxzZSk7Cj4gPiAgIAkJeV92
cGhhc2UgPSBza2xfc2NhbGVyX2NhbGNfcGhhc2UoMSwgdnNjYWxlLCBmYWxzZSk7Cj4gPiBAQCAt
NDE1LDcgKzQxNSw3IEBAIGljbF9wcm9ncmFtX2lucHV0X2NzYyhzdHJ1Y3QgaW50ZWxfcGxhbmUg
KnBsYW5lLAo+ID4gICAJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAo+ID4gICAJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxh
bmVfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBl
ID0gcGxhbmUtPnBpcGU7Cj4gPiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gcGxhbmUtPmlk
Owo+ID4gQEAgLTUwNyw3ICs1MDcsNyBAQCBza2xfcHJvZ3JhbV9wbGFuZShzdHJ1Y3QgaW50ZWxf
cGxhbmUgKnBsYW5lLAo+ID4gICAJCSAgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpw
bGFuZV9zdGF0ZSwKPiA+ICAgCQkgIGludCBjb2xvcl9wbGFuZSwgYm9vbCBzbGF2ZSwgdTMyIHBs
YW5lX2N0bCkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBwbGFuZV9pZCBw
bGFuZV9pZCA9IHBsYW5lLT5pZDsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7
Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2ludGVsX3Nwcml0ZV9jb2xvcmtleSAqa2V5ID0gJnBs
YW5lX3N0YXRlLT5ja2V5Owo+ID4gQEAgLTUyOSw3ICs1MjksNyBAQCBza2xfcHJvZ3JhbV9wbGFu
ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJcGxhbmVfY3RsIHw9IHNrbF9wbGFu
ZV9jdGxfY3J0YyhjcnRjX3N0YXRlKTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
MTAgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gMTAgfHwgSVNfR0VNSU5JTEFLRShpOTE1KSkKPiA+ICAgCQlwbGFuZV9jb2xvcl9jdGwgPSBw
bGFuZV9zdGF0ZS0+Y29sb3JfY3RsIHwKPiA+ICAgCQkJZ2xrX3BsYW5lX2NvbG9yX2N0bF9jcnRj
KGNydGNfc3RhdGUpOwo+ID4gQEAgLTU0OSw3ICs1NDksNyBAQCBza2xfcHJvZ3JhbV9wbGFuZShz
dHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJCWNydGNfeSA9IDA7Cj4gPiAgIAl9Cj4g
PiAtCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsK
PiA+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4g
PiAgIAlJOTE1X1dSSVRFX0ZXKFBMQU5FX1NUUklERShwaXBlLCBwbGFuZV9pZCksIHN0cmlkZSk7
Cj4gPiAgIAlJOTE1X1dSSVRFX0ZXKFBMQU5FX1BPUyhwaXBlLCBwbGFuZV9pZCksIChjcnRjX3kg
PDwgMTYpIHwgY3J0Y194KTsKPiA+IEBAIC01NTcsNyArNTU3LDcgQEAgc2tsX3Byb2dyYW1fcGxh
bmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCUk5MTVfV1JJVEVfRlcoUExBTkVf
QVVYX0RJU1QocGlwZSwgcGxhbmVfaWQpLAo+ID4gICAJCSAgICAgIChwbGFuZV9zdGF0ZS0+Y29s
b3JfcGxhbmVbMV0ub2Zmc2V0IC0gc3VyZl9hZGRyKSB8IGF1eF9zdHJpZGUpOwo+ID4gLQlpZiAo
aWNsX2lzX2hkcl9wbGFuZShkZXZfcHJpdiwgcGxhbmVfaWQpKSB7Cj4gPiArCWlmIChpY2xfaXNf
aGRyX3BsYW5lKGk5MTUsIHBsYW5lX2lkKSkgewo+ID4gICAJCXUzMiBjdXNfY3RsID0gMDsKPiA+
ICAgCQlpZiAobGlua2VkKSB7Cj4gPiBAQCAtNTc4LDEwICs1NzgsMTAgQEAgc2tsX3Byb2dyYW1f
cGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCQlJOTE1X1dSSVRFX0ZXKFBM
QU5FX0NVU19DVEwocGlwZSwgcGxhbmVfaWQpLCBjdXNfY3RsKTsKPiA+ICAgCX0KPiA+IC0JaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4g
PiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShpOTE1KSkKPiA+
ICAgCQlJOTE1X1dSSVRFX0ZXKFBMQU5FX0NPTE9SX0NUTChwaXBlLCBwbGFuZV9pZCksIHBsYW5l
X2NvbG9yX2N0bCk7Cj4gPiAtCWlmIChmYi0+Zm9ybWF0LT5pc195dXYgJiYgaWNsX2lzX2hkcl9w
bGFuZShkZXZfcHJpdiwgcGxhbmVfaWQpKQo+ID4gKwlpZiAoZmItPmZvcm1hdC0+aXNfeXV2ICYm
IGljbF9pc19oZHJfcGxhbmUoaTkxNSwgcGxhbmVfaWQpKQo+ID4gICAJCWljbF9wcm9ncmFtX2lu
cHV0X2NzYyhwbGFuZSwgY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUpOwo+ID4gICAJc2tsX3dyaXRl
X3BsYW5lX3dtKHBsYW5lLCBjcnRjX3N0YXRlKTsKPiA+IEBAIC01OTIsNyArNTkyLDcgQEAgc2ts
X3Byb2dyYW1fcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCUk5MTVfV1JJ
VEVfRlcoUExBTkVfT0ZGU0VUKHBpcGUsIHBsYW5lX2lkKSwgKHkgPDwgMTYpIHwgeCk7Cj4gPiAt
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkg
PCAxMSkKPiA+ICAgCQlJOTE1X1dSSVRFX0ZXKFBMQU5FX0FVWF9PRkZTRVQocGlwZSwgcGxhbmVf
aWQpLAo+ID4gICAJCQkgICAgICAocGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzFdLnkgPDwgMTYp
IHwKPiA+ICAgCQkJICAgICAgcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzFdLngpOwo+ID4gQEAg
LTYwOSw3ICs2MDksNyBAQCBza2xfcHJvZ3JhbV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBs
YW5lLAo+ID4gICAJaWYgKCFzbGF2ZSAmJiBwbGFuZV9zdGF0ZS0+c2NhbGVyX2lkID49IDApCj4g
PiAgIAkJc2tsX3Byb2dyYW1fc2NhbGVyKHBsYW5lLCBjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSk7
Cj4gPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJx
ZmxhZ3MpOwo+ID4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT51bmNvcmUubG9jaywg
aXJxZmxhZ3MpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkCj4gPiBAQCAtNjQxLDE0ICs2NDEs
MTQgQEAgc3RhdGljIHZvaWQKPiA+ICAgc2tsX2Rpc2FibGVfcGxhbmUoc3RydWN0IGludGVsX3Bs
YW5lICpwbGFuZSwKPiA+ICAgCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBsYW5lX2lkIHBs
YW5lX2lkID0gcGxhbmUtPmlkOwo+ID4gICAJZW51bSBwaXBlIHBpcGUgPSBwbGFuZS0+cGlwZTsK
PiA+ICAgCXVuc2lnbmVkIGxvbmcgaXJxZmxhZ3M7Cj4gPiAtCXNwaW5fbG9ja19pcnFzYXZlKCZk
ZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICsJc3Bpbl9sb2NrX2lycXNhdmUo
Jmk5MTUtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gPiAtCWlmIChpY2xfaXNfaGRyX3BsYW5l
KGRldl9wcml2LCBwbGFuZV9pZCkpCj4gPiArCWlmIChpY2xfaXNfaGRyX3BsYW5lKGk5MTUsIHBs
YW5lX2lkKSkKPiA+ICAgCQlJOTE1X1dSSVRFX0ZXKFBMQU5FX0NVU19DVEwocGlwZSwgcGxhbmVf
aWQpLCAwKTsKPiA+ICAgCXNrbF93cml0ZV9wbGFuZV93bShwbGFuZSwgY3J0Y19zdGF0ZSk7Cj4g
PiBAQCAtNjU2LDIxICs2NTYsMjEgQEAgc2tsX2Rpc2FibGVfcGxhbmUoc3RydWN0IGludGVsX3Bs
YW5lICpwbGFuZSwKPiA+ICAgCUk5MTVfV1JJVEVfRlcoUExBTkVfQ1RMKHBpcGUsIHBsYW5lX2lk
KSwgMCk7Cj4gPiAgIAlJOTE1X1dSSVRFX0ZXKFBMQU5FX1NVUkYocGlwZSwgcGxhbmVfaWQpLCAw
KTsKPiA+IC0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBp
cnFmbGFncyk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnVuY29yZS5sb2Nr
LCBpcnFmbGFncyk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGJvb2wKPiA+ICAgc2tsX3BsYW5lX2dl
dF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJCSAgICAgICBlbnVt
IHBpcGUgKnBpcGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9tYWluOwo+ID4gICAJZW51bSBwbGFuZV9pZCBw
bGFuZV9pZCA9IHBsYW5lLT5pZDsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4g
ICAJYm9vbCByZXQ7Cj4gPiAgIAlwb3dlcl9kb21haW4gPSBQT1dFUl9ET01BSU5fUElQRShwbGFu
ZS0+cGlwZSk7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFi
bGVkKGRldl9wcml2LCBwb3dlcl9kb21haW4pOwo+ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxh
eV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LCBwb3dlcl9kb21haW4pOwo+ID4gICAJaWYgKCF3
YWtlcmVmKQo+ID4gICAJCXJldHVybiBmYWxzZTsKPiA+IEBAIC02NzgsNyArNjc4LDcgQEAgc2ts
X3BsYW5lX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJKnBp
cGUgPSBwbGFuZS0+cGlwZTsKPiA+IC0JaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYs
IHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiArCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5
MTUsIHBvd2VyX2RvbWFpbiwgd2FrZXJlZik7Cj4gPiAgIAlyZXR1cm4gcmV0Owo+ID4gICB9Cj4g
PiBAQCAtNjg3LDcgKzY4Nyw3IEBAIHN0YXRpYyB2b2lkCj4gPiAgIGNodl91cGRhdGVfY3NjKGNv
bnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIHsKPiA+ICAg
CXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+
YmFzZS5wbGFuZSk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5iYXNlLmZiOwo+ID4gICAJZW51bSBwbGFuZV9p
ZCBwbGFuZV9pZCA9IHBsYW5lLT5pZDsKPiA+ICAgCS8qCj4gPiBAQCAtNzQ2LDcgKzc0Niw3IEBA
IHN0YXRpYyB2b2lkCj4gPiAgIHZsdl91cGRhdGVfY2xyYyhjb25zdCBzdHJ1Y3QgaW50ZWxfcGxh
bmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfcGxhbmUg
KnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUpOwo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRl
dik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+
YmFzZS5kZXYpOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFu
ZV9zdGF0ZS0+YmFzZS5mYjsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7Cj4g
PiAgIAllbnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gcGxhbmUtPmlkOwo+ID4gQEAgLTg2Myw3ICs4
NjMsNyBAQCB2bHZfdXBkYXRlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAg
IAkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCSBj
b25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ID4gICB7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2Uu
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5l
LT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IHBsYW5lLT5waXBlOwo+ID4gICAJ
ZW51bSBwbGFuZV9pZCBwbGFuZV9pZCA9IHBsYW5lLT5pZDsKPiA+ICAgCXUzMiBzcHJzdXJmX29m
ZnNldCA9IHBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5vZmZzZXQ7Cj4gPiBAQCAtODg2LDcg
Kzg4Niw3IEBAIHZsdl91cGRhdGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+
ICAgCWxpbmVhcl9vZmZzZXQgPSBpbnRlbF9mYl94eV90b19saW5lYXIoeCwgeSwgcGxhbmVfc3Rh
dGUsIDApOwo+ID4gLQlzcGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBp
cnFmbGFncyk7Cj4gPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT51bmNvcmUubG9jaywgaXJx
ZmxhZ3MpOwo+ID4gICAJSTkxNV9XUklURV9GVyhTUFNUUklERShwaXBlLCBwbGFuZV9pZCksCj4g
PiAgIAkJICAgICAgcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzBdLnN0cmlkZSk7Cj4gPiBAQCAt
ODk0LDcgKzg5NCw3IEBAIHZsdl91cGRhdGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFu
ZSwKPiA+ICAgCUk5MTVfV1JJVEVfRlcoU1BTSVpFKHBpcGUsIHBsYW5lX2lkKSwgKGNydGNfaCA8
PCAxNikgfCBjcnRjX3cpOwo+ID4gICAJSTkxNV9XUklURV9GVyhTUENPTlNUQUxQSEEocGlwZSwg
cGxhbmVfaWQpLCAwKTsKPiA+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpICYmIHBpcGUg
PT0gUElQRV9CKQo+ID4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSAmJiBwaXBlID09IFBJUEVf
QikKPiA+ICAgCQljaHZfdXBkYXRlX2NzYyhwbGFuZV9zdGF0ZSk7Cj4gPiAgIAlpZiAoa2V5LT5m
bGFncykgewo+ID4gQEAgLTkxNywzOCArOTE3LDM4IEBAIHZsdl91cGRhdGVfcGxhbmUoc3RydWN0
IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCXZsdl91cGRhdGVfY2xyYyhwbGFuZV9zdGF0ZSk7
Cj4gPiAtCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJx
ZmxhZ3MpOwo+ID4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT51bmNvcmUubG9jaywg
aXJxZmxhZ3MpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkCj4gPiAgIHZsdl9kaXNhYmxlX3Bs
YW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIAkJICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4g
ICAJZW51bSBwaXBlIHBpcGUgPSBwbGFuZS0+cGlwZTsKPiA+ICAgCWVudW0gcGxhbmVfaWQgcGxh
bmVfaWQgPSBwbGFuZS0+aWQ7Cj4gPiAgIAl1bnNpZ25lZCBsb25nIGlycWZsYWdzOwo+ID4gLQlz
cGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gPiAr
CXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gICAJ
STkxNV9XUklURV9GVyhTUENOVFIocGlwZSwgcGxhbmVfaWQpLCAwKTsKPiA+ICAgCUk5MTVfV1JJ
VEVfRlcoU1BTVVJGKHBpcGUsIHBsYW5lX2lkKSwgMCk7Cj4gPiAtCXNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gKwlzcGluX3VubG9j
a19pcnFyZXN0b3JlKCZpOTE1LT51bmNvcmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gICB9Cj4gPiAg
IHN0YXRpYyBib29sCj4gPiAgIHZsdl9wbGFuZV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX3Bs
YW5lICpwbGFuZSwKPiA+ICAgCQkgICAgICAgZW51bSBwaXBlICpwaXBlKQo+ID4gICB7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2Uu
ZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5l
LT5iYXNlLmRldik7Cj4gPiAgIAllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIHBvd2Vy
X2RvbWFpbjsKPiA+ICAgCWVudW0gcGxhbmVfaWQgcGxhbmVfaWQgPSBwbGFuZS0+aWQ7Cj4gPiAg
IAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPiA+ICAgCWJvb2wgcmV0Owo+ID4gICAJcG93ZXJf
ZG9tYWluID0gUE9XRVJfRE9NQUlOX1BJUEUocGxhbmUtPnBpcGUpOwo+ID4gLQl3YWtlcmVmID0g
aW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJfZG9tYWlu
KTsKPiA+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoaTkx
NSwgcG93ZXJfZG9tYWluKTsKPiA+ICAgCWlmICghd2FrZXJlZikKPiA+ICAgCQlyZXR1cm4gZmFs
c2U7Cj4gPiBAQCAtOTU2LDcgKzk1Niw3IEBAIHZsdl9wbGFuZV9nZXRfaHdfc3RhdGUoc3RydWN0
IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCSpwaXBlID0gcGxhbmUtPnBpcGU7Cj4gPiAtCWlu
dGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+
ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBwb3dlcl9kb21haW4sIHdha2VyZWYp
Owo+ID4gICAJcmV0dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTk3Nyw3ICs5NzcsNyBAQCBzdGF0
aWMgdTMyIGl2Yl9zcHJpdGVfY3RsX2NydGMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4gPiAgIHN0YXRpYyB1MzIgaXZiX3Nwcml0ZV9jdGwoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJCSAgY29uc3Qgc3RydWN0IGlu
dGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9Cj4gPiAgIAkJdG9faTkxNShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZS0+ZGV2KTsKPiA+ICAg
CWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7
Cj4gPiAgIAl1bnNpZ25lZCBpbnQgcm90YXRpb24gPSBwbGFuZV9zdGF0ZS0+YmFzZS5yb3RhdGlv
bjsKPiA+IEBAIC05ODYsNyArOTg2LDcgQEAgc3RhdGljIHUzMiBpdmJfc3ByaXRlX2N0bChjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCXNwcmN0bCA9IFNQ
UklURV9FTkFCTEU7Cj4gPiAtCWlmIChJU19JVllCUklER0UoZGV2X3ByaXYpKQo+ID4gKwlpZiAo
SVNfSVZZQlJJREdFKGk5MTUpKQo+ID4gICAJCXNwcmN0bCB8PSBTUFJJVEVfVFJJQ0tMRV9GRUVE
X0RJU0FCTEU7Cj4gPiAgIAlzd2l0Y2ggKGZiLT5mb3JtYXQtPmZvcm1hdCkgewo+ID4gQEAgLTEw
MzgsNyArMTAzOCw3IEBAIGl2Yl91cGRhdGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFu
ZSwKPiA+ICAgCQkgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4g
PiAgIAkJIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFu
ZS0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7
Cj4gPiAgIAl1MzIgc3Byc3VyZl9vZmZzZXQgPSBwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbMF0u
b2Zmc2V0Owo+ID4gICAJdTMyIGxpbmVhcl9vZmZzZXQ7Cj4gPiBAQCAtMTA2NywxMiArMTA2Nywx
MiBAQCBpdmJfdXBkYXRlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIAls
aW5lYXJfb2Zmc2V0ID0gaW50ZWxfZmJfeHlfdG9fbGluZWFyKHgsIHksIHBsYW5lX3N0YXRlLCAw
KTsKPiA+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT51bmNvcmUubG9jaywgaXJxZmxh
Z3MpOwo+ID4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+dW5jb3JlLmxvY2ssIGlycWZsYWdz
KTsKPiA+ICAgCUk5MTVfV1JJVEVfRlcoU1BSU1RSSURFKHBpcGUpLCBwbGFuZV9zdGF0ZS0+Y29s
b3JfcGxhbmVbMF0uc3RyaWRlKTsKPiA+ICAgCUk5MTVfV1JJVEVfRlcoU1BSUE9TKHBpcGUpLCAo
Y3J0Y195IDw8IDE2KSB8IGNydGNfeCk7Cj4gPiAgIAlJOTE1X1dSSVRFX0ZXKFNQUlNJWkUocGlw
ZSksIChjcnRjX2ggPDwgMTYpIHwgY3J0Y193KTsKPiA+IC0JaWYgKElTX0lWWUJSSURHRShkZXZf
cHJpdikpCj4gPiArCWlmIChJU19JVllCUklER0UoaTkxNSkpCj4gPiAgIAkJSTkxNV9XUklURV9G
VyhTUFJTQ0FMRShwaXBlKSwgc3Byc2NhbGUpOwo+ID4gICAJaWYgKGtleS0+ZmxhZ3MpIHsKPiA+
IEBAIC0xMDgzLDcgKzEwODMsNyBAQCBpdmJfdXBkYXRlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFu
ZSAqcGxhbmUsCj4gPiAgIAkvKiBIU1cgY29uc29saWRhdGVzIFNQUlRJTEVPRkYgYW5kIFNQUkxJ
Tk9GRiBpbnRvIGEgc2luZ2xlIFNQUk9GRlNFVAo+ID4gICAJICogcmVnaXN0ZXIgKi8KPiA+IC0J
aWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpIHx8IElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKPiA+
ICsJaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKSB7Cj4gPiAgIAkJ
STkxNV9XUklURV9GVyhTUFJPRkZTRVQocGlwZSksICh5IDw8IDE2KSB8IHgpOwo+ID4gICAJfSBl
bHNlIHsKPiA+ICAgCQlJOTE1X1dSSVRFX0ZXKFNQUkxJTk9GRihwaXBlKSwgbGluZWFyX29mZnNl
dCk7Cj4gPiBAQCAtMTA5OSwzOSArMTA5OSwzOSBAQCBpdmJfdXBkYXRlX3BsYW5lKHN0cnVjdCBp
bnRlbF9wbGFuZSAqcGxhbmUsCj4gPiAgIAlJOTE1X1dSSVRFX0ZXKFNQUlNVUkYocGlwZSksCj4g
PiAgIAkJICAgICAgaW50ZWxfcGxhbmVfZ2d0dF9vZmZzZXQocGxhbmVfc3RhdGUpICsgc3Byc3Vy
Zl9vZmZzZXQpOwo+ID4gLQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+dW5jb3Jl
LmxvY2ssIGlycWZsYWdzKTsKPiA+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+dW5j
b3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICAgfQo+ID4gICBzdGF0aWMgdm9pZAo+ID4gICBpdmJf
ZGlzYWJsZV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJCSAgY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+
ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJhc2Uu
ZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7Cj4gPiAgIAl1bnNpZ25l
ZCBsb25nIGlycWZsYWdzOwo+ID4gLQlzcGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPnVuY29y
ZS5sb2NrLCBpcnFmbGFncyk7Cj4gPiArCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT51bmNvcmUu
bG9jaywgaXJxZmxhZ3MpOwo+ID4gICAJSTkxNV9XUklURV9GVyhTUFJDVEwocGlwZSksIDApOwo+
ID4gICAJLyogRGlzYWJsZSB0aGUgc2NhbGVyICovCj4gPiAtCWlmIChJU19JVllCUklER0UoZGV2
X3ByaXYpKQo+ID4gKwlpZiAoSVNfSVZZQlJJREdFKGk5MTUpKQo+ID4gICAJCUk5MTVfV1JJVEVf
RlcoU1BSU0NBTEUocGlwZSksIDApOwo+ID4gICAJSTkxNV9XUklURV9GVyhTUFJTVVJGKHBpcGUp
LCAwKTsKPiA+IC0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPnVuY29yZS5sb2Nr
LCBpcnFmbGFncyk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnVuY29yZS5s
b2NrLCBpcnFmbGFncyk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGJvb2wKPiA+ICAgaXZiX3BsYW5l
X2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJCSAgICAgICBl
bnVtIHBpcGUgKnBpcGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gaW50
ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9tYWluOwo+ID4gICAJaW50ZWxfd2FrZXJl
Zl90IHdha2VyZWY7Cj4gPiAgIAlib29sIHJldDsKPiA+ICAgCXBvd2VyX2RvbWFpbiA9IFBPV0VS
X0RPTUFJTl9QSVBFKHBsYW5lLT5waXBlKTsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlf
cG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbik7Cj4gPiArCXdha2Vy
ZWYgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUsIHBvd2VyX2RvbWFp
bik7Cj4gPiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTEx
MzksNyArMTEzOSw3IEBAIGl2Yl9wbGFuZV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX3BsYW5l
ICpwbGFuZSwKPiA+ICAgCSpwaXBlID0gcGxhbmUtPnBpcGU7Cj4gPiAtCWludGVsX2Rpc3BsYXlf
cG93ZXJfcHV0KGRldl9wcml2LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9k
aXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ID4gICAJcmV0
dXJuIHJldDsKPiA+ICAgfQo+ID4gQEAgLTExNjgsNyArMTE2OCw3IEBAIHN0YXRpYyB1MzIgZzR4
X3Nwcml0ZV9jdGxfY3J0Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPiA+ICAgc3RhdGljIHUzMiBnNHhfc3ByaXRlX2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVf
c3RhdGUgKnBsYW5lX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0KPiA+ICAg
CQl0b19pOTE1KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lLT5kZXYpOwo+ID4gICAJY29uc3Qgc3Ry
dWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+YmFzZS5mYjsKPiA+ICAgCXVu
c2lnbmVkIGludCByb3RhdGlvbiA9IHBsYW5lX3N0YXRlLT5iYXNlLnJvdGF0aW9uOwo+ID4gQEAg
LTExNzcsNyArMTE3Nyw3IEBAIHN0YXRpYyB1MzIgZzR4X3Nwcml0ZV9jdGwoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAlkdnNjbnRyID0gRFZTX0VOQUJM
RTsKPiA+IC0JaWYgKElTX0dFTihkZXZfcHJpdiwgNikpCj4gPiArCWlmIChJU19HRU4oaTkxNSwg
NikpCj4gPiAgIAkJZHZzY250ciB8PSBEVlNfVFJJQ0tMRV9GRUVEX0RJU0FCTEU7Cj4gPiAgIAlz
d2l0Y2ggKGZiLT5mb3JtYXQtPmZvcm1hdCkgewo+ID4gQEAgLTEyMjksNyArMTIyOSw3IEBAIGc0
eF91cGRhdGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCQkgY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAkJIGNvbnN0IHN0cnVj
dCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2
KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gcGxhbmUtPnBpcGU7Cj4gPiAgIAl1MzIgZHZzc3Vy
Zl9vZmZzZXQgPSBwbGFuZV9zdGF0ZS0+Y29sb3JfcGxhbmVbMF0ub2Zmc2V0Owo+ID4gICAJdTMy
IGxpbmVhcl9vZmZzZXQ7Cj4gPiBAQCAtMTI1OCw3ICsxMjU4LDcgQEAgZzR4X3VwZGF0ZV9wbGFu
ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJbGluZWFyX29mZnNldCA9IGludGVs
X2ZiX3h5X3RvX2xpbmVhcih4LCB5LCBwbGFuZV9zdGF0ZSwgMCk7Cj4gPiAtCXNwaW5fbG9ja19p
cnFzYXZlKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2ssIGlycWZsYWdzKTsKPiA+ICsJc3Bpbl9sb2Nr
X2lycXNhdmUoJmk5MTUtPnVuY29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gPiAgIAlJOTE1X1dSSVRF
X0ZXKERWU1NUUklERShwaXBlKSwgcGxhbmVfc3RhdGUtPmNvbG9yX3BsYW5lWzBdLnN0cmlkZSk7
Cj4gPiAgIAlJOTE1X1dSSVRFX0ZXKERWU1BPUyhwaXBlKSwgKGNydGNfeSA8PCAxNikgfCBjcnRj
X3gpOwo+ID4gQEAgLTEyODMsMzggKzEyODMsMzggQEAgZzR4X3VwZGF0ZV9wbGFuZShzdHJ1Y3Qg
aW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJSTkxNV9XUklURV9GVyhEVlNTVVJGKHBpcGUpLAo+
ID4gICAJCSAgICAgIGludGVsX3BsYW5lX2dndHRfb2Zmc2V0KHBsYW5lX3N0YXRlKSArIGR2c3N1
cmZfb2Zmc2V0KTsKPiA+IC0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPnVuY29y
ZS5sb2NrLCBpcnFmbGFncyk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnVu
Y29yZS5sb2NrLCBpcnFmbGFncyk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIHZvaWQKPiA+ICAgZzR4
X2Rpc2FibGVfcGxhbmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKPiA+ICAgCQkgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNl
LmRldik7Cj4gPiAgIAllbnVtIHBpcGUgcGlwZSA9IHBsYW5lLT5waXBlOwo+ID4gICAJdW5zaWdu
ZWQgbG9uZyBpcnFmbGFnczsKPiA+IC0Jc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT51bmNv
cmUubG9jaywgaXJxZmxhZ3MpOwo+ID4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+dW5jb3Jl
LmxvY2ssIGlycWZsYWdzKTsKPiA+ICAgCUk5MTVfV1JJVEVfRlcoRFZTQ05UUihwaXBlKSwgMCk7
Cj4gPiAgIAkvKiBEaXNhYmxlIHRoZSBzY2FsZXIgKi8KPiA+ICAgCUk5MTVfV1JJVEVfRlcoRFZT
U0NBTEUocGlwZSksIDApOwo+ID4gICAJSTkxNV9XUklURV9GVyhEVlNTVVJGKHBpcGUpLCAwKTsK
PiA+IC0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBpcnFm
bGFncyk7Cj4gPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnVuY29yZS5sb2NrLCBp
cnFmbGFncyk7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGJvb2wKPiA+ICAgZzR4X3BsYW5lX2dldF9o
d19zdGF0ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+ID4gICAJCSAgICAgICBlbnVtIHBp
cGUgKnBpcGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gaW50ZWxfZGlz
cGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9tYWluOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdh
a2VyZWY7Cj4gPiAgIAlib29sIHJldDsKPiA+ICAgCXBvd2VyX2RvbWFpbiA9IFBPV0VSX0RPTUFJ
Tl9QSVBFKHBsYW5lLT5waXBlKTsKPiA+IC0Jd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJf
Z2V0X2lmX2VuYWJsZWQoZGV2X3ByaXYsIHBvd2VyX2RvbWFpbik7Cj4gPiArCXdha2VyZWYgPSBp
bnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFibGVkKGk5MTUsIHBvd2VyX2RvbWFpbik7Cj4g
PiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+ID4gQEAgLTEzMjIsNyAr
MTMyMiw3IEBAIGc0eF9wbGFuZV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX3BsYW5lICpwbGFu
ZSwKPiA+ICAgCSpwaXBlID0gcGxhbmUtPnBpcGU7Cj4gPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJf
cHV0KGRldl9wcml2LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9kaXNwbGF5
X3Bvd2VyX3B1dChpOTE1LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ID4gICAJcmV0dXJuIHJl
dDsKPiA+ICAgfQo+ID4gQEAgLTE0MDYsMTYgKzE0MDYsMTYgQEAgZzR4X3Nwcml0ZV9jaGVjayhz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkgc3RydWN0IGludGVs
X3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX3Bs
YW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lKTsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+YmFz
ZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUocGxh
bmUtPmJhc2UuZGV2KTsKPiA+ICAgCWludCBtaW5fc2NhbGUgPSBEUk1fUExBTkVfSEVMUEVSX05P
X1NDQUxJTkc7Cj4gPiAgIAlpbnQgbWF4X3NjYWxlID0gRFJNX1BMQU5FX0hFTFBFUl9OT19TQ0FM
SU5HOwo+ID4gICAJaW50IHJldDsKPiA+ICAgCWlmIChpbnRlbF9mYl9zY2FsYWJsZShwbGFuZV9z
dGF0ZS0+YmFzZS5mYikpIHsKPiA+IC0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgNykgewo+
ID4gKwkJaWYgKElOVEVMX0dFTihpOTE1KSA8IDcpIHsKPiA+ICAgCQkJbWluX3NjYWxlID0gMTsK
PiA+ICAgCQkJbWF4X3NjYWxlID0gMTYgPDwgMTY7Cj4gPiAtCQl9IGVsc2UgaWYgKElTX0lWWUJS
SURHRShkZXZfcHJpdikpIHsKPiA+ICsJCX0gZWxzZSBpZiAoSVNfSVZZQlJJREdFKGk5MTUpKSB7
Cj4gPiAgIAkJCW1pbl9zY2FsZSA9IDE7Cj4gPiAgIAkJCW1heF9zY2FsZSA9IDIgPDwgMTY7Cj4g
PiAgIAkJfQo+ID4gQEAgLTE0NDMsNyArMTQ0Myw3IEBAIGc0eF9zcHJpdGVfY2hlY2soc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gPiAgIAlpZiAocmV0KQo+ID4gICAJCXJl
dHVybiByZXQ7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDcpCj4gPiArCWlmIChJ
TlRFTF9HRU4oaTkxNSkgPj0gNykKPiA+ICAgCQlwbGFuZV9zdGF0ZS0+Y3RsID0gaXZiX3Nwcml0
ZV9jdGwoY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUpOwo+ID4gICAJZWxzZQo+ID4gICAJCXBsYW5l
X3N0YXRlLT5jdGwgPSBnNHhfc3ByaXRlX2N0bChjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSk7Cj4g
PiBAQCAtMTQ1NCwxMSArMTQ1NCwxMSBAQCBnNHhfc3ByaXRlX2NoZWNrKHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICBpbnQgY2h2X3BsYW5lX2NoZWNrX3JvdGF0aW9u
KGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIHsKPiA+
ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0
ZS0+YmFzZS5wbGFuZSk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gPiAgIAl1bnNpZ25lZCBpbnQgcm90
YXRpb24gPSBwbGFuZV9zdGF0ZS0+YmFzZS5yb3RhdGlvbjsKPiA+ICAgCS8qIENIViBpZ25vcmVz
IHRoZSBtaXJyb3IgYml0IHdoZW4gdGhlIHJvdGF0ZSBiaXQgaXMgc2V0IDooICovCj4gPiAtCWlm
IChJU19DSEVSUllWSUVXKGRldl9wcml2KSAmJgo+ID4gKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1
KSAmJgo+ID4gICAJICAgIHJvdGF0aW9uICYgRFJNX01PREVfUk9UQVRFXzE4MCAmJgo+ID4gICAJ
ICAgIHJvdGF0aW9uICYgRFJNX01PREVfUkVGTEVDVF9YKSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0tN
UygiQ2Fubm90IHJvdGF0ZSBhbmQgcmVmbGVjdCBhdCB0aGUgc2FtZSB0aW1lXG4iKTsKPiA+IEBA
IC0xNTA2LDcgKzE1MDYsNyBAQCBzdGF0aWMgaW50IHNrbF9wbGFuZV9jaGVja19mYihjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+ICAgCQkJICAgICAgY29uc3Qg
c3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3Ry
dWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5iYXNl
LnBsYW5lKTsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVi
dWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7Cj4gPiAgIAl1bnNpZ25lZCBpbnQgcm90
YXRpb24gPSBwbGFuZV9zdGF0ZS0+YmFzZS5yb3RhdGlvbjsKPiA+ICAgCXN0cnVjdCBkcm1fZm9y
bWF0X25hbWVfYnVmIGZvcm1hdF9uYW1lOwo+ID4gQEAgLTE1NDAsNyArMTU0MCw3IEBAIHN0YXRp
YyBpbnQgc2tsX3BsYW5lX2NoZWNrX2ZiKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAo+ID4gICAJCSAqLwo+ID4gICAJCXN3aXRjaCAoZmItPmZvcm1hdC0+Zm9ybWF0
KSB7Cj4gPiAgIAkJY2FzZSBEUk1fRk9STUFUX1JHQjU2NToKPiA+IC0JCQlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMSkKPiA+ICsJCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQo+ID4g
ICAJCQkJYnJlYWs7Cj4gPiAgIAkJCS8qIGZhbGwgdGhyb3VnaCAqLwo+ID4gICAJCWNhc2UgRFJN
X0ZPUk1BVF9DODoKPiA+IEBAIC0xNTc5LDcgKzE1NzksNyBAQCBzdGF0aWMgaW50IHNrbF9wbGFu
ZV9jaGVja19mYihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiA+
ICAgc3RhdGljIGludCBza2xfcGxhbmVfY2hlY2tfZHN0X2Nvb3JkaW5hdGVzKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkJCSAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPQo+ID4gICAJCXRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUtPmRldik7Cj4g
PiAgIAlpbnQgY3J0Y194ID0gcGxhbmVfc3RhdGUtPmJhc2UuZHN0LngxOwo+ID4gICAJaW50IGNy
dGNfdyA9IGRybV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+YmFzZS5kc3QpOwo+ID4gQEAgLTE1
OTQsNyArMTU5NCw3IEBAIHN0YXRpYyBpbnQgc2tsX3BsYW5lX2NoZWNrX2RzdF9jb29yZGluYXRl
cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zCj4gPiAgIAkgKiB0aGFuIHRo
ZSBjdXJzb3IgZW5kaW5nIGxlc3MgdGhhbiA0IHBpeGVscyBmcm9tIHRoZSBsZWZ0IGVkZ2Ugb2Yg
dGhlCj4gPiAgIAkgKiBzY3JlZW4gbWF5IGNhdXNlIEZJRk8gdW5kZXJmbG93IGFuZCBkaXNwbGF5
IGNvcnJ1cHRpb24uCj4gPiAgIAkgKi8KPiA+IC0JaWYgKChJU19HRU1JTklMQUtFKGRldl9wcml2
KSB8fCBJU19DQU5OT05MQUtFKGRldl9wcml2KSkgJiYKPiA+ICsJaWYgKChJU19HRU1JTklMQUtF
KGk5MTUpIHx8IElTX0NBTk5PTkxBS0UoaTkxNSkpICYmCj4gPiAgIAkgICAgKGNydGNfeCArIGNy
dGNfdyA8IDQgfHwgY3J0Y194ID4gcGlwZV9zcmNfdyAtIDQpKSB7Cj4gPiAgIAkJRFJNX0RFQlVH
X0tNUygicmVxdWVzdGVkIHBsYW5lIFggJXMgcG9zaXRpb24gJWQgaW52YWxpZCAodmFsaWQgcmFu
Z2UgJWQtJWQpXG4iLAo+ID4gICAJCQkgICAgICBjcnRjX3ggKyBjcnRjX3cgPCA0ID8gImVuZCIg
OiAic3RhcnQiLAo+ID4gQEAgLTE2MjcsNyArMTYyNyw3IEBAIHN0YXRpYyBpbnQgc2tsX3BsYW5l
X2NoZWNrKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ID4gICAJCQkgICBz
dHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ID4gICB7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2Uu
cGxhbmUpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KHBsYW5lLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShwbGFuZS0+YmFzZS5kZXYpOwo+ID4gICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1
ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+YmFzZS5mYjsKPiA+ICAgCWludCBtaW5fc2NhbGUgPSBE
Uk1fUExBTkVfSEVMUEVSX05PX1NDQUxJTkc7Cj4gPiAgIAlpbnQgbWF4X3NjYWxlID0gRFJNX1BM
QU5FX0hFTFBFUl9OT19TQ0FMSU5HOwo+ID4gQEAgLTE2NzUsMjMgKzE2NzUsMjMgQEAgc3RhdGlj
IGludCBza2xfcGxhbmVfY2hlY2soc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4gPiAgIAlwbGFuZV9zdGF0ZS0+Y3RsID0gc2tsX3BsYW5lX2N0bChjcnRjX3N0YXRlLCBwbGFu
ZV9zdGF0ZSk7Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwIHx8IElTX0dFTUlO
SUxBS0UoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDEwIHx8IElTX0dF
TUlOSUxBS0UoaTkxNSkpCj4gPiAgIAkJcGxhbmVfc3RhdGUtPmNvbG9yX2N0bCA9IGdsa19wbGFu
ZV9jb2xvcl9jdGwoY3J0Y19zdGF0ZSwKPiA+ICAgCQkJCQkJCSAgICAgcGxhbmVfc3RhdGUpOwo+
ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBoYXNfZHN0X2tleV9pbl9w
cmltYXJ5X3BsYW5lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0
aWMgYm9vbCBoYXNfZHN0X2tleV9pbl9wcmltYXJ5X3BsYW5lKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXJldHVybiBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDk7
Cj4gPiArCXJldHVybiBJTlRFTF9HRU4oaTkxNSkgPj0gOTsKPiA+ICAgfQo+ID4gICBzdGF0aWMg
dm9pZCBpbnRlbF9wbGFuZV9zZXRfY2tleShzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlLAo+ID4gICAJCQkJIGNvbnN0IHN0cnVjdCBkcm1faW50ZWxfc3ByaXRlX2NvbG9ya2V5
ICpzZXQpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRl
bF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4gPiAg
IAlzdHJ1Y3QgZHJtX2ludGVsX3Nwcml0ZV9jb2xvcmtleSAqa2V5ID0gJnBsYW5lX3N0YXRlLT5j
a2V5Owo+ID4gICAJKmtleSA9ICpzZXQ7Cj4gPiBAQCAtMTcwOCw3ICsxNzA4LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfcGxhbmVfc2V0X2NrZXkoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFu
ZV9zdGF0ZSwKPiA+ICAgCSAqIE9uIFNLTCsgd2Ugd2FudCBkc3Qga2V5IGVuYWJsZWQgb24KPiA+
ICAgCSAqIHRoZSBwcmltYXJ5IGFuZCBub3Qgb24gdGhlIHNwcml0ZS4KPiA+ICAgCSAqLwo+ID4g
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5ICYmIHBsYW5lLT5pZCAhPSBQTEFORV9QUklN
QVJZICYmCj4gPiArCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSAmJiBwbGFuZS0+aWQgIT0gUExB
TkVfUFJJTUFSWSAmJgo+ID4gICAJICAgIHNldC0+ZmxhZ3MgJiBJOTE1X1NFVF9DT0xPUktFWV9E
RVNUSU5BVElPTikKPiA+ICAgCQlrZXktPmZsYWdzID0gMDsKPiA+ICAgfQo+ID4gQEAgLTE3MTYs
NyArMTcxNiw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3BsYW5lX3NldF9ja2V5KHN0cnVjdCBpbnRl
bF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUsCj4gPiAgIGludCBpbnRlbF9zcHJpdGVfc2V0X2Nv
bG9ya2V5X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAgIAkJ
CQkgICAgc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBkcm1faW50
ZWxfc3ByaXRlX2NvbG9ya2V5ICpzZXQgPSBkYXRhOwo+ID4gICAJc3RydWN0IGRybV9wbGFuZSAq
cGxhbmU7Cj4gPiAgIAlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZTsKPiA+IEBA
IC0xNzM0LDcgKzE3MzQsNyBAQCBpbnQgaW50ZWxfc3ByaXRlX3NldF9jb2xvcmtleV9pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAo+ID4gICAJaWYgKChzZXQtPmZsYWdz
ICYgKEk5MTVfU0VUX0NPTE9SS0VZX0RFU1RJTkFUSU9OIHwgSTkxNV9TRVRfQ09MT1JLRVlfU09V
UkNFKSkgPT0gKEk5MTVfU0VUX0NPTE9SS0VZX0RFU1RJTkFUSU9OIHwgSTkxNV9TRVRfQ09MT1JL
RVlfU09VUkNFKSkKPiA+ICAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+IC0JaWYgKChJU19WQUxMRVlW
SUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgJiYKPiA+ICsJaWYgKChJ
U19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJRVcoaTkxNSkpICYmCj4gPiAgIAkgICAg
c2V0LT5mbGFncyAmIEk5MTVfU0VUX0NPTE9SS0VZX0RFU1RJTkFUSU9OKQo+ID4gICAJCXJldHVy
biAtRUlOVkFMOwo+ID4gQEAgLTE3NDcsNyArMTc0Nyw3IEBAIGludCBpbnRlbF9zcHJpdGVfc2V0
X2NvbG9ya2V5X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAg
IAkgKiBBbHNvIG11bHRpcGxlIHBsYW5lcyBjYW4ndCBkbyBkZXN0aW5hdGlvbiBrZXlpbmcgb24g
dGhlIHNhbWUKPiA+ICAgCSAqIHBpcGUgc2ltdWx0YW5lb3VzbHkuCj4gPiAgIAkgKi8KPiA+IC0J
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSAmJgo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDkgJiYKPiA+ICAgCSAgICB0b19pbnRlbF9wbGFuZShwbGFuZSktPmlkID49IFBMQU5FX1NQ
UklURTEgJiYKPiA+ICAgCSAgICBzZXQtPmZsYWdzICYgSTkxNV9TRVRfQ09MT1JLRVlfREVTVElO
QVRJT04pCj4gPiAgIAkJcmV0dXJuIC1FSU5WQUw7Cj4gPiBAQCAtMTc3MSw5ICsxNzcxLDkgQEAg
aW50IGludGVsX3Nwcml0ZV9zZXRfY29sb3JrZXlfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwgdm9pZCAqZGF0YSwKPiA+ICAgCQkgKiBPbiBzb21lIHBsYXRmb3JtcyB3ZSBoYXZlIHRvIGNv
bmZpZ3VyZQo+ID4gICAJCSAqIHRoZSBkc3QgY29sb3JrZXkgb24gdGhlIHByaW1hcnkgcGxhbmUu
Cj4gPiAgIAkJICovCj4gPiAtCQlpZiAoIXJldCAmJiBoYXNfZHN0X2tleV9pbl9wcmltYXJ5X3Bs
YW5lKGRldl9wcml2KSkgewo+ID4gKwkJaWYgKCFyZXQgJiYgaGFzX2RzdF9rZXlfaW5fcHJpbWFy
eV9wbGFuZShpOTE1KSkgewo+ID4gICAJCQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9Cj4gPiAt
CQkJCWludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LAo+ID4gKwkJCQlpbnRlbF9nZXRf
Y3J0Y19mb3JfcGlwZShpOTE1LAo+ID4gICAJCQkJCQkJdG9faW50ZWxfcGxhbmUocGxhbmUpLT5w
aXBlKTsKPiA+ICAgCQkJcGxhbmVfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9wbGFuZV9zdGF0ZShz
dGF0ZSwKPiA+IEBAIC0yMTk3LDI2ICsyMTk3LDI2IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJt
X3BsYW5lX2Z1bmNzIHNrbF9wbGFuZV9mdW5jcyA9IHsKPiA+ICAgCS5mb3JtYXRfbW9kX3N1cHBv
cnRlZCA9IHNrbF9wbGFuZV9mb3JtYXRfbW9kX3N1cHBvcnRlZCwKPiA+ICAgfTsKPiA+IC1zdGF0
aWMgYm9vbCBza2xfcGxhbmVfaGFzX2ZiYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiArc3RhdGljIGJvb2wgc2tsX3BsYW5lX2hhc19mYmMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgICAgIGVudW0gcGlwZSBwaXBlLCBlbnVtIHBsYW5lX2lk
IHBsYW5lX2lkKQo+ID4gICB7Cj4gPiAtCWlmICghSEFTX0ZCQyhkZXZfcHJpdikpCj4gPiArCWlm
ICghSEFTX0ZCQyhpOTE1KSkKPiA+ICAgCQlyZXR1cm4gZmFsc2U7Cj4gPiAgIAlyZXR1cm4gcGlw
ZSA9PSBQSVBFX0EgJiYgcGxhbmVfaWQgPT0gUExBTkVfUFJJTUFSWTsKPiA+ICAgfQo+ID4gLXN0
YXRpYyBib29sIHNrbF9wbGFuZV9oYXNfcGxhbmFyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPiA+ICtzdGF0aWMgYm9vbCBza2xfcGxhbmVfaGFzX3BsYW5hcihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSBlbnVtIHBpcGUgcGlwZSwgZW51bSBwbGFu
ZV9pZCBwbGFuZV9pZCkKPiA+ICAgewo+ID4gLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAx
MSkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkKPiA+ICAgCQlyZXR1cm4gcGxhbmVf
aWQgPD0gUExBTkVfU1BSSVRFMzsKPiA+ICAgCS8qIERpc3BsYXkgV0EgIzA4NzA6IHNrbCwgYnh0
ICovCj4gPiAtCWlmIChJU19TS1lMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2
KSkKPiA+ICsJaWYgKElTX1NLWUxBS0UoaTkxNSkgfHwgSVNfQlJPWFRPTihpOTE1KSkKPiA+ICAg
CQlyZXR1cm4gZmFsc2U7Cj4gPiAtCWlmIChJU19HRU4oZGV2X3ByaXYsIDkpICYmICFJU19HRU1J
TklMQUtFKGRldl9wcml2KSAmJiBwaXBlID09IFBJUEVfQykKPiA+ICsJaWYgKElTX0dFTihpOTE1
LCA5KSAmJiAhSVNfR0VNSU5JTEFLRShpOTE1KSAmJiBwaXBlID09IFBJUEVfQykKPiA+ICAgCQly
ZXR1cm4gZmFsc2U7Cj4gPiAgIAlpZiAocGxhbmVfaWQgIT0gUExBTkVfUFJJTUFSWSAmJiBwbGFu
ZV9pZCAhPSBQTEFORV9TUFJJVEUwKQo+ID4gQEAgLTIyMjUsMTYgKzIyMjUsMTYgQEAgc3RhdGlj
IGJvb2wgc2tsX3BsYW5lX2hhc19wbGFuYXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gICAJcmV0dXJuIHRydWU7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBza2xfcGxh
bmVfaGFzX2NjcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGlj
IGJvb2wgc2tsX3BsYW5lX2hhc19jY3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgIAkJCSAgICAgIGVudW0gcGlwZSBwaXBlLCBlbnVtIHBsYW5lX2lkIHBsYW5lX2lkKQo+ID4g
ICB7Cj4gPiAgIAlpZiAocGxhbmVfaWQgPT0gUExBTkVfQ1VSU09SKQo+ID4gICAJCXJldHVybiBm
YWxzZTsKPiA+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApCj4gPiArCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gMTApCj4gPiAgIAkJcmV0dXJuIHRydWU7Cj4gPiAtCWlmIChJU19HRU1J
TklMQUtFKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpCj4gPiAgIAkJ
cmV0dXJuIHBpcGUgIT0gUElQRV9DOwo+ID4gICAJcmV0dXJuIHBpcGUgIT0gUElQRV9DICYmCj4g
PiBAQCAtMjI0Myw3ICsyMjQzLDcgQEAgc3RhdGljIGJvb2wgc2tsX3BsYW5lX2hhc19jY3Moc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICB9Cj4gPiAgIHN0cnVjdCBpbnRl
bF9wbGFuZSAqCj4gPiAtc2tsX3VuaXZlcnNhbF9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3NrbF91bml2ZXJzYWxfcGxhbmVfY3JlYXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICBlbnVtIHBpcGUgcGlwZSwgZW51
bSBwbGFuZV9pZCBwbGFuZV9pZCkKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVsX3BsYW5lICpw
bGFuZTsKPiA+IEBAIC0yMjYzLDkgKzIyNjMsOSBAQCBza2xfdW5pdmVyc2FsX3BsYW5lX2NyZWF0
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAlwbGFuZS0+aWQgPSBw
bGFuZV9pZDsKPiA+ICAgCXBsYW5lLT5mcm9udGJ1ZmZlcl9iaXQgPSBJTlRFTF9GUk9OVEJVRkZF
UihwaXBlLCBwbGFuZV9pZCk7Cj4gPiAtCXBsYW5lLT5oYXNfZmJjID0gc2tsX3BsYW5lX2hhc19m
YmMoZGV2X3ByaXYsIHBpcGUsIHBsYW5lX2lkKTsKPiA+ICsJcGxhbmUtPmhhc19mYmMgPSBza2xf
cGxhbmVfaGFzX2ZiYyhpOTE1LCBwaXBlLCBwbGFuZV9pZCk7Cj4gPiAgIAlpZiAocGxhbmUtPmhh
c19mYmMpIHsKPiA+IC0JCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJpdi0+ZmJjOwo+
ID4gKwkJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmk5MTUtPmZiYzsKPiA+ICAgCQlmYmMtPnBv
c3NpYmxlX2ZyYW1lYnVmZmVyX2JpdHMgfD0gcGxhbmUtPmZyb250YnVmZmVyX2JpdDsKPiA+ICAg
CX0KPiA+IEBAIC0yMjc4LDI0ICsyMjc4LDI0IEBAIHNrbF91bml2ZXJzYWxfcGxhbmVfY3JlYXRl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWlmIChpY2xfaXNfbnYx
Ml95X3BsYW5lKHBsYW5lX2lkKSkKPiA+ICAgCQlwbGFuZS0+dXBkYXRlX3NsYXZlID0gaWNsX3Vw
ZGF0ZV9zbGF2ZTsKPiA+IC0JaWYgKHNrbF9wbGFuZV9oYXNfcGxhbmFyKGRldl9wcml2LCBwaXBl
LCBwbGFuZV9pZCkpIHsKPiA+IC0JCWlmIChpY2xfaXNfaGRyX3BsYW5lKGRldl9wcml2LCBwbGFu
ZV9pZCkpIHsKPiA+ICsJaWYgKHNrbF9wbGFuZV9oYXNfcGxhbmFyKGk5MTUsIHBpcGUsIHBsYW5l
X2lkKSkgewo+ID4gKwkJaWYgKGljbF9pc19oZHJfcGxhbmUoaTkxNSwgcGxhbmVfaWQpKSB7Cj4g
PiAgIAkJCWZvcm1hdHMgPSBpY2xfaGRyX3BsYW5hcl9mb3JtYXRzOwo+ID4gICAJCQludW1fZm9y
bWF0cyA9IEFSUkFZX1NJWkUoaWNsX2hkcl9wbGFuYXJfZm9ybWF0cyk7Cj4gPiAtCQl9IGVsc2Ug
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKPiA+ICsJCX0gZWxzZSBpZiAoSU5URUxf
R0VOKGk5MTUpID49IDExKSB7Cj4gPiAgIAkJCWZvcm1hdHMgPSBpY2xfcGxhbmFyX2Zvcm1hdHM7
Cj4gPiAgIAkJCW51bV9mb3JtYXRzID0gQVJSQVlfU0laRShpY2xfcGxhbmFyX2Zvcm1hdHMpOwo+
ID4gLQkJfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID09IDEwIHx8IElTX0dFTUlOSUxB
S0UoZGV2X3ByaXYpKSB7Cj4gPiArCQl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA9PSAxMCB8
fCBJU19HRU1JTklMQUtFKGk5MTUpKSB7Cj4gPiAgIAkJCWZvcm1hdHMgPSBnbGtfcGxhbmFyX2Zv
cm1hdHM7Cj4gPiAgIAkJCW51bV9mb3JtYXRzID0gQVJSQVlfU0laRShnbGtfcGxhbmFyX2Zvcm1h
dHMpOwo+ID4gICAJCX0gZWxzZSB7Cj4gPiAgIAkJCWZvcm1hdHMgPSBza2xfcGxhbmFyX2Zvcm1h
dHM7Cj4gPiAgIAkJCW51bV9mb3JtYXRzID0gQVJSQVlfU0laRShza2xfcGxhbmFyX2Zvcm1hdHMp
Owo+ID4gICAJCX0KPiA+IC0JfSBlbHNlIGlmIChpY2xfaXNfaGRyX3BsYW5lKGRldl9wcml2LCBw
bGFuZV9pZCkpIHsKPiA+ICsJfSBlbHNlIGlmIChpY2xfaXNfaGRyX3BsYW5lKGk5MTUsIHBsYW5l
X2lkKSkgewo+ID4gICAJCWZvcm1hdHMgPSBpY2xfaGRyX3BsYW5lX2Zvcm1hdHM7Cj4gPiAgIAkJ
bnVtX2Zvcm1hdHMgPSBBUlJBWV9TSVpFKGljbF9oZHJfcGxhbmVfZm9ybWF0cyk7Cj4gPiAtCX0g
ZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+ID4gKwl9IGVsc2UgaWYgKElO
VEVMX0dFTihpOTE1KSA+PSAxMSkgewo+ID4gICAJCWZvcm1hdHMgPSBpY2xfcGxhbmVfZm9ybWF0
czsKPiA+ICAgCQludW1fZm9ybWF0cyA9IEFSUkFZX1NJWkUoaWNsX3BsYW5lX2Zvcm1hdHMpOwo+
ID4gICAJfSBlbHNlIHsKPiA+IEBAIC0yMzAzLDcgKzIzMDMsNyBAQCBza2xfdW5pdmVyc2FsX3Bs
YW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJbnVt
X2Zvcm1hdHMgPSBBUlJBWV9TSVpFKHNrbF9wbGFuZV9mb3JtYXRzKTsKPiA+ICAgCX0KPiA+IC0J
cGxhbmUtPmhhc19jY3MgPSBza2xfcGxhbmVfaGFzX2NjcyhkZXZfcHJpdiwgcGlwZSwgcGxhbmVf
aWQpOwo+ID4gKwlwbGFuZS0+aGFzX2NjcyA9IHNrbF9wbGFuZV9oYXNfY2NzKGk5MTUsIHBpcGUs
IHBsYW5lX2lkKTsKPiA+ICAgCWlmIChwbGFuZS0+aGFzX2NjcykKPiA+ICAgCQltb2RpZmllcnMg
PSBza2xfcGxhbmVfZm9ybWF0X21vZGlmaWVyc19jY3M7Cj4gPiAgIAllbHNlCj4gPiBAQCAtMjMx
Niw3ICsyMzE2LDcgQEAgc2tsX3VuaXZlcnNhbF9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJcG9zc2libGVfY3J0Y3MgPSBCSVQocGlwZSk7Cj4g
PiAtCXJldCA9IGRybV91bml2ZXJzYWxfcGxhbmVfaW5pdCgmZGV2X3ByaXYtPmRybSwgJnBsYW5l
LT5iYXNlLAo+ID4gKwlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2luaXQoJmk5MTUtPmRybSwg
JnBsYW5lLT5iYXNlLAo+ID4gICAJCQkJICAgICAgIHBvc3NpYmxlX2NydGNzLCAmc2tsX3BsYW5l
X2Z1bmNzLAo+ID4gICAJCQkJICAgICAgIGZvcm1hdHMsIG51bV9mb3JtYXRzLCBtb2RpZmllcnMs
Cj4gPiAgIAkJCQkgICAgICAgcGxhbmVfdHlwZSwKPiA+IEBAIC0yMzI5LDcgKzIzMjksNyBAQCBz
a2xfdW5pdmVyc2FsX3BsYW5lX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCj4gPiAgIAkJRFJNX01PREVfUk9UQVRFXzAgfCBEUk1fTU9ERV9ST1RBVEVfOTAgfAo+ID4g
ICAJCURSTV9NT0RFX1JPVEFURV8xODAgfCBEUk1fTU9ERV9ST1RBVEVfMjcwOwo+ID4gLQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCkKPiA+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAx
MCkKPiA+ICAgCQlzdXBwb3J0ZWRfcm90YXRpb25zIHw9IERSTV9NT0RFX1JFRkxFQ1RfWDsKPiA+
ICAgCWRybV9wbGFuZV9jcmVhdGVfcm90YXRpb25fcHJvcGVydHkoJnBsYW5lLT5iYXNlLAo+ID4g
QEAgLTIzNjEsNyArMjM2MSw3IEBAIHNrbF91bml2ZXJzYWxfcGxhbmVfY3JlYXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgfQo+ID4gICBzdHJ1Y3QgaW50ZWxfcGxh
bmUgKgo+ID4gLWludGVsX3Nwcml0ZV9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+ID4gK2ludGVsX3Nwcml0ZV9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJCSAgZW51bSBwaXBlIHBpcGUsIGludCBzcHJpdGUp
Cj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmU7Cj4gPiBAQCAtMjM3Mywx
NSArMjM3MywxNSBAQCBpbnRlbF9zcHJpdGVfcGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWludCBudW1fZm9ybWF0czsKPiA+ICAgCWludCByZXQ7
Cj4gPiAtCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCj4gPiAtCQlyZXR1cm4gc2tsX3Vu
aXZlcnNhbF9wbGFuZV9jcmVhdGUoZGV2X3ByaXYsIHBpcGUsCj4gPiArCWlmIChJTlRFTF9HRU4o
aTkxNSkgPj0gOSkKPiA+ICsJCXJldHVybiBza2xfdW5pdmVyc2FsX3BsYW5lX2NyZWF0ZShpOTE1
LCBwaXBlLAo+ID4gICAJCQkJCQkgIFBMQU5FX1NQUklURTAgKyBzcHJpdGUpOwo+ID4gICAJcGxh
bmUgPSBpbnRlbF9wbGFuZV9hbGxvYygpOwo+ID4gICAJaWYgKElTX0VSUihwbGFuZSkpCj4gPiAg
IAkJcmV0dXJuIHBsYW5lOwo+ID4gLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNf
Q0hFUlJZVklFVyhkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwg
SVNfQ0hFUlJZVklFVyhpOTE1KSkgewo+ID4gICAJCXBsYW5lLT5tYXhfc3RyaWRlID0gaTl4eF9w
bGFuZV9tYXhfc3RyaWRlOwo+ID4gICAJCXBsYW5lLT51cGRhdGVfcGxhbmUgPSB2bHZfdXBkYXRl
X3BsYW5lOwo+ID4gICAJCXBsYW5lLT5kaXNhYmxlX3BsYW5lID0gdmx2X2Rpc2FibGVfcGxhbmU7
Cj4gPiBAQCAtMjM5Myw3ICsyMzkzLDcgQEAgaW50ZWxfc3ByaXRlX3BsYW5lX2NyZWF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiAgIAkJbW9kaWZpZXJzID0gaTl4eF9w
bGFuZV9mb3JtYXRfbW9kaWZpZXJzOwo+ID4gICAJCXBsYW5lX2Z1bmNzID0gJnZsdl9zcHJpdGVf
ZnVuY3M7Cj4gPiAtCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA3KSB7Cj4gPiAr
CX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDcpIHsKPiA+ICAgCQlwbGFuZS0+bWF4X3N0
cmlkZSA9IGc0eF9zcHJpdGVfbWF4X3N0cmlkZTsKPiA+ICAgCQlwbGFuZS0+dXBkYXRlX3BsYW5l
ID0gaXZiX3VwZGF0ZV9wbGFuZTsKPiA+ICAgCQlwbGFuZS0+ZGlzYWJsZV9wbGFuZSA9IGl2Yl9k
aXNhYmxlX3BsYW5lOwo+ID4gQEAgLTI0MTMsNyArMjQxMyw3IEBAIGludGVsX3Nwcml0ZV9wbGFu
ZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCXBsYW5l
LT5jaGVja19wbGFuZSA9IGc0eF9zcHJpdGVfY2hlY2s7Cj4gPiAgIAkJbW9kaWZpZXJzID0gaTl4
eF9wbGFuZV9mb3JtYXRfbW9kaWZpZXJzOwo+ID4gLQkJaWYgKElTX0dFTihkZXZfcHJpdiwgNikp
IHsKPiA+ICsJCWlmIChJU19HRU4oaTkxNSwgNikpIHsKPiA+ICAgCQkJZm9ybWF0cyA9IHNuYl9w
bGFuZV9mb3JtYXRzOwo+ID4gICAJCQludW1fZm9ybWF0cyA9IEFSUkFZX1NJWkUoc25iX3BsYW5l
X2Zvcm1hdHMpOwo+ID4gQEAgLTI0MjYsNyArMjQyNiw3IEBAIGludGVsX3Nwcml0ZV9wbGFuZV9j
cmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJCX0KPiA+ICAg
CX0KPiA+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpICYmIHBpcGUgPT0gUElQRV9CKSB7
Cj4gPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpICYmIHBpcGUgPT0gUElQRV9CKSB7Cj4gPiAg
IAkJc3VwcG9ydGVkX3JvdGF0aW9ucyA9Cj4gPiAgIAkJCURSTV9NT0RFX1JPVEFURV8wIHwgRFJN
X01PREVfUk9UQVRFXzE4MCB8Cj4gPiAgIAkJCURSTV9NT0RFX1JFRkxFQ1RfWDsKPiA+IEBAIC0y
NDQxLDcgKzI0NDEsNyBAQCBpbnRlbF9zcHJpdGVfcGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCXBvc3NpYmxlX2NydGNzID0gQklUKHBpcGUpOwo+
ID4gLQlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2luaXQoJmRldl9wcml2LT5kcm0sICZwbGFu
ZS0+YmFzZSwKPiA+ICsJcmV0ID0gZHJtX3VuaXZlcnNhbF9wbGFuZV9pbml0KCZpOTE1LT5kcm0s
ICZwbGFuZS0+YmFzZSwKPiA+ICAgCQkJCSAgICAgICBwb3NzaWJsZV9jcnRjcywgcGxhbmVfZnVu
Y3MsCj4gPiAgIAkJCQkgICAgICAgZm9ybWF0cywgbnVtX2Zvcm1hdHMsIG1vZGlmaWVycywKPiA+
ICAgCQkJCSAgICAgICBEUk1fUExBTkVfVFlQRV9PVkVSTEFZLAo+ID4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Nwcml0ZS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfc3ByaXRlLmgKPiA+IGluZGV4IDUwMGY2YmZmYjEzOS4uNDAxMjk1ZTA1MTE2IDEwMDY0
NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfc3ByaXRlLmgKPiA+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Nwcml0ZS5oCj4gPiBAQCAtMjEsNyArMjEsNyBA
QCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGU7Cj4gPiAgIGJvb2wgaXNfcGxhbmFyX3l1dl9mb3Jt
YXQodTMyIHBpeGVsZm9ybWF0KTsKPiA+ICAgaW50IGludGVsX3VzZWNzX3RvX3NjYW5saW5lcyhj
b25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSwKPiA+ICAgCQkJICAg
ICBpbnQgdXNlY3MpOwo+ID4gLXN0cnVjdCBpbnRlbF9wbGFuZSAqaW50ZWxfc3ByaXRlX3BsYW5l
X2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RydWN0IGlu
dGVsX3BsYW5lICppbnRlbF9zcHJpdGVfcGxhbmVfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAo+ID4gICAJCQkJCSAgICAgIGVudW0gcGlwZSBwaXBlLCBpbnQgcGxhbmUpOwo+
ID4gICBpbnQgaW50ZWxfc3ByaXRlX3NldF9jb2xvcmtleV9pb2N0bChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LCB2b2lkICpkYXRhLAo+ID4gICAJCQkJICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9w
cml2KTsKPiA+IEBAIC0zMSw3ICszMSw3IEBAIGludCBpbnRlbF9wbGFuZV9jaGVja19zdHJpZGUo
Y29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSk7Cj4gPiAgIGludCBp
bnRlbF9wbGFuZV9jaGVja19zcmNfY29vcmRpbmF0ZXMoc3RydWN0IGludGVsX3BsYW5lX3N0YXRl
ICpwbGFuZV9zdGF0ZSk7Cj4gPiAgIGludCBjaHZfcGxhbmVfY2hlY2tfcm90YXRpb24oY29uc3Qg
c3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSk7Cj4gPiAgIHN0cnVjdCBpbnRl
bF9wbGFuZSAqCj4gPiAtc2tsX3VuaXZlcnNhbF9wbGFuZV9jcmVhdGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3NrbF91bml2ZXJzYWxfcGxhbmVfY3JlYXRlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4gICAJCQkgICBlbnVtIHBpcGUgcGlwZSwgZW51
bSBwbGFuZV9pZCBwbGFuZV9pZCk7Cj4gPiAgIHN0YXRpYyBpbmxpbmUgYm9vbCBpY2xfaXNfbnYx
Ml95X3BsYW5lKGVudW0gcGxhbmVfaWQgaWQpCj4gPiBAQCAtNDksMTAgKzQ5LDEwIEBAIHN0YXRp
YyBpbmxpbmUgdTggaWNsX2hkcl9wbGFuZV9tYXNrKHZvaWQpCj4gPiAgIAkJQklUKFBMQU5FX1NQ
UklURTApIHwgQklUKFBMQU5FX1NQUklURTEpOwo+ID4gICB9Cj4gPiAtc3RhdGljIGlubGluZSBi
b29sIGljbF9pc19oZHJfcGxhbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3N0YXRpYyBpbmxpbmUgYm9vbCBpY2xfaXNfaGRyX3BsYW5lKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAo+ID4gICAJCQkJICAgIGVudW0gcGxhbmVfaWQgcGxhbmVfaWQpCj4gPiAg
IHsKPiA+IC0JcmV0dXJuIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEgJiYKPiA+ICsJcmV0dXJu
IElOVEVMX0dFTihpOTE1KSA+PSAxMSAmJgo+ID4gICAJCWljbF9oZHJfcGxhbmVfbWFzaygpICYg
QklUKHBsYW5lX2lkKTsKPiA+ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX3R2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF90di5jCj4gPiBpbmRl
eCA1ZGM1OTRlYWZhZjIuLjRlNjYyNjFiZjVhZiAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX3R2LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X3R2LmMKPiA+IEBAIC05MDYsNyArOTA2LDcgQEAgc3RhdGljIHN0cnVjdCBpbnRlbF90diAqaW50
ZWxfYXR0YWNoZWRfdHYoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgc3Rh
dGljIGJvb2wKPiA+ICAgaW50ZWxfdHZfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLCBlbnVtIHBpcGUgKnBpcGUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4gPiAgIAl1MzIgdG1wID0gSTkxNV9SRUFEKFRWX0NUTCk7Cj4gPiAgIAkqcGlwZSA9ICh0bXAg
JiBUVl9FTkNfUElQRV9TRUxfTUFTSykgPj4gVFZfRU5DX1BJUEVfU0VMX1NISUZUOwo+ID4gQEAg
LTkyMCwxMCArOTIwLDEwIEBAIGludGVsX2VuYWJsZV90dihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKPiA+ICAgCQljb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9z
dGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJh
c2UuZGV2Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYp
Owo+ID4gICAJLyogUHJldmVudHMgdmJsYW5rIHdhaXRzIGZyb20gdGltaW5nIG91dCBpbiBpbnRl
bF90dl9kZXRlY3RfdHlwZSgpICovCj4gPiAtCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJp
diwKPiA+ICsJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsCj4gPiAgIAkJCSAgICAgIHRvX2lu
dGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0YyktPnBpcGUpOwo+ID4gICAJSTkxNV9XUklU
RShUVl9DVEwsIEk5MTVfUkVBRChUVl9DVEwpIHwgVFZfRU5DX0VOQUJMRSk7Cj4gPiBAQCAtOTM1
LDcgKzkzNSw3IEBAIGludGVsX2Rpc2FibGVfdHYoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gPiAgIAkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9z
dGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJh
c2UuZGV2Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYp
Owo+ID4gICAJSTkxNV9XUklURShUVl9DVEwsIEk5MTVfUkVBRChUVl9DVEwpICYgflRWX0VOQ19F
TkFCTEUpOwo+ID4gICB9Cj4gPiBAQCAtMTA4NCw3ICsxMDg0LDcgQEAgc3RhdGljIHZvaWQKPiA+
ICAgaW50ZWxfdHZfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+
ICAgCQkgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ID4gICB7Cj4g
PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVz
dGVkX21vZGUgPQo+ID4gICAJCSZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ID4g
ICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgbW9kZSA9IHt9Owo+ID4gQEAgLTExNTgsMTUgKzEx
NTgsMTUgQEAgaW50ZWxfdHZfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiA+ICAgCQlhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrIC89IDI7Cj4gPiAgIAkvKiBwaXhl
bCBjb3VudGVyIGRvZXNuJ3Qgd29yayBvbiBpOTY1Z20gVFYgb3V0cHV0ICovCj4gPiAtCWlmIChJ
U19JOTY1R00oZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfSTk2NUdNKGk5MTUpKQo+ID4gICAJCWFk
anVzdGVkX21vZGUtPnByaXZhdGVfZmxhZ3MgfD0KPiA+ICAgCQkJSTkxNV9NT0RFX0ZMQUdfVVNF
X1NDQU5MSU5FX0NPVU5URVI7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgYm9vbCBpbnRlbF90dl9zb3Vy
Y2VfdG9vX3dpZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3N0YXRp
YyBib29sIGludGVsX3R2X3NvdXJjZV90b29fd2lkZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKPiA+ICAgCQkJCSAgICAgaW50IGhkaXNwbGF5KQo+ID4gICB7Cj4gPiAtCXJldHVybiBJ
U19HRU4oZGV2X3ByaXYsIDMpICYmIGhkaXNwbGF5ID4gMTAyNDsKPiA+ICsJcmV0dXJuIElTX0dF
TihpOTE1LCAzKSAmJiBoZGlzcGxheSA+IDEwMjQ7Cj4gPiAgIH0KPiA+ICAgc3RhdGljIGJvb2wg
aW50ZWxfdHZfdmVydF9zY2FsaW5nKGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICp0dl9t
b2RlLAo+ID4gQEAgLTExODQsNyArMTE4NCw3IEBAIGludGVsX3R2X2NvbXB1dGVfY29uZmlnKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqcGlwZV9jb25maWcsCj4gPiAgIAkJCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpj
b25uX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGlu
dGVsX3R2X2Nvbm5lY3Rvcl9zdGF0ZSAqdHZfY29ubl9zdGF0ZSA9Cj4gPiAgIAkJdG9faW50ZWxf
dHZfY29ubmVjdG9yX3N0YXRlKGNvbm5fc3RhdGUpOwo+ID4gICAJY29uc3Qgc3RydWN0IHR2X21v
ZGUgKnR2X21vZGUgPSBpbnRlbF90dl9tb2RlX2ZpbmQoY29ubl9zdGF0ZSk7Cj4gPiBAQCAtMTIw
OSw3ICsxMjA5LDcgQEAgaW50ZWxfdHZfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4gPiAgIAlpbnRlbF90dl9tb2RlX3RvX21vZGUoYWRqdXN0ZWRfbW9kZSwg
dHZfbW9kZSk7Cj4gPiAgIAlkcm1fbW9kZV9zZXRfY3J0Y2luZm8oYWRqdXN0ZWRfbW9kZSwgMCk7
Cj4gPiAtCWlmIChpbnRlbF90dl9zb3VyY2VfdG9vX3dpZGUoZGV2X3ByaXYsIGhkaXNwbGF5KSB8
fAo+ID4gKwlpZiAoaW50ZWxfdHZfc291cmNlX3Rvb193aWRlKGk5MTUsIGhkaXNwbGF5KSB8fAo+
ID4gICAJICAgICFpbnRlbF90dl92ZXJ0X3NjYWxpbmcoYWRqdXN0ZWRfbW9kZSwgY29ubl9zdGF0
ZSwgdmRpc3BsYXkpKSB7Cj4gPiAgIAkJaW50IGV4dHJhLCB0b3AsIGJvdHRvbTsKPiA+IEBAIC0x
MzA2LDcgKzEzMDYsNyBAQCBpbnRlbF90dl9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiA+ICAgCSAqIHRoZSBhY3RpdmUgcG9ydGlvbi4gSGVuY2UgZm9sbG93
aW5nIHRoaXMgZm9ybXVsYSBzZWVtcwo+ID4gICAJICogbW9yZSB0cm91YmxlIHRoYXQgaXQncyB3
b3J0aC4KPiA+ICAgCSAqCj4gPiAtCSAqIGlmIChJU19HRU4oZGV2X3ByaXYsIDQpKSB7Cj4gPiAr
CSAqIGlmIChJU19HRU4oaTkxNSwgNCkpIHsKPiA+ICAgCSAqCW51bSA9IGNkY2xrICogKHR2X21v
ZGUtPm92ZXJzYW1wbGUgPj4gIXR2X21vZGUtPnByb2dyZXNzaXZlKTsKPiA+ICAgCSAqCWRlbiA9
IHR2X21vZGUtPmNsb2NrOwo+ID4gICAJICogfSBlbHNlIHsKPiA+IEBAIC0xMzI3LDcgKzEzMjcs
NyBAQCBpbnRlbF90dl9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPiA+ICAgCWFkanVzdGVkX21vZGUtPm5hbWVbMF0gPSAnXDAnOwo+ID4gICAJLyogcGl4ZWwg
Y291bnRlciBkb2Vzbid0IHdvcmsgb24gaTk2NWdtIFRWIG91dHB1dCAqLwo+ID4gLQlpZiAoSVNf
STk2NUdNKGRldl9wcml2KSkKPiA+ICsJaWYgKElTX0k5NjVHTShpOTE1KSkKPiA+ICAgCQlhZGp1
c3RlZF9tb2RlLT5wcml2YXRlX2ZsYWdzIHw9Cj4gPiAgIAkJCUk5MTVfTU9ERV9GTEFHX1VTRV9T
Q0FOTElORV9DT1VOVEVSOwo+ID4gQEAgLTEzMzUsNyArMTMzNSw3IEBAIGludGVsX3R2X2NvbXB1
dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICB9Cj4gPiAgIHN0
YXRpYyB2b2lkCj4gPiAtc2V0X3R2X21vZGVfdGltaW5ncyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4gPiArc2V0X3R2X21vZGVfdGltaW5ncyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiA+ICAgCQkgICAgY29uc3Qgc3RydWN0IHR2X21vZGUgKnR2X21vZGUsCj4g
PiAgIAkJICAgIGJvb2wgYnVyc3RfZW5hKQo+ID4gICB7Cj4gPiBAQCAtMTM5Myw3ICsxMzkzLDcg
QEAgc2V0X3R2X21vZGVfdGltaW5ncyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiAgIAlJOTE1X1dSSVRFKFRWX1ZfQ1RMXzcsIHZjdGw3KTsKPiA+ICAgfQo+ID4gLXN0YXRp
YyB2b2lkIHNldF9jb2xvcl9jb252ZXJzaW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICtzdGF0aWMgdm9pZCBzZXRfY29sb3JfY29udmVyc2lvbihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSBjb25zdCBzdHJ1Y3QgY29sb3JfY29udmVyc2lv
biAqY29sb3JfY29udmVyc2lvbikKPiA+ICAgewo+ID4gICAJaWYgKCFjb2xvcl9jb252ZXJzaW9u
KQo+ID4gQEAgLTE0MTcsNyArMTQxNyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3R2X3ByZV9lbmFi
bGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQljb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4gPiAgIAkJCQljb25zdCBzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0Yyhw
aXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPiA+ICAgCXN0cnVjdCBpbnRlbF90diAqaW50ZWxfdHYg
PSBlbmNfdG9fdHYoZW5jb2Rlcik7Cj4gPiAgIAljb25zdCBzdHJ1Y3QgaW50ZWxfdHZfY29ubmVj
dG9yX3N0YXRlICp0dl9jb25uX3N0YXRlID0KPiA+IEBAIC0xNTA3LDE4ICsxNTA3LDE4IEBAIHN0
YXRpYyB2b2lkIGludGVsX3R2X3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4gPiAgIAkJdHZfbW9kZS0+ZGRhM19pbmMgPDwgVFZfU0NEREEzX0lOQ19TSElGVDsKPiA+
ICAgCS8qIEVuYWJsZSB0d28gZml4ZXMgZm9yIHRoZSBjaGlwcyB0aGF0IG5lZWQgdGhlbS4gKi8K
PiA+IC0JaWYgKElTX0k5MTVHTShkZXZfcHJpdikpCj4gPiArCWlmIChJU19JOTE1R00oaTkxNSkp
Cj4gPiAgIAkJdHZfY3RsIHw9IFRWX0VOQ19DMF9GSVggfCBUVl9FTkNfU0RQX0ZJWDsKPiA+IC0J
c2V0X3R2X21vZGVfdGltaW5ncyhkZXZfcHJpdiwgdHZfbW9kZSwgYnVyc3RfZW5hKTsKPiA+ICsJ
c2V0X3R2X21vZGVfdGltaW5ncyhpOTE1LCB0dl9tb2RlLCBidXJzdF9lbmEpOwo+ID4gICAJSTkx
NV9XUklURShUVl9TQ19DVExfMSwgc2NjdGwxKTsKPiA+ICAgCUk5MTVfV1JJVEUoVFZfU0NfQ1RM
XzIsIHNjY3RsMik7Cj4gPiAgIAlJOTE1X1dSSVRFKFRWX1NDX0NUTF8zLCBzY2N0bDMpOwo+ID4g
LQlzZXRfY29sb3JfY29udmVyc2lvbihkZXZfcHJpdiwgY29sb3JfY29udmVyc2lvbik7Cj4gPiAr
CXNldF9jb2xvcl9jb252ZXJzaW9uKGk5MTUsIGNvbG9yX2NvbnZlcnNpb24pOwo+ID4gLQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSA0KQo+ID4gKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDQp
Cj4gPiAgIAkJSTkxNV9XUklURShUVl9DTFJfS05PQlMsIDB4MDA0MDQwMDApOwo+ID4gICAJZWxz
ZQo+ID4gICAJCUk5MTVfV1JJVEUoVFZfQ0xSX0tOT0JTLCAweDAwNjA2MDAwKTsKPiA+IEBAIC0x
NTI4LDcgKzE1MjgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF90dl9wcmVfZW5hYmxlKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkgICAoKHZpZGVvX2xldmVscy0+YmxhY2sg
PDwgVFZfQkxBQ0tfTEVWRUxfU0hJRlQpIHwKPiA+ICAgCQkJICAgICh2aWRlb19sZXZlbHMtPmJs
YW5rIDw8IFRWX0JMQU5LX0xFVkVMX1NISUZUKSkpOwo+ID4gLQlhc3NlcnRfcGlwZV9kaXNhYmxl
ZChkZXZfcHJpdiwgaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gPiArCWFzc2VydF9waXBlX2Rpc2FibGVk
KGk5MTUsIGludGVsX2NydGMtPnBpcGUpOwo+ID4gICAJLyogRmlsdGVyIGN0bCBtdXN0IGJlIHNl
dCBiZWZvcmUgVFZfV0lOX1NJWkUgKi8KPiA+ICAgCXR2X2ZpbHRlcl9jdGwgPSBUVl9BVVRPX1ND
QUxFOwo+ID4gQEAgLTE1NjgsMTggKzE1NjgsMTggQEAgaW50ZWxfdHZfZGV0ZWN0X3R5cGUoc3Ry
dWN0IGludGVsX3R2ICppbnRlbF90diwKPiA+ICAgCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IGNv
bm5lY3Rvci0+c3RhdGUtPmNydGM7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0g
Y29ubmVjdG9yLT5kZXY7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRldik7Cj4gPiAgIAl1MzIgdHZfY3RsLCBzYXZlX3R2X2N0bDsKPiA+ICAgCXUzMiB0dl9k
YWMsIHNhdmVfdHZfZGFjOwo+ID4gICAJaW50IHR5cGU7Cj4gPiAgIAkvKiBEaXNhYmxlIFRWIGlu
dGVycnVwdHMgYXJvdW5kIGxvYWQgZGV0ZWN0IG9yIHdlJ2xsIHJlY3Vyc2UgKi8KPiA+ICAgCWlm
IChjb25uZWN0b3ItPnBvbGxlZCAmIERSTV9DT05ORUNUT1JfUE9MTF9IUEQpIHsKPiA+IC0JCXNw
aW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAtCQlpOTE1X2Rpc2FibGVfcGlw
ZXN0YXQoZGV2X3ByaXYsIDAsCj4gPiArCQlzcGluX2xvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7
Cj4gPiArCQlpOTE1X2Rpc2FibGVfcGlwZXN0YXQoaTkxNSwgMCwKPiA+ICAgCQkJCSAgICAgIFBJ
UEVfSE9UUExVR19JTlRFUlJVUFRfU1RBVFVTIHwKPiA+ICAgCQkJCSAgICAgIFBJUEVfSE9UUExV
R19UVl9JTlRFUlJVUFRfU1RBVFVTKTsKPiA+IC0JCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYt
PmlycV9sb2NrKTsKPiA+ICsJCXNwaW5fdW5sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwo+ID4g
ICAJfQo+ID4gICAJc2F2ZV90dl9kYWMgPSB0dl9kYWMgPSBJOTE1X1JFQUQoVFZfREFDKTsKPiA+
IEBAIC0xNjA1LDcgKzE2MDUsNyBAQCBpbnRlbF90dl9kZXRlY3RfdHlwZShzdHJ1Y3QgaW50ZWxf
dHYgKmludGVsX3R2LAo+ID4gICAJICogVGhlIFRWIHNlbnNlIHN0YXRlIHNob3VsZCBiZSBjbGVh
cmVkIHRvIHplcm8gb24gY2FudGlnYSBwbGF0Zm9ybS4gT3RoZXJ3aXNlCj4gPiAgIAkgKiB0aGUg
VFYgaXMgbWlzZGV0ZWN0ZWQuIFRoaXMgaXMgaGFyZHdhcmUgcmVxdWlyZW1lbnQuCj4gPiAgIAkg
Ki8KPiA+IC0JaWYgKElTX0dNNDUoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfR000NShpOTE1KSkK
PiA+ICAgCQl0dl9kYWMgJj0gfihUVkRBQ19TVEFURV9DSEdfRU4gfCBUVkRBQ19BX1NFTlNFX0NU
TCB8Cj4gPiAgIAkJCSAgICBUVkRBQ19CX1NFTlNFX0NUTCB8IFRWREFDX0NfU0VOU0VfQ1RMKTsK
PiA+IEBAIC0xNjEzLDcgKzE2MTMsNyBAQCBpbnRlbF90dl9kZXRlY3RfdHlwZShzdHJ1Y3QgaW50
ZWxfdHYgKmludGVsX3R2LAo+ID4gICAJSTkxNV9XUklURShUVl9EQUMsIHR2X2RhYyk7Cj4gPiAg
IAlQT1NUSU5HX1JFQUQoVFZfREFDKTsKPiA+IC0JaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGRldl9w
cml2LCBpbnRlbF9jcnRjLT5waXBlKTsKPiA+ICsJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUs
IGludGVsX2NydGMtPnBpcGUpOwo+ID4gICAJdHlwZSA9IC0xOwo+ID4gICAJdHZfZGFjID0gSTkx
NV9SRUFEKFRWX0RBQyk7Cj4gPiBAQCAtMTY0MywxNSArMTY0MywxNSBAQCBpbnRlbF90dl9kZXRl
Y3RfdHlwZShzdHJ1Y3QgaW50ZWxfdHYgKmludGVsX3R2LAo+ID4gICAJUE9TVElOR19SRUFEKFRW
X0NUTCk7Cj4gPiAgIAkvKiBGb3IgdW5rbm93biByZWFzb25zIHRoZSBodyBiYXJmcyBpZiB3ZSBk
b24ndCBkbyB0aGlzIHZibGFuayB3YWl0LiAqLwo+ID4gLQlpbnRlbF93YWl0X2Zvcl92Ymxhbmso
ZGV2X3ByaXYsIGludGVsX2NydGMtPnBpcGUpOwo+ID4gKwlpbnRlbF93YWl0X2Zvcl92Ymxhbmso
aTkxNSwgaW50ZWxfY3J0Yy0+cGlwZSk7Cj4gPiAgIAkvKiBSZXN0b3JlIGludGVycnVwdCBjb25m
aWcgKi8KPiA+ICAgCWlmIChjb25uZWN0b3ItPnBvbGxlZCAmIERSTV9DT05ORUNUT1JfUE9MTF9I
UEQpIHsKPiA+IC0JCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Cj4gPiAtCQlp
OTE1X2VuYWJsZV9waXBlc3RhdChkZXZfcHJpdiwgMCwKPiA+ICsJCXNwaW5fbG9ja19pcnEoJmk5
MTUtPmlycV9sb2NrKTsKPiA+ICsJCWk5MTVfZW5hYmxlX3BpcGVzdGF0KGk5MTUsIDAsCj4gPiAg
IAkJCQkgICAgIFBJUEVfSE9UUExVR19JTlRFUlJVUFRfU1RBVFVTIHwKPiA+ICAgCQkJCSAgICAg
UElQRV9IT1RQTFVHX1RWX0lOVEVSUlVQVF9TVEFUVVMpOwo+ID4gLQkJc3Bpbl91bmxvY2tfaXJx
KCZkZXZfcHJpdi0+aXJxX2xvY2spOwo+ID4gKwkJc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFf
bG9jayk7Cj4gPiAgIAl9Cj4gPiAgIAlyZXR1cm4gdHlwZTsKPiA+IEBAIC0xNzY0LDcgKzE3NjQs
NyBAQCBpbnRlbF90dl9zZXRfbW9kZV90eXBlKHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2Rl
LAo+ID4gICBzdGF0aWMgaW50Cj4gPiAgIGludGVsX3R2X2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5kZXYpOwo+ID4gICAJY29uc3Qg
c3RydWN0IHR2X21vZGUgKnR2X21vZGUgPSBpbnRlbF90dl9tb2RlX2ZpbmQoY29ubmVjdG9yLT5z
dGF0ZSk7Cj4gPiAgIAlpbnQgaSwgY291bnQgPSAwOwo+ID4gQEAgLTE3NzgsNyArMTc3OCw3IEBA
IGludGVsX3R2X2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4g
ICAJCQljb250aW51ZTsKPiA+ICAgCQkvKiBubyB2ZXJ0aWNhbCBzY2FsaW5nIHdpdGggd2lkZSBz
b3VyY2VzIG9uIGdlbjMgKi8KPiA+IC0JCWlmIChJU19HRU4oZGV2X3ByaXYsIDMpICYmIGlucHV0
LT53ID4gMTAyNCAmJgo+ID4gKwkJaWYgKElTX0dFTihpOTE1LCAzKSAmJiBpbnB1dC0+dyA+IDEw
MjQgJiYKPiA+ICAgCQkgICAgaW5wdXQtPmggPiBpbnRlbF90dl9tb2RlX3ZkaXNwbGF5KHR2X21v
ZGUpKQo+ID4gICAJCQljb250aW51ZTsKPiA+IEBAIC0xODU3LDkgKzE4NTcsOSBAQCBzdGF0aWMg
Y29uc3Qgc3RydWN0IGRybV9lbmNvZGVyX2Z1bmNzIGludGVsX3R2X2VuY19mdW5jcyA9IHsKPiA+
ICAgfTsKPiA+ICAgdm9pZAo+ID4gLWludGVsX3R2X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gK2ludGVsX3R2X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+
ZHJtOwo+ID4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmk5MTUtPmRybTsKPiA+ICAgCXN0
cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfdHYgKmlu
dGVsX3R2Owo+ID4gICAJc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXI7Cj4gPiBA
QCAtMTg3Miw3ICsxODcyLDcgQEAgaW50ZWxfdHZfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gPiAgIAlpZiAoKEk5MTVfUkVBRChUVl9DVEwpICYgVFZfRlVTRV9TVEFU
RV9NQVNLKSA9PSBUVl9GVVNFX1NUQVRFX0RJU0FCTEVEKQo+ID4gICAJCXJldHVybjsKPiA+IC0J
aWYgKCFpbnRlbF9iaW9zX2lzX3R2X3ByZXNlbnQoZGV2X3ByaXYpKSB7Cj4gPiArCWlmICghaW50
ZWxfYmlvc19pc190dl9wcmVzZW50KGk5MTUpKSB7Cj4gPiAgIAkJRFJNX0RFQlVHX0tNUygiSW50
ZWdyYXRlZCBUViBpcyBub3QgcHJlc2VudC5cbiIpOwo+ID4gICAJCXJldHVybjsKPiA+ICAgCX0K
PiA+IEBAIC0xOTY2LDcgKzE5NjYsNyBAQCBpbnRlbF90dl9pbml0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKPiA+ICAgCS8qIENyZWF0ZSBUViBwcm9wZXJ0aWVzIHRoZW4gYXR0
YWNoIGN1cnJlbnQgdmFsdWVzICovCj4gPiAgIAlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRSh0
dl9tb2Rlcyk7IGkrKykgewo+ID4gICAJCS8qIDEwODBwNTAvMTA4MHA2MCBub3Qgc3VwcG9ydGVk
IG9uIGdlbjMgKi8KPiA+IC0JCWlmIChJU19HRU4oZGV2X3ByaXYsIDMpICYmCj4gPiArCQlpZiAo
SVNfR0VOKGk5MTUsIDMpICYmCj4gPiAgIAkJICAgIHR2X21vZGVzW2ldLm92ZXJzYW1wbGUgPT0g
MSkKPiA+ICAgCQkJYnJlYWs7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfdHYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3R2LmgKPiA+IGluZGV4IDQ0
NTE4NTc1ZWM1Yy4uZmMwYjg5NTYzYjRmIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfdHYuaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdHYu
aAo+ID4gQEAgLTgsNiArOCw2IEBACj4gPiAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlOwo+ID4g
LXZvaWQgaW50ZWxfdHZfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+
ID4gK3ZvaWQgaW50ZWxfdHZfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4g
PiAgICNlbmRpZiAvKiBfX0lOVEVMX1RWX0hfXyAqLwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX3VjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91Yy5j
Cj4gPiBpbmRleCBhOGU3ZjBiYTdjM2IuLjExZTJkY2Y2YjkxNyAxMDA2NDQKPiA+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX3VjLmMKPiA+IEBAIC0zMywxMiArMzMsMTIgQEAgc3RhdGljIHZvaWQgZ3VjX2Zy
ZWVfbG9hZF9lcnJfbG9nKHN0cnVjdCBpbnRlbF9ndWMgKmd1Yyk7Cj4gPiAgIC8qIFJlc2V0IEd1
QyBwcm92aWRpbmcgdXMgd2l0aCBmcmVzaCBzdGF0ZSBmb3IgYm90aCBHdUMgYW5kIEh1Qy4KPiA+
ICAgICovCj4gPiAtc3RhdGljIGludCBfX2ludGVsX3VjX3Jlc2V0X2h3KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICtzdGF0aWMgaW50IF9faW50ZWxfdWNfcmVzZXRfaHco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+ICAgCWludCByZXQ7Cj4g
PiAgIAl1MzIgZ3VjX3N0YXR1czsKPiA+IC0JcmV0ID0gaW50ZWxfcmVzZXRfZ3VjKGRldl9wcml2
KTsKPiA+ICsJcmV0ID0gaW50ZWxfcmVzZXRfZ3VjKGk5MTUpOwo+ID4gICAJaWYgKHJldCkgewo+
ID4gICAJCURSTV9FUlJPUigiRmFpbGVkIHRvIHJlc2V0IEd1QywgcmV0ID0gJWRcbiIsIHJldCk7
Cj4gPiAgIAkJcmV0dXJuIHJldDsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF91Yy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWMuaAo+ID4gaW5kZXgg
M2VhMDZjODdkZmNkLi40ZGRkNTBkOTkwYjMgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF91Yy5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91
Yy5oCj4gPiBAQCAtMjgsMjAgKzI4LDIwIEBACj4gPiAgICNpbmNsdWRlICJpbnRlbF9odWMuaCIK
PiA+ICAgI2luY2x1ZGUgImk5MTVfcGFyYW1zLmgiCj4gPiAtdm9pZCBpbnRlbF91Y19pbml0X2Vh
cmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtdm9pZCBpbnRlbF91
Y19jbGVhbnVwX2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAt
dm9pZCBpbnRlbF91Y19pbml0X21taW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KTsKPiA+IC1pbnQgaW50ZWxfdWNfaW5pdF9taXNjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Cj4gPiAtdm9pZCBpbnRlbF91Y19maW5pX21pc2Moc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGludGVsX3VjX3Nhbml0aXplKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cj4gPiAtaW50IGludGVsX3VjX2luaXRfaHcoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC12b2lkIGludGVsX3VjX2ZpbmlfaHco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKPiA+IC1pbnQgaW50ZWxfdWNfaW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gLXZvaWQgaW50ZWxfdWNf
ZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3ZvaWQgaW50ZWxf
dWNfaW5pdF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiArdm9pZCBp
bnRlbF91Y19jbGVhbnVwX2Vhcmx5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+
ICt2b2lkIGludGVsX3VjX2luaXRfbW1pbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7
Cj4gPiAraW50IGludGVsX3VjX2luaXRfbWlzYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSk7Cj4gPiArdm9pZCBpbnRlbF91Y19maW5pX21pc2Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOwo+ID4gK3ZvaWQgaW50ZWxfdWNfc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwo+ID4gK2ludCBpbnRlbF91Y19pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX3VjX2ZpbmlfaHcoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwo+ID4gK2ludCBpbnRlbF91Y19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKPiA+ICt2b2lkIGludGVsX3VjX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwo+ID4gICB2b2lkIGludGVsX3VjX3Jlc2V0X3ByZXBhcmUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICB2b2lkIGludGVsX3VjX3N1c3BlbmQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICB2b2lkIGludGVsX3VjX3J1bnRpbWVfc3VzcGVu
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cj4gPiAtaW50IGludGVsX3VjX3Jlc3Vt
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK2ludCBpbnRlbF91Y19y
ZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwo+ID4gICBzdGF0aWMgaW5saW5l
IGJvb2wgaW50ZWxfdWNfaXNfdXNpbmdfZ3VjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ID4gICB7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWNf
ZncuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjX2Z3LmMKPiA+IGluZGV4IGYzNDJk
ZGQ0N2RmOC4uZDE1NjkxMWQxNTYwIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfdWNfZncuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWNf
ZncuYwo+ID4gQEAgLTMyLDE1ICszMiwxNSBAQAo+ID4gICAvKioKPiA+ICAgICogaW50ZWxfdWNf
ZndfZmV0Y2ggLSBmZXRjaCB1QyBmaXJtd2FyZQo+ID4gICAgKgo+ID4gLSAqIEBkZXZfcHJpdjog
ZGV2aWNlIHByaXZhdGUKPiA+ICsgKiBAaTkxNTogZGV2aWNlIHByaXZhdGUKPiA+ICAgICogQHVj
X2Z3OiB1QyBmaXJtd2FyZQo+ID4gICAgKgo+ID4gICAgKiBGZXRjaCB1QyBmaXJtd2FyZSBpbnRv
IEdFTSBvYmouCj4gPiAgICAqLwo+ID4gLXZvaWQgaW50ZWxfdWNfZndfZmV0Y2goc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gK3ZvaWQgaW50ZWxfdWNfZndfZmV0Y2goc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICAgIHN0cnVjdCBpbnRlbF91
Y19mdyAqdWNfZncpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBkZXZfcHJp
di0+ZHJtLnBkZXY7Cj4gPiArCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7
Cj4gPiAgIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwo+ID4gICAJY29uc3Qgc3Ry
dWN0IGZpcm13YXJlICpmdyA9IE5VTEw7Cj4gPiAgIAlzdHJ1Y3QgdWNfY3NzX2hlYWRlciAqY3Nz
Owo+ID4gQEAgLTQ4LDEwICs0OCwxMCBAQCB2b2lkIGludGVsX3VjX2Z3X2ZldGNoKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCWludCBlcnI7Cj4gPiAgIAlpZiAoIXVj
X2Z3LT5wYXRoKSB7Cj4gPiAtCQlkZXZfaW5mbyhkZXZfcHJpdi0+ZHJtLmRldiwKPiA+ICsJCWRl
dl9pbmZvKGk5MTUtPmRybS5kZXYsCj4gPiAgIAkJCSAiJXM6IE5vIGZpcm13YXJlIHdhcyBkZWZp
bmVkIGZvciAlcyFcbiIsCj4gPiAgIAkJCSBpbnRlbF91Y19md190eXBlX3JlcHIodWNfZnctPnR5
cGUpLAo+ID4gLQkJCSBpbnRlbF9wbGF0Zm9ybV9uYW1lKElOVEVMX0lORk8oZGV2X3ByaXYpLT5w
bGF0Zm9ybSkpOwo+ID4gKwkJCSBpbnRlbF9wbGF0Zm9ybV9uYW1lKElOVEVMX0lORk8oaTkxNSkt
PnBsYXRmb3JtKSk7Cj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJfQo+ID4gQEAgLTE1OSw3ICsxNTks
NyBAQCB2b2lkIGludGVsX3VjX2Z3X2ZldGNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICAgCQlnb3RvIGZhaWw7Cj4gPiAgIAl9Cj4gPiAtCW9iaiA9IGk5MTVfZ2VtX29i
amVjdF9jcmVhdGVfc2htZW1fZnJvbV9kYXRhKGRldl9wcml2LAo+ID4gKwlvYmogPSBpOTE1X2dl
bV9vYmplY3RfY3JlYXRlX3NobWVtX2Zyb21fZGF0YShpOTE1LAo+ID4gICAJCQkJCQkgICAgIGZ3
LT5kYXRhLCBmdy0+c2l6ZSk7Cj4gPiAgIAlpZiAoSVNfRVJSKG9iaikpIHsKPiA+ICAgCQllcnIg
PSBQVFJfRVJSKG9iaik7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfdWNfZncuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjX2Z3LmgKPiA+IGluZGV4
IGZmOThmODY2MWQ3Mi4uODgxYzNhZWYwNzRjIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfdWNfZncuaAo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfdWNfZncuaAo+ID4gQEAgLTE0Miw3ICsxNDIsNyBAQCBzdGF0aWMgaW5saW5lIHUzMiBpbnRl
bF91Y19md19nZXRfdXBsb2FkX3NpemUoc3RydWN0IGludGVsX3VjX2Z3ICp1Y19mdykKPiA+ICAg
CXJldHVybiB1Y19mdy0+aGVhZGVyX3NpemUgKyB1Y19mdy0+dWNvZGVfc2l6ZTsKPiA+ICAgfQo+
ID4gLXZvaWQgaW50ZWxfdWNfZndfZmV0Y2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ID4gK3ZvaWQgaW50ZWxfdWNfZndfZmV0Y2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCj4gPiAgIAkJICAgICAgIHN0cnVjdCBpbnRlbF91Y19mdyAqdWNfZncpOwo+ID4gICB2
b2lkIGludGVsX3VjX2Z3X2NsZWFudXBfZmV0Y2goc3RydWN0IGludGVsX3VjX2Z3ICp1Y19mdyk7
Cj4gPiAgIGludCBpbnRlbF91Y19md191cGxvYWQoc3RydWN0IGludGVsX3VjX2Z3ICp1Y19mdywK
PiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91bmNvcmUuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VuY29yZS5jCj4gPiBpbmRleCA4NTE3MWE4Yjg2NmEu
Ljg3ZGVjMDA1MTY1ZCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X3VuY29yZS5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91bmNvcmUuYwo+
ID4gQEAgLTUzNywxMCArNTM3LDEwIEBAIHZvaWQgaW50ZWxfdW5jb3JlX3J1bnRpbWVfcmVzdW1l
KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSkKPiA+ICAgCWlvc2ZfbWJpX3JlZ2lzdGVyX3Bt
aWNfYnVzX2FjY2Vzc19ub3RpZmllcigmdW5jb3JlLT5wbWljX2J1c19hY2Nlc3NfbmIpOwo+ID4g
ICB9Cj4gPiAtdm9pZCBpbnRlbF91bmNvcmVfc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgaW50ZWxfdW5jb3JlX3Nhbml0aXplKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQo+ID4gICB7Cj4gPiAgIAkvKiBCSU9TIG9mdGVuIGxlYXZlcyBS
QzYgZW5hYmxlZCwgYnV0IGRpc2FibGUgaXQgZm9yIGh3IGluaXQgKi8KPiA+IC0JaW50ZWxfc2Fu
aXRpemVfZ3RfcG93ZXJzYXZlKGRldl9wcml2KTsKPiA+ICsJaW50ZWxfc2FuaXRpemVfZ3RfcG93
ZXJzYXZlKGk5MTUpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyB2b2lkIF9faW50ZWxfdW5jb3JlX2Zv
cmNld2FrZV9nZXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAo+ID4gQEAgLTY0Nyw3ICs2
NDcsNyBAQCB2b2lkIGludGVsX3VuY29yZV9mb3JjZXdha2VfdXNlcl9wdXQoc3RydWN0IGludGVs
X3VuY29yZSAqdW5jb3JlKQo+ID4gICAgKiBAZndfZG9tYWluczogZm9yY2V3YWtlIGRvbWFpbnMg
dG8gZ2V0IHJlZmVyZW5jZSBvbgo+ID4gICAgKgo+ID4gICAgKiBTZWUgaW50ZWxfdW5jb3JlX2Zv
cmNld2FrZV9nZXQoKS4gVGhpcyB2YXJpYW50IHBsYWNlcyB0aGUgb251cwo+ID4gLSAqIG9uIHRo
ZSBjYWxsZXIgdG8gZXhwbGljaXRseSBoYW5kbGUgdGhlIGRldl9wcml2LT51bmNvcmUubG9jayBz
cGlubG9jay4KPiA+ICsgKiBvbiB0aGUgY2FsbGVyIHRvIGV4cGxpY2l0bHkgaGFuZGxlIHRoZSBp
OTE1LT51bmNvcmUubG9jayBzcGlubG9jay4KPiA+ICAgICovCj4gPiAgIHZvaWQgaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9nZXRfX2xvY2tlZChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsCj4g
PiAgIAkJCQkJZW51bSBmb3JjZXdha2VfZG9tYWlucyBmd19kb21haW5zKQo+ID4gQEAgLTcwOCw3
ICs3MDgsNyBAQCB2b2lkIGludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KHN0cnVjdCBpbnRlbF91
bmNvcmUgKnVuY29yZSwKPiA+ICAgICogQGZ3X2RvbWFpbnM6IGZvcmNld2FrZSBkb21haW5zIHRv
IGdldCByZWZlcmVuY2Ugb24KPiA+ICAgICoKPiA+ICAgICogU2VlIGludGVsX3VuY29yZV9mb3Jj
ZXdha2VfcHV0KCkuIFRoaXMgdmFyaWFudCBwbGFjZXMgdGhlIG9udXMKPiA+IC0gKiBvbiB0aGUg
Y2FsbGVyIHRvIGV4cGxpY2l0bHkgaGFuZGxlIHRoZSBkZXZfcHJpdi0+dW5jb3JlLmxvY2sgc3Bp
bmxvY2suCj4gPiArICogb24gdGhlIGNhbGxlciB0byBleHBsaWNpdGx5IGhhbmRsZSB0aGUgaTkx
NS0+dW5jb3JlLmxvY2sgc3BpbmxvY2suCj4gPiAgICAqLwo+ID4gICB2b2lkIGludGVsX3VuY29y
ZV9mb3JjZXdha2VfcHV0X19sb2NrZWQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAo+ID4g
ICAJCQkJCWVudW0gZm9yY2V3YWtlX2RvbWFpbnMgZndfZG9tYWlucykKPiA+IEBAIC04MjEsMTAg
KzgyMSwxMCBAQCBmaW5kX2Z3X2RvbWFpbihzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsIHUz
MiBvZmZzZXQpCj4gPiAgICNkZWZpbmUgR0VOX0ZXX1JBTkdFKHMsIGUsIGQpIFwKPiA+ICAgCXsg
LnN0YXJ0ID0gKHMpLCAuZW5kID0gKGUpLCAuZG9tYWlucyA9IChkKSB9Cj4gPiAtI2RlZmluZSBI
QVNfRldUQUJMRShkZXZfcHJpdikgXAo+ID4gLQkoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5IHx8
IFwKPiA+IC0JIElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpIHx8IFwKPiA+IC0JIElTX1ZBTExFWVZJ
RVcoZGV2X3ByaXYpKQo+ID4gKyNkZWZpbmUgSEFTX0ZXVEFCTEUoaTkxNSkgXAo+ID4gKwkoSU5U
RUxfR0VOKGk5MTUpID49IDkgfHwgXAo+ID4gKwkgSVNfQ0hFUlJZVklFVyhpOTE1KSB8fCBcCj4g
PiArCSBJU19WQUxMRVlWSUVXKGk5MTUpKQo+ID4gICAvKiAqTXVzdCogYmUgc29ydGVkIGJ5IG9m
ZnNldCByYW5nZXMhIFNlZSBpbnRlbF9md190YWJsZV9jaGVjaygpLiAqLwo+ID4gICBzdGF0aWMg
Y29uc3Qgc3RydWN0IGludGVsX2ZvcmNld2FrZV9yYW5nZSBfX3Zsdl9md19yYW5nZXNbXSA9IHsK
PiA+IEBAIC0xNDYxLDcgKzE0NjEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF91bmNvcmVfZndfZG9t
YWluc19pbml0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSkKPiA+ICAgc3RhdGljIGludCBp
OTE1X3BtaWNfYnVzX2FjY2Vzc19ub3RpZmllcihzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iLAo+
ID4gICAJCQkJCSB1bnNpZ25lZCBsb25nIGFjdGlvbiwgdm9pZCAqZGF0YSkKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBjb250YWluZXJfb2YobmIsCj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY29udGFpbmVyX29mKG5iLAo+ID4g
ICAJCQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwgdW5jb3JlLnBtaWNfYnVzX2FjY2Vzc19uYik7
Cj4gPiAgIAlzd2l0Y2ggKGFjdGlvbikgewo+ID4gQEAgLTE0NzksMTIgKzE0NzksMTIgQEAgc3Rh
dGljIGludCBpOTE1X3BtaWNfYnVzX2FjY2Vzc19ub3RpZmllcihzdHJ1Y3Qgbm90aWZpZXJfYmxv
Y2sgKm5iLAo+ID4gICAJCSAqIHdha2UgcmVmZXJlbmNlIC0+IGRpc2FibGUgd2FrZXJlZiBhc3Nl
cnRzIGZvciB0aGUgdGltZSBvZgo+ID4gICAJCSAqIHRoZSBhY2Nlc3MuCj4gPiAgIAkJICovCj4g
PiAtCQlkaXNhYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ID4gLQkJaW50ZWxf
dW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwo+
ID4gLQkJZW5hYmxlX3JwbV93YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwo+ID4gKwkJZGlzYWJs
ZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGk5MTUpOwo+ID4gKwkJaW50ZWxfdW5jb3JlX2ZvcmNld2Fr
ZV9nZXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCQllbmFibGVfcnBtX3dh
a2VyZWZfYXNzZXJ0cyhpOTE1KTsKPiA+ICAgCQlicmVhazsKPiA+ICAgCWNhc2UgTUJJX1BNSUNf
QlVTX0FDQ0VTU19FTkQ6Cj4gPiAtCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3By
aXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Cj4gPiArCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtl
X3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKPiA+ICAgCQlicmVhazsKPiA+ICAg
CX0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91bmNvcmUuaCBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VuY29yZS5oCj4gPiBpbmRleCBkNmFmM2RlNzAx
MjEuLmQzMGJkYTJjMzQ0NCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX3VuY29yZS5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91bmNvcmUu
aAo+ID4gQEAgLTE3Nyw3ICsxNzcsNyBAQCBpbnRlbF91bmNvcmVfaGFzX2ZpZm8oY29uc3Qgc3Ry
dWN0IGludGVsX3VuY29yZSAqdW5jb3JlKQo+ID4gICAJcmV0dXJuIHVuY29yZS0+ZmxhZ3MgJiBV
TkNPUkVfSEFTX0ZJRk87Cj4gPiAgIH0KPiA+IC12b2lkIGludGVsX3VuY29yZV9zYW5pdGl6ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwo+ID4gK3ZvaWQgaW50ZWxfdW5jb3Jl
X3Nhbml0aXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKPiA+ICAgdm9pZCBpbnRl
bF91bmNvcmVfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpOwo+ID4gICBp
bnQgaW50ZWxfdW5jb3JlX2luaXRfbW1pbyhzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpOwo+
ID4gICB2b2lkIGludGVsX3VuY29yZV9wcnVuZV9tbWlvX2RvbWFpbnMoc3RydWN0IGludGVsX3Vu
Y29yZSAqdW5jb3JlKTsKPiA+IEBAIC0zNjEsNyArMzYxLDcgQEAgaW50ZWxfdW5jb3JlX3JlYWQ2
NF8yeDMyKHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwKPiA+ICAgICoKPiA+ICAgICogQ2Vy
dGFpbiBhcmNoaXRlY3R1cmVzIHdpbGwgZGllIGlmIHRoZSBzYW1lIGNhY2hlbGluZSBpcyBjb25j
dXJyZW50bHkgYWNjZXNzZWQKPiA+ICAgICogYnkgZGlmZmVyZW50IGNsaWVudHMgKGUuZy4gb24g
SXZ5YnJpZGdlKS4gQWNjZXNzIHRvIHJlZ2lzdGVycyBzaG91bGQKPiA+IC0gKiB0aGVyZWZvcmUg
Z2VuZXJhbGx5IGJlIHNlcmlhbGlzZWQsIGJ5IGVpdGhlciB0aGUgZGV2X3ByaXYtPnVuY29yZS5s
b2NrIG9yCj4gPiArICogdGhlcmVmb3JlIGdlbmVyYWxseSBiZSBzZXJpYWxpc2VkLCBieSBlaXRo
ZXIgdGhlIGk5MTUtPnVuY29yZS5sb2NrIG9yCj4gPiAgICAqIGEgbW9yZSBsb2NhbGlzZWQgbG9j
ayBndWFyZGluZyBhbGwgYWNjZXNzIHRvIHRoYXQgYmFuayBvZiByZWdpc3RlcnMuCj4gPiAgICAq
Lwo+ID4gICAjZGVmaW5lIGludGVsX3VuY29yZV9yZWFkX2Z3KC4uLikgX19yYXdfdW5jb3JlX3Jl
YWQzMihfX1ZBX0FSR1NfXykKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF92YnRfZGVmcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdmJ0X2RlZnMuaAo+
ID4gaW5kZXggODllZjE0Y2FmYjZiLi5lMmU5ODgzZDZiMjggMTAwNjQ0Cj4gPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF92YnRfZGVmcy5oCj4gPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF92YnRfZGVmcy5oCj4gPiBAQCAtMzM3LDcgKzMzNyw3IEBAIGVudW0gdmJ0
X2dtYnVzX2RkaSB7Cj4gPiAgICAqIGJhc2ljYWxseSBhbnkgb2YgdGhlIGZpZWxkcyB0byBlbnN1
cmUgdGhlIGNvcnJlY3QgaW50ZXJwcmV0YXRpb24gZm9yIHRoZSBCREIKPiA+ICAgICogdmVyc2lv
biBpbiBxdWVzdGlvbi4KPiA+ICAgICoKPiA+IC0gKiBXaGVuIHdlIGNvcHkgdGhlIGNoaWxkIGRl
dmljZSBjb25maWdzIHRvIGRldl9wcml2LT52YnQuY2hpbGRfZGV2LCB3ZSByZXNlcnZlCj4gPiAr
ICogV2hlbiB3ZSBjb3B5IHRoZSBjaGlsZCBkZXZpY2UgY29uZmlncyB0byBpOTE1LT52YnQuY2hp
bGRfZGV2LCB3ZSByZXNlcnZlCj4gPiAgICAqIHNwYWNlIGZvciB0aGUgZnVsbCBzdHJ1Y3R1cmUg
YmVsb3csIGFuZCBpbml0aWFsaXplIHRoZSB0YWlsIG5vdCBhY3R1YWxseQo+ID4gICAgKiBwcmVz
ZW50IGluIFZCVCB0byB6ZXJvcy4gQWNjZXNzaW5nIHRob3NlIGZpZWxkcyBpcyBmaW5lLCBhcyBs
b25nIGFzIHRoZQo+ID4gICAgKiBkZWZhdWx0IHplcm8gaXMgdGFrZW4gaW50byBhY2NvdW50LCBh
Z2FpbiBhY2NvcmRpbmcgdG8gdGhlIEJEQiB2ZXJzaW9uLgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX3Zkc2MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X3Zkc2MuYwo+ID4gaW5kZXggZmZlYzgwN2I4OTYwLi4xNjRmZDRiNTYxMTIgMTAwNjQ0Cj4gPiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF92ZHNjLmMKPiA+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX3Zkc2MuYwo+ID4gQEAgLTQ3OCw3ICs0NzgsNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9jb25maWd1cmVfcHBzX2Zvcl9kc2NfZW5jb2RlcihzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPiA+ICAgCQkJCQkJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9f
aW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiA+ICAgCWNvbnN0IHN0cnVjdCBkcm1fZHNjX2NvbmZpZyAqdmRzY19jZmcgPSAmY3J0Y19zdGF0
ZS0+ZHBfZHNjX2NmZzsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+ICAg
CWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2Nv
ZGVyOwo+ID4gQEAgLTg5Nyw3ICs4OTcsNyBAQCB2b2lkIGludGVsX2RzY19lbmFibGUoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJICAgICAgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiA+ICAgCWk5
MTVfcmVnX3QgZHNzX2N0bDFfcmVnLCBkc3NfY3RsMl9yZWc7Cj4gPiAgIAl1MzIgZHNzX2N0bDFf
dmFsID0gMDsKPiA+IEBAIC05MDcsNyArOTA3LDcgQEAgdm9pZCBpbnRlbF9kc2NfZW5hYmxlKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCXJldHVybjsKPiA+ICAgCS8qIEVu
YWJsZSBQb3dlciB3ZWxscyBmb3IgVkRTQy9qb2luaW5nICovCj4gPiAtCWludGVsX2Rpc3BsYXlf
cG93ZXJfZ2V0KGRldl9wcml2LAo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LAo+
ID4gICAJCQkJaW50ZWxfZHNjX3Bvd2VyX2RvbWFpbihjcnRjX3N0YXRlKSk7Cj4gPiAgIAlpbnRl
bF9jb25maWd1cmVfcHBzX2Zvcl9kc2NfZW5jb2RlcihlbmNvZGVyLCBjcnRjX3N0YXRlKTsKPiA+
IEBAIC05MzMsNyArOTMzLDcgQEAgdm9pZCBpbnRlbF9kc2NfZW5hYmxlKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+ID4gICB2b2lkIGludGVsX2RzY19kaXNhYmxlKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPiA+ICAgewo+ID4gICAJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNy
dGMpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNy
dGMtPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKPiA+ICAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsK
PiA+ICAgCWk5MTVfcmVnX3QgZHNzX2N0bDFfcmVnLCBkc3NfY3RsMl9yZWc7Cj4gPiAgIAl1MzIg
ZHNzX2N0bDFfdmFsID0gMCwgZHNzX2N0bDJfdmFsID0gMDsKPiA+IEBAIC05NjEsNiArOTYxLDYg
QEAgdm9pZCBpbnRlbF9kc2NfZGlzYWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
b2xkX2NydGNfc3RhdGUpCj4gPiAgIAlJOTE1X1dSSVRFKGRzc19jdGwyX3JlZywgZHNzX2N0bDJf
dmFsKTsKPiA+ICAgCS8qIERpc2FibGUgUG93ZXIgd2VsbHMgZm9yIFZEU0Mvam9pbmluZyAqLwo+
ID4gLQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF91bmNoZWNrZWQoZGV2X3ByaXYsCj4gPiArCWlu
dGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChpOTE1LAo+ID4gICAJCQkJCSAgaW50ZWxf
ZHNjX3Bvd2VyX2RvbWFpbihvbGRfY3J0Y19zdGF0ZSkpOwo+ID4gICB9Cj4gPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfd29wY20uYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX3dvcGNtLmMKPiA+IGluZGV4IDdiNGJhODRiOWZiOC4uNjQ2NTQwYjk3MjY3IDEw
MDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfd29wY20uYwo+ID4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfd29wY20uYwo+ID4gQEAgLTIyNSw3ICsyMjUs
NyBAQCBpbnQgaW50ZWxfd29wY21faW5pdChzdHJ1Y3QgaW50ZWxfd29wY20gKndvcGNtKQo+ID4g
ICAJcmV0dXJuIDA7Cj4gPiAgIH0KPiA+IC1zdGF0aWMgaW5saW5lIGludCB3cml0ZV9hbmRfdmVy
aWZ5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgaW5saW5l
IGludCB3cml0ZV9hbmRfdmVyaWZ5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ID4g
ICAJCQkJICAgaTkxNV9yZWdfdCByZWcsIHUzMiB2YWwsIHUzMiBtYXNrLAo+ID4gICAJCQkJICAg
dTMyIGxvY2tlZF9iaXQpCj4gPiAgIHsKPiA+IEBAIC0yNTIsMjcgKzI1MiwyNyBAQCBzdGF0aWMg
aW5saW5lIGludCB3cml0ZV9hbmRfdmVyaWZ5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKPiA+ICAgICovCj4gPiAgIGludCBpbnRlbF93b3BjbV9pbml0X2h3KHN0cnVjdCBpbnRl
bF93b3BjbSAqd29wY20pCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gd29wY21fdG9faTkxNSh3b3BjbSk7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gd29wY21fdG9faTkxNSh3b3BjbSk7Cj4gPiAgIAl1MzIgaHVjX2FnZW50Owo+
ID4gICAJdTMyIG1hc2s7Cj4gPiAgIAlpbnQgZXJyOwo+ID4gLQlpZiAoIVVTRVNfR1VDKGRldl9w
cml2KSkKPiA+ICsJaWYgKCFVU0VTX0dVQyhpOTE1KSkKPiA+ICAgCQlyZXR1cm4gMDsKPiA+IC0J
R0VNX0JVR19PTighSEFTX0dVQyhkZXZfcHJpdikpOwo+ID4gKwlHRU1fQlVHX09OKCFIQVNfR1VD
KGk5MTUpKTsKPiA+ICAgCUdFTV9CVUdfT04oIXdvcGNtLT5ndWMuc2l6ZSk7Cj4gPiAgIAlHRU1f
QlVHX09OKCF3b3BjbS0+Z3VjLmJhc2UpOwo+ID4gLQllcnIgPSB3cml0ZV9hbmRfdmVyaWZ5KGRl
dl9wcml2LCBHVUNfV09QQ01fU0laRSwgd29wY20tPmd1Yy5zaXplLAo+ID4gKwllcnIgPSB3cml0
ZV9hbmRfdmVyaWZ5KGk5MTUsIEdVQ19XT1BDTV9TSVpFLCB3b3BjbS0+Z3VjLnNpemUsCj4gPiAg
IAkJCSAgICAgICBHVUNfV09QQ01fU0laRV9NQVNLIHwgR1VDX1dPUENNX1NJWkVfTE9DS0VELAo+
ID4gICAJCQkgICAgICAgR1VDX1dPUENNX1NJWkVfTE9DS0VEKTsKPiA+ICAgCWlmIChlcnIpCj4g
PiAgIAkJZ290byBlcnJfb3V0Owo+ID4gLQlodWNfYWdlbnQgPSBVU0VTX0hVQyhkZXZfcHJpdikg
PyBIVUNfTE9BRElOR19BR0VOVF9HVUMgOiAwOwo+ID4gKwlodWNfYWdlbnQgPSBVU0VTX0hVQyhp
OTE1KSA/IEhVQ19MT0FESU5HX0FHRU5UX0dVQyA6IDA7Cj4gPiAgIAltYXNrID0gR1VDX1dPUENN
X09GRlNFVF9NQVNLIHwgR1VDX1dPUENNX09GRlNFVF9WQUxJRCB8IGh1Y19hZ2VudDsKPiA+IC0J
ZXJyID0gd3JpdGVfYW5kX3ZlcmlmeShkZXZfcHJpdiwgRE1BX0dVQ19XT1BDTV9PRkZTRVQsCj4g
PiArCWVyciA9IHdyaXRlX2FuZF92ZXJpZnkoaTkxNSwgRE1BX0dVQ19XT1BDTV9PRkZTRVQsCj4g
PiAgIAkJCSAgICAgICB3b3BjbS0+Z3VjLmJhc2UgfCBodWNfYWdlbnQsIG1hc2ssCj4gPiAgIAkJ
CSAgICAgICBHVUNfV09QQ01fT0ZGU0VUX1ZBTElEKTsKPiA+ICAgCWlmIChlcnIpCj4gPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCj4gPiBpbmRleCAy
MDkzZDA4YTc1NjkuLjI1MTQ4NDIyMzZmNiAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCj4gPiBAQCAtMTQ3LDE3ICsxNDcsMTcgQEAg
ZmFrZV9kbWFfb2JqZWN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1NjQgc2l6ZSkK
PiA+ICAgc3RhdGljIGludCBpZ3RfcHBndHRfYWxsb2Modm9pZCAqYXJnKQo+ID4gICB7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGFyZzsKPiA+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7Cj4gPiAgIAlzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBn
dHQ7Cj4gPiAgIAl1NjQgc2l6ZSwgbGFzdCwgbGltaXQ7Cj4gPiAgIAlpbnQgZXJyID0gMDsKPiA+
ICAgCS8qIEFsbG9jYXRlIGEgcHBnZ3QgYW5kIHRyeSB0byBmaWxsIHRoZSBlbnRpcmUgcmFuZ2Ug
Ki8KPiA+IC0JaWYgKCFIQVNfUFBHVFQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoIUhBU19QUEdUVChp
OTE1KSkKPiA+ICAgCQlyZXR1cm4gMDsKPiA+IC0JcHBndHQgPSBfX3BwZ3R0X2NyZWF0ZShkZXZf
cHJpdik7Cj4gPiArCXBwZ3R0ID0gX19wcGd0dF9jcmVhdGUoaTkxNSk7Cj4gPiAgIAlpZiAoSVNf
RVJSKHBwZ3R0KSkKPiA+ICAgCQlyZXR1cm4gUFRSX0VSUihwcGd0dCk7Cj4gPiBAQCAtMjA4LDkg
KzIwOCw5IEBAIHN0YXRpYyBpbnQgaWd0X3BwZ3R0X2FsbG9jKHZvaWQgKmFyZykKPiA+ICAgCX0K
PiA+ICAgZXJyX3BwZ3R0X2NsZWFudXA6Cj4gPiAtCW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0u
c3RydWN0X211dGV4KTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Cj4gPiAgIAlpOTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZf
cHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7Cj4gPiAgIAlyZXR1cm4gZXJyOwo+ID4gICB9Cj4gPiBAQCAtOTkyLDcgKzk5
Miw3IEBAIHN0YXRpYyBpbnQgc2hyaW5rX2Jvb20oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCj4gPiAgIAlyZXR1cm4gZXJyOwo+ID4gICB9Cj4gPiAtc3RhdGljIGludCBleGVyY2lzZV9w
cGd0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gPiArc3RhdGljIGludCBl
eGVyY2lzZV9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJICBp
bnQgKCpmdW5jKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiA+ICAgCQkJCSAgICAg
IHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAo+ID4gICAJCQkJICAgICAgdTY0IGhvbGVf
c3RhcnQsIHU2NCBob2xlX2VuZCwKPiA+IEBAIC0xMDAzLDE1ICsxMDAzLDE1IEBAIHN0YXRpYyBp
bnQgZXhlcmNpc2VfcHBndHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4g
ICAJSUdUX1RJTUVPVVQoZW5kX3RpbWUpOwo+ID4gICAJaW50IGVycjsKPiA+IC0JaWYgKCFIQVNf
RlVMTF9QUEdUVChkZXZfcHJpdikpCj4gPiArCWlmICghSEFTX0ZVTExfUFBHVFQoaTkxNSkpCj4g
PiAgIAkJcmV0dXJuIDA7Cj4gPiAtCWZpbGUgPSBtb2NrX2ZpbGUoZGV2X3ByaXYpOwo+ID4gKwlm
aWxlID0gbW9ja19maWxlKGk5MTUpOwo+ID4gICAJaWYgKElTX0VSUihmaWxlKSkKPiA+ICAgCQly
ZXR1cm4gUFRSX0VSUihmaWxlKTsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwo+ID4gLQlwcGd0dCA9IGk5MTVfcHBndHRfY3JlYXRlKGRldl9wcml2KTsKPiA+
ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCXBwZ3R0ID0gaTkx
NV9wcGd0dF9jcmVhdGUoaTkxNSk7Cj4gPiAgIAlpZiAoSVNfRVJSKHBwZ3R0KSkgewo+ID4gICAJ
CWVyciA9IFBUUl9FUlIocHBndHQpOwo+ID4gICAJCWdvdG8gb3V0X3VubG9jazsKPiA+IEBAIC0x
MDE5LDEzICsxMDE5LDEzIEBAIHN0YXRpYyBpbnQgZXhlcmNpc2VfcHBndHQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJR0VNX0JVR19PTihvZmZzZXRfaW5fcGFnZShw
cGd0dC0+dm0udG90YWwpKTsKPiA+ICAgCUdFTV9CVUdfT04ocHBndHQtPnZtLmNsb3NlZCk7Cj4g
PiAtCWVyciA9IGZ1bmMoZGV2X3ByaXYsICZwcGd0dC0+dm0sIDAsIHBwZ3R0LT52bS50b3RhbCwg
ZW5kX3RpbWUpOwo+ID4gKwllcnIgPSBmdW5jKGk5MTUsICZwcGd0dC0+dm0sIDAsIHBwZ3R0LT52
bS50b3RhbCwgZW5kX3RpbWUpOwo+ID4gICAJaTkxNV92bV9wdXQoJnBwZ3R0LT52bSk7Cj4gPiAg
IG91dF91bmxvY2s6Cj4gPiAtCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4gLQlt
b2NrX2ZpbGVfZnJlZShkZXZfcHJpdiwgZmlsZSk7Cj4gPiArCW1vY2tfZmlsZV9mcmVlKGk5MTUs
IGZpbGUpOwo+ID4gICAJcmV0dXJuIGVycjsKPiA+ICAgfQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9ndWMuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9pbnRlbF9ndWMuYwo+ID4gaW5kZXggN2ZkMDMyMWUwOTQ3Li5hYjNlNzFj
OTU3ZGYgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50
ZWxfZ3VjLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9n
dWMuYwo+ID4gQEAgLTEwNywxMiArMTA3LDEyIEBAIHN0YXRpYyBpbnQgdmFsaWRhdGVfY2xpZW50
KHN0cnVjdCBpbnRlbF9ndWNfY2xpZW50ICpjbGllbnQsCj4gPiAgIAkJCSAgIGludCBjbGllbnRf
cHJpb3JpdHksCj4gPiAgIAkJCSAgIGJvb2wgaXNfcHJlZW1wdF9jbGllbnQpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3VjX3RvX2k5MTUoY2xpZW50
LT5ndWMpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1
KGNsaWVudC0+Z3VjKTsKPiA+ICAgCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHhfb3duZXIg
PSBpc19wcmVlbXB0X2NsaWVudCA/Cj4gPiAtCQkJZGV2X3ByaXYtPnByZWVtcHRfY29udGV4dCA6
IGRldl9wcml2LT5rZXJuZWxfY29udGV4dDsKPiA+ICsJCQlpOTE1LT5wcmVlbXB0X2NvbnRleHQg
OiBpOTE1LT5rZXJuZWxfY29udGV4dDsKPiA+ICAgCWlmIChjbGllbnQtPm93bmVyICE9IGN0eF9v
d25lciB8fAo+ID4gLQkgICAgY2xpZW50LT5lbmdpbmVzICE9IElOVEVMX0lORk8oZGV2X3ByaXYp
LT5lbmdpbmVfbWFzayB8fAo+ID4gKwkgICAgY2xpZW50LT5lbmdpbmVzICE9IElOVEVMX0lORk8o
aTkxNSktPmVuZ2luZV9tYXNrIHx8Cj4gPiAgIAkgICAgY2xpZW50LT5wcmlvcml0eSAhPSBjbGll
bnRfcHJpb3JpdHkgfHwKPiA+ICAgCSAgICBjbGllbnQtPmRvb3JiZWxsX2lkID09IEdVQ19ET09S
QkVMTF9JTlZBTElEKQo+ID4gICAJCXJldHVybiAtRUlOVkFMOwo+ID4gQEAgLTEzNywxNiArMTM3
LDE2IEBAIHN0YXRpYyBib29sIGNsaWVudF9kb29yYmVsbF9pbl9zeW5jKHN0cnVjdCBpbnRlbF9n
dWNfY2xpZW50ICpjbGllbnQpCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgaW50IGlndF9ndWNfY2xp
ZW50cyh2b2lkICphcmdzKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IGFyZ3M7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJn
czsKPiA+ICAgCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ID4gICAJc3RydWN0IGludGVsX2d1
YyAqZ3VjOwo+ID4gICAJaW50IGVyciA9IDA7Cj4gPiAtCUdFTV9CVUdfT04oIUhBU19HVUMoZGV2
X3ByaXYpKTsKPiA+IC0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+
ID4gLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOwo+ID4gKwlHRU1f
QlVHX09OKCFIQVNfR1VDKGk5MTUpKTsKPiA+ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7Cj4gPiArCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKPiA+
IC0JZ3VjID0gJmRldl9wcml2LT5ndWM7Cj4gPiArCWd1YyA9ICZpOTE1LT5ndWM7Cj4gPiAgIAlp
ZiAoIWd1Yykgewo+ID4gICAJCXByX2VycigiTm8gZ3VjIG9iamVjdCFcbiIpOwo+ID4gICAJCWVy
ciA9IC1FSU5WQUw7Cj4gPiBAQCAtMjI3LDggKzIyNyw4IEBAIHN0YXRpYyBpbnQgaWd0X2d1Y19j
bGllbnRzKHZvaWQgKmFyZ3MpCj4gPiAgIAlndWNfY2xpZW50c19jcmVhdGUoZ3VjKTsKPiA+ICAg
CWd1Y19jbGllbnRzX2VuYWJsZShndWMpOwo+ID4gICB1bmxvY2s6Cj4gPiAtCWludGVsX3J1bnRp
bWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKPiA+IC0JbXV0ZXhfdW5sb2NrKCZkZXZfcHJp
di0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiArCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdh
a2VyZWYpOwo+ID4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ID4g
ICAJcmV0dXJuIGVycjsKPiA+ICAgfQo+ID4gQEAgLTIzOSwxNyArMjM5LDE3IEBAIHN0YXRpYyBp
bnQgaWd0X2d1Y19jbGllbnRzKHZvaWQgKmFyZ3MpCj4gPiAgICAqLwo+ID4gICBzdGF0aWMgaW50
IGlndF9ndWNfZG9vcmJlbGxzKHZvaWQgKmFyZykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBhcmc7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gYXJnOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gPiAgIAlzdHJ1
Y3QgaW50ZWxfZ3VjICpndWM7Cj4gPiAgIAlpbnQgaSwgZXJyID0gMDsKPiA+ICAgCXUxNiBkYl9p
ZDsKPiA+IC0JR0VNX0JVR19PTighSEFTX0dVQyhkZXZfcHJpdikpOwo+ID4gLQltdXRleF9sb2Nr
KCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50
aW1lX3BtX2dldChkZXZfcHJpdik7Cj4gPiArCUdFTV9CVUdfT04oIUhBU19HVUMoaTkxNSkpOwo+
ID4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJd2FrZXJlZiA9
IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOwo+ID4gLQlndWMgPSAmZGV2X3ByaXYtPmd1YzsK
PiA+ICsJZ3VjID0gJmk5MTUtPmd1YzsKPiA+ICAgCWlmICghZ3VjKSB7Cj4gPiAgIAkJcHJfZXJy
KCJObyBndWMgb2JqZWN0IVxuIik7Cj4gPiAgIAkJZXJyID0gLUVJTlZBTDsKPiA+IEBAIC0yNjEs
MTAgKzI2MSwxMCBAQCBzdGF0aWMgaW50IGlndF9ndWNfZG9vcmJlbGxzKHZvaWQgKmFyZykKPiA+
ICAgCQlnb3RvIHVubG9jazsKPiA+ICAgCWZvciAoaSA9IDA7IGkgPCBBVFRFTVBUUzsgaSsrKSB7
Cj4gPiAtCQljbGllbnRzW2ldID0gZ3VjX2NsaWVudF9hbGxvYyhkZXZfcHJpdiwKPiA+IC0JCQkJ
CSAgICAgIElOVEVMX0lORk8oZGV2X3ByaXYpLT5lbmdpbmVfbWFzaywKPiA+ICsJCWNsaWVudHNb
aV0gPSBndWNfY2xpZW50X2FsbG9jKGk5MTUsCj4gPiArCQkJCQkgICAgICBJTlRFTF9JTkZPKGk5
MTUpLT5lbmdpbmVfbWFzaywKPiA+ICAgCQkJCQkgICAgICBpICUgR1VDX0NMSUVOVF9QUklPUklU
WV9OVU0sCj4gPiAtCQkJCQkgICAgICBkZXZfcHJpdi0+a2VybmVsX2NvbnRleHQpOwo+ID4gKwkJ
CQkJICAgICAgaTkxNS0+a2VybmVsX2NvbnRleHQpOwo+ID4gICAJCWlmICghY2xpZW50c1tpXSkg
ewo+ID4gICAJCQlwcl9lcnIoIlslZF0gTm8gZ3VjIGNsaWVudFxuIiwgaSk7Cj4gPiBAQCAtMzQw
LDIwICszNDAsMjAgQEAgc3RhdGljIGludCBpZ3RfZ3VjX2Rvb3JiZWxscyh2b2lkICphcmcpCj4g
PiAgIAkJCWd1Y19jbGllbnRfZnJlZShjbGllbnRzW2ldKTsKPiA+ICAgCQl9Cj4gPiAgIHVubG9j
azoKPiA+IC0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOwo+ID4gLQlt
dXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiA+ICsJaW50ZWxfcnVu
dGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7Cj4gPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7Cj4gPiAgIAlyZXR1cm4gZXJyOwo+ID4gICB9Cj4gPiAtaW50IGludGVs
X2d1Y19saXZlX3NlbGZ0ZXN0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiA+
ICtpbnQgaW50ZWxfZ3VjX2xpdmVfc2VsZnRlc3Qoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gPiAgIHsKPiA+ICAgCXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3Rz
W10gPSB7Cj4gPiAgIAkJU1VCVEVTVChpZ3RfZ3VjX2NsaWVudHMpLAo+ID4gICAJCVNVQlRFU1Qo
aWd0X2d1Y19kb29yYmVsbHMpLAo+ID4gICAJfTsKPiA+IC0JaWYgKCFVU0VTX0dVQ19TVUJNSVNT
SU9OKGRldl9wcml2KSkKPiA+ICsJaWYgKCFVU0VTX0dVQ19TVUJNSVNTSU9OKGk5MTUpKQo+ID4g
ICAJCXJldHVybiAwOwo+ID4gLQlyZXR1cm4gaTkxNV9zdWJ0ZXN0cyh0ZXN0cywgZGV2X3ByaXYp
Owo+ID4gKwlyZXR1cm4gaTkxNV9zdWJ0ZXN0cyh0ZXN0cywgaTkxNSk7Cj4gPiAgIH0KPiA+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfdW5jb3JlLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfdW5jb3JlLmMKPiA+IGluZGV4
IGUwZDdlYmVjYjIxNS4uYjUzMDRjZmVkYTIxIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX3VuY29yZS5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfdW5jb3JlLmMKPiA+IEBAIC0yNTQsMTUgKzI1NCwxNSBA
QCBzdGF0aWMgaW50IGxpdmVfZm9yY2V3YWtlX29wcyh2b2lkICphcmcpCj4gPiAgIHN0YXRpYyBp
bnQgbGl2ZV9mb3JjZXdha2VfZG9tYWlucyh2b2lkICphcmcpCj4gPiAgIHsKPiA+ICAgI2RlZmlu
ZSBGV19SQU5HRSAweDQwMDAwCj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IGFyZzsKPiA+IC0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51
bmNvcmU7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwo+ID4gKwlz
dHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOwo+ID4gICAJdW5zaWdu
ZWQgbG9uZyAqdmFsaWQ7Cj4gPiAgIAl1MzIgb2Zmc2V0Owo+ID4gICAJaW50IGVycjsKPiA+IC0J
aWYgKCFIQVNfRlBHQV9EQkdfVU5DTEFJTUVEKGRldl9wcml2KSAmJgo+ID4gLQkgICAgIUlTX1ZB
TExFWVZJRVcoZGV2X3ByaXYpICYmCj4gPiAtCSAgICAhSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikp
Cj4gPiArCWlmICghSEFTX0ZQR0FfREJHX1VOQ0xBSU1FRChpOTE1KSAmJgo+ID4gKwkgICAgIUlT
X1ZBTExFWVZJRVcoaTkxNSkgJiYKPiA+ICsJICAgICFJU19DSEVSUllWSUVXKGk5MTUpKQo+ID4g
ICAJCXJldHVybiAwOwo+ID4gICAJLyoKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS92bHZfZHNpLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS92bHZfZHNpLmMKPiA+IGluZGV4
IGUyNzJkODI2MjEwYS4uMDE3OGJkZjBjNWE5IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvdmx2X2RzaS5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS92bHZfZHNp
LmMKPiA+IEBAIC03OCwxOSArNzgsMTkgQEAgdm9pZCB2bHZfZHNpX3dhaXRfZm9yX2ZpZm9fZW1w
dHkoc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpLCBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+
ID4gICAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyID0gJmludGVsX2RzaS0+YmFzZS5iYXNl
Owo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmRldjsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXUzMiBtYXNr
Owo+ID4gICAJbWFzayA9IExQX0NUUkxfRklGT19FTVBUWSB8IEhTX0NUUkxfRklGT19FTVBUWSB8
Cj4gPiAgIAkJTFBfREFUQV9GSUZPX0VNUFRZIHwgSFNfREFUQV9GSUZPX0VNUFRZOwo+ID4gLQlp
ZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCWlmIChp
bnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJICAgIE1JUElf
R0VOX0ZJRk9fU1RBVChwb3J0KSwgbWFzaywgbWFzaywKPiA+ICAgCQkJCSAgICAxMDApKQo+ID4g
ICAJCURSTV9FUlJPUigiRFBJIEZJRk9zIGFyZSBub3QgZW1wdHlcbiIpOwo+ID4gICB9Cj4gPiAt
c3RhdGljIHZvaWQgd3JpdGVfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Cj4gPiArc3RhdGljIHZvaWQgd3JpdGVfZGF0YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICAgCQkgICAgICAgaTkxNV9yZWdfdCByZWcsCj4gPiAgIAkJICAgICAgIGNvbnN0IHU4
ICpkYXRhLCB1MzIgbGVuKQo+ID4gICB7Cj4gPiBAQCAtMTA2LDcgKzEwNiw3IEBAIHN0YXRpYyB2
b2lkIHdyaXRlX2RhdGEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ID4gICAJ
fQo+ID4gICB9Cj4gPiAtc3RhdGljIHZvaWQgcmVhZF9kYXRhKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKPiA+ICtzdGF0aWMgdm9pZCByZWFkX2RhdGEoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiAgIAkJICAgICAgaTkxNV9yZWdfdCByZWcsCj4gPiAgIAkJICAg
ICAgdTggKmRhdGEsIHUzMiBsZW4pCj4gPiAgIHsKPiA+IEBAIC0xMjUsNyArMTI1LDcgQEAgc3Rh
dGljIHNzaXplX3QgaW50ZWxfZHNpX2hvc3RfdHJhbnNmZXIoc3RydWN0IG1pcGlfZHNpX2hvc3Qg
Kmhvc3QsCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kc2lfaG9zdCAqaW50ZWxfZHNpX2hv
c3QgPSB0b19pbnRlbF9kc2lfaG9zdChob3N0KTsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSBpbnRlbF9kc2lfaG9zdC0+aW50ZWxfZHNpLT5iYXNlLmJhc2UuZGV2Owo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJZW51bSBwb3J0
IHBvcnQgPSBpbnRlbF9kc2lfaG9zdC0+cG9ydDsKPiA+ICAgCXN0cnVjdCBtaXBpX2RzaV9wYWNr
ZXQgcGFja2V0Owo+ID4gICAJc3NpemVfdCByZXQ7Cj4gPiBAQCAtMTU0LDEzICsxNTQsMTMgQEAg
c3RhdGljIHNzaXplX3QgaW50ZWxfZHNpX2hvc3RfdHJhbnNmZXIoc3RydWN0IG1pcGlfZHNpX2hv
c3QgKmhvc3QsCj4gPiAgIAkvKiBub3RlOiB0aGlzIGlzIG5ldmVyIHRydWUgZm9yIHJlYWRzICov
Cj4gPiAgIAlpZiAocGFja2V0LnBheWxvYWRfbGVuZ3RoKSB7Cj4gPiAtCQlpZiAoaW50ZWxfd2Fp
dF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCQlpZiAoaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiA+ICAgCQkJCQkgICAgTUlQSV9HRU5fRklGT19T
VEFUKHBvcnQpLAo+ID4gICAJCQkJCSAgICBkYXRhX21hc2ssIDAsCj4gPiAgIAkJCQkJICAgIDUw
KSkKPiA+ICAgCQkJRFJNX0VSUk9SKCJUaW1lb3V0IHdhaXRpbmcgZm9yIEhTL0xQIERBVEEgRklG
TyAhZnVsbFxuIik7Cj4gPiAtCQl3cml0ZV9kYXRhKGRldl9wcml2LCBkYXRhX3JlZywgcGFja2V0
LnBheWxvYWQsCj4gPiArCQl3cml0ZV9kYXRhKGk5MTUsIGRhdGFfcmVnLCBwYWNrZXQucGF5bG9h
ZCwKPiA+ICAgCQkJICAgcGFja2V0LnBheWxvYWRfbGVuZ3RoKTsKPiA+ICAgCX0KPiA+IEBAIC0x
NjgsNyArMTY4LDcgQEAgc3RhdGljIHNzaXplX3QgaW50ZWxfZHNpX2hvc3RfdHJhbnNmZXIoc3Ry
dWN0IG1pcGlfZHNpX2hvc3QgKmhvc3QsCj4gPiAgIAkJSTkxNV9XUklURShNSVBJX0lOVFJfU1RB
VChwb3J0KSwgR0VOX1JFQURfREFUQV9BVkFJTCk7Cj4gPiAgIAl9Cj4gPiAtCWlmIChpbnRlbF93
YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJaWYgKGludGVsX3dhaXRf
Zm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gPiAgIAkJCQkgICAgTUlQSV9HRU5fRklGT19T
VEFUKHBvcnQpLAo+ID4gICAJCQkJICAgIGN0cmxfbWFzaywgMCwKPiA+ICAgCQkJCSAgICA1MCkp
IHsKPiA+IEBAIC0xODAsMTMgKzE4MCwxMyBAQCBzdGF0aWMgc3NpemVfdCBpbnRlbF9kc2lfaG9z
dF90cmFuc2ZlcihzdHJ1Y3QgbWlwaV9kc2lfaG9zdCAqaG9zdCwKPiA+ICAgCS8qIC0+cnhfbGVu
IGlzIHNldCBvbmx5IGZvciByZWFkcyAqLwo+ID4gICAJaWYgKG1zZy0+cnhfbGVuKSB7Cj4gPiAg
IAkJZGF0YV9tYXNrID0gR0VOX1JFQURfREFUQV9BVkFJTDsKPiA+IC0JCWlmIChpbnRlbF93YWl0
X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJCWlmIChpbnRlbF93YWl0X2Zv
cl9yZWdpc3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJCSAgICBNSVBJX0lOVFJfU1RBVChw
b3J0KSwKPiA+ICAgCQkJCQkgICAgZGF0YV9tYXNrLCBkYXRhX21hc2ssCj4gPiAgIAkJCQkJICAg
IDUwKSkKPiA+ICAgCQkJRFJNX0VSUk9SKCJUaW1lb3V0IHdhaXRpbmcgZm9yIHJlYWQgZGF0YS5c
biIpOwo+ID4gLQkJcmVhZF9kYXRhKGRldl9wcml2LCBkYXRhX3JlZywgbXNnLT5yeF9idWYsIG1z
Zy0+cnhfbGVuKTsKPiA+ICsJCXJlYWRfZGF0YShpOTE1LCBkYXRhX3JlZywgbXNnLT5yeF9idWYs
IG1zZy0+cnhfbGVuKTsKPiA+ICAgCX0KPiA+ICAgCS8qIFhYWDogZml4IGZvciByZWFkcyBhbmQg
d3JpdGVzICovCj4gPiBAQCAtMjIxLDcgKzIyMSw3IEBAIHN0YXRpYyBpbnQgZHBpX3NlbmRfY21k
KHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSwgdTMyIGNtZCwgYm9vbCBocywKPiA+ICAgewo+
ID4gICAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyID0gJmludGVsX2RzaS0+YmFzZS5iYXNl
Owo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmRldjsKPiA+IC0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXUzMiBtYXNr
Owo+ID4gICAJLyogWFhYOiBwaXBlLCBocyAqLwo+ID4gQEAgLTI0MCw3ICsyNDAsNyBAQCBzdGF0
aWMgaW50IGRwaV9zZW5kX2NtZChzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2ksIHUzMiBjbWQs
IGJvb2wgaHMsCj4gPiAgIAlJOTE1X1dSSVRFKE1JUElfRFBJX0NPTlRST0wocG9ydCksIGNtZCk7
Cj4gPiAgIAltYXNrID0gU1BMX1BLVF9TRU5UX0lOVEVSUlVQVDsKPiA+IC0JaWYgKGludGVsX3dh
aXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ID4gKwlpZiAoaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiA+ICAgCQkJCSAgICBNSVBJX0lOVFJfU1RBVChw
b3J0KSwgbWFzaywgbWFzaywKPiA+ICAgCQkJCSAgICAxMDApKQo+ID4gICAJCURSTV9FUlJPUigi
VmlkZW8gbW9kZSBjb21tYW5kIDB4JTA4eCBzZW5kIGZhaWxlZC5cbiIsIGNtZCk7Cj4gPiBAQCAt
MjQ4LDI1ICsyNDgsMjUgQEAgc3RhdGljIGludCBkcGlfc2VuZF9jbWQoc3RydWN0IGludGVsX2Rz
aSAqaW50ZWxfZHNpLCB1MzIgY21kLCBib29sIGhzLAo+ID4gICAJcmV0dXJuIDA7Cj4gPiAgIH0K
PiA+IC1zdGF0aWMgdm9pZCBiYW5kX2dhcF9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gPiArc3RhdGljIHZvaWQgYmFuZF9nYXBfcmVzZXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gPiAgIHsKPiA+IC0Jdmx2X2ZsaXNkc2lfZ2V0KGRldl9wcml2KTsK
PiA+ICsJdmx2X2ZsaXNkc2lfZ2V0KGk5MTUpOwo+ID4gLQl2bHZfZmxpc2RzaV93cml0ZShkZXZf
cHJpdiwgMHgwOCwgMHgwMDAxKTsKPiA+IC0Jdmx2X2ZsaXNkc2lfd3JpdGUoZGV2X3ByaXYsIDB4
MEYsIDB4MDAwNSk7Cj4gPiAtCXZsdl9mbGlzZHNpX3dyaXRlKGRldl9wcml2LCAweDBGLCAweDAw
MjUpOwo+ID4gKwl2bHZfZmxpc2RzaV93cml0ZShpOTE1LCAweDA4LCAweDAwMDEpOwo+ID4gKwl2
bHZfZmxpc2RzaV93cml0ZShpOTE1LCAweDBGLCAweDAwMDUpOwo+ID4gKwl2bHZfZmxpc2RzaV93
cml0ZShpOTE1LCAweDBGLCAweDAwMjUpOwo+ID4gICAJdWRlbGF5KDE1MCk7Cj4gPiAtCXZsdl9m
bGlzZHNpX3dyaXRlKGRldl9wcml2LCAweDBGLCAweDAwMDApOwo+ID4gLQl2bHZfZmxpc2RzaV93
cml0ZShkZXZfcHJpdiwgMHgwOCwgMHgwMDAwKTsKPiA+ICsJdmx2X2ZsaXNkc2lfd3JpdGUoaTkx
NSwgMHgwRiwgMHgwMDAwKTsKPiA+ICsJdmx2X2ZsaXNkc2lfd3JpdGUoaTkxNSwgMHgwOCwgMHgw
MDAwKTsKPiA+IC0Jdmx2X2ZsaXNkc2lfcHV0KGRldl9wcml2KTsKPiA+ICsJdmx2X2ZsaXNkc2lf
cHV0KGk5MTUpOwo+ID4gICB9Cj4gPiAgIHN0YXRpYyBpbnQgaW50ZWxfZHNpX2NvbXB1dGVfY29u
ZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJICAgIHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiA+ICAgCQkJCSAgICBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGNvbnRhaW5lcl9vZihlbmNvZGVy
LCBzdHJ1Y3QgaW50ZWxfZHNpLAo+ID4gICAJCQkJCQkgICBiYXNlKTsKPiA+ICAgCXN0cnVjdCBp
bnRlbF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvciA9IGludGVsX2RzaS0+YXR0YWNoZWRfY29u
bmVjdG9yOwo+ID4gQEAgLTI4MSw3ICsyODEsNyBAQCBzdGF0aWMgaW50IGludGVsX2RzaV9jb21w
dXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCWlmIChmaXhl
ZF9tb2RlKSB7Cj4gPiAgIAkJaW50ZWxfZml4ZWRfcGFuZWxfbW9kZShmaXhlZF9tb2RlLCBhZGp1
c3RlZF9tb2RlKTsKPiA+IC0JCWlmIChIQVNfR01DSChkZXZfcHJpdikpCj4gPiArCQlpZiAoSEFT
X0dNQ0goaTkxNSkpCj4gPiAgIAkJCWludGVsX2dtY2hfcGFuZWxfZml0dGluZyhjcnRjLCBwaXBl
X2NvbmZpZywKPiA+ICAgCQkJCQkJIGNvbm5fc3RhdGUtPnNjYWxpbmdfbW9kZSk7Cj4gPiAgIAkJ
ZWxzZQo+ID4gQEAgLTMwMCw3ICszMDAsNyBAQCBzdGF0aWMgaW50IGludGVsX2RzaV9jb21wdXRl
X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCWVsc2UKPiA+ICAg
CQlwaXBlX2NvbmZpZy0+cGlwZV9icHAgPSAxODsKPiA+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3By
aXYpKSB7Cj4gPiArCWlmIChJU19HRU45X0xQKGk5MTUpKSB7Cj4gPiAgIAkJLyogRW5hYmxlIEZy
YW1lIHRpbWUgc3RhbXAgYmFzZWQgc2NhbmxpbmUgcmVwb3J0aW5nICovCj4gPiAgIAkJYWRqdXN0
ZWRfbW9kZS0+cHJpdmF0ZV9mbGFncyB8PQo+ID4gICAJCQlJOTE1X01PREVfRkxBR19HRVRfU0NB
TkxJTkVfRlJPTV9USU1FU1RBTVA7Cj4gPiBAQCAtMzI3LDcgKzMyNyw3IEBAIHN0YXRpYyBpbnQg
aW50ZWxfZHNpX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
ID4gICBzdGF0aWMgYm9vbCBnbGtfZHNpX2VuYWJsZV9pbyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRl
bF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ID4g
ICAJZW51bSBwb3J0IHBvcnQ7Cj4gPiAgIAl1MzIgdG1wOwo+ID4gQEAgLTM1OSw3ICszNTksNyBA
QCBzdGF0aWMgYm9vbCBnbGtfZHNpX2VuYWJsZV9pbyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlcikKPiA+ICAgCS8qIFdhaXQgZm9yIFB3ciBBQ0sgKi8KPiA+ICAgCWZvcl9lYWNoX2RzaV9w
b3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiA+IC0JCWlmIChpbnRlbF93YWl0X2Zvcl9y
ZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdp
c3RlcigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJCSAgICBNSVBJX0NUUkwocG9ydCksCj4gPiAg
IAkJCQkJICAgIEdMS19NSVBJSU9fUE9SVF9QT1dFUkVELAo+ID4gICAJCQkJCSAgICBHTEtfTUlQ
SUlPX1BPUlRfUE9XRVJFRCwKPiA+IEBAIC0zNzgsMTQgKzM3OCwxNCBAQCBzdGF0aWMgYm9vbCBn
bGtfZHNpX2VuYWJsZV9pbyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgc3Rh
dGljIHZvaWQgZ2xrX2RzaV9kZXZpY2VfcmVhZHkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNp
ICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWVu
dW0gcG9ydCBwb3J0Owo+ID4gICAJdTMyIHZhbDsKPiA+ICAgCS8qIFdhaXQgZm9yIE1JUEkgUEhZ
IHN0YXR1cyBiaXQgdG8gc2V0ICovCj4gPiAgIAlmb3JfZWFjaF9kc2lfcG9ydChwb3J0LCBpbnRl
bF9kc2ktPnBvcnRzKSB7Cj4gPiAtCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9w
cml2LT51bmNvcmUsCj4gPiArCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVu
Y29yZSwKPiA+ICAgCQkJCQkgICAgTUlQSV9DVFJMKHBvcnQpLAo+ID4gICAJCQkJCSAgICBHTEtf
UEhZX1NUQVRVU19QT1JUX1JFQURZLAo+ID4gICAJCQkJCSAgICBHTEtfUEhZX1NUQVRVU19QT1JU
X1JFQURZLAo+ID4gQEAgLTQxMyw3ICs0MTMsNyBAQCBzdGF0aWMgdm9pZCBnbGtfZHNpX2Rldmlj
ZV9yZWFkeShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgCQkJSTkxNV9XUklU
RShNSVBJX0RFVklDRV9SRUFEWShwb3J0KSwgdmFsKTsKPiA+ICAgCQkJLyogV2FpdCBmb3IgVUxQ
UyBhY3RpdmUgKi8KPiA+IC0JCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2
LT51bmNvcmUsCj4gPiArCQkJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNv
cmUsCj4gPiAgIAkJCQkJCSAgICBNSVBJX0NUUkwocG9ydCksCj4gPiAgIAkJCQkJCSAgICBHTEtf
VUxQU19OT1RfQUNUSVZFLAo+ID4gICAJCQkJCQkgICAgMCwKPiA+IEBAIC00NDAsNyArNDQwLDcg
QEAgc3RhdGljIHZvaWQgZ2xrX2RzaV9kZXZpY2VfcmVhZHkoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIpCj4gPiAgIAkvKiBXYWl0IGZvciBTdG9wIHN0YXRlICovCj4gPiAgIAlmb3JfZWFj
aF9kc2lfcG9ydChwb3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gPiAtCQlpZiAoaW50ZWxfd2Fp
dF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCQlpZiAoaW50ZWxfd2FpdF9m
b3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwKPiA+ICAgCQkJCQkgICAgTUlQSV9DVFJMKHBvcnQp
LAo+ID4gICAJCQkJCSAgICBHTEtfREFUQV9MQU5FX1NUT1BfU1RBVEUsCj4gPiAgIAkJCQkJICAg
IEdMS19EQVRBX0xBTkVfU1RPUF9TVEFURSwKPiA+IEBAIC00NTAsNyArNDUwLDcgQEAgc3RhdGlj
IHZvaWQgZ2xrX2RzaV9kZXZpY2VfcmVhZHkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIp
Cj4gPiAgIAkvKiBXYWl0IGZvciBBRkUgTEFUQ0ggKi8KPiA+ICAgCWZvcl9lYWNoX2RzaV9wb3J0
KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiA+IC0JCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdp
c3RlcigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rl
cigmaTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJCSAgICBCWFRfTUlQSV9QT1JUX0NUUkwocG9ydCks
Cj4gPiAgIAkJCQkJICAgIEFGRV9MQVRDSE9VVCwKPiA+ICAgCQkJCQkgICAgQUZFX0xBVENIT1VU
LAo+ID4gQEAgLTQ2MSw3ICs0NjEsNyBAQCBzdGF0aWMgdm9pZCBnbGtfZHNpX2RldmljZV9yZWFk
eShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgc3RhdGljIHZvaWQgYnh0X2Rz
aV9kZXZpY2VfcmVhZHkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+
IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBl
bmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0Owo+
ID4gICAJdTMyIHZhbDsKPiA+IEBAIC00ODgsMjEgKzQ4OCwyMSBAQCBzdGF0aWMgdm9pZCBieHRf
ZHNpX2RldmljZV9yZWFkeShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgc3Rh
dGljIHZvaWQgdmx2X2RzaV9kZXZpY2VfcmVhZHkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNp
ICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWVu
dW0gcG9ydCBwb3J0Owo+ID4gICAJdTMyIHZhbDsKPiA+ICAgCURSTV9ERUJVR19LTVMoIlxuIik7
Cj4gPiAtCXZsdl9mbGlzZHNpX2dldChkZXZfcHJpdik7Cj4gPiArCXZsdl9mbGlzZHNpX2dldChp
OTE1KTsKPiA+ICAgCS8qIHByb2dyYW0gcmNvbXAgZm9yIGNvbXBsaWFuY2UsIHJlZHVjZSBmcm9t
IDUwIG9obXMgdG8gNDUgb2htcwo+ID4gICAJICogbmVlZGVkIGV2ZXJ5dGltZSBhZnRlciBwb3dl
ciBnYXRlICovCj4gPiAtCXZsdl9mbGlzZHNpX3dyaXRlKGRldl9wcml2LCAweDA0LCAweDAwMDQp
Owo+ID4gLQl2bHZfZmxpc2RzaV9wdXQoZGV2X3ByaXYpOwo+ID4gKwl2bHZfZmxpc2RzaV93cml0
ZShpOTE1LCAweDA0LCAweDAwMDQpOwo+ID4gKwl2bHZfZmxpc2RzaV9wdXQoaTkxNSk7Cj4gPiAg
IAkvKiBiYW5kZ2FwIHJlc2V0IGlzIG5lZWRlZCBhZnRlciBldmVyeXRpbWUgd2UgZG8gcG93ZXIg
Z2F0ZSAqLwo+ID4gLQliYW5kX2dhcF9yZXNldChkZXZfcHJpdik7Cj4gPiArCWJhbmRfZ2FwX3Jl
c2V0KGk5MTUpOwo+ID4gICAJZm9yX2VhY2hfZHNpX3BvcnQocG9ydCwgaW50ZWxfZHNpLT5wb3J0
cykgewo+ID4gQEAgLTUyNywxMSArNTI3LDExIEBAIHN0YXRpYyB2b2lkIHZsdl9kc2lfZGV2aWNl
X3JlYWR5KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICBzdGF0aWMgdm9pZCBp
bnRlbF9kc2lfZGV2aWNlX3JlYWR5KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4g
ICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gLQlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJp
dikpCj4gPiArCWlmIChJU19HRU1JTklMQUtFKGk5MTUpKQo+ID4gICAJCWdsa19kc2lfZGV2aWNl
X3JlYWR5KGVuY29kZXIpOwo+ID4gLQllbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkKPiA+
ICsJZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiA+ICAgCQlieHRfZHNpX2RldmljZV9yZWFk
eShlbmNvZGVyKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQl2bHZfZHNpX2RldmljZV9yZWFkeShlbmNv
ZGVyKTsKPiA+IEBAIC01MzksNyArNTM5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX2Rldmlj
ZV9yZWFkeShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgc3RhdGljIHZvaWQg
Z2xrX2RzaV9lbnRlcl9sb3dfcG93ZXJfbW9kZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
cikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kg
KmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ID4gICAJZW51
bSBwb3J0IHBvcnQ7Cj4gPiAgIAl1MzIgdmFsOwo+ID4gQEAgLTU1NCw3ICs1NTQsNyBAQCBzdGF0
aWMgdm9pZCBnbGtfZHNpX2VudGVyX2xvd19wb3dlcl9tb2RlKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyKQo+ID4gICAJLyogV2FpdCBmb3IgTUlQSSBQSFkgc3RhdHVzIGJpdCB0byB1bnNl
dCAqLwo+ID4gICAJZm9yX2VhY2hfZHNpX3BvcnQocG9ydCwgaW50ZWxfZHNpLT5wb3J0cykgewo+
ID4gLQkJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ID4g
KwkJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gPiAgIAkJCQkJ
ICAgIE1JUElfQ1RSTChwb3J0KSwKPiA+ICAgCQkJCQkgICAgR0xLX1BIWV9TVEFUVVNfUE9SVF9S
RUFEWSwgMCwgMjApKQo+ID4gICAJCQlEUk1fRVJST1IoIlBIWSBpcyBub3QgdHVybmluZyBPRkZc
biIpOwo+ID4gQEAgLTU2Miw3ICs1NjIsNyBAQCBzdGF0aWMgdm9pZCBnbGtfZHNpX2VudGVyX2xv
d19wb3dlcl9tb2RlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICAJLyogV2Fp
dCBmb3IgUHdyIEFDSyBiaXQgdG8gdW5zZXQgKi8KPiA+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBv
cnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiA+IC0JCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rl
cigmZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcigm
aTkxNS0+dW5jb3JlLAo+ID4gICAJCQkJCSAgICBNSVBJX0NUUkwocG9ydCksCj4gPiAgIAkJCQkJ
ICAgIEdMS19NSVBJSU9fUE9SVF9QT1dFUkVELCAwLCAyMCkpCj4gPiAgIAkJCURSTV9FUlJPUigi
TUlQSSBJTyBQb3J0IGlzIG5vdCBwb3dlcmdhdGVkXG4iKTsKPiA+IEBAIC01NzEsNyArNTcxLDcg
QEAgc3RhdGljIHZvaWQgZ2xrX2RzaV9lbnRlcl9sb3dfcG93ZXJfbW9kZShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgc3RhdGljIHZvaWQgZ2xrX2RzaV9kaXNhYmxlX21pcGlf
aW8oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxf
ZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0Owo+ID4gICAJdTMyIHRt
cDsKPiA+IEBAIC01ODMsNyArNTgzLDcgQEAgc3RhdGljIHZvaWQgZ2xrX2RzaV9kaXNhYmxlX21p
cGlfaW8oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIAkvKiBXYWl0IGZvciBN
SVBJIFBIWSBzdGF0dXMgYml0IHRvIHVuc2V0ICovCj4gPiAgIAlmb3JfZWFjaF9kc2lfcG9ydChw
b3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gPiAtCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0
ZXIoJmRldl9wcml2LT51bmNvcmUsCj4gPiArCQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIo
Jmk5MTUtPnVuY29yZSwKPiA+ICAgCQkJCQkgICAgTUlQSV9DVFJMKHBvcnQpLAo+ID4gICAJCQkJ
CSAgICBHTEtfUEhZX1NUQVRVU19QT1JUX1JFQURZLCAwLCAyMCkpCj4gPiAgIAkJCURSTV9FUlJP
UigiUEhZIGlzIG5vdCB0dXJuaW5nIE9GRlxuIik7Cj4gPiBAQCAtNjA1LDE0ICs2MDUsMTQgQEAg
c3RhdGljIHZvaWQgZ2xrX2RzaV9jbGVhcl9kZXZpY2VfcmVhZHkoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIpCj4gPiAgIHN0YXRpYyB2b2lkIHZsdl9kc2lfY2xlYXJfZGV2aWNlX3JlYWR5
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2Rz
aSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+ICAgCURSTV9ERUJV
R19LTVMoIlxuIik7Cj4gPiAgIAlmb3JfZWFjaF9kc2lfcG9ydChwb3J0LCBpbnRlbF9kc2ktPnBv
cnRzKSB7Cj4gPiAgIAkJLyogQ29tbW9uIGJpdCBmb3IgYm90aCBNSVBJIFBvcnQgQSAmIE1JUEkg
UG9ydCBDIG9uIFZMVi9DSFYgKi8KPiA+IC0JCWk5MTVfcmVnX3QgcG9ydF9jdHJsID0gSVNfR0VO
OV9MUChkZXZfcHJpdikgPwo+ID4gKwkJaTkxNV9yZWdfdCBwb3J0X2N0cmwgPSBJU19HRU45X0xQ
KGk5MTUpID8KPiA+ICAgCQkJQlhUX01JUElfUE9SVF9DVFJMKHBvcnQpIDogTUlQSV9QT1JUX0NU
UkwoUE9SVF9BKTsKPiA+ICAgCQl1MzIgdmFsOwo+ID4gQEAgLTYzMiw4ICs2MzIsOCBAQCBzdGF0
aWMgdm9pZCB2bHZfZHNpX2NsZWFyX2RldmljZV9yZWFkeShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlcikKPiA+ICAgCQkgKiBPbiBWTFYvQ0hWLCB3YWl0IHRpbGwgQ2xvY2sgbGFuZXMgYXJl
IGluIExQLTAwIHN0YXRlIGZvciBNSVBJCj4gPiAgIAkJICogUG9ydCBBIG9ubHkuIE1JUEkgUG9y
dCBDIGhhcyBubyBzaW1pbGFyIGJpdCBmb3IgY2hlY2tpbmcuCj4gPiAgIAkJICovCj4gPiAtCQlp
ZiAoKElTX0dFTjlfTFAoZGV2X3ByaXYpIHx8IHBvcnQgPT0gUE9SVF9BKSAmJgo+ID4gLQkJICAg
IGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAo+ID4gKwkJaWYgKChJ
U19HRU45X0xQKGk5MTUpIHx8IHBvcnQgPT0gUE9SVF9BKSAmJgo+ID4gKwkJICAgIGludGVsX3dh
aXRfZm9yX3JlZ2lzdGVyKCZpOTE1LT51bmNvcmUsCj4gPiAgIAkJCQkJICAgIHBvcnRfY3RybCwg
QUZFX0xBVENIT1VULCAwLAo+ID4gICAJCQkJCSAgICAzMCkpCj4gPiAgIAkJCURSTV9FUlJPUigi
RFNJIExQIG5vdCBnb2luZyBMb3dcbiIpOwo+ID4gQEAgLTY1MSwxNCArNjUxLDE0IEBAIHN0YXRp
YyB2b2lkIHZsdl9kc2lfY2xlYXJfZGV2aWNlX3JlYWR5KHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyKQo+ID4gICBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfcG9ydF9lbmFibGUoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxf
ZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWVudW0gcG9ydCBwb3J0Owo+ID4gICAJaWYgKGlu
dGVsX2RzaS0+ZHVhbF9saW5rID09IERTSV9EVUFMX0xJTktfRlJPTlRfQkFDSykgewo+ID4gICAJ
CXUzMiB0ZW1wOwo+ID4gLQkJaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Cj4gPiArCQlpZiAo
SVNfR0VOOV9MUChpOTE1KSkgewo+ID4gICAJCQlmb3JfZWFjaF9kc2lfcG9ydChwb3J0LCBpbnRl
bF9kc2ktPnBvcnRzKSB7Cj4gPiAgIAkJCQl0ZW1wID0gSTkxNV9SRUFEKE1JUElfQ1RSTChwb3J0
KSk7Cj4gPiAgIAkJCQl0ZW1wICY9IH5CWFRfUElYRUxfT1ZFUkxBUF9DTlRfTUFTSyB8Cj4gPiBA
QCAtNjc2LDcgKzY3Niw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wb3J0X2VuYWJsZShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCX0KPiA+ICAgCWZvcl9lYWNoX2RzaV9w
b3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiA+IC0JCWk5MTVfcmVnX3QgcG9ydF9jdHJs
ID0gSVNfR0VOOV9MUChkZXZfcHJpdikgPwo+ID4gKwkJaTkxNV9yZWdfdCBwb3J0X2N0cmwgPSBJ
U19HRU45X0xQKGk5MTUpID8KPiA+ICAgCQkJQlhUX01JUElfUE9SVF9DVFJMKHBvcnQpIDogTUlQ
SV9QT1JUX0NUUkwocG9ydCk7Cj4gPiAgIAkJdTMyIHRlbXA7Cj4gPiBAQCAtNjg4LDcgKzY4OCw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wb3J0X2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPiA+ICAgCQlpZiAoaW50ZWxfZHNpLT5wb3J0cyA9PSAoQklUKFBPUlRfQSkg
fCBCSVQoUE9SVF9DKSkpIHsKPiA+ICAgCQkJdGVtcCB8PSAoaW50ZWxfZHNpLT5kdWFsX2xpbmsg
LSAxKQo+ID4gICAJCQkJCQk8PCBEVUFMX0xJTktfTU9ERV9TSElGVDsKPiA+IC0JCQlpZiAoSVNf
QlJPWFRPTihkZXZfcHJpdikpCj4gPiArCQkJaWYgKElTX0JST1hUT04oaTkxNSkpCj4gPiAgIAkJ
CQl0ZW1wIHw9IExBTkVfQ09ORklHVVJBVElPTl9EVUFMX0xJTktfQTsKPiA+ICAgCQkJZWxzZQo+
ID4gICAJCQkJdGVtcCB8PSBjcnRjLT5waXBlID8KPiA+IEBAIC03MDgsMTIgKzcwOCwxMiBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9kc2lfcG9ydF9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4gPiAgIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wb3J0X2Rpc2FibGUoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYgPSBlbmNvZGVyLT5iYXNlLmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVu
Y190b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+ID4gICAJZW51bSBwb3J0IHBvcnQ7Cj4g
PiAgIAlmb3JfZWFjaF9kc2lfcG9ydChwb3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gPiAtCQlp
OTE1X3JlZ190IHBvcnRfY3RybCA9IElTX0dFTjlfTFAoZGV2X3ByaXYpID8KPiA+ICsJCWk5MTVf
cmVnX3QgcG9ydF9jdHJsID0gSVNfR0VOOV9MUChpOTE1KSA/Cj4gPiAgIAkJCUJYVF9NSVBJX1BP
UlRfQ1RSTChwb3J0KSA6IE1JUElfUE9SVF9DVFJMKHBvcnQpOwo+ID4gICAJCXUzMiB0ZW1wOwo+
ID4gQEAgLTc3NSw3ICs3NzUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfcHJlX2VuYWJsZShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgewo+ID4gICAJc3RydWN0IGludGVs
X2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAg
IAlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBwaXBlX2NvbmZpZy0+YmFzZS5jcnRjOwo+ID4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmRldik7Cj4g
PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+
ID4gICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMp
Owo+ID4gICAJaW50IHBpcGUgPSBpbnRlbF9jcnRjLT5waXBlOwo+ID4gICAJZW51bSBwb3J0IHBv
cnQ7Cj4gPiBAQCAtNzg0LDEzICs3ODQsMTMgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX3ByZV9l
bmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAlEUk1fREVCVUdfS01T
KCJcbiIpOwo+ID4gLQlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9w
cml2LCBwaXBlLCB0cnVlKTsKPiA+ICsJaW50ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9y
dGluZyhpOTE1LCBwaXBlLCB0cnVlKTsKPiA+ICAgCS8qCj4gPiAgIAkgKiBUaGUgQklPUyBtYXkg
bGVhdmUgdGhlIFBMTCBpbiBhIHdvbmt5IHN0YXRlIHdoZXJlIGl0IGRvZXNuJ3QKPiA+ICAgCSAq
IGxvY2suIEl0IG5lZWRzIHRvIGJlIGZ1bGx5IHBvd2VyZWQgZG93biB0byBmaXggaXQuCj4gPiAg
IAkgKi8KPiA+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19HRU45
X0xQKGk5MTUpKSB7Cj4gPiAgIAkJYnh0X2RzaV9wbGxfZGlzYWJsZShlbmNvZGVyKTsKPiA+ICAg
CQlieHRfZHNpX3BsbF9lbmFibGUoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+ID4gICAJfSBlbHNl
IHsKPiA+IEBAIC03OTgsNyArNzk4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX3ByZV9lbmFi
bGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJdmx2X2RzaV9wbGxfZW5h
YmxlKGVuY29kZXIsIHBpcGVfY29uZmlnKTsKPiA+ICAgCX0KPiA+IC0JaWYgKElTX0JST1hUT04o
ZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19CUk9YVE9OKGk5MTUpKSB7Cj4gPiAgIAkJLyogQWRk
IE1JUEkgSU8gcmVzZXQgcHJvZ3JhbW1pbmcgZm9yIG1vZGVzZXQgKi8KPiA+ICAgCQl2YWwgPSBJ
OTE1X1JFQUQoQlhUX1BfQ1JfR1RfRElTUF9QV1JPTik7Cj4gPiAgIAkJSTkxNV9XUklURShCWFRf
UF9DUl9HVF9ESVNQX1BXUk9OLAo+ID4gQEAgLTgwOSw3ICs4MDksNyBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9kc2lfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAg
CQlJOTE1X1dSSVRFKEJYVF9QX0RTSV9SRUdVTEFUT1JfVFhfQ1RSTCwgMCk7Cj4gPiAgIAl9Cj4g
PiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2
KSkgewo+ID4gKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUp
KSB7Cj4gPiAgIAkJdTMyIHZhbDsKPiA+ICAgCQkvKiBEaXNhYmxlIERQT3VuaXQgY2xvY2sgZ2F0
aW5nLCBjYW4gc3RhbGwgcGlwZSAqLwo+ID4gQEAgLTgxOCw3ICs4MTgsNyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9kc2lfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+
ICAgCQlJOTE1X1dSSVRFKERTUENMS19HQVRFX0QsIHZhbCk7Cj4gPiAgIAl9Cj4gPiAtCWlmICgh
SVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4gPiArCWlmICghSVNfR0VNSU5JTEFLRShpOTE1KSkK
PiA+ICAgCQlpbnRlbF9kc2lfcHJlcGFyZShlbmNvZGVyLCBwaXBlX2NvbmZpZyk7Cj4gPiAgIAkv
KiBQb3dlciBvbiwgdHJ5IGJvdGggQ1JDIHBtaWMgZ3BpbyBhbmQgVkJUICovCj4gPiBAQCAtODMw
LDcgKzgzMCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJLyogRGVhc3NlcnQgcmVzZXQgKi8KPiA+ICAgCWlu
dGVsX2RzaV92YnRfZXhlY19zZXF1ZW5jZShpbnRlbF9kc2ksIE1JUElfU0VRX0RFQVNTRVJUX1JF
U0VUKTsKPiA+IC0JaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19H
RU1JTklMQUtFKGk5MTUpKSB7Cj4gPiAgIAkJZ2xrX2NvbGRfYm9vdCA9IGdsa19kc2lfZW5hYmxl
X2lvKGVuY29kZXIpOwo+ID4gICAJCS8qIFByZXBhcmUgcG9ydCBpbiBjb2xkIGJvb3QoczMvczQp
IHNjZW5hcmlvICovCj4gPiBAQCAtODQyLDcgKzg0Miw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rz
aV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJaW50ZWxf
ZHNpX2RldmljZV9yZWFkeShlbmNvZGVyKTsKPiA+ICAgCS8qIFByZXBhcmUgcG9ydCBpbiBub3Jt
YWwgYm9vdCBzY2VuYXJpbyAqLwo+ID4gLQlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgJiYg
IWdsa19jb2xkX2Jvb3QpCj4gPiArCWlmIChJU19HRU1JTklMQUtFKGk5MTUpICYmICFnbGtfY29s
ZF9ib290KQo+ID4gICAJCWludGVsX2RzaV9wcmVwYXJlKGVuY29kZXIsIHBpcGVfY29uZmlnKTsK
PiA+ICAgCS8qIFNlbmQgaW5pdGlhbGl6YXRpb24gY29tbWFuZHMgaW4gTFAgbW9kZSAqLwo+ID4g
QEAgLTkwMSw5ICs5MDEsOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfZGlzYWJsZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX2NsZWFy
X2RldmljZV9yZWFkeShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4g
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPiA+IC0JaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQo+ID4g
KwlpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkKPiA+ICAgCQlnbGtfZHNpX2NsZWFyX2RldmljZV9y
ZWFkeShlbmNvZGVyKTsKPiA+ICAgCWVsc2UKPiA+ICAgCQl2bHZfZHNpX2NsZWFyX2RldmljZV9y
ZWFkeShlbmNvZGVyKTsKPiA+IEBAIC05MTMsNyArOTEzLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxf
ZHNpX3Bvc3RfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJ
CSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPiA+ICAgCQkJ
CSAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+ID4gICB7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNp
ID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAllbnVtIHBvcnQgcG9y
dDsKPiA+ICAgCXUzMiB2YWw7Cj4gPiBAQCAtOTQxLDcgKzk0MSw3IEBAIHN0YXRpYyB2b2lkIGlu
dGVsX2RzaV9wb3N0X2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAg
IAkvKiBUcmFuc2l0aW9uIHRvIExQLTAwICovCj4gPiAgIAlpbnRlbF9kc2lfY2xlYXJfZGV2aWNl
X3JlYWR5KGVuY29kZXIpOwo+ID4gLQlpZiAoSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKPiA+ICsJ
aWYgKElTX0JST1hUT04oaTkxNSkpIHsKPiA+ICAgCQkvKiBQb3dlciBkb3duIERTSSByZWd1bGF0
b3IgdG8gc2F2ZSBwb3dlciAqLwo+ID4gICAJCUk5MTVfV1JJVEUoQlhUX1BfRFNJX1JFR1VMQVRP
Ul9DRkcsIFNUQVBfU0VMRUNUKTsKPiA+ICAgCQlJOTE1X1dSSVRFKEJYVF9QX0RTSV9SRUdVTEFU
T1JfVFhfQ1RSTCwgSFNfSU9fQ1RSTF9TRUxFQ1QpOwo+ID4gQEAgLTk1Miw3ICs5NTIsNyBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9kc2lfcG9zdF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAo+ID4gICAJCQkJdmFsICYgfk1JUElPX1JTVF9DVFJMKTsKPiA+ICAgCX0KPiA+IC0J
aWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19HRU45X0xQKGk5MTUpKSB7
Cj4gPiAgIAkJYnh0X2RzaV9wbGxfZGlzYWJsZShlbmNvZGVyKTsKPiA+ICAgCX0gZWxzZSB7Cj4g
PiAgIAkJdTMyIHZhbDsKPiA+IEBAIC05ODMsNyArOTgzLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxf
ZHNpX3Bvc3RfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgc3Rh
dGljIGJvb2wgaW50ZWxfZHNpX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPiA+ICAgCQkJCSAgIGVudW0gcGlwZSAqcGlwZSkKPiA+ICAgewo+ID4gLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRl
bF9kc2koJmVuY29kZXItPmJhc2UpOwo+ID4gICAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4g
PiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+IEBAIC05OTEsNyArOTkxLDcgQEAgc3RhdGljIGJvb2wg
aW50ZWxfZHNpX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+
ICAgCURSTV9ERUJVR19LTVMoIlxuIik7Cj4gPiAtCXdha2VyZWYgPSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2dldF9pZl9lbmFibGVkKGRldl9wcml2LAo+ID4gKwl3YWtlcmVmID0gaW50ZWxfZGlzcGxh
eV9wb3dlcl9nZXRfaWZfZW5hYmxlZChpOTE1LAo+ID4gICAJCQkJCQkgICAgIGVuY29kZXItPnBv
d2VyX2RvbWFpbik7Cj4gPiAgIAlpZiAoIXdha2VyZWYpCj4gPiAgIAkJcmV0dXJuIGZhbHNlOwo+
ID4gQEAgLTEwMDEsMTIgKzEwMDEsMTIgQEAgc3RhdGljIGJvb2wgaW50ZWxfZHNpX2dldF9od19z
dGF0ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCSAqIGNvbmZpZ3VyYXRp
b24sIG90aGVyd2lzZSBhY2Nlc3NpbmcgRFNJIHJlZ2lzdGVycyB3aWxsIGhhbmcgdGhlCj4gPiAg
IAkgKiBtYWNoaW5lLiBTZWUgQlNwZWMgTm9ydGggRGlzcGxheSBFbmdpbmUgcmVnaXN0ZXJzL01J
UElbQlhUXS4KPiA+ICAgCSAqLwo+ID4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikgJiYgIWJ4
dF9kc2lfcGxsX2lzX2VuYWJsZWQoZGV2X3ByaXYpKQo+ID4gKwlpZiAoSVNfR0VOOV9MUChpOTE1
KSAmJiAhYnh0X2RzaV9wbGxfaXNfZW5hYmxlZChpOTE1KSkKPiA+ICAgCQlnb3RvIG91dF9wdXRf
cG93ZXI7Cj4gPiAgIAkvKiBYWFg6IHRoaXMgb25seSB3b3JrcyBmb3Igb25lIERTSSBvdXRwdXQg
Ki8KPiA+ICAgCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsKPiA+
IC0JCWk5MTVfcmVnX3QgY3RybF9yZWcgPSBJU19HRU45X0xQKGRldl9wcml2KSA/Cj4gPiArCQlp
OTE1X3JlZ190IGN0cmxfcmVnID0gSVNfR0VOOV9MUChpOTE1KSA/Cj4gPiAgIAkJCUJYVF9NSVBJ
X1BPUlRfQ1RSTChwb3J0KSA6IE1JUElfUE9SVF9DVFJMKHBvcnQpOwo+ID4gICAJCWJvb2wgZW5h
YmxlZCA9IEk5MTVfUkVBRChjdHJsX3JlZykgJiBEUElfRU5BQkxFOwo+ID4gQEAgLTEwMTUsNyAr
MTAxNSw3IEBAIHN0YXRpYyBib29sIGludGVsX2RzaV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkJICogYml0IGluIHBvcnQgQyBjb250cm9sIHJlZ2lz
dGVyIGRvZXMgbm90IGdldCBzZXQuIEFzIGEKPiA+ICAgCQkgKiB3b3JrYXJvdW5kLCBjaGVjayBw
aXBlIEIgY29uZiBpbnN0ZWFkLgo+ID4gICAJCSAqLwo+ID4gLQkJaWYgKChJU19WQUxMRVlWSUVX
KGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgJiYKPiA+ICsJCWlmICgoSVNf
VkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKSAmJgo+ID4gICAJCSAgICBw
b3J0ID09IFBPUlRfQykKPiA+ICAgCQkJZW5hYmxlZCA9IEk5MTVfUkVBRChQSVBFQ09ORihQSVBF
X0IpKSAmIFBJUEVDT05GX0VOQUJMRTsKPiA+IEBAIC0xMDMxLDcgKzEwMzEsNyBAQCBzdGF0aWMg
Ym9vbCBpbnRlbF9kc2lfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+ID4gICAJCWlmICghKEk5MTVfUkVBRChNSVBJX0RFVklDRV9SRUFEWShwb3J0KSkgJiBERVZJ
Q0VfUkVBRFkpKQo+ID4gICAJCQljb250aW51ZTsKPiA+IC0JCWlmIChJU19HRU45X0xQKGRldl9w
cml2KSkgewo+ID4gKwkJaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKPiA+ICAgCQkJdTMyIHRtcCA9
IEk5MTVfUkVBRChNSVBJX0NUUkwocG9ydCkpOwo+ID4gICAJCQl0bXAgJj0gQlhUX1BJUEVfU0VM
RUNUX01BU0s7Cj4gPiAgIAkJCXRtcCA+Pj0gQlhUX1BJUEVfU0VMRUNUX1NISUZUOwo+ID4gQEAg
LTEwNDksNyArMTA0OSw3IEBAIHN0YXRpYyBib29sIGludGVsX2RzaV9nZXRfaHdfc3RhdGUoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAl9Cj4gPiAgIG91dF9wdXRfcG93ZXI6
Cj4gPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBlbmNvZGVyLT5wb3dlcl9k
b21haW4sIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBlbmNv
ZGVyLT5wb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ID4gICAJcmV0dXJuIGFjdGl2ZTsKPiA+ICAg
fQo+ID4gQEAgLTEwNTgsNyArMTA1OCw3IEBAIHN0YXRpYyB2b2lkIGJ4dF9kc2lfZ2V0X3BpcGVf
Y29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQkJICAgIHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPiA+ICAgewo+ID4gICAJc3RydWN0IGRy
bV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwo+ID4gICAJc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKmFkanVzdGVkX21vZGUgPQo+ID4gICAJCQkJCSZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3Rl
ZF9tb2RlOwo+ID4gICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGVfc3c7
Cj4gPiBAQCAtMTIxOCwxMyArMTIxOCwxMyBAQCBzdGF0aWMgdm9pZCBieHRfZHNpX2dldF9waXBl
X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgc3RhdGljIHZvaWQg
aW50ZWxfZHNpX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAg
IAkJCQkgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+ID4gICB7Cj4gPiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5j
b2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJdTMyIHBjbGs7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJc
biIpOwo+ID4gICAJcGlwZV9jb25maWctPm91dHB1dF90eXBlcyB8PSBCSVQoSU5URUxfT1VUUFVU
X0RTSSk7Cj4gPiAtCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfR0VO
OV9MUChpOTE1KSkgewo+ID4gICAJCWJ4dF9kc2lfZ2V0X3BpcGVfY29uZmlnKGVuY29kZXIsIHBp
cGVfY29uZmlnKTsKPiA+ICAgCQlwY2xrID0gYnh0X2RzaV9nZXRfcGNsayhlbmNvZGVyLCBwaXBl
X2NvbmZpZyk7Cj4gPiAgIAl9IGVsc2Ugewo+ID4gQEAgLTEyNTUsNyArMTI1NSw3IEBAIHN0YXRp
YyB2b2lkIHNldF9kc2lfdGltaW5ncyhzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIsCj4gPiAg
IAkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSkKPiA+
ICAgewo+ID4gICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmRldjsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVj
dCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2koZW5jb2Rlcik7Cj4gPiAg
IAllbnVtIHBvcnQgcG9ydDsKPiA+ICAgCXVuc2lnbmVkIGludCBicHAgPSBtaXBpX2RzaV9waXhl
bF9mb3JtYXRfdG9fYnBwKGludGVsX2RzaS0+cGl4ZWxfZm9ybWF0KTsKPiA+IEBAIC0xMjkwLDcg
KzEyOTAsNyBAQCBzdGF0aWMgdm9pZCBzZXRfZHNpX3RpbWluZ3Moc3RydWN0IGRybV9lbmNvZGVy
ICplbmNvZGVyLAo+ID4gICAJaGJwID0gdHhieXRlY2xraHMoaGJwLCBicHAsIGxhbmVfY291bnQs
IGludGVsX2RzaS0+YnVyc3RfbW9kZV9yYXRpbyk7Cj4gPiAgIAlmb3JfZWFjaF9kc2lfcG9ydChw
b3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gPiAtCQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikp
IHsKPiA+ICsJCWlmIChJU19HRU45X0xQKGk5MTUpKSB7Cj4gPiAgIAkJCS8qCj4gPiAgIAkJCSAq
IFByb2dyYW0gaGRpc3BsYXkgYW5kIHZkaXNwbGF5IG9uIE1JUEkgdHJhbnNjb2Rlci4KPiA+ICAg
CQkJICogVGhpcyBpcyBkaWZmZXJlbnQgZnJvbSBjYWxjdWxhdGVkIGhhY3RpdmUgYW5kCj4gPiBA
QCAtMTM0Miw3ICsxMzQyLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX3ByZXBhcmUoc3RydWN0
IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCj4gPiAgIHsKPiA+ICAgCXN0cnVjdCBkcm1f
ZW5jb2RlciAqZW5jb2RlciA9ICZpbnRlbF9lbmNvZGVyLT5iYXNlOwo+ID4gICAJc3RydWN0IGRy
bV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmRldjsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9j
cnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPiA+ICAgCXN0cnVj
dCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2koZW5jb2Rlcik7Cj4gPiAg
IAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2Nv
bmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+ID4gQEAgLTEzNjIsNyArMTM2Miw3IEBAIHN0YXRp
YyB2b2lkIGludGVsX2RzaV9wcmVwYXJlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNv
ZGVyLAo+ID4gICAJfQo+ID4gICAJZm9yX2VhY2hfZHNpX3BvcnQocG9ydCwgaW50ZWxfZHNpLT5w
b3J0cykgewo+ID4gLQkJaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpKSB7Cj4gPiArCQlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVS
UllWSUVXKGk5MTUpKSB7Cj4gPiAgIAkJCS8qCj4gPiAgIAkJCSAqIGVzY2FwZSBjbG9jayBkaXZp
ZGVyLCAyME1Ieiwgc2hhcmVkIGZvciBBIGFuZCBDLgo+ID4gICAJCQkgKiBkZXZpY2UgcmVhZHkg
bXVzdCBiZSBvZmYgd2hlbiBkb2luZyB0aGlzISB0eGNsa2VzYz8KPiA+IEBAIC0xMzc3LDcgKzEz
NzcsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfcHJlcGFyZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqaW50ZWxfZW5jb2RlciwKPiA+ICAgCQkJdG1wICY9IH5SRUFEX1JFUVVFU1RfUFJJT1JJVFlf
TUFTSzsKPiA+ICAgCQkJSTkxNV9XUklURShNSVBJX0NUUkwocG9ydCksIHRtcCB8Cj4gPiAgIAkJ
CQkJUkVBRF9SRVFVRVNUX1BSSU9SSVRZX0hJR0gpOwo+ID4gLQkJfSBlbHNlIGlmIChJU19HRU45
X0xQKGRldl9wcml2KSkgewo+ID4gKwkJfSBlbHNlIGlmIChJU19HRU45X0xQKGk5MTUpKSB7Cj4g
PiAgIAkJCWVudW0gcGlwZSBwaXBlID0gaW50ZWxfY3J0Yy0+cGlwZTsKPiA+ICAgCQkJdG1wID0g
STkxNV9SRUFEKE1JUElfQ1RSTChwb3J0KSk7Cj4gPiBAQCAtMTQxNSw3ICsxNDE1LDcgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZHNpX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2Vu
Y29kZXIsCj4gPiAgIAlpZiAoaW50ZWxfZHNpLT5jbG9ja19zdG9wKQo+ID4gICAJCXRtcCB8PSBD
TE9DS1NUT1A7Cj4gPiAtCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNf
R0VOOV9MUChpOTE1KSkgewo+ID4gICAJCXRtcCB8PSBCWFRfRFBIWV9ERUZFQVRVUkVfRU47Cj4g
PiAgIAkJaWYgKCFpc19jbWRfbW9kZShpbnRlbF9kc2kpKQo+ID4gICAJCQl0bXAgfD0gQlhUX0RF
RkVBVFVSRV9EUElfRklGT19DVFI7Cj4gPiBAQCAtMTQ2Niw3ICsxNDY2LDcgQEAgc3RhdGljIHZv
aWQgaW50ZWxfZHNpX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIs
Cj4gPiAgIAkJSTkxNV9XUklURShNSVBJX0lOSVRfQ09VTlQocG9ydCksCj4gPiAgIAkJCQl0eGNs
a2VzYyhpbnRlbF9kc2ktPmVzY2FwZV9jbGtfZGl2LCAxMDApKTsKPiA+IC0JCWlmIChJU19HRU45
X0xQKGRldl9wcml2KSAmJiAoIWludGVsX2RzaS0+ZHVhbF9saW5rKSkgewo+ID4gKwkJaWYgKElT
X0dFTjlfTFAoaTkxNSkgJiYgKCFpbnRlbF9kc2ktPmR1YWxfbGluaykpIHsKPiA+ICAgCQkJLyoK
PiA+ICAgCQkJICogQlhUIHNwZWMgc2F5cyB3cml0ZSBNSVBJX0lOSVRfQ09VTlQgZm9yCj4gPiAg
IAkJCSAqIGJvdGggdGhlIHBvcnRzLCBldmVuIGlmIG9ubHkgb25lIGlzCj4gPiBAQCAtMTUwMCw3
ICsxNTAwLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX3ByZXBhcmUoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmludGVsX2VuY29kZXIsCj4gPiAgIAkJICovCj4gPiAgIAkJSTkxNV9XUklURShNSVBJ
X0xQX0JZVEVDTEsocG9ydCksIGludGVsX2RzaS0+bHBfYnl0ZV9jbGspOwo+ID4gLQkJaWYgKElT
X0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Cj4gPiArCQlpZiAoSVNfR0VNSU5JTEFLRShpOTE1KSkg
ewo+ID4gICAJCQlJOTE1X1dSSVRFKE1JUElfVExQWF9USU1FX0NPVU5UKHBvcnQpLAo+ID4gICAJ
CQkJCWludGVsX2RzaS0+bHBfYnl0ZV9jbGspOwo+ID4gICAJCQkvKiBTaGFkb3cgb2YgRFBIWSBy
ZWcgKi8KPiA+IEBAIC0xNTMzLDE5ICsxNTMzLDE5IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9w
cmVwYXJlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRlbF9lbmNvZGVyLAo+ID4gICBzdGF0aWMg
dm9pZCBpbnRlbF9kc2lfdW5wcmVwYXJlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAqaW50
ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAllbnVtIHBv
cnQgcG9ydDsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAtCWlmIChJU19HRU1JTklMQUtFKGRldl9wcml2
KSkKPiA+ICsJaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkpCj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJ
Zm9yX2VhY2hfZHNpX3BvcnQocG9ydCwgaW50ZWxfZHNpLT5wb3J0cykgewo+ID4gICAJCS8qIFBh
bmVsIGNvbW1hbmRzIGNhbiBiZSBzZW50IHdoZW4gY2xvY2sgaXMgaW4gTFAxMSAqLwo+ID4gICAJ
CUk5MTVfV1JJVEUoTUlQSV9ERVZJQ0VfUkVBRFkocG9ydCksIDB4MCk7Cj4gPiAtCQlpZiAoSVNf
R0VOOV9MUChkZXZfcHJpdikpCj4gPiArCQlpZiAoSVNfR0VOOV9MUChpOTE1KSkKPiA+ICAgCQkJ
Ynh0X2RzaV9yZXNldF9jbG9ja3MoZW5jb2RlciwgcG9ydCk7Cj4gPiAgIAkJZWxzZQo+ID4gICAJ
CQl2bHZfZHNpX3Jlc2V0X2Nsb2NrcyhlbmNvZGVyLCBwb3J0KTsKPiA+IEBAIC0xNTk0LDcgKzE1
OTQsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3JfZnVuY3MgaW50ZWxfZHNp
X2Nvbm5lY3Rvcl9mdW5jcyA9IHsKPiA+ICAgc3RhdGljIGVudW0gZHJtX3BhbmVsX29yaWVudGF0
aW9uCj4gPiAgIHZsdl9kc2lfZ2V0X2h3X3BhbmVsX29yaWVudGF0aW9uKHN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvcikKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4g
PiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciA9IGNvbm5lY3Rvci0+ZW5jb2RlcjsK
PiA+ICAgCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gcG93ZXJfZG9tYWluOwo+ID4g
ICAJZW51bSBkcm1fcGFuZWxfb3JpZW50YXRpb24gb3JpZW50YXRpb247Cj4gPiBAQCAtMTYwNywx
MSArMTYwNywxMSBAQCB2bHZfZHNpX2dldF9od19wYW5lbF9vcmllbnRhdGlvbihzdHJ1Y3QgaW50
ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIAlpZiAoIWVuY29kZXItPmdldF9od19zdGF0
ZShlbmNvZGVyLCAmcGlwZSkpCj4gPiAgIAkJcmV0dXJuIERSTV9NT0RFX1BBTkVMX09SSUVOVEFU
SU9OX1VOS05PV047Cj4gPiAtCWNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJp
diwgcGlwZSk7Cj4gPiArCWNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGlwZShpOTE1LCBwaXBl
KTsKPiA+ICAgCXBsYW5lID0gdG9faW50ZWxfcGxhbmUoY3J0Yy0+YmFzZS5wcmltYXJ5KTsKPiA+
ICAgCXBvd2VyX2RvbWFpbiA9IFBPV0VSX0RPTUFJTl9QSVBFKHBpcGUpOwo+ID4gLQl3YWtlcmVm
ID0gaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJfZG9t
YWluKTsKPiA+ICsJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQo
aTkxNSwgcG93ZXJfZG9tYWluKTsKPiA+ICAgCWlmICghd2FrZXJlZikKPiA+ICAgCQlyZXR1cm4g
RFJNX01PREVfUEFORUxfT1JJRU5UQVRJT05fVU5LTk9XTjsKPiA+IEBAIC0xNjI0LDcgKzE2MjQs
NyBAQCB2bHZfZHNpX2dldF9od19wYW5lbF9vcmllbnRhdGlvbihzdHJ1Y3QgaW50ZWxfY29ubmVj
dG9yICpjb25uZWN0b3IpCj4gPiAgIAllbHNlCj4gPiAgIAkJb3JpZW50YXRpb24gPSBEUk1fTU9E
RV9QQU5FTF9PUklFTlRBVElPTl9OT1JNQUw7Cj4gPiAtCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0
KGRldl9wcml2LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ID4gKwlpbnRlbF9kaXNwbGF5X3Bv
d2VyX3B1dChpOTE1LCBwb3dlcl9kb21haW4sIHdha2VyZWYpOwo+ID4gICAJcmV0dXJuIG9yaWVu
dGF0aW9uOwo+ID4gICB9Cj4gPiBAQCAtMTYzMiwxMCArMTYzMiwxMCBAQCB2bHZfZHNpX2dldF9o
d19wYW5lbF9vcmllbnRhdGlvbihzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4g
PiAgIHN0YXRpYyBlbnVtIGRybV9wYW5lbF9vcmllbnRhdGlvbgo+ID4gICB2bHZfZHNpX2dldF9w
YW5lbF9vcmllbnRhdGlvbihzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAg
IHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjb25u
ZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJZW51bSBkcm1fcGFuZWxfb3JpZW50
YXRpb24gb3JpZW50YXRpb247Cj4gPiAtCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJ
U19DSEVSUllWSUVXKGRldl9wcml2KSkgewo+ID4gKwlpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSB8
fCBJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiAgIAkJb3JpZW50YXRpb24gPSB2bHZfZHNpX2dl
dF9od19wYW5lbF9vcmllbnRhdGlvbihjb25uZWN0b3IpOwo+ID4gICAJCWlmIChvcmllbnRhdGlv
biAhPSBEUk1fTU9ERV9QQU5FTF9PUklFTlRBVElPTl9VTktOT1dOKQo+ID4gICAJCQlyZXR1cm4g
b3JpZW50YXRpb247Cj4gPiBAQCAtMTY0NiwxMyArMTY0NiwxMyBAQCB2bHZfZHNpX2dldF9wYW5l
bF9vcmllbnRhdGlvbihzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpCj4gPiAgIHN0
YXRpYyB2b2lkIGludGVsX2RzaV9hZGRfcHJvcGVydGllcyhzdHJ1Y3QgaW50ZWxfY29ubmVjdG9y
ICpjb25uZWN0b3IpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+ID4gICAJaWYg
KGNvbm5lY3Rvci0+cGFuZWwuZml4ZWRfbW9kZSkgewo+ID4gICAJCXUzMiBhbGxvd2VkX3NjYWxl
cnM7Cj4gPiAgIAkJYWxsb3dlZF9zY2FsZXJzID0gQklUKERSTV9NT0RFX1NDQUxFX0FTUEVDVCkg
fCBCSVQoRFJNX01PREVfU0NBTEVfRlVMTFNDUkVFTik7Cj4gPiAtCQlpZiAoIUhBU19HTUNIKGRl
dl9wcml2KSkKPiA+ICsJCWlmICghSEFTX0dNQ0goaTkxNSkpCj4gPiAgIAkJCWFsbG93ZWRfc2Nh
bGVycyB8PSBCSVQoRFJNX01PREVfU0NBTEVfQ0VOVEVSKTsKPiA+ICAgCQlkcm1fY29ubmVjdG9y
X2F0dGFjaF9zY2FsaW5nX21vZGVfcHJvcGVydHkoJmNvbm5lY3Rvci0+YmFzZSwKPiA+IEBAIC0x
Njc5LDggKzE2NzksOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfYWRkX3Byb3BlcnRpZXMoc3Ry
dWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQo+ID4gICBzdGF0aWMgdm9pZCB2bHZfZHBo
eV9wYXJhbV9pbml0KHN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSkKPiA+ICAgewo+ID4gICAJ
c3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVsX2RzaS0+YmFzZS5iYXNlLmRldjsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gLQlz
dHJ1Y3QgbWlwaV9jb25maWcgKm1pcGlfY29uZmlnID0gZGV2X3ByaXYtPnZidC5kc2kuY29uZmln
Owo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+
ICsJc3RydWN0IG1pcGlfY29uZmlnICptaXBpX2NvbmZpZyA9IGk5MTUtPnZidC5kc2kuY29uZmln
Owo+ID4gICAJdTMyIHRscHhfbnMsIGV4dHJhX2J5dGVfY291bnQsIHRscHhfdWk7Cj4gPiAgIAl1
MzIgdWlfbnVtLCB1aV9kZW47Cj4gPiAgIAl1MzIgcHJlcGFyZV9jbnQsIGV4aXRfemVyb19jbnQs
IGNsa196ZXJvX2NudCwgdHJhaWxfY250Owo+ID4gQEAgLTE3MjcsNyArMTcyNyw3IEBAIHN0YXRp
YyB2b2lkIHZsdl9kcGh5X3BhcmFtX2luaXQoc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpKQo+
ID4gICAJICogRm9yIEdFTUlOSUxBS0UgZHBoeV9wYXJhbV9yZWcgd2lsbCBiZSBwcm9ncmFtbWVk
IGluIHRlcm1zIG9mCj4gPiAgIAkgKiBIUyBieXRlIGNsb2NrIGNvdW50IGZvciBvdGhlciBwbGF0
Zm9ybSBpbiBIUyBkZHIgY2xvY2sgY291bnQKPiA+ICAgCSAqLwo+ID4gLQltdWwgPSBJU19HRU1J
TklMQUtFKGRldl9wcml2KSA/IDggOiAyOwo+ID4gKwltdWwgPSBJU19HRU1JTklMQUtFKGk5MTUp
ID8gOCA6IDI7Cj4gPiAgIAl0aHNfcHJlcGFyZV9ucyA9IG1heChtaXBpX2NvbmZpZy0+dGhzX3By
ZXBhcmUsCj4gPiAgIAkJCSAgICAgbWlwaV9jb25maWctPnRjbGtfcHJlcGFyZSk7Cj4gPiBAQCAt
MTgzNyw5ICsxODM3LDkgQEAgc3RhdGljIHZvaWQgdmx2X2RwaHlfcGFyYW1faW5pdChzdHJ1Y3Qg
aW50ZWxfZHNpICppbnRlbF9kc2kpCj4gPiAgIAlpbnRlbF9kc2lfbG9nX3BhcmFtcyhpbnRlbF9k
c2kpOwo+ID4gICB9Cj4gPiAtdm9pZCB2bHZfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQo+ID4gK3ZvaWQgdmx2X2RzaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3By
aXYtPmRybTsKPiA+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZpOTE1LT5kcm07Cj4gPiAg
IAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2k7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqaW50ZWxfZW5jb2RlcjsKPiA+ICAgCXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcjsKPiA+
IEBAIC0xODUxLDEzICsxODUxLDEzIEBAIHZvaWQgdmx2X2RzaV9pbml0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiA+ICAgCURSTV9ERUJVR19LTVMoIlxuIik7Cj4gPiAgIAkv
KiBUaGVyZSBpcyBubyBkZXRlY3Rpb24gbWV0aG9kIGZvciBNSVBJIHNvIHJlbHkgb24gVkJUICov
Cj4gPiAtCWlmICghaW50ZWxfYmlvc19pc19kc2lfcHJlc2VudChkZXZfcHJpdiwgJnBvcnQpKQo+
ID4gKwlpZiAoIWludGVsX2Jpb3NfaXNfZHNpX3ByZXNlbnQoaTkxNSwgJnBvcnQpKQo+ID4gICAJ
CXJldHVybjsKPiA+IC0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQo+ID4gLQkJZGV2X3ByaXYt
Pm1pcGlfbW1pb19iYXNlID0gQlhUX01JUElfQkFTRTsKPiA+ICsJaWYgKElTX0dFTjlfTFAoaTkx
NSkpCj4gPiArCQlpOTE1LT5taXBpX21taW9fYmFzZSA9IEJYVF9NSVBJX0JBU0U7Cj4gPiAgIAll
bHNlCj4gPiAtCQlkZXZfcHJpdi0+bWlwaV9tbWlvX2Jhc2UgPSBWTFZfTUlQSV9CQVNFOwo+ID4g
KwkJaTkxNS0+bWlwaV9tbWlvX2Jhc2UgPSBWTFZfTUlQSV9CQVNFOwo+ID4gICAJaW50ZWxfZHNp
ID0ga3phbGxvYyhzaXplb2YoKmludGVsX2RzaSksIEdGUF9LRVJORUwpOwo+ID4gICAJaWYgKCFp
bnRlbF9kc2kpCj4gPiBAQCAtMTg5NywyMCArMTg5NywyMCBAQCB2b2lkIHZsdl9kc2lfaW5pdChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIAkgKiBPbiBCWVQvQ0hWLCBw
aXBlIEEgbWFwcyB0byBNSVBJIERTSSBwb3J0IEEsIHBpcGUgQiBtYXBzIHRvIE1JUEkgRFNJCj4g
PiAgIAkgKiBwb3J0IEMuIEJYVCBpc24ndCBsaW1pdGVkIGxpa2UgdGhpcy4KPiA+ICAgCSAqLwo+
ID4gLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gPiArCWlmIChJU19HRU45X0xQKGk5MTUp
KQo+ID4gICAJCWludGVsX2VuY29kZXItPmNydGNfbWFzayA9IEJJVChQSVBFX0EpIHwgQklUKFBJ
UEVfQikgfCBCSVQoUElQRV9DKTsKPiA+ICAgCWVsc2UgaWYgKHBvcnQgPT0gUE9SVF9BKQo+ID4g
ICAJCWludGVsX2VuY29kZXItPmNydGNfbWFzayA9IEJJVChQSVBFX0EpOwo+ID4gICAJZWxzZQo+
ID4gICAJCWludGVsX2VuY29kZXItPmNydGNfbWFzayA9IEJJVChQSVBFX0IpOwo+ID4gLQlpZiAo
ZGV2X3ByaXYtPnZidC5kc2kuY29uZmlnLT5kdWFsX2xpbmspCj4gPiArCWlmIChpOTE1LT52YnQu
ZHNpLmNvbmZpZy0+ZHVhbF9saW5rKQo+ID4gICAJCWludGVsX2RzaS0+cG9ydHMgPSBCSVQoUE9S
VF9BKSB8IEJJVChQT1JUX0MpOwo+ID4gICAJZWxzZQo+ID4gICAJCWludGVsX2RzaS0+cG9ydHMg
PSBCSVQocG9ydCk7Cj4gPiAtCWludGVsX2RzaS0+ZGNzX2JhY2tsaWdodF9wb3J0cyA9IGRldl9w
cml2LT52YnQuZHNpLmJsX3BvcnRzOwo+ID4gLQlpbnRlbF9kc2ktPmRjc19jYWJjX3BvcnRzID0g
ZGV2X3ByaXYtPnZidC5kc2kuY2FiY19wb3J0czsKPiA+ICsJaW50ZWxfZHNpLT5kY3NfYmFja2xp
Z2h0X3BvcnRzID0gaTkxNS0+dmJ0LmRzaS5ibF9wb3J0czsKPiA+ICsJaW50ZWxfZHNpLT5kY3Nf
Y2FiY19wb3J0cyA9IGk5MTUtPnZidC5kc2kuY2FiY19wb3J0czsKPiA+ICAgCS8qIENyZWF0ZSBh
IERTSSBob3N0IChhbmQgYSBkZXZpY2UpIGZvciBlYWNoIHBvcnQuICovCj4gPiAgIAlmb3JfZWFj
aF9kc2lfcG9ydChwb3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7Cj4gPiBAQCAtMTk0OSw4ICsxOTQ5
LDggQEAgdm9pZCB2bHZfZHNpX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQo+ID4gICAJICogSW4gY2FzZSBvZiBCWVQgd2l0aCBDUkMgUE1JQywgd2UgbmVlZCB0byB1c2Ug
R1BJTyBmb3IKPiA+ICAgCSAqIFBhbmVsIGNvbnRyb2wuCj4gPiAgIAkgKi8KPiA+IC0JaWYgKChJ
U19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgJiYKPiA+
IC0JICAgIChkZXZfcHJpdi0+dmJ0LmRzaS5jb25maWctPnB3bV9ibGMgPT0gUFBTX0JMQ19QTUlD
KSkgewo+ID4gKwlpZiAoKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1
KSkgJiYKPiA+ICsJICAgIChpOTE1LT52YnQuZHNpLmNvbmZpZy0+cHdtX2JsYyA9PSBQUFNfQkxD
X1BNSUMpKSB7Cj4gPiAgIAkJaW50ZWxfZHNpLT5ncGlvX3BhbmVsID0KPiA+ICAgCQkJZ3Bpb2Rf
Z2V0KGRldi0+ZGV2LCAicGFuZWwiLCBHUElPRF9PVVRfSElHSCk7Cj4gPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvdmx2X2RzaV9wbGwuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L3Zsdl9kc2lfcGxsLmMKPiA+IGluZGV4IDk5Y2MzZTJlOWMyYy4uMjY2NTVkNTQ3MmI0IDEwMDY0
NAo+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvdmx2X2RzaV9wbGwuYwo+ID4gKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvdmx2X2RzaV9wbGwuYwo+ID4gQEAgLTUzLDcgKzUzLDcgQEAg
c3RhdGljIHUzMiBkc2lfY2xrX2Zyb21fcGNsayh1MzIgcGNsaywgZW51bSBtaXBpX2RzaV9waXhl
bF9mb3JtYXQgZm10LAo+ID4gICAJcmV0dXJuIGRzaV9jbGtfa2h6Owo+ID4gICB9Cj4gPiAtc3Rh
dGljIGludCBkc2lfY2FsY19tbnAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
ID4gK3N0YXRpYyBpbnQgZHNpX2NhbGNfbW5wKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ID4gICAJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY29uZmlnLAo+ID4gICAJCQlpbnQg
dGFyZ2V0X2RzaV9jbGspCj4gPiAgIHsKPiA+IEBAIC02OCw3ICs2OCw3IEBAIHN0YXRpYyBpbnQg
ZHNpX2NhbGNfbW5wKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiA+ICAgCQly
ZXR1cm4gLUVDSFJORzsKPiA+ICAgCX0KPiA+IC0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYp
KSB7Cj4gPiArCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKSB7Cj4gPiAgIAkJcmVmX2NsayA9IDEw
MDAwMDsKPiA+ICAgCQluID0gNDsKPiA+ICAgCQltX21pbiA9IDcwOwo+ID4gQEAgLTExNiw3ICsx
MTYsNyBAQCBzdGF0aWMgaW50IGRzaV9jYWxjX21ucChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCj4gPiAgIGludCB2bHZfZHNpX3BsbF9jb21wdXRlKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+ID4gICAJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY29uZmlnKQo+
ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAqaW50
ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAlpbnQgcmV0
Owo+ID4gICAJdTMyIGRzaV9jbGs7Cj4gPiBAQCAtMTI0LDcgKzEyNCw3IEBAIGludCB2bHZfZHNp
X3BsbF9jb21wdXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJZHNpX2Ns
ayA9IGRzaV9jbGtfZnJvbV9wY2xrKGludGVsX2RzaS0+cGNsaywgaW50ZWxfZHNpLT5waXhlbF9m
b3JtYXQsCj4gPiAgIAkJCQkgICAgaW50ZWxfZHNpLT5sYW5lX2NvdW50KTsKPiA+IC0JcmV0ID0g
ZHNpX2NhbGNfbW5wKGRldl9wcml2LCBjb25maWcsIGRzaV9jbGspOwo+ID4gKwlyZXQgPSBkc2lf
Y2FsY19tbnAoaTkxNSwgY29uZmlnLCBkc2lfY2xrKTsKPiA+ICAgCWlmIChyZXQpIHsKPiA+ICAg
CQlEUk1fREVCVUdfS01TKCJkc2lfY2FsY19tbnAgZmFpbGVkXG4iKTsKPiA+ICAgCQlyZXR1cm4g
cmV0Owo+ID4gQEAgLTE0NywxNSArMTQ3LDE1IEBAIGludCB2bHZfZHNpX3BsbF9jb21wdXRlKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICB2b2lkIHZsdl9kc2lfcGxsX2VuYWJs
ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCQkJY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNvbmZpZykKPiA+ICAgewo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+
ICAgCURSTV9ERUJVR19LTVMoIlxuIik7Cj4gPiAtCXZsdl9jY2tfZ2V0KGRldl9wcml2KTsKPiA+
ICsJdmx2X2Nja19nZXQoaTkxNSk7Cj4gPiAtCXZsdl9jY2tfd3JpdGUoZGV2X3ByaXYsIENDS19S
RUdfRFNJX1BMTF9DT05UUk9MLCAwKTsKPiA+IC0Jdmx2X2Nja193cml0ZShkZXZfcHJpdiwgQ0NL
X1JFR19EU0lfUExMX0RJVklERVIsIGNvbmZpZy0+ZHNpX3BsbC5kaXYpOwo+ID4gLQl2bHZfY2Nr
X3dyaXRlKGRldl9wcml2LCBDQ0tfUkVHX0RTSV9QTExfQ09OVFJPTCwKPiA+ICsJdmx2X2Nja193
cml0ZShpOTE1LCBDQ0tfUkVHX0RTSV9QTExfQ09OVFJPTCwgMCk7Cj4gPiArCXZsdl9jY2tfd3Jp
dGUoaTkxNSwgQ0NLX1JFR19EU0lfUExMX0RJVklERVIsIGNvbmZpZy0+ZHNpX3BsbC5kaXYpOwo+
ID4gKwl2bHZfY2NrX3dyaXRlKGk5MTUsIENDS19SRUdfRFNJX1BMTF9DT05UUk9MLAo+ID4gICAJ
CSAgICAgIGNvbmZpZy0+ZHNpX3BsbC5jdHJsICYgfkRTSV9QTExfVkNPX0VOKTsKPiA+ICAgCS8q
IHdhaXQgYXQgbGVhc3QgMC41IHVzIGFmdGVyIHVuZ2F0aW5nIGJlZm9yZSBlbmFibGluZyBWQ08s
Cj4gPiBAQCAtMTYzLDM4ICsxNjMsMzggQEAgdm9pZCB2bHZfZHNpX3BsbF9lbmFibGUoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkgKi8KPiA+ICAgCXVzbGVlcF9yYW5nZSgx
MCwgNTApOwo+ID4gLQl2bHZfY2NrX3dyaXRlKGRldl9wcml2LCBDQ0tfUkVHX0RTSV9QTExfQ09O
VFJPTCwgY29uZmlnLT5kc2lfcGxsLmN0cmwpOwo+ID4gKwl2bHZfY2NrX3dyaXRlKGk5MTUsIEND
S19SRUdfRFNJX1BMTF9DT05UUk9MLCBjb25maWctPmRzaV9wbGwuY3RybCk7Cj4gPiAtCWlmICh3
YWl0X2Zvcih2bHZfY2NrX3JlYWQoZGV2X3ByaXYsIENDS19SRUdfRFNJX1BMTF9DT05UUk9MKSAm
Cj4gPiArCWlmICh3YWl0X2Zvcih2bHZfY2NrX3JlYWQoaTkxNSwgQ0NLX1JFR19EU0lfUExMX0NP
TlRST0wpICYKPiA+ICAgCQkJCQkJRFNJX1BMTF9MT0NLLCAyMCkpIHsKPiA+IC0JCXZsdl9jY2tf
cHV0KGRldl9wcml2KTsKPiA+ICsJCXZsdl9jY2tfcHV0KGk5MTUpOwo+ID4gICAJCURSTV9FUlJP
UigiRFNJIFBMTCBsb2NrIGZhaWxlZFxuIik7Cj4gPiAgIAkJcmV0dXJuOwo+ID4gICAJfQo+ID4g
LQl2bHZfY2NrX3B1dChkZXZfcHJpdik7Cj4gPiArCXZsdl9jY2tfcHV0KGk5MTUpOwo+ID4gICAJ
RFJNX0RFQlVHX0tNUygiRFNJIFBMTCBsb2NrZWRcbiIpOwo+ID4gICB9Cj4gPiAgIHZvaWQgdmx2
X2RzaV9wbGxfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+
ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCXUzMiB0bXA7Cj4gPiAgIAlEUk1fREVCVUdfS01T
KCJcbiIpOwo+ID4gLQl2bHZfY2NrX2dldChkZXZfcHJpdik7Cj4gPiArCXZsdl9jY2tfZ2V0KGk5
MTUpOwo+ID4gLQl0bXAgPSB2bHZfY2NrX3JlYWQoZGV2X3ByaXYsIENDS19SRUdfRFNJX1BMTF9D
T05UUk9MKTsKPiA+ICsJdG1wID0gdmx2X2Nja19yZWFkKGk5MTUsIENDS19SRUdfRFNJX1BMTF9D
T05UUk9MKTsKPiA+ICAgCXRtcCAmPSB+RFNJX1BMTF9WQ09fRU47Cj4gPiAgIAl0bXAgfD0gRFNJ
X1BMTF9MRE9fR0FURTsKPiA+IC0Jdmx2X2Nja193cml0ZShkZXZfcHJpdiwgQ0NLX1JFR19EU0lf
UExMX0NPTlRST0wsIHRtcCk7Cj4gPiArCXZsdl9jY2tfd3JpdGUoaTkxNSwgQ0NLX1JFR19EU0lf
UExMX0NPTlRST0wsIHRtcCk7Cj4gPiAtCXZsdl9jY2tfcHV0KGRldl9wcml2KTsKPiA+ICsJdmx2
X2Nja19wdXQoaTkxNSk7Cj4gPiAgIH0KPiA+IC1ib29sIGJ4dF9kc2lfcGxsX2lzX2VuYWJsZWQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ID4gK2Jvb2wgYnh0X2RzaV9wbGxf
aXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICAgewo+ID4gICAJ
Ym9vbCBlbmFibGVkOwo+ID4gICAJdTMyIHZhbDsKPiA+IEBAIC0yMTYsNyArMjE2LDcgQEAgYm9v
bCBieHRfZHNpX3BsbF9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKPiA+ICAgCSAqIGNhdXNlcyBhIHN5c3RlbSBoYW5nLgo+ID4gICAJICovCj4gPiAgIAl2YWwg
PSBJOTE1X1JFQUQoQlhUX0RTSV9QTExfQ1RMKTsKPiA+IC0JaWYgKElTX0dFTUlOSUxBS0UoZGV2
X3ByaXYpKSB7Cj4gPiArCWlmIChJU19HRU1JTklMQUtFKGk5MTUpKSB7Cj4gPiAgIAkJaWYgKCEo
dmFsICYgQlhUX0RTSUFfMTZYX01BU0spKSB7Cj4gPiAgIAkJCURSTV9ERUJVR19EUklWRVIoIklu
dmFsaWQgUExMIGRpdmlkZXIgKCUwOHgpXG4iLCB2YWwpOwo+ID4gICAJCQllbmFibGVkID0gZmFs
c2U7Cj4gPiBAQCAtMjMzLDcgKzIzMyw3IEBAIGJvb2wgYnh0X2RzaV9wbGxfaXNfZW5hYmxlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gPiAgIHZvaWQgYnh0X2RzaV9wbGxf
ZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPiA+ICAgewo+ID4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2
KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXIt
PmJhc2UuZGV2KTsKPiA+ICAgCXUzMiB2YWw7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJcbiIpOwo+
ID4gQEAgLTI0Niw3ICsyNDYsNyBAQCB2b2lkIGJ4dF9kc2lfcGxsX2Rpc2FibGUoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIpCj4gPiAgIAkgKiBQTEwgbG9jayBzaG91bGQgZGVhc3NlcnQg
d2l0aGluIDIwMHVzLgo+ID4gICAJICogV2FpdCB1cCB0byAxbXMgYmVmb3JlIHRpbWluZyBvdXQu
Cj4gPiAgIAkgKi8KPiA+IC0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+
dW5jb3JlLAo+ID4gKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmk5MTUtPnVuY29yZSwK
PiA+ICAgCQkJCSAgICBCWFRfRFNJX1BMTF9FTkFCTEUsCj4gPiAgIAkJCQkgICAgQlhUX0RTSV9Q
TExfTE9DS0VELAo+ID4gICAJCQkJICAgIDAsCj4gPiBAQCAtMjU3LDIxICsyNTcsMjEgQEAgdm9p
ZCBieHRfZHNpX3BsbF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQo+ID4g
ICB1MzIgdmx2X2RzaV9nZXRfcGNsayhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+
ICAgCQkgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjb25maWcpCj4gPiAgIHsKPiA+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNl
LmRldik7Cj4gPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4gPiAgIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNf
dG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPiA+ICAgCWludCBicHAgPSBtaXBpX2RzaV9w
aXhlbF9mb3JtYXRfdG9fYnBwKGludGVsX2RzaS0+cGl4ZWxfZm9ybWF0KTsKPiA+ICAgCXUzMiBk
c2lfY2xvY2ssIHBjbGs7Cj4gPiAgIAl1MzIgcGxsX2N0bCwgcGxsX2RpdjsKPiA+ICAgCXUzMiBt
ID0gMCwgcCA9IDAsIG47Cj4gPiAtCWludCByZWZjbGsgPSBJU19DSEVSUllWSUVXKGRldl9wcml2
KSA/IDEwMDAwMCA6IDI1MDAwOwo+ID4gKwlpbnQgcmVmY2xrID0gSVNfQ0hFUlJZVklFVyhpOTE1
KSA/IDEwMDAwMCA6IDI1MDAwOwo+ID4gICAJaW50IGk7Cj4gPiAgIAlEUk1fREVCVUdfS01TKCJc
biIpOwo+ID4gLQl2bHZfY2NrX2dldChkZXZfcHJpdik7Cj4gPiAtCXBsbF9jdGwgPSB2bHZfY2Nr
X3JlYWQoZGV2X3ByaXYsIENDS19SRUdfRFNJX1BMTF9DT05UUk9MKTsKPiA+IC0JcGxsX2RpdiA9
IHZsdl9jY2tfcmVhZChkZXZfcHJpdiwgQ0NLX1JFR19EU0lfUExMX0RJVklERVIpOwo+ID4gLQl2
bHZfY2NrX3B1dChkZXZfcHJpdik7Cj4gPiArCXZsdl9jY2tfZ2V0KGk5MTUpOwo+ID4gKwlwbGxf
Y3RsID0gdmx2X2Nja19yZWFkKGk5MTUsIENDS19SRUdfRFNJX1BMTF9DT05UUk9MKTsKPiA+ICsJ
cGxsX2RpdiA9IHZsdl9jY2tfcmVhZChpOTE1LCBDQ0tfUkVHX0RTSV9QTExfRElWSURFUik7Cj4g
PiArCXZsdl9jY2tfcHV0KGk5MTUpOwo+ID4gICAJY29uZmlnLT5kc2lfcGxsLmN0cmwgPSBwbGxf
Y3RsICYgfkRTSV9QTExfTE9DSzsKPiA+ICAgCWNvbmZpZy0+ZHNpX3BsbC5kaXYgPSBwbGxfZGl2
Owo+ID4gQEAgLTMyNSw3ICszMjUsNyBAQCB1MzIgYnh0X2RzaV9nZXRfcGNsayhzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCXUzMiBkc2lfY2xrOwo+ID4gICAJdTMyIGRzaV9y
YXRpbzsKPiA+ICAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9k
c2koJmVuY29kZXItPmJhc2UpOwo+ID4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPiA+ICAgCWludCBicHAg
PSBtaXBpX2RzaV9waXhlbF9mb3JtYXRfdG9fYnBwKGludGVsX2RzaS0+cGl4ZWxfZm9ybWF0KTsK
PiA+ICAgCWNvbmZpZy0+ZHNpX3BsbC5jdHJsID0gSTkxNV9SRUFEKEJYVF9EU0lfUExMX0NUTCk7
Cj4gPiBAQCAtMzQzLDcgKzM0Myw3IEBAIHUzMiBieHRfZHNpX2dldF9wY2xrKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICB2b2lkIHZsdl9kc2lfcmVzZXRfY2xvY2tzKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLCBlbnVtIHBvcnQgcG9ydCkKPiA+ICAgewo+ID4gICAJ
dTMyIHRlbXA7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAq
aW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAl0ZW1w
ID0gSTkxNV9SRUFEKE1JUElfQ1RSTChwb3J0KSk7Cj4gPiBAQCAtMzU2LDcgKzM1Niw3IEBAIHZv
aWQgdmx2X2RzaV9yZXNldF9jbG9ja3Moc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIGVu
dW0gcG9ydCBwb3J0KQo+ID4gICBzdGF0aWMgdm9pZCBnbGtfZHNpX3Byb2dyYW1fZXNjX2Nsb2Nr
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gPiAgIAkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY29uZmlnKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAgIAl1MzIgZHNpX3JhdGUgPSAwOwo+ID4gICAJdTMy
IHBsbF9yYXRpbyA9IDA7Cj4gPiAgIAl1MzIgZGRyX2NsayA9IDA7Cj4gPiBAQCAtNDA0LDcgKzQw
NCw3IEBAIHN0YXRpYyB2b2lkIGdsa19kc2lfcHJvZ3JhbV9lc2NfY2xvY2soc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwKPiA+ICAgc3RhdGljIHZvaWQgYnh0X2RzaV9wcm9ncmFtX2Nsb2NrcyhzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LCBlbnVtIHBvcnQgcG9ydCwKPiA+ICAgCQkJCSAgIGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjb25maWcpCj4gPiAgIHsKPiA+IC0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKPiA+ICAgCXUzMiB0bXA7Cj4gPiAgIAl1
MzIgZHNpX3JhdGUgPSAwOwo+ID4gICAJdTMyIHBsbF9yYXRpbyA9IDA7Cj4gPiBAQCAtNDU3LDcg
KzQ1Nyw3IEBAIHN0YXRpYyB2b2lkIGJ4dF9kc2lfcHJvZ3JhbV9jbG9ja3Moc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwgZW51bSBwb3J0IHBvcnQsCj4gPiAgIGludCBieHRfZHNpX3BsbF9jb21wdXRl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJCQlzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY29uZmlnKQo+ID4gICB7Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+ID4gICAJc3Ry
dWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFz
ZSk7Cj4gPiAgIAl1OCBkc2lfcmF0aW8sIGRzaV9yYXRpb19taW4sIGRzaV9yYXRpb19tYXg7Cj4g
PiAgIAl1MzIgZHNpX2NsazsKPiA+IEBAIC00NzIsNyArNDcyLDcgQEAgaW50IGJ4dF9kc2lfcGxs
X2NvbXB1dGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIAkgKi8KPiA+ICAg
CWRzaV9yYXRpbyA9IERJVl9ST1VORF9VUChkc2lfY2xrICogMiwgQlhUX1JFRl9DTE9DS19LSFop
Owo+ID4gLQlpZiAoSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKPiA+ICsJaWYgKElTX0JST1hUT04o
aTkxNSkpIHsKPiA+ICAgCQlkc2lfcmF0aW9fbWluID0gQlhUX0RTSV9QTExfUkFUSU9fTUlOOwo+
ID4gICAJCWRzaV9yYXRpb19tYXggPSBCWFRfRFNJX1BMTF9SQVRJT19NQVg7Cj4gPiAgIAl9IGVs
c2Ugewo+ID4gQEAgLTQ5Niw3ICs0OTYsNyBAQCBpbnQgYnh0X2RzaV9wbGxfY29tcHV0ZShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPiA+ICAgCS8qIEFzIHBlciByZWNvbW1lbmRhdGlv
biBmcm9tIGhhcmR3YXJlIHRlYW0sCj4gPiAgIAkgKiBQcm9nIFBWRCByYXRpbyA9MSBpZiBkc2kg
cmF0aW8gPD0gNTAKPiA+ICAgCSAqLwo+ID4gLQlpZiAoSVNfQlJPWFRPTihkZXZfcHJpdikgJiYg
ZHNpX3JhdGlvIDw9IDUwKQo+ID4gKwlpZiAoSVNfQlJPWFRPTihpOTE1KSAmJiBkc2lfcmF0aW8g
PD0gNTApCj4gPiAgIAkJY29uZmlnLT5kc2lfcGxsLmN0cmwgfD0gQlhUX0RTSV9QTExfUFZEX1JB
VElPXzE7Cj4gPiAgIAlyZXR1cm4gMDsKPiA+IEBAIC01MDUsNyArNTA1LDcgQEAgaW50IGJ4dF9k
c2lfcGxsX2NvbXB1dGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4gPiAgIHZvaWQg
Ynh0X2RzaV9wbGxfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJ
CQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY29uZmlnKQo+ID4gICB7Cj4gPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5k
ZXYpOwo+ID4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rl
ci0+YmFzZS5kZXYpOwo+ID4gICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3Rv
X2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4gPiAgIAllbnVtIHBvcnQgcG9ydDsKPiA+ICAg
CXUzMiB2YWw7Cj4gPiBAQCAtNTE3LDcgKzUxNyw3IEBAIHZvaWQgYnh0X2RzaV9wbGxfZW5hYmxl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJUE9TVElOR19SRUFEKEJYVF9E
U0lfUExMX0NUTCk7Cj4gPiAgIAkvKiBQcm9ncmFtIFRYLCBSWCwgRHBoeSBjbG9ja3MgKi8KPiA+
IC0JaWYgKElTX0JST1hUT04oZGV2X3ByaXYpKSB7Cj4gPiArCWlmIChJU19CUk9YVE9OKGk5MTUp
KSB7Cj4gPiAgIAkJZm9yX2VhY2hfZHNpX3BvcnQocG9ydCwgaW50ZWxfZHNpLT5wb3J0cykKPiA+
ICAgCQkJYnh0X2RzaV9wcm9ncmFtX2Nsb2NrcyhlbmNvZGVyLT5iYXNlLmRldiwgcG9ydCwgY29u
ZmlnKTsKPiA+ICAgCX0gZWxzZSB7Cj4gPiBAQCAtNTMwLDcgKzUzMCw3IEBAIHZvaWQgYnh0X2Rz
aV9wbGxfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+ID4gICAJSTkxNV9X
UklURShCWFRfRFNJX1BMTF9FTkFCTEUsIHZhbCk7Cj4gPiAgIAkvKiBUaW1lb3V0IGFuZCBmYWls
IGlmIFBMTCBub3QgbG9ja2VkICovCj4gPiAtCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rlcigm
ZGV2X3ByaXYtPnVuY29yZSwKPiA+ICsJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZpOTE1
LT51bmNvcmUsCj4gPiAgIAkJCQkgICAgQlhUX0RTSV9QTExfRU5BQkxFLAo+ID4gICAJCQkJICAg
IEJYVF9EU0lfUExMX0xPQ0tFRCwKPiA+ICAgCQkJCSAgICBCWFRfRFNJX1BMTF9MT0NLRUQsCj4g
PiBAQCAtNTQ2LDEwICs1NDYsMTAgQEAgdm9pZCBieHRfZHNpX3Jlc2V0X2Nsb2NrcyhzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwgZW51bSBwb3J0IHBvcnQpCj4gPiAgIHsKPiA+ICAgCXUz
MiB0bXA7Cj4gPiAgIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gZW5jb2Rlci0+YmFzZS5kZXY7
Cj4gPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsK
PiA+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRldik7Cj4gPiAg
IAkvKiBDbGVhciBvbGQgY29uZmlndXJhdGlvbnMgKi8KPiA+IC0JaWYgKElTX0JST1hUT04oZGV2
X3ByaXYpKSB7Cj4gPiArCWlmIChJU19CUk9YVE9OKGk5MTUpKSB7Cj4gPiAgIAkJdG1wID0gSTkx
NV9SRUFEKEJYVF9NSVBJX0NMT0NLX0NUTCk7Cj4gPiAgIAkJdG1wICY9IH4oQlhUX01JUElfVFhf
RVNDTEtfRklYRElWX01BU0socG9ydCkpOwo+ID4gICAJCXRtcCAmPSB+KEJYVF9NSVBJX1JYX0VT
Q0xLX1VQUEVSX0ZJWERJVl9NQVNLKHBvcnQpKTsKPiA+IApfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdm
eEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A81B5C0D19
	for <lists+intel-gfx@lfdr.de>; Fri, 27 Sep 2019 23:18:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 522156E271;
	Fri, 27 Sep 2019 21:18:05 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6F2AE6E26F
 for <intel-gfx@lists.freedesktop.org>; Fri, 27 Sep 2019 21:18:04 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18644756-1500050 
 for multiple; Fri, 27 Sep 2019 22:17:53 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 27 Sep 2019 22:17:47 +0100
Message-Id: <20190927211749.2181-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 1/3] drm/i915: Pass intel_gt to has-reset?
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgd2UgZXhlY3V0ZSBHUFUgcmVzdWx0cyBvbiBhIGd0LyBiYXNpcywgYW5kIHVzZSB0aGUgaW50
ZWxfZ3QgYXMgdGhlCnByaW1hcnkgZm9yIGFsbCBvdGhlciByZXNldCBmdW5jdGlvbnMsIGFsc28g
dXNlIGl0IGZvciB0aGUgaGFzLXJlc2V0PwpwcmVkaWNhdGVkLiBHcmFkdWFsbHkgc2ltcGxpZnlp
bmcgdGhlIGNodXJuIG9mIHBvaW50ZXJzLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxj
aHJpc0BjaHJpcy13aWxzb24uY28udWs+CkNjOiBBbmRpIFNoeXRpIDxhbmRpLnNoeXRpQGludGVs
LmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyAg
fCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyAgICAgICAgIHwg
MjEgKysrKysrKysrKysrLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVz
ZXQuaCAgICAgICAgIHwgIDUgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X2hhbmdjaGVjay5jICB8IDEyICsrKysrLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9z
ZWxmdGVzdF9scmMuYyAgICAgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RfcmVzZXQuYyAgICAgIHwgIDQgKystLQogLi4uL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVz
dF93b3JrYXJvdW5kcy5jICAgIHwgIDggKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9nZXRwYXJhbS5jICAgICAgICAgIHwgIDQgKystLQogOCBmaWxlcyBjaGFuZ2VkLCAzMSBpbnNl
cnRpb25zKCspLCAyNyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGlzcGxheS5jCmluZGV4IGJiZTA4OGI5ZDA1Ny4uZjEzMjhjMDhmNGFkIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwpAQCAtNDI3Myw3
ICs0MjczLDcgQEAgX19pbnRlbF9kaXNwbGF5X3Jlc3VtZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LAogc3RhdGljIGJvb2wgZ3B1X3Jlc2V0X2Nsb2JiZXJzX2Rpc3BsYXkoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQogewogCXJldHVybiAoSU5URUxfSU5GTyhkZXZfcHJpdiktPmdw
dV9yZXNldF9jbG9iYmVyc19kaXNwbGF5ICYmCi0JCWludGVsX2hhc19ncHVfcmVzZXQoZGV2X3By
aXYpKTsKKwkJaW50ZWxfaGFzX2dwdV9yZXNldCgmZGV2X3ByaXYtPmd0KSk7CiB9CiAKIHZvaWQg
aW50ZWxfcHJlcGFyZV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwppbmRleCBkMDgyMjZmNWJlYTUuLmVhNWNm
M2EyOGZiZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCkBAIC01NDYsOCAr
NTQ2LDEwIEBAIHR5cGVkZWYgaW50ICgqcmVzZXRfZnVuYykoc3RydWN0IGludGVsX2d0ICosCiAJ
CQkgIGludGVsX2VuZ2luZV9tYXNrX3QgZW5naW5lX21hc2ssCiAJCQkgIHVuc2lnbmVkIGludCBy
ZXRyeSk7CiAKLXN0YXRpYyByZXNldF9mdW5jIGludGVsX2dldF9ncHVfcmVzZXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0aWMgcmVzZXRfZnVuYyBpbnRlbF9nZXRfZ3B1X3Jl
c2V0KGNvbnN0IHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CisJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBndC0+aTkxNTsKKwogCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkKIAkJcmV0
dXJuIGdlbjhfcmVzZXRfZW5naW5lczsKIAllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikK
QEAgLTU3MSw3ICs1NzMsNyBAQCBpbnQgX19pbnRlbF9ndF9yZXNldChzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0LCBpbnRlbF9lbmdpbmVfbWFza190IGVuZ2luZV9tYXNrKQogCWludCByZXQgPSAtRVRJTUVE
T1VUOwogCWludCByZXRyeTsKIAotCXJlc2V0ID0gaW50ZWxfZ2V0X2dwdV9yZXNldChndC0+aTkx
NSk7CisJcmVzZXQgPSBpbnRlbF9nZXRfZ3B1X3Jlc2V0KGd0KTsKIAlpZiAoIXJlc2V0KQogCQly
ZXR1cm4gLUVOT0RFVjsKIApAQCAtNTkxLDE3ICs1OTMsMjAgQEAgaW50IF9faW50ZWxfZ3RfcmVz
ZXQoc3RydWN0IGludGVsX2d0ICpndCwgaW50ZWxfZW5naW5lX21hc2tfdCBlbmdpbmVfbWFzaykK
IAlyZXR1cm4gcmV0OwogfQogCi1ib29sIGludGVsX2hhc19ncHVfcmVzZXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCitib29sIGludGVsX2hhc19ncHVfcmVzZXQoY29uc3Qgc3RydWN0
IGludGVsX2d0ICpndCkKIHsKIAlpZiAoIWk5MTVfbW9kcGFyYW1zLnJlc2V0KQogCQlyZXR1cm4g
TlVMTDsKIAotCXJldHVybiBpbnRlbF9nZXRfZ3B1X3Jlc2V0KGk5MTUpOworCXJldHVybiBpbnRl
bF9nZXRfZ3B1X3Jlc2V0KGd0KTsKIH0KIAotYm9vbCBpbnRlbF9oYXNfcmVzZXRfZW5naW5lKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQorYm9vbCBpbnRlbF9oYXNfcmVzZXRfZW5naW5l
KGNvbnN0IHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7Ci0JcmV0dXJuIElOVEVMX0lORk8oaTkxNSkt
Pmhhc19yZXNldF9lbmdpbmUgJiYgaTkxNV9tb2RwYXJhbXMucmVzZXQgPj0gMjsKKwlpZiAoaTkx
NV9tb2RwYXJhbXMucmVzZXQgPCAyKQorCQlyZXR1cm4gZmFsc2U7CisKKwlyZXR1cm4gSU5URUxf
SU5GTyhndC0+aTkxNSktPmhhc19yZXNldF9lbmdpbmU7CiB9CiAKIGludCBpbnRlbF9yZXNldF9n
dWMoc3RydWN0IGludGVsX2d0ICpndCkKQEAgLTk1OCw3ICs5NjMsNyBAQCB2b2lkIGludGVsX2d0
X3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QsCiAKIAlhd2FrZSA9IHJlc2V0X3ByZXBhcmUoZ3Qp
OwogCi0JaWYgKCFpbnRlbF9oYXNfZ3B1X3Jlc2V0KGd0LT5pOTE1KSkgeworCWlmICghaW50ZWxf
aGFzX2dwdV9yZXNldChndCkpIHsKIAkJaWYgKGk5MTVfbW9kcGFyYW1zLnJlc2V0KQogCQkJZGV2
X2VycihndC0+aTkxNS0+ZHJtLmRldiwgIkdQVSByZXNldCBub3Qgc3VwcG9ydGVkXG4iKTsKIAkJ
ZWxzZQpAQCAtMTE3OSw3ICsxMTg0LDcgQEAgdm9pZCBpbnRlbF9ndF9oYW5kbGVfZXJyb3Ioc3Ry
dWN0IGludGVsX2d0ICpndCwKIAkgKiBUcnkgZW5naW5lIHJlc2V0IHdoZW4gYXZhaWxhYmxlLiBX
ZSBmYWxsIGJhY2sgdG8gZnVsbCByZXNldCBpZgogCSAqIHNpbmdsZSByZXNldCBmYWlscy4KIAkg
Ki8KLQlpZiAoaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShndC0+aTkxNSkgJiYgIWludGVsX2d0X2lz
X3dlZGdlZChndCkpIHsKKwlpZiAoaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShndCkgJiYgIWludGVs
X2d0X2lzX3dlZGdlZChndCkpIHsKIAkJZm9yX2VhY2hfZW5naW5lX21hc2tlZChlbmdpbmUsIGd0
LT5pOTE1LCBlbmdpbmVfbWFzaywgdG1wKSB7CiAJCQlCVUlMRF9CVUdfT04oSTkxNV9SRVNFVF9N
T0RFU0VUID49IEk5MTVfUkVTRVRfRU5HSU5FKTsKIAkJCWlmICh0ZXN0X2FuZF9zZXRfYml0KEk5
MTVfUkVTRVRfRU5HSU5FICsgZW5naW5lLT5pZCwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX3Jlc2V0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
ZXNldC5oCmluZGV4IDBiNmZmMWVlN2YwNi4uOGU4ZDVmNzYxMTY2IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3Jlc2V0LmgKQEAgLTE0LDcgKzE0LDYgQEAKICNpbmNsdWRlICJpbnRlbF9l
bmdpbmVfdHlwZXMuaCIKICNpbmNsdWRlICJpbnRlbF9yZXNldF90eXBlcy5oIgogCi1zdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZTsKIHN0cnVjdCBpOTE1X3JlcXVlc3Q7CiBzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzOwogc3RydWN0IGludGVsX2d0OwpAQCAtODAsNyArNzksNyBAQCBzdGF0aWMgaW5saW5l
IGJvb2wgX19pbnRlbF9yZXNldF9mYWlsZWQoY29uc3Qgc3RydWN0IGludGVsX3Jlc2V0ICpyZXNl
dCkKIAlyZXR1cm4gdW5saWtlbHkodGVzdF9iaXQoSTkxNV9XRURHRUQsICZyZXNldC0+ZmxhZ3Mp
KTsKIH0KIAotYm9vbCBpbnRlbF9oYXNfZ3B1X3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KTsKLWJvb2wgaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSk7Citib29sIGludGVsX2hhc19ncHVfcmVzZXQoY29uc3Qgc3RydWN0IGludGVs
X2d0ICpndCk7Citib29sIGludGVsX2hhc19yZXNldF9lbmdpbmUoY29uc3Qgc3RydWN0IGludGVs
X2d0ICpndCk7CiAKICNlbmRpZiAvKiBJOTE1X1JFU0VUX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMKaW5kZXggYTAwOThmYzM1OTIxLi45YzBjODQ0
MWMyMmEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdj
aGVjay5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5j
CkBAIC00NTgsNyArNDU4LDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9wX2VuZ2luZSh2b2lk
ICphcmcpCiAKIAkvKiBDaGVjayB0aGF0IHdlIGNhbiBlbmdpbmUtcmVzZXQgZHVyaW5nIG5vbi11
c2VyIHBvcnRpb25zICovCiAKLQlpZiAoIWludGVsX2hhc19yZXNldF9lbmdpbmUoZ3QtPmk5MTUp
KQorCWlmICghaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShndCkpCiAJCXJldHVybiAwOwogCiAJZmls
ZSA9IG1vY2tfZmlsZShndC0+aTkxNSk7CkBAIC01NTksNyArNTU5LDcgQEAgc3RhdGljIGludCBf
X2lndF9yZXNldF9lbmdpbmUoc3RydWN0IGludGVsX2d0ICpndCwgYm9vbCBhY3RpdmUpCiAKIAkv
KiBDaGVjayB0aGF0IHdlIGNhbiBpc3N1ZSBhbiBlbmdpbmUgcmVzZXQgb24gYW4gaWRsZSBlbmdp
bmUgKG5vLW9wKSAqLwogCi0JaWYgKCFpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGd0LT5pOTE1KSkK
KwlpZiAoIWludGVsX2hhc19yZXNldF9lbmdpbmUoZ3QpKQogCQlyZXR1cm4gMDsKIAogCWlmIChh
Y3RpdmUpIHsKQEAgLTc5MSw3ICs3OTEsNyBAQCBzdGF0aWMgaW50IF9faWd0X3Jlc2V0X2VuZ2lu
ZXMoc3RydWN0IGludGVsX2d0ICpndCwKIAkgKiB3aXRoIGFueSBvdGhlciBlbmdpbmUuCiAJICov
CiAKLQlpZiAoIWludGVsX2hhc19yZXNldF9lbmdpbmUoZ3QtPmk5MTUpKQorCWlmICghaW50ZWxf
aGFzX3Jlc2V0X2VuZ2luZShndCkpCiAJCXJldHVybiAwOwogCiAJaWYgKGZsYWdzICYgVEVTVF9B
Q1RJVkUpIHsKQEAgLTE1NDcsNyArMTU0Nyw3IEBAIHN0YXRpYyBpbnQgaWd0X2hhbmRsZV9lcnJv
cih2b2lkICphcmcpCiAKIAkvKiBDaGVjayB0aGF0IHdlIGNhbiBpc3N1ZSBhIGdsb2JhbCBHUFUg
YW5kIGVuZ2luZSByZXNldCAqLwogCi0JaWYgKCFpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGd0LT5p
OTE1KSkKKwlpZiAoIWludGVsX2hhc19yZXNldF9lbmdpbmUoZ3QpKQogCQlyZXR1cm4gMDsKIAog
CWlmICghZW5naW5lIHx8ICFpbnRlbF9lbmdpbmVfY2FuX3N0b3JlX2R3b3JkKGVuZ2luZSkpCkBA
IC0xNjg5LDcgKzE2ODksNyBAQCBzdGF0aWMgaW50IGlndF9yZXNldF9lbmdpbmVzX2F0b21pYyh2
b2lkICphcmcpCiAKIAkvKiBDaGVjayB0aGF0IHRoZSBlbmdpbmVzIHJlc2V0cyBhcmUgdXNhYmxl
IGZyb20gYXRvbWljIGNvbnRleHQgKi8KIAotCWlmICghaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShn
dC0+aTkxNSkpCisJaWYgKCFpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGd0KSkKIAkJcmV0dXJuIDA7
CiAKIAlpZiAoVVNFU19HVUNfU1VCTUlTU0lPTihndC0+aTkxNSkpCkBAIC0xNzQ2LDcgKzE3NDYs
NyBAQCBpbnQgaW50ZWxfaGFuZ2NoZWNrX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQogCWJvb2wgc2F2ZWRfaGFuZ2NoZWNrOwogCWludCBlcnI7CiAKLQlpZiAo
IWludGVsX2hhc19ncHVfcmVzZXQoZ3QtPmk5MTUpKQorCWlmICghaW50ZWxfaGFzX2dwdV9yZXNl
dChndCkpCiAJCXJldHVybiAwOwogCiAJaWYgKGludGVsX2d0X2lzX3dlZGdlZChndCkpCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCmluZGV4IDIyZWEyZTc0NzA2NC4uOTNmMmZj
ZGM0OWJmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwpAQCAtMTMxMCw3
ICsxMzEwLDcgQEAgc3RhdGljIGludCBsaXZlX3ByZWVtcHRfaGFuZyh2b2lkICphcmcpCiAJaWYg
KCFIQVNfTE9HSUNBTF9SSU5HX1BSRUVNUFRJT04oaTkxNSkpCiAJCXJldHVybiAwOwogCi0JaWYg
KCFpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGk5MTUpKQorCWlmICghaW50ZWxfaGFzX3Jlc2V0X2Vu
Z2luZSgmaTkxNS0+Z3QpKQogCQlyZXR1cm4gMDsKIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRl
c3RfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3Jlc2V0LmMKaW5k
ZXggMDBhNGY2MGNkZmQ1Li5kNzk0ODJkYjdmZTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X3Jlc2V0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfcmVzZXQuYwpAQCAtMTEyLDcgKzExMiw3IEBAIHN0YXRpYyBpbnQgaWd0X2F0b21p
Y19lbmdpbmVfcmVzZXQodm9pZCAqYXJnKQogCiAJLyogQ2hlY2sgdGhhdCB0aGUgcmVzZXRzIGFy
ZSB1c2FibGUgZnJvbSBhdG9taWMgY29udGV4dCAqLwogCi0JaWYgKCFpbnRlbF9oYXNfcmVzZXRf
ZW5naW5lKGd0LT5pOTE1KSkKKwlpZiAoIWludGVsX2hhc19yZXNldF9lbmdpbmUoZ3QpKQogCQly
ZXR1cm4gMDsKIAogCWlmIChVU0VTX0dVQ19TVUJNSVNTSU9OKGd0LT5pOTE1KSkKQEAgLTE3MCw3
ICsxNzAsNyBAQCBpbnQgaW50ZWxfcmVzZXRfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCiAJfTsKIAlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gJmk5MTUtPmd0Owog
Ci0JaWYgKCFpbnRlbF9oYXNfZ3B1X3Jlc2V0KGd0LT5pOTE1KSkKKwlpZiAoIWludGVsX2hhc19n
cHVfcmVzZXQoZ3QpKQogCQlyZXR1cm4gMDsKIAogCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZ3Qp
KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3Vu
ZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKaW5k
ZXggOTk5YTk4ZjAwNDk0Li5kNDBjZTA3MDliZmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYwpAQCAtNzQ3LDcgKzc0Nyw3IEBAIHN0YXRpYyBp
bnQgbGl2ZV9yZXNldF93aGl0ZWxpc3Qodm9pZCAqYXJnKQogCiAJaWd0X2dsb2JhbF9yZXNldF9s
b2NrKCZpOTE1LT5ndCk7CiAKLQlpZiAoaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShpOTE1KSkgewor
CWlmIChpbnRlbF9oYXNfcmVzZXRfZW5naW5lKCZpOTE1LT5ndCkpIHsKIAkJZXJyID0gY2hlY2tf
d2hpdGVsaXN0X2Fjcm9zc19yZXNldChlbmdpbmUsCiAJCQkJCQkgICBkb19lbmdpbmVfcmVzZXQs
CiAJCQkJCQkgICAiZW5naW5lIik7CkBAIC03NTUsNyArNzU1LDcgQEAgc3RhdGljIGludCBsaXZl
X3Jlc2V0X3doaXRlbGlzdCh2b2lkICphcmcpCiAJCQlnb3RvIG91dDsKIAl9CiAKLQlpZiAoaW50
ZWxfaGFzX2dwdV9yZXNldChpOTE1KSkgeworCWlmIChpbnRlbF9oYXNfZ3B1X3Jlc2V0KCZpOTE1
LT5ndCkpIHsKIAkJZXJyID0gY2hlY2tfd2hpdGVsaXN0X2Fjcm9zc19yZXNldChlbmdpbmUsCiAJ
CQkJCQkgICBkb19kZXZpY2VfcmVzZXQsCiAJCQkJCQkgICAiZGV2aWNlIik7CkBAIC0xMTMxLDcg
KzExMzEsNyBAQCBsaXZlX2dwdV9yZXNldF93b3JrYXJvdW5kcyh2b2lkICphcmcpCiAJc3RydWN0
IHdhX2xpc3RzIGxpc3RzOwogCWJvb2wgb2s7CiAKLQlpZiAoIWludGVsX2hhc19ncHVfcmVzZXQo
aTkxNSkpCisJaWYgKCFpbnRlbF9oYXNfZ3B1X3Jlc2V0KCZpOTE1LT5ndCkpCiAJCXJldHVybiAw
OwogCiAJY3R4ID0ga2VybmVsX2NvbnRleHQoaTkxNSk7CkBAIC0xMTc4LDcgKzExNzgsNyBAQCBs
aXZlX2VuZ2luZV9yZXNldF93b3JrYXJvdW5kcyh2b2lkICphcmcpCiAJc3RydWN0IHdhX2xpc3Rz
IGxpc3RzOwogCWludCByZXQgPSAwOwogCi0JaWYgKCFpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGk5
MTUpKQorCWlmICghaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZSgmaTkxNS0+Z3QpKQogCQlyZXR1cm4g
MDsKIAogCWN0eCA9IGtlcm5lbF9jb250ZXh0KGk5MTUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZXRwYXJhbS5jCmluZGV4IDVkOTEwMTM3NmEzZC4uZjRiM2NiYjFhZGNlIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dldHBhcmFtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZXRwYXJhbS5jCkBAIC03OSw4ICs3OSw4IEBAIGludCBpOTE1X2dldHBhcmFt
X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJCWJyZWFrOwogCWNh
c2UgSTkxNV9QQVJBTV9IQVNfR1BVX1JFU0VUOgogCQl2YWx1ZSA9IGk5MTVfbW9kcGFyYW1zLmVu
YWJsZV9oYW5nY2hlY2sgJiYKLQkJCWludGVsX2hhc19ncHVfcmVzZXQoaTkxNSk7Ci0JCWlmICh2
YWx1ZSAmJiBpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGk5MTUpKQorCQkJaW50ZWxfaGFzX2dwdV9y
ZXNldCgmaTkxNS0+Z3QpOworCQlpZiAodmFsdWUgJiYgaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZSgm
aTkxNS0+Z3QpKQogCQkJdmFsdWUgPSAyOwogCQlicmVhazsKIAljYXNlIEk5MTVfUEFSQU1fSEFT
X1JFU09VUkNFX1NUUkVBTUVSOgotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 84576C9DE4
	for <lists+intel-gfx@lfdr.de>; Thu,  3 Oct 2019 13:58:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2601E6E9AF;
	Thu,  3 Oct 2019 11:58:39 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 112FE6E9AF
 for <intel-gfx@lists.freedesktop.org>; Thu,  3 Oct 2019 11:58:36 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18706342-1500050 
 for multiple; Thu, 03 Oct 2019 12:58:20 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  3 Oct 2019 12:58:18 +0100
Message-Id: <20191003115818.613-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191003093639.10186-17-chris@chris-wilson.co.uk>
References: <20191003093639.10186-17-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Move context management under GEM
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

S2VlcCB0cmFjayBvZiB0aGUgR0VNIGNvbnRleHRzIHVuZGVybmVhdGggaTkxNS0+Z2VtLmNvbnRl
eHRzIGFuZCBhc3NpZ24KdGhlbSB0aGVpciBvd24gbG9jayBmb3IgdGhlIHB1cnBvc2VzIG9mIGxp
c3QgbWFuYWdlbWVudC4KCnYyOiBGb2N1cyBvbiBsb2NrIHRyYWNraW5nOyBjdHgtPnZtIGlzIHBy
b3RlY3RlZCBieSBjdHgtPm11dGV4CgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlz
QGNocmlzLXdpbHNvbi5jby51az4KQ2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBp
bnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQu
YyAgIHwgMTczICsrKysrKysrLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX2NvbnRleHQuaCAgIHwgIDI3ICsrLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fY29udGV4dF90eXBlcy5oIHwgICAyICstCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9leGVjYnVmZmVyLmMgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV91c2VycHRyLmMgICB8ICAgMyArLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3Rz
L2h1Z2VfcGFnZXMuYyAgIHwgIDM2ICsrLS0KIC4uLi9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5
MTVfZ2VtX2NvbnRleHQuYyB8IDE2NiArKysrKysrKy0tLS0tLS0tLQogLi4uL2dwdS9kcm0vaTkx
NS9nZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5jIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgICAgICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAgICB8ICAgNSArCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9jb250ZXh0LmMgICAgfCAgMjQgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyAgfCAgMzkgKystLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfbHJjLmMgICAgICAgIHwgICA2ICstCiAuLi4vZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMgICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d2dC9zY2hlZHVsZXIuYyAgICAgICAgICB8ICAyNCArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8ICA1MCArKystLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kcnYuYyAgICAgICAgICAgICAgIHwgICAyIC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmggICAgICAgICAgICAgICB8ICAyNyArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtLmMgICAgICAgICAgICAgICB8ICAxMCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW1fZ3R0LmMgICAgICAgICAgIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3BlcmYuYyAgICAgICAgICAgICAgfCAgMjQgKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3N5c2ZzLmMgICAgICAgICAgICAgfCAgNzcgKysrKy0tLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfdHJhY2UuaCAgICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMgICAgIHwgICA4IC0KIC4uLi9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMgICB8ICAgMyAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMgfCAgMTUgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3Nl
bGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYyB8ICAxMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfdm1hLmMgICAgIHwgICA3ICstCiAuLi4vZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9tb2NrX2dlbV9kZXZpY2UuYyAgfCAgIDYgKy0KIDI5IGZpbGVzIGNoYW5nZWQsIDM5MSBpbnNl
cnRpb25zKCspLCAzODcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9jb250ZXh0LmMKaW5kZXggYWU1ODg1NDRiZjNhLi40MjdhOWEyNWQ1OWEgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwpAQCAtMjE4LDkgKzIx
OCwxMiBAQCBzdGF0aWMgc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXMgKmRlZmF1bHRfZW5naW5lcyhz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogCiBzdGF0aWMgdm9pZCBpOTE1X2dlbV9jb250
ZXh0X2ZyZWUoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIHsKLQlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZjdHgtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCUdFTV9CVUdfT04oIWk5MTVf
Z2VtX2NvbnRleHRfaXNfY2xvc2VkKGN0eCkpOwogCisJc3Bpbl9sb2NrKCZjdHgtPmk5MTUtPmdl
bS5jb250ZXh0cy5sb2NrKTsKKwlsaXN0X2RlbCgmY3R4LT5saW5rKTsKKwlzcGluX3VubG9jaygm
Y3R4LT5pOTE1LT5nZW0uY29udGV4dHMubG9jayk7CisKIAlmcmVlX2VuZ2luZXMocmN1X2FjY2Vz
c19wb2ludGVyKGN0eC0+ZW5naW5lcykpOwogCW11dGV4X2Rlc3Ryb3koJmN0eC0+ZW5naW5lc19t
dXRleCk7CiAKQEAgLTIzMCw2NyArMjMzLDU0IEBAIHN0YXRpYyB2b2lkIGk5MTVfZ2VtX2NvbnRl
eHRfZnJlZShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogCWtmcmVlKGN0eC0+bmFtZSk7
CiAJcHV0X3BpZChjdHgtPnBpZCk7CiAKLQlsaXN0X2RlbCgmY3R4LT5saW5rKTsKIAltdXRleF9k
ZXN0cm95KCZjdHgtPm11dGV4KTsKIAogCWtmcmVlX3JjdShjdHgsIHJjdSk7CiB9CiAKLXN0YXRp
YyB2b2lkIGNvbnRleHRzX2ZyZWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0
aWMgdm9pZCBjb250ZXh0c19mcmVlX2FsbChzdHJ1Y3QgbGxpc3Rfbm9kZSAqbGlzdCkKIHsKLQlz
dHJ1Y3QgbGxpc3Rfbm9kZSAqZnJlZWQgPSBsbGlzdF9kZWxfYWxsKCZpOTE1LT5jb250ZXh0cy5m
cmVlX2xpc3QpOwogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsICpjbjsKIAotCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCi0JbGxpc3RfZm9yX2Vh
Y2hfZW50cnlfc2FmZShjdHgsIGNuLCBmcmVlZCwgZnJlZV9saW5rKQorCWxsaXN0X2Zvcl9lYWNo
X2VudHJ5X3NhZmUoY3R4LCBjbiwgbGlzdCwgZnJlZV9saW5rKQogCQlpOTE1X2dlbV9jb250ZXh0
X2ZyZWUoY3R4KTsKIH0KIAotc3RhdGljIHZvaWQgY29udGV4dHNfZnJlZV9maXJzdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3N0YXRpYyB2b2lkIGNvbnRleHRzX2ZsdXNoX2ZyZWUo
c3RydWN0IGk5MTVfZ2VtX2NvbnRleHRzICpnYykKIHsKLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4OwotCXN0cnVjdCBsbGlzdF9ub2RlICpmcmVlZDsKLQotCWxvY2tkZXBfYXNzZXJ0X2hl
bGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCi0JZnJlZWQgPSBsbGlzdF9kZWxfZmlyc3Qo
Jmk5MTUtPmNvbnRleHRzLmZyZWVfbGlzdCk7Ci0JaWYgKCFmcmVlZCkKLQkJcmV0dXJuOwotCi0J
Y3R4ID0gY29udGFpbmVyX29mKGZyZWVkLCB0eXBlb2YoKmN0eCksIGZyZWVfbGluayk7Ci0JaTkx
NV9nZW1fY29udGV4dF9mcmVlKGN0eCk7CisJY29udGV4dHNfZnJlZV9hbGwobGxpc3RfZGVsX2Fs
bCgmZ2MtPmZyZWVfbGlzdCkpOwogfQogCiBzdGF0aWMgdm9pZCBjb250ZXh0c19mcmVlX3dvcmtl
cihzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPQotCQljb250YWluZXJfb2Yod29yaywgdHlwZW9mKCppOTE1KSwgY29udGV4dHMuZnJl
ZV93b3JrKTsKKwlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dHMgKmdjID0KKwkJY29udGFpbmVyX29m
KHdvcmssIHR5cGVvZigqZ2MpLCBmcmVlX3dvcmspOwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7Ci0JY29udGV4dHNfZnJlZShpOTE1KTsKLQltdXRleF91bmxvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCWNvbnRleHRzX2ZsdXNoX2ZyZWUoZ2MpOwogfQogCiB2
b2lkIGk5MTVfZ2VtX2NvbnRleHRfcmVsZWFzZShzdHJ1Y3Qga3JlZiAqcmVmKQogewogCXN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBjb250YWluZXJfb2YocmVmLCB0eXBlb2YoKmN0eCks
IHJlZik7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBjdHgtPmk5MTU7CisJc3Ry
dWN0IGk5MTVfZ2VtX2NvbnRleHRzICpnYyA9ICZjdHgtPmk5MTUtPmdlbS5jb250ZXh0czsKIAog
CXRyYWNlX2k5MTVfY29udGV4dF9mcmVlKGN0eCk7Ci0JaWYgKGxsaXN0X2FkZCgmY3R4LT5mcmVl
X2xpbmssICZpOTE1LT5jb250ZXh0cy5mcmVlX2xpc3QpKQotCQlxdWV1ZV93b3JrKGk5MTUtPndx
LCAmaTkxNS0+Y29udGV4dHMuZnJlZV93b3JrKTsKKwlpZiAobGxpc3RfYWRkKCZjdHgtPmZyZWVf
bGluaywgJmdjLT5mcmVlX2xpc3QpKQorCQlxdWV1ZV93b3JrKGN0eC0+aTkxNS0+d3EsICZnYy0+
ZnJlZV93b3JrKTsKIH0KIAogc3RhdGljIHZvaWQgY29udGV4dF9jbG9zZShzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dCAqY3R4KQogewotCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Nsb3NlZChjdHgpOwor
CXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwogCi0JaWYgKGN0eC0+dm0pCi0JCWk5MTVf
dm1fY2xvc2UoY3R4LT52bSk7CisJaTkxNV9nZW1fY29udGV4dF9zZXRfY2xvc2VkKGN0eCk7CiAK
IAltdXRleF9sb2NrKCZjdHgtPm11dGV4KTsKIAorCXZtID0gaTkxNV9nZW1fY29udGV4dF92bShj
dHgpOworCWlmICh2bSkKKwkJaTkxNV92bV9jbG9zZSh2bSk7CisKIAljdHgtPmZpbGVfcHJpdiA9
IEVSUl9QVFIoLUVCQURGKTsKIAogCS8qCkBAIC0zMTcsNyArMzA3LDYgQEAgX19jcmVhdGVfY29u
dGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJcmV0dXJuIEVSUl9QVFIoLUVO
T01FTSk7CiAKIAlrcmVmX2luaXQoJmN0eC0+cmVmKTsKLQlsaXN0X2FkZF90YWlsKCZjdHgtPmxp
bmssICZpOTE1LT5jb250ZXh0cy5saXN0KTsKIAljdHgtPmk5MTUgPSBpOTE1OwogCWN0eC0+c2No
ZWQucHJpb3JpdHkgPSBJOTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9QUklPUklUWV9OT1JNQUwpOwog
CW11dGV4X2luaXQoJmN0eC0+bXV0ZXgpOwpAQCAtMzQzLDYgKzMzMiwxMCBAQCBfX2NyZWF0ZV9j
b250ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWZvciAoaSA9IDA7IGkgPCBB
UlJBWV9TSVpFKGN0eC0+aGFuZ190aW1lc3RhbXApOyBpKyspCiAJCWN0eC0+aGFuZ190aW1lc3Rh
bXBbaV0gPSBqaWZmaWVzIC0gQ09OVEVYVF9GQVNUX0hBTkdfSklGRklFUzsKIAorCXNwaW5fbG9j
aygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCWxpc3RfYWRkX3RhaWwoJmN0eC0+bGluaywg
Jmk5MTUtPmdlbS5jb250ZXh0cy5saXN0KTsKKwlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRl
eHRzLmxvY2spOworCiAJcmV0dXJuIGN0eDsKIAogZXJyX2ZyZWU6CkBAIC0zNzIsMTEgKzM2NSwx
MSBAQCBzdGF0aWMgdm9pZCBfX2FwcGx5X3BwZ3R0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwg
dm9pZCAqdm0pCiBzdGF0aWMgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqCiBfX3NldF9wcGd0
dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LCBzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNl
ICp2bSkKIHsKLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICpvbGQgPSBjdHgtPnZtOworCXN0
cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKm9sZCA9IGk5MTVfZ2VtX2NvbnRleHRfdm0oY3R4KTsK
IAogCUdFTV9CVUdfT04ob2xkICYmIGk5MTVfdm1faXNfNGx2bCh2bSkgIT0gaTkxNV92bV9pc180
bHZsKG9sZCkpOwogCi0JY3R4LT52bSA9IGk5MTVfdm1fb3Blbih2bSk7CisJcmN1X2Fzc2lnbl9w
b2ludGVyKGN0eC0+dm0sIGk5MTVfdm1fb3Blbih2bSkpOwogCWNvbnRleHRfYXBwbHlfYWxsKGN0
eCwgX19hcHBseV9wcGd0dCwgdm0pOwogCiAJcmV0dXJuIG9sZDsKQEAgLTM4NSw3ICszNzgsNyBA
QCBfX3NldF9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LCBzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bSkKIHN0YXRpYyB2b2lkIF9fYXNzaWduX3BwZ3R0KHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgsCiAJCQkgICBzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkK
IHsKLQlpZiAodm0gPT0gY3R4LT52bSkKKwlpZiAodm0gPT0gcmN1X2FjY2Vzc19wb2ludGVyKGN0
eC0+dm0pKQogCQlyZXR1cm47CiAKIAl2bSA9IF9fc2V0X3BwZ3R0KGN0eCwgdm0pOwpAQCAtNDE3
LDI3ICs0MTAsMjUgQEAgc3RhdGljIHZvaWQgX19hc3NpZ25fdGltZWxpbmUoc3RydWN0IGk5MTVf
Z2VtX2NvbnRleHQgKmN0eCwKIH0KIAogc3RhdGljIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICoK
LWk5MTVfZ2VtX2NyZWF0ZV9jb250ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgdW5zaWduZWQgaW50IGZsYWdzKQoraTkxNV9nZW1fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIHVuc2lnbmVkIGludCBmbGFncykKIHsKIAlzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4OwogCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwotCiAJaWYgKGZsYWdzICYgSTkxNV9DT05URVhUX0NSRUFURV9GTEFH
U19TSU5HTEVfVElNRUxJTkUgJiYKLQkgICAgIUhBU19FWEVDTElTVFMoZGV2X3ByaXYpKQorCSAg
ICAhSEFTX0VYRUNMSVNUUyhpOTE1KSkKIAkJcmV0dXJuIEVSUl9QVFIoLUVJTlZBTCk7CiAKLQkv
KiBSZWFwIHRoZSBtb3N0IHN0YWxlIGNvbnRleHQgKi8KLQljb250ZXh0c19mcmVlX2ZpcnN0KGRl
dl9wcml2KTsKKwkvKiBSZWFwIHRoZSBzdGFsZSBjb250ZXh0cyAqLworCWNvbnRleHRzX2ZsdXNo
X2ZyZWUoJmk5MTUtPmdlbS5jb250ZXh0cyk7CiAKLQljdHggPSBfX2NyZWF0ZV9jb250ZXh0KGRl
dl9wcml2KTsKKwljdHggPSBfX2NyZWF0ZV9jb250ZXh0KGk5MTUpOwogCWlmIChJU19FUlIoY3R4
KSkKIAkJcmV0dXJuIGN0eDsKIAotCWlmIChIQVNfRlVMTF9QUEdUVChkZXZfcHJpdikpIHsKKwlp
ZiAoSEFTX0ZVTExfUFBHVFQoaTkxNSkpIHsKIAkJc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0Owog
Ci0JCXBwZ3R0ID0gaTkxNV9wcGd0dF9jcmVhdGUoZGV2X3ByaXYpOworCQlwcGd0dCA9IGk5MTVf
cHBndHRfY3JlYXRlKGk5MTUpOwogCQlpZiAoSVNfRVJSKHBwZ3R0KSkgewogCQkJRFJNX0RFQlVH
X0RSSVZFUigiUFBHVFQgc2V0dXAgZmFpbGVkICglbGQpXG4iLAogCQkJCQkgUFRSX0VSUihwcGd0
dCkpOwpAQCAtNDQ1LDE0ICs0MzYsMTcgQEAgaTkxNV9nZW1fY3JlYXRlX2NvbnRleHQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1bnNpZ25lZCBpbnQgZmxhZ3MpCiAJCQlyZXR1
cm4gRVJSX0NBU1QocHBndHQpOwogCQl9CiAKKwkJbXV0ZXhfbG9jaygmY3R4LT5tdXRleCk7CiAJ
CV9fYXNzaWduX3BwZ3R0KGN0eCwgJnBwZ3R0LT52bSk7CisJCW11dGV4X3VubG9jaygmY3R4LT5t
dXRleCk7CisKIAkJaTkxNV92bV9wdXQoJnBwZ3R0LT52bSk7CiAJfQogCiAJaWYgKGZsYWdzICYg
STkxNV9DT05URVhUX0NSRUFURV9GTEFHU19TSU5HTEVfVElNRUxJTkUpIHsKIAkJc3RydWN0IGlu
dGVsX3RpbWVsaW5lICp0aW1lbGluZTsKIAotCQl0aW1lbGluZSA9IGludGVsX3RpbWVsaW5lX2Ny
ZWF0ZSgmZGV2X3ByaXYtPmd0LCBOVUxMKTsKKwkJdGltZWxpbmUgPSBpbnRlbF90aW1lbGluZV9j
cmVhdGUoJmk5MTUtPmd0LCBOVUxMKTsKIAkJaWYgKElTX0VSUih0aW1lbGluZSkpIHsKIAkJCWNv
bnRleHRfY2xvc2UoY3R4KTsKIAkJCXJldHVybiBFUlJfQ0FTVCh0aW1lbGluZSk7CkBAIC00OTcs
NDggKzQ5MSw0MCBAQCBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9rZXJuZWwoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsIGludCBwcmlvKQogCXJldHVybiBjdHg7CiB9CiAKLXN0YXRpYyB2
b2lkIGluaXRfY29udGV4dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0aWMg
dm9pZCBpbml0X2NvbnRleHRzKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0cyAqZ2MpCiB7Ci0JbXV0
ZXhfaW5pdCgmaTkxNS0+Y29udGV4dHMubXV0ZXgpOwotCUlOSVRfTElTVF9IRUFEKCZpOTE1LT5j
b250ZXh0cy5saXN0KTsKLQotCS8qIFVzaW5nIHRoZSBzaW1wbGUgaWRhIGludGVyZmFjZSwgdGhl
IG1heCBpcyBsaW1pdGVkIGJ5IHNpemVvZihpbnQpICovCi0JQlVJTERfQlVHX09OKE1BWF9DT05U
RVhUX0hXX0lEID4gSU5UX01BWCk7Ci0JQlVJTERfQlVHX09OKEdFTjExX01BWF9DT05URVhUX0hX
X0lEID4gSU5UX01BWCk7Ci0JaWRhX2luaXQoJmk5MTUtPmNvbnRleHRzLmh3X2lkYSk7Ci0JSU5J
VF9MSVNUX0hFQUQoJmk5MTUtPmNvbnRleHRzLmh3X2lkX2xpc3QpOworCXNwaW5fbG9ja19pbml0
KCZnYy0+bG9jayk7CisJSU5JVF9MSVNUX0hFQUQoJmdjLT5saXN0KTsKIAotCUlOSVRfV09SSygm
aTkxNS0+Y29udGV4dHMuZnJlZV93b3JrLCBjb250ZXh0c19mcmVlX3dvcmtlcik7Ci0JaW5pdF9s
bGlzdF9oZWFkKCZpOTE1LT5jb250ZXh0cy5mcmVlX2xpc3QpOworCUlOSVRfV09SSygmZ2MtPmZy
ZWVfd29yaywgY29udGV4dHNfZnJlZV93b3JrZXIpOworCWluaXRfbGxpc3RfaGVhZCgmZ2MtPmZy
ZWVfbGlzdCk7CiB9CiAKLWludCBpOTE1X2dlbV9jb250ZXh0c19pbml0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKK2ludCBpOTE1X2dlbV9pbml0X2NvbnRleHRzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQogewogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7
CiAKIAkvKiBSZWFzc3VyZSBvdXJzZWx2ZXMgd2UgYXJlIG9ubHkgY2FsbGVkIG9uY2UgKi8KLQlH
RU1fQlVHX09OKGRldl9wcml2LT5rZXJuZWxfY29udGV4dCk7CisJR0VNX0JVR19PTihpOTE1LT5r
ZXJuZWxfY29udGV4dCk7CiAKLQlpbml0X2NvbnRleHRzKGRldl9wcml2KTsKKwlpbml0X2NvbnRl
eHRzKCZpOTE1LT5nZW0uY29udGV4dHMpOwogCiAJLyogbG93ZXN0IHByaW9yaXR5OyBpZGxlIHRh
c2sgKi8KLQljdHggPSBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9rZXJuZWwoZGV2X3ByaXYsIEk5
MTVfUFJJT1JJVFlfTUlOKTsKKwljdHggPSBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9rZXJuZWwo
aTkxNSwgSTkxNV9QUklPUklUWV9NSU4pOwogCWlmIChJU19FUlIoY3R4KSkgewogCQlEUk1fRVJS
T1IoIkZhaWxlZCB0byBjcmVhdGUgZGVmYXVsdCBnbG9iYWwgY29udGV4dFxuIik7CiAJCXJldHVy
biBQVFJfRVJSKGN0eCk7CiAJfQotCWRldl9wcml2LT5rZXJuZWxfY29udGV4dCA9IGN0eDsKKwlp
OTE1LT5rZXJuZWxfY29udGV4dCA9IGN0eDsKIAogCURSTV9ERUJVR19EUklWRVIoIiVzIGNvbnRl
eHQgc3VwcG9ydCBpbml0aWFsaXplZFxuIiwKLQkJCSBEUklWRVJfQ0FQUyhkZXZfcHJpdiktPmhh
c19sb2dpY2FsX2NvbnRleHRzID8KKwkJCSBEUklWRVJfQ0FQUyhpOTE1KS0+aGFzX2xvZ2ljYWxf
Y29udGV4dHMgPwogCQkJICJsb2dpY2FsIiA6ICJmYWtlIik7CiAJcmV0dXJuIDA7CiB9CiAKLXZv
aWQgaTkxNV9nZW1fY29udGV4dHNfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
K3ZvaWQgaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2VfX2NvbnRleHRzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQogewotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwotCiAJZGVzdHJveV9rZXJuZWxfY29udGV4dCgmaTkxNS0+a2VybmVsX2NvbnRleHQp
OwogfQogCkBAIC01NTcsMTEgKzU0MywxNiBAQCBzdGF0aWMgaW50IHZtX2lkcl9jbGVhbnVwKGlu
dCBpZCwgdm9pZCAqcCwgdm9pZCAqZGF0YSkKIHN0YXRpYyBpbnQgZ2VtX2NvbnRleHRfcmVnaXN0
ZXIoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAkJCQlzdHJ1Y3QgZHJtX2k5MTVfZmls
ZV9wcml2YXRlICpmcHJpdikKIHsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKIAlp
bnQgcmV0OwogCiAJY3R4LT5maWxlX3ByaXYgPSBmcHJpdjsKLQlpZiAoY3R4LT52bSkKLQkJY3R4
LT52bS0+ZmlsZSA9IGZwcml2OworCisJbXV0ZXhfbG9jaygmY3R4LT5tdXRleCk7CisJdm0gPSBp
OTE1X2dlbV9jb250ZXh0X3ZtKGN0eCk7CisJaWYgKHZtKQorCQlXUklURV9PTkNFKHZtLT5maWxl
LCBmcHJpdik7IC8qIFhYWCAqLworCW11dGV4X3VubG9jaygmY3R4LT5tdXRleCk7CiAKIAljdHgt
PnBpZCA9IGdldF90YXNrX3BpZChjdXJyZW50LCBQSURUWVBFX1BJRCk7CiAJY3R4LT5uYW1lID0g
a2FzcHJpbnRmKEdGUF9LRVJORUwsICIlc1slZF0iLApAQCAtNTk4LDkgKzU4OSw3IEBAIGludCBp
OTE1X2dlbV9jb250ZXh0X29wZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJaWRy
X2luaXQoJmZpbGVfcHJpdi0+Y29udGV4dF9pZHIpOwogCWlkcl9pbml0X2Jhc2UoJmZpbGVfcHJp
di0+dm1faWRyLCAxKTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwog
CWN0eCA9IGk5MTVfZ2VtX2NyZWF0ZV9jb250ZXh0KGk5MTUsIDApOwotCW11dGV4X3VubG9jaygm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYgKElTX0VSUihjdHgpKSB7CiAJCWVyciA9IFBU
Ul9FUlIoY3R4KTsKIAkJZ290byBlcnI7CkBAIC02MjgsNiArNjE3LDcgQEAgaW50IGk5MTVfZ2Vt
X2NvbnRleHRfb3BlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIHZvaWQgaTkxNV9n
ZW1fY29udGV4dF9jbG9zZShzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCiB7CiAJc3RydWN0IGRybV9p
OTE1X2ZpbGVfcHJpdmF0ZSAqZmlsZV9wcml2ID0gZmlsZS0+ZHJpdmVyX3ByaXY7CisJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBmaWxlX3ByaXYtPmRldl9wcml2OwogCiAJaWRyX2Zv
cl9lYWNoKCZmaWxlX3ByaXYtPmNvbnRleHRfaWRyLCBjb250ZXh0X2lkcl9jbGVhbnVwLCBOVUxM
KTsKIAlpZHJfZGVzdHJveSgmZmlsZV9wcml2LT5jb250ZXh0X2lkcik7CkBAIC02MzYsNiArNjI2
LDggQEAgdm9pZCBpOTE1X2dlbV9jb250ZXh0X2Nsb3NlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkK
IAlpZHJfZm9yX2VhY2goJmZpbGVfcHJpdi0+dm1faWRyLCB2bV9pZHJfY2xlYW51cCwgTlVMTCk7
CiAJaWRyX2Rlc3Ryb3koJmZpbGVfcHJpdi0+dm1faWRyKTsKIAltdXRleF9kZXN0cm95KCZmaWxl
X3ByaXYtPnZtX2lkcl9sb2NrKTsKKworCWNvbnRleHRzX2ZsdXNoX2ZyZWUoJmk5MTUtPmdlbS5j
b250ZXh0cyk7CiB9CiAKIGludCBpOTE1X2dlbV92bV9jcmVhdGVfaW9jdGwoc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKQEAgLTgxNCwxNiArODA2LDEyIEBAIHN0YXRpYyBpbnQg
Z2V0X3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZhdGUgKmZpbGVfcHJpdiwKIAlzdHJ1
Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKIAlpbnQgcmV0OwogCi0JaWYgKCFjdHgtPnZtKQor
CWlmICghcmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pKQogCQlyZXR1cm4gLUVOT0RFVjsKIAot
CS8qIFhYWCByY3UgYWNxdWlyZT8gKi8KLQlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUo
JmN0eC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsK
LQorCXJjdV9yZWFkX2xvY2soKTsKIAl2bSA9IGk5MTVfdm1fZ2V0KGN0eC0+dm0pOwotCW11dGV4
X3VubG9jaygmY3R4LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwlyY3VfcmVhZF91bmxvY2so
KTsKIAogCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZmlsZV9wcml2LT52bV9pZHJf
bG9jayk7CiAJaWYgKHJldCkKQEAgLTkzMiw3ICs5MjAsNyBAQCBzdGF0aWMgaW50IHNldF9wcGd0
dChzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYsCiAJaWYgKGFyZ3MtPnNp
emUpCiAJCXJldHVybiAtRUlOVkFMOwogCi0JaWYgKCFjdHgtPnZtKQorCWlmICghcmN1X2FjY2Vz
c19wb2ludGVyKGN0eC0+dm0pKQogCQlyZXR1cm4gLUVOT0RFVjsKIAogCWlmICh1cHBlcl8zMl9i
aXRzKGFyZ3MtPnZhbHVlKSkKQEAgLTk0NiwxNyArOTM0LDIwIEBAIHN0YXRpYyBpbnQgc2V0X3Bw
Z3R0KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZhdGUgKmZpbGVfcHJpdiwKIAlpZiAoIXZtKQog
CQlyZXR1cm4gLUVOT0VOVDsKIAotCWVyciA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmY3R4
LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwllcnIgPSBtdXRleF9sb2NrX2ludGVycnVwdGli
bGUoJmN0eC0+bXV0ZXgpOwogCWlmIChlcnIpCiAJCWdvdG8gb3V0OwogCi0JaWYgKHZtID09IGN0
eC0+dm0pCisJaWYgKGk5MTVfZ2VtX2NvbnRleHRfaXNfY2xvc2VkKGN0eCkpIHsKKwkJZXJyID0g
LUVOT0VOVDsKKwkJZ290byBvdXQ7CisJfQorCisJaWYgKHZtID09IHJjdV9hY2Nlc3NfcG9pbnRl
cihjdHgtPnZtKSkKIAkJZ290byB1bmxvY2s7CiAKIAkvKiBUZWFyZG93biB0aGUgZXhpc3Rpbmcg
b2JqOnZtYSBjYWNoZSwgaXQgd2lsbCBoYXZlIHRvIGJlIHJlYnVpbHQuICovCi0JbXV0ZXhfbG9j
aygmY3R4LT5tdXRleCk7CiAJbHV0X2Nsb3NlKGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZjdHgtPm11
dGV4KTsKIAogCW9sZCA9IF9fc2V0X3BwZ3R0KGN0eCwgdm0pOwogCkBAIC05NzYsOCArOTY3LDcg
QEAgc3RhdGljIGludCBzZXRfcHBndHQoc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZmls
ZV9wcml2LAogCX0KIAogdW5sb2NrOgotCW11dGV4X3VubG9jaygmY3R4LT5pOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKLQorCW11dGV4X3VubG9jaygmY3R4LT5tdXRleCk7CiBvdXQ6CiAJaTkxNV92
bV9wdXQodm0pOwogCXJldHVybiBlcnI7CkBAIC0xODM2LDcgKzE4MjYsNyBAQCBzdGF0aWMgaW50
IGNsb25lX3ZtKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpkc3QsCiAKIAlyY3VfcmVhZF9sb2Nr
KCk7CiAJZG8gewotCQl2bSA9IFJFQURfT05DRShzcmMtPnZtKTsKKwkJdm0gPSByY3VfZGVyZWZl
cmVuY2Uoc3JjLT52bSk7CiAJCWlmICghdm0pCiAJCQlicmVhazsKIApAQCAtMTg1OCw3ICsxODQ4
LDcgQEAgc3RhdGljIGludCBjbG9uZV92bShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqZHN0LAog
CQkgKiBpdCBjYW5ub3QgYmUgcmVhbGxvY2F0ZWQgZWxzZXdoZXJlLgogCQkgKi8KIAotCQlpZiAo
dm0gPT0gUkVBRF9PTkNFKHNyYy0+dm0pKQorCQlpZiAodm0gPT0gcmN1X2FjY2Vzc19wb2ludGVy
KHNyYy0+dm0pKQogCQkJYnJlYWs7CiAKIAkJaTkxNV92bV9wdXQodm0pOwpAQCAtMTk2MCwxMiAr
MTk1MCw3IEBAIGludCBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9pb2N0bChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQlyZXR1cm4gLUVJTzsKIAl9CiAKLQlyZXQgPSBpOTE1
X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZShkZXYpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7
Ci0KIAlleHRfZGF0YS5jdHggPSBpOTE1X2dlbV9jcmVhdGVfY29udGV4dChpOTE1LCBhcmdzLT5m
bGFncyk7Ci0JbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7CiAJaWYgKElTX0VSUihl
eHRfZGF0YS5jdHgpKQogCQlyZXR1cm4gUFRSX0VSUihleHRfZGF0YS5jdHgpOwogCkBAIC0yMDky
LDEwICsyMDc3LDEyIEBAIGludCBpOTE1X2dlbV9jb250ZXh0X2dldHBhcmFtX2lvY3RsKHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAKIAljYXNlIEk5MTVfQ09OVEVYVF9QQVJB
TV9HVFRfU0laRToKIAkJYXJncy0+c2l6ZSA9IDA7Ci0JCWlmIChjdHgtPnZtKQotCQkJYXJncy0+
dmFsdWUgPSBjdHgtPnZtLT50b3RhbDsKKwkJcmN1X3JlYWRfbG9jaygpOworCQlpZiAocmN1X2Fj
Y2Vzc19wb2ludGVyKGN0eC0+dm0pKQorCQkJYXJncy0+dmFsdWUgPSByY3VfZGVyZWZlcmVuY2Uo
Y3R4LT52bSktPnRvdGFsOwogCQllbHNlCiAJCQlhcmdzLT52YWx1ZSA9IHRvX2k5MTUoZGV2KS0+
Z2d0dC52bS50b3RhbDsKKwkJcmN1X3JlYWRfdW5sb2NrKCk7CiAJCWJyZWFrOwogCiAJY2FzZSBJ
OTE1X0NPTlRFWFRfUEFSQU1fTk9fRVJST1JfQ0FQVFVSRToKQEAgLTIxNjEsNyArMjE0OCw3IEBA
IGludCBpOTE1X2dlbV9jb250ZXh0X3NldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYsIHZvaWQgKmRhdGEsCiBpbnQgaTkxNV9nZW1fY29udGV4dF9yZXNldF9zdGF0c19pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkJCSAgICAgICB2b2lkICpkYXRhLCBzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGUpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShkZXYpOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYp
OwogCXN0cnVjdCBkcm1faTkxNV9yZXNldF9zdGF0cyAqYXJncyA9IGRhdGE7CiAJc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHQgKmN0eDsKIAlpbnQgcmV0OwpAQCAtMjE4Myw3ICsyMTcwLDcgQEAgaW50
IGk5MTVfZ2VtX2NvbnRleHRfcmVzZXRfc3RhdHNfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwKIAkgKi8KIAogCWlmIChjYXBhYmxlKENBUF9TWVNfQURNSU4pKQotCQlhcmdzLT5yZXNldF9j
b3VudCA9IGk5MTVfcmVzZXRfY291bnQoJmRldl9wcml2LT5ncHVfZXJyb3IpOworCQlhcmdzLT5y
ZXNldF9jb3VudCA9IGk5MTVfcmVzZXRfY291bnQoJmk5MTUtPmdwdV9lcnJvcik7CiAJZWxzZQog
CQlhcmdzLT5yZXNldF9jb3VudCA9IDA7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fY29udGV4dC5oCmluZGV4IDUwYmMyN2QzMGMwMy4uOTIzNDU4NjgzMGQxIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKQEAgLTExLDcgKzExLDkg
QEAKIAogI2luY2x1ZGUgImd0L2ludGVsX2NvbnRleHQuaCIKIAorI2luY2x1ZGUgImk5MTVfZHJ2
LmgiCiAjaW5jbHVkZSAiaTkxNV9nZW0uaCIKKyNpbmNsdWRlICJpOTE1X2dlbV9ndHQuaCIKICNp
bmNsdWRlICJpOTE1X3NjaGVkdWxlci5oIgogI2luY2x1ZGUgImludGVsX2RldmljZV9pbmZvLmgi
CiAKQEAgLTExOCw4ICsxMjAsOCBAQCBzdGF0aWMgaW5saW5lIGJvb2wgaTkxNV9nZW1fY29udGV4
dF9pc19rZXJuZWwoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIH0KIAogLyogaTkxNV9n
ZW1fY29udGV4dC5jICovCi1pbnQgX19tdXN0X2NoZWNrIGk5MTVfZ2VtX2NvbnRleHRzX2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQgaTkxNV9nZW1fY29udGV4
dHNfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOworaW50IF9fbXVzdF9j
aGVjayBpOTE1X2dlbV9pbml0X2NvbnRleHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KTsKK3ZvaWQgaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2VfX2NvbnRleHRzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKIAogaW50IGk5MTVfZ2VtX2NvbnRleHRfb3BlbihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCSAgc3RydWN0IGRybV9maWxlICpmaWxlKTsKQEAgLTE1
OCw2ICsxNjAsMjcgQEAgc3RhdGljIGlubGluZSB2b2lkIGk5MTVfZ2VtX2NvbnRleHRfcHV0KHN0
cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJa3JlZl9wdXQoJmN0eC0+cmVmLCBpOTE1X2dl
bV9jb250ZXh0X3JlbGVhc2UpOwogfQogCitzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2FkZHJl
c3Nfc3BhY2UgKgoraTkxNV9nZW1fY29udGV4dF92bShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
Y3R4KQoreworCXJldHVybiByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKGN0eC0+dm0sIGxvY2tk
ZXBfaXNfaGVsZCgmY3R4LT5tdXRleCkpOworfQorCitzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1
X2FkZHJlc3Nfc3BhY2UgKgoraTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgpCit7CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07CisK
KwlyY3VfcmVhZF9sb2NrKCk7CisJdm0gPSByY3VfZGVyZWZlcmVuY2UoY3R4LT52bSk7CisJaWYg
KCF2bSkKKwkJdm0gPSAmY3R4LT5pOTE1LT5nZ3R0LnZtOworCXZtID0gaTkxNV92bV9nZXQodm0p
OworCXJjdV9yZWFkX3VubG9jaygpOworCisJcmV0dXJuIHZtOworfQorCiBzdGF0aWMgaW5saW5l
IHN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzICoKIGk5MTVfZ2VtX2NvbnRleHRfZW5naW5lcyhzdHJ1
Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmgKaW5kZXggODdiZTI3ODc3ZTIyLi5hYjhlMTM2
N2RmYzggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250
ZXh0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRl
eHRfdHlwZXMuaApAQCAtODgsNyArODgsNyBAQCBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCB7CiAJ
ICogSW4gb3RoZXIgbW9kZXMsIHRoaXMgaXMgYSBOVUxMIHBvaW50ZXIgd2l0aCB0aGUgZXhwZWN0
YXRpb24gdGhhdAogCSAqIHRoZSBjYWxsZXIgdXNlcyB0aGUgc2hhcmVkIGdsb2JhbCBHVFQuCiAJ
ICovCi0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07CisJc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSBfX3JjdSAqdm07CiAKIAkvKioKIAkgKiBAcGlkOiBwcm9jZXNzIGlkIG9mIGNyZWF0
b3IKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVm
ZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCmlu
ZGV4IDg4YTg4MWJlMTJlYy4uOTg4MTZjMzVmZmMzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKQEAgLTcyOCw3ICs3MjgsNyBAQCBzdGF0aWMg
aW50IGViX3NlbGVjdF9jb250ZXh0KHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViKQogCQlyZXR1
cm4gLUVOT0VOVDsKIAogCWViLT5nZW1fY29udGV4dCA9IGN0eDsKLQlpZiAoY3R4LT52bSkKKwlp
ZiAocmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pKQogCQllYi0+aW52YWxpZF9mbGFncyB8PSBF
WEVDX09CSkVDVF9ORUVEU19HVFQ7CiAKIAllYi0+Y29udGV4dF9mbGFncyA9IDA7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNlcnB0ci5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYwppbmRleCAxNzM4YTE1ZWI5MTEu
LjRmOTcwNDc0MDEzZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX3VzZXJwdHIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNl
cnB0ci5jCkBAIC03NTgsNyArNzU4LDggQEAgaTkxNV9nZW1fdXNlcnB0cl9pb2N0bChzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LAogCQkgKiBPbiBhbG1vc3QgYWxsIG9mIHRoZSBvbGRlciBodywgd2Ug
Y2Fubm90IHRlbGwgdGhlIEdQVSB0aGF0CiAJCSAqIGEgcGFnZSBpcyByZWFkb25seS4KIAkJICov
Ci0JCXZtID0gZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0LT52bTsKKwkJdm0gPSByY3VfZGVyZWZl
cmVuY2VfcHJvdGVjdGVkKGRldl9wcml2LT5rZXJuZWxfY29udGV4dC0+dm0sCisJCQkJCSAgICAg
ICB0cnVlKTsgLyogc3RhdGljIHZtICovCiAJCWlmICghdm0gfHwgIXZtLT5oYXNfcmVhZF9vbmx5
KQogCQkJcmV0dXJuIC1FTk9ERVY7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
c2VsZnRlc3RzL2h1Z2VfcGFnZXMuYwppbmRleCA5OGIyYTZjY2ZjYzEuLjMzMTQ4NThmMzA0NiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2Vz
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMK
QEAgLTEzMjIsMTUgKzEzMjIsMTUgQEAgc3RhdGljIGludCBpZ3RfcHBndHRfcGluX3VwZGF0ZSh2
b2lkICphcmcpCiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9IGFyZzsKIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBjdHgtPmk5MTU7CiAJdW5zaWduZWQgbG9uZyBz
dXBwb3J0ZWQgPSBJTlRFTF9JTkZPKGRldl9wcml2KS0+cGFnZV9zaXplczsKLQlzdHJ1Y3QgaTkx
NV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm07CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iajsKIAlzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVyIGl0OworCXN0cnVjdCBpOTE1
X2FkZHJlc3Nfc3BhY2UgKnZtOwogCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKIAlzdHJ1Y3Qg
aTkxNV92bWEgKnZtYTsKIAl1bnNpZ25lZCBpbnQgZmxhZ3MgPSBQSU5fVVNFUiB8IFBJTl9PRkZT
RVRfRklYRUQ7CiAJdW5zaWduZWQgaW50IG47CiAJaW50IGZpcnN0LCBsYXN0OwotCWludCBlcnI7
CisJaW50IGVyciA9IDA7CiAKIAkvKgogCSAqIE1ha2Ugc3VyZSB0aGVyZSdzIG5vIGZ1bm55IGJ1
c2luZXNzIHdoZW4gZG9pbmcgYSBQSU5fVVBEQVRFIC0tIGluIHRoZQpAQCAtMTM0MCw5ICsxMzQw
LDEwIEBAIHN0YXRpYyBpbnQgaWd0X3BwZ3R0X3Bpbl91cGRhdGUodm9pZCAqYXJnKQogCSAqIGh1
Z2UtZ3R0LXBhZ2VzLgogCSAqLwogCi0JaWYgKCF2bSB8fCAhaTkxNV92bV9pc180bHZsKHZtKSkg
eworCXZtID0gaTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KGN0eCk7CisJaWYgKCFpOTE1X3Zt
X2lzXzRsdmwodm0pKSB7CiAJCXByX2luZm8oIjQ4YiBQUEdUVCBub3Qgc3VwcG9ydGVkLCBza2lw
cGluZ1xuIik7Ci0JCXJldHVybiAwOworCQlnb3RvIG91dF92bTsKIAl9CiAKIAlmaXJzdCA9IGls
b2cyKEk5MTVfR1RUX1BBR0VfU0laRV82NEspOwpAQCAtMTQ1MSw2ICsxNDUyLDggQEAgc3RhdGlj
IGludCBpZ3RfcHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcpCiAJaTkxNV92bWFfY2xvc2Uodm1h
KTsKIG91dF9wdXQ6CiAJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworb3V0X3ZtOgorCWk5MTVf
dm1fcHV0KHZtKTsKIAogCXJldHVybiBlcnI7CiB9CkBAIC0xNDYwLDcgKzE0NjMsNyBAQCBzdGF0
aWMgaW50IGlndF90bXBmc19mYWxsYmFjayh2b2lkICphcmcpCiAJc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eCA9IGFyZzsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+
aTkxNTsKIAlzdHJ1Y3QgdmZzbW91bnQgKmdlbWZzID0gaTkxNS0+bW0uZ2VtZnM7Ci0Jc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBjdHgtPnZtID86ICZpOTE1LT5nZ3R0LnZtOworCXN0
cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gaTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1
KGN0eCk7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3QgaTkxNV92
bWEgKnZtYTsKIAl1MzIgKnZhZGRyOwpAQCAtMTUxMCw2ICsxNTEzLDcgQEAgc3RhdGljIGludCBp
Z3RfdG1wZnNfZmFsbGJhY2sodm9pZCAqYXJnKQogb3V0X3Jlc3RvcmU6CiAJaTkxNS0+bW0uZ2Vt
ZnMgPSBnZW1mczsKIAorCWk5MTVfdm1fcHV0KHZtKTsKIAlyZXR1cm4gZXJyOwogfQogCkBAIC0x
NTE3LDE0ICsxNTIxLDE0IEBAIHN0YXRpYyBpbnQgaWd0X3Nocmlua190aHAodm9pZCAqYXJnKQog
ewogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBhcmc7CiAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBjdHgtPmk5MTU7Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm0gPSBjdHgtPnZtID86ICZpOTE1LT5nZ3R0LnZtOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3Bh
Y2UgKnZtID0gaTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KGN0eCk7CiAJc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVyIGl0Owog
CXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAl1bnNp
Z25lZCBpbnQgZmxhZ3MgPSBQSU5fVVNFUjsKIAl1bnNpZ25lZCBpbnQgbjsKLQlpbnQgZXJyOwor
CWludCBlcnIgPSAwOwogCiAJLyoKIAkgKiBTYW5pdHkgY2hlY2sgc2hyaW5raW5nIGh1Z2UtcGFn
ZWQgb2JqZWN0IC0tIG1ha2Ugc3VyZSBub3RoaW5nIGJsb3dzCkBAIC0xNTMzLDEyICsxNTM3LDE0
IEBAIHN0YXRpYyBpbnQgaWd0X3Nocmlua190aHAodm9pZCAqYXJnKQogCiAJaWYgKCFpZ3RfY2Fu
X2FsbG9jYXRlX3RocChpOTE1KSkgewogCQlwcl9pbmZvKCJtaXNzaW5nIFRIUCBzdXBwb3J0LCBz
a2lwcGluZ1xuIik7Ci0JCXJldHVybiAwOworCQlnb3RvIG91dF92bTsKIAl9CiAKIAlvYmogPSBp
OTE1X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtKGk5MTUsIFNaXzJNKTsKLQlpZiAoSVNfRVJSKG9i
aikpCi0JCXJldHVybiBQVFJfRVJSKG9iaik7CisJaWYgKElTX0VSUihvYmopKSB7CisJCWVyciA9
IFBUUl9FUlIob2JqKTsKKwkJZ290byBvdXRfdm07CisJfQogCiAJdm1hID0gaTkxNV92bWFfaW5z
dGFuY2Uob2JqLCB2bSwgTlVMTCk7CiAJaWYgKElTX0VSUih2bWEpKSB7CkBAIC0xNjA3LDYgKzE2
MTMsOCBAQCBzdGF0aWMgaW50IGlndF9zaHJpbmtfdGhwKHZvaWQgKmFyZykKIAlpOTE1X3ZtYV9j
bG9zZSh2bWEpOwogb3V0X3B1dDoKIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CitvdXRfdm06
CisJaTkxNV92bV9wdXQodm0pOwogCiAJcmV0dXJuIGVycjsKIH0KQEAgLTE2NzUsNiArMTY4Myw3
IEBAIGludCBpOTE1X2dlbV9odWdlX3BhZ2VfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCiAJfTsKIAlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7CiAJc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHQgKmN0eDsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKIAlp
bnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAlpbnQgZXJyOwogCkBAIC0xNjk5LDggKzE3MDgsMTEg
QEAgaW50IGk5MTVfZ2VtX2h1Z2VfcGFnZV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KIAotCWlmIChjdHgtPnZtKQot
CQljdHgtPnZtLT5zY3J1Yl82NEsgPSB0cnVlOworCW11dGV4X2xvY2soJmN0eC0+bXV0ZXgpOwor
CXZtID0gaTkxNV9nZW1fY29udGV4dF92bShjdHgpOworCWlmICh2bSkKKwkJV1JJVEVfT05DRSh2
bS0+c2NydWJfNjRLLCB0cnVlKTsKKwltdXRleF91bmxvY2soJmN0eC0+bXV0ZXgpOwogCiAJZXJy
ID0gaTkxNV9zdWJ0ZXN0cyh0ZXN0cywgY3R4KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYwppbmRleCAyZmIzMWFkYTJm
YTcuLjY5YTg2ZmMxZTM5YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTUzLDE5ICs1MywxNyBAQCBzdGF0aWMg
aW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICphcmcpCiAJaWYgKElTX0VSUihmaWxlKSkKIAkJcmV0
dXJuIFBUUl9FUlIoZmlsZSk7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKLQogCWN0eCA9IGtjYWxsb2MobmN0eCwgc2l6ZW9mKCpjdHgpLCBHRlBfS0VSTkVMKTsKIAlp
ZiAoIWN0eCkgewogCQllcnIgPSAtRU5PTUVNOwotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8g
b3V0X2ZpbGU7CiAJfQogCiAJZm9yIChuID0gMDsgbiA8IG5jdHg7IG4rKykgewogCQljdHhbbl0g
PSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7CiAJCWlmIChJU19FUlIoY3R4W25dKSkgewogCQkJ
ZXJyID0gUFRSX0VSUihjdHhbbl0pOwotCQkJZ290byBvdXRfdW5sb2NrOworCQkJZ290byBvdXRf
ZmlsZTsKIAkJfQogCX0KIApAQCAtNzksNyArNzcsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3
aXRjaCh2b2lkICphcmcpCiAJCQlycSA9IGlndF9yZXF1ZXN0X2FsbG9jKGN0eFtuXSwgZW5naW5l
KTsKIAkJCWlmIChJU19FUlIocnEpKSB7CiAJCQkJZXJyID0gUFRSX0VSUihycSk7Ci0JCQkJZ290
byBvdXRfdW5sb2NrOworCQkJCWdvdG8gb3V0X2ZpbGU7CiAJCQl9CiAJCQlpOTE1X3JlcXVlc3Rf
YWRkKHJxKTsKIAkJfQpAQCAtODcsNyArODUsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRj
aCh2b2lkICphcmcpCiAJCQlwcl9lcnIoIkZhaWxlZCB0byBwb3B1bGF0ZWQgJWQgY29udGV4dHNc
biIsIG5jdHgpOwogCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCQkJZXJyID0g
LUVJTzsKLQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCWdvdG8gb3V0X2ZpbGU7CiAJCX0KIAogCQl0
aW1lc1sxXSA9IGt0aW1lX2dldF9yYXcoKTsKQEAgLTk3LDcgKzk1LDcgQEAgc3RhdGljIGludCBs
aXZlX25vcF9zd2l0Y2godm9pZCAqYXJnKQogCiAJCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4o
JnQsIGk5MTUsIF9fZnVuY19fLCBlbmdpbmUtPm5hbWUpOwogCQlpZiAoZXJyKQotCQkJZ290byBv
dXRfdW5sb2NrOworCQkJZ290byBvdXRfZmlsZTsKIAogCQllbmRfdGltZSA9IGppZmZpZXMgKyBp
OTE1X3NlbGZ0ZXN0LnRpbWVvdXRfamlmZmllczsKIAkJZm9yX2VhY2hfcHJpbWVfbnVtYmVyX2Zy
b20ocHJpbWUsIDIsIDgxOTIpIHsKQEAgLTEwNyw3ICsxMDUsNyBAQCBzdGF0aWMgaW50IGxpdmVf
bm9wX3N3aXRjaCh2b2lkICphcmcpCiAJCQkJcnEgPSBpZ3RfcmVxdWVzdF9hbGxvYyhjdHhbbiAl
IG5jdHhdLCBlbmdpbmUpOwogCQkJCWlmIChJU19FUlIocnEpKSB7CiAJCQkJCWVyciA9IFBUUl9F
UlIocnEpOwotCQkJCQlnb3RvIG91dF91bmxvY2s7CisJCQkJCWdvdG8gb3V0X2ZpbGU7CiAJCQkJ
fQogCiAJCQkJLyoKQEAgLTE0Myw3ICsxNDEsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRj
aCh2b2lkICphcmcpCiAKIAkJZXJyID0gaWd0X2xpdmVfdGVzdF9lbmQoJnQpOwogCQlpZiAoZXJy
KQotCQkJZ290byBvdXRfdW5sb2NrOworCQkJZ290byBvdXRfZmlsZTsKIAogCQlwcl9pbmZvKCJT
d2l0Y2ggbGF0ZW5jaWVzIG9uICVzOiAxID0gJWxsdW5zLCAlbHUgPSAlbGx1bnNcbiIsCiAJCQll
bmdpbmUtPm5hbWUsCkBAIC0xNTEsOCArMTQ5LDcgQEAgc3RhdGljIGludCBsaXZlX25vcF9zd2l0
Y2godm9pZCAqYXJnKQogCQkJcHJpbWUgLSAxLCBkaXY2NF91NjQoa3RpbWVfdG9fbnModGltZXNb
MV0pLCBwcmltZSAtIDEpKTsKIAl9CiAKLW91dF91bmxvY2s6Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKK291dF9maWxlOgogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZp
bGUpOwogCXJldHVybiBlcnI7CiB9CkBAIC0yNTMsMTIgKzI1MCwxMCBAQCBzdGF0aWMgaW50IGxp
dmVfcGFyYWxsZWxfc3dpdGNoKHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1
cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
OwotCiAJY3R4ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIoY3R4KSkg
ewogCQllcnIgPSBQVFJfRVJSKGN0eCk7Ci0JCWdvdG8gb3V0X2xvY2tlZDsKKwkJZ290byBvdXRf
ZmlsZTsKIAl9CiAKIAllbmdpbmVzID0gaTkxNV9nZW1fY29udGV4dF9sb2NrX2VuZ2luZXMoY3R4
KTsKQEAgLTI2OCw3ICsyNjMsNyBAQCBzdGF0aWMgaW50IGxpdmVfcGFyYWxsZWxfc3dpdGNoKHZv
aWQgKmFyZykKIAlpZiAoIWRhdGEpIHsKIAkJaTkxNV9nZW1fY29udGV4dF91bmxvY2tfZW5naW5l
cyhjdHgpOwogCQllcnIgPSAtRU5PTUVNOwotCQlnb3RvIG91dF9sb2NrZWQ7CisJCWdvdG8gb3V0
OwogCX0KIAogCW0gPSAwOyAvKiBVc2UgdGhlIGZpcnN0IGNvbnRleHQgYXMgb3VyIHRlbXBsYXRl
IGZvciB0aGUgZW5naW5lcyAqLwpAQCAtMjc2LDcgKzI3MSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9w
YXJhbGxlbF9zd2l0Y2godm9pZCAqYXJnKQogCQllcnIgPSBpbnRlbF9jb250ZXh0X3BpbihjZSk7
CiAJCWlmIChlcnIpIHsKIAkJCWk5MTVfZ2VtX2NvbnRleHRfdW5sb2NrX2VuZ2luZXMoY3R4KTsK
LQkJCWdvdG8gb3V0X2xvY2tlZDsKKwkJCWdvdG8gb3V0OwogCQl9CiAJCWRhdGFbbSsrXS5jZVsw
XSA9IGludGVsX2NvbnRleHRfZ2V0KGNlKTsKIAl9CkBAIC0yODcsNyArMjgyLDcgQEAgc3RhdGlj
IGludCBsaXZlX3BhcmFsbGVsX3N3aXRjaCh2b2lkICphcmcpCiAJCWN0eCA9IGxpdmVfY29udGV4
dChpOTE1LCBmaWxlKTsKIAkJaWYgKElTX0VSUihjdHgpKSB7CiAJCQllcnIgPSBQVFJfRVJSKGN0
eCk7Ci0JCQlnb3RvIG91dF9sb2NrZWQ7CisJCQlnb3RvIG91dDsKIAkJfQogCiAJCWZvciAobSA9
IDA7IG0gPCBjb3VudDsgbSsrKSB7CkBAIC0yOTYsMjAgKzI5MSwxOCBAQCBzdGF0aWMgaW50IGxp
dmVfcGFyYWxsZWxfc3dpdGNoKHZvaWQgKmFyZykKIAogCQkJY2UgPSBpbnRlbF9jb250ZXh0X2Ny
ZWF0ZShjdHgsIGRhdGFbbV0uY2VbMF0tPmVuZ2luZSk7CiAJCQlpZiAoSVNfRVJSKGNlKSkKLQkJ
CQlnb3RvIG91dF9sb2NrZWQ7CisJCQkJZ290byBvdXQ7CiAKIAkJCWVyciA9IGludGVsX2NvbnRl
eHRfcGluKGNlKTsKIAkJCWlmIChlcnIpIHsKIAkJCQlpbnRlbF9jb250ZXh0X3B1dChjZSk7Ci0J
CQkJZ290byBvdXRfbG9ja2VkOworCQkJCWdvdG8gb3V0OwogCQkJfQogCiAJCQlkYXRhW21dLmNl
W25dID0gY2U7CiAJCX0KIAl9CiAKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwotCiAJZm9yIChmbiA9IGZ1bmM7ICFlcnIgJiYgKmZuOyBmbisrKSB7CiAJCXN0cnVjdCBp
Z3RfbGl2ZV90ZXN0IHQ7CiAJCWludCBuOwpAQCAtMzU0LDggKzM0Nyw3IEBAIHN0YXRpYyBpbnQg
bGl2ZV9wYXJhbGxlbF9zd2l0Y2godm9pZCAqYXJnKQogCQltdXRleF91bmxvY2soJmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwogCX0KIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwotb3V0X2xvY2tlZDoKK291dDoKIAlmb3IgKG4gPSAwOyBuIDwgY291bnQ7IG4rKykgewog
CQlmb3IgKG0gPSAwOyBtIDwgQVJSQVlfU0laRShkYXRhLT5jZSk7IG0rKykgewogCQkJaWYgKCFk
YXRhW25dLmNlW21dKQpAQCAtMzY1LDggKzM1Nyw4IEBAIHN0YXRpYyBpbnQgbGl2ZV9wYXJhbGxl
bF9zd2l0Y2godm9pZCAqYXJnKQogCQkJaW50ZWxfY29udGV4dF9wdXQoZGF0YVtuXS5jZVttXSk7
CiAJCX0KIAl9Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlrZnJl
ZShkYXRhKTsKK291dF9maWxlOgogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwogCXJldHVy
biBlcnI7CiB9CkBAIC02MjYsMTEgKzYxOCw5IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9leGVjKHZv
aWQgKmFyZykKIAkJaWYgKElTX0VSUihmaWxlKSkKIAkJCXJldHVybiBQVFJfRVJSKGZpbGUpOwog
Ci0JCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJCWVyciA9IGlndF9s
aXZlX3Rlc3RfYmVnaW4oJnQsIGk5MTUsIF9fZnVuY19fLCBlbmdpbmUtPm5hbWUpOwogCQlpZiAo
ZXJyKQotCQkJZ290byBvdXRfdW5sb2NrOworCQkJZ290byBvdXRfZmlsZTsKIAogCQluY29udGV4
dHMgPSAwOwogCQluZHdvcmRzID0gMDsKQEAgLTY0Miw3ICs2MzIsNyBAQCBzdGF0aWMgaW50IGln
dF9jdHhfZXhlYyh2b2lkICphcmcpCiAJCQljdHggPSBrZXJuZWxfY29udGV4dChpOTE1KTsKIAkJ
CWlmIChJU19FUlIoY3R4KSkgewogCQkJCWVyciA9IFBUUl9FUlIoY3R4KTsKLQkJCQlnb3RvIG91
dF91bmxvY2s7CisJCQkJZ290byBvdXRfZmlsZTsKIAkJCX0KIAogCQkJY2UgPSBpOTE1X2dlbV9j
b250ZXh0X2dldF9lbmdpbmUoY3R4LCBlbmdpbmUtPmxlZ2FjeV9pZHgpOwpAQCAtNjU0LDcgKzY0
NCw3IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCQkJZXJyID0gUFRS
X0VSUihvYmopOwogCQkJCQlpbnRlbF9jb250ZXh0X3B1dChjZSk7CiAJCQkJCWtlcm5lbF9jb250
ZXh0X2Nsb3NlKGN0eCk7Ci0JCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQkJZ290byBvdXRfZmls
ZTsKIAkJCQl9CiAJCQl9CiAKQEAgLTY2MywxNyArNjUzLDE4IEBAIHN0YXRpYyBpbnQgaWd0X2N0
eF9leGVjKHZvaWQgKmFyZykKIAkJCQlwcl9lcnIoIkZhaWxlZCB0byBmaWxsIGR3b3JkICVsdSBb
JWx1LyVsdV0gd2l0aCBncHUgKCVzKSBbZnVsbC1wcGd0dD8gJXNdLCBlcnI9JWRcbiIsCiAJCQkJ
ICAgICAgIG5kd29yZHMsIGR3LCBtYXhfZHdvcmRzKG9iaiksCiAJCQkJICAgICAgIGVuZ2luZS0+
bmFtZSwKLQkJCQkgICAgICAgeWVzbm8oISFjdHgtPnZtKSwgZXJyKTsKKwkJCQkgICAgICAgeWVz
bm8oISFyY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpLAorCQkJCSAgICAgICBlcnIpOwogCQkJ
CWludGVsX2NvbnRleHRfcHV0KGNlKTsKIAkJCQlrZXJuZWxfY29udGV4dF9jbG9zZShjdHgpOwot
CQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQlnb3RvIG91dF9maWxlOwogCQkJfQogCiAJCQllcnIg
PSB0aHJvdHRsZShjZSwgdHEsIEFSUkFZX1NJWkUodHEpKTsKIAkJCWlmIChlcnIpIHsKIAkJCQlp
bnRlbF9jb250ZXh0X3B1dChjZSk7CiAJCQkJa2VybmVsX2NvbnRleHRfY2xvc2UoY3R4KTsKLQkJ
CQlnb3RvIG91dF91bmxvY2s7CisJCQkJZ290byBvdXRfZmlsZTsKIAkJCX0KIAogCQkJaWYgKCsr
ZHcgPT0gbWF4X2R3b3JkcyhvYmopKSB7CkBAIC03MDMsMTEgKzY5NCwxMCBAQCBzdGF0aWMgaW50
IGlndF9jdHhfZXhlYyh2b2lkICphcmcpCiAJCQlkdyArPSByZW07CiAJCX0KIAotb3V0X3VubG9j
azoKK291dF9maWxlOgogCQl0aHJvdHRsZV9yZWxlYXNlKHRxLCBBUlJBWV9TSVpFKHRxKSk7CiAJ
CWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgmdCkpCiAJCQllcnIgPSAtRUlPOwotCQltdXRleF91bmxv
Y2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZp
bGUpOwogCQlpZiAoZXJyKQpAQCAtNzQyLDIyICs3MzIsMjAgQEAgc3RhdGljIGludCBpZ3Rfc2hh
cmVkX2N0eF9leGVjKHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRS
X0VSUihmaWxlKTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJ
cGFyZW50ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIocGFyZW50KSkg
ewogCQllcnIgPSBQVFJfRVJSKHBhcmVudCk7Ci0JCWdvdG8gb3V0X3VubG9jazsKKwkJZ290byBv
dXRfZmlsZTsKIAl9CiAKIAlpZiAoIXBhcmVudC0+dm0pIHsgLyogbm90IGZ1bGwtcHBndHQ7IG5v
dGhpbmcgdG8gc2hhcmUgKi8KIAkJZXJyID0gMDsKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3Rv
IG91dF9maWxlOwogCX0KIAogCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGk5MTUsIF9f
ZnVuY19fLCAiIik7CiAJaWYgKGVycikKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3RvIG91dF9m
aWxlOwogCiAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKIAkJdW5zaWduZWQg
bG9uZyBuY29udGV4dHMsIG5kd29yZHMsIGR3OwpAQCAtODAxLDcgKzc4OSw4IEBAIHN0YXRpYyBp
bnQgaWd0X3NoYXJlZF9jdHhfZXhlYyh2b2lkICphcmcpCiAJCQkJcHJfZXJyKCJGYWlsZWQgdG8g
ZmlsbCBkd29yZCAlbHUgWyVsdS8lbHVdIHdpdGggZ3B1ICglcykgW2Z1bGwtcHBndHQ/ICVzXSwg
ZXJyPSVkXG4iLAogCQkJCSAgICAgICBuZHdvcmRzLCBkdywgbWF4X2R3b3JkcyhvYmopLAogCQkJ
CSAgICAgICBlbmdpbmUtPm5hbWUsCi0JCQkJICAgICAgIHllc25vKCEhY3R4LT52bSksIGVycik7
CisJCQkJICAgICAgIHllc25vKCEhcmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pKSwKKwkJCQkg
ICAgICAgZXJyKTsKIAkJCQlpbnRlbF9jb250ZXh0X3B1dChjZSk7CiAJCQkJa2VybmVsX2NvbnRl
eHRfY2xvc2UoY3R4KTsKIAkJCQlnb3RvIG91dF90ZXN0OwpAQCAtODQwLDE3ICs4MjksMTMgQEAg
c3RhdGljIGludCBpZ3Rfc2hhcmVkX2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCWR3ICs9IHJlbTsK
IAkJfQogCi0JCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJCWk5MTVf
Z2VtX2RyYWluX2ZyZWVkX29iamVjdHMoaTkxNSk7Ci0JCW11dGV4X2xvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwogCX0KIG91dF90ZXN0OgogCXRocm90dGxlX3JlbGVhc2UodHEsIEFSUkFZ
X1NJWkUodHEpKTsKIAlpZiAoaWd0X2xpdmVfdGVzdF9lbmQoJnQpKQogCQllcnIgPSAtRUlPOwot
b3V0X3VubG9jazoKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCitv
dXRfZmlsZToKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAlyZXR1cm4gZXJyOwogfQpA
QCAtMTIyMiw4ICsxMjA3LDYgQEAgX19pZ3RfY3R4X3NzZXUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCiAJaWYgKGZsYWdzICYgVEVTVF9SRVNFVCkKIAkJaWd0X2dsb2JhbF9yZXNldF9s
b2NrKCZpOTE1LT5ndCk7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
LQogCWN0eCA9IGxpdmVfY29udGV4dChpOTE1LCBmaWxlKTsKIAlpZiAoSVNfRVJSKGN0eCkpIHsK
IAkJcmV0ID0gUFRSX0VSUihjdHgpOwpAQCAtMTI3OCw4ICsxMjYxLDYgQEAgX19pZ3RfY3R4X3Nz
ZXUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJaTkxNV9nZW1fb2JqZWN0X3B1dChv
YmopOwogCiBvdXRfdW5sb2NrOgotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7Ci0KIAlpZiAoZmxhZ3MgJiBURVNUX1JFU0VUKQogCQlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9j
aygmaTkxNS0+Z3QpOwogCkBAIC0xMzM5LDIzICsxMzIwLDI0IEBAIHN0YXRpYyBpbnQgaWd0X2N0
eF9yZWFkb25seSh2b2lkICphcmcpCiAJaWYgKElTX0VSUihmaWxlKSkKIAkJcmV0dXJuIFBUUl9F
UlIoZmlsZSk7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWVy
ciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGk5MTUsIF9fZnVuY19fLCAiIik7CiAJaWYgKGVy
cikKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3RvIG91dF9maWxlOwogCiAJY3R4ID0gbGl2ZV9j
b250ZXh0KGk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIoY3R4KSkgewogCQllcnIgPSBQVFJfRVJS
KGN0eCk7Ci0JCWdvdG8gb3V0X3VubG9jazsKKwkJZ290byBvdXRfZmlsZTsKIAl9CiAKLQl2bSA9
IGN0eC0+dm0gPzogJmk5MTUtPmdndHQuYWxpYXMtPnZtOworCXJjdV9yZWFkX2xvY2soKTsKKwl2
bSA9IHJjdV9kZXJlZmVyZW5jZShjdHgtPnZtKSA/OiAmaTkxNS0+Z2d0dC5hbGlhcy0+dm07CiAJ
aWYgKCF2bSB8fCAhdm0tPmhhc19yZWFkX29ubHkpIHsKKwkJcmN1X3JlYWRfdW5sb2NrKCk7CiAJ
CWVyciA9IDA7Ci0JCWdvdG8gb3V0X3VubG9jazsKKwkJZ290byBvdXRfZmlsZTsKIAl9CisJcmN1
X3JlYWRfdW5sb2NrKCk7CiAKIAluZHdvcmRzID0gMDsKIAlkdyA9IDA7CkBAIC0xMzczLDcgKzEz
NTUsNyBAQCBzdGF0aWMgaW50IGlndF9jdHhfcmVhZG9ubHkodm9pZCAqYXJnKQogCQkJCWlmIChJ
U19FUlIob2JqKSkgewogCQkJCQllcnIgPSBQVFJfRVJSKG9iaik7CiAJCQkJCWk5MTVfZ2VtX2Nv
bnRleHRfdW5sb2NrX2VuZ2luZXMoY3R4KTsKLQkJCQkJZ290byBvdXRfdW5sb2NrOworCQkJCQln
b3RvIG91dF9maWxlOwogCQkJCX0KIAogCQkJCWlmIChwcmFuZG9tX3UzMl9zdGF0ZSgmcHJuZykg
JiAxKQpAQCAtMTM4NCwxNSArMTM2NiwxNyBAQCBzdGF0aWMgaW50IGlndF9jdHhfcmVhZG9ubHko
dm9pZCAqYXJnKQogCQkJaWYgKGVycikgewogCQkJCXByX2VycigiRmFpbGVkIHRvIGZpbGwgZHdv
cmQgJWx1IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMpIFtmdWxsLXBwZ3R0PyAlc10sIGVycj0lZFxu
IiwKIAkJCQkgICAgICAgbmR3b3JkcywgZHcsIG1heF9kd29yZHMob2JqKSwKLQkJCQkgICAgICAg
Y2UtPmVuZ2luZS0+bmFtZSwgeWVzbm8oISFjdHgtPnZtKSwgZXJyKTsKKwkJCQkgICAgICAgY2Ut
PmVuZ2luZS0+bmFtZSwKKwkJCQkgICAgICAgeWVzbm8oISFyY3VfYWNjZXNzX3BvaW50ZXIoY3R4
LT52bSkpLAorCQkJCSAgICAgICBlcnIpOwogCQkJCWk5MTVfZ2VtX2NvbnRleHRfdW5sb2NrX2Vu
Z2luZXMoY3R4KTsKLQkJCQlnb3RvIG91dF91bmxvY2s7CisJCQkJZ290byBvdXRfZmlsZTsKIAkJ
CX0KIAogCQkJZXJyID0gdGhyb3R0bGUoY2UsIHRxLCBBUlJBWV9TSVpFKHRxKSk7CiAJCQlpZiAo
ZXJyKSB7CiAJCQkJaTkxNV9nZW1fY29udGV4dF91bmxvY2tfZW5naW5lcyhjdHgpOwotCQkJCWdv
dG8gb3V0X3VubG9jazsKKwkJCQlnb3RvIG91dF9maWxlOwogCQkJfQogCiAJCQlpZiAoKytkdyA9
PSBtYXhfZHdvcmRzKG9iaikpIHsKQEAgLTE0MjQsMjAgKzE0MDgsMTkgQEAgc3RhdGljIGludCBp
Z3RfY3R4X3JlYWRvbmx5KHZvaWQgKmFyZykKIAkJZHcgKz0gcmVtOwogCX0KIAotb3V0X3VubG9j
azoKK291dF9maWxlOgogCXRocm90dGxlX3JlbGVhc2UodHEsIEFSUkFZX1NJWkUodHEpKTsKIAlp
ZiAoaWd0X2xpdmVfdGVzdF9lbmQoJnQpKQogCQllcnIgPSAtRUlPOwotCW11dGV4X3VubG9jaygm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsK
IAlyZXR1cm4gZXJyOwogfQogCi1zdGF0aWMgaW50IGNoZWNrX3NjcmF0Y2goc3RydWN0IGk5MTVf
Z2VtX2NvbnRleHQgKmN0eCwgdTY0IG9mZnNldCkKK3N0YXRpYyBpbnQgY2hlY2tfc2NyYXRjaChz
dHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwgdTY0IG9mZnNldCkKIHsKIAlzdHJ1Y3QgZHJt
X21tX25vZGUgKm5vZGUgPQotCQlfX2RybV9tbV9pbnRlcnZhbF9maXJzdCgmY3R4LT52bS0+bW0s
CisJCV9fZHJtX21tX2ludGVydmFsX2ZpcnN0KCZ2bS0+bW0sCiAJCQkJCW9mZnNldCwgb2Zmc2V0
ICsgc2l6ZW9mKHUzMikgLSAxKTsKIAlpZiAoIW5vZGUgfHwgbm9kZS0+c3RhcnQgPiBvZmZzZXQp
CiAJCXJldHVybiAwOwpAQCAtMTQ1NSw2ICsxNDM4LDcgQEAgc3RhdGljIGludCB3cml0ZV90b19z
Y3JhdGNoKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiB7CiAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBjdHgtPmk5MTU7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iajsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKIAlzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycTsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAl1MzIgKmNtZDsKQEAgLTE0ODcsMTcg
KzE0NzEsMTggQEAgc3RhdGljIGludCB3cml0ZV90b19zY3JhdGNoKHN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0ICpjdHgsCiAKIAlpbnRlbF9ndF9jaGlwc2V0X2ZsdXNoKGVuZ2luZS0+Z3QpOwogCi0J
dm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCBjdHgtPnZtLCBOVUxMKTsKKwl2bSA9IGk5MTVf
Z2VtX2NvbnRleHRfZ2V0X3ZtX3JjdShjdHgpOworCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9i
aiwgdm0sIE5VTEwpOwogCWlmIChJU19FUlIodm1hKSkgewogCQllcnIgPSBQVFJfRVJSKHZtYSk7
Ci0JCWdvdG8gZXJyOworCQlnb3RvIGVycl92bTsKIAl9CiAKIAllcnIgPSBpOTE1X3ZtYV9waW4o
dm1hLCAwLCAwLCBQSU5fVVNFUiB8IFBJTl9PRkZTRVRfRklYRUQpOwogCWlmIChlcnIpCi0JCWdv
dG8gZXJyOworCQlnb3RvIGVycl92bTsKIAotCWVyciA9IGNoZWNrX3NjcmF0Y2goY3R4LCBvZmZz
ZXQpOworCWVyciA9IGNoZWNrX3NjcmF0Y2godm0sIG9mZnNldCk7CiAJaWYgKGVycikKIAkJZ290
byBlcnJfdW5waW47CiAKQEAgLTE1MjMsNiArMTUwOCw3IEBAIHN0YXRpYyBpbnQgd3JpdGVfdG9f
c2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCiAJaTkxNV9yZXF1ZXN0X2Fk
ZChycSk7CiAKKwlpOTE1X3ZtX3B1dCh2bSk7CiAJcmV0dXJuIDA7CiAKIHNraXBfcmVxdWVzdDoK
QEAgLTE1MzEsNiArMTUxNyw4IEBAIHN0YXRpYyBpbnQgd3JpdGVfdG9fc2NyYXRjaChzdHJ1Y3Qg
aTkxNV9nZW1fY29udGV4dCAqY3R4LAogCWk5MTVfcmVxdWVzdF9hZGQocnEpOwogZXJyX3VucGlu
OgogCWk5MTVfdm1hX3VucGluKHZtYSk7CitlcnJfdm06CisJaTkxNV92bV9wdXQodm0pOwogZXJy
OgogCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIAlyZXR1cm4gZXJyOwpAQCAtMTU0Miw2ICsx
NTMwLDcgQEAgc3RhdGljIGludCByZWFkX2Zyb21fc2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29u
dGV4dCAqY3R4LAogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY3R4LT5pOTE1
OwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqdm07CiAJY29uc3QgdTMyIFJDU19HUFIwID0gMHgyNjAwOyAvKiBub3QgYWxsIGVu
Z2luZXMgaGF2ZSB0aGVpciBvd24gR1BSISAqLwogCWNvbnN0IHUzMiByZXN1bHQgPSAweDEwMDsK
IAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKQEAgLTE1ODYsMTcgKzE1NzUsMTggQEAgc3RhdGlj
IGludCByZWFkX2Zyb21fc2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCiAJ
aW50ZWxfZ3RfY2hpcHNldF9mbHVzaChlbmdpbmUtPmd0KTsKIAotCXZtYSA9IGk5MTVfdm1hX2lu
c3RhbmNlKG9iaiwgY3R4LT52bSwgTlVMTCk7CisJdm0gPSBpOTE1X2dlbV9jb250ZXh0X2dldF92
bV9yY3UoY3R4KTsKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIHZtLCBOVUxMKTsKIAlp
ZiAoSVNfRVJSKHZtYSkpIHsKIAkJZXJyID0gUFRSX0VSUih2bWEpOwotCQlnb3RvIGVycjsKKwkJ
Z290byBlcnJfdm07CiAJfQogCiAJZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwgUElOX1VT
RVIgfCBQSU5fT0ZGU0VUX0ZJWEVEKTsKIAlpZiAoZXJyKQotCQlnb3RvIGVycjsKKwkJZ290byBl
cnJfdm07CiAKLQllcnIgPSBjaGVja19zY3JhdGNoKGN0eCwgb2Zmc2V0KTsKKwllcnIgPSBjaGVj
a19zY3JhdGNoKHZtLCBvZmZzZXQpOwogCWlmIChlcnIpCiAJCWdvdG8gZXJyX3VucGluOwogCkBA
IC0xNjI3LDEyICsxNjE3LDEyIEBAIHN0YXRpYyBpbnQgcmVhZF9mcm9tX3NjcmF0Y2goc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX2Nw
dV9kb21haW4ob2JqLCBmYWxzZSk7CiAJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmopOwogCWlm
IChlcnIpCi0JCWdvdG8gZXJyOworCQlnb3RvIGVycl92bTsKIAogCWNtZCA9IGk5MTVfZ2VtX29i
amVjdF9waW5fbWFwKG9iaiwgSTkxNV9NQVBfV0IpOwogCWlmIChJU19FUlIoY21kKSkgewogCQll
cnIgPSBQVFJfRVJSKGNtZCk7Ci0JCWdvdG8gZXJyOworCQlnb3RvIGVycl92bTsKIAl9CiAKIAkq
dmFsdWUgPSBjbWRbcmVzdWx0IC8gc2l6ZW9mKCpjbWQpXTsKQEAgLTE2NDcsNiArMTYzNyw4IEBA
IHN0YXRpYyBpbnQgcmVhZF9mcm9tX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eCwKIAlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKIGVycl91bnBpbjoKIAlpOTE1X3ZtYV91bnBpbih2
bWEpOworZXJyX3ZtOgorCWk5MTVfdm1fcHV0KHZtKTsKIGVycjoKIAlpOTE1X2dlbV9vYmplY3Rf
cHV0KG9iaik7CiAJcmV0dXJuIGVycjsKQEAgLTE2NzcsMjcgKzE2NjksMjUgQEAgc3RhdGljIGlu
dCBpZ3Rfdm1faXNvbGF0aW9uKHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1
cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
OwotCiAJZXJyID0gaWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19mdW5jX18sICIiKTsK
IAlpZiAoZXJyKQotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8gb3V0X2ZpbGU7CiAKIAljdHhf
YSA9IGxpdmVfY29udGV4dChpOTE1LCBmaWxlKTsKIAlpZiAoSVNfRVJSKGN0eF9hKSkgewogCQll
cnIgPSBQVFJfRVJSKGN0eF9hKTsKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3RvIG91dF9maWxl
OwogCX0KIAogCWN0eF9iID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIo
Y3R4X2IpKSB7CiAJCWVyciA9IFBUUl9FUlIoY3R4X2IpOwotCQlnb3RvIG91dF91bmxvY2s7CisJ
CWdvdG8gb3V0X2ZpbGU7CiAJfQogCiAJLyogV2UgY2FuIG9ubHkgdGVzdCB2bSBpc29sYXRpb24s
IGlmIHRoZSB2bSBhcmUgZGlzdGluY3QgKi8KIAlpZiAoY3R4X2EtPnZtID09IGN0eF9iLT52bSkK
LQkJZ290byBvdXRfdW5sb2NrOworCQlnb3RvIG91dF9maWxlOwogCiAJdm1fdG90YWwgPSBjdHhf
YS0+dm0tPnRvdGFsOwogCUdFTV9CVUdfT04oY3R4X2ItPnZtLT50b3RhbCAhPSB2bV90b3RhbCk7
CkBAIC0xNzI2LDcgKzE3MTYsNyBAQCBzdGF0aWMgaW50IGlndF92bV9pc29sYXRpb24odm9pZCAq
YXJnKQogCQkJCWVyciA9IHJlYWRfZnJvbV9zY3JhdGNoKGN0eF9iLCBlbmdpbmUsCiAJCQkJCQkJ
b2Zmc2V0LCAmdmFsdWUpOwogCQkJaWYgKGVycikKLQkJCQlnb3RvIG91dF91bmxvY2s7CisJCQkJ
Z290byBvdXRfZmlsZTsKIAogCQkJaWYgKHZhbHVlKSB7CiAJCQkJcHJfZXJyKCIlczogUmVhZCAl
MDh4IGZyb20gc2NyYXRjaCAob2Zmc2V0IDB4JTA4eF8lMDh4KSwgYWZ0ZXIgJWx1IHJlYWRzIVxu
IiwKQEAgLTE3MzUsNyArMTcyNSw3IEBAIHN0YXRpYyBpbnQgaWd0X3ZtX2lzb2xhdGlvbih2b2lk
ICphcmcpCiAJCQkJICAgICAgIGxvd2VyXzMyX2JpdHMob2Zmc2V0KSwKIAkJCQkgICAgICAgdGhp
cyk7CiAJCQkJZXJyID0gLUVJTlZBTDsKLQkJCQlnb3RvIG91dF91bmxvY2s7CisJCQkJZ290byBv
dXRfZmlsZTsKIAkJCX0KIAogCQkJdGhpcysrOwpAQCAtMTc0NSwxMSArMTczNSw5IEBAIHN0YXRp
YyBpbnQgaWd0X3ZtX2lzb2xhdGlvbih2b2lkICphcmcpCiAJcHJfaW5mbygiQ2hlY2tlZCAlbHUg
c2NyYXRjaCBvZmZzZXRzIGFjcm9zcyAlZCBlbmdpbmVzXG4iLAogCQljb3VudCwgUlVOVElNRV9J
TkZPKGk5MTUpLT5udW1fZW5naW5lcyk7CiAKLW91dF91bmxvY2s6CitvdXRfZmlsZToKIAlpZiAo
aWd0X2xpdmVfdGVzdF9lbmQoJnQpKQogCQllcnIgPSAtRUlPOwotCW11dGV4X3VubG9jaygmaTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAly
ZXR1cm4gZXJyOwogfQpAQCAtMTc4MSwxMyArMTc2OSw5IEBAIHN0YXRpYyBpbnQgbW9ja19jb250
ZXh0X2JhcnJpZXIodm9pZCAqYXJnKQogCSAqIGEgcmVxdWVzdDsgdXNlZnVsIGZvciByZXRpcmlu
ZyBvbGQgc3RhdGUgYWZ0ZXIgbG9hZGluZyBuZXcuCiAJICovCiAKLQltdXRleF9sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWN0eCA9IG1vY2tfY29udGV4dChpOTE1LCAibW9jayIp
OwotCWlmICghY3R4KSB7Ci0JCWVyciA9IC1FTk9NRU07Ci0JCWdvdG8gdW5sb2NrOwotCX0KKwlp
ZiAoIWN0eCkKKwkJcmV0dXJuIC1FTk9NRU07CiAKIAljb3VudGVyID0gMDsKIAllcnIgPSBjb250
ZXh0X2JhcnJpZXJfdGFzayhjdHgsIDAsCkBAIC0xODYwLDggKzE4NDQsNiBAQCBzdGF0aWMgaW50
IG1vY2tfY29udGV4dF9iYXJyaWVyKHZvaWQgKmFyZykKIAogb3V0OgogCW1vY2tfY29udGV4dF9j
bG9zZShjdHgpOwotdW5sb2NrOgotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7CiAJcmV0dXJuIGVycjsKICN1bmRlZiBwcl9mbXQKICNkZWZpbmUgcHJfZm10KHgpIHgKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5jCmlu
ZGV4IDAxMDRmMTZiMTMyNy4uZmQ3OTlkZWZkOGJlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmMKQEAgLTY1LDcgKzY1LDcgQEAgdm9p
ZCBtb2NrX2NvbnRleHRfY2xvc2Uoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAogdm9p
ZCBtb2NrX2luaXRfY29udGV4dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7Ci0J
aW5pdF9jb250ZXh0cyhpOTE1KTsKKwlpbml0X2NvbnRleHRzKCZpOTE1LT5nZW0uY29udGV4dHMp
OwogfQogCiBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqCkBAIC03NCw4ICs3NCw2IEBAIGxpdmVf
Y29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IGRybV9maWxlICpm
aWxlKQogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CiAJaW50IGVycjsKIAotCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJY3R4ID0gaTkxNV9n
ZW1fY3JlYXRlX2NvbnRleHQoaTkxNSwgMCk7CiAJaWYgKElTX0VSUihjdHgpKQogCQlyZXR1cm4g
Y3R4OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jCmluZGV4IDM1YTQwYzI4
MjBhMi4uYmUzNGQ5N2FjMThmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9jb250ZXh0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4
dC5jCkBAIC0yMjEsMTIgKzIyMSwyMCBAQCBpbnRlbF9jb250ZXh0X2luaXQoc3RydWN0IGludGVs
X2NvbnRleHQgKmNlLAogCQkgICBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCQkgICBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CisJc3RydWN0IGk5MTVfYWRkcmVzc19z
cGFjZSAqdm07CisKIAlHRU1fQlVHX09OKCFlbmdpbmUtPmNvcHMpOwogCiAJa3JlZl9pbml0KCZj
ZS0+cmVmKTsKIAogCWNlLT5nZW1fY29udGV4dCA9IGN0eDsKLQljZS0+dm0gPSBpOTE1X3ZtX2dl
dChjdHgtPnZtID86ICZlbmdpbmUtPmd0LT5nZ3R0LT52bSk7CisJcmN1X3JlYWRfbG9jaygpOwor
CXZtID0gcmN1X2RlcmVmZXJlbmNlKGN0eC0+dm0pOworCWlmICh2bSkKKwkJY2UtPnZtID0gaTkx
NV92bV9nZXQodm0pOworCWVsc2UKKwkJY2UtPnZtID0gaTkxNV92bV9nZXQoJmVuZ2luZS0+Z3Qt
PmdndHQtPnZtKTsKKwlyY3VfcmVhZF91bmxvY2soKTsKIAlpZiAoY3R4LT50aW1lbGluZSkKIAkJ
Y2UtPnRpbWVsaW5lID0gaW50ZWxfdGltZWxpbmVfZ2V0KGN0eC0+dGltZWxpbmUpOwogCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmluZGV4IGZjOGM5M2RmNDIzNi4uZDYyNTMwMzg4OGNi
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtOTgxLDYgKzk4MSwxMSBAQCBf
X2V4ZWNsaXN0c19zY2hlZHVsZV9pbihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAkJY2UtPmxy
Y19kZXNjIHw9CiAJCQkodTY0KShlbmdpbmUtPmNvbnRleHRfdGFnKysgJSBOVU1fQ09OVEVYVF9U
QUcpIDw8CiAJCQlHRU4xMV9TV19DVFhfSURfU0hJRlQ7CisKKyNkZWZpbmUgR0VOMTFfTUFYX0NP
TlRFWFRfSFdfSUQgKDE8PDExKSAvKiBleGNsdXNpdmUgKi8KKy8qIGluIEdlbjEyIElEIDB4N0ZG
IGlzIHJlc2VydmVkIHRvIGluZGljYXRlIGlkbGUgKi8KKyNkZWZpbmUgR0VOMTJfTUFYX0NPTlRF
WFRfSFdfSUQgICAgICAgIChHRU4xMV9NQVhfQ09OVEVYVF9IV19JRCAtIDEpCisKIAkJQlVJTERf
QlVHX09OKE5VTV9DT05URVhUX1RBRyA+IEdFTjEyX01BWF9DT05URVhUX0hXX0lEKTsKIAl9CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYwppbmRleCA4NmNmZmJi
MGE5Y2IuLjdjODM4YTU3ZTE3NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X2NvbnRleHQuYwpAQCAtMTU1LDEzICsxNTUsOSBAQCBzdGF0aWMgaW50IGxpdmVfY29udGV4dF9z
aXplKHZvaWQgKmFyZykKIAkgKiBIVyB0cmllcyB0byB3cml0ZSBwYXN0IHRoZSBlbmQgb2Ygb25l
LgogCSAqLwogCi0JbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJ
Zml4bWUgPSBrZXJuZWxfY29udGV4dChndC0+aTkxNSk7Ci0JaWYgKElTX0VSUihmaXhtZSkpIHsK
LQkJZXJyID0gUFRSX0VSUihmaXhtZSk7Ci0JCWdvdG8gdW5sb2NrOwotCX0KKwlpZiAoSVNfRVJS
KGZpeG1lKSkKKwkJcmV0dXJuIFBUUl9FUlIoZml4bWUpOwogCiAJZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgZ3QtPmk5MTUsIGlkKSB7CiAJCXN0cnVjdCB7CkBAIC0yMDEsOCArMTk3LDYgQEAgc3Rh
dGljIGludCBsaXZlX2NvbnRleHRfc2l6ZSh2b2lkICphcmcpCiAJfQogCiAJa2VybmVsX2NvbnRl
eHRfY2xvc2UoZml4bWUpOwotdW5sb2NrOgotCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7CiB9CiAKQEAgLTMwNSwxMiArMjk5LDEwIEBAIHN0
YXRpYyBpbnQgbGl2ZV9hY3RpdmVfY29udGV4dCh2b2lkICphcmcpCiAJaWYgKElTX0VSUihmaWxl
KSkKIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7CiAKLQltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7Ci0KIAlmaXhtZSA9IGxpdmVfY29udGV4dChndC0+aTkxNSwgZmlsZSk7
CiAJaWYgKElTX0VSUihmaXhtZSkpIHsKIAkJZXJyID0gUFRSX0VSUihmaXhtZSk7Ci0JCWdvdG8g
dW5sb2NrOworCQlnb3RvIG91dF9maWxlOwogCX0KIAogCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUs
IGd0LT5pOTE1LCBpZCkgewpAQCAtMzIzLDggKzMxNSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9hY3Rp
dmVfY29udGV4dCh2b2lkICphcmcpCiAJCQlicmVhazsKIAl9CiAKLXVubG9jazoKLQltdXRleF91
bmxvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKK291dF9maWxlOgogCW1vY2tfZmls
ZV9mcmVlKGd0LT5pOTE1LCBmaWxlKTsKIAlyZXR1cm4gZXJyOwogfQpAQCAtNDE4LDEyICs0MDks
MTAgQEAgc3RhdGljIGludCBsaXZlX3JlbW90ZV9jb250ZXh0KHZvaWQgKmFyZykKIAlpZiAoSVNf
RVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xvY2soJmd0LT5p
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWZpeG1lID0gbGl2ZV9jb250ZXh0KGd0LT5pOTE1
LCBmaWxlKTsKIAlpZiAoSVNfRVJSKGZpeG1lKSkgewogCQllcnIgPSBQVFJfRVJSKGZpeG1lKTsK
LQkJZ290byB1bmxvY2s7CisJCWdvdG8gb3V0X2ZpbGU7CiAJfQogCiAJZm9yX2VhY2hfZW5naW5l
KGVuZ2luZSwgZ3QtPmk5MTUsIGlkKSB7CkBAIC00MzYsOCArNDI1LDcgQEAgc3RhdGljIGludCBs
aXZlX3JlbW90ZV9jb250ZXh0KHZvaWQgKmFyZykKIAkJCWJyZWFrOwogCX0KIAotdW5sb2NrOgot
CW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworb3V0X2ZpbGU6CiAJ
bW9ja19maWxlX2ZyZWUoZ3QtPmk5MTUsIGZpbGUpOwogCXJldHVybiBlcnI7CiB9CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCmluZGV4IGZmYmIzZDIzYjg4
Ny4uZThhNDBkZjc5YmQwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF9oYW5nY2hlY2suYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9o
YW5nY2hlY2suYwpAQCAtNTgsOSArNTgsNyBAQCBzdGF0aWMgaW50IGhhbmdfaW5pdChzdHJ1Y3Qg
aGFuZyAqaCwgc3RydWN0IGludGVsX2d0ICpndCkKIAltZW1zZXQoaCwgMCwgc2l6ZW9mKCpoKSk7
CiAJaC0+Z3QgPSBndDsKIAotCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKIAloLT5jdHggPSBrZXJuZWxfY29udGV4dChndC0+aTkxNSk7Ci0JbXV0ZXhfdW5sb2NrKCZn
dC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYgKElTX0VSUihoLT5jdHgpKQogCQlyZXR1
cm4gUFRSX0VSUihoLT5jdHgpOwogCkBAIC0xMzMsNyArMTMxLDcgQEAgc3RhdGljIHN0cnVjdCBp
OTE1X3JlcXVlc3QgKgogaGFuZ19jcmVhdGVfcmVxdWVzdChzdHJ1Y3QgaGFuZyAqaCwgc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBoLT5n
dDsKLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGgtPmN0eC0+dm0gPzogJmVuZ2lu
ZS0+Z3QtPmdndHQtPnZtOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gaTkxNV9n
ZW1fY29udGV4dF9nZXRfdm1fcmN1KGgtPmN0eCk7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iajsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9IE5VTEw7CiAJc3RydWN0IGk5MTVf
dm1hICpod3MsICp2bWE7CkBAIC0xNDMsMTIgKzE0MSwxNSBAQCBoYW5nX2NyZWF0ZV9yZXF1ZXN0
KHN0cnVjdCBoYW5nICpoLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJaW50IGVy
cjsKIAogCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoZ3QtPmk5MTUsIFBB
R0VfU0laRSk7Ci0JaWYgKElTX0VSUihvYmopKQorCWlmIChJU19FUlIob2JqKSkgeworCQlpOTE1
X3ZtX3B1dCh2bSk7CiAJCXJldHVybiBFUlJfQ0FTVChvYmopOworCX0KIAogCXZhZGRyID0gaTkx
NV9nZW1fb2JqZWN0X3Bpbl9tYXAob2JqLCBpOTE1X2NvaGVyZW50X21hcF90eXBlKGd0LT5pOTE1
KSk7CiAJaWYgKElTX0VSUih2YWRkcikpIHsKIAkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwor
CQlpOTE1X3ZtX3B1dCh2bSk7CiAJCXJldHVybiBFUlJfQ0FTVCh2YWRkcik7CiAJfQogCkBAIC0x
NTksMTYgKzE2MCwyMiBAQCBoYW5nX2NyZWF0ZV9yZXF1ZXN0KHN0cnVjdCBoYW5nICpoLCBzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJaC0+YmF0Y2ggPSB2YWRkcjsKIAogCXZtYSA9
IGk5MTVfdm1hX2luc3RhbmNlKGgtPm9iaiwgdm0sIE5VTEwpOwotCWlmIChJU19FUlIodm1hKSkK
KwlpZiAoSVNfRVJSKHZtYSkpIHsKKwkJaTkxNV92bV9wdXQodm0pOwogCQlyZXR1cm4gRVJSX0NB
U1Qodm1hKTsKKwl9CiAKIAlod3MgPSBpOTE1X3ZtYV9pbnN0YW5jZShoLT5od3MsIHZtLCBOVUxM
KTsKLQlpZiAoSVNfRVJSKGh3cykpCisJaWYgKElTX0VSUihod3MpKSB7CisJCWk5MTVfdm1fcHV0
KHZtKTsKIAkJcmV0dXJuIEVSUl9DQVNUKGh3cyk7CisJfQogCiAJZXJyID0gaTkxNV92bWFfcGlu
KHZtYSwgMCwgMCwgUElOX1VTRVIpOwotCWlmIChlcnIpCisJaWYgKGVycikgeworCQlpOTE1X3Zt
X3B1dCh2bSk7CiAJCXJldHVybiBFUlJfUFRSKGVycik7CisJfQogCiAJZXJyID0gaTkxNV92bWFf
cGluKGh3cywgMCwgMCwgUElOX1VTRVIpOwogCWlmIChlcnIpCkBAIC0yNjYsNiArMjczLDcgQEAg
aGFuZ19jcmVhdGVfcmVxdWVzdChzdHJ1Y3QgaGFuZyAqaCwgc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQogCWk5MTVfdm1hX3VucGluKGh3cyk7CiB1bnBpbl92bWE6CiAJaTkxNV92bWFf
dW5waW4odm1hKTsKKwlpOTE1X3ZtX3B1dCh2bSk7CiAJcmV0dXJuIGVyciA/IEVSUl9QVFIoZXJy
KSA6IHJxOwogfQogCkBAIC0zODIsOSArMzkwLDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9w
KHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsK
IAotCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAljdHggPSBsaXZl
X2NvbnRleHQoZ3QtPmk5MTUsIGZpbGUpOwotCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwogCWlmIChJU19FUlIoY3R4KSkgewogCQllcnIgPSBQVFJfRVJSKGN0eCk7
CiAJCWdvdG8gb3V0OwpAQCAtNDU4LDkgKzQ2NCw3IEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X25v
cF9lbmdpbmUodm9pZCAqYXJnKQogCWlmIChJU19FUlIoZmlsZSkpCiAJCXJldHVybiBQVFJfRVJS
KGZpbGUpOwogCi0JbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWN0
eCA9IGxpdmVfY29udGV4dChndC0+aTkxNSwgZmlsZSk7Ci0JbXV0ZXhfdW5sb2NrKCZndC0+aTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYgKElTX0VSUihjdHgpKSB7CiAJCWVyciA9IFBUUl9F
UlIoY3R4KTsKIAkJZ290byBvdXQ7CkBAIC03MDUsOSArNzA5LDcgQEAgc3RhdGljIGludCBhY3Rp
dmVfZW5naW5lKHZvaWQgKmRhdGEpCiAJCXJldHVybiBQVFJfRVJSKGZpbGUpOwogCiAJZm9yIChj
b3VudCA9IDA7IGNvdW50IDwgQVJSQVlfU0laRShjdHgpOyBjb3VudCsrKSB7Ci0JCW11dGV4X2xv
Y2soJmVuZ2luZS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJCWN0eFtjb3VudF0gPSBsaXZl
X2NvbnRleHQoZW5naW5lLT5pOTE1LCBmaWxlKTsKLQkJbXV0ZXhfdW5sb2NrKCZlbmdpbmUtPmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQlpZiAoSVNfRVJSKGN0eFtjb3VudF0pKSB7CiAJCQll
cnIgPSBQVFJfRVJSKGN0eFtjb3VudF0pOwogCQkJd2hpbGUgKC0tY291bnQpCkBAIC0xMjkxLDYg
KzEyOTMsNyBAQCBzdGF0aWMgaW50IGlndF9yZXNldF9ldmljdF9wcGd0dCh2b2lkICphcmcpCiB7
CiAJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
Y3R4OworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwogCXN0cnVjdCBkcm1fZmlsZSAq
ZmlsZTsKIAlpbnQgZXJyOwogCkBAIC0xMjk4LDE4ICsxMzAxLDIwIEBAIHN0YXRpYyBpbnQgaWd0
X3Jlc2V0X2V2aWN0X3BwZ3R0KHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1
cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKIAljdHggPSBsaXZlX2NvbnRleHQoZ3QtPmk5MTUsIGZpbGUpOwotCW11dGV4X3VubG9j
aygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWlmIChJU19FUlIoY3R4KSkgewogCQll
cnIgPSBQVFJfRVJSKGN0eCk7CiAJCWdvdG8gb3V0OwogCX0KIAogCWVyciA9IDA7Ci0JaWYgKGN0
eC0+dm0pIC8qIGFsaWFzaW5nID09IGdsb2JhbCBndHQgbG9ja2luZywgY292ZXJlZCBhYm92ZSAq
LwotCQllcnIgPSBfX2lndF9yZXNldF9ldmljdF92bWEoZ3QsIGN0eC0+dm0sCisJdm0gPSBpOTE1
X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4KTsKKwlpZiAoIWk5MTVfaXNfZ2d0dCh2bSkpIHsK
KwkJLyogYWxpYXNpbmcgPT0gZ2xvYmFsIGd0dCBsb2NraW5nLCBjb3ZlcmVkIGFib3ZlICovCisJ
CWVyciA9IF9faWd0X3Jlc2V0X2V2aWN0X3ZtYShndCwgdm0sCiAJCQkJCSAgICBldmljdF92bWEs
IEVYRUNfT0JKRUNUX1dSSVRFKTsKKwl9CisJaTkxNV92bV9wdXQodm0pOwogCiBvdXQ6CiAJbW9j
a19maWxlX2ZyZWUoZ3QtPmk5MTUsIGZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVz
dF9scmMuYwppbmRleCAwNGMxY2Y1NzM2NDIuLjhkYzQyYzVjNzU2OSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKQEAgLTE2MzEsNyArMTYzMSwxMSBAQCBzdGF0aWMgaW50
IHNtb2tlX3N1Ym1pdChzdHJ1Y3QgcHJlZW1wdF9zbW9rZSAqc21va2UsCiAJaW50IGVyciA9IDA7
CiAKIAlpZiAoYmF0Y2gpIHsKLQkJdm1hID0gaTkxNV92bWFfaW5zdGFuY2UoYmF0Y2gsIGN0eC0+
dm0sIE5VTEwpOworCQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKKworCQl2bSA9IGk5
MTVfZ2VtX2NvbnRleHRfZ2V0X3ZtX3JjdShjdHgpOworCQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5j
ZShiYXRjaCwgdm0sIE5VTEwpOworCQlpOTE1X3ZtX3B1dCh2bSk7CiAJCWlmIChJU19FUlIodm1h
KSkKIAkJCXJldHVybiBQVFJfRVJSKHZtYSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jCmluZGV4IDRlZTJlMmJhYmQwZC4uZDE3OTc2ZDlmYjkx
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5k
cy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMK
QEAgLTMzLDYgKzMzLDggQEAgc3RydWN0IHdhX2xpc3RzIHsKIAl9IGVuZ2luZVtJOTE1X05VTV9F
TkdJTkVTXTsKIH07CiAKKyNkZWZpbmUgY3R4X3ZtKGN0eCkgcmN1X2RlcmVmZXJlbmNlX3Byb3Rl
Y3RlZCgoY3R4KS0+dm0sIHRydWUpCisKIHN0YXRpYyB2b2lkCiByZWZlcmVuY2VfbGlzdHNfaW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IHdhX2xpc3RzICpsaXN0cykK
IHsKQEAgLTM2Miw3ICszNjQsNyBAQCBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpjcmVhdGVfYmF0
Y2goc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAlpZiAoSVNfRVJSKG9iaikpCiAJCXJl
dHVybiBFUlJfQ0FTVChvYmopOwogCi0Jdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCBjdHgt
PnZtLCBOVUxMKTsKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIGN0eF92bShjdHgpLCBO
VUxMKTsKIAlpZiAoSVNfRVJSKHZtYSkpIHsKIAkJZXJyID0gUFRSX0VSUih2bWEpOwogCQlnb3Rv
IGVycl9vYmo7CkBAIC00NjgsNyArNDcwLDcgQEAgc3RhdGljIGludCBjaGVja19kaXJ0eV93aGl0
ZWxpc3Qoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAlpbnQgZXJyID0gMCwgaSwgdjsK
IAl1MzIgKmNzLCAqcmVzdWx0czsKIAotCXNjcmF0Y2ggPSBjcmVhdGVfc2NyYXRjaChjdHgtPnZt
LCAyICogQVJSQVlfU0laRSh2YWx1ZXMpICsgMSk7CisJc2NyYXRjaCA9IGNyZWF0ZV9zY3JhdGNo
KGN0eF92bShjdHgpLCAyICogQVJSQVlfU0laRSh2YWx1ZXMpICsgMSk7CiAJaWYgKElTX0VSUihz
Y3JhdGNoKSkKIAkJcmV0dXJuIFBUUl9FUlIoc2NyYXRjaCk7CiAKQEAgLTEwMTgsMTQgKzEwMjAs
MTQgQEAgc3RhdGljIGludCBsaXZlX2lzb2xhdGVkX3doaXRlbGlzdCh2b2lkICphcmcpCiAJCQln
b3RvIGVycjsKIAkJfQogCi0JCWNsaWVudFtpXS5zY3JhdGNoWzBdID0gY3JlYXRlX3NjcmF0Y2go
Yy0+dm0sIDEwMjQpOworCQljbGllbnRbaV0uc2NyYXRjaFswXSA9IGNyZWF0ZV9zY3JhdGNoKGN0
eF92bShjKSwgMTAyNCk7CiAJCWlmIChJU19FUlIoY2xpZW50W2ldLnNjcmF0Y2hbMF0pKSB7CiAJ
CQllcnIgPSBQVFJfRVJSKGNsaWVudFtpXS5zY3JhdGNoWzBdKTsKIAkJCWtlcm5lbF9jb250ZXh0
X2Nsb3NlKGMpOwogCQkJZ290byBlcnI7CiAJCX0KIAotCQljbGllbnRbaV0uc2NyYXRjaFsxXSA9
IGNyZWF0ZV9zY3JhdGNoKGMtPnZtLCAxMDI0KTsKKwkJY2xpZW50W2ldLnNjcmF0Y2hbMV0gPSBj
cmVhdGVfc2NyYXRjaChjdHhfdm0oYyksIDEwMjQpOwogCQlpZiAoSVNfRVJSKGNsaWVudFtpXS5z
Y3JhdGNoWzFdKSkgewogCQkJZXJyID0gUFRSX0VSUihjbGllbnRbaV0uc2NyYXRjaFsxXSk7CiAJ
CQlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgmY2xpZW50W2ldLnNjcmF0Y2hbMF0sIDApOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCmluZGV4IDAzZjU2NzA4NDU0OC4uNjg1MGYx
ZjQwMjQxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCkBAIC0zNjUsNyArMzY1
LDggQEAgc3RhdGljIHZvaWQgc2V0X2NvbnRleHRfcHBndHRfZnJvbV9zaGFkb3coc3RydWN0IGlu
dGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkLAogCQkJCQkgIHN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHgpCiB7CiAJc3RydWN0IGludGVsX3ZncHVfbW0gKm1tID0gd29ya2xvYWQtPnNoYWRv
d19tbTsKLQlzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQgPSBpOTE1X3ZtX3RvX3BwZ3R0KGN0eC0+
dm0pOworCXN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCA9CisJCWk5MTVfdm1fdG9fcHBndHQoaTkx
NV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KGN0eCkpOwogCWludCBpID0gMDsKIAogCWlmIChtbS0+
cHBndHRfbW0ucm9vdF9lbnRyeV90eXBlID09IEdUVF9UWVBFX1BQR1RUX1JPT1RfTDRfRU5UUlkp
IHsKQEAgLTM3OCw2ICszNzksOCBAQCBzdGF0aWMgdm9pZCBzZXRfY29udGV4dF9wcGd0dF9mcm9t
X3NoYWRvdyhzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQsCiAJCQlweF9kbWEo
cGQpID0gbW0tPnBwZ3R0X21tLnNoYWRvd19wZHBzW2ldOwogCQl9CiAJfQorCisJaTkxNV92bV9w
dXQoJnBwZ3R0LT52bSk7CiB9CiAKIHN0YXRpYyBpbnQKQEAgLTEyMzAsMjAgKzEyMzMsMTggQEAg
aW50IGludGVsX3ZncHVfc2V0dXBfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkK
IAlzdHJ1Y3QgaW50ZWxfdmdwdV9zdWJtaXNzaW9uICpzID0gJnZncHUtPnN1Ym1pc3Npb247CiAJ
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0
ICpjdHg7CisJc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0OwogCWVudW0gaW50ZWxfZW5naW5lX2lk
IGk7CiAJaW50IHJldDsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwot
CiAJY3R4ID0gaTkxNV9nZW1fY29udGV4dF9jcmVhdGVfa2VybmVsKGk5MTUsIEk5MTVfUFJJT1JJ
VFlfTUFYKTsKLQlpZiAoSVNfRVJSKGN0eCkpIHsKLQkJcmV0ID0gUFRSX0VSUihjdHgpOwotCQln
b3RvIG91dF91bmxvY2s7Ci0JfQorCWlmIChJU19FUlIoY3R4KSkKKwkJcmV0dXJuIFBUUl9FUlIo
Y3R4KTsKIAogCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2ZvcmNlX3NpbmdsZV9zdWJtaXNzaW9uKGN0
eCk7CiAKLQlpOTE1X2NvbnRleHRfcHBndHRfcm9vdF9zYXZlKHMsIGk5MTVfdm1fdG9fcHBndHQo
Y3R4LT52bSkpOworCXBwZ3R0ID0gaTkxNV92bV90b19wcGd0dChpOTE1X2dlbV9jb250ZXh0X2dl
dF92bV9yY3UoY3R4KSk7CisJaTkxNV9jb250ZXh0X3BwZ3R0X3Jvb3Rfc2F2ZShzLCBwcGd0dCk7
CiAKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpKSB7CiAJCXN0cnVjdCBpbnRlbF9j
b250ZXh0ICpjZTsKQEAgLTEyODgsMTIgKzEyODksMTIgQEAgaW50IGludGVsX3ZncHVfc2V0dXBf
c3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIAlhdG9taWNfc2V0KCZzLT5ydW5u
aW5nX3dvcmtsb2FkX251bSwgMCk7CiAJYml0bWFwX3plcm8ocy0+dGxiX2hhbmRsZV9wZW5kaW5n
LCBJOTE1X05VTV9FTkdJTkVTKTsKIAorCWk5MTVfdm1fcHV0KCZwcGd0dC0+dm0pOwogCWk5MTVf
Z2VtX2NvbnRleHRfcHV0KGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKIAlyZXR1cm4gMDsKIAogb3V0X3NoYWRvd19jdHg6Ci0JaTkxNV9jb250ZXh0X3BwZ3R0
X3Jvb3RfcmVzdG9yZShzLCBpOTE1X3ZtX3RvX3BwZ3R0KGN0eC0+dm0pKTsKKwlpOTE1X2NvbnRl
eHRfcHBndHRfcm9vdF9yZXN0b3JlKHMsIHBwZ3R0KTsKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5l
LCBpOTE1LCBpKSB7CiAJCWlmIChJU19FUlIocy0+c2hhZG93W2ldKSkKIAkJCWJyZWFrOwpAQCAt
MTMwMSw5ICsxMzAyLDggQEAgaW50IGludGVsX3ZncHVfc2V0dXBfc3VibWlzc2lvbihzdHJ1Y3Qg
aW50ZWxfdmdwdSAqdmdwdSkKIAkJaW50ZWxfY29udGV4dF91bnBpbihzLT5zaGFkb3dbaV0pOwog
CQlpbnRlbF9jb250ZXh0X3B1dChzLT5zaGFkb3dbaV0pOwogCX0KKwlpOTE1X3ZtX3B1dCgmcHBn
dHQtPnZtKTsKIAlpOTE1X2dlbV9jb250ZXh0X3B1dChjdHgpOwotb3V0X3VubG9jazoKLQltdXRl
eF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiByZXQ7CiB9CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggMGU5MGFjNjA4ZTA3Li5iMDRjZWJjMjZl
Y2EgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC0zMTYsMTIgKzMxNiwxOCBA
QCBzdGF0aWMgdm9pZCBwcmludF9jb250ZXh0X3N0YXRzKHN0cnVjdCBzZXFfZmlsZSAqbSwKIAkJ
CQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKIAlzdHJ1Y3QgZmlsZV9zdGF0cyBr
c3RhdHMgPSB7fTsKLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OworCXN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgsICpjbjsKIAotCWxpc3RfZm9yX2VhY2hfZW50cnkoY3R4LCAmaTkx
NS0+Y29udGV4dHMubGlzdCwgbGluaykgeworCXNwaW5fbG9jaygmaTkxNS0+Z2VtLmNvbnRleHRz
LmxvY2spOworCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShjdHgsIGNuLCAmaTkxNS0+Z2VtLmNv
bnRleHRzLmxpc3QsIGxpbmspIHsKIAkJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNfaXRlciBpdDsK
IAkJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwogCisJCWlmICgha3JlZl9nZXRfdW5sZXNzX3pl
cm8oJmN0eC0+cmVmKSkKKwkJCWNvbnRpbnVlOworCisJCXNwaW5fdW5sb2NrKCZpOTE1LT5nZW0u
Y29udGV4dHMubG9jayk7CisKIAkJZm9yX2VhY2hfZ2VtX2VuZ2luZShjZSwKIAkJCQkgICAgaTkx
NV9nZW1fY29udGV4dF9sb2NrX2VuZ2luZXMoY3R4KSwgaXQpIHsKIAkJCWludGVsX2NvbnRleHRf
bG9ja19waW5uZWQoY2UpOwpAQCAtMzM4LDcgKzM0NCw5IEBAIHN0YXRpYyB2b2lkIHByaW50X2Nv
bnRleHRfc3RhdHMoc3RydWN0IHNlcV9maWxlICptLAogCQlpOTE1X2dlbV9jb250ZXh0X3VubG9j
a19lbmdpbmVzKGN0eCk7CiAKIAkJaWYgKCFJU19FUlJfT1JfTlVMTChjdHgtPmZpbGVfcHJpdikp
IHsKLQkJCXN0cnVjdCBmaWxlX3N0YXRzIHN0YXRzID0geyAudm0gPSBjdHgtPnZtLCB9OworCQkJ
c3RydWN0IGZpbGVfc3RhdHMgc3RhdHMgPSB7CisJCQkJLnZtID0gcmN1X2FjY2Vzc19wb2ludGVy
KGN0eC0+dm0pLAorCQkJfTsKIAkJCXN0cnVjdCBkcm1fZmlsZSAqZmlsZSA9IGN0eC0+ZmlsZV9w
cml2LT5maWxlOwogCQkJc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrOwogCQkJY2hhciBuYW1lWzgw
XTsKQEAgLTM1NSw3ICszNjMsMTIgQEAgc3RhdGljIHZvaWQgcHJpbnRfY29udGV4dF9zdGF0cyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sCiAKIAkJCXByaW50X2ZpbGVfc3RhdHMobSwgbmFtZSwgc3RhdHMp
OwogCQl9CisKKwkJc3Bpbl9sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7CisJCWxpc3Rf
c2FmZV9yZXNldF9uZXh0KGN0eCwgY24sIGxpbmspOworCQlpOTE1X2dlbV9jb250ZXh0X3B1dChj
dHgpOwogCX0KKwlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOwogCiAJcHJp
bnRfZmlsZV9zdGF0cyhtLCAiW2tdY29udGV4dHMiLCBrc3RhdHMpOwogfQpAQCAtMzYzLDcgKzM3
Niw2IEBAIHN0YXRpYyB2b2lkIHByaW50X2NvbnRleHRfc3RhdHMoc3RydWN0IHNlcV9maWxlICpt
LAogc3RhdGljIGludCBpOTE1X2dlbV9vYmplY3RfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKmRhdGEpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5
MTUobS0+cHJpdmF0ZSk7Ci0JaW50IHJldDsKIAogCXNlcV9wcmludGYobSwgIiV1IHNocmlua2Fi
bGUgWyV1IGZyZWVdIG9iamVjdHMsICVsbHUgYnl0ZXNcbiIsCiAJCSAgIGk5MTUtPm1tLnNocmlu
a19jb3VudCwKQEAgLTM3MiwxMiArMzg0LDcgQEAgc3RhdGljIGludCBpOTE1X2dlbV9vYmplY3Rf
aW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAKIAlzZXFfcHV0YyhtLCAnXG4n
KTsKIAotCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKLQogCXByaW50X2NvbnRleHRfc3RhdHMo
bSwgaTkxNSk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCXJl
dHVybiAwOwogfQpAQCAtMTU3OSwxOSArMTU4NiwxOSBAQCBzdGF0aWMgdm9pZCBkZXNjcmliZV9j
dHhfcmluZyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nKQogCiBz
dGF0aWMgaW50IGk5MTVfY29udGV4dF9zdGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1
bnVzZWQpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19p
OTE1KG0tPnByaXZhdGUpOwotCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRy
bTsKLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OwotCWludCByZXQ7Ci0KLQlyZXQgPSBt
dXRleF9sb2NrX2ludGVycnVwdGlibGUoJmRldi0+c3RydWN0X211dGV4KTsKLQlpZiAocmV0KQot
CQlyZXR1cm4gcmV0OworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19p
OTE1KG0tPnByaXZhdGUpOworCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsICpjbjsKIAot
CWxpc3RfZm9yX2VhY2hfZW50cnkoY3R4LCAmZGV2X3ByaXYtPmNvbnRleHRzLmxpc3QsIGxpbmsp
IHsKKwlzcGluX2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKKwlsaXN0X2Zvcl9lYWNo
X2VudHJ5X3NhZmUoY3R4LCBjbiwgJmk5MTUtPmdlbS5jb250ZXh0cy5saXN0LCBsaW5rKSB7CiAJ
CXN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzX2l0ZXIgaXQ7CiAJCXN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZTsKIAorCQlpZiAoIWtyZWZfZ2V0X3VubGVzc196ZXJvKCZjdHgtPnJlZikpCisJCQljb250
aW51ZTsKKworCQlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCiAJCXNl
cV9wdXRzKG0sICJIVyBjb250ZXh0ICIpOwogCQlpZiAoY3R4LT5waWQpIHsKIAkJCXN0cnVjdCB0
YXNrX3N0cnVjdCAqdGFzazsKQEAgLTE2MjYsOSArMTYzMywxMiBAQCBzdGF0aWMgaW50IGk5MTVf
Y29udGV4dF9zdGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJCWk5MTVf
Z2VtX2NvbnRleHRfdW5sb2NrX2VuZ2luZXMoY3R4KTsKIAogCQlzZXFfcHV0YyhtLCAnXG4nKTsK
LQl9CiAKLQltdXRleF91bmxvY2soJmRldi0+c3RydWN0X211dGV4KTsKKwkJc3Bpbl9sb2NrKCZp
OTE1LT5nZW0uY29udGV4dHMubG9jayk7CisJCWxpc3Rfc2FmZV9yZXNldF9uZXh0KGN0eCwgY24s
IGxpbmspOworCQlpOTE1X2dlbV9jb250ZXh0X3B1dChjdHgpOworCX0KKwlzcGluX3VubG9jaygm
aTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOwogCiAJcmV0dXJuIDA7CiB9CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuYwppbmRleCA1MzIzZTRmYTU1ZDkuLjAyNGRhNTgyYmEwZiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2Rydi5jCkBAIC0xNjY1LDEwICsxNjY1LDggQEAgc3RhdGljIHZvaWQgaTkxNV9kcml2ZXJf
cG9zdGNsb3NlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkK
IHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYgPSBmaWxlLT5kcml2
ZXJfcHJpdjsKIAotCW11dGV4X2xvY2soJmRldi0+c3RydWN0X211dGV4KTsKIAlpOTE1X2dlbV9j
b250ZXh0X2Nsb3NlKGZpbGUpOwogCWk5MTVfZ2VtX3JlbGVhc2UoZGV2LCBmaWxlKTsKLQltdXRl
eF91bmxvY2soJmRldi0+c3RydWN0X211dGV4KTsKIAogCWtmcmVlX3JjdShmaWxlX3ByaXYsIHJj
dSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4IGNiNjNiMmJkMGNlOC4uMzViNjEwZDUy
Mzc5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKQEAgLTE1MzYsMjUgKzE1MzYsNiBAQCBzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSB7CiAJaW50IGF1ZGlvX3Bvd2VyX3JlZmNvdW50OwogCXUzMiBh
dWRpb19mcmVxX2NudHJsOwogCi0Jc3RydWN0IHsKLQkJc3RydWN0IG11dGV4IG11dGV4OwotCQlz
dHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7Ci0JCXN0cnVjdCBsbGlzdF9oZWFkIGZyZWVfbGlzdDsKLQkJ
c3RydWN0IHdvcmtfc3RydWN0IGZyZWVfd29yazsKLQotCQkvKiBUaGUgaHcgd2FudHMgdG8gaGF2
ZSBhIHN0YWJsZSBjb250ZXh0IGlkZW50aWZpZXIgZm9yIHRoZQotCQkgKiBsaWZldGltZSBvZiB0
aGUgY29udGV4dCAoZm9yIE9BLCBQQVNJRCwgZmF1bHRzLCBldGMpLgotCQkgKiBUaGlzIGlzIGxp
bWl0ZWQgaW4gZXhlY2xpc3RzIHRvIDIxIGJpdHMuCi0JCSAqLwotCQlzdHJ1Y3QgaWRhIGh3X2lk
YTsKLSNkZWZpbmUgTUFYX0NPTlRFWFRfSFdfSUQgKDE8PDIxKSAvKiBleGNsdXNpdmUgKi8KLSNk
ZWZpbmUgTUFYX0dVQ19DT05URVhUX0hXX0lEICgxIDw8IDIwKSAvKiBleGNsdXNpdmUgKi8KLSNk
ZWZpbmUgR0VOMTFfTUFYX0NPTlRFWFRfSFdfSUQgKDE8PDExKSAvKiBleGNsdXNpdmUgKi8KLS8q
IGluIEdlbjEyIElEIDB4N0ZGIGlzIHJlc2VydmVkIHRvIGluZGljYXRlIGlkbGUgKi8KLSNkZWZp
bmUgR0VOMTJfTUFYX0NPTlRFWFRfSFdfSUQJKEdFTjExX01BWF9DT05URVhUX0hXX0lEIC0gMSkK
LQkJc3RydWN0IGxpc3RfaGVhZCBod19pZF9saXN0OwotCX0gY29udGV4dHM7Ci0KIAl1MzIgZmRp
X3J4X2NvbmZpZzsKIAogCS8qIFNoYWRvdyBmb3IgRElTUExBWV9QSFlfQ09OVFJPTCB3aGljaCBj
YW4ndCBiZSBzYWZlbHkgcmVhZCAqLwpAQCAtMTcxMCw2ICsxNjkxLDE0IEBAIHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlIHsKIAogCXN0cnVjdCB7CiAJCXN0cnVjdCBub3RpZmllcl9ibG9jayBwbV9u
b3RpZmllcjsKKworCQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dHMgeworCQkJc3BpbmxvY2tfdCBs
b2NrOyAvKiBsb2NrcyBsaXN0ICovCisJCQlzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7CisKKwkJCXN0
cnVjdCBsbGlzdF9oZWFkIGZyZWVfbGlzdDsKKwkJCXN0cnVjdCB3b3JrX3N0cnVjdCBmcmVlX3dv
cms7CisJCX0gY29udGV4dHM7CiAJfSBnZW07CiAKIAkvKiBGb3IgaTk0NWdtIHZibGFuayBpcnEg
dnMuIEMzIHdvcmthcm91bmQgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IDVhNjY0YmRl
YWQ4Yy4uZjZkYjQxNTk4NWQ1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTEyNjYsNyAr
MTI2Niw3IEBAIGludCBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKIAkJZ290byBlcnJfdW5sb2NrOwogCX0KIAotCXJldCA9IGk5MTVfZ2VtX2NvbnRleHRz
X2luaXQoZGV2X3ByaXYpOworCXJldCA9IGk5MTVfZ2VtX2luaXRfY29udGV4dHMoZGV2X3ByaXYp
OwogCWlmIChyZXQpIHsKIAkJR0VNX0JVR19PTihyZXQgPT0gLUVJTyk7CiAJCWdvdG8gZXJyX3Nj
cmF0Y2g7CkBAIC0xMzQ4LDcgKzEzNDgsNyBAQCBpbnQgaTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJfQogZXJyX2NvbnRleHQ6CiAJaWYgKHJldCAhPSAt
RUlPKQotCQlpOTE1X2dlbV9jb250ZXh0c19maW5pKGRldl9wcml2KTsKKwkJaTkxNV9nZW1fZHJp
dmVyX3JlbGVhc2VfX2NvbnRleHRzKGRldl9wcml2KTsKIGVycl9zY3JhdGNoOgogCWludGVsX2d0
X2RyaXZlcl9yZWxlYXNlKCZkZXZfcHJpdi0+Z3QpOwogZXJyX3VubG9jazoKQEAgLTE0MTYsMTEg
KzE0MTYsOSBAQCB2b2lkIGk5MTVfZ2VtX2RyaXZlcl9yZW1vdmUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQogCiB2b2lkIGk5MTVfZ2VtX2RyaXZlcl9yZWxlYXNlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJt
LnN0cnVjdF9tdXRleCk7CiAJaW50ZWxfZW5naW5lc19jbGVhbnVwKGRldl9wcml2KTsKLQlpOTE1
X2dlbV9jb250ZXh0c19maW5pKGRldl9wcml2KTsKKwlpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZV9f
Y29udGV4dHMoZGV2X3ByaXYpOwogCWludGVsX2d0X2RyaXZlcl9yZWxlYXNlKCZkZXZfcHJpdi0+
Z3QpOwotCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJaW50
ZWxfd2FfbGlzdF9mcmVlKCZkZXZfcHJpdi0+Z3Rfd2FfbGlzdCk7CiAKQEAgLTE0MzAsNyArMTQy
OCw3IEBAIHZvaWQgaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2Uoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQogCiAJaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhkZXZfcHJpdik7
CiAKLQlXQVJOX09OKCFsaXN0X2VtcHR5KCZkZXZfcHJpdi0+Y29udGV4dHMubGlzdCkpOworCVdB
Uk5fT04oIWxpc3RfZW1wdHkoJmRldl9wcml2LT5nZW0uY29udGV4dHMubGlzdCkpOwogfQogCiB2
b2lkIGk5MTVfZ2VtX2luaXRfbW1pbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKaW5kZXggMWQyNjYzNGNhNTk3Li43YjE1YmI4OTE5
NzAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCkBAIC0xMzY2LDcgKzEzNjYsOSBA
QCBzdGF0aWMgaW50IGdlbjhfaW5pdF9zY3JhdGNoKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2Ug
KnZtKQogCWlmICh2bS0+aGFzX3JlYWRfb25seSAmJgogCSAgICB2bS0+aTkxNS0+a2VybmVsX2Nv
bnRleHQgJiYKIAkgICAgdm0tPmk5MTUtPmtlcm5lbF9jb250ZXh0LT52bSkgewotCQlzdHJ1Y3Qg
aTkxNV9hZGRyZXNzX3NwYWNlICpjbG9uZSA9IHZtLT5pOTE1LT5rZXJuZWxfY29udGV4dC0+dm07
CisJCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKmNsb25lID0KKwkJCXJjdV9kZXJlZmVyZW5j
ZV9wcm90ZWN0ZWQodm0tPmk5MTUtPmtlcm5lbF9jb250ZXh0LT52bSwKKwkJCQkJCSAgdHJ1ZSk7
IC8qIHN0YXRpYyAqLwogCiAJCUdFTV9CVUdfT04oIWNsb25lLT5oYXNfcmVhZF9vbmx5KTsKIApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3BlcmYuYwppbmRleCBlY2ZiYzM3YjczOGIuLjIzMTM4OGQwNmM4MiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKQEAgLTE4NTMsOCArMTg1Myw4IEBAIHN0YXRpYyBp
bnQgZ2VuOF9jb25maWd1cmVfYWxsX2NvbnRleHRzKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpz
dHJlYW0sCiAJfTsKICN1bmRlZiBjdHhfZmxleGV1TgogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZTsKLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OwotCWludCBpOworCXN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsICpjbjsKKwlpbnQgaSwgZXJyOwogCiAJZm9yIChpID0g
MjsgaSA8IEFSUkFZX1NJWkUocmVncyk7IGkrKykKIAkJcmVnc1tpXS52YWx1ZSA9IG9hX2NvbmZp
Z19mbGV4X3JlZyhvYV9jb25maWcsIHJlZ3NbaV0ucmVnKTsKQEAgLTE4NzcsMTYgKzE4NzcsMjcg
QEAgc3RhdGljIGludCBnZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3RydWN0IGk5MTVfcGVy
Zl9zdHJlYW0gKnN0cmVhbSwKIAkgKiBjb250ZXh0LiBDb250ZXh0cyBpZGxlIGF0IHRoZSB0aW1l
IG9mIHJlY29uZmlndXJhdGlvbiBhcmUgbm90CiAJICogdHJhcHBlZCBiZWhpbmQgdGhlIGJhcnJp
ZXIuCiAJICovCi0JbGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsICZpOTE1LT5jb250ZXh0cy5saXN0
LCBsaW5rKSB7Ci0JCWludCBlcnI7Ci0KKwlzcGluX2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5s
b2NrKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoY3R4LCBjbiwgJmk5MTUtPmdlbS5jb250
ZXh0cy5saXN0LCBsaW5rKSB7CiAJCWlmIChjdHggPT0gaTkxNS0+a2VybmVsX2NvbnRleHQpCiAJ
CQljb250aW51ZTsKIAorCQlpZiAoIWtyZWZfZ2V0X3VubGVzc196ZXJvKCZjdHgtPnJlZikpCisJ
CQljb250aW51ZTsKKworCQlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOwor
CiAJCWVyciA9IGdlbjhfY29uZmlndXJlX2NvbnRleHQoY3R4LCByZWdzLCBBUlJBWV9TSVpFKHJl
Z3MpKTsKLQkJaWYgKGVycikKKwkJaWYgKGVycikgeworCQkJaTkxNV9nZW1fY29udGV4dF9wdXQo
Y3R4KTsKIAkJCXJldHVybiBlcnI7CisJCX0KKworCQlzcGluX2xvY2soJmk5MTUtPmdlbS5jb250
ZXh0cy5sb2NrKTsKKwkJbGlzdF9zYWZlX3Jlc2V0X25leHQoY3R4LCBjbiwgbGluayk7CisJCWk5
MTVfZ2VtX2NvbnRleHRfcHV0KGN0eCk7CiAJfQorCXNwaW5fdW5sb2NrKCZpOTE1LT5nZW0uY29u
dGV4dHMubG9jayk7CiAKIAkvKgogCSAqIEFmdGVyIHVwZGF0aW5nIGFsbCBvdGhlciBjb250ZXh0
cywgd2UgbmVlZCB0byBtb2RpZnkgb3Vyc2VsdmVzLgpAQCAtMTg5NSw3ICsxOTA2LDYgQEAgc3Rh
dGljIGludCBnZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3RydWN0IGk5MTVfcGVyZl9zdHJl
YW0gKnN0cmVhbSwKIAkgKi8KIAlmb3JfZWFjaF91YWJpX2VuZ2luZShlbmdpbmUsIGk5MTUpIHsK
IAkJc3RydWN0IGludGVsX2NvbnRleHQgKmNlID0gZW5naW5lLT5rZXJuZWxfY29udGV4dDsKLQkJ
aW50IGVycjsKIAogCQlpZiAoZW5naW5lLT5jbGFzcyAhPSBSRU5ERVJfQ0xBU1MpCiAJCQljb250
aW51ZTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYwppbmRleCAwMzRiOGFiYzUwNjIuLjJhNzI0
MDdhNjM4MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYwpAQCAtMTQ0LDkgKzE0NCw5IEBA
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIG1lZGlhX3JjNl9hdHRyX2dyb3Vw
ID0gewogfTsKICNlbmRpZgogCi1zdGF0aWMgaW50IGwzX2FjY2Vzc192YWxpZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGxvZmZfdCBvZmZzZXQpCitzdGF0aWMgaW50IGwzX2Fj
Y2Vzc192YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgbG9mZl90IG9mZnNldCkK
IHsKLQlpZiAoIUhBU19MM19EUEYoZGV2X3ByaXYpKQorCWlmICghSEFTX0wzX0RQRihpOTE1KSkK
IAkJcmV0dXJuIC1FUEVSTTsKIAogCWlmIChvZmZzZXQgJSA0ICE9IDApCkBAIC0xNjQsMzEgKzE2
NCwyNCBAQCBpOTE1X2wzX3JlYWQoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCBrb2JqZWN0ICpr
b2JqLAogCSAgICAgbG9mZl90IG9mZnNldCwgc2l6ZV90IGNvdW50KQogewogCXN0cnVjdCBkZXZp
Y2UgKmtkZXYgPSBrb2JqX3RvX2Rldihrb2JqKTsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Ci0Jc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9ICZkZXZfcHJpdi0+ZHJtOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
a2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwogCWludCBzbGljZSA9IChpbnQpKHVpbnRwdHJfdClh
dHRyLT5wcml2YXRlOwogCWludCByZXQ7CiAKLQljb3VudCA9IHJvdW5kX2Rvd24oY291bnQsIDQp
OwotCi0JcmV0ID0gbDNfYWNjZXNzX3ZhbGlkKGRldl9wcml2LCBvZmZzZXQpOworCXJldCA9IGwz
X2FjY2Vzc192YWxpZChpOTE1LCBvZmZzZXQpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAK
Kwljb3VudCA9IHJvdW5kX2Rvd24oY291bnQsIDQpOwogCWNvdW50ID0gbWluX3Qoc2l6ZV90LCBH
RU43X0wzTE9HX1NJWkUgLSBvZmZzZXQsIGNvdW50KTsKKwltZW1zZXQoYnVmLCAwLCBjb3VudCk7
CiAKLQlyZXQgPSBpOTE1X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZShkZXYpOwotCWlmIChyZXQp
Ci0JCXJldHVybiByZXQ7Ci0KLQlpZiAoZGV2X3ByaXYtPmwzX3Bhcml0eS5yZW1hcF9pbmZvW3Ns
aWNlXSkKKwlzcGluX2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKKwlpZiAoaTkxNS0+
bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdKQogCQltZW1jcHkoYnVmLAotCQkgICAgICAgZGV2
X3ByaXYtPmwzX3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNlXSArIChvZmZzZXQvNCksCisJCSAgICAg
ICBpOTE1LT5sM19wYXJpdHkucmVtYXBfaW5mb1tzbGljZV0gKyBvZmZzZXQgLyA0LAogCQkgICAg
ICAgY291bnQpOwotCWVsc2UKLQkJbWVtc2V0KGJ1ZiwgMCwgY291bnQpOwotCi0JbXV0ZXhfdW5s
b2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7CisJc3Bpbl91bmxvY2soJmk5MTUtPmdlbS5jb250ZXh0
cy5sb2NrKTsKIAogCXJldHVybiBjb3VudDsKIH0KQEAgLTE5OSw0NiArMTkyLDQ2IEBAIGk5MTVf
bDNfd3JpdGUoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCBrb2JqZWN0ICprb2JqLAogCSAgICAg
IGxvZmZfdCBvZmZzZXQsIHNpemVfdCBjb3VudCkKIHsKIAlzdHJ1Y3QgZGV2aWNlICprZGV2ID0g
a29ial90b19kZXYoa29iaik7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
a2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwotCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2
X3ByaXYtPmRybTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGtkZXZfbWlub3Jf
dG9faTkxNShrZGV2KTsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OwogCWludCBzbGlj
ZSA9IChpbnQpKHVpbnRwdHJfdClhdHRyLT5wcml2YXRlOwotCXUzMiAqKnJlbWFwX2luZm87CisJ
dTMyICpyZW1hcF9pbmZvLCAqZnJlZW1lID0gTlVMTDsKIAlpbnQgcmV0OwogCi0JcmV0ID0gbDNf
YWNjZXNzX3ZhbGlkKGRldl9wcml2LCBvZmZzZXQpOworCXJldCA9IGwzX2FjY2Vzc192YWxpZChp
OTE1LCBvZmZzZXQpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKLQlyZXQgPSBpOTE1X211
dGV4X2xvY2tfaW50ZXJydXB0aWJsZShkZXYpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7CisJ
cmVtYXBfaW5mbyA9IGt6YWxsb2MoR0VON19MM0xPR19TSVpFLCBHRlBfS0VSTkVMKTsKKwlpZiAo
IXJlbWFwX2luZm8pCisJCXJldHVybiAtRU5PTUVNOwogCi0JcmVtYXBfaW5mbyA9ICZkZXZfcHJp
di0+bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdOwotCWlmICghKnJlbWFwX2luZm8pIHsKLQkJ
KnJlbWFwX2luZm8gPSBremFsbG9jKEdFTjdfTDNMT0dfU0laRSwgR0ZQX0tFUk5FTCk7Ci0JCWlm
ICghKnJlbWFwX2luZm8pIHsKLQkJCXJldCA9IC1FTk9NRU07Ci0JCQlnb3RvIG91dDsKLQkJfQor
CXNwaW5fbG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCisJaWYgKGk5MTUtPmwzX3Bh
cml0eS5yZW1hcF9pbmZvW3NsaWNlXSkgeworCQlmcmVlbWUgPSByZW1hcF9pbmZvOworCQlyZW1h
cF9pbmZvID0gaTkxNS0+bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdOworCX0gZWxzZSB7CisJ
CWk5MTUtPmwzX3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNlXSA9IHJlbWFwX2luZm87CiAJfQogCi0J
LyogVE9ETzogSWRlYWxseSB3ZSByZWFsbHkgd2FudCBhIEdQVSByZXNldCBoZXJlIHRvIG1ha2Ug
c3VyZSBlcnJvcnMKLQkgKiBhcmVuJ3QgcHJvcGFnYXRlZC4gU2luY2UgSSBjYW5ub3QgZmluZCBh
IHN0YWJsZSB3YXkgdG8gcmVzZXQgdGhlIEdQVQotCSAqIGF0IHRoaXMgcG9pbnQgaXQgaXMgbGVm
dCBhcyBhIFRPRE8uCi0JKi8KLQltZW1jcHkoKnJlbWFwX2luZm8gKyAob2Zmc2V0LzQpLCBidWYs
IGNvdW50KTsKKwljb3VudCA9IHJvdW5kX2Rvd24oY291bnQsIDQpOworCW1lbWNweShyZW1hcF9p
bmZvICsgb2Zmc2V0IC8gNCwgYnVmLCBjb3VudCk7CiAKIAkvKiBOQjogV2UgZGVmZXIgdGhlIHJl
bWFwcGluZyB1bnRpbCB3ZSBzd2l0Y2ggdG8gdGhlIGNvbnRleHQgKi8KLQlsaXN0X2Zvcl9lYWNo
X2VudHJ5KGN0eCwgJmRldl9wcml2LT5jb250ZXh0cy5saXN0LCBsaW5rKQotCQljdHgtPnJlbWFw
X3NsaWNlIHw9ICgxPDxzbGljZSk7CisJbGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsICZpOTE1LT5n
ZW0uY29udGV4dHMubGlzdCwgbGluaykKKwkJY3R4LT5yZW1hcF9zbGljZSB8PSBCSVQoc2xpY2Up
OwogCi0JcmV0ID0gY291bnQ7CisJc3Bpbl91bmxvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2Nr
KTsKKwlrZnJlZShmcmVlbWUpOwogCi1vdXQ6Ci0JbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9t
dXRleCk7CisJLyoKKwkgKiBUT0RPOiBJZGVhbGx5IHdlIHJlYWxseSB3YW50IGEgR1BVIHJlc2V0
IGhlcmUgdG8gbWFrZSBzdXJlIGVycm9ycworCSAqIGFyZW4ndCBwcm9wYWdhdGVkLiBTaW5jZSBJ
IGNhbm5vdCBmaW5kIGEgc3RhYmxlIHdheSB0byByZXNldCB0aGUgR1BVCisJICogYXQgdGhpcyBw
b2ludCBpdCBpcyBsZWZ0IGFzIGEgVE9ETy4KKwkgKi8KIAotCXJldHVybiByZXQ7CisJcmV0dXJu
IGNvdW50OwogfQogCiBzdGF0aWMgY29uc3Qgc3RydWN0IGJpbl9hdHRyaWJ1dGUgZHBmX2F0dHJz
ID0gewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCmluZGV4IDFmMmNmNmNmYWZiNS4uN2VmN2Ex
ZTE2NjRjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RyYWNlLmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCkBAIC05NTIsNyArOTUyLDcgQEAg
REVDTEFSRV9FVkVOVF9DTEFTUyhpOTE1X2NvbnRleHQsCiAJVFBfZmFzdF9hc3NpZ24oCiAJCQlf
X2VudHJ5LT5kZXYgPSBjdHgtPmk5MTUtPmRybS5wcmltYXJ5LT5pbmRleDsKIAkJCV9fZW50cnkt
PmN0eCA9IGN0eDsKLQkJCV9fZW50cnktPnZtID0gY3R4LT52bTsKKwkJCV9fZW50cnktPnZtID0g
cmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pOwogCSksCiAKIAlUUF9wcmludGsoImRldj0ldSwg
Y3R4PSVwLCBjdHhfdm09JXAiLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9n
ZW0uYwppbmRleCAwMzQ2YzNlNWI2YjYuLmJmYTQwYTViNmQ5OCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMKQEAgLTEzOCwxMSArMTM4LDkgQEAgc3RhdGljIGlu
dCBpZ3RfZ2VtX3N1c3BlbmQodm9pZCAqYXJnKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAog
CWVyciA9IC1FTk9NRU07Ci0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJ
Y3R4ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmICghSVNfRVJSKGN0eCkpCiAJCWVy
ciA9IHN3aXRjaF90b19jb250ZXh0KGk5MTUsIGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKIAlpZiAoZXJyKQogCQlnb3RvIG91dDsKIApAQCAtMTU3LDkgKzE1
NSw3IEBAIHN0YXRpYyBpbnQgaWd0X2dlbV9zdXNwZW5kKHZvaWQgKmFyZykKIAogCXBtX3Jlc3Vt
ZShpOTE1KTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWVyciA9
IHN3aXRjaF90b19jb250ZXh0KGk5MTUsIGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0u
c3RydWN0X211dGV4KTsKIG91dDoKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAlyZXR1
cm4gZXJyOwpAQCAtMTc3LDExICsxNzMsOSBAQCBzdGF0aWMgaW50IGlndF9nZW1faGliZXJuYXRl
KHZvaWQgKmFyZykKIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7CiAKIAllcnIgPSAtRU5PTUVNOwot
CW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWN0eCA9IGxpdmVfY29udGV4
dChpOTE1LCBmaWxlKTsKIAlpZiAoIUlTX0VSUihjdHgpKQogCQllcnIgPSBzd2l0Y2hfdG9fY29u
dGV4dChpOTE1LCBjdHgpOwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
CiAJaWYgKGVycikKIAkJZ290byBvdXQ7CiAKQEAgLTE5Niw5ICsxOTAsNyBAQCBzdGF0aWMgaW50
IGlndF9nZW1faGliZXJuYXRlKHZvaWQgKmFyZykKIAogCXBtX3Jlc3VtZShpOTE1KTsKIAotCW11
dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWVyciA9IHN3aXRjaF90b19jb250
ZXh0KGk5MTUsIGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
IG91dDoKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAlyZXR1cm4gZXJyOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYwppbmRleCBmMzlm
MDI4MmU3OGMuLjBhZjlhNThkMDExZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMKQEAgLTQ3Myw3ICs0NzMsNiBAQCBzdGF0aWMgaW50IGln
dF9ldmljdF9jb250ZXh0cyh2b2lkICphcmcpCiAJCX0KIAogCQljb3VudCA9IDA7Ci0JCW11dGV4
X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQlvbnN0YWNrX2ZlbmNlX2luaXQoJmZl
bmNlKTsKIAkJZG8gewogCQkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CkBAIC01MTAsOCArNTA5
LDYgQEAgc3RhdGljIGludCBpZ3RfZXZpY3RfY29udGV4dHModm9pZCAqYXJnKQogCQkJY291bnQr
KzsKIAkJCWVyciA9IDA7CiAJCX0gd2hpbGUoMSk7Ci0JCW11dGV4X3VubG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7Ci0KIAkJb25zdGFja19mZW5jZV9maW5pKCZmZW5jZSk7CiAJCXByX2lu
Zm8oIlN1Ym1pdHRlZCAlbHUgY29udGV4dHMvcmVxdWVzdHMgb24gJXNcbiIsCiAJCQljb3VudCwg
ZW5naW5lLT5uYW1lKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9pOTE1X2dlbV9ndHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dl
bV9ndHQuYwppbmRleCBlNDBlNmNmYTUxZjEuLjhkODEyMWMwMjE2MSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYwpAQCAtMTI0Niw2ICsxMjQ2LDcg
QEAgc3RhdGljIGludCBleGVyY2lzZV9tb2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAogCQkJCSAgICAgdW5zaWduZWQgbG9uZyBlbmRfdGltZSkpCiB7CiAJY29uc3QgdTY0IGxpbWl0
ID0gdG90YWxyYW1fcGFnZXMoKSA8PCBQQUdFX1NISUZUOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nf
c3BhY2UgKnZtOwogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CiAJSUdUX1RJTUVPVVQo
ZW5kX3RpbWUpOwogCWludCBlcnI7CkBAIC0xMjU0LDcgKzEyNTUsOSBAQCBzdGF0aWMgaW50IGV4
ZXJjaXNlX21vY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJaWYgKCFjdHgpCiAJ
CXJldHVybiAtRU5PTUVNOwogCi0JZXJyID0gZnVuYyhpOTE1LCBjdHgtPnZtLCAwLCBtaW4oY3R4
LT52bS0+dG90YWwsIGxpbWl0KSwgZW5kX3RpbWUpOworCXZtID0gaTkxNV9nZW1fY29udGV4dF9n
ZXRfdm1fcmN1KGN0eCk7CisJZXJyID0gZnVuYyhpOTE1LCB2bSwgMCwgbWluKHZtLT50b3RhbCwg
bGltaXQpLCBlbmRfdGltZSk7CisJaTkxNV92bV9wdXQodm0pOwogCiAJbW9ja19jb250ZXh0X2Ns
b3NlKGN0eCk7CiAJcmV0dXJuIGVycjsKQEAgLTE4MDEsMTUgKzE4MDQsMTUgQEAgc3RhdGljIGlu
dCBpZ3RfY3NfdGxiKHZvaWQgKmFyZykKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KIAotCXZtID0g
Y3R4LT52bTsKLQlpZiAoIXZtKQotCQlnb3RvIG91dF91bmxvY2s7CisJdm0gPSBpOTE1X2dlbV9j
b250ZXh0X2dldF92bV9yY3UoY3R4KTsKKwlpZiAoaTkxNV9pc19nZ3R0KHZtKSkKKwkJZ290byBv
dXRfdm07CiAKIAkvKiBDcmVhdGUgdHdvIHBhZ2VzOyBkdW1teSB3ZSBwcmVmaWxsIHRoZSBUTEIs
IGFuZCBpbnRlbmRlZCAqLwogCWJiZSA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwo
aTkxNSwgUEFHRV9TSVpFKTsKIAlpZiAoSVNfRVJSKGJiZSkpIHsKIAkJZXJyID0gUFRSX0VSUihi
YmUpOwotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8gb3V0X3ZtOwogCX0KIAogCWJhdGNoID0g
aTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoYmJlLCBJOTE1X01BUF9XQyk7CkBAIC0yMDE0LDYgKzIw
MTcsOCBAQCBzdGF0aWMgaW50IGlndF9jc190bGIodm9pZCAqYXJnKQogCWk5MTVfZ2VtX29iamVj
dF9wdXQoYWN0KTsKIG91dF9wdXRfYmJlOgogCWk5MTVfZ2VtX29iamVjdF9wdXQoYmJlKTsKK291
dF92bToKKwlpOTE1X3ZtX3B1dCh2bSk7CiBvdXRfdW5sb2NrOgogCW11dGV4X3VubG9jaygmaTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJbW9ja19maWxlX2ZyZWUoaTkxNSwgZmlsZSk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMKaW5kZXggZDdkNjhj
NmE2YmQ1Li4wODk3YTdiMDQ5NDQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3Nl
bGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvaTkxNV9yZXF1ZXN0LmMKQEAgLTE4MSw5ICsxODEsNyBAQCBzdGF0aWMgaW50IGlndF9yZXF1
ZXN0X3Jld2luZCh2b2lkICphcmcpCiAJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwogCWludCBl
cnIgPSAtRUlOVkFMOwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJ
Y3R4WzBdID0gbW9ja19jb250ZXh0KGk5MTUsICJBIik7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKIAogCWNlID0gaTkxNV9nZW1fY29udGV4dF9nZXRfZW5naW5lKGN0
eFswXSwgUkNTMCk7CiAJR0VNX0JVR19PTihJU19FUlIoY2UpKTsKQEAgLTE5Nyw5ICsxOTUsNyBA
QCBzdGF0aWMgaW50IGlndF9yZXF1ZXN0X3Jld2luZCh2b2lkICphcmcpCiAJaTkxNV9yZXF1ZXN0
X2dldChyZXF1ZXN0KTsKIAlpOTE1X3JlcXVlc3RfYWRkKHJlcXVlc3QpOwogCi0JbXV0ZXhfbG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJY3R4WzFdID0gbW9ja19jb250ZXh0KGk5MTUs
ICJCIik7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCWNlID0g
aTkxNV9nZW1fY29udGV4dF9nZXRfZW5naW5lKGN0eFsxXSwgUkNTMCk7CiAJR0VNX0JVR19PTihJ
U19FUlIoY2UpKTsKQEAgLTQzOCw5ICs0MzQsNyBAQCBzdGF0aWMgaW50IG1vY2tfYnJlYWRjcnVt
YnNfc21va2V0ZXN0KHZvaWQgKmFyZykKIAl9CiAKIAlmb3IgKG4gPSAwOyBuIDwgdC5uY29udGV4
dHM7IG4rKykgewotCQltdXRleF9sb2NrKCZ0LmVuZ2luZS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7CiAJCXQuY29udGV4dHNbbl0gPSBtb2NrX2NvbnRleHQodC5lbmdpbmUtPmk5MTUsICJtb2Nr
Iik7Ci0JCW11dGV4X3VubG9jaygmdC5lbmdpbmUtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwog
CQlpZiAoIXQuY29udGV4dHNbbl0pIHsKIAkJCXJldCA9IC1FTk9NRU07CiAJCQlnb3RvIG91dF9j
b250ZXh0czsKQEAgLTczNCw5ICs3MjgsOSBAQCBzdGF0aWMgaW50IGxpdmVfZW1wdHlfcmVxdWVz
dCh2b2lkICphcmcpCiBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpyZWN1cnNpdmVfYmF0Y2goc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQg
KmN0eCA9IGk5MTUtPmtlcm5lbF9jb250ZXh0OwotCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2Ug
KnZtID0gY3R4LT52bSA/OiAmaTkxNS0+Z2d0dC52bTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqOwogCWNvbnN0IGludCBnZW4gPSBJTlRFTF9HRU4oaTkxNSk7CisJc3RydWN0IGk5
MTVfYWRkcmVzc19zcGFjZSAqdm07CiAJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAJdTMyICpjbWQ7
CiAJaW50IGVycjsKQEAgLTc0NSw3ICs3MzksOSBAQCBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpy
ZWN1cnNpdmVfYmF0Y2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJaWYgKElTX0VS
UihvYmopKQogCQlyZXR1cm4gRVJSX0NBU1Qob2JqKTsKIAorCXZtID0gaTkxNV9nZW1fY29udGV4
dF9nZXRfdm1fcmN1KGN0eCk7CiAJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCB2bSwgTlVM
TCk7CisJaTkxNV92bV9wdXQodm0pOwogCWlmIChJU19FUlIodm1hKSkgewogCQllcnIgPSBQVFJf
RVJSKHZtYSk7CiAJCWdvdG8gZXJyOwpAQCAtMTIyMCw5ICsxMjE2LDcgQEAgc3RhdGljIGludCBs
aXZlX2JyZWFkY3J1bWJzX3Ntb2tldGVzdCh2b2lkICphcmcpCiAJfQogCiAJZm9yIChuID0gMDsg
biA8IHRbMF0ubmNvbnRleHRzOyBuKyspIHsKLQkJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7CiAJCXRbMF0uY29udGV4dHNbbl0gPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7
Ci0JCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJCWlmICghdFswXS5j
b250ZXh0c1tuXSkgewogCQkJcmV0ID0gLUVOT01FTTsKIAkJCWdvdG8gb3V0X2NvbnRleHRzOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfdm1hLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYwppbmRleCBhYzFmZjU1OGVi
OTAuLjU4YjVmNDBhMDdkZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfdm1hLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVf
dm1hLmMKQEAgLTI0LDYgKzI0LDcgQEAKIAogI2luY2x1ZGUgPGxpbnV4L3ByaW1lX251bWJlcnMu
aD4KIAorI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jb250ZXh0LmgiCiAjaW5jbHVkZSAiZ2VtL3Nl
bGZ0ZXN0cy9tb2NrX2NvbnRleHQuaCIKIAogI2luY2x1ZGUgImk5MTVfc2NhdHRlcmxpc3QuaCIK
QEAgLTM4LDcgKzM5LDcgQEAgc3RhdGljIGJvb2wgYXNzZXJ0X3ZtYShzdHJ1Y3QgaTkxNV92bWEg
KnZtYSwKIHsKIAlib29sIG9rID0gdHJ1ZTsKIAotCWlmICh2bWEtPnZtICE9IGN0eC0+dm0pIHsK
KwlpZiAodm1hLT52bSAhPSByY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpIHsKIAkJcHJfZXJy
KCJWTUEgY3JlYXRlZCB3aXRoIHdyb25nIFZNXG4iKTsKIAkJb2sgPSBmYWxzZTsKIAl9CkBAIC0x
MTMsMTEgKzExNCwxMyBAQCBzdGF0aWMgaW50IGNyZWF0ZV92bWFzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAogCWxpc3RfZm9yX2VhY2hfZW50cnkob2JqLCBvYmplY3RzLCBzdF9saW5r
KSB7CiAJCWZvciAocGlubmVkID0gMDsgcGlubmVkIDw9IDE7IHBpbm5lZCsrKSB7CiAJCQlsaXN0
X2Zvcl9lYWNoX2VudHJ5KGN0eCwgY29udGV4dHMsIGxpbmspIHsKLQkJCQlzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm07CisJCQkJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm07CiAJCQkJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAJCQkJaW50IGVycjsKIAorCQkJCXZt
ID0gaTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KGN0eCk7CiAJCQkJdm1hID0gY2hlY2tlZF92
bWFfaW5zdGFuY2Uob2JqLCB2bSwgTlVMTCk7CisJCQkJaTkxNV92bV9wdXQodm0pOwogCQkJCWlm
IChJU19FUlIodm1hKSkKIAkJCQkJcmV0dXJuIFBUUl9FUlIodm1hKTsKIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jCmluZGV4IDRlNmNkZTBk
NDg1OS4uMzM1ZjM3YmE5OGRlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvbW9ja19nZW1fZGV2aWNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL21vY2tfZ2VtX2RldmljZS5jCkBAIC01OSwxMSArNTksOSBAQCBzdGF0aWMgdm9pZCBtb2Nr
X2RldmljZV9yZWxlYXNlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAKIAlpOTE1X2dlbV9kcmFp
bl93b3JrcXVldWUoaTkxNSk7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkKIAkJbW9ja19lbmdpbmVfZnJl
ZShlbmdpbmUpOwotCWk5MTVfZ2VtX2NvbnRleHRzX2ZpbmkoaTkxNSk7Ci0JbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwlpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZV9fY29u
dGV4dHMoaTkxNSk7CiAKIAlpbnRlbF90aW1lbGluZXNfZmluaShpOTE1KTsKIApAQCAtMjA2LDcg
KzIwNCw3IEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICptb2NrX2dlbV9kZXZpY2Uodm9pZCkK
IAlyZXR1cm4gaTkxNTsKIAogZXJyX2NvbnRleHQ6Ci0JaTkxNV9nZW1fY29udGV4dHNfZmluaShp
OTE1KTsKKwlpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZV9fY29udGV4dHMoaTkxNSk7CiBlcnJfZW5n
aW5lOgogCW1vY2tfZW5naW5lX2ZyZWUoaTkxNS0+ZW5naW5lW1JDUzBdKTsKIGVycl91bmxvY2s6
Ci0tIAoyLjIzLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdm
eA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 330E6357634
	for <lists+intel-gfx@lfdr.de>; Wed,  7 Apr 2021 22:39:56 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3325D6E987;
	Wed,  7 Apr 2021 20:39:54 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6CBDE6E987
 for <intel-gfx@lists.freedesktop.org>; Wed,  7 Apr 2021 20:39:53 +0000 (UTC)
IronPort-SDR: 8CKTCrkhaHtsxbEoryActy/1B7ovA8bg+YGNXvzlOBWWeb4pXKqOm8njO9FFytwzF2TAdBSMJy
 Qey1zfiStF+w==
X-IronPort-AV: E=McAfee;i="6000,8403,9947"; a="180936176"
X-IronPort-AV: E=Sophos;i="5.82,204,1613462400"; d="scan'208";a="180936176"
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by orsmga106.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 07 Apr 2021 13:39:52 -0700
IronPort-SDR: NtFzAKMuny/Oh8jX15ratplGdqeOQD9hEEtixRYS/lVLh5tMy0I2c54NpfF1ekQCOX8hqioJtl
 ntwK4TyT6Yhw==
X-IronPort-AV: E=Sophos;i="5.82,204,1613462400"; d="scan'208";a="519570759"
Received: from mdroper-desk1.fm.intel.com ([10.1.27.168])
 by fmsmga001-auth.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 07 Apr 2021 13:39:52 -0700
From: Matt Roper <matthew.d.roper@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  7 Apr 2021 13:39:45 -0700
Message-Id: <20210407203945.1432531-1-matthew.d.roper@intel.com>
X-Mailer: git-send-email 2.25.4
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915/display: Eliminate IS_GEN9_{BC,LP}
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Tm93IHRoYXQgd2UndmUgZWxpbWluYXRlZCBJTlRFTF9HRU4oKSwgSVNfR0VOX1JBTkdFKCksIGV0
Yy4gZnJvbSB0aGUKZGlzcGxheSBjb2RlLCB3ZSBzaG91bGQgYWxzbyBraWxsIG9mZiBvdXIgdXNl
IG9mIHRoZSBJU19HRU45XyogbWFjcm9zCnRvby4gIFdlJ2xsIGRvIHRoZSBjb252ZXJzaW9uIG1h
bnVhbGx5IHRoaXMgdGltZSBpbnN0ZWFkIG9mIHVzaW5nCkNvY2NpbmVsbGUgc2luY2UgdGhlIG1v
c3QgbG9naWNhbCBzdWJzdGl0dXRpb24gY2FuIGRlcGVuZCBoZWF2aWx5IG9uIHRoZQpjb2RlIGNv
bnRleHQsIGFuZCBzb21ldGltZXMgd2UgY2FuIGtlZXAgdGhlIGNvZGUgc2ltcGxlciBpZiB3ZSBt
YWtlCmFkZGl0aW9uYWwgYWRqdXN0bWVudHMgc3VjaCBhcyBzd2FwcGluZyB0aGUgb3JkZXIgb2Yg
aWYvZWxzZSBhcm1zLgoKdjI6CiAtIFJlc3RvcmUgYSBsb3N0IG5lZ2F0aW9uIGluIGludGVsX3Bs
bF9pc192YWxpZCgpLgoKQ2M6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5p
bnRlbC5jb20+CkNjOiBMdWNhcyBEZSBNYXJjaGkgPGx1Y2FzLmRlbWFyY2hpQGludGVsLmNvbT4K
U2lnbmVkLW9mZi1ieTogTWF0dCBSb3BlciA8bWF0dGhldy5kLnJvcGVyQGludGVsLmNvbT4KUmV2
aWV3ZWQtYnk6IFJhZGhha3Jpc2huYSBTcmlwYWRhIDxyYWRoYWtyaXNobmEuc3JpcGFkYUBpbnRl
bC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9iaW9zLmMgICAg
IHwgIDcgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2NkY2xrLmMgICAg
fCAzNCArKysrKysrLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9j
c3IuYyAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRp
LmMgICAgICB8IDM3ICsrKysrKysrLS0tLS0tLQogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGRpX2J1Zl90cmFucy5jICAgIHwgIDggKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kaXNwbGF5LmMgIHwgMTEgKysrLS0KIC4uLi9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Rpc3BsYXlfZGVidWdmcy5jICB8ICAyICstCiAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
aXNwbGF5X3Bvd2VyLmMgICAgfCA0MyArKysrKysrKystLS0tLS0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZHBfbXN0LmMgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2RwbGwuYyAgICAgfCAgNiArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZHBsbF9tZ3IuYyB8ICA2ICstLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9mYmMuYyAgICAgIHwgIDcgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2dtYnVzLmMgICAgfCAxMiArKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9oZGNwLmMgICAgIHwgIDkgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9oZG1pLmMgICAgIHwgIDcgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX3BhbmVsLmMgICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9wcHMuYyAgICAgIHwgMTQgKysrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L3Zsdl9kc2kuYyAgICAgICAgfCA0NiArKysrKysrKysrLS0tLS0tLS0tCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jICAgICAgICAgICAgICAgfCAxMyArKystLS0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMgICAgICAgICAgICAgICB8ICA4ICsrLS0KIDIxIGZp
bGVzIGNoYW5nZWQsIDE0NiBpbnNlcnRpb25zKCspLCAxMzQgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9iaW9zLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Jpb3MuYwppbmRleCAzZDBjMDM1YjVlMzguLmVh
NDgzN2Q0ODVhMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9iaW9zLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9iaW9zLmMK
QEAgLTkxNyw3ICs5MTcsNyBAQCBwYXJzZV9wc3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsIGNvbnN0IHN0cnVjdCBiZGJfaGVhZGVyICpiZGIpCiAJICogT2xkIGRlY2ltYWwgdmFsdWUg
aXMgd2FrZSB1cCB0aW1lIGluIG11bHRpcGxlcyBvZiAxMDAgdXMuCiAJICovCiAJaWYgKGJkYi0+
dmVyc2lvbiA+PSAyMDUgJiYKLQkgICAgKElTX0dFTjlfQkMoaTkxNSkgfHwgRElTUExBWV9WRVIo
aTkxNSkgPj0gMTApKSB7CisJICAgIChESVNQTEFZX1ZFUihpOTE1KSA+PSA5ICYmICFJU19CUk9Y
VE9OKGk5MTUpKSkgewogCQlzd2l0Y2ggKHBzcl90YWJsZS0+dHAxX3dha2V1cF90aW1lKSB7CiAJ
CWNhc2UgMDoKIAkJCWk5MTUtPnZidC5wc3IudHAxX3dha2V1cF90aW1lX3VzID0gNTAwOwpAQCAt
MTY1OSw3ICsxNjU5LDcgQEAgc3RhdGljIHU4IG1hcF9kZGNfcGluKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCB1OCB2YnRfcGluKQogCX0gZWxzZSBpZiAoSVNfUk9DS0VUTEFLRShpOTE1
KSAmJiBJTlRFTF9QQ0hfVFlQRShpOTE1KSA9PSBQQ0hfVEdQKSB7CiAJCWRkY19waW5fbWFwID0g
cmtsX3BjaF90Z3BfZGRjX3Bpbl9tYXA7CiAJCW5fZW50cmllcyA9IEFSUkFZX1NJWkUocmtsX3Bj
aF90Z3BfZGRjX3Bpbl9tYXApOwotCX0gZWxzZSBpZiAoSEFTX1BDSF9UR1AoaTkxNSkgJiYgSVNf
R0VOOV9CQyhpOTE1KSkgeworCX0gZWxzZSBpZiAoSEFTX1BDSF9UR1AoaTkxNSkgJiYgSVNfRElT
UExBWV9WRVIoaTkxNSwgOSkpIHsKIAkJZGRjX3Bpbl9tYXAgPSBnZW45YmNfdGdwX2RkY19waW5f
bWFwOwogCQluX2VudHJpZXMgPSBBUlJBWV9TSVpFKGdlbjliY190Z3BfZGRjX3Bpbl9tYXApOwog
CX0gZWxzZSBpZiAoSU5URUxfUENIX1RZUEUoaTkxNSkgPj0gUENIX0lDUCkgewpAQCAtMjc3MCw3
ICsyNzcwLDggQEAgaW50ZWxfYmlvc19pc19wb3J0X2hwZF9pbnZlcnRlZChjb25zdCBzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAljb25zdCBzdHJ1Y3QgaW50ZWxfYmlvc19lbmNvZGVy
X2RhdGEgKmRldmRhdGEgPQogCQlpOTE1LT52YnQuZGRpX3BvcnRfaW5mb1twb3J0XS5kZXZkYXRh
OwogCi0JaWYgKGRybV9XQVJOX09OX09OQ0UoJmk5MTUtPmRybSwgIUlTX0dFTjlfTFAoaTkxNSkp
KQorCWlmIChkcm1fV0FSTl9PTl9PTkNFKCZpOTE1LT5kcm0sCisJCQkgICAgICFJU19HRU1JTklM
QUtFKGk5MTUpICYmICFJU19CUk9YVE9OKGk5MTUpKSkKIAkJcmV0dXJuIGZhbHNlOwogCiAJcmV0
dXJuIGRldmRhdGEgJiYgZGV2ZGF0YS0+Y2hpbGQuaHBkX2ludmVydDsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY2RjbGsuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfY2RjbGsuYwppbmRleCAzZjQzYWQ0ZDczNjIuLjQ4OWFjZjZi
NWNmMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jZGNs
ay5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY2RjbGsuYwpAQCAt
MTYzMSw3ICsxNjMxLDggQEAgc3RhdGljIHZvaWQgYnh0X3NldF9jZGNsayhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJICogRGlzYWJsZSBTU0EgUHJlY2hhcmdlIHdoZW4gQ0Qg
Y2xvY2sgZnJlcXVlbmN5IDwgNTAwIE1IeiwKIAkgKiBlbmFibGUgb3RoZXJ3aXNlLgogCSAqLwot
CWlmIChJU19HRU45X0xQKGRldl9wcml2KSAmJiBjZGNsayA+PSA1MDAwMDApCisJaWYgKChJU19H
RU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkgJiYKKwkgICAgY2Rj
bGsgPj0gNTAwMDAwKQogCQl2YWwgfD0gQlhUX0NEQ0xLX1NTQV9QUkVDSEFSR0VfRU5BQkxFOwog
CWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBDRENMS19DVEwsIHZhbCk7CiAKQEAgLTE3MzIsNyAr
MTczMyw4IEBAIHN0YXRpYyB2b2lkIGJ4dF9zYW5pdGl6ZV9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCiAJICogRGlzYWJsZSBTU0EgUHJlY2hhcmdlIHdoZW4gQ0QgY2xv
Y2sgZnJlcXVlbmN5IDwgNTAwIE1IeiwKIAkgKiBlbmFibGUgb3RoZXJ3aXNlLgogCSAqLwotCWlm
IChJU19HRU45X0xQKGRldl9wcml2KSAmJiBkZXZfcHJpdi0+Y2RjbGsuaHcuY2RjbGsgPj0gNTAw
MDAwKQorCWlmICgoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJp
dikpICYmCisJICAgIGRldl9wcml2LT5jZGNsay5ody5jZGNsayA+PSA1MDAwMDApCiAJCWV4cGVj
dGVkIHw9IEJYVF9DRENMS19TU0FfUFJFQ0hBUkdFX0VOQUJMRTsKIAogCWlmIChjZGN0bCA9PSBl
eHBlY3RlZCkKQEAgLTE3OTcsOSArMTc5OSw5IEBAIHN0YXRpYyB2b2lkIGJ4dF9jZGNsa191bmlu
aXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogICovCiB2b2lkIGludGVs
X2NkY2xrX2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7Ci0JaWYgKElT
X0dFTjlfTFAoaTkxNSkgfHwgRElTUExBWV9WRVIoaTkxNSkgPj0gMTApCisJaWYgKERJU1BMQVlf
VkVSKGk5MTUpID49IDEwIHx8IElTX0JST1hUT04oaTkxNSkpCiAJCWJ4dF9jZGNsa19pbml0X2h3
KGk5MTUpOwotCWVsc2UgaWYgKElTX0dFTjlfQkMoaTkxNSkpCisJZWxzZSBpZiAoSVNfRElTUExB
WV9WRVIoaTkxNSwgOSkpCiAJCXNrbF9jZGNsa19pbml0X2h3KGk5MTUpOwogfQogCkBAIC0xODEy
LDkgKzE4MTQsOSBAQCB2b2lkIGludGVsX2NkY2xrX2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCiAgKi8KIHZvaWQgaW50ZWxfY2RjbGtfdW5pbml0X2h3KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQogewotCWlmIChESVNQTEFZX1ZFUihpOTE1KSA+PSAxMCB8fCBJ
U19HRU45X0xQKGk5MTUpKQorCWlmIChESVNQTEFZX1ZFUihpOTE1KSA+PSAxMCB8fCBJU19CUk9Y
VE9OKGk5MTUpKQogCQlieHRfY2RjbGtfdW5pbml0X2h3KGk5MTUpOwotCWVsc2UgaWYgKElTX0dF
TjlfQkMoaTkxNSkpCisJZWxzZSBpZiAoSVNfRElTUExBWV9WRVIoaTkxNSwgOSkpCiAJCXNrbF9j
ZGNsa191bmluaXRfaHcoaTkxNSk7CiB9CiAKQEAgLTE4NTIsNyArMTg1NCw3IEBAIHN0YXRpYyBi
b29sIGludGVsX2NkY2xrX2Nhbl9jZDJ4X3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCiAJCQkJCWNvbnN0IHN0cnVjdCBpbnRlbF9jZGNsa19jb25maWcgKmIpCiB7CiAJ
LyogT2xkZXIgaHcgZG9lc24ndCBoYXZlIHRoZSBjYXBhYmlsaXR5ICovCi0JaWYgKERJU1BMQVlf
VkVSKGRldl9wcml2KSA8IDEwICYmICFJU19HRU45X0xQKGRldl9wcml2KSkKKwlpZiAoRElTUExB
WV9WRVIoZGV2X3ByaXYpIDwgMTAgJiYgIUlTX0JST1hUT04oZGV2X3ByaXYpKQogCQlyZXR1cm4g
ZmFsc2U7CiAKIAlyZXR1cm4gYS0+Y2RjbGsgIT0gYi0+Y2RjbGsgJiYKQEAgLTI2MjUsNyArMjYy
NywxMSBAQCB2b2lkIGludGVsX3VwZGF0ZV9tYXhfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQogCQkJZGV2X3ByaXYtPm1heF9jZGNsa19mcmVxID0gNjUyODAwOwogCX0g
ZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikpIHsKIAkJZGV2X3ByaXYtPm1heF9jZGNs
a19mcmVxID0gNTI4MDAwOwotCX0gZWxzZSBpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikpIHsKKwl9
IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7CisJCWRldl9wcml2LT5tYXhfY2Rj
bGtfZnJlcSA9IDMxNjgwMDsKKwl9IGVsc2UgaWYgKElTX0JST1hUT04oZGV2X3ByaXYpKSB7CisJ
CWRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSA9IDYyNDAwMDsKKwl9IGVsc2UgaWYgKElTX0RJU1BM
QVlfVkVSKGRldl9wcml2LCA5KSkgewogCQl1MzIgbGltaXQgPSBpbnRlbF9kZV9yZWFkKGRldl9w
cml2LCBTS0xfREZTTSkgJiBTS0xfREZTTV9DRENMS19MSU1JVF9NQVNLOwogCQlpbnQgbWF4X2Nk
Y2xrLCB2Y287CiAKQEAgLTI2NDcsMTAgKzI2NTMsNiBAQCB2b2lkIGludGVsX3VwZGF0ZV9tYXhf
Y2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQkJbWF4X2NkY2xrID0g
MzA4NTcxOwogCiAJCWRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSA9IHNrbF9jYWxjX2NkY2xrKG1h
eF9jZGNsaywgdmNvKTsKLQl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7Ci0J
CWRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSA9IDMxNjgwMDsKLQl9IGVsc2UgaWYgKElTX0JST1hU
T04oZGV2X3ByaXYpKSB7Ci0JCWRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSA9IDYyNDAwMDsKIAl9
IGVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpICB7CiAJCS8qCiAJCSAqIEZJWE1FIHdp
dGggZXh0cmEgY29vbGluZyB3ZSBjYW4gYWxsb3cKQEAgLTI4NzgsNyArMjg4MCw3IEBAIHZvaWQg
aW50ZWxfaW5pdF9jZGNsa19ob29rcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
CiAJCWRldl9wcml2LT5kaXNwbGF5Lm1vZGVzZXRfY2FsY19jZGNsayA9IGJ4dF9tb2Rlc2V0X2Nh
bGNfY2RjbGs7CiAJCWRldl9wcml2LT5kaXNwbGF5LmNhbGNfdm9sdGFnZV9sZXZlbCA9IGNubF9j
YWxjX3ZvbHRhZ2VfbGV2ZWw7CiAJCWRldl9wcml2LT5jZGNsay50YWJsZSA9IGNubF9jZGNsa190
YWJsZTsKLQl9IGVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7CisJfSBlbHNlIGlmIChJ
U19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkgewogCQlkZXZf
cHJpdi0+ZGlzcGxheS5id19jYWxjX21pbl9jZGNsayA9IHNrbF9id19jYWxjX21pbl9jZGNsazsK
IAkJZGV2X3ByaXYtPmRpc3BsYXkuc2V0X2NkY2xrID0gYnh0X3NldF9jZGNsazsKIAkJZGV2X3By
aXYtPmRpc3BsYXkubW9kZXNldF9jYWxjX2NkY2xrID0gYnh0X21vZGVzZXRfY2FsY19jZGNsazsK
QEAgLTI4ODcsNyArMjg4OSw3IEBAIHZvaWQgaW50ZWxfaW5pdF9jZGNsa19ob29rcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCQlkZXZfcHJpdi0+Y2RjbGsudGFibGUgPSBn
bGtfY2RjbGtfdGFibGU7CiAJCWVsc2UKIAkJCWRldl9wcml2LT5jZGNsay50YWJsZSA9IGJ4dF9j
ZGNsa190YWJsZTsKLQl9IGVsc2UgaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKSB7CisJfSBlbHNl
IGlmIChJU19ESVNQTEFZX1ZFUihkZXZfcHJpdiwgOSkpIHsKIAkJZGV2X3ByaXYtPmRpc3BsYXku
YndfY2FsY19taW5fY2RjbGsgPSBza2xfYndfY2FsY19taW5fY2RjbGs7CiAJCWRldl9wcml2LT5k
aXNwbGF5LnNldF9jZGNsayA9IHNrbF9zZXRfY2RjbGs7CiAJCWRldl9wcml2LT5kaXNwbGF5Lm1v
ZGVzZXRfY2FsY19jZGNsayA9IHNrbF9tb2Rlc2V0X2NhbGNfY2RjbGs7CkBAIC0yOTA4LDkgKzI5
MTAsOSBAQCB2b2lkIGludGVsX2luaXRfY2RjbGtfaG9va3Moc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQogCQlkZXZfcHJpdi0+ZGlzcGxheS5tb2Rlc2V0X2NhbGNfY2RjbGsgPSBm
aXhlZF9tb2Rlc2V0X2NhbGNfY2RjbGs7CiAJfQogCi0JaWYgKERJU1BMQVlfVkVSKGRldl9wcml2
KSA+PSAxMCB8fCBJU19HRU45X0xQKGRldl9wcml2KSkKKwlpZiAoRElTUExBWV9WRVIoZGV2X3By
aXYpID49IDEwIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKQogCQlkZXZfcHJpdi0+ZGlzcGxheS5n
ZXRfY2RjbGsgPSBieHRfZ2V0X2NkY2xrOwotCWVsc2UgaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYp
KQorCWVsc2UgaWYgKElTX0RJU1BMQVlfVkVSKGRldl9wcml2LCA5KSkKIAkJZGV2X3ByaXYtPmRp
c3BsYXkuZ2V0X2NkY2xrID0gc2tsX2dldF9jZGNsazsKIAllbHNlIGlmIChJU19CUk9BRFdFTEwo
ZGV2X3ByaXYpKQogCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfY2RjbGsgPSBiZHdfZ2V0X2NkY2xr
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jc3IuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY3NyLmMKaW5kZXggNzk0ZWZjYzNj
YTA4Li5lNTQ1MjFkN2I5MzEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfY3NyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9j
c3IuYwpAQCAtMjg0LDcgKzI4NCw3IEBAIHN0YXRpYyB2b2lkIGdlbjlfc2V0X2RjX3N0YXRlX2Rl
YnVnbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAKIAltYXNrID0gRENf
U1RBVEVfREVCVUdfTUFTS19NRU1PUllfVVA7CiAKLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikp
CisJaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKQog
CQltYXNrIHw9IERDX1NUQVRFX0RFQlVHX01BU0tfQ09SRVM7CiAKIAkvKiBUaGUgYmVsb3cgYml0
IGRvZXNuJ3QgbmVlZCB0byBiZSBjbGVhcmVkIGV2ZXIgYWZ0ZXJ3YXJkcyAqLwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMKaW5kZXggOTUzZGU0MmUyNzdjLi5kZWVmMjRk
YTAwYjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRp
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYwpAQCAtMTEz
LDcgKzExMyw4IEBAIHZvaWQgaW50ZWxfcHJlcGFyZV9kcF9kZGlfYnVmZmVycyhzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQkJCQkgICAgICAmbl9lbnRyaWVzKTsKIAogCS8qIElm
IHdlJ3JlIGJvb3N0aW5nIHRoZSBjdXJyZW50LCBzZXQgYml0IDMxIG9mIHRyYW5zMSAqLwotCWlm
IChJU19HRU45X0JDKGRldl9wcml2KSAmJiBpbnRlbF9iaW9zX2VuY29kZXJfZHBfYm9vc3RfbGV2
ZWwoZW5jb2Rlci0+ZGV2ZGF0YSkpCisJaWYgKElTX0RJU1BMQVlfVkVSKGRldl9wcml2LCA5KSAm
JiAhSVNfQlJPWFRPTihkZXZfcHJpdikgJiYKKwkgICAgaW50ZWxfYmlvc19lbmNvZGVyX2RwX2Jv
b3N0X2xldmVsKGVuY29kZXItPmRldmRhdGEpKQogCQlpYm9vc3RfYml0ID0gRERJX0JVRl9CQUxB
TkNFX0xFR19FTkFCTEU7CiAKIAlmb3IgKGkgPSAwOyBpIDwgbl9lbnRyaWVzOyBpKyspIHsKQEAg
LTE0Niw3ICsxNDcsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wcmVwYXJlX2hkbWlfZGRpX2J1ZmZl
cnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCWxldmVsID0gbl9lbnRyaWVzIC0g
MTsKIAogCS8qIElmIHdlJ3JlIGJvb3N0aW5nIHRoZSBjdXJyZW50LCBzZXQgYml0IDMxIG9mIHRy
YW5zMSAqLwotCWlmIChJU19HRU45X0JDKGRldl9wcml2KSAmJiBpbnRlbF9iaW9zX2VuY29kZXJf
aGRtaV9ib29zdF9sZXZlbChlbmNvZGVyLT5kZXZkYXRhKSkKKwlpZiAoSVNfRElTUExBWV9WRVIo
ZGV2X3ByaXYsIDkpICYmICFJU19CUk9YVE9OKGRldl9wcml2KSAmJgorCSAgICBpbnRlbF9iaW9z
X2VuY29kZXJfaGRtaV9ib29zdF9sZXZlbChlbmNvZGVyLT5kZXZkYXRhKSkKIAkJaWJvb3N0X2Jp
dCA9IERESV9CVUZfQkFMQU5DRV9MRUdfRU5BQkxFOwogCiAJLyogRW50cnkgOSBpcyBmb3IgSERN
STogKi8KQEAgLTc1OSw3ICs3NjEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfZ2V0X2VuY29k
ZXJfcGlwZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCSppc19kcF9tc3QgPSBt
c3RfcGlwZV9tYXNrOwogCiBvdXQ6Ci0JaWYgKCpwaXBlX21hc2sgJiYgSVNfR0VOOV9MUChkZXZf
cHJpdikpIHsKKwlpZiAoKnBpcGVfbWFzayAmJiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwg
SVNfQlJPWFRPTihkZXZfcHJpdikpKSB7CiAJCXRtcCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYs
IEJYVF9QSFlfQ1RMKHBvcnQpKTsKIAkJaWYgKCh0bXAgJiAoQlhUX1BIWV9DTU5MQU5FX1BPV0VS
RE9XTl9BQ0sgfAogCQkJICAgIEJYVF9QSFlfTEFORV9QT1dFUkRPV05fQUNLIHwKQEAgLTk4Nyw3
ICs5ODksNyBAQCBzdGF0aWMgdTggaW50ZWxfZGRpX2RwX3ZvbHRhZ2VfbWF4KHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHAsCiAJCQlpY2xfZ2V0X21nX2J1Zl90cmFucyhlbmNvZGVyLCBjcnRjX3N0
YXRlLCAmbl9lbnRyaWVzKTsKIAl9IGVsc2UgaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKSB7
CiAJCWNubF9nZXRfYnVmX3RyYW5zKGVuY29kZXIsIGNydGNfc3RhdGUsICZuX2VudHJpZXMpOwot
CX0gZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKKwl9IGVsc2UgaWYgKElTX0dFTUlO
SUxBS0UoZGV2X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKSB7CiAJCWJ4dF9nZXRfYnVm
X3RyYW5zKGVuY29kZXIsIGNydGNfc3RhdGUsICZuX2VudHJpZXMpOwogCX0gZWxzZSB7CiAJCWlm
IChpbnRlbF9jcnRjX2hhc190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9FRFApKQpAQCAt
MTU1NSw3ICsxNTU3LDcgQEAgaHN3X3NldF9zaWduYWxfbGV2ZWxzKHN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHAsCiAJaW50ZWxfZHAtPkRQICY9IH5ERElfQlVGX0VNUF9NQVNLOwogCWludGVsX2Rw
LT5EUCB8PSBzaWduYWxfbGV2ZWxzOwogCi0JaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKQorCWlm
IChJU19ESVNQTEFZX1ZFUihkZXZfcHJpdiwgOSkgJiYgIUlTX0JST1hUT04oZGV2X3ByaXYpKQog
CQlza2xfZGRpX3NldF9pYm9vc3QoZW5jb2RlciwgY3J0Y19zdGF0ZSwgbGV2ZWwpOwogCiAJaW50
ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERESV9CVUZfQ1RMKHBvcnQpLCBpbnRlbF9kcC0+RFApOwpA
QCAtMjY0OCw3ICsyNjUwLDcgQEAgc3RhdGljIHZvaWQgaHN3X2RkaV9wcmVfZW5hYmxlX2RwKHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAogCQlpY2xfZGRpX3Zzd2luZ19zZXF1ZW5j
ZShlbmNvZGVyLCBjcnRjX3N0YXRlLCBsZXZlbCk7CiAJZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShk
ZXZfcHJpdikpCiAJCWNubF9kZGlfdnN3aW5nX3NlcXVlbmNlKGVuY29kZXIsIGNydGNfc3RhdGUs
IGxldmVsKTsKLQllbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkKKwllbHNlIGlmIChJU19H
RU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkKIAkJYnh0X2RkaV92
c3dpbmdfc2VxdWVuY2UoZW5jb2RlciwgY3J0Y19zdGF0ZSwgbGV2ZWwpOwogCWVsc2UKIAkJaW50
ZWxfcHJlcGFyZV9kcF9kZGlfYnVmZmVycyhlbmNvZGVyLCBjcnRjX3N0YXRlKTsKQEAgLTMwOTYs
MTYgKzMwOTgsMTYgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2RkaV9oZG1pKHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAogCQlpY2xfZGRpX3Zzd2luZ19zZXF1ZW5jZShlbmNv
ZGVyLCBjcnRjX3N0YXRlLCBsZXZlbCk7CiAJZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJp
dikpCiAJCWNubF9kZGlfdnN3aW5nX3NlcXVlbmNlKGVuY29kZXIsIGNydGNfc3RhdGUsIGxldmVs
KTsKLQllbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkKKwllbHNlIGlmIChJU19HRU1JTklM
QUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkKIAkJYnh0X2RkaV92c3dpbmdf
c2VxdWVuY2UoZW5jb2RlciwgY3J0Y19zdGF0ZSwgbGV2ZWwpOwogCWVsc2UKIAkJaW50ZWxfcHJl
cGFyZV9oZG1pX2RkaV9idWZmZXJzKGVuY29kZXIsIGxldmVsKTsKIAotCWlmIChJU19HRU45X0JD
KGRldl9wcml2KSkKKwlpZiAoSVNfRElTUExBWV9WRVIoZGV2X3ByaXYsIDkpICYmICFJU19CUk9Y
VE9OKGRldl9wcml2KSkKIAkJc2tsX2RkaV9zZXRfaWJvb3N0KGVuY29kZXIsIGNydGNfc3RhdGUs
IGxldmVsKTsKIAogCS8qIERpc3BsYXkgV0EgIzExNDM6IHNrbCxrYmwsY2ZsICovCi0JaWYgKElT
X0dFTjlfQkMoZGV2X3ByaXYpKSB7CisJaWYgKElTX0RJU1BMQVlfVkVSKGRldl9wcml2LCA5KSAm
JiAhSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKIAkJLyoKIAkJICogRm9yIHNvbWUgcmVhc29uIHRo
ZXNlIGNoaWNrZW4gYml0cyBoYXZlIGJlZW4KIAkJICogc3R1ZmZlZCBpbnRvIGEgdHJhbnNjb2Rl
ciByZWdpc3RlciwgZXZlbnQgdGhvdWdoCkBAIC0zMzIxLDcgKzMzMjMsNyBAQCBpbnRlbF9kZGlf
cHJlX3BsbF9lbmFibGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJCSAqIFR5
cGUtQyBwb3J0cy4gIFNraXAgdGhpcyBzdGVwIGZvciBUQlQuCiAJCSAqLwogCQlpbnRlbF90Y19w
b3J0X3NldF9maWFfbGFuZV9jb3VudChkaWdfcG9ydCwgY3J0Y19zdGF0ZS0+bGFuZV9jb3VudCk7
Ci0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCisJZWxzZSBpZiAoSVNfR0VNSU5JTEFL
RShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikpCiAJCWJ4dF9kZGlfcGh5X3NldF9s
YW5lX29wdGltX21hc2soZW5jb2RlciwKIAkJCQkJCWNydGNfc3RhdGUtPmxhbmVfbGF0X29wdGlt
X21hc2spOwogfQpAQCAtMzY3OSw3ICszNjgxLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX2dl
dF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJaWYgKCFwaXBlX2NvbmZp
Zy0+Ymlnam9pbmVyX3NsYXZlKQogCQlkZGlfZG90Y2xvY2tfZ2V0KHBpcGVfY29uZmlnKTsKIAot
CWlmIChJU19HRU45X0xQKGRldl9wcml2KSkKKwlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikg
fHwgSVNfQlJPWFRPTihkZXZfcHJpdikpCiAJCXBpcGVfY29uZmlnLT5sYW5lX2xhdF9vcHRpbV9t
YXNrID0KIAkJCWJ4dF9kZGlfcGh5X2dldF9sYW5lX2xhdF9vcHRpbV9tYXNrKGVuY29kZXIpOwog
CkBAIC0zODg1LDcgKzM4ODcsNyBAQCBzdGF0aWMgaW50IGludGVsX2RkaV9jb21wdXRlX2NvbmZp
ZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCXBpcGVfY29uZmlnLT5wY2hfcGZp
dC5lbmFibGVkIHx8CiAJCQlwaXBlX2NvbmZpZy0+Y3JjX2VuYWJsZWQ7CiAKLQlpZiAoSVNfR0VO
OV9MUChkZXZfcHJpdikpCisJaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElTX0JST1hU
T04oZGV2X3ByaXYpKQogCQlwaXBlX2NvbmZpZy0+bGFuZV9sYXRfb3B0aW1fbWFzayA9CiAJCQli
eHRfZGRpX3BoeV9jYWxjX2xhbmVfbGF0X29wdGltX21hc2socGlwZV9jb25maWctPmxhbmVfY291
bnQpOwogCkBAIC00MDUzLDcgKzQwNTUsNyBAQCBpbnRlbF9kZGlfaW5pdF9kcF9jb25uZWN0b3Io
c3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpCiAJCWRpZ19wb3J0LT5kcC5zZXRf
c2lnbmFsX2xldmVscyA9IGljbF9zZXRfc2lnbmFsX2xldmVsczsKIAllbHNlIGlmIChJU19DQU5O
T05MQUtFKGRldl9wcml2KSkKIAkJZGlnX3BvcnQtPmRwLnNldF9zaWduYWxfbGV2ZWxzID0gY25s
X3NldF9zaWduYWxfbGV2ZWxzOwotCWVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQorCWVs
c2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKQog
CQlkaWdfcG9ydC0+ZHAuc2V0X3NpZ25hbF9sZXZlbHMgPSBieHRfc2V0X3NpZ25hbF9sZXZlbHM7
CiAJZWxzZQogCQlkaWdfcG9ydC0+ZHAuc2V0X3NpZ25hbF9sZXZlbHMgPSBoc3dfc2V0X3NpZ25h
bF9sZXZlbHM7CkBAIC00Mjk2LDcgKzQyOTgsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9kZGlfYV9m
b3JjZV80X2xhbmVzKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQogCS8qIEJy
b3h0b24vR2VtaW5pbGFrZTogQnNwZWMgc2F5cyB0aGF0IERESV9BXzRfTEFORVMgaXMgdGhlIG9u
bHkKIAkgKiAgICAgICAgICAgICAgICAgICAgIHN1cHBvcnRlZCBjb25maWd1cmF0aW9uCiAJICov
Ci0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQorCWlmIChJU19HRU1JTklMQUtFKGRldl9wcml2
KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkKIAkJcmV0dXJuIHRydWU7CiAKIAkvKiBDYW5ub25s
YWtlOiBNb3N0IG9mIFNLVXMgZG9uJ3Qgc3VwcG9ydCBERElfRSwgYW5kIHRoZSBvbmx5CkBAIC00
NTg1LDEwICs0NTg3LDEwIEBAIHZvaWQgaW50ZWxfZGRpX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCkKIAkJZW5jb2Rlci0+ZGlzYWJsZV9jbG9j
ayA9IGNubF9kZGlfZGlzYWJsZV9jbG9jazsKIAkJZW5jb2Rlci0+aXNfY2xvY2tfZW5hYmxlZCA9
IGNubF9kZGlfaXNfY2xvY2tfZW5hYmxlZDsKIAkJZW5jb2Rlci0+Z2V0X2NvbmZpZyA9IGNubF9k
ZGlfZ2V0X2NvbmZpZzsKLQl9IGVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7CisJfSBl
bHNlIGlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkg
ewogCQkvKiBCWFQvR0xLIGhhdmUgZml4ZWQgUExMLT5wb3J0IG1hcHBpbmcgKi8KIAkJZW5jb2Rl
ci0+Z2V0X2NvbmZpZyA9IGJ4dF9kZGlfZ2V0X2NvbmZpZzsKLQl9IGVsc2UgaWYgKElTX0dFTjlf
QkMoZGV2X3ByaXYpKSB7CisJfSBlbHNlIGlmIChJU19ESVNQTEFZX1ZFUihkZXZfcHJpdiwgOSkp
IHsKIAkJZW5jb2Rlci0+ZW5hYmxlX2Nsb2NrID0gc2tsX2RkaV9lbmFibGVfY2xvY2s7CiAJCWVu
Y29kZXItPmRpc2FibGVfY2xvY2sgPSBza2xfZGRpX2Rpc2FibGVfY2xvY2s7CiAJCWVuY29kZXIt
PmlzX2Nsb2NrX2VuYWJsZWQgPSBza2xfZGRpX2lzX2Nsb2NrX2VuYWJsZWQ7CkBAIC00NjcyLDcg
KzQ2NzQsOCBAQCB2b2lkIGludGVsX2RkaV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgZW51bSBwb3J0IHBvcnQpCiAJCWVsc2UKIAkJCWRpZ19wb3J0LT5jb25uZWN0ZWQg
PSBscHRfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZDsKIAl9IGVsc2UgaWYgKERJU1BMQVlfVkVSKGRl
dl9wcml2KSA+PSA4KSB7Ci0JCWlmIChwb3J0ID09IFBPUlRfQSB8fCBJU19HRU45X0xQKGRldl9w
cml2KSkKKwkJaWYgKHBvcnQgPT0gUE9SVF9BIHx8IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8
CisJCSAgICBJU19CUk9YVE9OKGRldl9wcml2KSkKIAkJCWRpZ19wb3J0LT5jb25uZWN0ZWQgPSBi
ZHdfZGlnaXRhbF9wb3J0X2Nvbm5lY3RlZDsKIAkJZWxzZQogCQkJZGlnX3BvcnQtPmNvbm5lY3Rl
ZCA9IGxwdF9kaWdpdGFsX3BvcnRfY29ubmVjdGVkOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGlfYnVmX3RyYW5zLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2RkaV9idWZfdHJhbnMuYwppbmRleCA1ZDljZTYwNDJlODcuLmZk
ZDI1ODYxZWRkNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kZGlfYnVmX3RyYW5zLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kZGlfYnVmX3RyYW5zLmMKQEAgLTg4MSw3ICs4ODEsNyBAQCBpbnRlbF9kZGlfZ2V0X2J1Zl90
cmFuc19lZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIGludCAqbl9lbnRyaWVzKQog
ewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwogCi0JaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKSB7CisJaWYgKElTX0RJU1BM
QVlfVkVSKGRldl9wcml2LCA5KSAmJiAhSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKIAkJY29uc3Qg
c3RydWN0IGRkaV9idWZfdHJhbnMgKmRkaV90cmFuc2xhdGlvbnMgPQogCQkJc2tsX2dldF9idWZf
dHJhbnNfZWRwKGVuY29kZXIsIG5fZW50cmllcyk7CiAJCSpuX2VudHJpZXMgPSBza2xfYnVmX3Ry
YW5zX251bV9lbnRyaWVzKGVuY29kZXItPnBvcnQsICpuX2VudHJpZXMpOwpAQCAtOTE5LDcgKzkx
OSw3IEBAIGludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7CiAKLQlpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikpIHsKKwlp
ZiAoSVNfRElTUExBWV9WRVIoZGV2X3ByaXYsIDkpICYmICFJU19CUk9YVE9OKGRldl9wcml2KSkg
ewogCQlyZXR1cm4gc2tsX2dldF9idWZfdHJhbnNfaGRtaShkZXZfcHJpdiwgbl9lbnRyaWVzKTsK
IAl9IGVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsKIAkJKm5fZW50cmllcyA9IEFS
UkFZX1NJWkUoYmR3X2RkaV90cmFuc2xhdGlvbnNfaGRtaSk7CkBAIC0xMzcwLDEwICsxMzcwLDEw
IEBAIGludCBpbnRlbF9kZGlfaGRtaV9udW1fZW50cmllcyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKIAl9IGVsc2UgaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKSB7CiAJCWNubF9n
ZXRfYnVmX3RyYW5zX2hkbWkoZW5jb2RlciwgJm5fZW50cmllcyk7CiAJCSpkZWZhdWx0X2VudHJ5
ID0gbl9lbnRyaWVzIC0gMTsKLQl9IGVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7CisJ
fSBlbHNlIGlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2
KSkgewogCQlieHRfZ2V0X2J1Zl90cmFuc19oZG1pKGVuY29kZXIsICZuX2VudHJpZXMpOwogCQkq
ZGVmYXVsdF9lbnRyeSA9IG5fZW50cmllcyAtIDE7Ci0JfSBlbHNlIGlmIChJU19HRU45X0JDKGRl
dl9wcml2KSkgeworCX0gZWxzZSBpZiAoSVNfRElTUExBWV9WRVIoZGV2X3ByaXYsIDkpKSB7CiAJ
CWludGVsX2RkaV9nZXRfYnVmX3RyYW5zX2hkbWkoZW5jb2RlciwgJm5fZW50cmllcyk7CiAJCSpk
ZWZhdWx0X2VudHJ5ID0gODsKIAl9IGVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpIHsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKaW5kZXggZDc0
YjI2M2M1ZjRlLi40ZjhmOTk0YTYzOWYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGlzcGxheS5jCkBAIC01OTUxLDcgKzU5NTEsNyBAQCBzdGF0aWMgYm9vbCBoc3df
Z2V0X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAogCiAJYWN0aXZlID0gaHN3
X2dldF90cmFuc2NvZGVyX3N0YXRlKGNydGMsIHBpcGVfY29uZmlnLCAmcG93ZXJfZG9tYWluX3Nl
dCk7CiAKLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikgJiYKKwlpZiAoKElTX0dFTUlOSUxBS0Uo
ZGV2X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKSAmJgogCSAgICBieHRfZ2V0X2RzaV90
cmFuc2NvZGVyX3N0YXRlKGNydGMsIHBpcGVfY29uZmlnLCAmcG93ZXJfZG9tYWluX3NldCkpIHsK
IAkJZHJtX1dBUk5fT04oJmRldl9wcml2LT5kcm0sIGFjdGl2ZSk7CiAJCWFjdGl2ZSA9IHRydWU7
CkBAIC02ODY5LDcgKzY4NjksOCBAQCBzdGF0aWMgdTE2IHNrbF9saW5ldGltZV93bShjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIAkJCQkgICBjcnRjX3N0YXRlLT5w
aXhlbF9yYXRlKTsKIAogCS8qIERpc3BsYXkgV0EgIzExMzU6IEJYVDpBTEwgR0xLOkFMTCAqLwot
CWlmIChJU19HRU45X0xQKGRldl9wcml2KSAmJiBkZXZfcHJpdi0+aXBjX2VuYWJsZWQpCisJaWYg
KChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkgJiYKKwkg
ICAgZGV2X3ByaXYtPmlwY19lbmFibGVkKQogCQlsaW5ldGltZV93bSAvPSAyOwogCiAJcmV0dXJu
IG1pbihsaW5ldGltZV93bSwgMHgxZmYpOwpAQCAtMTA4NzEsNyArMTA4NzIsNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9zZXR1cF9vdXRwdXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKIAkJCWludGVsX2RkaV9pbml0KGRldl9wcml2LCBQT1JUX0YpOwogCiAJCWljbF9kc2lfaW5p
dChkZXZfcHJpdik7Ci0JfSBlbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkgeworCX0gZWxz
ZSBpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikpIHsK
IAkJLyoKIAkJICogRklYTUU6IEJyb3h0b24gZG9lc24ndCBzdXBwb3J0IHBvcnQgZGV0ZWN0aW9u
IHZpYSB0aGUKIAkJICogRERJX0JVRl9DVExfQSBvciBTRlVTRV9TVFJBUCByZWdpc3RlcnMsIGZp
bmQgYW5vdGhlciB3YXkgdG8KQEAgLTEwODk2LDcgKzEwODk3LDcgQEAgc3RhdGljIHZvaWQgaW50
ZWxfc2V0dXBfb3V0cHV0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCSAq
LwogCQlmb3VuZCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIERESV9CVUZfQ1RMKFBPUlRfQSkp
ICYgRERJX0lOSVRfRElTUExBWV9ERVRFQ1RFRDsKIAkJLyogV2FJZ25vcmVERElBU3RyYXA6IHNr
bCAqLwotCQlpZiAoZm91bmQgfHwgSVNfR0VOOV9CQyhkZXZfcHJpdikpCisJCWlmIChmb3VuZCB8
fCBJU19ESVNQTEFZX1ZFUihkZXZfcHJpdiwgOSkpCiAJCQlpbnRlbF9kZGlfaW5pdChkZXZfcHJp
diwgUE9SVF9BKTsKIAogCQkvKiBEREkgQiwgQywgRCwgYW5kIEYgZGV0ZWN0aW9uIGlzIGluZGlj
YXRlZCBieSB0aGUgU0ZVU0VfU1RSQVAKQEAgLTEwOTIxLDcgKzEwOTIyLDcgQEAgc3RhdGljIHZv
aWQgaW50ZWxfc2V0dXBfb3V0cHV0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
CiAJCS8qCiAJCSAqIE9uIFNLTCB3ZSBkb24ndCBoYXZlIGEgd2F5IHRvIGRldGVjdCBEREktRSBz
byB3ZSByZWx5IG9uIFZCVC4KIAkJICovCi0JCWlmIChJU19HRU45X0JDKGRldl9wcml2KSAmJgor
CQlpZiAoSVNfRElTUExBWV9WRVIoZGV2X3ByaXYsIDkpICYmCiAJCSAgICBpbnRlbF9iaW9zX2lz
X3BvcnRfcHJlc2VudChkZXZfcHJpdiwgUE9SVF9FKSkKIAkJCWludGVsX2RkaV9pbml0KGRldl9w
cml2LCBQT1JUX0UpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXlfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5X2RlYnVnZnMuYwppbmRleCA1NjQ1MDlhNGU2NjYuLjE4M2M0MTRkNTU0YSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X2Rl
YnVnZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlf
ZGVidWdmcy5jCkBAIC01NjksNyArNTY5LDcgQEAgc3RhdGljIGludCBpOTE1X2RtY19pbmZvKHN0
cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCX0gZWxzZSB7CiAJCWRjNV9yZWcgPSBJ
U19CUk9YVE9OKGRldl9wcml2KSA/IEJYVF9DU1JfREMzX0RDNV9DT1VOVCA6CiAJCQkJCQkgU0tM
X0NTUl9EQzNfREM1X0NPVU5UOwotCQlpZiAoIUlTX0dFTjlfTFAoZGV2X3ByaXYpKQorCQlpZiAo
IUlTX0dFTUlOSUxBS0UoZGV2X3ByaXYpICYmICFJU19CUk9YVE9OKGRldl9wcml2KSkKIAkJCWRj
Nl9yZWcgPSBTS0xfQ1NSX0RDNV9EQzZfQ09VTlQ7CiAJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfcG93ZXIuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9wb3dlci5jCmluZGV4IDk5MTI2Y2FmNTc0
Ny4uOTQxOWFlOGM2MTExIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXlfcG93ZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXlfcG93ZXIuYwpAQCAtNzA5LDcgKzcwOSw3IEBAIHN0YXRpYyBib29sIGhz
d19wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAog
CSAqIEJJT1MncyBvd24gcmVxdWVzdCBiaXRzLCB3aGljaCBhcmUgZm9yY2VkLW9uIGZvciB0aGVz
ZSBwb3dlciB3ZWxscwogCSAqIHdoZW4gZXhpdGluZyBEQzUvNi4KIAkgKi8KLQlpZiAoSVNfRElT
UExBWV9WRVIoZGV2X3ByaXYsIDkpICYmICFJU19HRU45X0xQKGRldl9wcml2KSAmJgorCWlmIChJ
U19ESVNQTEFZX1ZFUihkZXZfcHJpdiwgOSkgJiYgIUlTX0JST1hUT04oZGV2X3ByaXYpICYmCiAJ
ICAgIChpZCA9PSBTS0xfRElTUF9QV18xIHx8IGlkID09IFNLTF9ESVNQX1BXX01JU0NfSU8pKQog
CQl2YWwgfD0gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwgcmVncy0+Ymlvcyk7CiAKQEAgLTgwOSw3
ICs4MDksNyBAQCBzdGF0aWMgdTMyIGdlbjlfZGNfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCiAJCQkJCSAgfCBEQ19TVEFURV9FTl9EQzk7CiAJZWxzZSBpZiAoSVNfRElT
UExBWV9WRVIoZGV2X3ByaXYsIDExKSkKIAkJbWFzayB8PSBEQ19TVEFURV9FTl9VUFRPX0RDNiB8
IERDX1NUQVRFX0VOX0RDOTsKLQllbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkKKwllbHNl
IGlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkKIAkJ
bWFzayB8PSBEQ19TVEFURV9FTl9EQzk7CiAJZWxzZQogCQltYXNrIHw9IERDX1NUQVRFX0VOX1VQ
VE9fREM2OwpAQCAtMTA2MCw3ICsxMDYwLDcgQEAgc3RhdGljIHZvaWQgZ2VuOV9lbmFibGVfZGM1
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlkcm1fZGJnX2ttcygmZGV2X3By
aXYtPmRybSwgIkVuYWJsaW5nIERDNVxuIik7CiAKIAkvKiBXYSBEaXNwbGF5ICMxMTgzOiBza2ws
a2JsLGNmbCAqLwotCWlmIChJU19HRU45X0JDKGRldl9wcml2KSkKKwlpZiAoSVNfRElTUExBWV9W
RVIoZGV2X3ByaXYsIDkpICYmICFJU19CUk9YVE9OKGRldl9wcml2KSkKIAkJaW50ZWxfZGVfd3Jp
dGUoZGV2X3ByaXYsIEdFTjhfQ0hJQ0tFTl9EQ1BSXzEsCiAJCQkgICAgICAgaW50ZWxfZGVfcmVh
ZChkZXZfcHJpdiwgR0VOOF9DSElDS0VOX0RDUFJfMSkgfCBTS0xfU0VMRUNUX0FMVEVSTkFURV9E
Q19FWElUKTsKIApAQCAtMTA4Nyw3ICsxMDg3LDcgQEAgc3RhdGljIHZvaWQgc2tsX2VuYWJsZV9k
YzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWRybV9kYmdfa21zKCZkZXZf
cHJpdi0+ZHJtLCAiRW5hYmxpbmcgREM2XG4iKTsKIAogCS8qIFdhIERpc3BsYXkgIzExODM6IHNr
bCxrYmwsY2ZsICovCi0JaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKQorCWlmIChJU19ESVNQTEFZ
X1ZFUihkZXZfcHJpdiwgOSkgJiYgIUlTX0JST1hUT04oZGV2X3ByaXYpKQogCQlpbnRlbF9kZV93
cml0ZShkZXZfcHJpdiwgR0VOOF9DSElDS0VOX0RDUFJfMSwKIAkJCSAgICAgICBpbnRlbF9kZV9y
ZWFkKGRldl9wcml2LCBHRU44X0NISUNLRU5fRENQUl8xKSB8IFNLTF9TRUxFQ1RfQUxURVJOQVRF
X0RDX0VYSVQpOwogCkBAIC0xMTg5LDcgKzExODksNyBAQCBzdGF0aWMgdm9pZCBnZW45X2Rpc2Fi
bGVfZGNfc3RhdGVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogCWdlbjlf
YXNzZXJ0X2RidWZfZW5hYmxlZChkZXZfcHJpdik7CiAKLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJp
dikpCisJaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYp
KQogCQlieHRfdmVyaWZ5X2RkaV9waHlfcG93ZXJfd2VsbHMoZGV2X3ByaXYpOwogCiAJaWYgKERJ
U1BMQVlfVkVSKGRldl9wcml2KSA+PSAxMSkKQEAgLTQ1MzcsMTAgKzQ1MzcsMTAgQEAgc3RhdGlj
IHUzMiBnZXRfYWxsb3dlZF9kY19tYXNrKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKIAkJbWF4X2RjID0gMzsKIAllbHNlIGlmIChESVNQTEFZX1ZFUihkZXZfcHJpdikg
Pj0gMTIpCiAJCW1heF9kYyA9IDQ7Ci0JZWxzZSBpZiAoRElTUExBWV9WRVIoZGV2X3ByaXYpID49
IDExIHx8IElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpIHx8IElTX0dFTjlfQkMoZGV2X3ByaXYpKQot
CQltYXhfZGMgPSAyOwotCWVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQorCWVsc2UgaWYg
KElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKQogCQltYXhf
ZGMgPSAxOworCWVsc2UgaWYgKERJU1BMQVlfVkVSKGRldl9wcml2KSA+PSA5KQorCQltYXhfZGMg
PSAyOwogCWVsc2UKIAkJbWF4X2RjID0gMDsKIApAQCAtNDU0OSw3ICs0NTQ5LDggQEAgc3RhdGlj
IHUzMiBnZXRfYWxsb3dlZF9kY19tYXNrKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKIAkgKiBub3QgZGVwZW5kaW5nIG9uIHRoZSBETUMgZmlybXdhcmUuIEl0J3MgbmVl
ZGVkIGJ5IHN5c3RlbQogCSAqIHN1c3BlbmQvcmVzdW1lLCBzbyBhbGxvdyBpdCB1bmNvbmRpdGlv
bmFsbHkuCiAJICovCi0JbWFzayA9IElTX0dFTjlfTFAoZGV2X3ByaXYpIHx8IERJU1BMQVlfVkVS
KGRldl9wcml2KSA+PSAxMSA/CisJbWFzayA9IElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElT
X0JST1hUT04oZGV2X3ByaXYpIHx8CisJCURJU1BMQVlfVkVSKGRldl9wcml2KSA+PSAxMSA/CiAJ
ICAgICAgIERDX1NUQVRFX0VOX0RDOSA6IDA7CiAKIAlpZiAoIWRldl9wcml2LT5wYXJhbXMuZGlz
YWJsZV9wb3dlcl93ZWxsKQpAQCAtNDY5Miw3ICs0NjkzLDcgQEAgaW50IGludGVsX3Bvd2VyX2Rv
bWFpbnNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCWVyciA9IHNl
dF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBnbGtfcG93ZXJfd2VsbHMpOwogCX0gZWxzZSBp
ZiAoSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKIAkJZXJyID0gc2V0X3Bvd2VyX3dlbGxzKHBvd2Vy
X2RvbWFpbnMsIGJ4dF9wb3dlcl93ZWxscyk7Ci0JfSBlbHNlIGlmIChJU19HRU45X0JDKGRldl9w
cml2KSkgeworCX0gZWxzZSBpZiAoSVNfRElTUExBWV9WRVIoZGV2X3ByaXYsIDkpKSB7CiAJCWVy
ciA9IHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBza2xfcG93ZXJfd2VsbHMpOwogCX0g
ZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKIAkJZXJyID0gc2V0X3Bvd2VyX3dl
bGxzKHBvd2VyX2RvbWFpbnMsIGNodl9wb3dlcl93ZWxscyk7CkBAIC01NjIzLDEwICs1NjI0LDEw
IEBAIHZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LCBib29sIHJlc3VtZSkKIAkJaWNsX2Rpc3BsYXlfY29yZV9pbml0KGk5MTUsIHJl
c3VtZSk7CiAJfSBlbHNlIGlmIChJU19DQU5OT05MQUtFKGk5MTUpKSB7CiAJCWNubF9kaXNwbGF5
X2NvcmVfaW5pdChpOTE1LCByZXN1bWUpOwotCX0gZWxzZSBpZiAoSVNfR0VOOV9CQyhpOTE1KSkg
ewotCQlza2xfZGlzcGxheV9jb3JlX2luaXQoaTkxNSwgcmVzdW1lKTsKLQl9IGVsc2UgaWYgKElT
X0dFTjlfTFAoaTkxNSkpIHsKKwl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkgfHwgSVNf
QlJPWFRPTihpOTE1KSkgewogCQlieHRfZGlzcGxheV9jb3JlX2luaXQoaTkxNSwgcmVzdW1lKTsK
Kwl9IGVsc2UgaWYgKElTX0RJU1BMQVlfVkVSKGk5MTUsIDkpKSB7CisJCXNrbF9kaXNwbGF5X2Nv
cmVfaW5pdChpOTE1LCByZXN1bWUpOwogCX0gZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkg
ewogCQltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKIAkJY2h2X3BoeV9jb250cm9s
X2luaXQoaTkxNSk7CkBAIC01Nzg0LDEwICs1Nzg1LDEwIEBAIHZvaWQgaW50ZWxfcG93ZXJfZG9t
YWluc19zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQlpY2xfZGlzcGxh
eV9jb3JlX3VuaW5pdChpOTE1KTsKIAllbHNlIGlmIChJU19DQU5OT05MQUtFKGk5MTUpKQogCQlj
bmxfZGlzcGxheV9jb3JlX3VuaW5pdChpOTE1KTsKLQllbHNlIGlmIChJU19HRU45X0JDKGk5MTUp
KQotCQlza2xfZGlzcGxheV9jb3JlX3VuaW5pdChpOTE1KTsKLQllbHNlIGlmIChJU19HRU45X0xQ
KGk5MTUpKQorCWVsc2UgaWYgKElTX0dFTUlOSUxBS0UoaTkxNSkgfHwgSVNfQlJPWFRPTihpOTE1
KSkKIAkJYnh0X2Rpc3BsYXlfY29yZV91bmluaXQoaTkxNSk7CisJZWxzZSBpZiAoSVNfRElTUExB
WV9WRVIoaTkxNSwgOSkpCisJCXNrbF9kaXNwbGF5X2NvcmVfdW5pbml0KGk5MTUpOwogCiAJcG93
ZXJfZG9tYWlucy0+ZGlzcGxheV9jb3JlX3N1c3BlbmRlZCA9IHRydWU7CiB9CkBAIC01OTA4LDcg
KzU5MDksOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX3ZlcmlmeV9zdGF0ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAogdm9pZCBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X3N1c3BlbmRfbGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKLQlpZiAoRElT
UExBWV9WRVIoaTkxNSkgPj0gMTEgfHwgSVNfR0VOOV9MUChpOTE1KSkgeworCWlmIChESVNQTEFZ
X1ZFUihpOTE1KSA+PSAxMSB8fCBJU19HRU1JTklMQUtFKGk5MTUpIHx8CisJICAgIElTX0JST1hU
T04oaTkxNSkpIHsKIAkJYnh0X2VuYWJsZV9kYzkoaTkxNSk7CiAJCS8qIFR3ZWFrZWQgV2FfMTQw
MTA2ODUzMzI6aWNwLGpzcCxtY2MgKi8KIAkJaWYgKElOVEVMX1BDSF9UWVBFKGk5MTUpID49IFBD
SF9JQ1AgJiYgSU5URUxfUENIX1RZUEUoaTkxNSkgPD0gUENIX01DQykKQEAgLTU5MjEsNyArNTky
Myw4IEBAIHZvaWQgaW50ZWxfZGlzcGxheV9wb3dlcl9zdXNwZW5kX2xhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCiAKIHZvaWQgaW50ZWxfZGlzcGxheV9wb3dlcl9yZXN1bWVfZWFy
bHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7Ci0JaWYgKERJU1BMQVlfVkVSKGk5
MTUpID49IDExIHx8IElTX0dFTjlfTFAoaTkxNSkpIHsKKwlpZiAoRElTUExBWV9WRVIoaTkxNSkg
Pj0gMTEgfHwgSVNfR0VNSU5JTEFLRShpOTE1KSB8fAorCSAgICBJU19CUk9YVE9OKGk5MTUpKSB7
CiAJCWdlbjlfc2FuaXRpemVfZGNfc3RhdGUoaTkxNSk7CiAJCWJ4dF9kaXNhYmxlX2RjOShpOTE1
KTsKIAkJLyogVHdlYWtlZCBXYV8xNDAxMDY4NTMzMjppY3AsanNwLG1jYyAqLwpAQCAtNTkzOCw3
ICs1OTQxLDcgQEAgdm9pZCBpbnRlbF9kaXNwbGF5X3Bvd2VyX3N1c3BlbmQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCiAJaWYgKERJU1BMQVlfVkVSKGk5MTUpID49IDExKSB7CiAJCWlj
bF9kaXNwbGF5X2NvcmVfdW5pbml0KGk5MTUpOwogCQlieHRfZW5hYmxlX2RjOShpOTE1KTsKLQl9
IGVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKKwl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0Uo
aTkxNSkgfHwgSVNfQlJPWFRPTihpOTE1KSkgewogCQlieHRfZGlzcGxheV9jb3JlX3VuaW5pdChp
OTE1KTsKIAkJYnh0X2VuYWJsZV9kYzkoaTkxNSk7CiAJfSBlbHNlIGlmIChJU19IQVNXRUxMKGk5
MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkgewpAQCAtNTk1OSw3ICs1OTYyLDcgQEAgdm9pZCBp
bnRlbF9kaXNwbGF5X3Bvd2VyX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
IAkJCQkgRENfU1RBVEVfRU5fVVBUT19EQzUpCiAJCQkJZ2VuOV9lbmFibGVfZGM1KGk5MTUpOwog
CQl9Ci0JfSBlbHNlIGlmIChJU19HRU45X0xQKGk5MTUpKSB7CisJfSBlbHNlIGlmIChJU19HRU1J
TklMQUtFKGk5MTUpIHx8IElTX0JST1hUT04oaTkxNSkpIHsKIAkJYnh0X2Rpc2FibGVfZGM5KGk5
MTUpOwogCQlieHRfZGlzcGxheV9jb3JlX2luaXQoaTkxNSwgdHJ1ZSk7CiAJCWlmIChpOTE1LT5j
c3IuZG1jX3BheWxvYWQgJiYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZHAuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYwpp
bmRleCBhNTYwNDY4NzY1YzAuLmE1MjMxYWMzNDQzYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZHAuYwpAQCAtMzAxLDEwICszMDEsMTAgQEAgaW50ZWxfZHBfc2V0X3NvdXJj
ZV9yYXRlcyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQogCQkJbWF4X3JhdGUgPSBlaGxfbWF4
X3NvdXJjZV9yYXRlKGludGVsX2RwKTsKIAkJZWxzZQogCQkJbWF4X3JhdGUgPSBpY2xfbWF4X3Nv
dXJjZV9yYXRlKGludGVsX2RwKTsKLQl9IGVsc2UgaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7
CisJfSBlbHNlIGlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9w
cml2KSkgewogCQlzb3VyY2VfcmF0ZXMgPSBieHRfcmF0ZXM7CiAJCXNpemUgPSBBUlJBWV9TSVpF
KGJ4dF9yYXRlcyk7Ci0JfSBlbHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2KSkgeworCX0gZWxz
ZSBpZiAoSVNfRElTUExBWV9WRVIoZGV2X3ByaXYsIDkpKSB7CiAJCXNvdXJjZV9yYXRlcyA9IHNr
bF9yYXRlczsKIAkJc2l6ZSA9IEFSUkFZX1NJWkUoc2tsX3JhdGVzKTsKIAl9IGVsc2UgaWYgKChJ
U19IQVNXRUxMKGRldl9wcml2KSAmJiAhSVNfSFNXX1VMWChkZXZfcHJpdikpIHx8CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwX21zdC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9tc3QuYwppbmRleCAyZGFhM2Y2Nzc5MWUu
LjE4MGY5N2NkNzRjYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kcF9tc3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rw
X21zdC5jCkBAIC0xNTQsNyArMTU0LDcgQEAgc3RhdGljIGludCBpbnRlbF9kcF9tc3RfY29tcHV0
ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJcGlwZV9jb25maWctPmxp
bWl0ZWRfY29sb3JfcmFuZ2UgPQogCQlpbnRlbF9kcF9saW1pdGVkX2NvbG9yX3JhbmdlKHBpcGVf
Y29uZmlnLCBjb25uX3N0YXRlKTsKIAotCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkKKwlpZiAo
SVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikpCiAJCXBpcGVf
Y29uZmlnLT5sYW5lX2xhdF9vcHRpbV9tYXNrID0KIAkJCWJ4dF9kZGlfcGh5X2NhbGNfbGFuZV9s
YXRfb3B0aW1fbWFzayhwaXBlX2NvbmZpZy0+bGFuZV9jb3VudCk7CiAKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBsbC5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kcGxsLmMKaW5kZXggM2UzYzVlZWQxNjAwLi4xNThmMjcxMjk5
YTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBsbC5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBsbC5jCkBAIC0zNjYs
MTMgKzM2NiwxMSBAQCBzdGF0aWMgYm9vbCBpbnRlbF9wbGxfaXNfdmFsaWQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAogCWlmIChjbG9jay0+bTEgPCBsaW1pdC0+bTEubWluIHx8
IGxpbWl0LT5tMS5tYXggPCBjbG9jay0+bTEpCiAJCXJldHVybiBmYWxzZTsKIAotCWlmICghSVNf
UElORVZJRVcoZGV2X3ByaXYpICYmICFJU19WQUxMRVlWSUVXKGRldl9wcml2KSAmJgotCSAgICAh
SVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgJiYgIUlTX0dFTjlfTFAoZGV2X3ByaXYpKQorCWlmICgh
SVNfUElORVZJRVcoZGV2X3ByaXYpICYmICFJU19MUChkZXZfcHJpdikpCiAJCWlmIChjbG9jay0+
bTEgPD0gY2xvY2stPm0yKQogCQkJcmV0dXJuIGZhbHNlOwogCi0JaWYgKCFJU19WQUxMRVlWSUVX
KGRldl9wcml2KSAmJiAhSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgJiYKLQkgICAgIUlTX0dFTjlf
TFAoZGV2X3ByaXYpKSB7CisJaWYgKCFJU19MUChkZXZfcHJpdikpIHsKIAkJaWYgKGNsb2NrLT5w
IDwgbGltaXQtPnAubWluIHx8IGxpbWl0LT5wLm1heCA8IGNsb2NrLT5wKQogCQkJcmV0dXJuIGZh
bHNlOwogCQlpZiAoY2xvY2stPm0gPCBsaW1pdC0+bS5taW4gfHwgbGltaXQtPm0ubWF4IDwgY2xv
Y2stPm0pCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rw
bGxfbWdyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwbGxfbWdyLmMK
aW5kZXggMWFlMTU4ZDEyYzA3Li5lMzJkZTdjODQ4ZTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBsbF9tZ3IuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2RwbGxfbWdyLmMKQEAgLTQ0NDEsMTAgKzQ0NDEsMTAgQEAgdm9p
ZCBpbnRlbF9zaGFyZWRfZHBsbF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAJCWRwbGxf
bWdyID0gJmljbF9wbGxfbWdyOwogCWVsc2UgaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKQog
CQlkcGxsX21nciA9ICZjbmxfcGxsX21ncjsKLQllbHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2
KSkKLQkJZHBsbF9tZ3IgPSAmc2tsX3BsbF9tZ3I7Ci0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZf
cHJpdikpCisJZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihk
ZXZfcHJpdikpCiAJCWRwbGxfbWdyID0gJmJ4dF9wbGxfbWdyOworCWVsc2UgaWYgKElTX0RJU1BM
QVlfVkVSKGRldl9wcml2LCA5KSkKKwkJZHBsbF9tZ3IgPSAmc2tsX3BsbF9tZ3I7CiAJZWxzZSBp
ZiAoSEFTX0RESShkZXZfcHJpdikpCiAJCWRwbGxfbWdyID0gJmhzd19wbGxfbWdyOwogCWVsc2Ug
aWYgKEhBU19QQ0hfSUJYKGRldl9wcml2KSB8fCBIQVNfUENIX0NQVChkZXZfcHJpdikpCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZiYy5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmMuYwppbmRleCA5ODZiYmJlM2IxMmYuLjA0
ZDljN2QyMmIwNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9mYmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZiYy5jCkBA
IC0zMDIsNyArMzAyLDcgQEAgc3RhdGljIHZvaWQgZ2VuN19mYmNfYWN0aXZhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWludCB0aHJlc2hvbGQgPSBkZXZfcHJpdi0+ZmJj
LnRocmVzaG9sZDsKIAogCS8qIERpc3BsYXkgV0EgIzA1Mjk6IHNrbCwga2JsLCBieHQuICovCi0J
aWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKSB7CisJaWYg
KElTX0RJU1BMQVlfVkVSKGRldl9wcml2LCA5KSkgewogCQl1MzIgdmFsID0gaW50ZWxfZGVfcmVh
ZChkZXZfcHJpdiwgQ0hJQ0tFTl9NSVNDXzQpOwogCiAJCXZhbCAmPSB+KEZCQ19TVFJJREVfT1ZF
UlJJREUgfCBGQkNfU1RSSURFX01BU0spOwpAQCAtNDQ1LDcgKzQ0NSw4IEBAIHN0YXRpYyBpbnQg
ZmluZF9jb21wcmVzc2lvbl90aHJlc2hvbGQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAogCSAqIHJlc2VydmVkIHJhbmdlIHNpemUsIHNvIGl0IGFsd2F5cyBhc3N1bWVzIHRoZSBt
YXhpbXVtICg4bWIpIGlzIHVzZWQuCiAJICogSWYgd2UgZW5hYmxlIEZCQyB1c2luZyBhIENGQiBv
biB0aGF0IG1lbW9yeSByYW5nZSB3ZSdsbCBnZXQgRklGTwogCSAqIHVuZGVycnVucywgZXZlbiBp
ZiB0aGF0IHJhbmdlIGlzIG5vdCByZXNlcnZlZCBieSB0aGUgQklPUy4gKi8KLQlpZiAoSVNfQlJP
QURXRUxMKGRldl9wcml2KSB8fCBJU19HRU45X0JDKGRldl9wcml2KSkKKwlpZiAoSVNfQlJPQURX
RUxMKGRldl9wcml2KSB8fCAoSVNfRElTUExBWV9WRVIoZGV2X3ByaXYsIDkpICYmCisJCQkJICAg
ICAgICFJU19CUk9YVE9OKGRldl9wcml2KSkpCiAJCWVuZCA9IHJlc291cmNlX3NpemUoJmRldl9w
cml2LT5kc20pIC0gOCAqIDEwMjQgKiAxMDI0OwogCWVsc2UKIAkJZW5kID0gVTY0X01BWDsKQEAg
LTc1OSw3ICs3NjAsNyBAQCBzdGF0aWMgdTE2IGludGVsX2ZiY19nZW45X3dhX2NmYl9zdHJpZGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCXN0cnVjdCBpbnRlbF9mYmMgKmZi
YyA9ICZkZXZfcHJpdi0+ZmJjOwogCXN0cnVjdCBpbnRlbF9mYmNfc3RhdGVfY2FjaGUgKmNhY2hl
ID0gJmZiYy0+c3RhdGVfY2FjaGU7CiAKLQlpZiAoKElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8IElT
X0JST1hUT04oZGV2X3ByaXYpKSAmJgorCWlmICgoSVNfRElTUExBWV9WRVIoZGV2X3ByaXYsIDkp
KSAmJgogCSAgICBjYWNoZS0+ZmIubW9kaWZpZXIgIT0gSTkxNV9GT1JNQVRfTU9EX1hfVElMRUQp
CiAJCXJldHVybiBESVZfUk9VTkRfVVAoY2FjaGUtPnBsYW5lLnNyY193LCAzMiAqIGZiYy0+dGhy
ZXNob2xkKSAqIDg7CiAJZWxzZQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9nbWJ1cy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9n
bWJ1cy5jCmluZGV4IDhkZGMyMGRhZWY2NC4uMTNiYTI4MGQwMjI4IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2dtYnVzLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9nbWJ1cy5jCkBAIC0xMDcsOSArMTA3LDkgQEAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBnbWJ1c19waW4gKmdldF9nbWJ1c19waW4oc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAogCQlyZXR1cm4gJmdtYnVzX3BpbnNfaWNwW3Bpbl07CiAJZWxzZSBp
ZiAoSEFTX1BDSF9DTlAoZGV2X3ByaXYpKQogCQlyZXR1cm4gJmdtYnVzX3BpbnNfY25wW3Bpbl07
Ci0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCisJZWxzZSBpZiAoSVNfR0VNSU5JTEFL
RShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikpCiAJCXJldHVybiAmZ21idXNfcGlu
c19ieHRbcGluXTsKLQllbHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2KSkKKwllbHNlIGlmIChJ
U19ESVNQTEFZX1ZFUihkZXZfcHJpdiwgOSkpCiAJCXJldHVybiAmZ21idXNfcGluc19za2xbcGlu
XTsKIAllbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQogCQlyZXR1cm4gJmdtYnVzX3Bp
bnNfYmR3W3Bpbl07CkBAIC0xMjgsOSArMTI4LDkgQEAgYm9vbCBpbnRlbF9nbWJ1c19pc192YWxp
ZF9waW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCQlzaXplID0gQVJSQVlf
U0laRShnbWJ1c19waW5zX2ljcCk7CiAJZWxzZSBpZiAoSEFTX1BDSF9DTlAoZGV2X3ByaXYpKQog
CQlzaXplID0gQVJSQVlfU0laRShnbWJ1c19waW5zX2NucCk7Ci0JZWxzZSBpZiAoSVNfR0VOOV9M
UChkZXZfcHJpdikpCisJZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJP
WFRPTihkZXZfcHJpdikpCiAJCXNpemUgPSBBUlJBWV9TSVpFKGdtYnVzX3BpbnNfYnh0KTsKLQll
bHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2KSkKKwllbHNlIGlmIChJU19ESVNQTEFZX1ZFUihk
ZXZfcHJpdiwgOSkpCiAJCXNpemUgPSBBUlJBWV9TSVpFKGdtYnVzX3BpbnNfc2tsKTsKIAllbHNl
IGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQogCQlzaXplID0gQVJSQVlfU0laRShnbWJ1c19w
aW5zX2Jkdyk7CkBAIC02MDAsNyArNjAwLDcgQEAgZG9fZ21idXNfeGZlcihzdHJ1Y3QgaTJjX2Fk
YXB0ZXIgKmFkYXB0ZXIsIHN0cnVjdCBpMmNfbXNnICptc2dzLCBpbnQgbnVtLAogCWludCByZXQg
PSAwOwogCiAJLyogRGlzcGxheSBXQSAjMDg2ODogc2tsLGJ4dCxrYmwsY2ZsLGdsayxjbmwgKi8K
LQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCisJaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYp
IHx8IElTX0JST1hUT04oZGV2X3ByaXYpKQogCQlieHRfZ21idXNfY2xvY2tfZ2F0aW5nKGRldl9w
cml2LCBmYWxzZSk7CiAJZWxzZSBpZiAoSEFTX1BDSF9TUFQoZGV2X3ByaXYpIHx8IEhBU19QQ0hf
Q05QKGRldl9wcml2KSkKIAkJcGNoX2dtYnVzX2Nsb2NrX2dhdGluZyhkZXZfcHJpdiwgZmFsc2Up
OwpAQCAtNzEzLDcgKzcxMyw3IEBAIGRvX2dtYnVzX3hmZXIoc3RydWN0IGkyY19hZGFwdGVyICph
ZGFwdGVyLCBzdHJ1Y3QgaTJjX21zZyAqbXNncywgaW50IG51bSwKIAogb3V0OgogCS8qIERpc3Bs
YXkgV0EgIzA4Njg6IHNrbCxieHQsa2JsLGNmbCxnbGssY25sICovCi0JaWYgKElTX0dFTjlfTFAo
ZGV2X3ByaXYpKQorCWlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRl
dl9wcml2KSkKIAkJYnh0X2dtYnVzX2Nsb2NrX2dhdGluZyhkZXZfcHJpdiwgdHJ1ZSk7CiAJZWxz
ZSBpZiAoSEFTX1BDSF9TUFQoZGV2X3ByaXYpIHx8IEhBU19QQ0hfQ05QKGRldl9wcml2KSkKIAkJ
cGNoX2dtYnVzX2Nsb2NrX2dhdGluZyhkZXZfcHJpdiwgdHJ1ZSk7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkY3AuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfaGRjcC5jCmluZGV4IGQ4NTcwZTE0ZmU2MC4uNzUwNTBhMDQwNTc3
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkY3AuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkY3AuYwpAQCAtMjg2LDEx
ICsyODYsMTIgQEAgc3RhdGljIGludCBpbnRlbF9oZGNwX2xvYWRfa2V5cyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJLyoKIAkgKiBJbml0aWF0ZSBsb2FkaW5nIHRoZSBIRENQ
IGtleSBmcm9tIGZ1c2VzLgogCSAqCi0JICogQlhUKyBwbGF0Zm9ybXMsIEhEQ1Aga2V5IG5lZWRz
IHRvIGJlIGxvYWRlZCBieSBTVy4gT25seSBHZW4gOQotCSAqIHBsYXRmb3JtcyBleGNlcHQgQlhU
IGFuZCBHTEssIGRpZmZlciBpbiB0aGUga2V5IGxvYWQgdHJpZ2dlciBwcm9jZXNzCi0JICogZnJv
bSBvdGhlciBwbGF0Zm9ybXMuIFNvIEdFTjlfQkMgdXNlcyB0aGUgR1QgRHJpdmVyIE1haWxib3gg
aS9mLgorCSAqIEJYVCsgcGxhdGZvcm1zLCBIRENQIGtleSBuZWVkcyB0byBiZSBsb2FkZWQgYnkg
U1cuIE9ubHkgZGlzcGxheQorCSAqIHZlcnNpb24gOSBwbGF0Zm9ybXMgKG1pbnVzIEJYVCkgZGlm
ZmVyIGluIHRoZSBrZXkgbG9hZCB0cmlnZ2VyCisJICogcHJvY2VzcyBmcm9tIG90aGVyIHBsYXRm
b3Jtcy4gVGhlc2UgcGxhdGZvcm1zIHVzZSB0aGUgR1QgRHJpdmVyCisJICogTWFpbGJveCBpbnRl
cmZhY2UuCiAJICovCi0JaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKSB7CisJaWYgKElTX0RJU1BM
QVlfVkVSKGRldl9wcml2LCA5KSAmJiAhSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKIAkJcmV0ID0g
c2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUoZGV2X3ByaXYsCiAJCQkJCSAgICAgIFNLTF9QQ09ERV9M
T0FEX0hEQ1BfS0VZUywgMSk7CiAJCWlmIChyZXQpIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRtaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9oZG1pLmMKaW5kZXggZDY5ZjBhNmRjMjZkLi5mMmQxZmVmOGJkOWQgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRtaS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRtaS5jCkBAIC0xODQxLDcgKzE4NDEs
OCBAQCBoZG1pX3BvcnRfY2xvY2tfdmFsaWQoc3RydWN0IGludGVsX2hkbWkgKmhkbWksCiAJCXJl
dHVybiBNT0RFX0NMT0NLX1JBTkdFOwogCiAJLyogQlhUL0dMSyBEUExMIGNhbid0IGdlbmVyYXRl
IDIyMy0yNDAgTUh6ICovCi0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpICYmIGNsb2NrID4gMjIz
MzMzICYmIGNsb2NrIDwgMjQwMDAwKQorCWlmICgoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwg
SVNfQlJPWFRPTihkZXZfcHJpdikpICYmCisJICAgIGNsb2NrID4gMjIzMzMzICYmIGNsb2NrIDwg
MjQwMDAwKQogCQlyZXR1cm4gTU9ERV9DTE9DS19SQU5HRTsKIAogCS8qIENIViBEUExMIGNhbid0
IGdlbmVyYXRlIDIxNi0yNDAgTUh6ICovCkBAIC0yNzE0LDcgKzI3MTUsNyBAQCBzdGF0aWMgdTgg
aW50ZWxfaGRtaV9kZGNfcGluKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQogCQlkZGNf
cGluID0gZGcxX3BvcnRfdG9fZGRjX3BpbihkZXZfcHJpdiwgcG9ydCk7CiAJZWxzZSBpZiAoSVNf
Uk9DS0VUTEFLRShkZXZfcHJpdikpCiAJCWRkY19waW4gPSBya2xfcG9ydF90b19kZGNfcGluKGRl
dl9wcml2LCBwb3J0KTsKLQllbHNlIGlmIChJU19HRU45X0JDKGRldl9wcml2KSAmJiBIQVNfUENI
X1RHUChkZXZfcHJpdikpCisJZWxzZSBpZiAoSVNfRElTUExBWV9WRVIoZGV2X3ByaXYsIDkpICYm
IEhBU19QQ0hfVEdQKGRldl9wcml2KSkKIAkJZGRjX3BpbiA9IGdlbjliY190Z3BfcG9ydF90b19k
ZGNfcGluKGRldl9wcml2LCBwb3J0KTsKIAllbHNlIGlmIChIQVNfUENIX01DQyhkZXZfcHJpdikp
CiAJCWRkY19waW4gPSBtY2NfcG9ydF90b19kZGNfcGluKGRldl9wcml2LCBwb3J0KTsKQEAgLTI3
MjIsNyArMjcyMyw3IEBAIHN0YXRpYyB1OCBpbnRlbF9oZG1pX2RkY19waW4oc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIpCiAJCWRkY19waW4gPSBpY2xfcG9ydF90b19kZGNfcGluKGRldl9w
cml2LCBwb3J0KTsKIAllbHNlIGlmIChIQVNfUENIX0NOUChkZXZfcHJpdikpCiAJCWRkY19waW4g
PSBjbnBfcG9ydF90b19kZGNfcGluKGRldl9wcml2LCBwb3J0KTsKLQllbHNlIGlmIChJU19HRU45
X0xQKGRldl9wcml2KSkKKwllbHNlIGlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19C
Uk9YVE9OKGRldl9wcml2KSkKIAkJZGRjX3BpbiA9IGJ4dF9wb3J0X3RvX2RkY19waW4oZGV2X3By
aXYsIHBvcnQpOwogCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQogCQlkZGNfcGlu
ID0gY2h2X3BvcnRfdG9fZGRjX3BpbihkZXZfcHJpdiwgcG9ydCk7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3BhbmVsLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX3BhbmVsLmMKaW5kZXggMTAwMjJkMTU3NWUxLi4yZmNiYjJiYTJk
NzggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3BhbmVsLmMKQEAgLTIx
NjEsNyArMjE2MSw3IEBAIGludGVsX3BhbmVsX2luaXRfYmFja2xpZ2h0X2Z1bmNzKHN0cnVjdCBp
bnRlbF9wYW5lbCAqcGFuZWwpCiAJICAgIGludGVsX2RzaV9kY3NfaW5pdF9iYWNrbGlnaHRfZnVu
Y3MoY29ubmVjdG9yKSA9PSAwKQogCQlyZXR1cm47CiAKLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJp
dikpIHsKKwlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJp
dikpIHsKIAkJcGFuZWwtPmJhY2tsaWdodC5wd21fZnVuY3MgPSAmYnh0X3B3bV9mdW5jczsKIAl9
IGVsc2UgaWYgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA+PSBQQ0hfQ05QKSB7CiAJCXBhbmVs
LT5iYWNrbGlnaHQucHdtX2Z1bmNzID0gJmNucF9wd21fZnVuY3M7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bwcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9wcHMuYwppbmRleCBjNTVkYTEzMDc3M2IuLjNhMDk4NWYxZjUzMSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wcHMuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bwcy5jCkBAIC0zMTMsMTAgKzMx
Myw3IEBAIHZvaWQgaW50ZWxfcHBzX3Jlc2V0X2FsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCiB7CiAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7CiAKLQlpZiAoZHJt
X1dBUk5fT04oJmRldl9wcml2LT5kcm0sCi0JCQkhKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8
Ci0JCQkgIElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpIHx8Ci0JCQkgIElTX0dFTjlfTFAoZGV2X3By
aXYpKSkpCisJaWYgKGRybV9XQVJOX09OKCZkZXZfcHJpdi0+ZHJtLCAhSVNfTFAoZGV2X3ByaXYp
KSkKIAkJcmV0dXJuOwogCiAJLyoKQEAgLTMzOCw3ICszMzUsNyBAQCB2b2lkIGludGVsX3Bwc19y
ZXNldF9hbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQlpZiAoZW5jb2Rl
ci0+dHlwZSAhPSBJTlRFTF9PVVRQVVRfRURQKQogCQkJY29udGludWU7CiAKLQkJaWYgKElTX0dF
TjlfTFAoZGV2X3ByaXYpKQorCQlpZiAoRElTUExBWV9WRVIoZGV2X3ByaXYpID49IDkpCiAJCQlp
bnRlbF9kcC0+cHBzLnBwc19yZXNldCA9IHRydWU7CiAJCWVsc2UKIAkJCWludGVsX2RwLT5wcHMu
cHBzX3BpcGUgPSBJTlZBTElEX1BJUEU7CkBAIC0zNjEsNyArMzU4LDcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfcHBzX2dldF9yZWdpc3RlcnMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKIAogCW1l
bXNldChyZWdzLCAwLCBzaXplb2YoKnJlZ3MpKTsKIAotCWlmIChJU19HRU45X0xQKGRldl9wcml2
KSkKKwlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikp
CiAJCXBwc19pZHggPSBieHRfcG93ZXJfc2VxdWVuY2VyX2lkeChpbnRlbF9kcCk7CiAJZWxzZSBp
ZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCiAJ
CXBwc19pZHggPSB2bHZfcG93ZXJfc2VxdWVuY2VyX3BpcGUoaW50ZWxfZHApOwpAQCAtMzcyLDcg
KzM2OSw4IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bwc19nZXRfcmVnaXN0ZXJzKHN0cnVjdCBpbnRl
bF9kcCAqaW50ZWxfZHAsCiAJcmVncy0+cHBfb2ZmID0gUFBfT0ZGX0RFTEFZUyhwcHNfaWR4KTsK
IAogCS8qIEN5Y2xlIGRlbGF5IG1vdmVkIGZyb20gUFBfRElWSVNPUiB0byBQUF9DT05UUk9MICov
Ci0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpIHx8IElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA+
PSBQQ0hfQ05QKQorCWlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRl
dl9wcml2KSB8fAorCSAgICBJTlRFTF9QQ0hfVFlQRShkZXZfcHJpdikgPj0gUENIX0NOUCkKIAkJ
cmVncy0+cHBfZGl2ID0gSU5WQUxJRF9NTUlPX1JFRzsKIAllbHNlCiAJCXJlZ3MtPnBwX2RpdiA9
IFBQX0RJVklTT1IocHBzX2lkeCk7CkBAIC0xMzk5LDcgKzEzOTcsNyBAQCB2b2lkIGludGVsX3Bw
c191bmxvY2tfcmVnc193YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAKIHZv
aWQgaW50ZWxfcHBzX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewotCWlm
IChIQVNfUENIX1NQTElUKGk5MTUpIHx8IElTX0dFTjlfTFAoaTkxNSkpCisJaWYgKEhBU19QQ0hf
U1BMSVQoaTkxNSkgfHwgSVNfR0VNSU5JTEFLRShpOTE1KSB8fCBJU19CUk9YVE9OKGk5MTUpKQog
CQlpOTE1LT5wcHNfbW1pb19iYXNlID0gUENIX1BQU19CQVNFOwogCWVsc2UgaWYgKElTX1ZBTExF
WVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKIAkJaTkxNS0+cHBzX21taW9fYmFz
ZSA9IFZMVl9QUFNfQkFTRTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvdmx2X2RzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS92bHZfZHNpLmMKaW5k
ZXggMTA1OWEyNmMxZjU4Li45YmVlOTlmZTU0OTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvdmx2X2RzaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvdmx2X2RzaS5jCkBAIC0yOTcsNyArMjk3LDcgQEAgc3RhdGljIGludCBpbnRlbF9kc2lfY29t
cHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJZWxzZQogCQlwaXBl
X2NvbmZpZy0+cGlwZV9icHAgPSAxODsKIAotCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewor
CWlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkgewog
CQkvKiBFbmFibGUgRnJhbWUgdGltZSBzdGFtcCBiYXNlZCBzY2FubGluZSByZXBvcnRpbmcgKi8K
IAkJcGlwZV9jb25maWctPm1vZGVfZmxhZ3MgfD0KIAkJCUk5MTVfTU9ERV9GTEFHX0dFVF9TQ0FO
TElORV9GUk9NX1RJTUVTVEFNUDsKQEAgLTUyMiw3ICs1MjIsNyBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9kc2lfZGV2aWNlX3JlYWR5KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQogCiAJaWYg
KElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKQogCQlnbGtfZHNpX2RldmljZV9yZWFkeShlbmNvZGVy
KTsKLQllbHNlIGlmIChJU19HRU45X0xQKGRldl9wcml2KSkKKwllbHNlIGlmIChJU19HRU1JTklM
QUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkKIAkJYnh0X2RzaV9kZXZpY2Vf
cmVhZHkoZW5jb2Rlcik7CiAJZWxzZQogCQl2bHZfZHNpX2RldmljZV9yZWFkeShlbmNvZGVyKTsK
QEAgLTYwMSw3ICs2MDEsNyBAQCBzdGF0aWMgdm9pZCB2bHZfZHNpX2NsZWFyX2RldmljZV9yZWFk
eShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKIAlkcm1fZGJnX2ttcygmZGV2X3ByaXYt
PmRybSwgIlxuIik7CiAJZm9yX2VhY2hfZHNpX3BvcnQocG9ydCwgaW50ZWxfZHNpLT5wb3J0cykg
ewogCQkvKiBDb21tb24gYml0IGZvciBib3RoIE1JUEkgUG9ydCBBICYgTUlQSSBQb3J0IEMgb24g
VkxWL0NIViAqLwotCQlpOTE1X3JlZ190IHBvcnRfY3RybCA9IElTX0dFTjlfTFAoZGV2X3ByaXYp
ID8KKwkJaTkxNV9yZWdfdCBwb3J0X2N0cmwgPSBJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJ
U19CUk9YVE9OKGRldl9wcml2KSA/CiAJCQlCWFRfTUlQSV9QT1JUX0NUUkwocG9ydCkgOiBNSVBJ
X1BPUlRfQ1RSTChQT1JUX0EpOwogCQl1MzIgdmFsOwogCkBAIC02MjEsNyArNjIxLDcgQEAgc3Rh
dGljIHZvaWQgdmx2X2RzaV9jbGVhcl9kZXZpY2VfcmVhZHkoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIpCiAJCSAqIE9uIFZMVi9DSFYsIHdhaXQgdGlsbCBDbG9jayBsYW5lcyBhcmUgaW4g
TFAtMDAgc3RhdGUgZm9yIE1JUEkKIAkJICogUG9ydCBBIG9ubHkuIE1JUEkgUG9ydCBDIGhhcyBu
byBzaW1pbGFyIGJpdCBmb3IgY2hlY2tpbmcuCiAJCSAqLwotCQlpZiAoKElTX0dFTjlfTFAoZGV2
X3ByaXYpIHx8IHBvcnQgPT0gUE9SVF9BKSAmJgorCQlpZiAoKElTX0dFTUlOSUxBS0UoZGV2X3By
aXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpIHx8IHBvcnQgPT0gUE9SVF9BKSAmJgogCQkgICAg
aW50ZWxfZGVfd2FpdF9mb3JfY2xlYXIoZGV2X3ByaXYsIHBvcnRfY3RybCwKIAkJCQkJICAgIEFG
RV9MQVRDSE9VVCwgMzApKQogCQkJZHJtX2VycigmZGV2X3ByaXYtPmRybSwgIkRTSSBMUCBub3Qg
Z29pbmcgTG93XG4iKTsKQEAgLTY0Niw3ICs2NDYsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lf
cG9ydF9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAKIAlpZiAoaW50ZWxf
ZHNpLT5kdWFsX2xpbmsgPT0gRFNJX0RVQUxfTElOS19GUk9OVF9CQUNLKSB7CiAJCXUzMiB0ZW1w
OwotCQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKKwkJaWYgKElTX0dFTUlOSUxBS0UoZGV2
X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKSB7CiAJCQlmb3JfZWFjaF9kc2lfcG9ydChw
b3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7CiAJCQkJdGVtcCA9IGludGVsX2RlX3JlYWQoZGV2X3By
aXYsCiAJCQkJCQkgICAgIE1JUElfQ1RSTChwb3J0KSk7CkBAIC02NjYsNyArNjY2LDcgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZHNpX3BvcnRfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAogCX0KIAogCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMpIHsK
LQkJaTkxNV9yZWdfdCBwb3J0X2N0cmwgPSBJU19HRU45X0xQKGRldl9wcml2KSA/CisJCWk5MTVf
cmVnX3QgcG9ydF9jdHJsID0gSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihk
ZXZfcHJpdikgPwogCQkJQlhUX01JUElfUE9SVF9DVFJMKHBvcnQpIDogTUlQSV9QT1JUX0NUUkwo
cG9ydCk7CiAJCXUzMiB0ZW1wOwogCkBAIC03MDMsNyArNzAzLDcgQEAgc3RhdGljIHZvaWQgaW50
ZWxfZHNpX3BvcnRfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKIAllbnVt
IHBvcnQgcG9ydDsKIAogCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQsIGludGVsX2RzaS0+cG9ydHMp
IHsKLQkJaTkxNV9yZWdfdCBwb3J0X2N0cmwgPSBJU19HRU45X0xQKGRldl9wcml2KSA/CisJCWk5
MTVfcmVnX3QgcG9ydF9jdHJsID0gSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRP
TihkZXZfcHJpdikgPwogCQkJQlhUX01JUElfUE9SVF9DVFJMKHBvcnQpIDogTUlQSV9QT1JUX0NU
UkwocG9ydCk7CiAJCXUzMiB0ZW1wOwogCkBAIC03ODEsNyArNzgxLDcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfZHNpX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJ
ICogVGhlIEJJT1MgbWF5IGxlYXZlIHRoZSBQTEwgaW4gYSB3b25reSBzdGF0ZSB3aGVyZSBpdCBk
b2Vzbid0CiAJICogbG9jay4gSXQgbmVlZHMgdG8gYmUgZnVsbHkgcG93ZXJlZCBkb3duIHRvIGZp
eCBpdC4KIAkgKi8KLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKKwlpZiAoSVNfR0VNSU5J
TEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKIAkJYnh0X2RzaV9wbGxf
ZGlzYWJsZShlbmNvZGVyKTsKIAkJYnh0X2RzaV9wbGxfZW5hYmxlKGVuY29kZXIsIHBpcGVfY29u
ZmlnKTsKIAl9IGVsc2UgewpAQCAtOTMyLDcgKzkzMiw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rz
aV9wb3N0X2Rpc2FibGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAKIAlkcm1f
ZGJnX2ttcygmZGV2X3ByaXYtPmRybSwgIlxuIik7CiAKLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJp
dikpIHsKKwlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJp
dikpIHsKIAkJaW50ZWxfY3J0Y192Ymxhbmtfb2ZmKG9sZF9jcnRjX3N0YXRlKTsKIAogCQlza2xf
c2NhbGVyX2Rpc2FibGUob2xkX2NydGNfc3RhdGUpOwpAQCAtOTcxLDcgKzk3MSw3IEBAIHN0YXRp
YyB2b2lkIGludGVsX2RzaV9wb3N0X2Rpc2FibGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUsCiAJCQkgICAgICAgdmFsICYgfk1JUElPX1JTVF9DVFJMKTsKIAl9CiAKLQlpZiAoSVNf
R0VOOV9MUChkZXZfcHJpdikpIHsKKwlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNf
QlJPWFRPTihkZXZfcHJpdikpIHsKIAkJYnh0X2RzaV9wbGxfZGlzYWJsZShlbmNvZGVyKTsKIAl9
IGVsc2UgewogCQl1MzIgdmFsOwpAQCAtMTAyNCwxMiArMTAyNCwxMyBAQCBzdGF0aWMgYm9vbCBp
bnRlbF9kc2lfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCSAq
IGNvbmZpZ3VyYXRpb24sIG90aGVyd2lzZSBhY2Nlc3NpbmcgRFNJIHJlZ2lzdGVycyB3aWxsIGhh
bmcgdGhlCiAJICogbWFjaGluZS4gU2VlIEJTcGVjIE5vcnRoIERpc3BsYXkgRW5naW5lIHJlZ2lz
dGVycy9NSVBJW0JYVF0uCiAJICovCi0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpICYmICFieHRf
ZHNpX3BsbF9pc19lbmFibGVkKGRldl9wcml2KSkKKwlpZiAoKElTX0dFTUlOSUxBS0UoZGV2X3By
aXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKSAmJgorCSAgICAhYnh0X2RzaV9wbGxfaXNfZW5h
YmxlZChkZXZfcHJpdikpCiAJCWdvdG8gb3V0X3B1dF9wb3dlcjsKIAogCS8qIFhYWDogdGhpcyBv
bmx5IHdvcmtzIGZvciBvbmUgRFNJIG91dHB1dCAqLwogCWZvcl9lYWNoX2RzaV9wb3J0KHBvcnQs
IGludGVsX2RzaS0+cG9ydHMpIHsKLQkJaTkxNV9yZWdfdCBjdHJsX3JlZyA9IElTX0dFTjlfTFAo
ZGV2X3ByaXYpID8KKwkJaTkxNV9yZWdfdCBjdHJsX3JlZyA9IElTX0dFTUlOSUxBS0UoZGV2X3By
aXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpID8KIAkJCUJYVF9NSVBJX1BPUlRfQ1RSTChwb3J0
KSA6IE1JUElfUE9SVF9DVFJMKHBvcnQpOwogCQlib29sIGVuYWJsZWQgPSBpbnRlbF9kZV9yZWFk
KGRldl9wcml2LCBjdHJsX3JlZykgJiBEUElfRU5BQkxFOwogCkBAIC0xMDU1LDcgKzEwNTYsNyBA
QCBzdGF0aWMgYm9vbCBpbnRlbF9kc2lfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAogCQlpZiAoIShpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBNSVBJX0RFVklDRV9S
RUFEWShwb3J0KSkgJiBERVZJQ0VfUkVBRFkpKQogCQkJY29udGludWU7CiAKLQkJaWYgKElTX0dF
TjlfTFAoZGV2X3ByaXYpKSB7CisJCWlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19C
Uk9YVE9OKGRldl9wcml2KSkgewogCQkJdTMyIHRtcCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYs
IE1JUElfQ1RSTChwb3J0KSk7CiAJCQl0bXAgJj0gQlhUX1BJUEVfU0VMRUNUX01BU0s7CiAJCQl0
bXAgPj49IEJYVF9QSVBFX1NFTEVDVF9TSElGVDsKQEAgLTEyNTEsNyArMTI1Miw3IEBAIHN0YXRp
YyB2b2lkIGludGVsX2RzaV9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAogCiAJcGlwZV9jb25maWctPm91dHB1dF90eXBlcyB8PSBCSVQoSU5URUxfT1VUUFVUX0RTSSk7
CiAKLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKKwlpZiAoSVNfR0VNSU5JTEFLRShkZXZf
cHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKIAkJYnh0X2RzaV9nZXRfcGlwZV9jb25m
aWcoZW5jb2RlciwgcGlwZV9jb25maWcpOwogCQlwY2xrID0gYnh0X2RzaV9nZXRfcGNsayhlbmNv
ZGVyLCBwaXBlX2NvbmZpZyk7CiAJfSBlbHNlIHsKQEAgLTEzMTcsNyArMTMxOCw3IEBAIHN0YXRp
YyB2b2lkIHNldF9kc2lfdGltaW5ncyhzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIsCiAJaGJw
ID0gdHhieXRlY2xraHMoaGJwLCBicHAsIGxhbmVfY291bnQsIGludGVsX2RzaS0+YnVyc3RfbW9k
ZV9yYXRpbyk7CiAKIAlmb3JfZWFjaF9kc2lfcG9ydChwb3J0LCBpbnRlbF9kc2ktPnBvcnRzKSB7
Ci0JCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkgeworCQlpZiAoSVNfR0VNSU5JTEFLRShkZXZf
cHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKIAkJCS8qCiAJCQkgKiBQcm9ncmFtIGhk
aXNwbGF5IGFuZCB2ZGlzcGxheSBvbiBNSVBJIHRyYW5zY29kZXIuCiAJCQkgKiBUaGlzIGlzIGRp
ZmZlcmVudCBmcm9tIGNhbGN1bGF0ZWQgaGFjdGl2ZSBhbmQKQEAgLTE0MDcsNyArMTQwOCw3IEBA
IHN0YXRpYyB2b2lkIGludGVsX2RzaV9wcmVwYXJlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICppbnRl
bF9lbmNvZGVyLAogCQkJdG1wICY9IH5SRUFEX1JFUVVFU1RfUFJJT1JJVFlfTUFTSzsKIAkJCWlu
dGVsX2RlX3dyaXRlKGRldl9wcml2LCBNSVBJX0NUUkwocG9ydCksCiAJCQkJICAgICAgIHRtcCB8
IFJFQURfUkVRVUVTVF9QUklPUklUWV9ISUdIKTsKLQkJfSBlbHNlIGlmIChJU19HRU45X0xQKGRl
dl9wcml2KSkgeworCQl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElTX0JS
T1hUT04oZGV2X3ByaXYpKSB7CiAJCQllbnVtIHBpcGUgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7
CiAKIAkJCXRtcCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIE1JUElfQ1RSTChwb3J0KSk7CkBA
IC0xNDQ1LDcgKzE0NDYsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfcHJlcGFyZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKIAlpZiAoaW50ZWxfZHNpLT5jbG9ja19zdG9w
KQogCQl0bXAgfD0gQ0xPQ0tTVE9QOwogCi0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKSB7CisJ
aWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKSB7CiAJ
CXRtcCB8PSBCWFRfRFBIWV9ERUZFQVRVUkVfRU47CiAJCWlmICghaXNfY21kX21vZGUoaW50ZWxf
ZHNpKSkKIAkJCXRtcCB8PSBCWFRfREVGRUFUVVJFX0RQSV9GSUZPX0NUUjsKQEAgLTE0OTIsNyAr
MTQ5Myw4IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wcmVwYXJlKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICppbnRlbF9lbmNvZGVyLAogCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgTUlQSV9JTklU
X0NPVU5UKHBvcnQpLAogCQkJICAgICAgIHR4Y2xrZXNjKGludGVsX2RzaS0+ZXNjYXBlX2Nsa19k
aXYsIDEwMCkpOwogCi0JCWlmIChJU19HRU45X0xQKGRldl9wcml2KSAmJiAoIWludGVsX2RzaS0+
ZHVhbF9saW5rKSkgeworCQlpZiAoKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElTX0JST1hU
T04oZGV2X3ByaXYpKSAmJgorCQkgICAgIWludGVsX2RzaS0+ZHVhbF9saW5rKSB7CiAJCQkvKgog
CQkJICogQlhUIHNwZWMgc2F5cyB3cml0ZSBNSVBJX0lOSVRfQ09VTlQgZm9yCiAJCQkgKiBib3Ro
IHRoZSBwb3J0cywgZXZlbiBpZiBvbmx5IG9uZSBpcwpAQCAtMTU3MCw3ICsxNTcyLDcgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZHNpX3VucHJlcGFyZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
cikKIAkJLyogUGFuZWwgY29tbWFuZHMgY2FuIGJlIHNlbnQgd2hlbiBjbG9jayBpcyBpbiBMUDEx
ICovCiAJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBNSVBJX0RFVklDRV9SRUFEWShwb3J0KSwg
MHgwKTsKIAotCQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCisJCWlmIChJU19HRU1JTklMQUtF
KGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkKIAkJCWJ4dF9kc2lfcmVzZXRfY2xv
Y2tzKGVuY29kZXIsIHBvcnQpOwogCQllbHNlCiAJCQl2bHZfZHNpX3Jlc2V0X2Nsb2NrcyhlbmNv
ZGVyLCBwb3J0KTsKQEAgLTE4MjgsNyArMTgzMCw3IEBAIHZvaWQgdmx2X2RzaV9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpZiAoIWludGVsX2Jpb3NfaXNfZHNpX3By
ZXNlbnQoZGV2X3ByaXYsICZwb3J0KSkKIAkJcmV0dXJuOwogCi0JaWYgKElTX0dFTjlfTFAoZGV2
X3ByaXYpKQorCWlmIChJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9w
cml2KSkKIAkJZGV2X3ByaXYtPm1pcGlfbW1pb19iYXNlID0gQlhUX01JUElfQkFTRTsKIAllbHNl
CiAJCWRldl9wcml2LT5taXBpX21taW9fYmFzZSA9IFZMVl9NSVBJX0JBU0U7CkBAIC0xODU0LDcg
KzE4NTYsNyBAQCB2b2lkIHZsdl9kc2lfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCiAKIAlpbnRlbF9lbmNvZGVyLT5jb21wdXRlX2NvbmZpZyA9IGludGVsX2RzaV9jb21w
dXRlX2NvbmZpZzsKIAlpbnRlbF9lbmNvZGVyLT5wcmVfZW5hYmxlID0gaW50ZWxfZHNpX3ByZV9l
bmFibGU7Ci0JaWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQorCWlmIChJU19HRU1JTklMQUtFKGRl
dl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkKIAkJaW50ZWxfZW5jb2Rlci0+ZW5hYmxl
ID0gYnh0X2RzaV9lbmFibGU7CiAJaW50ZWxfZW5jb2Rlci0+ZGlzYWJsZSA9IGludGVsX2RzaV9k
aXNhYmxlOwogCWludGVsX2VuY29kZXItPnBvc3RfZGlzYWJsZSA9IGludGVsX2RzaV9wb3N0X2Rp
c2FibGU7CkBAIC0xODc0LDcgKzE4NzYsNyBAQCB2b2lkIHZsdl9kc2lfaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJICogT24gQllUL0NIViwgcGlwZSBBIG1hcHMgdG8g
TUlQSSBEU0kgcG9ydCBBLCBwaXBlIEIgbWFwcyB0byBNSVBJIERTSQogCSAqIHBvcnQgQy4gQlhU
IGlzbid0IGxpbWl0ZWQgbGlrZSB0aGlzLgogCSAqLwotCWlmIChJU19HRU45X0xQKGRldl9wcml2
KSkKKwlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikp
CiAJCWludGVsX2VuY29kZXItPnBpcGVfbWFzayA9IH4wOwogCWVsc2UgaWYgKHBvcnQgPT0gUE9S
VF9BKQogCQlpbnRlbF9lbmNvZGVyLT5waXBlX21hc2sgPSBCSVQoUElQRV9BKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2lycS5jCmluZGV4IDdlZWZiZGVjMjVhMi4uOWFmZjc5MDgxN2MwIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfaXJxLmMKQEAgLTE5NCw3ICsxOTQsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9ocGRf
aW5pdF9waW5zKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogCWlmIChESVNQ
TEFZX1ZFUihkZXZfcHJpdikgPj0gMTEpCiAJCWhwZC0+aHBkID0gaHBkX2dlbjExOwotCWVsc2Ug
aWYgKElTX0dFTjlfTFAoZGV2X3ByaXYpKQorCWVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3By
aXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKQogCQlocGQtPmhwZCA9IGhwZF9ieHQ7CiAJZWxz
ZSBpZiAoRElTUExBWV9WRVIoZGV2X3ByaXYpID49IDgpCiAJCWhwZC0+aHBkID0gaHBkX2JkdzsK
QEAgLTI0NTgsNyArMjQ1OCw3IEBAIGdlbjhfZGVfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFzdGVyX2N0bCkKIAkJCQlmb3VuZCA9IHRydWU7CiAJ
CQl9CiAKLQkJCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkgeworCQkJaWYgKElTX0dFTUlOSUxB
S0UoZGV2X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpKSB7CiAJCQkJdTMyIGhvdHBsdWdf
dHJpZ2dlciA9IGlpciAmIEJYVF9ERV9QT1JUX0hPVFBMVUdfTUFTSzsKIAogCQkJCWlmIChob3Rw
bHVnX3RyaWdnZXIpIHsKQEAgLTI0NzQsNyArMjQ3NCw4IEBAIGdlbjhfZGVfaXJxX2hhbmRsZXIo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFzdGVyX2N0bCkKIAkJCQl9
CiAJCQl9CiAKLQkJCWlmIChJU19HRU45X0xQKGRldl9wcml2KSAmJiAoaWlyICYgQlhUX0RFX1BP
UlRfR01CVVMpKSB7CisJCQlpZiAoKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElTX0JST1hU
T04oZGV2X3ByaXYpKSAmJgorCQkJICAgIChpaXIgJiBCWFRfREVfUE9SVF9HTUJVUykpIHsKIAkJ
CQlnbWJ1c19pcnFfaGFuZGxlcihkZXZfcHJpdik7CiAJCQkJZm91bmQgPSB0cnVlOwogCQkJfQpA
QCAtMzcxNyw3ICszNzE4LDcgQEAgc3RhdGljIHZvaWQgZ2VuOF9kZV9pcnFfcG9zdGluc3RhbGwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWlmIChESVNQTEFZX1ZFUihkZXZf
cHJpdikgPD0gMTApCiAJCWRlX21pc2NfbWFza2VkIHw9IEdFTjhfREVfTUlTQ19HU0U7CiAKLQlp
ZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCisJaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8
IElTX0JST1hUT04oZGV2X3ByaXYpKQogCQlkZV9wb3J0X21hc2tlZCB8PSBCWFRfREVfUE9SVF9H
TUJVUzsKIAogCWlmIChESVNQTEFZX1ZFUihkZXZfcHJpdikgPj0gMTEpIHsKQEAgLTM3MzIsNyAr
MzczMyw3IEBAIHN0YXRpYyB2b2lkIGdlbjhfZGVfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJZ2VuOF9kZV9waXBlX2ZsaXBfZG9uZV9tYXNrKGRl
dl9wcml2KTsKIAogCWRlX3BvcnRfZW5hYmxlcyA9IGRlX3BvcnRfbWFza2VkOwotCWlmIChJU19H
RU45X0xQKGRldl9wcml2KSkKKwlpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJP
WFRPTihkZXZfcHJpdikpCiAJCWRlX3BvcnRfZW5hYmxlcyB8PSBCWFRfREVfUE9SVF9IT1RQTFVH
X01BU0s7CiAJZWxzZSBpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkKIAkJZGVfcG9ydF9lbmFi
bGVzIHw9IEJEV19ERV9QT1JUX0hPVFBMVUdfTUFTSzsKQEAgLTQzMTcsNyArNDMxOCw3IEBAIHZv
aWQgaW50ZWxfaXJxX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQkJ
ZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGRnMV9ocGRfaXJxX3NldHVwOwogCQll
bHNlIGlmIChESVNQTEFZX1ZFUihkZXZfcHJpdikgPj0gMTEpCiAJCQlkZXZfcHJpdi0+ZGlzcGxh
eS5ocGRfaXJxX3NldHVwID0gZ2VuMTFfaHBkX2lycV9zZXR1cDsKLQkJZWxzZSBpZiAoSVNfR0VO
OV9MUChkZXZfcHJpdikpCisJCWVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElT
X0JST1hUT04oZGV2X3ByaXYpKQogCQkJZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9
IGJ4dF9ocGRfaXJxX3NldHVwOwogCQllbHNlIGlmIChJTlRFTF9QQ0hfVFlQRShkZXZfcHJpdikg
Pj0gUENIX0lDUCkKIAkJCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAgPSBpY3BfaHBk
X2lycV9zZXR1cDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCmluZGV4IDA2NmFiYWE3M2EwNi4uMzJm
MzAxY2EzYWIwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKQEAgLTM2NTQsMTMgKzM2NTQsMTMg
QEAgdTggaW50ZWxfZW5hYmxlZF9kYnVmX3NsaWNlc19tYXNrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKICAqLwogc3RhdGljIGJvb2wgc2tsX25lZWRzX21lbW9yeV9id193YShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0JcmV0dXJuIElTX0dFTjlfQkMo
ZGV2X3ByaXYpIHx8IElTX0JST1hUT04oZGV2X3ByaXYpOworCXJldHVybiBJU19ESVNQTEFZX1ZF
UihkZXZfcHJpdiwgOSk7CiB9CiAKIHN0YXRpYyBib29sCiBpbnRlbF9oYXNfc2FndihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0JcmV0dXJuIChJU19HRU45X0JDKGRldl9w
cml2KSB8fCBESVNQTEFZX1ZFUihkZXZfcHJpdikgPj0gMTEgfHwgSVNfQ0FOTk9OTEFLRShkZXZf
cHJpdikpICYmCisJcmV0dXJuIERJU1BMQVlfVkVSKGRldl9wcml2KSA+PSA5ICYmICFJU19MUChk
ZXZfcHJpdikgJiYKIAkJZGV2X3ByaXYtPnNhZ3Zfc3RhdHVzICE9IEk5MTVfU0FHVl9OT1RfQ09O
VFJPTExFRDsKIH0KIApAQCAtNTI1OCw3ICs1MjU4LDcgQEAgc3RhdGljIHZvaWQgc2tsX2NvbXB1
dGVfcGxhbmVfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJ
bGluZXMgPSBkaXZfcm91bmRfdXBfZml4ZWQxNihzZWxlY3RlZF9yZXN1bHQsCiAJCQkJICAgICB3
cC0+cGxhbmVfYmxvY2tzX3Blcl9saW5lKTsKIAotCWlmIChJU19HRU45X0JDKGRldl9wcml2KSB8
fCBJU19CUk9YVE9OKGRldl9wcml2KSkgeworCWlmIChJU19ESVNQTEFZX1ZFUihkZXZfcHJpdiwg
OSkpIHsKIAkJLyogRGlzcGxheSBXQSAjMTEyNTogc2tsLGJ4dCxrYmwgKi8KIAkJaWYgKGxldmVs
ID09IDAgJiYgd3AtPnJjX3N1cmZhY2UpCiAJCQlibG9ja3MgKz0gZml4ZWQxNl90b191MzJfcm91
bmRfdXAod3AtPnlfdGlsZV9taW5pbXVtKTsKQEAgLTUzNzUsNyArNTM3NSw3IEBAIHN0YXRpYyB2
b2lkIHNrbF9jb21wdXRlX3RyYW5zaXRpb25fd20oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAogCSAqIFdhRGlzYWJsZVRXTTpza2wsa2JsLGNmbCxieHQKIAkgKiBUcmFuc2l0aW9u
IFdNIGFyZSBub3QgcmVjb21tZW5kZWQgYnkgSFcgdGVhbSBmb3IgR0VOOQogCSAqLwotCWlmIChJ
U19HRU45X0JDKGRldl9wcml2KSB8fCBJU19CUk9YVE9OKGRldl9wcml2KSkKKwlpZiAoSVNfRElT
UExBWV9WRVIoZGV2X3ByaXYsIDkpKQogCQlyZXR1cm47CiAKIAlpZiAoRElTUExBWV9WRVIoZGV2
X3ByaXYpID49IDExKQotLSAKMi4yNS40CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5m
cmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0
aW5mby9pbnRlbC1nZngK

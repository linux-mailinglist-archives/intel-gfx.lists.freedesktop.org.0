Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 7FD03FC19E
	for <lists+intel-gfx@lfdr.de>; Thu, 14 Nov 2019 09:35:29 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 70C756E415;
	Thu, 14 Nov 2019 08:35:27 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CC7536E415
 for <intel-gfx@lists.freedesktop.org>; Thu, 14 Nov 2019 08:35:25 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19196837-1500050 
 for multiple; Thu, 14 Nov 2019 08:34:36 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 14 Nov 2019 08:34:36 +0000
Message-Id: <20191114083436.2261-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/selftests: Exercise rc6 handling
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UmVhZGluZyBmcm9tIENUWF9JTkZPIHVwc2V0cyByYzYsIHJlcXVpcmluZyB1cyB0byBkZXRlY3Qg
YW5kIHByZXZlbnQKcG9zc2libGUgcmM2IGNvbnRleHQgY29ycnVwdGlvbi4gUG9rZSBhdCB0aGUg
YmVhciEKClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNv
LnVrPgpDYzogSW1yZSBEZWFrIDxpbXJlLmRlYWtAaW50ZWwuY29tPgpDYzogTWlrYSBLdW9wcGFs
YSA8bWlrYS5rdW9wcGFsYUBsaW51eC5pbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfcmM2LmMgICAgICAgICAgIHwgIDQgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Qvc2VsZnRlc3RfZ3RfcG0uYyAgICAgIHwgMTMgKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9yYzYuYyAgICAgICAgfCA4OSArKysrKysrKysrKysrKysrKysrCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9yYzYuaCAgICAgICAgfCAxMiArKysKIC4uLi9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV9saXZlX3NlbGZ0ZXN0cy5oICB8ICAxICsKIDUgZmlsZXMgY2hh
bmdlZCwgMTE5IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9zZWxmdGVzdF9yYzYuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3JjNi5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfcmM2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yYzYu
YwppbmRleCBmN2MwYmFlYjM3OTMuLjBkZTM1ZDE4YTJiMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfcmM2LmMKQEAgLTc3NywzICs3NzcsNyBAQCB1NjQgaW50ZWxfcmM2X3Jlc2lkZW5jeV91
cyhzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYsIGk5MTVfcmVnX3QgcmVnKQogewogCXJldHVybiBESVZf
Uk9VTkRfVVBfVUxMKGludGVsX3JjNl9yZXNpZGVuY3lfbnMocmM2LCByZWcpLCAxMDAwKTsKIH0K
KworI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQorI2luY2x1ZGUgInNl
bGZ0ZXN0X3JjNi5jIgorI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9ndF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZ3Rf
cG0uYwppbmRleCBkMTc1MmYxNTcwMmEuLjFkNWJmOTNkMTI1OCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZ3RfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9zZWxmdGVzdF9ndF9wbS5jCkBAIC02LDYgKzYsNyBAQAogICovCiAKICNpbmNsdWRl
ICJzZWxmdGVzdF9sbGMuaCIKKyNpbmNsdWRlICJzZWxmdGVzdF9yYzYuaCIKIAogc3RhdGljIGlu
dCBsaXZlX2d0X3Jlc3VtZSh2b2lkICphcmcpCiB7CkBAIC01OCwzICs1OSwxNSBAQCBpbnQgaW50
ZWxfZ3RfcG1fbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAK
IAlyZXR1cm4gaW50ZWxfZ3RfbGl2ZV9zdWJ0ZXN0cyh0ZXN0cywgJmk5MTUtPmd0KTsKIH0KKwor
aW50IGludGVsX2d0X3BtX2xhdGVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQoreworCXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7CisJ
CVNVQlRFU1QobGl2ZV9yYzZfY3R4KSwKKwl9OworCisJaWYgKGludGVsX2d0X2lzX3dlZGdlZCgm
aTkxNS0+Z3QpKQorCQlyZXR1cm4gMDsKKworCXJldHVybiBpbnRlbF9ndF9saXZlX3N1YnRlc3Rz
KHRlc3RzLCAmaTkxNS0+Z3QpOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Qvc2VsZnRlc3RfcmM2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9yYzYu
YwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjliMDIwMTZjODFhOQot
LS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3JjNi5j
CkBAIC0wLDAgKzEsODkgQEAKKy8qCisgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisg
KgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaW5jbHVk
ZSAiaW50ZWxfY29udGV4dC5oIgorI2luY2x1ZGUgImludGVsX2VuZ2luZV9wbS5oIgorI2luY2x1
ZGUgImludGVsX2d0X3JlcXVlc3RzLmgiCisjaW5jbHVkZSAiaW50ZWxfcmluZy5oIgorI2luY2x1
ZGUgInNlbGZ0ZXN0X3JjNi5oIgorCitzdGF0aWMgY29uc3QgdTMyICpfX2xpdmVfcmM2X2N0eChz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCit7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJ
dTMyIGNvbnN0ICpyZXN1bHQ7CisJdTMyICpjczsKKworCXJxID0gaW50ZWxfY29udGV4dF9jcmVh
dGVfcmVxdWVzdChjZSk7CisJaWYgKElTX0VSUihycSkpCisJCXJldHVybiBFUlJfQ0FTVChycSk7
CisKKwljcyA9IGludGVsX3JpbmdfYmVnaW4ocnEsIDQpOworCWlmIChJU19FUlIoY3MpKSB7CisJ
CWk5MTVfcmVxdWVzdF9hZGQocnEpOworCQlyZXR1cm4gY3M7CisJfQorCisJKmNzKysgPSBNSV9T
VE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1VTRV9HR1RUOworCSpjcysrID0gMHhBMzAwOyAv
KiBDVFhfSU5GTyAqLworCSpjcysrID0gY2UtPnRpbWVsaW5lLT5od3NwX29mZnNldCArIDg7CisJ
KmNzKysgPSAwOworCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCisJcmVzdWx0ID0gcnEt
Pmh3c3Bfc2Vxbm8gKyAyOworCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCisJcmV0dXJuIHJlc3Vs
dDsKK30KKworaW50IGxpdmVfcmM2X2N0eCh2b2lkICphcmcpCit7CisJc3RydWN0IGludGVsX2d0
ICpndCA9IGFyZzsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRl
bF9lbmdpbmVfaWQgaWQ7CisKKwkvKiBBIHJlYWQgb2YgQ1RYX0lORk8gdXBzZXRzIHJjNi4gUG9r
ZSB0aGUgYmVhciEgKi8KKworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgeworCQlp
bnQgcGFzczsKKworCQlmb3IgKHBhc3MgPSAwOyBwYXNzIDwgMjsgcGFzcysrKSB7CisJCQlzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqY2U7CisJCQl1bnNpZ25lZCBpbnQgcmVzZXRzID0KKwkJCQlpOTE1
X3Jlc2V0X2VuZ2luZV9jb3VudCgmZ3QtPmk5MTUtPmdwdV9lcnJvciwKKwkJCQkJCQllbmdpbmUp
OworCQkJY29uc3QgdTMyICpyZXM7CisKKwkJCS8qIFVzZSBhIHNhY3JpZmljYWwgY29udGV4dCAq
LworCQkJY2UgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUtPmtlcm5lbF9jb250ZXh0LT5n
ZW1fY29udGV4dCwKKwkJCQkJCSAgZW5naW5lKTsKKwkJCWlmIChJU19FUlIoY2UpKQorCQkJCXJl
dHVybiBQVFJfRVJSKGNlKTsKKworCQkJaW50ZWxfZW5naW5lX3BtX2dldChlbmdpbmUpOworCQkJ
cmVzID0gX19saXZlX3JjNl9jdHgoY2UpOworCQkJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUp
OworCQkJaW50ZWxfY29udGV4dF9wdXQoY2UpOworCQkJaWYgKElTX0VSUihyZXMpKQorCQkJCXJl
dHVybiBQVFJfRVJSKHJlcyk7CisKKwkJCWludGVsX2d0X3JldGlyZV9yZXF1ZXN0cyhndCk7CisJ
CQlpbnRlbF9ndF9wbV93YWl0X2Zvcl9pZGxlKGd0KTsKKworCQkJcHJfZGVidWcoIiVzOiBDVFhf
SU5GTz0lMHhcbiIsCisJCQkJIGVuZ2luZS0+bmFtZSwgUkVBRF9PTkNFKCpyZXMpKTsKKwkJCWlm
IChyZXNldHMgIT0KKwkJCSAgICBpOTE1X3Jlc2V0X2VuZ2luZV9jb3VudCgmZ3QtPmk5MTUtPmdw
dV9lcnJvciwKKwkJCQkJCSAgICBlbmdpbmUpKSB7CisJCQkJcHJfZXJyKCIlczogR1BVIHJlc2V0
IHJlcXVpcmVkXG4iLAorCQkJCSAgICAgICBlbmdpbmUtPm5hbWUpOworCQkJCWFkZF90YWludF9m
b3JfQ0koVEFJTlRfV0FSTik7CisJCQkJcmV0dXJuIC1FSU87CisJCQl9CisJCX0KKwl9CisKKwly
ZXR1cm4gMDsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X3JjNi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmM2LmgKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4yMzBjNmI0YzdkYzAKLS0tIC9kZXYvbnVs
bAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9yYzYuaApAQCAtMCwwICsx
LDEyIEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENvcHly
aWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2lmbmRlZiBTRUxGVEVTVF9S
QzZfSAorI2RlZmluZSBTRUxGVEVTVF9SQzZfSAorCitpbnQgbGl2ZV9yYzZfY3R4KHZvaWQgKmFy
Zyk7CisKKyNlbmRpZiAvKiBTRUxGVEVTVF9SQzZfSCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfbGl2ZV9zZWxmdGVzdHMuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2xpdmVfc2VsZnRlc3RzLmgKaW5kZXggNGIzY2FjNzNl
MjkxLi5kYjU1NjU2NzkwNDUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0
ZXN0cy9pOTE1X2xpdmVfc2VsZnRlc3RzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfbGl2ZV9zZWxmdGVzdHMuaApAQCAtMzgsMyArMzgsNCBAQCBzZWxmdGVzdCho
YW5nY2hlY2ssIGludGVsX2hhbmdjaGVja19saXZlX3NlbGZ0ZXN0cykKIHNlbGZ0ZXN0KGV4ZWNs
aXN0cywgaW50ZWxfZXhlY2xpc3RzX2xpdmVfc2VsZnRlc3RzKQogc2VsZnRlc3QoZ3VjLCBpbnRl
bF9ndWNfbGl2ZV9zZWxmdGVzdCkKIHNlbGZ0ZXN0KHBlcmYsIGk5MTVfcGVyZl9saXZlX3NlbGZ0
ZXN0cykKK3NlbGZ0ZXN0KGxhdGVfZ3RfcG0sIGludGVsX2d0X3BtX2xhdGVfc2VsZnRlc3RzKQot
LSAKMi4yNC4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

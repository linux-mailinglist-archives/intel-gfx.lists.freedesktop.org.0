Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3770D114329
	for <lists+intel-gfx@lfdr.de>; Thu,  5 Dec 2019 16:00:00 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7774F6E12C;
	Thu,  5 Dec 2019 14:59:58 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1ED5D6E12C
 for <intel-gfx@lists.freedesktop.org>; Thu,  5 Dec 2019 14:59:56 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19472260-1500050 
 for multiple; Thu, 05 Dec 2019 14:59:36 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  5 Dec 2019 14:59:34 +0000
Message-Id: <20191205145934.663183-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/gt: Save irqstate around
 virtual_context_destroy
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgdmlydHVhbF9jb250ZXh0X2Rlc3Ryb3koKSBtYXkgYmUgY2FsbGVkIGZyb20gYSByZXF1ZXN0
IHNpZ25hbCwgaXQgbWF5CmJlIGNhbGxlZCBmcm9tIGluc2lkZSBhbiBpcnEtb2ZmIHNlY3Rpb24s
IGFuZCBzbyB3ZSBuZWVkIHRvIGRvIGEgZnVsbApzYXZlL3Jlc3RvcmUgb2YgdGhlIGlycSBzdGF0
ZSByYXRoZXIgdGhhbiBibGluZGx5IHJlLWVuYWJsZSBpcnFzIHVwb24KdW5sb2NraW5nLgoKPDQ+
IFsxMTAuMDI0MjYyXSBXQVJOSU5HOiBpbmNvbnNpc3RlbnQgbG9jayBzdGF0ZQo8ND4gWzExMC4w
MjQyNzddIDUuNC4wLXJjOC1DSS1DSV9EUk1fNzQ4OSsgIzEgVGFpbnRlZDogRyAgICAgVQo8ND4g
WzExMC4wMjQyOTJdIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCjw0PiBbMTEwLjAy
NDMwNV0gaW5jb25zaXN0ZW50IHtJTi1IQVJESVJRLVd9IC0+IHtIQVJESVJRLU9OLVd9IHVzYWdl
Lgo8ND4gWzExMC4wMjQzMjNdIGt3b3JrZXIvMDowLzUgW0hDMFswXTpTQzBbMF06SEUxOlNFMV0g
dGFrZXM6Cjw0PiBbMTEwLjAyNDMzOF0gZmZmZjg4ODI2YTBjN2ExOCAoJigmcnEtPmxvY2spLT5y
bG9jayl7Py4tLn0sIGF0OiBpOTE1X3JlcXVlc3RfcmV0aXJlKzB4MjIxLzB4OTMwIFtpOTE1XQo8
ND4gWzExMC4wMjQ1OTJdIHtJTi1IQVJESVJRLVd9IHN0YXRlIHdhcyByZWdpc3RlcmVkIGF0Ogo8
ND4gWzExMC4wMjQ2MTJdICAgbG9ja19hY3F1aXJlKzB4YTcvMHgxYzAKPDQ+IFsxMTAuMDI0NjI3
XSAgIF9yYXdfc3Bpbl9sb2NrX2lycXNhdmUrMHgzMy8weDUwCjw0PiBbMTEwLjAyNDc4OF0gICBp
bnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKzB4MzhjLzB4NjAwIFtpOTE1XQo8ND4gWzExMC4w
MjQ4MDhdICAgaXJxX3dvcmtfcnVuX2xpc3QrMHg0OS8weDcwCjw0PiBbMTEwLjAyNDgyNF0gICBp
cnFfd29ya19ydW4rMHgyNi8weDUwCjw0PiBbMTEwLjAyNDgzOV0gICBzbXBfaXJxX3dvcmtfaW50
ZXJydXB0KzB4NDQvMHgxZTAKPDQ+IFsxMTAuMDI0ODU1XSAgIGlycV93b3JrX2ludGVycnVwdCsw
eGYvMHgyMAo8ND4gWzExMC4wMjQ4NzFdICAgX19kb19zb2Z0aXJxKzB4YjcvMHg0N2YKPDQ+IFsx
MTAuMDI0ODg1XSAgIGlycV9leGl0KzB4YmEvMHhjMAo8ND4gWzExMC4wMjQ4OThdICAgZG9fSVJR
KzB4ODMvMHgxNjAKPDQ+IFsxMTAuMDI0OTEwXSAgIHJldF9mcm9tX2ludHIrMHgwLzB4MWQKPDQ+
IFsxMTAuMDI0OTIyXSBpcnEgZXZlbnQgc3RhbXA6IDE3Mjg2NAo8ND4gWzExMC4wMjQ5MzhdIGhh
cmRpcnFzIGxhc3QgIGVuYWJsZWQgYXQgKDE3Mjg2Myk6IFs8ZmZmZmZmZmY4MTllYTIxND5dIF9y
YXdfc3Bpbl91bmxvY2tfaXJxKzB4MjQvMHg1MAo8ND4gWzExMC4wMjQ5NjNdIGhhcmRpcnFzIGxh
c3QgZGlzYWJsZWQgYXQgKDE3Mjg2NCk6IFs8ZmZmZmZmZmY4MTllOWZiYT5dIF9yYXdfc3Bpbl9s
b2NrX2lycSsweGEvMHg0MAo8ND4gWzExMC4wMjQ5ODhdIHNvZnRpcnFzIGxhc3QgIGVuYWJsZWQg
YXQgKDE3MjgxMik6IFs8ZmZmZmZmZmY4MWMwMDM4NT5dIF9fZG9fc29mdGlycSsweDM4NS8weDQ3
Zgo8ND4gWzExMC4wMjUwMTJdIHNvZnRpcnFzIGxhc3QgZGlzYWJsZWQgYXQgKDE3Mjc5Nyk6IFs8
ZmZmZmZmZmY4MTBiODI5YT5dIGlycV9leGl0KzB4YmEvMHhjMAo8ND4gWzExMC4wMjUwMzFdCm90
aGVyIGluZm8gdGhhdCBtaWdodCBoZWxwIHVzIGRlYnVnIHRoaXM6Cjw0PiBbMTEwLjAyNTA0OV0g
IFBvc3NpYmxlIHVuc2FmZSBsb2NraW5nIHNjZW5hcmlvOgoKPDQ+IFsxMTAuMDI1MDY1XSAgICAg
ICAgQ1BVMAo8ND4gWzExMC4wMjUwNzVdICAgICAgICAtLS0tCjw0PiBbMTEwLjAyNTA4NF0gICBs
b2NrKCYoJnJxLT5sb2NrKS0+cmxvY2spOwo8ND4gWzExMC4wMjUwOTldICAgPEludGVycnVwdD4K
PDQ+IFsxMTAuMDI1MTA5XSAgICAgbG9jaygmKCZycS0+bG9jayktPnJsb2NrKTsKPDQ+IFsxMTAu
MDI1MTI0XQogKioqIERFQURMT0NLICoqKgoKPDQ+IFsxMTAuMDI1MTQ0XSA0IGxvY2tzIGhlbGQg
Ynkga3dvcmtlci8wOjAvNToKPDQ+IFsxMTAuMDI1MTU2XSAgIzA6IGZmZmY4ODgyNzU4OGY1Mjgg
KCh3cV9jb21wbGV0aW9uKWV2ZW50cyl7Ky4rLn0sIGF0OiBwcm9jZXNzX29uZV93b3JrKzB4MWRl
LzB4NjIwCjw0PiBbMTEwLjAyNTE4N10gICMxOiBmZmZmYzkwMDAwMDZmZTc4ICgod29ya19jb21w
bGV0aW9uKSgmZW5naW5lLT5yZXRpcmVfd29yaykpeysuKy59LCBhdDogcHJvY2Vzc19vbmVfd29y
aysweDFkZS8weDYyMAo8ND4gWzExMC4wMjUyMTldICAjMjogZmZmZjg4ODI1NjA1ZTI3MCAoJmtl
cm5lbCMyKXsrLisufSwgYXQ6IGVuZ2luZV9yZXRpcmUrMHg1Ny8weGUwIFtpOTE1XQo8ND4gWzEx
MC4wMjU0MDVdICAjMzogZmZmZjg4ODI2YTBjN2ExOCAoJigmcnEtPmxvY2spLT5ybG9jayl7Py4t
Ln0sIGF0OiBpOTE1X3JlcXVlc3RfcmV0aXJlKzB4MjIxLzB4OTMwIFtpOTE1XQo8ND4gWzExMC4w
MjU2MzRdCnN0YWNrIGJhY2t0cmFjZToKPDQ+IFsxMTAuMDI1NjUzXSBDUFU6IDAgUElEOiA1IENv
bW06IGt3b3JrZXIvMDowIFRhaW50ZWQ6IEcgICAgIFUgICAgICAgICAgICA1LjQuMC1yYzgtQ0kt
Q0lfRFJNXzc0ODkrICMxCjw0PiBbMTEwLjAyNTY3NV0gSGFyZHdhcmUgbmFtZTogIC9OVUM3aTVC
TkIsIEJJT1MgQk5LQkwzNTcuODZBLjAwNTQuMjAxNy4xMDI1LjE4MjIgMTAvMjUvMjAxNwo8ND4g
WzExMC4wMjU4NTZdIFdvcmtxdWV1ZTogZXZlbnRzIGVuZ2luZV9yZXRpcmUgW2k5MTVdCjw0PiBb
MTEwLjAyNTg3Ml0gQ2FsbCBUcmFjZToKPDQ+IFsxMTAuMDI1ODkxXSAgZHVtcF9zdGFjaysweDcx
LzB4OWIKPDQ+IFsxMTAuMDI1OTA3XSAgbWFya19sb2NrKzB4NDlhLzB4NTAwCjw0PiBbMTEwLjAy
NTkyNl0gID8gcHJpbnRfc2hvcnRlc3RfbG9ja19kZXBlbmRlbmNpZXMrMHgyMDAvMHgyMDAKPDQ+
IFsxMTAuMDI1OTQ2XSAgbWFya19oZWxkX2xvY2tzKzB4NDkvMHg3MAo8ND4gWzExMC4wMjU5NjJd
ICA/IF9yYXdfc3Bpbl91bmxvY2tfaXJxKzB4MjQvMHg1MAo8ND4gWzExMC4wMjU5NzhdICBsb2Nr
ZGVwX2hhcmRpcnFzX29uKzB4YTIvMHgxYzAKPDQ+IFsxMTAuMDI1OTk1XSAgX3Jhd19zcGluX3Vu
bG9ja19pcnErMHgyNC8weDUwCjw0PiBbMTEwLjAyNjE3MV0gIHZpcnR1YWxfY29udGV4dF9kZXN0
cm95KzB4YzUvMHgyZTAgW2k5MTVdCjw0PiBbMTEwLjAyNjM3Nl0gIF9fYWN0aXZlX3JldGlyZSsw
eGI0LzB4MjkwIFtpOTE1XQo8ND4gWzExMC4wMjYzOTZdICBkbWFfZmVuY2Vfc2lnbmFsX2xvY2tl
ZCsweDllLzB4MWIwCjw0PiBbMTEwLjAyNjYxM10gIGk5MTVfcmVxdWVzdF9yZXRpcmUrMHg0NTEv
MHg5MzAgW2k5MTVdCjw0PiBbMTEwLjAyNjc2Nl0gIHJldGlyZV9yZXF1ZXN0cysweDRkLzB4NjAg
W2k5MTVdCjw0PiBbMTEwLjAyNjkxOV0gIGVuZ2luZV9yZXRpcmUrMHg2My8weGUwIFtpOTE1XQoK
Rml4ZXM6IDZkMDY3NzllODY3MiAoImRybS9pOTE1OiBMb2FkIGJhbGFuY2luZyBhY3Jvc3MgYSB2
aXJ0dWFsIGVuZ2luZSIpClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMt
d2lsc29uLmNvLnVrPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNv
bT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyB8IDUgKysrLS0KIDEg
ZmlsZSBjaGFuZ2VkLCAzIGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9scmMuYwppbmRleCBhNzQzODc2NjQ1ODMuLmM3ZWE4YTA1NTAwNSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKQEAgLTQyMDAsMTcgKzQyMDAsMTggQEAgc3Rh
dGljIHZvaWQgdmlydHVhbF9jb250ZXh0X2Rlc3Ryb3koc3RydWN0IGtyZWYgKmtyZWYpCiAJZm9y
IChuID0gMDsgbiA8IHZlLT5udW1fc2libGluZ3M7IG4rKykgewogCQlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICpzaWJsaW5nID0gdmUtPnNpYmxpbmdzW25dOwogCQlzdHJ1Y3QgcmJfbm9kZSAqbm9k
ZSA9ICZ2ZS0+bm9kZXNbc2libGluZy0+aWRdLnJiOworCQl1bnNpZ25lZCBsb25nIGZsYWdzOwog
CiAJCWlmIChSQl9FTVBUWV9OT0RFKG5vZGUpKQogCQkJY29udGludWU7CiAKLQkJc3Bpbl9sb2Nr
X2lycSgmc2libGluZy0+YWN0aXZlLmxvY2spOworCQlzcGluX2xvY2tfaXJxc2F2ZSgmc2libGlu
Zy0+YWN0aXZlLmxvY2ssIGZsYWdzKTsKIAogCQkvKiBEZXRhY2htZW50IGlzIGxhemlseSBwZXJm
b3JtZWQgaW4gdGhlIGV4ZWNsaXN0cyB0YXNrbGV0ICovCiAJCWlmICghUkJfRU1QVFlfTk9ERShu
b2RlKSkKIAkJCXJiX2VyYXNlX2NhY2hlZChub2RlLCAmc2libGluZy0+ZXhlY2xpc3RzLnZpcnR1
YWwpOwogCi0JCXNwaW5fdW5sb2NrX2lycSgmc2libGluZy0+YWN0aXZlLmxvY2spOworCQlzcGlu
X3VubG9ja19pcnFyZXN0b3JlKCZzaWJsaW5nLT5hY3RpdmUubG9jaywgZmxhZ3MpOwogCX0KIAlH
RU1fQlVHX09OKF9fdGFza2xldF9pc19zY2hlZHVsZWQoJnZlLT5iYXNlLmV4ZWNsaXN0cy50YXNr
bGV0KSk7CiAKLS0gCjIuMjQuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
aW50ZWwtZ2Z4

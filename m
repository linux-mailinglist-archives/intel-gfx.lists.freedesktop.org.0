Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 314631406F6
	for <lists+intel-gfx@lfdr.de>; Fri, 17 Jan 2020 10:52:51 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 752556F4C2;
	Fri, 17 Jan 2020 09:52:49 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7578C6F4C2
 for <intel-gfx@lists.freedesktop.org>; Fri, 17 Jan 2020 09:52:48 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by fmsmga101.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 17 Jan 2020 01:52:48 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.70,329,1574150400"; d="scan'208";a="424412522"
Received: from slisovsk-lenovo-ideapad-720s-13ikb.fi.intel.com ([10.237.72.89])
 by fmsmga005.fm.intel.com with ESMTP; 17 Jan 2020 01:52:46 -0800
From: Stanislav Lisovskiy <stanislav.lisovskiy@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 17 Jan 2020 11:50:26 +0200
Message-Id: <20200117095026.1113-6-stanislav.lisovskiy@intel.com>
X-Mailer: git-send-email 2.24.1.485.gad05a3d8e5
In-Reply-To: <20200117095026.1113-1-stanislav.lisovskiy@intel.com>
References: <20200117095026.1113-1-stanislav.lisovskiy@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v13 5/5] drm/i915: Correctly map DBUF slices to
 pipes
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QWRkZWQgcHJvcGVyIERCdWYgc2xpY2UgbWFwcGluZyB0byBjb3JyZXNwb25kZW50CnBpcGVzLCBk
ZXBlbmRpbmcgb24gcGlwZSBjb25maWd1cmF0aW9uIGFzIHN0YXRlZAppbiBCU3BlYy4KCnYyOgog
ICAgLSBSZW1vdmUgdW5uZWVkZWQgYnJhY2VzCiAgICAtIFN0b3AgdXNpbmcgbWFjcm8gZm9yIERC
dWYgYXNzaWdubWVudHMgYXMKICAgICAgaXQgc2VlbXMgdG8gcmVkdWNlIHJlYWRhYmlsaXR5LgoK
djM6IFN0YXJ0IHVzaW5nIGVuYWJsZWQgc2xpY2VzIG1hc2sgaW4gZGV2X3ByaXYKCnY0OiBSZW5h
bWVkICJlbmFibGVkX3NsaWNlcyIgdXNlZCBpbiBkZXZfcHJpdgogICAgdG8gImVuYWJsZWRfZGJ1
Zl9zbGljZXNfbWFzayIoTWF0dCBSb3BlcikKCnY1OiAtIFJlbW92ZWQgcmVkdW5kYW50IHBhcmFt
ZXRlcnMgZnJvbQogICAgICBpbnRlbF9nZXRfZGRiX3NpemUgZnVuY3Rpb24uKE1hdHQgUm9wZXIp
CiAgICAtIE1hZGUgaTkxNV9wb3NzaWJsZV9kYnVmX3NsaWNlcyBzdGF0aWMoTWF0dCBSb3BlcikK
ICAgIC0gUmVuYW1lZCB0b3RhbF93aWR0aCBpbnRvIHRvdGFsX3dpZHRoX2luX3JhbmdlCiAgICAg
IHNvIHRoYXQgaXQgbm93IHJlZmxlY3RzIHRoYXQgdGhpcyBpcyBub3QKICAgICAgYSB0b3RhbCBw
aXBlIHdpZHRoIGJ1dCB0aGUgb25lIGluIGN1cnJlbnQKICAgICAgZGJ1ZiBzbGljZSBhbGxvd2Vk
IHJhbmdlIGZvciBwaXBlLihNYXR0IFJvcGVyKQogICAgLSBSZW1vdmVkIDR0aCBwaXBlIGZvciBJ
Q0wgaW4gREJ1ZiBhc3NpZ25tZW50CiAgICAgIHRhYmxlKE1hdHQgUm9wZXIpCiAgICAtIEZpeGVk
IHdyb25nIERCdWYgc2xpY2UgaW4gREJ1ZiB0YWJsZSBmb3IgVEdMCiAgICAgIChNYXR0IFJvcGVy
KQogICAgLSBBZGRlZCBjb21tZW50IHJlZ2FyZGluZyB3aHkgd2UgY3VycmVudGx5IG5vdAogICAg
ICB1c2luZyBwaXBlIHJhdGlvIGZvciBEQnVmIGFzc2lnbm1lbnQgZm9yIElDTAoKdjY6IC0gQ2hh
bmdlZCB1MzIgdG8gdW5zaWduZWQgaW50IGluCiAgICAgIGljbF9nZXRfZmlyc3RfZGJ1Zl9zbGlj
ZV9vZmZzZXQgZnVuY3Rpb24gc2lnbmF0dXJlCiAgICAgIChWaWxsZSBTeXJqw6Rsw6QpCiAgICAt
IENoYW5nZWQgYWxzbyB1MzIgdG8gdTggaW4gZGJ1ZiBzbGljZSBtYXNrIHN0cnVjdHVyZQogICAg
ICAoVmlsbGUgU3lyasOkbMOkKQogICAgLSBTd2l0Y2hlZCBmcm9tIERCVUZfUzFfQklUIHRvIGVu
dW0gKyBleHBsaWNpdAogICAgICBCSVQoREJVRl9TMSkgYWNjZXNzKFZpbGxlIFN5cmrDpGzDpCkK
ICAgIC0gU3dpdGNoZWQgdG8gbmFtZWQgaW5pdGlhbGl6ZXJzIGluIERCdWYgYXNzaWdubWVudAog
ICAgICBhcnJheXMoVmlsbGUgU3lyasOkbMOkKQogICAgLSBEQnVmIGFzc2lnbm1lbnQgYXJyYXlz
IG5vdyB1c2UgYXV0b2dlbmVyYXRpb24gdG9vbAogICAgICBmcm9tCiAgICAgIGh0dHBzOi8vcGF0
Y2h3b3JrLmZyZWVkZXNrdG9wLm9yZy9zZXJpZXMvNzA0OTMvCiAgICAgIHRvIGF2b2lkIHR5cG9z
LgogICAgLSBSZW5hbWVkIGk5MTVfZmluZF9waXBlX2NvbmYgdG8gKl9jb21wdXRlX2RidWZfc2xp
Y2VzCiAgICAgIChWaWxsZSBTeXJqw6Rsw6QpCiAgICAtIENoYW5nZWQgcGxhdGZvcm1zIG9yZGVy
aW5nIGluIHNrbF9jb21wdXRlX2RidWZfc2xpY2VzCiAgICAgIHRvIGJlIGZyb20gbmV3ZXN0IHRv
IG9sZGVzdChWaWxsZSBTeXJqw6Rsw6QpCgp2NzogLSBOb3cgT1JpbmcgYXNzaWduZWQgREJ1ZiBz
bGljZSBjb25maWcgYWx3YXlzIHdpdGggREJVRl9TMQogICAgICBiZWNhdXNlIHNsaWNlIDEgaGFz
IHRvIGJlIGNvbnN0YW50bHkgcG93ZXJlZCBvbi4KICAgICAgKFZpbGxlIFN5cmrDpGzDpCkKClNp
Z25lZC1vZmYtYnk6IFN0YW5pc2xhdiBMaXNvdnNraXkgPHN0YW5pc2xhdi5saXNvdnNraXlAaW50
ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMgfCAzOTUgKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrLS0KIDEgZmlsZSBjaGFuZ2VkLCAzNzcgaW5zZXJ0aW9u
cygrKSwgMTggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKaW5kZXggYjRiMjkx
ZDQyNDRiLi5iOWNmYmJlYWVmOGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwpAQCAtMzg1Niwx
MyArMzg1NiwyOSBAQCBib29sIGludGVsX2Nhbl9lbmFibGVfc2FndihzdHJ1Y3QgaW50ZWxfYXRv
bWljX3N0YXRlICpzdGF0ZSkKIAlyZXR1cm4gdHJ1ZTsKIH0KIAotc3RhdGljIHUxNiBpbnRlbF9n
ZXRfZGRiX3NpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJICAgICAg
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCi0JCQkgICAgICBjb25z
dCB1NjQgdG90YWxfZGF0YV9yYXRlLAotCQkJICAgICAgY29uc3QgaW50IG51bV9hY3RpdmUpCisv
KgorICogQ2FsY3VsYXRlIGluaXRpYWwgREJ1ZiBzbGljZSBvZmZzZXQsIGJhc2VkIG9uIHNsaWNl
IHNpemUKKyAqIGFuZCBtYXNrKGkuZSBpZiBzbGljZSBzaXplIGlzIDEwMjQgYW5kIHNlY29uZCBz
bGljZSBpcyBlbmFibGVkCisgKiBvZmZzZXQgd291bGQgYmUgMTAyNCkKKyAqLworc3RhdGljIHVu
c2lnbmVkIGludAoraWNsX2dldF9maXJzdF9kYnVmX3NsaWNlX29mZnNldCh1MzIgZGJ1Zl9zbGlj
ZV9tYXNrLAorCQkJCXUzMiBzbGljZV9zaXplLAorCQkJCXUzMiBkZGJfc2l6ZSkKK3sKKwl1bnNp
Z25lZCBpbnQgb2Zmc2V0ID0gMDsKKworCWlmICghZGJ1Zl9zbGljZV9tYXNrKQorCQlyZXR1cm4g
MDsKKworCW9mZnNldCA9IChmZnMoZGJ1Zl9zbGljZV9tYXNrKSAtIDEpICogc2xpY2Vfc2l6ZTsK
KworCVdBUk5fT04ob2Zmc2V0ID49IGRkYl9zaXplKTsKKwlyZXR1cm4gb2Zmc2V0OworfQorCitz
dGF0aWMgdTE2IGludGVsX2dldF9kZGJfc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCiB7Ci0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+
dWFwaS5zdGF0ZTsKLQlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICppbnRlbF9zdGF0ZSA9IHRv
X2ludGVsX2F0b21pY19zdGF0ZShzdGF0ZSk7CiAJdTE2IGRkYl9zaXplID0gSU5URUxfSU5GTyhk
ZXZfcHJpdiktPmRkYl9zaXplOwogCiAJV0FSTl9PTihkZGJfc2l6ZSA9PSAwKTsKQEAgLTM4NzAs
MTIgKzM4ODYsMTIgQEAgc3RhdGljIHUxNiBpbnRlbF9nZXRfZGRiX3NpemUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAogCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpCiAJ
CXJldHVybiBkZGJfc2l6ZSAtIDQ7IC8qIDQgYmxvY2tzIGZvciBieXBhc3MgcGF0aCBhbGxvY2F0
aW9uICovCiAKLQlpbnRlbF9zdGF0ZS0+ZW5hYmxlZF9kYnVmX3NsaWNlc19tYXNrID0gQklUKERC
VUZfUzEpOwotCWRkYl9zaXplIC89IDI7Ci0KIAlyZXR1cm4gZGRiX3NpemU7CiB9CiAKK3N0YXRp
YyB1OCBza2xfY29tcHV0ZV9kYnVmX3NsaWNlcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKKwkJCQkgIHUzMiBhY3RpdmVfcGlwZXMpOworCiBzdGF0aWMgdm9pZAog
c2tsX2RkYl9nZXRfcGlwZV9hbGxvY2F0aW9uX2xpbWl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCiAJCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCkBAIC0zODg3LDEwICszOTAzLDE3IEBAIHNrbF9kZGJfZ2V0X3BpcGVfYWxsb2NhdGlv
bl9saW1pdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCXN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgKmludGVsX3N0YXRlID0gdG9faW50ZWxfYXRvbWljX3N0YXRlKHN0YXRl
KTsKIAlzdHJ1Y3QgZHJtX2NydGMgKmZvcl9jcnRjID0gY3J0Y19zdGF0ZS0+dWFwaS5jcnRjOwog
CWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOwotCXUzMiBwaXBlX3dpZHRoID0gMCwgdG90
YWxfd2lkdGggPSAwLCB3aWR0aF9iZWZvcmVfcGlwZSA9IDA7CisJdTMyIHBpcGVfd2lkdGggPSAw
LCB0b3RhbF93aWR0aF9pbl9yYW5nZSA9IDAsIHdpZHRoX2JlZm9yZV9waXBlID0gMDsKIAllbnVt
IHBpcGUgZm9yX3BpcGUgPSB0b19pbnRlbF9jcnRjKGZvcl9jcnRjKS0+cGlwZTsKIAl1MTYgZGRi
X3NpemU7CisJdTMyIGRkYl9yYW5nZV9zaXplOwogCXUzMiBpOworCXUzMiBkYnVmX3NsaWNlX21h
c2s7CisJdTMyIGFjdGl2ZV9waXBlczsKKwl1MzIgb2Zmc2V0OworCXUzMiBzbGljZV9zaXplOwor
CXUzMiB0b3RhbF9zbGljZV9tYXNrOworCXUzMiBzdGFydCwgZW5kOwogCiAJaWYgKFdBUk5fT04o
IXN0YXRlKSB8fCAhY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKSB7CiAJCWFsbG9jLT5zdGFydCA9IDA7
CkBAIC0zOTAwLDEyICszOTIzLDE1IEBAIHNrbF9kZGJfZ2V0X3BpcGVfYWxsb2NhdGlvbl9saW1p
dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCX0KIAogCWlmIChpbnRlbF9z
dGF0ZS0+YWN0aXZlX3BpcGVfY2hhbmdlcykKLQkJKm51bV9hY3RpdmUgPSBod2VpZ2h0OChpbnRl
bF9zdGF0ZS0+YWN0aXZlX3BpcGVzKTsKKwkJYWN0aXZlX3BpcGVzID0gaW50ZWxfc3RhdGUtPmFj
dGl2ZV9waXBlczsKIAllbHNlCi0JCSpudW1fYWN0aXZlID0gaHdlaWdodDgoZGV2X3ByaXYtPmFj
dGl2ZV9waXBlcyk7CisJCWFjdGl2ZV9waXBlcyA9IGRldl9wcml2LT5hY3RpdmVfcGlwZXM7CisK
KwkqbnVtX2FjdGl2ZSA9IGh3ZWlnaHQ4KGFjdGl2ZV9waXBlcyk7CisKKwlkZGJfc2l6ZSA9IGlu
dGVsX2dldF9kZGJfc2l6ZShkZXZfcHJpdik7CiAKLQlkZGJfc2l6ZSA9IGludGVsX2dldF9kZGJf
c2l6ZShkZXZfcHJpdiwgY3J0Y19zdGF0ZSwgdG90YWxfZGF0YV9yYXRlLAotCQkJCSAgICAgICpu
dW1fYWN0aXZlKTsKKwlzbGljZV9zaXplID0gZGRiX3NpemUgLyBJTlRFTF9JTkZPKGRldl9wcml2
KS0+bnVtX3N1cHBvcnRlZF9kYnVmX3NsaWNlczsKIAogCS8qCiAJICogSWYgdGhlIHN0YXRlIGRv
ZXNuJ3QgY2hhbmdlIHRoZSBhY3RpdmUgQ1JUQydzIG9yIHRoZXJlIGlzIG5vCkBAIC0zOTI0LDIy
ICszOTUwLDcxIEBAIHNrbF9kZGJfZ2V0X3BpcGVfYWxsb2NhdGlvbl9saW1pdHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCQlyZXR1cm47CiAJfQogCisJLyoKKwkgKiBHZXQg
YWxsb3dlZCBEQnVmIHNsaWNlcyBmb3IgY29ycmVzcG9uZGVudCBwaXBlIGFuZCBwbGF0Zm9ybS4K
KwkgKi8KKwlkYnVmX3NsaWNlX21hc2sgPSBza2xfY29tcHV0ZV9kYnVmX3NsaWNlcyhjcnRjX3N0
YXRlLCBhY3RpdmVfcGlwZXMpOworCisJRFJNX0RFQlVHX0tNUygiREJ1ZiBzbGljZSBtYXNrICV4
IHBpcGUgJWQgYWN0aXZlIHBpcGVzICV4XG4iLAorCQkgICAgICBkYnVmX3NsaWNlX21hc2ssCisJ
CSAgICAgIGZvcl9waXBlLCBhY3RpdmVfcGlwZXMpOworCisJLyoKKwkgKiBGaWd1cmUgb3V0IGF0
IHdoaWNoIERCdWYgc2xpY2Ugd2Ugc3RhcnQsIGkuZSBpZiB3ZSBzdGFydCBhdCBEYnVmIFMyCisJ
ICogYW5kIHNsaWNlIHNpemUgaXMgMTAyNCwgdGhlIG9mZnNldCB3b3VsZCBiZSAxMDI0CisJICov
CisJb2Zmc2V0ID0gaWNsX2dldF9maXJzdF9kYnVmX3NsaWNlX29mZnNldChkYnVmX3NsaWNlX21h
c2ssCisJCQkJCQkgc2xpY2Vfc2l6ZSwgZGRiX3NpemUpOworCisJLyoKKwkgKiBGaWd1cmUgb3V0
IHRvdGFsIHNpemUgb2YgYWxsb3dlZCBEQnVmIHNsaWNlcywgd2hpY2ggaXMgYmFzaWNhbGx5CisJ
ICogYSBudW1iZXIgb2YgYWxsb3dlZCBzbGljZXMgZm9yIHRoYXQgcGlwZSBtdWx0aXBsaWVkIGJ5
IHNsaWNlIHNpemUuCisJICogSW5zaWRlIG9mIHRoaXMKKwkgKiByYW5nZSBkZGIgZW50cmllcyBh
cmUgc3RpbGwgYWxsb2NhdGVkIGluIHByb3BvcnRpb24gdG8gZGlzcGxheSB3aWR0aC4KKwkgKi8K
KwlkZGJfcmFuZ2Vfc2l6ZSA9IGh3ZWlnaHQ4KGRidWZfc2xpY2VfbWFzaykgKiBzbGljZV9zaXpl
OworCiAJLyoKIAkgKiBXYXRlcm1hcmsvZGRiIHJlcXVpcmVtZW50IGhpZ2hseSBkZXBlbmRzIHVw
b24gd2lkdGggb2YgdGhlCiAJICogZnJhbWVidWZmZXIsIFNvIGluc3RlYWQgb2YgYWxsb2NhdGlu
ZyBEREIgZXF1YWxseSBhbW9uZyBwaXBlcwogCSAqIGRpc3RyaWJ1dGUgRERCIGJhc2VkIG9uIHJl
c29sdXRpb24vd2lkdGggb2YgdGhlIGRpc3BsYXkuCiAJICovCisJdG90YWxfc2xpY2VfbWFzayA9
IGRidWZfc2xpY2VfbWFzazsKIAlmb3JfZWFjaF9uZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShpbnRl
bF9zdGF0ZSwgY3J0YywgY3J0Y19zdGF0ZSwgaSkgewogCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9CiAJCQkmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9k
ZTsKIAkJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwogCQlpbnQgaGRpc3BsYXksIHZkaXNw
bGF5OworCQl1MzIgcGlwZV9kYnVmX3NsaWNlX21hc2s7CiAKLQkJaWYgKCFjcnRjX3N0YXRlLT5o
dy5lbmFibGUpCisJCWlmICghY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQorCQkJY29udGludWU7CisK
KwkJcGlwZV9kYnVmX3NsaWNlX21hc2sgPSBza2xfY29tcHV0ZV9kYnVmX3NsaWNlcyhjcnRjX3N0
YXRlLAorCQkJCQkJCSAgICAgICBhY3RpdmVfcGlwZXMpOworCisJCS8qCisJCSAqIEFjY29yZGlu
ZyB0byBCU3BlYyBwaXBlIGNhbiBzaGFyZSBvbmUgZGJ1ZiBzbGljZSB3aXRoIGFub3RoZXIKKwkJ
ICogcGlwZXMgb3IgcGlwZSBjYW4gdXNlIG11bHRpcGxlIGRidWZzLCBpbiBib3RoIGNhc2VzIHdl
CisJCSAqIGFjY291bnQgZm9yIG90aGVyIHBpcGVzIG9ubHkgaWYgdGhleSBoYXZlIGV4YWN0bHkg
c2FtZSBtYXNrLgorCQkgKiBIb3dldmVyIHdlIG5lZWQgdG8gYWNjb3VudCBob3cgbWFueSBzbGlj
ZXMgd2Ugc2hvdWxkIGVuYWJsZQorCQkgKiBpbiB0b3RhbC4KKwkJICovCisJCXRvdGFsX3NsaWNl
X21hc2sgfD0gcGlwZV9kYnVmX3NsaWNlX21hc2s7CisKKwkJLyoKKwkJICogRG8gbm90IGFjY291
bnQgcGlwZXMgdXNpbmcgb3RoZXIgc2xpY2Ugc2V0cworCQkgKiBsdWNraWx5IGFzIG9mIGN1cnJl
bnQgQlNwZWMgc2xpY2Ugc2V0cyBkbyBub3QgcGFydGlhbGx5CisJCSAqIGludGVyc2VjdChwaXBl
cyBzaGFyZSBlaXRoZXIgc2FtZSBvbmUgc2xpY2Ugb3Igc2FtZSBzbGljZSBzZXQKKwkJICogaS5l
IG5vIHBhcnRpYWwgaW50ZXJzZWN0aW9uKSwgc28gaXQgaXMgZW5vdWdoIHRvIGNoZWNrIGZvcgor
CQkgKiBlcXVhbGl0eSBmb3Igbm93LgorCQkgKi8KKwkJaWYgKGRidWZfc2xpY2VfbWFzayAhPSBw
aXBlX2RidWZfc2xpY2VfbWFzaykKIAkJCWNvbnRpbnVlOwogCiAJCWRybV9tb2RlX2dldF9odl90
aW1pbmcoYWRqdXN0ZWRfbW9kZSwgJmhkaXNwbGF5LCAmdmRpc3BsYXkpOwotCQl0b3RhbF93aWR0
aCArPSBoZGlzcGxheTsKKworCQl0b3RhbF93aWR0aF9pbl9yYW5nZSArPSBoZGlzcGxheTsKIAog
CQlpZiAocGlwZSA8IGZvcl9waXBlKQogCQkJd2lkdGhfYmVmb3JlX3BpcGUgKz0gaGRpc3BsYXk7
CkBAIC0zOTQ3LDggKzQwMjIsMzEgQEAgc2tsX2RkYl9nZXRfcGlwZV9hbGxvY2F0aW9uX2xpbWl0
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCQlwaXBlX3dpZHRoID0gaGRp
c3BsYXk7CiAJfQogCi0JYWxsb2MtPnN0YXJ0ID0gZGRiX3NpemUgKiB3aWR0aF9iZWZvcmVfcGlw
ZSAvIHRvdGFsX3dpZHRoOwotCWFsbG9jLT5lbmQgPSBkZGJfc2l6ZSAqICh3aWR0aF9iZWZvcmVf
cGlwZSArIHBpcGVfd2lkdGgpIC8gdG90YWxfd2lkdGg7CisJLyoKKwkgKiBGSVhNRShob3c/KToK
KwkgKiBJdCBsb29rcyByaWRpY3Vsb3VzLiBJdCBsb29rcyBzdHVwaWQuIEJ1dCBjdXJyZW50bHkg
d2UgbmVlZCB0byBPUiBpdAorCSAqIHdpdGggREJVRl9TMSBiaXQgYWx3YXlzLCBkdXJpbmcgY29y
ZV9pbml0L3VuaW5pdCwgd2UgaGF2ZSB0byBhbHdheXMKKwkgKiBoZXZlIHBvd2VyZWQgb24gMXN0
IERCdWYgc2xpY2UsIGFjY29yZGluZyB0byBCU3BlYyghKS4KKwkgKiBTbyBmb3IgdGhpcyByZWFz
b24gaWNsL3NrbF9kYnVmX2VuYWJsZSBhbHdheXMgc2V0cyBpdCBvbi4KKwkgKiBCdXQgd2Ugbm93
IGhhdmUgYSB1bmlmaWVkIGFzc2VydGlvbiBpbiBnZW45X2Rpc2FibGVfZGNfc3RhdGVzLCB3aGlj
aAorCSAqIGlzIHN1cHBvc2VkIHRvIGNoZWNrIGlmIHRoZSBhY3R1YWwgc3RhdGUgbWF0Y2hlcyBz
dGF0ZSBpbiBkZXZfcHJpdi4KKwkgKiBUaHVzIHdlIGFsd2F5cyBnb2luZyB0byBoYXZlIGEgbWlz
bWF0Y2ghIFNvIGN1cnJlbnRseSB3ZSBhcmUgZ29pbmcKKwkgKiB0byBPUiBpdCwga2VlcCBEQlVG
X1MxIGNvbnN0YW50bHkgT04gZXZlbiB3aGVuIHRoaXMgaXMgbm90IG5lZWRlZC4uCisJICovCisJ
aW50ZWxfc3RhdGUtPmVuYWJsZWRfZGJ1Zl9zbGljZXNfbWFzayA9IHRvdGFsX3NsaWNlX21hc2sg
fCBCSVQoREJVRl9TMSk7CisKKwlzdGFydCA9IGRkYl9yYW5nZV9zaXplICogd2lkdGhfYmVmb3Jl
X3BpcGUgLyB0b3RhbF93aWR0aF9pbl9yYW5nZTsKKwllbmQgPSBkZGJfcmFuZ2Vfc2l6ZSAqCisJ
CSh3aWR0aF9iZWZvcmVfcGlwZSArIHBpcGVfd2lkdGgpIC8gdG90YWxfd2lkdGhfaW5fcmFuZ2U7
CisKKwlhbGxvYy0+c3RhcnQgPSBvZmZzZXQgKyBzdGFydDsKKwlhbGxvYy0+ZW5kID0gb2Zmc2V0
ICsgZW5kOworCisJRFJNX0RFQlVHX0tNUygiUGlwZSAlZCBkZGIgJWQtJWRcbiIsIGZvcl9waXBl
LAorCQkgICAgICBhbGxvYy0+c3RhcnQsIGFsbG9jLT5lbmQpOworCURSTV9ERUJVR19LTVMoIkVu
YWJsZWQgZGRiIHNsaWNlcyBtYXNrICV4IG51bSBzdXBwb3J0ZWQgJWRcbiIsCisJCSAgICAgIGlu
dGVsX3N0YXRlLT5lbmFibGVkX2RidWZfc2xpY2VzX21hc2ssCisJCSAgICAgIElOVEVMX0lORk8o
ZGV2X3ByaXYpLT5udW1fc3VwcG9ydGVkX2RidWZfc2xpY2VzKTsKIH0KIAogc3RhdGljIGludCBz
a2xfY29tcHV0ZV93bV9wYXJhbXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCkBAIC00MTE5LDYgKzQyMTcsMjY3IEBAIHNrbF9wbGFuZV9kb3duc2NhbGVfYW1vdW50
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCXJldHVybiBtdWxf
Zml4ZWQxNihkb3duc2NhbGVfdywgZG93bnNjYWxlX2gpOwogfQogCitzdHJ1Y3QgZGJ1Zl9zbGlj
ZV9jb25mX2VudHJ5IHsKKwl1OCBhY3RpdmVfcGlwZXM7CisJdTggZGJ1Zl9tYXNrW0k5MTVfTUFY
X1BJUEVTXTsKK307CisKKy8qCisgKiBUYWJsZSB0YWtlbiBmcm9tIEJzcGVjIDEyNzE2CisgKiBQ
aXBlcyBkbyBoYXZlIHNvbWUgcHJlZmVycmVkIERCdWYgc2xpY2UgYWZmaW5pdHksCisgKiBwbHVz
IHRoZXJlIGFyZSBzb21lIGhhcmRjb2RlZCByZXF1aXJlbWVudHMgb24gaG93CisgKiB0aG9zZSBz
aG91bGQgYmUgZGlzdHJpYnV0ZWQgZm9yIG11bHRpcGlwZSBzY2VuYXJpb3MuCisgKiBGb3IgbW9y
ZSBEQnVmIHNsaWNlcyBhbGdvcml0aG0gY2FuIGdldCBldmVuIG1vcmUgbWVzc3kKKyAqIGFuZCBs
ZXNzIHJlYWRhYmxlLCBzbyBkZWNpZGVkIHRvIHVzZSBhIHRhYmxlIGFsbW9zdAorICogYXMgaXMg
ZnJvbSBCU3BlYyBpdHNlbGYgLSB0aGF0IHdheSBpdCBpcyBhdCBsZWFzdCBlYXNpZXIKKyAqIHRv
IGNvbXBhcmUsIGNoYW5nZSBhbmQgY2hlY2suCisgKi8KK3N0YXRpYyBzdHJ1Y3QgZGJ1Zl9zbGlj
ZV9jb25mX2VudHJ5IGljbF9hbGxvd2VkX2RidWZzW10gPQorLyogQXV0b2dlbmVyYXRlZCB3aXRo
IGlndC90b29scy9pbnRlbF9kYnVmX21hcCB0b29sOiAqLworeworCXsKKwkJLmFjdGl2ZV9waXBl
cyA9IEJJVChQSVBFX0EpLAorCQl7CisJCQlbUElQRV9BXSA9IEJJVChEQlVGX1MxKSB8IEJJVChE
QlVGX1MyKQorCQl9CisJfSwKKwl7CisJCS5hY3RpdmVfcGlwZXMgPSBCSVQoUElQRV9CKSwKKwkJ
eworCQkJW1BJUEVfQl0gPSBCSVQoREJVRl9TMSkgfCBCSVQoREJVRl9TMikKKwkJfQorCX0sCisJ
eworCQkuYWN0aXZlX3BpcGVzID0gQklUKFBJUEVfQSkgfCBCSVQoUElQRV9CKSwKKwkJeworCQkJ
W1BJUEVfQV0gPSBCSVQoREJVRl9TMSksCisJCQlbUElQRV9CXSA9IEJJVChEQlVGX1MyKQorCQl9
CisJfSwKKwl7CisJCS5hY3RpdmVfcGlwZXMgPSBCSVQoUElQRV9DKSwKKwkJeworCQkJW1BJUEVf
Q10gPSBCSVQoREJVRl9TMikgfCBCSVQoREJVRl9TMSkKKwkJfQorCX0sCisJeworCQkuYWN0aXZl
X3BpcGVzID0gQklUKFBJUEVfQSkgfCBCSVQoUElQRV9DKSwKKwkJeworCQkJW1BJUEVfQV0gPSBC
SVQoREJVRl9TMSksCisJCQlbUElQRV9DXSA9IEJJVChEQlVGX1MyKQorCQl9CisJfSwKKwl7CisJ
CS5hY3RpdmVfcGlwZXMgPSBCSVQoUElQRV9CKSB8IEJJVChQSVBFX0MpLAorCQl7CisJCQlbUElQ
RV9CXSA9IEJJVChEQlVGX1MxKSwKKwkJCVtQSVBFX0NdID0gQklUKERCVUZfUzIpCisJCX0KKwl9
LAorCXsKKwkJLmFjdGl2ZV9waXBlcyA9IEJJVChQSVBFX0EpIHwgQklUKFBJUEVfQikgfCBCSVQo
UElQRV9DKSwKKwkJeworCQkJW1BJUEVfQV0gPSBCSVQoREJVRl9TMSksCisJCQlbUElQRV9CXSA9
IEJJVChEQlVGX1MxKSwKKwkJCVtQSVBFX0NdID0gQklUKERCVUZfUzIpCisJCX0KKwl9LAorfTsK
KworLyoKKyAqIFRhYmxlIHRha2VuIGZyb20gQnNwZWMgNDkyNTUKKyAqIFBpcGVzIGRvIGhhdmUg
c29tZSBwcmVmZXJyZWQgREJ1ZiBzbGljZSBhZmZpbml0eSwKKyAqIHBsdXMgdGhlcmUgYXJlIHNv
bWUgaGFyZGNvZGVkIHJlcXVpcmVtZW50cyBvbiBob3cKKyAqIHRob3NlIHNob3VsZCBiZSBkaXN0
cmlidXRlZCBmb3IgbXVsdGlwaXBlIHNjZW5hcmlvcy4KKyAqIEZvciBtb3JlIERCdWYgc2xpY2Vz
IGFsZ29yaXRobSBjYW4gZ2V0IGV2ZW4gbW9yZSBtZXNzeQorICogYW5kIGxlc3MgcmVhZGFibGUs
IHNvIGRlY2lkZWQgdG8gdXNlIGEgdGFibGUgYWxtb3N0CisgKiBhcyBpcyBmcm9tIEJTcGVjIGl0
c2VsZiAtIHRoYXQgd2F5IGl0IGlzIGF0IGxlYXN0IGVhc2llcgorICogdG8gY29tcGFyZSwgY2hh
bmdlIGFuZCBjaGVjay4KKyAqLworc3RhdGljIHN0cnVjdCBkYnVmX3NsaWNlX2NvbmZfZW50cnkg
dGdsX2FsbG93ZWRfZGJ1ZnNbXSA9CisvKiBBdXRvZ2VuZXJhdGVkIHdpdGggaWd0L3Rvb2xzL2lu
dGVsX2RidWZfbWFwIHRvb2w6ICovCit7CisJeworCQkuYWN0aXZlX3BpcGVzID0gQklUKFBJUEVf
QSksCisJCXsKKwkJCVtQSVBFX0FdID0gQklUKERCVUZfUzEpIHwgQklUKERCVUZfUzIpCisJCX0K
Kwl9LAorCXsKKwkJLmFjdGl2ZV9waXBlcyA9IEJJVChQSVBFX0IpLAorCQl7CisJCQlbUElQRV9C
XSA9IEJJVChEQlVGX1MxKSB8IEJJVChEQlVGX1MyKQorCQl9CisJfSwKKwl7CisJCS5hY3RpdmVf
cGlwZXMgPSBCSVQoUElQRV9BKSB8IEJJVChQSVBFX0IpLAorCQl7CisJCQlbUElQRV9BXSA9IEJJ
VChEQlVGX1MyKSwKKwkJCVtQSVBFX0JdID0gQklUKERCVUZfUzEpCisJCX0KKwl9LAorCXsKKwkJ
LmFjdGl2ZV9waXBlcyA9IEJJVChQSVBFX0MpLAorCQl7CisJCQlbUElQRV9DXSA9IEJJVChEQlVG
X1MyKSB8IEJJVChEQlVGX1MxKQorCQl9CisJfSwKKwl7CisJCS5hY3RpdmVfcGlwZXMgPSBCSVQo
UElQRV9BKSB8IEJJVChQSVBFX0MpLAorCQl7CisJCQlbUElQRV9BXSA9IEJJVChEQlVGX1MxKSwK
KwkJCVtQSVBFX0NdID0gQklUKERCVUZfUzIpCisJCX0KKwl9LAorCXsKKwkJLmFjdGl2ZV9waXBl
cyA9IEJJVChQSVBFX0IpIHwgQklUKFBJUEVfQyksCisJCXsKKwkJCVtQSVBFX0JdID0gQklUKERC
VUZfUzEpLAorCQkJW1BJUEVfQ10gPSBCSVQoREJVRl9TMikKKwkJfQorCX0sCisJeworCQkuYWN0
aXZlX3BpcGVzID0gQklUKFBJUEVfQSkgfCBCSVQoUElQRV9CKSB8IEJJVChQSVBFX0MpLAorCQl7
CisJCQlbUElQRV9BXSA9IEJJVChEQlVGX1MxKSwKKwkJCVtQSVBFX0JdID0gQklUKERCVUZfUzEp
LAorCQkJW1BJUEVfQ10gPSBCSVQoREJVRl9TMikKKwkJfQorCX0sCisJeworCQkuYWN0aXZlX3Bp
cGVzID0gQklUKFBJUEVfRCksCisJCXsKKwkJCVtQSVBFX0RdID0gQklUKERCVUZfUzIpIHwgQklU
KERCVUZfUzEpCisJCX0KKwl9LAorCXsKKwkJLmFjdGl2ZV9waXBlcyA9IEJJVChQSVBFX0EpIHwg
QklUKFBJUEVfRCksCisJCXsKKwkJCVtQSVBFX0FdID0gQklUKERCVUZfUzEpLAorCQkJW1BJUEVf
RF0gPSBCSVQoREJVRl9TMikKKwkJfQorCX0sCisJeworCQkuYWN0aXZlX3BpcGVzID0gQklUKFBJ
UEVfQikgfCBCSVQoUElQRV9EKSwKKwkJeworCQkJW1BJUEVfQl0gPSBCSVQoREJVRl9TMSksCisJ
CQlbUElQRV9EXSA9IEJJVChEQlVGX1MyKQorCQl9CisJfSwKKwl7CisJCS5hY3RpdmVfcGlwZXMg
PSBCSVQoUElQRV9BKSB8IEJJVChQSVBFX0IpIHwgQklUKFBJUEVfRCksCisJCXsKKwkJCVtQSVBF
X0FdID0gQklUKERCVUZfUzEpLAorCQkJW1BJUEVfQl0gPSBCSVQoREJVRl9TMSksCisJCQlbUElQ
RV9EXSA9IEJJVChEQlVGX1MyKQorCQl9CisJfSwKKwl7CisJCS5hY3RpdmVfcGlwZXMgPSBCSVQo
UElQRV9DKSB8IEJJVChQSVBFX0QpLAorCQl7CisJCQlbUElQRV9DXSA9IEJJVChEQlVGX1MxKSwK
KwkJCVtQSVBFX0RdID0gQklUKERCVUZfUzIpCisJCX0KKwl9LAorCXsKKwkJLmFjdGl2ZV9waXBl
cyA9IEJJVChQSVBFX0EpIHwgQklUKFBJUEVfQykgfCBCSVQoUElQRV9EKSwKKwkJeworCQkJW1BJ
UEVfQV0gPSBCSVQoREJVRl9TMSksCisJCQlbUElQRV9DXSA9IEJJVChEQlVGX1MyKSwKKwkJCVtQ
SVBFX0RdID0gQklUKERCVUZfUzIpCisJCX0KKwl9LAorCXsKKwkJLmFjdGl2ZV9waXBlcyA9IEJJ
VChQSVBFX0IpIHwgQklUKFBJUEVfQykgfCBCSVQoUElQRV9EKSwKKwkJeworCQkJW1BJUEVfQl0g
PSBCSVQoREJVRl9TMSksCisJCQlbUElQRV9DXSA9IEJJVChEQlVGX1MyKSwKKwkJCVtQSVBFX0Rd
ID0gQklUKERCVUZfUzIpCisJCX0KKwl9LAorCXsKKwkJLmFjdGl2ZV9waXBlcyA9CisJCQlCSVQo
UElQRV9BKSB8IEJJVChQSVBFX0IpIHwgQklUKFBJUEVfQykgfCBCSVQoUElQRV9EKSwKKwkJewor
CQkJW1BJUEVfQV0gPSBCSVQoREJVRl9TMSksCisJCQlbUElQRV9CXSA9IEJJVChEQlVGX1MxKSwK
KwkJCVtQSVBFX0NdID0gQklUKERCVUZfUzIpLAorCQkJW1BJUEVfRF0gPSBCSVQoREJVRl9TMikK
KwkJfQorCX0sCit9OworCitzdGF0aWMgdTggY29tcHV0ZV9kYnVmX3NsaWNlcyhlbnVtIHBpcGUg
cGlwZSwKKwkJCSAgICAgIHUzMiBhY3RpdmVfcGlwZXMsCisJCQkgICAgICBjb25zdCBzdHJ1Y3Qg
ZGJ1Zl9zbGljZV9jb25mX2VudHJ5ICpkYnVmX3NsaWNlcywKKwkJCSAgICAgIGludCBzaXplKQor
eworCWludCBpOworCisJZm9yIChpID0gMDsgaSA8IHNpemU7IGkrKykgeworCQlpZiAoZGJ1Zl9z
bGljZXNbaV0uYWN0aXZlX3BpcGVzID09IGFjdGl2ZV9waXBlcykKKwkJCXJldHVybiBkYnVmX3Ns
aWNlc1tpXS5kYnVmX21hc2tbcGlwZV07CisJfQorCXJldHVybiAwOworfQorCisvKgorICogVGhp
cyBmdW5jdGlvbiBmaW5kcyBhbiBlbnRyeSB3aXRoIHNhbWUgZW5hYmxlZCBwaXBlIGNvbmZpZ3Vy
YXRpb24gYW5kCisgKiByZXR1cm5zIGNvcnJlc3BvbmRlbnQgREJ1ZiBzbGljZSBtYXNrIGFzIHN0
YXRlZCBpbiBCU3BlYyBmb3IgcGFydGljdWxhcgorICogcGxhdGZvcm0uCisgKi8KK3N0YXRpYyB1
MzIgaWNsX2NvbXB1dGVfZGJ1Zl9zbGljZXMoZW51bSBwaXBlIHBpcGUsCisJCQkJICAgdTMyIGFj
dGl2ZV9waXBlcywKKwkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKK3sKKwkvKgorCSAqIEZJWE1FOiBGb3IgSUNMIHRoaXMgaXMgc3RpbGwgYSBiaXQgdW5j
bGVhciBhcyBwcmV2IEJTcGVjIHJldmlzaW9uCisJICogcmVxdWlyZWQgY2FsY3VsYXRpbmcgInBp
cGUgcmF0aW8iIGluIG9yZGVyIHRvIGRldGVybWluZQorCSAqIGlmIG9uZSBvciB0d28gc2xpY2Vz
IGNhbiBiZSB1c2VkIGZvciBzaW5nbGUgcGlwZSBjb25maWd1cmF0aW9ucworCSAqIGFzIGFkZGl0
aW9uYWwgY29uc3RyYWludCB0byB0aGUgZXhpc3RpbmcgdGFibGUuCisJICogSG93ZXZlciBiYXNl
ZCBvbiByZWNlbnQgaW5mbywgaXQgc2hvdWxkIGJlIG5vdCAicGlwZSByYXRpbyIKKwkgKiBidXQg
cmF0aGVyIHJhdGlvIGJldHdlZW4gcGl4ZWxfcmF0ZSBhbmQgY2RjbGsgd2l0aCBhZGRpdGlvbmFs
CisJICogY29uc3RhbnRzLCBzbyBmb3Igbm93IHdlIGFyZSB1c2luZyBvbmx5IHRhYmxlIHVudGls
IHRoaXMgaXMKKwkgKiBjbGFyaWZpZWQuIEFsc28gdGhpcyBpcyB0aGUgcmVhc29uIHdoeSBjcnRj
X3N0YXRlIHBhcmFtIGlzCisJICogc3RpbGwgaGVyZSAtIHdlIHdpbGwgbmVlZCBpdCBvbmNlIHRo
b3NlIGFkZGl0aW9uYWwgY29uc3RyYWludHMKKwkgKiBwb3AgdXAuCisJICovCisJcmV0dXJuIGNv
bXB1dGVfZGJ1Zl9zbGljZXMocGlwZSwgYWN0aXZlX3BpcGVzLAorCQkJCSAgIGljbF9hbGxvd2Vk
X2RidWZzLAorCQkJCSAgIEFSUkFZX1NJWkUoaWNsX2FsbG93ZWRfZGJ1ZnMpKTsKK30KKworc3Rh
dGljIHUzMiB0Z2xfY29tcHV0ZV9kYnVmX3NsaWNlcyhlbnVtIHBpcGUgcGlwZSwKKwkJCQkgICB1
MzIgYWN0aXZlX3BpcGVzLAorCQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQoreworCXJldHVybiBjb21wdXRlX2RidWZfc2xpY2VzKHBpcGUsIGFjdGl2ZV9w
aXBlcywKKwkJCQkgICB0Z2xfYWxsb3dlZF9kYnVmcywKKwkJCQkgICBBUlJBWV9TSVpFKHRnbF9h
bGxvd2VkX2RidWZzKSk7Cit9CisKK3N0YXRpYyB1OCBza2xfY29tcHV0ZV9kYnVmX3NsaWNlcyhj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKKwkJCQkgIHUzMiBhY3Rp
dmVfcGlwZXMpCit7CisJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNy
dGNfc3RhdGUtPnVhcGkuY3J0Yyk7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7CisJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBl
OworCisJaWYgKElTX0dFTihkZXZfcHJpdiwgMTIpKQorCQlyZXR1cm4gdGdsX2NvbXB1dGVfZGJ1
Zl9zbGljZXMocGlwZSwKKwkJCQkJICAgICAgIGFjdGl2ZV9waXBlcywKKwkJCQkJICAgICAgIGNy
dGNfc3RhdGUpOworCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMTEpKQorCQlyZXR1cm4gaWNs
X2NvbXB1dGVfZGJ1Zl9zbGljZXMocGlwZSwKKwkJCQkJICAgICAgIGFjdGl2ZV9waXBlcywKKwkJ
CQkJICAgICAgIGNydGNfc3RhdGUpOworCS8qCisJICogRm9yIGFueXRoaW5nIGVsc2UganVzdCBy
ZXR1cm4gb25lIHNsaWNlIHlldC4KKwkgKiBTaG91bGQgYmUgZXh0ZW5kZWQgZm9yIG90aGVyIHBs
YXRmb3Jtcy4KKwkgKi8KKwlyZXR1cm4gQklUKERCVUZfUzEpOworfQorCiBzdGF0aWMgdTY0CiBz
a2xfcGxhbmVfcmVsYXRpdmVfZGF0YV9yYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAogCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBs
YW5lX3N0YXRlLAotLSAKMi4yNC4xLjQ4NS5nYWQwNWEzZDhlNQoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRl
bC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

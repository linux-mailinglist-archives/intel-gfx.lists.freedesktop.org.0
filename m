Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 0E250AD4C5
	for <lists+intel-gfx@lfdr.de>; Mon,  9 Sep 2019 10:23:02 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D2A588996E;
	Mon,  9 Sep 2019 08:22:58 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CB9778996E
 for <intel-gfx@lists.freedesktop.org>; Mon,  9 Sep 2019 08:22:57 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by fmsmga104.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 09 Sep 2019 01:22:57 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,484,1559545200"; d="scan'208";a="196123506"
Received: from hoernig-mobl.ger.corp.intel.com (HELO delly.ger.corp.intel.com)
 ([10.249.33.104])
 by orsmga002.jf.intel.com with ESMTP; 09 Sep 2019 01:22:56 -0700
From: Lionel Landwerlin <lionel.g.landwerlin@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Mon,  9 Sep 2019 11:22:39 +0300
Message-Id: <20190909082245.27245-7-lionel.g.landwerlin@intel.com>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190909082245.27245-1-lionel.g.landwerlin@intel.com>
References: <20190909082245.27245-1-lionel.g.landwerlin@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 07/13] drm/i915/perf: allow for CS OA configs to be
 created lazily
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SGVyZSB3ZSBpbnRyb2R1Y2UgYSBtZWNoYW5pc20gYnkgd2hpY2ggdGhlIGV4ZWNidWYgcGFydCBv
ZiB0aGUgaTkxNQpkcml2ZXIgd2lsbCBiZSBhYmxlIHRvIHJlcXVlc3QgdGhhdCBhIGJhdGNoIGJ1
ZmZlciBjb250YWluaW5nIHRoZQpwcm9ncmFtbWluZyBmb3IgYSBwYXJ0aWN1bGFyIE9BIGNvbmZp
ZyBiZSBjcmVhdGVkLgoKV2UnbGwgZXhlY3V0ZSB0aGVzZSBPQSBjb25maWd1cmF0aW9uIGJ1ZmZl
cnMgcmlnaHQgYmVmb3JlIGV4ZWN1dGluZyBhCnNldCBvZiB1c2Vyc3BhY2UgY29tbWFuZHMgc28g
dGhhdCBhIHBhcnRpY3VsYXIgdXNlciBiYXRjaGJ1ZmZlciBiZQpleGVjdXRlZCB3aXRoIGEgZ2l2
ZW4gT0EgY29uZmlndXJhdGlvbi4KClRoaXMgbWVjaGFuaXNtIGVzc2VudGlhbGx5IGFsbG93cyB0
aGUgdXNlcnNwYWNlIGRyaXZlciB0byBnbyB0aHJvdWdoCnNldmVyYWwgT0EgY29uZmlndXJhdGlv
biB3aXRob3V0IGhhdmluZyB0byBvcGVuL2Nsb3NlIHRoZSBpOTE1L3BlcmYKc3RyZWFtLgoKdjI6
IE5vIG5lZWQgZm9yIGxvY2tpbmcgb24gb2JqZWN0IE9BIGNvbmZpZyBvYmplY3QgY3JlYXRpb24g
KENocmlzKQogICAgRmx1c2ggY3B1IG1hcHBpbmcgb2YgT0EgY29uZmlnIChDaHJpcykKCnYzOiBQ
cm9wZXJseSBkZWFsIHdpdGggdGhlIHBlcmZfbWV0cmljIGxvY2sgKENocmlzL0xpb25lbCkKCnY0
OiBGaXggb2EgY29uZmlnIHVucmVmL3B1dCB3aGVuIG5vdCBmb3VuZCAoTGlvbmVsKQoKdjU6IEFs
bG9jYXRlIEJPcyBmb3IgY29uZmlndXJhdGlvbnMgb24gdGhlIHN0cmVhbSBpbnN0ZWFkIG9mIGds
b2JhbGx5CiAgICAoTGlvbmVsKQoKdjY6IEZpeCA2NGJpdCBkaXZpc2lvbiAoQ2hyaXMpCgp2Nzog
U3RvcmUgYWxsb2NhdGVkIGNvbmZpZyBCT3MgaW50byB0aGUgc3RyZWFtIChMaW9uZWwpCgpTaWdu
ZWQtb2ZmLWJ5OiBMaW9uZWwgTGFuZHdlcmxpbiA8bGlvbmVsLmcubGFuZHdlcmxpbkBpbnRlbC5j
b20+ClJldmlld2VkLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4g
KHY0KQotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oIHwg
ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAgIHwgICA0
ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyAgICAgICAgICAgICB8IDI3MCAr
KysrKysrKysrKysrKysrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuaCAgICAg
ICAgICAgICB8ICAyNiArKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmX3R5cGVzLmgg
ICAgICAgfCAgMTUgKy0KIDUgZmlsZXMgY2hhbmdlZCwgMjczIGluc2VydGlvbnMoKyksIDQzIGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2dw
dV9jb21tYW5kcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3B1X2NvbW1hbmRz
LmgKaW5kZXggZmJhZDQwM2FiN2FjLi5iNjM3M2ZiYzkyN2QgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2dwdV9jb21tYW5kcy5oCkBAIC0xMzUsNiArMTM1LDcgQEAKIC8qIEdl
bjExKy4gYWRkciA9IGJhc2UgKyAoY3R4X3Jlc3RvcmUgPyBvZmZzZXQgJiBHRU5NQVNLKDEyLDIp
IDogb2Zmc2V0KSAqLwogI2RlZmluZSAgIE1JX0xSSV9DU19NTUlPCQkoMTw8MTkpCiAjZGVmaW5l
ICAgTUlfTFJJX0ZPUkNFX1BPU1RFRAkJKDE8PDEyKQorI2RlZmluZSBNSV9MT0FEX1JFR0lTVEVS
X0lNTV9NQVhfUkVHUyAoMTI2KQogI2RlZmluZSBNSV9TVE9SRV9SRUdJU1RFUl9NRU0gICAgICAg
IE1JX0lOU1RSKDB4MjQsIDEpCiAjZGVmaW5lIE1JX1NUT1JFX1JFR0lTVEVSX01FTV9HRU44ICAg
TUlfSU5TVFIoMHgyNCwgMikKICNkZWZpbmUgICBNSV9TUk1fTFJNX0dMT0JBTF9HVFQJCSgxPDwy
MikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4IGY0MTQ1YWU2YWI2ZS4uN2ViMzE5MjNjZGU5
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKQEAgLTEzNjMsOCArMTM2Myw4IEBAIHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlIHsKIAkJc3RydWN0IG11dGV4IG1ldHJpY3NfbG9jazsKIAogCQkvKgot
CQkgKiBMaXN0IG9mIGR5bmFtaWMgY29uZmlndXJhdGlvbnMsIHlvdSBuZWVkIHRvIGhvbGQKLQkJ
ICogZGV2X3ByaXYtPnBlcmYubWV0cmljc19sb2NrIHRvIGFjY2VzcyBpdC4KKwkJICogTGlzdCBv
ZiBkeW5hbWljIGNvbmZpZ3VyYXRpb25zIChzdHJ1Y3QgaTkxNV9vYV9jb25maWcpLCB5b3UKKwkJ
ICogbmVlZCB0byBob2xkIGRldl9wcml2LT5wZXJmLm1ldHJpY3NfbG9jayB0byBhY2Nlc3MgaXQu
CiAJCSAqLwogCQlzdHJ1Y3QgaWRyIG1ldHJpY3NfaWRyOwogCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVy
Zi5jCmluZGV4IDQwYTFlYzJiYzk2Yi4uYzlkMGRlMzA1MGZiIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3BlcmYuYwpAQCAtMzY3LDExICszNjcsMTkgQEAgc3RydWN0IHBlcmZfb3Blbl9wcm9wZXJ0aWVz
IHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CiB9OwogCitzdHJ1Y3QgaTkxNV9v
YV9jb25maWdfYm8geworCXN0cnVjdCBsaXN0X2hlYWQgbGluazsKKworCXN0cnVjdCBpOTE1X29h
X2NvbmZpZyAqb2FfY29uZmlnOworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpibzsKK307
CisKIHN0YXRpYyBlbnVtIGhydGltZXJfcmVzdGFydCBvYV9wb2xsX2NoZWNrX3RpbWVyX2NiKHN0
cnVjdCBocnRpbWVyICpocnRpbWVyKTsKIAotc3RhdGljIHZvaWQgZnJlZV9vYV9jb25maWcoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJICAgc3RydWN0IGk5MTVfb2FfY29u
ZmlnICpvYV9jb25maWcpCit2b2lkIGk5MTVfb2FfY29uZmlnX3JlbGVhc2Uoc3RydWN0IGtyZWYg
KnJlZikKIHsKKwlzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9hX2NvbmZpZyA9IGNvbnRhaW5lcl9v
ZihyZWYsIHR5cGVvZigqb2FfY29uZmlnKSwgcmVmKTsKKwogCWlmICghUFRSX0VSUihvYV9jb25m
aWctPmZsZXhfcmVncykpCiAJCWtmcmVlKG9hX2NvbmZpZy0+ZmxleF9yZWdzKTsKIAlpZiAoIVBU
Ul9FUlIob2FfY29uZmlnLT5iX2NvdW50ZXJfcmVncykpCkBAIC0zODEsNDAgKzM4OSwxOTQgQEAg
c3RhdGljIHZvaWQgZnJlZV9vYV9jb25maWcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAogCWtmcmVlKG9hX2NvbmZpZyk7CiB9CiAKLXN0YXRpYyB2b2lkIHB1dF9vYV9jb25maWco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJICBzdHJ1Y3QgaTkxNV9vYV9j
b25maWcgKm9hX2NvbmZpZykKK3N0YXRpYyB1MzIgKndyaXRlX2NzX21pX2xyaSh1MzIgKmNzLCBj
b25zdCBzdHJ1Y3QgaTkxNV9vYV9yZWcgKnJlZ19kYXRhLCB1MzIgbl9yZWdzKQogewotCWlmICgh
YXRvbWljX2RlY19hbmRfdGVzdCgmb2FfY29uZmlnLT5yZWZfY291bnQpKQotCQlyZXR1cm47CisJ
dTMyIGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgbl9yZWdzOyBpKyspIHsKKwkJaWYgKChpICUgTUlf
TE9BRF9SRUdJU1RFUl9JTU1fTUFYX1JFR1MpID09IDApIHsKKwkJCXUzMiBuX2xyaSA9IG1pbihu
X3JlZ3MgLSBpLAorCQkJCQkodTMyKSBNSV9MT0FEX1JFR0lTVEVSX0lNTV9NQVhfUkVHUyk7CiAK
LQlmcmVlX29hX2NvbmZpZyhkZXZfcHJpdiwgb2FfY29uZmlnKTsKKwkJCSpjcysrID0gTUlfTE9B
RF9SRUdJU1RFUl9JTU0obl9scmkpOworCQl9CisJCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZz
ZXQocmVnX2RhdGFbaV0uYWRkcik7CisJCSpjcysrID0gcmVnX2RhdGFbaV0udmFsdWU7CisJfQor
CisJcmV0dXJuIGNzOwogfQogCi1zdGF0aWMgaW50IGdldF9vYV9jb25maWcoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJIGludCBtZXRyaWNzX3NldCwKLQkJCSBzdHJ1Y3Qg
aTkxNV9vYV9jb25maWcgKipvdXRfY29uZmlnKQorc3RhdGljIHN0cnVjdCBpOTE1X29hX2NvbmZp
Z19ibyogYWxsb2Nfb2FfY29uZmlnX2J1ZmZlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKKwkJCQkJCQlzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9hX2NvbmZpZykKIHsKLQlpbnQgcmV0
OworCXN0cnVjdCBpOTE1X29hX2NvbmZpZ19ibyAqb2FfYm87CisJc2l6ZV90IGNvbmZpZ19sZW5n
dGggPSAwOworCXUzMiAqY3M7CisJaW50IGVycjsKKworCW9hX2JvID0ga3phbGxvYyhzaXplb2Yo
Km9hX2JvKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFvYV9ibykKKwkJcmV0dXJuIEVSUl9QVFIoLUVO
T01FTSk7CisKKwlvYV9iby0+b2FfY29uZmlnID0gaTkxNV9vYV9jb25maWdfZ2V0KG9hX2NvbmZp
Zyk7CisKKwlpZiAob2FfY29uZmlnLT5tdXhfcmVnc19sZW4gPiAwKSB7CisJCWNvbmZpZ19sZW5n
dGggKz0gRElWX1JPVU5EX1VQKG9hX2NvbmZpZy0+bXV4X3JlZ3NfbGVuLAorCQkJCQkgICAgICBN
SV9MT0FEX1JFR0lTVEVSX0lNTV9NQVhfUkVHUykgKiA0OworCQljb25maWdfbGVuZ3RoICs9IG9h
X2NvbmZpZy0+bXV4X3JlZ3NfbGVuICogODsKKwl9CisJaWYgKG9hX2NvbmZpZy0+Yl9jb3VudGVy
X3JlZ3NfbGVuID4gMCkgeworCQljb25maWdfbGVuZ3RoICs9IERJVl9ST1VORF9VUChvYV9jb25m
aWctPmJfY291bnRlcl9yZWdzX2xlbiwKKwkJCQkJICAgICAgTUlfTE9BRF9SRUdJU1RFUl9JTU1f
TUFYX1JFR1MpICogNDsKKwkJY29uZmlnX2xlbmd0aCArPSBvYV9jb25maWctPmJfY291bnRlcl9y
ZWdzX2xlbiAqIDg7CisJfQorCWlmIChvYV9jb25maWctPmZsZXhfcmVnc19sZW4gPiAwKSB7CisJ
CWNvbmZpZ19sZW5ndGggKz0gRElWX1JPVU5EX1VQKG9hX2NvbmZpZy0+ZmxleF9yZWdzX2xlbiwK
KwkJCQkJICAgICAgTUlfTE9BRF9SRUdJU1RFUl9JTU1fTUFYX1JFR1MpICogNDsKKwkJY29uZmln
X2xlbmd0aCArPSBvYV9jb25maWctPmZsZXhfcmVnc19sZW4gKiA4OworCX0KKwljb25maWdfbGVu
Z3RoICs9IDQ7IC8qIE1JX0JBVENIX0JVRkZFUl9FTkQgKi8KKwljb25maWdfbGVuZ3RoID0gQUxJ
R04oY29uZmlnX2xlbmd0aCwgSTkxNV9HVFRfUEFHRV9TSVpFKTsKKworCW9hX2JvLT5ibyA9IGk5
MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0oaTkxNSwgY29uZmlnX2xlbmd0aCk7CisJaWYgKElT
X0VSUihvYV9iby0+Ym8pKSB7CisJCWVyciA9IFBUUl9FUlIob2FfYm8tPmJvKTsKKwkJZ290byBl
cnJfb2FfY29uZmlnOworCX0KKworCWNzID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAob2FfYm8t
PmJvLCBJOTE1X01BUF9XQik7CisJaWYgKElTX0VSUihjcykpIHsKKwkJZXJyID0gUFRSX0VSUihj
cyk7CisJCWdvdG8gZXJyX29hX2JvOworCX0KKworCWNzID0gd3JpdGVfY3NfbWlfbHJpKGNzLCBv
YV9jb25maWctPm11eF9yZWdzLCBvYV9jb25maWctPm11eF9yZWdzX2xlbik7CisJY3MgPSB3cml0
ZV9jc19taV9scmkoY3MsIG9hX2NvbmZpZy0+Yl9jb3VudGVyX3JlZ3MsIG9hX2NvbmZpZy0+Yl9j
b3VudGVyX3JlZ3NfbGVuKTsKKwljcyA9IHdyaXRlX2NzX21pX2xyaShjcywgb2FfY29uZmlnLT5m
bGV4X3JlZ3MsIG9hX2NvbmZpZy0+ZmxleF9yZWdzX2xlbik7CisKKwkqY3MrKyA9IE1JX0JBVENI
X0JVRkZFUl9FTkQ7CisKKwlpOTE1X2dlbV9vYmplY3RfZmx1c2hfbWFwKG9hX2JvLT5ibyk7CisJ
aTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChvYV9iby0+Ym8pOworCisJcmV0dXJuIG9hX2JvOwor
CitlcnJfb2FfYm86CisJaTkxNV9nZW1fb2JqZWN0X3B1dChvYV9iby0+Ym8pOworZXJyX29hX2Nv
bmZpZzoKKwlpOTE1X29hX2NvbmZpZ19wdXQob2FfYm8tPm9hX2NvbmZpZyk7CisJa2ZyZWUob2Ff
Ym8pOworCisJcmV0dXJuIEVSUl9QVFIoZXJyKTsKK30KKworaW50IGk5MTVfcGVyZl9nZXRfb2Ff
Y29uZmlnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAorCQkJICAgIGludCBtZXRyaWNz
X3NldCwKKwkJCSAgICBzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKipvdXRfY29uZmlnKQoreworCXN0
cnVjdCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmlnOworCWludCBlcnI7CisKKwlpZiAoIWk5MTUt
PnBlcmYuaW5pdGlhbGl6ZWQpCisJCXJldHVybiAtRU5PREVWOworCisJZXJyID0gbXV0ZXhfbG9j
a19pbnRlcnJ1cHRpYmxlKCZpOTE1LT5wZXJmLm1ldHJpY3NfbG9jayk7CisJaWYgKGVycikKKwkJ
cmV0dXJuIGVycjsKIAogCWlmIChtZXRyaWNzX3NldCA9PSAxKSB7Ci0JCSpvdXRfY29uZmlnID0g
JmRldl9wcml2LT5wZXJmLnRlc3RfY29uZmlnOwotCQlhdG9taWNfaW5jKCZkZXZfcHJpdi0+cGVy
Zi50ZXN0X2NvbmZpZy5yZWZfY291bnQpOwotCQlyZXR1cm4gMDsKKwkJb2FfY29uZmlnID0gJmk5
MTUtPnBlcmYudGVzdF9jb25maWc7CisJfSBlbHNlIHsKKwkJb2FfY29uZmlnID0gaWRyX2ZpbmQo
Jmk5MTUtPnBlcmYubWV0cmljc19pZHIsIG1ldHJpY3Nfc2V0KTsKKwkJaWYgKCFvYV9jb25maWcp
CisJCQllcnIgPSAtRUlOVkFMOwogCX0KIAotCXJldCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJs
ZSgmZGV2X3ByaXYtPnBlcmYubWV0cmljc19sb2NrKTsKLQlpZiAocmV0KQotCQlyZXR1cm4gcmV0
OworCWlmICghZXJyKQorCQkqb3V0X2NvbmZpZyA9IGk5MTVfb2FfY29uZmlnX2dldChvYV9jb25m
aWcpOwogCi0JKm91dF9jb25maWcgPSBpZHJfZmluZCgmZGV2X3ByaXYtPnBlcmYubWV0cmljc19p
ZHIsIG1ldHJpY3Nfc2V0KTsKLQlpZiAoISpvdXRfY29uZmlnKQotCQlyZXQgPSAtRUlOVkFMOwot
CWVsc2UKLQkJYXRvbWljX2luYygmKCpvdXRfY29uZmlnKS0+cmVmX2NvdW50KTsKKwltdXRleF91
bmxvY2soJmk5MTUtPnBlcmYubWV0cmljc19sb2NrKTsKIAotCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPnBlcmYubWV0cmljc19sb2NrKTsKKwlyZXR1cm4gZXJyOworfQogCi0JcmV0dXJuIHJldDsK
K3N0YXRpYyB2b2lkIGZyZWVfb2FfY29uZmlnX2JvKHN0cnVjdCBpOTE1X29hX2NvbmZpZ19ibyAq
b2FfYm8pCit7CisJaTkxNV9vYV9jb25maWdfcHV0KG9hX2JvLT5vYV9jb25maWcpOworCWk5MTVf
Z2VtX29iamVjdF9wdXQob2FfYm8tPmJvKTsKKwlrZnJlZShvYV9ibyk7Cit9CisKK2ludCBpOTE1
X3BlcmZfZ2V0X29hX2NvbmZpZ19hbmRfYm8oc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVh
bSwKKwkJCQkgICBpbnQgbWV0cmljc19zZXQsCisJCQkJICAgc3RydWN0IGk5MTVfb2FfY29uZmln
ICoqb3V0X2NvbmZpZywKKwkJCQkgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqKm91dF9v
YmopCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBzdHJlYW0tPmRldl9wcml2
OworCXN0cnVjdCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmlnOworCWludCBlcnIgPSAwOworCisJ
aWYgKCFpOTE1LT5wZXJmLmluaXRpYWxpemVkKQorCQlyZXR1cm4gLUVOT0RFVjsKKworCWVyciA9
IGk5MTVfcGVyZl9nZXRfb2FfY29uZmlnKGk5MTUsIG1ldHJpY3Nfc2V0LCAmb2FfY29uZmlnKTsK
KwlpZiAoZXJyKQorCQlyZXR1cm4gZXJyOworCisJaWYgKG91dF9jb25maWcpCisJCSpvdXRfY29u
ZmlnID0gb2FfY29uZmlnOworCisJaWYgKG91dF9vYmopIHsKKwkJc3RydWN0IGk5MTVfb2FfY29u
ZmlnX2JvICpvYV9ibyA9IE5VTEwsICpvYV9ib19pdGVyOworCisJCS8qIExvb2sgZm9yIHRoZSBi
dWZmZXIgaW4gdGhlIGFscmVhZHkgYWxsb2NhdGVkIEJPcyBhdHRhY2hlZAorCQkgKiB0byB0aGUg
c3RyZWFtLgorCQkgKi8KKwkJZXJyID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZzdHJlYW0t
PmNvbmZpZ19tdXRleCk7CisJCWlmIChlcnIpCisJCQlnb3RvIGVycjsKKworCQlsaXN0X2Zvcl9l
YWNoX2VudHJ5KG9hX2JvX2l0ZXIsICZzdHJlYW0tPm9hX2NvbmZpZ19ib3MsIGxpbmspIHsKKwkJ
CWlmIChvYV9ib19pdGVyLT5vYV9jb25maWcgPT0gb2FfY29uZmlnICYmCisJCQkgICAgbWVtY21w
KG9hX2JvX2l0ZXItPm9hX2NvbmZpZy0+dXVpZCwKKwkJCQkgICBvYV9jb25maWctPnV1aWQsCisJ
CQkJICAgc2l6ZW9mKG9hX2NvbmZpZy0+dXVpZCkpID09IDApIHsKKwkJCQlvYV9ibyA9IG9hX2Jv
X2l0ZXI7CisJCQkJYnJlYWs7CisJCQl9CisJCX0KKworCQltdXRleF91bmxvY2soJnN0cmVhbS0+
Y29uZmlnX211dGV4KTsKKworCQlpZiAoIW9hX2JvKSB7CisJCQlvYV9ibyA9IGFsbG9jX29hX2Nv
bmZpZ19idWZmZXIoaTkxNSwgb2FfY29uZmlnKTsKKwkJCWlmIChJU19FUlIob2FfYm8pKSB7CisJ
CQkJZXJyID0gUFRSX0VSUihvYV9ibyk7CisJCQkJZ290byBlcnI7CisJCQl9CisKKwkJCWVyciA9
IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmc3RyZWFtLT5jb25maWdfbXV0ZXgpOworCQkJaWYg
KGVycikgeworCQkJCWZyZWVfb2FfY29uZmlnX2JvKG9hX2JvKTsKKwkJCQlnb3RvIGVycjsKKwkJ
CX0KKworCQkJbGlzdF9hZGQoJm9hX2JvLT5saW5rLCAmc3RyZWFtLT5vYV9jb25maWdfYm9zKTsK
KworCQkJbXV0ZXhfdW5sb2NrKCZzdHJlYW0tPmNvbmZpZ19tdXRleCk7CisJCX0KKworCQkqb3V0
X29iaiA9IGk5MTVfZ2VtX29iamVjdF9nZXQob2FfYm8tPmJvKTsKKwl9CisKK2VycjoKKwlpZiAo
ZXJyKSB7CisJCWk5MTVfb2FfY29uZmlnX3B1dChvYV9jb25maWcpOworCQkqb3V0X2NvbmZpZyA9
IE5VTEw7CisJfQorCisJcmV0dXJuIGVycjsKIH0KIAogc3RhdGljIHUzMiBnZW44X29hX2h3X3Rh
aWxfcmVhZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQpAQCAtMTM2Miw2ICsxNTI0
LDE4IEBAIGZyZWVfb2FfYnVmZmVyKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCiAJ
c3RyZWFtLT5vYV9idWZmZXIudmFkZHIgPSBOVUxMOwogfQogCitzdGF0aWMgdm9pZAorZnJlZV9v
YV9jb25maWdzKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCit7CisJc3RydWN0IGk5
MTVfb2FfY29uZmlnX2JvICpvYV9ibywgKnRtcDsKKworCWk5MTVfb2FfY29uZmlnX3B1dChzdHJl
YW0tPm9hX2NvbmZpZyk7CisJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKG9hX2JvLCB0bXAsICZz
dHJlYW0tPm9hX2NvbmZpZ19ib3MsIGxpbmspIHsKKwkJbGlzdF9kZWwoJm9hX2JvLT5saW5rKTsK
KwkJZnJlZV9vYV9jb25maWdfYm8ob2FfYm8pOworCX0KK30KKwogc3RhdGljIHZvaWQgaTkxNV9v
YV9zdHJlYW1fZGVzdHJveShzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQogewogCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7CkBAIC0x
Mzg1LDcgKzE1NTksNyBAQCBzdGF0aWMgdm9pZCBpOTE1X29hX3N0cmVhbV9kZXN0cm95KHN0cnVj
dCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCiAJaWYgKHN0cmVhbS0+Y3R4KQogCQlvYV9wdXRf
cmVuZGVyX2N0eF9pZChzdHJlYW0pOwogCi0JcHV0X29hX2NvbmZpZyhkZXZfcHJpdiwgc3RyZWFt
LT5vYV9jb25maWcpOworCWZyZWVfb2FfY29uZmlncyhzdHJlYW0pOwogCiAJaWYgKGRldl9wcml2
LT5wZXJmLnNwdXJpb3VzX3JlcG9ydF9ycy5taXNzZWQpIHsKIAkJRFJNX05PVEUoIiVkIHNwdXJp
b3VzIE9BIHJlcG9ydCBub3RpY2VzIHN1cHByZXNzZWQgZHVlIHRvIHJhdGVsaW1pdGluZ1xuIiwK
QEAgLTIxOTksNiArMjM3Myw4IEBAIHN0YXRpYyBpbnQgaTkxNV9vYV9zdHJlYW1faW5pdChzdHJ1
Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAogCQlyZXR1cm4gLUVJTlZBTDsKIAl9CiAKKwlt
dXRleF9pbml0KCZzdHJlYW0tPmNvbmZpZ19tdXRleCk7CisKIAlzdHJlYW0tPnNhbXBsZV9zaXpl
ID0gc2l6ZW9mKHN0cnVjdCBkcm1faTkxNV9wZXJmX3JlY29yZF9oZWFkZXIpOwogCiAJZm9ybWF0
X3NpemUgPSBkZXZfcHJpdi0+cGVyZi5vYV9mb3JtYXRzW3Byb3BzLT5vYV9mb3JtYXRdLnNpemU7
CkBAIC0yMjI3LDcgKzI0MDMsOCBAQCBzdGF0aWMgaW50IGk5MTVfb2Ffc3RyZWFtX2luaXQoc3Ry
dWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKIAkJfQogCX0KIAotCXJldCA9IGdldF9vYV9j
b25maWcoZGV2X3ByaXYsIHByb3BzLT5tZXRyaWNzX3NldCwgJnN0cmVhbS0+b2FfY29uZmlnKTsK
KwlyZXQgPSBpOTE1X3BlcmZfZ2V0X29hX2NvbmZpZyhkZXZfcHJpdiwgcHJvcHMtPm1ldHJpY3Nf
c2V0LAorCQkJCSAgICAgICZzdHJlYW0tPm9hX2NvbmZpZyk7CiAJaWYgKHJldCkgewogCQlEUk1f
REVCVUcoIkludmFsaWQgT0EgY29uZmlnIGlkPSVpXG4iLCBwcm9wcy0+bWV0cmljc19zZXQpOwog
CQlnb3RvIGVycl9jb25maWc7CkBAIC0yMjY1LDYgKzI0NDIsOCBAQCBzdGF0aWMgaW50IGk5MTVf
b2Ffc3RyZWFtX2luaXQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKIAkJZ290byBl
cnJfZW5hYmxlOwogCX0KIAorCURSTV9ERUJVRygib3BlbmluZyBzdHJlYW0gb2EgY29uZmlnIHV1
aWQ9JXNcbiIsIHN0cmVhbS0+b2FfY29uZmlnLT51dWlkKTsKKwogCW11dGV4X3VubG9jaygmZGV2
X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJaHJ0aW1lcl9pbml0KCZzdHJlYW0tPnBvbGxf
Y2hlY2tfdGltZXIsCkBAIC0yMjg0LDExICsyNDYzLDExIEBAIHN0YXRpYyBpbnQgaTkxNV9vYV9z
dHJlYW1faW5pdChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAogCWZyZWVfb2FfYnVm
ZmVyKHN0cmVhbSk7CiAKIGVycl9vYV9idWZfYWxsb2M6Ci0JcHV0X29hX2NvbmZpZyhkZXZfcHJp
diwgc3RyZWFtLT5vYV9jb25maWcpOwotCiAJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRl
dl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwogCWludGVsX3J1bnRpbWVfcG1fcHV0KCZk
ZXZfcHJpdi0+cnVudGltZV9wbSwgc3RyZWFtLT53YWtlcmVmKTsKIAorCWZyZWVfb2FfY29uZmln
cyhzdHJlYW0pOworCiBlcnJfY29uZmlnOgogCWlmIChzdHJlYW0tPmN0eCkKIAkJb2FfcHV0X3Jl
bmRlcl9jdHhfaWQoc3RyZWFtKTsKQEAgLTIzMDksOCArMjQ4OCwxMiBAQCB2b2lkIGk5MTVfb2Ff
aW5pdF9yZWdfc3RhdGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAogCQlyZXR1cm47
CiAKIAlzdHJlYW0gPSBlbmdpbmUtPmk5MTUtPnBlcmYuZXhjbHVzaXZlX3N0cmVhbTsKLQlpZiAo
c3RyZWFtKQorCisJaWYgKHN0cmVhbSkgeworCQltdXRleF9sb2NrKCZzdHJlYW0tPmNvbmZpZ19t
dXRleCk7CiAJCWdlbjhfdXBkYXRlX3JlZ19zdGF0ZV91bmxvY2tlZChzdHJlYW0sIGNlLCByZWdz
LCBzdHJlYW0tPm9hX2NvbmZpZyk7CisJCW11dGV4X3VubG9jaygmc3RyZWFtLT5jb25maWdfbXV0
ZXgpOworCX0KIH0KIAogLyoqCkBAIC0yNjUzLDcgKzI4MzYsOSBAQCBzdGF0aWMgaW50IGk5MTVf
cGVyZl9yZWxlYXNlKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQogCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHN0cmVhbS0+ZGV2X3ByaXY7CiAKIAlt
dXRleF9sb2NrKCZkZXZfcHJpdi0+cGVyZi5sb2NrKTsKKwogCWk5MTVfcGVyZl9kZXN0cm95X2xv
Y2tlZChzdHJlYW0pOworCiAJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cGVyZi5sb2NrKTsKIAog
CS8qIFJlbGVhc2UgdGhlIHJlZmVyZW5jZSB0aGUgcGVyZiBzdHJlYW0ga2VwdCBvbiB0aGUgZHJp
dmVyLiAqLwpAQCAtMjc2Miw2ICsyOTQ3LDcgQEAgaTkxNV9wZXJmX29wZW5faW9jdGxfbG9ja2Vk
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJZ290byBlcnJfY3R4OwogCX0K
IAorCUlOSVRfTElTVF9IRUFEKCZzdHJlYW0tPm9hX2NvbmZpZ19ib3MpOwogCXN0cmVhbS0+ZGV2
X3ByaXYgPSBkZXZfcHJpdjsKIAlzdHJlYW0tPmN0eCA9IHNwZWNpZmljX2N0eDsKIApAQCAtMzA4
OCw3ICszMjc0LDggQEAgdm9pZCBpOTE1X3BlcmZfcmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQogCWlmIChyZXQpCiAJCWdvdG8gc3lzZnNfZXJyb3I7CiAKLQlhdG9t
aWNfc2V0KCZkZXZfcHJpdi0+cGVyZi50ZXN0X2NvbmZpZy5yZWZfY291bnQsIDEpOworCWRldl9w
cml2LT5wZXJmLnRlc3RfY29uZmlnLmk5MTUgPSBkZXZfcHJpdjsKKwlrcmVmX2luaXQoJmRldl9w
cml2LT5wZXJmLnRlc3RfY29uZmlnLnJlZik7CiAKIAlnb3RvIGV4aXQ7CiAKQEAgLTMzNDQsNyAr
MzUzMSw4IEBAIGludCBpOTE1X3BlcmZfYWRkX2NvbmZpZ19pb2N0bChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LCB2b2lkICpkYXRhLAogCQlyZXR1cm4gLUVOT01FTTsKIAl9CiAKLQlhdG9taWNfc2V0
KCZvYV9jb25maWctPnJlZl9jb3VudCwgMSk7CisJb2FfY29uZmlnLT5pOTE1ID0gZGV2X3ByaXY7
CisJa3JlZl9pbml0KCZvYV9jb25maWctPnJlZik7CiAKIAlpZiAoIXV1aWRfaXNfdmFsaWQoYXJn
cy0+dXVpZCkpIHsKIAkJRFJNX0RFQlVHKCJJbnZhbGlkIHV1aWQgZm9ybWF0IGZvciBPQSBjb25m
aWdcbiIpOwpAQCAtMzQ0Myw3ICszNjMxLDcgQEAgaW50IGk5MTVfcGVyZl9hZGRfY29uZmlnX2lv
Y3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiBzeXNmc19lcnI6CiAJbXV0
ZXhfdW5sb2NrKCZkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2xvY2spOwogcmVnX2VycjoKLQlwdXRf
b2FfY29uZmlnKGRldl9wcml2LCBvYV9jb25maWcpOworCWk5MTVfb2FfY29uZmlnX3B1dChvYV9j
b25maWcpOwogCURSTV9ERUJVRygiRmFpbGVkIHRvIGFkZCBuZXcgT0EgY29uZmlnXG4iKTsKIAly
ZXR1cm4gZXJyOwogfQpAQCAtMzQ3OSwxMyArMzY2NywxMyBAQCBpbnQgaTkxNV9wZXJmX3JlbW92
ZV9jb25maWdfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAogCXJl
dCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZGV2X3ByaXYtPnBlcmYubWV0cmljc19sb2Nr
KTsKIAlpZiAocmV0KQotCQlnb3RvIGxvY2tfZXJyOworCQlyZXR1cm4gcmV0OwogCiAJb2FfY29u
ZmlnID0gaWRyX2ZpbmQoJmRldl9wcml2LT5wZXJmLm1ldHJpY3NfaWRyLCAqYXJnKTsKIAlpZiAo
IW9hX2NvbmZpZykgewogCQlEUk1fREVCVUcoIkZhaWxlZCB0byByZW1vdmUgdW5rbm93biBPQSBj
b25maWdcbiIpOwogCQlyZXQgPSAtRU5PRU5UOwotCQlnb3RvIGNvbmZpZ19lcnI7CisJCWdvdG8g
ZXJyX3VubG9jazsKIAl9CiAKIAlHRU1fQlVHX09OKCphcmcgIT0gb2FfY29uZmlnLT5pZCk7CkBA
IC0zNDk1LDEzICszNjgzLDE2IEBAIGludCBpOTE1X3BlcmZfcmVtb3ZlX2NvbmZpZ19pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCiAJaWRyX3JlbW92ZSgmZGV2X3By
aXYtPnBlcmYubWV0cmljc19pZHIsICphcmcpOwogCisJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+
cGVyZi5tZXRyaWNzX2xvY2spOworCiAJRFJNX0RFQlVHKCJSZW1vdmVkIGNvbmZpZyAlcyBpZD0l
aVxuIiwgb2FfY29uZmlnLT51dWlkLCBvYV9jb25maWctPmlkKTsKIAotCXB1dF9vYV9jb25maWco
ZGV2X3ByaXYsIG9hX2NvbmZpZyk7CisJaTkxNV9vYV9jb25maWdfcHV0KG9hX2NvbmZpZyk7CisK
KwlyZXR1cm4gMDsKIAotY29uZmlnX2VycjoKK2Vycl91bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZk
ZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2xvY2spOwotbG9ja19lcnI6CiAJcmV0dXJuIHJldDsKIH0K
IApAQCAtMzY3MSwxMCArMzg2Miw5IEBAIHZvaWQgaTkxNV9wZXJmX2luaXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogCiBzdGF0aWMgaW50IGRlc3Ryb3lfY29uZmlnKGludCBp
ZCwgdm9pZCAqcCwgdm9pZCAqZGF0YSkKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSBkYXRhOwogCXN0cnVjdCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmlnID0gcDsKIAot
CXB1dF9vYV9jb25maWcoZGV2X3ByaXYsIG9hX2NvbmZpZyk7CisJaTkxNV9vYV9jb25maWdfcHV0
KG9hX2NvbmZpZyk7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTM2ODgsNyArMzg3OCw3IEBAIHZvaWQg
aTkxNV9wZXJmX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWlmICgh
ZGV2X3ByaXYtPnBlcmYuaW5pdGlhbGl6ZWQpCiAJCXJldHVybjsKIAotCWlkcl9mb3JfZWFjaCgm
ZGV2X3ByaXYtPnBlcmYubWV0cmljc19pZHIsIGRlc3Ryb3lfY29uZmlnLCBkZXZfcHJpdik7CisJ
aWRyX2Zvcl9lYWNoKCZkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2lkciwgZGVzdHJveV9jb25maWcs
IE5VTEwpOwogCWlkcl9kZXN0cm95KCZkZXZfcHJpdi0+cGVyZi5tZXRyaWNzX2lkcik7CiAKIAl1
bnJlZ2lzdGVyX3N5c2N0bF90YWJsZShkZXZfcHJpdi0+cGVyZi5zeXNjdGxfaGVhZGVyKTsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9wZXJmLmgKaW5kZXggMjcwMTkzNTI2YjU2Li4xYzg1NDg3ODc2YTQgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfcGVyZi5oCkBAIC03LDEyICs3LDE2IEBACiAjZGVmaW5lIF9fSTkx
NV9QRVJGX0hfXwogCiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxsaW51eC9r
cmVmLmg+CiAKICNpbmNsdWRlICJpOTE1X3BlcmZfdHlwZXMuaCIKIAogc3RydWN0IGRybV9kZXZp
Y2U7CiBzdHJ1Y3QgZHJtX2ZpbGU7CitzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdDsKIHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlOworc3RydWN0IGk5MTVfb2FfY29uZmlnOworc3RydWN0IGk5MTVf
cGVyZl9zdHJlYW07CiBzdHJ1Y3QgaW50ZWxfY29udGV4dDsKIHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3M7CiAKQEAgLTMxLDUgKzM1LDI3IEBAIGludCBpOTE1X3BlcmZfcmVtb3ZlX2NvbmZpZ19pb2N0
bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogdm9pZCBpOTE1X29hX2luaXRf
cmVnX3N0YXRlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJCSAgICBzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsCiAJCQkgICAgdTMyICpyZWdfc3RhdGUpOworaW50IGk5MTVfcGVy
Zl9nZXRfb2FfY29uZmlnKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAorCQkJICAgIGlu
dCBtZXRyaWNzX3NldCwKKwkJCSAgICBzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKipvdXRfY29uZmln
KTsKK2ludCBpOTE1X3BlcmZfZ2V0X29hX2NvbmZpZ19hbmRfYm8oc3RydWN0IGk5MTVfcGVyZl9z
dHJlYW0gKnN0cmVhbSwKKwkJCQkgICBpbnQgbWV0cmljc19zZXQsCisJCQkJICAgc3RydWN0IGk5
MTVfb2FfY29uZmlnICoqb3V0X2NvbmZpZywKKwkJCQkgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqKm91dF9vYmopOwordm9pZCBpOTE1X29hX2NvbmZpZ19yZWxlYXNlKHN0cnVjdCBrcmVm
ICpyZWYpOworCitzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X29hX2NvbmZpZyAqaTkxNV9vYV9j
b25maWdfZ2V0KHN0cnVjdCBpOTE1X29hX2NvbmZpZyAqb2FfY29uZmlnKQoreworCWtyZWZfZ2V0
KCZvYV9jb25maWctPnJlZik7CisJcmV0dXJuIG9hX2NvbmZpZzsKK30KKworc3RhdGljIGlubGlu
ZSB2b2lkIGk5MTVfb2FfY29uZmlnX3B1dChzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9hX2NvbmZp
ZykKK3sKKwlpZiAoIW9hX2NvbmZpZykKKwkJcmV0dXJuOworCisJa3JlZl9wdXQoJm9hX2NvbmZp
Zy0+cmVmLCBpOTE1X29hX2NvbmZpZ19yZWxlYXNlKTsKK30KIAogI2VuZGlmIC8qIF9fSTkxNV9Q
RVJGX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmX3R5
cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmZfdHlwZXMuaAppbmRleCAwZjcy
YzgzMTQyZGQuLjU4NDY5ZDJhMzk3MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9wZXJmX3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmX3R5
cGVzLmgKQEAgLTM3LDYgKzM3LDggQEAgc3RydWN0IGk5MTVfb2FfcmVnIHsKIH07CiAKIHN0cnVj
dCBpOTE1X29hX2NvbmZpZyB7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7CisKIAlj
aGFyIHV1aWRbVVVJRF9TVFJJTkdfTEVOICsgMV07CiAJaW50IGlkOwogCkBAIC01MSw3ICs1Myw3
IEBAIHN0cnVjdCBpOTE1X29hX2NvbmZpZyB7CiAJc3RydWN0IGF0dHJpYnV0ZSAqYXR0cnNbMl07
CiAJc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgc3lzZnNfbWV0cmljX2lkOwogCi0JYXRvbWljX3Qg
cmVmX2NvdW50OworCXN0cnVjdCBrcmVmIHJlZjsKIH07CiAKIHN0cnVjdCBpOTE1X3BlcmZfc3Ry
ZWFtOwpAQCAtMTczLDExICsxNzUsMjIgQEAgc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gewogCSAq
LwogCWNvbnN0IHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtX29wcyAqb3BzOwogCisJLyoqCisJICog
QGFjdGl2ZV9jb25maWdfbXV0ZXg6IFByb3RlY3RzIGFjY2VzcyB0byBAb2FfY29uZmlnICYgQG9h
X2NvbmZpZ19ib3MuCisJICovCisJc3RydWN0IG11dGV4IGNvbmZpZ19tdXRleDsKKwogCS8qKgog
CSAqIEBvYV9jb25maWc6IFRoZSBPQSBjb25maWd1cmF0aW9uIHVzZWQgYnkgdGhlIHN0cmVhbS4K
IAkgKi8KIAlzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKm9hX2NvbmZpZzsKIAorCS8qKgorCSAqIEBv
YV9jb25maWdfYm9zOiBBIGxpc3Qgb2Ygc3RydWN0IGk5MTVfb2FfY29uZmlnX2JvIGFsbG9jYXRl
ZCBsYXppbHkKKwkgKiBlYWNoIHRpbWUgQG9hX2NvbmZpZyBjaGFuZ2VzLgorCSAqLworCXN0cnVj
dCBsaXN0X2hlYWQgb2FfY29uZmlnX2JvczsKKwogCS8qKgogCSAqIFRoZSBPQSBjb250ZXh0IHNw
ZWNpZmljIGluZm9ybWF0aW9uLgogCSAqLwotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVs
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

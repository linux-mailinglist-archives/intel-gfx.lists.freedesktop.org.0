Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9DCD866A34
	for <lists+intel-gfx@lfdr.de>; Fri, 12 Jul 2019 11:43:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 381056E33A;
	Fri, 12 Jul 2019 09:43:33 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8B8926E33A
 for <intel-gfx@lists.freedesktop.org>; Fri, 12 Jul 2019 09:43:31 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17243558-1500050 
 for <intel-gfx@lists.freedesktop.org>; Fri, 12 Jul 2019 10:43:27 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 12 Jul 2019 10:43:22 +0100
Message-Id: <20190712094327.24437-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 1/6] drm/i915/gtt: Wrap page_table with
 page_directory
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIHBhZ2UgZGlyZWN0b3J5IGV4dGVuZHMgdGhlIHBhZ2UgdGFibGUgd2l0aCB0aGUgc2hhZG93
IGVudHJpZXMuIE1ha2UKdGhlIHBhZ2UgZGlyZWN0b3J5IHN0cnVjdCBlbWJlZCB0aGUgcGFnZSB0
YWJsZSBmb3IgZWFzaWVyIGNvZGUgcmV1c2UuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24g
PGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KUmV2aWV3ZWQtYnk6IE1pa2EgS3VvcHBhbGEgPG1p
a2Eua3VvcHBhbGFAbGludXguaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3JpbmdidWZmZXIuYyB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW1fZ3R0LmMgICAgICAgIHwgMTAwICsrKysrKysrKystLS0tLS0tLS0tLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmggICAgICAgIHwgIDE2ICsrLS0KIDMgZmlsZXMgY2hhbmdl
ZCwgNTcgaW5zZXJ0aW9ucygrKSwgNjEgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCmluZGV4IGE5ODY1MmU0MDU1Yy4uMjg3MzI3Njg3OWNi
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCkBAIC0xNTEy
LDcgKzE1MTIsNyBAQCBzdGF0aWMgaW50IGxvYWRfcGRfZGlyKHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxLCBjb25zdCBzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQpCiAKIAkqY3MrKyA9IE1JX0xPQURf
UkVHSVNURVJfSU1NKDEpOwogCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19QUF9E
SVJfQkFTRShlbmdpbmUtPm1taW9fYmFzZSkpOwotCSpjcysrID0gcHBndHQtPnBkLT5iYXNlLmdn
dHRfb2Zmc2V0IDw8IDEwOworCSpjcysrID0gcHhfYmFzZShwcGd0dC0+cGQpLT5nZ3R0X29mZnNl
dCA8PCAxMDsKIAogCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOwogCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtX2d0dC5jCmluZGV4IDFlNjAyMWU3NTk5My4uYjJhYTQ0MTAzZmIwIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYwpAQCAtMTA3LDYgKzEwNyw4IEBACiAgKgogICovCiAK
KyNkZWZpbmUgYXNfcGQoeCkgY29udGFpbmVyX29mKCh4KSwgdHlwZW9mKHN0cnVjdCBpOTE1X3Bh
Z2VfZGlyZWN0b3J5KSwgcHQpCisKIHN0YXRpYyBpbnQKIGk5MTVfZ2V0X2dndHRfdm1hX3BhZ2Vz
KHN0cnVjdCBpOTE1X3ZtYSAqdm1hKTsKIApAQCAtNzExLDI4ICs3MTMsMTcgQEAgc3RhdGljIHN0
cnVjdCBpOTE1X3BhZ2VfdGFibGUgKmFsbG9jX3B0KHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2Ug
KnZtKQogCXJldHVybiBwdDsKIH0KIAotc3RhdGljIHZvaWQgZnJlZV9wdChzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bSwgc3RydWN0IGk5MTVfcGFnZV90YWJsZSAqcHQpCi17Ci0JY2xlYW51
cF9wYWdlX2RtYSh2bSwgJnB0LT5iYXNlKTsKLQlrZnJlZShwdCk7Ci19Ci0KIHN0YXRpYyBzdHJ1
Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqX19hbGxvY19wZCh2b2lkKQogewogCXN0cnVjdCBpOTE1
X3BhZ2VfZGlyZWN0b3J5ICpwZDsKIAogCXBkID0ga21hbGxvYyhzaXplb2YoKnBkKSwgSTkxNV9H
RlBfQUxMT1dfRkFJTCk7Ci0KIAlpZiAodW5saWtlbHkoIXBkKSkKIAkJcmV0dXJuIE5VTEw7CiAK
LQltZW1zZXQoJnBkLT5iYXNlLCAwLCBzaXplb2YocGQtPmJhc2UpKTsKLQlhdG9taWNfc2V0KCZw
ZC0+dXNlZCwgMCk7CisJYXRvbWljX3NldChweF91c2VkKHBkKSwgMCk7CiAJc3Bpbl9sb2NrX2lu
aXQoJnBkLT5sb2NrKTsKIAotCS8qIGZvciBzYWZldHkgKi8KLQlwZC0+ZW50cnlbMF0gPSBOVUxM
OwotCiAJcmV0dXJuIHBkOwogfQogCkBAIC03NDQsNyArNzM1LDcgQEAgc3RhdGljIHN0cnVjdCBp
OTE1X3BhZ2VfZGlyZWN0b3J5ICphbGxvY19wZChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2
bSkKIAlpZiAodW5saWtlbHkoIXBkKSkKIAkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CiAKLQlp
ZiAodW5saWtlbHkoc2V0dXBfcGFnZV9kbWEodm0sICZwZC0+YmFzZSkpKSB7CisJaWYgKHVubGlr
ZWx5KHNldHVwX3BhZ2VfZG1hKHZtLCBweF9iYXNlKHBkKSkpKSB7CiAJCWtmcmVlKHBkKTsKIAkJ
cmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CiAJfQpAQCAtNzUyLDEzICs3NDMsMTQgQEAgc3RhdGlj
IHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICphbGxvY19wZChzdHJ1Y3QgaTkxNV9hZGRyZXNz
X3NwYWNlICp2bSkKIAlyZXR1cm4gcGQ7CiB9CiAKLXN0YXRpYyB2b2lkIGZyZWVfcGQoc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCi0JCSAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9y
eSAqcGQpCitzdGF0aWMgdm9pZCBmcmVlX3BkKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
LCBzdHJ1Y3QgaTkxNV9wYWdlX2RtYSAqcGQpCiB7Ci0JY2xlYW51cF9wYWdlX2RtYSh2bSwgJnBk
LT5iYXNlKTsKKwljbGVhbnVwX3BhZ2VfZG1hKHZtLCBwZCk7CiAJa2ZyZWUocGQpOwogfQogCisj
ZGVmaW5lIGZyZWVfcHgodm0sIHB4KSBmcmVlX3BkKHZtLCBweF9iYXNlKHB4KSkKKwogc3RhdGlj
IHZvaWQgaW5pdF9wZChzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqcGQsCiAJCSAgICBzdHJ1
Y3QgaTkxNV9wYWdlX2RtYSAqc2NyYXRjaCkKIHsKQEAgLTc4Myw5ICs3NzUsOSBAQCBfX3NldF9w
ZF9lbnRyeShzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqIGNvbnN0IHBkLAogCSAgICAgICBz
dHJ1Y3QgaTkxNV9wYWdlX2RtYSAqIGNvbnN0IHRvLAogCSAgICAgICB1NjQgKCplbmNvZGUpKGNv
bnN0IGRtYV9hZGRyX3QsIGNvbnN0IGVudW0gaTkxNV9jYWNoZV9sZXZlbCkpCiB7Ci0JR0VNX0JV
R19PTihhdG9taWNfcmVhZCgmcGQtPnVzZWQpID4gNTEyKTsKKwlHRU1fQlVHX09OKGF0b21pY19y
ZWFkKHB4X3VzZWQocGQpKSA+IDUxMik7CiAKLQlhdG9taWNfaW5jKCZwZC0+dXNlZCk7CisJYXRv
bWljX2luYyhweF91c2VkKHBkKSk7CiAJcGQtPmVudHJ5W3BkZV0gPSB0bzsKIAl3cml0ZV9kbWFf
ZW50cnkocHhfYmFzZShwZCksIHBkZSwgZW5jb2RlKHRvLT5kYWRkciwgSTkxNV9DQUNIRV9MTEMp
KTsKIH0KQEAgLTc5NiwxMSArNzg4LDExIEBAIF9fY2xlYXJfcGRfZW50cnkoc3RydWN0IGk5MTVf
cGFnZV9kaXJlY3RvcnkgKiBjb25zdCBwZCwKIAkJIHN0cnVjdCBpOTE1X3BhZ2VfZG1hICogY29u
c3QgdG8sCiAJCSB1NjQgKCplbmNvZGUpKGNvbnN0IGRtYV9hZGRyX3QsIGNvbnN0IGVudW0gaTkx
NV9jYWNoZV9sZXZlbCkpCiB7Ci0JR0VNX0JVR19PTihhdG9taWNfcmVhZCgmcGQtPnVzZWQpID09
IDApOworCUdFTV9CVUdfT04oYXRvbWljX3JlYWQocHhfdXNlZChwZCkpID09IDApOwogCiAJd3Jp
dGVfZG1hX2VudHJ5KHB4X2Jhc2UocGQpLCBwZGUsIGVuY29kZSh0by0+ZGFkZHIsIEk5MTVfQ0FD
SEVfTExDKSk7CiAJcGQtPmVudHJ5W3BkZV0gPSB0bzsKLQlhdG9taWNfZGVjKCZwZC0+dXNlZCk7
CisJYXRvbWljX2RlYyhweF91c2VkKHBkKSk7CiB9CiAKICNkZWZpbmUgc2V0X3BkX2VudHJ5KHBk
LCBwZGUsIHRvKSBcCkBAIC04MTIsMTMgKzgwNCwxMyBAQCBfX2NsZWFyX3BkX2VudHJ5KHN0cnVj
dCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICogY29uc3QgcGQsCiBzdGF0aWMgYm9vbAogcmVsZWFzZV9w
ZF9lbnRyeShzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqIGNvbnN0IHBkLAogCQkgY29uc3Qg
dW5zaWduZWQgc2hvcnQgcGRlLAotCQkgYXRvbWljX3QgKmNvdW50ZXIsCisJCSBzdHJ1Y3QgaTkx
NV9wYWdlX3RhYmxlICogY29uc3QgcHQsCiAJCSBzdHJ1Y3QgaTkxNV9wYWdlX2RtYSAqIGNvbnN0
IHNjcmF0Y2gpCiB7CiAJYm9vbCBmcmVlID0gZmFsc2U7CiAKIAlzcGluX2xvY2soJnBkLT5sb2Nr
KTsKLQlpZiAoYXRvbWljX2RlY19hbmRfdGVzdChjb3VudGVyKSkgeworCWlmIChhdG9taWNfZGVj
X2FuZF90ZXN0KCZwdC0+dXNlZCkpIHsKIAkJY2xlYXJfcGRfZW50cnkocGQsIHBkZSwgc2NyYXRj
aCk7CiAJCWZyZWUgPSB0cnVlOwogCX0KQEAgLTg2OSw4ICs4NjEsOCBAQCBzdGF0aWMgdm9pZCBn
ZW44X3BwZ3R0X2NsZWFyX3BkKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAogCiAJCWF0
b21pY19pbmMoJnB0LT51c2VkKTsKIAkJZ2VuOF9wcGd0dF9jbGVhcl9wdCh2bSwgcHQsIHN0YXJ0
LCBsZW5ndGgpOwotCQlpZiAocmVsZWFzZV9wZF9lbnRyeShwZCwgcGRlLCAmcHQtPnVzZWQsICZ2
bS0+c2NyYXRjaF9wdCkpCi0JCQlmcmVlX3B0KHZtLCBwdCk7CisJCWlmIChyZWxlYXNlX3BkX2Vu
dHJ5KHBkLCBwZGUsIHB0LCAmdm0tPnNjcmF0Y2hfcHQpKQorCQkJZnJlZV9weCh2bSwgcHQpOwog
CX0KIH0KIApAQCAtODg3LDEwICs4NzksMTAgQEAgc3RhdGljIHZvaWQgZ2VuOF9wcGd0dF9jbGVh
cl9wZHAoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCiAJZ2VuOF9mb3JfZWFjaF9wZHBl
KHBkLCBwZHAsIHN0YXJ0LCBsZW5ndGgsIHBkcGUpIHsKIAkJR0VNX0JVR19PTihweF9iYXNlKHBk
KSA9PSAmdm0tPnNjcmF0Y2hfcGQpOwogCi0JCWF0b21pY19pbmMoJnBkLT51c2VkKTsKKwkJYXRv
bWljX2luYyhweF91c2VkKHBkKSk7CiAJCWdlbjhfcHBndHRfY2xlYXJfcGQodm0sIHBkLCBzdGFy
dCwgbGVuZ3RoKTsKLQkJaWYgKHJlbGVhc2VfcGRfZW50cnkocGRwLCBwZHBlLCAmcGQtPnVzZWQs
ICZ2bS0+c2NyYXRjaF9wZCkpCi0JCQlmcmVlX3BkKHZtLCBwZCk7CisJCWlmIChyZWxlYXNlX3Bk
X2VudHJ5KHBkcCwgcGRwZSwgJnBkLT5wdCwgJnZtLT5zY3JhdGNoX3BkKSkKKwkJCWZyZWVfcHgo
dm0sIHBkKTsKIAl9CiB9CiAKQEAgLTkxNywxMCArOTA5LDEwIEBAIHN0YXRpYyB2b2lkIGdlbjhf
cHBndHRfY2xlYXJfNGx2bChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwKIAlnZW44X2Zv
cl9lYWNoX3BtbDRlKHBkcCwgcG1sNCwgc3RhcnQsIGxlbmd0aCwgcG1sNGUpIHsKIAkJR0VNX0JV
R19PTihweF9iYXNlKHBkcCkgPT0gJnZtLT5zY3JhdGNoX3BkcCk7CiAKLQkJYXRvbWljX2luYygm
cGRwLT51c2VkKTsKKwkJYXRvbWljX2luYyhweF91c2VkKHBkcCkpOwogCQlnZW44X3BwZ3R0X2Ns
ZWFyX3BkcCh2bSwgcGRwLCBzdGFydCwgbGVuZ3RoKTsKLQkJaWYgKHJlbGVhc2VfcGRfZW50cnko
cG1sNCwgcG1sNGUsICZwZHAtPnVzZWQsICZ2bS0+c2NyYXRjaF9wZHApKQotCQkJZnJlZV9wZCh2
bSwgcGRwKTsKKwkJaWYgKHJlbGVhc2VfcGRfZW50cnkocG1sNCwgcG1sNGUsICZwZHAtPnB0LCAm
dm0tPnNjcmF0Y2hfcGRwKSkKKwkJCWZyZWVfcHgodm0sIHBkcCk7CiAJfQogfQogCkBAIC0xMTc1
LDcgKzExNjcsNyBAQCBzdGF0aWMgdm9pZCBnZW44X2ZyZWVfcGFnZV90YWJsZXMoc3RydWN0IGk5
MTVfYWRkcmVzc19zcGFjZSAqdm0sCiAKIAlmb3IgKGkgPSAwOyBpIDwgSTkxNV9QREVTOyBpKysp
IHsKIAkJaWYgKHBkLT5lbnRyeVtpXSAhPSAmdm0tPnNjcmF0Y2hfcHQpCi0JCQlmcmVlX3B0KHZt
LCBwZC0+ZW50cnlbaV0pOworCQkJZnJlZV9wZCh2bSwgcGQtPmVudHJ5W2ldKTsKIAl9CiB9CiAK
QEAgLTEyNTMsOSArMTI0NSw5IEBAIHN0YXRpYyBpbnQgZ2VuOF9wcGd0dF9ub3RpZnlfdmd0KHN0
cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCwgYm9vbCBjcmVhdGUpCiAJaW50IGk7CiAKIAlpZiAoY3Jl
YXRlKQotCQlhdG9taWNfaW5jKCZwcGd0dC0+cGQtPnVzZWQpOyAvKiBuZXZlciByZW1vdmUgKi8K
KwkJYXRvbWljX2luYyhweF91c2VkKHBwZ3R0LT5wZCkpOyAvKiBuZXZlciByZW1vdmUgKi8KIAll
bHNlCi0JCWF0b21pY19kZWMoJnBwZ3R0LT5wZC0+dXNlZCk7CisJCWF0b21pY19kZWMocHhfdXNl
ZChwcGd0dC0+cGQpKTsKIAogCWlmIChpOTE1X3ZtX2lzXzRsdmwodm0pKSB7CiAJCWNvbnN0IHU2
NCBkYWRkciA9IHB4X2RtYShwcGd0dC0+cGQpOwpAQCAtMTI5Niw3ICsxMjg4LDcgQEAgc3RhdGlj
IHZvaWQgZ2VuOF9wcGd0dF9jbGVhbnVwXzNsdmwoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm0sCiAJCWZyZWVfcGQodm0sIHBkcC0+ZW50cnlbaV0pOwogCX0KIAotCWZyZWVfcGQodm0sIHBk
cCk7CisJZnJlZV9weCh2bSwgcGRwKTsKIH0KIAogc3RhdGljIHZvaWQgZ2VuOF9wcGd0dF9jbGVh
bnVwXzRsdmwoc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0KQpAQCAtMTMxMyw3ICsxMzA1LDcgQEAg
c3RhdGljIHZvaWQgZ2VuOF9wcGd0dF9jbGVhbnVwXzRsdmwoc3RydWN0IGk5MTVfcHBndHQgKnBw
Z3R0KQogCQlnZW44X3BwZ3R0X2NsZWFudXBfM2x2bCgmcHBndHQtPnZtLCBwZHApOwogCX0KIAot
CWZyZWVfcGQoJnBwZ3R0LT52bSwgcG1sNCk7CisJZnJlZV9weCgmcHBndHQtPnZtLCBwbWw0KTsK
IH0KIAogc3RhdGljIHZvaWQgZ2VuOF9wcGd0dF9jbGVhbnVwKHN0cnVjdCBpOTE1X2FkZHJlc3Nf
c3BhY2UgKnZtKQpAQCAtMTM3Nyw3ICsxMzY5LDcgQEAgc3RhdGljIGludCBnZW44X3BwZ3R0X2Fs
bG9jX3BkKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAogCWdlbjhfcHBndHRfY2xlYXJf
cGQodm0sIHBkLCBmcm9tLCBzdGFydCAtIGZyb20pOwogb3V0OgogCWlmIChhbGxvYykKLQkJZnJl
ZV9wdCh2bSwgYWxsb2MpOworCQlmcmVlX3B4KHZtLCBhbGxvYyk7CiAJcmV0dXJuIHJldDsKIH0K
IApAQCAtMTQxMyw3ICsxNDA1LDcgQEAgc3RhdGljIGludCBnZW44X3BwZ3R0X2FsbG9jX3BkcChz
dHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwKIAkJCQlwZCA9IHBkcC0+ZW50cnlbcGRwZV07
CiAJCQl9CiAJCX0KLQkJYXRvbWljX2luYygmcGQtPnVzZWQpOworCQlhdG9taWNfaW5jKHB4X3Vz
ZWQocGQpKTsKIAkJc3Bpbl91bmxvY2soJnBkcC0+bG9jayk7CiAKIAkJcmV0ID0gZ2VuOF9wcGd0
dF9hbGxvY19wZCh2bSwgcGQsIHN0YXJ0LCBsZW5ndGgpOwpAQCAtMTQyMSwxOSArMTQxMywxOSBA
QCBzdGF0aWMgaW50IGdlbjhfcHBndHRfYWxsb2NfcGRwKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3Bh
Y2UgKnZtLAogCQkJZ290byB1bndpbmRfcGQ7CiAKIAkJc3Bpbl9sb2NrKCZwZHAtPmxvY2spOwot
CQlhdG9taWNfZGVjKCZwZC0+dXNlZCk7CisJCWF0b21pY19kZWMocHhfdXNlZChwZCkpOwogCX0K
IAlzcGluX3VubG9jaygmcGRwLT5sb2NrKTsKIAlnb3RvIG91dDsKIAogdW53aW5kX3BkOgotCWlm
IChyZWxlYXNlX3BkX2VudHJ5KHBkcCwgcGRwZSwgJnBkLT51c2VkLCAmdm0tPnNjcmF0Y2hfcGQp
KQotCQlmcmVlX3BkKHZtLCBwZCk7CisJaWYgKHJlbGVhc2VfcGRfZW50cnkocGRwLCBwZHBlLCAm
cGQtPnB0LCAmdm0tPnNjcmF0Y2hfcGQpKQorCQlmcmVlX3B4KHZtLCBwZCk7CiB1bndpbmQ6CiAJ
Z2VuOF9wcGd0dF9jbGVhcl9wZHAodm0sIHBkcCwgZnJvbSwgc3RhcnQgLSBmcm9tKTsKIG91dDoK
IAlpZiAoYWxsb2MpCi0JCWZyZWVfcGQodm0sIGFsbG9jKTsKKwkJZnJlZV9weCh2bSwgYWxsb2Mp
OwogCXJldHVybiByZXQ7CiB9CiAKQEAgLTE0NzcsNyArMTQ2OSw3IEBAIHN0YXRpYyBpbnQgZ2Vu
OF9wcGd0dF9hbGxvY180bHZsKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAogCQkJCXBk
cCA9IHBtbDQtPmVudHJ5W3BtbDRlXTsKIAkJCX0KIAkJfQotCQlhdG9taWNfaW5jKCZwZHAtPnVz
ZWQpOworCQlhdG9taWNfaW5jKHB4X3VzZWQocGRwKSk7CiAJCXNwaW5fdW5sb2NrKCZwbWw0LT5s
b2NrKTsKIAogCQlyZXQgPSBnZW44X3BwZ3R0X2FsbG9jX3BkcCh2bSwgcGRwLCBzdGFydCwgbGVu
Z3RoKTsKQEAgLTE0ODUsMTkgKzE0NzcsMTkgQEAgc3RhdGljIGludCBnZW44X3BwZ3R0X2FsbG9j
XzRsdmwoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCiAJCQlnb3RvIHVud2luZF9wZHA7
CiAKIAkJc3Bpbl9sb2NrKCZwbWw0LT5sb2NrKTsKLQkJYXRvbWljX2RlYygmcGRwLT51c2VkKTsK
KwkJYXRvbWljX2RlYyhweF91c2VkKHBkcCkpOwogCX0KIAlzcGluX3VubG9jaygmcG1sNC0+bG9j
ayk7CiAJZ290byBvdXQ7CiAKIHVud2luZF9wZHA6Ci0JaWYgKHJlbGVhc2VfcGRfZW50cnkocG1s
NCwgcG1sNGUsICZwZHAtPnVzZWQsICZ2bS0+c2NyYXRjaF9wZHApKQotCQlmcmVlX3BkKHZtLCBw
ZHApOworCWlmIChyZWxlYXNlX3BkX2VudHJ5KHBtbDQsIHBtbDRlLCAmcGRwLT5wdCwgJnZtLT5z
Y3JhdGNoX3BkcCkpCisJCWZyZWVfcHgodm0sIHBkcCk7CiB1bndpbmQ6CiAJZ2VuOF9wcGd0dF9j
bGVhcl80bHZsKHZtLCBmcm9tLCBzdGFydCAtIGZyb20pOwogb3V0OgogCWlmIChhbGxvYykKLQkJ
ZnJlZV9wZCh2bSwgYWxsb2MpOworCQlmcmVlX3B4KHZtLCBhbGxvYyk7CiAJcmV0dXJuIHJldDsK
IH0KIApAQCAtMTUyMyw3ICsxNTE1LDcgQEAgc3RhdGljIGludCBnZW44X3ByZWFsbG9jYXRlX3Rv
cF9sZXZlbF9wZHAoc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0KQogCiB1bndpbmQ6CiAJZ2VuOF9w
cGd0dF9jbGVhcl9wZHAodm0sIHBkcCwgZnJvbSwgc3RhcnQgLSBmcm9tKTsKLQlhdG9taWNfc2V0
KCZwZHAtPnVzZWQsIDApOworCWF0b21pY19zZXQocHhfdXNlZChwZHApLCAwKTsKIAlyZXR1cm4g
LUVOT01FTTsKIH0KIApAQCAtMTU1MCw3ICsxNTQyLDcgQEAgc3RhdGljIHZvaWQgaW5pdF9wZF9u
KHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAogCQkgICAgICBjb25zdCB1bnNpZ25lZCBp
bnQgZW50cmllcykKIHsKIAljb25zdCB1NjQgZGFkZHIgPSBnZW44X3BkZV9lbmNvZGUodG8tPmRh
ZGRyLCBJOTE1X0NBQ0hFX0xMQyk7Ci0JdTY0ICogY29uc3QgdmFkZHIgPSBrbWFwX2F0b21pYyhw
ZC0+YmFzZS5wYWdlKTsKKwl1NjQgKiBjb25zdCB2YWRkciA9IGttYXBfYXRvbWljX3B4KHBkKTsK
IAogCW1lbXNldDY0KHZhZGRyLCBkYWRkciwgZW50cmllcyk7CiAJa3VubWFwX2F0b21pYyh2YWRk
cik7CkBAIC0xNTc4LDcgKzE1NzAsNyBAQCBnZW44X2FsbG9jX3RvcF9wZChzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bSkKIAogCXBkLT5lbnRyeVtHRU44XzNMVkxfUERQRVNdID0gTlVMTDsK
IAotCWlmICh1bmxpa2VseShzZXR1cF9wYWdlX2RtYSh2bSwgJnBkLT5iYXNlKSkpIHsKKwlpZiAo
dW5saWtlbHkoc2V0dXBfcGFnZV9kbWEodm0sIHB4X2Jhc2UocGQpKSkpIHsKIAkJa2ZyZWUocGQp
OwogCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKIAl9CkBAIC0xNjU0LDcgKzE2NDYsNyBAQCBz
dGF0aWMgc3RydWN0IGk5MTVfcHBndHQgKmdlbjhfcHBndHRfY3JlYXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQogCXJldHVybiBwcGd0dDsKIAogZXJyX2ZyZWVfcGQ6Ci0JZnJlZV9w
ZCgmcHBndHQtPnZtLCBwcGd0dC0+cGQpOworCWZyZWVfcHgoJnBwZ3R0LT52bSwgcHBndHQtPnBk
KTsKIGVycl9mcmVlX3NjcmF0Y2g6CiAJZnJlZV9zY3JhdGNoKCZwcGd0dC0+dm0pOwogZXJyX2Zy
ZWU6CkBAIC0xODY1LDcgKzE4NTcsNyBAQCBzdGF0aWMgaW50IGdlbjZfYWxsb2NfdmFfcmFuZ2Uo
c3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCiAJZ2VuNl9wcGd0dF9jbGVhcl9yYW5nZSh2
bSwgZnJvbSwgc3RhcnQgLSBmcm9tKTsKIG91dDoKIAlpZiAoYWxsb2MpCi0JCWZyZWVfcHQodm0s
IGFsbG9jKTsKKwkJZnJlZV9weCh2bSwgYWxsb2MpOwogCWludGVsX3J1bnRpbWVfcG1fcHV0KCZ2
bS0+aTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJcmV0dXJuIHJldDsKIH0KQEAgLTE5MDYs
NyArMTg5OCw3IEBAIHN0YXRpYyB2b2lkIGdlbjZfcHBndHRfZnJlZV9wZChzdHJ1Y3QgZ2VuNl9w
cGd0dCAqcHBndHQpCiAKIAlnZW42X2Zvcl9hbGxfcGRlcyhwdCwgcGQsIHBkZSkKIAkJaWYgKHB4
X2Jhc2UocHQpICE9ICZwcGd0dC0+YmFzZS52bS5zY3JhdGNoX3B0KQotCQkJZnJlZV9wdCgmcHBn
dHQtPmJhc2Uudm0sIHB0KTsKKwkJCWZyZWVfcHgoJnBwZ3R0LT5iYXNlLnZtLCBwdCk7CiB9CiAK
IHN0YXRpYyB2b2lkIGdlbjZfcHBndHRfY2xlYW51cChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNl
ICp2bSkKQEAgLTE5NDcsNyArMTkzOSw3IEBAIHN0YXRpYyBpbnQgcGRfdm1hX2JpbmQoc3RydWN0
IGk5MTVfdm1hICp2bWEsCiAJc3RydWN0IGk5MTVfcGFnZV90YWJsZSAqcHQ7CiAJdW5zaWduZWQg
aW50IHBkZTsKIAotCXBwZ3R0LT5iYXNlLnBkLT5iYXNlLmdndHRfb2Zmc2V0ID0gZ2d0dF9vZmZz
ZXQgKiBzaXplb2YoZ2VuNl9wdGVfdCk7CisJcHhfYmFzZShwcGd0dC0+YmFzZS5wZCktPmdndHRf
b2Zmc2V0ID0gZ2d0dF9vZmZzZXQgKiBzaXplb2YoZ2VuNl9wdGVfdCk7CiAJcHBndHQtPnBkX2Fk
ZHIgPSAoZ2VuNl9wdGVfdCBfX2lvbWVtICopZ2d0dC0+Z3NtICsgZ2d0dF9vZmZzZXQ7CiAKIAln
ZW42X2Zvcl9hbGxfcGRlcyhwdCwgcHBndHQtPmJhc2UucGQsIHBkZSkKQEAgLTE5NzUsNyArMTk2
Nyw3IEBAIHN0YXRpYyB2b2lkIHBkX3ZtYV91bmJpbmQoc3RydWN0IGk5MTVfdm1hICp2bWEpCiAJ
CWlmIChweF9iYXNlKHB0KSA9PSBzY3JhdGNoIHx8IGF0b21pY19yZWFkKCZwdC0+dXNlZCkpCiAJ
CQljb250aW51ZTsKIAotCQlmcmVlX3B0KCZwcGd0dC0+YmFzZS52bSwgcHQpOworCQlmcmVlX3B4
KCZwcGd0dC0+YmFzZS52bSwgcHQpOwogCQlwZC0+ZW50cnlbcGRlXSA9IHNjcmF0Y2g7CiAJfQog
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5oCmluZGV4IDkxZDhiNGMyMGM2MS4uNDhiYjhj
NTEyNWUzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuaAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuaApAQCAtMjQ2LDggKzI0Niw3
IEBAIHN0cnVjdCBpOTE1X3BhZ2VfdGFibGUgewogfTsKIAogc3RydWN0IGk5MTVfcGFnZV9kaXJl
Y3RvcnkgewotCXN0cnVjdCBpOTE1X3BhZ2VfZG1hIGJhc2U7Ci0JYXRvbWljX3QgdXNlZDsKKwlz
dHJ1Y3QgaTkxNV9wYWdlX3RhYmxlIHB0OwogCXNwaW5sb2NrX3QgbG9jazsKIAl2b2lkICplbnRy
eVs1MTJdOwogfTsKQEAgLTI2MiwxMCArMjYxLDE2IEBAIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0
b3J5IHsKICNkZWZpbmUgcHhfYmFzZShweCkgXAogCV9fcHhfY2hvb3NlX2V4cHIocHgsIHN0cnVj
dCBpOTE1X3BhZ2VfZG1hICosIF9feCwgXAogCV9fcHhfY2hvb3NlX2V4cHIocHgsIHN0cnVjdCBp
OTE1X3BhZ2VfdGFibGUgKiwgJl9feC0+YmFzZSwgXAotCV9fcHhfY2hvb3NlX2V4cHIocHgsIHN0
cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICosICZfX3gtPmJhc2UsIFwKKwlfX3B4X2Nob29zZV9l
eHByKHB4LCBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqLCAmX194LT5wdC5iYXNlLCBcCiAJ
KHZvaWQpMCkpKQogI2RlZmluZSBweF9kbWEocHgpIChweF9iYXNlKHB4KS0+ZGFkZHIpCiAKKyNk
ZWZpbmUgcHhfcHQocHgpIFwKKwlfX3B4X2Nob29zZV9leHByKHB4LCBzdHJ1Y3QgaTkxNV9wYWdl
X3RhYmxlICosIF9feCwgXAorCV9fcHhfY2hvb3NlX2V4cHIocHgsIHN0cnVjdCBpOTE1X3BhZ2Vf
ZGlyZWN0b3J5ICosICZfX3gtPnB0LCBcCisJKHZvaWQpMCkpCisjZGVmaW5lIHB4X3VzZWQocHgp
ICgmcHhfcHQocHgpLT51c2VkKQorCiBzdHJ1Y3QgaTkxNV92bWFfb3BzIHsKIAkvKiBNYXAgYW4g
b2JqZWN0IGludG8gYW4gYWRkcmVzcyBzcGFjZSB3aXRoIHRoZSBnaXZlbiBjYWNoZSBmbGFncy4g
Ki8KIAlpbnQgKCpiaW5kX3ZtYSkoc3RydWN0IGk5MTVfdm1hICp2bWEsCkBAIC02MDAsMTAgKzYw
NSw5IEBAIHN0YXRpYyBpbmxpbmUgdTY0IGdlbjhfcHRlX2NvdW50KHU2NCBhZGRyZXNzLCB1NjQg
bGVuZ3RoKQogc3RhdGljIGlubGluZSBkbWFfYWRkcl90CiBpOTE1X3BhZ2VfZGlyX2RtYV9hZGRy
KGNvbnN0IHN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCwgY29uc3QgdW5zaWduZWQgaW50IG4pCiB7
Ci0Jc3RydWN0IGk5MTVfcGFnZV9kaXJlY3RvcnkgKnBkOworCXN0cnVjdCBpOTE1X3BhZ2VfZG1h
ICpwdCA9IHBwZ3R0LT5wZC0+ZW50cnlbbl07CiAKLQlwZCA9IGk5MTVfcGRwX2VudHJ5KHBwZ3R0
LT5wZCwgbik7Ci0JcmV0dXJuIHB4X2RtYShwZCk7CisJcmV0dXJuIHB4X2RtYShwdCk7CiB9CiAK
IHN0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVfZ2d0dCAqCi0tIAoyLjIyLjAKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxp
c3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNr
dG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

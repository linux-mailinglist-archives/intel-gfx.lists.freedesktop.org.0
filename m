Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1473A684E3
	for <lists+intel-gfx@lfdr.de>; Mon, 15 Jul 2019 10:10:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3FB0D8982A;
	Mon, 15 Jul 2019 08:10:24 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BFB038981B
 for <intel-gfx@lists.freedesktop.org>; Mon, 15 Jul 2019 08:10:16 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17303261-1500050 
 for multiple; Mon, 15 Jul 2019 09:09:54 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 15 Jul 2019 09:09:46 +0100
Message-Id: <20190715080946.15593-24-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190715080946.15593-1-chris@chris-wilson.co.uk>
References: <20190715080946.15593-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 24/24] drm/i915/gt: Extract GT runtime power
 management from intel_pm.c
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIEdUIHBvd2Vyd2VsbHMgYW5kIHBvd2VybWFuYWdlbWVudCBpcyBHVCBjZW50cmljIGFuZCBz
aG91bGQgYmUKbWFuYWdlZCBmcm9tIHdpdGhpbiB0aGUgaW50ZWxfZ3QuIENhcnZlIG91dCB0aGUg
cnBzIHdvcmtlciwgcnBzIHNldHVwLApyYzYgc2V0dXAsIGxsYyBzZXR1cCBmcm9tIG91dCBvZiBp
bnRlbF9wbS5jIChhbmQgc3Vycm91bmRzKSBhbmQgY3JlYXRlIGEKbmV3IGhvbWUgZm9yIHRoZW0g
aW4gZ3QvCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5j
by51az4KQ2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+CkNjOiBE
YW5pZWxlIENlcmFvbG8gU3B1cmlvIDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9AaW50ZWwuY29tPgot
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgIDcg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jICB8ICAgIDgg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jICAgICAgICB8ICAgIDEg
KwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfYnJlYWRjcnVtYnMuYyAgIHwgICAgOCAr
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgICAgIHwgICAgMSAr
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jICAgICAgICAgICAgfCAgIDUwICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5oICAgICAgICAgICAgfCAgICA5ICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9pcnEuYyAgICAgICAgfCAgNDU2ICsr
KwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfaXJxLmggICAgICAgIHwgICA0NCAr
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jICAgICAgICAgfCAgIDQ5ICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5oICAgICAgICAgfCAgICAyICsK
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtX2lycS5jICAgICB8ICAxMDkgKwog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG1faXJxLmggICAgIHwgICAyMiArCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oICAgICAgfCAgIDExICstCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9sbGMuYyAgICAgICAgICAgfCAgMTIwICsKIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xsYy5oICAgICAgICAgICB8ICAgMTUgKwogZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbGxjX3R5cGVzLmggICAgIHwgICAxMyArCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yYzYuYyAgICAgICAgICAgfCAgNjY1ICsrKysKIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNi5oICAgICAgICAgICB8ICAgMjQgKwogZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2X3R5cGVzLmggICAgIHwgICAyNiArCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMgICAgfCAgIDE0ICstCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ycHMuYyAgICAgICAgICAgfCAxODcwICsrKysrKysr
KysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jwcy5oICAgICAgICAgICB8ICAgMzcg
KwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcnBzX3R5cGVzLmggICAgIHwgICA5MyAr
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWMuYyAgICAgICAgfCAgIDg3ICsK
IC4uLi9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyB8ICAgIDQgKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8ICAxMDkgKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAgICB8ICAgMjIgKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAgICB8ICAxMTEgLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyAgICAgICAgICAgICAgIHwgICAzOCArLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYyAgICAgICAgICAgICAgIHwgMTExMSArLS0t
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmggICAgICAgICAgICAgICB8ICAgNjQg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMgICAgICAgICAgICAgICB8ICAgMjIg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jICAgICAgICAgICB8ICAgIDcg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYyAgICAgICAgICAgICB8ICAgNzgg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMgICAgICAgICAgICAgICB8IDMwMTQg
KystLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmggICAgICAg
ICAgICAgICB8ICAgMjUgLQogMzcgZmlsZXMgY2hhbmdlZCwgNDEwNCBpbnNlcnRpb25zKCspLCA0
MjQyIGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2d0X2lycS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZ3RfaXJxLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9ndF9wbV9pcnEuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtX2lycS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbGxjLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9sbGMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2xsY190eXBlcy5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yYzYuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNl90eXBlcy5oCiBjcmVhdGUgbW9kZSAxMDA2NDQg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcnBzLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ycHMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jwc190eXBlcy5oCgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmls
ZQppbmRleCBjZGMyZDQ2MmRiOGIuLjQ0YjIxNzA3OWQyZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUK
QEAgLTc3LDEzICs3NywxOCBAQCBndC15ICs9IFwKIAlndC9pbnRlbF9lbmdpbmVfcG0ubyBcCiAJ
Z3QvaW50ZWxfZW5naW5lX3VzZXIubyBcCiAJZ3QvaW50ZWxfZ3QubyBcCisJZ3QvaW50ZWxfZ3Rf
aXJxLm8gXAogCWd0L2ludGVsX2d0X3BtLm8gXAorCWd0L2ludGVsX2d0X3BtX2lycS5vIFwKIAln
dC9pbnRlbF9oYW5nY2hlY2subyBcCisJZ3QvaW50ZWxfbGxjLm8gXAogCWd0L2ludGVsX2xyYy5v
IFwKKwlndC9pbnRlbF9tb2NzLm8gXAorCWd0L2ludGVsX3JjNi5vIFwKIAlndC9pbnRlbF9yZW5k
ZXJzdGF0ZS5vIFwKIAlndC9pbnRlbF9yZXNldC5vIFwKIAlndC9pbnRlbF9yaW5nYnVmZmVyLm8g
XAotCWd0L2ludGVsX21vY3MubyBcCisJZ3QvaW50ZWxfcnBzLm8gXAogCWd0L2ludGVsX3NzZXUu
byBcCiAJZ3QvaW50ZWxfdGltZWxpbmUubyBcCiAJZ3QvaW50ZWxfd29ya2Fyb3VuZHMubwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwppbmRleCAyMTlhZTVh
NjBiMzEuLjk5ZTlkOWI5ZTMzNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5LmMKQEAgLTU2LDYgKzU2LDggQEAKICNpbmNsdWRlICJkaXNwbGF5L2ludGVs
X3R2LmgiCiAjaW5jbHVkZSAiZGlzcGxheS9pbnRlbF92ZHNjLmgiCiAKKyNpbmNsdWRlICJndC9p
bnRlbF9ycHMuaCIKKwogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAiaTkxNV90cmFj
ZS5oIgogI2luY2x1ZGUgImludGVsX2FjcGkuaCIKQEAgLTE0MjUwLDcgKzE0MjUyLDcgQEAgc3Rh
dGljIGludCBkb19ycHNfYm9vc3Qoc3RydWN0IHdhaXRfcXVldWVfZW50cnkgKl93YWl0LAogCSAq
IHZibGFuayB3aXRob3V0IG91ciBpbnRlcnZlbnRpb24sIHNvIGxlYXZlIFJQUyBhbG9uZS4KIAkg
Ki8KIAlpZiAoIWk5MTVfcmVxdWVzdF9zdGFydGVkKHJxKSkKLQkJZ2VuNl9ycHNfYm9vc3QocnEp
OworCQlpbnRlbF9ycHNfYm9vc3QocnEpOwogCWk5MTVfcmVxdWVzdF9wdXQocnEpOwogCiAJZHJt
X2NydGNfdmJsYW5rX3B1dCh3YWl0LT5jcnRjKTsKQEAgLTE0NDQ5LDcgKzE0NDUxLDcgQEAgaW50
ZWxfcHJlcGFyZV9wbGFuZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKIAkgKiBtYXhpbXVt
IGNsb2NrcyBmb2xsb3dpbmcgYSB2YmxhbmsgbWlzcyAoc2VlIGRvX3Jwc19ib29zdCgpKS4KIAkg
Ki8KIAlpZiAoIWludGVsX3N0YXRlLT5ycHNfaW50ZXJhY3RpdmUpIHsKLQkJaW50ZWxfcnBzX21h
cmtfaW50ZXJhY3RpdmUoZGV2X3ByaXYsIHRydWUpOworCQlpbnRlbF9ycHNfbWFya19pbnRlcmFj
dGl2ZSgmZGV2X3ByaXYtPmd0LnJwcywgdHJ1ZSk7CiAJCWludGVsX3N0YXRlLT5ycHNfaW50ZXJh
Y3RpdmUgPSB0cnVlOwogCX0KIApAQCAtMTQ0NzQsNyArMTQ0NzYsNyBAQCBpbnRlbF9jbGVhbnVw
X3BsYW5lX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmRldik7CiAKIAlpZiAoaW50ZWxfc3RhdGUt
PnJwc19pbnRlcmFjdGl2ZSkgewotCQlpbnRlbF9ycHNfbWFya19pbnRlcmFjdGl2ZShkZXZfcHJp
diwgZmFsc2UpOworCQlpbnRlbF9ycHNfbWFya19pbnRlcmFjdGl2ZSgmZGV2X3ByaXYtPmd0LnJw
cywgZmFsc2UpOwogCQlpbnRlbF9zdGF0ZS0+cnBzX2ludGVyYWN0aXZlID0gZmFsc2U7CiAJfQog
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jCmluZGV4IGNiN2E4NWFjNjlkMC4u
NTE0YmJlYjgyY2E4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYwpAQCAt
MTM1LDYgKzEzNSw3IEBAIHN0YXRpYyBib29sIHN3aXRjaF90b19rZXJuZWxfY29udGV4dF9zeW5j
KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAKIGJvb2wgaTkxNV9nZW1fbG9hZF9wb3dlcl9jb250ZXh0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogeworCWludGVsX2d0X3BtX2VuYWJsZSgm
aTkxNS0+Z3QpOwogCXJldHVybiBzd2l0Y2hfdG9fa2VybmVsX2NvbnRleHRfc3luYygmaTkxNS0+
Z3QpOwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9icmVh
ZGNydW1icy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfYnJlYWRjcnVtYnMuYwpp
bmRleCBjMDkyYmRmNWYwYmYuLmVlYTg2OGYxNjU4ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfYnJlYWRjcnVtYnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9icmVhZGNydW1icy5jCkBAIC0zNCw5ICszNCw5IEBAIHN0YXRpYyB2b2lkIGly
cV9lbmFibGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQlyZXR1cm47CiAKIAkv
KiBDYWxsZXIgZGlzYWJsZXMgaW50ZXJydXB0cyAqLwotCXNwaW5fbG9jaygmZW5naW5lLT5pOTE1
LT5pcnFfbG9jayk7CisJc3Bpbl9sb2NrKCZlbmdpbmUtPmd0LT5pcnFfbG9jayk7CiAJZW5naW5l
LT5pcnFfZW5hYmxlKGVuZ2luZSk7Ci0Jc3Bpbl91bmxvY2soJmVuZ2luZS0+aTkxNS0+aXJxX2xv
Y2spOworCXNwaW5fdW5sb2NrKCZlbmdpbmUtPmd0LT5pcnFfbG9jayk7CiB9CiAKIHN0YXRpYyB2
b2lkIGlycV9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKQEAgLTQ1LDkg
KzQ1LDkgQEAgc3RhdGljIHZvaWQgaXJxX2Rpc2FibGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQogCQlyZXR1cm47CiAKIAkvKiBDYWxsZXIgZGlzYWJsZXMgaW50ZXJydXB0cyAqLwot
CXNwaW5fbG9jaygmZW5naW5lLT5pOTE1LT5pcnFfbG9jayk7CisJc3Bpbl9sb2NrKCZlbmdpbmUt
Pmd0LT5pcnFfbG9jayk7CiAJZW5naW5lLT5pcnFfZGlzYWJsZShlbmdpbmUpOwotCXNwaW5fdW5s
b2NrKCZlbmdpbmUtPmk5MTUtPmlycV9sb2NrKTsKKwlzcGluX3VubG9jaygmZW5naW5lLT5ndC0+
aXJxX2xvY2spOwogfQogCiBzdGF0aWMgdm9pZCBfX2ludGVsX2JyZWFkY3J1bWJzX2Rpc2FybV9p
cnEoc3RydWN0IGludGVsX2JyZWFkY3J1bWJzICpiKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9lbmdpbmVfcG0uYwppbmRleCAxMjE4YjdkNTNiODguLjE5ZWMwZTMwYzNmZCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKQEAgLTExLDYgKzExLDcgQEAK
ICNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG0uaCIKICNpbmNsdWRlICJpbnRlbF9ndC5oIgogI2lu
Y2x1ZGUgImludGVsX2d0X3BtLmgiCisjaW5jbHVkZSAiaW50ZWxfcmM2LmgiCiAKIHN0YXRpYyBp
bnQgX19lbmdpbmVfdW5wYXJrKHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIHsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9ndC5jCmluZGV4IDkwZWQ3OTI4NWZmOC4uMDNmZWI4YjQzNzczIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMKQEAgLTcsNiArNyw4IEBACiAKICNpbmNsdWRlICJp
bnRlbF9ndC5oIgogI2luY2x1ZGUgImludGVsX2d0X3BtLmgiCisjaW5jbHVkZSAiaW50ZWxfcmM2
LmgiCisjaW5jbHVkZSAiaW50ZWxfcnBzLmgiCiAjaW5jbHVkZSAiaW50ZWxfdW5jb3JlLmgiCiAK
IHZvaWQgaW50ZWxfZ3RfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKQEAgLTE0LDYgKzE2LDggQEAgdm9pZCBpbnRlbF9ndF9pbml0
X2Vhcmx5KHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQogCWd0LT5pOTE1ID0gaTkxNTsKIAlndC0+dW5jb3JlID0gJmk5MTUtPnVuY29yZTsKIAorCXNw
aW5fbG9ja19pbml0KCZndC0+aXJxX2xvY2spOworCiAJSU5JVF9MSVNUX0hFQUQoJmd0LT5jbG9z
ZWRfdm1hKTsKIAogCXNwaW5fbG9ja19pbml0KCZndC0+Y2xvc2VkX2xvY2spOwpAQCAtMjYsNiAr
MzAsOSBAQCB2b2lkIGludGVsX2d0X2luaXRfZWFybHkoc3RydWN0IGludGVsX2d0ICpndCwgc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB2b2lkIGludGVsX2d0X2luaXRfaHcoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJaTkxNS0+Z3QuZ2d0dCA9ICZpOTE1LT5nZ3R0
OworCisJLyogQklPUyBvZnRlbiBsZWF2ZXMgUkM2IGVuYWJsZWQsIGJ1dCBkaXNhYmxlIGl0IGZv
ciBodyBpbml0ICovCisJaW50ZWxfZ3RfcG1fZGlzYWJsZSgmaTkxNS0+Z3QpOwogfQogCiBzdGF0
aWMgdm9pZCBybXdfc2V0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwgaTkxNV9yZWdfdCBy
ZWcsIHUzMiBzZXQpCkBAIC0yMDUsNyArMjEyLDEyIEBAIHZvaWQgaW50ZWxfZ3RfY2hpcHNldF9m
bHVzaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCQlpbnRlbF9ndHRfY2hpcHNldF9mbHVzaCgpOwog
fQogCi1pbnQgaW50ZWxfZ3RfaW5pdF9zY3JhdGNoKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHVuc2ln
bmVkIGludCBzaXplKQordm9pZCBpbnRlbF9ndF9kcml2ZXJfcmVnaXN0ZXIoc3RydWN0IGludGVs
X2d0ICpndCkKK3sKKwlpbnRlbF9ycHNfZHJpdmVyX3JlZ2lzdGVyKCZndC0+cnBzKTsKK30KKwor
c3RhdGljIGludCBpbnRlbF9ndF9pbml0X3NjcmF0Y2goc3RydWN0IGludGVsX2d0ICpndCwgdW5z
aWduZWQgaW50IHNpemUpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+
aTkxNTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwpAQCAtMjM4LDEyICsyNTAs
NDYgQEAgaW50IGludGVsX2d0X2luaXRfc2NyYXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1bnNp
Z25lZCBpbnQgc2l6ZSkKIAlyZXR1cm4gcmV0OwogfQogCi12b2lkIGludGVsX2d0X2Zpbmlfc2Ny
YXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQorc3RhdGljIHZvaWQgaW50ZWxfZ3RfZmluaV9zY3Jh
dGNoKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJaTkxNV92bWFfdW5waW5fYW5kX3JlbGVhc2Uo
Jmd0LT5zY3JhdGNoLCAwKTsKIH0KIAoraW50IGludGVsX2d0X2luaXQoc3RydWN0IGludGVsX2d0
ICpndCkKK3sKKwlpbnQgZXJyOworCisJZXJyID0gaW50ZWxfZ3RfaW5pdF9zY3JhdGNoKGd0LCBJ
U19HRU4oZ3QtPmk5MTUsIDIpID8gU1pfMjU2SyA6IFNaXzRLKTsKKwlpZiAoZXJyKQorCQlyZXR1
cm4gZXJyOworCisJaW50ZWxfcmM2X2luaXQoJmd0LT5yYzYpOworCWludGVsX3Jwc19pbml0KCZn
dC0+cnBzKTsKKworCXJldHVybiAwOworfQorCit2b2lkIGludGVsX2d0X2RyaXZlcl9yZW1vdmUo
c3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlHRU1fQlVHX09OKGd0LT5hd2FrZSk7CisJaW50ZWxf
Z3RfcG1fZGlzYWJsZShndCk7Cit9CisKK3ZvaWQgaW50ZWxfZ3RfZHJpdmVyX3VucmVnaXN0ZXIo
c3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlpbnRlbF9ycHNfZHJpdmVyX3VucmVnaXN0ZXIoJmd0
LT5ycHMpOworfQorCiB2b2lkIGludGVsX2d0X2NsZWFudXBfZWFybHkoc3RydWN0IGludGVsX2d0
ICpndCkKIHsKIAlpbnRlbF9ndF9maW5pX3Jlc2V0KGd0KTsKIH0KKwordm9pZCBpbnRlbF9ndF9k
cml2ZXJfcmVsZWFzZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCS8qIFBhcmFub2lhOiBtYWtl
IHN1cmUgd2UgaGF2ZSBkaXNhYmxlZCBldmVyeXRoaW5nIGJlZm9yZSB3ZSBleGl0LiAqLworCWlu
dGVsX2d0X3BtX2Rpc2FibGUoZ3QpOworCisJaW50ZWxfcmM2X2ZpbmkoJmd0LT5yYzYpOworCWlu
dGVsX2d0X2Zpbmlfc2NyYXRjaChndCk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9ndC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaApp
bmRleCA2NDBiYjA1MzFmNWIuLjQwZDMzZGY3YTE3NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ndC5oCkBAIC0yOSw2ICsyOSwxMiBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBpbnRlbF9ndCAq
aHVjX3RvX2d0KHN0cnVjdCBpbnRlbF9odWMgKmh1YykKIAogdm9pZCBpbnRlbF9ndF9pbml0X2Vh
cmx5KHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
IHZvaWQgaW50ZWxfZ3RfaW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Citp
bnQgaW50ZWxfZ3RfaW5pdChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKK3ZvaWQgaW50ZWxfZ3RfZHJp
dmVyX3JlZ2lzdGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOworCit2b2lkIGludGVsX2d0X2RyaXZl
cl91bnJlZ2lzdGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBpbnRlbF9ndF9kcml2ZXJf
cmVtb3ZlKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBpbnRlbF9ndF9kcml2ZXJfcmVsZWFz
ZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAogdm9pZCBpbnRlbF9ndF9jbGVhbnVwX2Vhcmx5KHN0
cnVjdCBpbnRlbF9ndCAqZ3QpOwogCkBAIC00MSw5ICs0Nyw2IEBAIHZvaWQgaW50ZWxfZ3RfY2hp
cHNldF9mbHVzaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAogdm9pZCBpbnRlbF9ndF9pbml0X2hh
bmdjaGVjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAotaW50IGludGVsX2d0X2luaXRfc2NyYXRj
aChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1bnNpZ25lZCBpbnQgc2l6ZSk7Ci12b2lkIGludGVsX2d0
X2Zpbmlfc2NyYXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKLQogc3RhdGljIGlubGluZSB1MzIg
aW50ZWxfZ3Rfc2NyYXRjaF9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2d0ICpndCwKIAkJCQkJ
ICBlbnVtIGludGVsX2d0X3NjcmF0Y2hfZmllbGQgZmllbGQpCiB7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9pcnEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2d0X2lycS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAw
MC4uYzg3YTE3NzdiZDg4Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZ3RfaXJxLmMKQEAgLTAsMCArMSw0NTYgQEAKKy8qCisgKiBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogTUlUCisgKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRp
b24KKyAqLworCisjaW5jbHVkZSA8bGludXgvc2NoZWQvY2xvY2suaD4KKworI2luY2x1ZGUgImk5
MTVfZHJ2LmgiCisjaW5jbHVkZSAiaW50ZWxfZ3QuaCIKKyNpbmNsdWRlICJpbnRlbF9ndF9pcnEu
aCIKKyNpbmNsdWRlICJpbnRlbF91bmNvcmUuaCIKKyNpbmNsdWRlICJpbnRlbF9ycHMuaCIKKwor
c3RhdGljIHZvaWQgZ3VjX2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndWMgKmd1YywgdTE2IGlp
cikKK3sKKwlpZiAoaWlyICYgR1VDX0lOVFJfR1VDMkhPU1QpCisJCWludGVsX2d1Y190b19ob3N0
X2V2ZW50X2hhbmRsZXIoZ3VjKTsKK30KKworc3RhdGljIHZvaWQKK2NzX2lycV9oYW5kbGVyKHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMyIGlpcikKK3sKKwlib29sIHRhc2tsZXQg
PSBmYWxzZTsKKworCWlmIChpaXIgJiBHVF9DT05URVhUX1NXSVRDSF9JTlRFUlJVUFQpCisJCXRh
c2tsZXQgPSB0cnVlOworCisJaWYgKGlpciAmIEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVCkgewor
CQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGVuZ2luZSk7CisJCXRhc2tsZXQgfD0gaW50
ZWxfZW5naW5lX25lZWRzX2JyZWFkY3J1bWJfdGFza2xldChlbmdpbmUpOworCX0KKworCWlmICh0
YXNrbGV0KQorCQl0YXNrbGV0X2hpX3NjaGVkdWxlKCZlbmdpbmUtPmV4ZWNsaXN0cy50YXNrbGV0
KTsKK30KKworc3RhdGljIHUzMgorZ2VuMTFfZ3RfZW5naW5lX2lkZW50aXR5KHN0cnVjdCBpbnRl
bF9ndCAqZ3QsCisJCQkgY29uc3QgdW5zaWduZWQgaW50IGJhbmssIGNvbnN0IHVuc2lnbmVkIGlu
dCBiaXQpCit7CisJdm9pZCBfX2lvbWVtICogY29uc3QgcmVncyA9IGd0LT51bmNvcmUtPnJlZ3M7
CisJdTMyIHRpbWVvdXRfdHM7CisJdTMyIGlkZW50OworCisJbG9ja2RlcF9hc3NlcnRfaGVsZCgm
Z3QtPmlycV9sb2NrKTsKKworCXJhd19yZWdfd3JpdGUocmVncywgR0VOMTFfSUlSX1JFR19TRUxF
Q1RPUihiYW5rKSwgQklUKGJpdCkpOworCisJLyoKKwkgKiBOQjogU3BlY3MgZG8gbm90IHNwZWNp
ZnkgaG93IGxvbmcgdG8gc3BpbiB3YWl0LAorCSAqIHNvIHdlIGRvIH4xMDB1cyBhcyBhbiBlZHVj
YXRlZCBndWVzcy4KKwkgKi8KKwl0aW1lb3V0X3RzID0gKGxvY2FsX2Nsb2NrKCkgPj4gMTApICsg
MTAwOworCWRvIHsKKwkJaWRlbnQgPSByYXdfcmVnX3JlYWQocmVncywgR0VOMTFfSU5UUl9JREVO
VElUWV9SRUcoYmFuaykpOworCX0gd2hpbGUgKCEoaWRlbnQgJiBHRU4xMV9JTlRSX0RBVEFfVkFM
SUQpICYmCisJCSAhdGltZV9hZnRlcjMyKGxvY2FsX2Nsb2NrKCkgPj4gMTAsIHRpbWVvdXRfdHMp
KTsKKworCWlmICh1bmxpa2VseSghKGlkZW50ICYgR0VOMTFfSU5UUl9EQVRBX1ZBTElEKSkpIHsK
KwkJRFJNX0VSUk9SKCJJTlRSX0lERU5USVRZX1JFRyV1OiV1IDB4JTA4eCBub3QgdmFsaWQhXG4i
LAorCQkJICBiYW5rLCBiaXQsIGlkZW50KTsKKwkJcmV0dXJuIDA7CisJfQorCisJcmF3X3JlZ193
cml0ZShyZWdzLCBHRU4xMV9JTlRSX0lERU5USVRZX1JFRyhiYW5rKSwKKwkJICAgICAgR0VOMTFf
SU5UUl9EQVRBX1ZBTElEKTsKKworCXJldHVybiBpZGVudDsKK30KKworc3RhdGljIHZvaWQKK2dl
bjExX290aGVyX2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGNvbnN0IHU4IGluc3Rh
bmNlLAorCQkJY29uc3QgdTE2IGlpcikKK3sKKwlpZiAoaW5zdGFuY2UgPT0gT1RIRVJfR1VDX0lO
U1RBTkNFKQorCQlyZXR1cm4gZ3VjX2lycV9oYW5kbGVyKCZndC0+dWMuZ3VjLCBpaXIpOworCisJ
aWYgKGluc3RhbmNlID09IE9USEVSX0dUUE1fSU5TVEFOQ0UpCisJCXJldHVybiBnZW4xMV9ycHNf
aXJxX2hhbmRsZXIoJmd0LT5ycHMsIGlpcik7CisKKwlXQVJOX09OQ0UoMSwgInVuaGFuZGxlZCBv
dGhlciBpbnRlcnJ1cHQgaW5zdGFuY2U9MHgleCwgaWlyPTB4JXhcbiIsCisJCSAgaW5zdGFuY2Us
IGlpcik7Cit9CisKK3N0YXRpYyB2b2lkCitnZW4xMV9lbmdpbmVfaXJxX2hhbmRsZXIoc3RydWN0
IGludGVsX2d0ICpndCwgY29uc3QgdTggY2xhc3MsCisJCQkgY29uc3QgdTggaW5zdGFuY2UsIGNv
bnN0IHUxNiBpaXIpCit7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCisJaWYg
KGluc3RhbmNlIDw9IE1BWF9FTkdJTkVfSU5TVEFOQ0UpCisJCWVuZ2luZSA9IGd0LT5lbmdpbmVf
Y2xhc3NbY2xhc3NdW2luc3RhbmNlXTsKKwllbHNlCisJCWVuZ2luZSA9IE5VTEw7CisKKwlpZiAo
bGlrZWx5KGVuZ2luZSkpCisJCXJldHVybiBjc19pcnFfaGFuZGxlcihlbmdpbmUsIGlpcik7CisK
KwlXQVJOX09OQ0UoMSwgInVuaGFuZGxlZCBlbmdpbmUgaW50ZXJydXB0IGNsYXNzPTB4JXgsIGlu
c3RhbmNlPTB4JXhcbiIsCisJCSAgY2xhc3MsIGluc3RhbmNlKTsKK30KKworc3RhdGljIHZvaWQK
K2dlbjExX2d0X2lkZW50aXR5X2hhbmRsZXIoc3RydWN0IGludGVsX2d0ICpndCwgY29uc3QgdTMy
IGlkZW50aXR5KQoreworCWNvbnN0IHU4IGNsYXNzID0gR0VOMTFfSU5UUl9FTkdJTkVfQ0xBU1Mo
aWRlbnRpdHkpOworCWNvbnN0IHU4IGluc3RhbmNlID0gR0VOMTFfSU5UUl9FTkdJTkVfSU5TVEFO
Q0UoaWRlbnRpdHkpOworCWNvbnN0IHUxNiBpbnRyID0gR0VOMTFfSU5UUl9FTkdJTkVfSU5UUihp
ZGVudGl0eSk7CisKKwlpZiAodW5saWtlbHkoIWludHIpKQorCQlyZXR1cm47CisKKwlpZiAoY2xh
c3MgPD0gQ09QWV9FTkdJTkVfQ0xBU1MpCisJCXJldHVybiBnZW4xMV9lbmdpbmVfaXJxX2hhbmRs
ZXIoZ3QsIGNsYXNzLCBpbnN0YW5jZSwgaW50cik7CisKKwlpZiAoY2xhc3MgPT0gT1RIRVJfQ0xB
U1MpCisJCXJldHVybiBnZW4xMV9vdGhlcl9pcnFfaGFuZGxlcihndCwgaW5zdGFuY2UsIGludHIp
OworCisJV0FSTl9PTkNFKDEsICJ1bmtub3duIGludGVycnVwdCBjbGFzcz0weCV4LCBpbnN0YW5j
ZT0weCV4LCBpbnRyPTB4JXhcbiIsCisJCSAgY2xhc3MsIGluc3RhbmNlLCBpbnRyKTsKK30KKwor
c3RhdGljIHZvaWQKK2dlbjExX2d0X2JhbmtfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBj
b25zdCB1bnNpZ25lZCBpbnQgYmFuaykKK3sKKwl2b2lkIF9faW9tZW0gKiBjb25zdCByZWdzID0g
Z3QtPnVuY29yZS0+cmVnczsKKwl1bnNpZ25lZCBsb25nIGludHJfZHc7CisJdW5zaWduZWQgaW50
IGJpdDsKKworCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmd0LT5pcnFfbG9jayk7CisKKwlpbnRyX2R3
ID0gcmF3X3JlZ19yZWFkKHJlZ3MsIEdFTjExX0dUX0lOVFJfRFcoYmFuaykpOworCisJZm9yX2Vh
Y2hfc2V0X2JpdChiaXQsICZpbnRyX2R3LCAzMikgeworCQljb25zdCB1MzIgaWRlbnQgPSBnZW4x
MV9ndF9lbmdpbmVfaWRlbnRpdHkoZ3QsIGJhbmssIGJpdCk7CisKKwkJZ2VuMTFfZ3RfaWRlbnRp
dHlfaGFuZGxlcihndCwgaWRlbnQpOworCX0KKworCS8qIENsZWFyIG11c3QgYmUgYWZ0ZXIgc2hh
cmVkIGhhcyBiZWVuIHNlcnZlZCBmb3IgZW5naW5lICovCisJcmF3X3JlZ193cml0ZShyZWdzLCBH
RU4xMV9HVF9JTlRSX0RXKGJhbmspLCBpbnRyX2R3KTsKK30KKwordm9pZCBnZW4xMV9ndF9pcnFf
aGFuZGxlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBjb25zdCB1MzIgbWFzdGVyX2N0bCkKK3sKKwl1
bnNpZ25lZCBpbnQgYmFuazsKKworCXNwaW5fbG9jaygmZ3QtPmlycV9sb2NrKTsKKworCWZvciAo
YmFuayA9IDA7IGJhbmsgPCAyOyBiYW5rKyspIHsKKwkJaWYgKG1hc3Rlcl9jdGwgJiBHRU4xMV9H
VF9EV19JUlEoYmFuaykpCisJCQlnZW4xMV9ndF9iYW5rX2hhbmRsZXIoZ3QsIGJhbmspOworCX0K
KworCXNwaW5fdW5sb2NrKCZndC0+aXJxX2xvY2spOworfQorCitib29sIGdlbjExX2d0X3Jlc2V0
X29uZV9paXIoc3RydWN0IGludGVsX2d0ICpndCwKKwkJCSAgICBjb25zdCB1bnNpZ25lZCBpbnQg
YmFuaywKKwkJCSAgICBjb25zdCB1bnNpZ25lZCBpbnQgYml0KQoreworCXZvaWQgX19pb21lbSAq
IGNvbnN0IHJlZ3MgPSBndC0+dW5jb3JlLT5yZWdzOworCXUzMiBkdzsKKworCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJmd0LT5pcnFfbG9jayk7CisKKwlkdyA9IHJhd19yZWdfcmVhZChyZWdzLCBHRU4x
MV9HVF9JTlRSX0RXKGJhbmspKTsKKwlpZiAoZHcgJiBCSVQoYml0KSkgeworCQkvKgorCQkgKiBB
Y2NvcmRpbmcgdG8gdGhlIEJTcGVjLCBEV19JSVIgYml0cyBjYW5ub3QgYmUgY2xlYXJlZCB3aXRo
b3V0CisJCSAqIGZpcnN0IHNlcnZpY2luZyB0aGUgU2VsZWN0b3IgJiBTaGFyZWQgSUlSIHJlZ2lz
dGVycy4KKwkJICovCisJCWdlbjExX2d0X2VuZ2luZV9pZGVudGl0eShndCwgYmFuaywgYml0KTsK
KworCQkvKgorCQkgKiBXZSBsb2NrZWQgR1QgSU5UIERXIGJ5IHJlYWRpbmcgaXQuIElmIHdlIHdh
bnQgdG8gKHRyeQorCQkgKiB0bykgcmVjb3ZlciBmcm9tIHRoaXMgc3VjY2Vzc2Z1bGx5LCB3ZSBu
ZWVkIHRvIGNsZWFyCisJCSAqIG91ciBiaXQsIG90aGVyd2lzZSB3ZSBhcmUgbG9ja2luZyB0aGUg
cmVnaXN0ZXIgZm9yCisJCSAqIGV2ZXJ5Ym9keS4KKwkJICovCisJCXJhd19yZWdfd3JpdGUocmVn
cywgR0VOMTFfR1RfSU5UUl9EVyhiYW5rKSwgQklUKGJpdCkpOworCisJCXJldHVybiB0cnVlOwor
CX0KKworCXJldHVybiBmYWxzZTsKK30KKwordm9pZCBnZW4xMV9ndF9pcnFfcmVzZXQoc3RydWN0
IGludGVsX2d0ICpndCkKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5j
b3JlOworCisJLyogRGlzYWJsZSBSQ1MsIEJDUywgVkNTIGFuZCBWRUNTIGNsYXNzIGVuZ2luZXMu
ICovCisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfUkVOREVSX0NPUFlfSU5UUl9F
TkFCTEUsIDApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX1ZDU19WRUNTX0lO
VFJfRU5BQkxFLAkgIDApOworCisJLyogUmVzdG9yZSBtYXNrcyBpcnFzIG9uIFJDUywgQkNTLCBW
Q1MgYW5kIFZFQ1MgZW5naW5lcy4gKi8KKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4x
MV9SQ1MwX1JTVkRfSU5UUl9NQVNLLAl+MCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwg
R0VOMTFfQkNTX1JTVkRfSU5UUl9NQVNLLAl+MCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29y
ZSwgR0VOMTFfVkNTMF9WQ1MxX0lOVFJfTUFTSywJfjApOworCWludGVsX3VuY29yZV93cml0ZSh1
bmNvcmUsIEdFTjExX1ZDUzJfVkNTM19JTlRSX01BU0ssCX4wKTsKKwlpbnRlbF91bmNvcmVfd3Jp
dGUodW5jb3JlLCBHRU4xMV9WRUNTMF9WRUNTMV9JTlRSX01BU0ssCX4wKTsKKworCWludGVsX3Vu
Y29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9FTkFCTEUsIDApOwor
CWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9NQVNL
LCAgfjApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dVQ19TR19JTlRSX0VO
QUJMRSwgMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfR1VDX1NHX0lOVFJf
TUFTSywgIH4wKTsKK30KKwordm9pZCBnZW4xMV9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGlu
dGVsX2d0ICpndCkKK3sKKwljb25zdCB1MzIgaXJxcyA9IEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQ
VCB8IEdUX0NPTlRFWFRfU1dJVENIX0lOVEVSUlVQVDsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUgPSBndC0+dW5jb3JlOworCWNvbnN0IHUzMiBkbWFzayA9IGlycXMgPDwgMTYgfCBpcnFz
OworCWNvbnN0IHUzMiBzbWFzayA9IGlycXMgPDwgMTY7CisKKwlCVUlMRF9CVUdfT04oaXJxcyAm
IDB4ZmZmZjAwMDApOworCisJLyogRW5hYmxlIFJDUywgQkNTLCBWQ1MgYW5kIFZFQ1MgY2xhc3Mg
aW50ZXJydXB0cy4gKi8KKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9SRU5ERVJf
Q09QWV9JTlRSX0VOQUJMRSwgZG1hc2spOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdF
TjExX1ZDU19WRUNTX0lOVFJfRU5BQkxFLCBkbWFzayk7CisKKwkvKiBVbm1hc2sgaXJxcyBvbiBS
Q1MsIEJDUywgVkNTIGFuZCBWRUNTIGVuZ2luZXMuICovCisJaW50ZWxfdW5jb3JlX3dyaXRlKHVu
Y29yZSwgR0VOMTFfUkNTMF9SU1ZEX0lOVFJfTUFTSywgfnNtYXNrKTsKKwlpbnRlbF91bmNvcmVf
d3JpdGUodW5jb3JlLCBHRU4xMV9CQ1NfUlNWRF9JTlRSX01BU0ssIH5zbWFzayk7CisJaW50ZWxf
dW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfVkNTMF9WQ1MxX0lOVFJfTUFTSywgfmRtYXNrKTsK
KwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9WQ1MyX1ZDUzNfSU5UUl9NQVNLLCB+
ZG1hc2spOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX1ZFQ1MwX1ZFQ1MxX0lO
VFJfTUFTSywgfmRtYXNrKTsKKworCS8qCisJICogUlBTIGludGVycnVwdHMgd2lsbCBnZXQgZW5h
YmxlZC9kaXNhYmxlZCBvbiBkZW1hbmQgd2hlbiBSUFMgaXRzZWxmCisJICogaXMgZW5hYmxlZC9k
aXNhYmxlZC4KKwkgKi8KKwlndC0+cG1faWVyID0gMHgwOworCWd0LT5wbV9pbXIgPSB+Z3QtPnBt
X2llcjsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9HUE1fV0dCT1hQRVJGX0lO
VFJfRU5BQkxFLCAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9HUE1fV0dC
T1hQRVJGX0lOVFJfTUFTSywgIH4wKTsKKworCS8qIFNhbWUgdGhpbmcgZm9yIEd1QyBpbnRlcnJ1
cHRzICovCisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfR1VDX1NHX0lOVFJfRU5B
QkxFLCAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9HVUNfU0dfSU5UUl9N
QVNLLCAgfjApOworfQorCit2b2lkIGdlbjVfZ3RfaXJxX2hhbmRsZXIoc3RydWN0IGludGVsX2d0
ICpndCwgdTMyIGd0X2lpcikKK3sKKwlpZiAoZ3RfaWlyICYgR1RfUkVOREVSX1VTRVJfSU5URVJS
VVBUKQorCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGd0LT5lbmdpbmVfY2xhc3NbUkVO
REVSX0NMQVNTXVswXSk7CisJaWYgKGd0X2lpciAmIElMS19CU0RfVVNFUl9JTlRFUlJVUFQpCisJ
CWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoZ3QtPmVuZ2luZV9jbGFzc1tWSURFT19ERUNP
REVfQ0xBU1NdWzBdKTsKK30KKworc3RhdGljIHZvaWQgZ2VuN19wYXJpdHlfZXJyb3JfaXJxX2hh
bmRsZXIoc3RydWN0IGludGVsX2d0ICpndCwgdTMyIGlpcikKK3sKKwlpZiAoIUhBU19MM19EUEYo
Z3QtPmk5MTUpKQorCQlyZXR1cm47CisKKwlzcGluX2xvY2soJmd0LT5pcnFfbG9jayk7CisJZ2Vu
NV9ndF9kaXNhYmxlX2lycShndCwgR1RfUEFSSVRZX0VSUk9SKGd0LT5pOTE1KSk7CisJc3Bpbl91
bmxvY2soJmd0LT5pcnFfbG9jayk7CisKKwlpZiAoaWlyICYgR1RfUkVOREVSX0wzX1BBUklUWV9F
UlJPUl9JTlRFUlJVUFRfUzEpCisJCWd0LT5pOTE1LT5sM19wYXJpdHkud2hpY2hfc2xpY2UgfD0g
MSA8PCAxOworCisJaWYgKGlpciAmIEdUX1JFTkRFUl9MM19QQVJJVFlfRVJST1JfSU5URVJSVVBU
KQorCQlndC0+aTkxNS0+bDNfcGFyaXR5LndoaWNoX3NsaWNlIHw9IDEgPDwgMDsKKworCXNjaGVk
dWxlX3dvcmsoJmd0LT5pOTE1LT5sM19wYXJpdHkuZXJyb3Jfd29yayk7Cit9CisKK3ZvaWQgZ2Vu
Nl9ndF9pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1MzIgZ3RfaWlyKQoreworCWlm
IChndF9paXIgJiBHVF9SRU5ERVJfVVNFUl9JTlRFUlJVUFQpCisJCWludGVsX2VuZ2luZV9icmVh
ZGNydW1ic19pcnEoZ3QtPmVuZ2luZV9jbGFzc1tSRU5ERVJfQ0xBU1NdWzBdKTsKKwlpZiAoZ3Rf
aWlyICYgR1RfQlNEX1VTRVJfSU5URVJSVVBUKQorCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNf
aXJxKGd0LT5lbmdpbmVfY2xhc3NbVklERU9fREVDT0RFX0NMQVNTXVswXSk7CisJaWYgKGd0X2lp
ciAmIEdUX0JMVF9VU0VSX0lOVEVSUlVQVCkKKwkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2ly
cShndC0+ZW5naW5lX2NsYXNzW0NPUFlfRU5HSU5FX0NMQVNTXVswXSk7CisKKwlpZiAoZ3RfaWly
ICYgKEdUX0JMVF9DU19FUlJPUl9JTlRFUlJVUFQgfAorCQkgICAgICBHVF9CU0RfQ1NfRVJST1Jf
SU5URVJSVVBUIHwKKwkJICAgICAgR1RfUkVOREVSX0NTX01BU1RFUl9FUlJPUl9JTlRFUlJVUFQp
KQorCQlEUk1fREVCVUcoIkNvbW1hbmQgcGFyc2VyIGVycm9yLCBndF9paXIgMHglMDh4XG4iLCBn
dF9paXIpOworCisJaWYgKGd0X2lpciAmIEdUX1BBUklUWV9FUlJPUihndC0+aTkxNSkpCisJCWdl
bjdfcGFyaXR5X2Vycm9yX2lycV9oYW5kbGVyKGd0LCBndF9paXIpOworfQorCit2b2lkIGdlbjhf
Z3RfaXJxX2FjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1MzIgbWFzdGVyX2N0bCwgdTMyIGd0X2lp
cls0XSkKK3sKKwl2b2lkIF9faW9tZW0gKiBjb25zdCByZWdzID0gZ3QtPnVuY29yZS0+cmVnczsK
KworCWlmIChtYXN0ZXJfY3RsICYgKEdFTjhfR1RfUkNTX0lSUSB8IEdFTjhfR1RfQkNTX0lSUSkp
IHsKKwkJZ3RfaWlyWzBdID0gcmF3X3JlZ19yZWFkKHJlZ3MsIEdFTjhfR1RfSUlSKDApKTsKKwkJ
aWYgKGxpa2VseShndF9paXJbMF0pKQorCQkJcmF3X3JlZ193cml0ZShyZWdzLCBHRU44X0dUX0lJ
UigwKSwgZ3RfaWlyWzBdKTsKKwl9CisKKwlpZiAobWFzdGVyX2N0bCAmIChHRU44X0dUX1ZDUzBf
SVJRIHwgR0VOOF9HVF9WQ1MxX0lSUSkpIHsKKwkJZ3RfaWlyWzFdID0gcmF3X3JlZ19yZWFkKHJl
Z3MsIEdFTjhfR1RfSUlSKDEpKTsKKwkJaWYgKGxpa2VseShndF9paXJbMV0pKQorCQkJcmF3X3Jl
Z193cml0ZShyZWdzLCBHRU44X0dUX0lJUigxKSwgZ3RfaWlyWzFdKTsKKwl9CisKKwlpZiAobWFz
dGVyX2N0bCAmIChHRU44X0dUX1BNX0lSUSB8IEdFTjhfR1RfR1VDX0lSUSkpIHsKKwkJZ3RfaWly
WzJdID0gcmF3X3JlZ19yZWFkKHJlZ3MsIEdFTjhfR1RfSUlSKDIpKTsKKwkJaWYgKGxpa2VseShn
dF9paXJbMl0pKQorCQkJcmF3X3JlZ193cml0ZShyZWdzLCBHRU44X0dUX0lJUigyKSwgZ3RfaWly
WzJdKTsKKwl9CisKKwlpZiAobWFzdGVyX2N0bCAmIEdFTjhfR1RfVkVDU19JUlEpIHsKKwkJZ3Rf
aWlyWzNdID0gcmF3X3JlZ19yZWFkKHJlZ3MsIEdFTjhfR1RfSUlSKDMpKTsKKwkJaWYgKGxpa2Vs
eShndF9paXJbM10pKQorCQkJcmF3X3JlZ193cml0ZShyZWdzLCBHRU44X0dUX0lJUigzKSwgZ3Rf
aWlyWzNdKTsKKwl9Cit9CisKK3ZvaWQgZ2VuOF9ndF9pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxf
Z3QgKmd0LCB1MzIgbWFzdGVyX2N0bCwgdTMyIGd0X2lpcls0XSkKK3sKKwlpZiAobWFzdGVyX2N0
bCAmIChHRU44X0dUX1JDU19JUlEgfCBHRU44X0dUX0JDU19JUlEpKSB7CisJCWNzX2lycV9oYW5k
bGVyKGd0LT5lbmdpbmVfY2xhc3NbUkVOREVSX0NMQVNTXVswXSwKKwkJCSAgICAgICBndF9paXJb
MF0gPj4gR0VOOF9SQ1NfSVJRX1NISUZUKTsKKwkJY3NfaXJxX2hhbmRsZXIoZ3QtPmVuZ2luZV9j
bGFzc1tDT1BZX0VOR0lORV9DTEFTU11bMF0sCisJCQkgICAgICAgZ3RfaWlyWzBdID4+IEdFTjhf
QkNTX0lSUV9TSElGVCk7CisJfQorCisJaWYgKG1hc3Rlcl9jdGwgJiAoR0VOOF9HVF9WQ1MwX0lS
USB8IEdFTjhfR1RfVkNTMV9JUlEpKSB7CisJCWNzX2lycV9oYW5kbGVyKGd0LT5lbmdpbmVfY2xh
c3NbVklERU9fREVDT0RFX0NMQVNTXVswXSwKKwkJCSAgICAgICBndF9paXJbMV0gPj4gR0VOOF9W
Q1MwX0lSUV9TSElGVCk7CisJCWNzX2lycV9oYW5kbGVyKGd0LT5lbmdpbmVfY2xhc3NbVklERU9f
REVDT0RFX0NMQVNTXVsxXSwKKwkJCSAgICAgICBndF9paXJbMV0gPj4gR0VOOF9WQ1MxX0lSUV9T
SElGVCk7CisJfQorCisJaWYgKG1hc3Rlcl9jdGwgJiBHRU44X0dUX1ZFQ1NfSVJRKSB7CisJCWNz
X2lycV9oYW5kbGVyKGd0LT5lbmdpbmVfY2xhc3NbVklERU9fRU5IQU5DRU1FTlRfQ0xBU1NdWzBd
LAorCQkJICAgICAgIGd0X2lpclszXSA+PiBHRU44X1ZFQ1NfSVJRX1NISUZUKTsKKwl9CisKKwlp
ZiAobWFzdGVyX2N0bCAmIChHRU44X0dUX1BNX0lSUSB8IEdFTjhfR1RfR1VDX0lSUSkpIHsKKwkJ
Z2VuNl9ycHNfaXJxX2hhbmRsZXIoJmd0LT5ycHMsIGd0X2lpclsyXSk7CisJCWd1Y19pcnFfaGFu
ZGxlcigmZ3QtPnVjLmd1YywgZ3RfaWlyWzJdID4+IDE2KTsKKwl9Cit9CisKK3ZvaWQgZ2VuOF9n
dF9pcnFfcmVzZXQoc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3Jl
ICp1bmNvcmUgPSBndC0+dW5jb3JlOworCisJR0VOOF9JUlFfUkVTRVRfTkRYKHVuY29yZSwgR1Qs
IDApOworCUdFTjhfSVJRX1JFU0VUX05EWCh1bmNvcmUsIEdULCAxKTsKKwlHRU44X0lSUV9SRVNF
VF9ORFgodW5jb3JlLCBHVCwgMik7CisJR0VOOF9JUlFfUkVTRVRfTkRYKHVuY29yZSwgR1QsIDMp
OworfQorCit2b2lkIGdlbjhfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBpbnRlbF9ndCAqZ3Qp
Cit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKKworCS8qIFRo
ZXNlIGFyZSBpbnRlcnJ1cHRzIHdlJ2xsIHRvZ2dsZSB3aXRoIHRoZSByaW5nIG1hc2sgcmVnaXN0
ZXIgKi8KKwl1MzIgZ3RfaW50ZXJydXB0c1tdID0geworCQkoR1RfUkVOREVSX1VTRVJfSU5URVJS
VVBUIDw8IEdFTjhfUkNTX0lSUV9TSElGVCB8CisJCSBHVF9DT05URVhUX1NXSVRDSF9JTlRFUlJV
UFQgPDwgR0VOOF9SQ1NfSVJRX1NISUZUIHwKKwkJIEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVCA8
PCBHRU44X0JDU19JUlFfU0hJRlQgfAorCQkgR1RfQ09OVEVYVF9TV0lUQ0hfSU5URVJSVVBUIDw8
IEdFTjhfQkNTX0lSUV9TSElGVCksCisKKwkJKEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVCA8PCBH
RU44X1ZDUzBfSVJRX1NISUZUIHwKKwkJIEdUX0NPTlRFWFRfU1dJVENIX0lOVEVSUlVQVCA8PCBH
RU44X1ZDUzBfSVJRX1NISUZUIHwKKwkJIEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVCA8PCBHRU44
X1ZDUzFfSVJRX1NISUZUIHwKKwkJIEdUX0NPTlRFWFRfU1dJVENIX0lOVEVSUlVQVCA8PCBHRU44
X1ZDUzFfSVJRX1NISUZUKSwKKworCQkwLAorCisJCShHVF9SRU5ERVJfVVNFUl9JTlRFUlJVUFQg
PDwgR0VOOF9WRUNTX0lSUV9TSElGVCB8CisJCSBHVF9DT05URVhUX1NXSVRDSF9JTlRFUlJVUFQg
PDwgR0VOOF9WRUNTX0lSUV9TSElGVCkKKwl9OworCisJZ3QtPnBtX2llciA9IDB4MDsKKwlndC0+
cG1faW1yID0gfmd0LT5wbV9pZXI7CisJR0VOOF9JUlFfSU5JVF9ORFgodW5jb3JlLCBHVCwgMCwg
fmd0X2ludGVycnVwdHNbMF0sIGd0X2ludGVycnVwdHNbMF0pOworCUdFTjhfSVJRX0lOSVRfTkRY
KHVuY29yZSwgR1QsIDEsIH5ndF9pbnRlcnJ1cHRzWzFdLCBndF9pbnRlcnJ1cHRzWzFdKTsKKwkv
KgorCSAqIFJQUyBpbnRlcnJ1cHRzIHdpbGwgZ2V0IGVuYWJsZWQvZGlzYWJsZWQgb24gZGVtYW5k
IHdoZW4gUlBTIGl0c2VsZgorCSAqIGlzIGVuYWJsZWQvZGlzYWJsZWQuIFNhbWUgd2lsIGJlIHRo
ZSBjYXNlIGZvciBHdUMgaW50ZXJydXB0cy4KKwkgKi8KKwlHRU44X0lSUV9JTklUX05EWCh1bmNv
cmUsIEdULCAyLCBndC0+cG1faW1yLCBndC0+cG1faWVyKTsKKwlHRU44X0lSUV9JTklUX05EWCh1
bmNvcmUsIEdULCAzLCB+Z3RfaW50ZXJydXB0c1szXSwgZ3RfaW50ZXJydXB0c1szXSk7Cit9CisK
K3N0YXRpYyB2b2lkIGdlbjVfZ3RfdXBkYXRlX2lycShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAorCQkJ
ICAgICAgIHUzMiBpbnRlcnJ1cHRfbWFzaywKKwkJCSAgICAgICB1MzIgZW5hYmxlZF9pcnFfbWFz
aykKK3sKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZndC0+aXJxX2xvY2spOworCisJR0VNX0JVR19P
TihlbmFibGVkX2lycV9tYXNrICYgfmludGVycnVwdF9tYXNrKTsKKworCWd0LT5ndF9pbXIgJj0g
fmludGVycnVwdF9tYXNrOworCWd0LT5ndF9pbXIgfD0gKH5lbmFibGVkX2lycV9tYXNrICYgaW50
ZXJydXB0X21hc2spOworCWludGVsX3VuY29yZV93cml0ZShndC0+dW5jb3JlLCBHVElNUiwgZ3Qt
Pmd0X2ltcik7Cit9CisKK3ZvaWQgZ2VuNV9ndF9lbmFibGVfaXJxKHN0cnVjdCBpbnRlbF9ndCAq
Z3QsIHUzMiBtYXNrKQoreworCWdlbjVfZ3RfdXBkYXRlX2lycShndCwgbWFzaywgbWFzayk7CisJ
aW50ZWxfdW5jb3JlX3Bvc3RpbmdfcmVhZF9mdyhndC0+dW5jb3JlLCBHVElNUik7Cit9CisKK3Zv
aWQgZ2VuNV9ndF9kaXNhYmxlX2lycShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1MzIgbWFzaykKK3sK
KwlnZW41X2d0X3VwZGF0ZV9pcnEoZ3QsIG1hc2ssIDApOworfQorCit2b2lkIGdlbjVfZ3RfaXJx
X3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5j
b3JlID0gZ3QtPnVuY29yZTsKKworCUdFTjNfSVJRX1JFU0VUKHVuY29yZSwgR1QpOworCWlmIChJ
TlRFTF9HRU4oZ3QtPmk5MTUpID49IDYpCisJCUdFTjNfSVJRX1JFU0VUKHVuY29yZSwgR0VONl9Q
TSk7Cit9CisKK3ZvaWQgZ2VuNV9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGludGVsX2d0ICpn
dCkKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3JlOworCXUzMiBw
bV9pcnFzID0gMDsKKwl1MzIgZ3RfaXJxcyA9IDA7CisKKwlndC0+Z3RfaW1yID0gfjA7CisJaWYg
KEhBU19MM19EUEYoZ3QtPmk5MTUpKSB7CisJCS8qIEwzIHBhcml0eSBpbnRlcnJ1cHQgaXMgYWx3
YXlzIHVubWFza2VkLiAqLworCQlndC0+Z3RfaW1yID0gfkdUX1BBUklUWV9FUlJPUihndC0+aTkx
NSk7CisJCWd0X2lycXMgfD0gR1RfUEFSSVRZX0VSUk9SKGd0LT5pOTE1KTsKKwl9CisKKwlndF9p
cnFzIHw9IEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVDsKKwlpZiAoSVNfR0VOKGd0LT5pOTE1LCA1
KSkKKwkJZ3RfaXJxcyB8PSBJTEtfQlNEX1VTRVJfSU5URVJSVVBUOworCWVsc2UKKwkJZ3RfaXJx
cyB8PSBHVF9CTFRfVVNFUl9JTlRFUlJVUFQgfCBHVF9CU0RfVVNFUl9JTlRFUlJVUFQ7CisKKwlH
RU4zX0lSUV9JTklUKHVuY29yZSwgR1QsIGd0LT5ndF9pbXIsIGd0X2lycXMpOworCisJaWYgKElO
VEVMX0dFTihndC0+aTkxNSkgPj0gNikgeworCQkvKgorCQkgKiBSUFMgaW50ZXJydXB0cyB3aWxs
IGdldCBlbmFibGVkL2Rpc2FibGVkIG9uIGRlbWFuZCB3aGVuIFJQUworCQkgKiBpdHNlbGYgaXMg
ZW5hYmxlZC9kaXNhYmxlZC4KKwkJICovCisJCWlmIChIQVNfRU5HSU5FKGd0LT5pOTE1LCBWRUNT
MCkpIHsKKwkJCXBtX2lycXMgfD0gUE1fVkVCT1hfVVNFUl9JTlRFUlJVUFQ7CisJCQlndC0+cG1f
aWVyIHw9IFBNX1ZFQk9YX1VTRVJfSU5URVJSVVBUOworCQl9CisKKwkJZ3QtPnBtX2ltciA9IDB4
ZmZmZmZmZmY7CisJCUdFTjNfSVJRX0lOSVQodW5jb3JlLCBHRU42X1BNLCBndC0+cG1faW1yLCBw
bV9pcnFzKTsKKwl9Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ndF9pcnEuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X2lycS5oCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uOGYzNzU5MzcxMmM5Ci0tLSAvZGV2
L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfaXJxLmgKQEAgLTAs
MCArMSw0NCBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQKKyAqCisgKiBD
b3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpZm5kZWYgSU5URUxf
R1RfSVJRX0gKKyNkZWZpbmUgSU5URUxfR1RfSVJRX0gKKworI2luY2x1ZGUgPGxpbnV4L3R5cGVz
Lmg+CisKK3N0cnVjdCBpbnRlbF9ndDsKKworI2RlZmluZSBHRU44X0dUX0lSUVMgKEdFTjhfR1Rf
UkNTX0lSUSB8IFwKKwkJICAgICAgR0VOOF9HVF9CQ1NfSVJRIHwgXAorCQkgICAgICBHRU44X0dU
X1ZDUzBfSVJRIHwgXAorCQkgICAgICBHRU44X0dUX1ZDUzFfSVJRIHwgXAorCQkgICAgICBHRU44
X0dUX1ZFQ1NfSVJRIHwgXAorCQkgICAgICBHRU44X0dUX1BNX0lSUSB8IFwKKwkJICAgICAgR0VO
OF9HVF9HVUNfSVJRKQorCit2b2lkIGdlbjExX2d0X2lycV9yZXNldChzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0KTsKK3ZvaWQgZ2VuMTFfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBpbnRlbF9ndCAqZ3Qp
Owordm9pZCBnZW4xMV9ndF9pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBjb25zdCB1
MzIgbWFzdGVyX2N0bCk7CisKK2Jvb2wgZ2VuMTFfZ3RfcmVzZXRfb25lX2lpcihzdHJ1Y3QgaW50
ZWxfZ3QgKmd0LAorCQkJICAgIGNvbnN0IHVuc2lnbmVkIGludCBiYW5rLAorCQkJICAgIGNvbnN0
IHVuc2lnbmVkIGludCBiaXQpOworCit2b2lkIGdlbjVfZ3RfaXJxX2hhbmRsZXIoc3RydWN0IGlu
dGVsX2d0ICpndCwgdTMyIGd0X2lpcik7CisKK3ZvaWQgZ2VuNV9ndF9pcnFfcG9zdGluc3RhbGwo
c3RydWN0IGludGVsX2d0ICpndCk7Cit2b2lkIGdlbjVfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBpbnRl
bF9ndCAqZ3QpOwordm9pZCBnZW41X2d0X2Rpc2FibGVfaXJxKHN0cnVjdCBpbnRlbF9ndCAqZ3Qs
IHUzMiBtYXNrKTsKK3ZvaWQgZ2VuNV9ndF9lbmFibGVfaXJxKHN0cnVjdCBpbnRlbF9ndCAqZ3Qs
IHUzMiBtYXNrKTsKKwordm9pZCBnZW42X2d0X2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndCAq
Z3QsIHUzMiBndF9paXIpOworCit2b2lkIGdlbjhfZ3RfaXJxX2FjayhzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0LCB1MzIgbWFzdGVyX2N0bCwgdTMyIGd0X2lpcls0XSk7Cit2b2lkIGdlbjhfZ3RfaXJxX3Jl
c2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBnZW44X2d0X2lycV9oYW5kbGVyKHN0cnVj
dCBpbnRlbF9ndCAqZ3QsIHUzMiBtYXN0ZXJfY3RsLCB1MzIgZ3RfaWlyWzRdKTsKK3ZvaWQgZ2Vu
OF9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGludGVsX2d0ICpndCk7CisKKyNlbmRpZiAvKiBJ
TlRFTF9HVF9JUlFfSCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZ3RfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmMKaW5kZXgg
NjFlZDkxMjM0MWYxLi41MDA3OGY3NWMxOTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2d0X3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
Z3RfcG0uYwpAQCAtOSw3ICs5LDEwIEBACiAjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3BtLmgiCiAj
aW5jbHVkZSAiaW50ZWxfZ3QuaCIKICNpbmNsdWRlICJpbnRlbF9ndF9wbS5oIgorI2luY2x1ZGUg
ImludGVsX2xsYy5oIgogI2luY2x1ZGUgImludGVsX3BtLmgiCisjaW5jbHVkZSAiaW50ZWxfcmM2
LmgiCisjaW5jbHVkZSAiaW50ZWxfcnBzLmgiCiAjaW5jbHVkZSAiaW50ZWxfd2FrZXJlZi5oIgog
CiBzdGF0aWMgdm9pZCBwbV9ub3RpZnkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGlu
dCBzdGF0ZSkKQEAgLTM4LDEyICs0MSw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZ3RfdW5wYXJrKHN0
cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIAlndC0+YXdha2UgPSBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2dldChpOTE1LCBQT1dFUl9ET01BSU5fR1RfSVJRKTsKIAlHRU1fQlVHX09OKCFndC0+YXdha2Up
OwogCi0JaW50ZWxfZW5hYmxlX2d0X3Bvd2Vyc2F2ZShpOTE1KTsKLQotCWk5MTVfdXBkYXRlX2dm
eF92YWwoaTkxNSk7Ci0JaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQotCQlnZW42X3Jwc19idXN5
KGk5MTUpOwotCisJaW50ZWxfcnBzX3VucGFyaygmZ3QtPnJwcyk7CiAJaTkxNV9wbXVfZ3RfdW5w
YXJrZWQoaTkxNSk7CiAKIAlpbnRlbF9ndF9xdWV1ZV9oYW5nY2hlY2soZ3QpOwpAQCAtNjIsMTcg
KzYwLDE2IEBAIHZvaWQgaW50ZWxfZ3RfcG1fZ2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAKIHN0
YXRpYyBpbnQgaW50ZWxfZ3RfcGFyayhzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiB7Ci0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQotCQljb250YWluZXJfb2Yod2YsIHR5cGVvZigq
aTkxNSksIGd0Lndha2VyZWYpOwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVmID0gZmV0Y2hfYW5k
X3plcm8oJmk5MTUtPmd0LmF3YWtlKTsKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gY29udGFpbmVy
X29mKHdmLCB0eXBlb2YoKmd0KSwgd2FrZXJlZik7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBndC0+aTkxNTsKKwlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZiA9IGZldGNoX2FuZF96
ZXJvKCZndC0+YXdha2UpOwogCiAJR0VNX1RSQUNFKCJcbiIpOwogCiAJcG1fbm90aWZ5KGk5MTUs
IElOVEVMX0dUX1BBUkspOwogCiAJaTkxNV9wbXVfZ3RfcGFya2VkKGk5MTUpOwotCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gNikKLQkJZ2VuNl9ycHNfaWRsZShpOTE1KTsKKwlpbnRlbF9ycHNfcGFy
aygmZ3QtPnJwcyk7CiAKIAlHRU1fQlVHX09OKCF3YWtlcmVmKTsKIAlpbnRlbF9kaXNwbGF5X3Bv
d2VyX3B1dChpOTE1LCBQT1dFUl9ET01BSU5fR1RfSVJRLCB3YWtlcmVmKTsKQEAgLTEyNSw2ICsx
MjIsMzYgQEAgdm9pZCBpbnRlbF9ndF9zYW5pdGl6ZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBib29s
IGZvcmNlKQogCQlfX2ludGVsX2VuZ2luZV9yZXNldChlbmdpbmUsIGZhbHNlKTsKIH0KIAordm9p
ZCBpbnRlbF9ndF9wbV9lbmFibGUoc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisKKwkvKiBQ
b3dlcnNhdmluZyBpcyBjb250cm9sbGVkIGJ5IHRoZSBob3N0IHdoZW4gaW5zaWRlIGEgVk0gKi8K
KwlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoZ3QtPmk5MTUpKQorCQlyZXR1cm47CisKKwlpbnRlbF9n
dF9wbV9nZXQoZ3QpOworCWludGVsX3Jwc19lbmFibGUoJmd0LT5ycHMpOworCWludGVsX2xsY19l
bmFibGUoJmd0LT5sbGMpOworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlk
KSB7CisJCWludGVsX2VuZ2luZV9wbV9nZXQoZW5naW5lKTsKKwkJZW5naW5lLT5zZXJpYWwrKzsg
LyogZm9yY2Uga2VybmVsIGNvbnRleHQgcmVsb2FkICovCisJCWludGVsX2VuZ2luZV9wbV9wdXQo
ZW5naW5lKTsKKwl9CisKKwlpbnRlbF9yYzZfZW5hYmxlKCZndC0+cmM2KTsKKwlpbnRlbF9ndF9w
bV9wdXQoZ3QpOworfQorCit2b2lkIGludGVsX2d0X3BtX2Rpc2FibGUoc3RydWN0IGludGVsX2d0
ICpndCkKK3sKKwlpbnRlbF9yYzZfZGlzYWJsZSgmZ3QtPnJjNik7CisJaW50ZWxfbGxjX2Rpc2Fi
bGUoJmd0LT5sbGMpOworCWludGVsX3Jwc19kaXNhYmxlKCZndC0+cnBzKTsKK30KKwogaW50IGlu
dGVsX2d0X3Jlc3VtZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewogCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0X3BtLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5oCmluZGV4IGJh
OTYwZTFmYzIwOS4uYTBlZGQ1MzUwM2E0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ndF9wbS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0
X3BtLmgKQEAgLTIwLDYgKzIwLDggQEAgdm9pZCBpbnRlbF9ndF9wbV9nZXQoc3RydWN0IGludGVs
X2d0ICpndCk7CiB2b2lkIGludGVsX2d0X3BtX3B1dChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAog
dm9pZCBpbnRlbF9ndF9wbV9pbml0X2Vhcmx5KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBp
bnRlbF9ndF9wbV9lbmFibGUoc3RydWN0IGludGVsX2d0ICpndCk7Cit2b2lkIGludGVsX2d0X3Bt
X2Rpc2FibGUoc3RydWN0IGludGVsX2d0ICpndCk7CiAKIHZvaWQgaW50ZWxfZ3Rfc2FuaXRpemUo
c3RydWN0IGludGVsX2d0ICpndCwgYm9vbCBmb3JjZSk7CiBpbnQgaW50ZWxfZ3RfcmVzdW1lKHN0
cnVjdCBpbnRlbF9ndCAqZ3QpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZ3RfcG1faXJxLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbV9p
cnEuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmJhYmU4NjYxMjZk
NwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3Bt
X2lycS5jCkBAIC0wLDAgKzEsMTA5IEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6
IE1JVAorICoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKwor
I2luY2x1ZGUgImk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaTkxNV9yZWcuaCIKKyNpbmNsdWRlICJp
bnRlbF9ndC5oIgorI2luY2x1ZGUgImludGVsX2d0X2lycS5oIgorI2luY2x1ZGUgImludGVsX2d0
X3BtX2lycS5oIgorCitzdGF0aWMgdm9pZCB3cml0ZV9wbV9pbXIoc3RydWN0IGludGVsX2d0ICpn
dCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1OworCXN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7CisJdTMyIG1hc2sgPSBndC0+cG1f
aW1yOworCWk5MTVfcmVnX3QgcmVnOworCisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgewor
CQlyZWcgPSBHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfTUFTSzsKKwkJbWFzayA8PD0gMTY7IC8q
IHBtIGlzIGluIHVwcGVyIGhhbGYgKi8KKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4
KSB7CisJCXJlZyA9IEdFTjhfR1RfSU1SKDIpOworCX0gZWxzZSB7CisJCXJlZyA9IEdFTjZfUE1J
TVI7CisJfQorCisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgcmVnLCBtYXNrKTsKK30KKwor
c3RhdGljIHZvaWQgZ2VuNl9ndF9wbV91cGRhdGVfaXJxKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCisJ
CQkJICB1MzIgaW50ZXJydXB0X21hc2ssCisJCQkJICB1MzIgZW5hYmxlZF9pcnFfbWFzaykKK3sK
Kwl1MzIgbmV3X3ZhbDsKKworCVdBUk5fT04oZW5hYmxlZF9pcnFfbWFzayAmIH5pbnRlcnJ1cHRf
bWFzayk7CisKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZndC0+aXJxX2xvY2spOworCisJbmV3X3Zh
bCA9IGd0LT5wbV9pbXI7CisJbmV3X3ZhbCAmPSB+aW50ZXJydXB0X21hc2s7CisJbmV3X3ZhbCB8
PSB+ZW5hYmxlZF9pcnFfbWFzayAmIGludGVycnVwdF9tYXNrOworCisJaWYgKG5ld192YWwgIT0g
Z3QtPnBtX2ltcikgeworCQlndC0+cG1faW1yID0gbmV3X3ZhbDsKKwkJd3JpdGVfcG1faW1yKGd0
KTsKKwl9Cit9CisKK3ZvaWQgZ2VuNl9ndF9wbV91bm1hc2tfaXJxKHN0cnVjdCBpbnRlbF9ndCAq
Z3QsIHUzMiBtYXNrKQoreworCWdlbjZfZ3RfcG1fdXBkYXRlX2lycShndCwgbWFzaywgbWFzayk7
Cit9CisKK3ZvaWQgZ2VuNl9ndF9wbV9tYXNrX2lycShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1MzIg
bWFzaykKK3sKKwlnZW42X2d0X3BtX3VwZGF0ZV9pcnEoZ3QsIG1hc2ssIDApOworfQorCit2b2lk
IGdlbjZfZ3RfcG1fcmVzZXRfaWlyKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHUzMiByZXNldF9tYXNr
KQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7CisJaTkxNV9y
ZWdfdCByZWcgPSBJTlRFTF9HRU4oZ3QtPmk5MTUpID49IDggPyBHRU44X0dUX0lJUigyKSA6IEdF
TjZfUE1JSVI7CisKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZndC0+aXJxX2xvY2spOworCisJaW50
ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgcmVnLCByZXNldF9tYXNrKTsKKwlpbnRlbF91bmNvcmVf
d3JpdGUodW5jb3JlLCByZWcsIHJlc2V0X21hc2spOworCWludGVsX3VuY29yZV9wb3N0aW5nX3Jl
YWQodW5jb3JlLCByZWcpOworfQorCitzdGF0aWMgdm9pZCB3cml0ZV9wbV9pZXIoc3RydWN0IGlu
dGVsX2d0ICpndCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1
OworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7CisJdTMyIG1hc2sg
PSBndC0+cG1faWVyOworCWk5MTVfcmVnX3QgcmVnOworCisJaWYgKElOVEVMX0dFTihpOTE1KSA+
PSAxMSkgeworCQlyZWcgPSBHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfRU5BQkxFOworCQltYXNr
IDw8PSAxNjsgLyogcG0gaXMgaW4gdXBwZXIgaGFsZiAqLworCX0gZWxzZSBpZiAoSU5URUxfR0VO
KGk5MTUpID49IDgpIHsKKwkJcmVnID0gR0VOOF9HVF9JRVIoMik7CisJfSBlbHNlIHsKKwkJcmVn
ID0gR0VONl9QTUlFUjsKKwl9CisKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCByZWcsIG1h
c2spOworfQorCit2b2lkIGdlbjZfZ3RfcG1fZW5hYmxlX2lycShzdHJ1Y3QgaW50ZWxfZ3QgKmd0
LCB1MzIgZW5hYmxlX21hc2spCit7CisJbG9ja2RlcF9hc3NlcnRfaGVsZCgmZ3QtPmlycV9sb2Nr
KTsKKworCWd0LT5wbV9pZXIgfD0gZW5hYmxlX21hc2s7CisJd3JpdGVfcG1faWVyKGd0KTsKKwln
ZW42X2d0X3BtX3VubWFza19pcnEoZ3QsIGVuYWJsZV9tYXNrKTsKK30KKwordm9pZCBnZW42X2d0
X3BtX2Rpc2FibGVfaXJxKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHUzMiBkaXNhYmxlX21hc2spCit7
CisJbG9ja2RlcF9hc3NlcnRfaGVsZCgmZ3QtPmlycV9sb2NrKTsKKworCWd0LT5wbV9pZXIgJj0g
fmRpc2FibGVfbWFzazsKKwlnZW42X2d0X3BtX21hc2tfaXJxKGd0LCBkaXNhYmxlX21hc2spOwor
CXdyaXRlX3BtX2llcihndCk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9ndF9wbV9pcnEuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3Bt
X2lycS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYjI5ODE2YTA0
ODA5Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3Rf
cG1faXJxLmgKQEAgLTAsMCArMSwyMiBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBNSVQKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisK
KyNpZm5kZWYgSU5URUxfR1RfUE1fSVJRX0gKKyNkZWZpbmUgSU5URUxfR1RfUE1fSVJRX0gKKwor
I2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisKK3N0cnVjdCBpbnRlbF9ndDsKKwordm9pZCBnZW42
X2d0X3BtX3VubWFza19pcnEoc3RydWN0IGludGVsX2d0ICpndCwgdTMyIG1hc2spOwordm9pZCBn
ZW42X2d0X3BtX21hc2tfaXJxKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHUzMiBtYXNrKTsKKwordm9p
ZCBnZW42X2d0X3BtX2VuYWJsZV9pcnEoc3RydWN0IGludGVsX2d0ICpndCwgdTMyIGVuYWJsZV9t
YXNrKTsKK3ZvaWQgZ2VuNl9ndF9wbV9kaXNhYmxlX2lycShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1
MzIgZGlzYWJsZV9tYXNrKTsKKwordm9pZCBnZW42X2d0X3BtX3Jlc2V0X2lpcihzdHJ1Y3QgaW50
ZWxfZ3QgKmd0LCB1MzIgcmVzZXRfbWFzayk7CisKKyNlbmRpZiAvKiBJTlRFTF9HVF9QTV9JUlFf
SCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMu
aCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmgKaW5kZXggYmZkYWJm
NDliMWU3Li5kNDM3NTJmNTE0NWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2d0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3Rf
dHlwZXMuaApAQCAtMTYsNyArMTYsMTAgQEAKICNpbmNsdWRlICJ1Yy9pbnRlbF91Yy5oIgogCiAj
aW5jbHVkZSAiaTkxNV92bWEuaCIKKyNpbmNsdWRlICJpbnRlbF9sbGNfdHlwZXMuaCIKICNpbmNs
dWRlICJpbnRlbF9yZXNldF90eXBlcy5oIgorI2luY2x1ZGUgImludGVsX3JjNl90eXBlcy5oIgor
I2luY2x1ZGUgImludGVsX3Jwc190eXBlcy5oIgogI2luY2x1ZGUgImludGVsX3dha2VyZWYuaCIK
IAogc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7CkBAIC02NSwxNCArNjgsMjAgQEAgc3RydWN0IGlu
dGVsX2d0IHsKIAkgKi8KIAlpbnRlbF93YWtlcmVmX3QgYXdha2U7CiAKKwlzdHJ1Y3QgaW50ZWxf
bGxjIGxsYzsKKwlzdHJ1Y3QgaW50ZWxfcmM2IHJjNjsKKwlzdHJ1Y3QgaW50ZWxfcnBzIHJwczsK
KwogCXN0cnVjdCBibG9ja2luZ19ub3RpZmllcl9oZWFkIHBtX25vdGlmaWNhdGlvbnM7CiAKIAlr
dGltZV90IGxhc3RfaW5pdF90aW1lOwogCiAJc3RydWN0IGk5MTVfdm1hICpzY3JhdGNoOwogCi0J
dTMyIHBtX2ltcjsKKwlzcGlubG9ja190IGlycV9sb2NrOworCXUzMiBndF9pbXI7CiAJdTMyIHBt
X2llcjsKKwl1MzIgcG1faW1yOwogCiAJdTMyIHBtX2d1Y19ldmVudHM7CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xsYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfbGxjLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li5hMzQ1ZTYwNDY2YmEKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9sbGMuYwpAQCAtMCwwICsxLDEyMCBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBNSVQKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgor
ICovCisKKyNpbmNsdWRlIDxsaW51eC9jcHVmcmVxLmg+CisKKyNpbmNsdWRlICJpbnRlbF9kcnYu
aCIKKyNpbmNsdWRlICJpbnRlbF9ndC5oIgorI2luY2x1ZGUgImludGVsX2xsYy5oIgorI2luY2x1
ZGUgImludGVsX3NpZGViYW5kLmgiCisKK3N0YXRpYyBzdHJ1Y3QgaW50ZWxfZ3QgKmxsY190b19n
dChzdHJ1Y3QgaW50ZWxfbGxjICpsbGMpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihsbGMsIHN0
cnVjdCBpbnRlbF9ndCwgbGxjKTsKK30KKworc3RhdGljIHVuc2lnbmVkIGludCBjcHVfbWF4X01I
eih2b2lkKQoreworCXN0cnVjdCBjcHVmcmVxX3BvbGljeSAqcG9saWN5OworCXVuc2lnbmVkIGlu
dCBtYXhfa2h6OworCisJcG9saWN5ID0gY3B1ZnJlcV9jcHVfZ2V0KDApOworCWlmIChwb2xpY3kp
IHsKKwkJbWF4X2toeiA9IHBvbGljeS0+Y3B1aW5mby5tYXhfZnJlcTsKKwkJY3B1ZnJlcV9jcHVf
cHV0KHBvbGljeSk7CisJfSBlbHNlIHsKKwkJLyoKKwkJICogRGVmYXVsdCB0byBtZWFzdXJlZCBm
cmVxIGlmIG5vbmUgZm91bmQsIFBDVSB3aWxsIGVuc3VyZSB3ZQorCQkgKiBkb24ndCBnbyBvdmVy
CisJCSAqLworCQltYXhfa2h6ID0gdHNjX2toejsKKwl9CisKKwlyZXR1cm4gbWF4X2toeiAvIDEw
MDA7Cit9CisKK3N0YXRpYyB2b2lkIGdlbjZfdXBkYXRlX3JpbmdfZnJlcShzdHJ1Y3QgaW50ZWxf
bGxjICpsbGMpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBsbGNfdG9fZ3Qo
bGxjKS0+aTkxNTsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmbGxjX3RvX2d0KGxsYyktPnJw
czsKKwl1bnNpZ25lZCBpbnQgbWF4X2lhX2ZyZXEsIG1pbl9yaW5nX2ZyZXE7CisJdW5zaWduZWQg
aW50IG1heF9ncHVfZnJlcSwgbWluX2dwdV9mcmVxOworCWNvbnN0IGludCBtaW5fZnJlcSA9IDE1
OworCWNvbnN0IGludCBzY2FsZSA9IDE4MDsKKwl1bnNpZ25lZCBpbnQgZ3B1X2ZyZXE7CisKKwlp
ZiAocnBzLT5tYXhfZnJlcSA8PSBycHMtPm1pbl9mcmVxKQorCQlyZXR1cm47CisKKwltYXhfaWFf
ZnJlcSA9IGNwdV9tYXhfTUh6KCk7CisKKwltaW5fcmluZ19mcmVxID0gaW50ZWxfdW5jb3JlX3Jl
YWQobGxjX3RvX2d0KGxsYyktPnVuY29yZSwgRENMSykgJiAweGY7CisJLyogY29udmVydCBERFIg
ZnJlcXVlbmN5IGZyb20gdW5pdHMgb2YgMjY2LjZNSHogdG8gYmFuZHdpZHRoICovCisJbWluX3Jp
bmdfZnJlcSA9IG11bHRfZnJhYyhtaW5fcmluZ19mcmVxLCA4LCAzKTsKKworCW1pbl9ncHVfZnJl
cSA9IHJwcy0+bWluX2ZyZXE7CisJbWF4X2dwdV9mcmVxID0gcnBzLT5tYXhfZnJlcTsKKwlpZiAo
SVNfR0VOOV9CQyhpOTE1KSB8fCBJTlRFTF9HRU4oaTkxNSkgPj0gMTApIHsKKwkJLyogQ29udmVy
dCBHVCBmcmVxdWVuY3kgdG8gNTAgSFogdW5pdHMgKi8KKwkJbWluX2dwdV9mcmVxIC89IEdFTjlf
RlJFUV9TQ0FMRVI7CisJCW1heF9ncHVfZnJlcSAvPSBHRU45X0ZSRVFfU0NBTEVSOworCX0KKwor
CS8qCisJICogRm9yIGVhY2ggcG90ZW50aWFsIEdQVSBmcmVxdWVuY3ksIGxvYWQgYSByaW5nIGZy
ZXF1ZW5jeSB3ZSdkIGxpa2UKKwkgKiB0byB1c2UgZm9yIG1lbW9yeSBhY2Nlc3MuICBXZSBkbyB0
aGlzIGJ5IHNwZWNpZnlpbmcgdGhlIElBIGZyZXF1ZW5jeQorCSAqIHRoZSBQQ1Ugc2hvdWxkIHVz
ZSBhcyBhIHJlZmVyZW5jZSB0byBkZXRlcm1pbmUgdGhlIHJpbmcgZnJlcXVlbmN5LgorCSAqLwor
CWZvciAoZ3B1X2ZyZXEgPSBtYXhfZ3B1X2ZyZXE7IGdwdV9mcmVxID49IG1pbl9ncHVfZnJlcTsg
Z3B1X2ZyZXEtLSkgeworCQljb25zdCBpbnQgZGlmZiA9IG1heF9ncHVfZnJlcSAtIGdwdV9mcmVx
OworCQl1bnNpZ25lZCBpbnQgaWFfZnJlcSA9IDAsIHJpbmdfZnJlcSA9IDA7CisKKwkJaWYgKElT
X0dFTjlfQkMoaTkxNSkgfHwgSU5URUxfR0VOKGk5MTUpID49IDEwKSB7CisJCQkvKgorCQkJICog
cmluZ19mcmVxID0gMiAqIEdULiByaW5nX2ZyZXEgaXMgaW4gMTAwTUh6IHVuaXRzCisJCQkgKiBO
byBmbG9vciByZXF1aXJlZCBmb3IgcmluZyBmcmVxdWVuY3kgb24gU0tMLgorCQkJICovCisJCQly
aW5nX2ZyZXEgPSBncHVfZnJlcTsKKwkJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkg
eworCQkJLyogbWF4KDIgKiBHVCwgRERSKS4gTkI6IEdUIGlzIDUwTUh6IHVuaXRzICovCisJCQly
aW5nX2ZyZXEgPSBtYXgobWluX3JpbmdfZnJlcSwgZ3B1X2ZyZXEpOworCQl9IGVsc2UgaWYgKElT
X0hBU1dFTEwoaTkxNSkpIHsKKwkJCXJpbmdfZnJlcSA9IG11bHRfZnJhYyhncHVfZnJlcSwgNSwg
NCk7CisJCQlyaW5nX2ZyZXEgPSBtYXgobWluX3JpbmdfZnJlcSwgcmluZ19mcmVxKTsKKwkJCS8q
IGxlYXZlIGlhX2ZyZXEgYXMgdGhlIGRlZmF1bHQsIGNob3NlbiBieSBjcHVmcmVxICovCisJCX0g
ZWxzZSB7CisJCQkvKiBPbiBvbGRlciBwcm9jZXNzb3JzLCB0aGVyZSBpcyBubyBzZXBhcmF0ZSBy
aW5nCisJCQkgKiBjbG9jayBkb21haW4sIHNvIGluIG9yZGVyIHRvIGJvb3N0IHRoZSBiYW5kd2lk
dGgKKwkJCSAqIG9mIHRoZSByaW5nLCB3ZSBuZWVkIHRvIHVwY2xvY2sgdGhlIENQVSAoaWFfZnJl
cSkuCisJCQkgKgorCQkJICogRm9yIEdQVSBmcmVxdWVuY2llcyBsZXNzIHRoYW4gNzUwTUh6LAor
CQkJICoganVzdCB1c2UgdGhlIGxvd2VzdCByaW5nIGZyZXEuCisJCQkgKi8KKwkJCWlmIChncHVf
ZnJlcSA8IG1pbl9mcmVxKQorCQkJCWlhX2ZyZXEgPSA4MDA7CisJCQllbHNlCisJCQkJaWFfZnJl
cSA9IG1heF9pYV9mcmVxIC0gZGlmZiAqIHNjYWxlIC8gMjsKKwkJCWlhX2ZyZXEgPSBESVZfUk9V
TkRfQ0xPU0VTVChpYV9mcmVxLCAxMDApOworCQl9CisKKwkJc2FuZHlicmlkZ2VfcGNvZGVfd3Jp
dGUoaTkxNSwKKwkJCQkJR0VONl9QQ09ERV9XUklURV9NSU5fRlJFUV9UQUJMRSwKKwkJCQkJaWFf
ZnJlcSA8PCBHRU42X1BDT0RFX0ZSRVFfSUFfUkFUSU9fU0hJRlQgfAorCQkJCQlyaW5nX2ZyZXEg
PDwgR0VONl9QQ09ERV9GUkVRX1JJTkdfUkFUSU9fU0hJRlQgfAorCQkJCQlncHVfZnJlcSk7CisJ
fQorfQorCit2b2lkIGludGVsX2xsY19lbmFibGUoc3RydWN0IGludGVsX2xsYyAqbGxjKQorewor
CWlmIChIQVNfTExDKGxsY190b19ndChsbGMpLT5pOTE1KSkKKwkJZ2VuNl91cGRhdGVfcmluZ19m
cmVxKGxsYyk7Cit9CisKK3ZvaWQgaW50ZWxfbGxjX2Rpc2FibGUoc3RydWN0IGludGVsX2xsYyAq
bGxjKQoreworCS8qIEN1cnJlbnRseSB0aGVyZSBpcyBubyBIVyBjb25maWd1cmF0aW9uIHRvIGJl
IGRvbmUgdG8gZGlzYWJsZS4gKi8KK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2xsYy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbGxjLmgKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5lZjA5YTg5MGQyYjcKLS0tIC9k
ZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9sbGMuaApAQCAtMCww
ICsxLDE1IEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENv
cHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2lmbmRlZiBJTlRFTF9M
TENfSAorI2RlZmluZSBJTlRFTF9MTENfSAorCitzdHJ1Y3QgaW50ZWxfbGxjOworCit2b2lkIGlu
dGVsX2xsY19lbmFibGUoc3RydWN0IGludGVsX2xsYyAqbGxjKTsKK3ZvaWQgaW50ZWxfbGxjX2Rp
c2FibGUoc3RydWN0IGludGVsX2xsYyAqbGxjKTsKKworI2VuZGlmIC8qIElOVEVMX0xMQ19IICov
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9sbGNfdHlwZXMuaCBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xsY190eXBlcy5oCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZWNhZDQ2ODdiOTMwCi0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbGxjX3R5cGVzLmgKQEAgLTAsMCArMSwx
MyBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQKKyAqCisgKiBDb3B5cmln
aHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpZm5kZWYgSU5URUxfTExDX1RZ
UEVTX0gKKyNkZWZpbmUgSU5URUxfTExDX1RZUEVTX0gKKworc3RydWN0IGludGVsX2xsYyB7Cit9
OworCisjZW5kaWYgLyogSU5URUxfTExDX1RZUEVTX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfcmM2LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4yZmMwOWFh
YWI2Y2QKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
YzYuYwpAQCAtMCwwICsxLDY2NSBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBN
SVQKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNp
bmNsdWRlIDxsaW51eC9wbV9ydW50aW1lLmg+CisKKyNpbmNsdWRlICJpOTE1X2Rydi5oIgorI2lu
Y2x1ZGUgImludGVsX2d0LmgiCisjaW5jbHVkZSAiaW50ZWxfcmM2LmgiCisjaW5jbHVkZSAiaW50
ZWxfc2lkZWJhbmQuaCIKKworLyoqCisgKiBET0M6IFJDNgorICoKKyAqIFJDNiBpcyBhIHNwZWNp
YWwgcG93ZXIgc3RhZ2Ugd2hpY2ggYWxsb3dzIHRoZSBHUFUgdG8gZW50ZXIgYW4gdmVyeQorICog
bG93LXZvbHRhZ2UgbW9kZSB3aGVuIGlkbGUsIHVzaW5nIGRvd24gdG8gMFYgd2hpbGUgYXQgdGhp
cyBzdGFnZS4gIFRoaXMKKyAqIHN0YWdlIGlzIGVudGVyZWQgYXV0b21hdGljYWxseSB3aGVuIHRo
ZSBHUFUgaXMgaWRsZSB3aGVuIFJDNiBzdXBwb3J0IGlzCisgKiBlbmFibGVkLCBhbmQgYXMgc29v
biBhcyBuZXcgd29ya2xvYWQgYXJpc2VzIEdQVSB3YWtlcyB1cCBhdXRvbWF0aWNhbGx5IGFzCisg
KiB3ZWxsLgorICoKKyAqIFRoZXJlIGFyZSBkaWZmZXJlbnQgUkM2IG1vZGVzIGF2YWlsYWJsZSBp
biBJbnRlbCBHUFUsIHdoaWNoIGRpZmZlcmVudGlhdGUKKyAqIGFtb25nIGVhY2ggb3RoZXIgd2l0
aCB0aGUgbGF0ZW5jeSByZXF1aXJlZCB0byBlbnRlciBhbmQgbGVhdmUgUkM2IGFuZAorICogdm9s
dGFnZSBjb25zdW1lZCBieSB0aGUgR1BVIGluIGRpZmZlcmVudCBzdGF0ZXMuCisgKgorICogVGhl
IGNvbWJpbmF0aW9uIG9mIHRoZSBmb2xsb3dpbmcgZmxhZ3MgZGVmaW5lIHdoaWNoIHN0YXRlcyBH
UFUgaXMgYWxsb3dlZAorICogdG8gZW50ZXIsIHdoaWxlIFJDNiBpcyB0aGUgbm9ybWFsIFJDNiBz
dGF0ZSwgUkM2cCBpcyB0aGUgZGVlcCBSQzYsIGFuZAorICogUkM2cHAgaXMgZGVlcGVzdCBSQzYu
IFRoZWlyIHN1cHBvcnQgYnkgaGFyZHdhcmUgdmFyaWVzIGFjY29yZGluZyB0byB0aGUKKyAqIEdQ
VSwgQklPUywgY2hpcHNldCBhbmQgcGxhdGZvcm0uIFJDNiBpcyB1c3VhbGx5IHRoZSBzYWZlc3Qg
b25lIGFuZCB0aGUgb25lCisgKiB3aGljaCBicmluZ3MgdGhlIG1vc3QgcG93ZXIgc2F2aW5nczsg
ZGVlcGVyIHN0YXRlcyBzYXZlIG1vcmUgcG93ZXIsIGJ1dAorICogcmVxdWlyZSBoaWdoZXIgbGF0
ZW5jeSB0byBzd2l0Y2ggdG8gYW5kIHdha2UgdXAuCisgKi8KKworc3RhdGljIHN0cnVjdCBpbnRl
bF9ndCAqcmM2X3RvX2d0KHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlyZXR1cm4gY29udGFp
bmVyX29mKHJjNiwgc3RydWN0IGludGVsX2d0LCByYzYpOworfQorCitzdGF0aWMgc3RydWN0IGlu
dGVsX3VuY29yZSAqcmM2X3RvX3VuY29yZShzdHJ1Y3QgaW50ZWxfcmM2ICpyYykKK3sKKwlyZXR1
cm4gcmM2X3RvX2d0KHJjKS0+dW5jb3JlOworfQorCitzdGF0aWMgc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKnJjNl90b19pOTE1KHN0cnVjdCBpbnRlbF9yYzYgKnJjKQoreworCXJldHVybiByYzZf
dG9fZ3QocmMpLT5pOTE1OworfQorCitzdGF0aWMgdm9pZCBnZW4xMV9yYzZfZW5hYmxlKHN0cnVj
dCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSByYzZf
dG9fdW5jb3JlKHJjNik7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCWVudW0g
aW50ZWxfZW5naW5lX2lkIGlkOworCisJLyogMWE6IFNvZnR3YXJlIFJDIHN0YXRlIC0gUkMwICov
CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19TVEFURSwgMCk7CisKKwkv
KiAyYTogRGlzYWJsZSBSQyBzdGF0ZXMuICovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29y
ZSwgR0VONl9SQ19DT05UUk9MLCAwKTsKKworCS8qIDJiOiBQcm9ncmFtIFJDNiB0aHJlc2hvbGRz
LiovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQzZfV0FLRV9SQVRFX0xJ
TUlULCA1NCA8PCAxNiB8IDg1KTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU4x
MF9NRURJQV9XQUtFX1JBVEVfTElNSVQsIDE1MCk7CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZnco
dW5jb3JlLCBHRU42X1JDX0VWQUxVQVRJT05fSU5URVJWQUwsIDEyNTAwMCk7IC8qIDEyNTAwICog
MTI4MG5zICovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19JRExFX0hZ
U1RFUlNJUywgMjUpOyAvKiAyNSAqIDEyODBucyAqLworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUs
IHJjNl90b19ndChyYzYpLT5pOTE1LCBpZCkKKwkJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29y
ZSwgUklOR19NQVhfSURMRShlbmdpbmUtPm1taW9fYmFzZSksIDEwKTsKKworCWludGVsX3VuY29y
ZV93cml0ZV9mdyh1bmNvcmUsIEdVQ19NQVhfSURMRV9DT1VOVCwgMHhBKTsKKworCWludGVsX3Vu
Y29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfU0xFRVAsIDApOworCisJaW50ZWxfdW5jb3Jl
X3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQzZfVEhSRVNIT0xELCA1MDAwMCk7IC8qIDUwLzEyNW1z
IHBlciBFSSAqLworCisJLyoKKwkgKiAyYzogUHJvZ3JhbSBDb2Fyc2UgUG93ZXIgR2F0aW5nIFBv
bGljaWVzLgorCSAqCisJICogQnNwZWMncyBndWlkYW5jZSBpcyB0byB1c2UgMjV1cyAocmVhbGx5
IDI1ICogMTI4MG5zKSBoZXJlLiBXaGF0IHdlCisJICogdXNlIGluc3RlYWQgaXMgYSBtb3JlIGNv
bnNlcnZhdGl2ZSBlc3RpbWF0ZSBmb3IgdGhlIG1heGltdW0gdGltZQorCSAqIGl0IHRha2VzIHVz
IHRvIHNlcnZpY2UgYSBDUyBpbnRlcnJ1cHQgYW5kIHN1Ym1pdCBhIG5ldyBFTFNQIC0gdGhhdAor
CSAqIGlzIHRoZSB0aW1lIHdoaWNoIHRoZSBHUFUgaXMgaWRsZSB3YWl0aW5nIGZvciB0aGUgQ1BV
IHRvIHNlbGVjdCB0aGUKKwkgKiBuZXh0IHJlcXVlc3QgdG8gZXhlY3V0ZS4gSWYgdGhlIGlkbGUg
aHlzdGVyZXNpcyBpcyBsZXNzIHRoYW4gdGhhdAorCSAqIGludGVycnVwdCBzZXJ2aWNlIGxhdGVu
Y3ksIHRoZSBoYXJkd2FyZSB3aWxsIGF1dG9tYXRpY2FsbHkgZ2F0ZQorCSAqIHRoZSBwb3dlciB3
ZWxsIGFuZCB3ZSB3aWxsIHRoZW4gaW5jdXIgdGhlIHdha2UgdXAgY29zdCBvbiB0b3Agb2YKKwkg
KiB0aGUgc2VydmljZSBsYXRlbmN5LiBBIHNpbWlsYXIgZ3VpZGUgZnJvbSBwbGFuZV9zdGF0ZSBp
cyB0aGF0IHdlCisJICogZG8gbm90IHdhbnQgdGhlIGVuYWJsZSBoeXN0ZXJlc2lzIHRvIGxlc3Mg
dGhhbiB0aGUgd2FrZXVwIGxhdGVuY3kuCisJICoKKwkgKiBpZ3QvZ2VtX2V4ZWNfbm9wL3NlcXVl
bnRpYWwgcHJvdmlkZXMgYSByb3VnaCBlc3RpbWF0ZSBmb3IgdGhlCisJICogc2VydmljZSBsYXRl
bmN5LCBhbmQgcHV0cyBpdCBhcm91bmQgMTB1cyBmb3IgQnJvYWR3ZWxsIChhbmQgb3RoZXIKKwkg
KiBiaWcgY29yZSkgYW5kIGFyb3VuZCA0MHVzIGZvciBCcm94dG9uIChhbmQgb3RoZXIgbG93IHBv
d2VyIGNvcmVzKS4KKwkgKiBbTm90ZSB0aGF0IGZvciBsZWdhY3kgcmluZ2J1ZmZlciBzdWJtaXNz
aW9uLCB0aGlzIGlzIGxlc3MgdGhhbiAxdXMhXQorCSAqIEhvd2V2ZXIsIHRoZSB3YWtldXAgbGF0
ZW5jeSBvbiBCcm94dG9uIGlzIGNsb3NlciB0byAxMDB1cy4gVG8gYmUKKwkgKiBjb25zZXJ2YXRp
dmUsIHdlIGhhdmUgdG8gZmFjdG9yIGluIGEgY29udGV4dCBzd2l0Y2ggb24gdG9wIChkdWUKKwkg
KiB0byBrc29mdGlycWQpLgorCSAqLworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdF
TjlfTUVESUFfUEdfSURMRV9IWVNURVJFU0lTLCAyNTApOworCWludGVsX3VuY29yZV93cml0ZV9m
dyh1bmNvcmUsIEdFTjlfUkVOREVSX1BHX0lETEVfSFlTVEVSRVNJUywgMjUwKTsKKworCS8qIDNh
OiBFbmFibGUgUkM2ICovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19D
T05UUk9MLAorCQkJICAgICAgR0VONl9SQ19DVExfSFdfRU5BQkxFIHwKKwkJCSAgICAgIEdFTjZf
UkNfQ1RMX1JDNl9FTkFCTEUgfAorCQkJICAgICAgR0VONl9SQ19DVExfRUlfTU9ERSgxKSk7CisK
KwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU45X1BHX0VOQUJMRSwKKwkJCSAgICAg
IEdFTjlfUkVOREVSX1BHX0VOQUJMRSB8CisJCQkgICAgICBHRU45X01FRElBX1BHX0VOQUJMRSB8
CisJCQkgICAgICBHRU4xMV9NRURJQV9TQU1QTEVSX1BHX0VOQUJMRSk7Cit9CisKK3N0YXRpYyB2
b2lkIGdlbjlfcmM2X2VuYWJsZShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCit7CisJc3RydWN0IGlu
dGVsX3VuY29yZSAqdW5jb3JlID0gcmM2X3RvX3VuY29yZShyYzYpOworCXN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZTsKKwllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKKwl1MzIgcmM2X21v
ZGU7CisKKwkvKiAxYTogU29mdHdhcmUgUkMgc3RhdGUgLSBSQzAgKi8KKwlpbnRlbF91bmNvcmVf
d3JpdGVfZncodW5jb3JlLCBHRU42X1JDX1NUQVRFLCAwKTsKKworCS8qIDJhOiBEaXNhYmxlIFJD
IHN0YXRlcy4gKi8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX0NPTlRS
T0wsIDApOworCisJLyogMmI6IFByb2dyYW0gUkM2IHRocmVzaG9sZHMuKi8KKwlpZiAoSU5URUxf
R0VOKHJjNl90b19pOTE1KHJjNikpID49IDEwKSB7CisJCWludGVsX3VuY29yZV93cml0ZV9mdyh1
bmNvcmUsIEdFTjZfUkM2X1dBS0VfUkFURV9MSU1JVCwgNTQgPDwgMTYgfCA4NSk7CisJCWludGVs
X3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjEwX01FRElBX1dBS0VfUkFURV9MSU1JVCwgMTUw
KTsKKwl9IGVsc2UgaWYgKElTX1NLWUxBS0UocmM2X3RvX2k5MTUocmM2KSkpIHsKKwkJLyoKKwkJ
ICogV2FSc0RvdWJsZVJjNldybFdpdGhDb2Fyc2VQb3dlckdhdGluZzpza2wgRG91YmxpbmcgV1JM
IG9ubHkKKwkJICogd2hlbiBDUEcgaXMgZW5hYmxlZAorCQkgKi8KKwkJaW50ZWxfdW5jb3JlX3dy
aXRlX2Z3KHVuY29yZSwgR0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCAxMDggPDwgMTYpOworCX0g
ZWxzZSB7CisJCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkM2X1dBS0VfUkFU
RV9MSU1JVCwgNTQgPDwgMTYpOworCX0KKworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUs
IEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsgLyogMTI1MDAgKiAxMjgwbnMg
Ki8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX0lETEVfSFlTVEVSU0lT
LCAyNSk7IC8qIDI1ICogMTI4MG5zICovCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgcmM2X3Rv
X2d0KHJjNiktPmk5MTUsIGlkKQorCQlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBSSU5H
X01BWF9JRExFKGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOworCisJaW50ZWxfdW5jb3JlX3dyaXRl
X2Z3KHVuY29yZSwgR1VDX01BWF9JRExFX0NPVU5ULCAweEEpOworCisJaW50ZWxfdW5jb3JlX3dy
aXRlX2Z3KHVuY29yZSwgR0VONl9SQ19TTEVFUCwgMCk7CisKKwkvKgorCSAqIDJjOiBQcm9ncmFt
IENvYXJzZSBQb3dlciBHYXRpbmcgUG9saWNpZXMuCisJICoKKwkgKiBCc3BlYydzIGd1aWRhbmNl
IGlzIHRvIHVzZSAyNXVzIChyZWFsbHkgMjUgKiAxMjgwbnMpIGhlcmUuIFdoYXQgd2UKKwkgKiB1
c2UgaW5zdGVhZCBpcyBhIG1vcmUgY29uc2VydmF0aXZlIGVzdGltYXRlIGZvciB0aGUgbWF4aW11
bSB0aW1lCisJICogaXQgdGFrZXMgdXMgdG8gc2VydmljZSBhIENTIGludGVycnVwdCBhbmQgc3Vi
bWl0IGEgbmV3IEVMU1AgLSB0aGF0CisJICogaXMgdGhlIHRpbWUgd2hpY2ggdGhlIEdQVSBpcyBp
ZGxlIHdhaXRpbmcgZm9yIHRoZSBDUFUgdG8gc2VsZWN0IHRoZQorCSAqIG5leHQgcmVxdWVzdCB0
byBleGVjdXRlLiBJZiB0aGUgaWRsZSBoeXN0ZXJlc2lzIGlzIGxlc3MgdGhhbiB0aGF0CisJICog
aW50ZXJydXB0IHNlcnZpY2UgbGF0ZW5jeSwgdGhlIGhhcmR3YXJlIHdpbGwgYXV0b21hdGljYWxs
eSBnYXRlCisJICogdGhlIHBvd2VyIHdlbGwgYW5kIHdlIHdpbGwgdGhlbiBpbmN1ciB0aGUgd2Fr
ZSB1cCBjb3N0IG9uIHRvcCBvZgorCSAqIHRoZSBzZXJ2aWNlIGxhdGVuY3kuIEEgc2ltaWxhciBn
dWlkZSBmcm9tIHBsYW5lX3N0YXRlIGlzIHRoYXQgd2UKKwkgKiBkbyBub3Qgd2FudCB0aGUgZW5h
YmxlIGh5c3RlcmVzaXMgdG8gbGVzcyB0aGFuIHRoZSB3YWtldXAgbGF0ZW5jeS4KKwkgKgorCSAq
IGlndC9nZW1fZXhlY19ub3Avc2VxdWVudGlhbCBwcm92aWRlcyBhIHJvdWdoIGVzdGltYXRlIGZv
ciB0aGUKKwkgKiBzZXJ2aWNlIGxhdGVuY3ksIGFuZCBwdXRzIGl0IGFyb3VuZCAxMHVzIGZvciBC
cm9hZHdlbGwgKGFuZCBvdGhlcgorCSAqIGJpZyBjb3JlKSBhbmQgYXJvdW5kIDQwdXMgZm9yIEJy
b3h0b24gKGFuZCBvdGhlciBsb3cgcG93ZXIgY29yZXMpLgorCSAqIFtOb3RlIHRoYXQgZm9yIGxl
Z2FjeSByaW5nYnVmZmVyIHN1Ym1pc3Npb24sIHRoaXMgaXMgbGVzcyB0aGFuIDF1cyFdCisJICog
SG93ZXZlciwgdGhlIHdha2V1cCBsYXRlbmN5IG9uIEJyb3h0b24gaXMgY2xvc2VyIHRvIDEwMHVz
LiBUbyBiZQorCSAqIGNvbnNlcnZhdGl2ZSwgd2UgaGF2ZSB0byBmYWN0b3IgaW4gYSBjb250ZXh0
IHN3aXRjaCBvbiB0b3AgKGR1ZQorCSAqIHRvIGtzb2Z0aXJxZCkuCisJICovCisJaW50ZWxfdW5j
b3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VOOV9NRURJQV9QR19JRExFX0hZU1RFUkVTSVMsIDI1MCk7
CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VOOV9SRU5ERVJfUEdfSURMRV9IWVNU
RVJFU0lTLCAyNTApOworCisJLyogM2E6IEVuYWJsZSBSQzYgKi8KKwlpbnRlbF91bmNvcmVfd3Jp
dGVfZncodW5jb3JlLCBHRU42X1JDNl9USFJFU0hPTEQsIDM3NTAwKTsgLyogMzcuNS8xMjVtcyBw
ZXIgRUkgKi8KKworCS8qIFdhUnNVc2VUaW1lb3V0TW9kZTpjbmwgKHByZS1wcm9kKSAqLworCWlm
IChJU19DTkxfUkVWSUQocmM2X3RvX2k5MTUocmM2KSwgQ05MX1JFVklEX0EwLCBDTkxfUkVWSURf
QzApKQorCQlyYzZfbW9kZSA9IEdFTjdfUkNfQ1RMX1RPX01PREU7CisJZWxzZQorCQlyYzZfbW9k
ZSA9IEdFTjZfUkNfQ1RMX0VJX01PREUoMSk7CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5j
b3JlLCBHRU42X1JDX0NPTlRST0wsCisJCQkgICAgICBHRU42X1JDX0NUTF9IV19FTkFCTEUgfAor
CQkJICAgICAgR0VONl9SQ19DVExfUkM2X0VOQUJMRSB8CisJCQkgICAgICByYzZfbW9kZSk7CisK
KwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU45X1BHX0VOQUJMRSwKKwkJCSAgICAg
IEdFTjlfUkVOREVSX1BHX0VOQUJMRSB8IEdFTjlfTUVESUFfUEdfRU5BQkxFKTsKK30KKworc3Rh
dGljIHZvaWQgZ2VuOF9yYzZfZW5hYmxlKHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1
Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSByYzZfdG9fdW5jb3JlKHJjNik7CisJc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lOworCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOworCisJLyog
MWE6IFNvZnR3YXJlIFJDIHN0YXRlIC0gUkMwICovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVu
Y29yZSwgR0VONl9SQ19TVEFURSwgMCk7CisKKwkvKiAyYTogRGlzYWJsZSBSQyBzdGF0ZXMuICov
CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19DT05UUk9MLCAwKTsKKwor
CS8qIDJiOiBQcm9ncmFtIFJDNiB0aHJlc2hvbGRzLiovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3
KHVuY29yZSwgR0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCA0MCA8PCAxNik7CisJaW50ZWxfdW5j
b3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19FVkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDAp
OyAvKiAxMjUwMCAqIDEyODBucyAqLworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdF
TjZfUkNfSURMRV9IWVNURVJTSVMsIDI1KTsgLyogMjUgKiAxMjgwbnMgKi8KKwlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCByYzZfdG9fZ3QocmM2KS0+aTkxNSwgaWQpCisJCWludGVsX3VuY29yZV93
cml0ZV9mdyh1bmNvcmUsIFJJTkdfTUFYX0lETEUoZW5naW5lLT5tbWlvX2Jhc2UpLCAxMCk7CisJ
aW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19TTEVFUCwgMCk7CisJaW50ZWxf
dW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQzZfVEhSRVNIT0xELCA2MjUpOyAvKiA4MDB1
cy8xLjI4IGZvciBUTyAqLworCisJLyogMzogRW5hYmxlIFJDNiAqLworCWludGVsX3VuY29yZV93
cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCwKKwkJCSAgICAgIEdFTjZfUkNfQ1RMX0hX
X0VOQUJMRSB8CisJCQkgICAgICBHRU43X1JDX0NUTF9UT19NT0RFIHwKKwkJCSAgICAgIEdFTjZf
UkNfQ1RMX1JDNl9FTkFCTEUpOworfQorCitzdGF0aWMgdm9pZCBnZW42X3JjNl9lbmFibGUoc3Ry
dWN0IGludGVsX3JjNiAqcmM2KQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJj
Nl90b191bmNvcmUocmM2KTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJjNl90
b19pOTE1KHJjNik7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCWVudW0gaW50
ZWxfZW5naW5lX2lkIGlkOworCXUzMiByYzZ2aWRzLCByYzZfbWFzazsKKwlpbnQgcmV0OworCisJ
aW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19TVEFURSwgMCk7CisKKwkvKiBk
aXNhYmxlIHRoZSBjb3VudGVycyBhbmQgc2V0IGRldGVybWluaXN0aWMgdGhyZXNob2xkcyAqLwor
CWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCwgMCk7CisKKwlp
bnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDMV9XQUtFX1JBVEVfTElNSVQsIDEw
MDAgPDwgMTYpOworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkM2X1dBS0Vf
UkFURV9MSU1JVCwgNDAgPDwgMTYgfCAzMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29y
ZSwgR0VONl9SQzZwcF9XQUtFX1JBVEVfTElNSVQsIDMwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVf
ZncodW5jb3JlLCBHRU42X1JDX0VWQUxVQVRJT05fSU5URVJWQUwsIDEyNTAwMCk7CisJaW50ZWxf
dW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19JRExFX0hZU1RFUlNJUywgMjUpOworCisJ
Zm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCisJCWludGVsX3VuY29yZV93cml0ZV9m
dyh1bmNvcmUsIFJJTkdfTUFYX0lETEUoZW5naW5lLT5tbWlvX2Jhc2UpLAorCQkJCSAgICAgIDEw
KTsKKworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfU0xFRVAsIDApOwor
CWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkMxZV9USFJFU0hPTEQsIDEwMDAp
OworCWlmIChJU19JVllCUklER0UoaTkxNSkpCisJCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNv
cmUsIEdFTjZfUkM2X1RIUkVTSE9MRCwgMTI1MDAwKTsKKwllbHNlCisJCWludGVsX3VuY29yZV93
cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkM2X1RIUkVTSE9MRCwgNTAwMDApOworCWludGVsX3VuY29y
ZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkM2cF9USFJFU0hPTEQsIDE1MDAwMCk7CisJaW50ZWxf
dW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQzZwcF9USFJFU0hPTEQsIDY0MDAwKTsgLyog
dW51c2VkICovCisKKwkvKiBXZSBkb24ndCB1c2UgdGhvc2Ugb24gSGFzd2VsbCAqLworCXJjNl9t
YXNrID0gR0VONl9SQ19DVExfUkM2X0VOQUJMRTsKKwlpZiAoSEFTX1JDNnAoaTkxNSkpCisJCXJj
Nl9tYXNrIHw9IEdFTjZfUkNfQ1RMX1JDNnBfRU5BQkxFOworCWlmIChIQVNfUkM2cHAoaTkxNSkp
CisJCXJjNl9tYXNrIHw9IEdFTjZfUkNfQ1RMX1JDNnBwX0VOQUJMRTsKKwlpbnRlbF91bmNvcmVf
d3JpdGVfZncodW5jb3JlLCBHRU42X1JDX0NPTlRST0wsCisJCQkgICAgICByYzZfbWFzayB8CisJ
CQkgICAgICBHRU42X1JDX0NUTF9FSV9NT0RFKDEpIHwKKwkJCSAgICAgIEdFTjZfUkNfQ1RMX0hX
X0VOQUJMRSk7CisKKwlyYzZ2aWRzID0gMDsKKwlyZXQgPSBzYW5keWJyaWRnZV9wY29kZV9yZWFk
KGk5MTUsIEdFTjZfUENPREVfUkVBRF9SQzZWSURTLAorCQkJCSAgICAgJnJjNnZpZHMsIE5VTEwp
OworCWlmIChJU19HRU4oaTkxNSwgNikgJiYgcmV0KSB7CisJCURSTV9ERUJVR19EUklWRVIoIkNv
dWxkbid0IGNoZWNrIGZvciBCSU9TIHdvcmthcm91bmRcbiIpOworCX0gZWxzZSBpZiAoSVNfR0VO
KGk5MTUsIDYpICYmIChHRU42X0RFQ09ERV9SQzZfVklEKHJjNnZpZHMgJiAweGZmKSA8IDQ1MCkp
IHsKKwkJRFJNX0RFQlVHX0RSSVZFUigiWW91IHNob3VsZCB1cGRhdGUgeW91ciBCSU9TLiBDb3Jy
ZWN0aW5nIG1pbmltdW0gcmM2IHZvbHRhZ2UgKCVkbVYtPiVkbVYpXG4iLAorCQkJCSBHRU42X0RF
Q09ERV9SQzZfVklEKHJjNnZpZHMgJiAweGZmKSwgNDUwKTsKKwkJcmM2dmlkcyAmPSAweGZmZmYw
MDsKKwkJcmM2dmlkcyB8PSBHRU42X0VOQ09ERV9SQzZfVklEKDQ1MCk7CisJCXJldCA9IHNhbmR5
YnJpZGdlX3Bjb2RlX3dyaXRlKGk5MTUsIEdFTjZfUENPREVfV1JJVEVfUkM2VklEUywgcmM2dmlk
cyk7CisJCWlmIChyZXQpCisJCQlEUk1fRVJST1IoIkNvdWxkbid0IGZpeCBpbmNvcnJlY3QgcmM2
IHZvbHRhZ2VcbiIpOworCX0KK30KKworLyogQ2hlY2sgdGhhdCB0aGUgcGNiciBhZGRyZXNzIGlz
IG5vdCBlbXB0eS4gKi8KK3N0YXRpYyB2b2lkIGNodl9yYzZfaW5pdChzdHJ1Y3QgaW50ZWxfcmM2
ICpyYzYpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcmM2X3RvX3VuY29yZShy
YzYpOworCXJlc291cmNlX3NpemVfdCBwY3R4X3BhZGRyLCBwYWRkcjsKKwlyZXNvdXJjZV9zaXpl
X3QgcGN0eF9zaXplID0gMzIgKiBTWl8xSzsKKwl1MzIgcGNicjsKKworCXBjYnIgPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIFZMVl9QQ0JSKTsKKwlpZiAoKHBjYnIgPj4gVkxWX1BDQlJfQURE
Ul9TSElGVCkgPT0gMCkgeworCQlEUk1fREVCVUdfRFJJVkVSKCJCSU9TIGRpZG4ndCBzZXQgdXAg
UENCUiwgZml4aW5nIHVwXG4iKTsKKwkJcGFkZHIgPSByYzZfdG9faTkxNShyYzYpLT5kc20uZW5k
ICsgMSAtIHBjdHhfc2l6ZTsKKwkJR0VNX0JVR19PTihwYWRkciA+IFUzMl9NQVgpOworCisJCXBj
dHhfcGFkZHIgPSAocGFkZHIgJiB+NDA5NSk7CisJCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUs
IFZMVl9QQ0JSLCBwY3R4X3BhZGRyKTsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIHZsdl9yYzZfaW5p
dChzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSByYzZfdG9faTkxNShyYzYpOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJj
Nl90b191bmNvcmUocmM2KTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqcGN0eDsKKwly
ZXNvdXJjZV9zaXplX3QgcGN0eF9wYWRkcjsKKwlyZXNvdXJjZV9zaXplX3QgcGN0eF9zaXplID0g
MjQgKiBTWl8xSzsKKwl1MzIgcGNicjsKKworCXBjYnIgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNv
cmUsIFZMVl9QQ0JSKTsKKwlpZiAocGNicikgeworCQkvKiBCSU9TIHNldCBpdCB1cCBhbHJlYWR5
LCBncmFiIHRoZSBwcmUtYWxsb2MnZCBzcGFjZSAqLworCQlyZXNvdXJjZV9zaXplX3QgcGNicl9v
ZmZzZXQ7CisKKwkJcGNicl9vZmZzZXQgPSAocGNiciAmIH40MDk1KSAtIGk5MTUtPmRzbS5zdGFy
dDsKKwkJcGN0eCA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuX2Zvcl9wcmVhbGxvY2F0
ZWQoaTkxNSwKKwkJCQkJCQkJICAgICAgcGNicl9vZmZzZXQsCisJCQkJCQkJCSAgICAgIEk5MTVf
R1RUX09GRlNFVF9OT05FLAorCQkJCQkJCQkgICAgICBwY3R4X3NpemUpOworCQlnb3RvIG91dDsK
Kwl9CisKKwlEUk1fREVCVUdfRFJJVkVSKCJCSU9TIGRpZG4ndCBzZXQgdXAgUENCUiwgZml4aW5n
IHVwXG4iKTsKKworCS8qCisJICogRnJvbSB0aGUgR3VuaXQgcmVnaXN0ZXIgSEFTOgorCSAqIFRo
ZSBHZnggZHJpdmVyIGlzIGV4cGVjdGVkIHRvIHByb2dyYW0gdGhpcyByZWdpc3RlciBhbmQgZW5z
dXJlCisJICogcHJvcGVyIGFsbG9jYXRpb24gd2l0aGluIEdmeCBzdG9sZW4gbWVtb3J5LiAgRm9y
IGV4YW1wbGUsIHRoaXMKKwkgKiByZWdpc3RlciBzaG91bGQgYmUgcHJvZ3JhbW1lZCBzdWNoIHRo
YW4gdGhlIFBDQlIgcmFuZ2UgZG9lcyBub3QKKwkgKiBvdmVybGFwIHdpdGggb3RoZXIgcmFuZ2Vz
LCBzdWNoIGFzIHRoZSBmcmFtZSBidWZmZXIsIHByb3RlY3RlZAorCSAqIG1lbW9yeSwgb3IgYW55
IG90aGVyIHJlbGV2YW50IHJhbmdlcy4KKwkgKi8KKwlwY3R4ID0gaTkxNV9nZW1fb2JqZWN0X2Ny
ZWF0ZV9zdG9sZW4oaTkxNSwgcGN0eF9zaXplKTsKKwlpZiAoIXBjdHgpIHsKKwkJRFJNX0RFQlVH
KCJub3QgZW5vdWdoIHN0b2xlbiBzcGFjZSBmb3IgUENUWCwgZGlzYWJsaW5nXG4iKTsKKwkJZ290
byBvdXQ7CisJfQorCisJR0VNX0JVR19PTihyYW5nZV9vdmVyZmxvd3NfdCh1NjQsCisJCQkJICAg
ICBpOTE1LT5kc20uc3RhcnQsCisJCQkJICAgICBwY3R4LT5zdG9sZW4tPnN0YXJ0LAorCQkJCSAg
ICAgVTMyX01BWCkpOworCXBjdHhfcGFkZHIgPSBpOTE1LT5kc20uc3RhcnQgKyBwY3R4LT5zdG9s
ZW4tPnN0YXJ0OworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIFZMVl9QQ0JSLCBwY3R4X3Bh
ZGRyKTsKKworb3V0OgorCXJjNi0+cGN0eCA9IHBjdHg7Cit9CisKK3N0YXRpYyB2b2lkIGNodl9y
YzZfZW5hYmxlKHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3Jl
ICp1bmNvcmUgPSByYzZfdG9fdW5jb3JlKHJjNik7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lOworCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOworCisJLyogIERpc2FibGUgUkMgc3Rh
dGVzLiAqLworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCwg
MCk7CisKKwkvKiAyYTogUHJvZ3JhbSBSQzYgdGhyZXNob2xkcy4qLworCWludGVsX3VuY29yZV93
cml0ZV9mdyh1bmNvcmUsCisJCQkgICAgICBHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDQwIDw8
IDE2KTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCAvKiAxMjUwMCAqIDEyODBucyAq
LworCQkJICAgICAgR0VONl9SQ19FVkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDApOworCWludGVs
X3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIC8qIDI1ICogMTI4MG5zICovCisJCQkgICAgICBHRU42
X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7CisKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCByYzZf
dG9fZ3QocmM2KS0+aTkxNSwgaWQpCisJCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIFJJ
TkdfTUFYX0lETEUoZW5naW5lLT5tbWlvX2Jhc2UpLAorCQkJCSAgICAgIDEwKTsKKwlpbnRlbF91
bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX1NMRUVQLCAwKTsKKworCS8qIFRPIHRocmVz
aG9sZCBzZXQgdG8gNTAwIHVzICggMHgxODYgKiAxLjI4IHVzKSAqLworCWludGVsX3VuY29yZV93
cml0ZV9mdyh1bmNvcmUsIEdFTjZfUkM2X1RIUkVTSE9MRCwgMHgxODYpOworCisJLyogQWxsb3dz
IFJDNiByZXNpZGVuY3kgY291bnRlciB0byB3b3JrICovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3
KHVuY29yZSwgVkxWX0NPVU5URVJfQ09OVFJPTCwKKwkJCSAgICAgIF9NQVNLRURfQklUX0VOQUJM
RShWTFZfQ09VTlRfUkFOR0VfSElHSCB8CisJCQkJCQkgVkxWX01FRElBX1JDNl9DT1VOVF9FTiB8
CisJCQkJCQkgVkxWX1JFTkRFUl9SQzZfQ09VTlRfRU4pKTsKKworCS8qIDM6IEVuYWJsZSBSQzYg
Ki8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX0NPTlRST0wsIEdFTjdf
UkNfQ1RMX1RPX01PREUpOworfQorCitzdGF0aWMgdm9pZCB2bHZfcmM2X2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfcmM2ICpyYzYpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcmM2X3Rv
X3VuY29yZShyYzYpOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwllbnVtIGlu
dGVsX2VuZ2luZV9pZCBpZDsKKworCS8qICBEaXNhYmxlIFJDIHN0YXRlcy4gKi8KKwlpbnRlbF91
bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX0NPTlRST0wsIDApOworCisJaW50ZWxfdW5j
b3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCAweDAwMjgwMDAw
KTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX0VWQUxVQVRJT05fSU5U
RVJWQUwsIDEyNTAwMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19J
RExFX0hZU1RFUlNJUywgMjUpOworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgcmM2X3RvX2d0
KHJjNiktPmk5MTUsIGlkKQorCQlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLAorCQkJCSAg
ICAgIFJJTkdfTUFYX0lETEUoZW5naW5lLT5tbWlvX2Jhc2UpLCAxMCk7CisKKwlpbnRlbF91bmNv
cmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDNl9USFJFU0hPTEQsIDB4NTU3KTsKKworCS8qIEFs
bG93cyBSQzYgcmVzaWRlbmN5IGNvdW50ZXIgdG8gd29yayAqLworCWludGVsX3VuY29yZV93cml0
ZV9mdyh1bmNvcmUsIFZMVl9DT1VOVEVSX0NPTlRST0wsCisJCQkgICAgICBfTUFTS0VEX0JJVF9F
TkFCTEUoVkxWX0NPVU5UX1JBTkdFX0hJR0ggfAorCQkJCQkJIFZMVl9NRURJQV9SQzBfQ09VTlRf
RU4gfAorCQkJCQkJIFZMVl9SRU5ERVJfUkMwX0NPVU5UX0VOIHwKKwkJCQkJCSBWTFZfTUVESUFf
UkM2X0NPVU5UX0VOIHwKKwkJCQkJCSBWTFZfUkVOREVSX1JDNl9DT1VOVF9FTikpOworCisJaW50
ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19DT05UUk9MLAorCQkJICAgICAgR0VO
N19SQ19DVExfVE9fTU9ERSB8IFZMVl9SQ19DVExfQ1RYX1JTVF9QQVJBTExFTCk7Cit9CisKK3Zv
aWQgaW50ZWxfcmM2X2luaXQoc3RydWN0IGludGVsX3JjNiAqcmM2KQoreworCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gcmM2X3RvX2k5MTUocmM2KTsKKworCWlmIChJU19DSEVSUllW
SUVXKGk5MTUpKQorCQljaHZfcmM2X2luaXQocmM2KTsKKwllbHNlIGlmIChJU19WQUxMRVlWSUVX
KGk5MTUpKQorCQl2bHZfcmM2X2luaXQocmM2KTsKK30KKworc3RhdGljIGJvb2wgYnh0X2NoZWNr
X2Jpb3NfcmM2X3NldHVwKHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgaW50ZWxf
dW5jb3JlICp1bmNvcmUgPSByYzZfdG9fdW5jb3JlKHJjNik7CisJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSByYzZfdG9faTkxNShyYzYpOworCXUzMiByYzZfY3R4X2Jhc2UsIHJjX2N0
bCwgcmNfc3dfdGFyZ2V0OworCWJvb2wgZW5hYmxlX3JjNiA9IHRydWU7CisKKwlyY19jdGwgPSBp
bnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCk7CisJcmNfc3dfdGFyZ2V0
ID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JDX1NUQVRFKTsKKwlyY19zd190YXJn
ZXQgJj0gUkNfU1dfVEFSR0VUX1NUQVRFX01BU0s7CisJcmNfc3dfdGFyZ2V0ID4+PSBSQ19TV19U
QVJHRVRfU1RBVEVfU0hJRlQ7CisJRFJNX0RFQlVHX0RSSVZFUigiQklPUyBlbmFibGVkIFJDIHN0
YXRlczogIgorCQkJICJIV19DVFJMICVzIEhXX1JDNiAlcyBTV19UQVJHRVRfU1RBVEUgJXhcbiIs
CisJCQkgb25vZmYocmNfY3RsICYgR0VONl9SQ19DVExfSFdfRU5BQkxFKSwKKwkJCSBvbm9mZihy
Y19jdGwgJiBHRU42X1JDX0NUTF9SQzZfRU5BQkxFKSwKKwkJCSByY19zd190YXJnZXQpOworCisJ
aWYgKCEoaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBSQzZfTE9DQVRJT04pICYgUkM2X0NUWF9J
Tl9EUkFNKSkgeworCQlEUk1fREVCVUdfRFJJVkVSKCJSQzYgQmFzZSBsb2NhdGlvbiBub3Qgc2V0
IHByb3Blcmx5LlxuIik7CisJCWVuYWJsZV9yYzYgPSBmYWxzZTsKKwl9CisKKwkvKgorCSAqIFRo
ZSBleGFjdCBjb250ZXh0IHNpemUgaXMgbm90IGtub3duIGZvciBCWFQsIHNvIGFzc3VtZSBhIHBh
Z2Ugc2l6ZQorCSAqIGZvciB0aGlzIGNoZWNrLgorCSAqLworCXJjNl9jdHhfYmFzZSA9CisJCWlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgUkM2X0NUWF9CQVNFKSAmIFJDNl9DVFhfQkFTRV9NQVNL
OworCWlmICghKHJjNl9jdHhfYmFzZSA+PSBpOTE1LT5kc21fcmVzZXJ2ZWQuc3RhcnQgJiYKKwkg
ICAgICByYzZfY3R4X2Jhc2UgKyBQQUdFX1NJWkUgPCBpOTE1LT5kc21fcmVzZXJ2ZWQuZW5kKSkg
eworCQlEUk1fREVCVUdfRFJJVkVSKCJSQzYgQmFzZSBhZGRyZXNzIG5vdCBhcyBleHBlY3RlZC5c
biIpOworCQllbmFibGVfcmM2ID0gZmFsc2U7CisJfQorCisJaWYgKCEoKGludGVsX3VuY29yZV9y
ZWFkKHVuY29yZSwgUFdSQ1RYX01BWENOVF9SQ1NVTklUKSAmIElETEVfVElNRV9NQVNLKSA+IDEg
JiYKKwkgICAgICAoaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBQV1JDVFhfTUFYQ05UX1ZDU1VO
SVQwKSAmIElETEVfVElNRV9NQVNLKSA+IDEgJiYKKwkgICAgICAoaW50ZWxfdW5jb3JlX3JlYWQo
dW5jb3JlLCBQV1JDVFhfTUFYQ05UX0JDU1VOSVQpICYgSURMRV9USU1FX01BU0spID4gMSAmJgor
CSAgICAgIChpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFBXUkNUWF9NQVhDTlRfVkVDU1VOSVQp
ICYgSURMRV9USU1FX01BU0spID4gMSkpIHsKKwkJRFJNX0RFQlVHX0RSSVZFUigiRW5naW5lIElk
bGUgd2FpdCB0aW1lIG5vdCBzZXQgcHJvcGVybHkuXG4iKTsKKwkJZW5hYmxlX3JjNiA9IGZhbHNl
OworCX0KKworCWlmICghaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU44X1BVU0hCVVNfQ09O
VFJPTCkgfHwKKwkgICAgIWludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VOOF9QVVNIQlVTX0VO
QUJMRSkgfHwKKwkgICAgIWludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VOOF9QVVNIQlVTX1NI
SUZUKSkgeworCQlEUk1fREVCVUdfRFJJVkVSKCJQdXNoYnVzIG5vdCBzZXR1cCBwcm9wZXJseS5c
biIpOworCQllbmFibGVfcmM2ID0gZmFsc2U7CisJfQorCisJaWYgKCFpbnRlbF91bmNvcmVfcmVh
ZCh1bmNvcmUsIEdFTjZfR0ZYUEFVU0UpKSB7CisJCURSTV9ERUJVR19EUklWRVIoIkdGWCBwYXVz
ZSBub3Qgc2V0dXAgcHJvcGVybHkuXG4iKTsKKwkJZW5hYmxlX3JjNiA9IGZhbHNlOworCX0KKwor
CWlmICghaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU44X01JU0NfQ1RSTDApKSB7CisJCURS
TV9ERUJVR19EUklWRVIoIkdQTSBjb250cm9sIG5vdCBzZXR1cCBwcm9wZXJseS5cbiIpOworCQll
bmFibGVfcmM2ID0gZmFsc2U7CisJfQorCisJcmV0dXJuIGVuYWJsZV9yYzY7Cit9CisKK3ZvaWQg
aW50ZWxfcmM2X2VuYWJsZShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCit7CisJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSByYzZfdG9faTkxNShyYzYpOworCXN0cnVjdCBpbnRlbF91bmNv
cmUgKnVuY29yZSA9IHJjNl90b191bmNvcmUocmM2KTsKKworCWlmIChJU19HRU45X0xQKGk5MTUp
ICYmICFieHRfY2hlY2tfYmlvc19yYzZfc2V0dXAocmM2KSkgeworCQlEUk1fSU5GTygiUkM2IGFu
ZCBwb3dlcnNhdmluZyBkaXNhYmxlZCBieSBCSU9TXG4iKTsKKwkJcG1fcnVudGltZV9nZXQoJmk5
MTUtPmRybS5wZGV2LT5kZXYpOworCQlyZXR1cm47CisJfQorCisJaW50ZWxfdW5jb3JlX2ZvcmNl
d2FrZV9nZXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKworCWlmIChJU19DSEVSUllWSUVXKGk5
MTUpKQorCQljaHZfcmM2X2VuYWJsZShyYzYpOworCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkx
NSkpCisJCXZsdl9yYzZfZW5hYmxlKHJjNik7CisJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49
IDExKQorCQlnZW4xMV9yYzZfZW5hYmxlKHJjNik7CisJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDkpCisJCWdlbjlfcmM2X2VuYWJsZShyYzYpOworCWVsc2UgaWYgKElTX0JST0FEV0VMTChp
OTE1KSkKKwkJZ2VuOF9yYzZfZW5hYmxlKHJjNik7CisJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDYpCisJCWdlbjZfcmM2X2VuYWJsZShyYzYpOworCisJaW50ZWxfdW5jb3JlX2ZvcmNld2Fr
ZV9wdXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKworCXJjNi0+ZW5hYmxlZCA9IHRydWU7Cit9
CisKK3ZvaWQgaW50ZWxfcmM2X2Rpc2FibGUoc3RydWN0IGludGVsX3JjNiAqcmM2KQoreworCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcmM2X3RvX2k5MTUocmM2KTsKKwlzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmUgPSByYzZfdG9fdW5jb3JlKHJjNik7CisKKwlpZiAoSU5URUxf
R0VOKGk5MTUpIDwgNikKKwkJcmV0dXJuOworCisJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQo
dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBH
RU42X1JDX0NPTlRST0wsIDApOworCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKKwkJaW50ZWxf
dW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VOOV9QR19FTkFCTEUsIDApOworCWludGVsX3VuY29y
ZV9mb3JjZXdha2VfcHV0KHVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7CisKKwlyYzYtPmVuYWJsZWQg
PSBmYWxzZTsKK30KKwordm9pZCBpbnRlbF9yYzZfZmluaShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYp
Cit7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKnBjdHg7CisKKwlwY3R4ID0gZmV0Y2hf
YW5kX3plcm8oJnJjNi0+cGN0eCk7CisJaWYgKHBjdHgpCisJCWk5MTVfZ2VtX29iamVjdF9wdXQo
cGN0eCk7Cit9CisKK3N0YXRpYyB1NjQgdmx2X3Jlc2lkZW5jeV9yYXcoc3RydWN0IGludGVsX3Vu
Y29yZSAqdW5jb3JlLCBjb25zdCBpOTE1X3JlZ190IHJlZykKK3sKKwl1MzIgbG93ZXIsIHVwcGVy
LCB0bXA7CisJaW50IGxvb3AgPSAyOworCisJLyoKKwkgKiBUaGUgcmVnaXN0ZXIgYWNjZXNzZWQg
ZG8gbm90IG5lZWQgZm9yY2V3YWtlLiBXZSBib3Jyb3cKKwkgKiB1bmNvcmUgbG9jayB0byBwcmV2
ZW50IGNvbmN1cnJlbnQgYWNjZXNzIHRvIHJhbmdlIHJlZy4KKwkgKi8KKwlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZ1bmNvcmUtPmxvY2spOworCisJLyoKKwkgKiB2bHYgYW5kIGNodiByZXNpZGVuY3kg
Y291bnRlcnMgYXJlIDQwIGJpdHMgaW4gd2lkdGguCisJICogV2l0aCBhIGNvbnRyb2wgYml0LCB3
ZSBjYW4gY2hvb3NlIGJldHdlZW4gdXBwZXIgb3IgbG93ZXIKKwkgKiAzMmJpdCB3aW5kb3cgaW50
byB0aGlzIGNvdW50ZXIuCisJICoKKwkgKiBBbHRob3VnaCB3ZSBhbHdheXMgdXNlIHRoZSBjb3Vu
dGVyIGluIGhpZ2gtcmFuZ2UgbW9kZSBlbHNld2hlcmUsCisJICogdXNlcnNwYWNlIG1heSBhdHRl
bXB0IHRvIHJlYWQgdGhlIHZhbHVlIGJlZm9yZSByYzYgaXMgaW5pdGlhbGlzZWQsCisJICogYmVm
b3JlIHdlIGhhdmUgc2V0IHRoZSBkZWZhdWx0IFZMVl9DT1VOVEVSX0NPTlRST0wgdmFsdWUuIFNv
IGFsd2F5cworCSAqIHNldCB0aGUgaGlnaCBiaXQgdG8gYmUgc2FmZS4KKwkgKi8KKwlpbnRlbF91
bmNvcmVfd3JpdGVfZncodW5jb3JlLCBWTFZfQ09VTlRFUl9DT05UUk9MLAorCQkJICAgICAgX01B
U0tFRF9CSVRfRU5BQkxFKFZMVl9DT1VOVF9SQU5HRV9ISUdIKSk7CisJdXBwZXIgPSBpbnRlbF91
bmNvcmVfcmVhZF9mdyh1bmNvcmUsIHJlZyk7CisJZG8geworCQl0bXAgPSB1cHBlcjsKKworCQlp
bnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBWTFZfQ09VTlRFUl9DT05UUk9MLAorCQkJCSAg
ICAgIF9NQVNLRURfQklUX0RJU0FCTEUoVkxWX0NPVU5UX1JBTkdFX0hJR0gpKTsKKwkJbG93ZXIg
PSBpbnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIHJlZyk7CisKKwkJaW50ZWxfdW5jb3JlX3dy
aXRlX2Z3KHVuY29yZSwgVkxWX0NPVU5URVJfQ09OVFJPTCwKKwkJCQkgICAgICBfTUFTS0VEX0JJ
VF9FTkFCTEUoVkxWX0NPVU5UX1JBTkdFX0hJR0gpKTsKKwkJdXBwZXIgPSBpbnRlbF91bmNvcmVf
cmVhZF9mdyh1bmNvcmUsIHJlZyk7CisJfSB3aGlsZSAodXBwZXIgIT0gdG1wICYmIC0tbG9vcCk7
CisKKwkvKgorCSAqIEV2ZXJ5d2hlcmUgZWxzZSB3ZSBhbHdheXMgdXNlIFZMVl9DT1VOVEVSX0NP
TlRST0wgd2l0aCB0aGUKKwkgKiBWTFZfQ09VTlRfUkFOR0VfSElHSCBiaXQgc2V0IC0gc28gaXQg
aXMgc2FmZSB0byBsZWF2ZSBpdCBzZXQKKwkgKiBub3cuCisJICovCisKKwlyZXR1cm4gbG93ZXIg
fCAodTY0KXVwcGVyIDw8IDg7Cit9CisKK3U2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKHN0cnVj
dCBpbnRlbF9yYzYgKnJjNiwgY29uc3QgaTkxNV9yZWdfdCByZWcpCit7CisJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSByYzZfdG9faTkxNShyYzYpOworCXN0cnVjdCBpbnRlbF91bmNv
cmUgKnVuY29yZSA9IHJjNl90b191bmNvcmUocmM2KTsKKwl1NjQgdGltZV9odywgcHJldl9odywg
b3ZlcmZsb3dfaHc7CisJdW5zaWduZWQgaW50IGZ3X2RvbWFpbnM7CisJdW5zaWduZWQgbG9uZyBm
bGFnczsKKwl1bnNpZ25lZCBpbnQgaTsKKwl1MzIgbXVsLCBkaXY7CisKKwlpZiAoIXJjNi0+ZW5h
YmxlZCkKKwkJcmV0dXJuIDA7CisKKwkvKgorCSAqIFN0b3JlIHByZXZpb3VzIGh3IGNvdW50ZXIg
dmFsdWVzIGZvciBjb3VudGVyIHdyYXAtYXJvdW5kIGhhbmRsaW5nLgorCSAqCisJICogVGhlcmUg
YXJlIG9ubHkgZm91ciBpbnRlcmVzdGluZyByZWdpc3RlcnMgYW5kIHRoZXkgbGl2ZSBuZXh0IHRv
IGVhY2gKKwkgKiBvdGhlciBzbyB3ZSBjYW4gdXNlIHRoZSByZWxhdGl2ZSBhZGRyZXNzLCBjb21w
YXJlZCB0byB0aGUgc21hbGxlc3QKKwkgKiBvbmUgYXMgdGhlIGluZGV4IGludG8gZHJpdmVyIHN0
b3JhZ2UuCisJICovCisJaSA9IChpOTE1X21taW9fcmVnX29mZnNldChyZWcpIC0KKwkgICAgIGk5
MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjZfR1RfR0ZYX1JDNl9MT0NLRUQpKSAvIHNpemVvZih1MzIp
OworCWlmIChXQVJOX09OX09OQ0UoaSA+PSBBUlJBWV9TSVpFKHJjNi0+Y3VyX3Jlc2lkZW5jeSkp
KQorCQlyZXR1cm4gMDsKKworCWZ3X2RvbWFpbnMgPSBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2Zv
cl9yZWcodW5jb3JlLCByZWcsIEZXX1JFR19SRUFEKTsKKworCXNwaW5fbG9ja19pcnFzYXZlKCZ1
bmNvcmUtPmxvY2ssIGZsYWdzKTsKKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldF9fbG9ja2Vk
KHVuY29yZSwgZndfZG9tYWlucyk7CisKKwkvKiBPbiBWTFYgYW5kIENIViwgcmVzaWRlbmN5IHRp
bWUgaXMgaW4gQ1ogdW5pdHMgcmF0aGVyIHRoYW4gMS4yOHVzICovCisJaWYgKElTX1ZBTExFWVZJ
RVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkgeworCQltdWwgPSAxMDAwMDAwOworCQlk
aXYgPSBpOTE1LT5jemNsa19mcmVxOworCQlvdmVyZmxvd19odyA9IEJJVF9VTEwoNDApOworCQl0
aW1lX2h3ID0gdmx2X3Jlc2lkZW5jeV9yYXcodW5jb3JlLCByZWcpOworCX0gZWxzZSB7CisJCS8q
IDgzMy4zM25zIHVuaXRzIG9uIEdlbjlMUCwgMS4yOHVzIGVsc2V3aGVyZS4gKi8KKwkJaWYgKElT
X0dFTjlfTFAoaTkxNSkpIHsKKwkJCW11bCA9IDEwMDAwOworCQkJZGl2ID0gMTI7CisJCX0gZWxz
ZSB7CisJCQltdWwgPSAxMjgwOworCQkJZGl2ID0gMTsKKwkJfQorCisJCW92ZXJmbG93X2h3ID0g
QklUX1VMTCgzMik7CisJCXRpbWVfaHcgPSBpbnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIHJl
Zyk7CisJfQorCisJLyoKKwkgKiBDb3VudGVyIHdyYXAgaGFuZGxpbmcuCisJICoKKwkgKiBCdXQg
cmVseWluZyBvbiBhIHN1ZmZpY2llbnQgZnJlcXVlbmN5IG9mIHF1ZXJpZXMgb3RoZXJ3aXNlIGNv
dW50ZXJzCisJICogY2FuIHN0aWxsIHdyYXAuCisJICovCisJcHJldl9odyA9IHJjNi0+cHJldl9o
d19yZXNpZGVuY3lbaV07CisJcmM2LT5wcmV2X2h3X3Jlc2lkZW5jeVtpXSA9IHRpbWVfaHc7CisK
KwkvKiBSQzYgZGVsdGEgZnJvbSBsYXN0IHNhbXBsZS4gKi8KKwlpZiAodGltZV9odyA+PSBwcmV2
X2h3KQorCQl0aW1lX2h3IC09IHByZXZfaHc7CisJZWxzZQorCQl0aW1lX2h3ICs9IG92ZXJmbG93
X2h3IC0gcHJldl9odzsKKworCS8qIEFkZCBkZWx0YSB0byBSQzYgZXh0ZW5kZWQgcmF3IGRyaXZl
ciBjb3B5LiAqLworCXRpbWVfaHcgKz0gcmM2LT5jdXJfcmVzaWRlbmN5W2ldOworCXJjNi0+Y3Vy
X3Jlc2lkZW5jeVtpXSA9IHRpbWVfaHc7CisKKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dF9f
bG9ja2VkKHVuY29yZSwgZndfZG9tYWlucyk7CisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdW5j
b3JlLT5sb2NrLCBmbGFncyk7CisKKwlyZXR1cm4gbXVsX3U2NF91MzJfZGl2KHRpbWVfaHcsIG11
bCwgZGl2KTsKK30KKwordTY0IGludGVsX3JjNl9yZXNpZGVuY3lfdXMoc3RydWN0IGludGVsX3Jj
NiAqcmM2LCBpOTE1X3JlZ190IHJlZykKK3sKKwlyZXR1cm4gRElWX1JPVU5EX1VQX1VMTChpbnRl
bF9yYzZfcmVzaWRlbmN5X25zKHJjNiwgcmVnKSwgMTAwMCk7Cit9CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yYzYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3JjNi5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uY2Fh
N2UxMGU5MDY3Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfcmM2LmgKQEAgLTAsMCArMSwyNCBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBNSVQKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisK
KyNpZm5kZWYgSU5URUxfUkM2X0gKKyNkZWZpbmUgSU5URUxfUkM2X0gKKworI2luY2x1ZGUgImk5
MTVfcmVnLmgiCisKK3N0cnVjdCBpbnRlbF9lbmdpbmVfY3M7CitzdHJ1Y3QgaW50ZWxfcmM2Owor
Cit2b2lkIGludGVsX3JjNl9pbml0KHN0cnVjdCBpbnRlbF9yYzYgKnJjNik7Cit2b2lkIGludGVs
X3JjNl9maW5pKHN0cnVjdCBpbnRlbF9yYzYgKnJjNik7CisKK3ZvaWQgaW50ZWxfcmM2X2VuYWJs
ZShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpOwordm9pZCBpbnRlbF9yYzZfZGlzYWJsZShzdHJ1Y3Qg
aW50ZWxfcmM2ICpyYzYpOworCit1NjQgaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhzdHJ1Y3QgaW50
ZWxfcmM2ICpyYzYsIGk5MTVfcmVnX3QgcmVnKTsKK3U2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X3Vz
KHN0cnVjdCBpbnRlbF9yYzYgKnJjNiwgaTkxNV9yZWdfdCByZWcpOworCisjZW5kaWYgLyogSU5U
RUxfUkM2X0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jj
Nl90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2X3R5cGVzLmgKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4zNWU3ZTE1YzZhZmYKLS0tIC9k
ZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yYzZfdHlwZXMuaApA
QCAtMCwwICsxLDI2IEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoK
KyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2lmbmRlZiBJ
TlRFTF9SQzZfVFlQRVNfSAorI2RlZmluZSBJTlRFTF9SQzZfVFlQRVNfSAorCisjaW5jbHVkZSA8
bGludXgvc3BpbmxvY2suaD4KKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorCisjaW5jbHVkZSAi
aW50ZWxfZW5naW5lX3R5cGVzLmgiCisKK3N0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0OworCitz
dHJ1Y3QgaW50ZWxfcmM2IHsKKwlib29sIGVuYWJsZWQ7CisKKwl1NjQgcHJldl9od19yZXNpZGVu
Y3lbNF07CisJdTY0IGN1cl9yZXNpZGVuY3lbNF07CisKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqcGN0eDsKK307CisKKyNlbmRpZiAvKiBJTlRFTF9SQzZfVFlQRVNfSCAqLwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCmluZGV4IGEwOTI0ZjIwN2QyYy4u
M2FlY2Q0YThhMjU2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
aW5nYnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZl
ci5jCkBAIC0zNyw2ICszNyw4IEBACiAjaW5jbHVkZSAiaTkxNV90cmFjZS5oIgogI2luY2x1ZGUg
ImludGVsX2NvbnRleHQuaCIKICNpbmNsdWRlICJpbnRlbF9ndC5oIgorI2luY2x1ZGUgImludGVs
X2d0X2lycS5oIgorI2luY2x1ZGUgImludGVsX2d0X3BtX2lycS5oIgogI2luY2x1ZGUgImludGVs
X3JlbmRlcnN0YXRlLmgiCiAjaW5jbHVkZSAiaW50ZWxfcmVzZXQuaCIKICNpbmNsdWRlICJpbnRl
bF93b3JrYXJvdW5kcy5oIgpAQCAtOTYyLDEzICs5NjQsMTMgQEAgc3RhdGljIHUzMiAqZ2VuNV9l
bWl0X2JyZWFkY3J1bWIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIHUzMiAqY3MpCiBzdGF0aWMg
dm9pZAogZ2VuNV9pcnFfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsK
LQlnZW41X2VuYWJsZV9ndF9pcnEoZW5naW5lLT5pOTE1LCBlbmdpbmUtPmlycV9lbmFibGVfbWFz
ayk7CisJZ2VuNV9ndF9lbmFibGVfaXJxKGVuZ2luZS0+Z3QsIGVuZ2luZS0+aXJxX2VuYWJsZV9t
YXNrKTsKIH0KIAogc3RhdGljIHZvaWQKIGdlbjVfaXJxX2Rpc2FibGUoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogewotCWdlbjVfZGlzYWJsZV9ndF9pcnEoZW5naW5lLT5pOTE1LCBl
bmdpbmUtPmlycV9lbmFibGVfbWFzayk7CisJZ2VuNV9ndF9kaXNhYmxlX2lycShlbmdpbmUtPmd0
LCBlbmdpbmUtPmlycV9lbmFibGVfbWFzayk7CiB9CiAKIHN0YXRpYyB2b2lkCkBAIC0xMDI5LDE0
ICsxMDMxLDE0IEBAIGdlbjZfaXJxX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCiAJLyogRmx1c2gvZGVsYXkgdG8gZW5zdXJlIHRoZSBSSU5HX0lNUiBpcyBhY3RpdmUgYmVm
b3JlIHRoZSBHVCBJTVIgKi8KIAlFTkdJTkVfUE9TVElOR19SRUFEKGVuZ2luZSwgUklOR19JTVIp
OwogCi0JZ2VuNV9lbmFibGVfZ3RfaXJxKGVuZ2luZS0+aTkxNSwgZW5naW5lLT5pcnFfZW5hYmxl
X21hc2spOworCWdlbjVfZ3RfZW5hYmxlX2lycShlbmdpbmUtPmd0LCBlbmdpbmUtPmlycV9lbmFi
bGVfbWFzayk7CiB9CiAKIHN0YXRpYyB2b2lkCiBnZW42X2lycV9kaXNhYmxlKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlFTkdJTkVfV1JJVEUoZW5naW5lLCBSSU5HX0lNUiwg
fmVuZ2luZS0+aXJxX2tlZXBfbWFzayk7Ci0JZ2VuNV9kaXNhYmxlX2d0X2lycShlbmdpbmUtPmk5
MTUsIGVuZ2luZS0+aXJxX2VuYWJsZV9tYXNrKTsKKwlnZW41X2d0X2Rpc2FibGVfaXJxKGVuZ2lu
ZS0+Z3QsIGVuZ2luZS0+aXJxX2VuYWJsZV9tYXNrKTsKIH0KIAogc3RhdGljIHZvaWQKQEAgLTEw
NDcsMTQgKzEwNDksMTQgQEAgaHN3X3ZlYm94X2lycV9lbmFibGUoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQogCS8qIEZsdXNoL2RlbGF5IHRvIGVuc3VyZSB0aGUgUklOR19JTVIgaXMg
YWN0aXZlIGJlZm9yZSB0aGUgR1QgSU1SICovCiAJRU5HSU5FX1BPU1RJTkdfUkVBRChlbmdpbmUs
IFJJTkdfSU1SKTsKIAotCWdlbjZfdW5tYXNrX3BtX2lycShlbmdpbmUtPmd0LCBlbmdpbmUtPmly
cV9lbmFibGVfbWFzayk7CisJZ2VuNl9ndF9wbV91bm1hc2tfaXJxKGVuZ2luZS0+Z3QsIGVuZ2lu
ZS0+aXJxX2VuYWJsZV9tYXNrKTsKIH0KIAogc3RhdGljIHZvaWQKIGhzd192ZWJveF9pcnFfZGlz
YWJsZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJRU5HSU5FX1dSSVRFKGVu
Z2luZSwgUklOR19JTVIsIH4wKTsKLQlnZW42X21hc2tfcG1faXJxKGVuZ2luZS0+Z3QsIGVuZ2lu
ZS0+aXJxX2VuYWJsZV9tYXNrKTsKKwlnZW42X2d0X3BtX21hc2tfaXJxKGVuZ2luZS0+Z3QsIGVu
Z2luZS0+aXJxX2VuYWJsZV9tYXNrKTsKIH0KIAogc3RhdGljIGludApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcnBzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9ycHMuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmY1
OTg0Y2VlNzQ1MQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3Jwcy5jCkBAIC0wLDAgKzEsMTg3MCBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBNSVQKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICov
CisKKyNpbmNsdWRlICJpOTE1X2Rydi5oIgorI2luY2x1ZGUgImludGVsX2d0LmgiCisjaW5jbHVk
ZSAiaW50ZWxfZ3RfaXJxLmgiCisjaW5jbHVkZSAiaW50ZWxfZ3RfcG1faXJxLmgiCisjaW5jbHVk
ZSAiaW50ZWxfcnBzLmgiCisjaW5jbHVkZSAiaW50ZWxfc2lkZWJhbmQuaCIKKyNpbmNsdWRlICIu
Li8uLi8uLi9wbGF0Zm9ybS94ODYvaW50ZWxfaXBzLmgiCisKKy8qCisgKiBMb2NrIHByb3RlY3Rp
bmcgSVBTIHJlbGF0ZWQgZGF0YSBzdHJ1Y3R1cmVzCisgKi8KK3N0YXRpYyBERUZJTkVfU1BJTkxP
Q0sobWNoZGV2X2xvY2spOworCitzdGF0aWMgc3RydWN0IGludGVsX2d0ICpycHNfdG9fZ3Qoc3Ry
dWN0IGludGVsX3JwcyAqcnBzKQoreworCXJldHVybiBjb250YWluZXJfb2YocnBzLCBzdHJ1Y3Qg
aW50ZWxfZ3QsIHJwcyk7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqcnBz
X3RvX2k5MTUoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXJldHVybiBycHNfdG9fZ3QocnBz
KS0+aTkxNTsKK30KKworc3RhdGljIHN0cnVjdCBpbnRlbF91bmNvcmUgKnJwc190b191bmNvcmUo
c3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXJldHVybiBycHNfdG9fZ3QocnBzKS0+dW5jb3Jl
OworfQorCitzdGF0aWMgdTMyIHJwc19wbV9zYW5pdGl6ZV9tYXNrKHN0cnVjdCBpbnRlbF9ycHMg
KnJwcywgdTMyIG1hc2spCit7CisJcmV0dXJuIG1hc2sgJiB+cnBzLT5wbV9pbnRybXNrX21iejsK
K30KKworc3RhdGljIHUzMiBycHNfcG1fbWFzayhzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIHU4IHZh
bCkKK3sKKwl1MzIgbWFzayA9IDA7CisKKwkvKiBXZSB1c2UgVVBfRUlfRVhQSVJFRCBpbnRlcnJ1
cHRzIGZvciBib3RoIHVwL2Rvd24gaW4gbWFudWFsIG1vZGUgKi8KKwlpZiAodmFsID4gcnBzLT5t
aW5fZnJlcV9zb2Z0bGltaXQpCisJCW1hc2sgfD0gR0VONl9QTV9SUF9VUF9FSV9FWFBJUkVEIHwg
R0VONl9QTV9SUF9ET1dOX1RIUkVTSE9MRCB8IEdFTjZfUE1fUlBfRE9XTl9USU1FT1VUOworCWlm
ICh2YWwgPCBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCkKKwkJbWFzayB8PSBHRU42X1BNX1JQX1VQ
X0VJX0VYUElSRUQgfCBHRU42X1BNX1JQX1VQX1RIUkVTSE9MRDsKKworCW1hc2sgJj0gcnBzLT5w
bV9ldmVudHM7CisKKwlyZXR1cm4gcnBzX3BtX3Nhbml0aXplX21hc2socnBzLCB+bWFzayk7Cit9
CisKK3N0YXRpYyB2b2lkIHJwc19yZXNldF9laShzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJ
bWVtc2V0KCZycHMtPmVpLCAwLCBzaXplb2YocnBzLT5laSkpOworfQorCitzdGF0aWMgdm9pZCBy
cHNfZW5hYmxlX2ludGVycnVwdHMoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBp
bnRlbF9ndCAqZ3QgPSBycHNfdG9fZ3QocnBzKTsKKworCXJwc19yZXNldF9laShycHMpOworCisJ
aWYgKElTX1ZBTExFWVZJRVcoZ3QtPmk5MTUpKQorCQkvKiBXYUdzdlJDMFJlc2lkZW5jeU1ldGhv
ZDp2bHYgKi8KKwkJcnBzLT5wbV9ldmVudHMgPSBHRU42X1BNX1JQX1VQX0VJX0VYUElSRUQ7CisJ
ZWxzZQorCQlycHMtPnBtX2V2ZW50cyA9IChHRU42X1BNX1JQX1VQX1RIUkVTSE9MRCB8CisJCQkJ
ICBHRU42X1BNX1JQX0RPV05fVEhSRVNIT0xEIHwKKwkJCQkgIEdFTjZfUE1fUlBfRE9XTl9USU1F
T1VUKTsKKworCXNwaW5fbG9ja19pcnEoJmd0LT5pcnFfbG9jayk7CisJZ2VuNl9ndF9wbV9lbmFi
bGVfaXJxKGd0LCBycHMtPnBtX2V2ZW50cyk7CisJc3Bpbl91bmxvY2tfaXJxKCZndC0+aXJxX2xv
Y2spOworCisJaW50ZWxfdW5jb3JlX3dyaXRlKGd0LT51bmNvcmUsIEdFTjZfUE1JTlRSTVNLLAor
CQkJICAgcnBzX3BtX21hc2socnBzLCBycHMtPmN1cl9mcmVxKSk7Cit9CisKK3N0YXRpYyB2b2lk
IGdlbjZfcnBzX3Jlc2V0X2ludGVycnVwdHMoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCWdl
bjZfZ3RfcG1fcmVzZXRfaWlyKHJwc190b19ndChycHMpLCBHRU42X1BNX1JQU19FVkVOVFMpOwor
fQorCitzdGF0aWMgdm9pZCBnZW4xMV9ycHNfcmVzZXRfaW50ZXJydXB0cyhzdHJ1Y3QgaW50ZWxf
cnBzICpycHMpCit7CisJd2hpbGUgKGdlbjExX2d0X3Jlc2V0X29uZV9paXIocnBzX3RvX2d0KHJw
cyksIDAsIEdFTjExX0dUUE0pKQorCQk7Cit9CisKK3N0YXRpYyB2b2lkIHJwc19yZXNldF9pbnRl
cnJ1cHRzKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0g
cnBzX3RvX2d0KHJwcyk7CisKKwlzcGluX2xvY2tfaXJxKCZndC0+aXJxX2xvY2spOworCWlmIChJ
TlRFTF9HRU4oZ3QtPmk5MTUpID49IDExKQorCQlnZW4xMV9ycHNfcmVzZXRfaW50ZXJydXB0cyhy
cHMpOworCWVsc2UKKwkJZ2VuNl9ycHNfcmVzZXRfaW50ZXJydXB0cyhycHMpOworCisJcnBzLT5w
bV9paXIgPSAwOworCXNwaW5fdW5sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKK30KKworc3RhdGlj
IHZvaWQgcnBzX2Rpc2FibGVfaW50ZXJydXB0cyhzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJ
c3RydWN0IGludGVsX2d0ICpndCA9IHJwc190b19ndChycHMpOworCisJcnBzLT5wbV9ldmVudHMg
PSAwOworCisJaW50ZWxfdW5jb3JlX3dyaXRlKGd0LT51bmNvcmUsIEdFTjZfUE1JTlRSTVNLLAor
CQkJICAgcnBzX3BtX3Nhbml0aXplX21hc2socnBzLCB+MHUpKTsKKworCXNwaW5fbG9ja19pcnEo
Jmd0LT5pcnFfbG9jayk7CisJZ2VuNl9ndF9wbV9kaXNhYmxlX2lycShndCwgR0VONl9QTV9SUFNf
RVZFTlRTKTsKKwlzcGluX3VubG9ja19pcnEoJmd0LT5pcnFfbG9jayk7CisKKwlpbnRlbF9zeW5j
aHJvbml6ZV9pcnEoZ3QtPmk5MTUpOworCisJLyoKKwkgKiBOb3cgdGhhdCB3ZSB3aWxsIG5vdCBi
ZSBnZW5lcmF0aW5nIGFueSBtb3JlIHdvcmssIGZsdXNoIGFueQorCSAqIG91dHN0YW5kaW5nIHRh
c2tzLiBBcyB3ZSBhcmUgY2FsbGVkIG9uIHRoZSBSUFMgaWRsZSBwYXRoLAorCSAqIHdlIHdpbGwg
cmVzZXQgdGhlIEdQVSB0byBtaW5pbXVtIGZyZXF1ZW5jaWVzLCBzbyB0aGUgY3VycmVudAorCSAq
IHN0YXRlIG9mIHRoZSB3b3JrZXIgY2FuIGJlIGRpc2NhcmRlZC4KKwkgKi8KKwljYW5jZWxfd29y
a19zeW5jKCZycHMtPndvcmspOworCisJcnBzX3Jlc2V0X2ludGVycnVwdHMocnBzKTsKK30KKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBjcGFyYW1zIHsKKwl1MTYgaTsKKwl1MTYgdDsKKwl1MTYgbTsK
Kwl1MTYgYzsKK30gY3BhcmFtc1tdID0geworCXsgMSwgMTMzMywgMzAxLCAyODY2NCB9LAorCXsg
MSwgMTA2NiwgMjk0LCAyNDQ2MCB9LAorCXsgMSwgODAwLCAyOTQsIDI1MTkyIH0sCisJeyAwLCAx
MzMzLCAyNzYsIDI3NjA1IH0sCisJeyAwLCAxMDY2LCAyNzYsIDI3NjA1IH0sCisJeyAwLCA4MDAs
IDIzMSwgMjM3ODQgfSwKK307CisKK3N0YXRpYyB2b2lkIGdlbjVfcnBzX2luaXQoc3RydWN0IGlu
dGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcnBzX3Rv
X2k5MTUocnBzKTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBycHNfdG9fdW5jb3Jl
KHJwcyk7CisJdTggZm1heCwgZm1pbiwgZnN0YXJ0OworCXUzMiByZ3Ztb2RlY3RsOworCWludCBj
X20sIGk7CisKKwlpZiAoaTkxNS0+ZnNiX2ZyZXEgPD0gMzIwMCkKKwkJY19tID0gMDsKKwllbHNl
IGlmIChpOTE1LT5mc2JfZnJlcSA8PSA0ODAwKQorCQljX20gPSAxOworCWVsc2UKKwkJY19tID0g
MjsKKworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNwYXJhbXMpOyBpKyspIHsKKwkJaWYg
KGNwYXJhbXNbaV0uaSA9PSBjX20gJiYgY3BhcmFtc1tpXS50ID09IGk5MTUtPm1lbV9mcmVxKSB7
CisJCQlycHMtPmlwcy5tID0gY3BhcmFtc1tpXS5tOworCQkJcnBzLT5pcHMuYyA9IGNwYXJhbXNb
aV0uYzsKKwkJCWJyZWFrOworCQl9CisJfQorCisJcmd2bW9kZWN0bCA9IGludGVsX3VuY29yZV9y
ZWFkKHVuY29yZSwgTUVNTU9ERUNUTCk7CisKKwkvKiBTZXQgdXAgbWluLCBtYXgsIGFuZCBjdXIg
Zm9yIGludGVycnVwdCBoYW5kbGluZyAqLworCWZtYXggPSAocmd2bW9kZWN0bCAmIE1FTU1PREVf
Rk1BWF9NQVNLKSA+PiBNRU1NT0RFX0ZNQVhfU0hJRlQ7CisJZm1pbiA9IChyZ3Ztb2RlY3RsICYg
TUVNTU9ERV9GTUlOX01BU0spOworCWZzdGFydCA9IChyZ3Ztb2RlY3RsICYgTUVNTU9ERV9GU1RB
UlRfTUFTSykgPj4KKwkJTUVNTU9ERV9GU1RBUlRfU0hJRlQ7CisJRFJNX0RFQlVHX0RSSVZFUigi
Zm1heDogJWQsIGZtaW46ICVkLCBmc3RhcnQ6ICVkXG4iLAorCQkJIGZtYXgsIGZtaW4sIGZzdGFy
dCk7CisKKwlycHMtPm1pbl9mcmVxID0gLWZzdGFydDsKKwlycHMtPm1heF9mcmVxID0gLWZtaW47
CisKKwlycHMtPmlkbGVfZnJlcSA9IHJwcy0+bWluX2ZyZXE7CisJcnBzLT5jdXJfZnJlcSA9IHJw
cy0+aWRsZV9mcmVxOworfQorCitzdGF0aWMgdW5zaWduZWQgbG9uZworX19pcHNfY2hpcHNldF92
YWwoc3RydWN0IGludGVsX2lwcyAqaXBzKQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29y
ZSA9CisJCXJwc190b191bmNvcmUoY29udGFpbmVyX29mKGlwcywgc3RydWN0IGludGVsX3Jwcywg
aXBzKSk7CisJdW5zaWduZWQgbG9uZyBub3cgPSBqaWZmaWVzX3RvX21zZWNzKGppZmZpZXMpLCBk
dDsKKwl1bnNpZ25lZCBsb25nIHJlc3VsdDsKKwl1NjQgdG90YWwsIGRlbHRhOworCisJbG9ja2Rl
cF9hc3NlcnRfaGVsZCgmbWNoZGV2X2xvY2spOworCisJLyoKKwkgKiBQcmV2ZW50IGRpdmlzaW9u
LWJ5LXplcm8gaWYgd2UgYXJlIGFza2luZyB0b28gZmFzdC4KKwkgKiBBbHNvLCB3ZSBkb24ndCBn
ZXQgaW50ZXJlc3RpbmcgcmVzdWx0cyBpZiB3ZSBhcmUgcG9sbGluZworCSAqIGZhc3RlciB0aGFu
IG9uY2UgaW4gMTBtcywgc28ganVzdCByZXR1cm4gdGhlIHNhdmVkIHZhbHVlCisJICogaW4gc3Vj
aCBjYXNlcy4KKwkgKi8KKwlkdCA9IG5vdyAtIGlwcy0+bGFzdF90aW1lMTsKKwlpZiAoZHQgPD0g
MTApCisJCXJldHVybiBpcHMtPmNoaXBzZXRfcG93ZXI7CisKKwkvKiBGSVhNRTogaGFuZGxlIHBl
ci1jb3VudGVyIG92ZXJmbG93ICovCisJdG90YWwgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IERNSUVDKTsKKwl0b3RhbCArPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEREUkVDKTsKKwl0
b3RhbCArPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIENTSUVDKTsKKworCWRlbHRhID0gdG90
YWwgLSBpcHMtPmxhc3RfY291bnQxOworCisJcmVzdWx0ID0gZGl2X3U2NChkaXZfdTY0KGlwcy0+
bSAqIGRlbHRhLCBkdCkgKyBpcHMtPmMsIDEwKTsKKworCWlwcy0+bGFzdF9jb3VudDEgPSB0b3Rh
bDsKKwlpcHMtPmxhc3RfdGltZTEgPSBub3c7CisKKwlpcHMtPmNoaXBzZXRfcG93ZXIgPSByZXN1
bHQ7CisKKwlyZXR1cm4gcmVzdWx0OworfQorCitzdGF0aWMgdW5zaWduZWQgbG9uZyBpcHNfbWNo
X3ZhbChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpCit7CisJdW5zaWduZWQgaW50IG0sIHgs
IGI7CisJdTMyIHRzZnM7CisKKwl0c2ZzID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBUU0ZT
KTsKKwl4ID0gaW50ZWxfdW5jb3JlX3JlYWQ4KHVuY29yZSwgVFIxKTsKKworCWIgPSB0c2ZzICYg
VFNGU19JTlRSX01BU0s7CisJbSA9ICh0c2ZzICYgVFNGU19TTE9QRV9NQVNLKSA+PiBUU0ZTX1NM
T1BFX1NISUZUOworCisJcmV0dXJuIG0gKiB4IC8gMTI3IC0gYjsKK30KKworc3RhdGljIGludCBf
cHh2aWRfdG9fdmQodTggcHh2aWQpCit7CisJaWYgKHB4dmlkID09IDApCisJCXJldHVybiAwOwor
CisJaWYgKHB4dmlkID49IDggJiYgcHh2aWQgPCAzMSkKKwkJcHh2aWQgPSAzMTsKKworCXJldHVy
biAocHh2aWQgKyAyKSAqIDEyNTsKK30KKworc3RhdGljIHUzMiBwdmlkX3RvX2V4dHZpZChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTggcHh2aWQpCit7CisJY29uc3QgaW50IHZkID0g
X3B4dmlkX3RvX3ZkKHB4dmlkKTsKKworCWlmIChJTlRFTF9JTkZPKGk5MTUpLT5pc19tb2JpbGUp
CisJCXJldHVybiBtYXgodmQgLSAxMTI1LCAwKTsKKworCXJldHVybiB2ZDsKK30KKworc3RhdGlj
IHZvaWQgX19nZW41X2lwc191cGRhdGUoc3RydWN0IGludGVsX2lwcyAqaXBzKQoreworCXN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSA9CisJCXJwc190b191bmNvcmUoY29udGFpbmVyX29mKGlw
cywgc3RydWN0IGludGVsX3JwcywgaXBzKSk7CisJdTY0IG5vdywgZGVsdGEsIGR0OworCXUzMiBj
b3VudDsKKworCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJm1jaGRldl9sb2NrKTsKKworCW5vdyA9IGt0
aW1lX2dldF9yYXdfbnMoKTsKKwlkdCA9IG5vdyAtIGlwcy0+bGFzdF90aW1lMjsKKwlkb19kaXYo
ZHQsIE5TRUNfUEVSX01TRUMpOworCisJLyogRG9uJ3QgZGl2aWRlIGJ5IDAgKi8KKwlpZiAoZHQg
PD0gMTApCisJCXJldHVybjsKKworCWNvdW50ID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBH
RlhFQyk7CisJZGVsdGEgPSBjb3VudCAtIGlwcy0+bGFzdF9jb3VudDI7CisKKwlpcHMtPmxhc3Rf
Y291bnQyID0gY291bnQ7CisJaXBzLT5sYXN0X3RpbWUyID0gbm93OworCisJLyogTW9yZSBtYWdp
YyBjb25zdGFudHMuLi4gKi8KKwlpcHMtPmdmeF9wb3dlciA9IGRpdl91NjQoZGVsdGEgKiAxMTgx
LCBkdCAqIDEwKTsKK30KKworc3RhdGljIHZvaWQgZ2VuNV9ycHNfdXBkYXRlKHN0cnVjdCBpbnRl
bF9ycHMgKnJwcykKK3sKKwlzcGluX2xvY2tfaXJxKCZtY2hkZXZfbG9jayk7CisJX19nZW41X2lw
c191cGRhdGUoJnJwcy0+aXBzKTsKKwlzcGluX3VubG9ja19pcnEoJm1jaGRldl9sb2NrKTsKK30K
Kworc3RhdGljIGJvb2wgZ2VuNV9ycHNfc2V0KHN0cnVjdCBpbnRlbF9ycHMgKnJwcywgdTggdmFs
KQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJwc190b191bmNvcmUocnBzKTsK
Kwl1MTYgcmd2c3djdGw7CisKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZtY2hkZXZfbG9jayk7CisK
KwlyZ3Zzd2N0bCA9IGludGVsX3VuY29yZV9yZWFkMTYodW5jb3JlLCBNRU1TV0NUTCk7CisJaWYg
KHJndnN3Y3RsICYgTUVNQ1RMX0NNRF9TVFMpIHsKKwkJRFJNX0RFQlVHKCJncHUgYnVzeSwgUkNT
IGNoYW5nZSByZWplY3RlZFxuIik7CisJCXJldHVybiBmYWxzZTsgLyogc3RpbGwgYnVzeSB3aXRo
IGFub3RoZXIgY29tbWFuZCAqLworCX0KKworCXZhbCA9IC12YWw7CisKKwlyZ3Zzd2N0bCA9CisJ
CShNRU1DVExfQ01EX0NIRlJFUSA8PCBNRU1DVExfQ01EX1NISUZUKSB8CisJCSh2YWwgPDwgTUVN
Q1RMX0ZSRVFfU0hJRlQpIHwKKwkJTUVNQ1RMX1NGQ0FWTTsKKwlpbnRlbF91bmNvcmVfd3JpdGUx
Nih1bmNvcmUsIE1FTVNXQ1RMLCByZ3Zzd2N0bCk7CisJaW50ZWxfdW5jb3JlX3Bvc3RpbmdfcmVh
ZDE2KHVuY29yZSwgTUVNU1dDVEwpOworCisJcmd2c3djdGwgfD0gTUVNQ1RMX0NNRF9TVFM7CisJ
aW50ZWxfdW5jb3JlX3dyaXRlMTYodW5jb3JlLCBNRU1TV0NUTCwgcmd2c3djdGwpOworCisJcmV0
dXJuIHRydWU7Cit9CisKK3N0YXRpYyB1bnNpZ25lZCBsb25nIGludGVsX3B4ZnJlcSh1MzIgdmlk
ZnJlcSkKK3sKKwlpbnQgZGl2ID0gKHZpZGZyZXEgJiAweDNmMDAwMCkgPj4gMTY7CisJaW50IHBv
c3QgPSAodmlkZnJlcSAmIDB4MzAwMCkgPj4gMTI7CisJaW50IHByZSA9ICh2aWRmcmVxICYgMHg3
KTsKKworCWlmICghcHJlKQorCQlyZXR1cm4gMDsKKworCXJldHVybiBkaXYgKiAxMzMzMzMgLyAo
cHJlIDw8IHBvc3QpOworfQorCitzdGF0aWMgdW5zaWduZWQgaW50IGluaXRfZW1vbihzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmUpCit7CisJdTggcHh3WzE2XTsKKwlpbnQgaTsKKworCS8qIERp
c2FibGUgdG8gcHJvZ3JhbSAqLworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEVDUiwgMCk7
CisJaW50ZWxfdW5jb3JlX3Bvc3RpbmdfcmVhZCh1bmNvcmUsIEVDUik7CisKKwkvKiBQcm9ncmFt
IGVuZXJneSB3ZWlnaHRzIGZvciB2YXJpb3VzIGV2ZW50cyAqLworCWludGVsX3VuY29yZV93cml0
ZSh1bmNvcmUsIFNERVcsIDB4MTUwNDBkMDApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUs
IENTSUVXMCwgMHgwMDdmMDAwMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgQ1NJRVcx
LCAweDFlMjIwMDA0KTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBDU0lFVzIsIDB4MDQw
MDAwMDQpOworCisJZm9yIChpID0gMDsgaSA8IDU7IGkrKykKKwkJaW50ZWxfdW5jb3JlX3dyaXRl
KHVuY29yZSwgUEVXKGkpLCAwKTsKKwlmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKQorCQlpbnRlbF91
bmNvcmVfd3JpdGUodW5jb3JlLCBERVcoaSksIDApOworCisJLyogUHJvZ3JhbSBQLXN0YXRlIHdl
aWdodHMgdG8gYWNjb3VudCBmb3IgZnJlcXVlbmN5IHBvd2VyIGFkanVzdG1lbnQgKi8KKwlmb3Ig
KGkgPSAwOyBpIDwgMTY7IGkrKykgeworCQl1MzIgcHh2aWRmcmVxID0gaW50ZWxfdW5jb3JlX3Jl
YWQodW5jb3JlLCBQWFZGUkVRKGkpKTsKKwkJdW5zaWduZWQgaW50IGZyZXEgPSBpbnRlbF9weGZy
ZXEocHh2aWRmcmVxKTsKKwkJdW5zaWduZWQgaW50IHZpZCA9CisJCQkocHh2aWRmcmVxICYgUFhW
RlJFUV9QWF9NQVNLKSA+PiBQWFZGUkVRX1BYX1NISUZUOworCQl1bnNpZ25lZCBpbnQgdmFsOwor
CisJCXZhbCA9IHZpZCAqIHZpZCAqIGZyZXEgLyAxMDAwICogMjU1OworCQl2YWwgLz0gMTI3ICog
MTI3ICogOTAwOworCisJCXB4d1tpXSA9IHZhbDsKKwl9CisJLyogUmVuZGVyIHN0YW5kYnkgc3Rh
dGVzIGdldCAwIHdlaWdodCAqLworCXB4d1sxNF0gPSAwOworCXB4d1sxNV0gPSAwOworCisJZm9y
IChpID0gMDsgaSA8IDQ7IGkrKykgeworCQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBQWFco
aSksCisJCQkJICAgcHh3W2kgKiA0ICsgMF0gPDwgMjQgfAorCQkJCSAgIHB4d1tpICogNCArIDFd
IDw8IDE2IHwKKwkJCQkgICBweHdbaSAqIDQgKyAyXSA8PCAgOCB8CisJCQkJICAgcHh3W2kgKiA0
ICsgM10gPDwgIDApOworCX0KKworCS8qIEFkanVzdCBtYWdpYyByZWdzIHRvIG1hZ2ljIHZhbHVl
cyAobW9yZSBleHBlcmltZW50YWwgcmVzdWx0cykgKi8KKwlpbnRlbF91bmNvcmVfd3JpdGUodW5j
b3JlLCBPR1cwLCAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBPR1cxLCAwKTsKKwlp
bnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBFRzAsIDB4MDAwMDdmMDApOworCWludGVsX3VuY29y
ZV93cml0ZSh1bmNvcmUsIEVHMSwgMHgwMDAwMDAwZSk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVu
Y29yZSwgRUcyLCAweDAwMGUwMDAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBFRzMs
IDB4NjgwMDAzMDApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEVHNCwgMHg0MjAwMDAw
MCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgRUc1LCAweDAwMTQwMDMxKTsKKwlpbnRl
bF91bmNvcmVfd3JpdGUodW5jb3JlLCBFRzYsIDApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNv
cmUsIEVHNywgMCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgODsgaSsrKQorCQlpbnRlbF91bmNvcmVf
d3JpdGUodW5jb3JlLCBQWFdMKGkpLCAwKTsKKworCS8qIEVuYWJsZSBQTU9OICsgc2VsZWN0IGV2
ZW50cyAqLworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEVDUiwgMHg4MDAwMDAxOSk7CisK
KwlyZXR1cm4gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBMQ0ZVU0UwMikgJiBMQ0ZVU0VfSElW
X01BU0s7Cit9CisKK3N0YXRpYyBib29sIGdlbjVfcnBzX2VuYWJsZShzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcnBzX3RvX3VuY29yZShy
cHMpOworCXU4IGZzdGFydCwgdnN0YXJ0OworCXUzMiByZ3Ztb2RlY3RsOworCisJc3Bpbl9sb2Nr
X2lycSgmbWNoZGV2X2xvY2spOworCisJcmd2bW9kZWN0bCA9IGludGVsX3VuY29yZV9yZWFkKHVu
Y29yZSwgTUVNTU9ERUNUTCk7CisKKwkvKiBFbmFibGUgdGVtcCByZXBvcnRpbmcgKi8KKwlpbnRl
bF91bmNvcmVfd3JpdGUxNih1bmNvcmUsIFBNTUlTQywKKwkJCSAgICAgaW50ZWxfdW5jb3JlX3Jl
YWQxNih1bmNvcmUsIFBNTUlTQykgfCBNQ1BQQ0VfRU4pOworCWludGVsX3VuY29yZV93cml0ZTE2
KHVuY29yZSwgVFNDMSwKKwkJCSAgICAgaW50ZWxfdW5jb3JlX3JlYWQxNih1bmNvcmUsIFRTQzEp
IHwgVFNFKTsKKworCS8qIDEwMG1zIFJDIGV2YWx1YXRpb24gaW50ZXJ2YWxzICovCisJaW50ZWxf
dW5jb3JlX3dyaXRlKHVuY29yZSwgUkNVUEVJLCAxMDAwMDApOworCWludGVsX3VuY29yZV93cml0
ZSh1bmNvcmUsIFJDRE5FSSwgMTAwMDAwKTsKKworCS8qIFNldCBtYXgvbWluIHRocmVzaG9sZHMg
dG8gOTBtcyBhbmQgODBtcyByZXNwZWN0aXZlbHkgKi8KKwlpbnRlbF91bmNvcmVfd3JpdGUodW5j
b3JlLCBSQ0JNQVhBVkcsIDkwMDAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBSQ0JN
SU5BVkcsIDgwMDAwKTsKKworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIE1FTUlIWVNULCAx
KTsKKworCS8qIFNldCB1cCBtaW4sIG1heCwgYW5kIGN1ciBmb3IgaW50ZXJydXB0IGhhbmRsaW5n
ICovCisJZnN0YXJ0ID0gKHJndm1vZGVjdGwgJiBNRU1NT0RFX0ZTVEFSVF9NQVNLKSA+PgorCQlN
RU1NT0RFX0ZTVEFSVF9TSElGVDsKKworCXZzdGFydCA9IChpbnRlbF91bmNvcmVfcmVhZCh1bmNv
cmUsIFBYVkZSRVEoZnN0YXJ0KSkgJgorCQkgIFBYVkZSRVFfUFhfTUFTSykgPj4gUFhWRlJFUV9Q
WF9TSElGVDsKKworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsCisJCQkgICBNRU1JTlRSRU4s
CisJCQkgICBNRU1JTlRfQ1hfU1VQUl9FTiB8IE1FTUlOVF9FVkFMX0NIR19FTik7CisKKwlpbnRl
bF91bmNvcmVfd3JpdGUodW5jb3JlLCBWSURTVEFSVCwgdnN0YXJ0KTsKKwlpbnRlbF91bmNvcmVf
cG9zdGluZ19yZWFkKHVuY29yZSwgVklEU1RBUlQpOworCisJcmd2bW9kZWN0bCB8PSBNRU1NT0RF
X1NXTU9ERV9FTjsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBNRU1NT0RFQ1RMLCByZ3Zt
b2RlY3RsKTsKKworCWlmICh3YWl0X2Zvcl9hdG9taWMoKGludGVsX3VuY29yZV9yZWFkKHVuY29y
ZSwgTUVNU1dDVEwpICYKKwkJCSAgICAgTUVNQ1RMX0NNRF9TVFMpID09IDAsIDEwKSkKKwkJRFJN
X0VSUk9SKCJzdHVjayB0cnlpbmcgdG8gY2hhbmdlIHBlcmYgbW9kZVxuIik7CisJbWRlbGF5KDEp
OworCisJZ2VuNV9ycHNfc2V0KHJwcywgcnBzLT5jdXJfZnJlcSk7CisKKwlycHMtPmlwcy5sYXN0
X2NvdW50MSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgRE1JRUMpOworCXJwcy0+aXBzLmxh
c3RfY291bnQxICs9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgRERSRUMpOworCXJwcy0+aXBz
Lmxhc3RfY291bnQxICs9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgQ1NJRUMpOworCXJwcy0+
aXBzLmxhc3RfdGltZTEgPSBqaWZmaWVzX3RvX21zZWNzKGppZmZpZXMpOworCisJcnBzLT5pcHMu
bGFzdF9jb3VudDIgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdGWEVDKTsKKwlycHMtPmlw
cy5sYXN0X3RpbWUyID0ga3RpbWVfZ2V0X3Jhd19ucygpOworCisJc3Bpbl91bmxvY2tfaXJxKCZt
Y2hkZXZfbG9jayk7CisKKwlycHMtPmlwcy5jb3JyID0gaW5pdF9lbW9uKHVuY29yZSk7CisKKwly
ZXR1cm4gdHJ1ZTsKK30KKworc3RhdGljIHZvaWQgZ2VuNV9ycHNfZGlzYWJsZShzdHJ1Y3QgaW50
ZWxfcnBzICpycHMpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcnBzX3RvX3Vu
Y29yZShycHMpOworCXUxNiByZ3Zzd2N0bDsKKworCXNwaW5fbG9ja19pcnEoJm1jaGRldl9sb2Nr
KTsKKworCXJndnN3Y3RsID0gaW50ZWxfdW5jb3JlX3JlYWQxNih1bmNvcmUsIE1FTVNXQ1RMKTsK
KworCS8qIEFjayBpbnRlcnJ1cHRzLCBkaXNhYmxlIEVGQyBpbnRlcnJ1cHQgKi8KKwlpbnRlbF91
bmNvcmVfd3JpdGUodW5jb3JlLCBNRU1JTlRSRU4sCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1
bmNvcmUsIE1FTUlOVFJFTikgJgorCQkJICAgfk1FTUlOVF9FVkFMX0NIR19FTik7CisJaW50ZWxf
dW5jb3JlX3dyaXRlKHVuY29yZSwgTUVNSU5UUlNUUywgTUVNSU5UX0VWQUxfQ0hHKTsKKwlpbnRl
bF91bmNvcmVfd3JpdGUodW5jb3JlLCBERUlFUiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVu
Y29yZSwgREVJRVIpICYgfkRFX1BDVV9FVkVOVCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29y
ZSwgREVJSVIsIERFX1BDVV9FVkVOVCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgREVJ
TVIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIERFSU1SKSB8IERFX1BDVV9FVkVO
VCk7CisKKwkvKiBHbyBiYWNrIHRvIHRoZSBzdGFydGluZyBmcmVxdWVuY3kgKi8KKwlnZW41X3Jw
c19zZXQocnBzLCBycHMtPmlkbGVfZnJlcSk7CisJbWRlbGF5KDEpOworCXJndnN3Y3RsIHw9IE1F
TUNUTF9DTURfU1RTOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIE1FTVNXQ1RMLCByZ3Zz
d2N0bCk7CisJbWRlbGF5KDEpOworCisJc3Bpbl91bmxvY2tfaXJxKCZtY2hkZXZfbG9jayk7Cit9
CisKK3N0YXRpYyB1MzIgcnBzX2xpbWl0cyhzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIHU4IHZhbCkK
K3sKKwl1MzIgbGltaXRzOworCisJLyoKKwkgKiBPbmx5IHNldCB0aGUgZG93biBsaW1pdCB3aGVu
IHdlJ3ZlIHJlYWNoZWQgdGhlIGxvd2VzdCBsZXZlbCB0byBhdm9pZAorCSAqIGdldHRpbmcgbW9y
ZSBpbnRlcnJ1cHRzLCBvdGhlcndpc2UgbGVhdmUgdGhpcyBjbGVhci4gVGhpcyBwcmV2ZW50cyBh
CisJICogcmFjZSBpbiB0aGUgaHcgd2hlbiBjb21pbmcgb3V0IG9mIHJjNjogVGhlcmUncyBhIHRp
bnkgd2luZG93IHdoZXJlCisJICogdGhlIGh3IHJ1bnMgYXQgdGhlIG1pbmltYWwgY2xvY2sgYmVm
b3JlIHNlbGVjdGluZyB0aGUgZGVzaXJlZAorCSAqIGZyZXF1ZW5jeSwgaWYgdGhlIGRvd24gdGhy
ZXNob2xkIGV4cGlyZXMgaW4gdGhhdCB3aW5kb3cgd2Ugd2lsbCBub3QKKwkgKiByZWNlaXZlIGEg
ZG93biBpbnRlcnJ1cHQuCisJICovCisJaWYgKElOVEVMX0dFTihycHNfdG9faTkxNShycHMpKSA+
PSA5KSB7CisJCWxpbWl0cyA9IHJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0IDw8IDIzOworCQlpZiAo
dmFsIDw9IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KQorCQkJbGltaXRzIHw9IHJwcy0+bWluX2Zy
ZXFfc29mdGxpbWl0IDw8IDE0OworCX0gZWxzZSB7CisJCWxpbWl0cyA9IHJwcy0+bWF4X2ZyZXFf
c29mdGxpbWl0IDw8IDI0OworCQlpZiAodmFsIDw9IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KQor
CQkJbGltaXRzIHw9IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0IDw8IDE2OworCX0KKworCXJldHVy
biBsaW1pdHM7Cit9CisKK3N0YXRpYyB2b2lkIHJwc19zZXRfcG93ZXIoc3RydWN0IGludGVsX3Jw
cyAqcnBzLCBpbnQgbmV3X3Bvd2VyKQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9
IHJwc190b191bmNvcmUocnBzKTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJw
c190b19pOTE1KHJwcyk7CisJdTMyIHRocmVzaG9sZF91cCA9IDAsIHRocmVzaG9sZF9kb3duID0g
MDsgLyogaW4gJSAqLworCXUzMiBlaV91cCA9IDAsIGVpX2Rvd24gPSAwOworCisJbG9ja2RlcF9h
c3NlcnRfaGVsZCgmcnBzLT5wb3dlci5tdXRleCk7CisKKwlpZiAobmV3X3Bvd2VyID09IHJwcy0+
cG93ZXIubW9kZSkKKwkJcmV0dXJuOworCisJLyogTm90ZSB0aGUgdW5pdHMgaGVyZSBhcmUgbm90
IGV4YWN0bHkgMXVzLCBidXQgMTI4MG5zLiAqLworCXN3aXRjaCAobmV3X3Bvd2VyKSB7CisJY2Fz
ZSBMT1dfUE9XRVI6CisJCS8qIFVwY2xvY2sgaWYgbW9yZSB0aGFuIDk1JSBidXN5IG92ZXIgMTZt
cyAqLworCQllaV91cCA9IDE2MDAwOworCQl0aHJlc2hvbGRfdXAgPSA5NTsKKworCQkvKiBEb3du
Y2xvY2sgaWYgbGVzcyB0aGFuIDg1JSBidXN5IG92ZXIgMzJtcyAqLworCQllaV9kb3duID0gMzIw
MDA7CisJCXRocmVzaG9sZF9kb3duID0gODU7CisJCWJyZWFrOworCisJY2FzZSBCRVRXRUVOOgor
CQkvKiBVcGNsb2NrIGlmIG1vcmUgdGhhbiA5MCUgYnVzeSBvdmVyIDEzbXMgKi8KKwkJZWlfdXAg
PSAxMzAwMDsKKwkJdGhyZXNob2xkX3VwID0gOTA7CisKKwkJLyogRG93bmNsb2NrIGlmIGxlc3Mg
dGhhbiA3NSUgYnVzeSBvdmVyIDMybXMgKi8KKwkJZWlfZG93biA9IDMyMDAwOworCQl0aHJlc2hv
bGRfZG93biA9IDc1OworCQlicmVhazsKKworCWNhc2UgSElHSF9QT1dFUjoKKwkJLyogVXBjbG9j
ayBpZiBtb3JlIHRoYW4gODUlIGJ1c3kgb3ZlciAxMG1zICovCisJCWVpX3VwID0gMTAwMDA7CisJ
CXRocmVzaG9sZF91cCA9IDg1OworCisJCS8qIERvd25jbG9jayBpZiBsZXNzIHRoYW4gNjAlIGJ1
c3kgb3ZlciAzMm1zICovCisJCWVpX2Rvd24gPSAzMjAwMDsKKwkJdGhyZXNob2xkX2Rvd24gPSA2
MDsKKwkJYnJlYWs7CisJfQorCisJLyogV2hlbiBieXQgY2FuIHN1cnZpdmUgd2l0aG91dCBzeXN0
ZW0gaGFuZyB3aXRoIGR5bmFtaWMKKwkgKiBzdyBmcmVxIGFkanVzdG1lbnRzLCB0aGlzIHJlc3Ry
aWN0aW9uIGNhbiBiZSBsaWZ0ZWQuCisJICovCisJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCisJ
CWdvdG8gc2tpcF9od193cml0ZTsKKworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjZf
UlBfVVBfRUksCisJCQkgICBHVF9JTlRFUlZBTF9GUk9NX1VTKGk5MTUsIGVpX3VwKSk7CisJaW50
ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VONl9SUF9VUF9USFJFU0hPTEQsCisJCQkgICBHVF9J
TlRFUlZBTF9GUk9NX1VTKGk5MTUsCisJCQkJCSAgICAgICBlaV91cCAqIHRocmVzaG9sZF91cCAv
IDEwMCkpOworCisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VONl9SUF9ET1dOX0VJLAor
CQkJICAgR1RfSU5URVJWQUxfRlJPTV9VUyhpOTE1LCBlaV9kb3duKSk7CisJaW50ZWxfdW5jb3Jl
X3dyaXRlKHVuY29yZSwgR0VONl9SUF9ET1dOX1RIUkVTSE9MRCwKKwkJCSAgIEdUX0lOVEVSVkFM
X0ZST01fVVMoaTkxNSwKKwkJCQkJICAgICAgIGVpX2Rvd24gKiB0aHJlc2hvbGRfZG93biAvIDEw
MCkpOworCisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VONl9SUF9DT05UUk9MLAorCQkJ
ICAgKElOVEVMX0dFTihpOTE1KSA+IDkgPyAwIDogR0VONl9SUF9NRURJQV9UVVJCTykgfAorCQkJ
ICAgR0VONl9SUF9NRURJQV9IV19OT1JNQUxfTU9ERSB8CisJCQkgICBHRU42X1JQX01FRElBX0lT
X0dGWCB8CisJCQkgICBHRU42X1JQX0VOQUJMRSB8CisJCQkgICBHRU42X1JQX1VQX0JVU1lfQVZH
IHwKKwkJCSAgIEdFTjZfUlBfRE9XTl9JRExFX0FWRyk7CisKK3NraXBfaHdfd3JpdGU6CisJcnBz
LT5wb3dlci5tb2RlID0gbmV3X3Bvd2VyOworCXJwcy0+cG93ZXIudXBfdGhyZXNob2xkID0gdGhy
ZXNob2xkX3VwOworCXJwcy0+cG93ZXIuZG93bl90aHJlc2hvbGQgPSB0aHJlc2hvbGRfZG93bjsK
K30KKworc3RhdGljIHZvaWQgZ2VuNl9ycHNfc2V0X3RocmVzaG9sZHMoc3RydWN0IGludGVsX3Jw
cyAqcnBzLCB1OCB2YWwpCit7CisJaW50IG5ld19wb3dlcjsKKworCW5ld19wb3dlciA9IHJwcy0+
cG93ZXIubW9kZTsKKwlzd2l0Y2ggKHJwcy0+cG93ZXIubW9kZSkgeworCWNhc2UgTE9XX1BPV0VS
OgorCQlpZiAodmFsID4gcnBzLT5lZmZpY2llbnRfZnJlcSArIDEgJiYKKwkJICAgIHZhbCA+IHJw
cy0+Y3VyX2ZyZXEpCisJCQluZXdfcG93ZXIgPSBCRVRXRUVOOworCQlicmVhazsKKworCWNhc2Ug
QkVUV0VFTjoKKwkJaWYgKHZhbCA8PSBycHMtPmVmZmljaWVudF9mcmVxICYmCisJCSAgICB2YWwg
PCBycHMtPmN1cl9mcmVxKQorCQkJbmV3X3Bvd2VyID0gTE9XX1BPV0VSOworCQllbHNlIGlmICh2
YWwgPj0gcnBzLT5ycDBfZnJlcSAmJgorCQkJIHZhbCA+IHJwcy0+Y3VyX2ZyZXEpCisJCQluZXdf
cG93ZXIgPSBISUdIX1BPV0VSOworCQlicmVhazsKKworCWNhc2UgSElHSF9QT1dFUjoKKwkJaWYg
KHZhbCA8IChycHMtPnJwMV9mcmVxICsgcnBzLT5ycDBfZnJlcSkgPj4gMSAmJgorCQkgICAgdmFs
IDwgcnBzLT5jdXJfZnJlcSkKKwkJCW5ld19wb3dlciA9IEJFVFdFRU47CisJCWJyZWFrOworCX0K
KwkvKiBNYXgvbWluIGJpbnMgYXJlIHNwZWNpYWwgKi8KKwlpZiAodmFsIDw9IHJwcy0+bWluX2Zy
ZXFfc29mdGxpbWl0KQorCQluZXdfcG93ZXIgPSBMT1dfUE9XRVI7CisJaWYgKHZhbCA+PSBycHMt
Pm1heF9mcmVxX3NvZnRsaW1pdCkKKwkJbmV3X3Bvd2VyID0gSElHSF9QT1dFUjsKKworCW11dGV4
X2xvY2soJnJwcy0+cG93ZXIubXV0ZXgpOworCWlmIChycHMtPnBvd2VyLmludGVyYWN0aXZlKQor
CQluZXdfcG93ZXIgPSBISUdIX1BPV0VSOworCXJwc19zZXRfcG93ZXIocnBzLCBuZXdfcG93ZXIp
OworCW11dGV4X3VubG9jaygmcnBzLT5wb3dlci5tdXRleCk7Cit9CisKK3ZvaWQgaW50ZWxfcnBz
X21hcmtfaW50ZXJhY3RpdmUoc3RydWN0IGludGVsX3JwcyAqcnBzLCBib29sIGludGVyYWN0aXZl
KQoreworCWlmICghcnBzLT5lbmFibGVkKQorCQlyZXR1cm47CisKKwltdXRleF9sb2NrKCZycHMt
PnBvd2VyLm11dGV4KTsKKwlpZiAoaW50ZXJhY3RpdmUpIHsKKwkJaWYgKCFycHMtPnBvd2VyLmlu
dGVyYWN0aXZlKysgJiYgcnBzLT5hY3RpdmUpCisJCQlycHNfc2V0X3Bvd2VyKHJwcywgSElHSF9Q
T1dFUik7CisJfSBlbHNlIHsKKwkJR0VNX0JVR19PTighcnBzLT5wb3dlci5pbnRlcmFjdGl2ZSk7
CisJCXJwcy0+cG93ZXIuaW50ZXJhY3RpdmUtLTsKKwl9CisJbXV0ZXhfdW5sb2NrKCZycHMtPnBv
d2VyLm11dGV4KTsKK30KKworc3RhdGljIGludCBnZW42X3Jwc19zZXQoc3RydWN0IGludGVsX3Jw
cyAqcnBzLCB1OCB2YWwpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcnBzX3Rv
X3VuY29yZShycHMpOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcnBzX3RvX2k5
MTUocnBzKTsKKwl1MzIgc3dyZXE7CisKKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCisJCXN3
cmVxID0gR0VOOV9GUkVRVUVOQ1kodmFsKTsKKwllbHNlIGlmIChJU19IQVNXRUxMKGk5MTUpIHx8
IElTX0JST0FEV0VMTChpOTE1KSkKKwkJc3dyZXEgPSBIU1dfRlJFUVVFTkNZKHZhbCk7CisJZWxz
ZQorCQlzd3JlcSA9IChHRU42X0ZSRVFVRU5DWSh2YWwpIHwKKwkJCSBHRU42X09GRlNFVCgwKSB8
CisJCQkgR0VONl9BR0dSRVNTSVZFX1RVUkJPKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3Jl
LCBHRU42X1JQTlNXUkVRLCBzd3JlcSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCB2
bHZfcnBzX3NldChzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIHU4IHZhbCkKK3sKKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7CisJaW50IGVycjsKKworCXZs
dl9wdW5pdF9nZXQoaTkxNSk7CisJZXJyID0gdmx2X3B1bml0X3dyaXRlKGk5MTUsIFBVTklUX1JF
R19HUFVfRlJFUV9SRVEsIHZhbCk7CisJdmx2X3B1bml0X3B1dChpOTE1KTsKKworCXJldHVybiBl
cnI7Cit9CisKK3N0YXRpYyBpbnQgcnBzX3NldChzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIHU4IHZh
bCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7
CisJaW50IGVycjsKKworCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA2KQorCQlyZXR1cm4gMDsKKwor
CWlmICh2YWwgPT0gcnBzLT5sYXN0X2ZyZXEpCisJCXJldHVybiAwOworCisJaWYgKElTX1ZBTExF
WVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKKwkJZXJyID0gdmx2X3Jwc19zZXQo
cnBzLCB2YWwpOworCWVsc2UKKwkJZXJyID0gZ2VuNl9ycHNfc2V0KHJwcywgdmFsKTsKKwlpZiAo
ZXJyKQorCQlyZXR1cm4gZXJyOworCisJZ2VuNl9ycHNfc2V0X3RocmVzaG9sZHMocnBzLCB2YWwp
OworCXJwcy0+bGFzdF9mcmVxID0gdmFsOworCisJcmV0dXJuIDA7Cit9CisKK3ZvaWQgaW50ZWxf
cnBzX3VucGFyayhzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJdTggZnJlcTsKKworCWlmICgh
cnBzLT5lbmFibGVkKQorCQlyZXR1cm47CisKKwkvKgorCSAqIFVzZSB0aGUgdXNlcidzIGRlc2ly
ZWQgZnJlcXVlbmN5IGFzIGEgZ3VpZGUsIGJ1dCBmb3IgYmV0dGVyCisJICogcGVyZm9ybWFuY2Us
IGp1bXAgZGlyZWN0bHkgdG8gUlBlIGFzIG91ciBzdGFydGluZyBmcmVxdWVuY3kuCisJICovCisJ
bXV0ZXhfbG9jaygmcnBzLT5sb2NrKTsKKwlycHMtPmFjdGl2ZSA9IHRydWU7CisJZnJlcSA9IG1h
eChycHMtPmN1cl9mcmVxLCBycHMtPmVmZmljaWVudF9mcmVxKSwKKwlmcmVxID0gY2xhbXAoZnJl
cSwgcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQsIHJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0KTsKKwlp
bnRlbF9ycHNfc2V0KHJwcywgZnJlcSk7CisJcnBzLT5sYXN0X2FkaiA9IDA7CisJbXV0ZXhfdW5s
b2NrKCZycHMtPmxvY2spOworCisJaWYgKElOVEVMX0dFTihycHNfdG9faTkxNShycHMpKSA+PSA2
KQorCQlycHNfZW5hYmxlX2ludGVycnVwdHMocnBzKTsKKworCWlmIChJU19HRU4ocnBzX3RvX2k5
MTUocnBzKSwgNSkpCisJCWdlbjVfcnBzX3VwZGF0ZShycHMpOworfQorCit2b2lkIGludGVsX3Jw
c19wYXJrKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7CisKKwlpZiAoIXJwcy0+ZW5hYmxlZCkKKwkJcmV0
dXJuOworCisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQorCQlycHNfZGlzYWJsZV9pbnRlcnJ1
cHRzKHJwcyk7CisKKwlycHMtPmFjdGl2ZSA9IGZhbHNlOworCWlmIChycHMtPmxhc3RfZnJlcSA8
PSBycHMtPmlkbGVfZnJlcSkKKwkJcmV0dXJuOworCisJLyoKKwkgKiBUaGUgcHVuaXQgZGVsYXlz
IHRoZSB3cml0ZSBvZiB0aGUgZnJlcXVlbmN5IGFuZCB2b2x0YWdlIHVudGlsIGl0CisJICogZGV0
ZXJtaW5lcyB0aGUgR1BVIGlzIGF3YWtlLiBEdXJpbmcgbm9ybWFsIHVzYWdlIHdlIGRvbid0IHdh
bnQgdG8KKwkgKiB3YXN0ZSBwb3dlciBjaGFuZ2luZyB0aGUgZnJlcXVlbmN5IGlmIHRoZSBHUFUg
aXMgc2xlZXBpbmcgKHJjNikuCisJICogSG93ZXZlciwgdGhlIEdQVSBhbmQgZHJpdmVyIGlzIG5v
dyBpZGxlIGFuZCB3ZSBkbyBub3Qgd2FudCB0byBkZWxheQorCSAqIHN3aXRjaGluZyB0byBtaW5p
bXVtIHZvbHRhZ2UgKHJlZHVjaW5nIHBvd2VyIHdoaWxzdCBpZGxlKSBhcyB3ZSBkbworCSAqIG5v
dCBleHBlY3QgdG8gYmUgd29rZW4gaW4gdGhlIG5lYXIgZnV0dXJlIGFuZCBzbyBtdXN0IGZsdXNo
IHRoZQorCSAqIGNoYW5nZSBieSB3YWtpbmcgdGhlIGRldmljZS4KKwkgKgorCSAqIFdlIGNob29z
ZSB0byB0YWtlIHRoZSBtZWRpYSBwb3dlcndlbGwgKGVpdGhlciB3b3VsZCBkbyB0byB0cmljayB0
aGUKKwkgKiBwdW5pdCBpbnRvIGNvbW1pdHRpbmcgdGhlIHZvbHRhZ2UgY2hhbmdlKSBhcyB0aGF0
IHRha2VzIGEgbG90IGxlc3MKKwkgKiBwb3dlciB0aGFuIHRoZSByZW5kZXIgcG93ZXJ3ZWxsLgor
CSAqLworCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KHJwc190b191bmNvcmUocnBzKSwgRk9S
Q0VXQUtFX01FRElBKTsKKwlycHNfc2V0KHJwcywgcnBzLT5pZGxlX2ZyZXEpOworCWludGVsX3Vu
Y29yZV9mb3JjZXdha2VfcHV0KHJwc190b191bmNvcmUocnBzKSwgRk9SQ0VXQUtFX01FRElBKTsK
K30KKwordm9pZCBpbnRlbF9ycHNfYm9vc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCit7CisJ
c3RydWN0IGludGVsX3JwcyAqcnBzID0gJnJxLT5lbmdpbmUtPmd0LT5ycHM7CisJdW5zaWduZWQg
bG9uZyBmbGFnczsKKworCWlmIChpOTE1X3JlcXVlc3Rfc2lnbmFsZWQocnEpIHx8ICFycHMtPmFj
dGl2ZSkKKwkJcmV0dXJuOworCisJLyogU2VyaWFsaXplcyB3aXRoIGk5MTVfcmVxdWVzdF9yZXRp
cmUoKSAqLworCXNwaW5fbG9ja19pcnFzYXZlKCZycS0+bG9jaywgZmxhZ3MpOworCWlmICghaTkx
NV9yZXF1ZXN0X2hhc193YWl0Ym9vc3QocnEpICYmCisJICAgICFkbWFfZmVuY2VfaXNfc2lnbmFs
ZWRfbG9ja2VkKCZycS0+ZmVuY2UpKSB7CisJCXJxLT5mbGFncyB8PSBJOTE1X1JFUVVFU1RfV0FJ
VEJPT1NUOworCisJCWlmICghYXRvbWljX2ZldGNoX2luYygmcnBzLT5udW1fd2FpdGVycykgJiYK
KwkJICAgIFJFQURfT05DRShycHMtPmN1cl9mcmVxKSA8IHJwcy0+Ym9vc3RfZnJlcSkKKwkJCXNj
aGVkdWxlX3dvcmsoJnJwcy0+d29yayk7CisKKwkJYXRvbWljX2luYygmcnBzLT5ib29zdHMpOwor
CX0KKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZycS0+bG9jaywgZmxhZ3MpOworfQorCitpbnQg
aW50ZWxfcnBzX3NldChzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIHU4IHZhbCkKK3sKKwlpbnQgZXJy
ID0gMDsKKworCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnJwcy0+bG9jayk7CisJR0VNX0JVR19PTih2
YWwgPiBycHMtPm1heF9mcmVxKTsKKwlHRU1fQlVHX09OKHZhbCA8IHJwcy0+bWluX2ZyZXEpOwor
CisJaWYgKHJwcy0+YWN0aXZlKSB7CisJCWVyciA9IHJwc19zZXQocnBzLCB2YWwpOworCisJCS8q
CisJCSAqIE1ha2Ugc3VyZSB3ZSBjb250aW51ZSB0byBnZXQgaW50ZXJydXB0cworCQkgKiB1bnRp
bCB3ZSBoaXQgdGhlIG1pbmltdW0gb3IgbWF4aW11bSBmcmVxdWVuY2llcy4KKwkJICovCisJCWlm
IChJTlRFTF9HRU4ocnBzX3RvX2k5MTUocnBzKSkgPj0gNikgeworCQkJc3RydWN0IGludGVsX3Vu
Y29yZSAqdW5jb3JlID0gcnBzX3RvX3VuY29yZShycHMpOworCisJCQlpbnRlbF91bmNvcmVfd3Jp
dGUodW5jb3JlLCBHRU42X1JQX0lOVEVSUlVQVF9MSU1JVFMsCisJCQkJCSAgIHJwc19saW1pdHMo
cnBzLCB2YWwpKTsKKworCQkJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VONl9QTUlOVFJN
U0ssCisJCQkJCSAgIHJwc19wbV9tYXNrKHJwcywgdmFsKSk7CisJCX0KKwl9CisKKwlpZiAoZXJy
ID09IDApIHsKKwkJdHJhY2VfaW50ZWxfZ3B1X2ZyZXFfY2hhbmdlKGludGVsX2dwdV9mcmVxKHJw
cywgdmFsKSk7CisJCXJwcy0+Y3VyX2ZyZXEgPSB2YWw7CisJfQorCisJcmV0dXJuIGVycjsKK30K
Kworc3RhdGljIHZvaWQgZ2VuNl9ycHNfaW5pdChzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOworCXN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJwc190b191bmNvcmUocnBzKTsKKworCS8qIEFsbCBv
ZiB0aGVzZSB2YWx1ZXMgYXJlIGluIHVuaXRzIG9mIDUwTUh6ICovCisKKwkvKiBzdGF0aWMgdmFs
dWVzIGZyb20gSFc6IFJQMCA+IFJQMSA+IFJQbiAobWluX2ZyZXEpICovCisJaWYgKElTX0dFTjlf
TFAoaTkxNSkpIHsKKwkJdTMyIHJwX3N0YXRlX2NhcCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29y
ZSwgQlhUX1JQX1NUQVRFX0NBUCk7CisKKwkJcnBzLT5ycDBfZnJlcSA9IChycF9zdGF0ZV9jYXAg
Pj4gMTYpICYgMHhmZjsKKwkJcnBzLT5ycDFfZnJlcSA9IChycF9zdGF0ZV9jYXAgPj4gIDgpICYg
MHhmZjsKKwkJcnBzLT5taW5fZnJlcSA9IChycF9zdGF0ZV9jYXAgPj4gIDApICYgMHhmZjsKKwl9
IGVsc2UgeworCQl1MzIgcnBfc3RhdGVfY2FwID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBH
RU42X1JQX1NUQVRFX0NBUCk7CisKKwkJcnBzLT5ycDBfZnJlcSA9IChycF9zdGF0ZV9jYXAgPj4g
IDApICYgMHhmZjsKKwkJcnBzLT5ycDFfZnJlcSA9IChycF9zdGF0ZV9jYXAgPj4gIDgpICYgMHhm
ZjsKKwkJcnBzLT5taW5fZnJlcSA9IChycF9zdGF0ZV9jYXAgPj4gMTYpICYgMHhmZjsKKwl9CisK
KwkvKiBod19tYXggPSBSUDAgdW50aWwgd2UgY2hlY2sgZm9yIG92ZXJjbG9ja2luZyAqLworCXJw
cy0+bWF4X2ZyZXEgPSBycHMtPnJwMF9mcmVxOworCisJcnBzLT5lZmZpY2llbnRfZnJlcSA9IHJw
cy0+cnAxX2ZyZXE7CisJaWYgKElTX0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUp
IHx8CisJICAgIElTX0dFTjlfQkMoaTkxNSkgfHwgSU5URUxfR0VOKGk5MTUpID49IDEwKSB7CisJ
CXUzMiBkZGNjX3N0YXR1cyA9IDA7CisKKwkJaWYgKHNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoaTkx
NSwKKwkJCQkJICAgSFNXX1BDT0RFX0RZTkFNSUNfRFVUWV9DWUNMRV9DT05UUk9MLAorCQkJCQkg
ICAmZGRjY19zdGF0dXMsIE5VTEwpID09IDApCisJCQlycHMtPmVmZmljaWVudF9mcmVxID0KKwkJ
CQljbGFtcF90KHU4LAorCQkJCQkoZGRjY19zdGF0dXMgPj4gOCkgJiAweGZmLAorCQkJCQlycHMt
Pm1pbl9mcmVxLAorCQkJCQlycHMtPm1heF9mcmVxKTsKKwl9CisKKwlpZiAoSVNfR0VOOV9CQyhp
OTE1KSB8fCBJTlRFTF9HRU4oaTkxNSkgPj0gMTApIHsKKwkJLyogU3RvcmUgdGhlIGZyZXF1ZW5j
eSB2YWx1ZXMgaW4gMTYuNjYgTUhaIHVuaXRzLCB3aGljaCBpcworCQkgKiB0aGUgbmF0dXJhbCBo
YXJkd2FyZSB1bml0IGZvciBTS0wKKwkJICovCisJCXJwcy0+cnAwX2ZyZXEgKj0gR0VOOV9GUkVR
X1NDQUxFUjsKKwkJcnBzLT5ycDFfZnJlcSAqPSBHRU45X0ZSRVFfU0NBTEVSOworCQlycHMtPm1p
bl9mcmVxICo9IEdFTjlfRlJFUV9TQ0FMRVI7CisJCXJwcy0+bWF4X2ZyZXEgKj0gR0VOOV9GUkVR
X1NDQUxFUjsKKwkJcnBzLT5lZmZpY2llbnRfZnJlcSAqPSBHRU45X0ZSRVFfU0NBTEVSOworCX0K
K30KKworc3RhdGljIGJvb2wgcnBzX3Jlc2V0KHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwkv
KiBmb3JjZSBhIHJlc2V0ICovCisJcnBzLT5wb3dlci5tb2RlID0gLTE7CisJcnBzLT5sYXN0X2Zy
ZXEgPSAtMTsKKworCWlmIChycHNfc2V0KHJwcywgcnBzLT5taW5fZnJlcSkpIHsKKwkJRFJNX0VS
Uk9SKCJGYWlsZWQgdG8gcmVzZXQgUlBTIHRvIGluaXRpYWwgdmFsdWVzXG4iKTsKKwkJcmV0dXJu
IGZhbHNlOworCX0KKworCXJwcy0+Y3VyX2ZyZXEgPSBycHMtPm1pbl9mcmVxOworCXJldHVybiB0
cnVlOworfQorCisvKiBTZWUgdGhlIEdlbjlfR1RfUE1fUHJvZ3JhbW1pbmdfR3VpZGUgZG9jIGZv
ciB0aGUgYmVsb3cgKi8KK3N0YXRpYyBib29sIGdlbjlfcnBzX2VuYWJsZShzdHJ1Y3QgaW50ZWxf
cnBzICpycHMpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkx
NShycHMpOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJwc190b191bmNvcmUocnBz
KTsKKworCS8qIFByb2dyYW0gZGVmYXVsdHMgYW5kIHRocmVzaG9sZHMgZm9yIFJQUyAqLworCWlm
IChJU19HRU4oaTkxNSwgOSkpCisJCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZf
UkNfVklERU9fRlJFUSwKKwkJCQkgICAgICBHRU45X0ZSRVFVRU5DWShycHMtPnJwMV9mcmVxKSk7
CisKKwkvKiAxIHNlY29uZCB0aW1lb3V0ICovCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29y
ZSwgR0VONl9SUF9ET1dOX1RJTUVPVVQsCisJCQkgICAgICBHVF9JTlRFUlZBTF9GUk9NX1VTKGk5
MTUsIDEwMDAwMDApKTsKKworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUlBf
SURMRV9IWVNURVJTSVMsIDB4YSk7CisKKwlyZXR1cm4gcnBzX3Jlc2V0KHJwcyk7Cit9CisKK3N0
YXRpYyBib29sIGdlbjhfcnBzX2VuYWJsZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJc3Ry
dWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcnBzX3RvX3VuY29yZShycHMpOworCisJaW50ZWxf
dW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SQ19WSURFT19GUkVRLAorCQkJICAgICAgSFNX
X0ZSRVFVRU5DWShycHMtPnJwMV9mcmVxKSk7CisKKwkvKiBOQjogRG9jcyBzYXkgMXMsIGFuZCAx
MDAwMDAwIC0gd2hpY2ggYXJlbid0IGVxdWl2YWxlbnQgKi8KKwlpbnRlbF91bmNvcmVfd3JpdGVf
ZncodW5jb3JlLCBHRU42X1JQX0RPV05fVElNRU9VVCwKKwkJCSAgICAgIDEwMDAwMDAwMCAvIDEy
OCk7IC8qIDEgc2Vjb25kIHRpbWVvdXQgKi8KKworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNv
cmUsIEdFTjZfUlBfSURMRV9IWVNURVJTSVMsIDEwKTsKKworCXJldHVybiBycHNfcmVzZXQocnBz
KTsKK30KKworc3RhdGljIGJvb2wgZ2VuNl9ycHNfZW5hYmxlKHN0cnVjdCBpbnRlbF9ycHMgKnJw
cykKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBycHNfdG9fdW5jb3JlKHJwcyk7
CisKKwkvKiBQb3dlciBkb3duIGlmIGNvbXBsZXRlbHkgaWRsZSBmb3Igb3ZlciA1MG1zICovCisJ
aW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SUF9ET1dOX1RJTUVPVVQsIDUwMDAw
KTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JQX0lETEVfSFlTVEVSU0lT
LCAxMCk7CisKKwlyZXR1cm4gcnBzX3Jlc2V0KHJwcyk7Cit9CisKK3N0YXRpYyBpbnQgY2h2X3Jw
c19tYXhfZnJlcShzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOworCXUzMiB2YWw7CisKKwl2YWwgPSB2bHZf
cHVuaXRfcmVhZChpOTE1LCBGQl9HRlhfRk1BWF9BVF9WTUFYX0ZVU0UpOworCisJc3dpdGNoIChS
VU5USU1FX0lORk8oaTkxNSktPnNzZXUuZXVfdG90YWwpIHsKKwljYXNlIDg6CisJCS8qICgyICog
NCkgY29uZmlnICovCisJCXZhbCA+Pj0gRkJfR0ZYX0ZNQVhfQVRfVk1BWF8yU1M0RVVfRlVTRV9T
SElGVDsKKwkJYnJlYWs7CisJY2FzZSAxMjoKKwkJLyogKDIgKiA2KSBjb25maWcgKi8KKwkJdmFs
ID4+PSBGQl9HRlhfRk1BWF9BVF9WTUFYXzJTUzZFVV9GVVNFX1NISUZUOworCQlicmVhazsKKwlj
YXNlIDE2OgorCQkvKiAoMiAqIDgpIGNvbmZpZyAqLworCWRlZmF1bHQ6CisJCS8qIFNldHRpbmcg
KDIgKiA4KSBNaW4gUlAwIGZvciBhbnkgb3RoZXIgY29tYmluYXRpb24gKi8KKwkJdmFsID4+PSBG
Ql9HRlhfRk1BWF9BVF9WTUFYXzJTUzhFVV9GVVNFX1NISUZUOworCQlicmVhazsKKwl9CisKKwly
ZXR1cm4gdmFsICYgRkJfR0ZYX0ZSRVFfRlVTRV9NQVNLOworfQorCitzdGF0aWMgaW50IGNodl9y
cHNfcnBlX2ZyZXEoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKwl1MzIgdmFsOworCisJdmFsID0gdmx2
X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfR1BVX0RVVFlDWUNMRV9SRUcpOworCXZhbCA+Pj0gUFVO
SVRfR1BVX0RVVFlDWUNMRV9SUEVfRlJFUV9TSElGVDsKKworCXJldHVybiB2YWwgJiBQVU5JVF9H
UFVfRFVUWUNZQ0xFX1JQRV9GUkVRX01BU0s7Cit9CisKK3N0YXRpYyBpbnQgY2h2X3Jwc19ndWFy
X2ZyZXEoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKwl1MzIgdmFsOworCisJdmFsID0gdmx2X3B1bml0
X3JlYWQoaTkxNSwgRkJfR0ZYX0ZNQVhfQVRfVk1BWF9GVVNFKTsKKworCXJldHVybiB2YWwgJiBG
Ql9HRlhfRlJFUV9GVVNFX01BU0s7Cit9CisKK3N0YXRpYyB1MzIgY2h2X3Jwc19taW5fZnJlcShz
dHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSBycHNfdG9faTkxNShycHMpOworCXUzMiB2YWw7CisKKwl2YWwgPSB2bHZfcHVuaXRfcmVhZChp
OTE1LCBGQl9HRlhfRk1JTl9BVF9WTUlOX0ZVU0UpOworCXZhbCA+Pj0gRkJfR0ZYX0ZNSU5fQVRf
Vk1JTl9GVVNFX1NISUZUOworICAgICAgIAorCXJldHVybiB2YWwgJiBGQl9HRlhfRlJFUV9GVVNF
X01BU0s7Cit9CisKK3N0YXRpYyBib29sIGNodl9ycHNfZW5hYmxlKHN0cnVjdCBpbnRlbF9ycHMg
KnJwcykKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBycHNfdG9fdW5jb3JlKHJw
cyk7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOwor
CXUzMiB2YWw7CisKKwkvKiAxOiBQcm9ncmFtIGRlZmF1bHRzIGFuZCB0aHJlc2hvbGRzIGZvciBS
UFMqLworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUlBfRE9XTl9USU1FT1VU
LCAxMDAwMDAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JQX1VQX1RI
UkVTSE9MRCwgNTk0MDApOworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUlBf
RE9XTl9USFJFU0hPTEQsIDI0NTAwMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwg
R0VONl9SUF9VUF9FSSwgNjYwMDApOworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdF
TjZfUlBfRE9XTl9FSSwgMzUwMDAwKTsKKworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUs
IEdFTjZfUlBfSURMRV9IWVNURVJTSVMsIDEwKTsKKworCS8qIDI6IEVuYWJsZSBSUFMgKi8KKwlp
bnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JQX0NPTlRST0wsCisJCQkgICAgICBH
RU42X1JQX01FRElBX0hXX05PUk1BTF9NT0RFIHwKKwkJCSAgICAgIEdFTjZfUlBfTUVESUFfSVNf
R0ZYIHwKKwkJCSAgICAgIEdFTjZfUlBfRU5BQkxFIHwKKwkJCSAgICAgIEdFTjZfUlBfVVBfQlVT
WV9BVkcgfAorCQkJICAgICAgR0VONl9SUF9ET1dOX0lETEVfQVZHKTsKKworCS8qIFNldHRpbmcg
Rml4ZWQgQmlhcyAqLworCXZsdl9wdW5pdF9nZXQoaTkxNSk7CisKKwl2YWwgPSBWTFZfT1ZFUlJJ
REVfRU4gfCBWTFZfU09DX1REUF9FTiB8IENIVl9CSUFTX0NQVV81MF9TT0NfNTA7CisJdmx2X3B1
bml0X3dyaXRlKGk5MTUsIFZMVl9UVVJCT19TT0NfT1ZFUlJJREUsIHZhbCk7CisKKwl2YWwgPSB2
bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTKTsKKworCXZsdl9wdW5p
dF9wdXQoaTkxNSk7CisKKwkvKiBSUFMgY29kZSBhc3N1bWVzIEdQTEwgaXMgdXNlZCAqLworCVdB
Uk5fT05DRSgodmFsICYgR1BMTEVOQUJMRSkgPT0gMCwgIkdQTEwgbm90IGVuYWJsZWRcbiIpOwor
CisJRFJNX0RFQlVHX0RSSVZFUigiR1BMTCBlbmFibGVkPyAlc1xuIiwgeWVzbm8odmFsICYgR1BM
TEVOQUJMRSkpOworCURSTV9ERUJVR19EUklWRVIoIkdQVSBzdGF0dXM6IDB4JTA4eFxuIiwgdmFs
KTsKKworCXJldHVybiBycHNfcmVzZXQocnBzKTsKK30KKworc3RhdGljIGludCB2bHZfcnBzX2d1
YXJfZnJlcShzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOworCXUzMiB2YWwsIHJwMTsKKworCXZhbCA9IHZs
dl9uY19yZWFkKGk5MTUsIElPU0ZfTkNfRkJfR0ZYX0ZSRVFfRlVTRSk7CisKKwlycDEgPSB2YWwg
JiBGQl9HRlhfRkdVQVJBTlRFRURfRlJFUV9GVVNFX01BU0s7CisJcnAxID4+PSBGQl9HRlhfRkdV
QVJBTlRFRURfRlJFUV9GVVNFX1NISUZUOworCisJcmV0dXJuIHJwMTsKK30KKworc3RhdGljIGlu
dCB2bHZfcnBzX21heF9mcmVxKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7CisJdTMyIHZhbCwgcnAwOwor
CisJdmFsID0gdmx2X25jX3JlYWQoaTkxNSwgSU9TRl9OQ19GQl9HRlhfRlJFUV9GVVNFKTsKKwor
CXJwMCA9ICh2YWwgJiBGQl9HRlhfTUFYX0ZSRVFfRlVTRV9NQVNLKSA+PiBGQl9HRlhfTUFYX0ZS
RVFfRlVTRV9TSElGVDsKKwkvKiBDbGFtcCB0byBtYXggKi8KKwlycDAgPSBtaW5fdCh1MzIsIHJw
MCwgMHhlYSk7CisKKwlyZXR1cm4gcnAwOworfQorCitzdGF0aWMgaW50IHZsdl9ycHNfcnBlX2Zy
ZXEoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKwl1MzIgdmFsLCBycGU7CisKKwl2YWwgPSB2bHZfbmNf
cmVhZChpOTE1LCBJT1NGX05DX0ZCX0dGWF9GTUFYX0ZVU0VfTE8pOworCXJwZSA9ICh2YWwgJiBG
Ql9GTUFYX1ZNSU5fRlJFUV9MT19NQVNLKSA+PiBGQl9GTUFYX1ZNSU5fRlJFUV9MT19TSElGVDsK
Kwl2YWwgPSB2bHZfbmNfcmVhZChpOTE1LCBJT1NGX05DX0ZCX0dGWF9GTUFYX0ZVU0VfSEkpOwor
CXJwZSB8PSAodmFsICYgRkJfRk1BWF9WTUlOX0ZSRVFfSElfTUFTSykgPDwgNTsKKworCXJldHVy
biBycGU7Cit9CisKK3N0YXRpYyBpbnQgdmx2X3Jwc19taW5fZnJlcShzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShy
cHMpOworCXUzMiB2YWw7CisKKwl2YWwgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdf
R1BVX0xGTSkgJiAweGZmOworCS8qCisJICogQWNjb3JkaW5nIHRvIHRoZSBCWVQgUHVuaXQgR1BV
IHR1cmJvIEhBUyAxLjEuNi4zIHRoZSBtaW5pbXVtIHZhbHVlCisJICogZm9yIHRoZSBtaW5pbXVt
IGZyZXF1ZW5jeSBpbiBHUExMIG1vZGUgaXMgMHhjMS4gQ29udHJhcnkgdG8gdGhpcyBvbgorCSAq
IGEgQllULU0gQjAgdGhlIGFib3ZlIHJlZ2lzdGVyIGNvbnRhaW5zIDB4YmYuIE1vcmVvdmVyIHdo
ZW4gc2V0dGluZworCSAqIGEgZnJlcXVlbmN5IFB1bml0IHdpbGwgbm90IGFsbG93IHZhbHVlcyBi
ZWxvdyAweGMwLiBDbGFtcCBpdCAweGMwCisJICogdG8gbWFrZSBzdXJlIGl0IG1hdGNoZXMgd2hh
dCBQdW5pdCBhY2NlcHRzLgorCSAqLworCXJldHVybiBtYXhfdCh1MzIsIHZhbCwgMHhjMCk7Cit9
CisKK3N0YXRpYyBib29sIHZsdl9ycHNfZW5hYmxlKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sK
KwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBycHNfdG9fdW5jb3JlKHJwcyk7CisJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOworCXUzMiB2YWw7
CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JQX0RPV05fVElNRU9VVCwg
MTAwMDAwMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SUF9VUF9USFJF
U0hPTEQsIDU5NDAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JQX0RP
V05fVEhSRVNIT0xELCAyNDUwMDApOworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdF
TjZfUlBfVVBfRUksIDY2MDAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42
X1JQX0RPV05fRUksIDM1MDAwMCk7CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBH
RU42X1JQX0lETEVfSFlTVEVSU0lTLCAxMCk7CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5j
b3JlLCBHRU42X1JQX0NPTlRST0wsCisJCQkgICAgICBHRU42X1JQX01FRElBX1RVUkJPIHwKKwkJ
CSAgICAgIEdFTjZfUlBfTUVESUFfSFdfTk9STUFMX01PREUgfAorCQkJICAgICAgR0VONl9SUF9N
RURJQV9JU19HRlggfAorCQkJICAgICAgR0VONl9SUF9FTkFCTEUgfAorCQkJICAgICAgR0VONl9S
UF9VUF9CVVNZX0FWRyB8CisJCQkgICAgICBHRU42X1JQX0RPV05fSURMRV9DT05UKTsKKworCXZs
dl9wdW5pdF9nZXQoaTkxNSk7CisKKwkvKiBTZXR0aW5nIEZpeGVkIEJpYXMgKi8KKwl2YWwgPSBW
TFZfT1ZFUlJJREVfRU4gfCBWTFZfU09DX1REUF9FTiB8IFZMVl9CSUFTX0NQVV8xMjVfU09DXzg3
NTsKKwl2bHZfcHVuaXRfd3JpdGUoaTkxNSwgVkxWX1RVUkJPX1NPQ19PVkVSUklERSwgdmFsKTsK
KworCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19HUFVfRlJFUV9TVFMpOwor
CisJdmx2X3B1bml0X3B1dChpOTE1KTsKKworCS8qIFJQUyBjb2RlIGFzc3VtZXMgR1BMTCBpcyB1
c2VkICovCisJV0FSTl9PTkNFKCh2YWwgJiBHUExMRU5BQkxFKSA9PSAwLCAiR1BMTCBub3QgZW5h
YmxlZFxuIik7CisKKwlEUk1fREVCVUdfRFJJVkVSKCJHUExMIGVuYWJsZWQ/ICVzXG4iLCB5ZXNu
byh2YWwgJiBHUExMRU5BQkxFKSk7CisJRFJNX0RFQlVHX0RSSVZFUigiR1BVIHN0YXR1czogMHgl
MDh4XG4iLCB2YWwpOworCisJcmV0dXJuIHJwc19yZXNldChycHMpOworfQorCitzdGF0aWMgdW5z
aWduZWQgbG9uZyBfX2lwc19nZnhfdmFsKHN0cnVjdCBpbnRlbF9pcHMgKmlwcykKK3sKKwlzdHJ1
Y3QgaW50ZWxfcnBzICpycHMgPSBjb250YWluZXJfb2YoaXBzLCB0eXBlb2YoKnJwcyksIGlwcyk7
CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcnBzX3RvX3VuY29yZShycHMpOworCXVu
c2lnbmVkIGxvbmcgdCwgY29yciwgc3RhdGUxLCBjb3JyMiwgc3RhdGUyOworCXUzMiBweHZpZCwg
ZXh0X3Y7CisKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZtY2hkZXZfbG9jayk7CisKKwlweHZpZCA9
IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgUFhWRlJFUShycHMtPmN1cl9mcmVxKSk7CisJcHh2
aWQgPSAocHh2aWQgPj4gMjQpICYgMHg3ZjsKKwlleHRfdiA9IHB2aWRfdG9fZXh0dmlkKHJwc190
b19pOTE1KHJwcyksIHB4dmlkKTsKKworCXN0YXRlMSA9IGV4dF92OworCisJLyogUmV2ZWwgaW4g
dGhlIGVtcGlyaWNhbGx5IGRlcml2ZWQgY29uc3RhbnRzICovCisKKwkvKiBDb3JyZWN0aW9uIGZh
Y3RvciBpbiAxLzEwMDAwMCB1bml0cyAqLworCXQgPSBpcHNfbWNoX3ZhbCh1bmNvcmUpOworCWlm
ICh0ID4gODApCisJCWNvcnIgPSB0ICogMjM0OSArIDEzNTk0MDsKKwllbHNlIGlmICh0ID49IDUw
KQorCQljb3JyID0gdCAqIDk2NCArIDI5MzE3OworCWVsc2UgLyogPCA1MCAqLworCQljb3JyID0g
dCAqIDMwMSArIDEwMDQ7CisKKwljb3JyID0gY29yciAqIDE1MDE0MiAqIHN0YXRlMSAvIDEwMDAw
IC0gNzg2NDI7CisJY29yciAvPSAxMDAwMDA7CisJY29ycjIgPSBjb3JyICogaXBzLT5jb3JyOwor
CisJc3RhdGUyID0gY29ycjIgKiBzdGF0ZTEgLyAxMDAwMDsKKwlzdGF0ZTIgLz0gMTAwOyAvKiBj
b252ZXJ0IHRvIG1XICovCisKKwlfX2dlbjVfaXBzX3VwZGF0ZShpcHMpOworCisJcmV0dXJuIGlw
cy0+Z2Z4X3Bvd2VyICsgc3RhdGUyOworfQorCit2b2lkIGludGVsX3Jwc19lbmFibGUoc3RydWN0
IGludGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcnBz
X3RvX2k5MTUocnBzKTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBycHNfdG9fdW5j
b3JlKHJwcyk7CisKKwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCh1bmNvcmUsIEZPUkNFV0FL
RV9BTEwpOworCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKQorCQlycHMtPmVuYWJsZWQgPSBjaHZf
cnBzX2VuYWJsZShycHMpOworCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCisJCXJwcy0+
ZW5hYmxlZCA9IHZsdl9ycHNfZW5hYmxlKHJwcyk7CisJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDkpCisJCXJwcy0+ZW5hYmxlZCA9IGdlbjlfcnBzX2VuYWJsZShycHMpOworCWVsc2UgaWYg
KElOVEVMX0dFTihpOTE1KSA+PSA4KQorCQlycHMtPmVuYWJsZWQgPSBnZW44X3Jwc19lbmFibGUo
cnBzKTsKKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKKwkJcnBzLT5lbmFibGVkID0g
Z2VuNl9ycHNfZW5hYmxlKHJwcyk7CisJZWxzZSBpZiAoSVNfSVJPTkxBS0VfTShpOTE1KSkKKwkJ
cnBzLT5lbmFibGVkID0gZ2VuNV9ycHNfZW5hYmxlKHJwcyk7CisJaW50ZWxfdW5jb3JlX2ZvcmNl
d2FrZV9wdXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKwlpZiAoIXJwcy0+ZW5hYmxlZCkKKwkJ
cmV0dXJuOworCisJV0FSTl9PTihycHMtPm1heF9mcmVxIDwgcnBzLT5taW5fZnJlcSk7CisJV0FS
Tl9PTihycHMtPmlkbGVfZnJlcSA+IHJwcy0+bWF4X2ZyZXEpOworCisJV0FSTl9PTihycHMtPmVm
ZmljaWVudF9mcmVxIDwgcnBzLT5taW5fZnJlcSk7CisJV0FSTl9PTihycHMtPmVmZmljaWVudF9m
cmVxID4gcnBzLT5tYXhfZnJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGdlbjZfcnBzX2Rpc2FibGUo
c3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCWludGVsX3VuY29yZV93cml0ZShycHNfdG9fdW5j
b3JlKHJwcyksIEdFTjZfUlBfQ09OVFJPTCwgMCk7Cit9CisKK3ZvaWQgaW50ZWxfcnBzX2Rpc2Fi
bGUoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKworCXJwcy0+ZW5hYmxlZCA9IGZhbHNlOworCisJaWYg
KElOVEVMX0dFTihpOTE1KSA+PSA2KQorCQlnZW42X3Jwc19kaXNhYmxlKHJwcyk7CisJZWxzZSBp
ZiAoSVNfSVJPTkxBS0VfTShpOTE1KSkKKwkJZ2VuNV9ycHNfZGlzYWJsZShycHMpOworfQorCitz
dGF0aWMgaW50IGJ5dF9ncHVfZnJlcShzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIGludCB2YWwpCit7
CisJLyoKKwkgKiBOID0gdmFsIC0gMHhiNworCSAqIFNsb3cgPSBGYXN0ID0gR1BMTCByZWYgKiBO
CisJICovCisJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKHJwcy0+Z3BsbF9yZWZfZnJlcSAqICh2
YWwgLSAweGI3KSwgMTAwMCk7Cit9CisKK3N0YXRpYyBpbnQgYnl0X2ZyZXFfb3Bjb2RlKHN0cnVj
dCBpbnRlbF9ycHMgKnJwcywgaW50IHZhbCkKK3sKKwlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1Qo
MTAwMCAqIHZhbCwgcnBzLT5ncGxsX3JlZl9mcmVxKSArIDB4Yjc7Cit9CisKK3N0YXRpYyBpbnQg
Y2h2X2dwdV9mcmVxKHN0cnVjdCBpbnRlbF9ycHMgKnJwcywgaW50IHZhbCkKK3sKKwkvKgorCSAq
IE4gPSB2YWwgLyAyCisJICogQ1UgKHNsb3cpID0gQ1UyeCAoZmFzdCkgLyAyID0gR1BMTCByZWYg
KiBOIC8gMgorCSAqLworCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChycHMtPmdwbGxfcmVmX2Zy
ZXEgKiB2YWwsIDIgKiAyICogMTAwMCk7Cit9CisKK3N0YXRpYyBpbnQgY2h2X2ZyZXFfb3Bjb2Rl
KHN0cnVjdCBpbnRlbF9ycHMgKnJwcywgaW50IHZhbCkKK3sKKwkvKiBDSFYgbmVlZHMgZXZlbiB2
YWx1ZXMgKi8KKwlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QoMiAqIDEwMDAgKiB2YWwsIHJwcy0+
Z3BsbF9yZWZfZnJlcSkgKiAyOworfQorCitpbnQgaW50ZWxfZ3B1X2ZyZXEoc3RydWN0IGludGVs
X3JwcyAqcnBzLCBpbnQgdmFsKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
cnBzX3RvX2k5MTUocnBzKTsKKworCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKKwkJcmV0dXJu
IERJVl9ST1VORF9DTE9TRVNUKHZhbCAqIEdUX0ZSRVFVRU5DWV9NVUxUSVBMSUVSLAorCQkJCQkg
R0VOOV9GUkVRX1NDQUxFUik7CisJZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKKwkJcmV0
dXJuIGNodl9ncHVfZnJlcShycHMsIHZhbCk7CisJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1
KSkKKwkJcmV0dXJuIGJ5dF9ncHVfZnJlcShycHMsIHZhbCk7CisJZWxzZQorCQlyZXR1cm4gdmFs
ICogR1RfRlJFUVVFTkNZX01VTFRJUExJRVI7Cit9CisKK2ludCBpbnRlbF9mcmVxX29wY29kZShz
dHJ1Y3QgaW50ZWxfcnBzICpycHMsIGludCB2YWwpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOworCisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5
KQorCQlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QodmFsICogR0VOOV9GUkVRX1NDQUxFUiwKKwkJ
CQkJIEdUX0ZSRVFVRU5DWV9NVUxUSVBMSUVSKTsKKwllbHNlIGlmIChJU19DSEVSUllWSUVXKGk5
MTUpKQorCQlyZXR1cm4gY2h2X2ZyZXFfb3Bjb2RlKHJwcywgdmFsKTsKKwllbHNlIGlmIChJU19W
QUxMRVlWSUVXKGk5MTUpKQorCQlyZXR1cm4gYnl0X2ZyZXFfb3Bjb2RlKHJwcywgdmFsKTsKKwll
bHNlCisJCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVCh2YWwsIEdUX0ZSRVFVRU5DWV9NVUxUSVBM
SUVSKTsKK30KKworc3RhdGljIHZvaWQgdmx2X2luaXRfZ3BsbF9yZWZfZnJlcShzdHJ1Y3QgaW50
ZWxfcnBzICpycHMpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9f
aTkxNShycHMpOworCisJcnBzLT5ncGxsX3JlZl9mcmVxID0KKwkJdmx2X2dldF9jY2tfY2xvY2so
aTkxNSwgIkdQTEwgcmVmIiwKKwkJCQkgIENDS19HUExMX0NMT0NLX0NPTlRST0wsCisJCQkJICBp
OTE1LT5jemNsa19mcmVxKTsKKworCURSTV9ERUJVR19EUklWRVIoIkdQTEwgcmVmZXJlbmNlIGZy
ZXE6ICVkIGtIelxuIiwgcnBzLT5ncGxsX3JlZl9mcmVxKTsKK30KKworc3RhdGljIHZvaWQgdmx2
X3Jwc19pbml0KHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7CisJdTMyIHZhbDsKKworCXZsdl9pb3NmX3Ni
X2dldChpOTE1LAorCQkJQklUKFZMVl9JT1NGX1NCX1BVTklUKSB8CisJCQlCSVQoVkxWX0lPU0Zf
U0JfTkMpIHwKKwkJCUJJVChWTFZfSU9TRl9TQl9DQ0spKTsKKworCXZsdl9pbml0X2dwbGxfcmVm
X2ZyZXEocnBzKTsKKworCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19HUFVf
RlJFUV9TVFMpOworCXN3aXRjaCAoKHZhbCA+PiA2KSAmIDMpIHsKKwljYXNlIDA6CisJY2FzZSAx
OgorCQlpOTE1LT5tZW1fZnJlcSA9IDgwMDsKKwkJYnJlYWs7CisJY2FzZSAyOgorCQlpOTE1LT5t
ZW1fZnJlcSA9IDEwNjY7CisJCWJyZWFrOworCWNhc2UgMzoKKwkJaTkxNS0+bWVtX2ZyZXEgPSAx
MzMzOworCQlicmVhazsKKwl9CisJRFJNX0RFQlVHX0RSSVZFUigiRERSIHNwZWVkOiAlZCBNSHpc
biIsIGk5MTUtPm1lbV9mcmVxKTsKKworCXJwcy0+bWF4X2ZyZXEgPSB2bHZfcnBzX21heF9mcmVx
KHJwcyk7CisJcnBzLT5ycDBfZnJlcSA9IHJwcy0+bWF4X2ZyZXE7CisJRFJNX0RFQlVHX0RSSVZF
UigibWF4IEdQVSBmcmVxOiAlZCBNSHogKCV1KVxuIiwKKwkJCSBpbnRlbF9ncHVfZnJlcShycHMs
IHJwcy0+bWF4X2ZyZXEpLAorCQkJIHJwcy0+bWF4X2ZyZXEpOworCisJcnBzLT5lZmZpY2llbnRf
ZnJlcSA9IHZsdl9ycHNfcnBlX2ZyZXEocnBzKTsKKwlEUk1fREVCVUdfRFJJVkVSKCJSUGUgR1BV
IGZyZXE6ICVkIE1IeiAoJXUpXG4iLAorCQkJIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5lZmZp
Y2llbnRfZnJlcSksCisJCQkgcnBzLT5lZmZpY2llbnRfZnJlcSk7CisKKwlycHMtPnJwMV9mcmVx
ID0gdmx2X3Jwc19ndWFyX2ZyZXEocnBzKTsKKwlEUk1fREVCVUdfRFJJVkVSKCJSUDEoR3VhciBG
cmVxKSBHUFUgZnJlcTogJWQgTUh6ICgldSlcbiIsCisJCQkgaW50ZWxfZ3B1X2ZyZXEocnBzLCBy
cHMtPnJwMV9mcmVxKSwKKwkJCSBycHMtPnJwMV9mcmVxKTsKKworCXJwcy0+bWluX2ZyZXEgPSB2
bHZfcnBzX21pbl9mcmVxKHJwcyk7CisJRFJNX0RFQlVHX0RSSVZFUigibWluIEdQVSBmcmVxOiAl
ZCBNSHogKCV1KVxuIiwKKwkJCSBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXEpLAor
CQkJIHJwcy0+bWluX2ZyZXEpOworCisJdmx2X2lvc2Zfc2JfcHV0KGk5MTUsCisJCQlCSVQoVkxW
X0lPU0ZfU0JfUFVOSVQpIHwKKwkJCUJJVChWTFZfSU9TRl9TQl9OQykgfAorCQkJQklUKFZMVl9J
T1NGX1NCX0NDSykpOworfQorCitzdGF0aWMgdm9pZCBjaHZfcnBzX2luaXQoc3RydWN0IGludGVs
X3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcnBzX3RvX2k5
MTUocnBzKTsKKwl1MzIgdmFsOworCisJdmx2X2lvc2Zfc2JfZ2V0KGk5MTUsCisJCQlCSVQoVkxW
X0lPU0ZfU0JfUFVOSVQpIHwKKwkJCUJJVChWTFZfSU9TRl9TQl9OQykgfAorCQkJQklUKFZMVl9J
T1NGX1NCX0NDSykpOworCisJdmx2X2luaXRfZ3BsbF9yZWZfZnJlcShycHMpOworCisJdmFsID0g
dmx2X2Nja19yZWFkKGk5MTUsIENDS19GVVNFX1JFRyk7CisKKwlzd2l0Y2ggKCh2YWwgPj4gMikg
JiAweDcpIHsKKwljYXNlIDM6CisJCWk5MTUtPm1lbV9mcmVxID0gMjAwMDsKKwkJYnJlYWs7CisJ
ZGVmYXVsdDoKKwkJaTkxNS0+bWVtX2ZyZXEgPSAxNjAwOworCQlicmVhazsKKwl9CisJRFJNX0RF
QlVHX0RSSVZFUigiRERSIHNwZWVkOiAlZCBNSHpcbiIsIGk5MTUtPm1lbV9mcmVxKTsKKworCXJw
cy0+bWF4X2ZyZXEgPSBjaHZfcnBzX21heF9mcmVxKHJwcyk7CisJcnBzLT5ycDBfZnJlcSA9IHJw
cy0+bWF4X2ZyZXE7CisJRFJNX0RFQlVHX0RSSVZFUigibWF4IEdQVSBmcmVxOiAlZCBNSHogKCV1
KVxuIiwKKwkJCSBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpLAorCQkJIHJwcy0+
bWF4X2ZyZXEpOworCisJcnBzLT5lZmZpY2llbnRfZnJlcSA9IGNodl9ycHNfcnBlX2ZyZXEocnBz
KTsKKwlEUk1fREVCVUdfRFJJVkVSKCJSUGUgR1BVIGZyZXE6ICVkIE1IeiAoJXUpXG4iLAorCQkJ
IGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5lZmZpY2llbnRfZnJlcSksCisJCQkgcnBzLT5lZmZp
Y2llbnRfZnJlcSk7CisKKwlycHMtPnJwMV9mcmVxID0gY2h2X3Jwc19ndWFyX2ZyZXEocnBzKTsK
KwlEUk1fREVCVUdfRFJJVkVSKCJSUDEoR3VhcikgR1BVIGZyZXE6ICVkIE1IeiAoJXUpXG4iLAor
CQkJIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5ycDFfZnJlcSksCisJCQkgcnBzLT5ycDFfZnJl
cSk7CisKKwlycHMtPm1pbl9mcmVxID0gY2h2X3Jwc19taW5fZnJlcShycHMpOworCURSTV9ERUJV
R19EUklWRVIoIm1pbiBHUFUgZnJlcTogJWQgTUh6ICgldSlcbiIsCisJCQkgaW50ZWxfZ3B1X2Zy
ZXEocnBzLCBycHMtPm1pbl9mcmVxKSwKKwkJCSBycHMtPm1pbl9mcmVxKTsKKworCXZsdl9pb3Nm
X3NiX3B1dChpOTE1LAorCQkJQklUKFZMVl9JT1NGX1NCX1BVTklUKSB8CisJCQlCSVQoVkxWX0lP
U0ZfU0JfTkMpIHwKKwkJCUJJVChWTFZfSU9TRl9TQl9DQ0spKTsKKworCVdBUk5fT05DRSgocnBz
LT5tYXhfZnJlcSB8IHJwcy0+ZWZmaWNpZW50X2ZyZXEgfCBycHMtPnJwMV9mcmVxIHwKKwkJICAg
cnBzLT5taW5fZnJlcSkgJiAxLAorCQkgICJPZGQgR1BVIGZyZXEgdmFsdWVzXG4iKTsKK30KKwor
c3RhdGljIHZvaWQgdmx2X2MwX3JlYWQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLCBzdHJ1
Y3QgaW50ZWxfcnBzX2VpICplaSkKK3sKKwllaS0+a3RpbWUgPSBrdGltZV9nZXRfcmF3KCk7CisJ
ZWktPnJlbmRlcl9jMCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgVkxWX1JFTkRFUl9DMF9D
T1VOVCk7CisJZWktPm1lZGlhX2MwID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBWTFZfTUVE
SUFfQzBfQ09VTlQpOworfQorCitzdGF0aWMgdTMyIHZsdl93YV9jMF9laShzdHJ1Y3QgaW50ZWxf
cnBzICpycHMsIHUzMiBwbV9paXIpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0g
cnBzX3RvX3VuY29yZShycHMpOworCWNvbnN0IHN0cnVjdCBpbnRlbF9ycHNfZWkgKnByZXYgPSAm
cnBzLT5laTsKKwlzdHJ1Y3QgaW50ZWxfcnBzX2VpIG5vdzsKKwl1MzIgZXZlbnRzID0gMDsKKwor
CWlmICgocG1faWlyICYgR0VONl9QTV9SUF9VUF9FSV9FWFBJUkVEKSA9PSAwKQorCQlyZXR1cm4g
MDsKKworCXZsdl9jMF9yZWFkKHVuY29yZSwgJm5vdyk7CisKKwlpZiAocHJldi0+a3RpbWUpIHsK
KwkJdTY0IHRpbWUsIGMwOworCQl1MzIgcmVuZGVyLCBtZWRpYTsKKworCQl0aW1lID0ga3RpbWVf
dXNfZGVsdGEobm93Lmt0aW1lLCBwcmV2LT5rdGltZSk7CisKKwkJdGltZSAqPSBycHNfdG9faTkx
NShycHMpLT5jemNsa19mcmVxOworCisJCS8qIFdvcmtsb2FkIGNhbiBiZSBzcGxpdCBiZXR3ZWVu
IHJlbmRlciArIG1lZGlhLAorCQkgKiBlLmcuIFN3YXBCdWZmZXJzIGJlaW5nIGJsaXR0ZWQgaW4g
WCBhZnRlciBiZWluZyByZW5kZXJlZCBpbgorCQkgKiBtZXNhLiBUbyBhY2NvdW50IGZvciB0aGlz
IHdlIG5lZWQgdG8gY29tYmluZSBib3RoIGVuZ2luZXMKKwkJICogaW50byBvdXIgYWN0aXZpdHkg
Y291bnRlci4KKwkJICovCisJCXJlbmRlciA9IG5vdy5yZW5kZXJfYzAgLSBwcmV2LT5yZW5kZXJf
YzA7CisJCW1lZGlhID0gbm93Lm1lZGlhX2MwIC0gcHJldi0+bWVkaWFfYzA7CisJCWMwID0gbWF4
KHJlbmRlciwgbWVkaWEpOworCQljMCAqPSAxMDAwICogMTAwIDw8IDg7IC8qIHRvIHVzZWNzIGFu
ZCBzY2FsZSB0byB0aHJlc2hvbGQlICovCisKKwkJaWYgKGMwID4gdGltZSAqIHJwcy0+cG93ZXIu
dXBfdGhyZXNob2xkKQorCQkJZXZlbnRzID0gR0VONl9QTV9SUF9VUF9USFJFU0hPTEQ7CisJCWVs
c2UgaWYgKGMwIDwgdGltZSAqIHJwcy0+cG93ZXIuZG93bl90aHJlc2hvbGQpCisJCQlldmVudHMg
PSBHRU42X1BNX1JQX0RPV05fVEhSRVNIT0xEOworCX0KKworCXJwcy0+ZWkgPSBub3c7CisJcmV0
dXJuIGV2ZW50czsKK30KKworc3RhdGljIHZvaWQgcnBzX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0
ICp3b3JrKQoreworCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9IGNvbnRhaW5lcl9vZih3b3JrLCB0
eXBlb2YoKnJwcyksIHdvcmspOworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBycHNfdG9fZ3QocnBz
KTsKKwlib29sIGNsaWVudF9ib29zdCA9IGZhbHNlOworCWludCBuZXdfZnJlcSwgYWRqLCBtaW4s
IG1heDsKKwl1MzIgcG1faWlyID0gMDsKKworCXNwaW5fbG9ja19pcnEoJmd0LT5pcnFfbG9jayk7
CisJcG1faWlyID0gZmV0Y2hfYW5kX3plcm8oJnJwcy0+cG1faWlyKTsKKwljbGllbnRfYm9vc3Qg
PSBhdG9taWNfcmVhZCgmcnBzLT5udW1fd2FpdGVycyk7CisJc3Bpbl91bmxvY2tfaXJxKCZndC0+
aXJxX2xvY2spOworCisJLyogTWFrZSBzdXJlIHdlIGRpZG4ndCBxdWV1ZSBhbnl0aGluZyB3ZSdy
ZSBub3QgZ29pbmcgdG8gcHJvY2Vzcy4gKi8KKwlpZiAoKHBtX2lpciAmIHJwcy0+cG1fZXZlbnRz
KSA9PSAwICYmICFjbGllbnRfYm9vc3QpCisJCWdvdG8gb3V0OworCisJbXV0ZXhfbG9jaygmcnBz
LT5sb2NrKTsKKworCXBtX2lpciB8PSB2bHZfd2FfYzBfZWkocnBzLCBwbV9paXIpOworCisJYWRq
ID0gcnBzLT5sYXN0X2FkajsKKwluZXdfZnJlcSA9IHJwcy0+Y3VyX2ZyZXE7CisJbWluID0gcnBz
LT5taW5fZnJlcV9zb2Z0bGltaXQ7CisJbWF4ID0gcnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQ7CisJ
aWYgKGNsaWVudF9ib29zdCkKKwkJbWF4ID0gcnBzLT5tYXhfZnJlcTsKKwlpZiAoY2xpZW50X2Jv
b3N0ICYmIG5ld19mcmVxIDwgcnBzLT5ib29zdF9mcmVxKSB7CisJCW5ld19mcmVxID0gcnBzLT5i
b29zdF9mcmVxOworCQlhZGogPSAwOworCX0gZWxzZSBpZiAocG1faWlyICYgR0VONl9QTV9SUF9V
UF9USFJFU0hPTEQpIHsKKwkJaWYgKGFkaiA+IDApCisJCQlhZGogKj0gMjsKKwkJZWxzZSAvKiBD
SFYgbmVlZHMgZXZlbiBlbmNvZGUgdmFsdWVzICovCisJCQlhZGogPSBJU19DSEVSUllWSUVXKGd0
LT5pOTE1KSA/IDIgOiAxOworCisJCWlmIChuZXdfZnJlcSA+PSBycHMtPm1heF9mcmVxX3NvZnRs
aW1pdCkKKwkJCWFkaiA9IDA7CisJfSBlbHNlIGlmIChjbGllbnRfYm9vc3QpIHsKKwkJYWRqID0g
MDsKKwl9IGVsc2UgaWYgKHBtX2lpciAmIEdFTjZfUE1fUlBfRE9XTl9USU1FT1VUKSB7CisJCWlm
IChycHMtPmN1cl9mcmVxID4gcnBzLT5lZmZpY2llbnRfZnJlcSkKKwkJCW5ld19mcmVxID0gcnBz
LT5lZmZpY2llbnRfZnJlcTsKKwkJZWxzZSBpZiAocnBzLT5jdXJfZnJlcSA+IHJwcy0+bWluX2Zy
ZXFfc29mdGxpbWl0KQorCQkJbmV3X2ZyZXEgPSBycHMtPm1pbl9mcmVxX3NvZnRsaW1pdDsKKwkJ
YWRqID0gMDsKKwl9IGVsc2UgaWYgKHBtX2lpciAmIEdFTjZfUE1fUlBfRE9XTl9USFJFU0hPTEQp
IHsKKwkJaWYgKGFkaiA8IDApCisJCQlhZGogKj0gMjsKKwkJZWxzZSAvKiBDSFYgbmVlZHMgZXZl
biBlbmNvZGUgdmFsdWVzICovCisJCQlhZGogPSBJU19DSEVSUllWSUVXKGd0LT5pOTE1KSA/IC0y
IDogLTE7CisKKwkJaWYgKG5ld19mcmVxIDw9IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KQorCQkJ
YWRqID0gMDsKKwl9IGVsc2UgeyAvKiB1bmtub3duIGV2ZW50ICovCisJCWFkaiA9IDA7CisJfQor
CisJcnBzLT5sYXN0X2FkaiA9IGFkajsKKworCS8qCisJICogTGltaXQgZGVib29zdGluZyBhbmQg
Ym9vc3RpbmcgdG8ga2VlcCBvdXJzZWx2ZXMgYXQgdGhlIGV4dHJlbWVzCisJICogd2hlbiBpbiB0
aGUgcmVzcGVjdGl2ZSBwb3dlciBtb2RlcyAoaS5lLiBzbG93bHkgZGVjcmVhc2UgZnJlcXVlbmNp
ZXMKKwkgKiB3aGlsZSBpbiB0aGUgSElHSF9QT1dFUiB6b25lIGFuZCBzbG93bHkgaW5jcmVhc2Ug
ZnJlcXVlbmNpZXMgd2hpbGUKKwkgKiBpbiB0aGUgTE9XX1BPV0VSIHpvbmUpLiBPbiBpZGxlLCB3
ZSB3aWxsIGhpdCB0aGUgdGltZW91dCBhbmQgZHJvcAorCSAqIHRvIHRoZSBuZXh0IGxldmVsIHF1
aWNrbHksIGFuZCBjb252ZXJzZWx5IGlmIGJ1c3kgd2UgZXhwZWN0IHRvCisJICogaGl0IGEgd2Fp
dGJvb3N0IGFuZCByYXBpZGx5IHN3aXRjaCBpbnRvIG1heCBwb3dlci4KKwkgKi8KKwlpZiAoKGFk
aiA8IDAgJiYgcnBzLT5wb3dlci5tb2RlID09IEhJR0hfUE9XRVIpIHx8CisJICAgIChhZGogPiAw
ICYmIHJwcy0+cG93ZXIubW9kZSA9PSBMT1dfUE9XRVIpKQorCQlycHMtPmxhc3RfYWRqID0gMDsK
KworCS8qIHN5c2ZzIGZyZXF1ZW5jeSBpbnRlcmZhY2VzIG1heSBoYXZlIHNudWNrIGluIHdoaWxl
IHNlcnZpY2luZyB0aGUKKwkgKiBpbnRlcnJ1cHQKKwkgKi8KKwluZXdfZnJlcSArPSBhZGo7CisJ
bmV3X2ZyZXEgPSBjbGFtcF90KGludCwgbmV3X2ZyZXEsIG1pbiwgbWF4KTsKKworCWlmIChpbnRl
bF9ycHNfc2V0KHJwcywgbmV3X2ZyZXEpKSB7CisJCURSTV9ERUJVR19EUklWRVIoIkZhaWxlZCB0
byBzZXQgbmV3IEdQVSBmcmVxdWVuY3lcbiIpOworCQlycHMtPmxhc3RfYWRqID0gMDsKKwl9CisK
KwltdXRleF91bmxvY2soJnJwcy0+bG9jayk7CisKK291dDoKKwlzcGluX2xvY2tfaXJxKCZndC0+
aXJxX2xvY2spOworCWdlbjZfZ3RfcG1fdW5tYXNrX2lycShndCwgcnBzLT5wbV9ldmVudHMpOwor
CXNwaW5fdW5sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKK30KKwordm9pZCBnZW4xMV9ycHNfaXJx
X2hhbmRsZXIoc3RydWN0IGludGVsX3JwcyAqcnBzLCB1MzIgcG1faWlyKQoreworCXN0cnVjdCBp
bnRlbF9ndCAqZ3QgPSBycHNfdG9fZ3QocnBzKTsKKwljb25zdCB1MzIgZXZlbnRzID0gcnBzLT5w
bV9ldmVudHMgJiBwbV9paXI7CisKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZndC0+aXJxX2xvY2sp
OworCisJaWYgKHVubGlrZWx5KCFldmVudHMpKQorCQlyZXR1cm47CisKKwlnZW42X2d0X3BtX21h
c2tfaXJxKGd0LCBldmVudHMpOworCisJcnBzLT5wbV9paXIgfD0gZXZlbnRzOworCXNjaGVkdWxl
X3dvcmsoJnJwcy0+d29yayk7Cit9CisKK3ZvaWQgZ2VuNl9ycHNfaXJxX2hhbmRsZXIoc3RydWN0
IGludGVsX3JwcyAqcnBzLCB1MzIgcG1faWlyKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKworCWlmIChwbV9paXIgJiBycHMtPnBtX2V2ZW50
cykgeworCQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gcnBzX3RvX2d0KHJwcyk7CisKKwkJc3Bpbl9s
b2NrKCZndC0+aXJxX2xvY2spOworCQlnZW42X2d0X3BtX21hc2tfaXJxKGd0LCBwbV9paXIgJiBy
cHMtPnBtX2V2ZW50cyk7CisJCXJwcy0+cG1faWlyIHw9IHBtX2lpciAmIHJwcy0+cG1fZXZlbnRz
OworCQlzY2hlZHVsZV93b3JrKCZycHMtPndvcmspOworCQlzcGluX3VubG9jaygmZ3QtPmlycV9s
b2NrKTsKKwl9CisKKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpCisJCXJldHVybjsKKworCWlm
IChwbV9paXIgJiBQTV9WRUJPWF9VU0VSX0lOVEVSUlVQVCkKKwkJaW50ZWxfZW5naW5lX2JyZWFk
Y3J1bWJzX2lycShpOTE1LT5lbmdpbmVbVkVDUzBdKTsKKworCWlmIChwbV9paXIgJiBQTV9WRUJP
WF9DU19FUlJPUl9JTlRFUlJVUFQpCisJCURSTV9ERUJVRygiQ29tbWFuZCBwYXJzZXIgZXJyb3Is
IHBtX2lpciAweCUwOHhcbiIsIHBtX2lpcik7Cit9CisKK3ZvaWQgZ2VuNV9ycHNfaXJxX2hhbmRs
ZXIoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29y
ZSA9IHJwc190b191bmNvcmUocnBzKTsKKwl1MzIgYnVzeV91cCwgYnVzeV9kb3duLCBtYXhfYXZn
LCBtaW5fYXZnOworCXU4IG5ld19mcmVxOworCisJc3Bpbl9sb2NrKCZtY2hkZXZfbG9jayk7CisK
KwlpbnRlbF91bmNvcmVfd3JpdGUxNih1bmNvcmUsCisJCQkgICAgIE1FTUlOVFJTVFMsCisJCQkg
ICAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgTUVNSU5UUlNUUykpOworCisJaW50ZWxfdW5j
b3JlX3dyaXRlMTYodW5jb3JlLCBNRU1JTlRSU1RTLCBNRU1JTlRfRVZBTF9DSEcpOworCWJ1c3lf
dXAgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFJDUFJFVkJTWVRVUEFWRyk7CisJYnVzeV9k
b3duID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBSQ1BSRVZCU1lURE5BVkcpOworCW1heF9h
dmcgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFJDQk1BWEFWRyk7CisJbWluX2F2ZyA9IGlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgUkNCTUlOQVZHKTsKKworCS8qIEhhbmRsZSBSQ1MgY2hh
bmdlIHJlcXVlc3QgZnJvbSBodyAqLworCW5ld19mcmVxID0gcnBzLT5jdXJfZnJlcTsKKwlpZiAo
YnVzeV91cCA+IG1heF9hdmcpCisJCW5ld19mcmVxKys7CisJZWxzZSBpZiAoYnVzeV9kb3duIDwg
bWluX2F2ZykKKwkJbmV3X2ZyZXEtLTsKKwluZXdfZnJlcSA9IGNsYW1wKG5ld19mcmVxLAorCQkJ
IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0LAorCQkJIHJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0KTsK
KworCWlmIChuZXdfZnJlcSAhPSBycHMtPmN1cl9mcmVxICYmIGdlbjVfcnBzX3NldChycHMsIG5l
d19mcmVxKSkKKwkJcnBzLT5jdXJfZnJlcSA9IG5ld19mcmVxOworCisJc3Bpbl91bmxvY2soJm1j
aGRldl9sb2NrKTsKK30KKwordm9pZCBpbnRlbF9ycHNfaW5pdChzdHJ1Y3QgaW50ZWxfcnBzICpy
cHMpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMp
OworCisJbXV0ZXhfaW5pdCgmcnBzLT5sb2NrKTsKKwltdXRleF9pbml0KCZycHMtPnBvd2VyLm11
dGV4KTsKKworCUlOSVRfV09SSygmcnBzLT53b3JrLCBycHNfd29yayk7CisKKwlhdG9taWNfc2V0
KCZycHMtPm51bV93YWl0ZXJzLCAwKTsKKworCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKQorCQlj
aHZfcnBzX2luaXQocnBzKTsKKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQorCQl2bHZf
cnBzX2luaXQocnBzKTsKKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKKwkJZ2VuNl9y
cHNfaW5pdChycHMpOworCWVsc2UgaWYgKElTX0lST05MQUtFX00oaTkxNSkpCisJCWdlbjVfcnBz
X2luaXQocnBzKTsKKworCS8qIERlcml2ZSBpbml0aWFsIHVzZXIgcHJlZmVyZW5jZXMvbGltaXRz
IGZyb20gdGhlIGhhcmR3YXJlIGxpbWl0cyAqLworCXJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0ID0g
cnBzLT5tYXhfZnJlcTsKKwlycHMtPm1pbl9mcmVxX3NvZnRsaW1pdCA9IHJwcy0+bWluX2ZyZXE7
CisKKwkvKiBBZnRlciBzZXR0aW5nIG1heC1zb2Z0bGltaXQsIGZpbmQgdGhlIG92ZXJjbG9jayBt
YXggZnJlcSAqLworCWlmIChJU19HRU4oaTkxNSwgNikgfHwgSVNfSVZZQlJJREdFKGk5MTUpIHx8
IElTX0hBU1dFTEwoaTkxNSkpIHsKKwkJdTMyIHBhcmFtcyA9IDA7CisKKwkJc2FuZHlicmlkZ2Vf
cGNvZGVfcmVhZChpOTE1LCBHRU42X1JFQURfT0NfUEFSQU1TLAorCQkJCSAgICAgICAmcGFyYW1z
LCBOVUxMKTsKKwkJaWYgKHBhcmFtcyAmIEJJVCgzMSkpIHsgLyogT0Mgc3VwcG9ydGVkICovCisJ
CQlEUk1fREVCVUdfRFJJVkVSKCJPdmVyY2xvY2tpbmcgc3VwcG9ydGVkLCBtYXg6ICVkTUh6LCBv
dmVyY2xvY2s6ICVkTUh6XG4iLAorCQkJCQkgKHJwcy0+bWF4X2ZyZXEgJiAweGZmKSAqIDUwLAor
CQkJCQkgKHBhcmFtcyAmIDB4ZmYpICogNTApOworCQkJcnBzLT5tYXhfZnJlcSA9IHBhcmFtcyAm
IDB4ZmY7CisJCX0KKwl9CisKKwkvKiBGaW5hbGx5IGFsbG93IHVzIHRvIGJvb3N0IHRvIG1heCBi
eSBkZWZhdWx0ICovCisJcnBzLT5ib29zdF9mcmVxID0gcnBzLT5tYXhfZnJlcTsKKwlycHMtPmlk
bGVfZnJlcSA9IHJwcy0+bWluX2ZyZXE7CisJcnBzLT5jdXJfZnJlcSA9IHJwcy0+aWRsZV9mcmVx
OworCisJcnBzLT5wbV9pbnRybXNrX21ieiA9IDA7CisKKwkvKgorCSAqIFNOQixJVkIsSFNXIGNh
biB3aGlsZSBWTFYsQ0hWIG1heSBoYXJkIGhhbmcgb24gbG9vcGluZyBiYXRjaGJ1ZmZlcgorCSAq
IGlmIEdFTjZfUE1fVVBfRUlfRVhQSVJFRCBpcyBtYXNrZWQuCisJICoKKwkgKiBUT0RPOiB2ZXJp
ZnkgaWYgdGhpcyBjYW4gYmUgcmVwcm9kdWNlZCBvbiBWTFYsQ0hWLgorCSAqLworCWlmIChJTlRF
TF9HRU4oaTkxNSkgPD0gNykKKwkJcnBzLT5wbV9pbnRybXNrX21ieiB8PSBHRU42X1BNX1JQX1VQ
X0VJX0VYUElSRUQ7CisKKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpCisJCXJwcy0+cG1faW50
cm1za19tYnogfD0gR0VOOF9QTUlOVFJfRElTQUJMRV9SRURJUkVDVF9UT19HVUM7Cit9CisKK3Uz
MiBpbnRlbF9nZXRfY2FnZihzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIHUzMiBycHN0YXQpCit7CisJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOworCXUzMiBj
YWdmOworCisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQorCQljYWdmID0gKHJwc3RhdCAmIEdF
TjlfQ0FHRl9NQVNLKSA+PiBHRU45X0NBR0ZfU0hJRlQ7CisJZWxzZSBpZiAoSVNfSEFTV0VMTChp
OTE1KSB8fCBJU19CUk9BRFdFTEwoaTkxNSkpCisJCWNhZ2YgPSAocnBzdGF0ICYgSFNXX0NBR0Zf
TUFTSykgPj4gSFNXX0NBR0ZfU0hJRlQ7CisJZWxzZQorCQljYWdmID0gKHJwc3RhdCAmIEdFTjZf
Q0FHRl9NQVNLKSA+PiBHRU42X0NBR0ZfU0hJRlQ7CisKKwlyZXR1cm4gIGNhZ2Y7Cit9CisKKy8q
IEV4dGVybmFsIGludGVyZmFjZSBmb3IgaW50ZWxfaXBzLmtvICovCisKK3N0YXRpYyBzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSBfX3JjdSAqaXBzX21jaGRldjsKKworLyoqCisgKiBUZWxscyB0aGUg
aW50ZWxfaXBzIGRyaXZlciB0aGF0IHRoZSBpOTE1IGRyaXZlciBpcyBub3cgbG9hZGVkLCBpZgor
ICogSVBTIGdvdCBsb2FkZWQgZmlyc3QuCisgKgorICogVGhpcyBhd2t3YXJkIGRhbmNlIGlzIHNv
IHRoYXQgbmVpdGhlciBtb2R1bGUgaGFzIHRvIGRlcGVuZCBvbiB0aGUKKyAqIG90aGVyIGluIG9y
ZGVyIGZvciBJUFMgdG8gZG8gdGhlIGFwcHJvcHJpYXRlIGNvbW11bmljYXRpb24gb2YKKyAqIEdQ
VSB0dXJibyBsaW1pdHMgdG8gaTkxNS4KKyAqLworc3RhdGljIHZvaWQKK2lwc19waW5nX2Zvcl9p
OTE1X2xvYWQodm9pZCkKK3sKKwl2b2lkICgqbGluaykodm9pZCk7CisKKwlsaW5rID0gc3ltYm9s
X2dldChpcHNfbGlua190b19pOTE1X2RyaXZlcik7CisJaWYgKGxpbmspIHsKKwkJbGluaygpOwor
CQlzeW1ib2xfcHV0KGlwc19saW5rX3RvX2k5MTVfZHJpdmVyKTsKKwl9Cit9CisKK3ZvaWQgaW50
ZWxfcnBzX2RyaXZlcl9yZWdpc3RlcihzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJc3RydWN0
IGludGVsX2d0ICpndCA9IHJwc190b19ndChycHMpOworCisJLyoKKwkgKiBXZSBvbmx5IHJlZ2lz
dGVyIHRoZSBpOTE1IGlwcyBwYXJ0IHdpdGggaW50ZWwtaXBzIG9uY2UgZXZlcnl0aGluZyBpcwor
CSAqIHNldCB1cCwgdG8gYXZvaWQgaW50ZWwtaXBzIHNuZWFraW5nIGluIGFuZCByZWFkaW5nIGJv
Z3VzIHZhbHVlcy4KKwkgKi8KKwlyY3VfYXNzaWduX3BvaW50ZXIoaXBzX21jaGRldiwgZ3QtPmk5
MTUpOworCisJaXBzX3BpbmdfZm9yX2k5MTVfbG9hZCgpOworfQorCit2b2lkIGludGVsX3Jwc19k
cml2ZXJfdW5yZWdpc3RlcihzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJcmN1X2Fzc2lnbl9w
b2ludGVyKGlwc19tY2hkZXYsIE5VTEwpOworfQorCitzdGF0aWMgc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKm1jaGRldl9nZXQodm9pZCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NTsKKworCXJjdV9yZWFkX2xvY2soKTsKKwlpOTE1ID0gcmN1X2RlcmVmZXJlbmNlKGlwc19tY2hk
ZXYpOworCWlmICgha3JlZl9nZXRfdW5sZXNzX3plcm8oJmk5MTUtPmRybS5yZWYpKQorCQlpOTE1
ID0gTlVMTDsKKwlyY3VfcmVhZF91bmxvY2soKTsKKworCXJldHVybiBpOTE1OworfQorCisvKioK
KyAqIGk5MTVfcmVhZF9tY2hfdmFsIC0gcmV0dXJuIHZhbHVlIGZvciBJUFMgdXNlCisgKgorICog
Q2FsY3VsYXRlIGFuZCByZXR1cm4gYSB2YWx1ZSBmb3IgdGhlIElQUyBkcml2ZXIgdG8gdXNlIHdo
ZW4gZGVjaWRpbmcgd2hldGhlcgorICogd2UgaGF2ZSB0aGVybWFsIGFuZCBwb3dlciBoZWFkcm9v
bSB0byBpbmNyZWFzZSBDUFUgb3IgR1BVIHBvd2VyIGJ1ZGdldC4KKyAqLwordW5zaWduZWQgbG9u
ZyBpOTE1X3JlYWRfbWNoX3ZhbCh2b2lkKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1OworCXVuc2lnbmVkIGxvbmcgY2hpcHNldF92YWwgPSAwOworCXVuc2lnbmVkIGxvbmcgZ3Jh
cGhpY3NfdmFsID0gMDsKKwlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKKworCWk5MTUgPSBtY2hk
ZXZfZ2V0KCk7CisJaWYgKCFpOTE1KQorCQlyZXR1cm4gMDsKKworCXdpdGhfaW50ZWxfcnVudGlt
ZV9wbSgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZikgeworCQlzdHJ1Y3QgaW50ZWxfaXBzICpp
cHMgPSAmaTkxNS0+Z3QucnBzLmlwczsKKworCQlzcGluX2xvY2tfaXJxKCZtY2hkZXZfbG9jayk7
CisJCWNoaXBzZXRfdmFsID0gX19pcHNfY2hpcHNldF92YWwoaXBzKTsKKwkJZ3JhcGhpY3NfdmFs
ID0gX19pcHNfZ2Z4X3ZhbChpcHMpOworCQlzcGluX3VubG9ja19pcnEoJm1jaGRldl9sb2NrKTsK
Kwl9CisKKwlkcm1fZGV2X3B1dCgmaTkxNS0+ZHJtKTsKKwlyZXR1cm4gY2hpcHNldF92YWwgKyBn
cmFwaGljc192YWw7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChpOTE1X3JlYWRfbWNoX3ZhbCk7CisK
Ky8qKgorICogaTkxNV9ncHVfcmFpc2UgLSByYWlzZSBHUFUgZnJlcXVlbmN5IGxpbWl0CisgKgor
ICogUmFpc2UgdGhlIGxpbWl0OyBJUFMgaW5kaWNhdGVzIHdlIGhhdmUgdGhlcm1hbCBoZWFkcm9v
bS4KKyAqLworYm9vbCBpOTE1X2dwdV9yYWlzZSh2b2lkKQoreworCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1OworCXN0cnVjdCBpbnRlbF9ycHMgKnJwczsKKworCWk5MTUgPSBtY2hkZXZf
Z2V0KCk7CisJaWYgKCFpOTE1KQorCQlyZXR1cm4gZmFsc2U7CisKKwlycHMgPSAmaTkxNS0+Z3Qu
cnBzOworCisJc3Bpbl9sb2NrX2lycSgmbWNoZGV2X2xvY2spOworCWlmIChycHMtPm1heF9mcmVx
X3NvZnRsaW1pdCA8IHJwcy0+bWF4X2ZyZXEpCisJCXJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0Kys7
CisJc3Bpbl91bmxvY2tfaXJxKCZtY2hkZXZfbG9jayk7CisKKwlkcm1fZGV2X3B1dCgmaTkxNS0+
ZHJtKTsKKwlyZXR1cm4gdHJ1ZTsKK30KK0VYUE9SVF9TWU1CT0xfR1BMKGk5MTVfZ3B1X3JhaXNl
KTsKKworLyoqCisgKiBpOTE1X2dwdV9sb3dlciAtIGxvd2VyIEdQVSBmcmVxdWVuY3kgbGltaXQK
KyAqCisgKiBJUFMgaW5kaWNhdGVzIHdlJ3JlIGNsb3NlIHRvIGEgdGhlcm1hbCBsaW1pdCwgc28g
dGhyb3R0bGUgYmFjayB0aGUgR1BVCisgKiBmcmVxdWVuY3kgbWF4aW11bS4KKyAqLworYm9vbCBp
OTE1X2dwdV9sb3dlcih2b2lkKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1Owor
CXN0cnVjdCBpbnRlbF9ycHMgKnJwczsKKworCWk5MTUgPSBtY2hkZXZfZ2V0KCk7CisJaWYgKCFp
OTE1KQorCQlyZXR1cm4gZmFsc2U7CisKKwlycHMgPSAmaTkxNS0+Z3QucnBzOworCisJc3Bpbl9s
b2NrX2lycSgmbWNoZGV2X2xvY2spOworCWlmIChycHMtPm1heF9mcmVxX3NvZnRsaW1pdCA+IHJw
cy0+bWluX2ZyZXEpCisJCXJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0LS07CisJc3Bpbl91bmxvY2tf
aXJxKCZtY2hkZXZfbG9jayk7CisKKwlkcm1fZGV2X3B1dCgmaTkxNS0+ZHJtKTsKKwlyZXR1cm4g
dHJ1ZTsKK30KK0VYUE9SVF9TWU1CT0xfR1BMKGk5MTVfZ3B1X2xvd2VyKTsKKworLyoqCisgKiBp
OTE1X2dwdV9idXN5IC0gaW5kaWNhdGUgR1BVIGJ1c2luZXNzIHRvIElQUworICoKKyAqIFRlbGwg
dGhlIElQUyBkcml2ZXIgd2hldGhlciBvciBub3QgdGhlIEdQVSBpcyBidXN5LgorICovCitib29s
IGk5MTVfZ3B1X2J1c3kodm9pZCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsK
Kwlib29sIHJldDsKKworCWk5MTUgPSBtY2hkZXZfZ2V0KCk7CisJaWYgKCFpOTE1KQorCQlyZXR1
cm4gZmFsc2U7CisKKwlyZXQgPSBpOTE1LT5ndC5hd2FrZTsKKworCWRybV9kZXZfcHV0KCZpOTE1
LT5kcm0pOworCXJldHVybiByZXQ7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChpOTE1X2dwdV9idXN5
KTsKKworLyoqCisgKiBpOTE1X2dwdV90dXJib19kaXNhYmxlIC0gZGlzYWJsZSBncmFwaGljcyB0
dXJibworICoKKyAqIERpc2FibGUgZ3JhcGhpY3MgdHVyYm8gYnkgcmVzZXR0aW5nIHRoZSBtYXgg
ZnJlcXVlbmN5IGFuZCBzZXR0aW5nIHRoZQorICogY3VycmVudCBmcmVxdWVuY3kgdG8gdGhlIGRl
ZmF1bHQuCisgKi8KK2Jvb2wgaTkxNV9ncHVfdHVyYm9fZGlzYWJsZSh2b2lkKQoreworCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1OworCXN0cnVjdCBpbnRlbF9ycHMgKnJwczsKKwlib29s
IHJldDsKKworCWk5MTUgPSBtY2hkZXZfZ2V0KCk7CisJaWYgKCFpOTE1KQorCQlyZXR1cm4gZmFs
c2U7CisKKwlycHMgPSAmaTkxNS0+Z3QucnBzOworCisJc3Bpbl9sb2NrX2lycSgmbWNoZGV2X2xv
Y2spOworCXJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0ID0gcnBzLT5taW5fZnJlcTsKKwlyZXQgPSBn
ZW41X3Jwc19zZXQoJmk5MTUtPmd0LnJwcywgcnBzLT5taW5fZnJlcSk7CisJc3Bpbl91bmxvY2tf
aXJxKCZtY2hkZXZfbG9jayk7CisKKwlkcm1fZGV2X3B1dCgmaTkxNS0+ZHJtKTsKKwlyZXR1cm4g
cmV0OworfQorRVhQT1JUX1NZTUJPTF9HUEwoaTkxNV9ncHVfdHVyYm9fZGlzYWJsZSk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ycHMuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX3Jwcy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAw
MDAwMDAwMC4uOTk3YTRiNGUwMjA3Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfcnBzLmgKQEAgLTAsMCArMSwzNyBAQAorLyoKKyAqIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBNSVQKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3Jh
dGlvbgorICovCisKKyNpZm5kZWYgSU5URUxfUlBTX0gKKyNkZWZpbmUgSU5URUxfUlBTX0gKKwor
I2luY2x1ZGUgImludGVsX3Jwc190eXBlcy5oIgorCitzdHJ1Y3QgaTkxNV9yZXF1ZXN0OworCit2
b2lkIGludGVsX3Jwc19pbml0KHN0cnVjdCBpbnRlbF9ycHMgKnJwcyk7CisKK3ZvaWQgaW50ZWxf
cnBzX2RyaXZlcl9yZWdpc3RlcihzdHJ1Y3QgaW50ZWxfcnBzICpycHMpOwordm9pZCBpbnRlbF9y
cHNfZHJpdmVyX3VucmVnaXN0ZXIoc3RydWN0IGludGVsX3JwcyAqcnBzKTsKKwordm9pZCBpbnRl
bF9ycHNfZW5hYmxlKHN0cnVjdCBpbnRlbF9ycHMgKnJwcyk7Cit2b2lkIGludGVsX3Jwc19kaXNh
YmxlKHN0cnVjdCBpbnRlbF9ycHMgKnJwcyk7CisKK3ZvaWQgaW50ZWxfcnBzX3Bhcmsoc3RydWN0
IGludGVsX3JwcyAqcnBzKTsKK3ZvaWQgaW50ZWxfcnBzX3VucGFyayhzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMpOwordm9pZCBpbnRlbF9ycHNfYm9vc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpOwor
CitpbnQgaW50ZWxfcnBzX3NldChzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIHU4IHZhbCk7Cit2b2lk
IGludGVsX3Jwc19tYXJrX2ludGVyYWN0aXZlKHN0cnVjdCBpbnRlbF9ycHMgKnJwcywgYm9vbCBp
bnRlcmFjdGl2ZSk7CisKK2ludCBpbnRlbF9ncHVfZnJlcShzdHJ1Y3QgaW50ZWxfcnBzICpycHMs
IGludCB2YWwpOworaW50IGludGVsX2ZyZXFfb3Bjb2RlKHN0cnVjdCBpbnRlbF9ycHMgKnJwcywg
aW50IHZhbCk7Cit1MzIgaW50ZWxfZ2V0X2NhZ2Yoc3RydWN0IGludGVsX3JwcyAqcnBzLCB1MzIg
cnBzdGF0MSk7CisKK3ZvaWQgZ2VuNV9ycHNfaXJxX2hhbmRsZXIoc3RydWN0IGludGVsX3JwcyAq
cnBzKTsKK3ZvaWQgZ2VuNl9ycHNfaXJxX2hhbmRsZXIoc3RydWN0IGludGVsX3JwcyAqcnBzLCB1
MzIgcG1faWlyKTsKK3ZvaWQgZ2VuMTFfcnBzX2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ycHMg
KnJwcywgdTMyIHBtX2lpcik7CisKKyNlbmRpZiAvKiBJTlRFTF9SUFNfSCAqLwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcnBzX3R5cGVzLmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9ycHNfdHlwZXMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRl
eCAwMDAwMDAwMDAwMDAuLjQwZWIxZmI2NTFlNwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX3Jwc190eXBlcy5oCkBAIC0wLDAgKzEsOTMgQEAKKy8qCisg
KiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisgKgorICogQ29weXJpZ2h0IMKpIDIwMTkg
SW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaWZuZGVmIElOVEVMX1JQU19UWVBFU19ICisjZGVm
aW5lIElOVEVMX1JQU19UWVBFU19ICisKKyNpbmNsdWRlIDxsaW51eC9hdG9taWMuaD4KKyNpbmNs
dWRlIDxsaW51eC9rdGltZS5oPgorI2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+CisjaW5jbHVkZSA8
bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxsaW51eC93b3JrcXVldWUuaD4KKworc3RydWN0IGlu
dGVsX2lwcyB7CisJdTY0IGxhc3RfY291bnQxOworCXVuc2lnbmVkIGxvbmcgbGFzdF90aW1lMTsK
Kwl1bnNpZ25lZCBsb25nIGNoaXBzZXRfcG93ZXI7CisJdTY0IGxhc3RfY291bnQyOworCXU2NCBs
YXN0X3RpbWUyOworCXVuc2lnbmVkIGxvbmcgZ2Z4X3Bvd2VyOworCXU4IGNvcnI7CisKKwlpbnQg
YywgbTsKK307CisKK3N0cnVjdCBpbnRlbF9ycHNfZWkgeworCWt0aW1lX3Qga3RpbWU7CisJdTMy
IHJlbmRlcl9jMDsKKwl1MzIgbWVkaWFfYzA7Cit9OworCitzdHJ1Y3QgaW50ZWxfcnBzIHsKKwlz
dHJ1Y3QgbXV0ZXggbG9jazsgLyogcHJvdGVjdHMgZW5hYmxpbmcgYW5kIHRoZSB3b3JrZXIgKi8K
KworCS8qCisJICogd29yaywgaW50ZXJydXB0c19lbmFibGVkIGFuZCBwbV9paXIgYXJlIHByb3Rl
Y3RlZCBieQorCSAqIGRldl9wcml2LT5pcnFfbG9jaworCSAqLworCXN0cnVjdCB3b3JrX3N0cnVj
dCB3b3JrOworCWJvb2wgZW5hYmxlZDsKKwlib29sIGFjdGl2ZTsKKwl1MzIgcG1faWlyOworCisJ
LyogUE0gaW50ZXJydXB0IGJpdHMgdGhhdCBzaG91bGQgbmV2ZXIgYmUgbWFza2VkICovCisJdTMy
IHBtX2ludHJtc2tfbWJ6OworCXUzMiBwbV9ldmVudHM7CisKKwkvKiBGcmVxdWVuY2llcyBhcmUg
c3RvcmVkIGluIHBvdGVudGlhbGx5IHBsYXRmb3JtIGRlcGVuZGVudCBtdWx0aXBsZXMuCisJICog
SW4gb3RoZXIgd29yZHMsICpfZnJlcSBuZWVkcyB0byBiZSBtdWx0aXBsaWVkIGJ5IFggdG8gYmUg
aW50ZXJlc3RpbmcuCisJICogU29mdCBsaW1pdHMgYXJlIHRob3NlIHdoaWNoIGFyZSB1c2VkIGZv
ciB0aGUgZHluYW1pYyByZWNsb2NraW5nIGRvbmUKKwkgKiBieSB0aGUgZHJpdmVyIChyYWlzZSBm
cmVxdWVuY2llcyB1bmRlciBoZWF2eSBsb2FkcywgYW5kIGxvd2VyIGZvcgorCSAqIGxpZ2h0ZXIg
bG9hZHMpLiBIYXJkIGxpbWl0cyBhcmUgdGhvc2UgaW1wb3NlZCBieSB0aGUgaGFyZHdhcmUuCisJ
ICoKKwkgKiBBIGRpc3RpbmN0aW9uIGlzIG1hZGUgZm9yIG92ZXJjbG9ja2luZywgd2hpY2ggaXMg
bmV2ZXIgZW5hYmxlZCBieQorCSAqIGRlZmF1bHQsIGFuZCBpcyBjb25zaWRlcmVkIHRvIGJlIGFi
b3ZlIHRoZSBoYXJkIGxpbWl0IGlmIGl0J3MKKwkgKiBwb3NzaWJsZSBhdCBhbGwuCisJICovCisJ
dTggY3VyX2ZyZXE7CQkvKiBDdXJyZW50IGZyZXF1ZW5jeSAoY2FjaGVkLCBtYXkgbm90ID09IEhX
KSAqLworCXU4IGxhc3RfZnJlcTsJCS8qIExhc3Qgc3dxcmVxIGZyZXF1ZW5jeSAqLworCXU4IG1p
bl9mcmVxX3NvZnRsaW1pdDsJLyogTWluaW11bSBmcmVxdWVuY3kgcGVybWl0dGVkIGJ5IHRoZSBk
cml2ZXIgKi8KKwl1OCBtYXhfZnJlcV9zb2Z0bGltaXQ7CS8qIE1heCBmcmVxdWVuY3kgcGVybWl0
dGVkIGJ5IHRoZSBkcml2ZXIgKi8KKwl1OCBtYXhfZnJlcTsJCS8qIE1heGltdW0gZnJlcXVlbmN5
LCBSUDAgaWYgbm90IG92ZXJjbG9ja2luZyAqLworCXU4IG1pbl9mcmVxOwkJLyogQUtBIFJQbi4g
TWluaW11bSBmcmVxdWVuY3kgKi8KKwl1OCBib29zdF9mcmVxOwkJLyogRnJlcXVlbmN5IHRvIHJl
cXVlc3Qgd2hlbiB3YWl0IGJvb3N0aW5nICovCisJdTggaWRsZV9mcmVxOwkJLyogRnJlcXVlbmN5
IHRvIHJlcXVlc3Qgd2hlbiB3ZSBhcmUgaWRsZSAqLworCXU4IGVmZmljaWVudF9mcmVxOwkvKiBB
S0EgUlBlLiBQcmUtZGV0ZXJtaW5lZCBiYWxhbmNlZCBmcmVxdWVuY3kgKi8KKwl1OCBycDFfZnJl
cTsJCS8qICJsZXNzIHRoYW4iIFJQMCBwb3dlci9mcmVxZW5jeSAqLworCXU4IHJwMF9mcmVxOwkJ
LyogTm9uLW92ZXJjbG9ja2VkIG1heCBmcmVxdWVuY3kuICovCisJdTE2IGdwbGxfcmVmX2ZyZXE7
CS8qIHZsdi9jaHYgR1BMTCByZWZlcmVuY2UgZnJlcXVlbmN5ICovCisKKwlpbnQgbGFzdF9hZGo7
CisKKwlzdHJ1Y3QgeworCQlzdHJ1Y3QgbXV0ZXggbXV0ZXg7CisKKwkJZW51bSB7IExPV19QT1dF
UiwgQkVUV0VFTiwgSElHSF9QT1dFUiB9IG1vZGU7CisJCXVuc2lnbmVkIGludCBpbnRlcmFjdGl2
ZTsKKworCQl1OCB1cF90aHJlc2hvbGQ7IC8qIEN1cnJlbnQgJWJ1c3kgcmVxdWlyZWQgdG8gdXBs
b2NrICovCisJCXU4IGRvd25fdGhyZXNob2xkOyAvKiBDdXJyZW50ICVidXN5IHJlcXVpcmVkIHRv
IGRvd25jbG9jayAqLworCX0gcG93ZXI7CisKKwlhdG9taWNfdCBudW1fd2FpdGVyczsKKwlhdG9t
aWNfdCBib29zdHM7CisKKwkvKiBtYW51YWwgd2EgcmVzaWRlbmN5IGNhbGN1bGF0aW9ucyAqLwor
CXN0cnVjdCBpbnRlbF9ycHNfZWkgZWk7CisJc3RydWN0IGludGVsX2lwcyBpcHM7Cit9OworCisj
ZW5kaWYgLyogSU5URUxfUlBTX1RZUEVTX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3VjL2ludGVsX2d1Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50
ZWxfZ3VjLmMKaW5kZXggODNmMmMxOTczNzVmLi4xOTAyOWMwODQ1NWQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3VjL2ludGVsX2d1Yy5jCkBAIC0yMyw2ICsyMyw4IEBACiAgKi8KIAogI2luY2x1
ZGUgImd0L2ludGVsX2d0LmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxfZ3RfaXJxLmgiCisjaW5jbHVk
ZSAiZ3QvaW50ZWxfZ3RfcG1faXJxLmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3VjLmgiCiAjaW5jbHVk
ZSAiaW50ZWxfZ3VjX2Fkcy5oIgogI2luY2x1ZGUgImludGVsX2d1Y19zdWJtaXNzaW9uLmgiCkBA
IC03NSw2ICs3Nyw5MSBAQCB2b2lkIGludGVsX2d1Y19pbml0X3NlbmRfcmVncyhzdHJ1Y3QgaW50
ZWxfZ3VjICpndWMpCiAJZ3VjLT5zZW5kX3JlZ3MuZndfZG9tYWlucyA9IGZ3X2RvbWFpbnM7CiB9
CiAKK3N0YXRpYyB2b2lkIGdlbjlfcmVzZXRfZ3VjX2ludGVycnVwdHMoc3RydWN0IGludGVsX2d1
YyAqZ3VjKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBndWNfdG9fZ3QoZ3VjKTsKKworCWFz
c2VydF9ycG1fd2FrZWxvY2tfaGVsZCgmZ3QtPmk5MTUtPnJ1bnRpbWVfcG0pOworCisJc3Bpbl9s
b2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKKwlnZW42X2d0X3BtX3Jlc2V0X2lpcihndCwgZ3QtPnBt
X2d1Y19ldmVudHMpOworCXNwaW5fdW5sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKK30KKworc3Rh
dGljIHZvaWQgZ2VuOV9lbmFibGVfZ3VjX2ludGVycnVwdHMoc3RydWN0IGludGVsX2d1YyAqZ3Vj
KQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBndWNfdG9fZ3QoZ3VjKTsKKworCWFzc2VydF9y
cG1fd2FrZWxvY2tfaGVsZCgmZ3QtPmk5MTUtPnJ1bnRpbWVfcG0pOworCisJc3Bpbl9sb2NrX2ly
cSgmZ3QtPmlycV9sb2NrKTsKKwlpZiAoIWd1Yy0+aW50ZXJydXB0cy5lbmFibGVkKSB7CisJCVdB
Uk5fT05fT05DRShpbnRlbF91bmNvcmVfcmVhZChndC0+dW5jb3JlLCBHRU44X0dUX0lJUigyKSkg
JgorCQkJICAgICBndC0+cG1fZ3VjX2V2ZW50cyk7CisJCWd1Yy0+aW50ZXJydXB0cy5lbmFibGVk
ID0gdHJ1ZTsKKwkJZ2VuNl9ndF9wbV9lbmFibGVfaXJxKGd0LCBndC0+cG1fZ3VjX2V2ZW50cyk7
CisJfQorCXNwaW5fdW5sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKK30KKworc3RhdGljIHZvaWQg
Z2VuOV9kaXNhYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKK3sKKwlz
dHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gZ3VjX3RvX2d0KGd1Yyk7CisKKwlhc3NlcnRfcnBtX3dha2Vs
b2NrX2hlbGQoJmd0LT5pOTE1LT5ydW50aW1lX3BtKTsKKworCXNwaW5fbG9ja19pcnEoJmd0LT5p
cnFfbG9jayk7CisJZ3VjLT5pbnRlcnJ1cHRzLmVuYWJsZWQgPSBmYWxzZTsKKworCWdlbjZfZ3Rf
cG1fZGlzYWJsZV9pcnEoZ3QsIGd0LT5wbV9ndWNfZXZlbnRzKTsKKworCXNwaW5fdW5sb2NrX2ly
cSgmZ3QtPmlycV9sb2NrKTsKKwlpbnRlbF9zeW5jaHJvbml6ZV9pcnEoZ3QtPmk5MTUpOworCisJ
Z2VuOV9yZXNldF9ndWNfaW50ZXJydXB0cyhndWMpOworfQorCitzdGF0aWMgdm9pZCBnZW4xMV9y
ZXNldF9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCit7CisJc3RydWN0IGlu
dGVsX2d0ICpndCA9IGd1Y190b19ndChndWMpOworCisJc3Bpbl9sb2NrX2lycSgmZ3QtPmlycV9s
b2NrKTsKKwlnZW4xMV9ndF9yZXNldF9vbmVfaWlyKGd0LCAwLCBHRU4xMV9HVUMpOworCXNwaW5f
dW5sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKK30KKworc3RhdGljIHZvaWQgZ2VuMTFfZW5hYmxl
X2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKK3sKKwlzdHJ1Y3QgaW50ZWxf
Z3QgKmd0ID0gZ3VjX3RvX2d0KGd1Yyk7CisKKwlzcGluX2xvY2tfaXJxKCZndC0+aXJxX2xvY2sp
OworCWlmICghZ3VjLT5pbnRlcnJ1cHRzLmVuYWJsZWQpIHsKKwkJdTMyIGV2ZW50cyA9IFJFR19G
SUVMRF9QUkVQKEVOR0lORTFfTUFTSywgR1VDX0lOVFJfR1VDMkhPU1QpOworCisJCVdBUk5fT05f
T05DRShnZW4xMV9ndF9yZXNldF9vbmVfaWlyKGd0LCAwLCBHRU4xMV9HVUMpKTsKKwkJaW50ZWxf
dW5jb3JlX3dyaXRlKGd0LT51bmNvcmUsIEdFTjExX0dVQ19TR19JTlRSX0VOQUJMRSwgZXZlbnRz
KTsKKwkJaW50ZWxfdW5jb3JlX3dyaXRlKGd0LT51bmNvcmUsIEdFTjExX0dVQ19TR19JTlRSX01B
U0ssIH5ldmVudHMpOworCQlndWMtPmludGVycnVwdHMuZW5hYmxlZCA9IHRydWU7CisJfQorCXNw
aW5fdW5sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKK30KKworc3RhdGljIHZvaWQgZ2VuMTFfZGlz
YWJsZV9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCit7CisJc3RydWN0IGlu
dGVsX2d0ICpndCA9IGd1Y190b19ndChndWMpOworCisJc3Bpbl9sb2NrX2lycSgmZ3QtPmlycV9s
b2NrKTsKKwlndWMtPmludGVycnVwdHMuZW5hYmxlZCA9IGZhbHNlOworCisJaW50ZWxfdW5jb3Jl
X3dyaXRlKGd0LT51bmNvcmUsIEdFTjExX0dVQ19TR19JTlRSX01BU0ssIH4wKTsKKwlpbnRlbF91
bmNvcmVfd3JpdGUoZ3QtPnVuY29yZSwgR0VOMTFfR1VDX1NHX0lOVFJfRU5BQkxFLCAwKTsKKwor
CXNwaW5fdW5sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKKwlpbnRlbF9zeW5jaHJvbml6ZV9pcnEo
Z3QtPmk5MTUpOworCisJZ2VuMTFfcmVzZXRfZ3VjX2ludGVycnVwdHMoZ3VjKTsKK30KKwogdm9p
ZCBpbnRlbF9ndWNfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiB7CiAJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9fZ3QoZ3VjKS0+aTkxNTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5jCmluZGV4IGEw
ZjJhMDEzNjViYy4uYjhmYTgxMTM3ZGVhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKQEAgLTEwMDQsNyArMTAwNCw3IEBAIHZvaWQg
aW50ZWxfZ3VjX3N1Ym1pc3Npb25fZmluaShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiAKIHN0YXRp
YyB2b2lkIGd1Y19pbnRlcnJ1cHRzX2NhcHR1cmUoc3RydWN0IGludGVsX2d0ICpndCkKIHsKLQlz
dHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZ3QtPmk5MTUtPmd0X3BtLnJwczsKKwlzdHJ1Y3QgaW50
ZWxfcnBzICpycHMgPSAmZ3QtPnJwczsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBn
dC0+dW5jb3JlOwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAllbnVtIGludGVs
X2VuZ2luZV9pZCBpZDsKQEAgLTEwNTAsNyArMTA1MCw3IEBAIHN0YXRpYyB2b2lkIGd1Y19pbnRl
cnJ1cHRzX2NhcHR1cmUoc3RydWN0IGludGVsX2d0ICpndCkKIAogc3RhdGljIHZvaWQgZ3VjX2lu
dGVycnVwdHNfcmVsZWFzZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewotCXN0cnVjdCBpbnRlbF9y
cHMgKnJwcyA9ICZndC0+aTkxNS0+Z3RfcG0ucnBzOworCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9
ICZndC0+cnBzOwogCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7CiAJ
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWVudW0gaW50ZWxfZW5naW5lX2lkIGlk
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwppbmRleCA4MTI2ZGZmZTc4MDAuLmQ0NWNh
MmQ5NjVkNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKQEAgLTQwLDYgKzQwLDgg
QEAKIAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jb250ZXh0LmgiCiAjaW5jbHVkZSAiZ3QvaW50
ZWxfcmVzZXQuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9yYzYuaCIKKyNpbmNsdWRlICJndC9pbnRl
bF9ycHMuaCIKICNpbmNsdWRlICJndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5oIgogCiAjaW5j
bHVkZSAiaTkxNV9kZWJ1Z2ZzLmgiCkBAIC03NjcsNyArNzY5LDcgQEAgc3RhdGljIGludCBpOTE1
X2ZyZXF1ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogewogCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRl
KTsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKLQlz
dHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKKwlzdHJ1Y3QgaW50
ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0LnJwczsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJl
ZjsKIAlpbnQgcmV0ID0gMDsKIApAQCAtODAzLDIzICs4MDUsMjMgQEAgc3RhdGljIGludCBpOTE1
X2ZyZXF1ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCQlzZXFf
cHJpbnRmKG0sICJERFIgZnJlcTogJWQgTUh6XG4iLCBkZXZfcHJpdi0+bWVtX2ZyZXEpOwogCiAJ
CXNlcV9wcmludGYobSwgImFjdHVhbCBHUFUgZnJlcTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxf
Z3B1X2ZyZXEoZGV2X3ByaXYsIChmcmVxX3N0cyA+PiA4KSAmIDB4ZmYpKTsKKwkJCSAgIGludGVs
X2dwdV9mcmVxKHJwcywgKGZyZXFfc3RzID4+IDgpICYgMHhmZikpOwogCiAJCXNlcV9wcmludGYo
bSwgImN1cnJlbnQgR1BVIGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRl
dl9wcml2LCBycHMtPmN1cl9mcmVxKSk7CisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+
Y3VyX2ZyZXEpKTsKIAogCQlzZXFfcHJpbnRmKG0sICJtYXggR1BVIGZyZXE6ICVkIE1IelxuIiwK
LQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPm1heF9mcmVxKSk7CisJCQkgICBp
bnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKIAogCQlzZXFfcHJpbnRmKG0sICJt
aW4gR1BVIGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBy
cHMtPm1pbl9mcmVxKSk7CisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXEp
KTsKIAogCQlzZXFfcHJpbnRmKG0sICJpZGxlIEdQVSBmcmVxOiAlZCBNSHpcbiIsCi0JCQkgICBp
bnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5pZGxlX2ZyZXEpKTsKKwkJCSAgIGludGVsX2dw
dV9mcmVxKHJwcywgcnBzLT5pZGxlX2ZyZXEpKTsKIAogCQlzZXFfcHJpbnRmKG0sCiAJCQkgICAi
ZWZmaWNpZW50IChSUGUpIGZyZXF1ZW5jeTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2Zy
ZXEoZGV2X3ByaXYsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpKTsKKwkJCSAgIGludGVsX2dwdV9mcmVx
KHJwcywgcnBzLT5lZmZpY2llbnRfZnJlcSkpOwogCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA2KSB7CiAJCXUzMiBycF9zdGF0ZV9saW1pdHM7CiAJCXUzMiBndF9wZXJmX3N0YXR1
czsKQEAgLTg1Myw3ICs4NTUsNyBAQCBzdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5X2luZm8oc3Ry
dWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJCQllbHNlCiAJCQkJcmVxZiA+Pj0gMjU7
CiAJCX0KLQkJcmVxZiA9IGludGVsX2dwdV9mcmVxKGRldl9wcml2LCByZXFmKTsKKwkJcmVxZiA9
IGludGVsX2dwdV9mcmVxKHJwcywgcmVxZik7CiAKIAkJcnBtb2RlY3RsID0gSTkxNV9SRUFEKEdF
TjZfUlBfQ09OVFJPTCk7CiAJCXJwaW5jbGltaXQgPSBJOTE1X1JFQUQoR0VONl9SUF9VUF9USFJF
U0hPTEQpOwpAQCAtODY2LDggKzg2OCw3IEBAIHN0YXRpYyBpbnQgaTkxNV9mcmVxdWVuY3lfaW5m
byhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAkJcnBkb3duZWkgPSBJOTE1X1JF
QUQoR0VONl9SUF9DVVJfRE9XTl9FSSkgJiBHRU42X0NVUklBVkdfTUFTSzsKIAkJcnBjdXJkb3du
ID0gSTkxNV9SRUFEKEdFTjZfUlBfQ1VSX0RPV04pICYgR0VONl9DVVJCU1lUQVZHX01BU0s7CiAJ
CXJwcHJldmRvd24gPSBJOTE1X1JFQUQoR0VONl9SUF9QUkVWX0RPV04pICYgR0VONl9DVVJCU1lU
QVZHX01BU0s7Ci0JCWNhZ2YgPSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwKLQkJCQkgICAgICBp
bnRlbF9nZXRfY2FnZihkZXZfcHJpdiwgcnBzdGF0KSk7CisJCWNhZ2YgPSBpbnRlbF9ncHVfZnJl
cShycHMsIGludGVsX2dldF9jYWdmKHJwcywgcnBzdGF0KSk7CiAKIAkJaW50ZWxfdW5jb3JlX2Zv
cmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwogCkBAIC05NDQs
MzcgKzk0NSwzNyBAQCBzdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5X2luZm8oc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICp1bnVzZWQpCiAJCW1heF9mcmVxICo9IChJU19HRU45X0JDKGRldl9wcml2
KSB8fAogCQkJICAgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwID8gR0VOOV9GUkVRX1NDQUxF
UiA6IDEpOwogCQlzZXFfcHJpbnRmKG0sICJMb3dlc3QgKFJQTikgZnJlcXVlbmN5OiAlZE1Ielxu
IiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBtYXhfZnJlcSkpOworCQkJICAgaW50
ZWxfZ3B1X2ZyZXEocnBzLCBtYXhfZnJlcSkpOwogCiAJCW1heF9mcmVxID0gKHJwX3N0YXRlX2Nh
cCAmIDB4ZmYwMCkgPj4gODsKIAkJbWF4X2ZyZXEgKj0gKElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8
CiAJCQkgICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgPyBHRU45X0ZSRVFfU0NBTEVSIDog
MSk7CiAJCXNlcV9wcmludGYobSwgIk5vbWluYWwgKFJQMSkgZnJlcXVlbmN5OiAlZE1IelxuIiwK
LQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBtYXhfZnJlcSkpOworCQkJICAgaW50ZWxf
Z3B1X2ZyZXEocnBzLCBtYXhfZnJlcSkpOwogCiAJCW1heF9mcmVxID0gKElTX0dFTjlfTFAoZGV2
X3ByaXYpID8gcnBfc3RhdGVfY2FwID4+IDE2IDoKIAkJCSAgICBycF9zdGF0ZV9jYXAgPj4gMCkg
JiAweGZmOwogCQltYXhfZnJlcSAqPSAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwKIAkJCSAgICAg
SU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKIAkJc2Vx
X3ByaW50ZihtLCAiTWF4IG5vbi1vdmVyY2xvY2tlZCAoUlAwKSBmcmVxdWVuY3k6ICVkTUh6XG4i
LAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIG1heF9mcmVxKSk7CisJCQkgICBpbnRl
bF9ncHVfZnJlcShycHMsIG1heF9mcmVxKSk7CiAJCXNlcV9wcmludGYobSwgIk1heCBvdmVyY2xv
Y2tlZCBmcmVxdWVuY3k6ICVkTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYs
IHJwcy0+bWF4X2ZyZXEpKTsKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5tYXhfZnJl
cSkpOwogCiAJCXNlcV9wcmludGYobSwgIkN1cnJlbnQgZnJlcTogJWQgTUh6XG4iLAotCQkJICAg
aW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+Y3VyX2ZyZXEpKTsKKwkJCSAgIGludGVsX2dw
dV9mcmVxKHJwcywgcnBzLT5jdXJfZnJlcSkpOwogCQlzZXFfcHJpbnRmKG0sICJBY3R1YWwgZnJl
cTogJWQgTUh6XG4iLCBjYWdmKTsKIAkJc2VxX3ByaW50ZihtLCAiSWRsZSBmcmVxOiAlZCBNSHpc
biIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5pZGxlX2ZyZXEpKTsKKwkJ
CSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5pZGxlX2ZyZXEpKTsKIAkJc2VxX3ByaW50Ziht
LCAiTWluIGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBy
cHMtPm1pbl9mcmVxKSk7CisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXEp
KTsKIAkJc2VxX3ByaW50ZihtLCAiQm9vc3QgZnJlcTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxf
Z3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+Ym9vc3RfZnJlcSkpOworCQkJICAgaW50ZWxfZ3B1X2Zy
ZXEocnBzLCBycHMtPmJvb3N0X2ZyZXEpKTsKIAkJc2VxX3ByaW50ZihtLCAiTWF4IGZyZXE6ICVk
IE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPm1heF9mcmVxKSk7
CisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKIAkJc2VxX3ByaW50
ZihtLAogCQkJICAgImVmZmljaWVudCAoUlBlKSBmcmVxdWVuY3k6ICVkIE1IelxuIiwKLQkJCSAg
IGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPmVmZmljaWVudF9mcmVxKSk7CisJCQkgICBp
bnRlbF9ncHVfZnJlcShycHMsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpKTsKIAl9IGVsc2UgewogCQlz
ZXFfcHV0cyhtLCAibm8gUC1zdGF0ZSBpbmZvIGF2YWlsYWJsZVxuIik7CiAJfQpAQCAtMTE1Miwx
MSArMTE1MywxMyBAQCBzdGF0aWMgdm9pZCBwcmludF9yYzZfcmVzKHN0cnVjdCBzZXFfZmlsZSAq
bSwKIAkJCSAgY29uc3QgY2hhciAqdGl0bGUsCiAJCQkgIGNvbnN0IGk5MTVfcmVnX3QgcmVnKQog
ewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5w
cml2YXRlKTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNSht
LT5wcml2YXRlKTsKKwlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAotCXNlcV9wcmludGYobSwg
IiVzICV1ICglbGx1IHVzKVxuIiwKLQkJICAgdGl0bGUsIEk5MTVfUkVBRChyZWcpLAotCQkgICBp
bnRlbF9yYzZfcmVzaWRlbmN5X3VzKGRldl9wcml2LCByZWcpKTsKKwl3aXRoX2ludGVsX3J1bnRp
bWVfcG0oJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpCisJCXNlcV9wcmludGYobSwgIiVzICV1
ICglbGx1IHVzKVxuIiwgdGl0bGUsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCgmaTkxNS0+dW5j
b3JlLCByZWcpLAorCQkJICAgaW50ZWxfcmM2X3Jlc2lkZW5jeV91cygmaTkxNS0+Z3QucmM2LCBy
ZWcpKTsKIH0KIAogc3RhdGljIGludCB2bHZfZHJwY19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkK
QEAgLTE0MzEsMzQgKzE0MzQsMTAgQEAgc3RhdGljIGludCBpOTE1X3NyX3N0YXR1cyhzdHJ1Y3Qg
c2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBp
OTE1X2Vtb25fc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQotewotCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwot
CWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCi0JaWYgKCFJU19HRU4oaTkxNSwgNSkpCi0JCXJl
dHVybiAtRU5PREVWOwotCi0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3Bt
LCB3YWtlcmVmKSB7Ci0JCXVuc2lnbmVkIGxvbmcgdGVtcCwgY2hpcHNldCwgZ2Z4OwotCi0JCXRl
bXAgPSBpOTE1X21jaF92YWwoaTkxNSk7Ci0JCWNoaXBzZXQgPSBpOTE1X2NoaXBzZXRfdmFsKGk5
MTUpOwotCQlnZnggPSBpOTE1X2dmeF92YWwoaTkxNSk7Ci0KLQkJc2VxX3ByaW50ZihtLCAiR01D
SCB0ZW1wOiAlbGRcbiIsIHRlbXApOwotCQlzZXFfcHJpbnRmKG0sICJDaGlwc2V0IHBvd2VyOiAl
bGRcbiIsIGNoaXBzZXQpOwotCQlzZXFfcHJpbnRmKG0sICJHRlggcG93ZXI6ICVsZFxuIiwgZ2Z4
KTsKLQkJc2VxX3ByaW50ZihtLCAiVG90YWwgcG93ZXI6ICVsZFxuIiwgY2hpcHNldCArIGdmeCk7
Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci0KIHN0YXRpYyBpbnQgaTkxNV9yaW5nX2ZyZXFfdGFibGUo
c3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiB7CiAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCXN0cnVjdCBpbnRl
bF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOworCXN0cnVjdCBpbnRlbF9ycHMgKnJw
cyA9ICZkZXZfcHJpdi0+Z3QucnBzOwogCXVuc2lnbmVkIGludCBtYXhfZ3B1X2ZyZXEsIG1pbl9n
cHVfZnJlcTsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAlpbnQgZ3B1X2ZyZXEsIGlhX2Zy
ZXE7CkBAIC0xNDgzLDEwICsxNDYyLDExIEBAIHN0YXRpYyBpbnQgaTkxNV9yaW5nX2ZyZXFfdGFi
bGUoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJCQkJICAgICAgIEdFTjZfUENP
REVfUkVBRF9NSU5fRlJFUV9UQUJMRSwKIAkJCQkgICAgICAgJmlhX2ZyZXEsIE5VTEwpOwogCQlz
ZXFfcHJpbnRmKG0sICIlZFx0XHQlZFx0XHRcdFx0JWRcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJl
cShkZXZfcHJpdiwgKGdwdV9mcmVxICoKLQkJCQkJCSAgICAgKElTX0dFTjlfQkMoZGV2X3ByaXYp
IHx8Ci0JCQkJCQkgICAgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwID8KLQkJCQkJCSAgICAg
IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKSkpLAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLAorCQkJ
CQkgIChncHVfZnJlcSAqCisJCQkJCSAgIChJU19HRU45X0JDKGRldl9wcml2KSB8fAorCQkJCQkg
ICAgSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCA/CisJCQkJCSAgICBHRU45X0ZSRVFfU0NBTEVS
IDogMSkpKSwKIAkJCSAgICgoaWFfZnJlcSA+PiAwKSAmIDB4ZmYpICogMTAwLAogCQkJICAgKChp
YV9mcmVxID4+IDgpICYgMHhmZikgKiAxMDApOwogCX0KQEAgLTE3MjMsNyArMTcwMyw3IEBAIHN0
YXRpYyBjb25zdCBjaGFyICpycHNfcG93ZXJfdG9fc3RyKHVuc2lnbmVkIGludCBwb3dlcikKIHN0
YXRpYyBpbnQgaTkxNV9ycHNfYm9vc3RfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRh
dGEpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0u
cnBzOworCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3QucnBzOwogCXUzMiBh
Y3RfZnJlcSA9IHJwcy0+Y3VyX2ZyZXE7CiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CiAKQEAg
LTE3MzUsNyArMTcxNSw3IEBAIHN0YXRpYyBpbnQgaTkxNV9ycHNfYm9vc3RfaW5mbyhzdHJ1Y3Qg
c2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJCQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKIAkJ
CWFjdF9mcmVxID0gKGFjdF9mcmVxID4+IDgpICYgMHhmZjsKIAkJfSBlbHNlIHsKLQkJCWFjdF9m
cmVxID0gaW50ZWxfZ2V0X2NhZ2YoZGV2X3ByaXYsCisJCQlhY3RfZnJlcSA9IGludGVsX2dldF9j
YWdmKHJwcywKIAkJCQkJCSAgSTkxNV9SRUFEKEdFTjZfUlBTVEFUMSkpOwogCQl9CiAJfQpAQCAt
MTc0NiwxNyArMTcyNiwxNyBAQCBzdGF0aWMgaW50IGk5MTVfcnBzX2Jvb3N0X2luZm8oc3RydWN0
IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogCQkgICBhdG9taWNfcmVhZCgmcnBzLT5udW1fd2Fp
dGVycykpOwogCXNlcV9wcmludGYobSwgIkludGVyYWN0aXZlPyAlZFxuIiwgUkVBRF9PTkNFKHJw
cy0+cG93ZXIuaW50ZXJhY3RpdmUpKTsKIAlzZXFfcHJpbnRmKG0sICJGcmVxdWVuY3kgcmVxdWVz
dGVkICVkLCBhY3R1YWwgJWRcbiIsCi0JCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMt
PmN1cl9mcmVxKSwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIGFjdF9mcmVxKSk7CisJ
CSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5jdXJfZnJlcSksCisJCSAgIGludGVsX2dwdV9m
cmVxKHJwcywgYWN0X2ZyZXEpKTsKIAlzZXFfcHJpbnRmKG0sICIgIG1pbiBoYXJkOiVkLCBzb2Z0
OiVkOyBtYXggc29mdDolZCwgaGFyZDolZFxuIiwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3By
aXYsIHJwcy0+bWluX2ZyZXEpLAotCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5t
aW5fZnJlcV9zb2Z0bGltaXQpLAotCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5t
YXhfZnJlcV9zb2Z0bGltaXQpLAotCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5t
YXhfZnJlcSkpOworCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXEpLAorCQkg
ICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KSwKKwkJICAgaW50
ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCksCisJCSAgIGludGVsX2dw
dV9mcmVxKHJwcywgcnBzLT5tYXhfZnJlcSkpOwogCXNlcV9wcmludGYobSwgIiAgaWRsZTolZCwg
ZWZmaWNpZW50OiVkLCBib29zdDolZFxuIiwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYs
IHJwcy0+aWRsZV9mcmVxKSwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+ZWZm
aWNpZW50X2ZyZXEpLAotCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5ib29zdF9m
cmVxKSk7CisJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5pZGxlX2ZyZXEpLAorCQkgICBp
bnRlbF9ncHVfZnJlcShycHMsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpLAorCQkgICBpbnRlbF9ncHVf
ZnJlcShycHMsIHJwcy0+Ym9vc3RfZnJlcSkpOwogCiAJc2VxX3ByaW50ZihtLCAiV2FpdCBib29z
dHM6ICVkXG4iLCBhdG9taWNfcmVhZCgmcnBzLT5ib29zdHMpKTsKIApAQCAtNDMwMCw3ICs0Mjgw
LDYgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGk5MTVfZGVidWdmc19saXN0
W10gPSB7CiAJeyJpOTE1X2ZyZXF1ZW5jeV9pbmZvIiwgaTkxNV9mcmVxdWVuY3lfaW5mbywgMH0s
CiAJeyJpOTE1X2hhbmdjaGVja19pbmZvIiwgaTkxNV9oYW5nY2hlY2tfaW5mbywgMH0sCiAJeyJp
OTE1X2RycGNfaW5mbyIsIGk5MTVfZHJwY19pbmZvLCAwfSwKLQl7Imk5MTVfZW1vbl9zdGF0dXMi
LCBpOTE1X2Vtb25fc3RhdHVzLCAwfSwKIAl7Imk5MTVfcmluZ19mcmVxX3RhYmxlIiwgaTkxNV9y
aW5nX2ZyZXFfdGFibGUsIDB9LAogCXsiaTkxNV9mcm9udGJ1ZmZlcl90cmFja2luZyIsIGk5MTVf
ZnJvbnRidWZmZXJfdHJhY2tpbmcsIDB9LAogCXsiaTkxNV9mYmNfc3RhdHVzIiwgaTkxNV9mYmNf
c3RhdHVzLCAwfSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCmluZGV4IDAyNDQ0MjEyNDFmZC4uYWI5
YzQ4MGM3NzA5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKQEAgLTE2NDEsOSArMTY0MSw2IEBA
IHN0YXRpYyBpbnQgaTkxNV9kcml2ZXJfaHdfcHJvYmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQogCXBtX3Fvc19hZGRfcmVxdWVzdCgmZGV2X3ByaXYtPnBtX3FvcywgUE1fUU9T
X0NQVV9ETUFfTEFURU5DWSwKIAkJCSAgIFBNX1FPU19ERUZBVUxUX1ZBTFVFKTsKIAotCS8qIEJJ
T1Mgb2Z0ZW4gbGVhdmVzIFJDNiBlbmFibGVkLCBidXQgZGlzYWJsZSBpdCBmb3IgaHcgaW5pdCAq
LwotCWludGVsX3Nhbml0aXplX2d0X3Bvd2Vyc2F2ZShkZXZfcHJpdik7Ci0KIAlpbnRlbF9ndF9p
bml0X3dvcmthcm91bmRzKGRldl9wcml2KTsKIAogCS8qIE9uIHRoZSA5NDVHL0dNLCB0aGUgY2hp
cHNldCByZXBvcnRzIHRoZSBNU0kgY2FwYWJpbGl0eSBvbiB0aGUKQEAgLTE3NDksOCArMTc0Niw3
IEBAIHN0YXRpYyB2b2lkIGk5MTVfZHJpdmVyX3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKIAkJYWNwaV92aWRlb19yZWdpc3RlcigpOwogCX0KIAotCWlmIChJU19H
RU4oZGV2X3ByaXYsIDUpKQotCQlpbnRlbF9ncHVfaXBzX2luaXQoZGV2X3ByaXYpOworCWludGVs
X2d0X2RyaXZlcl9yZWdpc3RlcigmZGV2X3ByaXYtPmd0KTsKIAogCWludGVsX2F1ZGlvX2luaXQo
ZGV2X3ByaXYpOwogCkBAIC0xNzkzLDcgKzE3ODksNyBAQCBzdGF0aWMgdm9pZCBpOTE1X2RyaXZl
cl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkgKi8KIAlk
cm1fa21zX2hlbHBlcl9wb2xsX2ZpbmkoJmRldl9wcml2LT5kcm0pOwogCi0JaW50ZWxfZ3B1X2lw
c190ZWFyZG93bigpOworCWludGVsX2d0X2RyaXZlcl91bnJlZ2lzdGVyKCZkZXZfcHJpdi0+Z3Qp
OwogCWFjcGlfdmlkZW9fdW5yZWdpc3RlcigpOwogCWludGVsX29wcmVnaW9uX3VucmVnaXN0ZXIo
ZGV2X3ByaXYpOwogCkBAIC0xOTM1LDEwICsxOTMxLDggQEAgaW50IGk5MTVfZHJpdmVyX3Byb2Jl
KHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBjb25zdCBzdHJ1Y3QgcGNpX2RldmljZV9pZCAqZW50KQog
CiBvdXRfY2xlYW51cF9odzoKIAlpOTE1X2RyaXZlcl9od19yZW1vdmUoZGV2X3ByaXYpOworCWlu
dGVsX2d0X2RyaXZlcl9yZWxlYXNlKCZkZXZfcHJpdi0+Z3QpOwogCWk5MTVfZ2d0dF9kcml2ZXJf
cmVsZWFzZShkZXZfcHJpdik7Ci0KLQkvKiBQYXJhbm9pYTogbWFrZSBzdXJlIHdlIGhhdmUgZGlz
YWJsZWQgZXZlcnl0aGluZyBiZWZvcmUgd2UgZXhpdC4gKi8KLQlpbnRlbF9zYW5pdGl6ZV9ndF9w
b3dlcnNhdmUoZGV2X3ByaXYpOwogb3V0X2NsZWFudXBfbW1pbzoKIAlpOTE1X2RyaXZlcl9tbWlv
X3JlbGVhc2UoZGV2X3ByaXYpOwogb3V0X3J1bnRpbWVfcG1fcHV0OgpAQCAtMjAxMCw4ICsyMDA0
LDcgQEAgc3RhdGljIHZvaWQgaTkxNV9kcml2ZXJfcmVsZWFzZShzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2KQogCiAJaTkxNV9nZ3R0X2RyaXZlcl9yZWxlYXNlKGRldl9wcml2KTsKIAotCS8qIFBhcmFu
b2lhOiBtYWtlIHN1cmUgd2UgaGF2ZSBkaXNhYmxlZCBldmVyeXRoaW5nIGJlZm9yZSB3ZSBleGl0
LiAqLwotCWludGVsX3Nhbml0aXplX2d0X3Bvd2Vyc2F2ZShkZXZfcHJpdik7CisJaW50ZWxfZ3Rf
ZHJpdmVyX3JlbGVhc2UoJmRldl9wcml2LT5ndCk7CiAKIAlpOTE1X2RyaXZlcl9tbWlvX3JlbGVh
c2UoZGV2X3ByaXYpOwogCkBAIC0yMjQ0LDcgKzIyMzcsNyBAQCBzdGF0aWMgaW50IGk5MTVfZHJt
X3Jlc3VtZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogCWludCByZXQ7CiAKIAlkaXNhYmxlX3Jw
bV93YWtlcmVmX2Fzc2VydHMoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKLQlpbnRlbF9zYW5pdGl6
ZV9ndF9wb3dlcnNhdmUoZGV2X3ByaXYpOworCWludGVsX2d0X3BtX2Rpc2FibGUoJmRldl9wcml2
LT5ndCk7CiAKIAlpOTE1X2dlbV9zYW5pdGl6ZShkZXZfcHJpdik7CiAKQEAgLTIzNzcsNyArMjM3
MCw3IEBAIHN0YXRpYyBpbnQgaTkxNV9kcm1fcmVzdW1lX2Vhcmx5KHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYpCiAJCWhzd19kaXNhYmxlX3BjOChkZXZfcHJpdik7CiAJfQogCi0JaW50ZWxfc2FuaXRp
emVfZ3RfcG93ZXJzYXZlKGRldl9wcml2KTsKKwlpbnRlbF9ndF9wbV9kaXNhYmxlKCZkZXZfcHJp
di0+Z3QpOwogCiAJaW50ZWxfcG93ZXJfZG9tYWluc19yZXN1bWUoZGV2X3ByaXYpOwogCkBAIC0y
OTIxLDkgKzI5MTQsNiBAQCBzdGF0aWMgaW50IGludGVsX3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3Qg
ZGV2aWNlICprZGV2KQogCXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0gPSAmZGV2X3ByaXYt
PnJ1bnRpbWVfcG07CiAJaW50IHJldDsKIAotCWlmIChXQVJOX09OX09OQ0UoIShkZXZfcHJpdi0+
Z3RfcG0ucmM2LmVuYWJsZWQgJiYgSEFTX1JDNihkZXZfcHJpdikpKSkKLQkJcmV0dXJuIC1FTk9E
RVY7Ci0KIAlpZiAoV0FSTl9PTl9PTkNFKCFIQVNfUlVOVElNRV9QTShkZXZfcHJpdikpKQogCQly
ZXR1cm4gLUVOT0RFVjsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
cnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKaW5kZXggZmJhYWFhN2MxMmFk
Li42ZjYxMTY5OWIzYmUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2
LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtNjM0LDEwNiArNjM0
LDYgQEAgc3RydWN0IHZsdl9zMGl4X3N0YXRlIHsKIAl1MzIgY2xvY2tfZ2F0ZV9kaXMyOwogfTsK
IAotc3RydWN0IGludGVsX3Jwc19laSB7Ci0Ja3RpbWVfdCBrdGltZTsKLQl1MzIgcmVuZGVyX2Mw
OwotCXUzMiBtZWRpYV9jMDsKLX07Ci0KLXN0cnVjdCBpbnRlbF9ycHMgewotCXN0cnVjdCBtdXRl
eCBsb2NrOyAvKiBwcm90ZWN0cyBlbmFibGluZyBhbmQgdGhlIHdvcmtlciAqLwotCi0JLyoKLQkg
KiB3b3JrLCBpbnRlcnJ1cHRzX2VuYWJsZWQgYW5kIHBtX2lpciBhcmUgcHJvdGVjdGVkIGJ5Ci0J
ICogZGV2X3ByaXYtPmlycV9sb2NrCi0JICovCi0Jc3RydWN0IHdvcmtfc3RydWN0IHdvcms7Ci0J
Ym9vbCBpbnRlcnJ1cHRzX2VuYWJsZWQ7Ci0JdTMyIHBtX2lpcjsKLQotCS8qIFBNIGludGVycnVw
dCBiaXRzIHRoYXQgc2hvdWxkIG5ldmVyIGJlIG1hc2tlZCAqLwotCXUzMiBwbV9pbnRybXNrX21i
ejsKLQotCS8qIEZyZXF1ZW5jaWVzIGFyZSBzdG9yZWQgaW4gcG90ZW50aWFsbHkgcGxhdGZvcm0g
ZGVwZW5kZW50IG11bHRpcGxlcy4KLQkgKiBJbiBvdGhlciB3b3JkcywgKl9mcmVxIG5lZWRzIHRv
IGJlIG11bHRpcGxpZWQgYnkgWCB0byBiZSBpbnRlcmVzdGluZy4KLQkgKiBTb2Z0IGxpbWl0cyBh
cmUgdGhvc2Ugd2hpY2ggYXJlIHVzZWQgZm9yIHRoZSBkeW5hbWljIHJlY2xvY2tpbmcgZG9uZQot
CSAqIGJ5IHRoZSBkcml2ZXIgKHJhaXNlIGZyZXF1ZW5jaWVzIHVuZGVyIGhlYXZ5IGxvYWRzLCBh
bmQgbG93ZXIgZm9yCi0JICogbGlnaHRlciBsb2FkcykuIEhhcmQgbGltaXRzIGFyZSB0aG9zZSBp
bXBvc2VkIGJ5IHRoZSBoYXJkd2FyZS4KLQkgKgotCSAqIEEgZGlzdGluY3Rpb24gaXMgbWFkZSBm
b3Igb3ZlcmNsb2NraW5nLCB3aGljaCBpcyBuZXZlciBlbmFibGVkIGJ5Ci0JICogZGVmYXVsdCwg
YW5kIGlzIGNvbnNpZGVyZWQgdG8gYmUgYWJvdmUgdGhlIGhhcmQgbGltaXQgaWYgaXQncwotCSAq
IHBvc3NpYmxlIGF0IGFsbC4KLQkgKi8KLQl1OCBjdXJfZnJlcTsJCS8qIEN1cnJlbnQgZnJlcXVl
bmN5IChjYWNoZWQsIG1heSBub3QgPT0gSFcpICovCi0JdTggbWluX2ZyZXFfc29mdGxpbWl0Owkv
KiBNaW5pbXVtIGZyZXF1ZW5jeSBwZXJtaXR0ZWQgYnkgdGhlIGRyaXZlciAqLwotCXU4IG1heF9m
cmVxX3NvZnRsaW1pdDsJLyogTWF4IGZyZXF1ZW5jeSBwZXJtaXR0ZWQgYnkgdGhlIGRyaXZlciAq
LwotCXU4IG1heF9mcmVxOwkJLyogTWF4aW11bSBmcmVxdWVuY3ksIFJQMCBpZiBub3Qgb3ZlcmNs
b2NraW5nICovCi0JdTggbWluX2ZyZXE7CQkvKiBBS0EgUlBuLiBNaW5pbXVtIGZyZXF1ZW5jeSAq
LwotCXU4IGJvb3N0X2ZyZXE7CQkvKiBGcmVxdWVuY3kgdG8gcmVxdWVzdCB3aGVuIHdhaXQgYm9v
c3RpbmcgKi8KLQl1OCBpZGxlX2ZyZXE7CQkvKiBGcmVxdWVuY3kgdG8gcmVxdWVzdCB3aGVuIHdl
IGFyZSBpZGxlICovCi0JdTggZWZmaWNpZW50X2ZyZXE7CS8qIEFLQSBSUGUuIFByZS1kZXRlcm1p
bmVkIGJhbGFuY2VkIGZyZXF1ZW5jeSAqLwotCXU4IHJwMV9mcmVxOwkJLyogImxlc3MgdGhhbiIg
UlAwIHBvd2VyL2ZyZXFlbmN5ICovCi0JdTggcnAwX2ZyZXE7CQkvKiBOb24tb3ZlcmNsb2NrZWQg
bWF4IGZyZXF1ZW5jeS4gKi8KLQl1MTYgZ3BsbF9yZWZfZnJlcTsJLyogdmx2L2NodiBHUExMIHJl
ZmVyZW5jZSBmcmVxdWVuY3kgKi8KLQotCWludCBsYXN0X2FkajsKLQotCXN0cnVjdCB7Ci0JCXN0
cnVjdCBtdXRleCBtdXRleDsKLQotCQllbnVtIHsgTE9XX1BPV0VSLCBCRVRXRUVOLCBISUdIX1BP
V0VSIH0gbW9kZTsKLQkJdW5zaWduZWQgaW50IGludGVyYWN0aXZlOwotCi0JCXU4IHVwX3RocmVz
aG9sZDsgLyogQ3VycmVudCAlYnVzeSByZXF1aXJlZCB0byB1cGxvY2sgKi8KLQkJdTggZG93bl90
aHJlc2hvbGQ7IC8qIEN1cnJlbnQgJWJ1c3kgcmVxdWlyZWQgdG8gZG93bmNsb2NrICovCi0JfSBw
b3dlcjsKLQotCWJvb2wgZW5hYmxlZDsKLQlhdG9taWNfdCBudW1fd2FpdGVyczsKLQlhdG9taWNf
dCBib29zdHM7Ci0KLQkvKiBtYW51YWwgd2EgcmVzaWRlbmN5IGNhbGN1bGF0aW9ucyAqLwotCXN0
cnVjdCBpbnRlbF9ycHNfZWkgZWk7Ci19OwotCi1zdHJ1Y3QgaW50ZWxfcmM2IHsKLQlib29sIGVu
YWJsZWQ7Ci0JdTY0IHByZXZfaHdfcmVzaWRlbmN5WzRdOwotCXU2NCBjdXJfcmVzaWRlbmN5WzRd
OwotfTsKLQotc3RydWN0IGludGVsX2xsY19wc3RhdGUgewotCWJvb2wgZW5hYmxlZDsKLX07Ci0K
LXN0cnVjdCBpbnRlbF9nZW42X3Bvd2VyX21nbXQgewotCXN0cnVjdCBpbnRlbF9ycHMgcnBzOwot
CXN0cnVjdCBpbnRlbF9yYzYgcmM2OwotCXN0cnVjdCBpbnRlbF9sbGNfcHN0YXRlIGxsY19wc3Rh
dGU7Ci19OwotCi0vKiBkZWZpbmVkIGludGVsX3BtLmMgKi8KLWV4dGVybiBzcGlubG9ja190IG1j
aGRldl9sb2NrOwotCi1zdHJ1Y3QgaW50ZWxfaWxrX3Bvd2VyX21nbXQgewotCXU4IGN1cl9kZWxh
eTsKLQl1OCBtaW5fZGVsYXk7Ci0JdTggbWF4X2RlbGF5OwotCXU4IGZtYXg7Ci0JdTggZnN0YXJ0
OwotCi0JdTY0IGxhc3RfY291bnQxOwotCXVuc2lnbmVkIGxvbmcgbGFzdF90aW1lMTsKLQl1bnNp
Z25lZCBsb25nIGNoaXBzZXRfcG93ZXI7Ci0JdTY0IGxhc3RfY291bnQyOwotCXU2NCBsYXN0X3Rp
bWUyOwotCXVuc2lnbmVkIGxvbmcgZ2Z4X3Bvd2VyOwotCXU4IGNvcnI7Ci0KLQlpbnQgY19tOwot
CWludCByX3Q7Ci19OwotCiAjZGVmaW5lIE1BWF9MM19TTElDRVMgMgogc3RydWN0IGludGVsX2wz
X3Bhcml0eSB7CiAJdTMyICpyZW1hcF9pbmZvW01BWF9MM19TTElDRVNdOwpAQCAtMTM5OSw4ICsx
Mjk5LDYgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgewogCQl1MzIgaXJxX21hc2s7CiAJCXUz
MiBkZV9pcnFfbWFza1tJOTE1X01BWF9QSVBFU107CiAJfTsKLQl1MzIgZ3RfaXJxX21hc2s7Ci0J
dTMyIHBtX3Jwc19ldmVudHM7CiAJdTMyIHBpcGVzdGF0X2lycV9tYXNrW0k5MTVfTUFYX1BJUEVT
XTsKIAogCXN0cnVjdCBpOTE1X2hvdHBsdWcgaG90cGx1ZzsKQEAgLTE1MzMsMjEgKzE0MzEsMTIg
QEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgewogCSAqLwogCXUzMiBlZHJhbV9zaXplX21iOwog
Ci0JLyogZ2VuNisgR1QgUE0gc3RhdGUgKi8KLQlzdHJ1Y3QgaW50ZWxfZ2VuNl9wb3dlcl9tZ210
IGd0X3BtOwotCi0JLyogaWxrLW9ubHkgaXBzL3JwcyBzdGF0ZS4gRXZlcnl0aGluZyBpbiBoZXJl
IGlzIHByb3RlY3RlZCBieSB0aGUgZ2xvYmFsCi0JICogbWNoZGV2X2xvY2sgaW4gaW50ZWxfcG0u
YyAqLwotCXN0cnVjdCBpbnRlbF9pbGtfcG93ZXJfbWdtdCBpcHM7Ci0KIAlzdHJ1Y3QgaTkxNV9w
b3dlcl9kb21haW5zIHBvd2VyX2RvbWFpbnM7CiAKIAlzdHJ1Y3QgaTkxNV9wc3IgcHNyOwogCiAJ
c3RydWN0IGk5MTVfZ3B1X2Vycm9yIGdwdV9lcnJvcjsKIAotCXN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICp2bHZfcGN0eDsKLQogCS8qIGxpc3Qgb2YgZmJkZXYgcmVnaXN0ZXIgb24gdGhpcyBk
ZXZpY2UgKi8KIAlzdHJ1Y3QgaW50ZWxfZmJkZXYgKmZiZGV2OwogCXN0cnVjdCB3b3JrX3N0cnVj
dCBmYmRldl9zdXNwZW5kX3dvcms7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwppbmRleCA2Y2E3MDAx
ODlhODYuLjk0NGM4MGVkNzI2YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCkBAIC01MCw2ICs1
MCw3IEBACiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3RfcG0uaCIKICNpbmNsdWRlICJndC9pbnRlbF9t
b2NzLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfcmVzZXQuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9y
cHMuaCIKICNpbmNsdWRlICJndC9pbnRlbF93b3JrYXJvdW5kcy5oIgogCiAjaW5jbHVkZSAiaTkx
NV9kcnYuaCIKQEAgLTkzNiw3ICs5MzcsNyBAQCB3YWl0X2Zvcl90aW1lbGluZXMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCSAqIHN0YWxscywgc28gYWxsb3cgdGhlIGdwdSB0byBi
b29zdCB0byBtYXhpbXVtIGNsb2Nrcy4KIAkJICovCiAJCWlmICh3YWl0ICYgSTkxNV9XQUlUX0ZP
Ul9JRExFX0JPT1NUKQotCQkJZ2VuNl9ycHNfYm9vc3QocnEpOworCQkJaW50ZWxfcnBzX2Jvb3N0
KHJxKTsKIAogCQl0aW1lb3V0ID0gaTkxNV9yZXF1ZXN0X3dhaXQocnEsIHdhaXQsIHRpbWVvdXQp
OwogCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKQEAgLTEzOTAsMTcgKzEzOTEsNiBAQCBzdGF0aWMg
aW50IF9faW50ZWxfZW5naW5lc19yZWNvcmRfZGVmYXVsdHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCiAJZ290byBvdXRfY3R4OwogfQogCi1zdGF0aWMgaW50Ci1pOTE1X2dlbV9pbml0
X3NjcmF0Y2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHVuc2lnbmVkIGludCBzaXpl
KQotewotCXJldHVybiBpbnRlbF9ndF9pbml0X3NjcmF0Y2goJmk5MTUtPmd0LCBzaXplKTsKLX0K
LQotc3RhdGljIHZvaWQgaTkxNV9nZW1fZmluaV9zY3JhdGNoKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQotewotCWludGVsX2d0X2Zpbmlfc2NyYXRjaCgmaTkxNS0+Z3QpOwotfQotCiBz
dGF0aWMgaW50IGludGVsX2VuZ2luZXNfdmVyaWZ5X3dvcmthcm91bmRzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKQEAg
LTE0NTYsMTIgKzE0NDYsNyBAQCBpbnQgaTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCiAJCWdvdG8gZXJyX3VubG9jazsKIAl9CiAKLQlyZXQgPSBpOTE1X2dl
bV9pbml0X3NjcmF0Y2goZGV2X3ByaXYsCi0JCQkJICAgIElTX0dFTihkZXZfcHJpdiwgMikgPyBT
Wl8yNTZLIDogUEFHRV9TSVpFKTsKLQlpZiAocmV0KSB7Ci0JCUdFTV9CVUdfT04ocmV0ID09IC1F
SU8pOwotCQlnb3RvIGVycl9nZ3R0OwotCX0KKwlpbnRlbF9ndF9pbml0KCZkZXZfcHJpdi0+Z3Qp
OwogCiAJcmV0ID0gaW50ZWxfZW5naW5lc19zZXR1cChkZXZfcHJpdik7CiAJaWYgKHJldCkgewpA
QCAtMTQ4MSw4ICsxNDY2LDYgQEAgaW50IGk5MTVfZ2VtX2luaXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQogCQlnb3RvIGVycl9jb250ZXh0OwogCX0KIAotCWludGVsX2luaXRf
Z3RfcG93ZXJzYXZlKGRldl9wcml2KTsKLQogCXJldCA9IGludGVsX3VjX2luaXQoJmRldl9wcml2
LT5ndC51Yyk7CiAJaWYgKHJldCkKIAkJZ290byBlcnJfcG07CkBAIC0xNTUxLDE2ICsxNTM0LDEz
IEBAIGludCBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
IGVycl91Y19pbml0OgogCWludGVsX3VjX2ZpbmkoJmRldl9wcml2LT5ndC51Yyk7CiBlcnJfcG06
Ci0JaWYgKHJldCAhPSAtRUlPKSB7Ci0JCWludGVsX2NsZWFudXBfZ3RfcG93ZXJzYXZlKGRldl9w
cml2KTsKKwlpZiAocmV0ICE9IC1FSU8pCiAJCWludGVsX2VuZ2luZXNfY2xlYW51cChkZXZfcHJp
dik7Ci0JfQogZXJyX2NvbnRleHQ6CiAJaWYgKHJldCAhPSAtRUlPKQogCQlpOTE1X2dlbV9maW5p
X2NvbnRleHRzKGRldl9wcml2KTsKIGVycl9zY3JhdGNoOgotCWk5MTVfZ2VtX2Zpbmlfc2NyYXRj
aChkZXZfcHJpdik7Ci1lcnJfZ2d0dDoKKwlpbnRlbF9ndF9kcml2ZXJfcmVsZWFzZSgmZGV2X3By
aXYtPmd0KTsKIGVycl91bmxvY2s6CiAJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9w
cml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwogCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwpAQCAtMTYwMiwxMiArMTU4MiwxMCBAQCBpbnQgaTkxNV9nZW1faW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAKIHZvaWQgaTkxNV9nZW1fZHJp
dmVyX3JlbW92ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0JR0VNX0JV
R19PTihkZXZfcHJpdi0+Z3QuYXdha2UpOwotCiAJaW50ZWxfd2FrZXJlZl9hdXRvX2ZpbmkoJmRl
dl9wcml2LT5nZ3R0LnVzZXJmYXVsdF93YWtlcmVmKTsKIAogCWk5MTVfZ2VtX3N1c3BlbmRfbGF0
ZShkZXZfcHJpdik7Ci0JaW50ZWxfZGlzYWJsZV9ndF9wb3dlcnNhdmUoZGV2X3ByaXYpOworCWlu
dGVsX2d0X2RyaXZlcl9yZW1vdmUoJmRldl9wcml2LT5ndCk7CiAKIAkvKiBGbHVzaCBhbnkgb3V0
c3RhbmRpbmcgdW5waW5fd29yay4gKi8KIAlpOTE1X2dlbV9kcmFpbl93b3JrcXVldWUoZGV2X3By
aXYpOwpAQCAtMTYyNCwxNCArMTYwMiwxMiBAQCB2b2lkIGk5MTVfZ2VtX2RyaXZlcl9yZWxlYXNl
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAltdXRleF9sb2NrKCZkZXZf
cHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaW50ZWxfZW5naW5lc19jbGVhbnVwKGRldl9wcml2
KTsKKwlpbnRlbF9ndF9kcml2ZXJfcmVsZWFzZSgmZGV2X3ByaXYtPmd0KTsKIAlpOTE1X2dlbV9m
aW5pX2NvbnRleHRzKGRldl9wcml2KTsKLQlpOTE1X2dlbV9maW5pX3NjcmF0Y2goZGV2X3ByaXYp
OwogCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJaW50ZWxf
d2FfbGlzdF9mcmVlKCZkZXZfcHJpdi0+Z3Rfd2FfbGlzdCk7CiAKLQlpbnRlbF9jbGVhbnVwX2d0
X3Bvd2Vyc2F2ZShkZXZfcHJpdik7Ci0KIAlpbnRlbF91Y19jbGVhbnVwX2Zpcm13YXJlcygmZGV2
X3ByaXYtPmd0LnVjKTsKIAlpOTE1X2dlbV9jbGVhbnVwX3VzZXJwdHIoZGV2X3ByaXYpOwogCWlu
dGVsX3RpbWVsaW5lc19maW5pKGRldl9wcml2KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfaXJxLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jCmluZGV4
IGFmMWJiNjUzNTc5YS4uNjhhYmRiODZlZjg3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2lycS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMKQEAg
LTQzLDYgKzQzLDggQEAKICNpbmNsdWRlICJkaXNwbGF5L2ludGVsX3Bzci5oIgogCiAjaW5jbHVk
ZSAiZ3QvaW50ZWxfZ3QuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9ndF9pcnEuaCIKKyNpbmNsdWRl
ICJndC9pbnRlbF9ycHMuaCIKIAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAiaTkx
NV9pcnEuaCIKQEAgLTE1MCw4ICsxNTIsOCBAQCBzdGF0aWMgY29uc3QgdTMyIGhwZF9tY2NbSFBE
X05VTV9QSU5TXSA9IHsKIAlbSFBEX1BPUlRfQ10gPSBTREVfVEMxX0hPVFBMVUdfSUNQCiB9Owog
Ci1zdGF0aWMgdm9pZCBnZW4zX2lycV9yZXNldChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUs
IGk5MTVfcmVnX3QgaW1yLAotCQkJICAgaTkxNV9yZWdfdCBpaXIsIGk5MTVfcmVnX3QgaWVyKQor
dm9pZCBnZW4zX2lycV9yZXNldChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsIGk5MTVfcmVn
X3QgaW1yLAorCQkgICAgaTkxNV9yZWdfdCBpaXIsIGk5MTVfcmVnX3QgaWVyKQogewogCWludGVs
X3VuY29yZV93cml0ZSh1bmNvcmUsIGltciwgMHhmZmZmZmZmZik7CiAJaW50ZWxfdW5jb3JlX3Bv
c3RpbmdfcmVhZCh1bmNvcmUsIGltcik7CkBAIC0xNjUsNyArMTY3LDcgQEAgc3RhdGljIHZvaWQg
Z2VuM19pcnFfcmVzZXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLCBpOTE1X3JlZ190IGlt
ciwKIAlpbnRlbF91bmNvcmVfcG9zdGluZ19yZWFkKHVuY29yZSwgaWlyKTsKIH0KIAotc3RhdGlj
IHZvaWQgZ2VuMl9pcnFfcmVzZXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlKQordm9pZCBn
ZW4yX2lycV9yZXNldChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpCiB7CiAJaW50ZWxfdW5j
b3JlX3dyaXRlMTYodW5jb3JlLCBHRU4yX0lNUiwgMHhmZmZmKTsKIAlpbnRlbF91bmNvcmVfcG9z
dGluZ19yZWFkMTYodW5jb3JlLCBHRU4yX0lNUik7CkBAIC0xNzksMTkgKzE4MSw2IEBAIHN0YXRp
YyB2b2lkIGdlbjJfaXJxX3Jlc2V0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSkKIAlpbnRl
bF91bmNvcmVfcG9zdGluZ19yZWFkMTYodW5jb3JlLCBHRU4yX0lJUik7CiB9CiAKLSNkZWZpbmUg
R0VOOF9JUlFfUkVTRVRfTkRYKHVuY29yZSwgdHlwZSwgd2hpY2gpIFwKLSh7IFwKLQl1bnNpZ25l
ZCBpbnQgd2hpY2hfID0gd2hpY2g7IFwKLQlnZW4zX2lycV9yZXNldCgodW5jb3JlKSwgR0VOOF8j
I3R5cGUjI19JTVIod2hpY2hfKSwgXAotCQkgICAgICAgR0VOOF8jI3R5cGUjI19JSVIod2hpY2hf
KSwgR0VOOF8jI3R5cGUjI19JRVIod2hpY2hfKSk7IFwKLX0pCi0KLSNkZWZpbmUgR0VOM19JUlFf
UkVTRVQodW5jb3JlLCB0eXBlKSBcCi0JZ2VuM19pcnFfcmVzZXQoKHVuY29yZSksIHR5cGUjI0lN
UiwgdHlwZSMjSUlSLCB0eXBlIyNJRVIpCi0KLSNkZWZpbmUgR0VOMl9JUlFfUkVTRVQodW5jb3Jl
KSBcCi0JZ2VuMl9pcnFfcmVzZXQodW5jb3JlKQotCiAvKgogICogV2Ugc2hvdWxkIGNsZWFyIElN
UiBhdCBwcmVpbnN0YWxsL3VuaW5zdGFsbCwgYW5kIGp1c3QgY2hlY2sgYXQgcG9zdGluc3RhbGwu
CiAgKi8KQEAgLTIyNSwxMCArMjE0LDEwIEBAIHN0YXRpYyB2b2lkIGdlbjJfYXNzZXJ0X2lpcl9p
c196ZXJvKHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSkKIAlpbnRlbF91bmNvcmVfcG9zdGlu
Z19yZWFkMTYodW5jb3JlLCBHRU4yX0lJUik7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbjNfaXJxX2lu
aXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAotCQkJICBpOTE1X3JlZ190IGltciwgdTMy
IGltcl92YWwsCi0JCQkgIGk5MTVfcmVnX3QgaWVyLCB1MzIgaWVyX3ZhbCwKLQkJCSAgaTkxNV9y
ZWdfdCBpaXIpCit2b2lkIGdlbjNfaXJxX2luaXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3Jl
LAorCQkgICBpOTE1X3JlZ190IGltciwgdTMyIGltcl92YWwsCisJCSAgIGk5MTVfcmVnX3QgaWVy
LCB1MzIgaWVyX3ZhbCwKKwkJICAgaTkxNV9yZWdfdCBpaXIpCiB7CiAJZ2VuM19hc3NlcnRfaWly
X2lzX3plcm8odW5jb3JlLCBpaXIpOwogCkBAIC0yMzcsOCArMjI2LDggQEAgc3RhdGljIHZvaWQg
Z2VuM19pcnFfaW5pdChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsCiAJaW50ZWxfdW5jb3Jl
X3Bvc3RpbmdfcmVhZCh1bmNvcmUsIGltcik7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbjJfaXJxX2lu
aXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAotCQkJICB1MzIgaW1yX3ZhbCwgdTMyIGll
cl92YWwpCit2b2lkIGdlbjJfaXJxX2luaXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAor
CQkgICB1MzIgaW1yX3ZhbCwgdTMyIGllcl92YWwpCiB7CiAJZ2VuMl9hc3NlcnRfaWlyX2lzX3pl
cm8odW5jb3JlKTsKIApAQCAtMjY1LDkgKzI1NCw2IEBAIHN0YXRpYyB2b2lkIGdlbjJfaXJxX2lu
aXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAogI2RlZmluZSBHRU4yX0lSUV9JTklUKHVu
Y29yZSwgaW1yX3ZhbCwgaWVyX3ZhbCkgXAogCWdlbjJfaXJxX2luaXQoKHVuY29yZSksIGltcl92
YWwsIGllcl92YWwpCiAKLXN0YXRpYyB2b2lkIGdlbjZfcnBzX2lycV9oYW5kbGVyKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHBtX2lpcik7Ci1zdGF0aWMgdm9pZCBndWNf
aXJxX2hhbmRsZXIoc3RydWN0IGludGVsX2d1YyAqZ3VjLCB1MTYgZ3VjX2lpcik7Ci0KIC8qIEZv
ciBkaXNwbGF5IGhvdHBsdWcgaW50ZXJydXB0ICovCiBzdGF0aWMgaW5saW5lIHZvaWQKIGk5MTVf
aG90cGx1Z19pbnRlcnJ1cHRfdXBkYXRlX2xvY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCkBAIC0zMDYsNDEgKzI5Miw2IEBAIHZvaWQgaTkxNV9ob3RwbHVnX2ludGVycnVw
dF91cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCXNwaW5fdW5sb2Nr
X2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKIH0KIAotc3RhdGljIHUzMgotZ2VuMTFfZ3RfZW5n
aW5lX2lkZW50aXR5KHN0cnVjdCBpbnRlbF9ndCAqZ3QsCi0JCQkgY29uc3QgdW5zaWduZWQgaW50
IGJhbmssIGNvbnN0IHVuc2lnbmVkIGludCBiaXQpOwotCi1zdGF0aWMgYm9vbCBnZW4xMV9yZXNl
dF9vbmVfaWlyKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCi0JCQkJY29uc3QgdW5zaWduZWQgaW50IGJh
bmssCi0JCQkJY29uc3QgdW5zaWduZWQgaW50IGJpdCkKLXsKLQl2b2lkIF9faW9tZW0gKiBjb25z
dCByZWdzID0gZ3QtPnVuY29yZS0+cmVnczsKLQl1MzIgZHc7Ci0KLQlsb2NrZGVwX2Fzc2VydF9o
ZWxkKCZndC0+aTkxNS0+aXJxX2xvY2spOwotCi0JZHcgPSByYXdfcmVnX3JlYWQocmVncywgR0VO
MTFfR1RfSU5UUl9EVyhiYW5rKSk7Ci0JaWYgKGR3ICYgQklUKGJpdCkpIHsKLQkJLyoKLQkJICog
QWNjb3JkaW5nIHRvIHRoZSBCU3BlYywgRFdfSUlSIGJpdHMgY2Fubm90IGJlIGNsZWFyZWQgd2l0
aG91dAotCQkgKiBmaXJzdCBzZXJ2aWNpbmcgdGhlIFNlbGVjdG9yICYgU2hhcmVkIElJUiByZWdp
c3RlcnMuCi0JCSAqLwotCQlnZW4xMV9ndF9lbmdpbmVfaWRlbnRpdHkoZ3QsIGJhbmssIGJpdCk7
Ci0KLQkJLyoKLQkJICogV2UgbG9ja2VkIEdUIElOVCBEVyBieSByZWFkaW5nIGl0LiBJZiB3ZSB3
YW50IHRvICh0cnkKLQkJICogdG8pIHJlY292ZXIgZnJvbSB0aGlzIHN1Y2Nlc2Z1bGx5LCB3ZSBu
ZWVkIHRvIGNsZWFyCi0JCSAqIG91ciBiaXQsIG90aGVyd2lzZSB3ZSBhcmUgbG9ja2luZyB0aGUg
cmVnaXN0ZXIgZm9yCi0JCSAqIGV2ZXJ5Ym9keS4KLQkJICovCi0JCXJhd19yZWdfd3JpdGUocmVn
cywgR0VOMTFfR1RfSU5UUl9EVyhiYW5rKSwgQklUKGJpdCkpOwotCi0JCXJldHVybiB0cnVlOwot
CX0KLQotCXJldHVybiBmYWxzZTsKLX0KLQogLyoqCiAgKiBpbGtfdXBkYXRlX2Rpc3BsYXlfaXJx
IC0gdXBkYXRlIERFSU1SCiAgKiBAZGV2X3ByaXY6IGRyaXZlciBwcml2YXRlCkBAIC0zNzEsMzI2
ICszMjIsNiBAQCB2b2lkIGlsa191cGRhdGVfZGlzcGxheV9pcnEoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAogCX0KIH0KIAotLyoqCi0gKiBpbGtfdXBkYXRlX2d0X2lycSAtIHVw
ZGF0ZSBHVElNUgotICogQGRldl9wcml2OiBkcml2ZXIgcHJpdmF0ZQotICogQGludGVycnVwdF9t
YXNrOiBtYXNrIG9mIGludGVycnVwdCBiaXRzIHRvIHVwZGF0ZQotICogQGVuYWJsZWRfaXJxX21h
c2s6IG1hc2sgb2YgaW50ZXJydXB0IGJpdHMgdG8gZW5hYmxlCi0gKi8KLXN0YXRpYyB2b2lkIGls
a191cGRhdGVfZ3RfaXJxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAg
ICAgIHUzMiBpbnRlcnJ1cHRfbWFzaywKLQkJCSAgICAgIHUzMiBlbmFibGVkX2lycV9tYXNrKQot
ewotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5pcnFfbG9jayk7Ci0KLQlXQVJOX09O
KGVuYWJsZWRfaXJxX21hc2sgJiB+aW50ZXJydXB0X21hc2spOwotCi0JaWYgKFdBUk5fT04oIWlu
dGVsX2lycXNfZW5hYmxlZChkZXZfcHJpdikpKQotCQlyZXR1cm47Ci0KLQlkZXZfcHJpdi0+Z3Rf
aXJxX21hc2sgJj0gfmludGVycnVwdF9tYXNrOwotCWRldl9wcml2LT5ndF9pcnFfbWFzayB8PSAo
fmVuYWJsZWRfaXJxX21hc2sgJiBpbnRlcnJ1cHRfbWFzayk7Ci0JSTkxNV9XUklURShHVElNUiwg
ZGV2X3ByaXYtPmd0X2lycV9tYXNrKTsKLX0KLQotdm9pZCBnZW41X2VuYWJsZV9ndF9pcnEoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFzaykKLXsKLQlpbGtfdXBkYXRl
X2d0X2lycShkZXZfcHJpdiwgbWFzaywgbWFzayk7Ci0JaW50ZWxfdW5jb3JlX3Bvc3RpbmdfcmVh
ZF9mdygmZGV2X3ByaXYtPnVuY29yZSwgR1RJTVIpOwotfQotCi12b2lkIGdlbjVfZGlzYWJsZV9n
dF9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFzaykKLXsKLQlp
bGtfdXBkYXRlX2d0X2lycShkZXZfcHJpdiwgbWFzaywgMCk7Ci19Ci0KLXN0YXRpYyBpOTE1X3Jl
Z190IGdlbjZfcG1faWlyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlX
QVJOX09OX09OQ0UoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSk7Ci0KLQlyZXR1cm4gSU5URUxf
R0VOKGRldl9wcml2KSA+PSA4ID8gR0VOOF9HVF9JSVIoMikgOiBHRU42X1BNSUlSOwotfQotCi1z
dGF0aWMgdm9pZCB3cml0ZV9wbV9pbXIoc3RydWN0IGludGVsX2d0ICpndCkKLXsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1OwotCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9IGd0LT51bmNvcmU7Ci0JdTMyIG1hc2sgPSBndC0+cG1faW1yOwotCWk5MTVfcmVn
X3QgcmVnOwotCi0JaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgewotCQlyZWcgPSBHRU4xMV9H
UE1fV0dCT1hQRVJGX0lOVFJfTUFTSzsKLQkJLyogcG0gaXMgaW4gdXBwZXIgaGFsZiAqLwotCQlt
YXNrID0gbWFzayA8PCAxNjsKLQl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KSB7Ci0J
CXJlZyA9IEdFTjhfR1RfSU1SKDIpOwotCX0gZWxzZSB7Ci0JCXJlZyA9IEdFTjZfUE1JTVI7Ci0J
fQotCi0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgcmVnLCBtYXNrKTsKLQlpbnRlbF91bmNv
cmVfcG9zdGluZ19yZWFkKHVuY29yZSwgcmVnKTsKLX0KLQotc3RhdGljIHZvaWQgd3JpdGVfcG1f
aWVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBndC0+aTkxNTsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3Jl
OwotCXUzMiBtYXNrID0gZ3QtPnBtX2llcjsKLQlpOTE1X3JlZ190IHJlZzsKLQotCWlmIChJTlRF
TF9HRU4oaTkxNSkgPj0gMTEpIHsKLQkJcmVnID0gR0VOMTFfR1BNX1dHQk9YUEVSRl9JTlRSX0VO
QUJMRTsKLQkJLyogcG0gaXMgaW4gdXBwZXIgaGFsZiAqLwotCQltYXNrID0gbWFzayA8PCAxNjsK
LQl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KSB7Ci0JCXJlZyA9IEdFTjhfR1RfSUVS
KDIpOwotCX0gZWxzZSB7Ci0JCXJlZyA9IEdFTjZfUE1JRVI7Ci0JfQotCi0JaW50ZWxfdW5jb3Jl
X3dyaXRlKHVuY29yZSwgcmVnLCBtYXNrKTsKLX0KLQotLyoqCi0gKiBzbmJfdXBkYXRlX3BtX2ly
cSAtIHVwZGF0ZSBHRU42X1BNSU1SCi0gKiBAZ3Q6IGd0IGZvciB0aGUgaW50ZXJydXB0cwotICog
QGludGVycnVwdF9tYXNrOiBtYXNrIG9mIGludGVycnVwdCBiaXRzIHRvIHVwZGF0ZQotICogQGVu
YWJsZWRfaXJxX21hc2s6IG1hc2sgb2YgaW50ZXJydXB0IGJpdHMgdG8gZW5hYmxlCi0gKi8KLXN0
YXRpYyB2b2lkIHNuYl91cGRhdGVfcG1faXJxKHN0cnVjdCBpbnRlbF9ndCAqZ3QsCi0JCQkgICAg
ICB1MzIgaW50ZXJydXB0X21hc2ssCi0JCQkgICAgICB1MzIgZW5hYmxlZF9pcnFfbWFzaykKLXsK
LQl1MzIgbmV3X3ZhbDsKLQotCVdBUk5fT04oZW5hYmxlZF9pcnFfbWFzayAmIH5pbnRlcnJ1cHRf
bWFzayk7Ci0KLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZndC0+aTkxNS0+aXJxX2xvY2spOwotCi0J
bmV3X3ZhbCA9IGd0LT5wbV9pbXI7Ci0JbmV3X3ZhbCAmPSB+aW50ZXJydXB0X21hc2s7Ci0JbmV3
X3ZhbCB8PSAofmVuYWJsZWRfaXJxX21hc2sgJiBpbnRlcnJ1cHRfbWFzayk7Ci0KLQlpZiAobmV3
X3ZhbCAhPSBndC0+cG1faW1yKSB7Ci0JCWd0LT5wbV9pbXIgPSBuZXdfdmFsOwotCQl3cml0ZV9w
bV9pbXIoZ3QpOwotCX0KLX0KLQotdm9pZCBnZW42X3VubWFza19wbV9pcnEoc3RydWN0IGludGVs
X2d0ICpndCwgdTMyIG1hc2spCi17Ci0JaWYgKFdBUk5fT04oIWludGVsX2lycXNfZW5hYmxlZChn
dC0+aTkxNSkpKQotCQlyZXR1cm47Ci0KLQlzbmJfdXBkYXRlX3BtX2lycShndCwgbWFzaywgbWFz
ayk7Ci19Ci0KLXN0YXRpYyB2b2lkIF9fZ2VuNl9tYXNrX3BtX2lycShzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0LCB1MzIgbWFzaykKLXsKLQlzbmJfdXBkYXRlX3BtX2lycShndCwgbWFzaywgMCk7Ci19Ci0K
LXZvaWQgZ2VuNl9tYXNrX3BtX2lycShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1MzIgbWFzaykKLXsK
LQlpZiAoV0FSTl9PTighaW50ZWxfaXJxc19lbmFibGVkKGd0LT5pOTE1KSkpCi0JCXJldHVybjsK
LQotCV9fZ2VuNl9tYXNrX3BtX2lycShndCwgbWFzayk7Ci19Ci0KLXN0YXRpYyB2b2lkIGdlbjZf
cmVzZXRfcG1faWlyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHJlc2V0
X21hc2spCi17Ci0JaTkxNV9yZWdfdCByZWcgPSBnZW42X3BtX2lpcihkZXZfcHJpdik7Ci0KLQls
b2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+aXJxX2xvY2spOwotCi0JSTkxNV9XUklURShy
ZWcsIHJlc2V0X21hc2spOwotCUk5MTVfV1JJVEUocmVnLCByZXNldF9tYXNrKTsKLQlQT1NUSU5H
X1JFQUQocmVnKTsKLX0KLQotc3RhdGljIHZvaWQgZ2VuNl9lbmFibGVfcG1faXJxKHN0cnVjdCBp
bnRlbF9ndCAqZ3QsIHUzMiBlbmFibGVfbWFzaykKLXsKLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZn
dC0+aTkxNS0+aXJxX2xvY2spOwotCi0JZ3QtPnBtX2llciB8PSBlbmFibGVfbWFzazsKLQl3cml0
ZV9wbV9pZXIoZ3QpOwotCWdlbjZfdW5tYXNrX3BtX2lycShndCwgZW5hYmxlX21hc2spOwotCS8q
IHVubWFza19wbV9pcnEgcHJvdmlkZXMgYW4gaW1wbGljaXQgYmFycmllciAoUE9TVElOR19SRUFE
KSAqLwotfQotCi1zdGF0aWMgdm9pZCBnZW42X2Rpc2FibGVfcG1faXJxKHN0cnVjdCBpbnRlbF9n
dCAqZ3QsIHUzMiBkaXNhYmxlX21hc2spCi17Ci0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZ3QtPmk5
MTUtPmlycV9sb2NrKTsKLQotCWd0LT5wbV9pZXIgJj0gfmRpc2FibGVfbWFzazsKLQlfX2dlbjZf
bWFza19wbV9pcnEoZ3QsIGRpc2FibGVfbWFzayk7Ci0Jd3JpdGVfcG1faWVyKGd0KTsKLQkvKiB0
aG91Z2ggYSBiYXJyaWVyIGlzIG1pc3NpbmcgaGVyZSwgYnV0IGRvbid0IHJlYWxseSBuZWVkIGEg
b25lICovCi19Ci0KLXZvaWQgZ2VuMTFfcmVzZXRfcnBzX2ludGVycnVwdHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFf
bG9jayk7Ci0KLQl3aGlsZSAoZ2VuMTFfcmVzZXRfb25lX2lpcigmZGV2X3ByaXYtPmd0LCAwLCBH
RU4xMV9HVFBNKSkKLQkJOwotCi0JZGV2X3ByaXYtPmd0X3BtLnJwcy5wbV9paXIgPSAwOwotCi0J
c3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwotfQotCi12b2lkIGdlbjZfcmVz
ZXRfcnBzX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewot
CXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Ci0JZ2VuNl9yZXNldF9wbV9paXIo
ZGV2X3ByaXYsIEdFTjZfUE1fUlBTX0VWRU5UUyk7Ci0JZGV2X3ByaXYtPmd0X3BtLnJwcy5wbV9p
aXIgPSAwOwotCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKLX0KLQotdm9p
ZCBnZW42X2VuYWJsZV9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9ICZkZXZfcHJpdi0+Z3Q7Ci0Jc3RydWN0
IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0KLQlpZiAoUkVBRF9PTkNF
KHJwcy0+aW50ZXJydXB0c19lbmFibGVkKSkKLQkJcmV0dXJuOwotCi0Jc3Bpbl9sb2NrX2lycSgm
ZGV2X3ByaXYtPmlycV9sb2NrKTsKLQlXQVJOX09OX09OQ0UocnBzLT5wbV9paXIpOwotCi0JaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCi0JCVdBUk5fT05fT05DRShnZW4xMV9yZXNldF9v
bmVfaWlyKGd0LCAwLCBHRU4xMV9HVFBNKSk7Ci0JZWxzZQotCQlXQVJOX09OX09OQ0UoSTkxNV9S
RUFEKGdlbjZfcG1faWlyKGRldl9wcml2KSkgJiBkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyk7Ci0K
LQlycHMtPmludGVycnVwdHNfZW5hYmxlZCA9IHRydWU7Ci0JZ2VuNl9lbmFibGVfcG1faXJxKGd0
LCBkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyk7Ci0KLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2
LT5pcnFfbG9jayk7Ci19Ci0KLXZvaWQgZ2VuNl9kaXNhYmxlX3Jwc19pbnRlcnJ1cHRzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMg
PSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKLQotCWlmICghUkVBRF9PTkNFKHJwcy0+aW50ZXJydXB0
c19lbmFibGVkKSkKLQkJcmV0dXJuOwotCi0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9s
b2NrKTsKLQlycHMtPmludGVycnVwdHNfZW5hYmxlZCA9IGZhbHNlOwotCi0JSTkxNV9XUklURShH
RU42X1BNSU5UUk1TSywgZ2VuNl9zYW5pdGl6ZV9ycHNfcG1fbWFzayhkZXZfcHJpdiwgfjB1KSk7
Ci0KLQlnZW42X2Rpc2FibGVfcG1faXJxKCZkZXZfcHJpdi0+Z3QsIEdFTjZfUE1fUlBTX0VWRU5U
Uyk7Ci0KLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7Ci0JaW50ZWxfc3lu
Y2hyb25pemVfaXJxKGRldl9wcml2KTsKLQotCS8qIE5vdyB0aGF0IHdlIHdpbGwgbm90IGJlIGdl
bmVyYXRpbmcgYW55IG1vcmUgd29yaywgZmx1c2ggYW55Ci0JICogb3V0c3RhbmRpbmcgdGFza3Mu
IEFzIHdlIGFyZSBjYWxsZWQgb24gdGhlIFJQUyBpZGxlIHBhdGgsCi0JICogd2Ugd2lsbCByZXNl
dCB0aGUgR1BVIHRvIG1pbmltdW0gZnJlcXVlbmNpZXMsIHNvIHRoZSBjdXJyZW50Ci0JICogc3Rh
dGUgb2YgdGhlIHdvcmtlciBjYW4gYmUgZGlzY2FyZGVkLgotCSAqLwotCWNhbmNlbF93b3JrX3N5
bmMoJnJwcy0+d29yayk7Ci0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCi0JCWdlbjEx
X3Jlc2V0X3Jwc19pbnRlcnJ1cHRzKGRldl9wcml2KTsKLQllbHNlCi0JCWdlbjZfcmVzZXRfcnBz
X2ludGVycnVwdHMoZGV2X3ByaXYpOwotfQotCi12b2lkIGdlbjlfcmVzZXRfZ3VjX2ludGVycnVw
dHMoc3RydWN0IGludGVsX2d1YyAqZ3VjKQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBndWNf
dG9fZ3QoZ3VjKTsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1Owot
Ci0JYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKCZpOTE1LT5ydW50aW1lX3BtKTsKLQotCXNwaW5f
bG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKLQlnZW42X3Jlc2V0X3BtX2lpcihpOTE1LCBndC0+
cG1fZ3VjX2V2ZW50cyk7Ci0Jc3Bpbl91bmxvY2tfaXJxKCZpOTE1LT5pcnFfbG9jayk7Ci19Ci0K
LXZvaWQgZ2VuOV9lbmFibGVfZ3VjX2ludGVycnVwdHMoc3RydWN0IGludGVsX2d1YyAqZ3VjKQot
ewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBndWNfdG9fZ3QoZ3VjKTsKLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1OwotCi0JYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxk
KCZpOTE1LT5ydW50aW1lX3BtKTsKLQotCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsK
LQlpZiAoIWd1Yy0+aW50ZXJydXB0cy5lbmFibGVkKSB7Ci0JCVdBUk5fT05fT05DRShpbnRlbF91
bmNvcmVfcmVhZChndC0+dW5jb3JlLCBnZW42X3BtX2lpcihpOTE1KSkgJgotCQkJICAgICBndC0+
cG1fZ3VjX2V2ZW50cyk7Ci0JCWd1Yy0+aW50ZXJydXB0cy5lbmFibGVkID0gdHJ1ZTsKLQkJZ2Vu
Nl9lbmFibGVfcG1faXJxKGd0LCBndC0+cG1fZ3VjX2V2ZW50cyk7Ci0JfQotCXNwaW5fdW5sb2Nr
X2lycSgmaTkxNS0+aXJxX2xvY2spOwotfQotCi12b2lkIGdlbjlfZGlzYWJsZV9ndWNfaW50ZXJy
dXB0cyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCi17Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9IGd1
Y190b19ndChndWMpOwotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7
Ci0KLQlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoJmk5MTUtPnJ1bnRpbWVfcG0pOwotCi0Jc3Bp
bl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2spOwotCWd1Yy0+aW50ZXJydXB0cy5lbmFibGVkID0g
ZmFsc2U7Ci0KLQlnZW42X2Rpc2FibGVfcG1faXJxKGd0LCBndC0+cG1fZ3VjX2V2ZW50cyk7Ci0K
LQlzcGluX3VubG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKLQlpbnRlbF9zeW5jaHJvbml6ZV9p
cnEoaTkxNSk7Ci0KLQlnZW45X3Jlc2V0X2d1Y19pbnRlcnJ1cHRzKGd1Yyk7Ci19Ci0KLXZvaWQg
Z2VuMTFfcmVzZXRfZ3VjX2ludGVycnVwdHMoc3RydWN0IGludGVsX2d1YyAqZ3VjKQotewotCXN0
cnVjdCBpbnRlbF9ndCAqZ3QgPSBndWNfdG9fZ3QoZ3VjKTsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IGd0LT5pOTE1OwotCi0Jc3Bpbl9sb2NrX2lycSgmaTkxNS0+aXJxX2xvY2sp
OwotCWdlbjExX3Jlc2V0X29uZV9paXIoZ3QsIDAsIEdFTjExX0dVQyk7Ci0Jc3Bpbl91bmxvY2tf
aXJxKCZpOTE1LT5pcnFfbG9jayk7Ci19Ci0KLXZvaWQgZ2VuMTFfZW5hYmxlX2d1Y19pbnRlcnJ1
cHRzKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKLXsKLQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gZ3Vj
X3RvX2d0KGd1Yyk7Ci0KLQlzcGluX2xvY2tfaXJxKCZndC0+aTkxNS0+aXJxX2xvY2spOwotCWlm
ICghZ3VjLT5pbnRlcnJ1cHRzLmVuYWJsZWQpIHsKLQkJdTMyIGV2ZW50cyA9IFJFR19GSUVMRF9Q
UkVQKEVOR0lORTFfTUFTSywgR1VDX0lOVFJfR1VDMkhPU1QpOwotCi0JCVdBUk5fT05fT05DRShn
ZW4xMV9yZXNldF9vbmVfaWlyKGd0LCAwLCBHRU4xMV9HVUMpKTsKLQkJaW50ZWxfdW5jb3JlX3dy
aXRlKGd0LT51bmNvcmUsIEdFTjExX0dVQ19TR19JTlRSX0VOQUJMRSwgZXZlbnRzKTsKLQkJaW50
ZWxfdW5jb3JlX3dyaXRlKGd0LT51bmNvcmUsIEdFTjExX0dVQ19TR19JTlRSX01BU0ssIH5ldmVu
dHMpOwotCQlndWMtPmludGVycnVwdHMuZW5hYmxlZCA9IHRydWU7Ci0JfQotCXNwaW5fdW5sb2Nr
X2lycSgmZ3QtPmk5MTUtPmlycV9sb2NrKTsKLX0KLQotdm9pZCBnZW4xMV9kaXNhYmxlX2d1Y19p
bnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKLXsKLQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0
ID0gZ3VjX3RvX2d0KGd1Yyk7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+
aTkxNTsKLQotCXNwaW5fbG9ja19pcnEoJmk5MTUtPmlycV9sb2NrKTsKLQlndWMtPmludGVycnVw
dHMuZW5hYmxlZCA9IGZhbHNlOwotCi0JaW50ZWxfdW5jb3JlX3dyaXRlKGd0LT51bmNvcmUsIEdF
TjExX0dVQ19TR19JTlRSX01BU0ssIH4wKTsKLQlpbnRlbF91bmNvcmVfd3JpdGUoZ3QtPnVuY29y
ZSwgR0VOMTFfR1VDX1NHX0lOVFJfRU5BQkxFLCAwKTsKLQotCXNwaW5fdW5sb2NrX2lycSgmaTkx
NS0+aXJxX2xvY2spOwotCWludGVsX3N5bmNocm9uaXplX2lycShpOTE1KTsKLQotCWdlbjExX3Jl
c2V0X2d1Y19pbnRlcnJ1cHRzKGd1Yyk7Ci19Ci0KIC8qKgogICogYmR3X3VwZGF0ZV9wb3J0X2ly
cSAtIHVwZGF0ZSBERSBwb3J0IGludGVycnVwdAogICogQGRldl9wcml2OiBkcml2ZXIgcHJpdmF0
ZQpAQCAtMTI2MiwxOTggKzg5Myw2IEBAIGludCBpbnRlbF9nZXRfY3J0Y19zY2FubGluZShzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YykKIAlyZXR1cm4gcG9zaXRpb247CiB9CiAKLXN0YXRpYyB2b2lk
IGlyb25sYWtlX3Jwc19jaGFuZ2VfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQotewotCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+
dW5jb3JlOwotCXUzMiBidXN5X3VwLCBidXN5X2Rvd24sIG1heF9hdmcsIG1pbl9hdmc7Ci0JdTgg
bmV3X2RlbGF5OwotCi0Jc3Bpbl9sb2NrKCZtY2hkZXZfbG9jayk7Ci0KLQlpbnRlbF91bmNvcmVf
d3JpdGUxNih1bmNvcmUsCi0JCQkgICAgIE1FTUlOVFJTVFMsCi0JCQkgICAgIGludGVsX3VuY29y
ZV9yZWFkKHVuY29yZSwgTUVNSU5UUlNUUykpOwotCi0JbmV3X2RlbGF5ID0gZGV2X3ByaXYtPmlw
cy5jdXJfZGVsYXk7Ci0KLQlpbnRlbF91bmNvcmVfd3JpdGUxNih1bmNvcmUsIE1FTUlOVFJTVFMs
IE1FTUlOVF9FVkFMX0NIRyk7Ci0JYnVzeV91cCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwg
UkNQUkVWQlNZVFVQQVZHKTsKLQlidXN5X2Rvd24gPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IFJDUFJFVkJTWVRETkFWRyk7Ci0JbWF4X2F2ZyA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwg
UkNCTUFYQVZHKTsKLQltaW5fYXZnID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBSQ0JNSU5B
VkcpOwotCi0JLyogSGFuZGxlIFJDUyBjaGFuZ2UgcmVxdWVzdCBmcm9tIGh3ICovCi0JaWYgKGJ1
c3lfdXAgPiBtYXhfYXZnKSB7Ci0JCWlmIChkZXZfcHJpdi0+aXBzLmN1cl9kZWxheSAhPSBkZXZf
cHJpdi0+aXBzLm1heF9kZWxheSkKLQkJCW5ld19kZWxheSA9IGRldl9wcml2LT5pcHMuY3VyX2Rl
bGF5IC0gMTsKLQkJaWYgKG5ld19kZWxheSA8IGRldl9wcml2LT5pcHMubWF4X2RlbGF5KQotCQkJ
bmV3X2RlbGF5ID0gZGV2X3ByaXYtPmlwcy5tYXhfZGVsYXk7Ci0JfSBlbHNlIGlmIChidXN5X2Rv
d24gPCBtaW5fYXZnKSB7Ci0JCWlmIChkZXZfcHJpdi0+aXBzLmN1cl9kZWxheSAhPSBkZXZfcHJp
di0+aXBzLm1pbl9kZWxheSkKLQkJCW5ld19kZWxheSA9IGRldl9wcml2LT5pcHMuY3VyX2RlbGF5
ICsgMTsKLQkJaWYgKG5ld19kZWxheSA+IGRldl9wcml2LT5pcHMubWluX2RlbGF5KQotCQkJbmV3
X2RlbGF5ID0gZGV2X3ByaXYtPmlwcy5taW5fZGVsYXk7Ci0JfQotCi0JaWYgKGlyb25sYWtlX3Nl
dF9kcnBzKGRldl9wcml2LCBuZXdfZGVsYXkpKQotCQlkZXZfcHJpdi0+aXBzLmN1cl9kZWxheSA9
IG5ld19kZWxheTsKLQotCXNwaW5fdW5sb2NrKCZtY2hkZXZfbG9jayk7Ci0KLQlyZXR1cm47Ci19
Ci0KLXN0YXRpYyB2b2lkIHZsdl9jMF9yZWFkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKLQkJCXN0cnVjdCBpbnRlbF9ycHNfZWkgKmVpKQotewotCWVpLT5rdGltZSA9IGt0aW1l
X2dldF9yYXcoKTsKLQllaS0+cmVuZGVyX2MwID0gSTkxNV9SRUFEKFZMVl9SRU5ERVJfQzBfQ09V
TlQpOwotCWVpLT5tZWRpYV9jMCA9IEk5MTVfUkVBRChWTFZfTUVESUFfQzBfQ09VTlQpOwotfQot
Ci12b2lkIGdlbjZfcnBzX3Jlc2V0X2VpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKLXsKLQltZW1zZXQoJmRldl9wcml2LT5ndF9wbS5ycHMuZWksIDAsIHNpemVvZihkZXZfcHJp
di0+Z3RfcG0ucnBzLmVpKSk7Ci19Ci0KLXN0YXRpYyB1MzIgdmx2X3dhX2MwX2VpKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHBtX2lpcikKLXsKLQlzdHJ1Y3QgaW50ZWxf
cnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKLQljb25zdCBzdHJ1Y3QgaW50ZWxfcnBz
X2VpICpwcmV2ID0gJnJwcy0+ZWk7Ci0Jc3RydWN0IGludGVsX3Jwc19laSBub3c7Ci0JdTMyIGV2
ZW50cyA9IDA7Ci0KLQlpZiAoKHBtX2lpciAmIEdFTjZfUE1fUlBfVVBfRUlfRVhQSVJFRCkgPT0g
MCkKLQkJcmV0dXJuIDA7Ci0KLQl2bHZfYzBfcmVhZChkZXZfcHJpdiwgJm5vdyk7Ci0KLQlpZiAo
cHJldi0+a3RpbWUpIHsKLQkJdTY0IHRpbWUsIGMwOwotCQl1MzIgcmVuZGVyLCBtZWRpYTsKLQot
CQl0aW1lID0ga3RpbWVfdXNfZGVsdGEobm93Lmt0aW1lLCBwcmV2LT5rdGltZSk7Ci0KLQkJdGlt
ZSAqPSBkZXZfcHJpdi0+Y3pjbGtfZnJlcTsKLQotCQkvKiBXb3JrbG9hZCBjYW4gYmUgc3BsaXQg
YmV0d2VlbiByZW5kZXIgKyBtZWRpYSwKLQkJICogZS5nLiBTd2FwQnVmZmVycyBiZWluZyBibGl0
dGVkIGluIFggYWZ0ZXIgYmVpbmcgcmVuZGVyZWQgaW4KLQkJICogbWVzYS4gVG8gYWNjb3VudCBm
b3IgdGhpcyB3ZSBuZWVkIHRvIGNvbWJpbmUgYm90aCBlbmdpbmVzCi0JCSAqIGludG8gb3VyIGFj
dGl2aXR5IGNvdW50ZXIuCi0JCSAqLwotCQlyZW5kZXIgPSBub3cucmVuZGVyX2MwIC0gcHJldi0+
cmVuZGVyX2MwOwotCQltZWRpYSA9IG5vdy5tZWRpYV9jMCAtIHByZXYtPm1lZGlhX2MwOwotCQlj
MCA9IG1heChyZW5kZXIsIG1lZGlhKTsKLQkJYzAgKj0gMTAwMCAqIDEwMCA8PCA4OyAvKiB0byB1
c2VjcyBhbmQgc2NhbGUgdG8gdGhyZXNob2xkJSAqLwotCi0JCWlmIChjMCA+IHRpbWUgKiBycHMt
PnBvd2VyLnVwX3RocmVzaG9sZCkKLQkJCWV2ZW50cyA9IEdFTjZfUE1fUlBfVVBfVEhSRVNIT0xE
OwotCQllbHNlIGlmIChjMCA8IHRpbWUgKiBycHMtPnBvd2VyLmRvd25fdGhyZXNob2xkKQotCQkJ
ZXZlbnRzID0gR0VONl9QTV9SUF9ET1dOX1RIUkVTSE9MRDsKLQl9Ci0KLQlycHMtPmVpID0gbm93
OwotCXJldHVybiBldmVudHM7Ci19Ci0KLXN0YXRpYyB2b2lkIGdlbjZfcG1fcnBzX3dvcmsoc3Ry
dWN0IHdvcmtfc3RydWN0ICp3b3JrKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9Ci0JCWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwgZ3Rf
cG0ucnBzLndvcmspOwotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0u
cnBzOwotCWJvb2wgY2xpZW50X2Jvb3N0ID0gZmFsc2U7Ci0JaW50IG5ld19kZWxheSwgYWRqLCBt
aW4sIG1heDsKLQl1MzIgcG1faWlyID0gMDsKLQotCXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5p
cnFfbG9jayk7Ci0JaWYgKHJwcy0+aW50ZXJydXB0c19lbmFibGVkKSB7Ci0JCXBtX2lpciA9IGZl
dGNoX2FuZF96ZXJvKCZycHMtPnBtX2lpcik7Ci0JCWNsaWVudF9ib29zdCA9IGF0b21pY19yZWFk
KCZycHMtPm51bV93YWl0ZXJzKTsKLQl9Ci0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJx
X2xvY2spOwotCi0JLyogTWFrZSBzdXJlIHdlIGRpZG4ndCBxdWV1ZSBhbnl0aGluZyB3ZSdyZSBu
b3QgZ29pbmcgdG8gcHJvY2Vzcy4gKi8KLQlXQVJOX09OKHBtX2lpciAmIH5kZXZfcHJpdi0+cG1f
cnBzX2V2ZW50cyk7Ci0JaWYgKChwbV9paXIgJiBkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cykgPT0g
MCAmJiAhY2xpZW50X2Jvb3N0KQotCQlnb3RvIG91dDsKLQotCW11dGV4X2xvY2soJnJwcy0+bG9j
ayk7Ci0KLQlwbV9paXIgfD0gdmx2X3dhX2MwX2VpKGRldl9wcml2LCBwbV9paXIpOwotCi0JYWRq
ID0gcnBzLT5sYXN0X2FkajsKLQluZXdfZGVsYXkgPSBycHMtPmN1cl9mcmVxOwotCW1pbiA9IHJw
cy0+bWluX2ZyZXFfc29mdGxpbWl0OwotCW1heCA9IHJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0Owot
CWlmIChjbGllbnRfYm9vc3QpCi0JCW1heCA9IHJwcy0+bWF4X2ZyZXE7Ci0JaWYgKGNsaWVudF9i
b29zdCAmJiBuZXdfZGVsYXkgPCBycHMtPmJvb3N0X2ZyZXEpIHsKLQkJbmV3X2RlbGF5ID0gcnBz
LT5ib29zdF9mcmVxOwotCQlhZGogPSAwOwotCX0gZWxzZSBpZiAocG1faWlyICYgR0VONl9QTV9S
UF9VUF9USFJFU0hPTEQpIHsKLQkJaWYgKGFkaiA+IDApCi0JCQlhZGogKj0gMjsKLQkJZWxzZSAv
KiBDSFYgbmVlZHMgZXZlbiBlbmNvZGUgdmFsdWVzICovCi0JCQlhZGogPSBJU19DSEVSUllWSUVX
KGRldl9wcml2KSA/IDIgOiAxOwotCi0JCWlmIChuZXdfZGVsYXkgPj0gcnBzLT5tYXhfZnJlcV9z
b2Z0bGltaXQpCi0JCQlhZGogPSAwOwotCX0gZWxzZSBpZiAoY2xpZW50X2Jvb3N0KSB7Ci0JCWFk
aiA9IDA7Ci0JfSBlbHNlIGlmIChwbV9paXIgJiBHRU42X1BNX1JQX0RPV05fVElNRU9VVCkgewot
CQlpZiAocnBzLT5jdXJfZnJlcSA+IHJwcy0+ZWZmaWNpZW50X2ZyZXEpCi0JCQluZXdfZGVsYXkg
PSBycHMtPmVmZmljaWVudF9mcmVxOwotCQllbHNlIGlmIChycHMtPmN1cl9mcmVxID4gcnBzLT5t
aW5fZnJlcV9zb2Z0bGltaXQpCi0JCQluZXdfZGVsYXkgPSBycHMtPm1pbl9mcmVxX3NvZnRsaW1p
dDsKLQkJYWRqID0gMDsKLQl9IGVsc2UgaWYgKHBtX2lpciAmIEdFTjZfUE1fUlBfRE9XTl9USFJF
U0hPTEQpIHsKLQkJaWYgKGFkaiA8IDApCi0JCQlhZGogKj0gMjsKLQkJZWxzZSAvKiBDSFYgbmVl
ZHMgZXZlbiBlbmNvZGUgdmFsdWVzICovCi0JCQlhZGogPSBJU19DSEVSUllWSUVXKGRldl9wcml2
KSA/IC0yIDogLTE7Ci0KLQkJaWYgKG5ld19kZWxheSA8PSBycHMtPm1pbl9mcmVxX3NvZnRsaW1p
dCkKLQkJCWFkaiA9IDA7Ci0JfSBlbHNlIHsgLyogdW5rbm93biBldmVudCAqLwotCQlhZGogPSAw
OwotCX0KLQotCXJwcy0+bGFzdF9hZGogPSBhZGo7Ci0KLQkvKgotCSAqIExpbWl0IGRlYm9vc3Rp
bmcgYW5kIGJvb3N0aW5nIHRvIGtlZXAgb3Vyc2VsdmVzIGF0IHRoZSBleHRyZW1lcwotCSAqIHdo
ZW4gaW4gdGhlIHJlc3BlY3RpdmUgcG93ZXIgbW9kZXMgKGkuZS4gc2xvd2x5IGRlY3JlYXNlIGZy
ZXF1ZW5jaWVzCi0JICogd2hpbGUgaW4gdGhlIEhJR0hfUE9XRVIgem9uZSBhbmQgc2xvd2x5IGlu
Y3JlYXNlIGZyZXF1ZW5jaWVzIHdoaWxlCi0JICogaW4gdGhlIExPV19QT1dFUiB6b25lKS4gT24g
aWRsZSwgd2Ugd2lsbCBoaXQgdGhlIHRpbWVvdXQgYW5kIGRyb3AKLQkgKiB0byB0aGUgbmV4dCBs
ZXZlbCBxdWlja2x5LCBhbmQgY29udmVyc2VseSBpZiBidXN5IHdlIGV4cGVjdCB0bwotCSAqIGhp
dCBhIHdhaXRib29zdCBhbmQgcmFwaWRseSBzd2l0Y2ggaW50byBtYXggcG93ZXIuCi0JICovCi0J
aWYgKChhZGogPCAwICYmIHJwcy0+cG93ZXIubW9kZSA9PSBISUdIX1BPV0VSKSB8fAotCSAgICAo
YWRqID4gMCAmJiBycHMtPnBvd2VyLm1vZGUgPT0gTE9XX1BPV0VSKSkKLQkJcnBzLT5sYXN0X2Fk
aiA9IDA7Ci0KLQkvKiBzeXNmcyBmcmVxdWVuY3kgaW50ZXJmYWNlcyBtYXkgaGF2ZSBzbnVjayBp
biB3aGlsZSBzZXJ2aWNpbmcgdGhlCi0JICogaW50ZXJydXB0Ci0JICovCi0JbmV3X2RlbGF5ICs9
IGFkajsKLQluZXdfZGVsYXkgPSBjbGFtcF90KGludCwgbmV3X2RlbGF5LCBtaW4sIG1heCk7Ci0K
LQlpZiAoaW50ZWxfc2V0X3JwcyhkZXZfcHJpdiwgbmV3X2RlbGF5KSkgewotCQlEUk1fREVCVUdf
RFJJVkVSKCJGYWlsZWQgdG8gc2V0IG5ldyBHUFUgZnJlcXVlbmN5XG4iKTsKLQkJcnBzLT5sYXN0
X2FkaiA9IDA7Ci0JfQotCi0JbXV0ZXhfdW5sb2NrKCZycHMtPmxvY2spOwotCi1vdXQ6Ci0JLyog
TWFrZSBzdXJlIG5vdCB0byBjb3JydXB0IFBNSU1SIHN0YXRlIHVzZWQgYnkgcmluZ2J1ZmZlciBv
biBHRU42ICovCi0Jc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKLQlpZiAocnBz
LT5pbnRlcnJ1cHRzX2VuYWJsZWQpCi0JCWdlbjZfdW5tYXNrX3BtX2lycSgmZGV2X3ByaXYtPmd0
LCBkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyk7Ci0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+
aXJxX2xvY2spOwotfQotCi0KIC8qKgogICogaXZ5YnJpZGdlX3Bhcml0eV93b3JrIC0gV29ya3F1
ZXVlIGNhbGxlZCB3aGVuIGEgcGFyaXR5IGVycm9yIGludGVycnVwdAogICogb2NjdXJyZWQuCkBA
IC0xNDY3LDYgKzkwNiw3IEBAIHN0YXRpYyB2b2lkIGl2eWJyaWRnZV9wYXJpdHlfd29yayhzdHJ1
Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0KIAkJY29udGFpbmVyX29mKHdvcmssIHR5cGVvZigqZGV2X3ByaXYpLCBsM19wYXJpdHku
ZXJyb3Jfd29yayk7CisJc3RydWN0IGludGVsX2d0ICpndCA9ICZkZXZfcHJpdi0+Z3Q7CiAJdTMy
IGVycm9yX3N0YXR1cywgcm93LCBiYW5rLCBzdWJiYW5rOwogCWNoYXIgKnBhcml0eV9ldmVudFs2
XTsKIAl1MzIgbWlzY2NwY3RsOwpAQCAtMTUyOCwxNDQgKzk2OCwxMyBAQCBzdGF0aWMgdm9pZCBp
dnlicmlkZ2VfcGFyaXR5X3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogCiBvdXQ6CiAJ
V0FSTl9PTihkZXZfcHJpdi0+bDNfcGFyaXR5LndoaWNoX3NsaWNlKTsKLQlzcGluX2xvY2tfaXJx
KCZkZXZfcHJpdi0+aXJxX2xvY2spOwotCWdlbjVfZW5hYmxlX2d0X2lycShkZXZfcHJpdiwgR1Rf
UEFSSVRZX0VSUk9SKGRldl9wcml2KSk7Ci0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJx
X2xvY2spOworCXNwaW5fbG9ja19pcnEoJmd0LT5pcnFfbG9jayk7CisJZ2VuNV9ndF9lbmFibGVf
aXJxKGd0LCBHVF9QQVJJVFlfRVJST1IoZGV2X3ByaXYpKTsKKwlzcGluX3VubG9ja19pcnEoJmd0
LT5pcnFfbG9jayk7CiAKIAltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4
KTsKIH0KIAotc3RhdGljIHZvaWQgaXZ5YnJpZGdlX3Bhcml0eV9lcnJvcl9pcnFfaGFuZGxlcihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJCSAgICAgICB1MzIgaWlyKQot
ewotCWlmICghSEFTX0wzX0RQRihkZXZfcHJpdikpCi0JCXJldHVybjsKLQotCXNwaW5fbG9jaygm
ZGV2X3ByaXYtPmlycV9sb2NrKTsKLQlnZW41X2Rpc2FibGVfZ3RfaXJxKGRldl9wcml2LCBHVF9Q
QVJJVFlfRVJST1IoZGV2X3ByaXYpKTsKLQlzcGluX3VubG9jaygmZGV2X3ByaXYtPmlycV9sb2Nr
KTsKLQotCWlpciAmPSBHVF9QQVJJVFlfRVJST1IoZGV2X3ByaXYpOwotCWlmIChpaXIgJiBHVF9S
RU5ERVJfTDNfUEFSSVRZX0VSUk9SX0lOVEVSUlVQVF9TMSkKLQkJZGV2X3ByaXYtPmwzX3Bhcml0
eS53aGljaF9zbGljZSB8PSAxIDw8IDE7Ci0KLQlpZiAoaWlyICYgR1RfUkVOREVSX0wzX1BBUklU
WV9FUlJPUl9JTlRFUlJVUFQpCi0JCWRldl9wcml2LT5sM19wYXJpdHkud2hpY2hfc2xpY2UgfD0g
MSA8PCAwOwotCi0JcXVldWVfd29yayhkZXZfcHJpdi0+d3EsICZkZXZfcHJpdi0+bDNfcGFyaXR5
LmVycm9yX3dvcmspOwotfQotCi1zdGF0aWMgdm9pZCBpbGtfZ3RfaXJxX2hhbmRsZXIoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJICAgICAgIHUzMiBndF9paXIpCi17Ci0J
aWYgKGd0X2lpciAmIEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVCkKLQkJaW50ZWxfZW5naW5lX2Jy
ZWFkY3J1bWJzX2lycShkZXZfcHJpdi0+ZW5naW5lW1JDUzBdKTsKLQlpZiAoZ3RfaWlyICYgSUxL
X0JTRF9VU0VSX0lOVEVSUlVQVCkKLQkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycShkZXZf
cHJpdi0+ZW5naW5lW1ZDUzBdKTsKLX0KLQotc3RhdGljIHZvaWQgc25iX2d0X2lycV9oYW5kbGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAgICAgICB1MzIgZ3RfaWly
KQotewotCWlmIChndF9paXIgJiBHVF9SRU5ERVJfVVNFUl9JTlRFUlJVUFQpCi0JCWludGVsX2Vu
Z2luZV9icmVhZGNydW1ic19pcnEoZGV2X3ByaXYtPmVuZ2luZVtSQ1MwXSk7Ci0JaWYgKGd0X2lp
ciAmIEdUX0JTRF9VU0VSX0lOVEVSUlVQVCkKLQkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2ly
cShkZXZfcHJpdi0+ZW5naW5lW1ZDUzBdKTsKLQlpZiAoZ3RfaWlyICYgR1RfQkxUX1VTRVJfSU5U
RVJSVVBUKQotCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGRldl9wcml2LT5lbmdpbmVb
QkNTMF0pOwotCi0JaWYgKGd0X2lpciAmIChHVF9CTFRfQ1NfRVJST1JfSU5URVJSVVBUIHwKLQkJ
ICAgICAgR1RfQlNEX0NTX0VSUk9SX0lOVEVSUlVQVCB8Ci0JCSAgICAgIEdUX1JFTkRFUl9DU19N
QVNURVJfRVJST1JfSU5URVJSVVBUKSkKLQkJRFJNX0RFQlVHKCJDb21tYW5kIHBhcnNlciBlcnJv
ciwgZ3RfaWlyIDB4JTA4eFxuIiwgZ3RfaWlyKTsKLQotCWlmIChndF9paXIgJiBHVF9QQVJJVFlf
RVJST1IoZGV2X3ByaXYpKQotCQlpdnlicmlkZ2VfcGFyaXR5X2Vycm9yX2lycV9oYW5kbGVyKGRl
dl9wcml2LCBndF9paXIpOwotfQotCi1zdGF0aWMgdm9pZAotZ2VuOF9jc19pcnFfaGFuZGxlcihz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiBpaXIpCi17Ci0JYm9vbCB0YXNrbGV0
ID0gZmFsc2U7Ci0KLQlpZiAoaWlyICYgR1RfQ09OVEVYVF9TV0lUQ0hfSU5URVJSVVBUKQotCQl0
YXNrbGV0ID0gdHJ1ZTsKLQotCWlmIChpaXIgJiBHVF9SRU5ERVJfVVNFUl9JTlRFUlJVUFQpIHsK
LQkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycShlbmdpbmUpOwotCQl0YXNrbGV0IHw9IGlu
dGVsX2VuZ2luZV9uZWVkc19icmVhZGNydW1iX3Rhc2tsZXQoZW5naW5lKTsKLQl9Ci0KLQlpZiAo
dGFza2xldCkKLQkJdGFza2xldF9oaV9zY2hlZHVsZSgmZW5naW5lLT5leGVjbGlzdHMudGFza2xl
dCk7Ci19Ci0KLXN0YXRpYyB2b2lkIGdlbjhfZ3RfaXJxX2FjayhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKLQkJCSAgICB1MzIgbWFzdGVyX2N0bCwgdTMyIGd0X2lpcls0XSkKLXsKLQl2
b2lkIF9faW9tZW0gKiBjb25zdCByZWdzID0gaTkxNS0+dW5jb3JlLnJlZ3M7Ci0KLSNkZWZpbmUg
R0VOOF9HVF9JUlFTIChHRU44X0dUX1JDU19JUlEgfCBcCi0JCSAgICAgIEdFTjhfR1RfQkNTX0lS
USB8IFwKLQkJICAgICAgR0VOOF9HVF9WQ1MwX0lSUSB8IFwKLQkJICAgICAgR0VOOF9HVF9WQ1Mx
X0lSUSB8IFwKLQkJICAgICAgR0VOOF9HVF9WRUNTX0lSUSB8IFwKLQkJICAgICAgR0VOOF9HVF9Q
TV9JUlEgfCBcCi0JCSAgICAgIEdFTjhfR1RfR1VDX0lSUSkKLQotCWlmIChtYXN0ZXJfY3RsICYg
KEdFTjhfR1RfUkNTX0lSUSB8IEdFTjhfR1RfQkNTX0lSUSkpIHsKLQkJZ3RfaWlyWzBdID0gcmF3
X3JlZ19yZWFkKHJlZ3MsIEdFTjhfR1RfSUlSKDApKTsKLQkJaWYgKGxpa2VseShndF9paXJbMF0p
KQotCQkJcmF3X3JlZ193cml0ZShyZWdzLCBHRU44X0dUX0lJUigwKSwgZ3RfaWlyWzBdKTsKLQl9
Ci0KLQlpZiAobWFzdGVyX2N0bCAmIChHRU44X0dUX1ZDUzBfSVJRIHwgR0VOOF9HVF9WQ1MxX0lS
USkpIHsKLQkJZ3RfaWlyWzFdID0gcmF3X3JlZ19yZWFkKHJlZ3MsIEdFTjhfR1RfSUlSKDEpKTsK
LQkJaWYgKGxpa2VseShndF9paXJbMV0pKQotCQkJcmF3X3JlZ193cml0ZShyZWdzLCBHRU44X0dU
X0lJUigxKSwgZ3RfaWlyWzFdKTsKLQl9Ci0KLQlpZiAobWFzdGVyX2N0bCAmIChHRU44X0dUX1BN
X0lSUSB8IEdFTjhfR1RfR1VDX0lSUSkpIHsKLQkJZ3RfaWlyWzJdID0gcmF3X3JlZ19yZWFkKHJl
Z3MsIEdFTjhfR1RfSUlSKDIpKTsKLQkJaWYgKGxpa2VseShndF9paXJbMl0pKQotCQkJcmF3X3Jl
Z193cml0ZShyZWdzLCBHRU44X0dUX0lJUigyKSwgZ3RfaWlyWzJdKTsKLQl9Ci0KLQlpZiAobWFz
dGVyX2N0bCAmIEdFTjhfR1RfVkVDU19JUlEpIHsKLQkJZ3RfaWlyWzNdID0gcmF3X3JlZ19yZWFk
KHJlZ3MsIEdFTjhfR1RfSUlSKDMpKTsKLQkJaWYgKGxpa2VseShndF9paXJbM10pKQotCQkJcmF3
X3JlZ193cml0ZShyZWdzLCBHRU44X0dUX0lJUigzKSwgZ3RfaWlyWzNdKTsKLQl9Ci19Ci0KLXN0
YXRpYyB2b2lkIGdlbjhfZ3RfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCi0JCQkJdTMyIG1hc3Rlcl9jdGwsIHUzMiBndF9paXJbNF0pCi17Ci0JaWYgKG1hc3Rlcl9j
dGwgJiAoR0VOOF9HVF9SQ1NfSVJRIHwgR0VOOF9HVF9CQ1NfSVJRKSkgewotCQlnZW44X2NzX2ly
cV9oYW5kbGVyKGk5MTUtPmVuZ2luZVtSQ1MwXSwKLQkJCQkgICAgZ3RfaWlyWzBdID4+IEdFTjhf
UkNTX0lSUV9TSElGVCk7Ci0JCWdlbjhfY3NfaXJxX2hhbmRsZXIoaTkxNS0+ZW5naW5lW0JDUzBd
LAotCQkJCSAgICBndF9paXJbMF0gPj4gR0VOOF9CQ1NfSVJRX1NISUZUKTsKLQl9Ci0KLQlpZiAo
bWFzdGVyX2N0bCAmIChHRU44X0dUX1ZDUzBfSVJRIHwgR0VOOF9HVF9WQ1MxX0lSUSkpIHsKLQkJ
Z2VuOF9jc19pcnFfaGFuZGxlcihpOTE1LT5lbmdpbmVbVkNTMF0sCi0JCQkJICAgIGd0X2lpclsx
XSA+PiBHRU44X1ZDUzBfSVJRX1NISUZUKTsKLQkJZ2VuOF9jc19pcnFfaGFuZGxlcihpOTE1LT5l
bmdpbmVbVkNTMV0sCi0JCQkJICAgIGd0X2lpclsxXSA+PiBHRU44X1ZDUzFfSVJRX1NISUZUKTsK
LQl9Ci0KLQlpZiAobWFzdGVyX2N0bCAmIEdFTjhfR1RfVkVDU19JUlEpIHsKLQkJZ2VuOF9jc19p
cnFfaGFuZGxlcihpOTE1LT5lbmdpbmVbVkVDUzBdLAotCQkJCSAgICBndF9paXJbM10gPj4gR0VO
OF9WRUNTX0lSUV9TSElGVCk7Ci0JfQotCi0JaWYgKG1hc3Rlcl9jdGwgJiAoR0VOOF9HVF9QTV9J
UlEgfCBHRU44X0dUX0dVQ19JUlEpKSB7Ci0JCWdlbjZfcnBzX2lycV9oYW5kbGVyKGk5MTUsIGd0
X2lpclsyXSk7Ci0JCWd1Y19pcnFfaGFuZGxlcigmaTkxNS0+Z3QudWMuZ3VjLCBndF9paXJbMl0g
Pj4gMTYpOwotCX0KLX0KLQogc3RhdGljIGJvb2wgZ2VuMTFfcG9ydF9ob3RwbHVnX2xvbmdfZGV0
ZWN0KGVudW0gaHBkX3BpbiBwaW4sIHUzMiB2YWwpCiB7CiAJc3dpdGNoIChwaW4pIHsKQEAgLTE5
MTMsNjAgKzEyMjIsNiBAQCBzdGF0aWMgdm9pZCBpOXh4X3BpcGVfY3JjX2lycV9oYW5kbGVyKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJCQkgICAgIHJlczEsIHJlczIpOwog
fQogCi0vKiBUaGUgUlBTIGV2ZW50cyBuZWVkIGZvcmNld2FrZSwgc28gd2UgYWRkIHRoZW0gdG8g
YSB3b3JrIHF1ZXVlIGFuZCBtYXNrIHRoZWlyCi0gKiBJTVIgYml0cyB1bnRpbCB0aGUgd29yayBp
cyBkb25lLiBPdGhlciBpbnRlcnJ1cHRzIGNhbiBiZSBwcm9jZXNzZWQgd2l0aG91dAotICogdGhl
IHdvcmsgcXVldWUuICovCi1zdGF0aWMgdm9pZCBnZW4xMV9ycHNfaXJxX2hhbmRsZXIoc3RydWN0
IGludGVsX2d0ICpndCwgdTMyIHBtX2lpcikKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IGd0LT5pOTE1OwotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5y
cHM7Ci0JY29uc3QgdTMyIGV2ZW50cyA9IGk5MTUtPnBtX3Jwc19ldmVudHMgJiBwbV9paXI7Ci0K
LQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5pcnFfbG9jayk7Ci0KLQlpZiAodW5saWtlbHko
IWV2ZW50cykpCi0JCXJldHVybjsKLQotCWdlbjZfbWFza19wbV9pcnEoZ3QsIGV2ZW50cyk7Ci0K
LQlpZiAoIXJwcy0+aW50ZXJydXB0c19lbmFibGVkKQotCQlyZXR1cm47Ci0KLQlycHMtPnBtX2lp
ciB8PSBldmVudHM7Ci0Jc2NoZWR1bGVfd29yaygmcnBzLT53b3JrKTsKLX0KLQotc3RhdGljIHZv
aWQgZ2VuNl9ycHNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCB1MzIgcG1faWlyKQotewotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3Rf
cG0ucnBzOwotCi0JaWYgKHBtX2lpciAmIGRldl9wcml2LT5wbV9ycHNfZXZlbnRzKSB7Ci0JCXNw
aW5fbG9jaygmZGV2X3ByaXYtPmlycV9sb2NrKTsKLQkJZ2VuNl9tYXNrX3BtX2lycSgmZGV2X3By
aXYtPmd0LAotCQkJCSBwbV9paXIgJiBkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyk7Ci0JCWlmIChy
cHMtPmludGVycnVwdHNfZW5hYmxlZCkgewotCQkJcnBzLT5wbV9paXIgfD0gcG1faWlyICYgZGV2
X3ByaXYtPnBtX3Jwc19ldmVudHM7Ci0JCQlzY2hlZHVsZV93b3JrKCZycHMtPndvcmspOwotCQl9
Ci0JCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+aXJxX2xvY2spOwotCX0KLQotCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDgpCi0JCXJldHVybjsKLQotCWlmIChwbV9paXIgJiBQTV9WRUJPWF9V
U0VSX0lOVEVSUlVQVCkKLQkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycShkZXZfcHJpdi0+
ZW5naW5lW1ZFQ1MwXSk7Ci0KLQlpZiAocG1faWlyICYgUE1fVkVCT1hfQ1NfRVJST1JfSU5URVJS
VVBUKQotCQlEUk1fREVCVUcoIkNvbW1hbmQgcGFyc2VyIGVycm9yLCBwbV9paXIgMHglMDh4XG4i
LCBwbV9paXIpOwotfQotCi1zdGF0aWMgdm9pZCBndWNfaXJxX2hhbmRsZXIoc3RydWN0IGludGVs
X2d1YyAqZ3VjLCB1MTYgaWlyKQotewotCWlmIChpaXIgJiBHVUNfSU5UUl9HVUMySE9TVCkKLQkJ
aW50ZWxfZ3VjX3RvX2hvc3RfZXZlbnRfaGFuZGxlcihndWMpOwotfQotCiBzdGF0aWMgdm9pZCBp
OXh4X3BpcGVzdGF0X2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
CiB7CiAJZW51bSBwaXBlIHBpcGU7CkBAIC0yMjc0LDkgKzE1MjksOSBAQCBzdGF0aWMgaXJxcmV0
dXJuX3QgdmFsbGV5dmlld19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCiAJCUk5MTVf
V1JJVEUoVkxWX01BU1RFUl9JRVIsIE1BU1RFUl9JTlRFUlJVUFRfRU5BQkxFKTsKIAogCQlpZiAo
Z3RfaWlyKQotCQkJc25iX2d0X2lycV9oYW5kbGVyKGRldl9wcml2LCBndF9paXIpOworCQkJZ2Vu
Nl9ndF9pcnFfaGFuZGxlcigmZGV2X3ByaXYtPmd0LCBndF9paXIpOwogCQlpZiAocG1faWlyKQot
CQkJZ2VuNl9ycHNfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBtX2lpcik7CisJCQlnZW42X3Jwc19p
cnFfaGFuZGxlcigmZGV2X3ByaXYtPmd0LnJwcywgcG1faWlyKTsKIAogCQlpZiAoaG90cGx1Z19z
dGF0dXMpCiAJCQlpOXh4X2hwZF9pcnFfaGFuZGxlcihkZXZfcHJpdiwgaG90cGx1Z19zdGF0dXMp
OwpAQCAtMjMzMiw3ICsxNTg3LDcgQEAgc3RhdGljIGlycXJldHVybl90IGNoZXJyeXZpZXdfaXJx
X2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQogCQlpZXIgPSBJOTE1X1JFQUQoVkxWX0lFUik7
CiAJCUk5MTVfV1JJVEUoVkxWX0lFUiwgMCk7CiAKLQkJZ2VuOF9ndF9pcnFfYWNrKGRldl9wcml2
LCBtYXN0ZXJfY3RsLCBndF9paXIpOworCQlnZW44X2d0X2lycV9hY2soJmRldl9wcml2LT5ndCwg
bWFzdGVyX2N0bCwgZ3RfaWlyKTsKIAogCQlpZiAoaWlyICYgSTkxNV9ESVNQTEFZX1BPUlRfSU5U
RVJSVVBUKQogCQkJaG90cGx1Z19zdGF0dXMgPSBpOXh4X2hwZF9pcnFfYWNrKGRldl9wcml2KTsK
QEAgLTIzNTYsNyArMTYxMSw3IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBjaGVycnl2aWV3X2lycV9o
YW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykKIAkJSTkxNV9XUklURShWTFZfSUVSLCBpZXIpOwog
CQlJOTE1X1dSSVRFKEdFTjhfTUFTVEVSX0lSUSwgR0VOOF9NQVNURVJfSVJRX0NPTlRST0wpOwog
Ci0JCWdlbjhfZ3RfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIG1hc3Rlcl9jdGwsIGd0X2lpcik7CisJ
CWdlbjhfZ3RfaXJxX2hhbmRsZXIoJmRldl9wcml2LT5ndCwgbWFzdGVyX2N0bCwgZ3RfaWlyKTsK
IAogCQlpZiAoaG90cGx1Z19zdGF0dXMpCiAJCQlpOXh4X2hwZF9pcnFfaGFuZGxlcihkZXZfcHJp
diwgaG90cGx1Z19zdGF0dXMpOwpAQCAtMjY1Niw3ICsxOTExLDcgQEAgc3RhdGljIHZvaWQgaWxr
X2Rpc3BsYXlfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAog
CX0KIAogCWlmIChJU19HRU4oZGV2X3ByaXYsIDUpICYmIGRlX2lpciAmIERFX1BDVV9FVkVOVCkK
LQkJaXJvbmxha2VfcnBzX2NoYW5nZV9pcnFfaGFuZGxlcihkZXZfcHJpdik7CisJCWdlbjVfcnBz
X2lycV9oYW5kbGVyKCZkZXZfcHJpdi0+Z3QucnBzKTsKIH0KIAogc3RhdGljIHZvaWQgaXZiX2Rp
c3BsYXlfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LApAQCAt
Mjc0MSw5ICsxOTk2LDkgQEAgc3RhdGljIGlycXJldHVybl90IGlyb25sYWtlX2lycV9oYW5kbGVy
KGludCBpcnEsIHZvaWQgKmFyZykKIAkJSTkxNV9XUklURShHVElJUiwgZ3RfaWlyKTsKIAkJcmV0
ID0gSVJRX0hBTkRMRUQ7CiAJCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpCi0JCQlzbmJf
Z3RfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIGd0X2lpcik7CisJCQlnZW42X2d0X2lycV9oYW5kbGVy
KCZkZXZfcHJpdi0+Z3QsIGd0X2lpcik7CiAJCWVsc2UKLQkJCWlsa19ndF9pcnFfaGFuZGxlcihk
ZXZfcHJpdiwgZ3RfaWlyKTsKKwkJCWdlbjVfZ3RfaXJxX2hhbmRsZXIoJmRldl9wcml2LT5ndCwg
Z3RfaWlyKTsKIAl9CiAKIAlkZV9paXIgPSBJOTE1X1JFQUQoREVJSVIpOwpAQCAtMjc2MSw3ICsy
MDE2LDcgQEAgc3RhdGljIGlycXJldHVybl90IGlyb25sYWtlX2lycV9oYW5kbGVyKGludCBpcnEs
IHZvaWQgKmFyZykKIAkJaWYgKHBtX2lpcikgewogCQkJSTkxNV9XUklURShHRU42X1BNSUlSLCBw
bV9paXIpOwogCQkJcmV0ID0gSVJRX0hBTkRMRUQ7Ci0JCQlnZW42X3Jwc19pcnFfaGFuZGxlcihk
ZXZfcHJpdiwgcG1faWlyKTsKKwkJCWdlbjZfcnBzX2lycV9oYW5kbGVyKCZkZXZfcHJpdi0+Z3Qu
cnBzLCBwbV9paXIpOwogCQl9CiAJfQogCkBAIC0zMDM1LDcgKzIyOTAsNyBAQCBzdGF0aWMgaXJx
cmV0dXJuX3QgZ2VuOF9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCiAJfQogCiAJLyog
RmluZCwgY2xlYXIsIHRoZW4gcHJvY2VzcyBlYWNoIHNvdXJjZSBvZiBpbnRlcnJ1cHQgKi8KLQln
ZW44X2d0X2lycV9hY2soZGV2X3ByaXYsIG1hc3Rlcl9jdGwsIGd0X2lpcik7CisJZ2VuOF9ndF9p
cnFfYWNrKCZkZXZfcHJpdi0+Z3QsIG1hc3Rlcl9jdGwsIGd0X2lpcik7CiAKIAkvKiBJUlFzIGFy
ZSBzeW5jZWQgZHVyaW5nIHJ1bnRpbWVfc3VzcGVuZCwgd2UgZG9uJ3QgcmVxdWlyZSBhIHdha2Vy
ZWYgKi8KIAlpZiAobWFzdGVyX2N0bCAmIH5HRU44X0dUX0lSUVMpIHsKQEAgLTMwNDYsMTM0ICsy
MzAxLDExIEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBnZW44X2lycV9oYW5kbGVyKGludCBpcnEsIHZv
aWQgKmFyZykKIAogCWdlbjhfbWFzdGVyX2ludHJfZW5hYmxlKHJlZ3MpOwogCi0JZ2VuOF9ndF9p
cnFfaGFuZGxlcihkZXZfcHJpdiwgbWFzdGVyX2N0bCwgZ3RfaWlyKTsKKwlnZW44X2d0X2lycV9o
YW5kbGVyKCZkZXZfcHJpdi0+Z3QsIG1hc3Rlcl9jdGwsIGd0X2lpcik7CiAKIAlyZXR1cm4gSVJR
X0hBTkRMRUQ7CiB9CiAKLXN0YXRpYyB1MzIKLWdlbjExX2d0X2VuZ2luZV9pZGVudGl0eShzdHJ1
Y3QgaW50ZWxfZ3QgKmd0LAotCQkJIGNvbnN0IHVuc2lnbmVkIGludCBiYW5rLCBjb25zdCB1bnNp
Z25lZCBpbnQgYml0KQotewotCXZvaWQgX19pb21lbSAqIGNvbnN0IHJlZ3MgPSBndC0+dW5jb3Jl
LT5yZWdzOwotCXUzMiB0aW1lb3V0X3RzOwotCXUzMiBpZGVudDsKLQotCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmd0LT5pOTE1LT5pcnFfbG9jayk7Ci0KLQlyYXdfcmVnX3dyaXRlKHJlZ3MsIEdFTjEx
X0lJUl9SRUdfU0VMRUNUT1IoYmFuayksIEJJVChiaXQpKTsKLQotCS8qCi0JICogTkI6IFNwZWNz
IGRvIG5vdCBzcGVjaWZ5IGhvdyBsb25nIHRvIHNwaW4gd2FpdCwKLQkgKiBzbyB3ZSBkbyB+MTAw
dXMgYXMgYW4gZWR1Y2F0ZWQgZ3Vlc3MuCi0JICovCi0JdGltZW91dF90cyA9IChsb2NhbF9jbG9j
aygpID4+IDEwKSArIDEwMDsKLQlkbyB7Ci0JCWlkZW50ID0gcmF3X3JlZ19yZWFkKHJlZ3MsIEdF
TjExX0lOVFJfSURFTlRJVFlfUkVHKGJhbmspKTsKLQl9IHdoaWxlICghKGlkZW50ICYgR0VOMTFf
SU5UUl9EQVRBX1ZBTElEKSAmJgotCQkgIXRpbWVfYWZ0ZXIzMihsb2NhbF9jbG9jaygpID4+IDEw
LCB0aW1lb3V0X3RzKSk7Ci0KLQlpZiAodW5saWtlbHkoIShpZGVudCAmIEdFTjExX0lOVFJfREFU
QV9WQUxJRCkpKSB7Ci0JCURSTV9FUlJPUigiSU5UUl9JREVOVElUWV9SRUcldToldSAweCUwOHgg
bm90IHZhbGlkIVxuIiwKLQkJCSAgYmFuaywgYml0LCBpZGVudCk7Ci0JCXJldHVybiAwOwotCX0K
LQotCXJhd19yZWdfd3JpdGUocmVncywgR0VOMTFfSU5UUl9JREVOVElUWV9SRUcoYmFuayksCi0J
CSAgICAgIEdFTjExX0lOVFJfREFUQV9WQUxJRCk7Ci0KLQlyZXR1cm4gaWRlbnQ7Ci19Ci0KLXN0
YXRpYyB2b2lkCi1nZW4xMV9vdGhlcl9pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBj
b25zdCB1OCBpbnN0YW5jZSwKLQkJCWNvbnN0IHUxNiBpaXIpCi17Ci0JaWYgKGluc3RhbmNlID09
IE9USEVSX0dVQ19JTlNUQU5DRSkKLQkJcmV0dXJuIGd1Y19pcnFfaGFuZGxlcigmZ3QtPnVjLmd1
YywgaWlyKTsKLQotCWlmIChpbnN0YW5jZSA9PSBPVEhFUl9HVFBNX0lOU1RBTkNFKQotCQlyZXR1
cm4gZ2VuMTFfcnBzX2lycV9oYW5kbGVyKGd0LCBpaXIpOwotCi0JV0FSTl9PTkNFKDEsICJ1bmhh
bmRsZWQgb3RoZXIgaW50ZXJydXB0IGluc3RhbmNlPTB4JXgsIGlpcj0weCV4XG4iLAotCQkgIGlu
c3RhbmNlLCBpaXIpOwotfQotCi1zdGF0aWMgdm9pZAotZ2VuMTFfZW5naW5lX2lycV9oYW5kbGVy
KHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGNvbnN0IHU4IGNsYXNzLAotCQkJIGNvbnN0IHU4IGluc3Rh
bmNlLCBjb25zdCB1MTYgaWlyKQotewotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsK
LQotCWlmIChpbnN0YW5jZSA8PSBNQVhfRU5HSU5FX0lOU1RBTkNFKQotCQllbmdpbmUgPSBndC0+
ZW5naW5lX2NsYXNzW2NsYXNzXVtpbnN0YW5jZV07Ci0JZWxzZQotCQllbmdpbmUgPSBOVUxMOwot
Ci0JaWYgKGxpa2VseShlbmdpbmUpKQotCQlyZXR1cm4gZ2VuOF9jc19pcnFfaGFuZGxlcihlbmdp
bmUsIGlpcik7Ci0KLQlXQVJOX09OQ0UoMSwgInVuaGFuZGxlZCBlbmdpbmUgaW50ZXJydXB0IGNs
YXNzPTB4JXgsIGluc3RhbmNlPTB4JXhcbiIsCi0JCSAgY2xhc3MsIGluc3RhbmNlKTsKLX0KLQot
c3RhdGljIHZvaWQKLWdlbjExX2d0X2lkZW50aXR5X2hhbmRsZXIoc3RydWN0IGludGVsX2d0ICpn
dCwgY29uc3QgdTMyIGlkZW50aXR5KQotewotCWNvbnN0IHU4IGNsYXNzID0gR0VOMTFfSU5UUl9F
TkdJTkVfQ0xBU1MoaWRlbnRpdHkpOwotCWNvbnN0IHU4IGluc3RhbmNlID0gR0VOMTFfSU5UUl9F
TkdJTkVfSU5TVEFOQ0UoaWRlbnRpdHkpOwotCWNvbnN0IHUxNiBpbnRyID0gR0VOMTFfSU5UUl9F
TkdJTkVfSU5UUihpZGVudGl0eSk7Ci0KLQlpZiAodW5saWtlbHkoIWludHIpKQotCQlyZXR1cm47
Ci0KLQlpZiAoY2xhc3MgPD0gQ09QWV9FTkdJTkVfQ0xBU1MpCi0JCXJldHVybiBnZW4xMV9lbmdp
bmVfaXJxX2hhbmRsZXIoZ3QsIGNsYXNzLCBpbnN0YW5jZSwgaW50cik7Ci0KLQlpZiAoY2xhc3Mg
PT0gT1RIRVJfQ0xBU1MpCi0JCXJldHVybiBnZW4xMV9vdGhlcl9pcnFfaGFuZGxlcihndCwgaW5z
dGFuY2UsIGludHIpOwotCi0JV0FSTl9PTkNFKDEsICJ1bmtub3duIGludGVycnVwdCBjbGFzcz0w
eCV4LCBpbnN0YW5jZT0weCV4LCBpbnRyPTB4JXhcbiIsCi0JCSAgY2xhc3MsIGluc3RhbmNlLCBp
bnRyKTsKLX0KLQotc3RhdGljIHZvaWQKLWdlbjExX2d0X2JhbmtfaGFuZGxlcihzdHJ1Y3QgaW50
ZWxfZ3QgKmd0LCBjb25zdCB1bnNpZ25lZCBpbnQgYmFuaykKLXsKLQl2b2lkIF9faW9tZW0gKiBj
b25zdCByZWdzID0gZ3QtPnVuY29yZS0+cmVnczsKLQl1bnNpZ25lZCBsb25nIGludHJfZHc7Ci0J
dW5zaWduZWQgaW50IGJpdDsKLQotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmd0LT5pOTE1LT5pcnFf
bG9jayk7Ci0KLQlpbnRyX2R3ID0gcmF3X3JlZ19yZWFkKHJlZ3MsIEdFTjExX0dUX0lOVFJfRFco
YmFuaykpOwotCi0JZm9yX2VhY2hfc2V0X2JpdChiaXQsICZpbnRyX2R3LCAzMikgewotCQljb25z
dCB1MzIgaWRlbnQgPSBnZW4xMV9ndF9lbmdpbmVfaWRlbnRpdHkoZ3QsIGJhbmssIGJpdCk7Ci0K
LQkJZ2VuMTFfZ3RfaWRlbnRpdHlfaGFuZGxlcihndCwgaWRlbnQpOwotCX0KLQotCS8qIENsZWFy
IG11c3QgYmUgYWZ0ZXIgc2hhcmVkIGhhcyBiZWVuIHNlcnZlZCBmb3IgZW5naW5lICovCi0JcmF3
X3JlZ193cml0ZShyZWdzLCBHRU4xMV9HVF9JTlRSX0RXKGJhbmspLCBpbnRyX2R3KTsKLX0KLQot
c3RhdGljIHZvaWQKLWdlbjExX2d0X2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGNv
bnN0IHUzMiBtYXN0ZXJfY3RsKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
Z3QtPmk5MTU7Ci0JdW5zaWduZWQgaW50IGJhbms7Ci0KLQlzcGluX2xvY2soJmk5MTUtPmlycV9s
b2NrKTsKLQotCWZvciAoYmFuayA9IDA7IGJhbmsgPCAyOyBiYW5rKyspIHsKLQkJaWYgKG1hc3Rl
cl9jdGwgJiBHRU4xMV9HVF9EV19JUlEoYmFuaykpCi0JCQlnZW4xMV9ndF9iYW5rX2hhbmRsZXIo
Z3QsIGJhbmspOwotCX0KLQotCXNwaW5fdW5sb2NrKCZpOTE1LT5pcnFfbG9jayk7Ci19Ci0KIHN0
YXRpYyB1MzIKIGdlbjExX2d1X21pc2NfaXJxX2FjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBjb25z
dCB1MzIgbWFzdGVyX2N0bCkKIHsKQEAgLTM0ODIsMTUgKzI2MTQsNiBAQCBzdGF0aWMgdm9pZCBp
YnhfaXJxX3ByZV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
CiAJUE9TVElOR19SRUFEKFNERUlFUik7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbjVfZ3RfaXJxX3Jl
c2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlzdHJ1Y3QgaW50ZWxf
dW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKLQotCUdFTjNfSVJRX1JFU0VUKHVu
Y29yZSwgR1QpOwotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpCi0JCUdFTjNfSVJRX1JF
U0VUKHVuY29yZSwgR0VONl9QTSk7Ci19Ci0KIHN0YXRpYyB2b2lkIHZsdl9kaXNwbGF5X2lycV9y
ZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJc3RydWN0IGludGVs
X3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7CkBAIC0zNTU1LDcgKzI2NzgsNyBA
QCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9pcnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQogCQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBFRFBfUFNSX0lJUiwgMHhm
ZmZmZmZmZik7CiAJfQogCi0JZ2VuNV9ndF9pcnFfcmVzZXQoZGV2X3ByaXYpOworCWdlbjVfZ3Rf
aXJxX3Jlc2V0KCZkZXZfcHJpdi0+Z3QpOwogCiAJaWJ4X2lycV9yZXNldChkZXZfcHJpdik7CiB9
CkBAIC0zNTY1LDcgKzI2ODgsNyBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2lycV9yZXNldChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJSTkxNV9XUklURShWTFZfTUFTVEVS
X0lFUiwgMCk7CiAJUE9TVElOR19SRUFEKFZMVl9NQVNURVJfSUVSKTsKIAotCWdlbjVfZ3RfaXJx
X3Jlc2V0KGRldl9wcml2KTsKKwlnZW41X2d0X2lycV9yZXNldCgmZGV2X3ByaXYtPmd0KTsKIAog
CXNwaW5fbG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7CiAJaWYgKGRldl9wcml2LT5kaXNw
bGF5X2lycXNfZW5hYmxlZCkKQEAgLTM1NzMsMTYgKzI2OTYsNiBAQCBzdGF0aWMgdm9pZCB2YWxs
ZXl2aWV3X2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJc3Bp
bl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwogfQogCi1zdGF0aWMgdm9pZCBnZW44
X2d0X2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3Ry
dWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Ci0KLQlHRU44X0lS
UV9SRVNFVF9ORFgodW5jb3JlLCBHVCwgMCk7Ci0JR0VOOF9JUlFfUkVTRVRfTkRYKHVuY29yZSwg
R1QsIDEpOwotCUdFTjhfSVJRX1JFU0VUX05EWCh1bmNvcmUsIEdULCAyKTsKLQlHRU44X0lSUV9S
RVNFVF9ORFgodW5jb3JlLCBHVCwgMyk7Ci19Ci0KIHN0YXRpYyB2b2lkIGdlbjhfaXJxX3Jlc2V0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAlzdHJ1Y3QgaW50ZWxfdW5j
b3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKQEAgLTM1OTAsNyArMjcwMyw3IEBAIHN0
YXRpYyB2b2lkIGdlbjhfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKIAogCWdlbjhfbWFzdGVyX2ludHJfZGlzYWJsZShkZXZfcHJpdi0+dW5jb3JlLnJlZ3MpOwog
Ci0JZ2VuOF9ndF9pcnFfcmVzZXQoZGV2X3ByaXYpOworCWdlbjhfZ3RfaXJxX3Jlc2V0KCZkZXZf
cHJpdi0+Z3QpOwogCiAJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgRURQX1BTUl9JTVIsIDB4
ZmZmZmZmZmYpOwogCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEVEUF9QU1JfSUlSLCAweGZm
ZmZmZmZmKTsKQEAgLTM2MDgsMjcgKzI3MjEsNiBAQCBzdGF0aWMgdm9pZCBnZW44X2lycV9yZXNl
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCWlieF9pcnFfcmVzZXQoZGV2
X3ByaXYpOwogfQogCi1zdGF0aWMgdm9pZCBnZW4xMV9ndF9pcnFfcmVzZXQoc3RydWN0IGludGVs
X2d0ICpndCkKLXsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3JlOwot
Ci0JLyogRGlzYWJsZSBSQ1MsIEJDUywgVkNTIGFuZCBWRUNTIGNsYXNzIGVuZ2luZXMuICovCi0J
aW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfUkVOREVSX0NPUFlfSU5UUl9FTkFCTEUs
IDApOwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX1ZDU19WRUNTX0lOVFJfRU5B
QkxFLAkgIDApOwotCi0JLyogUmVzdG9yZSBtYXNrcyBpcnFzIG9uIFJDUywgQkNTLCBWQ1MgYW5k
IFZFQ1MgZW5naW5lcy4gKi8KLQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9SQ1Mw
X1JTVkRfSU5UUl9NQVNLLAl+MCk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFf
QkNTX1JTVkRfSU5UUl9NQVNLLAl+MCk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VO
MTFfVkNTMF9WQ1MxX0lOVFJfTUFTSywJfjApOwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUs
IEdFTjExX1ZDUzJfVkNTM19JTlRSX01BU0ssCX4wKTsKLQlpbnRlbF91bmNvcmVfd3JpdGUodW5j
b3JlLCBHRU4xMV9WRUNTMF9WRUNTMV9JTlRSX01BU0ssCX4wKTsKLQotCWludGVsX3VuY29yZV93
cml0ZSh1bmNvcmUsIEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9FTkFCTEUsIDApOwotCWludGVs
X3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9NQVNLLCAgfjAp
OwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dVQ19TR19JTlRSX0VOQUJMRSwg
MCk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfR1VDX1NHX0lOVFJfTUFTSywg
IH4wKTsKLX0KLQogc3RhdGljIHZvaWQgZ2VuMTFfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKIHsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2
X3ByaXYtPnVuY29yZTsKQEAgLTM3MTAsNyArMjgwMiw3IEBAIHN0YXRpYyB2b2lkIGNoZXJyeXZp
ZXdfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlJOTE1X1dS
SVRFKEdFTjhfTUFTVEVSX0lSUSwgMCk7CiAJUE9TVElOR19SRUFEKEdFTjhfTUFTVEVSX0lSUSk7
CiAKLQlnZW44X2d0X2lycV9yZXNldChkZXZfcHJpdik7CisJZ2VuOF9ndF9pcnFfcmVzZXQoJmRl
dl9wcml2LT5ndCk7CiAKIAlHRU4zX0lSUV9SRVNFVCh1bmNvcmUsIEdFTjhfUENVXyk7CiAKQEAg
LTM5OTMsNDQgKzMwODUsNiBAQCBzdGF0aWMgdm9pZCBpYnhfaXJxX3Bvc3RpbnN0YWxsKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJc3B0X2hwZF9kZXRlY3Rpb25fc2V0dXAo
ZGV2X3ByaXYpOwogfQogCi1zdGF0aWMgdm9pZCBnZW41X2d0X2lycV9wb3N0aW5zdGFsbChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX3VuY29yZSAq
dW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Ci0JdTMyIHBtX2lycXMsIGd0X2lycXM7Ci0KLQlw
bV9pcnFzID0gZ3RfaXJxcyA9IDA7Ci0KLQlkZXZfcHJpdi0+Z3RfaXJxX21hc2sgPSB+MDsKLQlp
ZiAoSEFTX0wzX0RQRihkZXZfcHJpdikpIHsKLQkJLyogTDMgcGFyaXR5IGludGVycnVwdCBpcyBh
bHdheXMgdW5tYXNrZWQuICovCi0JCWRldl9wcml2LT5ndF9pcnFfbWFzayA9IH5HVF9QQVJJVFlf
RVJST1IoZGV2X3ByaXYpOwotCQlndF9pcnFzIHw9IEdUX1BBUklUWV9FUlJPUihkZXZfcHJpdik7
Ci0JfQotCi0JZ3RfaXJxcyB8PSBHVF9SRU5ERVJfVVNFUl9JTlRFUlJVUFQ7Ci0JaWYgKElTX0dF
TihkZXZfcHJpdiwgNSkpIHsKLQkJZ3RfaXJxcyB8PSBJTEtfQlNEX1VTRVJfSU5URVJSVVBUOwot
CX0gZWxzZSB7Ci0JCWd0X2lycXMgfD0gR1RfQkxUX1VTRVJfSU5URVJSVVBUIHwgR1RfQlNEX1VT
RVJfSU5URVJSVVBUOwotCX0KLQotCUdFTjNfSVJRX0lOSVQodW5jb3JlLCBHVCwgZGV2X3ByaXYt
Pmd0X2lycV9tYXNrLCBndF9pcnFzKTsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYp
IHsKLQkJLyoKLQkJICogUlBTIGludGVycnVwdHMgd2lsbCBnZXQgZW5hYmxlZC9kaXNhYmxlZCBv
biBkZW1hbmQgd2hlbiBSUFMKLQkJICogaXRzZWxmIGlzIGVuYWJsZWQvZGlzYWJsZWQuCi0JCSAq
LwotCQlpZiAoSEFTX0VOR0lORShkZXZfcHJpdiwgVkVDUzApKSB7Ci0JCQlwbV9pcnFzIHw9IFBN
X1ZFQk9YX1VTRVJfSU5URVJSVVBUOwotCQkJZGV2X3ByaXYtPmd0LnBtX2llciB8PSBQTV9WRUJP
WF9VU0VSX0lOVEVSUlVQVDsKLQkJfQotCi0JCWRldl9wcml2LT5ndC5wbV9pbXIgPSAweGZmZmZm
ZmZmOwotCQlHRU4zX0lSUV9JTklUKHVuY29yZSwgR0VONl9QTSwgZGV2X3ByaXYtPmd0LnBtX2lt
ciwgcG1faXJxcyk7Ci0JfQotfQotCiBzdGF0aWMgdm9pZCBpcm9ubGFrZV9pcnFfcG9zdGluc3Rh
bGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCXN0cnVjdCBpbnRlbF91
bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwpAQCAtNDA2NCw3ICszMTE4LDcgQEAg
c3RhdGljIHZvaWQgaXJvbmxha2VfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKIAlHRU4zX0lSUV9JTklUKHVuY29yZSwgREUsIGRldl9wcml2LT5pcnFf
bWFzaywKIAkJICAgICAgZGlzcGxheV9tYXNrIHwgZXh0cmFfbWFzayk7CiAKLQlnZW41X2d0X2ly
cV9wb3N0aW5zdGFsbChkZXZfcHJpdik7CisJZ2VuNV9ndF9pcnFfcG9zdGluc3RhbGwoJmRldl9w
cml2LT5ndCk7CiAKIAlpbGtfaHBkX2RldGVjdGlvbl9zZXR1cChkZXZfcHJpdik7CiAKQEAgLTQx
MTMsNyArMzE2Nyw3IEBAIHZvaWQgdmFsbGV5dmlld19kaXNhYmxlX2Rpc3BsYXlfaXJxcyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAKIHN0YXRpYyB2b2lkIHZhbGxleXZpZXdf
aXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQln
ZW41X2d0X2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7CisJZ2VuNV9ndF9pcnFfcG9zdGluc3Rh
bGwoJmRldl9wcml2LT5ndCk7CiAKIAlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2sp
OwogCWlmIChkZXZfcHJpdi0+ZGlzcGxheV9pcnFzX2VuYWJsZWQpCkBAIC00MTI0LDQxICszMTc4
LDYgQEAgc3RhdGljIHZvaWQgdmFsbGV5dmlld19pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogCVBPU1RJTkdfUkVBRChWTFZfTUFTVEVSX0lFUik7CiB9
CiAKLXN0YXRpYyB2b2lkIGdlbjhfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7Ci0Jc3Ry
dWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKLQotCS8qIFRoZXNlIGFyZSBp
bnRlcnJ1cHRzIHdlJ2xsIHRvZ2dsZSB3aXRoIHRoZSByaW5nIG1hc2sgcmVnaXN0ZXIgKi8KLQl1
MzIgZ3RfaW50ZXJydXB0c1tdID0gewotCQkoR1RfUkVOREVSX1VTRVJfSU5URVJSVVBUIDw8IEdF
TjhfUkNTX0lSUV9TSElGVCB8Ci0JCSBHVF9DT05URVhUX1NXSVRDSF9JTlRFUlJVUFQgPDwgR0VO
OF9SQ1NfSVJRX1NISUZUIHwKLQkJIEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVCA8PCBHRU44X0JD
U19JUlFfU0hJRlQgfAotCQkgR1RfQ09OVEVYVF9TV0lUQ0hfSU5URVJSVVBUIDw8IEdFTjhfQkNT
X0lSUV9TSElGVCksCi0KLQkJKEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVCA8PCBHRU44X1ZDUzBf
SVJRX1NISUZUIHwKLQkJIEdUX0NPTlRFWFRfU1dJVENIX0lOVEVSUlVQVCA8PCBHRU44X1ZDUzBf
SVJRX1NISUZUIHwKLQkJIEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVCA8PCBHRU44X1ZDUzFfSVJR
X1NISUZUIHwKLQkJIEdUX0NPTlRFWFRfU1dJVENIX0lOVEVSUlVQVCA8PCBHRU44X1ZDUzFfSVJR
X1NISUZUKSwKLQotCQkwLAotCi0JCShHVF9SRU5ERVJfVVNFUl9JTlRFUlJVUFQgPDwgR0VOOF9W
RUNTX0lSUV9TSElGVCB8Ci0JCSBHVF9DT05URVhUX1NXSVRDSF9JTlRFUlJVUFQgPDwgR0VOOF9W
RUNTX0lSUV9TSElGVCkKLQl9OwotCi0JZ3QtPnBtX2llciA9IDB4MDsKLQlndC0+cG1faW1yID0g
fmd0LT5wbV9pZXI7Ci0JR0VOOF9JUlFfSU5JVF9ORFgodW5jb3JlLCBHVCwgMCwgfmd0X2ludGVy
cnVwdHNbMF0sIGd0X2ludGVycnVwdHNbMF0pOwotCUdFTjhfSVJRX0lOSVRfTkRYKHVuY29yZSwg
R1QsIDEsIH5ndF9pbnRlcnJ1cHRzWzFdLCBndF9pbnRlcnJ1cHRzWzFdKTsKLQkvKgotCSAqIFJQ
UyBpbnRlcnJ1cHRzIHdpbGwgZ2V0IGVuYWJsZWQvZGlzYWJsZWQgb24gZGVtYW5kIHdoZW4gUlBT
IGl0c2VsZgotCSAqIGlzIGVuYWJsZWQvZGlzYWJsZWQuIFNhbWUgd2lsIGJlIHRoZSBjYXNlIGZv
ciBHdUMgaW50ZXJydXB0cy4KLQkgKi8KLQlHRU44X0lSUV9JTklUX05EWCh1bmNvcmUsIEdULCAy
LCBndC0+cG1faW1yLCBndC0+cG1faWVyKTsKLQlHRU44X0lSUV9JTklUX05EWCh1bmNvcmUsIEdU
LCAzLCB+Z3RfaW50ZXJydXB0c1szXSwgZ3RfaW50ZXJydXB0c1szXSk7Ci19Ci0KIHN0YXRpYyB2
b2lkIGdlbjhfZGVfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKIHsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29y
ZTsKQEAgLTQyMzQsNyArMzI1Myw3IEBAIHN0YXRpYyB2b2lkIGdlbjhfaXJxX3Bvc3RpbnN0YWxs
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpZiAoSEFTX1BDSF9TUExJVChk
ZXZfcHJpdikpCiAJCWlieF9pcnFfcHJlX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKIAotCWdlbjhf
Z3RfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKKwlnZW44X2d0X2lycV9wb3N0aW5zdGFsbCgm
ZGV2X3ByaXYtPmd0KTsKIAlnZW44X2RlX2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7CiAKIAlp
ZiAoSEFTX1BDSF9TUExJVChkZXZfcHJpdikpCkBAIC00MjQzLDQwICszMjYyLDYgQEAgc3RhdGlj
IHZvaWQgZ2VuOF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQogCWdlbjhfbWFzdGVyX2ludHJfZW5hYmxlKGRldl9wcml2LT51bmNvcmUucmVncyk7CiB9
CiAKLXN0YXRpYyB2b2lkIGdlbjExX2d0X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0KQotewotCWNvbnN0IHUzMiBpcnFzID0gR1RfUkVOREVSX1VTRVJfSU5URVJSVVBUIHwgR1Rf
Q09OVEVYVF9TV0lUQ0hfSU5URVJSVVBUOwotCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9
IGd0LT51bmNvcmU7Ci0JY29uc3QgdTMyIGRtYXNrID0gaXJxcyA8PCAxNiB8IGlycXM7Ci0JY29u
c3QgdTMyIHNtYXNrID0gaXJxcyA8PCAxNjsKLQotCUJVSUxEX0JVR19PTihpcnFzICYgMHhmZmZm
MDAwMCk7Ci0KLQkvKiBFbmFibGUgUkNTLCBCQ1MsIFZDUyBhbmQgVkVDUyBjbGFzcyBpbnRlcnJ1
cHRzLiAqLwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX1JFTkRFUl9DT1BZX0lO
VFJfRU5BQkxFLCBkbWFzayk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfVkNT
X1ZFQ1NfSU5UUl9FTkFCTEUsIGRtYXNrKTsKLQotCS8qIFVubWFzayBpcnFzIG9uIFJDUywgQkNT
LCBWQ1MgYW5kIFZFQ1MgZW5naW5lcy4gKi8KLQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBH
RU4xMV9SQ1MwX1JTVkRfSU5UUl9NQVNLLCB+c21hc2spOwotCWludGVsX3VuY29yZV93cml0ZSh1
bmNvcmUsIEdFTjExX0JDU19SU1ZEX0lOVFJfTUFTSywgfnNtYXNrKTsKLQlpbnRlbF91bmNvcmVf
d3JpdGUodW5jb3JlLCBHRU4xMV9WQ1MwX1ZDUzFfSU5UUl9NQVNLLCB+ZG1hc2spOwotCWludGVs
X3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX1ZDUzJfVkNTM19JTlRSX01BU0ssIH5kbWFzayk7
Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfVkVDUzBfVkVDUzFfSU5UUl9NQVNL
LCB+ZG1hc2spOwotCi0JLyoKLQkgKiBSUFMgaW50ZXJydXB0cyB3aWxsIGdldCBlbmFibGVkL2Rp
c2FibGVkIG9uIGRlbWFuZCB3aGVuIFJQUyBpdHNlbGYKLQkgKiBpcyBlbmFibGVkL2Rpc2FibGVk
LgotCSAqLwotCWd0LT5wbV9pZXIgPSAweDA7Ci0JZ3QtPnBtX2ltciA9IH5ndC0+cG1faWVyOwot
CWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9FTkFC
TEUsIDApOwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dQTV9XR0JPWFBFUkZf
SU5UUl9NQVNLLCAgfjApOwotCi0JLyogU2FtZSB0aGluZyBmb3IgR3VDIGludGVycnVwdHMgKi8K
LQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9HVUNfU0dfSU5UUl9FTkFCTEUsIDAp
OwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dVQ19TR19JTlRSX01BU0ssICB+
MCk7Ci19Ci0KIHN0YXRpYyB2b2lkIGljcF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQogewogCXUzMiBtYXNrID0gU0RFX0dNQlVTX0lDUDsKQEAgLTQz
MTIsNyArMzI5Nyw3IEBAIHN0YXRpYyB2b2lkIGdlbjExX2lycV9wb3N0aW5zdGFsbChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAKIHN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfaXJx
X3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlnZW44
X2d0X2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7CisJZ2VuOF9ndF9pcnFfcG9zdGluc3RhbGwo
JmRldl9wcml2LT5ndCk7CiAKIAlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwog
CWlmIChkZXZfcHJpdi0+ZGlzcGxheV9pcnFzX2VuYWJsZWQpCkBAIC00NzQ4LDcgKzM3MzMsNiBA
QCBzdGF0aWMgaXJxcmV0dXJuX3QgaTk2NV9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcp
CiB2b2lkIGludGVsX2lycV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
IHsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Ci0Jc3RydWN0IGlu
dGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7CiAJaW50IGk7CiAKIAlpZiAoSVNf
STk0NUdNKGRldl9wcml2KSkKQEAgLTQ3NTYsOCArMzc0MCw2IEBAIHZvaWQgaW50ZWxfaXJxX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCiAJaW50ZWxfaHBkX2luaXRf
d29yayhkZXZfcHJpdik7CiAKLQlJTklUX1dPUksoJnJwcy0+d29yaywgZ2VuNl9wbV9ycHNfd29y
ayk7Ci0KIAlJTklUX1dPUksoJmRldl9wcml2LT5sM19wYXJpdHkuZXJyb3Jfd29yaywgaXZ5YnJp
ZGdlX3Bhcml0eV93b3JrKTsKIAlmb3IgKGkgPSAwOyBpIDwgTUFYX0wzX1NMSUNFUzsgKytpKQog
CQlkZXZfcHJpdi0+bDNfcGFyaXR5LnJlbWFwX2luZm9baV0gPSBOVUxMOwpAQCAtNDc2NiwzMyAr
Mzc0OCw2IEBAIHZvaWQgaW50ZWxfaXJxX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQogCWlmIChIQVNfR1VDX1NDSEVEKGRldl9wcml2KSAmJiBJTlRFTF9HRU4oZGV2X3By
aXYpIDwgMTEpCiAJCWRldl9wcml2LT5ndC5wbV9ndWNfZXZlbnRzID0gR1VDX0lOVFJfR1VDMkhP
U1QgPDwgMTY7CiAKLQkvKiBMZXQncyB0cmFjayB0aGUgZW5hYmxlZCBycHMgZXZlbnRzICovCi0J
aWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQotCQkvKiBXYUdzdlJDMFJlc2lkZW5jeU1ldGhv
ZDp2bHYgKi8KLQkJZGV2X3ByaXYtPnBtX3Jwc19ldmVudHMgPSBHRU42X1BNX1JQX1VQX0VJX0VY
UElSRUQ7Ci0JZWxzZQotCQlkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyA9IChHRU42X1BNX1JQX1VQ
X1RIUkVTSE9MRCB8Ci0JCQkJCSAgIEdFTjZfUE1fUlBfRE9XTl9USFJFU0hPTEQgfAotCQkJCQkg
ICBHRU42X1BNX1JQX0RPV05fVElNRU9VVCk7Ci0KLQkvKiBXZSBzaGFyZSB0aGUgcmVnaXN0ZXIg
d2l0aCBvdGhlciBlbmdpbmUgKi8KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+IDkpCi0JCUdF
TV9XQVJOX09OKGRldl9wcml2LT5wbV9ycHNfZXZlbnRzICYgMHhmZmZmMDAwMCk7Ci0KLQlycHMt
PnBtX2ludHJtc2tfbWJ6ID0gMDsKLQotCS8qCi0JICogU05CLElWQixIU1cgY2FuIHdoaWxlIFZM
VixDSFYgbWF5IGhhcmQgaGFuZyBvbiBsb29waW5nIGJhdGNoYnVmZmVyCi0JICogaWYgR0VONl9Q
TV9VUF9FSV9FWFBJUkVEIGlzIG1hc2tlZC4KLQkgKgotCSAqIFRPRE86IHZlcmlmeSBpZiB0aGlz
IGNhbiBiZSByZXByb2R1Y2VkIG9uIFZMVixDSFYuCi0JICovCi0JaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPD0gNykKLQkJcnBzLT5wbV9pbnRybXNrX21ieiB8PSBHRU42X1BNX1JQX1VQX0VJX0VY
UElSRUQ7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KQotCQlycHMtPnBtX2ludHJt
c2tfbWJ6IHw9IEdFTjhfUE1JTlRSX0RJU0FCTEVfUkVESVJFQ1RfVE9fR1VDOwotCiAJZGV2LT52
YmxhbmtfZGlzYWJsZV9pbW1lZGlhdGUgPSB0cnVlOwogCiAJLyogTW9zdCBwbGF0Zm9ybXMgdHJl
YXQgdGhlIGRpc3BsYXkgaXJxIGJsb2NrIGFzIGFuIGFsd2F5cy1vbgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
aXJxLmgKaW5kZXggODkxODgwOWNkODA1Li44MzY4YzU1NjhiODQgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9pcnEuaApAQCAtNzYsMjIgKzc2LDYgQEAgaWJ4X2Rpc2FibGVfZGlzcGxheV9pbnRlcnJ1cHQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgYml0cykKIAlpYnhfZGlzcGxh
eV9pbnRlcnJ1cHRfdXBkYXRlKGRldl9wcml2LCBiaXRzLCAwKTsKIH0KIAotdm9pZCBnZW41X2Vu
YWJsZV9ndF9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFzayk7
Ci12b2lkIGdlbjVfZGlzYWJsZV9ndF9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCB1MzIgbWFzayk7Ci12b2lkIGdlbjZfbWFza19wbV9pcnEoc3RydWN0IGludGVsX2d0ICpn
dCwgdTMyIG1hc2spOwotdm9pZCBnZW42X3VubWFza19wbV9pcnEoc3RydWN0IGludGVsX2d0ICpn
dCwgdTMyIG1hc2spOwotdm9pZCBnZW4xMV9yZXNldF9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBnZW42X3Jlc2V0X3Jwc19pbnRlcnJ1cHRz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12b2lkIGdlbjZfZW5hYmxlX3Jw
c19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12b2lkIGdl
bjZfZGlzYWJsZV9ycHNfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwotdm9pZCBnZW42X3Jwc19yZXNldF9laShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwotCi1zdGF0aWMgaW5saW5lIHUzMiBnZW42X3Nhbml0aXplX3Jwc19wbV9tYXNrKGNv
bnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAotCQkJCQkgICAgdTMyIG1hc2spCi17
Ci0JcmV0dXJuIG1hc2sgJiB+aTkxNS0+Z3RfcG0ucnBzLnBtX2ludHJtc2tfbWJ6OwotfQotCiB2
b2lkIGludGVsX3J1bnRpbWVfcG1fZGlzYWJsZV9pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7CiB2b2lkIGludGVsX3J1bnRpbWVfcG1fZW5hYmxlX2ludGVycnVw
dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIHN0YXRpYyBpbmxpbmUgYm9v
bCBpbnRlbF9pcnFzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQpA
QCAtMTEzLDEyICs5Nyw2IEBAIHZvaWQgZ2VuOF9pcnFfcG93ZXJfd2VsbF9wb3N0X2VuYWJsZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCQkJICAgICB1OCBwaXBlX21hc2sp
Owogdm9pZCBnZW44X2lycV9wb3dlcl93ZWxsX3ByZV9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKIAkJCQkgICAgIHU4IHBpcGVfbWFzayk7Ci12b2lkIGdlbjlfcmVz
ZXRfZ3VjX2ludGVycnVwdHMoc3RydWN0IGludGVsX2d1YyAqZ3VjKTsKLXZvaWQgZ2VuOV9lbmFi
bGVfZ3VjX2ludGVycnVwdHMoc3RydWN0IGludGVsX2d1YyAqZ3VjKTsKLXZvaWQgZ2VuOV9kaXNh
YmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9ndWMgKmd1Yyk7Ci12b2lkIGdlbjExX3Jl
c2V0X2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9ndWMgKmd1Yyk7Ci12b2lkIGdlbjExX2Vu
YWJsZV9ndWNfaW50ZXJydXB0cyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpOwotdm9pZCBnZW4xMV9k
aXNhYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9ndWMgKmd1Yyk7CiAKIGJvb2wgaTkx
NV9nZXRfY3J0Y19zY2Fub3V0cG9zKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHVuc2lnbmVkIGlu
dCBwaXBlLAogCQkJICAgICAgYm9vbCBpbl92YmxhbmtfaXJxLCBpbnQgKnZwb3MsIGludCAqaHBv
cywKQEAgLTEzOSw0ICsxMTcsNDYgQEAgdm9pZCBpOTY1X2Rpc2FibGVfdmJsYW5rKHN0cnVjdCBk
cm1fY3J0YyAqY3J0Yyk7CiB2b2lkIGlsa19kaXNhYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMg
KmNydGMpOwogdm9pZCBiZHdfZGlzYWJsZV92Ymxhbmsoc3RydWN0IGRybV9jcnRjICpjcnRjKTsK
IAordm9pZCBnZW4yX2lycV9yZXNldChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpOwordm9p
ZCBnZW4zX2lycV9yZXNldChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsIGk5MTVfcmVnX3Qg
aW1yLAorCQkgICAgaTkxNV9yZWdfdCBpaXIsIGk5MTVfcmVnX3QgaWVyKTsKKwordm9pZCBnZW4y
X2lycV9pbml0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwKKwkJICAgdTMyIGltcl92YWws
IHUzMiBpZXJfdmFsKTsKK3ZvaWQgZ2VuM19pcnFfaW5pdChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUsCisJCSAgIGk5MTVfcmVnX3QgaW1yLCB1MzIgaW1yX3ZhbCwKKwkJICAgaTkxNV9yZWdf
dCBpZXIsIHUzMiBpZXJfdmFsLAorCQkgICBpOTE1X3JlZ190IGlpcik7CisKKyNkZWZpbmUgR0VO
OF9JUlFfUkVTRVRfTkRYKHVuY29yZSwgdHlwZSwgd2hpY2gpIFwKKyh7IFwKKwl1bnNpZ25lZCBp
bnQgd2hpY2hfID0gd2hpY2g7IFwKKwlnZW4zX2lycV9yZXNldCgodW5jb3JlKSwgR0VOOF8jI3R5
cGUjI19JTVIod2hpY2hfKSwgXAorCQkgICAgICAgR0VOOF8jI3R5cGUjI19JSVIod2hpY2hfKSwg
R0VOOF8jI3R5cGUjI19JRVIod2hpY2hfKSk7IFwKK30pCisKKyNkZWZpbmUgR0VOM19JUlFfUkVT
RVQodW5jb3JlLCB0eXBlKSBcCisJZ2VuM19pcnFfcmVzZXQoKHVuY29yZSksIHR5cGUjI0lNUiwg
dHlwZSMjSUlSLCB0eXBlIyNJRVIpCisKKyNkZWZpbmUgR0VOMl9JUlFfUkVTRVQodW5jb3JlKSBc
CisJZ2VuMl9pcnFfcmVzZXQodW5jb3JlKQorCisjZGVmaW5lIEdFTjhfSVJRX0lOSVRfTkRYKHVu
Y29yZSwgdHlwZSwgd2hpY2gsIGltcl92YWwsIGllcl92YWwpIFwKKyh7IFwKKwl1bnNpZ25lZCBp
bnQgd2hpY2hfID0gd2hpY2g7IFwKKwlnZW4zX2lycV9pbml0KCh1bmNvcmUpLCBcCisJCSAgICAg
IEdFTjhfIyN0eXBlIyNfSU1SKHdoaWNoXyksIGltcl92YWwsIFwKKwkJICAgICAgR0VOOF8jI3R5
cGUjI19JRVIod2hpY2hfKSwgaWVyX3ZhbCwgXAorCQkgICAgICBHRU44XyMjdHlwZSMjX0lJUih3
aGljaF8pKTsgXAorfSkKKworI2RlZmluZSBHRU4zX0lSUV9JTklUKHVuY29yZSwgdHlwZSwgaW1y
X3ZhbCwgaWVyX3ZhbCkgXAorCWdlbjNfaXJxX2luaXQoKHVuY29yZSksIFwKKwkJICAgICAgdHlw
ZSMjSU1SLCBpbXJfdmFsLCBcCisJCSAgICAgIHR5cGUjI0lFUiwgaWVyX3ZhbCwgXAorCQkgICAg
ICB0eXBlIyNJSVIpCisKKyNkZWZpbmUgR0VOMl9JUlFfSU5JVCh1bmNvcmUsIGltcl92YWwsIGll
cl92YWwpIFwKKwlnZW4yX2lycV9pbml0KCh1bmNvcmUpLCBpbXJfdmFsLCBpZXJfdmFsKQorCiAj
ZW5kaWYgLyogX19JOTE1X0lSUV9IX18gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfcG11LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jCmluZGV4IDgx
ZmJiMjYyODA3ZC4uYWUwYjg0ODUxYzUwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3BtdS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMKQEAgLTks
NiArOSw4IEBACiAKICNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmUuaCIKICNpbmNsdWRlICJndC9p
bnRlbF9lbmdpbmVfdXNlci5oIgorI2luY2x1ZGUgImd0L2ludGVsX3JjNi5oIgorI2luY2x1ZGUg
Imd0L2ludGVsX3Jwcy5oIgogCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRlICJpOTE1
X3BtdS5oIgpAQCAtMjE4LDMyICsyMjAsMzQgQEAgYWRkX3NhbXBsZV9tdWx0KHN0cnVjdCBpOTE1
X3BtdV9zYW1wbGUgKnNhbXBsZSwgdTMyIHZhbCwgdTMyIG11bCkKIHN0YXRpYyB2b2lkCiBmcmVx
dWVuY3lfc2FtcGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdW5zaWduZWQg
aW50IHBlcmlvZF9ucykKIHsKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gJmRldl9wcml2LT5ndDsK
KwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZ3QtPnJwczsKKwogCWlmIChkZXZfcHJpdi0+cG11
LmVuYWJsZSAmCiAJICAgIGNvbmZpZ19lbmFibGVkX21hc2soSTkxNV9QTVVfQUNUVUFMX0ZSRVFV
RU5DWSkpIHsKIAkJdTMyIHZhbDsKIAotCQl2YWwgPSBkZXZfcHJpdi0+Z3RfcG0ucnBzLmN1cl9m
cmVxOwotCQlpZiAoZGV2X3ByaXYtPmd0LmF3YWtlKSB7CisJCXZhbCA9IHJwcy0+Y3VyX2ZyZXE7
CisJCWlmIChndC0+YXdha2UpIHsKIAkJCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCiAJCQl3
aXRoX2ludGVsX3J1bnRpbWVfcG1faWZfaW5fdXNlKCZkZXZfcHJpdi0+cnVudGltZV9wbSwKIAkJ
CQkJCQl3YWtlcmVmKSB7CiAJCQkJdmFsID0gaW50ZWxfdW5jb3JlX3JlYWRfbm90cmFjZSgmZGV2
X3ByaXYtPnVuY29yZSwKIAkJCQkJCQkJR0VONl9SUFNUQVQxKTsKLQkJCQl2YWwgPSBpbnRlbF9n
ZXRfY2FnZihkZXZfcHJpdiwgdmFsKTsKKwkJCQl2YWwgPSBpbnRlbF9nZXRfY2FnZihycHMsIHZh
bCk7CiAJCQl9CiAJCX0KIAogCQlhZGRfc2FtcGxlX211bHQoJmRldl9wcml2LT5wbXUuc2FtcGxl
W19fSTkxNV9TQU1QTEVfRlJFUV9BQ1RdLAotCQkJCWludGVsX2dwdV9mcmVxKGRldl9wcml2LCB2
YWwpLAorCQkJCWludGVsX2dwdV9mcmVxKHJwcywgdmFsKSwKIAkJCQlwZXJpb2RfbnMgLyAxMDAw
KTsKIAl9CiAKIAlpZiAoZGV2X3ByaXYtPnBtdS5lbmFibGUgJgogCSAgICBjb25maWdfZW5hYmxl
ZF9tYXNrKEk5MTVfUE1VX1JFUVVFU1RFRF9GUkVRVUVOQ1kpKSB7CiAJCWFkZF9zYW1wbGVfbXVs
dCgmZGV2X3ByaXYtPnBtdS5zYW1wbGVbX19JOTE1X1NBTVBMRV9GUkVRX1JFUV0sCi0JCQkJaW50
ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsCi0JCQkJCSAgICAgICBkZXZfcHJpdi0+Z3RfcG0ucnBzLmN1
cl9mcmVxKSwKKwkJCQlpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+Y3VyX2ZyZXEpLAogCQkJCXBl
cmlvZF9ucyAvIDEwMDApOwogCX0KIH0KQEAgLTQyNiwxNiArNDMwLDE2IEBAIHN0YXRpYyB1NjQg
X19nZXRfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogCXU2NCB2YWw7CiAK
LQl2YWwgPSBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKGk5MTUsCisJdmFsID0gaW50ZWxfcmM2X3Jl
c2lkZW5jeV9ucygmaTkxNS0+Z3QucmM2LAogCQkJCSAgICAgSVNfVkFMTEVZVklFVyhpOTE1KSA/
CiAJCQkJICAgICBWTFZfR1RfUkVOREVSX1JDNiA6CiAJCQkJICAgICBHRU42X0dUX0dGWF9SQzYp
OwogCiAJaWYgKEhBU19SQzZwKGk5MTUpKQotCQl2YWwgKz0gaW50ZWxfcmM2X3Jlc2lkZW5jeV9u
cyhpOTE1LCBHRU42X0dUX0dGWF9SQzZwKTsKKwkJdmFsICs9IGludGVsX3JjNl9yZXNpZGVuY3lf
bnMoJmk5MTUtPmd0LnJjNiwgR0VONl9HVF9HRlhfUkM2cCk7CiAKIAlpZiAoSEFTX1JDNnBwKGk5
MTUpKQotCQl2YWwgKz0gaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhpOTE1LCBHRU42X0dUX0dGWF9S
QzZwcCk7CisJCXZhbCArPSBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKCZpOTE1LT5ndC5yYzYsIEdF
TjZfR1RfR0ZYX1JDNnBwKTsKIAogCXJldHVybiB2YWw7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cmVxdWVzdC5jCmluZGV4IDkyMzEzYTU5NTYzYy4uZTM2N2JmNWY5Mjg4IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3JlcXVlc3QuYwpAQCAtMzEsNiArMzEsNyBAQAogCiAjaW5jbHVkZSAiZ2VtL2k5
MTVfZ2VtX2NvbnRleHQuaCIKICNpbmNsdWRlICJndC9pbnRlbF9jb250ZXh0LmgiCisjaW5jbHVk
ZSAiZ3QvaW50ZWxfcnBzLmgiCiAKICNpbmNsdWRlICJpOTE1X2FjdGl2ZS5oIgogI2luY2x1ZGUg
Imk5MTVfZHJ2LmgiCkBAIC0yNjksOCArMjcwLDggQEAgc3RhdGljIGJvb2wgaTkxNV9yZXF1ZXN0
X3JldGlyZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAlpZiAodGVzdF9iaXQoRE1BX0ZFTkNF
X0ZMQUdfRU5BQkxFX1NJR05BTF9CSVQsICZycS0+ZmVuY2UuZmxhZ3MpKQogCQlpOTE1X3JlcXVl
c3RfY2FuY2VsX2JyZWFkY3J1bWIocnEpOwogCWlmIChpOTE1X3JlcXVlc3RfaGFzX3dhaXRib29z
dChycSkpIHsKLQkJR0VNX0JVR19PTighYXRvbWljX3JlYWQoJnJxLT5pOTE1LT5ndF9wbS5ycHMu
bnVtX3dhaXRlcnMpKTsKLQkJYXRvbWljX2RlYygmcnEtPmk5MTUtPmd0X3BtLnJwcy5udW1fd2Fp
dGVycyk7CisJCUdFTV9CVUdfT04oIWF0b21pY19yZWFkKCZycS0+ZW5naW5lLT5ndC0+cnBzLm51
bV93YWl0ZXJzKSk7CisJCWF0b21pY19kZWMoJnJxLT5lbmdpbmUtPmd0LT5ycHMubnVtX3dhaXRl
cnMpOwogCX0KIAlpZiAoIXRlc3RfYml0KEk5MTVfRkVOQ0VfRkxBR19BQ1RJVkUsICZycS0+ZmVu
Y2UuZmxhZ3MpKSB7CiAJCXNldF9iaXQoSTkxNV9GRU5DRV9GTEFHX0FDVElWRSwgJnJxLT5mZW5j
ZS5mbGFncyk7CkBAIC0xNDE0LDcgKzE0MTUsNyBAQCBsb25nIGk5MTVfcmVxdWVzdF93YWl0KHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCSAqLwogCWlmIChmbGFncyAmIEk5MTVfV0FJVF9QUklP
UklUWSkgewogCQlpZiAoIWk5MTVfcmVxdWVzdF9zdGFydGVkKHJxKSAmJiBJTlRFTF9HRU4ocnEt
Pmk5MTUpID49IDYpCi0JCQlnZW42X3Jwc19ib29zdChycSk7CisJCQlpbnRlbF9ycHNfYm9vc3Qo
cnEpOwogCQlpOTE1X3NjaGVkdWxlX2J1bXBfcHJpb3JpdHkocnEsIEk5MTVfUFJJT1JJVFlfV0FJ
VCk7CiAJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMKaW5kZXggNjgzNmU2ODlmMDI1Li5j
ZjhhNDBkOGVhMDkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMKQEAgLTMwLDYgKzMwLDkg
QEAKICNpbmNsdWRlIDxsaW51eC9zdGF0Lmg+CiAjaW5jbHVkZSA8bGludXgvc3lzZnMuaD4KIAor
I2luY2x1ZGUgImd0L2ludGVsX3JjNi5oIgorI2luY2x1ZGUgImd0L2ludGVsX3Jwcy5oIgorCiAj
aW5jbHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRlICJpbnRlbF9kcnYuaCIKICNpbmNsdWRlICJp
bnRlbF9wbS5oIgpAQCAtNDksNyArNTIsNyBAQCBzdGF0aWMgdTMyIGNhbGNfcmVzaWRlbmN5KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAl1NjQgcmVzID0gMDsKIAogCXdpdGhf
aW50ZWxfcnVudGltZV9wbSgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpCi0JCXJlcyA9
IGludGVsX3JjNl9yZXNpZGVuY3lfdXMoZGV2X3ByaXYsIHJlZyk7CisJCXJlcyA9IGludGVsX3Jj
Nl9yZXNpZGVuY3lfdXMoJmRldl9wcml2LT5ndC5yYzYsIHJlZyk7CiAKIAlyZXR1cm4gRElWX1JP
VU5EX0NMT1NFU1RfVUxMKHJlcywgMTAwMCk7CiB9CkBAIC0yNjEsNiArMjY0LDcgQEAgc3RhdGlj
IHNzaXplX3QgZ3RfYWN0X2ZyZXFfbWh6X3Nob3coc3RydWN0IGRldmljZSAqa2RldiwKIAkJCQkg
ICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKIHsKIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7CisJ
c3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndC5ycHM7CiAJaW50ZWxfd2FrZXJl
Zl90IHdha2VyZWY7CiAJdTMyIGZyZXE7CiAKQEAgLTI3MywzMSArMjc3LDMxIEBAIHN0YXRpYyBz
c2l6ZV90IGd0X2FjdF9mcmVxX21oel9zaG93KHN0cnVjdCBkZXZpY2UgKmtkZXYsCiAKIAkJZnJl
cSA9IChmcmVxID4+IDgpICYgMHhmZjsKIAl9IGVsc2UgewotCQlmcmVxID0gaW50ZWxfZ2V0X2Nh
Z2YoZGV2X3ByaXYsIEk5MTVfUkVBRChHRU42X1JQU1RBVDEpKTsKKwkJZnJlcSA9IGludGVsX2dl
dF9jYWdmKHJwcywgSTkxNV9SRUFEKEdFTjZfUlBTVEFUMSkpOwogCX0KIAogCWludGVsX3J1bnRp
bWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKLQlyZXR1cm4gc25w
cmludGYoYnVmLCBQQUdFX1NJWkUsICIlZFxuIiwgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIGZy
ZXEpKTsKKwlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIlZFxuIiwgaW50ZWxfZ3B1
X2ZyZXEocnBzLCBmcmVxKSk7CiB9CiAKIHN0YXRpYyBzc2l6ZV90IGd0X2N1cl9mcmVxX21oel9z
aG93KHN0cnVjdCBkZXZpY2UgKmtkZXYsCiAJCQkJICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRl
ICphdHRyLCBjaGFyICpidWYpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOworCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZk
ZXZfcHJpdi0+Z3QucnBzOwogCiAJcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJWRc
biIsCi0JCQlpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwKLQkJCQkgICAgICAgZGV2X3ByaXYtPmd0
X3BtLnJwcy5jdXJfZnJlcSkpOworCQkJaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmN1cl9mcmVx
KSk7CiB9CiAKIHN0YXRpYyBzc2l6ZV90IGd0X2Jvb3N0X2ZyZXFfbWh6X3Nob3coc3RydWN0IGRl
dmljZSAqa2Rldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKIHsK
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUo
a2Rldik7CisJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndC5ycHM7CiAKIAly
ZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIlZFxuIiwKLQkJCWludGVsX2dwdV9mcmVx
KGRldl9wcml2LAotCQkJCSAgICAgICBkZXZfcHJpdi0+Z3RfcG0ucnBzLmJvb3N0X2ZyZXEpKTsK
KwkJCWludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5ib29zdF9mcmVxKSk7CiB9CiAKIHN0YXRpYyBz
c2l6ZV90IGd0X2Jvb3N0X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCkBAIC0z
MDUsNyArMzA5LDcgQEAgc3RhdGljIHNzaXplX3QgZ3RfYm9vc3RfZnJlcV9taHpfc3RvcmUoc3Ry
dWN0IGRldmljZSAqa2RldiwKIAkJCQkgICAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgY291
bnQpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl9taW5vcl90
b19pOTE1KGtkZXYpOwotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0u
cnBzOworCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3QucnBzOwogCWJvb2wg
Ym9vc3QgPSBmYWxzZTsKIAlzc2l6ZV90IHJldDsKIAl1MzIgdmFsOwpAQCAtMzE1LDcgKzMxOSw3
IEBAIHN0YXRpYyBzc2l6ZV90IGd0X2Jvb3N0X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2Ug
KmtkZXYsCiAJCXJldHVybiByZXQ7CiAKIAkvKiBWYWxpZGF0ZSBhZ2FpbnN0IChzdGF0aWMpIGhh
cmR3YXJlIGxpbWl0cyAqLwotCXZhbCA9IGludGVsX2ZyZXFfb3Bjb2RlKGRldl9wcml2LCB2YWwp
OworCXZhbCA9IGludGVsX2ZyZXFfb3Bjb2RlKHJwcywgdmFsKTsKIAlpZiAodmFsIDwgcnBzLT5t
aW5fZnJlcSB8fCB2YWwgPiBycHMtPm1heF9mcmVxKQogCQlyZXR1cm4gLUVJTlZBTDsKIApAQCAt
MzM1LDE5ICszMzksMTkgQEAgc3RhdGljIHNzaXplX3Qgdmx2X3JwZV9mcmVxX21oel9zaG93KHN0
cnVjdCBkZXZpY2UgKmtkZXYsCiAJCQkJICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0
ciwgY2hhciAqYnVmKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtk
ZXZfbWlub3JfdG9faTkxNShrZGV2KTsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3By
aXYtPmd0LnJwczsKIAogCXJldHVybiBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIiVkXG4iLAot
CQkJaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsCi0JCQkJICAgICAgIGRldl9wcml2LT5ndF9wbS5y
cHMuZWZmaWNpZW50X2ZyZXEpKTsKKwkJCWludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5lZmZpY2ll
bnRfZnJlcSkpOwogfQogCiBzdGF0aWMgc3NpemVfdCBndF9tYXhfZnJlcV9taHpfc2hvdyhzdHJ1
Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVm
KQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9f
aTkxNShrZGV2KTsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0LnJwczsK
IAogCXJldHVybiBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIiVkXG4iLAotCQkJaW50ZWxfZ3B1
X2ZyZXEoZGV2X3ByaXYsCi0JCQkJICAgICAgIGRldl9wcml2LT5ndF9wbS5ycHMubWF4X2ZyZXFf
c29mdGxpbWl0KSk7CisJCQlpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXFfc29mdGxp
bWl0KSk7CiB9CiAKIHN0YXRpYyBzc2l6ZV90IGd0X21heF9mcmVxX21oel9zdG9yZShzdHJ1Y3Qg
ZGV2aWNlICprZGV2LApAQCAtMzU1LDE5ICszNTksMTcgQEAgc3RhdGljIHNzaXplX3QgZ3RfbWF4
X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCiAJCQkJICAgICBjb25zdCBjaGFy
ICpidWYsIHNpemVfdCBjb3VudCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0g
JmRldl9wcml2LT5ndF9wbS5ycHM7Ci0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0JdTMyIHZh
bDsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0LnJwczsKIAlzc2l6ZV90
IHJldDsKKwl1MzIgdmFsOwogCiAJcmV0ID0ga3N0cnRvdTMyKGJ1ZiwgMCwgJnZhbCk7CiAJaWYg
KHJldCkKIAkJcmV0dXJuIHJldDsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgm
ZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCW11dGV4X2xvY2soJnJwcy0+bG9jayk7CiAKLQl2YWwg
PSBpbnRlbF9mcmVxX29wY29kZShkZXZfcHJpdiwgdmFsKTsKKwl2YWwgPSBpbnRlbF9mcmVxX29w
Y29kZShycHMsIHZhbCk7CiAJaWYgKHZhbCA8IHJwcy0+bWluX2ZyZXEgfHwKIAkgICAgdmFsID4g
cnBzLT5tYXhfZnJlcSB8fAogCSAgICB2YWwgPCBycHMtPm1pbl9mcmVxX3NvZnRsaW1pdCkgewpA
QCAtMzc3LDcgKzM3OSw3IEBAIHN0YXRpYyBzc2l6ZV90IGd0X21heF9mcmVxX21oel9zdG9yZShz
dHJ1Y3QgZGV2aWNlICprZGV2LAogCiAJaWYgKHZhbCA+IHJwcy0+cnAwX2ZyZXEpCiAJCURSTV9E
RUJVRygiVXNlciByZXF1ZXN0ZWQgb3ZlcmNsb2NraW5nIHRvICVkXG4iLAotCQkJICBpbnRlbF9n
cHVfZnJlcShkZXZfcHJpdiwgdmFsKSk7CisJCQkgIGludGVsX2dwdV9mcmVxKHJwcywgdmFsKSk7
CiAKIAlycHMtPm1heF9mcmVxX3NvZnRsaW1pdCA9IHZhbDsKIApAQCAtMzg1LDE0ICszODcsMTUg
QEAgc3RhdGljIHNzaXplX3QgZ3RfbWF4X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtk
ZXYsCiAJCSAgICAgIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0LAogCQkgICAgICBycHMtPm1heF9m
cmVxX3NvZnRsaW1pdCk7CiAKLQkvKiBXZSBzdGlsbCBuZWVkICpfc2V0X3JwcyB0byBwcm9jZXNz
IHRoZSBuZXcgbWF4X2RlbGF5IGFuZAorCS8qCisJICogV2Ugc3RpbGwgbmVlZCAqX3NldF9ycHMg
dG8gcHJvY2VzcyB0aGUgbmV3IG1heF9kZWxheSBhbmQKIAkgKiB1cGRhdGUgdGhlIGludGVycnVw
dCBsaW1pdHMgYW5kIFBNSU5UUk1TSyBldmVuIHRob3VnaAotCSAqIGZyZXF1ZW5jeSByZXF1ZXN0
IG1heSBiZSB1bmNoYW5nZWQuICovCi0JcmV0ID0gaW50ZWxfc2V0X3JwcyhkZXZfcHJpdiwgdmFs
KTsKKwkgKiBmcmVxdWVuY3kgcmVxdWVzdCBtYXkgYmUgdW5jaGFuZ2VkLgorCSAqLworCWludGVs
X3Jwc19zZXQocnBzLCB2YWwpOwogCiB1bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZycHMtPmxvY2sp
OwotCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7
CiAKIAlyZXR1cm4gcmV0ID86IGNvdW50OwogfQpAQCAtNDAwLDEwICs0MDMsMTAgQEAgc3RhdGlj
IHNzaXplX3QgZ3RfbWF4X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCiBzdGF0
aWMgc3NpemVfdCBndF9taW5fZnJlcV9taHpfc2hvdyhzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1
Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQogewogCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKKwlzdHJ1Y3Qg
aW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0LnJwczsKIAogCXJldHVybiBzbnByaW50Zihi
dWYsIFBBR0VfU0laRSwgIiVkXG4iLAotCQkJaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsCi0JCQkJ
ICAgICAgIGRldl9wcml2LT5ndF9wbS5ycHMubWluX2ZyZXFfc29mdGxpbWl0KSk7CisJCQlpbnRl
bF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KSk7CiB9CiAKIHN0YXRpYyBz
c2l6ZV90IGd0X21pbl9mcmVxX21oel9zdG9yZShzdHJ1Y3QgZGV2aWNlICprZGV2LApAQCAtNDEx
LDE5ICs0MTQsMTcgQEAgc3RhdGljIHNzaXplX3QgZ3RfbWluX2ZyZXFfbWh6X3N0b3JlKHN0cnVj
dCBkZXZpY2UgKmtkZXYsCiAJCQkJICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCkK
IHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5
MTUoa2Rldik7Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7
Ci0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0JdTMyIHZhbDsKKwlzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMgPSAmZGV2X3ByaXYtPmd0LnJwczsKIAlzc2l6ZV90IHJldDsKKwl1MzIgdmFsOwogCiAJ
cmV0ID0ga3N0cnRvdTMyKGJ1ZiwgMCwgJnZhbCk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsK
IAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0p
OwogCW11dGV4X2xvY2soJnJwcy0+bG9jayk7CiAKLQl2YWwgPSBpbnRlbF9mcmVxX29wY29kZShk
ZXZfcHJpdiwgdmFsKTsKKwl2YWwgPSBpbnRlbF9mcmVxX29wY29kZShycHMsIHZhbCk7CiAJaWYg
KHZhbCA8IHJwcy0+bWluX2ZyZXEgfHwKIAkgICAgdmFsID4gcnBzLT5tYXhfZnJlcSB8fAogCSAg
ICB2YWwgPiBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCkgewpAQCAtNDM3LDE0ICs0MzgsMTUgQEAg
c3RhdGljIHNzaXplX3QgZ3RfbWluX2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYs
CiAJCSAgICAgIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0LAogCQkgICAgICBycHMtPm1heF9mcmVx
X3NvZnRsaW1pdCk7CiAKLQkvKiBXZSBzdGlsbCBuZWVkICpfc2V0X3JwcyB0byBwcm9jZXNzIHRo
ZSBuZXcgbWluX2RlbGF5IGFuZAorCS8qCisJICogV2Ugc3RpbGwgbmVlZCAqX3NldF9ycHMgdG8g
cHJvY2VzcyB0aGUgbmV3IG1pbl9kZWxheSBhbmQKIAkgKiB1cGRhdGUgdGhlIGludGVycnVwdCBs
aW1pdHMgYW5kIFBNSU5UUk1TSyBldmVuIHRob3VnaAotCSAqIGZyZXF1ZW5jeSByZXF1ZXN0IG1h
eSBiZSB1bmNoYW5nZWQuICovCi0JcmV0ID0gaW50ZWxfc2V0X3JwcyhkZXZfcHJpdiwgdmFsKTsK
KwkgKiBmcmVxdWVuY3kgcmVxdWVzdCBtYXkgYmUgdW5jaGFuZ2VkLgorCSAqLworCWludGVsX3Jw
c19zZXQocnBzLCB2YWwpOwogCiB1bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZycHMtPmxvY2spOwot
CWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAK
IAlyZXR1cm4gcmV0ID86IGNvdW50OwogfQpAQCAtNDY2LDE1ICs0NjgsMTUgQEAgc3RhdGljIERF
VklDRV9BVFRSKGd0X1JQbl9mcmVxX21oeiwgU19JUlVHTywgZ3RfcnBfbWh6X3Nob3csIE5VTEwp
Owogc3RhdGljIHNzaXplX3QgZ3RfcnBfbWh6X3Nob3coc3RydWN0IGRldmljZSAqa2Rldiwgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKIHsKIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Ci0Jc3RydWN0
IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7CisJc3RydWN0IGludGVsX3Jw
cyAqcnBzID0gJmRldl9wcml2LT5ndC5ycHM7CiAJdTMyIHZhbDsKIAogCWlmIChhdHRyID09ICZk
ZXZfYXR0cl9ndF9SUDBfZnJlcV9taHopCi0JCXZhbCA9IGludGVsX2dwdV9mcmVxKGRldl9wcml2
LCBycHMtPnJwMF9mcmVxKTsKKwkJdmFsID0gaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPnJwMF9m
cmVxKTsKIAllbHNlIGlmIChhdHRyID09ICZkZXZfYXR0cl9ndF9SUDFfZnJlcV9taHopCi0JCXZh
bCA9IGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPnJwMV9mcmVxKTsKKwkJdmFsID0gaW50
ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPnJwMV9mcmVxKTsKIAllbHNlIGlmIChhdHRyID09ICZkZXZf
YXR0cl9ndF9SUG5fZnJlcV9taHopCi0JCXZhbCA9IGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBy
cHMtPm1pbl9mcmVxKTsKKwkJdmFsID0gaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1pbl9mcmVx
KTsKIAllbHNlCiAJCUJVRygpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwppbmRleCAyMjQ3MmYy
YmQzMWIuLjdlYTdjNTA3OTNhYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCkBAIC0zNywzMiAr
MzcsMTMgQEAKICNpbmNsdWRlICJkaXNwbGF5L2ludGVsX2ZiYy5oIgogI2luY2x1ZGUgImRpc3Bs
YXkvaW50ZWxfc3ByaXRlLmgiCiAKKyNpbmNsdWRlICJndC9pbnRlbF9ycHMuaCIKKwogI2luY2x1
ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAiaTkxNV9pcnEuaCIKICNpbmNsdWRlICJpbnRlbF9k
cnYuaCIKICNpbmNsdWRlICJpbnRlbF9wbS5oIgogI2luY2x1ZGUgImludGVsX3NpZGViYW5kLmgi
Ci0jaW5jbHVkZSAiLi4vLi4vLi4vcGxhdGZvcm0veDg2L2ludGVsX2lwcy5oIgotCi0vKioKLSAq
IERPQzogUkM2Ci0gKgotICogUkM2IGlzIGEgc3BlY2lhbCBwb3dlciBzdGFnZSB3aGljaCBhbGxv
d3MgdGhlIEdQVSB0byBlbnRlciBhbiB2ZXJ5Ci0gKiBsb3ctdm9sdGFnZSBtb2RlIHdoZW4gaWRs
ZSwgdXNpbmcgZG93biB0byAwViB3aGlsZSBhdCB0aGlzIHN0YWdlLiAgVGhpcwotICogc3RhZ2Ug
aXMgZW50ZXJlZCBhdXRvbWF0aWNhbGx5IHdoZW4gdGhlIEdQVSBpcyBpZGxlIHdoZW4gUkM2IHN1
cHBvcnQgaXMKLSAqIGVuYWJsZWQsIGFuZCBhcyBzb29uIGFzIG5ldyB3b3JrbG9hZCBhcmlzZXMg
R1BVIHdha2VzIHVwIGF1dG9tYXRpY2FsbHkgYXMgd2VsbC4KLSAqCi0gKiBUaGVyZSBhcmUgZGlm
ZmVyZW50IFJDNiBtb2RlcyBhdmFpbGFibGUgaW4gSW50ZWwgR1BVLCB3aGljaCBkaWZmZXJlbnRp
YXRlCi0gKiBhbW9uZyBlYWNoIG90aGVyIHdpdGggdGhlIGxhdGVuY3kgcmVxdWlyZWQgdG8gZW50
ZXIgYW5kIGxlYXZlIFJDNiBhbmQKLSAqIHZvbHRhZ2UgY29uc3VtZWQgYnkgdGhlIEdQVSBpbiBk
aWZmZXJlbnQgc3RhdGVzLgotICoKLSAqIFRoZSBjb21iaW5hdGlvbiBvZiB0aGUgZm9sbG93aW5n
IGZsYWdzIGRlZmluZSB3aGljaCBzdGF0ZXMgR1BVIGlzIGFsbG93ZWQKLSAqIHRvIGVudGVyLCB3
aGlsZSBSQzYgaXMgdGhlIG5vcm1hbCBSQzYgc3RhdGUsIFJDNnAgaXMgdGhlIGRlZXAgUkM2LCBh
bmQKLSAqIFJDNnBwIGlzIGRlZXBlc3QgUkM2LiBUaGVpciBzdXBwb3J0IGJ5IGhhcmR3YXJlIHZh
cmllcyBhY2NvcmRpbmcgdG8gdGhlCi0gKiBHUFUsIEJJT1MsIGNoaXBzZXQgYW5kIHBsYXRmb3Jt
LiBSQzYgaXMgdXN1YWxseSB0aGUgc2FmZXN0IG9uZSBhbmQgdGhlIG9uZQotICogd2hpY2ggYnJp
bmdzIHRoZSBtb3N0IHBvd2VyIHNhdmluZ3M7IGRlZXBlciBzdGF0ZXMgc2F2ZSBtb3JlIHBvd2Vy
LCBidXQKLSAqIHJlcXVpcmUgaGlnaGVyIGxhdGVuY3kgdG8gc3dpdGNoIHRvIGFuZCB3YWtlIHVw
LgotICovCiAKIHN0YXRpYyB2b2lkIGdlbjlfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogewpAQCAtMjE1LDcgKzE5Niw2IEBAIHN0YXRpYyB2b2lk
IGk5MTVfaXJvbmxha2VfZ2V0X21lbV9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKIAkJYnJlYWs7CiAJfQogCi0JZGV2X3ByaXYtPmlwcy5yX3QgPSBkZXZfcHJpdi0+bWVt
X2ZyZXE7CiAKIAlzd2l0Y2ggKGNzaXBsbCAmIDB4M2ZmKSB7CiAJY2FzZSAweDAwYzoKQEAgLTI0
NiwxMyArMjI2LDYgQEAgc3RhdGljIHZvaWQgaTkxNV9pcm9ubGFrZV9nZXRfbWVtX2ZyZXEoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQlicmVhazsKIAl9CiAKLQlpZiAoZGV2
X3ByaXYtPmZzYl9mcmVxID09IDMyMDApIHsKLQkJZGV2X3ByaXYtPmlwcy5jX20gPSAwOwotCX0g
ZWxzZSBpZiAoZGV2X3ByaXYtPmZzYl9mcmVxID4gMzIwMCAmJiBkZXZfcHJpdi0+ZnNiX2ZyZXEg
PD0gNDgwMCkgewotCQlkZXZfcHJpdi0+aXBzLmNfbSA9IDE7Ci0JfSBlbHNlIHsKLQkJZGV2X3By
aXYtPmlwcy5jX20gPSAyOwotCX0KIH0KIAogc3RhdGljIGNvbnN0IHN0cnVjdCBjeHNyX2xhdGVu
Y3kgY3hzcl9sYXRlbmN5X3RhYmxlW10gPSB7CkBAIC02Mzg4LDI2MzIgKzYzNjEsMjYwIEBAIHZv
aWQgaW50ZWxfaW5pdF9pcGMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWlu
dGVsX2VuYWJsZV9pcGMoZGV2X3ByaXYpOwogfQogCi0vKgotICogTG9jayBwcm90ZWN0aW5nIElQ
UyByZWxhdGVkIGRhdGEgc3RydWN0dXJlcwotICovCi1ERUZJTkVfU1BJTkxPQ0sobWNoZGV2X2xv
Y2spOworc3RhdGljIHZvaWQgaWJ4X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKK3sKKwkvKgorCSAqIE9uIEliZXggUGVhayBhbmQgQ291Z2FyIFBv
aW50LCB3ZSBuZWVkIHRvIGRpc2FibGUgY2xvY2sKKwkgKiBnYXRpbmcgZm9yIHRoZSBwYW5lbCBw
b3dlciBzZXF1ZW5jZXIgb3IgaXQgd2lsbCBmYWlsIHRvCisJICogc3RhcnQgdXAgd2hlbiBubyBw
b3J0cyBhcmUgYWN0aXZlLgorCSAqLworCUk5MTVfV1JJVEUoU09VVEhfRFNQQ0xLX0dBVEVfRCwg
UENIX0RQTFNVTklUX0NMT0NLX0dBVEVfRElTQUJMRSk7Cit9CiAKLWJvb2wgaXJvbmxha2Vfc2V0
X2RycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHU4IHZhbCkKK3N0YXRpYyB2b2lk
IGc0eF9kaXNhYmxlX3RyaWNrbGVfZmVlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCiB7Ci0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKLQl1
MTYgcmd2c3djdGw7CisJZW51bSBwaXBlIHBpcGU7CiAKLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZt
Y2hkZXZfbG9jayk7CisJZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgeworCQlJOTE1X1dS
SVRFKERTUENOVFIocGlwZSksCisJCQkgICBJOTE1X1JFQUQoRFNQQ05UUihwaXBlKSkgfAorCQkJ
ICAgRElTUFBMQU5FX1RSSUNLTEVfRkVFRF9ESVNBQkxFKTsKIAotCXJndnN3Y3RsID0gaW50ZWxf
dW5jb3JlX3JlYWQxNih1bmNvcmUsIE1FTVNXQ1RMKTsKLQlpZiAocmd2c3djdGwgJiBNRU1DVExf
Q01EX1NUUykgewotCQlEUk1fREVCVUcoImdwdSBidXN5LCBSQ1MgY2hhbmdlIHJlamVjdGVkXG4i
KTsKLQkJcmV0dXJuIGZhbHNlOyAvKiBzdGlsbCBidXN5IHdpdGggYW5vdGhlciBjb21tYW5kICov
CisJCUk5MTVfV1JJVEUoRFNQU1VSRihwaXBlKSwgSTkxNV9SRUFEKERTUFNVUkYocGlwZSkpKTsK
KwkJUE9TVElOR19SRUFEKERTUFNVUkYocGlwZSkpOwogCX0KLQotCXJndnN3Y3RsID0gKE1FTUNU
TF9DTURfQ0hGUkVRIDw8IE1FTUNUTF9DTURfU0hJRlQpIHwKLQkJKHZhbCA8PCBNRU1DVExfRlJF
UV9TSElGVCkgfCBNRU1DVExfU0ZDQVZNOwotCWludGVsX3VuY29yZV93cml0ZTE2KHVuY29yZSwg
TUVNU1dDVEwsIHJndnN3Y3RsKTsKLQlpbnRlbF91bmNvcmVfcG9zdGluZ19yZWFkMTYodW5jb3Jl
LCBNRU1TV0NUTCk7Ci0KLQlyZ3Zzd2N0bCB8PSBNRU1DVExfQ01EX1NUUzsKLQlpbnRlbF91bmNv
cmVfd3JpdGUxNih1bmNvcmUsIE1FTVNXQ1RMLCByZ3Zzd2N0bCk7Ci0KLQlyZXR1cm4gdHJ1ZTsK
IH0KIAotc3RhdGljIHZvaWQgaXJvbmxha2VfZW5hYmxlX2RycHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQorc3RhdGljIHZvaWQgaWxrX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKLQl1MzIgcmd2bW9kZWN0bDsKLQl1OCBmbWF4LCBm
bWluLCBmc3RhcnQsIHZzdGFydDsKLQotCXNwaW5fbG9ja19pcnEoJm1jaGRldl9sb2NrKTsKLQot
CXJndm1vZGVjdGwgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIE1FTU1PREVDVEwpOwotCi0J
LyogRW5hYmxlIHRlbXAgcmVwb3J0aW5nICovCi0JaW50ZWxfdW5jb3JlX3dyaXRlMTYodW5jb3Jl
LCBQTU1JU0MsIEk5MTVfUkVBRChQTU1JU0MpIHwgTUNQUENFX0VOKTsKLQlpbnRlbF91bmNvcmVf
d3JpdGUxNih1bmNvcmUsIFRTQzEsIEk5MTVfUkVBRChUU0MxKSB8IFRTRSk7Ci0KLQkvKiAxMDBt
cyBSQyBldmFsdWF0aW9uIGludGVydmFscyAqLwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUs
IFJDVVBFSSwgMTAwMDAwKTsKLQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBSQ0RORUksIDEw
MDAwMCk7Ci0KLQkvKiBTZXQgbWF4L21pbiB0aHJlc2hvbGRzIHRvIDkwbXMgYW5kIDgwbXMgcmVz
cGVjdGl2ZWx5ICovCi0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgUkNCTUFYQVZHLCA5MDAw
MCk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgUkNCTUlOQVZHLCA4MDAwMCk7Ci0KLQlp
bnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBNRU1JSFlTVCwgMSk7Ci0KLQkvKiBTZXQgdXAgbWlu
LCBtYXgsIGFuZCBjdXIgZm9yIGludGVycnVwdCBoYW5kbGluZyAqLwotCWZtYXggPSAocmd2bW9k
ZWN0bCAmIE1FTU1PREVfRk1BWF9NQVNLKSA+PiBNRU1NT0RFX0ZNQVhfU0hJRlQ7Ci0JZm1pbiA9
IChyZ3Ztb2RlY3RsICYgTUVNTU9ERV9GTUlOX01BU0spOwotCWZzdGFydCA9IChyZ3Ztb2RlY3Rs
ICYgTUVNTU9ERV9GU1RBUlRfTUFTSykgPj4KLQkJTUVNTU9ERV9GU1RBUlRfU0hJRlQ7Ci0KLQl2
c3RhcnQgPSAoaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBQWFZGUkVRKGZzdGFydCkpICYKLQkJ
ICBQWFZGUkVRX1BYX01BU0spID4+IFBYVkZSRVFfUFhfU0hJRlQ7Ci0KLQlkZXZfcHJpdi0+aXBz
LmZtYXggPSBmbWF4OyAvKiBJUFMgY2FsbGJhY2sgd2lsbCBpbmNyZWFzZSB0aGlzICovCi0JZGV2
X3ByaXYtPmlwcy5mc3RhcnQgPSBmc3RhcnQ7CisJdTMyIGRzcGNsa19nYXRlID0gSUxLX1ZSSFVO
SVRfQ0xPQ0tfR0FURV9ESVNBQkxFOwogCi0JZGV2X3ByaXYtPmlwcy5tYXhfZGVsYXkgPSBmc3Rh
cnQ7Ci0JZGV2X3ByaXYtPmlwcy5taW5fZGVsYXkgPSBmbWluOwotCWRldl9wcml2LT5pcHMuY3Vy
X2RlbGF5ID0gZnN0YXJ0OworCS8qCisJICogUmVxdWlyZWQgZm9yIEZCQworCSAqIFdhRmJjRGlz
YWJsZURwZmNDbG9ja0dhdGluZzppbGsKKwkgKi8KKwlkc3BjbGtfZ2F0ZSB8PSBJTEtfRFBGQ1JV
TklUX0NMT0NLX0dBVEVfRElTQUJMRSB8CisJCSAgIElMS19EUEZDVU5JVF9DTE9DS19HQVRFX0RJ
U0FCTEUgfAorCQkgICBJTEtfRFBGRFVOSVRfQ0xPQ0tfR0FURV9FTkFCTEU7CiAKLQlEUk1fREVC
VUdfRFJJVkVSKCJmbWF4OiAlZCwgZm1pbjogJWQsIGZzdGFydDogJWRcbiIsCi0JCQkgZm1heCwg
Zm1pbiwgZnN0YXJ0KTsKKwlJOTE1X1dSSVRFKFBDSF8zRENHRElTMCwKKwkJICAgTUFSSVVOSVRf
Q0xPQ0tfR0FURV9ESVNBQkxFIHwKKwkJICAgU1ZTTVVOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFKTsK
KwlJOTE1X1dSSVRFKFBDSF8zRENHRElTMSwKKwkJICAgVkZNVU5JVF9DTE9DS19HQVRFX0RJU0FC
TEUpOwogCi0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwKLQkJCSAgIE1FTUlOVFJFTiwKLQkJ
CSAgIE1FTUlOVF9DWF9TVVBSX0VOIHwgTUVNSU5UX0VWQUxfQ0hHX0VOKTsKKwkvKgorCSAqIEFj
Y29yZGluZyB0byB0aGUgc3BlYyB0aGUgZm9sbG93aW5nIGJpdHMgc2hvdWxkIGJlIHNldCBpbgor
CSAqIG9yZGVyIHRvIGVuYWJsZSBtZW1vcnkgc2VsZi1yZWZyZXNoCisJICogVGhlIGJpdCAyMi8y
MSBvZiAweDQyMDA0CisJICogVGhlIGJpdCA1IG9mIDB4NDIwMjAKKwkgKiBUaGUgYml0IDE1IG9m
IDB4NDUwMDAKKwkgKi8KKwlJOTE1X1dSSVRFKElMS19ESVNQTEFZX0NISUNLRU4yLAorCQkgICAo
STkxNV9SRUFEKElMS19ESVNQTEFZX0NISUNLRU4yKSB8CisJCSAgICBJTEtfRFBBUkJfR0FURSB8
IElMS19WU0RQRkRfRlVMTCkpOworCWRzcGNsa19nYXRlIHw9IElMS19EUEFSQlVOSVRfQ0xPQ0tf
R0FURV9FTkFCTEU7CisJSTkxNV9XUklURShESVNQX0FSQl9DVEwsCisJCSAgIChJOTE1X1JFQUQo
RElTUF9BUkJfQ1RMKSB8CisJCSAgICBESVNQX0ZCQ19XTV9ESVMpKTsKIAogCS8qCi0JICogSW50
ZXJydXB0cyB3aWxsIGJlIGVuYWJsZWQgaW4gaXJvbmxha2VfaXJxX3Bvc3RpbnN0YWxsCisJICog
QmFzZWQgb24gdGhlIGRvY3VtZW50IGZyb20gaGFyZHdhcmUgZ3V5cyB0aGUgZm9sbG93aW5nIGJp
dHMKKwkgKiBzaG91bGQgYmUgc2V0IHVuY29uZGl0aW9uYWxseSBpbiBvcmRlciB0byBlbmFibGUg
RkJDLgorCSAqIFRoZSBiaXQgMjIgb2YgMHg0MjAwMAorCSAqIFRoZSBiaXQgMjIgb2YgMHg0MjAw
NAorCSAqIFRoZSBiaXQgNyw4LDkgb2YgMHg0MjAyMC4KIAkgKi8KKwlpZiAoSVNfSVJPTkxBS0Vf
TShkZXZfcHJpdikpIHsKKwkJLyogV2FGYmNBc3luY2hGbGlwRGlzYWJsZUZiY1F1ZXVlOmlsayAq
LworCQlJOTE1X1dSSVRFKElMS19ESVNQTEFZX0NISUNLRU4xLAorCQkJICAgSTkxNV9SRUFEKElM
S19ESVNQTEFZX0NISUNLRU4xKSB8CisJCQkgICBJTEtfRkJDUV9ESVMpOworCQlJOTE1X1dSSVRF
KElMS19ESVNQTEFZX0NISUNLRU4yLAorCQkJICAgSTkxNV9SRUFEKElMS19ESVNQTEFZX0NISUNL
RU4yKSB8CisJCQkgICBJTEtfRFBBUkJfR0FURSk7CisJfQogCi0JaW50ZWxfdW5jb3JlX3dyaXRl
KHVuY29yZSwgVklEU1RBUlQsIHZzdGFydCk7Ci0JaW50ZWxfdW5jb3JlX3Bvc3RpbmdfcmVhZCh1
bmNvcmUsIFZJRFNUQVJUKTsKKwlJOTE1X1dSSVRFKElMS19EU1BDTEtfR0FURV9ELCBkc3BjbGtf
Z2F0ZSk7CiAKLQlyZ3Ztb2RlY3RsIHw9IE1FTU1PREVfU1dNT0RFX0VOOwotCWludGVsX3VuY29y
ZV93cml0ZSh1bmNvcmUsIE1FTU1PREVDVEwsIHJndm1vZGVjdGwpOworCUk5MTVfV1JJVEUoSUxL
X0RJU1BMQVlfQ0hJQ0tFTjIsCisJCSAgIEk5MTVfUkVBRChJTEtfRElTUExBWV9DSElDS0VOMikg
fAorCQkgICBJTEtfRUxQSU5fNDA5X1NFTEVDVCk7CisJSTkxNV9XUklURShfM0RfQ0hJQ0tFTjIs
CisJCSAgIF8zRF9DSElDS0VOMl9XTV9SRUFEX1BJUEVMSU5FRCA8PCAxNiB8CisJCSAgIF8zRF9D
SElDS0VOMl9XTV9SRUFEX1BJUEVMSU5FRCk7CiAKLQlpZiAod2FpdF9mb3JfYXRvbWljKChpbnRl
bF91bmNvcmVfcmVhZCh1bmNvcmUsIE1FTVNXQ1RMKSAmCi0JCQkgICAgIE1FTUNUTF9DTURfU1RT
KSA9PSAwLCAxMCkpCi0JCURSTV9FUlJPUigic3R1Y2sgdHJ5aW5nIHRvIGNoYW5nZSBwZXJmIG1v
ZGVcbiIpOwotCW1kZWxheSgxKTsKKwkvKiBXYURpc2FibGVSZW5kZXJDYWNoZVBpcGVsaW5lZEZs
dXNoOmlsayAqLworCUk5MTVfV1JJVEUoQ0FDSEVfTU9ERV8wLAorCQkgICBfTUFTS0VEX0JJVF9F
TkFCTEUoQ00wX1BJUEVMSU5FRF9SRU5ERVJfRkxVU0hfRElTQUJMRSkpOwogCi0JaXJvbmxha2Vf
c2V0X2RycHMoZGV2X3ByaXYsIGZzdGFydCk7CisJLyogV2FEaXNhYmxlX1JlbmRlckNhY2hlX09w
ZXJhdGlvbmFsRmx1c2g6aWxrICovCisJSTkxNV9XUklURShDQUNIRV9NT0RFXzAsIF9NQVNLRURf
QklUX0RJU0FCTEUoUkNfT1BfRkxVU0hfRU5BQkxFKSk7CiAKLQlkZXZfcHJpdi0+aXBzLmxhc3Rf
Y291bnQxID0KLQkJaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBETUlFQykgKwotCQlpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIEREUkVDKSArCi0JCWludGVsX3VuY29yZV9yZWFkKHVuY29yZSwg
Q1NJRUMpOwotCWRldl9wcml2LT5pcHMubGFzdF90aW1lMSA9IGppZmZpZXNfdG9fbXNlY3Moamlm
Zmllcyk7Ci0JZGV2X3ByaXYtPmlwcy5sYXN0X2NvdW50MiA9IGludGVsX3VuY29yZV9yZWFkKHVu
Y29yZSwgR0ZYRUMpOwotCWRldl9wcml2LT5pcHMubGFzdF90aW1lMiA9IGt0aW1lX2dldF9yYXdf
bnMoKTsKKwlnNHhfZGlzYWJsZV90cmlja2xlX2ZlZWQoZGV2X3ByaXYpOwogCi0Jc3Bpbl91bmxv
Y2tfaXJxKCZtY2hkZXZfbG9jayk7CisJaWJ4X2luaXRfY2xvY2tfZ2F0aW5nKGRldl9wcml2KTsK
IH0KIAotc3RhdGljIHZvaWQgaXJvbmxha2VfZGlzYWJsZV9kcnBzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQorc3RhdGljIHZvaWQgY3B0X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUgPSAmaTkxNS0+dW5jb3JlOwotCXUxNiByZ3Zzd2N0bDsKLQotCXNwaW5fbG9ja19pcnEoJm1j
aGRldl9sb2NrKTsKLQotCXJndnN3Y3RsID0gaW50ZWxfdW5jb3JlX3JlYWQxNih1bmNvcmUsIE1F
TVNXQ1RMKTsKLQotCS8qIEFjayBpbnRlcnJ1cHRzLCBkaXNhYmxlIEVGQyBpbnRlcnJ1cHQgKi8K
LQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLAotCQkJICAgTUVNSU5UUkVOLAotCQkJICAgaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBNRU1JTlRSRU4pICYKLQkJCSAgIH5NRU1JTlRfRVZBTF9D
SEdfRU4pOwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIE1FTUlOVFJTVFMsIE1FTUlOVF9F
VkFMX0NIRyk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwKLQkJCSAgIERFSUVSLAotCQkJ
ICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBERUlFUikgJiB+REVfUENVX0VWRU5UKTsKLQlp
bnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBERUlJUiwgREVfUENVX0VWRU5UKTsKLQlpbnRlbF91
bmNvcmVfd3JpdGUodW5jb3JlLAotCQkJICAgREVJTVIsCi0JCQkgICBpbnRlbF91bmNvcmVfcmVh
ZCh1bmNvcmUsIERFSU1SKSB8IERFX1BDVV9FVkVOVCk7Ci0KLQkvKiBHbyBiYWNrIHRvIHRoZSBz
dGFydGluZyBmcmVxdWVuY3kgKi8KLQlpcm9ubGFrZV9zZXRfZHJwcyhpOTE1LCBpOTE1LT5pcHMu
ZnN0YXJ0KTsKLQltZGVsYXkoMSk7Ci0Jcmd2c3djdGwgfD0gTUVNQ1RMX0NNRF9TVFM7Ci0JaW50
ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgTUVNU1dDVEwsIHJndnN3Y3RsKTsKLQltZGVsYXkoMSk7
CisJaW50IHBpcGU7CisJdTMyIHZhbDsKIAotCXNwaW5fdW5sb2NrX2lycSgmbWNoZGV2X2xvY2sp
OworCS8qCisJICogT24gSWJleCBQZWFrIGFuZCBDb3VnYXIgUG9pbnQsIHdlIG5lZWQgdG8gZGlz
YWJsZSBjbG9jaworCSAqIGdhdGluZyBmb3IgdGhlIHBhbmVsIHBvd2VyIHNlcXVlbmNlciBvciBp
dCB3aWxsIGZhaWwgdG8KKwkgKiBzdGFydCB1cCB3aGVuIG5vIHBvcnRzIGFyZSBhY3RpdmUuCisJ
ICovCisJSTkxNV9XUklURShTT1VUSF9EU1BDTEtfR0FURV9ELCBQQ0hfRFBMU1VOSVRfQ0xPQ0tf
R0FURV9ESVNBQkxFIHwKKwkJICAgUENIX0RQTFVOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFIHwKKwkJ
ICAgUENIX0NQVU5JVF9DTE9DS19HQVRFX0RJU0FCTEUpOworCUk5MTVfV1JJVEUoU09VVEhfQ0hJ
Q0tFTjIsIEk5MTVfUkVBRChTT1VUSF9DSElDS0VOMikgfAorCQkgICBEUExTX0VEUF9QUFNfRklY
X0RJUyk7CisJLyogVGhlIGJlbG93IGZpeGVzIHRoZSB3ZWlyZCBkaXNwbGF5IGNvcnJ1cHRpb24s
IGEgZmV3IHBpeGVscyBzaGlmdGVkCisJICogZG93bndhcmQsIG9uIChvbmx5KSBMVkRTIG9mIHNv
bWUgSFAgbGFwdG9wcyB3aXRoIElWWS4KKwkgKi8KKwlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBw
aXBlKSB7CisJCXZhbCA9IEk5MTVfUkVBRChUUkFOU19DSElDS0VOMihwaXBlKSk7CisJCXZhbCB8
PSBUUkFOU19DSElDS0VOMl9USU1JTkdfT1ZFUlJJREU7CisJCXZhbCAmPSB+VFJBTlNfQ0hJQ0tF
TjJfRkRJX1BPTEFSSVRZX1JFVkVSU0VEOworCQlpZiAoZGV2X3ByaXYtPnZidC5mZGlfcnhfcG9s
YXJpdHlfaW52ZXJ0ZWQpCisJCQl2YWwgfD0gVFJBTlNfQ0hJQ0tFTjJfRkRJX1BPTEFSSVRZX1JF
VkVSU0VEOworCQl2YWwgJj0gflRSQU5TX0NISUNLRU4yX0ZSQU1FX1NUQVJUX0RFTEFZX01BU0s7
CisJCXZhbCAmPSB+VFJBTlNfQ0hJQ0tFTjJfRElTQUJMRV9ERUVQX0NPTE9SX0NPVU5URVI7CisJ
CXZhbCAmPSB+VFJBTlNfQ0hJQ0tFTjJfRElTQUJMRV9ERUVQX0NPTE9SX01PREVTV0lUQ0g7CisJ
CUk5MTVfV1JJVEUoVFJBTlNfQ0hJQ0tFTjIocGlwZSksIHZhbCk7CisJfQorCS8qIFdBRFAwQ2xv
Y2tHYXRpbmdEaXNhYmxlICovCisJZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgeworCQlJ
OTE1X1dSSVRFKFRSQU5TX0NISUNLRU4xKHBpcGUpLAorCQkJICAgVFJBTlNfQ0hJQ0tFTjFfRFAw
VU5JVF9HQ19ESVNBQkxFKTsKKwl9CiB9CiAKLS8qIFRoZXJlJ3MgYSBmdW5ueSBodyBpc3N1ZSB3
aGVyZSB0aGUgaHcgcmV0dXJucyBhbGwgMCB3aGVuIHJlYWRpbmcgZnJvbQotICogR0VONl9SUF9J
TlRFUlJVUFRfTElNSVRTLiBIZW5jZSB3ZSBhbHdheXMgbmVlZCB0byBjb21wdXRlIHRoZSBkZXNp
cmVkIHZhbHVlCi0gKiBvdXJzZWx2ZXMsIGluc3RlYWQgb2YgZG9pbmcgYSBybXcgY3ljbGUgKHdo
aWNoIG1pZ2h0IHJlc3VsdCBpbiB1cyBjbGVhcmluZwotICogYWxsIGxpbWl0cyBhbmQgdGhlIGdw
dSBzdHVjayBhdCB3aGF0ZXZlciBmcmVxdWVuY3kgaXQgaXMgYXQgYXRtKS4KLSAqLwotc3RhdGlj
IHUzMiBpbnRlbF9ycHNfbGltaXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
dTggdmFsKQorc3RhdGljIHZvaWQgZ2VuNl9jaGVja19tY2hfc2V0dXAoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQogewotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJp
di0+Z3RfcG0ucnBzOwotCXUzMiBsaW1pdHM7Ci0KLQkvKiBPbmx5IHNldCB0aGUgZG93biBsaW1p
dCB3aGVuIHdlJ3ZlIHJlYWNoZWQgdGhlIGxvd2VzdCBsZXZlbCB0byBhdm9pZAotCSAqIGdldHRp
bmcgbW9yZSBpbnRlcnJ1cHRzLCBvdGhlcndpc2UgbGVhdmUgdGhpcyBjbGVhci4gVGhpcyBwcmV2
ZW50cyBhCi0JICogcmFjZSBpbiB0aGUgaHcgd2hlbiBjb21pbmcgb3V0IG9mIHJjNjogVGhlcmUn
cyBhIHRpbnkgd2luZG93IHdoZXJlCi0JICogdGhlIGh3IHJ1bnMgYXQgdGhlIG1pbmltYWwgY2xv
Y2sgYmVmb3JlIHNlbGVjdGluZyB0aGUgZGVzaXJlZAotCSAqIGZyZXF1ZW5jeSwgaWYgdGhlIGRv
d24gdGhyZXNob2xkIGV4cGlyZXMgaW4gdGhhdCB3aW5kb3cgd2Ugd2lsbCBub3QKLQkgKiByZWNl
aXZlIGEgZG93biBpbnRlcnJ1cHQuICovCi0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkg
ewotCQlsaW1pdHMgPSAocnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQpIDw8IDIzOwotCQlpZiAodmFs
IDw9IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KQotCQkJbGltaXRzIHw9IChycHMtPm1pbl9mcmVx
X3NvZnRsaW1pdCkgPDwgMTQ7Ci0JfSBlbHNlIHsKLQkJbGltaXRzID0gcnBzLT5tYXhfZnJlcV9z
b2Z0bGltaXQgPDwgMjQ7Ci0JCWlmICh2YWwgPD0gcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQpCi0J
CQlsaW1pdHMgfD0gcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQgPDwgMTY7Ci0JfQorCXUzMiB0bXA7
CiAKLQlyZXR1cm4gbGltaXRzOworCXRtcCA9IEk5MTVfUkVBRChNQ0hfU1NLUEQpOworCWlmICgo
dG1wICYgTUNIX1NTS1BEX1dNMF9NQVNLKSAhPSBNQ0hfU1NLUERfV00wX1ZBTCkKKwkJRFJNX0RF
QlVHX0tNUygiV3JvbmcgTUNIX1NTS1BEIHZhbHVlOiAweCUwOHggVGhpcyBjYW4gY2F1c2UgdW5k
ZXJydW5zLlxuIiwKKwkJCSAgICAgIHRtcCk7CiB9CiAKLXN0YXRpYyB2b2lkIHJwc19zZXRfcG93
ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgbmV3X3Bvd2VyKQorc3Rh
dGljIHZvaWQgZ2VuNl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCiB7Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5y
cHM7Ci0JdTMyIHRocmVzaG9sZF91cCA9IDAsIHRocmVzaG9sZF9kb3duID0gMDsgLyogaW4gJSAq
LwotCXUzMiBlaV91cCA9IDAsIGVpX2Rvd24gPSAwOwotCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgm
cnBzLT5wb3dlci5tdXRleCk7CisJdTMyIGRzcGNsa19nYXRlID0gSUxLX1ZSSFVOSVRfQ0xPQ0tf
R0FURV9ESVNBQkxFOwogCi0JaWYgKG5ld19wb3dlciA9PSBycHMtPnBvd2VyLm1vZGUpCi0JCXJl
dHVybjsKKwlJOTE1X1dSSVRFKElMS19EU1BDTEtfR0FURV9ELCBkc3BjbGtfZ2F0ZSk7CiAKLQkv
KiBOb3RlIHRoZSB1bml0cyBoZXJlIGFyZSBub3QgZXhhY3RseSAxdXMsIGJ1dCAxMjgwbnMuICov
Ci0Jc3dpdGNoIChuZXdfcG93ZXIpIHsKLQljYXNlIExPV19QT1dFUjoKLQkJLyogVXBjbG9jayBp
ZiBtb3JlIHRoYW4gOTUlIGJ1c3kgb3ZlciAxNm1zICovCi0JCWVpX3VwID0gMTYwMDA7Ci0JCXRo
cmVzaG9sZF91cCA9IDk1OworCUk5MTVfV1JJVEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIsCisJCSAg
IEk5MTVfUkVBRChJTEtfRElTUExBWV9DSElDS0VOMikgfAorCQkgICBJTEtfRUxQSU5fNDA5X1NF
TEVDVCk7CiAKLQkJLyogRG93bmNsb2NrIGlmIGxlc3MgdGhhbiA4NSUgYnVzeSBvdmVyIDMybXMg
Ki8KLQkJZWlfZG93biA9IDMyMDAwOwotCQl0aHJlc2hvbGRfZG93biA9IDg1OwotCQlicmVhazsK
KwkvKiBXYURpc2FibGVIaVpQbGFuZXNXaGVuTVNBQUVuYWJsZWQ6c25iICovCisJSTkxNV9XUklU
RShfM0RfQ0hJQ0tFTiwKKwkJICAgX01BU0tFRF9CSVRfRU5BQkxFKF8zRF9DSElDS0VOX0hJWl9Q
TEFORV9ESVNBQkxFX01TQUFfNFhfU05CKSk7CiAKLQljYXNlIEJFVFdFRU46Ci0JCS8qIFVwY2xv
Y2sgaWYgbW9yZSB0aGFuIDkwJSBidXN5IG92ZXIgMTNtcyAqLwotCQllaV91cCA9IDEzMDAwOwot
CQl0aHJlc2hvbGRfdXAgPSA5MDsKKwkvKiBXYURpc2FibGVfUmVuZGVyQ2FjaGVfT3BlcmF0aW9u
YWxGbHVzaDpzbmIgKi8KKwlJOTE1X1dSSVRFKENBQ0hFX01PREVfMCwgX01BU0tFRF9CSVRfRElT
QUJMRShSQ19PUF9GTFVTSF9FTkFCTEUpKTsKIAotCQkvKiBEb3duY2xvY2sgaWYgbGVzcyB0aGFu
IDc1JSBidXN5IG92ZXIgMzJtcyAqLwotCQllaV9kb3duID0gMzIwMDA7Ci0JCXRocmVzaG9sZF9k
b3duID0gNzU7Ci0JCWJyZWFrOworCS8qCisJICogQlNwZWMgcmVjb29tZW5kcyA4eDQgd2hlbiBN
U0FBIGlzIHVzZWQsCisJICogaG93ZXZlciBpbiBwcmFjdGljZSAxNng0IHNlZW1zIGZhc3Rlc3Qu
CisJICoKKwkgKiBOb3RlIHRoYXQgUFMvV00gdGhyZWFkIGNvdW50cyBkZXBlbmQgb24gdGhlIFdJ
WiBoYXNoaW5nCisJICogZGlzYWJsZSBiaXQsIHdoaWNoIHdlIGRvbid0IHRvdWNoIGhlcmUsIGJ1
dCBpdCdzIGdvb2QKKwkgKiB0byBrZWVwIGluIG1pbmQgKHNlZSAzRFNUQVRFX1BTIGFuZCAzRFNU
QVRFX1dNKS4KKwkgKi8KKwlJOTE1X1dSSVRFKEdFTjZfR1RfTU9ERSwKKwkJICAgX01BU0tFRF9G
SUVMRChHRU42X1dJWl9IQVNISU5HX01BU0ssIEdFTjZfV0laX0hBU0hJTkdfMTZ4NCkpOwogCi0J
Y2FzZSBISUdIX1BPV0VSOgotCQkvKiBVcGNsb2NrIGlmIG1vcmUgdGhhbiA4NSUgYnVzeSBvdmVy
IDEwbXMgKi8KLQkJZWlfdXAgPSAxMDAwMDsKLQkJdGhyZXNob2xkX3VwID0gODU7CisJSTkxNV9X
UklURShDQUNIRV9NT0RFXzAsCisJCSAgIF9NQVNLRURfQklUX0RJU0FCTEUoQ00wX1NUQ19FVklD
VF9ESVNBQkxFX0xSQV9TTkIpKTsKIAotCQkvKiBEb3duY2xvY2sgaWYgbGVzcyB0aGFuIDYwJSBi
dXN5IG92ZXIgMzJtcyAqLwotCQllaV9kb3duID0gMzIwMDA7Ci0JCXRocmVzaG9sZF9kb3duID0g
NjA7Ci0JCWJyZWFrOwotCX0KKwlJOTE1X1dSSVRFKEdFTjZfVUNHQ1RMMSwKKwkJICAgSTkxNV9S
RUFEKEdFTjZfVUNHQ1RMMSkgfAorCQkgICBHRU42X0JMQlVOSVRfQ0xPQ0tfR0FURV9ESVNBQkxF
IHwKKwkJICAgR0VONl9DU1VOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFKTsKIAotCS8qIFdoZW4gYnl0
IGNhbiBzdXJ2aXZlIHdpdGhvdXQgc3lzdGVtIGhhbmcgd2l0aCBkeW5hbWljCi0JICogc3cgZnJl
cSBhZGp1c3RtZW50cywgdGhpcyByZXN0cmljdGlvbiBjYW4gYmUgbGlmdGVkLgorCS8qIEFjY29y
ZGluZyB0byB0aGUgQlNwZWMgdm9sMWcsIGJpdCAxMiAoUkNQQlVOSVQpIGNsb2NrCisJICogZ2F0
aW5nIGRpc2FibGUgbXVzdCBiZSBzZXQuICBGYWlsdXJlIHRvIHNldCBpdCByZXN1bHRzIGluCisJ
ICogZmxpY2tlcmluZyBwaXhlbHMgZHVlIHRvIFogd3JpdGUgb3JkZXJpbmcgZmFpbHVyZXMgYWZ0
ZXIKKwkgKiBzb21lIGFtb3VudCBvZiBydW50aW1lIGluIHRoZSBNZXNhICJmaXJlIiBkZW1vLCBh
bmQgVW5pZ2luZQorCSAqIFNhbmN0dWFyeSBhbmQgVHJvcGljcywgYW5kIGFwcGFyZW50bHkgYW55
dGhpbmcgZWxzZSB3aXRoCisJICogYWxwaGEgdGVzdCBvciBwaXhlbCBkaXNjYXJkLgorCSAqCisJ
ICogQWNjb3JkaW5nIHRvIHRoZSBzcGVjLCBiaXQgMTEgKFJDQ1VOSVQpIG11c3QgYWxzbyBiZSBz
ZXQsCisJICogYnV0IHdlIGRpZG4ndCBkZWJ1ZyBhY3R1YWwgdGVzdGNhc2VzIHRvIGZpbmQgaXQg
b3V0LgorCSAqCisJICogV2FEaXNhYmxlUkNDVW5pdENsb2NrR2F0aW5nOnNuYgorCSAqIFdhRGlz
YWJsZVJDUEJVbml0Q2xvY2tHYXRpbmc6c25iCiAJICovCi0JaWYgKElTX1ZBTExFWVZJRVcoZGV2
X3ByaXYpKQotCQlnb3RvIHNraXBfaHdfd3JpdGU7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUlBfVVBf
RUksCi0JCSAgIEdUX0lOVEVSVkFMX0ZST01fVVMoZGV2X3ByaXYsIGVpX3VwKSk7Ci0JSTkxNV9X
UklURShHRU42X1JQX1VQX1RIUkVTSE9MRCwKLQkJICAgR1RfSU5URVJWQUxfRlJPTV9VUyhkZXZf
cHJpdiwKLQkJCQkgICAgICAgZWlfdXAgKiB0aHJlc2hvbGRfdXAgLyAxMDApKTsKLQotCUk5MTVf
V1JJVEUoR0VONl9SUF9ET1dOX0VJLAotCQkgICBHVF9JTlRFUlZBTF9GUk9NX1VTKGRldl9wcml2
LCBlaV9kb3duKSk7Ci0JSTkxNV9XUklURShHRU42X1JQX0RPV05fVEhSRVNIT0xELAotCQkgICBH
VF9JTlRFUlZBTF9GUk9NX1VTKGRldl9wcml2LAotCQkJCSAgICAgICBlaV9kb3duICogdGhyZXNo
b2xkX2Rvd24gLyAxMDApKTsKLQotCUk5MTVfV1JJVEUoR0VONl9SUF9DT05UUk9MLAotCQkgICAo
SU5URUxfR0VOKGRldl9wcml2KSA+IDkgPyAwIDogR0VONl9SUF9NRURJQV9UVVJCTykgfAotCQkg
ICBHRU42X1JQX01FRElBX0hXX05PUk1BTF9NT0RFIHwKLQkJICAgR0VONl9SUF9NRURJQV9JU19H
RlggfAotCQkgICBHRU42X1JQX0VOQUJMRSB8Ci0JCSAgIEdFTjZfUlBfVVBfQlVTWV9BVkcgfAot
CQkgICBHRU42X1JQX0RPV05fSURMRV9BVkcpOwotCi1za2lwX2h3X3dyaXRlOgotCXJwcy0+cG93
ZXIubW9kZSA9IG5ld19wb3dlcjsKLQlycHMtPnBvd2VyLnVwX3RocmVzaG9sZCA9IHRocmVzaG9s
ZF91cDsKLQlycHMtPnBvd2VyLmRvd25fdGhyZXNob2xkID0gdGhyZXNob2xkX2Rvd247Ci19Ci0K
LXN0YXRpYyB2b2lkIGdlbjZfc2V0X3Jwc190aHJlc2hvbGRzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgdTggdmFsKQotewotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZf
cHJpdi0+Z3RfcG0ucnBzOwotCWludCBuZXdfcG93ZXI7Ci0KLQluZXdfcG93ZXIgPSBycHMtPnBv
d2VyLm1vZGU7Ci0Jc3dpdGNoIChycHMtPnBvd2VyLm1vZGUpIHsKLQljYXNlIExPV19QT1dFUjoK
LQkJaWYgKHZhbCA+IHJwcy0+ZWZmaWNpZW50X2ZyZXEgKyAxICYmCi0JCSAgICB2YWwgPiBycHMt
PmN1cl9mcmVxKQotCQkJbmV3X3Bvd2VyID0gQkVUV0VFTjsKLQkJYnJlYWs7CisJSTkxNV9XUklU
RShHRU42X1VDR0NUTDIsCisJCSAgIEdFTjZfUkNQQlVOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFIHwK
KwkJICAgR0VONl9SQ0NVTklUX0NMT0NLX0dBVEVfRElTQUJMRSk7CiAKLQljYXNlIEJFVFdFRU46
Ci0JCWlmICh2YWwgPD0gcnBzLT5lZmZpY2llbnRfZnJlcSAmJgotCQkgICAgdmFsIDwgcnBzLT5j
dXJfZnJlcSkKLQkJCW5ld19wb3dlciA9IExPV19QT1dFUjsKLQkJZWxzZSBpZiAodmFsID49IHJw
cy0+cnAwX2ZyZXEgJiYKLQkJCSB2YWwgPiBycHMtPmN1cl9mcmVxKQotCQkJbmV3X3Bvd2VyID0g
SElHSF9QT1dFUjsKLQkJYnJlYWs7CisJLyogV2FTdHJpcHNGYW5zRGlzYWJsZUZhc3RDbGlwUGVy
Zm9ybWFuY2VGaXg6c25iICovCisJSTkxNV9XUklURShfM0RfQ0hJQ0tFTjMsCisJCSAgIF9NQVNL
RURfQklUX0VOQUJMRShfM0RfQ0hJQ0tFTjNfU0ZfRElTQUJMRV9GQVNUQ0xJUF9DVUxMKSk7CiAK
LQljYXNlIEhJR0hfUE9XRVI6Ci0JCWlmICh2YWwgPCAocnBzLT5ycDFfZnJlcSArIHJwcy0+cnAw
X2ZyZXEpID4+IDEgJiYKLQkJICAgIHZhbCA8IHJwcy0+Y3VyX2ZyZXEpCi0JCQluZXdfcG93ZXIg
PSBCRVRXRUVOOwotCQlicmVhazsKLQl9Ci0JLyogTWF4L21pbiBiaW5zIGFyZSBzcGVjaWFsICov
Ci0JaWYgKHZhbCA8PSBycHMtPm1pbl9mcmVxX3NvZnRsaW1pdCkKLQkJbmV3X3Bvd2VyID0gTE9X
X1BPV0VSOwotCWlmICh2YWwgPj0gcnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQpCi0JCW5ld19wb3dl
ciA9IEhJR0hfUE9XRVI7CisJLyoKKwkgKiBCc3BlYyBzYXlzOgorCSAqICJUaGlzIGJpdCBtdXN0
IGJlIHNldCBpZiAzRFNUQVRFX0NMSVAgY2xpcCBtb2RlIGlzIHNldCB0byBub3JtYWwgYW5kCisJ
ICogM0RTVEFURV9TRiBudW1iZXIgb2YgU0Ygb3V0cHV0IGF0dHJpYnV0ZXMgaXMgbW9yZSB0aGFu
IDE2LiIKKwkgKi8KKwlJOTE1X1dSSVRFKF8zRF9DSElDS0VOMywKKwkJICAgX01BU0tFRF9CSVRf
RU5BQkxFKF8zRF9DSElDS0VOM19TRl9ESVNBQkxFX1BJUEVMSU5FRF9BVFRSX0ZFVENIKSk7CiAK
LQltdXRleF9sb2NrKCZycHMtPnBvd2VyLm11dGV4KTsKLQlpZiAocnBzLT5wb3dlci5pbnRlcmFj
dGl2ZSkKLQkJbmV3X3Bvd2VyID0gSElHSF9QT1dFUjsKLQlycHNfc2V0X3Bvd2VyKGRldl9wcml2
LCBuZXdfcG93ZXIpOwotCW11dGV4X3VubG9jaygmcnBzLT5wb3dlci5tdXRleCk7Ci19CisJLyoK
KwkgKiBBY2NvcmRpbmcgdG8gdGhlIHNwZWMgdGhlIGZvbGxvd2luZyBiaXRzIHNob3VsZCBiZQor
CSAqIHNldCBpbiBvcmRlciB0byBlbmFibGUgbWVtb3J5IHNlbGYtcmVmcmVzaCBhbmQgZmJjOgor
CSAqIFRoZSBiaXQyMSBhbmQgYml0MjIgb2YgMHg0MjAwMAorCSAqIFRoZSBiaXQyMSBhbmQgYml0
MjIgb2YgMHg0MjAwNAorCSAqIFRoZSBiaXQ1IGFuZCBiaXQ3IG9mIDB4NDIwMjAKKwkgKiBUaGUg
Yml0MTQgb2YgMHg3MDE4MAorCSAqIFRoZSBiaXQxNCBvZiAweDcxMTgwCisJICoKKwkgKiBXYUZi
Y0FzeW5jaEZsaXBEaXNhYmxlRmJjUXVldWU6c25iCisJICovCisJSTkxNV9XUklURShJTEtfRElT
UExBWV9DSElDS0VOMSwKKwkJICAgSTkxNV9SRUFEKElMS19ESVNQTEFZX0NISUNLRU4xKSB8CisJ
CSAgIElMS19GQkNRX0RJUyB8IElMS19QQUJTVFJFVENIX0RJUyk7CisJSTkxNV9XUklURShJTEtf
RElTUExBWV9DSElDS0VOMiwKKwkJICAgSTkxNV9SRUFEKElMS19ESVNQTEFZX0NISUNLRU4yKSB8
CisJCSAgIElMS19EUEFSQl9HQVRFIHwgSUxLX1ZTRFBGRF9GVUxMKTsKKwlJOTE1X1dSSVRFKElM
S19EU1BDTEtfR0FURV9ELAorCQkgICBJOTE1X1JFQUQoSUxLX0RTUENMS19HQVRFX0QpIHwKKwkJ
ICAgSUxLX0RQQVJCVU5JVF9DTE9DS19HQVRFX0VOQUJMRSAgfAorCQkgICBJTEtfRFBGRFVOSVRf
Q0xPQ0tfR0FURV9FTkFCTEUpOwogCi12b2lkIGludGVsX3Jwc19tYXJrX2ludGVyYWN0aXZlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBib29sIGludGVyYWN0aXZlKQotewotCXN0cnVj
dCBpbnRlbF9ycHMgKnJwcyA9ICZpOTE1LT5ndF9wbS5ycHM7CisJZzR4X2Rpc2FibGVfdHJpY2ts
ZV9mZWVkKGRldl9wcml2KTsKIAotCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA2KQotCQlyZXR1cm47
CisJY3B0X2luaXRfY2xvY2tfZ2F0aW5nKGRldl9wcml2KTsKIAotCW11dGV4X2xvY2soJnJwcy0+
cG93ZXIubXV0ZXgpOwotCWlmIChpbnRlcmFjdGl2ZSkgewotCQlpZiAoIXJwcy0+cG93ZXIuaW50
ZXJhY3RpdmUrKyAmJiBSRUFEX09OQ0UoaTkxNS0+Z3QuYXdha2UpKQotCQkJcnBzX3NldF9wb3dl
cihpOTE1LCBISUdIX1BPV0VSKTsKLQl9IGVsc2UgewotCQlHRU1fQlVHX09OKCFycHMtPnBvd2Vy
LmludGVyYWN0aXZlKTsKLQkJcnBzLT5wb3dlci5pbnRlcmFjdGl2ZS0tOwotCX0KLQltdXRleF91
bmxvY2soJnJwcy0+cG93ZXIubXV0ZXgpOworCWdlbjZfY2hlY2tfbWNoX3NldHVwKGRldl9wcml2
KTsKIH0KIAotc3RhdGljIHUzMiBnZW42X3Jwc19wbV9tYXNrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgdTggdmFsKQorc3RhdGljIHZvaWQgZ2VuN19zZXR1cF9maXhlZF9mdW5j
X3NjaGVkdWxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0Jc3RydWN0
IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0JdTMyIG1hc2sgPSAwOwot
Ci0JLyogV2UgdXNlIFVQX0VJX0VYUElSRUQgaW50ZXJ1cHRzIGZvciBib3RoIHVwL2Rvd24gaW4g
bWFudWFsIG1vZGUgKi8KLQlpZiAodmFsID4gcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQpCi0JCW1h
c2sgfD0gR0VONl9QTV9SUF9VUF9FSV9FWFBJUkVEIHwgR0VONl9QTV9SUF9ET1dOX1RIUkVTSE9M
RCB8IEdFTjZfUE1fUlBfRE9XTl9USU1FT1VUOwotCWlmICh2YWwgPCBycHMtPm1heF9mcmVxX3Nv
ZnRsaW1pdCkKLQkJbWFzayB8PSBHRU42X1BNX1JQX1VQX0VJX0VYUElSRUQgfCBHRU42X1BNX1JQ
X1VQX1RIUkVTSE9MRDsKKwl1MzIgcmVnID0gSTkxNV9SRUFEKEdFTjdfRkZfVEhSRUFEX01PREUp
OwogCi0JbWFzayAmPSBkZXZfcHJpdi0+cG1fcnBzX2V2ZW50czsKKwkvKgorCSAqIFdhVlNUaHJl
YWREaXNwYXRjaE92ZXJyaWRlOml2Yix2bHYKKwkgKgorCSAqIFRoaXMgYWN0dWFsbHkgb3ZlcnJp
ZGVzIHRoZSBkaXNwYXRjaAorCSAqIG1vZGUgZm9yIGFsbCB0aHJlYWQgdHlwZXMuCisJICovCisJ
cmVnICY9IH5HRU43X0ZGX1NDSEVEX01BU0s7CisJcmVnIHw9IEdFTjdfRkZfVFNfU0NIRURfSFc7
CisJcmVnIHw9IEdFTjdfRkZfVlNfU0NIRURfSFc7CisJcmVnIHw9IEdFTjdfRkZfRFNfU0NIRURf
SFc7CiAKLQlyZXR1cm4gZ2VuNl9zYW5pdGl6ZV9ycHNfcG1fbWFzayhkZXZfcHJpdiwgfm1hc2sp
OworCUk5MTVfV1JJVEUoR0VON19GRl9USFJFQURfTU9ERSwgcmVnKTsKIH0KIAotLyogZ2VuNl9z
ZXRfcnBzIGlzIGNhbGxlZCB0byB1cGRhdGUgdGhlIGZyZXF1ZW5jeSByZXF1ZXN0LCBidXQgc2hv
dWxkIGFsc28gYmUKLSAqIGNhbGxlZCB3aGVuIHRoZSByYW5nZSAobWluX2RlbGF5IGFuZCBtYXhf
ZGVsYXkpIGlzIG1vZGlmaWVkIHNvIHRoYXQgd2UgY2FuCi0gKiB1cGRhdGUgdGhlIEdFTjZfUlBf
SU5URVJSVVBUX0xJTUlUUyByZWdpc3RlciBhY2NvcmRpbmdseS4gKi8KLXN0YXRpYyBpbnQgZ2Vu
Nl9zZXRfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTggdmFsKQotewot
CXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwotCi0JLyogbWlu
L21heCBkZWxheSBtYXkgc3RpbGwgaGF2ZSBiZWVuIG1vZGlmaWVkIHNvIGJlIHN1cmUgdG8KLQkg
KiB3cml0ZSB0aGUgbGltaXRzIHZhbHVlLgotCSAqLwotCWlmICh2YWwgIT0gcnBzLT5jdXJfZnJl
cSkgewotCQlnZW42X3NldF9ycHNfdGhyZXNob2xkcyhkZXZfcHJpdiwgdmFsKTsKLQotCQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQotCQkJSTkxNV9XUklURShHRU42X1JQTlNXUkVRLAot
CQkJCSAgIEdFTjlfRlJFUVVFTkNZKHZhbCkpOwotCQllbHNlIGlmIChJU19IQVNXRUxMKGRldl9w
cml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQotCQkJSTkxNV9XUklURShHRU42X1JQTlNX
UkVRLAotCQkJCSAgIEhTV19GUkVRVUVOQ1kodmFsKSk7Ci0JCWVsc2UKLQkJCUk5MTVfV1JJVEUo
R0VONl9SUE5TV1JFUSwKLQkJCQkgICBHRU42X0ZSRVFVRU5DWSh2YWwpIHwKLQkJCQkgICBHRU42
X09GRlNFVCgwKSB8Ci0JCQkJICAgR0VONl9BR0dSRVNTSVZFX1RVUkJPKTsKLQl9Ci0KLQkvKiBN
YWtlIHN1cmUgd2UgY29udGludWUgdG8gZ2V0IGludGVycnVwdHMKLQkgKiB1bnRpbCB3ZSBoaXQg
dGhlIG1pbmltdW0gb3IgbWF4aW11bSBmcmVxdWVuY2llcy4KLQkgKi8KLQlJOTE1X1dSSVRFKEdF
TjZfUlBfSU5URVJSVVBUX0xJTUlUUywgaW50ZWxfcnBzX2xpbWl0cyhkZXZfcHJpdiwgdmFsKSk7
Ci0JSTkxNV9XUklURShHRU42X1BNSU5UUk1TSywgZ2VuNl9ycHNfcG1fbWFzayhkZXZfcHJpdiwg
dmFsKSk7Ci0KLQlycHMtPmN1cl9mcmVxID0gdmFsOwotCXRyYWNlX2ludGVsX2dwdV9mcmVxX2No
YW5nZShpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgdmFsKSk7Ci0KLQlyZXR1cm4gMDsKLX0KLQot
c3RhdGljIGludCB2YWxsZXl2aWV3X3NldF9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LCB1OCB2YWwpCi17Ci0JaW50IGVycjsKLQotCWlmIChXQVJOX09OQ0UoSVNfQ0hFUlJZ
VklFVyhkZXZfcHJpdikgJiYgKHZhbCAmIDEpLAotCQkgICAgICAiT2RkIEdQVSBmcmVxIHZhbHVl
XG4iKSkKLQkJdmFsICY9IH4xOwotCi0JSTkxNV9XUklURShHRU42X1BNSU5UUk1TSywgZ2VuNl9y
cHNfcG1fbWFzayhkZXZfcHJpdiwgdmFsKSk7Ci0KLQlpZiAodmFsICE9IGRldl9wcml2LT5ndF9w
bS5ycHMuY3VyX2ZyZXEpIHsKLQkJdmx2X3B1bml0X2dldChkZXZfcHJpdik7Ci0JCWVyciA9IHZs
dl9wdW5pdF93cml0ZShkZXZfcHJpdiwgUFVOSVRfUkVHX0dQVV9GUkVRX1JFUSwgdmFsKTsKLQkJ
dmx2X3B1bml0X3B1dChkZXZfcHJpdik7Ci0JCWlmIChlcnIpCi0JCQlyZXR1cm4gZXJyOwotCi0J
CWdlbjZfc2V0X3Jwc190aHJlc2hvbGRzKGRldl9wcml2LCB2YWwpOwotCX0KLQotCWRldl9wcml2
LT5ndF9wbS5ycHMuY3VyX2ZyZXEgPSB2YWw7Ci0JdHJhY2VfaW50ZWxfZ3B1X2ZyZXFfY2hhbmdl
KGludGVsX2dwdV9mcmVxKGRldl9wcml2LCB2YWwpKTsKLQotCXJldHVybiAwOwotfQotCi0vKiB2
bHZfc2V0X3Jwc19pZGxlOiBTZXQgdGhlIGZyZXF1ZW5jeSB0byBpZGxlLCBpZiBHZnggY2xvY2tz
IGFyZSBkb3duCi0gKgotICogKiBJZiBHZnggaXMgSWRsZSwgdGhlbgotICogMS4gRm9yY2V3YWtl
IE1lZGlhIHdlbGwuCi0gKiAyLiBSZXF1ZXN0IGlkbGUgZnJlcS4KLSAqIDMuIFJlbGVhc2UgRm9y
Y2V3YWtlIG9mIE1lZGlhIHdlbGwuCi0qLwotc3RhdGljIHZvaWQgdmx2X3NldF9ycHNfaWRsZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAq
cnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0JdTMyIHZhbCA9IHJwcy0+aWRsZV9mcmVxOwot
CWludCBlcnI7Ci0KLQlpZiAocnBzLT5jdXJfZnJlcSA8PSB2YWwpCi0JCXJldHVybjsKLQotCS8q
IFRoZSBwdW5pdCBkZWxheXMgdGhlIHdyaXRlIG9mIHRoZSBmcmVxdWVuY3kgYW5kIHZvbHRhZ2Ug
dW50aWwgaXQKLQkgKiBkZXRlcm1pbmVzIHRoZSBHUFUgaXMgYXdha2UuIER1cmluZyBub3JtYWwg
dXNhZ2Ugd2UgZG9uJ3Qgd2FudCB0bwotCSAqIHdhc3RlIHBvd2VyIGNoYW5naW5nIHRoZSBmcmVx
dWVuY3kgaWYgdGhlIEdQVSBpcyBzbGVlcGluZyAocmM2KS4KLQkgKiBIb3dldmVyLCB0aGUgR1BV
IGFuZCBkcml2ZXIgaXMgbm93IGlkbGUgYW5kIHdlIGRvIG5vdCB3YW50IHRvIGRlbGF5Ci0JICog
c3dpdGNoaW5nIHRvIG1pbmltdW0gdm9sdGFnZSAocmVkdWNpbmcgcG93ZXIgd2hpbHN0IGlkbGUp
IGFzIHdlIGRvCi0JICogbm90IGV4cGVjdCB0byBiZSB3b2tlbiBpbiB0aGUgbmVhciBmdXR1cmUg
YW5kIHNvIG11c3QgZmx1c2ggdGhlCi0JICogY2hhbmdlIGJ5IHdha2luZyB0aGUgZGV2aWNlLgot
CSAqCi0JICogV2UgY2hvb3NlIHRvIHRha2UgdGhlIG1lZGlhIHBvd2Vyd2VsbCAoZWl0aGVyIHdv
dWxkIGRvIHRvIHRyaWNrIHRoZQotCSAqIHB1bml0IGludG8gY29tbWl0dGluZyB0aGUgdm9sdGFn
ZSBjaGFuZ2UpIGFzIHRoYXQgdGFrZXMgYSBsb3QgbGVzcwotCSAqIHBvd2VyIHRoYW4gdGhlIHJl
bmRlciBwb3dlcndlbGwuCi0JICovCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9w
cml2LT51bmNvcmUsIEZPUkNFV0FLRV9NRURJQSk7Ci0JZXJyID0gdmFsbGV5dmlld19zZXRfcnBz
KGRldl9wcml2LCB2YWwpOwotCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+
dW5jb3JlLCBGT1JDRVdBS0VfTUVESUEpOwotCi0JaWYgKGVycikKLQkJRFJNX0VSUk9SKCJGYWls
ZWQgdG8gc2V0IFJQUyBmb3IgaWRsZVxuIik7Ci19Ci0KLXZvaWQgZ2VuNl9ycHNfYnVzeShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBz
ID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0KLQltdXRleF9sb2NrKCZycHMtPmxvY2spOwotCWlm
IChycHMtPmVuYWJsZWQpIHsKLQkJdTggZnJlcTsKLQotCQlpZiAoZGV2X3ByaXYtPnBtX3Jwc19l
dmVudHMgJiBHRU42X1BNX1JQX1VQX0VJX0VYUElSRUQpCi0JCQlnZW42X3Jwc19yZXNldF9laShk
ZXZfcHJpdik7Ci0JCUk5MTVfV1JJVEUoR0VONl9QTUlOVFJNU0ssCi0JCQkgICBnZW42X3Jwc19w
bV9tYXNrKGRldl9wcml2LCBycHMtPmN1cl9mcmVxKSk7Ci0KLQkJZ2VuNl9lbmFibGVfcnBzX2lu
dGVycnVwdHMoZGV2X3ByaXYpOwotCi0JCS8qIFVzZSB0aGUgdXNlcidzIGRlc2lyZWQgZnJlcXVl
bmN5IGFzIGEgZ3VpZGUsIGJ1dCBmb3IgYmV0dGVyCi0JCSAqIHBlcmZvcm1hbmNlLCBqdW1wIGRp
cmVjdGx5IHRvIFJQZSBhcyBvdXIgc3RhcnRpbmcgZnJlcXVlbmN5LgotCQkgKi8KLQkJZnJlcSA9
IG1heChycHMtPmN1cl9mcmVxLAotCQkJICAgcnBzLT5lZmZpY2llbnRfZnJlcSk7Ci0KLQkJaWYg
KGludGVsX3NldF9ycHMoZGV2X3ByaXYsCi0JCQkJICBjbGFtcChmcmVxLAotCQkJCQlycHMtPm1p
bl9mcmVxX3NvZnRsaW1pdCwKLQkJCQkJcnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQpKSkKLQkJCURS
TV9ERUJVR19EUklWRVIoIkZhaWxlZCB0byBzZXQgaWRsZSBmcmVxdWVuY3lcbiIpOwotCX0KLQlt
dXRleF91bmxvY2soJnJwcy0+bG9jayk7Ci19Ci0KLXZvaWQgZ2VuNl9ycHNfaWRsZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0g
JmRldl9wcml2LT5ndF9wbS5ycHM7Ci0KLQkvKiBGbHVzaCBvdXIgYm90dG9tLWhhbGYgc28gdGhh
dCBpdCBkb2VzIG5vdCByYWNlIHdpdGggdXMKLQkgKiBzZXR0aW5nIHRoZSBpZGxlIGZyZXF1ZW5j
eSBhbmQgc28gdGhhdCBpdCBpcyBib3VuZGVkIGJ5Ci0JICogb3VyIHJwbSB3YWtlcmVmLiBBbmQg
dGhlbiBkaXNhYmxlIHRoZSBpbnRlcnJ1cHRzIHRvIHN0b3AgYW55Ci0JICogZnV0aGVyIFJQUyBy
ZWNsb2NraW5nIHdoaWxzdCB3ZSBhcmUgYXNsZWVwLgotCSAqLwotCWdlbjZfZGlzYWJsZV9ycHNf
aW50ZXJydXB0cyhkZXZfcHJpdik7Ci0KLQltdXRleF9sb2NrKCZycHMtPmxvY2spOwotCWlmIChy
cHMtPmVuYWJsZWQpIHsKLQkJaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJS
WVZJRVcoZGV2X3ByaXYpKQotCQkJdmx2X3NldF9ycHNfaWRsZShkZXZfcHJpdik7Ci0JCWVsc2UK
LQkJCWdlbjZfc2V0X3JwcyhkZXZfcHJpdiwgcnBzLT5pZGxlX2ZyZXEpOwotCQlycHMtPmxhc3Rf
YWRqID0gMDsKLQkJSTkxNV9XUklURShHRU42X1BNSU5UUk1TSywKLQkJCSAgIGdlbjZfc2FuaXRp
emVfcnBzX3BtX21hc2soZGV2X3ByaXYsIH4wKSk7Ci0JfQotCW11dGV4X3VubG9jaygmcnBzLT5s
b2NrKTsKLX0KLQotdm9pZCBnZW42X3Jwc19ib29zdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkK
LXsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmcnEtPmk5MTUtPmd0X3BtLnJwczsKLQl1bnNp
Z25lZCBsb25nIGZsYWdzOwotCWJvb2wgYm9vc3Q7Ci0KLQkvKiBUaGlzIGlzIGludGVudGlvbmFs
bHkgcmFjeSEgV2UgcGVlayBhdCB0aGUgc3RhdGUgaGVyZSwgdGhlbgotCSAqIHZhbGlkYXRlIGlu
c2lkZSB0aGUgUlBTIHdvcmtlci4KLQkgKi8KLQlpZiAoIXJwcy0+ZW5hYmxlZCkKLQkJcmV0dXJu
OwotCi0JaWYgKGk5MTVfcmVxdWVzdF9zaWduYWxlZChycSkpCi0JCXJldHVybjsKLQotCS8qIFNl
cmlhbGl6ZXMgd2l0aCBpOTE1X3JlcXVlc3RfcmV0aXJlKCkgKi8KLQlib29zdCA9IGZhbHNlOwot
CXNwaW5fbG9ja19pcnFzYXZlKCZycS0+bG9jaywgZmxhZ3MpOwotCWlmICghaTkxNV9yZXF1ZXN0
X2hhc193YWl0Ym9vc3QocnEpICYmCi0JICAgICFkbWFfZmVuY2VfaXNfc2lnbmFsZWRfbG9ja2Vk
KCZycS0+ZmVuY2UpKSB7Ci0JCWJvb3N0ID0gIWF0b21pY19mZXRjaF9pbmMoJnJwcy0+bnVtX3dh
aXRlcnMpOwotCQlycS0+ZmxhZ3MgfD0gSTkxNV9SRVFVRVNUX1dBSVRCT09TVDsKLQl9Ci0Jc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmcnEtPmxvY2ssIGZsYWdzKTsKLQlpZiAoIWJvb3N0KQotCQly
ZXR1cm47Ci0KLQlpZiAoUkVBRF9PTkNFKHJwcy0+Y3VyX2ZyZXEpIDwgcnBzLT5ib29zdF9mcmVx
KQotCQlzY2hlZHVsZV93b3JrKCZycHMtPndvcmspOwotCi0JYXRvbWljX2luYygmcnBzLT5ib29z
dHMpOwotfQotCi1pbnQgaW50ZWxfc2V0X3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIHU4IHZhbCkKLXsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0
X3BtLnJwczsKLQlpbnQgZXJyOwotCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmcnBzLT5sb2NrKTsK
LQlHRU1fQlVHX09OKHZhbCA+IHJwcy0+bWF4X2ZyZXEpOwotCUdFTV9CVUdfT04odmFsIDwgcnBz
LT5taW5fZnJlcSk7Ci0KLQlpZiAoIXJwcy0+ZW5hYmxlZCkgewotCQlycHMtPmN1cl9mcmVxID0g
dmFsOwotCQlyZXR1cm4gMDsKLQl9Ci0KLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwg
SVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCi0JCWVyciA9IHZhbGxleXZpZXdfc2V0X3JwcyhkZXZf
cHJpdiwgdmFsKTsKLQllbHNlCi0JCWVyciA9IGdlbjZfc2V0X3JwcyhkZXZfcHJpdiwgdmFsKTsK
LQotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyB2b2lkIGdlbjlfZGlzYWJsZV9yYzYoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCUk5MTVfV1JJVEUoR0VONl9SQ19DT05U
Uk9MLCAwKTsKLQlJOTE1X1dSSVRFKEdFTjlfUEdfRU5BQkxFLCAwKTsKLX0KLQotc3RhdGljIHZv
aWQgZ2VuOV9kaXNhYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17
Ci0JSTkxNV9XUklURShHRU42X1JQX0NPTlRST0wsIDApOwotfQotCi1zdGF0aWMgdm9pZCBnZW42
X2Rpc2FibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlJOTE1
X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwgMCk7Ci19Ci0KLXN0YXRpYyB2b2lkIGdlbjZfZGlzYWJs
ZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCUk5MTVfV1JJVEUo
R0VONl9SUE5TV1JFUSwgMSA8PCAzMSk7Ci0JSTkxNV9XUklURShHRU42X1JQX0NPTlRST0wsIDAp
OwotfQotCi1zdGF0aWMgdm9pZCBjaGVycnl2aWV3X2Rpc2FibGVfcmM2KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlJOTE1X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwgMCk7
Ci19Ci0KLXN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfZGlzYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQotewotCUk5MTVfV1JJVEUoR0VONl9SUF9DT05UUk9MLCAwKTsK
LX0KLQotc3RhdGljIHZvaWQgdmFsbGV5dmlld19kaXNhYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JLyogV2UncmUgZG9pbmcgZm9yY2V3YWtlIGJlZm9yZSBE
aXNhYmxpbmcgUkM2LAotCSAqIFRoaXMgd2hhdCB0aGUgQklPUyBleHBlY3RzIHdoZW4gZ29pbmcg
aW50byBzdXNwZW5kICovCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51
bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCi0JSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsIDAp
OwotCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNF
V0FLRV9BTEwpOwotfQotCi1zdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2Rpc2FibGVfcnBzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlJOTE1X1dSSVRFKEdFTjZfUlBfQ09O
VFJPTCwgMCk7Ci19Ci0KLXN0YXRpYyBib29sIGJ4dF9jaGVja19iaW9zX3JjNl9zZXR1cChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JYm9vbCBlbmFibGVfcmM2ID0gdHJ1
ZTsKLQl1bnNpZ25lZCBsb25nIHJjNl9jdHhfYmFzZTsKLQl1MzIgcmNfY3RsOwotCWludCByY19z
d190YXJnZXQ7Ci0KLQlyY19jdGwgPSBJOTE1X1JFQUQoR0VONl9SQ19DT05UUk9MKTsKLQlyY19z
d190YXJnZXQgPSAoSTkxNV9SRUFEKEdFTjZfUkNfU1RBVEUpICYgUkNfU1dfVEFSR0VUX1NUQVRF
X01BU0spID4+Ci0JCSAgICAgICBSQ19TV19UQVJHRVRfU1RBVEVfU0hJRlQ7Ci0JRFJNX0RFQlVH
X0RSSVZFUigiQklPUyBlbmFibGVkIFJDIHN0YXRlczogIgotCQkJICJIV19DVFJMICVzIEhXX1JD
NiAlcyBTV19UQVJHRVRfU1RBVEUgJXhcbiIsCi0JCQkgb25vZmYocmNfY3RsICYgR0VONl9SQ19D
VExfSFdfRU5BQkxFKSwKLQkJCSBvbm9mZihyY19jdGwgJiBHRU42X1JDX0NUTF9SQzZfRU5BQkxF
KSwKLQkJCSByY19zd190YXJnZXQpOwotCi0JaWYgKCEoSTkxNV9SRUFEKFJDNl9MT0NBVElPTikg
JiBSQzZfQ1RYX0lOX0RSQU0pKSB7Ci0JCURSTV9ERUJVR19EUklWRVIoIlJDNiBCYXNlIGxvY2F0
aW9uIG5vdCBzZXQgcHJvcGVybHkuXG4iKTsKLQkJZW5hYmxlX3JjNiA9IGZhbHNlOwotCX0KLQot
CS8qCi0JICogVGhlIGV4YWN0IGNvbnRleHQgc2l6ZSBpcyBub3Qga25vd24gZm9yIEJYVCwgc28g
YXNzdW1lIGEgcGFnZSBzaXplCi0JICogZm9yIHRoaXMgY2hlY2suCi0JICovCi0JcmM2X2N0eF9i
YXNlID0gSTkxNV9SRUFEKFJDNl9DVFhfQkFTRSkgJiBSQzZfQ1RYX0JBU0VfTUFTSzsKLQlpZiAo
ISgocmM2X2N0eF9iYXNlID49IGRldl9wcml2LT5kc21fcmVzZXJ2ZWQuc3RhcnQpICYmCi0JICAg
ICAgKHJjNl9jdHhfYmFzZSArIFBBR0VfU0laRSA8IGRldl9wcml2LT5kc21fcmVzZXJ2ZWQuZW5k
KSkpIHsKLQkJRFJNX0RFQlVHX0RSSVZFUigiUkM2IEJhc2UgYWRkcmVzcyBub3QgYXMgZXhwZWN0
ZWQuXG4iKTsKLQkJZW5hYmxlX3JjNiA9IGZhbHNlOwotCX0KLQotCWlmICghKCgoSTkxNV9SRUFE
KFBXUkNUWF9NQVhDTlRfUkNTVU5JVCkgJiBJRExFX1RJTUVfTUFTSykgPiAxKSAmJgotCSAgICAg
ICgoSTkxNV9SRUFEKFBXUkNUWF9NQVhDTlRfVkNTVU5JVDApICYgSURMRV9USU1FX01BU0spID4g
MSkgJiYKLQkgICAgICAoKEk5MTVfUkVBRChQV1JDVFhfTUFYQ05UX0JDU1VOSVQpICYgSURMRV9U
SU1FX01BU0spID4gMSkgJiYKLQkgICAgICAoKEk5MTVfUkVBRChQV1JDVFhfTUFYQ05UX1ZFQ1NV
TklUKSAmIElETEVfVElNRV9NQVNLKSA+IDEpKSkgewotCQlEUk1fREVCVUdfRFJJVkVSKCJFbmdp
bmUgSWRsZSB3YWl0IHRpbWUgbm90IHNldCBwcm9wZXJseS5cbiIpOwotCQllbmFibGVfcmM2ID0g
ZmFsc2U7Ci0JfQotCi0JaWYgKCFJOTE1X1JFQUQoR0VOOF9QVVNIQlVTX0NPTlRST0wpIHx8Ci0J
ICAgICFJOTE1X1JFQUQoR0VOOF9QVVNIQlVTX0VOQUJMRSkgfHwKLQkgICAgIUk5MTVfUkVBRChH
RU44X1BVU0hCVVNfU0hJRlQpKSB7Ci0JCURSTV9ERUJVR19EUklWRVIoIlB1c2hidXMgbm90IHNl
dHVwIHByb3Blcmx5LlxuIik7Ci0JCWVuYWJsZV9yYzYgPSBmYWxzZTsKLQl9Ci0KLQlpZiAoIUk5
MTVfUkVBRChHRU42X0dGWFBBVVNFKSkgewotCQlEUk1fREVCVUdfRFJJVkVSKCJHRlggcGF1c2Ug
bm90IHNldHVwIHByb3Blcmx5LlxuIik7Ci0JCWVuYWJsZV9yYzYgPSBmYWxzZTsKLQl9Ci0KLQlp
ZiAoIUk5MTVfUkVBRChHRU44X01JU0NfQ1RSTDApKSB7Ci0JCURSTV9ERUJVR19EUklWRVIoIkdQ
TSBjb250cm9sIG5vdCBzZXR1cCBwcm9wZXJseS5cbiIpOwotCQllbmFibGVfcmM2ID0gZmFsc2U7
Ci0JfQotCi0JcmV0dXJuIGVuYWJsZV9yYzY7Ci19Ci0KLXN0YXRpYyBib29sIHNhbml0aXplX3Jj
NihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKLXsKLQlzdHJ1Y3QgaW50ZWxfZGV2aWNl
X2luZm8gKmluZm8gPSBta3dyaXRlX2RldmljZV9pbmZvKGk5MTUpOwotCi0JLyogUG93ZXJzYXZp
bmcgaXMgY29udHJvbGxlZCBieSB0aGUgaG9zdCB3aGVuIGluc2lkZSBhIFZNICovCi0JaWYgKGlu
dGVsX3ZncHVfYWN0aXZlKGk5MTUpKSB7Ci0JCWluZm8tPmhhc19yYzYgPSAwOwotCQlpbmZvLT5o
YXNfcnBzID0gZmFsc2U7Ci0JfQotCi0JaWYgKGluZm8tPmhhc19yYzYgJiYKLQkgICAgSVNfR0VO
OV9MUChpOTE1KSAmJiAhYnh0X2NoZWNrX2Jpb3NfcmM2X3NldHVwKGk5MTUpKSB7Ci0JCURSTV9J
TkZPKCJSQzYgZGlzYWJsZWQgYnkgQklPU1xuIik7Ci0JCWluZm8tPmhhc19yYzYgPSAwOwotCX0K
LQotCS8qCi0JICogV2UgYXNzdW1lIHRoYXQgd2UgZG8gbm90IGhhdmUgYW55IGRlZXAgcmM2IGxl
dmVscyBpZiB3ZSBkb24ndCBoYXZlCi0JICogaGF2ZSB0aGUgcHJldmlvdXMgcmM2IGxldmVsIHN1
cHBvcnRlZCwgaS5lLiB3ZSB1c2UgSEFTX1JDNigpCi0JICogYXMgdGhlIGluaXRpYWwgY29hcnNl
IGNoZWNrIGZvciByYzYgaW4gZ2VuZXJhbCwgbW92aW5nIG9uIHRvCi0JICogcHJvZ3Jlc3NpdmVs
eSBmaW5lci9kZWVwZXIgbGV2ZWxzLgotCSAqLwotCWlmICghaW5mby0+aGFzX3JjNiAmJiBpbmZv
LT5oYXNfcmM2cCkKLQkJaW5mby0+aGFzX3JjNnAgPSAwOwotCi0JcmV0dXJuIGluZm8tPmhhc19y
YzY7Ci19Ci0KLXN0YXRpYyB2b2lkIGdlbjZfaW5pdF9ycHNfZnJlcXVlbmNpZXMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZk
ZXZfcHJpdi0+Z3RfcG0ucnBzOwotCi0JLyogQWxsIG9mIHRoZXNlIHZhbHVlcyBhcmUgaW4gdW5p
dHMgb2YgNTBNSHogKi8KLQotCS8qIHN0YXRpYyB2YWx1ZXMgZnJvbSBIVzogUlAwID4gUlAxID4g
UlBuIChtaW5fZnJlcSkgKi8KLQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKLQkJdTMyIHJw
X3N0YXRlX2NhcCA9IEk5MTVfUkVBRChCWFRfUlBfU1RBVEVfQ0FQKTsKLQkJcnBzLT5ycDBfZnJl
cSA9IChycF9zdGF0ZV9jYXAgPj4gMTYpICYgMHhmZjsKLQkJcnBzLT5ycDFfZnJlcSA9IChycF9z
dGF0ZV9jYXAgPj4gIDgpICYgMHhmZjsKLQkJcnBzLT5taW5fZnJlcSA9IChycF9zdGF0ZV9jYXAg
Pj4gIDApICYgMHhmZjsKLQl9IGVsc2UgewotCQl1MzIgcnBfc3RhdGVfY2FwID0gSTkxNV9SRUFE
KEdFTjZfUlBfU1RBVEVfQ0FQKTsKLQkJcnBzLT5ycDBfZnJlcSA9IChycF9zdGF0ZV9jYXAgPj4g
IDApICYgMHhmZjsKLQkJcnBzLT5ycDFfZnJlcSA9IChycF9zdGF0ZV9jYXAgPj4gIDgpICYgMHhm
ZjsKLQkJcnBzLT5taW5fZnJlcSA9IChycF9zdGF0ZV9jYXAgPj4gMTYpICYgMHhmZjsKLQl9Ci0J
LyogaHdfbWF4ID0gUlAwIHVudGlsIHdlIGNoZWNrIGZvciBvdmVyY2xvY2tpbmcgKi8KLQlycHMt
Pm1heF9mcmVxID0gcnBzLT5ycDBfZnJlcTsKLQotCXJwcy0+ZWZmaWNpZW50X2ZyZXEgPSBycHMt
PnJwMV9mcmVxOwotCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdFTEwoZGV2
X3ByaXYpIHx8Ci0JICAgIElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8IElOVEVMX0dFTihkZXZfcHJp
dikgPj0gMTApIHsKLQkJdTMyIGRkY2Nfc3RhdHVzID0gMDsKLQotCQlpZiAoc2FuZHlicmlkZ2Vf
cGNvZGVfcmVhZChkZXZfcHJpdiwKLQkJCQkJICAgSFNXX1BDT0RFX0RZTkFNSUNfRFVUWV9DWUNM
RV9DT05UUk9MLAotCQkJCQkgICAmZGRjY19zdGF0dXMsIE5VTEwpID09IDApCi0JCQlycHMtPmVm
ZmljaWVudF9mcmVxID0KLQkJCQljbGFtcF90KHU4LAotCQkJCQkoKGRkY2Nfc3RhdHVzID4+IDgp
ICYgMHhmZiksCi0JCQkJCXJwcy0+bWluX2ZyZXEsCi0JCQkJCXJwcy0+bWF4X2ZyZXEpOwotCX0K
LQotCWlmIChJU19HRU45X0JDKGRldl9wcml2KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEw
KSB7Ci0JCS8qIFN0b3JlIHRoZSBmcmVxdWVuY3kgdmFsdWVzIGluIDE2LjY2IE1IWiB1bml0cywg
d2hpY2ggaXMKLQkJICogdGhlIG5hdHVyYWwgaGFyZHdhcmUgdW5pdCBmb3IgU0tMCi0JCSAqLwot
CQlycHMtPnJwMF9mcmVxICo9IEdFTjlfRlJFUV9TQ0FMRVI7Ci0JCXJwcy0+cnAxX2ZyZXEgKj0g
R0VOOV9GUkVRX1NDQUxFUjsKLQkJcnBzLT5taW5fZnJlcSAqPSBHRU45X0ZSRVFfU0NBTEVSOwot
CQlycHMtPm1heF9mcmVxICo9IEdFTjlfRlJFUV9TQ0FMRVI7Ci0JCXJwcy0+ZWZmaWNpZW50X2Zy
ZXEgKj0gR0VOOV9GUkVRX1NDQUxFUjsKLQl9Ci19Ci0KLXN0YXRpYyB2b2lkIHJlc2V0X3Jwcyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCSAgICAgIGludCAoKnNldCkoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKiwgdTgpKQotewotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9
ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwotCXU4IGZyZXEgPSBycHMtPmN1cl9mcmVxOwotCi0JLyog
Zm9yY2UgYSByZXNldCAqLwotCXJwcy0+cG93ZXIubW9kZSA9IC0xOwotCXJwcy0+Y3VyX2ZyZXEg
PSAtMTsKLQotCWlmIChzZXQoZGV2X3ByaXYsIGZyZXEpKQotCQlEUk1fRVJST1IoIkZhaWxlZCB0
byByZXNldCBSUFMgdG8gaW5pdGlhbCB2YWx1ZXNcbiIpOwotfQotCi0vKiBTZWUgdGhlIEdlbjlf
R1RfUE1fUHJvZ3JhbW1pbmdfR3VpZGUgZG9jIGZvciB0aGUgYmVsb3cgKi8KLXN0YXRpYyB2b2lk
IGdlbjlfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0J
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwotCi0JLyogUHJvZ3JhbSBkZWZhdWx0cyBhbmQgdGhyZXNob2xkcyBmb3IgUlBTICovCi0J
aWYgKElTX0dFTihkZXZfcHJpdiwgOSkpCi0JCUk5MTVfV1JJVEUoR0VONl9SQ19WSURFT19GUkVR
LAotCQkJR0VOOV9GUkVRVUVOQ1koZGV2X3ByaXYtPmd0X3BtLnJwcy5ycDFfZnJlcSkpOwotCi0J
LyogMSBzZWNvbmQgdGltZW91dCovCi0JSTkxNV9XUklURShHRU42X1JQX0RPV05fVElNRU9VVCwK
LQkJR1RfSU5URVJWQUxfRlJPTV9VUyhkZXZfcHJpdiwgMTAwMDAwMCkpOwotCi0JSTkxNV9XUklU
RShHRU42X1JQX0lETEVfSFlTVEVSU0lTLCAweGEpOwotCi0JLyogTGVhbmluZyBvbiB0aGUgYmVs
b3cgY2FsbCB0byBnZW42X3NldF9ycHMgdG8gcHJvZ3JhbS9zZXR1cCB0aGUKLQkgKiBVcC9Eb3du
IEVJICYgdGhyZXNob2xkIHJlZ2lzdGVycywgYXMgd2VsbCBhcyB0aGUgUlBfQ09OVFJPTCwKLQkg
KiBSUF9JTlRFUlJVUFRfTElNSVRTICYgUlBOU1dSRVEgcmVnaXN0ZXJzICovCi0JcmVzZXRfcnBz
KGRldl9wcml2LCBnZW42X3NldF9ycHMpOwotCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQo
JmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCi1zdGF0aWMgdm9pZCBnZW4x
MV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0K
LQkvKiAxYTogU29mdHdhcmUgUkMgc3RhdGUgLSBSQzAgKi8KLQlJOTE1X1dSSVRFKEdFTjZfUkNf
U1RBVEUsIDApOwotCi0JLyoKLQkgKiAxYjogR2V0IGZvcmNld2FrZSBkdXJpbmcgcHJvZ3JhbSBz
ZXF1ZW5jZS4gQWx0aG91Z2ggdGhlIGRyaXZlcgotCSAqIGhhc24ndCBlbmFibGVkIGEgc3RhdGUg
eWV0IHdoZXJlIHdlIG5lZWQgZm9yY2V3YWtlLCBCSU9TIG1heSBoYXZlLgotCSAqLwotCWludGVs
X3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsK
LQotCS8qIDJhOiBEaXNhYmxlIFJDIHN0YXRlcy4gKi8KLQlJOTE1X1dSSVRFKEdFTjZfUkNfQ09O
VFJPTCwgMCk7Ci0KLQkvKiAyYjogUHJvZ3JhbSBSQzYgdGhyZXNob2xkcy4qLwotCUk5MTVfV1JJ
VEUoR0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCA1NCA8PCAxNiB8IDg1KTsKLQlJOTE1X1dSSVRF
KEdFTjEwX01FRElBX1dBS0VfUkFURV9MSU1JVCwgMTUwKTsKLQotCUk5MTVfV1JJVEUoR0VONl9S
Q19FVkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDApOyAvKiAxMjUwMCAqIDEyODBucyAqLwotCUk5
MTVfV1JJVEUoR0VONl9SQ19JRExFX0hZU1RFUlNJUywgMjUpOyAvKiAyNSAqIDEyODBucyAqLwot
CWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkKLQkJSTkxNV9XUklURShSSU5H
X01BWF9JRExFKGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOwotCi0JaWYgKEhBU19HVUMoZGV2X3By
aXYpKQotCQlJOTE1X1dSSVRFKEdVQ19NQVhfSURMRV9DT1VOVCwgMHhBKTsKLQotCUk5MTVfV1JJ
VEUoR0VONl9SQ19TTEVFUCwgMCk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUkM2X1RIUkVTSE9MRCwg
NTAwMDApOyAvKiA1MC8xMjVtcyBwZXIgRUkgKi8KLQotCS8qCi0JICogMmM6IFByb2dyYW0gQ29h
cnNlIFBvd2VyIEdhdGluZyBQb2xpY2llcy4KLQkgKgotCSAqIEJzcGVjJ3MgZ3VpZGFuY2UgaXMg
dG8gdXNlIDI1dXMgKHJlYWxseSAyNSAqIDEyODBucykgaGVyZS4gV2hhdCB3ZQotCSAqIHVzZSBp
bnN0ZWFkIGlzIGEgbW9yZSBjb25zZXJ2YXRpdmUgZXN0aW1hdGUgZm9yIHRoZSBtYXhpbXVtIHRp
bWUKLQkgKiBpdCB0YWtlcyB1cyB0byBzZXJ2aWNlIGEgQ1MgaW50ZXJydXB0IGFuZCBzdWJtaXQg
YSBuZXcgRUxTUCAtIHRoYXQKLQkgKiBpcyB0aGUgdGltZSB3aGljaCB0aGUgR1BVIGlzIGlkbGUg
d2FpdGluZyBmb3IgdGhlIENQVSB0byBzZWxlY3QgdGhlCi0JICogbmV4dCByZXF1ZXN0IHRvIGV4
ZWN1dGUuIElmIHRoZSBpZGxlIGh5c3RlcmVzaXMgaXMgbGVzcyB0aGFuIHRoYXQKLQkgKiBpbnRl
cnJ1cHQgc2VydmljZSBsYXRlbmN5LCB0aGUgaGFyZHdhcmUgd2lsbCBhdXRvbWF0aWNhbGx5IGdh
dGUKLQkgKiB0aGUgcG93ZXIgd2VsbCBhbmQgd2Ugd2lsbCB0aGVuIGluY3VyIHRoZSB3YWtlIHVw
IGNvc3Qgb24gdG9wIG9mCi0JICogdGhlIHNlcnZpY2UgbGF0ZW5jeS4gQSBzaW1pbGFyIGd1aWRl
IGZyb20gcGxhbmVfc3RhdGUgaXMgdGhhdCB3ZQotCSAqIGRvIG5vdCB3YW50IHRoZSBlbmFibGUg
aHlzdGVyZXNpcyB0byBsZXNzIHRoYW4gdGhlIHdha2V1cCBsYXRlbmN5LgotCSAqCi0JICogaWd0
L2dlbV9leGVjX25vcC9zZXF1ZW50aWFsIHByb3ZpZGVzIGEgcm91Z2ggZXN0aW1hdGUgZm9yIHRo
ZQotCSAqIHNlcnZpY2UgbGF0ZW5jeSwgYW5kIHB1dHMgaXQgYXJvdW5kIDEwdXMgZm9yIEJyb2Fk
d2VsbCAoYW5kIG90aGVyCi0JICogYmlnIGNvcmUpIGFuZCBhcm91bmQgNDB1cyBmb3IgQnJveHRv
biAoYW5kIG90aGVyIGxvdyBwb3dlciBjb3JlcykuCi0JICogW05vdGUgdGhhdCBmb3IgbGVnYWN5
IHJpbmdidWZmZXIgc3VibWlzc2lvbiwgdGhpcyBpcyBsZXNzIHRoYW4gMXVzIV0KLQkgKiBIb3dl
dmVyLCB0aGUgd2FrZXVwIGxhdGVuY3kgb24gQnJveHRvbiBpcyBjbG9zZXIgdG8gMTAwdXMuIFRv
IGJlCi0JICogY29uc2VydmF0aXZlLCB3ZSBoYXZlIHRvIGZhY3RvciBpbiBhIGNvbnRleHQgc3dp
dGNoIG9uIHRvcCAoZHVlCi0JICogdG8ga3NvZnRpcnFkKS4KLQkgKi8KLQlJOTE1X1dSSVRFKEdF
TjlfTUVESUFfUEdfSURMRV9IWVNURVJFU0lTLCAyNTApOwotCUk5MTVfV1JJVEUoR0VOOV9SRU5E
RVJfUEdfSURMRV9IWVNURVJFU0lTLCAyNTApOwotCi0JLyogM2E6IEVuYWJsZSBSQzYgKi8KLQlJ
OTE1X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwKLQkJICAgR0VONl9SQ19DVExfSFdfRU5BQkxFIHwK
LQkJICAgR0VONl9SQ19DVExfUkM2X0VOQUJMRSB8Ci0JCSAgIEdFTjZfUkNfQ1RMX0VJX01PREUo
MSkpOwotCi0JLyogM2I6IEVuYWJsZSBDb2Fyc2UgUG93ZXIgR2F0aW5nIG9ubHkgd2hlbiBSQzYg
aXMgZW5hYmxlZC4gKi8KLQlJOTE1X1dSSVRFKEdFTjlfUEdfRU5BQkxFLAotCQkgICBHRU45X1JF
TkRFUl9QR19FTkFCTEUgfAotCQkgICBHRU45X01FRElBX1BHX0VOQUJMRSB8Ci0JCSAgIEdFTjEx
X01FRElBX1NBTVBMRVJfUEdfRU5BQkxFKTsKLQotCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0
KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLX0KLQotc3RhdGljIHZvaWQgZ2Vu
OV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0J
dTMyIHJjNl9tb2RlOwotCi0JLyogMWE6IFNvZnR3YXJlIFJDIHN0YXRlIC0gUkMwICovCi0JSTkx
NV9XUklURShHRU42X1JDX1NUQVRFLCAwKTsKLQotCS8qIDFiOiBHZXQgZm9yY2V3YWtlIGR1cmlu
ZyBwcm9ncmFtIHNlcXVlbmNlLiBBbHRob3VnaCB0aGUgZHJpdmVyCi0JICogaGFzbid0IGVuYWJs
ZWQgYSBzdGF0ZSB5ZXQgd2hlcmUgd2UgbmVlZCBmb3JjZXdha2UsIEJJT1MgbWF5IGhhdmUuKi8K
LQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtF
X0FMTCk7Ci0KLQkvKiAyYTogRGlzYWJsZSBSQyBzdGF0ZXMuICovCi0JSTkxNV9XUklURShHRU42
X1JDX0NPTlRST0wsIDApOwotCi0JLyogMmI6IFByb2dyYW0gUkM2IHRocmVzaG9sZHMuKi8KLQlp
ZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCkgewotCQlJOTE1X1dSSVRFKEdFTjZfUkM2X1dB
S0VfUkFURV9MSU1JVCwgNTQgPDwgMTYgfCA4NSk7Ci0JCUk5MTVfV1JJVEUoR0VOMTBfTUVESUFf
V0FLRV9SQVRFX0xJTUlULCAxNTApOwotCX0gZWxzZSBpZiAoSVNfU0tZTEFLRShkZXZfcHJpdikp
IHsKLQkJLyoKLQkJICogV2FSc0RvdWJsZVJjNldybFdpdGhDb2Fyc2VQb3dlckdhdGluZzpza2wg
RG91YmxpbmcgV1JMIG9ubHkKLQkJICogd2hlbiBDUEcgaXMgZW5hYmxlZAotCQkgKi8KLQkJSTkx
NV9XUklURShHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDEwOCA8PCAxNik7Ci0JfSBlbHNlIHsK
LQkJSTkxNV9XUklURShHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDU0IDw8IDE2KTsKLQl9Ci0K
LQlJOTE1X1dSSVRFKEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsgLyogMTI1
MDAgKiAxMjgwbnMgKi8KLQlJOTE1X1dSSVRFKEdFTjZfUkNfSURMRV9IWVNURVJTSVMsIDI1KTsg
LyogMjUgKiAxMjgwbnMgKi8KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQp
Ci0JCUk5MTVfV1JJVEUoUklOR19NQVhfSURMRShlbmdpbmUtPm1taW9fYmFzZSksIDEwKTsKLQot
CWlmIChIQVNfR1VDKGRldl9wcml2KSkKLQkJSTkxNV9XUklURShHVUNfTUFYX0lETEVfQ09VTlQs
IDB4QSk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUkNfU0xFRVAsIDApOwotCi0JLyoKLQkgKiAyYzog
UHJvZ3JhbSBDb2Fyc2UgUG93ZXIgR2F0aW5nIFBvbGljaWVzLgotCSAqCi0JICogQnNwZWMncyBn
dWlkYW5jZSBpcyB0byB1c2UgMjV1cyAocmVhbGx5IDI1ICogMTI4MG5zKSBoZXJlLiBXaGF0IHdl
Ci0JICogdXNlIGluc3RlYWQgaXMgYSBtb3JlIGNvbnNlcnZhdGl2ZSBlc3RpbWF0ZSBmb3IgdGhl
IG1heGltdW0gdGltZQotCSAqIGl0IHRha2VzIHVzIHRvIHNlcnZpY2UgYSBDUyBpbnRlcnJ1cHQg
YW5kIHN1Ym1pdCBhIG5ldyBFTFNQIC0gdGhhdAotCSAqIGlzIHRoZSB0aW1lIHdoaWNoIHRoZSBH
UFUgaXMgaWRsZSB3YWl0aW5nIGZvciB0aGUgQ1BVIHRvIHNlbGVjdCB0aGUKLQkgKiBuZXh0IHJl
cXVlc3QgdG8gZXhlY3V0ZS4gSWYgdGhlIGlkbGUgaHlzdGVyZXNpcyBpcyBsZXNzIHRoYW4gdGhh
dAotCSAqIGludGVycnVwdCBzZXJ2aWNlIGxhdGVuY3ksIHRoZSBoYXJkd2FyZSB3aWxsIGF1dG9t
YXRpY2FsbHkgZ2F0ZQotCSAqIHRoZSBwb3dlciB3ZWxsIGFuZCB3ZSB3aWxsIHRoZW4gaW5jdXIg
dGhlIHdha2UgdXAgY29zdCBvbiB0b3Agb2YKLQkgKiB0aGUgc2VydmljZSBsYXRlbmN5LiBBIHNp
bWlsYXIgZ3VpZGUgZnJvbSBwbGFuZV9zdGF0ZSBpcyB0aGF0IHdlCi0JICogZG8gbm90IHdhbnQg
dGhlIGVuYWJsZSBoeXN0ZXJlc2lzIHRvIGxlc3MgdGhhbiB0aGUgd2FrZXVwIGxhdGVuY3kuCi0J
ICoKLQkgKiBpZ3QvZ2VtX2V4ZWNfbm9wL3NlcXVlbnRpYWwgcHJvdmlkZXMgYSByb3VnaCBlc3Rp
bWF0ZSBmb3IgdGhlCi0JICogc2VydmljZSBsYXRlbmN5LCBhbmQgcHV0cyBpdCBhcm91bmQgMTB1
cyBmb3IgQnJvYWR3ZWxsIChhbmQgb3RoZXIKLQkgKiBiaWcgY29yZSkgYW5kIGFyb3VuZCA0MHVz
IGZvciBCcm94dG9uIChhbmQgb3RoZXIgbG93IHBvd2VyIGNvcmVzKS4KLQkgKiBbTm90ZSB0aGF0
IGZvciBsZWdhY3kgcmluZ2J1ZmZlciBzdWJtaXNzaW9uLCB0aGlzIGlzIGxlc3MgdGhhbiAxdXMh
XQotCSAqIEhvd2V2ZXIsIHRoZSB3YWtldXAgbGF0ZW5jeSBvbiBCcm94dG9uIGlzIGNsb3NlciB0
byAxMDB1cy4gVG8gYmUKLQkgKiBjb25zZXJ2YXRpdmUsIHdlIGhhdmUgdG8gZmFjdG9yIGluIGEg
Y29udGV4dCBzd2l0Y2ggb24gdG9wIChkdWUKLQkgKiB0byBrc29mdGlycWQpLgotCSAqLwotCUk5
MTVfV1JJVEUoR0VOOV9NRURJQV9QR19JRExFX0hZU1RFUkVTSVMsIDI1MCk7Ci0JSTkxNV9XUklU
RShHRU45X1JFTkRFUl9QR19JRExFX0hZU1RFUkVTSVMsIDI1MCk7Ci0KLQkvKiAzYTogRW5hYmxl
IFJDNiAqLwotCUk5MTVfV1JJVEUoR0VONl9SQzZfVEhSRVNIT0xELCAzNzUwMCk7IC8qIDM3LjUv
MTI1bXMgcGVyIEVJICovCi0KLQkvKiBXYVJzVXNlVGltZW91dE1vZGU6Y25sIChwcmUtcHJvZCkg
Ki8KLQlpZiAoSVNfQ05MX1JFVklEKGRldl9wcml2LCBDTkxfUkVWSURfQTAsIENOTF9SRVZJRF9D
MCkpCi0JCXJjNl9tb2RlID0gR0VON19SQ19DVExfVE9fTU9ERTsKLQllbHNlCi0JCXJjNl9tb2Rl
ID0gR0VONl9SQ19DVExfRUlfTU9ERSgxKTsKLQotCUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9M
LAotCQkgICBHRU42X1JDX0NUTF9IV19FTkFCTEUgfAotCQkgICBHRU42X1JDX0NUTF9SQzZfRU5B
QkxFIHwKLQkJICAgcmM2X21vZGUpOwotCi0JLyoKLQkgKiAzYjogRW5hYmxlIENvYXJzZSBQb3dl
ciBHYXRpbmcgb25seSB3aGVuIFJDNiBpcyBlbmFibGVkLgotCSAqIFdhUnNEaXNhYmxlQ29hcnNl
UG93ZXJHYXRpbmc6c2tsLGNubCAtIFJlbmRlci9NZWRpYSBQRyBuZWVkIHRvIGJlIGRpc2FibGVk
IHdpdGggUkM2LgotCSAqLwotCWlmIChORUVEU19XYVJzRGlzYWJsZUNvYXJzZVBvd2VyR2F0aW5n
KGRldl9wcml2KSkKLQkJSTkxNV9XUklURShHRU45X1BHX0VOQUJMRSwgMCk7Ci0JZWxzZQotCQlJ
OTE1X1dSSVRFKEdFTjlfUEdfRU5BQkxFLAotCQkJICAgR0VOOV9SRU5ERVJfUEdfRU5BQkxFIHwg
R0VOOV9NRURJQV9QR19FTkFCTEUpOwotCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRl
dl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCi1zdGF0aWMgdm9pZCBnZW44X2Vu
YWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKLQotCS8q
IDFhOiBTb2Z0d2FyZSBSQyBzdGF0ZSAtIFJDMCAqLwotCUk5MTVfV1JJVEUoR0VONl9SQ19TVEFU
RSwgMCk7Ci0KLQkvKiAxYjogR2V0IGZvcmNld2FrZSBkdXJpbmcgcHJvZ3JhbSBzZXF1ZW5jZS4g
QWx0aG91Z2ggdGhlIGRyaXZlcgotCSAqIGhhc24ndCBlbmFibGVkIGEgc3RhdGUgeWV0IHdoZXJl
IHdlIG5lZWQgZm9yY2V3YWtlLCBCSU9TIG1heSBoYXZlLiovCi0JaW50ZWxfdW5jb3JlX2ZvcmNl
d2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCi0JLyogMmE6IERp
c2FibGUgUkMgc3RhdGVzLiAqLwotCUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLCAwKTsKLQot
CS8qIDJiOiBQcm9ncmFtIFJDNiB0aHJlc2hvbGRzLiovCi0JSTkxNV9XUklURShHRU42X1JDNl9X
QUtFX1JBVEVfTElNSVQsIDQwIDw8IDE2KTsKLQlJOTE1X1dSSVRFKEdFTjZfUkNfRVZBTFVBVElP
Tl9JTlRFUlZBTCwgMTI1MDAwKTsgLyogMTI1MDAgKiAxMjgwbnMgKi8KLQlJOTE1X1dSSVRFKEdF
TjZfUkNfSURMRV9IWVNURVJTSVMsIDI1KTsgLyogMjUgKiAxMjgwbnMgKi8KLQlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCi0JCUk5MTVfV1JJVEUoUklOR19NQVhfSURMRShl
bmdpbmUtPm1taW9fYmFzZSksIDEwKTsKLQlJOTE1X1dSSVRFKEdFTjZfUkNfU0xFRVAsIDApOwot
CUk5MTVfV1JJVEUoR0VONl9SQzZfVEhSRVNIT0xELCA2MjUpOyAvKiA4MDB1cy8xLjI4IGZvciBU
TyAqLwotCi0JLyogMzogRW5hYmxlIFJDNiAqLwotCi0JSTkxNV9XUklURShHRU42X1JDX0NPTlRS
T0wsCi0JCSAgIEdFTjZfUkNfQ1RMX0hXX0VOQUJMRSB8Ci0JCSAgIEdFTjdfUkNfQ1RMX1RPX01P
REUgfAotCQkgICBHRU42X1JDX0NUTF9SQzZfRU5BQkxFKTsKLQotCWludGVsX3VuY29yZV9mb3Jj
ZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLX0KLQotc3RhdGlj
IHZvaWQgZ2VuOF9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
LXsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKLQotCWlu
dGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxM
KTsKLQotCS8qIDEgUHJvZ3JhbSBkZWZhdWx0cyBhbmQgdGhyZXNob2xkcyBmb3IgUlBTKi8KLQlJ
OTE1X1dSSVRFKEdFTjZfUlBOU1dSRVEsCi0JCSAgIEhTV19GUkVRVUVOQ1kocnBzLT5ycDFfZnJl
cSkpOwotCUk5MTVfV1JJVEUoR0VONl9SQ19WSURFT19GUkVRLAotCQkgICBIU1dfRlJFUVVFTkNZ
KHJwcy0+cnAxX2ZyZXEpKTsKLQkvKiBOQjogRG9jcyBzYXkgMXMsIGFuZCAxMDAwMDAwIC0gd2hp
Y2ggYXJlbid0IGVxdWl2YWxlbnQgKi8KLQlJOTE1X1dSSVRFKEdFTjZfUlBfRE9XTl9USU1FT1VU
LCAxMDAwMDAwMDAgLyAxMjgpOyAvKiAxIHNlY29uZCB0aW1lb3V0ICovCi0KLQkvKiBEb2NzIHJl
Y29tbWVuZCA5MDBNSHosIGFuZCAzMDAgTUh6IHJlc3BlY3RpdmVseSAqLwotCUk5MTVfV1JJVEUo
R0VONl9SUF9JTlRFUlJVUFRfTElNSVRTLAotCQkgICBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCA8
PCAyNCB8Ci0JCSAgIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0IDw8IDE2KTsKLQotCUk5MTVfV1JJ
VEUoR0VONl9SUF9VUF9USFJFU0hPTEQsIDc2MDAwMDAgLyAxMjgpOyAvKiA3Nm1zIGJ1c3luZXNz
IHBlciBFSSwgOTAlICovCi0JSTkxNV9XUklURShHRU42X1JQX0RPV05fVEhSRVNIT0xELCAzMTMw
MDAwMCAvIDEyOCk7IC8qIDMxM21zIGJ1c3luZXNzIHBlciBFSSwgNzAlKi8KLQlJOTE1X1dSSVRF
KEdFTjZfUlBfVVBfRUksIDY2MDAwKTsgLyogODQuNDhtcywgWFhYOiByYW5kb20/ICovCi0JSTkx
NV9XUklURShHRU42X1JQX0RPV05fRUksIDM1MDAwMCk7IC8qIDQ0OG1zLCBYWFg6IHJhbmRvbT8g
Ki8KLQotCUk5MTVfV1JJVEUoR0VONl9SUF9JRExFX0hZU1RFUlNJUywgMTApOwotCi0JLyogMjog
RW5hYmxlIFJQUyAqLwotCUk5MTVfV1JJVEUoR0VONl9SUF9DT05UUk9MLAotCQkgICBHRU42X1JQ
X01FRElBX1RVUkJPIHwKLQkJICAgR0VONl9SUF9NRURJQV9IV19OT1JNQUxfTU9ERSB8Ci0JCSAg
IEdFTjZfUlBfTUVESUFfSVNfR0ZYIHwKLQkJICAgR0VONl9SUF9FTkFCTEUgfAotCQkgICBHRU42
X1JQX1VQX0JVU1lfQVZHIHwKLQkJICAgR0VONl9SUF9ET1dOX0lETEVfQVZHKTsKLQotCXJlc2V0
X3JwcyhkZXZfcHJpdiwgZ2VuNl9zZXRfcnBzKTsKLQotCWludGVsX3VuY29yZV9mb3JjZXdha2Vf
cHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLX0KLQotc3RhdGljIHZvaWQg
Z2VuNl9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7
Ci0JdTMyIHJjNnZpZHMsIHJjNl9tYXNrOwotCXUzMiBndGZpZm9kYmc7Ci0JaW50IHJldDsKLQot
CUk5MTVfV1JJVEUoR0VONl9SQ19TVEFURSwgMCk7Ci0KLQkvKiBDbGVhciB0aGUgREJHIG5vdyBz
byB3ZSBkb24ndCBjb25mdXNlIGVhcmxpZXIgZXJyb3JzICovCi0JZ3RmaWZvZGJnID0gSTkxNV9S
RUFEKEdURklGT0RCRyk7Ci0JaWYgKGd0Zmlmb2RiZykgewotCQlEUk1fRVJST1IoIkdUIGZpZm8g
aGFkIGEgcHJldmlvdXMgZXJyb3IgJXhcbiIsIGd0Zmlmb2RiZyk7Ci0JCUk5MTVfV1JJVEUoR1RG
SUZPREJHLCBndGZpZm9kYmcpOwotCX0KLQotCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZk
ZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLQotCS8qIGRpc2FibGUgdGhlIGNvdW50
ZXJzIGFuZCBzZXQgZGV0ZXJtaW5pc3RpYyB0aHJlc2hvbGRzICovCi0JSTkxNV9XUklURShHRU42
X1JDX0NPTlRST0wsIDApOwotCi0JSTkxNV9XUklURShHRU42X1JDMV9XQUtFX1JBVEVfTElNSVQs
IDEwMDAgPDwgMTYpOwotCUk5MTVfV1JJVEUoR0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCA0MCA8
PCAxNiB8IDMwKTsKLQlJOTE1X1dSSVRFKEdFTjZfUkM2cHBfV0FLRV9SQVRFX0xJTUlULCAzMCk7
Ci0JSTkxNV9XUklURShHRU42X1JDX0VWQUxVQVRJT05fSU5URVJWQUwsIDEyNTAwMCk7Ci0JSTkx
NV9XUklURShHRU42X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7Ci0KLQlmb3JfZWFjaF9lbmdpbmUo
ZW5naW5lLCBkZXZfcHJpdiwgaWQpCi0JCUk5MTVfV1JJVEUoUklOR19NQVhfSURMRShlbmdpbmUt
Pm1taW9fYmFzZSksIDEwKTsKLQotCUk5MTVfV1JJVEUoR0VONl9SQ19TTEVFUCwgMCk7Ci0JSTkx
NV9XUklURShHRU42X1JDMWVfVEhSRVNIT0xELCAxMDAwKTsKLQlpZiAoSVNfSVZZQlJJREdFKGRl
dl9wcml2KSkKLQkJSTkxNV9XUklURShHRU42X1JDNl9USFJFU0hPTEQsIDEyNTAwMCk7Ci0JZWxz
ZQotCQlJOTE1X1dSSVRFKEdFTjZfUkM2X1RIUkVTSE9MRCwgNTAwMDApOwotCUk5MTVfV1JJVEUo
R0VONl9SQzZwX1RIUkVTSE9MRCwgMTUwMDAwKTsKLQlJOTE1X1dSSVRFKEdFTjZfUkM2cHBfVEhS
RVNIT0xELCA2NDAwMCk7IC8qIHVudXNlZCAqLwotCi0JLyogV2UgZG9uJ3QgdXNlIHRob3NlIG9u
IEhhc3dlbGwgKi8KLQlyYzZfbWFzayA9IEdFTjZfUkNfQ1RMX1JDNl9FTkFCTEU7Ci0JaWYgKEhB
U19SQzZwKGRldl9wcml2KSkKLQkJcmM2X21hc2sgfD0gR0VONl9SQ19DVExfUkM2cF9FTkFCTEU7
Ci0JaWYgKEhBU19SQzZwcChkZXZfcHJpdikpCi0JCXJjNl9tYXNrIHw9IEdFTjZfUkNfQ1RMX1JD
NnBwX0VOQUJMRTsKLQlJOTE1X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwKLQkJICAgcmM2X21hc2sg
fAotCQkgICBHRU42X1JDX0NUTF9FSV9NT0RFKDEpIHwKLQkJICAgR0VONl9SQ19DVExfSFdfRU5B
QkxFKTsKLQotCXJjNnZpZHMgPSAwOwotCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoZGV2
X3ByaXYsIEdFTjZfUENPREVfUkVBRF9SQzZWSURTLAotCQkJCSAgICAgJnJjNnZpZHMsIE5VTEwp
OwotCWlmIChJU19HRU4oZGV2X3ByaXYsIDYpICYmIHJldCkgewotCQlEUk1fREVCVUdfRFJJVkVS
KCJDb3VsZG4ndCBjaGVjayBmb3IgQklPUyB3b3JrYXJvdW5kXG4iKTsKLQl9IGVsc2UgaWYgKElT
X0dFTihkZXZfcHJpdiwgNikgJiYgKEdFTjZfREVDT0RFX1JDNl9WSUQocmM2dmlkcyAmIDB4ZmYp
IDwgNDUwKSkgewotCQlEUk1fREVCVUdfRFJJVkVSKCJZb3Ugc2hvdWxkIHVwZGF0ZSB5b3VyIEJJ
T1MuIENvcnJlY3RpbmcgbWluaW11bSByYzYgdm9sdGFnZSAoJWRtVi0+JWRtVilcbiIsCi0JCQkg
IEdFTjZfREVDT0RFX1JDNl9WSUQocmM2dmlkcyAmIDB4ZmYpLCA0NTApOwotCQlyYzZ2aWRzICY9
IDB4ZmZmZjAwOwotCQlyYzZ2aWRzIHw9IEdFTjZfRU5DT0RFX1JDNl9WSUQoNDUwKTsKLQkJcmV0
ID0gc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUoZGV2X3ByaXYsIEdFTjZfUENPREVfV1JJVEVfUkM2
VklEUywgcmM2dmlkcyk7Ci0JCWlmIChyZXQpCi0JCQlEUk1fRVJST1IoIkNvdWxkbid0IGZpeCBp
bmNvcnJlY3QgcmM2IHZvbHRhZ2VcbiIpOwotCX0KLQotCWludGVsX3VuY29yZV9mb3JjZXdha2Vf
cHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLX0KLQotc3RhdGljIHZvaWQg
Z2VuNl9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQkv
KiBIZXJlIGJlZ2lucyBhIG1hZ2ljIHNlcXVlbmNlIG9mIHJlZ2lzdGVyIHdyaXRlcyB0byBlbmFi
bGUKLQkgKiBhdXRvLWRvd25jbG9ja2luZy4KLQkgKgotCSAqIFBlcmhhcHMgdGhlcmUgbWlnaHQg
YmUgc29tZSB2YWx1ZSBpbiBleHBvc2luZyB0aGVzZSB0bwotCSAqIHVzZXJzcGFjZS4uLgotCSAq
LwotCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdB
S0VfQUxMKTsKLQotCS8qIFBvd2VyIGRvd24gaWYgY29tcGxldGVseSBpZGxlIGZvciBvdmVyIDUw
bXMgKi8KLQlJOTE1X1dSSVRFKEdFTjZfUlBfRE9XTl9USU1FT1VULCA1MDAwMCk7Ci0JSTkxNV9X
UklURShHRU42X1JQX0lETEVfSFlTVEVSU0lTLCAxMCk7Ci0KLQlyZXNldF9ycHMoZGV2X3ByaXYs
IGdlbjZfc2V0X3Jwcyk7Ci0KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYt
PnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci19Ci0KLXN0YXRpYyB2b2lkIGdlbjZfdXBkYXRlX3Jp
bmdfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGlu
dGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0JY29uc3QgaW50IG1pbl9mcmVx
ID0gMTU7Ci0JY29uc3QgaW50IHNjYWxpbmdfZmFjdG9yID0gMTgwOwotCXVuc2lnbmVkIGludCBn
cHVfZnJlcTsKLQl1bnNpZ25lZCBpbnQgbWF4X2lhX2ZyZXEsIG1pbl9yaW5nX2ZyZXE7Ci0JdW5z
aWduZWQgaW50IG1heF9ncHVfZnJlcSwgbWluX2dwdV9mcmVxOwotCXN0cnVjdCBjcHVmcmVxX3Bv
bGljeSAqcG9saWN5OwotCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmcnBzLT5sb2NrKTsKLQotCWlm
IChycHMtPm1heF9mcmVxIDw9IHJwcy0+bWluX2ZyZXEpCi0JCXJldHVybjsKLQotCXBvbGljeSA9
IGNwdWZyZXFfY3B1X2dldCgwKTsKLQlpZiAocG9saWN5KSB7Ci0JCW1heF9pYV9mcmVxID0gcG9s
aWN5LT5jcHVpbmZvLm1heF9mcmVxOwotCQljcHVmcmVxX2NwdV9wdXQocG9saWN5KTsKLQl9IGVs
c2UgewotCQkvKgotCQkgKiBEZWZhdWx0IHRvIG1lYXN1cmVkIGZyZXEgaWYgbm9uZSBmb3VuZCwg
UENVIHdpbGwgZW5zdXJlIHdlCi0JCSAqIGRvbid0IGdvIG92ZXIKLQkJICovCi0JCW1heF9pYV9m
cmVxID0gdHNjX2toejsKLQl9Ci0KLQkvKiBDb252ZXJ0IGZyb20ga0h6IHRvIE1IeiAqLwotCW1h
eF9pYV9mcmVxIC89IDEwMDA7Ci0KLQltaW5fcmluZ19mcmVxID0gSTkxNV9SRUFEKERDTEspICYg
MHhmOwotCS8qIGNvbnZlcnQgRERSIGZyZXF1ZW5jeSBmcm9tIHVuaXRzIG9mIDI2Ni42TUh6IHRv
IGJhbmR3aWR0aCAqLwotCW1pbl9yaW5nX2ZyZXEgPSBtdWx0X2ZyYWMobWluX3JpbmdfZnJlcSwg
OCwgMyk7Ci0KLQltaW5fZ3B1X2ZyZXEgPSBycHMtPm1pbl9mcmVxOwotCW1heF9ncHVfZnJlcSA9
IHJwcy0+bWF4X2ZyZXE7Ci0JaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8IElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gMTApIHsKLQkJLyogQ29udmVydCBHVCBmcmVxdWVuY3kgdG8gNTAgSFogdW5p
dHMgKi8KLQkJbWluX2dwdV9mcmVxIC89IEdFTjlfRlJFUV9TQ0FMRVI7Ci0JCW1heF9ncHVfZnJl
cSAvPSBHRU45X0ZSRVFfU0NBTEVSOwotCX0KLQotCS8qCi0JICogRm9yIGVhY2ggcG90ZW50aWFs
IEdQVSBmcmVxdWVuY3ksIGxvYWQgYSByaW5nIGZyZXF1ZW5jeSB3ZSdkIGxpa2UKLQkgKiB0byB1
c2UgZm9yIG1lbW9yeSBhY2Nlc3MuICBXZSBkbyB0aGlzIGJ5IHNwZWNpZnlpbmcgdGhlIElBIGZy
ZXF1ZW5jeQotCSAqIHRoZSBQQ1Ugc2hvdWxkIHVzZSBhcyBhIHJlZmVyZW5jZSB0byBkZXRlcm1p
bmUgdGhlIHJpbmcgZnJlcXVlbmN5LgotCSAqLwotCWZvciAoZ3B1X2ZyZXEgPSBtYXhfZ3B1X2Zy
ZXE7IGdwdV9mcmVxID49IG1pbl9ncHVfZnJlcTsgZ3B1X2ZyZXEtLSkgewotCQljb25zdCBpbnQg
ZGlmZiA9IG1heF9ncHVfZnJlcSAtIGdwdV9mcmVxOwotCQl1bnNpZ25lZCBpbnQgaWFfZnJlcSA9
IDAsIHJpbmdfZnJlcSA9IDA7Ci0KLQkJaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpIHx8IElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTApIHsKLQkJCS8qCi0JCQkgKiByaW5nX2ZyZXEgPSAyICogR1Qu
IHJpbmdfZnJlcSBpcyBpbiAxMDBNSHogdW5pdHMKLQkJCSAqIE5vIGZsb29yIHJlcXVpcmVkIGZv
ciByaW5nIGZyZXF1ZW5jeSBvbiBTS0wuCi0JCQkgKi8KLQkJCXJpbmdfZnJlcSA9IGdwdV9mcmVx
OwotCQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkgewotCQkJLyogbWF4KDIg
KiBHVCwgRERSKS4gTkI6IEdUIGlzIDUwTUh6IHVuaXRzICovCi0JCQlyaW5nX2ZyZXEgPSBtYXgo
bWluX3JpbmdfZnJlcSwgZ3B1X2ZyZXEpOwotCQl9IGVsc2UgaWYgKElTX0hBU1dFTEwoZGV2X3By
aXYpKSB7Ci0JCQlyaW5nX2ZyZXEgPSBtdWx0X2ZyYWMoZ3B1X2ZyZXEsIDUsIDQpOwotCQkJcmlu
Z19mcmVxID0gbWF4KG1pbl9yaW5nX2ZyZXEsIHJpbmdfZnJlcSk7Ci0JCQkvKiBsZWF2ZSBpYV9m
cmVxIGFzIHRoZSBkZWZhdWx0LCBjaG9zZW4gYnkgY3B1ZnJlcSAqLwotCQl9IGVsc2UgewotCQkJ
LyogT24gb2xkZXIgcHJvY2Vzc29ycywgdGhlcmUgaXMgbm8gc2VwYXJhdGUgcmluZwotCQkJICog
Y2xvY2sgZG9tYWluLCBzbyBpbiBvcmRlciB0byBib29zdCB0aGUgYmFuZHdpZHRoCi0JCQkgKiBv
ZiB0aGUgcmluZywgd2UgbmVlZCB0byB1cGNsb2NrIHRoZSBDUFUgKGlhX2ZyZXEpLgotCQkJICoK
LQkJCSAqIEZvciBHUFUgZnJlcXVlbmNpZXMgbGVzcyB0aGFuIDc1ME1IeiwKLQkJCSAqIGp1c3Qg
dXNlIHRoZSBsb3dlc3QgcmluZyBmcmVxLgotCQkJICovCi0JCQlpZiAoZ3B1X2ZyZXEgPCBtaW5f
ZnJlcSkKLQkJCQlpYV9mcmVxID0gODAwOwotCQkJZWxzZQotCQkJCWlhX2ZyZXEgPSBtYXhfaWFf
ZnJlcSAtICgoZGlmZiAqIHNjYWxpbmdfZmFjdG9yKSAvIDIpOwotCQkJaWFfZnJlcSA9IERJVl9S
T1VORF9DTE9TRVNUKGlhX2ZyZXEsIDEwMCk7Ci0JCX0KLQotCQlzYW5keWJyaWRnZV9wY29kZV93
cml0ZShkZXZfcHJpdiwKLQkJCQkJR0VONl9QQ09ERV9XUklURV9NSU5fRlJFUV9UQUJMRSwKLQkJ
CQkJaWFfZnJlcSA8PCBHRU42X1BDT0RFX0ZSRVFfSUFfUkFUSU9fU0hJRlQgfAotCQkJCQlyaW5n
X2ZyZXEgPDwgR0VONl9QQ09ERV9GUkVRX1JJTkdfUkFUSU9fU0hJRlQgfAotCQkJCQlncHVfZnJl
cSk7Ci0JfQotfQotCi1zdGF0aWMgaW50IGNoZXJyeXZpZXdfcnBzX21heF9mcmVxKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQl1MzIgdmFsLCBycDA7Ci0KLQl2YWwgPSB2
bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgRkJfR0ZYX0ZNQVhfQVRfVk1BWF9GVVNFKTsKLQotCXN3
aXRjaCAoUlVOVElNRV9JTkZPKGRldl9wcml2KS0+c3NldS5ldV90b3RhbCkgewotCWNhc2UgODoK
LQkJLyogKDIgKiA0KSBjb25maWcgKi8KLQkJcnAwID0gKHZhbCA+PiBGQl9HRlhfRk1BWF9BVF9W
TUFYXzJTUzRFVV9GVVNFX1NISUZUKTsKLQkJYnJlYWs7Ci0JY2FzZSAxMjoKLQkJLyogKDIgKiA2
KSBjb25maWcgKi8KLQkJcnAwID0gKHZhbCA+PiBGQl9HRlhfRk1BWF9BVF9WTUFYXzJTUzZFVV9G
VVNFX1NISUZUKTsKLQkJYnJlYWs7Ci0JY2FzZSAxNjoKLQkJLyogKDIgKiA4KSBjb25maWcgKi8K
LQlkZWZhdWx0OgotCQkvKiBTZXR0aW5nICgyICogOCkgTWluIFJQMCBmb3IgYW55IG90aGVyIGNv
bWJpbmF0aW9uICovCi0JCXJwMCA9ICh2YWwgPj4gRkJfR0ZYX0ZNQVhfQVRfVk1BWF8yU1M4RVVf
RlVTRV9TSElGVCk7Ci0JCWJyZWFrOwotCX0KLQotCXJwMCA9IChycDAgJiBGQl9HRlhfRlJFUV9G
VVNFX01BU0spOwotCi0JcmV0dXJuIHJwMDsKLX0KLQotc3RhdGljIGludCBjaGVycnl2aWV3X3Jw
c19ycGVfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTMyIHZh
bCwgcnBlOwotCi0JdmFsID0gdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX0dQVV9EVVRZ
Q1lDTEVfUkVHKTsKLQlycGUgPSAodmFsID4+IFBVTklUX0dQVV9EVVRZQ1lDTEVfUlBFX0ZSRVFf
U0hJRlQpICYgUFVOSVRfR1BVX0RVVFlDWUNMRV9SUEVfRlJFUV9NQVNLOwotCi0JcmV0dXJuIHJw
ZTsKLX0KLQotc3RhdGljIGludCBjaGVycnl2aWV3X3Jwc19ndWFyX2ZyZXEoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXUzMiB2YWwsIHJwMTsKLQotCXZhbCA9IHZsdl9w
dW5pdF9yZWFkKGRldl9wcml2LCBGQl9HRlhfRk1BWF9BVF9WTUFYX0ZVU0UpOwotCXJwMSA9ICh2
YWwgJiBGQl9HRlhfRlJFUV9GVVNFX01BU0spOwotCi0JcmV0dXJuIHJwMTsKLX0KLQotc3RhdGlj
IHUzMiBjaGVycnl2aWV3X3Jwc19taW5fZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCi17Ci0JdTMyIHZhbCwgcnBuOwotCi0JdmFsID0gdmx2X3B1bml0X3JlYWQoZGV2X3By
aXYsIEZCX0dGWF9GTUlOX0FUX1ZNSU5fRlVTRSk7Ci0JcnBuID0gKCh2YWwgPj4gRkJfR0ZYX0ZN
SU5fQVRfVk1JTl9GVVNFX1NISUZUKSAmCi0JCSAgICAgICBGQl9HRlhfRlJFUV9GVVNFX01BU0sp
OwotCi0JcmV0dXJuIHJwbjsKLX0KLQotc3RhdGljIGludCB2YWxsZXl2aWV3X3Jwc19ndWFyX2Zy
ZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXUzMiB2YWwsIHJwMTsK
LQotCXZhbCA9IHZsdl9uY19yZWFkKGRldl9wcml2LCBJT1NGX05DX0ZCX0dGWF9GUkVRX0ZVU0Up
OwotCi0JcnAxID0gKHZhbCAmIEZCX0dGWF9GR1VBUkFOVEVFRF9GUkVRX0ZVU0VfTUFTSykgPj4g
RkJfR0ZYX0ZHVUFSQU5URUVEX0ZSRVFfRlVTRV9TSElGVDsKLQotCXJldHVybiBycDE7Ci19Ci0K
LXN0YXRpYyBpbnQgdmFsbGV5dmlld19ycHNfbWF4X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQotewotCXUzMiB2YWwsIHJwMDsKLQotCXZhbCA9IHZsdl9uY19yZWFkKGRl
dl9wcml2LCBJT1NGX05DX0ZCX0dGWF9GUkVRX0ZVU0UpOwotCi0JcnAwID0gKHZhbCAmIEZCX0dG
WF9NQVhfRlJFUV9GVVNFX01BU0spID4+IEZCX0dGWF9NQVhfRlJFUV9GVVNFX1NISUZUOwotCS8q
IENsYW1wIHRvIG1heCAqLwotCXJwMCA9IG1pbl90KHUzMiwgcnAwLCAweGVhKTsKLQotCXJldHVy
biBycDA7Ci19Ci0KLXN0YXRpYyBpbnQgdmFsbGV5dmlld19ycHNfcnBlX2ZyZXEoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXUzMiB2YWwsIHJwZTsKLQotCXZhbCA9IHZs
dl9uY19yZWFkKGRldl9wcml2LCBJT1NGX05DX0ZCX0dGWF9GTUFYX0ZVU0VfTE8pOwotCXJwZSA9
ICh2YWwgJiBGQl9GTUFYX1ZNSU5fRlJFUV9MT19NQVNLKSA+PiBGQl9GTUFYX1ZNSU5fRlJFUV9M
T19TSElGVDsKLQl2YWwgPSB2bHZfbmNfcmVhZChkZXZfcHJpdiwgSU9TRl9OQ19GQl9HRlhfRk1B
WF9GVVNFX0hJKTsKLQlycGUgfD0gKHZhbCAmIEZCX0ZNQVhfVk1JTl9GUkVRX0hJX01BU0spIDw8
IDU7Ci0KLQlyZXR1cm4gcnBlOwotfQotCi1zdGF0aWMgaW50IHZhbGxleXZpZXdfcnBzX21pbl9m
cmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQl1MzIgdmFsOwotCi0J
dmFsID0gdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19HUFVfTEZNKSAmIDB4ZmY7
Ci0JLyoKLQkgKiBBY2NvcmRpbmcgdG8gdGhlIEJZVCBQdW5pdCBHUFUgdHVyYm8gSEFTIDEuMS42
LjMgdGhlIG1pbmltdW0gdmFsdWUKLQkgKiBmb3IgdGhlIG1pbmltdW0gZnJlcXVlbmN5IGluIEdQ
TEwgbW9kZSBpcyAweGMxLiBDb250cmFyeSB0byB0aGlzIG9uCi0JICogYSBCWVQtTSBCMCB0aGUg
YWJvdmUgcmVnaXN0ZXIgY29udGFpbnMgMHhiZi4gTW9yZW92ZXIgd2hlbiBzZXR0aW5nCi0JICog
YSBmcmVxdWVuY3kgUHVuaXQgd2lsbCBub3QgYWxsb3cgdmFsdWVzIGJlbG93IDB4YzAuIENsYW1w
IGl0IDB4YzAKLQkgKiB0byBtYWtlIHN1cmUgaXQgbWF0Y2hlcyB3aGF0IFB1bml0IGFjY2VwdHMu
Ci0JICovCi0JcmV0dXJuIG1heF90KHUzMiwgdmFsLCAweGMwKTsKLX0KLQotLyogQ2hlY2sgdGhh
dCB0aGUgcGN0eCBidWZmZXIgd2Fzbid0IG1vdmUgdW5kZXIgdXMuICovCi1zdGF0aWMgdm9pZCB2
YWxsZXl2aWV3X2NoZWNrX3BjdHgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQot
ewotCXVuc2lnbmVkIGxvbmcgcGN0eF9hZGRyID0gSTkxNV9SRUFEKFZMVl9QQ0JSKSAmIH40MDk1
OwotCi0JV0FSTl9PTihwY3R4X2FkZHIgIT0gZGV2X3ByaXYtPmRzbS5zdGFydCArCi0JCQkgICAg
IGRldl9wcml2LT52bHZfcGN0eC0+c3RvbGVuLT5zdGFydCk7Ci19Ci0KLQotLyogQ2hlY2sgdGhh
dCB0aGUgcGNiciBhZGRyZXNzIGlzIG5vdCBlbXB0eS4gKi8KLXN0YXRpYyB2b2lkIGNoZXJyeXZp
ZXdfY2hlY2tfcGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdW5z
aWduZWQgbG9uZyBwY3R4X2FkZHIgPSBJOTE1X1JFQUQoVkxWX1BDQlIpICYgfjQwOTU7Ci0KLQlX
QVJOX09OKChwY3R4X2FkZHIgPj4gVkxWX1BDQlJfQUREUl9TSElGVCkgPT0gMCk7Ci19Ci0KLXN0
YXRpYyB2b2lkIGNoZXJyeXZpZXdfc2V0dXBfcGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCi17Ci0JcmVzb3VyY2Vfc2l6ZV90IHBjdHhfcGFkZHIsIHBhZGRyOwotCXJlc291
cmNlX3NpemVfdCBwY3R4X3NpemUgPSAzMioxMDI0OwotCXUzMiBwY2JyOwotCi0JcGNiciA9IEk5
MTVfUkVBRChWTFZfUENCUik7Ci0JaWYgKChwY2JyID4+IFZMVl9QQ0JSX0FERFJfU0hJRlQpID09
IDApIHsKLQkJRFJNX0RFQlVHX0RSSVZFUigiQklPUyBkaWRuJ3Qgc2V0IHVwIFBDQlIsIGZpeGlu
ZyB1cFxuIik7Ci0JCXBhZGRyID0gZGV2X3ByaXYtPmRzbS5lbmQgKyAxIC0gcGN0eF9zaXplOwot
CQlHRU1fQlVHX09OKHBhZGRyID4gVTMyX01BWCk7Ci0KLQkJcGN0eF9wYWRkciA9IChwYWRkciAm
ICh+NDA5NSkpOwotCQlJOTE1X1dSSVRFKFZMVl9QQ0JSLCBwY3R4X3BhZGRyKTsKLQl9Ci0KLQlE
Uk1fREVCVUdfRFJJVkVSKCJQQ0JSOiAweCUwOHhcbiIsIEk5MTVfUkVBRChWTFZfUENCUikpOwot
fQotCi1zdGF0aWMgdm9pZCB2YWxsZXl2aWV3X3NldHVwX3BjdHgoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpwY3R4Owot
CXJlc291cmNlX3NpemVfdCBwY3R4X3BhZGRyOwotCXJlc291cmNlX3NpemVfdCBwY3R4X3NpemUg
PSAyNCoxMDI0OwotCXUzMiBwY2JyOwotCi0JcGNiciA9IEk5MTVfUkVBRChWTFZfUENCUik7Ci0J
aWYgKHBjYnIpIHsKLQkJLyogQklPUyBzZXQgaXQgdXAgYWxyZWFkeSwgZ3JhYiB0aGUgcHJlLWFs
bG9jJ2Qgc3BhY2UgKi8KLQkJcmVzb3VyY2Vfc2l6ZV90IHBjYnJfb2Zmc2V0OwotCi0JCXBjYnJf
b2Zmc2V0ID0gKHBjYnIgJiAofjQwOTUpKSAtIGRldl9wcml2LT5kc20uc3RhcnQ7Ci0JCXBjdHgg
PSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbl9mb3JfcHJlYWxsb2NhdGVkKGRldl9wcml2
LAotCQkJCQkJCQkgICAgICBwY2JyX29mZnNldCwKLQkJCQkJCQkJICAgICAgSTkxNV9HVFRfT0ZG
U0VUX05PTkUsCi0JCQkJCQkJCSAgICAgIHBjdHhfc2l6ZSk7Ci0JCWdvdG8gb3V0OwotCX0KLQot
CURSTV9ERUJVR19EUklWRVIoIkJJT1MgZGlkbid0IHNldCB1cCBQQ0JSLCBmaXhpbmcgdXBcbiIp
OwotCi0JLyoKLQkgKiBGcm9tIHRoZSBHdW5pdCByZWdpc3RlciBIQVM6Ci0JICogVGhlIEdmeCBk
cml2ZXIgaXMgZXhwZWN0ZWQgdG8gcHJvZ3JhbSB0aGlzIHJlZ2lzdGVyIGFuZCBlbnN1cmUKLQkg
KiBwcm9wZXIgYWxsb2NhdGlvbiB3aXRoaW4gR2Z4IHN0b2xlbiBtZW1vcnkuICBGb3IgZXhhbXBs
ZSwgdGhpcwotCSAqIHJlZ2lzdGVyIHNob3VsZCBiZSBwcm9ncmFtbWVkIHN1Y2ggdGhhbiB0aGUg
UENCUiByYW5nZSBkb2VzIG5vdAotCSAqIG92ZXJsYXAgd2l0aCBvdGhlciByYW5nZXMsIHN1Y2gg
YXMgdGhlIGZyYW1lIGJ1ZmZlciwgcHJvdGVjdGVkCi0JICogbWVtb3J5LCBvciBhbnkgb3RoZXIg
cmVsZXZhbnQgcmFuZ2VzLgotCSAqLwotCXBjdHggPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0
b2xlbihkZXZfcHJpdiwgcGN0eF9zaXplKTsKLQlpZiAoIXBjdHgpIHsKLQkJRFJNX0RFQlVHKCJu
b3QgZW5vdWdoIHN0b2xlbiBzcGFjZSBmb3IgUENUWCwgZGlzYWJsaW5nXG4iKTsKLQkJZ290byBv
dXQ7Ci0JfQotCi0JR0VNX0JVR19PTihyYW5nZV9vdmVyZmxvd3NfdCh1NjQsCi0JCQkJICAgICBk
ZXZfcHJpdi0+ZHNtLnN0YXJ0LAotCQkJCSAgICAgcGN0eC0+c3RvbGVuLT5zdGFydCwKLQkJCQkg
ICAgIFUzMl9NQVgpKTsKLQlwY3R4X3BhZGRyID0gZGV2X3ByaXYtPmRzbS5zdGFydCArIHBjdHgt
PnN0b2xlbi0+c3RhcnQ7Ci0JSTkxNV9XUklURShWTFZfUENCUiwgcGN0eF9wYWRkcik7Ci0KLW91
dDoKLQlEUk1fREVCVUdfRFJJVkVSKCJQQ0JSOiAweCUwOHhcbiIsIEk5MTVfUkVBRChWTFZfUENC
UikpOwotCWRldl9wcml2LT52bHZfcGN0eCA9IHBjdHg7Ci19Ci0KLXN0YXRpYyB2b2lkIHZhbGxl
eXZpZXdfY2xlYW51cF9wY3R4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsK
LQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqcGN0eDsKLQotCXBjdHggPSBmZXRjaF9hbmRf
emVybygmZGV2X3ByaXYtPnZsdl9wY3R4KTsKLQlpZiAocGN0eCkKLQkJaTkxNV9nZW1fb2JqZWN0
X3B1dChwY3R4KTsKLX0KLQotc3RhdGljIHZvaWQgdmx2X2luaXRfZ3BsbF9yZWZfZnJlcShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JZGV2X3ByaXYtPmd0X3BtLnJwcy5n
cGxsX3JlZl9mcmVxID0KLQkJdmx2X2dldF9jY2tfY2xvY2soZGV2X3ByaXYsICJHUExMIHJlZiIs
Ci0JCQkJICBDQ0tfR1BMTF9DTE9DS19DT05UUk9MLAotCQkJCSAgZGV2X3ByaXYtPmN6Y2xrX2Zy
ZXEpOwotCi0JRFJNX0RFQlVHX0RSSVZFUigiR1BMTCByZWZlcmVuY2UgZnJlcTogJWQga0h6XG4i
LAotCQkJIGRldl9wcml2LT5ndF9wbS5ycHMuZ3BsbF9yZWZfZnJlcSk7Ci19Ci0KLXN0YXRpYyB2
b2lkIHZhbGxleXZpZXdfaW5pdF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQotewotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0u
cnBzOwotCXUzMiB2YWw7Ci0KLQl2YWxsZXl2aWV3X3NldHVwX3BjdHgoZGV2X3ByaXYpOwotCi0J
dmx2X2lvc2Zfc2JfZ2V0KGRldl9wcml2LAotCQkJQklUKFZMVl9JT1NGX1NCX1BVTklUKSB8Ci0J
CQlCSVQoVkxWX0lPU0ZfU0JfTkMpIHwKLQkJCUJJVChWTFZfSU9TRl9TQl9DQ0spKTsKLQotCXZs
dl9pbml0X2dwbGxfcmVmX2ZyZXEoZGV2X3ByaXYpOwotCi0JdmFsID0gdmx2X3B1bml0X3JlYWQo
ZGV2X3ByaXYsIFBVTklUX1JFR19HUFVfRlJFUV9TVFMpOwotCXN3aXRjaCAoKHZhbCA+PiA2KSAm
IDMpIHsKLQljYXNlIDA6Ci0JY2FzZSAxOgotCQlkZXZfcHJpdi0+bWVtX2ZyZXEgPSA4MDA7Ci0J
CWJyZWFrOwotCWNhc2UgMjoKLQkJZGV2X3ByaXYtPm1lbV9mcmVxID0gMTA2NjsKLQkJYnJlYWs7
Ci0JY2FzZSAzOgotCQlkZXZfcHJpdi0+bWVtX2ZyZXEgPSAxMzMzOwotCQlicmVhazsKLQl9Ci0J
RFJNX0RFQlVHX0RSSVZFUigiRERSIHNwZWVkOiAlZCBNSHpcbiIsIGRldl9wcml2LT5tZW1fZnJl
cSk7Ci0KLQlycHMtPm1heF9mcmVxID0gdmFsbGV5dmlld19ycHNfbWF4X2ZyZXEoZGV2X3ByaXYp
OwotCXJwcy0+cnAwX2ZyZXEgPSBycHMtPm1heF9mcmVxOwotCURSTV9ERUJVR19EUklWRVIoIm1h
eCBHUFUgZnJlcTogJWQgTUh6ICgldSlcbiIsCi0JCQkgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYs
IHJwcy0+bWF4X2ZyZXEpLAotCQkJIHJwcy0+bWF4X2ZyZXEpOwotCi0JcnBzLT5lZmZpY2llbnRf
ZnJlcSA9IHZhbGxleXZpZXdfcnBzX3JwZV9mcmVxKGRldl9wcml2KTsKLQlEUk1fREVCVUdfRFJJ
VkVSKCJSUGUgR1BVIGZyZXE6ICVkIE1IeiAoJXUpXG4iLAotCQkJIGludGVsX2dwdV9mcmVxKGRl
dl9wcml2LCBycHMtPmVmZmljaWVudF9mcmVxKSwKLQkJCSBycHMtPmVmZmljaWVudF9mcmVxKTsK
LQotCXJwcy0+cnAxX2ZyZXEgPSB2YWxsZXl2aWV3X3Jwc19ndWFyX2ZyZXEoZGV2X3ByaXYpOwot
CURSTV9ERUJVR19EUklWRVIoIlJQMShHdWFyIEZyZXEpIEdQVSBmcmVxOiAlZCBNSHogKCV1KVxu
IiwKLQkJCSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5ycDFfZnJlcSksCi0JCQkgcnBz
LT5ycDFfZnJlcSk7Ci0KLQlycHMtPm1pbl9mcmVxID0gdmFsbGV5dmlld19ycHNfbWluX2ZyZXEo
ZGV2X3ByaXYpOwotCURSTV9ERUJVR19EUklWRVIoIm1pbiBHUFUgZnJlcTogJWQgTUh6ICgldSlc
biIsCi0JCQkgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+bWluX2ZyZXEpLAotCQkJIHJw
cy0+bWluX2ZyZXEpOwotCi0Jdmx2X2lvc2Zfc2JfcHV0KGRldl9wcml2LAotCQkJQklUKFZMVl9J
T1NGX1NCX1BVTklUKSB8Ci0JCQlCSVQoVkxWX0lPU0ZfU0JfTkMpIHwKLQkJCUJJVChWTFZfSU9T
Rl9TQl9DQ0spKTsKLX0KLQotc3RhdGljIHZvaWQgY2hlcnJ5dmlld19pbml0X2d0X3Bvd2Vyc2F2
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX3Jw
cyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0JdTMyIHZhbDsKLQotCWNoZXJyeXZpZXdf
c2V0dXBfcGN0eChkZXZfcHJpdik7Ci0KLQl2bHZfaW9zZl9zYl9nZXQoZGV2X3ByaXYsCi0JCQlC
SVQoVkxWX0lPU0ZfU0JfUFVOSVQpIHwKLQkJCUJJVChWTFZfSU9TRl9TQl9OQykgfAotCQkJQklU
KFZMVl9JT1NGX1NCX0NDSykpOwotCi0Jdmx2X2luaXRfZ3BsbF9yZWZfZnJlcShkZXZfcHJpdik7
Ci0KLQl2YWwgPSB2bHZfY2NrX3JlYWQoZGV2X3ByaXYsIENDS19GVVNFX1JFRyk7Ci0KLQlzd2l0
Y2ggKCh2YWwgPj4gMikgJiAweDcpIHsKLQljYXNlIDM6Ci0JCWRldl9wcml2LT5tZW1fZnJlcSA9
IDIwMDA7Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDE2MDA7
Ci0JCWJyZWFrOwotCX0KLQlEUk1fREVCVUdfRFJJVkVSKCJERFIgc3BlZWQ6ICVkIE1IelxuIiwg
ZGV2X3ByaXYtPm1lbV9mcmVxKTsKLQotCXJwcy0+bWF4X2ZyZXEgPSBjaGVycnl2aWV3X3Jwc19t
YXhfZnJlcShkZXZfcHJpdik7Ci0JcnBzLT5ycDBfZnJlcSA9IHJwcy0+bWF4X2ZyZXE7Ci0JRFJN
X0RFQlVHX0RSSVZFUigibWF4IEdQVSBmcmVxOiAlZCBNSHogKCV1KVxuIiwKLQkJCSBpbnRlbF9n
cHVfZnJlcShkZXZfcHJpdiwgcnBzLT5tYXhfZnJlcSksCi0JCQkgcnBzLT5tYXhfZnJlcSk7Ci0K
LQlycHMtPmVmZmljaWVudF9mcmVxID0gY2hlcnJ5dmlld19ycHNfcnBlX2ZyZXEoZGV2X3ByaXYp
OwotCURSTV9ERUJVR19EUklWRVIoIlJQZSBHUFUgZnJlcTogJWQgTUh6ICgldSlcbiIsCi0JCQkg
aW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpLAotCQkJIHJwcy0+
ZWZmaWNpZW50X2ZyZXEpOwotCi0JcnBzLT5ycDFfZnJlcSA9IGNoZXJyeXZpZXdfcnBzX2d1YXJf
ZnJlcShkZXZfcHJpdik7Ci0JRFJNX0RFQlVHX0RSSVZFUigiUlAxKEd1YXIpIEdQVSBmcmVxOiAl
ZCBNSHogKCV1KVxuIiwKLQkJCSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5ycDFfZnJl
cSksCi0JCQkgcnBzLT5ycDFfZnJlcSk7Ci0KLQlycHMtPm1pbl9mcmVxID0gY2hlcnJ5dmlld19y
cHNfbWluX2ZyZXEoZGV2X3ByaXYpOwotCURSTV9ERUJVR19EUklWRVIoIm1pbiBHUFUgZnJlcTog
JWQgTUh6ICgldSlcbiIsCi0JCQkgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+bWluX2Zy
ZXEpLAotCQkJIHJwcy0+bWluX2ZyZXEpOwotCi0Jdmx2X2lvc2Zfc2JfcHV0KGRldl9wcml2LAot
CQkJQklUKFZMVl9JT1NGX1NCX1BVTklUKSB8Ci0JCQlCSVQoVkxWX0lPU0ZfU0JfTkMpIHwKLQkJ
CUJJVChWTFZfSU9TRl9TQl9DQ0spKTsKLQotCVdBUk5fT05DRSgocnBzLT5tYXhfZnJlcSB8IHJw
cy0+ZWZmaWNpZW50X2ZyZXEgfCBycHMtPnJwMV9mcmVxIHwKLQkJICAgcnBzLT5taW5fZnJlcSkg
JiAxLAotCQkgICJPZGQgR1BVIGZyZXEgdmFsdWVzXG4iKTsKLX0KLQotc3RhdGljIHZvaWQgdmFs
bGV5dmlld19jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCi17Ci0JdmFsbGV5dmlld19jbGVhbnVwX3BjdHgoZGV2X3ByaXYpOwotfQotCi1zdGF0
aWMgdm9pZCBjaGVycnl2aWV3X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQotewotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGludGVs
X2VuZ2luZV9pZCBpZDsKLQl1MzIgZ3RmaWZvZGJnLCByYzZfbW9kZSwgcGNicjsKLQotCWd0Zmlm
b2RiZyA9IEk5MTVfUkVBRChHVEZJRk9EQkcpICYgfihHVF9GSUZPX1NCREVESUNBVEVfRlJFRV9F
TlRSWV9DSFYgfAotCQkJCQkgICAgIEdUX0ZJRk9fRlJFRV9FTlRSSUVTX0NIVik7Ci0JaWYgKGd0
Zmlmb2RiZykgewotCQlEUk1fREVCVUdfRFJJVkVSKCJHVCBmaWZvIGhhZCBhIHByZXZpb3VzIGVy
cm9yICV4XG4iLAotCQkJCSBndGZpZm9kYmcpOwotCQlJOTE1X1dSSVRFKEdURklGT0RCRywgZ3Rm
aWZvZGJnKTsKLQl9Ci0KLQljaGVycnl2aWV3X2NoZWNrX3BjdHgoZGV2X3ByaXYpOwotCi0JLyog
MWEgJiAxYjogR2V0IGZvcmNld2FrZSBkdXJpbmcgcHJvZ3JhbSBzZXF1ZW5jZS4gQWx0aG91Z2gg
dGhlIGRyaXZlcgotCSAqIGhhc24ndCBlbmFibGVkIGEgc3RhdGUgeWV0IHdoZXJlIHdlIG5lZWQg
Zm9yY2V3YWtlLCBCSU9TIG1heSBoYXZlLiovCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQo
JmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCi0JLyogIERpc2FibGUgUkMgc3Rh
dGVzLiAqLwotCUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLCAwKTsKLQotCS8qIDJhOiBQcm9n
cmFtIFJDNiB0aHJlc2hvbGRzLiovCi0JSTkxNV9XUklURShHRU42X1JDNl9XQUtFX1JBVEVfTElN
SVQsIDQwIDw8IDE2KTsKLQlJOTE1X1dSSVRFKEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwg
MTI1MDAwKTsgLyogMTI1MDAgKiAxMjgwbnMgKi8KLQlJOTE1X1dSSVRFKEdFTjZfUkNfSURMRV9I
WVNURVJTSVMsIDI1KTsgLyogMjUgKiAxMjgwbnMgKi8KLQotCWZvcl9lYWNoX2VuZ2luZShlbmdp
bmUsIGRldl9wcml2LCBpZCkKLQkJSTkxNV9XUklURShSSU5HX01BWF9JRExFKGVuZ2luZS0+bW1p
b19iYXNlKSwgMTApOwotCUk5MTVfV1JJVEUoR0VONl9SQ19TTEVFUCwgMCk7Ci0KLQkvKiBUTyB0
aHJlc2hvbGQgc2V0IHRvIDUwMCB1cyAoIDB4MTg2ICogMS4yOCB1cykgKi8KLQlJOTE1X1dSSVRF
KEdFTjZfUkM2X1RIUkVTSE9MRCwgMHgxODYpOwotCi0JLyogQWxsb3dzIFJDNiByZXNpZGVuY3kg
Y291bnRlciB0byB3b3JrICovCi0JSTkxNV9XUklURShWTFZfQ09VTlRFUl9DT05UUk9MLAotCQkg
ICBfTUFTS0VEX0JJVF9FTkFCTEUoVkxWX0NPVU5UX1JBTkdFX0hJR0ggfAotCQkJCSAgICAgIFZM
Vl9NRURJQV9SQzZfQ09VTlRfRU4gfAotCQkJCSAgICAgIFZMVl9SRU5ERVJfUkM2X0NPVU5UX0VO
KSk7Ci0KLQkvKiBGb3Igbm93IHdlIGFzc3VtZSBCSU9TIGlzIGFsbG9jYXRpbmcgYW5kIHBvcHVs
YXRpbmcgdGhlIFBDQlIgICovCi0JcGNiciA9IEk5MTVfUkVBRChWTFZfUENCUik7Ci0KLQkvKiAz
OiBFbmFibGUgUkM2ICovCi0JcmM2X21vZGUgPSAwOwotCWlmIChwY2JyID4+IFZMVl9QQ0JSX0FE
RFJfU0hJRlQpCi0JCXJjNl9tb2RlID0gR0VON19SQ19DVExfVE9fTU9ERTsKLQlJOTE1X1dSSVRF
KEdFTjZfUkNfQ09OVFJPTCwgcmM2X21vZGUpOwotCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9w
dXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCi1zdGF0aWMgdm9pZCBj
aGVycnl2aWV3X2VuYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQot
ewotCXUzMiB2YWw7Ci0KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVu
Y29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci0KLQkvKiAxOiBQcm9ncmFtIGRlZmF1bHRzIGFuZCB0aHJl
c2hvbGRzIGZvciBSUFMqLwotCUk5MTVfV1JJVEUoR0VONl9SUF9ET1dOX1RJTUVPVVQsIDEwMDAw
MDApOwotCUk5MTVfV1JJVEUoR0VONl9SUF9VUF9USFJFU0hPTEQsIDU5NDAwKTsKLQlJOTE1X1dS
SVRFKEdFTjZfUlBfRE9XTl9USFJFU0hPTEQsIDI0NTAwMCk7Ci0JSTkxNV9XUklURShHRU42X1JQ
X1VQX0VJLCA2NjAwMCk7Ci0JSTkxNV9XUklURShHRU42X1JQX0RPV05fRUksIDM1MDAwMCk7Ci0K
LQlJOTE1X1dSSVRFKEdFTjZfUlBfSURMRV9IWVNURVJTSVMsIDEwKTsKLQotCS8qIDI6IEVuYWJs
ZSBSUFMgKi8KLQlJOTE1X1dSSVRFKEdFTjZfUlBfQ09OVFJPTCwKLQkJICAgR0VONl9SUF9NRURJ
QV9IV19OT1JNQUxfTU9ERSB8Ci0JCSAgIEdFTjZfUlBfTUVESUFfSVNfR0ZYIHwKLQkJICAgR0VO
Nl9SUF9FTkFCTEUgfAotCQkgICBHRU42X1JQX1VQX0JVU1lfQVZHIHwKLQkJICAgR0VONl9SUF9E
T1dOX0lETEVfQVZHKTsKLQotCS8qIFNldHRpbmcgRml4ZWQgQmlhcyAqLwotCXZsdl9wdW5pdF9n
ZXQoZGV2X3ByaXYpOwotCi0JdmFsID0gVkxWX09WRVJSSURFX0VOIHwgVkxWX1NPQ19URFBfRU4g
fCBDSFZfQklBU19DUFVfNTBfU09DXzUwOwotCXZsdl9wdW5pdF93cml0ZShkZXZfcHJpdiwgVkxW
X1RVUkJPX1NPQ19PVkVSUklERSwgdmFsKTsKLQotCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGRldl9w
cml2LCBQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTKTsKLQotCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYp
OwotCi0JLyogUlBTIGNvZGUgYXNzdW1lcyBHUExMIGlzIHVzZWQgKi8KLQlXQVJOX09OQ0UoKHZh
bCAmIEdQTExFTkFCTEUpID09IDAsICJHUExMIG5vdCBlbmFibGVkXG4iKTsKLQotCURSTV9ERUJV
R19EUklWRVIoIkdQTEwgZW5hYmxlZD8gJXNcbiIsIHllc25vKHZhbCAmIEdQTExFTkFCTEUpKTsK
LQlEUk1fREVCVUdfRFJJVkVSKCJHUFUgc3RhdHVzOiAweCUwOHhcbiIsIHZhbCk7Ci0KLQlyZXNl
dF9ycHMoZGV2X3ByaXYsIHZhbGxleXZpZXdfc2V0X3Jwcyk7Ci0KLQlpbnRlbF91bmNvcmVfZm9y
Y2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci19Ci0KLXN0YXRp
YyB2b2lkIHZhbGxleXZpZXdfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxf
ZW5naW5lX2lkIGlkOwotCXUzMiBndGZpZm9kYmc7Ci0KLQl2YWxsZXl2aWV3X2NoZWNrX3BjdHgo
ZGV2X3ByaXYpOwotCi0JZ3RmaWZvZGJnID0gSTkxNV9SRUFEKEdURklGT0RCRyk7Ci0JaWYgKGd0
Zmlmb2RiZykgewotCQlEUk1fREVCVUdfRFJJVkVSKCJHVCBmaWZvIGhhZCBhIHByZXZpb3VzIGVy
cm9yICV4XG4iLAotCQkJCSBndGZpZm9kYmcpOwotCQlJOTE1X1dSSVRFKEdURklGT0RCRywgZ3Rm
aWZvZGJnKTsKLQl9Ci0KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVu
Y29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci0KLQkvKiAgRGlzYWJsZSBSQyBzdGF0ZXMuICovCi0JSTkx
NV9XUklURShHRU42X1JDX0NPTlRST0wsIDApOwotCi0JSTkxNV9XUklURShHRU42X1JDNl9XQUtF
X1JBVEVfTElNSVQsIDB4MDAyODAwMDApOwotCUk5MTVfV1JJVEUoR0VONl9SQ19FVkFMVUFUSU9O
X0lOVEVSVkFMLCAxMjUwMDApOwotCUk5MTVfV1JJVEUoR0VONl9SQ19JRExFX0hZU1RFUlNJUywg
MjUpOwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3ByaXYsIGlkKQotCQlJOTE1X1dS
SVRFKFJJTkdfTUFYX0lETEUoZW5naW5lLT5tbWlvX2Jhc2UpLCAxMCk7Ci0KLQlJOTE1X1dSSVRF
KEdFTjZfUkM2X1RIUkVTSE9MRCwgMHg1NTcpOwotCi0JLyogQWxsb3dzIFJDNiByZXNpZGVuY3kg
Y291bnRlciB0byB3b3JrICovCi0JSTkxNV9XUklURShWTFZfQ09VTlRFUl9DT05UUk9MLAotCQkg
ICBfTUFTS0VEX0JJVF9FTkFCTEUoVkxWX0NPVU5UX1JBTkdFX0hJR0ggfAotCQkJCSAgICAgIFZM
Vl9NRURJQV9SQzBfQ09VTlRfRU4gfAotCQkJCSAgICAgIFZMVl9SRU5ERVJfUkMwX0NPVU5UX0VO
IHwKLQkJCQkgICAgICBWTFZfTUVESUFfUkM2X0NPVU5UX0VOIHwKLQkJCQkgICAgICBWTFZfUkVO
REVSX1JDNl9DT1VOVF9FTikpOwotCi0JSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsCi0JCSAg
IEdFTjdfUkNfQ1RMX1RPX01PREUgfCBWTFZfUkNfQ1RMX0NUWF9SU1RfUEFSQUxMRUwpOwotCi0J
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwotfQotCi1zdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2VuYWJsZV9ycHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXUzMiB2YWw7Ci0KLQlpbnRlbF91bmNvcmVfZm9y
Y2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci0KLQlJOTE1X1dS
SVRFKEdFTjZfUlBfRE9XTl9USU1FT1VULCAxMDAwMDAwKTsKLQlJOTE1X1dSSVRFKEdFTjZfUlBf
VVBfVEhSRVNIT0xELCA1OTQwMCk7Ci0JSTkxNV9XUklURShHRU42X1JQX0RPV05fVEhSRVNIT0xE
LCAyNDUwMDApOwotCUk5MTVfV1JJVEUoR0VONl9SUF9VUF9FSSwgNjYwMDApOwotCUk5MTVfV1JJ
VEUoR0VONl9SUF9ET1dOX0VJLCAzNTAwMDApOwotCi0JSTkxNV9XUklURShHRU42X1JQX0lETEVf
SFlTVEVSU0lTLCAxMCk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUlBfQ09OVFJPTCwKLQkJICAgR0VO
Nl9SUF9NRURJQV9UVVJCTyB8Ci0JCSAgIEdFTjZfUlBfTUVESUFfSFdfTk9STUFMX01PREUgfAot
CQkgICBHRU42X1JQX01FRElBX0lTX0dGWCB8Ci0JCSAgIEdFTjZfUlBfRU5BQkxFIHwKLQkJICAg
R0VONl9SUF9VUF9CVVNZX0FWRyB8Ci0JCSAgIEdFTjZfUlBfRE9XTl9JRExFX0NPTlQpOwotCi0J
dmx2X3B1bml0X2dldChkZXZfcHJpdik7Ci0KLQkvKiBTZXR0aW5nIEZpeGVkIEJpYXMgKi8KLQl2
YWwgPSBWTFZfT1ZFUlJJREVfRU4gfCBWTFZfU09DX1REUF9FTiB8IFZMVl9CSUFTX0NQVV8xMjVf
U09DXzg3NTsKLQl2bHZfcHVuaXRfd3JpdGUoZGV2X3ByaXYsIFZMVl9UVVJCT19TT0NfT1ZFUlJJ
REUsIHZhbCk7Ci0KLQl2YWwgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX0dQ
VV9GUkVRX1NUUyk7Ci0KLQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKLQotCS8qIFJQUyBjb2Rl
IGFzc3VtZXMgR1BMTCBpcyB1c2VkICovCi0JV0FSTl9PTkNFKCh2YWwgJiBHUExMRU5BQkxFKSA9
PSAwLCAiR1BMTCBub3QgZW5hYmxlZFxuIik7Ci0KLQlEUk1fREVCVUdfRFJJVkVSKCJHUExMIGVu
YWJsZWQ/ICVzXG4iLCB5ZXNubyh2YWwgJiBHUExMRU5BQkxFKSk7Ci0JRFJNX0RFQlVHX0RSSVZF
UigiR1BVIHN0YXR1czogMHglMDh4XG4iLCB2YWwpOwotCi0JcmVzZXRfcnBzKGRldl9wcml2LCB2
YWxsZXl2aWV3X3NldF9ycHMpOwotCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9w
cml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCi1zdGF0aWMgdW5zaWduZWQgbG9uZyBp
bnRlbF9weGZyZXEodTMyIHZpZGZyZXEpCi17Ci0JdW5zaWduZWQgbG9uZyBmcmVxOwotCWludCBk
aXYgPSAodmlkZnJlcSAmIDB4M2YwMDAwKSA+PiAxNjsKLQlpbnQgcG9zdCA9ICh2aWRmcmVxICYg
MHgzMDAwKSA+PiAxMjsKLQlpbnQgcHJlID0gKHZpZGZyZXEgJiAweDcpOwotCi0JaWYgKCFwcmUp
Ci0JCXJldHVybiAwOwotCi0JZnJlcSA9ICgoZGl2ICogMTMzMzMzKSAvICgoMTw8cG9zdCkgKiBw
cmUpKTsKLQotCXJldHVybiBmcmVxOwotfQotCi1zdGF0aWMgY29uc3Qgc3RydWN0IGNwYXJhbXMg
ewotCXUxNiBpOwotCXUxNiB0OwotCXUxNiBtOwotCXUxNiBjOwotfSBjcGFyYW1zW10gPSB7Ci0J
eyAxLCAxMzMzLCAzMDEsIDI4NjY0IH0sCi0JeyAxLCAxMDY2LCAyOTQsIDI0NDYwIH0sCi0JeyAx
LCA4MDAsIDI5NCwgMjUxOTIgfSwKLQl7IDAsIDEzMzMsIDI3NiwgMjc2MDUgfSwKLQl7IDAsIDEw
NjYsIDI3NiwgMjc2MDUgfSwKLQl7IDAsIDgwMCwgMjMxLCAyMzc4NCB9LAotfTsKLQotc3RhdGlj
IHVuc2lnbmVkIGxvbmcgX19pOTE1X2NoaXBzZXRfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKLXsKLQl1NjQgdG90YWxfY291bnQsIGRpZmYsIHJldDsKLQl1MzIgY291bnQx
LCBjb3VudDIsIGNvdW50MywgbSA9IDAsIGMgPSAwOwotCXVuc2lnbmVkIGxvbmcgbm93ID0gamlm
Zmllc190b19tc2VjcyhqaWZmaWVzKSwgZGlmZjE7Ci0JaW50IGk7Ci0KLQlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZtY2hkZXZfbG9jayk7Ci0KLQlkaWZmMSA9IG5vdyAtIGRldl9wcml2LT5pcHMubGFz
dF90aW1lMTsKLQotCS8qIFByZXZlbnQgZGl2aXNpb24tYnktemVybyBpZiB3ZSBhcmUgYXNraW5n
IHRvbyBmYXN0LgotCSAqIEFsc28sIHdlIGRvbid0IGdldCBpbnRlcmVzdGluZyByZXN1bHRzIGlm
IHdlIGFyZSBwb2xsaW5nCi0JICogZmFzdGVyIHRoYW4gb25jZSBpbiAxMG1zLCBzbyBqdXN0IHJl
dHVybiB0aGUgc2F2ZWQgdmFsdWUKLQkgKiBpbiBzdWNoIGNhc2VzLgotCSAqLwotCWlmIChkaWZm
MSA8PSAxMCkKLQkJcmV0dXJuIGRldl9wcml2LT5pcHMuY2hpcHNldF9wb3dlcjsKLQotCWNvdW50
MSA9IEk5MTVfUkVBRChETUlFQyk7Ci0JY291bnQyID0gSTkxNV9SRUFEKEREUkVDKTsKLQljb3Vu
dDMgPSBJOTE1X1JFQUQoQ1NJRUMpOwotCi0JdG90YWxfY291bnQgPSBjb3VudDEgKyBjb3VudDIg
KyBjb3VudDM7Ci0KLQkvKiBGSVhNRTogaGFuZGxlIHBlci1jb3VudGVyIG92ZXJmbG93ICovCi0J
aWYgKHRvdGFsX2NvdW50IDwgZGV2X3ByaXYtPmlwcy5sYXN0X2NvdW50MSkgewotCQlkaWZmID0g
fjBVTCAtIGRldl9wcml2LT5pcHMubGFzdF9jb3VudDE7Ci0JCWRpZmYgKz0gdG90YWxfY291bnQ7
Ci0JfSBlbHNlIHsKLQkJZGlmZiA9IHRvdGFsX2NvdW50IC0gZGV2X3ByaXYtPmlwcy5sYXN0X2Nv
dW50MTsKLQl9Ci0KLQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShjcGFyYW1zKTsgaSsrKSB7
Ci0JCWlmIChjcGFyYW1zW2ldLmkgPT0gZGV2X3ByaXYtPmlwcy5jX20gJiYKLQkJICAgIGNwYXJh
bXNbaV0udCA9PSBkZXZfcHJpdi0+aXBzLnJfdCkgewotCQkJbSA9IGNwYXJhbXNbaV0ubTsKLQkJ
CWMgPSBjcGFyYW1zW2ldLmM7Ci0JCQlicmVhazsKLQkJfQotCX0KLQotCWRpZmYgPSBkaXZfdTY0
KGRpZmYsIGRpZmYxKTsKLQlyZXQgPSAoKG0gKiBkaWZmKSArIGMpOwotCXJldCA9IGRpdl91NjQo
cmV0LCAxMCk7Ci0KLQlkZXZfcHJpdi0+aXBzLmxhc3RfY291bnQxID0gdG90YWxfY291bnQ7Ci0J
ZGV2X3ByaXYtPmlwcy5sYXN0X3RpbWUxID0gbm93OwotCi0JZGV2X3ByaXYtPmlwcy5jaGlwc2V0
X3Bvd2VyID0gcmV0OwotCi0JcmV0dXJuIHJldDsKLX0KLQotdW5zaWduZWQgbG9uZyBpOTE1X2No
aXBzZXRfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlpbnRlbF93
YWtlcmVmX3Qgd2FrZXJlZjsKLQl1bnNpZ25lZCBsb25nIHZhbCA9IDA7Ci0KLQlpZiAoIUlTX0dF
TihkZXZfcHJpdiwgNSkpCi0JCXJldHVybiAwOwotCi0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKCZk
ZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZikgewotCQlzcGluX2xvY2tfaXJxKCZtY2hkZXZf
bG9jayk7Ci0JCXZhbCA9IF9faTkxNV9jaGlwc2V0X3ZhbChkZXZfcHJpdik7Ci0JCXNwaW5fdW5s
b2NrX2lycSgmbWNoZGV2X2xvY2spOwotCX0KLQotCXJldHVybiB2YWw7Ci19Ci0KLXVuc2lnbmVk
IGxvbmcgaTkxNV9tY2hfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQotewotCXVu
c2lnbmVkIGxvbmcgbSwgeCwgYjsKLQl1MzIgdHNmczsKLQotCXRzZnMgPSBpbnRlbF91bmNvcmVf
cmVhZCgmaTkxNS0+dW5jb3JlLCBUU0ZTKTsKLQotCW0gPSAoKHRzZnMgJiBUU0ZTX1NMT1BFX01B
U0spID4+IFRTRlNfU0xPUEVfU0hJRlQpOwotCXggPSBpbnRlbF91bmNvcmVfcmVhZDgoJmk5MTUt
PnVuY29yZSwgVFIxKTsKLQotCWIgPSB0c2ZzICYgVFNGU19JTlRSX01BU0s7Ci0KLQlyZXR1cm4g
KChtICogeCkgLyAxMjcpIC0gYjsKLX0KLQotc3RhdGljIGludCBfcHh2aWRfdG9fdmQodTggcHh2
aWQpCi17Ci0JaWYgKHB4dmlkID09IDApCi0JCXJldHVybiAwOwotCi0JaWYgKHB4dmlkID49IDgg
JiYgcHh2aWQgPCAzMSkKLQkJcHh2aWQgPSAzMTsKLQotCXJldHVybiAocHh2aWQgKyAyKSAqIDEy
NTsKLX0KLQotc3RhdGljIHUzMiBwdmlkX3RvX2V4dHZpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIHU4IHB4dmlkKQotewotCWNvbnN0IGludCB2ZCA9IF9weHZpZF90b192ZChw
eHZpZCk7Ci0JY29uc3QgaW50IHZtID0gdmQgLSAxMTI1OwotCi0JaWYgKElOVEVMX0lORk8oZGV2
X3ByaXYpLT5pc19tb2JpbGUpCi0JCXJldHVybiB2bSA+IDAgPyB2bSA6IDA7Ci0KLQlyZXR1cm4g
dmQ7Ci19Ci0KLXN0YXRpYyB2b2lkIF9faTkxNV91cGRhdGVfZ2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTY0IG5vdywgZGlmZiwgZGlmZm1zOwotCXUzMiBj
b3VudDsKLQotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJm1jaGRldl9sb2NrKTsKLQotCW5vdyA9IGt0
aW1lX2dldF9yYXdfbnMoKTsKLQlkaWZmbXMgPSBub3cgLSBkZXZfcHJpdi0+aXBzLmxhc3RfdGlt
ZTI7Ci0JZG9fZGl2KGRpZmZtcywgTlNFQ19QRVJfTVNFQyk7Ci0KLQkvKiBEb24ndCBkaXZpZGUg
YnkgMCAqLwotCWlmICghZGlmZm1zKQotCQlyZXR1cm47Ci0KLQljb3VudCA9IEk5MTVfUkVBRChH
RlhFQyk7Ci0KLQlpZiAoY291bnQgPCBkZXZfcHJpdi0+aXBzLmxhc3RfY291bnQyKSB7Ci0JCWRp
ZmYgPSB+MFVMIC0gZGV2X3ByaXYtPmlwcy5sYXN0X2NvdW50MjsKLQkJZGlmZiArPSBjb3VudDsK
LQl9IGVsc2UgewotCQlkaWZmID0gY291bnQgLSBkZXZfcHJpdi0+aXBzLmxhc3RfY291bnQyOwot
CX0KLQotCWRldl9wcml2LT5pcHMubGFzdF9jb3VudDIgPSBjb3VudDsKLQlkZXZfcHJpdi0+aXBz
Lmxhc3RfdGltZTIgPSBub3c7Ci0KLQkvKiBNb3JlIG1hZ2ljIGNvbnN0YW50cy4uLiAqLwotCWRp
ZmYgPSBkaWZmICogMTE4MTsKLQlkaWZmID0gZGl2X3U2NChkaWZmLCBkaWZmbXMgKiAxMCk7Ci0J
ZGV2X3ByaXYtPmlwcy5nZnhfcG93ZXIgPSBkaWZmOwotfQotCi12b2lkIGk5MTVfdXBkYXRlX2dm
eF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCWludGVsX3dha2Vy
ZWZfdCB3YWtlcmVmOwotCi0JaWYgKCFJU19HRU4oZGV2X3ByaXYsIDUpKQotCQlyZXR1cm47Ci0K
LQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKSB7
Ci0JCXNwaW5fbG9ja19pcnEoJm1jaGRldl9sb2NrKTsKLQkJX19pOTE1X3VwZGF0ZV9nZnhfdmFs
KGRldl9wcml2KTsKLQkJc3Bpbl91bmxvY2tfaXJxKCZtY2hkZXZfbG9jayk7Ci0JfQotfQotCi1z
dGF0aWMgdW5zaWduZWQgbG9uZyBfX2k5MTVfZ2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCi17Ci0JdW5zaWduZWQgbG9uZyB0LCBjb3JyLCBzdGF0ZTEsIGNvcnIyLCBz
dGF0ZTI7Ci0JdTMyIHB4dmlkLCBleHRfdjsKLQotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJm1jaGRl
dl9sb2NrKTsKLQotCXB4dmlkID0gSTkxNV9SRUFEKFBYVkZSRVEoZGV2X3ByaXYtPmd0X3BtLnJw
cy5jdXJfZnJlcSkpOwotCXB4dmlkID0gKHB4dmlkID4+IDI0KSAmIDB4N2Y7Ci0JZXh0X3YgPSBw
dmlkX3RvX2V4dHZpZChkZXZfcHJpdiwgcHh2aWQpOwotCi0Jc3RhdGUxID0gZXh0X3Y7Ci0KLQl0
ID0gaTkxNV9tY2hfdmFsKGRldl9wcml2KTsKLQotCS8qIFJldmVsIGluIHRoZSBlbXBpcmljYWxs
eSBkZXJpdmVkIGNvbnN0YW50cyAqLwotCi0JLyogQ29ycmVjdGlvbiBmYWN0b3IgaW4gMS8xMDAw
MDAgdW5pdHMgKi8KLQlpZiAodCA+IDgwKQotCQljb3JyID0gKCh0ICogMjM0OSkgKyAxMzU5NDAp
OwotCWVsc2UgaWYgKHQgPj0gNTApCi0JCWNvcnIgPSAoKHQgKiA5NjQpICsgMjkzMTcpOwotCWVs
c2UgLyogPCA1MCAqLwotCQljb3JyID0gKCh0ICogMzAxKSArIDEwMDQpOwotCi0JY29yciA9IGNv
cnIgKiAoKDE1MDE0MiAqIHN0YXRlMSkgLyAxMDAwMCAtIDc4NjQyKTsKLQljb3JyIC89IDEwMDAw
MDsKLQljb3JyMiA9IChjb3JyICogZGV2X3ByaXYtPmlwcy5jb3JyKTsKLQotCXN0YXRlMiA9IChj
b3JyMiAqIHN0YXRlMSkgLyAxMDAwMDsKLQlzdGF0ZTIgLz0gMTAwOyAvKiBjb252ZXJ0IHRvIG1X
ICovCi0KLQlfX2k5MTVfdXBkYXRlX2dmeF92YWwoZGV2X3ByaXYpOwotCi0JcmV0dXJuIGRldl9w
cml2LT5pcHMuZ2Z4X3Bvd2VyICsgc3RhdGUyOwotfQotCi11bnNpZ25lZCBsb25nIGk5MTVfZ2Z4
X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JaW50ZWxfd2FrZXJl
Zl90IHdha2VyZWY7Ci0JdW5zaWduZWQgbG9uZyB2YWwgPSAwOwotCi0JaWYgKCFJU19HRU4oZGV2
X3ByaXYsIDUpKQotCQlyZXR1cm4gMDsKLQotCXdpdGhfaW50ZWxfcnVudGltZV9wbSgmZGV2X3By
aXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpIHsKLQkJc3Bpbl9sb2NrX2lycSgmbWNoZGV2X2xvY2sp
OwotCQl2YWwgPSBfX2k5MTVfZ2Z4X3ZhbChkZXZfcHJpdik7Ci0JCXNwaW5fdW5sb2NrX2lycSgm
bWNoZGV2X2xvY2spOwotCX0KLQotCXJldHVybiB2YWw7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSBfX3JjdSAqaTkxNV9tY2hfZGV2OwotCi1zdGF0aWMgc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKm1jaGRldl9nZXQodm9pZCkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNTsKLQotCXJjdV9yZWFkX2xvY2soKTsKLQlpOTE1ID0gcmN1X2RlcmVmZXJlbmNlKGk5
MTVfbWNoX2Rldik7Ci0JaWYgKCFrcmVmX2dldF91bmxlc3NfemVybygmaTkxNS0+ZHJtLnJlZikp
Ci0JCWk5MTUgPSBOVUxMOwotCXJjdV9yZWFkX3VubG9jaygpOwotCi0JcmV0dXJuIGk5MTU7Ci19
Ci0KLS8qKgotICogaTkxNV9yZWFkX21jaF92YWwgLSByZXR1cm4gdmFsdWUgZm9yIElQUyB1c2UK
LSAqCi0gKiBDYWxjdWxhdGUgYW5kIHJldHVybiBhIHZhbHVlIGZvciB0aGUgSVBTIGRyaXZlciB0
byB1c2Ugd2hlbiBkZWNpZGluZyB3aGV0aGVyCi0gKiB3ZSBoYXZlIHRoZXJtYWwgYW5kIHBvd2Vy
IGhlYWRyb29tIHRvIGluY3JlYXNlIENQVSBvciBHUFUgcG93ZXIgYnVkZ2V0LgotICovCi11bnNp
Z25lZCBsb25nIGk5MTVfcmVhZF9tY2hfdmFsKHZvaWQpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTU7Ci0JdW5zaWduZWQgbG9uZyBjaGlwc2V0X3ZhbCA9IDA7Ci0JdW5zaWduZWQg
bG9uZyBncmFwaGljc192YWwgPSAwOwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCi0JaTkx
NSA9IG1jaGRldl9nZXQoKTsKLQlpZiAoIWk5MTUpCi0JCXJldHVybiAwOwotCi0Jd2l0aF9pbnRl
bF9ydW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKSB7Ci0JCXNwaW5fbG9ja19p
cnEoJm1jaGRldl9sb2NrKTsKLQkJY2hpcHNldF92YWwgPSBfX2k5MTVfY2hpcHNldF92YWwoaTkx
NSk7Ci0JCWdyYXBoaWNzX3ZhbCA9IF9faTkxNV9nZnhfdmFsKGk5MTUpOwotCQlzcGluX3VubG9j
a19pcnEoJm1jaGRldl9sb2NrKTsKLQl9Ci0KLQlkcm1fZGV2X3B1dCgmaTkxNS0+ZHJtKTsKLQly
ZXR1cm4gY2hpcHNldF92YWwgKyBncmFwaGljc192YWw7Ci19Ci1FWFBPUlRfU1lNQk9MX0dQTChp
OTE1X3JlYWRfbWNoX3ZhbCk7Ci0KLS8qKgotICogaTkxNV9ncHVfcmFpc2UgLSByYWlzZSBHUFUg
ZnJlcXVlbmN5IGxpbWl0Ci0gKgotICogUmFpc2UgdGhlIGxpbWl0OyBJUFMgaW5kaWNhdGVzIHdl
IGhhdmUgdGhlcm1hbCBoZWFkcm9vbS4KLSAqLwotYm9vbCBpOTE1X2dwdV9yYWlzZSh2b2lkKQot
ewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1OwotCi0JaTkxNSA9IG1jaGRldl9nZXQo
KTsKLQlpZiAoIWk5MTUpCi0JCXJldHVybiBmYWxzZTsKLQotCXNwaW5fbG9ja19pcnEoJm1jaGRl
dl9sb2NrKTsKLQlpZiAoaTkxNS0+aXBzLm1heF9kZWxheSA+IGk5MTUtPmlwcy5mbWF4KQotCQlp
OTE1LT5pcHMubWF4X2RlbGF5LS07Ci0Jc3Bpbl91bmxvY2tfaXJxKCZtY2hkZXZfbG9jayk7Ci0K
LQlkcm1fZGV2X3B1dCgmaTkxNS0+ZHJtKTsKLQlyZXR1cm4gdHJ1ZTsKLX0KLUVYUE9SVF9TWU1C
T0xfR1BMKGk5MTVfZ3B1X3JhaXNlKTsKLQotLyoqCi0gKiBpOTE1X2dwdV9sb3dlciAtIGxvd2Vy
IEdQVSBmcmVxdWVuY3kgbGltaXQKLSAqCi0gKiBJUFMgaW5kaWNhdGVzIHdlJ3JlIGNsb3NlIHRv
IGEgdGhlcm1hbCBsaW1pdCwgc28gdGhyb3R0bGUgYmFjayB0aGUgR1BVCi0gKiBmcmVxdWVuY3kg
bWF4aW11bS4KLSAqLwotYm9vbCBpOTE1X2dwdV9sb3dlcih2b2lkKQotewotCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1OwotCi0JaTkxNSA9IG1jaGRldl9nZXQoKTsKLQlpZiAoIWk5MTUp
Ci0JCXJldHVybiBmYWxzZTsKLQotCXNwaW5fbG9ja19pcnEoJm1jaGRldl9sb2NrKTsKLQlpZiAo
aTkxNS0+aXBzLm1heF9kZWxheSA8IGk5MTUtPmlwcy5taW5fZGVsYXkpCi0JCWk5MTUtPmlwcy5t
YXhfZGVsYXkrKzsKLQlzcGluX3VubG9ja19pcnEoJm1jaGRldl9sb2NrKTsKLQotCWRybV9kZXZf
cHV0KCZpOTE1LT5kcm0pOwotCXJldHVybiB0cnVlOwotfQotRVhQT1JUX1NZTUJPTF9HUEwoaTkx
NV9ncHVfbG93ZXIpOwotCi0vKioKLSAqIGk5MTVfZ3B1X2J1c3kgLSBpbmRpY2F0ZSBHUFUgYnVz
aW5lc3MgdG8gSVBTCi0gKgotICogVGVsbCB0aGUgSVBTIGRyaXZlciB3aGV0aGVyIG9yIG5vdCB0
aGUgR1BVIGlzIGJ1c3kuCi0gKi8KLWJvb2wgaTkxNV9ncHVfYnVzeSh2b2lkKQotewotCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1OwotCWJvb2wgcmV0OwotCi0JaTkxNSA9IG1jaGRldl9n
ZXQoKTsKLQlpZiAoIWk5MTUpCi0JCXJldHVybiBmYWxzZTsKLQotCXJldCA9IGk5MTUtPmd0LmF3
YWtlOwotCi0JZHJtX2Rldl9wdXQoJmk5MTUtPmRybSk7Ci0JcmV0dXJuIHJldDsKLX0KLUVYUE9S
VF9TWU1CT0xfR1BMKGk5MTVfZ3B1X2J1c3kpOwotCi0vKioKLSAqIGk5MTVfZ3B1X3R1cmJvX2Rp
c2FibGUgLSBkaXNhYmxlIGdyYXBoaWNzIHR1cmJvCi0gKgotICogRGlzYWJsZSBncmFwaGljcyB0
dXJibyBieSByZXNldHRpbmcgdGhlIG1heCBmcmVxdWVuY3kgYW5kIHNldHRpbmcgdGhlCi0gKiBj
dXJyZW50IGZyZXF1ZW5jeSB0byB0aGUgZGVmYXVsdC4KLSAqLwotYm9vbCBpOTE1X2dwdV90dXJi
b19kaXNhYmxlKHZvaWQpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7Ci0JYm9v
bCByZXQ7Ci0KLQlpOTE1ID0gbWNoZGV2X2dldCgpOwotCWlmICghaTkxNSkKLQkJcmV0dXJuIGZh
bHNlOwotCi0Jc3Bpbl9sb2NrX2lycSgmbWNoZGV2X2xvY2spOwotCWk5MTUtPmlwcy5tYXhfZGVs
YXkgPSBpOTE1LT5pcHMuZnN0YXJ0OwotCXJldCA9IGlyb25sYWtlX3NldF9kcnBzKGk5MTUsIGk5
MTUtPmlwcy5mc3RhcnQpOwotCXNwaW5fdW5sb2NrX2lycSgmbWNoZGV2X2xvY2spOwotCi0JZHJt
X2Rldl9wdXQoJmk5MTUtPmRybSk7Ci0JcmV0dXJuIHJldDsKLX0KLUVYUE9SVF9TWU1CT0xfR1BM
KGk5MTVfZ3B1X3R1cmJvX2Rpc2FibGUpOwotCi0vKioKLSAqIFRlbGxzIHRoZSBpbnRlbF9pcHMg
ZHJpdmVyIHRoYXQgdGhlIGk5MTUgZHJpdmVyIGlzIG5vdyBsb2FkZWQsIGlmCi0gKiBJUFMgZ290
IGxvYWRlZCBmaXJzdC4KLSAqCi0gKiBUaGlzIGF3a3dhcmQgZGFuY2UgaXMgc28gdGhhdCBuZWl0
aGVyIG1vZHVsZSBoYXMgdG8gZGVwZW5kIG9uIHRoZQotICogb3RoZXIgaW4gb3JkZXIgZm9yIElQ
UyB0byBkbyB0aGUgYXBwcm9wcmlhdGUgY29tbXVuaWNhdGlvbiBvZgotICogR1BVIHR1cmJvIGxp
bWl0cyB0byBpOTE1LgotICovCi1zdGF0aWMgdm9pZAotaXBzX3BpbmdfZm9yX2k5MTVfbG9hZCh2
b2lkKQotewotCXZvaWQgKCpsaW5rKSh2b2lkKTsKLQotCWxpbmsgPSBzeW1ib2xfZ2V0KGlwc19s
aW5rX3RvX2k5MTVfZHJpdmVyKTsKLQlpZiAobGluaykgewotCQlsaW5rKCk7Ci0JCXN5bWJvbF9w
dXQoaXBzX2xpbmtfdG9faTkxNV9kcml2ZXIpOwotCX0KLX0KLQotdm9pZCBpbnRlbF9ncHVfaXBz
X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCS8qIFdlIG9ubHkg
cmVnaXN0ZXIgdGhlIGk5MTUgaXBzIHBhcnQgd2l0aCBpbnRlbC1pcHMgb25jZSBldmVyeXRoaW5n
IGlzCi0JICogc2V0IHVwLCB0byBhdm9pZCBpbnRlbC1pcHMgc25lYWtpbmcgaW4gYW5kIHJlYWRp
bmcgYm9ndXMgdmFsdWVzLiAqLwotCXJjdV9hc3NpZ25fcG9pbnRlcihpOTE1X21jaF9kZXYsIGRl
dl9wcml2KTsKLQotCWlwc19waW5nX2Zvcl9pOTE1X2xvYWQoKTsKLX0KLQotdm9pZCBpbnRlbF9n
cHVfaXBzX3RlYXJkb3duKHZvaWQpCi17Ci0JcmN1X2Fzc2lnbl9wb2ludGVyKGk5MTVfbWNoX2Rl
diwgTlVMTCk7Ci19Ci0KLXN0YXRpYyB2b2lkIGludGVsX2luaXRfZW1vbihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTMyIGxjZnVzZTsKLQl1OCBweHdbMTZdOwotCWlu
dCBpOwotCi0JLyogRGlzYWJsZSB0byBwcm9ncmFtICovCi0JSTkxNV9XUklURShFQ1IsIDApOwot
CVBPU1RJTkdfUkVBRChFQ1IpOwotCi0JLyogUHJvZ3JhbSBlbmVyZ3kgd2VpZ2h0cyBmb3IgdmFy
aW91cyBldmVudHMgKi8KLQlJOTE1X1dSSVRFKFNERVcsIDB4MTUwNDBkMDApOwotCUk5MTVfV1JJ
VEUoQ1NJRVcwLCAweDAwN2YwMDAwKTsKLQlJOTE1X1dSSVRFKENTSUVXMSwgMHgxZTIyMDAwNCk7
Ci0JSTkxNV9XUklURShDU0lFVzIsIDB4MDQwMDAwMDQpOwotCi0JZm9yIChpID0gMDsgaSA8IDU7
IGkrKykKLQkJSTkxNV9XUklURShQRVcoaSksIDApOwotCWZvciAoaSA9IDA7IGkgPCAzOyBpKysp
Ci0JCUk5MTVfV1JJVEUoREVXKGkpLCAwKTsKLQotCS8qIFByb2dyYW0gUC1zdGF0ZSB3ZWlnaHRz
IHRvIGFjY291bnQgZm9yIGZyZXF1ZW5jeSBwb3dlciBhZGp1c3RtZW50ICovCi0JZm9yIChpID0g
MDsgaSA8IDE2OyBpKyspIHsKLQkJdTMyIHB4dmlkZnJlcSA9IEk5MTVfUkVBRChQWFZGUkVRKGkp
KTsKLQkJdW5zaWduZWQgbG9uZyBmcmVxID0gaW50ZWxfcHhmcmVxKHB4dmlkZnJlcSk7Ci0JCXVu
c2lnbmVkIGxvbmcgdmlkID0gKHB4dmlkZnJlcSAmIFBYVkZSRVFfUFhfTUFTSykgPj4KLQkJCVBY
VkZSRVFfUFhfU0hJRlQ7Ci0JCXVuc2lnbmVkIGxvbmcgdmFsOwotCi0JCXZhbCA9IHZpZCAqIHZp
ZDsKLQkJdmFsICo9IChmcmVxIC8gMTAwMCk7Ci0JCXZhbCAqPSAyNTU7Ci0JCXZhbCAvPSAoMTI3
KjEyNyo5MDApOwotCQlpZiAodmFsID4gMHhmZikKLQkJCURSTV9FUlJPUigiYmFkIHB4dmFsOiAl
bGRcbiIsIHZhbCk7Ci0JCXB4d1tpXSA9IHZhbDsKLQl9Ci0JLyogUmVuZGVyIHN0YW5kYnkgc3Rh
dGVzIGdldCAwIHdlaWdodCAqLwotCXB4d1sxNF0gPSAwOwotCXB4d1sxNV0gPSAwOwotCi0JZm9y
IChpID0gMDsgaSA8IDQ7IGkrKykgewotCQl1MzIgdmFsID0gKHB4d1tpKjRdIDw8IDI0KSB8IChw
eHdbKGkqNCkrMV0gPDwgMTYpIHwKLQkJCShweHdbKGkqNCkrMl0gPDwgOCkgfCAocHh3WyhpKjQp
KzNdKTsKLQkJSTkxNV9XUklURShQWFcoaSksIHZhbCk7Ci0JfQotCi0JLyogQWRqdXN0IG1hZ2lj
IHJlZ3MgdG8gbWFnaWMgdmFsdWVzIChtb3JlIGV4cGVyaW1lbnRhbCByZXN1bHRzKSAqLwotCUk5
MTVfV1JJVEUoT0dXMCwgMCk7Ci0JSTkxNV9XUklURShPR1cxLCAwKTsKLQlJOTE1X1dSSVRFKEVH
MCwgMHgwMDAwN2YwMCk7Ci0JSTkxNV9XUklURShFRzEsIDB4MDAwMDAwMGUpOwotCUk5MTVfV1JJ
VEUoRUcyLCAweDAwMGUwMDAwKTsKLQlJOTE1X1dSSVRFKEVHMywgMHg2ODAwMDMwMCk7Ci0JSTkx
NV9XUklURShFRzQsIDB4NDIwMDAwMDApOwotCUk5MTVfV1JJVEUoRUc1LCAweDAwMTQwMDMxKTsK
LQlJOTE1X1dSSVRFKEVHNiwgMCk7Ci0JSTkxNV9XUklURShFRzcsIDApOwotCi0JZm9yIChpID0g
MDsgaSA8IDg7IGkrKykKLQkJSTkxNV9XUklURShQWFdMKGkpLCAwKTsKLQotCS8qIEVuYWJsZSBQ
TU9OICsgc2VsZWN0IGV2ZW50cyAqLwotCUk5MTVfV1JJVEUoRUNSLCAweDgwMDAwMDE5KTsKLQot
CWxjZnVzZSA9IEk5MTVfUkVBRChMQ0ZVU0UwMik7Ci0KLQlkZXZfcHJpdi0+aXBzLmNvcnIgPSAo
bGNmdXNlICYgTENGVVNFX0hJVl9NQVNLKTsKLX0KLQotdm9pZCBpbnRlbF9pbml0X2d0X3Bvd2Vy
c2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVs
X3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0KLQkvKgotCSAqIFJQTSBkZXBlbmRz
IG9uIFJDNiB0byBzYXZlIHJlc3RvcmUgdGhlIEdUIEhXIGNvbnRleHQsIHNvIG1ha2UgUkM2IGEK
LQkgKiByZXF1aXJlbWVudC4KLQkgKi8KLQlpZiAoIXNhbml0aXplX3JjNihkZXZfcHJpdikpIHsK
LQkJRFJNX0lORk8oIlJDNiBkaXNhYmxlZCwgZGlzYWJsaW5nIHJ1bnRpbWUgUE0gc3VwcG9ydFxu
Iik7Ci0JCXBtX3J1bnRpbWVfZ2V0KCZkZXZfcHJpdi0+ZHJtLnBkZXYtPmRldik7Ci0JfQotCi0J
LyogSW5pdGlhbGl6ZSBSUFMgbGltaXRzIChmb3IgdXNlcnNwYWNlKSAqLwotCWlmIChJU19DSEVS
UllWSUVXKGRldl9wcml2KSkKLQkJY2hlcnJ5dmlld19pbml0X2d0X3Bvd2Vyc2F2ZShkZXZfcHJp
dik7Ci0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCi0JCXZhbGxleXZpZXdfaW5p
dF9ndF9wb3dlcnNhdmUoZGV2X3ByaXYpOwotCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gNikKLQkJZ2VuNl9pbml0X3Jwc19mcmVxdWVuY2llcyhkZXZfcHJpdik7Ci0KLQkvKiBEZXJp
dmUgaW5pdGlhbCB1c2VyIHByZWZlcmVuY2VzL2xpbWl0cyBmcm9tIHRoZSBoYXJkd2FyZSBsaW1p
dHMgKi8KLQlycHMtPm1heF9mcmVxX3NvZnRsaW1pdCA9IHJwcy0+bWF4X2ZyZXE7Ci0JcnBzLT5t
aW5fZnJlcV9zb2Z0bGltaXQgPSBycHMtPm1pbl9mcmVxOwotCi0JLyogQWZ0ZXIgc2V0dGluZyBt
YXgtc29mdGxpbWl0LCBmaW5kIHRoZSBvdmVyY2xvY2sgbWF4IGZyZXEgKi8KLQlpZiAoSVNfR0VO
KGRldl9wcml2LCA2KSB8fAotCSAgICBJU19JVllCUklER0UoZGV2X3ByaXYpIHx8IElTX0hBU1dF
TEwoZGV2X3ByaXYpKSB7Ci0JCXUzMiBwYXJhbXMgPSAwOwotCi0JCXNhbmR5YnJpZGdlX3Bjb2Rl
X3JlYWQoZGV2X3ByaXYsIEdFTjZfUkVBRF9PQ19QQVJBTVMsCi0JCQkJICAgICAgICZwYXJhbXMs
IE5VTEwpOwotCQlpZiAocGFyYW1zICYgQklUKDMxKSkgeyAvKiBPQyBzdXBwb3J0ZWQgKi8KLQkJ
CURSTV9ERUJVR19EUklWRVIoIk92ZXJjbG9ja2luZyBzdXBwb3J0ZWQsIG1heDogJWRNSHosIG92
ZXJjbG9jazogJWRNSHpcbiIsCi0JCQkJCSAocnBzLT5tYXhfZnJlcSAmIDB4ZmYpICogNTAsCi0J
CQkJCSAocGFyYW1zICYgMHhmZikgKiA1MCk7Ci0JCQlycHMtPm1heF9mcmVxID0gcGFyYW1zICYg
MHhmZjsKLQkJfQotCX0KLQotCS8qIEZpbmFsbHkgYWxsb3cgdXMgdG8gYm9vc3QgdG8gbWF4IGJ5
IGRlZmF1bHQgKi8KLQlycHMtPmJvb3N0X2ZyZXEgPSBycHMtPm1heF9mcmVxOwotCXJwcy0+aWRs
ZV9mcmVxID0gcnBzLT5taW5fZnJlcTsKLQlycHMtPmN1cl9mcmVxID0gcnBzLT5pZGxlX2ZyZXE7
Ci19Ci0KLXZvaWQgaW50ZWxfY2xlYW51cF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQotewotCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKLQkJdmFs
bGV5dmlld19jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShkZXZfcHJpdik7Ci0KLQlpZiAoIUhBU19SQzYo
ZGV2X3ByaXYpKQotCQlwbV9ydW50aW1lX3B1dCgmZGV2X3ByaXYtPmRybS5wZGV2LT5kZXYpOwot
fQotCi12b2lkIGludGVsX3Nhbml0aXplX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCi17Ci0JZGV2X3ByaXYtPmd0X3BtLnJwcy5lbmFibGVkID0gdHJ1ZTsg
LyogZm9yY2UgUlBTIGRpc2FibGluZyAqLwotCWRldl9wcml2LT5ndF9wbS5yYzYuZW5hYmxlZCA9
IHRydWU7IC8qIGZvcmNlIFJDNiBkaXNhYmxpbmcgKi8KLQlpbnRlbF9kaXNhYmxlX2d0X3Bvd2Vy
c2F2ZShkZXZfcHJpdik7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKLQkJZ2Vu
MTFfcmVzZXRfcnBzX2ludGVycnVwdHMoZGV2X3ByaXYpOwotCWVsc2UgaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gNikKLQkJZ2VuNl9yZXNldF9ycHNfaW50ZXJydXB0cyhkZXZfcHJpdik7Ci19
Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9kaXNhYmxlX2xsY19wc3RhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCi17Ci0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+Z3Rf
cG0ucnBzLmxvY2spOwotCi0JaWYgKCFpOTE1LT5ndF9wbS5sbGNfcHN0YXRlLmVuYWJsZWQpCi0J
CXJldHVybjsKLQotCS8qIEN1cnJlbnRseSB0aGVyZSBpcyBubyBIVyBjb25maWd1cmF0aW9uIHRv
IGJlIGRvbmUgdG8gZGlzYWJsZS4gKi8KLQotCWk5MTUtPmd0X3BtLmxsY19wc3RhdGUuZW5hYmxl
ZCA9IGZhbHNlOwotfQotCi1zdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX3JjNihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3By
aXYtPmd0X3BtLnJwcy5sb2NrKTsKLQotCWlmICghZGV2X3ByaXYtPmd0X3BtLnJjNi5lbmFibGVk
KQotCQlyZXR1cm47Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQotCQlnZW45X2Rp
c2FibGVfcmM2KGRldl9wcml2KTsKLQllbHNlIGlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkK
LQkJY2hlcnJ5dmlld19kaXNhYmxlX3JjNihkZXZfcHJpdik7Ci0JZWxzZSBpZiAoSVNfVkFMTEVZ
VklFVyhkZXZfcHJpdikpCi0JCXZhbGxleXZpZXdfZGlzYWJsZV9yYzYoZGV2X3ByaXYpOwotCWVs
c2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikKLQkJZ2VuNl9kaXNhYmxlX3JjNihkZXZf
cHJpdik7Ci0KLQlkZXZfcHJpdi0+Z3RfcG0ucmM2LmVuYWJsZWQgPSBmYWxzZTsKLX0KLQotc3Rh
dGljIHZvaWQgaW50ZWxfZGlzYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQotewotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5ndF9wbS5ycHMubG9jayk7
Ci0KLQlpZiAoIWRldl9wcml2LT5ndF9wbS5ycHMuZW5hYmxlZCkKLQkJcmV0dXJuOwotCi0JaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKLQkJZ2VuOV9kaXNhYmxlX3JwcyhkZXZfcHJpdik7
Ci0JZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCi0JCWNoZXJyeXZpZXdfZGlzYWJs
ZV9ycHMoZGV2X3ByaXYpOwotCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQotCQl2
YWxsZXl2aWV3X2Rpc2FibGVfcnBzKGRldl9wcml2KTsKLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpID49IDYpCi0JCWdlbjZfZGlzYWJsZV9ycHMoZGV2X3ByaXYpOwotCWVsc2UgaWYgKElT
X0lST05MQUtFX00oZGV2X3ByaXYpKQotCQlpcm9ubGFrZV9kaXNhYmxlX2RycHMoZGV2X3ByaXYp
OwotCi0JZGV2X3ByaXYtPmd0X3BtLnJwcy5lbmFibGVkID0gZmFsc2U7Ci19Ci0KLXZvaWQgaW50
ZWxfZGlzYWJsZV9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQotewotCW11dGV4X2xvY2soJmRldl9wcml2LT5ndF9wbS5ycHMubG9jayk7Ci0KLQlpbnRlbF9k
aXNhYmxlX3JjNihkZXZfcHJpdik7Ci0JaW50ZWxfZGlzYWJsZV9ycHMoZGV2X3ByaXYpOwotCWlm
IChIQVNfTExDKGRldl9wcml2KSkKLQkJaW50ZWxfZGlzYWJsZV9sbGNfcHN0YXRlKGRldl9wcml2
KTsKLQotCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKLX0KLQotc3Rh
dGljIGlubGluZSB2b2lkIGludGVsX2VuYWJsZV9sbGNfcHN0YXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQotewotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmd0X3BtLnJwcy5s
b2NrKTsKLQotCWlmIChpOTE1LT5ndF9wbS5sbGNfcHN0YXRlLmVuYWJsZWQpCi0JCXJldHVybjsK
LQotCWdlbjZfdXBkYXRlX3JpbmdfZnJlcShpOTE1KTsKLQotCWk5MTUtPmd0X3BtLmxsY19wc3Rh
dGUuZW5hYmxlZCA9IHRydWU7Ci19Ci0KLXN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9yYzYoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCWxvY2tkZXBfYXNzZXJ0X2hlbGQo
JmRldl9wcml2LT5ndF9wbS5ycHMubG9jayk7Ci0KLQlpZiAoZGV2X3ByaXYtPmd0X3BtLnJjNi5l
bmFibGVkKQotCQlyZXR1cm47Ci0KLQlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCi0JCWNo
ZXJyeXZpZXdfZW5hYmxlX3JjNihkZXZfcHJpdik7Ci0JZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhk
ZXZfcHJpdikpCi0JCXZhbGxleXZpZXdfZW5hYmxlX3JjNihkZXZfcHJpdik7Ci0JZWxzZSBpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKLQkJZ2VuMTFfZW5hYmxlX3JjNihkZXZfcHJpdik7
Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KQotCQlnZW45X2VuYWJsZV9yYzYo
ZGV2X3ByaXYpOwotCWVsc2UgaWYgKElTX0JST0FEV0VMTChkZXZfcHJpdikpCi0JCWdlbjhfZW5h
YmxlX3JjNihkZXZfcHJpdik7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2KQot
CQlnZW42X2VuYWJsZV9yYzYoZGV2X3ByaXYpOwotCi0JZGV2X3ByaXYtPmd0X3BtLnJjNi5lbmFi
bGVkID0gdHJ1ZTsKLX0KLQotc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRl
dl9wcml2LT5ndF9wbS5ycHM7Ci0KLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZycHMtPmxvY2spOwot
Ci0JaWYgKHJwcy0+ZW5hYmxlZCkKLQkJcmV0dXJuOwotCi0JaWYgKElTX0NIRVJSWVZJRVcoZGV2
X3ByaXYpKSB7Ci0JCWNoZXJyeXZpZXdfZW5hYmxlX3JwcyhkZXZfcHJpdik7Ci0JfSBlbHNlIGlm
IChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkgewotCQl2YWxsZXl2aWV3X2VuYWJsZV9ycHMoZGV2
X3ByaXYpOwotCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Ci0JCWdlbjlf
ZW5hYmxlX3JwcyhkZXZfcHJpdik7Ci0JfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYp
KSB7Ci0JCWdlbjhfZW5hYmxlX3JwcyhkZXZfcHJpdik7Ci0JfSBlbHNlIGlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDYpIHsKLQkJZ2VuNl9lbmFibGVfcnBzKGRldl9wcml2KTsKLQl9IGVsc2Ug
aWYgKElTX0lST05MQUtFX00oZGV2X3ByaXYpKSB7Ci0JCWlyb25sYWtlX2VuYWJsZV9kcnBzKGRl
dl9wcml2KTsKLQkJaW50ZWxfaW5pdF9lbW9uKGRldl9wcml2KTsKLQl9Ci0KLQlXQVJOX09OKHJw
cy0+bWF4X2ZyZXEgPCBycHMtPm1pbl9mcmVxKTsKLQlXQVJOX09OKHJwcy0+aWRsZV9mcmVxID4g
cnBzLT5tYXhfZnJlcSk7Ci0KLQlXQVJOX09OKHJwcy0+ZWZmaWNpZW50X2ZyZXEgPCBycHMtPm1p
bl9mcmVxKTsKLQlXQVJOX09OKHJwcy0+ZWZmaWNpZW50X2ZyZXEgPiBycHMtPm1heF9mcmVxKTsK
LQotCXJwcy0+ZW5hYmxlZCA9IHRydWU7Ci19Ci0KLXZvaWQgaW50ZWxfZW5hYmxlX2d0X3Bvd2Vy
c2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JLyogUG93ZXJzYXZp
bmcgaXMgY29udHJvbGxlZCBieSB0aGUgaG9zdCB3aGVuIGluc2lkZSBhIFZNICovCi0JaWYgKGlu
dGVsX3ZncHVfYWN0aXZlKGRldl9wcml2KSkKLQkJcmV0dXJuOwotCi0JbXV0ZXhfbG9jaygmZGV2
X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKLQotCWlmIChIQVNfUkM2KGRldl9wcml2KSkKLQkJaW50
ZWxfZW5hYmxlX3JjNihkZXZfcHJpdik7Ci0JaWYgKEhBU19SUFMoZGV2X3ByaXYpKQotCQlpbnRl
bF9lbmFibGVfcnBzKGRldl9wcml2KTsKLQlpZiAoSEFTX0xMQyhkZXZfcHJpdikpCi0JCWludGVs
X2VuYWJsZV9sbGNfcHN0YXRlKGRldl9wcml2KTsKLQotCW11dGV4X3VubG9jaygmZGV2X3ByaXYt
Pmd0X3BtLnJwcy5sb2NrKTsKLX0KLQotc3RhdGljIHZvaWQgaWJ4X2luaXRfY2xvY2tfZ2F0aW5n
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQkvKgotCSAqIE9uIEliZXgg
UGVhayBhbmQgQ291Z2FyIFBvaW50LCB3ZSBuZWVkIHRvIGRpc2FibGUgY2xvY2sKLQkgKiBnYXRp
bmcgZm9yIHRoZSBwYW5lbCBwb3dlciBzZXF1ZW5jZXIgb3IgaXQgd2lsbCBmYWlsIHRvCi0JICog
c3RhcnQgdXAgd2hlbiBubyBwb3J0cyBhcmUgYWN0aXZlLgotCSAqLwotCUk5MTVfV1JJVEUoU09V
VEhfRFNQQ0xLX0dBVEVfRCwgUENIX0RQTFNVTklUX0NMT0NLX0dBVEVfRElTQUJMRSk7Ci19Ci0K
LXN0YXRpYyB2b2lkIGc0eF9kaXNhYmxlX3RyaWNrbGVfZmVlZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCi17Ci0JZW51bSBwaXBlIHBpcGU7Ci0KLQlmb3JfZWFjaF9waXBlKGRl
dl9wcml2LCBwaXBlKSB7Ci0JCUk5MTVfV1JJVEUoRFNQQ05UUihwaXBlKSwKLQkJCSAgIEk5MTVf
UkVBRChEU1BDTlRSKHBpcGUpKSB8Ci0JCQkgICBESVNQUExBTkVfVFJJQ0tMRV9GRUVEX0RJU0FC
TEUpOwotCi0JCUk5MTVfV1JJVEUoRFNQU1VSRihwaXBlKSwgSTkxNV9SRUFEKERTUFNVUkYocGlw
ZSkpKTsKLQkJUE9TVElOR19SRUFEKERTUFNVUkYocGlwZSkpOwotCX0KLX0KLQotc3RhdGljIHZv
aWQgaWxrX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKLXsKLQl1MzIgZHNwY2xrX2dhdGUgPSBJTEtfVlJIVU5JVF9DTE9DS19HQVRFX0RJU0FCTEU7
Ci0KLQkvKgotCSAqIFJlcXVpcmVkIGZvciBGQkMKLQkgKiBXYUZiY0Rpc2FibGVEcGZjQ2xvY2tH
YXRpbmc6aWxrCi0JICovCi0JZHNwY2xrX2dhdGUgfD0gSUxLX0RQRkNSVU5JVF9DTE9DS19HQVRF
X0RJU0FCTEUgfAotCQkgICBJTEtfRFBGQ1VOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFIHwKLQkJICAg
SUxLX0RQRkRVTklUX0NMT0NLX0dBVEVfRU5BQkxFOwotCi0JSTkxNV9XUklURShQQ0hfM0RDR0RJ
UzAsCi0JCSAgIE1BUklVTklUX0NMT0NLX0dBVEVfRElTQUJMRSB8Ci0JCSAgIFNWU01VTklUX0NM
T0NLX0dBVEVfRElTQUJMRSk7Ci0JSTkxNV9XUklURShQQ0hfM0RDR0RJUzEsCi0JCSAgIFZGTVVO
SVRfQ0xPQ0tfR0FURV9ESVNBQkxFKTsKLQotCS8qCi0JICogQWNjb3JkaW5nIHRvIHRoZSBzcGVj
IHRoZSBmb2xsb3dpbmcgYml0cyBzaG91bGQgYmUgc2V0IGluCi0JICogb3JkZXIgdG8gZW5hYmxl
IG1lbW9yeSBzZWxmLXJlZnJlc2gKLQkgKiBUaGUgYml0IDIyLzIxIG9mIDB4NDIwMDQKLQkgKiBU
aGUgYml0IDUgb2YgMHg0MjAyMAotCSAqIFRoZSBiaXQgMTUgb2YgMHg0NTAwMAotCSAqLwotCUk5
MTVfV1JJVEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIsCi0JCSAgIChJOTE1X1JFQUQoSUxLX0RJU1BM
QVlfQ0hJQ0tFTjIpIHwKLQkJICAgIElMS19EUEFSQl9HQVRFIHwgSUxLX1ZTRFBGRF9GVUxMKSk7
Ci0JZHNwY2xrX2dhdGUgfD0gSUxLX0RQQVJCVU5JVF9DTE9DS19HQVRFX0VOQUJMRTsKLQlJOTE1
X1dSSVRFKERJU1BfQVJCX0NUTCwKLQkJICAgKEk5MTVfUkVBRChESVNQX0FSQl9DVEwpIHwKLQkJ
ICAgIERJU1BfRkJDX1dNX0RJUykpOwotCi0JLyoKLQkgKiBCYXNlZCBvbiB0aGUgZG9jdW1lbnQg
ZnJvbSBoYXJkd2FyZSBndXlzIHRoZSBmb2xsb3dpbmcgYml0cwotCSAqIHNob3VsZCBiZSBzZXQg
dW5jb25kaXRpb25hbGx5IGluIG9yZGVyIHRvIGVuYWJsZSBGQkMuCi0JICogVGhlIGJpdCAyMiBv
ZiAweDQyMDAwCi0JICogVGhlIGJpdCAyMiBvZiAweDQyMDA0Ci0JICogVGhlIGJpdCA3LDgsOSBv
ZiAweDQyMDIwLgotCSAqLwotCWlmIChJU19JUk9OTEFLRV9NKGRldl9wcml2KSkgewotCQkvKiBX
YUZiY0FzeW5jaEZsaXBEaXNhYmxlRmJjUXVldWU6aWxrICovCi0JCUk5MTVfV1JJVEUoSUxLX0RJ
U1BMQVlfQ0hJQ0tFTjEsCi0JCQkgICBJOTE1X1JFQUQoSUxLX0RJU1BMQVlfQ0hJQ0tFTjEpIHwK
LQkJCSAgIElMS19GQkNRX0RJUyk7Ci0JCUk5MTVfV1JJVEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIs
Ci0JCQkgICBJOTE1X1JFQUQoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIpIHwKLQkJCSAgIElMS19EUEFS
Ql9HQVRFKTsKLQl9Ci0KLQlJOTE1X1dSSVRFKElMS19EU1BDTEtfR0FURV9ELCBkc3BjbGtfZ2F0
ZSk7Ci0KLQlJOTE1X1dSSVRFKElMS19ESVNQTEFZX0NISUNLRU4yLAotCQkgICBJOTE1X1JFQUQo
SUxLX0RJU1BMQVlfQ0hJQ0tFTjIpIHwKLQkJICAgSUxLX0VMUElOXzQwOV9TRUxFQ1QpOwotCUk5
MTVfV1JJVEUoXzNEX0NISUNLRU4yLAotCQkgICBfM0RfQ0hJQ0tFTjJfV01fUkVBRF9QSVBFTElO
RUQgPDwgMTYgfAotCQkgICBfM0RfQ0hJQ0tFTjJfV01fUkVBRF9QSVBFTElORUQpOwotCi0JLyog
V2FEaXNhYmxlUmVuZGVyQ2FjaGVQaXBlbGluZWRGbHVzaDppbGsgKi8KLQlJOTE1X1dSSVRFKENB
Q0hFX01PREVfMCwKLQkJICAgX01BU0tFRF9CSVRfRU5BQkxFKENNMF9QSVBFTElORURfUkVOREVS
X0ZMVVNIX0RJU0FCTEUpKTsKLQotCS8qIFdhRGlzYWJsZV9SZW5kZXJDYWNoZV9PcGVyYXRpb25h
bEZsdXNoOmlsayAqLwotCUk5MTVfV1JJVEUoQ0FDSEVfTU9ERV8wLCBfTUFTS0VEX0JJVF9ESVNB
QkxFKFJDX09QX0ZMVVNIX0VOQUJMRSkpOwotCi0JZzR4X2Rpc2FibGVfdHJpY2tsZV9mZWVkKGRl
dl9wcml2KTsKLQotCWlieF9pbml0X2Nsb2NrX2dhdGluZyhkZXZfcHJpdik7Ci19Ci0KLXN0YXRp
YyB2b2lkIGNwdF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCi17Ci0JaW50IHBpcGU7Ci0JdTMyIHZhbDsKLQotCS8qCi0JICogT24gSWJleCBQZWFr
IGFuZCBDb3VnYXIgUG9pbnQsIHdlIG5lZWQgdG8gZGlzYWJsZSBjbG9jawotCSAqIGdhdGluZyBm
b3IgdGhlIHBhbmVsIHBvd2VyIHNlcXVlbmNlciBvciBpdCB3aWxsIGZhaWwgdG8KLQkgKiBzdGFy
dCB1cCB3aGVuIG5vIHBvcnRzIGFyZSBhY3RpdmUuCi0JICovCi0JSTkxNV9XUklURShTT1VUSF9E
U1BDTEtfR0FURV9ELCBQQ0hfRFBMU1VOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFIHwKLQkJICAgUENI
X0RQTFVOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFIHwKLQkJICAgUENIX0NQVU5JVF9DTE9DS19HQVRF
X0RJU0FCTEUpOwotCUk5MTVfV1JJVEUoU09VVEhfQ0hJQ0tFTjIsIEk5MTVfUkVBRChTT1VUSF9D
SElDS0VOMikgfAotCQkgICBEUExTX0VEUF9QUFNfRklYX0RJUyk7Ci0JLyogVGhlIGJlbG93IGZp
eGVzIHRoZSB3ZWlyZCBkaXNwbGF5IGNvcnJ1cHRpb24sIGEgZmV3IHBpeGVscyBzaGlmdGVkCi0J
ICogZG93bndhcmQsIG9uIChvbmx5KSBMVkRTIG9mIHNvbWUgSFAgbGFwdG9wcyB3aXRoIElWWS4K
LQkgKi8KLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Ci0JCXZhbCA9IEk5MTVfUkVB
RChUUkFOU19DSElDS0VOMihwaXBlKSk7Ci0JCXZhbCB8PSBUUkFOU19DSElDS0VOMl9USU1JTkdf
T1ZFUlJJREU7Ci0JCXZhbCAmPSB+VFJBTlNfQ0hJQ0tFTjJfRkRJX1BPTEFSSVRZX1JFVkVSU0VE
OwotCQlpZiAoZGV2X3ByaXYtPnZidC5mZGlfcnhfcG9sYXJpdHlfaW52ZXJ0ZWQpCi0JCQl2YWwg
fD0gVFJBTlNfQ0hJQ0tFTjJfRkRJX1BPTEFSSVRZX1JFVkVSU0VEOwotCQl2YWwgJj0gflRSQU5T
X0NISUNLRU4yX0ZSQU1FX1NUQVJUX0RFTEFZX01BU0s7Ci0JCXZhbCAmPSB+VFJBTlNfQ0hJQ0tF
TjJfRElTQUJMRV9ERUVQX0NPTE9SX0NPVU5URVI7Ci0JCXZhbCAmPSB+VFJBTlNfQ0hJQ0tFTjJf
RElTQUJMRV9ERUVQX0NPTE9SX01PREVTV0lUQ0g7Ci0JCUk5MTVfV1JJVEUoVFJBTlNfQ0hJQ0tF
TjIocGlwZSksIHZhbCk7Ci0JfQotCS8qIFdBRFAwQ2xvY2tHYXRpbmdEaXNhYmxlICovCi0JZm9y
X2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewotCQlJOTE1X1dSSVRFKFRSQU5TX0NISUNLRU4x
KHBpcGUpLAotCQkJICAgVFJBTlNfQ0hJQ0tFTjFfRFAwVU5JVF9HQ19ESVNBQkxFKTsKLQl9Ci19
Ci0KLXN0YXRpYyB2b2lkIGdlbjZfY2hlY2tfbWNoX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKLXsKLQl1MzIgdG1wOwotCi0JdG1wID0gSTkxNV9SRUFEKE1DSF9TU0tQ
RCk7Ci0JaWYgKCh0bXAgJiBNQ0hfU1NLUERfV00wX01BU0spICE9IE1DSF9TU0tQRF9XTTBfVkFM
KQotCQlEUk1fREVCVUdfS01TKCJXcm9uZyBNQ0hfU1NLUEQgdmFsdWU6IDB4JTA4eCBUaGlzIGNh
biBjYXVzZSB1bmRlcnJ1bnMuXG4iLAotCQkJICAgICAgdG1wKTsKLX0KLQotc3RhdGljIHZvaWQg
Z2VuNl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Ci17Ci0JdTMyIGRzcGNsa19nYXRlID0gSUxLX1ZSSFVOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFOwot
Ci0JSTkxNV9XUklURShJTEtfRFNQQ0xLX0dBVEVfRCwgZHNwY2xrX2dhdGUpOwotCi0JSTkxNV9X
UklURShJTEtfRElTUExBWV9DSElDS0VOMiwKLQkJICAgSTkxNV9SRUFEKElMS19ESVNQTEFZX0NI
SUNLRU4yKSB8Ci0JCSAgIElMS19FTFBJTl80MDlfU0VMRUNUKTsKLQotCS8qIFdhRGlzYWJsZUhp
WlBsYW5lc1doZW5NU0FBRW5hYmxlZDpzbmIgKi8KLQlJOTE1X1dSSVRFKF8zRF9DSElDS0VOLAot
CQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoXzNEX0NISUNLRU5fSElaX1BMQU5FX0RJU0FCTEVfTVNB
QV80WF9TTkIpKTsKLQotCS8qIFdhRGlzYWJsZV9SZW5kZXJDYWNoZV9PcGVyYXRpb25hbEZsdXNo
OnNuYiAqLwotCUk5MTVfV1JJVEUoQ0FDSEVfTU9ERV8wLCBfTUFTS0VEX0JJVF9ESVNBQkxFKFJD
X09QX0ZMVVNIX0VOQUJMRSkpOwotCi0JLyoKLQkgKiBCU3BlYyByZWNvb21lbmRzIDh4NCB3aGVu
IE1TQUEgaXMgdXNlZCwKLQkgKiBob3dldmVyIGluIHByYWN0aWNlIDE2eDQgc2VlbXMgZmFzdGVz
dC4KLQkgKgotCSAqIE5vdGUgdGhhdCBQUy9XTSB0aHJlYWQgY291bnRzIGRlcGVuZCBvbiB0aGUg
V0laIGhhc2hpbmcKLQkgKiBkaXNhYmxlIGJpdCwgd2hpY2ggd2UgZG9uJ3QgdG91Y2ggaGVyZSwg
YnV0IGl0J3MgZ29vZAotCSAqIHRvIGtlZXAgaW4gbWluZCAoc2VlIDNEU1RBVEVfUFMgYW5kIDNE
U1RBVEVfV00pLgotCSAqLwotCUk5MTVfV1JJVEUoR0VONl9HVF9NT0RFLAotCQkgICBfTUFTS0VE
X0ZJRUxEKEdFTjZfV0laX0hBU0hJTkdfTUFTSywgR0VONl9XSVpfSEFTSElOR18xNng0KSk7Ci0K
LQlJOTE1X1dSSVRFKENBQ0hFX01PREVfMCwKLQkJICAgX01BU0tFRF9CSVRfRElTQUJMRShDTTBf
U1RDX0VWSUNUX0RJU0FCTEVfTFJBX1NOQikpOwotCi0JSTkxNV9XUklURShHRU42X1VDR0NUTDEs
Ci0JCSAgIEk5MTVfUkVBRChHRU42X1VDR0NUTDEpIHwKLQkJICAgR0VONl9CTEJVTklUX0NMT0NL
X0dBVEVfRElTQUJMRSB8Ci0JCSAgIEdFTjZfQ1NVTklUX0NMT0NLX0dBVEVfRElTQUJMRSk7Ci0K
LQkvKiBBY2NvcmRpbmcgdG8gdGhlIEJTcGVjIHZvbDFnLCBiaXQgMTIgKFJDUEJVTklUKSBjbG9j
awotCSAqIGdhdGluZyBkaXNhYmxlIG11c3QgYmUgc2V0LiAgRmFpbHVyZSB0byBzZXQgaXQgcmVz
dWx0cyBpbgotCSAqIGZsaWNrZXJpbmcgcGl4ZWxzIGR1ZSB0byBaIHdyaXRlIG9yZGVyaW5nIGZh
aWx1cmVzIGFmdGVyCi0JICogc29tZSBhbW91bnQgb2YgcnVudGltZSBpbiB0aGUgTWVzYSAiZmly
ZSIgZGVtbywgYW5kIFVuaWdpbmUKLQkgKiBTYW5jdHVhcnkgYW5kIFRyb3BpY3MsIGFuZCBhcHBh
cmVudGx5IGFueXRoaW5nIGVsc2Ugd2l0aAotCSAqIGFscGhhIHRlc3Qgb3IgcGl4ZWwgZGlzY2Fy
ZC4KLQkgKgotCSAqIEFjY29yZGluZyB0byB0aGUgc3BlYywgYml0IDExIChSQ0NVTklUKSBtdXN0
IGFsc28gYmUgc2V0LAotCSAqIGJ1dCB3ZSBkaWRuJ3QgZGVidWcgYWN0dWFsIHRlc3RjYXNlcyB0
byBmaW5kIGl0IG91dC4KLQkgKgotCSAqIFdhRGlzYWJsZVJDQ1VuaXRDbG9ja0dhdGluZzpzbmIK
LQkgKiBXYURpc2FibGVSQ1BCVW5pdENsb2NrR2F0aW5nOnNuYgotCSAqLwotCUk5MTVfV1JJVEUo
R0VONl9VQ0dDVEwyLAotCQkgICBHRU42X1JDUEJVTklUX0NMT0NLX0dBVEVfRElTQUJMRSB8Ci0J
CSAgIEdFTjZfUkNDVU5JVF9DTE9DS19HQVRFX0RJU0FCTEUpOwotCi0JLyogV2FTdHJpcHNGYW5z
RGlzYWJsZUZhc3RDbGlwUGVyZm9ybWFuY2VGaXg6c25iICovCi0JSTkxNV9XUklURShfM0RfQ0hJ
Q0tFTjMsCi0JCSAgIF9NQVNLRURfQklUX0VOQUJMRShfM0RfQ0hJQ0tFTjNfU0ZfRElTQUJMRV9G
QVNUQ0xJUF9DVUxMKSk7Ci0KLQkvKgotCSAqIEJzcGVjIHNheXM6Ci0JICogIlRoaXMgYml0IG11
c3QgYmUgc2V0IGlmIDNEU1RBVEVfQ0xJUCBjbGlwIG1vZGUgaXMgc2V0IHRvIG5vcm1hbCBhbmQK
LQkgKiAzRFNUQVRFX1NGIG51bWJlciBvZiBTRiBvdXRwdXQgYXR0cmlidXRlcyBpcyBtb3JlIHRo
YW4gMTYuIgotCSAqLwotCUk5MTVfV1JJVEUoXzNEX0NISUNLRU4zLAotCQkgICBfTUFTS0VEX0JJ
VF9FTkFCTEUoXzNEX0NISUNLRU4zX1NGX0RJU0FCTEVfUElQRUxJTkVEX0FUVFJfRkVUQ0gpKTsK
LQotCS8qCi0JICogQWNjb3JkaW5nIHRvIHRoZSBzcGVjIHRoZSBmb2xsb3dpbmcgYml0cyBzaG91
bGQgYmUKLQkgKiBzZXQgaW4gb3JkZXIgdG8gZW5hYmxlIG1lbW9yeSBzZWxmLXJlZnJlc2ggYW5k
IGZiYzoKLQkgKiBUaGUgYml0MjEgYW5kIGJpdDIyIG9mIDB4NDIwMDAKLQkgKiBUaGUgYml0MjEg
YW5kIGJpdDIyIG9mIDB4NDIwMDQKLQkgKiBUaGUgYml0NSBhbmQgYml0NyBvZiAweDQyMDIwCi0J
ICogVGhlIGJpdDE0IG9mIDB4NzAxODAKLQkgKiBUaGUgYml0MTQgb2YgMHg3MTE4MAotCSAqCi0J
ICogV2FGYmNBc3luY2hGbGlwRGlzYWJsZUZiY1F1ZXVlOnNuYgotCSAqLwotCUk5MTVfV1JJVEUo
SUxLX0RJU1BMQVlfQ0hJQ0tFTjEsCi0JCSAgIEk5MTVfUkVBRChJTEtfRElTUExBWV9DSElDS0VO
MSkgfAotCQkgICBJTEtfRkJDUV9ESVMgfCBJTEtfUEFCU1RSRVRDSF9ESVMpOwotCUk5MTVfV1JJ
VEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIsCi0JCSAgIEk5MTVfUkVBRChJTEtfRElTUExBWV9DSElD
S0VOMikgfAotCQkgICBJTEtfRFBBUkJfR0FURSB8IElMS19WU0RQRkRfRlVMTCk7Ci0JSTkxNV9X
UklURShJTEtfRFNQQ0xLX0dBVEVfRCwKLQkJICAgSTkxNV9SRUFEKElMS19EU1BDTEtfR0FURV9E
KSB8Ci0JCSAgIElMS19EUEFSQlVOSVRfQ0xPQ0tfR0FURV9FTkFCTEUgIHwKLQkJICAgSUxLX0RQ
RkRVTklUX0NMT0NLX0dBVEVfRU5BQkxFKTsKLQotCWc0eF9kaXNhYmxlX3RyaWNrbGVfZmVlZChk
ZXZfcHJpdik7Ci0KLQljcHRfaW5pdF9jbG9ja19nYXRpbmcoZGV2X3ByaXYpOwotCi0JZ2VuNl9j
aGVja19tY2hfc2V0dXAoZGV2X3ByaXYpOwotfQotCi1zdGF0aWMgdm9pZCBnZW43X3NldHVwX2Zp
eGVkX2Z1bmNfc2NoZWR1bGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsK
LQl1MzIgcmVnID0gSTkxNV9SRUFEKEdFTjdfRkZfVEhSRUFEX01PREUpOwotCi0JLyoKLQkgKiBX
YVZTVGhyZWFkRGlzcGF0Y2hPdmVycmlkZTppdmIsdmx2Ci0JICoKLQkgKiBUaGlzIGFjdHVhbGx5
IG92ZXJyaWRlcyB0aGUgZGlzcGF0Y2gKLQkgKiBtb2RlIGZvciBhbGwgdGhyZWFkIHR5cGVzLgot
CSAqLwotCXJlZyAmPSB+R0VON19GRl9TQ0hFRF9NQVNLOwotCXJlZyB8PSBHRU43X0ZGX1RTX1ND
SEVEX0hXOwotCXJlZyB8PSBHRU43X0ZGX1ZTX1NDSEVEX0hXOwotCXJlZyB8PSBHRU43X0ZGX0RT
X1NDSEVEX0hXOwotCi0JSTkxNV9XUklURShHRU43X0ZGX1RIUkVBRF9NT0RFLCByZWcpOwotfQot
Ci1zdGF0aWMgdm9pZCBscHRfaW5pdF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQorc3RhdGljIHZvaWQgbHB0X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAkvKgogCSAqIFRPRE86IHRoaXMgYml0IHNo
b3VsZCBvbmx5IGJlIGVuYWJsZWQgd2hlbiByZWFsbHkgbmVlZGVkLCB0aGVuCkBAIC05NzMzLDIx
NyArNzMzNCw4IEBAIHZvaWQgaW50ZWxfaW5pdF9wbShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCiAJfQogfQogCi1zdGF0aWMgaW50IGJ5dF9ncHVfZnJlcShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCB2YWwpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBz
ID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0KLQkvKgotCSAqIE4gPSB2YWwgLSAweGI3Ci0JICog
U2xvdyA9IEZhc3QgPSBHUExMIHJlZiAqIE4KLQkgKi8KLQlyZXR1cm4gRElWX1JPVU5EX0NMT1NF
U1QocnBzLT5ncGxsX3JlZl9mcmVxICogKHZhbCAtIDB4YjcpLCAxMDAwKTsKLX0KLQotc3RhdGlj
IGludCBieXRfZnJlcV9vcGNvZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBp
bnQgdmFsKQotewotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBz
OwotCi0JcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKDEwMDAgKiB2YWwsIHJwcy0+Z3BsbF9yZWZf
ZnJlcSkgKyAweGI3OwotfQotCi1zdGF0aWMgaW50IGNodl9ncHVfZnJlcShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCB2YWwpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBz
ID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0KLQkvKgotCSAqIE4gPSB2YWwgLyAyCi0JICogQ1Ug
KHNsb3cpID0gQ1UyeCAoZmFzdCkgLyAyID0gR1BMTCByZWYgKiBOIC8gMgotCSAqLwotCXJldHVy
biBESVZfUk9VTkRfQ0xPU0VTVChycHMtPmdwbGxfcmVmX2ZyZXEgKiB2YWwsIDIgKiAyICogMTAw
MCk7Ci19Ci0KLXN0YXRpYyBpbnQgY2h2X2ZyZXFfb3Bjb2RlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgaW50IHZhbCkKLXsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2
X3ByaXYtPmd0X3BtLnJwczsKLQotCS8qIENIViBuZWVkcyBldmVuIHZhbHVlcyAqLwotCXJldHVy
biBESVZfUk9VTkRfQ0xPU0VTVCgyICogMTAwMCAqIHZhbCwgcnBzLT5ncGxsX3JlZl9mcmVxKSAq
IDI7Ci19Ci0KLWludCBpbnRlbF9ncHVfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIGludCB2YWwpCi17Ci0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKLQkJcmV0
dXJuIERJVl9ST1VORF9DTE9TRVNUKHZhbCAqIEdUX0ZSRVFVRU5DWV9NVUxUSVBMSUVSLAotCQkJ
CQkgR0VOOV9GUkVRX1NDQUxFUik7Ci0JZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikp
Ci0JCXJldHVybiBjaHZfZ3B1X2ZyZXEoZGV2X3ByaXYsIHZhbCk7Ci0JZWxzZSBpZiAoSVNfVkFM
TEVZVklFVyhkZXZfcHJpdikpCi0JCXJldHVybiBieXRfZ3B1X2ZyZXEoZGV2X3ByaXYsIHZhbCk7
Ci0JZWxzZQotCQlyZXR1cm4gdmFsICogR1RfRlJFUVVFTkNZX01VTFRJUExJRVI7Ci19Ci0KLWlu
dCBpbnRlbF9mcmVxX29wY29kZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGlu
dCB2YWwpCi17Ci0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKLQkJcmV0dXJuIERJVl9S
T1VORF9DTE9TRVNUKHZhbCAqIEdFTjlfRlJFUV9TQ0FMRVIsCi0JCQkJCSBHVF9GUkVRVUVOQ1lf
TVVMVElQTElFUik7Ci0JZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpCi0JCXJldHVy
biBjaHZfZnJlcV9vcGNvZGUoZGV2X3ByaXYsIHZhbCk7Ci0JZWxzZSBpZiAoSVNfVkFMTEVZVklF
VyhkZXZfcHJpdikpCi0JCXJldHVybiBieXRfZnJlcV9vcGNvZGUoZGV2X3ByaXYsIHZhbCk7Ci0J
ZWxzZQotCQlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QodmFsLCBHVF9GUkVRVUVOQ1lfTVVMVElQ
TElFUik7Ci19Ci0KIHZvaWQgaW50ZWxfcG1fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQogewotCW11dGV4X2luaXQoJmRldl9wcml2LT5ndF9wbS5ycHMubG9jayk7Ci0J
bXV0ZXhfaW5pdCgmZGV2X3ByaXYtPmd0X3BtLnJwcy5wb3dlci5tdXRleCk7Ci0KLQlhdG9taWNf
c2V0KCZkZXZfcHJpdi0+Z3RfcG0ucnBzLm51bV93YWl0ZXJzLCAwKTsKLQogCWRldl9wcml2LT5y
dW50aW1lX3BtLnN1c3BlbmRlZCA9IGZhbHNlOwogCWF0b21pY19zZXQoJmRldl9wcml2LT5ydW50
aW1lX3BtLndha2VyZWZfY291bnQsIDApOwogfQotCi1zdGF0aWMgdTY0IHZsdl9yZXNpZGVuY3lf
cmF3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAgICAgY29uc3QgaTkx
NV9yZWdfdCByZWcpCi17Ci0JdTMyIGxvd2VyLCB1cHBlciwgdG1wOwotCWludCBsb29wID0gMjsK
LQotCS8qCi0JICogVGhlIHJlZ2lzdGVyIGFjY2Vzc2VkIGRvIG5vdCBuZWVkIGZvcmNld2FrZS4g
V2UgYm9ycm93Ci0JICogdW5jb3JlIGxvY2sgdG8gcHJldmVudCBjb25jdXJyZW50IGFjY2VzcyB0
byByYW5nZSByZWcuCi0JICovCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPnVuY29y
ZS5sb2NrKTsKLQotCS8qCi0JICogdmx2IGFuZCBjaHYgcmVzaWRlbmN5IGNvdW50ZXJzIGFyZSA0
MCBiaXRzIGluIHdpZHRoLgotCSAqIFdpdGggYSBjb250cm9sIGJpdCwgd2UgY2FuIGNob29zZSBi
ZXR3ZWVuIHVwcGVyIG9yIGxvd2VyCi0JICogMzJiaXQgd2luZG93IGludG8gdGhpcyBjb3VudGVy
LgotCSAqCi0JICogQWx0aG91Z2ggd2UgYWx3YXlzIHVzZSB0aGUgY291bnRlciBpbiBoaWdoLXJh
bmdlIG1vZGUgZWxzZXdoZXJlLAotCSAqIHVzZXJzcGFjZSBtYXkgYXR0ZW1wdCB0byByZWFkIHRo
ZSB2YWx1ZSBiZWZvcmUgcmM2IGlzIGluaXRpYWxpc2VkLAotCSAqIGJlZm9yZSB3ZSBoYXZlIHNl
dCB0aGUgZGVmYXVsdCBWTFZfQ09VTlRFUl9DT05UUk9MIHZhbHVlLiBTbyBhbHdheXMKLQkgKiBz
ZXQgdGhlIGhpZ2ggYml0IHRvIGJlIHNhZmUuCi0JICovCi0JSTkxNV9XUklURV9GVyhWTFZfQ09V
TlRFUl9DT05UUk9MLAotCQkgICAgICBfTUFTS0VEX0JJVF9FTkFCTEUoVkxWX0NPVU5UX1JBTkdF
X0hJR0gpKTsKLQl1cHBlciA9IEk5MTVfUkVBRF9GVyhyZWcpOwotCWRvIHsKLQkJdG1wID0gdXBw
ZXI7Ci0KLQkJSTkxNV9XUklURV9GVyhWTFZfQ09VTlRFUl9DT05UUk9MLAotCQkJICAgICAgX01B
U0tFRF9CSVRfRElTQUJMRShWTFZfQ09VTlRfUkFOR0VfSElHSCkpOwotCQlsb3dlciA9IEk5MTVf
UkVBRF9GVyhyZWcpOwotCi0JCUk5MTVfV1JJVEVfRlcoVkxWX0NPVU5URVJfQ09OVFJPTCwKLQkJ
CSAgICAgIF9NQVNLRURfQklUX0VOQUJMRShWTFZfQ09VTlRfUkFOR0VfSElHSCkpOwotCQl1cHBl
ciA9IEk5MTVfUkVBRF9GVyhyZWcpOwotCX0gd2hpbGUgKHVwcGVyICE9IHRtcCAmJiAtLWxvb3Ap
OwotCi0JLyoKLQkgKiBFdmVyeXdoZXJlIGVsc2Ugd2UgYWx3YXlzIHVzZSBWTFZfQ09VTlRFUl9D
T05UUk9MIHdpdGggdGhlCi0JICogVkxWX0NPVU5UX1JBTkdFX0hJR0ggYml0IHNldCAtIHNvIGl0
IGlzIHNhZmUgdG8gbGVhdmUgaXQgc2V0Ci0JICogbm93LgotCSAqLwotCi0JcmV0dXJuIGxvd2Vy
IHwgKHU2NCl1cHBlciA8PCA4OwotfQotCi11NjQgaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkgICBjb25zdCBpOTE1X3JlZ190IHJl
ZykKLXsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsK
LQl1NjQgdGltZV9odywgcHJldl9odywgb3ZlcmZsb3dfaHc7Ci0JdW5zaWduZWQgaW50IGZ3X2Rv
bWFpbnM7Ci0JdW5zaWduZWQgbG9uZyBmbGFnczsKLQl1bnNpZ25lZCBpbnQgaTsKLQl1MzIgbXVs
LCBkaXY7Ci0KLQlpZiAoIUhBU19SQzYoZGV2X3ByaXYpKQotCQlyZXR1cm4gMDsKLQotCS8qCi0J
ICogU3RvcmUgcHJldmlvdXMgaHcgY291bnRlciB2YWx1ZXMgZm9yIGNvdW50ZXIgd3JhcC1hcm91
bmQgaGFuZGxpbmcuCi0JICoKLQkgKiBUaGVyZSBhcmUgb25seSBmb3VyIGludGVyZXN0aW5nIHJl
Z2lzdGVycyBhbmQgdGhleSBsaXZlIG5leHQgdG8gZWFjaAotCSAqIG90aGVyIHNvIHdlIGNhbiB1
c2UgdGhlIHJlbGF0aXZlIGFkZHJlc3MsIGNvbXBhcmVkIHRvIHRoZSBzbWFsbGVzdAotCSAqIG9u
ZSBhcyB0aGUgaW5kZXggaW50byBkcml2ZXIgc3RvcmFnZS4KLQkgKi8KLQlpID0gKGk5MTVfbW1p
b19yZWdfb2Zmc2V0KHJlZykgLQotCSAgICAgaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VONl9HVF9H
RlhfUkM2X0xPQ0tFRCkpIC8gc2l6ZW9mKHUzMik7Ci0JaWYgKFdBUk5fT05fT05DRShpID49IEFS
UkFZX1NJWkUoZGV2X3ByaXYtPmd0X3BtLnJjNi5jdXJfcmVzaWRlbmN5KSkpCi0JCXJldHVybiAw
OwotCi0JZndfZG9tYWlucyA9IGludGVsX3VuY29yZV9mb3JjZXdha2VfZm9yX3JlZyh1bmNvcmUs
IHJlZywgRldfUkVHX1JFQUQpOwotCi0Jc3Bpbl9sb2NrX2lycXNhdmUoJnVuY29yZS0+bG9jaywg
ZmxhZ3MpOwotCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0X19sb2NrZWQodW5jb3JlLCBmd19k
b21haW5zKTsKLQotCS8qIE9uIFZMViBhbmQgQ0hWLCByZXNpZGVuY3kgdGltZSBpcyBpbiBDWiB1
bml0cyByYXRoZXIgdGhhbiAxLjI4dXMgKi8KLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikg
fHwgSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKLQkJbXVsID0gMTAwMDAwMDsKLQkJZGl2ID0g
ZGV2X3ByaXYtPmN6Y2xrX2ZyZXE7Ci0JCW92ZXJmbG93X2h3ID0gQklUX1VMTCg0MCk7Ci0JCXRp
bWVfaHcgPSB2bHZfcmVzaWRlbmN5X3JhdyhkZXZfcHJpdiwgcmVnKTsKLQl9IGVsc2UgewotCQkv
KiA4MzMuMzNucyB1bml0cyBvbiBHZW45TFAsIDEuMjh1cyBlbHNld2hlcmUuICovCi0JCWlmIChJ
U19HRU45X0xQKGRldl9wcml2KSkgewotCQkJbXVsID0gMTAwMDA7Ci0JCQlkaXYgPSAxMjsKLQkJ
fSBlbHNlIHsKLQkJCW11bCA9IDEyODA7Ci0JCQlkaXYgPSAxOwotCQl9Ci0KLQkJb3ZlcmZsb3df
aHcgPSBCSVRfVUxMKDMyKTsKLQkJdGltZV9odyA9IGludGVsX3VuY29yZV9yZWFkX2Z3KHVuY29y
ZSwgcmVnKTsKLQl9Ci0KLQkvKgotCSAqIENvdW50ZXIgd3JhcCBoYW5kbGluZy4KLQkgKgotCSAq
IEJ1dCByZWx5aW5nIG9uIGEgc3VmZmljaWVudCBmcmVxdWVuY3kgb2YgcXVlcmllcyBvdGhlcndp
c2UgY291bnRlcnMKLQkgKiBjYW4gc3RpbGwgd3JhcC4KLQkgKi8KLQlwcmV2X2h3ID0gZGV2X3By
aXYtPmd0X3BtLnJjNi5wcmV2X2h3X3Jlc2lkZW5jeVtpXTsKLQlkZXZfcHJpdi0+Z3RfcG0ucmM2
LnByZXZfaHdfcmVzaWRlbmN5W2ldID0gdGltZV9odzsKLQotCS8qIFJDNiBkZWx0YSBmcm9tIGxh
c3Qgc2FtcGxlLiAqLwotCWlmICh0aW1lX2h3ID49IHByZXZfaHcpCi0JCXRpbWVfaHcgLT0gcHJl
dl9odzsKLQllbHNlCi0JCXRpbWVfaHcgKz0gb3ZlcmZsb3dfaHcgLSBwcmV2X2h3OwotCi0JLyog
QWRkIGRlbHRhIHRvIFJDNiBleHRlbmRlZCByYXcgZHJpdmVyIGNvcHkuICovCi0JdGltZV9odyAr
PSBkZXZfcHJpdi0+Z3RfcG0ucmM2LmN1cl9yZXNpZGVuY3lbaV07Ci0JZGV2X3ByaXYtPmd0X3Bt
LnJjNi5jdXJfcmVzaWRlbmN5W2ldID0gdGltZV9odzsKLQotCWludGVsX3VuY29yZV9mb3JjZXdh
a2VfcHV0X19sb2NrZWQodW5jb3JlLCBmd19kb21haW5zKTsKLQlzcGluX3VubG9ja19pcnFyZXN0
b3JlKCZ1bmNvcmUtPmxvY2ssIGZsYWdzKTsKLQotCXJldHVybiBtdWxfdTY0X3UzMl9kaXYodGlt
ZV9odywgbXVsLCBkaXYpOwotfQotCi11NjQgaW50ZWxfcmM2X3Jlc2lkZW5jeV91cyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkgICBpOTE1X3JlZ190IHJlZykKLXsKLQly
ZXR1cm4gRElWX1JPVU5EX1VQX1VMTChpbnRlbF9yYzZfcmVzaWRlbmN5X25zKGRldl9wcml2LCBy
ZWcpLCAxMDAwKTsKLX0KLQotdTMyIGludGVsX2dldF9jYWdmKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwgdTMyIHJwc3RhdCkKLXsKLQl1MzIgY2FnZjsKLQotCWlmIChJTlRFTF9H
RU4oZGV2X3ByaXYpID49IDkpCi0JCWNhZ2YgPSAocnBzdGF0ICYgR0VOOV9DQUdGX01BU0spID4+
IEdFTjlfQ0FHRl9TSElGVDsKLQllbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19C
Uk9BRFdFTEwoZGV2X3ByaXYpKQotCQljYWdmID0gKHJwc3RhdCAmIEhTV19DQUdGX01BU0spID4+
IEhTV19DQUdGX1NISUZUOwotCWVsc2UKLQkJY2FnZiA9IChycHN0YXQgJiBHRU42X0NBR0ZfTUFT
SykgPj4gR0VONl9DQUdGX1NISUZUOwotCi0JcmV0dXJuICBjYWdmOwotfQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX3BtLmgKaW5kZXggZTM1NzNlMWUxNmUzLi5iNTZlNjI4NWQxYzMgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfcG0uaApAQCAtMjksMTYgKzI5LDYgQEAgdm9pZCBpbnRlbF91cGRhdGVfd2F0ZXJtYXJr
cyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0Yyk7CiB2b2lkIGludGVsX2luaXRfcG0oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIHZvaWQgaW50ZWxfaW5pdF9jbG9ja19nYXRpbmdf
aG9va3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIHZvaWQgaW50ZWxfcG1f
c2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQgaW50ZWxfZ3B1
X2lwc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12b2lkIGludGVs
X2dwdV9pcHNfdGVhcmRvd24odm9pZCk7Ci12b2lkIGludGVsX2luaXRfZ3RfcG93ZXJzYXZlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12b2lkIGludGVsX2NsZWFudXBfZ3Rf
cG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12b2lkIGludGVs
X3Nhbml0aXplX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owotdm9pZCBpbnRlbF9lbmFibGVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Ci12b2lkIGludGVsX2Rpc2FibGVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12b2lkIGdlbjZfcnBzX2J1c3koc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQgZ2VuNl9ycHNfaWRsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBnZW42X3Jwc19ib29zdChzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSk7CiB2b2lkIGc0eF93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KTsKIHZvaWQgdmx2X3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBpbGtfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CkBAIC03MCwyMSArNjAsNiBAQCBpbnQgc2tsX2No
ZWNrX3BpcGVfbWF4X3BpeGVsX3JhdGUoc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCiB2
b2lkIGludGVsX2luaXRfaXBjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiB2
b2lkIGludGVsX2VuYWJsZV9pcGMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsK
IAotaW50IGludGVsX2dwdV9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwg
aW50IHZhbCk7Ci1pbnQgaW50ZWxfZnJlcV9vcGNvZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCBpbnQgdmFsKTsKLXU2NCBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaTkxNV9yZWdfdCByZWcpOwotdTY0IGludGVsX3Jj
Nl9yZXNpZGVuY3lfdXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpOTE1X3Jl
Z190IHJlZyk7Ci0KLXUzMiBpbnRlbF9nZXRfY2FnZihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsIHUzMiBycHN0YXQxKTsKLQotdW5zaWduZWQgbG9uZyBpOTE1X2NoaXBzZXRfdmFs
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci11bnNpZ25lZCBsb25nIGk5MTVf
bWNoX3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdW5zaWduZWQgbG9u
ZyBpOTE1X2dmeF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQg
aTkxNV91cGRhdGVfZ2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwot
Ci1ib29sIGlyb25sYWtlX3NldF9kcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgdTggdmFsKTsKLWludCBpbnRlbF9zZXRfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgdTggdmFsKTsKLXZvaWQgaW50ZWxfcnBzX21hcmtfaW50ZXJhY3RpdmUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgaW50ZXJhY3RpdmUpOwogYm9vbCBpbnRlbF9z
ZXRfbWVtb3J5X2N4c3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIGVu
YWJsZSk7CiAKICNlbmRpZiAvKiBfX0lOVEVMX1BNX0hfXyAqLwotLSAKMi4yMi4wCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

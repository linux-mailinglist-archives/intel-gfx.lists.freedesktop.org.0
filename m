Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5224328EE9D
	for <lists+intel-gfx@lfdr.de>; Thu, 15 Oct 2020 10:36:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2FA526EC42;
	Thu, 15 Oct 2020 08:36:42 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2BDF86EC41;
 Thu, 15 Oct 2020 08:36:39 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 22721166-1500050 
 for multiple; Thu, 15 Oct 2020 09:36:33 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 15 Oct 2020 09:36:32 +0100
Message-Id: <20201015083632.2618018-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.28.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t] i915/sysfs: Verify .defaults are
 read-only and match their namesakes
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org, Chris Wilson <chris@chris-wilson.co.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0t
LQogdGVzdHMvTWFrZWZpbGUuc291cmNlcyAgICAgIHwgICAzICsKIHRlc3RzL2k5MTUvc3lzZnNf
ZGVmYXVsdHMuYyB8IDExMCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIHRl
c3RzL21lc29uLmJ1aWxkICAgICAgICAgICB8ICAgMSArCiAzIGZpbGVzIGNoYW5nZWQsIDExNCBp
bnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgdGVzdHMvaTkxNS9zeXNmc19kZWZhdWx0
cy5jCgpkaWZmIC0tZ2l0IGEvdGVzdHMvTWFrZWZpbGUuc291cmNlcyBiL3Rlc3RzL01ha2VmaWxl
LnNvdXJjZXMKaW5kZXggZWM1MzViYTg1Li4yNTgxYzA0MjkgMTAwNjQ0Ci0tLSBhL3Rlc3RzL01h
a2VmaWxlLnNvdXJjZXMKKysrIGIvdGVzdHMvTWFrZWZpbGUuc291cmNlcwpAQCAtMTExLDYgKzEx
MSw5IEBAIFRFU1RTX3Byb2dzID0gXAogVEVTVFNfcHJvZ3MgKz0gYXBpX2ludGVsX2JiCiBhcGlf
aW50ZWxfYmJfU09VUkNFUyA9IGk5MTUvYXBpX2ludGVsX2JiLmMKIAorVEVTVFNfcHJvZ3MgKz0g
c3lzZnNfZGVmYXVsdHMKK3N5c2ZzX2RlZmF1bHRzX1NPVVJDRVMgPSBpOTE1L3N5c2ZzX2RlZmF1
bHRzLmMKKwogVEVTVFNfcHJvZ3MgKz0gc3lzZnNfaGVhcnRiZWF0X2ludGVydmFsCiBzeXNmc19o
ZWFydGJlYXRfaW50ZXJ2YWxfU09VUkNFUyA9IGk5MTUvc3lzZnNfaGVhcnRiZWF0X2ludGVydmFs
LmMKIApkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9zeXNmc19kZWZhdWx0cy5jIGIvdGVzdHMvaTkx
NS9zeXNmc19kZWZhdWx0cy5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMC4u
NjRjNWViMzczCi0tLSAvZGV2L251bGwKKysrIGIvdGVzdHMvaTkxNS9zeXNmc19kZWZhdWx0cy5j
CkBAIC0wLDAgKzEsMTEwIEBACisvKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9y
YXRpb24KKyAqCisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJn
ZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQorICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFu
ZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKKyAqIHRv
IGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRo
b3V0IGxpbWl0YXRpb24KKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdl
LCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29yIHNlbGwgY29waWVz
IG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCisgKiBT
b2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBj
b25kaXRpb25zOgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBl
cm1pc3Npb24gbm90aWNlIChpbmNsdWRpbmcgdGhlIG5leHQKKyAqIHBhcmFncmFwaCkgc2hhbGwg
YmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUK
KyAqIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBX
SVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJTVBMSUVELCBJTkNM
VURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElU
WSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1F
TlQuICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERF
UlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKKyAqIExJQUJJTElU
WSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBB
UklTSU5HCisgKiBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FS
RSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTCisgKiBJTiBUSEUgU09GVFdBUkUuCisgKi8K
KworI2luY2x1ZGUgPGRpcmVudC5oPgorI2luY2x1ZGUgPGVycm5vLmg+CisjaW5jbHVkZSA8ZmNu
dGwuaD4KKyNpbmNsdWRlIDxpbnR0eXBlcy5oPgorI2luY2x1ZGUgPHN5cy9zdGF0Lmg+CisjaW5j
bHVkZSA8c3lzL3R5cGVzLmg+CisjaW5jbHVkZSA8dW5pc3RkLmg+CisKKyNpbmNsdWRlICJkcm10
ZXN0LmgiCisjaW5jbHVkZSAiaTkxNS9nZW0uaCIKKyNpbmNsdWRlICJpOTE1L2dlbV9lbmdpbmVf
dG9wb2xvZ3kuaCIKKyNpbmNsdWRlICJpZ3Rfc3lzZnMuaCIKKworc3RhdGljIGJvb2wgbWF5X3dy
aXRlKGludCBkaXIsIGNvbnN0IGNoYXIgKmZpbGUpCit7CisJc3RydWN0IHN0YXQgc3Q7CisKKwlp
Z3RfYXNzZXJ0KGZzdGF0YXQoZGlyLCBmaWxlLCAmc3QsIDApID09IDApOworCXJldHVybiBzdC5z
dF9tb2RlICYgMDIyMjsKK30KKworc3RhdGljIHZvaWQgdGVzdF93cml0YWJsZShpbnQgaTkxNSwg
aW50IGVuZ2luZSkKK3sKKwlzdHJ1Y3QgZGlyZW50ICpkZTsKKwlpbnQgZGVmYXVsdHM7CisJRElS
ICpkaXI7CisKKwlkZWZhdWx0cyA9IG9wZW5hdChlbmdpbmUsICIuZGVmYXVsdHMiLCBPX0RJUkVD
VE9SWSk7CisJaWd0X3JlcXVpcmUoZGVmYXVsdHMgIT0gLTEpOworCisJZGlyID0gZmRvcGVuZGly
KGVuZ2luZSk7CisJd2hpbGUgKChkZSA9IHJlYWRkaXIoZGlyKSkpIHsKKwkJaWYgKCEoZGUtPmRf
dHlwZSAmIERUX1JFRykpCisJCQljb250aW51ZTsKKworCQlpZiAoIW1heV93cml0ZShlbmdpbmUs
IGRlLT5kX25hbWUpKSB7CisJCQlpZ3RfZGVidWcoIlNraXBwaW5nIGNvbnN0YW50IGF0dHIgJyVz
J1xuIiwgZGUtPmRfbmFtZSk7CisJCQljb250aW51ZTsKKwkJfQorCisJCWlndF9kZWJ1ZygiQ2hl
Y2tpbmcgYXR0ciAnJXMnXG4iLCBkZS0+ZF9uYW1lKTsKKworCQkvKiBFdmVyeSBhdHRyaWJ1dGUg
c2hvdWxkIGhhdmUgYSBkZWZhdWx0IHZhbHVlICovCisJCWlndF9hc3NlcnRfZihmYWNjZXNzYXQo
ZGVmYXVsdHMsIGRlLT5kX25hbWUsIEZfT0ssIDApID09IDAsCisJCQkgICAgICJkZWZhdWx0IHZh
bHVlIGZvciAlcyBub3QgYWNjZXNzaWJsZVxuIiwKKwkJCSAgICAgZGUtPmRfbmFtZSk7CisKKwkJ
LyogQnV0IG5vIG9uZSBpcyBhbGxvd2VkIHRvIGNoYW5nZSBpdCAqLworCQlpZ3RfYXNzZXJ0X2Yo
IW1heV93cml0ZShkZWZhdWx0cywgZGUtPmRfbmFtZSksCisJCQkgICAgICJkZWZhdWx0IHZhbHVl
IGZvciAlcyB3cml0YWJsZSFcbiIsCisJCQkgICAgIGRlLT5kX25hbWUpOworCisJCWlndF9hc3Nl
cnRfZighaWd0X3N5c2ZzX3NldChkZWZhdWx0cywgZGUtPmRfbmFtZSwgImdhcmJhZ2UiKSwKKwkJ
CSAgICAgIndyaXRlIGludG8gZGVmYXVsdCB2YWx1ZSBvZiAlcyBzdWNjZWVkZWQhXG4iLAorCQkJ
ICAgICBkZS0+ZF9uYW1lKTsKKwl9CisJY2xvc2VkaXIoZGlyKTsKK30KKworaWd0X21haW4KK3sK
KwlpbnQgaTkxNSA9IC0xLCBlbmdpbmVzID0gLTE7CisKKwlpZ3RfZml4dHVyZSB7CisJCWludCBz
eXM7CisKKwkJaTkxNSA9IGRybV9vcGVuX2RyaXZlcihEUklWRVJfSU5URUwpOworCQlpZ3RfcmVx
dWlyZV9nZW0oaTkxNSk7CisJCWlndF9hbGxvd19oYW5nKGk5MTUsIDAsIDApOworCisJCXN5cyA9
IGlndF9zeXNmc19vcGVuKGk5MTUpOworCQlpZ3RfcmVxdWlyZShzeXMgIT0gLTEpOworCisJCWVu
Z2luZXMgPSBvcGVuYXQoc3lzLCAiZW5naW5lIiwgT19SRE9OTFkpOworCQlpZ3RfcmVxdWlyZShl
bmdpbmVzICE9IC0xKTsKKworCQljbG9zZShzeXMpOworCX0KKworCWlndF9zdWJ0ZXN0X3dpdGhf
ZHluYW1pYygid3JpdGFibGUiKQorCQlkeW5fc3lzZnNfZW5naW5lcyhpOTE1LCBlbmdpbmVzLCBO
VUxMLCB0ZXN0X3dyaXRhYmxlKTsKKworCWlndF9maXh0dXJlIHsKKwkJY2xvc2UoZW5naW5lcyk7
CisJCWNsb3NlKGk5MTUpOworCX0KK30KZGlmZiAtLWdpdCBhL3Rlc3RzL21lc29uLmJ1aWxkIGIv
dGVzdHMvbWVzb24uYnVpbGQKaW5kZXggMDgyMDBmMjZjLi40Zjc2NWRhMzAgMTAwNjQ0Ci0tLSBh
L3Rlc3RzL21lc29uLmJ1aWxkCisrKyBiL3Rlc3RzL21lc29uLmJ1aWxkCkBAIC0yMzUsNiArMjM1
LDcgQEAgaTkxNV9wcm9ncyA9IFsKIAknaTkxNV9xdWVyeScsCiAJJ2k5MTVfc2VsZnRlc3QnLAog
CSdpOTE1X3N1c3BlbmQnLAorCSdzeXNmc19kZWZhdWx0cycsCiAJJ3N5c2ZzX2hlYXJ0YmVhdF9p
bnRlcnZhbCcsCiAJJ3N5c2ZzX3ByZWVtcHRfdGltZW91dCcsCiAJJ3N5c2ZzX3RpbWVzbGljZV9k
dXJhdGlvbicsCi0tIAoyLjI4LjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2ludGVsLWdmeAo=

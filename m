Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E162CFE14F
	for <lists+intel-gfx@lfdr.de>; Fri, 15 Nov 2019 16:34:15 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 502A26E85F;
	Fri, 15 Nov 2019 15:34:14 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 48D546E85F
 for <intel-gfx@lists.freedesktop.org>; Fri, 15 Nov 2019 15:34:12 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 15 Nov 2019 07:34:11 -0800
X-IronPort-AV: E=Sophos;i="5.68,308,1569308400"; d="scan'208";a="195420538"
Received: from jnikula-mobl3.fi.intel.com (HELO localhost) ([10.237.66.161])
 by orsmga007-auth.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 15 Nov 2019 07:34:09 -0800
From: Jani Nikula <jani.nikula@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 15 Nov 2019 17:33:39 +0200
Message-Id: <874ec31e9774569dd1f0c88cfe1af46a4c441241.1573831924.git.jani.nikula@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <cover.1573831924.git.jani.nikula@intel.com>
References: <cover.1573831924.git.jani.nikula@intel.com>
MIME-Version: 1.0
Organization: Intel Finland Oy - BIC 0357606-4 - Westendinkatu 7, 02160 Espoo
Subject: [Intel-gfx] [PATCH v2 03/10] drm/i915/bios: add support for
 querying DSC details for encoder
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: jani.nikula@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QWRkIGZ1bmN0aW9uIGZvciByZXRyaWV2aW5nIHRoZSBEU0MgZGF0YSBmb3IgYW4gZW5jb2Rlci4K
CkluaXRpYWxseSwgdGhpcyBpcyBEU0kgc3BlY2lmaWMsIGFzIERQIGRvZXMgbm90IHVzZSBWQlQg
c2V0dGluZ3MgZm9yIERTQwphdCBhbGwuIEl0J3MgYWxzbyBub3QgdmVyeSBwcmV0dHkuCgpJbiB0
aGUgZnV0dXJlIHdlIG1pZ2h0IGhhdmUgYSBwb2ludGVyIGZyb20gZW5jb2RlciB0byB0aGUgY2hp
bGQgZGV2aWNlLAp3aGljaCB3b3VsZCBtYWtlIHRoZSBjaGlsZCBkZXZpY2UgbGlzdCBxdWVyeSBo
ZXJlIHNvIG11Y2ggbW9yZSBzZW5zaWJsZS4KCnYyOiBtYWtlIG1vcmUgcm9idXN0LCBkZWJ1ZyBs
b2cgZXJyb3JzIGJldHRlcgoKU2lnbmVkLW9mZi1ieTogSmFuaSBOaWt1bGEgPGphbmkubmlrdWxh
QGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Jpb3Mu
YyB8IDkxICsrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Jpb3MuaCB8ICA1ICsrCiAyIGZpbGVzIGNoYW5nZWQsIDk2IGluc2VydGlvbnMo
KykKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Jpb3Mu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYmlvcy5jCmluZGV4IDE1ODRl
N2RiNTRiMS4uOGJhMDI1MzNlOTdkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2Jpb3MuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2Jpb3MuYwpAQCAtMjksNiArMjksNyBAQAogI2luY2x1ZGUgPGRybS9pOTE1X2RybS5oPgog
CiAjaW5jbHVkZSAiZGlzcGxheS9pbnRlbF9kaXNwbGF5LmgiCisjaW5jbHVkZSAiZGlzcGxheS9p
bnRlbF9kaXNwbGF5X3R5cGVzLmgiCiAjaW5jbHVkZSAiZGlzcGxheS9pbnRlbF9nbWJ1cy5oIgog
CiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKQEAgLTIyMzYsNiArMjIzNyw5NiBAQCBib29sIGludGVs
X2Jpb3NfaXNfZHNpX3ByZXNlbnQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAog
CXJldHVybiBmYWxzZTsKIH0KIAorc3RhdGljIHZvaWQgZmlsbF9kc2Moc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKnBpcGVfY29uZmlnLAorCQkgICAgIHN0cnVjdCBkc2NfY29tcHJlc3Npb25fcGFy
YW1ldGVyc19lbnRyeSAqZHNjLAorCQkgICAgIGludCBkc2NfbWF4X2JwYykKK3sKKwlzdHJ1Y3Qg
ZHJtX2RzY19jb25maWcgKnZkc2NfY2ZnID0gJnBpcGVfY29uZmlnLT5kc2MuY29uZmlnOworCWlu
dCBicGMgPSA4OworCisJdmRzY19jZmctPmRzY192ZXJzaW9uX21ham9yID0gZHNjLT52ZXJzaW9u
X21ham9yOworCXZkc2NfY2ZnLT5kc2NfdmVyc2lvbl9taW5vciA9IGRzYy0+dmVyc2lvbl9taW5v
cjsKKworCWlmIChkc2MtPnN1cHBvcnRfMTJicGMgJiYgZHNjX21heF9icGMgPj0gMTIpCisJCWJw
YyA9IDEyOworCWVsc2UgaWYgKGRzYy0+c3VwcG9ydF8xMGJwYyAmJiBkc2NfbWF4X2JwYyA+PSAx
MCkKKwkJYnBjID0gMTA7CisJZWxzZSBpZiAoZHNjLT5zdXBwb3J0XzhicGMgJiYgZHNjX21heF9i
cGMgPj0gOCkKKwkJYnBjID0gODsKKwllbHNlCisJCURSTV9ERUJVR19LTVMoIlZCVDogVW5zdXBw
b3J0ZWQgQlBDICVkIGZvciBEQ1NcbiIsCisJCQkgICAgICBkc2NfbWF4X2JwYyk7CisKKwlwaXBl
X2NvbmZpZy0+cGlwZV9icHAgPSBicGMgKiAzOworCisJcGlwZV9jb25maWctPmRzYy5jb21wcmVz
c2VkX2JwcCA9IG1pbihwaXBlX2NvbmZpZy0+cGlwZV9icHAsCisJCQkJCSAgICAgIFZCVF9EU0Nf
TUFYX0JQUChkc2MtPm1heF9icHApKTsKKworCS8qCisJICogRklYTUU6IFRoaXMgaXMgdWdseSwg
YW5kIHNsaWNlIGNvdW50IHNob3VsZCB0YWtlIERTQyBlbmdpbmUKKwkgKiB0aHJvdWdocHV0IGV0
Yy4gaW50byBhY2NvdW50LgorCSAqCisJICogQWxzbywgcGVyIHNwZWMgRFNJIHN1cHBvcnRzIDEs
IDIsIDMgb3IgNCBob3Jpem9udGFsIHNsaWNlcy4KKwkgKi8KKwlpZiAoZHNjLT5zbGljZXNfcGVy
X2xpbmUgJiBCSVQoMikpIHsKKwkJcGlwZV9jb25maWctPmRzYy5zbGljZV9jb3VudCA9IDQ7CisJ
fSBlbHNlIGlmIChkc2MtPnNsaWNlc19wZXJfbGluZSAmIEJJVCgxKSkgeworCQlwaXBlX2NvbmZp
Zy0+ZHNjLnNsaWNlX2NvdW50ID0gMjsKKwl9IGVsc2UgeworCQkvKiBGSVhNRSAqLworCQlpZiAo
IShkc2MtPnNsaWNlc19wZXJfbGluZSAmIEJJVCgwKSkpCisJCQlEUk1fREVCVUdfS01TKCJWQlQ6
IFVuc3VwcG9ydGVkIERTQyBzbGljZSBjb3VudCBmb3IgRFNJXG4iKTsKKworCQlwaXBlX2NvbmZp
Zy0+ZHNjLnNsaWNlX2NvdW50ID0gMTsKKwl9CisKKwlpZiAocGlwZV9jb25maWctPmh3LmFkanVz
dGVkX21vZGUuY3J0Y19oZGlzcGxheSAlCisJICAgIHBpcGVfY29uZmlnLT5kc2Muc2xpY2VfY291
bnQgIT0gMCkKKwkJRFJNX0RFQlVHX0tNUygiRFNDIGhkaXNwbGF5ICVkIG5vdCBkaXZpc2libGUg
Ynkgc2xpY2UgY291bnQgJWRcbiIsCisJCQkgICAgICBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRf
bW9kZS5jcnRjX2hkaXNwbGF5LAorCQkJICAgICAgcGlwZV9jb25maWctPmRzYy5zbGljZV9jb3Vu
dCk7CisKKwkvKiBGSVhNRTogcmNfYnVmZmVyX2Jsb2NrX3NpemUsIHVzaW5nIGRlZmF1bHRzIGlu
IGludGVsX3Zkc2MuYyAqLworCisJLyogRklYTUU6IHJjX2J1ZmZlcl9zaXplLCB1c2luZyBkZWZh
dWx0cyBpbiBpbnRlbF92ZHNjLmMgKi8KKworCS8qIEZJWE1FOiBEU0kgc3BlYyBzYXlzIGJwYyAr
IDEgZm9yIHRoaXMgb25lICovCisJdmRzY19jZmctPmxpbmVfYnVmX2RlcHRoID0gVkJUX0RTQ19M
SU5FX0JVRkZFUl9ERVBUSChkc2MtPmxpbmVfYnVmZmVyX2RlcHRoKTsKKworCXZkc2NfY2ZnLT5i
bG9ja19wcmVkX2VuYWJsZSA9IGRzYy0+YmxvY2tfcHJlZGljdGlvbl9lbmFibGU7CisKKwl2ZHNj
X2NmZy0+c2xpY2VfaGVpZ2h0ID0gZHNjLT5zbGljZV9oZWlnaHQ7Cit9CisKKy8qIEZJWE1FOiBp
bml0aWFsbHkgRFNJIHNwZWNpZmljICovCitib29sIGludGVsX2Jpb3NfZ2V0X2RzY19wYXJhbXMo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCisJCQkgICAgICAgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKnBpcGVfY29uZmlnLAorCQkJICAgICAgIGludCBkc2NfbWF4X2JwYykKK3sKKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
OworCWNvbnN0IHN0cnVjdCBkaXNwbGF5X2RldmljZV9kYXRhICpkZXZkYXRhOworCWNvbnN0IHN0
cnVjdCBjaGlsZF9kZXZpY2VfY29uZmlnICpjaGlsZDsKKworCWxpc3RfZm9yX2VhY2hfZW50cnko
ZGV2ZGF0YSwgJmk5MTUtPnZidC5kaXNwbGF5X2RldmljZXMsIG5vZGUpIHsKKwkJY2hpbGQgPSAm
ZGV2ZGF0YS0+Y2hpbGQ7CisKKwkJaWYgKCEoY2hpbGQtPmRldmljZV90eXBlICYgREVWSUNFX1RZ
UEVfTUlQSV9PVVRQVVQpKQorCQkJY29udGludWU7CisKKwkJaWYgKGNoaWxkLT5kdm9fcG9ydCAt
IERWT19QT1JUX01JUElBID09IGVuY29kZXItPnBvcnQpIHsKKwkJCWlmICghZGV2ZGF0YS0+ZHNj
KQorCQkJCXJldHVybiBmYWxzZTsKKworCQkJaWYgKHBpcGVfY29uZmlnKQorCQkJCWZpbGxfZHNj
KHBpcGVfY29uZmlnLCBkZXZkYXRhLT5kc2MsIGRzY19tYXhfYnBjKTsKKworCQkJcmV0dXJuIHRy
dWU7CisJCX0KKwl9CisKKwlyZXR1cm4gdHJ1ZTsKK30KKwogLyoqCiAgKiBpbnRlbF9iaW9zX2lz
X3BvcnRfaHBkX2ludmVydGVkIC0gaXMgSFBEIGludmVydGVkIGZvciAlcG9ydAogICogQGk5MTU6
CWk5MTUgZGV2aWNlIGluc3RhbmNlCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2Jpb3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
Ymlvcy5oCmluZGV4IDk4ZjA2NDgyOGE1Ny4uZmUxYTExZDNkNmI2IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Jpb3MuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2Jpb3MuaApAQCAtMzUsNiArMzUsOCBAQAogI2luY2x1ZGUg
PGRybS9pOTE1X2RybS5oPgogCiBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKK3N0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlOworc3RydWN0IGludGVsX2VuY29kZXI7CiBlbnVtIHBvcnQ7CiAKIGVudW0g
aW50ZWxfYmFja2xpZ2h0X3R5cGUgewpAQCAtMjQyLDUgKzI0NCw4IEBAIGJvb2wgaW50ZWxfYmlv
c19pc19wb3J0X2hwZF9pbnZlcnRlZChjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKIGJvb2wgaW50ZWxfYmlvc19pc19sc3Bjb25fcHJlc2VudChjb25zdCBzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCQkgIGVudW0gcG9ydCBwb3J0KTsKIGVudW0gYXV4X2NoIGlu
dGVsX2Jpb3NfcG9ydF9hdXhfY2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBl
bnVtIHBvcnQgcG9ydCk7Citib29sIGludGVsX2Jpb3NfZ2V0X2RzY19wYXJhbXMoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCisJCQkgICAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KnBpcGVfY29uZmlnLAorCQkJICAgICAgIGludCBkc2NfbWF4X2JwYyk7CiAKICNlbmRpZiAvKiBf
SU5URUxfQklPU19IXyAqLwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0
cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9s
aXN0aW5mby9pbnRlbC1nZng=

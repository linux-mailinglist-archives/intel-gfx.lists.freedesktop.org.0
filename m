Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A7FECBDA97
	for <lists+intel-gfx@lfdr.de>; Wed, 25 Sep 2019 11:09:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8126C6EB50;
	Wed, 25 Sep 2019 09:09:37 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 19D566EB41
 for <intel-gfx@lists.freedesktop.org>; Wed, 25 Sep 2019 09:09:33 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 25 Sep 2019 02:09:31 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,547,1559545200"; d="scan'208";a="188725471"
Received: from timmpete-desk1.ger.corp.intel.com (HELO [10.252.55.52])
 ([10.252.55.52])
 by fmsmga008.fm.intel.com with ESMTP; 25 Sep 2019 02:09:27 -0700
To: Matt Roper <matthew.d.roper@intel.com>
References: <20190920114235.22411-1-maarten.lankhorst@linux.intel.com>
 <20190920114235.22411-3-maarten.lankhorst@linux.intel.com>
 <20190924234048.GH1869@mdroper-desk1.amr.corp.intel.com>
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Message-ID: <663d2a88-b7b9-d3ce-5e12-1ba4dadf03fe@linux.intel.com>
Date: Wed, 25 Sep 2019 11:09:27 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.2
MIME-Version: 1.0
In-Reply-To: <20190924234048.GH1869@mdroper-desk1.amr.corp.intel.com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 03/23] drm/i915: Prepare to split crtc state
 in uapi and hw state
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T3AgMjUtMDktMjAxOSBvbSAwMTo0MCBzY2hyZWVmIE1hdHQgUm9wZXI6Cj4gT24gRnJpLCBTZXAg
MjAsIDIwMTkgYXQgMDE6NDI6MTVQTSArMDIwMCwgTWFhcnRlbiBMYW5raG9yc3Qgd3JvdGU6Cj4+
IFdlIHdhbnQgdG8gc3BsaXQgZHJtX2NydGNfc3RhdGUgaW50byB0aGUgdXNlciB2aXNpYmxlIHN0
YXRlCj4+IGFuZCBhY3R1YWwgaGFyZHdhcmUgc3RhdGUuIFRvIHByZXBhcmUgZm9yIHRoaXMsIHdl
IG5lZWQgc29tZQo+PiBncm91bmQgcnVsZXMgd2hhdCBzaG91bGQgYmUgaW4gZWFjaCBzdGF0ZToK
Pj4KPj4gSW4gdWFwaSB3ZSB1c2U6Cj4+IC0gY3J0YywgKl9jaGFuZ2VkIGZsYWdzLCBldmVudCwg
Y29tbWl0LCBzdGF0ZSwgbW9kZV9ibG9iLCAocGxhbmUvY29ubmVjdG9yL2VuY29kZXIpX21hc2su
Cj4+Cj4+IEluIGh3IHN0YXRlIHdlIHVzZSB3aGF0J3MgZGlzcGxheWVkIGluIGhhcmR3YXJlOgo+
PiAtIGVuYWJsZSwgYWN0aXZlLCAoYWRqdXN0ZWQpIG1vZGUsIGNvbG9yIHByb3BlcnR5IGJsb2Jz
Lgo+IEknZCBzdWdnZXN0IGVsYWJvcmF0aW5nIGEgYml0IHRoYXQgdGhlIHVuaW9uIHdlIGFkZCBp
biB0aGlzIHBhdGNoIGlzCj4ganVzdCBhbiBpbnRlcm1lZGlhdGUgc3RlcCBhbmQgdGhhdCB0aGUg
ZW5kIGdvYWwgaXMgdGhhdCB3ZSdsbCBldmVudHVhbGx5Cj4gYmUgbWFpbnRhaW5pbmcgdHdvIHNl
cGFyYXRlIGNvcGllcyBvZiBzb21lIG9mIHRoZSBkYXRhLgpZZWFoIG9rLCB3aWxsIGNsZWFyIHVw
IGNvbW1pdCBtZXNzYWdlLgo+PiBjbGVhcl9pbnRlbF9jcnRjX3N0YXRlIGFuZCBodyByZWFkb3V0
IG5lZWQgdG8gYmUgdXBkYXRlZCBmb3IgdGhlc2UgcnVsZXMsCj4+IHdoaWNoIHdpbGwgYWxsb3cg
dXMgdG8gZW5hYmxlIDIgam9pbmVkIHBpcGVzLgo+Pgo+PiBTaWduZWQtb2ZmLWJ5OiBNYWFydGVu
IExhbmtob3JzdCA8bWFhcnRlbi5sYW5raG9yc3RAbGludXguaW50ZWwuY29tPgo+IEl0IG1pZ2h0
IGJlIHdvcnRoIHByb3ZpZGluZyBzb21lIENvY2NpbmVsbGUgcnVsZXMgdG8gYXBwbHkgdGhlc2Ug
Y2hhbmdlcwo+IGluIGEgc2VtaS1hdXRvbWF0ZWQgbWFubmVyOyBvdGhlcndpc2UgaXQncyBnb2lu
ZyB0byBiZSBhIGhhc3NsZSB0bwo+IGNvbnN0YW50bHkgcmVzb2x2ZSBjb25mbGljdHMgd2l0aCBw
cmV0dHkgbXVjaCBhbnkgb3RoZXIgZGlzcGxheSBwYXRjaGVzCj4gdGhhdCBsYW5kIHVwc3RyZWFt
Lgo+Cj4gT3RoZXJ3aXNlLAo+Cj4gUmV2aWV3ZWQtYnk6IE1hdHQgUm9wZXIgPG1hdHRoZXcuZC5y
b3BlckBpbnRlbC5jb20+CgpJIHRyaWVkLCBidXQgaXQgaGFzIHRvIGJlIHJlc29sdmVkIG1hbnVh
bGx5LCBzcGF0Y2ggd29uJ3QgaGVscC4KCkZvciBleGFtcGxlIHdoZW4gZW5hYmxpbmcgYSBjcnRj
LCB5b3UgaGF2ZSB0byBzZXQgY3J0Y19zdGF0ZS0+dWFwaS5hY3RpdmUsCndoaWNoIGluIGF0b21p
YyBjaGVjayBnZXRzIGNvcGllZCB0byBody5hY3RpdmUuIElmIHlvdSBzZXQgaHcuYWN0aXZlIGRp
cmVjdGx5LAppdCB3aWxsIGJlIGlnbm9yZWQgb3IgY2xlYXJlZC4KClNvIGJlZm9yZSBhdG9taWNf
Y2hlY2soKSAtPiB1c2UgdWFwaS4KRHVyaW5nIGF0b21pY19jaGVjaygpIGFuZCBjb21taXQoKSAt
PiB1c2UgaHcuCgp+TWFhcnRlbgoKCgo+PiAtLS0KPj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaWNsX2RzaS5jICAgICAgICB8ICAxOCArLQo+PiAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9hdG9taWMuYyAgIHwgIDE0ICstCj4+ICAuLi4vZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfYXRvbWljX3BsYW5lLmMgfCAgIDYgKy0KPj4gIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfYXVkaW8uYyAgICB8ICAxMiArLQo+PiAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9idy5jICAgICAgIHwgICA0ICstCj4+ICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2NkY2xrLmMgICAgfCAgMTYgKy0KPj4gIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY29sb3IuYyAgICB8IDE4MCArKystLS0KPj4gIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY3J0LmMgICAgICB8ICAyNCArLQo+PiAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYyAgICAgIHwgIDM0ICstCj4+ICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyAgfCA1NDAgKysrKysr
KysrLS0tLS0tLS0tCj4+ICAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVz
LmggICAgfCAgMjggKy0KPj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAu
YyAgICAgICB8ICA0MiArLQo+PiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
cF9tc3QuYyAgIHwgICA2ICstCj4+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RwaW9fcGh5LmMgfCAgMTQgKy0KPj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZHBsbF9tZ3IuYyB8ICAyMCArLQo+PiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kdm8uYyAgICAgIHwgIDE0ICstCj4+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2ZiYy5jICAgICAgfCAgIDIgKy0KPj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfaGRtaS5jICAgICB8ICA2MiArLQo+PiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9sc3Bjb24uYyAgIHwgICA0ICstCj4+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2x2ZHMuYyAgICAgfCAgMTIgKy0KPj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfcGFuZWwuYyAgICB8ICAxNCArLQo+PiAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9waXBlX2NyYy5jIHwgICA2ICstCj4+ICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jICAgICAgfCAgMTAgKy0KPj4gIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfc2R2by5jICAgICB8ICAyMiArLQo+PiAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYyAgIHwgIDI1ICstCj4+ICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3R2LmMgICAgICAgfCAgIDggKy0KPj4gIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdmRzYy5jICAgICB8ICAxMiArLQo+PiAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS92bHZfZHNpLmMgICAgICAgIHwgIDIwICstCj4+ICBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyAgICAgICAgICAgfCAgMTQgKy0KPj4gIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMgICAgICAgICAgICAgICB8IDE4MCArKystLS0K
Pj4gIDMwIGZpbGVzIGNoYW5nZWQsIDY5OSBpbnNlcnRpb25zKCspLCA2NjQgZGVsZXRpb25zKC0p
Cj4+Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ljbF9kc2ku
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaWNsX2RzaS5jCj4+IGluZGV4IDZlMzk4
YzMzYTUyNC4uMGUyNGI4ZTI1N2U1IDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ljbF9kc2kuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ljbF9kc2kuYwo+PiBAQCAtMjc2LDcgKzI3Niw3IEBAIHN0YXRpYyB2b2lkIGNvbmZpZ3VyZV9k
dWFsX2xpbmtfbW9kZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAo+PiAgCWlm
IChpbnRlbF9kc2ktPmR1YWxfbGluayA9PSBEU0lfRFVBTF9MSU5LX0ZST05UX0JBQ0spIHsKPj4g
IAkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkJ
CQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwkJCQkJJnBpcGVfY29uZmln
LT5ody5hZGp1c3RlZF9tb2RlOwo+PiAgCQl1MzIgZHNzX2N0bDI7Cj4+ICAJCXUxNiBoYWN0aXZl
ID0gYWRqdXN0ZWRfbW9kZS0+Y3J0Y19oZGlzcGxheTsKPj4gIAkJdTE2IGRsX2J1ZmZlcl9kZXB0
aDsKPj4gQEAgLTYyNSw3ICs2MjUsNyBAQCBnZW4xMV9kc2lfY29uZmlndXJlX3RyYW5zY29kZXIo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+ICAJc3Ry
dWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFz
ZSk7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKHBp
cGVfY29uZmlnLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRj
ID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+dWFwaS5jcnRjKTsKPj4gIAllbnVtIHBpcGUg
cGlwZSA9IGludGVsX2NydGMtPnBpcGU7Cj4+ICAJdTMyIHRtcDsKPj4gIAllbnVtIHBvcnQgcG9y
dDsKPj4gQEAgLTc2OCw3ICs3NjgsNyBAQCBnZW4xMV9kc2lfc2V0X3RyYW5zY29kZXJfdGltaW5n
cyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gIAlzdHJ1Y3Qg
aW50ZWxfZHNpICppbnRlbF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsK
Pj4gIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4+IC0J
CQkJCSZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCQkJCQkmcGlwZV9jb25m
aWctPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJZW51bSBwb3J0IHBvcnQ7Cj4+ICAJZW51bSB0cmFu
c2NvZGVyIGRzaV90cmFuczsKPj4gIAkvKiBob3Jpem9udGFsIHRpbWluZ3MgKi8KPj4gQEAgLTEy
MTYsNyArMTIxNiw3IEBAIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9nZXRfdGltaW5ncyhzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIHsKPj4gIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRl
bF9kc2kgPSBlbmNfdG9faW50ZWxfZHNpKCZlbmNvZGVyLT5iYXNlKTsKPj4gIAlzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4+IC0JCQkJCSZwaXBlX2NvbmZpZy0+YmFz
ZS5hZGp1c3RlZF9tb2RlOwo+PiArCQkJCQkmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7
Cj4+ICAKPj4gIAlpZiAoaW50ZWxfZHNpLT5kdWFsX2xpbmspIHsKPj4gIAkJYWRqdXN0ZWRfbW9k
ZS0+Y3J0Y19oZGlzcGxheSAqPSAyOwo+PiBAQCAtMTI0MiwxNiArMTI0MiwxNiBAQCBzdGF0aWMg
dm9pZCBnZW4xMV9kc2lfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
Pj4gIAkJCQkgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+PiAgewo+PiAg
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhwaXBl
X2NvbmZpZy0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMocGlwZV9jb25maWctPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGludGVsX2RzaSAq
aW50ZWxfZHNpID0gZW5jX3RvX2ludGVsX2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4+ICAKPj4gIAkv
KiBGSVhNRTogYWRhcHQgaWNsX2RkaV9jbG9ja19nZXQoKSBmb3IgRFNJIGFuZCB1c2UgdGhhdD8g
Ki8KPj4gIAlwaXBlX2NvbmZpZy0+cG9ydF9jbG9jayA9Cj4+ICAJCWNubF9jYWxjX3dycGxsX2xp
bmsoZGV2X3ByaXYsICZwaXBlX2NvbmZpZy0+ZHBsbF9od19zdGF0ZSk7Cj4+ICAKPj4gLQlwaXBl
X2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPSBpbnRlbF9kc2ktPnBjbGs7
Cj4+ICsJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9IGludGVsX2Rz
aS0+cGNsazsKPj4gIAlpZiAoaW50ZWxfZHNpLT5kdWFsX2xpbmspCj4+IC0JCXBpcGVfY29uZmln
LT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayAqPSAyOwo+PiArCQlwaXBlX2NvbmZpZy0+
aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrICo9IDI7Cj4+ICAKPj4gIAlnZW4xMV9kc2lfZ2V0
X3RpbWluZ3MoZW5jb2RlciwgcGlwZV9jb25maWcpOwo+PiAgCXBpcGVfY29uZmlnLT5vdXRwdXRf
dHlwZXMgfD0gQklUKElOVEVMX09VVFBVVF9EU0kpOwo+PiBAQCAtMTI2NSwxMSArMTI2NSwxMSBA
QCBzdGF0aWMgaW50IGdlbjExX2RzaV9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPj4gIAlzdHJ1Y3QgaW50ZWxfZHNpICppbnRlbF9kc2kgPSBjb250YWluZXJf
b2YoZW5jb2Rlciwgc3RydWN0IGludGVsX2RzaSwKPj4gIAkJCQkJCSAgIGJhc2UpOwo+PiAgCXN0
cnVjdCBpbnRlbF9jb25uZWN0b3IgKmludGVsX2Nvbm5lY3RvciA9IGludGVsX2RzaS0+YXR0YWNo
ZWRfY29ubmVjdG9yOwo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPnVhcGkuY3J0Yyk7Cj4+ICAJY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGUgPQo+PiAgCQkJCQlpbnRlbF9jb25uZWN0b3It
PnBhbmVsLmZpeGVkX21vZGU7Cj4+ICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVk
X21vZGUgPQo+PiAtCQkJCQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwkJ
CQkJJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+PiAgCj4+ICAJcGlwZV9jb25maWct
Pm91dHB1dF9mb3JtYXQgPSBJTlRFTF9PVVRQVVRfRk9STUFUX1JHQjsKPj4gIAlpbnRlbF9maXhl
ZF9wYW5lbF9tb2RlKGZpeGVkX21vZGUsIGFkanVzdGVkX21vZGUpOwo+PiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmMKPj4gaW5kZXggNjk4ODAyZGEwN2I3Li5m
NDQ0MGVkZTk1YzUgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfYXRvbWljLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9hdG9taWMuYwo+PiBAQCAtMTg2LDEzICsxODYsMTQgQEAgaW50ZWxfZGlnaXRhbF9jb25uZWN0
b3JfZHVwbGljYXRlX3N0YXRlKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpCj4+ICBz
dHJ1Y3QgZHJtX2NydGNfc3RhdGUgKgo+PiAgaW50ZWxfY3J0Y19kdXBsaWNhdGVfc3RhdGUoc3Ry
dWN0IGRybV9jcnRjICpjcnRjKQo+PiAgewo+PiArCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpvbGRfY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2NydGNfc3RhdGUoY3J0Yy0+c3RhdGUpOwo+
PiAgCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlOwo+PiAgCj4+IC0JY3J0Y19z
dGF0ZSA9IGttZW1kdXAoY3J0Yy0+c3RhdGUsIHNpemVvZigqY3J0Y19zdGF0ZSksIEdGUF9LRVJO
RUwpOwo+PiArCWNydGNfc3RhdGUgPSBrbWVtZHVwKG9sZF9jcnRjX3N0YXRlLCBzaXplb2YoKmNy
dGNfc3RhdGUpLCBHRlBfS0VSTkVMKTsKPj4gIAlpZiAoIWNydGNfc3RhdGUpCj4+ICAJCXJldHVy
biBOVUxMOwo+PiAgCj4+IC0JX19kcm1fYXRvbWljX2hlbHBlcl9jcnRjX2R1cGxpY2F0ZV9zdGF0
ZShjcnRjLCAmY3J0Y19zdGF0ZS0+YmFzZSk7Cj4+ICsJX19kcm1fYXRvbWljX2hlbHBlcl9jcnRj
X2R1cGxpY2F0ZV9zdGF0ZShjcnRjLCAmY3J0Y19zdGF0ZS0+dWFwaSk7Cj4+ICAKPj4gIAljcnRj
X3N0YXRlLT51cGRhdGVfcGlwZSA9IGZhbHNlOwo+PiAgCWNydGNfc3RhdGUtPmRpc2FibGVfbHBf
d20gPSBmYWxzZTsKPj4gQEAgLTIwNSw3ICsyMDYsNyBAQCBpbnRlbF9jcnRjX2R1cGxpY2F0ZV9z
dGF0ZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMpCj4+ICAJY3J0Y19zdGF0ZS0+ZmJfYml0cyA9IDA7
Cj4+ICAJY3J0Y19zdGF0ZS0+dXBkYXRlX3BsYW5lcyA9IDA7Cj4+ICAKPj4gLQlyZXR1cm4gJmNy
dGNfc3RhdGUtPmJhc2U7Cj4+ICsJcmV0dXJuICZjcnRjX3N0YXRlLT51YXBpOwo+PiAgfQo+PiAg
Cj4+ICAvKioKPj4gQEAgLTIyMCw3ICsyMjEsMTAgQEAgdm9pZAo+PiAgaW50ZWxfY3J0Y19kZXN0
cm95X3N0YXRlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywKPj4gIAkJCSBzdHJ1Y3QgZHJtX2NydGNf
c3RhdGUgKnN0YXRlKQo+PiAgewo+PiAtCWRybV9hdG9taWNfaGVscGVyX2NydGNfZGVzdHJveV9z
dGF0ZShjcnRjLCBzdGF0ZSk7Cj4+ICsJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUgPSB0b19pbnRlbF9jcnRjX3N0YXRlKHN0YXRlKTsKPj4gKwo+PiArCV9fZHJtX2F0b21pY19o
ZWxwZXJfY3J0Y19kZXN0cm95X3N0YXRlKCZjcnRjX3N0YXRlLT51YXBpKTsKPj4gKwlrZnJlZShj
cnRjX3N0YXRlKTsKPj4gIH0KPj4gIAo+PiAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX3NldHVw
X3NjYWxlcihzdHJ1Y3QgaW50ZWxfY3J0Y19zY2FsZXJfc3RhdGUgKnNjYWxlcl9zdGF0ZSwKPj4g
QEAgLTMxNiw3ICszMjAsNyBAQCBpbnQgaW50ZWxfYXRvbWljX3NldHVwX3NjYWxlcnMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+PiAgCXN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0
ZSAqcGxhbmVfc3RhdGUgPSBOVUxMOwo+PiAgCXN0cnVjdCBpbnRlbF9jcnRjX3NjYWxlcl9zdGF0
ZSAqc2NhbGVyX3N0YXRlID0KPj4gIAkJJmNydGNfc3RhdGUtPnNjYWxlcl9zdGF0ZTsKPj4gLQlz
dHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqZHJtX3N0YXRlID0gY3J0Y19zdGF0ZS0+YmFzZS5zdGF0
ZTsKPj4gKwlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqZHJtX3N0YXRlID0gY3J0Y19zdGF0ZS0+
dWFwaS5zdGF0ZTsKPj4gIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICppbnRlbF9zdGF0ZSA9
IHRvX2ludGVsX2F0b21pY19zdGF0ZShkcm1fc3RhdGUpOwo+PiAgCWludCBudW1fc2NhbGVyc19u
ZWVkOwo+PiAgCWludCBpOwo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9hdG9taWNfcGxhbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfYXRvbWljX3BsYW5lLmMKPj4gaW5kZXggNDc2ZWYwOTA2YmEwLi4xZjUwYjE1ZWM3MDQg
MTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWlj
X3BsYW5lLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9t
aWNfcGxhbmUuYwo+PiBAQCAtMjcxLDcgKzI3MSw3IEBAIHZvaWQgaW50ZWxfdXBkYXRlX3BsYW5l
KHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4+ICAJCQljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIAkJCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0
ZSAqcGxhbmVfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAKPj4gIAl0
cmFjZV9pbnRlbF91cGRhdGVfcGxhbmUoJnBsYW5lLT5iYXNlLCBjcnRjKTsKPj4gIAlwbGFuZS0+
dXBkYXRlX3BsYW5lKHBsYW5lLCBjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSk7Cj4+IEBAIC0yODEs
NyArMjgxLDcgQEAgdm9pZCBpbnRlbF91cGRhdGVfc2xhdmUoc3RydWN0IGludGVsX3BsYW5lICpw
bGFuZSwKPj4gIAkJCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
PiAgCQkJY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPj4gIHsK
Pj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAo+PiAgCXRyYWNlX2ludGVsX3VwZGF0ZV9wbGFu
ZSgmcGxhbmUtPmJhc2UsIGNydGMpOwo+PiAgCXBsYW5lLT51cGRhdGVfc2xhdmUocGxhbmUsIGNy
dGNfc3RhdGUsIHBsYW5lX3N0YXRlKTsKPj4gQEAgLTI5MCw3ICsyOTAsNyBAQCB2b2lkIGludGVs
X3VwZGF0ZV9zbGF2ZShzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lLAo+PiAgdm9pZCBpbnRlbF9k
aXNhYmxlX3BsYW5lKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4+ICAJCQkgY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGku
Y3J0Yyk7Cj4+ICAKPj4gIAl0cmFjZV9pbnRlbF9kaXNhYmxlX3BsYW5lKCZwbGFuZS0+YmFzZSwg
Y3J0Yyk7Cj4+ICAJcGxhbmUtPmRpc2FibGVfcGxhbmUocGxhbmUsIGNydGNfc3RhdGUpOwo+PiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdWRpby5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdWRpby5jCj4+IGluZGV4IGFhYzA4
OWM3OWNlYi4uMmVjZjFkZjBlZWRhIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2F1ZGlvLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9hdWRpby5jCj4+IEBAIC0yMzMsNyArMjMzLDcgQEAgc3RhdGljIGNvbnN0IHN0
cnVjdCBoZG1pX2F1ZF9uY3RzIGhkbWlfYXVkX25jdHNfMzZicHBbXSA9IHsKPj4gIHN0YXRpYyB1
MzIgYXVkaW9fY29uZmlnX2hkbWlfcGl4ZWxfY2xvY2soY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2Rl
Owo+PiArCQkmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAlpbnQgaTsKPj4gIAo+
PiAgCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGhkbWlfYXVkaW9fY2xvY2spOyBpKyspIHsK
Pj4gQEAgLTU1NCw3ICs1NTQsNyBAQCBzdGF0aWMgdm9pZCBpbGtfYXVkaW9fY29kZWNfZGlzYWJs
ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAkJCQkgICAgY29uc3Qgc3RydWN0
IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQo+PiAgewo+PiAgCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMob2xkX2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRj
LT5waXBlOwo+PiAgCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKPj4gIAl1MzIgdG1w
LCBlbGR2Owo+PiBAQCAtNjAxLDcgKzYwMSw3IEBAIHN0YXRpYyB2b2lkIGlsa19hdWRpb19jb2Rl
Y19lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICAJCQkJICAgY29uc3Qg
c3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4+ICB7Cj4+ICAJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7
Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5l
Y3RvciA9IGNvbm5fc3RhdGUtPmNvbm5lY3RvcjsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMt
PnBpcGU7Cj4+ICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+PiBAQCAtNjkxLDEw
ICs2OTEsMTAgQEAgdm9pZCBpbnRlbF9hdWRpb19jb2RlY19lbmFibGUoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+ICAJc3RydWN0IGk5MTVfYXVkaW9f
Y29tcG9uZW50ICphY29tcCA9IGRldl9wcml2LT5hdWRpb19jb21wb25lbnQ7Cj4+IC0Jc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IGNvbm5f
c3RhdGUtPmNvbm5lY3RvcjsKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRq
dXN0ZWRfbW9kZSA9Cj4+IC0JCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJ
CSZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+PiAgCWVudW0gcG9ydCBwb3J0ID0gZW5j
b2Rlci0+cG9ydDsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+ICAKPj4gQEAg
LTc1Miw3ICs3NTIsNyBAQCB2b2lkIGludGVsX2F1ZGlvX2NvZGVjX2Rpc2FibGUoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+ICAJc3RydWN0IGk5MTVf
YXVkaW9fY29tcG9uZW50ICphY29tcCA9IGRldl9wcml2LT5hdWRpb19jb21wb25lbnQ7Cj4+IC0J
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhv
bGRfY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXIt
PnBvcnQ7Cj4+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+PiAgCj4+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2J3LmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2J3LmMKPj4gaW5kZXggNjg4ODU4ZWJlNGQwLi5hODNh
Mjk3YmU5YTQgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfYncuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2J3LmMK
Pj4gQEAgLTI2NCw3ICsyNjQsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGludGVsX2J3X2NydGNf
bnVtX2FjdGl2ZV9wbGFuZXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdAo+PiAgCj4+ICBz
dGF0aWMgdW5zaWduZWQgaW50IGludGVsX2J3X2NydGNfZGF0YV9yYXRlKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMp
Owo+PiAgCXVuc2lnbmVkIGludCBkYXRhX3JhdGUgPSAwOwo+PiAgCWVudW0gcGxhbmVfaWQgcGxh
bmVfaWQ7Cj4+ICAKPj4gQEAgLTI4NSw3ICsyODUsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGlu
dGVsX2J3X2NydGNfZGF0YV9yYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
Xwo+PiAgdm9pZCBpbnRlbF9id19jcnRjX3VwZGF0ZShzdHJ1Y3QgaW50ZWxfYndfc3RhdGUgKmJ3
X3N0YXRlLAo+PiAgCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAo+PiAgCWJ3X3N0YXRlLT5kYXRh
X3JhdGVbY3J0Yy0+cGlwZV0gPQo+PiAgCQlpbnRlbF9id19jcnRjX2RhdGFfcmF0ZShjcnRjX3N0
YXRlKTsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
Y2RjbGsuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY2RjbGsuYwo+PiBp
bmRleCA0MzU2NDI5NWI4NjQuLjE3ZmZlN2ZiYWEyMSAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jZGNsay5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfY2RjbGsuYwo+PiBAQCAtMTkxNywxMCArMTkxNywxMCBAQCBz
dGF0aWMgaW50IGludGVsX3BpeGVsX3JhdGVfdG9fY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAo+PiAgaW50IGludGVsX2NydGNfY29tcHV0ZV9taW5fY2RjbGsoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+ICAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPj4gLQkJdG9faTkxNShjcnRjX3N0YXRlLT5iYXNl
LmNydGMtPmRldik7Cj4+ICsJCXRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+
PiAgCWludCBtaW5fY2RjbGs7Cj4+ICAKPj4gLQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuZW5hYmxl
KQo+PiArCWlmICghY3J0Y19zdGF0ZS0+aHcuZW5hYmxlKQo+PiAgCQlyZXR1cm4gMDsKPj4gIAo+
PiAgCW1pbl9jZGNsayA9IGludGVsX3BpeGVsX3JhdGVfdG9fY2RjbGsoZGV2X3ByaXYsIGNydGNf
c3RhdGUtPnBpeGVsX3JhdGUpOwo+PiBAQCAtMjA0Myw3ICsyMDQzLDcgQEAgc3RhdGljIHU4IGJ4
dF9jb21wdXRlX21pbl92b2x0YWdlX2xldmVsKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0
YXRlKQo+PiAgCSAgICAgICBzaXplb2Yoc3RhdGUtPm1pbl92b2x0YWdlX2xldmVsKSk7Cj4+ICAK
Pj4gIAlmb3JfZWFjaF9uZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0YywgY3J0Y19z
dGF0ZSwgaSkgewo+PiAtCQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5lbmFibGUpCj4+ICsJCWlmIChj
cnRjX3N0YXRlLT5ody5lbmFibGUpCj4+ICAJCQlzdGF0ZS0+bWluX3ZvbHRhZ2VfbGV2ZWxbaV0g
PQo+PiAgCQkJCWNydGNfc3RhdGUtPm1pbl92b2x0YWdlX2xldmVsOwo+PiAgCQllbHNlCj4+IEBA
IC0yMTI5LDcgKzIxMjksNyBAQCBzdGF0aWMgaW50IHNrbF9kcGxsMF92Y28oc3RydWN0IGludGVs
X2F0b21pY19zdGF0ZSAqc3RhdGUpCj4+ICAJCXZjbyA9IGRldl9wcml2LT5za2xfcHJlZmVycmVk
X3Zjb19mcmVxOwo+PiAgCj4+ICAJZm9yX2VhY2hfbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3Rh
dGUsIGNydGMsIGNydGNfc3RhdGUsIGkpIHsKPj4gLQkJaWYgKCFjcnRjX3N0YXRlLT5iYXNlLmVu
YWJsZSkKPj4gKwkJaWYgKCFjcnRjX3N0YXRlLT5ody5lbmFibGUpCj4+ICAJCQljb250aW51ZTsK
Pj4gIAo+PiAgCQlpZiAoIWludGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VU
UFVUX0VEUCkpCj4+IEBAIC0yMjU1LDExICsyMjU1LDExIEBAIHN0YXRpYyBpbnQgaW50ZWxfbW9k
ZXNldF9hbGxfcGlwZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4+ICAJCWlm
IChJU19FUlIoY3J0Y19zdGF0ZSkpCj4+ICAJCQlyZXR1cm4gUFRSX0VSUihjcnRjX3N0YXRlKTsK
Pj4gIAo+PiAtCQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlIHx8Cj4+IC0JCSAgICBkcm1f
YXRvbWljX2NydGNfbmVlZHNfbW9kZXNldCgmY3J0Y19zdGF0ZS0+YmFzZSkpCj4+ICsJCWlmICgh
Y3J0Y19zdGF0ZS0+aHcuYWN0aXZlIHx8Cj4+ICsJCSAgICBkcm1fYXRvbWljX2NydGNfbmVlZHNf
bW9kZXNldCgmY3J0Y19zdGF0ZS0+dWFwaSkpCj4+ICAJCQljb250aW51ZTsKPj4gIAo+PiAtCQlj
cnRjX3N0YXRlLT5iYXNlLm1vZGVfY2hhbmdlZCA9IHRydWU7Cj4+ICsJCWNydGNfc3RhdGUtPnVh
cGkubW9kZV9jaGFuZ2VkID0gdHJ1ZTsKPj4gIAo+PiAgCQlyZXQgPSBkcm1fYXRvbWljX2FkZF9h
ZmZlY3RlZF9jb25uZWN0b3JzKCZzdGF0ZS0+YmFzZSwKPj4gIAkJCQkJCQkgJmNydGMtPmJhc2Up
Owo+PiBAQCAtMjMxMCw3ICsyMzEwLDcgQEAgaW50IGludGVsX21vZGVzZXRfY2FsY19jZGNsayhz
dHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPj4gIAkJY3J0YyA9IGludGVsX2dldF9j
cnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKTsKPj4gIAkJY3J0Y19zdGF0ZSA9IGludGVsX2F0
b21pY19nZXRfbmV3X2NydGNfc3RhdGUoc3RhdGUsIGNydGMpOwo+PiAgCQlpZiAoY3J0Y19zdGF0
ZSAmJgo+PiAtCQkgICAgZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQoJmNydGNfc3RhdGUt
PmJhc2UpKQo+PiArCQkgICAgZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQoJmNydGNfc3Rh
dGUtPnVhcGkpKQo+PiAgCQkJcGlwZSA9IElOVkFMSURfUElQRTsKPj4gIAl9IGVsc2Ugewo+PiAg
CQlwaXBlID0gSU5WQUxJRF9QSVBFOwo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9jb2xvci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9jb2xvci5jCj4+IGluZGV4IDMxODMwOGRjMTM2Yy4uOWIwNTg5MDdlZjRlIDEwMDY0NAo+
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2NvbG9yLmMKPj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9jb2xvci5jCj4+IEBAIC0xMDEs
MTAgKzEwMSwxMCBAQCBzdGF0aWMgYm9vbCBsdXRfaXNfbGVnYWN5KGNvbnN0IHN0cnVjdCBkcm1f
cHJvcGVydHlfYmxvYiAqbHV0KQo+PiAgCj4+ICBzdGF0aWMgYm9vbCBjcnRjX3N0YXRlX2lzX2xl
Z2FjeV9nYW1tYShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4g
IHsKPj4gLQlyZXR1cm4gIWNydGNfc3RhdGUtPmJhc2UuZGVnYW1tYV9sdXQgJiYKPj4gLQkJIWNy
dGNfc3RhdGUtPmJhc2UuY3RtICYmCj4+IC0JCWNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0ICYm
Cj4+IC0JCWx1dF9pc19sZWdhY3koY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQpOwo+PiArCXJl
dHVybiAhY3J0Y19zdGF0ZS0+aHcuZGVnYW1tYV9sdXQgJiYKPj4gKwkJIWNydGNfc3RhdGUtPmh3
LmN0bSAmJgo+PiArCQljcnRjX3N0YXRlLT5ody5nYW1tYV9sdXQgJiYKPj4gKwkJbHV0X2lzX2xl
Z2FjeShjcnRjX3N0YXRlLT5ody5nYW1tYV9sdXQpOwo+PiAgfQo+PiAgCj4+ICAvKgo+PiBAQCAt
MTg5LDcgKzE4OSw3IEBAIHN0YXRpYyB2b2lkIGljbF91cGRhdGVfb3V0cHV0X2NzYyhzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YywKPj4gIAo+PiAgc3RhdGljIGJvb2wgaWxrX2NzY19saW1pdGVkX3Jh
bmdlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAt
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjLT5kZXYpOwo+PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+PiAgCj4+ICAJLyoKPj4gIAkg
KiBGSVhNRSBpZiB0aGVyZSdzIGEgZ2FtbWEgTFVUIGFmdGVyIHRoZSBDU0MsIHdlIHNob3VsZAo+
PiBAQCAtMjAzLDcgKzIwMyw3IEBAIHN0YXRpYyBib29sIGlsa19jc2NfbGltaXRlZF9yYW5nZShj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHN0YXRpYyB2b2lk
IGlsa19jc2NfY29udmVydF9jdG0oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCj4+ICAJCQkJdTE2IGNvZWZmc1s5XSkKPj4gIHsKPj4gLQljb25zdCBzdHJ1Y3QgZHJt
X2NvbG9yX2N0bSAqY3RtID0gY3J0Y19zdGF0ZS0+YmFzZS5jdG0tPmRhdGE7Cj4+ICsJY29uc3Qg
c3RydWN0IGRybV9jb2xvcl9jdG0gKmN0bSA9IGNydGNfc3RhdGUtPmh3LmN0bS0+ZGF0YTsKPj4g
IAljb25zdCB1NjQgKmlucHV0Owo+PiAgCXU2NCB0ZW1wWzldOwo+PiAgCWludCBpOwo+PiBAQCAt
MjU0LDExICsyNTQsMTEgQEAgc3RhdGljIHZvaWQgaWxrX2NzY19jb252ZXJ0X2N0bShjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIAo+PiAgc3RhdGljIHZvaWQg
aWxrX2xvYWRfY3NjX21hdHJpeChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gIAlib29sIGxp
bWl0ZWRfY29sb3JfcmFuZ2UgPSBpbGtfY3NjX2xpbWl0ZWRfcmFuZ2UoY3J0Y19zdGF0ZSk7Cj4+
ICAKPj4gLQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5jdG0pIHsKPj4gKwlpZiAoY3J0Y19zdGF0ZS0+
aHcuY3RtKSB7Cj4+ICAJCXUxNiBjb2VmZls5XTsKPj4gIAo+PiAgCQlpbGtfY3NjX2NvbnZlcnRf
Y3RtKGNydGNfc3RhdGUsIGNvZWZmKTsKPj4gQEAgLTI5MywxMCArMjkzLDEwIEBAIHN0YXRpYyB2
b2lkIGlsa19sb2FkX2NzY19tYXRyaXgoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4+ICAKPj4gIHN0YXRpYyB2b2lkIGljbF9sb2FkX2NzY19tYXRyaXgoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+
ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVh
cGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4+ICAKPj4gLQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5jdG0pIHsK
Pj4gKwlpZiAoY3J0Y19zdGF0ZS0+aHcuY3RtKSB7Cj4+ICAJCXUxNiBjb2VmZls5XTsKPj4gIAo+
PiAgCQlpbGtfY3NjX2NvbnZlcnRfY3RtKGNydGNfc3RhdGUsIGNvZWZmKTsKPj4gQEAgLTMyMiwx
MiArMzIyLDEyIEBAIHN0YXRpYyB2b2lkIGljbF9sb2FkX2NzY19tYXRyaXgoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICAgKi8KPj4gIHN0YXRpYyB2b2lkIGNo
ZXJyeXZpZXdfbG9hZF9jc2NfbWF0cml4KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCWVu
dW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gIAo+PiAtCWlmIChjcnRjX3N0YXRlLT5iYXNl
LmN0bSkgewo+PiAtCQljb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2N0bSAqY3RtID0gY3J0Y19zdGF0
ZS0+YmFzZS5jdG0tPmRhdGE7Cj4+ICsJaWYgKGNydGNfc3RhdGUtPmh3LmN0bSkgewo+PiArCQlj
b25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2N0bSAqY3RtID0gY3J0Y19zdGF0ZS0+aHcuY3RtLT5kYXRh
Owo+PiAgCQl1MTYgY29lZmZzWzldID0ge307Cj4+ICAJCWludCBpOwo+PiAgCj4+IEBAIC0zODgs
NyArMzg4LDcgQEAgc3RhdGljIHUzMiBpbGtfbHV0XzEwKGNvbnN0IHN0cnVjdCBkcm1fY29sb3Jf
bHV0ICpjb2xvcikKPj4gIHN0YXRpYyB2b2lkIGk5eHhfbG9hZF9sdXRzX2ludGVybmFsKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCQkJCSAgICBjb25zdCBz
dHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmJsb2IpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0
Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+PiAgCWludCBp
Owo+PiBAQCAtNDE5LDEyICs0MTksMTIgQEAgc3RhdGljIHZvaWQgaTl4eF9sb2FkX2x1dHNfaW50
ZXJuYWwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAKPj4g
IHN0YXRpYyB2b2lkIGk5eHhfbG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCWk5eHhfbG9hZF9sdXRzX2ludGVybmFsKGNydGNfc3Rh
dGUsIGNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0KTsKPj4gKwlpOXh4X2xvYWRfbHV0c19pbnRl
cm5hbChjcnRjX3N0YXRlLCBjcnRjX3N0YXRlLT5ody5nYW1tYV9sdXQpOwo+PiAgfQo+PiAgCj4+
ICBzdGF0aWMgdm9pZCBpOXh4X2NvbG9yX2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsK
Pj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+ICAJdTMyIHZhbDsKPj4gQEAgLTQz
Nyw3ICs0MzcsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X2NvbG9yX2NvbW1pdChjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIAo+PiAgc3RhdGljIHZvaWQgaWxrX2Nv
bG9yX2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4g
IHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9
IGNydGMtPnBpcGU7Cj4+ICAJdTMyIHZhbDsKPj4gQEAgLTQ1Miw3ICs0NTIsNyBAQCBzdGF0aWMg
dm9pZCBpbGtfY29sb3JfY29tbWl0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+PiAgCj4+ICBzdGF0aWMgdm9pZCBoc3dfY29sb3JfY29tbWl0KGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNy
dGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+PiAgCj4+ICAJSTkxNV9XUklURShHQU1NQV9NT0RFKGNydGMtPnBpcGUp
LCBjcnRjX3N0YXRlLT5nYW1tYV9tb2RlKTsKPj4gQEAgLTQ2Miw3ICs0NjIsNyBAQCBzdGF0aWMg
dm9pZCBoc3dfY29sb3JfY29tbWl0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+PiAgCj4+ICBzdGF0aWMgdm9pZCBza2xfY29sb3JfY29tbWl0KGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNy
dGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gIAl1MzIg
dmFsID0gMDsKPj4gQEAgLTUwOCw4ICs1MDgsOCBAQCBzdGF0aWMgdm9pZCBpOTY1X2xvYWRfbHV0
XzEwcDYoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4+ICAKPj4gIHN0YXRpYyB2b2lkIGk5NjVf
bG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAg
ewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+PiAtCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZ2FtbWFf
bHV0ID0gY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQ7Cj4+ICsJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICsJY29uc3Qg
c3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpnYW1tYV9sdXQgPSBjcnRjX3N0YXRlLT5ody5nYW1t
YV9sdXQ7Cj4+ICAKPj4gIAlpZiAoY3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSA9PSBHQU1NQV9NT0RF
X01PREVfOEJJVCkKPj4gIAkJaTl4eF9sb2FkX2x1dHMoY3J0Y19zdGF0ZSk7Cj4+IEBAIC01MzEs
OCArNTMxLDggQEAgc3RhdGljIHZvaWQgaWxrX2xvYWRfbHV0XzEwKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjLAo+PiAgCj4+ICBzdGF0aWMgdm9pZCBpbGtfbG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiAtCWNvbnN0
IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZ2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+YmFzZS5n
YW1tYV9sdXQ7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNy
dGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9i
ICpnYW1tYV9sdXQgPSBjcnRjX3N0YXRlLT5ody5nYW1tYV9sdXQ7Cj4+ICAKPj4gIAlpZiAoY3J0
Y19zdGF0ZS0+Z2FtbWFfbW9kZSA9PSBHQU1NQV9NT0RFX01PREVfOEJJVCkKPj4gIAkJaTl4eF9s
b2FkX2x1dHMoY3J0Y19zdGF0ZSk7Cj4+IEBAIC02MzIsOSArNjMyLDkgQEAgc3RhdGljIHZvaWQg
aXZiX2xvYWRfbHV0X2V4dF9tYXgoc3RydWN0IGludGVsX2NydGMgKmNydGMpCj4+ICAKPj4gIHN0
YXRpYyB2b2lkIGl2Yl9sb2FkX2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+IC0JY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0
eV9ibG9iICpnYW1tYV9sdXQgPSBjcnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1dDsKPj4gLQljb25z
dCBzdHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmRlZ2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+YmFz
ZS5kZWdhbW1hX2x1dDsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gKwljb25zdCBzdHJ1Y3QgZHJtX3Byb3BlcnR5
X2Jsb2IgKmdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dDsKPj4gKwljb25zdCBz
dHJ1Y3QgZHJtX3Byb3BlcnR5X2Jsb2IgKmRlZ2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+aHcuZGVn
YW1tYV9sdXQ7Cj4+ICAKPj4gIAlpZiAoY3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSA9PSBHQU1NQV9N
T0RFX01PREVfOEJJVCkgewo+PiAgCQlpOXh4X2xvYWRfbHV0cyhjcnRjX3N0YXRlKTsKPj4gQEAg
LTY1NSw5ICs2NTUsOSBAQCBzdGF0aWMgdm9pZCBpdmJfbG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgCj4+ICBzdGF0aWMgdm9pZCBiZHdfbG9h
ZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+PiAtCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZ2FtbWFfbHV0
ID0gY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQ7Cj4+IC0JY29uc3Qgc3RydWN0IGRybV9wcm9w
ZXJ0eV9ibG9iICpkZWdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmJhc2UuZGVnYW1tYV9sdXQ7Cj4+
ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVh
cGkuY3J0Yyk7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpnYW1tYV9sdXQg
PSBjcnRjX3N0YXRlLT5ody5nYW1tYV9sdXQ7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0
eV9ibG9iICpkZWdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmh3LmRlZ2FtbWFfbHV0Owo+PiAgCj4+
ICAJaWYgKGNydGNfc3RhdGUtPmdhbW1hX21vZGUgPT0gR0FNTUFfTU9ERV9NT0RFXzhCSVQpIHsK
Pj4gIAkJaTl4eF9sb2FkX2x1dHMoY3J0Y19zdGF0ZSk7Cj4+IEBAIC02NzgsMTEgKzY3OCwxMSBA
QCBzdGF0aWMgdm9pZCBiZHdfbG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKQo+PiAgCj4+ICBzdGF0aWMgdm9pZCBnbGtfbG9hZF9kZWdhbW1hX2x1dChj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRj
KTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7
Cj4+ICAJY29uc3QgdTMyIGx1dF9zaXplID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPmNvbG9yLmRl
Z2FtbWFfbHV0X3NpemU7Cj4+IC0JY29uc3Qgc3RydWN0IGRybV9jb2xvcl9sdXQgKmx1dCA9IGNy
dGNfc3RhdGUtPmJhc2UuZGVnYW1tYV9sdXQtPmRhdGE7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9j
b2xvcl9sdXQgKmx1dCA9IGNydGNfc3RhdGUtPmh3LmRlZ2FtbWFfbHV0LT5kYXRhOwo+PiAgCXUz
MiBpOwo+PiAgCj4+ICAJLyoKPj4gQEAgLTcxNyw3ICs3MTcsNyBAQCBzdGF0aWMgdm9pZCBnbGtf
bG9hZF9kZWdhbW1hX2x1dChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPj4gIAo+PiAgc3RhdGljIHZvaWQgZ2xrX2xvYWRfZGVnYW1tYV9sdXRfbGluZWFyKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+
PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51
YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4g
IAljb25zdCB1MzIgbHV0X3NpemUgPSBJTlRFTF9JTkZPKGRldl9wcml2KS0+Y29sb3IuZGVnYW1t
YV9sdXRfc2l6ZTsKPj4gQEAgLTc0NCw4ICs3NDQsOCBAQCBzdGF0aWMgdm9pZCBnbGtfbG9hZF9k
ZWdhbW1hX2x1dF9saW5lYXIoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dAo+PiAgCj4+ICBzdGF0aWMgdm9pZCBnbGtfbG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVy
dHlfYmxvYiAqZ2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQ7Cj4+IC0Jc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpnYW1tYV9sdXQgPSBjcnRj
X3N0YXRlLT5ody5nYW1tYV9sdXQ7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAKPj4gIAkvKgo+PiAgCSAqIE9u
IEdMSysgYm90aCBwaXBlIENTQyBhbmQgZGVnYW1tYSBMVVQgYXJlIGNvbnRyb2xsZWQKPj4gQEAg
LTc1NSw3ICs3NTUsNyBAQCBzdGF0aWMgdm9pZCBnbGtfbG9hZF9sdXRzKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgCSAqIHRoZSBkZWdhbWEgTFVUIHNvIHRo
YXQgd2UgZG9uJ3QgaGF2ZSB0byByZWxvYWQKPj4gIAkgKiBpdCBldmVyeSB0aW1lIHRoZSBwaXBl
IENTQyBpcyBiZWluZyBlbmFibGVkLgo+PiAgCSAqLwo+PiAtCWlmIChjcnRjX3N0YXRlLT5iYXNl
LmRlZ2FtbWFfbHV0KQo+PiArCWlmIChjcnRjX3N0YXRlLT5ody5kZWdhbW1hX2x1dCkKPj4gIAkJ
Z2xrX2xvYWRfZGVnYW1tYV9sdXQoY3J0Y19zdGF0ZSk7Cj4+ICAJZWxzZQo+PiAgCQlnbGtfbG9h
ZF9kZWdhbW1hX2x1dF9saW5lYXIoY3J0Y19zdGF0ZSk7Cj4+IEBAIC03ODYsNyArNzg2LDcgQEAg
c3RhdGljIHZvaWQKPj4gIGljbF9sb2FkX2djbWF4KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlLAo+PiAgCSAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAq
Y29sb3IpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJZW51bSBw
aXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+PiAgCj4+IEBAIC03OTksOSArNzk5LDkgQEAgaWNsX2xv
YWRfZ2NtYXgoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICBz
dGF0aWMgdm9pZAo+PiAgaWNsX3Byb2dyYW1fZ2FtbWFfc3VwZXJmaW5lX3NlZ21lbnQoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+
ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVh
cGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjLT5iYXNlLmRldik7Cj4+IC0JY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpi
bG9iID0gY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQ7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9w
cm9wZXJ0eV9ibG9iICpibG9iID0gY3J0Y19zdGF0ZS0+aHcuZ2FtbWFfbHV0Owo+PiAgCWNvbnN0
IHN0cnVjdCBkcm1fY29sb3JfbHV0ICpsdXQgPSBibG9iLT5kYXRhOwo+PiAgCWVudW0gcGlwZSBw
aXBlID0gY3J0Yy0+cGlwZTsKPj4gIAl1MzIgaTsKPj4gQEAgLTgyOCw5ICs4MjgsOSBAQCBpY2xf
cHJvZ3JhbV9nYW1tYV9zdXBlcmZpbmVfc2VnbWVudChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHN0YXRpYyB2b2lkCj4+ICBpY2xfcHJvZ3JhbV9nYW1tYV9t
dWx0aV9zZWdtZW50KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAtCWNvbnN0IHN0cnVjdCBk
cm1fcHJvcGVydHlfYmxvYiAqYmxvYiA9IGNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0Owo+PiAr
CWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqYmxvYiA9IGNydGNfc3RhdGUtPmh3Lmdh
bW1hX2x1dDsKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqbHV0ID0gYmxvYi0+ZGF0
YTsKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX2NvbG9yX2x1dCAqZW50cnk7Cj4+ICAJZW51bSBwaXBl
IHBpcGUgPSBjcnRjLT5waXBlOwo+PiBAQCAtODgwLDEwICs4ODAsMTAgQEAgaWNsX3Byb2dyYW1f
Z2FtbWFfbXVsdGlfc2VnbWVudChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPj4gIAo+PiAgc3RhdGljIHZvaWQgaWNsX2xvYWRfbHV0cyhjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQljb25zdCBzdHJ1Y3QgZHJtX3By
b3BlcnR5X2Jsb2IgKmdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0Owo+PiAt
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNl
LmNydGMpOwo+PiArCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZ2FtbWFfbHV0ID0g
Y3J0Y19zdGF0ZS0+aHcuZ2FtbWFfbHV0Owo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCj4+IC0JaWYgKGNydGNf
c3RhdGUtPmJhc2UuZGVnYW1tYV9sdXQpCj4+ICsJaWYgKGNydGNfc3RhdGUtPmh3LmRlZ2FtbWFf
bHV0KQo+PiAgCQlnbGtfbG9hZF9kZWdhbW1hX2x1dChjcnRjX3N0YXRlKTsKPj4gIAo+PiAgCXN3
aXRjaCAoY3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSAmIEdBTU1BX01PREVfTU9ERV9NQVNLKSB7Cj4+
IEBAIC05NTgsOSArOTU4LDkgQEAgc3RhdGljIHZvaWQgY2h2X2xvYWRfY2dtX2dhbW1hKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAo+PiAgCj4+ICBzdGF0aWMgdm9pZCBjaHZfbG9hZF9sdXRzKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+PiAtCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZ2FtbWFfbHV0ID0gY3J0Y19z
dGF0ZS0+YmFzZS5nYW1tYV9sdXQ7Cj4+IC0JY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9i
ICpkZWdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmJhc2UuZGVnYW1tYV9sdXQ7Cj4+ICsJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7
Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpnYW1tYV9sdXQgPSBjcnRjX3N0
YXRlLT5ody5nYW1tYV9sdXQ7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICpk
ZWdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmh3LmRlZ2FtbWFfbHV0Owo+PiAgCj4+ICAJY2hlcnJ5
dmlld19sb2FkX2NzY19tYXRyaXgoY3J0Y19zdGF0ZSk7Cj4+ICAKPj4gQEAgLTk3OCwyOCArOTc4
LDI4IEBAIHN0YXRpYyB2b2lkIGNodl9sb2FkX2x1dHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4+ICAKPj4gIHZvaWQgaW50ZWxfY29sb3JfbG9hZF9sdXRzKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjLT5kZXYpOwo+PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+PiAgCj4+ICAJZGV2X3ByaXYtPmRpc3Bs
YXkubG9hZF9sdXRzKGNydGNfc3RhdGUpOwo+PiAgfQo+PiAgCj4+ICB2b2lkIGludGVsX2NvbG9y
X2NvbW1pdChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsK
Pj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPj4gIAo+PiAgCWRldl9w
cml2LT5kaXNwbGF5LmNvbG9yX2NvbW1pdChjcnRjX3N0YXRlKTsKPj4gIH0KPj4gIAo+PiAgaW50
IGludGVsX2NvbG9yX2NoZWNrKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
PiAgewo+PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+PiAgCj4+ICAJ
cmV0dXJuIGRldl9wcml2LT5kaXNwbGF5LmNvbG9yX2NoZWNrKGNydGNfc3RhdGUpOwo+PiAgfQo+
PiAgCj4+ICB2b2lkIGludGVsX2NvbG9yX2dldF9jb25maWcoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMt
PmRldik7Cj4+ICAKPj4gIAlpZiAoZGV2X3ByaXYtPmRpc3BsYXkucmVhZF9sdXRzKQo+PiAgCQlk
ZXZfcHJpdi0+ZGlzcGxheS5yZWFkX2x1dHMoY3J0Y19zdGF0ZSk7Cj4+IEBAIC0xMDIzLDE2ICsx
MDIzLDE2IEBAIHN0YXRpYyBib29sIG5lZWRfcGxhbmVfdXBkYXRlKHN0cnVjdCBpbnRlbF9wbGFu
ZSAqcGxhbmUsCj4+ICBzdGF0aWMgaW50Cj4+ICBpbnRlbF9jb2xvcl9hZGRfYWZmZWN0ZWRfcGxh
bmVzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJh
c2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5l
d19jcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCXN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlID0KPj4gLQkJdG9faW50ZWxfYXRvbWljX3N0YXRlKG5ld19jcnRjX3N0
YXRlLT5iYXNlLnN0YXRlKTsKPj4gKwkJdG9faW50ZWxfYXRvbWljX3N0YXRlKG5ld19jcnRjX3N0
YXRlLT51YXBpLnN0YXRlKTsKPj4gIAljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xk
X2NydGNfc3RhdGUgPQo+PiAgCQlpbnRlbF9hdG9taWNfZ2V0X29sZF9jcnRjX3N0YXRlKHN0YXRl
LCBjcnRjKTsKPj4gIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lOwo+PiAgCj4+IC0JaWYgKCFu
ZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUgfHwKPj4gLQkgICAgZHJtX2F0b21pY19jcnRjX25l
ZWRzX21vZGVzZXQoJm5ld19jcnRjX3N0YXRlLT5iYXNlKSkKPj4gKwlpZiAoIW5ld19jcnRjX3N0
YXRlLT5ody5hY3RpdmUgfHwKPj4gKwkgICAgZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQo
Jm5ld19jcnRjX3N0YXRlLT51YXBpKSkKPj4gIAkJcmV0dXJuIDA7Cj4+ICAKPj4gIAlpZiAobmV3
X2NydGNfc3RhdGUtPmdhbW1hX2VuYWJsZSA9PSBvbGRfY3J0Y19zdGF0ZS0+Z2FtbWFfZW5hYmxl
ICYmCj4+IEBAIC0xMDc0LDkgKzEwNzQsOSBAQCBzdGF0aWMgaW50IGNoZWNrX2x1dF9zaXplKGNv
bnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqbHV0LCBpbnQgZXhwZWN0ZWQpCj4+ICAKPj4g
IHN0YXRpYyBpbnQgY2hlY2tfbHV0cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPj4gLQljb25zdCBzdHJ1Y3QgZHJt
X3Byb3BlcnR5X2Jsb2IgKmdhbW1hX2x1dCA9IGNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0Owo+
PiAtCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZGVnYW1tYV9sdXQgPSBjcnRjX3N0
YXRlLT5iYXNlLmRlZ2FtbWFfbHV0Owo+PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+PiArCWNvbnN0IHN0
cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZ2FtbWFfbHV0ID0gY3J0Y19zdGF0ZS0+aHcuZ2FtbWFf
bHV0Owo+PiArCWNvbnN0IHN0cnVjdCBkcm1fcHJvcGVydHlfYmxvYiAqZGVnYW1tYV9sdXQgPSBj
cnRjX3N0YXRlLT5ody5kZWdhbW1hX2x1dDsKPj4gIAlpbnQgZ2FtbWFfbGVuZ3RoLCBkZWdhbW1h
X2xlbmd0aDsKPj4gIAl1MzIgZ2FtbWFfdGVzdHMsIGRlZ2FtbWFfdGVzdHM7Cj4+ICAKPj4gQEAg
LTExMjQsNyArMTEyNCw3IEBAIHN0YXRpYyBpbnQgaTl4eF9jb2xvcl9jaGVjayhzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIAkJcmV0dXJuIHJldDsKPj4gIAo+PiAgCWNy
dGNfc3RhdGUtPmdhbW1hX2VuYWJsZSA9Cj4+IC0JCWNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0
ICYmCj4+ICsJCWNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dCAmJgo+PiAgCQkhY3J0Y19zdGF0ZS0+
YzhfcGxhbmVzOwo+PiAgCj4+ICAJY3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSA9IGk5eHhfZ2FtbWFf
bW9kZShjcnRjX3N0YXRlKTsKPj4gQEAgLTExNDMsMTEgKzExNDMsMTEgQEAgc3RhdGljIHUzMiBj
aHZfY2dtX21vZGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+
ICAJaWYgKGNydGNfc3RhdGVfaXNfbGVnYWN5X2dhbW1hKGNydGNfc3RhdGUpKQo+PiAgCQlyZXR1
cm4gMDsKPj4gIAo+PiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmRlZ2FtbWFfbHV0KQo+PiArCWlm
IChjcnRjX3N0YXRlLT5ody5kZWdhbW1hX2x1dCkKPj4gIAkJY2dtX21vZGUgfD0gQ0dNX1BJUEVf
TU9ERV9ERUdBTU1BOwo+PiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmN0bSkKPj4gKwlpZiAoY3J0
Y19zdGF0ZS0+aHcuY3RtKQo+PiAgCQljZ21fbW9kZSB8PSBDR01fUElQRV9NT0RFX0NTQzsKPj4g
LQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQpCj4+ICsJaWYgKGNydGNfc3RhdGUtPmh3
LmdhbW1hX2x1dCkKPj4gIAkJY2dtX21vZGUgfD0gQ0dNX1BJUEVfTU9ERV9HQU1NQTsKPj4gIAo+
PiAgCXJldHVybiBjZ21fbW9kZTsKPj4gQEAgLTEyMDYsNyArMTIwNiw3IEBAIHN0YXRpYyBpbnQg
aWxrX2NvbG9yX2NoZWNrKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAg
CQlyZXR1cm4gcmV0Owo+PiAgCj4+ICAJY3J0Y19zdGF0ZS0+Z2FtbWFfZW5hYmxlID0KPj4gLQkJ
Y3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQgJiYKPj4gKwkJY3J0Y19zdGF0ZS0+aHcuZ2FtbWFf
bHV0ICYmCj4+ICAJCSFjcnRjX3N0YXRlLT5jOF9wbGFuZXM7Cj4+ICAKPj4gIAkvKgo+PiBAQCAt
MTIzMiw4ICsxMjMyLDggQEAgc3RhdGljIHUzMiBpdmJfZ2FtbWFfbW9kZShjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIAlpZiAoIWNydGNfc3RhdGUtPmdhbW1h
X2VuYWJsZSB8fAo+PiAgCSAgICBjcnRjX3N0YXRlX2lzX2xlZ2FjeV9nYW1tYShjcnRjX3N0YXRl
KSkKPj4gIAkJcmV0dXJuIEdBTU1BX01PREVfTU9ERV84QklUOwo+PiAtCWVsc2UgaWYgKGNydGNf
c3RhdGUtPmJhc2UuZ2FtbWFfbHV0ICYmCj4+IC0JCSBjcnRjX3N0YXRlLT5iYXNlLmRlZ2FtbWFf
bHV0KQo+PiArCWVsc2UgaWYgKGNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dCAmJgo+PiArCQkgY3J0
Y19zdGF0ZS0+aHcuZGVnYW1tYV9sdXQpCj4+ICAJCXJldHVybiBHQU1NQV9NT0RFX01PREVfU1BM
SVQ7Cj4+ICAJZWxzZQo+PiAgCQlyZXR1cm4gR0FNTUFfTU9ERV9NT0RFXzEwQklUOwo+PiBAQCAt
MTI0Nyw3ICsxMjQ3LDcgQEAgc3RhdGljIHUzMiBpdmJfY3NjX21vZGUoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICAJICogQ1NDIGNvbWVzIGFmdGVyIHRoZSBM
VVQgaW4gZGVnYW1tYSwgUkdCLT5ZQ2JDciwKPj4gIAkgKiBhbmQgUkdCIGZ1bGwtPmxpbWl0ZWQg
cmFuZ2UgbW9kZS4KPj4gIAkgKi8KPj4gLQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5kZWdhbW1hX2x1
dCB8fAo+PiArCWlmIChjcnRjX3N0YXRlLT5ody5kZWdhbW1hX2x1dCB8fAo+PiAgCSAgICBjcnRj
X3N0YXRlLT5vdXRwdXRfZm9ybWF0ICE9IElOVEVMX09VVFBVVF9GT1JNQVRfUkdCIHx8Cj4+ICAJ
ICAgIGxpbWl0ZWRfY29sb3JfcmFuZ2UpCj4+ICAJCXJldHVybiAwOwo+PiBAQCAtMTI2NSwxMyAr
MTI2NSwxMyBAQCBzdGF0aWMgaW50IGl2Yl9jb2xvcl9jaGVjayhzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIAkJcmV0dXJuIHJldDsKPj4gIAo+PiAgCWNydGNfc3RhdGUt
PmdhbW1hX2VuYWJsZSA9Cj4+IC0JCShjcnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1dCB8fAo+PiAt
CQkgY3J0Y19zdGF0ZS0+YmFzZS5kZWdhbW1hX2x1dCkgJiYKPj4gKwkJKGNydGNfc3RhdGUtPmh3
LmdhbW1hX2x1dCB8fAo+PiArCQkgY3J0Y19zdGF0ZS0+aHcuZGVnYW1tYV9sdXQpICYmCj4+ICAJ
CSFjcnRjX3N0YXRlLT5jOF9wbGFuZXM7Cj4+ICAKPj4gIAljcnRjX3N0YXRlLT5jc2NfZW5hYmxl
ID0KPj4gIAkJY3J0Y19zdGF0ZS0+b3V0cHV0X2Zvcm1hdCAhPSBJTlRFTF9PVVRQVVRfRk9STUFU
X1JHQiB8fAo+PiAtCQljcnRjX3N0YXRlLT5iYXNlLmN0bSB8fCBsaW1pdGVkX2NvbG9yX3Jhbmdl
Owo+PiArCQljcnRjX3N0YXRlLT5ody5jdG0gfHwgbGltaXRlZF9jb2xvcl9yYW5nZTsKPj4gIAo+
PiAgCWNydGNfc3RhdGUtPmdhbW1hX21vZGUgPSBpdmJfZ2FtbWFfbW9kZShjcnRjX3N0YXRlKTsK
Pj4gIAo+PiBAQCAtMTMwMiwxNCArMTMwMiwxNCBAQCBzdGF0aWMgaW50IGdsa19jb2xvcl9jaGVj
ayhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIAkJcmV0dXJuIHJldDsK
Pj4gIAo+PiAgCWNydGNfc3RhdGUtPmdhbW1hX2VuYWJsZSA9Cj4+IC0JCWNydGNfc3RhdGUtPmJh
c2UuZ2FtbWFfbHV0ICYmCj4+ICsJCWNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dCAmJgo+PiAgCQkh
Y3J0Y19zdGF0ZS0+YzhfcGxhbmVzOwo+PiAgCj4+ICAJLyogT24gR0xLKyBkZWdhbW1hIExVVCBp
cyBjb250cm9sbGVkIGJ5IGNzY19lbmFibGUgKi8KPj4gIAljcnRjX3N0YXRlLT5jc2NfZW5hYmxl
ID0KPj4gLQkJY3J0Y19zdGF0ZS0+YmFzZS5kZWdhbW1hX2x1dCB8fAo+PiArCQljcnRjX3N0YXRl
LT5ody5kZWdhbW1hX2x1dCB8fAo+PiAgCQljcnRjX3N0YXRlLT5vdXRwdXRfZm9ybWF0ICE9IElO
VEVMX09VVFBVVF9GT1JNQVRfUkdCIHx8Cj4+IC0JCWNydGNfc3RhdGUtPmJhc2UuY3RtIHx8IGNy
dGNfc3RhdGUtPmxpbWl0ZWRfY29sb3JfcmFuZ2U7Cj4+ICsJCWNydGNfc3RhdGUtPmh3LmN0bSB8
fCBjcnRjX3N0YXRlLT5saW1pdGVkX2NvbG9yX3JhbmdlOwo+PiAgCj4+ICAJY3J0Y19zdGF0ZS0+
Z2FtbWFfbW9kZSA9IGdsa19nYW1tYV9tb2RlKGNydGNfc3RhdGUpOwo+PiAgCj4+IEBAIC0xMzI2
LDE0ICsxMzI2LDE0IEBAIHN0YXRpYyB1MzIgaWNsX2dhbW1hX21vZGUoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+ICAJdTMyIGdhbW1hX21vZGUgPSAw
Owo+PiAgCj4+IC0JaWYgKGNydGNfc3RhdGUtPmJhc2UuZGVnYW1tYV9sdXQpCj4+ICsJaWYgKGNy
dGNfc3RhdGUtPmh3LmRlZ2FtbWFfbHV0KQo+PiAgCQlnYW1tYV9tb2RlIHw9IFBSRV9DU0NfR0FN
TUFfRU5BQkxFOwo+PiAgCj4+IC0JaWYgKGNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0ICYmCj4+
ICsJaWYgKGNydGNfc3RhdGUtPmh3LmdhbW1hX2x1dCAmJgo+PiAgCSAgICAhY3J0Y19zdGF0ZS0+
YzhfcGxhbmVzKQo+PiAgCQlnYW1tYV9tb2RlIHw9IFBPU1RfQ1NDX0dBTU1BX0VOQUJMRTsKPj4g
IAo+PiAtCWlmICghY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQgfHwKPj4gKwlpZiAoIWNydGNf
c3RhdGUtPmh3LmdhbW1hX2x1dCB8fAo+PiAgCSAgICBjcnRjX3N0YXRlX2lzX2xlZ2FjeV9nYW1t
YShjcnRjX3N0YXRlKSkKPj4gIAkJZ2FtbWFfbW9kZSB8PSBHQU1NQV9NT0RFX01PREVfOEJJVDsK
Pj4gIAllbHNlCj4+IEBAIC0xMzQ2LDcgKzEzNDYsNyBAQCBzdGF0aWMgdTMyIGljbF9jc2NfbW9k
ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gIAl1
MzIgY3NjX21vZGUgPSAwOwo+PiAgCj4+IC0JaWYgKGNydGNfc3RhdGUtPmJhc2UuY3RtKQo+PiAr
CWlmIChjcnRjX3N0YXRlLT5ody5jdG0pCj4+ICAJCWNzY19tb2RlIHw9IElDTF9DU0NfRU5BQkxF
Owo+PiAgCj4+ICAJaWYgKGNydGNfc3RhdGUtPm91dHB1dF9mb3JtYXQgIT0gSU5URUxfT1VUUFVU
X0ZPUk1BVF9SR0IgfHwKPj4gQEAgLTE0MjMsNyArMTQyMyw3IEBAIHN0YXRpYyBpbnQgZ2xrX2dh
bW1hX3ByZWNpc2lvbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
Pj4gIAo+PiAgaW50IGludGVsX2NvbG9yX2dldF9nYW1tYV9iaXRfcHJlY2lzaW9uKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiAr
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBp
LmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+PiAgCj4+ICAJaWYgKCFjcnRjX3N0YXRlLT5nYW1tYV9lbmFibGUp
Cj4+IEBAIC0xNTMyLDcgKzE1MzIsNyBAQCBzdGF0aWMgdTMyIGludGVsX2NvbG9yX2x1dF9wYWNr
KHUzMiB2YWwsIHUzMiBiaXRfcHJlY2lzaW9uKQo+PiAgc3RhdGljIHN0cnVjdCBkcm1fcHJvcGVy
dHlfYmxvYiAqCj4+ICBpOXh4X3JlYWRfbHV0XzgoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+
ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+PiAgCXN0cnVjdCBkcm1fcHJvcGVydHlf
YmxvYiAqYmxvYjsKPj4gQEAgLTE1NjYsMTMgKzE1NjYsMTMgQEAgaTl4eF9yZWFkX2x1dF84KGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgCj4+ICBzdGF0aWMg
dm9pZCBpOXh4X3JlYWRfbHV0cyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
Pj4gIHsKPj4gLQljcnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1dCA9IGk5eHhfcmVhZF9sdXRfOChj
cnRjX3N0YXRlKTsKPj4gKwljcnRjX3N0YXRlLT51YXBpLmdhbW1hX2x1dCA9IGk5eHhfcmVhZF9s
dXRfOChjcnRjX3N0YXRlKTsKPj4gIH0KPj4gIAo+PiAgc3RhdGljIHN0cnVjdCBkcm1fcHJvcGVy
dHlfYmxvYiAqCj4+ICBpOTY1X3JlYWRfbHV0XzEwcDYoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4+ICAJdTMyIGx1dF9zaXplID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPmNvbG9yLmdhbW1hX2x1
dF9zaXplOwo+PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gQEAgLTE2MTMsMTUg
KzE2MTMsMTUgQEAgaTk2NV9yZWFkX2x1dF8xMHA2KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+PiAgc3RhdGljIHZvaWQgaTk2NV9yZWFkX2x1dHMoc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+ICAJaWYgKGNydGNfc3RhdGUtPmdh
bW1hX21vZGUgPT0gR0FNTUFfTU9ERV9NT0RFXzhCSVQpCj4+IC0JCWNydGNfc3RhdGUtPmJhc2Uu
Z2FtbWFfbHV0ID0gaTl4eF9yZWFkX2x1dF84KGNydGNfc3RhdGUpOwo+PiArCQljcnRjX3N0YXRl
LT51YXBpLmdhbW1hX2x1dCA9IGk5eHhfcmVhZF9sdXRfOChjcnRjX3N0YXRlKTsKPj4gIAllbHNl
Cj4+IC0JCWNydGNfc3RhdGUtPmJhc2UuZ2FtbWFfbHV0ID0gaTk2NV9yZWFkX2x1dF8xMHA2KGNy
dGNfc3RhdGUpOwo+PiArCQljcnRjX3N0YXRlLT51YXBpLmdhbW1hX2x1dCA9IGk5NjVfcmVhZF9s
dXRfMTBwNihjcnRjX3N0YXRlKTsKPj4gIH0KPj4gIAo+PiAgc3RhdGljIHN0cnVjdCBkcm1fcHJv
cGVydHlfYmxvYiAqCj4+ICBjaHZfcmVhZF9jZ21fbHV0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYp
Owo+PiAgCXUzMiBsdXRfc2l6ZSA9IElOVEVMX0lORk8oZGV2X3ByaXYpLT5jb2xvci5nYW1tYV9s
dXRfc2l6ZTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+IEBAIC0xNjU1LDE1
ICsxNjU1LDE1IEBAIGNodl9yZWFkX2NnbV9sdXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4+ICBzdGF0aWMgdm9pZCBjaHZfcmVhZF9sdXRzKHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAgCWlmIChjcnRjX3N0YXRlLT5nYW1t
YV9tb2RlID09IEdBTU1BX01PREVfTU9ERV84QklUKQo+PiAtCQljcnRjX3N0YXRlLT5iYXNlLmdh
bW1hX2x1dCA9IGk5eHhfcmVhZF9sdXRfOChjcnRjX3N0YXRlKTsKPj4gKwkJY3J0Y19zdGF0ZS0+
dWFwaS5nYW1tYV9sdXQgPSBpOXh4X3JlYWRfbHV0XzgoY3J0Y19zdGF0ZSk7Cj4+ICAJZWxzZQo+
PiAtCQljcnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1dCA9IGNodl9yZWFkX2NnbV9sdXQoY3J0Y19z
dGF0ZSk7Cj4+ICsJCWNydGNfc3RhdGUtPnVhcGkuZ2FtbWFfbHV0ID0gY2h2X3JlYWRfY2dtX2x1
dChjcnRjX3N0YXRlKTsKPj4gIH0KPj4gIAo+PiAgc3RhdGljIHN0cnVjdCBkcm1fcHJvcGVydHlf
YmxvYiAqCj4+ICBpbGtfcmVhZF9sdXRfMTAoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJ
dTMyIGx1dF9zaXplID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPmNvbG9yLmdhbW1hX2x1dF9zaXpl
Owo+PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gQEAgLTE2OTYsMTUgKzE2OTYs
MTUgQEAgaWxrX3JlYWRfbHV0XzEwKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+PiAgc3RhdGljIHZvaWQgaWxrX3JlYWRfbHV0cyhzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gIAlpZiAoY3J0Y19zdGF0ZS0+Z2FtbWFfbW9kZSA9
PSBHQU1NQV9NT0RFX01PREVfOEJJVCkKPj4gLQkJY3J0Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQg
PSBpOXh4X3JlYWRfbHV0XzgoY3J0Y19zdGF0ZSk7Cj4+ICsJCWNydGNfc3RhdGUtPnVhcGkuZ2Ft
bWFfbHV0ID0gaTl4eF9yZWFkX2x1dF84KGNydGNfc3RhdGUpOwo+PiAgCWVsc2UKPj4gLQkJY3J0
Y19zdGF0ZS0+YmFzZS5nYW1tYV9sdXQgPSBpbGtfcmVhZF9sdXRfMTAoY3J0Y19zdGF0ZSk7Cj4+
ICsJCWNydGNfc3RhdGUtPnVhcGkuZ2FtbWFfbHV0ID0gaWxrX3JlYWRfbHV0XzEwKGNydGNfc3Rh
dGUpOwo+PiAgfQo+PiAgCj4+ICBzdGF0aWMgc3RydWN0IGRybV9wcm9wZXJ0eV9ibG9iICoKPj4g
IGdsa19yZWFkX2x1dF8xMChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwgdTMyIHByZWNfaW5kZXgpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4+ICAJaW50IGh3X2x1dF9zaXplID0gaXZiX2x1dF8xMF9zaXplKHByZWNfaW5kZXgpOwo+PiAg
CWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gQEAgLTE3NDIsOSArMTc0Miw5IEBAIGds
a19yZWFkX2x1dF8xMChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwg
dTMyIHByZWNfaW5kZXgpCj4+ICBzdGF0aWMgdm9pZCBnbGtfcmVhZF9sdXRzKHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAgCWlmIChjcnRjX3N0YXRlLT5nYW1t
YV9tb2RlID09IEdBTU1BX01PREVfTU9ERV84QklUKQo+PiAtCQljcnRjX3N0YXRlLT5iYXNlLmdh
bW1hX2x1dCA9IGk5eHhfcmVhZF9sdXRfOChjcnRjX3N0YXRlKTsKPj4gKwkJY3J0Y19zdGF0ZS0+
dWFwaS5nYW1tYV9sdXQgPSBpOXh4X3JlYWRfbHV0XzgoY3J0Y19zdGF0ZSk7Cj4+ICAJZWxzZQo+
PiAtCQljcnRjX3N0YXRlLT5iYXNlLmdhbW1hX2x1dCA9IGdsa19yZWFkX2x1dF8xMChjcnRjX3N0
YXRlLCBQQUxfUFJFQ19JTkRFWF9WQUxVRSgwKSk7Cj4+ICsJCWNydGNfc3RhdGUtPnVhcGkuZ2Ft
bWFfbHV0ID0gZ2xrX3JlYWRfbHV0XzEwKGNydGNfc3RhdGUsIFBBTF9QUkVDX0lOREVYX1ZBTFVF
KDApKTsKPj4gIH0KPj4gIAo+PiAgdm9pZCBpbnRlbF9jb2xvcl9pbml0KHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjKQo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9jcnQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY3J0LmMKPj4g
aW5kZXggZTZlOGQ0YTgyMDQ0Li4zNWEyNTE3MmIyNjkgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY3J0LmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9jcnQuYwo+PiBAQCAtMTMyLDkgKzEzMiw5IEBAIHN0YXRpYyB2
b2lkIGludGVsX2NydF9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+
PiAgewo+PiAgCXBpcGVfY29uZmlnLT5vdXRwdXRfdHlwZXMgfD0gQklUKElOVEVMX09VVFBVVF9B
TkFMT0cpOwo+PiAgCj4+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncyB8
PSBpbnRlbF9jcnRfZ2V0X2ZsYWdzKGVuY29kZXIpOwo+PiArCXBpcGVfY29uZmlnLT5ody5hZGp1
c3RlZF9tb2RlLmZsYWdzIHw9IGludGVsX2NydF9nZXRfZmxhZ3MoZW5jb2Rlcik7Cj4+ICAKPj4g
LQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPSBwaXBlX2NvbmZp
Zy0+cG9ydF9jbG9jazsKPj4gKwlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2Ns
b2NrID0gcGlwZV9jb25maWctPnBvcnRfY2xvY2s7Cj4+ICB9Cj4+ICAKPj4gIHN0YXRpYyB2b2lk
IGhzd19jcnRfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gQEAg
LTE0NCwxMyArMTQ0LDEzIEBAIHN0YXRpYyB2b2lkIGhzd19jcnRfZ2V0X2NvbmZpZyhzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAo+PiAgCWludGVsX2RkaV9nZXRfY29uZmlnKGVu
Y29kZXIsIHBpcGVfY29uZmlnKTsKPj4gIAo+PiAtCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVk
X21vZGUuZmxhZ3MgJj0gfihEUk1fTU9ERV9GTEFHX1BIU1lOQyB8Cj4+ICsJcGlwZV9jb25maWct
Pmh3LmFkanVzdGVkX21vZGUuZmxhZ3MgJj0gfihEUk1fTU9ERV9GTEFHX1BIU1lOQyB8Cj4+ICAJ
CQkJCSAgICAgIERSTV9NT0RFX0ZMQUdfTkhTWU5DIHwKPj4gIAkJCQkJICAgICAgRFJNX01PREVf
RkxBR19QVlNZTkMgfAo+PiAgCQkJCQkgICAgICBEUk1fTU9ERV9GTEFHX05WU1lOQyk7Cj4+IC0J
cGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBpbnRlbF9jcnRfZ2V0X2Zs
YWdzKGVuY29kZXIpOwo+PiArCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9
IGludGVsX2NydF9nZXRfZmxhZ3MoZW5jb2Rlcik7Cj4+ICAKPj4gLQlwaXBlX2NvbmZpZy0+YmFz
ZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPSBscHRfZ2V0X2ljbGtpcChkZXZfcHJpdik7Cj4+
ICsJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9IGxwdF9nZXRfaWNs
a2lwKGRldl9wcml2KTsKPj4gIH0KPj4gIAo+PiAgLyogTm90ZTogVGhlIGNhbGxlciBpcyByZXF1
aXJlZCB0byBmaWx0ZXIgb3V0IGRwbXMgbW9kZXMgbm90IHN1cHBvcnRlZCBieSB0aGUKPj4gQEAg
LTE2MSw4ICsxNjEsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jcnRfc2V0X2RwbXMoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+ICAJc3RydWN0IGludGVs
X2NydCAqY3J0ID0gaW50ZWxfZW5jb2Rlcl90b19jcnQoZW5jb2Rlcik7Cj4+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+
IC0JY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmY3J0Y19z
dGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiArCWNvbnN0IHN0cnVjdCBk
cm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJmNydGNfc3RhdGUtPmh3LmFkanVzdGVk
X21vZGU7Cj4+ICAJdTMyIGFkcGE7Cj4+ICAKPj4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA1KQo+PiBAQCAtMjcxLDcgKzI3MSw3IEBAIHN0YXRpYyB2b2lkIGhzd19wcmVfZW5hYmxlX2Ny
dChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAkJCSAgICAgICBjb25zdCBzdHJ1
Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4g
LQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+
ICAKPj4gIAlXQVJOX09OKCFjcnRjX3N0YXRlLT5oYXNfcGNoX2VuY29kZXIpOwo+PiBAQCAtMjg4
LDcgKzI4OCw3IEBAIHN0YXRpYyB2b2lkIGhzd19lbmFibGVfY3J0KHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+PiAgCQkJICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUg
KmNvbm5fc3RhdGUpCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+
ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+PiAgCj4+ICAJV0FSTl9PTighY3J0Y19z
dGF0ZS0+aGFzX3BjaF9lbmNvZGVyKTsKPj4gQEAgLTM1OCw3ICszNTgsNyBAQCBzdGF0aWMgaW50
IGludGVsX2NydF9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
Pj4gIAkJCQkgICAgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4+ICB7
Cj4+ICAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkmcGlw
ZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwkJJnBpcGVfY29uZmlnLT5ody5hZGp1
c3RlZF9tb2RlOwo+PiAgCj4+ICAJaWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVf
RkxBR19EQkxTQ0FOKQo+PiAgCQlyZXR1cm4gLUVJTlZBTDsKPj4gQEAgLTM3Myw3ICszNzMsNyBA
QCBzdGF0aWMgaW50IHBjaF9jcnRfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4+ICAJCQkJICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0
ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4+
IC0JCSZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCQkmcGlwZV9jb25maWct
Pmh3LmFkanVzdGVkX21vZGU7Cj4+ICAKPj4gIAlpZiAoYWRqdXN0ZWRfbW9kZS0+ZmxhZ3MgJiBE
Uk1fTU9ERV9GTEFHX0RCTFNDQU4pCj4+ICAJCXJldHVybiAtRUlOVkFMOwo+PiBAQCAtMzkwLDcg
KzM5MCw3IEBAIHN0YXRpYyBpbnQgaHN3X2NydF9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gIAlzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4+IC0JCSZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3Rl
ZF9tb2RlOwo+PiArCQkmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAKPj4gIAlp
ZiAoYWRqdXN0ZWRfbW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0RCTFNDQU4pCj4+ICAJCXJl
dHVybiAtRUlOVkFMOwo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kZGkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMK
Pj4gaW5kZXggMWI1OWI4NTI4NzRiLi5jNzc1ZmQyMDU5MTUgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMKPj4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYwo+PiBAQCAtMTQ4Myw3ICsxNDgzLDcgQEAgc3Rh
dGljIHZvaWQgZGRpX2RvdGNsb2NrX2dldChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9j
b25maWcpCj4+ICAJaWYgKHBpcGVfY29uZmlnLT5mZWNfZW5hYmxlKQo+PiAgCQlkb3RjbG9jayA9
IGludGVsX2RwX2ZlY190b19tb2RlX2Nsb2NrKGRvdGNsb2NrKTsKPj4gIAo+PiAtCXBpcGVfY29u
ZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9IGRvdGNsb2NrOwo+PiArCXBpcGVf
Y29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPSBkb3RjbG9jazsKPj4gIH0KPj4g
IAo+PiAgc3RhdGljIHZvaWQgaWNsX2RkaV9jbG9ja19nZXQoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4+IEBAIC0xNjk4LDcgKzE2OTgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlf
Y2xvY2tfZ2V0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCj4+ICB2b2lkIGlu
dGVsX2RkaV9zZXRfcGlwZV9zZXR0aW5ncyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gIAll
bnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2Rl
cjsKPj4gIAl1MzIgdGVtcDsKPj4gQEAgLTE3NTIsNyArMTc1Miw3IEBAIHZvaWQgaW50ZWxfZGRp
X3NldF9waXBlX3NldHRpbmdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+PiAgdm9pZCBpbnRlbF9kZGlfc2V0X3ZjX3BheWxvYWRfYWxsb2MoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCQkJICAgIGJvb2wgc3RhdGUpCj4+
ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJZW51bSB0cmFuc2NvZGVy
IGNwdV90cmFuc2NvZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4+ICAJdTMyIHRl
bXA7Cj4+IEBAIC0xNzc0LDcgKzE3NzQsNyBAQCB2b2lkIGludGVsX2RkaV9zZXRfdmNfcGF5bG9h
ZF9hbGxvYyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIHN0
YXRpYyB1MzIKPj4gIGludGVsX2RkaV90cmFuc2NvZGVyX2Z1bmNfcmVnX3ZhbF9nZXQoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+
ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVh
cGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIgPSBpbnRlbF9kZGlf
Z2V0X2NydGNfZW5jb2RlcihjcnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNy
dGMtPnBpcGU7Cj4+IEBAIC0xODA2LDkgKzE4MDYsOSBAQCBpbnRlbF9kZGlfdHJhbnNjb2Rlcl9m
dW5jX3JlZ192YWxfZ2V0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+PiAgCQlCVUcoKTsKPj4gIAl9Cj4+ICAKPj4gLQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5hZGp1
c3RlZF9tb2RlLmZsYWdzICYgRFJNX01PREVfRkxBR19QVlNZTkMpCj4+ICsJaWYgKGNydGNfc3Rh
dGUtPmh3LmFkanVzdGVkX21vZGUuZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX1BWU1lOQykKPj4gIAkJ
dGVtcCB8PSBUUkFOU19ERElfUFZTWU5DOwo+PiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmFkanVz
dGVkX21vZGUuZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX1BIU1lOQykKPj4gKwlpZiAoY3J0Y19zdGF0
ZS0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFncyAmIERSTV9NT0RFX0ZMQUdfUEhTWU5DKQo+PiAgCQl0
ZW1wIHw9IFRSQU5TX0RESV9QSFNZTkM7Cj4+ICAKPj4gIAlpZiAoY3B1X3RyYW5zY29kZXIgPT0g
VFJBTlNDT0RFUl9FRFApIHsKPj4gQEAgLTE4NjEsNyArMTg2MSw3IEBAIGludGVsX2RkaV90cmFu
c2NvZGVyX2Z1bmNfcmVnX3ZhbF9nZXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4+ICAKPj4gIHZvaWQgaW50ZWxfZGRpX2VuYWJsZV90cmFuc2NvZGVyX2Z1bmMo
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3Rh
dGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2Nv
ZGVyID0gY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4+ICAJdTMyIHRlbXA7Cj4+IEBAIC0x
ODc3LDcgKzE4NzcsNyBAQCB2b2lkIGludGVsX2RkaV9lbmFibGVfdHJhbnNjb2Rlcl9mdW5jKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgc3RhdGljIHZvaWQK
Pj4gIGludGVsX2RkaV9jb25maWdfdHJhbnNjb2Rlcl9mdW5jKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAg
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwo+PiAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNw
dV90cmFuc2NvZGVyOwo+PiAgCXUzMiB0ZW1wOwo+PiBAQCAtMTg4OSw3ICsxODg5LDcgQEAgaW50
ZWxfZGRpX2NvbmZpZ190cmFuc2NvZGVyX2Z1bmMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4+ICAKPj4gIHZvaWQgaW50ZWxfZGRpX2Rpc2FibGVfdHJhbnNjb2Rl
cl9mdW5jKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCWVudW0gdHJhbnNjb2RlciBjcHVf
dHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+PiAgCWk5MTVfcmVnX3Qg
cmVnID0gVFJBTlNfRERJX0ZVTkNfQ1RMKGNwdV90cmFuc2NvZGVyKTsKPj4gQEAgLTIxODcsNyAr
MjE4Nyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9nZXRfcG93ZXJfZG9tYWlucyhzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAo+PiAgdm9pZCBpbnRlbF9kZGlfZW5hYmxlX3Bp
cGVfY2xvY2soY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7
Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIgPSBpbnRlbF9kZGlfZ2V0X2NydGNfZW5jb2RlcihjcnRjKTsKPj4gIAllbnVt
IHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4+IEBAIC0yMjA1LDcgKzIyMDUsNyBAQCB2b2lk
IGludGVsX2RkaV9lbmFibGVfcGlwZV9jbG9jayhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPj4gIAo+PiAgdm9pZCBpbnRlbF9kZGlfZGlzYWJsZV9waXBlX2Nsb2Nr
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjLT5kZXYpOwo+PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+PiAgCWVudW0gdHJhbnNjb2RlciBj
cHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+PiAgCj4+ICAJaWYg
KGNwdV90cmFuc2NvZGVyICE9IFRSQU5TQ09ERVJfRURQKSB7Cj4+IEBAIC0zNDIxLDcgKzM0MjEs
NyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPj4gIAkJCQkgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCj4+ICAJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0
YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9f
aW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCWVudW0gcGlw
ZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gIAo+PiBAQCAtMzg0Niw3ICszODQ2LDcgQEAgaW50ZWxf
ZGRpX3VwZGF0ZV9wcmVwYXJlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+PiAg
CVdBUk5fT04oY3J0YyAmJiBjcnRjLT5hY3RpdmUpOwo+PiAgCj4+ICAJaW50ZWxfdGNfcG9ydF9n
ZXRfbGluayhlbmNfdG9fZGlnX3BvcnQoJmVuY29kZXItPmJhc2UpLCByZXF1aXJlZF9sYW5lcyk7
Cj4+IC0JaWYgKGNydGNfc3RhdGUgJiYgY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpCj4+ICsJaWYg
KGNydGNfc3RhdGUgJiYgY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+PiAgCQlpbnRlbF91cGRhdGVf
YWN0aXZlX2RwbGwoc3RhdGUsIGNydGMsIGVuY29kZXIpOwo+PiAgfQo+PiAgCj4+IEBAIC0zOTc2
LDcgKzM5NzYsNyBAQCB2b2lkIGludGVsX2RkaV9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAo+PiAgCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25m
aWcpCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMg
PSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRl
bF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+dWFwaS5jcnRj
KTsKPj4gIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBwaXBlX2NvbmZpZy0+Y3B1
X3RyYW5zY29kZXI7Cj4+ICAJdTMyIHRlbXAsIGZsYWdzID0gMDsKPj4gIAo+PiBAQCAtMzk5NCw3
ICszOTk0LDcgQEAgdm9pZCBpbnRlbF9kZGlfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPj4gIAllbHNlCj4+ICAJCWZsYWdzIHw9IERSTV9NT0RFX0ZMQUdfTlZTWU5D
Owo+PiAgCj4+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBmbGFn
czsKPj4gKwlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBmbGFnczsKPj4g
IAo+PiAgCXN3aXRjaCAodGVtcCAmIFRSQU5TX0RESV9CUENfTUFTSykgewo+PiAgCWNhc2UgVFJB
TlNfRERJX0JQQ182Ogo+PiBAQCAtNDEzNiw3ICs0MTM2LDcgQEAgc3RhdGljIGludCBpbnRlbF9k
ZGlfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICAJCQkJ
ICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPj4gIAkJCQkgICAgc3Ry
dWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+
PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+
dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBv
cnQ7Cj4+ICAJaW50IHJldDsKPj4gQEAgLTQyNjcsNyArNDI2Nyw3IEBAIHN0YXRpYyBpbnQgaW50
ZWxfaGRtaV9yZXNldF9saW5rKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCj4+
ICAJV0FSTl9PTighaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRf
SERNSSkpOwo+PiAgCj4+IC0JaWYgKCFjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPj4gKwlpZiAo
IWNydGNfc3RhdGUtPmh3LmFjdGl2ZSkKPj4gIAkJcmV0dXJuIDA7Cj4+ICAKPj4gIAlpZiAoIWNy
dGNfc3RhdGUtPmhkbWlfaGlnaF90bWRzX2Nsb2NrX3JhdGlvICYmCj4+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCj4+IGluZGV4IDc5OTY4NjRlNmY3Yy4u
NjgxOGNiZDAwYWMyIDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2Rpc3BsYXkuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2Rpc3BsYXkuYwo+PiBAQCAtNTE4LDcgKzUxOCw3IEBAIGljbF93YV9zY2FsZXJjbGtnYXRp
bmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSwKPj4g
IHN0YXRpYyBib29sCj4+ICBuZWVkc19tb2Rlc2V0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpzdGF0ZSkKPj4gIHsKPj4gLQlyZXR1cm4gZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVz
ZXQoJnN0YXRlLT5iYXNlKTsKPj4gKwlyZXR1cm4gZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVz
ZXQoJnN0YXRlLT51YXBpKTsKPj4gIH0KPj4gIAo+PiAgLyoKPj4gQEAgLTYzMiw3ICs2MzIsNyBA
QCBpOXh4X3NlbGVjdF9wMl9kaXYoY29uc3Qgc3RydWN0IGludGVsX2xpbWl0ICpsaW1pdCwKPj4g
IAkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCSAg
IGludCB0YXJnZXQpCj4+ICB7Cj4+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRl
dik7Cj4+ICAKPj4gIAlpZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9P
VVRQVVRfTFZEUykpIHsKPj4gIAkJLyoKPj4gQEAgLTY2OCw3ICs2NjgsNyBAQCBpOXh4X2ZpbmRf
YmVzdF9kcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9saW1pdCAqbGltaXQsCj4+ICAJCSAgICBpbnQg
dGFyZ2V0LCBpbnQgcmVmY2xrLCBzdHJ1Y3QgZHBsbCAqbWF0Y2hfY2xvY2ssCj4+ICAJCSAgICBz
dHJ1Y3QgZHBsbCAqYmVzdF9jbG9jaykKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXY7Cj4+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9IGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2Owo+PiAgCXN0cnVjdCBkcGxsIGNsb2NrOwo+
PiAgCWludCBlcnIgPSB0YXJnZXQ7Cj4+ICAKPj4gQEAgLTcyNiw3ICs3MjYsNyBAQCBwbnZfZmlu
ZF9iZXN0X2RwbGwoY29uc3Qgc3RydWN0IGludGVsX2xpbWl0ICpsaW1pdCwKPj4gIAkJICAgaW50
IHRhcmdldCwgaW50IHJlZmNsaywgc3RydWN0IGRwbGwgKm1hdGNoX2Nsb2NrLAo+PiAgCQkgICBz
dHJ1Y3QgZHBsbCAqYmVzdF9jbG9jaykKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXY7Cj4+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9IGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2Owo+PiAgCXN0cnVjdCBkcGxsIGNsb2NrOwo+
PiAgCWludCBlcnIgPSB0YXJnZXQ7Cj4+ICAKPj4gQEAgLTc4Miw3ICs3ODIsNyBAQCBnNHhfZmlu
ZF9iZXN0X2RwbGwoY29uc3Qgc3RydWN0IGludGVsX2xpbWl0ICpsaW1pdCwKPj4gIAkJICAgaW50
IHRhcmdldCwgaW50IHJlZmNsaywgc3RydWN0IGRwbGwgKm1hdGNoX2Nsb2NrLAo+PiAgCQkgICBz
dHJ1Y3QgZHBsbCAqYmVzdF9jbG9jaykKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXY7Cj4+ICsJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9IGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2Owo+PiAgCXN0cnVjdCBkcGxsIGNsb2NrOwo+
PiAgCWludCBtYXhfbjsKPj4gIAlib29sIGZvdW5kID0gZmFsc2U7Cj4+IEBAIC04NzYsNyArODc2
LDcgQEAgdmx2X2ZpbmRfYmVzdF9kcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9saW1pdCAqbGltaXQs
Cj4+ICAJCSAgIGludCB0YXJnZXQsIGludCByZWZjbGssIHN0cnVjdCBkcGxsICptYXRjaF9jbG9j
aywKPj4gIAkJICAgc3RydWN0IGRwbGwgKmJlc3RfY2xvY2spCj4+ICB7Cj4+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+
ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVh
cGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2Owo+
PiAgCXN0cnVjdCBkcGxsIGNsb2NrOwo+PiAgCXVuc2lnbmVkIGludCBiZXN0cHBtID0gMTAwMDAw
MDsKPj4gQEAgLTkzNiw3ICs5MzYsNyBAQCBjaHZfZmluZF9iZXN0X2RwbGwoY29uc3Qgc3RydWN0
IGludGVsX2xpbWl0ICpsaW1pdCwKPj4gIAkJICAgaW50IHRhcmdldCwgaW50IHJlZmNsaywgc3Ry
dWN0IGRwbGwgKm1hdGNoX2Nsb2NrLAo+PiAgCQkgICBzdHJ1Y3QgZHBsbCAqYmVzdF9jbG9jaykK
Pj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19z
dGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gY3J0Yy0+YmFzZS5kZXY7Cj4+ICAJdW5zaWduZWQgaW50IGJlc3RfZXJyb3JfcHBtOwo+PiAg
CXN0cnVjdCBkcGxsIGNsb2NrOwo+PiBAQCAtMTAxNSw3ICsxMDE1LDcgQEAgYm9vbCBpbnRlbF9j
cnRjX2FjdGl2ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPj4gIAkgKiBmb3IgYXRvbWljLgo+
PiAgCSAqLwo+PiAgCXJldHVybiBjcnRjLT5hY3RpdmUgJiYgY3J0Yy0+YmFzZS5wcmltYXJ5LT5z
dGF0ZS0+ZmIgJiYKPj4gLQkJY3J0Yy0+Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19j
bG9jazsKPj4gKwkJY3J0Yy0+Y29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7Cj4+
ICB9Cj4+ICAKPj4gIGVudW0gdHJhbnNjb2RlciBpbnRlbF9waXBlX3RvX2NwdV90cmFuc2NvZGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPj4gQEAgLTEwNjksNyArMTA2OSw3
IEBAIHN0YXRpYyB2b2lkIGludGVsX3dhaXRfZm9yX3BpcGVfc2NhbmxpbmVfbW92aW5nKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjKQo+PiAgc3RhdGljIHZvaWQKPj4gIGludGVsX3dhaXRfZm9yX3Bp
cGVfb2ZmKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPj4g
IHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKG9sZF9jcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCj4+ICAJaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gNCkgewo+PiBAQCAtMTUyOCw3ICsxNTI4LDcgQEAgc3Rh
dGljIHZvaWQgaTl4eF9lbmFibGVfcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+PiAgCj4+
ICBzdGF0aWMgdm9pZCBpOXh4X2Rpc2FibGVfcGxsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9f
aW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gIAo+PiBAQCAtMTYxOSw3ICsxNjE5
LDcgQEAgdm9pZCB2bHZfd2FpdF9wb3J0X3JlYWR5KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKPj4gIAo+PiAgc3RhdGljIHZvaWQgaXJvbmxha2VfZW5hYmxlX3BjaF90cmFuc2Nv
ZGVyKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAt
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNl
LmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRj
X3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+
cGlwZTsKPj4gIAlpOTE1X3JlZ190IHJlZzsKPj4gQEAgLTE3NjMsNyArMTc2Myw3IEBAIGVudW0g
cGlwZSBpbnRlbF9jcnRjX3BjaF90cmFuc2NvZGVyKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKQo+
PiAgCj4+ICBzdGF0aWMgdTMyIGludGVsX2NydGNfbWF4X3ZibGFua19jb3VudChjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2
KTsKPj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNf
c3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPj4gIAo+PiAgCS8qCj4+ICAJICogT24gaTk2NWdtIHRo
ZSBoYXJkd2FyZSBmcmFtZSBjb3VudGVyIHJlYWRzCj4+IEBAIC0xNzgzLDcgKzE3ODMsNyBAQCBz
dGF0aWMgdTMyIGludGVsX2NydGNfbWF4X3ZibGFua19jb3VudChjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZQo+PiAgCj4+ICBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX3Zi
bGFua19vbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsK
Pj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAo+PiAgCWRybV9jcnRjX3NldF9tYXhfdmJsYW5r
X2NvdW50KCZjcnRjLT5iYXNlLAo+PiAgCQkJCSAgICAgIGludGVsX2NydGNfbWF4X3ZibGFua19j
b3VudChjcnRjX3N0YXRlKSk7Cj4+IEBAIC0xNzkyLDcgKzE3OTIsNyBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9jcnRjX3ZibGFua19vbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPj4gIAo+PiAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX3BpcGUoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsK
Pj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3Rh
dGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2Nv
ZGVyID0gbmV3X2NydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+PiAgCWVudW0gcGlwZSBwaXBl
ID0gY3J0Yy0+cGlwZTsKPj4gQEAgLTE4NTAsNyArMTg1MCw3IEBAIHN0YXRpYyB2b2lkIGludGVs
X2VuYWJsZV9waXBlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0
ZSkKPj4gIAo+PiAgc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJsZV9waXBlKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+
ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRl
LT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2Rl
ciA9IG9sZF9jcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPj4gIAllbnVtIHBpcGUgcGlwZSA9
IGNydGMtPnBpcGU7Cj4+IEBAIC0zMTE2LDE0ICszMTE2LDE0IEBAIGludGVsX3NldF9wbGFuZV92
aXNpYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCXBsYW5lX3N0
YXRlLT5iYXNlLnZpc2libGUgPSB2aXNpYmxlOwo+PiAgCj4+ICAJaWYgKHZpc2libGUpCj4+IC0J
CWNydGNfc3RhdGUtPmJhc2UucGxhbmVfbWFzayB8PSBkcm1fcGxhbmVfbWFzaygmcGxhbmUtPmJh
c2UpOwo+PiArCQljcnRjX3N0YXRlLT51YXBpLnBsYW5lX21hc2sgfD0gZHJtX3BsYW5lX21hc2so
JnBsYW5lLT5iYXNlKTsKPj4gIAllbHNlCj4+IC0JCWNydGNfc3RhdGUtPmJhc2UucGxhbmVfbWFz
ayAmPSB+ZHJtX3BsYW5lX21hc2soJnBsYW5lLT5iYXNlKTsKPj4gKwkJY3J0Y19zdGF0ZS0+dWFw
aS5wbGFuZV9tYXNrICY9IH5kcm1fcGxhbmVfbWFzaygmcGxhbmUtPmJhc2UpOwo+PiAgfQo+PiAg
Cj4+ICBzdGF0aWMgdm9pZCBmaXh1cF9hY3RpdmVfcGxhbmVzKHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+PiArCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRj
LT5kZXYpOwo+PiAgCXN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lOwo+PiAgCj4+ICAJLyoKPj4gQEAg
LTMxMzQsNyArMzEzNCw3IEBAIHN0YXRpYyB2b2lkIGZpeHVwX2FjdGl2ZV9wbGFuZXMoc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICAJY3J0Y19zdGF0ZS0+YWN0aXZlX3Bs
YW5lcyA9IDA7Cj4+ICAKPj4gIAlkcm1fZm9yX2VhY2hfcGxhbmVfbWFzayhwbGFuZSwgJmRldl9w
cml2LT5kcm0sCj4+IC0JCQkJY3J0Y19zdGF0ZS0+YmFzZS5wbGFuZV9tYXNrKQo+PiArCQkJCWNy
dGNfc3RhdGUtPnVhcGkucGxhbmVfbWFzaykKPj4gIAkJY3J0Y19zdGF0ZS0+YWN0aXZlX3BsYW5l
cyB8PSBCSVQodG9faW50ZWxfcGxhbmUocGxhbmUpLT5pZCk7Cj4+ICB9Cj4+ICAKPj4gQEAgLTM2
MDgsNyArMzYwOCw3IEBAIGk5eHhfcGxhbmVfbWF4X3N0cmlkZShzdHJ1Y3QgaW50ZWxfcGxhbmUg
KnBsYW5lLAo+PiAgCj4+ICBzdGF0aWMgdTMyIGk5eHhfcGxhbmVfY3RsX2NydGMoY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJ
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGku
Y3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4+ICAJdTMyIGRzcGNudHIgPSAwOwo+PiAgCj4+IEBAIC0zNzYyLDcg
KzM3NjIsNyBAQCBpOXh4X3BsYW5lX2NoZWNrKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAo+PiAgCQlyZXR1cm4gcmV0Owo+PiAgCj4+ICAJcmV0ID0gZHJtX2F0b21pY19oZWxw
ZXJfY2hlY2tfcGxhbmVfc3RhdGUoJnBsYW5lX3N0YXRlLT5iYXNlLAo+PiAtCQkJCQkJICAmY3J0
Y19zdGF0ZS0+YmFzZSwKPj4gKwkJCQkJCSAgJmNydGNfc3RhdGUtPnVhcGksCj4+ICAJCQkJCQkg
IERSTV9QTEFORV9IRUxQRVJfTk9fU0NBTElORywKPj4gIAkJCQkJCSAgRFJNX1BMQU5FX0hFTFBF
Ul9OT19TQ0FMSU5HLAo+PiAgCQkJCQkJICBpOXh4X3BsYW5lX2hhc193aW5kb3dpbmcocGxhbmUp
LAo+PiBAQCAtMzkzOCw3ICszOTM4LDcgQEAgc3RhdGljIHZvaWQgc2tsX2RldGFjaF9zY2FsZXIo
c3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsIGludCBpZCkKPj4gICAqLwo+PiAgc3RhdGlj
IHZvaWQgc2tsX2RldGFjaF9zY2FsZXJzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9f
aW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRj
ICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAg
CWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3NjYWxlcl9zdGF0ZSAqc2NhbGVyX3N0YXRlID0KPj4g
IAkJJmNydGNfc3RhdGUtPnNjYWxlcl9zdGF0ZTsKPj4gIAlpbnQgaTsKPj4gQEAgLTQxMzMsNyAr
NDEzMyw3IEBAIHN0YXRpYyB1MzIgY25sX3BsYW5lX2N0bF9mbGlwKHVuc2lnbmVkIGludCByZWZs
ZWN0KQo+PiAgCj4+ICB1MzIgc2tsX3BsYW5lX2N0bF9jcnRjKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+PiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFw
aS5jcnRjLT5kZXYpOwo+PiAgCXUzMiBwbGFuZV9jdGwgPSAwOwo+PiAgCj4+ICAJaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTAgfHwgSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpCj4+IEBAIC00
MTg5LDcgKzQxODksNyBAQCB1MzIgc2tsX3BsYW5lX2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIAo+PiAgdTMyIGdsa19wbGFuZV9jb2xvcl9jdGxfY3J0
Yyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJh
c2UuY3J0Yy0+ZGV2KTsKPj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPj4gIAl1MzIgcGxhbmVfY29sb3Jf
Y3RsID0gMDsKPj4gIAo+PiAgCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+PiBAQCAt
NDQxMSwxMSArNDQxMSwxMSBAQCBzdGF0aWMgdm9pZCBpY2xfc2V0X3BpcGVfY2hpY2tlbihzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YykKPj4gIHN0YXRpYyB2b2lkIGludGVsX3VwZGF0ZV9waXBlX2Nv
bmZpZyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4+ICAJ
CQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCj4+
ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRj
X3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhuZXdfY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gIAo+PiAgCS8q
IGRybV9hdG9taWNfaGVscGVyX3VwZGF0ZV9sZWdhY3lfbW9kZXNldF9zdGF0ZSBtaWdodCBub3Qg
YmUgY2FsbGVkLiAqLwo+PiAtCWNydGMtPmJhc2UubW9kZSA9IG5ld19jcnRjX3N0YXRlLT5iYXNl
Lm1vZGU7Cj4+ICsJY3J0Yy0+YmFzZS5tb2RlID0gbmV3X2NydGNfc3RhdGUtPnVhcGkubW9kZTsK
Pj4gIAo+PiAgCS8qCj4+ICAJICogVXBkYXRlIHBpcGUgc2l6ZSBhbmQgYWRqdXN0IGZpdHRlciBp
ZiBuZWVkZWQ6IHRoZSByZWFzb24gZm9yIHRoaXMgaXMKPj4gQEAgLTQ4NDQsNyArNDg0NCw3IEBA
IHN0YXRpYyB2b2lkIGl2Yl9tYW51YWxfZmRpX2xpbmtfdHJhaW4oc3RydWN0IGludGVsX2NydGMg
KmNydGMsCj4+ICAKPj4gIHN0YXRpYyB2b2lkIGlyb25sYWtlX2ZkaV9wbGxfZW5hYmxlKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBp
bnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNy
dGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoaW50ZWxfY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCWVudW0gcGlwZSBwaXBl
ID0gaW50ZWxfY3J0Yy0+cGlwZTsKPj4gIAlpOTE1X3JlZ190IHJlZzsKPj4gQEAgLTUwMDUsOSAr
NTAwNSw5IEBAIHZvaWQgbHB0X2Rpc2FibGVfaWNsa2lwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKPj4gIC8qIFByb2dyYW0gaUNMS0lQIGNsb2NrIHRvIHRoZSBkZXNpcmVkIGZy
ZXF1ZW5jeSAqLwo+PiAgc3RhdGljIHZvaWQgbHB0X3Byb2dyYW1faWNsa2lwKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNy
dGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+PiAtCWludCBjbG9jayA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRf
bW9kZS5jcnRjX2Nsb2NrOwo+PiArCWludCBjbG9jayA9IGNydGNfc3RhdGUtPmh3LmFkanVzdGVk
X21vZGUuY3J0Y19jbG9jazsKPj4gIAl1MzIgZGl2c2VsLCBwaGFzZWluYywgYXV4ZGl2LCBwaGFz
ZWRpciA9IDA7Cj4+ICAJdTMyIHRlbXA7Cj4+ICAKPj4gQEAgLTUxMjEsNyArNTEyMSw3IEBAIGlu
dCBscHRfZ2V0X2ljbGtpcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4+ICBz
dGF0aWMgdm9pZCBpcm9ubGFrZV9wY2hfdHJhbnNjb2Rlcl9zZXRfdGltaW5ncyhjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIAkJCQkJCWVudW0gcGlwZSBwY2hf
dHJhbnNjb2RlcikKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gIAll
bnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2Rl
cjsKPj4gIAo+PiBAQCAtNTE2NCw3ICs1MTY0LDcgQEAgc3RhdGljIHZvaWQgY3B0X3NldF9mZGlf
YmNfYmlmdXJjYXRpb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIGUK
Pj4gIAo+PiAgc3RhdGljIHZvaWQgaXZ5YnJpZGdlX3VwZGF0ZV9mZGlfYmNfYmlmdXJjYXRpb24o
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3Rh
dGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAKPj4gIAlzd2l0Y2ggKGNydGMtPnBpcGUpIHsK
Pj4gQEAgLTUxOTQsNyArNTE5NCw3IEBAIHN0YXRpYyBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqCj4+
ICBpbnRlbF9nZXRfY3J0Y19uZXdfZW5jb2Rlcihjb25zdCBzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSwKPj4gIAkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCWNvbnN0IHN0cnVjdCBk
cm1fY29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGU7Cj4+ICAJY29uc3Qgc3RydWN0IGRy
bV9jb25uZWN0b3IgKmNvbm5lY3RvcjsKPj4gIAlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciA9IE5VTEw7Cj4+IEBAIC01MjI2LDcgKzUyMjYsNyBAQCBpbnRlbF9nZXRfY3J0Y19uZXdfZW5j
b2Rlcihjb25zdCBzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPj4gIHN0YXRpYyB2
b2lkIGlyb25sYWtlX3BjaF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUsCj4+ICAJCQkJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9IGNydGMtPmJhc2UuZGV2Owo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+IEBA
IC01MjgwLDcgKzUyODAsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9wY2hfZW5hYmxlKGNvbnN0
IHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+PiAgCWlmIChIQVNfUENIX0NQVChk
ZXZfcHJpdikgJiYKPj4gIAkgICAgaW50ZWxfY3J0Y19oYXNfZHBfZW5jb2RlcihjcnRjX3N0YXRl
KSkgewo+PiAgCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9
Cj4+IC0JCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCQkJJmNydGNfc3Rh
dGUtPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJCXUzMiBicGMgPSAoSTkxNV9SRUFEKFBJUEVDT05G
KHBpcGUpKSAmIFBJUEVDT05GX0JQQ19NQVNLKSA+PiA1Owo+PiAgCQlpOTE1X3JlZ190IHJlZyA9
IFRSQU5TX0RQX0NUTChwaXBlKTsKPj4gIAkJZW51bSBwb3J0IHBvcnQ7Cj4+IEBAIC01MzEwLDcg
KzUzMTAsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9wY2hfZW5hYmxlKGNvbnN0IHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+PiAgc3RhdGljIHZvaWQgbHB0X3BjaF9lbmFibGUo
Y29uc3Qgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4+ICAJCQkgICBjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4g
KwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFw
aS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNydGMtPmJhc2UuZGV2KTsKPj4gIAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBj
cnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPj4gIAo+PiBAQCAtNTQyNywxMCArNTQyNywxMCBA
QCBza2xfdXBkYXRlX3NjYWxlcihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwg
Ym9vbCBmb3JjZV9kZXRhY2gsCj4+ICAJc3RydWN0IGludGVsX2NydGNfc2NhbGVyX3N0YXRlICpz
Y2FsZXJfc3RhdGUgPQo+PiAgCQkmY3J0Y19zdGF0ZS0+c2NhbGVyX3N0YXRlOwo+PiAgCXN0cnVj
dCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0KPj4gLQkJdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+PiArCQl0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7
Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShpbnRlbF9j
cnRjLT5iYXNlLmRldik7Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVz
dGVkX21vZGUgPQo+PiAtCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCQkm
Y3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAo+PiAgCS8qCj4+ICAJICogU3JjIGNv
b3JkaW5hdGVzIGFyZSBhbHJlYWR5IHJvdGF0ZWQgYnkgMjcwIGRlZ3JlZXMgZm9yCj4+IEBAIC01
NDQ2LDcgKzU0NDYsNyBAQCBza2xfdXBkYXRlX3NjYWxlcihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwgYm9vbCBmb3JjZV9kZXRhY2gsCj4+ICAJICogT25jZSBOVjEyIGlzIGVu
YWJsZWQsIGhhbmRsZSBpdCBoZXJlIHdoaWxlIGFsbG9jYXRpbmcgc2NhbGVyCj4+ICAJICogZm9y
IE5WMTIuCj4+ICAJICovCj4+IC0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSAmJiBjcnRj
X3N0YXRlLT5iYXNlLmVuYWJsZSAmJgo+PiArCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkg
JiYgY3J0Y19zdGF0ZS0+aHcuZW5hYmxlICYmCj4+ICAJICAgIG5lZWRfc2NhbGVyICYmIGFkanVz
dGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19JTlRFUkxBQ0UpIHsKPj4gIAkJRFJNX0RF
QlVHX0tNUygiUGlwZS9QbGFuZSBzY2FsaW5nIG5vdCBzdXBwb3J0ZWQgd2l0aCBJRi1JRCBtb2Rl
XG4iKTsKPj4gIAkJcmV0dXJuIC1FSU5WQUw7Cj4+IEBAIC01NTE4LDEzICs1NTE4LDEzIEBAIHNr
bF91cGRhdGVfc2NhbGVyKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLCBib29s
IGZvcmNlX2RldGFjaCwKPj4gICAqLwo+PiAgaW50IHNrbF91cGRhdGVfc2NhbGVyX2NydGMoc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKnN0YXRlKQo+PiAgewo+PiAtCWNvbnN0IHN0cnVjdCBkcm1f
ZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnN0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7
Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmc3Rh
dGUtPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJYm9vbCBuZWVkX3NjYWxlciA9IGZhbHNlOwo+PiAg
Cj4+ICAJaWYgKHN0YXRlLT5vdXRwdXRfZm9ybWF0ID09IElOVEVMX09VVFBVVF9GT1JNQVRfWUNC
Q1I0MjApCj4+ICAJCW5lZWRfc2NhbGVyID0gdHJ1ZTsKPj4gIAo+PiAtCXJldHVybiBza2xfdXBk
YXRlX3NjYWxlcihzdGF0ZSwgIXN0YXRlLT5iYXNlLmFjdGl2ZSwgU0tMX0NSVENfSU5ERVgsCj4+
ICsJcmV0dXJuIHNrbF91cGRhdGVfc2NhbGVyKHN0YXRlLCAhc3RhdGUtPmh3LmFjdGl2ZSwgU0tM
X0NSVENfSU5ERVgsCj4+ICAJCQkJICZzdGF0ZS0+c2NhbGVyX3N0YXRlLnNjYWxlcl9pZCwKPj4g
IAkJCQkgc3RhdGUtPnBpcGVfc3JjX3csIHN0YXRlLT5waXBlX3NyY19oLAo+PiAgCQkJCSBhZGp1
c3RlZF9tb2RlLT5jcnRjX2hkaXNwbGF5LAo+PiBAQCAtNTYyNCw3ICs1NjI0LDcgQEAgc3RhdGlj
IHZvaWQgc2t5bGFrZV9zY2FsZXJfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPj4g
IAo+PiAgc3RhdGljIHZvaWQgc2t5bGFrZV9wZml0X2VuYWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4g
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2Uu
ZGV2KTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+ICAJY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc2NhbGVyX3N0YXRlICpzY2FsZXJfc3RhdGUgPQo+PiBAQCAtNTY2MSw3ICs1
NjYxLDcgQEAgc3RhdGljIHZvaWQgc2t5bGFrZV9wZml0X2VuYWJsZShjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIAo+PiAgc3RhdGljIHZvaWQgaXJvbmxha2Vf
cGZpdF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+
ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJZW51bSBwaXBlIHBpcGUg
PSBjcnRjLT5waXBlOwo+PiAgCj4+IEBAIC01NjgyLDcgKzU2ODIsNyBAQCBzdGF0aWMgdm9pZCBp
cm9ubGFrZV9wZml0X2VuYWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPj4gIAo+PiAgdm9pZCBoc3dfZW5hYmxlX2lwcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4+ICAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+PiAgCj4+IEBAIC01NzE4LDcg
KzU3MTgsNyBAQCB2b2lkIGhzd19lbmFibGVfaXBzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+PiAgCj4+ICB2b2lkIGhzd19kaXNhYmxlX2lwcyhjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5j
cnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7Cj4+ICAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+PiAgCj4+
IEBAIC01ODI4LDcgKzU4MjgsNyBAQCBpbnRlbF9wcmVfZGlzYWJsZV9wcmltYXJ5X25vYXRvbWlj
KHN0cnVjdCBkcm1fY3J0YyAqY3J0YykKPj4gIHN0YXRpYyBib29sIGhzd19wcmVfdXBkYXRlX2Rp
c2FibGVfaXBzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwK
Pj4gIAkJCQkgICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0
YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhu
ZXdfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9
IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAK
Pj4gIAlpZiAoIW9sZF9jcnRjX3N0YXRlLT5pcHNfZW5hYmxlZCkKPj4gQEAgLTU4NDQsNyArNTg0
NCw3IEBAIHN0YXRpYyBib29sIGhzd19wcmVfdXBkYXRlX2Rpc2FibGVfaXBzKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zCj4+ICAJICogRGlzYWJsZSBJUFMgYmVmb3Jl
IHdlIHByb2dyYW0gdGhlIExVVC4KPj4gIAkgKi8KPj4gIAlpZiAoSVNfSEFTV0VMTChkZXZfcHJp
dikgJiYKPj4gLQkgICAgKG5ld19jcnRjX3N0YXRlLT5iYXNlLmNvbG9yX21nbXRfY2hhbmdlZCB8
fAo+PiArCSAgICAobmV3X2NydGNfc3RhdGUtPnVhcGkuY29sb3JfbWdtdF9jaGFuZ2VkIHx8Cj4+
ICAJICAgICBuZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3BpcGUpICYmCj4+ICAJICAgIG5ld19jcnRj
X3N0YXRlLT5nYW1tYV9tb2RlID09IEdBTU1BX01PREVfTU9ERV9TUExJVCkKPj4gIAkJcmV0dXJu
IHRydWU7Cj4+IEBAIC01ODU1LDcgKzU4NTUsNyBAQCBzdGF0aWMgYm9vbCBoc3dfcHJlX3VwZGF0
ZV9kaXNhYmxlX2lwcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfcwo+
PiAgc3RhdGljIGJvb2wgaHN3X3Bvc3RfdXBkYXRlX2VuYWJsZV9pcHMoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+PiAgCQkJCSAgICAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19z
dGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gIAo+PiAgCWlmICghbmV3X2NydGNfc3RhdGUt
Pmlwc19lbmFibGVkKQo+PiBAQCAtNTg3MSw3ICs1ODcxLDcgQEAgc3RhdGljIGJvb2wgaHN3X3Bv
c3RfdXBkYXRlX2VuYWJsZV9pcHMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3MKPj4gIAkgKiBSZS1lbmFibGUgSVBTIGFmdGVyIHRoZSBMVVQgaGFzIGJlZW4gcHJvZ3Jh
bW1lZC4KPj4gIAkgKi8KPj4gIAlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgJiYKPj4gLQkgICAg
KG5ld19jcnRjX3N0YXRlLT5iYXNlLmNvbG9yX21nbXRfY2hhbmdlZCB8fAo+PiArCSAgICAobmV3
X2NydGNfc3RhdGUtPnVhcGkuY29sb3JfbWdtdF9jaGFuZ2VkIHx8Cj4+ICAJICAgICBuZXdfY3J0
Y19zdGF0ZS0+dXBkYXRlX3BpcGUpICYmCj4+ICAJICAgIG5ld19jcnRjX3N0YXRlLT5nYW1tYV9t
b2RlID09IEdBTU1BX01PREVfTU9ERV9TUExJVCkKPj4gIAkJcmV0dXJuIHRydWU7Cj4+IEBAIC01
ODgxLDcgKzU4ODEsNyBAQCBzdGF0aWMgYm9vbCBoc3dfcG9zdF91cGRhdGVfZW5hYmxlX2lwcyhj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfcwo+PiAgCSAqIGZvcmNpYmx5
IGVuYWJsZSBJUFMgb24gdGhlIGZpcnN0IGZhc3RzZXQuCj4+ICAJICovCj4+ICAJaWYgKG5ld19j
cnRjX3N0YXRlLT51cGRhdGVfcGlwZSAmJgo+PiAtCSAgICBvbGRfY3J0Y19zdGF0ZS0+YmFzZS5h
ZGp1c3RlZF9tb2RlLnByaXZhdGVfZmxhZ3MgJiBJOTE1X01PREVfRkxBR19JTkhFUklURUQpCj4+
ICsJICAgIG9sZF9jcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlLnByaXZhdGVfZmxhZ3MgJiBJ
OTE1X01PREVfRkxBR19JTkhFUklURUQpCj4+ICAJCXJldHVybiB0cnVlOwo+PiAgCj4+ICAJcmV0
dXJuICFvbGRfY3J0Y19zdGF0ZS0+aXBzX2VuYWJsZWQ7Cj4+IEBAIC01OTEyLDEwICs1OTEyLDEw
IEBAIHN0YXRpYyBib29sIG5lZWRzX3NjYWxlcmNsa193YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCj4+ICAKPj4gIHN0YXRpYyB2b2lkIGludGVsX3Bvc3RfcGxhbmVfdXBkYXRl
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9j
cnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRj
LT5iYXNlLmRldjsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7Cj4+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gb2xkX2NydGNf
c3RhdGUtPmJhc2Uuc3RhdGU7Cj4+ICsJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0g
b2xkX2NydGNfc3RhdGUtPnVhcGkuc3RhdGU7Cj4+ICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KnBpcGVfY29uZmlnID0KPj4gIAkJaW50ZWxfYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZSh0b19p
bnRlbF9hdG9taWNfc3RhdGUoc3RhdGUpLAo+PiAgCQkJCQkJY3J0Yyk7Cj4+IEBAIC01OTI1LDcg
KzU5MjUsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wb3N0X3BsYW5lX3VwZGF0ZShzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4+ICAKPj4gIAlpbnRlbF9mcm9udGJ1ZmZl
cl9mbGlwKHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpLCBwaXBlX2NvbmZpZy0+ZmJfYml0cyk7Cj4+
ICAKPj4gLQlpZiAocGlwZV9jb25maWctPnVwZGF0ZV93bV9wb3N0ICYmIHBpcGVfY29uZmlnLT5i
YXNlLmFjdGl2ZSkKPj4gKwlpZiAocGlwZV9jb25maWctPnVwZGF0ZV93bV9wb3N0ICYmIHBpcGVf
Y29uZmlnLT5ody5hY3RpdmUpCj4+ICAJCWludGVsX3VwZGF0ZV93YXRlcm1hcmtzKGNydGMpOwo+
PiAgCj4+ICAJaWYgKGhzd19wb3N0X3VwZGF0ZV9lbmFibGVfaXBzKG9sZF9jcnRjX3N0YXRlLCBw
aXBlX2NvbmZpZykpCj4+IEBAIC01OTU1LDEwICs1OTU1LDEwIEBAIHN0YXRpYyB2b2lkIGludGVs
X3Bvc3RfcGxhbmVfdXBkYXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0
ZSkKPj4gIHN0YXRpYyB2b2lkIGludGVsX3ByZV9wbGFuZV91cGRhdGUoc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+PiAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpwaXBlX2NvbmZpZykKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVs
X2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+
PiAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPj4gIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4+IC0Jc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlID0gb2xkX2NydGNfc3RhdGUtPmJhc2Uuc3RhdGU7Cj4+ICsJ
c3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gb2xkX2NydGNfc3RhdGUtPnVhcGkuc3Rh
dGU7Cj4+ICAJc3RydWN0IGRybV9wbGFuZSAqcHJpbWFyeSA9IGNydGMtPmJhc2UucHJpbWFyeTsK
Pj4gIAlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRfcHJpbWFyeV9zdGF0ZSA9Cj4+ICAJCWRy
bV9hdG9taWNfZ2V0X29sZF9wbGFuZV9zdGF0ZShzdGF0ZSwgcHJpbWFyeSk7Cj4+IEBAIC02MDAz
LDcgKzYwMDMsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wcmVfcGxhbmVfdXBkYXRlKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPj4gIAkgKiBldmVudCB3aGljaCBpcyBh
ZnRlciB0aGUgdmJsYW5rIHN0YXJ0IGV2ZW50LCBzbyB3ZSBuZWVkIHRvIGhhdmUgYQo+PiAgCSAq
IHdhaXQtZm9yLXZibGFuayBiZXR3ZWVuIGRpc2FibGluZyB0aGUgcGxhbmUgYW5kIHRoZSBwaXBl
Lgo+PiAgCSAqLwo+PiAtCWlmIChIQVNfR01DSChkZXZfcHJpdikgJiYgb2xkX2NydGNfc3RhdGUt
PmJhc2UuYWN0aXZlICYmCj4+ICsJaWYgKEhBU19HTUNIKGRldl9wcml2KSAmJiBvbGRfY3J0Y19z
dGF0ZS0+aHcuYWN0aXZlICYmCj4+ICAJICAgIHBpcGVfY29uZmlnLT5kaXNhYmxlX2N4c3IgJiYg
aW50ZWxfc2V0X21lbW9yeV9jeHNyKGRldl9wcml2LCBmYWxzZSkpCj4+ICAJCWludGVsX3dhaXRf
Zm9yX3ZibGFuayhkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4+ICAKPj4gQEAgLTYwMTUsNyArNjAx
NSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3ByZV9wbGFuZV91cGRhdGUoc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+PiAgCSAqIFdhQ3hTUkRpc2FibGVkRm9yU3ByaXRl
U2NhbGluZzppdmIKPj4gIAkgKi8KPj4gIAlpZiAocGlwZV9jb25maWctPmRpc2FibGVfbHBfd20g
JiYgaWxrX2Rpc2FibGVfbHBfd20oZGV2KSAmJgo+PiAtCSAgICBvbGRfY3J0Y19zdGF0ZS0+YmFz
ZS5hY3RpdmUpCj4+ICsJICAgIG9sZF9jcnRjX3N0YXRlLT5ody5hY3RpdmUpCj4+ICAJCWludGVs
X3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwgY3J0Yy0+cGlwZSk7Cj4+ICAKPj4gIAkvKgo+PiBA
QCAtNjMxMCw3ICs2MzEwLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5jb2RlcnNfdXBkYXRlX3Bp
cGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCj4+ICAKPj4gIHN0YXRpYyB2b2lkIGludGVsX2Rp
c2FibGVfcHJpbWFyeV9wbGFuZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgaW50ZWxfcGxh
bmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUoY3J0Yy0+YmFzZS5wcmltYXJ5KTsKPj4gIAo+PiAg
CXBsYW5lLT5kaXNhYmxlX3BsYW5lKHBsYW5lLCBjcnRjX3N0YXRlKTsKPj4gQEAgLTYzMTksNyAr
NjMxOSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfcHJpbWFyeV9wbGFuZShjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0Cj4+ICBzdGF0aWMgdm9pZCBpcm9ubGFr
ZV9jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4+ICAJ
CQkJIHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBk
cm1fY3J0YyAqY3J0YyA9IHBpcGVfY29uZmlnLT5iYXNlLmNydGM7Cj4+ICsJc3RydWN0IGRybV9j
cnRjICpjcnRjID0gcGlwZV9jb25maWctPnVhcGkuY3J0YzsKPj4gIAlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2ID0gY3J0Yy0+ZGV2Owo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGV2KTsKPj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Yyk7Cj4+IEBAIC02NDUzLDcgKzY0NTMsNyBAQCBzdGF0aWMgdm9pZCBp
Y2xfcGlwZV9tYnVzX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKPj4gIHN0YXRpYyB2
b2lkIGhhc3dlbGxfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29u
ZmlnLAo+PiAgCQkJCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+PiAgewo+PiAt
CXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IHBpcGVfY29uZmlnLT5iYXNlLmNydGM7Cj4+ICsJc3Ry
dWN0IGRybV9jcnRjICpjcnRjID0gcGlwZV9jb25maWctPnVhcGkuY3J0YzsKPj4gIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmRldik7Cj4+ICAJc3Ry
dWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+PiAgCWVu
dW0gcGlwZSBwaXBlID0gaW50ZWxfY3J0Yy0+cGlwZSwgaHN3X3dvcmthcm91bmRfcGlwZTsKPj4g
QEAgLTY1NjIsNyArNjU2Miw3IEBAIHN0YXRpYyB2b2lkIGhhc3dlbGxfY3J0Y19lbmFibGUoc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+PiAgCj4+ICBzdGF0aWMgdm9pZCBp
cm9ubGFrZV9wZml0X2Rpc2FibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxf
Y3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+PiAgCj4+IEBAIC02NTc4LDcgKzY1
NzgsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9wZml0X2Rpc2FibGUoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKQo+PiAgc3RhdGljIHZvaWQgaXJvbmxha2Vf
Y3J0Y19kaXNhYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKPj4g
IAkJCQkgIHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+PiAgewo+PiAtCXN0cnVj
dCBkcm1fY3J0YyAqY3J0YyA9IG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGM7Cj4+ICsJc3RydWN0
IGRybV9jcnRjICpjcnRjID0gb2xkX2NydGNfc3RhdGUtPnVhcGkuY3J0YzsKPj4gIAlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+ZGV2Owo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxf
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4+IEBAIC02NjM3LDcgKzY2MzcsNyBAQCBzdGF0
aWMgdm9pZCBpcm9ubGFrZV9jcnRjX2Rpc2FibGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9s
ZF9jcnRjX3N0YXRlLAo+PiAgc3RhdGljIHZvaWQgaGFzd2VsbF9jcnRjX2Rpc2FibGUoc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAo+PiAgCQkJCSBzdHJ1Y3QgaW50ZWxf
YXRvbWljX3N0YXRlICpzdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBv
bGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjOwo+PiArCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IG9s
ZF9jcnRjX3N0YXRlLT51YXBpLmNydGM7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+PiAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRl
bF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjKTsKPj4gIAllbnVtIHRyYW5zY29kZXIgY3B1X3Ry
YW5zY29kZXIgPSBvbGRfY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXI7Cj4+IEBAIC02NjcxLDcg
KzY2NzEsNyBAQCBzdGF0aWMgdm9pZCBoYXN3ZWxsX2NydGNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCj4+ICAKPj4gIHN0YXRpYyB2b2lkIGk5eHhfcGZp
dF9lbmFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7
Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAKPj4gIAlpZiAoIWNydGNfc3Rh
dGUtPmdtY2hfcGZpdC5jb250cm9sKQo+PiBAQCAtNjgwMSwxNCArNjgwMSwxNCBAQCBpbnRlbF9h
dXhfcG93ZXJfZG9tYWluKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQo+PiAg
Cj4+ICBzdGF0aWMgdTY0IGdldF9jcnRjX3Bvd2VyX2RvbWFpbnMoc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7
Cj4+ICAJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyOwo+PiAgCWVudW0gcGlwZSBwaXBlID0g
Y3J0Yy0+cGlwZTsKPj4gIAl1NjQgbWFzazsKPj4gIAllbnVtIHRyYW5zY29kZXIgdHJhbnNjb2Rl
ciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwo+PiAgCj4+IC0JaWYgKCFjcnRjX3N0YXRl
LT5iYXNlLmFjdGl2ZSkKPj4gKwlpZiAoIWNydGNfc3RhdGUtPmh3LmFjdGl2ZSkKPj4gIAkJcmV0
dXJuIDA7Cj4+ICAKPj4gIAltYXNrID0gQklUX1VMTChQT1dFUl9ET01BSU5fUElQRShwaXBlKSk7
Cj4+IEBAIC02ODE4LDcgKzY4MTgsNyBAQCBzdGF0aWMgdTY0IGdldF9jcnRjX3Bvd2VyX2RvbWFp
bnMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICAJCW1hc2sgfD0gQklU
X1VMTChQT1dFUl9ET01BSU5fUElQRV9QQU5FTF9GSVRURVIocGlwZSkpOwo+PiAgCj4+ICAJZHJt
X2Zvcl9lYWNoX2VuY29kZXJfbWFzayhlbmNvZGVyLCAmZGV2X3ByaXYtPmRybSwKPj4gLQkJCQkg
IGNydGNfc3RhdGUtPmJhc2UuZW5jb2Rlcl9tYXNrKSB7Cj4+ICsJCQkJICBjcnRjX3N0YXRlLT51
YXBpLmVuY29kZXJfbWFzaykgewo+PiAgCQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5j
b2RlciA9IHRvX2ludGVsX2VuY29kZXIoZW5jb2Rlcik7Cj4+ICAKPj4gIAkJbWFzayB8PSBCSVRf
VUxMKGludGVsX2VuY29kZXItPnBvd2VyX2RvbWFpbik7Cj4+IEBAIC02ODM2LDcgKzY4MzYsNyBA
QCBzdGF0aWMgdTY0IGdldF9jcnRjX3Bvd2VyX2RvbWFpbnMoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4+ICBzdGF0aWMgdTY0Cj4+ICBtb2Rlc2V0X2dldF9jcnRjX3Bvd2Vy
X2RvbWFpbnMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0J
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2RvbWFpbiBkb21haW47Cj4+ICAJdTY0IGRvbWFpbnMsIG5ld19kb21haW5zLCBvbGRfZG9tYWlu
czsKPj4gQEAgLTY4NjUsNyArNjg2NSw3IEBAIHN0YXRpYyB2b2lkIG1vZGVzZXRfcHV0X3Bvd2Vy
X2RvbWFpbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+PiAgc3RhdGljIHZv
aWQgdmFsbGV5dmlld19jcnRjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9j
b25maWcsCj4+ICAJCQkJICAgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4+ICB7
Cj4+IC0Jc3RydWN0IGRybV9jcnRjICpjcnRjID0gcGlwZV9jb25maWctPmJhc2UuY3J0YzsKPj4g
KwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBwaXBlX2NvbmZpZy0+dWFwaS5jcnRjOwo+PiAgCXN0
cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5kZXY7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+PiAgCXN0cnVjdCBpbnRlbF9jcnRjICpp
bnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjKTsKPj4gQEAgLTY5MjEsNyArNjkyMSw3IEBA
IHN0YXRpYyB2b2lkIHZhbGxleXZpZXdfY3J0Y19lbmFibGUoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKnBpcGVfY29uZmlnLAo+PiAgCj4+ICBzdGF0aWMgdm9pZCBpOXh4X3NldF9wbGxfZGl2aWRl
cnMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0J
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAKPj4gIAlJOTE1X1dSSVRFKEZQMChjcnRj
LT5waXBlKSwgY3J0Y19zdGF0ZS0+ZHBsbF9od19zdGF0ZS5mcDApOwo+PiBAQCAtNjkzMSw3ICs2
OTMxLDcgQEAgc3RhdGljIHZvaWQgaTl4eF9zZXRfcGxsX2RpdmlkZXJzKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgc3RhdGljIHZvaWQgaTl4eF9jcnRjX2Vu
YWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4+ICAJCQkgICAgIHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBkcm1fY3J0
YyAqY3J0YyA9IHBpcGVfY29uZmlnLT5iYXNlLmNydGM7Cj4+ICsJc3RydWN0IGRybV9jcnRjICpj
cnRjID0gcGlwZV9jb25maWctPnVhcGkuY3J0YzsKPj4gIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gY3J0Yy0+ZGV2Owo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZGV2KTsKPj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Yyk7Cj4+IEBAIC02OTgxLDcgKzY5ODEsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X2Ny
dGNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPj4gIAo+PiAg
c3RhdGljIHZvaWQgaTl4eF9wZml0X2Rpc2FibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKm9sZF9jcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7
Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5i
YXNlLmRldik7Cj4+ICAKPj4gIAlpZiAoIW9sZF9jcnRjX3N0YXRlLT5nbWNoX3BmaXQuY29udHJv
bCkKPj4gQEAgLTY5OTcsNyArNjk5Nyw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfcGZpdF9kaXNhYmxl
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKPj4gIHN0YXRp
YyB2b2lkIGk5eHhfY3J0Y19kaXNhYmxlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0
Y19zdGF0ZSwKPj4gIAkJCSAgICAgIHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+
PiAgewo+PiAtCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNy
dGM7Cj4+ICsJc3RydWN0IGRybV9jcnRjICpjcnRjID0gb2xkX2NydGNfc3RhdGUtPnVhcGkuY3J0
YzsKPj4gIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+ZGV2Owo+PiAgCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPj4gIAlzdHJ1Y3QgaW50
ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7Cj4+IEBAIC03MTY1LDgg
KzcxNjUsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jb25uZWN0b3JfdmVyaWZ5X3N0YXRlKHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCQlpZiAoIWNydGNfc3RhdGUpCj4+
ICAJCQlyZXR1cm47Cj4+ICAKPj4gLQkJSTkxNV9TVEFURV9XQVJOKCFjcnRjX3N0YXRlLT5iYXNl
LmFjdGl2ZSwKPj4gLQkJICAgICAgImNvbm5lY3RvciBpcyBhY3RpdmUsIGJ1dCBhdHRhY2hlZCBj
cnRjIGlzbid0XG4iKTsKPj4gKwkJSTkxNV9TVEFURV9XQVJOKCFjcnRjX3N0YXRlLT5ody5hY3Rp
dmUsCj4+ICsJCQkJImNvbm5lY3RvciBpcyBhY3RpdmUsIGJ1dCBhdHRhY2hlZCBjcnRjIGlzbid0
XG4iKTsKPj4gIAo+PiAgCQlpZiAoIWVuY29kZXIgfHwgZW5jb2Rlci0+dHlwZSA9PSBJTlRFTF9P
VVRQVVRfRFBfTVNUKQo+PiAgCQkJcmV0dXJuOwo+PiBAQCAtNzE3Nyw4ICs3MTc3LDggQEAgc3Rh
dGljIHZvaWQgaW50ZWxfY29ubmVjdG9yX3ZlcmlmeV9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIAkJSTkxNV9TVEFURV9XQVJOKGNvbm5fc3RhdGUtPmNydGMg
IT0gZW5jb2Rlci0+YmFzZS5jcnRjLAo+PiAgCQkJImF0dGFjaGVkIGVuY29kZXIgY3J0YyBkaWZm
ZXJzIGZyb20gY29ubmVjdG9yIGNydGNcbiIpOwo+PiAgCX0gZWxzZSB7Cj4+IC0JCUk5MTVfU1RB
VEVfV0FSTihjcnRjX3N0YXRlICYmIGNydGNfc3RhdGUtPmJhc2UuYWN0aXZlLAo+PiAtCQkJImF0
dGFjaGVkIGNydGMgaXMgYWN0aXZlLCBidXQgY29ubmVjdG9yIGlzbid0XG4iKTsKPj4gKwkJSTkx
NV9TVEFURV9XQVJOKGNydGNfc3RhdGUgJiYgY3J0Y19zdGF0ZS0+aHcuYWN0aXZlLAo+PiArCQkJ
CSJhdHRhY2hlZCBjcnRjIGlzIGFjdGl2ZSwgYnV0IGNvbm5lY3RvciBpc24ndFxuIik7Cj4+ICAJ
CUk5MTVfU1RBVEVfV0FSTighY3J0Y19zdGF0ZSAmJiBjb25uX3N0YXRlLT5iZXN0X2VuY29kZXIs
Cj4+ICAJCQkiYmVzdCBlbmNvZGVyIHNldCB3aXRob3V0IGNydGMhXG4iKTsKPj4gIAl9Cj4+IEBA
IC03MTg2LDcgKzcxODYsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9jb25uZWN0b3JfdmVyaWZ5X3N0
YXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCj4+ICBzdGF0aWMg
aW50IHBpcGVfcmVxdWlyZWRfZmRpX2xhbmVzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlKQo+PiAgewo+PiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmVuYWJsZSAmJiBjcnRjX3N0
YXRlLT5oYXNfcGNoX2VuY29kZXIpCj4+ICsJaWYgKGNydGNfc3RhdGUtPmh3LmVuYWJsZSAmJiBj
cnRjX3N0YXRlLT5oYXNfcGNoX2VuY29kZXIpCj4+ICAJCXJldHVybiBjcnRjX3N0YXRlLT5mZGlf
bGFuZXM7Cj4+ICAKPj4gIAlyZXR1cm4gMDsKPj4gQEAgLTcxOTYsNyArNzE5Niw3IEBAIHN0YXRp
YyBpbnQgaXJvbmxha2VfY2hlY2tfZmRpX2xhbmVzKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIGVu
dW0gcGlwZSBwaXBlLAo+PiAgCQkJCSAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVf
Y29uZmlnKQo+PiAgewo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZGV2KTsKPj4gLQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBwaXBlX2Nv
bmZpZy0+YmFzZS5zdGF0ZTsKPj4gKwlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBw
aXBlX2NvbmZpZy0+dWFwaS5zdGF0ZTsKPj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqb3RoZXJfY3J0
YzsKPj4gIAlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb3RoZXJfY3J0Y19zdGF0ZTsKPj4gIAo+
PiBAQCAtNzI2OSw3ICs3MjY5LDcgQEAgc3RhdGljIGludCBpcm9ubGFrZV9mZGlfY29tcHV0ZV9j
b25maWcoc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCj4+ICAJCQkJICAgICAgIHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gaW50ZWxfY3J0Yy0+YmFzZS5kZXY7Cj4+IC0JY29uc3Qgc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRf
bW9kZTsKPj4gKwljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9
ICZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAlpbnQgbGFuZSwgbGlua19idywg
ZmRpX2RvdGNsb2NrLCByZXQ7Cj4+ICAJYm9vbCBuZWVkc19yZWNvbXB1dGUgPSBmYWxzZTsKPj4g
IAo+PiBAQCAtNzMxNSw3ICs3MzE1LDcgQEAgc3RhdGljIGludCBpcm9ubGFrZV9mZGlfY29tcHV0
ZV9jb25maWcoc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCj4+ICAKPj4gIGJvb2wgaHN3
X2NydGNfc3RhdGVfaXBzX2NhcGFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAKPj4g
IAkvKiBJUFMgb25seSBleGlzdHMgb24gVUxUIG1hY2hpbmVzIGFuZCBpcyB0aWVkIHRvIHBpcGUg
QS4gKi8KPj4gQEAgLTczNDUsOSArNzM0NSw5IEBAIGJvb2wgaHN3X2NydGNfc3RhdGVfaXBzX2Nh
cGFibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICBzdGF0
aWMgYm9vbCBoc3dfY29tcHV0ZV9pcHNfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+PiAgewo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
Cj4+IC0JCXRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+PiArCQl0b19pOTE1
KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPj4gIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICppbnRlbF9zdGF0ZSA9Cj4+IC0JCXRvX2ludGVsX2F0b21pY19zdGF0ZShjcnRjX3N0YXRl
LT5iYXNlLnN0YXRlKTsKPj4gKwkJdG9faW50ZWxfYXRvbWljX3N0YXRlKGNydGNfc3RhdGUtPnVh
cGkuc3RhdGUpOwo+PiAgCj4+ICAJaWYgKCFoc3dfY3J0Y19zdGF0ZV9pcHNfY2FwYWJsZShjcnRj
X3N0YXRlKSkKPj4gIAkJcmV0dXJuIGZhbHNlOwo+PiBAQCAtNzM4Niw3ICs3Mzg2LDcgQEAgc3Rh
dGljIHUzMiBpbGtfcGlwZV9waXhlbF9yYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpwaXBlX2NvbmZpZykKPj4gIHsKPj4gIAl1MzIgcGl4ZWxfcmF0ZTsKPj4gIAo+PiAtCXBpeGVs
X3JhdGUgPSBwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7Cj4+ICsJ
cGl4ZWxfcmF0ZSA9IHBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7Cj4+
ICAKPj4gIAkvKgo+PiAgCSAqIFdlIG9ubHkgdXNlIElGLUlEIGludGVybGFjaW5nLiBJZiB3ZSBl
dmVyIHVzZQo+PiBAQCAtNzQxOSwxMiArNzQxOSwxMiBAQCBzdGF0aWMgdTMyIGlsa19waXBlX3Bp
eGVsX3JhdGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+PiAg
Cj4+ICBzdGF0aWMgdm9pZCBpbnRlbF9jcnRjX2NvbXB1dGVfcGl4ZWxfcmF0ZShzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUt
PnVhcGkuY3J0Yy0+ZGV2KTsKPj4gIAo+PiAgCWlmIChIQVNfR01DSChkZXZfcHJpdikpCj4+ICAJ
CS8qIEZJWE1FIGNhbGN1bGF0ZSBwcm9wZXIgcGlwZSBwaXhlbCByYXRlIGZvciBHTUNIIHBmaXQg
Ki8KPj4gIAkJY3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZSA9Cj4+IC0JCQljcnRjX3N0YXRlLT5iYXNl
LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jazsKPj4gKwkJCWNydGNfc3RhdGUtPmh3LmFkanVzdGVk
X21vZGUuY3J0Y19jbG9jazsKPj4gIAllbHNlCj4+ICAJCWNydGNfc3RhdGUtPnBpeGVsX3JhdGUg
PQo+PiAgCQkJaWxrX3BpcGVfcGl4ZWxfcmF0ZShjcnRjX3N0YXRlKTsKPj4gQEAgLTc0MzQsNyAr
NzQzNCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YywKPj4gIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBl
X2NvbmZpZykKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gLQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9k
ZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiAr
CWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29u
ZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+PiAgCWludCBjbG9ja19saW1pdCA9IGRldl9wcml2LT5t
YXhfZG90Y2xrX2ZyZXE7Cj4+ICAKPj4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDQpIHsK
Pj4gQEAgLTc0NjAsNyArNzQ2MCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19jb21wdXRlX2Nv
bmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPj4gIAo+PiAgCWlmICgocGlwZV9jb25maWct
Pm91dHB1dF9mb3JtYXQgPT0gSU5URUxfT1VUUFVUX0ZPUk1BVF9ZQ0JDUjQyMCB8fAo+PiAgCSAg
ICAgcGlwZV9jb25maWctPm91dHB1dF9mb3JtYXQgPT0gSU5URUxfT1VUUFVUX0ZPUk1BVF9ZQ0JD
UjQ0NCkgJiYKPj4gLQkgICAgIHBpcGVfY29uZmlnLT5iYXNlLmN0bSkgewo+PiArCSAgICAgcGlw
ZV9jb25maWctPmh3LmN0bSkgewo+PiAgCQkvKgo+PiAgCQkgKiBUaGVyZSBpcyBvbmx5IG9uZSBw
aXBlIENTQyB1bml0IHBlciBwaXBlLCBhbmQgd2UgbmVlZCB0aGF0Cj4+ICAJCSAqIGZvciBvdXRw
dXQgY29udmVyc2lvbiBmcm9tIFJHQi0+WUNCQ1IuIFNvIGlmIENUTSBpcyBhbHJlYWR5Cj4+IEBA
IC03NjI5LDcgKzc2MjksNyBAQCBzdGF0aWMgdm9pZCB2bHZfcGxsYl9yZWNhbF9vcGFtcChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZQo+PiAgc3RhdGljIHZvaWQg
aW50ZWxfcGNoX3RyYW5zY29kZXJfc2V0X21fbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKPj4gIAkJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9saW5rX21fbiAqbV9u
KQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRj
X3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCWVudW0gcGlwZSBw
aXBlID0gY3J0Yy0+cGlwZTsKPj4gIAo+PiBAQCAtNzY1Niw3ICs3NjU2LDcgQEAgc3RhdGljIHZv
aWQgaW50ZWxfY3B1X3RyYW5zY29kZXJfc2V0X21fbihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGEKPj4gIAkJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9saW5rX21fbiAqbV9u
LAo+PiAgCQkJCQkgY29uc3Qgc3RydWN0IGludGVsX2xpbmtfbV9uICptMl9uMikKPj4gIHsKPj4g
LQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMt
PnBpcGU7Cj4+ICAJZW51bSB0cmFuc2NvZGVyIHRyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVf
dHJhbnNjb2RlcjsKPj4gQEAgLTc5NjksNyArNzk2OSw3IEBAIGludCB2bHZfZm9yY2VfcGxsX29u
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUsCj4+ICAJ
aWYgKCFwaXBlX2NvbmZpZykKPj4gIAkJcmV0dXJuIC1FTk9NRU07Cj4+ICAKPj4gLQlwaXBlX2Nv
bmZpZy0+YmFzZS5jcnRjID0gJmNydGMtPmJhc2U7Cj4+ICsJcGlwZV9jb25maWctPnVhcGkuY3J0
YyA9ICZjcnRjLT5iYXNlOwo+PiAgCXBpcGVfY29uZmlnLT5waXhlbF9tdWx0aXBsaWVyID0gMTsK
Pj4gIAlwaXBlX2NvbmZpZy0+ZHBsbCA9ICpkcGxsOwo+PiAgCj4+IEBAIC04MTI5LDExICs4MTI5
LDExIEBAIHN0YXRpYyB2b2lkIGk4eHhfY29tcHV0ZV9kcGxsKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjLAo+PiAgCj4+ICBzdGF0aWMgdm9pZCBpbnRlbF9zZXRfcGlwZV90aW1pbmdzKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiAr
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBp
LmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gIAll
bnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2Rl
cjsKPj4gLQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZj
cnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9kaXNw
bGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsK
Pj4gIAl1MzIgY3J0Y192dG90YWwsIGNydGNfdmJsYW5rX2VuZDsKPj4gIAlpbnQgdnN5bmNzaGlm
dCA9IDA7Cj4+ICAKPj4gQEAgLTgxOTEsNyArODE5MSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Nl
dF9waXBlX3RpbWluZ3MoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4+ICAKPj4gIHN0YXRpYyB2b2lkIGludGVsX3NldF9waXBlX3NyY19zaXplKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNy
dGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Yy0+YmFzZS5kZXYpOwo+PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gIAo+PiBA
QCAtODIxMiwzOSArODIxMiwzOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9nZXRfcGlwZV90aW1pbmdz
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+PiAgCXUzMiB0bXA7Cj4+ICAKPj4gIAl0bXAgPSBJ
OTE1X1JFQUQoSFRPVEFMKGNwdV90cmFuc2NvZGVyKSk7Cj4+IC0JcGlwZV9jb25maWctPmJhc2Uu
YWRqdXN0ZWRfbW9kZS5jcnRjX2hkaXNwbGF5ID0gKHRtcCAmIDB4ZmZmZikgKyAxOwo+PiAtCXBp
cGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19odG90YWwgPSAoKHRtcCA+PiAxNikg
JiAweGZmZmYpICsgMTsKPj4gKwlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2hk
aXNwbGF5ID0gKHRtcCAmIDB4ZmZmZikgKyAxOwo+PiArCXBpcGVfY29uZmlnLT5ody5hZGp1c3Rl
ZF9tb2RlLmNydGNfaHRvdGFsID0gKCh0bXAgPj4gMTYpICYgMHhmZmZmKSArIDE7Cj4+ICAKPj4g
IAlpZiAoIXRyYW5zY29kZXJfaXNfZHNpKGNwdV90cmFuc2NvZGVyKSkgewo+PiAgCQl0bXAgPSBJ
OTE1X1JFQUQoSEJMQU5LKGNwdV90cmFuc2NvZGVyKSk7Cj4+IC0JCXBpcGVfY29uZmlnLT5iYXNl
LmFkanVzdGVkX21vZGUuY3J0Y19oYmxhbmtfc3RhcnQgPQo+PiArCQlwaXBlX2NvbmZpZy0+aHcu
YWRqdXN0ZWRfbW9kZS5jcnRjX2hibGFua19zdGFydCA9Cj4+ICAJCQkJCQkJKHRtcCAmIDB4ZmZm
ZikgKyAxOwo+PiAtCQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaGJsYW5r
X2VuZCA9Cj4+ICsJCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaGJsYW5rX2Vu
ZCA9Cj4+ICAJCQkJCQkoKHRtcCA+PiAxNikgJiAweGZmZmYpICsgMTsKPj4gIAl9Cj4+ICAJdG1w
ID0gSTkxNV9SRUFEKEhTWU5DKGNwdV90cmFuc2NvZGVyKSk7Cj4+IC0JcGlwZV9jb25maWctPmJh
c2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2hzeW5jX3N0YXJ0ID0gKHRtcCAmIDB4ZmZmZikgKyAxOwo+
PiAtCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19oc3luY19lbmQgPSAoKHRt
cCA+PiAxNikgJiAweGZmZmYpICsgMTsKPj4gKwlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9k
ZS5jcnRjX2hzeW5jX3N0YXJ0ID0gKHRtcCAmIDB4ZmZmZikgKyAxOwo+PiArCXBpcGVfY29uZmln
LT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaHN5bmNfZW5kID0gKCh0bXAgPj4gMTYpICYgMHhmZmZm
KSArIDE7Cj4+ICAKPj4gIAl0bXAgPSBJOTE1X1JFQUQoVlRPVEFMKGNwdV90cmFuc2NvZGVyKSk7
Cj4+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX3ZkaXNwbGF5ID0gKHRt
cCAmIDB4ZmZmZikgKyAxOwo+PiAtCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0
Y192dG90YWwgPSAoKHRtcCA+PiAxNikgJiAweGZmZmYpICsgMTsKPj4gKwlwaXBlX2NvbmZpZy0+
aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX3ZkaXNwbGF5ID0gKHRtcCAmIDB4ZmZmZikgKyAxOwo+PiAr
CXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfdnRvdGFsID0gKCh0bXAgPj4gMTYp
ICYgMHhmZmZmKSArIDE7Cj4+ICAKPj4gIAlpZiAoIXRyYW5zY29kZXJfaXNfZHNpKGNwdV90cmFu
c2NvZGVyKSkgewo+PiAgCQl0bXAgPSBJOTE1X1JFQUQoVkJMQU5LKGNwdV90cmFuc2NvZGVyKSk7
Cj4+IC0JCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y192Ymxhbmtfc3RhcnQg
PQo+PiArCQlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX3ZibGFua19zdGFydCA9
Cj4+ICAJCQkJCQkJKHRtcCAmIDB4ZmZmZikgKyAxOwo+PiAtCQlwaXBlX2NvbmZpZy0+YmFzZS5h
ZGp1c3RlZF9tb2RlLmNydGNfdmJsYW5rX2VuZCA9Cj4+ICsJCXBpcGVfY29uZmlnLT5ody5hZGp1
c3RlZF9tb2RlLmNydGNfdmJsYW5rX2VuZCA9Cj4+ICAJCQkJCQkoKHRtcCA+PiAxNikgJiAweGZm
ZmYpICsgMTsKPj4gIAl9Cj4+ICAJdG1wID0gSTkxNV9SRUFEKFZTWU5DKGNwdV90cmFuc2NvZGVy
KSk7Cj4+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX3ZzeW5jX3N0YXJ0
ID0gKHRtcCAmIDB4ZmZmZikgKyAxOwo+PiAtCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21v
ZGUuY3J0Y192c3luY19lbmQgPSAoKHRtcCA+PiAxNikgJiAweGZmZmYpICsgMTsKPj4gKwlwaXBl
X2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX3ZzeW5jX3N0YXJ0ID0gKHRtcCAmIDB4ZmZm
ZikgKyAxOwo+PiArCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfdnN5bmNfZW5k
ID0gKCh0bXAgPj4gMTYpICYgMHhmZmZmKSArIDE7Cj4+ICAKPj4gIAlpZiAoSTkxNV9SRUFEKFBJ
UEVDT05GKGNwdV90cmFuc2NvZGVyKSkgJiBQSVBFQ09ORl9JTlRFUkxBQ0VfTUFTSykgewo+PiAt
CQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IERSTV9NT0RFX0ZMQUdf
SU5URVJMQUNFOwo+PiAtCQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfdnRv
dGFsICs9IDE7Cj4+IC0JCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y192Ymxh
bmtfZW5kICs9IDE7Cj4+ICsJCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9
IERSTV9NT0RFX0ZMQUdfSU5URVJMQUNFOwo+PiArCQlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRf
bW9kZS5jcnRjX3Z0b3RhbCArPSAxOwo+PiArCQlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9k
ZS5jcnRjX3ZibGFua19lbmQgKz0gMTsKPj4gIAl9Cj4+ICB9Cj4+ICAKPj4gQEAgLTgyNTksMjcg
KzgyNTksMjcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZ2V0X3BpcGVfc3JjX3NpemUoc3RydWN0IGlu
dGVsX2NydGMgKmNydGMsCj4+ICAJcGlwZV9jb25maWctPnBpcGVfc3JjX2ggPSAodG1wICYgMHhm
ZmZmKSArIDE7Cj4+ICAJcGlwZV9jb25maWctPnBpcGVfc3JjX3cgPSAoKHRtcCA+PiAxNikgJiAw
eGZmZmYpICsgMTsKPj4gIAo+PiAtCXBpcGVfY29uZmlnLT5iYXNlLm1vZGUudmRpc3BsYXkgPSBw
aXBlX2NvbmZpZy0+cGlwZV9zcmNfaDsKPj4gLQlwaXBlX2NvbmZpZy0+YmFzZS5tb2RlLmhkaXNw
bGF5ID0gcGlwZV9jb25maWctPnBpcGVfc3JjX3c7Cj4+ICsJcGlwZV9jb25maWctPmh3Lm1vZGUu
dmRpc3BsYXkgPSBwaXBlX2NvbmZpZy0+cGlwZV9zcmNfaDsKPj4gKwlwaXBlX2NvbmZpZy0+aHcu
bW9kZS5oZGlzcGxheSA9IHBpcGVfY29uZmlnLT5waXBlX3NyY193Owo+PiAgfQo+PiAgCj4+ICB2
b2lkIGludGVsX21vZGVfZnJvbV9waXBlX2NvbmZpZyhzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
bW9kZSwKPj4gIAkJCQkgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+PiAg
ewo+PiAtCW1vZGUtPmhkaXNwbGF5ID0gcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5j
cnRjX2hkaXNwbGF5Owo+PiAtCW1vZGUtPmh0b3RhbCA9IHBpcGVfY29uZmlnLT5iYXNlLmFkanVz
dGVkX21vZGUuY3J0Y19odG90YWw7Cj4+IC0JbW9kZS0+aHN5bmNfc3RhcnQgPSBwaXBlX2NvbmZp
Zy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaHN5bmNfc3RhcnQ7Cj4+IC0JbW9kZS0+aHN5bmNf
ZW5kID0gcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2hzeW5jX2VuZDsKPj4g
Kwltb2RlLT5oZGlzcGxheSA9IHBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaGRp
c3BsYXk7Cj4+ICsJbW9kZS0+aHRvdGFsID0gcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUu
Y3J0Y19odG90YWw7Cj4+ICsJbW9kZS0+aHN5bmNfc3RhcnQgPSBwaXBlX2NvbmZpZy0+aHcuYWRq
dXN0ZWRfbW9kZS5jcnRjX2hzeW5jX3N0YXJ0Owo+PiArCW1vZGUtPmhzeW5jX2VuZCA9IHBpcGVf
Y29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaHN5bmNfZW5kOwo+PiAgCj4+IC0JbW9kZS0+
dmRpc3BsYXkgPSBwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfdmRpc3BsYXk7
Cj4+IC0JbW9kZS0+dnRvdGFsID0gcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRj
X3Z0b3RhbDsKPj4gLQltb2RlLT52c3luY19zdGFydCA9IHBpcGVfY29uZmlnLT5iYXNlLmFkanVz
dGVkX21vZGUuY3J0Y192c3luY19zdGFydDsKPj4gLQltb2RlLT52c3luY19lbmQgPSBwaXBlX2Nv
bmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfdnN5bmNfZW5kOwo+PiArCW1vZGUtPnZkaXNw
bGF5ID0gcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y192ZGlzcGxheTsKPj4gKwlt
b2RlLT52dG90YWwgPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX3Z0b3RhbDsK
Pj4gKwltb2RlLT52c3luY19zdGFydCA9IHBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNy
dGNfdnN5bmNfc3RhcnQ7Cj4+ICsJbW9kZS0+dnN5bmNfZW5kID0gcGlwZV9jb25maWctPmh3LmFk
anVzdGVkX21vZGUuY3J0Y192c3luY19lbmQ7Cj4+ICAKPj4gLQltb2RlLT5mbGFncyA9IHBpcGVf
Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuZmxhZ3M7Cj4+ICsJbW9kZS0+ZmxhZ3MgPSBwaXBl
X2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFnczsKPj4gIAltb2RlLT50eXBlID0gRFJNX01P
REVfVFlQRV9EUklWRVI7Cj4+ICAKPj4gLQltb2RlLT5jbG9jayA9IHBpcGVfY29uZmlnLT5iYXNl
LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jazsKPj4gKwltb2RlLT5jbG9jayA9IHBpcGVfY29uZmln
LT5ody5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7Cj4+ICAKPj4gIAltb2RlLT5oc3luYyA9IGRy
bV9tb2RlX2hzeW5jKG1vZGUpOwo+PiAgCW1vZGUtPnZyZWZyZXNoID0gZHJtX21vZGVfdnJlZnJl
c2gobW9kZSk7Cj4+IEBAIC04Mjg4LDcgKzgyODgsNyBAQCB2b2lkIGludGVsX21vZGVfZnJvbV9w
aXBlX2NvbmZpZyhzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSwKPj4gIAo+PiAgc3RhdGlj
IHZvaWQgaTl4eF9zZXRfcGlwZWNvbmYoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJdTMy
IHBpcGVjb25mOwo+PiAgCj4+IEBAIC04MzI1LDcgKzgzMjUsNyBAQCBzdGF0aWMgdm9pZCBpOXh4
X3NldF9waXBlY29uZihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
Pj4gIAkJfQo+PiAgCX0KPj4gIAo+PiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21v
ZGUuZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0lOVEVSTEFDRSkgewo+PiArCWlmIChjcnRjX3N0YXRl
LT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzICYgRFJNX01PREVfRkxBR19JTlRFUkxBQ0UpIHsKPj4g
IAkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA0IHx8Cj4+ICAJCSAgICBpbnRlbF9jcnRjX2hh
c190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9TRFZPKSkKPj4gIAkJCXBpcGVjb25mIHw9
IFBJUEVDT05GX0lOVEVSTEFDRV9XX0ZJRUxEX0lORElDQVRJT047Cj4+IEBAIC04NzU3LDcgKzg3
NTcsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9nZXRfY3J0Y195Y2Jjcl9jb25maWcoc3RydWN0IGlu
dGVsX2NydGMgKmNydGMsCj4+ICAKPj4gIHN0YXRpYyB2b2lkIGk5eHhfZ2V0X3BpcGVfY29sb3Jf
Y29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNy
dGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRl
bF9wbGFuZShjcnRjLT5iYXNlLnByaW1hcnkpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCWVudW0gaTl4eF9wbGFu
ZV9pZCBpOXh4X3BsYW5lID0gcGxhbmUtPmk5eHhfcGxhbmU7Cj4+IEBAIC04ODgwLDcgKzg4ODAs
NyBAQCBzdGF0aWMgYm9vbCBpOXh4X2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKPj4gIAkgKiBidXQgaW4gY2FzZSB0aGUgcGlwZSBpcyBlbmFibGVkIHcvbyBhbnkgcG9y
dHMgd2UgbmVlZCBhIHNhbmUKPj4gIAkgKiBkZWZhdWx0Lgo+PiAgCSAqLwo+PiAtCXBpcGVfY29u
ZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9Cj4+ICsJcGlwZV9jb25maWctPmh3
LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9Cj4+ICAJCXBpcGVfY29uZmlnLT5wb3J0X2Nsb2Nr
IC8gcGlwZV9jb25maWctPnBpeGVsX211bHRpcGxpZXI7Cj4+ICAKPj4gIAlyZXQgPSB0cnVlOwo+
PiBAQCAtOTM5NSw3ICs5Mzk1LDcgQEAgdm9pZCBpbnRlbF9pbml0X3BjaF9yZWZjbGsoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+PiAgCj4+ICBzdGF0aWMgdm9pZCBpcm9ubGFr
ZV9zZXRfcGlwZWNvbmYoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJZW51bSBwaXBlIHBp
cGUgPSBjcnRjLT5waXBlOwo+PiAgCXUzMiB2YWw7Cj4+IEBAIC05NDIzLDcgKzk0MjMsNyBAQCBz
dGF0aWMgdm9pZCBpcm9ubGFrZV9zZXRfcGlwZWNvbmYoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUpCj4+ICAJaWYgKGNydGNfc3RhdGUtPmRpdGhlcikKPj4gIAkJdmFs
IHw9IChQSVBFQ09ORl9ESVRIRVJfRU4gfCBQSVBFQ09ORl9ESVRIRVJfVFlQRV9TUCk7Cj4+ICAK
Pj4gLQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzICYgRFJNX01PREVf
RkxBR19JTlRFUkxBQ0UpCj4+ICsJaWYgKGNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGUuZmxh
Z3MgJiBEUk1fTU9ERV9GTEFHX0lOVEVSTEFDRSkKPj4gIAkJdmFsIHw9IFBJUEVDT05GX0lOVEVS
TEFDRURfSUxLOwo+PiAgCWVsc2UKPj4gIAkJdmFsIHw9IFBJUEVDT05GX1BST0dSRVNTSVZFOwo+
PiBAQCAtOTQzOSw3ICs5NDM5LDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2Vfc2V0X3BpcGVjb25m
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgCj4+ICBzdGF0
aWMgdm9pZCBoYXN3ZWxsX3NldF9waXBlY29uZihjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4g
IAllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNj
b2RlcjsKPj4gIAl1MzIgdmFsID0gMDsKPj4gQEAgLTk0NDcsNyArOTQ0Nyw3IEBAIHN0YXRpYyB2
b2lkIGhhc3dlbGxfc2V0X3BpcGVjb25mKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+PiAgCWlmIChJU19IQVNXRUxMKGRldl9wcml2KSAmJiBjcnRjX3N0YXRlLT5k
aXRoZXIpCj4+ICAJCXZhbCB8PSAoUElQRUNPTkZfRElUSEVSX0VOIHwgUElQRUNPTkZfRElUSEVS
X1RZUEVfU1ApOwo+PiAgCj4+IC0JaWYgKGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5m
bGFncyAmIERSTV9NT0RFX0ZMQUdfSU5URVJMQUNFKQo+PiArCWlmIChjcnRjX3N0YXRlLT5ody5h
ZGp1c3RlZF9tb2RlLmZsYWdzICYgRFJNX01PREVfRkxBR19JTlRFUkxBQ0UpCj4+ICAJCXZhbCB8
PSBQSVBFQ09ORl9JTlRFUkxBQ0VEX0lMSzsKPj4gIAllbHNlCj4+ICAJCXZhbCB8PSBQSVBFQ09O
Rl9QUk9HUkVTU0lWRTsKPj4gQEAgLTk0NTgsNyArOTQ1OCw3IEBAIHN0YXRpYyB2b2lkIGhhc3dl
bGxfc2V0X3BpcGVjb25mKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+PiAgCj4+ICBzdGF0aWMgdm9pZCBiZHdfc2V0X3BpcGVtaXNjKGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+
PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFz
ZS5kZXYpOwo+PiAgCXUzMiB2YWwgPSAwOwo+PiAgCj4+IEBAIC05NjQ0LDcgKzk2NDQsNyBAQCBz
dGF0aWMgaW50IGlyb25sYWtlX2NydGNfY29tcHV0ZV9jbG9jayhzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YywKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSA9Cj4+IC0JCXRvX2ludGVsX2F0b21pY19zdGF0ZShjcnRjX3N0YXRlLT5iYXNlLnN0YXRlKTsK
Pj4gKwkJdG9faW50ZWxfYXRvbWljX3N0YXRlKGNydGNfc3RhdGUtPnVhcGkuc3RhdGUpOwo+PiAg
CWNvbnN0IHN0cnVjdCBpbnRlbF9saW1pdCAqbGltaXQ7Cj4+ICAJaW50IHJlZmNsayA9IDEyMDAw
MDsKPj4gIAo+PiBAQCAtMTAwNjAsNyArMTAwNjAsNyBAQCBzdGF0aWMgaW50IGhhc3dlbGxfY3J0
Y19jb21wdXRlX2Nsb2NrKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+PiAgewo+PiAgCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
PiAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlID0KPj4gLQkJdG9faW50ZWxfYXRv
bWljX3N0YXRlKGNydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+PiArCQl0b19pbnRlbF9hdG9taWNf
c3RhdGUoY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZSk7Cj4+ICAKPj4gIAlpZiAoIWludGVsX2NydGNf
aGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0RTSSkgfHwKPj4gIAkgICAgSU5URUxf
R0VOKGRldl9wcml2KSA+PSAxMSkgewo+PiBAQCAtMTA2MDgsNyArMTA2MDgsNyBAQCBzdGF0aWMg
aW50IGludGVsX2NoZWNrX2N1cnNvcihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKPj4gIAl9Cj4+ICAKPj4gIAlyZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jaGVja19wbGFuZV9z
dGF0ZSgmcGxhbmVfc3RhdGUtPmJhc2UsCj4+IC0JCQkJCQkgICZjcnRjX3N0YXRlLT5iYXNlLAo+
PiArCQkJCQkJICAmY3J0Y19zdGF0ZS0+dWFwaSwKPj4gIAkJCQkJCSAgRFJNX1BMQU5FX0hFTFBF
Ul9OT19TQ0FMSU5HLAo+PiAgCQkJCQkJICBEUk1fUExBTkVfSEVMUEVSX05PX1NDQUxJTkcsCj4+
ICAJCQkJCQkgIHRydWUsIHRydWUpOwo+PiBAQCAtMTA3OTEsNyArMTA3OTEsNyBAQCBpOXh4X2N1
cnNvcl9tYXhfc3RyaWRlKHN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUsCj4+ICAKPj4gIHN0YXRp
YyB1MzIgaTl4eF9jdXJzb3JfY3RsX2NydGMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJ
dTMyIGNudGwgPSAwOwo+PiAgCj4+IEBAIC0xMTE5OCwxMiArMTExOTgsMTIgQEAgaW50IGludGVs
X2dldF9sb2FkX2RldGVjdF9waXBlKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4+
ICAJCWdvdG8gZmFpbDsKPj4gIAl9Cj4+ICAKPj4gLQljcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSA9
IGNydGNfc3RhdGUtPmJhc2UuZW5hYmxlID0gdHJ1ZTsKPj4gKwljcnRjX3N0YXRlLT51YXBpLmFj
dGl2ZSA9IGNydGNfc3RhdGUtPnVhcGkuZW5hYmxlID0gdHJ1ZTsKPj4gIAo+PiAgCWlmICghbW9k
ZSkKPj4gIAkJbW9kZSA9ICZsb2FkX2RldGVjdF9tb2RlOwo+PiAgCj4+IC0JcmV0ID0gZHJtX2F0
b21pY19zZXRfbW9kZV9mb3JfY3J0YygmY3J0Y19zdGF0ZS0+YmFzZSwgbW9kZSk7Cj4+ICsJcmV0
ID0gZHJtX2F0b21pY19zZXRfbW9kZV9mb3JfY3J0YygmY3J0Y19zdGF0ZS0+dWFwaSwgbW9kZSk7
Cj4+ICAJaWYgKHJldCkKPj4gIAkJZ290byBmYWlsOwo+PiAgCj4+IEBAIC0xMTQxMSw3ICsxMTQx
MSw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX3BjaF9jbG9ja19nZXQoc3RydWN0IGludGVsX2Ny
dGMgKmNydGMsCj4+ICAJICogd2UgbWF5IG5lZWQgc29tZSBpZGVhIGZvciB0aGUgZG90Y2xvY2sg
YW55d2F5Lgo+PiAgCSAqIENhbGN1bGF0ZSBvbmUgYmFzZWQgb24gdGhlIEZESSBjb25maWd1cmF0
aW9uLgo+PiAgCSAqLwo+PiAtCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19j
bG9jayA9Cj4+ICsJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9Cj4+
ICAJCWludGVsX2RvdGNsb2NrX2NhbGN1bGF0ZShpbnRlbF9mZGlfbGlua19mcmVxKGRldl9wcml2
LCBwaXBlX2NvbmZpZyksCj4+ICAJCQkJCSAmcGlwZV9jb25maWctPmZkaV9tX24pOwo+PiAgfQo+
PiBAQCAtMTE0NDEsNyArMTE0NDEsNyBAQCBpbnRlbF9lbmNvZGVyX2N1cnJlbnRfbW9kZShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKPj4gIAkJcmV0dXJuIE5VTEw7Cj4+ICAJfQo+PiAg
Cj4+IC0JY3J0Y19zdGF0ZS0+YmFzZS5jcnRjID0gJmNydGMtPmJhc2U7Cj4+ICsJY3J0Y19zdGF0
ZS0+dWFwaS5jcnRjID0gJmNydGMtPmJhc2U7Cj4+ICAKPj4gIAlpZiAoIWRldl9wcml2LT5kaXNw
bGF5LmdldF9waXBlX2NvbmZpZyhjcnRjLCBjcnRjX3N0YXRlKSkgewo+PiAgCQlrZnJlZShjcnRj
X3N0YXRlKTsKPj4gQEAgLTExNTEyLDEyICsxMTUxMiwxMiBAQCBpbnQgaW50ZWxfcGxhbmVfYXRv
bWljX2NhbGNfY2hhbmdlcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNf
c3RhdAo+PiAgCQkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKm9sZF9wbGFu
ZV9zdGF0ZSwKPj4gIAkJCQkgICAgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0
ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgaW50ZWxfcGxhbmUg
KnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUpOwo+PiAgCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYp
Owo+PiAgCWJvb2wgbW9kZV9jaGFuZ2VkID0gbmVlZHNfbW9kZXNldChjcnRjX3N0YXRlKTsKPj4g
LQlib29sIHdhc19jcnRjX2VuYWJsZWQgPSBvbGRfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmU7Cj4+
IC0JYm9vbCBpc19jcnRjX2VuYWJsZWQgPSBjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZTsKPj4gKwli
b29sIHdhc19jcnRjX2VuYWJsZWQgPSBvbGRfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlOwo+PiArCWJv
b2wgaXNfY3J0Y19lbmFibGVkID0gY3J0Y19zdGF0ZS0+aHcuYWN0aXZlOwo+PiAgCWJvb2wgdHVy
bl9vZmYsIHR1cm5fb24sIHZpc2libGUsIHdhc192aXNpYmxlOwo+PiAgCXN0cnVjdCBkcm1fZnJh
bWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmJhc2UuZmI7Cj4+ICAJaW50IHJldDsKPj4gQEAg
LTExNjkyLDkgKzExNjkyLDkgQEAgc3RhdGljIGludCBpY2xfYWRkX2xpbmtlZF9wbGFuZXMoc3Ry
dWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4+ICAKPj4gIHN0YXRpYyBpbnQgaWNsX2No
ZWNrX252MTJfcGxhbmVzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAg
ewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAtCXN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlID0gdG9faW50ZWxfYXRvbWljX3N0YXRlKGNydGNfc3RhdGUtPmJhc2Uu
c3RhdGUpOwo+PiArCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlID0gdG9faW50ZWxf
YXRvbWljX3N0YXRlKGNydGNfc3RhdGUtPnVhcGkuc3RhdGUpOwo+PiAgCXN0cnVjdCBpbnRlbF9w
bGFuZSAqcGxhbmUsICpsaW5rZWQ7Cj4+ICAJc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFu
ZV9zdGF0ZTsKPj4gIAlpbnQgaTsKPj4gQEAgLTExNzY0LDkgKzExNzY0LDkgQEAgc3RhdGljIGlu
dCBpY2xfY2hlY2tfbnYxMl9wbGFuZXMoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4+ICAKPj4gIHN0YXRpYyBib29sIGM4X3BsYW5lc19jaGFuZ2VkKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+
ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRjX3N0YXRl
LT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlID0KPj4g
LQkJdG9faW50ZWxfYXRvbWljX3N0YXRlKG5ld19jcnRjX3N0YXRlLT5iYXNlLnN0YXRlKTsKPj4g
KwkJdG9faW50ZWxfYXRvbWljX3N0YXRlKG5ld19jcnRjX3N0YXRlLT51YXBpLnN0YXRlKTsKPj4g
IAljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUgPQo+PiAgCQlp
bnRlbF9hdG9taWNfZ2V0X29sZF9jcnRjX3N0YXRlKHN0YXRlLCBjcnRjKTsKPj4gIAo+PiBAQCAt
MTE3ODQsMTAgKzExNzg0LDEwIEBAIHN0YXRpYyBpbnQgaW50ZWxfY3J0Y19hdG9taWNfY2hlY2so
c3RydWN0IGRybV9jcnRjICpfY3J0YywKPj4gIAlib29sIG1vZGVfY2hhbmdlZCA9IG5lZWRzX21v
ZGVzZXQoY3J0Y19zdGF0ZSk7Cj4+ICAKPj4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDUg
JiYgIUlTX0c0WChkZXZfcHJpdikgJiYKPj4gLQkgICAgbW9kZV9jaGFuZ2VkICYmICFjcnRjX3N0
YXRlLT5iYXNlLmFjdGl2ZSkKPj4gKwkgICAgbW9kZV9jaGFuZ2VkICYmICFjcnRjX3N0YXRlLT5o
dy5hY3RpdmUpCj4+ICAJCWNydGNfc3RhdGUtPnVwZGF0ZV93bV9wb3N0ID0gdHJ1ZTsKPj4gIAo+
PiAtCWlmIChtb2RlX2NoYW5nZWQgJiYgY3J0Y19zdGF0ZS0+YmFzZS5lbmFibGUgJiYKPj4gKwlp
ZiAobW9kZV9jaGFuZ2VkICYmIGNydGNfc3RhdGUtPmh3LmVuYWJsZSAmJgo+PiAgCSAgICBkZXZf
cHJpdi0+ZGlzcGxheS5jcnRjX2NvbXB1dGVfY2xvY2sgJiYKPj4gIAkgICAgIVdBUk5fT04oY3J0
Y19zdGF0ZS0+c2hhcmVkX2RwbGwpKSB7Cj4+ICAJCXJldCA9IGRldl9wcml2LT5kaXNwbGF5LmNy
dGNfY29tcHV0ZV9jbG9jayhjcnRjLCBjcnRjX3N0YXRlKTsKPj4gQEAgLTExODAwLDEwICsxMTgw
MCwxMCBAQCBzdGF0aWMgaW50IGludGVsX2NydGNfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fY3J0
YyAqX2NydGMsCj4+ICAJICogd2hlbiBDOCBwbGFuZXMgYXJlIGdldHRpbmcgZW5hYmxlZC9kaXNh
YmxlZC4KPj4gIAkgKi8KPj4gIAlpZiAoYzhfcGxhbmVzX2NoYW5nZWQoY3J0Y19zdGF0ZSkpCj4+
IC0JCWNydGNfc3RhdGUtPmJhc2UuY29sb3JfbWdtdF9jaGFuZ2VkID0gdHJ1ZTsKPj4gKwkJY3J0
Y19zdGF0ZS0+dWFwaS5jb2xvcl9tZ210X2NoYW5nZWQgPSB0cnVlOwo+PiAgCj4+ICAJaWYgKG1v
ZGVfY2hhbmdlZCB8fCBjcnRjX3N0YXRlLT51cGRhdGVfcGlwZSB8fAo+PiAtCSAgICBjcnRjX3N0
YXRlLT5iYXNlLmNvbG9yX21nbXRfY2hhbmdlZCkgewo+PiArCSAgICBjcnRjX3N0YXRlLT51YXBp
LmNvbG9yX21nbXRfY2hhbmdlZCkgewo+PiAgCQlyZXQgPSBpbnRlbF9jb2xvcl9jaGVjayhjcnRj
X3N0YXRlKTsKPj4gIAkJaWYgKHJldCkKPj4gIAkJCXJldHVybiByZXQ7Cj4+IEBAIC0xMTkyNSw3
ICsxMTkyNSw3IEBAIGNvbXB1dGVfYmFzZWxpbmVfcGlwZV9icHAoc3RydWN0IGludGVsX2NydGMg
KmNydGMsCj4+ICAJCQkgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPj4g
IHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKPj4gLQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBwaXBlX2Nv
bmZpZy0+YmFzZS5zdGF0ZTsKPj4gKwlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBw
aXBlX2NvbmZpZy0+dWFwaS5zdGF0ZTsKPj4gIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVj
dG9yOwo+PiAgCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uZWN0b3Jfc3RhdGU7Cj4+
ICAJaW50IGJwcCwgaTsKPj4gQEAgLTEyMDc4LDcgKzEyMDc4LDcgQEAgc3RhdGljIHZvaWQgaW50
ZWxfZHVtcF9waXBlX2NvbmZpZyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9j
b25maWcsCj4+ICAJCQkJICAgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4+ICAJ
CQkJICAgY29uc3QgY2hhciAqY29udGV4dCkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMp
Owo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+
YmFzZS5kZXYpOwo+PiAgCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3Rh
dGU7Cj4+ICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKPj4gQEAgLTEyMDg3LDE0ICsxMjA4
NywxNCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kdW1wX3BpcGVfY29uZmlnKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKPj4gIAo+PiAgCURSTV9ERUJVR19LTVMoIltD
UlRDOiVkOiVzXSBlbmFibGU6ICVzICVzXG4iLAo+PiAgCQkgICAgICBjcnRjLT5iYXNlLmJhc2Uu
aWQsIGNydGMtPmJhc2UubmFtZSwKPj4gLQkJICAgICAgeWVzbm8ocGlwZV9jb25maWctPmJhc2Uu
ZW5hYmxlKSwgY29udGV4dCk7Cj4+ICsJCSAgICAgIHllc25vKHBpcGVfY29uZmlnLT5ody5lbmFi
bGUpLCBjb250ZXh0KTsKPj4gIAo+PiAtCWlmICghcGlwZV9jb25maWctPmJhc2UuZW5hYmxlKQo+
PiArCWlmICghcGlwZV9jb25maWctPmh3LmVuYWJsZSkKPj4gIAkJZ290byBkdW1wX3BsYW5lczsK
Pj4gIAo+PiAgCXNucHJpbnRmX291dHB1dF90eXBlcyhidWYsIHNpemVvZihidWYpLCBwaXBlX2Nv
bmZpZy0+b3V0cHV0X3R5cGVzKTsKPj4gIAlEUk1fREVCVUdfS01TKCJhY3RpdmU6ICVzLCBvdXRw
dXRfdHlwZXM6ICVzICgweCV4KSwgb3V0cHV0IGZvcm1hdDogJXNcbiIsCj4+IC0JCSAgICAgIHll
c25vKHBpcGVfY29uZmlnLT5iYXNlLmFjdGl2ZSksCj4+ICsJCSAgICAgIHllc25vKHBpcGVfY29u
ZmlnLT5ody5hY3RpdmUpLAo+PiAgCQkgICAgICBidWYsIHBpcGVfY29uZmlnLT5vdXRwdXRfdHlw
ZXMsCj4+ICAJCSAgICAgIG91dHB1dF9mb3JtYXRzKHBpcGVfY29uZmlnLT5vdXRwdXRfZm9ybWF0
KSk7Cj4+ICAKPj4gQEAgLTEyMTM0LDEwICsxMjEzNCwxMCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9k
dW1wX3BpcGVfY29uZmlnKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZp
ZywKPj4gIAkJaW50ZWxfZHVtcF9pbmZvZnJhbWUoZGV2X3ByaXYsICZwaXBlX2NvbmZpZy0+aW5m
b2ZyYW1lcy5oZG1pKTsKPj4gIAo+PiAgCURSTV9ERUJVR19LTVMoInJlcXVlc3RlZCBtb2RlOlxu
Iik7Cj4+IC0JZHJtX21vZGVfZGVidWdfcHJpbnRtb2RlbGluZSgmcGlwZV9jb25maWctPmJhc2Uu
bW9kZSk7Cj4+ICsJZHJtX21vZGVfZGVidWdfcHJpbnRtb2RlbGluZSgmcGlwZV9jb25maWctPmh3
Lm1vZGUpOwo+PiAgCURSTV9ERUJVR19LTVMoImFkanVzdGVkIG1vZGU6XG4iKTsKPj4gLQlkcm1f
bW9kZV9kZWJ1Z19wcmludG1vZGVsaW5lKCZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2Rl
KTsKPj4gLQlpbnRlbF9kdW1wX2NydGNfdGltaW5ncygmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0
ZWRfbW9kZSk7Cj4+ICsJZHJtX21vZGVfZGVidWdfcHJpbnRtb2RlbGluZSgmcGlwZV9jb25maWct
Pmh3LmFkanVzdGVkX21vZGUpOwo+PiArCWludGVsX2R1bXBfY3J0Y190aW1pbmdzKCZwaXBlX2Nv
bmZpZy0+aHcuYWRqdXN0ZWRfbW9kZSk7Cj4+ICAJRFJNX0RFQlVHX0tNUygicG9ydCBjbG9jazog
JWQsIHBpcGUgc3JjIHNpemU6ICVkeCVkLCBwaXhlbCByYXRlICVkXG4iLAo+PiAgCQkgICAgICBw
aXBlX2NvbmZpZy0+cG9ydF9jbG9jaywKPj4gIAkJICAgICAgcGlwZV9jb25maWctPnBpcGVfc3Jj
X3csIHBpcGVfY29uZmlnLT5waXBlX3NyY19oLAo+PiBAQCAtMTIyNTUsNyArMTIyNTUsNyBAQCBz
dGF0aWMgaW50Cj4+ICBjbGVhcl9pbnRlbF9jcnRjX3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9Cj4+IC0JCXRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+PiArCQl0
b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPj4gIAlzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqc2F2ZWRfc3RhdGU7Cj4+ICAKPj4gIAlzYXZlZF9zdGF0ZSA9IGt6YWxsb2Moc2l6
ZW9mKCpzYXZlZF9zdGF0ZSksIEdGUF9LRVJORUwpOwo+PiBAQCAtMTIyNzgsOSArMTIyNzgsMTAg
QEAgY2xlYXJfaW50ZWxfY3J0Y19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPj4gIAkJc2F2ZWRfc3RhdGUtPndtID0gY3J0Y19zdGF0ZS0+d207Cj4+ICAKPj4gIAkv
KiBLZWVwIGJhc2UgZHJtX2NydGNfc3RhdGUgaW50YWN0LCBvbmx5IGNsZWFyIG91ciBleHRlbmRl
ZCBzdHJ1Y3QgKi8KPj4gLQlCVUlMRF9CVUdfT04ob2Zmc2V0b2Yoc3RydWN0IGludGVsX2NydGNf
c3RhdGUsIGJhc2UpKTsKPj4gLQltZW1jcHkoJmNydGNfc3RhdGUtPmJhc2UgKyAxLCAmc2F2ZWRf
c3RhdGUtPmJhc2UgKyAxLAo+PiAtCSAgICAgICBzaXplb2YoKmNydGNfc3RhdGUpIC0gc2l6ZW9m
KGNydGNfc3RhdGUtPmJhc2UpKTsKPj4gKwlCVUlMRF9CVUdfT04ob2Zmc2V0b2Yoc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUsIHVhcGkpKTsKPj4gKwlCVUlMRF9CVUdfT04ob2Zmc2V0b2Yoc3RydWN0
IGludGVsX2NydGNfc3RhdGUsIGh3KSk7Cj4+ICsJbWVtY3B5KCZjcnRjX3N0YXRlLT51YXBpICsg
MSwgJnNhdmVkX3N0YXRlLT51YXBpICsgMSwKPj4gKwkgICAgICAgc2l6ZW9mKCpjcnRjX3N0YXRl
KSAtIHNpemVvZihjcnRjX3N0YXRlLT51YXBpKSk7Cj4+ICAKPj4gIAlrZnJlZShzYXZlZF9zdGF0
ZSk7Cj4+ICAJcmV0dXJuIDA7Cj4+IEBAIC0xMjI4OSw4ICsxMjI5MCw4IEBAIGNsZWFyX2ludGVs
X2NydGNfc3RhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICBzdGF0
aWMgaW50Cj4+ICBpbnRlbF9tb2Rlc2V0X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpwaXBlX2NvbmZpZykKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBwaXBl
X2NvbmZpZy0+YmFzZS5jcnRjOwo+PiAtCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9
IHBpcGVfY29uZmlnLT5iYXNlLnN0YXRlOwo+PiArCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IHBp
cGVfY29uZmlnLT51YXBpLmNydGM7Cj4+ICsJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRl
ID0gcGlwZV9jb25maWctPnVhcGkuc3RhdGU7Cj4+ICAJc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXI7Cj4+ICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcjsKPj4gIAlzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubmVjdG9yX3N0YXRlOwo+PiBAQCAtMTIzMTAsMTMgKzEy
MzExLDEzIEBAIGludGVsX21vZGVzZXRfcGlwZV9jb25maWcoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKnBpcGVfY29uZmlnKQo+PiAgCSAqIHBvc2l0aXZlIG9yIG5lZ2F0aXZlIHBvbGFyaXR5IGlz
IHJlcXVlc3RlZCwgdHJlYXQgdGhpcyBhcyBtZWFuaW5nCj4+ICAJICogbmVnYXRpdmUgcG9sYXJp
dHkuCj4+ICAJICovCj4+IC0JaWYgKCEocGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5m
bGFncyAmCj4+ICsJaWYgKCEocGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuZmxhZ3MgJgo+
PiAgCSAgICAgIChEUk1fTU9ERV9GTEFHX1BIU1lOQyB8IERSTV9NT0RFX0ZMQUdfTkhTWU5DKSkp
Cj4+IC0JCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuZmxhZ3MgfD0gRFJNX01PREVf
RkxBR19OSFNZTkM7Cj4+ICsJCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9
IERSTV9NT0RFX0ZMQUdfTkhTWU5DOwo+PiAgCj4+IC0JaWYgKCEocGlwZV9jb25maWctPmJhc2Uu
YWRqdXN0ZWRfbW9kZS5mbGFncyAmCj4+ICsJaWYgKCEocGlwZV9jb25maWctPmh3LmFkanVzdGVk
X21vZGUuZmxhZ3MgJgo+PiAgCSAgICAgIChEUk1fTU9ERV9GTEFHX1BWU1lOQyB8IERSTV9NT0RF
X0ZMQUdfTlZTWU5DKSkpCj4+IC0JCXBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuZmxh
Z3MgfD0gRFJNX01PREVfRkxBR19OVlNZTkM7Cj4+ICsJCXBpcGVfY29uZmlnLT5ody5hZGp1c3Rl
ZF9tb2RlLmZsYWdzIHw9IERSTV9NT0RFX0ZMQUdfTlZTWU5DOwo+PiAgCj4+ICAJcmV0ID0gY29t
cHV0ZV9iYXNlbGluZV9waXBlX2JwcCh0b19pbnRlbF9jcnRjKGNydGMpLAo+PiAgCQkJCQlwaXBl
X2NvbmZpZyk7Cj4+IEBAIC0xMjMzMyw3ICsxMjMzNCw3IEBAIGludGVsX21vZGVzZXRfcGlwZV9j
b25maWcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnKQo+PiAgCSAqIGNvbXB1
dGF0aW9uIHRvIGNsZWFybHkgZGlzdGluZ3Vpc2ggaXQgZnJvbSB0aGUgYWRqdXN0ZWQgbW9kZSwg
d2hpY2gKPj4gIAkgKiBjYW4gYmUgY2hhbmdlZCBieSB0aGUgY29ubmVjdG9ycyBpbiB0aGUgYmVs
b3cgcmV0cnkgbG9vcC4KPj4gIAkgKi8KPj4gLQlkcm1fbW9kZV9nZXRfaHZfdGltaW5nKCZwaXBl
X2NvbmZpZy0+YmFzZS5tb2RlLAo+PiArCWRybV9tb2RlX2dldF9odl90aW1pbmcoJnBpcGVfY29u
ZmlnLT5ody5tb2RlLAo+PiAgCQkJICAgICAgICZwaXBlX2NvbmZpZy0+cGlwZV9zcmNfdywKPj4g
IAkJCSAgICAgICAmcGlwZV9jb25maWctPnBpcGVfc3JjX2gpOwo+PiAgCj4+IEBAIC0xMjM2Niw3
ICsxMjM2Nyw3IEBAIGludGVsX21vZGVzZXRfcGlwZV9jb25maWcoc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKnBpcGVfY29uZmlnKQo+PiAgCXBpcGVfY29uZmlnLT5waXhlbF9tdWx0aXBsaWVyID0g
MTsKPj4gIAo+PiAgCS8qIEZpbGwgaW4gZGVmYXVsdCBjcnRjIHRpbWluZ3MsIGFsbG93IGVuY29k
ZXJzIHRvIG92ZXJ3cml0ZSB0aGVtLiAqLwo+PiAtCWRybV9tb2RlX3NldF9jcnRjaW5mbygmcGlw
ZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZSwKPj4gKwlkcm1fbW9kZV9zZXRfY3J0Y2luZm8o
JnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLAo+PiAgCQkJICAgICAgQ1JUQ19TVEVSRU9f
RE9VQkxFKTsKPj4gIAo+PiAgCS8qIFBhc3Mgb3VyIG1vZGUgdG8gdGhlIGNvbm5lY3RvcnMgYW5k
IHRoZSBDUlRDIHRvIGdpdmUgdGhlbSBhIGNoYW5jZSB0bwo+PiBAQCAtMTIzOTEsNyArMTIzOTIs
NyBAQCBpbnRlbF9tb2Rlc2V0X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpw
aXBlX2NvbmZpZykKPj4gIAkvKiBTZXQgZGVmYXVsdCBwb3J0IGNsb2NrIGlmIG5vdCBvdmVyd3Jp
dHRlbiBieSB0aGUgZW5jb2Rlci4gTmVlZHMgdG8gYmUKPj4gIAkgKiBkb25lIGFmdGVyd2FyZHMg
aW4gY2FzZSB0aGUgZW5jb2RlciBhZGp1c3RzIHRoZSBtb2RlLiAqLwo+PiAgCWlmICghcGlwZV9j
b25maWctPnBvcnRfY2xvY2spCj4+IC0JCXBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrID0gcGlwZV9j
b25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrCj4+ICsJCXBpcGVfY29uZmlnLT5w
b3J0X2Nsb2NrID0gcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jawo+PiAg
CQkJKiBwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllcjsKPj4gIAo+PiAgCXJldCA9IGludGVs
X2NydGNfY29tcHV0ZV9jb25maWcodG9faW50ZWxfY3J0YyhjcnRjKSwgcGlwZV9jb25maWcpOwo+
PiBAQCAtMTI1NTUsMTIgKzEyNTU2LDEyIEBAIGludGVsX3BpcGVfY29uZmlnX2NvbXBhcmUoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmN1cnJlbnRfY29uZmlnLAo+PiAgCQkJICBjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4+ICAJCQkgIGJvb2wgZmFz
dHNldCkKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGN1cnJlbnRfY29uZmlnLT5iYXNlLmNydGMtPmRldik7Cj4+ICsJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjdXJyZW50X2NvbmZpZy0+dWFwaS5jcnRjLT5k
ZXYpOwo+PiAgCWJvb2wgcmV0ID0gdHJ1ZTsKPj4gIAl1MzIgYnBfZ2FtbWEgPSAwOwo+PiAgCWJv
b2wgZml4dXBfaW5oZXJpdGVkID0gZmFzdHNldCAmJgo+PiAtCQkoY3VycmVudF9jb25maWctPmJh
c2UubW9kZS5wcml2YXRlX2ZsYWdzICYgSTkxNV9NT0RFX0ZMQUdfSU5IRVJJVEVEKSAmJgo+PiAt
CQkhKHBpcGVfY29uZmlnLT5iYXNlLm1vZGUucHJpdmF0ZV9mbGFncyAmIEk5MTVfTU9ERV9GTEFH
X0lOSEVSSVRFRCk7Cj4+ICsJCShjdXJyZW50X2NvbmZpZy0+aHcubW9kZS5wcml2YXRlX2ZsYWdz
ICYgSTkxNV9NT0RFX0ZMQUdfSU5IRVJJVEVEKSAmJgo+PiArCQkhKHBpcGVfY29uZmlnLT5ody5t
b2RlLnByaXZhdGVfZmxhZ3MgJiBJOTE1X01PREVfRkxBR19JTkhFUklURUQpOwo+PiAgCj4+ICAJ
aWYgKGZpeHVwX2luaGVyaXRlZCAmJiAhZmFzdGJvb3RfZW5hYmxlZChkZXZfcHJpdikpIHsKPj4g
IAkJRFJNX0RFQlVHX0tNUygiaW5pdGlhbCBtb2Rlc2V0IGFuZCBmYXN0Ym9vdCBub3Qgc2V0XG4i
KTsKPj4gQEAgLTEyNzQ5LDE5ICsxMjc1MCwxOSBAQCBpbnRlbF9waXBlX2NvbmZpZ19jb21wYXJl
KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjdXJyZW50X2NvbmZpZywKPj4gIAo+PiAg
CVBJUEVfQ09ORl9DSEVDS19YKG91dHB1dF90eXBlcyk7Cj4+ICAKPj4gLQlQSVBFX0NPTkZfQ0hF
Q0tfSShiYXNlLmFkanVzdGVkX21vZGUuY3J0Y19oZGlzcGxheSk7Cj4+IC0JUElQRV9DT05GX0NI
RUNLX0koYmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFsKTsKPj4gLQlQSVBFX0NPTkZfQ0hF
Q0tfSShiYXNlLmFkanVzdGVkX21vZGUuY3J0Y19oYmxhbmtfc3RhcnQpOwo+PiAtCVBJUEVfQ09O
Rl9DSEVDS19JKGJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2hibGFua19lbmQpOwo+PiAtCVBJUEVf
Q09ORl9DSEVDS19JKGJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2hzeW5jX3N0YXJ0KTsKPj4gLQlQ
SVBFX0NPTkZfQ0hFQ0tfSShiYXNlLmFkanVzdGVkX21vZGUuY3J0Y19oc3luY19lbmQpOwo+PiAr
CVBJUEVfQ09ORl9DSEVDS19JKGh3LmFkanVzdGVkX21vZGUuY3J0Y19oZGlzcGxheSk7Cj4+ICsJ
UElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCk7Cj4+ICsJUElQ
RV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2hibGFua19zdGFydCk7Cj4+ICsJ
UElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2hibGFua19lbmQpOwo+PiAr
CVBJUEVfQ09ORl9DSEVDS19JKGh3LmFkanVzdGVkX21vZGUuY3J0Y19oc3luY19zdGFydCk7Cj4+
ICsJUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRjX2hzeW5jX2VuZCk7Cj4+
ICAKPj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShiYXNlLmFkanVzdGVkX21vZGUuY3J0Y192ZGlzcGxh
eSk7Cj4+IC0JUElQRV9DT05GX0NIRUNLX0koYmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfdnRvdGFs
KTsKPj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShiYXNlLmFkanVzdGVkX21vZGUuY3J0Y192Ymxhbmtf
c3RhcnQpOwo+PiAtCVBJUEVfQ09ORl9DSEVDS19JKGJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX3Zi
bGFua19lbmQpOwo+PiAtCVBJUEVfQ09ORl9DSEVDS19JKGJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRj
X3ZzeW5jX3N0YXJ0KTsKPj4gLQlQSVBFX0NPTkZfQ0hFQ0tfSShiYXNlLmFkanVzdGVkX21vZGUu
Y3J0Y192c3luY19lbmQpOwo+PiArCVBJUEVfQ09ORl9DSEVDS19JKGh3LmFkanVzdGVkX21vZGUu
Y3J0Y192ZGlzcGxheSk7Cj4+ICsJUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5j
cnRjX3Z0b3RhbCk7Cj4+ICsJUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5jcnRj
X3ZibGFua19zdGFydCk7Cj4+ICsJUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9kZS5j
cnRjX3ZibGFua19lbmQpOwo+PiArCVBJUEVfQ09ORl9DSEVDS19JKGh3LmFkanVzdGVkX21vZGUu
Y3J0Y192c3luY19zdGFydCk7Cj4+ICsJUElQRV9DT05GX0NIRUNLX0koaHcuYWRqdXN0ZWRfbW9k
ZS5jcnRjX3ZzeW5jX2VuZCk7Cj4+ICAKPj4gIAlQSVBFX0NPTkZfQ0hFQ0tfSShwaXhlbF9tdWx0
aXBsaWVyKTsKPj4gIAlQSVBFX0NPTkZfQ0hFQ0tfSShvdXRwdXRfZm9ybWF0KTsKPj4gQEAgLTEy
Nzc3LDE3ICsxMjc3OCwxNyBAQCBpbnRlbF9waXBlX2NvbmZpZ19jb21wYXJlKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjdXJyZW50X2NvbmZpZywKPj4gIAo+PiAgCVBJUEVfQ09ORl9D
SEVDS19CT09MX0lOQ09NUExFVEUoaGFzX2F1ZGlvKTsKPj4gIAo+PiAtCVBJUEVfQ09ORl9DSEVD
S19GTEFHUyhiYXNlLmFkanVzdGVkX21vZGUuZmxhZ3MsCj4+ICsJUElQRV9DT05GX0NIRUNLX0ZM
QUdTKGh3LmFkanVzdGVkX21vZGUuZmxhZ3MsCj4+ICAJCQkgICAgICBEUk1fTU9ERV9GTEFHX0lO
VEVSTEFDRSk7Cj4+ICAKPj4gIAlpZiAoIVBJUEVfQ09ORl9RVUlSSyhQSVBFX0NPTkZJR19RVUlS
S19NT0RFX1NZTkNfRkxBR1MpKSB7Cj4+IC0JCVBJUEVfQ09ORl9DSEVDS19GTEFHUyhiYXNlLmFk
anVzdGVkX21vZGUuZmxhZ3MsCj4+ICsJCVBJUEVfQ09ORl9DSEVDS19GTEFHUyhody5hZGp1c3Rl
ZF9tb2RlLmZsYWdzLAo+PiAgCQkJCSAgICAgIERSTV9NT0RFX0ZMQUdfUEhTWU5DKTsKPj4gLQkJ
UElQRV9DT05GX0NIRUNLX0ZMQUdTKGJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncywKPj4gKwkJUElQ
RV9DT05GX0NIRUNLX0ZMQUdTKGh3LmFkanVzdGVkX21vZGUuZmxhZ3MsCj4+ICAJCQkJICAgICAg
RFJNX01PREVfRkxBR19OSFNZTkMpOwo+PiAtCQlQSVBFX0NPTkZfQ0hFQ0tfRkxBR1MoYmFzZS5h
ZGp1c3RlZF9tb2RlLmZsYWdzLAo+PiArCQlQSVBFX0NPTkZfQ0hFQ0tfRkxBR1MoaHcuYWRqdXN0
ZWRfbW9kZS5mbGFncywKPj4gIAkJCQkgICAgICBEUk1fTU9ERV9GTEFHX1BWU1lOQyk7Cj4+IC0J
CVBJUEVfQ09ORl9DSEVDS19GTEFHUyhiYXNlLmFkanVzdGVkX21vZGUuZmxhZ3MsCj4+ICsJCVBJ
UEVfQ09ORl9DSEVDS19GTEFHUyhody5hZGp1c3RlZF9tb2RlLmZsYWdzLAo+PiAgCQkJCSAgICAg
IERSTV9NT0RFX0ZMQUdfTlZTWU5DKTsKPj4gIAl9Cj4+ICAKPj4gQEAgLTEyODI2LDcgKzEyODI3
LDcgQEAgaW50ZWxfcGlwZV9jb25maWdfY29tcGFyZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3VycmVudF9jb25maWcsCj4+ICAKPj4gIAkJYnBfZ2FtbWEgPSBpbnRlbF9jb2xvcl9n
ZXRfZ2FtbWFfYml0X3ByZWNpc2lvbihwaXBlX2NvbmZpZyk7Cj4+ICAJCWlmIChicF9nYW1tYSkK
Pj4gLQkJCVBJUEVfQ09ORl9DSEVDS19DT0xPUl9MVVQoZ2FtbWFfbW9kZSwgYmFzZS5nYW1tYV9s
dXQsIGJwX2dhbW1hKTsKPj4gKwkJCVBJUEVfQ09ORl9DSEVDS19DT0xPUl9MVVQoZ2FtbWFfbW9k
ZSwgdWFwaS5nYW1tYV9sdXQsIGJwX2dhbW1hKTsKPj4gIAo+PiAgCX0KPj4gIAo+PiBAQCAtMTI4
NzEsNyArMTI4NzIsNyBAQCBpbnRlbF9waXBlX2NvbmZpZ19jb21wYXJlKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjdXJyZW50X2NvbmZpZywKPj4gIAlpZiAoSVNfRzRYKGRldl9wcml2
KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDUpCj4+ICAJCVBJUEVfQ09ORl9DSEVDS19JKHBp
cGVfYnBwKTsKPj4gIAo+PiAtCVBJUEVfQ09ORl9DSEVDS19DTE9DS19GVVpaWShiYXNlLmFkanVz
dGVkX21vZGUuY3J0Y19jbG9jayk7Cj4+ICsJUElQRV9DT05GX0NIRUNLX0NMT0NLX0ZVWlpZKGh3
LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayk7Cj4+ICAJUElQRV9DT05GX0NIRUNLX0NMT0NLX0ZV
WlpZKHBvcnRfY2xvY2spOwo+PiAgCj4+ICAJUElQRV9DT05GX0NIRUNLX0kobWluX3ZvbHRhZ2Vf
bGV2ZWwpOwo+PiBAQCAtMTI5MDIsNyArMTI5MDMsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9waXBl
X2NvbmZpZ19zYW5pdHlfY2hlY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+
PiAgCWlmIChwaXBlX2NvbmZpZy0+aGFzX3BjaF9lbmNvZGVyKSB7Cj4+ICAJCWludCBmZGlfZG90
Y2xvY2sgPSBpbnRlbF9kb3RjbG9ja19jYWxjdWxhdGUoaW50ZWxfZmRpX2xpbmtfZnJlcShkZXZf
cHJpdiwgcGlwZV9jb25maWcpLAo+PiAgCQkJCQkJCSAgICAmcGlwZV9jb25maWctPmZkaV9tX24p
Owo+PiAtCQlpbnQgZG90Y2xvY2sgPSBwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNy
dGNfY2xvY2s7Cj4+ICsJCWludCBkb3RjbG9jayA9IHBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9t
b2RlLmNydGNfY2xvY2s7Cj4+ICAKPj4gIAkJLyoKPj4gIAkJICogRkRJIGFscmVhZHkgcHJvdmlk
ZWQgb25lIGlkZWEgZm9yIHRoZSBkb3RjbG9jay4KPj4gQEAgLTEyOTMwLDcgKzEyOTMxLDcgQEAg
c3RhdGljIHZvaWQgdmVyaWZ5X3dtX3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+PiAg
CWNvbnN0IGVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gIAlpbnQgcGxhbmUsIGxldmVs
LCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGRldl9wcml2KTsKPj4gIAo+PiAtCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpIDwgOSB8fCAhbmV3X2NydGNfc3RhdGUtPmJhc2UuYWN0aXZlKQo+
PiArCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgOSB8fCAhbmV3X2NydGNfc3RhdGUtPmh3LmFj
dGl2ZSkKPj4gIAkJcmV0dXJuOwo+PiAgCj4+ICAJaHcgPSBremFsbG9jKHNpemVvZigqaHcpLCBH
RlBfS0VSTkVMKTsKPj4gQEAgLTEzMTM5LDEyICsxMzE0MCwxMiBAQCB2ZXJpZnlfY3J0Y19zdGF0
ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPj4gIAlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAq
c3RhdGU7Cj4+ICAJYm9vbCBhY3RpdmU7Cj4+ICAKPj4gLQlzdGF0ZSA9IG9sZF9jcnRjX3N0YXRl
LT5iYXNlLnN0YXRlOwo+PiAtCV9fZHJtX2F0b21pY19oZWxwZXJfY3J0Y19kZXN0cm95X3N0YXRl
KCZvbGRfY3J0Y19zdGF0ZS0+YmFzZSk7Cj4+ICsJc3RhdGUgPSBvbGRfY3J0Y19zdGF0ZS0+dWFw
aS5zdGF0ZTsKPj4gKwlfX2RybV9hdG9taWNfaGVscGVyX2NydGNfZGVzdHJveV9zdGF0ZSgmb2xk
X2NydGNfc3RhdGUtPnVhcGkpOwo+PiAgCXBpcGVfY29uZmlnID0gb2xkX2NydGNfc3RhdGU7Cj4+
ICAJbWVtc2V0KHBpcGVfY29uZmlnLCAwLCBzaXplb2YoKnBpcGVfY29uZmlnKSk7Cj4+IC0JcGlw
ZV9jb25maWctPmJhc2UuY3J0YyA9ICZjcnRjLT5iYXNlOwo+PiAtCXBpcGVfY29uZmlnLT5iYXNl
LnN0YXRlID0gc3RhdGU7Cj4+ICsJcGlwZV9jb25maWctPnVhcGkuY3J0YyA9ICZjcnRjLT5iYXNl
Owo+PiArCXBpcGVfY29uZmlnLT51YXBpLnN0YXRlID0gc3RhdGU7Cj4+ICAKPj4gIAlEUk1fREVC
VUdfS01TKCJbQ1JUQzolZDolc11cbiIsIGNydGMtPmJhc2UuYmFzZS5pZCwgY3J0Yy0+YmFzZS5u
YW1lKTsKPj4gIAo+PiBAQCAtMTMxNTIsMjMgKzEzMTUzLDI2IEBAIHZlcmlmeV9jcnRjX3N0YXRl
KHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+PiAgCj4+ICAJLyogd2Uga2VlcCBib3RoIHBpcGVz
IGVuYWJsZWQgb24gODMwICovCj4+ICAJaWYgKElTX0k4MzAoZGV2X3ByaXYpKQo+PiAtCQlhY3Rp
dmUgPSBuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmU7Cj4+ICsJCWFjdGl2ZSA9IG5ld19jcnRj
X3N0YXRlLT5ody5hY3RpdmU7Cj4+ICAKPj4gLQlJOTE1X1NUQVRFX1dBUk4obmV3X2NydGNfc3Rh
dGUtPmJhc2UuYWN0aXZlICE9IGFjdGl2ZSwKPj4gLQkgICAgICJjcnRjIGFjdGl2ZSBzdGF0ZSBk
b2Vzbid0IG1hdGNoIHdpdGggaHcgc3RhdGUgIgo+PiAtCSAgICAgIihleHBlY3RlZCAlaSwgZm91
bmQgJWkpXG4iLCBuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUsIGFjdGl2ZSk7Cj4+ICsJSTkx
NV9TVEFURV9XQVJOKG5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUgIT0gYWN0aXZlLAo+PiArCQkJ
ImNydGMgYWN0aXZlIHN0YXRlIGRvZXNuJ3QgbWF0Y2ggd2l0aCBodyBzdGF0ZSAiCj4+ICsJCQki
KGV4cGVjdGVkICVpLCBmb3VuZCAlaSlcbiIsCj4+ICsJCQluZXdfY3J0Y19zdGF0ZS0+aHcuYWN0
aXZlLCBhY3RpdmUpOwo+PiAgCj4+IC0JSTkxNV9TVEFURV9XQVJOKGNydGMtPmFjdGl2ZSAhPSBu
ZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUsCj4+IC0JICAgICAidHJhbnNpdGlvbmFsIGFjdGl2
ZSBzdGF0ZSBkb2VzIG5vdCBtYXRjaCBhdG9taWMgaHcgc3RhdGUgIgo+PiAtCSAgICAgIihleHBl
Y3RlZCAlaSwgZm91bmQgJWkpXG4iLCBuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUsIGNydGMt
PmFjdGl2ZSk7Cj4+ICsJSTkxNV9TVEFURV9XQVJOKGNydGMtPmFjdGl2ZSAhPSBuZXdfY3J0Y19z
dGF0ZS0+aHcuYWN0aXZlLAo+PiArCQkJInRyYW5zaXRpb25hbCBhY3RpdmUgc3RhdGUgZG9lcyBu
b3QgbWF0Y2ggYXRvbWljIGh3IHN0YXRlICIKPj4gKwkJCSIoZXhwZWN0ZWQgJWksIGZvdW5kICVp
KVxuIiwKPj4gKwkJCW5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUsIGNydGMtPmFjdGl2ZSk7Cj4+
ICAKPj4gIAlmb3JfZWFjaF9lbmNvZGVyX29uX2NydGMoZGV2LCAmY3J0Yy0+YmFzZSwgZW5jb2Rl
cikgewo+PiAgCQllbnVtIHBpcGUgcGlwZTsKPj4gIAo+PiAgCQlhY3RpdmUgPSBlbmNvZGVyLT5n
ZXRfaHdfc3RhdGUoZW5jb2RlciwgJnBpcGUpOwo+PiAtCQlJOTE1X1NUQVRFX1dBUk4oYWN0aXZl
ICE9IG5ld19jcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSwKPj4gLQkJCSJbRU5DT0RFUjolaV0gYWN0
aXZlICVpIHdpdGggY3J0YyBhY3RpdmUgJWlcbiIsCj4+IC0JCQllbmNvZGVyLT5iYXNlLmJhc2Uu
aWQsIGFjdGl2ZSwgbmV3X2NydGNfc3RhdGUtPmJhc2UuYWN0aXZlKTsKPj4gKwkJSTkxNV9TVEFU
RV9XQVJOKGFjdGl2ZSAhPSBuZXdfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlLAo+PiArCQkJCSJbRU5D
T0RFUjolaV0gYWN0aXZlICVpIHdpdGggY3J0YyBhY3RpdmUgJWlcbiIsCj4+ICsJCQkJZW5jb2Rl
ci0+YmFzZS5iYXNlLmlkLCBhY3RpdmUsCj4+ICsJCQkJbmV3X2NydGNfc3RhdGUtPmh3LmFjdGl2
ZSk7Cj4+ICAKPj4gIAkJSTkxNV9TVEFURV9XQVJOKGFjdGl2ZSAmJiBjcnRjLT5waXBlICE9IHBp
cGUsCj4+ICAJCQkJIkVuY29kZXIgY29ubmVjdGVkIHRvIHdyb25nIHBpcGUgJWNcbiIsCj4+IEBA
IC0xMzE4MCw3ICsxMzE4NCw3IEBAIHZlcmlmeV9jcnRjX3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjLAo+PiAgCj4+ICAJaW50ZWxfY3J0Y19jb21wdXRlX3BpeGVsX3JhdGUocGlwZV9jb25m
aWcpOwo+PiAgCj4+IC0JaWYgKCFuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpCj4+ICsJaWYg
KCFuZXdfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+PiAgCQlyZXR1cm47Cj4+ICAKPj4gIAlpbnRl
bF9waXBlX2NvbmZpZ19zYW5pdHlfY2hlY2soZGV2X3ByaXYsIHBpcGVfY29uZmlnKTsKPj4gQEAg
LTEzMjQyLDcgKzEzMjQ2LDcgQEAgdmVyaWZ5X3NpbmdsZV9kcGxsX3N0YXRlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPj4gIAo+PiAgCWNydGNfbWFzayA9IGRybV9jcnRjX21h
c2soJmNydGMtPmJhc2UpOwo+PiAgCj4+IC0JaWYgKG5ld19jcnRjX3N0YXRlLT5iYXNlLmFjdGl2
ZSkKPj4gKwlpZiAobmV3X2NydGNfc3RhdGUtPmh3LmFjdGl2ZSkKPj4gIAkJSTkxNV9TVEFURV9X
QVJOKCEocGxsLT5hY3RpdmVfbWFzayAmIGNydGNfbWFzayksCj4+ICAJCQkJInBsbCBhY3RpdmUg
bWlzbWF0Y2ggKGV4cGVjdGVkIHBpcGUgJWMgaW4gYWN0aXZlIG1hc2sgMHglMDJ4KVxuIiwKPj4g
IAkJCQlwaXBlX25hbWUoZHJtX2NydGNfaW5kZXgoJmNydGMtPmJhc2UpKSwgcGxsLT5hY3RpdmVf
bWFzayk7Cj4+IEBAIC0xMzMyMCw3ICsxMzMyNCw3IEBAIGludGVsX21vZGVzZXRfdmVyaWZ5X2Rp
c2FibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPj4gIAo+PiAgc3RhdGlj
IHZvaWQgdXBkYXRlX3NjYW5saW5lX29mZnNldChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4g
IAo+PiAgCS8qCj4+IEBAIC0xMzM1MSw3ICsxMzM1NSw3IEBAIHN0YXRpYyB2b2lkIHVwZGF0ZV9z
Y2FubGluZV9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4+ICAJICogYW5zd2VyIHRoYXQncyBzbGlnaHRseSBpbiB0aGUgZnV0dXJlLgo+PiAgCSAqLwo+
PiAgCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKSB7Cj4+IC0JCWNvbnN0IHN0cnVjdCBkcm1fZGlz
cGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9k
ZTsKPj4gKwkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAm
Y3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAkJaW50IHZ0b3RhbDsKPj4gIAo+PiAg
CQl2dG90YWwgPSBhZGp1c3RlZF9tb2RlLT5jcnRjX3Z0b3RhbDsKPj4gQEAgLTEzNDAxLDcgKzEz
NDA1LDcgQEAgc3RhdGljIGludCBoYXN3ZWxsX21vZGVfc2V0X3BsYW5lc193b3JrYXJvdW5kKHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+PiAgCj4+ICAJLyogbG9vayBhdCBhbGwg
Y3J0YydzIHRoYXQgYXJlIGdvaW5nIHRvIGJlIGVuYWJsZWQgaW4gZHVyaW5nIG1vZGVzZXQgKi8K
Pj4gIAlmb3JfZWFjaF9uZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0YywgY3J0Y19z
dGF0ZSwgaSkgewo+PiAtCQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlIHx8Cj4+ICsJCWlm
ICghY3J0Y19zdGF0ZS0+aHcuYWN0aXZlIHx8Cj4+ICAJCSAgICAhbmVlZHNfbW9kZXNldChjcnRj
X3N0YXRlKSkKPj4gIAkJCWNvbnRpbnVlOwo+PiAgCj4+IEBAIC0xMzQyNiw3ICsxMzQzMCw3IEBA
IHN0YXRpYyBpbnQgaGFzd2VsbF9tb2RlX3NldF9wbGFuZXNfd29ya2Fyb3VuZChzdHJ1Y3QgaW50
ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPj4gIAo+PiAgCQljcnRjX3N0YXRlLT5oc3dfd29ya2Fy
b3VuZF9waXBlID0gSU5WQUxJRF9QSVBFOwo+PiAgCj4+IC0JCWlmICghY3J0Y19zdGF0ZS0+YmFz
ZS5hY3RpdmUgfHwKPj4gKwkJaWYgKCFjcnRjX3N0YXRlLT5ody5hY3RpdmUgfHwKPj4gIAkJICAg
IG5lZWRzX21vZGVzZXQoY3J0Y19zdGF0ZSkpCj4+ICAJCQljb250aW51ZTsKPj4gIAo+PiBAQCAt
MTM0NjksMTIgKzEzNDczLDEyIEBAIHN0YXRpYyBpbnQgaW50ZWxfbW9kZXNldF9jaGVja3Moc3Ry
dWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4+ICAKPj4gIAlmb3JfZWFjaF9vbGRuZXdf
aW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3RhdGUsCj4+ICAJCQkJ
CSAgICBuZXdfY3J0Y19zdGF0ZSwgaSkgewo+PiAtCQlpZiAobmV3X2NydGNfc3RhdGUtPmJhc2Uu
YWN0aXZlKQo+PiArCQlpZiAobmV3X2NydGNfc3RhdGUtPmh3LmFjdGl2ZSkKPj4gIAkJCXN0YXRl
LT5hY3RpdmVfcGlwZXMgfD0gQklUKGNydGMtPnBpcGUpOwo+PiAgCQllbHNlCj4+ICAJCQlzdGF0
ZS0+YWN0aXZlX3BpcGVzICY9IH5CSVQoY3J0Yy0+cGlwZSk7Cj4+ICAKPj4gLQkJaWYgKG9sZF9j
cnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSAhPSBuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpCj4+
ICsJCWlmIChvbGRfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlICE9IG5ld19jcnRjX3N0YXRlLT5ody5h
Y3RpdmUpCj4+ICAJCQlzdGF0ZS0+YWN0aXZlX3BpcGVfY2hhbmdlcyB8PSBCSVQoY3J0Yy0+cGlw
ZSk7Cj4+ICAJfQo+PiAgCj4+IEBAIC0xMzUxMyw3ICsxMzUxNyw3IEBAIHN0YXRpYyB2b2lkIGlu
dGVsX2NydGNfY2hlY2tfZmFzdHNldChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xk
X2NydGNfc3RhCj4+ICAJaWYgKCFpbnRlbF9waXBlX2NvbmZpZ19jb21wYXJlKG9sZF9jcnRjX3N0
YXRlLCBuZXdfY3J0Y19zdGF0ZSwgdHJ1ZSkpCj4+ICAJCXJldHVybjsKPj4gIAo+PiAtCW5ld19j
cnRjX3N0YXRlLT5iYXNlLm1vZGVfY2hhbmdlZCA9IGZhbHNlOwo+PiArCW5ld19jcnRjX3N0YXRl
LT51YXBpLm1vZGVfY2hhbmdlZCA9IGZhbHNlOwo+PiAgCW5ld19jcnRjX3N0YXRlLT51cGRhdGVf
cGlwZSA9IHRydWU7Cj4+ICAKPj4gIAkvKgo+PiBAQCAtMTM1NDgsOSArMTM1NTIsOSBAQCBzdGF0
aWMgaW50IGludGVsX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+PiAgCS8q
IENhdGNoIEk5MTVfTU9ERV9GTEFHX0lOSEVSSVRFRCAqLwo+PiAgCWZvcl9lYWNoX29sZG5ld19p
bnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBvbGRfY3J0Y19zdGF0ZSwKPj4gIAkJCQkJ
ICAgIG5ld19jcnRjX3N0YXRlLCBpKSB7Cj4+IC0JCWlmIChuZXdfY3J0Y19zdGF0ZS0+YmFzZS5t
b2RlLnByaXZhdGVfZmxhZ3MgIT0KPj4gLQkJICAgIG9sZF9jcnRjX3N0YXRlLT5iYXNlLm1vZGUu
cHJpdmF0ZV9mbGFncykKPj4gLQkJCW5ld19jcnRjX3N0YXRlLT5iYXNlLm1vZGVfY2hhbmdlZCA9
IHRydWU7Cj4+ICsJCWlmIChuZXdfY3J0Y19zdGF0ZS0+aHcubW9kZS5wcml2YXRlX2ZsYWdzICE9
Cj4+ICsJCSAgICBvbGRfY3J0Y19zdGF0ZS0+aHcubW9kZS5wcml2YXRlX2ZsYWdzKQo+PiArCQkJ
bmV3X2NydGNfc3RhdGUtPnVhcGkubW9kZV9jaGFuZ2VkID0gdHJ1ZTsKPj4gIAl9Cj4+ICAKPj4g
IAlyZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jaGVja19tb2Rlc2V0KGRldiwgJnN0YXRlLT5iYXNl
KTsKPj4gQEAgLTEzNTYyLDcgKzEzNTY2LDcgQEAgc3RhdGljIGludCBpbnRlbF9hdG9taWNfY2hl
Y2soc3RydWN0IGRybV9kZXZpY2UgKmRldiwKPj4gIAkJaWYgKCFuZWVkc19tb2Rlc2V0KG5ld19j
cnRjX3N0YXRlKSkKPj4gIAkJCWNvbnRpbnVlOwo+PiAgCj4+IC0JCWlmICghbmV3X2NydGNfc3Rh
dGUtPmJhc2UuZW5hYmxlKSB7Cj4+ICsJCWlmICghbmV3X2NydGNfc3RhdGUtPnVhcGkuZW5hYmxl
KSB7Cj4+ICAJCQlhbnlfbXMgPSB0cnVlOwo+PiAgCQkJY29udGludWU7Cj4+ICAJCX0KPj4gQEAg
LTEzNzE5LDExICsxMzcyMywxMCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9vbGRfY3J0Y19zdGF0ZV9k
aXNhYmxlcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPj4gIAlpbnRlbF9jaGVj
a19wY2hfZmlmb191bmRlcnJ1bnMoZGV2X3ByaXYpOwo+PiAgCj4+ICAJLyogRklYTUUgdW5pZnkg
dGhpcyBmb3IgYWxsIHBsYXRmb3JtcyAqLwo+PiAtCWlmICghbmV3X2NydGNfc3RhdGUtPmJhc2Uu
YWN0aXZlICYmCj4+ICsJaWYgKCFuZXdfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlICYmCj4+ICAJICAg
ICFIQVNfR01DSChkZXZfcHJpdikgJiYKPj4gIAkgICAgZGV2X3ByaXYtPmRpc3BsYXkuaW5pdGlh
bF93YXRlcm1hcmtzKQo+PiAtCQlkZXZfcHJpdi0+ZGlzcGxheS5pbml0aWFsX3dhdGVybWFya3Mo
c3RhdGUsCj4+IC0JCQkJCQkgICAgIG5ld19jcnRjX3N0YXRlKTsKPj4gKwkJZGV2X3ByaXYtPmRp
c3BsYXkuaW5pdGlhbF93YXRlcm1hcmtzKHN0YXRlLCBuZXdfY3J0Y19zdGF0ZSk7Cj4+ICB9Cj4+
ICAKPj4gIHN0YXRpYyB2b2lkIGludGVsX2NvbW1pdF9tb2Rlc2V0X2Rpc2FibGVzKHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+PiBAQCAtMTM3NDYsNyArMTM3NDksNyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9jb21taXRfbW9kZXNldF9kaXNhYmxlcyhzdHJ1Y3QgaW50ZWxfYXRvbWlj
X3N0YXRlICpzdGF0ZSkKPj4gIAo+PiAgCQlpbnRlbF9wcmVfcGxhbmVfdXBkYXRlKG9sZF9jcnRj
X3N0YXRlLCBuZXdfY3J0Y19zdGF0ZSk7Cj4+ICAKPj4gLQkJaWYgKG9sZF9jcnRjX3N0YXRlLT5i
YXNlLmFjdGl2ZSkKPj4gKwkJaWYgKG9sZF9jcnRjX3N0YXRlLT5ody5hY3RpdmUpCj4+ICAJCQlp
bnRlbF9vbGRfY3J0Y19zdGF0ZV9kaXNhYmxlcyhzdGF0ZSwKPj4gIAkJCQkJCSAgICAgIG9sZF9j
cnRjX3N0YXRlLAo+PiAgCQkJCQkJICAgICAgbmV3X2NydGNfc3RhdGUsCj4+IEBAIC0xMzc2MSw3
ICsxMzc2NCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2NvbW1pdF9tb2Rlc2V0X2VuYWJsZXMoc3Ry
dWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4+ICAJaW50IGk7Cj4+ICAKPj4gIAlmb3Jf
ZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3Rh
dGUsIG5ld19jcnRjX3N0YXRlLCBpKSB7Cj4+IC0JCWlmICghbmV3X2NydGNfc3RhdGUtPmJhc2Uu
YWN0aXZlKQo+PiArCQlpZiAoIW5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUpCj4+ICAJCQljb250
aW51ZTsKPj4gIAo+PiAgCQlpbnRlbF91cGRhdGVfY3J0YyhjcnRjLCBzdGF0ZSwgb2xkX2NydGNf
c3RhdGUsCj4+IEBAIC0xMzc4NCw3ICsxMzc4Nyw3IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21taXRf
bW9kZXNldF9lbmFibGVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+PiAgCj4+
ICAJZm9yX2VhY2hfb2xkbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG9sZF9j
cnRjX3N0YXRlLCBuZXdfY3J0Y19zdGF0ZSwgaSkKPj4gIAkJLyogaWdub3JlIGFsbG9jYXRpb25z
IGZvciBjcnRjJ3MgdGhhdCBoYXZlIGJlZW4gdHVybmVkIG9mZi4gKi8KPj4gLQkJaWYgKG5ld19j
cnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPj4gKwkJaWYgKG5ld19jcnRjX3N0YXRlLT5ody5hY3Rp
dmUpCj4+ICAJCQllbnRyaWVzW2ldID0gb2xkX2NydGNfc3RhdGUtPndtLnNrbC5kZGI7Cj4+ICAK
Pj4gIAkvKiBJZiAybmQgREJ1ZiBzbGljZSByZXF1aXJlZCwgZW5hYmxlIGl0IGhlcmUgKi8KPj4g
QEAgLTEzODA2LDcgKzEzODA5LDcgQEAgc3RhdGljIHZvaWQgc2tsX2NvbW1pdF9tb2Rlc2V0X2Vu
YWJsZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4+ICAKPj4gIAkJCXBpcGUg
PSBjcnRjLT5waXBlOwo+PiAgCj4+IC0JCQlpZiAodXBkYXRlZCAmIGNtYXNrIHx8ICFuZXdfY3J0
Y19zdGF0ZS0+YmFzZS5hY3RpdmUpCj4+ICsJCQlpZiAodXBkYXRlZCAmIGNtYXNrIHx8ICFuZXdf
Y3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+PiAgCQkJCWNvbnRpbnVlOwo+PiAgCj4+ICAJCQlpZiAo
c2tsX2RkYl9hbGxvY2F0aW9uX292ZXJsYXBzKCZuZXdfY3J0Y19zdGF0ZS0+d20uc2tsLmRkYiwK
Pj4gQEAgLTEzODI1LDcgKzEzODI4LDcgQEAgc3RhdGljIHZvaWQgc2tsX2NvbW1pdF9tb2Rlc2V0
X2VuYWJsZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4+ICAJCQkgKi8KPj4g
IAkJCWlmICghc2tsX2RkYl9lbnRyeV9lcXVhbCgmbmV3X2NydGNfc3RhdGUtPndtLnNrbC5kZGIs
Cj4+ICAJCQkJCQkgJm9sZF9jcnRjX3N0YXRlLT53bS5za2wuZGRiKSAmJgo+PiAtCQkJICAgICFu
ZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmVfY2hhbmdlZCAmJgo+PiArCQkJICAgICFuZXdfY3J0
Y19zdGF0ZS0+dWFwaS5hY3RpdmVfY2hhbmdlZCAmJgo+PiAgCQkJICAgIHN0YXRlLT53bV9yZXN1
bHRzLmRpcnR5X3BpcGVzICE9IHVwZGF0ZWQpCj4+ICAJCQkJdmJsX3dhaXQgPSB0cnVlOwo+PiAg
Cj4+IEBAIC0xMzk1OCwxMiArMTM5NjEsMTMgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2Nv
bW1pdF90YWlsKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+PiAgCQlib29sIG1v
ZGVzZXQgPSBuZWVkc19tb2Rlc2V0KG5ld19jcnRjX3N0YXRlKTsKPj4gIAo+PiAgCQkvKiBDb21w
bGV0ZSBldmVudHMgZm9yIG5vdyBkaXNhYmxlIHBpcGVzIGhlcmUuICovCj4+IC0JCWlmIChtb2Rl
c2V0ICYmICFuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUgJiYgbmV3X2NydGNfc3RhdGUtPmJh
c2UuZXZlbnQpIHsKPj4gKwkJaWYgKG1vZGVzZXQgJiYgIW5ld19jcnRjX3N0YXRlLT5ody5hY3Rp
dmUgJiYgbmV3X2NydGNfc3RhdGUtPnVhcGkuZXZlbnQpIHsKPj4gIAkJCXNwaW5fbG9ja19pcnEo
JmRldi0+ZXZlbnRfbG9jayk7Cj4+IC0JCQlkcm1fY3J0Y19zZW5kX3ZibGFua19ldmVudCgmY3J0
Yy0+YmFzZSwgbmV3X2NydGNfc3RhdGUtPmJhc2UuZXZlbnQpOwo+PiArCQkJZHJtX2NydGNfc2Vu
ZF92YmxhbmtfZXZlbnQoJmNydGMtPmJhc2UsCj4+ICsJCQkJCQkgICBuZXdfY3J0Y19zdGF0ZS0+
dWFwaS5ldmVudCk7Cj4+ICAJCQlzcGluX3VubG9ja19pcnEoJmRldi0+ZXZlbnRfbG9jayk7Cj4+
ICAKPj4gLQkJCW5ld19jcnRjX3N0YXRlLT5iYXNlLmV2ZW50ID0gTlVMTDsKPj4gKwkJCW5ld19j
cnRjX3N0YXRlLT51YXBpLmV2ZW50ID0gTlVMTDsKPj4gIAkJfQo+PiAgCX0KPj4gIAo+PiBAQCAt
MTM5OTQsOSArMTM5OTgsOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9hdG9taWNfY29tbWl0X3RhaWwo
c3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCj4+ICAJZHJtX2F0b21pY19oZWxwZXJf
d2FpdF9mb3JfZmxpcF9kb25lKGRldiwgJnN0YXRlLT5iYXNlKTsKPj4gIAo+PiAgCWZvcl9lYWNo
X25ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBuZXdfY3J0Y19zdGF0ZSwgaSkg
ewo+PiAtCQlpZiAobmV3X2NydGNfc3RhdGUtPmJhc2UuYWN0aXZlICYmCj4+ICsJCWlmIChuZXdf
Y3J0Y19zdGF0ZS0+aHcuYWN0aXZlICYmCj4+ICAJCSAgICAhbmVlZHNfbW9kZXNldChuZXdfY3J0
Y19zdGF0ZSkgJiYKPj4gLQkJICAgIChuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jb2xvcl9tZ210X2No
YW5nZWQgfHwKPj4gKwkJICAgIChuZXdfY3J0Y19zdGF0ZS0+dWFwaS5jb2xvcl9tZ210X2NoYW5n
ZWQgfHwKPj4gIAkJICAgICBuZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3BpcGUpKQo+PiAgCQkJaW50
ZWxfY29sb3JfbG9hZF9sdXRzKG5ld19jcnRjX3N0YXRlKTsKPj4gIAl9Cj4+IEBAIC0xNDQ1MSwx
NiArMTQ0NTUsMTYgQEAgaW50Cj4+ICBza2xfbWF4X3NjYWxlKGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCSAgICAgIGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0
X2luZm8gKmZvcm1hdCkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4g
IAlpbnQgbWF4X3NjYWxlOwo+PiAgCWludCBjcnRjX2Nsb2NrLCBtYXhfZG90Y2xrLCB0bXBjbGsx
LCB0bXBjbGsyOwo+PiAgCj4+IC0JaWYgKCFjcnRjX3N0YXRlLT5iYXNlLmVuYWJsZSkKPj4gKwlp
ZiAoIWNydGNfc3RhdGUtPmh3LmVuYWJsZSkKPj4gIAkJcmV0dXJuIERSTV9QTEFORV9IRUxQRVJf
Tk9fU0NBTElORzsKPj4gIAo+PiAtCWNydGNfY2xvY2sgPSBjcnRjX3N0YXRlLT5iYXNlLmFkanVz
dGVkX21vZGUuY3J0Y19jbG9jazsKPj4gLQltYXhfZG90Y2xrID0gdG9faW50ZWxfYXRvbWljX3N0
YXRlKGNydGNfc3RhdGUtPmJhc2Uuc3RhdGUpLT5jZGNsay5sb2dpY2FsLmNkY2xrOwo+PiArCWNy
dGNfY2xvY2sgPSBjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7Cj4+ICsJ
bWF4X2RvdGNsayA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShjcnRjX3N0YXRlLT51YXBpLnN0YXRl
KS0+Y2RjbGsubG9naWNhbC5jZGNsazsKPj4gIAo+PiAgCWlmIChJU19HRU1JTklMQUtFKGRldl9w
cml2KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKQo+PiAgCQltYXhfZG90Y2xrICo9IDI7
Cj4+IEBAIC0xNDUwMSw3ICsxNDUwNSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2JlZ2luX2NydGNf
Y29tbWl0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+PiAgCWlmIChtb2Rlc2V0
KQo+PiAgCQlnb3RvIG91dDsKPj4gIAo+PiAtCWlmIChuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jb2xv
cl9tZ210X2NoYW5nZWQgfHwKPj4gKwlpZiAobmV3X2NydGNfc3RhdGUtPnVhcGkuY29sb3JfbWdt
dF9jaGFuZ2VkIHx8Cj4+ICAJICAgIG5ld19jcnRjX3N0YXRlLT51cGRhdGVfcGlwZSkKPj4gIAkJ
aW50ZWxfY29sb3JfY29tbWl0KG5ld19jcnRjX3N0YXRlKTsKPj4gIAo+PiBAQCAtMTQ1NDcsNyAr
MTQ1NTEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9maW5pc2hfY3J0Y19jb21taXQoc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4+ICAKPj4gIAlpZiAobmV3X2NydGNfc3RhdGUtPnVw
ZGF0ZV9waXBlICYmCj4+ICAJICAgICFuZWVkc19tb2Rlc2V0KG5ld19jcnRjX3N0YXRlKSAmJgo+
PiAtCSAgICBvbGRfY3J0Y19zdGF0ZS0+YmFzZS5tb2RlLnByaXZhdGVfZmxhZ3MgJiBJOTE1X01P
REVfRkxBR19JTkhFUklURUQpCj4+ICsJICAgIG9sZF9jcnRjX3N0YXRlLT5ody5tb2RlLnByaXZh
dGVfZmxhZ3MgJiBJOTE1X01PREVfRkxBR19JTkhFUklURUQpCj4+ICAJCWludGVsX2NydGNfYXJt
X2ZpZm9fdW5kZXJydW4oY3J0YywgbmV3X2NydGNfc3RhdGUpOwo+PiAgfQo+PiAgCj4+IEBAIC0x
NDY1OSw3ICsxNDY2Myw3IEBAIGludGVsX2xlZ2FjeV9jdXJzb3JfdXBkYXRlKHN0cnVjdCBkcm1f
cGxhbmUgKnBsYW5lLAo+PiAgCSAqIFdoZW4gY3J0YyBpcyBpbmFjdGl2ZSBvciB0aGVyZSBpcyBh
IG1vZGVzZXQgcGVuZGluZywKPj4gIAkgKiB3YWl0IGZvciBpdCB0byBjb21wbGV0ZSBpbiB0aGUg
c2xvd3BhdGgKPj4gIAkgKi8KPj4gLQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlIHx8IG5l
ZWRzX21vZGVzZXQoY3J0Y19zdGF0ZSkgfHwKPj4gKwlpZiAoIWNydGNfc3RhdGUtPmh3LmFjdGl2
ZSB8fCBuZWVkc19tb2Rlc2V0KGNydGNfc3RhdGUpIHx8Cj4+ICAJICAgIGNydGNfc3RhdGUtPnVw
ZGF0ZV9waXBlKQo+PiAgCQlnb3RvIHNsb3c7Cj4+ICAKPj4gQEAgLTE0NzUzLDcgKzE0NzU3LDcg
QEAgaW50ZWxfbGVnYWN5X2N1cnNvcl91cGRhdGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsCj4+
ICAJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4+ICBvdXRfZnJl
ZToKPj4gIAlpZiAobmV3X2NydGNfc3RhdGUpCj4+IC0JCWludGVsX2NydGNfZGVzdHJveV9zdGF0
ZShjcnRjLCAmbmV3X2NydGNfc3RhdGUtPmJhc2UpOwo+PiArCQlpbnRlbF9jcnRjX2Rlc3Ryb3lf
c3RhdGUoY3J0YywgJm5ld19jcnRjX3N0YXRlLT51YXBpKTsKPj4gIAlpZiAocmV0KQo+PiAgCQlp
bnRlbF9wbGFuZV9kZXN0cm95X3N0YXRlKHBsYW5lLCBuZXdfcGxhbmVfc3RhdGUpOwo+PiAgCWVs
c2UKPj4gQEAgLTE1MDc5LDcgKzE1MDgzLDcgQEAgc3RhdGljIGludCBpbnRlbF9jcnRjX2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlwZSkKPj4gIAkJ
cmV0ID0gLUVOT01FTTsKPj4gIAkJZ290byBmYWlsOwo+PiAgCX0KPj4gLQlfX2RybV9hdG9taWNf
aGVscGVyX2NydGNfcmVzZXQoJmludGVsX2NydGMtPmJhc2UsICZjcnRjX3N0YXRlLT5iYXNlKTsK
Pj4gKwlfX2RybV9hdG9taWNfaGVscGVyX2NydGNfcmVzZXQoJmludGVsX2NydGMtPmJhc2UsICZj
cnRjX3N0YXRlLT51YXBpKTsKPj4gIAlpbnRlbF9jcnRjLT5jb25maWcgPSBjcnRjX3N0YXRlOwo+
PiAgCj4+ICAJcHJpbWFyeSA9IGludGVsX3ByaW1hcnlfcGxhbmVfY3JlYXRlKGRldl9wcml2LCBw
aXBlKTsKPj4gQEAgLTE2NDU1LDcgKzE2NDU5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2FuaXRp
emVfY3J0YyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPj4gIAkJCSAgIEk5MTVfUkVBRChyZWcp
ICYgflBJUEVDT05GX0ZSQU1FX1NUQVJUX0RFTEFZX01BU0spOwo+PiAgCX0KPj4gIAo+PiAtCWlm
IChjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkgewo+PiArCWlmIChjcnRjX3N0YXRlLT5ody5hY3Rp
dmUpIHsKPj4gIAkJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKPj4gIAo+PiAgCQkvKiBEaXNh
YmxlIGV2ZXJ5dGhpbmcgYnV0IHRoZSBwcmltYXJ5IHBsYW5lICovCj4+IEBAIC0xNjQ4MCwxMCAr
MTY0ODQsMTAgQEAgc3RhdGljIHZvaWQgaW50ZWxfc2FuaXRpemVfY3J0YyhzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YywKPj4gIAo+PiAgCS8qIEFkanVzdCB0aGUgc3RhdGUgb2YgdGhlIG91dHB1dCBw
aXBlIGFjY29yZGluZyB0byB3aGV0aGVyIHdlCj4+ICAJICogaGF2ZSBhY3RpdmUgY29ubmVjdG9y
cy9lbmNvZGVycy4gKi8KPj4gLQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUgJiYgIWludGVs
X2NydGNfaGFzX2VuY29kZXJzKGNydGMpKQo+PiArCWlmIChjcnRjX3N0YXRlLT5ody5hY3RpdmUg
JiYgIWludGVsX2NydGNfaGFzX2VuY29kZXJzKGNydGMpKQo+PiAgCQlpbnRlbF9jcnRjX2Rpc2Fi
bGVfbm9hdG9taWMoJmNydGMtPmJhc2UsIGN0eCk7Cj4+ICAKPj4gLQlpZiAoY3J0Y19zdGF0ZS0+
YmFzZS5hY3RpdmUgfHwgSEFTX0dNQ0goZGV2X3ByaXYpKSB7Cj4+ICsJaWYgKGNydGNfc3RhdGUt
Pmh3LmFjdGl2ZSB8fCBIQVNfR01DSChkZXZfcHJpdikpIHsKPj4gIAkJLyoKPj4gIAkJICogV2Ug
c3RhcnQgb3V0IHdpdGggdW5kZXJydW4gcmVwb3J0aW5nIGRpc2FibGVkIHRvIGF2b2lkIHJhY2Vz
Lgo+PiAgCQkgKiBGb3IgY29ycmVjdCBib29ra2VlcGluZyBtYXJrIHRoaXMgb24gYWN0aXZlIGNy
dGNzLgo+PiBAQCAtMTY1MTQsNyArMTY1MTgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zYW5pdGl6
ZV9jcnRjKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+PiAgCj4+ICBzdGF0aWMgYm9vbCBoYXNf
Ym9ndXNfZHBsbF9jb25maWcoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4+ICAK
Pj4gIAkvKgo+PiAgCSAqIFNvbWUgU05CIEJJT1NlbiAoZWcuIEFTVVMgSzUzU1YpIGFyZSBrbm93
biB0byBtaXNwcm9ncmFtCj4+IEBAIC0xNjUyNyw3ICsxNjUzMSw3IEBAIHN0YXRpYyBib29sIGhh
c19ib2d1c19kcGxsX2NvbmZpZyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSkKPj4gIAkgKiByb2FkLgo+PiAgCSAqLwo+PiAgCXJldHVybiBJU19HRU4oZGV2X3ByaXYs
IDYpICYmCj4+IC0JCWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlICYmCj4+ICsJCWNydGNfc3RhdGUt
Pmh3LmFjdGl2ZSAmJgo+PiAgCQljcnRjX3N0YXRlLT5zaGFyZWRfZHBsbCAmJgo+PiAgCQljcnRj
X3N0YXRlLT5wb3J0X2Nsb2NrID09IDA7Cj4+ICB9Cj4+IEBAIC0xNjU0NCw3ICsxNjU0OCw3IEBA
IHN0YXRpYyB2b2lkIGludGVsX3Nhbml0aXplX2VuY29kZXIoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIpCj4+ICAJICogZW5jb2RlciBpcyBhY3RpdmUgYW5kIHRyeWluZyB0byByZWFkIGZy
b20gYSBwaXBlKSBhbmQgdGhlCj4+ICAJICogcGlwZSBpdHNlbGYgYmVpbmcgYWN0aXZlLiAqLwo+
PiAgCWJvb2wgaGFzX2FjdGl2ZV9jcnRjID0gY3J0Y19zdGF0ZSAmJgo+PiAtCQljcnRjX3N0YXRl
LT5iYXNlLmFjdGl2ZTsKPj4gKwkJY3J0Y19zdGF0ZS0+aHcuYWN0aXZlOwo+PiAgCj4+ICAJaWYg
KGNydGNfc3RhdGUgJiYgaGFzX2JvZ3VzX2RwbGxfY29uZmlnKGNydGNfc3RhdGUpKSB7Cj4+ICAJ
CURSTV9ERUJVR19LTVMoIkJJT1MgaGFzIG1pc3Byb2dyYW1tZWQgdGhlIGhhcmR3YXJlLiBEaXNh
YmxpbmcgcGlwZSAlY1xuIiwKPj4gQEAgLTE2NjgxLDIyICsxNjY4NSwyMiBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikK
Pj4gIAkJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUgPQo+PiAgCQkJdG9faW50
ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPj4gIAo+PiAtCQlfX2RybV9hdG9taWNf
aGVscGVyX2NydGNfZGVzdHJveV9zdGF0ZSgmY3J0Y19zdGF0ZS0+YmFzZSk7Cj4+ICsJCV9fZHJt
X2F0b21pY19oZWxwZXJfY3J0Y19kZXN0cm95X3N0YXRlKCZjcnRjX3N0YXRlLT51YXBpKTsKPj4g
IAkJbWVtc2V0KGNydGNfc3RhdGUsIDAsIHNpemVvZigqY3J0Y19zdGF0ZSkpOwo+PiAtCQlfX2Ry
bV9hdG9taWNfaGVscGVyX2NydGNfcmVzZXQoJmNydGMtPmJhc2UsICZjcnRjX3N0YXRlLT5iYXNl
KTsKPj4gKwkJX19kcm1fYXRvbWljX2hlbHBlcl9jcnRjX3Jlc2V0KCZjcnRjLT5iYXNlLCAmY3J0
Y19zdGF0ZS0+dWFwaSk7Cj4+ICAKPj4gLQkJY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUgPSBjcnRj
X3N0YXRlLT5iYXNlLmVuYWJsZSA9Cj4+ICsJCWNydGNfc3RhdGUtPmh3LmFjdGl2ZSA9IGNydGNf
c3RhdGUtPmh3LmVuYWJsZSA9Cj4+ICAJCQlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfcGlwZV9jb25m
aWcoY3J0YywgY3J0Y19zdGF0ZSk7Cj4+ICAKPj4gLQkJY3J0Yy0+YmFzZS5lbmFibGVkID0gY3J0
Y19zdGF0ZS0+YmFzZS5lbmFibGU7Cj4+IC0JCWNydGMtPmFjdGl2ZSA9IGNydGNfc3RhdGUtPmJh
c2UuYWN0aXZlOwo+PiArCQljcnRjLT5iYXNlLmVuYWJsZWQgPSBjcnRjX3N0YXRlLT5ody5lbmFi
bGU7Cj4+ICsJCWNydGMtPmFjdGl2ZSA9IGNydGNfc3RhdGUtPmh3LmFjdGl2ZTsKPj4gIAo+PiAt
CQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpCj4+ICsJCWlmIChjcnRjX3N0YXRlLT5ody5h
Y3RpdmUpCj4+ICAJCQlkZXZfcHJpdi0+YWN0aXZlX3BpcGVzIHw9IEJJVChjcnRjLT5waXBlKTsK
Pj4gIAo+PiAgCQlEUk1fREVCVUdfS01TKCJbQ1JUQzolZDolc10gaHcgc3RhdGUgcmVhZG91dDog
JXNcbiIsCj4+ICAJCQkgICAgICBjcnRjLT5iYXNlLmJhc2UuaWQsIGNydGMtPmJhc2UubmFtZSwK
Pj4gLQkJCSAgICAgIGVuYWJsZWRkaXNhYmxlZChjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkpOwo+
PiArCQkJICAgICAgZW5hYmxlZGRpc2FibGVkKGNydGNfc3RhdGUtPmh3LmFjdGl2ZSkpOwo+PiAg
CX0KPj4gIAo+PiAgCXJlYWRvdXRfcGxhbmVfc3RhdGUoZGV2X3ByaXYpOwo+PiBAQCAtMTY3MTgs
NyArMTY3MjIsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUo
c3RydWN0IGRybV9kZXZpY2UgKmRldikKPj4gIAkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlID0KPj4gIAkJCQl0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uuc3RhdGUp
Owo+PiAgCj4+IC0JCQlpZiAoY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUgJiYKPj4gKwkJCWlmIChj
cnRjX3N0YXRlLT5ody5hY3RpdmUgJiYKPj4gIAkJCSAgICBjcnRjX3N0YXRlLT5zaGFyZWRfZHBs
bCA9PSBwbGwpCj4+ICAJCQkJcGxsLT5zdGF0ZS5jcnRjX21hc2sgfD0gMSA8PCBjcnRjLT5waXBl
Owo+PiAgCQl9Cj4+IEBAIC0xNjc1MiwyMSArMTY3NTYsMjQgQEAgc3RhdGljIHZvaWQgaW50ZWxf
bW9kZXNldF9yZWFkb3V0X2h3X3N0YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4+ICAJZHJt
X2Nvbm5lY3Rvcl9saXN0X2l0ZXJfYmVnaW4oZGV2LCAmY29ubl9pdGVyKTsKPj4gIAlmb3JfZWFj
aF9pbnRlbF9jb25uZWN0b3JfaXRlcihjb25uZWN0b3IsICZjb25uX2l0ZXIpIHsKPj4gIAkJaWYg
KGNvbm5lY3Rvci0+Z2V0X2h3X3N0YXRlKGNvbm5lY3RvcikpIHsKPj4gLQkJCWNvbm5lY3Rvci0+
YmFzZS5kcG1zID0gRFJNX01PREVfRFBNU19PTjsKPj4gKwkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlID0gTlVMTDsKPj4gIAo+PiArCQkJY29ubmVjdG9yLT5iYXNlLmRwbXMg
PSBEUk1fTU9ERV9EUE1TX09OOwo+PiAgCQkJZW5jb2RlciA9IGNvbm5lY3Rvci0+ZW5jb2RlcjsK
Pj4gIAkJCWNvbm5lY3Rvci0+YmFzZS5lbmNvZGVyID0gJmVuY29kZXItPmJhc2U7Cj4+ICAKPj4g
LQkJCWlmIChlbmNvZGVyLT5iYXNlLmNydGMgJiYKPj4gLQkJCSAgICBlbmNvZGVyLT5iYXNlLmNy
dGMtPnN0YXRlLT5hY3RpdmUpIHsKPj4gKwkJCWlmIChlbmNvZGVyLT5iYXNlLmNydGMpCj4+ICsJ
CQkJY3J0Y19zdGF0ZSA9IHRvX2ludGVsX2NydGNfc3RhdGUoZW5jb2Rlci0+YmFzZS5jcnRjLT5z
dGF0ZSk7Cj4+ICsKPj4gKwkJCWlmIChjcnRjX3N0YXRlICYmIGNydGNfc3RhdGUtPmh3LmFjdGl2
ZSkgewo+PiAgCQkJCS8qCj4+ICAJCQkJICogVGhpcyBoYXMgdG8gYmUgZG9uZSBkdXJpbmcgaGFy
ZHdhcmUgcmVhZG91dAo+PiAgCQkJCSAqIGJlY2F1c2UgYW55dGhpbmcgY2FsbGluZyAuY3J0Y19k
aXNhYmxlIG1heQo+PiAgCQkJCSAqIHJlbHkgb24gdGhlIGNvbm5lY3Rvcl9tYXNrIGJlaW5nIGFj
Y3VyYXRlLgo+PiAgCQkJCSAqLwo+PiAtCQkJCWVuY29kZXItPmJhc2UuY3J0Yy0+c3RhdGUtPmNv
bm5lY3Rvcl9tYXNrIHw9Cj4+ICsJCQkJY3J0Y19zdGF0ZS0+dWFwaS5jb25uZWN0b3JfbWFzayB8
PQo+PiAgCQkJCQlkcm1fY29ubmVjdG9yX21hc2soJmNvbm5lY3Rvci0+YmFzZSk7Cj4+IC0JCQkJ
ZW5jb2Rlci0+YmFzZS5jcnRjLT5zdGF0ZS0+ZW5jb2Rlcl9tYXNrIHw9Cj4+ICsJCQkJY3J0Y19z
dGF0ZS0+dWFwaS5lbmNvZGVyX21hc2sgfD0KPj4gIAkJCQkJZHJtX2VuY29kZXJfbWFzaygmZW5j
b2Rlci0+YmFzZSk7Cj4+ICAJCQl9Cj4+ICAKPj4gQEAgLTE2Nzg5LDExICsxNjc5NiwxMiBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZp
Y2UgKmRldikKPj4gIAkJaW50IG1pbl9jZGNsayA9IDA7Cj4+ICAKPj4gIAkJbWVtc2V0KCZjcnRj
LT5iYXNlLm1vZGUsIDAsIHNpemVvZihjcnRjLT5iYXNlLm1vZGUpKTsKPj4gLQkJaWYgKGNydGNf
c3RhdGUtPmJhc2UuYWN0aXZlKSB7Cj4+ICsJCWlmIChjcnRjX3N0YXRlLT5ody5hY3RpdmUpIHsK
Pj4gIAkJCWludGVsX21vZGVfZnJvbV9waXBlX2NvbmZpZygmY3J0Yy0+YmFzZS5tb2RlLCBjcnRj
X3N0YXRlKTsKPj4gIAkJCWNydGMtPmJhc2UubW9kZS5oZGlzcGxheSA9IGNydGNfc3RhdGUtPnBp
cGVfc3JjX3c7Cj4+ICAJCQljcnRjLT5iYXNlLm1vZGUudmRpc3BsYXkgPSBjcnRjX3N0YXRlLT5w
aXBlX3NyY19oOwo+PiAtCQkJaW50ZWxfbW9kZV9mcm9tX3BpcGVfY29uZmlnKCZjcnRjX3N0YXRl
LT5iYXNlLmFkanVzdGVkX21vZGUsIGNydGNfc3RhdGUpOwo+PiArCQkJaW50ZWxfbW9kZV9mcm9t
X3BpcGVfY29uZmlnKCZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlLAo+PiArCQkJCQkJICAg
IGNydGNfc3RhdGUpOwo+PiAgCQkJV0FSTl9PTihkcm1fYXRvbWljX3NldF9tb2RlX2Zvcl9jcnRj
KGNydGMtPmJhc2Uuc3RhdGUsICZjcnRjLT5iYXNlLm1vZGUpKTsKPj4gIAo+PiAgCQkJLyoKPj4g
QEAgLTE2ODA1LDcgKzE2ODEzLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfbW9kZXNldF9yZWFkb3V0
X2h3X3N0YXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCj4+ICAJCQkgKiBzZXQgYSBmbGFnIHRv
IGluZGljYXRlIHRoYXQgYSBmdWxsIHJlY2FsY3VsYXRpb24gaXMKPj4gIAkJCSAqIG5lZWRlZCBv
biB0aGUgbmV4dCBjb21taXQuCj4+ICAJCQkgKi8KPj4gLQkJCWNydGNfc3RhdGUtPmJhc2UubW9k
ZS5wcml2YXRlX2ZsYWdzID0gSTkxNV9NT0RFX0ZMQUdfSU5IRVJJVEVEOwo+PiArCQkJY3J0Y19z
dGF0ZS0+aHcubW9kZS5wcml2YXRlX2ZsYWdzID0gSTkxNV9NT0RFX0ZMQUdfSU5IRVJJVEVEOwo+
PiAgCj4+ICAJCQlpbnRlbF9jcnRjX2NvbXB1dGVfcGl4ZWxfcmF0ZShjcnRjX3N0YXRlKTsKPj4g
IAo+PiBAQCAtMTY4MTYsNyArMTY4MjQsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tb2Rlc2V0X3Jl
YWRvdXRfaHdfc3RhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKPj4gIAkJCX0KPj4gIAo+PiAg
CQkJZHJtX2NhbGNfdGltZXN0YW1waW5nX2NvbnN0YW50cygmY3J0Yy0+YmFzZSwKPj4gLQkJCQkJ
CQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlKTsKPj4gKwkJCQkJCQkmY3J0Y19zdGF0
ZS0+aHcuYWRqdXN0ZWRfbW9kZSk7Cj4+ICAJCQl1cGRhdGVfc2NhbmxpbmVfb2Zmc2V0KGNydGNf
c3RhdGUpOwo+PiAgCQl9Cj4+ICAKPj4gQEAgLTE2OTg3LDcgKzE2OTk1LDcgQEAgaW50ZWxfbW9k
ZXNldF9zZXR1cF9od19zdGF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAo+PiAgCj4+ICAJCWRy
bV9jcnRjX3ZibGFua19yZXNldCgmY3J0Yy0+YmFzZSk7Cj4+ICAKPj4gLQkJaWYgKGNydGNfc3Rh
dGUtPmJhc2UuYWN0aXZlKQo+PiArCQlpZiAoY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+PiAgCQkJ
aW50ZWxfY3J0Y192Ymxhbmtfb24oY3J0Y19zdGF0ZSk7Cj4+ICAJfQo+PiAgCj4+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCj4+IGlu
ZGV4IGQ1Y2M0YjgxMGQ5ZS4uMmMzNTY3MDgxZTE2IDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAo+PiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAo+PiBAQCAtNzQ5LDcg
Kzc0OSwzMSBAQCBlbnVtIGludGVsX291dHB1dF9mb3JtYXQgewo+PiAgfTsKPj4gIAo+PiAgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgewo+PiAtCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSBiYXNlOwo+
PiArCXVuaW9uIHsKPj4gKwkvKgo+PiArCSAqIHVhcGkgKGRybSkgc3RhdGUuIFRoaXMgaXMgdGhl
IHNvZnR3YXJlIHN0YXRlIHNob3duIHRvIHVzZXJzcGFjZS4KPj4gKwkgKiBJbiBwYXJ0aWN1bGFy
LCB0aGUgZm9sbG93aW5nIG1lbWJlcnMgYXJlIHVzZWQgZm9yIGJvb2trZWVwaW5nOgo+PiArCSAq
IC0gY3J0Ywo+PiArCSAqIC0gc3RhdGUKPj4gKwkgKiAtICpfY2hhbmdlZAo+PiArCSAqIC0gZXZl
bnQKPj4gKwkgKiAtIGNvbW1pdAo+PiArCSAqIC0gbW9kZV9ibG9iCj4+ICsJICovCj4+ICsJc3Ry
dWN0IGRybV9jcnRjX3N0YXRlIHVhcGk7Cj4+ICsKPj4gKwkvKgo+PiArCSAqIGFjdHVhbCBoYXJk
d2FyZSBzdGF0ZSwgdGhlIHN0YXRlIHdlIHByb2dyYW0gdG8gdGhlIGhhcmR3YXJlLgo+PiArCSAq
IFRoZSBmb2xsb3dpbmcgbWVtYmVycyBhcmUgdXNlZCB0byB2ZXJpZnkgdGhlIGhhcmR3YXJlIHN0
YXRlOgo+PiArCSAqIC0gZW5hYmxlCj4+ICsJICogLSBhY3RpdmUKPj4gKwkgKiAtIG1vZGUgLyBh
ZGp1c3RlZF9tb2RlCj4+ICsJICogLSBjb2xvciBwcm9wZXJ0eSBibG9icy4KPj4gKwkgKgo+PiAr
CSAqIER1cmluZyBpbml0aWFsIGh3IHJlYWRvdXQsIHRoZXkgbmVlZCB0byBiZSBjb3BpZWQgdG8g
dWFwaS4KPj4gKwkgKi8KPj4gKwlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgaHc7Cj4+ICsJfTsKPj4g
IAo+PiAgCS8qKgo+PiAgCSAqIHF1aXJrcyAtIGJpdGZpZWxkIHdpdGggaHcgc3RhdGUgcmVhZG91
dCBxdWlya3MKPj4gQEAgLTEwOTEsNyArMTExNSw3IEBAIHN0cnVjdCBjeHNyX2xhdGVuY3kgewo+
PiAgCj4+ICAjZGVmaW5lIHRvX2ludGVsX2F0b21pY19zdGF0ZSh4KSBjb250YWluZXJfb2YoeCwg
c3RydWN0IGludGVsX2F0b21pY19zdGF0ZSwgYmFzZSkKPj4gICNkZWZpbmUgdG9faW50ZWxfY3J0
Yyh4KSBjb250YWluZXJfb2YoeCwgc3RydWN0IGludGVsX2NydGMsIGJhc2UpCj4+IC0jZGVmaW5l
IHRvX2ludGVsX2NydGNfc3RhdGUoeCkgY29udGFpbmVyX29mKHgsIHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlLCBiYXNlKQo+PiArI2RlZmluZSB0b19pbnRlbF9jcnRjX3N0YXRlKHgpIGNvbnRhaW5l
cl9vZih4LCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSwgdWFwaSkKPj4gICNkZWZpbmUgdG9faW50
ZWxfY29ubmVjdG9yKHgpIGNvbnRhaW5lcl9vZih4LCBzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yLCBi
YXNlKQo+PiAgI2RlZmluZSB0b19pbnRlbF9lbmNvZGVyKHgpIGNvbnRhaW5lcl9vZih4LCBzdHJ1
Y3QgaW50ZWxfZW5jb2RlciwgYmFzZSkKPj4gICNkZWZpbmUgdG9faW50ZWxfZnJhbWVidWZmZXIo
eCkgY29udGFpbmVyX29mKHgsIHN0cnVjdCBpbnRlbF9mcmFtZWJ1ZmZlciwgYmFzZSkKPj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYwo+PiBpbmRleCAwMjI0MmExNjY0MGIu
LjJmY2ViNzFmN2Y3MCAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kcC5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZHAuYwo+PiBAQCAtMTk2Niw3ICsxOTY2LDcgQEAgaW50ZWxfZHBfY29tcHV0ZV9saW5rX2NvbmZp
Z193aWRlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4+ICAJCQkJICBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4+ICAJCQkJICBjb25zdCBzdHJ1Y3QgbGlua19jb25m
aWdfbGltaXRzICpsaW1pdHMpCj4+ICB7Cj4+IC0Jc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFk
anVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwlzdHJ1
Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcuYWRq
dXN0ZWRfbW9kZTsKPj4gIAlpbnQgYnBwLCBjbG9jaywgbGFuZV9jb3VudDsKPj4gIAlpbnQgbW9k
ZV9yYXRlLCBsaW5rX2Nsb2NrLCBsaW5rX2F2YWlsOwo+PiAgCj4+IEBAIC0yMDIwLDcgKzIwMjAs
NyBAQCBzdGF0aWMgaW50IGludGVsX2RwX2RzY19jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxf
ZHAgKmludGVsX2RwLAo+PiAgewo+PiAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19w
b3J0ID0gZHBfdG9fZGlnX3BvcnQoaW50ZWxfZHApOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwo+PiAtCXN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5iYXNl
LmFkanVzdGVkX21vZGU7Cj4+ICsJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21v
ZGUgPSAmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJdTggZHNjX21heF9icGM7
Cj4+ICAJaW50IHBpcGVfYnBwOwo+PiAgCWludCByZXQ7Cj4+IEBAIC0yMTMxLDcgKzIxMzEsNyBA
QCBpbnRlbF9kcF9jb21wdXRlX2xpbmtfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAo+PiAgCQkJICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4+
ICAJCQkgICAgIHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+PiAgewo+
PiAtCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmln
LT5iYXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVz
dGVkX21vZGUgPSAmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCA9IGVuY190b19pbnRlbF9kcCgmZW5jb2Rlci0+YmFzZSk7Cj4+ICAJ
c3RydWN0IGxpbmtfY29uZmlnX2xpbWl0cyBsaW1pdHM7Cj4+ICAJaW50IGNvbW1vbl9sZW47Cj4+
IEBAIC0yMjE5LDggKzIyMTksOCBAQCBpbnRlbF9kcF95Y2JjcjQyMF9jb25maWcoc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCwKPj4gIHsKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfaW5m
byAqaW5mbyA9ICZjb25uZWN0b3ItPmRpc3BsYXlfaW5mbzsKPj4gIAljb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4+IC0JCSZjcnRjX3N0YXRlLT5iYXNlLmFk
anVzdGVkX21vZGU7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJCSZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9t
b2RlOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0
YXRlLT51YXBpLmNydGMpOwo+PiAgCWludCByZXQ7Cj4+ICAKPj4gIAlpZiAoIWRybV9tb2RlX2lz
XzQyMF9vbmx5KGluZm8sIGFkanVzdGVkX21vZGUpIHx8Cj4+IEBAIC0yMjQ4LDcgKzIyNDgsNyBA
QCBib29sIGludGVsX2RwX2xpbWl0ZWRfY29sb3JfcmFuZ2UoY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJY29uc3Qgc3RydWN0IGludGVsX2RpZ2l0YWxfY29u
bmVjdG9yX3N0YXRlICppbnRlbF9jb25uX3N0YXRlID0KPj4gIAkJdG9faW50ZWxfZGlnaXRhbF9j
b25uZWN0b3Jfc3RhdGUoY29ubl9zdGF0ZSk7Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5
X21vZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9t
b2RlOwo+PiArCQkmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAo+PiAgCWlmIChp
bnRlbF9jb25uX3N0YXRlLT5icm9hZGNhc3RfcmdiID09IElOVEVMX0JST0FEQ0FTVF9SR0JfQVVU
Tykgewo+PiAgCQkvKgo+PiBAQCAtMjI3MSwxMSArMjI3MSwxMSBAQCBpbnRlbF9kcF9jb21wdXRl
X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAkJCXN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQo+PiAgewo+PiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+PiAtCXN0cnVj
dCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5iYXNlLmFk
anVzdGVkX21vZGU7Cj4+ICsJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUg
PSAmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJc3RydWN0IGludGVsX2RwICpp
bnRlbF9kcCA9IGVuY190b19pbnRlbF9kcCgmZW5jb2Rlci0+YmFzZSk7Cj4+ICAJc3RydWN0IGlu
dGVsX2xzcGNvbiAqbHNwY29uID0gZW5jX3RvX2ludGVsX2xzcGNvbigmZW5jb2Rlci0+YmFzZSk7
Cj4+ICAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0Owo+PiAtCXN0cnVjdCBpbnRlbF9j
cnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsK
Pj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9j
b25maWctPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxfY29u
bmVjdG9yID0gaW50ZWxfZHAtPmF0dGFjaGVkX2Nvbm5lY3RvcjsKPj4gIAlzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9jb25uZWN0b3Jfc3RhdGUgKmludGVsX2Nvbm5fc3RhdGUgPQo+PiAgCQl0b19pbnRl
bF9kaWdpdGFsX2Nvbm5lY3Rvcl9zdGF0ZShjb25uX3N0YXRlKTsKPj4gQEAgLTIzOTUsOCArMjM5
NSw4IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShlbmNvZGVyLT5iYXNlLmRldik7Cj4+ICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGVu
Y190b19pbnRlbF9kcCgmZW5jb2Rlci0+YmFzZSk7Cj4+ICAJZW51bSBwb3J0IHBvcnQgPSBlbmNv
ZGVyLT5wb3J0Owo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhw
aXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPj4gLQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9k
ZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiAr
CXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+dWFw
aS5jcnRjKTsKPj4gKwljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9k
ZSA9ICZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAo+PiAgCWludGVsX2RwX3Nl
dF9saW5rX3BhcmFtcyhpbnRlbF9kcCwgcGlwZV9jb25maWctPnBvcnRfY2xvY2ssCj4+ICAJCQkJ
IHBpcGVfY29uZmlnLT5sYW5lX2NvdW50LAo+PiBAQCAtMjk5Myw3ICsyOTkzLDcgQEAgc3RhdGlj
IHZvaWQgYXNzZXJ0X2VkcF9wbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBi
b29sIHN0YXRlKQo+PiAgc3RhdGljIHZvaWQgaXJvbmxha2VfZWRwX3BsbF9vbihzdHJ1Y3QgaW50
ZWxfZHAgKmludGVsX2RwLAo+PiAgCQkJCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpw
aXBlX2NvbmZpZykKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+PiAgCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAg
Cj4+ICAJYXNzZXJ0X3BpcGVfZGlzYWJsZWQoZGV2X3ByaXYsIGNydGMtPnBpcGUpOwo+PiBAQCAt
MzAzMyw3ICszMDMzLDcgQEAgc3RhdGljIHZvaWQgaXJvbmxha2VfZWRwX3BsbF9vbihzdHJ1Y3Qg
aW50ZWxfZHAgKmludGVsX2RwLAo+PiAgc3RhdGljIHZvaWQgaXJvbmxha2VfZWRwX3BsbF9vZmYo
c3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPj4gIAkJCQkgY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPnVhcGku
Y3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShj
cnRjLT5iYXNlLmRldik7Cj4+ICAKPj4gIAlhc3NlcnRfcGlwZV9kaXNhYmxlZChkZXZfcHJpdiwg
Y3J0Yy0+cGlwZSk7Cj4+IEBAIC0zMTkzLDcgKzMxOTMsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9k
cF9nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCXN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2UpOwo+PiAg
CXUzMiB0bXAsIGZsYWdzID0gMDsKPj4gIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7
Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmln
LT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhwaXBlX2NvbmZpZy0+dWFwaS5jcnRjKTsKPj4gIAo+PiAgCWlmIChlbmNvZGVyLT50eXBlID09
IElOVEVMX09VVFBVVF9FRFApCj4+ICAJCXBpcGVfY29uZmlnLT5vdXRwdXRfdHlwZXMgfD0gQklU
KElOVEVMX09VVFBVVF9FRFApOwo+PiBAQCAtMzIyOCw3ICszMjI4LDcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfZHBfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAkJ
CWZsYWdzIHw9IERSTV9NT0RFX0ZMQUdfTlZTWU5DOwo+PiAgCX0KPj4gIAo+PiAtCXBpcGVfY29u
ZmlnLT5iYXNlLmFkanVzdGVkX21vZGUuZmxhZ3MgfD0gZmxhZ3M7Cj4+ICsJcGlwZV9jb25maWct
Pmh3LmFkanVzdGVkX21vZGUuZmxhZ3MgfD0gZmxhZ3M7Cj4+ICAKPj4gIAlpZiAoSVNfRzRYKGRl
dl9wcml2KSAmJiB0bXAgJiBEUF9DT0xPUl9SQU5HRV8xNl8yMzUpCj4+ICAJCXBpcGVfY29uZmln
LT5saW1pdGVkX2NvbG9yX3JhbmdlID0gdHJ1ZTsKPj4gQEAgLTMyNDUsNyArMzI0NSw3IEBAIHN0
YXRpYyB2b2lkIGludGVsX2RwX2dldF9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCj4+ICAJCQlwaXBlX2NvbmZpZy0+cG9ydF9jbG9jayA9IDI3MDAwMDsKPj4gIAl9Cj4+ICAK
Pj4gLQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPQo+PiArCXBp
cGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPQo+PiAgCQlpbnRlbF9kb3Rj
bG9ja19jYWxjdWxhdGUocGlwZV9jb25maWctPnBvcnRfY2xvY2ssCj4+ICAJCQkJCSAmcGlwZV9j
b25maWctPmRwX21fbik7Cj4+ICAKPj4gQEAgLTM0NjAsNyArMzQ2MCw3IEBAIHN0YXRpYyB2b2lk
IGludGVsX2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIHsKPj4g
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPj4gIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2Rw
KCZlbmNvZGVyLT5iYXNlKTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+PiAgCXUzMiBkcF9y
ZWcgPSBJOTE1X1JFQUQoaW50ZWxfZHAtPm91dHB1dF9yZWcpOwo+PiAgCWVudW0gcGlwZSBwaXBl
ID0gY3J0Yy0+cGlwZTsKPj4gIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKPj4gQEAgLTM1OTMs
NyArMzU5Myw3IEBAIHN0YXRpYyB2b2lkIHZsdl9pbml0X3BhbmVsX3Bvd2VyX3NlcXVlbmNlcihz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gIAlzdHJ1
Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsK
Pj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+
YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAo+PiAgCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRl
dl9wcml2LT5wcHNfbXV0ZXgpOwo+PiAgCj4+IEBAIC00MTE1LDcgKzQxMTUsNyBAQCBpbnRlbF9k
cF9saW5rX2Rvd24oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICB7Cj4+ICAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRl
dik7Cj4+ICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGVuY190b19pbnRlbF9kcCgmZW5j
b2Rlci0+YmFzZSk7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KG9sZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAllbnVtIHBv
cnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7Cj4+ICAJdTMyIERQID0gaW50ZWxfZHAtPkRQOwo+PiAg
Cj4+IEBAIC00ODc2LDcgKzQ4NzYsNyBAQCBpbnQgaW50ZWxfZHBfcmV0cmFpbl9saW5rKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCj4+ICAJV0FSTl9PTighaW50ZWxfY3J0Y19o
YXNfZHBfZW5jb2RlcihjcnRjX3N0YXRlKSk7Cj4+ICAKPj4gLQlpZiAoIWNydGNfc3RhdGUtPmJh
c2UuYWN0aXZlKQo+PiArCWlmICghY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+PiAgCQlyZXR1cm4g
MDsKPj4gIAo+PiAgCWlmIChjb25uX3N0YXRlLT5jb21taXQgJiYKPj4gQEAgLTY2OTUsNyArNjY5
NSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3NldF9kcnJzX3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKPj4gIAkJCQkgICAgaW50IHJlZnJlc2hfcmF0ZSkKPj4gIHsK
Pj4gIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gZGV2X3ByaXYtPmRycnMuZHA7Cj4+IC0J
c3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJZW51bSBkcnJzX3JlZnJlc2hfcmF0
ZV90eXBlIGluZGV4ID0gRFJSU19ISUdIX1JSOwo+PiAgCj4+ICAJaWYgKHJlZnJlc2hfcmF0ZSA8
PSAwKSB7Cj4+IEBAIC02NzI4LDcgKzY3MjgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kcF9zZXRf
ZHJyc19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4+ICAJCXJldHVy
bjsKPj4gIAl9Cj4+ICAKPj4gLQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlKSB7Cj4+ICsJ
aWYgKCFjcnRjX3N0YXRlLT5ody5hY3RpdmUpIHsKPj4gIAkJRFJNX0RFQlVHX0tNUygiZURQIGVu
Y29kZXIgZGlzYWJsZWQuIENSVEMgbm90IEFjdGl2ZVxuIik7Cj4+ICAJCXJldHVybjsKPj4gIAl9
Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwX21z
dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9tc3QuYwo+PiBpbmRl
eCBlZWViM2Y5MzNhYTQuLjc2ZjA2NmIxZGZlNSAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9tc3QuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2RwX21zdC5jCj4+IEBAIC00MiwxMyArNDIsMTMgQEAgc3RhdGlj
IGludCBpbnRlbF9kcF9tc3RfY29tcHV0ZV9saW5rX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPj4gIAkJCQkJICAgIHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25u
X3N0YXRlLAo+PiAgCQkJCQkgICAgc3RydWN0IGxpbmtfY29uZmlnX2xpbWl0cyAqbGltaXRzKQo+
PiAgewo+PiAtCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IGNydGNfc3RhdGUtPmJh
c2Uuc3RhdGU7Cj4+ICsJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0
ZS0+dWFwaS5zdGF0ZTsKPj4gIAlzdHJ1Y3QgaW50ZWxfZHBfbXN0X2VuY29kZXIgKmludGVsX21z
dCA9IGVuY190b19tc3QoJmVuY29kZXItPmJhc2UpOwo+PiAgCXN0cnVjdCBpbnRlbF9kcCAqaW50
ZWxfZHAgPSAmaW50ZWxfbXN0LT5wcmltYXJ5LT5kcDsKPj4gIAlzdHJ1Y3QgaW50ZWxfY29ubmVj
dG9yICpjb25uZWN0b3IgPQo+PiAgCQl0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29u
bmVjdG9yKTsKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9k
ZSA9Cj4+IC0JCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJCSZjcnRjX3N0
YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+PiAgCXZvaWQgKnBvcnQgPSBjb25uZWN0b3ItPnBvcnQ7
Cj4+ICAJYm9vbCBjb25zdGFudF9uID0gZHJtX2RwX2hhc19xdWlyaygmaW50ZWxfZHAtPmRlc2Ms
Cj4+ICAJCQkJCSAgIERQX0RQQ0RfUVVJUktfQ09OU1RBTlRfTik7Cj4+IEBAIC05OSw3ICs5OSw3
IEBAIHN0YXRpYyBpbnQgaW50ZWxfZHBfbXN0X2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+PiAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX2Nvbm5lY3Rvcl9zdGF0
ZSAqaW50ZWxfY29ubl9zdGF0ZSA9Cj4+ICAJCXRvX2ludGVsX2RpZ2l0YWxfY29ubmVjdG9yX3N0
YXRlKGNvbm5fc3RhdGUpOwo+PiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1
c3RlZF9tb2RlID0KPj4gLQkJJnBpcGVfY29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJ
CSZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAl2b2lkICpwb3J0ID0gY29ubmVj
dG9yLT5wb3J0Owo+PiAgCXN0cnVjdCBsaW5rX2NvbmZpZ19saW1pdHMgbGltaXRzOwo+PiAgCWlu
dCByZXQ7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RwaW9fcGh5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwaW9fcGh5
LmMKPj4gaW5kZXggNTU2ZDFiMzBmMDZhLi43MDRmMzg2ODFjNGIgMTAwNjQ0Cj4+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBpb19waHkuYwo+PiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwaW9fcGh5LmMKPj4gQEAgLTczOSw3ICs3
MzksNyBAQCB2b2lkIGNodl9kYXRhX2xhbmVfc29mdF9yZXNldChzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gIAllbnVtIGRwaW9fY2hhbm5lbCBjaCA9
IHZsdl9kcG9ydF90b19jaGFubmVsKGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSkpOwo+
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5i
YXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0Yyhj
cnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsK
Pj4gIAl1MzIgdmFsOwo+PiAgCj4+IEBAIC03ODMsNyArNzgzLDcgQEAgdm9pZCBjaHZfcGh5X3By
ZV9wbGxfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgewo+PiAgCXN0
cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRwb3J0ID0gZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVy
LT5iYXNlKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAllbnVtIGRw
aW9fY2hhbm5lbCBjaCA9IHZsdl9kcG9ydF90b19jaGFubmVsKGRwb3J0KTsKPj4gIAllbnVtIHBp
cGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+ICAJdW5zaWduZWQgaW50IGxhbmVfbWFzayA9Cj4+IEBA
IC04NjQsNyArODY0LDcgQEAgdm9pZCBjaHZfcGh5X3ByZV9lbmNvZGVyX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAlzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwID0g
ZW5jX3RvX2ludGVsX2RwKCZlbmNvZGVyLT5iYXNlKTsKPj4gIAlzdHJ1Y3QgaW50ZWxfZGlnaXRh
bF9wb3J0ICpkcG9ydCA9IGRwX3RvX2RpZ19wb3J0KGludGVsX2RwKTsKPj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4g
LQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAllbnVtIGRwaW9fY2hhbm5lbCBjaCA9IHZsdl9kcG9y
dF90b19jaGFubmVsKGRwb3J0KTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+
ICAJaW50IGRhdGEsIGksIHN0YWdnZXI7Cj4+IEBAIC05NTMsNyArOTUzLDcgQEAgdm9pZCBjaHZf
cGh5X3Bvc3RfcGxsX2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICAJ
CQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUpCj4+
ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7Cj4+IC0JZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKG9sZF9j
cnRjX3N0YXRlLT5iYXNlLmNydGMpLT5waXBlOwo+PiArCWVudW0gcGlwZSBwaXBlID0gdG9faW50
ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKS0+cGlwZTsKPj4gIAl1MzIgdmFsOwo+
PiAgCj4+ICAJdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKPj4gQEAgLTEwMTYsNyArMTAxNiw3IEBA
IHZvaWQgdmx2X3BoeV9wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPj4gIHsKPj4gIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkcG9ydCA9IGVuY190b19k
aWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+IC0Jc3RydWN0IGludGVsX2Ny
dGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0
Yyk7Cj4+ICAJZW51bSBkcGlvX2NoYW5uZWwgcG9ydCA9IHZsdl9kcG9ydF90b19jaGFubmVsKGRw
b3J0KTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+ICAKPj4gQEAgLTEwNDYs
NyArMTA0Niw3IEBAIHZvaWQgdmx2X3BoeV9wcmVfZW5jb2Rlcl9lbmFibGUoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCj4+ICAJc3RydWN0IGludGVsX2RwICppbnRlbF9kcCA9IGVuY190
b19pbnRlbF9kcCgmZW5jb2Rlci0+YmFzZSk7Cj4+ICAJc3RydWN0IGludGVsX2RpZ2l0YWxfcG9y
dCAqZHBvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+IC0Jc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3Rh
dGUtPnVhcGkuY3J0Yyk7Cj4+ICAJZW51bSBkcGlvX2NoYW5uZWwgcG9ydCA9IHZsdl9kcG9ydF90
b19jaGFubmVsKGRwb3J0KTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+ICAJ
dTMyIHZhbDsKPj4gQEAgLTEwNzUsNyArMTA3NSw3IEBAIHZvaWQgdmx2X3BoeV9yZXNldF9sYW5l
cyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIHsKPj4gIAlzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9wb3J0ICpkcG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4+
ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9s
ZF9jcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAllbnVtIGRwaW9f
Y2hhbm5lbCBwb3J0ID0gdmx2X2Rwb3J0X3RvX2NoYW5uZWwoZHBvcnQpOwo+PiAgCWVudW0gcGlw
ZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gIAo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kcGxsX21nci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kcGxsX21nci5jCj4+IGluZGV4IDk4Mjg4ZWRmODhmMC4uNDNjMTJiY2ZlM2Iy
IDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwbGxf
bWdyLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcGxsX21n
ci5jCj4+IEBAIC0xMzYsNyArMTM2LDcgQEAgdm9pZCBhc3NlcnRfc2hhcmVkX2RwbGwoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+PiAgICovCj4+ICB2b2lkIGludGVsX3ByZXBh
cmVfc2hhcmVkX2RwbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUp
Cj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJc3RydWN0IGludGVs
X3NoYXJlZF9kcGxsICpwbGwgPSBjcnRjX3N0YXRlLT5zaGFyZWRfZHBsbDsKPj4gIAo+PiBAQCAt
MTYzLDcgKzE2Myw3IEBAIHZvaWQgaW50ZWxfcHJlcGFyZV9zaGFyZWRfZHBsbChjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gICAqLwo+PiAgdm9pZCBpbnRlbF9l
bmFibGVfc2hhcmVkX2RwbGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNy
dGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19p
bnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJc3RydWN0IGlu
dGVsX3NoYXJlZF9kcGxsICpwbGwgPSBjcnRjX3N0YXRlLT5zaGFyZWRfZHBsbDsKPj4gIAl1bnNp
Z25lZCBpbnQgY3J0Y19tYXNrID0gZHJtX2NydGNfbWFzaygmY3J0Yy0+YmFzZSk7Cj4+IEBAIC0y
MDgsNyArMjA4LDcgQEAgdm9pZCBpbnRlbF9lbmFibGVfc2hhcmVkX2RwbGwoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICAgKi8KPj4gIHZvaWQgaW50ZWxfZGlz
YWJsZV9zaGFyZWRfZHBsbChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGMtPmJhc2UuZGV2KTsKPj4gIAlzdHJ1Y3QgaW50
ZWxfc2hhcmVkX2RwbGwgKnBsbCA9IGNydGNfc3RhdGUtPnNoYXJlZF9kcGxsOwo+PiAgCXVuc2ln
bmVkIGludCBjcnRjX21hc2sgPSBkcm1fY3J0Y19tYXNrKCZjcnRjLT5iYXNlKTsKPj4gQEAgLTgy
NSw3ICs4MjUsNyBAQCBoc3dfZGRpX2hkbWlfZ2V0X2RwbGwoc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUsCj4+ICBzdGF0aWMgc3RydWN0IGludGVsX3NoYXJlZF9kcGxsICoKPj4gIGhz
d19kZGlfZHBfZ2V0X2RwbGwoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+
ICB7Cj4+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
X3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4+ICAJc3RydWN0
IGludGVsX3NoYXJlZF9kcGxsICpwbGw7Cj4+ICAJZW51bSBpbnRlbF9kcGxsX2lkIHBsbF9pZDsK
Pj4gIAlpbnQgY2xvY2sgPSBjcnRjX3N0YXRlLT5wb3J0X2Nsb2NrOwo+PiBAQCAtMTczNCw3ICsx
NzM0LDcgQEAgc3RhdGljIGJvb2wKPj4gIGJ4dF9kZGlfaGRtaV9wbGxfZGl2aWRlcnMoc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCQkgIHN0cnVjdCBieHRfY2xrX2Rp
diAqY2xrX2RpdikKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgZHBs
bCBiZXN0X2Nsb2NrOwo+PiAgCj4+ICAJLyogQ2FsY3VsYXRlIEhETUkgZGl2ICovCj4+IEBAIC0y
MjU3LDcgKzIyNTcsNyBAQCBzdGF0aWMgYm9vbAo+PiAgY25sX2RkaV9jYWxjdWxhdGVfd3JwbGwo
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCQlzdHJ1Y3Qgc2tsX3dy
cGxsX3BhcmFtcyAqd3JwbGxfcGFyYW1zKQo+PiAgewo+PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+PiAr
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+
dWFwaS5jcnRjLT5kZXYpOwo+PiAgCXUzMiBhZmVfY2xvY2sgPSBjcnRjX3N0YXRlLT5wb3J0X2Ns
b2NrICogNTsKPj4gIAl1MzIgcmVmX2Nsb2NrOwo+PiAgCXUzMiBkY29fbWluID0gNzk5ODAwMDsK
Pj4gQEAgLTI1MjMsNyArMjUyMyw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc2tsX3dycGxsX3Bh
cmFtcyBpY2xfdGJ0X3BsbF8xOV8yTUh6X3ZhbHVlcyA9IHsKPj4gIHN0YXRpYyBib29sIGljbF9j
YWxjX2RwX2NvbWJvX3BsbChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4g
IAkJCQkgIHN0cnVjdCBza2xfd3JwbGxfcGFyYW1zICpwbGxfcGFyYW1zKQo+PiAgewo+PiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFz
ZS5jcnRjLT5kZXYpOwo+PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+PiAgCWNvbnN0IHN0cnVjdCBpY2xf
Y29tYm9fcGxsX3BhcmFtcyAqcGFyYW1zID0KPj4gIAkJZGV2X3ByaXYtPmNkY2xrLmh3LnJlZiA9
PSAyNDAwMCA/Cj4+ICAJCWljbF9kcF9jb21ib19wbGxfMjRNSHpfdmFsdWVzIDoKPj4gQEAgLTI1
NDUsNyArMjU0NSw3IEBAIHN0YXRpYyBib29sIGljbF9jYWxjX2RwX2NvbWJvX3BsbChzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIHN0YXRpYyBib29sIGljbF9jYWxjX3Ri
dF9wbGwoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCQkgICAgIHN0
cnVjdCBza2xfd3JwbGxfcGFyYW1zICpwbGxfcGFyYW1zKQo+PiAgewo+PiAtCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5k
ZXYpOwo+PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+PiAgCj4+ICAJKnBsbF9wYXJhbXMgPSBkZXZfcHJp
di0+Y2RjbGsuaHcucmVmID09IDI0MDAwID8KPj4gIAkJCWljbF90YnRfcGxsXzI0TUh6X3ZhbHVl
cyA6IGljbF90YnRfcGxsXzE5XzJNSHpfdmFsdWVzOwo+PiBAQCAtMjU1Niw3ICsyNTU2LDcgQEAg
c3RhdGljIGJvb2wgaWNsX2NhbGNfZHBsbF9zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPj4gIAkJCQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAkJ
CQlzdHJ1Y3QgaW50ZWxfZHBsbF9od19zdGF0ZSAqcGxsX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjLT5kZXYpOwo+PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+PiAgCXUzMiBjZmdjcjAsIGNmZ2NyMTsK
Pj4gIAlzdHJ1Y3Qgc2tsX3dycGxsX3BhcmFtcyBwbGxfcGFyYW1zID0geyAwIH07Cj4+ICAJYm9v
bCByZXQ7Cj4+IEBAIC0yNjgyLDcgKzI2ODIsNyBAQCBzdGF0aWMgYm9vbCBpY2xfbWdfcGxsX2Zp
bmRfZGl2aXNvcnMoaW50IGNsb2NrX2toeiwgYm9vbCBpc19kcCwgYm9vbCB1c2Vfc3NjLAo+PiAg
c3RhdGljIGJvb2wgaWNsX2NhbGNfbWdfcGxsX3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAo+PiAgCQkJCSAgc3RydWN0IGludGVsX2RwbGxfaHdfc3RhdGUgKnBsbF9z
dGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPj4g
IAlpbnQgcmVmY2xrX2toeiA9IGRldl9wcml2LT5jZGNsay5ody5yZWY7Cj4+ICAJaW50IGNsb2Nr
ID0gY3J0Y19zdGF0ZS0+cG9ydF9jbG9jazsKPj4gIAl1MzIgZGNvX2toeiwgbTFkaXYsIG0yZGl2
X2ludCwgbTJkaXZfcmVtLCBtMmRpdl9mcmFjOwo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kdm8uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZHZvLmMKPj4gaW5kZXggMzQxOTNkMDQ1OTdhLi5hZjAxNDllMzJiZjQgMTAwNjQ0
Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHZvLmMKPj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kdm8uYwo+PiBAQCAtMTc4LDkg
KzE3OCw5IEBAIHN0YXRpYyB2b2lkIGludGVsX2R2b19nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+PiAgCWVsc2UKPj4gIAkJZmxhZ3MgfD0gRFJNX01PREVfRkxBR19O
VlNZTkM7Cj4+ICAKPj4gLQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9
IGZsYWdzOwo+PiArCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IGZsYWdz
Owo+PiAgCj4+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrID0g
cGlwZV9jb25maWctPnBvcnRfY2xvY2s7Cj4+ICsJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21v
ZGUuY3J0Y19jbG9jayA9IHBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrOwo+PiAgfQo+PiAgCj4+ICBz
dGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX2R2byhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKPj4gQEAgLTIwNyw4ICsyMDcsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfZHZvKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCXUzMiB0ZW1wID0gSTkxNV9SRUFEKGR2
b19yZWcpOwo+PiAgCj4+ICAJaW50ZWxfZHZvLT5kZXYuZGV2X29wcy0+bW9kZV9zZXQoJmludGVs
X2R2by0+ZGV2LAo+PiAtCQkJCQkgJnBpcGVfY29uZmlnLT5iYXNlLm1vZGUsCj4+IC0JCQkJCSAm
cGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZSk7Cj4+ICsJCQkJCSAmcGlwZV9jb25maWct
Pmh3Lm1vZGUsCj4+ICsJCQkJCSAmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUpOwo+PiAg
Cj4+ICAJSTkxNV9XUklURShkdm9fcmVnLCB0ZW1wIHwgRFZPX0VOQUJMRSk7Cj4+ICAJSTkxNV9S
RUFEKGR2b19yZWcpOwo+PiBAQCAtMjUzLDcgKzI1Myw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfZHZv
X2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCXN0cnVj
dCBpbnRlbF9kdm8gKmludGVsX2R2byA9IGVuY190b19kdm8oZW5jb2Rlcik7Cj4+ICAJY29uc3Qg
c3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGUgPQo+PiAgCQlpbnRlbF9kdm8tPmF0
dGFjaGVkX2Nvbm5lY3Rvci0+cGFuZWwuZml4ZWRfbW9kZTsKPj4gLQlzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2Rl
Owo+PiArCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29u
ZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+PiAgCj4+ICAJLyoKPj4gIAkgKiBJZiB3ZSBoYXZlIHRp
bWluZ3MgZnJvbSB0aGUgQklPUyBmb3IgdGhlIHBhbmVsLCBwdXQgdGhlbSBpbgo+PiBAQCAtMjc3
LDggKzI3Nyw4IEBAIHN0YXRpYyB2b2lkIGludGVsX2R2b19wcmVfZW5hYmxlKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqY29ubl9zdGF0ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4+IC0JY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWct
PmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2lu
dGVsX2NydGMocGlwZV9jb25maWctPnVhcGkuY3J0Yyk7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21v
ZGU7Cj4+ICAJc3RydWN0IGludGVsX2R2byAqaW50ZWxfZHZvID0gZW5jX3RvX2R2byhlbmNvZGVy
KTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+ICAJdTMyIGR2b192YWw7Cj4+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZiYy5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmMuYwo+PiBpbmRleCAzMTExZWNh
ZWFiZDAuLmM2Y2MzNzc1ZjNiOCAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9mYmMuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2ZiYy5jCj4+IEBAIC02NjcsNyArNjY3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZmJj
X3VwZGF0ZV9zdGF0ZV9jYWNoZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPj4gIAljYWNoZS0+
dm1hID0gTlVMTDsKPj4gIAljYWNoZS0+ZmxhZ3MgPSAwOwo+PiAgCj4+IC0JY2FjaGUtPmNydGMu
bW9kZV9mbGFncyA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFnczsKPj4gKwlj
YWNoZS0+Y3J0Yy5tb2RlX2ZsYWdzID0gY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFn
czsKPj4gIAlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2
KSkKPj4gIAkJY2FjaGUtPmNydGMuaHN3X2Jkd19waXhlbF9yYXRlID0gY3J0Y19zdGF0ZS0+cGl4
ZWxfcmF0ZTsKPj4gIAo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9oZG1pLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWku
Ywo+PiBpbmRleCAxNGUzNTBmNWVjYzguLmUxZGJmNjQxYmU3OSAxMDA2NDQKPj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZG1pLmMKPj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZG1pLmMKPj4gQEAgLTI3OSw3ICsyNzksNyBAQCBz
dGF0aWMgdm9pZCBpYnhfd3JpdGVfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAo+PiAgewo+PiAgCWNvbnN0IHUzMiAqZGF0YSA9IGZyYW1lOwo+PiAgCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+PiAt
CXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCWk5MTVfcmVnX3QgcmVnID0gVFZJ
REVPX0RJUF9DVEwoaW50ZWxfY3J0Yy0+cGlwZSk7Cj4+ICAJdTMyIHZhbCA9IEk5MTVfUkVBRChy
ZWcpOwo+PiAgCWludCBpOwo+PiBAQCAtMzE1LDcgKzMxNSw3IEBAIHN0YXRpYyB2b2lkIGlieF9y
ZWFkX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAkJCSAgICAg
ICB2b2lkICpmcmFtZSwgc3NpemVfdCBsZW4pCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+IC0Jc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PnVhcGkuY3J0Yyk7Cj4+ICAJdTMyIHZhbCwgKmRhdGEgPSBmcmFtZTsKPj4gIAlpbnQgaTsKPj4g
IAo+PiBAQCAtMzM0LDcgKzMzNCw3IEBAIHN0YXRpYyB1MzIgaWJ4X2luZm9mcmFtZXNfZW5hYmxl
ZChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAkJCQkgIGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZykKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gLQllbnVt
IHBpcGUgcGlwZSA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0YyktPnBpcGU7
Cj4+ICsJZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNy
dGMpLT5waXBlOwo+PiAgCWk5MTVfcmVnX3QgcmVnID0gVFZJREVPX0RJUF9DVEwocGlwZSk7Cj4+
ICAJdTMyIHZhbCA9IEk5MTVfUkVBRChyZWcpOwo+PiAgCj4+IEBAIC0zNTYsNyArMzU2LDcgQEAg
c3RhdGljIHZvaWQgY3B0X3dyaXRlX2luZm9mcmFtZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKPj4gIHsKPj4gIAljb25zdCB1MzIgKmRhdGEgPSBmcmFtZTsKPj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4g
LQlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlpOTE1X3JlZ190IHJlZyA9IFRW
SURFT19ESVBfQ1RMKGludGVsX2NydGMtPnBpcGUpOwo+PiAgCXUzMiB2YWwgPSBJOTE1X1JFQUQo
cmVnKTsKPj4gIAlpbnQgaTsKPj4gQEAgLTM5NSw3ICszOTUsNyBAQCBzdGF0aWMgdm9pZCBjcHRf
cmVhZF9pbmZvZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICAJCQkgICAg
ICAgdm9pZCAqZnJhbWUsIHNzaXplX3QgbGVuKQo+PiAgewo+PiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+PiAtCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT51YXBpLmNydGMpOwo+PiAgCXUzMiB2YWwsICpkYXRhID0gZnJhbWU7Cj4+ICAJaW50IGk7Cj4+
ICAKPj4gQEAgLTQxNCw3ICs0MTQsNyBAQCBzdGF0aWMgdTMyIGNwdF9pbmZvZnJhbWVzX2VuYWJs
ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICAJCQkJICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+IC0JZW51
bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpLT5waXBl
Owo+PiArCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+dWFwaS5j
cnRjKS0+cGlwZTsKPj4gIAl1MzIgdmFsID0gSTkxNV9SRUFEKFRWSURFT19ESVBfQ1RMKHBpcGUp
KTsKPj4gIAo+PiAgCWlmICgodmFsICYgVklERU9fRElQX0VOQUJMRSkgPT0gMCkKPj4gQEAgLTQz
Miw3ICs0MzIsNyBAQCBzdGF0aWMgdm9pZCB2bHZfd3JpdGVfaW5mb2ZyYW1lKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+PiAgewo+PiAgCWNvbnN0IHUzMiAqZGF0YSA9IGZyYW1lOwo+
PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+
YmFzZS5kZXYpOwo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxf
Y3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICppbnRl
bF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCWk5MTVf
cmVnX3QgcmVnID0gVkxWX1RWSURFT19ESVBfQ1RMKGludGVsX2NydGMtPnBpcGUpOwo+PiAgCXUz
MiB2YWwgPSBJOTE1X1JFQUQocmVnKTsKPj4gIAlpbnQgaTsKPj4gQEAgLTQ2OCw3ICs0NjgsNyBA
QCBzdGF0aWMgdm9pZCB2bHZfcmVhZF9pbmZvZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCj4+ICAJCQkgICAgICAgdm9pZCAqZnJhbWUsIHNzaXplX3QgbGVuKQo+PiAgewo+PiAg
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFz
ZS5kZXYpOwo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRj
X3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50
ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXUzMiB2YWwsICpkYXRhID0gZnJh
bWU7Cj4+ICAJaW50IGk7Cj4+ICAKPj4gQEAgLTQ4Nyw3ICs0ODcsNyBAQCBzdGF0aWMgdTMyIHZs
dl9pbmZvZnJhbWVzX2VuYWJsZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICAJ
CQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcpCj4+ICB7Cj4+
ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5i
YXNlLmRldik7Cj4+IC0JZW51bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmln
LT5iYXNlLmNydGMpLT5waXBlOwo+PiArCWVudW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0Yyhw
aXBlX2NvbmZpZy0+dWFwaS5jcnRjKS0+cGlwZTsKPj4gIAl1MzIgdmFsID0gSTkxNV9SRUFEKFZM
Vl9UVklERU9fRElQX0NUTChwaXBlKSk7Cj4+ICAKPj4gIAlpZiAoKHZhbCAmIFZJREVPX0RJUF9F
TkFCTEUpID09IDApCj4+IEBAIC03MDAsNyArNzAwLDcgQEAgaW50ZWxfaGRtaV9jb21wdXRlX2F2
aV9pbmZvZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICB7Cj4+ICAJc3Ry
dWN0IGhkbWlfYXZpX2luZm9mcmFtZSAqZnJhbWUgPSAmY3J0Y19zdGF0ZS0+aW5mb2ZyYW1lcy5h
dmkuYXZpOwo+PiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2Rl
ID0KPj4gLQkJJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwkJJmNydGNfc3Rh
dGUtPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rv
ciA9IGNvbm5fc3RhdGUtPmNvbm5lY3RvcjsKPj4gIAlpbnQgcmV0Owo+PiAgCj4+IEBAIC03ODcs
NyArNzg3LDcgQEAgaW50ZWxfaGRtaV9jb21wdXRlX2hkbWlfaW5mb2ZyYW1lKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCj4+ICAJcmV0ID0gZHJtX2hkbWlfdmVuZG9yX2luZm9m
cmFtZV9mcm9tX2Rpc3BsYXlfbW9kZShmcmFtZSwKPj4gIAkJCQkJCQkgIGNvbm5fc3RhdGUtPmNv
bm5lY3RvciwKPj4gLQkJCQkJCQkgICZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUpOwo+
PiArCQkJCQkJCSAgJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGUpOwo+PiAgCWlmIChXQVJO
X09OKHJldCkpCj4+ICAJCXJldHVybiBmYWxzZTsKPj4gIAo+PiBAQCAtOTQ4LDcgKzk0OCw3IEBA
IHN0YXRpYyBib29sIGludGVsX2hkbWlfc2V0X2djcF9pbmZvZnJhbWUoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCj4+ICAJCQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0
ZSAqY29ubl9zdGF0ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAq
Y3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsK
Pj4gIAlpOTE1X3JlZ190IHJlZzsKPj4gIAo+PiAgCWlmICgoY3J0Y19zdGF0ZS0+aW5mb2ZyYW1l
cy5lbmFibGUgJgo+PiBAQCAtOTczLDcgKzk3Myw3IEBAIHZvaWQgaW50ZWxfaGRtaV9yZWFkX2dj
cF9pbmZvZnJhbWUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICAJCQkJICAgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+IC0J
c3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2Uu
Y3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJaTkxNV9yZWdfdCByZWc7Cj4+ICAKPj4gIAlpZiAoKGNy
dGNfc3RhdGUtPmluZm9mcmFtZXMuZW5hYmxlICYKPj4gQEAgLTEwMTAsNyArMTAxMCw3IEBAIHN0
YXRpYyB2b2lkIGludGVsX2hkbWlfY29tcHV0ZV9nY3BfaW5mb2ZyYW1lKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+PiAgCj4+ICAJLyogRW5hYmxlIGRlZmF1bHRfcGhhc2Ugd2hlbmV2
ZXIgdGhlIGRpc3BsYXkgbW9kZSBpcyBzdWl0YWJseSBhbGlnbmVkICovCj4+ICAJaWYgKGdjcF9k
ZWZhdWx0X3BoYXNlX3Bvc3NpYmxlKGNydGNfc3RhdGUtPnBpcGVfYnBwLAo+PiAtCQkJCSAgICAg
ICAmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlKSkKPj4gKwkJCQkgICAgICAgJmNydGNf
c3RhdGUtPmh3LmFkanVzdGVkX21vZGUpKQo+PiAgCQljcnRjX3N0YXRlLT5pbmZvZnJhbWVzLmdj
cCB8PSBHQ1BfREVGQVVMVF9QSEFTRV9FTkFCTEU7Cj4+ICB9Cj4+ICAKPj4gQEAgLTEwMjAsNyAr
MTAyMCw3IEBAIHN0YXRpYyB2b2lkIGlieF9zZXRfaW5mb2ZyYW1lcyhzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPj4gIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqY29ubl9zdGF0ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0
YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4g
KwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdf
cG9ydCA9IGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSk7Cj4+ICAJc3RydWN0IGludGVs
X2hkbWkgKmludGVsX2hkbWkgPSAmaW50ZWxfZGlnX3BvcnQtPmhkbWk7Cj4+ICAJaTkxNV9yZWdf
dCByZWcgPSBUVklERU9fRElQX0NUTChpbnRlbF9jcnRjLT5waXBlKTsKPj4gQEAgLTEwNzksNyAr
MTA3OSw3IEBAIHN0YXRpYyB2b2lkIGNwdF9zZXRfaW5mb2ZyYW1lcyhzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKPj4gIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqY29ubl9zdGF0ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0
YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4g
KwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9IGVuY190
b19pbnRlbF9oZG1pKCZlbmNvZGVyLT5iYXNlKTsKPj4gIAlpOTE1X3JlZ190IHJlZyA9IFRWSURF
T19ESVBfQ1RMKGludGVsX2NydGMtPnBpcGUpOwo+PiAgCXUzMiB2YWwgPSBJOTE1X1JFQUQocmVn
KTsKPj4gQEAgLTExMjgsNyArMTEyOCw3IEBAIHN0YXRpYyB2b2lkIHZsdl9zZXRfaW5mb2ZyYW1l
cyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAkJCSAgICAgICBjb25zdCBzdHJ1
Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4g
LQlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2lu
dGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgaW50ZWxfaGRtaSAq
aW50ZWxfaGRtaSA9IGVuY190b19pbnRlbF9oZG1pKCZlbmNvZGVyLT5iYXNlKTsKPj4gIAlpOTE1
X3JlZ190IHJlZyA9IFZMVl9UVklERU9fRElQX0NUTChpbnRlbF9jcnRjLT5waXBlKTsKPj4gIAl1
MzIgdmFsID0gSTkxNV9SRUFEKHJlZyk7Cj4+IEBAIC0xNzI0LDkgKzE3MjQsOSBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9oZG1pX3ByZXBhcmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+
ICB7Cj4+ICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGVuY29kZXItPmJhc2UuZGV2Owo+PiAg
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPj4gLQlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19z
dGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAlzdHJ1Y3QgaW50ZWxfaGRtaSAqaW50ZWxfaGRtaSA9IGVu
Y190b19pbnRlbF9oZG1pKCZlbmNvZGVyLT5iYXNlKTsKPj4gLQljb25zdCBzdHJ1Y3QgZHJtX2Rp
c3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21v
ZGU7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAm
Y3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAl1MzIgaGRtaV92YWw7Cj4+ICAKPj4g
IAlpbnRlbF9kcF9kdWFsX21vZGVfc2V0X3RtZHNfb3V0cHV0KGludGVsX2hkbWksIHRydWUpOwo+
PiBAQCAtMTgxNyw3ICsxODE3LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfaGRtaV9nZXRfY29uZmln
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCSAgICB0bXAgJiBIRE1JX0NPTE9S
X1JBTkdFXzE2XzIzNSkKPj4gIAkJcGlwZV9jb25maWctPmxpbWl0ZWRfY29sb3JfcmFuZ2UgPSB0
cnVlOwo+PiAgCj4+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBm
bGFnczsKPj4gKwlwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBmbGFnczsK
Pj4gIAo+PiAgCWlmICgodG1wICYgU0RWT19DT0xPUl9GT1JNQVRfTUFTSykgPT0gSERNSV9DT0xP
Ul9GT1JNQVRfMTJicGMpCj4+ICAJCWRvdGNsb2NrID0gcGlwZV9jb25maWctPnBvcnRfY2xvY2sg
KiAyIC8gMzsKPj4gQEAgLTE4MjcsNyArMTgyNyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2hkbWlf
Z2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAlpZiAocGlwZV9j
b25maWctPnBpeGVsX211bHRpcGxpZXIpCj4+ICAJCWRvdGNsb2NrIC89IHBpcGVfY29uZmlnLT5w
aXhlbF9tdWx0aXBsaWVyOwo+PiAgCj4+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9k
ZS5jcnRjX2Nsb2NrID0gZG90Y2xvY2s7Cj4+ICsJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21v
ZGUuY3J0Y19jbG9jayA9IGRvdGNsb2NrOwo+PiAgCj4+ICAJcGlwZV9jb25maWctPmxhbmVfY291
bnQgPSA0Owo+PiAgCj4+IEBAIC0xODQ4LDcgKzE4NDgsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9l
bmFibGVfaGRtaV9hdWRpbyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAkJCQkg
ICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+PiAgCQkJCSAg
ICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKPj4gIHsKPj4g
LQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJh
c2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBp
cGVfY29uZmlnLT51YXBpLmNydGMpOwo+PiAgCj4+ICAJV0FSTl9PTighcGlwZV9jb25maWctPmhh
c19oZG1pX3NpbmspOwo+PiAgCURSTV9ERUJVR19EUklWRVIoIkVuYWJsaW5nIEhETUkgYXVkaW8g
b24gcGlwZSAlY1xuIiwKPj4gQEAgLTE5MzQsNyArMTkzNCw3IEBAIHN0YXRpYyB2b2lkIGNwdF9l
bmFibGVfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIHsKPj4gIAlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gZW5jb2Rlci0+YmFzZS5kZXY7Cj4+ICAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+PiAtCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPj4gKwlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPnVhcGku
Y3J0Yyk7Cj4+ICAJc3RydWN0IGludGVsX2hkbWkgKmludGVsX2hkbWkgPSBlbmNfdG9faW50ZWxf
aGRtaSgmZW5jb2Rlci0+YmFzZSk7Cj4+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+
PiAgCXUzMiB0ZW1wOwo+PiBAQCAtMTk5OCw3ICsxOTk4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxf
ZGlzYWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCXN0cnVjdCBp
bnRlbF9oZG1pICppbnRlbF9oZG1pID0gZW5jX3RvX2ludGVsX2hkbWkoJmVuY29kZXItPmJhc2Up
Owo+PiAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmludGVsX2RpZ19wb3J0ID0KPj4gIAkJ
aGRtaV90b19kaWdfcG9ydChpbnRlbF9oZG1pKTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0
IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLT51YXBpLmNy
dGMpOwo+PiAgCXUzMiB0ZW1wOwo+PiAgCj4+ICAJdGVtcCA9IEk5MTVfUkVBRChpbnRlbF9oZG1p
LT5oZG1pX3JlZyk7Cj4+IEBAIC0yMTk4LDEyICsyMTk4LDEyIEBAIHN0YXRpYyBib29sIGhkbWlf
ZGVlcF9jb2xvcl9wb3NzaWJsZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwKPj4gIAkJCQkgICAgIGludCBicGMpCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0KPj4gLQkJdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRl
dik7Cj4+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+YmFz
ZS5zdGF0ZTsKPj4gKwkJdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4+ICsJ
c3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZTsK
Pj4gIAlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubmVjdG9yX3N0YXRlOwo+PiAgCXN0
cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3I7Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9kaXNw
bGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3Rl
ZF9tb2RlOwo+PiArCQkmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAlpbnQgaTsK
Pj4gIAo+PiAgCWlmIChIQVNfR01DSChkZXZfcHJpdikpCj4+IEBAIC0yMjI4LDcgKzIyMjgsNyBA
QCBzdGF0aWMgYm9vbCBoZG1pX2RlZXBfY29sb3JfcG9zc2libGUoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJZm9yX2VhY2hfbmV3X2Nvbm5lY3Rvcl9pbl9z
dGF0ZShzdGF0ZSwgY29ubmVjdG9yLCBjb25uZWN0b3Jfc3RhdGUsIGkpIHsKPj4gIAkJY29uc3Qg
c3RydWN0IGRybV9kaXNwbGF5X2luZm8gKmluZm8gPSAmY29ubmVjdG9yLT5kaXNwbGF5X2luZm87
Cj4+ICAKPj4gLQkJaWYgKGNvbm5lY3Rvcl9zdGF0ZS0+Y3J0YyAhPSBjcnRjX3N0YXRlLT5iYXNl
LmNydGMpCj4+ICsJCWlmIChjb25uZWN0b3Jfc3RhdGUtPmNydGMgIT0gY3J0Y19zdGF0ZS0+dWFw
aS5jcnRjKQo+PiAgCQkJY29udGludWU7Cj4+ICAKPj4gIAkJaWYgKGNydGNfc3RhdGUtPm91dHB1
dF9mb3JtYXQgPT0gSU5URUxfT1VUUFVUX0ZPUk1BVF9ZQ0JDUjQyMCkgewo+PiBAQCAtMjI2OSw3
ICsyMjY5LDcgQEAgc3RhdGljIGJvb2wKPj4gIGludGVsX2hkbWlfeWNiY3I0MjBfY29uZmlnKHN0
cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCj4+ICAJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY29uZmlnKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRj
ID0gdG9faW50ZWxfY3J0Yyhjb25maWctPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2Ny
dGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNvbmZpZy0+dWFwaS5jcnRjKTsKPj4gIAo+
PiAgCWlmICghY29ubmVjdG9yLT55Y2Jjcl80MjBfYWxsb3dlZCkgewo+PiAgCQlEUk1fRVJST1Io
IlBsYXRmb3JtIGRvZXNuJ3Qgc3VwcG9ydCBZQ0JDUjQyMCBvdXRwdXRcbiIpOwo+PiBAQCAtMjMy
NCw3ICsyMzI0LDcgQEAgc3RhdGljIGludCBpbnRlbF9oZG1pX2NvbXB1dGVfY2xvY2soc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICB7Cj4+ICAJc3RydWN0IGludGVsX2hkbWkgKmlu
dGVsX2hkbWkgPSBlbmNfdG9faW50ZWxfaGRtaSgmZW5jb2Rlci0+YmFzZSk7Cj4+ICAJY29uc3Qg
c3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkmY3J0Y19zdGF0
ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCQkmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9k
ZTsKPj4gIAlpbnQgYnBjLCBjbG9jayA9IGFkanVzdGVkX21vZGUtPmNydGNfY2xvY2s7Cj4+ICAK
Pj4gIAlpZiAoYWRqdXN0ZWRfbW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0RCTENMSykKPj4g
QEAgLTIzNjYsNyArMjM2Niw3IEBAIGludCBpbnRlbF9oZG1pX2NvbXB1dGVfY29uZmlnKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgewo+PiAgCXN0cnVjdCBpbnRlbF9oZG1pICpp
bnRlbF9oZG1pID0gZW5jX3RvX2ludGVsX2hkbWkoJmVuY29kZXItPmJhc2UpOwo+PiAgCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYp
Owo+PiAtCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29u
ZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFk
anVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJc3RydWN0
IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IGNvbm5fc3RhdGUtPmNvbm5lY3RvcjsKPj4gIAlz
dHJ1Y3QgZHJtX3NjZGMgKnNjZGMgPSAmY29ubmVjdG9yLT5kaXNwbGF5X2luZm8uaGRtaS5zY2Rj
Owo+PiAgCXN0cnVjdCBpbnRlbF9kaWdpdGFsX2Nvbm5lY3Rvcl9zdGF0ZSAqaW50ZWxfY29ubl9z
dGF0ZSA9Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2xzcGNvbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9sc3Bjb24uYwo+
PiBpbmRleCBmOGYxMzA4NjQzYTkuLjUxNDVmZjhiOTYyYiAxMDA2NDQKPj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9sc3Bjb24uYwo+PiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2xzcGNvbi5jCj4+IEBAIC0xODksNyArMTg5LDcgQEAg
dm9pZCBsc3Bjb25feWNiY3I0MjBfY29uZmlnKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IsCj4+ICB7Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X2luZm8gKmluZm8gPSAmY29u
bmVjdG9yLT5kaXNwbGF5X2luZm87Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUg
KmFkanVzdGVkX21vZGUgPQo+PiAtCQkJCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2Rl
Owo+PiArCQkJCQkmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAo+PiAgCWlmIChk
cm1fbW9kZV9pc180MjBfb25seShpbmZvLCBhZGp1c3RlZF9tb2RlKSAmJgo+PiAgCSAgICBjb25u
ZWN0b3ItPnljYmNyXzQyMF9hbGxvd2VkKSB7Cj4+IEBAIC00NzUsNyArNDc1LDcgQEAgdm9pZCBs
c3Bjb25fc2V0X2luZm9mcmFtZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICAJ
c3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQgPSBlbmNfdG9fZGlnX3BvcnQoJmVu
Y29kZXItPmJhc2UpOwo+PiAgCXN0cnVjdCBpbnRlbF9sc3Bjb24gKmxzcGNvbiA9ICZkaWdfcG9y
dC0+bHNwY29uOwo+PiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9t
b2RlID0KPj4gLQkJJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwkJJmNydGNf
c3RhdGUtPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAKPj4gIAlpZiAoIWxzcGNvbi0+YWN0aXZlKSB7
Cj4+ICAJCURSTV9FUlJPUigiV3JpdGluZyBpbmZvZnJhbWVzIHdoaWxlIExTUENPTiBkaXNhYmxl
ZCA/XG4iKTsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfbHZkcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9sdmRzLmMKPj4g
aW5kZXggYzc4NmFiZGMzMzM2Li4wZjc3ZTVhOGI3ZmYgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfbHZkcy5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfbHZkcy5jCj4+IEBAIC0xMzUsNyArMTM1LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfbHZkc19nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+PiAgCWVsc2UKPj4gIAkJZmxhZ3MgfD0gRFJNX01PREVfRkxBR19QVlNZTkM7Cj4+ICAKPj4g
LQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IGZsYWdzOwo+PiArCXBp
cGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmZsYWdzIHw9IGZsYWdzOwo+PiAgCj4+ICAJaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPCA1KQo+PiAgCQlwaXBlX2NvbmZpZy0+Z21jaF9wZml0Lmx2
ZHNfYm9yZGVyX2JpdHMgPQo+PiBAQCAtMTQ4LDcgKzE0OCw3IEBAIHN0YXRpYyB2b2lkIGludGVs
X2x2ZHNfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAkJcGlw
ZV9jb25maWctPmdtY2hfcGZpdC5jb250cm9sIHw9IHRtcCAmIFBBTkVMXzhUTzZfRElUSEVSX0VO
QUJMRTsKPj4gIAl9Cj4+ICAKPj4gLQlwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNy
dGNfY2xvY2sgPSBwaXBlX2NvbmZpZy0+cG9ydF9jbG9jazsKPj4gKwlwaXBlX2NvbmZpZy0+aHcu
YWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrID0gcGlwZV9jb25maWctPnBvcnRfY2xvY2s7Cj4+ICB9
Cj4+ICAKPj4gIHN0YXRpYyB2b2lkIGludGVsX2x2ZHNfcHBzX2dldF9od19zdGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4+IEBAIC0yMzAsOCArMjMwLDggQEAgc3RhdGlj
IHZvaWQgaW50ZWxfcHJlX2VuYWJsZV9sdmRzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAo+PiAgewo+PiAgCXN0cnVjdCBpbnRlbF9sdmRzX2VuY29kZXIgKmx2ZHNfZW5jb2RlciA9IHRv
X2x2ZHNfZW5jb2RlcigmZW5jb2Rlci0+YmFzZSk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+
PiAtCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVf
Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+PiArCWNvbnN0IHN0cnVj
dCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5ody5hZGp1
c3RlZF9tb2RlOwo+PiAgCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gIAl1MzIgdGVt
cDsKPj4gIAo+PiBAQCAtMzkyLDggKzM5Miw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfbHZkc19jb21w
dXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKPj4gIAkJdG9f
bHZkc19lbmNvZGVyKCZpbnRlbF9lbmNvZGVyLT5iYXNlKTsKPj4gIAlzdHJ1Y3QgaW50ZWxfY29u
bmVjdG9yICppbnRlbF9jb25uZWN0b3IgPQo+PiAgCQlsdmRzX2VuY29kZXItPmF0dGFjaGVkX2Nv
bm5lY3RvcjsKPj4gLQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZw
aXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpp
bnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPj4gKwlz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcu
YWRqdXN0ZWRfbW9kZTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2lu
dGVsX2NydGMocGlwZV9jb25maWctPnVhcGkuY3J0Yyk7Cj4+ICAJdW5zaWduZWQgaW50IGx2ZHNf
YnBwOwo+PiAgCj4+ICAJLyogU2hvdWxkIG5ldmVyIGhhcHBlbiEhICovCj4+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3BhbmVsLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3BhbmVsLmMKPj4gaW5kZXggYmMxNGU5YzAyODVhLi42
ZjNlYWFlMzc2MWYgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfcGFuZWwuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X3BhbmVsLmMKPj4gQEAgLTE3OCw3ICsxNzgsNyBAQCBpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhz
dHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywKPj4gIAkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpwaXBlX2NvbmZpZywKPj4gIAkJCWludCBmaXR0aW5nX21vZGUpCj4+ICB7Cj4+IC0JY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWct
PmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAq
YWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAlpbnQg
eCA9IDAsIHkgPSAwLCB3aWR0aCA9IDAsIGhlaWdodCA9IDA7Cj4+ICAKPj4gIAkvKiBOYXRpdmUg
bW9kZXMgZG9uJ3QgbmVlZCBmaXR0aW5nICovCj4+IEBAIC0zMDAsNyArMzAwLDcgQEAgc3RhdGlj
IGlubGluZSB1MzIgcGFuZWxfZml0dGVyX3NjYWxpbmcodTMyIHNvdXJjZSwgdTMyIHRhcmdldCkK
Pj4gIHN0YXRpYyB2b2lkIGk5NjVfc2NhbGVfYXNwZWN0KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpwaXBlX2NvbmZpZywKPj4gIAkJCSAgICAgIHUzMiAqcGZpdF9jb250cm9sKQo+PiAgewo+PiAt
CWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29u
ZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJ
dTMyIHNjYWxlZF93aWR0aCA9IGFkanVzdGVkX21vZGUtPmNydGNfaGRpc3BsYXkgKgo+PiAgCQlw
aXBlX2NvbmZpZy0+cGlwZV9zcmNfaDsKPj4gIAl1MzIgc2NhbGVkX2hlaWdodCA9IHBpcGVfY29u
ZmlnLT5waXBlX3NyY193ICoKPj4gQEAgLTMyMSw3ICszMjEsNyBAQCBzdGF0aWMgdm9pZCBpOXh4
X3NjYWxlX2FzcGVjdChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCj4+ICAJ
CQkgICAgICB1MzIgKnBmaXRfY29udHJvbCwgdTMyICpwZml0X3BnbV9yYXRpb3MsCj4+ICAJCQkg
ICAgICB1MzIgKmJvcmRlcikKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRq
dXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCXN0cnVj
dCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5ody5hZGp1
c3RlZF9tb2RlOwo+PiAgCXUzMiBzY2FsZWRfd2lkdGggPSBhZGp1c3RlZF9tb2RlLT5jcnRjX2hk
aXNwbGF5ICoKPj4gIAkJcGlwZV9jb25maWctPnBpcGVfc3JjX2g7Cj4+ICAJdTMyIHNjYWxlZF9o
ZWlnaHQgPSBwaXBlX2NvbmZpZy0+cGlwZV9zcmNfdyAqCj4+IEBAIC0zODAsNyArMzgwLDcgQEAg
dm9pZCBpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVsX2NydGMgKmludGVsX2Ny
dGMsCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShpbnRlbF9jcnRjLT5iYXNlLmRldik7Cj4+ICAJdTMyIHBmaXRfY29udHJvbCA9IDAsIHBmaXRf
cGdtX3JhdGlvcyA9IDAsIGJvcmRlciA9IDA7Cj4+IC0Jc3RydWN0IGRybV9kaXNwbGF5X21vZGUg
KmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwlz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcu
YWRqdXN0ZWRfbW9kZTsKPj4gIAo+PiAgCS8qIE5hdGl2ZSBtb2RlcyBkb24ndCBuZWVkIGZpdHRp
bmcgKi8KPj4gIAlpZiAoYWRqdXN0ZWRfbW9kZS0+Y3J0Y19oZGlzcGxheSA9PSBwaXBlX2NvbmZp
Zy0+cGlwZV9zcmNfdyAmJgo+PiBAQCAtMTA0Nyw3ICsxMDQ3LDcgQEAgc3RhdGljIHZvaWQgdmx2
X2VuYWJsZV9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUsCj4+ICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gdG9faW50ZWxfY29u
bmVjdG9yKGNvbm5fc3RhdGUtPmNvbm5lY3Rvcik7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjb25uZWN0b3ItPmJhc2UuZGV2KTsKPj4gIAlzdHJ1Y3Qg
aW50ZWxfcGFuZWwgKnBhbmVsID0gJmNvbm5lY3Rvci0+cGFuZWw7Cj4+IC0JZW51bSBwaXBlIHBp
cGUgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0YyktPnBpcGU7Cj4+ICsJZW51
bSBwaXBlIHBpcGUgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0YyktPnBpcGU7
Cj4+ICAJdTMyIGN0bCwgY3RsMjsKPj4gIAo+PiAgCWN0bDIgPSBJOTE1X1JFQUQoVkxWX0JMQ19Q
V01fQ1RMMihwaXBlKSk7Cj4+IEBAIC0xMDc3LDcgKzEwNzcsNyBAQCBzdGF0aWMgdm9pZCBieHRf
ZW5hYmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKPj4gIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IgPSB0b19pbnRlbF9jb25u
ZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNvbm5lY3Rvci0+YmFzZS5kZXYpOwo+PiAgCXN0cnVjdCBp
bnRlbF9wYW5lbCAqcGFuZWwgPSAmY29ubmVjdG9yLT5wYW5lbDsKPj4gLQllbnVtIHBpcGUgcGlw
ZSA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKS0+cGlwZTsKPj4gKwllbnVt
IHBpcGUgcGlwZSA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKS0+cGlwZTsK
Pj4gIAl1MzIgcHdtX2N0bCwgdmFsOwo+PiAgCj4+ICAJLyogQ29udHJvbGxlciAxIHVzZXMgdGhl
IHV0aWxpdHkgcGluLiAqLwo+PiBAQCAtMTE4OSw3ICsxMTg5LDcgQEAgdm9pZCBpbnRlbF9wYW5l
bF9lbmFibGVfYmFja2xpZ2h0KGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAo+PiAgCXN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciA9IHRvX2ludGVsX2Nv
bm5lY3Rvcihjb25uX3N0YXRlLT5jb25uZWN0b3IpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY29ubmVjdG9yLT5iYXNlLmRldik7Cj4+ICAJc3RydWN0
IGludGVsX3BhbmVsICpwYW5lbCA9ICZjb25uZWN0b3ItPnBhbmVsOwo+PiAtCWVudW0gcGlwZSBw
aXBlID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpLT5waXBlOwo+PiArCWVu
dW0gcGlwZSBwaXBlID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpLT5waXBl
Owo+PiAgCj4+ICAJaWYgKCFwYW5lbC0+YmFja2xpZ2h0LnByZXNlbnQpCj4+ICAJCXJldHVybjsK
Pj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGlwZV9j
cmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGlwZV9jcmMuYwo+PiBp
bmRleCA2MjYwYTIwODI3MTkuLjI3NDY1MTJmNDQ2NiAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9waXBlX2NyYy5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGlwZV9jcmMuYwo+PiBAQCAtMzA5LDEzICszMDksMTMg
QEAgaW50ZWxfY3J0Y19jcmNfc2V0dXBfd29ya2Fyb3VuZHMoc3RydWN0IGludGVsX2NydGMgKmNy
dGMsIGJvb2wgZW5hYmxlKQo+PiAgCQlnb3RvIHB1dF9zdGF0ZTsKPj4gIAl9Cj4+ICAKPj4gLQlw
aXBlX2NvbmZpZy0+YmFzZS5tb2RlX2NoYW5nZWQgPSBwaXBlX2NvbmZpZy0+aGFzX3BzcjsKPj4g
KwlwaXBlX2NvbmZpZy0+dWFwaS5tb2RlX2NoYW5nZWQgPSBwaXBlX2NvbmZpZy0+aGFzX3BzcjsK
Pj4gIAlwaXBlX2NvbmZpZy0+Y3JjX2VuYWJsZWQgPSBlbmFibGU7Cj4+ICAKPj4gIAlpZiAoSVNf
SEFTV0VMTChkZXZfcHJpdikgJiYKPj4gLQkgICAgcGlwZV9jb25maWctPmJhc2UuYWN0aXZlICYm
IGNydGMtPnBpcGUgPT0gUElQRV9BICYmCj4+ICsJICAgIHBpcGVfY29uZmlnLT5ody5hY3RpdmUg
JiYgY3J0Yy0+cGlwZSA9PSBQSVBFX0EgJiYKPj4gIAkgICAgcGlwZV9jb25maWctPmNwdV90cmFu
c2NvZGVyID09IFRSQU5TQ09ERVJfRURQKQo+PiAtCQlwaXBlX2NvbmZpZy0+YmFzZS5tb2RlX2No
YW5nZWQgPSB0cnVlOwo+PiArCQlwaXBlX2NvbmZpZy0+dWFwaS5tb2RlX2NoYW5nZWQgPSB0cnVl
Owo+PiAgCj4+ICAJcmV0ID0gZHJtX2F0b21pY19jb21taXQoc3RhdGUpOwo+PiAgCj4+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Bzci5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wc3IuYwo+PiBpbmRleCBiM2M3ZWVmNTNiZjMu
Ljg5ODhkYmU4YzE5ZSAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9wc3IuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X3Bzci5jCj4+IEBAIC01MzgsOCArNTM4LDggQEAgc3RhdGljIGJvb2wgaW50ZWxfcHNyMl9jb25m
aWdfdmFsaWQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPj4gIAkJCQkgICAgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4+IC0JaW50IGNydGNfaGRp
c3BsYXkgPSBjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19oZGlzcGxheTsKPj4g
LQlpbnQgY3J0Y192ZGlzcGxheSA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRj
X3ZkaXNwbGF5Owo+PiArCWludCBjcnRjX2hkaXNwbGF5ID0gY3J0Y19zdGF0ZS0+aHcuYWRqdXN0
ZWRfbW9kZS5jcnRjX2hkaXNwbGF5Owo+PiArCWludCBjcnRjX3ZkaXNwbGF5ID0gY3J0Y19zdGF0
ZS0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX3ZkaXNwbGF5Owo+PiAgCWludCBwc3JfbWF4X2ggPSAw
LCBwc3JfbWF4X3YgPSAwOwo+PiAgCj4+ICAJaWYgKCFkZXZfcHJpdi0+cHNyLnNpbmtfcHNyMl9z
dXBwb3J0KQo+PiBAQCAtNjA1LDcgKzYwNSw3IEBAIHZvaWQgaW50ZWxfcHNyX2NvbXB1dGVfY29u
ZmlnKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCj4+ICAJc3RydWN0IGludGVsX2RpZ2l0YWxf
cG9ydCAqZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRlbF9kcCk7Cj4+ICAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7Cj4+ICAJY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkmY3J0Y19z
dGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCQkmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRf
bW9kZTsKPj4gIAlpbnQgcHNyX3NldHVwX3RpbWU7Cj4+ICAKPj4gIAlpZiAoIUNBTl9QU1IoZGV2
X3ByaXYpKQo+PiBAQCAtNzQ1LDcgKzc0NSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Bzcl9lbmFi
bGVfbG9ja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPj4gIAo+PiAgCWRl
dl9wcml2LT5wc3IucHNyMl9lbmFibGVkID0gaW50ZWxfcHNyMl9lbmFibGVkKGRldl9wcml2LCBj
cnRjX3N0YXRlKTsKPj4gIAlkZXZfcHJpdi0+cHNyLmJ1c3lfZnJvbnRidWZmZXJfYml0cyA9IDA7
Cj4+IC0JZGV2X3ByaXYtPnBzci5waXBlID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNl
LmNydGMpLT5waXBlOwo+PiArCWRldl9wcml2LT5wc3IucGlwZSA9IHRvX2ludGVsX2NydGMoY3J0
Y19zdGF0ZS0+dWFwaS5jcnRjKS0+cGlwZTsKPj4gIAlkZXZfcHJpdi0+cHNyLnRyYW5zY29kZXIg
PSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKPj4gIAo+PiAgCS8qCj4+IEBAIC05ODgsNyAr
OTg4LDcgQEAgdm9pZCBpbnRlbF9wc3JfdXBkYXRlKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAs
Cj4+ICBpbnQgaW50ZWxfcHNyX3dhaXRfZm9yX2lkbGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKm5ld19jcnRjX3N0YXRlLAo+PiAgCQkJICAgIHUzMiAqb3V0X3ZhbHVlKQo+PiAgewo+
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMobmV3X2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAKPj4gIAlpZiAoIWRl
dl9wcml2LT5wc3IuZW5hYmxlZCB8fCAhbmV3X2NydGNfc3RhdGUtPmhhc19wc3IpCj4+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nkdm8uYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc2R2by5jCj4+IGluZGV4IGFkZWIxYzg0MDk3
Ni4uZjc0YzUyOGQ1ZDY4IDEwMDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX3Nkdm8uYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX3Nkdm8uYwo+PiBAQCAtMTA4Nyw3ICsxMDg3LDcgQEAgc3RhdGljIGJvb2wgaW50ZWxfc2R2
b19jb21wdXRlX2F2aV9pbmZvZnJhbWUoc3RydWN0IGludGVsX3Nkdm8gKmludGVsX3Nkdm8sCj4+
ICB7Cj4+ICAJc3RydWN0IGhkbWlfYXZpX2luZm9mcmFtZSAqZnJhbWUgPSAmY3J0Y19zdGF0ZS0+
aW5mb2ZyYW1lcy5hdmkuYXZpOwo+PiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICph
ZGp1c3RlZF9tb2RlID0KPj4gLQkJJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4g
KwkJJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJaW50IHJldDsKPj4gIAo+PiAg
CWlmICghY3J0Y19zdGF0ZS0+aGFzX2hkbWlfc2luaykKPj4gQEAgLTEyNzYsOCArMTI3Niw4IEBA
IHN0YXRpYyBpbnQgaW50ZWxfc2R2b19jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPj4gIAkJdG9faW50ZWxfc2R2b19jb25uZWN0b3Jfc3RhdGUoY29ubl9zdGF0
ZSk7Cj4+ICAJc3RydWN0IGludGVsX3Nkdm9fY29ubmVjdG9yICppbnRlbF9zZHZvX2Nvbm5lY3Rv
ciA9Cj4+ICAJCXRvX2ludGVsX3Nkdm9fY29ubmVjdG9yKGNvbm5fc3RhdGUtPmNvbm5lY3Rvcik7
Cj4+IC0Jc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlwZV9jb25m
aWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gLQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9k
ZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5tb2RlOwo+PiArCXN0cnVjdCBkcm1fZGlzcGxheV9tb2Rl
ICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+PiArCXN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJnBpcGVfY29uZmlnLT5ody5tb2RlOwo+PiAg
Cj4+ICAJRFJNX0RFQlVHX0tNUygiZm9yY2luZyBicGMgdG8gOCBmb3IgU0RWT1xuIik7Cj4+ICAJ
cGlwZV9jb25maWctPnBpcGVfYnBwID0gOCozOwo+PiBAQCAtMTQyOSwxMyArMTQyOSwxMyBAQCBz
dGF0aWMgdm9pZCBpbnRlbF9zZHZvX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmlu
dGVsX2VuY29kZXIsCj4+ICAJCQkJICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSB0b19pOTE1KGludGVsX2VuY29kZXItPmJhc2UuZGV2KTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gLQljb25z
dCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5i
YXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9kaXNw
bGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsK
Pj4gIAljb25zdCBzdHJ1Y3QgaW50ZWxfc2R2b19jb25uZWN0b3Jfc3RhdGUgKnNkdm9fc3RhdGUg
PQo+PiAgCQl0b19pbnRlbF9zZHZvX2Nvbm5lY3Rvcl9zdGF0ZShjb25uX3N0YXRlKTsKPj4gIAlj
b25zdCBzdHJ1Y3QgaW50ZWxfc2R2b19jb25uZWN0b3IgKmludGVsX3Nkdm9fY29ubmVjdG9yID0K
Pj4gIAkJdG9faW50ZWxfc2R2b19jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKPj4g
LQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZjcnRjX3N0YXRlLT5iYXNl
Lm1vZGU7Cj4+ICsJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUgPSAmY3J0Y19z
dGF0ZS0+aHcubW9kZTsKPj4gIAlzdHJ1Y3QgaW50ZWxfc2R2byAqaW50ZWxfc2R2byA9IHRvX3Nk
dm8oaW50ZWxfZW5jb2Rlcik7Cj4+ICAJdTMyIHNkdm94Owo+PiAgCXN0cnVjdCBpbnRlbF9zZHZv
X2luX291dF9tYXAgaW5fb3V0Owo+PiBAQCAtMTYyOSw3ICsxNjI5LDcgQEAgc3RhdGljIHZvaWQg
aW50ZWxfc2R2b19nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAg
CQkJZmxhZ3MgfD0gRFJNX01PREVfRkxBR19OVlNZTkM7Cj4+ICAJfQo+PiAgCj4+IC0JcGlwZV9j
b25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBmbGFnczsKPj4gKwlwaXBlX2NvbmZp
Zy0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFncyB8PSBmbGFnczsKPj4gIAo+PiAgCS8qCj4+ICAJICog
cGl4ZWwgbXVsdGlwbGllciByZWFkb3V0IGlzIHRyaWNreTogT25seSBvbiBpOTE1Zy9nbSBpdCBp
cyBzdG9yZWQgaW4KPj4gQEAgLTE2NDksNyArMTY0OSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3Nk
dm9fZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAlpZiAocGlw
ZV9jb25maWctPnBpeGVsX211bHRpcGxpZXIpCj4+ICAJCWRvdGNsb2NrIC89IHBpcGVfY29uZmln
LT5waXhlbF9tdWx0aXBsaWVyOwo+PiAgCj4+IC0JcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRf
bW9kZS5jcnRjX2Nsb2NrID0gZG90Y2xvY2s7Cj4+ICsJcGlwZV9jb25maWctPmh3LmFkanVzdGVk
X21vZGUuY3J0Y19jbG9jayA9IGRvdGNsb2NrOwo+PiAgCj4+ICAJLyogQ3Jvc3MgY2hlY2sgdGhl
IHBvcnQgcGl4ZWwgbXVsdGlwbGllciB3aXRoIHRoZSBzZHZvIGVuY29kZXIgc3RhdGUuICovCj4+
ICAJaWYgKGludGVsX3Nkdm9fZ2V0X3ZhbHVlKGludGVsX3Nkdm8sIFNEVk9fQ01EX0dFVF9DTE9D
S19SQVRFX01VTFQsCj4+IEBAIC0xNzAxLDcgKzE3MDEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9z
ZHZvX2VuYWJsZV9hdWRpbyhzdHJ1Y3QgaW50ZWxfc2R2byAqaW50ZWxfc2R2bywKPj4gIAkJCQkg
ICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCj4+ICB7Cj4+
ICAJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkm
Y3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCQkmY3J0Y19zdGF0ZS0+aHcuYWRq
dXN0ZWRfbW9kZTsKPj4gIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gY29ubl9z
dGF0ZS0+Y29ubmVjdG9yOwo+PiAgCXU4ICplbGQgPSBjb25uZWN0b3ItPmVsZDsKPj4gIAo+PiBA
QCAtMTcyMyw3ICsxNzIzLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJsZV9zZHZvKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgewo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+PiAgCXN0cnVjdCBp
bnRlbF9zZHZvICppbnRlbF9zZHZvID0gdG9fc2R2byhlbmNvZGVyKTsKPj4gLQlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0
YXRlLT51YXBpLmNydGMpOwo+PiAgCXUzMiB0ZW1wOwo+PiAgCj4+ICAJaWYgKG9sZF9jcnRjX3N0
YXRlLT5oYXNfYXVkaW8pCj4+IEBAIC0xNzg1LDcgKzE3ODUsNyBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9lbmFibGVfc2R2byhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2ID0gZW5jb2Rlci0+YmFzZS5kZXY7Cj4+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+PiAgCXN0cnVjdCBpbnRlbF9zZHZv
ICppbnRlbF9zZHZvID0gdG9fc2R2byhlbmNvZGVyKTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAq
aW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4+ICsJ
c3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmln
LT51YXBpLmNydGMpOwo+PiAgCXUzMiB0ZW1wOwo+PiAgCWJvb2wgaW5wdXQxLCBpbnB1dDI7Cj4+
ICAJaW50IGk7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX3Nwcml0ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUu
Ywo+PiBpbmRleCA3YTcwNzhkMGJhMjMuLmE2MDJlMjFjNWZkNSAxMDA2NDQKPj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zcHJpdGUuYwo+PiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jCj4+IEBAIC04MSw5ICs4MSw5IEBA
IGludCBpbnRlbF91c2Vjc190b19zY2FubGluZXMoY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKmFkanVzdGVkX21vZGUsCj4+ICAgKi8KPj4gIHZvaWQgaW50ZWxfcGlwZV91cGRhdGVfc3Rh
cnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+PiAgewo+
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMobmV3X2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+IC0JY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmbmV3X2NydGNfc3RhdGUtPmJhc2Uu
YWRqdXN0ZWRfbW9kZTsKPj4gKwljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0
ZWRfbW9kZSA9ICZuZXdfY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAlsb25nIHRp
bWVvdXQgPSBtc2Vjc190b19qaWZmaWVzX3RpbWVvdXQoMSk7Cj4+ICAJaW50IHNjYW5saW5lLCBt
aW4sIG1heCwgdmJsYW5rX3N0YXJ0Owo+PiAgCXdhaXRfcXVldWVfaGVhZF90ICp3cSA9IGRybV9j
cnRjX3ZibGFua193YWl0cXVldWUoJmNydGMtPmJhc2UpOwo+PiBAQCAtMTkwLDcgKzE5MCw3IEBA
IHZvaWQgaW50ZWxfcGlwZV91cGRhdGVfc3RhcnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKm5ld19jcnRjX3N0YXRlKQo+PiAgICovCj4+ICB2b2lkIGludGVsX3BpcGVfdXBkYXRlX2Vu
ZChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRjX3N0YXRlLT5iYXNl
LmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdf
Y3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7
Cj4+ICAJaW50IHNjYW5saW5lX2VuZCA9IGludGVsX2dldF9jcnRjX3NjYW5saW5lKGNydGMpOwo+
PiAgCXUzMiBlbmRfdmJsX2NvdW50ID0gaW50ZWxfY3J0Y19nZXRfdmJsYW5rX2NvdW50ZXIoY3J0
Yyk7Cj4+IEBAIC0yMDMsMTQgKzIwMywxNSBAQCB2b2lkIGludGVsX3BpcGVfdXBkYXRlX2VuZChz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUpCj4+ICAJICogV291bGQgYmUg
c2xpZ2h0bHkgbmljZSB0byBqdXN0IGdyYWIgdGhlIHZibGFuayBjb3VudCBhbmQgYXJtIHRoZQo+
PiAgCSAqIGV2ZW50IG91dHNpZGUgb2YgdGhlIGNyaXRpY2FsIHNlY3Rpb24gLSB0aGUgc3Bpbmxv
Y2sgbWlnaHQgc3BpbiBmb3IgYQo+PiAgCSAqIHdoaWxlIC4uLiAqLwo+PiAtCWlmIChuZXdfY3J0
Y19zdGF0ZS0+YmFzZS5ldmVudCkgewo+PiArCWlmIChuZXdfY3J0Y19zdGF0ZS0+dWFwaS5ldmVu
dCkgewo+PiAgCQlXQVJOX09OKGRybV9jcnRjX3ZibGFua19nZXQoJmNydGMtPmJhc2UpICE9IDAp
Owo+PiAgCj4+ICAJCXNwaW5fbG9jaygmY3J0Yy0+YmFzZS5kZXYtPmV2ZW50X2xvY2spOwo+PiAt
CQlkcm1fY3J0Y19hcm1fdmJsYW5rX2V2ZW50KCZjcnRjLT5iYXNlLCBuZXdfY3J0Y19zdGF0ZS0+
YmFzZS5ldmVudCk7Cj4+ICsJCWRybV9jcnRjX2FybV92YmxhbmtfZXZlbnQoJmNydGMtPmJhc2Us
Cj4+ICsJCQkJICAgICAgICAgIG5ld19jcnRjX3N0YXRlLT51YXBpLmV2ZW50KTsKPj4gIAkJc3Bp
bl91bmxvY2soJmNydGMtPmJhc2UuZGV2LT5ldmVudF9sb2NrKTsKPj4gIAo+PiAtCQluZXdfY3J0
Y19zdGF0ZS0+YmFzZS5ldmVudCA9IE5VTEw7Cj4+ICsJCW5ld19jcnRjX3N0YXRlLT51YXBpLmV2
ZW50ID0gTlVMTDsKPj4gIAl9Cj4+ICAKPj4gIAlsb2NhbF9pcnFfZW5hYmxlKCk7Cj4+IEBAIC0x
NTE1LDcgKzE1MTYsNyBAQCBnNHhfc3ByaXRlX2NoZWNrX3NjYWxpbmcoc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJY29uc3Qgc3RydWN0IGRybV9yZWN0ICpkc3QgPSAm
cGxhbmVfc3RhdGUtPmJhc2UuZHN0Owo+PiAgCWludCBzcmNfeCwgc3JjX3csIHNyY19oLCBjcnRj
X3csIGNydGNfaDsKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRf
bW9kZSA9Cj4+IC0JCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJCSZjcnRj
X3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+PiAgCXVuc2lnbmVkIGludCBjcHAgPSBmYi0+Zm9y
bWF0LT5jcHBbMF07Cj4+ICAJdW5zaWduZWQgaW50IHdpZHRoX2J5dGVzOwo+PiAgCWludCBtaW5f
d2lkdGgsIG1pbl9oZWlnaHQ7Cj4+IEBAIC0xNTg3LDcgKzE1ODgsNyBAQCBnNHhfc3ByaXRlX2No
ZWNrKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCX0KPj4gIAo+PiAg
CXJldCA9IGRybV9hdG9taWNfaGVscGVyX2NoZWNrX3BsYW5lX3N0YXRlKCZwbGFuZV9zdGF0ZS0+
YmFzZSwKPj4gLQkJCQkJCSAgJmNydGNfc3RhdGUtPmJhc2UsCj4+ICsJCQkJCQkgICZjcnRjX3N0
YXRlLT51YXBpLAo+PiAgCQkJCQkJICBtaW5fc2NhbGUsIG1heF9zY2FsZSwKPj4gIAkJCQkJCSAg
dHJ1ZSwgdHJ1ZSk7Cj4+ICAJaWYgKHJldCkKPj4gQEAgLTE2NDQsNyArMTY0NSw3IEBAIHZsdl9z
cHJpdGVfY2hlY2soc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCXJl
dHVybiByZXQ7Cj4+ICAKPj4gIAlyZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jaGVja19wbGFuZV9z
dGF0ZSgmcGxhbmVfc3RhdGUtPmJhc2UsCj4+IC0JCQkJCQkgICZjcnRjX3N0YXRlLT5iYXNlLAo+
PiArCQkJCQkJICAmY3J0Y19zdGF0ZS0+dWFwaSwKPj4gIAkJCQkJCSAgRFJNX1BMQU5FX0hFTFBF
Ul9OT19TQ0FMSU5HLAo+PiAgCQkJCQkJICBEUk1fUExBTkVfSEVMUEVSX05PX1NDQUxJTkcsCj4+
ICAJCQkJCQkgIHRydWUsIHRydWUpOwo+PiBAQCAtMTcyOCw4ICsxNzI5LDggQEAgc3RhdGljIGlu
dCBza2xfcGxhbmVfY2hlY2tfZmIoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCj4+ICAJfQo+PiAgCj4+ICAJLyogWS10aWxpbmcgaXMgbm90IHN1cHBvcnRlZCBpbiBJ
Ri1JRCBJbnRlcmxhY2UgbW9kZSAqLwo+PiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmVuYWJsZSAm
Jgo+PiAtCSAgICBjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUuZmxhZ3MgJiBEUk1fTU9E
RV9GTEFHX0lOVEVSTEFDRSAmJgo+PiArCWlmIChjcnRjX3N0YXRlLT5ody5lbmFibGUgJiYKPj4g
KwkgICAgY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFncyAmIERSTV9NT0RFX0ZMQUdf
SU5URVJMQUNFICYmCj4+ICAJICAgIChmYi0+bW9kaWZpZXIgPT0gSTkxNV9GT1JNQVRfTU9EX1lf
VElMRUQgfHwKPj4gIAkgICAgIGZiLT5tb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWWZfVElM
RUQgfHwKPj4gIAkgICAgIGZiLT5tb2RpZmllciA9PSBJOTE1X0ZPUk1BVF9NT0RfWV9USUxFRF9D
Q1MgfHwKPj4gQEAgLTE4MDksNyArMTgxMCw3IEBAIHN0YXRpYyBpbnQgc2tsX3BsYW5lX2NoZWNr
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCX0KPj4gIAo+PiAgCXJl
dCA9IGRybV9hdG9taWNfaGVscGVyX2NoZWNrX3BsYW5lX3N0YXRlKCZwbGFuZV9zdGF0ZS0+YmFz
ZSwKPj4gLQkJCQkJCSAgJmNydGNfc3RhdGUtPmJhc2UsCj4+ICsJCQkJCQkgICZjcnRjX3N0YXRl
LT51YXBpLAo+PiAgCQkJCQkJICBtaW5fc2NhbGUsIG1heF9zY2FsZSwKPj4gIAkJCQkJCSAgdHJ1
ZSwgdHJ1ZSk7Cj4+ICAJaWYgKHJldCkKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfdHYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfdHYuYwo+PiBpbmRleCBiNzAyMjFmNTExMmEuLjk2YTNkOTM0ODQ3MSAxMDA2NDQKPj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90di5jCj4+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdHYuYwo+PiBAQCAtOTI0LDcgKzkyNCw3IEBA
IGludGVsX2VuYWJsZV90dihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAo+PiAg
CS8qIFByZXZlbnRzIHZibGFuayB3YWl0cyBmcm9tIHRpbWluZyBvdXQgaW4gaW50ZWxfdHZfZGV0
ZWN0X3R5cGUoKSAqLwo+PiAgCWludGVsX3dhaXRfZm9yX3ZibGFuayhkZXZfcHJpdiwKPj4gLQkJ
CSAgICAgIHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0YyktPnBpcGUpOwo+PiAr
CQkJICAgICAgdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+dWFwaS5jcnRjKS0+cGlwZSk7Cj4+
ICAKPj4gIAlJOTE1X1dSSVRFKFRWX0NUTCwgSTkxNV9SRUFEKFRWX0NUTCkgfCBUVl9FTkNfRU5B
QkxFKTsKPj4gIH0KPj4gQEAgLTEwODYsNyArMTA4Niw3IEBAIGludGVsX3R2X2dldF9jb25maWco
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Cj4+ICAJc3Ry
dWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkmcGlwZV9jb25maWct
PmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwkJJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2Rl
Owo+PiAgCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlIG1vZGUgPSB7fTsKPj4gIAl1MzIgdHZfY3Rs
LCBoY3RsMSwgaGN0bDMsIHZjdGwxLCB2Y3RsMiwgdG1wOwo+PiAgCXN0cnVjdCB0dl9tb2RlIHR2
X21vZGUgPSB7fTsKPj4gQEAgLTExODksNyArMTE4OSw3IEBAIGludGVsX3R2X2NvbXB1dGVfY29u
ZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCQl0b19pbnRlbF90dl9jb25u
ZWN0b3Jfc3RhdGUoY29ubl9zdGF0ZSk7Cj4+ICAJY29uc3Qgc3RydWN0IHR2X21vZGUgKnR2X21v
ZGUgPSBpbnRlbF90dl9tb2RlX2ZpbmQoY29ubl9zdGF0ZSk7Cj4+ICAJc3RydWN0IGRybV9kaXNw
bGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0
ZWRfbW9kZTsKPj4gKwkJJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+PiAgCWludCBo
ZGlzcGxheSA9IGFkanVzdGVkX21vZGUtPmNydGNfaGRpc3BsYXk7Cj4+ICAJaW50IHZkaXNwbGF5
ID0gYWRqdXN0ZWRfbW9kZS0+Y3J0Y192ZGlzcGxheTsKPj4gIAo+PiBAQCAtMTQxOCw3ICsxNDE4
LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfdHZfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKPj4gIAkJCQljb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29u
bl9zdGF0ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0
b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxf
Y3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0
IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBp
LmNydGMpOwo+PiAgCXN0cnVjdCBpbnRlbF90diAqaW50ZWxfdHYgPSBlbmNfdG9fdHYoZW5jb2Rl
cik7Cj4+ICAJY29uc3Qgc3RydWN0IGludGVsX3R2X2Nvbm5lY3Rvcl9zdGF0ZSAqdHZfY29ubl9z
dGF0ZSA9Cj4+ICAJCXRvX2ludGVsX3R2X2Nvbm5lY3Rvcl9zdGF0ZShjb25uX3N0YXRlKTsKPj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdmRzYy5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF92ZHNjLmMKPj4gaW5kZXggZDRmYjdm
MTZmOWY2Li4zOGMxODE0OTk1MDUgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfdmRzYy5jCj4+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfdmRzYy5jCj4+IEBAIC0zMjksOCArMzI5LDggQEAgaW50IGludGVsX2RwX2NvbXB1
dGVfZHNjX3BhcmFtcyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAo+PiAgCWludCBjb2x1bW5f
aW5kZXggPSAwOwo+PiAgCXU4IGxpbmVfYnVmX2RlcHRoID0gMDsKPj4gIAo+PiAtCXZkc2NfY2Zn
LT5waWNfd2lkdGggPSBwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaGRpc3Bs
YXk7Cj4+IC0JdmRzY19jZmctPnBpY19oZWlnaHQgPSBwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3Rl
ZF9tb2RlLmNydGNfdmRpc3BsYXk7Cj4+ICsJdmRzY19jZmctPnBpY193aWR0aCA9IHBpcGVfY29u
ZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaGRpc3BsYXk7Cj4+ICsJdmRzY19jZmctPnBpY19o
ZWlnaHQgPSBwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZS5jcnRjX3ZkaXNwbGF5Owo+PiAg
CXZkc2NfY2ZnLT5zbGljZV93aWR0aCA9IERJVl9ST1VORF9VUCh2ZHNjX2NmZy0+cGljX3dpZHRo
LAo+PiAgCQkJCQkgICAgIHBpcGVfY29uZmlnLT5kc2NfcGFyYW1zLnNsaWNlX2NvdW50KTsKPj4g
IAkvKgo+PiBAQCAtNDU5LDcgKzQ1OSw3IEBAIGludCBpbnRlbF9kcF9jb21wdXRlX2RzY19wYXJh
bXMoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwKPj4gIGVudW0gaW50ZWxfZGlzcGxheV9wb3dl
cl9kb21haW4KPj4gIGludGVsX2RzY19wb3dlcl9kb21haW4oY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5k
ZXYpOwo+PiAgCWVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNw
dV90cmFuc2NvZGVyOwo+PiAgCj4+ICAJLyoKPj4gQEAgLTQ4Myw3ICs0ODMsNyBAQCBpbnRlbF9k
c2NfcG93ZXJfZG9tYWluKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQo+PiAgc3RhdGljIHZvaWQgaW50ZWxfY29uZmlndXJlX3Bwc19mb3JfZHNjX2VuY29kZXIoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICAJCQkJCQljb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4g
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX2RzY19jb25maWcgKnZkc2NfY2ZnID0gJmNy
dGNfc3RhdGUtPmRwX2RzY19jZmc7Cj4+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+
PiBAQCAtOTAyLDcgKzkwMiw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RwX3dyaXRlX2RzY19wcHNf
c2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgdm9pZCBpbnRlbF9kc2NfZW5h
YmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCQkgICAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5j
cnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVu
Y29kZXItPmJhc2UuZGV2KTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+ICAJ
aTkxNV9yZWdfdCBkc3NfY3RsMV9yZWcsIGRzc19jdGwyX3JlZzsKPj4gQEAgLTkzOCw3ICs5Mzgs
NyBAQCB2b2lkIGludGVsX2RzY19lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
Cj4+ICAKPj4gIHZvaWQgaW50ZWxfZHNjX2Rpc2FibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKm9sZF9jcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
ID0gdG9faW50ZWxfY3J0YyhvbGRfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtPnVhcGkuY3J0
Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7Cj4+ICAJZW51bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOwo+PiAgCWk5MTVf
cmVnX3QgZHNzX2N0bDFfcmVnLCBkc3NfY3RsMl9yZWc7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L3Zsdl9kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvdmx2X2RzaS5jCj4+IGluZGV4IDUwMDY0Y2RlMDcyNC4uMTZmOTNkMWU3MWU1IDEwMDY0
NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L3Zsdl9kc2kuYwo+PiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L3Zsdl9kc2kuYwo+PiBAQCAtMjYxLDkgKzI2
MSw5IEBAIHN0YXRpYyBpbnQgaW50ZWxfZHNpX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAo+PiAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGNvbnRh
aW5lcl9vZihlbmNvZGVyLCBzdHJ1Y3QgaW50ZWxfZHNpLAo+PiAgCQkJCQkJICAgYmFzZSk7Cj4+
ICAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9yID0gaW50ZWxfZHNpLT5h
dHRhY2hlZF9jb25uZWN0b3I7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKHBpcGVfY29uZmlnLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+dWFwaS5jcnRjKTsKPj4gIAljb25zdCBz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqZml4ZWRfbW9kZSA9IGludGVsX2Nvbm5lY3Rvci0+cGFu
ZWwuZml4ZWRfbW9kZTsKPj4gLQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9k
ZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCXN0cnVjdCBkcm1fZGlz
cGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0gJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2Rl
Owo+PiAgCWludCByZXQ7Cj4+ICAKPj4gIAlEUk1fREVCVUdfS01TKCJcbiIpOwo+PiBAQCAtNjI0
LDcgKzYyNCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wb3J0X2VuYWJsZShzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKPj4gIAkJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwo+PiAtCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMp
Owo+PiAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2koJmVu
Y29kZXItPmJhc2UpOwo+PiAgCWVudW0gcG9ydCBwb3J0Owo+PiAgCj4+IEBAIC03NDYsNyArNzQ2
LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCj4+ICAJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpj
b25uX3N0YXRlKQo+PiAgewo+PiAgCXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190
b19pbnRlbF9kc2koJmVuY29kZXItPmJhc2UpOwo+PiAtCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9
IHBpcGVfY29uZmlnLT5iYXNlLmNydGM7Cj4+ICsJc3RydWN0IGRybV9jcnRjICpjcnRjID0gcGlw
ZV9jb25maWctPnVhcGkuY3J0YzsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGMtPmRldik7Cj4+ICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2Ny
dGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+PiAgCWVudW0gcGlwZSBwaXBlID0gaW50ZWxfY3J0
Yy0+cGlwZTsKPj4gQEAgLTEwMzIsOSArMTAzMiw5IEBAIHN0YXRpYyB2b2lkIGJ4dF9kc2lfZ2V0
X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAo+PiAgCXN0cnVjdCBk
cm1fZGV2aWNlICpkZXYgPSBlbmNvZGVyLT5iYXNlLmRldjsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4+ICAJc3RydWN0IGRybV9kaXNwbGF5
X21vZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkJCQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0
ZWRfbW9kZTsKPj4gKwkJCQkJJnBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+PiAgCXN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlX3N3Owo+PiAtCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhwaXBlX2NvbmZpZy0+YmFzZS5jcnRjKTsKPj4g
KwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPnVh
cGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGludGVsX2RzaSAqaW50ZWxfZHNpID0gZW5jX3RvX2ludGVs
X2RzaSgmZW5jb2Rlci0+YmFzZSk7Cj4+ICAJdW5zaWduZWQgaW50IGxhbmVfY291bnQgPSBpbnRl
bF9kc2ktPmxhbmVfY291bnQ7Cj4+ICAJdW5zaWduZWQgaW50IGJwcCwgZm10Owo+PiBAQCAtMTA0
NSw3ICsxMDQ1LDcgQEAgc3RhdGljIHZvaWQgYnh0X2RzaV9nZXRfcGlwZV9jb25maWcoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICAJCQkJY3J0Y19oYmxhbmtfc3RhcnRfc3csIGNy
dGNfaGJsYW5rX2VuZF9zdzsKPj4gIAo+PiAgCS8qIEZJWE1FOiBodyByZWFkb3V0IHNob3VsZCBu
b3QgZGVwZW5kIG9uIFNXIHN0YXRlICovCj4+IC0JYWRqdXN0ZWRfbW9kZV9zdyA9ICZjcnRjLT5j
b25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwlhZGp1c3RlZF9tb2RlX3N3ID0gJmNydGMt
PmNvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAo+PiAgCS8qCj4+ICAJICogQXRsZWFzdCBv
bmUgcG9ydCBpcyBhY3RpdmUgYXMgZW5jb2Rlci0+Z2V0X2NvbmZpZyBjYWxsZWQgb25seSBpZgo+
PiBAQCAtMTIwNCw3ICsxMjA0LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNpX2dldF9jb25maWco
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCj4+ICAJfQo+PiAgCj4+ICAJaWYgKHBjbGsp
IHsKPj4gLQkJcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2Nsb2NrID0gcGNs
azsKPj4gKwkJcGlwZV9jb25maWctPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9jayA9IHBjbGs7
Cj4+ICAJCXBpcGVfY29uZmlnLT5wb3J0X2Nsb2NrID0gcGNsazsKPj4gIAl9Cj4+ICB9Cj4+IEBA
IC0xMzE1LDkgKzEzMTUsOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfcHJlcGFyZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKPj4gIAlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVu
Y29kZXIgPSAmaW50ZWxfZW5jb2Rlci0+YmFzZTsKPj4gIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
ID0gZW5jb2Rlci0+ZGV2Owo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2lu
dGVsX2NydGMocGlwZV9jb25maWctPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMg
KmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKHBpcGVfY29uZmlnLT51YXBpLmNydGMpOwo+PiAg
CXN0cnVjdCBpbnRlbF9kc2kgKmludGVsX2RzaSA9IGVuY190b19pbnRlbF9kc2koZW5jb2Rlcik7
Cj4+IC0JY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPSAmcGlw
ZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwljb25zdCBzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsK
Pj4gIAllbnVtIHBvcnQgcG9ydDsKPj4gIAl1bnNpZ25lZCBpbnQgYnBwID0gbWlwaV9kc2lfcGl4
ZWxfZm9ybWF0X3RvX2JwcChpbnRlbF9kc2ktPnBpeGVsX2Zvcm1hdCk7Cj4+ICAJdTMyIHZhbCwg
dG1wOwo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwo+PiBpbmRleCA0M2RiNTAwOTUy
NTcuLjFjNGMzOTcyZmQyMyAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kZWJ1Z2ZzLmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMK
Pj4gQEAgLTI3NDksMTEgKzI3NDksMTEgQEAgc3RhdGljIGludCBpOTE1X2Rpc3BsYXlfaW5mbyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKPj4gIAo+PiAgCQlzZXFfcHJpbnRmKG0s
ICJDUlRDICVkOiBwaXBlOiAlYywgYWN0aXZlPSVzLCAoc2l6ZT0lZHglZCksIGRpdGhlcj0lcywg
YnBwPSVkXG4iLAo+PiAgCQkJICAgY3J0Yy0+YmFzZS5iYXNlLmlkLCBwaXBlX25hbWUoY3J0Yy0+
cGlwZSksCj4+IC0JCQkgICB5ZXNubyhwaXBlX2NvbmZpZy0+YmFzZS5hY3RpdmUpLAo+PiArCQkJ
ICAgeWVzbm8ocGlwZV9jb25maWctPmh3LmFjdGl2ZSksCj4+ICAJCQkgICBwaXBlX2NvbmZpZy0+
cGlwZV9zcmNfdywgcGlwZV9jb25maWctPnBpcGVfc3JjX2gsCj4+ICAJCQkgICB5ZXNubyhwaXBl
X2NvbmZpZy0+ZGl0aGVyKSwgcGlwZV9jb25maWctPnBpcGVfYnBwKTsKPj4gIAo+PiAtCQlpZiAo
cGlwZV9jb25maWctPmJhc2UuYWN0aXZlKSB7Cj4+ICsJCWlmIChwaXBlX2NvbmZpZy0+aHcuYWN0
aXZlKSB7Cj4+ICAJCQlzdHJ1Y3QgaW50ZWxfcGxhbmUgKmN1cnNvciA9Cj4+ICAJCQkJdG9faW50
ZWxfcGxhbmUoY3J0Yy0+YmFzZS5jdXJzb3IpOwo+PiAgCj4+IEBAIC00MjA0LDExICs0MjA0LDEx
IEBAIHN0YXRpYyBpbnQgaTkxNV9kcnJzX2N0bF9zZXQodm9pZCAqZGF0YSwgdTY0IHZhbCkKPj4g
IAo+PiAgCQljcnRjX3N0YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRl
KTsKPj4gIAo+PiAtCQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlIHx8Cj4+ICsJCWlmICgh
Y3J0Y19zdGF0ZS0+aHcuYWN0aXZlIHx8Cj4+ICAJCSAgICAhY3J0Y19zdGF0ZS0+aGFzX2RycnMp
Cj4+ICAJCQlnb3RvIG91dDsKPj4gIAo+PiAtCQljb21taXQgPSBjcnRjX3N0YXRlLT5iYXNlLmNv
bW1pdDsKPj4gKwkJY29tbWl0ID0gY3J0Y19zdGF0ZS0+dWFwaS5jb21taXQ7Cj4+ICAJCWlmIChj
b21taXQpIHsKPj4gIAkJCXJldCA9IHdhaXRfZm9yX2NvbXBsZXRpb25faW50ZXJydXB0aWJsZSgm
Y29tbWl0LT5od19kb25lKTsKPj4gIAkJCWlmIChyZXQpCj4+IEBAIC00MjIwLDcgKzQyMjAsNyBA
QCBzdGF0aWMgaW50IGk5MTVfZHJyc19jdGxfc2V0KHZvaWQgKmRhdGEsIHU2NCB2YWwpCj4+ICAJ
CQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcjsKPj4gIAkJCXN0cnVjdCBpbnRlbF9kcCAq
aW50ZWxfZHA7Cj4+ICAKPj4gLQkJCWlmICghKGNydGNfc3RhdGUtPmJhc2UuY29ubmVjdG9yX21h
c2sgJgo+PiArCQkJaWYgKCEoY3J0Y19zdGF0ZS0+dWFwaS5jb25uZWN0b3JfbWFzayAmCj4+ICAJ
CQkgICAgICBkcm1fY29ubmVjdG9yX21hc2soY29ubmVjdG9yKSkpCj4+ICAJCQkJY29udGludWU7
Cj4+ICAKPj4gQEAgLTQyNzksMTQgKzQyNzksMTQgQEAgaTkxNV9maWZvX3VuZGVycnVuX3Jlc2V0
X3dyaXRlKHN0cnVjdCBmaWxlICpmaWxwLAo+PiAgCQkJcmV0dXJuIHJldDsKPj4gIAo+PiAgCQlj
cnRjX3N0YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0ZShpbnRlbF9jcnRjLT5iYXNlLnN0YXRlKTsK
Pj4gLQkJY29tbWl0ID0gY3J0Y19zdGF0ZS0+YmFzZS5jb21taXQ7Cj4+ICsJCWNvbW1pdCA9IGNy
dGNfc3RhdGUtPnVhcGkuY29tbWl0Owo+PiAgCQlpZiAoY29tbWl0KSB7Cj4+ICAJCQlyZXQgPSB3
YWl0X2Zvcl9jb21wbGV0aW9uX2ludGVycnVwdGlibGUoJmNvbW1pdC0+aHdfZG9uZSk7Cj4+ICAJ
CQlpZiAoIXJldCkKPj4gIAkJCQlyZXQgPSB3YWl0X2Zvcl9jb21wbGV0aW9uX2ludGVycnVwdGli
bGUoJmNvbW1pdC0+ZmxpcF9kb25lKTsKPj4gIAkJfQo+PiAgCj4+IC0JCWlmICghcmV0ICYmIGNy
dGNfc3RhdGUtPmJhc2UuYWN0aXZlKSB7Cj4+ICsJCWlmICghcmV0ICYmIGNydGNfc3RhdGUtPmh3
LmFjdGl2ZSkgewo+PiAgCQkJRFJNX0RFQlVHX0tNUygiUmUtYXJtaW5nIEZJRk8gdW5kZXJydW5z
IG9uIHBpcGUgJWNcbiIsCj4+ICAJCQkJICAgICAgcGlwZV9uYW1lKGludGVsX2NydGMtPnBpcGUp
KTsKPj4gIAo+PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKPj4gaW5kZXggNmFhNDBmNTQ2MjI2Li5l
ZGFiZjJjZjQ0NDAgMTAwNjQ0Cj4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Bt
LmMKPj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwo+PiBAQCAtNDg0LDcg
KzQ4NCw3IEBAIHN0YXRpYyBjb25zdCBpbnQgcGVzc2ltYWxfbGF0ZW5jeV9ucyA9IDUwMDA7Cj4+
ICAKPj4gIHN0YXRpYyB2b2lkIHZsdl9nZXRfZmlmb19zaXplKHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9f
aW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+
PiAgCXN0cnVjdCB2bHZfZmlmb19zdGF0ZSAqZmlmb19zdGF0ZSA9ICZjcnRjX3N0YXRlLT53bS52
bHYuZmlmb19zdGF0ZTsKPj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+IEBAIC04
MTgsNyArODE4LDcgQEAgc3RhdGljIGJvb2wgaW50ZWxfd21fcGxhbmVfdmlzaWJsZShjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIAlzdHJ1Y3QgaW50ZWxfcGxh
bmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUpOwo+PiAg
Cj4+ICAJLyogRklYTUUgY2hlY2sgdGhlICdlbmFibGUnIGluc3RlYWQgKi8KPj4gLQlpZiAoIWNy
dGNfc3RhdGUtPmJhc2UuYWN0aXZlKQo+PiArCWlmICghY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+
PiAgCQlyZXR1cm4gZmFsc2U7Cj4+ICAKPj4gIAkvKgo+PiBAQCAtODcxLDcgKzg3MSw3IEBAIHN0
YXRpYyB2b2lkIHBpbmV2aWV3X3VwZGF0ZV93bShzdHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2Ny
dGMpCj4+ICAJY3J0YyA9IHNpbmdsZV9lbmFibGVkX2NydGMoZGV2X3ByaXYpOwo+PiAgCWlmIChj
cnRjKSB7Cj4+ICAJCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2Rl
ID0KPj4gLQkJCSZjcnRjLT5jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4gKwkJCSZjcnRj
LT5jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVi
dWZmZXIgKmZiID0KPj4gIAkJCWNydGMtPmJhc2UucHJpbWFyeS0+c3RhdGUtPmZiOwo+PiAgCQlp
bnQgY3BwID0gZmItPmZvcm1hdC0+Y3BwWzBdOwo+PiBAQCAtMTEwNyw3ICsxMTA3LDcgQEAgc3Rh
dGljIHUxNiBnNHhfY29tcHV0ZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwKPj4gIAlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUo
cGxhbmVfc3RhdGUtPmJhc2UucGxhbmUpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmJhc2UuZGV2KTsKPj4gIAljb25zdCBzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4+IC0JCSZjcnRjX3N0YXRlLT5iYXNlLmFk
anVzdGVkX21vZGU7Cj4+ICsJCSZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwo+PiAgCXVu
c2lnbmVkIGludCBsYXRlbmN5ID0gZGV2X3ByaXYtPndtLnByaV9sYXRlbmN5W2xldmVsXSAqIDEw
Owo+PiAgCXVuc2lnbmVkIGludCBjbG9jaywgaHRvdGFsLCBjcHAsIHdpZHRoLCB3bTsKPj4gIAo+
PiBAQCAtMTE2Nyw3ICsxMTY3LDcgQEAgc3RhdGljIHUxNiBnNHhfY29tcHV0ZV93bShjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIHN0YXRpYyBib29sIGc0eF9y
YXdfcGxhbmVfd21fc2V0KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAg
CQkJCSBpbnQgbGV2ZWwsIGVudW0gcGxhbmVfaWQgcGxhbmVfaWQsIHUxNiB2YWx1ZSkKPj4gIHsK
Pj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3Rh
dGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPj4gIAlib29sIGRpcnR5
ID0gZmFsc2U7Cj4+ICAKPj4gIAlmb3IgKDsgbGV2ZWwgPCBpbnRlbF93bV9udW1fbGV2ZWxzKGRl
dl9wcml2KTsgbGV2ZWwrKykgewo+PiBAQCAtMTE4Myw3ICsxMTgzLDcgQEAgc3RhdGljIGJvb2wg
ZzR4X3Jhd19wbGFuZV93bV9zZXQoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
Cj4+ICBzdGF0aWMgYm9vbCBnNHhfcmF3X2ZiY193bV9zZXQoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUsCj4+ICAJCQkgICAgICAgaW50IGxldmVsLCB1MTYgdmFsdWUpCj4+ICB7
Cj4+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0
YXRlLT5iYXNlLmNydGMtPmRldik7Cj4+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4+ICAJYm9vbCBkaXJ0
eSA9IGZhbHNlOwo+PiAgCj4+ICAJLyogTk9STUFMIGxldmVsIGRvZXNuJ3QgaGF2ZSBhbiBGQkMg
d2F0ZXJtYXJrICovCj4+IEBAIC0xMjg1LDcgKzEyODUsNyBAQCBzdGF0aWMgYm9vbCBnNHhfcmF3
X3BsYW5lX3dtX2lzX3ZhbGlkKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAo+PiAgc3RhdGljIGJvb2wgZzR4X3Jhd19jcnRjX3dtX2lzX3ZhbGlkKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCQkJCSAgICAgaW50IGxldmVsKQo+
PiAgewo+PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+PiAgCj4+ICAJ
aWYgKGxldmVsID4gZGV2X3ByaXYtPndtLm1heF9sZXZlbCkKPj4gIAkJcmV0dXJuIGZhbHNlOwo+
PiBAQCAtMTMyMyw5ICsxMzIzLDkgQEAgc3RhdGljIHZvaWQgZzR4X2ludmFsaWRhdGVfd21zKHN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjLAo+PiAgCj4+ICBzdGF0aWMgaW50IGc0eF9jb21wdXRlX3Bp
cGVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0
Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3Rh
dGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUgPQo+
PiAtCQl0b19pbnRlbF9hdG9taWNfc3RhdGUoY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZSk7Cj4+ICsJ
CXRvX2ludGVsX2F0b21pY19zdGF0ZShjcnRjX3N0YXRlLT51YXBpLnN0YXRlKTsKPj4gIAlzdHJ1
Y3QgZzR4X3dtX3N0YXRlICp3bV9zdGF0ZSA9ICZjcnRjX3N0YXRlLT53bS5nNHgub3B0aW1hbDsK
Pj4gIAlpbnQgbnVtX2FjdGl2ZV9wbGFuZXMgPSBod2VpZ2h0OChjcnRjX3N0YXRlLT5hY3RpdmVf
cGxhbmVzICYKPj4gIAkJCQkJIH5CSVQoUExBTkVfQ1VSU09SKSk7Cj4+IEBAIC0xNDEyLDE3ICsx
NDEyLDE3IEBAIHN0YXRpYyBpbnQgZzR4X2NvbXB1dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIAo+PiAgc3RhdGljIGludCBnNHhfY29tcHV0ZV9pbnRl
cm1lZGlhdGVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+PiAg
ewo+PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19z
dGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMobmV3X2NydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGc0eF93bV9zdGF0
ZSAqaW50ZXJtZWRpYXRlID0gJm5ld19jcnRjX3N0YXRlLT53bS5nNHguaW50ZXJtZWRpYXRlOwo+
PiAgCWNvbnN0IHN0cnVjdCBnNHhfd21fc3RhdGUgKm9wdGltYWwgPSAmbmV3X2NydGNfc3RhdGUt
PndtLmc0eC5vcHRpbWFsOwo+PiAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0
YXRlID0KPj4gLQkJdG9faW50ZWxfYXRvbWljX3N0YXRlKG5ld19jcnRjX3N0YXRlLT5iYXNlLnN0
YXRlKTsKPj4gKwkJdG9faW50ZWxfYXRvbWljX3N0YXRlKG5ld19jcnRjX3N0YXRlLT51YXBpLnN0
YXRlKTsKPj4gIAljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUg
PQo+PiAgCQlpbnRlbF9hdG9taWNfZ2V0X29sZF9jcnRjX3N0YXRlKGludGVsX3N0YXRlLCBjcnRj
KTsKPj4gIAljb25zdCBzdHJ1Y3QgZzR4X3dtX3N0YXRlICphY3RpdmUgPSAmb2xkX2NydGNfc3Rh
dGUtPndtLmc0eC5vcHRpbWFsOwo+PiAgCWVudW0gcGxhbmVfaWQgcGxhbmVfaWQ7Cj4+ICAKPj4g
LQlpZiAoIW5ld19jcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSB8fCBkcm1fYXRvbWljX2NydGNfbmVl
ZHNfbW9kZXNldCgmbmV3X2NydGNfc3RhdGUtPmJhc2UpKSB7Cj4+ICsJaWYgKCFuZXdfY3J0Y19z
dGF0ZS0+aHcuYWN0aXZlIHx8IGRybV9hdG9taWNfY3J0Y19uZWVkc19tb2Rlc2V0KCZuZXdfY3J0
Y19zdGF0ZS0+dWFwaSkpIHsKPj4gIAkJKmludGVybWVkaWF0ZSA9ICpvcHRpbWFsOwo+PiAgCj4+
ICAJCWludGVybWVkaWF0ZS0+Y3hzciA9IGZhbHNlOwo+PiBAQCAtMTU1NCw4ICsxNTU0LDggQEAg
c3RhdGljIHZvaWQgZzR4X3Byb2dyYW1fd2F0ZXJtYXJrcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4+ICBzdGF0aWMgdm9pZCBnNHhfaW5pdGlhbF93YXRlcm1hcmtzKHN0cnVj
dCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+PiAgCQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+PiAtCXN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMp
Owo+PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19z
dGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9f
aW50ZWxfY3J0YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCj4+ICAJbXV0ZXhfbG9jaygm
ZGV2X3ByaXYtPndtLndtX211dGV4KTsKPj4gIAljcnRjLT53bS5hY3RpdmUuZzR4ID0gY3J0Y19z
dGF0ZS0+d20uZzR4LmludGVybWVkaWF0ZTsKPj4gQEAgLTE1NjYsOCArMTU2Niw4IEBAIHN0YXRp
YyB2b2lkIGc0eF9pbml0aWFsX3dhdGVybWFya3Moc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUsCj4+ICBzdGF0aWMgdm9pZCBnNHhfb3B0aW1pemVfd2F0ZXJtYXJrcyhzdHJ1Y3QgaW50
ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPj4gIAkJCQkgICAgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4+IC0Jc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+
ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRl
LT51YXBpLmNydGMtPmRldik7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRl
bF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAKPj4gIAlpZiAoIWNydGNfc3RhdGUt
PndtLm5lZWRfcG9zdHZibF91cGRhdGUpCj4+ICAJCXJldHVybjsKPj4gQEAgLTE2MTYsNyArMTYx
Niw3IEBAIHN0YXRpYyB1MTYgdmx2X2NvbXB1dGVfd21fbGV2ZWwoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9
IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lKTsKPj4gIAlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4+ICAJ
Y29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+PiAtCQkmY3J0
Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCQkmY3J0Y19zdGF0ZS0+aHcuYWRqdXN0
ZWRfbW9kZTsKPj4gIAl1bnNpZ25lZCBpbnQgY2xvY2ssIGh0b3RhbCwgY3BwLCB3aWR0aCwgd207
Cj4+ICAKPj4gIAlpZiAoZGV2X3ByaXYtPndtLnByaV9sYXRlbmN5W2xldmVsXSA9PSAwKQo+PiBA
QCAtMTY1NCw3ICsxNjU0LDcgQEAgc3RhdGljIGJvb2wgdmx2X25lZWRfc3ByaXRlMF9maWZvX3dv
cmthcm91bmQodW5zaWduZWQgaW50IGFjdGl2ZV9wbGFuZXMpCj4+ICAKPj4gIHN0YXRpYyBpbnQg
dmx2X2NvbXB1dGVfZmlmbyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4g
IHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2Ny
dGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAljb25zdCBzdHJ1Y3QgZzR4X3BpcGVfd20g
KnJhdyA9Cj4+ICAJCSZjcnRjX3N0YXRlLT53bS52bHYucmF3W1ZMVl9XTV9MRVZFTF9QTTJdOwo+
PiAgCXN0cnVjdCB2bHZfZmlmb19zdGF0ZSAqZmlmb19zdGF0ZSA9ICZjcnRjX3N0YXRlLT53bS52
bHYuZmlmb19zdGF0ZTsKPj4gQEAgLTE3NjYsNyArMTc2Niw3IEBAIHN0YXRpYyB1MTYgdmx2X2lu
dmVydF93bV92YWx1ZSh1MTYgd20sIHUxNiBmaWZvX3NpemUpCj4+ICBzdGF0aWMgYm9vbCB2bHZf
cmF3X3BsYW5lX3dtX3NldChzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4g
IAkJCQkgaW50IGxldmVsLCBlbnVtIHBsYW5lX2lkIHBsYW5lX2lkLCB1MTYgdmFsdWUpCj4+ICB7
Cj4+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0
YXRlLT5iYXNlLmNydGMtPmRldik7Cj4+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4+ICAJaW50IG51bV9s
ZXZlbHMgPSBpbnRlbF93bV9udW1fbGV2ZWxzKGRldl9wcml2KTsKPj4gIAlib29sIGRpcnR5ID0g
ZmFsc2U7Cj4+ICAKPj4gQEAgLTE4NDEsMTYgKzE4NDEsMTYgQEAgc3RhdGljIGJvb2wgdmx2X3Jh
d19jcnRjX3dtX2lzX3ZhbGlkKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLAo+PiAgCj4+ICBzdGF0aWMgaW50IHZsdl9jb21wdXRlX3BpcGVfd20oc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNy
dGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+
ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNl
LmRldik7Cj4+ICAJc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUgPQo+PiAtCQl0b19p
bnRlbF9hdG9taWNfc3RhdGUoY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZSk7Cj4+ICsJCXRvX2ludGVs
X2F0b21pY19zdGF0ZShjcnRjX3N0YXRlLT51YXBpLnN0YXRlKTsKPj4gIAlzdHJ1Y3Qgdmx2X3dt
X3N0YXRlICp3bV9zdGF0ZSA9ICZjcnRjX3N0YXRlLT53bS52bHYub3B0aW1hbDsKPj4gIAljb25z
dCBzdHJ1Y3Qgdmx2X2ZpZm9fc3RhdGUgKmZpZm9fc3RhdGUgPQo+PiAgCQkmY3J0Y19zdGF0ZS0+
d20udmx2LmZpZm9fc3RhdGU7Cj4+ICAJaW50IG51bV9hY3RpdmVfcGxhbmVzID0gaHdlaWdodDgo
Y3J0Y19zdGF0ZS0+YWN0aXZlX3BsYW5lcyAmCj4+ICAJCQkJCSB+QklUKFBMQU5FX0NVUlNPUikp
Owo+PiAtCWJvb2wgbmVlZHNfbW9kZXNldCA9IGRybV9hdG9taWNfY3J0Y19uZWVkc19tb2Rlc2V0
KCZjcnRjX3N0YXRlLT5iYXNlKTsKPj4gKwlib29sIG5lZWRzX21vZGVzZXQgPSBkcm1fYXRvbWlj
X2NydGNfbmVlZHNfbW9kZXNldCgmY3J0Y19zdGF0ZS0+dWFwaSk7Cj4+ICAJY29uc3Qgc3RydWN0
IGludGVsX3BsYW5lX3N0YXRlICpvbGRfcGxhbmVfc3RhdGU7Cj4+ICAJY29uc3Qgc3RydWN0IGlu
dGVsX3BsYW5lX3N0YXRlICpuZXdfcGxhbmVfc3RhdGU7Cj4+ICAJc3RydWN0IGludGVsX3BsYW5l
ICpwbGFuZTsKPj4gQEAgLTE5NDksNyArMTk0OSw3IEBAIHN0YXRpYyBpbnQgdmx2X2NvbXB1dGVf
cGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHN0YXRpYyB2
b2lkIHZsdl9hdG9taWNfdXBkYXRlX2ZpZm8oc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3Rh
dGUsCj4+ICAJCQkJICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7
Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUt
PmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJc3RydWN0IGludGVsX3VuY29y
ZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Cj4+ICAJY29uc3Qgc3RydWN0IHZsdl9maWZv
X3N0YXRlICpmaWZvX3N0YXRlID0KPj4gQEAgLTIwNDUsMTcgKzIwNDUsMTcgQEAgc3RhdGljIHZv
aWQgdmx2X2F0b21pY191cGRhdGVfZmlmbyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSwKPj4gIAo+PiAgc3RhdGljIGludCB2bHZfY29tcHV0ZV9pbnRlcm1lZGlhdGVfd20oc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsK
Pj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2NydGNfc3Rh
dGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IHZsdl93bV9zdGF0ZSAqaW50ZXJtZWRpYXRlID0g
Jm5ld19jcnRjX3N0YXRlLT53bS52bHYuaW50ZXJtZWRpYXRlOwo+PiAgCWNvbnN0IHN0cnVjdCB2
bHZfd21fc3RhdGUgKm9wdGltYWwgPSAmbmV3X2NydGNfc3RhdGUtPndtLnZsdi5vcHRpbWFsOwo+
PiAgCXN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKmludGVsX3N0YXRlID0KPj4gLQkJdG9faW50
ZWxfYXRvbWljX3N0YXRlKG5ld19jcnRjX3N0YXRlLT5iYXNlLnN0YXRlKTsKPj4gKwkJdG9faW50
ZWxfYXRvbWljX3N0YXRlKG5ld19jcnRjX3N0YXRlLT51YXBpLnN0YXRlKTsKPj4gIAljb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUgPQo+PiAgCQlpbnRlbF9hdG9t
aWNfZ2V0X29sZF9jcnRjX3N0YXRlKGludGVsX3N0YXRlLCBjcnRjKTsKPj4gIAljb25zdCBzdHJ1
Y3Qgdmx2X3dtX3N0YXRlICphY3RpdmUgPSAmb2xkX2NydGNfc3RhdGUtPndtLnZsdi5vcHRpbWFs
Owo+PiAgCWludCBsZXZlbDsKPj4gIAo+PiAtCWlmICghbmV3X2NydGNfc3RhdGUtPmJhc2UuYWN0
aXZlIHx8IGRybV9hdG9taWNfY3J0Y19uZWVkc19tb2Rlc2V0KCZuZXdfY3J0Y19zdGF0ZS0+YmFz
ZSkpIHsKPj4gKwlpZiAoIW5ld19jcnRjX3N0YXRlLT5ody5hY3RpdmUgfHwgZHJtX2F0b21pY19j
cnRjX25lZWRzX21vZGVzZXQoJm5ld19jcnRjX3N0YXRlLT51YXBpKSkgewo+PiAgCQkqaW50ZXJt
ZWRpYXRlID0gKm9wdGltYWw7Cj4+ICAKPj4gIAkJaW50ZXJtZWRpYXRlLT5jeHNyID0gZmFsc2U7
Cj4+IEBAIC0yMTczLDggKzIxNzMsOCBAQCBzdGF0aWMgdm9pZCB2bHZfcHJvZ3JhbV93YXRlcm1h
cmtzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPj4gIHN0YXRpYyB2b2lkIHZs
dl9pbml0aWFsX3dhdGVybWFya3Moc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4+
ICAJCQkJICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5i
YXNlLmNydGMtPmRldik7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4+ICsJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0
Yyk7Cj4+ICAKPj4gIAltdXRleF9sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+PiAgCWNy
dGMtPndtLmFjdGl2ZS52bHYgPSBjcnRjX3N0YXRlLT53bS52bHYuaW50ZXJtZWRpYXRlOwo+PiBA
QCAtMjE4NSw4ICsyMTg1LDggQEAgc3RhdGljIHZvaWQgdmx2X2luaXRpYWxfd2F0ZXJtYXJrcyhz
dHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPj4gIHN0YXRpYyB2b2lkIHZsdl9vcHRp
bWl6ZV93YXRlcm1hcmtzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+PiAgCQkJ
CSAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2Uu
Y3J0Yy0+ZGV2KTsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMo
Y3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKPj4gKwlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsK
Pj4gIAo+PiAgCWlmICghY3J0Y19zdGF0ZS0+d20ubmVlZF9wb3N0dmJsX3VwZGF0ZSkKPj4gIAkJ
cmV0dXJuOwo+PiBAQCAtMjIxMSw3ICsyMjExLDcgQEAgc3RhdGljIHZvaWQgaTk2NV91cGRhdGVf
d20oc3RydWN0IGludGVsX2NydGMgKnVudXNlZF9jcnRjKQo+PiAgCQkvKiBzZWxmLXJlZnJlc2gg
aGFzIG11Y2ggaGlnaGVyIGxhdGVuY3kgKi8KPj4gIAkJc3RhdGljIGNvbnN0IGludCBzcl9sYXRl
bmN5X25zID0gMTIwMDA7Cj4+ICAJCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1
c3RlZF9tb2RlID0KPj4gLQkJCSZjcnRjLT5jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9kZTsKPj4g
KwkJCSZjcnRjLT5jb25maWctPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJCWNvbnN0IHN0cnVjdCBk
cm1fZnJhbWVidWZmZXIgKmZiID0KPj4gIAkJCWNydGMtPmJhc2UucHJpbWFyeS0+c3RhdGUtPmZi
Owo+PiAgCQlpbnQgY2xvY2sgPSBhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrOwo+PiBAQCAtMjI5
Miw3ICsyMjkyLDcgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfd20oc3RydWN0IGludGVsX2Ny
dGMgKnVudXNlZF9jcnRjKQo+PiAgCWNydGMgPSBpbnRlbF9nZXRfY3J0Y19mb3JfcGxhbmUoZGV2
X3ByaXYsIFBMQU5FX0EpOwo+PiAgCWlmIChpbnRlbF9jcnRjX2FjdGl2ZShjcnRjKSkgewo+PiAg
CQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4+IC0JCQkm
Y3J0Yy0+Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJCQkmY3J0Yy0+Y29uZmlnLT5o
dy5hZGp1c3RlZF9tb2RlOwo+PiAgCQljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9
Cj4+ICAJCQljcnRjLT5iYXNlLnByaW1hcnktPnN0YXRlLT5mYjsKPj4gIAkJaW50IGNwcDsKPj4g
QEAgLTIzMTksNyArMjMxOSw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfdXBkYXRlX3dtKHN0cnVjdCBp
bnRlbF9jcnRjICp1bnVzZWRfY3J0YykKPj4gIAljcnRjID0gaW50ZWxfZ2V0X2NydGNfZm9yX3Bs
YW5lKGRldl9wcml2LCBQTEFORV9CKTsKPj4gIAlpZiAoaW50ZWxfY3J0Y19hY3RpdmUoY3J0Yykp
IHsKPj4gIAkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGUgPQo+
PiAtCQkJJmNydGMtPmNvbmZpZy0+YmFzZS5hZGp1c3RlZF9tb2RlOwo+PiArCQkJJmNydGMtPmNv
bmZpZy0+aHcuYWRqdXN0ZWRfbW9kZTsKPj4gIAkJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZl
ciAqZmIgPQo+PiAgCQkJY3J0Yy0+YmFzZS5wcmltYXJ5LT5zdGF0ZS0+ZmI7Cj4+ICAJCWludCBj
cHA7Cj4+IEBAIC0yMzY3LDcgKzIzNjcsNyBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV93bShz
dHJ1Y3QgaW50ZWxfY3J0YyAqdW51c2VkX2NydGMpCj4+ICAJCS8qIHNlbGYtcmVmcmVzaCBoYXMg
bXVjaCBoaWdoZXIgbGF0ZW5jeSAqLwo+PiAgCQlzdGF0aWMgY29uc3QgaW50IHNyX2xhdGVuY3lf
bnMgPSA2MDAwOwo+PiAgCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRf
bW9kZSA9Cj4+IC0JCQkmZW5hYmxlZC0+Y29uZmlnLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4+ICsJ
CQkmZW5hYmxlZC0+Y29uZmlnLT5ody5hZGp1c3RlZF9tb2RlOwo+PiAgCQljb25zdCBzdHJ1Y3Qg
ZHJtX2ZyYW1lYnVmZmVyICpmYiA9Cj4+ICAJCQllbmFibGVkLT5iYXNlLnByaW1hcnktPnN0YXRl
LT5mYjsKPj4gIAkJaW50IGNsb2NrID0gYWRqdXN0ZWRfbW9kZS0+Y3J0Y19jbG9jazsKPj4gQEAg
LTI0MjUsNyArMjQyNSw3IEBAIHN0YXRpYyB2b2lkIGk4NDVfdXBkYXRlX3dtKHN0cnVjdCBpbnRl
bF9jcnRjICp1bnVzZWRfY3J0YykKPj4gIAlpZiAoY3J0YyA9PSBOVUxMKQo+PiAgCQlyZXR1cm47
Cj4+ICAKPj4gLQlhZGp1c3RlZF9tb2RlID0gJmNydGMtPmNvbmZpZy0+YmFzZS5hZGp1c3RlZF9t
b2RlOwo+PiArCWFkanVzdGVkX21vZGUgPSAmY3J0Yy0+Y29uZmlnLT5ody5hZGp1c3RlZF9tb2Rl
Owo+PiAgCXBsYW5lYV93bSA9IGludGVsX2NhbGN1bGF0ZV93bShhZGp1c3RlZF9tb2RlLT5jcnRj
X2Nsb2NrLAo+PiAgCQkJCSAgICAgICAmaTg0NV93bV9pbmZvLAo+PiAgCQkJCSAgICAgICBkZXZf
cHJpdi0+ZGlzcGxheS5nZXRfZmlmb19zaXplKGRldl9wcml2LCBQTEFORV9BKSwKPj4gQEAgLTI1
MTUsNyArMjUxNSw3IEBAIHN0YXRpYyB1MzIgaWxrX2NvbXB1dGVfcHJpX3dtKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCQlyZXR1cm4gbWV0aG9kMTsKPj4g
IAo+PiAgCW1ldGhvZDIgPSBpbGtfd21fbWV0aG9kMihjcnRjX3N0YXRlLT5waXhlbF9yYXRlLAo+
PiAtCQkJCSBjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19odG90YWwsCj4+ICsJ
CQkJIGNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGUuY3J0Y19odG90YWwsCj4+ICAJCQkJIGRy
bV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+YmFzZS5kc3QpLAo+PiAgCQkJCSBjcHAsIG1lbV92
YWx1ZSk7Cj4+ICAKPj4gQEAgLTI1NDMsNyArMjU0Myw3IEBAIHN0YXRpYyB1MzIgaWxrX2NvbXB1
dGVfc3ByX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAg
Cj4+ICAJbWV0aG9kMSA9IGlsa193bV9tZXRob2QxKGNydGNfc3RhdGUtPnBpeGVsX3JhdGUsIGNw
cCwgbWVtX3ZhbHVlKTsKPj4gIAltZXRob2QyID0gaWxrX3dtX21ldGhvZDIoY3J0Y19zdGF0ZS0+
cGl4ZWxfcmF0ZSwKPj4gLQkJCQkgY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNf
aHRvdGFsLAo+PiArCQkJCSBjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFs
LAo+PiAgCQkJCSBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUtPmJhc2UuZHN0KSwKPj4gIAkJ
CQkgY3BwLCBtZW1fdmFsdWUpOwo+PiAgCXJldHVybiBtaW4obWV0aG9kMSwgbWV0aG9kMik7Cj4+
IEBAIC0yNTY4LDcgKzI1NjgsNyBAQCBzdGF0aWMgdTMyIGlsa19jb21wdXRlX2N1cl93bShjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIAljcHAgPSBwbGFuZV9z
dGF0ZS0+YmFzZS5mYi0+Zm9ybWF0LT5jcHBbMF07Cj4+ICAKPj4gIAlyZXR1cm4gaWxrX3dtX21l
dGhvZDIoY3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZSwKPj4gLQkJCSAgICAgIGNydGNfc3RhdGUtPmJh
c2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCwKPj4gKwkJCSAgICAgIGNydGNfc3RhdGUtPmh3
LmFkanVzdGVkX21vZGUuY3J0Y19odG90YWwsCj4+ICAJCQkgICAgICBwbGFuZV9zdGF0ZS0+YmFz
ZS5jcnRjX3csIGNwcCwgbWVtX3ZhbHVlKTsKPj4gIH0KPj4gIAo+PiBAQCAtMjc4OSwxMiArMjc4
OSwxMiBAQCBzdGF0aWMgdTMyCj4+ICBoc3dfY29tcHV0ZV9saW5ldGltZV93bShjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gIAljb25zdCBzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICppbnRlbF9zdGF0ZSA9Cj4+IC0JCXRvX2ludGVsX2F0b21pY19z
dGF0ZShjcnRjX3N0YXRlLT5iYXNlLnN0YXRlKTsKPj4gKwkJdG9faW50ZWxfYXRvbWljX3N0YXRl
KGNydGNfc3RhdGUtPnVhcGkuc3RhdGUpOwo+PiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICphZGp1c3RlZF9tb2RlID0KPj4gLQkJJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9k
ZTsKPj4gKwkJJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGU7Cj4+ICAJdTMyIGxpbmV0aW1l
LCBpcHNfbGluZXRpbWU7Cj4+ICAKPj4gLQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlKQo+
PiArCWlmICghY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+PiAgCQlyZXR1cm4gMDsKPj4gIAlpZiAo
V0FSTl9PTihhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrID09IDApKQo+PiAgCQlyZXR1cm4gMDsK
Pj4gQEAgLTMxMDQsMTEgKzMxMDQsOSBAQCBzdGF0aWMgYm9vbCBpbGtfdmFsaWRhdGVfcGlwZV93
bShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4+ICAvKiBDb21wdXRl
IG5ldyB3YXRlcm1hcmtzIGZvciB0aGUgcGlwZSAqLwo+PiAgc3RhdGljIGludCBpbGtfY29tcHV0
ZV9waXBlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgewo+PiAt
CXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IGNydGNfc3RhdGUtPmJhc2Uuc3RhdGU7
Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4+ICsJc3RydWN0IGludGVs
X2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7
Cj4+ICAJc3RydWN0IGludGVsX3BpcGVfd20gKnBpcGVfd207Cj4+IC0Jc3RydWN0IGRybV9kZXZp
Y2UgKmRldiA9IHN0YXRlLT5kZXY7Cj4+IC0JY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+PiAgCXN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lOwo+
PiAgCWNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlOwo+PiAgCWNvbnN0
IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcHJpc3RhdGUgPSBOVUxMOwo+PiBAQCAtMzExOSw3
ICszMTE3LDcgQEAgc3RhdGljIGludCBpbGtfY29tcHV0ZV9waXBlX3dtKHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgCj4+ICAJcGlwZV93bSA9ICZjcnRjX3N0YXRlLT53
bS5pbGsub3B0aW1hbDsKPj4gIAo+PiAtCWRybV9hdG9taWNfY3J0Y19zdGF0ZV9mb3JfZWFjaF9w
bGFuZV9zdGF0ZShwbGFuZSwgcGxhbmVfc3RhdGUsICZjcnRjX3N0YXRlLT5iYXNlKSB7Cj4+ICsJ
ZHJtX2F0b21pY19jcnRjX3N0YXRlX2Zvcl9lYWNoX3BsYW5lX3N0YXRlKHBsYW5lLCBwbGFuZV9z
dGF0ZSwgJmNydGNfc3RhdGUtPnVhcGkpIHsKPj4gIAkJY29uc3Qgc3RydWN0IGludGVsX3BsYW5l
X3N0YXRlICpwcyA9IHRvX2ludGVsX3BsYW5lX3N0YXRlKHBsYW5lX3N0YXRlKTsKPj4gIAo+PiAg
CQlpZiAocGxhbmUtPnR5cGUgPT0gRFJNX1BMQU5FX1RZUEVfUFJJTUFSWSkKPj4gQEAgLTMxMzAs
NyArMzEyOCw3IEBAIHN0YXRpYyBpbnQgaWxrX2NvbXB1dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4gIAkJCWN1cnN0YXRlID0gcHM7Cj4+ICAJfQo+PiAg
Cj4+IC0JcGlwZV93bS0+cGlwZV9lbmFibGVkID0gY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmU7Cj4+
ICsJcGlwZV93bS0+cGlwZV9lbmFibGVkID0gY3J0Y19zdGF0ZS0+aHcuYWN0aXZlOwo+PiAgCWlm
IChzcHJzdGF0ZSkgewo+PiAgCQlwaXBlX3dtLT5zcHJpdGVzX2VuYWJsZWQgPSBzcHJzdGF0ZS0+
YmFzZS52aXNpYmxlOwo+PiAgCQlwaXBlX3dtLT5zcHJpdGVzX3NjYWxlZCA9IHNwcnN0YXRlLT5i
YXNlLnZpc2libGUgJiYKPj4gQEAgLTMxODcsMTEgKzMxODUsMTEgQEAgc3RhdGljIGludCBpbGtf
Y29tcHV0ZV9waXBlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAg
ICovCj4+ICBzdGF0aWMgaW50IGlsa19jb21wdXRlX2ludGVybWVkaWF0ZV93bShzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqbmV3c3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmlu
dGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKG5ld3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVj
dCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhuZXdzdGF0ZS0+dWFwaS5j
cnRjKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGlu
dGVsX2NydGMtPmJhc2UuZGV2KTsKPj4gIAlzdHJ1Y3QgaW50ZWxfcGlwZV93bSAqYSA9ICZuZXdz
dGF0ZS0+d20uaWxrLmludGVybWVkaWF0ZTsKPj4gIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
ICppbnRlbF9zdGF0ZSA9Cj4+IC0JCXRvX2ludGVsX2F0b21pY19zdGF0ZShuZXdzdGF0ZS0+YmFz
ZS5zdGF0ZSk7Cj4+ICsJCXRvX2ludGVsX2F0b21pY19zdGF0ZShuZXdzdGF0ZS0+dWFwaS5zdGF0
ZSk7Cj4+ICAJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZHN0YXRlID0KPj4gIAkJ
aW50ZWxfYXRvbWljX2dldF9vbGRfY3J0Y19zdGF0ZShpbnRlbF9zdGF0ZSwgaW50ZWxfY3J0Yyk7
Cj4+ICAJY29uc3Qgc3RydWN0IGludGVsX3BpcGVfd20gKmIgPSAmb2xkc3RhdGUtPndtLmlsay5v
cHRpbWFsOwo+PiBAQCAtMzIwMyw3ICszMjAxLDcgQEAgc3RhdGljIGludCBpbGtfY29tcHV0ZV9p
bnRlcm1lZGlhdGVfd20oc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld3N0YXRlKQo+PiAgCSAq
IGFuZCBhZnRlciB0aGUgdmJsYW5rLgo+PiAgCSAqLwo+PiAgCSphID0gbmV3c3RhdGUtPndtLmls
ay5vcHRpbWFsOwo+PiAtCWlmICghbmV3c3RhdGUtPmJhc2UuYWN0aXZlIHx8IGRybV9hdG9taWNf
Y3J0Y19uZWVkc19tb2Rlc2V0KCZuZXdzdGF0ZS0+YmFzZSkgfHwKPj4gKwlpZiAoIW5ld3N0YXRl
LT5ody5hY3RpdmUgfHwgZHJtX2F0b21pY19jcnRjX25lZWRzX21vZGVzZXQoJm5ld3N0YXRlLT51
YXBpKSB8fAo+PiAgCSAgICBpbnRlbF9zdGF0ZS0+c2tpcF9pbnRlcm1lZGlhdGVfd20pCj4+ICAJ
CXJldHVybiAwOwo+PiAgCj4+IEBAIC0zNzgwLDcgKzM3NzgsNyBAQCBib29sIGludGVsX2Nhbl9l
bmFibGVfc2FndihzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPj4gIAljcnRjID0g
aW50ZWxfZ2V0X2NydGNfZm9yX3BpcGUoZGV2X3ByaXYsIHBpcGUpOwo+PiAgCWNydGNfc3RhdGUg
PSB0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uuc3RhdGUpOwo+PiAgCj4+IC0JaWYgKGNy
dGMtPmJhc2Uuc3RhdGUtPmFkanVzdGVkX21vZGUuZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0lOVEVS
TEFDRSkKPj4gKwlpZiAoY3J0Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZS5mbGFncyAmIERSTV9N
T0RFX0ZMQUdfSU5URVJMQUNFKQo+PiAgCQlyZXR1cm4gZmFsc2U7Cj4+ICAKPj4gIAlmb3JfZWFj
aF9pbnRlbF9wbGFuZV9vbl9jcnRjKGRldiwgY3J0YywgcGxhbmUpIHsKPj4gQEAgLTM4MzAsNyAr
MzgyOCw3IEBAIHN0YXRpYyB1MTYgaW50ZWxfZ2V0X2RkYl9zaXplKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKPj4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDExKQo+PiAg
CQlyZXR1cm4gZGRiX3NpemUgLSA0OyAvKiA0IGJsb2NrcyBmb3IgYnlwYXNzIHBhdGggYWxsb2Nh
dGlvbiAqLwo+PiAgCj4+IC0JYWRqdXN0ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5iYXNlLmFkanVz
dGVkX21vZGU7Cj4+ICsJYWRqdXN0ZWRfbW9kZSA9ICZjcnRjX3N0YXRlLT5ody5hZGp1c3RlZF9t
b2RlOwo+PiAgCXRvdGFsX2RhdGFfYncgPSB0b3RhbF9kYXRhX3JhdGUgKiBkcm1fbW9kZV92cmVm
cmVzaChhZGp1c3RlZF9tb2RlKTsKPj4gIAo+PiAgCS8qCj4+IEBAIC0zODU5LDE2ICszODU3LDE2
IEBAIHNrbF9kZGJfZ2V0X3BpcGVfYWxsb2NhdGlvbl9saW1pdHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAo+PiAgCQkJCSAgIHN0cnVjdCBza2xfZGRiX2VudHJ5ICphbGxvYywg
Lyogb3V0ICovCj4+ICAJCQkJICAgaW50ICpudW1fYWN0aXZlIC8qIG91dCAqLykKPj4gIHsKPj4g
LQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBjcnRjX3N0YXRlLT5iYXNlLnN0YXRl
Owo+PiArCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IGNydGNfc3RhdGUtPnVhcGku
c3RhdGU7Cj4+ICAJc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqaW50ZWxfc3RhdGUgPSB0b19p
bnRlbF9hdG9taWNfc3RhdGUoc3RhdGUpOwo+PiAtCXN0cnVjdCBkcm1fY3J0YyAqZm9yX2NydGMg
PSBjcnRjX3N0YXRlLT5iYXNlLmNydGM7Cj4+ICsJc3RydWN0IGRybV9jcnRjICpmb3JfY3J0YyA9
IGNydGNfc3RhdGUtPnVhcGkuY3J0YzsKPj4gIAljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0
YzsKPj4gIAl1MzIgcGlwZV93aWR0aCA9IDAsIHRvdGFsX3dpZHRoID0gMCwgd2lkdGhfYmVmb3Jl
X3BpcGUgPSAwOwo+PiAgCWVudW0gcGlwZSBmb3JfcGlwZSA9IHRvX2ludGVsX2NydGMoZm9yX2Ny
dGMpLT5waXBlOwo+PiAgCXUxNiBkZGJfc2l6ZTsKPj4gIAl1MzIgaTsKPj4gIAo+PiAtCWlmIChX
QVJOX09OKCFzdGF0ZSkgfHwgIWNydGNfc3RhdGUtPmJhc2UuYWN0aXZlKSB7Cj4+ICsJaWYgKFdB
Uk5fT04oIXN0YXRlKSB8fCAhY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKSB7Cj4+ICAJCWFsbG9jLT5z
dGFydCA9IDA7Cj4+ICAJCWFsbG9jLT5lbmQgPSAwOwo+PiAgCQkqbnVtX2FjdGl2ZSA9IGh3ZWln
aHQ4KGRldl9wcml2LT5hY3RpdmVfcGlwZXMpOwo+PiBAQCAtMzkwNywxMSArMzkwNSwxMSBAQCBz
a2xfZGRiX2dldF9waXBlX2FsbG9jYXRpb25fbGltaXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKPj4gIAkgKi8KPj4gIAlmb3JfZWFjaF9uZXdfaW50ZWxfY3J0Y19pbl9zdGF0
ZShpbnRlbF9zdGF0ZSwgY3J0YywgY3J0Y19zdGF0ZSwgaSkgewo+PiAgCQljb25zdCBzdHJ1Y3Qg
ZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Cj4+IC0JCQkmY3J0Y19zdGF0ZS0+YmFz
ZS5hZGp1c3RlZF9tb2RlOwo+PiArCQkJJmNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGU7Cj4+
ICAJCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPj4gIAkJaW50IGhkaXNwbGF5LCB2ZGlz
cGxheTsKPj4gIAo+PiAtCQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuZW5hYmxlKQo+PiArCQlpZiAo
IWNydGNfc3RhdGUtPmh3LmVuYWJsZSkKPj4gIAkJCWNvbnRpbnVlOwo+PiAgCj4+ICAJCWRybV9t
b2RlX2dldF9odl90aW1pbmcoYWRqdXN0ZWRfbW9kZSwgJmhkaXNwbGF5LCAmdmRpc3BsYXkpOwo+
PiBAQCAtMzk0Miw3ICszOTQwLDcgQEAgc3RhdGljIHVuc2lnbmVkIGludAo+PiAgc2tsX2N1cnNv
cl9hbGxvY2F0aW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
PiAgCQkgICAgICBpbnQgbnVtX2FjdGl2ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUt
PnVhcGkuY3J0Yy0+ZGV2KTsKPj4gIAlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhf
bGV2ZWwoZGV2X3ByaXYpOwo+PiAgCXN0cnVjdCBza2xfd21fbGV2ZWwgd20gPSB7fTsKPj4gIAlp
bnQgcmV0LCBtaW5fZGRiX2FsbG9jID0gMDsKPj4gQEAgLTQxMTEsNyArNDEwOSw3IEBAIHNrbF9w
aXBlX2Rvd25zY2FsZV9hbW91bnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpCj4+ICB7Cj4+ICAJdWludF9maXhlZF8xNl8xNl90IHBpcGVfZG93bnNjYWxlID0gdTMy
X3RvX2ZpeGVkMTYoMSk7Cj4+ICAKPj4gLQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuZW5hYmxlKQo+
PiArCWlmICghY3J0Y19zdGF0ZS0+aHcuZW5hYmxlKQo+PiAgCQlyZXR1cm4gcGlwZV9kb3duc2Nh
bGU7Cj4+ICAKPj4gIAlpZiAoY3J0Y19zdGF0ZS0+cGNoX3BmaXQuZW5hYmxlZCkgewo+PiBAQCAt
NDE0Myw3ICs0MTQxLDcgQEAgaW50IHNrbF9jaGVja19waXBlX21heF9waXhlbF9yYXRlKHN0cnVj
dCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAo+PiAgCQkJCSAgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0gdG9faTkxNShpbnRlbF9jcnRjLT5iYXNlLmRldik7Cj4+IC0Jc3RydWN0IGRybV9hdG9t
aWNfc3RhdGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPj4gKwlzdHJ1Y3QgZHJt
X2F0b21pY19zdGF0ZSAqc3RhdGUgPSBjcnRjX3N0YXRlLT51YXBpLnN0YXRlOwo+PiAgCXN0cnVj
dCBkcm1fcGxhbmUgKnBsYW5lOwo+PiAgCWNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKmRy
bV9wbGFuZV9zdGF0ZTsKPj4gIAlpbnQgY3J0Y19jbG9jaywgZG90Y2xrOwo+PiBAQCAtNDE1MSwx
MCArNDE0OSwxMCBAQCBpbnQgc2tsX2NoZWNrX3BpcGVfbWF4X3BpeGVsX3JhdGUoc3RydWN0IGlu
dGVsX2NydGMgKmludGVsX2NydGMsCj4+ICAJdWludF9maXhlZF8xNl8xNl90IHBpcGVfZG93bnNj
YWxlOwo+PiAgCXVpbnRfZml4ZWRfMTZfMTZfdCBtYXhfZG93bnNjYWxlID0gdTMyX3RvX2ZpeGVk
MTYoMSk7Cj4+ICAKPj4gLQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuZW5hYmxlKQo+PiArCWlmICgh
Y3J0Y19zdGF0ZS0+aHcuZW5hYmxlKQo+PiAgCQlyZXR1cm4gMDsKPj4gIAo+PiAtCWRybV9hdG9t
aWNfY3J0Y19zdGF0ZV9mb3JfZWFjaF9wbGFuZV9zdGF0ZShwbGFuZSwgZHJtX3BsYW5lX3N0YXRl
LCAmY3J0Y19zdGF0ZS0+YmFzZSkgewo+PiArCWRybV9hdG9taWNfY3J0Y19zdGF0ZV9mb3JfZWFj
aF9wbGFuZV9zdGF0ZShwbGFuZSwgZHJtX3BsYW5lX3N0YXRlLCAmY3J0Y19zdGF0ZS0+dWFwaSkg
ewo+PiAgCQl1aW50X2ZpeGVkXzE2XzE2X3QgcGxhbmVfZG93bnNjYWxlOwo+PiAgCQl1aW50X2Zp
eGVkXzE2XzE2X3QgZnBfOV9kaXZfOCA9IGRpdl9maXhlZDE2KDksIDgpOwo+PiAgCQlpbnQgYnBw
Owo+PiBAQCAtNDE3OSw3ICs0MTc3LDcgQEAgaW50IHNrbF9jaGVja19waXBlX21heF9waXhlbF9y
YXRlKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAo+PiAgCj4+ICAJcGlwZV9kb3duc2Nh
bGUgPSBtdWxfZml4ZWQxNihwaXBlX2Rvd25zY2FsZSwgbWF4X2Rvd25zY2FsZSk7Cj4+ICAKPj4g
LQljcnRjX2Nsb2NrID0gY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2s7
Cj4+ICsJY3J0Y19jbG9jayA9IGNydGNfc3RhdGUtPmh3LmFkanVzdGVkX21vZGUuY3J0Y19jbG9j
azsKPj4gIAlkb3RjbGsgPSB0b19pbnRlbF9hdG9taWNfc3RhdGUoc3RhdGUpLT5jZGNsay5sb2dp
Y2FsLmNkY2xrOwo+PiAgCj4+ICAJaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTApCj4+IEBAIC00MjQ2LDcgKzQyNDQsNyBAQCBza2xfZ2V0X3Rv
dGFsX3JlbGF0aXZlX2RhdGFfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKPj4gIAkJCQkgdTY0ICpwbGFuZV9kYXRhX3JhdGUsCj4+ICAJCQkJIHU2NCAqdXZfcGxhbmVf
ZGF0YV9yYXRlKQo+PiAgewo+PiAtCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IGNy
dGNfc3RhdGUtPmJhc2Uuc3RhdGU7Cj4+ICsJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRl
ID0gY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZTsKPj4gIAlzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZTsK
Pj4gIAljb25zdCBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpkcm1fcGxhbmVfc3RhdGU7Cj4+ICAJ
dTY0IHRvdGFsX2RhdGFfcmF0ZSA9IDA7Cj4+IEBAIC00MjU1LDcgKzQyNTMsNyBAQCBza2xfZ2V0
X3RvdGFsX3JlbGF0aXZlX2RhdGFfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwKPj4gIAkJcmV0dXJuIDA7Cj4+ICAKPj4gIAkvKiBDYWxjdWxhdGUgYW5kIGNhY2hlIGRh
dGEgcmF0ZSBmb3IgZWFjaCBwbGFuZSAqLwo+PiAtCWRybV9hdG9taWNfY3J0Y19zdGF0ZV9mb3Jf
ZWFjaF9wbGFuZV9zdGF0ZShwbGFuZSwgZHJtX3BsYW5lX3N0YXRlLCAmY3J0Y19zdGF0ZS0+YmFz
ZSkgewo+PiArCWRybV9hdG9taWNfY3J0Y19zdGF0ZV9mb3JfZWFjaF9wbGFuZV9zdGF0ZShwbGFu
ZSwgZHJtX3BsYW5lX3N0YXRlLCAmY3J0Y19zdGF0ZS0+dWFwaSkgewo+PiAgCQllbnVtIHBsYW5l
X2lkIHBsYW5lX2lkID0gdG9faW50ZWxfcGxhbmUocGxhbmUpLT5pZDsKPj4gIAkJY29uc3Qgc3Ry
dWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSA9Cj4+ICAJCQl0b19pbnRlbF9wbGFu
ZV9zdGF0ZShkcm1fcGxhbmVfc3RhdGUpOwo+PiBAQCAtNDI4MywxMSArNDI4MSwxMSBAQCBpY2xf
Z2V0X3RvdGFsX3JlbGF0aXZlX2RhdGFfcmF0ZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSwKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpkcm1fcGxhbmVfc3Rh
dGU7Cj4+ICAJdTY0IHRvdGFsX2RhdGFfcmF0ZSA9IDA7Cj4+ICAKPj4gLQlpZiAoV0FSTl9PTigh
Y3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZSkpCj4+ICsJaWYgKFdBUk5fT04oIWNydGNfc3RhdGUtPnVh
cGkuc3RhdGUpKQo+PiAgCQlyZXR1cm4gMDsKPj4gIAo+PiAgCS8qIENhbGN1bGF0ZSBhbmQgY2Fj
aGUgZGF0YSByYXRlIGZvciBlYWNoIHBsYW5lICovCj4+IC0JZHJtX2F0b21pY19jcnRjX3N0YXRl
X2Zvcl9lYWNoX3BsYW5lX3N0YXRlKHBsYW5lLCBkcm1fcGxhbmVfc3RhdGUsICZjcnRjX3N0YXRl
LT5iYXNlKSB7Cj4+ICsJZHJtX2F0b21pY19jcnRjX3N0YXRlX2Zvcl9lYWNoX3BsYW5lX3N0YXRl
KHBsYW5lLCBkcm1fcGxhbmVfc3RhdGUsICZjcnRjX3N0YXRlLT51YXBpKSB7Cj4+ICAJCWNvbnN0
IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUgPQo+PiAgCQkJdG9faW50ZWxf
cGxhbmVfc3RhdGUoZHJtX3BsYW5lX3N0YXRlKTsKPj4gIAkJZW51bSBwbGFuZV9pZCBwbGFuZV9p
ZCA9IHRvX2ludGVsX3BsYW5lKHBsYW5lKS0+aWQ7Cj4+IEBAIC00MzI5LDggKzQzMjcsOCBAQCBz
dGF0aWMgaW50Cj4+ICBza2xfYWxsb2NhdGVfcGlwZV9kZGIoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUsCj4+ICAJCSAgICAgIHN0cnVjdCBza2xfZGRiX2FsbG9jYXRpb24gKmRk
YiAvKiBvdXQgKi8pCj4+ICB7Cj4+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0g
Y3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPj4gLQlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBjcnRj
X3N0YXRlLT5iYXNlLmNydGM7Cj4+ICsJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0g
Y3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZTsKPj4gKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBjcnRj
X3N0YXRlLT51YXBpLmNydGM7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+PiAgCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRj
ID0gdG9faW50ZWxfY3J0YyhjcnRjKTsKPj4gIAlzdHJ1Y3Qgc2tsX2RkYl9lbnRyeSAqYWxsb2Mg
PSAmY3J0Y19zdGF0ZS0+d20uc2tsLmRkYjsKPj4gQEAgLTQzNTIsNyArNDM1MCw3IEBAIHNrbF9h
bGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4g
IAlpZiAoV0FSTl9PTighc3RhdGUpKQo+PiAgCQlyZXR1cm4gMDsKPj4gIAo+PiAtCWlmICghY3J0
Y19zdGF0ZS0+YmFzZS5hY3RpdmUpIHsKPj4gKwlpZiAoIWNydGNfc3RhdGUtPmh3LmFjdGl2ZSkg
ewo+PiAgCQlhbGxvYy0+c3RhcnQgPSBhbGxvYy0+ZW5kID0gMDsKPj4gIAkJcmV0dXJuIDA7Cj4+
ICAJfQo+PiBAQCAtNDU5NCw3ICs0NTkyLDcgQEAgaW50ZWxfZ2V0X2xpbmV0aW1lX3VzKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgCXUzMiBjcnRjX2h0b3Rh
bDsKPj4gIAl1aW50X2ZpeGVkXzE2XzE2X3QgbGluZXRpbWVfdXM7Cj4+ICAKPj4gLQlpZiAoIWNy
dGNfc3RhdGUtPmJhc2UuYWN0aXZlKQo+PiArCWlmICghY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQo+
PiAgCQlyZXR1cm4gdTMyX3RvX2ZpeGVkMTYoMCk7Cj4+ICAKPj4gIAlwaXhlbF9yYXRlID0gY3J0
Y19zdGF0ZS0+cGl4ZWxfcmF0ZTsKPj4gQEAgLTQ2MDIsNyArNDYwMCw3IEBAIGludGVsX2dldF9s
aW5ldGltZV91cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPj4g
IAlpZiAoV0FSTl9PTihwaXhlbF9yYXRlID09IDApKQo+PiAgCQlyZXR1cm4gdTMyX3RvX2ZpeGVk
MTYoMCk7Cj4+ICAKPj4gLQljcnRjX2h0b3RhbCA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRf
bW9kZS5jcnRjX2h0b3RhbDsKPj4gKwljcnRjX2h0b3RhbCA9IGNydGNfc3RhdGUtPmh3LmFkanVz
dGVkX21vZGUuY3J0Y19odG90YWw7Cj4+ICAJbGluZXRpbWVfdXMgPSBkaXZfZml4ZWQxNihjcnRj
X2h0b3RhbCAqIDEwMDAsIHBpeGVsX3JhdGUpOwo+PiAgCj4+ICAJcmV0dXJuIGxpbmV0aW1lX3Vz
Owo+PiBAQCAtNDYzNyw3ICs0NjM1LDcgQEAgc2tsX2NvbXB1dGVfd21fcGFyYW1zKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCQkgICAgICB1MzIgcGxhbmVf
cGl4ZWxfcmF0ZSwgc3RydWN0IHNrbF93bV9wYXJhbXMgKndwLAo+PiAgCQkgICAgICBpbnQgY29s
b3JfcGxhbmUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9j
cnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMg
PSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7Cj4+ICAJdTMy
IGludGVybV9wYnBsOwo+PiAgCj4+IEBAIC00NzYzLDcgKzQ3NjEsNyBAQCBzdGF0aWMgdm9pZCBz
a2xfY29tcHV0ZV9wbGFuZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwKPj4gIAkJCQkgY29uc3Qgc3RydWN0IHNrbF93bV9sZXZlbCAqcmVzdWx0X3ByZXYsCj4+
ICAJCQkJIHN0cnVjdCBza2xfd21fbGV2ZWwgKnJlc3VsdCAvKiBvdXQgKi8pCj4+ICB7Cj4+IC0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5i
YXNlLmNydGMtPmRldik7Cj4+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjX3N0YXRlLT51YXBpLmNydGMtPmRldik7Cj4+ICAJdTMyIGxhdGVuY3kgPSBk
ZXZfcHJpdi0+d20uc2tsX2xhdGVuY3lbbGV2ZWxdOwo+PiAgCXVpbnRfZml4ZWRfMTZfMTZfdCBt
ZXRob2QxLCBtZXRob2QyOwo+PiAgCXVpbnRfZml4ZWRfMTZfMTZfdCBzZWxlY3RlZF9yZXN1bHQ7
Cj4+IEBAIC00Nzg5LDE0ICs0Nzg3LDE0IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21wdXRlX3BsYW5l
X3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCW1ldGhv
ZDEgPSBza2xfd21fbWV0aG9kMShkZXZfcHJpdiwgd3AtPnBsYW5lX3BpeGVsX3JhdGUsCj4+ICAJ
CQkJIHdwLT5jcHAsIGxhdGVuY3ksIHdwLT5kYnVmX2Jsb2NrX3NpemUpOwo+PiAgCW1ldGhvZDIg
PSBza2xfd21fbWV0aG9kMih3cC0+cGxhbmVfcGl4ZWxfcmF0ZSwKPj4gLQkJCQkgY3J0Y19zdGF0
ZS0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFsLAo+PiArCQkJCSBjcnRjX3N0YXRlLT5o
dy5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFsLAo+PiAgCQkJCSBsYXRlbmN5LAo+PiAgCQkJCSB3
cC0+cGxhbmVfYmxvY2tzX3Blcl9saW5lKTsKPj4gIAo+PiAgCWlmICh3cC0+eV90aWxlZCkgewo+
PiAgCQlzZWxlY3RlZF9yZXN1bHQgPSBtYXhfZml4ZWQxNihtZXRob2QyLCB3cC0+eV90aWxlX21p
bmltdW0pOwo+PiAgCX0gZWxzZSB7Cj4+IC0JCWlmICgod3AtPmNwcCAqIGNydGNfc3RhdGUtPmJh
c2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCAvCj4+ICsJCWlmICgod3AtPmNwcCAqIGNydGNf
c3RhdGUtPmh3LmFkanVzdGVkX21vZGUuY3J0Y19odG90YWwgLwo+PiAgCQkgICAgIHdwLT5kYnVm
X2Jsb2NrX3NpemUgPCAxKSAmJgo+PiAgCQkgICAgICh3cC0+cGxhbmVfYnl0ZXNfcGVyX2xpbmUg
LyB3cC0+ZGJ1Zl9ibG9ja19zaXplIDwgMSkpIHsKPj4gIAkJCXNlbGVjdGVkX3Jlc3VsdCA9IG1l
dGhvZDI7Cj4+IEBAIC00ODg3LDcgKzQ4ODUsNyBAQCBza2xfY29tcHV0ZV93bV9sZXZlbHMoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCSAgICAgIGNvbnN0
IHN0cnVjdCBza2xfd21fcGFyYW1zICp3bV9wYXJhbXMsCj4+ICAJCSAgICAgIHN0cnVjdCBza2xf
d21fbGV2ZWwgKmxldmVscykKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPnVhcGkuY3J0
Yy0+ZGV2KTsKPj4gIAlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2
X3ByaXYpOwo+PiAgCXN0cnVjdCBza2xfd21fbGV2ZWwgKnJlc3VsdF9wcmV2ID0gJmxldmVsc1sw
XTsKPj4gIAo+PiBAQCAtNDkwNCw3ICs0OTAyLDcgQEAgc2tsX2NvbXB1dGVfd21fbGV2ZWxzKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgc3RhdGljIHUzMgo+
PiAgc2tsX2NvbXB1dGVfbGluZXRpbWVfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0g
Y3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPj4gKwlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3Rh
dGUgPSBjcnRjX3N0YXRlLT51YXBpLnN0YXRlOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmRldik7Cj4+ICAJdWludF9maXhlZF8xNl8xNl90
IGxpbmV0aW1lX3VzOwo+PiAgCXUzMiBsaW5ldGltZV93bTsKPj4gQEAgLTQ5MjMsNyArNDkyMSw3
IEBAIHN0YXRpYyB2b2lkIHNrbF9jb21wdXRlX3RyYW5zaXRpb25fd20oY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCQkJICAgICAgY29uc3Qgc3RydWN0IHNr
bF93bV9wYXJhbXMgKndwLAo+PiAgCQkJCSAgICAgIHN0cnVjdCBza2xfcGxhbmVfd20gKndtKQo+
PiAgewo+PiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjX3N0YXRlLT5iYXNlLmNydGMt
PmRldjsKPj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Y19zdGF0ZS0+dWFwaS5jcnRj
LT5kZXY7Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShkZXYpOwo+PiAgCXUxNiB0cmFuc19taW4sIHRyYW5zX3lfdGlsZV9taW47Cj4+ICAJY29u
c3QgdTE2IHRyYW5zX2Ftb3VudCA9IDEwOyAvKiBUaGlzIGlzIGNvbmZpZ3VyYWJsZSBhbW91bnQg
Ki8KPj4gQEAgLTUwODMsNyArNTA4MSw3IEBAIHN0YXRpYyBpbnQgaWNsX2J1aWxkX3BsYW5lX3dt
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCj4+ICBzdGF0aWMgaW50
IHNrbF9idWlsZF9waXBlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
PiAgewo+PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0
Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+PiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjLT5kZXYpOwo+PiAgCXN0cnVj
dCBza2xfcGlwZV93bSAqcGlwZV93bSA9ICZjcnRjX3N0YXRlLT53bS5za2wub3B0aW1hbDsKPj4g
IAlzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZTsKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX3BsYW5lX3N0
YXRlICpkcm1fcGxhbmVfc3RhdGU7Cj4+IEBAIC01MDk2LDcgKzUwOTQsNyBAQCBzdGF0aWMgaW50
IHNrbF9idWlsZF9waXBlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+
PiAgCW1lbXNldChwaXBlX3dtLT5wbGFuZXMsIDAsIHNpemVvZihwaXBlX3dtLT5wbGFuZXMpKTsK
Pj4gIAo+PiAgCWRybV9hdG9taWNfY3J0Y19zdGF0ZV9mb3JfZWFjaF9wbGFuZV9zdGF0ZShwbGFu
ZSwgZHJtX3BsYW5lX3N0YXRlLAo+PiAtCQkJCQkJICAgJmNydGNfc3RhdGUtPmJhc2UpIHsKPj4g
KwkJCQkJCSAgICZjcnRjX3N0YXRlLT51YXBpKSB7Cj4+ICAJCWNvbnN0IHN0cnVjdCBpbnRlbF9w
bGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUgPQo+PiAgCQkJdG9faW50ZWxfcGxhbmVfc3RhdGUoZHJt
X3BsYW5lX3N0YXRlKTsKPj4gIAo+PiBAQCAtNTI3NSw4ICs1MjczLDggQEAgc3RhdGljIGludAo+
PiAgc2tsX2RkYl9hZGRfYWZmZWN0ZWRfcGxhbmVzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpvbGRfY3J0Y19zdGF0ZSwKPj4gIAkJCSAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
bmV3X2NydGNfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3Rh
dGUgPSB0b19pbnRlbF9hdG9taWNfc3RhdGUobmV3X2NydGNfc3RhdGUtPmJhc2Uuc3RhdGUpOwo+
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhuZXdfY3J0Y19zdGF0
ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSA9IHRv
X2ludGVsX2F0b21pY19zdGF0ZShuZXdfY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZSk7Cj4+ICsJc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG5ld19jcnRjX3N0YXRlLT51YXBp
LmNydGMpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
Y3J0Yy0+YmFzZS5kZXYpOwo+PiAgCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmU7Cj4+ICAKPj4g
QEAgLTU1NzYsNyArNTU3NCw3IEBAIHN0YXRpYyBpbnQgc2tsX3dtX2FkZF9hZmZlY3RlZF9wbGFu
ZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4+ICAJCSAqIHBvd2VyIHdlbGwg
dGhlIGhhcmR3YXJlIHN0YXRlIHdpbGwgZ28gb3V0IG9mIHN5bmMKPj4gIAkJICogd2l0aCB0aGUg
c29mdHdhcmUgc3RhdGUuCj4+ICAJCSAqLwo+PiAtCQlpZiAoIWRybV9hdG9taWNfY3J0Y19uZWVk
c19tb2Rlc2V0KCZuZXdfY3J0Y19zdGF0ZS0+YmFzZSkgJiYKPj4gKwkJaWYgKCFkcm1fYXRvbWlj
X2NydGNfbmVlZHNfbW9kZXNldCgmbmV3X2NydGNfc3RhdGUtPnVhcGkpICYmCj4+ICAJCSAgICBz
a2xfcGxhbmVfd21fZXF1YWxzKGRldl9wcml2LAo+PiAgCQkJCQkmb2xkX2NydGNfc3RhdGUtPndt
LnNrbC5vcHRpbWFsLnBsYW5lc1twbGFuZV9pZF0sCj4+ICAJCQkJCSZuZXdfY3J0Y19zdGF0ZS0+
d20uc2tsLm9wdGltYWwucGxhbmVzW3BsYW5lX2lkXSkpCj4+IEBAIC01NjQzLDcgKzU2NDEsNyBA
QCBza2xfY29tcHV0ZV93bShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPj4gIHN0
YXRpYyB2b2lkIHNrbF9hdG9taWNfdXBkYXRlX2NydGNfd20oc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUsCj4+ICAJCQkJICAgICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7Cj4+ICsJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0
b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+ICAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5kZXYpOwo+PiAgCXN0cnVj
dCBza2xfcGlwZV93bSAqcGlwZV93bSA9ICZjcnRjX3N0YXRlLT53bS5za2wub3B0aW1hbDsKPj4g
IAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4+IEBAIC01NjU3LDcgKzU2NTUsNyBAQCBz
dGF0aWMgdm9pZCBza2xfYXRvbWljX3VwZGF0ZV9jcnRjX3dtKHN0cnVjdCBpbnRlbF9hdG9taWNf
c3RhdGUgKnN0YXRlLAo+PiAgc3RhdGljIHZvaWQgc2tsX2luaXRpYWxfd20oc3RydWN0IGludGVs
X2F0b21pY19zdGF0ZSAqc3RhdGUsCj4+ICAJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRv
X2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0
YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4g
IAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gaW50ZWxfY3J0Yy0+YmFzZS5kZXY7Cj4+ICAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwo+PiAgCXN0cnVj
dCBza2xfZGRiX3ZhbHVlcyAqcmVzdWx0cyA9ICZzdGF0ZS0+d21fcmVzdWx0czsKPj4gQEAgLTU2
NjcsNyArNTY2NSw3IEBAIHN0YXRpYyB2b2lkIHNrbF9pbml0aWFsX3dtKHN0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGUgKnN0YXRlLAo+PiAgCj4+ICAJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPndtLndt
X211dGV4KTsKPj4gIAo+PiAtCWlmIChjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZV9jaGFuZ2VkKQo+
PiArCWlmIChjcnRjX3N0YXRlLT51YXBpLmFjdGl2ZV9jaGFuZ2VkKQo+PiAgCQlza2xfYXRvbWlj
X3VwZGF0ZV9jcnRjX3dtKHN0YXRlLCBjcnRjX3N0YXRlKTsKPj4gIAo+PiAgCW11dGV4X3VubG9j
aygmZGV2X3ByaXYtPndtLndtX211dGV4KTsKPj4gQEAgLTU3MjYsOCArNTcyNCw4IEBAIHN0YXRp
YyB2b2lkIGlsa19wcm9ncmFtX3dhdGVybWFya3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQo+PiAgc3RhdGljIHZvaWQgaWxrX2luaXRpYWxfd2F0ZXJtYXJrcyhzdHJ1Y3QgaW50
ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPj4gIAkJCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsKPj4gLQlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjKTsKPj4g
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUt
PnVhcGkuY3J0Yy0+ZGV2KTsKPj4gKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVs
X2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKPj4gIAo+PiAgCW11dGV4X2xvY2soJmRldl9w
cml2LT53bS53bV9tdXRleCk7Cj4+ICAJY3J0Yy0+d20uYWN0aXZlLmlsayA9IGNydGNfc3RhdGUt
PndtLmlsay5pbnRlcm1lZGlhdGU7Cj4+IEBAIC01NzM4LDggKzU3MzYsOCBAQCBzdGF0aWMgdm9p
ZCBpbGtfaW5pdGlhbF93YXRlcm1hcmtzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
LAo+PiAgc3RhdGljIHZvaWQgaWxrX29wdGltaXplX3dhdGVybWFya3Moc3RydWN0IGludGVsX2F0
b21pY19zdGF0ZSAqc3RhdGUsCj4+ICAJCQkJICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+PiAtCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+dWFw
aS5jcnRjLT5kZXYpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0
YyhjcnRjX3N0YXRlLT51YXBpLmNydGMpOwo+PiAgCj4+ICAJaWYgKCFjcnRjX3N0YXRlLT53bS5u
ZWVkX3Bvc3R2YmxfdXBkYXRlKQo+PiAgCQlyZXR1cm47Cj4+IC0tIAo+PiAyLjIwLjEKPj4KPj4g
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KPj4gSW50ZWwt
Z2Z4IG1haWxpbmcgbGlzdAo+PiBJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCj4+IGh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4CgoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4
IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

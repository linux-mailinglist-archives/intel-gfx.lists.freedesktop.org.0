Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 97E927E104
	for <lists+intel-gfx@lfdr.de>; Thu,  1 Aug 2019 19:24:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0007B6E746;
	Thu,  1 Aug 2019 17:24:55 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 83DEA6E746
 for <intel-gfx@lists.freedesktop.org>; Thu,  1 Aug 2019 17:24:55 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by fmsmga102.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 01 Aug 2019 10:24:54 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,334,1559545200"; d="scan'208";a="184315165"
Received: from gadevlin-mobl.ger.corp.intel.com (HELO [10.251.95.57])
 ([10.251.95.57])
 by orsmga002.jf.intel.com with ESMTP; 01 Aug 2019 10:24:52 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190730112151.5633-1-chris@chris-wilson.co.uk>
 <20190730112151.5633-3-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <459d6860-f0e2-16ed-62ea-c860baac1970@linux.intel.com>
Date: Thu, 1 Aug 2019 18:24:50 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20190730112151.5633-3-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 2/3] drm/i915: Allow sharing the
 idle-barrier from other kernel requests
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDMwLzA3LzIwMTkgMTI6MjEsIENocmlzIFdpbHNvbiB3cm90ZToKPiBCeSBwbGFjaW5nIG91
ciBpZGxlLWJhcnJpZXJzIGluIHRoZSBpOTE1X2FjdGl2ZSBmZW5jZSB0cmVlLCB3ZSBleHBvc2UK
PiB0aG9zZSBmb3IgcmV1c2UgYnkgb3RoZXIgY29tcG9uZW50cyB0aGF0IGFyZSBpc3N1aW5nIHJl
cXVlc3RzIGFsb25nIHRoZQo+IGtlcm5lbF9jb250ZXh0LiBSZXVzaW5nIHRoZSBwcm90by1iYXJy
aWVyIGFjdGl2ZV9ub2RlIGlzIHBlcmZlY3RseSBmaW5lCj4gYXMgdGhlIG5ldyByZXF1ZXN0IGlt
cGxpZXMgYSBjb250ZXh0LXN3aXRjaCwgYW5kIHNvIGFuIG9wcG9ydHVuZSBwb2ludAo+IHRvIHJ1
biB0aGUgaWRsZS1iYXJyaWVyLiBIb3dldmVyLCB0aGUgcHJvdG8tYmFycmllciBpcyBub3QgZXF1
aXZhbGVudAo+IHRvIGEgbm9ybWFsIGFjdGl2ZV9ub2RlIGFuZCBjYXJlIG11c3QgYmUgdGFrZW4g
dG8gYXZvaWQgZGVyZWZlcmVuY2luZyB0aGUKPiBFUlJfUFRSIHVzZWQgYXMgaXRzIHJlcXVlc3Qg
bWFya2VyLgo+IAo+IFJlcG9ydGVkLWJ5OiBMaW9uZWwgTGFuZHdlcmxpbiA8bGlvbmVsLmcubGFu
ZHdlcmxpbkBpbnRlbC5jb20+Cj4gRml4ZXM6IGNlNDc2YzgwYjhiZiAoImRybS9pOTE1OiBLZWVw
IGNvbnRleHRzIHBpbm5lZCB1bnRpbCBhZnRlciB0aGUgbmV4dCBrZXJuZWwgY29udGV4dCBzd2l0
Y2giKQo+IEZpeGVzOiBhOTg3N2RhMmQ2MjkgKCJkcm0vaTkxNS9vYTogUmVjb25maWd1cmUgY29u
dGV4dHMgb24gdGhlIGZseSIpCj4gU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0Bj
aHJpcy13aWxzb24uY28udWs+Cj4gQ2M6IExpb25lbCBMYW5kd2VybGluIDxsaW9uZWwuZy5sYW5k
d2VybGluQGludGVsLmNvbT4KPiBDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGlu
dGVsLmNvbT4KPiAtLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQu
YyAgICAgICB8ICA0MCArKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRl
eHQuaCAgICAgICB8ICAxMyArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5n
aW5lX3BtLmMgICAgIHwgICAyICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVz
dF9jb250ZXh0LmMgICAgfCAzMTAgKysrKysrKysrKysrKysrKysrCj4gICBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2FjdGl2ZS5jICAgICAgICAgICAgfCAyNDYgKysrKysrKysrKystLS0KPiAg
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmggICAgICAgICAgICB8ICAgMiArLQo+
ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMuaCAgICAgIHwgICAyICst
Cj4gICAuLi4vZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfbGl2ZV9zZWxmdGVzdHMuaCAgfCAgIDMg
Ky0KPiAgIDggZmlsZXMgY2hhbmdlZCwgNTU1IGluc2VydGlvbnMoKyksIDYzIGRlbGV0aW9ucygt
KQo+ICAgY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X2NvbnRleHQuYwo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKPiBp
bmRleCBkNjRiNDVmN2VjNmQuLjIxMWFjNjU2OGE1ZCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9jb250ZXh0LmMKPiBAQCAtMTYyLDIzICsxNjIsNDEgQEAgc3RhdGljIGludCBf
X2ludGVsX2NvbnRleHRfYWN0aXZlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqYWN0aXZlKQo+ICAgCWlm
IChlcnIpCj4gICAJCWdvdG8gZXJyX3Jpbmc7Cj4gICAKPiArCXJldHVybiAwOwo+ICsKPiArZXJy
X3Jpbmc6Cj4gKwlpbnRlbF9yaW5nX3VucGluKGNlLT5yaW5nKTsKPiArZXJyX3B1dDoKPiArCWlu
dGVsX2NvbnRleHRfcHV0KGNlKTsKPiArCXJldHVybiBlcnI7Cj4gK30KPiArCj4gK2ludCBpbnRl
bF9jb250ZXh0X2FjdGl2ZV9hY3F1aXJlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKPiArewo+
ICsJaW50IGVycjsKPiArCj4gKwllcnIgPSBpOTE1X2FjdGl2ZV9hY3F1aXJlKCZjZS0+YWN0aXZl
KTsKPiArCWlmIChlcnIpCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gICAJLyogUHJlYWxsb2NhdGUg
dHJhY2tpbmcgbm9kZXMgKi8KPiAgIAlpZiAoIWk5MTVfZ2VtX2NvbnRleHRfaXNfa2VybmVsKGNl
LT5nZW1fY29udGV4dCkpIHsKPiAgIAkJZXJyID0gaTkxNV9hY3RpdmVfYWNxdWlyZV9wcmVhbGxv
Y2F0ZV9iYXJyaWVyKCZjZS0+YWN0aXZlLAo+ICAgCQkJCQkJCSAgICAgIGNlLT5lbmdpbmUpOwo+
IC0JCWlmIChlcnIpCj4gLQkJCWdvdG8gZXJyX3N0YXRlOwo+ICsJCWlmIChlcnIpIHsKPiArCQkJ
aTkxNV9hY3RpdmVfcmVsZWFzZSgmY2UtPmFjdGl2ZSk7Cj4gKwkJCXJldHVybiBlcnI7Cj4gKwkJ
fQo+ICAgCX0KPiAgIAo+ICAgCXJldHVybiAwOwo+ICt9Cj4gICAKPiAtZXJyX3N0YXRlOgo+IC0J
X19jb250ZXh0X3VucGluX3N0YXRlKGNlLT5zdGF0ZSk7Cj4gLWVycl9yaW5nOgo+IC0JaW50ZWxf
cmluZ191bnBpbihjZS0+cmluZyk7Cj4gLWVycl9wdXQ6Cj4gLQlpbnRlbF9jb250ZXh0X3B1dChj
ZSk7Cj4gLQlyZXR1cm4gZXJyOwo+ICt2b2lkIGludGVsX2NvbnRleHRfYWN0aXZlX3JlbGVhc2Uo
c3RydWN0IGludGVsX2NvbnRleHQgKmNlKQo+ICt7Cj4gKwkvKiBOb2RlcyBwcmVhbGxvY2F0ZWQg
aW4gaW50ZWxfY29udGV4dF9hY3RpdmUoKSAqLwo+ICsJaTkxNV9hY3RpdmVfYWNxdWlyZV9iYXJy
aWVyKCZjZS0+YWN0aXZlKTsKPiArCWk5MTVfYWN0aXZlX3JlbGVhc2UoJmNlLT5hY3RpdmUpOwo+
ICAgfQo+ICAgCj4gICB2b2lkCj4gQEAgLTI5NywzICszMTUsNyBAQCBzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICppbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSkKPiAgIAo+ICAgCXJldHVybiBycTsKPiAgIH0KPiArCj4gKyNpZiBJU19FTkFCTEVEKENPTkZJ
R19EUk1fSTkxNV9TRUxGVEVTVCkKPiArI2luY2x1ZGUgInNlbGZ0ZXN0X2NvbnRleHQuYyIKPiAr
I2VuZGlmCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRl
eHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuaAo+IGluZGV4IDIz
YzdlNGMwY2U3Yy4uMDdmOTkyNGRlNDhmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2NvbnRleHQuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2NvbnRleHQuaAo+IEBAIC0xMDQsMTcgKzEwNCw4IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBp
bnRlbF9jb250ZXh0X2V4aXQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQo+ICAgCQljZS0+b3Bz
LT5leGl0KGNlKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW5saW5lIGludCBpbnRlbF9jb250ZXh0
X2FjdGl2ZV9hY3F1aXJlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKPiAtewo+IC0JcmV0dXJu
IGk5MTVfYWN0aXZlX2FjcXVpcmUoJmNlLT5hY3RpdmUpOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW5s
aW5lIHZvaWQgaW50ZWxfY29udGV4dF9hY3RpdmVfcmVsZWFzZShzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UpCj4gLXsKPiAtCS8qIE5vZGVzIHByZWFsbG9jYXRlZCBpbiBpbnRlbF9jb250ZXh0X2Fj
dGl2ZSgpICovCj4gLQlpOTE1X2FjdGl2ZV9hY3F1aXJlX2JhcnJpZXIoJmNlLT5hY3RpdmUpOwo+
IC0JaTkxNV9hY3RpdmVfcmVsZWFzZSgmY2UtPmFjdGl2ZSk7Cj4gLX0KPiAraW50IGludGVsX2Nv
bnRleHRfYWN0aXZlX2FjcXVpcmUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKTsKPiArdm9pZCBp
bnRlbF9jb250ZXh0X2FjdGl2ZV9yZWxlYXNlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSk7Cj4g
ICAKPiAgIHN0YXRpYyBpbmxpbmUgc3RydWN0IGludGVsX2NvbnRleHQgKmludGVsX2NvbnRleHRf
Z2V0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKPiAgIHsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9lbmdpbmVfcG0uYwo+IGluZGV4IGU3NGZiZjA0YTY4ZC4uY2U1NDA5MjQ3NWRh
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKPiBAQCAt
OTAsNyArOTAsNyBAQCBzdGF0aWMgYm9vbCBzd2l0Y2hfdG9fa2VybmVsX2NvbnRleHQoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ICAgCS8qIENoZWNrIGFnYWluIG9uIHRoZSBuZXh0
IHJldGlyZW1lbnQuICovCj4gICAJZW5naW5lLT53YWtlcmVmX3NlcmlhbCA9IGVuZ2luZS0+c2Vy
aWFsICsgMTsKPiAgIAo+IC0JaTkxNV9yZXF1ZXN0X2FkZF9iYXJyaWVycyhycSk7Cj4gKwlpOTE1
X3JlcXVlc3RfYWRkX2FjdGl2ZV9iYXJyaWVycyhycSk7Cj4gICAJX19pOTE1X3JlcXVlc3RfY29t
bWl0KHJxKTsKPiAgIAo+ICAgCXJldHVybiBmYWxzZTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Qvc2VsZnRlc3RfY29udGV4dC5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAw
MDAwMDAwMDAuLmQzOWI1NTk0Y2IwMgo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9jb250ZXh0LmMKPiBAQCAtMCwwICsxLDMxMCBAQAo+ICsv
Kgo+ICsgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAo+ICsgKgo+ICsgKiBDb3B5
cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlICJp
OTE1X3NlbGZ0ZXN0LmgiCj4gKyNpbmNsdWRlICJpbnRlbF9ndC5oIgo+ICsKPiArI2luY2x1ZGUg
ImdlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmgiCj4gKyNpbmNsdWRlICJzZWxmdGVzdHMvaWd0
X2ZsdXNoX3Rlc3QuaCIKPiArI2luY2x1ZGUgInNlbGZ0ZXN0cy9tb2NrX2RybS5oIgo+ICsKPiAr
c3RhdGljIGludCByZXF1ZXN0X3N5bmMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCj4gK3sKPiAr
CWxvbmcgdGltZW91dDsKPiArCWludCBlcnIgPSAwOwo+ICsKPiArCWk5MTVfcmVxdWVzdF9nZXQo
cnEpOwo+ICsKPiArCWk5MTVfcmVxdWVzdF9hZGQocnEpOwo+ICsJdGltZW91dCA9IGk5MTVfcmVx
dWVzdF93YWl0KHJxLCAwLCBIWiAvIDEwKTsKPiArCWlmICh0aW1lb3V0IDwgMCkKPiArCQllcnIg
PSB0aW1lb3V0Owo+ICsJZWxzZQo+ICsJCWk5MTVfcmVxdWVzdF9yZXRpcmVfdXB0byhycSk7Cj4g
Kwo+ICsJaTkxNV9yZXF1ZXN0X3B1dChycSk7Cj4gKwo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsK
PiArc3RhdGljIGludCBjb250ZXh0X3N5bmMoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQo+ICt7
Cj4gKwlzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsID0gY2UtPnJpbmctPnRpbWVsaW5lOwo+ICsJ
aW50IGVyciA9IDA7Cj4gKwo+ICsJZG8gewo+ICsJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwo+
ICsJCWxvbmcgdGltZW91dDsKPiArCj4gKwkJcmN1X3JlYWRfbG9jaygpOwo+ICsJCXJxID0gcmN1
X2RlcmVmZXJlbmNlKHRsLT5sYXN0X3JlcXVlc3QucmVxdWVzdCk7Cj4gKwkJaWYgKHJxKQo+ICsJ
CQlycSA9IGk5MTVfcmVxdWVzdF9nZXRfcmN1KHJxKTsKPiArCQlyY3VfcmVhZF91bmxvY2soKTsK
PiArCQlpZiAoIXJxKQo+ICsJCQlicmVhazsKPiArCj4gKwkJdGltZW91dCA9IGk5MTVfcmVxdWVz
dF93YWl0KHJxLCAwLCBIWiAvIDEwKTsKPiArCQlpZiAodGltZW91dCA8IDApCj4gKwkJCWVyciA9
IHRpbWVvdXQ7Cj4gKwkJZWxzZQo+ICsJCQlpOTE1X3JlcXVlc3RfcmV0aXJlX3VwdG8ocnEpOwo+
ICsKPiArCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKPiArCX0gd2hpbGUgKCFlcnIpOwo+ICsKPiAr
CXJldHVybiBlcnI7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgX19saXZlX2FjdGl2ZV9jb250ZXh0
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKPiArCQkJCSBzdHJ1Y3QgaTkxNV9nZW1f
Y29udGV4dCAqZml4bWUpCj4gK3sKPiArCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKPiArCWlu
dCBwYXNzOwo+ICsJaW50IGVycjsKPiArCj4gKwkvKgo+ICsJICogV2Uga2VlcCBhY3RpdmUgY29u
dGV4dHMgYWxpdmUgdW50aWwgYWZ0ZXIgYSBzdWJzZXF1ZW50IGNvbnRleHQKPiArCSAqIHN3aXRj
aCBhcyB0aGUgZmluYWwgd3JpdGUgZnJvbSB0aGUgY29udGV4dC1zYXZlIHdpbGwgYmUgYWZ0ZXIK
PiArCSAqIHdlIHJldGlyZSB0aGUgZmluYWwgcmVxdWVzdC4gV2UgdHJhY2sgd2hlbiB3ZSB1bnBp
biB0aGUgY29udGV4dCwKPiArCSAqIHVuZGVyIHRoZSBwcmVzdW1wdGlvbiB0aGF0IHRoZSBmaW5h
bCBwaW4gaXMgZnJvbSB0aGUgbGFzdCByZXF1ZXN0LAo+ICsJICogYW5kIGluc3RlYWQgb2YgaW1t
ZWRpYXRlbHkgdW5waW5uaW5nIHRoZSBjb250ZXh0LCB3ZSBhZGQgYSB0YXNrCj4gKwkgKiB0byB1
bnBpbiB0aGUgY29udGV4dCBmcm9tIHRoZSBuZXh0IGlkbGUtYmFycmllci4KPiArCSAqCj4gKwkg
KiBUaGlzIHRlc3QgbWFrZXMgc3VyZSB0aGF0IHRoZSBjb250ZXh0IGlzIGtlcHQgYWxpdmUgdW50
aWwgYQo+ICsJICogc3Vic2VxdWVudCBpZGxlLWJhcnJpZXIgKGVtaXR0ZWQgd2hlbiB0aGUgZW5n
aW5lIHdha2VyZWYgaGl0cyAwCj4gKwkgKiB3aXRoIG5vIG1vcmUgb3V0c3RhbmRpbmcgcmVxdWVz
dHMpLgo+ICsJICovCj4gKwo+ICsJaWYgKGludGVsX2VuZ2luZV9wbV9pc19hd2FrZShlbmdpbmUp
KSB7Cj4gKwkJcHJfZXJyKCIlcyBpcyBhd2FrZSBiZWZvcmUgc3RhcnRpbmcgJXMhXG4iLAo+ICsJ
CSAgICAgICBlbmdpbmUtPm5hbWUsIF9fZnVuY19fKTsKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiAr
CX0KPiArCj4gKwljZSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGZpeG1lLCBlbmdpbmUpOwo+ICsJ
aWYgKCFjZSkKPiArCQlyZXR1cm4gLUVOT01FTTsKPiArCj4gKwlmb3IgKHBhc3MgPSAwOyBwYXNz
IDw9IDI7IHBhc3MrKykgewo+ICsJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwo+ICsKPiArCQly
cSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOwo+ICsJCWlmIChJU19FUlIocnEp
KSB7Cj4gKwkJCWVyciA9IFBUUl9FUlIocnEpOwo+ICsJCQlnb3RvIGVycjsKPiArCQl9Cj4gKwo+
ICsJCWVyciA9IHJlcXVlc3Rfc3luYyhycSk7Cj4gKwkJaWYgKGVycikKPiArCQkJZ290byBlcnI7
Cj4gKwo+ICsJCS8qIENvbnRleHQgd2lsbCBiZSBrZXB0IGFjdGl2ZSB1bnRpbCBhZnRlciBhbiBp
ZGxlLWJhcnJpZXIuICovCj4gKwkJaWYgKGk5MTVfYWN0aXZlX2lzX2lkbGUoJmNlLT5hY3RpdmUp
KSB7Cj4gKwkJCXByX2VycigiY29udGV4dCBpcyBub3QgYWN0aXZlOyBleHBlY3RlZCBpZGxlLWJh
cnJpZXIgKCVzIHBhc3MgJWQpXG4iLAo+ICsJCQkgICAgICAgZW5naW5lLT5uYW1lLCBwYXNzKTsK
PiArCQkJZXJyID0gLUVJTlZBTDsKPiArCQkJZ290byBlcnI7Cj4gKwkJfQo+ICsKPiArCQlpZiAo
IWludGVsX2VuZ2luZV9wbV9pc19hd2FrZShlbmdpbmUpKSB7Cj4gKwkJCXByX2VycigiJXMgaXMg
YXNsZWVwIGJlZm9yZSBpZGxlLWJhcnJpZXJcbiIsCj4gKwkJCSAgICAgICBlbmdpbmUtPm5hbWUp
Owo+ICsJCQllcnIgPSAtRUlOVkFMOwo+ICsJCQlnb3RvIGVycjsKPiArCQl9Cj4gKwl9Cj4gKwo+
ICsJLyogTm93IG1ha2Ugc3VyZSBvdXIgaWRsZS1iYXJyaWVycyBhcmUgZmx1c2hlZCAqLwo+ICsJ
ZXJyID0gY29udGV4dF9zeW5jKGVuZ2luZS0+a2VybmVsX2NvbnRleHQpOwo+ICsJaWYgKGVycikK
PiArCQlnb3RvIGVycjsKPiArCj4gKwlpZiAoIWk5MTVfYWN0aXZlX2lzX2lkbGUoJmNlLT5hY3Rp
dmUpKSB7Cj4gKwkJcHJfZXJyKCJjb250ZXh0IGlzIHN0aWxsIGFjdGl2ZSEiKTsKPiArCQllcnIg
PSAtRUlOVkFMOwo+ICsJfQo+ICsKPiArCWlmIChpbnRlbF9lbmdpbmVfcG1faXNfYXdha2UoZW5n
aW5lKSkgewo+ICsJCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJtX2RlYnVnX3ByaW50ZXIoX19m
dW5jX18pOwo+ICsKPiArCQlpbnRlbF9lbmdpbmVfZHVtcChlbmdpbmUsICZwLAo+ICsJCQkJICAi
JXMgaXMgc3RpbGwgYXdha2UgYWZ0ZXIgaWRsZS1iYXJyaWVyc1xuIiwKPiArCQkJCSAgZW5naW5l
LT5uYW1lKTsKPiArCQlHRU1fVFJBQ0VfRFVNUCgpOwo+ICsKPiArCQllcnIgPSAtRUlOVkFMOwo+
ICsJCWdvdG8gZXJyOwo+ICsJfQo+ICsKPiArZXJyOgo+ICsJaW50ZWxfY29udGV4dF9wdXQoY2Up
Owo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIGludCBsaXZlX2FjdGl2ZV9jb250
ZXh0KHZvaWQgKmFyZykKPiArewo+ICsJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKPiArCXN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKPiArCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0
ICpmaXhtZTsKPiArCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwo+ICsJc3RydWN0IGRybV9maWxl
ICpmaWxlOwo+ICsJaW50IGVyciA9IDA7Cj4gKwo+ICsJZmlsZSA9IG1vY2tfZmlsZShndC0+aTkx
NSk7Cj4gKwlpZiAoSVNfRVJSKGZpbGUpKQo+ICsJCXJldHVybiBQVFJfRVJSKGZpbGUpOwo+ICsK
PiArCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiArCj4gKwlmaXht
ZSA9IGxpdmVfY29udGV4dChndC0+aTkxNSwgZmlsZSk7Cj4gKwlpZiAoIWZpeG1lKSB7Cj4gKwkJ
ZXJyID0gLUVOT01FTTsKPiArCQlnb3RvIHVubG9jazsKPiArCX0KPiArCj4gKwlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKPiArCQllcnIgPSBfX2xpdmVfYWN0aXZlX2Nv
bnRleHQoZW5naW5lLCBmaXhtZSk7Cj4gKwkJaWYgKGVycikKPiArCQkJYnJlYWs7Cj4gKwo+ICsJ
CWVyciA9IGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1LCBJOTE1X1dBSVRfTE9DS0VEKTsKPiArCQlp
ZiAoZXJyKQo+ICsJCQlicmVhazsKPiArCX0KPiArCj4gK3VubG9jazoKPiArCW11dGV4X3VubG9j
aygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsJbW9ja19maWxlX2ZyZWUoZ3QtPmk5
MTUsIGZpbGUpOwo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIGludCBfX3JlbW90
ZV9zeW5jKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgc3RydWN0IGludGVsX2NvbnRleHQgKnJl
bW90ZSkKPiArewo+ICsJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Cj4gKwlpbnQgZXJyOwo+ICsK
PiArCWVyciA9IGludGVsX2NvbnRleHRfcGluKHJlbW90ZSk7Cj4gKwlpZiAoZXJyKQo+ICsJCXJl
dHVybiBlcnI7Cj4gKwo+ICsJcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KGNlKTsK
PiArCWlmIChJU19FUlIocnEpKSB7Cj4gKwkJZXJyID0gUFRSX0VSUihycSk7Cj4gKwkJZ290byB1
bnBpbjsKPiArCX0KPiArCj4gKwllcnIgPSBpbnRlbF9jb250ZXh0X3ByZXBhcmVfcmVtb3RlX3Jl
cXVlc3QocmVtb3RlLCBycSk7Cj4gKwlpZiAoZXJyKSB7Cj4gKwkJaTkxNV9yZXF1ZXN0X2FkZChy
cSk7Cj4gKwkJZ290byB1bnBpbjsKPiArCX0KPiArCj4gKwllcnIgPSByZXF1ZXN0X3N5bmMocnEp
Owo+ICsKPiArdW5waW46Cj4gKwlpbnRlbF9jb250ZXh0X3VucGluKHJlbW90ZSk7Cj4gKwlyZXR1
cm4gZXJyOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IF9fbGl2ZV9yZW1vdGVfY29udGV4dChzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCj4gKwkJCQkgc3RydWN0IGk5MTVfZ2VtX2NvbnRl
eHQgKmZpeG1lKQo+ICt7Cj4gKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqbG9jYWwsICpyZW1vdGU7
Cj4gKwlpbnQgcGFzczsKPiArCWludCBlcnI7Cj4gKwo+ICsJLyoKPiArCSAqIENoZWNrIHRoYXQg
b3VyIGlkbGUgYmFycmllcnMgZG8gbm90IGludGVyZmVyZSB3aXRoIG5vcm1hbAo+ICsJICogYWN0
aXZpdHkgdHJhY2tpbmcuIEluIHBhcnRpY3VsYXIsIGNoZWNrIHRoYXQgb3BlcmF0aW5nCj4gKwkg
KiBvbiB0aGUgY29udGV4dCBpbWFnZSByZW1vdGVseSAoaW50ZWxfY29udGV4dF9wcmVwYXJlX3Jl
bW90ZV9yZXF1ZXN0KSwKPiArCSAqIHdoaWNoIGluc2VydHMgZm9yZWlnbiBmZW5jZXMgaW50byBp
bnRlbF9jb250ZXh0LmFjdGl2ZSwgZG9lcyBub3QKPiArCSAqIGNsb2JiZXIgdGhlIGlkbGUtYmFy
cmllci4KPiArCSAqLwo+ICsKPiArCXJlbW90ZSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGZpeG1l
LCBlbmdpbmUpOwo+ICsJaWYgKCFyZW1vdGUpCj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJ
bG9jYWwgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShmaXhtZSwgZW5naW5lKTsKPiArCWlmICghbG9j
YWwpIHsKPiArCQllcnIgPSAtRU5PTUVNOwo+ICsJCWdvdG8gZXJyX3JlbW90ZTsKPiArCX0KPiAr
Cj4gKwlmb3IgKHBhc3MgPSAwOyBwYXNzIDw9IDI7IHBhc3MrKykgewo+ICsJCWVyciA9IF9fcmVt
b3RlX3N5bmMobG9jYWwsIHJlbW90ZSk7Cj4gKwkJaWYgKGVycikKPiArCQkJYnJlYWs7Cj4gKwo+
ICsJCWVyciA9IF9fcmVtb3RlX3N5bmMoZW5naW5lLT5rZXJuZWxfY29udGV4dCwgcmVtb3RlKTsK
PiArCQlpZiAoZXJyKQo+ICsJCQlicmVhazsKPiArCj4gKwkJaWYgKGk5MTVfYWN0aXZlX2lzX2lk
bGUoJnJlbW90ZS0+YWN0aXZlKSkgewo+ICsJCQlwcl9lcnIoInJlbW90ZSBjb250ZXh0IGlzIG5v
dCBhY3RpdmU7IGV4cGVjdGVkIGlkbGUtYmFycmllciAoJXMgcGFzcyAlZClcbiIsCj4gKwkJCSAg
ICAgICBlbmdpbmUtPm5hbWUsIHBhc3MpOwo+ICsJCQllcnIgPSAtRUlOVkFMOwo+ICsJCQlicmVh
azsKPiArCQl9Cj4gKwl9Cj4gKwo+ICsJaW50ZWxfY29udGV4dF9wdXQobG9jYWwpOwo+ICtlcnJf
cmVtb3RlOgo+ICsJaW50ZWxfY29udGV4dF9wdXQocmVtb3RlKTsKPiArCXJldHVybiBlcnI7Cj4g
K30KPiArCj4gK3N0YXRpYyBpbnQgbGl2ZV9yZW1vdGVfY29udGV4dCh2b2lkICphcmcpCj4gK3sK
PiArCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Cj4gKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmU7Cj4gKwlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqZml4bWU7Cj4gKwllbnVtIGlu
dGVsX2VuZ2luZV9pZCBpZDsKPiArCXN0cnVjdCBkcm1fZmlsZSAqZmlsZTsKPiArCWludCBlcnIg
PSAwOwo+ICsKPiArCWZpbGUgPSBtb2NrX2ZpbGUoZ3QtPmk5MTUpOwo+ICsJaWYgKElTX0VSUihm
aWxlKSkKPiArCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKPiArCj4gKwltdXRleF9sb2NrKCZndC0+
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwo+ICsJZml4bWUgPSBsaXZlX2NvbnRleHQoZ3Qt
Pmk5MTUsIGZpbGUpOwo+ICsJaWYgKCFmaXhtZSkgewo+ICsJCWVyciA9IC1FTk9NRU07Cj4gKwkJ
Z290byB1bmxvY2s7Cj4gKwl9Cj4gKwo+ICsJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5
MTUsIGlkKSB7Cj4gKwkJZXJyID0gX19saXZlX3JlbW90ZV9jb250ZXh0KGVuZ2luZSwgZml4bWUp
Owo+ICsJCWlmIChlcnIpCj4gKwkJCWJyZWFrOwo+ICsKPiArCQllcnIgPSBpZ3RfZmx1c2hfdGVz
dChndC0+aTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCk7Cj4gKwkJaWYgKGVycikKPiArCQkJYnJlYWs7
Cj4gKwl9Cj4gKwo+ICt1bmxvY2s6Cj4gKwltdXRleF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKPiArCW1vY2tfZmlsZV9mcmVlKGd0LT5pOTE1LCBmaWxlKTsKPiArCXJldHVy
biBlcnI7Cj4gK30KPiArCj4gK2ludCBpbnRlbF9jb250ZXh0X2xpdmVfc2VsZnRlc3RzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICt7Cj4gKwlzdGF0aWMgY29uc3Qgc3RydWN0IGk5
MTVfc3VidGVzdCB0ZXN0c1tdID0gewo+ICsJCVNVQlRFU1QobGl2ZV9hY3RpdmVfY29udGV4dCks
Cj4gKwkJU1VCVEVTVChsaXZlX3JlbW90ZV9jb250ZXh0KSwKPiArCX07Cj4gKwlzdHJ1Y3QgaW50
ZWxfZ3QgKmd0ID0gJmk5MTUtPmd0Owo+ICsKPiArCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZ3Qp
KQo+ICsJCXJldHVybiAwOwo+ICsKPiArCXJldHVybiBpbnRlbF9ndF9saXZlX3N1YnRlc3RzKHRl
c3RzLCBndCk7Cj4gK30KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9h
Y3RpdmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKPiBpbmRleCBkMzJk
YjhhNGRiNWMuLjNkNTBhMjdlZDE2YyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2FjdGl2ZS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUu
Ywo+IEBAIC0zMyw2ICszMywzOCBAQCBzdHJ1Y3QgYWN0aXZlX25vZGUgewo+ICAgCXU2NCB0aW1l
bGluZTsKPiAgIH07Cj4gICAKPiArc3RhdGljIGlubGluZSBzdHJ1Y3QgYWN0aXZlX25vZGUgKgo+
ICtub2RlX2Zyb21fYWN0aXZlKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUpCj4g
K3sKPiArCXJldHVybiBjb250YWluZXJfb2YoYWN0aXZlLCBzdHJ1Y3QgYWN0aXZlX25vZGUsIGJh
c2UpOwo+ICt9Cj4gKwo+ICsjZGVmaW5lIGdldF9wcmVhbGxvY2F0ZWRfYmFycmllcnMoeCkgbGxp
c3RfZGVsX2FsbCgmKHgpLT5wcmVhbGxvY2F0ZWRfYmFycmllcnMpCj4gKwo+ICtzdGF0aWMgaW5s
aW5lIGJvb2wgaXNfYmFycmllcihjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0
aXZlKQo+ICt7Cj4gKwlyZXR1cm4gSVNfRVJSKHJjdV9hY2Nlc3NfcG9pbnRlcihhY3RpdmUtPnJl
cXVlc3QpKTsKPiArfQo+ICsKPiArc3RhdGljIGlubGluZSBzdHJ1Y3QgbGxpc3Rfbm9kZSAqYmFy
cmllcl90b19sbChzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGUpCj4gK3sKPiArCUdFTV9CVUdfT04o
IWlzX2JhcnJpZXIoJm5vZGUtPmJhc2UpKTsKPiArCXJldHVybiAoc3RydWN0IGxsaXN0X25vZGUg
Kikmbm9kZS0+YmFzZS5saW5rOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKgo+ICtiYXJyaWVyX3RvX2VuZ2luZShzdHJ1Y3QgYWN0aXZlX25vZGUgKm5v
ZGUpCj4gK3sKPiArCUdFTV9CVUdfT04oIWlzX2JhcnJpZXIoJm5vZGUtPmJhc2UpKTsKPiArCXJl
dHVybiAoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqKW5vZGUtPmJhc2UubGluay5wcmV2Owo+ICt9
Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHN0cnVjdCBhY3RpdmVfbm9kZSAqYmFycmllcl9mcm9tX2xs
KHN0cnVjdCBsbGlzdF9ub2RlICp4KQo+ICt7Cj4gKwlyZXR1cm4gY29udGFpbmVyX29mKChzdHJ1
Y3QgbGlzdF9oZWFkICopeCwKPiArCQkJICAgIHN0cnVjdCBhY3RpdmVfbm9kZSwgYmFzZS5saW5r
KTsKPiArfQo+ICsKPiAgICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0p
ICYmIElTX0VOQUJMRUQoQ09ORklHX0RFQlVHX09CSkVDVFMpCj4gICAKPiAgIHN0YXRpYyB2b2lk
ICphY3RpdmVfZGVidWdfaGludCh2b2lkICphZGRyKQo+IEBAIC0xMjcsNyArMTU5LDcgQEAgYWN0
aXZlX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKPiAgIHN0YXRpYyB2b2lkCj4gICBu
b2RlX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYmFzZSwgc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEpCj4gICB7Cj4gLQlhY3RpdmVfcmV0aXJlKGNvbnRhaW5lcl9vZihiYXNlLCBz
dHJ1Y3QgYWN0aXZlX25vZGUsIGJhc2UpLT5yZWYpOwo+ICsJYWN0aXZlX3JldGlyZShub2RlX2Zy
b21fYWN0aXZlKGJhc2UpLT5yZWYpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgc3RydWN0IGk5MTVf
YWN0aXZlX3JlcXVlc3QgKgo+IEBAIC0xODQsNiArMjE2LDcgQEAgYWN0aXZlX2luc3RhbmNlKHN0
cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCB1NjQgaWR4KQo+ICAgCXJlZi0+Y2FjaGUgPSBub2RlOwo+
ICAgCW11dGV4X3VubG9jaygmcmVmLT5tdXRleCk7Cj4gICAKPiArCUJVSUxEX0JVR19PTihvZmZz
ZXRvZih0eXBlb2YoKm5vZGUpLCBiYXNlKSk7Cj4gICAJcmV0dXJuICZub2RlLT5iYXNlOwo+ICAg
fQo+ICAgCj4gQEAgLTIwMSwxMSArMjM0LDM3IEBAIHZvaWQgX19pOTE1X2FjdGl2ZV9pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgCXJlZi0+cmV0aXJlID0gcmV0aXJlOwo+
ICAgCXJlZi0+dHJlZSA9IFJCX1JPT1Q7Cj4gICAJcmVmLT5jYWNoZSA9IE5VTEw7Cj4gLQlpbml0
X2xsaXN0X2hlYWQoJnJlZi0+YmFycmllcnMpOwo+ICsJaW5pdF9sbGlzdF9oZWFkKCZyZWYtPnBy
ZWFsbG9jYXRlZF9iYXJyaWVycyk7Cj4gICAJYXRvbWljX3NldCgmcmVmLT5jb3VudCwgMCk7Cj4g
ICAJX19tdXRleF9pbml0KCZyZWYtPm11dGV4LCAiaTkxNV9hY3RpdmUiLCBrZXkpOwo+ICAgfQo+
ICAgCj4gK3N0YXRpYyBib29sIF9fYWN0aXZlX2RlbF9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmLAo+ICsJCQkJIHN0cnVjdCBhY3RpdmVfbm9kZSAqbm9kZSkKPiArewo+ICsJc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lID0gYmFycmllcl90b19lbmdpbmUobm9kZSk7Cj4gKwlz
dHJ1Y3QgbGxpc3Rfbm9kZSAqaGVhZCA9IE5VTEwsICp0YWlsID0gTlVMTDsKPiArCXN0cnVjdCBs
bGlzdF9ub2RlICpwb3MsICpuZXh0Owo+ICsKPiArCUdFTV9CVUdfT04obm9kZS0+dGltZWxpbmUg
IT0gZW5naW5lLT5rZXJuZWxfY29udGV4dC0+cmluZy0+dGltZWxpbmUtPmZlbmNlX2NvbnRleHQp
Owo+ICsKPiArCWxsaXN0X2Zvcl9lYWNoX3NhZmUocG9zLCBuZXh0LCBsbGlzdF9kZWxfYWxsKCZl
bmdpbmUtPmJhcnJpZXJfdGFza3MpKSB7Cj4gKwkJaWYgKG5vZGUgPT0gYmFycmllcl9mcm9tX2xs
KHBvcykpIHsKPiArCQkJbm9kZSA9IE5VTEw7Cj4gKwkJCWNvbnRpbnVlOwo+ICsJCX0KPiArCj4g
KwkJcG9zLT5uZXh0ID0gaGVhZDsKPiArCQloZWFkID0gcG9zOwo+ICsJCWlmICghdGFpbCkKPiAr
CQkJdGFpbCA9IHBvczsKPiArCX0KPiArCWlmIChoZWFkKQo+ICsJCWxsaXN0X2FkZF9iYXRjaCho
ZWFkLCB0YWlsLCAmZW5naW5lLT5iYXJyaWVyX3Rhc2tzKTsKPiArCj4gKwlyZXR1cm4gIW5vZGU7
Cj4gK30KPiArCj4gICBpbnQgaTkxNV9hY3RpdmVfcmVmKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVm
LAo+ICAgCQkgICAgdTY0IHRpbWVsaW5lLAo+ICAgCQkgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnEpCj4gQEAgLTIyNCw4ICsyODMsMTUgQEAgaW50IGk5MTVfYWN0aXZlX3JlZihzdHJ1Y3QgaTkx
NV9hY3RpdmUgKnJlZiwKPiAgIAkJZ290byBvdXQ7Cj4gICAJfQo+ICAgCj4gLQlpZiAoIWk5MTVf
YWN0aXZlX3JlcXVlc3RfaXNzZXQoYWN0aXZlKSkKPiAtCQlhdG9taWNfaW5jKCZyZWYtPmNvdW50
KTsKPiArCWlmIChpc19iYXJyaWVyKGFjdGl2ZSkpIHsgLyogcHJvdG8tbm9kZSB1c2VkIGJ5IG91
ciBpZGxlIGJhcnJpZXIgKi8KPiArCQlfX2FjdGl2ZV9kZWxfYmFycmllcihyZWYsIG5vZGVfZnJv
bV9hY3RpdmUoYWN0aXZlKSk7Cj4gKwkJUkNVX0lOSVRfUE9JTlRFUihhY3RpdmUtPnJlcXVlc3Qs
IE5VTEwpOwo+ICsJCUlOSVRfTElTVF9IRUFEKCZhY3RpdmUtPmxpbmspOwoKU28gdGhpcywgd2hl
biBwcmVwYXJlX3JlbW90ZV9yZXF1ZXN0IGNhbGxzIGl0IG9uIGNlLT5hY3RpdmUsIHdpbGwgcmVt
b3ZlIAp0aGUgaWRsZSBiYXJyaWVyIGZyb20gdGhlIGVuZ2luZS0+YmFycmllcnNfbGlzdCBhbmQg
aW1tZWRpYXRlbHkgdHJhbnNmZXIgCml0IHRvIHRoZSBycS0+YWN0aXZlX2xpc3Q/IFRoZW4gd2hl
biB0aGlzIHJlcXVlc3QgaXMgcmV0aXJlZCB3ZSBrbm93IHRoZSAKY29udGV4dCBpcyBpZGxlPyBC
dXQgd2hhdCBpZiBpdCBpcyB0aGUgc2FtZSBjb250ZXh0PyBUaGVuIGl0IGlzIG5vdCBpZGxlIAp5
ZXQuCgo+ICsJfSBlbHNlIHsKPiArCQlpZiAoIWk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQoYWN0
aXZlKSkKPiArCQkJYXRvbWljX2luYygmcmVmLT5jb3VudCk7Cj4gKwl9Cj4gKwlHRU1fQlVHX09O
KCFhdG9taWNfcmVhZCgmcmVmLT5jb3VudCkpOwo+ICAgCV9faTkxNV9hY3RpdmVfcmVxdWVzdF9z
ZXQoYWN0aXZlLCBycSk7Cj4gICAKPiAgIG91dDoKPiBAQCAtMzEyLDYgKzM3OCwxMSBAQCBpbnQg
aTkxNV9hY3RpdmVfd2FpdChzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKPiAgIAl9Cj4gICAKPiAg
IAlyYnRyZWVfcG9zdG9yZGVyX2Zvcl9lYWNoX2VudHJ5X3NhZmUoaXQsIG4sICZyZWYtPnRyZWUs
IG5vZGUpIHsKPiArCQlpZiAoaXNfYmFycmllcigmaXQtPmJhc2UpKSB7IC8qIHVuY29ubmVjdGVk
IGlkbGUtYmFycmllciAqLwo+ICsJCQllcnIgPSAtRUJVU1k7Cj4gKwkJCWJyZWFrOwo+ICsJCX0K
PiArCj4gICAJCWVyciA9IGk5MTVfYWN0aXZlX3JlcXVlc3RfcmV0aXJlKCZpdC0+YmFzZSwgQktM
KHJlZikpOwo+ICAgCQlpZiAoZXJyKQo+ICAgCQkJYnJlYWs7Cj4gQEAgLTM3NCw2ICs0NDUsNzkg
QEAgdm9pZCBpOTE1X2FjdGl2ZV9maW5pKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICAgfQo+
ICAgI2VuZGlmCj4gICAKPiArc3RhdGljIGlubGluZSBib29sIGlzX2lkbGVfYmFycmllcihzdHJ1
Y3QgYWN0aXZlX25vZGUgKm5vZGUsIHU2NCBpZHgpCj4gK3sKPiArCXJldHVybiBub2RlLT50aW1l
bGluZSA9PSBpZHggJiYgIWk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQoJm5vZGUtPmJhc2UpOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgc3RydWN0IGFjdGl2ZV9ub2RlICppZGxlX2JhcnJpZXIoc3RydWN0
IGk5MTVfYWN0aXZlICpyZWYsIHU2NCBpZHgpCj4gK3sKPiArCXN0cnVjdCByYl9ub2RlICpwcmV2
LCAqcDsKPiArCj4gKwlpZiAoUkJfRU1QVFlfUk9PVCgmcmVmLT50cmVlKSkKPiArCQlyZXR1cm4g
TlVMTDsKPiArCj4gKwltdXRleF9sb2NrKCZyZWYtPm11dGV4KTsKPiArCUdFTV9CVUdfT04oaTkx
NV9hY3RpdmVfaXNfaWRsZShyZWYpKTsKPiArCj4gKwkvKgo+ICsJICogVHJ5IHRvIHJldXNlIGFu
eSBleGlzdGluZyBiYXJyaWVyIG5vZGVzIGFscmVhZHkgYWxsb2NhdGVkIGZvciB0aGlzCj4gKwkg
KiBpOTE1X2FjdGl2ZSwgZHVlIHRvIG92ZXJsYXBwaW5nIGFjdGl2ZSBwaGFzZXMgdGhlcmUgaXMg
bGlrZWx5IGEKCkZvciB0aGlzIGk5MTVfYWN0aXZlIG9yIGZvciB0aGlzIGlkeD8gSXQgaXMgdGhp
cyBpOTE1X2FjdGl2ZSBieSAKZGVmaW5pdGlvbiwgbm8/IEFuZCBpZHggYWxzbyBoYXMgdG8gbWF0
Y2ggaW4gYm90aCBsb29wcyBiZWxvdy4KCj4gKwkgKiBub2RlIGtlcHQgYWxpdmUgKGFzIHdlIHJl
dXNlIGJlZm9yZSBwYXJraW5nKS4gV2UgcHJlZmVyIHRvIHJldXNlCj4gKwkgKiBjb21wbGV0ZWx5
IGlkbGUgYmFycmllcnMgKGxlc3MgaGFzc2xlIGluIG1hbmlwdWxhdGluZyB0aGUgbGxpc3RzKSwK
PiArCSAqIGJ1dCBvdGhlcndpc2UgYW55IHdpbGwgZG8uCj4gKwkgKi8KPiArCWlmIChyZWYtPmNh
Y2hlICYmIGlzX2lkbGVfYmFycmllcihyZWYtPmNhY2hlLCBpZHgpKSB7Cj4gKwkJcCA9ICZyZWYt
PmNhY2hlLT5ub2RlOwo+ICsJCWdvdG8gbWF0Y2g7Cj4gKwl9Cj4gKwo+ICsJcHJldiA9IE5VTEw7
Cj4gKwlwID0gcmVmLT50cmVlLnJiX25vZGU7Cj4gKwl3aGlsZSAocCkgewo+ICsJCXN0cnVjdCBh
Y3RpdmVfbm9kZSAqbm9kZSA9Cj4gKwkJCXJiX2VudHJ5KHAsIHN0cnVjdCBhY3RpdmVfbm9kZSwg
bm9kZSk7Cj4gKwo+ICsJCWlmIChpc19pZGxlX2JhcnJpZXIobm9kZSwgaWR4KSkKPiArCQkJZ290
byBtYXRjaDsKPiArCj4gKwkJcHJldiA9IHA7Cj4gKwkJaWYgKG5vZGUtPnRpbWVsaW5lIDwgaWR4
KQo+ICsJCQlwID0gcC0+cmJfcmlnaHQ7Cj4gKwkJZWxzZQo+ICsJCQlwID0gcC0+cmJfbGVmdDsK
PiArCX0KPiArCj4gKwlmb3IgKHAgPSBwcmV2OyBwOyBwID0gcmJfbmV4dChwKSkgewo+ICsJCXN0
cnVjdCBhY3RpdmVfbm9kZSAqbm9kZSA9Cj4gKwkJCXJiX2VudHJ5KHAsIHN0cnVjdCBhY3RpdmVf
bm9kZSwgbm9kZSk7Cj4gKwo+ICsJCWlmIChub2RlLT50aW1lbGluZSA+IGlkeCkKPiArCQkJYnJl
YWs7Cj4gKwo+ICsJCWlmIChub2RlLT50aW1lbGluZSA8IGlkeCkKPiArCQkJY29udGludWU7Cj4g
Kwo+ICsJCWlmICghaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldCgmbm9kZS0+YmFzZSkpCj4gKwkJ
CWdvdG8gbWF0Y2g7CgpJc24ndCB0aGlzIGlkbGUgYmFycmllciwgc28gc2FtZSBhcyBhYm92ZT8g
SG93IGNhbiBhYm92ZSBub3QgZmluZCBpdCwgCmFuZCBmaW5kIGl0IGhlcmU/Cgo+ICsKPiArCQlp
ZiAoaXNfYmFycmllcigmbm9kZS0+YmFzZSkgJiYgX19hY3RpdmVfZGVsX2JhcnJpZXIocmVmLCBu
b2RlKSkKPiArCQkJZ290byBtYXRjaDsKCkFuZCB0aGlzIGlzIHlldCB1bnVzZWQgYmFycmllciB3
aXRoIHRoZSByaWdodCBpZHguIFVuZGVyIHdoYXQgCmNpcmN1bXN0YW5jZXMgY2FuIF9fYWN0aXZl
X2RlbF9iYXJyaWVyIGZhaWwgdGhlbj8gSSB0aGluayBhIGNvbW1lbnQgaXMgCm5lZWRlZC4KCj4g
Kwl9Cj4gKwo+ICsJbXV0ZXhfdW5sb2NrKCZyZWYtPm11dGV4KTsKPiArCj4gKwlyZXR1cm4gTlVM
TDsKPiArCj4gK21hdGNoOgo+ICsJcmJfZXJhc2UocCwgJnJlZi0+dHJlZSk7IC8qIEhpZGUgZnJv
bSB3YWl0cyBhbmQgc2libGluZyBhbGxvY2F0aW9ucyAqLwo+ICsJaWYgKHAgPT0gJnJlZi0+Y2Fj
aGUtPm5vZGUpCj4gKwkJcmVmLT5jYWNoZSA9IE5VTEw7Cj4gKwltdXRleF91bmxvY2soJnJlZi0+
bXV0ZXgpOwo+ICsKPiArCXJldHVybiByYl9lbnRyeShwLCBzdHJ1Y3QgYWN0aXZlX25vZGUsIG5v
ZGUpOwo+ICt9Cj4gKwo+ICAgaW50IGk5MTVfYWN0aXZlX2FjcXVpcmVfcHJlYWxsb2NhdGVfYmFy
cmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwKPiAgIAkJCQkJICAgIHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKPiAgIHsKPiBAQCAtMzgyLDM5ICs1MjYsNTIgQEAgaW50IGk5MTVf
YWN0aXZlX2FjcXVpcmVfcHJlYWxsb2NhdGVfYmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJl
ZiwKPiAgIAlzdHJ1Y3QgbGxpc3Rfbm9kZSAqcG9zLCAqbmV4dDsKPiAgIAlpbnQgZXJyOwo+ICAg
Cj4gLQlHRU1fQlVHX09OKCFtYXNrKTsKPiArCUdFTV9CVUdfT04oIWxsaXN0X2VtcHR5KCZyZWYt
PnByZWFsbG9jYXRlZF9iYXJyaWVycykpOwo+ICsKPiArCS8qCj4gKwkgKiBQcmVhbGxvY2F0ZSBh
IG5vZGUgZm9yIGVhY2ggcGh5c2ljYWwgZW5naW5lIHN1cHBvcnRpbmcgdGhlIHRhcmdldAo+ICsJ
ICogZW5naW5lIChyZW1lbWJlciB2aXJ0dWFsIGVuZ2luZXMgaGF2ZSBtb3JlIHRoYW4gb25lIHNp
YmxpbmcpLgo+ICsJICogV2UgY2FuIHRoZW4gdXNlIHRoZSBwcmVhbGxvY2F0ZWQgbm9kZXMgaW4K
PiArCSAqIGk5MTVfYWN0aXZlX2FjcXVpcmVfYmFycmllcigpCj4gKwkgKi8KPiAgIAlmb3JfZWFj
aF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgaTkxNSwgbWFzaywgdG1wKSB7Cj4gLQkJc3RydWN0IGlu
dGVsX2NvbnRleHQgKmtjdHggPSBlbmdpbmUtPmtlcm5lbF9jb250ZXh0Owo+ICsJCXU2NCBpZHgg
PSBlbmdpbmUtPmtlcm5lbF9jb250ZXh0LT5yaW5nLT50aW1lbGluZS0+ZmVuY2VfY29udGV4dDsK
PiAgIAkJc3RydWN0IGFjdGl2ZV9ub2RlICpub2RlOwo+ICAgCj4gLQkJbm9kZSA9IGttZW1fY2Fj
aGVfYWxsb2MoZ2xvYmFsLnNsYWJfY2FjaGUsIEdGUF9LRVJORUwpOwo+IC0JCWlmICh1bmxpa2Vs
eSghbm9kZSkpIHsKPiAtCQkJZXJyID0gLUVOT01FTTsKPiAtCQkJZ290byB1bndpbmQ7Cj4gKwkJ
bm9kZSA9IGlkbGVfYmFycmllcihyZWYsIGlkeCk7Cj4gKwkJaWYgKCFub2RlKSB7Cj4gKwkJCW5v
ZGUgPSBrbWVtX2NhY2hlX2FsbG9jKGdsb2JhbC5zbGFiX2NhY2hlLCBHRlBfS0VSTkVMKTsKPiAr
CQkJaWYgKCFub2RlKSB7Cj4gKwkJCQllcnIgPSBFTk9NRU07Cj4gKwkJCQlnb3RvIHVud2luZDsK
PiArCQkJfQo+ICsKPiArCQkJUkNVX0lOSVRfUE9JTlRFUihub2RlLT5iYXNlLnJlcXVlc3QsIE5V
TEwpOwo+ICsJCQlub2RlLT5iYXNlLnJldGlyZSA9IG5vZGVfcmV0aXJlOwo+ICsJCQlub2RlLT50
aW1lbGluZSA9IGlkeDsKPiArCQkJbm9kZS0+cmVmID0gcmVmOwo+ICAgCQl9Cj4gICAKPiAtCQlp
OTE1X2FjdGl2ZV9yZXF1ZXN0X2luaXQoJm5vZGUtPmJhc2UsCj4gLQkJCQkJICh2b2lkICopZW5n
aW5lLCBub2RlX3JldGlyZSk7Cj4gLQkJbm9kZS0+dGltZWxpbmUgPSBrY3R4LT5yaW5nLT50aW1l
bGluZS0+ZmVuY2VfY29udGV4dDsKPiAtCQlub2RlLT5yZWYgPSByZWY7Cj4gLQkJYXRvbWljX2lu
YygmcmVmLT5jb3VudCk7Cj4gKwkJaWYgKCFpOTE1X2FjdGl2ZV9yZXF1ZXN0X2lzc2V0KCZub2Rl
LT5iYXNlKSkgewo+ICsJCQlSQ1VfSU5JVF9QT0lOVEVSKG5vZGUtPmJhc2UucmVxdWVzdCwgRVJS
X1BUUigtRUFHQUlOKSk7Cj4gKwkJCW5vZGUtPmJhc2UubGluay5wcmV2ID0gKHZvaWQgKillbmdp
bmU7CgpDb21tZW50IGhlcmUgcGxlYXNlIC0gd2hhdCBmb3IgYW5kIHdoeSBpdCBpcyBzYWZlLgoK
PiArCQkJYXRvbWljX2luYygmcmVmLT5jb3VudCk7Cj4gKwkJfQo+ICAgCj4gKwkJR0VNX0JVR19P
TihiYXJyaWVyX3RvX2VuZ2luZShub2RlKSAhPSBlbmdpbmUpOwo+ICsJCWxsaXN0X2FkZChiYXJy
aWVyX3RvX2xsKG5vZGUpLCAmcmVmLT5wcmVhbGxvY2F0ZWRfYmFycmllcnMpOwo+ICAgCQlpbnRl
bF9lbmdpbmVfcG1fZ2V0KGVuZ2luZSk7Cj4gLQkJbGxpc3RfYWRkKChzdHJ1Y3QgbGxpc3Rfbm9k
ZSAqKSZub2RlLT5iYXNlLmxpbmssCj4gLQkJCSAgJnJlZi0+YmFycmllcnMpOwo+ICAgCX0KPiAg
IAo+ICAgCXJldHVybiAwOwo+ICAgCj4gICB1bndpbmQ6Cj4gLQlsbGlzdF9mb3JfZWFjaF9zYWZl
KHBvcywgbmV4dCwgbGxpc3RfZGVsX2FsbCgmcmVmLT5iYXJyaWVycykpIHsKPiAtCQlzdHJ1Y3Qg
YWN0aXZlX25vZGUgKm5vZGU7Cj4gKwlsbGlzdF9mb3JfZWFjaF9zYWZlKHBvcywgbmV4dCwgZ2V0
X3ByZWFsbG9jYXRlZF9iYXJyaWVycyhyZWYpKSB7CgpzL2dldC90YWtlLyBvciByZW1vdmUsIGV4
dHJhY3Q/Cgo+ICsJCXN0cnVjdCBhY3RpdmVfbm9kZSAqbm9kZSA9IGJhcnJpZXJfZnJvbV9sbChw
b3MpOwo+ICAgCj4gLQkJbm9kZSA9IGNvbnRhaW5lcl9vZigoc3RydWN0IGxpc3RfaGVhZCAqKXBv
cywKPiAtCQkJCSAgICB0eXBlb2YoKm5vZGUpLCBiYXNlLmxpbmspOwo+IC0JCWVuZ2luZSA9ICh2
b2lkICopcmN1X2FjY2Vzc19wb2ludGVyKG5vZGUtPmJhc2UucmVxdWVzdCk7Cj4gKwkJYXRvbWlj
X2RlYygmcmVmLT5jb3VudCk7Cj4gKwkJaW50ZWxfZW5naW5lX3BtX3B1dChiYXJyaWVyX3RvX2Vu
Z2luZShub2RlKSk7Cj4gICAKPiAtCQlpbnRlbF9lbmdpbmVfcG1fcHV0KGVuZ2luZSk7Cj4gICAJ
CWttZW1fY2FjaGVfZnJlZShnbG9iYWwuc2xhYl9jYWNoZSwgbm9kZSk7Cj4gICAJfQo+ICAgCXJl
dHVybiBlcnI7Cj4gQEAgLTQyNiwyNSArNTgzLDI3IEBAIHZvaWQgaTkxNV9hY3RpdmVfYWNxdWly
ZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICAgCj4gICAJR0VNX0JVR19PTihp
OTE1X2FjdGl2ZV9pc19pZGxlKHJlZikpOwo+ICAgCj4gKwkvKgo+ICsJICogVHJhbnNmZXIgdGhl
IGxpc3Qgb2YgcHJlYWxsb2NhdGVkIGJhcnJpZXJzIGludG8gdGhlCj4gKwkgKiBpOTE1X2FjdGl2
ZSByYnRyZWUsIGJ1dCBvbmx5IGFzIHByb3RvLW5vZGVzLiBUaGV5IHdpbGwgYmUKPiArCSAqIHBv
cHVsYXRlZCBieSBpOTE1X3JlcXVlc3RfYWRkX2FjdGl2ZV9iYXJyaWVyKCkgdG8gcG9pbnQgdG8g
dGhlCj4gKwkgKiByZXF1ZXN0IHRoYXQgd2lsbCBldmVudHVhbGx5IHJlbGVhc2UgdGhlbS4KPiAr
CSAqLwo+ICAgCW11dGV4X2xvY2tfbmVzdGVkKCZyZWYtPm11dGV4LCBTSU5HTEVfREVQVEhfTkVT
VElORyk7Cj4gLQlsbGlzdF9mb3JfZWFjaF9zYWZlKHBvcywgbmV4dCwgbGxpc3RfZGVsX2FsbCgm
cmVmLT5iYXJyaWVycykpIHsKPiAtCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4g
LQkJc3RydWN0IGFjdGl2ZV9ub2RlICpub2RlOwo+ICsJbGxpc3RfZm9yX2VhY2hfc2FmZShwb3Ms
IG5leHQsIGdldF9wcmVhbGxvY2F0ZWRfYmFycmllcnMocmVmKSkgewo+ICsJCXN0cnVjdCBhY3Rp
dmVfbm9kZSAqbm9kZSA9IGJhcnJpZXJfZnJvbV9sbChwb3MpOwo+ICsJCXN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSA9IGJhcnJpZXJfdG9fZW5naW5lKG5vZGUpOwo+ICAgCQlzdHJ1Y3Qg
cmJfbm9kZSAqKnAsICpwYXJlbnQ7Cj4gICAKPiAtCQlub2RlID0gY29udGFpbmVyX29mKChzdHJ1
Y3QgbGlzdF9oZWFkICopcG9zLAo+IC0JCQkJICAgIHR5cGVvZigqbm9kZSksIGJhc2UubGluayk7
Cj4gLQo+IC0JCWVuZ2luZSA9ICh2b2lkICopcmN1X2FjY2Vzc19wb2ludGVyKG5vZGUtPmJhc2Uu
cmVxdWVzdCk7Cj4gLQkJUkNVX0lOSVRfUE9JTlRFUihub2RlLT5iYXNlLnJlcXVlc3QsIEVSUl9Q
VFIoLUVBR0FJTikpOwo+IC0KPiAgIAkJcGFyZW50ID0gTlVMTDsKPiAgIAkJcCA9ICZyZWYtPnRy
ZWUucmJfbm9kZTsKPiAgIAkJd2hpbGUgKCpwKSB7Cj4gKwkJCXN0cnVjdCBhY3RpdmVfbm9kZSAq
aXQ7Cj4gKwo+ICAgCQkJcGFyZW50ID0gKnA7Cj4gLQkJCWlmIChyYl9lbnRyeShwYXJlbnQsCj4g
LQkJCQkgICAgIHN0cnVjdCBhY3RpdmVfbm9kZSwKPiAtCQkJCSAgICAgbm9kZSktPnRpbWVsaW5l
IDwgbm9kZS0+dGltZWxpbmUpCj4gKwo+ICsJCQlpdCA9IHJiX2VudHJ5KHBhcmVudCwgc3RydWN0
IGFjdGl2ZV9ub2RlLCBub2RlKTsKPiArCQkJaWYgKGl0LT50aW1lbGluZSA8IG5vZGUtPnRpbWVs
aW5lKQo+ICAgCQkJCXAgPSAmcGFyZW50LT5yYl9yaWdodDsKPiAgIAkJCWVsc2UKPiAgIAkJCQlw
ID0gJnBhcmVudC0+cmJfbGVmdDsKPiBAQCAtNDUyLDIwICs2MTEsMjkgQEAgdm9pZCBpOTE1X2Fj
dGl2ZV9hY3F1aXJlX2JhcnJpZXIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICAJCXJiX2xp
bmtfbm9kZSgmbm9kZS0+bm9kZSwgcGFyZW50LCBwKTsKPiAgIAkJcmJfaW5zZXJ0X2NvbG9yKCZu
b2RlLT5ub2RlLCAmcmVmLT50cmVlKTsKPiAgIAo+IC0JCWxsaXN0X2FkZCgoc3RydWN0IGxsaXN0
X25vZGUgKikmbm9kZS0+YmFzZS5saW5rLAo+IC0JCQkgICZlbmdpbmUtPmJhcnJpZXJfdGFza3Mp
Owo+ICsJCWxsaXN0X2FkZChiYXJyaWVyX3RvX2xsKG5vZGUpLCAmZW5naW5lLT5iYXJyaWVyX3Rh
c2tzKTsKPiAgIAkJaW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOwo+ICAgCX0KPiAgIAltdXRl
eF91bmxvY2soJnJlZi0+bXV0ZXgpOwo+ICAgfQo+ICAgCj4gLXZvaWQgaTkxNV9yZXF1ZXN0X2Fk
ZF9iYXJyaWVycyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiArdm9pZCBpOTE1X3JlcXVlc3Rf
YWRkX2FjdGl2ZV9iYXJyaWVycyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiAgIHsKPiAgIAlz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUgPSBycS0+ZW5naW5lOwo+ICAgCXN0cnVjdCBs
bGlzdF9ub2RlICpub2RlLCAqbmV4dDsKPiAgIAo+IC0JbGxpc3RfZm9yX2VhY2hfc2FmZShub2Rl
LCBuZXh0LCBsbGlzdF9kZWxfYWxsKCZlbmdpbmUtPmJhcnJpZXJfdGFza3MpKQo+ICsJR0VNX0JV
R19PTihpbnRlbF9lbmdpbmVfaXNfdmlydHVhbChlbmdpbmUpKTsKPiArCUdFTV9CVUdfT04ocnEt
PnRpbWVsaW5lICE9IGVuZ2luZS0+a2VybmVsX2NvbnRleHQtPnJpbmctPnRpbWVsaW5lKTsKPiAr
Cj4gKwkvKgo+ICsJICogQXR0YWNoIHRoZSBsaXN0IG9mIHByb3RvLWZlbmNlcyB0byB0aGUgaW4t
ZmxpZ2h0IHJlcXVlc3Qgc3VjaAo+ICsJICogdGhhdCB0aGUgcGFyZW50IGk5MTVfYWN0aXZlIHdp
bGwgYmUgcmVsZWFzZWQgd2hlbiB0aGlzIHJlcXVlc3QKPiArCSAqIGlzIHJldGlyZWQuCj4gKwkg
Ki8KPiArCWxsaXN0X2Zvcl9lYWNoX3NhZmUobm9kZSwgbmV4dCwgbGxpc3RfZGVsX2FsbCgmZW5n
aW5lLT5iYXJyaWVyX3Rhc2tzKSkgewo+ICsJCVJDVV9JTklUX1BPSU5URVIoYmFycmllcl9mcm9t
X2xsKG5vZGUpLT5iYXNlLnJlcXVlc3QsIHJxKTsKPiAgIAkJbGlzdF9hZGRfdGFpbCgoc3RydWN0
IGxpc3RfaGVhZCAqKW5vZGUsICZycS0+YWN0aXZlX2xpc3QpOwo+ICsJfQo+ICAgfQo+ICAgCj4g
ICBpbnQgaTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3Qg
KmFjdGl2ZSwKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUu
aCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmgKPiBpbmRleCBiYTY4YjA3N2Vj
NmMuLjU2NjMzNmM5OWVkNyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2FjdGl2ZS5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaAo+IEBA
IC00MTMsNiArNDEzLDYgQEAgc3RhdGljIGlubGluZSB2b2lkIGk5MTVfYWN0aXZlX2Zpbmkoc3Ry
dWN0IGk5MTVfYWN0aXZlICpyZWYpIHsgfQo+ICAgaW50IGk5MTVfYWN0aXZlX2FjcXVpcmVfcHJl
YWxsb2NhdGVfYmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwKPiAgIAkJCQkJICAgIHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Cj4gICB2b2lkIGk5MTVfYWN0aXZlX2FjcXVp
cmVfYmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7Cj4gLXZvaWQgaTkxNV9yZXF1ZXN0
X2FkZF9iYXJyaWVycyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSk7Cj4gK3ZvaWQgaTkxNV9yZXF1
ZXN0X2FkZF9hY3RpdmVfYmFycmllcnMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpOwo+ICAgCj4g
ICAjZW5kaWYgLyogX0k5MTVfQUNUSVZFX0hfICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2FjdGl2ZV90eXBlcy5oCj4gaW5kZXggNzQ3NDNkZDBkNWYwLi5hZTNlZTQ0MWMxMTQgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMuaAo+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmgKPiBAQCAtNDIsNyArNDIs
NyBAQCBzdHJ1Y3QgaTkxNV9hY3RpdmUgewo+ICAgCWludCAoKmFjdGl2ZSkoc3RydWN0IGk5MTVf
YWN0aXZlICpyZWYpOwo+ICAgCXZvaWQgKCpyZXRpcmUpKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVm
KTsKPiAgIAo+IC0Jc3RydWN0IGxsaXN0X2hlYWQgYmFycmllcnM7Cj4gKwlzdHJ1Y3QgbGxpc3Rf
aGVhZCBwcmVhbGxvY2F0ZWRfYmFycmllcnM7Cj4gICB9Owo+ICAgCj4gICAjZW5kaWYgLyogX0k5
MTVfQUNUSVZFX1RZUEVTX0hfICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L3NlbGZ0ZXN0cy9pOTE1X2xpdmVfc2VsZnRlc3RzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9saXZlX3NlbGZ0ZXN0cy5oCj4gaW5kZXggMmIzMWE0ZWUwYjRjLi5hODQx
ZDNmOWJlZGMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfbGl2ZV9zZWxmdGVzdHMuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9pOTE1X2xpdmVfc2VsZnRlc3RzLmgKPiBAQCAtMTUsNiArMTUsNyBAQCBzZWxmdGVzdCh3b3Jr
YXJvdW5kcywgaW50ZWxfd29ya2Fyb3VuZHNfbGl2ZV9zZWxmdGVzdHMpCj4gICBzZWxmdGVzdCh0
aW1lbGluZXMsIGludGVsX3RpbWVsaW5lX2xpdmVfc2VsZnRlc3RzKQo+ICAgc2VsZnRlc3QocmVx
dWVzdHMsIGk5MTVfcmVxdWVzdF9saXZlX3NlbGZ0ZXN0cykKPiAgIHNlbGZ0ZXN0KGFjdGl2ZSwg
aTkxNV9hY3RpdmVfbGl2ZV9zZWxmdGVzdHMpCj4gK3NlbGZ0ZXN0KGd0X2NvbnRleHRzLCBpbnRl
bF9jb250ZXh0X2xpdmVfc2VsZnRlc3RzKQo+ICAgc2VsZnRlc3Qob2JqZWN0cywgaTkxNV9nZW1f
b2JqZWN0X2xpdmVfc2VsZnRlc3RzKQo+ICAgc2VsZnRlc3QobW1hbiwgaTkxNV9nZW1fbW1hbl9s
aXZlX3NlbGZ0ZXN0cykKPiAgIHNlbGZ0ZXN0KGRtYWJ1ZiwgaTkxNV9nZW1fZG1hYnVmX2xpdmVf
c2VsZnRlc3RzKQo+IEBAIC0yNCw3ICsyNSw3IEBAIHNlbGZ0ZXN0KGd0dCwgaTkxNV9nZW1fZ3R0
X2xpdmVfc2VsZnRlc3RzKQo+ICAgc2VsZnRlc3QoZ2VtLCBpOTE1X2dlbV9saXZlX3NlbGZ0ZXN0
cykKPiAgIHNlbGZ0ZXN0KGV2aWN0LCBpOTE1X2dlbV9ldmljdF9saXZlX3NlbGZ0ZXN0cykKPiAg
IHNlbGZ0ZXN0KGh1Z2VwYWdlcywgaTkxNV9nZW1faHVnZV9wYWdlX2xpdmVfc2VsZnRlc3RzKQo+
IC1zZWxmdGVzdChjb250ZXh0cywgaTkxNV9nZW1fY29udGV4dF9saXZlX3NlbGZ0ZXN0cykKPiAr
c2VsZnRlc3QoZ2VtX2NvbnRleHRzLCBpOTE1X2dlbV9jb250ZXh0X2xpdmVfc2VsZnRlc3RzKQo+
ICAgc2VsZnRlc3QoYmx0LCBpOTE1X2dlbV9vYmplY3RfYmx0X2xpdmVfc2VsZnRlc3RzKQo+ICAg
c2VsZnRlc3QoY2xpZW50LCBpOTE1X2dlbV9jbGllbnRfYmx0X2xpdmVfc2VsZnRlc3RzKQo+ICAg
c2VsZnRlc3QocmVzZXQsIGludGVsX3Jlc2V0X2xpdmVfc2VsZnRlc3RzKQo+IAoKSXQncyBleHRy
ZW1lbHkgY29tcGxpY2F0ZWQhCgpSZWdhcmRzLAoKVHZydGtvCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVs
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

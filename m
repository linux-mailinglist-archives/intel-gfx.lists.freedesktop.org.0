Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 4B7504DB68
	for <lists+intel-gfx@lfdr.de>; Thu, 20 Jun 2019 22:39:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0CE2A6E811;
	Thu, 20 Jun 2019 20:39:06 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1B3516E7FA
 for <Intel-gfx@lists.freedesktop.org>; Thu, 20 Jun 2019 20:38:59 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 20 Jun 2019 13:38:58 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,398,1557212400"; d="scan'208";a="186938738"
Received: from yyosef-mobl.ger.corp.intel.com (HELO localhost.localdomain)
 ([10.252.23.42])
 by fmsmga002.fm.intel.com with ESMTP; 20 Jun 2019 13:38:58 -0700
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
To: Intel-gfx@lists.freedesktop.org
Date: Thu, 20 Jun 2019 21:38:29 +0100
Message-Id: <20190620203835.1421-27-tvrtko.ursulin@linux.intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190620203835.1421-1-tvrtko.ursulin@linux.intel.com>
References: <20190620203835.1421-1-tvrtko.ursulin@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 27/33] drm/i915: Compartmentalize i915_gem_init_ggtt
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KCkNvbnRpbnVp
bmcgb24gdGhlIHRoZW1lIG9mIGJldHRlciBsb2dpY2FsIG9yZ2FuaXphdGlvbiBvZiBvdXIgY29k
ZSwgbWFrZQp0aGUgZmlyc3Qgc3RlcCB0b3dhcmRzIG1ha2luZyB0aGUgZ2d0dCBjb2RlIGJldHRl
ciBpc29sYXRlZCBmcm9tIHdpZGVyCnN0cnVjdCBkcm1faTkxNV9wcml2YXRlLgoKdjI6CiAqIEJy
aW5nIHRoZSBpY2tsZSBvbmlvbiB1bndpbmQgYmFjay4gKENocmlzKQogKiBSZW5hbWUgdG8gaTkx
NV9pbml0X2dndHQuIChDaHJpcykKClNpZ25lZC1vZmYtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0
a28udXJzdWxpbkBpbnRlbC5jb20+ClJldmlld2VkLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNo
cmlzLXdpbHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jICAg
ICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYyB8IDQwICsrKysr
KysrKysrKysrKysrKystLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9n
dHQuaCB8ICAyICstCiAzIGZpbGVzIGNoYW5nZWQsIDI5IGluc2VydGlvbnMoKyksIDE1IGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IGFlMzY5NTVkODE5YS4uNTBkN2Ux
ZThkOGFkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTE1MTAsNyArMTUxMCw3IEBAIGlu
dCBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAltdXRl
eF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaW50ZWxfdW5jb3JlX2ZvcmNl
d2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwogCi0JcmV0ID0gaTkx
NV9nZW1faW5pdF9nZ3R0KGRldl9wcml2KTsKKwlyZXQgPSBpOTE1X2luaXRfZ2d0dChkZXZfcHJp
dik7CiAJaWYgKHJldCkgewogCQlHRU1fQlVHX09OKHJldCA9PSAtRUlPKTsKIAkJZ290byBlcnJf
dW5sb2NrOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYwppbmRleCA5NTVlZjg5NjJkMGMu
LjQ5MWU2MDczNDBlMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1f
Z3R0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKQEAgLTI4NjAs
NyArMjg2MCwxMyBAQCBzdGF0aWMgdm9pZCBnZ3R0X3JlbGVhc2VfZ3VjX3RvcChzdHJ1Y3QgaTkx
NV9nZ3R0ICpnZ3R0KQogCQlkcm1fbW1fcmVtb3ZlX25vZGUoJmdndHQtPnVjX2Z3KTsKIH0KIAot
aW50IGk5MTVfZ2VtX2luaXRfZ2d0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
CitzdGF0aWMgdm9pZCBjbGVhbnVwX2luaXRfZ2d0dChzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQor
eworCWdndHRfcmVsZWFzZV9ndWNfdG9wKGdndHQpOworCWRybV9tbV9yZW1vdmVfbm9kZSgmZ2d0
dC0+ZXJyb3JfY2FwdHVyZSk7Cit9CisKK3N0YXRpYyBpbnQgaW5pdF9nZ3R0KHN0cnVjdCBpOTE1
X2dndHQgKmdndHQpCiB7CiAJLyogTGV0IEdFTSBNYW5hZ2UgYWxsIG9mIHRoZSBhcGVydHVyZS4K
IAkgKgpAQCAtMjg3MSw3ICsyODc3LDYgQEAgaW50IGk5MTVfZ2VtX2luaXRfZ2d0dChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJICogYXBlcnR1cmUuICBPbmUgcGFnZSBzaG91
bGQgYmUgZW5vdWdoIHRvIGtlZXAgYW55IHByZWZldGNoaW5nIGluc2lkZQogCSAqIG9mIHRoZSBh
cGVydHVyZS4KIAkgKi8KLQlzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0ID0gJmRldl9wcml2LT5nZ3R0
OwogCXVuc2lnbmVkIGxvbmcgaG9sZV9zdGFydCwgaG9sZV9lbmQ7CiAJc3RydWN0IGRybV9tbV9u
b2RlICplbnRyeTsKIAlpbnQgcmV0OwpAQCAtMjg4Myw3ICsyODg4LDcgQEAgaW50IGk5MTVfZ2Vt
X2luaXRfZ2d0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJICogd2h5Lgog
CSAqLwogCWdndHQtPnBpbl9iaWFzID0gbWF4X3QodTMyLCBJOTE1X0dUVF9QQUdFX1NJWkUsCi0J
CQkgICAgICAgaW50ZWxfd29wY21fZ3VjX3NpemUoJmRldl9wcml2LT53b3BjbSkpOworCQkJICAg
ICAgIGludGVsX3dvcGNtX2d1Y19zaXplKCZnZ3R0LT52bS5pOTE1LT53b3BjbSkpOwogCiAJcmV0
ID0gaW50ZWxfdmd0X2JhbGxvb24oZ2d0dCk7CiAJaWYgKHJldCkKQEAgLTI5MDQsNyArMjkwOSw3
IEBAIGludCBpOTE1X2dlbV9pbml0X2dndHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQogCSAqLwogCXJldCA9IGdndHRfcmVzZXJ2ZV9ndWNfdG9wKGdndHQpOwogCWlmIChyZXQp
Ci0JCWdvdG8gZXJyX3Jlc2VydmU7CisJCWdvdG8gZXJyOwogCiAJLyogQ2xlYXIgYW55IG5vbi1w
cmVhbGxvY2F0ZWQgYmxvY2tzICovCiAJZHJtX21tX2Zvcl9lYWNoX2hvbGUoZW50cnksICZnZ3R0
LT52bS5tbSwgaG9sZV9zdGFydCwgaG9sZV9lbmQpIHsKQEAgLTI5MTcsMTkgKzI5MjIsMjggQEAg
aW50IGk5MTVfZ2VtX2luaXRfZ2d0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
CiAJLyogQW5kIGZpbmFsbHkgY2xlYXIgdGhlIHJlc2VydmVkIGd1YXJkIHBhZ2UgKi8KIAlnZ3R0
LT52bS5jbGVhcl9yYW5nZSgmZ2d0dC0+dm0sIGdndHQtPnZtLnRvdGFsIC0gUEFHRV9TSVpFLCBQ
QUdFX1NJWkUpOwogCi0JaWYgKElOVEVMX1BQR1RUKGRldl9wcml2KSA9PSBJTlRFTF9QUEdUVF9B
TElBU0lORykgewotCQlyZXQgPSBpbml0X2FsaWFzaW5nX3BwZ3R0KGRldl9wcml2KTsKKwlyZXR1
cm4gMDsKKworZXJyOgorCWNsZWFudXBfaW5pdF9nZ3R0KGdndHQpOworCXJldHVybiByZXQ7Cit9
CisKK2ludCBpOTE1X2luaXRfZ2d0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3sK
KwlpbnQgcmV0OworCisJcmV0ID0gaW5pdF9nZ3R0KCZpOTE1LT5nZ3R0KTsKKwlpZiAocmV0KQor
CQlyZXR1cm4gcmV0OworCisJaWYgKElOVEVMX1BQR1RUKGk5MTUpID09IElOVEVMX1BQR1RUX0FM
SUFTSU5HKSB7CisJCXJldCA9IGluaXRfYWxpYXNpbmdfcHBndHQoaTkxNSk7CiAJCWlmIChyZXQp
Ci0JCQlnb3RvIGVycl9hcHBndHQ7CisJCQljbGVhbnVwX2luaXRfZ2d0dCgmaTkxNS0+Z2d0dCk7
CiAJfQogCiAJcmV0dXJuIDA7Ci0KLWVycl9hcHBndHQ6Ci0JZ2d0dF9yZWxlYXNlX2d1Y190b3Ao
Z2d0dCk7Ci1lcnJfcmVzZXJ2ZToKLQlkcm1fbW1fcmVtb3ZlX25vZGUoJmdndHQtPmVycm9yX2Nh
cHR1cmUpOwotCXJldHVybiByZXQ7CiB9CiAKIHN0YXRpYyB2b2lkIGdndHRfY2xlYW51cF9odyhz
dHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW1fZ3R0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuaAppbmRl
eCAwZDA1Mzc4MGIwM2UuLjllYTEwNjgwNmNmNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW1fZ3R0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1f
Z3R0LmgKQEAgLTY1Miw3ICs2NTIsNyBAQCBpbnQgaTkxNV9nZ3R0X2luaXRfaHcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIGludCBpOTE1X2dndHRfZW5hYmxlX2h3KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiB2b2lkIGk5MTVfZ2d0dF9lbmFibGVfZ3Vj
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKIHZvaWQgaTkxNV9nZ3R0X2Rpc2FibGVf
Z3VjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKLWludCBpOTE1X2dlbV9pbml0X2dn
dHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKK2ludCBpOTE1X2luaXRfZ2d0
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBpOTE1X2dndHRfY2xl
YW51cF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogCiBpbnQgaTkxNV9w
cGd0dF9pbml0X2h3KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwotLSAKMi4yMC4xCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBs
aXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

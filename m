Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 7C47F181504
	for <lists+intel-gfx@lfdr.de>; Wed, 11 Mar 2020 10:35:07 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8DD8F6E962;
	Wed, 11 Mar 2020 09:35:03 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0EE226E95A;
 Wed, 11 Mar 2020 09:34:58 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 20518710-1500050 
 for multiple; Wed, 11 Mar 2020 09:34:51 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 11 Mar 2020 09:34:46 +0000
Message-Id: <20200311093448.4103262-3-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20200311093448.4103262-1-chris@chris-wilson.co.uk>
References: <20200311093448.4103262-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 3/5] i915: Exercise preemption timeout
 controls in sysfs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2UgW3dpbGxdIGV4cG9zZSB2YXJpb3VzIHBlci1lbmdpbmUgc2NoZWR1bGluZyBjb250cm9scy4g
T25lIG9mIHdoaWNoLAoncHJlZW1wdF90aW1lb3V0X21zJywgZGVmaW5lcyBob3cgd2Ugd2FpdCBm
b3IgYSBwcmVlbXB0aW9uIHJlcXVlc3QgdG8gYmUKaG9ub3VyZWQgYnkgdGhlIGN1cnJlbnRseSBl
eGVjdXRpbmcgY29udGV4dC4gSWYgaXQgZmFpbHMgdG8gcmVsaWV2ZSB0aGUKR1BVIHdpdGhpbiB0
aGUgcmVxdWlyZWQgdGltZW91dCwgdGhlIGVuZ2luZSBpcyByZXNldCBhbmQgdGhlIG1pc2NyZWFu
dApmb3JjaWJseSBldmljdGVkLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0Bj
aHJpcy13aWxzb24uY28udWs+Ci0tLQogdGVzdHMvTWFrZWZpbGUuc291cmNlcyAgICAgICAgICAg
ICB8ICAgMyArCiB0ZXN0cy9pOTE1L3N5c2ZzX3ByZWVtcHRfdGltZW91dC5jIHwgMzExICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrCiB0ZXN0cy9pbnRlbC1jaS9ibGFja2xpc3QudHh0ICAg
ICAgIHwgICAxICsKIHRlc3RzL21lc29uLmJ1aWxkICAgICAgICAgICAgICAgICAgfCAgIDEgKwog
NCBmaWxlcyBjaGFuZ2VkLCAzMTYgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IHRl
c3RzL2k5MTUvc3lzZnNfcHJlZW1wdF90aW1lb3V0LmMKCmRpZmYgLS1naXQgYS90ZXN0cy9NYWtl
ZmlsZS5zb3VyY2VzIGIvdGVzdHMvTWFrZWZpbGUuc291cmNlcwppbmRleCA0YWM2ZTM1Y2EuLmMx
NzExYjMzNiAxMDA2NDQKLS0tIGEvdGVzdHMvTWFrZWZpbGUuc291cmNlcworKysgYi90ZXN0cy9N
YWtlZmlsZS5zb3VyY2VzCkBAIC0xMDQsNiArMTA0LDkgQEAgVEVTVFNfcHJvZ3MgPSBcCiAJdmdl
bV9zbG93IFwKIAkkKE5VTEwpCiAKK1RFU1RTX3Byb2dzICs9IHN5c2ZzX3ByZWVtcHRfdGltZW91
dAorc3lzZnNfcHJlZW1wdF90aW1lb3V0X1NPVVJDRVMgPSBpOTE1L3N5c2ZzX3ByZWVtcHRfdGlt
ZW91dC5jCisKIFRFU1RTX3Byb2dzICs9IGdlbV9iYWRfcmVsb2MKIGdlbV9iYWRfcmVsb2NfU09V
UkNFUyA9IGk5MTUvZ2VtX2JhZF9yZWxvYy5jCiAKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvc3lz
ZnNfcHJlZW1wdF90aW1lb3V0LmMgYi90ZXN0cy9pOTE1L3N5c2ZzX3ByZWVtcHRfdGltZW91dC5j
Cm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMC4uYmUxOTA1YmNkCi0tLSAvZGV2
L251bGwKKysrIGIvdGVzdHMvaTkxNS9zeXNmc19wcmVlbXB0X3RpbWVvdXQuYwpAQCAtMCwwICsx
LDMxMSBAQAorLyoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKgor
ICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBw
ZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRl
ZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisgKiB0byBkZWFsIGluIHRo
ZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0
aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwg
ZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29m
dHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQorICogU29mdHdhcmUgaXMg
ZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoK
KyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5v
dGljZSAoaW5jbHVkaW5nIHRoZSBuZXh0CisgKiBwYXJhZ3JhcGgpIHNoYWxsIGJlIGluY2x1ZGVk
IGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlCisgKiBTb2Z0d2Fy
ZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJS
QU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBO
T1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRO
RVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8g
RVZFTlQgU0hBTEwKKyAqIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJM
RSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCisgKiBMSUFCSUxJVFksIFdIRVRIRVIg
SU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORworICog
RlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVT
RSBPUiBPVEhFUiBERUFMSU5HUworICogSU4gVEhFIFNPRlRXQVJFLgorICovCisKKyNpbmNsdWRl
IDxkaXJlbnQuaD4KKyNpbmNsdWRlIDxlcnJuby5oPgorI2luY2x1ZGUgPGZjbnRsLmg+CisjaW5j
bHVkZSA8aW50dHlwZXMuaD4KKyNpbmNsdWRlIDxzY2hlZC5oPgorI2luY2x1ZGUgPHN5cy90eXBl
cy5oPgorI2luY2x1ZGUgPHVuaXN0ZC5oPgorCisjaW5jbHVkZSAiZHJtdGVzdC5oIiAvKiBnZW1f
cXVpZXNjZW50X2dwdSgpISAqLworI2luY2x1ZGUgImk5MTUvZ2VtX2VuZ2luZV90b3BvbG9neS5o
IgorI2luY2x1ZGUgImlndF9kdW1teWxvYWQuaCIKKyNpbmNsdWRlICJpZ3Rfc3lzZnMuaCIKKyNp
bmNsdWRlICJpb2N0bF93cmFwcGVycy5oIiAvKiBpZ3RfcmVxdWlyZV9nZW0oKSEgKi8KKyNpbmNs
dWRlICJzd19zeW5jLmgiCisKKyNpbmNsdWRlICJpZ3RfZGVidWdmcy5oIgorCisjZGVmaW5lIEFU
VFIgInByZWVtcHRfdGltZW91dF9tcyIKKyNkZWZpbmUgUkVTRVRfVElNRU9VVCAyMCAvKiBtaWxs
aXNlY29uZHMsIGF0IGxlYXN0IG9uZSBqaWZmaWUgZm9yIGt3b3JrZXIgKi8KKworc3RhdGljIGJv
b2wgX19lbmFibGVfaGFuZ2NoZWNrKGludCBkaXIsIGJvb2wgc3RhdGUpCit7CisJcmV0dXJuIGln
dF9zeXNmc19zZXQoZGlyLCAiZW5hYmxlX2hhbmdjaGVjayIsIHN0YXRlID8gIjEiIDogIjAiKTsK
K30KKworc3RhdGljIGJvb2wgZW5hYmxlX2hhbmdjaGVjayhpbnQgaTkxNSwgYm9vbCBzdGF0ZSkK
K3sKKwlib29sIHN1Y2Nlc3M7CisJaW50IGRpcjsKKworCWRpciA9IGlndF9zeXNmc19vcGVuX3Bh
cmFtZXRlcnMoaTkxNSk7CisJaWYgKGRpciA8IDApIC8qIG5vIHBhcmFtZXRlcnMsIG11c3QgYmUg
ZGVmYXVsdCEgKi8KKwkJcmV0dXJuIGZhbHNlOworCisJc3VjY2VzcyA9IF9fZW5hYmxlX2hhbmdj
aGVjayhkaXIsIHN0YXRlKTsKKwljbG9zZShkaXIpOworCisJcmV0dXJuIHN1Y2Nlc3M7Cit9CisK
K3N0YXRpYyB2b2lkIHNldF9wcmVlbXB0X3RpbWVvdXQoaW50IGVuZ2luZSwgdW5zaWduZWQgaW50
IHZhbHVlKQoreworCXVuc2lnbmVkIGludCBkZWxheTsKKworCWlndF9zeXNmc19wcmludGYoZW5n
aW5lLCBBVFRSLCAiJXUiLCB2YWx1ZSk7CisJaWd0X3N5c2ZzX3NjYW5mKGVuZ2luZSwgQVRUUiwg
IiV1IiwgJmRlbGF5KTsKKwlpZ3RfYXNzZXJ0X2VxKGRlbGF5LCB2YWx1ZSk7Cit9CisKK3N0YXRp
YyB2b2lkIHRlc3RfaWRlbXBvdGVudChpbnQgaTkxNSwgaW50IGVuZ2luZSkKK3sKKwl1bnNpZ25l
ZCBpbnQgZGVsYXlzW10gPSB7IDAsIDEsIDEwMDAsIDEyMzQsIDY1NDMyMSB9OworCXVuc2lnbmVk
IGludCBzYXZlZDsKKworCS8qIFF1aWNrIHRlc3QgdGhhdCBzdG9yZS9zaG93IHJlcG9ydHMgdGhl
IHNhbWUgdmFsdWVzICovCisKKwlpZ3RfYXNzZXJ0KGlndF9zeXNmc19zY2FuZihlbmdpbmUsIEFU
VFIsICIldSIsICZzYXZlZCkgPT0gMSk7CisJaWd0X2RlYnVnKCJJbml0aWFsICVzOiV1XG4iLCBB
VFRSLCBzYXZlZCk7CisKKwlmb3IgKGludCBpID0gMDsgaSA8IEFSUkFZX1NJWkUoZGVsYXlzKTsg
aSsrKQorCQlzZXRfcHJlZW1wdF90aW1lb3V0KGVuZ2luZSwgZGVsYXlzW2ldKTsKKworCXNldF9w
cmVlbXB0X3RpbWVvdXQoZW5naW5lLCBzYXZlZCk7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3RfaW52
YWxpZChpbnQgaTkxNSwgaW50IGVuZ2luZSkKK3sKKwl1bnNpZ25lZCBpbnQgc2F2ZWQsIGRlbGF5
OworCisJLyogUXVpY2sgdGVzdCB0aGF0IHZhbHVlcyB0aGF0IGFyZSBub3QgcmVwcmVzZW50YWJs
ZSBhcmUgcmVqZWN0ZWQgKi8KKworCWlndF9hc3NlcnQoaWd0X3N5c2ZzX3NjYW5mKGVuZ2luZSwg
QVRUUiwgIiV1IiwgJnNhdmVkKSA9PSAxKTsKKwlpZ3RfZGVidWcoIkluaXRpYWwgJXM6JXVcbiIs
IEFUVFIsIHNhdmVkKTsKKworCWlndF9zeXNmc19wcmludGYoZW5naW5lLCBBVFRSLCBQUkl1NjQs
IC0xKTsKKwlpZ3Rfc3lzZnNfc2NhbmYoZW5naW5lLCBBVFRSLCAiJXUiLCAmZGVsYXkpOworCWln
dF9hc3NlcnRfZXEoZGVsYXksIHNhdmVkKTsKKworCWlndF9zeXNmc19wcmludGYoZW5naW5lLCBB
VFRSLCAiJWQiLCAtMSk7CisJaWd0X3N5c2ZzX3NjYW5mKGVuZ2luZSwgQVRUUiwgIiV1IiwgJmRl
bGF5KTsKKwlpZ3RfYXNzZXJ0X2VxKGRlbGF5LCBzYXZlZCk7CisKKwlpZ3Rfc3lzZnNfcHJpbnRm
KGVuZ2luZSwgQVRUUiwgUFJJdTY0LCA0MHVsbCA8PCAzMik7CisJaWd0X3N5c2ZzX3NjYW5mKGVu
Z2luZSwgQVRUUiwgIiV1IiwgJmRlbGF5KTsKKwlpZ3RfYXNzZXJ0X2VxKGRlbGF5LCBzYXZlZCk7
Cit9CisKK3N0YXRpYyB2b2lkIHNldF91bmJhbm5hYmxlKGludCBpOTE1LCB1aW50MzJfdCBjdHgp
Cit7CisJc3RydWN0IGRybV9pOTE1X2dlbV9jb250ZXh0X3BhcmFtIHAgPSB7CisJCS5jdHhfaWQg
PSBjdHgsCisJCS5wYXJhbSA9IEk5MTVfQ09OVEVYVF9QQVJBTV9CQU5OQUJMRSwKKwl9OworCisJ
Z2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwKTsKK30KKworc3RhdGljIHVpbnQzMl90IGNy
ZWF0ZV9jb250ZXh0KGludCBpOTE1LCB1bnNpZ25lZCBpbnQgY2xhc3MsIHVuc2lnbmVkIGludCBp
bnN0LCBpbnQgcHJpbykKK3sKKwl1aW50MzJfdCBjdHg7CisKKwljdHggPSBnZW1fY29udGV4dF9j
cmVhdGVfZm9yX2VuZ2luZShpOTE1LCBjbGFzcywgaW5zdCk7CisJc2V0X3VuYmFubmFibGUoaTkx
NSwgY3R4KTsKKwlnZW1fY29udGV4dF9zZXRfcHJpb3JpdHkoaTkxNSwgY3R4LCBwcmlvKTsKKwor
CXJldHVybiBjdHg7Cit9CisKK3N0YXRpYyB1aW50NjRfdCBfX3Rlc3RfdGltZW91dChpbnQgaTkx
NSwgaW50IGVuZ2luZSwgdW5zaWduZWQgaW50IHRpbWVvdXQpCit7CisJdW5zaWduZWQgaW50IGNs
YXNzLCBpbnN0OworCXN0cnVjdCB0aW1lc3BlYyB0cyA9IHt9OworCWlndF9zcGluX3QgKnNwaW5b
Ml07CisJdWludDY0X3QgZWxhcHNlZDsKKwl1aW50MzJfdCBjdHhbMl07CisKKwlpZ3RfYXNzZXJ0
KGlndF9zeXNmc19zY2FuZihlbmdpbmUsICJjbGFzcyIsICIldSIsICZjbGFzcykgPT0gMSk7CisJ
aWd0X2Fzc2VydChpZ3Rfc3lzZnNfc2NhbmYoZW5naW5lLCAiaW5zdGFuY2UiLCAiJXUiLCAmaW5z
dCkgPT0gMSk7CisKKwlzZXRfcHJlZW1wdF90aW1lb3V0KGVuZ2luZSwgdGltZW91dCk7CisKKwlj
dHhbMF0gPSBjcmVhdGVfY29udGV4dChpOTE1LCBjbGFzcywgaW5zdCwgLTEwMjMpOworCXNwaW5b
MF0gPSBpZ3Rfc3Bpbl9uZXcoaTkxNSwgY3R4WzBdLAorCQkJICAgICAgIC5mbGFncyA9IChJR1Rf
U1BJTl9OT19QUkVFTVBUSU9OIHwKKwkJCQkJIElHVF9TUElOX1BPTExfUlVOIHwKKwkJCQkJIElH
VF9TUElOX0ZFTkNFX09VVCkpOworCWlndF9zcGluX2J1c3l3YWl0X3VudGlsX3N0YXJ0ZWQoc3Bp
blswXSk7CisKKwljdHhbMV0gPSBjcmVhdGVfY29udGV4dChpOTE1LCBjbGFzcywgaW5zdCwgMTAy
Myk7CisJaWd0X25zZWNfZWxhcHNlZCgmdHMpOworCXNwaW5bMV0gPSBpZ3Rfc3Bpbl9uZXcoaTkx
NSwgY3R4WzFdLCAuZmxhZ3MgPSBJR1RfU1BJTl9QT0xMX1JVTik7CisJaWd0X3NwaW5fYnVzeXdh
aXRfdW50aWxfc3RhcnRlZChzcGluWzFdKTsKKwllbGFwc2VkID0gaWd0X25zZWNfZWxhcHNlZCgm
dHMpOworCisJaWd0X3NwaW5fZnJlZShpOTE1LCBzcGluWzFdKTsKKworCWlndF9hc3NlcnRfZXEo
c3luY19mZW5jZV93YWl0KHNwaW5bMF0tPm91dF9mZW5jZSwgUkVTRVRfVElNRU9VVCksIDApOwor
CWlndF9hc3NlcnRfZXEoc3luY19mZW5jZV9zdGF0dXMoc3BpblswXS0+b3V0X2ZlbmNlKSwgLUVJ
Tyk7CisKKwlpZ3Rfc3Bpbl9mcmVlKGk5MTUsIHNwaW5bMF0pOworCisJZ2VtX2NvbnRleHRfZGVz
dHJveShpOTE1LCBjdHhbMV0pOworCWdlbV9jb250ZXh0X2Rlc3Ryb3koaTkxNSwgY3R4WzBdKTsK
KwlnZW1fcXVpZXNjZW50X2dwdShpOTE1KTsKKworCXJldHVybiBlbGFwc2VkOworfQorCitzdGF0
aWMgdm9pZCB0ZXN0X3RpbWVvdXQoaW50IGk5MTUsIGludCBlbmdpbmUpCit7CisJaW50IGRlbGF5
c1tdID0geyAxLCA1MCwgMTAwLCA1MDAgfTsKKwl1bnNpZ25lZCBpbnQgc2F2ZWQ7CisKKwkvKgor
CSAqIFNlbmQgZG93biBzb21lIG5vbi1wcmVlbXB0YWJsZSB3b3JrbG9hZHMgYW5kIHRoZW4gcmVx
dWVzdCBhCisJICogc3dpdGNoIHRvIGEgaGlnaGVyIHByaW9yaXR5IGNvbnRleHQuIFRoZSBIVyB3
aWxsIG5vdCBiZSBhYmxlIHRvCisJICogcmVzcG9uZCwgc28gdGhlIGtlcm5lbCB3aWxsIGJlIGZv
cmNlZCB0byByZXNldCB0aGUgaG9nLiBUaGlzCisJICogdGltZW91dCBzaG91bGQgbWF0Y2ggb3Vy
IHNwZWNpZmljYXRpb24sIGFuZCBzbyB3ZSBjYW4gbWVhc3VyZQorCSAqIHRoZSBkZWxheSBmcm9t
IHJlcXVlc3RpbmcgdGhlIHByZWVtcHRpb24gdG8gaXRzIGNvbXBsZXRpb24uCisJICovCisKKwlp
Z3RfYXNzZXJ0KGlndF9zeXNmc19zY2FuZihlbmdpbmUsIEFUVFIsICIldSIsICZzYXZlZCkgPT0g
MSk7CisJaWd0X2RlYnVnKCJJbml0aWFsICVzOiV1XG4iLCBBVFRSLCBzYXZlZCk7CisKKwlnZW1f
cXVpZXNjZW50X2dwdShpOTE1KTsKKwlpZ3RfcmVxdWlyZShlbmFibGVfaGFuZ2NoZWNrKGk5MTUs
IGZhbHNlKSk7CisKKwlmb3IgKGludCBpID0gMDsgaSA8IEFSUkFZX1NJWkUoZGVsYXlzKTsgaSsr
KSB7CisJCXVpbnQ2NF90IGVsYXBzZWQ7CisKKwkJZWxhcHNlZCA9IF9fdGVzdF90aW1lb3V0KGk5
MTUsIGVuZ2luZSwgZGVsYXlzW2ldKTsKKwkJaWd0X2luZm8oIiVzOiVkLCBlbGFwc2VkPSUuM2Zt
c1xuIiwKKwkJCSBBVFRSLCBkZWxheXNbaV0sIGVsYXBzZWQgKiAxZS02KTsKKworCQkvKgorCQkg
KiBXZSBuZWVkIHRvIGdpdmUgYSBjb3VwbGUgb2YgamlmZmllcyBzbGFjayBmb3IgdGhlIHNjaGVk
dWxlciB0aW1lb3V0cworCQkgKiBhbmQgdGhlbiBhIGxpdHRsZSBtb3JlIHNsYWNrIGZyIHRoZSBv
dmVyaGVhZCBpbiBzdWJtaXR0aW5nIGFuZAorCQkgKiBtZWFzdXJpbmcuIDUwbXMgc2hvdWxkIGNv
dmVyIGFsbCBvZiBvdXIgc2lucyBhbmQgYmUgdXNlZnVsCisJCSAqIHRvbGVyYW5jZS4KKwkJICov
CisJCWlndF9hc3NlcnRfZihlbGFwc2VkIC8gMTAwMCAvIDEwMDAgPCBkZWxheXNbaV0gKyA1MCwK
KwkJCSAgICAgIkZvcmNlZCBwcmVlbXB0aW9uIHRpbWVvdXQgZXhjZWVkZWQgcmVxdWVzdCFcbiIp
OworCX0KKworCWlndF9hc3NlcnQoZW5hYmxlX2hhbmdjaGVjayhpOTE1LCB0cnVlKSk7CisJZ2Vt
X3F1aWVzY2VudF9ncHUoaTkxNSk7CisJc2V0X3ByZWVtcHRfdGltZW91dChlbmdpbmUsIHNhdmVk
KTsKK30KKworc3RhdGljIHZvaWQgdGVzdF9vZmYoaW50IGk5MTUsIGludCBlbmdpbmUpCit7CisJ
dW5zaWduZWQgaW50IGNsYXNzLCBpbnN0OworCWlndF9zcGluX3QgKnNwaW5bMl07CisJdW5zaWdu
ZWQgaW50IHNhdmVkOworCXVpbnQzMl90IGN0eFsyXTsKKworCS8qCisJICogV2Ugc3VwcG9ydCBz
ZXR0aW5nIHRoZSB0aW1lb3V0IHRvIDAgdG8gZGlzYWJsZSB0aGUgcmVzZXQgb24KKwkgKiBwcmVl
bXB0aW9uIGZhaWx1cmUuIEhhdmluZyBlc3RhYmxpc2hlZCB0aGF0IHdlIGNhbiBkbyBmb3JjZWQK
KwkgKiBwcmVlbXB0aW9uIG9uIGRlbWFuZCwgd2UgdXNlIHRoZSBzYW1lIHNldHVwIChub24tcHJl
ZWVtcHRhYmxlIGhvZworCSAqIGZvbGxvd2VkIGJ5IGEgaGlnaCBwcmlvcml0eSBjb250ZXh0KSBh
bmQgdmVyaWZ5IHRoYXQgdGhlIGhvZyBpcworCSAqIG5ldmVyIHJlc2V0LiBOZXZlciBpcyBhIGxv
bmcgdGltZSwgc28gd2Ugc2V0dGxlIGZvciAxNTBzLgorCSAqLworCisJaWd0X2Fzc2VydChpZ3Rf
c3lzZnNfc2NhbmYoZW5naW5lLCBBVFRSLCAiJXUiLCAmc2F2ZWQpID09IDEpOworCWlndF9kZWJ1
ZygiSW5pdGlhbCAlczoldVxuIiwgQVRUUiwgc2F2ZWQpOworCisJZ2VtX3F1aWVzY2VudF9ncHUo
aTkxNSk7CisJaWd0X3JlcXVpcmUoZW5hYmxlX2hhbmdjaGVjayhpOTE1LCBmYWxzZSkpOworCisJ
aWd0X2Fzc2VydChpZ3Rfc3lzZnNfc2NhbmYoZW5naW5lLCAiY2xhc3MiLCAiJXUiLCAmY2xhc3Mp
ID09IDEpOworCWlndF9hc3NlcnQoaWd0X3N5c2ZzX3NjYW5mKGVuZ2luZSwgImluc3RhbmNlIiwg
IiV1IiwgJmluc3QpID09IDEpOworCisJc2V0X3ByZWVtcHRfdGltZW91dChlbmdpbmUsIDApOwor
CisJY3R4WzBdID0gY3JlYXRlX2NvbnRleHQoaTkxNSwgY2xhc3MsIGluc3QsIC0xMDIzKTsKKwlz
cGluWzBdID0gaWd0X3NwaW5fbmV3KGk5MTUsIGN0eFswXSwKKwkJCSAgICAgICAuZmxhZ3MgPSAo
SUdUX1NQSU5fTk9fUFJFRU1QVElPTiB8CisJCQkJCSBJR1RfU1BJTl9QT0xMX1JVTiB8CisJCQkJ
CSBJR1RfU1BJTl9GRU5DRV9PVVQpKTsKKwlpZ3Rfc3Bpbl9idXN5d2FpdF91bnRpbF9zdGFydGVk
KHNwaW5bMF0pOworCisJY3R4WzFdID0gY3JlYXRlX2NvbnRleHQoaTkxNSwgY2xhc3MsIGluc3Qs
IDEwMjMpOworCXNwaW5bMV0gPSBpZ3Rfc3Bpbl9uZXcoaTkxNSwgY3R4WzFdLCAuZmxhZ3MgPSBJ
R1RfU1BJTl9QT0xMX1JVTik7CisKKwlmb3IgKGludCBpID0gMDsgaSA8IDE1MDsgaSsrKSB7CisJ
CWlndF9hc3NlcnRfZXEoc3luY19mZW5jZV9zdGF0dXMoc3BpblswXS0+b3V0X2ZlbmNlKSwgMCk7
CisJCXNsZWVwKDEpOworCX0KKworCXNldF9wcmVlbXB0X3RpbWVvdXQoZW5naW5lLCAxKTsKKwor
CWlndF9zcGluX2J1c3l3YWl0X3VudGlsX3N0YXJ0ZWQoc3BpblsxXSk7CisJaWd0X3NwaW5fZnJl
ZShpOTE1LCBzcGluWzFdKTsKKworCWlndF9hc3NlcnRfZXEoc3luY19mZW5jZV93YWl0KHNwaW5b
MF0tPm91dF9mZW5jZSwgUkVTRVRfVElNRU9VVCksIDApOworCWlndF9hc3NlcnRfZXEoc3luY19m
ZW5jZV9zdGF0dXMoc3BpblswXS0+b3V0X2ZlbmNlKSwgLUVJTyk7CisKKwlpZ3Rfc3Bpbl9mcmVl
KGk5MTUsIHNwaW5bMF0pOworCisJZ2VtX2NvbnRleHRfZGVzdHJveShpOTE1LCBjdHhbMV0pOwor
CWdlbV9jb250ZXh0X2Rlc3Ryb3koaTkxNSwgY3R4WzBdKTsKKworCWlndF9hc3NlcnQoZW5hYmxl
X2hhbmdjaGVjayhpOTE1LCB0cnVlKSk7CisJZ2VtX3F1aWVzY2VudF9ncHUoaTkxNSk7CisKKwlz
ZXRfcHJlZW1wdF90aW1lb3V0KGVuZ2luZSwgc2F2ZWQpOworfQorCitpZ3RfbWFpbgoreworCXN0
YXRpYyBjb25zdCBzdHJ1Y3QgeworCQljb25zdCBjaGFyICpuYW1lOworCQl2b2lkICgqZm4pKGlu
dCwgaW50KTsKKwl9IHRlc3RzW10gPSB7CisJCXsgImlkZW1wb3RlbnQiLCB0ZXN0X2lkZW1wb3Rl
bnQgfSwKKwkJeyAiaW52YWxpZCIsIHRlc3RfaW52YWxpZCB9LAorCQl7ICJ0aW1lb3V0IiwgdGVz
dF90aW1lb3V0IH0sCisJCXsgIm9mZiIsIHRlc3Rfb2ZmIH0sCisJCXsgfQorCX07CisJaW50IGk5
MTUgPSAtMSwgZW5naW5lcyA9IC0xOworCisJaWd0X2ZpeHR1cmUgeworCQlpbnQgc3lzOworCisJ
CWk5MTUgPSBkcm1fb3Blbl9kcml2ZXIoRFJJVkVSX0lOVEVMKTsKKwkJaWd0X3JlcXVpcmVfZ2Vt
KGk5MTUpOworCQlpZ3RfYWxsb3dfaGFuZyhpOTE1LCAwLCAwKTsKKworCQlzeXMgPSBpZ3Rfc3lz
ZnNfb3BlbihpOTE1KTsKKwkJaWd0X3JlcXVpcmUoc3lzICE9IC0xKTsKKworCQllbmdpbmVzID0g
b3BlbmF0KHN5cywgImVuZ2luZSIsIE9fUkRPTkxZKTsKKwkJaWd0X3JlcXVpcmUoZW5naW5lcyAh
PSAtMSk7CisKKwkJY2xvc2Uoc3lzKTsKKwl9CisKKwlmb3IgKHR5cGVvZigqdGVzdHMpICp0ID0g
dGVzdHM7IHQtPm5hbWU7IHQrKykKKwkJaWd0X3N1YnRlc3Rfd2l0aF9keW5hbWljKHQtPm5hbWUp
CisJCQlkeW5fc3lzZnNfZW5naW5lcyhpOTE1LCBlbmdpbmVzLCBBVFRSLCB0LT5mbik7CisKKwlp
Z3RfZml4dHVyZSB7CisJCWNsb3NlKGVuZ2luZXMpOworCQljbG9zZShpOTE1KTsKKwl9Cit9CmRp
ZmYgLS1naXQgYS90ZXN0cy9pbnRlbC1jaS9ibGFja2xpc3QudHh0IGIvdGVzdHMvaW50ZWwtY2kv
YmxhY2tsaXN0LnR4dAppbmRleCA4MDg1NzE5ZjUuLjFiNTQ0MjI3OCAxMDA2NDQKLS0tIGEvdGVz
dHMvaW50ZWwtY2kvYmxhY2tsaXN0LnR4dAorKysgYi90ZXN0cy9pbnRlbC1jaS9ibGFja2xpc3Qu
dHh0CkBAIC02MCw2ICs2MCw3IEBAIGlndEBnZW1fc3luY0AoPyEuKmJhc2ljKS4qCiBpZ3RAZ2Vt
X3RpbGVkX3N3YXBwaW5nQCg/IW5vbi10aHJlYWRlZCkuKgogaWd0QGdlbV91c2VycHRyX2JsaXRz
QChtYWpvcnxtaW5vcnxmb3JrZWR8bWxvY2tlZHxzd2FwcGluZykuKgogaWd0QGdlbV93YWl0QC4q
aGFuZy4qCitpZ3RAc3lzZnNfcHJlZW1wdGlvbl90aW1lb3V0QG9mZi4qCiAjIyMjIyMjIyMjIyMj
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogIyBHRU06IE5vdCB3b3J0aCBmaXhp
bmcKICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCmRpZmYg
LS1naXQgYS90ZXN0cy9tZXNvbi5idWlsZCBiL3Rlc3RzL21lc29uLmJ1aWxkCmluZGV4IDkyODBl
YjNkOC4uYmFmZDAwNTEzIDEwMDY0NAotLS0gYS90ZXN0cy9tZXNvbi5idWlsZAorKysgYi90ZXN0
cy9tZXNvbi5idWlsZApAQCAtMjI3LDYgKzIyNyw3IEBAIGk5MTVfcHJvZ3MgPSBbCiAJJ2k5MTVf
cXVlcnknLAogCSdpOTE1X3NlbGZ0ZXN0JywKIAknaTkxNV9zdXNwZW5kJywKKwknc3lzZnNfcHJl
ZW1wdF90aW1lb3V0JywKIF0KIAogdGVzdF9kZXBzID0gWyBpZ3RfZGVwcyBdCi0tIAoyLjI1LjEK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdm
eCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

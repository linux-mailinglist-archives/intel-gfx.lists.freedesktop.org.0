Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id D8C9BE8404
	for <lists+intel-gfx@lfdr.de>; Tue, 29 Oct 2019 10:16:59 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3A31E6E15A;
	Tue, 29 Oct 2019 09:16:58 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0B3676E15A
 for <intel-gfx@lists.freedesktop.org>; Tue, 29 Oct 2019 09:16:55 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19003330-1500050 
 for multiple; Tue, 29 Oct 2019 09:16:34 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 29 Oct 2019 09:16:32 +0000
Message-Id: <20191029091632.26281-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/gt: Make timeslice duration
 configurable
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RXhlY2xpc3RzIHVzZXMgYSBzY2hlZHVsaW5nIHF1YW50dW0gKGEgdGltZXNsaWNlKSB0byBhbHRl
cm5hdGUgZXhlY3V0aW9uCmJldHdlZW4gcmVhZHktdG8tcnVuIGNvbnRleHRzIG9mIGVxdWFsIHBy
aW9yaXR5LiBUaGlzIGVuc3VyZXMgdGhhdCBhbGwKdXNlcnMgKHRob3VnaCBvbmx5IGlmIHRoZXkg
b2YgZXF1YWwgaW1wb3J0YW5jZSkgaGF2ZSB0aGUgb3Bwb3J0dW5pdHkgdG8KcnVuIGFuZCBwcmV2
ZW50cyBsaXZlbG9ja3Mgd2hlcmUgY29udGV4dHMgbWF5IGhhdmUgaW1wbGljaXQgb3JkZXJpbmcg
ZHVlCnRvIHVzZXJzcGFjZSBzZW1hcGhvcmVzLiBIb3dldmVyLCBub3QgYWxsIHdvcmtsb2FkcyBu
ZWNlc3NhcmlseSBiZW5lZml0CmZyb20gdGltZXNsaWNpbmcgYW5kIGluIHRoZSBleHRyZW1lIHNv
bWUgc3lzYWRtaW4gbWF5IHdhbnQgdG8gZGlzYWJsZSBvcgpyZWR1Y2UgdGhlIHRpbWVzbGljaW5n
IGdyYW51bGFyaXR5LgoKVGhlIHRpbWVzbGljaW5nIG1lY2hhbmlzbSBjYW4gYmUgY29tcGlsZWQg
b3V0IHdpdGgKCgkuL3NjcmlwdHMvY29uZmlnIC0tc2V0LXZhbCBEUk1fSTkxNV9USU1FU0xJQ0Vf
RFVSQVRJT04gMAoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxz
b24uY28udWs+CkNjOiBKb29uYXMgTGFodGluZW4gPGpvb25hcy5sYWh0aW5lbkBsaW51eC5pbnRl
bC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9maWxlICAgICAgICAg
fCAxNSArKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmggICAg
ICAgfCAgOSArKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMg
ICAgfCAgMiArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCB8
ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAgIHwgMzkg
KysrKysrKysrKysrKystLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xy
Yy5jICAgICAgIHwgMTMgKysrKysrLQogNiBmaWxlcyBjaGFuZ2VkLCA2NSBpbnNlcnRpb25zKCsp
LCAxNCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9LY29u
ZmlnLnByb2ZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9LY29uZmlnLnByb2ZpbGUKaW5kZXgg
OGFiN2FmNWViMzExLi4xNzk5NTM3YTMyMjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L0tjb25maWcucHJvZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9LY29uZmlnLnBy
b2ZpbGUKQEAgLTU5LDMgKzU5LDE4IEBAIGNvbmZpZyBEUk1fSTkxNV9TVE9QX1RJTUVPVVQKIAkg
IGRhbWFnZSBhcyB0aGUgc3lzdGVtIGlzIHJlc2V0IGluIG9yZGVyIHRvIHJlY292ZXIuIFRoZSBj
b3JvbGxhcnkgaXMKIAkgIHRoYXQgdGhlIHJlc2V0IGl0c2VsZiBtYXkgdGFrZSBsb25nZXIgYW5k
IHNvIGJlIG1vcmUgZGlzcnVwdGl2ZSB0bwogCSAgaW50ZXJhY3RpdmUgb3IgbG93IGxhdGVuY3kg
d29ya2xvYWRzLgorCitjb25maWcgRFJNX0k5MTVfVElNRVNMSUNFX0RVUkFUSU9OCisJaW50ICJT
Y2hlZHVsaW5nIHF1YW50dW0gZm9yIHVzZXJzcGFjZSBiYXRjaGVzIChtcywgamlmZnkgZ3JhbnVs
YXJpdHkpIgorCWRlZmF1bHQgMSAjIG1pbGxpc2Vjb25kcworCWhlbHAKKwkgIFdoZW4gdHdvIHVz
ZXIgYmF0Y2hlcyBvZiBlcXVhbCBwcmlvcml0eSBhcmUgZXhlY3V0aW5nLCB3ZSB3aWxsCisJICBh
bHRlcm5hdGUgZXhlY3V0aW9uIG9mIGVhY2ggYmF0Y2ggdG8gZW5zdXJlIGZvcndhcmQgcHJvZ3Jl
c3Mgb2YKKwkgIGFsbCB1c2Vycy4gVGhpcyBpcyBuZWNlc3NhcnkgaW4gc29tZSBjYXNlcyB3aGVy
ZSB0aGVyZSBtYXkgYmUKKwkgIGFuIGltcGxpY2l0IGRlcGVuZGVuY3kgYmV0d2VlbiB0aG9zZSBi
YXRjaGVzIHRoYXQgcmVxdWlyZXMKKwkgIGNvbmN1cnJlbnQgZXhlY3V0aW9uIGluIG9yZGVyIGZv
ciB0aGVtIHRvIHByb2NlZWQsIGUuZy4gdGhleQorCSAgaW50ZXJhY3Qgd2l0aCBlYWNoIG90aGVy
IHZpYSB1c2Vyc3BhY2Ugc2VtYXBob3Jlcy4gRWFjaCBjb250ZXh0CisJICBpcyBzY2hlZHVsZWQg
Zm9yIGV4ZWN1dGlvbiBmb3IgdGhlIHRpbWVzbGljZSBkdXJhdGlvbiwgYmVmb3JlCisJICBzd2l0
Y2hpbmcgdG8gdGhlIG5leHQgY29udGV4dC4KKworCSAgTWF5IGJlIDAgdG8gZGlzYWJsZSB0aW1l
c2xpY2luZy4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2lu
ZS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKaW5kZXggYzY4OTU5
MzhiNjI2Li4wNTk3Yjc3ZjU4MTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2lu
ZS5oCkBAIC0zMzUsNCArMzM1LDEzIEBAIGludGVsX2VuZ2luZV9oYXNfcHJlZW1wdF9yZXNldChj
b25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJcmV0dXJuIGludGVsX2VuZ2lu
ZV9oYXNfcHJlZW1wdGlvbihlbmdpbmUpOwogfQogCitzdGF0aWMgaW5saW5lIGJvb2wKK2ludGVs
X2VuZ2luZV9oYXNfdGltZXNsaWNlcyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCit7CisJaWYgKCFDT05GSUdfRFJNX0k5MTVfVElNRVNMSUNFX0RVUkFUSU9OKQorCQlyZXR1
cm4gMDsKKworCXJldHVybiBpbnRlbF9lbmdpbmVfaGFzX3NlbWFwaG9yZXMoZW5naW5lKTsKK30K
KwogI2VuZGlmIC8qIF9JTlRFTF9SSU5HQlVGRkVSX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZV9jcy5jCmluZGV4IDljYzFlYTY1MTllYy4uMmFmYTJlZjkwNDgyIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwpAQCAtMzE1LDYgKzMx
NSw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfZW5naW5lX3NldHVwKHN0cnVjdCBpbnRlbF9ndCAqZ3Qs
IGVudW0gaW50ZWxfZW5naW5lX2lkIGlkKQogCQlDT05GSUdfRFJNX0k5MTVfUFJFRU1QVF9USU1F
T1VUOwogCWVuZ2luZS0+cHJvcHMuc3RvcF90aW1lb3V0X21zID0KIAkJQ09ORklHX0RSTV9JOTE1
X1NUT1BfVElNRU9VVDsKKwllbmdpbmUtPnByb3BzLnRpbWVzbGljZV9kdXJhdGlvbl9tcyA9CisJ
CUNPTkZJR19EUk1fSTkxNV9USU1FU0xJQ0VfRFVSQVRJT047CiAKIAkvKgogCSAqIFRvIGJlIG92
ZXJyaWRkZW4gYnkgdGhlIGJhY2tlbmQgb24gc2V0dXAuIEhvd2V2ZXIgdG8gZmFjaWxpdGF0ZQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaAppbmRleCBlOGVh
MTJiOTY3NTUuLmM1ZDEwNDdhNGJjNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lX3R5cGVzLmgKQEAgLTUyMyw2ICs1MjMsNyBAQCBzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzIHsKIAkJdW5zaWduZWQgbG9uZyBoZWFydGJlYXRfaW50ZXJ2YWxfbXM7CiAJCXVuc2lnbmVk
IGxvbmcgcHJlZW1wdF90aW1lb3V0X21zOwogCQl1bnNpZ25lZCBsb25nIHN0b3BfdGltZW91dF9t
czsKKwkJdW5zaWduZWQgbG9uZyB0aW1lc2xpY2VfZHVyYXRpb25fbXM7CiAJfSBwcm9wczsKIH07
CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKaW5kZXggMmY0NzRjMWY1YzU0Li42ZmIz
ZGVmNWJhMTYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCkBAIC0xNDY3LDcgKzE0
NjcsNyBAQCBuZWVkX3RpbWVzbGljZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIGNv
bnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewogCWludCBoaW50OwogCi0JaWYgKCFpbnRl
bF9lbmdpbmVfaGFzX3NlbWFwaG9yZXMoZW5naW5lKSkKKwlpZiAoIWludGVsX2VuZ2luZV9oYXNf
dGltZXNsaWNlcyhlbmdpbmUpKQogCQlyZXR1cm4gZmFsc2U7CiAKIAlpZiAobGlzdF9pc19sYXN0
KCZycS0+c2NoZWQubGluaywgJmVuZ2luZS0+YWN0aXZlLnJlcXVlc3RzKSkKQEAgLTE0ODgsMTUg
KzE0ODgsMzIgQEAgc3dpdGNoX3ByaW8oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBj
b25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAlyZXR1cm4gcnFfcHJpbyhsaXN0X25leHRf
ZW50cnkocnEsIHNjaGVkLmxpbmspKTsKIH0KIAotc3RhdGljIGJvb2wKLWVuYWJsZV90aW1lc2xp
Y2UoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKmV4ZWNsaXN0cykKK3N0YXRp
YyBpbmxpbmUgdW5zaWduZWQgbG9uZwordGltZXNsaWNlKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKK3sKKwlyZXR1cm4gUkVBRF9PTkNFKGVuZ2luZS0+cHJvcHMudGltZXNs
aWNlX2R1cmF0aW9uX21zKTsKK30KKworc3RhdGljIHVuc2lnbmVkIGxvbmcKK2FjdGl2ZV90aW1l
c2xpY2UoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewotCWNvbnN0IHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxID0gKmV4ZWNsaXN0cy0+YWN0aXZlOworCWNvbnN0IHN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxID0gKmVuZ2luZS0+ZXhlY2xpc3RzLmFjdGl2ZTsKIAogCWlmIChp
OTE1X3JlcXVlc3RfY29tcGxldGVkKHJxKSkKLQkJcmV0dXJuIGZhbHNlOworCQlyZXR1cm4gMDsK
KworCWlmIChlbmdpbmUtPmV4ZWNsaXN0cy5zd2l0Y2hfcHJpb3JpdHlfaGludCA8IGVmZmVjdGl2
ZV9wcmlvKHJxKSkKKwkJcmV0dXJuIDA7CisKKwlyZXR1cm4gdGltZXNsaWNlKGVuZ2luZSk7Cit9
CisKK3N0YXRpYyB2b2lkIHNldF90aW1lc2xpY2Uoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKQoreworCWlmICghaW50ZWxfZW5naW5lX2hhc190aW1lc2xpY2VzKGVuZ2luZSkpCisJCXJl
dHVybjsKIAotCXJldHVybiBleGVjbGlzdHMtPnN3aXRjaF9wcmlvcml0eV9oaW50ID49IGVmZmVj
dGl2ZV9wcmlvKHJxKTsKKwlzZXRfdGltZXJfbXMoJmVuZ2luZS0+ZXhlY2xpc3RzLnRpbWVyLCBh
Y3RpdmVfdGltZXNsaWNlKGVuZ2luZSkpOwogfQogCiBzdGF0aWMgdm9pZCByZWNvcmRfcHJlZW1w
dGlvbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqZXhlY2xpc3RzKQpAQCAtMTY2Nyw4
ICsxNjg0LDkgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2RlcXVldWUoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogCQkJCSAqLwogCQkJCWlmICghZXhlY2xpc3RzLT50aW1lci5leHBp
cmVzICYmCiAJCQkJICAgIG5lZWRfdGltZXNsaWNlKGVuZ2luZSwgbGFzdCkpCi0JCQkJCW1vZF90
aW1lcigmZXhlY2xpc3RzLT50aW1lciwKLQkJCQkJCSAgamlmZmllcyArIDEpOworCQkJCQlzZXRf
dGltZXJfbXMoJmV4ZWNsaXN0cy0+dGltZXIsCisJCQkJCQkgICAgIHRpbWVzbGljZShlbmdpbmUp
KTsKKwogCQkJCXJldHVybjsKIAkJCX0KIApAQCAtMjA5MiwxMCArMjExMCw3IEBAIHN0YXRpYyB2
b2lkIHByb2Nlc3NfY3NiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJCQkgICAg
ICAgZXhlY2xpc3RzX251bV9wb3J0cyhleGVjbGlzdHMpICoKIAkJCQkgICAgICAgc2l6ZW9mKCpl
eGVjbGlzdHMtPnBlbmRpbmcpKTsKIAotCQkJaWYgKGVuYWJsZV90aW1lc2xpY2UoZXhlY2xpc3Rz
KSkKLQkJCQltb2RfdGltZXIoJmV4ZWNsaXN0cy0+dGltZXIsIGppZmZpZXMgKyAxKTsKLQkJCWVs
c2UKLQkJCQljYW5jZWxfdGltZXIoJmV4ZWNsaXN0cy0+dGltZXIpOworCQkJc2V0X3RpbWVzbGlj
ZShlbmdpbmUpOwogCiAJCQlXUklURV9PTkNFKGV4ZWNsaXN0cy0+cGVuZGluZ1swXSwgTlVMTCk7
CiAJCX0gZWxzZSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVz
dF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCmluZGV4IDk1
MDdkNzUwYWUxNC4uNWVkMjc1ZWYwOTg0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF9scmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVz
dF9scmMuYwpAQCAtNDQwLDYgKzQ0MCw4IEBAIHN0YXRpYyBpbnQgbGl2ZV90aW1lc2xpY2VfcHJl
ZW1wdCh2b2lkICphcmcpCiAJICogbmVlZCB0byBwcmVlbXB0IHRoZSBjdXJyZW50IHRhc2sgYW5k
IHJlcGxhY2UgaXQgd2l0aCBhbm90aGVyCiAJICogcmVhZHkgdGFzay4KIAkgKi8KKwlpZiAoIUNP
TkZJR19EUk1fSTkxNV9USU1FU0xJQ0VfRFVSQVRJT04pCisJCXJldHVybiAwOwogCiAJb2JqID0g
aTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChndC0+aTkxNSwgUEFHRV9TSVpFKTsKIAlp
ZiAoSVNfRVJSKG9iaikpCkBAIC01MTQsNiArNTE2LDExIEBAIHN0YXRpYyB2b2lkIHdhaXRfZm9y
X3N1Ym1pdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJfSB3aGlsZSAoIWk5MTVf
cmVxdWVzdF9pc19hY3RpdmUocnEpKTsKIH0KIAorc3RhdGljIGxvbmcgdGltZXNsaWNlX3RocmVz
aG9sZChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJcmV0dXJuIDIg
KiBtc2Vjc190b19qaWZmaWVzX3RpbWVvdXQodGltZXNsaWNlKGVuZ2luZSkpICsgMTsKK30KKwog
c3RhdGljIGludCBsaXZlX3RpbWVzbGljZV9xdWV1ZSh2b2lkICphcmcpCiB7CiAJc3RydWN0IGlu
dGVsX2d0ICpndCA9IGFyZzsKQEAgLTUzMSw2ICs1MzgsOCBAQCBzdGF0aWMgaW50IGxpdmVfdGlt
ZXNsaWNlX3F1ZXVlKHZvaWQgKmFyZykKIAkgKiBFTFNQWzFdIGlzIGFscmVhZHkgb2NjdXBpZWQs
IHNvIG11c3QgcmVseSBvbiB0aW1lc2xpY2luZyB0bwogCSAqIGVqZWN0IEVMU1BbMF0gaW4gZmF2
b3VyIG9mIHRoZSBxdWV1ZS4pCiAJICovCisJaWYgKCFDT05GSUdfRFJNX0k5MTVfVElNRVNMSUNF
X0RVUkFUSU9OKQorCQlyZXR1cm4gMDsKIAogCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVf
aW50ZXJuYWwoZ3QtPmk5MTUsIFBBR0VfU0laRSk7CiAJaWYgKElTX0VSUihvYmopKQpAQCAtNjA4
LDggKzYxNyw4IEBAIHN0YXRpYyBpbnQgbGl2ZV90aW1lc2xpY2VfcXVldWUodm9pZCAqYXJnKQog
CQkJZXJyID0gLUVJTlZBTDsKIAkJfQogCi0JCS8qIFRpbWVzbGljZSBldmVyeSBqaWZmaWUsIHNv
IHdpdGhpbiAyIHdlIHNob3VsZCBzaWduYWwgKi8KLQkJaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJx
LCAwLCAzKSA8IDApIHsKKwkJLyogVGltZXNsaWNlIGV2ZXJ5IGppZmZ5LCBzbyB3aXRoaW4gMiB3
ZSBzaG91bGQgc2lnbmFsICovCisJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgdGltZXNs
aWNlX3RocmVzaG9sZChlbmdpbmUpKSA8IDApIHsKIAkJCXN0cnVjdCBkcm1fcHJpbnRlciBwID0K
IAkJCQlkcm1faW5mb19wcmludGVyKGd0LT5pOTE1LT5kcm0uZGV2KTsKIAotLSAKMi4yNC4wLnJj
MQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwt
Z2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8v
bGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id BCC1216A678
	for <lists+intel-gfx@lfdr.de>; Mon, 24 Feb 2020 13:52:42 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id AC2EC6E466;
	Mon, 24 Feb 2020 12:52:38 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7E6516E461
 for <intel-gfx@lists.freedesktop.org>; Mon, 24 Feb 2020 12:52:37 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 24 Feb 2020 04:52:37 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.70,480,1574150400"; d="scan'208";a="225967587"
Received: from unknown (HELO genxfsim-desktop.iind.intel.com) ([10.223.74.178])
 by orsmga007.jf.intel.com with ESMTP; 24 Feb 2020 04:52:35 -0800
From: Anshuman Gupta <anshuman.gupta@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 24 Feb 2020 18:09:59 +0530
Message-Id: <20200224124004.26712-3-anshuman.gupta@intel.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20200224124004.26712-1-anshuman.gupta@intel.com>
References: <20200224124004.26712-1-anshuman.gupta@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3 2/7] drm/i915: Remove (pipe == crtc->index)
 assumption
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: jani.nikula@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

d2UgY2FuJ3QgaGF2ZSAocGlwZSA9PSBjcnRjLT5pbmRleCkgYXNzdW1wdGlvbiBpbgpkcml2ZXIg
aW4gb3JkZXIgdG8gc3VwcG9ydCAzIG5vbi1jb250aWd1b3VzCmRpc3BsYXkgcGlwZSBzeXN0ZW0u
CgpGSVhNRTogUmVtb3ZlIHRoZSBXQVJOX09OKGRybV9jcnRjX2luZGV4KCZjcnRjLT5iYXNlKSAh
PSBjcnRjLT5waXBlKQp3aGVuIHdlIHdpbGwgZml4IGFsbCBzdWNoIGFzc3VtcHRpb24uCgpjaGFu
Z2VzIHNpbmNlIFJGQzoKLSBBZGRlZCBhZ2FpbiByZW1vdmVkIChwaXBlID09IGNydGMtPmluZGV4
KSBXQVJOX09OLgotIFBhc3MgZHJtX2NydGNfaW5kZXggaW5zdGVhZCBvZiBpbnRlbCBwaXBlIGlu
IG9yZGVyIHRvCiAgY2FsbCBkcm1faGFuZGxlX3ZibGFuaygpLgp2MjoKLSBVc2VkIGRybV9jcnRj
X2hhbmRsZV92YmxhbmsoKS9kcm1fY3J0Y193YWl0X29uZV92YmxhbmsoKQogIGluc3RlYWQgb2Yg
ZHJtX2hhbmRsZV92YmxhbmsvZHJtX3dhaXRfb25lX3ZibGFuaygpLiBbSmFuaV0KLSBJbnRyb2R1
Y2VkIGludGVsX2hhbmRsZV92YmxhbmsoKSBoZWxwZXIgdG8gYXZvaWQgc3ByaW5rbGUKICBvZiBp
bnRlbF9jcnRjIGFjcm9zcyBpcnFfaGFuZGxlcnMuIFtWaWxsZV0KdjM6Ci0gTW92ZWQgaW50ZWxf
aGFuZGxlX3ZibGFuaygpIGZyb20gaGVhZGVyIHRvIGk5MTVfaXJxLmMuIFtWaWxsZV0KCkNjOiBW
aWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgpDYzogSmFuaSBO
aWt1bGEgPGphbmkubmlrdWxhQGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IFZpbGxlIFN5cmrDpGzD
pCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IEFuc2h1bWFu
IEd1cHRhIDxhbnNodW1hbi5ndXB0YUBpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgIHwgIDggKysrLS0tLQogLi4uL2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oICAgIHwgIDYgKysrKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfaXJxLmMgICAgICAgICAgICAgICB8IDIyICsrKysrKysrKysrKystLS0tLS0K
IDMgZmlsZXMgY2hhbmdlZCwgMjQgaW5zZXJ0aW9ucygrKSwgMTIgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwppbmRleCAzMDMxZTY0
ZWU1MTguLjNhYWI5NzU3M2MwYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5LmMKQEAgLTE0Mjk5LDExICsxNDI5OSwxMSBAQCB2ZXJpZnlfc2luZ2xlX2Rw
bGxfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCWlmIChuZXdfY3J0
Y19zdGF0ZS0+aHcuYWN0aXZlKQogCQlJOTE1X1NUQVRFX1dBUk4oIShwbGwtPmFjdGl2ZV9tYXNr
ICYgY3J0Y19tYXNrKSwKIAkJCQkicGxsIGFjdGl2ZSBtaXNtYXRjaCAoZXhwZWN0ZWQgcGlwZSAl
YyBpbiBhY3RpdmUgbWFzayAweCUwMngpXG4iLAotCQkJCXBpcGVfbmFtZShkcm1fY3J0Y19pbmRl
eCgmY3J0Yy0+YmFzZSkpLCBwbGwtPmFjdGl2ZV9tYXNrKTsKKwkJCQlwaXBlX25hbWUoY3J0Yy0+
cGlwZSksIHBsbC0+YWN0aXZlX21hc2spOwogCWVsc2UKIAkJSTkxNV9TVEFURV9XQVJOKHBsbC0+
YWN0aXZlX21hc2sgJiBjcnRjX21hc2ssCiAJCQkJInBsbCBhY3RpdmUgbWlzbWF0Y2ggKGRpZG4n
dCBleHBlY3QgcGlwZSAlYyBpbiBhY3RpdmUgbWFzayAweCUwMngpXG4iLAotCQkJCXBpcGVfbmFt
ZShkcm1fY3J0Y19pbmRleCgmY3J0Yy0+YmFzZSkpLCBwbGwtPmFjdGl2ZV9tYXNrKTsKKwkJCQlw
aXBlX25hbWUoY3J0Yy0+cGlwZSksIHBsbC0+YWN0aXZlX21hc2spOwogCiAJSTkxNV9TVEFURV9X
QVJOKCEocGxsLT5zdGF0ZS5jcnRjX21hc2sgJiBjcnRjX21hc2spLAogCQkJInBsbCBlbmFibGVk
IGNydGNzIG1pc21hdGNoIChleHBlY3RlZCAweCV4IGluIDB4JTAyeClcbiIsCkBAIC0xNDMzMiwx
MCArMTQzMzIsMTAgQEAgdmVyaWZ5X3NoYXJlZF9kcGxsX3N0YXRlKHN0cnVjdCBpbnRlbF9jcnRj
ICpjcnRjLAogCiAJCUk5MTVfU1RBVEVfV0FSTihwbGwtPmFjdGl2ZV9tYXNrICYgY3J0Y19tYXNr
LAogCQkJCSJwbGwgYWN0aXZlIG1pc21hdGNoIChkaWRuJ3QgZXhwZWN0IHBpcGUgJWMgaW4gYWN0
aXZlIG1hc2spXG4iLAotCQkJCXBpcGVfbmFtZShkcm1fY3J0Y19pbmRleCgmY3J0Yy0+YmFzZSkp
KTsKKwkJCQlwaXBlX25hbWUoY3J0Yy0+cGlwZSkpOwogCQlJOTE1X1NUQVRFX1dBUk4ocGxsLT5z
dGF0ZS5jcnRjX21hc2sgJiBjcnRjX21hc2ssCiAJCQkJInBsbCBlbmFibGVkIGNydGNzIG1pc21h
dGNoIChmb3VuZCAleCBpbiBlbmFibGVkIG1hc2spXG4iLAotCQkJCXBpcGVfbmFtZShkcm1fY3J0
Y19pbmRleCgmY3J0Yy0+YmFzZSkpKTsKKwkJCQlwaXBlX25hbWUoY3J0Yy0+cGlwZSkpOwogCX0K
IH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNw
bGF5X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlf
dHlwZXMuaAppbmRleCAwZDhhNjQzMDU0NjQuLjM4MGViZTVlZTI2ZCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKQEAgLTE1OTgs
MTEgKzE1OTgsMTUgQEAgaW50ZWxfY3J0Y19oYXNfZHBfZW5jb2Rlcihjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIAkJICgxIDw8IElOVEVMX09VVFBVVF9EUF9NU1Qp
IHwKIAkJICgxIDw8IElOVEVMX09VVFBVVF9FRFApKTsKIH0KKwogc3RhdGljIGlubGluZSB2b2lk
CiBpbnRlbF93YWl0X2Zvcl92Ymxhbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBlbnVtIHBpcGUgcGlwZSkKIHsKLQlkcm1fd2FpdF9vbmVfdmJsYW5rKCZkZXZfcHJpdi0+ZHJt
LCBwaXBlKTsKKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9w
aXBlKGRldl9wcml2LCBwaXBlKTsKKworCWRybV9jcnRjX3dhaXRfb25lX3ZibGFuaygmY3J0Yy0+
YmFzZSk7CiB9CisKIHN0YXRpYyBpbmxpbmUgdm9pZAogaW50ZWxfd2FpdF9mb3JfdmJsYW5rX2lm
X2FjdGl2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gcGlwZSBwaXBl
KQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMKaW5kZXggODU0NzAxYWFiNGYxLi4zYmVhNTE5ZDk4
NWEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYwpAQCAtMTY5LDYgKzE2OSwxNCBAQCBzdGF0aWMg
Y29uc3QgdTMyIGhwZF90Z3BbSFBEX05VTV9QSU5TXSA9IHsKIAlbSFBEX1BPUlRfSV0gPSBTREVf
VENfSE9UUExVR19JQ1AoUE9SVF9UQzYpLAogfTsKIAorc3RhdGljIHZvaWQKK2ludGVsX2hhbmRs
ZV92Ymxhbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBpcGUgcGlw
ZSkKK3sKKwlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IGludGVsX2dldF9jcnRjX2Zvcl9waXBl
KGRldl9wcml2LCBwaXBlKTsKKworCWRybV9jcnRjX2hhbmRsZV92YmxhbmsoJmNydGMtPmJhc2Up
OworfQorCiB2b2lkIGdlbjNfaXJxX3Jlc2V0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwg
aTkxNV9yZWdfdCBpbXIsCiAJCSAgICBpOTE1X3JlZ190IGlpciwgaTkxNV9yZWdfdCBpZXIpCiB7
CkBAIC0xMzc0LDcgKzEzODIsNyBAQCBzdGF0aWMgdm9pZCBpOHh4X3BpcGVzdGF0X2lycV9oYW5k
bGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAogCWZvcl9lYWNoX3BpcGUo
ZGV2X3ByaXYsIHBpcGUpIHsKIAkJaWYgKHBpcGVfc3RhdHNbcGlwZV0gJiBQSVBFX1ZCTEFOS19J
TlRFUlJVUFRfU1RBVFVTKQotCQkJZHJtX2hhbmRsZV92YmxhbmsoJmRldl9wcml2LT5kcm0sIHBp
cGUpOworCQkJaW50ZWxfaGFuZGxlX3ZibGFuayhkZXZfcHJpdiwgcGlwZSk7CiAKIAkJaWYgKHBp
cGVfc3RhdHNbcGlwZV0gJiBQSVBFX0NSQ19ET05FX0lOVEVSUlVQVF9TVEFUVVMpCiAJCQlpOXh4
X3BpcGVfY3JjX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBlKTsKQEAgLTEzOTIsNyArMTQwMCw3
IEBAIHN0YXRpYyB2b2lkIGk5MTVfcGlwZXN0YXRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAogCiAJZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewog
CQlpZiAocGlwZV9zdGF0c1twaXBlXSAmIFBJUEVfVkJMQU5LX0lOVEVSUlVQVF9TVEFUVVMpCi0J
CQlkcm1faGFuZGxlX3ZibGFuaygmZGV2X3ByaXYtPmRybSwgcGlwZSk7CisJCQlpbnRlbF9oYW5k
bGVfdmJsYW5rKGRldl9wcml2LCBwaXBlKTsKIAogCQlpZiAocGlwZV9zdGF0c1twaXBlXSAmIFBJ
UEVfTEVHQUNZX0JMQ19FVkVOVF9TVEFUVVMpCiAJCQlibGNfZXZlbnQgPSB0cnVlOwpAQCAtMTQx
Niw3ICsxNDI0LDcgQEAgc3RhdGljIHZvaWQgaTk2NV9waXBlc3RhdF9pcnFfaGFuZGxlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAKIAlmb3JfZWFjaF9waXBlKGRldl9wcml2
LCBwaXBlKSB7CiAJCWlmIChwaXBlX3N0YXRzW3BpcGVdICYgUElQRV9TVEFSVF9WQkxBTktfSU5U
RVJSVVBUX1NUQVRVUykKLQkJCWRybV9oYW5kbGVfdmJsYW5rKCZkZXZfcHJpdi0+ZHJtLCBwaXBl
KTsKKwkJCWludGVsX2hhbmRsZV92YmxhbmsoZGV2X3ByaXYsIHBpcGUpOwogCiAJCWlmIChwaXBl
X3N0YXRzW3BpcGVdICYgUElQRV9MRUdBQ1lfQkxDX0VWRU5UX1NUQVRVUykKIAkJCWJsY19ldmVu
dCA9IHRydWU7CkBAIC0xNDQyLDcgKzE0NTAsNyBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X3Bp
cGVzdGF0X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAog
CWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKIAkJaWYgKHBpcGVfc3RhdHNbcGlwZV0g
JiBQSVBFX1NUQVJUX1ZCTEFOS19JTlRFUlJVUFRfU1RBVFVTKQotCQkJZHJtX2hhbmRsZV92Ymxh
bmsoJmRldl9wcml2LT5kcm0sIHBpcGUpOworCQkJaW50ZWxfaGFuZGxlX3ZibGFuayhkZXZfcHJp
diwgcGlwZSk7CiAKIAkJaWYgKHBpcGVfc3RhdHNbcGlwZV0gJiBQSVBFX0NSQ19ET05FX0lOVEVS
UlVQVF9TVEFUVVMpCiAJCQlpOXh4X3BpcGVfY3JjX2lycV9oYW5kbGVyKGRldl9wcml2LCBwaXBl
KTsKQEAgLTE5ODAsNyArMTk4OCw3IEBAIHN0YXRpYyB2b2lkIGlsa19kaXNwbGF5X2lycV9oYW5k
bGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAogCWZvcl9lYWNoX3BpcGUo
ZGV2X3ByaXYsIHBpcGUpIHsKIAkJaWYgKGRlX2lpciAmIERFX1BJUEVfVkJMQU5LKHBpcGUpKQot
CQkJZHJtX2hhbmRsZV92YmxhbmsoJmRldl9wcml2LT5kcm0sIHBpcGUpOworCQkJaW50ZWxfaGFu
ZGxlX3ZibGFuayhkZXZfcHJpdiwgcGlwZSk7CiAKIAkJaWYgKGRlX2lpciAmIERFX1BJUEVfRklG
T19VTkRFUlJVTihwaXBlKSkKIAkJCWludGVsX2NwdV9maWZvX3VuZGVycnVuX2lycV9oYW5kbGVy
KGRldl9wcml2LCBwaXBlKTsKQEAgLTIwMzMsNyArMjA0MSw3IEBAIHN0YXRpYyB2b2lkIGl2Yl9k
aXNwbGF5X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAog
CWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKIAkJaWYgKGRlX2lpciAmIChERV9QSVBF
X1ZCTEFOS19JVkIocGlwZSkpKQotCQkJZHJtX2hhbmRsZV92YmxhbmsoJmRldl9wcml2LT5kcm0s
IHBpcGUpOworCQkJaW50ZWxfaGFuZGxlX3ZibGFuayhkZXZfcHJpdiwgcGlwZSk7CiAJfQogCiAJ
LyogY2hlY2sgZXZlbnQgZnJvbSBQQ0ggKi8KQEAgLTIzNDYsNyArMjM1NCw3IEBAIGdlbjhfZGVf
aXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgbWFzdGVy
X2N0bCkKIAkJSTkxNV9XUklURShHRU44X0RFX1BJUEVfSUlSKHBpcGUpLCBpaXIpOwogCiAJCWlm
IChpaXIgJiBHRU44X1BJUEVfVkJMQU5LKQotCQkJZHJtX2hhbmRsZV92YmxhbmsoJmRldl9wcml2
LT5kcm0sIHBpcGUpOworCQkJaW50ZWxfaGFuZGxlX3ZibGFuayhkZXZfcHJpdiwgcGlwZSk7CiAK
IAkJaWYgKGlpciAmIEdFTjhfUElQRV9DRENMS19DUkNfRE9ORSkKIAkJCWhzd19waXBlX2NyY19p
cnFfaGFuZGxlcihkZXZfcHJpdiwgcGlwZSk7Ci0tIAoyLjI0LjAKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50
ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DDEFB10C095
	for <lists+intel-gfx@lfdr.de>; Thu, 28 Nov 2019 00:25:14 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8977E6E119;
	Wed, 27 Nov 2019 23:25:12 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga14.intel.com (mga14.intel.com [192.55.52.115])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 656296E119
 for <intel-gfx@lists.freedesktop.org>; Wed, 27 Nov 2019 23:25:11 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by fmsmga103.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 27 Nov 2019 15:25:10 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,251,1571727600"; d="scan'208";a="199342981"
Received: from fmsmsx104.amr.corp.intel.com ([10.18.124.202])
 by orsmga007.jf.intel.com with ESMTP; 27 Nov 2019 15:25:10 -0800
Received: from fmsmsx126.amr.corp.intel.com (10.18.125.43) by
 fmsmsx104.amr.corp.intel.com (10.18.124.202) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Wed, 27 Nov 2019 15:25:08 -0800
Received: from fmsmsx117.amr.corp.intel.com ([169.254.3.27]) by
 FMSMSX126.amr.corp.intel.com ([169.254.1.160]) with mapi id 14.03.0439.000;
 Wed, 27 Nov 2019 15:25:08 -0800
From: "Souza, Jose" <jose.souza@intel.com>
To: "ville.syrjala@linux.intel.com" <ville.syrjala@linux.intel.com>,
 "intel-gfx@lists.freedesktop.org" <intel-gfx@lists.freedesktop.org>
Thread-Topic: [Intel-gfx] [PATCH 4/7] drm/i915: Clean up intel_{pre,
 post}_plane_update()
Thread-Index: AQHVpVXBqY0qTfzeg0yawPwmqH/TXqegLz+A
Date: Wed, 27 Nov 2019 23:25:07 +0000
Message-ID: <7c8dc4d946397ad797d418ae98313965194c8211.camel@intel.com>
References: <20191127190556.1574-1-ville.syrjala@linux.intel.com>
 <20191127190556.1574-5-ville.syrjala@linux.intel.com>
In-Reply-To: <20191127190556.1574-5-ville.syrjala@linux.intel.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [10.98.40.66]
Content-ID: <2D4D07945CFEBC47BFDA1D470022574B@intel.com>
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [PATCH 4/7] drm/i915: Clean up intel_{pre,
 post}_plane_update()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gV2VkLCAyMDE5LTExLTI3IGF0IDIxOjA1ICswMjAwLCBWaWxsZSBTeXJqYWxhIHdyb3RlOg0K
PiBGcm9tOiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPg0K
PiANCj4gQ2hhbmdlIHRoZSBjYWxsaW5nIGNvbnZlbnRpb24gdG8ganVzdCBwYXNzIHRoZSBzdGF0
ZStjcnRjIGFuZA0KPiBzd2l0Y2ggdG8gaW50ZWxfIHR5cGVzIHRocm91Z2hvdXQuDQo+IA0KPiBT
aWduZWQtb2ZmLWJ5OiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwu
Y29tPg0KPiAtLS0NCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eS5jIHwgODggKysrKysrKysrLS0tLS0tLS0tDQo+IC0tDQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2ZiYy5jICAgICB8IDE0ICsrLS0NCj4gIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZmJjLmggICAgIHwgIDggKy0NCj4gIDMgZmlsZXMgY2hhbmdlZCwg
NTEgaW5zZXJ0aW9ucygrKSwgNTkgZGVsZXRpb25zKC0pDQo+IA0KPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMNCj4gYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYw0KPiBpbmRleCBlMzQxYjk3YjdkZWMu
LjcyNjU1YjViMTM2NSAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9kaXNwbGF5LmMNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5LmMNCj4gQEAgLTU5MjAsMTMgKzU5MjAsMTAgQEAgc3RhdGljIHZvaWQNCj4g
aW50ZWxfY3J0Y19kcG1zX292ZXJsYXlfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxf
Y3J0YykNCj4gICAqIGNvbXBsZXRlbHkgaGlkZSB0aGUgcHJpbWFyeSBwbGFuZS4NCj4gICAqLw0K
PiAgc3RhdGljIHZvaWQNCj4gLWludGVsX3Bvc3RfZW5hYmxlX3ByaW1hcnkoc3RydWN0IGRybV9j
cnRjICpjcnRjLA0KPiAtCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiAqbmV3
X2NydGNfc3RhdGUpDQo+ICtpbnRlbF9wb3N0X2VuYWJsZV9wcmltYXJ5KHN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjKQ0KPiAgew0KPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5kZXY7
DQo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOw0K
PiAtCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjKTsN
Cj4gLQllbnVtIHBpcGUgcGlwZSA9IGludGVsX2NydGMtPnBpcGU7DQo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7DQo+ICsJZW51
bSBwaXBlIHBpcGUgPSBjcnRjLT5waXBlOw0KPiAgDQo+ICAJLyoNCj4gIAkgKiBHZW4yIHJlcG9y
dHMgcGlwZSB1bmRlcnJ1bnMgd2hlbmV2ZXIgYWxsIHBsYW5lcyBhcmUNCj4gZGlzYWJsZWQuDQo+
IEBAIC02MDYyLDIwICs2MDU5LDIxIEBAIHN0YXRpYyBib29sIG5lZWRzX3NjYWxlcmNsa193YShj
b25zdCBzdHJ1Y3QNCj4gaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkNCj4gIAlyZXR1cm4g
ZmFsc2U7DQo+ICB9DQo+ICANCj4gLXN0YXRpYyB2b2lkIGludGVsX3Bvc3RfcGxhbmVfdXBkYXRl
KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlDQo+ICpvbGRfY3J0Y19zdGF0ZSkNCj4gK3N0YXRpYyB2
b2lkIGludGVsX3Bvc3RfcGxhbmVfdXBkYXRlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUNCj4g
KnN0YXRlLA0KPiArCQkJCSAgICBzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykNCj4gIHsNCj4gLQlz
dHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2NydGNfc3RhdGUtDQo+
ID51YXBpLmNydGMpOw0KPiAtCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRl
djsNCj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7
DQo+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gb2xkX2NydGNfc3RhdGUtPnVh
cGkuc3RhdGU7DQo+IC0Jc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlID0N
Cj4gLQkJaW50ZWxfYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZSh0b19pbnRlbF9hdG9taWNfc3Rh
dGUocw0KPiB0YXRlKSwNCj4gLQkJCQkJCWNydGMpOw0KPiAtCXN0cnVjdCBkcm1fcGxhbmUgKnBy
aW1hcnkgPSBjcnRjLT5iYXNlLnByaW1hcnk7DQo+IC0Jc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAq
b2xkX3ByaW1hcnlfc3RhdGUgPQ0KPiAtCQlkcm1fYXRvbWljX2dldF9vbGRfcGxhbmVfc3RhdGUo
c3RhdGUsIHByaW1hcnkpOw0KPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsNCj4gKwlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnByaW1h
cnkgPSB0b19pbnRlbF9wbGFuZShjcnRjLQ0KPiA+YmFzZS5wcmltYXJ5KTsNCj4gKwljb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUgPQ0KPiArCQlpbnRlbF9hdG9t
aWNfZ2V0X29sZF9jcnRjX3N0YXRlKHN0YXRlLCBjcnRjKTsNCj4gKwljb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNfc3RhdGUgPQ0KPiArCQlpbnRlbF9hdG9taWNfZ2V0X25l
d19jcnRjX3N0YXRlKHN0YXRlLCBjcnRjKTsNCj4gKwljb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVf
c3RhdGUgKm9sZF9wcmltYXJ5X3N0YXRlID0NCj4gKwkJaW50ZWxfYXRvbWljX2dldF9vbGRfcGxh
bmVfc3RhdGUoc3RhdGUsIHByaW1hcnkpOw0KPiArCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9z
dGF0ZSAqbmV3X3ByaW1hcnlfc3RhdGUgPQ0KPiArCQlpbnRlbF9hdG9taWNfZ2V0X25ld19wbGFu
ZV9zdGF0ZShzdGF0ZSwgcHJpbWFyeSk7DQo+ICANCj4gLQlpbnRlbF9mcm9udGJ1ZmZlcl9mbGlw
KHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpLCBuZXdfY3J0Y19zdGF0ZS0NCj4gPmZiX2JpdHMpOw0K
PiArCWludGVsX2Zyb250YnVmZmVyX2ZsaXAoZGV2X3ByaXYsIG5ld19jcnRjX3N0YXRlLT5mYl9i
aXRzKTsNCj4gIA0KPiAgCWlmIChuZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3dtX3Bvc3QgJiYgbmV3
X2NydGNfc3RhdGUtDQo+ID5ody5hY3RpdmUpDQo+ICAJCWludGVsX3VwZGF0ZV93YXRlcm1hcmtz
KGNydGMpOw0KPiBAQCAtNjA4MywxNiArNjA4MSwxMyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9wb3N0
X3BsYW5lX3VwZGF0ZShzdHJ1Y3QNCj4gaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUp
DQo+ICAJaWYgKGhzd19wb3N0X3VwZGF0ZV9lbmFibGVfaXBzKG9sZF9jcnRjX3N0YXRlLCBuZXdf
Y3J0Y19zdGF0ZSkpDQo+ICAJCWhzd19lbmFibGVfaXBzKG5ld19jcnRjX3N0YXRlKTsNCj4gIA0K
PiAtCWlmIChvbGRfcHJpbWFyeV9zdGF0ZSkgew0KPiAtCQlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRl
ICpuZXdfcHJpbWFyeV9zdGF0ZSA9DQo+IC0JCQlkcm1fYXRvbWljX2dldF9uZXdfcGxhbmVfc3Rh
dGUoc3RhdGUsIHByaW1hcnkpOw0KPiAtDQo+ICsJaWYgKG5ld19wcmltYXJ5X3N0YXRlKSB7DQoN
Cg0KVGhpcyBjaGFuZ2UgZnJvbSBvbGRfcHJpbWFyeV9zdGF0ZSB0byBuZXdfcHJpbWFyeV9zdGF0
ZSBpcyB3YXkgbW9yZQ0KdGhhbiB0aGUgY29tbWl0IG1lc3NhZ2Ugc2F5cywgdGhlIGNoYW5nZSBs
b29rcyByaWdodCB0byBtZSBidXQgbWF5YmUgaXQNCmRlc2VydmVzIGEgc2VwYXJhdGVkIHBhdGNo
PyBTYW1lIGZvciB0aGUgc2FtZSBjaGFuZ2UgaW4NCmludGVsX3ByZV9wbGFuZV91cGRhdGUoKQ0K
DQo+ICAJCWludGVsX2ZiY19wb3N0X3VwZGF0ZShjcnRjKTsNCj4gIA0KPiAtCQlpZiAobmV3X3By
aW1hcnlfc3RhdGUtPnZpc2libGUgJiYNCj4gKwkJaWYgKG5ld19wcmltYXJ5X3N0YXRlLT51YXBp
LnZpc2libGUgJiYNCj4gIAkJICAgIChuZWVkc19tb2Rlc2V0KG5ld19jcnRjX3N0YXRlKSB8fA0K
PiAtCQkgICAgICFvbGRfcHJpbWFyeV9zdGF0ZS0+dmlzaWJsZSkpDQo+IC0JCQlpbnRlbF9wb3N0
X2VuYWJsZV9wcmltYXJ5KCZjcnRjLT5iYXNlLA0KPiBuZXdfY3J0Y19zdGF0ZSk7DQo+ICsJCSAg
ICAgIW9sZF9wcmltYXJ5X3N0YXRlLT51YXBpLnZpc2libGUpKQ0KPiArCQkJaW50ZWxfcG9zdF9l
bmFibGVfcHJpbWFyeShjcnRjKTsNCj4gIAl9DQo+ICANCj4gIAlpZiAobmVlZHNfbnYxMl93YShv
bGRfY3J0Y19zdGF0ZSkgJiYNCj4gQEAgLTYxMDQsMzQgKzYwOTksMzEgQEAgc3RhdGljIHZvaWQg
aW50ZWxfcG9zdF9wbGFuZV91cGRhdGUoc3RydWN0DQo+IGludGVsX2NydGNfc3RhdGUgKm9sZF9j
cnRjX3N0YXRlKQ0KPiAgCQlpY2xfd2Ffc2NhbGVyY2xrZ2F0aW5nKGRldl9wcml2LCBjcnRjLT5w
aXBlLCBmYWxzZSk7DQo+ICB9DQo+ICANCj4gLXN0YXRpYyB2b2lkIGludGVsX3ByZV9wbGFuZV91
cGRhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUNCj4gKm9sZF9jcnRjX3N0YXRlLA0KPiAtCQkJ
CSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlDQo+ICpuZXdfY3J0Y19zdGF0ZSkNCj4gK3N0YXRp
YyB2b2lkIGludGVsX3ByZV9wbGFuZV91cGRhdGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUsDQo+ICsJCQkJICAgc3RydWN0IGludGVsX2NydGMgKmNydGMpDQo+ICB7DQo+IC0Jc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKG9sZF9jcnRjX3N0YXRlLQ0KPiA+
dWFwaS5jcnRjKTsNCj4gLQlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Yy0+YmFzZS5kZXY7
DQo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOw0K
PiAtCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IG9sZF9jcnRjX3N0YXRlLT51YXBp
LnN0YXRlOw0KPiAtCXN0cnVjdCBkcm1fcGxhbmUgKnByaW1hcnkgPSBjcnRjLT5iYXNlLnByaW1h
cnk7DQo+IC0Jc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqb2xkX3ByaW1hcnlfc3RhdGUgPQ0KPiAt
CQlkcm1fYXRvbWljX2dldF9vbGRfcGxhbmVfc3RhdGUoc3RhdGUsIHByaW1hcnkpOw0KPiArCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2
KTsNCj4gKwlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnByaW1hcnkgPSB0b19pbnRlbF9wbGFuZShjcnRj
LQ0KPiA+YmFzZS5wcmltYXJ5KTsNCj4gKwljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
b2xkX2NydGNfc3RhdGUgPQ0KPiArCQlpbnRlbF9hdG9taWNfZ2V0X29sZF9jcnRjX3N0YXRlKHN0
YXRlLCBjcnRjKTsNCj4gKwljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqbmV3X2NydGNf
c3RhdGUgPQ0KPiArCQlpbnRlbF9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRlKHN0YXRlLCBjcnRj
KTsNCj4gKwljb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKm9sZF9wcmltYXJ5X3N0YXRl
ID0NCj4gKwkJaW50ZWxfYXRvbWljX2dldF9vbGRfcGxhbmVfc3RhdGUoc3RhdGUsIHByaW1hcnkp
Ow0KPiArCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqbmV3X3ByaW1hcnlfc3RhdGUg
PQ0KPiArCQlpbnRlbF9hdG9taWNfZ2V0X25ld19wbGFuZV9zdGF0ZShzdGF0ZSwgcHJpbWFyeSk7
DQo+ICAJYm9vbCBtb2Rlc2V0ID0gbmVlZHNfbW9kZXNldChuZXdfY3J0Y19zdGF0ZSk7DQo+IC0J
c3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqaW50ZWxfc3RhdGUgPQ0KPiAtCQl0b19pbnRlbF9h
dG9taWNfc3RhdGUoc3RhdGUpOw0KPiAgDQo+ICAJaWYgKGhzd19wcmVfdXBkYXRlX2Rpc2FibGVf
aXBzKG9sZF9jcnRjX3N0YXRlLCBuZXdfY3J0Y19zdGF0ZSkpDQo+ICAJCWhzd19kaXNhYmxlX2lw
cyhvbGRfY3J0Y19zdGF0ZSk7DQo+ICANCj4gLQlpZiAob2xkX3ByaW1hcnlfc3RhdGUpIHsNCj4g
LQkJc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpuZXdfcHJpbWFyeV9zdGF0ZSA9DQo+IC0JCQlp
bnRlbF9hdG9taWNfZ2V0X25ld19wbGFuZV9zdGF0ZShpbnRlbF9zdGF0ZSwNCj4gLQkJCQkJCQkg
dG9faW50ZWxfcGxhbmUNCj4gKHByaW1hcnkpKTsNCj4gLQ0KPiArCWlmIChuZXdfcHJpbWFyeV9z
dGF0ZSkgew0KPiAgCQlpbnRlbF9mYmNfcHJlX3VwZGF0ZShjcnRjLCBuZXdfY3J0Y19zdGF0ZSwN
Cj4gbmV3X3ByaW1hcnlfc3RhdGUpOw0KPiAgCQkvKg0KPiAgCQkgKiBHZW4yIHJlcG9ydHMgcGlw
ZSB1bmRlcnJ1bnMgd2hlbmV2ZXIgYWxsIHBsYW5lcyBhcmUNCj4gZGlzYWJsZWQuDQo+ICAJCSAq
IFNvIGRpc2FibGUgdW5kZXJydW4gcmVwb3J0aW5nIGJlZm9yZSBhbGwgdGhlIHBsYW5lcw0KPiBn
ZXQgZGlzYWJsZWQuDQo+ICAJCSAqLw0KPiAtCQlpZiAoSVNfR0VOKGRldl9wcml2LCAyKSAmJiBv
bGRfcHJpbWFyeV9zdGF0ZS0+dmlzaWJsZQ0KPiAmJg0KPiArCQlpZiAoSVNfR0VOKGRldl9wcml2
LCAyKSAmJiBvbGRfcHJpbWFyeV9zdGF0ZS0NCj4gPnVhcGkudmlzaWJsZSAmJg0KPiAgCQkgICAg
KG1vZGVzZXQgfHwgIW5ld19wcmltYXJ5X3N0YXRlLT51YXBpLnZpc2libGUpKQ0KPiAgCQkJaW50
ZWxfc2V0X2NwdV9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhkZXZfcHJpdiwNCj4gY3J0Yy0+cGlw
ZSwgZmFsc2UpOw0KPiAgCX0NCj4gQEAgLTYxOTIsNyArNjE4NCw3IEBAIHN0YXRpYyB2b2lkIGlu
dGVsX3ByZV9wbGFuZV91cGRhdGUoc3RydWN0DQo+IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRj
X3N0YXRlLA0KPiAgCSAqIHVzIHRvLg0KPiAgCSAqLw0KPiAgCWlmIChkZXZfcHJpdi0+ZGlzcGxh
eS5pbml0aWFsX3dhdGVybWFya3MpDQo+IC0JCWRldl9wcml2LT5kaXNwbGF5LmluaXRpYWxfd2F0
ZXJtYXJrcyhpbnRlbF9zdGF0ZSwNCj4gY3J0Yyk7DQo+ICsJCWRldl9wcml2LT5kaXNwbGF5Lmlu
aXRpYWxfd2F0ZXJtYXJrcyhzdGF0ZSwgY3J0Yyk7DQo+ICAJZWxzZSBpZiAobmV3X2NydGNfc3Rh
dGUtPnVwZGF0ZV93bV9wcmUpDQo+ICAJCWludGVsX3VwZGF0ZV93YXRlcm1hcmtzKGNydGMpOw0K
PiAgfQ0KPiBAQCAtMTQzNjUsNyArMTQzNTcsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF91cGRhdGVf
Y3J0YyhzdHJ1Y3QNCj4gaW50ZWxfY3J0YyAqY3J0YywNCj4gIAkJICAgICBuZXdfY3J0Y19zdGF0
ZS0+dXBkYXRlX3BpcGUpKQ0KPiAgCQkJaW50ZWxfY29sb3JfbG9hZF9sdXRzKG5ld19jcnRjX3N0
YXRlKTsNCj4gIA0KPiAtCQlpbnRlbF9wcmVfcGxhbmVfdXBkYXRlKG9sZF9jcnRjX3N0YXRlLCBu
ZXdfY3J0Y19zdGF0ZSk7DQo+ICsJCWludGVsX3ByZV9wbGFuZV91cGRhdGUoc3RhdGUsIGNydGMp
Ow0KPiAgDQo+ICAJCWlmIChuZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3BpcGUpDQo+ICAJCQlpbnRl
bF9lbmNvZGVyc191cGRhdGVfcGlwZShzdGF0ZSwgY3J0Yyk7DQo+IEBAIC0xNDQ2MCw3ICsxNDQ1
Miw3IEBAIHN0YXRpYyB2b2lkDQo+IGludGVsX3RyYW5zX3BvcnRfc3luY19tb2Rlc2V0X2Rpc2Fi
bGVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0DQo+ICAJCSFvbGRfc2xhdmVfY3J0Y19z
dGF0ZSk7DQo+ICANCj4gIAkvKiBEaXNhYmxlIFNsYXZlIGZpcnN0ICovDQo+IC0JaW50ZWxfcHJl
X3BsYW5lX3VwZGF0ZShvbGRfc2xhdmVfY3J0Y19zdGF0ZSwNCj4gbmV3X3NsYXZlX2NydGNfc3Rh
dGUpOw0KPiArCWludGVsX3ByZV9wbGFuZV91cGRhdGUoc3RhdGUsIHNsYXZlX2NydGMpOw0KPiAg
CWlmIChvbGRfc2xhdmVfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlKQ0KPiAgCQlpbnRlbF9vbGRfY3J0
Y19zdGF0ZV9kaXNhYmxlcyhzdGF0ZSwNCj4gIAkJCQkJICAgICAgb2xkX3NsYXZlX2NydGNfc3Rh
dGUsDQo+IEBAIC0xNDQ2OCw3ICsxNDQ2MCw3IEBAIHN0YXRpYyB2b2lkDQo+IGludGVsX3RyYW5z
X3BvcnRfc3luY19tb2Rlc2V0X2Rpc2FibGVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0
DQo+ICAJCQkJCSAgICAgIHNsYXZlX2NydGMpOw0KPiAgDQo+ICAJLyogRGlzYWJsZSBNYXN0ZXIg
Ki8NCj4gLQlpbnRlbF9wcmVfcGxhbmVfdXBkYXRlKG9sZF9jcnRjX3N0YXRlLCBuZXdfY3J0Y19z
dGF0ZSk7DQo+ICsJaW50ZWxfcHJlX3BsYW5lX3VwZGF0ZShzdGF0ZSwgY3J0Yyk7DQo+ICAJaWYg
KG9sZF9jcnRjX3N0YXRlLT5ody5hY3RpdmUpDQo+ICAJCWludGVsX29sZF9jcnRjX3N0YXRlX2Rp
c2FibGVzKHN0YXRlLA0KPiAgCQkJCQkgICAgICBvbGRfY3J0Y19zdGF0ZSwNCj4gQEAgLTE0NTA4
LDcgKzE0NTAwLDcgQEAgc3RhdGljIHZvaWQNCj4gaW50ZWxfY29tbWl0X21vZGVzZXRfZGlzYWJs
ZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpDQo+ICAJCQllbHNlDQo+ICAJCQkJ
Y29udGludWU7DQo+ICAJCX0gZWxzZSB7DQo+IC0JCQlpbnRlbF9wcmVfcGxhbmVfdXBkYXRlKG9s
ZF9jcnRjX3N0YXRlLA0KPiBuZXdfY3J0Y19zdGF0ZSk7DQo+ICsJCQlpbnRlbF9wcmVfcGxhbmVf
dXBkYXRlKHN0YXRlLCBjcnRjKTsNCj4gIA0KPiAgCQkJaWYgKG9sZF9jcnRjX3N0YXRlLT5ody5h
Y3RpdmUpDQo+ICAJCQkJaW50ZWxfb2xkX2NydGNfc3RhdGVfZGlzYWJsZXMoc3RhdGUsDQo+IEBA
IC0xNDg5Niw3ICsxNDg4OCw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21taXRfdGFp
bChzdHJ1Y3QNCj4gaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkNCj4gIAl9DQo+ICANCj4gIAlm
b3JfZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0YywNCj4gb2xkX2Ny
dGNfc3RhdGUsIG5ld19jcnRjX3N0YXRlLCBpKSB7DQo+IC0JCWludGVsX3Bvc3RfcGxhbmVfdXBk
YXRlKG9sZF9jcnRjX3N0YXRlKTsNCj4gKwkJaW50ZWxfcG9zdF9wbGFuZV91cGRhdGUoc3RhdGUs
IGNydGMpOw0KPiAgDQo+ICAJCWlmIChwdXRfZG9tYWluc1tpXSkNCj4gIAkJCW1vZGVzZXRfcHV0
X3Bvd2VyX2RvbWFpbnMoZGV2X3ByaXYsDQo+IHB1dF9kb21haW5zW2ldKTsNCj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZmJjLmMNCj4gYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZiYy5jDQo+IGluZGV4IDkyYzdlYjI0MzU1OS4u
NzBjNTZhYmUxYTgzIDEwMDY0NA0KPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2ZiYy5jDQo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZmJjLmMNCj4gQEAgLTQyMCw3ICs0MjAsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9mYmNfZGVhY3Rp
dmF0ZShzdHJ1Y3QNCj4gZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsDQo+ICB9DQo+ICANCj4g
IHN0YXRpYyBib29sIG11bHRpcGxlX3BpcGVzX29rKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLA0K
PiAtCQkJICAgICAgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkNCj4gKwkJ
CSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZQ0KPiAqcGxhbmVfc3RhdGUpDQo+
ICB7DQo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7DQo+ICAJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7
DQo+IEBAIC02NTYsOCArNjU2LDggQEAgc3RhdGljIGJvb2wNCj4gaW50ZWxfZmJjX2h3X3RyYWNr
aW5nX2NvdmVyc19zY3JlZW4oc3RydWN0IGludGVsX2NydGMgKmNydGMpDQo+ICB9DQo+ICANCj4g
IHN0YXRpYyB2b2lkIGludGVsX2ZiY191cGRhdGVfc3RhdGVfY2FjaGUoc3RydWN0IGludGVsX2Ny
dGMgKmNydGMsDQo+IC0JCQkJCSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiAqY3J0Y19zdGF0
ZSwNCj4gLQkJCQkJIHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZQ0KPiAqcGxhbmVfc3RhdGUpDQo+
ICsJCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZQ0KPiAqY3J0Y19zdGF0ZSwNCj4g
KwkJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZQ0KPiAqcGxhbmVfc3RhdGUpDQo+
ICB7DQo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRj
LT5iYXNlLmRldik7DQo+ICAJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7
DQo+IEBAIC04NTUsOCArODU1LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZmJjX2dldF9yZWdfcGFy
YW1zKHN0cnVjdA0KPiBpbnRlbF9jcnRjICpjcnRjLA0KPiAgfQ0KPiAgDQo+ICB2b2lkIGludGVs
X2ZiY19wcmVfdXBkYXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLA0KPiAtCQkJICBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwNCj4gLQkJCSAgc3RydWN0IGludGVsX3BsYW5l
X3N0YXRlICpwbGFuZV9zdGF0ZSkNCj4gKwkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUsDQo+ICsJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAq
cGxhbmVfc3RhdGUpDQoNCk5pY2UNCg0KT3RoZXIgdGhhbiB0aGUgZmlyc3QgY29tbWVudCwgTEdU
TS4NCg0KPiAgew0KPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOw0KPiAgCXN0cnVjdCBpbnRlbF9mYmMgKmZiYyA9ICZkZXZfcHJp
di0+ZmJjOw0KPiBAQCAtMTA4MSw4ICsxMDgxLDggQEAgdm9pZCBpbnRlbF9mYmNfY2hvb3NlX2Ny
dGMoc3RydWN0DQo+IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LA0KPiAgICogaW50ZWxfZmJj
X2Rpc2FibGUgaW4gdGhlIG1pZGRsZSwgYXMgbG9uZyBhcyBpdCBpcyBkZWFjdGl2YXRlZC4NCj4g
ICAqLw0KPiAgdm9pZCBpbnRlbF9mYmNfZW5hYmxlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLA0K
PiAtCQkgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwNCj4gLQkJICAg
ICAgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkNCj4gKwkJICAgICAgY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsDQo+ICsJCSAgICAgIGNvbnN0
IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpDQo+ICB7DQo+ICAJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5iYXNlLmRldik7DQo+
ICAJc3RydWN0IGludGVsX2ZiYyAqZmJjID0gJmRldl9wcml2LT5mYmM7DQo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZiYy5oDQo+IGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmMuaA0KPiBpbmRleCA1MDI3MmVkYThkNDMuLmY1
OGIwYjFlM2M1YyAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9mYmMuaA0KPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Zi
Yy5oDQo+IEBAIC0yMCwxNCArMjAsMTQgQEAgdm9pZCBpbnRlbF9mYmNfY2hvb3NlX2NydGMoc3Ry
dWN0DQo+IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LA0KPiAgCQkJICAgc3RydWN0IGludGVs
X2F0b21pY19zdGF0ZSAqc3RhdGUpOw0KPiAgYm9vbCBpbnRlbF9mYmNfaXNfYWN0aXZlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7DQo+ICB2b2lkIGludGVsX2ZiY19wcmVfdXBk
YXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLA0KPiAtCQkJICBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwNCj4gLQkJCSAgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFu
ZV9zdGF0ZSk7DQo+ICsJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlLA0KPiArCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRl
KTsNCj4gIHZvaWQgaW50ZWxfZmJjX3Bvc3RfdXBkYXRlKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
KTsNCj4gIHZvaWQgaW50ZWxfZmJjX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsNCj4gIHZvaWQgaW50ZWxfZmJjX2luaXRfcGlwZV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpOw0KPiAgdm9pZCBpbnRlbF9mYmNfZW5hYmxlKHN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjLA0KPiAtCQkgICAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZSwNCj4gLQkJICAgICAgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSk7
DQo+ICsJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLA0K
PiArCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKTsN
Cj4gIHZvaWQgaW50ZWxfZmJjX2Rpc2FibGUoc3RydWN0IGludGVsX2NydGMgKmNydGMpOw0KPiAg
dm9pZCBpbnRlbF9mYmNfZ2xvYmFsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsNCj4gIHZvaWQgaW50ZWxfZmJjX2ludmFsaWRhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LA0KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50
ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9308FDB01D
	for <lists+intel-gfx@lfdr.de>; Thu, 17 Oct 2019 16:30:44 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E8DAC6EAAE;
	Thu, 17 Oct 2019 14:30:42 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7A74C6EAAD;
 Thu, 17 Oct 2019 14:30:40 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18870887-1500050 
 for multiple; Thu, 17 Oct 2019 15:30:21 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 17 Oct 2019 15:30:18 +0100
Message-Id: <20191017143018.6957-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t] i915: Exercise preemption timeout
 controls in sysfs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RHluYW1pYyBzdWJ0ZXN0cyEKClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hy
aXMtd2lsc29uLmNvLnVrPgotLS0KIGxpYi9pOTE1L2dlbV9jb250ZXh0LmMgICAgICAgICAgICAg
ICAgfCAgNDAgKysrKysKIGxpYi9pOTE1L2dlbV9jb250ZXh0LmggICAgICAgICAgICAgICAgfCAg
IDIgKwogdGVzdHMvTWFrZWZpbGUuc291cmNlcyAgICAgICAgICAgICAgICB8ICAgMSArCiB0ZXN0
cy9pOTE1L3N5c2ZzX3ByZWVtcHRpb25fdGltZW91dC5jIHwgMjAzICsrKysrKysrKysrKysrKysr
KysrKysrKysrCiB0ZXN0cy9tZXNvbi5idWlsZCAgICAgICAgICAgICAgICAgICAgIHwgICAxICsK
IDUgZmlsZXMgY2hhbmdlZCwgMjQ3IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0
ZXN0cy9pOTE1L3N5c2ZzX3ByZWVtcHRpb25fdGltZW91dC5jCgpkaWZmIC0tZ2l0IGEvbGliL2k5
MTUvZ2VtX2NvbnRleHQuYyBiL2xpYi9pOTE1L2dlbV9jb250ZXh0LmMKaW5kZXggMWZhZTUxOTFm
Li5hNjI3YTVjN2IgMTAwNjQ0Ci0tLSBhL2xpYi9pOTE1L2dlbV9jb250ZXh0LmMKKysrIGIvbGli
L2k5MTUvZ2VtX2NvbnRleHQuYwpAQCAtNDAzLDMgKzQwMyw0MyBAQCBib29sIGdlbV9jb250ZXh0
X2hhc19lbmdpbmUoaW50IGZkLCB1aW50MzJfdCBjdHgsIHVpbnQ2NF90IGVuZ2luZSkKIAogCXJl
dHVybiBfX2dlbV9leGVjYnVmKGZkLCAmZXhlY2J1ZikgPT0gLUVOT0VOVDsKIH0KKworc3RhdGlj
IGludCBjcmVhdGVfZXh0X2lvY3RsKGludCBpOTE1LAorCQkJICAgIHN0cnVjdCBkcm1faTkxNV9n
ZW1fY29udGV4dF9jcmVhdGVfZXh0ICphcmcpCit7CisJaW50IGVycjsKKworCWVyciA9IDA7CisJ
aWYgKGlndF9pb2N0bChpOTE1LCBEUk1fSU9DVExfSTkxNV9HRU1fQ09OVEVYVF9DUkVBVEVfRVhU
LCBhcmcpKSB7CisJCWVyciA9IC1lcnJubzsKKwkJaWd0X2Fzc3VtZShlcnIpOworCX0KKworCWVy
cm5vID0gMDsKKwlyZXR1cm4gZXJyOworfQorCit1aW50MzJfdCBnZW1fY29udGV4dF9jcmVhdGVf
Zm9yX2VuZ2luZShpbnQgaTkxNSwgdW5zaWduZWQgaW50IGNsYXNzLCB1bnNpZ25lZCBpbnQgaW5z
dCkKK3sKKwlJOTE1X0RFRklORV9DT05URVhUX1BBUkFNX0VOR0lORVMoZW5naW5lcywgMSkgPSB7
CisJCS5lbmdpbmVzID0geyB7IC5lbmdpbmVfY2xhc3MgPSBjbGFzcywgLmVuZ2luZV9pbnN0YW5j
ZSA9IGluc3QgfSB9CisJfTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2V4
dF9zZXRwYXJhbSBwX2VuZ2luZXMgPSB7CisJCS5iYXNlID0geworCQkJLm5hbWUgPSBJOTE1X0NP
TlRFWFRfQ1JFQVRFX0VYVF9TRVRQQVJBTSwKKwkJCS5uZXh0X2V4dGVuc2lvbiA9IDAsIC8qIGVu
ZCBvZiBjaGFpbiAqLworCQl9LAorCQkucGFyYW0gPSB7CisJCQkucGFyYW0gPSBJOTE1X0NPTlRF
WFRfUEFSQU1fRU5HSU5FUywKKwkJCS52YWx1ZSA9IHRvX3VzZXJfcG9pbnRlcigmZW5naW5lcyks
CisJCQkuc2l6ZSA9IHNpemVvZihlbmdpbmVzKSwKKwkJfSwKKwl9OworCXN0cnVjdCBkcm1faTkx
NV9nZW1fY29udGV4dF9jcmVhdGVfZXh0IGNyZWF0ZSA9IHsKKwkJLmZsYWdzID0gSTkxNV9DT05U
RVhUX0NSRUFURV9GTEFHU19VU0VfRVhURU5TSU9OUywKKwkJLmV4dGVuc2lvbnMgPSB0b191c2Vy
X3BvaW50ZXIoJnBfZW5naW5lcyksCisJfTsKKworCWlndF9hc3NlcnRfZXEoY3JlYXRlX2V4dF9p
b2N0bChpOTE1LCAmY3JlYXRlKSwgMCk7CisJcmV0dXJuIGNyZWF0ZS5jdHhfaWQ7Cit9CmRpZmYg
LS1naXQgYS9saWIvaTkxNS9nZW1fY29udGV4dC5oIGIvbGliL2k5MTUvZ2VtX2NvbnRleHQuaApp
bmRleCBjMGQ0Yzk2MTUuLjllMGEwODNmMCAxMDA2NDQKLS0tIGEvbGliL2k5MTUvZ2VtX2NvbnRl
eHQuaAorKysgYi9saWIvaTkxNS9nZW1fY29udGV4dC5oCkBAIC0zNCw2ICszNCw4IEBAIGludCBf
X2dlbV9jb250ZXh0X2NyZWF0ZShpbnQgZmQsIHVpbnQzMl90ICpjdHhfaWQpOwogdm9pZCBnZW1f
Y29udGV4dF9kZXN0cm95KGludCBmZCwgdWludDMyX3QgY3R4X2lkKTsKIGludCBfX2dlbV9jb250
ZXh0X2Rlc3Ryb3koaW50IGZkLCB1aW50MzJfdCBjdHhfaWQpOwogCit1aW50MzJfdCBnZW1fY29u
dGV4dF9jcmVhdGVfZm9yX2VuZ2luZShpbnQgZmQsIHVuc2lnbmVkIGludCBjbGFzcywgdW5zaWdu
ZWQgaW50IGluc3QpOworCiBpbnQgX19nZW1fY29udGV4dF9jbG9uZShpbnQgaTkxNSwKIAkJCXVp
bnQzMl90IHNyYywgdW5zaWduZWQgaW50IHNoYXJlLAogCQkJdW5zaWduZWQgaW50IGZsYWdzLApk
aWZmIC0tZ2l0IGEvdGVzdHMvTWFrZWZpbGUuc291cmNlcyBiL3Rlc3RzL01ha2VmaWxlLnNvdXJj
ZXMKaW5kZXggMDkzZWI1N2YzLi5kZmY3ZGFjMDYgMTAwNjQ0Ci0tLSBhL3Rlc3RzL01ha2VmaWxl
LnNvdXJjZXMKKysrIGIvdGVzdHMvTWFrZWZpbGUuc291cmNlcwpAQCAtOTgsNiArOTgsNyBAQCBU
RVNUU19wcm9ncyA9IFwKIAl0b29sc190ZXN0IFwKIAl2Z2VtX2Jhc2ljIFwKIAl2Z2VtX3Nsb3cg
XAorCWk5MTUvc3lzZnNfcHJlZW1wdGlvbl90aW1lb3V0IFwKIAkkKE5VTEwpCiAKIFRFU1RTX3By
b2dzICs9IGdlbV9iYWRfcmVsb2MKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvc3lzZnNfcHJlZW1w
dGlvbl90aW1lb3V0LmMgYi90ZXN0cy9pOTE1L3N5c2ZzX3ByZWVtcHRpb25fdGltZW91dC5jCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMC4uYTc5ODM0NWIxCi0tLSAvZGV2L251
bGwKKysrIGIvdGVzdHMvaTkxNS9zeXNmc19wcmVlbXB0aW9uX3RpbWVvdXQuYwpAQCAtMCwwICsx
LDIwMyBAQAorLyoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKgor
ICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBw
ZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRl
ZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksCisgKiB0byBkZWFsIGluIHRo
ZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0
aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwg
ZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29m
dHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQorICogU29mdHdhcmUgaXMg
ZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoK
KyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5v
dGljZSAoaW5jbHVkaW5nIHRoZSBuZXh0CisgKiBwYXJhZ3JhcGgpIHNoYWxsIGJlIGluY2x1ZGVk
IGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlCisgKiBTb2Z0d2Fy
ZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJS
QU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBO
T1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRO
RVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8g
RVZFTlQgU0hBTEwKKyAqIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJM
RSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCisgKiBMSUFCSUxJVFksIFdIRVRIRVIg
SU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORworICog
RlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVT
RSBPUiBPVEhFUiBERUFMSU5HUworICogSU4gVEhFIFNPRlRXQVJFLgorICovCisKKyNpbmNsdWRl
IDxkaXJlbnQuaD4KKyNpbmNsdWRlIDxlcnJuby5oPgorI2luY2x1ZGUgPGZjbnRsLmg+CisjaW5j
bHVkZSA8aW50dHlwZXMuaD4KKyNpbmNsdWRlIDxzeXMvc3RhdC5oPgorI2luY2x1ZGUgPHN5cy90
eXBlcy5oPgorI2luY2x1ZGUgPHVuaXN0ZC5oPgorCisjaW5jbHVkZSAiZHJtdGVzdC5oIiAvKiBn
ZW1fcXVpZXNjZW50X2dwdSgpISAqLworI2luY2x1ZGUgImlndF9kdW1teWxvYWQuaCIKKyNpbmNs
dWRlICJpZ3Rfc3lzZnMuaCIKKyNpbmNsdWRlICJpb2N0bF93cmFwcGVycy5oIiAvKiBpZ3RfcmVx
dWlyZV9nZW0oKSEgKi8KKyNpbmNsdWRlICJzd19zeW5jLmgiCisKKyNpbmNsdWRlICJpZ3RfZGVi
dWdmcy5oIgorCitzdGF0aWMgYm9vbCBfX2VuYWJsZV9oYW5nY2hlY2soaW50IGRpciwgYm9vbCBz
dGF0ZSkKK3sKKwlyZXR1cm4gaWd0X3N5c2ZzX3NldChkaXIsICJlbmFibGVfaGFuZ2NoZWNrIiwg
c3RhdGUgPyAiMSIgOiAiMCIpOworfQorCitzdGF0aWMgYm9vbCBlbmFibGVfaGFuZ2NoZWNrKGlu
dCBpOTE1LCBib29sIHN0YXRlKQoreworCWJvb2wgc3VjY2VzczsKKwlpbnQgZGlyOworCisJZGly
ID0gaWd0X3N5c2ZzX29wZW5fcGFyYW1ldGVycyhpOTE1KTsKKwlpZiAoZGlyIDwgMCkgLyogbm8g
cGFyYW1ldGVycywgbXVzdCBiZSBkZWZhdWx0ISAqLworCQlyZXR1cm4gZmFsc2U7CisKKwlzdWNj
ZXNzID0gX19lbmFibGVfaGFuZ2NoZWNrKGRpciwgc3RhdGUpOworCWNsb3NlKGRpcik7CisKKwly
ZXR1cm4gc3VjY2VzczsKK30KKworc3RhdGljIHZvaWQgdGVzdF9pZGVtcG90ZW50KGludCBpOTE1
LCBpbnQgZW5naW5lKQoreworCXVuc2lnbmVkIGludCBzYXZlZCwgZGVsYXk7CisKKwlpZ3RfYXNz
ZXJ0KGlndF9zeXNmc19zY2FuZihlbmdpbmUsICJwcmVlbXB0X3RpbWVvdXRfbXMiLCAiJXUiLCAm
c2F2ZWQpID09IDEpOworCWlndF9kZWJ1ZygiSW5pdGlhbCBwcmVlbXB0X3RpbWVvdXRfbXM6JXVc
biIsIHNhdmVkKTsKKworCWlndF9zeXNmc19wcmludGYoZW5naW5lLCAicHJlZW1wdF90aW1lb3V0
X21zIiwgIiV1IiwgMSk7CisJaWd0X3N5c2ZzX3NjYW5mKGVuZ2luZSwgInByZWVtcHRfdGltZW91
dF9tcyIsICIldSIsICZkZWxheSk7CisJaWd0X2Fzc2VydF9lcShkZWxheSwgMSk7CisKKwlpZ3Rf
c3lzZnNfcHJpbnRmKGVuZ2luZSwgInByZWVtcHRfdGltZW91dF9tcyIsICIldSIsIHNhdmVkKTsK
KwlpZ3Rfc3lzZnNfc2NhbmYoZW5naW5lLCAicHJlZW1wdF90aW1lb3V0X21zIiwgIiV1IiwgJmRl
bGF5KTsKKwlpZ3RfYXNzZXJ0X2VxKGRlbGF5LCBzYXZlZCk7Cit9CisKK3N0YXRpYyB2b2lkIHRl
c3RfaW52YWxpZChpbnQgaTkxNSwgaW50IGVuZ2luZSkKK3sKKwl1bnNpZ25lZCBpbnQgc2F2ZWQs
IGRlbGF5OworCisJaWd0X2Fzc2VydChpZ3Rfc3lzZnNfc2NhbmYoZW5naW5lLCAicHJlZW1wdF90
aW1lb3V0X21zIiwgIiV1IiwgJnNhdmVkKSA9PSAxKTsKKwlpZ3RfZGVidWcoIkluaXRpYWwgcHJl
ZW1wdF90aW1lb3V0X21zOiV1XG4iLCBzYXZlZCk7CisKKwlpZ3Rfc3lzZnNfcHJpbnRmKGVuZ2lu
ZSwgInByZWVtcHRfdGltZW91dF9tcyIsIFBSSXU2NCwgLTEpOworCWlndF9zeXNmc19zY2FuZihl
bmdpbmUsICJwcmVlbXB0X3RpbWVvdXRfbXMiLCAiJXUiLCAmZGVsYXkpOworCWlndF9hc3NlcnRf
ZXEoZGVsYXksIHNhdmVkKTsKK30KKworc3RhdGljIHVpbnQ2NF90IF9fdGVzdF90aW1lb3V0KGlu
dCBpOTE1LCBpbnQgZW5naW5lLCB1bnNpZ25lZCBpbnQgdGltZW91dCkKK3sKKwl1bnNpZ25lZCBp
bnQgY2xhc3MsIGluc3Q7CisJc3RydWN0IHRpbWVzcGVjIHRzID0ge307CisJaWd0X3NwaW5fdCAq
c3BpblsyXTsKKwl1aW50NjRfdCBlbGFwc2VkOworCXVpbnQzMl90IGN0eDsKKworCWlndF9hc3Nl
cnQoaWd0X3N5c2ZzX3NjYW5mKGVuZ2luZSwgImNsYXNzIiwgIiV1IiwgJmNsYXNzKSA9PSAxKTsK
KwlpZ3RfYXNzZXJ0KGlndF9zeXNmc19zY2FuZihlbmdpbmUsICJpbnN0YW5jZSIsICIldSIsICZp
bnN0KSA9PSAxKTsKKworCWlndF9zeXNmc19wcmludGYoZW5naW5lLCAicHJlZW1wdF90aW1lb3V0
X21zIiwgIiV1IiwgdGltZW91dCk7CisKKwljdHggPSBnZW1fY29udGV4dF9jcmVhdGVfZm9yX2Vu
Z2luZShpOTE1LCBjbGFzcywgaW5zdCk7CisJZ2VtX2NvbnRleHRfc2V0X3ByaW9yaXR5KGk5MTUs
IGN0eCwgLTEwMjMpOworCXNwaW5bMF0gPSBpZ3Rfc3Bpbl9uZXcoaTkxNSwgY3R4LAorCQkJICAg
ICAgIC5mbGFncyA9IChJR1RfU1BJTl9OT19QUkVFTVBUSU9OIHwKKwkJCQkJIElHVF9TUElOX1BP
TExfUlVOIHwKKwkJCQkJIElHVF9TUElOX0ZFTkNFX09VVCkpOworCWlndF9zcGluX2J1c3l3YWl0
X3VudGlsX3N0YXJ0ZWQoc3BpblswXSk7CisJZ2VtX2NvbnRleHRfZGVzdHJveShpOTE1LCBjdHgp
OworCisJY3R4ID0gZ2VtX2NvbnRleHRfY3JlYXRlX2Zvcl9lbmdpbmUoaTkxNSwgY2xhc3MsIGlu
c3QpOworCWdlbV9jb250ZXh0X3NldF9wcmlvcml0eShpOTE1LCBjdHgsIDEwMjMpOworCWlndF9u
c2VjX2VsYXBzZWQoJnRzKTsKKwlzcGluWzFdID0gaWd0X3NwaW5fbmV3KGk5MTUsIGN0eCwgLmZs
YWdzID0gSUdUX1NQSU5fUE9MTF9SVU4pOworCWlndF9zcGluX2J1c3l3YWl0X3VudGlsX3N0YXJ0
ZWQoc3BpblsxXSk7CisJZWxhcHNlZCA9IGlndF9uc2VjX2VsYXBzZWQoJnRzKTsKKwlnZW1fY29u
dGV4dF9kZXN0cm95KGk5MTUsIGN0eCk7CisKKwlpZ3RfYXNzZXJ0X2VxKHN5bmNfZmVuY2Vfc3Rh
dHVzKHNwaW5bMF0tPm91dF9mZW5jZSksIC1FSU8pOworCisJaWd0X3NwaW5fZnJlZShpOTE1LCBz
cGluWzFdKTsKKwlpZ3Rfc3Bpbl9mcmVlKGk5MTUsIHNwaW5bMF0pOworCWdlbV9xdWllc2NlbnRf
Z3B1KGk5MTUpOworCisJcmV0dXJuIGVsYXBzZWQ7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3RfdGlt
ZW91dChpbnQgaTkxNSwgaW50IGVuZ2luZSkKK3sKKwlpbnQgZGVsYXlzW10gPSB7IDEsIDUwLCAx
MDAsIDUwMCB9OworCXVuc2lnbmVkIGludCBzYXZlZCwgZGVsYXk7CisKKwlpZ3RfYXNzZXJ0KGln
dF9zeXNmc19zY2FuZihlbmdpbmUsICJwcmVlbXB0X3RpbWVvdXRfbXMiLCAiJXUiLCAmc2F2ZWQp
ID09IDEpOworCWlndF9kZWJ1ZygiSW5pdGlhbCBwcmVlbXB0X3RpbWVvdXRfbXM6JXVcbiIsIHNh
dmVkKTsKKworCWdlbV9xdWllc2NlbnRfZ3B1KGk5MTUpOworCWlndF9yZXF1aXJlKGVuYWJsZV9o
YW5nY2hlY2soaTkxNSwgZmFsc2UpKTsKKworCWZvciAoaW50IGkgPSAwOyBpIDwgQVJSQVlfU0la
RShkZWxheXMpOyBpKyspIHsKKwkJdWludDY0X3QgZWxhcHNlZDsKKworCQllbGFwc2VkID0gX190
ZXN0X3RpbWVvdXQoaTkxNSwgZW5naW5lLCBkZWxheXNbaV0pOworCQlpZ3RfaW5mbygicHJlZW1w
dF90aW1lb3V0X21zOiVkLCBlbGFwc2VkPSUuM2Ztc1xuIiwKKwkJCSBkZWxheXNbaV0sIGVsYXBz
ZWQgKiAxZS02KTsKKwl9CisKKwlpZ3RfYXNzZXJ0KGVuYWJsZV9oYW5nY2hlY2soaTkxNSwgdHJ1
ZSkpOworCWdlbV9xdWllc2NlbnRfZ3B1KGk5MTUpOworCisJaWd0X3N5c2ZzX3ByaW50Zihlbmdp
bmUsICJwcmVlbXB0X3RpbWVvdXRfbXMiLCAiJXUiLCBzYXZlZCk7CisJaWd0X3N5c2ZzX3NjYW5m
KGVuZ2luZSwgInByZWVtcHRfdGltZW91dF9tcyIsICIldSIsICZkZWxheSk7CisJaWd0X2Fzc2Vy
dF9lcShkZWxheSwgc2F2ZWQpOworfQorCitpZ3RfbWFpbgoreworCWludCBpOTE1LCBzeXMgPSAt
MTsKKwlzdHJ1Y3QgZGlyZW50ICpkZTsKKwlpbnQgZW5naW5lczsKKwlESVIgKmRpcjsKKworCWln
dF9maXh0dXJlIHsKKwkJaTkxNSA9IGRybV9vcGVuX2RyaXZlcihEUklWRVJfSU5URUwpOworCQlp
Z3RfcmVxdWlyZV9nZW0oaTkxNSk7CisKKwkJc3lzID0gaWd0X3N5c2ZzX29wZW4oaTkxNSk7CisJ
CWlndF9yZXF1aXJlKHN5cyAhPSAtMSk7CisJfQorCisJZW5naW5lcyA9IG9wZW5hdChzeXMsICJl
bmdpbmUiLCBPX1JET05MWSk7CisJZGlyID0gZmRvcGVuZGlyKGVuZ2luZXMpOworCXdoaWxlIChk
aXIgJiYgKGRlID0gcmVhZGRpcihkaXIpKSkgeworCQlpbnQgZW5naW5lID0gb3BlbmF0KGVuZ2lu
ZXMsIGRlLT5kX25hbWUsIE9fUkRPTkxZKTsKKwkJc3RydWN0IHN0YXQgc3Q7CisJCWNoYXIgKm5h
bWU7CisKKwkJbmFtZSA9IGlndF9zeXNmc19nZXQoZW5naW5lLCAibmFtZSIpOworCQlpZiAoIW5h
bWUpCisJCQljb250aW51ZTsKKworCQlpZ3Rfc3VidGVzdF9ncm91cCB7CisJCQlpZ3RfZml4dHVy
ZSB7CisJCQkJaWd0X3JlcXVpcmUoZnN0YXRhdChlbmdpbmUsCisJCQkJCQkgICAgInByZWVtcHRf
dGltZW91dF9tcyIsCisJCQkJCQkgICAgJnN0LCAwKSA9PSAwKTsKKwkJCX0KKworCQkJaWd0X3N1
YnRlc3RfZigiJXMtaWRlbXBvdGVudCIsIG5hbWUpCisJCQkJdGVzdF9pZGVtcG90ZW50KGk5MTUs
IGVuZ2luZSk7CisJCQlpZ3Rfc3VidGVzdF9mKCIlcy1pbnZhbGlkIiwgbmFtZSkKKwkJCQl0ZXN0
X2ludmFsaWQoaTkxNSwgZW5naW5lKTsKKwkJCWlndF9zdWJ0ZXN0X2YoIiVzLXRpbWVvdXQiLCBu
YW1lKQorCQkJCXRlc3RfdGltZW91dChpOTE1LCBlbmdpbmUpOworCQl9CisKKwkJZnJlZShuYW1l
KTsKKwkJY2xvc2UoZW5naW5lKTsKKwl9CisKKwlpZ3RfZml4dHVyZSB7CisJCWNsb3NlKHN5cyk7
CisJCWNsb3NlKGk5MTUpOworCX0KK30KZGlmZiAtLWdpdCBhL3Rlc3RzL21lc29uLmJ1aWxkIGIv
dGVzdHMvbWVzb24uYnVpbGQKaW5kZXggM2YzZWVlMjc3Li5hNjk5Mzc3ZTMgMTAwNjQ0Ci0tLSBh
L3Rlc3RzL21lc29uLmJ1aWxkCisrKyBiL3Rlc3RzL21lc29uLmJ1aWxkCkBAIC0yMzgsNiArMjM4
LDcgQEAgaTkxNV9wcm9ncyA9IFsKIAknaTkxNV9xdWVyeScsCiAJJ2k5MTVfc2VsZnRlc3QnLAog
CSdpOTE1X3N1c3BlbmQnLAorCSdzeXNmc19wcmVlbXB0aW9uX3RpbWVvdXQnLAogXQogCiB0ZXN0
X2RlcHMgPSBbIGlndF9kZXBzIF0KLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vaW50ZWwtZ2Z4

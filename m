Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 2E277124CD8
	for <lists+intel-gfx@lfdr.de>; Wed, 18 Dec 2019 17:11:53 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CD2576E8CB;
	Wed, 18 Dec 2019 16:11:49 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EC6F26E8BF
 for <intel-gfx@lists.freedesktop.org>; Wed, 18 Dec 2019 16:11:45 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 18 Dec 2019 08:11:45 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,330,1571727600"; d="scan'208";a="218189688"
Received: from ideak-desk.fi.intel.com ([10.237.72.183])
 by orsmga003.jf.intel.com with ESMTP; 18 Dec 2019 08:11:44 -0800
From: Imre Deak <imre.deak@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 18 Dec 2019 18:11:00 +0200
Message-Id: <20191218161105.30638-11-imre.deak@intel.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20191218161105.30638-1-imre.deak@intel.com>
References: <20191218161105.30638-1-imre.deak@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 10/15] drm/i915: Make sure CCS YUV semiplanar
 format checks work
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Dhinakaran Pandiyan <dhinakaran.pandiyan@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Rm9yIENDUyBmb3JtYXRzLCB0aGUgY3VycmVudCBEUk0gY29yZSBjaGVjayBmb3IgWVVWIHNlbWlw
bGFuYXIgZm9ybWF0cwpkb2Vzbid0IHdvcms7IHVzZSBhbiBpOTE1IHNwZWNpZmljIGZ1bmN0aW9u
IGZvciB0aGF0LgoKQ2M6IERoaW5ha2FyYW4gUGFuZGl5YW4gPGRoaW5ha2FyYW4ucGFuZGl5YW5A
aW50ZWwuY29tPgpDYzogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVs
LmNvbT4KU2lnbmVkLW9mZi1ieTogSW1yZSBEZWFrIDxpbXJlLmRlYWtAaW50ZWwuY29tPgotLS0K
IC4uLi9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWNfcGxhbmUuYyB8ICAyICstCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyAgfCAyNSArKysrKysr
KysrKysrKy0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXku
aCAgfCAgNCArKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMg
ICB8ICA4ICsrKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYyAgICAgICAgICAg
ICAgIHwgIDcgKysrLS0tCiA1IGZpbGVzIGNoYW5nZWQsIDMyIGluc2VydGlvbnMoKyksIDE0IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfYXRvbWljX3BsYW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0
b21pY19wbGFuZS5jCmluZGV4IDk0MjliOGUxNzI3MC4uM2U5N2FmNjgyYjFiIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pY19wbGFuZS5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljX3BsYW5lLmMKQEAgLTI1
MCw3ICsyNTAsNyBAQCBpbnQgaW50ZWxfcGxhbmVfYXRvbWljX2NoZWNrX3dpdGhfc3RhdGUoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjXwogCQluZXdfY3J0Y19zdGF0ZS0+
YWN0aXZlX3BsYW5lcyB8PSBCSVQocGxhbmUtPmlkKTsKIAogCWlmIChuZXdfcGxhbmVfc3RhdGUt
PnVhcGkudmlzaWJsZSAmJgotCSAgICBkcm1fZm9ybWF0X2luZm9faXNfeXV2X3NlbWlwbGFuYXIo
ZmItPmZvcm1hdCkpCisJICAgIGludGVsX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZi
LT5mb3JtYXQsIGZiLT5tb2RpZmllcikpCiAJCW5ld19jcnRjX3N0YXRlLT5udjEyX3BsYW5lcyB8
PSBCSVQocGxhbmUtPmlkKTsKIAogCWlmIChuZXdfcGxhbmVfc3RhdGUtPnVhcGkudmlzaWJsZSAm
JgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwppbmRleCBl
MzUwZjFkNDBiODguLjhiMzZjMzNiYjYzZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTE5ODUsNiArMTk4NSwxNCBAQCBpbnRlbF9tYWluX3Rv
X2F1eF9wbGFuZShjb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwgaW50IG1haW5fcGxh
bmUpCiAJcmV0dXJuIDE7CiB9CiAKK2Jvb2wKK2ludGVsX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1p
cGxhbmFyKGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8gKmluZm8sCisJCQkJICAgIHVpbnQ2
NF90IG1vZGlmaWVyKQoreworCXJldHVybiBpbmZvLT5pc195dXYgJiYKKwkgICAgICAgaW5mby0+
bnVtX3BsYW5lcyA9PSAoaXNfY2NzX21vZGlmaWVyKG1vZGlmaWVyKSA/IDQgOiAyKTsKK30KKwog
c3RhdGljIHVuc2lnbmVkIGludAogaW50ZWxfdGlsZV93aWR0aF9ieXRlcyhjb25zdCBzdHJ1Y3Qg
ZHJtX2ZyYW1lYnVmZmVyICpmYiwgaW50IGNvbG9yX3BsYW5lKQogewpAQCAtMzgxMyw3ICszODIx
LDggQEAgaW50IHNrbF9jaGVja19wbGFuZV9zdXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0
ZSAqcGxhbmVfc3RhdGUpCiAJICogSGFuZGxlIHRoZSBBVVggc3VyZmFjZSBmaXJzdCBzaW5jZQog
CSAqIHRoZSBtYWluIHN1cmZhY2Ugc2V0dXAgZGVwZW5kcyBvbiBpdC4KIAkgKi8KLQlpZiAoZHJt
X2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZiLT5mb3JtYXQpKSB7CisJaWYgKGludGVs
X2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZiLT5mb3JtYXQsCisJCQkJCSAgICAgICAg
ZmItPm1vZGlmaWVyKSkgewogCQlyZXQgPSBza2xfY2hlY2tfbnYxMl9hdXhfc3VyZmFjZShwbGFu
ZV9zdGF0ZSk7CiAJCWlmIChyZXQpCiAJCQlyZXR1cm4gcmV0OwpAQCAtNTc0Miw3ICs1NzUxLDgg
QEAgc3RhdGljIGludAogc2tsX3VwZGF0ZV9zY2FsZXIoc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUsIGJvb2wgZm9yY2VfZGV0YWNoLAogCQkgIHVuc2lnbmVkIGludCBzY2FsZXJf
dXNlciwgaW50ICpzY2FsZXJfaWQsCiAJCSAgaW50IHNyY193LCBpbnQgc3JjX2gsIGludCBkc3Rf
dywgaW50IGRzdF9oLAotCQkgIGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8gKmZvcm1hdCwg
Ym9vbCBuZWVkX3NjYWxlcikKKwkJICBjb25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9pbmZvICpmb3Jt
YXQsCisJCSAgdWludDY0X3QgbW9kaWZpZXIsIGJvb2wgbmVlZF9zY2FsZXIpCiB7CiAJc3RydWN0
IGludGVsX2NydGNfc2NhbGVyX3N0YXRlICpzY2FsZXJfc3RhdGUgPQogCQkmY3J0Y19zdGF0ZS0+
c2NhbGVyX3N0YXRlOwpAQCAtNTc5Niw3ICs1ODA2LDcgQEAgc2tsX3VwZGF0ZV9zY2FsZXIoc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsIGJvb2wgZm9yY2VfZGV0YWNoLAogCQly
ZXR1cm4gMDsKIAl9CiAKLQlpZiAoZm9ybWF0ICYmIGRybV9mb3JtYXRfaW5mb19pc195dXZfc2Vt
aXBsYW5hcihmb3JtYXQpICYmCisJaWYgKGZvcm1hdCAmJiBpbnRlbF9mb3JtYXRfaW5mb19pc195
dXZfc2VtaXBsYW5hcihmb3JtYXQsIG1vZGlmaWVyKSAmJgogCSAgICAoc3JjX2ggPCBTS0xfTUlO
X1lVVl80MjBfU1JDX0ggfHwgc3JjX3cgPCBTS0xfTUlOX1lVVl80MjBfU1JDX1cpKSB7CiAJCURS
TV9ERUJVR19LTVMoIlBsYW5hciBZVVY6IHNyYyBkaW1lbnNpb25zIG5vdCBtZXRcbiIpOwogCQly
ZXR1cm4gLUVJTlZBTDsKQEAgLTU4NDgsNyArNTg1OCw4IEBAIGludCBza2xfdXBkYXRlX3NjYWxl
cl9jcnRjKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpzdGF0ZSkKIAkJCQkgJnN0YXRlLT5zY2Fs
ZXJfc3RhdGUuc2NhbGVyX2lkLAogCQkJCSBzdGF0ZS0+cGlwZV9zcmNfdywgc3RhdGUtPnBpcGVf
c3JjX2gsCiAJCQkJIGFkanVzdGVkX21vZGUtPmNydGNfaGRpc3BsYXksCi0JCQkJIGFkanVzdGVk
X21vZGUtPmNydGNfdmRpc3BsYXksIE5VTEwsIG5lZWRfc2NhbGVyKTsKKwkJCQkgYWRqdXN0ZWRf
bW9kZS0+Y3J0Y192ZGlzcGxheSwgTlVMTCwgMCwKKwkJCQkgbmVlZF9zY2FsZXIpOwogfQogCiAv
KioKQEAgLTU4NzMsNyArNTg4NCw3IEBAIHN0YXRpYyBpbnQgc2tsX3VwZGF0ZV9zY2FsZXJfcGxh
bmUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAKIAkvKiBQcmUtZ2VuMTEg
YW5kIFNEUiBwbGFuZXMgYWx3YXlzIG5lZWQgYSBzY2FsZXIgZm9yIHBsYW5hciBmb3JtYXRzLiAq
LwogCWlmICghaWNsX2lzX2hkcl9wbGFuZShkZXZfcHJpdiwgaW50ZWxfcGxhbmUtPmlkKSAmJgot
CSAgICBmYiAmJiBkcm1fZm9ybWF0X2luZm9faXNfeXV2X3NlbWlwbGFuYXIoZmItPmZvcm1hdCkp
CisJICAgIGZiICYmIGludGVsX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZiLT5mb3Jt
YXQsIGZiLT5tb2RpZmllcikpCiAJCW5lZWRfc2NhbGVyID0gdHJ1ZTsKIAogCXJldCA9IHNrbF91
cGRhdGVfc2NhbGVyKGNydGNfc3RhdGUsIGZvcmNlX2RldGFjaCwKQEAgLTU4ODMsNyArNTg5NCw5
IEBAIHN0YXRpYyBpbnQgc2tsX3VwZGF0ZV9zY2FsZXJfcGxhbmUoc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUsCiAJCQkJZHJtX3JlY3RfaGVpZ2h0KCZwbGFuZV9zdGF0ZS0+dWFw
aS5zcmMpID4+IDE2LAogCQkJCWRybV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+dWFwaS5kc3Qp
LAogCQkJCWRybV9yZWN0X2hlaWdodCgmcGxhbmVfc3RhdGUtPnVhcGkuZHN0KSwKLQkJCQlmYiA/
IGZiLT5mb3JtYXQgOiBOVUxMLCBuZWVkX3NjYWxlcik7CisJCQkJZmIgPyBmYi0+Zm9ybWF0IDog
TlVMTCwKKwkJCQlmYiA/IGZiLT5tb2RpZmllciA6IDAsCisJCQkJbmVlZF9zY2FsZXIpOwogCiAJ
aWYgKHJldCB8fCBwbGFuZV9zdGF0ZS0+c2NhbGVyX2lkIDwgMCkKIAkJcmV0dXJuIHJldDsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmgKaW5kZXggZmY0OTZj
ZmJkNGFiLi4wZmVmOTI2M2NkZGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZGlzcGxheS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheS5oCkBAIC02MDEsNiArNjAxLDEwIEBAIGludGVsX2Rpc3BsYXlfY2FwdHVy
ZV9lcnJvcl9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBp
bnRlbF9kaXNwbGF5X3ByaW50X2Vycm9yX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9lcnJvcl9zdGF0
ZV9idWYgKmUsCiAJCQkJICAgICBzdHJ1Y3QgaW50ZWxfZGlzcGxheV9lcnJvcl9zdGF0ZSAqZXJy
b3IpOwogCitib29sCitpbnRlbF9mb3JtYXRfaW5mb19pc195dXZfc2VtaXBsYW5hcihjb25zdCBz
dHJ1Y3QgZHJtX2Zvcm1hdF9pbmZvICppbmZvLAorCQkJCSAgICB1aW50NjRfdCBtb2RpZmllcik7
CisKIC8qIG1vZGVzZXR0aW5nICovCiB2b2lkIGludGVsX21vZGVzZXRfaW5pdF9odyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiBpbnQgaW50ZWxfbW9kZXNldF9pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX3Nwcml0ZS5jCmluZGV4IDY3YTkwMDU5OTAwZi4uYjdmM2ExYjMzNThmIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3Nwcml0ZS5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfc3ByaXRlLmMKQEAgLTQxNyw3ICs0MTcsNyBA
QCBza2xfcHJvZ3JhbV9zY2FsZXIoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKIAkJCQkgICAg
ICAwLCBJTlRfTUFYKTsKIAogCS8qIFRPRE86IGhhbmRsZSBzdWItcGl4ZWwgY29vcmRpbmF0ZXMg
Ki8KLQlpZiAoZHJtX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZiLT5mb3JtYXQpICYm
CisJaWYgKGludGVsX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZiLT5mb3JtYXQsIGZi
LT5tb2RpZmllcikgJiYKIAkgICAgIWljbF9pc19oZHJfcGxhbmUoZGV2X3ByaXYsIHBsYW5lLT5p
ZCkpIHsKIAkJeV9ocGhhc2UgPSBza2xfc2NhbGVyX2NhbGNfcGhhc2UoMSwgaHNjYWxlLCBmYWxz
ZSk7CiAJCXlfdnBoYXNlID0gc2tsX3NjYWxlcl9jYWxjX3BoYXNlKDEsIHZzY2FsZSwgZmFsc2Up
OwpAQCAtMjE1MSw3ICsyMTUxLDcgQEAgc3RhdGljIGludCBza2xfcGxhbmVfY2hlY2tfbnYxMl9y
b3RhdGlvbihjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3MKIAlpbnQgc3Jj
X3cgPSBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUtPnVhcGkuc3JjKSA+PiAxNjsKIAogCS8q
IERpc3BsYXkgV0EgIzExMDYgKi8KLQlpZiAoZHJtX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxh
bmFyKGZiLT5mb3JtYXQpICYmIHNyY193ICYgMyAmJgorCWlmIChpbnRlbF9mb3JtYXRfaW5mb19p
c195dXZfc2VtaXBsYW5hcihmYi0+Zm9ybWF0LCBmYi0+bW9kaWZpZXIpICYmIHNyY193ICYgMyAm
JgogCSAgICAocm90YXRpb24gPT0gRFJNX01PREVfUk9UQVRFXzI3MCB8fAogCSAgICAgcm90YXRp
b24gPT0gKERSTV9NT0RFX1JFRkxFQ1RfWCB8IERSTV9NT0RFX1JPVEFURV85MCkpKSB7CiAJCURS
TV9ERUJVR19LTVMoInNyYyB3aWR0aCBtdXN0IGJlIG11bHRpcGxlIG9mIDQgZm9yIHJvdGF0ZWQg
cGxhbmFyIFlVVlxuIik7CkBAIC0yMTcxLDcgKzIxNzEsNyBAQCBzdGF0aWMgaW50IHNrbF9wbGFu
ZV9tYXhfc2NhbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCSAqIEZJWE1F
IG5lZWQgdG8gcHJvcGVybHkgY2hlY2sgdGhpcyBsYXRlci4KIAkgKi8KIAlpZiAoSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMCB8fCBJU19HRU1JTklMQUtFKGRldl9wcml2KSB8fAotCSAgICAhZHJt
X2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZiLT5mb3JtYXQpKQorCSAgICAhaW50ZWxf
Zm9ybWF0X2luZm9faXNfeXV2X3NlbWlwbGFuYXIoZmItPmZvcm1hdCwgZmItPm1vZGlmaWVyKSkK
IAkJcmV0dXJuIDB4MzAwMDAgLSAxOwogCWVsc2UKIAkJcmV0dXJuIDB4MjAwMDAgLSAxOwpAQCAt
MjIzMyw3ICsyMjMzLDcgQEAgc3RhdGljIGludCBza2xfcGxhbmVfY2hlY2soc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCXBsYW5lX3N0YXRlLT5jb2xvcl9jdGwgPSBnbGtf
cGxhbmVfY29sb3JfY3RsKGNydGNfc3RhdGUsCiAJCQkJCQkJICAgICBwbGFuZV9zdGF0ZSk7CiAK
LQlpZiAoZHJtX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZiLT5mb3JtYXQpICYmCisJ
aWYgKGludGVsX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZiLT5mb3JtYXQsIGZiLT5t
b2RpZmllcikgJiYKIAkgICAgaWNsX2lzX2hkcl9wbGFuZShkZXZfcHJpdiwgcGxhbmUtPmlkKSkK
IAkJLyogRW5hYmxlIGFuZCB1c2UgTVBFRy0yIGNocm9tYSBzaXRpbmcgKi8KIAkJcGxhbmVfc3Rh
dGUtPmN1c19jdGwgPSBQTEFORV9DVVNfRU5BQkxFIHwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCmlu
ZGV4IDdjZGNhMDZiZTNiZC4uMzFlYzgyMzM3ZTRmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMK
QEAgLTQxMzUsNyArNDEzNSw3IEBAIHNrbF9wbGFuZV9yZWxhdGl2ZV9kYXRhX3JhdGUoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCXJldHVybiAwOwogCiAJaWYg
KGNvbG9yX3BsYW5lID09IDEgJiYKLQkgICAgIWRybV9mb3JtYXRfaW5mb19pc195dXZfc2VtaXBs
YW5hcihmYi0+Zm9ybWF0KSkKKwkgICAgIWludGVsX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxh
bmFyKGZiLT5mb3JtYXQsIGZiLT5tb2RpZmllcikpCiAJCXJldHVybiAwOwogCiAJLyoKQEAgLTQ1
NTksNyArNDU1OSw4IEBAIHNrbF9jb21wdXRlX3dtX3BhcmFtcyhjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAl1MzIgaW50ZXJtX3BicGw7CiAKIAkvKiBvbmx5IHBs
YW5hciBmb3JtYXQgaGFzIHR3byBwbGFuZXMgKi8KLQlpZiAoY29sb3JfcGxhbmUgPT0gMSAmJiAh
ZHJtX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZvcm1hdCkpIHsKKwlpZiAoY29sb3Jf
cGxhbmUgPT0gMSAmJgorCSAgICAhaW50ZWxfZm9ybWF0X2luZm9faXNfeXV2X3NlbWlwbGFuYXIo
Zm9ybWF0LCBtb2RpZmllcikpIHsKIAkJRFJNX0RFQlVHX0tNUygiTm9uIHBsYW5hciBmb3JtYXQg
aGF2ZSBzaW5nbGUgcGxhbmVcbiIpOwogCQlyZXR1cm4gLUVJTlZBTDsKIAl9CkBAIC00NTcxLDcg
KzQ1NzIsNyBAQCBza2xfY29tcHV0ZV93bV9wYXJhbXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUsCiAJd3AtPnhfdGlsZWQgPSBtb2RpZmllciA9PSBJOTE1X0ZPUk1B
VF9NT0RfWF9USUxFRDsKIAl3cC0+cmNfc3VyZmFjZSA9IG1vZGlmaWVyID09IEk5MTVfRk9STUFU
X01PRF9ZX1RJTEVEX0NDUyB8fAogCQkJIG1vZGlmaWVyID09IEk5MTVfRk9STUFUX01PRF9ZZl9U
SUxFRF9DQ1M7Ci0Jd3AtPmlzX3BsYW5hciA9IGRybV9mb3JtYXRfaW5mb19pc195dXZfc2VtaXBs
YW5hcihmb3JtYXQpOworCXdwLT5pc19wbGFuYXIgPSBpbnRlbF9mb3JtYXRfaW5mb19pc195dXZf
c2VtaXBsYW5hcihmb3JtYXQsIG1vZGlmaWVyKTsKIAogCXdwLT53aWR0aCA9IHdpZHRoOwogCWlm
IChjb2xvcl9wbGFuZSA9PSAxICYmIHdwLT5pc19wbGFuYXIpCi0tIAoyLjIyLjAKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5n
IGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

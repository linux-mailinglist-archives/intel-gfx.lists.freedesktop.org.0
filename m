Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id DDF0D2AB555
	for <lists+intel-gfx@lfdr.de>; Mon,  9 Nov 2020 11:48:31 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4FE55898C8;
	Mon,  9 Nov 2020 10:48:30 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EA591898BF;
 Mon,  9 Nov 2020 10:48:27 +0000 (UTC)
IronPort-SDR: s6jwcGzIlOgGBnr9m4uVPK/WpwMJAk+btNXA/NvOhiVVXzoKikyH7gw7z4rnx6jVXFe90A001t
 WQiS9f2I2Z6g==
X-IronPort-AV: E=McAfee;i="6000,8403,9799"; a="254488943"
X-IronPort-AV: E=Sophos;i="5.77,463,1596524400"; d="scan'208";a="254488943"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by fmsmga105.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 09 Nov 2020 02:48:27 -0800
IronPort-SDR: jgHI+45pxSFYJTLnsXw7MPEEvevNWtJuoBQw6CKRrEWr4nIVGglYTjmz8eLYMnSYUNktyKkB7l
 sh+Hc9ddRCQw==
X-IronPort-AV: E=Sophos;i="5.77,463,1596524400"; d="scan'208";a="327227171"
Received: from staskuzm-mobl1.ger.corp.intel.com (HELO localhost.localdomain)
 ([10.255.196.231])
 by orsmga006-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 09 Nov 2020 02:48:25 -0800
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
To: igt-dev@lists.freedesktop.org
Date: Mon,  9 Nov 2020 10:48:09 +0000
Message-Id: <20201109104811.3773962-2-tvrtko.ursulin@linux.intel.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20201109104811.3773962-1-tvrtko.ursulin@linux.intel.com>
References: <20201109104811.3773962-1-tvrtko.ursulin@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [RFC 1/3] intel_gpu_top: User friendly device listing
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KCkFkZGluZyBh
IG5ldyBkZXZpY2Ugc2VsZWN0aW9uIHByaW50IHR5cGUgc3VpdGFibGUgZm9yIHVzZXItZmFjaW5n
CnVzZSBjYXNlcyBsaWtlIGludGVsX2dwdV90b3AgLUwgYW5kIGxhdGVyIGxzZ3B1LgoKSW5zdGVh
ZCBvZjoKCnN5czovc3lzL2RldmljZXMvcGNpMDAwMDowMC8wMDAwOjAwOjAyLjAvZHJtL2NhcmQw
CiAgICBzdWJzeXN0ZW0gICAgICAgOiBkcm0KICAgIGRybSBjYXJkICAgICAgICA6IC9kZXYvZHJp
L2NhcmQwCiAgICBwYXJlbnQgICAgICAgICAgOiBzeXM6L3N5cy9kZXZpY2VzL3BjaTAwMDA6MDAv
MDAwMDowMDowMi4wCgpzeXM6L3N5cy9kZXZpY2VzL3BjaTAwMDA6MDAvMDAwMDowMDowMi4wL2Ry
bS9yZW5kZXJEMTI4CiAgICBzdWJzeXN0ZW0gICAgICAgOiBkcm0KICAgIGRybSByZW5kZXIgICAg
ICA6IC9kZXYvZHJpL3JlbmRlckQxMjgKICAgIHBhcmVudCAgICAgICAgICA6IHN5czovc3lzL2Rl
dmljZXMvcGNpMDAwMDowMC8wMDAwOjAwOjAyLjAKCnN5czovc3lzL2RldmljZXMvcGNpMDAwMDow
MC8wMDAwOjAwOjAyLjAKICAgIHN1YnN5c3RlbSAgICAgICA6IHBjaQogICAgZHJtIGNhcmQgICAg
ICAgIDogL2Rldi9kcmkvY2FyZDAKICAgIGRybSByZW5kZXIgICAgICA6IC9kZXYvZHJpL3JlbmRl
ckQxMjgKICAgIHZlbmRvciAgICAgICAgICA6IDgwODYKICAgIGRldmljZSAgICAgICAgICA6IDE5
M0IKCk5ldyBmb3JtYXQgbG9va3MgbGlrZToKCmNhcmQwICAgICAgICAgICAgICAgICAgIDgwODY6
MTkzQiAgICBkcm06L2Rldi9kcmkvY2FyZDAK4pSU4pSAcmVuZGVyRDEyOCAgICAgICAgICAgICAg
ICAgICAgICAgICBkcm06L2Rldi9kcmkvcmVuZGVyRDEyOAoKQWR2YW50YWdlcyBhcmUgbW9yZSBj
b21wYWN0LCBtb3JlIHJlYWRhYmxlLCBvbmUgZW50cnkgcGVyIEdQVSwgc2hvcnRlcgpzdHJpbmcg
dG8gY29weSBhbmQgcGFzdGUgdG8gaW50ZWxfZ3B1X3RvcCAtZCwgb3IgcmVzcGVjdGl2ZSB1c2Fn
ZS4KClNpZ25lZC1vZmYtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5j
b20+CkNjOiBQZXRyaSBMYXR2YWxhIDxwZXRyaS5sYXR2YWxhQGludGVsLmNvbT4KQ2M6IFpiaWdu
aWV3IEtlbXBjennFhHNraSA8emJpZ25pZXcua2VtcGN6eW5za2lAaW50ZWwuY29tPgotLS0KIGxp
Yi9pZ3RfZGV2aWNlX3NjYW4uYyB8IDEwOSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrLS0tLS0KIGxpYi9pZ3RfZGV2aWNlX3NjYW4uaCB8ICAgMSArCiB0b29scy9pbnRlbF9n
cHVfdG9wLmMgfCAgIDMgKy0KIDMgZmlsZXMgY2hhbmdlZCwgMTAwIGluc2VydGlvbnMoKyksIDEz
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2xpYi9pZ3RfZGV2aWNlX3NjYW4uYyBiL2xpYi9p
Z3RfZGV2aWNlX3NjYW4uYwppbmRleCBjNTgxYTMxYWU1NWUuLmU2NmNjZGMyNWFlYiAxMDA2NDQK
LS0tIGEvbGliL2lndF9kZXZpY2Vfc2Nhbi5jCisrKyBiL2xpYi9pZ3RfZGV2aWNlX3NjYW4uYwpA
QCAtNzM1LDE4ICs3MzUsMjYgQEAgc3RhdGljIGlubGluZSB2b2lkIF9wcl9zaW1wbGUyKGNvbnN0
IGNoYXIgKmssIGNvbnN0IGNoYXIgKnYxLCBjb25zdCBjaGFyICp2MikKIAlwcmludGYoIiAgICAl
LTE2czogJXM6JXNcbiIsIGssIHYxLCB2Mik7CiB9CiAKLXN0YXRpYyB2b2lkIGlndF9kZXZzX3By
aW50X3NpbXBsZShzdHJ1Y3QgaWd0X2xpc3RfaGVhZCAqdmlldykKK3N0YXRpYyBib29sIF9fY2hl
Y2tfZW1wdHkoc3RydWN0IGlndF9saXN0X2hlYWQgKnZpZXcpCiB7Ci0Jc3RydWN0IGlndF9kZXZp
Y2UgKmRldjsKLQogCWlmICghdmlldykKLQkJcmV0dXJuOworCQlyZXR1cm4gdHJ1ZTsKIAogCWlm
IChpZ3RfbGlzdF9lbXB0eSh2aWV3KSkgewogCQlwcmludGYoIk5vIEdQVSBkZXZpY2VzIGZvdW5k
XG4iKTsKLQkJcmV0dXJuOworCQlyZXR1cm4gdHJ1ZTsKIAl9CiAKKwlyZXR1cm4gZmFsc2U7Cit9
CisKK3N0YXRpYyB2b2lkIGlndF9kZXZzX3ByaW50X3NpbXBsZShzdHJ1Y3QgaWd0X2xpc3RfaGVh
ZCAqdmlldykKK3sKKwlzdHJ1Y3QgaWd0X2RldmljZSAqZGV2OworCisJaWYgKF9fY2hlY2tfZW1w
dHkodmlldykpCisJCXJldHVybjsKKwogCWlndF9saXN0X2Zvcl9lYWNoX2VudHJ5KGRldiwgdmll
dywgbGluaykgewogCQlwcmludGYoInN5czolc1xuIiwgZGV2LT5zeXNwYXRoKTsKIAkJaWYgKGRl
di0+c3Vic3lzdGVtKQpAQCAtNzY4LDYgKzc3Niw4OSBAQCBzdGF0aWMgdm9pZCBpZ3RfZGV2c19w
cmludF9zaW1wbGUoc3RydWN0IGlndF9saXN0X2hlYWQgKnZpZXcpCiAJfQogfQogCitzdGF0aWMg
c3RydWN0IGlndF9kZXZpY2UgKgorX19maW5kX3BjaShzdHJ1Y3QgaWd0X2xpc3RfaGVhZCAqdmll
dywgY29uc3QgY2hhciAqZHJtKQoreworCXN0cnVjdCBpZ3RfZGV2aWNlICpkZXY7CisKKwlpZ3Rf
bGlzdF9mb3JfZWFjaF9lbnRyeShkZXYsIHZpZXcsIGxpbmspIHsKKwkJaWYgKCFpc19wY2lfc3Vi
c3lzdGVtKGRldikgfHwgIWRldi0+ZHJtX2NhcmQpCisJCQljb250aW51ZTsKKworCQlpZiAoIXN0
cmNtcChkZXYtPmRybV9jYXJkLCBkcm0pKQorCQkJcmV0dXJuIGRldjsKKwl9CisKKwlyZXR1cm4g
TlVMTDsKK30KKworc3RhdGljIHZvaWQgaWd0X2RldnNfcHJpbnRfdXNlcihzdHJ1Y3QgaWd0X2xp
c3RfaGVhZCAqdmlldykKK3sKKwlzdHJ1Y3QgaWd0X2RldmljZSAqZGV2OworCisJaWYgKF9fY2hl
Y2tfZW1wdHkodmlldykpCisJCXJldHVybjsKKworCWlndF9saXN0X2Zvcl9lYWNoX2VudHJ5KGRl
diwgdmlldywgbGluaykgeworCQl1bnNpZ25lZCBpbnQgaSwgbnVtX2NoaWxkcmVuOworCQlzdHJ1
Y3QgaWd0X2RldmljZSAqcGNpX2RldjsKKwkJc3RydWN0IGlndF9kZXZpY2UgKmRldjI7CisJCWNo
YXIgZmlsdGVyWzY0XTsKKwkJY2hhciAqZHJtX25hbWU7CisJCWludCByZXQ7CisKKwkJaWYgKCFp
c19kcm1fc3Vic3lzdGVtKGRldikpCisJCQljb250aW51ZTsKKwkJaWYgKCFkZXYtPmRybV9jYXJk
IHx8IGRldi0+ZHJtX3JlbmRlcikKKwkJCWNvbnRpbnVlOworCisJCWRybV9uYW1lID0gcmluZGV4
KGRldi0+ZHJtX2NhcmQsICcvJyk7CisJCWlmICghZHJtX25hbWUgfHwgISorK2RybV9uYW1lKQor
CQkJY29udGludWU7CisKKwkJcmV0ID0gc25wcmludGYoZmlsdGVyLCBzaXplb2YoZmlsdGVyKSwg
ImRybTolcyIsIGRldi0+ZHJtX2NhcmQpOworCQlpZ3RfYXNzZXJ0KHJldCA8IHNpemVvZihmaWx0
ZXIpKTsKKworCQlwY2lfZGV2ID0gX19maW5kX3BjaSh2aWV3LCBkZXYtPmRybV9jYXJkKTsKKwkJ
aWYgKHBjaV9kZXYpCisJCQlwcmludGYoIiUtMjRzJTRzOiU0cyAgICAlc1xuIiwKKwkJCSAgICAg
ICBkcm1fbmFtZSwgcGNpX2Rldi0+dmVuZG9yLCBwY2lfZGV2LT5kZXZpY2UsCisJCQkgICAgICAg
ZmlsdGVyKTsKKwkJZWxzZQorCQkJcHJpbnRmKCIlLTI0cyAgICAgICAgICAgICAlc1xuIiwgZHJt
X25hbWUsIGZpbHRlcik7CisKKwkJbnVtX2NoaWxkcmVuID0gMDsKKwkJaWd0X2xpc3RfZm9yX2Vh
Y2hfZW50cnkoZGV2MiwgdmlldywgbGluaykgeworCQkJaWYgKCFpc19kcm1fc3Vic3lzdGVtKGRl
djIpIHx8ICFkZXYyLT5kcm1fcmVuZGVyKQorCQkJCWNvbnRpbnVlOworCQkJaWYgKHN0cmNtcChk
ZXYyLT5wYXJlbnQtPnN5c3BhdGgsIGRldi0+cGFyZW50LT5zeXNwYXRoKSkKKwkJCQljb250aW51
ZTsKKworCQkJbnVtX2NoaWxkcmVuKys7CisJCX0KKworCQlpID0gMDsKKwkJaWd0X2xpc3RfZm9y
X2VhY2hfZW50cnkoZGV2MiwgdmlldywgbGluaykgeworCQkJaWYgKCFpc19kcm1fc3Vic3lzdGVt
KGRldjIpIHx8ICFkZXYyLT5kcm1fcmVuZGVyKQorCQkJCWNvbnRpbnVlOworCQkJaWYgKHN0cmNt
cChkZXYyLT5wYXJlbnQtPnN5c3BhdGgsIGRldi0+cGFyZW50LT5zeXNwYXRoKSkKKwkJCQljb250
aW51ZTsKKworCQkJZHJtX25hbWUgPSByaW5kZXgoZGV2Mi0+ZHJtX3JlbmRlciwgJy8nKTsKKwkJ
CWlmICghZHJtX25hbWUgfHwgISorK2RybV9uYW1lKQorCQkJCWNvbnRpbnVlOworCisJCQlyZXQg
PSBzbnByaW50ZihmaWx0ZXIsIHNpemVvZihmaWx0ZXIpLCAiZHJtOiVzIiwKKwkJCQkgICAgICAg
ZGV2Mi0+ZHJtX3JlbmRlcik7CisJCQlpZ3RfYXNzZXJ0KHJldCA8IHNpemVvZihmaWx0ZXIpKTsK
KworCQkJcHJpbnRmKCIlcyUtMjJzICAgICAgICAgICAgICVzXG4iLAorCQkJICAgICAgICgrK2kg
PT0gbnVtX2NoaWxkcmVuKSA/ICLilJTilIAiIDogIuKUnOKUgCIsCisJCQkgICAgICAgZHJtX25h
bWUsIGZpbHRlcik7CisJCX0KKwl9Cit9CisKIHN0YXRpYyBpbmxpbmUgdm9pZCBfcHJpbnRfa2V5
X3ZhbHVlKGNvbnN0IGNoYXIqIGssIGNvbnN0IGNoYXIgKnYpCiB7CiAJcHJpbnRmKCIlLTMyczog
JXNcbiIsIGssIHYpOwpAQCAtNzkyLDE0ICs4ODMsOSBAQCBzdGF0aWMgdm9pZCBpZ3RfZGV2c19w
cmludF9kZXRhaWwoc3RydWN0IGlndF9saXN0X2hlYWQgKnZpZXcpCiB7CiAJc3RydWN0IGlndF9k
ZXZpY2UgKmRldjsKIAotCWlmICghdmlldykKKwlpZiAoX19jaGVja19lbXB0eSh2aWV3KSkKIAkJ
cmV0dXJuOwogCi0JaWYgKGlndF9saXN0X2VtcHR5KHZpZXcpKSB7Ci0JCXByaW50ZigiTm8gR1BV
IGRldmljZXMgZm91bmRcbiIpOwotCQlyZXR1cm47Ci0JfQotCiAJaWd0X2xpc3RfZm9yX2VhY2hf
ZW50cnkoZGV2LCB2aWV3LCBsaW5rKSB7CiAJCXByaW50ZigiPT09PT09PT09PSAlczolcyA9PT09
PT09PT09XG4iLAogCQkgICAgICAgZGV2LT5zdWJzeXN0ZW0sIGRldi0+c3lzcGF0aCk7CkBAIC04
MjEsNiArOTA3LDcgQEAgc3RhdGljIHN0cnVjdCBwcmludF9mdW5jIHsKIH0gcHJpbnRfZnVuY3Rp
b25zW10gPSB7CiAJW0lHVF9QUklOVF9TSU1QTEVdID0geyAucHJuID0gaWd0X2RldnNfcHJpbnRf
c2ltcGxlIH0sCiAJW0lHVF9QUklOVF9ERVRBSUxdID0geyAucHJuID0gaWd0X2RldnNfcHJpbnRf
ZGV0YWlsIH0sCisJW0lHVF9QUklOVF9VU0VSXSA9IHsgLnBybiA9IGlndF9kZXZzX3ByaW50X3Vz
ZXIgfSwKIH07CiAKIC8qKgpkaWZmIC0tZ2l0IGEvbGliL2lndF9kZXZpY2Vfc2Nhbi5oIGIvbGli
L2lndF9kZXZpY2Vfc2Nhbi5oCmluZGV4IDk5ZGFlZTBjNTJkNi4uOTgyMmMyMmNiNjljIDEwMDY0
NAotLS0gYS9saWIvaWd0X2RldmljZV9zY2FuLmgKKysrIGIvbGliL2lndF9kZXZpY2Vfc2Nhbi5o
CkBAIC0zNyw2ICszNyw3IEBACiBlbnVtIGlndF9kZXZpY2VzX3ByaW50X3R5cGUgewogCUlHVF9Q
UklOVF9TSU1QTEUsCiAJSUdUX1BSSU5UX0RFVEFJTCwKKwlJR1RfUFJJTlRfVVNFUiwgLyogRW5k
IHVzZXIgZnJpZW5kbHkuICovCiB9OwogCiAjZGVmaW5lIElOVEVHUkFURURfSTkxNV9HUFVfUENJ
X0lEICIwMDAwOjAwOjAyLjAiCmRpZmYgLS1naXQgYS90b29scy9pbnRlbF9ncHVfdG9wLmMgYi90
b29scy9pbnRlbF9ncHVfdG9wLmMKaW5kZXggMjk4ZGVmYTRlNmVkLi41MjMwNDcyZDJhZjQgMTAw
NjQ0Ci0tLSBhL3Rvb2xzL2ludGVsX2dwdV90b3AuYworKysgYi90b29scy9pbnRlbF9ncHVfdG9w
LmMKQEAgLTEzMTMsNyArMTMxMyw2IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikK
IAl1bnNpZ25lZCBpbnQgaTsKIAlpbnQgcmV0ID0gMCwgY2g7CiAJYm9vbCBsaXN0X2RldmljZSA9
IGZhbHNlOwotCWVudW0gaWd0X2RldmljZXNfcHJpbnRfdHlwZSBwcmludHR5cGUgPSBJR1RfUFJJ
TlRfU0lNUExFOwogCWNoYXIgKnBtdV9kZXZpY2UsICpvcHRfZGV2aWNlID0gTlVMTDsKIAlzdHJ1
Y3QgaWd0X2RldmljZV9jYXJkIGNhcmQ7CiAKQEAgLTEzODgsNyArMTM4Nyw3IEBAIGludCBtYWlu
KGludCBhcmdjLCBjaGFyICoqYXJndikKIAlpZ3RfZGV2aWNlc19zY2FuKGZhbHNlKTsKIAogCWlm
IChsaXN0X2RldmljZSkgewotCQlpZ3RfZGV2aWNlc19wcmludChwcmludHR5cGUpOworCQlpZ3Rf
ZGV2aWNlc19wcmludChJR1RfUFJJTlRfVVNFUik7CiAJCWdvdG8gZXhpdDsKIAl9CiAKLS0gCjIu
MjUuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50
ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

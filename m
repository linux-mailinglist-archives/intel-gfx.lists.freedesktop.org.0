Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 3F0E212BC64
	for <lists+intel-gfx@lfdr.de>; Sat, 28 Dec 2019 04:10:27 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EBEAD6E12E;
	Sat, 28 Dec 2019 03:10:23 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BE90F6E12D
 for <intel-gfx@lists.freedesktop.org>; Sat, 28 Dec 2019 03:10:19 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 27 Dec 2019 19:10:18 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,365,1571727600"; d="scan'208";a="220658297"
Received: from labuser-z97x-ud5h.jf.intel.com ([10.54.75.49])
 by orsmga003.jf.intel.com with ESMTP; 27 Dec 2019 19:10:17 -0800
From: Manasi Navare <manasi.d.navare@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 27 Dec 2019 19:12:02 -0800
Message-Id: <20191228031204.10189-1-manasi.d.navare@intel.com>
X-Mailer: git-send-email 2.19.1
MIME-Version: 1.0
Subject: [Intel-gfx] [CI v6 1/3] drm/i915/dp: Make sure all tiled connectors
 get added to the state with full modeset
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SW4gY2FzZSBvZiB0aWxlZCBkaXNwbGF5cywgYWxsIHRoZSB0aWxlcyBhcmUgbGlua2UgZHRvIGVh
Y2ggb3RoZXIKZm9yIHRyYW5zY29kZXIgcG9ydCBzeW5jLiBTbyBpbiBpbnRlbF9hdG9taWNfY2hl
Y2soKSB3ZSBuZWVkIHRvIG1ha2UKc3VyZSB0aGF0IHdlIGFkZCBhbGwgdGhlIHRpbGVzIHRvIHRo
ZSBtb2Rlc2V0IGFuZCBpZiBvbmUgb2YgdGhlCnRpbGVzIG5lZWRzIGEgZnVsbCBtb2Rlc2V0IHRo
ZW4gbWFyayBhbGwgb3RoZXIgdGlsZXMgZm9yIGEgZnVsbCBtb2Rlc2V0LgoKV2UgYWxzbyBuZWVk
IHRvIGZvcmNlIG1vZGVzZXQgZm9yIGFsbCBzeW5jZWQgY3J0Y3MgYWZ0ZXIgZmFzdHNldCBjaGVj
ay4KCnY2OgoqIEFkZCBjb21tZW50cyBhYm91dCB3aHkgd2UgZG8gbm90IGNhbGwKZHJtX2F0b21p
Y19oZWxwZXJfY2hlY2tfbW9kZXNldCAoTWF0dCkKKiBBZGQgRklYTUUgZm9yIGEgY29ybmVyIGNh
c2Ugd2hlcmUgdGlsZSBpbmZvIG1pZ2h0IHZhbmlzaCAoTWF0dCkKdjU6CiogUmViYXNlCnY0Ogoq
IEZpeCBsb2dpYyBmb3IgbW9kZXNldF9zeW5jZWRfY3J0Y3MgKFZpbGxlKQp2MzoKKiBBZGQgdGls
ZSBjaGVja3Mgb25seSBmb3IgR2VuID4xMQp2MjoKKiBDaGFuZ2UgY3J0Y19zdGF0ZSBzY29wZSwg
cmVtb3ZlIHRpbGVfZ3JwX2lkIChWaWxsZSkKKiBVc2UgaW50ZWxfY29ubmVjdG9yX25lZWRzX21v
ZGVzZXQoKSAoVmlsbGUpCiogQWRkIG1vZGVzZXRfc3luY2VkX2NydGNzIChWaWxsZSkKKiBNYWtl
IHN1cmUgc3luY2VkIGNydGNzIGFyZSBmb3JjZWQgZnVsbCBtb2Rlc2V0CmFmdGVyIGZhc3RzZXQg
Y2hlY2sgKFZpbGxlKQoKU3VnZ2VzdGVkLWJ5OiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmph
bGFAbGludXguaW50ZWwuY29tPgpDYzogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxp
bnV4LmludGVsLmNvbT4KQ2M6IEpvc8OpIFJvYmVydG8gZGUgU291emEgPGpvc2Uuc291emFAaW50
ZWwuY29tPgpDYzogTWF0dCBSb3BlciA8bWF0dGhldy5kLnJvcGVyQGludGVsLmNvbT4KQnVnemls
bGE6IGh0dHBzOi8vZ2l0bGFiLmZyZWVkZXNrdG9wLm9yZy9kcm0vaW50ZWwvaXNzdWVzLzUKU2ln
bmVkLW9mZi1ieTogTWFuYXNpIE5hdmFyZSA8bWFuYXNpLmQubmF2YXJlQGludGVsLmNvbT4KUmV2
aWV3ZWQtYnk6IE1hdHQgUm9wZXIgPG1hdHRoZXcuZC5yb3BlckBpbnRlbC5jb20+Ci0tLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgfCAxMzggKysrKysrKysr
KysrKysrKysrKwogMSBmaWxlIGNoYW5nZWQsIDEzOCBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwppbmRleCBiNTg4YzI2NjJlOTUu
LmJkNTc5OTk1NTMzYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
aXNwbGF5LmMKQEAgLTE0MzA0LDYgKzE0MzA0LDExOCBAQCBzdGF0aWMgYm9vbCBpbnRlbF9jcHVf
dHJhbnNjb2Rlcl9uZWVkc19tb2Rlc2V0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
LAogCXJldHVybiBmYWxzZTsKIH0KIAorc3RhdGljIHZvaWQKK2ludGVsX21vZGVzZXRfc3luY2Vk
X2NydGNzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJICAgdTggdHJhbnNj
b2RlcnMpCit7CisJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlOworCXN0
cnVjdCBpbnRlbF9jcnRjICpjcnRjOworCWludCBpOworCisJZm9yX2VhY2hfbmV3X2ludGVsX2Ny
dGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsCisJCQkJCSBuZXdfY3J0Y19zdGF0ZSwgaSkgeworCQlp
ZiAodHJhbnNjb2RlcnMgJiBCSVQobmV3X2NydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKSkgewor
CQkJbmV3X2NydGNfc3RhdGUtPnVhcGkubW9kZV9jaGFuZ2VkID0gdHJ1ZTsKKwkJCW5ld19jcnRj
X3N0YXRlLT51cGRhdGVfcGlwZSA9IGZhbHNlOworCQl9CisJfQorfQorCitzdGF0aWMgdm9pZAor
aW50ZWxfYXRvbWljX2NoZWNrX3N5bmNlZF9jcnRjcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
ICpzdGF0ZSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KHN0YXRlLT5iYXNlLmRldik7CisJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0
YXRlOworCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjOworCWludCBpOworCisJaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPCAxMSkKKwkJcmV0dXJuOworCisJZm9yX2VhY2hfbmV3X2ludGVsX2NydGNf
aW5fc3RhdGUoc3RhdGUsIGNydGMsCisJCQkJCSBuZXdfY3J0Y19zdGF0ZSwgaSkgeworCQlpZiAo
aXNfdHJhbnNfcG9ydF9zeW5jX21hc3RlcihuZXdfY3J0Y19zdGF0ZSkgJiYKKwkJICAgIG5lZWRz
X21vZGVzZXQobmV3X2NydGNfc3RhdGUpKSB7CisJCQlpbnRlbF9tb2Rlc2V0X3N5bmNlZF9jcnRj
cyhzdGF0ZSwKKwkJCQkJCSAgIG5ld19jcnRjX3N0YXRlLT5zeW5jX21vZGVfc2xhdmVzX21hc2sp
OworCQl9IGVsc2UgaWYgKGlzX3RyYW5zX3BvcnRfc3luY19zbGF2ZShuZXdfY3J0Y19zdGF0ZSkg
JiYKKwkJCSAgIG5lZWRzX21vZGVzZXQobmV3X2NydGNfc3RhdGUpKSB7CisJCQlpbnRlbF9tb2Rl
c2V0X3N5bmNlZF9jcnRjcyhzdGF0ZSwKKwkJCQkJCSAgIEJJVChuZXdfY3J0Y19zdGF0ZS0+bWFz
dGVyX3RyYW5zY29kZXIpKTsKKwkJfQorCX0KK30KKworc3RhdGljIGludAoraW50ZWxfbW9kZXNl
dF9hbGxfdGlsZXMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsIGludCB0aWxlX2dy
cF9pZCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHN0
YXRlLT5iYXNlLmRldik7CisJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcjsKKwlzdHJ1
Y3QgZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXIgY29ubl9pdGVyOworCWludCByZXQgPSAwOworCisJ
ZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXJfYmVnaW4oJmRldl9wcml2LT5kcm0sICZjb25uX2l0ZXIp
OworCWRybV9mb3JfZWFjaF9jb25uZWN0b3JfaXRlcihjb25uZWN0b3IsICZjb25uX2l0ZXIpIHsK
KwkJc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGU7CisJCXN0cnVjdCBkcm1f
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKKworCQlpZiAoIWNvbm5lY3Rvci0+aGFzX3RpbGUgfHwK
KwkJICAgIGNvbm5lY3Rvci0+dGlsZV9ncm91cC0+aWQgIT0gdGlsZV9ncnBfaWQpCisJCQljb250
aW51ZTsKKwkJY29ubl9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X2Nvbm5lY3Rvcl9zdGF0ZSgmc3Rh
dGUtPmJhc2UsCisJCQkJCQkJICAgIGNvbm5lY3Rvcik7CisJCWlmIChJU19FUlIoY29ubl9zdGF0
ZSkpIHsKKwkJCXJldCA9ICBQVFJfRVJSKGNvbm5fc3RhdGUpOworCQkJYnJlYWs7CisJCX0KKwor
CQlpZiAoIWNvbm5fc3RhdGUtPmNydGMpCisJCQljb250aW51ZTsKKworCQljcnRjX3N0YXRlID0g
ZHJtX2F0b21pY19nZXRfY3J0Y19zdGF0ZSgmc3RhdGUtPmJhc2UsCisJCQkJCQkgICAgICAgY29u
bl9zdGF0ZS0+Y3J0Yyk7CisJCWlmIChJU19FUlIoY3J0Y19zdGF0ZSkpIHsKKwkJCXJldCA9IFBU
Ul9FUlIoY29ubl9zdGF0ZSk7CisJCQlicmVhazsKKwkJfQorCQljcnRjX3N0YXRlLT5tb2RlX2No
YW5nZWQgPSB0cnVlOworCQlyZXQgPSBkcm1fYXRvbWljX2FkZF9hZmZlY3RlZF9jb25uZWN0b3Jz
KCZzdGF0ZS0+YmFzZSwKKwkJCQkJCQkgY29ubl9zdGF0ZS0+Y3J0Yyk7CisJCWlmIChyZXQpCisJ
CQlicmVhazsKKwl9CisJZHJtX2Nvbm5lY3Rvcl9saXN0X2l0ZXJfZW5kKCZjb25uX2l0ZXIpOwor
CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludAoraW50ZWxfYXRvbWljX2NoZWNrX3RpbGVk
X2Nvbm5zKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQoreworCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKKwlzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yOworCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRl
ICpvbGRfY29ubl9zdGF0ZSwgKm5ld19jb25uX3N0YXRlOworCWludCBpLCByZXQ7CisKKwlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA8IDExKQorCQlyZXR1cm4gMDsKKworCS8qIElzIHRpbGVkLCBt
YXJrIGFsbCBvdGhlciB0aWxlZCBDUlRDcyBhcyBuZWVkaW5nIGEgbW9kZXNldCAqLworCWZvcl9l
YWNoX29sZG5ld19jb25uZWN0b3JfaW5fc3RhdGUoJnN0YXRlLT5iYXNlLCBjb25uZWN0b3IsCisJ
CQkJCSAgIG9sZF9jb25uX3N0YXRlLCBuZXdfY29ubl9zdGF0ZSwgaSkgeworCQlpZiAoIWNvbm5l
Y3Rvci0+aGFzX3RpbGUpCisJCQljb250aW51ZTsKKwkJaWYgKCFpbnRlbF9jb25uZWN0b3JfbmVl
ZHNfbW9kZXNldChzdGF0ZSwgY29ubmVjdG9yKSkKKwkJCWNvbnRpbnVlOworCisJCXJldCA9IGlu
dGVsX21vZGVzZXRfYWxsX3RpbGVzKHN0YXRlLCBjb25uZWN0b3ItPnRpbGVfZ3JvdXAtPmlkKTsK
KwkJaWYgKHJldCkKKwkJCXJldHVybiByZXQ7CisJfQorCisJcmV0dXJuIDA7Cit9CisKIC8qKgog
ICogaW50ZWxfYXRvbWljX2NoZWNrIC0gdmFsaWRhdGUgc3RhdGUgb2JqZWN0CiAgKiBAZGV2OiBk
cm0gZGV2aWNlCkBAIC0xNDMzMSw2ICsxNDQ0MywyMSBAQCBzdGF0aWMgaW50IGludGVsX2F0b21p
Y19jaGVjayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCWlmIChyZXQpCiAJCWdvdG8gZmFpbDsK
IAorCS8qKgorCSAqIFRoaXMgY2hlY2sgYWRkcyBhbGwgdGhlIGNvbm5lY3RvcnMgaW4gY3VycmVu
dCBzdGF0ZSB0aGF0IGJlbG9uZyB0bworCSAqIHRoZSBzYW1lIHRpbGUgZ3JvdXAgdG8gYSBmdWxs
IG1vZGVzZXQuCisJICogVGhpcyBmdW5jdGlvbiBkaXJlY3RseSBzZXRzIHRoZSBtb2RlX2NoYW5n
ZWQgdG8gdHJ1ZSBhbmQgd2UgYWxzbyBjYWxsCisJICogZHJtX2F0b21pY19hZGRfYWZmZWN0ZWRf
Y29ubmVjdG9ycygpLiBIZW5jZSB3ZSBhcmUgbm90IGV4cGxpY2l0bHkKKwkgKiBjYWxsaW5nIGRy
bV9hdG9taWNfaGVscGVyX2NoZWNrX21vZGVzZXQoKSBhZnRlciB0aGlzLgorCSAqCisJICogRml4
bWU6IEhhbmRsZSBzb21lIGNvcm5lciBjYXNlcyB3aGVyZSBvbmUgb2YgdGhlCisJICogdGlsZWQg
Y29ubmVjdG9ycyBnZXRzIGRpc2Nvbm5lY3RlZCBhbmQgdGlsZSBpbmZvIGlzIGxvc3QgYnV0IHNp
bmNlIGl0CisJICogd2FzIHByZXZpb3VzbHkgc3luY2VkIHRvIG90aGVyIGNvbm4sIHdlIG5lZWQg
dG8gYWRkIHRoYXQgdG8gdGhlIG1vZGVzZXQuCisJICovCisJcmV0ID0gaW50ZWxfYXRvbWljX2No
ZWNrX3RpbGVkX2Nvbm5zKHN0YXRlKTsKKwlpZiAocmV0KQorCQlnb3RvIGZhaWw7CisKIAlmb3Jf
ZWFjaF9vbGRuZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0Yywgb2xkX2NydGNfc3Rh
dGUsCiAJCQkJCSAgICBuZXdfY3J0Y19zdGF0ZSwgaSkgewogCQlpZiAoIW5lZWRzX21vZGVzZXQo
bmV3X2NydGNfc3RhdGUpKSB7CkBAIC0xNDM3OCw2ICsxNDUwNSwxNyBAQCBzdGF0aWMgaW50IGlu
dGVsX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQl9CiAJfQogCisJLyoq
CisJICogSW4gY2FzZSBvZiBwb3J0IHN5bmNlZCBjcnRjcywgaWYgb25lIG9mIHRoZSBzeW5jZWQg
Y3J0Y3MKKwkgKiBuZWVkcyBhIGZ1bGwgbW9kZXNldCwgYWxsIG90aGVyIHN5bmNlZCBjcnRjcyBz
aG91bGQgYmUKKwkgKiBmb3JjZWQgYSBmdWxsIG1vZGVzZXQuIFRoaXMgY2hlY2tzIGlmIGZhc3Rz
ZXQgaXMgYWxsb3dlZAorCSAqIGJ5IG90aGVyIGRlcGVuZGVuY2llcyBsaWtlIHRoZSBzeW5jZWQg
Y3J0Y3MuCisJICogSGVyZSB3ZSBzZXQgdGhlIG1vZGVfY2hhbmdlZCB0byB0cnVlIGRpcmVjdGx5
IHRvIGZvcmNlIGZ1bGwKKwkgKiBtb2Rlc2V0IGhlbmNlIHdlIGRvIG5vdCBleHBsaWNpdGx5IGNh
bGwgdGhlIGZ1bmN0aW9uCisJICogZHJtX2F0b21pY19oZWxwZXJfY2hlY2tfbW9kZXNldCgpLgor
CSAqLworCWludGVsX2F0b21pY19jaGVja19zeW5jZWRfY3J0Y3Moc3RhdGUpOworCiAJZm9yX2Vh
Y2hfb2xkbmV3X2ludGVsX2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIG9sZF9jcnRjX3N0YXRl
LAogCQkJCQkgICAgbmV3X2NydGNfc3RhdGUsIGkpIHsKIAkJaWYgKG5lZWRzX21vZGVzZXQobmV3
X2NydGNfc3RhdGUpKSB7Ci0tIAoyLjE5LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2ludGVsLWdmeAo=

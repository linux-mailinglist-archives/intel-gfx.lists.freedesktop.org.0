Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 64C1A4CBEF
	for <lists+intel-gfx@lfdr.de>; Thu, 20 Jun 2019 12:33:41 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 38D936E3C6;
	Thu, 20 Jun 2019 10:33:39 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga14.intel.com (mga14.intel.com [192.55.52.115])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6107D6E3C6
 for <intel-gfx@lists.freedesktop.org>; Thu, 20 Jun 2019 10:33:38 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga001.jf.intel.com ([10.7.209.18])
 by fmsmga103.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 20 Jun 2019 03:33:37 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,396,1557212400"; d="scan'208";a="243587144"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by orsmga001.jf.intel.com with SMTP; 20 Jun 2019 03:33:35 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Thu, 20 Jun 2019 13:33:34 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 20 Jun 2019 13:33:34 +0300
Message-Id: <20190620103334.15651-1-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190619170842.20579-4-ville.syrjala@linux.intel.com>
References: <20190619170842.20579-4-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2 3/4] drm/i915: Nuke drm_driver irq vfuncs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClN0
b3AgdXNpbmcgdGhlIGlycSB2ZnVuY3MgdW5kZXIgZHJtX2RyaXZlci4gVGhhdCdzIG5vdCBnb2lu
ZyB0byBmbHkKaW4gYSBtaXhlZCBnZW4gZW52aXJvbm1lbnQgc2luY2UgdGhlIHN0cnVjdHVyZSBp
cyBzaGFyZWQgYmV0d2VlbiBhbGwKdGhlIGRldmljZXMuCgp2MjogQWxsb3cgaW50ZWxfaXJxX3Vu
aW5zdGFsbCgpIHRvIGJlIGNhbGxlZCB0d2ljZSBkdWUgdG8KICAgIGludGVsX21vZGVzZXRfY2xl
YW51cCgpIGNhbGxpbmcgaXQgYXMgd2VsbC4gVG9zcyBpbiBhCiAgICBGSVhNRSB0byByZW1pbmQg
dXMgdGhhdCB0aGlzIGlzIG5vdCBncmVhdC4KClNpZ25lZC1vZmYtYnk6IFZpbGxlIFN5cmrDpGzD
pCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+ClJldmlld2VkLWJ5OiBDaHJpcyBXaWxz
b24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4gI3YxCi0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kcnYuYyB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYyB8
IDI4OSArKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLQogMiBmaWxlcyBjaGFuZ2VkLCAx
NDkgaW5zZXJ0aW9ucygrKSwgMTQyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5j
CmluZGV4IGY2MmUzMzk3ZDkzNi4uZWE2YjA2MTA5ZDVhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2
LmMKQEAgLTc1NCw3ICs3NTQsNyBAQCBzdGF0aWMgaW50IGk5MTVfbG9hZF9tb2Rlc2V0X2luaXQo
c3RydWN0IGRybV9kZXZpY2UgKmRldikKIGNsZWFudXBfbW9kZXNldDoKIAlpbnRlbF9tb2Rlc2V0
X2NsZWFudXAoZGV2KTsKIGNsZWFudXBfaXJxOgotCWRybV9pcnFfdW5pbnN0YWxsKGRldik7CisJ
aW50ZWxfaXJxX3VuaW5zdGFsbChkZXZfcHJpdik7CiAJaW50ZWxfZ21idXNfdGVhcmRvd24oZGV2
X3ByaXYpOwogY2xlYW51cF9jc3I6CiAJaW50ZWxfY3NyX3Vjb2RlX2ZpbmkoZGV2X3ByaXYpOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfaXJxLmMKaW5kZXggNGZiZThkOTA5NTBhLi5jNzZjNDk4NzY5ZDggMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9pcnEuYwpAQCAtMjE4Nyw4ICsyMTg3LDcgQEAgc3RhdGljIHZvaWQg
aTl4eF9ocGRfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAog
CiBzdGF0aWMgaXJxcmV0dXJuX3QgdmFsbGV5dmlld19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lk
ICphcmcpCiB7Ci0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGFyZzsKLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7CisJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gYXJnOwogCWlycXJldHVybl90IHJldCA9IElSUV9OT05FOwogCiAJ
aWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpKQpAQCAtMjI3Myw4ICsyMjcyLDcgQEAg
c3RhdGljIGlycXJldHVybl90IHZhbGxleXZpZXdfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAq
YXJnKQogCiBzdGF0aWMgaXJxcmV0dXJuX3QgY2hlcnJ5dmlld19pcnFfaGFuZGxlcihpbnQgaXJx
LCB2b2lkICphcmcpCiB7Ci0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGFyZzsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7CisJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2ID0gYXJnOwogCWlycXJldHVybl90IHJldCA9IElSUV9OT05F
OwogCiAJaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpKQpAQCAtMjY5Myw4ICsyNjkx
LDcgQEAgc3RhdGljIHZvaWQgaXZiX2Rpc3BsYXlfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAogICovCiBzdGF0aWMgaXJxcmV0dXJuX3QgaXJvbmxha2VfaXJx
X2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQogewotCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYg
PSBhcmc7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
OworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGFyZzsKIAl1MzIgZGVfaWly
LCBndF9paXIsIGRlX2llciwgc2RlX2llciA9IDA7CiAJaXJxcmV0dXJuX3QgcmV0ID0gSVJRX05P
TkU7CiAKQEAgLTMwMDQsNyArMzAwMSw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBnZW44X21hc3Rl
cl9pbnRyX2VuYWJsZSh2b2lkIF9faW9tZW0gKiBjb25zdCByZWdzKQogCiBzdGF0aWMgaXJxcmV0
dXJuX3QgZ2VuOF9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCiB7Ci0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShhcmcpOworCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGFyZzsKIAl2b2lkIF9faW9tZW0gKiBjb25zdCByZWdzID0g
ZGV2X3ByaXYtPnVuY29yZS5yZWdzOwogCXUzMiBtYXN0ZXJfY3RsOwogCXUzMiBndF9paXJbNF07
CkBAIC0zMjAzLDcgKzMyMDAsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgZ2VuMTFfbWFzdGVyX2lu
dHJfZW5hYmxlKHZvaWQgX19pb21lbSAqIGNvbnN0IHJlZ3MpCiAKIHN0YXRpYyBpcnFyZXR1cm5f
dCBnZW4xMV9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCiB7Ci0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKiBjb25zdCBpOTE1ID0gdG9faTkxNShhcmcpOworCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICogY29uc3QgaTkxNSA9IGFyZzsKIAl2b2lkIF9faW9tZW0gKiBjb25zdCByZWdz
ID0gaTkxNS0+dW5jb3JlLnJlZ3M7CiAJdTMyIG1hc3Rlcl9jdGw7CiAJdTMyIGd1X21pc2NfaWly
OwpAQCAtMzQ1NywxMCArMzQ1NCw4IEBAIHN0YXRpYyB2b2lkIGlieF9pcnFfcmVzZXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogICoKICAqIFRoaXMgZnVuY3Rpb24gbmVlZHMg
dG8gYmUgY2FsbGVkIGJlZm9yZSBpbnRlcnJ1cHRzIGFyZSBlbmFibGVkLgogICovCi1zdGF0aWMg
dm9pZCBpYnhfaXJxX3ByZV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQorc3Rh
dGljIHZvaWQgaWJ4X2lycV9wcmVfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5
MTUoZGV2KTsKLQogCWlmIChIQVNfUENIX05PUChkZXZfcHJpdikpCiAJCXJldHVybjsKIApAQCAt
MzUyOSw5ICszNTI0LDggQEAgc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfaXJxX3Bvc3RpbnN0YWxs
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogLyogZHJtX2RtYS5oIGhvb2tz
CiAqLwotc3RhdGljIHZvaWQgaXJvbmxha2VfaXJxX3Jlc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpk
ZXYpCitzdGF0aWMgdm9pZCBpcm9ubGFrZV9pcnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZGV2KTsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVu
Y29yZTsKIAogCUdFTjNfSVJRX1JFU0VUKHVuY29yZSwgREUpOwpAQCAtMzU0OCwxMCArMzU0Miw4
IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2lycV9yZXNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
KQogCWlieF9pcnFfcmVzZXQoZGV2X3ByaXYpOwogfQogCi1zdGF0aWMgdm9pZCB2YWxsZXl2aWV3
X2lycV9yZXNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQorc3RhdGljIHZvaWQgdmFsbGV5dmll
d19pcnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKLQogCUk5MTVfV1JJ
VEUoVkxWX01BU1RFUl9JRVIsIDApOwogCVBPU1RJTkdfUkVBRChWTFZfTUFTVEVSX0lFUik7CiAK
QEAgLTM1NzMsOSArMzU2NSw4IEBAIHN0YXRpYyB2b2lkIGdlbjhfZ3RfaXJxX3Jlc2V0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlHRU44X0lSUV9SRVNFVF9ORFgodW5jb3Jl
LCBHVCwgMyk7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbjhfaXJxX3Jlc2V0KHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYpCitzdGF0aWMgdm9pZCBnZW44X2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwogCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+
dW5jb3JlOwogCWludCBwaXBlOwogCkBAIC0zNjE4LDkgKzM2MDksOCBAQCBzdGF0aWMgdm9pZCBn
ZW4xMV9ndF9pcnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCUk5
MTVfV1JJVEUoR0VOMTFfR1VDX1NHX0lOVFJfTUFTSywgIH4wKTsKIH0KIAotc3RhdGljIHZvaWQg
Z2VuMTFfaXJxX3Jlc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCitzdGF0aWMgdm9pZCBnZW4x
MV9pcnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGRldi0+ZGV2X3ByaXZhdGU7CiAJc3RydWN0
IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7CiAJaW50IHBpcGU7CiAK
QEAgLTM2OTMsOSArMzY4Myw4IEBAIHZvaWQgZ2VuOF9pcnFfcG93ZXJfd2VsbF9wcmVfZGlzYWJs
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJc3luY2hyb25pemVfaXJxKGRl
dl9wcml2LT5kcm0uaXJxKTsKIH0KIAotc3RhdGljIHZvaWQgY2hlcnJ5dmlld19pcnFfcmVzZXQo
c3RydWN0IGRybV9kZXZpY2UgKmRldikKK3N0YXRpYyB2b2lkIGNoZXJyeXZpZXdfaXJxX3Jlc2V0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7CiAJc3RydWN0IGludGVsX3VuY29yZSAq
dW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7CiAKIAlJOTE1X1dSSVRFKEdFTjhfTUFTVEVSX0lS
USwgMCk7CkBAIC0zOTYwLDkgKzM5NDksOCBAQCBzdGF0aWMgdm9pZCBieHRfaHBkX2lycV9zZXR1
cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJX19ieHRfaHBkX2RldGVjdGlv
bl9zZXR1cChkZXZfcHJpdiwgZW5hYmxlZF9pcnFzKTsKIH0KIAotc3RhdGljIHZvaWQgaWJ4X2ly
cV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQorc3RhdGljIHZvaWQgaWJ4X2ly
cV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwogCXUzMiBtYXNr
OwogCiAJaWYgKEhBU19QQ0hfTk9QKGRldl9wcml2KSkKQEAgLTM5ODUsOSArMzk3Myw4IEBAIHN0
YXRpYyB2b2lkIGlieF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAkJ
c3B0X2hwZF9kZXRlY3Rpb25fc2V0dXAoZGV2X3ByaXYpOwogfQogCi1zdGF0aWMgdm9pZCBnZW41
X2d0X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQorc3RhdGljIHZvaWQg
Z2VuNV9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsK
IAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKIAl1MzIg
cG1faXJxcywgZ3RfaXJxczsKIApAQCAtNDAyNCw5ICs0MDExLDggQEAgc3RhdGljIHZvaWQgZ2Vu
NV9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAl9CiB9CiAKLXN0
YXRpYyBpbnQgaXJvbmxha2VfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYp
CitzdGF0aWMgdm9pZCBpcm9ubGFrZV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZGV2KTsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYt
PnVuY29yZTsKIAl1MzIgZGlzcGxheV9tYXNrLCBleHRyYV9tYXNrOwogCkBAIC00MDUzLDE2ICs0
MDM5LDE2IEBAIHN0YXRpYyBpbnQgaXJvbmxha2VfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYpCiAKIAlkZXZfcHJpdi0+aXJxX21hc2sgPSB+ZGlzcGxheV9tYXNrOwogCi0J
aWJ4X2lycV9wcmVfcG9zdGluc3RhbGwoZGV2KTsKKwlpYnhfaXJxX3ByZV9wb3N0aW5zdGFsbChk
ZXZfcHJpdik7CiAKIAlHRU4zX0lSUV9JTklUKHVuY29yZSwgREUsIGRldl9wcml2LT5pcnFfbWFz
aywKIAkJICAgICAgZGlzcGxheV9tYXNrIHwgZXh0cmFfbWFzayk7CiAKLQlnZW41X2d0X2lycV9w
b3N0aW5zdGFsbChkZXYpOworCWdlbjVfZ3RfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKIAog
CWlsa19ocGRfZGV0ZWN0aW9uX3NldHVwKGRldl9wcml2KTsKIAotCWlieF9pcnFfcG9zdGluc3Rh
bGwoZGV2KTsKKwlpYnhfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKIAogCWlmIChJU19JUk9O
TEFLRV9NKGRldl9wcml2KSkgewogCQkvKiBFbmFibGUgUENVIGV2ZW50IGludGVycnVwdHMKQEAg
LTQwNzQsOCArNDA2MCw2IEBAIHN0YXRpYyBpbnQgaXJvbmxha2VfaXJxX3Bvc3RpbnN0YWxsKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAJCWlsa19lbmFibGVfZGlzcGxheV9pcnEoZGV2X3ByaXYs
IERFX1BDVV9FVkVOVCk7CiAJCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsK
IAl9Ci0KLQlyZXR1cm4gMDsKIH0KIAogdm9pZCB2YWxsZXl2aWV3X2VuYWJsZV9kaXNwbGF5X2ly
cXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQpAQCAtNDEwNywxMSArNDA5MSw5
IEBAIHZvaWQgdmFsbGV5dmlld19kaXNhYmxlX2Rpc3BsYXlfaXJxcyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCiB9CiAKIAotc3RhdGljIGludCB2YWxsZXl2aWV3X2lycV9wb3N0
aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQorc3RhdGljIHZvaWQgdmFsbGV5dmlld19p
cnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKLQotCWdlbjVf
Z3RfaXJxX3Bvc3RpbnN0YWxsKGRldik7CisJZ2VuNV9ndF9pcnFfcG9zdGluc3RhbGwoZGV2X3By
aXYpOwogCiAJc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKIAlpZiAoZGV2X3By
aXYtPmRpc3BsYXlfaXJxc19lbmFibGVkKQpAQCAtNDEyMCw4ICs0MTAyLDYgQEAgc3RhdGljIGlu
dCB2YWxsZXl2aWV3X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogCiAJ
STkxNV9XUklURShWTFZfTUFTVEVSX0lFUiwgTUFTVEVSX0lOVEVSUlVQVF9FTkFCTEUpOwogCVBP
U1RJTkdfUkVBRChWTFZfTUFTVEVSX0lFUik7Ci0KLQlyZXR1cm4gMDsKIH0KIAogc3RhdGljIHZv
aWQgZ2VuOF9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQpAQCAtNDIyOCwyMiArNDIwOCwxOCBAQCBzdGF0aWMgdm9pZCBnZW44X2RlX2lycV9wb3N0
aW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJfQogfQogCi1zdGF0
aWMgaW50IGdlbjhfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCitzdGF0
aWMgdm9pZCBnZW44X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShk
ZXYpOwotCiAJaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKQotCQlpYnhfaXJxX3ByZV9wb3N0
aW5zdGFsbChkZXYpOworCQlpYnhfaXJxX3ByZV9wb3N0aW5zdGFsbChkZXZfcHJpdik7CiAKIAln
ZW44X2d0X2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7CiAJZ2VuOF9kZV9pcnFfcG9zdGluc3Rh
bGwoZGV2X3ByaXYpOwogCiAJaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKQotCQlpYnhfaXJx
X3Bvc3RpbnN0YWxsKGRldik7CisJCWlieF9pcnFfcG9zdGluc3RhbGwoZGV2X3ByaXYpOwogCiAJ
Z2VuOF9tYXN0ZXJfaW50cl9lbmFibGUoZGV2X3ByaXYtPnVuY29yZS5yZWdzKTsKLQotCXJldHVy
biAwOwogfQogCiBzdGF0aWMgdm9pZCBnZW4xMV9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQpAQCAtNDI3Nyw5ICs0MjUzLDggQEAgc3RhdGljIHZv
aWQgZ2VuMTFfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKIAlJOTE1X1dSSVRFKEdFTjExX0dVQ19TR19JTlRSX01BU0ssICB+MCk7CiB9CiAKLXN0
YXRpYyB2b2lkIGljcF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikKK3N0
YXRpYyB2b2lkIGljcF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZGV2KTsKIAl1MzIgbWFzayA9IFNERV9HTUJVU19JQ1A7CiAKIAlXQVJOX09OKEk5MTVfUkVBRChT
REVJRVIpICE9IDApOwpAQCAtNDI5MiwxNCArNDI2NywxMyBAQCBzdGF0aWMgdm9pZCBpY3BfaXJx
X3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAJaWNwX2hwZF9kZXRlY3Rpb25f
c2V0dXAoZGV2X3ByaXYpOwogfQogCi1zdGF0aWMgaW50IGdlbjExX2lycV9wb3N0aW5zdGFsbChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2KQorc3RhdGljIHZvaWQgZ2VuMTFfaXJxX3Bvc3RpbnN0YWxs
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBkZXYtPmRldl9wcml2YXRlOwogCXN0cnVjdCBpbnRlbF91bmNv
cmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwogCXUzMiBndV9taXNjX21hc2tlZCA9IEdF
TjExX0dVX01JU0NfR1NFOwogCiAJaWYgKElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA+PSBQQ0hf
SUNQKQotCQlpY3BfaXJxX3Bvc3RpbnN0YWxsKGRldik7CisJCWljcF9pcnFfcG9zdGluc3RhbGwo
ZGV2X3ByaXYpOwogCiAJZ2VuMTFfZ3RfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKIAlnZW44
X2RlX2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7CkBAIC00MzEwLDE0ICs0Mjg0LDEwIEBAIHN0
YXRpYyBpbnQgZ2VuMTFfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAK
IAlnZW4xMV9tYXN0ZXJfaW50cl9lbmFibGUoZGV2X3ByaXYtPnVuY29yZS5yZWdzKTsKIAlQT1NU
SU5HX1JFQUQoR0VOMTFfR0ZYX01TVFJfSVJRKTsKLQotCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IGNoZXJyeXZpZXdfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCitz
dGF0aWMgdm9pZCBjaGVycnl2aWV3X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShkZXYpOwotCiAJZ2VuOF9ndF9pcnFfcG9zdGluc3RhbGwoZGV2X3ByaXYpOwogCiAJ
c3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKQEAgLTQzMjcsMTMgKzQyOTcsMTAg
QEAgc3RhdGljIGludCBjaGVycnl2aWV3X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2KQogCiAJSTkxNV9XUklURShHRU44X01BU1RFUl9JUlEsIEdFTjhfTUFTVEVSX0lSUV9D
T05UUk9MKTsKIAlQT1NUSU5HX1JFQUQoR0VOOF9NQVNURVJfSVJRKTsKLQotCXJldHVybiAwOwog
fQogCi1zdGF0aWMgdm9pZCBpOHh4X2lycV9yZXNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQor
c3RhdGljIHZvaWQgaTh4eF9pcnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2
KTsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKIAog
CWk5eHhfcGlwZXN0YXRfaXJxX3Jlc2V0KGRldl9wcml2KTsKQEAgLTQzNDEsOSArNDMwOCw4IEBA
IHN0YXRpYyB2b2lkIGk4eHhfaXJxX3Jlc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAJR0VO
Ml9JUlFfUkVTRVQodW5jb3JlKTsKIH0KIAotc3RhdGljIGludCBpOHh4X2lycV9wb3N0aW5zdGFs
bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQorc3RhdGljIHZvaWQgaTh4eF9pcnFfcG9zdGluc3Rh
bGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3Jl
ICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKIAl1MTYgZW5hYmxlX21hc2s7CiAKQEAgLTQz
NzIsOCArNDMzOCw2IEBAIHN0YXRpYyBpbnQgaTh4eF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRy
bV9kZXZpY2UgKmRldikKIAlpOTE1X2VuYWJsZV9waXBlc3RhdChkZXZfcHJpdiwgUElQRV9BLCBQ
SVBFX0NSQ19ET05FX0lOVEVSUlVQVF9TVEFUVVMpOwogCWk5MTVfZW5hYmxlX3BpcGVzdGF0KGRl
dl9wcml2LCBQSVBFX0IsIFBJUEVfQ1JDX0RPTkVfSU5URVJSVVBUX1NUQVRVUyk7CiAJc3Bpbl91
bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwotCi0JcmV0dXJuIDA7CiB9CiAKIHN0YXRp
YyB2b2lkIGk4eHhfZXJyb3JfaXJxX2FjayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
QEAgLTQ0NTQsOCArNDQxOCw3IEBAIHN0YXRpYyB2b2lkIGk5eHhfZXJyb3JfaXJxX2hhbmRsZXIo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCiBzdGF0aWMgaXJxcmV0dXJuX3Qg
aTh4eF9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCiB7Ci0Jc3RydWN0IGRybV9kZXZp
Y2UgKmRldiA9IGFyZzsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gYXJnOwogCWly
cXJldHVybl90IHJldCA9IElSUV9OT05FOwogCiAJaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQoZGV2
X3ByaXYpKQpAQCAtNDQ5OCw5ICs0NDYxLDggQEAgc3RhdGljIGlycXJldHVybl90IGk4eHhfaXJx
X2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyB2
b2lkIGk5MTVfaXJxX3Jlc2V0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCitzdGF0aWMgdm9pZCBp
OTE1X2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwogCXN0cnVjdCBp
bnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwogCiAJaWYgKEk5MTVfSEFT
X0hPVFBMVUcoZGV2X3ByaXYpKSB7CkBAIC00NTEzLDkgKzQ0NzUsOCBAQCBzdGF0aWMgdm9pZCBp
OTE1X2lycV9yZXNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogCUdFTjNfSVJRX1JFU0VUKHVu
Y29yZSwgR0VOMl8pOwogfQogCi1zdGF0aWMgaW50IGk5MTVfaXJxX3Bvc3RpbnN0YWxsKHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYpCitzdGF0aWMgdm9pZCBpOTE1X2lycV9wb3N0aW5zdGFsbChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOwogCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29y
ZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwogCXUzMiBlbmFibGVfbWFzazsKIApAQCAtNDU1MywxNCAr
NDUxNCwxMSBAQCBzdGF0aWMgaW50IGk5MTVfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYpCiAJc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwogCiAJaTkx
NV9lbmFibGVfYXNsZV9waXBlc3RhdChkZXZfcHJpdik7Ci0KLQlyZXR1cm4gMDsKIH0KIAogc3Rh
dGljIGlycXJldHVybl90IGk5MTVfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQogewot
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBhcmc7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0gdG9faTkxNShkZXYpOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IGFyZzsKIAlpcnFyZXR1cm5fdCByZXQgPSBJUlFfTk9ORTsKIAogCWlmICghaW50ZWxf
aXJxc19lbmFibGVkKGRldl9wcml2KSkKQEAgLTQ2MTEsOSArNDU2OSw4IEBAIHN0YXRpYyBpcnFy
ZXR1cm5fdCBpOTE1X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykKIAlyZXR1cm4gcmV0
OwogfQogCi1zdGF0aWMgdm9pZCBpOTY1X2lycV9yZXNldChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
KQorc3RhdGljIHZvaWQgaTk2NV9pcnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUo
ZGV2KTsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsK
IAogCWk5MTVfaG90cGx1Z19pbnRlcnJ1cHRfdXBkYXRlKGRldl9wcml2LCAweGZmZmZmZmZmLCAw
KTsKQEAgLTQ2MjQsOSArNDU4MSw4IEBAIHN0YXRpYyB2b2lkIGk5NjVfaXJxX3Jlc2V0KHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYpCiAJR0VOM19JUlFfUkVTRVQodW5jb3JlLCBHRU4yXyk7CiB9CiAK
LXN0YXRpYyBpbnQgaTk2NV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9kZXZpY2UgKmRldikK
K3N0YXRpYyB2b2lkIGk5NjVfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGRldik7CiAJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNv
cmU7CiAJdTMyIGVuYWJsZV9tYXNrOwogCXUzMiBlcnJvcl9tYXNrOwpAQCAtNDY3Niw4ICs0NjMy
LDYgQEAgc3RhdGljIGludCBpOTY1X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2KQogCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKIAogCWk5MTVfZW5h
YmxlX2FzbGVfcGlwZXN0YXQoZGV2X3ByaXYpOwotCi0JcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyB2
b2lkIGk5MTVfaHBkX2lycV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
CkBAIC00NzA3LDggKzQ2NjEsNyBAQCBzdGF0aWMgdm9pZCBpOTE1X2hwZF9pcnFfc2V0dXAoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCiBzdGF0aWMgaXJxcmV0dXJuX3QgaTk2
NV9pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCiB7Ci0Jc3RydWN0IGRybV9kZXZpY2Ug
KmRldiA9IGFyZzsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGRldik7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gYXJnOwogCWlycXJl
dHVybl90IHJldCA9IElSUV9OT05FOwogCiAJaWYgKCFpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3By
aXYpKQpAQCAtNDgzOSw2NSArNDc5MiwxOCBAQCB2b2lkIGludGVsX2lycV9pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlkZXYtPmRyaXZlci0+Z2V0X3ZibGFua190aW1l
c3RhbXAgPSBkcm1fY2FsY192Ymx0aW1lc3RhbXBfZnJvbV9zY2Fub3V0cG9zOwogCWRldi0+ZHJp
dmVyLT5nZXRfc2Nhbm91dF9wb3NpdGlvbiA9IGk5MTVfZ2V0X2NydGNfc2Nhbm91dHBvczsKIAot
CWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewotCQlkZXYtPmRyaXZlci0+aXJxX2hhbmRs
ZXIgPSBjaGVycnl2aWV3X2lycV9oYW5kbGVyOwotCQlkZXYtPmRyaXZlci0+aXJxX3ByZWluc3Rh
bGwgPSBjaGVycnl2aWV3X2lycV9yZXNldDsKLQkJZGV2LT5kcml2ZXItPmlycV9wb3N0aW5zdGFs
bCA9IGNoZXJyeXZpZXdfaXJxX3Bvc3RpbnN0YWxsOwotCQlkZXYtPmRyaXZlci0+aXJxX3VuaW5z
dGFsbCA9IGNoZXJyeXZpZXdfaXJxX3Jlc2V0OwotCQlkZXZfcHJpdi0+ZGlzcGxheS5ocGRfaXJx
X3NldHVwID0gaTkxNV9ocGRfaXJxX3NldHVwOwotCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhk
ZXZfcHJpdikpIHsKLQkJZGV2LT5kcml2ZXItPmlycV9oYW5kbGVyID0gdmFsbGV5dmlld19pcnFf
aGFuZGxlcjsKLQkJZGV2LT5kcml2ZXItPmlycV9wcmVpbnN0YWxsID0gdmFsbGV5dmlld19pcnFf
cmVzZXQ7Ci0JCWRldi0+ZHJpdmVyLT5pcnFfcG9zdGluc3RhbGwgPSB2YWxsZXl2aWV3X2lycV9w
b3N0aW5zdGFsbDsKLQkJZGV2LT5kcml2ZXItPmlycV91bmluc3RhbGwgPSB2YWxsZXl2aWV3X2ly
cV9yZXNldDsKLQkJZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGk5MTVfaHBkX2ly
cV9zZXR1cDsKLQl9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKLQkJZGV2
LT5kcml2ZXItPmlycV9oYW5kbGVyID0gZ2VuMTFfaXJxX2hhbmRsZXI7Ci0JCWRldi0+ZHJpdmVy
LT5pcnFfcHJlaW5zdGFsbCA9IGdlbjExX2lycV9yZXNldDsKLQkJZGV2LT5kcml2ZXItPmlycV9w
b3N0aW5zdGFsbCA9IGdlbjExX2lycV9wb3N0aW5zdGFsbDsKLQkJZGV2LT5kcml2ZXItPmlycV91
bmluc3RhbGwgPSBnZW4xMV9pcnFfcmVzZXQ7Ci0JCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFf
c2V0dXAgPSBnZW4xMV9ocGRfaXJxX3NldHVwOwotCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA+PSA4KSB7Ci0JCWRldi0+ZHJpdmVyLT5pcnFfaGFuZGxlciA9IGdlbjhfaXJxX2hhbmRs
ZXI7Ci0JCWRldi0+ZHJpdmVyLT5pcnFfcHJlaW5zdGFsbCA9IGdlbjhfaXJxX3Jlc2V0OwotCQlk
ZXYtPmRyaXZlci0+aXJxX3Bvc3RpbnN0YWxsID0gZ2VuOF9pcnFfcG9zdGluc3RhbGw7Ci0JCWRl
di0+ZHJpdmVyLT5pcnFfdW5pbnN0YWxsID0gZ2VuOF9pcnFfcmVzZXQ7Ci0JCWlmIChJU19HRU45
X0xQKGRldl9wcml2KSkKKwlpZiAoSEFTX0dNQ0goZGV2X3ByaXYpKSB7CisJCWlmIChJOTE1X0hB
U19IT1RQTFVHKGRldl9wcml2KSkKKwkJCWRldl9wcml2LT5kaXNwbGF5LmhwZF9pcnFfc2V0dXAg
PSBpOTE1X2hwZF9pcnFfc2V0dXA7CisJfSBlbHNlIHsKKwkJaWYgKElOVEVMX0dFTihkZXZfcHJp
dikgPj0gMTEpCisJCQlkZXZfcHJpdi0+ZGlzcGxheS5ocGRfaXJxX3NldHVwID0gZ2VuMTFfaHBk
X2lycV9zZXR1cDsKKwkJZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCiAJCQlkZXZfcHJp
di0+ZGlzcGxheS5ocGRfaXJxX3NldHVwID0gYnh0X2hwZF9pcnFfc2V0dXA7CiAJCWVsc2UgaWYg
KElOVEVMX1BDSF9UWVBFKGRldl9wcml2KSA+PSBQQ0hfU1BUKQogCQkJZGV2X3ByaXYtPmRpc3Bs
YXkuaHBkX2lycV9zZXR1cCA9IHNwdF9ocGRfaXJxX3NldHVwOwogCQllbHNlCiAJCQlkZXZfcHJp
di0+ZGlzcGxheS5ocGRfaXJxX3NldHVwID0gaWxrX2hwZF9pcnFfc2V0dXA7Ci0JfSBlbHNlIGlm
IChIQVNfUENIX1NQTElUKGRldl9wcml2KSkgewotCQlkZXYtPmRyaXZlci0+aXJxX2hhbmRsZXIg
PSBpcm9ubGFrZV9pcnFfaGFuZGxlcjsKLQkJZGV2LT5kcml2ZXItPmlycV9wcmVpbnN0YWxsID0g
aXJvbmxha2VfaXJxX3Jlc2V0OwotCQlkZXYtPmRyaXZlci0+aXJxX3Bvc3RpbnN0YWxsID0gaXJv
bmxha2VfaXJxX3Bvc3RpbnN0YWxsOwotCQlkZXYtPmRyaXZlci0+aXJxX3VuaW5zdGFsbCA9IGly
b25sYWtlX2lycV9yZXNldDsKLQkJZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGls
a19ocGRfaXJxX3NldHVwOwotCX0gZWxzZSB7Ci0JCWlmIChJU19HRU4oZGV2X3ByaXYsIDIpKSB7
Ci0JCQlkZXYtPmRyaXZlci0+aXJxX3ByZWluc3RhbGwgPSBpOHh4X2lycV9yZXNldDsKLQkJCWRl
di0+ZHJpdmVyLT5pcnFfcG9zdGluc3RhbGwgPSBpOHh4X2lycV9wb3N0aW5zdGFsbDsKLQkJCWRl
di0+ZHJpdmVyLT5pcnFfaGFuZGxlciA9IGk4eHhfaXJxX2hhbmRsZXI7Ci0JCQlkZXYtPmRyaXZl
ci0+aXJxX3VuaW5zdGFsbCA9IGk4eHhfaXJxX3Jlc2V0OwotCQl9IGVsc2UgaWYgKElTX0k5NDVH
TShkZXZfcHJpdikpIHsKLQkJCWRldi0+ZHJpdmVyLT5pcnFfcHJlaW5zdGFsbCA9IGk5MTVfaXJx
X3Jlc2V0OwotCQkJZGV2LT5kcml2ZXItPmlycV9wb3N0aW5zdGFsbCA9IGk5MTVfaXJxX3Bvc3Rp
bnN0YWxsOwotCQkJZGV2LT5kcml2ZXItPmlycV91bmluc3RhbGwgPSBpOTE1X2lycV9yZXNldDsK
LQkJCWRldi0+ZHJpdmVyLT5pcnFfaGFuZGxlciA9IGk5MTVfaXJxX2hhbmRsZXI7Ci0JCX0gZWxz
ZSBpZiAoSVNfR0VOKGRldl9wcml2LCAzKSkgewotCQkJZGV2LT5kcml2ZXItPmlycV9wcmVpbnN0
YWxsID0gaTkxNV9pcnFfcmVzZXQ7Ci0JCQlkZXYtPmRyaXZlci0+aXJxX3Bvc3RpbnN0YWxsID0g
aTkxNV9pcnFfcG9zdGluc3RhbGw7Ci0JCQlkZXYtPmRyaXZlci0+aXJxX3VuaW5zdGFsbCA9IGk5
MTVfaXJxX3Jlc2V0OwotCQkJZGV2LT5kcml2ZXItPmlycV9oYW5kbGVyID0gaTkxNV9pcnFfaGFu
ZGxlcjsKLQkJfSBlbHNlIHsKLQkJCWRldi0+ZHJpdmVyLT5pcnFfcHJlaW5zdGFsbCA9IGk5NjVf
aXJxX3Jlc2V0OwotCQkJZGV2LT5kcml2ZXItPmlycV9wb3N0aW5zdGFsbCA9IGk5NjVfaXJxX3Bv
c3RpbnN0YWxsOwotCQkJZGV2LT5kcml2ZXItPmlycV91bmluc3RhbGwgPSBpOTY1X2lycV9yZXNl
dDsKLQkJCWRldi0+ZHJpdmVyLT5pcnFfaGFuZGxlciA9IGk5NjVfaXJxX2hhbmRsZXI7Ci0JCX0K
LQkJaWYgKEk5MTVfSEFTX0hPVFBMVUcoZGV2X3ByaXYpKQotCQkJZGV2X3ByaXYtPmRpc3BsYXku
aHBkX2lycV9zZXR1cCA9IGk5MTVfaHBkX2lycV9zZXR1cDsKIAl9CiB9CiAKQEAgLTQ5MTgsNiAr
NDgyNCw3NSBAQCB2b2lkIGludGVsX2lycV9maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQogCQlrZnJlZShpOTE1LT5sM19wYXJpdHkucmVtYXBfaW5mb1tpXSk7CiB9CiAKK3N0YXRp
YyBpcnFfaGFuZGxlcl90IGludGVsX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKK3sKKwlpZiAoSEFTX0dNQ0goZGV2X3ByaXYpKSB7CisJCWlmIChJU19DSEVS
UllWSUVXKGRldl9wcml2KSkKKwkJCXJldHVybiBjaGVycnl2aWV3X2lycV9oYW5kbGVyOworCQll
bHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKKwkJCXJldHVybiB2YWxsZXl2aWV3X2ly
cV9oYW5kbGVyOworCQllbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDQpKQorCQkJcmV0dXJuIGk5
NjVfaXJxX2hhbmRsZXI7CisJCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMykpCisJCQlyZXR1
cm4gaTkxNV9pcnFfaGFuZGxlcjsKKwkJZWxzZQorCQkJcmV0dXJuIGk4eHhfaXJxX2hhbmRsZXI7
CisJfSBlbHNlIHsKKwkJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCisJCQlyZXR1cm4g
Z2VuMTFfaXJxX2hhbmRsZXI7CisJCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkK
KwkJCXJldHVybiBnZW44X2lycV9oYW5kbGVyOworCQllbHNlCisJCQlyZXR1cm4gaXJvbmxha2Vf
aXJxX2hhbmRsZXI7CisJfQorfQorCitzdGF0aWMgdm9pZCBpbnRlbF9pcnFfcmVzZXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQoreworCWlmIChIQVNfR01DSChkZXZfcHJpdikp
IHsKKwkJaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQorCQkJY2hlcnJ5dmlld19pcnFfcmVz
ZXQoZGV2X3ByaXYpOworCQllbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKKwkJCXZh
bGxleXZpZXdfaXJxX3Jlc2V0KGRldl9wcml2KTsKKwkJZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2
LCA0KSkKKwkJCWk5NjVfaXJxX3Jlc2V0KGRldl9wcml2KTsKKwkJZWxzZSBpZiAoSVNfR0VOKGRl
dl9wcml2LCAzKSkKKwkJCWk5MTVfaXJxX3Jlc2V0KGRldl9wcml2KTsKKwkJZWxzZQorCQkJaTh4
eF9pcnFfcmVzZXQoZGV2X3ByaXYpOworCX0gZWxzZSB7CisJCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDExKQorCQkJZ2VuMTFfaXJxX3Jlc2V0KGRldl9wcml2KTsKKwkJZWxzZSBpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSA4KQorCQkJZ2VuOF9pcnFfcmVzZXQoZGV2X3ByaXYpOworCQll
bHNlCisJCQlpcm9ubGFrZV9pcnFfcmVzZXQoZGV2X3ByaXYpOworCX0KK30KKworc3RhdGljIHZv
aWQgaW50ZWxfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKK3sKKwlpZiAoSEFTX0dNQ0goZGV2X3ByaXYpKSB7CisJCWlmIChJU19DSEVSUllWSUVXKGRl
dl9wcml2KSkKKwkJCWNoZXJyeXZpZXdfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKKwkJZWxz
ZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCisJCQl2YWxsZXl2aWV3X2lycV9wb3N0aW5z
dGFsbChkZXZfcHJpdik7CisJCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgNCkpCisJCQlpOTY1
X2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7CisJCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwg
MykpCisJCQlpOTE1X2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7CisJCWVsc2UKKwkJCWk4eHhf
aXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKKwl9IGVsc2UgeworCQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSAxMSkKKwkJCWdlbjExX2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7CisJCWVs
c2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkKKwkJCWdlbjhfaXJxX3Bvc3RpbnN0YWxs
KGRldl9wcml2KTsKKwkJZWxzZQorCQkJaXJvbmxha2VfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2
KTsKKwl9Cit9CisKIC8qKgogICogaW50ZWxfaXJxX2luc3RhbGwgLSBlbmFibGVzIHRoZSBoYXJk
d2FyZSBpbnRlcnJ1cHQKICAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKQEAgLTQ5
MzEsNiArNDkwNiw5IEBAIHZvaWQgaW50ZWxfaXJxX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCiAgKi8KIGludCBpbnRlbF9pcnFfaW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCiB7CisJaW50IGlycSA9IGRldl9wcml2LT5kcm0ucGRldi0+aXJxOwor
CWludCByZXQ7CisKIAkvKgogCSAqIFdlIGVuYWJsZSBzb21lIGludGVycnVwdCBzb3VyY2VzIGlu
IG91ciBwb3N0aW5zdGFsbCBob29rcywgc28gbWFyawogCSAqIGludGVycnVwdHMgYXMgZW5hYmxl
ZCBfYmVmb3JlXyBhY3R1YWxseSBlbmFibGluZyB0aGVtIHRvIGF2b2lkCkBAIC00OTM4LDcgKzQ5
MTYsMjAgQEAgaW50IGludGVsX2lycV9pbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKIAkgKi8KIAlkZXZfcHJpdi0+cnVudGltZV9wbS5pcnFzX2VuYWJsZWQgPSB0cnVl
OwogCi0JcmV0dXJuIGRybV9pcnFfaW5zdGFsbCgmZGV2X3ByaXYtPmRybSwgZGV2X3ByaXYtPmRy
bS5wZGV2LT5pcnEpOworCWRldl9wcml2LT5kcm0uaXJxX2VuYWJsZWQgPSB0cnVlOworCisJaW50
ZWxfaXJxX3Jlc2V0KGRldl9wcml2KTsKKworCXJldCA9IHJlcXVlc3RfaXJxKGlycSwgaW50ZWxf
aXJxX2hhbmRsZXIoZGV2X3ByaXYpLAorCQkJICBJUlFGX1NIQVJFRCwgRFJJVkVSX05BTUUsIGRl
dl9wcml2KTsKKwlpZiAocmV0IDwgMCkgeworCQlkZXZfcHJpdi0+ZHJtLmlycV9lbmFibGVkID0g
ZmFsc2U7CisJCXJldHVybiByZXQ7CisJfQorCisJaW50ZWxfaXJxX3Bvc3RpbnN0YWxsKGRldl9w
cml2KTsKKworCXJldHVybiByZXQ7CiB9CiAKIC8qKgpAQCAtNDk1MCw3ICs0OTQxLDIzIEBAIGlu
dCBpbnRlbF9pcnFfaW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAg
Ki8KIHZvaWQgaW50ZWxfaXJxX3VuaW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCiB7Ci0JZHJtX2lycV91bmluc3RhbGwoJmRldl9wcml2LT5kcm0pOworCWludCBpcnEg
PSBkZXZfcHJpdi0+ZHJtLnBkZXYtPmlycTsKKworCS8qCisJICogRklYTUUgd2UgY2FuIGdldCBj
YWxsZWQgdHdpY2UgZHVyaW5nIGRyaXZlciBsb2FkCisJICogZXJyb3IgaGFuZGxpbmcgZHVlIHRv
IGludGVsX21vZGVzZXRfY2xlYW51cCgpCisJICogY2FsbGluZyB1cyBvdXQgb2Ygc2VxdWVuY2Uu
IFdvdWxkIGJlIG5pY2UgaWYKKwkgKiBpdCBkaWRuJ3QgZG8gdGhhdC4uLgorCSAqLworCWlmICgh
ZGV2X3ByaXYtPmRybS5pcnFfZW5hYmxlZCkKKwkJcmV0dXJuOworCisJZGV2X3ByaXYtPmRybS5p
cnFfZW5hYmxlZCA9IGZhbHNlOworCisJaW50ZWxfaXJxX3Jlc2V0KGRldl9wcml2KTsKKworCWZy
ZWVfaXJxKGlycSwgZGV2X3ByaXYpOworCiAJaW50ZWxfaHBkX2NhbmNlbF93b3JrKGRldl9wcml2
KTsKIAlkZXZfcHJpdi0+cnVudGltZV9wbS5pcnFzX2VuYWJsZWQgPSBmYWxzZTsKIH0KQEAgLTQ5
NjQsNyArNDk3MSw3IEBAIHZvaWQgaW50ZWxfaXJxX3VuaW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCiAgKi8KIHZvaWQgaW50ZWxfcnVudGltZV9wbV9kaXNhYmxlX2lu
dGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCWRldl9wcml2
LT5kcm0uZHJpdmVyLT5pcnFfdW5pbnN0YWxsKCZkZXZfcHJpdi0+ZHJtKTsKKwlpbnRlbF9pcnFf
cmVzZXQoZGV2X3ByaXYpOwogCWRldl9wcml2LT5ydW50aW1lX3BtLmlycXNfZW5hYmxlZCA9IGZh
bHNlOwogCXN5bmNocm9uaXplX2lycShkZXZfcHJpdi0+ZHJtLmlycSk7CiB9CkBAIC00OTc5LDYg
KzQ5ODYsNiBAQCB2b2lkIGludGVsX3J1bnRpbWVfcG1fZGlzYWJsZV9pbnRlcnJ1cHRzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHZvaWQgaW50ZWxfcnVudGltZV9wbV9lbmFi
bGVfaW50ZXJydXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJZGV2
X3ByaXYtPnJ1bnRpbWVfcG0uaXJxc19lbmFibGVkID0gdHJ1ZTsKLQlkZXZfcHJpdi0+ZHJtLmRy
aXZlci0+aXJxX3ByZWluc3RhbGwoJmRldl9wcml2LT5kcm0pOwotCWRldl9wcml2LT5kcm0uZHJp
dmVyLT5pcnFfcG9zdGluc3RhbGwoJmRldl9wcml2LT5kcm0pOworCWludGVsX2lycV9yZXNldChk
ZXZfcHJpdik7CisJaW50ZWxfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKIH0KLS0gCjIuMjEu
MAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwt
Z2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8v
bGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

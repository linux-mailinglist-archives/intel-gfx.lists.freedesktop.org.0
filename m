Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5E91A388B34
	for <lists+intel-gfx@lfdr.de>; Wed, 19 May 2021 11:53:56 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8BF1A6ECF5;
	Wed, 19 May 2021 09:53:54 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mail-qv1-xf33.google.com (mail-qv1-xf33.google.com
 [IPv6:2607:f8b0:4864:20::f33])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8A58F6ECF5;
 Wed, 19 May 2021 09:53:53 +0000 (UTC)
Received: by mail-qv1-xf33.google.com with SMTP id ez19so6460112qvb.3;
 Wed, 19 May 2021 02:53:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=nL/o1N/IXpNvWLKlqYDkIQjJPXz9DDB0WYGFkrJogHs=;
 b=Pyk1ry+Efo/wS7dvZpxQngDjwDysKDzkyYRRDWPlEJnqDRzWfD0gEd1LXFOx/tfxdu
 04nEnBm113AhloXzx2dsEBA6kNUIxzKnidnJyPRBFMJ1v6/KtMW4Ivxp8rjs1JQ77mRO
 w57dWj6YI9gPhA/AT5vu9VAPMKJ64qXW1ho3xRknt/UPy6ibm8xfaxOQG7bDxNijn0AF
 eHGdWmJehYm9hgSNOUwTtzSTed0XBt/0xIl7sckpAAqm5NT7Z84N+HucbC52VQm+XvBD
 xbJCEnbYY4NOYsfElvyGv+BCDybNPbUvEw+erlv45nPRHrf5zRA6LH901UnciuD4hVwg
 de9A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=nL/o1N/IXpNvWLKlqYDkIQjJPXz9DDB0WYGFkrJogHs=;
 b=fPSJAY2l34LrY5ojPVnAZ4FqLdM4HRkMOnhUySD05L6KXo5IVtJKY79rqq2SR7Ssb7
 bw6jQuRmj5qAjEB7zh58WxWkugkYd13Rg/jh8NHCUCU8Jv7r243eR/3Wmkpcb7Vnu8tr
 dmKpt1JhSHSt+yEP1oFcTuV+23u9Sr6AiVN6l9WC1nPxnsSMnpX6gaRhh/8JIYJ0CRRe
 i+tDG3Aq0/UhjPzz635RduP2xgoNHcimJBZPHFRmn/urvNSLZlRw003jXkLFncI0i+p+
 M++LIL5yeFVyqhg3LkVmY/vQjAr/01pVvxzTJ73FKcRbBpMlY03KzRYeP9VeROlKLGrr
 Otng==
X-Gm-Message-State: AOAM5320Y1Kzudp4EyhIPVsZNRWG0nvynI4WG91EN8CQt85zAMLqcKwM
 fjdDDI6RvV7+dNZ1FOSRD2mUrLPFVymNumJulXguyXAJRVfQH8IOTxA=
X-Google-Smtp-Source: ABdhPJzfMP/fJyirDENmQ8Gvqg4ggtKuxC6dAMlbryxjxq49uTpr5qWFb/JaZWls2oa99d7HwYE0SHqUE7NL7P6f3mk=
X-Received: by 2002:ad4:4961:: with SMTP id p1mr11961906qvy.43.1621418032401; 
 Wed, 19 May 2021 02:53:52 -0700 (PDT)
MIME-Version: 1.0
References: <20210518082701.997251-1-thomas.hellstrom@linux.intel.com>
 <20210518082701.997251-11-thomas.hellstrom@linux.intel.com>
In-Reply-To: <20210518082701.997251-11-thomas.hellstrom@linux.intel.com>
From: Matthew Auld <matthew.william.auld@gmail.com>
Date: Wed, 19 May 2021 10:53:25 +0100
Message-ID: <CAM0jSHPLdajyqtZBsR1C75aSgBa8wV1FLnQSa+tytAOKr5x11A@mail.gmail.com>
To: =?UTF-8?Q?Thomas_Hellstr=C3=B6m?= <thomas.hellstrom@linux.intel.com>
Subject: Re: [Intel-gfx] [PATCH v2 10/15] drm/i915/ttm: Introduce a TTM i915
 gem object backend
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel Graphics Development <intel-gfx@lists.freedesktop.org>,
 ML dri-devel <dri-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gVHVlLCAxOCBNYXkgMjAyMSBhdCAwOToyOCwgVGhvbWFzIEhlbGxzdHLDtm0KPHRob21hcy5o
ZWxsc3Ryb21AbGludXguaW50ZWwuY29tPiB3cm90ZToKPgo+IE1vc3QgbG9naWNhbCBwbGFjZSB0
byBpbnRyb2R1Y2UgVFRNIGJ1ZmZlciBvYmplY3RzIGlzIGFzIGFuIGk5MTUKPiBnZW0gb2JqZWN0
IGJhY2tlbmQuIFdlIG5lZWQgdG8gYWRkIHNvbWUgb3BzIHRvIGFjY291bnQgZm9yIGFkZGVkCj4g
ZnVuY3Rpb25hbGl0eSBsaWtlIGRlbGF5ZWQgZGVsZXRlIGFuZCBMUlUgbGlzdCBtYW5pcHVsYXRp
b24uCj4KPiBJbml0aWFsbHkgd2Ugc3VwcG9ydCBvbmx5IExNRU0gYW5kIFNZU1RFTSBtZW1vcnks
IGJ1dCBTWVNURU0KPiAod2hpY2ggaW4gdGhpcyBjYXNlIG1lYW5zIGV2aWN0ZWQgTE1FTSBvYmpl
Y3RzKSBpcyBub3QKPiB2aXNpYmxlIHRvIGk5MTUgR0VNIHlldC4gVGhlIHBsYW4gaXMgdG8gbW92
ZSB0aGUgaTkxNSBnZW0gc3lzdGVtIHJlZ2lvbgo+IG92ZXIgdG8gdGhlIFRUTSBzeXN0ZW0gbWVt
b3J5IHR5cGUgaW4gdXBjb21pbmcgcGF0Y2hlcy4KPgo+IFdlIHNldCB1cCBHUFUgYmluZGluZ3Mg
ZGlyZWN0bHkgYm90aCBmcm9tIExNRU0gYW5kIGZyb20gdGhlIHN5c3RlbSByZWdpb24sCj4gYXMg
dGhlcmUgaXMgbm8gbmVlZCB0byB1c2UgdGhlIGxlZ2FjeSBUVE1fVFQgbWVtb3J5IHR5cGUuIFdl
IHJlc2VydmUKPiB0aGF0IGZvciBmdXR1cmUgcG9ydGluZyBvZiBHR1RUIGJpbmRpbmdzIHRvIFRU
TS4KPgo+IFJlbW92ZSB0aGUgb2xkIGxtZW0gYmFja2VuZC4KPgo+IFNpZ25lZC1vZmYtYnk6IFRo
b21hcyBIZWxsc3Ryw7ZtIDx0aG9tYXMuaGVsbHN0cm9tQGxpbnV4LmludGVsLmNvbT4KPiAtLS0K
PiB2MjoKPiAtIEJyZWFrIG91dCBuZWVkZWQgVFRNIGZ1bmN0aW9uYWxpdHkgdG8gYSBzZXBhcmF0
ZSBwYXRjaCAoUmVwb3J0ZWQgYnkKPiBDaHJpc3RpYW4gS8O2bmlnKS4KPiAtIEZpeCBhbiB1bmhh
bmRsZWQgZXJyb3IgKFJlcG9ydGVkIGJ5IE1hdHRoZXcgQXVsZCBhbmQgTWFhcnRlbiBMYW5raG9y
c3QpCj4gLSBSZW1vdmUgYSBzdHJheSBsZWZ0b3ZlciBzZ190YWJsZSBhbGxvY2F0aW9uIChSZXBv
cnRlZCBieSBNYXR0aGV3IEF1bGQpCj4gLSBVc2UgdHRtX3R0X3VucG9wdWxhdGUoKSByYXRoZXIg
dGhhbiB0dG1fdHRfZGVzdHJveSgpIGluIHRoZSBwdXJnZSBwYXRoCj4gICBhcyBzb21lIFRUTSBm
dW5jdGlvbmFsaXR5IHJlbGllcyBvbiBoYXZpbmcgYSB0dG1fdHQgcHJlc2VudCBmb3IgIWlzX2lv
bWVtLgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSAgICAgICAgICAgICAg
ICAgfCAgIDEgKwo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbG1lbS5jICAg
ICAgfCAgODQgLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9sbWVtLmgg
ICAgICB8ICAgNSAtCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3Qu
YyAgICB8IDEyNSArKystLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2Jq
ZWN0LmggICAgfCAgIDkgKwo+ICAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3Rf
dHlwZXMuaCAgfCAgMTggKwo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcmVn
aW9uLmMgICAgfCAgIDYgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3R0
bS5jICAgICAgIHwgNTE5ICsrKysrKysrKysrKysrKysrKwo+ICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fdHRtLmggICAgICAgfCAgNDggKysKPiAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfcmVnaW9uX2xtZW0uYyAgIHwgICAzICstCj4gIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ2VtLmMgICAgICAgICAgICAgICB8ICAgNSArLQo+ICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9tZW1vcnlfcmVnaW9uLmMgICAgfCAgIDEgLQo+ICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9tZW1vcnlfcmVnaW9uLmggICAgfCAgIDEgLQo+ICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9yZWdpb25fdHRtLmMgICAgICAgfCAgIDUgKy0KPiAgZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfcmVnaW9uX3R0bS5oICAgICAgIHwgICA3ICstCj4gIDE1IGZpbGVzIGNoYW5n
ZWQsIDY5NiBpbnNlcnRpb25zKCspLCAxNDEgZGVsZXRpb25zKC0pCj4gIGNyZWF0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdHRtLmMKPiAgY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90dG0uaAo+Cj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvTWFrZWZpbGUKPiBpbmRleCA5NThjY2MxZWRmZWQuLmVmMGQ4ODRhOWUyZCAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQo+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L01ha2VmaWxlCj4gQEAgLTE1NSw2ICsxNTUsNyBAQCBnZW0teSArPSBcCj4gICAg
ICAgICBnZW0vaTkxNV9nZW1fc3RvbGVuLm8gXAo+ICAgICAgICAgZ2VtL2k5MTVfZ2VtX3Rocm90
dGxlLm8gXAo+ICAgICAgICAgZ2VtL2k5MTVfZ2VtX3RpbGluZy5vIFwKPiArICAgICAgIGdlbS9p
OTE1X2dlbV90dG0ubyBcCj4gICAgICAgICBnZW0vaTkxNV9nZW1fdHRtX2JvX3V0aWwubyBcCj4g
ICAgICAgICBnZW0vaTkxNV9nZW1fdXNlcnB0ci5vIFwKPiAgICAgICAgIGdlbS9pOTE1X2dlbV93
YWl0Lm8gXAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
bG1lbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2xtZW0uYwo+IGluZGV4
IDNiNGFhMjhhMDc2ZC4uMmI4Y2QxNWRlMWQ5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9sbWVtLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fbG1lbS5jCj4gQEAgLTQsNzQgKzQsMTAgQEAKPiAgICovCj4KPiAgI2luY2x1
ZGUgImludGVsX21lbW9yeV9yZWdpb24uaCIKPiAtI2luY2x1ZGUgImludGVsX3JlZ2lvbl90dG0u
aCIKPiAgI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9yZWdpb24uaCIKPiAgI2luY2x1ZGUgImdlbS9p
OTE1X2dlbV9sbWVtLmgiCj4gICNpbmNsdWRlICJpOTE1X2Rydi5oIgo+Cj4gLXN0YXRpYyB2b2lk
IGxtZW1fcHV0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNnX3RhYmxlICpwYWdlcykKPiAtewo+IC0gICAg
ICAgaW50ZWxfcmVnaW9uX3R0bV9ub2RlX2ZyZWUob2JqLT5tbS5yZWdpb24sIG9iai0+bW0uc3Rf
bW1fbm9kZSk7Cj4gLSAgICAgICBvYmotPm1tLmRpcnR5ID0gZmFsc2U7Cj4gLSAgICAgICBzZ19m
cmVlX3RhYmxlKHBhZ2VzKTsKPiAtICAgICAgIGtmcmVlKHBhZ2VzKTsKPiAtfQo+IC0KPiAtc3Rh
dGljIGludCBsbWVtX2dldF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+
IC17Cj4gLSAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3M7Cj4gLSAgICAgICBzdHJ1Y3Qgc2dfdGFi
bGUgKnBhZ2VzOwo+IC0KPiAtICAgICAgIGZsYWdzID0gSTkxNV9BTExPQ19NSU5fUEFHRV9TSVpF
Owo+IC0gICAgICAgaWYgKG9iai0+ZmxhZ3MgJiBJOTE1X0JPX0FMTE9DX0NPTlRJR1VPVVMpCj4g
LSAgICAgICAgICAgICAgIGZsYWdzIHw9IEk5MTVfQUxMT0NfQ09OVElHVU9VUzsKPiAtCj4gLSAg
ICAgICBvYmotPm1tLnN0X21tX25vZGUgPSBpbnRlbF9yZWdpb25fdHRtX25vZGVfYWxsb2Mob2Jq
LT5tbS5yZWdpb24sCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgb2JqLT5iYXNlLnNpemUsCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxhZ3MpOwo+IC0gICAgICAgaWYgKElT
X0VSUihvYmotPm1tLnN0X21tX25vZGUpKQo+IC0gICAgICAgICAgICAgICByZXR1cm4gUFRSX0VS
UihvYmotPm1tLnN0X21tX25vZGUpOwo+IC0KPiAtICAgICAgIC8qIFJhbmdlIG1hbmFnZXIgaXMg
YWx3YXlzIGNvbnRpZ291cyAqLwo+IC0gICAgICAgaWYgKG9iai0+bW0ucmVnaW9uLT5pc19yYW5n
ZV9tYW5hZ2VyKQo+IC0gICAgICAgICAgICAgICBvYmotPmZsYWdzIHw9IEk5MTVfQk9fQUxMT0Nf
Q09OVElHVU9VUzsKPiAtICAgICAgIHBhZ2VzID0gaW50ZWxfcmVnaW9uX3R0bV9ub2RlX3RvX3N0
KG9iai0+bW0ucmVnaW9uLCBvYmotPm1tLnN0X21tX25vZGUpOwo+IC0gICAgICAgaWYgKElTX0VS
UihwYWdlcykpIHsKPiAtICAgICAgICAgICAgICAgaW50ZWxfcmVnaW9uX3R0bV9ub2RlX2ZyZWUo
b2JqLT5tbS5yZWdpb24sIG9iai0+bW0uc3RfbW1fbm9kZSk7Cj4gLSAgICAgICAgICAgICAgIHJl
dHVybiBQVFJfRVJSKHBhZ2VzKTsKPiAtICAgICAgIH0KPiAtCj4gLSAgICAgICBfX2k5MTVfZ2Vt
X29iamVjdF9zZXRfcGFnZXMob2JqLCBwYWdlcywgaTkxNV9zZ19kbWFfc2l6ZXMocGFnZXMtPnNn
bCkpOwo+IC0KPiAtICAgICAgIGlmIChvYmotPmZsYWdzICYgSTkxNV9CT19BTExPQ19DUFVfQ0xF
QVIpIHsKPiAtICAgICAgICAgICAgICAgdm9pZCBfX2lvbWVtICp2YWRkciA9Cj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgaTkxNV9nZW1fb2JqZWN0X2xtZW1faW9fbWFwKG9iaiwgMCwgb2JqLT5i
YXNlLnNpemUpOwo+IC0KPiAtICAgICAgICAgICAgICAgaWYgKCF2YWRkcikgewo+IC0gICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBzZ190YWJsZSAqcGFnZXMgPQo+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgX19pOTE1X2dlbV9vYmplY3RfdW5zZXRfcGFnZXMob2JqKTsKPiAt
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFJU19FUlJfT1JfTlVMTChwYWdlcykpCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsbWVtX3B1dF9wYWdlcyhvYmosIHBhZ2Vz
KTsKPiAtICAgICAgICAgICAgICAgfQo+IC0KPiAtICAgICAgICAgICAgICAgbWVtc2V0X2lvKHZh
ZGRyLCAwLCBvYmotPmJhc2Uuc2l6ZSk7Cj4gLSAgICAgICAgICAgICAgIGlvX21hcHBpbmdfdW5t
YXAodmFkZHIpOwo+IC0gICAgICAgfQo+IC0KPiAtICAgICAgIHJldHVybiAwOwo+IC19Cj4gLQo+
IC1jb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdF9vcHMgaTkxNV9nZW1fbG1lbV9vYmpf
b3BzID0gewo+IC0gICAgICAgLm5hbWUgPSAiaTkxNV9nZW1fb2JqZWN0X2xtZW0iLAo+IC0gICAg
ICAgLmZsYWdzID0gSTkxNV9HRU1fT0JKRUNUX0hBU19JT01FTSwKPiAtCj4gLSAgICAgICAuZ2V0
X3BhZ2VzID0gbG1lbV9nZXRfcGFnZXMsCj4gLSAgICAgICAucHV0X3BhZ2VzID0gbG1lbV9wdXRf
cGFnZXMsCj4gLSAgICAgICAucmVsZWFzZSA9IGk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21lbW9y
eV9yZWdpb24sCj4gLX07Cj4gLQo+ICB2b2lkIF9faW9tZW0gKgo+ICBpOTE1X2dlbV9vYmplY3Rf
bG1lbV9pb19tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBuLAo+IEBAIC0xMDMsMjMgKzM5LDMgQEAg
aTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9sbWVtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAo+ICAgICAgICAgcmV0dXJuIGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfcmVnaW9uKGk5MTUtPm1t
LnJlZ2lvbnNbSU5URUxfUkVHSU9OX0xNRU1dLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHNpemUsIGZsYWdzKTsKPiAgfQo+IC0KPiAtaW50IF9faTkxNV9n
ZW1fbG1lbV9vYmplY3RfaW5pdChzdHJ1Y3QgaW50ZWxfbWVtb3J5X3JlZ2lvbiAqbWVtLAo+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaiwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlX3NpemVfdCBz
aXplLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGZsYWdz
KQo+IC17Cj4gLSAgICAgICBzdGF0aWMgc3RydWN0IGxvY2tfY2xhc3Nfa2V5IGxvY2tfY2xhc3M7
Cj4gLSAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG1lbS0+aTkxNTsKPiAt
Cj4gLSAgICAgICBkcm1fZ2VtX3ByaXZhdGVfb2JqZWN0X2luaXQoJmk5MTUtPmRybSwgJm9iai0+
YmFzZSwgc2l6ZSk7Cj4gLSAgICAgICBpOTE1X2dlbV9vYmplY3RfaW5pdChvYmosICZpOTE1X2dl
bV9sbWVtX29ial9vcHMsICZsb2NrX2NsYXNzLCBmbGFncyk7Cj4gLQo+IC0gICAgICAgb2JqLT5y
ZWFkX2RvbWFpbnMgPSBJOTE1X0dFTV9ET01BSU5fV0MgfCBJOTE1X0dFTV9ET01BSU5fR1RUOwo+
IC0KPiAtICAgICAgIGk5MTVfZ2VtX29iamVjdF9zZXRfY2FjaGVfY29oZXJlbmN5KG9iaiwgSTkx
NV9DQUNIRV9OT05FKTsKPiAtCj4gLSAgICAgICBpOTE1X2dlbV9vYmplY3RfaW5pdF9tZW1vcnlf
cmVnaW9uKG9iaiwgbWVtKTsKPiAtCj4gLSAgICAgICByZXR1cm4gMDsKPiAtfQo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbG1lbS5oIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2xtZW0uaAo+IGluZGV4IGZhYzZiYzVhNWViYi4uZWE3
NmZkMTFjY2IwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9sbWVtLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbG1lbS5o
Cj4gQEAgLTI2LDkgKzI2LDQgQEAgaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9sbWVtKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNv
dXJjZV9zaXplX3Qgc2l6ZSwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQg
aW50IGZsYWdzKTsKPgo+IC1pbnQgX19pOTE1X2dlbV9sbWVtX29iamVjdF9pbml0KHN0cnVjdCBp
bnRlbF9tZW1vcnlfcmVnaW9uICptZW0sCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAo+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcmVzb3VyY2Vfc2l6ZV90IHNpemUsCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpOwo+IC0KPiAgI2VuZGlmIC8qICFfX0k5MTVf
R0VNX0xNRU1fSCAqLwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0
LmMKPiBpbmRleCBjODk1M2UzZjVjNzAuLjg1ODA5OTYxMDdjZSAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKPiBAQCAtMTcyLDcgKzE3Miw3IEBAIHN0
YXRpYyB2b2lkIGk5MTVfZ2VtX2Nsb3NlX29iamVjdChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdl
bSwgc3RydWN0IGRybV9maWxlICpmCj4gICAgICAgICB9Cj4gIH0KPgo+IC1zdGF0aWMgdm9pZCBf
X2k5MTVfZ2VtX2ZyZWVfb2JqZWN0X3JjdShzdHJ1Y3QgcmN1X2hlYWQgKmhlYWQpCj4gK3ZvaWQg
X19pOTE1X2dlbV9mcmVlX29iamVjdF9yY3Uoc3RydWN0IHJjdV9oZWFkICpoZWFkKQo+ICB7Cj4g
ICAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0KPiAgICAgICAgICAgICAg
ICAgY29udGFpbmVyX29mKGhlYWQsIHR5cGVvZigqb2JqKSwgcmN1KTsKPiBAQCAtMjA4LDU5ICsy
MDgsNjkgQEAgc3RhdGljIHZvaWQgX19pOTE1X2dlbV9vYmplY3RfZnJlZV9tbWFwcyhzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ICAgICAgICAgfQo+ICB9Cj4KPiAtc3RhdGljIHZv
aWQgX19pOTE1X2dlbV9mcmVlX29iamVjdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGxsaXN0X25vZGUg
KmZyZWVkKQo+ICt2b2lkIF9faTkxNV9nZW1fZnJlZV9vYmplY3Qoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaikKPiAgewo+IC0gICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaiwgKm9uOwo+ICsgICAgICAgdHJhY2VfaTkxNV9nZW1fb2JqZWN0X2Rlc3Ryb3kob2JqKTsK
Pgo+IC0gICAgICAgbGxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShvYmosIG9uLCBmcmVlZCwgZnJl
ZWQpIHsKPiAtICAgICAgICAgICAgICAgdHJhY2VfaTkxNV9nZW1fb2JqZWN0X2Rlc3Ryb3kob2Jq
KTsKPiArICAgICAgIGlmICghbGlzdF9lbXB0eSgmb2JqLT52bWEubGlzdCkpIHsKPiArICAgICAg
ICAgICAgICAgc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gKwo+ICsgICAgICAgICAgICAgICAvKgo+
ICsgICAgICAgICAgICAgICAgKiBOb3RlIHRoYXQgdGhlIHZtYSBrZWVwcyBhbiBvYmplY3QgcmVm
ZXJlbmNlIHdoaWxlCj4gKyAgICAgICAgICAgICAgICAqIGl0IGlzIGFjdGl2ZSwgc28gaXQgKnNo
b3VsZCogbm90IHNsZWVwIHdoaWxlIHdlCj4gKyAgICAgICAgICAgICAgICAqIGRlc3Ryb3kgaXQu
IE91ciBkZWJ1ZyBjb2RlIGVycnMgaW5zaXRzIGl0ICptaWdodCouCj4gKyAgICAgICAgICAgICAg
ICAqIEZvciB0aGUgbW9tZW50LCBwbGF5IGFsb25nLgo+ICsgICAgICAgICAgICAgICAgKi8KPiAr
ICAgICAgICAgICAgICAgc3Bpbl9sb2NrKCZvYmotPnZtYS5sb2NrKTsKPiArICAgICAgICAgICAg
ICAgd2hpbGUgKCh2bWEgPSBsaXN0X2ZpcnN0X2VudHJ5X29yX251bGwoJm9iai0+dm1hLmxpc3Qs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCBpOTE1X3ZtYSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgb2JqX2xpbmspKSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAg
IEdFTV9CVUdfT04odm1hLT5vYmogIT0gb2JqKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBz
cGluX3VubG9jaygmb2JqLT52bWEubG9jayk7Cj4KPiAtICAgICAgICAgICAgICAgaWYgKCFsaXN0
X2VtcHR5KCZvYmotPnZtYS5saXN0KSkgewo+IC0gICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBpOTE1X3ZtYSAqdm1hOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIF9faTkxNV92bWFfcHV0
KHZtYSk7Cj4KPiAtICAgICAgICAgICAgICAgICAgICAgICAvKgo+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAqIE5vdGUgdGhhdCB0aGUgdm1hIGtlZXBzIGFuIG9iamVjdCByZWZlcmVuY2Ugd2hp
bGUKPiAtICAgICAgICAgICAgICAgICAgICAgICAgKiBpdCBpcyBhY3RpdmUsIHNvIGl0ICpzaG91
bGQqIG5vdCBzbGVlcCB3aGlsZSB3ZQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAqIGRlc3Ry
b3kgaXQuIE91ciBkZWJ1ZyBjb2RlIGVycnMgaW5zaXRzIGl0ICptaWdodCouCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICogRm9yIHRoZSBtb21lbnQsIHBsYXkgYWxvbmcuCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICovCj4gICAgICAgICAgICAgICAgICAgICAgICAgc3Bpbl9sb2NrKCZv
YmotPnZtYS5sb2NrKTsKPiAtICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKHZtYSA9IGxp
c3RfZmlyc3RfZW50cnlfb3JfbnVsbCgmb2JqLT52bWEubGlzdCwKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkx
NV92bWEsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgb2JqX2xpbmspKSkgewo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgR0VNX0JVR19PTih2bWEtPm9iaiAhPSBvYmopOwo+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3Bpbl91bmxvY2soJm9iai0+dm1hLmxvY2spOwo+ICsgICAgICAgICAgICAg
ICB9Cj4gKyAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZvYmotPnZtYS5sb2NrKTsKPiArICAg
ICAgIH0KPgo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19pOTE1X3ZtYV9wdXQo
dm1hKTsKPiArICAgICAgIF9faTkxNV9nZW1fb2JqZWN0X2ZyZWVfbW1hcHMob2JqKTsKPgo+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Bpbl9sb2NrKCZvYmotPnZtYS5sb2NrKTsK
PiAtICAgICAgICAgICAgICAgICAgICAgICB9Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgc3Bp
bl91bmxvY2soJm9iai0+dm1hLmxvY2spOwo+IC0gICAgICAgICAgICAgICB9Cj4gKyAgICAgICBH
RU1fQlVHX09OKCFsaXN0X2VtcHR5KCZvYmotPmx1dF9saXN0KSk7Cj4KPiAtICAgICAgICAgICAg
ICAgX19pOTE1X2dlbV9vYmplY3RfZnJlZV9tbWFwcyhvYmopOwo+ICsgICAgICAgYXRvbWljX3Nl
dCgmb2JqLT5tbS5wYWdlc19waW5fY291bnQsIDApOwo+ICsgICAgICAgX19pOTE1X2dlbV9vYmpl
Y3RfcHV0X3BhZ2VzKG9iaik7Cj4gKyAgICAgICBHRU1fQlVHX09OKGk5MTVfZ2VtX29iamVjdF9o
YXNfcGFnZXMob2JqKSk7Cj4gKyAgICAgICBiaXRtYXBfZnJlZShvYmotPmJpdF8xNyk7Cj4KPiAt
ICAgICAgICAgICAgICAgR0VNX0JVR19PTighbGlzdF9lbXB0eSgmb2JqLT5sdXRfbGlzdCkpOwo+
ICsgICAgICAgaWYgKG9iai0+YmFzZS5pbXBvcnRfYXR0YWNoKQo+ICsgICAgICAgICAgICAgICBk
cm1fcHJpbWVfZ2VtX2Rlc3Ryb3koJm9iai0+YmFzZSwgTlVMTCk7Cj4KPiAtICAgICAgICAgICAg
ICAgYXRvbWljX3NldCgmb2JqLT5tbS5wYWdlc19waW5fY291bnQsIDApOwo+IC0gICAgICAgICAg
ICAgICBfX2k5MTVfZ2VtX29iamVjdF9wdXRfcGFnZXMob2JqKTsKPiAtICAgICAgICAgICAgICAg
R0VNX0JVR19PTihpOTE1X2dlbV9vYmplY3RfaGFzX3BhZ2VzKG9iaikpOwo+IC0gICAgICAgICAg
ICAgICBiaXRtYXBfZnJlZShvYmotPmJpdF8xNyk7Cj4gKyAgICAgICBkcm1fZ2VtX2ZyZWVfbW1h
cF9vZmZzZXQoJm9iai0+YmFzZSk7Cj4KPiAtICAgICAgICAgICAgICAgaWYgKG9iai0+YmFzZS5p
bXBvcnRfYXR0YWNoKQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGRybV9wcmltZV9nZW1fZGVz
dHJveSgmb2JqLT5iYXNlLCBOVUxMKTsKPiArICAgICAgIGlmIChvYmotPm9wcy0+cmVsZWFzZSkK
PiArICAgICAgICAgICAgICAgb2JqLT5vcHMtPnJlbGVhc2Uob2JqKTsKPgo+IC0gICAgICAgICAg
ICAgICBkcm1fZ2VtX2ZyZWVfbW1hcF9vZmZzZXQoJm9iai0+YmFzZSk7Cj4gKyAgICAgICBpZiAo
b2JqLT5tbS5uX3BsYWNlbWVudHMgPiAxKQo+ICsgICAgICAgICAgICAgICBrZnJlZShvYmotPm1t
LnBsYWNlbWVudHMpOwo+Cj4gLSAgICAgICAgICAgICAgIGlmIChvYmotPm9wcy0+cmVsZWFzZSkK
PiAtICAgICAgICAgICAgICAgICAgICAgICBvYmotPm9wcy0+cmVsZWFzZShvYmopOwo+ICsgICAg
ICAgaWYgKG9iai0+cmVzdl9zaGFyZWRfZnJvbSkKPiArICAgICAgICAgICAgICAgaTkxNV92bV9y
ZXN2X3B1dChvYmotPnJlc3Zfc2hhcmVkX2Zyb20pOwo+ICt9Cj4KPiAtICAgICAgICAgICAgICAg
aWYgKG9iai0+bW0ubl9wbGFjZW1lbnRzID4gMSkKPiAtICAgICAgICAgICAgICAgICAgICAgICBr
ZnJlZShvYmotPm1tLnBsYWNlbWVudHMpOwo+ICtzdGF0aWMgdm9pZCBfX2k5MTVfZ2VtX2ZyZWVf
b2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbGxpc3Rfbm9kZSAqZnJlZWQpCj4gK3sKPiArICAg
ICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosICpvbjsKPgo+IC0gICAgICAgICAg
ICAgICBpZiAob2JqLT5yZXN2X3NoYXJlZF9mcm9tKQo+IC0gICAgICAgICAgICAgICAgICAgICAg
IGk5MTVfdm1fcmVzdl9wdXQob2JqLT5yZXN2X3NoYXJlZF9mcm9tKTsKPiArICAgICAgIGxsaXN0
X2Zvcl9lYWNoX2VudHJ5X3NhZmUob2JqLCBvbiwgZnJlZWQsIGZyZWVkKSB7Cj4gKyAgICAgICAg
ICAgICAgIG1pZ2h0X3NsZWVwKCk7Cj4gKyAgICAgICAgICAgICAgIGlmIChvYmotPm9wcy0+ZGVs
YXllZF9mcmVlKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgb2JqLT5vcHMtPmRlbGF5ZWRf
ZnJlZShvYmopOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+ICsgICAgICAg
ICAgICAgICB9Cj4gKyAgICAgICAgICAgICAgIF9faTkxNV9nZW1fZnJlZV9vYmplY3Qob2JqKTsK
Pgo+ICAgICAgICAgICAgICAgICAvKiBCdXQga2VlcCB0aGUgcG9pbnRlciBhbGl2ZSBmb3IgUkNV
LXByb3RlY3RlZCBsb29rdXBzICovCj4gICAgICAgICAgICAgICAgIGNhbGxfcmN1KCZvYmotPnJj
dSwgX19pOTE1X2dlbV9mcmVlX29iamVjdF9yY3UpOwo+IEBAIC0zMTgsNiArMzI4LDcgQEAgc3Rh
dGljIHZvaWQgaTkxNV9nZW1fZnJlZV9vYmplY3Qoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW1f
b2JqKQo+ICAgICAgICAgICogd29ya2VyIGFuZCBwZXJmb3JtaW5nIGZyZWVzIGRpcmVjdGx5IGZy
b20gc3Vic2VxdWVudCBhbGxvY2F0aW9ucyBmb3IKPiAgICAgICAgICAqIGNydWRlIGJ1dCBlZmZl
Y3RpdmUgbWVtb3J5IHRocm90dGxpbmcuCj4gICAgICAgICAgKi8KPiArCj4gICAgICAgICBpZiAo
bGxpc3RfYWRkKCZvYmotPmZyZWVkLCAmaTkxNS0+bW0uZnJlZV9saXN0KSkKPiAgICAgICAgICAg
ICAgICAgcXVldWVfd29yayhpOTE1LT53cSwgJmk5MTUtPm1tLmZyZWVfd29yayk7Cj4gIH0KPiBA
QCAtNDEwLDYgKzQyMSw0MiBAQCBpbnQgaTkxNV9nZW1fb2JqZWN0X3JlYWRfZnJvbV9wYWdlKHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosIHU2NCBvZmZzZXQsCj4gICAgICAgICByZXR1
cm4gMDsKPiAgfQo+Cj4gKy8qKgo+ICsgKiBpOTE1X2dlbV9vYmplY3RfZXZpY3RhYmxlIC0gV2hl
dGhlciBvYmplY3QgaXMgbGlrZWx5IGV2aWN0YWJsZSBhZnRlciB1bmJpbmQuCj4gKyAqIEBvYmo6
IFRoZSBvYmplY3QgdG8gY2hlY2sKPiArICoKPiArICogVGhpcyBmdW5jdGlvbiBjaGVja3Mgd2hl
dGhlciB0aGUgb2JqZWN0IGlzIGxpa2VseSB1bnZpY3RhYmxlIGFmdGVyIHVuYmluZC4KPiArICog
SWYgdGhlIG9iamVjdCBpcyBub3QgbG9ja2VkIHdoZW4gY2hlY2tpbmcsIHRoZSByZXN1bHQgaXMg
b25seSBhZHZpc29yeS4KPiArICogSWYgdGhlIG9iamVjdCBpcyBsb2NrZWQgd2hlbiBjaGVja2lu
ZywgYW5kIHRoZSBmdW5jdGlvbiByZXR1cm5zIHRydWUsCj4gKyAqIHRoZW4gYW4gZXZpY3Rpb24g
c2hvdWxkIGluZGVlZCBiZSBwb3NzaWJsZS4gQnV0IHNpbmNlIHVubG9ja2VkIHZtYQo+ICsgKiB1
bnBpbm5pbmcgYW5kIHVuYmluZGluZyBpcyBjdXJyZW50bHkgcG9zc2libGUsIHRoZSBvYmplY3Qg
Y2FuIGFjdHVhbGx5Cj4gKyAqIGJlY29tZSBldmljdGFibGUgZXZlbiBpZiB0aGlzIGZ1bmN0aW9u
IHJldHVybnMgZmFsc2UuCj4gKyAqCj4gKyAqIFJldHVybjogdHJ1ZSBpZiB0aGUgb2JqZWN0IG1h
eSBiZSBldmljdGFibGUuIEZhbHNlIG90aGVyd2lzZS4KPiArICovCj4gK2Jvb2wgaTkxNV9nZW1f
b2JqZWN0X2V2aWN0YWJsZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ICt7Cj4g
KyAgICAgICBzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiArICAgICAgIGludCBwaW5fY291bnQgPSBh
dG9taWNfcmVhZCgmb2JqLT5tbS5wYWdlc19waW5fY291bnQpOwo+ICsKPiArICAgICAgIGlmICgh
cGluX2NvdW50KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKPiArCj4gKyAgICAgICBz
cGluX2xvY2soJm9iai0+dm1hLmxvY2spOwo+ICsgICAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeSh2
bWEsICZvYmotPnZtYS5saXN0LCBvYmpfbGluaykgewo+ICsgICAgICAgICAgICAgICBpZiAoaTkx
NV92bWFfaXNfcGlubmVkKHZtYSkpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBzcGluX3Vu
bG9jaygmb2JqLT52bWEubG9jayk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZh
bHNlOwo+ICsgICAgICAgICAgICAgICB9Cj4gKyAgICAgICAgICAgICAgIGlmIChhdG9taWNfcmVh
ZCgmdm1hLT5wYWdlc19jb3VudCkpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcGluX2NvdW50
LS07CgpDYW4ndCBwYWdlc19jb3VudCBiZSA+IDEsIHdoaWNoIHdvdWxkIGFsc28gYmUgcmVmbGVj
dGVkIGluCnBhZ2VzX3Bpbl9jb3VudD8gVGhlIHZtYV9waW4gcGF0aCBsb29rcyB2ZXJ5IGNvbXBs
ZXguCgo+ICsgICAgICAgfQo+ICsgICAgICAgc3Bpbl91bmxvY2soJm9iai0+dm1hLmxvY2spOwo+
ICsgICAgICAgR0VNX1dBUk5fT04ocGluX2NvdW50IDwgMCk7Cj4gKwo+ICsgICAgICAgcmV0dXJu
IHBpbl9jb3VudCA9PSAwOwo+ICt9Cj4gKwo+ICB2b2lkIGk5MTVfZ2VtX2luaXRfX29iamVjdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gIHsKPiAgICAgICAgIElOSVRfV09SSygm
aTkxNS0+bW0uZnJlZV93b3JrLCBfX2k5MTVfZ2VtX2ZyZWVfd29yayk7Cj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaAo+IGluZGV4IDJlYmQ3OTUzN2FlYS4uYWU1
OTMwZTMwN2Q1IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9vYmplY3QuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmpl
Y3QuaAo+IEBAIC0yMDAsNiArMjAwLDkgQEAgc3RhdGljIGlubGluZSBib29sIGk5MTVfZ2VtX29i
amVjdF90cnlsb2NrKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4KPiAgc3RhdGlj
IGlubGluZSB2b2lkIGk5MTVfZ2VtX29iamVjdF91bmxvY2soc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaikKPiAgewo+ICsgICAgICAgaWYgKG9iai0+b3BzLT5hZGp1c3RfbHJ1KQo+ICsg
ICAgICAgICAgICAgICBvYmotPm9wcy0+YWRqdXN0X2xydShvYmopOwoKSW50ZXJlc3RpbmcsIHNv
IHdlIGJ1bXAgdGhlIGxydSBldmVuIHdoZW4gd2UganVzdCBkcm9wIHRoZSBsb2NrPwoKPiArCj4g
ICAgICAgICBkbWFfcmVzdl91bmxvY2sob2JqLT5iYXNlLnJlc3YpOwo+ICB9Cj4KPiBAQCAtNTg3
LDYgKzU5MCwxMiBAQCBpbnQgaTkxNV9nZW1fb2JqZWN0X3JlYWRfZnJvbV9wYWdlKHN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmosIHU2NCBvZmZzZXQsCj4KPiAgYm9vbCBpOTE1X2dlbV9v
YmplY3RfaXNfc2htZW0oY29uc3Qgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaik7Cj4K
PiArdm9pZCBfX2k5MTVfZ2VtX2ZyZWVfb2JqZWN0X3JjdShzdHJ1Y3QgcmN1X2hlYWQgKmhlYWQp
Owo+ICsKPiArdm9pZCBfX2k5MTVfZ2VtX2ZyZWVfb2JqZWN0KHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmopOwo+ICsKPiArYm9vbCBpOTE1X2dlbV9vYmplY3RfZXZpY3RhYmxlKHN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopOwo+ICsKPiAgI2lmZGVmIENPTkZJR19NTVVfTk9U
SUZJRVIKPiAgc3RhdGljIGlubGluZSBib29sCj4gIGk5MTVfZ2VtX29iamVjdF9pc191c2VycHRy
KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaAo+IGluZGV4IDk4ZjY5ZDhmZDM3ZC4u
YjM1MDc2NWUxOTM1IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9vYmplY3RfdHlwZXMuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9vYmplY3RfdHlwZXMuaAo+IEBAIC02Myw2ICs2MywyMCBAQCBzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdF9vcHMgewo+ICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX3B3cml0ZSAqYXJnKTsKPgo+ICAgICAgICAgaW50ICgqZG1hYnVmX2V4cG9ydCko
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaik7Cj4gKwo+ICsgICAgICAgLyoqCj4gKyAg
ICAgICAgKiBhZGp1c3RfbHJ1IC0gbm90aWZ5IHRoYXQgdGhlIG1hZHZpc2UgdmFsdWUgd2FzIHVw
ZGF0ZWQKPiArICAgICAgICAqIEBvYmo6IFRoZSBnZW0gb2JqZWN0Cj4gKyAgICAgICAgKgo+ICsg
ICAgICAgICogVGhlIG1hZHZpc2UgdmFsdWUgbWF5IGhhdmUgYmVlbiB1cGRhdGVkLCBvciBvYmpl
Y3Qgd2FzIHJlY2VudGx5Cj4gKyAgICAgICAgKiByZWZlcmVuY2VkIHNvIGFjdCBhY2NvcmRpbmds
eSAoUGVyaGFwcyBjaGFuZ2luZyBhbiBMUlUgbGlzdCBldGMpLgo+ICsgICAgICAgICovCj4gKyAg
ICAgICB2b2lkICgqYWRqdXN0X2xydSkoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaik7
Cj4gKwo+ICsgICAgICAgLyoqCj4gKyAgICAgICAgKiBkZWxheWVkX2ZyZWUgLSBPdmVycmlkZSB0
aGUgZGVmYXVsdCBkZWxheWVkIGZyZWUgaW1wbGVtZW50YXRpb24KPiArICAgICAgICAqLwo+ICsg
ICAgICAgdm9pZCAoKmRlbGF5ZWRfZnJlZSkoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aik7Cj4gICAgICAgICB2b2lkICgqcmVsZWFzZSkoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaik7Cj4KPiAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWU7IC8qIGZyaWVuZGx5IG5hbWUgZm9y
IGRlYnVnLCBlLmcuIGxvY2tkZXAgY2xhc3NlcyAqLwo+IEBAIC0zMDcsNiArMzIxLDEwIEBAIHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0IHsKPiAgICAgICAgICAgICAgICAgYm9vbCBkaXJ0eTox
Owo+ICAgICAgICAgfSBtbTsKPgo+ICsgICAgICAgc3RydWN0IHsKPiArICAgICAgICAgICAgICAg
c3RydWN0IHNnX3RhYmxlICpjYWNoZWRfaW9fc3Q7Cj4gKyAgICAgICB9IHR0bTsKPiArCj4gICAg
ICAgICAvKiogUmVjb3JkIG9mIGFkZHJlc3MgYml0IDE3IG9mIGVhY2ggcGFnZSBhdCBsYXN0IHVu
YmluZC4gKi8KPiAgICAgICAgIHVuc2lnbmVkIGxvbmcgKmJpdF8xNzsKPgo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcmVnaW9uLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcmVnaW9uLmMKPiBpbmRleCBmMjVlNjY0NmM1YjcuLmQx
ZjE4NDA1NDBkZCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fcmVnaW9uLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcmVn
aW9uLmMKPiBAQCAtMTgsMTEgKzE4LDcgQEAgdm9pZCBpOTE1X2dlbV9vYmplY3RfaW5pdF9tZW1v
cnlfcmVnaW9uKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4KPiAgICAgICAgIG11
dGV4X2xvY2soJm1lbS0+b2JqZWN0cy5sb2NrKTsKPgo+IC0gICAgICAgaWYgKG9iai0+ZmxhZ3Mg
JiBJOTE1X0JPX0FMTE9DX1ZPTEFUSUxFKQo+IC0gICAgICAgICAgICAgICBsaXN0X2FkZCgmb2Jq
LT5tbS5yZWdpb25fbGluaywgJm1lbS0+b2JqZWN0cy5wdXJnZWFibGUpOwo+IC0gICAgICAgZWxz
ZQo+IC0gICAgICAgICAgICAgICBsaXN0X2FkZCgmb2JqLT5tbS5yZWdpb25fbGluaywgJm1lbS0+
b2JqZWN0cy5saXN0KTsKPiAtCj4gKyAgICAgICBsaXN0X2FkZCgmb2JqLT5tbS5yZWdpb25fbGlu
aywgJm1lbS0+b2JqZWN0cy5saXN0KTsKPiAgICAgICAgIG11dGV4X3VubG9jaygmbWVtLT5vYmpl
Y3RzLmxvY2spOwo+ICB9Cj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX3R0bS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3R0bS5j
Cj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAuLjc5MGY1ZWM0NWM0
ZAo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fdHRtLmMKPiBAQCAtMCwwICsxLDUxOSBAQAo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogTUlUCj4gKy8qCj4gKyAqIENvcHlyaWdodCDCqSAyMDIxIEludGVsIENvcnBvcmF0aW9uCj4g
KyAqLwo+ICsKPiArI2luY2x1ZGUgPGRybS90dG0vdHRtX2JvX2RyaXZlci5oPgo+ICsjaW5jbHVk
ZSA8ZHJtL3R0bS90dG1fcGxhY2VtZW50Lmg+Cj4gKwo+ICsjaW5jbHVkZSAiaTkxNV9kcnYuaCIK
PiArI2luY2x1ZGUgImludGVsX21lbW9yeV9yZWdpb24uaCIKPiArI2luY2x1ZGUgImludGVsX3Jl
Z2lvbl90dG0uaCIKPiArCj4gKyNpbmNsdWRlICJnZW0vaTkxNV9nZW1fb2JqZWN0LmgiCj4gKyNp
bmNsdWRlICJnZW0vaTkxNV9nZW1fcmVnaW9uLmgiCj4gKyNpbmNsdWRlICJnZW0vaTkxNV9nZW1f
dHRtLmgiCj4gKyNpbmNsdWRlICJnZW0vaTkxNV9nZW1fdHRtX2JvX3V0aWwuaCIKPiArCj4gKyNk
ZWZpbmUgSTkxNV9QTF9MTUVNMCBUVE1fUExfUFJJVgo+ICsjZGVmaW5lIEk5MTVfUExfU1lTVEVN
IFRUTV9QTF9TWVNURU0KPiArI2RlZmluZSBJOTE1X1BMX1NUT0xFTiBUVE1fUExfVlJBTQo+ICsj
ZGVmaW5lIEk5MTVfUExfR0dUVCBUVE1fUExfVFQKPiArCj4gKyNkZWZpbmUgSTkxNV9UVE1fUFJJ
T19QVVJHRSAgICAgMAo+ICsjZGVmaW5lIEk5MTVfVFRNX1BSSU9fTk9fUEFHRVMgIDEKPiArI2Rl
ZmluZSBJOTE1X1RUTV9QUklPX0hBU19QQUdFUyAyCj4gKwo+ICsvKioKPiArICogc3RydWN0IGk5
MTVfdHRtX3R0IC0gVFRNIHBhZ2UgdmVjdG9yIHdpdGggYWRkaXRpb25hbCBwcml2YXRlIGluZm9y
bWF0aW9uCj4gKyAqIEB0dG06IFRoZSBiYXNlIFRUTSBwYWdlIHZlY3Rvci4KPiArICogQGRldjog
VGhlIHN0cnVjdCBkZXZpY2UgdXNlZCBmb3IgZG1hIG1hcHBpbmcgYW5kIHVubWFwcGluZy4KPiAr
ICogQGNhY2hlZF9zdDogVGhlIGNhY2hlZCBzY2F0dGVyLWdhdGhlciB0YWJsZS4KPiArICoKPiAr
ICogTm90ZSB0aGF0IERNQSBtYXkgYmUgZ29pbmcgb24gcmlnaHQgdXAgdG8gdGhlIHBvaW50IHdo
ZXJlIHRoZSBwYWdlLQo+ICsgKiB2ZWN0b3IgaXMgdW5wb3B1bGF0ZWQgaW4gZGVsYXllZCBkZXN0
cm95LiBIZW5jZSBrZWVwIHRoZQo+ICsgKiBzY2F0dGVyLWdhdGhlciB0YWJsZSBtYXBwZWQgYW5k
IGNhY2hlZCB1cCB0byB0aGF0IHBvaW50LiBUaGlzIGlzCj4gKyAqIGRpZmZlcmVudCBmcm9tIHRo
ZSBjYWNoZWQgZ2VtIG9iamVjdCBpbyBzY2F0dGVyLWdhdGhlciB0YWJsZSB3aGljaAo+ICsgKiBk
b2Vzbid0IGhhdmUgYW4gYXNzb2NpYXRlZCBkbWEgbWFwcGluZy4KPiArICovCj4gK3N0cnVjdCBp
OTE1X3R0bV90dCB7CgpXaGF0IGlzIHRoZSBfdHQgaGVyZSBidHc/IFRyYW5zbGF0aW9uIHRhYmxl
PyBXZSBhbHNvIGhhdmUgdXNlX3R0CmVsc2V3aGVyZS4gdHRtX3R0IGxvb2tzIGxpa2UgaXQganVz
dCBob2xkcyBhbiBhcnJheSBvZiBwYWdlcywgYW5kCmFzc29jaWF0ZWQgZGF0YT8gdHRtX3B2PwoK
PiArICAgICAgIHN0cnVjdCB0dG1fdHQgdHRtOwo+ICsgICAgICAgc3RydWN0IGRldmljZSAqZGV2
Owo+ICsgICAgICAgc3RydWN0IHNnX3RhYmxlICpjYWNoZWRfc3Q7Cj4gK307Cj4gKwo+ICtzdGF0
aWMgY29uc3Qgc3RydWN0IHR0bV9wbGFjZSBsbWVtMF9zeXNfcGxhY2VtZW50X2ZsYWdzW10gPSB7
Cj4gKyAgICAgICB7Cj4gKyAgICAgICAgICAgICAgIC5mcGZuID0gMCwKPiArICAgICAgICAgICAg
ICAgLmxwZm4gPSAwLAo+ICsgICAgICAgICAgICAgICAubWVtX3R5cGUgPSBJOTE1X1BMX0xNRU0w
LAo+ICsgICAgICAgICAgICAgICAuZmxhZ3MgPSAwLAo+ICsgICAgICAgfSwgewo+ICsgICAgICAg
ICAgICAgICAuZnBmbiA9IDAsCj4gKyAgICAgICAgICAgICAgIC5scGZuID0gMCwKPiArICAgICAg
ICAgICAgICAgLm1lbV90eXBlID0gSTkxNV9QTF9TWVNURU0sCj4gKyAgICAgICAgICAgICAgIC5m
bGFncyA9IDAsCj4gKyAgICAgICB9Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgdHRtX3BsYWNlbWVudCBp
OTE1X2xtZW0wX3BsYWNlbWVudCA9IHsKPiArICAgICAgIC5udW1fcGxhY2VtZW50ID0gMSwKPiAr
ICAgICAgIC5wbGFjZW1lbnQgPSAmbG1lbTBfc3lzX3BsYWNlbWVudF9mbGFnc1swXSwKPiArICAg
ICAgIC5udW1fYnVzeV9wbGFjZW1lbnQgPSAxLAo+ICsgICAgICAgLmJ1c3lfcGxhY2VtZW50ID0g
JmxtZW0wX3N5c19wbGFjZW1lbnRfZmxhZ3NbMF0sCj4gK307Cj4gKwo+ICtzdHJ1Y3QgdHRtX3Bs
YWNlbWVudCBpOTE1X2xtZW0wX3N5c19wbGFjZW1lbnQgPSB7Cj4gKyAgICAgICAubnVtX3BsYWNl
bWVudCA9IDEsCj4gKyAgICAgICAucGxhY2VtZW50ID0gJmxtZW0wX3N5c19wbGFjZW1lbnRfZmxh
Z3NbMF0sCj4gKyAgICAgICAubnVtX2J1c3lfcGxhY2VtZW50ID0gMiwKPiArICAgICAgIC5idXN5
X3BsYWNlbWVudCA9ICZsbWVtMF9zeXNfcGxhY2VtZW50X2ZsYWdzWzBdLAo+ICt9Owo+ICsKPiAr
c3RydWN0IHR0bV9wbGFjZW1lbnQgaTkxNV9zeXNfcGxhY2VtZW50ID0gewo+ICsgICAgICAgLm51
bV9wbGFjZW1lbnQgPSAxLAo+ICsgICAgICAgLnBsYWNlbWVudCA9ICZsbWVtMF9zeXNfcGxhY2Vt
ZW50X2ZsYWdzWzFdLAo+ICsgICAgICAgLm51bV9idXN5X3BsYWNlbWVudCA9IDEsCj4gKyAgICAg
ICAuYnVzeV9wbGFjZW1lbnQgPSAmbG1lbTBfc3lzX3BsYWNlbWVudF9mbGFnc1sxXSwKPiArfTsK
PiArCj4gK3N0YXRpYyB2b2lkIGk5MTVfdHRtX2FkanVzdF9scnUoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaik7Cj4gKwo+ICtzdGF0aWMgc3RydWN0IHR0bV90dCAqaTkxNV90dG1fdHRf
Y3JlYXRlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBwYWdlX2ZsYWdzKQo+ICt7Cj4gKyAgICAg
ICBzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9Cj4gKyAgICAgICAgICAgICAgIHR0
bV9tYW5hZ2VyX3R5cGUoYm8tPmJkZXYsIGJvLT5tZW0ubWVtX3R5cGUpOwo+ICsgICAgICAgc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGk5MTVfdHRtX3RvX2dlbShibyk7Cj4gKyAg
ICAgICBzdHJ1Y3QgaTkxNV90dG1fdHQgKmk5MTVfdHQ7Cj4gKyAgICAgICBpbnQgcmV0Owo+ICsK
PiArICAgICAgIGk5MTVfdHQgPSBremFsbG9jKHNpemVvZigqaTkxNV90dCksIEdGUF9LRVJORUwp
Owo+ICsgICAgICAgaWYgKCFpOTE1X3R0KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gTlVMTDsK
PiArCj4gKyAgICAgICBpZiAob2JqLT5mbGFncyAmIEk5MTVfQk9fQUxMT0NfQ1BVX0NMRUFSICYm
Cj4gKyAgICAgICAgICAgbWFuLT51c2VfdHQpCj4gKyAgICAgICAgICAgICAgIHBhZ2VfZmxhZ3Mg
fD0gVFRNX1BBR0VfRkxBR19aRVJPX0FMTE9DOwo+ICsKPiArICAgICAgIHJldCA9IHR0bV90dF9p
bml0KCZpOTE1X3R0LT50dG0sIGJvLCBwYWdlX2ZsYWdzLCB0dG1fY2FjaGVkKTsKPiArICAgICAg
IGlmIChyZXQpIHsKPiArICAgICAgICAgICAgICAga2ZyZWUoaTkxNV90dCk7Cj4gKyAgICAgICAg
ICAgICAgIHJldHVybiBOVUxMOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGk5MTVfdHQtPmRl
diA9IG9iai0+YmFzZS5kZXYtPmRldjsKPiArCj4gKyAgICAgICByZXR1cm4gJmk5MTVfdHQtPnR0
bTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaTkxNV90dG1fdHRfdW5wb3B1bGF0ZShzdHJ1Y3Qg
dHRtX2RldmljZSAqYmRldiwgc3RydWN0IHR0bV90dCAqdHRtKQo+ICt7Cj4gKyAgICAgICBzdHJ1
Y3QgaTkxNV90dG1fdHQgKmk5MTVfdHQgPSBjb250YWluZXJfb2YodHRtLCB0eXBlb2YoKmk5MTVf
dHQpLCB0dG0pOwo+ICsKPiArICAgICAgIGlmIChpOTE1X3R0LT5jYWNoZWRfc3QpIHsKPiArICAg
ICAgICAgICAgICAgZG1hX3VubWFwX3NndGFibGUoaTkxNV90dC0+ZGV2LCBpOTE1X3R0LT5jYWNo
ZWRfc3QsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERNQV9CSURJUkVDVElP
TkFMLCAwKTsKPiArICAgICAgICAgICAgICAgc2dfZnJlZV90YWJsZShpOTE1X3R0LT5jYWNoZWRf
c3QpOwo+ICsgICAgICAgICAgICAgICBrZnJlZShpOTE1X3R0LT5jYWNoZWRfc3QpOwo+ICsgICAg
ICAgICAgICAgICBpOTE1X3R0LT5jYWNoZWRfc3QgPSBOVUxMOwo+ICsgICAgICAgfQo+ICsgICAg
ICAgdHRtX3Bvb2xfZnJlZSgmYmRldi0+cG9vbCwgdHRtKTsKPiArfQo+ICsKPiArc3RhdGljIHZv
aWQgaTkxNV90dG1fdHRfZGVzdHJveShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwgc3RydWN0IHR0
bV90dCAqdHRtKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgaTkxNV90dG1fdHQgKmk5MTVfdHQgPSBj
b250YWluZXJfb2YodHRtLCB0eXBlb2YoKmk5MTVfdHQpLCB0dG0pOwo+ICsKPiArICAgICAgIHR0
bV90dF9kZXN0cm95X2NvbW1vbihiZGV2LCB0dG0pOwo+ICsgICAgICAga2ZyZWUoaTkxNV90dCk7
Cj4gK30KPiArCj4gK3N0YXRpYyBib29sIGk5MTVfdHRtX2V2aWN0aW9uX3ZhbHVhYmxlKHN0cnVj
dCB0dG1fYnVmZmVyX29iamVjdCAqYm8sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3Qgc3RydWN0IHR0bV9wbGFjZSAqcGxhY2UpCj4gK3sKPiArICAgICAgIHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBpOTE1X3R0bV90b19nZW0oYm8pOwo+ICsK
PiArICAgICAgIC8qIFdpbGwgZG8gZm9yIG5vdy4gT3VyIHBpbm5lZCBvYmplY3RzIGFyZSBzdGls
bCBvbiBUVE0ncyBMUlUgbGlzdHMgKi8KPiArICAgICAgIGlmICghaTkxNV9nZW1fb2JqZWN0X2V2
aWN0YWJsZShvYmopKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7Cj4gKwo+ICsgICAg
ICAgLyogVGhpcyBpc24ndCB2YWxpZCB3aXRoIGEgYnVkZHkgYWxsb2NhdG9yICovCj4gKyAgICAg
ICByZXR1cm4gdHRtX2JvX2V2aWN0aW9uX3ZhbHVhYmxlKGJvLCBwbGFjZSk7Cj4gK30KPiArCj4g
K3N0YXRpYyB2b2lkIGk5MTVfdHRtX2V2aWN0X2ZsYWdzKHN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCAqYm8sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHR0bV9wbGFj
ZW1lbnQgKnBsYWNlbWVudCkKPiArewo+ICsgICAgICAgKnBsYWNlbWVudCA9IGk5MTVfc3lzX3Bs
YWNlbWVudDsKCldoYXQncyB0aGUgc3RvcnkgaGVyZT8KCj4gK30KPiArCj4gK3N0YXRpYyBpbnQg
aTkxNV90dG1fbW92ZV9ub3RpZnkoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKPiArewo+
ICsgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGk5MTVfdHRtX3RvX2dl
bShibyk7Cj4gKyAgICAgICBpbnQgcmV0Owo+ICsKPiArICAgICAgIHJldCA9IGk5MTVfZ2VtX29i
amVjdF91bmJpbmQob2JqLCBJOTE1X0dFTV9PQkpFQ1RfVU5CSU5EX0FDVElWRSk7Cj4gKyAgICAg
ICBpZiAocmV0KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ICsKPiArICAgICAgIHJl
dCA9IF9faTkxNV9nZW1fb2JqZWN0X3B1dF9wYWdlcyhvYmopOwo+ICsgICAgICAgaWYgKHJldCkK
PiArICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiAr
fQo+ICsKPiArc3RhdGljIHZvaWQgaTkxNV90dG1fZnJlZV9jYWNoZWRfaW9fc3Qoc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiArewo+ICsgICAgICAgaWYgKG9iai0+dHRtLmNhY2hl
ZF9pb19zdCkgewo+ICsgICAgICAgICAgICAgICBzZ19mcmVlX3RhYmxlKG9iai0+dHRtLmNhY2hl
ZF9pb19zdCk7Cj4gKyAgICAgICAgICAgICAgIGtmcmVlKG9iai0+dHRtLmNhY2hlZF9pb19zdCk7
Cj4gKyAgICAgICAgICAgICAgIG9iai0+dHRtLmNhY2hlZF9pb19zdCA9IE5VTEw7Cj4gKyAgICAg
ICB9Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGk5MTVfdHRtX3B1cmdlKHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmopCj4gK3sKPiArICAgICAgIHN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCAqYm8gPSBpOTE1X2dlbV90b190dG0ob2JqKTsKPiArCj4gKyAgICAgICBpZiAob2JqLT5tbS5t
YWR2ID09IF9fSTkxNV9NQURWX1BVUkdFRCkKPiArICAgICAgICAgICAgICAgcmV0dXJuOwo+ICsK
PiArICAgICAgIGk5MTVfdHRtX2ZyZWVfY2FjaGVkX2lvX3N0KG9iaik7Cj4gKwo+ICsgICAgICAg
dHRtX3Jlc291cmNlX2ZyZWUoYm8sICZiby0+bWVtKTsKPiArICAgICAgIGlmIChiby0+dHRtKSB7
Cj4gKyAgICAgICAgICAgICAgIHR0bV90dF91bnBvcHVsYXRlKGJvLT5iZGV2LCBiby0+dHRtKTsK
PiArICAgICAgICAgICAgICAgYm8tPnR0bS0+cGFnZV9mbGFncyB8PSBUVE1fUEFHRV9GTEFHX1pF
Uk9fQUxMT0M7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgb2JqLT5tbS5tYWR2ID0gX19JOTE1
X01BRFZfUFVSR0VEOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBpOTE1X3R0bV9zd2FwX25vdGlm
eShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqID0gaTkxNV90dG1fdG9fZ2VtKGJvKTsKPiArICAgICAgIGlu
dCByZXQgPSBpOTE1X3R0bV9tb3ZlX25vdGlmeShibyk7Cj4gKwo+ICsgICAgICAgR0VNX1dBUk5f
T04ocmV0KTsKPiArICAgICAgIEdFTV9XQVJOX09OKG9iai0+dHRtLmNhY2hlZF9pb19zdCk7Cj4g
KyAgICAgICBpZiAoIXJldCAmJiBvYmotPm1tLm1hZHYgIT0gSTkxNV9NQURWX1dJTExORUVEKQo+
ICsgICAgICAgICAgICAgICBpOTE1X3R0bV9wdXJnZShvYmopOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
dm9pZCBpOTE1X3R0bV9kZWxldGVfbWVtX25vdGlmeShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
KmJvKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gaTkx
NV90dG1fdG9fZ2VtKGJvKTsKPiArCj4gKyAgICAgICBpZiAobGlrZWx5KG9iaikpIHsKPiArICAg
ICAgICAgICAgICAgLyogVGhpcyByZWxlYXNlcyBhbGwgZ2VtIG9iamVjdCBiaW5kaW5ncyB0byB0
aGUgYmFja2VuZC4gKi8KPiArICAgICAgICAgICAgICAgX19pOTE1X2dlbV9mcmVlX29iamVjdChv
YmopOwo+ICsgICAgICAgfQo+ICt9Cj4gKwo+ICtzdGF0aWMgc3RydWN0IGludGVsX21lbW9yeV9y
ZWdpb24gKgo+ICtpOTE1X3R0bV9yZWdpb24oc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIGludCB0
dG1fbWVtX3R5cGUpCj4gK3sKPiArICAgICAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gY29udGFpbmVyX29mKGJkZXYsIHR5cGVvZigqaTkxNSksIGJkZXYpOwo+ICsKPiArICAgICAg
IC8qIFRoZXJlJ3Mgc29tZSByb29tIGZvciBvcHRpbWl6YXRpb24gaGVyZS4uLiAqLwo+ICsgICAg
ICAgR0VNX0JVR19PTih0dG1fbWVtX3R5cGUgIT0gSTkxNV9QTF9TWVNURU0gJiYKPiArICAgICAg
ICAgICAgICAgICAgdHRtX21lbV90eXBlIDwgSTkxNV9QTF9MTUVNMCk7Cj4gKyAgICAgICBpZiAo
dHRtX21lbV90eXBlID09IEk5MTVfUExfU1lTVEVNKQo+ICsgICAgICAgICAgICAgICByZXR1cm4g
aW50ZWxfbWVtb3J5X3JlZ2lvbl9sb29rdXAoaTkxNSwgSU5URUxfTUVNT1JZX1NZU1RFTSwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDApOwoKU28g
YXQgdGhlIG1vbWVudCB3ZSBqdXN0IGhhdmUgbG1lbSB1c2luZyB0aGUgbmV3IHR0bSBiYWNrZW5k
LCByaWdodD8KU3RvbGVuIGFuZCBzeXN0ZW0gYXJlIHVuY2hhbmdlZD8KCj4gKwo+ICsgICAgICAg
cmV0dXJuIGludGVsX21lbW9yeV9yZWdpb25fbG9va3VwKGk5MTUsIElOVEVMX01FTU9SWV9MT0NB
TCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0dG1fbWVtX3R5
cGUgLSBJOTE1X1BMX0xNRU0wKTsKPiArfQo+ICsKPiArc3RhdGljIHN0cnVjdCBzZ190YWJsZSAq
aTkxNV90dG1fdHRfZ2V0X3N0KHN0cnVjdCB0dG1fdHQgKnR0bSkKPiArewo+ICsgICAgICAgc3Ry
dWN0IGk5MTVfdHRtX3R0ICppOTE1X3R0ID0gY29udGFpbmVyX29mKHR0bSwgdHlwZW9mKCppOTE1
X3R0KSwgdHRtKTsKPiArICAgICAgIHN0cnVjdCBzY2F0dGVybGlzdCAqc2c7Cj4gKyAgICAgICBz
dHJ1Y3Qgc2dfdGFibGUgKnN0Owo+ICsgICAgICAgaW50IHJldDsKPiArCj4gKyAgICAgICBpZiAo
aTkxNV90dC0+Y2FjaGVkX3N0KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gaTkxNV90dC0+Y2Fj
aGVkX3N0Owo+ICsKPiArICAgICAgIHN0ID0ga3phbGxvYyhzaXplb2YoKnN0KSwgR0ZQX0tFUk5F
TCk7Cj4gKyAgICAgICBpZiAoIXN0KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigt
RU5PTUVNKTsKPiArCj4gKyAgICAgICBzZyA9IF9fc2dfYWxsb2NfdGFibGVfZnJvbV9wYWdlcwo+
ICsgICAgICAgICAgICAgICAoc3QsIHR0bS0+cGFnZXMsIHR0bS0+bnVtX3BhZ2VzLCAwLAo+ICsg
ICAgICAgICAgICAgICAgKHVuc2lnbmVkIGxvbmcpdHRtLT5udW1fcGFnZXMgPDwgUEFHRV9TSElG
VCwKPiArICAgICAgICAgICAgICAgIGk5MTVfc2dfc2VnbWVudF9zaXplKCksIE5VTEwsIDAsIEdG
UF9LRVJORUwpOwo+ICsgICAgICAgaWYgKElTX0VSUihzZykpIHsKPiArICAgICAgICAgICAgICAg
a2ZyZWUoc3QpOwo+ICsgICAgICAgICAgICAgICByZXR1cm4gRVJSX0NBU1Qoc2cpOwo+ICsgICAg
ICAgfQo+ICsKPiArICAgICAgIHJldCA9IGRtYV9tYXBfc2d0YWJsZShpOTE1X3R0LT5kZXYsIHN0
LCBETUFfQklESVJFQ1RJT05BTCwgMCk7Cj4gKyAgICAgICBpZiAocmV0KSB7Cj4gKyAgICAgICAg
ICAgICAgIHNnX2ZyZWVfdGFibGUoc3QpOwo+ICsgICAgICAgICAgICAgICBrZnJlZShzdCk7Cj4g
KyAgICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKHJldCk7Cj4gKyAgICAgICB9Cj4gKwo+ICsg
ICAgICAgaTkxNV90dC0+Y2FjaGVkX3N0ID0gc3Q7Cj4gKyAgICAgICByZXR1cm4gc3Q7Cj4gK30K
PiArCj4gK3N0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKgo+ICtpOTE1X3R0bV9yZXNvdXJjZV9nZXRf
c3Qoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IHR0bV9yZXNvdXJjZSAqcmVzKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgdHRt
X2J1ZmZlcl9vYmplY3QgKmJvID0gaTkxNV9nZW1fdG9fdHRtKG9iaik7Cj4gKyAgICAgICBzdHJ1
Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9Cj4gKyAgICAgICAgICAgICAgIHR0bV9tYW5h
Z2VyX3R5cGUoYm8tPmJkZXYsIHJlcy0+bWVtX3R5cGUpOwo+ICsKPiArICAgICAgIGlmIChtYW4t
PnVzZV90dCkKPiArICAgICAgICAgICAgICAgcmV0dXJuIGk5MTVfdHRtX3R0X2dldF9zdChiby0+
dHRtKTsKPiArCj4gKyAgICAgICByZXR1cm4gaW50ZWxfcmVnaW9uX3R0bV9ub2RlX3RvX3N0KG9i
ai0+bW0ucmVnaW9uLCByZXMtPm1tX25vZGUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGk5MTVf
dHRtX21vdmUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywgYm9vbCBldmljdCwKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4ICpjdHgsCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0dG1fcmVzb3VyY2UgKm5ld19tZW0sCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0dG1fcGxhY2UgKmhvcCkKPiArewo+ICsgICAg
ICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGk5MTVfdHRtX3RvX2dlbShibyk7
Cj4gKyAgICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm5ld19tYW4gPQo+ICsgICAg
ICAgICAgICAgICB0dG1fbWFuYWdlcl90eXBlKGJvLT5iZGV2LCBuZXdfbWVtLT5tZW1fdHlwZSk7
Cj4gKyAgICAgICBzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm9sZF9tYW4gPQo+ICsgICAg
ICAgICAgICAgICB0dG1fbWFuYWdlcl90eXBlKGJvLT5iZGV2LCBiby0+bWVtLm1lbV90eXBlKTsK
PiArICAgICAgIHN0cnVjdCBpbnRlbF9tZW1vcnlfcmVnaW9uICpuZXdfcmVnLCAqb2xkX3JlZzsK
PiArICAgICAgIHVuaW9uIHsKPiArICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfdHRtX2ttYXBf
aXRlcl90dCB0dDsKPiArICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfdHRtX2ttYXBfaXRlcl9p
b21hcCBpbzsKPiArICAgICAgIH0gX25ld19pdGVyLCBfb2xkX2l0ZXI7Cj4gKyAgICAgICBzdHJ1
Y3QgaTkxNV90dG1fa21hcF9pdGVyICpuZXdfaXRlciwgKm9sZF9pdGVyOwo+ICsgICAgICAgc3Ry
dWN0IHNnX3RhYmxlICpuZXdfc3Q7Cj4gKyAgICAgICBpbnQgcmV0Owo+ICsKPiArICAgICAgIG5l
d19yZWcgPSBpOTE1X3R0bV9yZWdpb24oYm8tPmJkZXYsIG5ld19tZW0tPm1lbV90eXBlKTsKPiAr
ICAgICAgIG9sZF9yZWcgPSBpOTE1X3R0bV9yZWdpb24oYm8tPmJkZXYsIGJvLT5tZW0ubWVtX3R5
cGUpOwo+ICsgICAgICAgR0VNX0JVR19PTighbmV3X3JlZyB8fCAhb2xkX3JlZyk7Cj4gKwo+ICsg
ICAgICAgLyogU3luYyBmb3Igbm93LiBXZSBjb3VsZCBkbyB0aGUgYWN0dWFsIGNvcHkgYXN5bmMu
ICovCj4gKyAgICAgICByZXQgPSB0dG1fYm9fd2FpdF9jdHgoYm8sIGN0eCk7Cj4gKyAgICAgICBp
ZiAocmV0KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ICsKPiArICAgICAgIHJldCA9
IGk5MTVfdHRtX21vdmVfbm90aWZ5KGJvKTsKPiArICAgICAgIGlmIChyZXQpCj4gKyAgICAgICAg
ICAgICAgIHJldHVybiByZXQ7Cj4gKwo+ICsgICAgICAgaWYgKG9iai0+bW0ubWFkdiAhPSBJOTE1
X01BRFZfV0lMTE5FRUQpIHsKPiArICAgICAgICAgICAgICAgaTkxNV90dG1fcHVyZ2Uob2JqKTsK
PiArICAgICAgICAgICAgICAgdHRtX3Jlc291cmNlX2ZyZWUoYm8sIG5ld19tZW0pOwo+ICsgICAg
ICAgICAgICAgICByZXR1cm4gMDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICAvKiBQb3B1bGF0
ZSB0dG0gd2l0aCBwYWdlcyBpZiBuZWVkZWQuIFR5cGljYWxseSBzeXN0ZW0gbWVtb3J5LiAqLwo+
ICsgICAgICAgaWYgKG5ld19tYW4tPnVzZV90dCAmJiBiby0+dHRtKSB7Cj4gKyAgICAgICAgICAg
ICAgIHJldCA9IHR0bV90dF9wb3B1bGF0ZShiby0+YmRldiwgYm8tPnR0bSwgY3R4KTsKPiArICAg
ICAgICAgICAgICAgaWYgKHJldCkKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0
Owo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIG5ld19zdCA9IGk5MTVfdHRtX3Jlc291cmNlX2dl
dF9zdChvYmosIG5ld19tZW0pOwo+ICsgICAgICAgaWYgKElTX0VSUihuZXdfc3QpKQo+ICsgICAg
ICAgICAgICAgICByZXR1cm4gUFRSX0VSUihuZXdfc3QpOwo+ICsKPiArICAgICAgIG5ld19pdGVy
ID0gbmV3X21hbi0+dXNlX3R0ID8KPiArICAgICAgICAgICAgICAgaTkxNV90dG1fa21hcF9pdGVy
X3R0X2luaXQoJl9uZXdfaXRlci50dCwgYm8tPnR0bSkgOgo+ICsgICAgICAgICAgICAgICBpOTE1
X3R0bV9rbWFwX2l0ZXJfaW9tYXBfaW5pdCgmX25ld19pdGVyLmlvLCAmbmV3X3JlZy0+aW9tYXAs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld19zdCwg
bmV3X3JlZy0+cmVnaW9uLnN0YXJ0KTsKPiArCj4gKyAgICAgICBvbGRfaXRlciA9IG9sZF9tYW4t
PnVzZV90dCA/Cj4gKyAgICAgICAgICAgICAgIGk5MTVfdHRtX2ttYXBfaXRlcl90dF9pbml0KCZf
b2xkX2l0ZXIudHQsIGJvLT50dG0pIDoKPiArICAgICAgICAgICAgICAgaTkxNV90dG1fa21hcF9p
dGVyX2lvbWFwX2luaXQoJl9vbGRfaXRlci5pbywgJm9sZF9yZWctPmlvbWFwLAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmotPnR0bS5jYWNoZWRfaW9f
c3QsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZF9y
ZWctPnJlZ2lvbi5zdGFydCk7Cj4gKwo+ICsgICAgICAgaTkxNV90dG1fbW92ZV9tZW1jcHkoYm8s
IG5ld19tZW0sIG5ld19pdGVyLCBvbGRfaXRlcik7Cj4gKyAgICAgICBpOTE1X3R0bV9mcmVlX2Nh
Y2hlZF9pb19zdChvYmopOwo+ICsKPiArICAgICAgIGlmICghbmV3X21hbi0+dXNlX3R0KQo+ICsg
ICAgICAgICAgICAgICBvYmotPnR0bS5jYWNoZWRfaW9fc3QgPSBuZXdfc3Q7Cj4gKwo+ICsgICAg
ICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0cnVjdCB0dG1fZGV2aWNlX2Z1bmNzIGk5MTVfdHRt
X2JvX2RyaXZlciA9IHsKPiArICAgICAgIC50dG1fdHRfY3JlYXRlID0gaTkxNV90dG1fdHRfY3Jl
YXRlLAo+ICsgICAgICAgLnR0bV90dF91bnBvcHVsYXRlID0gaTkxNV90dG1fdHRfdW5wb3B1bGF0
ZSwKPiArICAgICAgIC50dG1fdHRfZGVzdHJveSA9IGk5MTVfdHRtX3R0X2Rlc3Ryb3ksCj4gKyAg
ICAgICAuZXZpY3Rpb25fdmFsdWFibGUgPSBpOTE1X3R0bV9ldmljdGlvbl92YWx1YWJsZSwKPiAr
ICAgICAgIC5ldmljdF9mbGFncyA9IGk5MTVfdHRtX2V2aWN0X2ZsYWdzLAo+ICsgICAgICAgLm1v
dmUgPSBpOTE1X3R0bV9tb3ZlLAo+ICsgICAgICAgLnZlcmlmeV9hY2Nlc3MgPSBOVUxMLAo+ICsg
ICAgICAgLnN3YXBfbm90aWZ5ID0gaTkxNV90dG1fc3dhcF9ub3RpZnksCj4gKyAgICAgICAuZGVs
ZXRlX21lbV9ub3RpZnkgPSBpOTE1X3R0bV9kZWxldGVfbWVtX25vdGlmeSwKPiArfTsKPiArCj4g
K3N0YXRpYyBpbnQgaTkxNV90dG1fZ2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmopCj4gK3sKPiArICAgICAgIHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8gPSBpOTE1
X2dlbV90b190dG0ob2JqKTsKPiArICAgICAgIHN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCBjdHgg
PSB7Cj4gKyAgICAgICAgICAgICAgIC5pbnRlcnJ1cHRpYmxlID0gdHJ1ZSwKPiArICAgICAgICAg
ICAgICAgLm5vX3dhaXRfZ3B1ID0gZmFsc2UsCj4gKyAgICAgICB9Owo+ICsgICAgICAgc3RydWN0
IHNnX3RhYmxlICpzdDsKPiArICAgICAgIGludCByZXQ7Cj4gKwo+ICsgICAgICAgLyogU3dhcCBp
bi4gKi8KPiArICAgICAgIGlmIChiby0+dHRtICYmIChiby0+dHRtLT5wYWdlX2ZsYWdzICYgVFRN
X1BBR0VfRkxBR19TV0FQUEVEKSkgewo+ICsgICAgICAgICAgICAgICByZXQgPSB0dG1fdHRfcG9w
dWxhdGUoYm8tPmJkZXYsIGJvLT50dG0sICZjdHgpOwo+ICsgICAgICAgICAgICAgICBpZiAocmV0
KQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4gKyAgICAgICB9Cj4gKwo+
ICsgICAgICAgLyogTW92ZSB0byB0aGUgcmVxdWVzdGVkIHBsYWNlbWVudC4gKi8KPiArICAgICAg
IHJldCA9IHR0bV9ib192YWxpZGF0ZShibywgJmk5MTVfbG1lbTBfcGxhY2VtZW50LCAmY3R4KTsK
PiArICAgICAgIGlmIChyZXQpCj4gKyAgICAgICAgICAgICAgIHJldHVybiByZXQgPT0gLUVOT1NQ
QyA/IC1FTlhJTyA6IHJldDsKPiArCj4gKyAgICAgICAvKiBPYmplY3QgZWl0aGVyIGhhcyBhIHBh
Z2UgdmVjdG9yIG9yIGlzIGFuIGlvbWVtIG9iamVjdCAqLwo+ICsgICAgICAgc3QgPSBiby0+dHRt
ID8gaTkxNV90dG1fdHRfZ2V0X3N0KGJvLT50dG0pIDogb2JqLT50dG0uY2FjaGVkX2lvX3N0Owo+
ICsgICAgICAgaWYgKElTX0VSUihzdCkpCj4gKyAgICAgICAgICAgICAgIHJldHVybiBQVFJfRVJS
KHN0KTsKPiArCj4gKyAgICAgICBfX2k5MTVfZ2VtX29iamVjdF9zZXRfcGFnZXMob2JqLCBzdCwg
aTkxNV9zZ19kbWFfc2l6ZXMoc3QtPnNnbCkpOwo+ICsKPiArICAgICAgIGk5MTVfdHRtX2FkanVz
dF9scnUob2JqKTsKPiArCj4gKyAgICAgICByZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtzdGF0aWMg
dm9pZCBpOTE1X3R0bV9wdXRfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNnX3RhYmxlICpzdCkKPiAr
ewo+ICsgICAgICAgLyoKPiArICAgICAgICAqIFdlJ3JlIGN1cnJlbnRseSBub3QgY2FsbGVkIGZy
b20gYSBzaHJpbmtlciwgc28gcHV0X3BhZ2VzKCkKPiArICAgICAgICAqIHR5cGljYWxseSBtZWFu
cyB0aGUgb2JqZWN0IGlzIGFib3V0IHRvIGRlc3Ryb3llZCwgb3IgY2FsbGVkCj4gKyAgICAgICAg
KiBmcm9tIG1vdmVfbm90aWZ5KCkuIFNvIGp1c3QgYXZvaWQgZG9pbmcgbXVjaCBmb3Igbm93Lgo+
ICsgICAgICAgICogSWYgdGhlIG9iamVjdCBpcyBub3QgZGVzdHJveWVkIG5leHQsIFRoZSBUVE0g
ZXZpY3Rpb24gbG9naWMKPiArICAgICAgICAqIGFuZCBzaHJpbmtlcnMgd2lsbCBtb3ZlIGl0IG91
dCBpZiBuZWVkZWQuCj4gKyAgICAgICAgKi8KPiArCj4gKyAgICAgICBpOTE1X3R0bV9hZGp1c3Rf
bHJ1KG9iaik7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGk5MTVfdHRtX2FkanVzdF9scnUoc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiArewo+ICsgICAgICAgc3RydWN0IHR0bV9i
dWZmZXJfb2JqZWN0ICpibyA9IGk5MTVfZ2VtX3RvX3R0bShvYmopOwo+ICsKPiArICAgICAgIC8q
Cj4gKyAgICAgICAgKiBEb24ndCBtYW5pcHVsYXRlIHRoZSBUVE0gTFJVcyB3aGlsZSBpbiBUVE0g
Ym8gZGVzdHJ1Y3Rpb24uCj4gKyAgICAgICAgKiBXZSdyZSBjYWxsZWQgdGhyb3VnaCBpOTE1X3R0
bV9kZWxldGVfbWVtX25vdGlmeSgpLgo+ICsgICAgICAgICovCj4gKyAgICAgICBpZiAoIWtyZWZf
cmVhZCgmYm8tPmtyZWYpKQo+ICsgICAgICAgICAgICAgICByZXR1cm47Cj4gKwo+ICsgICAgICAg
LyoKPiArICAgICAgICAqIFB1dCBvbiB0aGUgY29ycmVjdCBMUlUgbGlzdCBkZXBlbmRpbmcgb24g
dGhlIE1BRFYgc3RhdHVzCj4gKyAgICAgICAgKi8KPiArICAgICAgIHNwaW5fbG9jaygmYm8tPmJk
ZXYtPmxydV9sb2NrKTsKPiArICAgICAgIGlmIChvYmotPm1tLm1hZHYgIT0gSTkxNV9NQURWX1dJ
TExORUVEKSB7Cj4gKyAgICAgICAgICAgICAgIGJvLT5wcmlvcml0eSA9IEk5MTVfVFRNX1BSSU9f
UFVSR0U7Cj4gKyAgICAgICB9IGVsc2UgaWYgKCFpOTE1X2dlbV9vYmplY3RfaGFzX3BhZ2VzKG9i
aikpIHsKPiArICAgICAgICAgICAgICAgaWYgKGJvLT5wcmlvcml0eSA8IEk5MTVfVFRNX1BSSU9f
SEFTX1BBR0VTKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGJvLT5wcmlvcml0eSA9IEk5MTVf
VFRNX1BSSU9fSEFTX1BBR0VTOwo+ICsgICAgICAgfSBlbHNlIHsKPiArICAgICAgICAgICAgICAg
aWYgKGJvLT5wcmlvcml0eSA+IEk5MTVfVFRNX1BSSU9fTk9fUEFHRVMpCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgYm8tPnByaW9yaXR5ID0gSTkxNV9UVE1fUFJJT19OT19QQUdFUzsKPiArICAg
ICAgIH0KPiArCj4gKyAgICAgICB0dG1fYm9fbW92ZV90b19scnVfdGFpbChibywgJmJvLT5tZW0s
IE5VTEwpOwo+ICsgICAgICAgc3Bpbl91bmxvY2soJmJvLT5iZGV2LT5scnVfbG9jayk7Cj4gK30K
PiArCj4gKy8qCj4gKyAqIFRUTS1iYWNrZWQgZ2VtIG9iamVjdCBkZXN0cnVjdGlvbiByZXF1aXJl
cyBzb21lIGNsYXJpZmljYXRpb24uCj4gKyAqIEJhc2ljYWxseSB3ZSBoYXZlIHR3byBwb3NzaWJp
bGl0aWVzIGhlcmUuIFdlIGNhbiBlaXRoZXIgcmVseSBvbiB0aGUKPiArICogaTkxNSBkZWxheWVk
IGRlc3RydWN0aW9uIGFuZCBwdXQgdGhlIFRUTSBvYmplY3Qgd2hlbiB0aGUgb2JqZWN0Cj4gKyAq
IGlzIGlkbGUuIFRoaXMgd291bGQgYmUgZGV0ZWN0ZWQgYnkgVFRNIHdoaWNoIHdvdWxkIGJ5cGFz
cyB0aGUKPiArICogVFRNIGRlbGF5ZWQgZGVzdHJveSBoYW5kbGluZy4gVGhlIG90aGVyIGFwcHJv
YWNoIGlzIHRvIHB1dCB0aGUgVFRNCj4gKyAqIG9iamVjdCBlYXJseSBhbmQgcmVseSBvbiB0aGUg
VFRNIGRlc3Ryb3llZCBoYW5kbGluZywgYW5kIHRoZW4gZnJlZQo+ICsgKiB0aGUgbGVmdG92ZXIg
cGFydHMgb2YgdGhlIEdFTSBvYmplY3Qgb25jZSBUVE0ncyBkZXN0cm95ZWQgbGlzdCBoYW5kbGlu
ZyBpcwo+ICsgKiBjb21wbGV0ZS4gRm9yIG5vdywgd2UgcmVseSBvbiB0aGUgbGF0dGVyIGZvciB0
d28gcmVhc29uczoKPiArICogYSkgVFRNIGNhbiBldmljdCBhbiBvYmplY3QgZXZlbiB3aGVuIGl0
J3Mgb24gdGhlIGRlbGF5ZWQgZGVzdHJveSBsaXN0LAo+ICsgKiB3aGljaCBpbiB0aGVvcnkgYWxs
b3dzIGZvciBjb21wbGV0ZSBldmljdGlvbi4KPiArICogYikgVGhlcmUgaXMgd29yayBnb2luZyBv
biBpbiBUVE0gdG8gYWxsb3cgZnJlZWluZyBhbiBvYmplY3QgZXZlbiB3aGVuCj4gKyAqIGl0J3Mg
bm90IGlkbGUsIGFuZCB1c2luZyB0aGUgVFRNIGRlc3Ryb3llZCBsaXN0IGhhbmRsaW5nIGNvdWxk
IGhlbHAgdXMKPiArICogYmVuZWZpdCBmcm9tIHRoYXQuCj4gKyAqLwo+ICtzdGF0aWMgdm9pZCBp
OTE1X3R0bV9kZWxheWVkX2ZyZWUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiAr
ewo+ICsgICAgICAgdHRtX2JvX3B1dChpOTE1X2dlbV90b190dG0ob2JqKSk7Cj4gK30KPiArCj4g
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdF9vcHMgaTkxNV9nZW1fdHRt
X29ial9vcHMgPSB7Cj4gKyAgICAgICAubmFtZSA9ICJpOTE1X2dlbV9vYmplY3RfdHRtIiwKPiAr
ICAgICAgIC5mbGFncyA9IEk5MTVfR0VNX09CSkVDVF9IQVNfSU9NRU0sCj4gKwo+ICsgICAgICAg
LmdldF9wYWdlcyA9IGk5MTVfdHRtX2dldF9wYWdlcywKPiArICAgICAgIC5wdXRfcGFnZXMgPSBp
OTE1X3R0bV9wdXRfcGFnZXMsCj4gKyAgICAgICAudHJ1bmNhdGUgPSBpOTE1X3R0bV9wdXJnZSwK
PiArICAgICAgIC5hZGp1c3RfbHJ1ID0gaTkxNV90dG1fYWRqdXN0X2xydSwKPiArICAgICAgIC5k
ZWxheWVkX2ZyZWUgPSBpOTE1X3R0bV9kZWxheWVkX2ZyZWUsCj4gK307Cj4gKwo+ICt2b2lkIGk5
MTVfdHRtX2JvX2Rlc3Ryb3koc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibykKPiArewo+ICsg
ICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IGk5MTVfdHRtX3RvX2dlbShi
byk7Cj4gKwo+ICsgICAgICAgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbWVtb3J5X3JlZ2lvbihv
YmopOwo+ICsgICAgICAgY2FsbF9yY3UoJm9iai0+cmN1LCBfX2k5MTVfZ2VtX2ZyZWVfb2JqZWN0
X3JjdSk7Cj4gK30KPiArCj4gKy8qKgo+ICsgKiBfX2k5MTVfZ2VtX3R0bV9vYmplY3RfaW5pdCAt
IEluaXRpYWxpemUgYSB0dG0tYmFja2VkIGk5MTUgZ2VtIG9iamVjdAo+ICsgKiBAbWVtOiBUaGUg
aW5pdGlhbCBtZW1vcnkgcmVnaW9uIGZvciB0aGUgb2JqZWN0Lgo+ICsgKiBAb2JqOiBUaGUgZ2Vt
IG9iamVjdC4KPiArICogQHNpemU6IE9iamVjdCBzaXplIGluIGJ5dGVzLgo+ICsgKiBAZmxhZ3M6
IGdlbSBvYmplY3QgZmxhZ3MuCj4gKyAqCj4gKyAqIFJldHVybjogMCBvbiBzdWNjZXNzLCBuZWdh
dGl2ZSBlcnJvciBjb2RlIG9uIGZhaWx1cmUuCj4gKyAqLwo+ICtpbnQgX19pOTE1X2dlbV90dG1f
b2JqZWN0X2luaXQoc3RydWN0IGludGVsX21lbW9yeV9yZWdpb24gKm1lbSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2Vfc2l6ZV90IHNpemUsCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFncykKPiArewo+ICsg
ICAgICAgc3RhdGljIHN0cnVjdCBsb2NrX2NsYXNzX2tleSBsb2NrX2NsYXNzOwo+ICsgICAgICAg
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBtZW0tPmk5MTU7Cj4gKyAgICAgICBzaXpl
X3QgYWxpZ25tZW50ID0gMDsKPiArICAgICAgIGludCByZXQ7Cj4gKwo+ICsgICAgICAgLyogQWRq
dXN0IGFsaWdubWVudCB0byBHUFUtIGFuZCBDUFUgaHVnZSBwYWdlIHNpemVzLiAqLwo+ICsKPiAr
ICAgICAgIGlmIChtZW0tPmlzX3JhbmdlX21hbmFnZXIpIHsKPiArICAgICAgICAgICAgICAgaWYg
KHNpemUgPj0gU1pfMUcpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgYWxpZ25tZW50ID0gU1pf
MUcgPj4gUEFHRV9TSElGVDsKPiArICAgICAgICAgICAgICAgZWxzZSBpZiAoc2l6ZSA+PSBTWl8y
TSkKPiArICAgICAgICAgICAgICAgICAgICAgICBhbGlnbm1lbnQgPSBTWl8yTSA+PiBQQUdFX1NI
SUZUOwo+ICsgICAgICAgICAgICAgICBlbHNlIGlmIChzaXplID49IFNaXzY0SykKPiArICAgICAg
ICAgICAgICAgICAgICAgICBhbGlnbm1lbnQgPSBTWl82NEsgPj4gUEFHRV9TSElGVDsKPiArICAg
ICAgIH0KPiArCj4gKyAgICAgICBkcm1fZ2VtX3ByaXZhdGVfb2JqZWN0X2luaXQoJmk5MTUtPmRy
bSwgJm9iai0+YmFzZSwgc2l6ZSk7Cj4gKyAgICAgICBpOTE1X2dlbV9vYmplY3RfaW5pdChvYmos
ICZpOTE1X2dlbV90dG1fb2JqX29wcywgJmxvY2tfY2xhc3MsIGZsYWdzKTsKPiArICAgICAgIGk5
MTVfZ2VtX29iamVjdF9pbml0X21lbW9yeV9yZWdpb24ob2JqLCBtZW0pOwo+ICsgICAgICAgaTkx
NV9nZW1fb2JqZWN0X21ha2VfdW5zaHJpbmthYmxlKG9iaik7Cj4gKyAgICAgICBvYmotPnJlYWRf
ZG9tYWlucyA9IEk5MTVfR0VNX0RPTUFJTl9XQyB8IEk5MTVfR0VNX0RPTUFJTl9HVFQ7Cj4gKyAg
ICAgICBpOTE1X2dlbV9vYmplY3Rfc2V0X2NhY2hlX2NvaGVyZW5jeShvYmosIEk5MTVfQ0FDSEVf
Tk9ORSk7Cj4gKwo+ICsgICAgICAgcmV0ID0gdHRtX2JvX2luaXQoJmk5MTUtPmJkZXYsIGk5MTVf
Z2VtX3RvX3R0bShvYmopLCBzaXplLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgdHRtX2Jv
X3R5cGVfa2VybmVsLCAmaTkxNV9zeXNfcGxhY2VtZW50LCBhbGlnbm1lbnQsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICB0cnVlLCBOVUxMLCBOVUxMLCBpOTE1X3R0bV9ib19kZXN0cm95KTsK
Ck1vdmUgdGhpcyBmdXJ0aGVyIHVwLCBvciBhZGQgc29tZSBvbmlvbj8KClJldmlld2VkLWJ5OiBN
YXR0aGV3IEF1bGQgPG1hdHRoZXcuYXVsZEBpbnRlbC5jb20+Cl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwt
Z2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9t
YWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

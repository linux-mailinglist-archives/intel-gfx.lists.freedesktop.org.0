Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CA25A11D92E
	for <lists+intel-gfx@lfdr.de>; Thu, 12 Dec 2019 23:17:50 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 38DD86E21B;
	Thu, 12 Dec 2019 22:17:49 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
X-Greylist: delayed 600 seconds by postgrey-1.36 at gabe;
 Thu, 12 Dec 2019 22:17:46 UTC
Received: from 6.mo3.mail-out.ovh.net (6.mo3.mail-out.ovh.net [188.165.43.173])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F42146E218
 for <intel-gfx@lists.freedesktop.org>; Thu, 12 Dec 2019 22:17:46 +0000 (UTC)
Received: from player696.ha.ovh.net (unknown [10.108.54.209])
 by mo3.mail-out.ovh.net (Postfix) with ESMTP id 9C2F823523A
 for <intel-gfx@lists.freedesktop.org>; Thu, 12 Dec 2019 23:01:39 +0100 (CET)
Received: from etezian.org (net-37-116-49-191.cust.vodafonedsl.it
 [37.116.49.191]) (Authenticated sender: andi@etezian.org)
 by player696.ha.ovh.net (Postfix) with ESMTPSA id 4AE36D4AF9E1;
 Thu, 12 Dec 2019 22:01:35 +0000 (UTC)
From: Andi Shyti <andi@etezian.org>
To: Intel GFX <intel-gfx@lists.freedesktop.org>
Date: Fri, 13 Dec 2019 00:01:21 +0200
Message-Id: <20191212220121.17852-3-andi@etezian.org>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191212220121.17852-1-andi@etezian.org>
References: <20191212220121.17852-1-andi@etezian.org>
MIME-Version: 1.0
X-Ovh-Tracer-Id: 13313484923478065757
X-VR-SPAMSTATE: OK
X-VR-SPAMSCORE: -100
X-VR-SPAMCAUSE: gggruggvucftvghtrhhoucdtuddrgedufedrudeljedgudehjecutefuodetggdotefrodftvfcurfhrohhfihhlvgemucfqggfjpdevjffgvefmvefgnecuuegrihhlohhuthemucehtddtnecusecvtfgvtghiphhivghnthhsucdlqddutddtmdenucfjughrpefhvffufffkofgjfhggtgfgsehtkeertdertdejnecuhfhrohhmpeetnhguihcuufhhhihtihcuoegrnhguihesvghtvgiiihgrnhdrohhrgheqnecukfhppedtrddtrddtrddtpdefjedrudduiedrgeelrdduledunecurfgrrhgrmhepmhhouggvpehsmhhtphdqohhuthdphhgvlhhopehplhgrhigvrheileeirdhhrgdrohhvhhdrnhgvthdpihhnvghtpedtrddtrddtrddtpdhmrghilhhfrhhomheprghnughisegvthgviihirghnrdhorhhgpdhrtghpthhtohepihhnthgvlhdqghhfgieslhhishhtshdrfhhrvggvuggvshhkthhophdrohhrghenucevlhhushhtvghrufhiiigvpedt
Subject: [Intel-gfx] [PATCH v2 2/2] drm/i915/gt: Move power management debug
 files into a gt aware debugfs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+CgpUaGUgR1Qgc3lzdGVtIGlz
IGJlY29taW5nIG1vcmUgYW5kIG1vcmUgYSBzdGFuZC1hbG9uZSBzeXN0ZW0gaW4KaTkxNSBhbmQg
aXQncyBmYWlyIHRvIGFzc2lnbiBpdCBpdHMgb3duIGRlYnVnZnMgZGlyZWN0b3J5LgoKcmM2LCBy
cHMgYW5kIGxsYyBkZWJ1Z2ZzIGZpbGVzIGFyZSBndCByZWxhdGVkLCBtb3ZlIHRoZW0gaW50byB0
aGUKZ3QgZGVidWdmcyBkaXJlY3RvcnkuCgpTaWduZWQtb2ZmLWJ5OiBBbmRpIFNoeXRpIDxhbmRp
LnNoeXRpQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSAgICAg
ICAgICAgIHwgICAyICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3QuYyAgICAg
fCAgMTkgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndC5oICAgICB8ICAxMyAr
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX3BtLmMgICAgIHwgNTkzICsrKysrKysr
KysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX3BtLmggICAg
IHwgIDE2ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmggfCAgIDMg
KwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgICAgICB8IDU4NSArLS0tLS0t
LS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuaCAgICAg
IHwgICA5ICsKIDggZmlsZXMgY2hhbmdlZCwgNjY0IGluc2VydGlvbnMoKyksIDU3NiBkZWxldGlv
bnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2Zz
X2d0LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2Zz
X2d0LmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2Zz
X3BtLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2Zz
X3BtLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCmluZGV4IGUwZmQxMGMwY2ZiOC4uOGY2Y2RmZDA4YWM4
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQorKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9NYWtlZmlsZQpAQCAtNzUsNiArNzUsOCBAQCBpOTE1LSQoQ09ORklHX1BF
UkZfRVZFTlRTKSArPSBpOTE1X3BtdS5vCiAjICJHcmFwaGljcyBUZWNobm9sb2d5IiAoYWthIHdl
IHRhbGsgdG8gdGhlIGdwdSkKIG9iai15ICs9IGd0LwogZ3QteSArPSBcCisJZ3QvZGVidWdmc19n
dC5vIFwKKwlndC9kZWJ1Z2ZzX3BtLm8gXAogCWd0L2ludGVsX2JyZWFkY3J1bWJzLm8gXAogCWd0
L2ludGVsX2NvbnRleHQubyBcCiAJZ3QvaW50ZWxfZW5naW5lX2NzLm8gXApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvZGVidWdmc19ndC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAw
MC4uMzNhYmUwMjM0ZDU2Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvZGVidWdmc19ndC5jCkBAIC0wLDAgKzEsMTkgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBNSVQgKi8KKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgor
ICovCisKKyNpbmNsdWRlICJkZWJ1Z2ZzX3BtLmgiCisjaW5jbHVkZSAiaTkxNV90cmFjZS5oIgor
CitpbnQgZGVidWdmc19ndF9pbml0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7CisJc3RydWN0IGRy
bV9taW5vciAqbWlub3IgPSBndC0+aTkxNS0+ZHJtLnByaW1hcnk7CisKKwlpZiAoIW1pbm9yLT5k
ZWJ1Z2ZzX3Jvb3QpCisJCXJldHVybiAtRU5PREVWOworCisJZ3QtPmRlYnVnZnNfZW50cnkgPSBk
ZWJ1Z2ZzX2NyZWF0ZV9kaXIoImd0IiwgbWlub3ItPmRlYnVnZnNfcm9vdCk7CisKKwlyZXR1cm4g
aW50ZWxfZ3RfcG1fZGVidWdmc19yZWdpc3RlcihndCk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9k
ZWJ1Z2ZzX2d0LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi43NzAy
NjY4OWJkMzIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1
Z2ZzX2d0LmgKQEAgLTAsMCArMSwxMyBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1J
VCAqLworLyoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKwor
I2lmbmRlZiBERUJVR0ZTX0dUCisjZGVmaW5lIERFQlVHRlNfR1QKKworI2luY2x1ZGUgImludGVs
X2d0X3R5cGVzLmgiCisKK2ludCBkZWJ1Z2ZzX2d0X2luaXQoc3RydWN0IGludGVsX2d0ICpndCk7
CisKKyNlbmRpZiAvKiBERUJVR0ZTX0dUICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9kZWJ1Z2ZzX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX3Bt
LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi42NjM5NTkzZDI1ZmIK
LS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX3BtLmMK
QEAgLTAsMCArMSw1OTMgQEAKKy8qCisgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisg
KgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaW5jbHVk
ZSAiZGVidWdmc19wbS5oIgorI2luY2x1ZGUgImk5MTVfZGVidWdmcy5oIgorI2luY2x1ZGUgImk5
MTVfdHJhY2UuaCIKKyNpbmNsdWRlICJpbnRlbF9yYzYuaCIKKyNpbmNsdWRlICJpbnRlbF9ycHMu
aCIKKyNpbmNsdWRlICJpbnRlbF9zaWRlYmFuZC5oIgorCitzdGF0aWMgaW50IGk5MTVfZnJlcXVl
bmN5X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCit7CisJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7CisJc3RydWN0
IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKKwlzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMgPSAmaTkxNS0+Z3QucnBzOworCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOworCisJd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKKworCWlmIChJ
U19HRU4oaTkxNSwgNSkpIHsKKwkJdTE2IHJndnN3Y3RsID0gaW50ZWxfdW5jb3JlX3JlYWQxNih1
bmNvcmUsIE1FTVNXQ1RMKTsKKwkJdTE2IHJndnN0YXQgPSBpbnRlbF91bmNvcmVfcmVhZDE2KHVu
Y29yZSwgTUVNU1RBVF9JTEspOworCisJCXNlcV9wcmludGYobSwgIlJlcXVlc3RlZCBQLXN0YXRl
OiAlZFxuIiwgKHJndnN3Y3RsID4+IDgpICYgMHhmKTsKKwkJc2VxX3ByaW50ZihtLCAiUmVxdWVz
dGVkIFZJRDogJWRcbiIsIHJndnN3Y3RsICYgMHgzZik7CisJCXNlcV9wcmludGYobSwgIkN1cnJl
bnQgVklEOiAlZFxuIiwgKHJndnN0YXQgJiBNRU1TVEFUX1ZJRF9NQVNLKSA+PgorCQkJICAgTUVN
U1RBVF9WSURfU0hJRlQpOworCQlzZXFfcHJpbnRmKG0sICJDdXJyZW50IFAtc3RhdGU6ICVkXG4i
LAorCQkJICAgKHJndnN0YXQgJiBNRU1TVEFUX1BTVEFURV9NQVNLKSA+PiBNRU1TVEFUX1BTVEFU
RV9TSElGVCk7CisJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpIHx8IElTX0NIRVJSWVZJ
RVcoaTkxNSkpIHsKKwkJdTMyIHJwbW9kZWN0bCwgZnJlcV9zdHM7CisKKwkJcnBtb2RlY3RsID0g
aW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQX0NPTlRST0wpOworCQlzZXFfcHJpbnRm
KG0sICJWaWRlbyBUdXJibyBNb2RlOiAlc1xuIiwKKwkJCSAgIHllc25vKHJwbW9kZWN0bCAmIEdF
TjZfUlBfTUVESUFfVFVSQk8pKTsKKwkJc2VxX3ByaW50ZihtLCAiSFcgY29udHJvbCBlbmFibGVk
OiAlc1xuIiwKKwkJCSAgIHllc25vKHJwbW9kZWN0bCAmIEdFTjZfUlBfRU5BQkxFKSk7CisJCXNl
cV9wcmludGYobSwgIlNXIGNvbnRyb2wgZW5hYmxlZDogJXNcbiIsCisJCQkgICB5ZXNubygocnBt
b2RlY3RsICYgR0VONl9SUF9NRURJQV9NT0RFX01BU0spID09CisJCQkJICBHRU42X1JQX01FRElB
X1NXX01PREUpKTsKKworCQl2bHZfcHVuaXRfZ2V0KGk5MTUpOworCQlmcmVxX3N0cyA9IHZsdl9w
dW5pdF9yZWFkKGk5MTUsIFBVTklUX1JFR19HUFVfRlJFUV9TVFMpOworCQl2bHZfcHVuaXRfcHV0
KGk5MTUpOworCisJCXNlcV9wcmludGYobSwgIlBVTklUX1JFR19HUFVfRlJFUV9TVFM6IDB4JTA4
eFxuIiwgZnJlcV9zdHMpOworCQlzZXFfcHJpbnRmKG0sICJERFIgZnJlcTogJWQgTUh6XG4iLCBp
OTE1LT5tZW1fZnJlcSk7CisKKwkJc2VxX3ByaW50ZihtLCAiYWN0dWFsIEdQVSBmcmVxOiAlZCBN
SHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIChmcmVxX3N0cyA+PiA4KSAmIDB4ZmYp
KTsKKworCQlzZXFfcHJpbnRmKG0sICJjdXJyZW50IEdQVSBmcmVxOiAlZCBNSHpcbiIsCisJCQkg
ICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+Y3VyX2ZyZXEpKTsKKworCQlzZXFfcHJpbnRmKG0s
ICJtYXggR1BVIGZyZXE6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBz
LT5tYXhfZnJlcSkpOworCisJCXNlcV9wcmludGYobSwgIm1pbiBHUFUgZnJlcTogJWQgTUh6XG4i
LAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1pbl9mcmVxKSk7CisKKwkJc2VxX3By
aW50ZihtLCAiaWRsZSBHUFUgZnJlcTogJWQgTUh6XG4iLAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEo
cnBzLCBycHMtPmlkbGVfZnJlcSkpOworCisJCXNlcV9wcmludGYobSwgImVmZmljaWVudCAoUlBl
KSBmcmVxdWVuY3k6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5l
ZmZpY2llbnRfZnJlcSkpOworCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpIHsKKwkJ
dTMyIHJwX3N0YXRlX2xpbWl0czsKKwkJdTMyIGd0X3BlcmZfc3RhdHVzOworCQl1MzIgcnBfc3Rh
dGVfY2FwOworCQl1MzIgcnBtb2RlY3RsLCBycGluY2xpbWl0LCBycGRlY2xpbWl0OworCQl1MzIg
cnBzdGF0LCBjYWdmLCByZXFmOworCQl1MzIgcnB1cGVpLCBycGN1cnVwLCBycHByZXZ1cDsKKwkJ
dTMyIHJwZG93bmVpLCBycGN1cmRvd24sIHJwcHJldmRvd247CisJCXUzMiBwbV9pZXIsIHBtX2lt
ciwgcG1faXNyLCBwbV9paXIsIHBtX21hc2s7CisJCWludCBtYXhfZnJlcTsKKworCQlycF9zdGF0
ZV9saW1pdHMgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBfU1RBVEVfTElNSVRT
KTsKKwkJaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKKwkJCXJwX3N0YXRlX2NhcCA9IGludGVsX3Vu
Y29yZV9yZWFkKHVuY29yZSwgQlhUX1JQX1NUQVRFX0NBUCk7CisJCQlndF9wZXJmX3N0YXR1cyA9
IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgQlhUX0dUX1BFUkZfU1RBVFVTKTsKKwkJfSBlbHNl
IHsKKwkJCXJwX3N0YXRlX2NhcCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9SUF9T
VEFURV9DQVApOworCQkJZ3RfcGVyZl9zdGF0dXMgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IEdFTjZfR1RfUEVSRl9TVEFUVVMpOworCQl9CisKKwkJLyogUlBTVEFUMSBpcyBpbiB0aGUgR1Qg
cG93ZXIgd2VsbCAqLworCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3Jl
LCBGT1JDRVdBS0VfQUxMKTsKKworCQlyZXFmID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBH
RU42X1JQTlNXUkVRKTsKKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA5KQorCQkJcmVxZiA+Pj0g
MjM7CisJCWVsc2UgeworCQkJcmVxZiAmPSB+R0VONl9UVVJCT19ESVNBQkxFOworCQkJaWYgKElT
X0hBU1dFTEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKQorCQkJCXJlcWYgPj49IDI0Owor
CQkJZWxzZQorCQkJCXJlcWYgPj49IDI1OworCQl9CisJCXJlcWYgPSBpbnRlbF9ncHVfZnJlcShy
cHMsIHJlcWYpOworCisJCXJwbW9kZWN0bCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VO
Nl9SUF9DT05UUk9MKTsKKwkJcnBpbmNsaW1pdCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwg
R0VONl9SUF9VUF9USFJFU0hPTEQpOworCQlycGRlY2xpbWl0ID0gaW50ZWxfdW5jb3JlX3JlYWQo
dW5jb3JlLCBHRU42X1JQX0RPV05fVEhSRVNIT0xEKTsKKworCQlycHN0YXQgPSBpbnRlbF91bmNv
cmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBTVEFUMSk7CisJCXJwdXBlaSA9IGludGVsX3VuY29yZV9y
ZWFkKHVuY29yZSwgR0VONl9SUF9DVVJfVVBfRUkpICYgR0VONl9DVVJJQ09OVF9NQVNLOworCQly
cGN1cnVwID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JQX0NVUl9VUCkgJiBHRU42
X0NVUkJTWVRBVkdfTUFTSzsKKwkJcnBwcmV2dXAgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IEdFTjZfUlBfUFJFVl9VUCkgJiBHRU42X0NVUkJTWVRBVkdfTUFTSzsKKwkJcnBkb3duZWkgPSBp
bnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUlBfQ1VSX0RPV05fRUkpICYgR0VONl9DVVJJ
QVZHX01BU0s7CisJCXJwY3VyZG93biA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9S
UF9DVVJfRE9XTikgJiBHRU42X0NVUkJTWVRBVkdfTUFTSzsKKwkJcnBwcmV2ZG93biA9IGludGVs
X3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9SUF9QUkVWX0RPV04pICYgR0VONl9DVVJCU1lUQVZH
X01BU0s7CisJCWNhZ2YgPSBpbnRlbF9ycHNfcmVhZF9hY3R1YWxfZnJlcXVlbmN5KHJwcyk7CisK
KwkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FM
TCk7CisKKwkJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgeworCQkJcG1faWVyID0gaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfRU5BQkxFKTsKKwkJ
CXBtX2ltciA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VOMTFfR1BNX1dHQk9YUEVSRl9J
TlRSX01BU0spOworCQkJLyoKKwkJCSAqIFRoZSBlcXVpdmFsZW50IHRvIHRoZSBQTSBJU1IgJiBJ
SVIgY2Fubm90IGJlIHJlYWQKKwkJCSAqIHdpdGhvdXQgYWZmZWN0aW5nIHRoZSBjdXJyZW50IHN0
YXRlIG9mIHRoZSBzeXN0ZW0KKwkJCSAqLworCQkJcG1faXNyID0gMDsKKwkJCXBtX2lpciA9IDA7
CisJCX0gZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpIHsKKwkJCXBtX2llciA9IGludGVs
X3VuY29yZV9yZWFkKHVuY29yZSwgR0VOOF9HVF9JRVIoMikpOworCQkJcG1faW1yID0gaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBHRU44X0dUX0lNUigyKSk7CisJCQlwbV9pc3IgPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjhfR1RfSVNSKDIpKTsKKwkJCXBtX2lpciA9IGludGVsX3Vu
Y29yZV9yZWFkKHVuY29yZSwgR0VOOF9HVF9JSVIoMikpOworCQl9IGVsc2UgeworCQkJcG1faWVy
ID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1BNSUVSKTsKKwkJCXBtX2ltciA9IGlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9QTUlNUik7CisJCQlwbV9pc3IgPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfUE1JU1IpOworCQkJcG1faWlyID0gaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBHRU42X1BNSUlSKTsKKwkJfQorCQlwbV9tYXNrID0gaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBHRU42X1BNSU5UUk1TSyk7CisKKwkJc2VxX3ByaW50ZihtLCAiVmlkZW8g
VHVyYm8gTW9kZTogJXNcbiIsCisJCQkgICB5ZXNubyhycG1vZGVjdGwgJiBHRU42X1JQX01FRElB
X1RVUkJPKSk7CisJCXNlcV9wcmludGYobSwgIkhXIGNvbnRyb2wgZW5hYmxlZDogJXNcbiIsCisJ
CQkgICB5ZXNubyhycG1vZGVjdGwgJiBHRU42X1JQX0VOQUJMRSkpOworCQlzZXFfcHJpbnRmKG0s
ICJTVyBjb250cm9sIGVuYWJsZWQ6ICVzXG4iLAorCQkJICAgeWVzbm8oKHJwbW9kZWN0bCAmIEdF
TjZfUlBfTUVESUFfTU9ERV9NQVNLKSA9PQorCQkJCSAgR0VONl9SUF9NRURJQV9TV19NT0RFKSk7
CisKKwkJc2VxX3ByaW50ZihtLCAiUE0gSUVSPTB4JTA4eCBJTVI9MHglMDh4LCBNQVNLPTB4JTA4
eFxuIiwKKwkJCSAgIHBtX2llciwgcG1faW1yLCBwbV9tYXNrKTsKKwkJaWYgKElOVEVMX0dFTihp
OTE1KSA8PSAxMCkKKwkJCXNlcV9wcmludGYobSwgIlBNIElTUj0weCUwOHggSUlSPTB4JTA4eFxu
IiwKKwkJCQkgICBwbV9pc3IsIHBtX2lpcik7CisJCXNlcV9wcmludGYobSwgInBtX2ludHJtc2tf
bWJ6OiAweCUwOHhcbiIsCisJCQkgICBycHMtPnBtX2ludHJtc2tfbWJ6KTsKKwkJc2VxX3ByaW50
ZihtLCAiR1RfUEVSRl9TVEFUVVM6IDB4JTA4eFxuIiwgZ3RfcGVyZl9zdGF0dXMpOworCQlzZXFf
cHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSByYXRpbzogJWRcbiIsCisJCQkgICAoZ3RfcGVyZl9z
dGF0dXMgJiAoSU5URUxfR0VOKGk5MTUpID49IDkgPyAweDFmZjAwIDogMHhmZjAwKSkgPj4gOCk7
CisJCXNlcV9wcmludGYobSwgIlJlbmRlciBwLXN0YXRlIFZJRDogJWRcbiIsCisJCQkgICBndF9w
ZXJmX3N0YXR1cyAmIDB4ZmYpOworCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSBsaW1p
dDogJWRcbiIsCisJCQkgICBycF9zdGF0ZV9saW1pdHMgJiAweGZmKTsKKwkJc2VxX3ByaW50Ziht
LCAiUlBTVEFUMTogMHglMDh4XG4iLCBycHN0YXQpOworCQlzZXFfcHJpbnRmKG0sICJSUE1PREVD
VEw6IDB4JTA4eFxuIiwgcnBtb2RlY3RsKTsKKwkJc2VxX3ByaW50ZihtLCAiUlBJTkNMSU1JVDog
MHglMDh4XG4iLCBycGluY2xpbWl0KTsKKwkJc2VxX3ByaW50ZihtLCAiUlBERUNMSU1JVDogMHgl
MDh4XG4iLCBycGRlY2xpbWl0KTsKKwkJc2VxX3ByaW50ZihtLCAiUlBOU1dSRVE6ICVkTUh6XG4i
LCByZXFmKTsKKwkJc2VxX3ByaW50ZihtLCAiQ0FHRjogJWRNSHpcbiIsIGNhZ2YpOworCQlzZXFf
cHJpbnRmKG0sICJSUCBDVVIgVVAgRUk6ICVkICglZHVzKVxuIiwKKwkJCSAgIHJwdXBlaSwgR1Rf
UE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnB1cGVpKSk7CisJCXNlcV9wcmludGYobSwgIlJQIENV
UiBVUDogJWQgKCVkdXMpXG4iLAorCQkJICAgcnBjdXJ1cCwgR1RfUE1fSU5URVJWQUxfVE9fVVMo
aTkxNSwgcnBjdXJ1cCkpOworCQlzZXFfcHJpbnRmKG0sICJSUCBQUkVWIFVQOiAlZCAoJWR1cylc
biIsCisJCQkgICBycHByZXZ1cCwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBwcmV2dXAp
KTsKKwkJc2VxX3ByaW50ZihtLCAiVXAgdGhyZXNob2xkOiAlZCUlXG4iLAorCQkJICAgcnBzLT5w
b3dlci51cF90aHJlc2hvbGQpOworCisJCXNlcV9wcmludGYobSwgIlJQIENVUiBET1dOIEVJOiAl
ZCAoJWR1cylcbiIsCisJCQkgICBycGRvd25laSwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwg
cnBkb3duZWkpKTsKKwkJc2VxX3ByaW50ZihtLCAiUlAgQ1VSIERPV046ICVkICglZHVzKVxuIiwK
KwkJCSAgIHJwY3VyZG93biwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBjdXJkb3duKSk7
CisJCXNlcV9wcmludGYobSwgIlJQIFBSRVYgRE9XTjogJWQgKCVkdXMpXG4iLAorCQkJICAgcnBw
cmV2ZG93biwgR1RfUE1fSU5URVJWQUxfVE9fVVMoaTkxNSwgcnBwcmV2ZG93bikpOworCQlzZXFf
cHJpbnRmKG0sICJEb3duIHRocmVzaG9sZDogJWQlJVxuIiwKKwkJCSAgIHJwcy0+cG93ZXIuZG93
bl90aHJlc2hvbGQpOworCisJCW1heF9mcmVxID0gKElTX0dFTjlfTFAoaTkxNSkgPyBycF9zdGF0
ZV9jYXAgPj4gMCA6CisJCQkgICAgcnBfc3RhdGVfY2FwID4+IDE2KSAmIDB4ZmY7CisJCW1heF9m
cmVxICo9IChJU19HRU45X0JDKGk5MTUpIHx8CisJCQkgICAgIElOVEVMX0dFTihpOTE1KSA+PSAx
MCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKKwkJc2VxX3ByaW50ZihtLCAiTG93ZXN0IChSUE4p
IGZyZXF1ZW5jeTogJWRNSHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIG1heF9mcmVx
KSk7CisKKwkJbWF4X2ZyZXEgPSAocnBfc3RhdGVfY2FwICYgMHhmZjAwKSA+PiA4OworCQltYXhf
ZnJlcSAqPSAoSVNfR0VOOV9CQyhpOTE1KSB8fAorCQkJICAgICBJTlRFTF9HRU4oaTkxNSkgPj0g
MTAgPyBHRU45X0ZSRVFfU0NBTEVSIDogMSk7CisJCXNlcV9wcmludGYobSwgIk5vbWluYWwgKFJQ
MSkgZnJlcXVlbmN5OiAlZE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgbWF4X2Zy
ZXEpKTsKKworCQltYXhfZnJlcSA9IChJU19HRU45X0xQKGk5MTUpID8gcnBfc3RhdGVfY2FwID4+
IDE2IDoKKwkJCSAgICBycF9zdGF0ZV9jYXAgPj4gMCkgJiAweGZmOworCQltYXhfZnJlcSAqPSAo
SVNfR0VOOV9CQyhpOTE1KSB8fAorCQkJICAgICBJTlRFTF9HRU4oaTkxNSkgPj0gMTAgPyBHRU45
X0ZSRVFfU0NBTEVSIDogMSk7CisJCXNlcV9wcmludGYobSwgIk1heCBub24tb3ZlcmNsb2NrZWQg
KFJQMCkgZnJlcXVlbmN5OiAlZE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgbWF4
X2ZyZXEpKTsKKwkJc2VxX3ByaW50ZihtLCAiTWF4IG92ZXJjbG9ja2VkIGZyZXF1ZW5jeTogJWRN
SHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKKworCQlz
ZXFfcHJpbnRmKG0sICJDdXJyZW50IGZyZXE6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9m
cmVxKHJwcywgcnBzLT5jdXJfZnJlcSkpOworCQlzZXFfcHJpbnRmKG0sICJBY3R1YWwgZnJlcTog
JWQgTUh6XG4iLCBjYWdmKTsKKwkJc2VxX3ByaW50ZihtLCAiSWRsZSBmcmVxOiAlZCBNSHpcbiIs
CisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+aWRsZV9mcmVxKSk7CisJCXNlcV9wcmlu
dGYobSwgIk1pbiBmcmVxOiAlZCBNSHpcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJw
cy0+bWluX2ZyZXEpKTsKKwkJc2VxX3ByaW50ZihtLCAiQm9vc3QgZnJlcTogJWQgTUh6XG4iLAor
CQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmJvb3N0X2ZyZXEpKTsKKwkJc2VxX3ByaW50
ZihtLCAiTWF4IGZyZXE6ICVkIE1IelxuIiwKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBz
LT5tYXhfZnJlcSkpOworCQlzZXFfcHJpbnRmKG0sCisJCQkgICAiZWZmaWNpZW50IChSUGUpIGZy
ZXF1ZW5jeTogJWQgTUh6XG4iLAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmVmZmlj
aWVudF9mcmVxKSk7CisJfSBlbHNlIHsKKwkJc2VxX3B1dHMobSwgIm5vIFAtc3RhdGUgaW5mbyBh
dmFpbGFibGVcbiIpOworCX0KKworCXNlcV9wcmludGYobSwgIkN1cnJlbnQgQ0QgY2xvY2sgZnJl
cXVlbmN5OiAlZCBrSHpcbiIsIGk5MTUtPmNkY2xrLmh3LmNkY2xrKTsKKwlzZXFfcHJpbnRmKG0s
ICJNYXggQ0QgY2xvY2sgZnJlcXVlbmN5OiAlZCBrSHpcbiIsIGk5MTUtPm1heF9jZGNsa19mcmVx
KTsKKwlzZXFfcHJpbnRmKG0sICJNYXggcGl4ZWwgY2xvY2sgZnJlcXVlbmN5OiAlZCBrSHpcbiIs
IGk5MTUtPm1heF9kb3RjbGtfZnJlcSk7CisKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+
cnVudGltZV9wbSwgd2FrZXJlZik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBpOTE1
X3JpbmdfZnJlcV90YWJsZShzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKK3sKKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsK
KwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3QucnBzOworCXVuc2lnbmVkIGludCBt
YXhfZ3B1X2ZyZXEsIG1pbl9ncHVfZnJlcTsKKwlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKKwlp
bnQgZ3B1X2ZyZXEsIGlhX2ZyZXE7CisKKwlpZiAoIUhBU19MTEMoaTkxNSkpCisJCXJldHVybiAt
RU5PREVWOworCisJbWluX2dwdV9mcmVxID0gcnBzLT5taW5fZnJlcTsKKwltYXhfZ3B1X2ZyZXEg
PSBycHMtPm1heF9mcmVxOworCWlmIChJU19HRU45X0JDKGk5MTUpIHx8IElOVEVMX0dFTihpOTE1
KSA+PSAxMCkgeworCQkvKiBDb252ZXJ0IEdUIGZyZXF1ZW5jeSB0byA1MCBIWiB1bml0cyAqLwor
CQltaW5fZ3B1X2ZyZXEgLz0gR0VOOV9GUkVRX1NDQUxFUjsKKwkJbWF4X2dwdV9mcmVxIC89IEdF
TjlfRlJFUV9TQ0FMRVI7CisJfQorCisJc2VxX3B1dHMobSwgIkdQVSBmcmVxIChNSHopXHRFZmZl
Y3RpdmUgQ1BVIGZyZXEgKE1IeilcdEVmZmVjdGl2ZSBSaW5nIGZyZXEgKE1IeilcbiIpOworCisJ
d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKKwlmb3Ig
KGdwdV9mcmVxID0gbWluX2dwdV9mcmVxOyBncHVfZnJlcSA8PSBtYXhfZ3B1X2ZyZXE7IGdwdV9m
cmVxKyspIHsKKwkJaWFfZnJlcSA9IGdwdV9mcmVxOworCQlzYW5keWJyaWRnZV9wY29kZV9yZWFk
KGk5MTUsCisJCQkJICAgICAgIEdFTjZfUENPREVfUkVBRF9NSU5fRlJFUV9UQUJMRSwKKwkJCQkg
ICAgICAgJmlhX2ZyZXEsIE5VTEwpOworCQlzZXFfcHJpbnRmKG0sICIlZFx0XHQlZFx0XHRcdFx0
JWRcbiIsCisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsCisJCQkJCSAgKGdwdV9mcmVxICoKKwkJ
CQkJICAgKElTX0dFTjlfQkMoaTkxNSkgfHwKKwkJCQkJICAgIElOVEVMX0dFTihpOTE1KSA+PSAx
MCA/CisJCQkJCSAgICBHRU45X0ZSRVFfU0NBTEVSIDogMSkpKSwKKwkJCSAgICgoaWFfZnJlcSA+
PiAwKSAmIDB4ZmYpICogMTAwLAorCQkJICAgKChpYV9mcmVxID4+IDgpICYgMHhmZikgKiAxMDAp
OworCX0KKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IGNoYXIgKnJwc19wb3dlcl90b19zdHIo
dW5zaWduZWQgaW50IHBvd2VyKQoreworCXN0YXRpYyBjb25zdCBjaGFyICogY29uc3Qgc3RyaW5n
c1tdID0geworCQlbTE9XX1BPV0VSXSA9ICJsb3cgcG93ZXIiLAorCQlbQkVUV0VFTl0gPSAibWl4
ZWQiLAorCQlbSElHSF9QT1dFUl0gPSAiaGlnaCBwb3dlciIsCisJfTsKKworCWlmIChwb3dlciA+
PSBBUlJBWV9TSVpFKHN0cmluZ3MpIHx8ICFzdHJpbmdzW3Bvd2VyXSkKKwkJcmV0dXJuICJ1bmtu
b3duIjsKKworCXJldHVybiBzdHJpbmdzW3Bvd2VyXTsKK30KKworc3RhdGljIGludCBpOTE1X3Jw
c19ib29zdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKK3sKKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKKwlzdHJ1
Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmaTkxNS0+dW5jb3JlOworCXN0cnVjdCBpbnRlbF9y
cHMgKnJwcyA9ICZpOTE1LT5ndC5ycHM7CisJdTMyIGFjdF9mcmVxOworCWludGVsX3dha2VyZWZf
dCB3YWtlcmVmOworCisJd2l0aF9pbnRlbF9ydW50aW1lX3BtX2lmX2luX3VzZSgmaTkxNS0+cnVu
dGltZV9wbSwgd2FrZXJlZikKKwkJYWN0X2ZyZXEgPSBpbnRlbF9ycHNfcmVhZF9hY3R1YWxfZnJl
cXVlbmN5KHJwcyk7CisKKwlzZXFfcHJpbnRmKG0sICJSUFMgZW5hYmxlZD8gJWRcbiIsIHJwcy0+
ZW5hYmxlZCk7CisJc2VxX3ByaW50ZihtLCAiR1BVIGJ1c3k/ICVzXG4iLCB5ZXNubyhpOTE1LT5n
dC5hd2FrZSkpOworCXNlcV9wcmludGYobSwgIkJvb3N0cyBvdXRzdGFuZGluZz8gJWRcbiIsCisJ
CSAgIGF0b21pY19yZWFkKCZycHMtPm51bV93YWl0ZXJzKSk7CisJc2VxX3ByaW50ZihtLCAiSW50
ZXJhY3RpdmU/ICVkXG4iLCBSRUFEX09OQ0UocnBzLT5wb3dlci5pbnRlcmFjdGl2ZSkpOworCXNl
cV9wcmludGYobSwgIkZyZXF1ZW5jeSByZXF1ZXN0ZWQgJWQsIGFjdHVhbCAlZFxuIiwKKwkJICAg
aW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmN1cl9mcmVxKSwgYWN0X2ZyZXEpOworCXNlcV9wcmlu
dGYobSwgIiAgbWluIGhhcmQ6JWQsIHNvZnQ6JWQ7IG1heCBzb2Z0OiVkLCBoYXJkOiVkXG4iLAor
CQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXEpLAorCQkgICBpbnRlbF9ncHVf
ZnJlcShycHMsIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KSwKKwkJICAgaW50ZWxfZ3B1X2ZyZXEo
cnBzLCBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCksCisJCSAgIGludGVsX2dwdV9mcmVxKHJwcywg
cnBzLT5tYXhfZnJlcSkpOworCXNlcV9wcmludGYobSwgIiAgaWRsZTolZCwgZWZmaWNpZW50OiVk
LCBib29zdDolZFxuIiwKKwkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmlkbGVfZnJlcSks
CisJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5lZmZpY2llbnRfZnJlcSksCisJCSAgIGlu
dGVsX2dwdV9mcmVxKHJwcywgcnBzLT5ib29zdF9mcmVxKSk7CisKKwlzZXFfcHJpbnRmKG0sICJX
YWl0IGJvb3N0czogJWRcbiIsIGF0b21pY19yZWFkKCZycHMtPmJvb3N0cykpOworCisJaWYgKElO
VEVMX0dFTihpOTE1KSA+PSA2ICYmIHJwcy0+ZW5hYmxlZCAmJiBpOTE1LT5ndC5hd2FrZSkgewor
CQl1MzIgcnB1cCwgcnB1cGVpOworCQl1MzIgcnBkb3duLCBycGRvd25laTsKKworCQlpbnRlbF91
bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKwkJcnB1
cCA9IGludGVsX3VuY29yZV9yZWFkX2Z3KHVuY29yZSwgR0VONl9SUF9DVVJfVVApICYgR0VONl9S
UF9FSV9NQVNLOworCQlycHVwZWkgPSBpbnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIEdFTjZf
UlBfQ1VSX1VQX0VJKSAmIEdFTjZfUlBfRUlfTUFTSzsKKwkJcnBkb3duID0gaW50ZWxfdW5jb3Jl
X3JlYWRfZncodW5jb3JlLCBHRU42X1JQX0NVUl9ET1dOKSAmIEdFTjZfUlBfRUlfTUFTSzsKKwkJ
cnBkb3duZWkgPSBpbnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIEdFTjZfUlBfQ1VSX0RPV05f
RUkpICYgR0VONl9SUF9FSV9NQVNLOworCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkx
NS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKworCQlzZXFfcHJpbnRmKG0sICJcblJQUyBBdXRv
dHVuaW5nIChjdXJyZW50IFwiJXNcIiB3aW5kb3cpOlxuIiwKKwkJCSAgIHJwc19wb3dlcl90b19z
dHIocnBzLT5wb3dlci5tb2RlKSk7CisJCXNlcV9wcmludGYobSwgIiAgQXZnLiB1cDogJWQlJSBb
YWJvdmUgdGhyZXNob2xkPyAlZCUlXVxuIiwKKwkJCSAgIHJwdXAgJiYgcnB1cGVpID8gMTAwICog
cnB1cCAvIHJwdXBlaSA6IDAsCisJCQkgICBycHMtPnBvd2VyLnVwX3RocmVzaG9sZCk7CisJCXNl
cV9wcmludGYobSwgIiAgQXZnLiBkb3duOiAlZCUlIFtiZWxvdyB0aHJlc2hvbGQ/ICVkJSVdXG4i
LAorCQkJICAgcnBkb3duICYmIHJwZG93bmVpID8gMTAwICogcnBkb3duIC8gcnBkb3duZWkgOiAw
LAorCQkJICAgcnBzLT5wb3dlci5kb3duX3RocmVzaG9sZCk7CisJfSBlbHNlIHsKKwkJc2VxX3B1
dHMobSwgIlxuUlBTIEF1dG90dW5pbmcgaW5hY3RpdmVcbiIpOworCX0KKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IGk5MTVfZm9yY2V3YWtlX2RvbWFpbnMoc3RydWN0IHNlcV9maWxlICpt
LCB2b2lkICpkYXRhKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90
b19pOTE1KG0tPnByaXZhdGUpOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1
LT51bmNvcmU7CisJc3RydWN0IGludGVsX3VuY29yZV9mb3JjZXdha2VfZG9tYWluICpmd19kb21h
aW47CisJdW5zaWduZWQgaW50IHRtcDsKKworCXNlcV9wcmludGYobSwgInVzZXIuYnlwYXNzX2Nv
dW50ID0gJXVcbiIsCisJCSAgIHVuY29yZS0+dXNlcl9mb3JjZXdha2VfY291bnQpOworCisJZm9y
X2VhY2hfZndfZG9tYWluKGZ3X2RvbWFpbiwgdW5jb3JlLCB0bXApCisJCXNlcV9wcmludGYobSwg
IiVzLndha2VfY291bnQgPSAldVxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9mb3JjZXdha2VfZG9t
YWluX3RvX3N0cihmd19kb21haW4tPmlkKSwKKwkJCSAgIFJFQURfT05DRShmd19kb21haW4tPndh
a2VfY291bnQpKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBwcmludF9yYzZfcmVz
KHN0cnVjdCBzZXFfZmlsZSAqbSwKKwkJCSAgY29uc3QgY2hhciAqdGl0bGUsCisJCQkgIGNvbnN0
IGk5MTVfcmVnX3QgcmVnKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9k
ZV90b19pOTE1KG0tPnByaXZhdGUpOworCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOworCisJd2l0
aF9pbnRlbF9ydW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKQorCQlzZXFfcHJp
bnRmKG0sICIlcyAldSAoJWxsdSB1cylcbiIsIHRpdGxlLAorCQkJICAgaW50ZWxfdW5jb3JlX3Jl
YWQoJmk5MTUtPnVuY29yZSwgcmVnKSwKKwkJCSAgIGludGVsX3JjNl9yZXNpZGVuY3lfdXMoJmk5
MTUtPmd0LnJjNiwgcmVnKSk7Cit9CisKK3N0YXRpYyBpbnQgdmx2X2RycGNfaW5mbyhzdHJ1Y3Qg
c2VxX2ZpbGUgKm0pCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3Rv
X2k5MTUobS0+cHJpdmF0ZSk7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUt
PnVuY29yZTsKKwl1MzIgcmNjdGwxLCBwd19zdGF0dXM7CisKKwlwd19zdGF0dXMgPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIFZMVl9HVExDX1BXX1NUQVRVUyk7CisJcmNjdGwxID0gaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1JDX0NPTlRST0wpOworCisJc2VxX3ByaW50ZihtLCAi
UkM2IEVuYWJsZWQ6ICVzXG4iLAorCQkgICB5ZXNubyhyY2N0bDEgJiAoR0VON19SQ19DVExfVE9f
TU9ERSB8CisJCQkJCUdFTjZfUkNfQ1RMX0VJX01PREUoMSkpKSk7CisJc2VxX3ByaW50ZihtLCAi
UmVuZGVyIFBvd2VyIFdlbGw6ICVzXG4iLAorCQkgICAocHdfc3RhdHVzICYgVkxWX0dUTENfUFdf
UkVOREVSX1NUQVRVU19NQVNLKSA/ICJVcCIgOiAiRG93biIpOworCXNlcV9wcmludGYobSwgIk1l
ZGlhIFBvd2VyIFdlbGw6ICVzXG4iLAorCQkgICAocHdfc3RhdHVzICYgVkxWX0dUTENfUFdfTUVE
SUFfU1RBVFVTX01BU0spID8gIlVwIiA6ICJEb3duIik7CisKKwlwcmludF9yYzZfcmVzKG0sICJS
ZW5kZXIgUkM2IHJlc2lkZW5jeSBzaW5jZSBib290OiIsIFZMVl9HVF9SRU5ERVJfUkM2KTsKKwlw
cmludF9yYzZfcmVzKG0sICJNZWRpYSBSQzYgcmVzaWRlbmN5IHNpbmNlIGJvb3Q6IiwgVkxWX0dU
X01FRElBX1JDNik7CisKKwlyZXR1cm4gaTkxNV9mb3JjZXdha2VfZG9tYWlucyhtLCBOVUxMKTsK
K30KKworc3RhdGljIGludCBnZW42X2RycGNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCit7CisJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7
CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKKwl1MzIgZ3Rf
Y29yZV9zdGF0dXMsIHJjY3RsMSwgcmM2dmlkcyA9IDA7CisJdTMyIGdlbjlfcG93ZXJnYXRlX2Vu
YWJsZSA9IDAsIGdlbjlfcG93ZXJnYXRlX3N0YXR1cyA9IDA7CisKKwlndF9jb3JlX3N0YXR1cyA9
IGludGVsX3VuY29yZV9yZWFkX2Z3KHVuY29yZSwgR0VONl9HVF9DT1JFX1NUQVRVUyk7CisJdHJh
Y2VfaTkxNV9yZWdfcncoZmFsc2UsIEdFTjZfR1RfQ09SRV9TVEFUVVMsIGd0X2NvcmVfc3RhdHVz
LCA0LCB0cnVlKTsKKworCXJjY3RsMSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9S
Q19DT05UUk9MKTsKKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpIHsKKwkJZ2VuOV9wb3dlcmdh
dGVfZW5hYmxlID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkJR0VOOV9QR19FTkFC
TEUpOworCQlnZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
CisJCQkJCQlHRU45X1BXUkdUX0RPTUFJTl9TVEFUVVMpOworCX0KKworCWlmIChJTlRFTF9HRU4o
aTkxNSkgPD0gNykKKwkJc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChpOTE1LCBHRU42X1BDT0RFX1JF
QURfUkM2VklEUywKKwkJCQkgICAgICAgJnJjNnZpZHMsIE5VTEwpOworCisJc2VxX3ByaW50Ziht
LCAiUkMxZSBFbmFibGVkOiAlc1xuIiwKKwkJICAgeWVzbm8ocmNjdGwxICYgR0VONl9SQ19DVExf
UkMxZV9FTkFCTEUpKTsKKwlzZXFfcHJpbnRmKG0sICJSQzYgRW5hYmxlZDogJXNcbiIsCisJCSAg
IHllc25vKHJjY3RsMSAmIEdFTjZfUkNfQ1RMX1JDNl9FTkFCTEUpKTsKKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDkpIHsKKwkJc2VxX3ByaW50ZihtLCAiUmVuZGVyIFdlbGwgR2F0aW5nIEVuYWJs
ZWQ6ICVzXG4iLAorCQkJeWVzbm8oZ2VuOV9wb3dlcmdhdGVfZW5hYmxlICYgR0VOOV9SRU5ERVJf
UEdfRU5BQkxFKSk7CisJCXNlcV9wcmludGYobSwgIk1lZGlhIFdlbGwgR2F0aW5nIEVuYWJsZWQ6
ICVzXG4iLAorCQkJeWVzbm8oZ2VuOV9wb3dlcmdhdGVfZW5hYmxlICYgR0VOOV9NRURJQV9QR19F
TkFCTEUpKTsKKwl9CisJc2VxX3ByaW50ZihtLCAiRGVlcCBSQzYgRW5hYmxlZDogJXNcbiIsCisJ
CSAgIHllc25vKHJjY3RsMSAmIEdFTjZfUkNfQ1RMX1JDNnBfRU5BQkxFKSk7CisJc2VxX3ByaW50
ZihtLCAiRGVlcGVzdCBSQzYgRW5hYmxlZDogJXNcbiIsCisJCSAgIHllc25vKHJjY3RsMSAmIEdF
TjZfUkNfQ1RMX1JDNnBwX0VOQUJMRSkpOworCXNlcV9wdXRzKG0sICJDdXJyZW50IFJDIHN0YXRl
OiAiKTsKKwlzd2l0Y2ggKGd0X2NvcmVfc3RhdHVzICYgR0VONl9SQ25fTUFTSykgeworCWNhc2Ug
R0VONl9SQzA6CisJCWlmIChndF9jb3JlX3N0YXR1cyAmIEdFTjZfQ09SRV9DUERfU1RBVEVfTUFT
SykKKwkJCXNlcV9wdXRzKG0sICJDb3JlIFBvd2VyIERvd25cbiIpOworCQllbHNlCisJCQlzZXFf
cHV0cyhtLCAib25cbiIpOworCQlicmVhazsKKwljYXNlIEdFTjZfUkMzOgorCQlzZXFfcHV0cyht
LCAiUkMzXG4iKTsKKwkJYnJlYWs7CisJY2FzZSBHRU42X1JDNjoKKwkJc2VxX3B1dHMobSwgIlJD
NlxuIik7CisJCWJyZWFrOworCWNhc2UgR0VONl9SQzc6CisJCXNlcV9wdXRzKG0sICJSQzdcbiIp
OworCQlicmVhazsKKwlkZWZhdWx0OgorCQlzZXFfcHV0cyhtLCAiVW5rbm93blxuIik7CisJCWJy
ZWFrOworCX0KKworCXNlcV9wcmludGYobSwgIkNvcmUgUG93ZXIgRG93bjogJXNcbiIsCisJCSAg
IHllc25vKGd0X2NvcmVfc3RhdHVzICYgR0VONl9DT1JFX0NQRF9TVEFURV9NQVNLKSk7CisJaWYg
KElOVEVMX0dFTihpOTE1KSA+PSA5KSB7CisJCXNlcV9wcmludGYobSwgIlJlbmRlciBQb3dlciBX
ZWxsOiAlc1xuIiwKKwkJCShnZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgJgorCQkJIEdFTjlfUFdSR1Rf
UkVOREVSX1NUQVRVU19NQVNLKSA/ICJVcCIgOiAiRG93biIpOworCQlzZXFfcHJpbnRmKG0sICJN
ZWRpYSBQb3dlciBXZWxsOiAlc1xuIiwKKwkJCShnZW45X3Bvd2VyZ2F0ZV9zdGF0dXMgJgorCQkJ
IEdFTjlfUFdSR1RfTUVESUFfU1RBVFVTX01BU0spID8gIlVwIiA6ICJEb3duIik7CisJfQorCisJ
LyogTm90IGV4YWN0bHkgc3VyZSB3aGF0IHRoaXMgaXMgKi8KKwlwcmludF9yYzZfcmVzKG0sICJS
QzYgXCJMb2NrZWQgdG8gUlBuXCIgcmVzaWRlbmN5IHNpbmNlIGJvb3Q6IiwKKwkJICAgICAgR0VO
Nl9HVF9HRlhfUkM2X0xPQ0tFRCk7CisJcHJpbnRfcmM2X3JlcyhtLCAiUkM2IHJlc2lkZW5jeSBz
aW5jZSBib290OiIsIEdFTjZfR1RfR0ZYX1JDNik7CisJcHJpbnRfcmM2X3JlcyhtLCAiUkM2KyBy
ZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBHRU42X0dUX0dGWF9SQzZwKTsKKwlwcmludF9yYzZfcmVz
KG0sICJSQzYrKyByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBHRU42X0dUX0dGWF9SQzZwcCk7CisK
KwlpZiAoSU5URUxfR0VOKGk5MTUpIDw9IDcpIHsKKwkJc2VxX3ByaW50ZihtLCAiUkM2ICAgdm9s
dGFnZTogJWRtVlxuIiwKKwkJCSAgIEdFTjZfREVDT0RFX1JDNl9WSUQoKChyYzZ2aWRzID4+IDAp
ICYgMHhmZikpKTsKKwkJc2VxX3ByaW50ZihtLCAiUkM2KyAgdm9sdGFnZTogJWRtVlxuIiwKKwkJ
CSAgIEdFTjZfREVDT0RFX1JDNl9WSUQoKChyYzZ2aWRzID4+IDgpICYgMHhmZikpKTsKKwkJc2Vx
X3ByaW50ZihtLCAiUkM2Kysgdm9sdGFnZTogJWRtVlxuIiwKKwkJCSAgIEdFTjZfREVDT0RFX1JD
Nl9WSUQoKChyYzZ2aWRzID4+IDE2KSAmIDB4ZmYpKSk7CisJfQorCisJcmV0dXJuIGk5MTVfZm9y
Y2V3YWtlX2RvbWFpbnMobSwgTlVMTCk7Cit9CisKK3N0YXRpYyBpbnQgaXJvbmxha2VfZHJwY19p
bmZvKHN0cnVjdCBzZXFfZmlsZSAqbSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUgPSAmaTkxNS0+dW5jb3JlOworCXUzMiByZ3Ztb2RlY3RsLCByc3RkYnljdGw7CisJdTE2IGNy
c3RhbmR2aWQ7CisKKwlyZ3Ztb2RlY3RsID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBNRU1N
T0RFQ1RMKTsKKwlyc3RkYnljdGwgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFJTVERCWUNU
TCk7CisJY3JzdGFuZHZpZCA9IGludGVsX3VuY29yZV9yZWFkMTYodW5jb3JlLCBDUlNUQU5EVklE
KTsKKworCXNlcV9wcmludGYobSwgIkhEIGJvb3N0OiAlc1xuIiwgeWVzbm8ocmd2bW9kZWN0bCAm
IE1FTU1PREVfQk9PU1RfRU4pKTsKKwlzZXFfcHJpbnRmKG0sICJCb29zdCBmcmVxOiAlZFxuIiwK
KwkJICAgKHJndm1vZGVjdGwgJiBNRU1NT0RFX0JPT1NUX0ZSRVFfTUFTSykgPj4KKwkJICAgTUVN
TU9ERV9CT09TVF9GUkVRX1NISUZUKTsKKwlzZXFfcHJpbnRmKG0sICJIVyBjb250cm9sIGVuYWJs
ZWQ6ICVzXG4iLAorCQkgICB5ZXNubyhyZ3Ztb2RlY3RsICYgTUVNTU9ERV9IV0lETEVfRU4pKTsK
KwlzZXFfcHJpbnRmKG0sICJTVyBjb250cm9sIGVuYWJsZWQ6ICVzXG4iLAorCQkgICB5ZXNubyhy
Z3Ztb2RlY3RsICYgTUVNTU9ERV9TV01PREVfRU4pKTsKKwlzZXFfcHJpbnRmKG0sICJHYXRlZCB2
b2x0YWdlIGNoYW5nZTogJXNcbiIsCisJCSAgIHllc25vKHJndm1vZGVjdGwgJiBNRU1NT0RFX1JD
TEtfR0FURSkpOworCXNlcV9wcmludGYobSwgIlN0YXJ0aW5nIGZyZXF1ZW5jeTogUCVkXG4iLAor
CQkgICAocmd2bW9kZWN0bCAmIE1FTU1PREVfRlNUQVJUX01BU0spID4+IE1FTU1PREVfRlNUQVJU
X1NISUZUKTsKKwlzZXFfcHJpbnRmKG0sICJNYXggUC1zdGF0ZTogUCVkXG4iLAorCQkgICAocmd2
bW9kZWN0bCAmIE1FTU1PREVfRk1BWF9NQVNLKSA+PiBNRU1NT0RFX0ZNQVhfU0hJRlQpOworCXNl
cV9wcmludGYobSwgIk1pbiBQLXN0YXRlOiBQJWRcbiIsIChyZ3Ztb2RlY3RsICYgTUVNTU9ERV9G
TUlOX01BU0spKTsKKwlzZXFfcHJpbnRmKG0sICJSUzEgVklEOiAlZFxuIiwgKGNyc3RhbmR2aWQg
JiAweDNmKSk7CisJc2VxX3ByaW50ZihtLCAiUlMyIFZJRDogJWRcbiIsICgoY3JzdGFuZHZpZCA+
PiA4KSAmIDB4M2YpKTsKKwlzZXFfcHJpbnRmKG0sICJSZW5kZXIgc3RhbmRieSBlbmFibGVkOiAl
c1xuIiwKKwkJICAgeWVzbm8oIShyc3RkYnljdGwgJiBSQ1hfU1dfRVhJVCkpKTsKKwlzZXFfcHV0
cyhtLCAiQ3VycmVudCBSUyBzdGF0ZTogIik7CisJc3dpdGNoIChyc3RkYnljdGwgJiBSU1hfU1RB
VFVTX01BU0spIHsKKwljYXNlIFJTWF9TVEFUVVNfT046CisJCXNlcV9wdXRzKG0sICJvblxuIik7
CisJCWJyZWFrOworCWNhc2UgUlNYX1NUQVRVU19SQzE6CisJCXNlcV9wdXRzKG0sICJSQzFcbiIp
OworCQlicmVhazsKKwljYXNlIFJTWF9TVEFUVVNfUkMxRToKKwkJc2VxX3B1dHMobSwgIlJDMUVc
biIpOworCQlicmVhazsKKwljYXNlIFJTWF9TVEFUVVNfUlMxOgorCQlzZXFfcHV0cyhtLCAiUlMx
XG4iKTsKKwkJYnJlYWs7CisJY2FzZSBSU1hfU1RBVFVTX1JTMjoKKwkJc2VxX3B1dHMobSwgIlJT
MiAoUkM2KVxuIik7CisJCWJyZWFrOworCWNhc2UgUlNYX1NUQVRVU19SUzM6CisJCXNlcV9wdXRz
KG0sICJSQzMgKFJDNispXG4iKTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJc2VxX3B1dHMobSwg
InVua25vd25cbiIpOworCQlicmVhazsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGlu
dCBpOTE1X2RycGNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKK3sKKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsK
KwlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKKwlpbnQgZXJyID0gLUVOT0RFVjsKKworCXdpdGhf
aW50ZWxfcnVudGltZV9wbSgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZikgeworCQlpZiAoSVNf
VkFMTEVZVklFVyhpOTE1KSB8fCBJU19DSEVSUllWSUVXKGk5MTUpKQorCQkJZXJyID0gdmx2X2Ry
cGNfaW5mbyhtKTsKKwkJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCisJCQllcnIgPSBn
ZW42X2RycGNfaW5mbyhtKTsKKwkJZWxzZQorCQkJZXJyID0gaXJvbmxha2VfZHJwY19pbmZvKG0p
OworCX0KKworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgaTkxNV9sbGMoc3RydWN0IHNl
cV9maWxlICptLCB2b2lkICpkYXRhKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKKwljb25zdCBib29sIGVkcmFtID0gSU5U
RUxfR0VOKGRldl9wcml2KSA+IDg7CisKKwlzZXFfcHJpbnRmKG0sICJMTEM6ICVzXG4iLCB5ZXNu
byhIQVNfTExDKGRldl9wcml2KSkpOworCXNlcV9wcmludGYobSwgIiVzOiAldU1CXG4iLCBlZHJh
bSA/ICJlRFJBTSIgOiAiZUxMQyIsCisJCSAgIGRldl9wcml2LT5lZHJhbV9zaXplX21iKTsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9pbmZvX2xpc3QgaTkxNV9n
dF9wbV9kZWJ1Z2ZzX2xpc3RbXSA9IHsKKwl7Imk5MTVfZnJlcXVlbmN5X2luZm8iLCBpOTE1X2Zy
ZXF1ZW5jeV9pbmZvLCAwfSwKKwl7Imk5MTVfcmluZ19mcmVxX3RhYmxlIiwgaTkxNV9yaW5nX2Zy
ZXFfdGFibGUsIDB9LAorCXsiaTkxNV9ycHNfYm9vc3RfaW5mbyIsIGk5MTVfcnBzX2Jvb3N0X2lu
Zm8sIDB9LAorCXsiaTkxNV9mb3JjZXdha2VfZG9tYWlucyIsIGk5MTVfZm9yY2V3YWtlX2RvbWFp
bnMsIDB9LAorCXsiaTkxNV9kcnBjX2luZm8iLCBpOTE1X2RycGNfaW5mbywgMH0sCisJeyJpOTE1
X2xsYyIsIGk5MTVfbGxjLCAwfSwKK307CisKK2ludCBpbnRlbF9ndF9wbV9kZWJ1Z2ZzX3JlZ2lz
dGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7CisJc3RydWN0IGRybV9taW5vciAqbWlub3IgPSBn
dC0+aTkxNS0+ZHJtLnByaW1hcnk7CisKKwlyZXR1cm4gZHJtX2RlYnVnZnNfY3JlYXRlX2ZpbGVz
KGk5MTVfZ3RfcG1fZGVidWdmc19saXN0LAorCQkJCQlBUlJBWV9TSVpFKGk5MTVfZ3RfcG1fZGVi
dWdmc19saXN0KSwKKwkJCQkJZ3QtPmRlYnVnZnNfZW50cnksIG1pbm9yKTsKK30KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfcG0uaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2RlYnVnZnNfcG0uaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAw
MDAwMDAuLmI2MWM2YmM4YTY5NAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2RlYnVnZnNfcG0uaApAQCAtMCwwICsxLDE2IEBACisvKgorICogU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0
aW9uCisgKi8KKworI2lmbmRlZiBERUJVR0ZTX1BNCisjZGVmaW5lIERFQlVHRlNfUE0KKworI2lu
Y2x1ZGUgPGxpbnV4L3NlcV9maWxlLmg+CisKKyNpbmNsdWRlICJpbnRlbF9ndF90eXBlcy5oIgor
CitpbnQgaW50ZWxfZ3RfcG1fZGVidWdmc19yZWdpc3RlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsK
KworI2VuZGlmIC8qIERFQlVHRlNfUE0gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2d0X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9n
dF90eXBlcy5oCmluZGV4IGQ0ZTE0ZGJkMTcyZS4uMzMyYjA4NGY5YzA0IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmgKQEAgLTkwLDYgKzkwLDkgQEAgc3RydWN0IGlu
dGVsX2d0IHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmVbSTkxNV9OVU1fRU5HSU5F
U107CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lX2NsYXNzW01BWF9FTkdJTkVfQ0xB
U1MgKyAxXQogCQkJCQkgICAgW01BWF9FTkdJTkVfSU5TVEFOQ0UgKyAxXTsKKworCS8qKiBAZGVi
dWdmc19lbnRyeTogZGVidWdmcyBkaXJlY3RvcnkgZm9yIHRoaXMgR1QgKi8KKwlzdHJ1Y3QgZGVu
dHJ5ICpkZWJ1Z2ZzX2VudHJ5OwogfTsKIAogZW51bSBpbnRlbF9ndF9zY3JhdGNoX2ZpZWxkIHsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggM2VjMjZiNmE0OGMxLi4yNDZiZjM3
Mjc4NTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC0yOSw3ICsyOSw2IEBA
CiAjaW5jbHVkZSA8bGludXgvc2NoZWQvbW0uaD4KICNpbmNsdWRlIDxsaW51eC9zb3J0Lmg+CiAK
LSNpbmNsdWRlIDxkcm0vZHJtX2RlYnVnZnMuaD4KICNpbmNsdWRlIDxkcm0vZHJtX2ZvdXJjYy5o
PgogCiAjaW5jbHVkZSAiZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgiCkBAIC00MCwxMSAr
MzksMTAgQEAKICNpbmNsdWRlICJkaXNwbGF5L2ludGVsX3Bzci5oIgogCiAjaW5jbHVkZSAiZ2Vt
L2k5MTVfZ2VtX2NvbnRleHQuaCIKKyNpbmNsdWRlICJndC9kZWJ1Z2ZzX2d0LmgiCiAjaW5jbHVk
ZSAiZ3QvaW50ZWxfZ3RfcG0uaCIKICNpbmNsdWRlICJndC9pbnRlbF9ndF9yZXF1ZXN0cy5oIgog
I2luY2x1ZGUgImd0L2ludGVsX3Jlc2V0LmgiCi0jaW5jbHVkZSAiZ3QvaW50ZWxfcmM2LmgiCi0j
aW5jbHVkZSAiZ3QvaW50ZWxfcnBzLmgiCiAjaW5jbHVkZSAiZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1p
c3Npb24uaCIKIAogI2luY2x1ZGUgImk5MTVfZGVidWdmcy5oIgpAQCAtNTQsMTEgKzUyLDYgQEAK
ICNpbmNsdWRlICJpbnRlbF9wbS5oIgogI2luY2x1ZGUgImludGVsX3NpZGViYW5kLmgiCiAKLXN0
YXRpYyBpbmxpbmUgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKm5vZGVfdG9faTkxNShzdHJ1Y3Qg
ZHJtX2luZm9fbm9kZSAqbm9kZSkKLXsKLQlyZXR1cm4gdG9faTkxNShub2RlLT5taW5vci0+ZGV2
KTsKLX0KLQogc3RhdGljIGludCBpOTE1X2NhcGFiaWxpdGllcyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKmRhdGEpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3Rv
X2k5MTUobS0+cHJpdmF0ZSk7CkBAIC03NzgsNDQzICs3NzEsNiBAQCBzdGF0aWMgY29uc3Qgc3Ry
dWN0IGZpbGVfb3BlcmF0aW9ucyBpOTE1X2Vycm9yX3N0YXRlX2ZvcHMgPSB7CiB9OwogI2VuZGlm
CiAKLXN0YXRpYyBpbnQgaTkxNV9mcmVxdWVuY3lfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKnVudXNlZCkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2Rl
X3RvX2k5MTUobS0+cHJpdmF0ZSk7Ci0Jc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRl
dl9wcml2LT51bmNvcmU7Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndC5y
cHM7Ci0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0JaW50IHJldCA9IDA7Ci0KLQl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKLQotCWlmIChJ
U19HRU4oZGV2X3ByaXYsIDUpKSB7Ci0JCXUxNiByZ3Zzd2N0bCA9IGludGVsX3VuY29yZV9yZWFk
MTYodW5jb3JlLCBNRU1TV0NUTCk7Ci0JCXUxNiByZ3ZzdGF0ID0gaW50ZWxfdW5jb3JlX3JlYWQx
Nih1bmNvcmUsIE1FTVNUQVRfSUxLKTsKLQotCQlzZXFfcHJpbnRmKG0sICJSZXF1ZXN0ZWQgUC1z
dGF0ZTogJWRcbiIsIChyZ3Zzd2N0bCA+PiA4KSAmIDB4Zik7Ci0JCXNlcV9wcmludGYobSwgIlJl
cXVlc3RlZCBWSUQ6ICVkXG4iLCByZ3Zzd2N0bCAmIDB4M2YpOwotCQlzZXFfcHJpbnRmKG0sICJD
dXJyZW50IFZJRDogJWRcbiIsIChyZ3ZzdGF0ICYgTUVNU1RBVF9WSURfTUFTSykgPj4KLQkJCSAg
IE1FTVNUQVRfVklEX1NISUZUKTsKLQkJc2VxX3ByaW50ZihtLCAiQ3VycmVudCBQLXN0YXRlOiAl
ZFxuIiwKLQkJCSAgIChyZ3ZzdGF0ICYgTUVNU1RBVF9QU1RBVEVfTUFTSykgPj4gTUVNU1RBVF9Q
U1RBVEVfU0hJRlQpOwotCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNf
Q0hFUlJZVklFVyhkZXZfcHJpdikpIHsKLQkJdTMyIHJwbW9kZWN0bCwgZnJlcV9zdHM7Ci0KLQkJ
cnBtb2RlY3RsID0gSTkxNV9SRUFEKEdFTjZfUlBfQ09OVFJPTCk7Ci0JCXNlcV9wcmludGYobSwg
IlZpZGVvIFR1cmJvIE1vZGU6ICVzXG4iLAotCQkJICAgeWVzbm8ocnBtb2RlY3RsICYgR0VONl9S
UF9NRURJQV9UVVJCTykpOwotCQlzZXFfcHJpbnRmKG0sICJIVyBjb250cm9sIGVuYWJsZWQ6ICVz
XG4iLAotCQkJICAgeWVzbm8ocnBtb2RlY3RsICYgR0VONl9SUF9FTkFCTEUpKTsKLQkJc2VxX3By
aW50ZihtLCAiU1cgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKLQkJCSAgIHllc25vKChycG1vZGVj
dGwgJiBHRU42X1JQX01FRElBX01PREVfTUFTSykgPT0KLQkJCQkgIEdFTjZfUlBfTUVESUFfU1df
TU9ERSkpOwotCi0JCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOwotCQlmcmVxX3N0cyA9IHZsdl9w
dW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTKTsKLQkJdmx2X3B1bml0
X3B1dChkZXZfcHJpdik7Ci0KLQkJc2VxX3ByaW50ZihtLCAiUFVOSVRfUkVHX0dQVV9GUkVRX1NU
UzogMHglMDh4XG4iLCBmcmVxX3N0cyk7Ci0JCXNlcV9wcmludGYobSwgIkREUiBmcmVxOiAlZCBN
SHpcbiIsIGRldl9wcml2LT5tZW1fZnJlcSk7Ci0KLQkJc2VxX3ByaW50ZihtLCAiYWN0dWFsIEdQ
VSBmcmVxOiAlZCBNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIChmcmVxX3N0cyA+
PiA4KSAmIDB4ZmYpKTsKLQotCQlzZXFfcHJpbnRmKG0sICJjdXJyZW50IEdQVSBmcmVxOiAlZCBN
SHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+Y3VyX2ZyZXEpKTsKLQotCQlz
ZXFfcHJpbnRmKG0sICJtYXggR1BVIGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9m
cmVxKHJwcywgcnBzLT5tYXhfZnJlcSkpOwotCi0JCXNlcV9wcmludGYobSwgIm1pbiBHUFUgZnJl
cTogJWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1pbl9mcmVxKSk7
Ci0KLQkJc2VxX3ByaW50ZihtLCAiaWRsZSBHUFUgZnJlcTogJWQgTUh6XG4iLAotCQkJICAgaW50
ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmlkbGVfZnJlcSkpOwotCi0JCXNlcV9wcmludGYobSwKLQkJ
CSAgICJlZmZpY2llbnQgKFJQZSkgZnJlcXVlbmN5OiAlZCBNSHpcbiIsCi0JCQkgICBpbnRlbF9n
cHVfZnJlcShycHMsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpKTsKLQl9IGVsc2UgaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gNikgewotCQl1MzIgcnBfc3RhdGVfbGltaXRzOwotCQl1MzIgZ3RfcGVy
Zl9zdGF0dXM7Ci0JCXUzMiBycF9zdGF0ZV9jYXA7Ci0JCXUzMiBycG1vZGVjdGwsIHJwaW5jbGlt
aXQsIHJwZGVjbGltaXQ7Ci0JCXUzMiBycHN0YXQsIGNhZ2YsIHJlcWY7Ci0JCXUzMiBycHVwZWks
IHJwY3VydXAsIHJwcHJldnVwOwotCQl1MzIgcnBkb3duZWksIHJwY3VyZG93biwgcnBwcmV2ZG93
bjsKLQkJdTMyIHBtX2llciwgcG1faW1yLCBwbV9pc3IsIHBtX2lpciwgcG1fbWFzazsKLQkJaW50
IG1heF9mcmVxOwotCi0JCXJwX3N0YXRlX2xpbWl0cyA9IEk5MTVfUkVBRChHRU42X1JQX1NUQVRF
X0xJTUlUUyk7Ci0JCWlmIChJU19HRU45X0xQKGRldl9wcml2KSkgewotCQkJcnBfc3RhdGVfY2Fw
ID0gSTkxNV9SRUFEKEJYVF9SUF9TVEFURV9DQVApOwotCQkJZ3RfcGVyZl9zdGF0dXMgPSBJOTE1
X1JFQUQoQlhUX0dUX1BFUkZfU1RBVFVTKTsKLQkJfSBlbHNlIHsKLQkJCXJwX3N0YXRlX2NhcCA9
IEk5MTVfUkVBRChHRU42X1JQX1NUQVRFX0NBUCk7Ci0JCQlndF9wZXJmX3N0YXR1cyA9IEk5MTVf
UkVBRChHRU42X0dUX1BFUkZfU1RBVFVTKTsKLQkJfQotCi0JCS8qIFJQU1RBVDEgaXMgaW4gdGhl
IEdUIHBvd2VyIHdlbGwgKi8KLQkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2
LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCi0JCXJlcWYgPSBJOTE1X1JFQUQoR0VONl9SUE5T
V1JFUSk7Ci0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCi0JCQlyZXFmID4+PSAyMzsK
LQkJZWxzZSB7Ci0JCQlyZXFmICY9IH5HRU42X1RVUkJPX0RJU0FCTEU7Ci0JCQlpZiAoSVNfSEFT
V0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkKLQkJCQlyZXFmID4+PSAy
NDsKLQkJCWVsc2UKLQkJCQlyZXFmID4+PSAyNTsKLQkJfQotCQlyZXFmID0gaW50ZWxfZ3B1X2Zy
ZXEocnBzLCByZXFmKTsKLQotCQlycG1vZGVjdGwgPSBJOTE1X1JFQUQoR0VONl9SUF9DT05UUk9M
KTsKLQkJcnBpbmNsaW1pdCA9IEk5MTVfUkVBRChHRU42X1JQX1VQX1RIUkVTSE9MRCk7Ci0JCXJw
ZGVjbGltaXQgPSBJOTE1X1JFQUQoR0VONl9SUF9ET1dOX1RIUkVTSE9MRCk7Ci0KLQkJcnBzdGF0
ID0gSTkxNV9SRUFEKEdFTjZfUlBTVEFUMSk7Ci0JCXJwdXBlaSA9IEk5MTVfUkVBRChHRU42X1JQ
X0NVUl9VUF9FSSkgJiBHRU42X0NVUklDT05UX01BU0s7Ci0JCXJwY3VydXAgPSBJOTE1X1JFQUQo
R0VONl9SUF9DVVJfVVApICYgR0VONl9DVVJCU1lUQVZHX01BU0s7Ci0JCXJwcHJldnVwID0gSTkx
NV9SRUFEKEdFTjZfUlBfUFJFVl9VUCkgJiBHRU42X0NVUkJTWVRBVkdfTUFTSzsKLQkJcnBkb3du
ZWkgPSBJOTE1X1JFQUQoR0VONl9SUF9DVVJfRE9XTl9FSSkgJiBHRU42X0NVUklBVkdfTUFTSzsK
LQkJcnBjdXJkb3duID0gSTkxNV9SRUFEKEdFTjZfUlBfQ1VSX0RPV04pICYgR0VONl9DVVJCU1lU
QVZHX01BU0s7Ci0JCXJwcHJldmRvd24gPSBJOTE1X1JFQUQoR0VONl9SUF9QUkVWX0RPV04pICYg
R0VONl9DVVJCU1lUQVZHX01BU0s7Ci0JCWNhZ2YgPSBpbnRlbF9ycHNfcmVhZF9hY3R1YWxfZnJl
cXVlbmN5KHJwcyk7Ci0KLQkJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51
bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCi0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEx
KSB7Ci0JCQlwbV9pZXIgPSBJOTE1X1JFQUQoR0VOMTFfR1BNX1dHQk9YUEVSRl9JTlRSX0VOQUJM
RSk7Ci0JCQlwbV9pbXIgPSBJOTE1X1JFQUQoR0VOMTFfR1BNX1dHQk9YUEVSRl9JTlRSX01BU0sp
OwotCQkJLyoKLQkJCSAqIFRoZSBlcXVpdmFsZW50IHRvIHRoZSBQTSBJU1IgJiBJSVIgY2Fubm90
IGJlIHJlYWQKLQkJCSAqIHdpdGhvdXQgYWZmZWN0aW5nIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRo
ZSBzeXN0ZW0KLQkJCSAqLwotCQkJcG1faXNyID0gMDsKLQkJCXBtX2lpciA9IDA7Ci0JCX0gZWxz
ZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA4KSB7Ci0JCQlwbV9pZXIgPSBJOTE1X1JFQUQo
R0VOOF9HVF9JRVIoMikpOwotCQkJcG1faW1yID0gSTkxNV9SRUFEKEdFTjhfR1RfSU1SKDIpKTsK
LQkJCXBtX2lzciA9IEk5MTVfUkVBRChHRU44X0dUX0lTUigyKSk7Ci0JCQlwbV9paXIgPSBJOTE1
X1JFQUQoR0VOOF9HVF9JSVIoMikpOwotCQl9IGVsc2UgewotCQkJcG1faWVyID0gSTkxNV9SRUFE
KEdFTjZfUE1JRVIpOwotCQkJcG1faW1yID0gSTkxNV9SRUFEKEdFTjZfUE1JTVIpOwotCQkJcG1f
aXNyID0gSTkxNV9SRUFEKEdFTjZfUE1JU1IpOwotCQkJcG1faWlyID0gSTkxNV9SRUFEKEdFTjZf
UE1JSVIpOwotCQl9Ci0JCXBtX21hc2sgPSBJOTE1X1JFQUQoR0VONl9QTUlOVFJNU0spOwotCi0J
CXNlcV9wcmludGYobSwgIlZpZGVvIFR1cmJvIE1vZGU6ICVzXG4iLAotCQkJICAgeWVzbm8ocnBt
b2RlY3RsICYgR0VONl9SUF9NRURJQV9UVVJCTykpOwotCQlzZXFfcHJpbnRmKG0sICJIVyBjb250
cm9sIGVuYWJsZWQ6ICVzXG4iLAotCQkJICAgeWVzbm8ocnBtb2RlY3RsICYgR0VONl9SUF9FTkFC
TEUpKTsKLQkJc2VxX3ByaW50ZihtLCAiU1cgY29udHJvbCBlbmFibGVkOiAlc1xuIiwKLQkJCSAg
IHllc25vKChycG1vZGVjdGwgJiBHRU42X1JQX01FRElBX01PREVfTUFTSykgPT0KLQkJCQkgIEdF
TjZfUlBfTUVESUFfU1dfTU9ERSkpOwotCi0JCXNlcV9wcmludGYobSwgIlBNIElFUj0weCUwOHgg
SU1SPTB4JTA4eCwgTUFTSz0weCUwOHhcbiIsCi0JCQkgICBwbV9pZXIsIHBtX2ltciwgcG1fbWFz
ayk7Ci0JCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDEwKQotCQkJc2VxX3ByaW50ZihtLCAi
UE0gSVNSPTB4JTA4eCBJSVI9MHglMDh4XG4iLAotCQkJCSAgIHBtX2lzciwgcG1faWlyKTsKLQkJ
c2VxX3ByaW50ZihtLCAicG1faW50cm1za19tYno6IDB4JTA4eFxuIiwKLQkJCSAgIHJwcy0+cG1f
aW50cm1za19tYnopOwotCQlzZXFfcHJpbnRmKG0sICJHVF9QRVJGX1NUQVRVUzogMHglMDh4XG4i
LCBndF9wZXJmX3N0YXR1cyk7Ci0JCXNlcV9wcmludGYobSwgIlJlbmRlciBwLXN0YXRlIHJhdGlv
OiAlZFxuIiwKLQkJCSAgIChndF9wZXJmX3N0YXR1cyAmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDkgPyAweDFmZjAwIDogMHhmZjAwKSkgPj4gOCk7Ci0JCXNlcV9wcmludGYobSwgIlJlbmRlciBw
LXN0YXRlIFZJRDogJWRcbiIsCi0JCQkgICBndF9wZXJmX3N0YXR1cyAmIDB4ZmYpOwotCQlzZXFf
cHJpbnRmKG0sICJSZW5kZXIgcC1zdGF0ZSBsaW1pdDogJWRcbiIsCi0JCQkgICBycF9zdGF0ZV9s
aW1pdHMgJiAweGZmKTsKLQkJc2VxX3ByaW50ZihtLCAiUlBTVEFUMTogMHglMDh4XG4iLCBycHN0
YXQpOwotCQlzZXFfcHJpbnRmKG0sICJSUE1PREVDVEw6IDB4JTA4eFxuIiwgcnBtb2RlY3RsKTsK
LQkJc2VxX3ByaW50ZihtLCAiUlBJTkNMSU1JVDogMHglMDh4XG4iLCBycGluY2xpbWl0KTsKLQkJ
c2VxX3ByaW50ZihtLCAiUlBERUNMSU1JVDogMHglMDh4XG4iLCBycGRlY2xpbWl0KTsKLQkJc2Vx
X3ByaW50ZihtLCAiUlBOU1dSRVE6ICVkTUh6XG4iLCByZXFmKTsKLQkJc2VxX3ByaW50ZihtLCAi
Q0FHRjogJWRNSHpcbiIsIGNhZ2YpOwotCQlzZXFfcHJpbnRmKG0sICJSUCBDVVIgVVAgRUk6ICVk
ICglZHVzKVxuIiwKLQkJCSAgIHJwdXBlaSwgR1RfUE1fSU5URVJWQUxfVE9fVVMoZGV2X3ByaXYs
IHJwdXBlaSkpOwotCQlzZXFfcHJpbnRmKG0sICJSUCBDVVIgVVA6ICVkICglZHVzKVxuIiwKLQkJ
CSAgIHJwY3VydXAsIEdUX1BNX0lOVEVSVkFMX1RPX1VTKGRldl9wcml2LCBycGN1cnVwKSk7Ci0J
CXNlcV9wcmludGYobSwgIlJQIFBSRVYgVVA6ICVkICglZHVzKVxuIiwKLQkJCSAgIHJwcHJldnVw
LCBHVF9QTV9JTlRFUlZBTF9UT19VUyhkZXZfcHJpdiwgcnBwcmV2dXApKTsKLQkJc2VxX3ByaW50
ZihtLCAiVXAgdGhyZXNob2xkOiAlZCUlXG4iLAotCQkJICAgcnBzLT5wb3dlci51cF90aHJlc2hv
bGQpOwotCi0JCXNlcV9wcmludGYobSwgIlJQIENVUiBET1dOIEVJOiAlZCAoJWR1cylcbiIsCi0J
CQkgICBycGRvd25laSwgR1RfUE1fSU5URVJWQUxfVE9fVVMoZGV2X3ByaXYsIHJwZG93bmVpKSk7
Ci0JCXNlcV9wcmludGYobSwgIlJQIENVUiBET1dOOiAlZCAoJWR1cylcbiIsCi0JCQkgICBycGN1
cmRvd24sIEdUX1BNX0lOVEVSVkFMX1RPX1VTKGRldl9wcml2LCBycGN1cmRvd24pKTsKLQkJc2Vx
X3ByaW50ZihtLCAiUlAgUFJFViBET1dOOiAlZCAoJWR1cylcbiIsCi0JCQkgICBycHByZXZkb3du
LCBHVF9QTV9JTlRFUlZBTF9UT19VUyhkZXZfcHJpdiwgcnBwcmV2ZG93bikpOwotCQlzZXFfcHJp
bnRmKG0sICJEb3duIHRocmVzaG9sZDogJWQlJVxuIiwKLQkJCSAgIHJwcy0+cG93ZXIuZG93bl90
aHJlc2hvbGQpOwotCi0JCW1heF9mcmVxID0gKElTX0dFTjlfTFAoZGV2X3ByaXYpID8gcnBfc3Rh
dGVfY2FwID4+IDAgOgotCQkJICAgIHJwX3N0YXRlX2NhcCA+PiAxNikgJiAweGZmOwotCQltYXhf
ZnJlcSAqPSAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwKLQkJCSAgICAgSU5URUxfR0VOKGRldl9w
cml2KSA+PSAxMCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKLQkJc2VxX3ByaW50ZihtLCAiTG93
ZXN0IChSUE4pIGZyZXF1ZW5jeTogJWRNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMs
IG1heF9mcmVxKSk7Ci0KLQkJbWF4X2ZyZXEgPSAocnBfc3RhdGVfY2FwICYgMHhmZjAwKSA+PiA4
OwotCQltYXhfZnJlcSAqPSAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwKLQkJCSAgICAgSU5URUxf
R0VOKGRldl9wcml2KSA+PSAxMCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKLQkJc2VxX3ByaW50
ZihtLCAiTm9taW5hbCAoUlAxKSBmcmVxdWVuY3k6ICVkTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1
X2ZyZXEocnBzLCBtYXhfZnJlcSkpOwotCi0JCW1heF9mcmVxID0gKElTX0dFTjlfTFAoZGV2X3By
aXYpID8gcnBfc3RhdGVfY2FwID4+IDE2IDoKLQkJCSAgICBycF9zdGF0ZV9jYXAgPj4gMCkgJiAw
eGZmOwotCQltYXhfZnJlcSAqPSAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwKLQkJCSAgICAgSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKTsKLQkJc2VxX3By
aW50ZihtLCAiTWF4IG5vbi1vdmVyY2xvY2tlZCAoUlAwKSBmcmVxdWVuY3k6ICVkTUh6XG4iLAot
CQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBtYXhfZnJlcSkpOwotCQlzZXFfcHJpbnRmKG0sICJN
YXggb3ZlcmNsb2NrZWQgZnJlcXVlbmN5OiAlZE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVx
KHJwcywgcnBzLT5tYXhfZnJlcSkpOwotCi0JCXNlcV9wcmludGYobSwgIkN1cnJlbnQgZnJlcTog
JWQgTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmN1cl9mcmVxKSk7Ci0J
CXNlcV9wcmludGYobSwgIkFjdHVhbCBmcmVxOiAlZCBNSHpcbiIsIGNhZ2YpOwotCQlzZXFfcHJp
bnRmKG0sICJJZGxlIGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywg
cnBzLT5pZGxlX2ZyZXEpKTsKLQkJc2VxX3ByaW50ZihtLCAiTWluIGZyZXE6ICVkIE1IelxuIiwK
LQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5taW5fZnJlcSkpOwotCQlzZXFfcHJpbnRm
KG0sICJCb29zdCBmcmVxOiAlZCBNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJw
cy0+Ym9vc3RfZnJlcSkpOwotCQlzZXFfcHJpbnRmKG0sICJNYXggZnJlcTogJWQgTUh6XG4iLAot
CQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1heF9mcmVxKSk7Ci0JCXNlcV9wcmludGYo
bSwKLQkJCSAgICJlZmZpY2llbnQgKFJQZSkgZnJlcXVlbmN5OiAlZCBNSHpcbiIsCi0JCQkgICBp
bnRlbF9ncHVfZnJlcShycHMsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpKTsKLQl9IGVsc2UgewotCQlz
ZXFfcHV0cyhtLCAibm8gUC1zdGF0ZSBpbmZvIGF2YWlsYWJsZVxuIik7Ci0JfQotCi0Jc2VxX3By
aW50ZihtLCAiQ3VycmVudCBDRCBjbG9jayBmcmVxdWVuY3k6ICVkIGtIelxuIiwgZGV2X3ByaXYt
PmNkY2xrLmh3LmNkY2xrKTsKLQlzZXFfcHJpbnRmKG0sICJNYXggQ0QgY2xvY2sgZnJlcXVlbmN5
OiAlZCBrSHpcbiIsIGRldl9wcml2LT5tYXhfY2RjbGtfZnJlcSk7Ci0Jc2VxX3ByaW50ZihtLCAi
TWF4IHBpeGVsIGNsb2NrIGZyZXF1ZW5jeTogJWQga0h6XG4iLCBkZXZfcHJpdi0+bWF4X2RvdGNs
a19mcmVxKTsKLQotCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwg
d2FrZXJlZik7Ci0JcmV0dXJuIHJldDsKLX0KLQotc3RhdGljIGludCBpcm9ubGFrZV9kcnBjX2lu
Zm8oc3RydWN0IHNlcV9maWxlICptKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29y
ZSA9ICZpOTE1LT51bmNvcmU7Ci0JdTMyIHJndm1vZGVjdGwsIHJzdGRieWN0bDsKLQl1MTYgY3Jz
dGFuZHZpZDsKLQotCXJndm1vZGVjdGwgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIE1FTU1P
REVDVEwpOwotCXJzdGRieWN0bCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgUlNUREJZQ1RM
KTsKLQljcnN0YW5kdmlkID0gaW50ZWxfdW5jb3JlX3JlYWQxNih1bmNvcmUsIENSU1RBTkRWSUQp
OwotCi0Jc2VxX3ByaW50ZihtLCAiSEQgYm9vc3Q6ICVzXG4iLCB5ZXNubyhyZ3Ztb2RlY3RsICYg
TUVNTU9ERV9CT09TVF9FTikpOwotCXNlcV9wcmludGYobSwgIkJvb3N0IGZyZXE6ICVkXG4iLAot
CQkgICAocmd2bW9kZWN0bCAmIE1FTU1PREVfQk9PU1RfRlJFUV9NQVNLKSA+PgotCQkgICBNRU1N
T0RFX0JPT1NUX0ZSRVFfU0hJRlQpOwotCXNlcV9wcmludGYobSwgIkhXIGNvbnRyb2wgZW5hYmxl
ZDogJXNcbiIsCi0JCSAgIHllc25vKHJndm1vZGVjdGwgJiBNRU1NT0RFX0hXSURMRV9FTikpOwot
CXNlcV9wcmludGYobSwgIlNXIGNvbnRyb2wgZW5hYmxlZDogJXNcbiIsCi0JCSAgIHllc25vKHJn
dm1vZGVjdGwgJiBNRU1NT0RFX1NXTU9ERV9FTikpOwotCXNlcV9wcmludGYobSwgIkdhdGVkIHZv
bHRhZ2UgY2hhbmdlOiAlc1xuIiwKLQkJICAgeWVzbm8ocmd2bW9kZWN0bCAmIE1FTU1PREVfUkNM
S19HQVRFKSk7Ci0Jc2VxX3ByaW50ZihtLCAiU3RhcnRpbmcgZnJlcXVlbmN5OiBQJWRcbiIsCi0J
CSAgIChyZ3Ztb2RlY3RsICYgTUVNTU9ERV9GU1RBUlRfTUFTSykgPj4gTUVNTU9ERV9GU1RBUlRf
U0hJRlQpOwotCXNlcV9wcmludGYobSwgIk1heCBQLXN0YXRlOiBQJWRcbiIsCi0JCSAgIChyZ3Zt
b2RlY3RsICYgTUVNTU9ERV9GTUFYX01BU0spID4+IE1FTU1PREVfRk1BWF9TSElGVCk7Ci0Jc2Vx
X3ByaW50ZihtLCAiTWluIFAtc3RhdGU6IFAlZFxuIiwgKHJndm1vZGVjdGwgJiBNRU1NT0RFX0ZN
SU5fTUFTSykpOwotCXNlcV9wcmludGYobSwgIlJTMSBWSUQ6ICVkXG4iLCAoY3JzdGFuZHZpZCAm
IDB4M2YpKTsKLQlzZXFfcHJpbnRmKG0sICJSUzIgVklEOiAlZFxuIiwgKChjcnN0YW5kdmlkID4+
IDgpICYgMHgzZikpOwotCXNlcV9wcmludGYobSwgIlJlbmRlciBzdGFuZGJ5IGVuYWJsZWQ6ICVz
XG4iLAotCQkgICB5ZXNubyghKHJzdGRieWN0bCAmIFJDWF9TV19FWElUKSkpOwotCXNlcV9wdXRz
KG0sICJDdXJyZW50IFJTIHN0YXRlOiAiKTsKLQlzd2l0Y2ggKHJzdGRieWN0bCAmIFJTWF9TVEFU
VVNfTUFTSykgewotCWNhc2UgUlNYX1NUQVRVU19PTjoKLQkJc2VxX3B1dHMobSwgIm9uXG4iKTsK
LQkJYnJlYWs7Ci0JY2FzZSBSU1hfU1RBVFVTX1JDMToKLQkJc2VxX3B1dHMobSwgIlJDMVxuIik7
Ci0JCWJyZWFrOwotCWNhc2UgUlNYX1NUQVRVU19SQzFFOgotCQlzZXFfcHV0cyhtLCAiUkMxRVxu
Iik7Ci0JCWJyZWFrOwotCWNhc2UgUlNYX1NUQVRVU19SUzE6Ci0JCXNlcV9wdXRzKG0sICJSUzFc
biIpOwotCQlicmVhazsKLQljYXNlIFJTWF9TVEFUVVNfUlMyOgotCQlzZXFfcHV0cyhtLCAiUlMy
IChSQzYpXG4iKTsKLQkJYnJlYWs7Ci0JY2FzZSBSU1hfU1RBVFVTX1JTMzoKLQkJc2VxX3B1dHMo
bSwgIlJDMyAoUkM2KylcbiIpOwotCQlicmVhazsKLQlkZWZhdWx0OgotCQlzZXFfcHV0cyhtLCAi
dW5rbm93blxuIik7Ci0JCWJyZWFrOwotCX0KLQotCXJldHVybiAwOwotfQotCi1zdGF0aWMgaW50
IGk5MTVfZm9yY2V3YWtlX2RvbWFpbnMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQot
ewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZh
dGUpOwotCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7Ci0Jc3Ry
dWN0IGludGVsX3VuY29yZV9mb3JjZXdha2VfZG9tYWluICpmd19kb21haW47Ci0JdW5zaWduZWQg
aW50IHRtcDsKLQotCXNlcV9wcmludGYobSwgInVzZXIuYnlwYXNzX2NvdW50ID0gJXVcbiIsCi0J
CSAgIHVuY29yZS0+dXNlcl9mb3JjZXdha2VfY291bnQpOwotCi0JZm9yX2VhY2hfZndfZG9tYWlu
KGZ3X2RvbWFpbiwgdW5jb3JlLCB0bXApCi0JCXNlcV9wcmludGYobSwgIiVzLndha2VfY291bnQg
PSAldVxuIiwKLQkJCSAgIGludGVsX3VuY29yZV9mb3JjZXdha2VfZG9tYWluX3RvX3N0cihmd19k
b21haW4tPmlkKSwKLQkJCSAgIFJFQURfT05DRShmd19kb21haW4tPndha2VfY291bnQpKTsKLQot
CXJldHVybiAwOwotfQotCi1zdGF0aWMgdm9pZCBwcmludF9yYzZfcmVzKHN0cnVjdCBzZXFfZmls
ZSAqbSwKLQkJCSAgY29uc3QgY2hhciAqdGl0bGUsCi0JCQkgIGNvbnN0IGk5MTVfcmVnX3QgcmVn
KQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnBy
aXZhdGUpOwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCi0Jd2l0aF9pbnRlbF9ydW50aW1l
X3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKQotCQlzZXFfcHJpbnRmKG0sICIlcyAldSAo
JWxsdSB1cylcbiIsIHRpdGxlLAotCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQoJmk5MTUtPnVuY29y
ZSwgcmVnKSwKLQkJCSAgIGludGVsX3JjNl9yZXNpZGVuY3lfdXMoJmk5MTUtPmd0LnJjNiwgcmVn
KSk7Ci19Ci0KLXN0YXRpYyBpbnQgdmx2X2RycGNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0pCi17
Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnBy
aXZhdGUpOwotCXUzMiByY2N0bDEsIHB3X3N0YXR1czsKLQotCXB3X3N0YXR1cyA9IEk5MTVfUkVB
RChWTFZfR1RMQ19QV19TVEFUVVMpOwotCXJjY3RsMSA9IEk5MTVfUkVBRChHRU42X1JDX0NPTlRS
T0wpOwotCi0Jc2VxX3ByaW50ZihtLCAiUkM2IEVuYWJsZWQ6ICVzXG4iLAotCQkgICB5ZXNubyhy
Y2N0bDEgJiAoR0VON19SQ19DVExfVE9fTU9ERSB8Ci0JCQkJCUdFTjZfUkNfQ1RMX0VJX01PREUo
MSkpKSk7Ci0Jc2VxX3ByaW50ZihtLCAiUmVuZGVyIFBvd2VyIFdlbGw6ICVzXG4iLAotCQkgICAo
cHdfc3RhdHVzICYgVkxWX0dUTENfUFdfUkVOREVSX1NUQVRVU19NQVNLKSA/ICJVcCIgOiAiRG93
biIpOwotCXNlcV9wcmludGYobSwgIk1lZGlhIFBvd2VyIFdlbGw6ICVzXG4iLAotCQkgICAocHdf
c3RhdHVzICYgVkxWX0dUTENfUFdfTUVESUFfU1RBVFVTX01BU0spID8gIlVwIiA6ICJEb3duIik7
Ci0KLQlwcmludF9yYzZfcmVzKG0sICJSZW5kZXIgUkM2IHJlc2lkZW5jeSBzaW5jZSBib290OiIs
IFZMVl9HVF9SRU5ERVJfUkM2KTsKLQlwcmludF9yYzZfcmVzKG0sICJNZWRpYSBSQzYgcmVzaWRl
bmN5IHNpbmNlIGJvb3Q6IiwgVkxWX0dUX01FRElBX1JDNik7Ci0KLQlyZXR1cm4gaTkxNV9mb3Jj
ZXdha2VfZG9tYWlucyhtLCBOVUxMKTsKLX0KLQotc3RhdGljIGludCBnZW42X2RycGNfaW5mbyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0pCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCXUzMiBndF9jb3JlX3N0YXR1cywgcmNjdGwx
LCByYzZ2aWRzID0gMDsKLQl1MzIgZ2VuOV9wb3dlcmdhdGVfZW5hYmxlID0gMCwgZ2VuOV9wb3dl
cmdhdGVfc3RhdHVzID0gMDsKLQotCWd0X2NvcmVfc3RhdHVzID0gSTkxNV9SRUFEX0ZXKEdFTjZf
R1RfQ09SRV9TVEFUVVMpOwotCXRyYWNlX2k5MTVfcmVnX3J3KGZhbHNlLCBHRU42X0dUX0NPUkVf
U1RBVFVTLCBndF9jb3JlX3N0YXR1cywgNCwgdHJ1ZSk7Ci0KLQlyY2N0bDEgPSBJOTE1X1JFQUQo
R0VONl9SQ19DT05UUk9MKTsKLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Ci0JCWdl
bjlfcG93ZXJnYXRlX2VuYWJsZSA9IEk5MTVfUkVBRChHRU45X1BHX0VOQUJMRSk7Ci0JCWdlbjlf
cG93ZXJnYXRlX3N0YXR1cyA9IEk5MTVfUkVBRChHRU45X1BXUkdUX0RPTUFJTl9TVEFUVVMpOwot
CX0KLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDcpCi0JCXNhbmR5YnJpZGdlX3Bjb2Rl
X3JlYWQoZGV2X3ByaXYsIEdFTjZfUENPREVfUkVBRF9SQzZWSURTLAotCQkJCSAgICAgICAmcmM2
dmlkcywgTlVMTCk7Ci0KLQlzZXFfcHJpbnRmKG0sICJSQzFlIEVuYWJsZWQ6ICVzXG4iLAotCQkg
ICB5ZXNubyhyY2N0bDEgJiBHRU42X1JDX0NUTF9SQzFlX0VOQUJMRSkpOwotCXNlcV9wcmludGYo
bSwgIlJDNiBFbmFibGVkOiAlc1xuIiwKLQkJICAgeWVzbm8ocmNjdGwxICYgR0VONl9SQ19DVExf
UkM2X0VOQUJMRSkpOwotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpIHsKLQkJc2VxX3By
aW50ZihtLCAiUmVuZGVyIFdlbGwgR2F0aW5nIEVuYWJsZWQ6ICVzXG4iLAotCQkJeWVzbm8oZ2Vu
OV9wb3dlcmdhdGVfZW5hYmxlICYgR0VOOV9SRU5ERVJfUEdfRU5BQkxFKSk7Ci0JCXNlcV9wcmlu
dGYobSwgIk1lZGlhIFdlbGwgR2F0aW5nIEVuYWJsZWQ6ICVzXG4iLAotCQkJeWVzbm8oZ2VuOV9w
b3dlcmdhdGVfZW5hYmxlICYgR0VOOV9NRURJQV9QR19FTkFCTEUpKTsKLQl9Ci0Jc2VxX3ByaW50
ZihtLCAiRGVlcCBSQzYgRW5hYmxlZDogJXNcbiIsCi0JCSAgIHllc25vKHJjY3RsMSAmIEdFTjZf
UkNfQ1RMX1JDNnBfRU5BQkxFKSk7Ci0Jc2VxX3ByaW50ZihtLCAiRGVlcGVzdCBSQzYgRW5hYmxl
ZDogJXNcbiIsCi0JCSAgIHllc25vKHJjY3RsMSAmIEdFTjZfUkNfQ1RMX1JDNnBwX0VOQUJMRSkp
OwotCXNlcV9wdXRzKG0sICJDdXJyZW50IFJDIHN0YXRlOiAiKTsKLQlzd2l0Y2ggKGd0X2NvcmVf
c3RhdHVzICYgR0VONl9SQ25fTUFTSykgewotCWNhc2UgR0VONl9SQzA6Ci0JCWlmIChndF9jb3Jl
X3N0YXR1cyAmIEdFTjZfQ09SRV9DUERfU1RBVEVfTUFTSykKLQkJCXNlcV9wdXRzKG0sICJDb3Jl
IFBvd2VyIERvd25cbiIpOwotCQllbHNlCi0JCQlzZXFfcHV0cyhtLCAib25cbiIpOwotCQlicmVh
azsKLQljYXNlIEdFTjZfUkMzOgotCQlzZXFfcHV0cyhtLCAiUkMzXG4iKTsKLQkJYnJlYWs7Ci0J
Y2FzZSBHRU42X1JDNjoKLQkJc2VxX3B1dHMobSwgIlJDNlxuIik7Ci0JCWJyZWFrOwotCWNhc2Ug
R0VONl9SQzc6Ci0JCXNlcV9wdXRzKG0sICJSQzdcbiIpOwotCQlicmVhazsKLQlkZWZhdWx0Ogot
CQlzZXFfcHV0cyhtLCAiVW5rbm93blxuIik7Ci0JCWJyZWFrOwotCX0KLQotCXNlcV9wcmludGYo
bSwgIkNvcmUgUG93ZXIgRG93bjogJXNcbiIsCi0JCSAgIHllc25vKGd0X2NvcmVfc3RhdHVzICYg
R0VONl9DT1JFX0NQRF9TVEFURV9NQVNLKSk7Ci0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
OSkgewotCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgUG93ZXIgV2VsbDogJXNcbiIsCi0JCQkoZ2Vu
OV9wb3dlcmdhdGVfc3RhdHVzICYKLQkJCSBHRU45X1BXUkdUX1JFTkRFUl9TVEFUVVNfTUFTSykg
PyAiVXAiIDogIkRvd24iKTsKLQkJc2VxX3ByaW50ZihtLCAiTWVkaWEgUG93ZXIgV2VsbDogJXNc
biIsCi0JCQkoZ2VuOV9wb3dlcmdhdGVfc3RhdHVzICYKLQkJCSBHRU45X1BXUkdUX01FRElBX1NU
QVRVU19NQVNLKSA/ICJVcCIgOiAiRG93biIpOwotCX0KLQotCS8qIE5vdCBleGFjdGx5IHN1cmUg
d2hhdCB0aGlzIGlzICovCi0JcHJpbnRfcmM2X3JlcyhtLCAiUkM2IFwiTG9ja2VkIHRvIFJQblwi
IHJlc2lkZW5jeSBzaW5jZSBib290OiIsCi0JCSAgICAgIEdFTjZfR1RfR0ZYX1JDNl9MT0NLRUQp
OwotCXByaW50X3JjNl9yZXMobSwgIlJDNiByZXNpZGVuY3kgc2luY2UgYm9vdDoiLCBHRU42X0dU
X0dGWF9SQzYpOwotCXByaW50X3JjNl9yZXMobSwgIlJDNisgcmVzaWRlbmN5IHNpbmNlIGJvb3Q6
IiwgR0VONl9HVF9HRlhfUkM2cCk7Ci0JcHJpbnRfcmM2X3JlcyhtLCAiUkM2KysgcmVzaWRlbmN5
IHNpbmNlIGJvb3Q6IiwgR0VONl9HVF9HRlhfUkM2cHApOwotCi0JaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPD0gNykgewotCQlzZXFfcHJpbnRmKG0sICJSQzYgICB2b2x0YWdlOiAlZG1WXG4iLAot
CQkJICAgR0VONl9ERUNPREVfUkM2X1ZJRCgoKHJjNnZpZHMgPj4gMCkgJiAweGZmKSkpOwotCQlz
ZXFfcHJpbnRmKG0sICJSQzYrICB2b2x0YWdlOiAlZG1WXG4iLAotCQkJICAgR0VONl9ERUNPREVf
UkM2X1ZJRCgoKHJjNnZpZHMgPj4gOCkgJiAweGZmKSkpOwotCQlzZXFfcHJpbnRmKG0sICJSQzYr
KyB2b2x0YWdlOiAlZG1WXG4iLAotCQkJICAgR0VONl9ERUNPREVfUkM2X1ZJRCgoKHJjNnZpZHMg
Pj4gMTYpICYgMHhmZikpKTsKLQl9Ci0KLQlyZXR1cm4gaTkxNV9mb3JjZXdha2VfZG9tYWlucyht
LCBOVUxMKTsKLX0KLQotc3RhdGljIGludCBpOTE1X2RycGNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0sIHZvaWQgKnVudXNlZCkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSBub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSk7Ci0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0J
aW50IGVyciA9IC1FTk9ERVY7Ci0KLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmRldl9wcml2LT5y
dW50aW1lX3BtLCB3YWtlcmVmKSB7Ci0JCWlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJ
U19DSEVSUllWSUVXKGRldl9wcml2KSkKLQkJCWVyciA9IHZsdl9kcnBjX2luZm8obSk7Ci0JCWVs
c2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikKLQkJCWVyciA9IGdlbjZfZHJwY19pbmZv
KG0pOwotCQllbHNlCi0JCQllcnIgPSBpcm9ubGFrZV9kcnBjX2luZm8obSk7Ci0JfQotCi0JcmV0
dXJuIGVycjsKLX0KLQogc3RhdGljIGludCBpOTE1X2Zyb250YnVmZmVyX3RyYWNraW5nKHN0cnVj
dCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKQEAgLTEzNjIsNDcgKzkxOCw2
IEBAIHN0YXRpYyBpbnQgaTkxNV9zcl9zdGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1
bnVzZWQpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaTkxNV9yaW5nX2ZyZXFfdGFibGUo
c3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCXN0cnVjdCBpbnRl
bF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3QucnBzOwotCXVuc2lnbmVkIGludCBtYXhfZ3B1X2Zy
ZXEsIG1pbl9ncHVfZnJlcTsKLQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKLQlpbnQgZ3B1X2Zy
ZXEsIGlhX2ZyZXE7Ci0KLQlpZiAoIUhBU19MTEMoZGV2X3ByaXYpKQotCQlyZXR1cm4gLUVOT0RF
VjsKLQotCW1pbl9ncHVfZnJlcSA9IHJwcy0+bWluX2ZyZXE7Ci0JbWF4X2dwdV9mcmVxID0gcnBz
LT5tYXhfZnJlcTsKLQlpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwgSU5URUxfR0VOKGRldl9w
cml2KSA+PSAxMCkgewotCQkvKiBDb252ZXJ0IEdUIGZyZXF1ZW5jeSB0byA1MCBIWiB1bml0cyAq
LwotCQltaW5fZ3B1X2ZyZXEgLz0gR0VOOV9GUkVRX1NDQUxFUjsKLQkJbWF4X2dwdV9mcmVxIC89
IEdFTjlfRlJFUV9TQ0FMRVI7Ci0JfQotCi0Jc2VxX3B1dHMobSwgIkdQVSBmcmVxIChNSHopXHRF
ZmZlY3RpdmUgQ1BVIGZyZXEgKE1IeilcdEVmZmVjdGl2ZSBSaW5nIGZyZXEgKE1IeilcbiIpOwot
Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7
Ci0JZm9yIChncHVfZnJlcSA9IG1pbl9ncHVfZnJlcTsgZ3B1X2ZyZXEgPD0gbWF4X2dwdV9mcmVx
OyBncHVfZnJlcSsrKSB7Ci0JCWlhX2ZyZXEgPSBncHVfZnJlcTsKLQkJc2FuZHlicmlkZ2VfcGNv
ZGVfcmVhZChkZXZfcHJpdiwKLQkJCQkgICAgICAgR0VONl9QQ09ERV9SRUFEX01JTl9GUkVRX1RB
QkxFLAotCQkJCSAgICAgICAmaWFfZnJlcSwgTlVMTCk7Ci0JCXNlcV9wcmludGYobSwgIiVkXHRc
dCVkXHRcdFx0XHQlZFxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywKLQkJCQkJICAoZ3B1
X2ZyZXEgKgotCQkJCQkgICAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwKLQkJCQkJICAgIElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTAgPwotCQkJCQkgICAgR0VOOV9GUkVRX1NDQUxFUiA6IDEpKSks
Ci0JCQkgICAoKGlhX2ZyZXEgPj4gMCkgJiAweGZmKSAqIDEwMCwKLQkJCSAgICgoaWFfZnJlcSA+
PiA4KSAmIDB4ZmYpICogMTAwKTsKLQl9Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2
LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKLQotCXJldHVybiAwOwotfQotCiBzdGF0aWMgaW50IGk5
MTVfb3ByZWdpb24oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiB7CiAJc3RydWN0
IGludGVsX29wcmVnaW9uICpvcHJlZ2lvbiA9ICZub2RlX3RvX2k5MTUobS0+cHJpdmF0ZSktPm9w
cmVnaW9uOwpAQCAtMTYwNSw4NyArMTEyMCw2IEBAIHN0YXRpYyBpbnQgaTkxNV9zd2l6emxlX2lu
Zm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgY29uc3QgY2hhciAqcnBzX3Bvd2VyX3RvX3N0cih1bnNpZ25lZCBpbnQgcG93ZXIpCi17Ci0J
c3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBzdHJpbmdzW10gPSB7Ci0JCVtMT1dfUE9XRVJdID0g
ImxvdyBwb3dlciIsCi0JCVtCRVRXRUVOXSA9ICJtaXhlZCIsCi0JCVtISUdIX1BPV0VSXSA9ICJo
aWdoIHBvd2VyIiwKLQl9OwotCi0JaWYgKHBvd2VyID49IEFSUkFZX1NJWkUoc3RyaW5ncykgfHwg
IXN0cmluZ3NbcG93ZXJdKQotCQlyZXR1cm4gInVua25vd24iOwotCi0JcmV0dXJuIHN0cmluZ3Nb
cG93ZXJdOwotfQotCi1zdGF0aWMgaW50IGk5MTVfcnBzX2Jvb3N0X2luZm8oc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICpkYXRhKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAm
ZGV2X3ByaXYtPmd0LnJwczsKLQl1MzIgYWN0X2ZyZXE7Ci0JaW50ZWxfd2FrZXJlZl90IHdha2Vy
ZWY7Ci0KLQl3aXRoX2ludGVsX3J1bnRpbWVfcG1faWZfaW5fdXNlKCZkZXZfcHJpdi0+cnVudGlt
ZV9wbSwgd2FrZXJlZikKLQkJYWN0X2ZyZXEgPSBpbnRlbF9ycHNfcmVhZF9hY3R1YWxfZnJlcXVl
bmN5KHJwcyk7Ci0KLQlzZXFfcHJpbnRmKG0sICJSUFMgZW5hYmxlZD8gJWRcbiIsIHJwcy0+ZW5h
YmxlZCk7Ci0Jc2VxX3ByaW50ZihtLCAiR1BVIGJ1c3k/ICVzXG4iLCB5ZXNubyhkZXZfcHJpdi0+
Z3QuYXdha2UpKTsKLQlzZXFfcHJpbnRmKG0sICJCb29zdHMgb3V0c3RhbmRpbmc/ICVkXG4iLAot
CQkgICBhdG9taWNfcmVhZCgmcnBzLT5udW1fd2FpdGVycykpOwotCXNlcV9wcmludGYobSwgIklu
dGVyYWN0aXZlPyAlZFxuIiwgUkVBRF9PTkNFKHJwcy0+cG93ZXIuaW50ZXJhY3RpdmUpKTsKLQlz
ZXFfcHJpbnRmKG0sICJGcmVxdWVuY3kgcmVxdWVzdGVkICVkLCBhY3R1YWwgJWRcbiIsCi0JCSAg
IGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5jdXJfZnJlcSksIGFjdF9mcmVxKTsKLQlzZXFfcHJp
bnRmKG0sICIgIG1pbiBoYXJkOiVkLCBzb2Z0OiVkOyBtYXggc29mdDolZCwgaGFyZDolZFxuIiwK
LQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1pbl9mcmVxKSwKLQkJICAgaW50ZWxfZ3B1
X2ZyZXEocnBzLCBycHMtPm1pbl9mcmVxX3NvZnRsaW1pdCksCi0JCSAgIGludGVsX2dwdV9mcmVx
KHJwcywgcnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQpLAotCQkgICBpbnRlbF9ncHVfZnJlcShycHMs
IHJwcy0+bWF4X2ZyZXEpKTsKLQlzZXFfcHJpbnRmKG0sICIgIGlkbGU6JWQsIGVmZmljaWVudDol
ZCwgYm9vc3Q6JWRcbiIsCi0JCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5pZGxlX2ZyZXEp
LAotCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpLAotCQkgICBp
bnRlbF9ncHVfZnJlcShycHMsIHJwcy0+Ym9vc3RfZnJlcSkpOwotCi0Jc2VxX3ByaW50ZihtLCAi
V2FpdCBib29zdHM6ICVkXG4iLCBhdG9taWNfcmVhZCgmcnBzLT5ib29zdHMpKTsKLQotCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDYgJiYgcnBzLT5lbmFibGVkICYmIGRldl9wcml2LT5ndC5h
d2FrZSkgewotCQl1MzIgcnB1cCwgcnB1cGVpOwotCQl1MzIgcnBkb3duLCBycGRvd25laTsKLQot
CQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtF
X0FMTCk7Ci0JCXJwdXAgPSBJOTE1X1JFQURfRlcoR0VONl9SUF9DVVJfVVApICYgR0VONl9SUF9F
SV9NQVNLOwotCQlycHVwZWkgPSBJOTE1X1JFQURfRlcoR0VONl9SUF9DVVJfVVBfRUkpICYgR0VO
Nl9SUF9FSV9NQVNLOwotCQlycGRvd24gPSBJOTE1X1JFQURfRlcoR0VONl9SUF9DVVJfRE9XTikg
JiBHRU42X1JQX0VJX01BU0s7Ci0JCXJwZG93bmVpID0gSTkxNV9SRUFEX0ZXKEdFTjZfUlBfQ1VS
X0RPV05fRUkpICYgR0VONl9SUF9FSV9NQVNLOwotCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1
dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci0KLQkJc2VxX3ByaW50ZihtLCAi
XG5SUFMgQXV0b3R1bmluZyAoY3VycmVudCBcIiVzXCIgd2luZG93KTpcbiIsCi0JCQkgICBycHNf
cG93ZXJfdG9fc3RyKHJwcy0+cG93ZXIubW9kZSkpOwotCQlzZXFfcHJpbnRmKG0sICIgIEF2Zy4g
dXA6ICVkJSUgW2Fib3ZlIHRocmVzaG9sZD8gJWQlJV1cbiIsCi0JCQkgICBycHVwICYmIHJwdXBl
aSA/IDEwMCAqIHJwdXAgLyBycHVwZWkgOiAwLAotCQkJICAgcnBzLT5wb3dlci51cF90aHJlc2hv
bGQpOwotCQlzZXFfcHJpbnRmKG0sICIgIEF2Zy4gZG93bjogJWQlJSBbYmVsb3cgdGhyZXNob2xk
PyAlZCUlXVxuIiwKLQkJCSAgIHJwZG93biAmJiBycGRvd25laSA/IDEwMCAqIHJwZG93biAvIHJw
ZG93bmVpIDogMCwKLQkJCSAgIHJwcy0+cG93ZXIuZG93bl90aHJlc2hvbGQpOwotCX0gZWxzZSB7
Ci0JCXNlcV9wdXRzKG0sICJcblJQUyBBdXRvdHVuaW5nIGluYWN0aXZlXG4iKTsKLQl9Ci0KLQly
ZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCBpOTE1X2xsYyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKmRhdGEpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90
b19pOTE1KG0tPnByaXZhdGUpOwotCWNvbnN0IGJvb2wgZWRyYW0gPSBJTlRFTF9HRU4oZGV2X3By
aXYpID4gODsKLQotCXNlcV9wcmludGYobSwgIkxMQzogJXNcbiIsIHllc25vKEhBU19MTEMoZGV2
X3ByaXYpKSk7Ci0Jc2VxX3ByaW50ZihtLCAiJXM6ICV1TUJcbiIsIGVkcmFtID8gImVEUkFNIiA6
ICJlTExDIiwKLQkJICAgZGV2X3ByaXYtPmVkcmFtX3NpemVfbWIpOwotCi0JcmV0dXJuIDA7Ci19
Ci0KIHN0YXRpYyBpbnQgaTkxNV9odWNfbG9hZF9zdGF0dXNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0sIHZvaWQgKmRhdGEpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
bm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwpAQCAtNDI0Niw5ICszNjgwLDYgQEAgc3RhdGljIGNv
bnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGk5MTVfZGVidWdmc19saXN0W10gPSB7CiAJeyJpOTE1
X2d1Y19sb2FkX2Vycl9sb2dfZHVtcCIsIGk5MTVfZ3VjX2xvZ19kdW1wLCAwLCAodm9pZCAqKTF9
LAogCXsiaTkxNV9ndWNfc3RhZ2VfcG9vbCIsIGk5MTVfZ3VjX3N0YWdlX3Bvb2wsIDB9LAogCXsi
aTkxNV9odWNfbG9hZF9zdGF0dXMiLCBpOTE1X2h1Y19sb2FkX3N0YXR1c19pbmZvLCAwfSwKLQl7
Imk5MTVfZnJlcXVlbmN5X2luZm8iLCBpOTE1X2ZyZXF1ZW5jeV9pbmZvLCAwfSwKLQl7Imk5MTVf
ZHJwY19pbmZvIiwgaTkxNV9kcnBjX2luZm8sIDB9LAotCXsiaTkxNV9yaW5nX2ZyZXFfdGFibGUi
LCBpOTE1X3JpbmdfZnJlcV90YWJsZSwgMH0sCiAJeyJpOTE1X2Zyb250YnVmZmVyX3RyYWNraW5n
IiwgaTkxNV9mcm9udGJ1ZmZlcl90cmFja2luZywgMH0sCiAJeyJpOTE1X2ZiY19zdGF0dXMiLCBp
OTE1X2ZiY19zdGF0dXMsIDB9LAogCXsiaTkxNV9pcHNfc3RhdHVzIiwgaTkxNV9pcHNfc3RhdHVz
LCAwfSwKQEAgLTQyNTcsOSArMzY4OCw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2luZm9f
bGlzdCBpOTE1X2RlYnVnZnNfbGlzdFtdID0gewogCXsiaTkxNV92YnQiLCBpOTE1X3ZidCwgMH0s
CiAJeyJpOTE1X2dlbV9mcmFtZWJ1ZmZlciIsIGk5MTVfZ2VtX2ZyYW1lYnVmZmVyX2luZm8sIDB9
LAogCXsiaTkxNV9jb250ZXh0X3N0YXR1cyIsIGk5MTVfY29udGV4dF9zdGF0dXMsIDB9LAotCXsi
aTkxNV9mb3JjZXdha2VfZG9tYWlucyIsIGk5MTVfZm9yY2V3YWtlX2RvbWFpbnMsIDB9LAogCXsi
aTkxNV9zd2l6emxlX2luZm8iLCBpOTE1X3N3aXp6bGVfaW5mbywgMH0sCi0JeyJpOTE1X2xsYyIs
IGk5MTVfbGxjLCAwfSwKIAl7Imk5MTVfZWRwX3Bzcl9zdGF0dXMiLCBpOTE1X2VkcF9wc3Jfc3Rh
dHVzLCAwfSwKIAl7Imk5MTVfZW5lcmd5X3VKIiwgaTkxNV9lbmVyZ3lfdUosIDB9LAogCXsiaTkx
NV9ydW50aW1lX3BtX3N0YXR1cyIsIGk5MTVfcnVudGltZV9wbV9zdGF0dXMsIDB9LApAQCAtNDI3
NSw3ICszNzA0LDYgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGk5MTVfZGVi
dWdmc19saXN0W10gPSB7CiAJeyJpOTE1X2RkYl9pbmZvIiwgaTkxNV9kZGJfaW5mbywgMH0sCiAJ
eyJpOTE1X3NzZXVfc3RhdHVzIiwgaTkxNV9zc2V1X3N0YXR1cywgMH0sCiAJeyJpOTE1X2RycnNf
c3RhdHVzIiwgaTkxNV9kcnJzX3N0YXR1cywgMH0sCi0JeyJpOTE1X3Jwc19ib29zdF9pbmZvIiwg
aTkxNV9ycHNfYm9vc3RfaW5mbywgMH0sCiB9OwogI2RlZmluZSBJOTE1X0RFQlVHRlNfRU5UUklF
UyBBUlJBWV9TSVpFKGk5MTVfZGVidWdmc19saXN0KQogCkBAIC00MzExLDYgKzM3MzksNyBAQCBz
dGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfZGVidWdmc19maWxlcyB7CiBpbnQgaTkxNV9kZWJ1Z2Zz
X3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAlzdHJ1Y3Qg
ZHJtX21pbm9yICptaW5vciA9IGRldl9wcml2LT5kcm0ucHJpbWFyeTsKKwlpbnQgZXJyOwogCWlu
dCBpOwogCiAJZGVidWdmc19jcmVhdGVfZmlsZSgiaTkxNV9mb3JjZXdha2VfdXNlciIsIFNfSVJV
U1IsIG1pbm9yLT5kZWJ1Z2ZzX3Jvb3QsCkBAIC00MzI0LDkgKzM3NTMsMTMgQEAgaW50IGk5MTVf
ZGVidWdmc19yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCQkJ
ICAgIGk5MTVfZGVidWdmc19maWxlc1tpXS5mb3BzKTsKIAl9CiAKLQlyZXR1cm4gZHJtX2RlYnVn
ZnNfY3JlYXRlX2ZpbGVzKGk5MTVfZGVidWdmc19saXN0LAotCQkJCQlJOTE1X0RFQlVHRlNfRU5U
UklFUywKLQkJCQkJbWlub3ItPmRlYnVnZnNfcm9vdCwgbWlub3IpOworCWVyciA9IGRybV9kZWJ1
Z2ZzX2NyZWF0ZV9maWxlcyhpOTE1X2RlYnVnZnNfbGlzdCwKKwkJCQkgICAgICAgSTkxNV9ERUJV
R0ZTX0VOVFJJRVMsCisJCQkJICAgICAgIG1pbm9yLT5kZWJ1Z2ZzX3Jvb3QsIG1pbm9yKTsKKwlp
ZiAoZXJyKQorCQlyZXR1cm4gZXJyOworCisJcmV0dXJuIGRlYnVnZnNfZ3RfaW5pdCgmZGV2X3By
aXYtPmd0KTsKIH0KIAogc3RydWN0IGRwY2RfYmxvY2sgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rl
YnVnZnMuaAppbmRleCBjMGNkMjJlYjkxNmQuLjU2YmQ3ZDE0YmIyMiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kZWJ1Z2ZzLmgKQEAgLTYsNiArNiwxMCBAQAogI2lmbmRlZiBfX0k5MTVfREVCVUdG
U19IX18KICNkZWZpbmUgX19JOTE1X0RFQlVHRlNfSF9fCiAKKyNpbmNsdWRlIDxkcm0vZHJtX2Rl
YnVnZnMuaD4KKworI2luY2x1ZGUgImk5MTVfZHJ2LmgiCisKIHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlOwogc3RydWN0IGRybV9jb25uZWN0b3I7CiAKQEAgLTE3LDQgKzIxLDkgQEAgc3RhdGljIGlu
bGluZSBpbnQgaTkxNV9kZWJ1Z2ZzX3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikgeyByZXQKIHN0YXRpYyBpbmxpbmUgaW50IGk5MTVfZGVidWdmc19jb25uZWN0b3Jf
YWRkKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpIHsgcmV0dXJuIDA7IH0KICNlbmRp
ZgogCitzdGF0aWMgaW5saW5lIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpub2RlX3RvX2k5MTUo
c3RydWN0IGRybV9pbmZvX25vZGUgKm5vZGUpCit7CisJcmV0dXJuIHRvX2k5MTUobm9kZS0+bWlu
b3ItPmRldik7Cit9CisKICNlbmRpZiAvKiBfX0k5MTVfREVCVUdGU19IX18gKi8KLS0gCjIuMjQu
MAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwt
Z2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8v
bGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

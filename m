Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 299DBE9C10
	for <lists+intel-gfx@lfdr.de>; Wed, 30 Oct 2019 14:10:08 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 06A236E9EF;
	Wed, 30 Oct 2019 13:10:06 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2F10D6E9DC
 for <intel-gfx@lists.freedesktop.org>; Wed, 30 Oct 2019 13:10:04 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 30 Oct 2019 06:10:03 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.68,247,1569308400"; d="scan'208";a="230438790"
Received: from cepartan-mobl3.ger.corp.intel.com (HELO [10.249.40.248])
 ([10.249.40.248])
 by fmsmga002.fm.intel.com with ESMTP; 30 Oct 2019 06:10:01 -0700
To: =?UTF-8?B?VmlsbGUgU3lyasOkbMOk?= <ville.syrjala@linux.intel.com>
References: <20191029072229.27092-1-maarten.lankhorst@linux.intel.com>
 <20191029072229.27092-11-maarten.lankhorst@linux.intel.com>
 <20191029154323.GB1208@intel.com>
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Message-ID: <4abf7a31-cd1a-8b16-e24f-74479e65ac96@linux.intel.com>
Date: Wed, 30 Oct 2019 14:10:00 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <20191029154323.GB1208@intel.com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [CI 11/12] drm/i915: Perform automated conversions
 for plane uapi/hw split, base -> uapi.
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T3AgMjktMTAtMjAxOSBvbSAxNjo0MyBzY2hyZWVmIFZpbGxlIFN5cmrDpGzDpDoKPiBPbiBUdWUs
IE9jdCAyOSwgMjAxOSBhdCAwODoyMjoyOEFNICswMTAwLCBNYWFydGVuIExhbmtob3JzdCB3cm90
ZToKPj4gU3BsaXQgdXAgcGxhbmVfc3RhdGUtPmJhc2UgdG8gdWFwaS4gVGhpcyBpcyBkb25lIHVz
aW5nIHRoZSBmb2xsb3dpbmcgcGF0Y2gsCj4+IHJhbiBhZnRlciB0aGUgcHJldmlvdXMgY29tbWl0
IHRoYXQgc3BsaXRzIG91dCBhbnkgaHcgcmVmZXJlbmNlczoKPj4KPj4gQEAKPj4gc3RydWN0IGlu
dGVsX3BsYW5lX3N0YXRlICpUOwo+PiBpZGVudGlmaWVyIHg7Cj4+IEBACj4+IC1ULT5iYXNlLngK
Pj4gK1QtPnVhcGkueAo+Pgo+PiBAQAo+PiBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKlQ7Cj4+
IEBACj4+IC1ULT5iYXNlCj4+ICtULT51YXBpCj4+Cj4+IFNpZ25lZC1vZmYtYnk6IE1hYXJ0ZW4g
TGFua2hvcnN0IDxtYWFydGVuLmxhbmtob3JzdEBsaW51eC5pbnRlbC5jb20+Cj4+IC0tLQo+PiAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuYyAgIHwgICAyICstCj4+
ICAuLi4vZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljX3BsYW5lLmMgfCAgMzIgKy0K
Pj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jICB8IDI5OCAr
KysrKysrKystLS0tLS0tLS0KPj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZmJjLmMgICAgICB8ICAxMiArLQo+PiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9vdmVybGF5LmMgIHwgICAyICstCj4+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX3Nwcml0ZS5jICAgfCAxMzYgKysrKy0tLS0KPj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX3BtLmMgICAgICAgICAgICAgICB8ICA1NyArKy0tCj4+ICA3IGZpbGVzIGNoYW5nZWQsIDI3
MSBpbnNlcnRpb25zKCspLCAyNjggZGVsZXRpb25zKC0pCj4+Cj4+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuYwo+PiBpbmRleCBmYjQxMjZkZTk5NGQuLmNiNWM5
MTRmNjI3ZiAxMDA2NDQKPj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9hdG9taWMuYwo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0
b21pYy5jCj4+IEBAIC0yOTksNyArMjk5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX3Nl
dHVwX3NjYWxlcihzdHJ1Y3QgaW50ZWxfY3J0Y19zY2FsZXJfc3RhdGUgKnNjYWxlcl9zdGEKPj4g
IAlpZiAocGxhbmVfc3RhdGUgJiYgcGxhbmVfc3RhdGUtPmh3LmZiICYmCj4+ICAJICAgIHBsYW5l
X3N0YXRlLT5ody5mYi0+Zm9ybWF0LT5pc195dXYgJiYKPj4gIAkgICAgcGxhbmVfc3RhdGUtPmh3
LmZiLT5mb3JtYXQtPm51bV9wbGFuZXMgPiAxKSB7Cj4+IC0JCXN0cnVjdCBpbnRlbF9wbGFuZSAq
cGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4+ICsJCXN0
cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+dWFw
aS5wbGFuZSk7Cj4+ICAJCWlmIChJU19HRU4oZGV2X3ByaXYsIDkpICYmCj4+ICAJCSAgICAhSVNf
R0VNSU5JTEFLRShkZXZfcHJpdikpIHsKPj4gIAkJCW1vZGUgPSBTS0xfUFNfU0NBTEVSX01PREVf
TlYxMjsKPj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
YXRvbWljX3BsYW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21p
Y19wbGFuZS5jCj4+IGluZGV4IGNhYzFkNmFlNjdmNi4uYmE3ZDU0MjFmNzkxIDEwMDY0NAo+PiAt
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pY19wbGFuZS5jCj4+
ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljX3BsYW5lLmMK
Pj4gQEAgLTU2LDcgKzU2LDcgQEAgc3RydWN0IGludGVsX3BsYW5lICppbnRlbF9wbGFuZV9hbGxv
Yyh2b2lkKQo+PiAgCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKPj4gIAl9Cj4+ICAKPj4gLQlf
X2RybV9hdG9taWNfaGVscGVyX3BsYW5lX3Jlc2V0KCZwbGFuZS0+YmFzZSwgJnBsYW5lX3N0YXRl
LT5iYXNlKTsKPj4gKwlfX2RybV9hdG9taWNfaGVscGVyX3BsYW5lX3Jlc2V0KCZwbGFuZS0+YmFz
ZSwgJnBsYW5lX3N0YXRlLT51YXBpKTsKPj4gIAlwbGFuZV9zdGF0ZS0+c2NhbGVyX2lkID0gLTE7
Cj4+ICAKPj4gIAlyZXR1cm4gcGxhbmU7Cj4+IEBAIC04OCwxMiArODgsMTIgQEAgaW50ZWxfcGxh
bmVfZHVwbGljYXRlX3N0YXRlKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lKQo+PiAgCWlmICghaW50
ZWxfc3RhdGUpCj4+ICAJCXJldHVybiBOVUxMOwo+PiAgCj4+IC0JX19kcm1fYXRvbWljX2hlbHBl
cl9wbGFuZV9kdXBsaWNhdGVfc3RhdGUocGxhbmUsICZpbnRlbF9zdGF0ZS0+YmFzZSk7Cj4+ICsJ
X19kcm1fYXRvbWljX2hlbHBlcl9wbGFuZV9kdXBsaWNhdGVfc3RhdGUocGxhbmUsICZpbnRlbF9z
dGF0ZS0+dWFwaSk7Cj4+ICAKPj4gIAlpbnRlbF9zdGF0ZS0+dm1hID0gTlVMTDsKPj4gIAlpbnRl
bF9zdGF0ZS0+ZmxhZ3MgPSAwOwo+PiAgCj4+IC0JcmV0dXJuICZpbnRlbF9zdGF0ZS0+YmFzZTsK
Pj4gKwlyZXR1cm4gJmludGVsX3N0YXRlLT51YXBpOwo+PiAgfQo+PiAgCj4+ICAvKioKPj4gQEAg
LTExMSw3ICsxMTEsNyBAQCBpbnRlbF9wbGFuZV9kZXN0cm95X3N0YXRlKHN0cnVjdCBkcm1fcGxh
bmUgKnBsYW5lLAo+PiAgCXN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUgPSB0
b19pbnRlbF9wbGFuZV9zdGF0ZShzdGF0ZSk7Cj4+ICAJV0FSTl9PTihwbGFuZV9zdGF0ZS0+dm1h
KTsKPj4gIAo+PiAtCV9fZHJtX2F0b21pY19oZWxwZXJfcGxhbmVfZGVzdHJveV9zdGF0ZSgmcGxh
bmVfc3RhdGUtPmJhc2UpOwo+PiArCV9fZHJtX2F0b21pY19oZWxwZXJfcGxhbmVfZGVzdHJveV9z
dGF0ZSgmcGxhbmVfc3RhdGUtPnVhcGkpOwo+PiAgCWtmcmVlKHBsYW5lX3N0YXRlKTsKPj4gIH0K
Pj4gIAo+PiBAQCAtMTIxLDcgKzEyMSw3IEBAIHVuc2lnbmVkIGludCBpbnRlbF9wbGFuZV9kYXRh
X3JhdGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJY29u
c3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+aHcuZmI7Cj4+ICAJ
dW5zaWduZWQgaW50IGNwcDsKPj4gIAo+PiAtCWlmICghcGxhbmVfc3RhdGUtPmJhc2UudmlzaWJs
ZSkKPj4gKwlpZiAoIXBsYW5lX3N0YXRlLT51YXBpLnZpc2libGUpCj4+ICAJCXJldHVybiAwOwo+
PiAgCj4+ICAJY3BwID0gZmItPmZvcm1hdC0+Y3BwWzBdOwo+PiBAQCAtMTQ0LDEwICsxNDQsMTAg
QEAgYm9vbCBpbnRlbF9wbGFuZV9jYWxjX21pbl9jZGNsayhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSwKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KHBsYW5lLT5iYXNlLmRldik7Cj4+ICAJY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRl
ICpwbGFuZV9zdGF0ZSA9Cj4+ICAJCWludGVsX2F0b21pY19nZXRfbmV3X3BsYW5lX3N0YXRlKHN0
YXRlLCBwbGFuZSk7Cj4+IC0Jc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRj
KHBsYW5lX3N0YXRlLT5iYXNlLmNydGMpOwo+PiArCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0g
dG9faW50ZWxfY3J0YyhwbGFuZV9zdGF0ZS0+dWFwaS5jcnRjKTsKPiBUaGlzIGxvb2tzIHdyb25n
LiBTaG91bGQgYmUgaHcuY3J0YyBJIGJlbGlldmUuCgpDb3JyZWN0LCBJIGFjY2lkZW50YWxseSBt
ZXNzZWQgdXAgbGFzdCB0aW1lIEkgcmFuIHRoaXMsIGFuZCBmb3Jnb3QgdG8gcnVuIHRoZSBiYXNl
LT5odyBwYXRjaCBmaXJzdC4KClNvIHNvbWUgcmVmZXJlbmNlcyB3ZXJlIGNoYW5nZWQgdG8gdWFw
aSwgdGhhdCBzaG91bGQgYmUgaHcuIEkgZml4ZWQgaXQgaW4gYSByZXJ1biwgYnV0IG5vdGljZWQg
aXQgdG9vIGxhdGUgaGVyZS4gOikKCldpbGwgcmVzcGluIQoKPgo+PiAgCXN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpjcnRjX3N0YXRlOwo+PiAgCj4+IC0JaWYgKCFwbGFuZV9zdGF0ZS0+YmFzZS52
aXNpYmxlIHx8ICFwbGFuZS0+bWluX2NkY2xrKQo+PiArCWlmICghcGxhbmVfc3RhdGUtPnVhcGku
dmlzaWJsZSB8fCAhcGxhbmUtPm1pbl9jZGNsaykKPiBOb3QgZHVwbGljYXRpbmcgdmlzaWJsZSxz
cmMsZHN0IGxlYWRzIHRvIHNsaWdodGx5IGNvbmZ1c2luZyBsb29raW5nCj4gY29kZS4gSSB3b25k
ZXIgaWYgaXQgd291bGRuJ3QgYmUgYmV0dGVyIHRvIGp1c3QgZHVwbGljYXRlIHRob3NlIGFzCj4g
d2VsbC4uLgo+Cj4+ICAJCXJldHVybiBmYWxzZTsKPj4gIAo+PiAgCWNydGNfc3RhdGUgPSBpbnRl
bF9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRlKHN0YXRlLCBjcnRjKTsKPj4gQEAgLTE4MSw3ICsx
ODEsNyBAQCBpbnQgaW50ZWxfcGxhbmVfYXRvbWljX2NoZWNrX3dpdGhfc3RhdGUoY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjXwo+PiAgCQkJCQljb25zdCBzdHJ1Y3QgaW50
ZWxfcGxhbmVfc3RhdGUgKm9sZF9wbGFuZV9zdGF0ZSwKPj4gIAkJCQkJc3RydWN0IGludGVsX3Bs
YW5lX3N0YXRlICpuZXdfcGxhbmVfc3RhdGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX3BsYW5l
ICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKG5ld19wbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4+
ICsJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKG5ld19wbGFuZV9z
dGF0ZS0+dWFwaS5wbGFuZSk7Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIg
PSBuZXdfcGxhbmVfc3RhdGUtPmh3LmZiOwo+PiAgCWludCByZXQ7Cj4+ICAKPj4gQEAgLTE5MCw3
ICsxOTAsNyBAQCBpbnQgaW50ZWxfcGxhbmVfYXRvbWljX2NoZWNrX3dpdGhfc3RhdGUoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjXwo+PiAgCW5ld19jcnRjX3N0YXRlLT5j
OF9wbGFuZXMgJj0gfkJJVChwbGFuZS0+aWQpOwo+PiAgCW5ld19jcnRjX3N0YXRlLT5kYXRhX3Jh
dGVbcGxhbmUtPmlkXSA9IDA7Cj4+ICAJbmV3X2NydGNfc3RhdGUtPm1pbl9jZGNsa1twbGFuZS0+
aWRdID0gMDsKPj4gLQluZXdfcGxhbmVfc3RhdGUtPmJhc2UudmlzaWJsZSA9IGZhbHNlOwo+PiAr
CW5ld19wbGFuZV9zdGF0ZS0+dWFwaS52aXNpYmxlID0gZmFsc2U7Cj4+ICAKPj4gIAlpZiAoIW5l
d19wbGFuZV9zdGF0ZS0+aHcuY3J0YyAmJiAhb2xkX3BsYW5lX3N0YXRlLT5ody5jcnRjKQo+PiAg
CQlyZXR1cm4gMDsKPj4gQEAgLTIwMCwxOCArMjAwLDE4IEBAIGludCBpbnRlbF9wbGFuZV9hdG9t
aWNfY2hlY2tfd2l0aF9zdGF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2Ny
dGNfCj4+ICAJCXJldHVybiByZXQ7Cj4+ICAKPj4gIAkvKiBGSVhNRSBwcmUtZzR4IGRvbid0IHdv
cmsgbGlrZSB0aGlzICovCj4+IC0JaWYgKG5ld19wbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlKQo+
PiArCWlmIChuZXdfcGxhbmVfc3RhdGUtPnVhcGkudmlzaWJsZSkKPj4gIAkJbmV3X2NydGNfc3Rh
dGUtPmFjdGl2ZV9wbGFuZXMgfD0gQklUKHBsYW5lLT5pZCk7Cj4+ICAKPj4gLQlpZiAobmV3X3Bs
YW5lX3N0YXRlLT5iYXNlLnZpc2libGUgJiYKPj4gKwlpZiAobmV3X3BsYW5lX3N0YXRlLT51YXBp
LnZpc2libGUgJiYKPj4gIAkgICAgZHJtX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFyKGZi
LT5mb3JtYXQpKQo+PiAgCQluZXdfY3J0Y19zdGF0ZS0+bnYxMl9wbGFuZXMgfD0gQklUKHBsYW5l
LT5pZCk7Cj4+ICAKPj4gLQlpZiAobmV3X3BsYW5lX3N0YXRlLT5iYXNlLnZpc2libGUgJiYKPj4g
KwlpZiAobmV3X3BsYW5lX3N0YXRlLT51YXBpLnZpc2libGUgJiYKPj4gIAkgICAgZmItPmZvcm1h
dC0+Zm9ybWF0ID09IERSTV9GT1JNQVRfQzgpCj4+ICAJCW5ld19jcnRjX3N0YXRlLT5jOF9wbGFu
ZXMgfD0gQklUKHBsYW5lLT5pZCk7Cj4+ICAKPj4gLQlpZiAobmV3X3BsYW5lX3N0YXRlLT5iYXNl
LnZpc2libGUgfHwgb2xkX3BsYW5lX3N0YXRlLT5iYXNlLnZpc2libGUpCj4+ICsJaWYgKG5ld19w
bGFuZV9zdGF0ZS0+dWFwaS52aXNpYmxlIHx8IG9sZF9wbGFuZV9zdGF0ZS0+dWFwaS52aXNpYmxl
KQo+PiAgCQluZXdfY3J0Y19zdGF0ZS0+dXBkYXRlX3BsYW5lcyB8PSBCSVQocGxhbmUtPmlkKTsK
Pj4gIAo+PiAgCW5ld19jcnRjX3N0YXRlLT5kYXRhX3JhdGVbcGxhbmUtPmlkXSA9Cj4+IEBAIC0y
NDYsNyArMjQ2LDcgQEAgaW50IGludGVsX3BsYW5lX2F0b21pY19jaGVjayhzdHJ1Y3QgaW50ZWxf
YXRvbWljX3N0YXRlICpzdGF0ZSwKPj4gIAljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
b2xkX2NydGNfc3RhdGU7Cj4+ICAJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0
YXRlOwo+PiAgCj4+IC0JbmV3X3BsYW5lX3N0YXRlLT5iYXNlLnZpc2libGUgPSBmYWxzZTsKPj4g
KwluZXdfcGxhbmVfc3RhdGUtPnVhcGkudmlzaWJsZSA9IGZhbHNlOwo+PiAgCWlmICghY3J0YykK
Pj4gIAkJcmV0dXJuIDA7Cj4+ICAKPj4gQEAgLTM1NSw3ICszNTUsNyBAQCB2b2lkIHNrbF91cGRh
dGVfcGxhbmVzX29uX2NydGMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4+ICAJ
CXN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqbmV3X3BsYW5lX3N0YXRlID0KPj4gIAkJCWludGVs
X2F0b21pY19nZXRfbmV3X3BsYW5lX3N0YXRlKHN0YXRlLCBwbGFuZSk7Cj4+ICAKPj4gLQkJaWYg
KG5ld19wbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlKSB7Cj4+ICsJCWlmIChuZXdfcGxhbmVfc3Rh
dGUtPnVhcGkudmlzaWJsZSkgewo+PiAgCQkJaW50ZWxfdXBkYXRlX3BsYW5lKHBsYW5lLCBuZXdf
Y3J0Y19zdGF0ZSwgbmV3X3BsYW5lX3N0YXRlKTsKPj4gIAkJfSBlbHNlIGlmIChuZXdfcGxhbmVf
c3RhdGUtPnBsYW5hcl9zbGF2ZSkgewo+PiAgCQkJc3RydWN0IGludGVsX3BsYW5lICptYXN0ZXIg
PQo+PiBAQCAtMzk1LDcgKzM5NSw3IEBAIHZvaWQgaTl4eF91cGRhdGVfcGxhbmVzX29uX2NydGMo
c3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4+ICAJCSAgICAhKHVwZGF0ZV9tYXNr
ICYgQklUKHBsYW5lLT5pZCkpKQo+PiAgCQkJY29udGludWU7Cj4+ICAKPj4gLQkJaWYgKG5ld19w
bGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlKQo+PiArCQlpZiAobmV3X3BsYW5lX3N0YXRlLT51YXBp
LnZpc2libGUpCj4+ICAJCQlpbnRlbF91cGRhdGVfcGxhbmUocGxhbmUsIG5ld19jcnRjX3N0YXRl
LCBuZXdfcGxhbmVfc3RhdGUpOwo+PiAgCQllbHNlCj4+ICAJCQlpbnRlbF9kaXNhYmxlX3BsYW5l
KHBsYW5lLCBuZXdfY3J0Y19zdGF0ZSk7Cj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGlzcGxheS5jCj4+IGluZGV4IGZiYmU2Zjc1MjcxNi4uOTFhMDU5ZTVmZGNiIDEw
MDY0NAo+PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXku
Ywo+PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwo+
PiBAQCAtMjA4Miw3ICsyMDgyLDcgQEAgc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9zdXJmX2Fs
aWdubWVudChjb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwKPj4gIAo+PiAgc3RhdGlj
IGJvb2wgaW50ZWxfcGxhbmVfdXNlc19mZW5jZShjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3Rh
dGUgKnBsYW5lX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0
b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4+ICsJc3RydWN0IGludGVs
X3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT51YXBpLnBsYW5lKTsK
Pj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5i
YXNlLmRldik7Cj4+ICAKPj4gIAlyZXR1cm4gSU5URUxfR0VOKGRldl9wcml2KSA8IDQgfHwKPj4g
QEAgLTIzOTEsNyArMjM5MSw3IEBAIHN0YXRpYyB1MzIgaW50ZWxfcGxhbmVfY29tcHV0ZV9hbGln
bmVkX29mZnNldChpbnQgKngsIGludCAqeSwKPj4gIAkJCQkJICAgICAgY29uc3Qgc3RydWN0IGlu
dGVsX3BsYW5lX3N0YXRlICpzdGF0ZSwKPj4gIAkJCQkJICAgICAgaW50IGNvbG9yX3BsYW5lKQo+
PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9wbGFuZSAqaW50ZWxfcGxhbmUgPSB0b19pbnRlbF9wbGFu
ZShzdGF0ZS0+YmFzZS5wbGFuZSk7Cj4+ICsJc3RydWN0IGludGVsX3BsYW5lICppbnRlbF9wbGFu
ZSA9IHRvX2ludGVsX3BsYW5lKHN0YXRlLT51YXBpLnBsYW5lKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX3BsYW5lLT5iYXNlLmRldik7Cj4+
ICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBzdGF0ZS0+aHcuZmI7Cj4+ICAJ
dW5zaWduZWQgaW50IHJvdGF0aW9uID0gc3RhdGUtPmh3LnJvdGF0aW9uOwo+PiBAQCAtMjU3OSw3
ICsyNTc5LDcgQEAgaW50ZWxfZmJfc3RyaWRlX2FsaWdubWVudChjb25zdCBzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICpmYiwgaW50IGNvbG9yX3BsYW5lKQo+PiAgCj4+ICBib29sIGludGVsX3BsYW5l
X2Nhbl9yZW1hcChjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+
PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFu
ZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4+ICsJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRv
X2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT51YXBpLnBsYW5lKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lLT5iYXNlLmRldik7Cj4+ICAJY29u
c3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+aHcuZmI7Cj4+ICAJ
aW50IGk7Cj4+IEBAIC0yNjE5LDcgKzI2MTksNyBAQCBib29sIGludGVsX3BsYW5lX2Nhbl9yZW1h
cChjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+PiAgCj4+ICBz
dGF0aWMgYm9vbCBpbnRlbF9wbGFuZV9uZWVkc19yZW1hcChjb25zdCBzdHJ1Y3QgaW50ZWxfcGxh
bmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxh
bmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4+ICsJc3RydWN0
IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT51YXBpLnBs
YW5lKTsKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRl
LT5ody5mYjsKPj4gIAl1bnNpZ25lZCBpbnQgcm90YXRpb24gPSBwbGFuZV9zdGF0ZS0+aHcucm90
YXRpb247Cj4+ICAJdTMyIHN0cmlkZSwgbWF4X3N0cmlkZTsKPj4gQEAgLTI2MjgsNyArMjYyOCw3
IEBAIHN0YXRpYyBib29sIGludGVsX3BsYW5lX25lZWRzX3JlbWFwKGNvbnN0IHN0cnVjdCBpbnRl
bF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4+ICAJICogTm8gcmVtYXBwaW5nIGZvciBpbnZp
c2libGUgcGxhbmVzIHNpbmNlIHdlIGRvbid0IGhhdmUKPj4gIAkgKiBhbiBhY3R1YWwgc291cmNl
IHZpZXdwb3J0IHRvIHJlbWFwLgo+PiAgCSAqLwo+PiAtCWlmICghcGxhbmVfc3RhdGUtPmJhc2Uu
dmlzaWJsZSkKPj4gKwlpZiAoIXBsYW5lX3N0YXRlLT51YXBpLnZpc2libGUpCj4+ICAJCXJldHVy
biBmYWxzZTsKPj4gIAo+PiAgCWlmICghaW50ZWxfcGxhbmVfY2FuX3JlbWFwKHBsYW5lX3N0YXRl
KSkKPj4gQEAgLTI4MTEsNyArMjgxMSw3IEBAIHN0YXRpYyB2b2lkCj4+ICBpbnRlbF9wbGFuZV9y
ZW1hcF9ndHQoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPj4gIHsKPj4g
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+PiAtCQl0b19pOTE1KHBsYW5l
X3N0YXRlLT5iYXNlLnBsYW5lLT5kZXYpOwo+PiArCQl0b19pOTE1KHBsYW5lX3N0YXRlLT51YXBp
LnBsYW5lLT5kZXYpOwo+PiAgCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3Rh
dGUtPmh3LmZiOwo+PiAgCXN0cnVjdCBpbnRlbF9mcmFtZWJ1ZmZlciAqaW50ZWxfZmIgPSB0b19p
bnRlbF9mcmFtZWJ1ZmZlcihmYik7Cj4+ICAJc3RydWN0IGludGVsX3JvdGF0aW9uX2luZm8gKmlu
Zm8gPSAmcGxhbmVfc3RhdGUtPnZpZXcucm90YXRlZDsKPj4gQEAgLTI4MjYsMjAgKzI4MjYsMjAg
QEAgaW50ZWxfcGxhbmVfcmVtYXBfZ3R0KHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVf
c3RhdGUpCj4+ICAJcGxhbmVfc3RhdGUtPnZpZXcudHlwZSA9IGRybV9yb3RhdGlvbl85MF9vcl8y
NzAocm90YXRpb24pID8KPj4gIAkJSTkxNV9HR1RUX1ZJRVdfUk9UQVRFRCA6IEk5MTVfR0dUVF9W
SUVXX1JFTUFQUEVEOwo+PiAgCj4+IC0Jc3JjX3ggPSBwbGFuZV9zdGF0ZS0+YmFzZS5zcmMueDEg
Pj4gMTY7Cj4+IC0Jc3JjX3kgPSBwbGFuZV9zdGF0ZS0+YmFzZS5zcmMueTEgPj4gMTY7Cj4+IC0J
c3JjX3cgPSBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUtPmJhc2Uuc3JjKSA+PiAxNjsKPj4g
LQlzcmNfaCA9IGRybV9yZWN0X2hlaWdodCgmcGxhbmVfc3RhdGUtPmJhc2Uuc3JjKSA+PiAxNjsK
Pj4gKwlzcmNfeCA9IHBsYW5lX3N0YXRlLT51YXBpLnNyYy54MSA+PiAxNjsKPj4gKwlzcmNfeSA9
IHBsYW5lX3N0YXRlLT51YXBpLnNyYy55MSA+PiAxNjsKPj4gKwlzcmNfdyA9IGRybV9yZWN0X3dp
ZHRoKCZwbGFuZV9zdGF0ZS0+dWFwaS5zcmMpID4+IDE2Owo+PiArCXNyY19oID0gZHJtX3JlY3Rf
aGVpZ2h0KCZwbGFuZV9zdGF0ZS0+dWFwaS5zcmMpID4+IDE2Owo+PiAgCj4+ICAJV0FSTl9PTihp
c19jY3NfbW9kaWZpZXIoZmItPm1vZGlmaWVyKSk7Cj4+ICAKPj4gIAkvKiBNYWtlIHNyYyBjb29y
ZGluYXRlcyByZWxhdGl2ZSB0byB0aGUgdmlld3BvcnQgKi8KPj4gLQlkcm1fcmVjdF90cmFuc2xh
dGUoJnBsYW5lX3N0YXRlLT5iYXNlLnNyYywKPj4gKwlkcm1fcmVjdF90cmFuc2xhdGUoJnBsYW5l
X3N0YXRlLT51YXBpLnNyYywKPj4gIAkJCSAgIC0oc3JjX3ggPDwgMTYpLCAtKHNyY195IDw8IDE2
KSk7Cj4+ICAKPj4gIAkvKiBSb3RhdGUgc3JjIGNvb3JkaW5hdGVzIHRvIG1hdGNoIHJvdGF0ZWQg
R1RUIHZpZXcgKi8KPj4gIAlpZiAoZHJtX3JvdGF0aW9uXzkwX29yXzI3MChyb3RhdGlvbikpCj4+
IC0JCWRybV9yZWN0X3JvdGF0ZSgmcGxhbmVfc3RhdGUtPmJhc2Uuc3JjLAo+PiArCQlkcm1fcmVj
dF9yb3RhdGUoJnBsYW5lX3N0YXRlLT51YXBpLnNyYywKPj4gIAkJCQlzcmNfdyA8PCAxNiwgc3Jj
X2ggPDwgMTYsCj4+ICAJCQkJRFJNX01PREVfUk9UQVRFXzI3MCk7Cj4+ICAKPj4gQEAgLTI5NTks
NyArMjk1OSw3IEBAIGludGVsX3BsYW5lX2NvbXB1dGVfZ3R0KHN0cnVjdCBpbnRlbF9wbGFuZV9z
dGF0ZSAqcGxhbmVfc3RhdGUpCj4+ICAKPj4gIAkvKiBSb3RhdGUgc3JjIGNvb3JkaW5hdGVzIHRv
IG1hdGNoIHJvdGF0ZWQgR1RUIHZpZXcgKi8KPj4gIAlpZiAoZHJtX3JvdGF0aW9uXzkwX29yXzI3
MChyb3RhdGlvbikpCj4+IC0JCWRybV9yZWN0X3JvdGF0ZSgmcGxhbmVfc3RhdGUtPmJhc2Uuc3Jj
LAo+PiArCQlkcm1fcmVjdF9yb3RhdGUoJnBsYW5lX3N0YXRlLT51YXBpLnNyYywKPj4gIAkJCQlm
Yi0+YmFzZS53aWR0aCA8PCAxNiwgZmItPmJhc2UuaGVpZ2h0IDw8IDE2LAo+PiAgCQkJCURSTV9N
T0RFX1JPVEFURV8yNzApOwo+PiAgCj4+IEBAIC0zMTI3LDkgKzMxMjcsOSBAQCBpbnRlbF9zZXRf
cGxhbmVfdmlzaWJsZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIAkJ
CXN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUsCj4+ICAJCQlib29sIHZpc2li
bGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5l
KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5l
ID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPnVhcGkucGxhbmUpOwo+PiAgCj4+IC0JcGxh
bmVfc3RhdGUtPmJhc2UudmlzaWJsZSA9IHZpc2libGU7Cj4+ICsJcGxhbmVfc3RhdGUtPnVhcGku
dmlzaWJsZSA9IHZpc2libGU7Cj4+ICAKPj4gIAlpZiAodmlzaWJsZSkKPj4gIAkJY3J0Y19zdGF0
ZS0+dWFwaS5wbGFuZV9tYXNrIHw9IGRybV9wbGFuZV9tYXNrKCZwbGFuZS0+YmFzZSk7Cj4+IEBA
IC0zMjc1LDggKzMyNzUsOCBAQCBpbnRlbF9maW5kX2luaXRpYWxfcGxhbmVfb2JqKHN0cnVjdCBp
bnRlbF9jcnRjICppbnRlbF9jcnRjLAo+PiAgCXBsYW5lX3N0YXRlLT5jcnRjX3cgPSBmYi0+d2lk
dGg7Cj4+ICAJcGxhbmVfc3RhdGUtPmNydGNfaCA9IGZiLT5oZWlnaHQ7Cj4+ICAKPj4gLQlpbnRl
bF9zdGF0ZS0+YmFzZS5zcmMgPSBkcm1fcGxhbmVfc3RhdGVfc3JjKHBsYW5lX3N0YXRlKTsKPj4g
LQlpbnRlbF9zdGF0ZS0+YmFzZS5kc3QgPSBkcm1fcGxhbmVfc3RhdGVfZGVzdChwbGFuZV9zdGF0
ZSk7Cj4+ICsJaW50ZWxfc3RhdGUtPnVhcGkuc3JjID0gZHJtX3BsYW5lX3N0YXRlX3NyYyhwbGFu
ZV9zdGF0ZSk7Cj4+ICsJaW50ZWxfc3RhdGUtPnVhcGkuZHN0ID0gZHJtX3BsYW5lX3N0YXRlX2Rl
c3QocGxhbmVfc3RhdGUpOwo+PiAgCj4+ICAJaWYgKHBsYW5lX2NvbmZpZy0+dGlsaW5nKQo+PiAg
CQlkZXZfcHJpdi0+cHJlc2VydmVfYmlvc19zd2l6emxlID0gdHJ1ZTsKPj4gQEAgLTM0MTEsMTMg
KzM0MTEsMTMgQEAgc3RhdGljIGJvb2wgc2tsX2NoZWNrX21haW5fY2NzX2Nvb3JkaW5hdGVzKHN0
cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUKPj4gIAo+PiAgc3RhdGljIGludCBz
a2xfY2hlY2tfbWFpbl9zdXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3Rh
dGUpCj4+ICB7Cj4+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZS0+ZGV2KTsKPj4gKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHBsYW5lX3N0YXRlLT51YXBpLnBsYW5lLT5kZXYpOwo+
PiAgCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmh3LmZi
Owo+PiAgCXVuc2lnbmVkIGludCByb3RhdGlvbiA9IHBsYW5lX3N0YXRlLT5ody5yb3RhdGlvbjsK
Pj4gLQlpbnQgeCA9IHBsYW5lX3N0YXRlLT5iYXNlLnNyYy54MSA+PiAxNjsKPj4gLQlpbnQgeSA9
IHBsYW5lX3N0YXRlLT5iYXNlLnNyYy55MSA+PiAxNjsKPj4gLQlpbnQgdyA9IGRybV9yZWN0X3dp
ZHRoKCZwbGFuZV9zdGF0ZS0+YmFzZS5zcmMpID4+IDE2Owo+PiAtCWludCBoID0gZHJtX3JlY3Rf
aGVpZ2h0KCZwbGFuZV9zdGF0ZS0+YmFzZS5zcmMpID4+IDE2Owo+PiArCWludCB4ID0gcGxhbmVf
c3RhdGUtPnVhcGkuc3JjLngxID4+IDE2Owo+PiArCWludCB5ID0gcGxhbmVfc3RhdGUtPnVhcGku
c3JjLnkxID4+IDE2Owo+PiArCWludCB3ID0gZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT51
YXBpLnNyYykgPj4gMTY7Cj4+ICsJaW50IGggPSBkcm1fcmVjdF9oZWlnaHQoJnBsYW5lX3N0YXRl
LT51YXBpLnNyYykgPj4gMTY7Cj4+ICAJaW50IG1heF93aWR0aDsKPj4gIAlpbnQgbWF4X2hlaWdo
dDsKPj4gIAl1MzIgYWxpZ25tZW50LCBvZmZzZXQsIGF1eF9vZmZzZXQgPSBwbGFuZV9zdGF0ZS0+
Y29sb3JfcGxhbmVbMV0ub2Zmc2V0Owo+PiBAQCAtMzUwMCw3ICszNTAwLDcgQEAgc3RhdGljIGlu
dCBza2xfY2hlY2tfbWFpbl9zdXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVf
c3RhdGUpCj4+ICAJICogUHV0IHRoZSBmaW5hbCBjb29yZGluYXRlcyBiYWNrIHNvIHRoYXQgdGhl
IHNyYwo+PiAgCSAqIGNvb3JkaW5hdGUgY2hlY2tzIHdpbGwgc2VlIHRoZSByaWdodCB2YWx1ZXMu
Cj4+ICAJICovCj4+IC0JZHJtX3JlY3RfdHJhbnNsYXRlX3RvKCZwbGFuZV9zdGF0ZS0+YmFzZS5z
cmMsCj4+ICsJZHJtX3JlY3RfdHJhbnNsYXRlX3RvKCZwbGFuZV9zdGF0ZS0+dWFwaS5zcmMsCj4+
ICAJCQkgICAgICB4IDw8IDE2LCB5IDw8IDE2KTsKPj4gIAo+PiAgCXJldHVybiAwOwo+PiBAQCAt
MzUxMiwxMCArMzUxMiwxMCBAQCBzdGF0aWMgaW50IHNrbF9jaGVja19udjEyX2F1eF9zdXJmYWNl
KHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4+ICAJdW5zaWduZWQgaW50
IHJvdGF0aW9uID0gcGxhbmVfc3RhdGUtPmh3LnJvdGF0aW9uOwo+PiAgCWludCBtYXhfd2lkdGgg
PSBza2xfbWF4X3BsYW5lX3dpZHRoKGZiLCAxLCByb3RhdGlvbik7Cj4+ICAJaW50IG1heF9oZWln
aHQgPSA0MDk2Owo+PiAtCWludCB4ID0gcGxhbmVfc3RhdGUtPmJhc2Uuc3JjLngxID4+IDE3Owo+
PiAtCWludCB5ID0gcGxhbmVfc3RhdGUtPmJhc2Uuc3JjLnkxID4+IDE3Owo+PiAtCWludCB3ID0g
ZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT5iYXNlLnNyYykgPj4gMTc7Cj4+IC0JaW50IGgg
PSBkcm1fcmVjdF9oZWlnaHQoJnBsYW5lX3N0YXRlLT5iYXNlLnNyYykgPj4gMTc7Cj4+ICsJaW50
IHggPSBwbGFuZV9zdGF0ZS0+dWFwaS5zcmMueDEgPj4gMTc7Cj4+ICsJaW50IHkgPSBwbGFuZV9z
dGF0ZS0+dWFwaS5zcmMueTEgPj4gMTc7Cj4+ICsJaW50IHcgPSBkcm1fcmVjdF93aWR0aCgmcGxh
bmVfc3RhdGUtPnVhcGkuc3JjKSA+PiAxNzsKPj4gKwlpbnQgaCA9IGRybV9yZWN0X2hlaWdodCgm
cGxhbmVfc3RhdGUtPnVhcGkuc3JjKSA+PiAxNzsKPj4gIAl1MzIgb2Zmc2V0Owo+PiAgCj4+ICAJ
aW50ZWxfYWRkX2ZiX29mZnNldHMoJngsICZ5LCBwbGFuZV9zdGF0ZSwgMSk7Cj4+IEBAIC0zNTM4
LDggKzM1MzgsOCBAQCBzdGF0aWMgaW50IHNrbF9jaGVja19udjEyX2F1eF9zdXJmYWNlKHN0cnVj
dCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4+ICBzdGF0aWMgaW50IHNrbF9jaGVj
a19jY3NfYXV4X3N1cmZhY2Uoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkK
Pj4gIHsKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiA9IHBsYW5lX3N0YXRl
LT5ody5mYjsKPj4gLQlpbnQgc3JjX3ggPSBwbGFuZV9zdGF0ZS0+YmFzZS5zcmMueDEgPj4gMTY7
Cj4+IC0JaW50IHNyY195ID0gcGxhbmVfc3RhdGUtPmJhc2Uuc3JjLnkxID4+IDE2Owo+PiArCWlu
dCBzcmNfeCA9IHBsYW5lX3N0YXRlLT51YXBpLnNyYy54MSA+PiAxNjsKPj4gKwlpbnQgc3JjX3kg
PSBwbGFuZV9zdGF0ZS0+dWFwaS5zcmMueTEgPj4gMTY7Cj4+ICAJaW50IGhzdWIgPSBmYi0+Zm9y
bWF0LT5oc3ViOwo+PiAgCWludCB2c3ViID0gZmItPmZvcm1hdC0+dnN1YjsKPj4gIAlpbnQgeCA9
IHNyY194IC8gaHN1YjsKPj4gQEAgLTM1NjUsNyArMzU2NSw3IEBAIGludCBza2xfY2hlY2tfcGxh
bmVfc3VyZmFjZShzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+PiAgCWlm
IChyZXQpCj4+ICAJCXJldHVybiByZXQ7Cj4+ICAKPj4gLQlpZiAoIXBsYW5lX3N0YXRlLT5iYXNl
LnZpc2libGUpCj4+ICsJaWYgKCFwbGFuZV9zdGF0ZS0+dWFwaS52aXNpYmxlKQo+PiAgCQlyZXR1
cm4gMDsKPj4gIAo+PiAgCS8qCj4+IEBAIC0zNjg5LDcgKzM2ODksNyBAQCBzdGF0aWMgdTMyIGk5
eHhfcGxhbmVfY3RsKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+
PiAgCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+PiAg
ewo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Cj4+IC0JCXRvX2k5MTUo
cGxhbmVfc3RhdGUtPmJhc2UucGxhbmUtPmRldik7Cj4+ICsJCXRvX2k5MTUocGxhbmVfc3RhdGUt
PnVhcGkucGxhbmUtPmRldik7Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIg
PSBwbGFuZV9zdGF0ZS0+aHcuZmI7Cj4+ICAJdW5zaWduZWQgaW50IHJvdGF0aW9uID0gcGxhbmVf
c3RhdGUtPmh3LnJvdGF0aW9uOwo+PiAgCXUzMiBkc3BjbnRyOwo+PiBAQCAtMzc0Niw3ICszNzQ2
LDcgQEAgc3RhdGljIHUzMiBpOXh4X3BsYW5lX2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIGludCBpOXh4X2NoZWNrX3BsYW5lX3N1cmZhY2Uoc3RydWN0
IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+PiAtCQl0b19pOTE1KHBsYW5lX3N0YXRlLT5iYXNlLnBs
YW5lLT5kZXYpOwo+PiArCQl0b19pOTE1KHBsYW5lX3N0YXRlLT51YXBpLnBsYW5lLT5kZXYpOwo+
PiAgCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmh3LmZi
Owo+PiAgCWludCBzcmNfeCwgc3JjX3ksIHNyY193Owo+PiAgCXUzMiBvZmZzZXQ7Cj4+IEBAIC0z
NzU2LDEyICszNzU2LDEyIEBAIGludCBpOXh4X2NoZWNrX3BsYW5lX3N1cmZhY2Uoc3RydWN0IGlu
dGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPj4gIAlpZiAocmV0KQo+PiAgCQlyZXR1cm4g
cmV0Owo+PiAgCj4+IC0JaWYgKCFwbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlKQo+PiArCWlmICgh
cGxhbmVfc3RhdGUtPnVhcGkudmlzaWJsZSkKPj4gIAkJcmV0dXJuIDA7Cj4+ICAKPj4gLQlzcmNf
dyA9IGRybV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+YmFzZS5zcmMpID4+IDE2Owo+PiAtCXNy
Y194ID0gcGxhbmVfc3RhdGUtPmJhc2Uuc3JjLngxID4+IDE2Owo+PiAtCXNyY195ID0gcGxhbmVf
c3RhdGUtPmJhc2Uuc3JjLnkxID4+IDE2Owo+PiArCXNyY193ID0gZHJtX3JlY3Rfd2lkdGgoJnBs
YW5lX3N0YXRlLT51YXBpLnNyYykgPj4gMTY7Cj4+ICsJc3JjX3ggPSBwbGFuZV9zdGF0ZS0+dWFw
aS5zcmMueDEgPj4gMTY7Cj4+ICsJc3JjX3kgPSBwbGFuZV9zdGF0ZS0+dWFwaS5zcmMueTEgPj4g
MTY7Cj4+ICAKPj4gIAkvKiBVbmRvY3VtZW50ZWQgaGFyZHdhcmUgbGltaXQgb24gaTk2NS9nNHgv
dmx2L2NodiAqLwo+PiAgCWlmIChIQVNfR01DSChkZXZfcHJpdikgJiYgZmItPmZvcm1hdC0+Y3Bw
WzBdID09IDggJiYgc3JjX3cgPiAyMDQ4KQo+PiBAQCAtMzc3OSwxNCArMzc3OSwxNCBAQCBpbnQg
aTl4eF9jaGVja19wbGFuZV9zdXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVf
c3RhdGUpCj4+ICAJICogUHV0IHRoZSBmaW5hbCBjb29yZGluYXRlcyBiYWNrIHNvIHRoYXQgdGhl
IHNyYwo+PiAgCSAqIGNvb3JkaW5hdGUgY2hlY2tzIHdpbGwgc2VlIHRoZSByaWdodCB2YWx1ZXMu
Cj4+ICAJICovCj4+IC0JZHJtX3JlY3RfdHJhbnNsYXRlX3RvKCZwbGFuZV9zdGF0ZS0+YmFzZS5z
cmMsCj4+ICsJZHJtX3JlY3RfdHJhbnNsYXRlX3RvKCZwbGFuZV9zdGF0ZS0+dWFwaS5zcmMsCj4+
ICAJCQkgICAgICBzcmNfeCA8PCAxNiwgc3JjX3kgPDwgMTYpOwo+PiAgCj4+ICAJLyogSFNXL0JE
VyBkbyB0aGlzIGF1dG9tYWdpY2FsbHkgaW4gaGFyZHdhcmUgKi8KPj4gIAlpZiAoIUlTX0hBU1dF
TEwoZGV2X3ByaXYpICYmICFJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Cj4+ICAJCXVuc2lnbmVk
IGludCByb3RhdGlvbiA9IHBsYW5lX3N0YXRlLT5ody5yb3RhdGlvbjsKPj4gLQkJaW50IHNyY193
ID0gZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT5iYXNlLnNyYykgPj4gMTY7Cj4+IC0JCWlu
dCBzcmNfaCA9IGRybV9yZWN0X2hlaWdodCgmcGxhbmVfc3RhdGUtPmJhc2Uuc3JjKSA+PiAxNjsK
Pj4gKwkJaW50IHNyY193ID0gZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT51YXBpLnNyYykg
Pj4gMTY7Cj4+ICsJCWludCBzcmNfaCA9IGRybV9yZWN0X2hlaWdodCgmcGxhbmVfc3RhdGUtPnVh
cGkuc3JjKSA+PiAxNjsKPj4gIAo+PiAgCQlpZiAocm90YXRpb24gJiBEUk1fTU9ERV9ST1RBVEVf
MTgwKSB7Cj4+ICAJCQlzcmNfeCArPSBzcmNfdyAtIDE7Cj4+IEBAIC0zODIzLDE0ICszODIzLDE0
IEBAIHN0YXRpYyBpbnQKPj4gIGk5eHhfcGxhbmVfY2hlY2soc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUsCj4+ICAJCSBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0
YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFu
ZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4+ICsJc3RydWN0IGludGVsX3BsYW5lICpwbGFu
ZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT51YXBpLnBsYW5lKTsKPj4gIAlpbnQgcmV0
Owo+PiAgCj4+ICAJcmV0ID0gY2h2X3BsYW5lX2NoZWNrX3JvdGF0aW9uKHBsYW5lX3N0YXRlKTsK
Pj4gIAlpZiAocmV0KQo+PiAgCQlyZXR1cm4gcmV0Owo+PiAgCj4+IC0JcmV0ID0gZHJtX2F0b21p
Y19oZWxwZXJfY2hlY2tfcGxhbmVfc3RhdGUoJnBsYW5lX3N0YXRlLT5iYXNlLAo+PiArCXJldCA9
IGRybV9hdG9taWNfaGVscGVyX2NoZWNrX3BsYW5lX3N0YXRlKCZwbGFuZV9zdGF0ZS0+dWFwaSwK
Pj4gIAkJCQkJCSAgJmNydGNfc3RhdGUtPnVhcGksCj4+ICAJCQkJCQkgIERSTV9QTEFORV9IRUxQ
RVJfTk9fU0NBTElORywKPj4gIAkJCQkJCSAgRFJNX1BMQU5FX0hFTFBFUl9OT19TQ0FMSU5HLAo+
PiBAQCAtMzg0Myw3ICszODQzLDcgQEAgaTl4eF9wbGFuZV9jaGVjayhzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPj4gIAlpZiAocmV0KQo+PiAgCQlyZXR1cm4gcmV0Owo+PiAg
Cj4+IC0JaWYgKCFwbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlKQo+PiArCWlmICghcGxhbmVfc3Rh
dGUtPnVhcGkudmlzaWJsZSkKPj4gIAkJcmV0dXJuIDA7Cj4+ICAKPj4gIAlyZXQgPSBpbnRlbF9w
bGFuZV9jaGVja19zcmNfY29vcmRpbmF0ZXMocGxhbmVfc3RhdGUpOwo+PiBAQCAtMzg2NCwxMCAr
Mzg2NCwxMCBAQCBzdGF0aWMgdm9pZCBpOXh4X3VwZGF0ZV9wbGFuZShzdHJ1Y3QgaW50ZWxfcGxh
bmUgKnBsYW5lLAo+PiAgCXUzMiBsaW5lYXJfb2Zmc2V0Owo+PiAgCWludCB4ID0gcGxhbmVfc3Rh
dGUtPmNvbG9yX3BsYW5lWzBdLng7Cj4+ICAJaW50IHkgPSBwbGFuZV9zdGF0ZS0+Y29sb3JfcGxh
bmVbMF0ueTsKPj4gLQlpbnQgY3J0Y194ID0gcGxhbmVfc3RhdGUtPmJhc2UuZHN0LngxOwo+PiAt
CWludCBjcnRjX3kgPSBwbGFuZV9zdGF0ZS0+YmFzZS5kc3QueTE7Cj4+IC0JaW50IGNydGNfdyA9
IGRybV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+YmFzZS5kc3QpOwo+PiAtCWludCBjcnRjX2gg
PSBkcm1fcmVjdF9oZWlnaHQoJnBsYW5lX3N0YXRlLT5iYXNlLmRzdCk7Cj4+ICsJaW50IGNydGNf
eCA9IHBsYW5lX3N0YXRlLT51YXBpLmRzdC54MTsKPj4gKwlpbnQgY3J0Y195ID0gcGxhbmVfc3Rh
dGUtPnVhcGkuZHN0LnkxOwo+PiArCWludCBjcnRjX3cgPSBkcm1fcmVjdF93aWR0aCgmcGxhbmVf
c3RhdGUtPnVhcGkuZHN0KTsKPj4gKwlpbnQgY3J0Y19oID0gZHJtX3JlY3RfaGVpZ2h0KCZwbGFu
ZV9zdGF0ZS0+dWFwaS5kc3QpOwo+PiAgCXVuc2lnbmVkIGxvbmcgaXJxZmxhZ3M7Cj4+ICAJdTMy
IGRzcGFkZHJfb2Zmc2V0Owo+PiAgCXUzMiBkc3BjbnRyOwo+PiBAQCAtNDIyMSw3ICs0MjIxLDcg
QEAgdTMyIHNrbF9wbGFuZV9jdGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCj4+ICAJCSAgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0
ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQo+PiAtCQl0
b19pOTE1KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lLT5kZXYpOwo+PiArCQl0b19pOTE1KHBsYW5l
X3N0YXRlLT51YXBpLnBsYW5lLT5kZXYpOwo+PiAgCWNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZm
ZXIgKmZiID0gcGxhbmVfc3RhdGUtPmh3LmZiOwo+PiAgCXVuc2lnbmVkIGludCByb3RhdGlvbiA9
IHBsYW5lX3N0YXRlLT5ody5yb3RhdGlvbjsKPj4gIAljb25zdCBzdHJ1Y3QgZHJtX2ludGVsX3Nw
cml0ZV9jb2xvcmtleSAqa2V5ID0gJnBsYW5lX3N0YXRlLT5ja2V5Owo+PiBAQCAtNDI3Nyw5ICs0
Mjc3LDkgQEAgdTMyIGdsa19wbGFuZV9jb2xvcl9jdGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCQljb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUg
KnBsYW5lX3N0YXRlKQo+PiAgewo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9Cj4+IC0JCXRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUtPmRldik7Cj4+ICsJCXRv
X2k5MTUocGxhbmVfc3RhdGUtPnVhcGkucGxhbmUtPmRldik7Cj4+ICAJY29uc3Qgc3RydWN0IGRy
bV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+aHcuZmI7Cj4+IC0Jc3RydWN0IGludGVs
X3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lKTsK
Pj4gKwlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3Rh
dGUtPnVhcGkucGxhbmUpOwo+PiAgCXUzMiBwbGFuZV9jb2xvcl9jdGwgPSAwOwo+PiAgCj4+ICAJ
cGxhbmVfY29sb3JfY3RsIHw9IFBMQU5FX0NPTE9SX1BMQU5FX0dBTU1BX0RJU0FCTEU7Cj4+IEBA
IC01NjIzLDExICs1NjIzLDExIEBAIHN0YXRpYyBpbnQgc2tsX3VwZGF0ZV9zY2FsZXJfcGxhbmUo
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCQkJICAgc3RydWN0IGlu
dGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgaW50ZWxfcGxh
bmUgKmludGVsX3BsYW5lID0KPj4gLQkJdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2Uu
cGxhbmUpOwo+PiArCQl0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+dWFwaS5wbGFuZSk7Cj4+
ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShpbnRlbF9wbGFu
ZS0+YmFzZS5kZXYpOwo+PiAgCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3Rh
dGUtPmh3LmZiOwo+PiAgCWludCByZXQ7Cj4+IC0JYm9vbCBmb3JjZV9kZXRhY2ggPSAhZmIgfHwg
IXBsYW5lX3N0YXRlLT5iYXNlLnZpc2libGU7Cj4+ICsJYm9vbCBmb3JjZV9kZXRhY2ggPSAhZmIg
fHwgIXBsYW5lX3N0YXRlLT51YXBpLnZpc2libGU7Cj4+ICAJYm9vbCBuZWVkX3NjYWxlciA9IGZh
bHNlOwo+PiAgCj4+ICAJLyogUHJlLWdlbjExIGFuZCBTRFIgcGxhbmVzIGFsd2F5cyBuZWVkIGEg
c2NhbGVyIGZvciBwbGFuYXIgZm9ybWF0cy4gKi8KPj4gQEAgLTU2MzgsMTAgKzU2MzgsMTAgQEAg
c3RhdGljIGludCBza2xfdXBkYXRlX3NjYWxlcl9wbGFuZShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKPj4gIAlyZXQgPSBza2xfdXBkYXRlX3NjYWxlcihjcnRjX3N0YXRlLCBm
b3JjZV9kZXRhY2gsCj4+ICAJCQkJZHJtX3BsYW5lX2luZGV4KCZpbnRlbF9wbGFuZS0+YmFzZSks
Cj4+ICAJCQkJJnBsYW5lX3N0YXRlLT5zY2FsZXJfaWQsCj4+IC0JCQkJZHJtX3JlY3Rfd2lkdGgo
JnBsYW5lX3N0YXRlLT5iYXNlLnNyYykgPj4gMTYsCj4+IC0JCQkJZHJtX3JlY3RfaGVpZ2h0KCZw
bGFuZV9zdGF0ZS0+YmFzZS5zcmMpID4+IDE2LAo+PiAtCQkJCWRybV9yZWN0X3dpZHRoKCZwbGFu
ZV9zdGF0ZS0+YmFzZS5kc3QpLAo+PiAtCQkJCWRybV9yZWN0X2hlaWdodCgmcGxhbmVfc3RhdGUt
PmJhc2UuZHN0KSwKPj4gKwkJCQlkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUtPnVhcGkuc3Jj
KSA+PiAxNiwKPj4gKwkJCQlkcm1fcmVjdF9oZWlnaHQoJnBsYW5lX3N0YXRlLT51YXBpLnNyYykg
Pj4gMTYsCj4+ICsJCQkJZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT51YXBpLmRzdCksCj4+
ICsJCQkJZHJtX3JlY3RfaGVpZ2h0KCZwbGFuZV9zdGF0ZS0+dWFwaS5kc3QpLAo+PiAgCQkJCWZi
ID8gZmItPmZvcm1hdCA6IE5VTEwsIG5lZWRfc2NhbGVyKTsKPj4gIAo+PiAgCWlmIChyZXQgfHwg
cGxhbmVfc3RhdGUtPnNjYWxlcl9pZCA8IDApCj4+IEBAIC02MDU3LDcgKzYwNTcsNyBAQCBzdGF0
aWMgdm9pZCBpbnRlbF9wcmVfcGxhbmVfdXBkYXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpv
bGRfY3J0Y19zdGF0ZSwKPj4gIAkJICogU28gZGlzYWJsZSB1bmRlcnJ1biByZXBvcnRpbmcgYmVm
b3JlIGFsbCB0aGUgcGxhbmVzIGdldCBkaXNhYmxlZC4KPj4gIAkJICovCj4+ICAJCWlmIChJU19H
RU4oZGV2X3ByaXYsIDIpICYmIG9sZF9wcmltYXJ5X3N0YXRlLT52aXNpYmxlICYmCj4+IC0JCSAg
ICAobW9kZXNldCB8fCAhbmV3X3ByaW1hcnlfc3RhdGUtPmJhc2UudmlzaWJsZSkpCj4+ICsJCSAg
ICAobW9kZXNldCB8fCAhbmV3X3ByaW1hcnlfc3RhdGUtPnVhcGkudmlzaWJsZSkpCj4+ICAJCQlp
bnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5nKGRldl9wcml2LCBjcnRjLT5waXBl
LCBmYWxzZSk7Cj4+ICAJfQo+PiAgCj4+IEBAIC02MTQ0LDcgKzYxNDQsNyBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9jcnRjX2Rpc2FibGVfcGxhbmVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0
YXRlLAo+PiAgCj4+ICAJCWludGVsX2Rpc2FibGVfcGxhbmUocGxhbmUsIG5ld19jcnRjX3N0YXRl
KTsKPj4gIAo+PiAtCQlpZiAob2xkX3BsYW5lX3N0YXRlLT5iYXNlLnZpc2libGUpCj4+ICsJCWlm
IChvbGRfcGxhbmVfc3RhdGUtPnVhcGkudmlzaWJsZSkKPj4gIAkJCWZiX2JpdHMgfD0gcGxhbmUt
PmZyb250YnVmZmVyX2JpdDsKPj4gIAl9Cj4+ICAKPj4gQEAgLTcxNTMsNyArNzE1Myw3IEBAIHN0
YXRpYyB2b2lkIGludGVsX2NydGNfZGlzYWJsZV9ub2F0b21pYyhzdHJ1Y3QgZHJtX2NydGMgKmNy
dGMsCj4+ICAJCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUgPQo+
PiAgCQkJdG9faW50ZWxfcGxhbmVfc3RhdGUocGxhbmUtPmJhc2Uuc3RhdGUpOwo+PiAgCj4+IC0J
CWlmIChwbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlKQo+PiArCQlpZiAocGxhbmVfc3RhdGUtPnVh
cGkudmlzaWJsZSkKPj4gIAkJCWludGVsX3BsYW5lX2Rpc2FibGVfbm9hdG9taWMoaW50ZWxfY3J0
YywgcGxhbmUpOwo+PiAgCX0KPj4gIAo+PiBAQCAtMTA3MjgsNyArMTA3MjgsNyBAQCBzdGF0aWMg
Ym9vbCBoYXN3ZWxsX2dldF9waXBlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKPj4g
IHN0YXRpYyB1MzIgaW50ZWxfY3Vyc29yX2Jhc2UoY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0
YXRlICpwbGFuZV9zdGF0ZSkKPj4gIHsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPQo+PiAtCQl0b19pOTE1KHBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lLT5kZXYpOwo+PiAr
CQl0b19pOTE1KHBsYW5lX3N0YXRlLT51YXBpLnBsYW5lLT5kZXYpOwo+PiAgCWNvbnN0IHN0cnVj
dCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxhbmVfc3RhdGUtPmh3LmZiOwo+PiAgCWNvbnN0IHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBpbnRlbF9mYl9vYmooZmIpOwo+PiAgCXUz
MiBiYXNlOwo+PiBAQCAtMTA3NDMsOCArMTA3NDMsOCBAQCBzdGF0aWMgdTMyIGludGVsX2N1cnNv
cl9iYXNlKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4+ICAK
Pj4gIHN0YXRpYyB1MzIgaW50ZWxfY3Vyc29yX3Bvc2l0aW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9w
bGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4+ICB7Cj4+IC0JaW50IHggPSBwbGFuZV9zdGF0ZS0+
YmFzZS5kc3QueDE7Cj4+IC0JaW50IHkgPSBwbGFuZV9zdGF0ZS0+YmFzZS5kc3QueTE7Cj4+ICsJ
aW50IHggPSBwbGFuZV9zdGF0ZS0+dWFwaS5kc3QueDE7Cj4+ICsJaW50IHkgPSBwbGFuZV9zdGF0
ZS0+dWFwaS5kc3QueTE7Cj4+ICAJdTMyIHBvcyA9IDA7Cj4+ICAKPj4gIAlpZiAoeCA8IDApIHsK
Pj4gQEAgLTEwNzY1LDkgKzEwNzY1LDkgQEAgc3RhdGljIHUzMiBpbnRlbF9jdXJzb3JfcG9zaXRp
b24oY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPj4gIHN0YXRp
YyBib29sIGludGVsX2N1cnNvcl9zaXplX29rKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0
ZSAqcGxhbmVfc3RhdGUpCj4+ICB7Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9tb2RlX2NvbmZpZyAq
Y29uZmlnID0KPj4gLQkJJnBsYW5lX3N0YXRlLT5iYXNlLnBsYW5lLT5kZXYtPm1vZGVfY29uZmln
Owo+PiAtCWludCB3aWR0aCA9IGRybV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+YmFzZS5kc3Qp
Owo+PiAtCWludCBoZWlnaHQgPSBkcm1fcmVjdF9oZWlnaHQoJnBsYW5lX3N0YXRlLT5iYXNlLmRz
dCk7Cj4+ICsJCSZwbGFuZV9zdGF0ZS0+dWFwaS5wbGFuZS0+ZGV2LT5tb2RlX2NvbmZpZzsKPj4g
KwlpbnQgd2lkdGggPSBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUtPnVhcGkuZHN0KTsKPj4g
KwlpbnQgaGVpZ2h0ID0gZHJtX3JlY3RfaGVpZ2h0KCZwbGFuZV9zdGF0ZS0+dWFwaS5kc3QpOwo+
PiAgCj4+ICAJcmV0dXJuIHdpZHRoID4gMCAmJiB3aWR0aCA8PSBjb25maWctPmN1cnNvcl93aWR0
aCAmJgo+PiAgCQloZWlnaHQgPiAwICYmIGhlaWdodCA8PSBjb25maWctPmN1cnNvcl9oZWlnaHQ7
Cj4+IEBAIC0xMDc3Niw3ICsxMDc3Niw3IEBAIHN0YXRpYyBib29sIGludGVsX2N1cnNvcl9zaXpl
X29rKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4+ICBzdGF0
aWMgaW50IGludGVsX2N1cnNvcl9jaGVja19zdXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0
ZSAqcGxhbmVfc3RhdGUpCj4+ICB7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2ID0KPj4gLQkJdG9faTkxNShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZS0+ZGV2KTsKPj4gKwkJ
dG9faTkxNShwbGFuZV9zdGF0ZS0+dWFwaS5wbGFuZS0+ZGV2KTsKPj4gIAl1bnNpZ25lZCBpbnQg
cm90YXRpb24gPSBwbGFuZV9zdGF0ZS0+aHcucm90YXRpb247Cj4+ICAJaW50IHNyY194LCBzcmNf
eTsKPj4gIAl1MzIgb2Zmc2V0Owo+PiBAQCAtMTA3ODYsMTEgKzEwNzg2LDExIEBAIHN0YXRpYyBp
bnQgaW50ZWxfY3Vyc29yX2NoZWNrX3N1cmZhY2Uoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpw
bGFuZV9zdGF0ZSkKPj4gIAlpZiAocmV0KQo+PiAgCQlyZXR1cm4gcmV0Owo+PiAgCj4+IC0JaWYg
KCFwbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlKQo+PiArCWlmICghcGxhbmVfc3RhdGUtPnVhcGku
dmlzaWJsZSkKPj4gIAkJcmV0dXJuIDA7Cj4+ICAKPj4gLQlzcmNfeCA9IHBsYW5lX3N0YXRlLT5i
YXNlLnNyYy54MSA+PiAxNjsKPj4gLQlzcmNfeSA9IHBsYW5lX3N0YXRlLT5iYXNlLnNyYy55MSA+
PiAxNjsKPj4gKwlzcmNfeCA9IHBsYW5lX3N0YXRlLT51YXBpLnNyYy54MSA+PiAxNjsKPj4gKwlz
cmNfeSA9IHBsYW5lX3N0YXRlLT51YXBpLnNyYy55MSA+PiAxNjsKPj4gIAo+PiAgCWludGVsX2Fk
ZF9mYl9vZmZzZXRzKCZzcmNfeCwgJnNyY195LCBwbGFuZV9zdGF0ZSwgMCk7Cj4+ICAJb2Zmc2V0
ID0gaW50ZWxfcGxhbmVfY29tcHV0ZV9hbGlnbmVkX29mZnNldCgmc3JjX3gsICZzcmNfeSwKPj4g
QEAgLTEwODA1LDE0ICsxMDgwNSwxNCBAQCBzdGF0aWMgaW50IGludGVsX2N1cnNvcl9jaGVja19z
dXJmYWNlKHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4+ICAJICogUHV0
IHRoZSBmaW5hbCBjb29yZGluYXRlcyBiYWNrIHNvIHRoYXQgdGhlIHNyYwo+PiAgCSAqIGNvb3Jk
aW5hdGUgY2hlY2tzIHdpbGwgc2VlIHRoZSByaWdodCB2YWx1ZXMuCj4+ICAJICovCj4+IC0JZHJt
X3JlY3RfdHJhbnNsYXRlX3RvKCZwbGFuZV9zdGF0ZS0+YmFzZS5zcmMsCj4+ICsJZHJtX3JlY3Rf
dHJhbnNsYXRlX3RvKCZwbGFuZV9zdGF0ZS0+dWFwaS5zcmMsCj4+ICAJCQkgICAgICBzcmNfeCA8
PCAxNiwgc3JjX3kgPDwgMTYpOwo+PiAgCj4+ICAJLyogSUxLKyBkbyB0aGlzIGF1dG9tYWdpY2Fs
bHkgaW4gaGFyZHdhcmUgKi8KPj4gIAlpZiAoSEFTX0dNQ0goZGV2X3ByaXYpICYmIHJvdGF0aW9u
ICYgRFJNX01PREVfUk9UQVRFXzE4MCkgewo+PiAgCQljb25zdCBzdHJ1Y3QgZHJtX2ZyYW1lYnVm
ZmVyICpmYiA9IHBsYW5lX3N0YXRlLT5ody5mYjsKPj4gLQkJaW50IHNyY193ID0gZHJtX3JlY3Rf
d2lkdGgoJnBsYW5lX3N0YXRlLT5iYXNlLnNyYykgPj4gMTY7Cj4+IC0JCWludCBzcmNfaCA9IGRy
bV9yZWN0X2hlaWdodCgmcGxhbmVfc3RhdGUtPmJhc2Uuc3JjKSA+PiAxNjsKPj4gKwkJaW50IHNy
Y193ID0gZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT51YXBpLnNyYykgPj4gMTY7Cj4+ICsJ
CWludCBzcmNfaCA9IGRybV9yZWN0X2hlaWdodCgmcGxhbmVfc3RhdGUtPnVhcGkuc3JjKSA+PiAx
NjsKPj4gIAo+PiAgCQlvZmZzZXQgKz0gKHNyY19oICogc3JjX3cgLSAxKSAqIGZiLT5mb3JtYXQt
PmNwcFswXTsKPj4gIAl9Cj4+IEBAIC0xMDgzNSw3ICsxMDgzNSw3IEBAIHN0YXRpYyBpbnQgaW50
ZWxfY2hlY2tfY3Vyc29yKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAg
CQlyZXR1cm4gLUVJTlZBTDsKPj4gIAl9Cj4+ICAKPj4gLQlyZXQgPSBkcm1fYXRvbWljX2hlbHBl
cl9jaGVja19wbGFuZV9zdGF0ZSgmcGxhbmVfc3RhdGUtPmJhc2UsCj4+ICsJcmV0ID0gZHJtX2F0
b21pY19oZWxwZXJfY2hlY2tfcGxhbmVfc3RhdGUoJnBsYW5lX3N0YXRlLT51YXBpLAo+PiAgCQkJ
CQkJICAmY3J0Y19zdGF0ZS0+dWFwaSwKPj4gIAkJCQkJCSAgRFJNX1BMQU5FX0hFTFBFUl9OT19T
Q0FMSU5HLAo+PiAgCQkJCQkJICBEUk1fUExBTkVfSEVMUEVSX05PX1NDQUxJTkcsCj4+IEBAIC0x
MDg0NCwxNCArMTA4NDQsMTQgQEAgc3RhdGljIGludCBpbnRlbF9jaGVja19jdXJzb3Ioc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCXJldHVybiByZXQ7Cj4+ICAKPj4g
IAkvKiBVc2UgdGhlIHVuY2xpcHBlZCBzcmMvZHN0IHJlY3RhbmdsZXMsIHdoaWNoIHdlIHByb2dy
YW0gdG8gaHcgKi8KPj4gLQlwbGFuZV9zdGF0ZS0+YmFzZS5zcmMgPSBkcm1fcGxhbmVfc3RhdGVf
c3JjKCZwbGFuZV9zdGF0ZS0+YmFzZSk7Cj4+IC0JcGxhbmVfc3RhdGUtPmJhc2UuZHN0ID0gZHJt
X3BsYW5lX3N0YXRlX2Rlc3QoJnBsYW5lX3N0YXRlLT5iYXNlKTsKPj4gKwlwbGFuZV9zdGF0ZS0+
dWFwaS5zcmMgPSBkcm1fcGxhbmVfc3RhdGVfc3JjKCZwbGFuZV9zdGF0ZS0+dWFwaSk7Cj4+ICsJ
cGxhbmVfc3RhdGUtPnVhcGkuZHN0ID0gZHJtX3BsYW5lX3N0YXRlX2Rlc3QoJnBsYW5lX3N0YXRl
LT51YXBpKTsKPj4gIAo+PiAgCXJldCA9IGludGVsX2N1cnNvcl9jaGVja19zdXJmYWNlKHBsYW5l
X3N0YXRlKTsKPj4gIAlpZiAocmV0KQo+PiAgCQlyZXR1cm4gcmV0Owo+PiAgCj4+IC0JaWYgKCFw
bGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlKQo+PiArCWlmICghcGxhbmVfc3RhdGUtPnVhcGkudmlz
aWJsZSkKPj4gIAkJcmV0dXJuIDA7Cj4+ICAKPj4gIAlyZXQgPSBpbnRlbF9wbGFuZV9jaGVja19z
cmNfY29vcmRpbmF0ZXMocGxhbmVfc3RhdGUpOwo+PiBAQCAtMTA4ODksNyArMTA4ODksNyBAQCBz
dGF0aWMgdTMyIGk4NDVfY3Vyc29yX2N0bChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPj4gIAo+PiAgc3RhdGljIGJvb2wgaTg0NV9jdXJzb3Jfc2l6ZV9vayhjb25z
dCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+PiAgewo+PiAtCWludCB3
aWR0aCA9IGRybV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+YmFzZS5kc3QpOwo+PiArCWludCB3
aWR0aCA9IGRybV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+dWFwaS5kc3QpOwo+PiAgCj4+ICAJ
LyoKPj4gIAkgKiA4NDVnLzg2NWcgYXJlIG9ubHkgbGltaXRlZCBieSB0aGUgd2lkdGggb2YgdGhl
aXIgY3Vyc29ycywKPj4gQEAgLTEwOTE1LDEyICsxMDkxNSwxMiBAQCBzdGF0aWMgaW50IGk4NDVf
Y2hlY2tfY3Vyc29yKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCS8q
IENoZWNrIGZvciB3aGljaCBjdXJzb3IgdHlwZXMgd2Ugc3VwcG9ydCAqLwo+PiAgCWlmICghaTg0
NV9jdXJzb3Jfc2l6ZV9vayhwbGFuZV9zdGF0ZSkpIHsKPj4gIAkJRFJNX0RFQlVHKCJDdXJzb3Ig
ZGltZW5zaW9uICVkeCVkIG5vdCBzdXBwb3J0ZWRcbiIsCj4+IC0JCQkgIGRybV9yZWN0X3dpZHRo
KCZwbGFuZV9zdGF0ZS0+YmFzZS5kc3QpLAo+PiAtCQkJICBkcm1fcmVjdF9oZWlnaHQoJnBsYW5l
X3N0YXRlLT5iYXNlLmRzdCkpOwo+PiArCQkJICBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUt
PnVhcGkuZHN0KSwKPj4gKwkJCSAgZHJtX3JlY3RfaGVpZ2h0KCZwbGFuZV9zdGF0ZS0+dWFwaS5k
c3QpKTsKPj4gIAkJcmV0dXJuIC1FSU5WQUw7Cj4+ICAJfQo+PiAgCj4+IC0JV0FSTl9PTihwbGFu
ZV9zdGF0ZS0+YmFzZS52aXNpYmxlICYmCj4+ICsJV0FSTl9PTihwbGFuZV9zdGF0ZS0+dWFwaS52
aXNpYmxlICYmCj4+ICAJCXBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5zdHJpZGUgIT0gZmIt
PnBpdGNoZXNbMF0pOwo+PiAgCj4+ICAJc3dpdGNoIChmYi0+cGl0Y2hlc1swXSkgewo+PiBAQCAt
MTA5NDgsOSArMTA5NDgsOSBAQCBzdGF0aWMgdm9pZCBpODQ1X3VwZGF0ZV9jdXJzb3Ioc3RydWN0
IGludGVsX3BsYW5lICpwbGFuZSwKPj4gIAl1MzIgY250bCA9IDAsIGJhc2UgPSAwLCBwb3MgPSAw
LCBzaXplID0gMDsKPj4gIAl1bnNpZ25lZCBsb25nIGlycWZsYWdzOwo+PiAgCj4+IC0JaWYgKHBs
YW5lX3N0YXRlICYmIHBsYW5lX3N0YXRlLT5iYXNlLnZpc2libGUpIHsKPj4gLQkJdW5zaWduZWQg
aW50IHdpZHRoID0gZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT5iYXNlLnNyYyk7Cj4+IC0J
CXVuc2lnbmVkIGludCBoZWlnaHQgPSBkcm1fcmVjdF9oZWlnaHQoJnBsYW5lX3N0YXRlLT5iYXNl
LmRzdCk7Cj4+ICsJaWYgKHBsYW5lX3N0YXRlICYmIHBsYW5lX3N0YXRlLT51YXBpLnZpc2libGUp
IHsKPj4gKwkJdW5zaWduZWQgaW50IHdpZHRoID0gZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRl
LT51YXBpLnNyYyk7Cj4+ICsJCXVuc2lnbmVkIGludCBoZWlnaHQgPSBkcm1fcmVjdF9oZWlnaHQo
JnBsYW5lX3N0YXRlLT51YXBpLmRzdCk7Cj4+ICAKPj4gIAkJY250bCA9IHBsYW5lX3N0YXRlLT5j
dGwgfAo+PiAgCQkJaTg0NV9jdXJzb3JfY3RsX2NydGMoY3J0Y19zdGF0ZSk7Cj4+IEBAIC0xMTA0
NiwxMyArMTEwNDYsMTMgQEAgc3RhdGljIHUzMiBpOXh4X2N1cnNvcl9jdGwoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICAJCQkgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+PiAgewo+PiAgCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9Cj4+IC0JCXRvX2k5MTUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUt
PmRldik7Cj4+ICsJCXRvX2k5MTUocGxhbmVfc3RhdGUtPnVhcGkucGxhbmUtPmRldik7Cj4+ICAJ
dTMyIGNudGwgPSAwOwo+PiAgCj4+ICAJaWYgKElTX0dFTihkZXZfcHJpdiwgNikgfHwgSVNfSVZZ
QlJJREdFKGRldl9wcml2KSkKPj4gIAkJY250bCB8PSBNQ1VSU09SX1RSSUNLTEVfRkVFRF9ESVNB
QkxFOwo+PiAgCj4+IC0Jc3dpdGNoIChkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUtPmJhc2Uu
ZHN0KSkgewo+PiArCXN3aXRjaCAoZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT51YXBpLmRz
dCkpIHsKPj4gIAljYXNlIDY0Ogo+PiAgCQljbnRsIHw9IE1DVVJTT1JfTU9ERV82NF9BUkdCX0FY
Owo+PiAgCQlicmVhazsKPj4gQEAgLTExMDYzLDcgKzExMDYzLDcgQEAgc3RhdGljIHUzMiBpOXh4
X2N1cnNvcl9jdGwoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+
ICAJCWNudGwgfD0gTUNVUlNPUl9NT0RFXzI1Nl9BUkdCX0FYOwo+PiAgCQlicmVhazsKPj4gIAlk
ZWZhdWx0Ogo+PiAtCQlNSVNTSU5HX0NBU0UoZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT5i
YXNlLmRzdCkpOwo+PiArCQlNSVNTSU5HX0NBU0UoZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRl
LT51YXBpLmRzdCkpOwo+PiAgCQlyZXR1cm4gMDsKPj4gIAl9Cj4+ICAKPj4gQEAgLTExMDc2LDkg
KzExMDc2LDkgQEAgc3RhdGljIHUzMiBpOXh4X2N1cnNvcl9jdGwoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4+ICBzdGF0aWMgYm9vbCBpOXh4X2N1cnNvcl9zaXpl
X29rKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4+ICB7Cj4+
ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KPj4gLQkJdG9faTkxNShwbGFu
ZV9zdGF0ZS0+YmFzZS5wbGFuZS0+ZGV2KTsKPj4gLQlpbnQgd2lkdGggPSBkcm1fcmVjdF93aWR0
aCgmcGxhbmVfc3RhdGUtPmJhc2UuZHN0KTsKPj4gLQlpbnQgaGVpZ2h0ID0gZHJtX3JlY3RfaGVp
Z2h0KCZwbGFuZV9zdGF0ZS0+YmFzZS5kc3QpOwo+PiArCQl0b19pOTE1KHBsYW5lX3N0YXRlLT51
YXBpLnBsYW5lLT5kZXYpOwo+PiArCWludCB3aWR0aCA9IGRybV9yZWN0X3dpZHRoKCZwbGFuZV9z
dGF0ZS0+dWFwaS5kc3QpOwo+PiArCWludCBoZWlnaHQgPSBkcm1fcmVjdF9oZWlnaHQoJnBsYW5l
X3N0YXRlLT51YXBpLmRzdCk7Cj4+ICAKPj4gIAlpZiAoIWludGVsX2N1cnNvcl9zaXplX29rKHBs
YW5lX3N0YXRlKSkKPj4gIAkJcmV0dXJuIGZhbHNlOwo+PiBAQCAtMTExMTQsNyArMTExMTQsNyBA
QCBzdGF0aWMgYm9vbCBpOXh4X2N1cnNvcl9zaXplX29rKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFu
ZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4+ICBzdGF0aWMgaW50IGk5eHhfY2hlY2tfY3Vyc29yKHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCQkJICAgICBzdHJ1Y3QgaW50
ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+PiAgewo+PiAtCXN0cnVjdCBpbnRlbF9wbGFu
ZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+YmFzZS5wbGFuZSk7Cj4+ICsJ
c3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRlLT51
YXBpLnBsYW5lKTsKPj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KHBsYW5lLT5iYXNlLmRldik7Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAq
ZmIgPSBwbGFuZV9zdGF0ZS0+aHcuZmI7Cj4+ICAJZW51bSBwaXBlIHBpcGUgPSBwbGFuZS0+cGlw
ZTsKPj4gQEAgLTExMTMxLDE5ICsxMTEzMSwxOSBAQCBzdGF0aWMgaW50IGk5eHhfY2hlY2tfY3Vy
c29yKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+PiAgCS8qIENoZWNrIGZv
ciB3aGljaCBjdXJzb3IgdHlwZXMgd2Ugc3VwcG9ydCAqLwo+PiAgCWlmICghaTl4eF9jdXJzb3Jf
c2l6ZV9vayhwbGFuZV9zdGF0ZSkpIHsKPj4gIAkJRFJNX0RFQlVHKCJDdXJzb3IgZGltZW5zaW9u
ICVkeCVkIG5vdCBzdXBwb3J0ZWRcbiIsCj4+IC0JCQkgIGRybV9yZWN0X3dpZHRoKCZwbGFuZV9z
dGF0ZS0+YmFzZS5kc3QpLAo+PiAtCQkJICBkcm1fcmVjdF9oZWlnaHQoJnBsYW5lX3N0YXRlLT5i
YXNlLmRzdCkpOwo+PiArCQkJICBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUtPnVhcGkuZHN0
KSwKPj4gKwkJCSAgZHJtX3JlY3RfaGVpZ2h0KCZwbGFuZV9zdGF0ZS0+dWFwaS5kc3QpKTsKPj4g
IAkJcmV0dXJuIC1FSU5WQUw7Cj4+ICAJfQo+PiAgCj4+IC0JV0FSTl9PTihwbGFuZV9zdGF0ZS0+
YmFzZS52aXNpYmxlICYmCj4+ICsJV0FSTl9PTihwbGFuZV9zdGF0ZS0+dWFwaS52aXNpYmxlICYm
Cj4+ICAJCXBsYW5lX3N0YXRlLT5jb2xvcl9wbGFuZVswXS5zdHJpZGUgIT0gZmItPnBpdGNoZXNb
MF0pOwo+PiAgCj4+ICAJaWYgKGZiLT5waXRjaGVzWzBdICE9Cj4+IC0JICAgIGRybV9yZWN0X3dp
ZHRoKCZwbGFuZV9zdGF0ZS0+YmFzZS5kc3QpICogZmItPmZvcm1hdC0+Y3BwWzBdKSB7Cj4+ICsJ
ICAgIGRybV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+dWFwaS5kc3QpICogZmItPmZvcm1hdC0+
Y3BwWzBdKSB7Cj4+ICAJCURSTV9ERUJVR19LTVMoIkludmFsaWQgY3Vyc29yIHN0cmlkZSAoJXUp
IChjdXJzb3Igd2lkdGggJWQpXG4iLAo+PiAgCQkJICAgICAgZmItPnBpdGNoZXNbMF0sCj4+IC0J
CQkgICAgICBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUtPmJhc2UuZHN0KSk7Cj4+ICsJCQkg
ICAgICBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUtPnVhcGkuZHN0KSk7Cj4+ICAJCXJldHVy
biAtRUlOVkFMOwo+PiAgCX0KPj4gIAo+PiBAQCAtMTExNTgsNyArMTExNTgsNyBAQCBzdGF0aWMg
aW50IGk5eHhfY2hlY2tfY3Vyc29yKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
LAo+PiAgCSAqIFJlZnVzZSB0aGUgcHV0IHRoZSBjdXJzb3IgaW50byB0aGF0IGNvbXByb21pc2Vk
IHBvc2l0aW9uLgo+PiAgCSAqLwo+PiAgCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSAmJiBw
aXBlID09IFBJUEVfQyAmJgo+PiAtCSAgICBwbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlICYmIHBs
YW5lX3N0YXRlLT5iYXNlLmRzdC54MSA8IDApIHsKPj4gKwkgICAgcGxhbmVfc3RhdGUtPnVhcGku
dmlzaWJsZSAmJiBwbGFuZV9zdGF0ZS0+dWFwaS5kc3QueDEgPCAwKSB7Cj4+ICAJCURSTV9ERUJV
R19LTVMoIkNIViBjdXJzb3IgQyBub3QgYWxsb3dlZCB0byBzdHJhZGRsZSB0aGUgbGVmdCBzY3Jl
ZW4gZWRnZVxuIik7Cj4+ICAJCXJldHVybiAtRUlOVkFMOwo+PiAgCX0KPj4gQEAgLTExMTc3LDkg
KzExMTc3LDkgQEAgc3RhdGljIHZvaWQgaTl4eF91cGRhdGVfY3Vyc29yKHN0cnVjdCBpbnRlbF9w
bGFuZSAqcGxhbmUsCj4+ICAJdTMyIGNudGwgPSAwLCBiYXNlID0gMCwgcG9zID0gMCwgZmJjX2N0
bCA9IDA7Cj4+ICAJdW5zaWduZWQgbG9uZyBpcnFmbGFnczsKPj4gIAo+PiAtCWlmIChwbGFuZV9z
dGF0ZSAmJiBwbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlKSB7Cj4+IC0JCXVuc2lnbmVkIHdpZHRo
ID0gZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT5iYXNlLmRzdCk7Cj4+IC0JCXVuc2lnbmVk
IGhlaWdodCA9IGRybV9yZWN0X2hlaWdodCgmcGxhbmVfc3RhdGUtPmJhc2UuZHN0KTsKPj4gKwlp
ZiAocGxhbmVfc3RhdGUgJiYgcGxhbmVfc3RhdGUtPnVhcGkudmlzaWJsZSkgewo+PiArCQl1bnNp
Z25lZCB3aWR0aCA9IGRybV9yZWN0X3dpZHRoKCZwbGFuZV9zdGF0ZS0+dWFwaS5kc3QpOwo+PiAr
CQl1bnNpZ25lZCBoZWlnaHQgPSBkcm1fcmVjdF9oZWlnaHQoJnBsYW5lX3N0YXRlLT51YXBpLmRz
dCk7Cj4+ICAKPj4gIAkJY250bCA9IHBsYW5lX3N0YXRlLT5jdGwgfAo+PiAgCQkJaTl4eF9jdXJz
b3JfY3RsX2NydGMoY3J0Y19zdGF0ZSk7Cj4+IEBAIC0xMTcxNyw3ICsxMTcxNyw3IEBAIHN0YXRp
YyBib29sIGludGVsX3dtX25lZWRfdXBkYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0
ZSAqY3VyLAo+PiAgCQkJCSBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKm5ldykKPj4gIHsKPj4g
IAkvKiBVcGRhdGUgd2F0ZXJtYXJrcyBvbiB0aWxpbmcgb3Igc2l6ZSBjaGFuZ2VzLiAqLwo+PiAt
CWlmIChuZXctPmJhc2UudmlzaWJsZSAhPSBjdXItPmJhc2UudmlzaWJsZSkKPj4gKwlpZiAobmV3
LT51YXBpLnZpc2libGUgIT0gY3VyLT51YXBpLnZpc2libGUpCj4+ICAJCXJldHVybiB0cnVlOwo+
PiAgCj4+ICAJaWYgKCFjdXItPmh3LmZiIHx8ICFuZXctPmh3LmZiKQo+PiBAQCAtMTE3MjUsMTAg
KzExNzI1LDEwIEBAIHN0YXRpYyBib29sIGludGVsX3dtX25lZWRfdXBkYXRlKGNvbnN0IHN0cnVj
dCBpbnRlbF9wbGFuZV9zdGF0ZSAqY3VyLAo+PiAgCj4+ICAJaWYgKGN1ci0+aHcuZmItPm1vZGlm
aWVyICE9IG5ldy0+aHcuZmItPm1vZGlmaWVyIHx8Cj4+ICAJICAgIGN1ci0+aHcucm90YXRpb24g
IT0gbmV3LT5ody5yb3RhdGlvbiB8fAo+PiAtCSAgICBkcm1fcmVjdF93aWR0aCgmbmV3LT5iYXNl
LnNyYykgIT0gZHJtX3JlY3Rfd2lkdGgoJmN1ci0+YmFzZS5zcmMpIHx8Cj4+IC0JICAgIGRybV9y
ZWN0X2hlaWdodCgmbmV3LT5iYXNlLnNyYykgIT0gZHJtX3JlY3RfaGVpZ2h0KCZjdXItPmJhc2Uu
c3JjKSB8fAo+PiAtCSAgICBkcm1fcmVjdF93aWR0aCgmbmV3LT5iYXNlLmRzdCkgIT0gZHJtX3Jl
Y3Rfd2lkdGgoJmN1ci0+YmFzZS5kc3QpIHx8Cj4+IC0JICAgIGRybV9yZWN0X2hlaWdodCgmbmV3
LT5iYXNlLmRzdCkgIT0gZHJtX3JlY3RfaGVpZ2h0KCZjdXItPmJhc2UuZHN0KSkKPj4gKwkgICAg
ZHJtX3JlY3Rfd2lkdGgoJm5ldy0+dWFwaS5zcmMpICE9IGRybV9yZWN0X3dpZHRoKCZjdXItPnVh
cGkuc3JjKSB8fAo+PiArCSAgICBkcm1fcmVjdF9oZWlnaHQoJm5ldy0+dWFwaS5zcmMpICE9IGRy
bV9yZWN0X2hlaWdodCgmY3VyLT51YXBpLnNyYykgfHwKPj4gKwkgICAgZHJtX3JlY3Rfd2lkdGgo
Jm5ldy0+dWFwaS5kc3QpICE9IGRybV9yZWN0X3dpZHRoKCZjdXItPnVhcGkuZHN0KSB8fAo+PiAr
CSAgICBkcm1fcmVjdF9oZWlnaHQoJm5ldy0+dWFwaS5kc3QpICE9IGRybV9yZWN0X2hlaWdodCgm
Y3VyLT51YXBpLmRzdCkpCj4+ICAJCXJldHVybiB0cnVlOwo+PiAgCj4+ICAJcmV0dXJuIGZhbHNl
Owo+PiBAQCAtMTE3MzYsMTAgKzExNzM2LDEwIEBAIHN0YXRpYyBib29sIGludGVsX3dtX25lZWRf
dXBkYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqY3VyLAo+PiAgCj4+ICBzdGF0
aWMgYm9vbCBuZWVkc19zY2FsaW5nKGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqc3Rh
dGUpCj4+ICB7Cj4+IC0JaW50IHNyY193ID0gZHJtX3JlY3Rfd2lkdGgoJnN0YXRlLT5iYXNlLnNy
YykgPj4gMTY7Cj4+IC0JaW50IHNyY19oID0gZHJtX3JlY3RfaGVpZ2h0KCZzdGF0ZS0+YmFzZS5z
cmMpID4+IDE2Owo+PiAtCWludCBkc3RfdyA9IGRybV9yZWN0X3dpZHRoKCZzdGF0ZS0+YmFzZS5k
c3QpOwo+PiAtCWludCBkc3RfaCA9IGRybV9yZWN0X2hlaWdodCgmc3RhdGUtPmJhc2UuZHN0KTsK
Pj4gKwlpbnQgc3JjX3cgPSBkcm1fcmVjdF93aWR0aCgmc3RhdGUtPnVhcGkuc3JjKSA+PiAxNjsK
Pj4gKwlpbnQgc3JjX2ggPSBkcm1fcmVjdF9oZWlnaHQoJnN0YXRlLT51YXBpLnNyYykgPj4gMTY7
Cj4+ICsJaW50IGRzdF93ID0gZHJtX3JlY3Rfd2lkdGgoJnN0YXRlLT51YXBpLmRzdCk7Cj4+ICsJ
aW50IGRzdF9oID0gZHJtX3JlY3RfaGVpZ2h0KCZzdGF0ZS0+dWFwaS5kc3QpOwo+PiAgCj4+ICAJ
cmV0dXJuIChzcmNfdyAhPSBkc3RfdyB8fCBzcmNfaCAhPSBkc3RfaCk7Cj4+ICB9Cj4+IEBAIC0x
MTc1MCw3ICsxMTc1MCw3IEBAIGludCBpbnRlbF9wbGFuZV9hdG9taWNfY2FsY19jaGFuZ2VzKGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0Cj4+ICAJCQkJICAgIHN0
cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxhbmVfc3RhdGUpCj4+ICB7Cj4+ICAJc3RydWN0IGlu
dGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0Yyk7Cj4+
IC0Jc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBsYW5lX3N0YXRl
LT5iYXNlLnBsYW5lKTsKPj4gKwlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0gdG9faW50ZWxf
cGxhbmUocGxhbmVfc3RhdGUtPnVhcGkucGxhbmUpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwo+PiAgCWJvb2wgbW9kZV9j
aGFuZ2VkID0gbmVlZHNfbW9kZXNldChjcnRjX3N0YXRlKTsKPj4gIAlib29sIHdhc19jcnRjX2Vu
YWJsZWQgPSBvbGRfY3J0Y19zdGF0ZS0+aHcuYWN0aXZlOwo+PiBAQCAtMTE3NjQsOCArMTE3NjQs
OCBAQCBpbnQgaW50ZWxfcGxhbmVfYXRvbWljX2NhbGNfY2hhbmdlcyhjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdAo+PiAgCQkJcmV0dXJuIHJldDsKPj4gIAl9Cj4+
ICAKPj4gLQl3YXNfdmlzaWJsZSA9IG9sZF9wbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlOwo+PiAt
CXZpc2libGUgPSBwbGFuZV9zdGF0ZS0+YmFzZS52aXNpYmxlOwo+PiArCXdhc192aXNpYmxlID0g
b2xkX3BsYW5lX3N0YXRlLT51YXBpLnZpc2libGU7Cj4+ICsJdmlzaWJsZSA9IHBsYW5lX3N0YXRl
LT51YXBpLnZpc2libGU7Cj4+ICAKPj4gIAlpZiAoIXdhc19jcnRjX2VuYWJsZWQgJiYgV0FSTl9P
Tih3YXNfdmlzaWJsZSkpCj4+ICAJCXdhc192aXNpYmxlID0gZmFsc2U7Cj4+IEBAIC0xMTc4MSw3
ICsxMTc4MSw3IEBAIGludCBpbnRlbF9wbGFuZV9hdG9taWNfY2FsY19jaGFuZ2VzKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0Cj4+ICAJICogb25seSBjb21iaW5l
IHRoZSByZXN1bHRzIGZyb20gYWxsIHBsYW5lcyBpbiB0aGUgY3VycmVudCBwbGFjZT8KPj4gIAkg
Ki8KPj4gIAlpZiAoIWlzX2NydGNfZW5hYmxlZCkgewo+PiAtCQlwbGFuZV9zdGF0ZS0+YmFzZS52
aXNpYmxlID0gdmlzaWJsZSA9IGZhbHNlOwo+PiArCQlwbGFuZV9zdGF0ZS0+dWFwaS52aXNpYmxl
ID0gdmlzaWJsZSA9IGZhbHNlOwo+PiAgCQljcnRjX3N0YXRlLT5hY3RpdmVfcGxhbmVzICY9IH5C
SVQocGxhbmUtPmlkKTsKPj4gIAkJY3J0Y19zdGF0ZS0+ZGF0YV9yYXRlW3BsYW5lLT5pZF0gPSAw
Owo+PiAgCQljcnRjX3N0YXRlLT5taW5fY2RjbGtbcGxhbmUtPmlkXSA9IDA7Cj4+IEBAIC0xMTk0
MSw3ICsxMTk0MSw3IEBAIHN0YXRpYyBpbnQgaWNsX2NoZWNrX252MTJfcGxhbmVzKHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+PiAgCQkJY29udGludWU7Cj4+ICAKPj4gIAkJ
cGxhbmVfc3RhdGUtPnBsYW5hcl9saW5rZWRfcGxhbmUgPSBOVUxMOwo+PiAtCQlpZiAocGxhbmVf
c3RhdGUtPnBsYW5hcl9zbGF2ZSAmJiAhcGxhbmVfc3RhdGUtPmJhc2UudmlzaWJsZSkgewo+PiAr
CQlpZiAocGxhbmVfc3RhdGUtPnBsYW5hcl9zbGF2ZSAmJiAhcGxhbmVfc3RhdGUtPnVhcGkudmlz
aWJsZSkgewo+PiAgCQkJY3J0Y19zdGF0ZS0+YWN0aXZlX3BsYW5lcyAmPSB+QklUKHBsYW5lLT5p
ZCk7Cj4+ICAJCQljcnRjX3N0YXRlLT51cGRhdGVfcGxhbmVzIHw9IEJJVChwbGFuZS0+aWQpOwo+
PiAgCQl9Cj4+IEBAIC0xMjM1NSwxNCArMTIzNTUsMTQgQEAgc3RhdGljIGNvbnN0IGNoYXIgKm91
dHB1dF9mb3JtYXRzKGVudW0gaW50ZWxfb3V0cHV0X2Zvcm1hdCBmb3JtYXQpCj4+ICAKPj4gIHN0
YXRpYyB2b2lkIGludGVsX2R1bXBfcGxhbmVfc3RhdGUoY29uc3Qgc3RydWN0IGludGVsX3BsYW5l
X3N0YXRlICpwbGFuZV9zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfcGxhbmUgKnBsYW5l
ID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUpOwo+PiArCXN0cnVjdCBp
bnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+dWFwaS5wbGFu
ZSk7Cj4+ICAJY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBwbGFuZV9zdGF0ZS0+
aHcuZmI7Cj4+ICAJc3RydWN0IGRybV9mb3JtYXRfbmFtZV9idWYgZm9ybWF0X25hbWU7Cj4+ICAK
Pj4gIAlpZiAoIWZiKSB7Cj4+ICAJCURSTV9ERUJVR19LTVMoIltQTEFORTolZDolc10gZmI6IFtO
T0ZCXSwgdmlzaWJsZTogJXNcbiIsCj4+ICAJCQkgICAgICBwbGFuZS0+YmFzZS5iYXNlLmlkLCBw
bGFuZS0+YmFzZS5uYW1lLAo+PiAtCQkJICAgICAgeWVzbm8ocGxhbmVfc3RhdGUtPmJhc2Uudmlz
aWJsZSkpOwo+PiArCQkJICAgICAgeWVzbm8ocGxhbmVfc3RhdGUtPnVhcGkudmlzaWJsZSkpOwo+
PiAgCQlyZXR1cm47Cj4+ICAJfQo+PiAgCj4+IEBAIC0xMjM3MCwxMyArMTIzNzAsMTMgQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZHVtcF9wbGFuZV9zdGF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVf
c3RhdGUgKnBsYW5lX3N0YXRlKQo+PiAgCQkgICAgICBwbGFuZS0+YmFzZS5iYXNlLmlkLCBwbGFu
ZS0+YmFzZS5uYW1lLAo+PiAgCQkgICAgICBmYi0+YmFzZS5pZCwgZmItPndpZHRoLCBmYi0+aGVp
Z2h0LAo+PiAgCQkgICAgICBkcm1fZ2V0X2Zvcm1hdF9uYW1lKGZiLT5mb3JtYXQtPmZvcm1hdCwg
JmZvcm1hdF9uYW1lKSwKPj4gLQkJICAgICAgeWVzbm8ocGxhbmVfc3RhdGUtPmJhc2UudmlzaWJs
ZSkpOwo+PiArCQkgICAgICB5ZXNubyhwbGFuZV9zdGF0ZS0+dWFwaS52aXNpYmxlKSk7Cj4+ICAJ
RFJNX0RFQlVHX0tNUygiXHRyb3RhdGlvbjogMHgleCwgc2NhbGVyOiAlZFxuIiwKPj4gIAkJICAg
ICAgcGxhbmVfc3RhdGUtPmh3LnJvdGF0aW9uLCBwbGFuZV9zdGF0ZS0+c2NhbGVyX2lkKTsKPj4g
LQlpZiAocGxhbmVfc3RhdGUtPmJhc2UudmlzaWJsZSkKPj4gKwlpZiAocGxhbmVfc3RhdGUtPnVh
cGkudmlzaWJsZSkKPj4gIAkJRFJNX0RFQlVHX0tNUygiXHRzcmM6ICIgRFJNX1JFQ1RfRlBfRk1U
ICIgZHN0OiAiIERSTV9SRUNUX0ZNVCAiXG4iLAo+PiAtCQkJICAgICAgRFJNX1JFQ1RfRlBfQVJH
KCZwbGFuZV9zdGF0ZS0+YmFzZS5zcmMpLAo+PiAtCQkJICAgICAgRFJNX1JFQ1RfQVJHKCZwbGFu
ZV9zdGF0ZS0+YmFzZS5kc3QpKTsKPj4gKwkJCSAgICAgIERSTV9SRUNUX0ZQX0FSRygmcGxhbmVf
c3RhdGUtPnVhcGkuc3JjKSwKPj4gKwkJCSAgICAgIERSTV9SRUNUX0FSRygmcGxhbmVfc3RhdGUt
PnVhcGkuZHN0KSk7Cj4+ICB9Cj4+ICAKPj4gIHN0YXRpYyB2b2lkIGludGVsX2R1bXBfcGlwZV9j
b25maWcoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAo+PiBAQCAt
MTM1ODIsNyArMTM1ODIsNyBAQCBpbnRlbF92ZXJpZnlfcGxhbmVzKHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlKQo+PiAgCWZvcl9lYWNoX25ld19pbnRlbF9wbGFuZV9pbl9zdGF0ZShz
dGF0ZSwgcGxhbmUsCj4+ICAJCQkJCSAgcGxhbmVfc3RhdGUsIGkpCj4+ICAJCWFzc2VydF9wbGFu
ZShwbGFuZSwgcGxhbmVfc3RhdGUtPnBsYW5hcl9zbGF2ZSB8fAo+PiAtCQkJICAgICBwbGFuZV9z
dGF0ZS0+YmFzZS52aXNpYmxlKTsKPj4gKwkJCSAgICAgcGxhbmVfc3RhdGUtPnVhcGkudmlzaWJs
ZSk7Cj4+ICB9Cj4+ICAKPj4gIHN0YXRpYyB2b2lkCj4+IEBAIC0xNTA0NCw3ICsxNTA0NCw3IEBA
IHN0YXRpYyB2b2lkIGFkZF9ycHNfYm9vc3RfYWZ0ZXJfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YywKPj4gIAo+PiAgc3RhdGljIGludCBpbnRlbF9wbGFuZV9waW5fZmIoc3RydWN0IGludGVs
X3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPj4gIHsKPj4gLQlzdHJ1Y3QgaW50ZWxfcGxhbmUg
KnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2UucGxhbmUpOwo+PiArCXN0
cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9zdGF0ZS0+dWFw
aS5wbGFuZSk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkx
NShwbGFuZS0+YmFzZS5kZXYpOwo+PiAgCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gcGxh
bmVfc3RhdGUtPmh3LmZiOwo+PiAgCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwo+PiBAQCAtMTUxMDks
NyArMTUxMDksNyBAQCBpbnRlbF9wcmVwYXJlX3BsYW5lX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBs
YW5lLAo+PiAgCXN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqbmV3X3BsYW5lX3N0YXRlID0KPj4g
IAkJdG9faW50ZWxfcGxhbmVfc3RhdGUoX25ld19wbGFuZV9zdGF0ZSk7Cj4+ICAJc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqaW50ZWxfc3RhdGUgPQo+PiAtCQl0b19pbnRlbF9hdG9taWNfc3Rh
dGUobmV3X3BsYW5lX3N0YXRlLT5iYXNlLnN0YXRlKTsKPj4gKwkJdG9faW50ZWxfYXRvbWljX3N0
YXRlKG5ld19wbGFuZV9zdGF0ZS0+dWFwaS5zdGF0ZSk7Cj4+ICAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShwbGFuZS0+ZGV2KTsKPj4gIAlzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICpmYiA9IG5ld19wbGFuZV9zdGF0ZS0+aHcuZmI7Cj4+ICAJc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iaiA9IGludGVsX2ZiX29iaihmYik7Cj4+IEBAIC0xNTE0Miw5ICsx
NTE0Miw5IEBAIGludGVsX3ByZXBhcmVfcGxhbmVfZmIoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUs
Cj4+ICAJCX0KPj4gIAl9Cj4+ICAKPj4gLQlpZiAobmV3X3BsYW5lX3N0YXRlLT5iYXNlLmZlbmNl
KSB7IC8qIGV4cGxpY2l0IGZlbmNpbmcgKi8KPj4gKwlpZiAobmV3X3BsYW5lX3N0YXRlLT51YXBp
LmZlbmNlKSB7IC8qIGV4cGxpY2l0IGZlbmNpbmcgKi8KPj4gIAkJcmV0ID0gaTkxNV9zd19mZW5j
ZV9hd2FpdF9kbWFfZmVuY2UoJmludGVsX3N0YXRlLT5jb21taXRfcmVhZHksCj4+IC0JCQkJCQkg
ICAgbmV3X3BsYW5lX3N0YXRlLT5iYXNlLmZlbmNlLAo+PiArCQkJCQkJICAgIG5ld19wbGFuZV9z
dGF0ZS0+dWFwaS5mZW5jZSwKPj4gIAkJCQkJCSAgICBJOTE1X0ZFTkNFX1RJTUVPVVQsCj4+ICAJ
CQkJCQkgICAgR0ZQX0tFUk5FTCk7Cj4+ICAJCWlmIChyZXQgPCAwKQo+PiBAQCAtMTUxNjcsNyAr
MTUxNjcsNyBAQCBpbnRlbF9wcmVwYXJlX3BsYW5lX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5l
LAo+PiAgCWZiX29ial9idW1wX3JlbmRlcl9wcmlvcml0eShvYmopOwo+PiAgCWludGVsX2Zyb250
YnVmZmVyX2ZsdXNoKG9iai0+ZnJvbnRidWZmZXIsIE9SSUdJTl9ESVJUWUZCKTsKPj4gIAo+PiAt
CWlmICghbmV3X3BsYW5lX3N0YXRlLT5iYXNlLmZlbmNlKSB7IC8qIGltcGxpY2l0IGZlbmNpbmcg
Ki8KPj4gKwlpZiAoIW5ld19wbGFuZV9zdGF0ZS0+dWFwaS5mZW5jZSkgeyAvKiBpbXBsaWNpdCBm
ZW5jaW5nICovCj4+ICAJCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwo+PiAgCj4+ICAJCXJldCA9
IGk5MTVfc3dfZmVuY2VfYXdhaXRfcmVzZXJ2YXRpb24oJmludGVsX3N0YXRlLT5jb21taXRfcmVh
ZHksCj4+IEBAIC0xNTE4NSw3ICsxNTE4NSw3IEBAIGludGVsX3ByZXBhcmVfcGxhbmVfZmIoc3Ry
dWN0IGRybV9wbGFuZSAqcGxhbmUsCj4+ICAJCX0KPj4gIAl9IGVsc2Ugewo+PiAgCQlhZGRfcnBz
X2Jvb3N0X2FmdGVyX3ZibGFuayhuZXdfcGxhbmVfc3RhdGUtPmh3LmNydGMsCj4+IC0JCQkJCSAg
IG5ld19wbGFuZV9zdGF0ZS0+YmFzZS5mZW5jZSk7Cj4+ICsJCQkJCSAgIG5ld19wbGFuZV9zdGF0
ZS0+dWFwaS5mZW5jZSk7Cj4+ICAJfQo+PiAgCj4+ICAJLyoKPj4gQEAgLTE1MjE4LDcgKzE1MjE4
LDcgQEAgaW50ZWxfY2xlYW51cF9wbGFuZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwKPj4g
IAlzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKm9sZF9wbGFuZV9zdGF0ZSA9Cj4+ICAJCXRvX2lu
dGVsX3BsYW5lX3N0YXRlKF9vbGRfcGxhbmVfc3RhdGUpOwo+PiAgCXN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKmludGVsX3N0YXRlID0KPj4gLQkJdG9faW50ZWxfYXRvbWljX3N0YXRlKG9sZF9w
bGFuZV9zdGF0ZS0+YmFzZS5zdGF0ZSk7Cj4+ICsJCXRvX2ludGVsX2F0b21pY19zdGF0ZShvbGRf
cGxhbmVfc3RhdGUtPnVhcGkuc3RhdGUpOwo+PiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiA9IHRvX2k5MTUocGxhbmUtPmRldik7Cj4+ICAKPj4gIAlpZiAoaW50ZWxfc3RhdGUt
PnJwc19pbnRlcmFjdGl2ZSkgewo+PiBAQCAtMTUzNTAsOCArMTUzNTAsOCBAQCBpbnRlbF9sZWdh
Y3lfY3Vyc29yX3VwZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpfcGxhbmUsCj4+ICAJICogdGhlIHBs
YW5lLiAgVGhpcyBwcmV2ZW50cyBvdXIgYXN5bmMgdXBkYXRlJ3MgY2hhbmdlcyBmcm9tIGdldHRp
bmcKPj4gIAkgKiBvdmVycmlkZGVuIGJ5IGEgcHJldmlvdXMgc3luY2hyb25vdXMgdXBkYXRlJ3Mg
c3RhdGUuCj4+ICAJICovCj4+IC0JaWYgKG9sZF9wbGFuZV9zdGF0ZS0+YmFzZS5jb21taXQgJiYK
Pj4gLQkgICAgIXRyeV93YWl0X2Zvcl9jb21wbGV0aW9uKCZvbGRfcGxhbmVfc3RhdGUtPmJhc2Uu
Y29tbWl0LT5od19kb25lKSkKPj4gKwlpZiAob2xkX3BsYW5lX3N0YXRlLT51YXBpLmNvbW1pdCAm
Jgo+PiArCSAgICAhdHJ5X3dhaXRfZm9yX2NvbXBsZXRpb24oJm9sZF9wbGFuZV9zdGF0ZS0+dWFw
aS5jb21taXQtPmh3X2RvbmUpKQo+PiAgCQlnb3RvIHNsb3c7Cj4+ICAKPj4gIAkvKgo+PiBAQCAt
MTUzNjAsMTAgKzE1MzYwLDEwIEBAIGludGVsX2xlZ2FjeV9jdXJzb3JfdXBkYXRlKHN0cnVjdCBk
cm1fcGxhbmUgKl9wbGFuZSwKPj4gIAkgKiBpbiB0aGUgZmFzdHBhdGguCj4+ICAJICovCj4+ICAJ
aWYgKG9sZF9wbGFuZV9zdGF0ZS0+dWFwaS5jcnRjICE9ICZjcnRjLT5iYXNlIHx8Cj4+IC0JICAg
IG9sZF9wbGFuZV9zdGF0ZS0+YmFzZS5zcmNfdyAhPSBzcmNfdyB8fAo+PiAtCSAgICBvbGRfcGxh
bmVfc3RhdGUtPmJhc2Uuc3JjX2ggIT0gc3JjX2ggfHwKPj4gLQkgICAgb2xkX3BsYW5lX3N0YXRl
LT5iYXNlLmNydGNfdyAhPSBjcnRjX3cgfHwKPj4gLQkgICAgb2xkX3BsYW5lX3N0YXRlLT5iYXNl
LmNydGNfaCAhPSBjcnRjX2ggfHwKPj4gKwkgICAgb2xkX3BsYW5lX3N0YXRlLT51YXBpLnNyY193
ICE9IHNyY193IHx8Cj4+ICsJICAgIG9sZF9wbGFuZV9zdGF0ZS0+dWFwaS5zcmNfaCAhPSBzcmNf
aCB8fAo+PiArCSAgICBvbGRfcGxhbmVfc3RhdGUtPnVhcGkuY3J0Y193ICE9IGNydGNfdyB8fAo+
PiArCSAgICBvbGRfcGxhbmVfc3RhdGUtPnVhcGkuY3J0Y19oICE9IGNydGNfaCB8fAo+IFRoZXNl
IHNob3VsZCBoYXZlIG1heWJlIGJlZW4gaW4gdGhlIHBhdGNoIHRoYXQgY29udmVydGVkIHRoZQo+
IHVhcGkuZmIgYW5kIHVhcGkuY3J0YyBhbHJlYWR5Lgo+Cj4gTm90IHN1cmUgaG93IHdlJ3JlIGdv
aW5nIHRvIG1ha2UgdGhpcyBzdHVmZiB3b3JrIHdpdGggYmlnam9pbmVyLCBidXQKPiBsZXQncyBj
cm9zcyB0aGF0IGJyaWRnZSB3aGVuIHdlIGNvbWUgdG8gaXQuCj4KPiBSZXN0IG9mIHRoZSBwYXRj
aCBsZ3RtLgpZZWFoLCBjYW4gZm9sZCB0byB0aGUgbWFudWFsIHBhdGNoLgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0
CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

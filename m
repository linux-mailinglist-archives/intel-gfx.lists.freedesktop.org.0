Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A916D110154
	for <lists+intel-gfx@lfdr.de>; Tue,  3 Dec 2019 16:32:07 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E414D8912F;
	Tue,  3 Dec 2019 15:32:05 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A5D068912F
 for <intel-gfx@lists.freedesktop.org>; Tue,  3 Dec 2019 15:32:04 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19444603-1500050 
 for <intel-gfx@lists.freedesktop.org>; Tue, 03 Dec 2019 15:31:59 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue,  3 Dec 2019 15:32:01 +0000
Message-Id: <20191203153201.3136990-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915: Introduce DRM_I915_GEM_MMAP_OFFSET
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQWJkaWVsIEphbnVsZ3VlIDxhYmRpZWwuamFudWxndWVAbGludXguaW50ZWwuY29tPgoK
VGhpcyBpcyByZWFsbHkganVzdCBhbiBhbGlhcyBvZiBtbWFwX2d0dC4gVGhlICdtbWFwIG9mZnNl
dCcgbm9tZW5jbGF0dXJlCmNvbWVzIGZyb20gdGhlIHZhbHVlIHJldHVybmVkIGJ5IHRoaXMgaW9j
dGwgd2hpY2ggaXMgdGhlIG9mZnNldCBpbnRvIHRoZQpkZXZpY2UgZmQgd2hpY2ggdXNlcnBhY2Ug
dXNlcyB3aXRoIG1tYXAoMikuCgptbWFwX2d0dCB3YXMgb3VyIGluaXRpYWwgbW1hcF9vZmZzZXQg
aW1wbGVtZW50YXRpb24sIHRoaXMgZXh0ZW5kcwpvdXIgQ1BVIG1tYXAgc3VwcG9ydCB0byBhbGxv
dyBhZGRpdGlvbmFsIGZhdWx0IGhhbmRsZXJzIHRoYXQgZGVwZW5kcyBvbgp0aGUgb2JqZWN0J3Mg
YmFja2luZyBwYWdlcy4KCk5vdGUgdGhhdCB3ZSBtdWx0aXBsZXggbW1hcF9ndHQgYW5kIG1tYXBf
b2Zmc2V0IHRocm91Z2ggdGhlIHNhbWUgaW9jdGwsCmFuZCB1c2UgdGhlIHplcm8gZXh0ZW5kaW5n
IGJlaGF2aW91ciBvZiBkcm0gdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuCnRoZW0sIHdoZW4gd2Ug
aW5zcGVjdCB0aGUgZmxhZ3MuCgpUbyBzdXBwb3J0IG11bHRpcGxlIG1tYXAgdHlwZXMgb24gYW4g
b2JqZWN0IHdlIG5lZWQgdG8gc3VwcG9ydCBtdWx0aXBsZQptbWFwX29mZnNldHMgZm9yIGFuIG9i
amVjdCAoZWFjaCBvZmZzZXQgaW4gdGhlIGdsb2JhbCBkZXZpY2UgYWRkcmVzcwpzcGFjZSBjb3Jy
ZXNwb25kaW5nIHRvIGEgdW5pcXVlIGluc3RhbmNlIG9mIHRoZSBvYmplY3QgZm9yIGEgZmlsZSAr
IG1tYXAKdHlwZSkuIEFzIHdlIGRyb3AgdGhlIHNpbXBsaWZpZWQgZHJtIGNvcmUgaWRlYSBvZiBh
IHNpbmdsZSBtbWFwX29mZnNldCwKd2UgbmVlZCB0byBwcm92aWRlIHJlcGxhY2VtZW50IGhvb2tz
IGZvciB0aGUgZHVtYiBtbWFwIGludGVyZmFjZSBhcwp3ZWxsLgoKTGluazogaHR0cHM6Ly9naXRs
YWIuZnJlZWRlc2t0b3Aub3JnL21lc2EvbWVzYS9tZXJnZV9yZXF1ZXN0cy8xNjc1ClRlc3RjYXNl
OiBpZ3QvZ2VtX21tYXBfb2Zmc2V0ClNpZ25lZC1vZmYtYnk6IEFiZGllbCBKYW51bGd1ZSA8YWJk
aWVsLmphbnVsZ3VlQGxpbnV4LmludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogTWF0dGhldyBBdWxk
IDxtYXR0aGV3LmF1bGRAaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogQ2hyaXMgV2lsc29uIDxjaHJp
c0BjaHJpcy13aWxzb24uY28udWs+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2RvbWFpbi5jICAgIHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9pb2N0bHMuaCAgICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X21tYW4uYyAgICAgIHwgNDY4ICsrKysrKysrKysrKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX21tYW4uaCAgICAgIHwgIDM0ICsrCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMgICAgfCAgMTggKwogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX29iamVjdC5oICAgIHwgICA3ICstCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3RfdHlwZXMuaCAgfCAgMjIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX3BhZ2VzLmMgICAgIHwgICAzICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV90aWxpbmcuYyAgICB8ICAgMSArCiAuLi4vZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9p
OTE1X2dlbV9tbWFuLmMgICAgfCAgODggKysrLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfcmVzZXQuYyAgICAgICAgIHwgICA3ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Ry
di5jICAgICAgICAgICAgICAgfCAgMTUgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2
LmggICAgICAgICAgICAgICB8ICAgNCAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5j
ICAgICAgICAgICAgICAgfCAgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2V0cGFy
YW0uYyAgICAgICAgICB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jICAg
ICAgICAgICAgICAgfCAgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmggICAg
ICAgICAgICAgICB8ICAgMyArCiBpbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmggICAgICAgICAg
ICAgICAgICAgfCAgMzIgKysKIDE4IGZpbGVzIGNoYW5nZWQsIDU3NCBpbnNlcnRpb25zKCspLCAx
NDAgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX21tYW4uaAoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9kb21haW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9k
b21haW4uYwppbmRleCAzMTE5ZjdiZTliYzAuLmYyMDY0OTUwNjIyYiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4uYwpAQCAtMTMsNiArMTMsNyBAQAogI2luY2x1
ZGUgImk5MTVfZ2VtX29iamVjdC5oIgogI2luY2x1ZGUgImk5MTVfdm1hLmgiCiAjaW5jbHVkZSAi
aTkxNV9nZW1fbG1lbS5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX21tYW4uaCIKIAogc3RhdGljIHZv
aWQgX19pOTE1X2dlbV9vYmplY3RfZmx1c2hfZm9yX2Rpc3BsYXkoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaikKIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9pb2N0bHMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9pb2N0
bHMuaAppbmRleCBkZGM3ZjJhNTJiM2UuLjg3ZDhiMjdmNDI2ZCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2lvY3Rscy5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9pb2N0bHMuaApAQCAtMjgsOCArMjgsOCBAQCBpbnQgaTkxNV9n
ZW1fbWFkdmlzZV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJ
ICAgc3RydWN0IGRybV9maWxlICpmaWxlKTsKIGludCBpOTE1X2dlbV9tbWFwX2lvY3RsKHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJCQlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUp
OwotaW50IGk5MTVfZ2VtX21tYXBfZ3R0X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZv
aWQgKmRhdGEsCi0JCQkgICAgc3RydWN0IGRybV9maWxlICpmaWxlKTsKK2ludCBpOTE1X2dlbV9t
bWFwX29mZnNldF9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAorCQkJ
ICAgICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7CiBpbnQgaTkxNV9nZW1fcHJlYWRfaW9jdGwo
c3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAkJCSBzdHJ1Y3QgZHJtX2ZpbGUg
KmZpbGUpOwogaW50IGk5MTVfZ2VtX3B3cml0ZV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCB2b2lkICpkYXRhLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX21tYW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMKaW5k
ZXggZDYwOTczNjAzY2MxLi5jZGFlNDYwOGQxNTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX21tYW4uYwpAQCAtNSw2ICs1LDcgQEAKICAqLwogCiAjaW5jbHVkZSA8bGludXgv
bW1hbi5oPgorI2luY2x1ZGUgPGxpbnV4L3Bmbl90Lmg+CiAjaW5jbHVkZSA8bGludXgvc2l6ZXMu
aD4KIAogI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCkBAIC0xNCw2ICsxNSw3IEBACiAjaW5jbHVk
ZSAiaTkxNV9nZW1fZ3R0LmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1faW9jdGxzLmgiCiAjaW5jbHVk
ZSAiaTkxNV9nZW1fb2JqZWN0LmgiCisjaW5jbHVkZSAiaTkxNV9nZW1fbW1hbi5oIgogI2luY2x1
ZGUgImk5MTVfdHJhY2UuaCIKICNpbmNsdWRlICJpOTE1X3ZtYS5oIgogCkBAIC0xNDQsNiArMTQ2
LDkgQEAgc3RhdGljIHVuc2lnbmVkIGludCB0aWxlX3Jvd19wYWdlcyhjb25zdCBzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqKQogICogMyAtIFJlbW92ZSBpbXBsaWNpdCBzZXQtZG9tYWlu
KEdUVCkgYW5kIHN5bmNocm9uaXNhdGlvbiBvbiBpbml0aWFsCiAgKiAgICAgcGFnZWZhdWx0OyBz
d2FwaW4gcmVtYWlucyB0cmFuc3BhcmVudC4KICAqCisgKiA0IC0gU3VwcG9ydCBtdWx0aXBsZSBm
YXVsdCBoYW5kbGVycyBwZXIgb2JqZWN0IGRlcGVuZGluZyBvbiBvYmplY3QncworICogICAgIGJh
Y2tpbmcgc3RvcmFnZSAoYS5rLmEuIE1NQVBfT0ZGU0VUKS4KKyAqCiAgKiBSZXN0cmljdGlvbnM6
CiAgKgogICogICogc25vb3BhYmxlIG9iamVjdHMgY2Fubm90IGJlIGFjY2Vzc2VkIHZpYSB0aGUg
R1RULiBJdCBjYW4gY2F1c2UgbWFjaGluZQpAQCAtMTcxLDcgKzE3Niw3IEBAIHN0YXRpYyB1bnNp
Z25lZCBpbnQgdGlsZV9yb3dfcGFnZXMoY29uc3Qgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaikKICAqLwogaW50IGk5MTVfZ2VtX21tYXBfZ3R0X3ZlcnNpb24odm9pZCkKIHsKLQlyZXR1
cm4gMzsKKwlyZXR1cm4gNDsKIH0KIAogc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9nZ3R0X3Zp
ZXcKQEAgLTE5NywyOSArMjAyLDgzIEBAIGNvbXB1dGVfcGFydGlhbF92aWV3KGNvbnN0IHN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJcmV0dXJuIHZpZXc7CiB9CiAKLS8qKgotICog
aTkxNV9nZW1fZmF1bHQgLSBmYXVsdCBhIHBhZ2UgaW50byB0aGUgR1RUCi0gKiBAdm1mOiBmYXVs
dCBpbmZvCi0gKgotICogVGhlIGZhdWx0IGhhbmRsZXIgaXMgc2V0IHVwIGJ5IGRybV9nZW1fbW1h
cCgpIHdoZW4gYSBvYmplY3QgaXMgR1RUIG1hcHBlZAotICogZnJvbSB1c2Vyc3BhY2UuICBUaGUg
ZmF1bHQgaGFuZGxlciB0YWtlcyBjYXJlIG9mIGJpbmRpbmcgdGhlIG9iamVjdCB0bwotICogdGhl
IEdUVCAoaWYgbmVlZGVkKSwgYWxsb2NhdGluZyBhbmQgcHJvZ3JhbW1pbmcgYSBmZW5jZSByZWdp
c3RlciAoYWdhaW4sCi0gKiBvbmx5IGlmIG5lZWRlZCBiYXNlZCBvbiB3aGV0aGVyIHRoZSBvbGQg
cmVnIGlzIHN0aWxsIHZhbGlkIG9yIHRoZSBvYmplY3QKLSAqIGlzIHRpbGVkKSBhbmQgaW5zZXJ0
aW5nIGEgbmV3IFBURSBpbnRvIHRoZSBmYXVsdGluZyBwcm9jZXNzLgotICoKLSAqIE5vdGUgdGhh
dCB0aGUgZmF1bHRpbmcgcHJvY2VzcyBtYXkgaW52b2x2ZSBldmljdGluZyBleGlzdGluZyBvYmpl
Y3RzCi0gKiBmcm9tIHRoZSBHVFQgYW5kL29yIGZlbmNlIHJlZ2lzdGVycyB0byBtYWtlIHJvb20u
ICBTbyBwZXJmb3JtYW5jZSBtYXkKLSAqIHN1ZmZlciBpZiB0aGUgR1RUIHdvcmtpbmcgc2V0IGlz
IGxhcmdlIG9yIHRoZXJlIGFyZSBmZXcgZmVuY2UgcmVnaXN0ZXJzCi0gKiBsZWZ0LgotICoKLSAq
IFRoZSBjdXJyZW50IGZlYXR1cmUgc2V0IHN1cHBvcnRlZCBieSBpOTE1X2dlbV9mYXVsdCgpIGFu
ZCB0aHVzIEdUVCBtbWFwcwotICogaXMgZXhwb3NlZCB2aWEgSTkxNV9QQVJBTV9NTUFQX0dUVF9W
RVJTSU9OIChzZWUgaTkxNV9nZW1fbW1hcF9ndHRfdmVyc2lvbikuCi0gKi8KLXZtX2ZhdWx0X3Qg
aTkxNV9nZW1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCitzdGF0aWMgdm1fZmF1bHRfdCBp
OTE1X2Vycm9yX3RvX3ZtZl9mYXVsdChpbnQgZXJyKQoreworCXN3aXRjaCAoZXJyKSB7CisJZGVm
YXVsdDoKKwkJV0FSTl9PTkNFKGVyciwgInVuaGFuZGxlZCBlcnJvciBpbiAlczogJWlcbiIsIF9f
ZnVuY19fLCBlcnIpOworCQkvKiBmYWxsdGhyb3VnaCAqLworCWNhc2UgLUVJTzogLyogc2htZW1m
cyBmYWlsdXJlIGZyb20gc3dhcCBkZXZpY2UgKi8KKwljYXNlIC1FRkFVTFQ6IC8qIHB1cmdlZCBv
YmplY3QgKi8KKwljYXNlIC1FTk9ERVY6IC8qIGJhZCBvYmplY3QsIGhvdyBkaWQgeW91IGdldCBo
ZXJlISAqLworCQlyZXR1cm4gVk1fRkFVTFRfU0lHQlVTOworCisJY2FzZSAtRU5PU1BDOiAvKiBz
aG1lbWZzIGFsbG9jYXRpb24gZmFpbHVyZSAqLworCWNhc2UgLUVOT01FTTogLyogb3VyIGFsbG9j
YXRpb24gZmFpbHVyZSAqLworCQlyZXR1cm4gVk1fRkFVTFRfT09NOworCisJY2FzZSAwOgorCWNh
c2UgLUVBR0FJTjoKKwljYXNlIC1FUkVTVEFSVFNZUzoKKwljYXNlIC1FSU5UUjoKKwljYXNlIC1F
QlVTWToKKwkJLyoKKwkJICogRUJVU1kgaXMgb2s6IHRoaXMganVzdCBtZWFucyB0aGF0IGFub3Ro
ZXIgdGhyZWFkCisJCSAqIGFscmVhZHkgZGlkIHRoZSBqb2IuCisJCSAqLworCQlyZXR1cm4gVk1f
RkFVTFRfTk9QQUdFOworCX0KK30KKworc3RhdGljIHZtX2ZhdWx0X3Qgdm1fZmF1bHRfY3B1KHN0
cnVjdCB2bV9mYXVsdCAqdm1mKQoreworCXN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqYXJlYSA9IHZt
Zi0+dm1hOworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICpwcml2ID0gYXJlYS0+dm1fcHJpdmF0
ZV9kYXRhOworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBwcml2LT5vYmo7CisJ
dW5zaWduZWQgbG9uZyBpLCBzaXplID0gYXJlYS0+dm1fZW5kIC0gYXJlYS0+dm1fc3RhcnQ7CisJ
Ym9vbCB3cml0ZSA9IGFyZWEtPnZtX2ZsYWdzICYgVk1fV1JJVEU7CisJdm1fZmF1bHRfdCByZXQg
PSBWTV9GQVVMVF9TSUdCVVM7CisJaW50IGVycjsKKworCWlmICghaTkxNV9nZW1fb2JqZWN0X2hh
c19zdHJ1Y3RfcGFnZShvYmopKQorCQlyZXR1cm4gcmV0OworCisJLyogU2FuaXR5IGNoZWNrIHRo
YXQgd2UgYWxsb3cgd3JpdGluZyBpbnRvIHRoaXMgb2JqZWN0ICovCisJaWYgKGk5MTVfZ2VtX29i
amVjdF9pc19yZWFkb25seShvYmopICYmIHdyaXRlKQorCQlyZXR1cm4gcmV0OworCisJZXJyID0g
aTkxNV9nZW1fb2JqZWN0X3Bpbl9wYWdlcyhvYmopOworCWlmIChlcnIpCisJCXJldHVybiBpOTE1
X2Vycm9yX3RvX3ZtZl9mYXVsdChlcnIpOworCisJLyogUFRFcyBhcmUgcmV2b2tlZCBpbiBvYmot
Pm9wcy0+cHV0X3BhZ2VzKCkgKi8KKwlmb3IgKGkgPSAwOyBpIDwgc2l6ZSA+PiBQQUdFX1NISUZU
OyBpKyspIHsKKwkJc3RydWN0IHBhZ2UgKnBhZ2UgPSBpOTE1X2dlbV9vYmplY3RfZ2V0X3BhZ2Uo
b2JqLCBpKTsKKworCQlyZXQgPSB2bWZfaW5zZXJ0X3BmbihhcmVhLAorCQkJCSAgICAgKHVuc2ln
bmVkIGxvbmcpYXJlYS0+dm1fc3RhcnQgKyBpICogUEFHRV9TSVpFLAorCQkJCSAgICAgcGFnZV90
b19wZm4ocGFnZSkpOworCQlpZiAocmV0ICE9IFZNX0ZBVUxUX05PUEFHRSkKKwkJCWJyZWFrOwor
CX0KKworCWlmICh3cml0ZSkgeworCQlHRU1fQlVHX09OKCFpOTE1X2dlbV9vYmplY3RfaGFzX3Bp
bm5lZF9wYWdlcyhvYmopKTsKKwkJb2JqLT5jYWNoZV9kaXJ0eSA9IHRydWU7IC8qIFhYWCBmbHVz
aCBhZnRlciBQQVQgdXBkYXRlPyAqLworCQlvYmotPm1tLmRpcnR5ID0gdHJ1ZTsKKwl9CisKKwlp
OTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMob2JqKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0
YXRpYyB2bV9mYXVsdF90IHZtX2ZhdWx0X2d0dChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKIHsKICNk
ZWZpbmUgTUlOX0NIVU5LX1BBR0VTIChTWl8xTSA+PiBQQUdFX1NISUZUKQogCXN0cnVjdCB2bV9h
cmVhX3N0cnVjdCAqYXJlYSA9IHZtZi0+dm1hOwotCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmogPSB0b19pbnRlbF9ibyhhcmVhLT52bV9wcml2YXRlX2RhdGEpOworCXN0cnVjdCBpOTE1
X21tYXBfb2Zmc2V0ICpwcml2ID0gYXJlYS0+dm1fcHJpdmF0ZV9kYXRhOworCXN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmogPSBwcml2LT5vYmo7CiAJc3RydWN0IGRybV9kZXZpY2UgKmRl
diA9IG9iai0+YmFzZS5kZXY7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KGRldik7CiAJc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSA9ICZpOTE1LT5ydW50aW1l
X3BtOwpAQCAtMzEyLDYgKzM3MSw5IEBAIHZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0
IHZtX2ZhdWx0ICp2bWYpCiAJCWxpc3RfYWRkKCZvYmotPnVzZXJmYXVsdF9saW5rLCAmaTkxNS0+
Z2d0dC51c2VyZmF1bHRfbGlzdCk7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5nZ3R0LnZtLm11dGV4
KTsKIAorCS8qIFRyYWNrIHRoZSBtbW8gYXNzb2NpYXRlZCB3aXRoIHRoZSBmZW5jZWQgdm1hICov
CisJdm1hLT5tbW8gPSBwcml2OworCiAJaWYgKElTX0FDVElWRShDT05GSUdfRFJNX0k5MTVfVVNF
UkZBVUxUX0FVVE9TVVNQRU5EKSkKIAkJaW50ZWxfd2FrZXJlZl9hdXRvKCZpOTE1LT5nZ3R0LnVz
ZXJmYXVsdF93YWtlcmVmLAogCQkJCSAgIG1zZWNzX3RvX2ppZmZpZXNfdGltZW91dChDT05GSUdf
RFJNX0k5MTVfVVNFUkZBVUxUX0FVVE9TVVNQRU5EKSk7CkBAIC0zMzIsNjcgKzM5NCwzNiBAQCB2
bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQogCWludGVsX3J1
bnRpbWVfcG1fcHV0KHJwbSwgd2FrZXJlZik7CiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX3BhZ2Vz
KG9iaik7CiBlcnI6Ci0Jc3dpdGNoIChyZXQpIHsKLQlkZWZhdWx0OgotCQlXQVJOX09OQ0UocmV0
LCAidW5oYW5kbGVkIGVycm9yIGluICVzOiAlaVxuIiwgX19mdW5jX18sIHJldCk7Ci0JCS8qIGZh
bGx0aHJvdWdoICovCi0JY2FzZSAtRUlPOiAvKiBzaG1lbWZzIGZhaWx1cmUgZnJvbSBzd2FwIGRl
dmljZSAqLwotCWNhc2UgLUVGQVVMVDogLyogcHVyZ2VkIG9iamVjdCAqLwotCWNhc2UgLUVOT0RF
VjogLyogYmFkIG9iamVjdCwgaG93IGRpZCB5b3UgZ2V0IGhlcmUhICovCi0JCXJldHVybiBWTV9G
QVVMVF9TSUdCVVM7Ci0KLQljYXNlIC1FTk9TUEM6IC8qIHNobWVtZnMgYWxsb2NhdGlvbiBmYWls
dXJlICovCi0JY2FzZSAtRU5PTUVNOiAvKiBvdXIgYWxsb2NhdGlvbiBmYWlsdXJlICovCi0JCXJl
dHVybiBWTV9GQVVMVF9PT007Ci0KLQljYXNlIDA6Ci0JY2FzZSAtRUFHQUlOOgotCWNhc2UgLUVS
RVNUQVJUU1lTOgotCWNhc2UgLUVJTlRSOgotCWNhc2UgLUVCVVNZOgotCQkvKgotCQkgKiBFQlVT
WSBpcyBvazogdGhpcyBqdXN0IG1lYW5zIHRoYXQgYW5vdGhlciB0aHJlYWQKLQkJICogYWxyZWFk
eSBkaWQgdGhlIGpvYi4KLQkJICovCi0JCXJldHVybiBWTV9GQVVMVF9OT1BBR0U7Ci0JfQorCXJl
dHVybiBpOTE1X2Vycm9yX3RvX3ZtZl9mYXVsdChyZXQpOwogfQogCi12b2lkIF9faTkxNV9nZW1f
b2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQordm9p
ZCBfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfZ3R0KHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmopCiB7CiAJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAKIAlHRU1fQlVHX09OKCFv
YmotPnVzZXJmYXVsdF9jb3VudCk7CiAKLQlvYmotPnVzZXJmYXVsdF9jb3VudCA9IDA7Ci0JbGlz
dF9kZWwoJm9iai0+dXNlcmZhdWx0X2xpbmspOwotCWRybV92bWFfbm9kZV91bm1hcCgmb2JqLT5i
YXNlLnZtYV9ub2RlLAotCQkJICAgb2JqLT5iYXNlLmRldi0+YW5vbl9pbm9kZS0+aV9tYXBwaW5n
KTsKLQogCWZvcl9lYWNoX2dndHRfdm1hKHZtYSwgb2JqKQotCQlpOTE1X3ZtYV91bnNldF91c2Vy
ZmF1bHQodm1hKTsKKwkJaTkxNV92bWFfcmV2b2tlX21tYXAodm1hKTsKKworCUdFTV9CVUdfT04o
b2JqLT51c2VyZmF1bHRfY291bnQpOwogfQogCi0vKioKLSAqIGk5MTVfZ2VtX29iamVjdF9yZWxl
YXNlX21tYXAgLSByZW1vdmUgcGh5c2ljYWwgcGFnZSBtYXBwaW5ncwotICogQG9iajogb2JqIGlu
IHF1ZXN0aW9uCi0gKgotICogUHJlc2VydmUgdGhlIHJlc2VydmF0aW9uIG9mIHRoZSBtbWFwcGlu
ZyB3aXRoIHRoZSBEUk0gY29yZSBjb2RlLCBidXQKLSAqIHJlbGlucXVpc2ggb3duZXJzaGlwIG9m
IHRoZSBwYWdlcyBiYWNrIHRvIHRoZSBzeXN0ZW0uCi0gKgorLyoKICAqIEl0IGlzIHZpdGFsIHRo
YXQgd2UgcmVtb3ZlIHRoZSBwYWdlIG1hcHBpbmcgaWYgd2UgaGF2ZSBtYXBwZWQgYSB0aWxlZAog
ICogb2JqZWN0IHRocm91Z2ggdGhlIEdUVCBhbmQgdGhlbiBsb3NlIHRoZSBmZW5jZSByZWdpc3Rl
ciBkdWUgdG8KICAqIHJlc291cmNlIHByZXNzdXJlLiBTaW1pbGFybHkgaWYgdGhlIG9iamVjdCBo
YXMgYmVlbiBtb3ZlZCBvdXQgb2YgdGhlCiAgKiBhcGVydHVyZSwgdGhhbiBwYWdlcyBtYXBwZWQg
aW50byB1c2Vyc3BhY2UgbXVzdCBiZSByZXZva2VkLiBSZW1vdmluZyB0aGUKICAqIG1hcHBpbmcg
d2lsbCB0aGVuIHRyaWdnZXIgYSBwYWdlIGZhdWx0IG9uIHRoZSBuZXh0IHVzZXIgYWNjZXNzLCBh
bGxvd2luZwotICogZml4dXAgYnkgaTkxNV9nZW1fZmF1bHQoKS4KKyAqIGZpeHVwIGJ5IHZtX2Zh
dWx0X2d0dCgpLgogICovCi12b2lkIGk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAoc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKK3N0YXRpYyB2b2lkIGk5MTVfZ2VtX29iamVjdF9y
ZWxlYXNlX21tYXBfZ3R0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiB7CiAJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwogCWlu
dGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCi0JLyogU2VyaWFsaXNhdGlvbiBiZXR3ZWVuIHVzZXIg
R1RUIGFjY2VzcyBhbmQgb3VyIGNvZGUgZGVwZW5kcyB1cG9uCisJLyoKKwkgKiBTZXJpYWxpc2F0
aW9uIGJldHdlZW4gdXNlciBHVFQgYWNjZXNzIGFuZCBvdXIgY29kZSBkZXBlbmRzIHVwb24KIAkg
KiByZXZva2luZyB0aGUgQ1BVJ3MgUFRFIHdoaWxzdCB0aGUgbXV0ZXggaXMgaGVsZC4gVGhlIG5l
eHQgdXNlcgogCSAqIHBhZ2VmYXVsdCB0aGVuIGhhcyB0byB3YWl0IHVudGlsIHdlIHJlbGVhc2Ug
dGhlIG11dGV4LgogCSAqCkBAIC00MDYsOSArNDM3LDEwIEBAIHZvaWQgaTkxNV9nZW1fb2JqZWN0
X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCWlmICghb2Jq
LT51c2VyZmF1bHRfY291bnQpCiAJCWdvdG8gb3V0OwogCi0JX19pOTE1X2dlbV9vYmplY3RfcmVs
ZWFzZV9tbWFwKG9iaik7CisJX19pOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwX2d0dChvYmop
OwogCi0JLyogRW5zdXJlIHRoYXQgdGhlIENQVSdzIFBURSBhcmUgcmV2b2tlZCBhbmQgdGhlcmUg
YXJlIG5vdCBvdXRzdGFuZGluZworCS8qCisJICogRW5zdXJlIHRoYXQgdGhlIENQVSdzIFBURSBh
cmUgcmV2b2tlZCBhbmQgdGhlcmUgYXJlIG5vdCBvdXRzdGFuZGluZwogCSAqIG1lbW9yeSB0cmFu
c2FjdGlvbnMgZnJvbSB1c2Vyc3BhY2UgYmVmb3JlIHdlIHJldHVybi4gVGhlIFRMQgogCSAqIGZs
dXNoaW5nIGltcGxpZWQgYWJvdmUgYnkgY2hhbmdpbmcgdGhlIFBURSBhYm92ZSAqc2hvdWxkKiBi
ZQogCSAqIHN1ZmZpY2llbnQsIGFuIGV4dHJhIGJhcnJpZXIgaGVyZSBqdXN0IHByb3ZpZGVzIHVz
IHdpdGggYSBiaXQKQEAgLTQyMiw1NyArNDU0LDE0NSBAQCB2b2lkIGk5MTVfZ2VtX29iamVjdF9y
ZWxlYXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAlpbnRlbF9ydW50
aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiB9CiAKLXN0YXRpYyBpbnQg
Y3JlYXRlX21tYXBfb2Zmc2V0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCit2b2lk
IGk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfb2Zmc2V0KHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmopCit7CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbzsKKworCW11dGV4
X2xvY2soJm9iai0+bW1vX2xvY2spOworCWxpc3RfZm9yX2VhY2hfZW50cnkobW1vLCAmb2JqLT5t
bWFwX29mZnNldHMsIG9mZnNldCkgeworCQkvKgorCQkgKiB2bWFfbm9kZV91bm1hcCBmb3IgR1RU
IG1tYXBzIGhhbmRsZWQgYWxyZWFkeSBpbgorCQkgKiBfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNl
X21tYXBfZ3R0CisJCSAqLworCQlpZiAobW1vLT5tbWFwX3R5cGUgIT0gSTkxNV9NTUFQX1RZUEVf
R1RUKQorCQkJZHJtX3ZtYV9ub2RlX3VubWFwKCZtbW8tPnZtYV9ub2RlLAorCQkJCQkgICBvYmot
PmJhc2UuZGV2LT5hbm9uX2lub2RlLT5pX21hcHBpbmcpOworCX0KKwltdXRleF91bmxvY2soJm9i
ai0+bW1vX2xvY2spOworfQorCisvKioKKyAqIGk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAg
LSByZW1vdmUgcGh5c2ljYWwgcGFnZSBtYXBwaW5ncworICogQG9iajogb2JqIGluIHF1ZXN0aW9u
CisgKgorICogUHJlc2VydmUgdGhlIHJlc2VydmF0aW9uIG9mIHRoZSBtbWFwcGluZyB3aXRoIHRo
ZSBEUk0gY29yZSBjb2RlLCBidXQKKyAqIHJlbGlucXVpc2ggb3duZXJzaGlwIG9mIHRoZSBwYWdl
cyBiYWNrIHRvIHRoZSBzeXN0ZW0uCisgKi8KK3ZvaWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2Vf
bW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQoreworCWk5MTVfZ2VtX29iamVj
dF9yZWxlYXNlX21tYXBfZ3R0KG9iaik7CisJaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9v
ZmZzZXQob2JqKTsKK30KKworc3RhdGljIHN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICoKK21tYXBf
b2Zmc2V0X2F0dGFjaChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAorCQkgICBlbnVt
IGk5MTVfbW1hcF90eXBlIG1tYXBfdHlwZSwKKwkJICAgc3RydWN0IGRybV9maWxlICpmaWxlKQog
ewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2
KTsKLQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gJmk5MTUtPmd0OworCXN0cnVjdCBpOTE1X21tYXBf
b2Zmc2V0ICptbW87CiAJaW50IGVycjsKIAotCWVyciA9IGRybV9nZW1fY3JlYXRlX21tYXBfb2Zm
c2V0KCZvYmotPmJhc2UpOworCW1tbyA9IGttYWxsb2Moc2l6ZW9mKCptbW8pLCBHRlBfS0VSTkVM
KTsKKwlpZiAoIW1tbykKKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisKKwltbW8tPm9iaiA9
IG9iajsKKwltbW8tPmRldiA9IG9iai0+YmFzZS5kZXY7CisJbW1vLT5maWxlID0gZmlsZTsKKwlt
bW8tPm1tYXBfdHlwZSA9IG1tYXBfdHlwZTsKKwlkcm1fdm1hX25vZGVfcmVzZXQoJm1tby0+dm1h
X25vZGUpOworCisJZXJyID0gZHJtX3ZtYV9vZmZzZXRfYWRkKG1tby0+ZGV2LT52bWFfb2Zmc2V0
X21hbmFnZXIsICZtbW8tPnZtYV9ub2RlLAorCQkJCSBvYmotPmJhc2Uuc2l6ZSAvIFBBR0VfU0la
RSk7CiAJaWYgKGxpa2VseSghZXJyKSkKLQkJcmV0dXJuIDA7CisJCWdvdG8gb3V0OwogCiAJLyog
QXR0ZW1wdCB0byByZWFwIHNvbWUgbW1hcCBzcGFjZSBmcm9tIGRlYWQgb2JqZWN0cyAqLwotCWVy
ciA9IGludGVsX2d0X3JldGlyZV9yZXF1ZXN0c190aW1lb3V0KGd0LCBNQVhfU0NIRURVTEVfVElN
RU9VVCk7CisJZXJyID0gaW50ZWxfZ3RfcmV0aXJlX3JlcXVlc3RzX3RpbWVvdXQoJmk5MTUtPmd0
LCBNQVhfU0NIRURVTEVfVElNRU9VVCk7CiAJaWYgKGVycikKLQkJcmV0dXJuIGVycjsKKwkJZ290
byBlcnI7CiAKIAlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGk5MTUpOwotCXJldHVybiBk
cm1fZ2VtX2NyZWF0ZV9tbWFwX29mZnNldCgmb2JqLT5iYXNlKTsKKwllcnIgPSBkcm1fdm1hX29m
ZnNldF9hZGQobW1vLT5kZXYtPnZtYV9vZmZzZXRfbWFuYWdlciwgJm1tby0+dm1hX25vZGUsCisJ
CQkJIG9iai0+YmFzZS5zaXplIC8gUEFHRV9TSVpFKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycjsK
Kworb3V0OgorCW11dGV4X2xvY2soJm9iai0+bW1vX2xvY2spOworCWxpc3RfYWRkKCZtbW8tPm9m
ZnNldCwgJm9iai0+bW1hcF9vZmZzZXRzKTsKKwltdXRleF91bmxvY2soJm9iai0+bW1vX2xvY2sp
OworCisJaWYgKGZpbGUpCisJCWRybV92bWFfbm9kZV9hbGxvdygmbW1vLT52bWFfbm9kZSwgZmls
ZSk7CisKKwlyZXR1cm4gbW1vOworCitlcnI6CisJa2ZyZWUobW1vKTsKKwlyZXR1cm4gRVJSX1BU
UihlcnIpOwogfQogCi1pbnQKLWk5MTVfZ2VtX21tYXBfZ3R0KHN0cnVjdCBkcm1fZmlsZSAqZmls
ZSwKLQkJICBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAotCQkgIHUzMiBoYW5kbGUsCi0JCSAgdTY0
ICpvZmZzZXQpCitzdGF0aWMgaW50CitfX2Fzc2lnbl9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2Zp
bGUgKmZpbGUsCisJCSAgICAgdTMyIGhhbmRsZSwKKwkJICAgICBlbnVtIGk5MTVfbW1hcF90eXBl
IG1tYXBfdHlwZSwKKwkJICAgICB1NjQgKm9mZnNldCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqOwotCWludCByZXQ7Ci0KLQlpZiAoIWk5MTVfZ2d0dF9oYXNfYXBlcnR1cmUo
JnRvX2k5MTUoZGV2KS0+Z2d0dCkpCi0JCXJldHVybiAtRU5PREVWOworCXN0cnVjdCBpOTE1X21t
YXBfb2Zmc2V0ICptbW87CisJaW50IGVycjsKIAogCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9sb29r
dXAoZmlsZSwgaGFuZGxlKTsKIAlpZiAoIW9iaikKIAkJcmV0dXJuIC1FTk9FTlQ7CiAKLQlpZiAo
aTkxNV9nZW1fb2JqZWN0X25ldmVyX2JpbmRfZ2d0dChvYmopKSB7Ci0JCXJldCA9IC1FTk9ERVY7
CisJaWYgKG1tYXBfdHlwZSA9PSBJOTE1X01NQVBfVFlQRV9HVFQgJiYKKwkgICAgaTkxNV9nZW1f
b2JqZWN0X25ldmVyX2JpbmRfZ2d0dChvYmopKSB7CisJCWVyciA9IC1FTk9ERVY7CisJCWdvdG8g
b3V0OworCX0KKworCWlmIChtbWFwX3R5cGUgIT0gSTkxNV9NTUFQX1RZUEVfR1RUICYmCisJICAg
ICFpOTE1X2dlbV9vYmplY3RfaGFzX3N0cnVjdF9wYWdlKG9iaikpIHsKKwkJZXJyID0gLUVOT0RF
VjsKIAkJZ290byBvdXQ7CiAJfQogCi0JcmV0ID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9iaik7Ci0J
aWYgKHJldCA9PSAwKQotCQkqb2Zmc2V0ID0gZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKCZvYmot
PmJhc2Uudm1hX25vZGUpOworCW1tbyA9IG1tYXBfb2Zmc2V0X2F0dGFjaChvYmosIG1tYXBfdHlw
ZSwgZmlsZSk7CisJaWYgKElTX0VSUihtbW8pKSB7CisJCWVyciA9IFBUUl9FUlIobW1vKTsKKwkJ
Z290byBvdXQ7CisJfQogCisJKm9mZnNldCA9IGRybV92bWFfbm9kZV9vZmZzZXRfYWRkcigmbW1v
LT52bWFfbm9kZSk7CisJZXJyID0gMDsKIG91dDoKIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7
Ci0JcmV0dXJuIHJldDsKKwlyZXR1cm4gZXJyOworfQorCitpbnQKK2k5MTVfZ2VtX2R1bWJfbW1h
cF9vZmZzZXQoc3RydWN0IGRybV9maWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LAorCQkJICB1MzIgaGFuZGxlLAorCQkJICB1NjQgKm9mZnNldCkKK3sKKwllbnVtIGk5MTVf
bW1hcF90eXBlIG1tYXBfdHlwZTsKKworCWlmIChib290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfUEFU
KSkKKwkJbW1hcF90eXBlID0gSTkxNV9NTUFQX1RZUEVfV0M7CisJZWxzZSBpZiAoIWk5MTVfZ2d0
dF9oYXNfYXBlcnR1cmUoJnRvX2k5MTUoZGV2KS0+Z2d0dCkpCisJCXJldHVybiAtRU5PREVWOwor
CWVsc2UKKwkJbW1hcF90eXBlID0gSTkxNV9NTUFQX1RZUEVfR1RUOworCisJcmV0dXJuIF9fYXNz
aWduX21tYXBfb2Zmc2V0KGZpbGUsIGhhbmRsZSwgbW1hcF90eXBlLCBvZmZzZXQpOwogfQogCiAv
KioKLSAqIGk5MTVfZ2VtX21tYXBfZ3R0X2lvY3RsIC0gcHJlcGFyZSBhbiBvYmplY3QgZm9yIEdU
VCBtbWFwJ2luZworICogaTkxNV9nZW1fbW1hcF9vZmZzZXRfaW9jdGwgLSBwcmVwYXJlIGFuIG9i
amVjdCBmb3IgR1RUIG1tYXAnaW5nCiAgKiBAZGV2OiBEUk0gZGV2aWNlCiAgKiBAZGF0YTogR1RU
IG1hcHBpbmcgaW9jdGwgZGF0YQogICogQGZpbGU6IEdFTSBvYmplY3QgaW5mbwpAQCAtNDg3LDEy
ICs2MDcsMTc4IEBAIGk5MTVfZ2VtX21tYXBfZ3R0KHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwKICAq
IHVzZXJzcGFjZS4KICAqLwogaW50Ci1pOTE1X2dlbV9tbWFwX2d0dF9pb2N0bChzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAotCQkJc3RydWN0IGRybV9maWxlICpmaWxlKQoraTkx
NV9nZW1fbW1hcF9vZmZzZXRfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0
YSwKKwkJCSAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X21tYXBfZ3R0ICphcmdzID0gZGF0YTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUoZGV2KTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX21tYXBfb2Zmc2V0ICphcmdzID0g
ZGF0YTsKKwllbnVtIGk5MTVfbW1hcF90eXBlIHR5cGU7CisKKwlpZiAoYXJncy0+ZXh0ZW5zaW9u
cykKKwkJcmV0dXJuIC1FSU5WQUw7CiAKLQlyZXR1cm4gaTkxNV9nZW1fbW1hcF9ndHQoZmlsZSwg
ZGV2LCBhcmdzLT5oYW5kbGUsICZhcmdzLT5vZmZzZXQpOworCXN3aXRjaCAoYXJncy0+ZmxhZ3Mp
IHsKKwljYXNlIEk5MTVfTU1BUF9PRkZTRVRfR1RUOgorCQlpZiAoIWk5MTVfZ2d0dF9oYXNfYXBl
cnR1cmUoJmk5MTUtPmdndHQpKQorCQkJcmV0dXJuIC1FTk9ERVY7CisJCXR5cGUgPSBJOTE1X01N
QVBfVFlQRV9HVFQ7CisJCWJyZWFrOworCisJY2FzZSBJOTE1X01NQVBfT0ZGU0VUX1dDOgorCQlp
ZiAoIWJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9QQVQpKQorCQkJcmV0dXJuIC1FTk9ERVY7CisJ
CXR5cGUgPSBJOTE1X01NQVBfVFlQRV9XQzsKKwkJYnJlYWs7CisKKwljYXNlIEk5MTVfTU1BUF9P
RkZTRVRfV0I6CisJCXR5cGUgPSBJOTE1X01NQVBfVFlQRV9XQjsKKwkJYnJlYWs7CisKKwljYXNl
IEk5MTVfTU1BUF9PRkZTRVRfVUM6CisJCWlmICghYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX1BB
VCkpCisJCQlyZXR1cm4gLUVOT0RFVjsKKwkJdHlwZSA9IEk5MTVfTU1BUF9UWVBFX1VDOworCQli
cmVhazsKKworCWRlZmF1bHQ6CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXJldHVybiBfX2Fz
c2lnbl9tbWFwX29mZnNldChmaWxlLCBhcmdzLT5oYW5kbGUsIHR5cGUsICZhcmdzLT5vZmZzZXQp
OworfQorCit2b2lkIGk5MTVfbW1hcF9vZmZzZXRfZGVzdHJveShzdHJ1Y3QgaTkxNV9tbWFwX29m
ZnNldCAqbW1vLCBzdHJ1Y3QgbXV0ZXggKm11dGV4KQoreworCWRybV92bWFfb2Zmc2V0X3JlbW92
ZShtbW8tPmRldi0+dm1hX29mZnNldF9tYW5hZ2VyLCAmbW1vLT52bWFfbm9kZSk7CisKKwltdXRl
eF9sb2NrKG11dGV4KTsKKwlsaXN0X2RlbCgmbW1vLT5vZmZzZXQpOworCW11dGV4X3VubG9jayht
dXRleCk7CisKKwlrZnJlZShtbW8pOworfQorCitzdGF0aWMgdm9pZCB2bV9vcGVuKHN0cnVjdCB2
bV9hcmVhX3N0cnVjdCAqdm1hKQoreworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW8gPSB2
bWEtPnZtX3ByaXZhdGVfZGF0YTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0g
bW1vLT5vYmo7CisKKwlHRU1fQlVHX09OKCFvYmopOworCWk5MTVfZ2VtX29iamVjdF9nZXQob2Jq
KTsKK30KKworc3RhdGljIHZvaWQgdm1fY2xvc2Uoc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEp
Cit7CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbyA9IHZtYS0+dm1fcHJpdmF0ZV9kYXRh
OworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBtbW8tPm9iajsKKworCUdFTV9C
VUdfT04oIW9iaik7CisJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworfQorCitzdGF0aWMgY29u
c3Qgc3RydWN0IHZtX29wZXJhdGlvbnNfc3RydWN0IHZtX29wc19ndHQgPSB7CisJLmZhdWx0ID0g
dm1fZmF1bHRfZ3R0LAorCS5vcGVuID0gdm1fb3BlbiwKKwkuY2xvc2UgPSB2bV9jbG9zZSwKK307
CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgdm1fb3BlcmF0aW9uc19zdHJ1Y3Qgdm1fb3BzX2NwdSA9
IHsKKwkuZmF1bHQgPSB2bV9mYXVsdF9jcHUsCisJLm9wZW4gPSB2bV9vcGVuLAorCS5jbG9zZSA9
IHZtX2Nsb3NlLAorfTsKKworLyoKKyAqIFRoaXMgb3ZlcmNvbWVzIHRoZSBsaW1pdGF0aW9uIGlu
IGRybV9nZW1fbW1hcCdzIGFzc2lnbm1lbnQgb2YgYQorICogZHJtX2dlbV9vYmplY3QgYXMgdGhl
IHZtYS0+dm1fcHJpdmF0ZV9kYXRhLiBTaW5jZSB3ZSBuZWVkIHRvCisgKiBiZSBhYmxlIHRvIHJl
c29sdmUgbXVsdGlwbGUgbW1hcCBvZmZzZXRzIHdoaWNoIGNvdWxkIGJlIHRpZWQKKyAqIHRvIGEg
c2luZ2xlIGdlbSBvYmplY3QuCisgKi8KK2ludCBpOTE1X2dlbV9tbWFwKHN0cnVjdCBmaWxlICpm
aWxwLCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKK3sKKwlzdHJ1Y3QgZHJtX3ZtYV9vZmZz
ZXRfbm9kZSAqbm9kZTsKKwlzdHJ1Y3QgZHJtX2ZpbGUgKnByaXYgPSBmaWxwLT5wcml2YXRlX2Rh
dGE7CisJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IHByaXYtPm1pbm9yLT5kZXY7CisJc3RydWN0
IGk5MTVfbW1hcF9vZmZzZXQgKm1tbyA9IE5VTEw7CisJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpv
YmogPSBOVUxMOworCisJaWYgKGRybV9kZXZfaXNfdW5wbHVnZ2VkKGRldikpCisJCXJldHVybiAt
RU5PREVWOworCisJZHJtX3ZtYV9vZmZzZXRfbG9ja19sb29rdXAoZGV2LT52bWFfb2Zmc2V0X21h
bmFnZXIpOworCW5vZGUgPSBkcm1fdm1hX29mZnNldF9leGFjdF9sb29rdXBfbG9ja2VkKGRldi0+
dm1hX29mZnNldF9tYW5hZ2VyLAorCQkJCQkJICB2bWEtPnZtX3Bnb2ZmLAorCQkJCQkJICB2bWFf
cGFnZXModm1hKSk7CisJaWYgKGxpa2VseShub2RlKSkgeworCQltbW8gPSBjb250YWluZXJfb2Yo
bm9kZSwgc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQsCisJCQkJICAgdm1hX25vZGUpOworCQkvKgor
CQkgKiBJbiBvdXIgZGVwZW5kZW5jeSBjaGFpbiwgdGhlIGRybV92bWFfb2Zmc2V0X25vZGUKKwkJ
ICogZGVwZW5kcyBvbiB0aGUgdmFsaWRpdHkgb2YgdGhlIG1tbywgd2hpY2ggZGVwZW5kcyBvbgor
CQkgKiB0aGUgZ2VtIG9iamVjdC4gSG93ZXZlciB0aGUgb25seSByZWZlcmVuY2Ugd2UgaGF2ZQor
CQkgKiBhdCB0aGlzIHBvaW50IGlzIHRoZSBtbW8gKGFzIHRoZSBwYXJlbnQgb2YgdGhlIG5vZGUp
LgorCQkgKiBUcnkgdG8gY2hlY2sgaWYgdGhlIGdlbSBvYmplY3Qgd2FzIGF0IGxlYXN0IGNsZWFy
ZWQuCisJCSAqLworCQlpZiAoIW1tbyB8fCAhbW1vLT5vYmopIHsKKwkJCWRybV92bWFfb2Zmc2V0
X3VubG9ja19sb29rdXAoZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIpOworCQkJcmV0dXJuIC1FSU5W
QUw7CisJCX0KKwkJLyoKKwkJICogU2tpcCAwLXJlZmNudGVkIG9iamVjdHMgYXMgaXQgaXMgaW4g
dGhlIHByb2Nlc3Mgb2YgYmVpbmcKKwkJICogZGVzdHJveWVkIGFuZCB3aWxsIGJlIGludmFsaWQg
d2hlbiB0aGUgdm1hIG1hbmFnZXIgbG9jaworCQkgKiBpcyByZWxlYXNlZC4KKwkJICovCisJCW9i
aiA9ICZtbW8tPm9iai0+YmFzZTsKKwkJaWYgKCFrcmVmX2dldF91bmxlc3NfemVybygmb2JqLT5y
ZWZjb3VudCkpCisJCQlvYmogPSBOVUxMOworCX0KKwlkcm1fdm1hX29mZnNldF91bmxvY2tfbG9v
a3VwKGRldi0+dm1hX29mZnNldF9tYW5hZ2VyKTsKKwlpZiAoIW9iaikKKwkJcmV0dXJuIC1FSU5W
QUw7CisKKwlpZiAoIWRybV92bWFfbm9kZV9pc19hbGxvd2VkKG5vZGUsIHByaXYpKSB7CisJCWRy
bV9nZW1fb2JqZWN0X3B1dF91bmxvY2tlZChvYmopOworCQlyZXR1cm4gLUVBQ0NFUzsKKwl9CisK
KwlpZiAoaTkxNV9nZW1fb2JqZWN0X2lzX3JlYWRvbmx5KHRvX2ludGVsX2JvKG9iaikpKSB7CisJ
CWlmICh2bWEtPnZtX2ZsYWdzICYgVk1fV1JJVEUpIHsKKwkJCWRybV9nZW1fb2JqZWN0X3B1dF91
bmxvY2tlZChvYmopOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKwkJdm1hLT52bV9mbGFncyAm
PSB+Vk1fTUFZV1JJVEU7CisJfQorCisJdm1hLT52bV9mbGFncyB8PSBWTV9QRk5NQVAgfCBWTV9E
T05URVhQQU5EIHwgVk1fRE9OVERVTVA7CisJdm1hLT52bV9wcml2YXRlX2RhdGEgPSBtbW87CisK
Kwlzd2l0Y2ggKG1tby0+bW1hcF90eXBlKSB7CisJY2FzZSBJOTE1X01NQVBfVFlQRV9XQzoKKwkJ
dm1hLT52bV9wYWdlX3Byb3QgPQorCQkJcGdwcm90X3dyaXRlY29tYmluZSh2bV9nZXRfcGFnZV9w
cm90KHZtYS0+dm1fZmxhZ3MpKTsKKwkJdm1hLT52bV9vcHMgPSAmdm1fb3BzX2NwdTsKKwkJYnJl
YWs7CisKKwljYXNlIEk5MTVfTU1BUF9UWVBFX1dCOgorCQl2bWEtPnZtX3BhZ2VfcHJvdCA9IHZt
X2dldF9wYWdlX3Byb3Qodm1hLT52bV9mbGFncyk7CisJCXZtYS0+dm1fb3BzID0gJnZtX29wc19j
cHU7CisJCWJyZWFrOworCisJY2FzZSBJOTE1X01NQVBfVFlQRV9VQzoKKwkJdm1hLT52bV9wYWdl
X3Byb3QgPQorCQkJcGdwcm90X25vbmNhY2hlZCh2bV9nZXRfcGFnZV9wcm90KHZtYS0+dm1fZmxh
Z3MpKTsKKwkJdm1hLT52bV9vcHMgPSAmdm1fb3BzX2NwdTsKKwkJYnJlYWs7CisKKwljYXNlIEk5
MTVfTU1BUF9UWVBFX0dUVDoKKwkJdm1hLT52bV9wYWdlX3Byb3QgPQorCQkJcGdwcm90X3dyaXRl
Y29tYmluZSh2bV9nZXRfcGFnZV9wcm90KHZtYS0+dm1fZmxhZ3MpKTsKKwkJdm1hLT52bV9vcHMg
PSAmdm1fb3BzX2d0dDsKKwkJYnJlYWs7CisJfQorCXZtYS0+dm1fcGFnZV9wcm90ID0gcGdwcm90
X2RlY3J5cHRlZCh2bWEtPnZtX3BhZ2VfcHJvdCk7CisKKwlyZXR1cm4gMDsKIH0KIAogI2lmIElT
X0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9tbWFuLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li4wMzA3ODQzNDQwYWMKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fbW1hbi5oCkBAIC0wLDAgKzEsMzQgQEAKKy8qCisgKiBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogTUlUCisgKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRp
b24KKyAqLworCisjaWZuZGVmIF9fSTkxNV9HRU1fTU1BTl9IX18KKyNkZWZpbmUgX19JOTE1X0dF
TV9NTUFOX0hfXworCisjaW5jbHVkZSA8bGludXgvbW1fdHlwZXMuaD4KKyNpbmNsdWRlIDxsaW51
eC90eXBlcy5oPgorCitzdHJ1Y3QgZHJtX2RldmljZTsKK3N0cnVjdCBkcm1fZmlsZTsKK3N0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0Oworc3RydWN0IGZpbGU7CitzdHJ1Y3QgaTkxNV9tbWFwX29m
ZnNldDsKK3N0cnVjdCBtdXRleDsKKworaW50IGk5MTVfZ2VtX21tYXBfZ3R0X3ZlcnNpb24odm9p
ZCk7CitpbnQgaTkxNV9nZW1fbW1hcChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IHZtX2FyZWFf
c3RydWN0ICp2bWEpOworCitpbnQgaTkxNV9nZW1fZHVtYl9tbWFwX29mZnNldChzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGVfcHJpdiwKKwkJCSAgICAgIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCisJCQkg
ICAgICB1MzIgaGFuZGxlLCB1NjQgKm9mZnNldCk7CisKK3ZvaWQgX19pOTE1X2dlbV9vYmplY3Rf
cmVsZWFzZV9tbWFwX2d0dChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKTsKK3ZvaWQg
aTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqKTsKK3ZvaWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9vZmZzZXQoc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaik7CisKK3ZvaWQgaTkxNV9tbWFwX29mZnNldF9kZXN0cm95
KHN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW8sCisJCQkgICAgICBzdHJ1Y3QgbXV0ZXggKm11
dGV4KTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0
LmMKaW5kZXggNDU4OTQ1ZTE4MjNlLi5mMWI4N2E4Mzk5MjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKQEAgLTI5LDYgKzI5LDcgQEAKICNpbmNsdWRlICJp
OTE1X2Rydi5oIgogI2luY2x1ZGUgImk5MTVfZ2VtX2NsZmx1c2guaCIKICNpbmNsdWRlICJpOTE1
X2dlbV9jb250ZXh0LmgiCisjaW5jbHVkZSAiaTkxNV9nZW1fbW1hbi5oIgogI2luY2x1ZGUgImk5
MTVfZ2VtX29iamVjdC5oIgogI2luY2x1ZGUgImk5MTVfZ2xvYmFscy5oIgogI2luY2x1ZGUgImk5
MTVfdHJhY2UuaCIKQEAgLTYxLDYgKzYyLDkgQEAgdm9pZCBpOTE1X2dlbV9vYmplY3RfaW5pdChz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCiAJSU5JVF9MSVNUX0hFQUQoJm9iai0+
bHV0X2xpc3QpOwogCisJbXV0ZXhfaW5pdCgmb2JqLT5tbW9fbG9jayk7CisJSU5JVF9MSVNUX0hF
QUQoJm9iai0+bW1hcF9vZmZzZXRzKTsKKwogCWluaXRfcmN1X2hlYWQoJm9iai0+cmN1KTsKIAog
CW9iai0+b3BzID0gb3BzOwpAQCAtOTcsNiArMTAxLDcgQEAgdm9pZCBpOTE1X2dlbV9jbG9zZV9v
YmplY3Qoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW0sIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkK
IAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gdG9faW50ZWxfYm8oZ2VtKTsKIAlz
dHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmcHJpdiA9IGZpbGUtPmRyaXZlcl9wcml2Owog
CXN0cnVjdCBpOTE1X2x1dF9oYW5kbGUgKmx1dCwgKmxuOworCXN0cnVjdCBpOTE1X21tYXBfb2Zm
c2V0ICptbW8sICpvbjsKIAlMSVNUX0hFQUQoY2xvc2UpOwogCiAJaTkxNV9nZW1fb2JqZWN0X2xv
Y2sob2JqKTsKQEAgLTExMSw2ICsxMTYsOSBAQCB2b2lkIGk5MTVfZ2VtX2Nsb3NlX29iamVjdChz
dHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSwgc3RydWN0IGRybV9maWxlICpmaWxlKQogCX0KIAlp
OTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7CiAKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUo
bW1vLCBvbiwgJm9iai0+bW1hcF9vZmZzZXRzLCBvZmZzZXQpCisJCWRybV92bWFfbm9kZV9yZXZv
a2UoJm1tby0+dm1hX25vZGUsIGZpbGUpOworCiAJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGx1
dCwgbG4sICZjbG9zZSwgb2JqX2xpbmspIHsKIAkJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eCA9IGx1dC0+Y3R4OwogCQlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKQEAgLTE1OCw2ICsxNjYsOCBA
QCBzdGF0aWMgdm9pZCBfX2k5MTVfZ2VtX2ZyZWVfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKIAogCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVu
dGltZV9wbSk7CiAJbGxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShvYmosIG9uLCBmcmVlZCwgZnJl
ZWQpIHsKKwkJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbywgKm1uOworCiAJCXRyYWNlX2k5
MTVfZ2VtX29iamVjdF9kZXN0cm95KG9iaik7CiAKIAkJaWYgKCFsaXN0X2VtcHR5KCZvYmotPnZt
YS5saXN0KSkgewpAQCAtMTgzLDYgKzE5MywxNCBAQCBzdGF0aWMgdm9pZCBfX2k5MTVfZ2VtX2Zy
ZWVfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCXNwaW5fdW5sb2Nr
KCZvYmotPnZtYS5sb2NrKTsKIAkJfQogCisJCWk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAo
b2JqKTsKKworCQlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUobW1vLCBtbiwgJm9iai0+bW1hcF9v
ZmZzZXRzLCBvZmZzZXQpIHsKKwkJCW1tby0+b2JqID0gTlVMTDsKKwkJCWk5MTVfbW1hcF9vZmZz
ZXRfZGVzdHJveShtbW8sICZvYmotPm1tb19sb2NrKTsKKwkJfQorCisJCUdFTV9CVUdfT04oIWxp
c3RfZW1wdHkoJm9iai0+bW1hcF9vZmZzZXRzKSk7CiAJCUdFTV9CVUdfT04oYXRvbWljX3JlYWQo
Jm9iai0+YmluZF9jb3VudCkpOwogCQlHRU1fQlVHX09OKG9iai0+dXNlcmZhdWx0X2NvdW50KTsK
IAkJR0VNX0JVR19PTighbGlzdF9lbXB0eSgmb2JqLT5sdXRfbGlzdCkpOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCmluZGV4IGU1NzUwZDUwNmNjOS4uYTFlYjdj
MGIyM2FjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2Jq
ZWN0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCkBA
IC0xMzIsMTMgKzEzMiwxMyBAQCB2b2lkIGk5MTVfZ2VtX29iamVjdF91bmxvY2tfZmVuY2Uoc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIHN0YXRpYyBpbmxpbmUgdm9pZAogaTkxNV9n
ZW1fb2JqZWN0X3NldF9yZWFkb25seShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQog
ewotCW9iai0+YmFzZS52bWFfbm9kZS5yZWFkb25seSA9IHRydWU7CisJb2JqLT5mbGFncyB8PSBJ
OTE1X0JPX1JFQURPTkxZOwogfQogCiBzdGF0aWMgaW5saW5lIGJvb2wKIGk5MTVfZ2VtX29iamVj
dF9pc19yZWFkb25seShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewot
CXJldHVybiBvYmotPmJhc2Uudm1hX25vZGUucmVhZG9ubHk7CisJcmV0dXJuIG9iai0+ZmxhZ3Mg
JiBJOTE1X0JPX1JFQURPTkxZOwogfQogCiBzdGF0aWMgaW5saW5lIGJvb2wKQEAgLTM4Nyw5ICsz
ODcsNiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9wYWdl
cyhvYmopOwogfQogCi12b2lkIF9faTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKTsKLXZvaWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2Vf
bW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKTsKLQogdm9pZAogaTkxNV9nZW1f
b2JqZWN0X2ZsdXNoX3dyaXRlX2RvbWFpbihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
LAogCQkJCSAgIHVuc2lnbmVkIGludCBmbHVzaF9kb21haW5zKTsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaAppbmRleCAxNWY4Mjk3ZGMzNGUu
LmMwYmViOTdiNTZkMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX29iamVjdF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9vYmplY3RfdHlwZXMuaApAQCAtNjMsNiArNjMsMjMgQEAgc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3Rfb3BzIHsKIAl2b2lkICgqcmVsZWFzZSkoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaik7CiB9OwogCitlbnVtIGk5MTVfbW1hcF90eXBlIHsKKwlJOTE1X01NQVBfVFlQRV9HVFQg
PSAwLAorCUk5MTVfTU1BUF9UWVBFX1dDLAorCUk5MTVfTU1BUF9UWVBFX1dCLAorCUk5MTVfTU1B
UF9UWVBFX1VDLAorfTsKKworc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgeworCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZXY7CisJc3RydWN0IGRybV92bWFfb2Zmc2V0X25vZGUgdm1hX25vZGU7CisJc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7CisJ
ZW51bSBpOTE1X21tYXBfdHlwZSBtbWFwX3R5cGU7CisKKwlzdHJ1Y3QgbGlzdF9oZWFkIG9mZnNl
dDsKK307CisKIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0IHsKIAlzdHJ1Y3QgZHJtX2dlbV9v
YmplY3QgYmFzZTsKIApAQCAtMTE4LDEyICsxMzUsMTcgQEAgc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgewogCXVuc2lnbmVkIGludCB1c2VyZmF1bHRfY291bnQ7CiAJc3RydWN0IGxpc3RfaGVh
ZCB1c2VyZmF1bHRfbGluazsKIAorCS8qIFByb3RlY3RzIGFjY2VzcyB0byBtbWFwIG9mZnNldHMg
Ki8KKwlzdHJ1Y3QgbXV0ZXggbW1vX2xvY2s7CisJc3RydWN0IGxpc3RfaGVhZCBtbWFwX29mZnNl
dHM7CisKIAlJOTE1X1NFTEZURVNUX0RFQ0xBUkUoc3RydWN0IGxpc3RfaGVhZCBzdF9saW5rKTsK
IAogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAjZGVmaW5lIEk5MTVfQk9fQUxMT0NfQ09OVElHVU9V
UyBCSVQoMCkKICNkZWZpbmUgSTkxNV9CT19BTExPQ19WT0xBVElMRSAgIEJJVCgxKQogI2RlZmlu
ZSBJOTE1X0JPX0FMTE9DX0ZMQUdTIChJOTE1X0JPX0FMTE9DX0NPTlRJR1VPVVMgfCBJOTE1X0JP
X0FMTE9DX1ZPTEFUSUxFKQorI2RlZmluZSBJOTE1X0JPX1JFQURPTkxZICAgICAgICAgQklUKDIp
CiAKIAkvKgogCSAqIElzIHRoZSBvYmplY3QgdG8gYmUgbWFwcGVkIGFzIHJlYWQtb25seSB0byB0
aGUgR1BVCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcGFn
ZXMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jCmluZGV4IGY0
MDJjMmM0MTVjMi4uNzUxOTdjYTY5NmE4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fcGFnZXMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fcGFnZXMuYwpAQCAtOCw2ICs4LDcgQEAKICNpbmNsdWRlICJpOTE1X2dlbV9vYmplY3Qu
aCIKICNpbmNsdWRlICJpOTE1X3NjYXR0ZXJsaXN0LmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1fbG1l
bS5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX21tYW4uaCIKIAogdm9pZCBfX2k5MTVfZ2VtX29iamVj
dF9zZXRfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAkJCQkgc3RydWN0
IHNnX3RhYmxlICpwYWdlcywKQEAgLTIwNyw2ICsyMDgsOCBAQCBpbnQgX19pOTE1X2dlbV9vYmpl
Y3RfcHV0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJCWdvdG8gdW5s
b2NrOwogCX0KIAorCWk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfb2Zmc2V0KG9iaik7CisK
IAkvKgogCSAqIC0+cHV0X3BhZ2VzIG1pZ2h0IG5lZWQgdG8gYWxsb2NhdGUgbWVtb3J5IGZvciB0
aGUgYml0MTcgc3dpenpsZQogCSAqIGFycmF5LCBoZW5jZSBwcm90ZWN0IHRoZW0gZnJvbSBiZWlu
ZyByZWFwZWQgYnkgcmVtb3ZpbmcgdGhlbSBmcm9tIGd0dApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3RpbGluZy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX3RpbGluZy5jCmluZGV4IDFmYTU5MmQ4MmFmNS4uNmM3ODI1YTJkYzJhIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdGlsaW5nLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3RpbGluZy5jCkBAIC0xMSw2ICsx
MSw3IEBACiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRlICJpOTE1X2dlbS5oIgogI2lu
Y2x1ZGUgImk5MTVfZ2VtX2lvY3Rscy5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX21tYW4uaCIKICNp
bmNsdWRlICJpOTE1X2dlbV9vYmplY3QuaCIKIAogLyoqCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jCmluZGV4IDZjZTkxNjdmOGM5Zi4u
NTkxNDM1YzVmMzY4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRl
c3RzL2k5MTVfZ2VtX21tYW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRl
c3RzL2k5MTVfZ2VtX21tYW4uYwpAQCAtNTY1LDE2ICs1NjUsMTYgQEAgc3RhdGljIGJvb2wgYXNz
ZXJ0X21tYXBfb2Zmc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJICAgICAg
IGludCBleHBlY3RlZCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwotCWlu
dCBlcnI7CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbzsKIAogCW9iaiA9IGk5MTVfZ2Vt
X29iamVjdF9jcmVhdGVfaW50ZXJuYWwoaTkxNSwgc2l6ZSk7CiAJaWYgKElTX0VSUihvYmopKQog
CQlyZXR1cm4gUFRSX0VSUihvYmopOwogCi0JZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9iaik7
CisJbW1vID0gbW1hcF9vZmZzZXRfYXR0YWNoKG9iaiwgSTkxNV9NTUFQX09GRlNFVF9HVFQsIE5V
TEwpOwogCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIAotCXJldHVybiBlcnIgPT0gZXhwZWN0
ZWQ7CisJcmV0dXJuIFBUUl9FUlJfT1JfWkVSTyhtbW8pID09IGV4cGVjdGVkOwogfQogCiBzdGF0
aWMgdm9pZCBkaXNhYmxlX3JldGlyZV93b3JrZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCkBAIC02MDksNyArNjA5LDggQEAgc3RhdGljIGludCBpZ3RfbW1hcF9vZmZzZXRfZXhoYXVz
dGlvbih2b2lkICphcmcpCiAJc3RydWN0IGRybV9tbSAqbW0gPSAmaTkxNS0+ZHJtLnZtYV9vZmZz
ZXRfbWFuYWdlci0+dm1fYWRkcl9zcGFjZV9tbTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqOwogCXN0cnVjdCBkcm1fbW1fbm9kZSAqaG9sZSwgKm5leHQ7Ci0JaW50IGxvb3AsIGVy
cjsKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1vOworCWludCBsb29wLCBlcnIgPSAwOwog
CiAJLyogRGlzYWJsZSBiYWNrZ3JvdW5kIHJlYXBlciAqLwogCWRpc2FibGVfcmV0aXJlX3dvcmtl
cihpOTE1KTsKQEAgLTY3Myw5ICs2NzQsMTAgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9vZmZzZXRf
ZXhoYXVzdGlvbih2b2lkICphcmcpCiAJCWdvdG8gb3V0OwogCX0KIAotCWVyciA9IGNyZWF0ZV9t
bWFwX29mZnNldChvYmopOwotCWlmIChlcnIpIHsKKwltbW8gPSBtbWFwX29mZnNldF9hdHRhY2go
b2JqLCBJOTE1X01NQVBfT0ZGU0VUX0dUVCwgTlVMTCk7CisJaWYgKElTX0VSUihtbW8pKSB7CiAJ
CXByX2VycigiVW5hYmxlIHRvIGluc2VydCBvYmplY3QgaW50byByZWNsYWltZWQgaG9sZVxuIik7
CisJCWVyciA9IFBUUl9FUlIobW1vKTsKIAkJZ290byBlcnJfb2JqOwogCX0KIApAQCAtNzI0LDE0
ICs3MjYsMTUgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9vZmZzZXRfZXhoYXVzdGlvbih2b2lkICph
cmcpCiB9CiAKICNkZWZpbmUgZXhwYW5kMzIoeCkgKCgoeCkgPDwgMCkgfCAoKHgpIDw8IDgpIHwg
KCh4KSA8PCAxNikgfCAoKHgpIDw8IDI0KSkKLXN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0KHZvaWQg
KmFyZykKK3N0YXRpYyBpbnQgaWd0X21tYXAodm9pZCAqYXJnLCBlbnVtIGk5MTVfbW1hcF90eXBl
IHR5cGUpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7CiAJc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1v
OwogCXN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqYXJlYTsKIAl1bnNpZ25lZCBsb25nIGFkZHI7CiAJ
dm9pZCAqdmFkZHI7Ci0JaW50IGVyciwgaTsKKwlpbnQgZXJyID0gMCwgaTsKIAogCWlmICghaTkx
NV9nZ3R0X2hhc19hcGVydHVyZSgmaTkxNS0+Z2d0dCkpCiAJCXJldHVybiAwOwpAQCAtNzQ5LDE4
ICs3NTIsMTkgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9ndHQodm9pZCAqYXJnKQogCWk5MTVfZ2Vt
X29iamVjdF9mbHVzaF9tYXAob2JqKTsKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKG9iaik7
CiAKLQllcnIgPSBjcmVhdGVfbW1hcF9vZmZzZXQob2JqKTsKLQlpZiAoZXJyKQorCW1tbyA9IG1t
YXBfb2Zmc2V0X2F0dGFjaChvYmosIHR5cGUsIE5VTEwpOworCWlmIChJU19FUlIobW1vKSkgewor
CQllcnIgPSBQVFJfRVJSKG1tbyk7CiAJCWdvdG8gb3V0OworCX0KIAotCWFkZHIgPSBpZ3RfbW1h
cF9ub2RlKGk5MTUsICZvYmotPmJhc2Uudm1hX25vZGUsCi0JCQkgICAgIDAsIFBST1RfV1JJVEUs
IE1BUF9TSEFSRUQpOworCWFkZHIgPSBpZ3RfbW1hcF9ub2RlKGk5MTUsICZtbW8tPnZtYV9ub2Rl
LCAwLCBQUk9UX1dSSVRFLCBNQVBfU0hBUkVEKTsKIAlpZiAoSVNfRVJSX1ZBTFVFKGFkZHIpKSB7
CiAJCWVyciA9IGFkZHI7CiAJCWdvdG8gb3V0OwogCX0KIAotCXByX2RlYnVnKCJpZ3RfbW1hcChv
Ymo6Z3R0KSBAICVseFxuIiwgYWRkcik7CisJcHJfZGVidWcoImlndF9tbWFwKCkgQCAlbHhcbiIs
IGFkZHIpOwogCiAJYXJlYSA9IGZpbmRfdm1hKGN1cnJlbnQtPm1tLCBhZGRyKTsKIAlpZiAoIWFy
ZWEpIHsKQEAgLTc2OSw4ICs3NzMsOCBAQCBzdGF0aWMgaW50IGlndF9tbWFwX2d0dCh2b2lkICph
cmcpCiAJCWdvdG8gb3V0X3VubWFwOwogCX0KIAotCWlmIChhcmVhLT52bV9wcml2YXRlX2RhdGEg
IT0gb2JqKSB7Ci0JCXByX2Vycigidm1fYXJlYV9zdHJ1Y3QgZGlkIG5vdCBwb2ludCBiYWNrIHRv
IG91ciBvYmplY3QhXG4iKTsKKwlpZiAoYXJlYS0+dm1fcHJpdmF0ZV9kYXRhICE9IG1tbykgewor
CQlwcl9lcnIoInZtX2FyZWFfc3RydWN0IGRpZCBub3QgcG9pbnQgYmFjayB0byBvdXIgbW1hcF9v
ZmZzZXQgb2JqZWN0IVxuIik7CiAJCWVyciA9IC1FSU5WQUw7CiAJCWdvdG8gb3V0X3VubWFwOwog
CX0KQEAgLTc4MCwxNCArNzg0LDE0IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0KHZvaWQgKmFy
ZykKIAkJdTMyIHg7CiAKIAkJaWYgKGdldF91c2VyKHgsIHV4KSkgewotCQkJcHJfZXJyKCJVbmFi
bGUgdG8gcmVhZCBmcm9tIEdUVCBtbWFwLCBvZmZzZXQ6JXpkXG4iLAorCQkJcHJfZXJyKCJVbmFi
bGUgdG8gcmVhZCBmcm9tIG1tYXAsIG9mZnNldDolemRcbiIsCiAJCQkgICAgICAgaSAqIHNpemVv
Zih4KSk7CiAJCQllcnIgPSAtRUZBVUxUOwogCQkJYnJlYWs7CiAJCX0KIAogCQlpZiAoeCAhPSBl
eHBhbmQzMihQT0lTT05fSU5VU0UpKSB7Ci0JCQlwcl9lcnIoIlJlYWQgaW5jb3JyZWN0IHZhbHVl
IGZyb20gR1RUIG1tYXAsIG9mZnNldDolemQsIGZvdW5kOiV4LCBleHBlY3RlZDoleFxuIiwKKwkJ
CXByX2VycigiUmVhZCBpbmNvcnJlY3QgdmFsdWUgZnJvbSBtbWFwLCBvZmZzZXQ6JXpkLCBmb3Vu
ZDoleCwgZXhwZWN0ZWQ6JXhcbiIsCiAJCQkgICAgICAgaSAqIHNpemVvZih4KSwgeCwgZXhwYW5k
MzIoUE9JU09OX0lOVVNFKSk7CiAJCQllcnIgPSAtRUlOVkFMOwogCQkJYnJlYWs7CkBAIC03OTUs
NyArNzk5LDcgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9ndHQodm9pZCAqYXJnKQogCiAJCXggPSBl
eHBhbmQzMihQT0lTT05fRlJFRSk7CiAJCWlmIChwdXRfdXNlcih4LCB1eCkpIHsKLQkJCXByX2Vy
cigiVW5hYmxlIHRvIHdyaXRlIHRvIEdUVCBtbWFwLCBvZmZzZXQ6JXpkXG4iLAorCQkJcHJfZXJy
KCJVbmFibGUgdG8gd3JpdGUgdG8gbW1hcCwgb2Zmc2V0OiV6ZFxuIiwKIAkJCSAgICAgICBpICog
c2l6ZW9mKHgpKTsKIAkJCWVyciA9IC1FRkFVTFQ7CiAJCQlicmVhazsKQEAgLTgxMSw3ICs4MTUs
NyBAQCBzdGF0aWMgaW50IGlndF9tbWFwX2d0dCh2b2lkICphcmcpCiAJCWdvdG8gb3V0OwogCX0K
IAlpZiAoZXJyID09IDAgJiYgbWVtY2hyX2ludih2YWRkciwgUE9JU09OX0ZSRUUsIFBBR0VfU0la
RSkpIHsKLQkJcHJfZXJyKCJXcml0ZSB2aWEgR0dUVCBtbWFwIGRpZCBub3QgbGFuZCBpbiBiYWNr
aW5nIHN0b3JlXG4iKTsKKwkJcHJfZXJyKCJXcml0ZSB2aWEgbW1hcCBkaWQgbm90IGxhbmQgaW4g
YmFja2luZyBzdG9yZVxuIik7CiAJCWVyciA9IC1FSU5WQUw7CiAJfQogCWk5MTVfZ2VtX29iamVj
dF91bnBpbl9tYXAob2JqKTsKQEAgLTgyMSw2ICs4MjUsMTYgQEAgc3RhdGljIGludCBpZ3RfbW1h
cF9ndHQodm9pZCAqYXJnKQogCXJldHVybiBlcnI7CiB9CiAKK3N0YXRpYyBpbnQgaWd0X21tYXBf
Z3R0KHZvaWQgKmFyZykKK3sKKwlyZXR1cm4gaWd0X21tYXAoYXJnLCBJOTE1X01NQVBfVFlQRV9H
VFQpOworfQorCitzdGF0aWMgaW50IGlndF9tbWFwX2NwdSh2b2lkICphcmcpCit7CisJcmV0dXJu
IGlndF9tbWFwKGFyZywgSTkxNV9NTUFQX1RZUEVfV0MpOworfQorCiBzdGF0aWMgaW50IGNoZWNr
X3ByZXNlbnRfcHRlKHB0ZV90ICpwdGUsIHVuc2lnbmVkIGxvbmcgYWRkciwgdm9pZCAqZGF0YSkK
IHsKIAlpZiAoIXB0ZV9wcmVzZW50KCpwdGUpIHx8IHB0ZV9ub25lKCpwdGUpKSB7CkBAIC04NzMs
MTAgKzg4NywxMSBAQCBzdGF0aWMgaW50IHByZWZhdWx0X3JhbmdlKHU2NCBzdGFydCwgdTY0IGxl
bikKIAlyZXR1cm4gX19nZXRfdXNlcihjLCBlbmQgLSAxKTsKIH0KIAotc3RhdGljIGludCBpZ3Rf
bW1hcF9ndHRfcmV2b2tlKHZvaWQgKmFyZykKK3N0YXRpYyBpbnQgaWd0X21tYXBfcmV2b2tlKHZv
aWQgKmFyZywgZW51bSBpOTE1X21tYXBfdHlwZSB0eXBlKQogewogCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gYXJnOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJ
c3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbzsKIAl1bnNpZ25lZCBsb25nIGFkZHI7CiAJaW50
IGVycjsKIApAQCAtODg3LDEyICs5MDIsMTMgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9ndHRfcmV2
b2tlKHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKG9iaikpCiAJCXJldHVybiBQVFJfRVJSKG9iaik7
CiAKLQllcnIgPSBjcmVhdGVfbW1hcF9vZmZzZXQob2JqKTsKLQlpZiAoZXJyKQorCW1tbyA9IG1t
YXBfb2Zmc2V0X2F0dGFjaChvYmosIHR5cGUsIE5VTEwpOworCWlmIChJU19FUlIobW1vKSkgewor
CQllcnIgPSBQVFJfRVJSKG1tbyk7CiAJCWdvdG8gb3V0OworCX0KIAotCWFkZHIgPSBpZ3RfbW1h
cF9ub2RlKGk5MTUsICZvYmotPmJhc2Uudm1hX25vZGUsCi0JCQkgICAgIDAsIFBST1RfV1JJVEUs
IE1BUF9TSEFSRUQpOworCWFkZHIgPSBpZ3RfbW1hcF9ub2RlKGk5MTUsICZtbW8tPnZtYV9ub2Rl
LCAwLCBQUk9UX1dSSVRFLCBNQVBfU0hBUkVEKTsKIAlpZiAoSVNfRVJSX1ZBTFVFKGFkZHIpKSB7
CiAJCWVyciA9IGFkZHI7CiAJCWdvdG8gb3V0OwpAQCAtOTAyLDcgKzkxOCw4IEBAIHN0YXRpYyBp
bnQgaWd0X21tYXBfZ3R0X3Jldm9rZSh2b2lkICphcmcpCiAJaWYgKGVycikKIAkJZ290byBvdXRf
dW5tYXA7CiAKLQlHRU1fQlVHX09OKCFhdG9taWNfcmVhZCgmb2JqLT5iaW5kX2NvdW50KSk7CisJ
R0VNX0JVR19PTihtbW8tPm1tYXBfdHlwZSA9PSBJOTE1X01NQVBfVFlQRV9HVFQgJiYKKwkJICAg
IWF0b21pY19yZWFkKCZvYmotPmJpbmRfY291bnQpKTsKIAogCWVyciA9IGNoZWNrX3ByZXNlbnQo
YWRkciwgb2JqLT5iYXNlLnNpemUpOwogCWlmIChlcnIpCkBAIC05MjAsNiArOTM3LDE1IEBAIHN0
YXRpYyBpbnQgaWd0X21tYXBfZ3R0X3Jldm9rZSh2b2lkICphcmcpCiAJfQogCUdFTV9CVUdfT04o
YXRvbWljX3JlYWQoJm9iai0+YmluZF9jb3VudCkpOwogCisJaWYgKHR5cGUgIT0gSTkxNV9NTUFQ
X1RZUEVfR1RUKSB7CisJCV9faTkxNV9nZW1fb2JqZWN0X3B1dF9wYWdlcyhvYmopOworCQlpZiAo
aTkxNV9nZW1fb2JqZWN0X2hhc19wYWdlcyhvYmopKSB7CisJCQlwcl9lcnIoIkZhaWxlZCB0byBw
dXQtcGFnZXMgb2JqZWN0IVxuIik7CisJCQllcnIgPSAtRUlOVkFMOworCQkJZ290byBvdXRfdW5t
YXA7CisJCX0KKwl9CisKIAllcnIgPSBjaGVja19hYnNlbnQoYWRkciwgb2JqLT5iYXNlLnNpemUp
OwogCWlmIChlcnIpCiAJCWdvdG8gb3V0X3VubWFwOwpAQCAtOTMxLDYgKzk1NywxNiBAQCBzdGF0
aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uodm9pZCAqYXJnKQogCXJldHVybiBlcnI7CiB9CiAK
K3N0YXRpYyBpbnQgaWd0X21tYXBfZ3R0X3Jldm9rZSh2b2lkICphcmcpCit7CisJcmV0dXJuIGln
dF9tbWFwX3Jldm9rZShhcmcsIEk5MTVfTU1BUF9UWVBFX0dUVCk7Cit9CisKK3N0YXRpYyBpbnQg
aWd0X21tYXBfY3B1X3Jldm9rZSh2b2lkICphcmcpCit7CisJcmV0dXJuIGlndF9tbWFwX3Jldm9r
ZShhcmcsIEk5MTVfTU1BUF9UWVBFX1dDKTsKK30KKwogaW50IGk5MTVfZ2VtX21tYW5fbGl2ZV9z
ZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJc3RhdGljIGNvbnN0
IHN0cnVjdCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsKQEAgLTkzOCw3ICs5NzQsOSBAQCBpbnQg
aTkxNV9nZW1fbW1hbl9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKIAkJU1VCVEVTVChpZ3Rfc21va2VfdGlsaW5nKSwKIAkJU1VCVEVTVChpZ3RfbW1hcF9vZmZz
ZXRfZXhoYXVzdGlvbiksCiAJCVNVQlRFU1QoaWd0X21tYXBfZ3R0KSwKKwkJU1VCVEVTVChpZ3Rf
bW1hcF9jcHUpLAogCQlTVUJURVNUKGlndF9tbWFwX2d0dF9yZXZva2UpLAorCQlTVUJURVNUKGln
dF9tbWFwX2NwdV9yZXZva2UpLAogCX07CiAKIAlyZXR1cm4gaTkxNV9zdWJ0ZXN0cyh0ZXN0cywg
aTkxNSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwppbmRleCAzNjE4OTIzOGUx
M2MuLjBlOTRiNzIwYzk5MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfcmVzZXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCkBA
IC02NzgsOCArNjc4LDEzIEBAIHN0YXRpYyB2b2lkIHJldm9rZV9tbWFwcyhzdHJ1Y3QgaW50ZWxf
Z3QgKmd0KQogCQkJY29udGludWU7CiAKIAkJR0VNX0JVR19PTih2bWEtPmZlbmNlICE9ICZndC0+
Z2d0dC0+ZmVuY2VfcmVnc1tpXSk7Ci0JCW5vZGUgPSAmdm1hLT5vYmotPmJhc2Uudm1hX25vZGU7
CisKKwkJaWYgKCF2bWEtPm1tbykKKwkJCWNvbnRpbnVlOworCisJCW5vZGUgPSAmdm1hLT5tbW8t
PnZtYV9ub2RlOwogCQl2bWFfb2Zmc2V0ID0gdm1hLT5nZ3R0X3ZpZXcucGFydGlhbC5vZmZzZXQg
PDwgUEFHRV9TSElGVDsKKwogCQl1bm1hcF9tYXBwaW5nX3JhbmdlKGd0LT5pOTE1LT5kcm0uYW5v
bl9pbm9kZS0+aV9tYXBwaW5nLAogCQkJCSAgICBkcm1fdm1hX25vZGVfb2Zmc2V0X2FkZHIobm9k
ZSkgKyB2bWFfb2Zmc2V0LAogCQkJCSAgICB2bWEtPnNpemUsCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYu
YwppbmRleCAzNDM0NGI2MzJlMWYuLjczYTM4NWY4MDlkMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Ry
di5jCkBAIC02MSw2ICs2MSw3IEBACiAKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fY29udGV4dC5o
IgogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9pb2N0bHMuaCIKKyNpbmNsdWRlICJnZW0vaTkxNV9n
ZW1fbW1hbi5oIgogI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxf
Z3RfcG0uaCIKICNpbmNsdWRlICJndC9pbnRlbF9yYzYuaCIKQEAgLTI2NjAsMTggKzI2NjEsMTIg
QEAgY29uc3Qgc3RydWN0IGRldl9wbV9vcHMgaTkxNV9wbV9vcHMgPSB7CiAJLnJ1bnRpbWVfcmVz
dW1lID0gaW50ZWxfcnVudGltZV9yZXN1bWUsCiB9OwogCi1zdGF0aWMgY29uc3Qgc3RydWN0IHZt
X29wZXJhdGlvbnNfc3RydWN0IGk5MTVfZ2VtX3ZtX29wcyA9IHsKLQkuZmF1bHQgPSBpOTE1X2dl
bV9mYXVsdCwKLQkub3BlbiA9IGRybV9nZW1fdm1fb3BlbiwKLQkuY2xvc2UgPSBkcm1fZ2VtX3Zt
X2Nsb3NlLAotfTsKLQogc3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgaTkxNV9k
cml2ZXJfZm9wcyA9IHsKIAkub3duZXIgPSBUSElTX01PRFVMRSwKIAkub3BlbiA9IGRybV9vcGVu
LAogCS5yZWxlYXNlID0gZHJtX3JlbGVhc2UsCiAJLnVubG9ja2VkX2lvY3RsID0gZHJtX2lvY3Rs
LAotCS5tbWFwID0gZHJtX2dlbV9tbWFwLAorCS5tbWFwID0gaTkxNV9nZW1fbW1hcCwKIAkucG9s
bCA9IGRybV9wb2xsLAogCS5yZWFkID0gZHJtX3JlYWQsCiAJLmNvbXBhdF9pb2N0bCA9IGk5MTVf
Y29tcGF0X2lvY3RsLApAQCAtMjcxOCw3ICsyNzEzLDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBk
cm1faW9jdGxfZGVzYyBpOTE1X2lvY3Rsc1tdID0gewogCURSTV9JT0NUTF9ERUZfRFJWKEk5MTVf
R0VNX1BSRUFELCBpOTE1X2dlbV9wcmVhZF9pb2N0bCwgRFJNX1JFTkRFUl9BTExPVyksCiAJRFJN
X0lPQ1RMX0RFRl9EUlYoSTkxNV9HRU1fUFdSSVRFLCBpOTE1X2dlbV9wd3JpdGVfaW9jdGwsIERS
TV9SRU5ERVJfQUxMT1cpLAogCURSTV9JT0NUTF9ERUZfRFJWKEk5MTVfR0VNX01NQVAsIGk5MTVf
Z2VtX21tYXBfaW9jdGwsIERSTV9SRU5ERVJfQUxMT1cpLAotCURSTV9JT0NUTF9ERUZfRFJWKEk5
MTVfR0VNX01NQVBfR1RULCBpOTE1X2dlbV9tbWFwX2d0dF9pb2N0bCwgRFJNX1JFTkRFUl9BTExP
VyksCisJRFJNX0lPQ1RMX0RFRl9EUlYoSTkxNV9HRU1fTU1BUF9PRkZTRVQsIGk5MTVfZ2VtX21t
YXBfb2Zmc2V0X2lvY3RsLCBEUk1fUkVOREVSX0FMTE9XKSwKIAlEUk1fSU9DVExfREVGX0RSVihJ
OTE1X0dFTV9TRVRfRE9NQUlOLCBpOTE1X2dlbV9zZXRfZG9tYWluX2lvY3RsLCBEUk1fUkVOREVS
X0FMTE9XKSwKIAlEUk1fSU9DVExfREVGX0RSVihJOTE1X0dFTV9TV19GSU5JU0gsIGk5MTVfZ2Vt
X3N3X2ZpbmlzaF9pb2N0bCwgRFJNX1JFTkRFUl9BTExPVyksCiAJRFJNX0lPQ1RMX0RFRl9EUlYo
STkxNV9HRU1fU0VUX1RJTElORywgaTkxNV9nZW1fc2V0X3RpbGluZ19pb2N0bCwgRFJNX1JFTkRF
Ul9BTExPVyksCkBAIC0yNzYwLDcgKzI3NTUsNiBAQCBzdGF0aWMgc3RydWN0IGRybV9kcml2ZXIg
ZHJpdmVyID0gewogCiAJLmdlbV9jbG9zZV9vYmplY3QgPSBpOTE1X2dlbV9jbG9zZV9vYmplY3Qs
CiAJLmdlbV9mcmVlX29iamVjdF91bmxvY2tlZCA9IGk5MTVfZ2VtX2ZyZWVfb2JqZWN0LAotCS5n
ZW1fdm1fb3BzID0gJmk5MTVfZ2VtX3ZtX29wcywKIAogCS5wcmltZV9oYW5kbGVfdG9fZmQgPSBk
cm1fZ2VtX3ByaW1lX2hhbmRsZV90b19mZCwKIAkucHJpbWVfZmRfdG9faGFuZGxlID0gZHJtX2dl
bV9wcmltZV9mZF90b19oYW5kbGUsCkBAIC0yNzcxLDcgKzI3NjUsOCBAQCBzdGF0aWMgc3RydWN0
IGRybV9kcml2ZXIgZHJpdmVyID0gewogCS5nZXRfc2Nhbm91dF9wb3NpdGlvbiA9IGk5MTVfZ2V0
X2NydGNfc2Nhbm91dHBvcywKIAogCS5kdW1iX2NyZWF0ZSA9IGk5MTVfZ2VtX2R1bWJfY3JlYXRl
LAotCS5kdW1iX21hcF9vZmZzZXQgPSBpOTE1X2dlbV9tbWFwX2d0dCwKKwkuZHVtYl9tYXBfb2Zm
c2V0ID0gaTkxNV9nZW1fZHVtYl9tbWFwX29mZnNldCwKKwogCS5pb2N0bHMgPSBpOTE1X2lvY3Rs
cywKIAkubnVtX2lvY3RscyA9IEFSUkFZX1NJWkUoaTkxNV9pb2N0bHMpLAogCS5mb3BzID0gJmk5
MTVfZHJpdmVyX2ZvcHMsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Ry
di5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRleCAxNDc0NGMxMTQ0NzUu
LjBkNGFkMThlMTBkZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBAIC0xODU3LDkgKzE4NTcs
NiBAQCBpOTE1X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
KQogaW50IGk5MTVfZ2VtX2R1bWJfY3JlYXRlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2LAog
CQkJIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCQkgc3RydWN0IGRybV9tb2RlX2NyZWF0ZV9k
dW1iICphcmdzKTsKLWludCBpOTE1X2dlbV9tbWFwX2d0dChzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVf
cHJpdiwgc3RydWN0IGRybV9kZXZpY2UgKmRldiwKLQkJICAgICAgdTMyIGhhbmRsZSwgdTY0ICpv
ZmZzZXQpOwotaW50IGk5MTVfZ2VtX21tYXBfZ3R0X3ZlcnNpb24odm9pZCk7CiAKIGludCBfX211
c3RfY2hlY2sgaTkxNV9nZW1fc2V0X2dsb2JhbF9zZXFubyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCB1MzIgc2Vxbm8pOwogCkBAIC0xODgyLDcgKzE4NzksNiBAQCB2b2lkIGk5MTVfZ2VtX2RyaXZl
cl9yZWxlYXNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiB2b2lkIGk5MTVf
Z2VtX3N1c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIHZvaWQgaTkx
NV9nZW1fc3VzcGVuZF9sYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiB2
b2lkIGk5MTVfZ2VtX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwot
dm1fZmF1bHRfdCBpOTE1X2dlbV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZik7CiAKIGludCBp
OTE1X2dlbV9vcGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBzdHJ1Y3QgZHJtX2Zp
bGUgKmZpbGUpOwogdm9pZCBpOTE1X2dlbV9yZWxlYXNlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwppbmRleCBiZmRj
OGE5ZjgyZjguLmVmZDgzNDk2M2VkMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCkBAIC00NCw2
ICs0NCw3IEBACiAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2NsZmx1c2guaCIKICNpbmNsdWRlICJn
ZW0vaTkxNV9nZW1fY29udGV4dC5oIgogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9pb2N0bHMuaCIK
KyNpbmNsdWRlICJnZW0vaTkxNV9nZW1fbW1hbi5oIgogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9w
bS5oIgogI2luY2x1ZGUgImd0L2ludGVsX2NvbnRleHQuaCIKICNpbmNsdWRlICJndC9pbnRlbF9l
bmdpbmVfdXNlci5oIgpAQCAtODcwLDcgKzg3MSw3IEBAIHZvaWQgaTkxNV9nZW1fcnVudGltZV9z
dXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCiAJbGlzdF9mb3JfZWFjaF9l
bnRyeV9zYWZlKG9iaiwgb24sCiAJCQkJICZpOTE1LT5nZ3R0LnVzZXJmYXVsdF9saXN0LCB1c2Vy
ZmF1bHRfbGluaykKLQkJX19pOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKG9iaik7CisJCV9f
aTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9ndHQob2JqKTsKIAogCS8qCiAJICogVGhlIGZl
bmNlIHdpbGwgYmUgbG9zdCB3aGVuIHRoZSBkZXZpY2UgcG93ZXJzIGRvd24uIElmIGFueSB3ZXJl
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dldHBhcmFtLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dldHBhcmFtLmMKaW5kZXggY2Y4YThjM2VmMDQ3Li41NGZj
ZTgxZDU3MjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2V0cGFyYW0u
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dldHBhcmFtLmMKQEAgLTIsNiArMiw3
IEBACiAgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCiAgKi8KIAorI2luY2x1ZGUgImdl
bS9pOTE1X2dlbV9tbWFuLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfZW5naW5lX3VzZXIuaCIKIAog
I2luY2x1ZGUgImk5MTVfZHJ2LmgiCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3ZtYS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwppbmRleCBlNTUxMmYy
NmUyMGEuLjUxMDhkY2IyZTViMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV92bWEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCkBAIC0xMDU0LDcg
KzEwNTQsNyBAQCBzdGF0aWMgdm9pZCBfX2k5MTVfdm1hX2lvdW5tYXAoc3RydWN0IGk5MTVfdm1h
ICp2bWEpCiAKIHZvaWQgaTkxNV92bWFfcmV2b2tlX21tYXAoc3RydWN0IGk5MTVfdm1hICp2bWEp
CiB7Ci0Jc3RydWN0IGRybV92bWFfb2Zmc2V0X25vZGUgKm5vZGUgPSAmdm1hLT5vYmotPmJhc2Uu
dm1hX25vZGU7CisJc3RydWN0IGRybV92bWFfb2Zmc2V0X25vZGUgKm5vZGU7CiAJdTY0IHZtYV9v
ZmZzZXQ7CiAKIAlsb2NrZGVwX2Fzc2VydF9oZWxkKCZ2bWEtPnZtLT5tdXRleCk7CkBAIC0xMDY1
LDYgKzEwNjUsNyBAQCB2b2lkIGk5MTVfdm1hX3Jldm9rZV9tbWFwKHN0cnVjdCBpOTE1X3ZtYSAq
dm1hKQogCUdFTV9CVUdfT04oIWk5MTVfdm1hX2lzX21hcF9hbmRfZmVuY2VhYmxlKHZtYSkpOwog
CUdFTV9CVUdfT04oIXZtYS0+b2JqLT51c2VyZmF1bHRfY291bnQpOwogCisJbm9kZSA9ICZ2bWEt
Pm1tby0+dm1hX25vZGU7CiAJdm1hX29mZnNldCA9IHZtYS0+Z2d0dF92aWV3LnBhcnRpYWwub2Zm
c2V0IDw8IFBBR0VfU0hJRlQ7CiAJdW5tYXBfbWFwcGluZ19yYW5nZSh2bWEtPnZtLT5pOTE1LT5k
cm0uYW5vbl9pbm9kZS0+aV9tYXBwaW5nLAogCQkJICAgIGRybV92bWFfbm9kZV9vZmZzZXRfYWRk
cihub2RlKSArIHZtYV9vZmZzZXQsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3ZtYS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuaAppbmRleCA0NjU5MzI4
MTNiYzUuLmYwOWY0ZjUxM2M0MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV92bWEuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5oCkBAIC02Myw2ICs2
Myw5IEBAIHN0cnVjdCBpOTE1X3ZtYSB7CiAJdTY0IGRpc3BsYXlfYWxpZ25tZW50OwogCXN0cnVj
dCBpOTE1X3BhZ2Vfc2l6ZXMgcGFnZV9zaXplczsKIAorCS8qIG1tYXAtb2Zmc2V0IGFzc29jaWF0
ZWQgd2l0aCBmZW5jaW5nIGZvciB0aGlzIHZtYSAqLworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0
CSptbW87CisKIAl1MzIgZmVuY2Vfc2l6ZTsKIAl1MzIgZmVuY2VfYWxpZ25tZW50OwogCmRpZmYg
LS1naXQgYS9pbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmggYi9pbmNsdWRlL3VhcGkvZHJtL2k5
MTVfZHJtLmgKaW5kZXggNTQwMGQ3ZTA1N2YxLi44MjljMGE0ODU3N2YgMTAwNjQ0Ci0tLSBhL2lu
Y2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaAorKysgYi9pbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJt
LmgKQEAgLTM5NSw2ICszOTUsNyBAQCB0eXBlZGVmIHN0cnVjdCBfZHJtX2k5MTVfc2FyZWEgewog
I2RlZmluZSBEUk1fSU9DVExfSTkxNV9HRU1fUFdSSVRFCURSTV9JT1cgKERSTV9DT01NQU5EX0JB
U0UgKyBEUk1fSTkxNV9HRU1fUFdSSVRFLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX3B3cml0ZSkKICNk
ZWZpbmUgRFJNX0lPQ1RMX0k5MTVfR0VNX01NQVAJCURSTV9JT1dSKERSTV9DT01NQU5EX0JBU0Ug
KyBEUk1fSTkxNV9HRU1fTU1BUCwgc3RydWN0IGRybV9pOTE1X2dlbV9tbWFwKQogI2RlZmluZSBE
Uk1fSU9DVExfSTkxNV9HRU1fTU1BUF9HVFQJRFJNX0lPV1IoRFJNX0NPTU1BTkRfQkFTRSArIERS
TV9JOTE1X0dFTV9NTUFQX0dUVCwgc3RydWN0IGRybV9pOTE1X2dlbV9tbWFwX2d0dCkKKyNkZWZp
bmUgRFJNX0lPQ1RMX0k5MTVfR0VNX01NQVBfT0ZGU0VUCURSTV9JT1dSKERSTV9DT01NQU5EX0JB
U0UgKyBEUk1fSTkxNV9HRU1fTU1BUF9HVFQsIHN0cnVjdCBkcm1faTkxNV9nZW1fbW1hcF9vZmZz
ZXQpCiAjZGVmaW5lIERSTV9JT0NUTF9JOTE1X0dFTV9TRVRfRE9NQUlOCURSTV9JT1cgKERSTV9D
T01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1fU0VUX0RPTUFJTiwgc3RydWN0IGRybV9pOTE1X2dl
bV9zZXRfZG9tYWluKQogI2RlZmluZSBEUk1fSU9DVExfSTkxNV9HRU1fU1dfRklOSVNICURSTV9J
T1cgKERSTV9DT01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1fU1dfRklOSVNILCBzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX3N3X2ZpbmlzaCkKICNkZWZpbmUgRFJNX0lPQ1RMX0k5MTVfR0VNX1NFVF9USUxJ
TkcJRFJNX0lPV1IgKERSTV9DT01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1fU0VUX1RJTElORywg
c3RydWN0IGRybV9pOTE1X2dlbV9zZXRfdGlsaW5nKQpAQCAtNzkzLDYgKzc5NCwzNyBAQCBzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX21tYXBfZ3R0IHsKIAlfX3U2NCBvZmZzZXQ7CiB9OwogCitzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX21tYXBfb2Zmc2V0IHsKKwkvKiogSGFuZGxlIGZvciB0aGUgb2JqZWN0IGJl
aW5nIG1hcHBlZC4gKi8KKwlfX3UzMiBoYW5kbGU7CisJX191MzIgcGFkOworCS8qKgorCSAqIEZh
a2Ugb2Zmc2V0IHRvIHVzZSBmb3Igc3Vic2VxdWVudCBtbWFwIGNhbGwKKwkgKgorCSAqIFRoaXMg
aXMgYSBmaXhlZC1zaXplIHR5cGUgZm9yIDMyLzY0IGNvbXBhdGliaWxpdHkuCisJICovCisJX191
NjQgb2Zmc2V0OworCisJLyoqCisJICogRmxhZ3MgZm9yIGV4dGVuZGVkIGJlaGF2aW91ci4KKwkg
KgorCSAqIEl0IGlzIG1hbmRhdG9yeSB0aGF0IG9uZSBvZiB0aGUgTU1BUF9PRkZTRVQgdHlwZXMK
KwkgKiAoR1RULCBXQywgV0IsIFVDLCBldGMpIHNob3VsZCBiZSBpbmNsdWRlZC4KKwkgKi8KKwlf
X3U2NCBmbGFnczsKKyNkZWZpbmUgSTkxNV9NTUFQX09GRlNFVF9HVFQgMAorI2RlZmluZSBJOTE1
X01NQVBfT0ZGU0VUX1dDICAxCisjZGVmaW5lIEk5MTVfTU1BUF9PRkZTRVRfV0IgIDIKKyNkZWZp
bmUgSTkxNV9NTUFQX09GRlNFVF9VQyAgMworCisJLyoKKwkgKiBaZXJvLXRlcm1pbmF0ZWQgY2hh
aW4gb2YgZXh0ZW5zaW9ucy4KKwkgKgorCSAqIE5vIGN1cnJlbnQgZXh0ZW5zaW9ucyBkZWZpbmVk
OyBtYnouCisJICovCisJX191NjQgZXh0ZW5zaW9uczsKK307CisKIHN0cnVjdCBkcm1faTkxNV9n
ZW1fc2V0X2RvbWFpbiB7CiAJLyoqIEhhbmRsZSBmb3IgdGhlIG9iamVjdCAqLwogCV9fdTMyIGhh
bmRsZTsKLS0gCjIuMjQuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50
ZWwtZ2Z4

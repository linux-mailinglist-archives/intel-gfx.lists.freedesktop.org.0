Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 11EA28064F
	for <lists+intel-gfx@lfdr.de>; Sat,  3 Aug 2019 15:29:24 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CD5856E4CF;
	Sat,  3 Aug 2019 13:29:21 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 011956E4CF
 for <intel-gfx@lists.freedesktop.org>; Sat,  3 Aug 2019 13:29:19 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17842675-1500050 
 for multiple; Sat, 03 Aug 2019 14:29:01 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sat,  3 Aug 2019 14:29:00 +0100
Message-Id: <20190803132900.24826-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0.rc1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/pmu: Use GT parked for estimating RC6
 while asleep
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgd2UgdHJhY2sgd2hlbiB3ZSBwdXQgdGhlIEdUIGRldmljZSB0byBzbGVlcCB1cG9uIGlkbGlu
Zywgd2UgY2FuIHVzZQp0aGF0IGNhbGxiYWNrIHRvIHNhbXBsZSB0aGUgY3VycmVudCByYzYgY291
bnRlcnMgYW5kIHJlY29yZCB0aGUKdGltZXN0YW1wIGZvciBlc3RpbWF0aW5nIHNhbXBsZXMgYWZ0
ZXIgdGhhdCBwb2ludCB3aGlsZSBhc2xlZXAuCgp2MjogU3RpY2sgdG8gdXNpbmcga3RpbWVfdAoK
QnVnemlsbGE6IGh0dHBzOi8vYnVncy5mcmVlZGVza3RvcC5vcmcvc2hvd19idWcuY2dpP2lkPTEw
NTAxMApTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51
az4KQ2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+Ci0tLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgfCAgMjEgKysrLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfcG11LmMgICAgIHwgMTIwICsrKysrKysrKysrKysrLS0tLS0tLS0tLS0t
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmggICAgIHwgICA0ICstCiAzIGZpbGVz
IGNoYW5nZWQsIDY5IGluc2VydGlvbnMoKyksIDc2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggMTlmMTU2YTdmNTAxLi44MGRhNTliNWExYjAgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC0zOSw2ICszOSw3IEBACiAjaW5jbHVkZSAi
ZGlzcGxheS9pbnRlbF9wc3IuaCIKIAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jb250ZXh0Lmgi
CisjaW5jbHVkZSAiZ3QvaW50ZWxfZ3RfcG0uaCIKICNpbmNsdWRlICJndC9pbnRlbF9yZXNldC5o
IgogI2luY2x1ZGUgImd0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmgiCiAKQEAgLTQwNjMsMTMg
KzQwNjQsMTEgQEAgc3RhdGljIGludCBpOTE1X3NzZXVfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqdW51c2VkKQogc3RhdGljIGludCBpOTE1X2ZvcmNld2FrZV9vcGVuKHN0cnVjdCBp
bm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gaW5vZGUtPmlfcHJpdmF0ZTsKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gJmk5
MTUtPmd0OwogCi0JaWYgKElOVEVMX0dFTihpOTE1KSA8IDYpCi0JCXJldHVybiAwOwotCi0JZmls
ZS0+cHJpdmF0ZV9kYXRhID0KLQkJKHZvaWQgKikodWludHB0cl90KWludGVsX3J1bnRpbWVfcG1f
Z2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3VzZXJfZ2V0
KCZpOTE1LT51bmNvcmUpOworCWludGVsX2d0X3BtX2dldChndCk7CisJaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA2KQorCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3VzZXJfZ2V0KGd0LT51bmNvcmUp
OwogCiAJcmV0dXJuIDA7CiB9CkBAIC00MDc3LDEzICs0MDc2LDExIEBAIHN0YXRpYyBpbnQgaTkx
NV9mb3JjZXdha2Vfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkK
IHN0YXRpYyBpbnQgaTkxNV9mb3JjZXdha2VfcmVsZWFzZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBz
dHJ1Y3QgZmlsZSAqZmlsZSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGlu
b2RlLT5pX3ByaXZhdGU7CisJc3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKIAotCWlm
IChJTlRFTF9HRU4oaTkxNSkgPCA2KQotCQlyZXR1cm4gMDsKLQotCWludGVsX3VuY29yZV9mb3Jj
ZXdha2VfdXNlcl9wdXQoJmk5MTUtPnVuY29yZSk7Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5
MTUtPnJ1bnRpbWVfcG0sCi0JCQkgICAgIChpbnRlbF93YWtlcmVmX3QpKHVpbnRwdHJfdClmaWxl
LT5wcml2YXRlX2RhdGEpOworCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKKwkJaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV91c2VyX3B1dCgmaTkxNS0+dW5jb3JlKTsKKwlpbnRlbF9ndF9wbV9wdXQo
Z3QpOwogCiAJcmV0dXJuIDA7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3BtdS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYwppbmRleCBjMmU1ZjZk
NWMxZTAuLjYxZDRmYTk5ZTQxMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wbXUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jCkBAIC0xMTUsMTkg
KzExNSw1MSBAQCBzdGF0aWMgYm9vbCBwbXVfbmVlZHNfdGltZXIoc3RydWN0IGk5MTVfcG11ICpw
bXUsIGJvb2wgZ3B1X2FjdGl2ZSkKIAlyZXR1cm4gZW5hYmxlOwogfQogCitzdGF0aWMgdTY0IF9f
Z2V0X3JjNihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gZ3QtPmk5MTU7CisJdTY0IHZhbDsKKworCXZhbCA9IGludGVsX3JjNl9yZXNpZGVu
Y3lfbnMoaTkxNSwKKwkJCQkgICAgIElTX1ZBTExFWVZJRVcoaTkxNSkgPworCQkJCSAgICAgVkxW
X0dUX1JFTkRFUl9SQzYgOgorCQkJCSAgICAgR0VONl9HVF9HRlhfUkM2KTsKKworCWlmIChIQVNf
UkM2cChpOTE1KSkKKwkJdmFsICs9IGludGVsX3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwgR0VONl9H
VF9HRlhfUkM2cCk7CisKKwlpZiAoSEFTX1JDNnBwKGk5MTUpKQorCQl2YWwgKz0gaW50ZWxfcmM2
X3Jlc2lkZW5jeV9ucyhpOTE1LCBHRU42X0dUX0dGWF9SQzZwcCk7CisKKwlyZXR1cm4gdmFsOwor
fQorCiB2b2lkIGk5MTVfcG11X2d0X3BhcmtlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKIHsKIAlzdHJ1Y3QgaTkxNV9wbXUgKnBtdSA9ICZpOTE1LT5wbXU7CisJdTY0IHZhbDsKIAog
CWlmICghcG11LT5iYXNlLmV2ZW50X2luaXQpCiAJCXJldHVybjsKIAogCXNwaW5fbG9ja19pcnEo
JnBtdS0+bG9jayk7CisKKwl2YWwgPSAwOworCWlmIChwbXUtPnNhbXBsZVtfX0k5MTVfU0FNUExF
X1JDNl0uY3VyKQorCQl2YWwgPSBfX2dldF9yYzYoJmk5MTUtPmd0KTsKKworCWlmICh2YWwgPj0g
cG11LT5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZfRVNUSU1BVEVEXS5jdXIpIHsKKwkJcG11LT5z
YW1wbGVbX19JOTE1X1NBTVBMRV9SQzZfRVNUSU1BVEVEXS5jdXIgPSAwOworCQlwbXUtPnNhbXBs
ZVtfX0k5MTVfU0FNUExFX1JDNl0uY3VyID0gdmFsOworCX0KKwlwbXUtPnNsZWVwX2xhc3QgPSBr
dGltZV9nZXQoKTsKKwogCS8qCiAJICogU2lnbmFsIHNhbXBsaW5nIHRpbWVyIHRvIHN0b3AgaWYg
b25seSBlbmdpbmUgZXZlbnRzIGFyZSBlbmFibGVkIGFuZAogCSAqIEdQVSB3ZW50IGlkbGUuCiAJ
ICovCiAJcG11LT50aW1lcl9lbmFibGVkID0gcG11X25lZWRzX3RpbWVyKHBtdSwgZmFsc2UpOwor
CiAJc3Bpbl91bmxvY2tfaXJxKCZwbXUtPmxvY2spOwogfQogCkBAIC0xNDIsNiArMTc0LDExIEBA
IHN0YXRpYyB2b2lkIF9faTkxNV9wbXVfbWF5YmVfc3RhcnRfdGltZXIoc3RydWN0IGk5MTVfcG11
ICpwbXUpCiAJfQogfQogCitzdGF0aWMgaW5saW5lIHM2NCBrdGltZV9zaW5jZShjb25zdCBrdGlt
ZV90IGt0KQoreworCXJldHVybiBrdGltZV90b19ucyhrdGltZV9zdWIoa3RpbWVfZ2V0KCksIGt0
KSk7Cit9CisKIHZvaWQgaTkxNV9wbXVfZ3RfdW5wYXJrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCiB7CiAJc3RydWN0IGk5MTVfcG11ICpwbXUgPSAmaTkxNS0+cG11OwpAQCAtMTUw
LDEwICsxODcsMjIgQEAgdm9pZCBpOTE1X3BtdV9ndF91bnBhcmtlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKIAkJcmV0dXJuOwogCiAJc3Bpbl9sb2NrX2lycSgmcG11LT5sb2NrKTsK
KwogCS8qCiAJICogUmUtZW5hYmxlIHNhbXBsaW5nIHRpbWVyIHdoZW4gR1BVIGdvZXMgYWN0aXZl
LgogCSAqLwogCV9faTkxNV9wbXVfbWF5YmVfc3RhcnRfdGltZXIocG11KTsKKworCS8qIEVzdGlt
YXRlIGhvdyBsb25nIHdlIHNsZXB0IGFuZCBhY2N1bXVsYXRlIHRoYXQgaW50byByYzYgY291bnRl
cnMgKi8KKwlpZiAocG11LT5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZdLmN1cikgeworCQl1NjQg
dmFsOworCisJCXZhbCA9IGt0aW1lX3NpbmNlKHBtdS0+c2xlZXBfbGFzdCk7CisJCXZhbCArPSBw
bXUtPnNhbXBsZVtfX0k5MTVfU0FNUExFX1JDNl0uY3VyOworCisJCXBtdS0+c2FtcGxlW19fSTkx
NV9TQU1QTEVfUkM2X0VTVElNQVRFRF0uY3VyID0gdmFsOworCX0KKwogCXNwaW5fdW5sb2NrX2ly
cSgmcG11LT5sb2NrKTsKIH0KIApAQCAtNDI1LDM5ICs0NzQsMTggQEAgc3RhdGljIGludCBpOTE1
X3BtdV9ldmVudF9pbml0KHN0cnVjdCBwZXJmX2V2ZW50ICpldmVudCkKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIHU2NCBfX2dldF9yYzYoc3RydWN0IGludGVsX2d0ICpndCkKLXsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1OwotCXU2NCB2YWw7Ci0KLQl2YWwgPSBp
bnRlbF9yYzZfcmVzaWRlbmN5X25zKGk5MTUsCi0JCQkJICAgICBJU19WQUxMRVlWSUVXKGk5MTUp
ID8KLQkJCQkgICAgIFZMVl9HVF9SRU5ERVJfUkM2IDoKLQkJCQkgICAgIEdFTjZfR1RfR0ZYX1JD
Nik7Ci0KLQlpZiAoSEFTX1JDNnAoaTkxNSkpCi0JCXZhbCArPSBpbnRlbF9yYzZfcmVzaWRlbmN5
X25zKGk5MTUsIEdFTjZfR1RfR0ZYX1JDNnApOwotCi0JaWYgKEhBU19SQzZwcChpOTE1KSkKLQkJ
dmFsICs9IGludGVsX3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwgR0VONl9HVF9HRlhfUkM2cHApOwot
Ci0JcmV0dXJuIHZhbDsKLX0KLQogc3RhdGljIHU2NCBnZXRfcmM2KHN0cnVjdCBpbnRlbF9ndCAq
Z3QpCiB7Ci0jaWYgSVNfRU5BQkxFRChDT05GSUdfUE0pCiAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUgPSBndC0+aTkxNTsKLQlzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtID0gJmk5
MTUtPnJ1bnRpbWVfcG07CiAJc3RydWN0IGk5MTVfcG11ICpwbXUgPSAmaTkxNS0+cG11OwotCWlu
dGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAJdTY0IHZhbDsK
IAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UocnBtKTsKLQlpZiAo
d2FrZXJlZikgeworCXNwaW5fbG9ja19pcnFzYXZlKCZwbXUtPmxvY2ssIGZsYWdzKTsKKworCWlm
IChpbnRlbF9ndF9wbV9nZXRfaWZfYXdha2UoZ3QpKSB7CiAJCXZhbCA9IF9fZ2V0X3JjNihndCk7
Ci0JCWludGVsX3J1bnRpbWVfcG1fcHV0KHJwbSwgd2FrZXJlZik7CisJCWludGVsX2d0X3BtX3B1
dChndCk7CiAKIAkJLyoKIAkJICogSWYgd2UgYXJlIGNvbWluZyBiYWNrIGZyb20gYmVpbmcgcnVu
dGltZSBzdXNwZW5kZWQgd2UgbXVzdApAQCAtNDY1LDE5ICs0OTMsMTMgQEAgc3RhdGljIHU2NCBn
ZXRfcmM2KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJCSAqIHByZXZpb3VzbHkuCiAJCSAqLwogCi0J
CXNwaW5fbG9ja19pcnFzYXZlKCZwbXUtPmxvY2ssIGZsYWdzKTsKLQogCQlpZiAodmFsID49IHBt
dS0+c2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2X0VTVElNQVRFRF0uY3VyKSB7CiAJCQlwbXUtPnNh
bXBsZVtfX0k5MTVfU0FNUExFX1JDNl9FU1RJTUFURURdLmN1ciA9IDA7CiAJCQlwbXUtPnNhbXBs
ZVtfX0k5MTVfU0FNUExFX1JDNl0uY3VyID0gdmFsOwogCQl9IGVsc2UgewogCQkJdmFsID0gcG11
LT5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZfRVNUSU1BVEVEXS5jdXI7CiAJCX0KLQotCQlzcGlu
X3VubG9ja19pcnFyZXN0b3JlKCZwbXUtPmxvY2ssIGZsYWdzKTsKIAl9IGVsc2UgewotCQlzdHJ1
Y3QgZGV2aWNlICprZGV2ID0gcnBtLT5rZGV2OwotCiAJCS8qCiAJCSAqIFdlIGFyZSBydW50aW1l
IHN1c3BlbmRlZC4KIAkJICoKQEAgLTQ4NSw0MiArNTA3LDE2IEBAIHN0YXRpYyB1NjQgZ2V0X3Jj
NihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCQkgKiBvbiB0b3Agb2YgdGhlIGxhc3Qga25vd24gcmVh
bCB2YWx1ZSwgYXMgdGhlIGFwcHJveGltYXRlZCBSQzYKIAkJICogY291bnRlciB2YWx1ZS4KIAkJ
ICovCi0JCXNwaW5fbG9ja19pcnFzYXZlKCZwbXUtPmxvY2ssIGZsYWdzKTsKIAotCQkvKgotCQkg
KiBBZnRlciB0aGUgYWJvdmUgYnJhbmNoIGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZSBm
YWlsZWQKLQkJICogdG8gZ2V0IHRoZSBydW50aW1lIFBNIHJlZmVyZW5jZSB3ZSBjYW5ub3QgYXNz
dW1lIHdlIGFyZSBpbgotCQkgKiBydW50aW1lIHN1c3BlbmQgc2luY2Ugd2UgY2FuIGVpdGhlcjog
YSkgcmFjZSB3aXRoIGNvbWluZyBvdXQKLQkJICogb2YgaXQgYmVmb3JlIHdlIHRvb2sgdGhlIHBv
d2VyLmxvY2ssIG9yIGIpIHRoZXJlIGFyZSBvdGhlcgotCQkgKiBzdGF0ZXMgdGhhbiBzdXNwZW5k
ZWQgd2hpY2ggY2FuIGJyaW5nIHVzIGhlcmUuCi0JCSAqCi0JCSAqIFdlIG5lZWQgdG8gZG91Ymxl
LWNoZWNrIHRoYXQgd2UgYXJlIGluZGVlZCBjdXJyZW50bHkgcnVudGltZQotCQkgKiBzdXNwZW5k
ZWQgYW5kIGlmIG5vdCB3ZSBjYW5ub3QgZG8gYmV0dGVyIHRoYW4gcmVwb3J0IHRoZSBsYXN0Ci0J
CSAqIGtub3duIFJDNiB2YWx1ZS4KLQkJICovCi0JCWlmIChwbV9ydW50aW1lX3N0YXR1c19zdXNw
ZW5kZWQoa2RldikpIHsKLQkJCXZhbCA9IHBtX3J1bnRpbWVfc3VzcGVuZGVkX3RpbWUoa2Rldik7
CisJCXZhbCA9IGt0aW1lX3NpbmNlKHBtdS0+c2xlZXBfbGFzdCk7CisJCXZhbCArPSBwbXUtPnNh
bXBsZVtfX0k5MTVfU0FNUExFX1JDNl0uY3VyOwogCi0JCQlpZiAoIXBtdS0+c2FtcGxlW19fSTkx
NV9TQU1QTEVfUkM2X0VTVElNQVRFRF0uY3VyKQotCQkJCXBtdS0+c3VzcGVuZGVkX3RpbWVfbGFz
dCA9IHZhbDsKLQotCQkJdmFsIC09IHBtdS0+c3VzcGVuZGVkX3RpbWVfbGFzdDsKLQkJCXZhbCAr
PSBwbXUtPnNhbXBsZVtfX0k5MTVfU0FNUExFX1JDNl0uY3VyOwotCi0JCQlwbXUtPnNhbXBsZVtf
X0k5MTVfU0FNUExFX1JDNl9FU1RJTUFURURdLmN1ciA9IHZhbDsKLQkJfSBlbHNlIGlmIChwbXUt
PnNhbXBsZVtfX0k5MTVfU0FNUExFX1JDNl9FU1RJTUFURURdLmN1cikgewotCQkJdmFsID0gcG11
LT5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZfRVNUSU1BVEVEXS5jdXI7Ci0JCX0gZWxzZSB7Ci0J
CQl2YWwgPSBwbXUtPnNhbXBsZVtfX0k5MTVfU0FNUExFX1JDNl0uY3VyOwotCQl9Ci0KLQkJc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmcG11LT5sb2NrLCBmbGFncyk7CisJCXBtdS0+c2FtcGxlW19f
STkxNV9TQU1QTEVfUkM2X0VTVElNQVRFRF0uY3VyID0gdmFsOwogCX0KIAorCXNwaW5fdW5sb2Nr
X2lycXJlc3RvcmUoJnBtdS0+bG9jaywgZmxhZ3MpOworCiAJcmV0dXJuIHZhbDsKLSNlbHNlCi0J
cmV0dXJuIF9fZ2V0X3JjNihndCk7Ci0jZW5kaWYKIH0KIAogc3RhdGljIHU2NCBfX2k5MTVfcG11
X2V2ZW50X3JlYWQoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11
LmgKaW5kZXggNGZjNGYyNDc4MzAxLi4wNjdkYmJmM2JkZmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfcG11LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9w
bXUuaApAQCAtOTcsOSArOTcsOSBAQCBzdHJ1Y3QgaTkxNV9wbXUgewogCSAqLwogCXN0cnVjdCBp
OTE1X3BtdV9zYW1wbGUgc2FtcGxlW19fSTkxNV9OVU1fUE1VX1NBTVBMRVJTXTsKIAkvKioKLQkg
KiBAc3VzcGVuZGVkX3RpbWVfbGFzdDogQ2FjaGVkIHN1c3BlbmQgdGltZSBmcm9tIFBNIGNvcmUu
CisJICogQHNsZWVwX2xhc3Q6IExhc3QgdGltZSBHVCBwYXJrZWQgZm9yIFJDNiBlc3RpbWF0aW9u
LgogCSAqLwotCXU2NCBzdXNwZW5kZWRfdGltZV9sYXN0OworCWt0aW1lX3Qgc2xlZXBfbGFzdDsK
IAkvKioKIAkgKiBAaTkxNV9hdHRyOiBNZW1vcnkgYmxvY2sgaG9sZGluZyBkZXZpY2UgYXR0cmli
dXRlcy4KIAkgKi8KLS0gCjIuMjMuMC5yYzEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2ludGVsLWdmeA==

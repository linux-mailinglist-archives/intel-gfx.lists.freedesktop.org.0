Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id DC12A1FB40C
	for <lists+intel-gfx@lfdr.de>; Tue, 16 Jun 2020 16:19:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E4B4D6E8D0;
	Tue, 16 Jun 2020 14:19:10 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 417096E8C8
 for <intel-gfx@lists.freedesktop.org>; Tue, 16 Jun 2020 14:19:05 +0000 (UTC)
IronPort-SDR: JqHltPSU7EkpXmTm1qsgXvJnaSFY4hNU27O8P+V6J+jIYQ7XvDvfi+JRAHOltLYs6JVpEzVRV9
 bAVuMLVH09VQ==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by orsmga106.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 16 Jun 2020 07:19:05 -0700
IronPort-SDR: UaZt6UMEUie9aQeSozkyr+vVQfFEtdmcpbuT9rX2+RiL8ecqkAgNALJecI2n272XJL16l6OaE3
 yf9YBLg3etMg==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.73,518,1583222400"; d="scan'208";a="273165003"
Received: from ideak-desk.fi.intel.com ([10.237.72.183])
 by orsmga003.jf.intel.com with ESMTP; 16 Jun 2020 07:19:04 -0700
From: Imre Deak <imre.deak@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 16 Jun 2020 17:18:52 +0300
Message-Id: <20200616141855.746-3-imre.deak@intel.com>
X-Mailer: git-send-email 2.23.1
In-Reply-To: <20200616141855.746-1-imre.deak@intel.com>
References: <20200616141855.746-1-imre.deak@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 3/6] drm/i915/dp_mst: Move clearing the ACT sent
 flag closer to its polling
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RHVyaW5nIHRyYW5zY29kZXIgZW5hYmxpbmcgd2UnbGwgY29uZmlndXJlIHRoZSB0cmFuc2NvZGVy
IGluIE1TVCBtb2RlCmFuZCBlbmFibGUgdGhlIFZDIHBheWxvYWQgYWxsb2NhdGlvbiwgd2hpY2gg
d2lsbCBzdGFydCB0aGUgQUNUIHNlcXVlbmNlLgpCZWZvcmUgd2FpdGluZyBmb3IgdGhlIEFDVCBz
ZXF1ZW5jZSBjb21wbGV0aW9uLCB3ZSBuZWVkIHRvIGNsZWFyIHRoZSBBQ1QKc2VudCBmbGFnLCBi
dXQgYmFzZWQgb24gdGhlIGFib3ZlIHdlIGNhbiBkbyB0aGlzIHJpZ2h0IGJlZm9yZSBlbmFibGlu
Zwp0aGUgdHJhbnNjb2Rlci4KCkZvciBjbGFyaXR5LCBtb3ZlIHRoZSBmbGFnIGNsZWFyaW5nIGNs
b3NlciB0byB3aGVyZSB3ZSB3YWl0IGZvciBpdC4KCldoaWxlIGF0IGl0IGFsc28gZmFjdG9yIG91
dCBzb21lIGNvbW1vbiBjb2RlLgoKQ2M6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBs
aW51eC5pbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IEltcmUgRGVhayA8aW1yZS5kZWFrQGludGVs
LmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwX21zdC5jIHwg
MzYgKysrKysrKysrKysrKy0tLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgMjMgaW5zZXJ0aW9ucygr
KSwgMTMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kcF9tc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZHBfbXN0LmMKaW5kZXggMmU2YzYzNzVhMjNiLi4zOTc3ZWU0ZjcxNzYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBfbXN0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9tc3QuYwpAQCAtMzE3LDYgKzMxNywyNSBAQCBp
bnRlbF9kcF9tc3RfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3Is
CiAJcmV0dXJuIHJldDsKIH0KIAorc3RhdGljIHZvaWQgY2xlYXJfYWN0X3NlbnQoc3RydWN0IGlu
dGVsX2RwICppbnRlbF9kcCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGRw
X3RvX2k5MTUoaW50ZWxfZHApOworCisJaW50ZWxfZGVfd3JpdGUoaTkxNSwgaW50ZWxfZHAtPnJl
Z3MuZHBfdHBfc3RhdHVzLAorCQkgICAgICAgaW50ZWxfZGVfcmVhZChpOTE1LCBpbnRlbF9kcC0+
cmVncy5kcF90cF9zdGF0dXMpKTsKK30KKworc3RhdGljIHZvaWQgd2FpdF9mb3JfYWN0X3NlbnQo
c3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IGRwX3RvX2k5MTUoaW50ZWxfZHApOworCisJaWYgKGludGVsX2RlX3dhaXRfZm9yX3Nl
dChpOTE1LCBpbnRlbF9kcC0+cmVncy5kcF90cF9zdGF0dXMsCisJCQkJICBEUF9UUF9TVEFUVVNf
QUNUX1NFTlQsIDEpKQorCQlkcm1fZXJyKCZpOTE1LT5kcm0sICJUaW1lZCBvdXQgd2FpdGluZyBm
b3IgQUNUIHNlbnRcbiIpOworCisJZHJtX2RwX2NoZWNrX2FjdF9zdGF0dXMoJmludGVsX2RwLT5t
c3RfbWdyKTsKK30KKwogc3RhdGljIHZvaWQgaW50ZWxfbXN0X2Rpc2FibGVfZHAoc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAogCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUs
CkBAIC0zNzcsMTEgKzM5Niw3IEBAIHN0YXRpYyB2b2lkIGludGVsX21zdF9wb3N0X2Rpc2FibGVf
ZHAoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJCSAgICAgICBUUkFOU19ERElf
RlVOQ19DVEwob2xkX2NydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKSwKIAkJICAgICAgIHZhbCk7
CiAKLQlpZiAoaW50ZWxfZGVfd2FpdF9mb3Jfc2V0KGRldl9wcml2LCBpbnRlbF9kcC0+cmVncy5k
cF90cF9zdGF0dXMsCi0JCQkJICBEUF9UUF9TVEFUVVNfQUNUX1NFTlQsIDEpKQotCQlkcm1fZXJy
KCZkZXZfcHJpdi0+ZHJtLAotCQkJIlRpbWVkIG91dCB3YWl0aW5nIGZvciBBQ1Qgc2VudCB3aGVu
IGRpc2FibGluZ1xuIik7Ci0JZHJtX2RwX2NoZWNrX2FjdF9zdGF0dXMoJmludGVsX2RwLT5tc3Rf
bWdyKTsKKwl3YWl0X2Zvcl9hY3Rfc2VudChpbnRlbF9kcCk7CiAKIAlkcm1fZHBfbXN0X2RlYWxs
b2NhdGVfdmNwaSgmaW50ZWxfZHAtPm1zdF9tZ3IsIGNvbm5lY3Rvci0+cG9ydCk7CiAKQEAgLTQ1
Miw3ICs0NjcsNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tc3RfcHJlX2VuYWJsZV9kcChzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKIAlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25u
ZWN0b3IgPQogCQl0b19pbnRlbF9jb25uZWN0b3IoY29ubl9zdGF0ZS0+Y29ubmVjdG9yKTsKIAlp
bnQgcmV0OwotCXUzMiB0ZW1wOwogCWJvb2wgZmlyc3RfbXN0X3N0cmVhbTsKIAogCS8qIE1TVCBl
bmNvZGVycyBhcmUgYm91bmQgdG8gYSBjcnRjLCBub3QgdG8gYSBjb25uZWN0b3IsCkBAIC00ODUs
OCArNDk5LDYgQEAgc3RhdGljIHZvaWQgaW50ZWxfbXN0X3ByZV9lbmFibGVfZHAoc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJCWRybV9lcnIoJmRldl9wcml2LT5kcm0sICJmYWls
ZWQgdG8gYWxsb2NhdGUgdmNwaVxuIik7CiAKIAlpbnRlbF9kcC0+YWN0aXZlX21zdF9saW5rcysr
OwotCXRlbXAgPSBpbnRlbF9kZV9yZWFkKGRldl9wcml2LCBpbnRlbF9kcC0+cmVncy5kcF90cF9z
dGF0dXMpOwotCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBpbnRlbF9kcC0+cmVncy5kcF90cF9z
dGF0dXMsIHRlbXApOwogCiAJcmV0ID0gZHJtX2RwX3VwZGF0ZV9wYXlsb2FkX3BhcnQxKCZpbnRl
bF9kcC0+bXN0X21ncik7CiAKQEAgLTUxNywxNiArNTI5LDE0IEBAIHN0YXRpYyB2b2lkIGludGVs
X21zdF9lbmFibGVfZHAoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAKIAlkcm1f
V0FSTl9PTigmZGV2X3ByaXYtPmRybSwgcGlwZV9jb25maWctPmhhc19wY2hfZW5jb2Rlcik7CiAK
KwljbGVhcl9hY3Rfc2VudChpbnRlbF9kcCk7CisKIAlpbnRlbF9kZGlfZW5hYmxlX3RyYW5zY29k
ZXJfZnVuYyhlbmNvZGVyLCBwaXBlX2NvbmZpZyk7CiAKIAlkcm1fZGJnX2ttcygmZGV2X3ByaXYt
PmRybSwgImFjdGl2ZSBsaW5rcyAlZFxuIiwKIAkJICAgIGludGVsX2RwLT5hY3RpdmVfbXN0X2xp
bmtzKTsKIAotCWlmIChpbnRlbF9kZV93YWl0X2Zvcl9zZXQoZGV2X3ByaXYsIGludGVsX2RwLT5y
ZWdzLmRwX3RwX3N0YXR1cywKLQkJCQkgIERQX1RQX1NUQVRVU19BQ1RfU0VOVCwgMSkpCi0JCWRy
bV9lcnIoJmRldl9wcml2LT5kcm0sICJUaW1lZCBvdXQgd2FpdGluZyBmb3IgQUNUIHNlbnRcbiIp
OwotCi0JZHJtX2RwX2NoZWNrX2FjdF9zdGF0dXMoJmludGVsX2RwLT5tc3RfbWdyKTsKKwl3YWl0
X2Zvcl9hY3Rfc2VudChpbnRlbF9kcCk7CiAKIAlkcm1fZHBfdXBkYXRlX3BheWxvYWRfcGFydDIo
JmludGVsX2RwLT5tc3RfbWdyKTsKIAotLSAKMi4yMy4xCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdm
eEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9pbnRlbC1nZngK

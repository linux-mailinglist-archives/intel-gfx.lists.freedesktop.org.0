Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A5D4242ED6
	for <lists+intel-gfx@lfdr.de>; Wed, 12 Jun 2019 20:38:20 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 947818982F;
	Wed, 12 Jun 2019 18:38:18 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 928E48982F
 for <intel-gfx@lists.freedesktop.org>; Wed, 12 Jun 2019 18:38:15 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by fmsmga102.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 12 Jun 2019 11:38:15 -0700
X-ExtLoop1: 1
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by fmsmga005.fm.intel.com with ESMTP; 12 Jun 2019 11:38:15 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 12 Jun 2019 11:37:45 -0700
Message-Id: <20190612183748.7693-7-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190612183748.7693-1-daniele.ceraolospurio@intel.com>
References: <20190612183748.7693-1-daniele.ceraolospurio@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2 6/8] drm/i915: update rpm_get/put to use the
 rpm structure
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIGZ1bmN0aW9ucyB3aGVyZSBpbnRlcm5hbGx5IGFscmVhZHkgb25seSB1c2luZyB0aGUgc3Ry
dWN0dXJlLCBzbyB3ZQpuZWVkIHRvIGp1c3QgZmxpcCB0aGUgaW50ZXJmYWNlLgoKdjI6IHJlYmFz
ZQoKU2lnbmVkLW9mZi1ieTogRGFuaWVsZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5jZXJhb2xv
c3B1cmlvQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
bW1hbi5jICAgICAgfCAxMSArKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X29iamVjdC5jICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9z
aHJpbmtlci5jICB8ICA0ICstCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9w
YWdlcy5jICAgfCAgNCArLQogLi4uL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb2hlcmVu
Y3kuYyAgIHwgIDQgKy0KIC4uLi9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRl
eHQuYyB8IDEyICsrLS0tCiAuLi4vZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFu
LmMgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMg
ICAgIHwgIDggKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYyAg
ICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyAgICAgICAg
IHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jICB8
IDEyICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyAgICAgICAg
fCAzNiArKysrKysrLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmVz
ZXQuYyAgICAgIHwgIDQgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3Vu
ZHMuYyAgICB8IDEyICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvYXBlcnR1cmVfZ20u
YyAgICAgICAgfCAxNSArKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuaCAgICAg
ICAgICAgICAgICB8ICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWRfcG9saWN5
LmMgICAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jICAg
ICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jICAgICAg
ICAgICB8IDQ5ICsrKysrKysrKystLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2VtLmMgICAgICAgICAgICAgICB8IDE1ICsrKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9nZW1fZmVuY2VfcmVnLmMgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2VtX2d0dC5jICAgICAgICAgICB8ICA2ICstLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9w
ZXJmLmMgICAgICAgICAgICAgIHwgIDYgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Bt
dS5jICAgICAgICAgICAgICAgfCAxMiArKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9z
eXNmcy5jICAgICAgICAgICAgIHwgMTIgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2Rpc3BsYXkuYyAgICAgICAgICB8IDEyICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9kaXNwbGF5X3Bvd2VyLmMgICAgfCAzNyArKysrKysrLS0tLS0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfZmJkZXYuYyAgICAgICAgICAgIHwgIDYgKy0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9ob3RwbHVnLmMgICAgICAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfcnVudGltZV9wbS5jICAgICAgIHwgNDMgKysrKysrKy0tLS0tLS0tLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGltZV9wbS5oICAgICAgIHwgMjYgKysrKystLS0tLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfd2FrZXJlZi5jICAgICAgICAgIHwgIDggKy0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYyAgfCAgOCArLS0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbS5jICAgICB8ICA0ICstCiAuLi4v
Z3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jICAgfCAgNCArLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jIHwgIDggKy0tCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9yZXF1ZXN0LmMgfCAyMCArKysrLS0tLQogLi4u
L2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV90aW1lbGluZS5jICAgIHwgMTYgKysrLS0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYyAgICAgfCAgNCArLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX2d1Yy5jICAgIHwgIDggKy0tCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfdW5jb3JlLmMgfCAgNCArLQogNDEgZmls
ZXMgY2hhbmdlZCwgMjM0IGluc2VydGlvbnMoKyksIDIzMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYwppbmRleCBjYWE2MWYwOWY3MTQuLjhkZjc5
MDBlMzQzNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21t
YW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5jCkBAIC0y
MjIsNiArMjIyLDcgQEAgdm1fZmF1bHRfdCBpOTE1X2dlbV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQg
KnZtZikKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gdG9faW50ZWxfYm8oYXJl
YS0+dm1fcHJpdmF0ZV9kYXRhKTsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gb2JqLT5iYXNl
LmRldjsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKKwlz
dHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtID0gJmk5MTUtPnJ1bnRpbWVfcG07CiAJc3RydWN0
IGk5MTVfZ2d0dCAqZ2d0dCA9ICZpOTE1LT5nZ3R0OwogCWJvb2wgd3JpdGUgPSBhcmVhLT52bV9m
bGFncyAmIFZNX1dSSVRFOwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwpAQCAtMjQzLDcgKzI0
NCw3IEBAIHZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiAJ
aWYgKHJldCkKIAkJZ290byBlcnI7CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQo
aTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KHJwbSk7CiAKIAlzcmN1ID0g
aTkxNV9yZXNldF90cnlsb2NrKGk5MTUpOwogCWlmIChzcmN1IDwgMCkgewpAQCAtMzA4LDcgKzMw
OSw3IEBAIHZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiAJ
CWdvdG8gZXJyX2ZlbmNlOwogCiAJLyogTWFyayBhcyBiZWluZyBtbWFwcGVkIGludG8gdXNlcnNw
YWNlIGZvciBsYXRlciByZXZvY2F0aW9uICovCi0JYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKCZp
OTE1LT5ydW50aW1lX3BtKTsKKwlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQocnBtKTsKIAlpZiAo
IWk5MTVfdm1hX3NldF91c2VyZmF1bHQodm1hKSAmJiAhb2JqLT51c2VyZmF1bHRfY291bnQrKykK
IAkJbGlzdF9hZGQoJm9iai0+dXNlcmZhdWx0X2xpbmssICZpOTE1LT5tbS51c2VyZmF1bHRfbGlz
dCk7CiAJaWYgKENPTkZJR19EUk1fSTkxNV9VU0VSRkFVTFRfQVVUT1NVU1BFTkQpCkBAIC0zMjcs
NyArMzI4LDcgQEAgdm1fZmF1bHRfdCBpOTE1X2dlbV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZt
ZikKIGVycl9yZXNldDoKIAlpOTE1X3Jlc2V0X3VubG9jayhpOTE1LCBzcmN1KTsKIGVycl9ycG06
Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9w
bV9wdXQocnBtLCB3YWtlcmVmKTsKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMob2JqKTsK
IGVycjoKIAlzd2l0Y2ggKHJldCkgewpAQCAtNDEwLDcgKzQxMSw3IEBAIHZvaWQgaTkxNV9nZW1f
b2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCSAq
IHdha2VyZWYuCiAJICovCiAJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYg
PSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAlpZiAoIW9iai0+
dXNlcmZhdWx0X2NvdW50KQogCQlnb3RvIG91dDsKQEAgLTQyNyw3ICs0MjgsNyBAQCB2b2lkIGk5
MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aikKIAl3bWIoKTsKIAogb3V0OgotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYp
OworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIH0K
IAogc3RhdGljIGludCBjcmVhdGVfbW1hcF9vZmZzZXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9v
YmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYwppbmRl
eCBkMDJhMWFmZjIwNTguLjRiNmYxNGVjYjI3MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9vYmplY3QuYwpAQCAtMTgxLDcgKzE4MSw3IEBAIHN0YXRpYyB2b2lkIF9faTkx
NV9nZW1fZnJlZV9vYmplY3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCXN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosICpvbjsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJl
ZjsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0g
aW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCWxsaXN0X2Zvcl9lYWNo
X2VudHJ5X3NhZmUob2JqLCBvbiwgZnJlZWQsIGZyZWVkKSB7CiAJCXN0cnVjdCBpOTE1X3ZtYSAq
dm1hLCAqdm47CiAKQEAgLTI0Myw3ICsyNDMsNyBAQCBzdGF0aWMgdm9pZCBfX2k5MTVfZ2VtX2Zy
ZWVfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAogCQljb25kX3Jlc2No
ZWQoKTsKIAl9Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxf
cnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogfQogCiB2b2lkIGk5
MTVfZ2VtX2ZsdXNoX2ZyZWVfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJpbmtlci5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Nocmlua2VyLmMKaW5kZXggNzBh
NGM5ZDNjMDk4Li45NjFjYTUzYzg5NzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9zaHJpbmtlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9zaHJpbmtlci5jCkBAIC0xODAsNyArMTgwLDcgQEAgaTkxNV9nZW1fc2hyaW5rKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCSAqIHdlIHdpbGwgZm9yY2UgdGhlIHdha2Ug
ZHVyaW5nIG9vbS1ub3RpZmllci4KIAkgKi8KIAlpZiAoc2hyaW5rICYgSTkxNV9TSFJJTktfQk9V
TkQpIHsKLQkJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShpOTE1KTsK
KwkJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZSgmaTkxNS0+cnVudGlt
ZV9wbSk7CiAJCWlmICghd2FrZXJlZikKIAkJCXNocmluayAmPSB+STkxNV9TSFJJTktfQk9VTkQ7
CiAJfQpAQCAtMjY1LDcgKzI2NSw3IEBAIGk5MTVfZ2VtX3NocmluayhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKIAl9CiAKIAlpZiAoc2hyaW5rICYgSTkxNV9TSFJJTktfQk9VTkQpCi0J
CWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCQlpbnRlbF9ydW50aW1lX3Bt
X3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKIAlpOTE1X3JldGlyZV9yZXF1ZXN0
cyhpOTE1KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0
cy9odWdlX3BhZ2VzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2Vf
cGFnZXMuYwppbmRleCA3M2U2NjdiMzFjYzQuLmI3NDcyOWI2ZjM1MyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKQEAgLTE3NTQsNyArMTc1
NCw3IEBAIGludCBpOTE1X2dlbV9odWdlX3BhZ2VfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAogCW11dGV4
X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVu
dGltZV9wbV9nZXQoZGV2X3ByaXYpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgm
ZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCiAJY3R4ID0gbGl2ZV9jb250ZXh0KGRldl9wcml2LCBm
aWxlKTsKIAlpZiAoSVNfRVJSKGN0eCkpIHsKQEAgLTE3NjgsNyArMTc2OCw3IEBAIGludCBpOTE1
X2dlbV9odWdlX3BhZ2VfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQogCWVyciA9IGk5MTVfc3VidGVzdHModGVzdHMsIGN0eCk7CiAKIG91dF91bmxvY2s6
Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWludGVsX3J1bnRp
bWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5sb2Nr
KCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAltb2NrX2ZpbGVfZnJlZShkZXZfcHJp
diwgZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3Rz
L2k5MTVfZ2VtX2NvaGVyZW5jeS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0
cy9pOTE1X2dlbV9jb2hlcmVuY3kuYwppbmRleCBjNzJlMTdkYTA5MGMuLjhmMjJkM2YxODQyMiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9j
b2hlcmVuY3kuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVf
Z2VtX2NvaGVyZW5jeS5jCkBAIC0yOTMsNyArMjkzLDcgQEAgc3RhdGljIGludCBpZ3RfZ2VtX2Nv
aGVyZW5jeSh2b2lkICphcmcpCiAJdmFsdWVzID0gb2Zmc2V0cyArIG5jYWNoZWxpbmVzOwogCiAJ
bXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1
bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkx
NS0+cnVudGltZV9wbSk7CiAJZm9yIChvdmVyID0gaWd0X2NvaGVyZW5jeV9tb2RlOyBvdmVyLT5u
YW1lOyBvdmVyKyspIHsKIAkJaWYgKCFvdmVyLT5zZXQpCiAJCQljb250aW51ZTsKQEAgLTM3MSw3
ICszNzEsNyBAQCBzdGF0aWMgaW50IGlndF9nZW1fY29oZXJlbmN5KHZvaWQgKmFyZykKIAkJfQog
CX0KIHVubG9jazoKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRl
bF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlrZnJlZShvZmZzZXRzKTsKIAlyZXR1cm4g
ZXJyOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1
X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVf
Z2VtX2NvbnRleHQuYwppbmRleCA3NGIwZTU4NzFjNGIuLjg0YjgzYjIxNWIzZCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0
LmMKQEAgLTUzLDcgKzUzLDcgQEAgc3RhdGljIGludCBsaXZlX25vcF9zd2l0Y2godm9pZCAqYXJn
KQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJY3R4ID0g
a2NhbGxvYyhuY3R4LCBzaXplb2YoKmN0eCksIEdGUF9LRVJORUwpOwogCWlmICghY3R4KSB7CkBA
IC0xNTYsNyArMTU2LDcgQEAgc3RhdGljIGludCBsaXZlX25vcF9zd2l0Y2godm9pZCAqYXJnKQog
CX0KIAogb3V0X3VubG9jazoKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsK
KwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0
ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAltb2NrX2ZpbGVfZnJlZShpOTE1
LCBmaWxlKTsKIAlyZXR1cm4gZXJyOwpAQCAtMTA5MCw3ICsxMDkwLDcgQEAgX19pZ3RfY3R4X3Nz
ZXUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCWdvdG8gb3V0X3VubG9jazsKIAl9
CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGlu
dGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAogCWNlID0gaTkxNV9nZW1f
Y29udGV4dF9nZXRfZW5naW5lKGN0eCwgUkNTMCk7CiAJaWYgKElTX0VSUihjZSkpIHsKQEAgLTEx
MzAsNyArMTEzMCw3IEBAIF9faWd0X2N0eF9zc2V1KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LAogb3V0X2NvbnRleHQ6CiAJaW50ZWxfY29udGV4dF9wdXQoY2UpOwogb3V0X3JwbToKLQlp
bnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1
dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmop
OwogCiBvdXRfdW5sb2NrOgpAQCAtMTU0Nyw3ICsxNTQ3LDcgQEAgc3RhdGljIGludCBpZ3Rfdm1f
aXNvbGF0aW9uKHZvaWQgKmFyZykKIAlHRU1fQlVHX09OKGN0eF9iLT52bS0+dG90YWwgIT0gdm1f
dG90YWwpOwogCXZtX3RvdGFsIC09IEk5MTVfR1RUX1BBR0VfU0laRTsKIAotCXdha2VyZWYgPSBp
bnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9n
ZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJY291bnQgPSAwOwogCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGk5MTUsIGlkKSB7CkBAIC0xNTkyLDcgKzE1OTIsNyBAQCBzdGF0aWMgaW50IGlndF92
bV9pc29sYXRpb24odm9pZCAqYXJnKQogCQljb3VudCwgUlVOVElNRV9JTkZPKGk5MTUpLT5udW1f
ZW5naW5lcyk7CiAKIG91dF9ycG06Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJl
Zik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwog
b3V0X3VubG9jazoKIAlpZiAoaWd0X2xpdmVfdGVzdF9lbmQoJnQpKQogCQllcnIgPSAtRUlPOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9t
bWFuLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4u
YwppbmRleCBiOTI4MDk0MTg3MjkuLjVjODFmNGI0ODEzYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKQEAgLTIwNSw3ICsyMDUs
NyBAQCBzdGF0aWMgaW50IGlndF9wYXJ0aWFsX3RpbGluZyh2b2lkICphcmcpCiAJfQogCiAJbXV0
ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRp
bWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+
cnVudGltZV9wbSk7CiAKIAlpZiAoMSkgewogCQlJR1RfVElNRU9VVChlbmQpOwpAQCAtMzE2LDcg
KzMxNiw3IEBAIG5leHRfdGlsaW5nOiA7CiAJfQogCiBvdXRfdW5sb2NrOgotCWludGVsX3J1bnRp
bWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5y
dW50aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9wYWdlcyhvYmopOwogb3V0OgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwppbmRleCBjMGQ5ODZkYjVhNzUuLjM5MjIw
ZTE2ZWEyNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5l
X2NzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKQEAg
LTExMDMsNyArMTEwMyw3IEBAIHN0YXRpYyBib29sIHJpbmdfaXNfaWRsZShzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCiAJCXJldHVybiB0cnVlOwogCiAJLyogSWYgdGhlIHdob2xlIGRl
dmljZSBpcyBhc2xlZXAsIHRoZSBlbmdpbmUgbXVzdCBiZSBpZGxlICovCi0Jd2FrZXJlZiA9IGlu
dGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShkZXZfcHJpdik7CisJd2FrZXJlZiA9IGludGVs
X3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZSgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCWlmICgh
d2FrZXJlZikKIAkJcmV0dXJuIHRydWU7CiAKQEAgLTExMTcsNyArMTExNyw3IEBAIHN0YXRpYyBi
b29sIHJpbmdfaXNfaWRsZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJICAgICEo
RU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX01JX01PREUpICYgTU9ERV9JRExFKSkKIAkJaWRsZSA9
IGZhbHNlOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKIAly
ZXR1cm4gaWRsZTsKIH0KQEAgLTE1MzEsMTAgKzE1MzEsMTAgQEAgdm9pZCBpbnRlbF9lbmdpbmVf
ZHVtcChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAKIAlyY3VfcmVhZF91bmxvY2so
KTsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoZW5naW5lLT5p
OTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXRfaWZfaW5fdXNlKCZlbmdpbmUt
Pmk5MTUtPnJ1bnRpbWVfcG0pOwogCWlmICh3YWtlcmVmKSB7CiAJCWludGVsX2VuZ2luZV9wcmlu
dF9yZWdpc3RlcnMoZW5naW5lLCBtKTsKLQkJaW50ZWxfcnVudGltZV9wbV9wdXQoZW5naW5lLT5p
OTE1LCB3YWtlcmVmKTsKKwkJaW50ZWxfcnVudGltZV9wbV9wdXQoJmVuZ2luZS0+aTkxNS0+cnVu
dGltZV9wbSwgd2FrZXJlZik7CiAJfSBlbHNlIHsKIAkJZHJtX3ByaW50ZihtLCAiXHREZXZpY2Ug
aXMgYXNsZWVwOyBza2lwcGluZyByZWdpc3RlciBkdW1wXG4iKTsKIAl9CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2hhbmdjaGVjay5jCmluZGV4IDE3NGJiMGE2MDMwOS4uNmJjZmE2NDU2
YzQ1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2su
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYwpAQCAtMjcz
LDcgKzI3Myw3IEBAIHN0YXRpYyB2b2lkIGk5MTVfaGFuZ2NoZWNrX2VsYXBzZWQoc3RydWN0IHdv
cmtfc3RydWN0ICp3b3JrKQogCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGRldl9wcml2KSkK
IAkJcmV0dXJuOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShk
ZXZfcHJpdik7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZSgmZGV2
X3ByaXYtPnJ1bnRpbWVfcG0pOwogCWlmICghd2FrZXJlZikKIAkJcmV0dXJuOwogCkBAIC0zMjQs
NyArMzI0LDcgQEAgc3RhdGljIHZvaWQgaTkxNV9oYW5nY2hlY2tfZWxhcHNlZChzdHJ1Y3Qgd29y
a19zdHJ1Y3QgKndvcmspCiAJaWYgKGh1bmcpCiAJCWhhbmdjaGVja19kZWNsYXJlX2hhbmcoZGV2
X3ByaXYsIGh1bmcsIHN0dWNrKTsKIAotCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3
YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdh
a2VyZWYpOwogCiAJLyogUmVzZXQgdGltZXIgaW4gY2FzZSBHUFUgaGFuZ3Mgd2l0aG91dCBhbm90
aGVyIHJlcXVlc3QgYmVpbmcgYWRkZWQgKi8KIAlpOTE1X3F1ZXVlX2hhbmdjaGVjayhkZXZfcHJp
dik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwppbmRleCA2MGQyNDExMGFmODAu
LjIwMDliMWI1NzQ2OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
cmVzZXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCkBAIC0x
MzEwLDcgKzEzMTAsNyBAQCB2b2lkIGk5MTVfaGFuZGxlX2Vycm9yKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAogCSAqIGlzbid0IHRoZSBjYXNlIGF0IGxlYXN0IHdoZW4gd2UgZ2V0IGhl
cmUgYnkgZG9pbmcgYQogCSAqIHNpbXVsYXRlZCByZXNldCB2aWEgZGVidWdmcywgc28gZ2V0IGFu
IFJQTSByZWZlcmVuY2UuCiAJICovCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5
MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7
CiAKIAllbmdpbmVfbWFzayAmPSBJTlRFTF9JTkZPKGk5MTUpLT5lbmdpbmVfbWFzazsKIApAQCAt
MTM3Myw3ICsxMzczLDcgQEAgdm9pZCBpOTE1X2hhbmRsZV9lcnJvcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKIAl3YWtlX3VwX2FsbCgmZXJyb3ItPnJlc2V0X3F1ZXVlKTsKIAogb3V0
OgotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVf
cG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIH0KIAogaW50IGk5MTVfcmVzZXRf
dHJ5bG9jayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMKaW5kZXggNDUzNzlhNjNlMDEzLi5iMGIyOTk4
ZTU2YjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdj
aGVjay5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5j
CkBAIC0zOTQsNyArMzk0LDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9wKHZvaWQgKmFyZykK
IAl9CiAKIAlpOTE1X2dlbV9jb250ZXh0X2NsZWFyX2Jhbm5hYmxlKGN0eCk7Ci0Jd2FrZXJlZiA9
IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3Bt
X2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAJcmVzZXRfY291bnQgPSBpOTE1X3Jlc2V0X2NvdW50
KCZpOTE1LT5ncHVfZXJyb3IpOwogCWNvdW50ID0gMDsKIAlkbyB7CkBAIC00NDEsNyArNDQxLDcg
QEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9wKHZvaWQgKmFyZykKIAllcnIgPSBpZ3RfZmx1c2hf
dGVzdChpOTE1LCBJOTE1X1dBSVRfTE9DS0VEKTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJ
aW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCiBvdXQ6
CiAJbW9ja19maWxlX2ZyZWUoaTkxNSwgZmlsZSk7CkBAIC00NzgsNyArNDc4LDcgQEAgc3RhdGlj
IGludCBpZ3RfcmVzZXRfbm9wX2VuZ2luZSh2b2lkICphcmcpCiAJfQogCiAJaTkxNV9nZW1fY29u
dGV4dF9jbGVhcl9iYW5uYWJsZShjdHgpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dl
dChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVf
cG0pOwogCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7CiAJCXVuc2lnbmVkIGlu
dCByZXNldF9jb3VudCwgcmVzZXRfZW5naW5lX2NvdW50OwogCQl1bnNpZ25lZCBpbnQgY291bnQ7
CkBAIC01NDksNyArNTQ5LDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9wX2VuZ2luZSh2b2lk
ICphcmcpCiAJZXJyID0gaWd0X2ZsdXNoX3Rlc3QoaTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCk7CiAJ
bXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAotCWludGVsX3J1bnRpbWVf
cG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50
aW1lX3BtLCB3YWtlcmVmKTsKIG91dDoKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAlp
ZiAoaTkxNV9yZXNldF9mYWlsZWQoaTkxNSkpCkBAIC0xNzQ5LDcgKzE3NDksNyBAQCBpbnQgaW50
ZWxfaGFuZ2NoZWNrX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQogCWlmIChpOTE1X3Rlcm1pbmFsbHlfd2VkZ2VkKGk5MTUpKQogCQlyZXR1cm4gLUVJTzsgLyog
d2UncmUgbG9uZyBwYXN0IGhvcGUgb2YgYSBzdWNjZXNzZnVsIHJlc2V0ICovCiAKLQl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVf
cG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAlzYXZlZF9oYW5nY2hlY2sgPSBmZXRjaF9hbmRf
emVybygmaTkxNV9tb2RwYXJhbXMuZW5hYmxlX2hhbmdjaGVjayk7CiAJZHJhaW5fZGVsYXllZF93
b3JrKCZpOTE1LT5ncHVfZXJyb3IuaGFuZ2NoZWNrX3dvcmspOyAvKiBmbHVzaCBwYXJhbSAqLwog
CkBAIC0xNzYwLDcgKzE3NjAsNyBAQCBpbnQgaW50ZWxfaGFuZ2NoZWNrX2xpdmVfc2VsZnRlc3Rz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCW11dGV4X3VubG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7CiAKIAlpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2NoZWNrID0gc2F2
ZWRfaGFuZ2NoZWNrOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCXJldHVy
biBlcnI7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9s
cmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCmluZGV4IGYwY2Ey
YTA5ZGFiZC4uZDg0ZDMxZTNkYTE5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF9scmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9s
cmMuYwpAQCAtMzMsNyArMzMsNyBAQCBzdGF0aWMgaW50IGxpdmVfc2FuaXR5Y2hlY2sodm9pZCAq
YXJnKQogCQlyZXR1cm4gMDsKIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
OwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50
ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJaWYgKGlndF9zcGlubmVy
X2luaXQoJnNwaW4sIGk5MTUpKQogCQlnb3RvIGVycl91bmxvY2s7CkBAIC03NCw3ICs3NCw3IEBA
IHN0YXRpYyBpbnQgbGl2ZV9zYW5pdHljaGVjayh2b2lkICphcmcpCiAJaWd0X3NwaW5uZXJfZmlu
aSgmc3Bpbik7CiBlcnJfdW5sb2NrOgogCWlndF9mbHVzaF90ZXN0KGk5MTUsIEk5MTVfV0FJVF9M
T0NLRUQpOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1
bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91bmxvY2so
Jmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7CiB9CkBAIC05Nyw3ICs5Nyw3
IEBAIHN0YXRpYyBpbnQgbGl2ZV9idXN5d2FpdF9wcmVlbXB0KHZvaWQgKmFyZykKIAkgKi8KIAog
CW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRlbF9y
dW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5
MTUtPnJ1bnRpbWVfcG0pOwogCiAJY3R4X2hpID0ga2VybmVsX2NvbnRleHQoaTkxNSk7CiAJaWYg
KCFjdHhfaGkpCkBAIC0yNTUsNyArMjU1LDcgQEAgc3RhdGljIGludCBsaXZlX2J1c3l3YWl0X3By
ZWVtcHQodm9pZCAqYXJnKQogZXJyX3VubG9jazoKIAlpZiAoaWd0X2ZsdXNoX3Rlc3QoaTkxNSwg
STkxNV9XQUlUX0xPQ0tFRCkpCiAJCWVyciA9IC1FSU87Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQo
aTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0s
IHdha2VyZWYpOwogCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0
dXJuIGVycjsKIH0KQEAgLTI3Nyw3ICsyNzcsNyBAQCBzdGF0aWMgaW50IGxpdmVfcHJlZW1wdCh2
b2lkICphcmcpCiAJCXByX2VycigiTG9naWNhbCBwcmVlbXB0aW9uIHN1cHBvcnRlZCwgYnV0IG5v
dCBleHBvc2VkXG4iKTsKIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwot
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxf
cnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJaWYgKGlndF9zcGlubmVyX2lu
aXQoJnNwaW5faGksIGk5MTUpKQogCQlnb3RvIGVycl91bmxvY2s7CkBAIC0zNjIsNyArMzYyLDcg
QEAgc3RhdGljIGludCBsaXZlX3ByZWVtcHQodm9pZCAqYXJnKQogCWlndF9zcGlubmVyX2Zpbmko
JnNwaW5faGkpOwogZXJyX3VubG9jazoKIAlpZ3RfZmx1c2hfdGVzdChpOTE1LCBJOTE1X1dBSVRf
TE9DS0VEKTsKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9y
dW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlyZXR1cm4gZXJyOwogfQpAQCAtMzgyLDcgKzM4
Miw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9sYXRlX3ByZWVtcHQodm9pZCAqYXJnKQogCQlyZXR1cm4g
MDsKIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBp
bnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9n
ZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJaWYgKGlndF9zcGlubmVyX2luaXQoJnNwaW5faGks
IGk5MTUpKQogCQlnb3RvIGVycl91bmxvY2s7CkBAIC00NjYsNyArNDY2LDcgQEAgc3RhdGljIGlu
dCBsaXZlX2xhdGVfcHJlZW1wdCh2b2lkICphcmcpCiAJaWd0X3NwaW5uZXJfZmluaSgmc3Bpbl9o
aSk7CiBlcnJfdW5sb2NrOgogCWlndF9mbHVzaF90ZXN0KGk5MTUsIEk5MTVfV0FJVF9MT0NLRUQp
OwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVf
cG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91bmxvY2soJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7CiAKQEAgLTUzMiw3ICs1MzIsNyBAQCBz
dGF0aWMgaW50IGxpdmVfc3VwcHJlc3Nfc2VsZl9wcmVlbXB0KHZvaWQgKmFyZykKIAkJcmV0dXJu
IDA7IC8qIHByZXN1bWUgYmxhY2sgYmxveCAqLwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdh
a2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAlpZiAo
cHJlZW1wdF9jbGllbnRfaW5pdChpOTE1LCAmYSkpCiAJCWdvdG8gZXJyX3VubG9jazsKQEAgLTYw
Niw3ICs2MDYsNyBAQCBzdGF0aWMgaW50IGxpdmVfc3VwcHJlc3Nfc2VsZl9wcmVlbXB0KHZvaWQg
KmFyZykKIGVycl91bmxvY2s6CiAJaWYgKGlndF9mbHVzaF90ZXN0KGk5MTUsIEk5MTVfV0FJVF9M
T0NLRUQpKQogCQllcnIgPSAtRUlPOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2Vy
ZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsK
IAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7CiAK
QEAgLTY4Myw3ICs2ODMsNyBAQCBzdGF0aWMgaW50IGxpdmVfc3VwcHJlc3Nfd2FpdF9wcmVlbXB0
KHZvaWQgKmFyZykKIAkJcmV0dXJuIDA7CiAKIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJl
ZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAogCWlmIChwcmVl
bXB0X2NsaWVudF9pbml0KGk5MTUsICZjbGllbnRbMF0pKSAvKiBFTFNQWzBdICovCiAJCWdvdG8g
ZXJyX3VubG9jazsKQEAgLTc3Niw3ICs3NzYsNyBAQCBzdGF0aWMgaW50IGxpdmVfc3VwcHJlc3Nf
d2FpdF9wcmVlbXB0KHZvaWQgKmFyZykKIGVycl91bmxvY2s6CiAJaWYgKGlndF9mbHVzaF90ZXN0
KGk5MTUsIEk5MTVfV0FJVF9MT0NLRUQpKQogCQllcnIgPSAtRUlPOwotCWludGVsX3J1bnRpbWVf
cG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50
aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
OwogCXJldHVybiBlcnI7CiAKQEAgLTgwNyw3ICs4MDcsNyBAQCBzdGF0aWMgaW50IGxpdmVfY2hh
aW5fcHJlZW1wdCh2b2lkICphcmcpCiAJCXJldHVybiAwOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUp
OworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAK
IAlpZiAocHJlZW1wdF9jbGllbnRfaW5pdChpOTE1LCAmaGkpKQogCQlnb3RvIGVycl91bmxvY2s7
CkBAIC05MjQsNyArOTI0LDcgQEAgc3RhdGljIGludCBsaXZlX2NoYWluX3ByZWVtcHQodm9pZCAq
YXJnKQogZXJyX3VubG9jazoKIAlpZiAoaWd0X2ZsdXNoX3Rlc3QoaTkxNSwgSTkxNV9XQUlUX0xP
Q0tFRCkpCiAJCWVyciA9IC1FSU87Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJl
Zik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwog
CW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVycjsKIApA
QCAtOTUzLDcgKzk1Myw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9wcmVlbXB0X2hhbmcodm9pZCAqYXJn
KQogCQlyZXR1cm4gMDsKIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwot
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxf
cnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJaWYgKGlndF9zcGlubmVyX2lu
aXQoJnNwaW5faGksIGk5MTUpKQogCQlnb3RvIGVycl91bmxvY2s7CkBAIC0xMDUwLDcgKzEwNTAs
NyBAQCBzdGF0aWMgaW50IGxpdmVfcHJlZW1wdF9oYW5nKHZvaWQgKmFyZykKIAlpZ3Rfc3Bpbm5l
cl9maW5pKCZzcGluX2hpKTsKIGVycl91bmxvY2s6CiAJaWd0X2ZsdXNoX3Rlc3QoaTkxNSwgSTkx
NV9XQUlUX0xPQ0tFRCk7Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJ
aW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCW11dGV4
X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVycjsKIH0KQEAgLTEy
NTYsNyArMTI1Niw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9wcmVlbXB0X3Ntb2tlKHZvaWQgKmFyZykK
IAkJcmV0dXJuIC1FTk9NRU07CiAKIAltdXRleF9sb2NrKCZzbW9rZS5pOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoc21va2UuaTkxNSk7CisJ
d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZzbW9rZS5pOTE1LT5ydW50aW1lX3BtKTsK
IAogCXNtb2tlLmJhdGNoID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChzbW9rZS5p
OTE1LCBQQUdFX1NJWkUpOwogCWlmIChJU19FUlIoc21va2UuYmF0Y2gpKSB7CkBAIC0xMzA5LDcg
KzEzMDksNyBAQCBzdGF0aWMgaW50IGxpdmVfcHJlZW1wdF9zbW9rZSh2b2lkICphcmcpCiBlcnJf
YmF0Y2g6CiAJaTkxNV9nZW1fb2JqZWN0X3B1dChzbW9rZS5iYXRjaCk7CiBlcnJfdW5sb2NrOgot
CWludGVsX3J1bnRpbWVfcG1fcHV0KHNtb2tlLmk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRp
bWVfcG1fcHV0KCZzbW9rZS5pOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91bmxv
Y2soJnNtb2tlLmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWtmcmVlKHNtb2tlLmNvbnRleHRz
KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfcmVzZXQu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3Jlc2V0LmMKaW5kZXggNjA3NDcz
NDM5ZWIwLi45MWYwMzQ5ODgyZmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X3Jlc2V0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rf
cmVzZXQuYwpAQCAtNDIsMTQgKzQyLDE0IEBAIHN0YXRpYyBpbnQgaWd0X3dlZGdlZF9yZXNldCh2
b2lkICphcmcpCiAJLyogQ2hlY2sgdGhhdCB3ZSBjYW4gcmVjb3ZlciBhIHdlZGdlZCBkZXZpY2Ug
d2l0aCBhIEdQVSByZXNldCAqLwogCiAJaWd0X2dsb2JhbF9yZXNldF9sb2NrKGk5MTUpOwotCXdh
a2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVu
dGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJaTkxNV9nZW1fc2V0X3dlZGdlZChp
OTE1KTsKIAogCUdFTV9CVUdfT04oIWk5MTVfcmVzZXRfZmFpbGVkKGk5MTUpKTsKIAlpOTE1X3Jl
c2V0KGk5MTUsIEFMTF9FTkdJTkVTLCBOVUxMKTsKIAotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5
MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3
YWtlcmVmKTsKIAlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jayhpOTE1KTsKIAogCXJldHVybiBpOTE1
X3Jlc2V0X2ZhaWxlZChpOTE1KSA/IC1FSU8gOiAwOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKaW5kZXggYzhkMzM1ZDYzZjljLi5mMWQyNzM0OGIz
YTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91
bmRzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMu
YwpAQCAtNjQyLDcgKzY0Miw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9kaXJ0eV93aGl0ZWxpc3Qodm9p
ZCAqYXJnKQogCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA3KSAvKiBtaW5pbXVtIHJlcXVpcmVtZW50
IGZvciBMUkksIFNSTSwgTFJNICovCiAJCXJldHVybiAwOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1
bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkx
NS0+cnVudGltZV9wbSk7CiAKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
OwogCWZpbGUgPSBtb2NrX2ZpbGUoaTkxNSk7CkBAIC02NzIsNyArNjcyLDcgQEAgc3RhdGljIGlu
dCBsaXZlX2RpcnR5X3doaXRlbGlzdCh2b2lkICphcmcpCiAJbW9ja19maWxlX2ZyZWUoaTkxNSwg
ZmlsZSk7CiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiBvdXRfcnBtOgot
CWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1f
cHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAlyZXR1cm4gZXJyOwogfQogCkBAIC0x
MDYxLDcgKzEwNjEsNyBAQCBsaXZlX2dwdV9yZXNldF93b3JrYXJvdW5kcyh2b2lkICphcmcpCiAJ
cHJfaW5mbygiVmVyaWZ5aW5nIGFmdGVyIEdQVSByZXNldC4uLlxuIik7CiAKIAlpZ3RfZ2xvYmFs
X3Jlc2V0X2xvY2soaTkxNSk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUp
OworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAK
IAlyZWZlcmVuY2VfbGlzdHNfaW5pdChpOTE1LCAmbGlzdHMpOwogCkBAIC0xMDc2LDcgKzEwNzYs
NyBAQCBsaXZlX2dwdV9yZXNldF93b3JrYXJvdW5kcyh2b2lkICphcmcpCiBvdXQ6CiAJa2VybmVs
X2NvbnRleHRfY2xvc2UoY3R4KTsKIAlyZWZlcmVuY2VfbGlzdHNfZmluaShpOTE1LCAmbGlzdHMp
OwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVf
cG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAlpZ3RfZ2xvYmFsX3Jlc2V0X3Vu
bG9jayhpOTE1KTsKIAogCXJldHVybiBvayA/IDAgOiAtRVNSQ0g7CkBAIC0xMTAzLDcgKzExMDMs
NyBAQCBsaXZlX2VuZ2luZV9yZXNldF93b3JrYXJvdW5kcyh2b2lkICphcmcpCiAJCXJldHVybiBQ
VFJfRVJSKGN0eCk7CiAKIAlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soaTkxNSk7Ci0Jd2FrZXJlZiA9
IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3Bt
X2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAlyZWZlcmVuY2VfbGlzdHNfaW5pdChpOTE1LCAm
bGlzdHMpOwogCkBAIC0xMTYwLDcgKzExNjAsNyBAQCBsaXZlX2VuZ2luZV9yZXNldF93b3JrYXJv
dW5kcyh2b2lkICphcmcpCiAKIGVycjoKIAlyZWZlcmVuY2VfbGlzdHNfZmluaShpOTE1LCAmbGlz
dHMpOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRp
bWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAlpZ3RfZ2xvYmFsX3Jlc2V0
X3VubG9jayhpOTE1KTsKIAlrZXJuZWxfY29udGV4dF9jbG9zZShjdHgpOwogCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvYXBlcnR1cmVfZ20uYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9hcGVydHVyZV9nbS5jCmluZGV4IDdmNGUzNDU2Y2UxMS4uYjIwODBhOTljNWMy
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvYXBlcnR1cmVfZ20uYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvYXBlcnR1cmVfZ20uYwpAQCAtMTY5LDcgKzE2OSw3
IEBAIHN0YXRpYyB2b2lkIGZyZWVfdmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkK
IAlpZiAoV0FSTl9PTighdmdwdV9mZW5jZV9zeih2Z3B1KSkpCiAJCXJldHVybjsKIAotCWludGVs
X3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwlpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3By
aXYtPnJ1bnRpbWVfcG0pOwogCiAJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwogCV9jbGVhcl92Z3B1X2ZlbmNlKHZncHUpOwpAQCAtMTgwLDE3ICsxODAsMTggQEAgc3Rh
dGljIHZvaWQgZnJlZV92Z3B1X2ZlbmNlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQogCX0KIAlt
dXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKIAotCWludGVsX3J1bnRp
bWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7CisJaW50ZWxfcnVudGltZV9wbV9wdXRfdW5j
aGVja2VkKCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiB9CiAKIHN0YXRpYyBpbnQgYWxsb2Nfdmdw
dV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3Z0ICpn
dnQgPSB2Z3B1LT5ndnQ7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZ3Z0
LT5kZXZfcHJpdjsKKwlzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtID0gJmRldl9wcml2LT5y
dW50aW1lX3BtOwogCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKnJlZzsKIAlpbnQgaTsKIAot
CWludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwlpbnRlbF9ydW50aW1lX3BtX2dldChy
cG0pOwogCiAJLyogUmVxdWVzdCBmZW5jZXMgZnJvbSBob3N0ICovCiAJbXV0ZXhfbG9jaygmZGV2
X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwpAQCAtMjA2LDcgKzIwNyw3IEBAIHN0YXRpYyBpbnQg
YWxsb2NfdmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIAlfY2xlYXJfdmdwdV9m
ZW5jZSh2Z3B1KTsKIAogCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgp
OwotCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7CisJaW50ZWxfcnVu
dGltZV9wbV9wdXRfdW5jaGVja2VkKHJwbSk7CiAJcmV0dXJuIDA7CiBvdXRfZnJlZV9mZW5jZToK
IAlndnRfdmdwdV9lcnIoIkZhaWxlZCB0byBhbGxvYyBmZW5jZXNcbiIpOwpAQCAtMjE5LDcgKzIy
MCw3IEBAIHN0YXRpYyBpbnQgYWxsb2NfdmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdw
dSkKIAkJdmdwdS0+ZmVuY2UucmVnc1tpXSA9IE5VTEw7CiAJfQogCW11dGV4X3VubG9jaygmZGV2
X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tl
ZChkZXZfcHJpdik7CisJaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKHJwbSk7CiAJcmV0
dXJuIC1FTk9TUEM7CiB9CiAKQEAgLTMxNSw5ICszMTYsOSBAQCB2b2lkIGludGVsX3ZncHVfcmVz
ZXRfcmVzb3VyY2Uoc3RydWN0IGludGVsX3ZncHUgKnZncHUpCiB7CiAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKIAotCWludGVsX3J1bnRp
bWVfcG1fZ2V0KGRldl9wcml2KTsKKwlpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1
bnRpbWVfcG0pOwogCV9jbGVhcl92Z3B1X2ZlbmNlKHZncHUpOwotCWludGVsX3J1bnRpbWVfcG1f
cHV0X3VuY2hlY2tlZChkZXZfcHJpdik7CisJaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2Vk
KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiB9CiAKIC8qKgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Z0L2d2dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5oCmlu
ZGV4IGI1NGYyYmRjMTNhNC4uNWZlZTJlMTEyYzU1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndnQvZ3Z0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2dC5oCkBA
IC01ODQsMTIgKzU4NCwxMiBAQCBlbnVtIHsKIAogc3RhdGljIGlubGluZSB2b2lkIG1taW9faHdf
YWNjZXNzX3ByZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0JaW50ZWxf
cnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCWludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJp
di0+cnVudGltZV9wbSk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBtbWlvX2h3X2FjY2Vzc19w
b3N0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlpbnRlbF9ydW50aW1l
X3BtX3B1dF91bmNoZWNrZWQoZGV2X3ByaXYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hl
Y2tlZCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogfQogCiAvKioKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZF9wb2xpY3kuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d2dC9zY2hlZF9wb2xpY3kuYwppbmRleCAxYzc2M2EyN2E0MTIuLjIzNjlkNGE5YWY5NCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkX3BvbGljeS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZF9wb2xpY3kuYwpAQCAtNDY1LDcgKzQ2NSw3IEBA
IHZvaWQgaW50ZWxfdmdwdV9zdG9wX3NjaGVkdWxlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQog
CQlzY2hlZHVsZXItPmN1cnJlbnRfdmdwdSA9IE5VTEw7CiAJfQogCi0JaW50ZWxfcnVudGltZV9w
bV9nZXQoZGV2X3ByaXYpOworCWludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGlt
ZV9wbSk7CiAJc3Bpbl9sb2NrX2JoKCZzY2hlZHVsZXItPm1taW9fY29udGV4dF9sb2NrKTsKIAlm
b3IgKHJpbmdfaWQgPSAwOyByaW5nX2lkIDwgSTkxNV9OVU1fRU5HSU5FUzsgcmluZ19pZCsrKSB7
CiAJCWlmIChzY2hlZHVsZXItPmVuZ2luZV9vd25lcltyaW5nX2lkXSA9PSB2Z3B1KSB7CkBAIC00
NzQsNiArNDc0LDYgQEAgdm9pZCBpbnRlbF92Z3B1X3N0b3Bfc2NoZWR1bGUoc3RydWN0IGludGVs
X3ZncHUgKnZncHUpCiAJCX0KIAl9CiAJc3Bpbl91bmxvY2tfYmgoJnNjaGVkdWxlci0+bW1pb19j
b250ZXh0X2xvY2spOwotCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7
CisJaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKCZkZXZfcHJpdi0+cnVudGltZV9wbSk7
CiAJbXV0ZXhfdW5sb2NrKCZ2Z3B1LT5ndnQtPnNjaGVkX2xvY2spOwogfQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L3NjaGVkdWxlci5jCmluZGV4IGUzMDFlZmIxOGQ0NS4uOTAyOWRlNGI0NjUxIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCkBAIC0xNTI2LDExICsxNTI2LDExIEBAIGlu
dGVsX3ZncHVfY3JlYXRlX3dvcmtsb2FkKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBpbnQgcmlu
Z19pZCwKIAkgKiBhcyB0aGVyZSBpcyBvbmx5IG9uZSBwcmUtYWxsb2NhdGVkIGJ1Zi1vYmogZm9y
IHNoYWRvdy4KIAkgKi8KIAlpZiAobGlzdF9lbXB0eSh3b3JrbG9hZF9xX2hlYWQodmdwdSwgcmlu
Z19pZCkpKSB7Ci0JCWludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwkJaW50ZWxfcnVu
dGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAkJbXV0ZXhfbG9jaygmZGV2X3By
aXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQlyZXQgPSBpbnRlbF9ndnRfc2Nhbl9hbmRfc2hhZG93
X3dvcmtsb2FkKHdvcmtsb2FkKTsKIAkJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVj
dF9tdXRleCk7Ci0JCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7CisJ
CWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwog
CX0KIAogCWlmIChyZXQpIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggNDYw
MTQ0NDRhZDJkLi5jMDMwNGI2ODVlN2UgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZGVidWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5j
CkBAIC02NTksNyArNjU5LDcgQEAgc3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0cnVj
dCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAlp
bnQgaSwgcGlwZTsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7
CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7
CiAKIAlpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKIAkJaW50ZWxfd2FrZXJlZl90IHBy
ZWY7CkBAIC04NjUsNyArODY1LDcgQEAgc3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0
cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAkJfQogCX0KIAotCWludGVsX3J1bnRpbWVf
cG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3By
aXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCiAJcmV0dXJuIDA7CiB9CkBAIC0xMDA0LDcgKzEw
MDQsNyBAQCBzdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5X2luZm8oc3RydWN0IHNlcV9maWxlICpt
LCB2b2lkICp1bnVzZWQpCiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CiAJaW50IHJldCA9IDA7
CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCXdha2VyZWYg
PSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCiAJaWYgKElT
X0dFTihkZXZfcHJpdiwgNSkpIHsKIAkJdTE2IHJndnN3Y3RsID0gSTkxNV9SRUFEMTYoTUVNU1dD
VEwpOwpAQCAtMTIxNiw3ICsxMjE2LDcgQEAgc3RhdGljIGludCBpOTE1X2ZyZXF1ZW5jeV9pbmZv
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCXNlcV9wcmludGYobSwgIk1heCBD
RCBjbG9jayBmcmVxdWVuY3k6ICVkIGtIelxuIiwgZGV2X3ByaXYtPm1heF9jZGNsa19mcmVxKTsK
IAlzZXFfcHJpbnRmKG0sICJNYXggcGl4ZWwgY2xvY2sgZnJlcXVlbmN5OiAlZCBrSHpcbiIsIGRl
dl9wcml2LT5tYXhfZG90Y2xrX2ZyZXEpOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3By
aXYsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9w
bSwgd2FrZXJlZik7CiAJcmV0dXJuIHJldDsKIH0KIApAQCAtMTU2MSw3ICsxNTYxLDcgQEAgc3Rh
dGljIGludCBpOTE1X2ZiY19zdGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQp
CiAJaWYgKCFIQVNfRkJDKGRldl9wcml2KSkKIAkJcmV0dXJuIC1FTk9ERVY7CiAKLQl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCXdha2VyZWYgPSBpbnRlbF9ydW50
aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCW11dGV4X2xvY2soJmZiYy0+bG9j
ayk7CiAKIAlpZiAoaW50ZWxfZmJjX2lzX2FjdGl2ZShkZXZfcHJpdikpCkBAIC0xNTg4LDcgKzE1
ODgsNyBAQCBzdGF0aWMgaW50IGk5MTVfZmJjX3N0YXR1cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKnVudXNlZCkKIAl9CiAKIAltdXRleF91bmxvY2soJmZiYy0+bG9jayk7Ci0JaW50ZWxfcnVu
dGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZk
ZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTE2Mzgs
NyArMTYzOCw3IEBAIHN0YXRpYyBpbnQgaTkxNV9pcHNfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqdW51c2VkKQogCWlmICghSEFTX0lQUyhkZXZfcHJpdikpCiAJCXJldHVybiAtRU5P
REVWOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAogCXNl
cV9wcmludGYobSwgIkVuYWJsZWQgYnkga2VybmVsIHBhcmFtZXRlcjogJXNcbiIsCiAJCSAgIHll
c25vKGk5MTVfbW9kcGFyYW1zLmVuYWJsZV9pcHMpKTsKQEAgLTE2NTIsNyArMTY1Miw3IEBAIHN0
YXRpYyBpbnQgaTkxNV9pcHNfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2Vk
KQogCQkJc2VxX3B1dHMobSwgIkN1cnJlbnRseTogZGlzYWJsZWRcbiIpOwogCX0KIAotCWludGVs
X3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1
dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCiAJcmV0dXJuIDA7CiB9CkBAIC0x
NzMxLDcgKzE3MzEsNyBAQCBzdGF0aWMgaW50IGk5MTVfcmluZ19mcmVxX3RhYmxlKHN0cnVjdCBz
ZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCiAJc2VxX3B1dHMobSwgIkdQVSBmcmVxIChNSHop
XHRFZmZlY3RpdmUgQ1BVIGZyZXEgKE1IeilcdEVmZmVjdGl2ZSBSaW5nIGZyZXEgKE1IeilcbiIp
OwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAlmb3IgKGdw
dV9mcmVxID0gbWluX2dwdV9mcmVxOyBncHVfZnJlcSA8PSBtYXhfZ3B1X2ZyZXE7IGdwdV9mcmVx
KyspIHsKIAkJaWFfZnJlcSA9IGdwdV9mcmVxOwogCQlzYW5keWJyaWRnZV9wY29kZV9yZWFkKGRl
dl9wcml2LApAQCAtMTc0NSw3ICsxNzQ1LDcgQEAgc3RhdGljIGludCBpOTE1X3JpbmdfZnJlcV90
YWJsZShzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAkJCSAgICgoaWFfZnJlcSA+
PiAwKSAmIDB4ZmYpICogMTAwLAogCQkJICAgKChpYV9mcmVxID4+IDgpICYgMHhmZikgKiAxMDAp
OwogCX0KLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50ZWxf
cnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCXJldHVy
biAwOwogfQpAQCAtMTkyMSw3ICsxOTIxLDcgQEAgc3RhdGljIGludCBpOTE1X3N3aXp6bGVfaW5m
byhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwogCWludGVsX3dha2VyZWZf
dCB3YWtlcmVmOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsK
Kwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsK
IAogCXNlcV9wcmludGYobSwgImJpdDYgc3dpenpsZSBmb3IgWC10aWxpbmcgPSAlc1xuIiwKIAkJ
ICAgc3dpenpsZV9zdHJpbmcoZGV2X3ByaXYtPm1tLmJpdF82X3N3aXp6bGVfeCkpOwpAQCAtMTk1
OSw3ICsxOTU5LDcgQEAgc3RhdGljIGludCBpOTE1X3N3aXp6bGVfaW5mbyhzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIHZvaWQgKmRhdGEpCiAJaWYgKGRldl9wcml2LT5xdWlya3MgJiBRVUlSS19QSU5fU1dJ
WlpMRURfUEFHRVMpCiAJCXNlcV9wdXRzKG0sICJMLXNoYXBlZCBtZW1vcnkgZGV0ZWN0ZWRcbiIp
OwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWludGVsX3J1
bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKIAlyZXR1cm4g
MDsKIH0KQEAgLTI0NzIsNyArMjQ3Miw3IEBAIHN0YXRpYyBpbnQgaTkxNV9lZHBfcHNyX3N0YXR1
cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJaWYgKCFwc3ItPnNpbmtfc3VwcG9y
dCkKIAkJcmV0dXJuIDA7CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3By
aXYpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVf
cG0pOwogCW11dGV4X2xvY2soJnBzci0+bG9jayk7CiAKIAlpZiAocHNyLT5lbmFibGVkKQpAQCAt
MjUzNiw3ICsyNTM2LDcgQEAgc3RhdGljIGludCBpOTE1X2VkcF9wc3Jfc3RhdHVzKHN0cnVjdCBz
ZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAogdW5sb2NrOgogCW11dGV4X3VubG9jaygmcHNyLT5s
b2NrKTsKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50ZWxf
cnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCXJldHVy
biAwOwogfQpAQCAtMjU1MywxMSArMjU1MywxMSBAQCBpOTE1X2VkcF9wc3JfZGVidWdfc2V0KHZv
aWQgKmRhdGEsIHU2NCB2YWwpCiAKIAlEUk1fREVCVUdfS01TKCJTZXR0aW5nIFBTUiBkZWJ1ZyB0
byAlbGx4XG4iLCB2YWwpOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9w
cml2KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1l
X3BtKTsKIAogCXJldCA9IGludGVsX3Bzcl9kZWJ1Z19zZXQoZGV2X3ByaXYsIHZhbCk7CiAKLQlp
bnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9w
bV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCXJldHVybiByZXQ7CiB9
CkBAIC0yNjczLDcgKzI2NzMsNyBAQCBzdGF0aWMgaW50IGk5MTVfZG1jX2luZm8oc3RydWN0IHNl
cV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAKIAljc3IgPSAmZGV2X3ByaXYtPmNzcjsKIAotCXdh
a2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7CisJd2FrZXJlZiA9IGludGVs
X3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAKIAlzZXFfcHJpbnRmKG0s
ICJmdyBsb2FkZWQ6ICVzXG4iLCB5ZXNubyhjc3ItPmRtY19wYXlsb2FkICE9IE5VTEwpKTsKIAlz
ZXFfcHJpbnRmKG0sICJwYXRoOiAlc1xuIiwgY3NyLT5md19wYXRoKTsKQEAgLTI2OTksNyArMjY5
OSw3IEBAIHN0YXRpYyBpbnQgaTkxNV9kbWNfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQg
KnVudXNlZCkKIAlzZXFfcHJpbnRmKG0sICJzc3AgYmFzZTogMHglMDh4XG4iLCBJOTE1X1JFQUQo
Q1NSX1NTUF9CQVNFKSk7CiAJc2VxX3ByaW50ZihtLCAiaHRwOiAweCUwOHhcbiIsIEk5MTVfUkVB
RChDU1JfSFRQX1NLTCkpOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2Vy
ZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJl
Zik7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTI5ODMsNyArMjk4Myw3IEBAIHN0YXRpYyBpbnQgaTkx
NV9kaXNwbGF5X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJc3RydWN0
IGRybV9jb25uZWN0b3JfbGlzdF9pdGVyIGNvbm5faXRlcjsKIAlpbnRlbF93YWtlcmVmX3Qgd2Fr
ZXJlZjsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7CisJd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAKIAlz
ZXFfcHJpbnRmKG0sICJDUlRDIGluZm9cbiIpOwogCXNlcV9wcmludGYobSwgIi0tLS0tLS0tLVxu
Iik7CkBAIC0zMDMyLDcgKzMwMzIsNyBAQCBzdGF0aWMgaW50IGk5MTVfZGlzcGxheV9pbmZvKHN0
cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogCWRybV9jb25uZWN0b3JfbGlzdF9pdGVy
X2VuZCgmY29ubl9pdGVyKTsKIAltdXRleF91bmxvY2soJmRldi0+bW9kZV9jb25maWcubXV0ZXgp
OwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworCWludGVsX3J1
bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKIAlyZXR1cm4g
MDsKIH0KQEAgLTMwNDUsNyArMzA0NSw3IEBAIHN0YXRpYyBpbnQgaTkxNV9lbmdpbmVfaW5mbyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAllbnVtIGludGVsX2VuZ2luZV9pZCBp
ZDsKIAlzdHJ1Y3QgZHJtX3ByaW50ZXIgcDsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3Bt
X2dldChkZXZfcHJpdik7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJp
di0+cnVudGltZV9wbSk7CiAKIAlzZXFfcHJpbnRmKG0sICJHVCBhd2FrZT8gJXMgWyVkXVxuIiwK
IAkJICAgeWVzbm8oZGV2X3ByaXYtPmd0LmF3YWtlKSwKQEAgLTMwNTcsNyArMzA1Nyw3IEBAIHN0
YXRpYyBpbnQgaTkxNV9lbmdpbmVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNl
ZCkKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCiAJCWludGVsX2VuZ2lu
ZV9kdW1wKGVuZ2luZSwgJnAsICIlc1xuIiwgZW5naW5lLT5uYW1lKTsKIAotCWludGVsX3J1bnRp
bWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2
X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCiAJcmV0dXJuIDA7CiB9CkBAIC00MjIwLDcg
KzQyMjAsOCBAQCBzdGF0aWMgaW50IGk5MTVfZm9yY2V3YWtlX29wZW4oc3RydWN0IGlub2RlICpp
bm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCiAJaWYgKElOVEVMX0dFTihpOTE1KSA8IDYpCiAJCXJl
dHVybiAwOwogCi0JZmlsZS0+cHJpdmF0ZV9kYXRhID0gKHZvaWQgKikodWludHB0cl90KWludGVs
X3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCWZpbGUtPnByaXZhdGVfZGF0YSA9CisJCSh2b2lkICop
KHVpbnRwdHJfdClpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAJaW50
ZWxfdW5jb3JlX2ZvcmNld2FrZV91c2VyX2dldCgmaTkxNS0+dW5jb3JlKTsKIAogCXJldHVybiAw
OwpAQCAtNDIzNCw3ICs0MjM1LDcgQEAgc3RhdGljIGludCBpOTE1X2ZvcmNld2FrZV9yZWxlYXNl
KHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQogCQlyZXR1cm4gMDsKIAog
CWludGVsX3VuY29yZV9mb3JjZXdha2VfdXNlcl9wdXQoJmk5MTUtPnVuY29yZSk7Ci0JaW50ZWxf
cnVudGltZV9wbV9wdXQoaTkxNSwKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGlt
ZV9wbSwKIAkJCSAgICAgKGludGVsX3dha2VyZWZfdCkodWludHB0cl90KWZpbGUtPnByaXZhdGVf
ZGF0YSk7CiAKIAlyZXR1cm4gMDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IGU5ODBjMWVl
M2RjZi4uMmI1ZjU0NmZiY2IyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTM3Myw3ICsz
NzMsNyBAQCBpOTE1X2dlbV9ndHRfcHJlYWQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aiwKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVf
cG1fZ2V0KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVu
dGltZV9wbSk7CiAJdm1hID0gaTkxNV9nZW1fb2JqZWN0X2dndHRfcGluKG9iaiwgTlVMTCwgMCwg
MCwKIAkJCQkgICAgICAgUElOX01BUFBBQkxFIHwKIAkJCQkgICAgICAgUElOX05PTkZBVUxUIHwK
QEAgLTQ2MCw3ICs0NjAsNyBAQCBpOTE1X2dlbV9ndHRfcHJlYWQoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaiwKIAkJaTkxNV92bWFfdW5waW4odm1hKTsKIAl9CiBvdXRfdW5sb2NrOgot
CWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1f
cHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwogCiAJcmV0dXJuIHJldDsKQEAgLTU2MCw2ICs1NjAsNyBAQCBpOTE1
X2dlbV9ndHRfcHdyaXRlX2Zhc3Qoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIHsK
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2JqLT5iYXNlLmRldik7
CiAJc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9ICZpOTE1LT5nZ3R0OworCXN0cnVjdCBpbnRlbF9y
dW50aW1lX3BtICpycG0gPSAmaTkxNS0+cnVudGltZV9wbTsKIAlpbnRlbF93YWtlcmVmX3Qgd2Fr
ZXJlZjsKIAlzdHJ1Y3QgZHJtX21tX25vZGUgbm9kZTsKIAlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5j
ZTsKQEAgLTU4MCwxNCArNTgxLDE0IEBAIGk5MTVfZ2VtX2d0dF9wd3JpdGVfZmFzdChzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCQkgKiBUaGlzIGVhc2lseSBkd2FyZnMgYW55IHBl
cmZvcm1hbmNlIGFkdmFudGFnZSBmcm9tCiAJCSAqIHVzaW5nIHRoZSBjYWNoZSBieXBhc3Mgb2Yg
aW5kaXJlY3QgR0dUVCBhY2Nlc3MuCiAJCSAqLwotCQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9w
bV9nZXRfaWZfaW5fdXNlKGk5MTUpOworCQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXRf
aWZfaW5fdXNlKHJwbSk7CiAJCWlmICghd2FrZXJlZikgewogCQkJcmV0ID0gLUVGQVVMVDsKIAkJ
CWdvdG8gb3V0X3VubG9jazsKIAkJfQogCX0gZWxzZSB7CiAJCS8qIE5vIGJhY2tpbmcgcGFnZXMs
IG5vIGZhbGxiYWNrLCB3ZSBtdXN0IGZvcmNlIEdHVFQgYWNjZXNzICovCi0JCXdha2VyZWYgPSBp
bnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwkJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1f
Z2V0KHJwbSk7CiAJfQogCiAJdm1hID0gaTkxNV9nZW1fb2JqZWN0X2dndHRfcGluKG9iaiwgTlVM
TCwgMCwgMCwKQEAgLTY4Myw3ICs2ODQsNyBAQCBpOTE1X2dlbV9ndHRfcHdyaXRlX2Zhc3Qoc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAkJaTkxNV92bWFfdW5waW4odm1hKTsKIAl9
CiBvdXRfcnBtOgotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVs
X3J1bnRpbWVfcG1fcHV0KHJwbSwgd2FrZXJlZik7CiBvdXRfdW5sb2NrOgogCW11dGV4X3VubG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIHJldDsKQEAgLTExNzMsNyArMTE3
NCw3IEBAIHZvaWQgaTkxNV9nZW1fc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCiAKIAlHRU1fVFJBQ0UoIlxuIik7CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9n
ZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1l
X3BtKTsKIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdB
S0VfQUxMKTsKIAogCS8qCkBAIC0xMTk2LDcgKzExOTcsNyBAQCB2b2lkIGk5MTVfZ2VtX3Nhbml0
aXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWludGVsX2d0X3Nhbml0aXplKGk5
MTUsIGZhbHNlKTsKIAogCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUs
IEZPUkNFV0FLRV9BTEwpOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOwor
CWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCW11
dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWk5MTVfZ2VtX2NvbnRleHRzX2xv
c3QoaTkxNSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9mZW5j
ZV9yZWcuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5jCmluZGV4
IGYyY2VmM2ZhM2RlYi4uMDE3NGE1Y2VkYTEzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbV9mZW5jZV9yZWcuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dlbV9mZW5jZV9yZWcuYwpAQCAtMjY5LDcgKzI2OSw3IEBAIHN0YXRpYyBpbnQgZmVuY2VfdXBk
YXRlKHN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlLAogCSAqIGJlIGNsZWFyZWQgYmVm
b3JlIHdlIGNhbiB1c2UgYW55IG90aGVyIGZlbmNlcyB0byBlbnN1cmUgdGhhdAogCSAqIHRoZSBu
ZXcgZmVuY2VzIGRvIG5vdCBvdmVybGFwIHRoZSBlbGlkZWQgY2xlYXJzLCBjb25mdXNpbmcgSFcu
CiAJICovCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShmZW5jZS0+
aTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZSgmZmVuY2Ut
Pmk5MTUtPnJ1bnRpbWVfcG0pOwogCWlmICghd2FrZXJlZikgewogCQlHRU1fQlVHX09OKHZtYSk7
CiAJCXJldHVybiAwOwpAQCAtMjgzLDcgKzI4Myw3IEBAIHN0YXRpYyBpbnQgZmVuY2VfdXBkYXRl
KHN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlLAogCQlsaXN0X21vdmVfdGFpbCgmZmVu
Y2UtPmxpbmssICZmZW5jZS0+aTkxNS0+bW0uZmVuY2VfbGlzdCk7CiAJfQogCi0JaW50ZWxfcnVu
dGltZV9wbV9wdXQoZmVuY2UtPmk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0
KCZmZW5jZS0+aTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJcmV0dXJuIDA7CiB9CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKaW5kZXggZTcwNjc1YmZiNTFkLi5jZjg1M2QzYWU1
OGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCkBAIC0xODI1LDcgKzE4MjUsNyBA
QCBzdGF0aWMgaW50IGdlbjZfYWxsb2NfdmFfcmFuZ2Uoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm0sCiAJdW5zaWduZWQgaW50IHBkZTsKIAlib29sIGZsdXNoID0gZmFsc2U7CiAKLQl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQodm0tPmk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9y
dW50aW1lX3BtX2dldCgmdm0tPmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJc3Bpbl9sb2NrKCZwcGd0
dC0+YmFzZS5wZC5sb2NrKTsKIAlnZW42X2Zvcl9lYWNoX3BkZShwdCwgJnBwZ3R0LT5iYXNlLnBk
LCBzdGFydCwgbGVuZ3RoLCBwZGUpIHsKQEAgLTE4NjgsMTIgKzE4NjgsMTIgQEAgc3RhdGljIGlu
dCBnZW42X2FsbG9jX3ZhX3JhbmdlKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAogCQln
ZW42X2dndHRfaW52YWxpZGF0ZSh2bS0+aTkxNSk7CiAJfQogCi0JaW50ZWxfcnVudGltZV9wbV9w
dXQodm0tPmk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZ2bS0+aTkxNS0+
cnVudGltZV9wbSwgd2FrZXJlZik7CiAKIAlyZXR1cm4gMDsKIAogdW53aW5kX291dDoKLQlpbnRl
bF9ydW50aW1lX3BtX3B1dCh2bS0+aTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9w
dXQoJnZtLT5pOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAlnZW42X3BwZ3R0X2NsZWFyX3Jh
bmdlKHZtLCBmcm9tLCBzdGFydCAtIGZyb20pOwogCXJldHVybiAtRU5PTUVNOwogfQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3BlcmYuYwppbmRleCBkOTJkZGZhZGEyNjIuLjNkODE2MmQyODczMCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9wZXJmLmMKQEAgLTEzNzUsNyArMTM3NSw3IEBAIHN0YXRpYyB2b2lkIGk5
MTVfb2Ffc3RyZWFtX2Rlc3Ryb3koc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKIAlm
cmVlX29hX2J1ZmZlcihkZXZfcHJpdik7CiAKIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgm
ZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQo
ZGV2X3ByaXYsIHN0cmVhbS0+d2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmRldl9w
cml2LT5ydW50aW1lX3BtLCBzdHJlYW0tPndha2VyZWYpOwogCiAJaWYgKHN0cmVhbS0+Y3R4KQog
CQlvYV9wdXRfcmVuZGVyX2N0eF9pZChzdHJlYW0pOwpAQCAtMjExMiw3ICsyMTEyLDcgQEAgc3Rh
dGljIGludCBpOTE1X29hX3N0cmVhbV9pbml0KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJl
YW0sCiAJICogICBJbiBvdXIgY2FzZSB3ZSBhcmUgZXhwZWN0aW5nIHRoYXQgdGFraW5nIHBtICsg
Rk9SQ0VXQUtFCiAJICogICByZWZlcmVuY2VzIHdpbGwgZWZmZWN0aXZlbHkgZGlzYWJsZSBSQzYu
CiAJICovCi0Jc3RyZWFtLT53YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYp
OworCXN0cmVhbS0+d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVu
dGltZV9wbSk7CiAJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUs
IEZPUkNFV0FLRV9BTEwpOwogCiAJcmV0ID0gYWxsb2Nfb2FfYnVmZmVyKGRldl9wcml2KTsKQEAg
LTIxNDgsNyArMjE0OCw3IEBAIHN0YXRpYyBpbnQgaTkxNV9vYV9zdHJlYW1faW5pdChzdHJ1Y3Qg
aTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAogCXB1dF9vYV9jb25maWcoZGV2X3ByaXYsIHN0cmVh
bS0+b2FfY29uZmlnKTsKIAogCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+
dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwg
c3RyZWFtLT53YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRp
bWVfcG0sIHN0cmVhbS0+d2FrZXJlZik7CiAKIGVycl9jb25maWc6CiAJaWYgKHN0cmVhbS0+Y3R4
KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfcG11LmMKaW5kZXggMWNjZGEwZWU0ZmY1Li44ZjEwNWQ0NDFhNTIg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYwpAQCAtMTcxLDcgKzE3MSw3IEBAIGVuZ2luZXNfc2Ft
cGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdW5zaWduZWQgaW50IHBlcmlv
ZF9ucykKIAogCXdha2VyZWYgPSAwOwogCWlmIChSRUFEX09OQ0UoZGV2X3ByaXYtPmd0LmF3YWtl
KSkKLQkJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShkZXZfcHJpdik7
CisJCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoJmRldl9wcml2LT5y
dW50aW1lX3BtKTsKIAlpZiAoIXdha2VyZWYpCiAJCXJldHVybjsKIApAQCAtMjA3LDcgKzIwNyw3
IEBAIGVuZ2luZXNfc2FtcGxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdW5z
aWduZWQgaW50IHBlcmlvZF9ucykKIAl9CiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3By
aXYtPnVuY29yZS5sb2NrLCBmbGFncyk7CiAKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJp
diwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3Bt
LCB3YWtlcmVmKTsKIH0KIAogc3RhdGljIHZvaWQKQEAgLTQ0MSwxNCArNDQxLDE1IEBAIHN0YXRp
YyB1NjQgX19nZXRfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogc3RhdGljIHU2
NCBnZXRfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogI2lmIElTX0VOQUJM
RUQoQ09ORklHX1BNKQorCXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0gPSAmaTkxNS0+cnVu
dGltZV9wbTsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAl1bnNpZ25lZCBsb25nIGZsYWdz
OwogCXU2NCB2YWw7CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXRfaWZfaW5fdXNl
KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UocnBtKTsK
IAlpZiAod2FrZXJlZikgewogCQl2YWwgPSBfX2dldF9yYzYoaTkxNSk7Ci0JCWludGVsX3J1bnRp
bWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCQlpbnRlbF9ydW50aW1lX3BtX3B1dChycG0sIHdh
a2VyZWYpOwogCiAJCS8qCiAJCSAqIElmIHdlIGFyZSBjb21pbmcgYmFjayBmcm9tIGJlaW5nIHJ1
bnRpbWUgc3VzcGVuZGVkIHdlIG11c3QKQEAgLTQ2Nyw4ICs0NjgsNyBAQCBzdGF0aWMgdTY0IGdl
dF9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAKIAkJc3Bpbl91bmxvY2tfaXJx
cmVzdG9yZSgmaTkxNS0+cG11LmxvY2ssIGZsYWdzKTsKIAl9IGVsc2UgewotCQlzdHJ1Y3QgcGNp
X2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2OwotCQlzdHJ1Y3QgZGV2aWNlICprZGV2ID0gJnBk
ZXYtPmRldjsKKwkJc3RydWN0IGRldmljZSAqa2RldiA9IHJwbS0+a2RldjsKIAogCQkvKgogCQkg
KiBXZSBhcmUgcnVudGltZSBzdXNwZW5kZWQuCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3N5c2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMKaW5k
ZXggM2VmMDdiOTg3ZDQwLi43NWFjYmY2ODZlYzkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfc3lzZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2Zz
LmMKQEAgLTI2NCw3ICsyNjQsNyBAQCBzdGF0aWMgc3NpemVfdCBndF9hY3RfZnJlcV9taHpfc2hv
dyhzdHJ1Y3QgZGV2aWNlICprZGV2LAogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCXUzMiBm
cmVxOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAogCWlm
IChJU19WQUxMRVlWSUVXKGRldl9wcml2KSB8fCBJU19DSEVSUllWSUVXKGRldl9wcml2KSkgewog
CQl2bHZfcHVuaXRfZ2V0KGRldl9wcml2KTsKQEAgLTI3Niw3ICsyNzYsNyBAQCBzdGF0aWMgc3Np
emVfdCBndF9hY3RfZnJlcV9taHpfc2hvdyhzdHJ1Y3QgZGV2aWNlICprZGV2LAogCQlmcmVxID0g
aW50ZWxfZ2V0X2NhZ2YoZGV2X3ByaXYsIEk5MTVfUkVBRChHRU42X1JQU1RBVDEpKTsKIAl9CiAK
LQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50ZWxfcnVudGlt
ZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCXJldHVybiBzbnBy
aW50ZihidWYsIFBBR0VfU0laRSwgIiVkXG4iLCBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgZnJl
cSkpOwogfQpAQCAtMzY0LDcgKzM2NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGd0X21heF9mcmVxX21o
el9zdG9yZShzdHJ1Y3QgZGV2aWNlICprZGV2LAogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAK
LQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCXdha2VyZWYgPSBp
bnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCW11dGV4X2xvY2so
JnJwcy0+bG9jayk7CiAKIAl2YWwgPSBpbnRlbF9mcmVxX29wY29kZShkZXZfcHJpdiwgdmFsKTsK
QEAgLTM5Miw3ICszOTIsNyBAQCBzdGF0aWMgc3NpemVfdCBndF9tYXhfZnJlcV9taHpfc3RvcmUo
c3RydWN0IGRldmljZSAqa2RldiwKIAogdW5sb2NrOgogCW11dGV4X3VubG9jaygmcnBzLT5sb2Nr
KTsKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50ZWxfcnVu
dGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAogCXJldHVybiBy
ZXQgPzogY291bnQ7CiB9CkBAIC00MjAsNyArNDIwLDcgQEAgc3RhdGljIHNzaXplX3QgZ3RfbWlu
X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCiAJaWYgKHJldCkKIAkJcmV0dXJu
IHJldDsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7CisJd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAJbXV0
ZXhfbG9jaygmcnBzLT5sb2NrKTsKIAogCXZhbCA9IGludGVsX2ZyZXFfb3Bjb2RlKGRldl9wcml2
LCB2YWwpOwpAQCAtNDQ0LDcgKzQ0NCw3IEBAIHN0YXRpYyBzc2l6ZV90IGd0X21pbl9mcmVxX21o
el9zdG9yZShzdHJ1Y3QgZGV2aWNlICprZGV2LAogCiB1bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZy
cHMtPmxvY2spOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlp
bnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCiAJ
cmV0dXJuIHJldCA/OiBjb3VudDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuYwpp
bmRleCA2MmZhNTczZjkwZTguLjE5OWVlNWNhM2VhMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaW50ZWxfZGlzcGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2Rpc3BsYXkuYwpAQCAtMjExMiw3ICsyMTEyLDcgQEAgaW50ZWxfcGluX2FuZF9mZW5jZV9mYl9v
Ymooc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsCiAJICogaW50ZWxfcnVudGltZV9wbV9wdXQo
KSwgc28gaXQgaXMgY29ycmVjdCB0byB3cmFwIG9ubHkgdGhlCiAJICogcGluL3VucGluL2ZlbmNl
IGFuZCBub3QgbW9yZS4KIAkgKi8KLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2
X3ByaXYpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRp
bWVfcG0pOwogCWk5MTVfZ2VtX29iamVjdF9sb2NrKG9iaik7CiAKIAlhdG9taWNfaW5jKCZkZXZf
cHJpdi0+Z3B1X2Vycm9yLnBlbmRpbmdfZmJfcGluKTsKQEAgLTIxNjksNyArMjE2OSw3IEBAIGlu
dGVsX3Bpbl9hbmRfZmVuY2VfZmJfb2JqKHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLAogCWF0
b21pY19kZWMoJmRldl9wcml2LT5ncHVfZXJyb3IucGVuZGluZ19mYl9waW4pOwogCiAJaTkxNV9n
ZW1fb2JqZWN0X3VubG9jayhvYmopOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3
YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdh
a2VyZWYpOwogCXJldHVybiB2bWE7CiB9CiAKQEAgLTEzODU0LDcgKzEzODU0LDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfYXRvbWljX2NvbW1pdF90YWlsKHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpz
dGF0ZSkKIAkJaW50ZWxfdW5jb3JlX2FybV91bmNsYWltZWRfbW1pb19kZXRlY3Rpb24oJmRldl9w
cml2LT51bmNvcmUpOwogCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgUE9XRVJf
RE9NQUlOX01PREVTRVQsIHdha2VyZWYpOwogCX0KLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZf
cHJpdiwgaW50ZWxfc3RhdGUtPndha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZf
cHJpdi0+cnVudGltZV9wbSwgaW50ZWxfc3RhdGUtPndha2VyZWYpOwogCiAJLyoKIAkgKiBEZWZl
ciB0aGUgY2xlYW51cCBvZiB0aGUgb2xkIHN0YXRlIHRvIGEgc2VwYXJhdGUgd29ya2VyIHRvIG5v
dApAQCAtMTM5MzMsNyArMTM5MzMsNyBAQCBzdGF0aWMgaW50IGludGVsX2F0b21pY19jb21taXQo
c3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSB0b19pOTE1KGRldik7CiAJaW50IHJldCA9IDA7CiAKLQlpbnRlbF9zdGF0ZS0+d2FrZXJl
ZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwlpbnRlbF9zdGF0ZS0+d2FrZXJl
ZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAKIAlkcm1f
YXRvbWljX3N0YXRlX2dldChzdGF0ZSk7CiAJaTkxNV9zd19mZW5jZV9pbml0KCZpbnRlbF9zdGF0
ZS0+Y29tbWl0X3JlYWR5LApAQCAtMTM5NzEsNyArMTM5NzEsNyBAQCBzdGF0aWMgaW50IGludGVs
X2F0b21pY19jb21taXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAlpZiAocmV0KSB7CiAJCURS
TV9ERUJVR19BVE9NSUMoIlByZXBhcmluZyBzdGF0ZSBmYWlsZWQgd2l0aCAlaVxuIiwgcmV0KTsK
IAkJaTkxNV9zd19mZW5jZV9jb21taXQoJmludGVsX3N0YXRlLT5jb21taXRfcmVhZHkpOwotCQlp
bnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgaW50ZWxfc3RhdGUtPndha2VyZWYpOworCQlp
bnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIGludGVsX3N0YXRlLT53
YWtlcmVmKTsKIAkJcmV0dXJuIHJldDsKIAl9CiAKQEAgLTEzOTgzLDcgKzEzOTgzLDcgQEAgc3Rh
dGljIGludCBpbnRlbF9hdG9taWNfY29tbWl0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCWk5
MTVfc3dfZmVuY2VfY29tbWl0KCZpbnRlbF9zdGF0ZS0+Y29tbWl0X3JlYWR5KTsKIAogCQlkcm1f
YXRvbWljX2hlbHBlcl9jbGVhbnVwX3BsYW5lcyhkZXYsIHN0YXRlKTsKLQkJaW50ZWxfcnVudGlt
ZV9wbV9wdXQoZGV2X3ByaXYsIGludGVsX3N0YXRlLT53YWtlcmVmKTsKKwkJaW50ZWxfcnVudGlt
ZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCBpbnRlbF9zdGF0ZS0+d2FrZXJlZik7CiAJ
CXJldHVybiByZXQ7CiAJfQogCWRldl9wcml2LT53bS5kaXN0cnVzdF9iaW9zX3dtID0gZmFsc2U7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMKaW5kZXggMmY5ZjRl
MWQ1ODg0Li5jYmQ4NjJmYmZkNzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2Rpc3BsYXlfcG93ZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kaXNw
bGF5X3Bvd2VyLmMKQEAgLTE2NDQsNyArMTY0NCw3IEBAIGludGVsX2Rpc3BsYXlfcG93ZXJfZ3Jh
Yl9hc3luY19wdXRfcmVmKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJZ290
byBvdXRfdmVyaWZ5OwogCiAJY2FuY2VsX2RlbGF5ZWRfd29yaygmcG93ZXJfZG9tYWlucy0+YXN5
bmNfcHV0X3dvcmspOwotCWludGVsX3J1bnRpbWVfcG1fcHV0X3JhdyhkZXZfcHJpdiwKKwlpbnRl
bF9ydW50aW1lX3BtX3B1dF9yYXcoJmRldl9wcml2LT5ydW50aW1lX3BtLAogCQkJCSBmZXRjaF9h
bmRfemVybygmcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X3dha2VyZWYpKTsKIG91dF92ZXJpZnk6
CiAJdmVyaWZ5X2FzeW5jX3B1dF9kb21haW5zX3N0YXRlKHBvd2VyX2RvbWFpbnMpOwpAQCAtMTY4
NCw3ICsxNjg0LDcgQEAgaW50ZWxfd2FrZXJlZl90IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJCQkJZW51bSBpbnRlbF9kaXNwbGF5
X3Bvd2VyX2RvbWFpbiBkb21haW4pCiB7CiAJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93
ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKLQlpbnRlbF93YWtlcmVmX3Qg
d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwlpbnRlbF93YWtlcmVm
X3Qgd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7
CiAKIAltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKIAlfX2ludGVsX2Rpc3BsYXlf
cG93ZXJfZ2V0X2RvbWFpbihkZXZfcHJpdiwgZG9tYWluKTsKQEAgLTE3MTMsNyArMTcxMyw3IEBA
IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCWJvb2wgaXNfZW5hYmxl
ZDsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoZGV2X3ByaXYp
OworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoJmRldl9wcml2LT5y
dW50aW1lX3BtKTsKIAlpZiAoIXdha2VyZWYpCiAJCXJldHVybiBmYWxzZTsKIApAQCAtMTcyOSw3
ICsxNzI5LDcgQEAgaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5s
b2NrKTsKIAogCWlmICghaXNfZW5hYmxlZCkgewotCQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZf
cHJpdiwgd2FrZXJlZik7CisJCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGlt
ZV9wbSwgd2FrZXJlZik7CiAJCXdha2VyZWYgPSAwOwogCX0KIApAQCAtMTc4Niw3ICsxNzg2LDcg
QEAgdm9pZCBpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF91bmNoZWNrZWQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAogCQkJCSAgICAgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJf
ZG9tYWluIGRvbWFpbikKIHsKIAlfX2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGRldl9wcml2LCBk
b21haW4pOwotCWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChkZXZfcHJpdik7CisJaW50
ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiB9CiAK
IHN0YXRpYyB2b2lkCkBAIC0xODA2LDYgKzE4MDYsNyBAQCByZWxlYXNlX2FzeW5jX3B1dF9kb21h
aW5zKHN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMsIHU2NCBtYXNrKQog
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9CiAJCWNvbnRhaW5lcl9vZihwb3dl
cl9kb21haW5zLCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwKIAkJCSAgICAgcG93ZXJfZG9tYWlu
cyk7CisJc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSA9ICZkZXZfcHJpdi0+cnVudGltZV9w
bTsKIAllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbjsKIAlpbnRlbF93YWtl
cmVmX3Qgd2FrZXJlZjsKIApAQCAtMTgxNCw4ICsxODE1LDggQEAgcmVsZWFzZV9hc3luY19wdXRf
ZG9tYWlucyhzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zLCB1NjQgbWFz
aykKIAkgKiB3YWtlcmVmIHRvIG1ha2UgdGhlIHN0YXRlIGNoZWNrZXIgaGFwcHkgYWJvdXQgdGhl
IEhXIGFjY2VzcyBkdXJpbmcKIAkgKiBwb3dlciB3ZWxsIGRpc2FibGluZy4KIAkgKi8KLQlhc3Nl
cnRfcnBtX3Jhd193YWtlcmVmX2hlbGQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKLQl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCWFzc2VydF9ycG1fcmF3X3dha2Vy
ZWZfaGVsZChycG0pOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChycG0pOwogCiAJ
Zm9yX2VhY2hfcG93ZXJfZG9tYWluKGRvbWFpbiwgbWFzaykgewogCQkvKiBDbGVhciBiZWZvcmUg
cHV0LCBzbyBwdXQncyBzYW5pdHkgY2hlY2sgaXMgaGFwcHkuICovCkBAIC0xODIzLDcgKzE4MjQs
NyBAQCByZWxlYXNlX2FzeW5jX3B1dF9kb21haW5zKHN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMg
KnBvd2VyX2RvbWFpbnMsIHU2NCBtYXNrKQogCQlfX2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2Rv
bWFpbihkZXZfcHJpdiwgZG9tYWluKTsKIAl9CiAKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZf
cHJpdiwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQocnBtLCB3YWtlcmVmKTsKIH0K
IAogc3RhdGljIHZvaWQKQEAgLTE4MzMsNyArMTgzNCw4IEBAIGludGVsX2Rpc3BsYXlfcG93ZXJf
cHV0X2FzeW5jX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogCQljb250YWluZXJfb2Yo
d29yaywgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUsCiAJCQkgICAgIHBvd2VyX2RvbWFpbnMuYXN5
bmNfcHV0X3dvcmsud29yayk7CiAJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9t
YWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKLQlpbnRlbF93YWtlcmVmX3QgbmV3X3dv
cmtfd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X3JhdyhkZXZfcHJpdik7CisJc3RydWN0
IGludGVsX3J1bnRpbWVfcG0gKnJwbSA9ICZkZXZfcHJpdi0+cnVudGltZV9wbTsKKwlpbnRlbF93
YWtlcmVmX3QgbmV3X3dvcmtfd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X3JhdyhycG0p
OwogCWludGVsX3dha2VyZWZfdCBvbGRfd29ya193YWtlcmVmID0gMDsKIAogCW11dGV4X2xvY2so
JnBvd2VyX2RvbWFpbnMtPmxvY2spOwpAQCAtMTg2Myw5ICsxODY1LDkgQEAgaW50ZWxfZGlzcGxh
eV9wb3dlcl9wdXRfYXN5bmNfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAJbXV0ZXhf
dW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKIAogCWlmIChvbGRfd29ya193YWtlcmVmKQot
CQlpbnRlbF9ydW50aW1lX3BtX3B1dF9yYXcoZGV2X3ByaXYsIG9sZF93b3JrX3dha2VyZWYpOwor
CQlpbnRlbF9ydW50aW1lX3BtX3B1dF9yYXcocnBtLCBvbGRfd29ya193YWtlcmVmKTsKIAlpZiAo
bmV3X3dvcmtfd2FrZXJlZikKLQkJaW50ZWxfcnVudGltZV9wbV9wdXRfcmF3KGRldl9wcml2LCBu
ZXdfd29ya193YWtlcmVmKTsKKwkJaW50ZWxfcnVudGltZV9wbV9wdXRfcmF3KHJwbSwgbmV3X3dv
cmtfd2FrZXJlZik7CiB9CiAKIC8qKgpAQCAtMTg4Myw3ICsxODg1LDggQEAgdm9pZCBfX2ludGVs
X2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAog
CQkJCSAgICAgaW50ZWxfd2FrZXJlZl90IHdha2VyZWYpCiB7CiAJc3RydWN0IGk5MTVfcG93ZXJf
ZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOwotCWludGVsX3dh
a2VyZWZfdCB3b3JrX3dha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9yYXcoaTkxNSk7CisJ
c3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSA9ICZpOTE1LT5ydW50aW1lX3BtOworCWludGVs
X3dha2VyZWZfdCB3b3JrX3dha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9yYXcocnBtKTsK
IAogCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwogCkBAIC0xOTEwLDkgKzE5MTMs
OSBAQCB2b2lkIF9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfYXN5bmMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCiAJbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKIAog
CWlmICh3b3JrX3dha2VyZWYpCi0JCWludGVsX3J1bnRpbWVfcG1fcHV0X3JhdyhpOTE1LCB3b3Jr
X3dha2VyZWYpOworCQlpbnRlbF9ydW50aW1lX3BtX3B1dF9yYXcocnBtLCB3b3JrX3dha2VyZWYp
OwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGlt
ZV9wbV9wdXQocnBtLCB3YWtlcmVmKTsKIH0KIAogLyoqCkBAIC0xOTQ4LDcgKzE5NTEsNyBAQCB2
b2lkIGludGVsX2Rpc3BsYXlfcG93ZXJfZmx1c2hfd29yayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKIAltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwogCiAJaWYgKHdv
cmtfd2FrZXJlZikKLQkJaW50ZWxfcnVudGltZV9wbV9wdXRfcmF3KGk5MTUsIHdvcmtfd2FrZXJl
Zik7CisJCWludGVsX3J1bnRpbWVfcG1fcHV0X3JhdygmaTkxNS0+cnVudGltZV9wbSwgd29ya193
YWtlcmVmKTsKIH0KIAogLyoqCkBAIC0xOTg3LDcgKzE5OTAsNyBAQCB2b2lkIGludGVsX2Rpc3Bs
YXlfcG93ZXJfcHV0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJCSAgICAg
aW50ZWxfd2FrZXJlZl90IHdha2VyZWYpCiB7CiAJX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChk
ZXZfcHJpdiwgZG9tYWluKTsKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJl
Zik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVm
KTsKIH0KICNlbmRpZgogCkBAIC00Mzk5LDcgKzQ0MDIsNyBAQCB2b2lkIGludGVsX3Bvd2VyX2Rv
bWFpbnNfZmluaV9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlpbnRlbF9wb3dl
cl9kb21haW5zX3ZlcmlmeV9zdGF0ZShpOTE1KTsKIAogCS8qIEtlZXAgdGhlIHBvd2VyIHdlbGwg
ZW5hYmxlZCwgYnV0IGNhbmNlbCBpdHMgcnBtIHdha2VyZWYuICovCi0JaW50ZWxfcnVudGltZV9w
bV9wdXQoaTkxNSwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRp
bWVfcG0sIHdha2VyZWYpOwogfQogCiAvKioKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2ZiZGV2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mYmRldi5jCmlu
ZGV4IDBkM2E2ZmE2NzRlNi4uMWVkZDQ0ZWUzMmIyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9mYmRldi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Zi
ZGV2LmMKQEAgLTIxMyw3ICsyMTMsNyBAQCBzdGF0aWMgaW50IGludGVsZmJfY3JlYXRlKHN0cnVj
dCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCiAJfQogCiAJbXV0ZXhfbG9jaygmZGV2LT5zdHJ1Y3Rf
bXV0ZXgpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7CisJd2Fr
ZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAKIAkv
KiBQaW4gdGhlIEdHVFQgdm1hIGZvciBvdXIgYWNjZXNzIHZpYSBpbmZvLT5zY3JlZW5fYmFzZS4K
IAkgKiBUaGlzIGFsc28gdmFsaWRhdGVzIHRoYXQgYW55IGV4aXN0aW5nIGZiIGluaGVyaXRlZCBm
cm9tIHRoZQpAQCAtMjcyLDcgKzI3Miw3IEBAIHN0YXRpYyBpbnQgaW50ZWxmYl9jcmVhdGUoc3Ry
dWN0IGRybV9mYl9oZWxwZXIgKmhlbHBlciwKIAlpZmJkZXYtPnZtYSA9IHZtYTsKIAlpZmJkZXYt
PnZtYV9mbGFncyA9IGZsYWdzOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoZGV2X3ByaXYsIHdh
a2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2Fr
ZXJlZik7CiAJbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7CiAJdmdhX3N3aXRjaGVy
b29fY2xpZW50X2ZiX3NldChwZGV2LCBpbmZvKTsKIAlyZXR1cm4gMDsKQEAgLTI4MCw3ICsyODAs
NyBAQCBzdGF0aWMgaW50IGludGVsZmJfY3JlYXRlKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxw
ZXIsCiBvdXRfdW5waW46CiAJaW50ZWxfdW5waW5fZmJfdm1hKHZtYSwgZmxhZ3MpOwogb3V0X3Vu
bG9jazoKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50ZWxf
cnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91
bmxvY2soJmRldi0+c3RydWN0X211dGV4KTsKIAlyZXR1cm4gcmV0OwogfQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfaG90cGx1Zy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfaG90cGx1Zy5jCmluZGV4IGZmOWViM2M4NTVkMy4uZWEzZGU0YWNjODUwIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ob3RwbHVnLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfaG90cGx1Zy5jCkBAIC0yMzAsNyArMjMwLDcgQEAgc3RhdGlj
IHZvaWQgaW50ZWxfaHBkX2lycV9zdG9ybV9yZWVuYWJsZV93b3JrKHN0cnVjdCB3b3JrX3N0cnVj
dCAqd29yaykKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAllbnVtIGhwZF9waW4gcGluOwog
Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwl3YWtlcmVmID0g
aW50ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAogCXNwaW5fbG9j
a19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7CiAJZm9yX2VhY2hfaHBkX3BpbihwaW4pIHsKQEAg
LTI2Myw3ICsyNjMsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9ocGRfaXJxX3N0b3JtX3JlZW5hYmxl
X3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogCQlkZXZfcHJpdi0+ZGlzcGxheS5ocGRf
aXJxX3NldHVwKGRldl9wcml2KTsKIAlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9j
ayk7CiAKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJaW50ZWxf
cnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIH0KIAogYm9v
bCBpbnRlbF9lbmNvZGVyX2hvdHBsdWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ydW50aW1lX3BtLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ydW50aW1lX3BtLmMKaW5kZXggM2Q5ZWEzNDk4Njc5Li41
MDJjNTQ0Mjg1NzAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3J1bnRp
bWVfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ydW50aW1lX3BtLmMKQEAg
LTM2OSw3ICszNjksNyBAQCBzdGF0aWMgaW50ZWxfd2FrZXJlZl90IF9faW50ZWxfcnVudGltZV9w
bV9nZXQoc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSwKIAogLyoqCiAgKiBpbnRlbF9ydW50
aW1lX3BtX2dldF9yYXcgLSBncmFiIGEgcmF3IHJ1bnRpbWUgcG0gcmVmZXJlbmNlCi0gKiBAaTkx
NTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKKyAqIEBycG06IHRoZSBpbnRlbF9ydW50aW1lX3BtIHN0
cnVjdHVyZQogICoKICAqIFRoaXMgaXMgdGhlIHVubG9ja2VkIHZlcnNpb24gb2YgaW50ZWxfZGlz
cGxheV9wb3dlcl9pc19lbmFibGVkKCkgYW5kIHNob3VsZAogICogb25seSBiZSB1c2VkIGZyb20g
ZXJyb3IgY2FwdHVyZSBhbmQgcmVjb3ZlcnkgY29kZSB3aGVyZSBkZWFkbG9ja3MgYXJlCkBAIC0z
ODQsMTUgKzM4NCwxNCBAQCBzdGF0aWMgaW50ZWxfd2FrZXJlZl90IF9faW50ZWxfcnVudGltZV9w
bV9nZXQoc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSwKICAqIFJldHVybnM6IHRoZSB3YWtl
cmVmIGNvb2tpZSB0byBwYXNzIHRvIGludGVsX3J1bnRpbWVfcG1fcHV0X3JhdygpLCBldmFsdWF0
ZXMKICAqIGFzIFRydWUgaWYgdGhlIHdha2VyZWYgd2FzIGFjcXVpcmVkLCBvciBGYWxzZSBvdGhl
cndpc2UuCiAgKi8KLQotaW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVfcG1fZ2V0X3Jhdyhz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK2ludGVsX3dha2VyZWZfdCBpbnRlbF9ydW50
aW1lX3BtX2dldF9yYXcoc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSkKIHsKLQlyZXR1cm4g
X19pbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSwgZmFsc2UpOworCXJldHVy
biBfX2ludGVsX3J1bnRpbWVfcG1fZ2V0KHJwbSwgZmFsc2UpOwogfQogCiAvKioKICAqIGludGVs
X3J1bnRpbWVfcG1fZ2V0IC0gZ3JhYiBhIHJ1bnRpbWUgcG0gcmVmZXJlbmNlCi0gKiBAaTkxNTog
aTkxNSBkZXZpY2UgaW5zdGFuY2UKKyAqIEBycG06IHRoZSBpbnRlbF9ydW50aW1lX3BtIHN0cnVj
dHVyZQogICoKICAqIFRoaXMgZnVuY3Rpb24gZ3JhYnMgYSBkZXZpY2UtbGV2ZWwgcnVudGltZSBw
bSByZWZlcmVuY2UgKG1vc3RseSB1c2VkIGZvciBHRU0KICAqIGNvZGUgdG8gZW5zdXJlIHRoZSBH
VFQgb3IgR1QgaXMgb24pIGFuZCBlbnN1cmVzIHRoYXQgaXQgaXMgcG93ZXJlZCB1cC4KQEAgLTQw
MiwxNCArNDAxLDE0IEBAIGludGVsX3dha2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9yYXco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAgKgogICogUmV0dXJuczogdGhlIHdha2Vy
ZWYgY29va2llIHRvIHBhc3MgdG8gaW50ZWxfcnVudGltZV9wbV9wdXQoKQogICovCi1pbnRlbF93
YWtlcmVmX3QgaW50ZWxfcnVudGltZV9wbV9nZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCitpbnRlbF93YWtlcmVmX3QgaW50ZWxfcnVudGltZV9wbV9nZXQoc3RydWN0IGludGVsX3J1
bnRpbWVfcG0gKnJwbSkKIHsKLQlyZXR1cm4gX19pbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+
cnVudGltZV9wbSwgdHJ1ZSk7CisJcmV0dXJuIF9faW50ZWxfcnVudGltZV9wbV9nZXQocnBtLCB0
cnVlKTsKIH0KIAogLyoqCiAgKiBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UgLSBncmFi
IGEgcnVudGltZSBwbSByZWZlcmVuY2UgaWYgZGV2aWNlIGluIHVzZQotICogQGk5MTU6IGk5MTUg
ZGV2aWNlIGluc3RhbmNlCisgKiBAcnBtOiB0aGUgaW50ZWxfcnVudGltZV9wbSBzdHJ1Y3R1cmUK
ICAqCiAgKiBUaGlzIGZ1bmN0aW9uIGdyYWJzIGEgZGV2aWNlLWxldmVsIHJ1bnRpbWUgcG0gcmVm
ZXJlbmNlIGlmIHRoZSBkZXZpY2UgaXMKICAqIGFscmVhZHkgaW4gdXNlIGFuZCBlbnN1cmVzIHRo
YXQgaXQgaXMgcG93ZXJlZCB1cC4gSXQgaXMgaWxsZWdhbCB0byB0cnkKQEAgLTQyMSwxMCArNDIw
LDggQEAgaW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVfcG1fZ2V0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQogICogUmV0dXJuczogdGhlIHdha2VyZWYgY29va2llIHRvIHBhc3Mg
dG8gaW50ZWxfcnVudGltZV9wbV9wdXQoKSwgZXZhbHVhdGVzCiAgKiBhcyBUcnVlIGlmIHRoZSB3
YWtlcmVmIHdhcyBhY3F1aXJlZCwgb3IgRmFsc2Ugb3RoZXJ3aXNlLgogICovCi1pbnRlbF93YWtl
cmVmX3QgaW50ZWxfcnVudGltZV9wbV9nZXRfaWZfaW5fdXNlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQoraW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3Vz
ZShzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtKQogewotCXN0cnVjdCBpbnRlbF9ydW50aW1l
X3BtICpycG0gPSAmaTkxNS0+cnVudGltZV9wbTsKLQogCWlmIChJU19FTkFCTEVEKENPTkZJR19Q
TSkpIHsKIAkJLyoKIAkJICogSW4gY2FzZXMgcnVudGltZSBQTSBpcyBkaXNhYmxlZCBieSB0aGUg
UlBNIGNvcmUgYW5kIHdlIGdldApAQCAtNDQzLDcgKzQ0MCw3IEBAIGludGVsX3dha2VyZWZfdCBp
bnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCiAKIC8qKgogICogaW50ZWxfcnVudGltZV9wbV9nZXRfbm9yZXN1bWUgLSBncmFiIGEgcnVu
dGltZSBwbSByZWZlcmVuY2UKLSAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQorICogQHJw
bTogdGhlIGludGVsX3J1bnRpbWVfcG0gc3RydWN0dXJlCiAgKgogICogVGhpcyBmdW5jdGlvbiBn
cmFicyBhIGRldmljZS1sZXZlbCBydW50aW1lIHBtIHJlZmVyZW5jZSAobW9zdGx5IHVzZWQgZm9y
IEdFTQogICogY29kZSB0byBlbnN1cmUgdGhlIEdUVCBvciBHVCBpcyBvbikuCkBAIC00NjAsMTAg
KzQ1Nyw4IEBAIGludGVsX3dha2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2Uo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAgKgogICogUmV0dXJuczogdGhlIHdha2Vy
ZWYgY29va2llIHRvIHBhc3MgdG8gaW50ZWxfcnVudGltZV9wbV9wdXQoKQogICovCi1pbnRlbF93
YWtlcmVmX3QgaW50ZWxfcnVudGltZV9wbV9nZXRfbm9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCitpbnRlbF93YWtlcmVmX3QgaW50ZWxfcnVudGltZV9wbV9nZXRfbm9yZXN1
bWUoc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSkKIHsKLQlzdHJ1Y3QgaW50ZWxfcnVudGlt
ZV9wbSAqcnBtID0gJmk5MTUtPnJ1bnRpbWVfcG07Ci0KIAlhc3NlcnRfcnBtX3dha2Vsb2NrX2hl
bGQocnBtKTsKIAlwbV9ydW50aW1lX2dldF9ub3Jlc3VtZShycG0tPmtkZXYpOwogCkBAIC00ODgs
NyArNDgzLDcgQEAgc3RhdGljIHZvaWQgX19pbnRlbF9ydW50aW1lX3BtX3B1dChzdHJ1Y3QgaW50
ZWxfcnVudGltZV9wbSAqcnBtLAogCiAvKioKICAqIGludGVsX3J1bnRpbWVfcG1fcHV0X3JhdyAt
IHJlbGVhc2UgYSByYXcgcnVudGltZSBwbSByZWZlcmVuY2UKLSAqIEBpOTE1OiBpOTE1IGRldmlj
ZSBpbnN0YW5jZQorICogQHJwbTogdGhlIGludGVsX3J1bnRpbWVfcG0gc3RydWN0dXJlCiAgKiBA
d3JlZjogd2FrZXJlZiBhY3F1aXJlZCBmb3IgdGhlIHJlZmVyZW5jZSB0aGF0IGlzIGJlaW5nIHJl
bGVhc2VkCiAgKgogICogVGhpcyBmdW5jdGlvbiBkcm9wcyB0aGUgZGV2aWNlLWxldmVsIHJ1bnRp
bWUgcG0gcmVmZXJlbmNlIG9idGFpbmVkIGJ5CkBAIC00OTYsMTQgKzQ5MSwxNCBAQCBzdGF0aWMg
dm9pZCBfX2ludGVsX3J1bnRpbWVfcG1fcHV0KHN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0s
CiAgKiBoYXJkd2FyZSBibG9jayByaWdodCBhd2F5IGlmIHRoaXMgaXMgdGhlIGxhc3QgcmVmZXJl
bmNlLgogICovCiB2b2lkCi1pbnRlbF9ydW50aW1lX3BtX3B1dF9yYXcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsIGludGVsX3dha2VyZWZfdCB3cmVmKQoraW50ZWxfcnVudGltZV9wbV9w
dXRfcmF3KHN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0sIGludGVsX3dha2VyZWZfdCB3cmVm
KQogewotCV9faW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdyZWYsIGZh
bHNlKTsKKwlfX2ludGVsX3J1bnRpbWVfcG1fcHV0KHJwbSwgd3JlZiwgZmFsc2UpOwogfQogCiAv
KioKICAqIGludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZCAtIHJlbGVhc2UgYW4gdW5jaGVj
a2VkIHJ1bnRpbWUgcG0gcmVmZXJlbmNlCi0gKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UK
KyAqIEBycG06IHRoZSBpbnRlbF9ydW50aW1lX3BtIHN0cnVjdHVyZQogICoKICAqIFRoaXMgZnVu
Y3Rpb24gZHJvcHMgdGhlIGRldmljZS1sZXZlbCBydW50aW1lIHBtIHJlZmVyZW5jZSBvYnRhaW5l
ZCBieQogICogaW50ZWxfcnVudGltZV9wbV9nZXQoKSBhbmQgbWlnaHQgcG93ZXIgZG93biB0aGUg
Y29ycmVzcG9uZGluZwpAQCAtNTEzLDI0ICs1MDgsMjQgQEAgaW50ZWxfcnVudGltZV9wbV9wdXRf
cmF3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnRlbF93YWtlcmVmX3Qgd3JlZikK
ICAqIG5ldyBjb2RlLCBhcyB0aGUgY29ycmVjdG5lc3Mgb2YgaXRzIHVzZSBjYW5ub3QgYmUgY2hl
Y2tlZC4gQWx3YXlzIHVzZQogICogaW50ZWxfcnVudGltZV9wbV9wdXQoKSBpbnN0ZWFkLgogICov
Ci12b2lkIGludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKK3ZvaWQgaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKHN0cnVjdCBp
bnRlbF9ydW50aW1lX3BtICpycG0pCiB7Ci0JX19pbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+
cnVudGltZV9wbSwgLTEsIHRydWUpOworCV9faW50ZWxfcnVudGltZV9wbV9wdXQocnBtLCAtMSwg
dHJ1ZSk7CiB9CiAKICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19SVU5USU1F
X1BNKQogLyoqCiAgKiBpbnRlbF9ydW50aW1lX3BtX3B1dCAtIHJlbGVhc2UgYSBydW50aW1lIHBt
IHJlZmVyZW5jZQotICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCisgKiBAcnBtOiB0aGUg
aW50ZWxfcnVudGltZV9wbSBzdHJ1Y3R1cmUKICAqIEB3cmVmOiB3YWtlcmVmIGFjcXVpcmVkIGZv
ciB0aGUgcmVmZXJlbmNlIHRoYXQgaXMgYmVpbmcgcmVsZWFzZWQKICAqCiAgKiBUaGlzIGZ1bmN0
aW9uIGRyb3BzIHRoZSBkZXZpY2UtbGV2ZWwgcnVudGltZSBwbSByZWZlcmVuY2Ugb2J0YWluZWQg
YnkKICAqIGludGVsX3J1bnRpbWVfcG1fZ2V0KCkgYW5kIG1pZ2h0IHBvd2VyIGRvd24gdGhlIGNv
cnJlc3BvbmRpbmcKICAqIGhhcmR3YXJlIGJsb2NrIHJpZ2h0IGF3YXkgaWYgdGhpcyBpcyB0aGUg
bGFzdCByZWZlcmVuY2UuCiAgKi8KLXZvaWQgaW50ZWxfcnVudGltZV9wbV9wdXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludGVsX3dha2VyZWZfdCB3cmVmKQordm9pZCBpbnRlbF9y
dW50aW1lX3BtX3B1dChzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtLCBpbnRlbF93YWtlcmVm
X3Qgd3JlZikKIHsKLQlfX2ludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3
cmVmLCB0cnVlKTsKKwlfX2ludGVsX3J1bnRpbWVfcG1fcHV0KHJwbSwgd3JlZiwgdHJ1ZSk7CiB9
CiAjZW5kaWYKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGlt
ZV9wbS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGltZV9wbS5oCmluZGV4IDA4
OTBlNjk4ZjE5Ni4uZjY0NDVjYTViYmYxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9ydW50aW1lX3BtLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVu
dGltZV9wbS5oCkBAIC0xNzQsMzAgKzE3NCwzMCBAQCB2b2lkIGludGVsX3J1bnRpbWVfcG1fZW5h
YmxlKHN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0pOwogdm9pZCBpbnRlbF9ydW50aW1lX3Bt
X2Rpc2FibGUoc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSk7CiB2b2lkIGludGVsX3J1bnRp
bWVfcG1fY2xlYW51cChzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtKTsKIAotaW50ZWxfd2Fr
ZXJlZl90IGludGVsX3J1bnRpbWVfcG1fZ2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KTsKLWludGVsX3dha2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2Uoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwotaW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVf
cG1fZ2V0X25vcmVzdW1lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKLWludGVsX3dh
a2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9yYXcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpOworaW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVfcG1fZ2V0KHN0cnVjdCBpbnRl
bF9ydW50aW1lX3BtICpycG0pOworaW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVfcG1fZ2V0
X2lmX2luX3VzZShzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtKTsKK2ludGVsX3dha2VyZWZf
dCBpbnRlbF9ydW50aW1lX3BtX2dldF9ub3Jlc3VtZShzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAq
cnBtKTsKK2ludGVsX3dha2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9yYXcoc3RydWN0IGlu
dGVsX3J1bnRpbWVfcG0gKnJwbSk7CiAKICNkZWZpbmUgd2l0aF9pbnRlbF9ydW50aW1lX3BtKGk5
MTUsIHdmKSBcCi0JZm9yICgod2YpID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7ICh3Zik7
IFwKLQkgICAgIGludGVsX3J1bnRpbWVfcG1fcHV0KChpOTE1KSwgKHdmKSksICh3ZikgPSAwKQor
CWZvciAoKHdmKSA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCYoaTkxNSktPnJ1bnRpbWVfcG0pOyAo
d2YpOyBcCisJICAgICBpbnRlbF9ydW50aW1lX3BtX3B1dCgmKGk5MTUpLT5ydW50aW1lX3BtLCAo
d2YpKSwgKHdmKSA9IDApCiAKICNkZWZpbmUgd2l0aF9pbnRlbF9ydW50aW1lX3BtX2lmX2luX3Vz
ZShpOTE1LCB3ZikgXAotCWZvciAoKHdmKSA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3Vz
ZShpOTE1KTsgKHdmKTsgXAotCSAgICAgaW50ZWxfcnVudGltZV9wbV9wdXQoKGk5MTUpLCAod2Yp
KSwgKHdmKSA9IDApCisJZm9yICgod2YpID0gaW50ZWxfcnVudGltZV9wbV9nZXRfaWZfaW5fdXNl
KCYoaTkxNSktPnJ1bnRpbWVfcG0pOyAod2YpOyBcCisJICAgICBpbnRlbF9ydW50aW1lX3BtX3B1
dCgmKGk5MTUpLT5ydW50aW1lX3BtLCAod2YpKSwgKHdmKSA9IDApCiAKLXZvaWQgaW50ZWxfcnVu
dGltZV9wbV9wdXRfdW5jaGVja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKK3Zv
aWQgaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKHN0cnVjdCBpbnRlbF9ydW50aW1lX3Bt
ICpycG0pOwogI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX1JVTlRJTUVfUE0p
Ci12b2lkIGludGVsX3J1bnRpbWVfcG1fcHV0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LCBpbnRlbF93YWtlcmVmX3Qgd3JlZik7Cit2b2lkIGludGVsX3J1bnRpbWVfcG1fcHV0KHN0cnVj
dCBpbnRlbF9ydW50aW1lX3BtICpycG0sIGludGVsX3dha2VyZWZfdCB3cmVmKTsKICNlbHNlCiBz
dGF0aWMgaW5saW5lIHZvaWQKLWludGVsX3J1bnRpbWVfcG1fcHV0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LCBpbnRlbF93YWtlcmVmX3Qgd3JlZikKK2ludGVsX3J1bnRpbWVfcG1fcHV0
KHN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0sIGludGVsX3dha2VyZWZfdCB3cmVmKQogewot
CWludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZChpOTE1KTsKKwlpbnRlbF9ydW50aW1lX3Bt
X3B1dF91bmNoZWNrZWQocnBtKTsKIH0KICNlbmRpZgotdm9pZCBpbnRlbF9ydW50aW1lX3BtX3B1
dF9yYXcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGludGVsX3dha2VyZWZfdCB3cmVm
KTsKK3ZvaWQgaW50ZWxfcnVudGltZV9wbV9wdXRfcmF3KHN0cnVjdCBpbnRlbF9ydW50aW1lX3Bt
ICpycG0sIGludGVsX3dha2VyZWZfdCB3cmVmKTsKIAogI2lmIElTX0VOQUJMRUQoQ09ORklHX0RS
TV9JOTE1X0RFQlVHX1JVTlRJTUVfUE0pCiB2b2lkIHByaW50X2ludGVsX3J1bnRpbWVfcG1fd2Fr
ZXJlZihzdHJ1Y3QgaW50ZWxfcnVudGltZV9wbSAqcnBtLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfd2FrZXJlZi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
d2FrZXJlZi5jCmluZGV4IGI2YzcxNjdjZTE1NC4uYjY3N2FlODkzZDZmIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93YWtlcmVmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfd2FrZXJlZi5jCkBAIC05LDE0ICs5LDE0IEBACiAKIHN0YXRpYyB2b2lkIHJw
bV9nZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBpbnRlbF93YWtlcmVm
ICp3ZikKIHsKLQl3Zi0+d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdm
LT53YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogfQog
CiBzdGF0aWMgdm9pZCBycG1fcHV0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBzdHJ1
Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiB7CiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWYgPSBmZXRj
aF9hbmRfemVybygmd2YtPndha2VyZWYpOwogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwg
d2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2Vy
ZWYpOwogCUdFTV9CVUdfT04oIXdha2VyZWYpOwogfQogCkBAIC04Niw3ICs4Niw3IEBAIHN0YXRp
YyB2b2lkIHdha2VyZWZfYXV0b190aW1lb3V0KHN0cnVjdCB0aW1lcl9saXN0ICp0KQogCXdha2Vy
ZWYgPSBmZXRjaF9hbmRfemVybygmd2YtPndha2VyZWYpOwogCXNwaW5fdW5sb2NrX2lycXJlc3Rv
cmUoJndmLT5sb2NrLCBmbGFncyk7CiAKLQlpbnRlbF9ydW50aW1lX3BtX3B1dCh3Zi0+aTkxNSwg
d2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJndmLT5pOTE1LT5ydW50aW1lX3BtLCB3
YWtlcmVmKTsKIH0KIAogdm9pZCBpbnRlbF93YWtlcmVmX2F1dG9faW5pdChzdHJ1Y3QgaW50ZWxf
d2FrZXJlZl9hdXRvICp3ZiwKQEAgLTExNiw3ICsxMTYsNyBAQCB2b2lkIGludGVsX3dha2VyZWZf
YXV0byhzdHJ1Y3QgaW50ZWxfd2FrZXJlZl9hdXRvICp3ZiwgdW5zaWduZWQgbG9uZyB0aW1lb3V0
KQogCQlzcGluX2xvY2tfaXJxc2F2ZSgmd2YtPmxvY2ssIGZsYWdzKTsKIAkJaWYgKCFyZWZjb3Vu
dF9pbmNfbm90X3plcm8oJndmLT5jb3VudCkpIHsKIAkJCUdFTV9CVUdfT04od2YtPndha2VyZWYp
OwotCQkJd2YtPndha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2Uod2YtPmk5
MTUpOworCQkJd2YtPndha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoJndm
LT5pOTE1LT5ydW50aW1lX3BtKTsKIAkJCXJlZmNvdW50X3NldCgmd2YtPmNvdW50LCAxKTsKIAkJ
fQogCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ3Zi0+bG9jaywgZmxhZ3MpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYwppbmRleCBjYzFjYTRiZTFhMDAu
LmMwYjM1MzdhNWZhNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2k5MTVfYWN0aXZlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVf
YWN0aXZlLmMKQEAgLTk3LDcgKzk3LDcgQEAgc3RhdGljIGludCBsaXZlX2FjdGl2ZV93YWl0KHZv
aWQgKmFyZykKIAkvKiBDaGVjayB0aGF0IHdlIGdldCBhIGNhbGxiYWNrIHdoZW4gcmVxdWVzdHMg
cmV0aXJlIHVwb24gd2FpdGluZyAqLwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2VyZWYg
PSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAllcnIgPSBfX2xp
dmVfYWN0aXZlX3NldHVwKGk5MTUsICZhY3RpdmUpOwogCkBAIC0xMTEsNyArMTExLDcgQEAgc3Rh
dGljIGludCBsaXZlX2FjdGl2ZV93YWl0KHZvaWQgKmFyZykKIAlpZiAoaWd0X2ZsdXNoX3Rlc3Qo
aTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCkpCiAJCWVyciA9IC1FSU87CiAKLQlpbnRlbF9ydW50aW1l
X3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVu
dGltZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKIAlyZXR1cm4gZXJyOwogfQpAQCAtMTI2LDcgKzEyNiw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9h
Y3RpdmVfcmV0aXJlKHZvaWQgKmFyZykKIAkvKiBDaGVjayB0aGF0IHdlIGdldCBhIGNhbGxiYWNr
IHdoZW4gcmVxdWVzdHMgYXJlIGluZGlyZWN0bHkgcmV0aXJlZCAqLwogCiAJbXV0ZXhfbG9jaygm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0
KGk5MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9w
bSk7CiAKIAllcnIgPSBfX2xpdmVfYWN0aXZlX3NldHVwKGk5MTUsICZhY3RpdmUpOwogCkBAIC0x
NDAsNyArMTQwLDcgQEAgc3RhdGljIGludCBsaXZlX2FjdGl2ZV9yZXRpcmUodm9pZCAqYXJnKQog
CX0KIAogCWk5MTVfYWN0aXZlX2ZpbmkoJmFjdGl2ZS5iYXNlKTsKLQlpbnRlbF9ydW50aW1lX3Bt
X3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGlt
ZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
IAlyZXR1cm4gZXJyOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0u
YwppbmRleCA4MzY0MzkyOTQxNmMuLjIzYTU0ZGE0N2NhNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMKQEAgLTYzLDcgKzYzLDcgQEAgc3RhdGljIHZvaWQgc2lt
dWxhdGVfaGliZXJuYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogCWludGVs
X3dha2VyZWZfdCB3YWtlcmVmOwogCi0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5
MTUpOworCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7
CiAKIAkvKgogCSAqIEFzIGEgZmluYWwgc3RpbmcgaW4gdGhlIHRhaWwsIGludmFsaWRhdGUgc3Rv
bGVuLiBVbmRlciBhIHJlYWwgUzQsCkBAIC03NCw3ICs3NCw3IEBAIHN0YXRpYyB2b2lkIHNpbXVs
YXRlX2hpYmVybmF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkgKi8KIAl0cmFz
aF9zdG9sZW4oaTkxNSk7CiAKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsK
KwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiB9CiAK
IHN0YXRpYyBpbnQgcG1fcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMKaW5kZXgg
MWQ4MjM1MzAzZWRmLi41YThiZWUzYTFkOTAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jCkBAIC00MDAsNyArNDAwLDcgQEAgc3RhdGljIGlu
dCBpZ3RfZXZpY3RfY29udGV4dHModm9pZCAqYXJnKQogCQlyZXR1cm4gMDsKIAogCW11dGV4X2xv
Y2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3Bt
X2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRp
bWVfcG0pOwogCiAJLyogUmVzZXJ2ZSBhIGJsb2NrIHNvIHRoYXQgd2Uga25vdyB3ZSBoYXZlIGVu
b3VnaCB0byBmaXQgYSBmZXcgcnEgKi8KIAltZW1zZXQoJmhvbGUsIDAsIHNpemVvZihob2xlKSk7
CkBAIC01MTEsNyArNTExLDcgQEAgc3RhdGljIGludCBpZ3RfZXZpY3RfY29udGV4dHModm9pZCAq
YXJnKQogCX0KIAlpZiAoZHJtX21tX25vZGVfYWxsb2NhdGVkKCZob2xlKSkKIAkJZHJtX21tX3Jl
bW92ZV9ub2RlKCZob2xlKTsKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsK
KwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0
ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCXJldHVybiBlcnI7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMKaW5kZXggYTU1N2U3
N2Q5YzU0Li5kZjc1ZGY5YjUyZmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvaTkxNV9nZW1fZ3R0LmMKQEAgLTI5NSw5ICsyOTUsOSBAQCBzdGF0aWMgaW50IGxvd2xldmVs
X2hvbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCQltb2NrX3ZtYS5ub2RlLnNp
emUgPSBCSVRfVUxMKHNpemUpOwogCQkJbW9ja192bWEubm9kZS5zdGFydCA9IGFkZHI7CiAKLQkJ
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwkJCXdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAJCQl2bS0+aW5zZXJ0X2VudHJp
ZXModm0sICZtb2NrX3ZtYSwgSTkxNV9DQUNIRV9OT05FLCAwKTsKLQkJCWludGVsX3J1bnRpbWVf
cG1fcHV0KGk5MTUsIHdha2VyZWYpOworCQkJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1
bnRpbWVfcG0sIHdha2VyZWYpOwogCQl9CiAJCWNvdW50ID0gbjsKIApAQCAtMTE3MSw3ICsxMTcx
LDcgQEAgc3RhdGljIGludCBpZ3RfZ2d0dF9wYWdlKHZvaWQgKmFyZykKIAlpZiAoZXJyKQogCQln
b3RvIG91dF91bnBpbjsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsK
Kwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJ
Zm9yIChuID0gMDsgbiA8IGNvdW50OyBuKyspIHsKIAkJdTY0IG9mZnNldCA9IHRtcC5zdGFydCAr
IG4gKiBQQUdFX1NJWkU7CkBAIC0xMjE4LDcgKzEyMTgsNyBAQCBzdGF0aWMgaW50IGlndF9nZ3R0
X3BhZ2Uodm9pZCAqYXJnKQogCWtmcmVlKG9yZGVyKTsKIG91dF9yZW1vdmU6CiAJZ2d0dC0+dm0u
Y2xlYXJfcmFuZ2UoJmdndHQtPnZtLCB0bXAuc3RhcnQsIHRtcC5zaXplKTsKLQlpbnRlbF9ydW50
aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+
cnVudGltZV9wbSwgd2FrZXJlZik7CiAJZHJtX21tX3JlbW92ZV9ub2RlKCZ0bXApOwogb3V0X3Vu
cGluOgogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9wYWdlcyhvYmopOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jCmluZGV4IDExMjc4YmFjM2EyNC4uZGQ0
ZTcyZWFmYzZjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkx
NV9yZXF1ZXN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVx
dWVzdC5jCkBAIC01MzcsNyArNTM3LDcgQEAgc3RhdGljIGludCBsaXZlX25vcF9yZXF1ZXN0KHZv
aWQgKmFyZykKIAkgKi8KIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwot
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxf
cnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgaTkxNSwgaWQpIHsKIAkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCA9IE5VTEw7
CkBAIC01OTcsNyArNTk3LDcgQEAgc3RhdGljIGludCBsaXZlX25vcF9yZXF1ZXN0KHZvaWQgKmFy
ZykKIAl9CiAKIG91dF91bmxvY2s6Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJl
Zik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwog
CW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0dXJuIGVycjsKIH0K
QEAgLTY4Miw3ICs2ODIsNyBAQCBzdGF0aWMgaW50IGxpdmVfZW1wdHlfcmVxdWVzdCh2b2lkICph
cmcpCiAJICovCiAKIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRp
bWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAogCWJhdGNoID0gZW1wdHlfYmF0Y2goaTkx
NSk7CiAJaWYgKElTX0VSUihiYXRjaCkpIHsKQEAgLTc0Niw3ICs3NDYsNyBAQCBzdGF0aWMgaW50
IGxpdmVfZW1wdHlfcmVxdWVzdCh2b2lkICphcmcpCiAJaTkxNV92bWFfdW5waW4oYmF0Y2gpOwog
CWk5MTVfdm1hX3B1dChiYXRjaCk7CiBvdXRfdW5sb2NrOgotCWludGVsX3J1bnRpbWVfcG1fcHV0
KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3Bt
LCB3YWtlcmVmKTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJl
dHVybiBlcnI7CiB9CkBAIC04MzksNyArODM5LDcgQEAgc3RhdGljIGludCBsaXZlX2FsbF9lbmdp
bmVzKHZvaWQgKmFyZykKIAkgKi8KIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0g
aW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJZXJyID0gaWd0X2xp
dmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19mdW5jX18sICIiKTsKIAlpZiAoZXJyKQpAQCAtOTE5
LDcgKzkxOSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9hbGxfZW5naW5lcyh2b2lkICphcmcpCiAJaTkx
NV92bWFfdW5waW4oYmF0Y2gpOwogCWk5MTVfdm1hX3B1dChiYXRjaCk7CiBvdXRfdW5sb2NrOgot
CWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1f
cHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7CiB9CkBAIC05NDIsNyArOTQyLDcgQEAgc3Rh
dGljIGludCBsaXZlX3NlcXVlbnRpYWxfZW5naW5lcyh2b2lkICphcmcpCiAJICovCiAKIAltdXRl
eF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtlcmVmID0gaW50ZWxfcnVudGlt
ZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5y
dW50aW1lX3BtKTsKIAogCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGk5MTUsIF9fZnVu
Y19fLCAiIik7CiAJaWYgKGVycikKQEAgLTEwNDgsNyArMTA0OCw3IEBAIHN0YXRpYyBpbnQgbGl2
ZV9zZXF1ZW50aWFsX2VuZ2luZXModm9pZCAqYXJnKQogCQlpOTE1X3JlcXVlc3RfcHV0KHJlcXVl
c3RbaWRdKTsKIAl9CiBvdXRfdW5sb2NrOgotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdh
a2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVm
KTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7
CiB9CkBAIC0xMTEzLDcgKzExMTMsNyBAQCBzdGF0aWMgaW50IGxpdmVfYnJlYWRjcnVtYnNfc21v
a2V0ZXN0KHZvaWQgKmFyZykKIAkgKiBPbiByZWFsIGhhcmR3YXJlIHRoaXMgdGltZS4KIAkgKi8K
IAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50
ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJZmlsZSA9IG1vY2tfZmls
ZShpOTE1KTsKIAlpZiAoSVNfRVJSKGZpbGUpKSB7CkBAIC0xMjIwLDcgKzEyMjAsNyBAQCBzdGF0
aWMgaW50IGxpdmVfYnJlYWRjcnVtYnNfc21va2V0ZXN0KHZvaWQgKmFyZykKIG91dF9maWxlOgog
CW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwogb3V0X3JwbToKLQlpbnRlbF9ydW50aW1lX3Bt
X3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGlt
ZV9wbSwgd2FrZXJlZik7CiAKIAlyZXR1cm4gcmV0OwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfdGltZWxpbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9pOTE1X3RpbWVsaW5lLmMKaW5kZXggYWNiMmNjNTEzNmI3Li43MjRiZjM2
NTBiM2UgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3Rp
bWVsaW5lLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfdGltZWxp
bmUuYwpAQCAtNTE1LDcgKzUxNSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9od3NwX2VuZ2luZSh2b2lk
ICphcmcpCiAJCXJldHVybiAtRU5PTUVNOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7Ci0Jd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGk5MTUpOworCXdha2Vy
ZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7CiAKIAljb3VudCA9
IDA7CiAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKQEAgLTU1OCw3ICs1NTgs
NyBAQCBzdGF0aWMgaW50IGxpdmVfaHdzcF9lbmdpbmUodm9pZCAqYXJnKQogCQlpOTE1X3RpbWVs
aW5lX3B1dCh0bCk7CiAJfQogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7
CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCW11
dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAlrdmZyZWUodGltZWxpbmVz
KTsKQEAgLTU5MSw3ICs1OTEsNyBAQCBzdGF0aWMgaW50IGxpdmVfaHdzcF9hbHRlcm5hdGUodm9p
ZCAqYXJnKQogCQlyZXR1cm4gLUVOT01FTTsKIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtl
cmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJY291bnQg
PSAwOwogCWZvciAobiA9IDA7IG4gPCBOVU1fVElNRUxJTkVTOyBuKyspIHsKQEAgLTYzNCw3ICs2
MzQsNyBAQCBzdGF0aWMgaW50IGxpdmVfaHdzcF9hbHRlcm5hdGUodm9pZCAqYXJnKQogCQlpOTE1
X3RpbWVsaW5lX3B1dCh0bCk7CiAJfQogCi0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2Fr
ZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYp
OwogCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAlrdmZyZWUodGlt
ZWxpbmVzKTsKQEAgLTY1OCw3ICs2NTgsNyBAQCBzdGF0aWMgaW50IGxpdmVfaHdzcF93cmFwKHZv
aWQgKmFyZykKIAkgKi8KIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwot
CXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxf
cnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJdGwgPSBpOTE1X3RpbWVsaW5l
X2NyZWF0ZShpOTE1LCBOVUxMKTsKIAlpZiAoSVNfRVJSKHRsKSkgewpAQCAtNzQ5LDcgKzc0OSw3
IEBAIHN0YXRpYyBpbnQgbGl2ZV9od3NwX3dyYXAodm9pZCAqYXJnKQogb3V0X2ZyZWU6CiAJaTkx
NV90aW1lbGluZV9wdXQodGwpOwogb3V0X3JwbToKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1
LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2Fr
ZXJlZik7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCXJldHVy
biBlcnI7CkBAIC03NzEsNyArNzcxLDcgQEAgc3RhdGljIGludCBsaXZlX2h3c3BfcmVjeWNsZSh2
b2lkICphcmcpCiAJICovCiAKIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
LQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkxNSk7CisJd2FrZXJlZiA9IGludGVs
X3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAogCWNvdW50ID0gMDsKIAlmb3Jf
ZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewpAQCAtODI1LDcgKzgyNSw3IEBAIHN0YXRp
YyBpbnQgbGl2ZV9od3NwX3JlY3ljbGUodm9pZCAqYXJnKQogb3V0OgogCWlmIChpZ3RfZmx1c2hf
dGVzdChpOTE1LCBJOTE1X1dBSVRfTE9DS0VEKSkKIAkJZXJyID0gLUVJTzsKLQlpbnRlbF9ydW50
aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+
cnVudGltZV9wbSwgd2FrZXJlZik7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKIAogCXJldHVybiBlcnI7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV92bWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1
X3ZtYS5jCmluZGV4IGExNjZkOTQwNWE5NC4uZmJjNzliMTQ4MjNhIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYwpAQCAtODczLDcgKzg3Myw3IEBAIHN0YXRpYyBp
bnQgaWd0X3ZtYV9yZW1hcHBlZF9ndHQodm9pZCAqYXJnKQogCiAJbXV0ZXhfbG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAKLQl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoaTkx
NSk7CisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsK
IAogCWZvciAodCA9IHR5cGVzOyAqdDsgdCsrKSB7CiAJCWZvciAocCA9IHBsYW5lczsgcC0+d2lk
dGg7IHArKykgewpAQCAtOTY1LDcgKzk2NSw3IEBAIHN0YXRpYyBpbnQgaWd0X3ZtYV9yZW1hcHBl
ZF9ndHQodm9pZCAqYXJnKQogCX0KIAogb3V0OgotCWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUs
IHdha2VyZWYpOworCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtl
cmVmKTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWk5MTVfZ2Vt
X29iamVjdF9wdXQob2JqKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2ludGVsX2d1Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVs
X2d1Yy5jCmluZGV4IDdmZDAzMjFlMDk0Ny4uNmNhODU4NGNkNjRjIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfZ3VjLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX2d1Yy5jCkBAIC0xNDQsNyArMTQ0LDcgQEAgc3RhdGlj
IGludCBpZ3RfZ3VjX2NsaWVudHModm9pZCAqYXJncykKIAogCUdFTV9CVUdfT04oIUhBU19HVUMo
ZGV2X3ByaXYpKTsKIAltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0J
d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKKwl3YWtlcmVmID0gaW50
ZWxfcnVudGltZV9wbV9nZXQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAogCWd1YyA9ICZkZXZf
cHJpdi0+Z3VjOwogCWlmICghZ3VjKSB7CkBAIC0yMjcsNyArMjI3LDcgQEAgc3RhdGljIGludCBp
Z3RfZ3VjX2NsaWVudHModm9pZCAqYXJncykKIAlndWNfY2xpZW50c19jcmVhdGUoZ3VjKTsKIAln
dWNfY2xpZW50c19lbmFibGUoZ3VjKTsKIHVubG9jazoKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChk
ZXZfcHJpdiwgd2FrZXJlZik7CisJaW50ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50
aW1lX3BtLCB3YWtlcmVmKTsKIAltdXRleF91bmxvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211
dGV4KTsKIAlyZXR1cm4gZXJyOwogfQpAQCAtMjQ3LDcgKzI0Nyw3IEBAIHN0YXRpYyBpbnQgaWd0
X2d1Y19kb29yYmVsbHModm9pZCAqYXJnKQogCiAJR0VNX0JVR19PTighSEFTX0dVQyhkZXZfcHJp
dikpOwogCW11dGV4X2xvY2soJmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKLQl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCXdha2VyZWYgPSBpbnRlbF9ydW50
aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCiAJZ3VjID0gJmRldl9wcml2LT5n
dWM7CiAJaWYgKCFndWMpIHsKQEAgLTM0MCw3ICszNDAsNyBAQCBzdGF0aWMgaW50IGlndF9ndWNf
ZG9vcmJlbGxzKHZvaWQgKmFyZykKIAkJCWd1Y19jbGllbnRfZnJlZShjbGllbnRzW2ldKTsKIAkJ
fQogdW5sb2NrOgotCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKKwlp
bnRlbF9ydW50aW1lX3BtX3B1dCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogCW11
dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7CiB9
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfdW5jb3Jl
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfdW5jb3JlLmMKaW5kZXgg
ZTBkN2ViZWNiMjE1Li44NjgxNWM2MDcyYTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9pbnRlbF91bmNvcmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaW50ZWxfdW5jb3JlLmMKQEAgLTE3Niw3ICsxNzYsNyBAQCBzdGF0aWMgaW50IGxp
dmVfZm9yY2V3YWtlX29wcyh2b2lkICphcmcpCiAJCXJldHVybiAwOwogCX0KIAotCXdha2VyZWYg
PSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9w
bV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCiAJZm9yX2VhY2hfZndfZG9tYWluKGRvbWFpbiwg
dW5jb3JlLCB0bXApIHsKIAkJc21wX3N0b3JlX21iKGRvbWFpbi0+YWN0aXZlLCBmYWxzZSk7CkBA
IC0yNDcsNyArMjQ3LDcgQEAgc3RhdGljIGludCBsaXZlX2ZvcmNld2FrZV9vcHModm9pZCAqYXJn
KQogCX0KIAogb3V0X3JwbToKLQlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsK
KwlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAJcmV0
dXJuIGVycjsKIH0KIAotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5m
cmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0
aW5mby9pbnRlbC1nZng=

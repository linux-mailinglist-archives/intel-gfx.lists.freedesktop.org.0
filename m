Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id DC02338115
	for <lists+intel-gfx@lfdr.de>; Fri,  7 Jun 2019 00:42:48 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0984E89A77;
	Thu,  6 Jun 2019 22:42:47 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A534A89A77
 for <intel-gfx@lists.freedesktop.org>; Thu,  6 Jun 2019 22:42:45 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 06 Jun 2019 15:42:44 -0700
X-ExtLoop1: 1
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by fmsmga006.fm.intel.com with ESMTP; 06 Jun 2019 15:42:44 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  6 Jun 2019 15:42:24 -0700
Message-Id: <20190606224225.14287-1-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 1/2] drm/i915/guc: always use Command Transport
 Buffers
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Tm93IHRoYXQgd2UndmUgbW92ZWQgdGhlIEdlbjkgR3VDIGJsb2JzIHRvIHZlcnNpb24gMzIgd2Ug
aGF2ZSBDVEIKc3VwcG9ydCBvbiBhbGwgZ2Vucywgc28gbm8gbmVlZCB0byByZXN0cmljdCB0aGUg
dXNhZ2UgdG8gR2VuMTErLgpOb3RlIHRoYXQgTU1JTyBjb21tdW5pY2F0aW9uIGlzIHN0aWxsIHJl
cXVpcmVkIGZvciBDVEIgaW5pdGlhbGl6YXRpb24uCgp2MjogZml4IGNvbW1pdCBtZXNzYWdlIG5p
dHMgKE1pY2hhbCkKClNpZ25lZC1vZmYtYnk6IERhbmllbGUgQ2VyYW9sbyBTcHVyaW8gPGRhbmll
bGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5jb20+CkNjOiBNaWNoYWwgV2FqZGVjemtvIDxtaWNoYWwu
d2FqZGVjemtvQGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IE1pY2hhbCBXYWpkZWN6a28gPG1pY2hh
bC53YWpkZWN6a29AaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2
LmggICAgICAgICAgfCAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BjaS5jICAgICAg
ICAgIHwgIDEgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uaCB8ICAx
IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Yy5jICAgICAgICAgfCA0NSArKysrLS0t
LS0tLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Yy5oICAgICAg
ICAgfCAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfY3QuYyAgICAgIHwgMTQg
LS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmMgICAgICAgICAgfCAxOSAr
Ky0tLS0tLS0tCiA3IGZpbGVzIGNoYW5nZWQsIDEwIGluc2VydGlvbnMoKyksIDcyIGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4IGRmZTRiMTFlZTQyMy4uODJlNTVjNjUy
ODlhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKQEAgLTIzOTMsNyArMjM5Myw2IEBAIElTX1NV
QlBMQVRGT1JNKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogICogcHJvcGVy
dGllcywgc28gd2UgaGF2ZSBzZXBhcmF0ZSBtYWNyb3MgdG8gdGVzdCB0aGVtLgogICovCiAjZGVm
aW5lIEhBU19HVUMoZGV2X3ByaXYpCShJTlRFTF9JTkZPKGRldl9wcml2KS0+aGFzX2d1YykKLSNk
ZWZpbmUgSEFTX0dVQ19DVChkZXZfcHJpdikJKElOVEVMX0lORk8oZGV2X3ByaXYpLT5oYXNfZ3Vj
X2N0KQogI2RlZmluZSBIQVNfR1VDX1VDT0RFKGRldl9wcml2KQkoSEFTX0dVQyhkZXZfcHJpdikp
CiAjZGVmaW5lIEhBU19HVUNfU0NIRUQoZGV2X3ByaXYpCShIQVNfR1VDKGRldl9wcml2KSkKIApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wY2kuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfcGNpLmMKaW5kZXggZTc2MWVhODZiNDgxLi40ODJmMWQwZjE3NzAgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGNpLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9wY2kuYwpAQCAtNzQ2LDcgKzc0Niw2IEBAIHN0YXRpYyBjb25zdCBz
dHJ1Y3QgaW50ZWxfZGV2aWNlX2luZm8gaW50ZWxfY2Fubm9ubGFrZV9pbmZvID0gewogCX0sIFwK
IAlHRU4oMTEpLCBcCiAJLmRkYl9zaXplID0gMjA0OCwgXAotCS5oYXNfZ3VjX2N0ID0gMSwgXAog
CS5oYXNfbG9naWNhbF9yaW5nX2Vsc3EgPSAxLCBcCiAJLmNvbG9yID0geyAuZGVnYW1tYV9sdXRf
c2l6ZSA9IDMzLCAuZ2FtbWFfbHV0X3NpemUgPSAxMDI0IH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2RldmljZV9pbmZvLmgKaW5kZXggZDY3ZGVkZjBjYmQ4Li4xZmI4YjUwZGY3ZGYgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RldmljZV9pbmZvLmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uaApAQCAtMTEyLDcgKzExMiw2
IEBAIGVudW0gaW50ZWxfcHBndHRfdHlwZSB7CiAJZnVuYyhoYXNfcmVzZXRfZW5naW5lKTsgXAog
CWZ1bmMoaGFzX2ZwZ2FfZGJnKTsgXAogCWZ1bmMoaGFzX2d1Yyk7IFwKLQlmdW5jKGhhc19ndWNf
Y3QpOyBcCiAJZnVuYyhoYXNfbDNfZHBmKTsgXAogCWZ1bmMoaGFzX2xsYyk7IFwKIAlmdW5jKGhh
c19sb2dpY2FsX3JpbmdfY29udGV4dHMpOyBcCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9ndWMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Yy5jCmluZGV4
IGI4OGMzNDljNGZhNi4uNDMyMzIyNDJkMTY3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9ndWMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWMuYwpA
QCAtNTYsNyArNTYsNyBAQCB2b2lkIGludGVsX2d1Y19pbml0X3NlbmRfcmVncyhzdHJ1Y3QgaW50
ZWxfZ3VjICpndWMpCiAJZW51bSBmb3JjZXdha2VfZG9tYWlucyBmd19kb21haW5zID0gMDsKIAl1
bnNpZ25lZCBpbnQgaTsKIAotCWlmIChIQVNfR1VDX0NUKGRldl9wcml2KSAmJiBJTlRFTF9HRU4o
ZGV2X3ByaXYpID49IDExKSB7CisJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKIAkJ
Z3VjLT5zZW5kX3JlZ3MuYmFzZSA9CiAJCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOMTFfU09G
VF9TQ1JBVENIKDApKTsKIAkJZ3VjLT5zZW5kX3JlZ3MuY291bnQgPSBHRU4xMV9TT0ZUX1NDUkFU
Q0hfQ09VTlQ7CkBAIC0yMzIsMTEgKzIzMiw5IEBAIGludCBpbnRlbF9ndWNfaW5pdChzdHJ1Y3Qg
aW50ZWxfZ3VjICpndWMpCiAJCWdvdG8gZXJyX2xvZzsKIAlHRU1fQlVHX09OKCFndWMtPmFkc192
bWEpOwogCi0JaWYgKEhBU19HVUNfQ1QoZGV2X3ByaXYpKSB7Ci0JCXJldCA9IGludGVsX2d1Y19j
dF9pbml0KCZndWMtPmN0KTsKLQkJaWYgKHJldCkKLQkJCWdvdG8gZXJyX2FkczsKLQl9CisJcmV0
ID0gaW50ZWxfZ3VjX2N0X2luaXQoJmd1Yy0+Y3QpOworCWlmIChyZXQpCisJCWdvdG8gZXJyX2Fk
czsKIAogCS8qIFdlIG5lZWQgdG8gbm90aWZ5IHRoZSBndWMgd2hlbmV2ZXIgd2UgY2hhbmdlIHRo
ZSBHR1RUICovCiAJaTkxNV9nZ3R0X2VuYWJsZV9ndWMoZGV2X3ByaXYpOwpAQCAtMjYyLDggKzI2
MCw3IEBAIHZvaWQgaW50ZWxfZ3VjX2Zpbmkoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogCiAJaTkx
NV9nZ3R0X2Rpc2FibGVfZ3VjKGRldl9wcml2KTsKIAotCWlmIChIQVNfR1VDX0NUKGRldl9wcml2
KSkKLQkJaW50ZWxfZ3VjX2N0X2ZpbmkoJmd1Yy0+Y3QpOworCWludGVsX2d1Y19jdF9maW5pKCZn
dWMtPmN0KTsKIAogCWludGVsX2d1Y19hZHNfZGVzdHJveShndWMpOwogCWludGVsX2d1Y19sb2df
ZGVzdHJveSgmZ3VjLT5sb2cpOwpAQCAtNDMwLDkgKzQyNyw4IEBAIGludCBpbnRlbF9ndWNfc2Vu
ZF9tbWlvKHN0cnVjdCBpbnRlbF9ndWMgKmd1YywgY29uc3QgdTMyICphY3Rpb24sIHUzMiBsZW4s
CiAJR0VNX0JVR19PTigqYWN0aW9uICYgfklOVEVMX0dVQ19NU0dfQ09ERV9NQVNLKTsKIAogCS8q
IElmIENUIGlzIGF2YWlsYWJsZSwgd2UgZXhwZWN0IHRvIHVzZSBNTUlPIG9ubHkgZHVyaW5nIGlu
aXQvZmluaSAqLwotCUdFTV9CVUdfT04oSEFTX0dVQ19DVChkZXZfcHJpdikgJiYKLQkJKmFjdGlv
biAhPSBJTlRFTF9HVUNfQUNUSU9OX1JFR0lTVEVSX0NPTU1BTkRfVFJBTlNQT1JUX0JVRkZFUiAm
JgotCQkqYWN0aW9uICE9IElOVEVMX0dVQ19BQ1RJT05fREVSRUdJU1RFUl9DT01NQU5EX1RSQU5T
UE9SVF9CVUZGRVIpOworCUdFTV9CVUdfT04oKmFjdGlvbiAhPSBJTlRFTF9HVUNfQUNUSU9OX1JF
R0lTVEVSX0NPTU1BTkRfVFJBTlNQT1JUX0JVRkZFUiAmJgorCQkgICAqYWN0aW9uICE9IElOVEVM
X0dVQ19BQ1RJT05fREVSRUdJU1RFUl9DT01NQU5EX1RSQU5TUE9SVF9CVUZGRVIpOwogCiAJbXV0
ZXhfbG9jaygmZ3VjLT5zZW5kX211dGV4KTsKIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCh1
bmNvcmUsIGd1Yy0+c2VuZF9yZWdzLmZ3X2RvbWFpbnMpOwpAQCAtNDgxLDMzICs0NzcsNiBAQCBp
bnQgaW50ZWxfZ3VjX3NlbmRfbW1pbyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMsIGNvbnN0IHUzMiAq
YWN0aW9uLCB1MzIgbGVuLAogCXJldHVybiByZXQ7CiB9CiAKLXZvaWQgaW50ZWxfZ3VjX3RvX2hv
c3RfZXZlbnRfaGFuZGxlcl9tbWlvKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKLXsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBndWNfdG9faTkxNShndWMpOwotCXUzMiBtc2cs
IHZhbDsKLQotCS8qCi0JICogU2FtcGxlIHRoZSBsb2cgYnVmZmVyIGZsdXNoIHJlbGF0ZWQgYml0
cyAmIGNsZWFyIHRoZW0gb3V0IG5vdwotCSAqIGl0c2VsZiBmcm9tIHRoZSBtZXNzYWdlIGlkZW50
aXR5IHJlZ2lzdGVyIHRvIG1pbmltaXplIHRoZQotCSAqIHByb2JhYmlsaXR5IG9mIGxvc2luZyBh
IGZsdXNoIGludGVycnVwdCwgd2hlbiB0aGVyZSBhcmUgYmFjawotCSAqIHRvIGJhY2sgZmx1c2gg
aW50ZXJydXB0cy4KLQkgKiBUaGVyZSBjYW4gYmUgYSBuZXcgZmx1c2ggaW50ZXJydXB0LCBmb3Ig
ZGlmZmVyZW50IGxvZyBidWZmZXIKLQkgKiB0eXBlIChsaWtlIGZvciBJU1IpLCB3aGlsc3QgSG9z
dCBpcyBoYW5kbGluZyBvbmUgKGZvciBEUEMpLgotCSAqIFNpbmNlIHNhbWUgYml0IGlzIHVzZWQg
aW4gbWVzc2FnZSByZWdpc3RlciBmb3IgSVNSICYgRFBDLCBpdAotCSAqIGNvdWxkIGhhcHBlbiB0
aGF0IEd1QyBzZXRzIHRoZSBiaXQgZm9yIDJuZCBpbnRlcnJ1cHQgYnV0IEhvc3QKLQkgKiBjbGVh
cnMgb3V0IHRoZSBiaXQgb24gaGFuZGxpbmcgdGhlIDFzdCBpbnRlcnJ1cHQuCi0JICovCi0JZGlz
YWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRzKGRldl9wcml2KTsKLQlzcGluX2xvY2soJmd1Yy0+aXJx
X2xvY2spOwotCXZhbCA9IEk5MTVfUkVBRChTT0ZUX1NDUkFUQ0goMTUpKTsKLQltc2cgPSB2YWwg
JiBndWMtPm1zZ19lbmFibGVkX21hc2s7Ci0JSTkxNV9XUklURShTT0ZUX1NDUkFUQ0goMTUpLCB2
YWwgJiB+bXNnKTsKLQlzcGluX3VubG9jaygmZ3VjLT5pcnFfbG9jayk7Ci0JZW5hYmxlX3JwbV93
YWtlcmVmX2Fzc2VydHMoZGV2X3ByaXYpOwotCi0JaW50ZWxfZ3VjX3RvX2hvc3RfcHJvY2Vzc19y
ZWN2X21zZyhndWMsICZtc2csIDEpOwotfQotCiBpbnQgaW50ZWxfZ3VjX3RvX2hvc3RfcHJvY2Vz
c19yZWN2X21zZyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMsCiAJCQkJICAgICAgIGNvbnN0IHUzMiAq
cGF5bG9hZCwgdTMyIGxlbikKIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2d1Yy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjLmgKaW5kZXggY2JmZWQ3
YTc3YzhiLi5lMDdlNGM2OWNmMDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2d1Yy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Yy5oCkBAIC0xNjUs
NyArMTY1LDYgQEAgaW50IGludGVsX2d1Y19zZW5kX21taW8oc3RydWN0IGludGVsX2d1YyAqZ3Vj
LCBjb25zdCB1MzIgKmFjdGlvbiwgdTMyIGxlbiwKIAkJCXUzMiAqcmVzcG9uc2VfYnVmLCB1MzIg
cmVzcG9uc2VfYnVmX3NpemUpOwogdm9pZCBpbnRlbF9ndWNfdG9faG9zdF9ldmVudF9oYW5kbGVy
KHN0cnVjdCBpbnRlbF9ndWMgKmd1Yyk7CiB2b2lkIGludGVsX2d1Y190b19ob3N0X2V2ZW50X2hh
bmRsZXJfbm9wKHN0cnVjdCBpbnRlbF9ndWMgKmd1Yyk7Ci12b2lkIGludGVsX2d1Y190b19ob3N0
X2V2ZW50X2hhbmRsZXJfbW1pbyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpOwogaW50IGludGVsX2d1
Y190b19ob3N0X3Byb2Nlc3NfcmVjdl9tc2coc3RydWN0IGludGVsX2d1YyAqZ3VjLAogCQkJCSAg
ICAgICBjb25zdCB1MzIgKnBheWxvYWQsIHUzMiBsZW4pOwogaW50IGludGVsX2d1Y19zYW1wbGVf
Zm9yY2V3YWtlKHN0cnVjdCBpbnRlbF9ndWMgKmd1Yyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9ndWNfY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1
Y19jdC5jCmluZGV4IDJkNWRjMmFhMjJhNy4uMzkyMTgwOWY4MTJiIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfY3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9ndWNfY3QuYwpAQCAtODQ4LDggKzg0OCw2IEBAIHN0YXRpYyB2b2lkIGludGVsX2d1
Y190b19ob3N0X2V2ZW50X2hhbmRsZXJfY3Qoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogICogQWxs
b2NhdGUgbWVtb3J5IHJlcXVpcmVkIGZvciBjb21tdW5pY2F0aW9uIHZpYQogICogdGhlIENUIGNo
YW5uZWwuCiAgKgotICogU2hhbGwgb25seSBiZSBjYWxsZWQgZm9yIHBsYXRmb3JtcyB3aXRoIEhB
U19HVUNfQ1QuCi0gKgogICogUmV0dXJuOiAwIG9uIHN1Y2Nlc3MsIGEgbmVnYXRpdmUgZXJybm8g
Y29kZSBvbiBmYWlsdXJlLgogICovCiBpbnQgaW50ZWxfZ3VjX2N0X2luaXQoc3RydWN0IGludGVs
X2d1Y19jdCAqY3QpCkBAIC04NzUsOCArODczLDYgQEAgaW50IGludGVsX2d1Y19jdF9pbml0KHN0
cnVjdCBpbnRlbF9ndWNfY3QgKmN0KQogICoKICAqIERlYWxsb2NhdGUgbWVtb3J5IHJlcXVpcmVk
IGZvciBjb21tdW5pY2F0aW9uIHZpYQogICogdGhlIENUIGNoYW5uZWwuCi0gKgotICogU2hhbGwg
b25seSBiZSBjYWxsZWQgZm9yIHBsYXRmb3JtcyB3aXRoIEhBU19HVUNfQ1QuCiAgKi8KIHZvaWQg
aW50ZWxfZ3VjX2N0X2Zpbmkoc3RydWN0IGludGVsX2d1Y19jdCAqY3QpCiB7CkBAIC04OTAsMTkg
Kzg4NiwxNCBAQCB2b2lkIGludGVsX2d1Y19jdF9maW5pKHN0cnVjdCBpbnRlbF9ndWNfY3QgKmN0
KQogICogaW50ZWxfZ3VjX2N0X2VuYWJsZSAtIEVuYWJsZSBidWZmZXIgYmFzZWQgY29tbWFuZCB0
cmFuc3BvcnQuCiAgKiBAY3Q6IHBvaW50ZXIgdG8gQ1Qgc3RydWN0CiAgKgotICogU2hhbGwgb25s
eSBiZSBjYWxsZWQgZm9yIHBsYXRmb3JtcyB3aXRoIEhBU19HVUNfQ1QuCi0gKgogICogUmV0dXJu
OiAwIG9uIHN1Y2Nlc3MsIGEgbmVnYXRpdmUgZXJybm8gY29kZSBvbiBmYWlsdXJlLgogICovCiBp
bnQgaW50ZWxfZ3VjX2N0X2VuYWJsZShzdHJ1Y3QgaW50ZWxfZ3VjX2N0ICpjdCkKIHsKIAlzdHJ1
Y3QgaW50ZWxfZ3VjICpndWMgPSBjdF90b19ndWMoY3QpOwotCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gZ3VjX3RvX2k5MTUoZ3VjKTsKIAlzdHJ1Y3QgaW50ZWxfZ3VjX2N0X2NoYW5u
ZWwgKmN0Y2ggPSAmY3QtPmhvc3RfY2hhbm5lbDsKIAlpbnQgZXJyOwogCi0JR0VNX0JVR19PTigh
SEFTX0dVQ19DVChpOTE1KSk7Ci0KIAlpZiAoY3RjaC0+ZW5hYmxlZCkKIAkJcmV0dXJuIDA7CiAK
QEAgLTkyMCwxNyArOTExLDEyIEBAIGludCBpbnRlbF9ndWNfY3RfZW5hYmxlKHN0cnVjdCBpbnRl
bF9ndWNfY3QgKmN0KQogLyoqCiAgKiBpbnRlbF9ndWNfY3RfZGlzYWJsZSAtIERpc2FibGUgYnVm
ZmVyIGJhc2VkIGNvbW1hbmQgdHJhbnNwb3J0LgogICogQGN0OiBwb2ludGVyIHRvIENUIHN0cnVj
dAotICoKLSAqIFNoYWxsIG9ubHkgYmUgY2FsbGVkIGZvciBwbGF0Zm9ybXMgd2l0aCBIQVNfR1VD
X0NULgogICovCiB2b2lkIGludGVsX2d1Y19jdF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9ndWNfY3Qg
KmN0KQogewogCXN0cnVjdCBpbnRlbF9ndWMgKmd1YyA9IGN0X3RvX2d1YyhjdCk7Ci0Jc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwogCXN0cnVjdCBpbnRl
bF9ndWNfY3RfY2hhbm5lbCAqY3RjaCA9ICZjdC0+aG9zdF9jaGFubmVsOwogCi0JR0VNX0JVR19P
TighSEFTX0dVQ19DVChpOTE1KSk7Ci0KIAlpZiAoIWN0Y2gtPmVuYWJsZWQpCiAJCXJldHVybjsK
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX3VjLmMKaW5kZXggYTViYTBmMDA3OTU5Li5hOGU3ZjBiYTdjM2Ig
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfdWMuYwpAQCAtMjM1LDI0ICsyMzUsMTQgQEAgc3RhdGljIHZv
aWQgZ3VjX2Rpc2FibGVfaW50ZXJydXB0cyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiAKIHN0YXRp
YyBpbnQgZ3VjX2VuYWJsZV9jb21tdW5pY2F0aW9uKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIHsK
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd1Y190b19pOTE1KGd1Yyk7Ci0KIAln
dWNfZW5hYmxlX2ludGVycnVwdHMoZ3VjKTsKIAotCWlmIChIQVNfR1VDX0NUKGk5MTUpKQotCQly
ZXR1cm4gaW50ZWxfZ3VjX2N0X2VuYWJsZSgmZ3VjLT5jdCk7Ci0KLQlndWMtPnNlbmQgPSBpbnRl
bF9ndWNfc2VuZF9tbWlvOwotCWd1Yy0+aGFuZGxlciA9IGludGVsX2d1Y190b19ob3N0X2V2ZW50
X2hhbmRsZXJfbW1pbzsKLQlyZXR1cm4gMDsKKwlyZXR1cm4gaW50ZWxfZ3VjX2N0X2VuYWJsZSgm
Z3VjLT5jdCk7CiB9CiAKIHN0YXRpYyB2b2lkIGd1Y19zdG9wX2NvbW11bmljYXRpb24oc3RydWN0
IGludGVsX2d1YyAqZ3VjKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3Vj
X3RvX2k5MTUoZ3VjKTsKLQotCWlmIChIQVNfR1VDX0NUKGk5MTUpKQotCQlpbnRlbF9ndWNfY3Rf
c3RvcCgmZ3VjLT5jdCk7CisJaW50ZWxfZ3VjX2N0X3N0b3AoJmd1Yy0+Y3QpOwogCiAJZ3VjLT5z
ZW5kID0gaW50ZWxfZ3VjX3NlbmRfbm9wOwogCWd1Yy0+aGFuZGxlciA9IGludGVsX2d1Y190b19o
b3N0X2V2ZW50X2hhbmRsZXJfbm9wOwpAQCAtMjYwLDEwICsyNTAsNyBAQCBzdGF0aWMgdm9pZCBn
dWNfc3RvcF9jb21tdW5pY2F0aW9uKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIAogc3RhdGljIHZv
aWQgZ3VjX2Rpc2FibGVfY29tbXVuaWNhdGlvbihzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiB7Ci0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndWNfdG9faTkxNShndWMpOwotCi0JaWYg
KEhBU19HVUNfQ1QoaTkxNSkpCi0JCWludGVsX2d1Y19jdF9kaXNhYmxlKCZndWMtPmN0KTsKKwlp
bnRlbF9ndWNfY3RfZGlzYWJsZSgmZ3VjLT5jdCk7CiAKIAlndWNfZGlzYWJsZV9pbnRlcnJ1cHRz
KGd1Yyk7CiAKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
aW50ZWwtZ2Z4

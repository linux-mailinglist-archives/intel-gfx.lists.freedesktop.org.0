Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id C503074F06
	for <lists+intel-gfx@lfdr.de>; Thu, 25 Jul 2019 15:19:28 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 24B536E751;
	Thu, 25 Jul 2019 13:19:27 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A73976E751
 for <intel-gfx@lists.freedesktop.org>; Thu, 25 Jul 2019 13:19:25 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga005.jf.intel.com ([10.7.209.41])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 25 Jul 2019 06:19:25 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,306,1559545200"; d="scan'208";a="345435129"
Received: from hinestho-mobl1.amr.corp.intel.com (HELO [10.252.1.47])
 ([10.252.1.47])
 by orsmga005.jf.intel.com with ESMTP; 25 Jul 2019 06:19:23 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190725074305.22754-1-chris@chris-wilson.co.uk>
 <20190725093810.19159-1-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <b7d250f9-5ead-9b5c-a388-61e1bfd0ae0e@linux.intel.com>
Date: Thu, 25 Jul 2019 14:19:22 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20190725093810.19159-1-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH] drm/i915: Unshare the idle-barrier from
 other kernel requests
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDI1LzA3LzIwMTkgMTA6MzgsIENocmlzIFdpbHNvbiB3cm90ZToKPiBVbmRlciBzb21lIGNp
cmN1bXN0YW5jZXMgKHNlZSBpbnRlbF9jb250ZXh0X3ByZXBhcmVfcmVtb3RlX3JlcXVlc3QpLCB3
ZQo+IG1heSB1c2UgYSByZXF1ZXN0IGFsb25nIGEga2VybmVsIGNvbnRleHQgdG8gbW9kaWZ5IHRo
ZSBsb2dpY2FsIHN0YXRlIG9mCj4gYW5vdGhlci4gVG8ga2VlcCB0aGUgdGFyZ2V0IGNvbnRleHQg
aW4gcGxhY2Ugd2hpbGUgdGhlIHJlcXVlc3QgZXhlY3V0ZXMsCj4gd2UgdGFrZSBhbiBhY3RpdmUg
cmVmZXJlbmNlIG9uIGl0IHVzaW5nIHRoZSBrZXJuZWwgdGltZWxpbmUuIFRoaXMgaXMgdGhlCj4g
c2FtZSB0aW1lbGluZSBhcyB3ZSB1c2UgZm9yIHRoZSBpZGxlLWJhcnJpZXIsIGFuZCBzbyB3ZSBl
bmQgdXAgcmV1c2luZwo+IHRoZSBzYW1lIGFjdGl2ZSBub2RlLiBFeGNlcHQgdGhhdCB0aGUgaWRs
ZSBiYXJyaWVyIGlzIHNwZWNpYWwgYW5kIGNhbm5vdAo+IGJlIHJldXNlZCBpbiB0aGlzIG1hbm5l
ciEgR2l2ZSB0aGUgaWRsZS1iYXJyaWVyIGEgcmVzZXJ2ZWQgdGltZWxpbmUKPiBpbmRleCAoMCkg
c28gdGhhdCBpdCB3aWxsIGFsd2F5cyBiZSB1bmlxdWUgKGdpdmUgb3IgdGFrZSB3ZSBtYXkgaXNz
dWUKPiBtdWx0aXBsZSBpZGxlIGJhcnJpZXJzIGFjcm9zcyBtdWx0aXBsZSBlbmdpbmVzKS4KPiAK
PiBSZXBvcnRlZC1ieTogTGlvbmVsIExhbmR3ZXJsaW4gPGxpb25lbC5nLmxhbmR3ZXJsaW5AaW50
ZWwuY29tPgo+IEZpeGVzOiBjZTQ3NmM4MGI4YmYgKCJkcm0vaTkxNTogS2VlcCBjb250ZXh0cyBw
aW5uZWQgdW50aWwgYWZ0ZXIgdGhlIG5leHQga2VybmVsIGNvbnRleHQgc3dpdGNoIikKPiBGaXhl
czogYTk4NzdkYTJkNjI5ICgiZHJtL2k5MTUvb2E6IFJlY29uZmlndXJlIGNvbnRleHRzIG9uIHRo
ZSBmbHkiKQo+IFNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29u
LmNvLnVrPgo+IENjOiBMaW9uZWwgTGFuZHdlcmxpbiA8bGlvbmVsLmcubGFuZHdlcmxpbkBpbnRl
bC5jb20+Cj4gQ2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+Cj4g
LS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgICAgICAgfCAg
NDIgKystCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmggICAgICAg
fCAgMTMgKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYyAg
ICB8IDMyMSArKysrKysrKysrKysrKysrKysKPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
YWN0aXZlLmMgICAgICAgICAgICB8ICA2NyArKystCj4gICAuLi4vZHJtL2k5MTUvc2VsZnRlc3Rz
L2k5MTVfbGl2ZV9zZWxmdGVzdHMuaCAgfCAgIDMgKy0KPiAgIDUgZmlsZXMgY2hhbmdlZCwgNDA4
IGluc2VydGlvbnMoKyksIDM4IGRlbGV0aW9ucygtKQo+ICAgY3JlYXRlIG1vZGUgMTAwNjQ0IGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYwo+IAo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKPiBpbmRleCA5MjkyYjZjYTVlOWMuLmJjMjAxNjFi
YWI5ZiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKPiBAQCAt
MTYyLDE4ICsxNjIsOCBAQCBzdGF0aWMgaW50IF9faW50ZWxfY29udGV4dF9hY3RpdmUoc3RydWN0
IGk5MTVfYWN0aXZlICphY3RpdmUpCj4gICAJaWYgKGVycikKPiAgIAkJZ290byBlcnJfcmluZzsK
PiAgIAo+IC0JLyogUHJlYWxsb2NhdGUgdHJhY2tpbmcgbm9kZXMgKi8KPiAtCWlmICghaTkxNV9n
ZW1fY29udGV4dF9pc19rZXJuZWwoY2UtPmdlbV9jb250ZXh0KSkgewo+IC0JCWVyciA9IGk5MTVf
YWN0aXZlX2FjcXVpcmVfcHJlYWxsb2NhdGVfYmFycmllcigmY2UtPmFjdGl2ZSwKPiAtCQkJCQkJ
CSAgICAgIGNlLT5lbmdpbmUpOwo+IC0JCWlmIChlcnIpCj4gLQkJCWdvdG8gZXJyX3N0YXRlOwo+
IC0JfQo+IC0KPiAgIAlyZXR1cm4gMDsKPiAgIAo+IC1lcnJfc3RhdGU6Cj4gLQlfX2NvbnRleHRf
dW5waW5fc3RhdGUoY2UtPnN0YXRlKTsKPiAgIGVycl9yaW5nOgo+ICAgCWludGVsX3JpbmdfdW5w
aW4oY2UtPnJpbmcpOwo+ICAgZXJyX3B1dDoKPiBAQCAtMTgxLDYgKzE3MSwzNCBAQCBzdGF0aWMg
aW50IF9faW50ZWxfY29udGV4dF9hY3RpdmUoc3RydWN0IGk5MTVfYWN0aXZlICphY3RpdmUpCj4g
ICAJcmV0dXJuIGVycjsKPiAgIH0KPiAgIAo+ICtpbnQgaW50ZWxfY29udGV4dF9hY3RpdmVfYWNx
dWlyZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCj4gK3sKPiArCWludCBlcnI7Cj4gKwo+ICsJ
ZXJyID0gaTkxNV9hY3RpdmVfYWNxdWlyZSgmY2UtPmFjdGl2ZSk7Cj4gKwlpZiAoZXJyKQo+ICsJ
CXJldHVybiBlcnI7Cj4gKwo+ICsJLyogUHJlYWxsb2NhdGUgdHJhY2tpbmcgbm9kZXMgKi8KPiAr
CWlmIChjZS0+c3RhdGUgJiYgIWk5MTVfZ2VtX2NvbnRleHRfaXNfa2VybmVsKGNlLT5nZW1fY29u
dGV4dCkpIHsKPiArCQllcnIgPSBpOTE1X2FjdGl2ZV9hY3F1aXJlX3ByZWFsbG9jYXRlX2JhcnJp
ZXIoJmNlLT5hY3RpdmUsCj4gKwkJCQkJCQkgICAgICBjZS0+ZW5naW5lKTsKPiArCQlpZiAoZXJy
KSB7Cj4gKwkJCWk5MTVfYWN0aXZlX3JlbGVhc2UoJmNlLT5hY3RpdmUpOwo+ICsJCQlyZXR1cm4g
ZXJyOwo+ICsJCX0KPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArdm9pZCBpbnRl
bF9jb250ZXh0X2FjdGl2ZV9yZWxlYXNlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKPiArewo+
ICsJLyogTm9kZXMgcHJlYWxsb2NhdGVkIGluIGludGVsX2NvbnRleHRfYWN0aXZlKCkgKi8KPiAr
CWk5MTVfYWN0aXZlX2FjcXVpcmVfYmFycmllcigmY2UtPmFjdGl2ZSk7Cj4gKwlpOTE1X2FjdGl2
ZV9yZWxlYXNlKCZjZS0+YWN0aXZlKTsKPiArfQo+ICsKPiAgIHZvaWQKPiAgIGludGVsX2NvbnRl
eHRfaW5pdChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCj4gICAJCSAgIHN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHgsCj4gQEAgLTI4NCwzICszMDIsNyBAQCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICppbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkK
PiAgIAo+ICAgCXJldHVybiBycTsKPiAgIH0KPiArCj4gKyNpZiBJU19FTkFCTEVEKENPTkZJR19E
Uk1fSTkxNV9TRUxGVEVTVCkKPiArI2luY2x1ZGUgInNlbGZ0ZXN0X2NvbnRleHQuYyIKPiArI2Vu
ZGlmCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQu
aCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuaAo+IGluZGV4IDIzYzdl
NGMwY2U3Yy4uMDdmOTkyNGRlNDhmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2NvbnRleHQuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2NvbnRleHQuaAo+IEBAIC0xMDQsMTcgKzEwNCw4IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpbnRl
bF9jb250ZXh0X2V4aXQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQo+ICAgCQljZS0+b3BzLT5l
eGl0KGNlKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgaW5saW5lIGludCBpbnRlbF9jb250ZXh0X2Fj
dGl2ZV9hY3F1aXJlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKPiAtewo+IC0JcmV0dXJuIGk5
MTVfYWN0aXZlX2FjcXVpcmUoJmNlLT5hY3RpdmUpOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW5saW5l
IHZvaWQgaW50ZWxfY29udGV4dF9hY3RpdmVfcmVsZWFzZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UpCj4gLXsKPiAtCS8qIE5vZGVzIHByZWFsbG9jYXRlZCBpbiBpbnRlbF9jb250ZXh0X2FjdGl2
ZSgpICovCj4gLQlpOTE1X2FjdGl2ZV9hY3F1aXJlX2JhcnJpZXIoJmNlLT5hY3RpdmUpOwo+IC0J
aTkxNV9hY3RpdmVfcmVsZWFzZSgmY2UtPmFjdGl2ZSk7Cj4gLX0KPiAraW50IGludGVsX2NvbnRl
eHRfYWN0aXZlX2FjcXVpcmUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKTsKPiArdm9pZCBpbnRl
bF9jb250ZXh0X2FjdGl2ZV9yZWxlYXNlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSk7Cj4gICAK
PiAgIHN0YXRpYyBpbmxpbmUgc3RydWN0IGludGVsX2NvbnRleHQgKmludGVsX2NvbnRleHRfZ2V0
KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKPiAgIHsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Qvc2VsZnRlc3RfY29udGV4dC5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAw
MDAwMDAwMDAuLjRkMjUxZmFhZmNjMAo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9jb250ZXh0LmMKPiBAQCAtMCwwICsxLDMyMSBAQAo+ICsv
Kgo+ICsgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAo+ICsgKgo+ICsgKiBDb3B5
cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlICJp
OTE1X3NlbGZ0ZXN0LmgiCj4gKyNpbmNsdWRlICJpbnRlbF9ndC5oIgo+ICsKPiArI2luY2x1ZGUg
ImdlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmgiCj4gKyNpbmNsdWRlICJzZWxmdGVzdHMvaWd0
X2ZsdXNoX3Rlc3QuaCIKPiArI2luY2x1ZGUgInNlbGZ0ZXN0cy9tb2NrX2RybS5oIgo+ICsKPiAr
c3RhdGljIGludCByZXF1ZXN0X3N5bmMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCj4gK3sKPiAr
CWxvbmcgdGltZW91dDsKPiArCWludCBlcnIgPSAwOwo+ICsKPiArCWk5MTVfcmVxdWVzdF9nZXQo
cnEpOwo+ICsKPiArCWk5MTVfcmVxdWVzdF9hZGQocnEpOwo+ICsJdGltZW91dCA9IGk5MTVfcmVx
dWVzdF93YWl0KHJxLCAwLCBIWiAvIDEwKTsKPiArCWlmICh0aW1lb3V0IDwgMCkKPiArCQllcnIg
PSB0aW1lb3V0Owo+ICsJZWxzZQo+ICsJCWk5MTVfcmVxdWVzdF9yZXRpcmVfdXB0byhycSk7Cj4g
Kwo+ICsJaTkxNV9yZXF1ZXN0X3B1dChycSk7Cj4gKwo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsK
PiArc3RhdGljIGludCBjb250ZXh0X3N5bmMoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQo+ICt7
Cj4gKwlzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsID0gY2UtPnJpbmctPnRpbWVsaW5lOwo+ICsJ
aW50IGVyciA9IDA7Cj4gKwo+ICsJZG8gewo+ICsJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwo+
ICsJCWxvbmcgdGltZW91dDsKPiArCj4gKwkJcmN1X3JlYWRfbG9jaygpOwo+ICsJCXJxID0gcmN1
X2RlcmVmZXJlbmNlKHRsLT5sYXN0X3JlcXVlc3QucmVxdWVzdCk7Cj4gKwkJaWYgKHJxKQo+ICsJ
CQlycSA9IGk5MTVfcmVxdWVzdF9nZXRfcmN1KHJxKTsKPiArCQlyY3VfcmVhZF91bmxvY2soKTsK
PiArCQlpZiAoIXJxKQo+ICsJCQlicmVhazsKPiArCj4gKwkJdGltZW91dCA9IGk5MTVfcmVxdWVz
dF93YWl0KHJxLCAwLCBIWiAvIDEwKTsKPiArCQlpZiAodGltZW91dCA8IDApCj4gKwkJCWVyciA9
IHRpbWVvdXQ7Cj4gKwkJZWxzZQo+ICsJCQlpOTE1X3JlcXVlc3RfcmV0aXJlX3VwdG8ocnEpOwo+
ICsKPiArCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKPiArCX0gd2hpbGUgKCFlcnIpOwo+ICsKPiAr
CXJldHVybiBlcnI7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgX19saXZlX2FjdGl2ZV9jb250ZXh0
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKPiArCQkJCSBzdHJ1Y3QgaTkxNV9nZW1f
Y29udGV4dCAqZml4bWUpCj4gK3sKPiArCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKPiArCWlu
dCBwYXNzOwo+ICsJaW50IGVycjsKPiArCj4gKwkvKgo+ICsJICogV2Uga2VlcCBhY3RpdmUgY29u
dGV4dHMgYWxpdmUgdW50aWwgYWZ0ZXIgYSBzdWJzZXF1ZW50IGNvbnRleHQKPiArCSAqIHN3aXRj
aCBhcyB0aGUgZmluYWwgd3JpdGUgZnJvbSB0aGUgY29udGV4dC1zYXZlIHdpbGwgYmUgYWZ0ZXIK
PiArCSAqIHdlIHJldGlyZSB0aGUgZmluYWwgcmVxdWVzdC4gV2UgdHJhY2sgd2hlbiB3ZSB1bnBp
biB0aGUgY29udGV4dCwKPiArCSAqIHVuZGVyIHRoZSBwcmVzdW1wdGlvbiB0aGF0IHRoZSBmaW5h
bCBwaW4gaXMgZnJvbSB0aGUgbGFzdCByZXF1ZXN0LAo+ICsJICogYW5kIGluc3RlYWQgb2YgaW1t
ZWRpYXRlbHkgdW5waW5uaW5nIHRoZSBjb250ZXh0LCB3ZSBhZGQgYSB0YXNrCj4gKwkgKiB0byB1
bnBpbiB0aGUgY29udGV4dCBmcm9tIHRoZSBuZXh0IGlkbGUtYmFycmllci4KPiArCSAqCj4gKwkg
KiBUaGlzIHRlc3QgbWFrZXMgc3VyZSB0aGF0IHRoZSBjb250ZXh0IGlzIGtlcHQgYWxpdmUgdW50
aWwgYQo+ICsJICogc3Vic2VxdWVudCBpZGxlLWJhcnJpZXIgKGVtaXR0ZWQgd2hlbiB0aGUgZW5n
aW5lIHdha2VyZWYgaGl0cyAwCj4gKwkgKiB3aXRoIG5vIG1vcmUgb3V0c3RhbmRpbmcgcmVxdWVz
dHMpLgo+ICsJICovCj4gKwo+ICsJaWYgKGludGVsX2VuZ2luZV9wbV9pc19hd2FrZShlbmdpbmUp
KSB7Cj4gKwkJcHJfZXJyKCIlcyBpcyBhd2FrZSBiZWZvcmUgc3RhcnRpbmcgJXMhXG4iLAo+ICsJ
CSAgICAgICBlbmdpbmUtPm5hbWUsIF9fZnVuY19fKTsKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiAr
CX0KPiArCj4gKwljZSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGZpeG1lLCBlbmdpbmUpOwo+ICsJ
aWYgKCFjZSkKPiArCQlyZXR1cm4gLUVOT01FTTsKPiArCj4gKwlmb3IgKHBhc3MgPSAwOyBwYXNz
IDw9IDI7IHBhc3MrKykgewo+ICsJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwo+ICsKPiArCQly
cSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOwo+ICsJCWlmIChJU19FUlIocnEp
KSB7Cj4gKwkJCWVyciA9IFBUUl9FUlIocnEpOwo+ICsJCQlnb3RvIGVycjsKPiArCQl9Cj4gKwo+
ICsJCWVyciA9IHJlcXVlc3Rfc3luYyhycSk7Cj4gKwkJaWYgKGVycikKPiArCQkJZ290byBlcnI7
Cj4gKwo+ICsJCS8qIENvbnRleHQgd2lsbCBiZSBrZXB0IGFjdGl2ZSB1bnRpbCBhZnRlciBhbiBp
ZGxlLWJhcnJpZXIuICovCj4gKwkJaWYgKGk5MTVfYWN0aXZlX2lzX2lkbGUoJmNlLT5hY3RpdmUp
KSB7Cj4gKwkJCXByX2VycigiY29udGV4dCBpcyBub3QgYWN0aXZlOyBleHBlY3RlZCBpZGxlLWJh
cnJpZXIgKHBhc3MgJWQpXG4iLCBwYXNzKTsKPiArCQkJZXJyID0gLUVJTlZBTDsKPiArCQkJZ290
byBlcnI7Cj4gKwkJfQo+ICsKPiArCQlpZiAoIWludGVsX2VuZ2luZV9wbV9pc19hd2FrZShlbmdp
bmUpKSB7Cj4gKwkJCXByX2VycigiJXMgaXMgYXNsZWVwIGJlZm9yZSBpZGxlLWJhcnJpZXIgJXMh
XG4iLAo+ICsJCQkgICAgICAgZW5naW5lLT5uYW1lLCBfX2Z1bmNfXyk7Cj4gKwkJCWVyciA9IC1F
SU5WQUw7Cj4gKwkJCWdvdG8gZXJyOwo+ICsJCX0KPiArCX0KPiArCj4gKwkvKiBOb3cgbWFrZSBz
dXJlIG91ciBpZGxlLWJhcnJpZXJzIGFyZSBmbHVzaGVkICovCj4gKwllcnIgPSBjb250ZXh0X3N5
bmMoZW5naW5lLT5rZXJuZWxfY29udGV4dCk7Cj4gKwlpZiAoZXJyKQo+ICsJCWdvdG8gZXJyOwo+
ICsKPiArCWlmICghaTkxNV9hY3RpdmVfaXNfaWRsZSgmY2UtPmFjdGl2ZSkpIHsKPiArCQlwcl9l
cnIoImNvbnRleHQgaXMgc3RpbGwgYWN0aXZlISIpOwo+ICsJCWVyciA9IC1FSU5WQUw7Cj4gKwl9
Cj4gKwo+ICsJaWYgKGludGVsX2VuZ2luZV9wbV9pc19hd2FrZShlbmdpbmUpKSB7Cj4gKwkJc3Ry
dWN0IGRybV9wcmludGVyIHAgPSBkcm1fZGVidWdfcHJpbnRlcihfX2Z1bmNfXyk7Cj4gKwo+ICsJ
CWludGVsX2VuZ2luZV9kdW1wKGVuZ2luZSwgJnAsCj4gKwkJCQkgICIlcyBpcyBzdGlsbCBhd2Fr
ZSBhZnRlciBpZGxlLWJhcnJpZXJzXG4iLAo+ICsJCQkJICBlbmdpbmUtPm5hbWUpOwo+ICsJCUdF
TV9UUkFDRV9EVU1QKCk7Cj4gKwo+ICsJCWVyciA9IC1FSU5WQUw7Cj4gKwkJZ290byBlcnI7Cj4g
Kwl9Cj4gKwo+ICtlcnI6Cj4gKwlpbnRlbF9jb250ZXh0X3B1dChjZSk7Cj4gKwlyZXR1cm4gZXJy
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGxpdmVfYWN0aXZlX2NvbnRleHQodm9pZCAqYXJnKQo+
ICt7Cj4gKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwo+ICsJc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lOwo+ICsJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmZpeG1lOwo+ICsJZW51
bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Cj4gKwlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7Cj4gKwlpbnQg
ZXJyID0gMDsKPiArCj4gKwlmaWxlID0gbW9ja19maWxlKGd0LT5pOTE1KTsKPiArCWlmIChJU19F
UlIoZmlsZSkpCj4gKwkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7Cj4gKwo+ICsJbXV0ZXhfbG9jaygm
Z3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsKPiArCWZpeG1lID0gbGl2ZV9jb250ZXh0
KGd0LT5pOTE1LCBmaWxlKTsKPiArCWlmICghZml4bWUpIHsKPiArCQllcnIgPSAtRU5PTUVNOwo+
ICsJCWdvdG8gdW5sb2NrOwo+ICsJfQo+ICsKPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0
LT5pOTE1LCBpZCkgewo+ICsJCWVyciA9IF9fbGl2ZV9hY3RpdmVfY29udGV4dChlbmdpbmUsIGZp
eG1lKTsKPiArCQlpZiAoZXJyKQo+ICsJCQlicmVhazsKPiArCj4gKwkJZXJyID0gaWd0X2ZsdXNo
X3Rlc3QoZ3QtPmk5MTUsIEk5MTVfV0FJVF9MT0NLRUQpOwo+ICsJCWlmIChlcnIpCj4gKwkJCWJy
ZWFrOwo+ICsJfQo+ICsKPiArdW5sb2NrOgo+ICsJbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7Cj4gKwltb2NrX2ZpbGVfZnJlZShndC0+aTkxNSwgZmlsZSk7Cj4gKwly
ZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IF9fbGl2ZV9yZW1vdGVfY29udGV4dChz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCj4gKwkJCQkgc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmZpeG1lKQo+ICt7Cj4gKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqbG9jYWwsICpyZW1v
dGU7Cj4gKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKPiArCWludCBwYXNzOwo+ICsJaW50IGVy
cjsKPiArCj4gKwkvKgo+ICsJICogQ2hlY2sgdGhhdCBvdXIgaWRsZSBiYXJyaWVycyBkbyBub3Qg
aW50ZXJmZXJlIHdpdGggbm9ybWFsCj4gKwkgKiBhY3Rpdml0eSB0cmFja2luZy4gSW4gcGFydGlj
dWxhciwgY2hlY2sgdGhhdCBvcGVyYXRpbmcKPiArCSAqIG9uIHRoZSBjb250ZXh0IGltYWdlIHJl
bW90ZWx5IChpbnRlbF9jb250ZXh0X3ByZXBhcmVfcmVtb3RlX3JlcXVlc3QpCj4gKwkgKiB3aGlj
aCBpbnNlcnRzIGZvcmllZ24gZmVuY2VzIGludG8gaW50ZWxfY29udGV4dC5hY3RpdmUgYXJlIG5v
dAo+ICsJICogY2xvYmJlcmVkLgo+ICsJICovCj4gKwo+ICsJcmVtb3RlID0gaW50ZWxfY29udGV4
dF9jcmVhdGUoZml4bWUsIGVuZ2luZSk7Cj4gKwlpZiAoIXJlbW90ZSkKPiArCQlyZXR1cm4gLUVO
T01FTTsKPiArCj4gKwlsb2NhbCA9IGludGVsX2NvbnRleHRfY3JlYXRlKGZpeG1lLCBlbmdpbmUp
Owo+ICsJaWYgKCFsb2NhbCkgewo+ICsJCWVyciA9IC1FTk9NRU07Cj4gKwkJZ290byBlcnJfcmVt
b3RlOwo+ICsJfQo+ICsKPiArCWZvciAocGFzcyA9IDA7IHBhc3MgPD0gMjsgcGFzcysrKSB7Cj4g
KwkJZXJyID0gaW50ZWxfY29udGV4dF9waW4ocmVtb3RlKTsKPiArCQlpZiAoZXJyKQo+ICsJCQln
b3RvIGVycl9sb2NhbDsKPiArCj4gKwkJcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0
KGxvY2FsKTsKPiArCQlpZiAoSVNfRVJSKHJxKSkgewo+ICsJCQllcnIgPSBQVFJfRVJSKHJxKTsK
PiArCQkJZ290byBlcnJfdW5waW47Cj4gKwkJfQo+ICsKPiArCQllcnIgPSBpbnRlbF9jb250ZXh0
X3ByZXBhcmVfcmVtb3RlX3JlcXVlc3QocmVtb3RlLCBycSk7Cj4gKwkJaWYgKGVycikgewo+ICsJ
CQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKPiArCQkJZ290byBlcnJfdW5waW47Cj4gKwkJfQo+ICsK
PiArCQllcnIgPSByZXF1ZXN0X3N5bmMocnEpOwo+ICsJCWlmIChlcnIpCj4gKwkJCWdvdG8gZXJy
X3VucGluOwo+ICsKPiArCQlpbnRlbF9jb250ZXh0X3VucGluKHJlbW90ZSk7Cj4gKwkJZXJyID0g
aW50ZWxfY29udGV4dF9waW4ocmVtb3RlKTsKPiArCQlpZiAoZXJyKQo+ICsJCQlnb3RvIGVycl9s
b2NhbDsKPiArCj4gKwkJcnEgPSBpOTE1X3JlcXVlc3RfY3JlYXRlKGVuZ2luZS0+a2VybmVsX2Nv
bnRleHQpOwo+ICsJCWlmIChJU19FUlIocnEpKSB7Cj4gKwkJCWVyciA9IFBUUl9FUlIocnEpOwo+
ICsJCQlnb3RvIGVycl91bnBpbjsKPiArCQl9Cj4gKwo+ICsJCWVyciA9IGludGVsX2NvbnRleHRf
cHJlcGFyZV9yZW1vdGVfcmVxdWVzdChyZW1vdGUsIHJxKTsKPiArCQlpZiAoZXJyKSB7Cj4gKwkJ
CWk5MTVfcmVxdWVzdF9hZGQocnEpOwo+ICsJCQlnb3RvIGVycl91bnBpbjsKPiArCQl9Cj4gKwo+
ICsJCWVyciA9IHJlcXVlc3Rfc3luYyhycSk7Cj4gKwkJaWYgKGVycikKPiArCQkJZ290byBlcnJf
dW5waW47Cj4gKwo+ICsJCWludGVsX2NvbnRleHRfdW5waW4ocmVtb3RlKTsKPiArCj4gKwkJaWYg
KGk5MTVfYWN0aXZlX2lzX2lkbGUoJnJlbW90ZS0+YWN0aXZlKSkgewo+ICsJCQlwcl9lcnIoInJl
bW90ZSBjb250ZXh0IGlzIG5vdCBhY3RpdmU7IGV4cGVjdGVkIGlkbGUtYmFycmllciAocGFzcyAl
ZClcbiIsIHBhc3MpOwo+ICsJCQllcnIgPSAtRUlOVkFMOwo+ICsJCQlnb3RvIGVycl9sb2NhbDsK
PiArCQl9Cj4gKwl9Cj4gKwo+ICsJZ290byBlcnJfbG9jYWw7Cj4gKwo+ICtlcnJfdW5waW46Cj4g
KwlpbnRlbF9jb250ZXh0X3VucGluKHJlbW90ZSk7Cj4gK2Vycl9sb2NhbDoKPiArCWludGVsX2Nv
bnRleHRfcHV0KGxvY2FsKTsKPiArZXJyX3JlbW90ZToKPiArCWludGVsX2NvbnRleHRfcHV0KHJl
bW90ZSk7Cj4gKwlyZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGxpdmVfcmVtb3Rl
X2NvbnRleHQodm9pZCAqYXJnKQo+ICt7Cj4gKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwo+
ICsJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICsJc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmZpeG1lOwo+ICsJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Cj4gKwlzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGU7Cj4gKwlpbnQgZXJyID0gMDsKPiArCj4gKwlmaWxlID0gbW9ja19maWxlKGd0
LT5pOTE1KTsKPiArCWlmIChJU19FUlIoZmlsZSkpCj4gKwkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7
Cj4gKwo+ICsJbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICsKPiAr
CWZpeG1lID0gbGl2ZV9jb250ZXh0KGd0LT5pOTE1LCBmaWxlKTsKPiArCWlmICghZml4bWUpIHsK
PiArCQllcnIgPSAtRU5PTUVNOwo+ICsJCWdvdG8gdW5sb2NrOwo+ICsJfQo+ICsKPiArCWZvcl9l
YWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewo+ICsJCWVyciA9IF9fbGl2ZV9yZW1v
dGVfY29udGV4dChlbmdpbmUsIGZpeG1lKTsKPiArCQlpZiAoZXJyKQo+ICsJCQlicmVhazsKPiAr
Cj4gKwkJZXJyID0gaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUsIEk5MTVfV0FJVF9MT0NLRUQpOwo+
ICsJCWlmIChlcnIpCj4gKwkJCWJyZWFrOwo+ICsJfQo+ICsKPiArdW5sb2NrOgo+ICsJbXV0ZXhf
dW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Cj4gKwltb2NrX2ZpbGVfZnJlZShn
dC0+aTkxNSwgZmlsZSk7Cj4gKwlyZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICtpbnQgaW50ZWxfY29u
dGV4dF9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiArewo+
ICsJc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsKPiArCQlTVUJU
RVNUKGxpdmVfYWN0aXZlX2NvbnRleHQpLAo+ICsJCVNVQlRFU1QobGl2ZV9yZW1vdGVfY29udGV4
dCksCj4gKwl9Owo+ICsJc3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKPiArCj4gKwlp
ZiAoaW50ZWxfZ3RfaXNfd2VkZ2VkKGd0KSkKPiArCQlyZXR1cm4gMDsKPiArCj4gKwlyZXR1cm4g
aW50ZWxfZ3RfbGl2ZV9zdWJ0ZXN0cyh0ZXN0cywgZ3QpOwo+ICt9Cj4gZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2FjdGl2ZS5jCj4gaW5kZXggMTNmMzA0YTI5ZmM4Li5lMDRhZmI1MTkyNjQgMTAwNjQ0Cj4g
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKPiBAQCAtMTg0LDYgKzE4NCw3IEBAIGFjdGl2ZV9p
bnN0YW5jZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwgdTY0IGlkeCkKPiAgIAlyZWYtPmNhY2hl
ID0gbm9kZTsKPiAgIAltdXRleF91bmxvY2soJnJlZi0+bXV0ZXgpOwo+ICAgCj4gKwlCVUlMRF9C
VUdfT04ob2Zmc2V0b2YodHlwZW9mKCpub2RlKSwgYmFzZSkpOwo+ICAgCXJldHVybiAmbm9kZS0+
YmFzZTsKPiAgIH0KPiAgIAo+IEBAIC0yMTIsNiArMjEzLDggQEAgaW50IGk5MTVfYWN0aXZlX3Jl
ZihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwKPiAgIAlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVz
dCAqYWN0aXZlOwo+ICAgCWludCBlcnI7Cj4gICAKPiArCUdFTV9CVUdfT04oIXRpbWVsaW5lKTsg
LyogcmVzZXJ2ZWQgZm9yIGlkbGUtYmFycmllciAqLwo+ICsKPiAgIAkvKiBQcmV2ZW50IHJlYXBp
bmcgaW4gY2FzZSB3ZSBtYWxsb2Mvd2FpdCB3aGlsZSBidWlsZGluZyB0aGUgdHJlZSAqLwo+ICAg
CWVyciA9IGk5MTVfYWN0aXZlX2FjcXVpcmUocmVmKTsKPiAgIAlpZiAoZXJyKQo+IEBAIC0yMjIs
NiArMjI1LDcgQEAgaW50IGk5MTVfYWN0aXZlX3JlZihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwK
PiAgIAkJZXJyID0gLUVOT01FTTsKPiAgIAkJZ290byBvdXQ7Cj4gICAJfQo+ICsJR0VNX0JVR19P
TihJU19FUlIoYWN0aXZlLT5yZXF1ZXN0KSk7Cj4gICAKPiAgIAlpZiAoIWk5MTVfYWN0aXZlX3Jl
cXVlc3RfaXNzZXQoYWN0aXZlKSkKPiAgIAkJYXRvbWljX2luYygmcmVmLT5jb3VudCk7Cj4gQEAg
LTM0Miw2ICszNDYsMzQgQEAgdm9pZCBpOTE1X2FjdGl2ZV9maW5pKHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmKQo+ICAgfQo+ICAgI2VuZGlmCj4gICAKPiArc3RhdGljIHN0cnVjdCBhY3RpdmVfbm9k
ZSAqaWRsZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICt7Cj4gKwlzdHJ1Y3Qg
YWN0aXZlX25vZGUgKmlkbGUgPSBOVUxMOwo+ICsJc3RydWN0IHJiX25vZGUgKnJiOwo+ICsKPiAr
CWlmIChSQl9FTVBUWV9ST09UKCZyZWYtPnRyZWUpKQo+ICsJCXJldHVybiBOVUxMOwo+ICsKPiAr
CW11dGV4X2xvY2soJnJlZi0+bXV0ZXgpOwo+ICsJZm9yIChyYiA9IHJiX2ZpcnN0KCZyZWYtPnRy
ZWUpOyByYjsgcmIgPSByYl9uZXh0KHJiKSkgewo+ICsJCXN0cnVjdCBhY3RpdmVfbm9kZSAqbm9k
ZTsKPiArCj4gKwkJbm9kZSA9IHJiX2VudHJ5KHJiLCB0eXBlb2YoKm5vZGUpLCBub2RlKTsKPiAr
CQlpZiAobm9kZS0+dGltZWxpbmUpCj4gKwkJCWJyZWFrOwoKSSB0aGluayB0aGUgY29kZSBuZWVk
cyB0byBiZSBtb3JlIGV4cGxpY2l0IGZvciByZWFkYWJpbGl0eS4gU3BlY2lhbCAKdGltZWxpbmUg
dmFsdWUgemVybyBhdCBsZWFzdCBhcyBhICNkZWZpbmUuIFBsdXMgc29tZSBjb21tZW50cy4KCj4g
Kwo+ICsJCWlmICghaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldCgmbm9kZS0+YmFzZSkpIHsKPiAr
CQkJR0VNX0JVR19PTighbGlzdF9lbXB0eSgmbm9kZS0+YmFzZS5saW5rKSk7Cj4gKwkJCXJiX2Vy
YXNlKHJiLCAmcmVmLT50cmVlKTsKPiArCQkJaWRsZSA9IG5vZGU7Cj4gKwkJCWJyZWFrOwo+ICsJ
CX0KPiArCX0KPiArCW11dGV4X3VubG9jaygmcmVmLT5tdXRleCk7Cj4gKwo+ICsJcmV0dXJuIGlk
bGU7Cj4gK30KPiArCj4gICBpbnQgaTkxNV9hY3RpdmVfYWNxdWlyZV9wcmVhbGxvY2F0ZV9iYXJy
aWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAo+ICAgCQkJCQkgICAgc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQo+ICAgewo+IEBAIC0zNTIsMjIgKzM4NCwyOSBAQCBpbnQgaTkxNV9h
Y3RpdmVfYWNxdWlyZV9wcmVhbGxvY2F0ZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVm
LAo+ICAgCj4gICAJR0VNX0JVR19PTighZW5naW5lLT5tYXNrKTsKPiAgIAlmb3JfZWFjaF9lbmdp
bmVfbWFza2VkKGVuZ2luZSwgaTkxNSwgZW5naW5lLT5tYXNrLCB0bXApIHsKPiAtCQlzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqa2N0eCA9IGVuZ2luZS0+a2VybmVsX2NvbnRleHQ7Cj4gICAJCXN0cnVj
dCBhY3RpdmVfbm9kZSAqbm9kZTsKPiAgIAo+IC0JCW5vZGUgPSBrbWVtX2NhY2hlX2FsbG9jKGds
b2JhbC5zbGFiX2NhY2hlLCBHRlBfS0VSTkVMKTsKPiAtCQlpZiAodW5saWtlbHkoIW5vZGUpKSB7
Cj4gLQkJCWVyciA9IC1FTk9NRU07Cj4gLQkJCWdvdG8gdW53aW5kOwo+ICsJCW5vZGUgPSBpZGxl
X2JhcnJpZXIocmVmKTsKPiArCQlpZiAoIW5vZGUpIHsKPiArCQkJbm9kZSA9IGttZW1fY2FjaGVf
YWxsb2MoZ2xvYmFsLnNsYWJfY2FjaGUsCj4gKwkJCQkJCUdGUF9LRVJORUwgfAo+ICsJCQkJCQlf
X0dGUF9SRVRSWV9NQVlGQUlMIHwKPiArCQkJCQkJX19HRlBfTk9XQVJOKTsKPiArCQkJaWYgKHVu
bGlrZWx5KCFub2RlKSkgewo+ICsJCQkJZXJyID0gLUVOT01FTTsKPiArCQkJCWdvdG8gdW53aW5k
Owo+ICsJCQl9Cj4gKwo+ICsJCQlub2RlLT5yZWYgPSByZWY7Cj4gKwkJCW5vZGUtPnRpbWVsaW5l
ID0gMDsKPiArCQkJbm9kZS0+YmFzZS5yZXRpcmUgPSBub2RlX3JldGlyZTsKPiAgIAkJfQo+ICAg
Cj4gLQkJaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KCZub2RlLT5iYXNlLAo+IC0JCQkJCSAodm9p
ZCAqKWVuZ2luZSwgbm9kZV9yZXRpcmUpOwo+IC0JCW5vZGUtPnRpbWVsaW5lID0ga2N0eC0+cmlu
Zy0+dGltZWxpbmUtPmZlbmNlX2NvbnRleHQ7Cj4gLQkJbm9kZS0+cmVmID0gcmVmOwo+ICsJCWlu
dGVsX2VuZ2luZV9wbV9nZXQoZW5naW5lKTsKCkFGQUlVIHRoaXMgY291bGQgY29tZm9ydGFibHkg
YmUgbW92ZWQgbGFzdCBpbnN0ZWFkIG9mIGdvaW5nIGV2ZW4gaGlnaGVyIAp3aXRoIHRoaXMgcGF0
Y2guCgo+ICsKPiArCQlSQ1VfSU5JVF9QT0lOVEVSKG5vZGUtPmJhc2UucmVxdWVzdCwgKHZvaWQg
KillbmdpbmUpOwoKV2hhdCBoYXBwZW5zIHdpdGggdGhlIGVuZ2luZSBpbiByZXF1ZXN0IHNsb3Q/
IE5vdGhpbmcgaWYgdGhlcmUgaXMgbm8gCnJldGlyZSBob29rIHNldD8gQnV0IHdobyB1c2VzIGl0
IHRoZW4/Cgo+ICAgCQlhdG9taWNfaW5jKCZyZWYtPmNvdW50KTsKPiAgIAo+IC0JCWludGVsX2Vu
Z2luZV9wbV9nZXQoZW5naW5lKTsKPiAgIAkJbGxpc3RfYWRkKChzdHJ1Y3QgbGxpc3Rfbm9kZSAq
KSZub2RlLT5iYXNlLmxpbmssCj4gICAJCQkgICZyZWYtPmJhcnJpZXJzKTsKPiAgIAl9Cj4gQEAg
LTQwMiw2ICs0NDEsNyBAQCB2b2lkIGk5MTVfYWN0aXZlX2FjcXVpcmVfYmFycmllcihzdHJ1Y3Qg
aTkxNV9hY3RpdmUgKnJlZikKPiAgIAo+ICAgCQlub2RlID0gY29udGFpbmVyX29mKChzdHJ1Y3Qg
bGlzdF9oZWFkICopcG9zLAo+ICAgCQkJCSAgICB0eXBlb2YoKm5vZGUpLCBiYXNlLmxpbmspOwo+
ICsJCUdFTV9CVUdfT04obm9kZS0+dGltZWxpbmUpOwo+ICAgCj4gICAJCWVuZ2luZSA9ICh2b2lk
ICopcmN1X2FjY2Vzc19wb2ludGVyKG5vZGUtPmJhc2UucmVxdWVzdCk7Cj4gICAJCVJDVV9JTklU
X1BPSU5URVIobm9kZS0+YmFzZS5yZXF1ZXN0LCBFUlJfUFRSKC1FQUdBSU4pKTsKPiBAQCAtNDEw
LDEyICs0NTAsNyBAQCB2b2lkIGk5MTVfYWN0aXZlX2FjcXVpcmVfYmFycmllcihzdHJ1Y3QgaTkx
NV9hY3RpdmUgKnJlZikKPiAgIAkJcCA9ICZyZWYtPnRyZWUucmJfbm9kZTsKPiAgIAkJd2hpbGUg
KCpwKSB7Cj4gICAJCQlwYXJlbnQgPSAqcDsKPiAtCQkJaWYgKHJiX2VudHJ5KHBhcmVudCwKPiAt
CQkJCSAgICAgc3RydWN0IGFjdGl2ZV9ub2RlLAo+IC0JCQkJICAgICBub2RlKS0+dGltZWxpbmUg
PCBub2RlLT50aW1lbGluZSkKPiAtCQkJCXAgPSAmcGFyZW50LT5yYl9yaWdodDsKPiAtCQkJZWxz
ZQo+IC0JCQkJcCA9ICZwYXJlbnQtPnJiX2xlZnQ7Cj4gKwkJCXAgPSAmcGFyZW50LT5yYl9sZWZ0
OwoKSSBkb24ndCBnZXQgdGhpcyBodW5rIGF0IGFsbCAtIGhvdyBjYW4gaXQgYmUgb2theSB0byBp
Z25vcmUgdGhlIHRpbWVsaW5lIAp2YWx1ZS4gSXMgdGhpcyB0aGUgYnVnZ3kgYml0IHlvdSBtZW50
aW9uZWQgb24gSVJDPwoKRmlyc3QgcGFzcywgSSdsbCBjb21lIGJhY2sgbGF0ZXIuCgpSZWdhcmRz
LAoKVHZydGtvCgo+ICAgCQl9Cj4gICAJCXJiX2xpbmtfbm9kZSgmbm9kZS0+bm9kZSwgcGFyZW50
LCBwKTsKPiAgIAkJcmJfaW5zZXJ0X2NvbG9yKCZub2RlLT5ub2RlLCAmcmVmLT50cmVlKTsKPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfbGl2ZV9zZWxm
dGVzdHMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2xpdmVfc2VsZnRl
c3RzLmgKPiBpbmRleCAyYjMxYTRlZTBiNGMuLmE4NDFkM2Y5YmVkYyAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9saXZlX3NlbGZ0ZXN0cy5oCj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfbGl2ZV9zZWxmdGVzdHMuaAo+
IEBAIC0xNSw2ICsxNSw3IEBAIHNlbGZ0ZXN0KHdvcmthcm91bmRzLCBpbnRlbF93b3JrYXJvdW5k
c19saXZlX3NlbGZ0ZXN0cykKPiAgIHNlbGZ0ZXN0KHRpbWVsaW5lcywgaW50ZWxfdGltZWxpbmVf
bGl2ZV9zZWxmdGVzdHMpCj4gICBzZWxmdGVzdChyZXF1ZXN0cywgaTkxNV9yZXF1ZXN0X2xpdmVf
c2VsZnRlc3RzKQo+ICAgc2VsZnRlc3QoYWN0aXZlLCBpOTE1X2FjdGl2ZV9saXZlX3NlbGZ0ZXN0
cykKPiArc2VsZnRlc3QoZ3RfY29udGV4dHMsIGludGVsX2NvbnRleHRfbGl2ZV9zZWxmdGVzdHMp
Cj4gICBzZWxmdGVzdChvYmplY3RzLCBpOTE1X2dlbV9vYmplY3RfbGl2ZV9zZWxmdGVzdHMpCj4g
ICBzZWxmdGVzdChtbWFuLCBpOTE1X2dlbV9tbWFuX2xpdmVfc2VsZnRlc3RzKQo+ICAgc2VsZnRl
c3QoZG1hYnVmLCBpOTE1X2dlbV9kbWFidWZfbGl2ZV9zZWxmdGVzdHMpCj4gQEAgLTI0LDcgKzI1
LDcgQEAgc2VsZnRlc3QoZ3R0LCBpOTE1X2dlbV9ndHRfbGl2ZV9zZWxmdGVzdHMpCj4gICBzZWxm
dGVzdChnZW0sIGk5MTVfZ2VtX2xpdmVfc2VsZnRlc3RzKQo+ICAgc2VsZnRlc3QoZXZpY3QsIGk5
MTVfZ2VtX2V2aWN0X2xpdmVfc2VsZnRlc3RzKQo+ICAgc2VsZnRlc3QoaHVnZXBhZ2VzLCBpOTE1
X2dlbV9odWdlX3BhZ2VfbGl2ZV9zZWxmdGVzdHMpCj4gLXNlbGZ0ZXN0KGNvbnRleHRzLCBpOTE1
X2dlbV9jb250ZXh0X2xpdmVfc2VsZnRlc3RzKQo+ICtzZWxmdGVzdChnZW1fY29udGV4dHMsIGk5
MTVfZ2VtX2NvbnRleHRfbGl2ZV9zZWxmdGVzdHMpCj4gICBzZWxmdGVzdChibHQsIGk5MTVfZ2Vt
X29iamVjdF9ibHRfbGl2ZV9zZWxmdGVzdHMpCj4gICBzZWxmdGVzdChjbGllbnQsIGk5MTVfZ2Vt
X2NsaWVudF9ibHRfbGl2ZV9zZWxmdGVzdHMpCj4gICBzZWxmdGVzdChyZXNldCwgaW50ZWxfcmVz
ZXRfbGl2ZV9zZWxmdGVzdHMpCj4gCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2ludGVsLWdmeA==

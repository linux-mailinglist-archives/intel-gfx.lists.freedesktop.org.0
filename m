Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 5ADB910233C
	for <lists+intel-gfx@lfdr.de>; Tue, 19 Nov 2019 12:37:21 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id AC9236E8D9;
	Tue, 19 Nov 2019 11:37:19 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga14.intel.com (mga14.intel.com [192.55.52.115])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2195C6E928
 for <intel-gfx@lists.freedesktop.org>; Tue, 19 Nov 2019 11:37:18 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by fmsmga103.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 19 Nov 2019 03:37:17 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.68,322,1569308400"; d="scan'208";a="258700066"
Received: from alooi-mobl.gar.corp.intel.com (HELO
 skylake-nuc.ger.corp.intel.com) ([10.249.254.144])
 by FMSMGA003.fm.intel.com with ESMTP; 19 Nov 2019 03:37:15 -0800
From: Abdiel Janulgue <abdiel.janulgue@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 19 Nov 2019 13:37:07 +0200
Message-Id: <20191119113710.1162-1-abdiel.janulgue@linux.intel.com>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 1/4] drm/i915: Allow i915 to manage the vma
 offset nodes instead of drm core
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Matthew Auld <matthew.auld@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SGF2ZSBpOTE1IHJlcGxhY2UgdGhlIGNvcmUgZHJtX2dlbV9tbWFwIGltcGxlbWVudGF0aW9uIHRv
IG92ZXJjb21lIGl0cwpsaW1pdGF0aW9uIGluIGhhdmluZyBvbmx5IGEgc2luZ2xlIG1tYXAgb2Zm
c2V0IG5vZGUgcGVyIGdlbSBvYmplY3QuClRoaXMgY2hhbmdlIGFsbG93cyB1cyB0byBoYXZlIG11
bHRpcGxlIG1tYXAgb2Zmc2V0cyBwZXIgb2JqZWN0IGFuZAplbmFibGVzIGEgbW1hcHBpbmcgaW5z
dGFuY2UgdG8gdXNlIHVuaXF1ZSBmYXVsdC1oYW5kbGVycyBwZXIgdXNlciB2bWEuCgpUaGlzIGFs
bG93cyBpOTE1IHRvIHN0b3JlIGV4dHJhIGRhdGEgd2l0aGluIHZtYS0+dm1fcHJpdmF0ZV9kYXRh
IGFuZAphc3NpZ24gdGhlIHBhZ2VmYXVsdCBvcHMgZm9yIGVhY2ggbW1hcCBpbnN0YW5jZSBhbGxv
d2luZyBvYmplY3RzIHRvIHVzZQptdWx0aXBsZSBmYXVsdCBoYW5kbGVycyBkZXBlbmRpbmcgb24g
aXRzIGJhY2tpbmcgc3RvcmFnZS4KCnYyOgogLSBGaXggcmFjZSBjb25kaXRpb24gZXhwb3NlZCBi
eSBnZW1fbW1hcF9ndHRAY2xvc2UtcmFjZS4gU2ltcGxpZnkKICAgbGlmZXRpbWUgbWFuYWdlbWVu
dCBvZiB0aGUgbW1hcCBvZmZzZXQgb2JqZWN0cyBiZSBlbnN1cmluZyBpdCBpcwogICBvd25lZCBi
eSB0aGUgcGFyZW50IGdlbSBvYmplY3QgaW5zdGVhZCBvZiByZWZjb3VudGluZy4KIC0gVHJhY2sg
bW1vIHVzZWQgYnkgZmVuY2luZyB0byBhdm9pZCBsb2NraW5nIHdoZW4gcmV2b2tpbmcgbW1hcHMK
ICAgZHVyaW5nIEdQVSByZXNldC4KIC0gUmViYXNlLgp2MzoKIC0gU2ltcGxpZnkgbW1vIHRyYWNr
aW5nCnY0OgogLSB1c2Ugdm1hLT5tbW8gaW4gX19pOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFw
X2d0dAp2NToKIC0gUmV2b2tlIENQVSBtbWFwcyBvbiBpOTE1X2dlbV9vYmplY3RfdW5iaW5kKCkg
c2luY2UgdW5saWtlIEdUVAogICBtbWFwcywgdGhleSBkb24ndCBoYXZlIGJvdW5kIGk5MTVfdm1h
IG9iamVjdHMuIFJlYmFzZS4KdjY6IE1pbm9yIHR3ZWFrcywgaGVhZGVyIHJlLW9yZyAoQ2hyaXMp
CnY3OgotIENhbGwgZHJtX3ZtYV9ub2RlX3Jldm9rZSBmb3IgdGhlIG1tbyB3aXRoIGNvcnJlc3Bv
bmRpbmcgZmlsZSB3aGVuCiAgcmVsZWFzaW5nIHRoZSBnZW0gaGFuZGxlIGluc3RlYWQgb2YgaW4g
dGhlIG1tbydzIHRlYXJkb3duLgotIEFkZCBmbGFnIEk5MTVfQk9fUkVBRE9OTFkgaW5zdGVhZCBv
ZiBvYmotPnJlYWRvbmx5LgoKU2lnbmVkLW9mZi1ieTogQWJkaWVsIEphbnVsZ3VlIDxhYmRpZWwu
amFudWxndWVAbGludXguaW50ZWwuY29tPgpDYzogTWF0dGhldyBBdWxkIDxtYXR0aGV3LmF1bGRA
aW50ZWwuY29tPgpDYzogSm9vbmFzIExhaHRpbmVuIDxqb29uYXMubGFodGluZW5AbGludXguaW50
ZWwuY29tPgpDYzogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0tLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jICAgIHwgICAzICstCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5jICAgICAgfCAyNDEgKysrKysr
KysrKysrKysrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5oICAg
ICAgfCAgMjggKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYyAg
ICB8ICAxOCArKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oICAg
IHwgICA3ICstCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaCAg
fCAgMTkgKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jICAgICB8
ICAgMyArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdGlsaW5nLmMgICAgfCAg
IDEgKwogLi4uL2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jICAgIHwgIDIw
ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jICAgICAgICAgfCAgIDcg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAgICB8ICAxMSAr
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCAgICAgICAgICAgICAgIHwgICAzIC0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgICAgICAgICAgICAgICB8ICAgMyArLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5jICAgICAgICAgIHwgICAxICsKIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMgICAgICAgICAgICAgICB8ICAgMyArLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuaCAgICAgICAgICAgICAgIHwgICAzICsKIDE2IGZp
bGVzIGNoYW5nZWQsIDMxMyBpbnNlcnRpb25zKCspLCA1OCBkZWxldGlvbnMoLSkKIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5oCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jCmluZGV4IGUyYWY2M2FmNjdh
ZC4uZmQxYzZmMTJiNzdhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fZG9tYWluLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2Rv
bWFpbi5jCkBAIC0xMyw2ICsxMyw3IEBACiAjaW5jbHVkZSAiaTkxNV9nZW1fb2JqZWN0LmgiCiAj
aW5jbHVkZSAiaTkxNV92bWEuaCIKICNpbmNsdWRlICJpOTE1X2dlbV9sbWVtLmgiCisjaW5jbHVk
ZSAiaTkxNV9nZW1fbW1hbi5oIgogCiBzdGF0aWMgdm9pZCBfX2k5MTVfZ2VtX29iamVjdF9mbHVz
aF9mb3JfZGlzcGxheShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewpAQCAtMjU1
LDcgKzI1Niw3IEBAIGludCBpOTE1X2dlbV9vYmplY3Rfc2V0X2NhY2hlX2xldmVsKHN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCQl9CiAKIAkJCWlmIChvYmotPnVzZXJmYXVsdF9j
b3VudCkKLQkJCQlfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAob2JqKTsKKwkJCQlfX2k5
MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfZ3R0KG9iaik7CiAKIAkJCS8qCiAJCQkgKiBBcyB3
ZSBubyBsb25nZXIgbmVlZCBhIGZlbmNlIGZvciBHVFQgYWNjZXNzLApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMKaW5kZXggZDYwOTczNjAzY2MxLi4zNmZmZmI2NzE2MDEg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYwpAQCAtMTQsNiArMTQs
NyBAQAogI2luY2x1ZGUgImk5MTVfZ2VtX2d0dC5oIgogI2luY2x1ZGUgImk5MTVfZ2VtX2lvY3Rs
cy5oIgogI2luY2x1ZGUgImk5MTVfZ2VtX29iamVjdC5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX21t
YW4uaCIKICNpbmNsdWRlICJpOTE1X3RyYWNlLmgiCiAjaW5jbHVkZSAiaTkxNV92bWEuaCIKIApA
QCAtMjE5LDcgKzIyMCw4IEBAIHZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0IHZtX2Zh
dWx0ICp2bWYpCiB7CiAjZGVmaW5lIE1JTl9DSFVOS19QQUdFUyAoU1pfMU0gPj4gUEFHRV9TSElG
VCkKIAlzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKmFyZWEgPSB2bWYtPnZtYTsKLQlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqID0gdG9faW50ZWxfYm8oYXJlYS0+dm1fcHJpdmF0ZV9kYXRh
KTsKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqcHJpdiA9IGFyZWEtPnZtX3ByaXZhdGVfZGF0
YTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gcHJpdi0+b2JqOwogCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSBvYmotPmJhc2UuZGV2OwogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwogCXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0g
PSAmaTkxNS0+cnVudGltZV9wbTsKQEAgLTMxMiw2ICszMTQsOSBAQCB2bV9mYXVsdF90IGk5MTVf
Z2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQogCQlsaXN0X2FkZCgmb2JqLT51c2VyZmF1
bHRfbGluaywgJmk5MTUtPmdndHQudXNlcmZhdWx0X2xpc3QpOwogCW11dGV4X3VubG9jaygmaTkx
NS0+Z2d0dC52bS5tdXRleCk7CiAKKwkvKiBUcmFjayB0aGUgbW1vIGFzc29jaWF0ZWQgd2l0aCB0
aGUgZmVuY2VkIHZtYSAqLworCXZtYS0+bW1vID0gcHJpdjsKKwogCWlmIChJU19BQ1RJVkUoQ09O
RklHX0RSTV9JOTE1X1VTRVJGQVVMVF9BVVRPU1VTUEVORCkpCiAJCWludGVsX3dha2VyZWZfYXV0
bygmaTkxNS0+Z2d0dC51c2VyZmF1bHRfd2FrZXJlZiwKIAkJCQkgICBtc2Vjc190b19qaWZmaWVz
X3RpbWVvdXQoQ09ORklHX0RSTV9JOTE1X1VTRVJGQVVMVF9BVVRPU1VTUEVORCkpOwpAQCAtMzU4
LDI4ICszNjMsMTkgQEAgdm1fZmF1bHRfdCBpOTE1X2dlbV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQg
KnZtZikKIAl9CiB9CiAKLXZvaWQgX19pOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKHN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCit2b2lkIF9faTkxNV9nZW1fb2JqZWN0X3JlbGVh
c2VfbW1hcF9ndHQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIHsKIAlzdHJ1Y3Qg
aTkxNV92bWEgKnZtYTsKIAogCUdFTV9CVUdfT04oIW9iai0+dXNlcmZhdWx0X2NvdW50KTsKIAot
CW9iai0+dXNlcmZhdWx0X2NvdW50ID0gMDsKLQlsaXN0X2RlbCgmb2JqLT51c2VyZmF1bHRfbGlu
ayk7Ci0JZHJtX3ZtYV9ub2RlX3VubWFwKCZvYmotPmJhc2Uudm1hX25vZGUsCi0JCQkgICBvYmot
PmJhc2UuZGV2LT5hbm9uX2lub2RlLT5pX21hcHBpbmcpOwotCiAJZm9yX2VhY2hfZ2d0dF92bWEo
dm1hLCBvYmopCi0JCWk5MTVfdm1hX3Vuc2V0X3VzZXJmYXVsdCh2bWEpOworCQlpOTE1X3ZtYV9y
ZXZva2VfbW1hcCh2bWEpOworCisJR0VNX0JVR19PTihvYmotPnVzZXJmYXVsdF9jb3VudCk7CiB9
CiAKIC8qKgotICogaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcCAtIHJlbW92ZSBwaHlzaWNh
bCBwYWdlIG1hcHBpbmdzCi0gKiBAb2JqOiBvYmogaW4gcXVlc3Rpb24KLSAqCi0gKiBQcmVzZXJ2
ZSB0aGUgcmVzZXJ2YXRpb24gb2YgdGhlIG1tYXBwaW5nIHdpdGggdGhlIERSTSBjb3JlIGNvZGUs
IGJ1dAotICogcmVsaW5xdWlzaCBvd25lcnNoaXAgb2YgdGhlIHBhZ2VzIGJhY2sgdG8gdGhlIHN5
c3RlbS4KLSAqCiAgKiBJdCBpcyB2aXRhbCB0aGF0IHdlIHJlbW92ZSB0aGUgcGFnZSBtYXBwaW5n
IGlmIHdlIGhhdmUgbWFwcGVkIGEgdGlsZWQKICAqIG9iamVjdCB0aHJvdWdoIHRoZSBHVFQgYW5k
IHRoZW4gbG9zZSB0aGUgZmVuY2UgcmVnaXN0ZXIgZHVlIHRvCiAgKiByZXNvdXJjZSBwcmVzc3Vy
ZS4gU2ltaWxhcmx5IGlmIHRoZSBvYmplY3QgaGFzIGJlZW4gbW92ZWQgb3V0IG9mIHRoZQpAQCAt
Mzg3LDcgKzM4Myw3IEBAIHZvaWQgX19pOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKHN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAgKiBtYXBwaW5nIHdpbGwgdGhlbiB0cmlnZ2Vy
IGEgcGFnZSBmYXVsdCBvbiB0aGUgbmV4dCB1c2VyIGFjY2VzcywgYWxsb3dpbmcKICAqIGZpeHVw
IGJ5IGk5MTVfZ2VtX2ZhdWx0KCkuCiAgKi8KLXZvaWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2Vf
bW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQorc3RhdGljIHZvaWQgaTkxNV9n
ZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9ndHQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aikKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUob2JqLT5iYXNl
LmRldik7CiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CkBAIC00MDYsNyArNDAyLDcgQEAgdm9p
ZCBpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmopCiAJaWYgKCFvYmotPnVzZXJmYXVsdF9jb3VudCkKIAkJZ290byBvdXQ7CiAKLQlfX2k5
MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAob2JqKTsKKwlfX2k5MTVfZ2VtX29iamVjdF9yZWxl
YXNlX21tYXBfZ3R0KG9iaik7CiAKIAkvKiBFbnN1cmUgdGhhdCB0aGUgQ1BVJ3MgUFRFIGFyZSBy
ZXZva2VkIGFuZCB0aGVyZSBhcmUgbm90IG91dHN0YW5kaW5nCiAJICogbWVtb3J5IHRyYW5zYWN0
aW9ucyBmcm9tIHVzZXJzcGFjZSBiZWZvcmUgd2UgcmV0dXJuLiBUaGUgVExCCkBAIC00MjIsMTUg
KzQxOCw2MyBAQCB2b2lkIGk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAoc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iaikKIAlpbnRlbF9ydW50aW1lX3BtX3B1dCgmaTkxNS0+cnVudGlt
ZV9wbSwgd2FrZXJlZik7CiB9CiAKLXN0YXRpYyBpbnQgY3JlYXRlX21tYXBfb2Zmc2V0KHN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCit2b2lkIGk5MTVfZ2VtX29iamVjdF9yZWxlYXNl
X21tYXBfb2Zmc2V0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCit7CisJc3RydWN0
IGk5MTVfbW1hcF9vZmZzZXQgKm1tbzsKKworCW11dGV4X2xvY2soJm9iai0+bW1vX2xvY2spOwor
CWxpc3RfZm9yX2VhY2hfZW50cnkobW1vLCAmb2JqLT5tbWFwX29mZnNldHMsIG9mZnNldCkgewor
CQkvKiB2bWFfbm9kZV91bm1hcCBmb3IgR1RUIG1tYXBzIGhhbmRsZWQgYWxyZWFkeSBpbgorCQkg
KiBfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfZ3R0CisJCSAqLworCQlpZiAobW1vLT5t
bWFwX3R5cGUgIT0gSTkxNV9NTUFQX1RZUEVfR1RUKQorCQkJZHJtX3ZtYV9ub2RlX3VubWFwKCZt
bW8tPnZtYV9ub2RlLAorCQkJCQkgICBvYmotPmJhc2UuZGV2LT5hbm9uX2lub2RlLT5pX21hcHBp
bmcpOworCX0KKwltdXRleF91bmxvY2soJm9iai0+bW1vX2xvY2spOworfQorCisvKioKKyAqIGk5
MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAgLSByZW1vdmUgcGh5c2ljYWwgcGFnZSBtYXBwaW5n
cworICogQG9iajogb2JqIGluIHF1ZXN0aW9uCisgKgorICogUHJlc2VydmUgdGhlIHJlc2VydmF0
aW9uIG9mIHRoZSBtbWFwcGluZyB3aXRoIHRoZSBEUk0gY29yZSBjb2RlLCBidXQKKyAqIHJlbGlu
cXVpc2ggb3duZXJzaGlwIG9mIHRoZSBwYWdlcyBiYWNrIHRvIHRoZSBzeXN0ZW0uCisgKi8KK3Zv
aWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqKQoreworCWk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfZ3R0KG9iaik7CisJaTkx
NV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9vZmZzZXQob2JqKTsKK30KKworc3RhdGljIHZvaWQg
aW5pdF9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAorCQkJICAg
ICBzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1vKQoreworCW11dGV4X2xvY2soJm9iai0+bW1v
X2xvY2spOworCWxpc3RfYWRkKCZtbW8tPm9mZnNldCwgJm9iai0+bW1hcF9vZmZzZXRzKTsKKwlt
dXRleF91bmxvY2soJm9iai0+bW1vX2xvY2spOworCisJbW1vLT5vYmogPSBvYmo7CisJbW1vLT5k
ZXYgPSBvYmotPmJhc2UuZGV2OworfQorCitzdGF0aWMgaW50IGNyZWF0ZV9tbWFwX29mZnNldChz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAorCQkJICAgICAgc3RydWN0IGk5MTVfbW1h
cF9vZmZzZXQgKm1tbykKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUob2JqLT5iYXNlLmRldik7CiAJc3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKKwlz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gb2JqLT5iYXNlLmRldjsKIAlpbnQgZXJyOwogCi0JZXJy
ID0gZHJtX2dlbV9jcmVhdGVfbW1hcF9vZmZzZXQoJm9iai0+YmFzZSk7Ci0JaWYgKGxpa2VseSgh
ZXJyKSkKKwlkcm1fdm1hX25vZGVfcmVzZXQoJm1tby0+dm1hX25vZGUpOworCWlmIChtbW8tPmZp
bGUpCisJCWRybV92bWFfbm9kZV9hbGxvdygmbW1vLT52bWFfbm9kZSwgbW1vLT5maWxlKTsKKwll
cnIgPSBkcm1fdm1hX29mZnNldF9hZGQoZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIsICZtbW8tPnZt
YV9ub2RlLAorCQkJCSBvYmotPmJhc2Uuc2l6ZSAvIFBBR0VfU0laRSk7CisJaWYgKGxpa2VseSgh
ZXJyKSkgeworCQlpbml0X21tYXBfb2Zmc2V0KG9iaiwgbW1vKTsKIAkJcmV0dXJuIDA7CisJfQog
CiAJLyogQXR0ZW1wdCB0byByZWFwIHNvbWUgbW1hcCBzcGFjZSBmcm9tIGRlYWQgb2JqZWN0cyAq
LwogCWVyciA9IGludGVsX2d0X3JldGlyZV9yZXF1ZXN0c190aW1lb3V0KGd0LCBNQVhfU0NIRURV
TEVfVElNRU9VVCk7CkBAIC00MzgsMzQgKzQ4Miw1NiBAQCBzdGF0aWMgaW50IGNyZWF0ZV9tbWFw
X29mZnNldChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCQlyZXR1cm4gZXJyOwog
CiAJaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhpOTE1KTsKLQlyZXR1cm4gZHJtX2dlbV9j
cmVhdGVfbW1hcF9vZmZzZXQoJm9iai0+YmFzZSk7CisJZXJyID0gZHJtX3ZtYV9vZmZzZXRfYWRk
KGRldi0+dm1hX29mZnNldF9tYW5hZ2VyLCAmbW1vLT52bWFfbm9kZSwKKwkJCQkgb2JqLT5iYXNl
LnNpemUgLyBQQUdFX1NJWkUpOworCWlmIChlcnIpCisJCXJldHVybiBlcnI7CisKKwlpbml0X21t
YXBfb2Zmc2V0KG9iaiwgbW1vKTsKKwlyZXR1cm4gMDsKIH0KIAotaW50Ci1pOTE1X2dlbV9tbWFw
X2d0dChzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUsCi0JCSAgc3RydWN0IGRybV9kZXZpY2UgKmRldiwK
LQkJICB1MzIgaGFuZGxlLAotCQkgIHU2NCAqb2Zmc2V0KQorc3RhdGljIGludAorX19hc3NpZ25f
Z2VtX29iamVjdF9tbWFwX2RhdGEoc3RydWN0IGRybV9maWxlICpmaWxlLAorCQkJICAgICAgdTMy
IGhhbmRsZSwKKwkJCSAgICAgIGVudW0gaTkxNV9tbWFwX3R5cGUgbW1hcF90eXBlLAorCQkJICAg
ICAgdTY0ICpvZmZzZXQpCiB7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwlz
dHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1vOwogCWludCByZXQ7CiAKLQlpZiAoIWk5MTVfZ2d0
dF9oYXNfYXBlcnR1cmUoJnRvX2k5MTUoZGV2KS0+Z2d0dCkpCi0JCXJldHVybiAtRU5PREVWOwot
CiAJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2xvb2t1cChmaWxlLCBoYW5kbGUpOwogCWlmICghb2Jq
KQogCQlyZXR1cm4gLUVOT0VOVDsKIAotCWlmIChpOTE1X2dlbV9vYmplY3RfbmV2ZXJfYmluZF9n
Z3R0KG9iaikpIHsKKwlpZiAobW1hcF90eXBlID09IEk5MTVfTU1BUF9UWVBFX0dUVCAmJgorCSAg
ICBpOTE1X2dlbV9vYmplY3RfbmV2ZXJfYmluZF9nZ3R0KG9iaikpIHsKIAkJcmV0ID0gLUVOT0RF
VjsKIAkJZ290byBvdXQ7CiAJfQogCi0JcmV0ID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9iaik7Ci0J
aWYgKHJldCA9PSAwKQotCQkqb2Zmc2V0ID0gZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKCZvYmot
PmJhc2Uudm1hX25vZGUpOworCWlmIChtbWFwX3R5cGUgIT0gSTkxNV9NTUFQX1RZUEVfR1RUICYm
CisJICAgICFpOTE1X2dlbV9vYmplY3RfaGFzX3N0cnVjdF9wYWdlKG9iaikpIHsKKwkJcmV0ID0g
LUVOT0RFVjsKKwkJZ290byBvdXQ7CisJfQorCisJbW1vID0ga3phbGxvYyhzaXplb2YoKm1tbyks
IEdGUF9LRVJORUwpOworCWlmICghbW1vKSB7CisJCXJldCA9IC1FTk9NRU07CisJCWdvdG8gb3V0
OworCX0KKworCW1tby0+ZmlsZSA9IGZpbGU7CisJcmV0ID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9i
aiwgbW1vKTsKKwlpZiAocmV0KSB7CisJCWtmcmVlKG1tbyk7CisJCWdvdG8gb3V0OworCX0KIAor
CW1tby0+bW1hcF90eXBlID0gbW1hcF90eXBlOworCSpvZmZzZXQgPSBkcm1fdm1hX25vZGVfb2Zm
c2V0X2FkZHIoJm1tby0+dm1hX25vZGUpOwogb3V0OgogCWk5MTVfZ2VtX29iamVjdF9wdXQob2Jq
KTsKIAlyZXR1cm4gcmV0OwpAQCAtNDkyLDcgKzU1OCwxMTYgQEAgaTkxNV9nZW1fbW1hcF9ndHRf
aW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIHsKIAlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX21tYXBfZ3R0ICphcmdzID0gZGF0YTsKIAotCXJldHVybiBpOTE1X2dlbV9tbWFw
X2d0dChmaWxlLCBkZXYsIGFyZ3MtPmhhbmRsZSwgJmFyZ3MtPm9mZnNldCk7CisJcmV0dXJuIF9f
YXNzaWduX2dlbV9vYmplY3RfbW1hcF9kYXRhKGZpbGUsIGFyZ3MtPmhhbmRsZSwKKwkJCQkJICAg
ICBJOTE1X01NQVBfVFlQRV9HVFQsCisJCQkJCSAgICAgJmFyZ3MtPm9mZnNldCk7Cit9CisKK3Zv
aWQgaTkxNV9tbWFwX29mZnNldF9kZXN0cm95KHN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW8s
IHN0cnVjdCBtdXRleCAqbXV0ZXgpCit7CisJZHJtX3ZtYV9vZmZzZXRfcmVtb3ZlKG1tby0+ZGV2
LT52bWFfb2Zmc2V0X21hbmFnZXIsICZtbW8tPnZtYV9ub2RlKTsKKworCW11dGV4X2xvY2sobXV0
ZXgpOworCWxpc3RfZGVsKCZtbW8tPm9mZnNldCk7CisJbXV0ZXhfdW5sb2NrKG11dGV4KTsKKwor
CWtmcmVlKG1tbyk7Cit9CisKK3N0YXRpYyB2b2lkIGk5MTVfZ2VtX3ZtX29wZW4oc3RydWN0IHZt
X2FyZWFfc3RydWN0ICp2bWEpCit7CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbyA9IHZt
YS0+dm1fcHJpdmF0ZV9kYXRhOworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBt
bW8tPm9iajsKKworCUdFTV9CVUdfT04oIW9iaik7CisJaTkxNV9nZW1fb2JqZWN0X2dldChvYmop
OworfQorCitzdGF0aWMgdm9pZCBpOTE1X2dlbV92bV9jbG9zZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1
Y3QgKnZtYSkKK3sKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1vID0gdm1hLT52bV9wcml2
YXRlX2RhdGE7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IG1tby0+b2JqOwor
CisJR0VNX0JVR19PTighb2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7Cit9CisKK3N0
YXRpYyBjb25zdCBzdHJ1Y3Qgdm1fb3BlcmF0aW9uc19zdHJ1Y3QgaTkxNV9nZW1fZ3R0X3ZtX29w
cyA9IHsKKwkuZmF1bHQgPSBpOTE1X2dlbV9mYXVsdCwKKwkub3BlbiA9IGk5MTVfZ2VtX3ZtX29w
ZW4sCisJLmNsb3NlID0gaTkxNV9nZW1fdm1fY2xvc2UsCit9OworCisvKiBUaGlzIG92ZXJjb21l
cyB0aGUgbGltaXRhdGlvbiBpbiBkcm1fZ2VtX21tYXAncyBhc3NpZ25tZW50IG9mIGEKKyAqIGRy
bV9nZW1fb2JqZWN0IGFzIHRoZSB2bWEtPnZtX3ByaXZhdGVfZGF0YS4gU2luY2Ugd2UgbmVlZCB0
bworICogYmUgYWJsZSB0byByZXNvbHZlIG11bHRpcGxlIG1tYXAgb2Zmc2V0cyB3aGljaCBjb3Vs
ZCBiZSB0aWVkCisgKiB0byBhIHNpbmdsZSBnZW0gb2JqZWN0LgorICovCitpbnQgaTkxNV9nZW1f
bW1hcChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCit7CisJ
c3RydWN0IGRybV92bWFfb2Zmc2V0X25vZGUgKm5vZGU7CisJc3RydWN0IGRybV9maWxlICpwcml2
ID0gZmlscC0+cHJpdmF0ZV9kYXRhOworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBwcml2LT5t
aW5vci0+ZGV2OworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW8gPSBOVUxMOworCXN0cnVj
dCBkcm1fZ2VtX29iamVjdCAqb2JqID0gTlVMTDsKKworCWlmIChkcm1fZGV2X2lzX3VucGx1Z2dl
ZChkZXYpKQorCQlyZXR1cm4gLUVOT0RFVjsKKworCWRybV92bWFfb2Zmc2V0X2xvY2tfbG9va3Vw
KGRldi0+dm1hX29mZnNldF9tYW5hZ2VyKTsKKwlub2RlID0gZHJtX3ZtYV9vZmZzZXRfZXhhY3Rf
bG9va3VwX2xvY2tlZChkZXYtPnZtYV9vZmZzZXRfbWFuYWdlciwKKwkJCQkJCSAgdm1hLT52bV9w
Z29mZiwKKwkJCQkJCSAgdm1hX3BhZ2VzKHZtYSkpOworCWlmIChsaWtlbHkobm9kZSkpIHsKKwkJ
bW1vID0gY29udGFpbmVyX29mKG5vZGUsIHN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0LAorCQkJCSAg
IHZtYV9ub2RlKTsKKwkJLyoKKwkJICogSW4gb3VyIGRlcGVuZGVuY3kgY2hhaW4sIHRoZSBkcm1f
dm1hX29mZnNldF9ub2RlCisJCSAqIGRlcGVuZHMgb24gdGhlIHZhbGlkaXR5IG9mIHRoZSBtbW8s
IHdoaWNoIGRlcGVuZHMgb24KKwkJICogdGhlIGdlbSBvYmplY3QuIEhvd2V2ZXIgdGhlIG9ubHkg
cmVmZXJlbmNlIHdlIGhhdmUKKwkJICogYXQgdGhpcyBwb2ludCBpcyB0aGUgbW1vIChhcyB0aGUg
cGFyZW50IG9mIHRoZSBub2RlKS4KKwkJICogVHJ5IHRvIGNoZWNrIGlmIHRoZSBnZW0gb2JqZWN0
IHdhcyBhdCBsZWFzdCBjbGVhcmVkLgorCQkgKi8KKwkJaWYgKCFtbW8gfHwgIW1tby0+b2JqKSB7
CisJCQlkcm1fdm1hX29mZnNldF91bmxvY2tfbG9va3VwKGRldi0+dm1hX29mZnNldF9tYW5hZ2Vy
KTsKKwkJCXJldHVybiAtRUlOVkFMOworCQl9CisJCS8qCisJCSAqIFNraXAgMC1yZWZjbnRlZCBv
YmplY3RzIGFzIGl0IGlzIGluIHRoZSBwcm9jZXNzIG9mIGJlaW5nCisJCSAqIGRlc3Ryb3llZCBh
bmQgd2lsbCBiZSBpbnZhbGlkIHdoZW4gdGhlIHZtYSBtYW5hZ2VyIGxvY2sKKwkJICogaXMgcmVs
ZWFzZWQuCisJCSAqLworCQlvYmogPSAmbW1vLT5vYmotPmJhc2U7CisJCWlmICgha3JlZl9nZXRf
dW5sZXNzX3plcm8oJm9iai0+cmVmY291bnQpKQorCQkJb2JqID0gTlVMTDsKKworCX0KKwlkcm1f
dm1hX29mZnNldF91bmxvY2tfbG9va3VwKGRldi0+dm1hX29mZnNldF9tYW5hZ2VyKTsKKworCWlm
ICghb2JqKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWlmICghZHJtX3ZtYV9ub2RlX2lzX2FsbG93
ZWQobm9kZSwgcHJpdikpIHsKKwkJZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKG9iaik7CisJ
CXJldHVybiAtRUFDQ0VTOworCX0KKworCWlmIChpOTE1X2dlbV9vYmplY3RfaXNfcmVhZG9ubHko
dG9faW50ZWxfYm8ob2JqKSkpIHsKKwkJaWYgKHZtYS0+dm1fZmxhZ3MgJiBWTV9XUklURSkgewor
CQkJZHJtX2dlbV9vYmplY3RfcHV0X3VubG9ja2VkKG9iaik7CisJCQlyZXR1cm4gLUVJTlZBTDsK
KwkJfQorCQl2bWEtPnZtX2ZsYWdzICY9IH5WTV9NQVlXUklURTsKKwl9CisKKwl2bWEtPnZtX2Zs
YWdzIHw9IFZNX1BGTk1BUCB8IFZNX0RPTlRFWFBBTkQgfCBWTV9ET05URFVNUDsKKwl2bWEtPnZt
X3BhZ2VfcHJvdCA9IHBncHJvdF93cml0ZWNvbWJpbmUodm1fZ2V0X3BhZ2VfcHJvdCh2bWEtPnZt
X2ZsYWdzKSk7CisJdm1hLT52bV9wYWdlX3Byb3QgPSBwZ3Byb3RfZGVjcnlwdGVkKHZtYS0+dm1f
cGFnZV9wcm90KTsKKwl2bWEtPnZtX3ByaXZhdGVfZGF0YSA9IG1tbzsKKworCXZtYS0+dm1fb3Bz
ID0gJmk5MTVfZ2VtX2d0dF92bV9vcHM7CisKKwlyZXR1cm4gMDsKIH0KIAogI2lmIElTX0VOQUJM
RUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9tbWFuLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4yNWEz
YzRkNmNkNjUKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fbW1hbi5oCkBAIC0wLDAgKzEsMjggQEAKKy8qCisgKiBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogTUlUCisgKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24KKyAq
LworCisjaWZuZGVmIF9fSTkxNV9HRU1fTU1BTl9IX18KKyNkZWZpbmUgX19JOTE1X0dFTV9NTUFO
X0hfXworCisjaW5jbHVkZSA8bGludXgvbW1fdHlwZXMuaD4KKyNpbmNsdWRlIDxsaW51eC90eXBl
cy5oPgorCitzdHJ1Y3QgZHJtX2RldmljZTsKK3N0cnVjdCBkcm1fZmlsZTsKK3N0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0Oworc3RydWN0IGZpbGU7CitzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldDsK
K3N0cnVjdCBtdXRleDsKKworaW50IGk5MTVfZ2VtX21tYXAoc3RydWN0IGZpbGUgKmZpbHAsIHN0
cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKTsKK3ZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3Ry
dWN0IHZtX2ZhdWx0ICp2bWYpOwordm9pZCBpOTE1X21tYXBfb2Zmc2V0X2Rlc3Ryb3koc3RydWN0
IGk5MTVfbW1hcF9vZmZzZXQgKm1tbywgc3RydWN0IG11dGV4ICptdXRleCk7CisKK3ZvaWQgX19p
OTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwX2d0dChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqKTsKK3ZvaWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqKTsKK3ZvaWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9v
ZmZzZXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaik7CisKKyNlbmRpZgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jCmluZGV4IGRiMTAzZDNjODc2MC4u
NDRjYjVhMmIxNDBkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fb2JqZWN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVj
dC5jCkBAIC0yOSw2ICsyOSw3IEBACiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRlICJp
OTE1X2dlbV9jbGZsdXNoLmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1fY29udGV4dC5oIgorI2luY2x1
ZGUgImk5MTVfZ2VtX21tYW4uaCIKICNpbmNsdWRlICJpOTE1X2dlbV9vYmplY3QuaCIKICNpbmNs
dWRlICJpOTE1X2dsb2JhbHMuaCIKICNpbmNsdWRlICJpOTE1X3RyYWNlLmgiCkBAIC02MSw2ICs2
Miw5IEBAIHZvaWQgaTkxNV9nZW1fb2JqZWN0X2luaXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaiwKIAogCUlOSVRfTElTVF9IRUFEKCZvYmotPmx1dF9saXN0KTsKIAorCW11dGV4X2lu
aXQoJm9iai0+bW1vX2xvY2spOworCUlOSVRfTElTVF9IRUFEKCZvYmotPm1tYXBfb2Zmc2V0cyk7
CisKIAlpbml0X3JjdV9oZWFkKCZvYmotPnJjdSk7CiAKIAlvYmotPm9wcyA9IG9wczsKQEAgLTk3
LDYgKzEwMSw3IEBAIHZvaWQgaTkxNV9nZW1fY2xvc2Vfb2JqZWN0KHN0cnVjdCBkcm1fZ2VtX29i
amVjdCAqZ2VtLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCiAJc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaiA9IHRvX2ludGVsX2JvKGdlbSk7CiAJc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJp
dmF0ZSAqZnByaXYgPSBmaWxlLT5kcml2ZXJfcHJpdjsKIAlzdHJ1Y3QgaTkxNV9sdXRfaGFuZGxl
ICpsdXQsICpsbjsKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1vLCAqb247CiAJTElTVF9I
RUFEKGNsb3NlKTsKIAogCWk5MTVfZ2VtX29iamVjdF9sb2NrKG9iaik7CkBAIC0xMTEsNiArMTE2
LDkgQEAgdm9pZCBpOTE1X2dlbV9jbG9zZV9vYmplY3Qoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpn
ZW0sIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKIAl9CiAJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhv
YmopOwogCisJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKG1tbywgb24sICZvYmotPm1tYXBfb2Zm
c2V0cywgb2Zmc2V0KQorCQlkcm1fdm1hX25vZGVfcmV2b2tlKCZtbW8tPnZtYV9ub2RlLCBmaWxl
KTsKKwogCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShsdXQsIGxuLCAmY2xvc2UsIG9ial9saW5r
KSB7CiAJCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBsdXQtPmN0eDsKIAkJc3RydWN0
IGk5MTVfdm1hICp2bWE7CkBAIC0xNTgsNiArMTY2LDggQEAgc3RhdGljIHZvaWQgX19pOTE1X2dl
bV9mcmVlX29iamVjdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAKIAl3YWtlcmVm
ID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwogCWxsaXN0X2Zvcl9l
YWNoX2VudHJ5X3NhZmUob2JqLCBvbiwgZnJlZWQsIGZyZWVkKSB7CisJCXN0cnVjdCBpOTE1X21t
YXBfb2Zmc2V0ICptbW8sICptbjsKKwogCQl0cmFjZV9pOTE1X2dlbV9vYmplY3RfZGVzdHJveShv
YmopOwogCiAJCWlmICghbGlzdF9lbXB0eSgmb2JqLT52bWEubGlzdCkpIHsKQEAgLTE4Myw2ICsx
OTMsMTQgQEAgc3RhdGljIHZvaWQgX19pOTE1X2dlbV9mcmVlX29iamVjdHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCiAJCQlzcGluX3VubG9jaygmb2JqLT52bWEubG9jayk7CiAJCX0K
IAorCQlpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKG9iaik7CisKKwkJbGlzdF9mb3JfZWFj
aF9lbnRyeV9zYWZlKG1tbywgbW4sICZvYmotPm1tYXBfb2Zmc2V0cywgb2Zmc2V0KSB7CisJCQlt
bW8tPm9iaiA9IE5VTEw7CisJCQlpOTE1X21tYXBfb2Zmc2V0X2Rlc3Ryb3kobW1vLCAmb2JqLT5t
bW9fbG9jayk7CisJCX0KKworCQlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZvYmotPm1tYXBfb2Zm
c2V0cykpOwogCQlHRU1fQlVHX09OKGF0b21pY19yZWFkKCZvYmotPmJpbmRfY291bnQpKTsKIAkJ
R0VNX0JVR19PTihvYmotPnVzZXJmYXVsdF9jb3VudCk7CiAJCUdFTV9CVUdfT04oIWxpc3RfZW1w
dHkoJm9iai0+bHV0X2xpc3QpKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9vYmplY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9v
YmplY3QuaAppbmRleCBlNTc1MGQ1MDZjYzkuLmExZWI3YzBiMjNhYyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaApAQCAtMTMyLDEzICsxMzIsMTMgQEAgdm9p
ZCBpOTE1X2dlbV9vYmplY3RfdW5sb2NrX2ZlbmNlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmosCiBzdGF0aWMgaW5saW5lIHZvaWQKIGk5MTVfZ2VtX29iamVjdF9zZXRfcmVhZG9ubHko
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIHsKLQlvYmotPmJhc2Uudm1hX25vZGUu
cmVhZG9ubHkgPSB0cnVlOworCW9iai0+ZmxhZ3MgfD0gSTkxNV9CT19SRUFET05MWTsKIH0KIAog
c3RhdGljIGlubGluZSBib29sCiBpOTE1X2dlbV9vYmplY3RfaXNfcmVhZG9ubHkoY29uc3Qgc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIHsKLQlyZXR1cm4gb2JqLT5iYXNlLnZtYV9u
b2RlLnJlYWRvbmx5OworCXJldHVybiBvYmotPmZsYWdzICYgSTkxNV9CT19SRUFET05MWTsKIH0K
IAogc3RhdGljIGlubGluZSBib29sCkBAIC0zODcsOSArMzg3LDYgQEAgc3RhdGljIGlubGluZSB2
b2lkIGk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaikKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMob2JqKTsKIH0KIAotdm9pZCBfX2k5
MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aik7Ci12b2lkIGk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaik7Ci0KIHZvaWQKIGk5MTVfZ2VtX29iamVjdF9mbHVzaF93cml0ZV9kb21h
aW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAkJCQkgICB1bnNpZ25lZCBpbnQg
Zmx1c2hfZG9tYWlucyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fb2JqZWN0X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
b2JqZWN0X3R5cGVzLmgKaW5kZXggMTVmODI5N2RjMzRlLi44ZmYwODM0YTFkNWMgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgKQEAgLTYz
LDYgKzYzLDIwIEBAIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0X29wcyB7CiAJdm9pZCAoKnJl
bGVhc2UpKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopOwogfTsKIAorZW51bSBpOTE1
X21tYXBfdHlwZSB7CisJSTkxNV9NTUFQX1RZUEVfR1RUID0gMCwKK307CisKK3N0cnVjdCBpOTE1
X21tYXBfb2Zmc2V0IHsKKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2OworCXN0cnVjdCBkcm1fdm1h
X29mZnNldF9ub2RlIHZtYV9ub2RlOworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7
CisJc3RydWN0IGRybV9maWxlICpmaWxlOworCWVudW0gaTkxNV9tbWFwX3R5cGUgbW1hcF90eXBl
OworCisJc3RydWN0IGxpc3RfaGVhZCBvZmZzZXQ7Cit9OworCiBzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCB7CiAJc3RydWN0IGRybV9nZW1fb2JqZWN0IGJhc2U7CiAKQEAgLTExOCwxMiArMTMy
LDE3IEBAIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0IHsKIAl1bnNpZ25lZCBpbnQgdXNlcmZh
dWx0X2NvdW50OwogCXN0cnVjdCBsaXN0X2hlYWQgdXNlcmZhdWx0X2xpbms7CiAKKwkvKiBQcm90
ZWN0cyBhY2Nlc3MgdG8gbW1hcCBvZmZzZXRzICovCisJc3RydWN0IG11dGV4IG1tb19sb2NrOwor
CXN0cnVjdCBsaXN0X2hlYWQgbW1hcF9vZmZzZXRzOworCiAJSTkxNV9TRUxGVEVTVF9ERUNMQVJF
KHN0cnVjdCBsaXN0X2hlYWQgc3RfbGluayk7CiAKIAl1bnNpZ25lZCBsb25nIGZsYWdzOwogI2Rl
ZmluZSBJOTE1X0JPX0FMTE9DX0NPTlRJR1VPVVMgQklUKDApCiAjZGVmaW5lIEk5MTVfQk9fQUxM
T0NfVk9MQVRJTEUgICBCSVQoMSkKICNkZWZpbmUgSTkxNV9CT19BTExPQ19GTEFHUyAoSTkxNV9C
T19BTExPQ19DT05USUdVT1VTIHwgSTkxNV9CT19BTExPQ19WT0xBVElMRSkKKyNkZWZpbmUgSTkx
NV9CT19SRUFET05MWSAgICAgICAgIEJJVCgyKQogCiAJLyoKIAkgKiBJcyB0aGUgb2JqZWN0IHRv
IGJlIG1hcHBlZCBhcyByZWFkLW9ubHkgdG8gdGhlIEdQVQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fcGFnZXMuYwppbmRleCBmNDAyYzJjNDE1YzIuLjc1MTk3Y2E2OTZhOCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMKQEAgLTgsNiArOCw3IEBA
CiAjaW5jbHVkZSAiaTkxNV9nZW1fb2JqZWN0LmgiCiAjaW5jbHVkZSAiaTkxNV9zY2F0dGVybGlz
dC5oIgogI2luY2x1ZGUgImk5MTVfZ2VtX2xtZW0uaCIKKyNpbmNsdWRlICJpOTE1X2dlbV9tbWFu
LmgiCiAKIHZvaWQgX19pOTE1X2dlbV9vYmplY3Rfc2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmosCiAJCQkJIHN0cnVjdCBzZ190YWJsZSAqcGFnZXMsCkBAIC0yMDcsNiAr
MjA4LDggQEAgaW50IF9faTkxNV9nZW1fb2JqZWN0X3B1dF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqKQogCQlnb3RvIHVubG9jazsKIAl9CiAKKwlpOTE1X2dlbV9vYmplY3Rf
cmVsZWFzZV9tbWFwX29mZnNldChvYmopOworCiAJLyoKIAkgKiAtPnB1dF9wYWdlcyBtaWdodCBu
ZWVkIHRvIGFsbG9jYXRlIG1lbW9yeSBmb3IgdGhlIGJpdDE3IHN3aXp6bGUKIAkgKiBhcnJheSwg
aGVuY2UgcHJvdGVjdCB0aGVtIGZyb20gYmVpbmcgcmVhcGVkIGJ5IHJlbW92aW5nIHRoZW0gZnJv
bSBndHQKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90aWxp
bmcuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90aWxpbmcuYwppbmRleCAx
ZmE1OTJkODJhZjUuLjZjNzgyNWEyZGMyYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3RpbGluZy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV90aWxpbmcuYwpAQCAtMTEsNiArMTEsNyBAQAogI2luY2x1ZGUgImk5MTVfZHJ2Lmgi
CiAjaW5jbHVkZSAiaTkxNV9nZW0uaCIKICNpbmNsdWRlICJpOTE1X2dlbV9pb2N0bHMuaCIKKyNp
bmNsdWRlICJpOTE1X2dlbV9tbWFuLmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1fb2JqZWN0LmgiCiAK
IC8qKgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1
X2dlbV9tbWFuLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2Vt
X21tYW4uYwppbmRleCA5ZjFhNjkwMjdhMDQuLjZjMjMzM2M2MTQ2OSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKQEAgLTU2NCwx
NSArNTY0LDIwIEBAIHN0YXRpYyBib29sIGFzc2VydF9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCSAgICAgICBpbnQgZXhwZWN0ZWQpCiB7CiAJc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwkvKiBPd25lcnNoaXAgdHJhbnNmZXJyZWQgdG8gcGFy
ZW50IGdlbSBvYmplY3QgaW4gY3JlYXRlX21tYXBfb2Zmc2V0ICovCisJc3RydWN0IGk5MTVfbW1h
cF9vZmZzZXQgKm1tbyA9IGt6YWxsb2Moc2l6ZW9mKCptbW8pLCBHRlBfS0VSTkVMKTsKIAlpbnQg
ZXJyOwogCiAJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1LCBzaXpl
KTsKIAlpZiAoSVNfRVJSKG9iaikpCiAJCXJldHVybiBQVFJfRVJSKG9iaik7CiAKLQllcnIgPSBj
cmVhdGVfbW1hcF9vZmZzZXQob2JqKTsKKwllcnIgPSBjcmVhdGVfbW1hcF9vZmZzZXQob2JqLCBt
bW8pOworCWlmIChlcnIpCisJCWtmcmVlKG1tbyk7CiAJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmop
OwogCisKIAlyZXR1cm4gZXJyID09IGV4cGVjdGVkOwogfQogCkBAIC02MDgsNiArNjEzLDggQEAg
c3RhdGljIGludCBpZ3RfbW1hcF9vZmZzZXRfZXhoYXVzdGlvbih2b2lkICphcmcpCiAJc3RydWN0
IGRybV9tbSAqbW0gPSAmaTkxNS0+ZHJtLnZtYV9vZmZzZXRfbWFuYWdlci0+dm1fYWRkcl9zcGFj
ZV9tbTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwogCXN0cnVjdCBkcm1fbW1f
bm9kZSAqaG9sZSwgKm5leHQ7CisJLyogT3duZXJzaGlwIHRyYW5zZmVycmVkIHRvIHBhcmVudCBn
ZW0gb2JqZWN0IGluIGNyZWF0ZV9tbWFwX29mZnNldCAqLworCXN0cnVjdCBpOTE1X21tYXBfb2Zm
c2V0ICptbW8gPSBremFsbG9jKHNpemVvZigqbW1vKSwgR0ZQX0tFUk5FTCk7CiAJaW50IGxvb3As
IGVycjsKIAogCS8qIERpc2FibGUgYmFja2dyb3VuZCByZWFwZXIgKi8KQEAgLTY3Miw5ICs2Nzks
MTAgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9vZmZzZXRfZXhoYXVzdGlvbih2b2lkICphcmcpCiAJ
CWdvdG8gb3V0OwogCX0KIAotCWVyciA9IGNyZWF0ZV9tbWFwX29mZnNldChvYmopOworCWVyciA9
IGNyZWF0ZV9tbWFwX29mZnNldChvYmosIG1tbyk7CiAJaWYgKGVycikgewogCQlwcl9lcnIoIlVu
YWJsZSB0byBpbnNlcnQgb2JqZWN0IGludG8gcmVjbGFpbWVkIGhvbGVcbiIpOworCQlrZnJlZSht
bW8pOwogCQlnb3RvIGVycl9vYmo7CiAJfQogCkBAIC03MjgsNiArNzM2LDggQEAgc3RhdGljIGlu
dCBpZ3RfbW1hcF9ndHQodm9pZCAqYXJnKQogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gYXJnOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CiAJc3RydWN0IHZtX2Fy
ZWFfc3RydWN0ICphcmVhOworCS8qIE93bmVyc2hpcCB0cmFuc2ZlcnJlZCB0byBwYXJlbnQgZ2Vt
IG9iamVjdCBpbiBjcmVhdGVfbW1hcF9vZmZzZXQgKi8KKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNl
dCAqbW1vID0ga3phbGxvYyhzaXplb2YoKm1tbyksIEdGUF9LRVJORUwpOwogCXVuc2lnbmVkIGxv
bmcgYWRkcjsKIAl2b2lkICp2YWRkcjsKIAlpbnQgZXJyLCBpOwpAQCAtNzQ4LDcgKzc1OCw3IEBA
IHN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0KHZvaWQgKmFyZykKIAlpOTE1X2dlbV9vYmplY3RfZmx1
c2hfbWFwKG9iaik7CiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChvYmopOwogCi0JZXJyID0g
Y3JlYXRlX21tYXBfb2Zmc2V0KG9iaik7CisJZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9iaiwg
bW1vKTsKIAlpZiAoZXJyKQogCQlnb3RvIG91dDsKIApAQCAtODc2LDYgKzg4Niw4IEBAIHN0YXRp
YyBpbnQgaWd0X21tYXBfZ3R0X3Jldm9rZSh2b2lkICphcmcpCiB7CiAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBhcmc7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsK
KwkvKiBPd25lcnNoaXAgdHJhbnNmZXJyZWQgdG8gcGFyZW50IGdlbSBvYmplY3QgaW4gY3JlYXRl
X21tYXBfb2Zmc2V0ICovCisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbyA9IGt6YWxsb2Mo
c2l6ZW9mKCptbW8pLCBHRlBfS0VSTkVMKTsKIAl1bnNpZ25lZCBsb25nIGFkZHI7CiAJaW50IGVy
cjsKIApAQCAtODg2LDcgKzg5OCw3IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0X3Jldm9rZSh2
b2lkICphcmcpCiAJaWYgKElTX0VSUihvYmopKQogCQlyZXR1cm4gUFRSX0VSUihvYmopOwogCi0J
ZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9iaik7CisJZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0
KG9iaiwgbW1vKTsKIAlpZiAoZXJyKQogCQlnb3RvIG91dDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3Jlc2V0LmMKaW5kZXggYjcwMDdjZDc4YzZmLi43NzdlYWE0ODM2NzYgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwpAQCAtNjc4LDggKzY3OCwxMyBAQCBzdGF0aWMg
dm9pZCByZXZva2VfbW1hcHMoc3RydWN0IGludGVsX2d0ICpndCkKIAkJCWNvbnRpbnVlOwogCiAJ
CUdFTV9CVUdfT04odm1hLT5mZW5jZSAhPSAmZ3QtPmdndHQtPmZlbmNlX3JlZ3NbaV0pOwotCQlu
b2RlID0gJnZtYS0+b2JqLT5iYXNlLnZtYV9ub2RlOworCisJCWlmICghdm1hLT5tbW8pCisJCQlj
b250aW51ZTsKKworCQlub2RlID0gJnZtYS0+bW1vLT52bWFfbm9kZTsKIAkJdm1hX29mZnNldCA9
IHZtYS0+Z2d0dF92aWV3LnBhcnRpYWwub2Zmc2V0IDw8IFBBR0VfU0hJRlQ7CisKIAkJdW5tYXBf
bWFwcGluZ19yYW5nZShndC0+aTkxNS0+ZHJtLmFub25faW5vZGUtPmlfbWFwcGluZywKIAkJCQkg
ICAgZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKG5vZGUpICsgdm1hX29mZnNldCwKIAkJCQkgICAg
dm1hLT5zaXplLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKaW5kZXggOGQ3MDQ5NzkyZDYyLi4zZTEy
OWJjZjhhMTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwpAQCAtNjEsNiArNjEsNyBAQAogCiAj
aW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1f
aW9jdGxzLmgiCisjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX21tYW4uaCIKICNpbmNsdWRlICJndC9p
bnRlbF9ndC5oIgogI2luY2x1ZGUgImd0L2ludGVsX2d0X3BtLmgiCiAjaW5jbHVkZSAiZ3QvaW50
ZWxfcmM2LmgiCkBAIC0yNjYyLDE4ICsyNjYzLDEyIEBAIGNvbnN0IHN0cnVjdCBkZXZfcG1fb3Bz
IGk5MTVfcG1fb3BzID0gewogCS5ydW50aW1lX3Jlc3VtZSA9IGludGVsX3J1bnRpbWVfcmVzdW1l
LAogfTsKIAotc3RhdGljIGNvbnN0IHN0cnVjdCB2bV9vcGVyYXRpb25zX3N0cnVjdCBpOTE1X2dl
bV92bV9vcHMgPSB7Ci0JLmZhdWx0ID0gaTkxNV9nZW1fZmF1bHQsCi0JLm9wZW4gPSBkcm1fZ2Vt
X3ZtX29wZW4sCi0JLmNsb3NlID0gZHJtX2dlbV92bV9jbG9zZSwKLX07Ci0KIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGk5MTVfZHJpdmVyX2ZvcHMgPSB7CiAJLm93bmVyID0g
VEhJU19NT0RVTEUsCiAJLm9wZW4gPSBkcm1fb3BlbiwKIAkucmVsZWFzZSA9IGRybV9yZWxlYXNl
LAogCS51bmxvY2tlZF9pb2N0bCA9IGRybV9pb2N0bCwKLQkubW1hcCA9IGRybV9nZW1fbW1hcCwK
KwkubW1hcCA9IGk5MTVfZ2VtX21tYXAsCiAJLnBvbGwgPSBkcm1fcG9sbCwKIAkucmVhZCA9IGRy
bV9yZWFkLAogCS5jb21wYXRfaW9jdGwgPSBpOTE1X2NvbXBhdF9pb2N0bCwKQEAgLTI3NjIsNyAr
Mjc1Nyw2IEBAIHN0YXRpYyBzdHJ1Y3QgZHJtX2RyaXZlciBkcml2ZXIgPSB7CiAKIAkuZ2VtX2Ns
b3NlX29iamVjdCA9IGk5MTVfZ2VtX2Nsb3NlX29iamVjdCwKIAkuZ2VtX2ZyZWVfb2JqZWN0X3Vu
bG9ja2VkID0gaTkxNV9nZW1fZnJlZV9vYmplY3QsCi0JLmdlbV92bV9vcHMgPSAmaTkxNV9nZW1f
dm1fb3BzLAogCiAJLnByaW1lX2hhbmRsZV90b19mZCA9IGRybV9nZW1fcHJpbWVfaGFuZGxlX3Rv
X2ZkLAogCS5wcmltZV9mZF90b19oYW5kbGUgPSBkcm1fZ2VtX3ByaW1lX2ZkX3RvX2hhbmRsZSwK
QEAgLTI3NzMsNyArMjc2Nyw2IEBAIHN0YXRpYyBzdHJ1Y3QgZHJtX2RyaXZlciBkcml2ZXIgPSB7
CiAJLmdldF9zY2Fub3V0X3Bvc2l0aW9uID0gaTkxNV9nZXRfY3J0Y19zY2Fub3V0cG9zLAogCiAJ
LmR1bWJfY3JlYXRlID0gaTkxNV9nZW1fZHVtYl9jcmVhdGUsCi0JLmR1bWJfbWFwX29mZnNldCA9
IGk5MTVfZ2VtX21tYXBfZ3R0LAogCS5pb2N0bHMgPSBpOTE1X2lvY3RscywKIAkubnVtX2lvY3Rs
cyA9IEFSUkFZX1NJWkUoaTkxNV9pb2N0bHMpLAogCS5mb3BzID0gJmk5MTVfZHJpdmVyX2ZvcHMs
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRleCBiYmY0ZGZkZmE4YmEuLmEzNmMyNzc4YzA5YyAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBAIC0xODUzLDggKzE4NTMsNiBAQCBpOTE1X211dGV4
X2xvY2tfaW50ZXJydXB0aWJsZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogaW50IGk5MTVfZ2Vt
X2R1bWJfY3JlYXRlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2LAogCQkJIHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYsCiAJCQkgc3RydWN0IGRybV9tb2RlX2NyZWF0ZV9kdW1iICphcmdzKTsKLWlu
dCBpOTE1X2dlbV9tbWFwX2d0dChzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwgc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwKLQkJICAgICAgdTMyIGhhbmRsZSwgdTY0ICpvZmZzZXQpOwogaW50IGk5
MTVfZ2VtX21tYXBfZ3R0X3ZlcnNpb24odm9pZCk7CiAKIGludCBfX211c3RfY2hlY2sgaTkxNV9n
ZW1fc2V0X2dsb2JhbF9zZXFubyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB1MzIgc2Vxbm8pOwpA
QCAtMTg3OCw3ICsxODc2LDYgQEAgdm9pZCBpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBpOTE1X2dlbV9zdXNwZW5kKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiB2b2lkIGk5MTVfZ2VtX3N1c3BlbmRfbGF0
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBpOTE1X2dlbV9yZXN1
bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZtX2ZhdWx0X3QgaTkxNV9n
ZW1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpOwogCiBpbnQgaTkxNV9nZW1fb3BlbihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IGRybV9maWxlICpmaWxlKTsKIHZvaWQg
aTkxNV9nZW1fcmVsZWFzZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2ZpbGUg
KmZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKaW5kZXggMWJhNWYyNjcwMGIwLi5jYTRkNGUw
MTJhNjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwpAQCAtNDQsNiArNDQsNyBAQAogI2luY2x1
ZGUgImdlbS9pOTE1X2dlbV9jbGZsdXNoLmgiCiAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2NvbnRl
eHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1faW9jdGxzLmgiCisjaW5jbHVkZSAiZ2VtL2k5
MTVfZ2VtX21tYW4uaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fcG0uaCIKICNpbmNsdWRlICJn
dC9pbnRlbF9lbmdpbmVfdXNlci5oIgogI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCkBAIC04NTQs
NyArODU1LDcgQEAgdm9pZCBpOTE1X2dlbV9ydW50aW1lX3N1c3BlbmQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCiAKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUob2JqLCBvbiwKIAkJ
CQkgJmk5MTUtPmdndHQudXNlcmZhdWx0X2xpc3QsIHVzZXJmYXVsdF9saW5rKQotCQlfX2k5MTVf
Z2VtX29iamVjdF9yZWxlYXNlX21tYXAob2JqKTsKKwkJX19pOTE1X2dlbV9vYmplY3RfcmVsZWFz
ZV9tbWFwX2d0dChvYmopOwogCiAJLyoKIAkgKiBUaGUgZmVuY2Ugd2lsbCBiZSBsb3N0IHdoZW4g
dGhlIGRldmljZSBwb3dlcnMgZG93bi4gSWYgYW55IHdlcmUKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2V0cGFyYW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2V0cGFyYW0uYwppbmRleCBjZjhhOGMzZWYwNDcuLjU0ZmNlODFkNTcyNCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2V0cGFyYW0uYwpAQCAtMiw2ICsyLDcgQEAKICAqIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBNSVQKICAqLwogCisjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX21tYW4uaCIKICNp
bmNsdWRlICJndC9pbnRlbF9lbmdpbmVfdXNlci5oIgogCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3ZtYS5jCmluZGV4IGU1NTEyZjI2ZTIwYS4uNTEwOGRjYjJlNWIxIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKQEAgLTEwNTQsNyArMTA1NCw3IEBAIHN0YXRpYyB2b2lk
IF9faTkxNV92bWFfaW91bm1hcChzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKIAogdm9pZCBpOTE1X3Zt
YV9yZXZva2VfbW1hcChzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKIHsKLQlzdHJ1Y3QgZHJtX3ZtYV9v
ZmZzZXRfbm9kZSAqbm9kZSA9ICZ2bWEtPm9iai0+YmFzZS52bWFfbm9kZTsKKwlzdHJ1Y3QgZHJt
X3ZtYV9vZmZzZXRfbm9kZSAqbm9kZTsKIAl1NjQgdm1hX29mZnNldDsKIAogCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJnZtYS0+dm0tPm11dGV4KTsKQEAgLTEwNjUsNiArMTA2NSw3IEBAIHZvaWQgaTkx
NV92bWFfcmV2b2tlX21tYXAoc3RydWN0IGk5MTVfdm1hICp2bWEpCiAJR0VNX0JVR19PTighaTkx
NV92bWFfaXNfbWFwX2FuZF9mZW5jZWFibGUodm1hKSk7CiAJR0VNX0JVR19PTighdm1hLT5vYmot
PnVzZXJmYXVsdF9jb3VudCk7CiAKKwlub2RlID0gJnZtYS0+bW1vLT52bWFfbm9kZTsKIAl2bWFf
b2Zmc2V0ID0gdm1hLT5nZ3R0X3ZpZXcucGFydGlhbC5vZmZzZXQgPDwgUEFHRV9TSElGVDsKIAl1
bm1hcF9tYXBwaW5nX3JhbmdlKHZtYS0+dm0tPmk5MTUtPmRybS5hbm9uX2lub2RlLT5pX21hcHBp
bmcsCiAJCQkgICAgZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKG5vZGUpICsgdm1hX29mZnNldCwK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3ZtYS5oCmluZGV4IDQ2NTkzMjgxM2JjNS4uZjA5ZjRmNTEzYzQxIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfdm1hLmgKQEAgLTYzLDYgKzYzLDkgQEAgc3RydWN0IGk5MTVfdm1h
IHsKIAl1NjQgZGlzcGxheV9hbGlnbm1lbnQ7CiAJc3RydWN0IGk5MTVfcGFnZV9zaXplcyBwYWdl
X3NpemVzOwogCisJLyogbW1hcC1vZmZzZXQgYXNzb2NpYXRlZCB3aXRoIGZlbmNpbmcgZm9yIHRo
aXMgdm1hICovCisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQJKm1tbzsKKwogCXUzMiBmZW5jZV9z
aXplOwogCXUzMiBmZW5jZV9hbGlnbm1lbnQ7CiAKLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJ
bnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Au
b3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

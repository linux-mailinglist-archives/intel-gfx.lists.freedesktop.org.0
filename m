Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 4093CC03DB
	for <lists+intel-gfx@lfdr.de>; Fri, 27 Sep 2019 13:09:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9A1976EE6D;
	Fri, 27 Sep 2019 11:08:59 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 579506EE6D
 for <intel-gfx@lists.freedesktop.org>; Fri, 27 Sep 2019 11:08:58 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18638205-1500050 
 for <intel-gfx@lists.freedesktop.org>; Fri, 27 Sep 2019 12:08:57 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 27 Sep 2019 12:08:49 +0100
Message-Id: <20190927110849.28734-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915: Extract GT render sleep (rc6) management
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+CgpDb250aW51aW5nIHRoZSB0
aGVtZSBvZiBicmVha2luZyBpbnRlbF9wbS5jIHVwIGluIGEgcmVhc29uYWJsZSBjaHVuayBvZgpw
b3dlcm1hbmFnZW1lbnQgdXRpbGl0aWVzLCBwdWxsIG91dCB0aGUgcmM2IHNldHVwIGludG8gaXRz
IEdUIGhhbmRsZXIuCgpCYXNlZCBvbiBhIHBhdGNoIGJ5IENocmlzIFdpbHNvbi4KClNpZ25lZC1v
ZmYtYnk6IEFuZGkgU2h5dGkgPGFuZGkuc2h5dGlAaW50ZWwuY29tPgpDYzogQ2hyaXMgV2lsc29u
IDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+ClJldmlld2VkLWJ5OiBDaHJpcyBXaWxzb24gPGNo
cmlzQGNocmlzLXdpbHNvbi5jby51az4KU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJp
c0BjaHJpcy13aWxzb24uY28udWs+Ckxpbms6IGh0dHBzOi8vcGF0Y2h3b3JrLmZyZWVkZXNrdG9w
Lm9yZy9wYXRjaC9tc2dpZC8yMDE5MDkxOTE0Mzg0MC4yMDM4NC0xLWFuZGkuc2h5dGlAaW50ZWwu
Y29tCi0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgICAgICAgICAgICAgICAgIHwg
ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jICAgICAgICB8ICAg
MiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgICAgIHwgICAx
ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMgICAgICAgICAgICB8ICAgNSAr
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYyAgICAgICAgIHwgIDkyICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5oICAgICAgICAgfCAgMTEgKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmggICAgICB8ICAgMyArCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yYzYuYyAgICAgICAgICAgfCA3MTMgKysrKysr
KysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2LmggICAgICAgICAg
IHwgIDI1ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNl90eXBlcy5oICAgICB8
ICAyOCArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9ndF9wbS5jICAgICAgfCAg
NTAgKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8ICAx
MSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCAgICAgICAgICAgICAgIHwgICA3
IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMgICAgICAgICAgICAgICB8ICAgOSAr
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jICAgICAgICAgICAgIHwgICA0ICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jICAgICAgICAgICAgICAgfCA3OTQgKy0t
LS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oICAgICAgICAg
ICAgICAgfCAgIDMgLQogLi4uL2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2xpdmVfc2VsZnRlc3Rz
LmggIHwgICAxICsKIDE4IGZpbGVzIGNoYW5nZWQsIDkxNyBpbnNlcnRpb25zKCspLCA4NDMgZGVs
ZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfcmM2LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9yYzYuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X3JjNl90eXBlcy5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfZ3RfcG0uYwoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2Vm
aWxlIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKaW5kZXggNjMxM2U3YjRiZDc4Li44
ZDQwN2ZmN2Q1OWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCkBAIC04NSw2ICs4NSw3IEBAIGd0LXkg
Kz0gXAogCWd0L2ludGVsX2d0X3BtX2lycS5vIFwKIAlndC9pbnRlbF9oYW5nY2hlY2subyBcCiAJ
Z3QvaW50ZWxfbHJjLm8gXAorCWd0L2ludGVsX3JjNi5vIFwKIAlndC9pbnRlbF9yZW5kZXJzdGF0
ZS5vIFwKIAlndC9pbnRlbF9yZXNldC5vIFwKIAlndC9pbnRlbF9yaW5nYnVmZmVyLm8gXApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYwppbmRleCBhMTFhZDRkOTE0Y2EuLmNjYTE5
MmVjZmY4YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Bt
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKQEAgLTEzNyw3
ICsxMzcsNiBAQCBzdGF0aWMgYm9vbCBzd2l0Y2hfdG9fa2VybmVsX2NvbnRleHRfc3luYyhzdHJ1
Y3QgaW50ZWxfZ3QgKmd0KQogCiBib29sIGk5MTVfZ2VtX2xvYWRfcG93ZXJfY29udGV4dChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKLQlpbnRlbF9ndF9wbV9lbmFibGUoJmk5MTUt
Pmd0KTsKIAlyZXR1cm4gc3dpdGNoX3RvX2tlcm5lbF9jb250ZXh0X3N5bmMoJmk5MTUtPmd0KTsK
IH0KIApAQCAtMTg4LDYgKzE4Nyw3IEBAIHZvaWQgaTkxNV9nZW1fc3VzcGVuZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGk5MTUp
OwogCiAJaW50ZWxfdWNfc3VzcGVuZCgmaTkxNS0+Z3QudWMpOworCWludGVsX2d0X3N1c3BlbmQo
Jmk5MTUtPmd0KTsKIH0KIAogc3RhdGljIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpmaXJz
dF9tbV9vYmplY3Qoc3RydWN0IGxpc3RfaGVhZCAqbGlzdCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX3BtLmMKaW5kZXggY2U2MWM4M2Q2OGU5Li42NmZjNDliNzZlYTggMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCkBAIC0xMSw2ICsxMSw3
IEBACiAjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3Bvb2wuaCIKICNpbmNsdWRlICJpbnRlbF9ndC5o
IgogI2luY2x1ZGUgImludGVsX2d0X3BtLmgiCisjaW5jbHVkZSAiaW50ZWxfcmM2LmgiCiAKIHN0
YXRpYyBpbnQgX19lbmdpbmVfdW5wYXJrKHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIHsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jCmluZGV4IGVlZjliZGFlOGViYi4uMGU1OTA5ZWUwNjU3
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMKQEAgLTcsNiArNyw3IEBACiAjaW5jbHVk
ZSAiaW50ZWxfZ3QuaCIKICNpbmNsdWRlICJpbnRlbF9ndF9wbS5oIgogI2luY2x1ZGUgImludGVs
X21vY3MuaCIKKyNpbmNsdWRlICJpbnRlbF9yYzYuaCIKICNpbmNsdWRlICJpbnRlbF91bmNvcmUu
aCIKICNpbmNsdWRlICJpbnRlbF9wbS5oIgogCkBAIC0zNjksNiArMzcwLDggQEAgaW50IGludGVs
X2d0X2luaXQoc3RydWN0IGludGVsX2d0ICpndCkKIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJyOwog
CisJaW50ZWxfZ3RfcG1faW5pdChndCk7CisKIAlyZXR1cm4gMDsKIH0KIApAQCAtMzg3LDggKzM5
MCw4IEBAIHZvaWQgaW50ZWxfZ3RfZHJpdmVyX3JlbGVhc2Uoc3RydWN0IGludGVsX2d0ICpndCkK
IHsKIAkvKiBQYXJhbm9pYTogbWFrZSBzdXJlIHdlIGhhdmUgZGlzYWJsZWQgZXZlcnl0aGluZyBi
ZWZvcmUgd2UgZXhpdC4gKi8KIAlpbnRlbF9ndF9wbV9kaXNhYmxlKGd0KTsKKwlpbnRlbF9ndF9w
bV9maW5pKGd0KTsKIAotCWludGVsX2NsZWFudXBfZ3RfcG93ZXJzYXZlKGd0LT5pOTE1KTsKIAlp
bnRlbF9ndF9maW5pX3NjcmF0Y2goZ3QpOwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
Z3RfcG0uYwppbmRleCAyY2NmOGNhY2FhMGEuLjQyZjE3NWQ5Yjk4YyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9ndF9wbS5jCkBAIC0xMSw2ICsxMSw3IEBACiAjaW5jbHVkZSAiaW50ZWxf
Z3QuaCIKICNpbmNsdWRlICJpbnRlbF9ndF9wbS5oIgogI2luY2x1ZGUgImludGVsX3BtLmgiCisj
aW5jbHVkZSAiaW50ZWxfcmM2LmgiCiAjaW5jbHVkZSAiaW50ZWxfd2FrZXJlZi5oIgogCiBzdGF0
aWMgdm9pZCBwbV9ub3RpZnkoc3RydWN0IGludGVsX2d0ICpndCwgaW50IHN0YXRlKQpAQCAtOTAs
NiArOTEsMTYgQEAgdm9pZCBpbnRlbF9ndF9wbV9pbml0X2Vhcmx5KHN0cnVjdCBpbnRlbF9ndCAq
Z3QpCiAJQkxPQ0tJTkdfSU5JVF9OT1RJRklFUl9IRUFEKCZndC0+cG1fbm90aWZpY2F0aW9ucyk7
CiB9CiAKK3ZvaWQgaW50ZWxfZ3RfcG1faW5pdChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCS8q
CisJICogRW5hYmxpbmcgcG93ZXItbWFuYWdlbWVudCBzaG91bGQgYmUgInNlbGYtaGVhbGluZyIu
IElmIHdlIGNhbm5vdAorCSAqIGVuYWJsZSBhIGZlYXR1cmUsIHNpbXBseSBsZWF2ZSBpdCBkaXNh
YmxlZCB3aXRoIGEgbm90aWNlIHRvIHRoZQorCSAqIHVzZXIuCisJICovCisJaW50ZWxfcmM2X2lu
aXQoJmd0LT5yYzYpOworfQorCiBzdGF0aWMgYm9vbCByZXNldF9lbmdpbmVzKHN0cnVjdCBpbnRl
bF9ndCAqZ3QpCiB7CiAJaWYgKElOVEVMX0lORk8oZ3QtPmk5MTUpLT5ncHVfcmVzZXRfY2xvYmJl
cnNfZGlzcGxheSkKQEAgLTEyNCw0MCArMTM1LDE0IEBAIHZvaWQgaW50ZWxfZ3Rfc2FuaXRpemUo
c3RydWN0IGludGVsX2d0ICpndCwgYm9vbCBmb3JjZSkKIAkJX19pbnRlbF9lbmdpbmVfcmVzZXQo
ZW5naW5lLCBmYWxzZSk7CiB9CiAKLXN0YXRpYyBib29sIGlzX21vY2tfZGV2aWNlKGNvbnN0IHN0
cnVjdCBpbnRlbF9ndCAqZ3QpCi17Ci0JcmV0dXJuIEk5MTVfU0VMRlRFU1RfT05MWShndC0+YXdh
a2UgPT0gLTEpOwotfQotCi12b2lkIGludGVsX2d0X3BtX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0KQordm9pZCBpbnRlbF9ndF9wbV9kaXNhYmxlKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7Ci0J
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlk
OwotCi0JLyogUG93ZXJzYXZpbmcgaXMgY29udHJvbGxlZCBieSB0aGUgaG9zdCB3aGVuIGluc2lk
ZSBhIFZNICovCi0JaWYgKGludGVsX3ZncHVfYWN0aXZlKGd0LT5pOTE1KSkKLQkJcmV0dXJuOwot
Ci0JaWYgKGlzX21vY2tfZGV2aWNlKGd0KSkKLQkJcmV0dXJuOwotCi0JaW50ZWxfZ3RfcG1fZ2V0
KGd0KTsKLQotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1LCBpZCkgewotCQlpbnRl
bF9lbmdpbmVfcG1fZ2V0KGVuZ2luZSk7Ci0JCWVuZ2luZS0+c2VyaWFsKys7IC8qIGZvcmNlIGtl
cm5lbCBjb250ZXh0IHJlbG9hZCAqLwotCQlpbnRlbF9lbmdpbmVfcG1fcHV0KGVuZ2luZSk7Ci0J
fQotCi0JaW50ZWxfZ3RfcG1fcHV0KGd0KTsKKwlpbnRlbF9zYW5pdGl6ZV9ndF9wb3dlcnNhdmUo
Z3QtPmk5MTUpOwogfQogCi12b2lkIGludGVsX2d0X3BtX2Rpc2FibGUoc3RydWN0IGludGVsX2d0
ICpndCkKK3ZvaWQgaW50ZWxfZ3RfcG1fZmluaShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewotCWlm
IChpc19tb2NrX2RldmljZShndCkpCi0JCXJldHVybjsKLQotCWludGVsX3Nhbml0aXplX2d0X3Bv
d2Vyc2F2ZShndC0+aTkxNSk7CisJaW50ZWxfcmM2X2ZpbmkoJmd0LT5yYzYpOwogfQogCiBpbnQg
aW50ZWxfZ3RfcmVzdW1lKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCkBAIC0xNzMsNiArMTU4LDkgQEAg
aW50IGludGVsX2d0X3Jlc3VtZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCSAqIGFsbG93aW5nIHVz
IHRvIGZpeHVwIHRoZSB1c2VyIGNvbnRleHRzIG9uIHRoZWlyIGZpcnN0IHBpbi4KIAkgKi8KIAlp
bnRlbF9ndF9wbV9nZXQoZ3QpOworCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KGd0LT51bmNv
cmUsIEZPUkNFV0FLRV9BTEwpOworCWludGVsX3JjNl9zYW5pdGl6ZSgmZ3QtPnJjNik7CisKIAlm
b3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndC0+aTkxNSwgaWQpIHsKIAkJc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlOwogCkBAIC0xOTcsMTEgKzE4NSw1MSBAQCBpbnQgaW50ZWxfZ3RfcmVzdW1lKHN0
cnVjdCBpbnRlbF9ndCAqZ3QpCiAJCQlicmVhazsKIAkJfQogCX0KKworCWludGVsX3JjNl9lbmFi
bGUoJmd0LT5yYzYpOworCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KGd0LT51bmNvcmUsIEZP
UkNFV0FLRV9BTEwpOwogCWludGVsX2d0X3BtX3B1dChndCk7CiAKIAlyZXR1cm4gZXJyOwogfQog
CitzdGF0aWMgdm9pZCB3YWl0X2Zvcl9pZGxlKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7CisJbXV0
ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOyAvKiBYWFggKi8KKwlkbyB7CisJ
CWlmIChpOTE1X2dlbV93YWl0X2Zvcl9pZGxlKGd0LT5pOTE1LAorCQkJCQkgICBJOTE1X1dBSVRf
TE9DS0VELAorCQkJCQkgICBJOTE1X0dFTV9JRExFX1RJTUVPVVQpID09IC1FVElNRSkgeworCQkJ
LyogWFhYIGhpZGUgd2FybmluZyBmcm9tIGdlbV9laW8gKi8KKwkJCWlmIChpOTE1X21vZHBhcmFt
cy5yZXNldCkgeworCQkJCWRldl9lcnIoZ3QtPmk5MTUtPmRybS5kZXYsCisJCQkJCSJGYWlsZWQg
dG8gaWRsZSBlbmdpbmVzLCBkZWNsYXJpbmcgd2VkZ2VkIVxuIik7CisJCQkJR0VNX1RSQUNFX0RV
TVAoKTsKKwkJCX0KKworCQkJLyoKKwkJCSAqIEZvcmNpYmx5IGNhbmNlbCBvdXRzdGFuZGluZyB3
b3JrIGFuZCBsZWF2ZQorCQkJICogdGhlIGdwdSBxdWlldC4KKwkJCSAqLworCQkJaW50ZWxfZ3Rf
c2V0X3dlZGdlZChndCk7CisJCX0KKwl9IHdoaWxlIChpOTE1X3JldGlyZV9yZXF1ZXN0cyhndC0+
aTkxNSkpOworCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCisJ
aW50ZWxfZ3RfcG1fd2FpdF9mb3JfaWRsZShndCk7Cit9CisKK3ZvaWQgaW50ZWxfZ3Rfc3VzcGVu
ZChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQoreworCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOworCisJ
LyogV2UgZXhwZWN0IHRvIGJlIGlkbGUgYWxyZWFkeTsgYnV0IGFsc28gd2FudCB0byBiZSBpbmRl
cGVuZGVudCAqLworCXdhaXRfZm9yX2lkbGUoZ3QpOworCisJd2l0aF9pbnRlbF9ydW50aW1lX3Bt
KCZndC0+aTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZikKKwkJaW50ZWxfcmM2X2Rpc2FibGUoJmd0
LT5yYzYpOworfQorCiB2b2lkIGludGVsX2d0X3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgaW50ZWxf
Z3QgKmd0KQogewogCWludGVsX3VjX3J1bnRpbWVfc3VzcGVuZCgmZ3QtPnVjKTsKQEAgLTIxMywz
ICsyNDEsNyBAQCBpbnQgaW50ZWxfZ3RfcnVudGltZV9yZXN1bWUoc3RydWN0IGludGVsX2d0ICpn
dCkKIAogCXJldHVybiBpbnRlbF91Y19ydW50aW1lX3Jlc3VtZSgmZ3QtPnVjKTsKIH0KKworI2lm
IElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQorI2luY2x1ZGUgInNlbGZ0ZXN0
X2d0X3BtLmMiCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2d0X3BtLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5oCmluZGV4
IGQxZjNlMmUyMzkzNy4uYWI3OTRlODUzMzU2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9ndF9wbS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0X3BtLmgKQEAgLTQzLDEyICs0MywyMSBAQCBzdGF0aWMgaW5saW5lIGludCBpbnRlbF9ndF9w
bV93YWl0X2Zvcl9pZGxlKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB9CiAKIHZvaWQgaW50ZWxfZ3Rf
cG1faW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKLXZvaWQgaW50ZWxfZ3RfcG1fZW5h
YmxlKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBpbnRlbF9ndF9wbV9pbml0KHN0cnVjdCBp
bnRlbF9ndCAqZ3QpOwogdm9pZCBpbnRlbF9ndF9wbV9kaXNhYmxlKHN0cnVjdCBpbnRlbF9ndCAq
Z3QpOwordm9pZCBpbnRlbF9ndF9wbV9maW5pKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwogCiB2b2lk
IGludGVsX2d0X3Nhbml0aXplKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGJvb2wgZm9yY2UpOworCiBp
bnQgaW50ZWxfZ3RfcmVzdW1lKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBpbnRlbF9ndF9z
dXNwZW5kKHN0cnVjdCBpbnRlbF9ndCAqZ3QpOworCiB2b2lkIGludGVsX2d0X3J1bnRpbWVfc3Vz
cGVuZChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIGludCBpbnRlbF9ndF9ydW50aW1lX3Jlc3VtZShz
dHJ1Y3QgaW50ZWxfZ3QgKmd0KTsKIAorc3RhdGljIGlubGluZSBib29sIGlzX21vY2tfZ3QoY29u
c3Qgc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlyZXR1cm4gSTkxNV9TRUxGVEVTVF9PTkxZKGd0
LT5hd2FrZSA9PSAtMSk7Cit9CisKICNlbmRpZiAvKiBJTlRFTF9HVF9QTV9IICovCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaAppbmRleCBlNjRkYjRjMTNkZjYuLjcxMzRm
MTMxOWJiZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlw
ZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oCkBAIC0x
OCw2ICsxOCw3IEBACiAjaW5jbHVkZSAiaTkxNV92bWEuaCIKICNpbmNsdWRlICJpbnRlbF9lbmdp
bmVfdHlwZXMuaCIKICNpbmNsdWRlICJpbnRlbF9yZXNldF90eXBlcy5oIgorI2luY2x1ZGUgImlu
dGVsX3JjNl90eXBlcy5oIgogI2luY2x1ZGUgImludGVsX3dha2VyZWYuaCIKIAogc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGU7CkBAIC02Nyw2ICs2OCw4IEBAIHN0cnVjdCBpbnRlbF9ndCB7CiAJICov
CiAJaW50ZWxfd2FrZXJlZl90IGF3YWtlOwogCisJc3RydWN0IGludGVsX3JjNiByYzY7CisKIAlz
dHJ1Y3QgYmxvY2tpbmdfbm90aWZpZXJfaGVhZCBwbV9ub3RpZmljYXRpb25zOwogCiAJa3RpbWVf
dCBsYXN0X2luaXRfdGltZTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3JjNi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2LmMKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi42OTFmMGNmYzFmOTMKLS0tIC9kZXYvbnVs
bAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yYzYuYwpAQCAtMCwwICsxLDcx
MyBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQKKyAqCisgKiBDb3B5cmln
aHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpbmNsdWRlIDxsaW51eC9wbV9y
dW50aW1lLmg+CisKKyNpbmNsdWRlICJpOTE1X2Rydi5oIgorI2luY2x1ZGUgImludGVsX2d0Lmgi
CisjaW5jbHVkZSAiaW50ZWxfZ3RfcG0uaCIKKyNpbmNsdWRlICJpbnRlbF9yYzYuaCIKKyNpbmNs
dWRlICJpbnRlbF9zaWRlYmFuZC5oIgorCisvKioKKyAqIERPQzogUkM2CisgKgorICogUkM2IGlz
IGEgc3BlY2lhbCBwb3dlciBzdGFnZSB3aGljaCBhbGxvd3MgdGhlIEdQVSB0byBlbnRlciBhbiB2
ZXJ5CisgKiBsb3ctdm9sdGFnZSBtb2RlIHdoZW4gaWRsZSwgdXNpbmcgZG93biB0byAwViB3aGls
ZSBhdCB0aGlzIHN0YWdlLiAgVGhpcworICogc3RhZ2UgaXMgZW50ZXJlZCBhdXRvbWF0aWNhbGx5
IHdoZW4gdGhlIEdQVSBpcyBpZGxlIHdoZW4gUkM2IHN1cHBvcnQgaXMKKyAqIGVuYWJsZWQsIGFu
ZCBhcyBzb29uIGFzIG5ldyB3b3JrbG9hZCBhcmlzZXMgR1BVIHdha2VzIHVwIGF1dG9tYXRpY2Fs
bHkgYXMKKyAqIHdlbGwuCisgKgorICogVGhlcmUgYXJlIGRpZmZlcmVudCBSQzYgbW9kZXMgYXZh
aWxhYmxlIGluIEludGVsIEdQVSwgd2hpY2ggZGlmZmVyZW50aWF0ZQorICogYW1vbmcgZWFjaCBv
dGhlciB3aXRoIHRoZSBsYXRlbmN5IHJlcXVpcmVkIHRvIGVudGVyIGFuZCBsZWF2ZSBSQzYgYW5k
CisgKiB2b2x0YWdlIGNvbnN1bWVkIGJ5IHRoZSBHUFUgaW4gZGlmZmVyZW50IHN0YXRlcy4KKyAq
CisgKiBUaGUgY29tYmluYXRpb24gb2YgdGhlIGZvbGxvd2luZyBmbGFncyBkZWZpbmUgd2hpY2gg
c3RhdGVzIEdQVSBpcyBhbGxvd2VkCisgKiB0byBlbnRlciwgd2hpbGUgUkM2IGlzIHRoZSBub3Jt
YWwgUkM2IHN0YXRlLCBSQzZwIGlzIHRoZSBkZWVwIFJDNiwgYW5kCisgKiBSQzZwcCBpcyBkZWVw
ZXN0IFJDNi4gVGhlaXIgc3VwcG9ydCBieSBoYXJkd2FyZSB2YXJpZXMgYWNjb3JkaW5nIHRvIHRo
ZQorICogR1BVLCBCSU9TLCBjaGlwc2V0IGFuZCBwbGF0Zm9ybS4gUkM2IGlzIHVzdWFsbHkgdGhl
IHNhZmVzdCBvbmUgYW5kIHRoZSBvbmUKKyAqIHdoaWNoIGJyaW5ncyB0aGUgbW9zdCBwb3dlciBz
YXZpbmdzOyBkZWVwZXIgc3RhdGVzIHNhdmUgbW9yZSBwb3dlciwgYnV0CisgKiByZXF1aXJlIGhp
Z2hlciBsYXRlbmN5IHRvIHN3aXRjaCB0byBhbmQgd2FrZSB1cC4KKyAqLworCitzdGF0aWMgc3Ry
dWN0IGludGVsX2d0ICpyYzZfdG9fZ3Qoc3RydWN0IGludGVsX3JjNiAqcmM2KQoreworCXJldHVy
biBjb250YWluZXJfb2YocmM2LCBzdHJ1Y3QgaW50ZWxfZ3QsIHJjNik7Cit9CisKK3N0YXRpYyBz
dHJ1Y3QgaW50ZWxfdW5jb3JlICpyYzZfdG9fdW5jb3JlKHN0cnVjdCBpbnRlbF9yYzYgKnJjKQor
eworCXJldHVybiByYzZfdG9fZ3QocmMpLT51bmNvcmU7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqcmM2X3RvX2k5MTUoc3RydWN0IGludGVsX3JjNiAqcmMpCit7CisJcmV0
dXJuIHJjNl90b19ndChyYyktPmk5MTU7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBzZXQoc3Ry
dWN0IGludGVsX3VuY29yZSAqdW5jb3JlLCBpOTE1X3JlZ190IHJlZywgdTMyIHZhbCkKK3sKKwlp
bnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCByZWcsIHZhbCk7Cit9CisKK3N0YXRpYyB2b2lk
IGdlbjExX3JjNl9lbmFibGUoc3RydWN0IGludGVsX3JjNiAqcmM2KQoreworCXN0cnVjdCBpbnRl
bF91bmNvcmUgKnVuY29yZSA9IHJjNl90b191bmNvcmUocmM2KTsKKwlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisKKwkvKiAyYjogUHJv
Z3JhbSBSQzYgdGhyZXNob2xkcy4qLworCXNldCh1bmNvcmUsIEdFTjZfUkM2X1dBS0VfUkFURV9M
SU1JVCwgNTQgPDwgMTYgfCA4NSk7CisJc2V0KHVuY29yZSwgR0VOMTBfTUVESUFfV0FLRV9SQVRF
X0xJTUlULCAxNTApOworCisJc2V0KHVuY29yZSwgR0VONl9SQ19FVkFMVUFUSU9OX0lOVEVSVkFM
LCAxMjUwMDApOyAvKiAxMjUwMCAqIDEyODBucyAqLworCXNldCh1bmNvcmUsIEdFTjZfUkNfSURM
RV9IWVNURVJTSVMsIDI1KTsgLyogMjUgKiAxMjgwbnMgKi8KKwlmb3JfZWFjaF9lbmdpbmUoZW5n
aW5lLCByYzZfdG9fZ3QocmM2KS0+aTkxNSwgaWQpCisJCXNldCh1bmNvcmUsIFJJTkdfTUFYX0lE
TEUoZW5naW5lLT5tbWlvX2Jhc2UpLCAxMCk7CisKKwlzZXQodW5jb3JlLCBHVUNfTUFYX0lETEVf
Q09VTlQsIDB4QSk7CisKKwlzZXQodW5jb3JlLCBHRU42X1JDX1NMRUVQLCAwKTsKKworCXNldCh1
bmNvcmUsIEdFTjZfUkM2X1RIUkVTSE9MRCwgNTAwMDApOyAvKiA1MC8xMjVtcyBwZXIgRUkgKi8K
KworCS8qCisJICogMmM6IFByb2dyYW0gQ29hcnNlIFBvd2VyIEdhdGluZyBQb2xpY2llcy4KKwkg
KgorCSAqIEJzcGVjJ3MgZ3VpZGFuY2UgaXMgdG8gdXNlIDI1dXMgKHJlYWxseSAyNSAqIDEyODBu
cykgaGVyZS4gV2hhdCB3ZQorCSAqIHVzZSBpbnN0ZWFkIGlzIGEgbW9yZSBjb25zZXJ2YXRpdmUg
ZXN0aW1hdGUgZm9yIHRoZSBtYXhpbXVtIHRpbWUKKwkgKiBpdCB0YWtlcyB1cyB0byBzZXJ2aWNl
IGEgQ1MgaW50ZXJydXB0IGFuZCBzdWJtaXQgYSBuZXcgRUxTUCAtIHRoYXQKKwkgKiBpcyB0aGUg
dGltZSB3aGljaCB0aGUgR1BVIGlzIGlkbGUgd2FpdGluZyBmb3IgdGhlIENQVSB0byBzZWxlY3Qg
dGhlCisJICogbmV4dCByZXF1ZXN0IHRvIGV4ZWN1dGUuIElmIHRoZSBpZGxlIGh5c3RlcmVzaXMg
aXMgbGVzcyB0aGFuIHRoYXQKKwkgKiBpbnRlcnJ1cHQgc2VydmljZSBsYXRlbmN5LCB0aGUgaGFy
ZHdhcmUgd2lsbCBhdXRvbWF0aWNhbGx5IGdhdGUKKwkgKiB0aGUgcG93ZXIgd2VsbCBhbmQgd2Ug
d2lsbCB0aGVuIGluY3VyIHRoZSB3YWtlIHVwIGNvc3Qgb24gdG9wIG9mCisJICogdGhlIHNlcnZp
Y2UgbGF0ZW5jeS4gQSBzaW1pbGFyIGd1aWRlIGZyb20gcGxhbmVfc3RhdGUgaXMgdGhhdCB3ZQor
CSAqIGRvIG5vdCB3YW50IHRoZSBlbmFibGUgaHlzdGVyZXNpcyB0byBsZXNzIHRoYW4gdGhlIHdh
a2V1cCBsYXRlbmN5LgorCSAqCisJICogaWd0L2dlbV9leGVjX25vcC9zZXF1ZW50aWFsIHByb3Zp
ZGVzIGEgcm91Z2ggZXN0aW1hdGUgZm9yIHRoZQorCSAqIHNlcnZpY2UgbGF0ZW5jeSwgYW5kIHB1
dHMgaXQgYXJvdW5kIDEwdXMgZm9yIEJyb2Fkd2VsbCAoYW5kIG90aGVyCisJICogYmlnIGNvcmUp
IGFuZCBhcm91bmQgNDB1cyBmb3IgQnJveHRvbiAoYW5kIG90aGVyIGxvdyBwb3dlciBjb3Jlcyku
CisJICogW05vdGUgdGhhdCBmb3IgbGVnYWN5IHJpbmdidWZmZXIgc3VibWlzc2lvbiwgdGhpcyBp
cyBsZXNzIHRoYW4gMXVzIV0KKwkgKiBIb3dldmVyLCB0aGUgd2FrZXVwIGxhdGVuY3kgb24gQnJv
eHRvbiBpcyBjbG9zZXIgdG8gMTAwdXMuIFRvIGJlCisJICogY29uc2VydmF0aXZlLCB3ZSBoYXZl
IHRvIGZhY3RvciBpbiBhIGNvbnRleHQgc3dpdGNoIG9uIHRvcCAoZHVlCisJICogdG8ga3NvZnRp
cnFkKS4KKwkgKi8KKwlzZXQodW5jb3JlLCBHRU45X01FRElBX1BHX0lETEVfSFlTVEVSRVNJUywg
MjUwKTsKKwlzZXQodW5jb3JlLCBHRU45X1JFTkRFUl9QR19JRExFX0hZU1RFUkVTSVMsIDI1MCk7
CisKKwkvKiAzYTogRW5hYmxlIFJDNiAqLworCXNldCh1bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCwK
KwkgICAgR0VONl9SQ19DVExfSFdfRU5BQkxFIHwKKwkgICAgR0VONl9SQ19DVExfUkM2X0VOQUJM
RSB8CisJICAgIEdFTjZfUkNfQ1RMX0VJX01PREUoMSkpOworCisJc2V0KHVuY29yZSwgR0VOOV9Q
R19FTkFCTEUsCisJICAgIEdFTjlfUkVOREVSX1BHX0VOQUJMRSB8CisJICAgIEdFTjlfTUVESUFf
UEdfRU5BQkxFIHwKKwkgICAgR0VOMTFfTUVESUFfU0FNUExFUl9QR19FTkFCTEUpOworfQorCitz
dGF0aWMgdm9pZCBnZW45X3JjNl9lbmFibGUoc3RydWN0IGludGVsX3JjNiAqcmM2KQoreworCXN0
cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJjNl90b191bmNvcmUocmM2KTsKKwlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJdTMy
IHJjNl9tb2RlOworCisJLyogMmI6IFByb2dyYW0gUkM2IHRocmVzaG9sZHMuKi8KKwlpZiAoSU5U
RUxfR0VOKHJjNl90b19pOTE1KHJjNikpID49IDEwKSB7CisJCXNldCh1bmNvcmUsIEdFTjZfUkM2
X1dBS0VfUkFURV9MSU1JVCwgNTQgPDwgMTYgfCA4NSk7CisJCXNldCh1bmNvcmUsIEdFTjEwX01F
RElBX1dBS0VfUkFURV9MSU1JVCwgMTUwKTsKKwl9IGVsc2UgaWYgKElTX1NLWUxBS0UocmM2X3Rv
X2k5MTUocmM2KSkpIHsKKwkJLyoKKwkJICogV2FSc0RvdWJsZVJjNldybFdpdGhDb2Fyc2VQb3dl
ckdhdGluZzpza2wgRG91YmxpbmcgV1JMIG9ubHkKKwkJICogd2hlbiBDUEcgaXMgZW5hYmxlZAor
CQkgKi8KKwkJc2V0KHVuY29yZSwgR0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCAxMDggPDwgMTYp
OworCX0gZWxzZSB7CisJCXNldCh1bmNvcmUsIEdFTjZfUkM2X1dBS0VfUkFURV9MSU1JVCwgNTQg
PDwgMTYpOworCX0KKworCXNldCh1bmNvcmUsIEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwg
MTI1MDAwKTsgLyogMTI1MDAgKiAxMjgwbnMgKi8KKwlzZXQodW5jb3JlLCBHRU42X1JDX0lETEVf
SFlTVEVSU0lTLCAyNSk7IC8qIDI1ICogMTI4MG5zICovCisJZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgcmM2X3RvX2d0KHJjNiktPmk5MTUsIGlkKQorCQlzZXQodW5jb3JlLCBSSU5HX01BWF9JRExF
KGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOworCisJc2V0KHVuY29yZSwgR1VDX01BWF9JRExFX0NP
VU5ULCAweEEpOworCisJc2V0KHVuY29yZSwgR0VONl9SQ19TTEVFUCwgMCk7CisKKwkvKgorCSAq
IDJjOiBQcm9ncmFtIENvYXJzZSBQb3dlciBHYXRpbmcgUG9saWNpZXMuCisJICoKKwkgKiBCc3Bl
YydzIGd1aWRhbmNlIGlzIHRvIHVzZSAyNXVzIChyZWFsbHkgMjUgKiAxMjgwbnMpIGhlcmUuIFdo
YXQgd2UKKwkgKiB1c2UgaW5zdGVhZCBpcyBhIG1vcmUgY29uc2VydmF0aXZlIGVzdGltYXRlIGZv
ciB0aGUgbWF4aW11bSB0aW1lCisJICogaXQgdGFrZXMgdXMgdG8gc2VydmljZSBhIENTIGludGVy
cnVwdCBhbmQgc3VibWl0IGEgbmV3IEVMU1AgLSB0aGF0CisJICogaXMgdGhlIHRpbWUgd2hpY2gg
dGhlIEdQVSBpcyBpZGxlIHdhaXRpbmcgZm9yIHRoZSBDUFUgdG8gc2VsZWN0IHRoZQorCSAqIG5l
eHQgcmVxdWVzdCB0byBleGVjdXRlLiBJZiB0aGUgaWRsZSBoeXN0ZXJlc2lzIGlzIGxlc3MgdGhh
biB0aGF0CisJICogaW50ZXJydXB0IHNlcnZpY2UgbGF0ZW5jeSwgdGhlIGhhcmR3YXJlIHdpbGwg
YXV0b21hdGljYWxseSBnYXRlCisJICogdGhlIHBvd2VyIHdlbGwgYW5kIHdlIHdpbGwgdGhlbiBp
bmN1ciB0aGUgd2FrZSB1cCBjb3N0IG9uIHRvcCBvZgorCSAqIHRoZSBzZXJ2aWNlIGxhdGVuY3ku
IEEgc2ltaWxhciBndWlkZSBmcm9tIHBsYW5lX3N0YXRlIGlzIHRoYXQgd2UKKwkgKiBkbyBub3Qg
d2FudCB0aGUgZW5hYmxlIGh5c3RlcmVzaXMgdG8gbGVzcyB0aGFuIHRoZSB3YWtldXAgbGF0ZW5j
eS4KKwkgKgorCSAqIGlndC9nZW1fZXhlY19ub3Avc2VxdWVudGlhbCBwcm92aWRlcyBhIHJvdWdo
IGVzdGltYXRlIGZvciB0aGUKKwkgKiBzZXJ2aWNlIGxhdGVuY3ksIGFuZCBwdXRzIGl0IGFyb3Vu
ZCAxMHVzIGZvciBCcm9hZHdlbGwgKGFuZCBvdGhlcgorCSAqIGJpZyBjb3JlKSBhbmQgYXJvdW5k
IDQwdXMgZm9yIEJyb3h0b24gKGFuZCBvdGhlciBsb3cgcG93ZXIgY29yZXMpLgorCSAqIFtOb3Rl
IHRoYXQgZm9yIGxlZ2FjeSByaW5nYnVmZmVyIHN1Ym1pc3Npb24sIHRoaXMgaXMgbGVzcyB0aGFu
IDF1cyFdCisJICogSG93ZXZlciwgdGhlIHdha2V1cCBsYXRlbmN5IG9uIEJyb3h0b24gaXMgY2xv
c2VyIHRvIDEwMHVzLiBUbyBiZQorCSAqIGNvbnNlcnZhdGl2ZSwgd2UgaGF2ZSB0byBmYWN0b3Ig
aW4gYSBjb250ZXh0IHN3aXRjaCBvbiB0b3AgKGR1ZQorCSAqIHRvIGtzb2Z0aXJxZCkuCisJICov
CisJc2V0KHVuY29yZSwgR0VOOV9NRURJQV9QR19JRExFX0hZU1RFUkVTSVMsIDI1MCk7CisJc2V0
KHVuY29yZSwgR0VOOV9SRU5ERVJfUEdfSURMRV9IWVNURVJFU0lTLCAyNTApOworCisJLyogM2E6
IEVuYWJsZSBSQzYgKi8KKwlzZXQodW5jb3JlLCBHRU42X1JDNl9USFJFU0hPTEQsIDM3NTAwKTsg
LyogMzcuNS8xMjVtcyBwZXIgRUkgKi8KKworCS8qIFdhUnNVc2VUaW1lb3V0TW9kZTpjbmwgKHBy
ZS1wcm9kKSAqLworCWlmIChJU19DTkxfUkVWSUQocmM2X3RvX2k5MTUocmM2KSwgQ05MX1JFVklE
X0EwLCBDTkxfUkVWSURfQzApKQorCQlyYzZfbW9kZSA9IEdFTjdfUkNfQ1RMX1RPX01PREU7CisJ
ZWxzZQorCQlyYzZfbW9kZSA9IEdFTjZfUkNfQ1RMX0VJX01PREUoMSk7CisKKwlzZXQodW5jb3Jl
LCBHRU42X1JDX0NPTlRST0wsCisJICAgIEdFTjZfUkNfQ1RMX0hXX0VOQUJMRSB8CisJICAgIEdF
TjZfUkNfQ1RMX1JDNl9FTkFCTEUgfAorCSAgICByYzZfbW9kZSk7CisKKwlzZXQodW5jb3JlLCBH
RU45X1BHX0VOQUJMRSwKKwkgICAgR0VOOV9SRU5ERVJfUEdfRU5BQkxFIHwgR0VOOV9NRURJQV9Q
R19FTkFCTEUpOworfQorCitzdGF0aWMgdm9pZCBnZW44X3JjNl9lbmFibGUoc3RydWN0IGludGVs
X3JjNiAqcmM2KQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJjNl90b191bmNv
cmUocmM2KTsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9l
bmdpbmVfaWQgaWQ7CisKKwkvKiAyYjogUHJvZ3JhbSBSQzYgdGhyZXNob2xkcy4qLworCXNldCh1
bmNvcmUsIEdFTjZfUkM2X1dBS0VfUkFURV9MSU1JVCwgNDAgPDwgMTYpOworCXNldCh1bmNvcmUs
IEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsgLyogMTI1MDAgKiAxMjgwbnMg
Ki8KKwlzZXQodW5jb3JlLCBHRU42X1JDX0lETEVfSFlTVEVSU0lTLCAyNSk7IC8qIDI1ICogMTI4
MG5zICovCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgcmM2X3RvX2d0KHJjNiktPmk5MTUsIGlk
KQorCQlzZXQodW5jb3JlLCBSSU5HX01BWF9JRExFKGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOwor
CXNldCh1bmNvcmUsIEdFTjZfUkNfU0xFRVAsIDApOworCXNldCh1bmNvcmUsIEdFTjZfUkM2X1RI
UkVTSE9MRCwgNjI1KTsgLyogODAwdXMvMS4yOCBmb3IgVE8gKi8KKworCS8qIDM6IEVuYWJsZSBS
QzYgKi8KKwlzZXQodW5jb3JlLCBHRU42X1JDX0NPTlRST0wsCisJICAgIEdFTjZfUkNfQ1RMX0hX
X0VOQUJMRSB8CisJICAgIEdFTjdfUkNfQ1RMX1RPX01PREUgfAorCSAgICBHRU42X1JDX0NUTF9S
QzZfRU5BQkxFKTsKK30KKworc3RhdGljIHZvaWQgZ2VuNl9yYzZfZW5hYmxlKHN0cnVjdCBpbnRl
bF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSByYzZfdG9fdW5j
b3JlKHJjNik7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSByYzZfdG9faTkxNShy
YzYpOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwllbnVtIGludGVsX2VuZ2lu
ZV9pZCBpZDsKKwl1MzIgcmM2dmlkcywgcmM2X21hc2s7CisJaW50IHJldDsKKworCXNldCh1bmNv
cmUsIEdFTjZfUkMxX1dBS0VfUkFURV9MSU1JVCwgMTAwMCA8PCAxNik7CisJc2V0KHVuY29yZSwg
R0VONl9SQzZfV0FLRV9SQVRFX0xJTUlULCA0MCA8PCAxNiB8IDMwKTsKKwlzZXQodW5jb3JlLCBH
RU42X1JDNnBwX1dBS0VfUkFURV9MSU1JVCwgMzApOworCXNldCh1bmNvcmUsIEdFTjZfUkNfRVZB
TFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsKKwlzZXQodW5jb3JlLCBHRU42X1JDX0lETEVfSFlT
VEVSU0lTLCAyNSk7CisKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkKKwkJc2V0
KHVuY29yZSwgUklOR19NQVhfSURMRShlbmdpbmUtPm1taW9fYmFzZSksIDEwKTsKKworCXNldCh1
bmNvcmUsIEdFTjZfUkNfU0xFRVAsIDApOworCXNldCh1bmNvcmUsIEdFTjZfUkMxZV9USFJFU0hP
TEQsIDEwMDApOworCWlmIChJU19JVllCUklER0UoaTkxNSkpCisJCXNldCh1bmNvcmUsIEdFTjZf
UkM2X1RIUkVTSE9MRCwgMTI1MDAwKTsKKwllbHNlCisJCXNldCh1bmNvcmUsIEdFTjZfUkM2X1RI
UkVTSE9MRCwgNTAwMDApOworCXNldCh1bmNvcmUsIEdFTjZfUkM2cF9USFJFU0hPTEQsIDE1MDAw
MCk7CisJc2V0KHVuY29yZSwgR0VONl9SQzZwcF9USFJFU0hPTEQsIDY0MDAwKTsgLyogdW51c2Vk
ICovCisKKwkvKiBXZSBkb24ndCB1c2UgdGhvc2Ugb24gSGFzd2VsbCAqLworCXJjNl9tYXNrID0g
R0VONl9SQ19DVExfUkM2X0VOQUJMRTsKKwlpZiAoSEFTX1JDNnAoaTkxNSkpCisJCXJjNl9tYXNr
IHw9IEdFTjZfUkNfQ1RMX1JDNnBfRU5BQkxFOworCWlmIChIQVNfUkM2cHAoaTkxNSkpCisJCXJj
Nl9tYXNrIHw9IEdFTjZfUkNfQ1RMX1JDNnBwX0VOQUJMRTsKKwlzZXQodW5jb3JlLCBHRU42X1JD
X0NPTlRST0wsCisJICAgIHJjNl9tYXNrIHwKKwkgICAgR0VONl9SQ19DVExfRUlfTU9ERSgxKSB8
CisJICAgIEdFTjZfUkNfQ1RMX0hXX0VOQUJMRSk7CisKKwlyYzZ2aWRzID0gMDsKKwlyZXQgPSBz
YW5keWJyaWRnZV9wY29kZV9yZWFkKGk5MTUsIEdFTjZfUENPREVfUkVBRF9SQzZWSURTLAorCQkJ
CSAgICAgJnJjNnZpZHMsIE5VTEwpOworCWlmIChJU19HRU4oaTkxNSwgNikgJiYgcmV0KSB7CisJ
CURSTV9ERUJVR19EUklWRVIoIkNvdWxkbid0IGNoZWNrIGZvciBCSU9TIHdvcmthcm91bmRcbiIp
OworCX0gZWxzZSBpZiAoSVNfR0VOKGk5MTUsIDYpICYmCisJCSAgIChHRU42X0RFQ09ERV9SQzZf
VklEKHJjNnZpZHMgJiAweGZmKSA8IDQ1MCkpIHsKKwkJRFJNX0RFQlVHX0RSSVZFUigiWW91IHNo
b3VsZCB1cGRhdGUgeW91ciBCSU9TLiBDb3JyZWN0aW5nIG1pbmltdW0gcmM2IHZvbHRhZ2UgKCVk
bVYtPiVkbVYpXG4iLAorCQkJCSBHRU42X0RFQ09ERV9SQzZfVklEKHJjNnZpZHMgJiAweGZmKSwg
NDUwKTsKKwkJcmM2dmlkcyAmPSAweGZmZmYwMDsKKwkJcmM2dmlkcyB8PSBHRU42X0VOQ09ERV9S
QzZfVklEKDQ1MCk7CisJCXJldCA9IHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGk5MTUsIEdFTjZf
UENPREVfV1JJVEVfUkM2VklEUywgcmM2dmlkcyk7CisJCWlmIChyZXQpCisJCQlEUk1fRVJST1Io
IkNvdWxkbid0IGZpeCBpbmNvcnJlY3QgcmM2IHZvbHRhZ2VcbiIpOworCX0KK30KKworLyogQ2hl
Y2sgdGhhdCB0aGUgcGNiciBhZGRyZXNzIGlzIG5vdCBlbXB0eS4gKi8KK3N0YXRpYyBpbnQgY2h2
X3JjNl9pbml0KHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3Jl
ICp1bmNvcmUgPSByYzZfdG9fdW5jb3JlKHJjNik7CisJcmVzb3VyY2Vfc2l6ZV90IHBjdHhfcGFk
ZHIsIHBhZGRyOworCXJlc291cmNlX3NpemVfdCBwY3R4X3NpemUgPSAzMiAqIFNaXzFLOworCXUz
MiBwY2JyOworCisJcGNiciA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgVkxWX1BDQlIpOwor
CWlmICgocGNiciA+PiBWTFZfUENCUl9BRERSX1NISUZUKSA9PSAwKSB7CisJCURSTV9ERUJVR19E
UklWRVIoIkJJT1MgZGlkbid0IHNldCB1cCBQQ0JSLCBmaXhpbmcgdXBcbiIpOworCQlwYWRkciA9
IHJjNl90b19pOTE1KHJjNiktPmRzbS5lbmQgKyAxIC0gcGN0eF9zaXplOworCQlHRU1fQlVHX09O
KHBhZGRyID4gVTMyX01BWCk7CisKKwkJcGN0eF9wYWRkciA9IChwYWRkciAmIH40MDk1KTsKKwkJ
aW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgVkxWX1BDQlIsIHBjdHhfcGFkZHIpOworCX0KKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHZsdl9yYzZfaW5pdChzdHJ1Y3QgaW50ZWxfcmM2
ICpyYzYpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSByYzZfdG9faTkxNShy
YzYpOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJjNl90b191bmNvcmUocmM2KTsK
KwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqcGN0eDsKKwlyZXNvdXJjZV9zaXplX3QgcGN0
eF9wYWRkcjsKKwlyZXNvdXJjZV9zaXplX3QgcGN0eF9zaXplID0gMjQgKiBTWl8xSzsKKwl1MzIg
cGNicjsKKworCXBjYnIgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFZMVl9QQ0JSKTsKKwlp
ZiAocGNicikgeworCQkvKiBCSU9TIHNldCBpdCB1cCBhbHJlYWR5LCBncmFiIHRoZSBwcmUtYWxs
b2MnZCBzcGFjZSAqLworCQlyZXNvdXJjZV9zaXplX3QgcGNicl9vZmZzZXQ7CisKKwkJcGNicl9v
ZmZzZXQgPSAocGNiciAmIH40MDk1KSAtIGk5MTUtPmRzbS5zdGFydDsKKwkJcGN0eCA9IGk5MTVf
Z2VtX29iamVjdF9jcmVhdGVfc3RvbGVuX2Zvcl9wcmVhbGxvY2F0ZWQoaTkxNSwKKwkJCQkJCQkJ
ICAgICAgcGNicl9vZmZzZXQsCisJCQkJCQkJCSAgICAgIEk5MTVfR1RUX09GRlNFVF9OT05FLAor
CQkJCQkJCQkgICAgICBwY3R4X3NpemUpOworCQlpZiAoIXBjdHgpCisJCQlyZXR1cm4gLUVOT01F
TTsKKworCQlnb3RvIG91dDsKKwl9CisKKwlEUk1fREVCVUdfRFJJVkVSKCJCSU9TIGRpZG4ndCBz
ZXQgdXAgUENCUiwgZml4aW5nIHVwXG4iKTsKKworCS8qCisJICogRnJvbSB0aGUgR3VuaXQgcmVn
aXN0ZXIgSEFTOgorCSAqIFRoZSBHZnggZHJpdmVyIGlzIGV4cGVjdGVkIHRvIHByb2dyYW0gdGhp
cyByZWdpc3RlciBhbmQgZW5zdXJlCisJICogcHJvcGVyIGFsbG9jYXRpb24gd2l0aGluIEdmeCBz
dG9sZW4gbWVtb3J5LiAgRm9yIGV4YW1wbGUsIHRoaXMKKwkgKiByZWdpc3RlciBzaG91bGQgYmUg
cHJvZ3JhbW1lZCBzdWNoIHRoYW4gdGhlIFBDQlIgcmFuZ2UgZG9lcyBub3QKKwkgKiBvdmVybGFw
IHdpdGggb3RoZXIgcmFuZ2VzLCBzdWNoIGFzIHRoZSBmcmFtZSBidWZmZXIsIHByb3RlY3RlZAor
CSAqIG1lbW9yeSwgb3IgYW55IG90aGVyIHJlbGV2YW50IHJhbmdlcy4KKwkgKi8KKwlwY3R4ID0g
aTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW4oaTkxNSwgcGN0eF9zaXplKTsKKwlpZiAoIXBj
dHgpIHsKKwkJRFJNX0RFQlVHKCJub3QgZW5vdWdoIHN0b2xlbiBzcGFjZSBmb3IgUENUWCwgZGlz
YWJsaW5nXG4iKTsKKwkJcmV0dXJuIC1FTk9NRU07CisJfQorCisJR0VNX0JVR19PTihyYW5nZV9v
dmVyZmxvd3NfdCh1NjQsCisJCQkJICAgICBpOTE1LT5kc20uc3RhcnQsCisJCQkJICAgICBwY3R4
LT5zdG9sZW4tPnN0YXJ0LAorCQkJCSAgICAgVTMyX01BWCkpOworCXBjdHhfcGFkZHIgPSBpOTE1
LT5kc20uc3RhcnQgKyBwY3R4LT5zdG9sZW4tPnN0YXJ0OworCWludGVsX3VuY29yZV93cml0ZSh1
bmNvcmUsIFZMVl9QQ0JSLCBwY3R4X3BhZGRyKTsKKworb3V0OgorCXJjNi0+cGN0eCA9IHBjdHg7
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGNodl9yYzZfZW5hYmxlKHN0cnVjdCBpbnRl
bF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSByYzZfdG9fdW5j
b3JlKHJjNik7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCWVudW0gaW50ZWxf
ZW5naW5lX2lkIGlkOworCisJLyogMmE6IFByb2dyYW0gUkM2IHRocmVzaG9sZHMuKi8KKwlzZXQo
dW5jb3JlLCBHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDQwIDw8IDE2KTsKKwlzZXQodW5jb3Jl
LCBHRU42X1JDX0VWQUxVQVRJT05fSU5URVJWQUwsIDEyNTAwMCk7IC8qIDEyNTAwICogMTI4MG5z
ICovCisJc2V0KHVuY29yZSwgR0VONl9SQ19JRExFX0hZU1RFUlNJUywgMjUpOyAvKiAyNSAqIDEy
ODBucyAqLworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgcmM2X3RvX2d0KHJjNiktPmk5MTUs
IGlkKQorCQlzZXQodW5jb3JlLCBSSU5HX01BWF9JRExFKGVuZ2luZS0+bW1pb19iYXNlKSwKKwkJ
CQkgICAgICAxMCk7CisJc2V0KHVuY29yZSwgR0VONl9SQ19TTEVFUCwgMCk7CisKKwkvKiBUTyB0
aHJlc2hvbGQgc2V0IHRvIDUwMCB1cyAoMHgxODYgKiAxLjI4IHVzKSAqLworCXNldCh1bmNvcmUs
IEdFTjZfUkM2X1RIUkVTSE9MRCwgMHgxODYpOworCisJLyogQWxsb3dzIFJDNiByZXNpZGVuY3kg
Y291bnRlciB0byB3b3JrICovCisJc2V0KHVuY29yZSwgVkxWX0NPVU5URVJfQ09OVFJPTCwKKwkg
ICAgX01BU0tFRF9CSVRfRU5BQkxFKFZMVl9DT1VOVF9SQU5HRV9ISUdIIHwKKwkJCSAgICAgICBW
TFZfTUVESUFfUkM2X0NPVU5UX0VOIHwKKwkJCSAgICAgICBWTFZfUkVOREVSX1JDNl9DT1VOVF9F
TikpOworCisJLyogMzogRW5hYmxlIFJDNiAqLworCXNldCh1bmNvcmUsIEdFTjZfUkNfQ09OVFJP
TCwgR0VON19SQ19DVExfVE9fTU9ERSk7Cit9CisKK3N0YXRpYyB2b2lkIHZsdl9yYzZfZW5hYmxl
KHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUg
PSByYzZfdG9fdW5jb3JlKHJjNik7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwor
CWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOworCisJc2V0KHVuY29yZSwgR0VONl9SQzZfV0FLRV9S
QVRFX0xJTUlULCAweDAwMjgwMDAwKTsKKwlzZXQodW5jb3JlLCBHRU42X1JDX0VWQUxVQVRJT05f
SU5URVJWQUwsIDEyNTAwMCk7CisJc2V0KHVuY29yZSwgR0VONl9SQ19JRExFX0hZU1RFUlNJUywg
MjUpOworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgcmM2X3RvX2d0KHJjNiktPmk5MTUsIGlk
KQorCQlzZXQodW5jb3JlLCBSSU5HX01BWF9JRExFKGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOwor
CisJc2V0KHVuY29yZSwgR0VONl9SQzZfVEhSRVNIT0xELCAweDU1Nyk7CisKKwkvKiBBbGxvd3Mg
UkM2IHJlc2lkZW5jeSBjb3VudGVyIHRvIHdvcmsgKi8KKwlzZXQodW5jb3JlLCBWTFZfQ09VTlRF
Ul9DT05UUk9MLAorCSAgICBfTUFTS0VEX0JJVF9FTkFCTEUoVkxWX0NPVU5UX1JBTkdFX0hJR0gg
fAorCQkJICAgICAgIFZMVl9NRURJQV9SQzBfQ09VTlRfRU4gfAorCQkJICAgICAgIFZMVl9SRU5E
RVJfUkMwX0NPVU5UX0VOIHwKKwkJCSAgICAgICBWTFZfTUVESUFfUkM2X0NPVU5UX0VOIHwKKwkJ
CSAgICAgICBWTFZfUkVOREVSX1JDNl9DT1VOVF9FTikpOworCisJc2V0KHVuY29yZSwgR0VONl9S
Q19DT05UUk9MLAorCSAgICBHRU43X1JDX0NUTF9UT19NT0RFIHwgVkxWX1JDX0NUTF9DVFhfUlNU
X1BBUkFMTEVMKTsKK30KKworc3RhdGljIGJvb2wgYnh0X2NoZWNrX2Jpb3NfcmM2X3NldHVwKHN0
cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBy
YzZfdG9fdW5jb3JlKHJjNik7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSByYzZf
dG9faTkxNShyYzYpOworCXUzMiByYzZfY3R4X2Jhc2UsIHJjX2N0bCwgcmNfc3dfdGFyZ2V0Owor
CWJvb2wgZW5hYmxlX3JjNiA9IHRydWU7CisKKwlyY19jdGwgPSBpbnRlbF91bmNvcmVfcmVhZCh1
bmNvcmUsIEdFTjZfUkNfQ09OVFJPTCk7CisJcmNfc3dfdGFyZ2V0ID0gaW50ZWxfdW5jb3JlX3Jl
YWQodW5jb3JlLCBHRU42X1JDX1NUQVRFKTsKKwlyY19zd190YXJnZXQgJj0gUkNfU1dfVEFSR0VU
X1NUQVRFX01BU0s7CisJcmNfc3dfdGFyZ2V0ID4+PSBSQ19TV19UQVJHRVRfU1RBVEVfU0hJRlQ7
CisJRFJNX0RFQlVHX0RSSVZFUigiQklPUyBlbmFibGVkIFJDIHN0YXRlczogIgorCQkJICJIV19D
VFJMICVzIEhXX1JDNiAlcyBTV19UQVJHRVRfU1RBVEUgJXhcbiIsCisJCQkgb25vZmYocmNfY3Rs
ICYgR0VONl9SQ19DVExfSFdfRU5BQkxFKSwKKwkJCSBvbm9mZihyY19jdGwgJiBHRU42X1JDX0NU
TF9SQzZfRU5BQkxFKSwKKwkJCSByY19zd190YXJnZXQpOworCisJaWYgKCEoaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBSQzZfTE9DQVRJT04pICYgUkM2X0NUWF9JTl9EUkFNKSkgeworCQlEUk1f
REVCVUdfRFJJVkVSKCJSQzYgQmFzZSBsb2NhdGlvbiBub3Qgc2V0IHByb3Blcmx5LlxuIik7CisJ
CWVuYWJsZV9yYzYgPSBmYWxzZTsKKwl9CisKKwkvKgorCSAqIFRoZSBleGFjdCBjb250ZXh0IHNp
emUgaXMgbm90IGtub3duIGZvciBCWFQsIHNvIGFzc3VtZSBhIHBhZ2Ugc2l6ZQorCSAqIGZvciB0
aGlzIGNoZWNrLgorCSAqLworCXJjNl9jdHhfYmFzZSA9CisJCWludGVsX3VuY29yZV9yZWFkKHVu
Y29yZSwgUkM2X0NUWF9CQVNFKSAmIFJDNl9DVFhfQkFTRV9NQVNLOworCWlmICghKHJjNl9jdHhf
YmFzZSA+PSBpOTE1LT5kc21fcmVzZXJ2ZWQuc3RhcnQgJiYKKwkgICAgICByYzZfY3R4X2Jhc2Ug
KyBQQUdFX1NJWkUgPCBpOTE1LT5kc21fcmVzZXJ2ZWQuZW5kKSkgeworCQlEUk1fREVCVUdfRFJJ
VkVSKCJSQzYgQmFzZSBhZGRyZXNzIG5vdCBhcyBleHBlY3RlZC5cbiIpOworCQllbmFibGVfcmM2
ID0gZmFsc2U7CisJfQorCisJaWYgKCEoKGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgUFdSQ1RY
X01BWENOVF9SQ1NVTklUKSAmIElETEVfVElNRV9NQVNLKSA+IDEgJiYKKwkgICAgICAoaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBQV1JDVFhfTUFYQ05UX1ZDU1VOSVQwKSAmIElETEVfVElNRV9N
QVNLKSA+IDEgJiYKKwkgICAgICAoaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBQV1JDVFhfTUFY
Q05UX0JDU1VOSVQpICYgSURMRV9USU1FX01BU0spID4gMSAmJgorCSAgICAgIChpbnRlbF91bmNv
cmVfcmVhZCh1bmNvcmUsIFBXUkNUWF9NQVhDTlRfVkVDU1VOSVQpICYgSURMRV9USU1FX01BU0sp
ID4gMSkpIHsKKwkJRFJNX0RFQlVHX0RSSVZFUigiRW5naW5lIElkbGUgd2FpdCB0aW1lIG5vdCBz
ZXQgcHJvcGVybHkuXG4iKTsKKwkJZW5hYmxlX3JjNiA9IGZhbHNlOworCX0KKworCWlmICghaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU44X1BVU0hCVVNfQ09OVFJPTCkgfHwKKwkgICAgIWlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VOOF9QVVNIQlVTX0VOQUJMRSkgfHwKKwkgICAgIWlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VOOF9QVVNIQlVTX1NISUZUKSkgeworCQlEUk1fREVC
VUdfRFJJVkVSKCJQdXNoYnVzIG5vdCBzZXR1cCBwcm9wZXJseS5cbiIpOworCQllbmFibGVfcmM2
ID0gZmFsc2U7CisJfQorCisJaWYgKCFpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjZfR0ZY
UEFVU0UpKSB7CisJCURSTV9ERUJVR19EUklWRVIoIkdGWCBwYXVzZSBub3Qgc2V0dXAgcHJvcGVy
bHkuXG4iKTsKKwkJZW5hYmxlX3JjNiA9IGZhbHNlOworCX0KKworCWlmICghaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBHRU44X01JU0NfQ1RSTDApKSB7CisJCURSTV9ERUJVR19EUklWRVIoIkdQ
TSBjb250cm9sIG5vdCBzZXR1cCBwcm9wZXJseS5cbiIpOworCQllbmFibGVfcmM2ID0gZmFsc2U7
CisJfQorCisJcmV0dXJuIGVuYWJsZV9yYzY7Cit9CisKK3N0YXRpYyBib29sIHJjNl9zdXBwb3J0
ZWQoc3RydWN0IGludGVsX3JjNiAqcmM2KQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gcmM2X3RvX2k5MTUocmM2KTsKKworCWlmICghSEFTX1JDNihpOTE1KSkKKwkJcmV0dXJu
IGZhbHNlOworCisJaWYgKGludGVsX3ZncHVfYWN0aXZlKGk5MTUpKQorCQlyZXR1cm4gZmFsc2U7
CisKKwlpZiAoaXNfbW9ja19ndChyYzZfdG9fZ3QocmM2KSkpCisJCXJldHVybiBmYWxzZTsKKwor
CWlmIChJU19HRU45X0xQKGk5MTUpICYmICFieHRfY2hlY2tfYmlvc19yYzZfc2V0dXAocmM2KSkg
eworCQlkZXZfbm90aWNlKGk5MTUtPmRybS5kZXYsCisJCQkgICAiUkM2IGFuZCBwb3dlcnNhdmlu
ZyBkaXNhYmxlZCBieSBCSU9TXG4iKTsKKwkJcmV0dXJuIGZhbHNlOworCX0KKworCXJldHVybiB0
cnVlOworfQorCitzdGF0aWMgdm9pZCBycG1fZ2V0KHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sK
KwlHRU1fQlVHX09OKHJjNi0+d2FrZXJlZik7CisJcG1fcnVudGltZV9nZXRfc3luYygmcmM2X3Rv
X2k5MTUocmM2KS0+ZHJtLnBkZXYtPmRldik7CisJcmM2LT53YWtlcmVmID0gdHJ1ZTsKK30KKwor
c3RhdGljIHZvaWQgcnBtX3B1dChzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCit7CisJR0VNX0JVR19P
TighcmM2LT53YWtlcmVmKTsKKwlwbV9ydW50aW1lX3B1dCgmcmM2X3RvX2k5MTUocmM2KS0+ZHJt
LnBkZXYtPmRldik7CisJcmM2LT53YWtlcmVmID0gZmFsc2U7Cit9CisKK3N0YXRpYyB2b2lkIF9f
aW50ZWxfcmM2X2Rpc2FibGUoc3RydWN0IGludGVsX3JjNiAqcmM2KQoreworCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1ID0gcmM2X3RvX2k5MTUocmM2KTsKKwlzdHJ1Y3QgaW50ZWxfdW5j
b3JlICp1bmNvcmUgPSByYzZfdG9fdW5jb3JlKHJjNik7CisKKwlpbnRlbF91bmNvcmVfZm9yY2V3
YWtlX2dldCh1bmNvcmUsIEZPUkNFV0FLRV9BTEwpOworCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0g
OSkKKwkJc2V0KHVuY29yZSwgR0VOOV9QR19FTkFCTEUsIDApOworCXNldCh1bmNvcmUsIEdFTjZf
UkNfQ09OVFJPTCwgMCk7CisJc2V0KHVuY29yZSwgR0VONl9SQ19TVEFURSwgMCk7CisJaW50ZWxf
dW5jb3JlX2ZvcmNld2FrZV9wdXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKK30KKwordm9pZCBp
bnRlbF9yYzZfaW5pdChzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCit7CisJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSByYzZfdG9faTkxNShyYzYpOworCWludCBlcnI7CisKKwkvKiBEaXNh
YmxlIHJ1bnRpbWUtcG0gdW50aWwgd2UgY2FuIHNhdmUgdGhlIEdQVSBzdGF0ZSB3aXRoIHJjNiBw
Y3R4ICovCisJcnBtX2dldChyYzYpOworCisJaWYgKCFyYzZfc3VwcG9ydGVkKHJjNikpCisJCXJl
dHVybjsKKworCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKQorCQllcnIgPSBjaHZfcmM2X2luaXQo
cmM2KTsKKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQorCQllcnIgPSB2bHZfcmM2X2lu
aXQocmM2KTsKKwllbHNlCisJCWVyciA9IDA7CisKKwkvKiBTYW5pdGl6ZSByYzYsIGVuc3VyZSBp
dCBpcyBkaXNhYmxlZCBiZWZvcmUgd2UgYXJlIHJlYWR5LiAqLworCV9faW50ZWxfcmM2X2Rpc2Fi
bGUocmM2KTsKKworCXJjNi0+c3VwcG9ydGVkID0gZXJyID09IDA7Cit9CisKK3ZvaWQgaW50ZWxf
cmM2X3Nhbml0aXplKHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlpZiAocmM2LT5zdXBwb3J0
ZWQpCisJCV9faW50ZWxfcmM2X2Rpc2FibGUocmM2KTsKK30KKwordm9pZCBpbnRlbF9yYzZfZW5h
YmxlKHN0cnVjdCBpbnRlbF9yYzYgKnJjNikKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHJjNl90b19pOTE1KHJjNik7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0g
cmM2X3RvX3VuY29yZShyYzYpOworCisJaWYgKCFyYzYtPnN1cHBvcnRlZCkKKwkJcmV0dXJuOwor
CisJR0VNX0JVR19PTihyYzYtPmVuYWJsZWQpOworCisJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9n
ZXQodW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKworCWlmIChJU19DSEVSUllWSUVXKGk5MTUpKQor
CQljaHZfcmM2X2VuYWJsZShyYzYpOworCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkpCisJ
CXZsdl9yYzZfZW5hYmxlKHJjNik7CisJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQor
CQlnZW4xMV9yYzZfZW5hYmxlKHJjNik7CisJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDkp
CisJCWdlbjlfcmM2X2VuYWJsZShyYzYpOworCWVsc2UgaWYgKElTX0JST0FEV0VMTChpOTE1KSkK
KwkJZ2VuOF9yYzZfZW5hYmxlKHJjNik7CisJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYp
CisJCWdlbjZfcmM2X2VuYWJsZShyYzYpOworCisJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQo
dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKKworCS8qIHJjNiBpcyByZWFkeSwgcnVudGltZS1wbSBp
cyBnbyEgKi8KKwlycG1fcHV0KHJjNik7CisJcmM2LT5lbmFibGVkID0gdHJ1ZTsKK30KKwordm9p
ZCBpbnRlbF9yYzZfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCit7CisJaWYgKCFyYzYt
PmVuYWJsZWQpCisJCXJldHVybjsKKworCXJwbV9nZXQocmM2KTsKKwlyYzYtPmVuYWJsZWQgPSBm
YWxzZTsKKworCV9faW50ZWxfcmM2X2Rpc2FibGUocmM2KTsKK30KKwordm9pZCBpbnRlbF9yYzZf
ZmluaShzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYpCit7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKnBjdHg7CisKKwlpbnRlbF9yYzZfZGlzYWJsZShyYzYpOworCisJcGN0eCA9IGZldGNoX2Fu
ZF96ZXJvKCZyYzYtPnBjdHgpOworCWlmIChwY3R4KQorCQlpOTE1X2dlbV9vYmplY3RfcHV0KHBj
dHgpOworCisJaWYgKHJjNi0+d2FrZXJlZikKKwkJcnBtX3B1dChyYzYpOworfQorCitzdGF0aWMg
dTY0IHZsdl9yZXNpZGVuY3lfcmF3KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwgY29uc3Qg
aTkxNV9yZWdfdCByZWcpCit7CisJdTMyIGxvd2VyLCB1cHBlciwgdG1wOworCWludCBsb29wID0g
MjsKKworCS8qCisJICogVGhlIHJlZ2lzdGVyIGFjY2Vzc2VkIGRvIG5vdCBuZWVkIGZvcmNld2Fr
ZS4gV2UgYm9ycm93CisJICogdW5jb3JlIGxvY2sgdG8gcHJldmVudCBjb25jdXJyZW50IGFjY2Vz
cyB0byByYW5nZSByZWcuCisJICovCisJbG9ja2RlcF9hc3NlcnRfaGVsZCgmdW5jb3JlLT5sb2Nr
KTsKKworCS8qCisJICogdmx2IGFuZCBjaHYgcmVzaWRlbmN5IGNvdW50ZXJzIGFyZSA0MCBiaXRz
IGluIHdpZHRoLgorCSAqIFdpdGggYSBjb250cm9sIGJpdCwgd2UgY2FuIGNob29zZSBiZXR3ZWVu
IHVwcGVyIG9yIGxvd2VyCisJICogMzJiaXQgd2luZG93IGludG8gdGhpcyBjb3VudGVyLgorCSAq
CisJICogQWx0aG91Z2ggd2UgYWx3YXlzIHVzZSB0aGUgY291bnRlciBpbiBoaWdoLXJhbmdlIG1v
ZGUgZWxzZXdoZXJlLAorCSAqIHVzZXJzcGFjZSBtYXkgYXR0ZW1wdCB0byByZWFkIHRoZSB2YWx1
ZSBiZWZvcmUgcmM2IGlzIGluaXRpYWxpc2VkLAorCSAqIGJlZm9yZSB3ZSBoYXZlIHNldCB0aGUg
ZGVmYXVsdCBWTFZfQ09VTlRFUl9DT05UUk9MIHZhbHVlLiBTbyBhbHdheXMKKwkgKiBzZXQgdGhl
IGhpZ2ggYml0IHRvIGJlIHNhZmUuCisJICovCisJc2V0KHVuY29yZSwgVkxWX0NPVU5URVJfQ09O
VFJPTCwKKwkgICAgX01BU0tFRF9CSVRfRU5BQkxFKFZMVl9DT1VOVF9SQU5HRV9ISUdIKSk7CisJ
dXBwZXIgPSBpbnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIHJlZyk7CisJZG8geworCQl0bXAg
PSB1cHBlcjsKKworCQlzZXQodW5jb3JlLCBWTFZfQ09VTlRFUl9DT05UUk9MLAorCQkgICAgX01B
U0tFRF9CSVRfRElTQUJMRShWTFZfQ09VTlRfUkFOR0VfSElHSCkpOworCQlsb3dlciA9IGludGVs
X3VuY29yZV9yZWFkX2Z3KHVuY29yZSwgcmVnKTsKKworCQlzZXQodW5jb3JlLCBWTFZfQ09VTlRF
Ul9DT05UUk9MLAorCQkgICAgX01BU0tFRF9CSVRfRU5BQkxFKFZMVl9DT1VOVF9SQU5HRV9ISUdI
KSk7CisJCXVwcGVyID0gaW50ZWxfdW5jb3JlX3JlYWRfZncodW5jb3JlLCByZWcpOworCX0gd2hp
bGUgKHVwcGVyICE9IHRtcCAmJiAtLWxvb3ApOworCisJLyoKKwkgKiBFdmVyeXdoZXJlIGVsc2Ug
d2UgYWx3YXlzIHVzZSBWTFZfQ09VTlRFUl9DT05UUk9MIHdpdGggdGhlCisJICogVkxWX0NPVU5U
X1JBTkdFX0hJR0ggYml0IHNldCAtIHNvIGl0IGlzIHNhZmUgdG8gbGVhdmUgaXQgc2V0CisJICog
bm93LgorCSAqLworCisJcmV0dXJuIGxvd2VyIHwgKHU2NCl1cHBlciA8PCA4OworfQorCit1NjQg
aW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYsIGNvbnN0IGk5MTVf
cmVnX3QgcmVnKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcmM2X3RvX2k5
MTUocmM2KTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSByYzZfdG9fdW5jb3JlKHJj
Nik7CisJdTY0IHRpbWVfaHcsIHByZXZfaHcsIG92ZXJmbG93X2h3OworCXVuc2lnbmVkIGludCBm
d19kb21haW5zOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisJdW5zaWduZWQgaW50IGk7CisJdTMy
IG11bCwgZGl2OworCisJaWYgKCFyYzYtPnN1cHBvcnRlZCkKKwkJcmV0dXJuIDA7CisKKwkvKgor
CSAqIFN0b3JlIHByZXZpb3VzIGh3IGNvdW50ZXIgdmFsdWVzIGZvciBjb3VudGVyIHdyYXAtYXJv
dW5kIGhhbmRsaW5nLgorCSAqCisJICogVGhlcmUgYXJlIG9ubHkgZm91ciBpbnRlcmVzdGluZyBy
ZWdpc3RlcnMgYW5kIHRoZXkgbGl2ZSBuZXh0IHRvIGVhY2gKKwkgKiBvdGhlciBzbyB3ZSBjYW4g
dXNlIHRoZSByZWxhdGl2ZSBhZGRyZXNzLCBjb21wYXJlZCB0byB0aGUgc21hbGxlc3QKKwkgKiBv
bmUgYXMgdGhlIGluZGV4IGludG8gZHJpdmVyIHN0b3JhZ2UuCisJICovCisJaSA9IChpOTE1X21t
aW9fcmVnX29mZnNldChyZWcpIC0KKwkgICAgIGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjZfR1Rf
R0ZYX1JDNl9MT0NLRUQpKSAvIHNpemVvZih1MzIpOworCWlmIChXQVJOX09OX09OQ0UoaSA+PSBB
UlJBWV9TSVpFKHJjNi0+Y3VyX3Jlc2lkZW5jeSkpKQorCQlyZXR1cm4gMDsKKworCWZ3X2RvbWFp
bnMgPSBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2Zvcl9yZWcodW5jb3JlLCByZWcsIEZXX1JFR19S
RUFEKTsKKworCXNwaW5fbG9ja19pcnFzYXZlKCZ1bmNvcmUtPmxvY2ssIGZsYWdzKTsKKwlpbnRl
bF91bmNvcmVfZm9yY2V3YWtlX2dldF9fbG9ja2VkKHVuY29yZSwgZndfZG9tYWlucyk7CisKKwkv
KiBPbiBWTFYgYW5kIENIViwgcmVzaWRlbmN5IHRpbWUgaXMgaW4gQ1ogdW5pdHMgcmF0aGVyIHRo
YW4gMS4yOHVzICovCisJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhp
OTE1KSkgeworCQltdWwgPSAxMDAwMDAwOworCQlkaXYgPSBpOTE1LT5jemNsa19mcmVxOworCQlv
dmVyZmxvd19odyA9IEJJVF9VTEwoNDApOworCQl0aW1lX2h3ID0gdmx2X3Jlc2lkZW5jeV9yYXco
dW5jb3JlLCByZWcpOworCX0gZWxzZSB7CisJCS8qIDgzMy4zM25zIHVuaXRzIG9uIEdlbjlMUCwg
MS4yOHVzIGVsc2V3aGVyZS4gKi8KKwkJaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKKwkJCW11bCA9
IDEwMDAwOworCQkJZGl2ID0gMTI7CisJCX0gZWxzZSB7CisJCQltdWwgPSAxMjgwOworCQkJZGl2
ID0gMTsKKwkJfQorCisJCW92ZXJmbG93X2h3ID0gQklUX1VMTCgzMik7CisJCXRpbWVfaHcgPSBp
bnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIHJlZyk7CisJfQorCisJLyoKKwkgKiBDb3VudGVy
IHdyYXAgaGFuZGxpbmcuCisJICoKKwkgKiBCdXQgcmVseWluZyBvbiBhIHN1ZmZpY2llbnQgZnJl
cXVlbmN5IG9mIHF1ZXJpZXMgb3RoZXJ3aXNlIGNvdW50ZXJzCisJICogY2FuIHN0aWxsIHdyYXAu
CisJICovCisJcHJldl9odyA9IHJjNi0+cHJldl9od19yZXNpZGVuY3lbaV07CisJcmM2LT5wcmV2
X2h3X3Jlc2lkZW5jeVtpXSA9IHRpbWVfaHc7CisKKwkvKiBSQzYgZGVsdGEgZnJvbSBsYXN0IHNh
bXBsZS4gKi8KKwlpZiAodGltZV9odyA+PSBwcmV2X2h3KQorCQl0aW1lX2h3IC09IHByZXZfaHc7
CisJZWxzZQorCQl0aW1lX2h3ICs9IG92ZXJmbG93X2h3IC0gcHJldl9odzsKKworCS8qIEFkZCBk
ZWx0YSB0byBSQzYgZXh0ZW5kZWQgcmF3IGRyaXZlciBjb3B5LiAqLworCXRpbWVfaHcgKz0gcmM2
LT5jdXJfcmVzaWRlbmN5W2ldOworCXJjNi0+Y3VyX3Jlc2lkZW5jeVtpXSA9IHRpbWVfaHc7CisK
KwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dF9fbG9ja2VkKHVuY29yZSwgZndfZG9tYWlucyk7
CisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdW5jb3JlLT5sb2NrLCBmbGFncyk7CisKKwlyZXR1
cm4gbXVsX3U2NF91MzJfZGl2KHRpbWVfaHcsIG11bCwgZGl2KTsKK30KKwordTY0IGludGVsX3Jj
Nl9yZXNpZGVuY3lfdXMoc3RydWN0IGludGVsX3JjNiAqcmM2LCBpOTE1X3JlZ190IHJlZykKK3sK
KwlyZXR1cm4gRElWX1JPVU5EX1VQX1VMTChpbnRlbF9yYzZfcmVzaWRlbmN5X25zKHJjNiwgcmVn
KSwgMTAwMCk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
YzYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JjNi5oCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNWU2NzExZjM2NDU3Ci0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmM2LmgKQEAgLTAsMCArMSwyNSBAQAor
LyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQKKyAqCisgKiBDb3B5cmlnaHQgwqkg
MjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpZm5kZWYgSU5URUxfUkM2X0gKKyNkZWZp
bmUgSU5URUxfUkM2X0gKKworI2luY2x1ZGUgImk5MTVfcmVnLmgiCisKK3N0cnVjdCBpbnRlbF9l
bmdpbmVfY3M7CitzdHJ1Y3QgaW50ZWxfcmM2OworCit2b2lkIGludGVsX3JjNl9pbml0KHN0cnVj
dCBpbnRlbF9yYzYgKnJjNik7Cit2b2lkIGludGVsX3JjNl9maW5pKHN0cnVjdCBpbnRlbF9yYzYg
KnJjNik7CisKK3ZvaWQgaW50ZWxfcmM2X3Nhbml0aXplKHN0cnVjdCBpbnRlbF9yYzYgKnJjNik7
Cit2b2lkIGludGVsX3JjNl9lbmFibGUoc3RydWN0IGludGVsX3JjNiAqcmM2KTsKK3ZvaWQgaW50
ZWxfcmM2X2Rpc2FibGUoc3RydWN0IGludGVsX3JjNiAqcmM2KTsKKwordTY0IGludGVsX3JjNl9y
ZXNpZGVuY3lfbnMoc3RydWN0IGludGVsX3JjNiAqcmM2LCBpOTE1X3JlZ190IHJlZyk7Cit1NjQg
aW50ZWxfcmM2X3Jlc2lkZW5jeV91cyhzdHJ1Y3QgaW50ZWxfcmM2ICpyYzYsIGk5MTVfcmVnX3Qg
cmVnKTsKKworI2VuZGlmIC8qIElOVEVMX1JDNl9IICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9yYzZfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3JjNl90eXBlcy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAw
MC4uMjE0ZjM1NGQ2YWU0Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfcmM2X3R5cGVzLmgKQEAgLTAsMCArMSwyOCBAQAorLyoKKyAqIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBNSVQKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3Jh
dGlvbgorICovCisKKyNpZm5kZWYgSU5URUxfUkM2X1RZUEVTX0gKKyNkZWZpbmUgSU5URUxfUkM2
X1RZUEVTX0gKKworI2luY2x1ZGUgPGxpbnV4L3NwaW5sb2NrLmg+CisjaW5jbHVkZSA8bGludXgv
dHlwZXMuaD4KKworI2luY2x1ZGUgImludGVsX2VuZ2luZV90eXBlcy5oIgorCitzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdDsKKworc3RydWN0IGludGVsX3JjNiB7CisJdTY0IHByZXZfaHdfcmVz
aWRlbmN5WzRdOworCXU2NCBjdXJfcmVzaWRlbmN5WzRdOworCisJc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKnBjdHg7CisKKwlib29sIHN1cHBvcnRlZCA6IDE7CisJYm9vbCBlbmFibGVkIDog
MTsKKwlib29sIHdha2VyZWYgOiAxOworfTsKKworI2VuZGlmIC8qIElOVEVMX1JDNl9UWVBFU19I
ICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9ndF9wbS5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfZ3RfcG0uYwpuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjg3OTg1YmQ0NjQyMwotLS0gL2Rldi9udWxsCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2d0X3BtLmMKQEAgLTAsMCArMSw1
MCBAQAorCisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENvcHly
aWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworc3RhdGljIGludCBsaXZlX2d0
X3Jlc3VtZSh2b2lkICphcmcpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKKwlJR1Rf
VElNRU9VVChlbmRfdGltZSk7CisJaW50IGVycjsKKworCS8qIERvIHNldmVyYWwgc3VzcGVuZC9y
ZXN1bWUgY3ljbGVzIHRvIGNoZWNrIHdlIGRvbid0IGV4cGxvZGUhICovCisJZG8geworCQlpbnRl
bF9ndF9zdXNwZW5kKGd0KTsKKworCQlpZiAoZ3QtPnJjNi5lbmFibGVkKSB7CisJCQlwcl9lcnIo
InJjNiBzdGlsbCBlbmFibGVkIGFmdGVyIHN1c3BlbmQhXG4iKTsKKwkJCWludGVsX2d0X3NldF93
ZWRnZWRfb25faW5pdChndCk7CisJCQllcnIgPSAtRUlOVkFMOworCQkJYnJlYWs7CisJCX0KKwor
CQllcnIgPSBpbnRlbF9ndF9yZXN1bWUoZ3QpOworCQlpZiAoZXJyKQorCQkJYnJlYWs7CisKKwkJ
aWYgKGd0LT5yYzYuc3VwcG9ydGVkICYmICFndC0+cmM2LmVuYWJsZWQpIHsKKwkJCXByX2Vycigi
cmM2IG5vdCBlbmFibGVkIHVwb24gcmVzdW1lIVxuIik7CisJCQlpbnRlbF9ndF9zZXRfd2VkZ2Vk
X29uX2luaXQoZ3QpOworCQkJZXJyID0gLUVJTlZBTDsKKwkJCWJyZWFrOworCQl9CisJfSB3aGls
ZSAoIV9faWd0X3RpbWVvdXQoZW5kX3RpbWUsIE5VTEwpKTsKKworCXJldHVybiBlcnI7Cit9CisK
K2ludCBpbnRlbF9ndF9wbV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKK3sKKwlzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfc3VidGVzdCB0ZXN0c1tdID0gewor
CQlTVUJURVNUKGxpdmVfZ3RfcmVzdW1lKSwKKwl9OworCisJaWYgKGludGVsX2d0X2lzX3dlZGdl
ZCgmaTkxNS0+Z3QpKQorCQlyZXR1cm4gMDsKKworCXJldHVybiBpbnRlbF9ndF9saXZlX3N1YnRl
c3RzKHRlc3RzLCAmaTkxNS0+Z3QpOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwpp
bmRleCBiNWI0NDlhODhjZjEuLmZlYzlmYjdjYzM4NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
ZWJ1Z2ZzLmMKQEAgLTQyLDYgKzQyLDcgQEAKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fY29udGV4
dC5oIgogI2luY2x1ZGUgImd0L2ludGVsX2d0X3BtLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfcmVz
ZXQuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9yYzYuaCIKICNpbmNsdWRlICJndC91Yy9pbnRlbF9n
dWNfc3VibWlzc2lvbi5oIgogCiAjaW5jbHVkZSAiaTkxNV9kZWJ1Z2ZzLmgiCkBAIC0xMTY4LDEx
ICsxMTY5LDEzIEBAIHN0YXRpYyB2b2lkIHByaW50X3JjNl9yZXMoc3RydWN0IHNlcV9maWxlICpt
LAogCQkJICBjb25zdCBjaGFyICp0aXRsZSwKIAkJCSAgY29uc3QgaTkxNV9yZWdfdCByZWcpCiB7
Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnBy
aXZhdGUpOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0t
PnByaXZhdGUpOworCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCi0Jc2VxX3ByaW50ZihtLCAi
JXMgJXUgKCVsbHUgdXMpXG4iLAotCQkgICB0aXRsZSwgSTkxNV9SRUFEKHJlZyksCi0JCSAgIGlu
dGVsX3JjNl9yZXNpZGVuY3lfdXMoZGV2X3ByaXYsIHJlZykpOworCXdpdGhfaW50ZWxfcnVudGlt
ZV9wbSgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZikKKwkJc2VxX3ByaW50ZihtLCAiJXMgJXUg
KCVsbHUgdXMpXG4iLCB0aXRsZSwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKCZpOTE1LT51bmNv
cmUsIHJlZyksCisJCQkgICBpbnRlbF9yYzZfcmVzaWRlbmN5X3VzKCZpOTE1LT5ndC5yYzYsIHJl
ZykpOwogfQogCiBzdGF0aWMgaW50IHZsdl9kcnBjX2luZm8oc3RydWN0IHNlcV9maWxlICptKQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZHJ2LmgKaW5kZXggYjNjN2RiYzE4MzJhLi4wZTRlNzczNzNlZTUgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtNTk5LDE5ICs1OTksMTIgQEAgc3RydWN0IGludGVs
X3JwcyB7CiAJc3RydWN0IGludGVsX3Jwc19laSBlaTsKIH07CiAKLXN0cnVjdCBpbnRlbF9yYzYg
ewotCWJvb2wgZW5hYmxlZDsKLQl1NjQgcHJldl9od19yZXNpZGVuY3lbNF07Ci0JdTY0IGN1cl9y
ZXNpZGVuY3lbNF07Ci19OwotCiBzdHJ1Y3QgaW50ZWxfbGxjX3BzdGF0ZSB7CiAJYm9vbCBlbmFi
bGVkOwogfTsKIAogc3RydWN0IGludGVsX2dlbjZfcG93ZXJfbWdtdCB7CiAJc3RydWN0IGludGVs
X3JwcyBycHM7Ci0Jc3RydWN0IGludGVsX3JjNiByYzY7CiAJc3RydWN0IGludGVsX2xsY19wc3Rh
dGUgbGxjX3BzdGF0ZTsKIH07CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfcG11LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jCmluZGV4IDMzMTAzNTM4
OTBmYi4uZDA1MDg3MTk0OTJlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3BtdS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMKQEAgLTExLDYgKzEx
LDcgQEAKICNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmVfcG0uaCIKICNpbmNsdWRlICJndC9pbnRl
bF9lbmdpbmVfdXNlci5oIgogI2luY2x1ZGUgImd0L2ludGVsX2d0X3BtLmgiCisjaW5jbHVkZSAi
Z3QvaW50ZWxfcmM2LmgiCiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgogI2luY2x1ZGUgImk5MTVf
cG11LmgiCkBAIC0xMTYsMjEgKzExNywyMSBAQCBzdGF0aWMgYm9vbCBwbXVfbmVlZHNfdGltZXIo
c3RydWN0IGk5MTVfcG11ICpwbXUsIGJvb2wgZ3B1X2FjdGl2ZSkKIAlyZXR1cm4gZW5hYmxlOwog
fQogCi1zdGF0aWMgdTY0IF9fZ2V0X3JjNihjb25zdCBzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQorc3Rh
dGljIHU2NCBfX2dldF9yYzYoc3RydWN0IGludGVsX2d0ICpndCkKIHsKIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1OwogCXU2NCB2YWw7CiAKLQl2YWwgPSBpbnRlbF9y
YzZfcmVzaWRlbmN5X25zKGk5MTUsCisJdmFsID0gaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucygmZ3Qt
PnJjNiwKIAkJCQkgICAgIElTX1ZBTExFWVZJRVcoaTkxNSkgPwogCQkJCSAgICAgVkxWX0dUX1JF
TkRFUl9SQzYgOgogCQkJCSAgICAgR0VONl9HVF9HRlhfUkM2KTsKIAogCWlmIChIQVNfUkM2cChp
OTE1KSkKLQkJdmFsICs9IGludGVsX3JjNl9yZXNpZGVuY3lfbnMoaTkxNSwgR0VONl9HVF9HRlhf
UkM2cCk7CisJCXZhbCArPSBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKCZndC0+cmM2LCBHRU42X0dU
X0dGWF9SQzZwKTsKIAogCWlmIChIQVNfUkM2cHAoaTkxNSkpCi0JCXZhbCArPSBpbnRlbF9yYzZf
cmVzaWRlbmN5X25zKGk5MTUsIEdFTjZfR1RfR0ZYX1JDNnBwKTsKKwkJdmFsICs9IGludGVsX3Jj
Nl9yZXNpZGVuY3lfbnMoJmd0LT5yYzYsIEdFTjZfR1RfR0ZYX1JDNnBwKTsKIAogCXJldHVybiB2
YWw7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMKaW5kZXggZDhhM2IxODBjMDg0Li4wMzRi
OGFiYzUwNjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2ZzLmMKQEAgLTMwLDYgKzMwLDggQEAK
ICNpbmNsdWRlIDxsaW51eC9zdGF0Lmg+CiAjaW5jbHVkZSA8bGludXgvc3lzZnMuaD4KIAorI2lu
Y2x1ZGUgImd0L2ludGVsX3JjNi5oIgorCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRl
ICJpOTE1X3N5c2ZzLmgiCiAjaW5jbHVkZSAiaW50ZWxfcG0uaCIKQEAgLTQ5LDcgKzUxLDcgQEAg
c3RhdGljIHUzMiBjYWxjX3Jlc2lkZW5jeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCiAJdTY0IHJlcyA9IDA7CiAKIAl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmRldl9wcml2LT5y
dW50aW1lX3BtLCB3YWtlcmVmKQotCQlyZXMgPSBpbnRlbF9yYzZfcmVzaWRlbmN5X3VzKGRldl9w
cml2LCByZWcpOworCQlyZXMgPSBpbnRlbF9yYzZfcmVzaWRlbmN5X3VzKCZkZXZfcHJpdi0+Z3Qu
cmM2LCByZWcpOwogCiAJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUX1VMTChyZXMsIDEwMDApOwog
fQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX3BtLmMKaW5kZXggNmJlZDJlZDE0NTc0Li5iZmNmMDNhYjUyNDUg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwpAQCAtNDUsMjYgKzQ1LDYgQEAKICNpbmNsdWRlICJp
bnRlbF9zaWRlYmFuZC5oIgogI2luY2x1ZGUgIi4uLy4uLy4uL3BsYXRmb3JtL3g4Ni9pbnRlbF9p
cHMuaCIKIAotLyoqCi0gKiBET0M6IFJDNgotICoKLSAqIFJDNiBpcyBhIHNwZWNpYWwgcG93ZXIg
c3RhZ2Ugd2hpY2ggYWxsb3dzIHRoZSBHUFUgdG8gZW50ZXIgYW4gdmVyeQotICogbG93LXZvbHRh
Z2UgbW9kZSB3aGVuIGlkbGUsIHVzaW5nIGRvd24gdG8gMFYgd2hpbGUgYXQgdGhpcyBzdGFnZS4g
IFRoaXMKLSAqIHN0YWdlIGlzIGVudGVyZWQgYXV0b21hdGljYWxseSB3aGVuIHRoZSBHUFUgaXMg
aWRsZSB3aGVuIFJDNiBzdXBwb3J0IGlzCi0gKiBlbmFibGVkLCBhbmQgYXMgc29vbiBhcyBuZXcg
d29ya2xvYWQgYXJpc2VzIEdQVSB3YWtlcyB1cCBhdXRvbWF0aWNhbGx5IGFzIHdlbGwuCi0gKgot
ICogVGhlcmUgYXJlIGRpZmZlcmVudCBSQzYgbW9kZXMgYXZhaWxhYmxlIGluIEludGVsIEdQVSwg
d2hpY2ggZGlmZmVyZW50aWF0ZQotICogYW1vbmcgZWFjaCBvdGhlciB3aXRoIHRoZSBsYXRlbmN5
IHJlcXVpcmVkIHRvIGVudGVyIGFuZCBsZWF2ZSBSQzYgYW5kCi0gKiB2b2x0YWdlIGNvbnN1bWVk
IGJ5IHRoZSBHUFUgaW4gZGlmZmVyZW50IHN0YXRlcy4KLSAqCi0gKiBUaGUgY29tYmluYXRpb24g
b2YgdGhlIGZvbGxvd2luZyBmbGFncyBkZWZpbmUgd2hpY2ggc3RhdGVzIEdQVSBpcyBhbGxvd2Vk
Ci0gKiB0byBlbnRlciwgd2hpbGUgUkM2IGlzIHRoZSBub3JtYWwgUkM2IHN0YXRlLCBSQzZwIGlz
IHRoZSBkZWVwIFJDNiwgYW5kCi0gKiBSQzZwcCBpcyBkZWVwZXN0IFJDNi4gVGhlaXIgc3VwcG9y
dCBieSBoYXJkd2FyZSB2YXJpZXMgYWNjb3JkaW5nIHRvIHRoZQotICogR1BVLCBCSU9TLCBjaGlw
c2V0IGFuZCBwbGF0Zm9ybS4gUkM2IGlzIHVzdWFsbHkgdGhlIHNhZmVzdCBvbmUgYW5kIHRoZSBv
bmUKLSAqIHdoaWNoIGJyaW5ncyB0aGUgbW9zdCBwb3dlciBzYXZpbmdzOyBkZWVwZXIgc3RhdGVz
IHNhdmUgbW9yZSBwb3dlciwgYnV0Ci0gKiByZXF1aXJlIGhpZ2hlciBsYXRlbmN5IHRvIHN3aXRj
aCB0byBhbmQgd2FrZSB1cC4KLSAqLwotCiBzdGF0aWMgdm9pZCBnZW45X2luaXRfY2xvY2tfZ2F0
aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAlpZiAoSEFTX0xMQyhk
ZXZfcHJpdikpIHsKQEAgLTY5MTgsMTQyICs2ODk4LDI3IEBAIGludCBpbnRlbF9zZXRfcnBzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTggdmFsKQogCXJldHVybiBlcnI7CiB9
CiAKLXN0YXRpYyB2b2lkIGdlbjlfZGlzYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQotewotCUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLCAwKTsKLQlJOTE1X1dS
SVRFKEdFTjlfUEdfRU5BQkxFLCAwKTsKLX0KLQogc3RhdGljIHZvaWQgZ2VuOV9kaXNhYmxlX3Jw
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJSTkxNV9XUklURShHRU42
X1JQX0NPTlRST0wsIDApOwogfQogCi1zdGF0aWMgdm9pZCBnZW42X2Rpc2FibGVfcmM2KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlJOTE1X1dSSVRFKEdFTjZfUkNfQ09O
VFJPTCwgMCk7Ci19Ci0KIHN0YXRpYyB2b2lkIGdlbjZfZGlzYWJsZV9ycHMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCUk5MTVfV1JJVEUoR0VONl9SUE5TV1JFUSwgMSA8
PCAzMSk7CiAJSTkxNV9XUklURShHRU42X1JQX0NPTlRST0wsIDApOwogfQogCi1zdGF0aWMgdm9p
ZCBjaGVycnl2aWV3X2Rpc2FibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKLXsKLQlJOTE1X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwgMCk7Ci19Ci0KIHN0YXRpYyB2b2lk
IGNoZXJyeXZpZXdfZGlzYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQogewogCUk5MTVfV1JJVEUoR0VONl9SUF9DT05UUk9MLCAwKTsKIH0KIAotc3RhdGljIHZvaWQg
dmFsbGV5dmlld19kaXNhYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Ci17Ci0JLyogV2UncmUgZG9pbmcgZm9yY2V3YWtlIGJlZm9yZSBEaXNhYmxpbmcgUkM2LAotCSAq
IFRoaXMgd2hhdCB0aGUgQklPUyBleHBlY3RzIHdoZW4gZ29pbmcgaW50byBzdXNwZW5kICovCi0J
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9B
TEwpOwotCi0JSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsIDApOwotCi0JaW50ZWxfdW5jb3Jl
X2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCiBz
dGF0aWMgdm9pZCB2YWxsZXl2aWV3X2Rpc2FibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKIHsKIAlJOTE1X1dSSVRFKEdFTjZfUlBfQ09OVFJPTCwgMCk7CiB9CiAKLXN0
YXRpYyBib29sIGJ4dF9jaGVja19iaW9zX3JjNl9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCi17Ci0JYm9vbCBlbmFibGVfcmM2ID0gdHJ1ZTsKLQl1bnNpZ25lZCBsb25n
IHJjNl9jdHhfYmFzZTsKLQl1MzIgcmNfY3RsOwotCWludCByY19zd190YXJnZXQ7Ci0KLQlyY19j
dGwgPSBJOTE1X1JFQUQoR0VONl9SQ19DT05UUk9MKTsKLQlyY19zd190YXJnZXQgPSAoSTkxNV9S
RUFEKEdFTjZfUkNfU1RBVEUpICYgUkNfU1dfVEFSR0VUX1NUQVRFX01BU0spID4+Ci0JCSAgICAg
ICBSQ19TV19UQVJHRVRfU1RBVEVfU0hJRlQ7Ci0JRFJNX0RFQlVHX0RSSVZFUigiQklPUyBlbmFi
bGVkIFJDIHN0YXRlczogIgotCQkJICJIV19DVFJMICVzIEhXX1JDNiAlcyBTV19UQVJHRVRfU1RB
VEUgJXhcbiIsCi0JCQkgb25vZmYocmNfY3RsICYgR0VONl9SQ19DVExfSFdfRU5BQkxFKSwKLQkJ
CSBvbm9mZihyY19jdGwgJiBHRU42X1JDX0NUTF9SQzZfRU5BQkxFKSwKLQkJCSByY19zd190YXJn
ZXQpOwotCi0JaWYgKCEoSTkxNV9SRUFEKFJDNl9MT0NBVElPTikgJiBSQzZfQ1RYX0lOX0RSQU0p
KSB7Ci0JCURSTV9ERUJVR19EUklWRVIoIlJDNiBCYXNlIGxvY2F0aW9uIG5vdCBzZXQgcHJvcGVy
bHkuXG4iKTsKLQkJZW5hYmxlX3JjNiA9IGZhbHNlOwotCX0KLQotCS8qCi0JICogVGhlIGV4YWN0
IGNvbnRleHQgc2l6ZSBpcyBub3Qga25vd24gZm9yIEJYVCwgc28gYXNzdW1lIGEgcGFnZSBzaXpl
Ci0JICogZm9yIHRoaXMgY2hlY2suCi0JICovCi0JcmM2X2N0eF9iYXNlID0gSTkxNV9SRUFEKFJD
Nl9DVFhfQkFTRSkgJiBSQzZfQ1RYX0JBU0VfTUFTSzsKLQlpZiAoISgocmM2X2N0eF9iYXNlID49
IGRldl9wcml2LT5kc21fcmVzZXJ2ZWQuc3RhcnQpICYmCi0JICAgICAgKHJjNl9jdHhfYmFzZSAr
IFBBR0VfU0laRSA8IGRldl9wcml2LT5kc21fcmVzZXJ2ZWQuZW5kKSkpIHsKLQkJRFJNX0RFQlVH
X0RSSVZFUigiUkM2IEJhc2UgYWRkcmVzcyBub3QgYXMgZXhwZWN0ZWQuXG4iKTsKLQkJZW5hYmxl
X3JjNiA9IGZhbHNlOwotCX0KLQotCWlmICghKCgoSTkxNV9SRUFEKFBXUkNUWF9NQVhDTlRfUkNT
VU5JVCkgJiBJRExFX1RJTUVfTUFTSykgPiAxKSAmJgotCSAgICAgICgoSTkxNV9SRUFEKFBXUkNU
WF9NQVhDTlRfVkNTVU5JVDApICYgSURMRV9USU1FX01BU0spID4gMSkgJiYKLQkgICAgICAoKEk5
MTVfUkVBRChQV1JDVFhfTUFYQ05UX0JDU1VOSVQpICYgSURMRV9USU1FX01BU0spID4gMSkgJiYK
LQkgICAgICAoKEk5MTVfUkVBRChQV1JDVFhfTUFYQ05UX1ZFQ1NVTklUKSAmIElETEVfVElNRV9N
QVNLKSA+IDEpKSkgewotCQlEUk1fREVCVUdfRFJJVkVSKCJFbmdpbmUgSWRsZSB3YWl0IHRpbWUg
bm90IHNldCBwcm9wZXJseS5cbiIpOwotCQllbmFibGVfcmM2ID0gZmFsc2U7Ci0JfQotCi0JaWYg
KCFJOTE1X1JFQUQoR0VOOF9QVVNIQlVTX0NPTlRST0wpIHx8Ci0JICAgICFJOTE1X1JFQUQoR0VO
OF9QVVNIQlVTX0VOQUJMRSkgfHwKLQkgICAgIUk5MTVfUkVBRChHRU44X1BVU0hCVVNfU0hJRlQp
KSB7Ci0JCURSTV9ERUJVR19EUklWRVIoIlB1c2hidXMgbm90IHNldHVwIHByb3Blcmx5LlxuIik7
Ci0JCWVuYWJsZV9yYzYgPSBmYWxzZTsKLQl9Ci0KLQlpZiAoIUk5MTVfUkVBRChHRU42X0dGWFBB
VVNFKSkgewotCQlEUk1fREVCVUdfRFJJVkVSKCJHRlggcGF1c2Ugbm90IHNldHVwIHByb3Blcmx5
LlxuIik7Ci0JCWVuYWJsZV9yYzYgPSBmYWxzZTsKLQl9Ci0KLQlpZiAoIUk5MTVfUkVBRChHRU44
X01JU0NfQ1RSTDApKSB7Ci0JCURSTV9ERUJVR19EUklWRVIoIkdQTSBjb250cm9sIG5vdCBzZXR1
cCBwcm9wZXJseS5cbiIpOwotCQllbmFibGVfcmM2ID0gZmFsc2U7Ci0JfQotCi0JcmV0dXJuIGVu
YWJsZV9yYzY7Ci19Ci0KLXN0YXRpYyBib29sIHNhbml0aXplX3JjNihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKLXsKLQlzdHJ1Y3QgaW50ZWxfZGV2aWNlX2luZm8gKmluZm8gPSBta3dy
aXRlX2RldmljZV9pbmZvKGk5MTUpOwotCi0JLyogUG93ZXJzYXZpbmcgaXMgY29udHJvbGxlZCBi
eSB0aGUgaG9zdCB3aGVuIGluc2lkZSBhIFZNICovCi0JaWYgKGludGVsX3ZncHVfYWN0aXZlKGk5
MTUpKSB7Ci0JCWluZm8tPmhhc19yYzYgPSAwOwotCQlpbmZvLT5oYXNfcnBzID0gZmFsc2U7Ci0J
fQotCi0JaWYgKGluZm8tPmhhc19yYzYgJiYKLQkgICAgSVNfR0VOOV9MUChpOTE1KSAmJiAhYnh0
X2NoZWNrX2Jpb3NfcmM2X3NldHVwKGk5MTUpKSB7Ci0JCURSTV9JTkZPKCJSQzYgZGlzYWJsZWQg
YnkgQklPU1xuIik7Ci0JCWluZm8tPmhhc19yYzYgPSAwOwotCX0KLQotCS8qCi0JICogV2UgYXNz
dW1lIHRoYXQgd2UgZG8gbm90IGhhdmUgYW55IGRlZXAgcmM2IGxldmVscyBpZiB3ZSBkb24ndCBo
YXZlCi0JICogaGF2ZSB0aGUgcHJldmlvdXMgcmM2IGxldmVsIHN1cHBvcnRlZCwgaS5lLiB3ZSB1
c2UgSEFTX1JDNigpCi0JICogYXMgdGhlIGluaXRpYWwgY29hcnNlIGNoZWNrIGZvciByYzYgaW4g
Z2VuZXJhbCwgbW92aW5nIG9uIHRvCi0JICogcHJvZ3Jlc3NpdmVseSBmaW5lci9kZWVwZXIgbGV2
ZWxzLgotCSAqLwotCWlmICghaW5mby0+aGFzX3JjNiAmJiBpbmZvLT5oYXNfcmM2cCkKLQkJaW5m
by0+aGFzX3JjNnAgPSAwOwotCi0JcmV0dXJuIGluZm8tPmhhc19yYzY7Ci19Ci0KIHN0YXRpYyB2
b2lkIGdlbjZfaW5pdF9ycHNfZnJlcXVlbmNpZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQogewogCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBz
OwpAQCAtNzE0MCwyMDMgKzcwMDUsNiBAQCBzdGF0aWMgdm9pZCBnZW45X2VuYWJsZV9ycHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWludGVsX3VuY29yZV9mb3JjZXdha2Vf
cHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIH0KIAotc3RhdGljIHZvaWQg
Z2VuMTFfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0J
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlk
OwotCi0JLyogMWE6IFNvZnR3YXJlIFJDIHN0YXRlIC0gUkMwICovCi0JSTkxNV9XUklURShHRU42
X1JDX1NUQVRFLCAwKTsKLQotCS8qCi0JICogMWI6IEdldCBmb3JjZXdha2UgZHVyaW5nIHByb2dy
YW0gc2VxdWVuY2UuIEFsdGhvdWdoIHRoZSBkcml2ZXIKLQkgKiBoYXNuJ3QgZW5hYmxlZCBhIHN0
YXRlIHlldCB3aGVyZSB3ZSBuZWVkIGZvcmNld2FrZSwgQklPUyBtYXkgaGF2ZS4KLQkgKi8KLQlp
bnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FM
TCk7Ci0KLQkvKiAyYTogRGlzYWJsZSBSQyBzdGF0ZXMuICovCi0JSTkxNV9XUklURShHRU42X1JD
X0NPTlRST0wsIDApOwotCi0JLyogMmI6IFByb2dyYW0gUkM2IHRocmVzaG9sZHMuKi8KLQlJOTE1
X1dSSVRFKEdFTjZfUkM2X1dBS0VfUkFURV9MSU1JVCwgNTQgPDwgMTYgfCA4NSk7Ci0JSTkxNV9X
UklURShHRU4xMF9NRURJQV9XQUtFX1JBVEVfTElNSVQsIDE1MCk7Ci0KLQlJOTE1X1dSSVRFKEdF
TjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsgLyogMTI1MDAgKiAxMjgwbnMgKi8K
LQlJOTE1X1dSSVRFKEdFTjZfUkNfSURMRV9IWVNURVJTSVMsIDI1KTsgLyogMjUgKiAxMjgwbnMg
Ki8KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQpCi0JCUk5MTVfV1JJVEUo
UklOR19NQVhfSURMRShlbmdpbmUtPm1taW9fYmFzZSksIDEwKTsKLQotCWlmIChIQVNfR1RfVUMo
ZGV2X3ByaXYpKQotCQlJOTE1X1dSSVRFKEdVQ19NQVhfSURMRV9DT1VOVCwgMHhBKTsKLQotCUk5
MTVfV1JJVEUoR0VONl9SQ19TTEVFUCwgMCk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUkM2X1RIUkVT
SE9MRCwgNTAwMDApOyAvKiA1MC8xMjVtcyBwZXIgRUkgKi8KLQotCS8qCi0JICogMmM6IFByb2dy
YW0gQ29hcnNlIFBvd2VyIEdhdGluZyBQb2xpY2llcy4KLQkgKgotCSAqIEJzcGVjJ3MgZ3VpZGFu
Y2UgaXMgdG8gdXNlIDI1dXMgKHJlYWxseSAyNSAqIDEyODBucykgaGVyZS4gV2hhdCB3ZQotCSAq
IHVzZSBpbnN0ZWFkIGlzIGEgbW9yZSBjb25zZXJ2YXRpdmUgZXN0aW1hdGUgZm9yIHRoZSBtYXhp
bXVtIHRpbWUKLQkgKiBpdCB0YWtlcyB1cyB0byBzZXJ2aWNlIGEgQ1MgaW50ZXJydXB0IGFuZCBz
dWJtaXQgYSBuZXcgRUxTUCAtIHRoYXQKLQkgKiBpcyB0aGUgdGltZSB3aGljaCB0aGUgR1BVIGlz
IGlkbGUgd2FpdGluZyBmb3IgdGhlIENQVSB0byBzZWxlY3QgdGhlCi0JICogbmV4dCByZXF1ZXN0
IHRvIGV4ZWN1dGUuIElmIHRoZSBpZGxlIGh5c3RlcmVzaXMgaXMgbGVzcyB0aGFuIHRoYXQKLQkg
KiBpbnRlcnJ1cHQgc2VydmljZSBsYXRlbmN5LCB0aGUgaGFyZHdhcmUgd2lsbCBhdXRvbWF0aWNh
bGx5IGdhdGUKLQkgKiB0aGUgcG93ZXIgd2VsbCBhbmQgd2Ugd2lsbCB0aGVuIGluY3VyIHRoZSB3
YWtlIHVwIGNvc3Qgb24gdG9wIG9mCi0JICogdGhlIHNlcnZpY2UgbGF0ZW5jeS4gQSBzaW1pbGFy
IGd1aWRlIGZyb20gcGxhbmVfc3RhdGUgaXMgdGhhdCB3ZQotCSAqIGRvIG5vdCB3YW50IHRoZSBl
bmFibGUgaHlzdGVyZXNpcyB0byBsZXNzIHRoYW4gdGhlIHdha2V1cCBsYXRlbmN5LgotCSAqCi0J
ICogaWd0L2dlbV9leGVjX25vcC9zZXF1ZW50aWFsIHByb3ZpZGVzIGEgcm91Z2ggZXN0aW1hdGUg
Zm9yIHRoZQotCSAqIHNlcnZpY2UgbGF0ZW5jeSwgYW5kIHB1dHMgaXQgYXJvdW5kIDEwdXMgZm9y
IEJyb2Fkd2VsbCAoYW5kIG90aGVyCi0JICogYmlnIGNvcmUpIGFuZCBhcm91bmQgNDB1cyBmb3Ig
QnJveHRvbiAoYW5kIG90aGVyIGxvdyBwb3dlciBjb3JlcykuCi0JICogW05vdGUgdGhhdCBmb3Ig
bGVnYWN5IHJpbmdidWZmZXIgc3VibWlzc2lvbiwgdGhpcyBpcyBsZXNzIHRoYW4gMXVzIV0KLQkg
KiBIb3dldmVyLCB0aGUgd2FrZXVwIGxhdGVuY3kgb24gQnJveHRvbiBpcyBjbG9zZXIgdG8gMTAw
dXMuIFRvIGJlCi0JICogY29uc2VydmF0aXZlLCB3ZSBoYXZlIHRvIGZhY3RvciBpbiBhIGNvbnRl
eHQgc3dpdGNoIG9uIHRvcCAoZHVlCi0JICogdG8ga3NvZnRpcnFkKS4KLQkgKi8KLQlJOTE1X1dS
SVRFKEdFTjlfTUVESUFfUEdfSURMRV9IWVNURVJFU0lTLCAyNTApOwotCUk5MTVfV1JJVEUoR0VO
OV9SRU5ERVJfUEdfSURMRV9IWVNURVJFU0lTLCAyNTApOwotCi0JLyogM2E6IEVuYWJsZSBSQzYg
Ki8KLQlJOTE1X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwKLQkJICAgR0VONl9SQ19DVExfSFdfRU5B
QkxFIHwKLQkJICAgR0VONl9SQ19DVExfUkM2X0VOQUJMRSB8Ci0JCSAgIEdFTjZfUkNfQ1RMX0VJ
X01PREUoMSkpOwotCi0JLyogM2I6IEVuYWJsZSBDb2Fyc2UgUG93ZXIgR2F0aW5nIG9ubHkgd2hl
biBSQzYgaXMgZW5hYmxlZC4gKi8KLQlJOTE1X1dSSVRFKEdFTjlfUEdfRU5BQkxFLAotCQkgICBH
RU45X1JFTkRFUl9QR19FTkFCTEUgfAotCQkgICBHRU45X01FRElBX1BHX0VOQUJMRSB8Ci0JCSAg
IEdFTjExX01FRElBX1NBTVBMRVJfUEdfRU5BQkxFKTsKLQotCWludGVsX3VuY29yZV9mb3JjZXdh
a2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLX0KLQotc3RhdGljIHZv
aWQgZ2VuOV9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsK
LQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQg
aWQ7Ci0JdTMyIHJjNl9tb2RlOwotCi0JLyogMWE6IFNvZnR3YXJlIFJDIHN0YXRlIC0gUkMwICov
Ci0JSTkxNV9XUklURShHRU42X1JDX1NUQVRFLCAwKTsKLQotCS8qIDFiOiBHZXQgZm9yY2V3YWtl
IGR1cmluZyBwcm9ncmFtIHNlcXVlbmNlLiBBbHRob3VnaCB0aGUgZHJpdmVyCi0JICogaGFzbid0
IGVuYWJsZWQgYSBzdGF0ZSB5ZXQgd2hlcmUgd2UgbmVlZCBmb3JjZXdha2UsIEJJT1MgbWF5IGhh
dmUuKi8KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9S
Q0VXQUtFX0FMTCk7Ci0KLQkvKiAyYTogRGlzYWJsZSBSQyBzdGF0ZXMuICovCi0JSTkxNV9XUklU
RShHRU42X1JDX0NPTlRST0wsIDApOwotCi0JLyogMmI6IFByb2dyYW0gUkM2IHRocmVzaG9sZHMu
Ki8KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCkgewotCQlJOTE1X1dSSVRFKEdFTjZf
UkM2X1dBS0VfUkFURV9MSU1JVCwgNTQgPDwgMTYgfCA4NSk7Ci0JCUk5MTVfV1JJVEUoR0VOMTBf
TUVESUFfV0FLRV9SQVRFX0xJTUlULCAxNTApOwotCX0gZWxzZSBpZiAoSVNfU0tZTEFLRShkZXZf
cHJpdikpIHsKLQkJLyoKLQkJICogV2FSc0RvdWJsZVJjNldybFdpdGhDb2Fyc2VQb3dlckdhdGlu
Zzpza2wgRG91YmxpbmcgV1JMIG9ubHkKLQkJICogd2hlbiBDUEcgaXMgZW5hYmxlZAotCQkgKi8K
LQkJSTkxNV9XUklURShHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDEwOCA8PCAxNik7Ci0JfSBl
bHNlIHsKLQkJSTkxNV9XUklURShHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDU0IDw8IDE2KTsK
LQl9Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsg
LyogMTI1MDAgKiAxMjgwbnMgKi8KLQlJOTE1X1dSSVRFKEdFTjZfUkNfSURMRV9IWVNURVJTSVMs
IDI1KTsgLyogMjUgKiAxMjgwbnMgKi8KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJp
diwgaWQpCi0JCUk5MTVfV1JJVEUoUklOR19NQVhfSURMRShlbmdpbmUtPm1taW9fYmFzZSksIDEw
KTsKLQotCWlmIChIQVNfR1RfVUMoZGV2X3ByaXYpKQotCQlJOTE1X1dSSVRFKEdVQ19NQVhfSURM
RV9DT1VOVCwgMHhBKTsKLQotCUk5MTVfV1JJVEUoR0VONl9SQ19TTEVFUCwgMCk7Ci0KLQkvKgot
CSAqIDJjOiBQcm9ncmFtIENvYXJzZSBQb3dlciBHYXRpbmcgUG9saWNpZXMuCi0JICoKLQkgKiBC
c3BlYydzIGd1aWRhbmNlIGlzIHRvIHVzZSAyNXVzIChyZWFsbHkgMjUgKiAxMjgwbnMpIGhlcmUu
IFdoYXQgd2UKLQkgKiB1c2UgaW5zdGVhZCBpcyBhIG1vcmUgY29uc2VydmF0aXZlIGVzdGltYXRl
IGZvciB0aGUgbWF4aW11bSB0aW1lCi0JICogaXQgdGFrZXMgdXMgdG8gc2VydmljZSBhIENTIGlu
dGVycnVwdCBhbmQgc3VibWl0IGEgbmV3IEVMU1AgLSB0aGF0Ci0JICogaXMgdGhlIHRpbWUgd2hp
Y2ggdGhlIEdQVSBpcyBpZGxlIHdhaXRpbmcgZm9yIHRoZSBDUFUgdG8gc2VsZWN0IHRoZQotCSAq
IG5leHQgcmVxdWVzdCB0byBleGVjdXRlLiBJZiB0aGUgaWRsZSBoeXN0ZXJlc2lzIGlzIGxlc3Mg
dGhhbiB0aGF0Ci0JICogaW50ZXJydXB0IHNlcnZpY2UgbGF0ZW5jeSwgdGhlIGhhcmR3YXJlIHdp
bGwgYXV0b21hdGljYWxseSBnYXRlCi0JICogdGhlIHBvd2VyIHdlbGwgYW5kIHdlIHdpbGwgdGhl
biBpbmN1ciB0aGUgd2FrZSB1cCBjb3N0IG9uIHRvcCBvZgotCSAqIHRoZSBzZXJ2aWNlIGxhdGVu
Y3kuIEEgc2ltaWxhciBndWlkZSBmcm9tIHBsYW5lX3N0YXRlIGlzIHRoYXQgd2UKLQkgKiBkbyBu
b3Qgd2FudCB0aGUgZW5hYmxlIGh5c3RlcmVzaXMgdG8gbGVzcyB0aGFuIHRoZSB3YWtldXAgbGF0
ZW5jeS4KLQkgKgotCSAqIGlndC9nZW1fZXhlY19ub3Avc2VxdWVudGlhbCBwcm92aWRlcyBhIHJv
dWdoIGVzdGltYXRlIGZvciB0aGUKLQkgKiBzZXJ2aWNlIGxhdGVuY3ksIGFuZCBwdXRzIGl0IGFy
b3VuZCAxMHVzIGZvciBCcm9hZHdlbGwgKGFuZCBvdGhlcgotCSAqIGJpZyBjb3JlKSBhbmQgYXJv
dW5kIDQwdXMgZm9yIEJyb3h0b24gKGFuZCBvdGhlciBsb3cgcG93ZXIgY29yZXMpLgotCSAqIFtO
b3RlIHRoYXQgZm9yIGxlZ2FjeSByaW5nYnVmZmVyIHN1Ym1pc3Npb24sIHRoaXMgaXMgbGVzcyB0
aGFuIDF1cyFdCi0JICogSG93ZXZlciwgdGhlIHdha2V1cCBsYXRlbmN5IG9uIEJyb3h0b24gaXMg
Y2xvc2VyIHRvIDEwMHVzLiBUbyBiZQotCSAqIGNvbnNlcnZhdGl2ZSwgd2UgaGF2ZSB0byBmYWN0
b3IgaW4gYSBjb250ZXh0IHN3aXRjaCBvbiB0b3AgKGR1ZQotCSAqIHRvIGtzb2Z0aXJxZCkuCi0J
ICovCi0JSTkxNV9XUklURShHRU45X01FRElBX1BHX0lETEVfSFlTVEVSRVNJUywgMjUwKTsKLQlJ
OTE1X1dSSVRFKEdFTjlfUkVOREVSX1BHX0lETEVfSFlTVEVSRVNJUywgMjUwKTsKLQotCS8qIDNh
OiBFbmFibGUgUkM2ICovCi0JSTkxNV9XUklURShHRU42X1JDNl9USFJFU0hPTEQsIDM3NTAwKTsg
LyogMzcuNS8xMjVtcyBwZXIgRUkgKi8KLQotCS8qIFdhUnNVc2VUaW1lb3V0TW9kZTpjbmwgKHBy
ZS1wcm9kKSAqLwotCWlmIChJU19DTkxfUkVWSUQoZGV2X3ByaXYsIENOTF9SRVZJRF9BMCwgQ05M
X1JFVklEX0MwKSkKLQkJcmM2X21vZGUgPSBHRU43X1JDX0NUTF9UT19NT0RFOwotCWVsc2UKLQkJ
cmM2X21vZGUgPSBHRU42X1JDX0NUTF9FSV9NT0RFKDEpOwotCi0JSTkxNV9XUklURShHRU42X1JD
X0NPTlRST0wsCi0JCSAgIEdFTjZfUkNfQ1RMX0hXX0VOQUJMRSB8Ci0JCSAgIEdFTjZfUkNfQ1RM
X1JDNl9FTkFCTEUgfAotCQkgICByYzZfbW9kZSk7Ci0KLQkvKgotCSAqIDNiOiBFbmFibGUgQ29h
cnNlIFBvd2VyIEdhdGluZyBvbmx5IHdoZW4gUkM2IGlzIGVuYWJsZWQuCi0JICogV2FSc0Rpc2Fi
bGVDb2Fyc2VQb3dlckdhdGluZzpza2wsY25sIC0gUmVuZGVyL01lZGlhIFBHIG5lZWQgdG8gYmUg
ZGlzYWJsZWQgd2l0aCBSQzYuCi0JICovCi0JaWYgKE5FRURTX1dhUnNEaXNhYmxlQ29hcnNlUG93
ZXJHYXRpbmcoZGV2X3ByaXYpKQotCQlJOTE1X1dSSVRFKEdFTjlfUEdfRU5BQkxFLCAwKTsKLQll
bHNlCi0JCUk5MTVfV1JJVEUoR0VOOV9QR19FTkFCTEUsCi0JCQkgICBHRU45X1JFTkRFUl9QR19F
TkFCTEUgfCBHRU45X01FRElBX1BHX0VOQUJMRSk7Ci0KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtl
X3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci19Ci0KLXN0YXRpYyB2b2lk
IGdlbjhfZW5hYmxlX3JjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0J
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlk
OwotCi0JLyogMWE6IFNvZnR3YXJlIFJDIHN0YXRlIC0gUkMwICovCi0JSTkxNV9XUklURShHRU42
X1JDX1NUQVRFLCAwKTsKLQotCS8qIDFiOiBHZXQgZm9yY2V3YWtlIGR1cmluZyBwcm9ncmFtIHNl
cXVlbmNlLiBBbHRob3VnaCB0aGUgZHJpdmVyCi0JICogaGFzbid0IGVuYWJsZWQgYSBzdGF0ZSB5
ZXQgd2hlcmUgd2UgbmVlZCBmb3JjZXdha2UsIEJJT1MgbWF5IGhhdmUuKi8KLQlpbnRlbF91bmNv
cmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci0KLQkv
KiAyYTogRGlzYWJsZSBSQyBzdGF0ZXMuICovCi0JSTkxNV9XUklURShHRU42X1JDX0NPTlRST0ws
IDApOwotCi0JLyogMmI6IFByb2dyYW0gUkM2IHRocmVzaG9sZHMuKi8KLQlJOTE1X1dSSVRFKEdF
TjZfUkM2X1dBS0VfUkFURV9MSU1JVCwgNDAgPDwgMTYpOwotCUk5MTVfV1JJVEUoR0VONl9SQ19F
VkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDApOyAvKiAxMjUwMCAqIDEyODBucyAqLwotCUk5MTVf
V1JJVEUoR0VONl9SQ19JRExFX0hZU1RFUlNJUywgMjUpOyAvKiAyNSAqIDEyODBucyAqLwotCWZv
cl9lYWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkKLQkJSTkxNV9XUklURShSSU5HX01B
WF9JRExFKGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOwotCUk5MTVfV1JJVEUoR0VONl9SQ19TTEVF
UCwgMCk7Ci0JSTkxNV9XUklURShHRU42X1JDNl9USFJFU0hPTEQsIDYyNSk7IC8qIDgwMHVzLzEu
MjggZm9yIFRPICovCi0KLQkvKiAzOiBFbmFibGUgUkM2ICovCi0KLQlJOTE1X1dSSVRFKEdFTjZf
UkNfQ09OVFJPTCwKLQkJICAgR0VONl9SQ19DVExfSFdfRU5BQkxFIHwKLQkJICAgR0VON19SQ19D
VExfVE9fTU9ERSB8Ci0JCSAgIEdFTjZfUkNfQ1RMX1JDNl9FTkFCTEUpOwotCi0JaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQot
CiBzdGF0aWMgdm9pZCBnZW44X2VuYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQogewogCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBz
OwpAQCAtNzM3Nyw3NSArNzA0NSw2IEBAIHN0YXRpYyB2b2lkIGdlbjhfZW5hYmxlX3JwcyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9w
dXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwogfQogCi1zdGF0aWMgdm9pZCBn
ZW42X2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsK
LQl1MzIgcmM2dmlkcywgcmM2X21hc2s7Ci0JdTMyIGd0Zmlmb2RiZzsKLQlpbnQgcmV0OwotCi0J
STkxNV9XUklURShHRU42X1JDX1NUQVRFLCAwKTsKLQotCS8qIENsZWFyIHRoZSBEQkcgbm93IHNv
IHdlIGRvbid0IGNvbmZ1c2UgZWFybGllciBlcnJvcnMgKi8KLQlndGZpZm9kYmcgPSBJOTE1X1JF
QUQoR1RGSUZPREJHKTsKLQlpZiAoZ3RmaWZvZGJnKSB7Ci0JCURSTV9FUlJPUigiR1QgZmlmbyBo
YWQgYSBwcmV2aW91cyBlcnJvciAleFxuIiwgZ3RmaWZvZGJnKTsKLQkJSTkxNV9XUklURShHVEZJ
Rk9EQkcsIGd0Zmlmb2RiZyk7Ci0JfQotCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRl
dl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCi0JLyogZGlzYWJsZSB0aGUgY291bnRl
cnMgYW5kIHNldCBkZXRlcm1pbmlzdGljIHRocmVzaG9sZHMgKi8KLQlJOTE1X1dSSVRFKEdFTjZf
UkNfQ09OVFJPTCwgMCk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUkMxX1dBS0VfUkFURV9MSU1JVCwg
MTAwMCA8PCAxNik7Ci0JSTkxNV9XUklURShHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDQwIDw8
IDE2IHwgMzApOwotCUk5MTVfV1JJVEUoR0VONl9SQzZwcF9XQUtFX1JBVEVfTElNSVQsIDMwKTsK
LQlJOTE1X1dSSVRFKEdFTjZfUkNfRVZBTFVBVElPTl9JTlRFUlZBTCwgMTI1MDAwKTsKLQlJOTE1
X1dSSVRFKEdFTjZfUkNfSURMRV9IWVNURVJTSVMsIDI1KTsKLQotCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGRldl9wcml2LCBpZCkKLQkJSTkxNV9XUklURShSSU5HX01BWF9JRExFKGVuZ2luZS0+
bW1pb19iYXNlKSwgMTApOwotCi0JSTkxNV9XUklURShHRU42X1JDX1NMRUVQLCAwKTsKLQlJOTE1
X1dSSVRFKEdFTjZfUkMxZV9USFJFU0hPTEQsIDEwMDApOwotCWlmIChJU19JVllCUklER0UoZGV2
X3ByaXYpKQotCQlJOTE1X1dSSVRFKEdFTjZfUkM2X1RIUkVTSE9MRCwgMTI1MDAwKTsKLQllbHNl
Ci0JCUk5MTVfV1JJVEUoR0VONl9SQzZfVEhSRVNIT0xELCA1MDAwMCk7Ci0JSTkxNV9XUklURShH
RU42X1JDNnBfVEhSRVNIT0xELCAxNTAwMDApOwotCUk5MTVfV1JJVEUoR0VONl9SQzZwcF9USFJF
U0hPTEQsIDY0MDAwKTsgLyogdW51c2VkICovCi0KLQkvKiBXZSBkb24ndCB1c2UgdGhvc2Ugb24g
SGFzd2VsbCAqLwotCXJjNl9tYXNrID0gR0VONl9SQ19DVExfUkM2X0VOQUJMRTsKLQlpZiAoSEFT
X1JDNnAoZGV2X3ByaXYpKQotCQlyYzZfbWFzayB8PSBHRU42X1JDX0NUTF9SQzZwX0VOQUJMRTsK
LQlpZiAoSEFTX1JDNnBwKGRldl9wcml2KSkKLQkJcmM2X21hc2sgfD0gR0VONl9SQ19DVExfUkM2
cHBfRU5BQkxFOwotCUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLAotCQkgICByYzZfbWFzayB8
Ci0JCSAgIEdFTjZfUkNfQ1RMX0VJX01PREUoMSkgfAotCQkgICBHRU42X1JDX0NUTF9IV19FTkFC
TEUpOwotCi0JcmM2dmlkcyA9IDA7Ci0JcmV0ID0gc2FuZHlicmlkZ2VfcGNvZGVfcmVhZChkZXZf
cHJpdiwgR0VONl9QQ09ERV9SRUFEX1JDNlZJRFMsCi0JCQkJICAgICAmcmM2dmlkcywgTlVMTCk7
Ci0JaWYgKElTX0dFTihkZXZfcHJpdiwgNikgJiYgcmV0KSB7Ci0JCURSTV9ERUJVR19EUklWRVIo
IkNvdWxkbid0IGNoZWNrIGZvciBCSU9TIHdvcmthcm91bmRcbiIpOwotCX0gZWxzZSBpZiAoSVNf
R0VOKGRldl9wcml2LCA2KSAmJiAoR0VONl9ERUNPREVfUkM2X1ZJRChyYzZ2aWRzICYgMHhmZikg
PCA0NTApKSB7Ci0JCURSTV9ERUJVR19EUklWRVIoIllvdSBzaG91bGQgdXBkYXRlIHlvdXIgQklP
Uy4gQ29ycmVjdGluZyBtaW5pbXVtIHJjNiB2b2x0YWdlICglZG1WLT4lZG1WKVxuIiwKLQkJCSAg
R0VONl9ERUNPREVfUkM2X1ZJRChyYzZ2aWRzICYgMHhmZiksIDQ1MCk7Ci0JCXJjNnZpZHMgJj0g
MHhmZmZmMDA7Ci0JCXJjNnZpZHMgfD0gR0VONl9FTkNPREVfUkM2X1ZJRCg0NTApOwotCQlyZXQg
PSBzYW5keWJyaWRnZV9wY29kZV93cml0ZShkZXZfcHJpdiwgR0VONl9QQ09ERV9XUklURV9SQzZW
SURTLCByYzZ2aWRzKTsKLQkJaWYgKHJldCkKLQkJCURSTV9FUlJPUigiQ291bGRuJ3QgZml4IGlu
Y29ycmVjdCByYzYgdm9sdGFnZVxuIik7Ci0JfQotCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9w
dXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCiBzdGF0aWMgdm9pZCBn
ZW42X2VuYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCS8q
IEhlcmUgYmVnaW5zIGEgbWFnaWMgc2VxdWVuY2Ugb2YgcmVnaXN0ZXIgd3JpdGVzIHRvIGVuYWJs
ZQpAQCAtNzY2MiwxMDAgKzcyNjEsNiBAQCBzdGF0aWMgaW50IHZhbGxleXZpZXdfcnBzX21pbl9m
cmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlyZXR1cm4gbWF4X3QodTMy
LCB2YWwsIDB4YzApOwogfQogCi0vKiBDaGVjayB0aGF0IHRoZSBwY3R4IGJ1ZmZlciB3YXNuJ3Qg
bW92ZSB1bmRlciB1cy4gKi8KLXN0YXRpYyB2b2lkIHZhbGxleXZpZXdfY2hlY2tfcGN0eChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdW5zaWduZWQgbG9uZyBwY3R4X2Fk
ZHIgPSBJOTE1X1JFQUQoVkxWX1BDQlIpICYgfjQwOTU7Ci0KLQlXQVJOX09OKHBjdHhfYWRkciAh
PSBkZXZfcHJpdi0+ZHNtLnN0YXJ0ICsKLQkJCSAgICAgZGV2X3ByaXYtPnZsdl9wY3R4LT5zdG9s
ZW4tPnN0YXJ0KTsKLX0KLQotCi0vKiBDaGVjayB0aGF0IHRoZSBwY2JyIGFkZHJlc3MgaXMgbm90
IGVtcHR5LiAqLwotc3RhdGljIHZvaWQgY2hlcnJ5dmlld19jaGVja19wY3R4KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQl1bnNpZ25lZCBsb25nIHBjdHhfYWRkciA9IEk5
MTVfUkVBRChWTFZfUENCUikgJiB+NDA5NTsKLQotCVdBUk5fT04oKHBjdHhfYWRkciA+PiBWTFZf
UENCUl9BRERSX1NISUZUKSA9PSAwKTsKLX0KLQotc3RhdGljIHZvaWQgY2hlcnJ5dmlld19zZXR1
cF9wY3R4KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlyZXNvdXJjZV9z
aXplX3QgcGN0eF9wYWRkciwgcGFkZHI7Ci0JcmVzb3VyY2Vfc2l6ZV90IHBjdHhfc2l6ZSA9IDMy
KjEwMjQ7Ci0JdTMyIHBjYnI7Ci0KLQlwY2JyID0gSTkxNV9SRUFEKFZMVl9QQ0JSKTsKLQlpZiAo
KHBjYnIgPj4gVkxWX1BDQlJfQUREUl9TSElGVCkgPT0gMCkgewotCQlEUk1fREVCVUdfRFJJVkVS
KCJCSU9TIGRpZG4ndCBzZXQgdXAgUENCUiwgZml4aW5nIHVwXG4iKTsKLQkJcGFkZHIgPSBkZXZf
cHJpdi0+ZHNtLmVuZCArIDEgLSBwY3R4X3NpemU7Ci0JCUdFTV9CVUdfT04ocGFkZHIgPiBVMzJf
TUFYKTsKLQotCQlwY3R4X3BhZGRyID0gKHBhZGRyICYgKH40MDk1KSk7Ci0JCUk5MTVfV1JJVEUo
VkxWX1BDQlIsIHBjdHhfcGFkZHIpOwotCX0KLQotCURSTV9ERUJVR19EUklWRVIoIlBDQlI6IDB4
JTA4eFxuIiwgSTkxNV9SRUFEKFZMVl9QQ0JSKSk7Ci19Ci0KLXN0YXRpYyB2b2lkIHZhbGxleXZp
ZXdfc2V0dXBfcGN0eChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKnBjdHg7Ci0JcmVzb3VyY2Vfc2l6ZV90IHBjdHhfcGFk
ZHI7Ci0JcmVzb3VyY2Vfc2l6ZV90IHBjdHhfc2l6ZSA9IDI0KjEwMjQ7Ci0JdTMyIHBjYnI7Ci0K
LQlwY2JyID0gSTkxNV9SRUFEKFZMVl9QQ0JSKTsKLQlpZiAocGNicikgewotCQkvKiBCSU9TIHNl
dCBpdCB1cCBhbHJlYWR5LCBncmFiIHRoZSBwcmUtYWxsb2MnZCBzcGFjZSAqLwotCQlyZXNvdXJj
ZV9zaXplX3QgcGNicl9vZmZzZXQ7Ci0KLQkJcGNicl9vZmZzZXQgPSAocGNiciAmICh+NDA5NSkp
IC0gZGV2X3ByaXYtPmRzbS5zdGFydDsKLQkJcGN0eCA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVf
c3RvbGVuX2Zvcl9wcmVhbGxvY2F0ZWQoZGV2X3ByaXYsCi0JCQkJCQkJCSAgICAgIHBjYnJfb2Zm
c2V0LAotCQkJCQkJCQkgICAgICBJOTE1X0dUVF9PRkZTRVRfTk9ORSwKLQkJCQkJCQkJICAgICAg
cGN0eF9zaXplKTsKLQkJZ290byBvdXQ7Ci0JfQotCi0JRFJNX0RFQlVHX0RSSVZFUigiQklPUyBk
aWRuJ3Qgc2V0IHVwIFBDQlIsIGZpeGluZyB1cFxuIik7Ci0KLQkvKgotCSAqIEZyb20gdGhlIEd1
bml0IHJlZ2lzdGVyIEhBUzoKLQkgKiBUaGUgR2Z4IGRyaXZlciBpcyBleHBlY3RlZCB0byBwcm9n
cmFtIHRoaXMgcmVnaXN0ZXIgYW5kIGVuc3VyZQotCSAqIHByb3BlciBhbGxvY2F0aW9uIHdpdGhp
biBHZnggc3RvbGVuIG1lbW9yeS4gIEZvciBleGFtcGxlLCB0aGlzCi0JICogcmVnaXN0ZXIgc2hv
dWxkIGJlIHByb2dyYW1tZWQgc3VjaCB0aGFuIHRoZSBQQ0JSIHJhbmdlIGRvZXMgbm90Ci0JICog
b3ZlcmxhcCB3aXRoIG90aGVyIHJhbmdlcywgc3VjaCBhcyB0aGUgZnJhbWUgYnVmZmVyLCBwcm90
ZWN0ZWQKLQkgKiBtZW1vcnksIG9yIGFueSBvdGhlciByZWxldmFudCByYW5nZXMuCi0JICovCi0J
cGN0eCA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuKGRldl9wcml2LCBwY3R4X3NpemUp
OwotCWlmICghcGN0eCkgewotCQlEUk1fREVCVUcoIm5vdCBlbm91Z2ggc3RvbGVuIHNwYWNlIGZv
ciBQQ1RYLCBkaXNhYmxpbmdcbiIpOwotCQlnb3RvIG91dDsKLQl9Ci0KLQlHRU1fQlVHX09OKHJh
bmdlX292ZXJmbG93c190KHU2NCwKLQkJCQkgICAgIGRldl9wcml2LT5kc20uc3RhcnQsCi0JCQkJ
ICAgICBwY3R4LT5zdG9sZW4tPnN0YXJ0LAotCQkJCSAgICAgVTMyX01BWCkpOwotCXBjdHhfcGFk
ZHIgPSBkZXZfcHJpdi0+ZHNtLnN0YXJ0ICsgcGN0eC0+c3RvbGVuLT5zdGFydDsKLQlJOTE1X1dS
SVRFKFZMVl9QQ0JSLCBwY3R4X3BhZGRyKTsKLQotb3V0OgotCURSTV9ERUJVR19EUklWRVIoIlBD
QlI6IDB4JTA4eFxuIiwgSTkxNV9SRUFEKFZMVl9QQ0JSKSk7Ci0JZGV2X3ByaXYtPnZsdl9wY3R4
ID0gcGN0eDsKLX0KLQotc3RhdGljIHZvaWQgdmFsbGV5dmlld19jbGVhbnVwX3BjdHgoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpwY3R4OwotCi0JcGN0eCA9IGZldGNoX2FuZF96ZXJvKCZkZXZfcHJpdi0+dmx2X3BjdHgp
OwotCWlmIChwY3R4KQotCQlpOTE1X2dlbV9vYmplY3RfcHV0KHBjdHgpOwotfQotCiBzdGF0aWMg
dm9pZCB2bHZfaW5pdF9ncGxsX3JlZl9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKIHsKIAlkZXZfcHJpdi0+Z3RfcG0ucnBzLmdwbGxfcmVmX2ZyZXEgPQpAQCAtNzc3Miw4
ICs3Mjc3LDYgQEAgc3RhdGljIHZvaWQgdmFsbGV5dmlld19pbml0X2d0X3Bvd2Vyc2F2ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJc3RydWN0IGludGVsX3JwcyAqcnBzID0g
JmRldl9wcml2LT5ndF9wbS5ycHM7CiAJdTMyIHZhbDsKIAotCXZhbGxleXZpZXdfc2V0dXBfcGN0
eChkZXZfcHJpdik7Ci0KIAl2bHZfaW9zZl9zYl9nZXQoZGV2X3ByaXYsCiAJCQlCSVQoVkxWX0lP
U0ZfU0JfUFVOSVQpIHwKIAkJCUJJVChWTFZfSU9TRl9TQl9OQykgfApAQCAtNzgyOCw4ICs3MzMx
LDYgQEAgc3RhdGljIHZvaWQgY2hlcnJ5dmlld19pbml0X2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9w
cml2LT5ndF9wbS5ycHM7CiAJdTMyIHZhbDsKIAotCWNoZXJyeXZpZXdfc2V0dXBfcGN0eChkZXZf
cHJpdik7Ci0KIAl2bHZfaW9zZl9zYl9nZXQoZGV2X3ByaXYsCiAJCQlCSVQoVkxWX0lPU0ZfU0Jf
UFVOSVQpIHwKIAkJCUJJVChWTFZfSU9TRl9TQl9OQykgfApAQCAtNzg4MCw2NCArNzM4MSw2IEBA
IHN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfaW5pdF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQogCQkgICJPZGQgR1BVIGZyZXEgdmFsdWVzXG4iKTsKIH0KIAot
c3RhdGljIHZvaWQgdmFsbGV5dmlld19jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdmFsbGV5dmlld19jbGVhbnVwX3BjdHgoZGV2X3By
aXYpOwotfQotCi1zdGF0aWMgdm9pZCBjaGVycnl2aWV3X2VuYWJsZV9yYzYoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKLQl1MzIgZ3RmaWZvZGJnLCByYzZfbW9kZSwg
cGNicjsKLQotCWd0Zmlmb2RiZyA9IEk5MTVfUkVBRChHVEZJRk9EQkcpICYgfihHVF9GSUZPX1NC
REVESUNBVEVfRlJFRV9FTlRSWV9DSFYgfAotCQkJCQkgICAgIEdUX0ZJRk9fRlJFRV9FTlRSSUVT
X0NIVik7Ci0JaWYgKGd0Zmlmb2RiZykgewotCQlEUk1fREVCVUdfRFJJVkVSKCJHVCBmaWZvIGhh
ZCBhIHByZXZpb3VzIGVycm9yICV4XG4iLAotCQkJCSBndGZpZm9kYmcpOwotCQlJOTE1X1dSSVRF
KEdURklGT0RCRywgZ3RmaWZvZGJnKTsKLQl9Ci0KLQljaGVycnl2aWV3X2NoZWNrX3BjdHgoZGV2
X3ByaXYpOwotCi0JLyogMWEgJiAxYjogR2V0IGZvcmNld2FrZSBkdXJpbmcgcHJvZ3JhbSBzZXF1
ZW5jZS4gQWx0aG91Z2ggdGhlIGRyaXZlcgotCSAqIGhhc24ndCBlbmFibGVkIGEgc3RhdGUgeWV0
IHdoZXJlIHdlIG5lZWQgZm9yY2V3YWtlLCBCSU9TIG1heSBoYXZlLiovCi0JaW50ZWxfdW5jb3Jl
X2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCi0JLyog
IERpc2FibGUgUkMgc3RhdGVzLiAqLwotCUk5MTVfV1JJVEUoR0VONl9SQ19DT05UUk9MLCAwKTsK
LQotCS8qIDJhOiBQcm9ncmFtIFJDNiB0aHJlc2hvbGRzLiovCi0JSTkxNV9XUklURShHRU42X1JD
Nl9XQUtFX1JBVEVfTElNSVQsIDQwIDw8IDE2KTsKLQlJOTE1X1dSSVRFKEdFTjZfUkNfRVZBTFVB
VElPTl9JTlRFUlZBTCwgMTI1MDAwKTsgLyogMTI1MDAgKiAxMjgwbnMgKi8KLQlJOTE1X1dSSVRF
KEdFTjZfUkNfSURMRV9IWVNURVJTSVMsIDI1KTsgLyogMjUgKiAxMjgwbnMgKi8KLQotCWZvcl9l
YWNoX2VuZ2luZShlbmdpbmUsIGRldl9wcml2LCBpZCkKLQkJSTkxNV9XUklURShSSU5HX01BWF9J
RExFKGVuZ2luZS0+bW1pb19iYXNlKSwgMTApOwotCUk5MTVfV1JJVEUoR0VONl9SQ19TTEVFUCwg
MCk7Ci0KLQkvKiBUTyB0aHJlc2hvbGQgc2V0IHRvIDUwMCB1cyAoIDB4MTg2ICogMS4yOCB1cykg
Ki8KLQlJOTE1X1dSSVRFKEdFTjZfUkM2X1RIUkVTSE9MRCwgMHgxODYpOwotCi0JLyogQWxsb3dz
IFJDNiByZXNpZGVuY3kgY291bnRlciB0byB3b3JrICovCi0JSTkxNV9XUklURShWTFZfQ09VTlRF
Ul9DT05UUk9MLAotCQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoVkxWX0NPVU5UX1JBTkdFX0hJR0gg
fAotCQkJCSAgICAgIFZMVl9NRURJQV9SQzZfQ09VTlRfRU4gfAotCQkJCSAgICAgIFZMVl9SRU5E
RVJfUkM2X0NPVU5UX0VOKSk7Ci0KLQkvKiBGb3Igbm93IHdlIGFzc3VtZSBCSU9TIGlzIGFsbG9j
YXRpbmcgYW5kIHBvcHVsYXRpbmcgdGhlIFBDQlIgICovCi0JcGNiciA9IEk5MTVfUkVBRChWTFZf
UENCUik7Ci0KLQkvKiAzOiBFbmFibGUgUkM2ICovCi0JcmM2X21vZGUgPSAwOwotCWlmIChwY2Jy
ID4+IFZMVl9QQ0JSX0FERFJfU0hJRlQpCi0JCXJjNl9tb2RlID0gR0VON19SQ19DVExfVE9fTU9E
RTsKLQlJOTE1X1dSSVRFKEdFTjZfUkNfQ09OVFJPTCwgcmM2X21vZGUpOwotCi0JaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQot
CiBzdGF0aWMgdm9pZCBjaGVycnl2aWV3X2VuYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQogewogCXUzMiB2YWw7CkBAIC03OTgyLDQ5ICs3NDI1LDYgQEAgc3RhdGlj
IHZvaWQgY2hlcnJ5dmlld19lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9S
Q0VXQUtFX0FMTCk7CiB9CiAKLXN0YXRpYyB2b2lkIHZhbGxleXZpZXdfZW5hYmxlX3JjNihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwotCXUzMiBndGZpZm9kYmc7Ci0K
LQl2YWxsZXl2aWV3X2NoZWNrX3BjdHgoZGV2X3ByaXYpOwotCi0JZ3RmaWZvZGJnID0gSTkxNV9S
RUFEKEdURklGT0RCRyk7Ci0JaWYgKGd0Zmlmb2RiZykgewotCQlEUk1fREVCVUdfRFJJVkVSKCJH
VCBmaWZvIGhhZCBhIHByZXZpb3VzIGVycm9yICV4XG4iLAotCQkJCSBndGZpZm9kYmcpOwotCQlJ
OTE1X1dSSVRFKEdURklGT0RCRywgZ3RmaWZvZGJnKTsKLQl9Ci0KLQlpbnRlbF91bmNvcmVfZm9y
Y2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci0KLQkvKiAgRGlz
YWJsZSBSQyBzdGF0ZXMuICovCi0JSTkxNV9XUklURShHRU42X1JDX0NPTlRST0wsIDApOwotCi0J
STkxNV9XUklURShHRU42X1JDNl9XQUtFX1JBVEVfTElNSVQsIDB4MDAyODAwMDApOwotCUk5MTVf
V1JJVEUoR0VONl9SQ19FVkFMVUFUSU9OX0lOVEVSVkFMLCAxMjUwMDApOwotCUk5MTVfV1JJVEUo
R0VONl9SQ19JRExFX0hZU1RFUlNJUywgMjUpOwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwg
ZGV2X3ByaXYsIGlkKQotCQlJOTE1X1dSSVRFKFJJTkdfTUFYX0lETEUoZW5naW5lLT5tbWlvX2Jh
c2UpLCAxMCk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUkM2X1RIUkVTSE9MRCwgMHg1NTcpOwotCi0J
LyogQWxsb3dzIFJDNiByZXNpZGVuY3kgY291bnRlciB0byB3b3JrICovCi0JSTkxNV9XUklURShW
TFZfQ09VTlRFUl9DT05UUk9MLAotCQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoVkxWX0NPVU5UX1JB
TkdFX0hJR0ggfAotCQkJCSAgICAgIFZMVl9NRURJQV9SQzBfQ09VTlRfRU4gfAotCQkJCSAgICAg
IFZMVl9SRU5ERVJfUkMwX0NPVU5UX0VOIHwKLQkJCQkgICAgICBWTFZfTUVESUFfUkM2X0NPVU5U
X0VOIHwKLQkJCQkgICAgICBWTFZfUkVOREVSX1JDNl9DT1VOVF9FTikpOwotCi0JSTkxNV9XUklU
RShHRU42X1JDX0NPTlRST0wsCi0JCSAgIEdFTjdfUkNfQ1RMX1RPX01PREUgfCBWTFZfUkNfQ1RM
X0NUWF9SU1RfUEFSQUxMRUwpOwotCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9w
cml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCiBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3
X2VuYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCXUzMiB2
YWw7CkBAIC04NTUxLDE0ICs3OTUxLDkgQEAgdm9pZCBpbnRlbF9pbml0X2d0X3Bvd2Vyc2F2ZShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJc3RydWN0IGludGVsX3JwcyAq
cnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7CiAKLQkvKgotCSAqIFJQTSBkZXBlbmRzIG9uIFJD
NiB0byBzYXZlIHJlc3RvcmUgdGhlIEdUIEhXIGNvbnRleHQsIHNvIG1ha2UgUkM2IGEKLQkgKiBy
ZXF1aXJlbWVudC4KLQkgKi8KLQlpZiAoIXNhbml0aXplX3JjNihkZXZfcHJpdikpIHsKLQkJRFJN
X0lORk8oIlJDNiBkaXNhYmxlZCwgZGlzYWJsaW5nIHJ1bnRpbWUgUE0gc3VwcG9ydFxuIik7Ci0J
CXBtX3J1bnRpbWVfZ2V0KCZkZXZfcHJpdi0+ZHJtLnBkZXYtPmRldik7Ci0JfQorCS8qIFBvd2Vy
c2F2aW5nIGlzIGNvbnRyb2xsZWQgYnkgdGhlIGhvc3Qgd2hlbiBpbnNpZGUgYSBWTSAqLworCWlm
IChpbnRlbF92Z3B1X2FjdGl2ZShkZXZfcHJpdikpCisJCW1rd3JpdGVfZGV2aWNlX2luZm8oZGV2
X3ByaXYpLT5oYXNfcnBzID0gZmFsc2U7CiAKIAkvKiBJbml0aWFsaXplIFJQUyBsaW1pdHMgKGZv
ciB1c2Vyc3BhY2UpICovCiAJaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQpAQCAtODU5Mywx
OSArNzk4OCw5IEBAIHZvaWQgaW50ZWxfaW5pdF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQogCXJwcy0+Y3VyX2ZyZXEgPSBycHMtPmlkbGVfZnJlcTsKIH0K
IAotdm9pZCBpbnRlbF9jbGVhbnVwX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCi17Ci0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQotCQl2YWxsZXl2
aWV3X2NsZWFudXBfZ3RfcG93ZXJzYXZlKGRldl9wcml2KTsKLQotCWlmICghSEFTX1JDNihkZXZf
cHJpdikpCi0JCXBtX3J1bnRpbWVfcHV0KCZkZXZfcHJpdi0+ZHJtLnBkZXYtPmRldik7Ci19Ci0K
IHZvaWQgaW50ZWxfc2FuaXRpemVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKIHsKIAlkZXZfcHJpdi0+Z3RfcG0ucnBzLmVuYWJsZWQgPSB0cnVlOyAvKiBm
b3JjZSBSUFMgZGlzYWJsaW5nICovCi0JZGV2X3ByaXYtPmd0X3BtLnJjNi5lbmFibGVkID0gdHJ1
ZTsgLyogZm9yY2UgUkM2IGRpc2FibGluZyAqLwogCWludGVsX2Rpc2FibGVfZ3RfcG93ZXJzYXZl
KGRldl9wcml2KTsKIAogCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQpAQCAtODYyNiwy
NSArODAxMSw2IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9kaXNhYmxlX2xsY19wc3RhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJaTkxNS0+Z3RfcG0ubGxjX3BzdGF0ZS5l
bmFibGVkID0gZmFsc2U7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfcmM2KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZk
ZXZfcHJpdi0+Z3RfcG0ucnBzLmxvY2spOwotCi0JaWYgKCFkZXZfcHJpdi0+Z3RfcG0ucmM2LmVu
YWJsZWQpCi0JCXJldHVybjsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCi0JCWdl
bjlfZGlzYWJsZV9yYzYoZGV2X3ByaXYpOwotCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3By
aXYpKQotCQljaGVycnl2aWV3X2Rpc2FibGVfcmM2KGRldl9wcml2KTsKLQllbHNlIGlmIChJU19W
QUxMRVlWSUVXKGRldl9wcml2KSkKLQkJdmFsbGV5dmlld19kaXNhYmxlX3JjNihkZXZfcHJpdik7
Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2KQotCQlnZW42X2Rpc2FibGVfcmM2
KGRldl9wcml2KTsKLQotCWRldl9wcml2LT5ndF9wbS5yYzYuZW5hYmxlZCA9IGZhbHNlOwotfQot
CiBzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCiB7CiAJbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmd0X3BtLnJwcy5s
b2NrKTsKQEAgLTg2NzAsOCArODAzNiw2IEBAIHZvaWQgaW50ZWxfZGlzYWJsZV9ndF9wb3dlcnNh
dmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCW11dGV4X2xvY2soJmRl
dl9wcml2LT5ndF9wbS5ycHMubG9jayk7CiAKLQlpbnRlbF9kaXNhYmxlX3JjNihkZXZfcHJpdik7
Ci0KIAlpbnRlbF9kaXNhYmxlX3JwcyhkZXZfcHJpdik7CiAJaWYgKEhBU19MTEMoZGV2X3ByaXYp
KQogCQlpbnRlbF9kaXNhYmxlX2xsY19wc3RhdGUoZGV2X3ByaXYpOwpAQCAtODY5MSwyOSArODA1
NSw2IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9lbmFibGVfbGxjX3BzdGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlpOTE1LT5ndF9wbS5sbGNfcHN0YXRlLmVuYWJsZWQg
PSB0cnVlOwogfQogCi1zdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfcmM2KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+
Z3RfcG0ucnBzLmxvY2spOwotCi0JaWYgKGRldl9wcml2LT5ndF9wbS5yYzYuZW5hYmxlZCkKLQkJ
cmV0dXJuOwotCi0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQotCQljaGVycnl2aWV3X2Vu
YWJsZV9yYzYoZGV2X3ByaXYpOwotCWVsc2UgaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpKQot
CQl2YWxsZXl2aWV3X2VuYWJsZV9yYzYoZGV2X3ByaXYpOwotCWVsc2UgaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gMTEpCi0JCWdlbjExX2VuYWJsZV9yYzYoZGV2X3ByaXYpOwotCWVsc2UgaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPj0gOSkKLQkJZ2VuOV9lbmFibGVfcmM2KGRldl9wcml2KTsK
LQllbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQotCQlnZW44X2VuYWJsZV9yYzYoZGV2
X3ByaXYpOwotCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikKLQkJZ2VuNl9lbmFi
bGVfcmM2KGRldl9wcml2KTsKLQotCWRldl9wcml2LT5ndF9wbS5yYzYuZW5hYmxlZCA9IHRydWU7
Ci19Ci0KIHN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQogewogCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3Rf
cG0ucnBzOwpAQCAtODc1NSw4ICs4MDk2LDYgQEAgdm9pZCBpbnRlbF9lbmFibGVfZ3RfcG93ZXJz
YXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogCW11dGV4X2xvY2soJmRl
dl9wcml2LT5ndF9wbS5ycHMubG9jayk7CiAKLQlpZiAoSEFTX1JDNihkZXZfcHJpdikpCi0JCWlu
dGVsX2VuYWJsZV9yYzYoZGV2X3ByaXYpOwogCWlmIChIQVNfUlBTKGRldl9wcml2KSkKIAkJaW50
ZWxfZW5hYmxlX3JwcyhkZXZfcHJpdik7CiAJaWYgKEhBU19MTEMoZGV2X3ByaXYpKQpAQCAtOTgx
OCwxMzMgKzkxNTcsNiBAQCB2b2lkIGludGVsX3BtX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKIAlhdG9taWNfc2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbS53YWtlcmVm
X2NvdW50LCAwKTsKIH0KIAotc3RhdGljIHU2NCB2bHZfcmVzaWRlbmN5X3JhdyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkgICAgIGNvbnN0IGk5MTVfcmVnX3QgcmVnKQot
ewotCXUzMiBsb3dlciwgdXBwZXIsIHRtcDsKLQlpbnQgbG9vcCA9IDI7Ci0KLQkvKgotCSAqIFRo
ZSByZWdpc3RlciBhY2Nlc3NlZCBkbyBub3QgbmVlZCBmb3JjZXdha2UuIFdlIGJvcnJvdwotCSAq
IHVuY29yZSBsb2NrIHRvIHByZXZlbnQgY29uY3VycmVudCBhY2Nlc3MgdG8gcmFuZ2UgcmVnLgot
CSAqLwotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT51bmNvcmUubG9jayk7Ci0KLQkv
KgotCSAqIHZsdiBhbmQgY2h2IHJlc2lkZW5jeSBjb3VudGVycyBhcmUgNDAgYml0cyBpbiB3aWR0
aC4KLQkgKiBXaXRoIGEgY29udHJvbCBiaXQsIHdlIGNhbiBjaG9vc2UgYmV0d2VlbiB1cHBlciBv
ciBsb3dlcgotCSAqIDMyYml0IHdpbmRvdyBpbnRvIHRoaXMgY291bnRlci4KLQkgKgotCSAqIEFs
dGhvdWdoIHdlIGFsd2F5cyB1c2UgdGhlIGNvdW50ZXIgaW4gaGlnaC1yYW5nZSBtb2RlIGVsc2V3
aGVyZSwKLQkgKiB1c2Vyc3BhY2UgbWF5IGF0dGVtcHQgdG8gcmVhZCB0aGUgdmFsdWUgYmVmb3Jl
IHJjNiBpcyBpbml0aWFsaXNlZCwKLQkgKiBiZWZvcmUgd2UgaGF2ZSBzZXQgdGhlIGRlZmF1bHQg
VkxWX0NPVU5URVJfQ09OVFJPTCB2YWx1ZS4gU28gYWx3YXlzCi0JICogc2V0IHRoZSBoaWdoIGJp
dCB0byBiZSBzYWZlLgotCSAqLwotCUk5MTVfV1JJVEVfRlcoVkxWX0NPVU5URVJfQ09OVFJPTCwK
LQkJICAgICAgX01BU0tFRF9CSVRfRU5BQkxFKFZMVl9DT1VOVF9SQU5HRV9ISUdIKSk7Ci0JdXBw
ZXIgPSBJOTE1X1JFQURfRlcocmVnKTsKLQlkbyB7Ci0JCXRtcCA9IHVwcGVyOwotCi0JCUk5MTVf
V1JJVEVfRlcoVkxWX0NPVU5URVJfQ09OVFJPTCwKLQkJCSAgICAgIF9NQVNLRURfQklUX0RJU0FC
TEUoVkxWX0NPVU5UX1JBTkdFX0hJR0gpKTsKLQkJbG93ZXIgPSBJOTE1X1JFQURfRlcocmVnKTsK
LQotCQlJOTE1X1dSSVRFX0ZXKFZMVl9DT1VOVEVSX0NPTlRST0wsCi0JCQkgICAgICBfTUFTS0VE
X0JJVF9FTkFCTEUoVkxWX0NPVU5UX1JBTkdFX0hJR0gpKTsKLQkJdXBwZXIgPSBJOTE1X1JFQURf
RlcocmVnKTsKLQl9IHdoaWxlICh1cHBlciAhPSB0bXAgJiYgLS1sb29wKTsKLQotCS8qCi0JICog
RXZlcnl3aGVyZSBlbHNlIHdlIGFsd2F5cyB1c2UgVkxWX0NPVU5URVJfQ09OVFJPTCB3aXRoIHRo
ZQotCSAqIFZMVl9DT1VOVF9SQU5HRV9ISUdIIGJpdCBzZXQgLSBzbyBpdCBpcyBzYWZlIHRvIGxl
YXZlIGl0IHNldAotCSAqIG5vdy4KLQkgKi8KLQotCXJldHVybiBsb3dlciB8ICh1NjQpdXBwZXIg
PDwgODsKLX0KLQotdTY0IGludGVsX3JjNl9yZXNpZGVuY3lfbnMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAotCQkJICAgY29uc3QgaTkxNV9yZWdfdCByZWcpCi17Ci0Jc3RydWN0
IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7Ci0JdTY0IHRpbWVfaHcs
IHByZXZfaHcsIG92ZXJmbG93X2h3OwotCXVuc2lnbmVkIGludCBmd19kb21haW5zOwotCXVuc2ln
bmVkIGxvbmcgZmxhZ3M7Ci0JdW5zaWduZWQgaW50IGk7Ci0JdTMyIG11bCwgZGl2OwotCi0JaWYg
KCFIQVNfUkM2KGRldl9wcml2KSkKLQkJcmV0dXJuIDA7Ci0KLQkvKgotCSAqIFN0b3JlIHByZXZp
b3VzIGh3IGNvdW50ZXIgdmFsdWVzIGZvciBjb3VudGVyIHdyYXAtYXJvdW5kIGhhbmRsaW5nLgot
CSAqCi0JICogVGhlcmUgYXJlIG9ubHkgZm91ciBpbnRlcmVzdGluZyByZWdpc3RlcnMgYW5kIHRo
ZXkgbGl2ZSBuZXh0IHRvIGVhY2gKLQkgKiBvdGhlciBzbyB3ZSBjYW4gdXNlIHRoZSByZWxhdGl2
ZSBhZGRyZXNzLCBjb21wYXJlZCB0byB0aGUgc21hbGxlc3QKLQkgKiBvbmUgYXMgdGhlIGluZGV4
IGludG8gZHJpdmVyIHN0b3JhZ2UuCi0JICovCi0JaSA9IChpOTE1X21taW9fcmVnX29mZnNldChy
ZWcpIC0KLQkgICAgIGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjZfR1RfR0ZYX1JDNl9MT0NLRUQp
KSAvIHNpemVvZih1MzIpOwotCWlmIChXQVJOX09OX09OQ0UoaSA+PSBBUlJBWV9TSVpFKGRldl9w
cml2LT5ndF9wbS5yYzYuY3VyX3Jlc2lkZW5jeSkpKQotCQlyZXR1cm4gMDsKLQotCWZ3X2RvbWFp
bnMgPSBpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2Zvcl9yZWcodW5jb3JlLCByZWcsIEZXX1JFR19S
RUFEKTsKLQotCXNwaW5fbG9ja19pcnFzYXZlKCZ1bmNvcmUtPmxvY2ssIGZsYWdzKTsKLQlpbnRl
bF91bmNvcmVfZm9yY2V3YWtlX2dldF9fbG9ja2VkKHVuY29yZSwgZndfZG9tYWlucyk7Ci0KLQkv
KiBPbiBWTFYgYW5kIENIViwgcmVzaWRlbmN5IHRpbWUgaXMgaW4gQ1ogdW5pdHMgcmF0aGVyIHRo
YW4gMS4yOHVzICovCi0JaWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJ
RVcoZGV2X3ByaXYpKSB7Ci0JCW11bCA9IDEwMDAwMDA7Ci0JCWRpdiA9IGRldl9wcml2LT5jemNs
a19mcmVxOwotCQlvdmVyZmxvd19odyA9IEJJVF9VTEwoNDApOwotCQl0aW1lX2h3ID0gdmx2X3Jl
c2lkZW5jeV9yYXcoZGV2X3ByaXYsIHJlZyk7Ci0JfSBlbHNlIHsKLQkJLyogODMzLjMzbnMgdW5p
dHMgb24gR2VuOUxQLCAxLjI4dXMgZWxzZXdoZXJlLiAqLwotCQlpZiAoSVNfR0VOOV9MUChkZXZf
cHJpdikpIHsKLQkJCW11bCA9IDEwMDAwOwotCQkJZGl2ID0gMTI7Ci0JCX0gZWxzZSB7Ci0JCQlt
dWwgPSAxMjgwOwotCQkJZGl2ID0gMTsKLQkJfQotCi0JCW92ZXJmbG93X2h3ID0gQklUX1VMTCgz
Mik7Ci0JCXRpbWVfaHcgPSBpbnRlbF91bmNvcmVfcmVhZF9mdyh1bmNvcmUsIHJlZyk7Ci0JfQot
Ci0JLyoKLQkgKiBDb3VudGVyIHdyYXAgaGFuZGxpbmcuCi0JICoKLQkgKiBCdXQgcmVseWluZyBv
biBhIHN1ZmZpY2llbnQgZnJlcXVlbmN5IG9mIHF1ZXJpZXMgb3RoZXJ3aXNlIGNvdW50ZXJzCi0J
ICogY2FuIHN0aWxsIHdyYXAuCi0JICovCi0JcHJldl9odyA9IGRldl9wcml2LT5ndF9wbS5yYzYu
cHJldl9od19yZXNpZGVuY3lbaV07Ci0JZGV2X3ByaXYtPmd0X3BtLnJjNi5wcmV2X2h3X3Jlc2lk
ZW5jeVtpXSA9IHRpbWVfaHc7Ci0KLQkvKiBSQzYgZGVsdGEgZnJvbSBsYXN0IHNhbXBsZS4gKi8K
LQlpZiAodGltZV9odyA+PSBwcmV2X2h3KQotCQl0aW1lX2h3IC09IHByZXZfaHc7Ci0JZWxzZQot
CQl0aW1lX2h3ICs9IG92ZXJmbG93X2h3IC0gcHJldl9odzsKLQotCS8qIEFkZCBkZWx0YSB0byBS
QzYgZXh0ZW5kZWQgcmF3IGRyaXZlciBjb3B5LiAqLwotCXRpbWVfaHcgKz0gZGV2X3ByaXYtPmd0
X3BtLnJjNi5jdXJfcmVzaWRlbmN5W2ldOwotCWRldl9wcml2LT5ndF9wbS5yYzYuY3VyX3Jlc2lk
ZW5jeVtpXSA9IHRpbWVfaHc7Ci0KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dF9fbG9ja2Vk
KHVuY29yZSwgZndfZG9tYWlucyk7Ci0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdW5jb3JlLT5s
b2NrLCBmbGFncyk7Ci0KLQlyZXR1cm4gbXVsX3U2NF91MzJfZGl2KHRpbWVfaHcsIG11bCwgZGl2
KTsKLX0KLQotdTY0IGludGVsX3JjNl9yZXNpZGVuY3lfdXMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAotCQkJICAgaTkxNV9yZWdfdCByZWcpCi17Ci0JcmV0dXJuIERJVl9ST1VO
RF9VUF9VTEwoaW50ZWxfcmM2X3Jlc2lkZW5jeV9ucyhkZXZfcHJpdiwgcmVnKSwgMTAwMCk7Ci19
Ci0KIHUzMiBpbnRlbF9nZXRfY2FnZihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
IHUzMiBycHN0YXQpCiB7CiAJdTMyIGNhZ2Y7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9wbS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uaAppbmRleCBl
MzU3M2UxZTE2ZTMuLjkzZDE5MmQwNjEwYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfcG0uaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oCkBAIC0z
Miw3ICszMiw2IEBAIHZvaWQgaW50ZWxfcG1fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKIHZvaWQgaW50ZWxfZ3B1X2lwc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7CiB2b2lkIGludGVsX2dwdV9pcHNfdGVhcmRvd24odm9pZCk7CiB2b2lk
IGludGVsX2luaXRfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dik7Ci12b2lkIGludGVsX2NsZWFudXBfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7CiB2b2lkIGludGVsX3Nhbml0aXplX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBpbnRlbF9lbmFibGVfZ3RfcG93ZXJz
YXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiB2b2lkIGludGVsX2Rpc2Fi
bGVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CkBAIC03
Miw4ICs3MSw2IEBAIHZvaWQgaW50ZWxfZW5hYmxlX2lwYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwogCiBpbnQgaW50ZWxfZ3B1X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCBpbnQgdmFsKTsKIGludCBpbnRlbF9mcmVxX29wY29kZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCB2YWwpOwotdTY0IGludGVsX3JjNl9yZXNpZGVu
Y3lfbnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpOTE1X3JlZ190IHJlZyk7
Ci11NjQgaW50ZWxfcmM2X3Jlc2lkZW5jeV91cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIGk5MTVfcmVnX3QgcmVnKTsKIAogdTMyIGludGVsX2dldF9jYWdmKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHJwc3RhdDEpOwogCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9saXZlX3NlbGZ0ZXN0cy5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfbGl2ZV9zZWxmdGVzdHMuaAppbmRleCA2NmQ4
M2MxMzkwYzEuLjY3MTNlZmVhMzUwYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2k5MTVfbGl2ZV9zZWxmdGVzdHMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9zZWxmdGVzdHMvaTkxNV9saXZlX3NlbGZ0ZXN0cy5oCkBAIC0xNiw2ICsxNiw3IEBAIHNlbGZ0
ZXN0KGd0X2VuZ2luZXMsIGludGVsX2VuZ2luZV9saXZlX3NlbGZ0ZXN0cykKIHNlbGZ0ZXN0KGd0
X3RpbWVsaW5lcywgaW50ZWxfdGltZWxpbmVfbGl2ZV9zZWxmdGVzdHMpCiBzZWxmdGVzdChndF9j
b250ZXh0cywgaW50ZWxfY29udGV4dF9saXZlX3NlbGZ0ZXN0cykKIHNlbGZ0ZXN0KGd0X2xyYywg
aW50ZWxfbHJjX2xpdmVfc2VsZnRlc3RzKQorc2VsZnRlc3QoZ3RfcG0sIGludGVsX2d0X3BtX2xp
dmVfc2VsZnRlc3RzKQogc2VsZnRlc3QocmVxdWVzdHMsIGk5MTVfcmVxdWVzdF9saXZlX3NlbGZ0
ZXN0cykKIHNlbGZ0ZXN0KGFjdGl2ZSwgaTkxNV9hY3RpdmVfbGl2ZV9zZWxmdGVzdHMpCiBzZWxm
dGVzdChvYmplY3RzLCBpOTE1X2dlbV9vYmplY3RfbGl2ZV9zZWxmdGVzdHMpCi0tIAoyLjIzLjAK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdm
eCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

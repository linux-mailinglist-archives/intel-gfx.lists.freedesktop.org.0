Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 46B23E5134
	for <lists+intel-gfx@lfdr.de>; Fri, 25 Oct 2019 18:29:17 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E103A6EAA1;
	Fri, 25 Oct 2019 16:29:14 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 176056EAA1;
 Fri, 25 Oct 2019 16:29:11 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18965520-1500050 
 for multiple; Fri, 25 Oct 2019 17:28:57 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 25 Oct 2019 17:28:54 +0100
Message-Id: <20191025162855.17675-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc1
In-Reply-To: <20191025142333.11806-1-chris@chris-wilson.co.uk>
References: <20191025142333.11806-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t] lib/i915: Use explicit iterator names in
 for_each_engine()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UHJvdmlkZSB0aGUgaXRlcmF0b3IgbmFtZSBhcyBhbiBleHBsaWNpdCBtYWNybyBwYXJhbWV0ZXIg
c28gdGhhdCBpdCBpcwprbm93biB0byB0aGUgY2FsbGVyLCBhbmQgYWxsb3dzIGZvciB0aGVtIHRv
IHByb3Blcmx5IG5lc3QgbG9vcHMgb3ZlciBhbGwKZW5naW5lcy4KCkZpeGVzOgouLi90ZXN0cy9p
OTE1L2dlbV9leGVjX3NjaGVkdWxlLmM6IEluIGZ1bmN0aW9uIOKAmHNlbWFwaG9yZV9ub3NraXDi
gJk6Ci4uL2xpYi9pZ3RfZ3QuaDo4NDo0NDogd2FybmluZzogZGVjbGFyYXRpb24gb2Yg4oCYZV9f
4oCZIHNoYWRvd3MgYSBwcmV2aW91cyBsb2NhbCBbLVdzaGFkb3ddCiAgZm9yIChjb25zdCBzdHJ1
Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSAqZV9fID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7
XAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF5+fgouLi90ZXN0
cy9pOTE1L2dlbV9leGVjX3NjaGVkdWxlLmM6NjUzOjI6IG5vdGU6IGluIGV4cGFuc2lvbiBvZiBt
YWNybyDigJhmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmXigJkKICBmb3JfZWFjaF9waHlzaWNhbF9l
bmdpbmUoaTkxNSwgb3RoZXIpIHsKICBefn5+fn5+fn5+fn5+fn5+fn5+fn5+fn4KLi4vbGliL2ln
dF9ndC5oOjg0OjQ0OiBub3RlOiBzaGFkb3dlZCBkZWNsYXJhdGlvbiBpcyBoZXJlCiAgZm9yIChj
b25zdCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSAqZV9fID0gaW50ZWxfZXhlY3V0aW9u
X2VuZ2luZXM7XAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF5+
fgouLi90ZXN0cy9pOTE1L2dlbV9leGVjX3NjaGVkdWxlLmM6NjUyOjI6IG5vdGU6IGluIGV4cGFu
c2lvbiBvZiBtYWNybyDigJhmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmXigJkKICBmb3JfZWFjaF9w
aHlzaWNhbF9lbmdpbmUoaTkxNSwgZW5naW5lKSB7CiAgXn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+
Ci4uL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfc2NoZWR1bGUuYzogSW4gZnVuY3Rpb24g4oCYbWVhc3Vy
ZV9zZW1hcGhvcmVfcG93ZXLigJk6Ci4uL2xpYi9pZ3RfZ3QuaDo4NDo0NDogd2FybmluZzogZGVj
bGFyYXRpb24gb2Yg4oCYZV9f4oCZIHNoYWRvd3MgYSBwcmV2aW91cyBsb2NhbCBbLVdzaGFkb3dd
CiAgZm9yIChjb25zdCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSAqZV9fID0gaW50ZWxf
ZXhlY3V0aW9uX2VuZ2luZXM7XAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIF5+fgouLi90ZXN0cy9pOTE1L2dlbV9leGVjX3NjaGVkdWxlLmM6MTc0MDozOiBub3Rl
OiBpbiBleHBhbnNpb24gb2YgbWFjcm8g4oCYZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5l4oCZCiAg
IGZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShpOTE1LCBlbmdpbmUpIHsKICAgXn5+fn5+fn5+fn5+
fn5+fn5+fn5+fn5+Ci4uL2xpYi9pZ3RfZ3QuaDo4NDo0NDogbm90ZTogc2hhZG93ZWQgZGVjbGFy
YXRpb24gaXMgaGVyZQogIGZvciAoY29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUg
KmVfXyA9IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVzO1wKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBefn4KLi4vdGVzdHMvaTkxNS9nZW1fZXhlY19zY2hlZHVsZS5j
OjE3MTk6Mjogbm90ZTogaW4gZXhwYW5zaW9uIG9mIG1hY3JvIOKAmGZvcl9lYWNoX3BoeXNpY2Fs
X2VuZ2luZeKAmQogIGZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShpOTE1LCBzaWduYWxlcikgewog
IF5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxj
aHJpc0BjaHJpcy13aWxzb24uY28udWs+CkNjOiBUdnJ0a28gVXJzdWxpbiA8dHZydGtvLnVyc3Vs
aW5AaW50ZWwuY29tPgpDYzogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+Ci0tLQog
YmVuY2htYXJrcy9nZW1fc3lzbGF0ZW5jeS5jICAgICB8ICAxNiArLS0KIGxpYi9pOTE1L2dlbV9y
aW5nLmMgICAgICAgICAgICAgfCAgIDQgKy0KIGxpYi9pZ3RfZ3QuaCAgICAgICAgICAgICAgICAg
ICAgfCAgMjQgKysrLS0KIHRlc3RzL2FtZGdwdS9hbWRfcHJpbWUuYyAgICAgICAgfCAgIDYgKy0K
IHRlc3RzL2k5MTUvZ2VtX2JhZF9yZWxvYy5jICAgICAgfCAgIDQgKy0KIHRlc3RzL2k5MTUvZ2Vt
X2J1c3kuYyAgICAgICAgICAgfCAgIDQgKy0KIHRlc3RzL2k5MTUvZ2VtX2NvbmN1cnJlbnRfYWxs
LmMgfCAgIDcgKy0KIHRlc3RzL2k5MTUvZ2VtX2NzX3ByZWZldGNoLmMgICAgfCAgIDIgKy0KIHRl
c3RzL2k5MTUvZ2VtX2N0eF9jcmVhdGUuYyAgICAgfCAgMTIgKy0tCiB0ZXN0cy9pOTE1L2dlbV9j
dHhfc2hhcmVkLmMgICAgIHwgIDQzICsrKystLS0tCiB0ZXN0cy9pOTE1L2dlbV9jdHhfc3dpdGNo
LmMgICAgIHwgICAyICstCiB0ZXN0cy9pOTE1L2dlbV9jdHhfdGhyYXNoLmMgICAgIHwgIDE0ICsr
LQogdGVzdHMvaTkxNS9nZW1fZWlvLmMgICAgICAgICAgICB8ICAyOSArKystLS0KIHRlc3RzL2k5
MTUvZ2VtX2V4ZWNfYXN5bmMuYyAgICAgfCAgMTMgKystCiB0ZXN0cy9pOTE1L2dlbV9leGVjX2F3
YWl0LmMgICAgIHwgICA3ICstCiB0ZXN0cy9pOTE1L2dlbV9leGVjX2NhcHR1cmUuYyAgIHwgICA2
ICstCiB0ZXN0cy9pOTE1L2dlbV9leGVjX2NyZWF0ZS5jICAgIHwgICA4ICstCiB0ZXN0cy9pOTE1
L2dlbV9leGVjX2ZlbmNlLmMgICAgIHwgIDYxICsrKysrKy0tLS0tCiB0ZXN0cy9pOTE1L2dlbV9l
eGVjX2ZsdXNoLmMgICAgIHwgICAyICstCiB0ZXN0cy9pOTE1L2dlbV9leGVjX2d0dGZpbGwuYyAg
IHwgIDExICstCiB0ZXN0cy9pOTE1L2dlbV9leGVjX2xhdGVuY3kuYyAgIHwgIDMzICsrKy0tLQog
dGVzdHMvaTkxNS9nZW1fZXhlY19ub3AuYyAgICAgICB8ICA0NCArKysrLS0tLQogdGVzdHMvaTkx
NS9nZW1fZXhlY19wYXJhbXMuYyAgICB8ICAxNCArLS0KIHRlc3RzL2k5MTUvZ2VtX2V4ZWNfcmVs
b2MuYyAgICAgfCAgIDggKy0KIHRlc3RzL2k5MTUvZ2VtX2V4ZWNfcmV1c2UuYyAgICAgfCAgIDYg
Ky0KIHRlc3RzL2k5MTUvZ2VtX2V4ZWNfc2NoZWR1bGUuYyAgfCAxNzIgKysrKysrKysrKysrKysr
LS0tLS0tLS0tLS0tLS0tLS0KIHRlc3RzL2k5MTUvZ2VtX2V4ZWNfc3VzcGVuZC5jICAgfCAgMjAg
KystLQogdGVzdHMvaTkxNS9nZW1fZXhlY193aGlzcGVyLmMgICB8ICAgOCArLQogdGVzdHMvaTkx
NS9nZW1fbW9jc19zZXR0aW5ncy5jICB8ICAgNiArLQogdGVzdHMvaTkxNS9nZW1fcmVzZXRfc3Rh
dHMuYyAgICB8ICAxMCArLQogdGVzdHMvaTkxNS9nZW1fcmluZ19zeW5jX2xvb3AuYyB8ICAgNSAr
LQogdGVzdHMvaTkxNS9nZW1fcmluZ2ZpbGwuYyAgICAgICB8ICAgMyArLQogdGVzdHMvaTkxNS9n
ZW1fc2hyaW5rLmMgICAgICAgICB8ICAgNSArLQogdGVzdHMvaTkxNS9nZW1fc3Bpbl9iYXRjaC5j
ICAgICB8ICAgMiArLQogdGVzdHMvaTkxNS9nZW1fc3RvcmVkd19sb29wLmMgICB8ICAgMiArLQog
dGVzdHMvaTkxNS9nZW1fc3luYy5jICAgICAgICAgICB8ICA5OSArKysrKysrKystLS0tLS0tLS0K
IHRlc3RzL2k5MTUvZ2VtX3VzZXJwdHJfYmxpdHMuYyAgfCAgIDcgKy0KIHRlc3RzL2k5MTUvaTkx
NV9tb2R1bGVfbG9hZC5jICAgfCAgMjIgKystLQogdGVzdHMva21zX2J1c3kuYyAgICAgICAgICAg
ICAgICB8ICAzMCArKystLS0KIHRlc3RzL3ByaW1lX2J1c3kuYyAgICAgICAgICAgICAgfCAgIDgg
Ky0KIHRlc3RzL3ByaW1lX3ZnZW0uYyAgICAgICAgICAgICAgfCAgMTYgKy0tCiA0MSBmaWxlcyBj
aGFuZ2VkLCAzNjggaW5zZXJ0aW9ucygrKSwgNDI3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L2JlbmNobWFya3MvZ2VtX3N5c2xhdGVuY3kuYyBiL2JlbmNobWFya3MvZ2VtX3N5c2xhdGVuY3ku
YwppbmRleCBkN2NmMGVkNDkuLjQwMjMwNjMwMCAxMDA2NDQKLS0tIGEvYmVuY2htYXJrcy9nZW1f
c3lzbGF0ZW5jeS5jCisrKyBiL2JlbmNobWFya3MvZ2VtX3N5c2xhdGVuY3kuYwpAQCAtNzksMTcg
Kzc5LDYgQEAgc3RhdGljIHZvaWQgZm9yY2VfbG93X2xhdGVuY3kodm9pZCkKIAogI2RlZmluZSBF
TkdJTkVfRkxBR1MgIChJOTE1X0VYRUNfUklOR19NQVNLIHwgTE9DQUxfSTkxNV9FWEVDX0JTRF9N
QVNLKQogCi1zdGF0aWMgYm9vbCBpZ25vcmVfZW5naW5lKGludCBmZCwgdW5zaWduZWQgZW5naW5l
KQotewotCWlmIChlbmdpbmUgPT0gMCkKLQkJcmV0dXJuIHRydWU7Ci0KLQlpZiAoZ2VtX2hhc19i
c2QyKGZkKSAmJiBlbmdpbmUgPT0gSTkxNV9FWEVDX0JTRCkKLQkJcmV0dXJuIHRydWU7Ci0KLQly
ZXR1cm4gZmFsc2U7Ci19Ci0KIHN0YXRpYyB2b2lkICpnZW1fYnVzeXNwaW4odm9pZCAqYXJnKQog
ewogCWNvbnN0IHVpbnQzMl90IGJiZSA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7CkBAIC0xMDAsMTQg
Kzg5LDEzIEBAIHN0YXRpYyB2b2lkICpnZW1fYnVzeXNwaW4odm9pZCAqYXJnKQogCQlicy0+c3og
PyBicy0+c3ogKyBzaXplb2YoYmJlKSA6IGJzLT5sZWFrID8gMTYgPDwgMjAgOiA0IDw8IDEwOwog
CXVuc2lnbmVkIGVuZ2luZXNbMTZdOwogCXVuc2lnbmVkIG5lbmdpbmU7Ci0JdW5zaWduZWQgZW5n
aW5lOwogCWludCBmZDsKIAogCWZkID0gZHJtX29wZW5fZHJpdmVyKERSSVZFUl9JTlRFTCk7CiAK
IAluZW5naW5lID0gMDsKLQlmb3JfZWFjaF9lbmdpbmUoZmQsIGVuZ2luZSkKLQkJaWYgKCFpZ25v
cmVfZW5naW5lKGZkLCBlbmdpbmUpKSBlbmdpbmVzW25lbmdpbmUrK10gPSBlbmdpbmU7CisJZm9y
X2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKQorCQllbmdpbmVzW25lbmdpbmUrK10gPSBlYl9y
aW5nKGUpOwogCiAJbWVtc2V0KG9iaiwgMCwgc2l6ZW9mKG9iaikpOwogCW9ialswXS5oYW5kbGUg
PSBnZW1fY3JlYXRlKGZkLCA0MDk2KTsKZGlmZiAtLWdpdCBhL2xpYi9pOTE1L2dlbV9yaW5nLmMg
Yi9saWIvaTkxNS9nZW1fcmluZy5jCmluZGV4IDVjYTJhNzI4Yi4uOTlmNDc0MWNiIDEwMDY0NAot
LS0gYS9saWIvaTkxNS9nZW1fcmluZy5jCisrKyBiL2xpYi9pOTE1L2dlbV9yaW5nLmMKQEAgLTE1
Myw5ICsxNTMsOSBAQCBnZW1fbWVhc3VyZV9yaW5nX2luZmxpZ2h0KGludCBmZCwgdW5zaWduZWQg
aW50IGVuZ2luZSwgZW51bSBtZWFzdXJlX3JpbmdfZmxhZ3MgZgogCWZjbnRsKGZkLCBGX1NFVEZE
LCBmY250bChmZCwgRl9HRVRGRCkgfCBPX05PTkJMT0NLKTsKIAogCWlmIChlbmdpbmUgPT0gQUxM
X0VOR0lORVMpIHsKLQkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZkLCBlbmdpbmUpIHsKKwkJ
Zm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7CiAJCQl1bnNpZ25lZCBpbnQgY291bnQg
PQotCQkJCV9fZ2VtX21lYXN1cmVfcmluZ19pbmZsaWdodChmZCwgZW5naW5lLCBmbGFncyk7CisJ
CQkJX19nZW1fbWVhc3VyZV9yaW5nX2luZmxpZ2h0KGZkLCBlYl9yaW5nKGUpLCBmbGFncyk7CiAK
IAkJCWlmIChjb3VudCA8IG1pbikKIAkJCQltaW4gPSBjb3VudDsKZGlmZiAtLWdpdCBhL2xpYi9p
Z3RfZ3QuaCBiL2xpYi9pZ3RfZ3QuaAppbmRleCA3M2I1MDAyYTAuLjY2MDg4ZDM5MSAxMDA2NDQK
LS0tIGEvbGliL2lndF9ndC5oCisrKyBiL2xpYi9pZ3RfZ3QuaApAQCAtNzIsMTkgKzcyLDIxIEBA
IGV4dGVybiBjb25zdCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSB7CiAJdW5zaWduZWQg
ZmxhZ3M7CiB9IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVzW107CiAKKyNkZWZpbmUgZWJfcmluZyhl
KSAoKGUpLT5leGVjX2lkIHwgKGUpLT5mbGFncykKKwogI2RlZmluZSBmb3JfaWYoZXhwcl9fKSBp
ZiAoIShleHByX18pKSB7fSBlbHNlCiAKLSNkZWZpbmUgZm9yX2VhY2hfZW5naW5lKGZkX18sIGZs
YWdzX18pIFwKLQlmb3IgKGNvbnN0IHN0cnVjdCBpbnRlbF9leGVjdXRpb25fZW5naW5lICplX18g
PSBpbnRlbF9leGVjdXRpb25fZW5naW5lcztcCi0JICAgICBlX18tPm5hbWU7IFwKLQkgICAgIGVf
XysrKSBcCi0JCWZvcl9pZiAoZ2VtX2hhc19yaW5nKGZkX18sIGZsYWdzX18gPSBlX18tPmV4ZWNf
aWQgfCBlX18tPmZsYWdzKSkKLQotI2RlZmluZSBmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmRf
XywgZmxhZ3NfXykgXAotCWZvciAoY29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUg
KmVfXyA9IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVzO1wKLQkgICAgIGVfXy0+bmFtZTsgXAotCSAg
ICAgZV9fKyspIFwKLQkJZm9yX2lmIChnZW1fcmluZ19oYXNfcGh5c2ljYWxfZW5naW5lKGZkX18s
IGZsYWdzX18gPSBlX18tPmV4ZWNfaWQgfCBlX18tPmZsYWdzKSkKKyNkZWZpbmUgZm9yX2VhY2hf
ZW5naW5lKGl0X18sIGZkX18pIFwKKwlmb3IgKGNvbnN0IHN0cnVjdCBpbnRlbF9leGVjdXRpb25f
ZW5naW5lICppdF9fID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7XAorCSAgICAgaXRfXy0+bmFt
ZTsgXAorCSAgICAgaXRfXysrKSBcCisJCWZvcl9pZiAoZ2VtX2hhc19yaW5nKGZkX18sIGViX3Jp
bmcoaXRfXykpKQorCisjZGVmaW5lIGZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShpdF9fLCBmZF9f
KSBcCisJZm9yIChjb25zdCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSAqaXRfXyA9IGlu
dGVsX2V4ZWN1dGlvbl9lbmdpbmVzO1wKKwkgICAgIGl0X18tPm5hbWU7IFwKKwkgICAgIGl0X18r
KykgXAorCQlmb3JfaWYgKGdlbV9yaW5nX2hhc19waHlzaWNhbF9lbmdpbmUoZmRfXywgZWJfcmlu
ZyhpdF9fKSkpCiAKIGJvb2wgZ2VtX3JpbmdfaXNfcGh5c2ljYWxfZW5naW5lKGludCBmZCwgdW5z
aWduZWQgaW50IHJpbmcpOwogYm9vbCBnZW1fcmluZ19oYXNfcGh5c2ljYWxfZW5naW5lKGludCBm
ZCwgdW5zaWduZWQgaW50IHJpbmcpOwpkaWZmIC0tZ2l0IGEvdGVzdHMvYW1kZ3B1L2FtZF9wcmlt
ZS5jIGIvdGVzdHMvYW1kZ3B1L2FtZF9wcmltZS5jCmluZGV4IGRjNzFhYzcwYy4uZmRiOGEwMjgz
IDEwMDY0NAotLS0gYS90ZXN0cy9hbWRncHUvYW1kX3ByaW1lLmMKKysrIGIvdGVzdHMvYW1kZ3B1
L2FtZF9wcmltZS5jCkBAIC0xNzMsMTQgKzE3MywxNCBAQCBzdGF0aWMgdm9pZCBpOTE1X3RvX2Ft
ZChpbnQgaTkxNSwgaW50IGFtZCwgYW1kZ3B1X2RldmljZV9oYW5kbGUgZGV2aWNlKQogCWNvbnN0
IHVpbnQzMl90IGJiZSA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7CiAJc3RydWN0IGRybV9pOTE1X2dl
bV9leGVjX29iamVjdDIgb2JqWzJdOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIg
ZXhlY2J1ZjsKLQl1bnNpZ25lZCBpbnQgZW5naW5lc1sxNl0sIGVuZ2luZTsKKwl1bnNpZ25lZCBp
bnQgZW5naW5lc1sxNl07CiAJdW5zaWduZWQgaW50IG5lbmdpbmU7CiAJdW5zaWduZWQgbG9uZyBj
b3VudDsKIAlzdHJ1Y3QgY29yayBjOwogCiAJbmVuZ2luZSA9IDA7Ci0JZm9yX2VhY2hfcGh5c2lj
YWxfZW5naW5lKGk5MTUsIGVuZ2luZSkKLQkJZW5naW5lc1tuZW5naW5lKytdID0gZW5naW5lOwor
CWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBpOTE1KQorCQllbmdpbmVzW25lbmdpbmUrK10g
PSBlYl9yaW5nKGUpOwogCWlndF9yZXF1aXJlKG5lbmdpbmUpOwogCiAJbWVtc2V0KG9iaiwgMCwg
c2l6ZW9mKG9iaikpOwpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fYmFkX3JlbG9jLmMgYi90
ZXN0cy9pOTE1L2dlbV9iYWRfcmVsb2MuYwppbmRleCBjMDNlNWJlYjMuLjk2YzliYWJlNiAxMDA2
NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fYmFkX3JlbG9jLmMKKysrIGIvdGVzdHMvaTkxNS9nZW1f
YmFkX3JlbG9jLmMKQEAgLTE5NiwxMCArMTk2LDEwIEBAIGlndF9tYWluCiAKIAlmb3IgKGUgPSBp
bnRlbF9leGVjdXRpb25fZW5naW5lczsgZS0+bmFtZTsgZSsrKSB7CiAJCWlndF9zdWJ0ZXN0X2Yo
Im5lZ2F0aXZlLXJlbG9jLSVzIiwgZS0+bmFtZSkKLQkJCW5lZ2F0aXZlX3JlbG9jKGZkLCBlLT5l
eGVjX2lkIHwgZS0+ZmxhZ3MsIDApOworCQkJbmVnYXRpdmVfcmVsb2MoZmQsIGViX3JpbmcoZSks
IDApOwogCiAJCWlndF9zdWJ0ZXN0X2YoIm5lZ2F0aXZlLXJlbG9jLWx1dC0lcyIsIGUtPm5hbWUp
Ci0JCQluZWdhdGl2ZV9yZWxvYyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBVU0VfTFVUKTsK
KwkJCW5lZ2F0aXZlX3JlbG9jKGZkLCBlYl9yaW5nKGUpLCBVU0VfTFVUKTsKIAl9CiAKIAlpZ3Rf
c3VidGVzdCgibmVnYXRpdmUtcmVsb2MtYmx0Y29weSIpCmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1
L2dlbV9idXN5LmMgYi90ZXN0cy9pOTE1L2dlbV9idXN5LmMKaW5kZXggYTU1MzU4NzA4Li5hODM4
ODE0OWIgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2J1c3kuYworKysgYi90ZXN0cy9pOTE1
L2dlbV9idXN5LmMKQEAgLTMxOSw4ICszMTksOCBAQCBzdGF0aWMgdm9pZCBjbG9zZV9yYWNlKGlu
dCBmZCkKIAkgKi8KIAogCW5lbmdpbmUgPSAwOwotCWZvcl9lYWNoX2VuZ2luZShmZCwgaSkKLQkJ
ZW5naW5lc1tuZW5naW5lKytdID0gaTsKKwlmb3JfZWFjaF9lbmdpbmUoZSwgZmQpCisJCWVuZ2lu
ZXNbbmVuZ2luZSsrXSA9IGViX3JpbmcoZSk7CiAJaWd0X3JlcXVpcmUobmVuZ2luZSk7CiAKIAlj
b250cm9sID0gbW1hcChOVUxMLCA0MDk2LCBQUk9UX1dSSVRFLCBNQVBfU0hBUkVEIHwgTUFQX0FO
T04sIC0xLCAwKTsKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX2NvbmN1cnJlbnRfYWxsLmMg
Yi90ZXN0cy9pOTE1L2dlbV9jb25jdXJyZW50X2FsbC5jCmluZGV4IDI2Njk5NWQxNC4uOTkyYmVh
NjJlIDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9jb25jdXJyZW50X2FsbC5jCisrKyBiL3Rl
c3RzL2k5MTUvZ2VtX2NvbmN1cnJlbnRfYWxsLmMKQEAgLTk0OSwxNSArOTQ5LDE0IEBAIHN0YXRp
YyBpZ3RfaGFuZ190IHJjc19oYW5nKHZvaWQpCiBzdGF0aWMgaWd0X2hhbmdfdCBhbGxfaGFuZyh2
b2lkKQogewogCWlndF9oYW5nX3QgaGFuZyA9IGlndF9oYW5nX3JpbmcoZmQsIEk5MTVfRVhFQ19S
RU5ERVIpOwotCXVuc2lnbmVkIGVuZ2luZTsKIAotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShm
ZCwgZW5naW5lKSB7CisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7CiAJCXN0cnVj
dCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgZWIgPSBoYW5nLnNwaW4tPmV4ZWNidWY7CiAKLQkJ
aWYgKGVuZ2luZSA9PSBJOTE1X0VYRUNfUkVOREVSKQorCQllYi5mbGFncyA9IGViX3JpbmcoZSk7
CisJCWlmIChlYi5mbGFncyA9PSBJOTE1X0VYRUNfUkVOREVSKQogCQkJY29udGludWU7CiAKLQkJ
ZWIuZmxhZ3MgPSBlbmdpbmU7CiAJCV9fZ2VtX2V4ZWNidWYoZmQsICZlYik7CiAJfQogCmRpZmYg
LS1naXQgYS90ZXN0cy9pOTE1L2dlbV9jc19wcmVmZXRjaC5jIGIvdGVzdHMvaTkxNS9nZW1fY3Nf
cHJlZmV0Y2guYwppbmRleCAyYjg2NTM2ODcuLjE3MTkwODU3NiAxMDA2NDQKLS0tIGEvdGVzdHMv
aTkxNS9nZW1fY3NfcHJlZmV0Y2guYworKysgYi90ZXN0cy9pOTE1L2dlbV9jc19wcmVmZXRjaC5j
CkBAIC0xNDUsNSArMTQ1LDUgQEAgaWd0X21haW4KIAogCWZvciAoZSA9IGludGVsX2V4ZWN1dGlv
bl9lbmdpbmVzOyBlLT5uYW1lOyBlKyspCiAJCWlndF9zdWJ0ZXN0X2YoIiVzIiwgZS0+bmFtZSkK
LQkJCXRlc3RfcmluZyhlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpOworCQkJdGVzdF9yaW5nKGViX3Jp
bmcoZSkpOwogfQpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fY3R4X2NyZWF0ZS5jIGIvdGVz
dHMvaTkxNS9nZW1fY3R4X2NyZWF0ZS5jCmluZGV4IDFlMmM0MGM0Zi4uODNkYTA1NjkwIDEwMDY0
NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9jdHhfY3JlYXRlLmMKKysrIGIvdGVzdHMvaTkxNS9nZW1f
Y3R4X2NyZWF0ZS5jCkBAIC01MjcsMTQgKzUyNywxMiBAQCBpZ3RfbWFpbgogCWludCBmZCA9IC0x
OwogCiAJaWd0X2ZpeHR1cmUgewotCQl1bnNpZ25lZCBlbmdpbmU7Ci0KIAkJZmQgPSBkcm1fb3Bl
bl9kcml2ZXIoRFJJVkVSX0lOVEVMKTsKIAkJaWd0X3JlcXVpcmVfZ2VtKGZkKTsKIAkJZ2VtX3Jl
cXVpcmVfY29udGV4dHMoZmQpOwogCi0JCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgZW5n
aW5lKQotCQkJYWxsX2VuZ2luZXNbYWxsX25lbmdpbmUrK10gPSBlbmdpbmU7CisJCWZvcl9lYWNo
X3BoeXNpY2FsX2VuZ2luZShlLCBmZCkKKwkJCWFsbF9lbmdpbmVzW2FsbF9uZW5naW5lKytdID0g
ZWJfcmluZyhlKTsKIAkJaWd0X3JlcXVpcmUoYWxsX25lbmdpbmUpOwogCiAJCWlmIChnZW1fdXNl
c19mdWxsX3BwZ3R0KGZkKSkgewpAQCAtNTgyLDEyICs1ODAsMTIgQEAgaWd0X21haW4KIAlmb3Ig
KGNvbnN0IHN0cnVjdCBpbnRlbF9leGVjdXRpb25fZW5naW5lICplID0gaW50ZWxfZXhlY3V0aW9u
X2VuZ2luZXM7CiAJICAgICBlLT5uYW1lOyBlKyspIHsKIAkJaWd0X3N1YnRlc3RfZigiYWN0aXZl
LSVzIiwgZS0+bmFtZSkKLQkJCWFjdGl2ZShmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCAyMCwg
MSk7CisJCQlhY3RpdmUoZmQsIGViX3JpbmcoZSksIDIwLCAxKTsKIAkJaWd0X3N1YnRlc3RfZigi
Zm9ya2VkLWFjdGl2ZS0lcyIsIGUtPm5hbWUpCi0JCQlhY3RpdmUoZmQsIGUtPmV4ZWNfaWQgfCBl
LT5mbGFncywgMjAsIG5jcHVzKTsKKwkJCWFjdGl2ZShmZCwgZWJfcmluZyhlKSwgMjAsIG5jcHVz
KTsKIAkJaWYgKGUtPmV4ZWNfaWQpIHsKIAkJCWlndF9zdWJ0ZXN0X2YoImhvZy0lcyIsIGUtPm5h
bWUpCi0JCQkJYWN0aXZlKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDIwLCAtMSk7CisJCQkJ
YWN0aXZlKGZkLCBlYl9yaW5nKGUpLCAyMCwgLTEpOwogCQl9CiAJfQogCmRpZmYgLS1naXQgYS90
ZXN0cy9pOTE1L2dlbV9jdHhfc2hhcmVkLmMgYi90ZXN0cy9pOTE1L2dlbV9jdHhfc2hhcmVkLmMK
aW5kZXggZjc4NTI0ODIyLi42ZDhjYmNjZTIgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2N0
eF9zaGFyZWQuYworKysgYi90ZXN0cy9pOTE1L2dlbV9jdHhfc2hhcmVkLmMKQEAgLTMyNiw3ICsz
MjYsNiBAQCBzdGF0aWMgdm9pZCBzaW5nbGVfdGltZWxpbmUoaW50IGk5MTUpCiAJc3RydWN0IHN5
bmNfZmlsZV9pbmZvIHN5bmNfZmlsZV9pbmZvID0gewogCQkubnVtX2ZlbmNlcyA9IDEsCiAJfTsK
LQl1bnNpZ25lZCBpbnQgZW5naW5lOwogCWludCBuOwogCiAJaWd0X3JlcXVpcmUoaGFzX3Npbmds
ZV90aW1lbGluZShpOTE1KSk7CkBAIC0zNDcsNyArMzQ2LDcgQEAgc3RhdGljIHZvaWQgc2luZ2xl
X3RpbWVsaW5lKGludCBpOTE1KQogCQkJCSAgSTkxNV9DT05URVhUX0NSRUFURV9GTEFHU19TSU5H
TEVfVElNRUxJTkUpOwogCWV4ZWNidWYuZmxhZ3MgPSBJOTE1X0VYRUNfRkVOQ0VfT1VUOwogCW4g
PSAwOwotCWZvcl9lYWNoX2VuZ2luZShpOTE1LCBlbmdpbmUpIHsKKwlmb3JfZWFjaF9lbmdpbmUo
ZSwgaTkxNSkgewogCQlnZW1fZXhlY2J1Zl93cihpOTE1LCAmZXhlY2J1Zik7CiAJCXN5bmNfZmls
ZV9pbmZvLnN5bmNfZmVuY2VfaW5mbyA9IHRvX3VzZXJfcG9pbnRlcigmcmluZ3Nbbl0pOwogCQlk
b19pb2N0bChleGVjYnVmLnJzdmQyID4+IDMyLCBTWU5DX0lPQ19GSUxFX0lORk8sICZzeW5jX2Zp
bGVfaW5mbyk7CkBAIC0zNjgsNyArMzY3LDYgQEAgc3RhdGljIHZvaWQgc2luZ2xlX3RpbWVsaW5l
KGludCBpOTE1KQogCiBzdGF0aWMgdm9pZCBleGVjX3NpbmdsZV90aW1lbGluZShpbnQgaTkxNSwg
dW5zaWduZWQgaW50IGVuZ2luZSkKIHsKLQl1bnNpZ25lZCBpbnQgb3RoZXI7CiAJaWd0X3NwaW5f
dCAqc3BpbjsKIAl1aW50MzJfdCBjdHg7CiAKQEAgLTM4MSwxNyArMzc5LDE3IEBAIHN0YXRpYyB2
b2lkIGV4ZWNfc2luZ2xlX3RpbWVsaW5lKGludCBpOTE1LCB1bnNpZ25lZCBpbnQgZW5naW5lKQog
CSAqLwogCWN0eCA9IDA7CiAJc3BpbiA9IE5VTEw7Ci0JZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5l
KGk5MTUsIG90aGVyKSB7Ci0JCWlmIChvdGhlciA9PSBlbmdpbmUpCisJZm9yX2VhY2hfcGh5c2lj
YWxfZW5naW5lKGUsIGk5MTUpIHsKKwkJaWYgKGViX3JpbmcoZSkgPT0gZW5naW5lKQogCQkJY29u
dGludWU7CiAKIAkJaWYgKHNwaW4gPT0gTlVMTCkgewotCQkJc3BpbiA9IF9faWd0X3NwaW5fbmV3
KGk5MTUsIC5jdHggPSBjdHgsIC5lbmdpbmUgPSBvdGhlcik7CisJCQlzcGluID0gX19pZ3Rfc3Bp
bl9uZXcoaTkxNSwgLmN0eCA9IGN0eCwgLmVuZ2luZSA9IGViX3JpbmcoZSkpOwogCQl9IGVsc2Ug
ewogCQkJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiBleGVjYnVmID0gewogCQkJCS5i
dWZmZXJzX3B0ciA9IHNwaW4tPmV4ZWNidWYuYnVmZmVyc19wdHIsCiAJCQkJLmJ1ZmZlcl9jb3Vu
dCA9IHNwaW4tPmV4ZWNidWYuYnVmZmVyX2NvdW50LAotCQkJCS5mbGFncyA9IG90aGVyLAorCQkJ
CS5mbGFncyA9IGViX3JpbmcoZSksCiAJCQkJLnJzdmQxID0gY3R4LAogCQkJfTsKIAkJCWdlbV9l
eGVjYnVmKGk5MTUsICZleGVjYnVmKTsKQEAgLTQwOSwxNyArNDA3LDE3IEBAIHN0YXRpYyB2b2lk
IGV4ZWNfc2luZ2xlX3RpbWVsaW5lKGludCBpOTE1LCB1bnNpZ25lZCBpbnQgZW5naW5lKQogCWN0
eCA9IGdlbV9jb250ZXh0X2Nsb25lKGk5MTUsIDAsIDAsCiAJCQkJSTkxNV9DT05URVhUX0NSRUFU
RV9GTEFHU19TSU5HTEVfVElNRUxJTkUpOwogCXNwaW4gPSBOVUxMOwotCWZvcl9lYWNoX3BoeXNp
Y2FsX2VuZ2luZShpOTE1LCBvdGhlcikgewotCQlpZiAob3RoZXIgPT0gZW5naW5lKQorCWZvcl9l
YWNoX3BoeXNpY2FsX2VuZ2luZShlLCBpOTE1KSB7CisJCWlmIChlYl9yaW5nKGUpID09IGVuZ2lu
ZSkKIAkJCWNvbnRpbnVlOwogCiAJCWlmIChzcGluID09IE5VTEwpIHsKLQkJCXNwaW4gPSBfX2ln
dF9zcGluX25ldyhpOTE1LCAuY3R4ID0gY3R4LCAuZW5naW5lID0gb3RoZXIpOworCQkJc3BpbiA9
IF9faWd0X3NwaW5fbmV3KGk5MTUsIC5jdHggPSBjdHgsIC5lbmdpbmUgPSBlYl9yaW5nKGUpKTsK
IAkJfSBlbHNlIHsKIAkJCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgZXhlY2J1ZiA9
IHsKIAkJCQkuYnVmZmVyc19wdHIgPSBzcGluLT5leGVjYnVmLmJ1ZmZlcnNfcHRyLAogCQkJCS5i
dWZmZXJfY291bnQgPSBzcGluLT5leGVjYnVmLmJ1ZmZlcl9jb3VudCwKLQkJCQkuZmxhZ3MgPSBv
dGhlciwKKwkJCQkuZmxhZ3MgPSBlYl9yaW5nKGUpLAogCQkJCS5yc3ZkMSA9IGN0eCwKIAkJCX07
CiAJCQlnZW1fZXhlY2J1ZihpOTE1LCAmZXhlY2J1Zik7CkBAIC03NDIsOCArNzQwLDggQEAgc3Rh
dGljIHZvaWQgc21va2V0ZXN0KGludCBpOTE1LCB1bnNpZ25lZCByaW5nLCB1bnNpZ25lZCB0aW1l
b3V0KQogCXVpbnQzMl90ICpwdHI7CiAKIAluZW5naW5lID0gMDsKLQlmb3JfZWFjaF9waHlzaWNh
bF9lbmdpbmUoaTkxNSwgZW5naW5lKQotCQllbmdpbmVzW25lbmdpbmUrK10gPSBlbmdpbmU7CisJ
Zm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGk5MTUpCisJCWVuZ2luZXNbbmVuZ2luZSsrXSA9
IGViX3JpbmcoZSk7CiAJaWd0X3JlcXVpcmUobmVuZ2luZSk7CiAKIAlzY3JhdGNoID0gZ2VtX2Ny
ZWF0ZShpOTE1LCA0MDk2KTsKQEAgLTgyNywxMSArODI1LDEwIEBAIGlndF9tYWluCiAKIAkJZm9y
IChlID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7IGUtPm5hbWU7IGUrKykgewogCQkJaWd0X3N1
YnRlc3RfZigiZXhlYy1zaGFyZWQtZ3R0LSVzIiwgZS0+bmFtZSkKLQkJCQlleGVjX3NoYXJlZF9n
dHQoaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKKwkJCQlleGVjX3NoYXJlZF9ndHQoaTkx
NSwgZWJfcmluZyhlKSk7CiAKIAkJCWlndF9zdWJ0ZXN0X2YoImV4ZWMtc2luZ2xlLXRpbWVsaW5l
LSVzIiwgZS0+bmFtZSkKLQkJCQlleGVjX3NpbmdsZV90aW1lbGluZShpOTE1LAotCQkJCQkJICAg
ICBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpOworCQkJCWV4ZWNfc2luZ2xlX3RpbWVsaW5lKGk5MTUs
IGViX3JpbmcoZSkpOwogCiAJCQkvKgogCQkJICogQ2hlY2sgdGhhdCB0aGUgc2hhcmVkIGNvbnRl
eHRzIG9wZXJhdGUgaW5kZXBlbmRlbnRseSwKQEAgLTg0MiwyNiArODM5LDI2IEBAIGlndF9tYWlu
CiAJCQkgKi8KIAkJCWlndF9zdWJ0ZXN0X2dyb3VwIHsKIAkJCQlpZ3RfZml4dHVyZSB7Ci0JCQkJ
CWdlbV9yZXF1aXJlX3JpbmcoaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKLQkJCQkJaWd0
X3JlcXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChpOTE1LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3Mp
KTsKKwkJCQkJZ2VtX3JlcXVpcmVfcmluZyhpOTE1LCBlYl9yaW5nKGUpKTsKKwkJCQkJaWd0X3Jl
cXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChpOTE1LCBlYl9yaW5nKGUpKSk7CiAJCQkJCWlndF9y
ZXF1aXJlKGdlbV9zY2hlZHVsZXJfZW5hYmxlZChpOTE1KSk7CiAJCQkJCWlndF9yZXF1aXJlKGdl
bV9zY2hlZHVsZXJfaGFzX2N0eF9wcmlvcml0eShpOTE1KSk7CiAJCQkJfQogCiAJCQkJaWd0X3N1
YnRlc3RfZigiUS1pbmRlcGVuZGVudC0lcyIsIGUtPm5hbWUpCi0JCQkJCWluZGVwZW5kZW50KGk5
MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgMCk7CisJCQkJCWluZGVwZW5kZW50KGk5MTUsIGVi
X3JpbmcoZSksIDApOwogCiAJCQkJaWd0X3N1YnRlc3RfZigiUS1pbi1vcmRlci0lcyIsIGUtPm5h
bWUpCi0JCQkJCXJlb3JkZXIoaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBFUVVBTCk7CisJ
CQkJCXJlb3JkZXIoaTkxNSwgZWJfcmluZyhlKSwgRVFVQUwpOwogCiAJCQkJaWd0X3N1YnRlc3Rf
ZigiUS1vdXQtb3JkZXItJXMiLCBlLT5uYW1lKQotCQkJCQlyZW9yZGVyKGk5MTUsIGUtPmV4ZWNf
aWQgfCBlLT5mbGFncywgMCk7CisJCQkJCXJlb3JkZXIoaTkxNSwgZWJfcmluZyhlKSwgMCk7CiAK
IAkJCQlpZ3Rfc3VidGVzdF9mKCJRLXByb21vdGlvbi0lcyIsIGUtPm5hbWUpCi0JCQkJCXByb21v
dGlvbihpOTE1LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpOworCQkJCQlwcm9tb3Rpb24oaTkxNSwg
ZWJfcmluZyhlKSk7CiAKIAkJCQlpZ3Rfc3VidGVzdF9mKCJRLXNtb2tldGVzdC0lcyIsIGUtPm5h
bWUpCi0JCQkJCXNtb2tldGVzdChpOTE1LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDUpOworCQkJ
CQlzbW9rZXRlc3QoaTkxNSwgZWJfcmluZyhlKSwgNSk7CiAJCQl9CiAJCX0KIApkaWZmIC0tZ2l0
IGEvdGVzdHMvaTkxNS9nZW1fY3R4X3N3aXRjaC5jIGIvdGVzdHMvaTkxNS9nZW1fY3R4X3N3aXRj
aC5jCmluZGV4IGMwNzFkZWY3OC4uMzZlY2Q1Mzc2IDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dl
bV9jdHhfc3dpdGNoLmMKKysrIGIvdGVzdHMvaTkxNS9nZW1fY3R4X3N3aXRjaC5jCkBAIC0zNDks
NyArMzQ5LDcgQEAgaWd0X21haW4KIAlmb3IgKGUgPSBpbnRlbF9leGVjdXRpb25fZW5naW5lczsg
ZS0+bmFtZTsgZSsrKSB7CiAJCXN0cnVjdCBpbnRlbF9leGVjdXRpb25fZW5naW5lMiBlMl9fOwog
Ci0JCWUyX18gPSBnZW1fZWJfZmxhZ3NfdG9fZW5naW5lKGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7
CisJCWUyX18gPSBnZW1fZWJfZmxhZ3NfdG9fZW5naW5lKGViX3JpbmcoZSkpOwogCQlpZiAoZTJf
Xy5mbGFncyA9PSAtMSkKIAkJCWNvbnRpbnVlOyAvKiBJOTE1X0VYRUNfQlNEIHdpdGggbm8gcmlu
ZyBzZWxlY3RvcnMgKi8KIApkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fY3R4X3RocmFzaC5j
IGIvdGVzdHMvaTkxNS9nZW1fY3R4X3RocmFzaC5jCmluZGV4IGIyNWY5NWYxMy4uNjJjMjZlOWEw
IDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9jdHhfdGhyYXNoLmMKKysrIGIvdGVzdHMvaTkx
NS9nZW1fY3R4X3RocmFzaC5jCkBAIC0xMDMsMTMgKzEwMywxMSBAQCBzdGF0aWMgdm9pZCBzaW5n
bGUoY29uc3QgY2hhciAqbmFtZSwgYm9vbCBhbGxfZW5naW5lcykKIAogCW51bV9lbmdpbmVzID0g
MDsKIAlpZiAoYWxsX2VuZ2luZXMpIHsKLQkJdW5zaWduZWQgZW5naW5lOwotCi0JCWZvcl9lYWNo
X3BoeXNpY2FsX2VuZ2luZShmZCwgZW5naW5lKSB7Ci0JCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdv
cmQoZmQsIGVuZ2luZSkpCisJCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkgeworCQkJ
aWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5nKGUpKSkKIAkJCQljb250aW51ZTsK
IAotCQkJZW5naW5lc1tudW1fZW5naW5lcysrXSA9IGVuZ2luZTsKKwkJCWVuZ2luZXNbbnVtX2Vu
Z2luZXMrK10gPSBlYl9yaW5nKGUpOwogCQkJaWYgKG51bV9lbmdpbmVzID09IEFSUkFZX1NJWkUo
ZW5naW5lcykpCiAJCQkJYnJlYWs7CiAJCX0KQEAgLTIyMCw3ICsyMTgsNyBAQCBzdGF0aWMgdm9p
ZCBzaW5nbGUoY29uc3QgY2hhciAqbmFtZSwgYm9vbCBhbGxfZW5naW5lcykKIAogc3RhdGljIHZv
aWQgcHJvY2Vzc2VzKHZvaWQpCiB7Ci0JdW5zaWduZWQgZW5naW5lc1sxNl0sIGVuZ2luZTsKKwl1
bnNpZ25lZCBlbmdpbmVzWzE2XTsKIAlpbnQgbnVtX2VuZ2luZXM7CiAJc3RydWN0IHJsaW1pdCBy
bGltOwogCXVuc2lnbmVkIG51bV9jdHg7CkBAIC0yMzAsOCArMjI4LDggQEAgc3RhdGljIHZvaWQg
cHJvY2Vzc2VzKHZvaWQpCiAJZmQgPSBkcm1fb3Blbl9kcml2ZXIoRFJJVkVSX0lOVEVMKTsKIAog
CW51bV9lbmdpbmVzID0gMDsKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIGVuZ2luZSkg
ewotCQllbmdpbmVzW251bV9lbmdpbmVzKytdID0gZW5naW5lOworCWZvcl9lYWNoX3BoeXNpY2Fs
X2VuZ2luZShlLCBmZCkgeworCQllbmdpbmVzW251bV9lbmdpbmVzKytdID0gZWJfcmluZyhlKTsK
IAkJaWYgKG51bV9lbmdpbmVzID09IEFSUkFZX1NJWkUoZW5naW5lcykpCiAJCQlicmVhazsKIAl9
CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9laW8uYyBiL3Rlc3RzL2k5MTUvZ2VtX2Vpby5j
CmluZGV4IDg5MmYzNjU3Yy4uOGQ2Y2I5NzYwIDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9l
aW8uYworKysgYi90ZXN0cy9pOTE1L2dlbV9laW8uYwpAQCAtNDI3LDcgKzQyNyw2IEBAIHN0YXRp
YyB2b2lkIHRlc3Rfc3VzcGVuZChpbnQgZmQsIGludCBzdGF0ZSkKIHN0YXRpYyB2b2lkIHRlc3Rf
aW5mbGlnaHQoaW50IGZkLCB1bnNpZ25lZCBpbnQgd2FpdCkKIHsKIAlpbnQgcGFyZW50X2ZkID0g
ZmQ7Ci0JdW5zaWduZWQgaW50IGVuZ2luZTsKIAlpbnQgZmVuY2VbNjRdOyAvKiBtb3N0bHkgY29u
c2VydmF0aXZlIGVzdGltYXRlIG9mIHJpbmcgc2l6ZSAqLwogCWludCBtYXg7CiAKQEAgLTQzOSw3
ICs0MzgsNyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2luZmxpZ2h0KGludCBmZCwgdW5zaWduZWQgaW50
IHdhaXQpCiAJbWF4ID0gbWluKG1heCAtIDEsIEFSUkFZX1NJWkUoZmVuY2UpKTsKIAlpZ3RfZGVi
dWcoIlVzaW5nICVkIGluZmxpZ2h0IGJhdGNoZXNcbiIsIG1heCk7CiAKLQlmb3JfZWFjaF9lbmdp
bmUocGFyZW50X2ZkLCBlbmdpbmUpIHsKKwlmb3JfZWFjaF9lbmdpbmUoZSwgcGFyZW50X2ZkKSB7
CiAJCWNvbnN0IHVpbnQzMl90IGJiZSA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7CiAJCXN0cnVjdCBk
cm1faTkxNV9nZW1fZXhlY19vYmplY3QyIG9ialsyXTsKIAkJc3RydWN0IGRybV9pOTE1X2dlbV9l
eGVjYnVmZmVyMiBleGVjYnVmOwpAQCAtNDU0LDE2ICs0NTMsMTYgQEAgc3RhdGljIHZvaWQgdGVz
dF9pbmZsaWdodChpbnQgZmQsIHVuc2lnbmVkIGludCB3YWl0KQogCQlnZW1fd3JpdGUoZmQsIG9i
alsxXS5oYW5kbGUsIDAsICZiYmUsIHNpemVvZihiYmUpKTsKIAogCQlnZW1fcXVpZXNjZW50X2dw
dShmZCk7Ci0JCWlndF9kZWJ1ZygiU3RhcnRpbmcgJXMgb24gZW5naW5lICclcydcbiIsIF9fZnVu
Y19fLCBlX18tPm5hbWUpOworCQlpZ3RfZGVidWcoIlN0YXJ0aW5nICVzIG9uIGVuZ2luZSAnJXMn
XG4iLCBfX2Z1bmNfXywgZS0+bmFtZSk7CiAJCWlndF9yZXF1aXJlKGk5MTVfcmVzZXRfY29udHJv
bChmYWxzZSkpOwogCi0JCWhhbmcgPSBzcGluX3N5bmMoZmQsIDAsIGVuZ2luZSk7CisJCWhhbmcg
PSBzcGluX3N5bmMoZmQsIDAsIGViX3JpbmcoZSkpOwogCQlvYmpbMF0uaGFuZGxlID0gaGFuZy0+
aGFuZGxlOwogCiAJCW1lbXNldCgmZXhlY2J1ZiwgMCwgc2l6ZW9mKGV4ZWNidWYpKTsKIAkJZXhl
Y2J1Zi5idWZmZXJzX3B0ciA9IHRvX3VzZXJfcG9pbnRlcihvYmopOwogCQlleGVjYnVmLmJ1ZmZl
cl9jb3VudCA9IDI7Ci0JCWV4ZWNidWYuZmxhZ3MgPSBlbmdpbmUgfCBJOTE1X0VYRUNfRkVOQ0Vf
T1VUOworCQlleGVjYnVmLmZsYWdzID0gZWJfcmluZyhlKSB8IEk5MTVfRVhFQ19GRU5DRV9PVVQ7
CiAKIAkJZm9yICh1bnNpZ25lZCBpbnQgbiA9IDA7IG4gPCBtYXg7IG4rKykgewogCQkJZ2VtX2V4
ZWNidWZfd3IoZmQsICZleGVjYnVmKTsKQEAgLTU2MywxMyArNTYyLDEyIEBAIHN0YXRpYyB1aW50
MzJfdCBjb250ZXh0X2NyZWF0ZV9zYWZlKGludCBpOTE1KQogc3RhdGljIHZvaWQgdGVzdF9pbmZs
aWdodF9jb250ZXh0cyhpbnQgZmQsIHVuc2lnbmVkIGludCB3YWl0KQogewogCWludCBwYXJlbnRf
ZmQgPSBmZDsKLQl1bnNpZ25lZCBpbnQgZW5naW5lOwogCiAJaWd0X3JlcXVpcmVfZ2VtKGZkKTsK
IAlpZ3RfcmVxdWlyZShnZW1faGFzX2V4ZWNfZmVuY2UoZmQpKTsKIAlnZW1fcmVxdWlyZV9jb250
ZXh0cyhmZCk7CiAKLQlmb3JfZWFjaF9lbmdpbmUocGFyZW50X2ZkLCBlbmdpbmUpIHsKKwlmb3Jf
ZWFjaF9lbmdpbmUoZSwgcGFyZW50X2ZkKSB7CiAJCWNvbnN0IHVpbnQzMl90IGJiZSA9IE1JX0JB
VENIX0JVRkZFUl9FTkQ7CiAJCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY19vYmplY3QyIG9ialsy
XTsKIAkJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiBleGVjYnVmOwpAQCAtNTg2LDcg
KzU4NCw3IEBAIHN0YXRpYyB2b2lkIHRlc3RfaW5mbGlnaHRfY29udGV4dHMoaW50IGZkLCB1bnNp
Z25lZCBpbnQgd2FpdCkKIAogCQlnZW1fcXVpZXNjZW50X2dwdShmZCk7CiAKLQkJaWd0X2RlYnVn
KCJTdGFydGluZyAlcyBvbiBlbmdpbmUgJyVzJ1xuIiwgX19mdW5jX18sIGVfXy0+bmFtZSk7CisJ
CWlndF9kZWJ1ZygiU3RhcnRpbmcgJXMgb24gZW5naW5lICclcydcbiIsIF9fZnVuY19fLCBlLT5u
YW1lKTsKIAkJaWd0X3JlcXVpcmUoaTkxNV9yZXNldF9jb250cm9sKGZhbHNlKSk7CiAKIAkJbWVt
c2V0KG9iaiwgMCwgc2l6ZW9mKG9iaikpOwpAQCAtNTk0LDEzICs1OTIsMTMgQEAgc3RhdGljIHZv
aWQgdGVzdF9pbmZsaWdodF9jb250ZXh0cyhpbnQgZmQsIHVuc2lnbmVkIGludCB3YWl0KQogCQlv
YmpbMV0uaGFuZGxlID0gZ2VtX2NyZWF0ZShmZCwgNDA5Nik7CiAJCWdlbV93cml0ZShmZCwgb2Jq
WzFdLmhhbmRsZSwgMCwgJmJiZSwgc2l6ZW9mKGJiZSkpOwogCi0JCWhhbmcgPSBzcGluX3N5bmMo
ZmQsIDAsIGVuZ2luZSk7CisJCWhhbmcgPSBzcGluX3N5bmMoZmQsIDAsIGViX3JpbmcoZSkpOwog
CQlvYmpbMF0uaGFuZGxlID0gaGFuZy0+aGFuZGxlOwogCiAJCW1lbXNldCgmZXhlY2J1ZiwgMCwg
c2l6ZW9mKGV4ZWNidWYpKTsKIAkJZXhlY2J1Zi5idWZmZXJzX3B0ciA9IHRvX3VzZXJfcG9pbnRl
cihvYmopOwogCQlleGVjYnVmLmJ1ZmZlcl9jb3VudCA9IDI7Ci0JCWV4ZWNidWYuZmxhZ3MgPSBl
bmdpbmUgfCBJOTE1X0VYRUNfRkVOQ0VfT1VUOworCQlleGVjYnVmLmZsYWdzID0gZWJfcmluZyhl
KSB8IEk5MTVfRVhFQ19GRU5DRV9PVVQ7CiAKIAkJY291bnQgPSAwOwogCQlmb3IgKHVuc2lnbmVk
IGludCBuID0gMDsgbiA8IEFSUkFZX1NJWkUoZmVuY2UpOyBuKyspIHsKQEAgLTY5MSw3ICs2ODks
NyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2luZmxpZ2h0X2ludGVybmFsKGludCBmZCwgdW5zaWduZWQg
aW50IHdhaXQpCiAJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiBleGVjYnVmOwogCXN0
cnVjdCBkcm1faTkxNV9nZW1fZXhlY19vYmplY3QyIG9ialsyXTsKIAl1aW50MzJfdCBiYmUgPSBN
SV9CQVRDSF9CVUZGRVJfRU5EOwotCXVuc2lnbmVkIGVuZ2luZSwgbmZlbmNlID0gMDsKKwl1bnNp
Z25lZCBuZmVuY2UgPSAwOwogCWludCBmZW5jZXNbMTZdOwogCWlndF9zcGluX3QgKmhhbmc7CiAK
QEAgLTcxMiw4ICs3MTAsOCBAQCBzdGF0aWMgdm9pZCB0ZXN0X2luZmxpZ2h0X2ludGVybmFsKGlu
dCBmZCwgdW5zaWduZWQgaW50IHdhaXQpCiAJbWVtc2V0KCZleGVjYnVmLCAwLCBzaXplb2YoZXhl
Y2J1ZikpOwogCWV4ZWNidWYuYnVmZmVyc19wdHIgPSB0b191c2VyX3BvaW50ZXIob2JqKTsKIAll
eGVjYnVmLmJ1ZmZlcl9jb3VudCA9IDI7Ci0JZm9yX2VhY2hfZW5naW5lKGZkLCBlbmdpbmUpIHsK
LQkJZXhlY2J1Zi5mbGFncyA9IGVuZ2luZSB8IEk5MTVfRVhFQ19GRU5DRV9PVVQ7CisJZm9yX2Vh
Y2hfZW5naW5lKGUsIGZkKSB7CisJCWV4ZWNidWYuZmxhZ3MgPSBlYl9yaW5nKGUpIHwgSTkxNV9F
WEVDX0ZFTkNFX09VVDsKIAogCQlnZW1fZXhlY2J1Zl93cihmZCwgJmV4ZWNidWYpOwogCkBAIC04
MjIsMTAgKzgyMCw5IEBAIHN0YXRpYyB2b2lkIHJlc2V0X3N0cmVzcyhpbnQgZmQsIHVpbnQzMl90
IGN0eDAsCiBzdGF0aWMgdm9pZCB0ZXN0X3Jlc2V0X3N0cmVzcyhpbnQgZmQsIHVuc2lnbmVkIGlu
dCBmbGFncykKIHsKIAl1aW50MzJfdCBjdHgwID0gY29udGV4dF9jcmVhdGVfc2FmZShmZCk7Ci0J
dW5zaWduZWQgaW50IGVuZ2luZTsKIAotCWZvcl9lYWNoX2VuZ2luZShmZCwgZW5naW5lKQotCQly
ZXNldF9zdHJlc3MoZmQsIGN0eDAsIGVfXy0+bmFtZSwgZW5naW5lLCBmbGFncyk7CisJZm9yX2Vh
Y2hfZW5naW5lKGUsIGZkKQorCQlyZXNldF9zdHJlc3MoZmQsIGN0eDAsIGUtPm5hbWUsIGViX3Jp
bmcoZSksIGZsYWdzKTsKIAogCWdlbV9jb250ZXh0X2Rlc3Ryb3koZmQsIGN0eDApOwogfQpkaWZm
IC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fZXhlY19hc3luYy5jIGIvdGVzdHMvaTkxNS9nZW1fZXhl
Y19hc3luYy5jCmluZGV4IDlhMDZhZjdlMi4uZDgzZTlmNmRiIDEwMDY0NAotLS0gYS90ZXN0cy9p
OTE1L2dlbV9leGVjX2FzeW5jLmMKKysrIGIvdGVzdHMvaTkxNS9nZW1fZXhlY19hc3luYy5jCkBA
IC04OCw3ICs4OCw2IEBAIHN0YXRpYyB2b2lkIG9uZShpbnQgZmQsIHVuc2lnbmVkIHJpbmcsIHVp
bnQzMl90IGZsYWdzKQogI2RlZmluZSBCQVRDSCAxCiAJc3RydWN0IGRybV9pOTE1X2dlbV9yZWxv
Y2F0aW9uX2VudHJ5IHJlbG9jOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgZXhl
Y2J1ZjsKLQl1bnNpZ25lZCBpbnQgb3RoZXI7CiAJdWludDMyX3QgKmJhdGNoOwogCWludCBpOwog
CkBAIC0xNDMsMTQgKzE0MiwxNCBAQCBzdGF0aWMgdm9pZCBvbmUoaW50IGZkLCB1bnNpZ25lZCBy
aW5nLCB1aW50MzJfdCBmbGFncykKIAlnZW1fY2xvc2UoZmQsIG9ialtCQVRDSF0uaGFuZGxlKTsK
IAogCWkgPSAwOwotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgb3RoZXIpIHsKLQkJaWYg
KG90aGVyID09IHJpbmcpCisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7CisJCWlm
IChlYl9yaW5nKGUpID09IHJpbmcpCiAJCQljb250aW51ZTsKIAotCQlpZiAoIWdlbV9jYW5fc3Rv
cmVfZHdvcmQoZmQsIG90aGVyKSkKKwkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9y
aW5nKGUpKSkKIAkJCWNvbnRpbnVlOwogCi0JCXN0b3JlX2R3b3JkKGZkLCBvdGhlciwgb2JqW1ND
UkFUQ0hdLmhhbmRsZSwgNCppLCBpKTsKKwkJc3RvcmVfZHdvcmQoZmQsIGViX3JpbmcoZSksIG9i
altTQ1JBVENIXS5oYW5kbGUsIDQqaSwgaSk7CiAJCWkrKzsKIAl9CiAKQEAgLTIwNSw4ICsyMDQs
OCBAQCBpZ3RfbWFpbgogCQkJY29udGludWU7CiAKIAkJaWd0X3N1YnRlc3RfZigiY29uY3VycmVu
dC13cml0ZXMtJXMiLCBlLT5uYW1lKSB7Ci0JCQlpZ3RfcmVxdWlyZShnZW1fcmluZ19oYXNfcGh5
c2ljYWxfZW5naW5lKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpKTsKLQkJCWlndF9yZXF1aXJl
KGdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncykpOworCQkJaWd0
X3JlcXVpcmUoZ2VtX3JpbmdfaGFzX3BoeXNpY2FsX2VuZ2luZShmZCwgZWJfcmluZyhlKSkpOwor
CQkJaWd0X3JlcXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmluZyhlKSkpOwogCQkJ
b25lKGZkLCBlLT5leGVjX2lkLCBlLT5mbGFncyk7CiAJCX0KIAl9CmRpZmYgLS1naXQgYS90ZXN0
cy9pOTE1L2dlbV9leGVjX2F3YWl0LmMgYi90ZXN0cy9pOTE1L2dlbV9leGVjX2F3YWl0LmMKaW5k
ZXggNWNmZWI4ZWM4Li4zM2UyZWU0NWUgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNf
YXdhaXQuYworKysgYi90ZXN0cy9pOTE1L2dlbV9leGVjX2F3YWl0LmMKQEAgLTczLDE0ICs3Mywx
MyBAQCBzdGF0aWMgdm9pZCB3aWRlKGludCBmZCwgaW50IHJpbmdfc2l6ZSwgaW50IHRpbWVvdXQs
IHVuc2lnbmVkIGludCBmbGFncykKIAl9ICpleGVjOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhl
Y19vYmplY3QyICpvYmo7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjYnVmZmVyMiBleGVjYnVm
OwotCXVuc2lnbmVkIGVuZ2luZXNbMTZdOwotCXVuc2lnbmVkIG5lbmdpbmUsIGVuZ2luZTsKKwl1
bnNpZ25lZCBlbmdpbmVzWzE2XSwgbmVuZ2luZTsKIAl1bnNpZ25lZCBsb25nIGNvdW50OwogCWRv
dWJsZSB0aW1lOwogCiAJbmVuZ2luZSA9IDA7Ci0JZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZk
LCBlbmdpbmUpCi0JCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGVuZ2luZTsKKwlmb3JfZWFjaF9waHlz
aWNhbF9lbmdpbmUoZSwgZmQpCisJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGViX3JpbmcoZSk7CiAJ
aWd0X3JlcXVpcmUobmVuZ2luZSk7CiAKIAlleGVjID0gY2FsbG9jKG5lbmdpbmUsIHNpemVvZigq
ZXhlYykpOwpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fZXhlY19jYXB0dXJlLmMgYi90ZXN0
cy9pOTE1L2dlbV9leGVjX2NhcHR1cmUuYwppbmRleCA0NDU3NDk2ZDYuLjU0ZGE1N2FjYSAxMDA2
NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fZXhlY19jYXB0dXJlLmMKKysrIGIvdGVzdHMvaTkxNS9n
ZW1fZXhlY19jYXB0dXJlLmMKQEAgLTU1OCw5ICs1NTgsOSBAQCBpZ3RfbWFpbgogCQkJY29udGlu
dWU7CiAKIAkJaWd0X3N1YnRlc3RfZigiY2FwdHVyZS0lcyIsIGUtPm5hbWUpIHsKLQkJCWlndF9y
ZXF1aXJlKGdlbV9yaW5nX2hhc19waHlzaWNhbF9lbmdpbmUoZmQsIGUtPmV4ZWNfaWQgfCBlLT5m
bGFncykpOwotCQkJaWd0X3JlcXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZS0+ZXhlY19p
ZCB8IGUtPmZsYWdzKSk7Ci0JCQljYXB0dXJlKGZkLCBkaXIsIGUtPmV4ZWNfaWQgfCBlLT5mbGFn
cyk7CisJCQlpZ3RfcmVxdWlyZShnZW1fcmluZ19oYXNfcGh5c2ljYWxfZW5naW5lKGZkLCBlYl9y
aW5nKGUpKSk7CisJCQlpZ3RfcmVxdWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5n
KGUpKSk7CisJCQljYXB0dXJlKGZkLCBkaXIsIGViX3JpbmcoZSkpOwogCQl9CiAJfQogCmRpZmYg
LS1naXQgYS90ZXN0cy9pOTE1L2dlbV9leGVjX2NyZWF0ZS5jIGIvdGVzdHMvaTkxNS9nZW1fZXhl
Y19jcmVhdGUuYwppbmRleCA1NGEyNDI5ZTQuLjg4YzVkZGZkOSAxMDA2NDQKLS0tIGEvdGVzdHMv
aTkxNS9nZW1fZXhlY19jcmVhdGUuYworKysgYi90ZXN0cy9pOTE1L2dlbV9leGVjX2NyZWF0ZS5j
CkBAIC02MSwxMyArNjEsMTEgQEAgc3RhdGljIHZvaWQgYWxsKGludCBmZCwgdW5zaWduZWQgZmxh
Z3MsIGludCB0aW1lb3V0LCBpbnQgbmNwdXMpCiAJY29uc3QgdWludDMyX3QgYmJlID0gTUlfQkFU
Q0hfQlVGRkVSX0VORDsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyIGV4ZWNidWY7
CiAJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIgb2JqOwotCXVuc2lnbmVkIGVuZ2lu
ZXNbMTZdOwotCXVuc2lnbmVkIG5lbmdpbmU7Ci0JdW5zaWduZWQgZW5naW5lOworCXVuc2lnbmVk
IGVuZ2luZXNbMTZdLCBuZW5naW5lOwogCiAJbmVuZ2luZSA9IDA7Ci0JZm9yX2VhY2hfcGh5c2lj
YWxfZW5naW5lKGZkLCBlbmdpbmUpCi0JCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGVuZ2luZTsKKwlm
b3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpCisJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGVi
X3JpbmcoZSk7CiAJaWd0X3JlcXVpcmUobmVuZ2luZSk7CiAKIAltZW1zZXQoJm9iaiwgMCwgc2l6
ZW9mKG9iaikpOwpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fZXhlY19mZW5jZS5jIGIvdGVz
dHMvaTkxNS9nZW1fZXhlY19mZW5jZS5jCmluZGV4IDJmMDRkN2FmNC4uMzY1N2M0YjI3IDEwMDY0
NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9leGVjX2ZlbmNlLmMKKysrIGIvdGVzdHMvaTkxNS9nZW1f
ZXhlY19mZW5jZS5jCkBAIC0yMTYsNyArMjE2LDYgQEAgc3RhdGljIHZvaWQgdGVzdF9mZW5jZV9i
dXN5X2FsbChpbnQgZmQsIHVuc2lnbmVkIGZsYWdzKQogCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhl
Y2J1ZmZlcjIgZXhlY2J1ZjsKIAlzdHJ1Y3QgdGltZXNwZWMgdHY7CiAJdWludDMyX3QgKmJhdGNo
OwotCXVuc2lnbmVkIGludCBlbmdpbmU7CiAJaW50IGFsbCwgaSwgdGltZW91dDsKIAogCWdlbV9x
dWllc2NlbnRfZ3B1KGZkKTsKQEAgLTI2MywxMCArMjYyLDEwIEBAIHN0YXRpYyB2b2lkIHRlc3Rf
ZmVuY2VfYnVzeV9hbGwoaW50IGZkLCB1bnNpZ25lZCBmbGFncykKIAlpKys7CiAKIAlhbGwgPSAt
MTsKLQlmb3JfZWFjaF9lbmdpbmUoZmQsIGVuZ2luZSkgeworCWZvcl9lYWNoX2VuZ2luZShlLCBm
ZCkgewogCQlpbnQgZmVuY2UsIG5ldzsKIAotCQlleGVjYnVmLmZsYWdzID0gZW5naW5lIHwgTE9D
QUxfRVhFQ19GRU5DRV9PVVQ7CisJCWV4ZWNidWYuZmxhZ3MgPSBlYl9yaW5nKGUpIHwgTE9DQUxf
RVhFQ19GRU5DRV9PVVQ7CiAJCWV4ZWNidWYucnN2ZDIgPSAtMTsKIAkJZ2VtX2V4ZWNidWZfd3Io
ZmQsICZleGVjYnVmKTsKIAkJZmVuY2UgPSBleGVjYnVmLnJzdmQyID4+IDMyOwpAQCAtMzE5LDcg
KzMxOCw2IEBAIHN0YXRpYyB2b2lkIHRlc3RfZmVuY2VfYXdhaXQoaW50IGZkLCB1bnNpZ25lZCBy
aW5nLCB1bnNpZ25lZCBmbGFncykKIHsKIAl1aW50MzJfdCBzY3JhdGNoID0gZ2VtX2NyZWF0ZShm
ZCwgNDA5Nik7CiAJaWd0X3NwaW5fdCAqc3BpbjsKLQl1bnNpZ25lZCBlbmdpbmU7CiAJdWludDMy
X3QgKm91dDsKIAlpbnQgaTsKIApAQCAtMzM2LDE1ICszMzQsMTUgQEAgc3RhdGljIHZvaWQgdGVz
dF9mZW5jZV9hd2FpdChpbnQgZmQsIHVuc2lnbmVkIHJpbmcsIHVuc2lnbmVkIGZsYWdzKQogCWln
dF9hc3NlcnQoc3Bpbi0+b3V0X2ZlbmNlICE9IC0xKTsKIAogCWkgPSAwOwotCWZvcl9lYWNoX3Bo
eXNpY2FsX2VuZ2luZShmZCwgZW5naW5lKSB7Ci0JCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChm
ZCwgZW5naW5lKSkKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJaWYgKCFn
ZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5nKGUpKSkKIAkJCWNvbnRpbnVlOwogCiAJCWlm
IChmbGFncyAmIE5PTkJMT0NLKSB7Ci0JCQlzdG9yZShmZCwgZW5naW5lLCBzcGluLT5vdXRfZmVu
Y2UsIHNjcmF0Y2gsIGkpOworCQkJc3RvcmUoZmQsIGViX3JpbmcoZSksIHNwaW4tPm91dF9mZW5j
ZSwgc2NyYXRjaCwgaSk7CiAJCX0gZWxzZSB7CiAJCQlpZ3RfZm9yayhjaGlsZCwgMSkKLQkJCQlz
dG9yZShmZCwgZW5naW5lLCBzcGluLT5vdXRfZmVuY2UsIHNjcmF0Y2gsIGkpOworCQkJCXN0b3Jl
KGZkLCBlYl9yaW5nKGUpLCBzcGluLT5vdXRfZmVuY2UsIHNjcmF0Y2gsIGkpOwogCQl9CiAKIAkJ
aSsrOwpAQCAtNDEyLDcgKzQxMCw2IEBAIHN0YXRpYyB2b2lkIHRlc3RfcGFyYWxsZWwoaW50IGZk
LCB1bnNpZ25lZCBpbnQgbWFzdGVyKQogCXVpbnQzMl90IGhhbmRsZVsxNl07CiAJdWludDMyX3Qg
YmF0Y2hbMTZdOwogCWlndF9zcGluX3QgKnNwaW47Ci0JdW5zaWduZWQgZW5naW5lOwogCUlHVF9D
T1JLX0hBTkRMRShjKTsKIAl1aW50MzJfdCBwbHVnOwogCWludCBpLCB4ID0gMDsKQEAgLTQ5OCwx
MSArNDk1LDExIEBAIHN0YXRpYyB2b2lkIHRlc3RfcGFyYWxsZWwoaW50IGZkLCB1bnNpZ25lZCBp
bnQgbWFzdGVyKQogCW9ialtCQVRDSF0ucmVsb2NhdGlvbl9jb3VudCA9IDE7CiAKIAkvKiBRdWV1
ZSBhbGwgc2Vjb25kYXJpZXMgKi8KLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIGVuZ2lu
ZSkgewotCQlpZiAoZW5naW5lID09IG1hc3RlcikKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUo
ZSwgZmQpIHsKKwkJaWYgKGViX3JpbmcoZSkgPT0gbWFzdGVyKQogCQkJY29udGludWU7CiAKLQkJ
ZXhlY2J1Zi5mbGFncyA9IGVuZ2luZSB8IExPQ0FMX0VYRUNfRkVOQ0VfU1VCTUlUOworCQlleGVj
YnVmLmZsYWdzID0gZWJfcmluZyhlKSB8IExPQ0FMX0VYRUNfRkVOQ0VfU1VCTUlUOwogCQlpZiAo
Z2VuIDwgNikKIAkJCWV4ZWNidWYuZmxhZ3MgfD0gSTkxNV9FWEVDX1NFQ1VSRTsKIApAQCAtNjYz
LDggKzY2MCw3IEBAIHN0YXRpYyB2b2lkIHRlc3RfbG9uZ19oaXN0b3J5KGludCBmZCwgbG9uZyBy
aW5nX3NpemUsIHVuc2lnbmVkIGZsYWdzKQogCWNvbnN0IHVpbnQzMl90IGJiZSA9IE1JX0JBVENI
X0JVRkZFUl9FTkQ7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIgb2JqWzJdOwog
CXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgZXhlY2J1ZjsKLQl1bnNpZ25lZCBpbnQg
ZW5naW5lc1sxNl0sIGVuZ2luZTsKLQl1bnNpZ25lZCBpbnQgbmVuZ2luZSwgbiwgczsKKwl1bnNp
Z25lZCBpbnQgZW5naW5lc1sxNl0sIG5lbmdpbmUsIG4sIHM7CiAJdW5zaWduZWQgbG9uZyBsaW1p
dDsKIAlpbnQgYWxsX2ZlbmNlczsKIAlJR1RfQ09SS19IQU5ETEUoYyk7CkBAIC02NzQsOCArNjcw
LDggQEAgc3RhdGljIHZvaWQgdGVzdF9sb25nX2hpc3RvcnkoaW50IGZkLCBsb25nIHJpbmdfc2l6
ZSwgdW5zaWduZWQgZmxhZ3MpCiAJCWxpbWl0ID0gcmluZ19zaXplIC8gMzsKIAogCW5lbmdpbmUg
PSAwOwotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgZW5naW5lKQotCQllbmdpbmVzW25l
bmdpbmUrK10gPSBlbmdpbmU7CisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKQorCQll
bmdpbmVzW25lbmdpbmUrK10gPSBlYl9yaW5nKGUpOwogCWlndF9yZXF1aXJlKG5lbmdpbmUpOwog
CiAJZ2VtX3F1aWVzY2VudF9ncHUoZmQpOwpAQCAtMTE1Niw3ICsxMTUyLDYgQEAgc3RhdGljIHZv
aWQgdGVzdF9zeW5jb2JqX3dhaXQoaW50IGZkKQogCQkuaGFuZGxlID0gc3luY29ial9jcmVhdGUo
ZmQpLAogCX07CiAJaWd0X3NwaW5fdCAqc3BpbjsKLQl1bnNpZ25lZCBlbmdpbmU7CiAJdW5zaWdu
ZWQgaGFuZGxlWzE2XTsKIAlpbnQgbjsKIApAQCAtMTE4OSwxMyArMTE4NCwxMyBAQCBzdGF0aWMg
dm9pZCB0ZXN0X3N5bmNvYmpfd2FpdChpbnQgZmQpCiAJZ2VtX3dyaXRlKGZkLCBvYmouaGFuZGxl
LCAwLCAmYmJlLCBzaXplb2YoYmJlKSk7CiAKIAluID0gMDsKLQlmb3JfZWFjaF9lbmdpbmUoZmQs
IGVuZ2luZSkgeworCWZvcl9lYWNoX2VuZ2luZShlLCBmZCkgewogCQlvYmouaGFuZGxlID0gZ2Vt
X2NyZWF0ZShmZCwgNDA5Nik7CiAJCWdlbV93cml0ZShmZCwgb2JqLmhhbmRsZSwgMCwgJmJiZSwg
c2l6ZW9mKGJiZSkpOwogCiAJCS8qIE5vIGludGVyLWVuZ2luZSBzeW5jaHJvbmlzYXRpb24sIHdp
bGwgY29tcGxldGUgKi8KLQkJaWYgKGVuZ2luZSA9PSBJOTE1X0VYRUNfQkxUKSB7Ci0JCQlleGVj
YnVmLmZsYWdzID0gZW5naW5lOworCQlpZiAoZWJfcmluZyhlKSA9PSBJOTE1X0VYRUNfQkxUKSB7
CisJCQlleGVjYnVmLmZsYWdzID0gZWJfcmluZyhlKTsKIAkJCWV4ZWNidWYuY2xpcHJlY3RzX3B0
ciA9IDA7CiAJCQlleGVjYnVmLm51bV9jbGlwcmVjdHMgPSAwOwogCQkJZ2VtX2V4ZWNidWYoZmQs
ICZleGVjYnVmKTsKQEAgLTEyMDUsNyArMTIwMCw3IEBAIHN0YXRpYyB2b2lkIHRlc3Rfc3luY29i
al93YWl0KGludCBmZCkKIAkJaWd0X2Fzc2VydChnZW1fYm9fYnVzeShmZCwgc3Bpbi0+aGFuZGxl
KSk7CiAKIAkJLyogTm93IHdhaXQgdXBvbiB0aGUgYmxvY2tlZCBlbmdpbmUgKi8KLQkJZXhlY2J1
Zi5mbGFncyA9IExPQ0FMX0VYRUNfRkVOQ0VfQVJSQVkgfCBlbmdpbmU7CisJCWV4ZWNidWYuZmxh
Z3MgPSBMT0NBTF9FWEVDX0ZFTkNFX0FSUkFZIHwgZWJfcmluZyhlKTsKIAkJZXhlY2J1Zi5jbGlw
cmVjdHNfcHRyID0gdG9fdXNlcl9wb2ludGVyKCZmZW5jZSk7CiAJCWV4ZWNidWYubnVtX2NsaXBy
ZWN0cyA9IDE7CiAJCWZlbmNlLmZsYWdzID0gTE9DQUxfRVhFQ19GRU5DRV9XQUlUOwpAQCAtMTU0
OSw4ICsxNTQ0LDggQEAgaWd0X21haW4KIAlmb3IgKGUgPSBpbnRlbF9leGVjdXRpb25fZW5naW5l
czsgZS0+bmFtZTsgZSsrKSB7CiAJCWlndF9zdWJ0ZXN0X2dyb3VwIHsKIAkJCWlndF9maXh0dXJl
IHsKLQkJCQlpZ3RfcmVxdWlyZShnZW1faGFzX3JpbmcoaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZs
YWdzKSk7Ci0JCQkJaWd0X3JlcXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChpOTE1LCBlLT5leGVj
X2lkIHwgZS0+ZmxhZ3MpKTsKKwkJCQlpZ3RfcmVxdWlyZShnZW1faGFzX3JpbmcoaTkxNSwgZWJf
cmluZyhlKSkpOworCQkJCWlndF9yZXF1aXJlKGdlbV9jYW5fc3RvcmVfZHdvcmQoaTkxNSwgZWJf
cmluZyhlKSkpOwogCQkJfQogCiAJCQlpZ3Rfc3VidGVzdF9ncm91cCB7CkBAIC0xNTYxLDI3ICsx
NTU2LDI3IEBAIGlndF9tYWluCiAJCQkJaWd0X3N1YnRlc3RfZigiJXNidXN5LSVzIiwKIAkJCQkJ
CWUtPmV4ZWNfaWQgPT0gMCA/ICJiYXNpYy0iIDogIiIsCiAJCQkJCQllLT5uYW1lKQotCQkJCQl0
ZXN0X2ZlbmNlX2J1c3koaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCAwKTsKKwkJCQkJdGVz
dF9mZW5jZV9idXN5KGk5MTUsIGViX3JpbmcoZSksIDApOwogCQkJCWlndF9zdWJ0ZXN0X2YoIiVz
d2FpdC0lcyIsCiAJCQkJCQllLT5leGVjX2lkID09IDAgPyAiYmFzaWMtIiA6ICIiLAogCQkJCQkJ
ZS0+bmFtZSkKLQkJCQkJdGVzdF9mZW5jZV9idXN5KGk5MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFn
cywgV0FJVCk7CisJCQkJCXRlc3RfZmVuY2VfYnVzeShpOTE1LCBlYl9yaW5nKGUpLCBXQUlUKTsK
IAkJCQlpZ3Rfc3VidGVzdF9mKCIlc2F3YWl0LSVzIiwKIAkJCQkJCWUtPmV4ZWNfaWQgPT0gMCA/
ICJiYXNpYy0iIDogIiIsCiAJCQkJCQllLT5uYW1lKQotCQkJCQl0ZXN0X2ZlbmNlX2F3YWl0KGk5
MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgMCk7CisJCQkJCXRlc3RfZmVuY2VfYXdhaXQoaTkx
NSwgZWJfcmluZyhlKSwgMCk7CiAJCQkJaWd0X3N1YnRlc3RfZigibmItYXdhaXQtJXMiLCBlLT5u
YW1lKQotCQkJCQl0ZXN0X2ZlbmNlX2F3YWl0KGk5MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywg
Tk9OQkxPQ0spOworCQkJCQl0ZXN0X2ZlbmNlX2F3YWl0KGk5MTUsIGViX3JpbmcoZSksIE5PTkJM
T0NLKTsKIAogCQkJCWlndF9zdWJ0ZXN0X2YoImtlZXAtaW4tZmVuY2UtJXMiLCBlLT5uYW1lKQot
CQkJCQl0ZXN0X2tlZXBfaW5fZmVuY2UoaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCAwKTsK
KwkJCQkJdGVzdF9rZWVwX2luX2ZlbmNlKGk5MTUsIGViX3JpbmcoZSksIDApOwogCiAJCQkJaWYg
KGUtPmV4ZWNfaWQgJiYKIAkJCQkgICAgIShlLT5leGVjX2lkID09IEk5MTVfRVhFQ19CU0QgJiYg
IWUtPmZsYWdzKSkgewogCQkJCQlpZ3Rfc3VidGVzdF9mKCJwYXJhbGxlbC0lcyIsIGUtPm5hbWUp
IHsKIAkJCQkJCWlndF9yZXF1aXJlKGhhc19zdWJtaXRfZmVuY2UoaTkxNSkpOwogCQkJCQkJaWd0
X3VudGlsX3RpbWVvdXQoMikKLQkJCQkJCQl0ZXN0X3BhcmFsbGVsKGk5MTUsIGUtPmV4ZWNfaWQg
fCBlLT5mbGFncyk7CisJCQkJCQkJdGVzdF9wYXJhbGxlbChpOTE1LCBlYl9yaW5nKGUpKTsKIAkJ
CQkJfQogCQkJCX0KIApAQCAtMTYwMCwxMyArMTU5NSwxMyBAQCBpZ3RfbWFpbgogCQkJCX0KIAog
CQkJCWlndF9zdWJ0ZXN0X2YoImJ1c3ktaGFuZy0lcyIsIGUtPm5hbWUpCi0JCQkJCXRlc3RfZmVu
Y2VfYnVzeShpOTE1LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIEhBTkcpOworCQkJCQl0ZXN0X2Zl
bmNlX2J1c3koaTkxNSwgZWJfcmluZyhlKSwgSEFORyk7CiAJCQkJaWd0X3N1YnRlc3RfZigid2Fp
dC1oYW5nLSVzIiwgZS0+bmFtZSkKLQkJCQkJdGVzdF9mZW5jZV9idXN5KGk5MTUsIGUtPmV4ZWNf
aWQgfCBlLT5mbGFncywgSEFORyB8IFdBSVQpOworCQkJCQl0ZXN0X2ZlbmNlX2J1c3koaTkxNSwg
ZWJfcmluZyhlKSwgSEFORyB8IFdBSVQpOwogCQkJCWlndF9zdWJ0ZXN0X2YoImF3YWl0LWhhbmct
JXMiLCBlLT5uYW1lKQotCQkJCQl0ZXN0X2ZlbmNlX2F3YWl0KGk5MTUsIGUtPmV4ZWNfaWQgfCBl
LT5mbGFncywgSEFORyk7CisJCQkJCXRlc3RfZmVuY2VfYXdhaXQoaTkxNSwgZWJfcmluZyhlKSwg
SEFORyk7CiAJCQkJaWd0X3N1YnRlc3RfZigibmItYXdhaXQtaGFuZy0lcyIsIGUtPm5hbWUpCi0J
CQkJCXRlc3RfZmVuY2VfYXdhaXQoaTkxNSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBOT05CTE9D
SyB8IEhBTkcpOworCQkJCQl0ZXN0X2ZlbmNlX2F3YWl0KGk5MTUsIGViX3JpbmcoZSksIE5PTkJM
T0NLIHwgSEFORyk7CiAJCQkJaWd0X2ZpeHR1cmUgewogCQkJCQlpZ3RfZGlzYWxsb3dfaGFuZyhp
OTE1LCBoYW5nKTsKIAkJCQl9CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9leGVjX2ZsdXNo
LmMgYi90ZXN0cy9pOTE1L2dlbV9leGVjX2ZsdXNoLmMKaW5kZXggZjgyMGIyYThkLi4yODcwODQ2
MGIgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfZmx1c2guYworKysgYi90ZXN0cy9p
OTE1L2dlbV9leGVjX2ZsdXNoLmMKQEAgLTYwMCw3ICs2MDAsNyBAQCBpZ3RfbWFpbgogCX0KIAog
CWZvciAoZSA9IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVzOyBlLT5uYW1lOyBlKyspIGlndF9zdWJ0
ZXN0X2dyb3VwIHsKLQkJdW5zaWduZWQgcmluZyA9IGUtPmV4ZWNfaWQgfCBlLT5mbGFnczsKKwkJ
dW5zaWduZWQgcmluZyA9IGViX3JpbmcoZSk7CiAJCXVuc2lnbmVkIHRpbWVvdXQgPSA1ICsgMTIw
KiEhZS0+ZXhlY19pZDsKIAogCQlpZ3RfZml4dHVyZSB7CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1
L2dlbV9leGVjX2d0dGZpbGwuYyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfZ3R0ZmlsbC5jCmluZGV4
IGVmZDYxMmJiNi4uZmE5MTYxYjRlIDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9leGVjX2d0
dGZpbGwuYworKysgYi90ZXN0cy9pOTE1L2dlbV9leGVjX2d0dGZpbGwuYwpAQCAtMTEzLDIwICsx
MTMsMTkgQEAgc3RhdGljIHZvaWQgZmlsbGd0dChpbnQgZmQsIHVuc2lnbmVkIHJpbmcsIGludCB0
aW1lb3V0KQogCXN0cnVjdCBiYXRjaCAqYmF0Y2hlczsKIAl1bnNpZ25lZCBlbmdpbmVzWzE2XTsK
IAl1bnNpZ25lZCBuZW5naW5lOwotCXVuc2lnbmVkIGVuZ2luZTsKLQl1aW50NjRfdCBzaXplOwog
CXVuc2lnbmVkIGNvdW50OworCXVpbnQ2NF90IHNpemU7CiAKIAlzaGFyZWQgPSBtbWFwKE5VTEws
IDQwOTYsIFBST1RfV1JJVEUsIE1BUF9TSEFSRUQgfCBNQVBfQU5PTiwgLTEsIDApOwogCWlndF9h
c3NlcnQoc2hhcmVkICE9IE1BUF9GQUlMRUQpOwogCiAJbmVuZ2luZSA9IDA7CiAJaWYgKHJpbmcg
PT0gMCkgewotCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIGVuZ2luZSkgewotCQkJaWYg
KCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlbmdpbmUpKQorCQlmb3JfZWFjaF9waHlzaWNhbF9l
bmdpbmUoZSwgZmQpIHsKKwkJCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmluZyhl
KSkpCiAJCQkJY29udGludWU7CiAKLQkJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGVuZ2luZTsKKwkJ
CWVuZ2luZXNbbmVuZ2luZSsrXSA9IGViX3JpbmcoZSk7CiAJCX0KIAl9IGVsc2UgewogCQlnZW1f
cmVxdWlyZV9yaW5nKGZkLCByaW5nKTsKQEAgLTIyNCw3ICsyMjMsNyBAQCBpZ3RfbWFpbgogCiAJ
Zm9yIChlID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7IGUtPm5hbWU7IGUrKykKIAkJaWd0X3N1
YnRlc3RfZigiJXMiLCBlLT5uYW1lKQotCQkJZmlsbGd0dChkZXZpY2UsIGUtPmV4ZWNfaWQgfCBl
LT5mbGFncywgMjApOworCQkJZmlsbGd0dChkZXZpY2UsIGViX3JpbmcoZSksIDIwKTsKIAogCWln
dF9zdWJ0ZXN0KCJhbGwiKQogCQlmaWxsZ3R0KGRldmljZSwgMCwgMTUwKTsKZGlmZiAtLWdpdCBh
L3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfbGF0ZW5jeS5jIGIvdGVzdHMvaTkxNS9nZW1fZXhlY19sYXRl
bmN5LmMKaW5kZXggOWRkYjM0OGMwLi4zZDk5MTgyYTAgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUv
Z2VtX2V4ZWNfbGF0ZW5jeS5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfbGF0ZW5jeS5jCkBA
IC0yNjcsNyArMjY3LDYgQEAgc3RhdGljIHZvaWQgbGF0ZW5jeV9mcm9tX3JpbmcoaW50IGZkLAog
CXN0cnVjdCBkcm1faTkxNV9nZW1fcmVsb2NhdGlvbl9lbnRyeSByZWxvYzsKIAlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX2V4ZWNidWZmZXIyIGV4ZWNidWY7CiAJY29uc3QgdW5zaWduZWQgaW50IHJlcGVh
dHMgPSByaW5nX3NpemUgLyAyOwotCXVuc2lnbmVkIGludCBvdGhlcjsKIAl1aW50MzJfdCAqbWFw
LCAqcmVzdWx0czsKIAl1aW50MzJfdCBjdHhbMl0gPSB7fTsKIAlpbnQgaSwgajsKQEAgLTMxMyw3
ICszMTIsNyBAQCBzdGF0aWMgdm9pZCBsYXRlbmN5X2Zyb21fcmluZyhpbnQgZmQsCiAJcmVsb2Mu
cHJlc3VtZWRfb2Zmc2V0ID0gb2JqWzFdLm9mZnNldDsKIAlyZWxvYy50YXJnZXRfaGFuZGxlID0g
ZmxhZ3MgJiBDT1JLID8gMSA6IDA7CiAKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIG90
aGVyKSB7CisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7CiAJCWlndF9zcGluX3Qg
KnNwaW4gPSBOVUxMOwogCQlJR1RfQ09SS19IQU5ETEUoYyk7CiAKQEAgLTM2MSw3ICszNjAsNyBA
QCBzdGF0aWMgdm9pZCBsYXRlbmN5X2Zyb21fcmluZyhpbnQgZmQsCiAJCQlnZW1fZXhlY2J1Zihm
ZCwgJmV4ZWNidWYpOwogCiAJCQlleGVjYnVmLmZsYWdzICY9IH5FTkdJTkVfRkxBR1M7Ci0JCQll
eGVjYnVmLmZsYWdzIHw9IG90aGVyOworCQkJZXhlY2J1Zi5mbGFncyB8PSBlYl9yaW5nKGUpOwog
CiAJCQlleGVjYnVmLmJhdGNoX3N0YXJ0X29mZnNldCA9IDY0ICogKGogKyByZXBlYXRzKTsKIAkJ
CXJlbG9jLm9mZnNldCA9CkBAIC0zOTQsNyArMzkzLDcgQEAgc3RhdGljIHZvaWQgbGF0ZW5jeV9m
cm9tX3JpbmcoaW50IGZkLAogCQlpZ3Rfc3Bpbl9mcmVlKGZkLCBzcGluKTsKIAogCQlpZ3RfaW5m
bygiJXMtJXMgZGVsYXk6ICUuMmZuc1xuIiwKLQkJCSBuYW1lLCBlX18tPm5hbWUsCisJCQkgbmFt
ZSwgZS0+bmFtZSwKIAkJCSAocmVzdWx0c1syKnJlcGVhdHMtMV0gLSByZXN1bHRzWzBdKSAvIChk
b3VibGUpcmVwZWF0cyAqIHJjc19jbG9jayk7CiAJfQogCkBAIC00NzUsMTIgKzQ3NCwxMiBAQCBy
dGhvZ19sYXRlbmN5X29uX3JpbmcoaW50IGZkLCB1bnNpZ25lZCBpbnQgZW5naW5lLCBjb25zdCBj
aGFyICpuYW1lLCB1bnNpZ25lZCBpbgogCiAJbmVuZ2luZSA9IDA7CiAJaWYgKGVuZ2luZSA9PSBB
TExfRU5HSU5FUykgewotCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIGVuZ2luZSkgewot
CQkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlbmdpbmUpKQorCQlmb3JfZWFjaF9waHlz
aWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJf
cmluZyhlKSkpCiAJCQkJY29udGludWU7CiAKLQkJCWVuZ2luZXNbbmVuZ2luZV0gPSBlbmdpbmU7
Ci0JCQluYW1lc1tuZW5naW5lXSA9IGVfXy0+bmFtZTsKKwkJCWVuZ2luZXNbbmVuZ2luZV0gPSBl
Yl9yaW5nKGUpOworCQkJbmFtZXNbbmVuZ2luZV0gPSBlLT5uYW1lOwogCQkJbmVuZ2luZSsrOwog
CQl9CiAJCWlndF9yZXF1aXJlKG5lbmdpbmUgPiAxKTsKQEAgLTY5MiwyMiArNjkxLDIyIEBAIGln
dF9tYWluCiAKIAkJCWlndF9zdWJ0ZXN0X2dyb3VwIHsKIAkJCQlpZ3RfZml4dHVyZSB7Ci0JCQkJ
CWlndF9yZXF1aXJlKGdlbV9yaW5nX2hhc19waHlzaWNhbF9lbmdpbmUoZGV2aWNlLCBlLT5leGVj
X2lkIHwgZS0+ZmxhZ3MpKTsKKwkJCQkJaWd0X3JlcXVpcmUoZ2VtX3JpbmdfaGFzX3BoeXNpY2Fs
X2VuZ2luZShkZXZpY2UsIGViX3JpbmcoZSkpKTsKIAkJCQl9CiAKIAkJCQlpZ3Rfc3VidGVzdF9m
KCIlcy1kaXNwYXRjaCIsIGUtPm5hbWUpCiAJCQkJCWxhdGVuY3lfb25fcmluZyhkZXZpY2UsCi0J
CQkJCQkJZS0+ZXhlY19pZCB8IGUtPmZsYWdzLAorCQkJCQkJCWViX3JpbmcoZSksCiAJCQkJCQkJ
ZS0+bmFtZSwgMCk7CiAKIAkJCQlpZ3Rfc3VidGVzdF9mKCIlcy1saXZlLWRpc3BhdGNoIiwgZS0+
bmFtZSkKIAkJCQkJbGF0ZW5jeV9vbl9yaW5nKGRldmljZSwKLQkJCQkJCQllLT5leGVjX2lkIHwg
ZS0+ZmxhZ3MsCisJCQkJCQkJZWJfcmluZyhlKSwKIAkJCQkJCQllLT5uYW1lLCBMSVZFKTsKIAog
CQkJCWlndF9zdWJ0ZXN0X2YoIiVzLXBvbGwiLCBlLT5uYW1lKQogCQkJCQlwb2xsX3JpbmcoZGV2
aWNlLAotCQkJCQkJICBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsCisJCQkJCQkgIGViX3JpbmcoZSks
CiAJCQkJCQkgIGUtPm5hbWUpOwogCiAJCQkJaWd0X3N1YnRlc3RfZigiJXMtcnRpZGxlLXN1Ym1p
dCIsIGUtPm5hbWUpCkBAIC03MjYsMjEgKzcyNSwyMSBAQCBpZ3RfbWFpbgogCiAJCQkJaWd0X3N1
YnRlc3RfZigiJXMtbGl2ZS1kaXNwYXRjaC1xdWV1ZWQiLCBlLT5uYW1lKQogCQkJCQlsYXRlbmN5
X29uX3JpbmcoZGV2aWNlLAotCQkJCQkJCWUtPmV4ZWNfaWQgfCBlLT5mbGFncywKKwkJCQkJCQll
Yl9yaW5nKGUpLAogCQkJCQkJCWUtPm5hbWUsIExJVkUgfCBDT1JLKTsKIAkJCQlpZ3Rfc3VidGVz
dF9mKCIlcy1kaXNwYXRjaC1xdWV1ZWQiLCBlLT5uYW1lKQogCQkJCQlsYXRlbmN5X29uX3Jpbmco
ZGV2aWNlLAotCQkJCQkJCWUtPmV4ZWNfaWQgfCBlLT5mbGFncywKKwkJCQkJCQllYl9yaW5nKGUp
LAogCQkJCQkJCWUtPm5hbWUsIENPUkspOwogCiAJCQkJaWd0X3N1YnRlc3RfZigiJXMtc3luY2hy
b25pc2F0aW9uIiwgZS0+bmFtZSkKIAkJCQkJbGF0ZW5jeV9mcm9tX3JpbmcoZGV2aWNlLAotCQkJ
CQkJCSAgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLAorCQkJCQkJCSAgZWJfcmluZyhlKSwKIAkJCQkJ
CQkgIGUtPm5hbWUsIDApOwogCiAJCQkJaWd0X3N1YnRlc3RfZigiJXMtc3luY2hyb25pc2F0aW9u
LXF1ZXVlZCIsIGUtPm5hbWUpCiAJCQkJCWxhdGVuY3lfZnJvbV9yaW5nKGRldmljZSwKLQkJCQkJ
CQkgIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywKKwkJCQkJCQkgIGViX3JpbmcoZSksCiAJCQkJCQkJ
ICBlLT5uYW1lLCBDT1JLKTsKIAogCQkJCWlndF9zdWJ0ZXN0X2dyb3VwIHsKQEAgLTc1MSw3ICs3
NTAsNyBAQCBpZ3RfbWFpbgogCiAJCQkJCWlndF9zdWJ0ZXN0X2YoIiVzLXByZWVtcHRpb24iLCBl
LT5uYW1lKQogCQkJCQkJbGF0ZW5jeV9mcm9tX3JpbmcoZGV2aWNlLAotCQkJCQkJCQkgIGUtPmV4
ZWNfaWQgfCBlLT5mbGFncywKKwkJCQkJCQkJICBlYl9yaW5nKGUpLAogCQkJCQkJCQkgIGUtPm5h
bWUsIFBSRUVNUFQpOwogCQkJCX0KIAkJCX0KZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX2V4
ZWNfbm9wLmMgYi90ZXN0cy9pOTE1L2dlbV9leGVjX25vcC5jCmluZGV4IDg5MjI2ODVhZi4uMWE2
OTA2ZjMwIDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9leGVjX25vcC5jCisrKyBiL3Rlc3Rz
L2k5MTUvZ2VtX2V4ZWNfbm9wLmMKQEAgLTIyMiw3ICsyMjIsNyBAQCBzdGF0aWMgdm9pZCBwb2xs
X3NlcXVlbnRpYWwoaW50IGZkLCBjb25zdCBjaGFyICpuYW1lLCBpbnQgdGltZW91dCkKIAlzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiBvYmpbMl07CiAJc3RydWN0IGRybV9pOTE1X2dl
bV9yZWxvY2F0aW9uX2VudHJ5IHJlbG9jWzRdLCAqcjsKIAl1aW50MzJfdCAqYmJlWzJdLCAqc3Rh
dGUsICpiYXRjaDsKLQl1bnNpZ25lZCBlbmdpbmVzWzE2XSwgbmVuZ2luZSwgZW5naW5lLCBmbGFn
czsKKwl1bnNpZ25lZCBlbmdpbmVzWzE2XSwgbmVuZ2luZSwgZmxhZ3M7CiAJc3RydWN0IHRpbWVz
cGVjIHR2ID0ge307CiAJdW5zaWduZWQgbG9uZyBjeWNsZXM7CiAJdWludDY0X3QgZWxhcHNlZDsK
QEAgLTIzMywxMSArMjMzLDExIEBAIHN0YXRpYyB2b2lkIHBvbGxfc2VxdWVudGlhbChpbnQgZmQs
IGNvbnN0IGNoYXIgKm5hbWUsIGludCB0aW1lb3V0KQogCQlmbGFncyB8PSBJOTE1X0VYRUNfU0VD
VVJFOwogCiAJbmVuZ2luZSA9IDA7Ci0JZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZkLCBlbmdp
bmUpIHsKLQkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlbmdpbmUpKQorCWZvcl9lYWNo
X3BoeXNpY2FsX2VuZ2luZShlLCBmZCkgeworCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQs
IGViX3JpbmcoZSkpKQogCQkJY29udGludWU7CiAKLQkJZW5naW5lc1tuZW5naW5lKytdID0gZW5n
aW5lOworCQllbmdpbmVzW25lbmdpbmUrK10gPSBlYl9yaW5nKGUpOwogCX0KIAlpZ3RfcmVxdWly
ZShuZW5naW5lKTsKIApAQCAtNDM4LDE0ICs0MzgsMTQgQEAgc3RhdGljIHZvaWQgcGFyYWxsZWwo
aW50IGZkLCB1aW50MzJfdCBoYW5kbGUsIGludCB0aW1lb3V0KQogCiAJc3VtID0gMDsKIAluZW5n
aW5lID0gMDsKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIGVuZ2luZSkgewotCQllbmdp
bmVzW25lbmdpbmVdID0gZW5naW5lOwotCQluYW1lc1tuZW5naW5lXSA9IGVfXy0+bmFtZTsKKwlm
b3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJZW5naW5lc1tuZW5naW5lXSA9IGVi
X3JpbmcoZSk7CisJCW5hbWVzW25lbmdpbmVdID0gZS0+bmFtZTsKIAkJbmVuZ2luZSsrOwogCiAJ
CXRpbWUgPSBub3Bfb25fcmluZyhmZCwgaGFuZGxlLCBlbmdpbmUsIDEsICZjb3VudCkgLyBjb3Vu
dDsKIAkJc3VtICs9IHRpbWU7Ci0JCWlndF9kZWJ1ZygiJXM6ICUuM2Z1c1xuIiwgZV9fLT5uYW1l
LCAxZTYqdGltZSk7CisJCWlndF9kZWJ1ZygiJXM6ICUuM2Z1c1xuIiwgZS0+bmFtZSwgMWU2KnRp
bWUpOwogCX0KIAlpZ3RfcmVxdWlyZShuZW5naW5lKTsKIAlpZ3RfaW5mbygiYXZlcmFnZSAoaW5k
aXZpZHVhbGx5KTogJS4zZnVzXG4iLCBzdW0vbmVuZ2luZSoxZTYpOwpAQCAtNDk0LDIyICs0OTQs
MjEgQEAgc3RhdGljIHZvaWQgc2VyaWVzKGludCBmZCwgdWludDMyX3QgaGFuZGxlLCBpbnQgdGlt
ZW91dCkKIAlzdHJ1Y3QgdGltZXNwZWMgc3RhcnQsIG5vdywgc3luYzsKIAl1bnNpZ25lZCBlbmdp
bmVzWzE2XTsKIAl1bnNpZ25lZCBuZW5naW5lOwotCXVuc2lnbmVkIGVuZ2luZTsKIAl1bnNpZ25l
ZCBsb25nIGNvdW50OwogCWRvdWJsZSB0aW1lLCBtYXggPSAwLCBtaW4gPSBIVUdFX1ZBTCwgc3Vt
ID0gMDsKIAljb25zdCBjaGFyICpuYW1lOwogCiAJbmVuZ2luZSA9IDA7Ci0JZm9yX2VhY2hfcGh5
c2ljYWxfZW5naW5lKGZkLCBlbmdpbmUpIHsKLQkJdGltZSA9IG5vcF9vbl9yaW5nKGZkLCBoYW5k
bGUsIGVuZ2luZSwgMSwgJmNvdW50KSAvIGNvdW50OworCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2lu
ZShlLCBmZCkgeworCQl0aW1lID0gbm9wX29uX3JpbmcoZmQsIGhhbmRsZSwgZWJfcmluZyhlKSwg
MSwgJmNvdW50KSAvIGNvdW50OwogCQlpZiAodGltZSA+IG1heCkgewotCQkJbmFtZSA9IGVfXy0+
bmFtZTsKKwkJCW5hbWUgPSBlLT5uYW1lOwogCQkJbWF4ID0gdGltZTsKIAkJfQogCQlpZiAodGlt
ZSA8IG1pbikKIAkJCW1pbiA9IHRpbWU7CiAJCXN1bSArPSB0aW1lOwotCQllbmdpbmVzW25lbmdp
bmUrK10gPSBlbmdpbmU7CisJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGViX3JpbmcoZSk7CiAJfQog
CWlndF9yZXF1aXJlKG5lbmdpbmUpOwogCWlndF9pbmZvKCJNYXhpbXVtIGV4ZWN1dGlvbiBsYXRl
bmN5IG9uICVzLCAlLjNmdXMsIG1pbiAlLjNmdXMsIHRvdGFsICUuM2Z1cyBwZXIgY3ljbGUsIGF2
ZXJhZ2UgJS4zZnVzXG4iLApAQCAtNTk1LDE0ICs1OTQsMTQgQEAgc3RhdGljIHZvaWQgc2VxdWVu
dGlhbChpbnQgZmQsIHVpbnQzMl90IGhhbmRsZSwgdW5zaWduZWQgZmxhZ3MsIGludCB0aW1lb3V0
KQogCiAJbmVuZ2luZSA9IDA7CiAJc3VtID0gMDsKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUo
ZmQsIG4pIHsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKIAkJdW5zaWduZWQg
bG9uZyBjb3VudDsKIAogCQl0aW1lID0gbm9wX29uX3JpbmcoZmQsIGhhbmRsZSwgbiwgMSwgJmNv
dW50KSAvIGNvdW50OwogCQlzdW0gKz0gdGltZTsKLQkJaWd0X2RlYnVnKCIlczogJS4zZnVzXG4i
LCBlX18tPm5hbWUsIDFlNip0aW1lKTsKKwkJaWd0X2RlYnVnKCIlczogJS4zZnVzXG4iLCBlLT5u
YW1lLCAxZTYqdGltZSk7CiAKLQkJZW5naW5lc1tuZW5naW5lKytdID0gbjsKKwkJZW5naW5lc1tu
ZW5naW5lKytdID0gZWJfcmluZyhlKTsKIAl9CiAJaWd0X3JlcXVpcmUobmVuZ2luZSk7CiAJaWd0
X2luZm8oIlRvdGFsIChpbmRpdmlkdWFsKSBleGVjdXRpb24gbGF0ZW5jeSAlLjNmdXMgcGVyIGN5
Y2xlXG4iLApAQCAtNzI2LDggKzcyNSw4IEBAIHN0YXRpYyB2b2lkIGZlbmNlX3NpZ25hbChpbnQg
ZmQsIHVpbnQzMl90IGhhbmRsZSwKIAogCW5lbmdpbmUgPSAwOwogCWlmIChyaW5nX2lkID09IEFM
TF9FTkdJTkVTKSB7Ci0JCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgbikKLQkJCWVuZ2lu
ZXNbbmVuZ2luZSsrXSA9IG47CisJCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkKKwkJ
CWVuZ2luZXNbbmVuZ2luZSsrXSA9IGViX3JpbmcoZSk7CiAJfSBlbHNlIHsKIAkJZ2VtX3JlcXVp
cmVfcmluZyhmZCwgcmluZ19pZCk7CiAJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IHJpbmdfaWQ7CkBA
IC04NzUsOSArODc0LDkgQEAgaWd0X21haW4KIAogCWZvciAoZSA9IGludGVsX2V4ZWN1dGlvbl9l
bmdpbmVzOyBlLT5uYW1lOyBlKyspIHsKIAkJaWd0X3N1YnRlc3RfZigiJXMiLCBlLT5uYW1lKQot
CQkJc2luZ2xlKGRldmljZSwgaGFuZGxlLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIGUtPm5hbWUp
OworCQkJc2luZ2xlKGRldmljZSwgaGFuZGxlLCBlYl9yaW5nKGUpLCBlLT5uYW1lKTsKIAkJaWd0
X3N1YnRlc3RfZigic2lnbmFsLSVzIiwgZS0+bmFtZSkKLQkJCWZlbmNlX3NpZ25hbChkZXZpY2Us
IGhhbmRsZSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBlLT5uYW1lLCA1KTsKKwkJCWZlbmNlX3Np
Z25hbChkZXZpY2UsIGhhbmRsZSwgZWJfcmluZyhlKSwgZS0+bmFtZSwgNSk7CiAJfQogCiAJaWd0
X3N1YnRlc3QoInNpZ25hbC1hbGwiKQpAQCAtOTEwLDcgKzkwOSw3IEBAIGlndF9tYWluCiAKIAkJ
Zm9yIChlID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7IGUtPm5hbWU7IGUrKykgewogCQkJaWd0
X3N1YnRlc3RfZigicHJlZW1wdC0lcyIsIGUtPm5hbWUpCi0JCQkJcHJlZW1wdChkZXZpY2UsIGhh
bmRsZSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBlLT5uYW1lKTsKKwkJCQlwcmVlbXB0KGRldmlj
ZSwgaGFuZGxlLCBlYl9yaW5nKGUpLCBlLT5uYW1lKTsKIAkJfQogCX0KIApAQCAtOTIyLDggKzky
MSw3IEBAIGlndF9tYWluCiAJCWZvciAoZSA9IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVzOyBlLT5u
YW1lOyBlKyspIHsKIAkJCS8qIFJlcXVpcmVzIG1hc3RlciBmb3IgU1RPUkVfRFdPUkQgb24gZ2Vu
NC81ICovCiAJCQlpZ3Rfc3VidGVzdF9mKCJwb2xsLSVzIiwgZS0+bmFtZSkKLQkJCQlwb2xsX3Jp
bmcoZGV2aWNlLAotCQkJCQkgIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgZS0+bmFtZSwgMjApOwor
CQkJCXBvbGxfcmluZyhkZXZpY2UsIGViX3JpbmcoZSksIGUtPm5hbWUsIDIwKTsKIAkJfQogCiAJ
CWlndF9zdWJ0ZXN0KCJwb2xsLXNlcXVlbnRpYWwiKQpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9n
ZW1fZXhlY19wYXJhbXMuYyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfcGFyYW1zLmMKaW5kZXggNDlj
NTZhOGQ3Li44ZjE1ZTY0NTQgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfcGFyYW1z
LmMKKysrIGIvdGVzdHMvaTkxNS9nZW1fZXhlY19wYXJhbXMuYwpAQCAtMjM2LDggKzIzNiw4IEBA
IGlndF9tYWluCiAKIAlpZ3Rfc3VidGVzdCgiY29udHJvbCIpIHsKIAkJZm9yIChlID0gaW50ZWxf
ZXhlY3V0aW9uX2VuZ2luZXM7IGUtPm5hbWU7IGUrKykgewotCQkJaWYgKGhhc19yaW5nKGZkLCBl
LT5leGVjX2lkIHwgZS0+ZmxhZ3MpKSB7Ci0JCQkJZXhlY2J1Zi5mbGFncyA9IGUtPmV4ZWNfaWQg
fCBlLT5mbGFnczsKKwkJCWlmIChoYXNfcmluZyhmZCwgZWJfcmluZyhlKSkpIHsKKwkJCQlleGVj
YnVmLmZsYWdzID0gZWJfcmluZyhlKTsKIAkJCQlnZW1fZXhlY2J1ZihmZCwgJmV4ZWNidWYpOwog
CQkJfQogCQl9CkBAIC0zODcsMTQgKzM4NywxNiBAQCBpZ3RfbWFpbgogCiAJaWd0X3N1YnRlc3Qo
InJzLWludmFsaWQiKSB7CiAJCWJvb2wgaGFzX3JzID0gaGFzX3Jlc291cmNlX3N0cmVhbWVyKGZk
KTsKLQkJdW5zaWduZWQgaW50IGVuZ2luZTsKIAotCQlmb3JfZWFjaF9lbmdpbmUoZmQsIGVuZ2lu
ZSkgeworCQlmb3JfZWFjaF9lbmdpbmUoaXQsIGZkKSB7CiAJCQlpbnQgZXhwZWN0ID0gLUVJTlZB
TDsKLQkJCWlmIChoYXNfcnMgJiYgKGVuZ2luZSA9PSAwIHx8IGVuZ2luZSA9PSBJOTE1X0VYRUNf
UkVOREVSKSkKKwkJCWlmIChoYXNfcnMgJiYKKwkJCSAgICAoZWJfcmluZyhpdCkgPT0gMCB8fAor
CQkJICAgICBlYl9yaW5nKGl0KSA9PSBJOTE1X0VYRUNfUkVOREVSKSkKIAkJCQlleHBlY3QgPSAw
OwogCi0JCQlleGVjYnVmLmZsYWdzID0gZW5naW5lIHwgTE9DQUxfSTkxNV9FWEVDX1JFU09VUkNF
X1NUUkVBTUVSOworCQkJZXhlY2J1Zi5mbGFncyA9CisJCQkJZWJfcmluZyhpdCkgfCBMT0NBTF9J
OTE1X0VYRUNfUkVTT1VSQ0VfU1RSRUFNRVI7CiAJCQlpZ3RfYXNzZXJ0X2VxKF9fZ2VtX2V4ZWNi
dWYoZmQsICZleGVjYnVmKSwgZXhwZWN0KTsKIAkJfQogCX0KZGlmZiAtLWdpdCBhL3Rlc3RzL2k5
MTUvZ2VtX2V4ZWNfcmVsb2MuYyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfcmVsb2MuYwppbmRleCBm
ZGQ5NjYxZDEuLjVmNTlmZTk5ZiAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fZXhlY19yZWxv
Yy5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfcmVsb2MuYwpAQCAtMjU4LDkgKzI1OCw5IEBA
IHN0YXRpYyB2b2lkIGFjdGl2ZShpbnQgZmQsIHVuc2lnbmVkIGVuZ2luZSkKIAogCW5lbmdpbmUg
PSAwOwogCWlmIChlbmdpbmUgPT0gQUxMX0VOR0lORVMpIHsKLQkJZm9yX2VhY2hfcGh5c2ljYWxf
ZW5naW5lKGZkLCBlbmdpbmUpIHsKLQkJCWlmIChnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlbmdp
bmUpKQotCQkJCWVuZ2luZXNbbmVuZ2luZSsrXSA9IGVuZ2luZTsKKwkJZm9yX2VhY2hfcGh5c2lj
YWxfZW5naW5lKGUsIGZkKSB7CisJCQlpZiAoZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmlu
ZyhlKSkpCisJCQkJZW5naW5lc1tuZW5naW5lKytdID0gZWJfcmluZyhlKTsKIAkJfQogCX0gZWxz
ZSB7CiAJCWlndF9yZXF1aXJlKGdlbV9oYXNfcmluZyhmZCwgZW5naW5lKSk7CkBAIC03NTQsNyAr
NzU0LDcgQEAgaWd0X21haW4KIAlmb3IgKGNvbnN0IHN0cnVjdCBpbnRlbF9leGVjdXRpb25fZW5n
aW5lICplID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7CiAJICAgICBlLT5uYW1lOyBlKyspIHsK
IAkJaWd0X3N1YnRlc3RfZigiYWN0aXZlLSVzIiwgZS0+bmFtZSkKLQkJCWFjdGl2ZShmZCwgZS0+
ZXhlY19pZCB8IGUtPmZsYWdzKTsKKwkJCWFjdGl2ZShmZCwgZWJfcmluZyhlKSk7CiAJfQogCWln
dF9maXh0dXJlCiAJCWNsb3NlKGZkKTsKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNf
cmV1c2UuYyBiL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfcmV1c2UuYwppbmRleCA5MzViZmE5YWMuLjk3
MWViNDEzNyAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fZXhlY19yZXVzZS5jCisrKyBiL3Rl
c3RzL2k5MTUvZ2VtX2V4ZWNfcmV1c2UuYwpAQCAtODksNyArODksNiBAQCBpZ3RfbWFpbgogCWln
dF9maXh0dXJlIHsKIAkJdWludDY0X3QgZ3R0X3NpemUsIG1heDsKIAkJdWludDMyX3QgYmJlID0g
TUlfQkFUQ0hfQlVGRkVSX0VORDsKLQkJdW5zaWduZWQgZW5naW5lOwogCiAJCWlndF9hbGxvd191
bmxpbWl0ZWRfZmlsZXMoKTsKIApAQCAtMTE4LDkgKzExNyw4IEBAIGlndF9tYWluCiAJCW5vLm9i
aiA9IG1hbGxvYyhzaXplb2Yoc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIpICogKG5v
Lm1heF9hZ2UgKyAxKSk7CiAKIAkJbmVuZ2luZSA9IDA7Ci0JCWZvcl9lYWNoX2VuZ2luZShuby5m
ZCwgZW5naW5lKQotCQkJaWYgKGVuZ2luZSkKLQkJCQllbmdpbmVzW25lbmdpbmUrK10gPSBlbmdp
bmU7CisJCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBuby5mZCkKKwkJCWVuZ2luZXNbbmVu
Z2luZSsrXSA9IGViX3JpbmcoZSk7CiAJCWlndF9yZXF1aXJlKG5lbmdpbmUpOwogCiAJCW5vLmJh
dGNoID0gZ2VtX2NyZWF0ZShuby5mZCwgNDA5Nik7CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dl
bV9leGVjX3NjaGVkdWxlLmMgYi90ZXN0cy9pOTE1L2dlbV9leGVjX3NjaGVkdWxlLmMKaW5kZXgg
ODY5NWNiZTlkLi40N2Y2MTRlZWMgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX2V4ZWNfc2No
ZWR1bGUuYworKysgYi90ZXN0cy9pOTE1L2dlbV9leGVjX3NjaGVkdWxlLmMKQEAgLTI0MCw3ICsy
NDAsNiBAQCBzdGF0aWMgdm9pZCBpbmRlcGVuZGVudChpbnQgZmQsIHVuc2lnbmVkIGludCBlbmdp
bmUpCiAJSUdUX0NPUktfRkVOQ0UoY29yayk7CiAJaWd0X3NwaW5fdCAqc3BpbiA9IE5VTEw7CiAJ
dWludDMyX3Qgc2NyYXRjaCwgYmF0Y2g7Ci0JdW5zaWduZWQgaW50IG90aGVyOwogCXVpbnQzMl90
ICpwdHI7CiAJaW50IGZlbmNlOwogCkBAIC0yNTMsMjUgKzI1MiwyNSBAQCBzdGF0aWMgdm9pZCBp
bmRlcGVuZGVudChpbnQgZmQsIHVuc2lnbmVkIGludCBlbmdpbmUpCiAJZmVuY2UgPSBpZ3RfY29y
a19wbHVnKCZjb3JrLCBmZCk7CiAKIAkvKiBDaGVjayB0aGF0IHdlIGNhbiBzdWJtaXQgdG8gZW5n
aW5lIHdoaWxlIGFsbCBvdGhlcnMgYXJlIGJsb2NrZWQgKi8KLQlmb3JfZWFjaF9waHlzaWNhbF9l
bmdpbmUoZmQsIG90aGVyKSB7Ci0JCWlmIChvdGhlciA9PSBlbmdpbmUpCisJZm9yX2VhY2hfcGh5
c2ljYWxfZW5naW5lKGUsIGZkKSB7CisJCWlmIChlYl9yaW5nKGUpID09IGVuZ2luZSkKIAkJCWNv
bnRpbnVlOwogCi0JCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgb3RoZXIpKQorCQlpZiAo
IWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3JpbmcoZSkpKQogCQkJY29udGludWU7CiAKIAkJ
aWYgKHNwaW4gPT0gTlVMTCkgewotCQkJc3BpbiA9IF9faWd0X3NwaW5fbmV3KGZkLCAuZW5naW5l
ID0gb3RoZXIpOworCQkJc3BpbiA9IF9faWd0X3NwaW5fbmV3KGZkLCAuZW5naW5lID0gZWJfcmlu
ZyhlKSk7CiAJCX0gZWxzZSB7CiAJCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyIGVi
ID0gewogCQkJCS5idWZmZXJfY291bnQgPSAxLAogCQkJCS5idWZmZXJzX3B0ciA9IHRvX3VzZXJf
cG9pbnRlcigmc3Bpbi0+b2JqW0lHVF9TUElOX0JBVENIXSksCi0JCQkJLmZsYWdzID0gb3RoZXIs
CisJCQkJLmZsYWdzID0gZWJfcmluZyhlKSwKIAkJCX07CiAJCQlnZW1fZXhlY2J1ZihmZCwgJmVi
KTsKIAkJfQogCi0JCXN0b3JlX2R3b3JkX2ZlbmNlZChmZCwgMCwgb3RoZXIsIHNjcmF0Y2gsIDAs
IG90aGVyLCBmZW5jZSwgMCk7CisJCXN0b3JlX2R3b3JkX2ZlbmNlZChmZCwgMCwgZWJfcmluZyhl
KSwgc2NyYXRjaCwgMCwgZWJfcmluZyhlKSwgZmVuY2UsIDApOwogCX0KIAlpZ3RfcmVxdWlyZShz
cGluKTsKIApAQCAtMzEyLDkgKzMxMSw5IEBAIHN0YXRpYyB2b2lkIHNtb2tldGVzdChpbnQgZmQs
IHVuc2lnbmVkIHJpbmcsIHVuc2lnbmVkIHRpbWVvdXQpCiAKIAluZW5naW5lID0gMDsKIAlpZiAo
cmluZyA9PSBBTExfRU5HSU5FUykgewotCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIGVu
Z2luZSkKLQkJCWlmIChnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlbmdpbmUpKQotCQkJCWVuZ2lu
ZXNbbmVuZ2luZSsrXSA9IGVuZ2luZTsKKwkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZk
KQorCQkJaWYgKGdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3JpbmcoZSkpKQorCQkJCWVuZ2lu
ZXNbbmVuZ2luZSsrXSA9IGViX3JpbmcoZSk7CiAJfSBlbHNlIHsKIAkJaWYgKGdlbV9jYW5fc3Rv
cmVfZHdvcmQoZmQsIHJpbmcpKQogCQkJZW5naW5lc1tuZW5naW5lKytdID0gcmluZzsKQEAgLTM4
NSw3ICszODQsNiBAQCBzdGF0aWMgdm9pZCBzZW1hcGhvcmVfdXNlcmxvY2soaW50IGk5MTUpCiAJ
CS5oYW5kbGUgPSBiYXRjaF9jcmVhdGUoaTkxNSksCiAJfTsKIAlpZ3Rfc3Bpbl90ICpzcGluID0g
TlVMTDsKLQl1bnNpZ25lZCBpbnQgZW5naW5lOwogCXVpbnQzMl90IHNjcmF0Y2g7CiAKIAlpZ3Rf
cmVxdWlyZShnZW1fc2NoZWR1bGVyX2hhc19zZW1hcGhvcmVzKGk5MTUpKTsKQEAgLTM5OCwxNiAr
Mzk2LDE2IEBAIHN0YXRpYyB2b2lkIHNlbWFwaG9yZV91c2VybG9jayhpbnQgaTkxNSkKIAkgKi8K
IAogCXNjcmF0Y2ggPSBnZW1fY3JlYXRlKGk5MTUsIDQwOTYpOwotCWZvcl9lYWNoX3BoeXNpY2Fs
X2VuZ2luZShpOTE1LCBlbmdpbmUpIHsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgaTkx
NSkgewogCQlpZiAoIXNwaW4pIHsKIAkJCXNwaW4gPSBpZ3Rfc3Bpbl9uZXcoaTkxNSwKIAkJCQkJ
ICAgIC5kZXBlbmRlbmN5ID0gc2NyYXRjaCwKLQkJCQkJICAgIC5lbmdpbmUgPSBlbmdpbmUpOwor
CQkJCQkgICAgLmVuZ2luZSA9IGViX3JpbmcoZSkpOwogCQl9IGVsc2UgewogCQkJdWludDY0X3Qg
c2F2ZWQgPSBzcGluLT5leGVjYnVmLmZsYWdzOwogCiAJCQlzcGluLT5leGVjYnVmLmZsYWdzICY9
IH5FTkdJTkVfTUFTSzsKLQkJCXNwaW4tPmV4ZWNidWYuZmxhZ3MgfD0gZW5naW5lOworCQkJc3Bp
bi0+ZXhlY2J1Zi5mbGFncyB8PSBlYl9yaW5nKGUpOwogCiAJCQlnZW1fZXhlY2J1ZihpOTE1LCAm
c3Bpbi0+ZXhlY2J1Zik7CiAKQEAgLTQyMywxNSArNDIxLDE1IEBAIHN0YXRpYyB2b2lkIHNlbWFw
aG9yZV91c2VybG9jayhpbnQgaTkxNSkKIAkgKiB0YWtpbmcgcHJlY2VkZW5jZS4KIAkgKi8KIAlz
Y3JhdGNoID0gZ2VtX2NvbnRleHRfY3JlYXRlKGk5MTUpOwotCWZvcl9lYWNoX3BoeXNpY2FsX2Vu
Z2luZShpOTE1LCBlbmdpbmUpIHsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgaTkxNSkg
ewogCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyIGV4ZWNidWYgPSB7CiAJCQkuYnVm
ZmVyc19wdHIgPSB0b191c2VyX3BvaW50ZXIoJm9iaiksCiAJCQkuYnVmZmVyX2NvdW50ID0gMSwK
LQkJCS5mbGFncyA9IGVuZ2luZSwKKwkJCS5mbGFncyA9IGViX3JpbmcoZSksCiAJCQkucnN2ZDEg
PSBzY3JhdGNoLAogCQl9OwogCi0JCWlmIChlbmdpbmUgPT0gKHNwaW4tPmV4ZWNidWYuZmxhZ3Mg
JiBFTkdJTkVfTUFTSykpCisJCWlmIChlYl9yaW5nKGUpID09IChzcGluLT5leGVjYnVmLmZsYWdz
ICYgRU5HSU5FX01BU0spKQogCQkJY29udGludWU7CiAKIAkJZ2VtX2V4ZWNidWYoaTkxNSwgJmV4
ZWNidWYpOwpAQCAtNDQ4LDcgKzQ0Niw2IEBAIHN0YXRpYyB2b2lkIHNlbWFwaG9yZV9jb2RlcGVu
ZGVuY3koaW50IGk5MTUpCiAJc3RydWN0IHsKIAkJaWd0X3NwaW5fdCAqeGNzLCAqcmNzOwogCX0g
dGFza1syXTsKLQl1bnNpZ25lZCBpbnQgZW5naW5lOwogCWludCBpOwogCiAJLyoKQEAgLTQ2Miwx
MyArNDU5LDEzIEBAIHN0YXRpYyB2b2lkIHNlbWFwaG9yZV9jb2RlcGVuZGVuY3koaW50IGk5MTUp
CiAJICovCiAKIAlpID0gMDsKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoaTkxNSwgZW5naW5l
KSB7CisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGk5MTUpIHsKIAkJdWludDMyX3QgY3R4
OwogCi0JCWlmIChlbmdpbmUgPT0gSTkxNV9FWEVDX1JFTkRFUikKKwkJaWYgKGViX3JpbmcoZSkg
PT0gSTkxNV9FWEVDX1JFTkRFUikKIAkJCWNvbnRpbnVlOwogCi0JCWlmICghZ2VtX2Nhbl9zdG9y
ZV9kd29yZChpOTE1LCBlbmdpbmUpKQorCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoaTkxNSwg
ZWJfcmluZyhlKSkpCiAJCQljb250aW51ZTsKIAogCQljdHggPSBnZW1fY29udGV4dF9jcmVhdGUo
aTkxNSk7CkBAIC00NzYsNyArNDczLDcgQEAgc3RhdGljIHZvaWQgc2VtYXBob3JlX2NvZGVwZW5k
ZW5jeShpbnQgaTkxNSkKIAkJdGFza1tpXS54Y3MgPQogCQkJX19pZ3Rfc3Bpbl9uZXcoaTkxNSwK
IAkJCQkgICAgICAgLmN0eCA9IGN0eCwKLQkJCQkgICAgICAgLmVuZ2luZSA9IGVuZ2luZSwKKwkJ
CQkgICAgICAgLmVuZ2luZSA9IGViX3JpbmcoZSksCiAJCQkJICAgICAgIC5mbGFncyA9IElHVF9T
UElOX1BPTExfUlVOKTsKIAkJaWd0X3NwaW5fYnVzeXdhaXRfdW50aWxfc3RhcnRlZCh0YXNrW2ld
Lnhjcyk7CiAKQEAgLTUxNCw3ICs1MTEsNiBAQCBzdGF0aWMgdm9pZCBzZW1hcGhvcmVfcmVzb2x2
ZShpbnQgaTkxNSkKIHsKIAljb25zdCB1aW50MzJfdCBTRU1BUEhPUkVfQUREUiA9IDY0IDw8IDEw
OwogCXVpbnQzMl90IHNlbWFwaG9yZSwgb3V0ZXIsIGlubmVyLCAqc2VtYTsKLQl1bnNpZ25lZCBp
bnQgZW5naW5lOwogCiAJLyoKIAkgKiBVc2Vyc3BhY2UgbWF5IHN1Ym1pdCBiYXRjaGVzIHRoYXQg
d2FpdCB1cG9uIHVucmVzb2x2ZWQKQEAgLTUzNCw3ICs1MzAsNyBAQCBzdGF0aWMgdm9pZCBzZW1h
cGhvcmVfcmVzb2x2ZShpbnQgaTkxNSkKIAlzZW1hcGhvcmUgPSBnZW1fY3JlYXRlKGk5MTUsIDQw
OTYpOwogCXNlbWEgPSBnZW1fbW1hcF9fd2MoaTkxNSwgc2VtYXBob3JlLCAwLCA0MDk2LCBQUk9U
X1dSSVRFKTsKIAotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShpOTE1LCBlbmdpbmUpIHsKKwlm
b3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgaTkxNSkgewogCQlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X2V4ZWNfb2JqZWN0MiBvYmpbM107CiAJCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIg
ZWI7CiAJCXVpbnQzMl90IGhhbmRsZSwgY2FuY2VsOwpAQCAtNTQyLDEwICs1MzgsMTAgQEAgc3Rh
dGljIHZvaWQgc2VtYXBob3JlX3Jlc29sdmUoaW50IGk5MTUpCiAJCWlndF9zcGluX3QgKnNwaW47
CiAJCWludDY0X3QgcG9rZSA9IDE7CiAKLQkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGk5MTUs
IGVuZ2luZSkpCisJCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChpOTE1LCBlYl9yaW5nKGUpKSkK
IAkJCWNvbnRpbnVlOwogCi0JCXNwaW4gPSBfX2lndF9zcGluX25ldyhpOTE1LCAuZW5naW5lID0g
ZW5naW5lKTsKKwkJc3BpbiA9IF9faWd0X3NwaW5fbmV3KGk5MTUsIC5lbmdpbmUgPSBlYl9yaW5n
KGUpKTsKIAkJaWd0X3NwaW5fZW5kKHNwaW4pOyAvKiB3ZSBqdXN0IHdhbnQgaXRzIGFkZHJlc3Mg
Zm9yIGxhdGVyICovCiAJCWdlbV9zeW5jKGk5MTUsIHNwaW4tPmhhbmRsZSk7CiAJCWlndF9zcGlu
X3Jlc2V0KHNwaW4pOwpAQCAtNjQyLDI2ICs2MzgsMjcgQEAgc3RhdGljIHZvaWQgc2VtYXBob3Jl
X3Jlc29sdmUoaW50IGk5MTUpCiBzdGF0aWMgdm9pZCBzZW1hcGhvcmVfbm9za2lwKGludCBpOTE1
KQogewogCWNvbnN0IGludCBnZW4gPSBpbnRlbF9nZW4oaW50ZWxfZ2V0X2RybV9kZXZpZChpOTE1
KSk7Ci0JdW5zaWduZWQgaW50IGVuZ2luZSwgb3RoZXI7CisJdW5zaWduZWQgaW50IG90aGVyOwog
CXVpbnQzMl90IGN0eDsKIAogCWlndF9yZXF1aXJlKGdlbiA+PSA2KTsgLyogTUlfU1RPUkVfRFdP
UkRfSU1NIGNvbnZlbmllbmNlICovCiAKIAljdHggPSBnZW1fY29udGV4dF9jcmVhdGUoaTkxNSk7
CiAKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoaTkxNSwgZW5naW5lKSB7Ci0JZm9yX2VhY2hf
cGh5c2ljYWxfZW5naW5lKGk5MTUsIG90aGVyKSB7CisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5l
KG91dGVyLCBpOTE1KSB7CisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGlubmVyLCBpOTE1KSB7
CiAJCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY19vYmplY3QyIG9ialszXTsKIAkJc3RydWN0IGRy
bV9pOTE1X2dlbV9leGVjYnVmZmVyMiBlYjsKIAkJdWludDMyX3QgaGFuZGxlLCAqY3MsICptYXA7
CiAJCWlndF9zcGluX3QgKmNoYWluLCAqc3BpbjsKIAotCQlpZiAob3RoZXIgPT0gZW5naW5lIHx8
ICFnZW1fY2FuX3N0b3JlX2R3b3JkKGk5MTUsIG90aGVyKSkKKwkJaWYgKGViX3JpbmcoaW5uZXIp
ID09IGViX3Jpbmcob3V0ZXIpIHx8CisJCSAgICAhZ2VtX2Nhbl9zdG9yZV9kd29yZChpOTE1LCBl
Yl9yaW5nKGlubmVyKSkpCiAJCQljb250aW51ZTsKIAotCQljaGFpbiA9IF9faWd0X3NwaW5fbmV3
KGk5MTUsIC5lbmdpbmUgPSBlbmdpbmUpOworCQljaGFpbiA9IF9faWd0X3NwaW5fbmV3KGk5MTUs
IC5lbmdpbmUgPSBlYl9yaW5nKG91dGVyKSk7CiAKLQkJc3BpbiA9IF9faWd0X3NwaW5fbmV3KGk5
MTUsIC5lbmdpbmUgPSBvdGhlcik7CisJCXNwaW4gPSBfX2lndF9zcGluX25ldyhpOTE1LCAuZW5n
aW5lID0gZWJfcmluZyhpbm5lcikpOwogCQlpZ3Rfc3Bpbl9lbmQoc3Bpbik7IC8qIHdlIGp1c3Qg
d2FudCBpdHMgYWRkcmVzcyBmb3IgbGF0ZXIgKi8KIAkJZ2VtX3N5bmMoaTkxNSwgc3Bpbi0+aGFu
ZGxlKTsKIAkJaWd0X3NwaW5fcmVzZXQoc3Bpbik7CkBAIC04NjcsMjEgKzg2NCwxOSBAQCBzdGF0
aWMgdm9pZCBwcmVlbXB0KGludCBmZCwgdW5zaWduZWQgcmluZywgdW5zaWduZWQgZmxhZ3MpCiAK
IHN0YXRpYyBpZ3Rfc3Bpbl90ICpfX25vaXNlKGludCBmZCwgdWludDMyX3QgY3R4LCBpbnQgcHJp
bywgaWd0X3NwaW5fdCAqc3BpbikKIHsKLQl1bnNpZ25lZCBvdGhlcjsKLQogCWdlbV9jb250ZXh0
X3NldF9wcmlvcml0eShmZCwgY3R4LCBwcmlvKTsKIAotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2lu
ZShmZCwgb3RoZXIpIHsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKIAkJaWYg
KHNwaW4gPT0gTlVMTCkgewogCQkJc3BpbiA9IF9faWd0X3NwaW5fbmV3KGZkLAogCQkJCQkgICAg
ICAuY3R4ID0gY3R4LAotCQkJCQkgICAgICAuZW5naW5lID0gb3RoZXIpOworCQkJCQkgICAgICAu
ZW5naW5lID0gZWJfcmluZyhlKSk7CiAJCX0gZWxzZSB7CiAJCQlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X2V4ZWNidWZmZXIyIGViID0gewogCQkJCS5idWZmZXJfY291bnQgPSAxLAogCQkJCS5idWZmZXJz
X3B0ciA9IHRvX3VzZXJfcG9pbnRlcigmc3Bpbi0+b2JqW0lHVF9TUElOX0JBVENIXSksCiAJCQkJ
LnJzdmQxID0gY3R4LAotCQkJCS5mbGFncyA9IG90aGVyLAorCQkJCS5mbGFncyA9IGViX3Jpbmco
ZSksCiAJCQl9OwogCQkJZ2VtX2V4ZWNidWYoZmQsICZlYik7CiAJCX0KQEAgLTg5Nyw3ICs4OTIs
NyBAQCBzdGF0aWMgdm9pZCBfX3ByZWVtcHRfb3RoZXIoaW50IGZkLAogewogCXVpbnQzMl90IHJl
c3VsdCA9IGdlbV9jcmVhdGUoZmQsIDQwOTYpOwogCXVpbnQzMl90IHJlc3VsdF9yZWFkWzQwOTYg
LyBzaXplb2YodWludDMyX3QpXTsKLQl1bnNpZ25lZCBpbnQgbiwgaSwgb3RoZXI7CisJdW5zaWdu
ZWQgaW50IG4sIGk7CiAKIAluID0gMDsKIAlzdG9yZV9kd29yZChmZCwgY3R4W0xPXSwgcHJpbWFy
eSwKQEAgLTkwNiw4ICs5MDEsOCBAQCBzdGF0aWMgdm9pZCBfX3ByZWVtcHRfb3RoZXIoaW50IGZk
LAogCW4rKzsKIAogCWlmIChmbGFncyAmIENIQUlOKSB7Ci0JCWZvcl9lYWNoX3BoeXNpY2FsX2Vu
Z2luZShmZCwgb3RoZXIpIHsKLQkJCXN0b3JlX2R3b3JkKGZkLCBjdHhbTE9dLCBvdGhlciwKKwkJ
Zm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7CisJCQlzdG9yZV9kd29yZChmZCwgY3R4
W0xPXSwgZWJfcmluZyhlKSwKIAkJCQkgICAgcmVzdWx0LCAobiArIDEpKnNpemVvZih1aW50MzJf
dCksIG4gKyAxLAogCQkJCSAgICBJOTE1X0dFTV9ET01BSU5fUkVOREVSKTsKIAkJCW4rKzsKQEAg
LTkzMiw3ICs5MjcsNiBAQCBzdGF0aWMgdm9pZCBfX3ByZWVtcHRfb3RoZXIoaW50IGZkLAogCiBz
dGF0aWMgdm9pZCBwcmVlbXB0X290aGVyKGludCBmZCwgdW5zaWduZWQgcmluZywgdW5zaWduZWQg
aW50IGZsYWdzKQogewotCXVuc2lnbmVkIGludCBwcmltYXJ5OwogCWlndF9zcGluX3QgKnNwaW4g
PSBOVUxMOwogCXVpbnQzMl90IGN0eFszXTsKIApAQCAtOTU1LDkgKzk0OSw5IEBAIHN0YXRpYyB2
b2lkIHByZWVtcHRfb3RoZXIoaW50IGZkLCB1bnNpZ25lZCByaW5nLCB1bnNpZ25lZCBpbnQgZmxh
Z3MpCiAJY3R4W0hJXSA9IGdlbV9jb250ZXh0X2NyZWF0ZShmZCk7CiAJZ2VtX2NvbnRleHRfc2V0
X3ByaW9yaXR5KGZkLCBjdHhbSEldLCBNQVhfUFJJTyk7CiAKLQlmb3JfZWFjaF9waHlzaWNhbF9l
bmdpbmUoZmQsIHByaW1hcnkpIHsKLQkJaWd0X2RlYnVnKCJQcmltYXJ5IGVuZ2luZTogJXNcbiIs
IGVfXy0+bmFtZSk7Ci0JCV9fcHJlZW1wdF9vdGhlcihmZCwgY3R4LCByaW5nLCBwcmltYXJ5LCBm
bGFncyk7CisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7CisJCWlndF9kZWJ1Zygi
UHJpbWFyeSBlbmdpbmU6ICVzXG4iLCBlLT5uYW1lKTsKKwkJX19wcmVlbXB0X290aGVyKGZkLCBj
dHgsIHJpbmcsIGViX3JpbmcoZSksIGZsYWdzKTsKIAogCX0KIApAQCAtOTc2LDEzICs5NzAsMTMg
QEAgc3RhdGljIHZvaWQgX19wcmVlbXB0X3F1ZXVlKGludCBmZCwKIAl1aW50MzJfdCByZXN1bHQg
PSBnZW1fY3JlYXRlKGZkLCA0MDk2KTsKIAl1aW50MzJfdCByZXN1bHRfcmVhZFs0MDk2IC8gc2l6
ZW9mKHVpbnQzMl90KV07CiAJaWd0X3NwaW5fdCAqYWJvdmUgPSBOVUxMLCAqYmVsb3cgPSBOVUxM
OwotCXVuc2lnbmVkIGludCBvdGhlciwgbiwgaTsKLQlpbnQgcHJpbyA9IE1BWF9QUklPOwogCXVp
bnQzMl90IGN0eFszXSA9IHsKIAkJZ2VtX2NvbnRleHRfY3JlYXRlKGZkKSwKIAkJZ2VtX2NvbnRl
eHRfY3JlYXRlKGZkKSwKIAkJZ2VtX2NvbnRleHRfY3JlYXRlKGZkKSwKIAl9OworCWludCBwcmlv
ID0gTUFYX1BSSU87CisJdW5zaWduZWQgaW50IG4sIGk7CiAKIAlmb3IgKG4gPSAwOyBuIDwgZGVw
dGg7IG4rKykgewogCQlpZiAoZmxhZ3MgJiBDT05URVhUUykgewpAQCAtMTAxMSw4ICsxMDA1LDgg
QEAgc3RhdGljIHZvaWQgX19wcmVlbXB0X3F1ZXVlKGludCBmZCwKIAluKys7CiAKIAlpZiAoZmxh
Z3MgJiBDSEFJTikgewotCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIG90aGVyKSB7Ci0J
CQlzdG9yZV9kd29yZChmZCwgY3R4W0xPXSwgb3RoZXIsCisJCWZvcl9lYWNoX3BoeXNpY2FsX2Vu
Z2luZShlLCBmZCkgeworCQkJc3RvcmVfZHdvcmQoZmQsIGN0eFtMT10sIGViX3JpbmcoZSksCiAJ
CQkJICAgIHJlc3VsdCwgKG4gKyAxKSpzaXplb2YodWludDMyX3QpLCBuICsgMSwKIAkJCQkgICAg
STkxNV9HRU1fRE9NQUlOX1JFTkRFUik7CiAJCQluKys7CkBAIC0xMDUyLDExICsxMDQ2LDkgQEAg
c3RhdGljIHZvaWQgX19wcmVlbXB0X3F1ZXVlKGludCBmZCwKIAogc3RhdGljIHZvaWQgcHJlZW1w
dF9xdWV1ZShpbnQgZmQsIHVuc2lnbmVkIHJpbmcsIHVuc2lnbmVkIGludCBmbGFncykKIHsKLQl1
bnNpZ25lZCBvdGhlcjsKLQotCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgb3RoZXIpIHsK
Kwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKIAkJZm9yICh1bnNpZ25lZCBkZXB0
aCA9IDA7IGRlcHRoIDw9IE1BWF9FTFNQX1FMRU47IGRlcHRoKyspCi0JCQlfX3ByZWVtcHRfcXVl
dWUoZmQsIHJpbmcsIG90aGVyLCBkZXB0aCwgZmxhZ3MpOworCQkJX19wcmVlbXB0X3F1ZXVlKGZk
LCByaW5nLCBlYl9yaW5nKGUpLCBkZXB0aCwgZmxhZ3MpOwogCX0KIH0KIApAQCAtMTA2NSw3ICsx
MDU3LDYgQEAgc3RhdGljIHZvaWQgcHJlZW1wdF9zZWxmKGludCBmZCwgdW5zaWduZWQgcmluZykK
IAl1aW50MzJfdCByZXN1bHQgPSBnZW1fY3JlYXRlKGZkLCA0MDk2KTsKIAl1aW50MzJfdCByZXN1
bHRfcmVhZFs0MDk2IC8gc2l6ZW9mKHVpbnQzMl90KV07CiAJaWd0X3NwaW5fdCAqc3BpbltNQVhf
RUxTUF9RTEVOXTsKLQl1bnNpZ25lZCBpbnQgb3RoZXI7CiAJdW5zaWduZWQgaW50IG4sIGk7CiAJ
dWludDMyX3QgY3R4WzNdOwogCkBAIC0xMDgzLDExICsxMDc0LDExIEBAIHN0YXRpYyB2b2lkIHBy
ZWVtcHRfc2VsZihpbnQgZmQsIHVuc2lnbmVkIHJpbmcpCiAKIAluID0gMDsKIAlnZW1fY29udGV4
dF9zZXRfcHJpb3JpdHkoZmQsIGN0eFtISV0sIE1JTl9QUklPKTsKLQlmb3JfZWFjaF9waHlzaWNh
bF9lbmdpbmUoZmQsIG90aGVyKSB7CisJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7
CiAJCXNwaW5bbl0gPSBfX2lndF9zcGluX25ldyhmZCwKIAkJCQkJIC5jdHggPSBjdHhbTk9JU0Vd
LAotCQkJCQkgLmVuZ2luZSA9IG90aGVyKTsKLQkJc3RvcmVfZHdvcmQoZmQsIGN0eFtISV0sIG90
aGVyLAorCQkJCQkgLmVuZ2luZSA9IGViX3JpbmcoZSkpOworCQlzdG9yZV9kd29yZChmZCwgY3R4
W0hJXSwgZWJfcmluZyhlKSwKIAkJCSAgICByZXN1bHQsIChuICsgMSkqc2l6ZW9mKHVpbnQzMl90
KSwgbiArIDEsCiAJCQkgICAgSTkxNV9HRU1fRE9NQUlOX1JFTkRFUik7CiAJCW4rKzsKQEAgLTE2
MDgsMTMgKzE1OTksMTIgQEAgc3RhdGljIHZvaWQgdGVzdF9waV9yaW5nZnVsbChpbnQgZmQsIHVu
c2lnbmVkIGludCBlbmdpbmUpCiAKIHN0YXRpYyB2b2lkIG1lYXN1cmVfc2VtYXBob3JlX3Bvd2Vy
KGludCBpOTE1KQogewotCXVuc2lnbmVkIGludCBlbmdpbmUsIHNpZ25hbGVyOwogCXN0cnVjdCBy
YXBsIGdwdSwgcGtnOwogCiAJaWd0X3JlcXVpcmUoZ3B1X3Bvd2VyX29wZW4oJmdwdSkgPT0gMCk7
CiAJcGtnX3Bvd2VyX29wZW4oJnBrZyk7CiAKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoaTkx
NSwgc2lnbmFsZXIpIHsKKwlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoc2lnbmFsZXIsIGk5MTUp
IHsKIAkJc3RydWN0IHsKIAkJCXN0cnVjdCBwb3dlcl9zYW1wbGUgcGtnLCBncHU7CiAJCX0gc19z
cGluWzJdLCBzX3NlbWFbMl07CkBAIC0xNjIzLDcgKzE2MTMsNyBAQCBzdGF0aWMgdm9pZCBtZWFz
dXJlX3NlbWFwaG9yZV9wb3dlcihpbnQgaTkxNSkKIAkJaWd0X3NwaW5fdCAqc3BpbjsKIAogCQlz
cGluID0gX19pZ3Rfc3Bpbl9uZXcoaTkxNSwKLQkJCQkgICAgICAuZW5naW5lID0gc2lnbmFsZXIs
CisJCQkJICAgICAgLmVuZ2luZSA9IGViX3Jpbmcoc2lnbmFsZXIpLAogCQkJCSAgICAgIC5mbGFn
cyA9IElHVF9TUElOX1BPTExfUlVOKTsKIAkJZ2VtX3dhaXQoaTkxNSwgc3Bpbi0+aGFuZGxlLCAm
amlmZmllKTsgLyogd2FpdGJvb3N0ICovCiAJCWlndF9zcGluX2J1c3l3YWl0X3VudGlsX3N0YXJ0
ZWQoc3Bpbik7CkBAIC0xNjM1LDE0ICsxNjI1LDE0IEBAIHN0YXRpYyB2b2lkIG1lYXN1cmVfc2Vt
YXBob3JlX3Bvd2VyKGludCBpOTE1KQogCQlyYXBsX3JlYWQoJnBrZywgJnNfc3BpblsxXS5wa2cp
OwogCiAJCS8qIEFkZCBhIHdhaXRlciB0byBlYWNoIGVuZ2luZSAqLwotCQlmb3JfZWFjaF9waHlz
aWNhbF9lbmdpbmUoaTkxNSwgZW5naW5lKSB7CisJCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShl
LCBpOTE1KSB7CiAJCQlpZ3Rfc3Bpbl90ICpzZW1hOwogCi0JCQlpZiAoZW5naW5lID09IHNpZ25h
bGVyKQorCQkJaWYgKGViX3JpbmcoZSkgPT0gZWJfcmluZyhzaWduYWxlcikpCiAJCQkJY29udGlu
dWU7CiAKIAkJCXNlbWEgPSBfX2lndF9zcGluX25ldyhpOTE1LAotCQkJCQkgICAgICAuZW5naW5l
ID0gZW5naW5lLAorCQkJCQkgICAgICAuZW5naW5lID0gZWJfcmluZyhlKSwKIAkJCQkJICAgICAg
LmRlcGVuZGVuY3kgPSBzcGluLT5oYW5kbGUpOwogCiAJCQlpZ3Rfc3Bpbl9mcmVlKGk5MTUsIHNl
bWEpOwpAQCAtMTY2MCw3ICsxNjUwLDcgQEAgc3RhdGljIHZvaWQgbWVhc3VyZV9zZW1hcGhvcmVf
cG93ZXIoaW50IGk5MTUpCiAJCWJhc2VsaW5lID0gcG93ZXJfVygmZ3B1LCAmc19zcGluWzBdLmdw
dSwgJnNfc3BpblsxXS5ncHUpOwogCQl0b3RhbCA9IHBvd2VyX1coJmdwdSwgJnNfc2VtYVswXS5n
cHUsICZzX3NlbWFbMV0uZ3B1KTsKIAkJaWd0X2luZm8oIiVzOiAlLjFmbVcgKyAlLjFmbVcgKHRv
dGFsICUxLmZtVylcbiIsCi0JCQkgZV9fLT5uYW1lLAorCQkJIHNpZ25hbGVyLT5uYW1lLAogCQkJ
IDFlMyAqIGJhc2VsaW5lLAogCQkJIDFlMyAqICh0b3RhbCAtIGJhc2VsaW5lKSwKIAkJCSAxZTMg
KiB0b3RhbCk7CkBAIC0xNzA3LDE1ICsxNjk3LDE1IEBAIGlndF9tYWluCiAJCQkJY29udGludWU7
CiAKIAkJCWlndF9zdWJ0ZXN0X2YoImZpZm8tJXMiLCBlLT5uYW1lKSB7Ci0JCQkJaWd0X3JlcXVp
cmUoZ2VtX3JpbmdfaGFzX3BoeXNpY2FsX2VuZ2luZShmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdz
KSk7Ci0JCQkJaWd0X3JlcXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZS0+ZXhlY19pZCB8
IGUtPmZsYWdzKSk7Ci0JCQkJZmlmbyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKKwkJCQlp
Z3RfcmVxdWlyZShnZW1fcmluZ19oYXNfcGh5c2ljYWxfZW5naW5lKGZkLCBlYl9yaW5nKGUpKSk7
CisJCQkJaWd0X3JlcXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmluZyhlKSkpOwor
CQkJCWZpZm8oZmQsIGViX3JpbmcoZSkpOwogCQkJfQogCiAJCQlpZ3Rfc3VidGVzdF9mKCJpbmRl
cGVuZGVudC0lcyIsIGUtPm5hbWUpIHsKLQkJCQlpZ3RfcmVxdWlyZShnZW1fcmluZ19oYXNfcGh5
c2ljYWxfZW5naW5lKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpKTsKLQkJCQlpZ3RfcmVxdWly
ZShnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpKTsKLQkJCQlp
bmRlcGVuZGVudChmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKKwkJCQlpZ3RfcmVxdWlyZShn
ZW1fcmluZ19oYXNfcGh5c2ljYWxfZW5naW5lKGZkLCBlYl9yaW5nKGUpKSk7CisJCQkJaWd0X3Jl
cXVpcmUoZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmluZyhlKSkpOworCQkJCWluZGVwZW5k
ZW50KGZkLCBlYl9yaW5nKGUpKTsKIAkJCX0KIAkJfQogCX0KQEAgLTE3NDQsMTggKzE3MzQsMTgg
QEAgaWd0X21haW4KIAogCQkJaWd0X3N1YnRlc3RfZ3JvdXAgewogCQkJCWlndF9maXh0dXJlIHsK
LQkJCQkJaWd0X3JlcXVpcmUoZ2VtX3JpbmdfaGFzX3BoeXNpY2FsX2VuZ2luZShmZCwgZS0+ZXhl
Y19pZCB8IGUtPmZsYWdzKSk7Ci0JCQkJCWlndF9yZXF1aXJlKGdlbV9jYW5fc3RvcmVfZHdvcmQo
ZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncykpOworCQkJCQlpZ3RfcmVxdWlyZShnZW1fcmluZ19o
YXNfcGh5c2ljYWxfZW5naW5lKGZkLCBlYl9yaW5nKGUpKSk7CisJCQkJCWlndF9yZXF1aXJlKGdl
bV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3JpbmcoZSkpKTsKIAkJCQl9CiAKIAkJCQlpZ3Rfc3Vi
dGVzdF9mKCJpbi1vcmRlci0lcyIsIGUtPm5hbWUpCi0JCQkJCXJlb3JkZXIoZmQsIGUtPmV4ZWNf
aWQgfCBlLT5mbGFncywgRVFVQUwpOworCQkJCQlyZW9yZGVyKGZkLCBlYl9yaW5nKGUpLCBFUVVB
TCk7CiAKIAkJCQlpZ3Rfc3VidGVzdF9mKCJvdXQtb3JkZXItJXMiLCBlLT5uYW1lKQotCQkJCQly
ZW9yZGVyKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDApOworCQkJCQlyZW9yZGVyKGZkLCBl
Yl9yaW5nKGUpLCAwKTsKIAogCQkJCWlndF9zdWJ0ZXN0X2YoInByb21vdGlvbi0lcyIsIGUtPm5h
bWUpCi0JCQkJCXByb21vdGlvbihmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKKwkJCQkJcHJv
bW90aW9uKGZkLCBlYl9yaW5nKGUpKTsKIAogCQkJCWlndF9zdWJ0ZXN0X2dyb3VwIHsKIAkJCQkJ
aWd0X2ZpeHR1cmUgewpAQCAtMTc2MywzMCArMTc1MywzMCBAQCBpZ3RfbWFpbgogCQkJCQl9CiAK
IAkJCQkJaWd0X3N1YnRlc3RfZigicHJlZW1wdC0lcyIsIGUtPm5hbWUpCi0JCQkJCQlwcmVlbXB0
KGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDApOworCQkJCQkJcHJlZW1wdChmZCwgZWJfcmlu
ZyhlKSwgMCk7CiAKIAkJCQkJaWd0X3N1YnRlc3RfZigicHJlZW1wdC1jb250ZXh0cy0lcyIsIGUt
Pm5hbWUpCi0JCQkJCQlwcmVlbXB0KGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIE5FV19DVFgp
OworCQkJCQkJcHJlZW1wdChmZCwgZWJfcmluZyhlKSwgTkVXX0NUWCk7CiAKIAkJCQkJaWd0X3N1
YnRlc3RfZigicHJlZW1wdC1zZWxmLSVzIiwgZS0+bmFtZSkKLQkJCQkJCXByZWVtcHRfc2VsZihm
ZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKKwkJCQkJCXByZWVtcHRfc2VsZihmZCwgZWJfcmlu
ZyhlKSk7CiAKIAkJCQkJaWd0X3N1YnRlc3RfZigicHJlZW1wdC1vdGhlci0lcyIsIGUtPm5hbWUp
Ci0JCQkJCQlwcmVlbXB0X290aGVyKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDApOworCQkJ
CQkJcHJlZW1wdF9vdGhlcihmZCwgZWJfcmluZyhlKSwgMCk7CiAKIAkJCQkJaWd0X3N1YnRlc3Rf
ZigicHJlZW1wdC1vdGhlci1jaGFpbi0lcyIsIGUtPm5hbWUpCi0JCQkJCQlwcmVlbXB0X290aGVy
KGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIENIQUlOKTsKKwkJCQkJCXByZWVtcHRfb3RoZXIo
ZmQsIGViX3JpbmcoZSksIENIQUlOKTsKIAogCQkJCQlpZ3Rfc3VidGVzdF9mKCJwcmVlbXB0LXF1
ZXVlLSVzIiwgZS0+bmFtZSkKLQkJCQkJCXByZWVtcHRfcXVldWUoZmQsIGUtPmV4ZWNfaWQgfCBl
LT5mbGFncywgMCk7CisJCQkJCQlwcmVlbXB0X3F1ZXVlKGZkLCBlYl9yaW5nKGUpLCAwKTsKIAog
CQkJCQlpZ3Rfc3VidGVzdF9mKCJwcmVlbXB0LXF1ZXVlLWNoYWluLSVzIiwgZS0+bmFtZSkKLQkJ
CQkJCXByZWVtcHRfcXVldWUoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgQ0hBSU4pOworCQkJ
CQkJcHJlZW1wdF9xdWV1ZShmZCwgZWJfcmluZyhlKSwgQ0hBSU4pOwogCQkJCQlpZ3Rfc3VidGVz
dF9mKCJwcmVlbXB0LXF1ZXVlLWNvbnRleHRzLSVzIiwgZS0+bmFtZSkKLQkJCQkJCXByZWVtcHRf
cXVldWUoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgQ09OVEVYVFMpOworCQkJCQkJcHJlZW1w
dF9xdWV1ZShmZCwgZWJfcmluZyhlKSwgQ09OVEVYVFMpOwogCiAJCQkJCWlndF9zdWJ0ZXN0X2Yo
InByZWVtcHQtcXVldWUtY29udGV4dHMtY2hhaW4tJXMiLCBlLT5uYW1lKQotCQkJCQkJcHJlZW1w
dF9xdWV1ZShmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBDT05URVhUUyB8IENIQUlOKTsKKwkJ
CQkJCXByZWVtcHRfcXVldWUoZmQsIGViX3JpbmcoZSksIENPTlRFWFRTIHwgQ0hBSU4pOwogCiAJ
CQkJCWlndF9zdWJ0ZXN0X2dyb3VwIHsKIAkJCQkJCWlndF9oYW5nX3QgaGFuZzsKQEAgLTE3OTcs
MTEgKzE3ODcsMTEgQEAgaWd0X21haW4KIAkJCQkJCX0KIAogCQkJCQkJaWd0X3N1YnRlc3RfZigi
cHJlZW1wdC1oYW5nLSVzIiwgZS0+bmFtZSkgewotCQkJCQkJCXByZWVtcHQoZmQsIGUtPmV4ZWNf
aWQgfCBlLT5mbGFncywgTkVXX0NUWCB8IEhBTkdfTFApOworCQkJCQkJCXByZWVtcHQoZmQsIGVi
X3JpbmcoZSksIE5FV19DVFggfCBIQU5HX0xQKTsKIAkJCQkJCX0KIAogCQkJCQkJaWd0X3N1YnRl
c3RfZigicHJlZW1wdGl2ZS1oYW5nLSVzIiwgZS0+bmFtZSkKLQkJCQkJCQlwcmVlbXB0aXZlX2hh
bmcoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7CisJCQkJCQkJcHJlZW1wdGl2ZV9oYW5nKGZk
LCBlYl9yaW5nKGUpKTsKIAogCQkJCQkJaWd0X2ZpeHR1cmUgewogCQkJCQkJCWlndF9kaXNhbGxv
d19oYW5nKGZkLCBoYW5nKTsKQEAgLTE4MTEsMTYgKzE4MDEsMTYgQEAgaWd0X21haW4KIAkJCQl9
CiAKIAkJCQlpZ3Rfc3VidGVzdF9mKCJkZWVwLSVzIiwgZS0+bmFtZSkKLQkJCQkJZGVlcChmZCwg
ZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKKwkJCQkJZGVlcChmZCwgZWJfcmluZyhlKSk7CiAKIAkJ
CQlpZ3Rfc3VidGVzdF9mKCJ3aWRlLSVzIiwgZS0+bmFtZSkKLQkJCQkJd2lkZShmZCwgZS0+ZXhl
Y19pZCB8IGUtPmZsYWdzKTsKKwkJCQkJd2lkZShmZCwgZWJfcmluZyhlKSk7CiAKIAkJCQlpZ3Rf
c3VidGVzdF9mKCJyZW9yZGVyLXdpZGUtJXMiLCBlLT5uYW1lKQotCQkJCQlyZW9yZGVyX3dpZGUo
ZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7CisJCQkJCXJlb3JkZXJfd2lkZShmZCwgZWJfcmlu
ZyhlKSk7CiAKIAkJCQlpZ3Rfc3VidGVzdF9mKCJzbW9rZXRlc3QtJXMiLCBlLT5uYW1lKQotCQkJ
CQlzbW9rZXRlc3QoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgNSk7CisJCQkJCXNtb2tldGVz
dChmZCwgZWJfcmluZyhlKSwgNSk7CiAJCQl9CiAJCX0KIAl9CkBAIC0xODM3LDEyICsxODI3LDEy
IEBAIGlndF9tYWluCiAKIAkJCWlndF9zdWJ0ZXN0X2dyb3VwIHsKIAkJCQlpZ3RfZml4dHVyZSB7
Ci0JCQkJCWlndF9yZXF1aXJlKGdlbV9yaW5nX2hhc19waHlzaWNhbF9lbmdpbmUoZmQsIGUtPmV4
ZWNfaWQgfCBlLT5mbGFncykpOworCQkJCQlpZ3RfcmVxdWlyZShnZW1fcmluZ19oYXNfcGh5c2lj
YWxfZW5naW5lKGZkLCBlYl9yaW5nKGUpKSk7CiAJCQkJCWlndF9yZXF1aXJlKGdlbV9zY2hlZHVs
ZXJfaGFzX3ByZWVtcHRpb24oZmQpKTsKIAkJCQl9CiAKIAkJCQlpZ3Rfc3VidGVzdF9mKCJwaS1y
aW5nZnVsbC0lcyIsIGUtPm5hbWUpCi0JCQkJCXRlc3RfcGlfcmluZ2Z1bGwoZmQsIGUtPmV4ZWNf
aWQgfCBlLT5mbGFncyk7CisJCQkJCXRlc3RfcGlfcmluZ2Z1bGwoZmQsIGViX3JpbmcoZSkpOwog
CQkJfQogCQl9CiAJfQpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fZXhlY19zdXNwZW5kLmMg
Yi90ZXN0cy9pOTE1L2dlbV9leGVjX3N1c3BlbmQuYwppbmRleCBlNDNhMTZlOWUuLjU2MWExMGE0
YiAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fZXhlY19zdXNwZW5kLmMKKysrIGIvdGVzdHMv
aTkxNS9nZW1fZXhlY19zdXNwZW5kLmMKQEAgLTY0LDExICs2NCw5IEBAIHN0YXRpYyB2b2lkIGNo
ZWNrX2JvKGludCBmZCwgdWludDMyX3QgaGFuZGxlKQogCiBzdGF0aWMgdm9pZCB0ZXN0X2FsbChp
bnQgZmQsIHVuc2lnbmVkIGZsYWdzKQogewotCXVuc2lnbmVkIGVuZ2luZTsKLQotCWZvcl9lYWNo
X3BoeXNpY2FsX2VuZ2luZShmZCwgZW5naW5lKQotCQlpZiAoZ2VtX2Nhbl9zdG9yZV9kd29yZChm
ZCwgZW5naW5lKSkKLQkJCXJ1bl90ZXN0KGZkLCBlbmdpbmUsIGZsYWdzICYgfjB4ZmYpOworCWZv
cl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkKKwkJaWYgKGdlbV9jYW5fc3RvcmVfZHdvcmQo
ZmQsIGViX3JpbmcoZSkpKQorCQkJcnVuX3Rlc3QoZmQsIGViX3JpbmcoZSksIGZsYWdzICYgfjB4
ZmYpOwogfQogCiBzdGF0aWMgYm9vbCBoYXNfc2VtYXBob3JlcyhpbnQgZmQpCkBAIC0xMDYsOSAr
MTA0LDkgQEAgc3RhdGljIHZvaWQgcnVuX3Rlc3QoaW50IGZkLCB1bnNpZ25lZCBlbmdpbmUsIHVu
c2lnbmVkIGZsYWdzKQogCQkgKiBHUFUgaXMgdGhlbiB1bmxpa2VseSB0byBiZSBhY3RpdmUhKQog
CQkgKi8KIAkJaWYgKGhhc19zZW1hcGhvcmVzKGZkKSkgewotCQkJZm9yX2VhY2hfcGh5c2ljYWxf
ZW5naW5lKGZkLCBlbmdpbmUpIHsKLQkJCQlpZiAoZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZW5n
aW5lKSkKLQkJCQkJZW5naW5lc1tuZW5naW5lKytdID0gZW5naW5lOworCQkJZm9yX2VhY2hfcGh5
c2ljYWxfZW5naW5lKGUsIGZkKSB7CisJCQkJaWYgKGdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGVi
X3JpbmcoZSkpKQorCQkJCQllbmdpbmVzW25lbmdpbmUrK10gPSBlYl9yaW5nKGUpOwogCQkJfQog
CQl9IGVsc2UgewogCQkJaWd0X3JlcXVpcmUoZ2VtX2hhc19yaW5nKGZkLCAwKSk7CkBAIC0yNjcs
MTEgKzI2NSw5IEBAIGlndF9tYWluCiAJZm9yIChlID0gaW50ZWxfZXhlY3V0aW9uX2VuZ2luZXM7
IGUtPm5hbWU7IGUrKykgewogCQlmb3IgKG0gPSBtb2RlczsgbS0+c3VmZml4OyBtKyspIHsKIAkJ
CWlndF9zdWJ0ZXN0X2YoIiVzLXVuY2FjaGVkJXMiLCBlLT5uYW1lLCBtLT5zdWZmaXgpCi0JCQkJ
cnVuX3Rlc3QoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywKLQkJCQkJIG0tPm1vZGUgfCBVTkNB
Q0hFRCk7CisJCQkJcnVuX3Rlc3QoZmQsIGViX3JpbmcoZSksIG0tPm1vZGUgfCBVTkNBQ0hFRCk7
CiAJCQlpZ3Rfc3VidGVzdF9mKCIlcy1jYWNoZWQlcyIsIGUtPm5hbWUsIG0tPnN1ZmZpeCkKLQkJ
CQlydW5fdGVzdChmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLAotCQkJCQkgbS0+bW9kZSB8IENB
Q0hFRCk7CisJCQkJcnVuX3Rlc3QoZmQsIGViX3JpbmcoZSksIG0tPm1vZGUgfCBDQUNIRUQpOwog
CQl9CiAJfQogCmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9leGVjX3doaXNwZXIuYyBiL3Rl
c3RzL2k5MTUvZ2VtX2V4ZWNfd2hpc3Blci5jCmluZGV4IDExMzVjNjQ5Ny4uYTMzODQ3NjA4IDEw
MDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9leGVjX3doaXNwZXIuYworKysgYi90ZXN0cy9pOTE1
L2dlbV9leGVjX3doaXNwZXIuYwpAQCAtMjAzLDkgKzIwMyw5IEBAIHN0YXRpYyB2b2lkIHdoaXNw
ZXIoaW50IGZkLCB1bnNpZ25lZCBlbmdpbmUsIHVuc2lnbmVkIGZsYWdzKQogCiAJbmVuZ2luZSA9
IDA7CiAJaWYgKGVuZ2luZSA9PSBBTExfRU5HSU5FUykgewotCQlmb3JfZWFjaF9waHlzaWNhbF9l
bmdpbmUoZmQsIGVuZ2luZSkgewotCQkJaWYgKGdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGVuZ2lu
ZSkpCi0JCQkJZW5naW5lc1tuZW5naW5lKytdID0gZW5naW5lOworCQlmb3JfZWFjaF9waHlzaWNh
bF9lbmdpbmUoZSwgZmQpIHsKKwkJCWlmIChnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5n
KGUpKSkKKwkJCQllbmdpbmVzW25lbmdpbmUrK10gPSBlYl9yaW5nKGUpOwogCQl9CiAJfSBlbHNl
IHsKIAkJaWd0X2Fzc2VydCghKGZsYWdzICYgQUxMKSk7CkBAIC01NzgsNyArNTc4LDcgQEAgaWd0
X21haW4KIAkJCQljb250aW51ZTsKIAogCQkJaWd0X3N1YnRlc3RfZigiJXMtJXMiLCBlLT5uYW1l
LCBtLT5uYW1lKQotCQkJCXdoaXNwZXIoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgbS0+Zmxh
Z3MpOworCQkJCXdoaXNwZXIoZmQsIGViX3JpbmcoZSksIG0tPmZsYWdzKTsKIAkJfQogCX0KIApk
aWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fbW9jc19zZXR0aW5ncy5jIGIvdGVzdHMvaTkxNS9n
ZW1fbW9jc19zZXR0aW5ncy5jCmluZGV4IDNhZDk0MTQ5MS4uZmMyY2NiMjE2IDEwMDY0NAotLS0g
YS90ZXN0cy9pOTE1L2dlbV9tb2NzX3NldHRpbmdzLmMKKysrIGIvdGVzdHMvaTkxNS9nZW1fbW9j
c19zZXR0aW5ncy5jCkBAIC02MDUsNyArNjA1LDcgQEAgaWd0X21haW4KIAkJCQkJCWlmIChmbGFn
cyAmIChNT0NTX05PTl9ERUZBVUxUX0NUWCB8IE1PQ1NfRElSVFlfVkFMVUVTKSkKIAkJCQkJCQln
ZW1fcmVxdWlyZV9jb250ZXh0cyhmZCk7CiAKLQkJCQkJCXJ1bl90ZXN0KGZkLCBlLT5leGVjX2lk
IHwgZS0+ZmxhZ3MsIGZsYWdzLCBtb2RlKTsKKwkJCQkJCXJ1bl90ZXN0KGZkLCBlYl9yaW5nKGUp
LCBmbGFncywgbW9kZSk7CiAJCQkJCX0KIAkJCQl9CiAKQEAgLTYxNywxMCArNjE3LDEwIEBAIGln
dF9tYWluCiAJCX0KIAogCQlpZ3Rfc3VidGVzdF9mKCJtb2NzLWlzb2xhdGlvbi0lcyIsIGUtPm5h
bWUpIHsKLQkJCWdlbV9yZXF1aXJlX3JpbmcoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7CisJ
CQlnZW1fcmVxdWlyZV9yaW5nKGZkLCBlYl9yaW5nKGUpKTsKIAkJCWdlbV9yZXF1aXJlX2NvbnRl
eHRzKGZkKTsKIAotCQkJaXNvbGF0aW9uX3Rlc3QoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7
CisJCQlpc29sYXRpb25fdGVzdChmZCwgZWJfcmluZyhlKSk7CiAJCX0KIAl9CiAKZGlmZiAtLWdp
dCBhL3Rlc3RzL2k5MTUvZ2VtX3Jlc2V0X3N0YXRzLmMgYi90ZXN0cy9pOTE1L2dlbV9yZXNldF9z
dGF0cy5jCmluZGV4IGFjOWFmMjNmMi4uMDkzMTY0MWE3IDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1
L2dlbV9yZXNldF9zdGF0cy5jCisrKyBiL3Rlc3RzL2k5MTUvZ2VtX3Jlc2V0X3N0YXRzLmMKQEAg
LTg4LDcgKzg4LDcgQEAgc3RhdGljIGludCBub29wKGludCBmZCwgdWludDMyX3QgY3R4LCBjb25z
dCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSAqZSkKIAltZW1zZXQoJmViLCAwLCBzaXpl
b2YoZWIpKTsKIAllYi5idWZmZXJzX3B0ciA9IHRvX3VzZXJfcG9pbnRlcigmZXhlYyk7CiAJZWIu
YnVmZmVyX2NvdW50ID0gMTsKLQllYi5mbGFncyA9IGUtPmV4ZWNfaWQgfCBlLT5mbGFnczsKKwll
Yi5mbGFncyA9IGViX3JpbmcoZSk7CiAJaTkxNV9leGVjYnVmZmVyMl9zZXRfY29udGV4dF9pZChl
YiwgY3R4KTsKIAogCXJldCA9IF9fZ2VtX2V4ZWNidWYoZmQsICZlYik7CkBAIC0xNjQsNyArMTY0
LDcgQEAgc3RhdGljIHZvaWQgaW5qZWN0X2hhbmcoaW50IGZkLCB1aW50MzJfdCBjdHgsCiAKIAlj
bG9ja19nZXR0aW1lKENMT0NLX01PTk9UT05JQywgJnRzX2luamVjdGVkKTsKIAotCWhhbmcgPSBp
Z3RfaGFuZ19jdHgoZmQsIGN0eCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBmbGFncyAmIEJBTik7
CisJaGFuZyA9IGlndF9oYW5nX2N0eChmZCwgY3R4LCBlYl9yaW5nKGUpLCBmbGFncyAmIEJBTik7
CiAJaWYgKChmbGFncyAmIEFTWU5DKSA9PSAwKQogCQlpZ3RfcG9zdF9oYW5nX3JpbmcoZmQsIGhh
bmcpOwogfQpAQCAtNTIzLDEyICs1MjMsMTIgQEAgc3RhdGljIHZvaWQgbm9vcF9vbl9lYWNoX3Jp
bmcoaW50IGZkLCBjb25zdCBib29sIHJldmVyc2UpCiAJCWZvciAoZSA9IGludGVsX2V4ZWN1dGlv
bl9lbmdpbmVzOyBlLT5uYW1lOyBlKyspCiAJCQk7CiAJCXdoaWxlICgtLWUgPj0gaW50ZWxfZXhl
Y3V0aW9uX2VuZ2luZXMpIHsKLQkJCWViLmZsYWdzID0gZS0+ZXhlY19pZCB8IGUtPmZsYWdzOwor
CQkJZWIuZmxhZ3MgPSBlYl9yaW5nKGUpOwogCQkJX19nZW1fZXhlY2J1ZihmZCwgJmViKTsKIAkJ
fQogCX0gZWxzZSB7CiAJCWZvciAoZSA9IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVzOyBlLT5uYW1l
OyBlKyspIHsKLQkJCWViLmZsYWdzID0gZS0+ZXhlY19pZCB8IGUtPmZsYWdzOworCQkJZWIuZmxh
Z3MgPSBlYl9yaW5nKGUpOwogCQkJX19nZW1fZXhlY2J1ZihmZCwgJmViKTsKIAkJfQogCX0KQEAg
LTU0Niw3ICs1NDYsNyBAQCBzdGF0aWMgdm9pZCB0ZXN0X2Nsb3NlX3BlbmRpbmdfZm9yayhjb25z
dCBzdHJ1Y3QgaW50ZWxfZXhlY3V0aW9uX2VuZ2luZSAqZSwKIAogCWFzc2VydF9yZXNldF9zdGF0
dXMoZmQsIGZkLCAwLCBSU19OT19FUlJPUik7CiAKLQloYW5nID0gaWd0X2hhbmdfY3R4KGZkLCAw
LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDApOworCWhhbmcgPSBpZ3RfaGFuZ19jdHgoZmQsIDAs
IGViX3JpbmcoZSksIDApOwogCXNsZWVwKDEpOwogCiAJLyogQXZvaWQgaGVscGVycyBhcyB3ZSBu
ZWVkIHRvIGtpbGwgdGhlIGNoaWxkCmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9yaW5nX3N5
bmNfbG9vcC5jIGIvdGVzdHMvaTkxNS9nZW1fcmluZ19zeW5jX2xvb3AuYwppbmRleCAxMThmMzYz
OGEuLjMyYjkzNjM3MyAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fcmluZ19zeW5jX2xvb3Au
YworKysgYi90ZXN0cy9pOTE1L2dlbV9yaW5nX3N5bmNfbG9vcC5jCkBAIC00NCwxMiArNDQsMTEg
QEAgc3luY19sb29wKGludCBmZCkKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX3JlbG9jYXRpb25fZW50
cnkgcmVsb2NbMV07CiAJdW5zaWduZWQgZW5naW5lc1sxNl07CiAJdW5zaWduZWQgbmVuZ2luZTsK
LQl1bnNpZ25lZCBlbmdpbmU7CiAJaW50IGk7CiAKIAluZW5naW5lID0gMDsKLQlmb3JfZWFjaF9w
aHlzaWNhbF9lbmdpbmUoZmQsIGVuZ2luZSkKLQkJZW5naW5lc1tuZW5naW5lKytdID0gZW5naW5l
OworCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBmZCkKKwkJZW5naW5lc1tuZW5naW5lKytd
ID0gZWJfcmluZyhlKTsKIAlpZ3RfcmVxdWlyZShuZW5naW5lKTsKIAogCW1lbXNldChvYmplY3Qs
IDAsIHNpemVvZihvYmplY3QpKTsKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX3JpbmdmaWxs
LmMgYi90ZXN0cy9pOTE1L2dlbV9yaW5nZmlsbC5jCmluZGV4IGM3MjhlMWNkMy4uYWY2NmQwMDEy
IDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9yaW5nZmlsbC5jCisrKyBiL3Rlc3RzL2k5MTUv
Z2VtX3JpbmdmaWxsLmMKQEAgLTI4OCw4ICsyODgsNyBAQCBpZ3RfbWFpbgogCQkJCWlndF9za2lw
X29uKG0tPmZsYWdzICYgTkVXRkQgJiYgbWFzdGVyKTsKIAkJCQlpZiAobS0+ZmxhZ3MgJiAoSEFO
R3xTVVNQRU5EfEhJQkVSTkFURSkpCiAJCQkJCWlndF9za2lwX29uX3NpbXVsYXRpb24oKTsKLQkJ
CQlydW5fdGVzdChmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLAotCQkJCQkgbS0+ZmxhZ3MsIG0t
PnRpbWVvdXQpOworCQkJCXJ1bl90ZXN0KGZkLCBlYl9yaW5nKGUpLCBtLT5mbGFncywgbS0+dGlt
ZW91dCk7CiAJCQl9CiAJCX0KIAl9CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9zaHJpbmsu
YyBiL3Rlc3RzL2k5MTUvZ2VtX3Nocmluay5jCmluZGV4IDNkYjc1NGY1NS4uZDJlYTJlZDg0IDEw
MDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9zaHJpbmsuYworKysgYi90ZXN0cy9pOTE1L2dlbV9z
aHJpbmsuYwpAQCAtNDI4LDcgKzQyOCw2IEBAIGlndF9tYWluCiAKIAlpZ3RfZml4dHVyZSB7CiAJ
CXVpbnQ2NF90IG1lbV9zaXplID0gaW50ZWxfZ2V0X3RvdGFsX3JhbV9tYigpOwotCQl1bnNpZ25l
ZCBpbnQgZW5naW5lOwogCQlpbnQgZmQ7CiAKIAkJZmQgPSBkcm1fb3Blbl9kcml2ZXIoRFJJVkVS
X0lOVEVMKTsKQEAgLTQ1MSw4ICs0NTAsOCBAQCBpZ3RfbWFpbgogCQkJCSAgICAgQ0hFQ0tfU1dB
UCB8IENIRUNLX1JBTSk7CiAKIAkJbmVuZ2luZSA9IDA7Ci0JCWZvcl9lYWNoX2VuZ2luZShmZCwg
ZW5naW5lKQotCQkJZW5naW5lc1tuZW5naW5lKytdID0gZW5naW5lOworCQlmb3JfZWFjaF9lbmdp
bmUoZSwgZmQpCisJCQllbmdpbmVzW25lbmdpbmUrK10gPSBlYl9yaW5nKGUpOwogCQlpZ3RfcmVx
dWlyZShuZW5naW5lKTsKIAogCQljbG9zZShmZCk7CmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dl
bV9zcGluX2JhdGNoLmMgYi90ZXN0cy9pOTE1L2dlbV9zcGluX2JhdGNoLmMKaW5kZXggZTA2MjNm
NGM5Li5kZjU5NTEyYTUgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX3NwaW5fYmF0Y2guYwor
KysgYi90ZXN0cy9pOTE1L2dlbV9zcGluX2JhdGNoLmMKQEAgLTE1Miw3ICsxNTIsNyBAQCBpZ3Rf
bWFpbgogCX0KIAogCWZvciAoZSA9IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVzOyBlLT5uYW1lOyBl
KyspIHsKLQkJZTJfXyA9IGdlbV9lYl9mbGFnc190b19lbmdpbmUoZS0+ZXhlY19pZCB8IGUtPmZs
YWdzKTsKKwkJZTJfXyA9IGdlbV9lYl9mbGFnc190b19lbmdpbmUoZWJfcmluZyhlKSk7CiAJCWlm
IChlMl9fLmZsYWdzID09IC0xKQogCQkJY29udGludWU7CiAJCWUyID0gJmUyX187CmRpZmYgLS1n
aXQgYS90ZXN0cy9pOTE1L2dlbV9zdG9yZWR3X2xvb3AuYyBiL3Rlc3RzL2k5MTUvZ2VtX3N0b3Jl
ZHdfbG9vcC5jCmluZGV4IGIwMDU1NWUwYy4uYmJkNjQwNDMxIDEwMDY0NAotLS0gYS90ZXN0cy9p
OTE1L2dlbV9zdG9yZWR3X2xvb3AuYworKysgYi90ZXN0cy9pOTE1L2dlbV9zdG9yZWR3X2xvb3Au
YwpAQCAtMTg2LDcgKzE4Niw3IEBAIGlndF9tYWluCiAJZm9yIChlID0gaW50ZWxfZXhlY3V0aW9u
X2VuZ2luZXM7IGUtPm5hbWU7IGUrKykgewogCQlpZ3Rfc3VidGVzdF9mKCJzdG9yZS0lcyIsIGUt
Pm5hbWUpIHsKIAkJCWNoZWNrX3Rlc3RfcmVxdWlyZW1lbnRzKGZkLCBlLT5leGVjX2lkKTsKLQkJ
CXN0b3JlX3Rlc3QoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7CisJCQlzdG9yZV90ZXN0KGZk
LCBlYl9yaW5nKGUpKTsKIAkJfQogCX0KIApkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fc3lu
Yy5jIGIvdGVzdHMvaTkxNS9nZW1fc3luYy5jCmluZGV4IDhjNWFhYTE0NC4uOWZmY2E0MTU1IDEw
MDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9zeW5jLmMKKysrIGIvdGVzdHMvaTkxNS9nZW1fc3lu
Yy5jCkBAIC04Niw5ICs4Niw5IEBAIHN5bmNfcmluZyhpbnQgZmQsIHVuc2lnbmVkIHJpbmcsIGlu
dCBudW1fY2hpbGRyZW4sIGludCB0aW1lb3V0KQogCWludCBudW1fZW5naW5lcyA9IDA7CiAKIAlp
ZiAocmluZyA9PSBBTExfRU5HSU5FUykgewotCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQs
IHJpbmcpIHsKLQkJCW5hbWVzW251bV9lbmdpbmVzXSA9IGVfXy0+bmFtZTsKLQkJCWVuZ2luZXNb
bnVtX2VuZ2luZXMrK10gPSByaW5nOworCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQp
IHsKKwkJCW5hbWVzW251bV9lbmdpbmVzXSA9IGUtPm5hbWU7CisJCQllbmdpbmVzW251bV9lbmdp
bmVzKytdID0gZWJfcmluZyhlKTsKIAkJCWlmIChudW1fZW5naW5lcyA9PSBBUlJBWV9TSVpFKGVu
Z2luZXMpKQogCQkJCWJyZWFrOwogCQl9CkBAIC0xODUsMTIgKzE4NSwxMiBAQCB3YWtldXBfcmlu
ZyhpbnQgZmQsIHVuc2lnbmVkIHJpbmcsIGludCB0aW1lb3V0LCBpbnQgd2xlbikKIAlpbnQgbnVt
X2VuZ2luZXMgPSAwOwogCiAJaWYgKHJpbmcgPT0gQUxMX0VOR0lORVMpIHsKLQkJZm9yX2VhY2hf
cGh5c2ljYWxfZW5naW5lKGZkLCByaW5nKSB7Ci0JCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQo
ZmQsIHJpbmcpKQorCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZSwgZmQpIHsKKwkJCWlmICgh
Z2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmluZyhlKSkpCiAJCQkJY29udGludWU7CiAKLQkJ
CW5hbWVzW251bV9lbmdpbmVzXSA9IGVfXy0+bmFtZTsKLQkJCWVuZ2luZXNbbnVtX2VuZ2luZXMr
K10gPSByaW5nOworCQkJbmFtZXNbbnVtX2VuZ2luZXNdID0gZS0+bmFtZTsKKwkJCWVuZ2luZXNb
bnVtX2VuZ2luZXMrK10gPSBlYl9yaW5nKGUpOwogCQkJaWYgKG51bV9lbmdpbmVzID09IEFSUkFZ
X1NJWkUoZW5naW5lcykpCiAJCQkJYnJlYWs7CiAJCX0KQEAgLTI5NywxMiArMjk3LDEyIEBAIHN0
YXRpYyB2b2lkIGFjdGl2ZV9yaW5nKGludCBmZCwgdW5zaWduZWQgcmluZywgaW50IHRpbWVvdXQp
CiAJaW50IG51bV9lbmdpbmVzID0gMDsKIAogCWlmIChyaW5nID09IEFMTF9FTkdJTkVTKSB7Ci0J
CWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgcmluZykgewotCQkJaWYgKCFnZW1fY2FuX3N0
b3JlX2R3b3JkKGZkLCByaW5nKSkKKwkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7
CisJCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3JpbmcoZSkpKQogCQkJCWNvbnRp
bnVlOwogCi0JCQluYW1lc1tudW1fZW5naW5lc10gPSBlX18tPm5hbWU7Ci0JCQllbmdpbmVzW251
bV9lbmdpbmVzKytdID0gcmluZzsKKwkJCW5hbWVzW251bV9lbmdpbmVzXSA9IGUtPm5hbWU7CisJ
CQllbmdpbmVzW251bV9lbmdpbmVzKytdID0gZWJfcmluZyhlKTsKIAkJCWlmIChudW1fZW5naW5l
cyA9PSBBUlJBWV9TSVpFKGVuZ2luZXMpKQogCQkJCWJyZWFrOwogCQl9CkBAIC0zNjQsMTIgKzM2
NCwxMiBAQCBhY3RpdmVfd2FrZXVwX3JpbmcoaW50IGZkLCB1bnNpZ25lZCByaW5nLCBpbnQgdGlt
ZW91dCwgaW50IHdsZW4pCiAJaW50IG51bV9lbmdpbmVzID0gMDsKIAogCWlmIChyaW5nID09IEFM
TF9FTkdJTkVTKSB7Ci0JCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgcmluZykgewotCQkJ
aWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCByaW5nKSkKKwkJZm9yX2VhY2hfcGh5c2ljYWxf
ZW5naW5lKGUsIGZkKSB7CisJCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3Jpbmco
ZSkpKQogCQkJCWNvbnRpbnVlOwogCi0JCQluYW1lc1tudW1fZW5naW5lc10gPSBlX18tPm5hbWU7
Ci0JCQllbmdpbmVzW251bV9lbmdpbmVzKytdID0gcmluZzsKKwkJCW5hbWVzW251bV9lbmdpbmVz
XSA9IGUtPm5hbWU7CisJCQllbmdpbmVzW251bV9lbmdpbmVzKytdID0gZWJfcmluZyhlKTsKIAkJ
CWlmIChudW1fZW5naW5lcyA9PSBBUlJBWV9TSVpFKGVuZ2luZXMpKQogCQkJCWJyZWFrOwogCQl9
CkBAIC00OTksMTIgKzQ5OSwxMiBAQCBzdG9yZV9yaW5nKGludCBmZCwgdW5zaWduZWQgcmluZywg
aW50IG51bV9jaGlsZHJlbiwgaW50IHRpbWVvdXQpCiAJaW50IG51bV9lbmdpbmVzID0gMDsKIAog
CWlmIChyaW5nID09IEFMTF9FTkdJTkVTKSB7Ci0JCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShm
ZCwgcmluZykgewotCQkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCByaW5nKSkKKwkJZm9y
X2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7CisJCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdv
cmQoZmQsIGViX3JpbmcoZSkpKQogCQkJCWNvbnRpbnVlOwogCi0JCQluYW1lc1tudW1fZW5naW5l
c10gPSBlX18tPm5hbWU7Ci0JCQllbmdpbmVzW251bV9lbmdpbmVzKytdID0gcmluZzsKKwkJCW5h
bWVzW251bV9lbmdpbmVzXSA9IGUtPm5hbWU7CisJCQllbmdpbmVzW251bV9lbmdpbmVzKytdID0g
ZWJfcmluZyhlKTsKIAkJCWlmIChudW1fZW5naW5lcyA9PSBBUlJBWV9TSVpFKGVuZ2luZXMpKQog
CQkJCWJyZWFrOwogCQl9CkBAIC02MTYsMTIgKzYxNiwxMiBAQCBzd2l0Y2hfcmluZyhpbnQgZmQs
IHVuc2lnbmVkIHJpbmcsIGludCBudW1fY2hpbGRyZW4sIGludCB0aW1lb3V0KQogCWdlbV9yZXF1
aXJlX2NvbnRleHRzKGZkKTsKIAogCWlmIChyaW5nID09IEFMTF9FTkdJTkVTKSB7Ci0JCWZvcl9l
YWNoX3BoeXNpY2FsX2VuZ2luZShmZCwgcmluZykgewotCQkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3
b3JkKGZkLCByaW5nKSkKKwkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7CisJCQlp
ZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGViX3JpbmcoZSkpKQogCQkJCWNvbnRpbnVlOwog
Ci0JCQluYW1lc1tudW1fZW5naW5lc10gPSBlX18tPm5hbWU7Ci0JCQllbmdpbmVzW251bV9lbmdp
bmVzKytdID0gcmluZzsKKwkJCW5hbWVzW251bV9lbmdpbmVzXSA9IGUtPm5hbWU7CisJCQllbmdp
bmVzW251bV9lbmdpbmVzKytdID0gZWJfcmluZyhlKTsKIAkJCWlmIChudW1fZW5naW5lcyA9PSBB
UlJBWV9TSVpFKGVuZ2luZXMpKQogCQkJCWJyZWFrOwogCQl9CkBAIC05NDMsMTcgKzk0MywxNyBA
QCBzdG9yZV9tYW55KGludCBmZCwgdW5zaWduZWQgcmluZywgaW50IHRpbWVvdXQpCiAJaW50ZWxf
ZGV0ZWN0X2FuZF9jbGVhcl9taXNzZWRfaW50ZXJydXB0cyhmZCk7CiAKIAlpZiAocmluZyA9PSBB
TExfRU5HSU5FUykgewotCQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIHJpbmcpIHsKLQkJ
CWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgcmluZykpCisJCWZvcl9lYWNoX3BoeXNpY2Fs
X2VuZ2luZShlLCBmZCkgeworCQkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5n
KGUpKSkKIAkJCQljb250aW51ZTsKIAogCQkJaWd0X2ZvcmsoY2hpbGQsIDEpCiAJCQkJX19zdG9y
ZV9tYW55KGZkLAotCQkJCQkgICAgIHJpbmcsCisJCQkJCSAgICAgZWJfcmluZyhlKSwKIAkJCQkJ
ICAgICB0aW1lb3V0LAogCQkJCQkgICAgICZzaGFyZWRbbl0pOwogCi0JCQluYW1lc1tuKytdID0g
ZV9fLT5uYW1lOworCQkJbmFtZXNbbisrXSA9IGUtPm5hbWU7CiAJCX0KIAkJaWd0X3dhaXRjaGls
ZHJlbigpOwogCX0gZWxzZSB7CkBAIC05NzQsMTEgKzk3NCwxMSBAQCBzdG9yZV9tYW55KGludCBm
ZCwgdW5zaWduZWQgcmluZywgaW50IHRpbWVvdXQpCiBzdGF0aWMgdm9pZAogc3luY19hbGwoaW50
IGZkLCBpbnQgbnVtX2NoaWxkcmVuLCBpbnQgdGltZW91dCkKIHsKLQl1bnNpZ25lZCBlbmdpbmVz
WzE2XSwgZW5naW5lOworCXVuc2lnbmVkIGVuZ2luZXNbMTZdOwogCWludCBudW1fZW5naW5lcyA9
IDA7CiAKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIGVuZ2luZSkgewotCQllbmdpbmVz
W251bV9lbmdpbmVzKytdID0gZW5naW5lOworCWZvcl9lYWNoX3BoeXNpY2FsX2VuZ2luZShlLCBm
ZCkgeworCQllbmdpbmVzW251bV9lbmdpbmVzKytdID0gZWJfcmluZyhlKTsKIAkJaWYgKG51bV9l
bmdpbmVzID09IEFSUkFZX1NJWkUoZW5naW5lcykpCiAJCQlicmVhazsKIAl9CkBAIC0xMDI4LDEz
ICsxMDI4LDEyIEBAIHN0b3JlX2FsbChpbnQgZmQsIGludCBudW1fY2hpbGRyZW4sIGludCB0aW1l
b3V0KQogCWNvbnN0IGludCBnZW4gPSBpbnRlbF9nZW4oaW50ZWxfZ2V0X2RybV9kZXZpZChmZCkp
OwogCXVuc2lnbmVkIGVuZ2luZXNbMTZdOwogCWludCBudW1fZW5naW5lcyA9IDA7Ci0JdW5zaWdu
ZWQgaW50IHJpbmc7CiAKLQlmb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoZmQsIHJpbmcpIHsKLQkJ
aWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCByaW5nKSkKKwlmb3JfZWFjaF9waHlzaWNhbF9l
bmdpbmUoZSwgZmQpIHsKKwkJaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5nKGUp
KSkKIAkJCWNvbnRpbnVlOwogCi0JCWVuZ2luZXNbbnVtX2VuZ2luZXMrK10gPSByaW5nOworCQll
bmdpbmVzW251bV9lbmdpbmVzKytdID0gZWJfcmluZyhlKTsKIAkJaWYgKG51bV9lbmdpbmVzID09
IEFSUkFZX1NJWkUoZW5naW5lcykpCiAJCQlicmVhazsKIAl9CkBAIC0xMTM5LDkgKzExMzgsOSBA
QCBwcmVlbXB0KGludCBmZCwgdW5zaWduZWQgcmluZywgaW50IG51bV9jaGlsZHJlbiwgaW50IHRp
bWVvdXQpCiAJdWludDMyX3QgY3R4WzJdOwogCiAJaWYgKHJpbmcgPT0gQUxMX0VOR0lORVMpIHsK
LQkJZm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGZkLCByaW5nKSB7Ci0JCQluYW1lc1tudW1fZW5n
aW5lc10gPSBlX18tPm5hbWU7Ci0JCQllbmdpbmVzW251bV9lbmdpbmVzKytdID0gcmluZzsKKwkJ
Zm9yX2VhY2hfcGh5c2ljYWxfZW5naW5lKGUsIGZkKSB7CisJCQluYW1lc1tudW1fZW5naW5lc10g
PSBlLT5uYW1lOworCQkJZW5naW5lc1tudW1fZW5naW5lcysrXSA9IGViX3JpbmcoZSk7CiAJCQlp
ZiAobnVtX2VuZ2luZXMgPT0gQVJSQVlfU0laRShlbmdpbmVzKSkKIAkJCQlicmVhazsKIAkJfQpA
QCAtMTIyNywyOSArMTIyNiwyOSBAQCBpZ3RfbWFpbgogCiAJZm9yIChlID0gaW50ZWxfZXhlY3V0
aW9uX2VuZ2luZXM7IGUtPm5hbWU7IGUrKykgewogCQlpZ3Rfc3VidGVzdF9mKCIlcyIsIGUtPm5h
bWUpCi0JCQlzeW5jX3JpbmcoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgMSwgMTUwKTsKKwkJ
CXN5bmNfcmluZyhmZCwgZWJfcmluZyhlKSwgMSwgMTUwKTsKIAkJaWd0X3N1YnRlc3RfZigiaWRs
ZS0lcyIsIGUtPm5hbWUpCi0JCQlpZGxlX3JpbmcoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywg
MTUwKTsKKwkJCWlkbGVfcmluZyhmZCwgZWJfcmluZyhlKSwgMTUwKTsKIAkJaWd0X3N1YnRlc3Rf
ZigiYWN0aXZlLSVzIiwgZS0+bmFtZSkKLQkJCWFjdGl2ZV9yaW5nKGZkLCBlLT5leGVjX2lkIHwg
ZS0+ZmxhZ3MsIDE1MCk7CisJCQlhY3RpdmVfcmluZyhmZCwgZWJfcmluZyhlKSwgMTUwKTsKIAkJ
aWd0X3N1YnRlc3RfZigid2FrZXVwLSVzIiwgZS0+bmFtZSkKLQkJCXdha2V1cF9yaW5nKGZkLCBl
LT5leGVjX2lkIHwgZS0+ZmxhZ3MsIDE1MCwgMSk7CisJCQl3YWtldXBfcmluZyhmZCwgZWJfcmlu
ZyhlKSwgMTUwLCAxKTsKIAkJaWd0X3N1YnRlc3RfZigiYWN0aXZlLXdha2V1cC0lcyIsIGUtPm5h
bWUpCi0JCQlhY3RpdmVfd2FrZXVwX3JpbmcoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgMTUw
LCAxKTsKKwkJCWFjdGl2ZV93YWtldXBfcmluZyhmZCwgZWJfcmluZyhlKSwgMTUwLCAxKTsKIAkJ
aWd0X3N1YnRlc3RfZigiZG91YmxlLXdha2V1cC0lcyIsIGUtPm5hbWUpCi0JCQl3YWtldXBfcmlu
ZyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCAxNTAsIDIpOworCQkJd2FrZXVwX3JpbmcoZmQs
IGViX3JpbmcoZSksIDE1MCwgMik7CiAJCWlndF9zdWJ0ZXN0X2YoInN0b3JlLSVzIiwgZS0+bmFt
ZSkKLQkJCXN0b3JlX3JpbmcoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgMSwgMTUwKTsKKwkJ
CXN0b3JlX3JpbmcoZmQsIGViX3JpbmcoZSksIDEsIDE1MCk7CiAJCWlndF9zdWJ0ZXN0X2YoInN3
aXRjaC0lcyIsIGUtPm5hbWUpCi0JCQlzd2l0Y2hfcmluZyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZs
YWdzLCAxLCAxNTApOworCQkJc3dpdGNoX3JpbmcoZmQsIGViX3JpbmcoZSksIDEsIDE1MCk7CiAJ
CWlndF9zdWJ0ZXN0X2YoImZvcmtlZC1zd2l0Y2gtJXMiLCBlLT5uYW1lKQotCQkJc3dpdGNoX3Jp
bmcoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgbmNwdXMsIDE1MCk7CisJCQlzd2l0Y2hfcmlu
ZyhmZCwgZWJfcmluZyhlKSwgbmNwdXMsIDE1MCk7CiAJCWlndF9zdWJ0ZXN0X2YoIm1hbnktJXMi
LCBlLT5uYW1lKQotCQkJc3RvcmVfbWFueShmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCAxNTAp
OworCQkJc3RvcmVfbWFueShmZCwgZWJfcmluZyhlKSwgMTUwKTsKIAkJaWd0X3N1YnRlc3RfZigi
Zm9ya2VkLSVzIiwgZS0+bmFtZSkKLQkJCXN5bmNfcmluZyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZs
YWdzLCBuY3B1cywgMTUwKTsKKwkJCXN5bmNfcmluZyhmZCwgZWJfcmluZyhlKSwgbmNwdXMsIDE1
MCk7CiAJCWlndF9zdWJ0ZXN0X2YoImZvcmtlZC1zdG9yZS0lcyIsIGUtPm5hbWUpCi0JCQlzdG9y
ZV9yaW5nKGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIG5jcHVzLCAxNTApOworCQkJc3RvcmVf
cmluZyhmZCwgZWJfcmluZyhlKSwgbmNwdXMsIDE1MCk7CiAJfQogCiAJaWd0X3N1YnRlc3QoImJh
c2ljLWVhY2giKQpAQCAtMTMwMSw3ICsxMzAwLDcgQEAgaWd0X21haW4KIAogCQlmb3IgKGUgPSBp
bnRlbF9leGVjdXRpb25fZW5naW5lczsgZS0+bmFtZTsgZSsrKSB7CiAJCQlpZ3Rfc3VidGVzdF9m
KCJwcmVlbXB0LSVzIiwgZS0+bmFtZSkKLQkJCQlwcmVlbXB0KGZkLCBlLT5leGVjX2lkIHwgZS0+
ZmxhZ3MsIG5jcHVzLCAxNTApOworCQkJCXByZWVtcHQoZmQsIGViX3JpbmcoZSksIG5jcHVzLCAx
NTApOwogCQl9CiAJfQogCmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV91c2VycHRyX2JsaXRz
LmMgYi90ZXN0cy9pOTE1L2dlbV91c2VycHRyX2JsaXRzLmMKaW5kZXggMThlODA2ZmVkLi4xMWQ2
ZjRhMWMgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2k5MTUvZ2VtX3VzZXJwdHJfYmxpdHMuYworKysgYi90
ZXN0cy9pOTE1L2dlbV91c2VycHRyX2JsaXRzLmMKQEAgLTExNjUsMTggKzExNjUsMTcgQEAgc3Rh
dGljIHZvaWQgdGVzdF9yZWFkb25seShpbnQgaTkxNSkKIAlpZ3RfYXNzZXJ0KG1wcm90ZWN0KHNw
YWNlLCB0b3RhbCwgUFJPVF9SRUFEKSA9PSAwKTsKIAogCWlndF9mb3JrKGNoaWxkLCAxKSB7Ci0J
CXVuc2lnbmVkIGludCBlbmdpbmU7CiAJCWNoYXIgKm9yaWc7CiAKIAkJb3JpZyA9IGdfY29tcHV0
ZV9jaGVja3N1bV9mb3JfZGF0YShHX0NIRUNLU1VNX1NIQTEsIHBhZ2VzLCBzeik7CiAKIAkJZ2Vt
X3VzZXJwdHIoaTkxNSwgc3BhY2UsIHRvdGFsLCB0cnVlLCB1c2VycHRyX2ZsYWdzLCAmcmhhbmRs
ZSk7CiAKLQkJZm9yX2VhY2hfZW5naW5lKGk5MTUsIGVuZ2luZSkgeworCQlmb3JfZWFjaF9lbmdp
bmUoZSwgaTkxNSkgewogCQkJY2hhciAqcmVmLCAqcmVzdWx0OwogCiAJCQkvKiBGaXJzdCB0d2Vh
ayB0aGUgYmFja2luZyBzdG9yZSB0aHJvdWdoIHRoZSB3cml0ZSAqLwotCQkJc3RvcmVfZHdvcmRf
cmFuZChpOTE1LCBlbmdpbmUsIHdoYW5kbGUsIHN6LCAxMDI0KTsKKwkJCXN0b3JlX2R3b3JkX3Jh
bmQoaTkxNSwgZWJfcmluZyhlKSwgd2hhbmRsZSwgc3osIDEwMjQpOwogCQkJZ2VtX3N5bmMoaTkx
NSwgd2hhbmRsZSk7CiAJCQlyZWYgPSBnX2NvbXB1dGVfY2hlY2tzdW1fZm9yX2RhdGEoR19DSEVD
S1NVTV9TSEExLAogCQkJCQkJCSAgcGFnZXMsIHN6KTsKQEAgLTExODUsNyArMTE4NCw3IEBAIHN0
YXRpYyB2b2lkIHRlc3RfcmVhZG9ubHkoaW50IGk5MTUpCiAJCQlpZ3RfYXNzZXJ0KHN0cmNtcChy
ZWYsIG9yaWcpKTsKIAogCQkJLyogTm93IHRyeSB0aGUgc2FtZSB0aHJvdWdoIHRoZSByZWFkLW9u
bHkgaGFuZGxlICovCi0JCQlzdG9yZV9kd29yZF9yYW5kKGk5MTUsIGVuZ2luZSwgcmhhbmRsZSwg
dG90YWwsIDEwMjQpOworCQkJc3RvcmVfZHdvcmRfcmFuZChpOTE1LCBlYl9yaW5nKGUpLCByaGFu
ZGxlLCB0b3RhbCwgMTAyNCk7CiAJCQlnZW1fc3luYyhpOTE1LCByaGFuZGxlKTsKIAkJCXJlc3Vs
dCA9IGdfY29tcHV0ZV9jaGVja3N1bV9mb3JfZGF0YShHX0NIRUNLU1VNX1NIQTEsCiAJCQkJCQkJ
ICAgICBwYWdlcywgc3opOwpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9pOTE1X21vZHVsZV9sb2Fk
LmMgYi90ZXN0cy9pOTE1L2k5MTVfbW9kdWxlX2xvYWQuYwppbmRleCA3ZmU4MzUyMDcuLmY0MjA4
M2Y1MyAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9pOTE1X21vZHVsZV9sb2FkLmMKKysrIGIvdGVz
dHMvaTkxNS9pOTE1X21vZHVsZV9sb2FkLmMKQEAgLTUxLDEwICs1MSwxMCBAQCBzdGF0aWMgdm9p
ZCBzdG9yZV9kd29yZChpbnQgZmQsIHVuc2lnbmVkIHJpbmcpCiAJdWludDMyX3QgYmF0Y2hbMTZd
OwogCWludCBpOwogCi0JaWYgKCFnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCByaW5nKSkKKwlpZiAo
IWdlbV9oYXNfcmluZyhmZCwgcmluZykpCiAJCXJldHVybjsKIAotCWlmICghZ2VtX2hhc19yaW5n
KGZkLCByaW5nKSkKKwlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIHJpbmcpKQogCQlyZXR1
cm47CiAKIAlpbnRlbF9kZXRlY3RfYW5kX2NsZWFyX21pc3NlZF9pbnRlcnJ1cHRzKGZkKTsKQEAg
LTExMyw3ICsxMTMsNyBAQCBzdGF0aWMgdm9pZCBzdG9yZV9hbGwoaW50IGZkKQogCXVuc2lnbmVk
IGVuZ2luZXNbMTZdLCBwZXJtdXRlZFsxNl07CiAJdWludDMyX3QgYmF0Y2hbMTZdOwogCXVpbnQ2
NF90IG9mZnNldDsKLQl1bnNpZ25lZCBlbmdpbmUsIG5lbmdpbmU7CisJdW5zaWduZWQgbmVuZ2lu
ZTsKIAlpbnQgdmFsdWU7CiAJaW50IGksIGo7CiAKQEAgLTE1MSwxNCArMTUxLDE0IEBAIHN0YXRp
YyB2b2lkIHN0b3JlX2FsbChpbnQgZmQpCiAKIAluZW5naW5lID0gMDsKIAlpbnRlbF9kZXRlY3Rf
YW5kX2NsZWFyX21pc3NlZF9pbnRlcnJ1cHRzKGZkKTsKLQlmb3JfZWFjaF9lbmdpbmUoZmQsIGVu
Z2luZSkgewotCQlpZiAoIWdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGVuZ2luZSkpCisJZm9yX2Vh
Y2hfZW5naW5lKGUsIGZkKSB7CisJCWlmICghZ2VtX2Nhbl9zdG9yZV9kd29yZChmZCwgZWJfcmlu
ZyhlKSkpCiAJCQljb250aW51ZTsKIAotCQlpZ3RfYXNzZXJ0KDIqKG5lbmdpbmUrMSkqc2l6ZW9m
KGJhdGNoKSA8PSA0MDk2KTsKKwkJaWd0X2Fzc2VydCgyICogKG5lbmdpbmUgKyAxKSAqIHNpemVv
ZihiYXRjaCkgPD0gNDA5Nik7CiAKIAkJZXhlY2J1Zi5mbGFncyAmPSB+RU5HSU5FX01BU0s7Ci0J
CWV4ZWNidWYuZmxhZ3MgfD0gZW5naW5lOworCQlleGVjYnVmLmZsYWdzIHw9IGViX3JpbmcoZSk7
CiAKIAkJaiA9IDIqbmVuZ2luZTsKIAkJcmVsb2Nbal0udGFyZ2V0X2hhbmRsZSA9IG9ialswXS5o
YW5kbGU7CkBAIC0xOTAsNyArMTkwLDcgQEAgc3RhdGljIHZvaWQgc3RvcmVfYWxsKGludCBmZCkK
IAkJZXhlY2J1Zi5iYXRjaF9zdGFydF9vZmZzZXQgPSBqKnNpemVvZihiYXRjaCk7CiAJCWdlbV9l
eGVjYnVmKGZkLCAmZXhlY2J1Zik7CiAKLQkJZW5naW5lc1tuZW5naW5lKytdID0gZW5naW5lOwor
CQllbmdpbmVzW25lbmdpbmUrK10gPSBlYl9yaW5nKGUpOwogCX0KIAlnZW1fc3luYyhmZCwgb2Jq
WzFdLmhhbmRsZSk7CiAKQEAgLTI4NiwxMCArMjg2LDggQEAgZ2VtX2V4ZWNfc3RvcmUodm9pZCkK
IAlmZCA9IF9fZHJtX29wZW5fZHJpdmVyKERSSVZFUl9JTlRFTCk7CiAJaWd0X2ZvcmtfaGFuZ19k
ZXRlY3RvcihmZCk7CiAKLQlmb3IgKGUgPSBpbnRlbF9leGVjdXRpb25fZW5naW5lczsgZS0+bmFt
ZTsgZSsrKSB7Ci0JCWlmIChnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlLT5leGVjX2lkIHwgZS0+
ZmxhZ3MpKQotCQkJc3RvcmVfZHdvcmQoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7Ci0JfQor
CWZvciAoZSA9IGludGVsX2V4ZWN1dGlvbl9lbmdpbmVzOyBlLT5uYW1lOyBlKyspCisJCXN0b3Jl
X2R3b3JkKGZkLCBlYl9yaW5nKGUpKTsKIAogCXN0b3JlX2FsbChmZCk7CiAKZGlmZiAtLWdpdCBh
L3Rlc3RzL2ttc19idXN5LmMgYi90ZXN0cy9rbXNfYnVzeS5jCmluZGV4IDVmZjJiODQ2MC4uZmFh
ZDczMDkyIDEwMDY0NAotLS0gYS90ZXN0cy9rbXNfYnVzeS5jCisrKyBiL3Rlc3RzL2ttc19idXN5
LmMKQEAgLTMxNSwzMiArMzE1LDI4IEBAIGlndF9tYWluCiAKIAkJaWd0X3N1YnRlc3RfZigiYmFz
aWMtZmxpcC0lcyIsCiAJCQlrbXN0ZXN0X3BpcGVfbmFtZShuKSkgewotCQkJaWd0X3JlcXVpcmUo
Z2VtX2hhc19yaW5nKGRpc3BsYXkuZHJtX2ZkLAotCQkJCQkJZS0+ZXhlY19pZCB8IGUtPmZsYWdz
KSk7CisJCQlpZ3RfcmVxdWlyZShnZW1faGFzX3JpbmcoZGlzcGxheS5kcm1fZmQsIGViX3Jpbmco
ZSkpKTsKIAotCQkJdGVzdF9mbGlwKCZkaXNwbGF5LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIG4s
IGZhbHNlKTsKKwkJCXRlc3RfZmxpcCgmZGlzcGxheSwgZWJfcmluZyhlKSwgbiwgZmFsc2UpOwog
CQl9CiAJCWlndF9zdWJ0ZXN0X2YoImJhc2ljLW1vZGVzZXQtJXMiLAogCQkJa21zdGVzdF9waXBl
X25hbWUobikpIHsKLQkJCWlndF9yZXF1aXJlKGdlbV9oYXNfcmluZyhkaXNwbGF5LmRybV9mZCwK
LQkJCQkJCWUtPmV4ZWNfaWQgfCBlLT5mbGFncykpOworCQkJaWd0X3JlcXVpcmUoZ2VtX2hhc19y
aW5nKGRpc3BsYXkuZHJtX2ZkLCBlYl9yaW5nKGUpKSk7CiAKLQkJCXRlc3RfZmxpcCgmZGlzcGxh
eSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzLCBuLCB0cnVlKTsKKwkJCXRlc3RfZmxpcCgmZGlzcGxh
eSwgZWJfcmluZyhlKSwgbiwgdHJ1ZSk7CiAJCX0KIAogCQlpZ3RfZml4dHVyZSB7Ci0JCQlpZ3Rf
cmVxdWlyZShnZW1faGFzX3JpbmcoZGlzcGxheS5kcm1fZmQsCi0JCQkJCQllLT5leGVjX2lkIHwg
ZS0+ZmxhZ3MpKTsKKwkJCWlndF9yZXF1aXJlKGdlbV9oYXNfcmluZyhkaXNwbGF5LmRybV9mZCwg
ZWJfcmluZyhlKSkpOwogCiAJCQloYW5nID0gaWd0X2FsbG93X2hhbmcoZGlzcGxheS5kcm1fZmQs
IDAsIDApOwogCQl9CiAKIAkJaWd0X3N1YnRlc3RfZigiZXh0ZW5kZWQtcGFnZWZsaXAtbW9kZXNl
dC1oYW5nLW9sZGZiLSVzLSVzIiwKIAkJCQllLT5uYW1lLCBrbXN0ZXN0X3BpcGVfbmFtZShuKSkg
ewotCQkJaWd0X3JlcXVpcmUoZ2VtX2hhc19yaW5nKGRpc3BsYXkuZHJtX2ZkLAotCQkJCQkJZS0+
ZXhlY19pZCB8IGUtPmZsYWdzKSk7CisJCQlpZ3RfcmVxdWlyZShnZW1faGFzX3JpbmcoZGlzcGxh
eS5kcm1fZmQsIGViX3JpbmcoZSkpKTsKIAotCQkJdGVzdF9wYWdlZmxpcF9tb2Rlc2V0X2hhbmco
JmRpc3BsYXksIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgbik7CisJCQl0ZXN0X3BhZ2VmbGlwX21v
ZGVzZXRfaGFuZygmZGlzcGxheSwgZWJfcmluZyhlKSwgbik7CiAJCX0KIAogCQlpZ3RfZml4dHVy
ZQpAQCAtMzQ4LDI1ICszNDQsMjUgQEAgaWd0X21haW4KIAogCQlpZ3Rfc3VidGVzdF9mKCJleHRl
bmRlZC1wYWdlZmxpcC1oYW5nLW9sZGZiLSVzLSVzIiwKIAkJCQllLT5uYW1lLCBrbXN0ZXN0X3Bp
cGVfbmFtZShuKSkKLQkJCXRlc3RfaGFuZygmZGlzcGxheSwgZS0+ZXhlY19pZCB8IGUtPmZsYWdz
LCBuLCBmYWxzZSwgZmFsc2UpOworCQkJdGVzdF9oYW5nKCZkaXNwbGF5LCBlYl9yaW5nKGUpLCBu
LCBmYWxzZSwgZmFsc2UpOwogCiAJCWlndF9zdWJ0ZXN0X2YoImV4dGVuZGVkLXBhZ2VmbGlwLWhh
bmctbmV3ZmItJXMtJXMiLAogCQkJCWUtPm5hbWUsIGttc3Rlc3RfcGlwZV9uYW1lKG4pKQotCQkJ
dGVzdF9oYW5nKCZkaXNwbGF5LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIG4sIGZhbHNlLCB0cnVl
KTsKKwkJCXRlc3RfaGFuZygmZGlzcGxheSwgZWJfcmluZyhlKSwgbiwgZmFsc2UsIHRydWUpOwog
CiAJCWlndF9zdWJ0ZXN0X2YoImV4dGVuZGVkLW1vZGVzZXQtaGFuZy1vbGRmYi0lcy0lcyIsCiAJ
CQkJZS0+bmFtZSwga21zdGVzdF9waXBlX25hbWUobikpCi0JCQl0ZXN0X2hhbmcoJmRpc3BsYXks
IGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgbiwgdHJ1ZSwgZmFsc2UpOworCQkJdGVzdF9oYW5nKCZk
aXNwbGF5LCBlYl9yaW5nKGUpLCBuLCB0cnVlLCBmYWxzZSk7CiAKIAkJaWd0X3N1YnRlc3RfZigi
ZXh0ZW5kZWQtbW9kZXNldC1oYW5nLW5ld2ZiLSVzLSVzIiwKIAkJCQllLT5uYW1lLCBrbXN0ZXN0
X3BpcGVfbmFtZShuKSkKLQkJCXRlc3RfaGFuZygmZGlzcGxheSwgZS0+ZXhlY19pZCB8IGUtPmZs
YWdzLCBuLCB0cnVlLCB0cnVlKTsKKwkJCXRlc3RfaGFuZygmZGlzcGxheSwgZWJfcmluZyhlKSwg
biwgdHJ1ZSwgdHJ1ZSk7CiAKIAkJaWd0X3N1YnRlc3RfZigiZXh0ZW5kZWQtbW9kZXNldC1oYW5n
LW9sZGZiLXdpdGgtcmVzZXQtJXMtJXMiLAogCQkJCWUtPm5hbWUsIGttc3Rlc3RfcGlwZV9uYW1l
KG4pKSB7CiAJCQlpZ3Rfc2V0X21vZHVsZV9wYXJhbV9pbnQoImZvcmNlX3Jlc2V0X21vZGVzZXRf
dGVzdCIsIDEpOwogCi0JCQl0ZXN0X2hhbmcoJmRpc3BsYXksIGUtPmV4ZWNfaWQgfCBlLT5mbGFn
cywgbiwgdHJ1ZSwgZmFsc2UpOworCQkJdGVzdF9oYW5nKCZkaXNwbGF5LCBlYl9yaW5nKGUpLCBu
LCB0cnVlLCBmYWxzZSk7CiAKIAkJCWlndF9zZXRfbW9kdWxlX3BhcmFtX2ludCgiZm9yY2VfcmVz
ZXRfbW9kZXNldF90ZXN0IiwgMCk7CiAJCX0KQEAgLTM3NSw3ICszNzEsNyBAQCBpZ3RfbWFpbgog
CQkJCWUtPm5hbWUsIGttc3Rlc3RfcGlwZV9uYW1lKG4pKSB7CiAJCQlpZ3Rfc2V0X21vZHVsZV9w
YXJhbV9pbnQoImZvcmNlX3Jlc2V0X21vZGVzZXRfdGVzdCIsIDEpOwogCi0JCQl0ZXN0X2hhbmco
JmRpc3BsYXksIGUtPmV4ZWNfaWQgfCBlLT5mbGFncywgbiwgdHJ1ZSwgdHJ1ZSk7CisJCQl0ZXN0
X2hhbmcoJmRpc3BsYXksIGViX3JpbmcoZSksIG4sIHRydWUsIHRydWUpOwogCiAJCQlpZ3Rfc2V0
X21vZHVsZV9wYXJhbV9pbnQoImZvcmNlX3Jlc2V0X21vZGVzZXRfdGVzdCIsIDApOwogCQl9CmRp
ZmYgLS1naXQgYS90ZXN0cy9wcmltZV9idXN5LmMgYi90ZXN0cy9wcmltZV9idXN5LmMKaW5kZXgg
NGYyMzdmNjhmLi44ZWUyM2JiM2YgMTAwNjQ0Ci0tLSBhL3Rlc3RzL3ByaW1lX2J1c3kuYworKysg
Yi90ZXN0cy9wcmltZV9idXN5LmMKQEAgLTE5Miw4ICsxOTIsOCBAQCBzdGF0aWMgdm9pZCB0ZXN0
X2VuZ2luZV9tb2RlKGludCBmZCwKIAogCWlndF9zdWJ0ZXN0X2dyb3VwIHsKIAkJaWd0X2ZpeHR1
cmUgewotCQkJZ2VtX3JlcXVpcmVfcmluZyhmZCwgZS0+ZXhlY19pZCB8IGUtPmZsYWdzKTsKLQkJ
CWlndF9yZXF1aXJlKGdlbV9jYW5fc3RvcmVfZHdvcmQoZmQsIGUtPmV4ZWNfaWQgfCBlLT5mbGFn
cykpOworCQkJZ2VtX3JlcXVpcmVfcmluZyhmZCwgZWJfcmluZyhlKSk7CisJCQlpZ3RfcmVxdWly
ZShnZW1fY2FuX3N0b3JlX2R3b3JkKGZkLCBlYl9yaW5nKGUpKSk7CiAKIAkJCWlmICgoZmxhZ3Mg
JiBIQU5HKSA9PSAwKQogCQkJewpAQCAtMjA5LDEyICsyMDksMTIgQEAgc3RhdGljIHZvaWQgdGVz
dF9lbmdpbmVfbW9kZShpbnQgZmQsCiAJCWlndF9zdWJ0ZXN0X2YoIiVzJXMtJXMiLAogCQkJICAg
ICAgIWUtPmV4ZWNfaWQgJiYgIShmbGFncyAmIEhBTkcpID8gImJhc2ljLSIgOiAiIiwKIAkJCSAg
ICAgIG5hbWUsIGUtPm5hbWUpCi0JCQlidXN5KGZkLCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MsIGZs
YWdzKTsKKwkJCWJ1c3koZmQsIGViX3JpbmcoZSksIGZsYWdzKTsKIAogCQlpZ3Rfc3VidGVzdF9m
KCIlc3dhaXQtJXMtJXMiLAogCQkJICAgICAgIWUtPmV4ZWNfaWQgJiYgIShmbGFncyAmIEhBTkcp
ID8gImJhc2ljLSIgOiAiIiwKIAkJCSAgICAgIG5hbWUsIGUtPm5hbWUpCi0JCQlidXN5KGZkLCBl
LT5leGVjX2lkIHwgZS0+ZmxhZ3MsIGZsYWdzIHwgUE9MTCk7CisJCQlidXN5KGZkLCBlYl9yaW5n
KGUpLCBmbGFncyB8IFBPTEwpOwogCiAJCWlndF9maXh0dXJlIHsKIAkJCWlmICgoZmxhZ3MgJiBI
QU5HKSA9PSAwKQpkaWZmIC0tZ2l0IGEvdGVzdHMvcHJpbWVfdmdlbS5jIGIvdGVzdHMvcHJpbWVf
dmdlbS5jCmluZGV4IGJlYmY5ZWRjNi4uMmIyMWZmNDE0IDEwMDY0NAotLS0gYS90ZXN0cy9wcmlt
ZV92Z2VtLmMKKysrIGIvdGVzdHMvcHJpbWVfdmdlbS5jCkBAIC04NDgsOCArODQ4LDggQEAgaWd0
X21haW4KIAkJaWd0X3N1YnRlc3RfZigiJXNzeW5jLSVzIiwKIAkJCSAgICAgIGUtPmV4ZWNfaWQg
PT0gMCA/ICJiYXNpYy0iIDogIiIsCiAJCQkgICAgICBlLT5uYW1lKSB7Ci0JCQlnZW1fcmVxdWly
ZV9yaW5nKGk5MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7Ci0JCQlpZ3RfcmVxdWlyZShnZW1f
Y2FuX3N0b3JlX2R3b3JkKGk5MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncykpOworCQkJZ2VtX3Jl
cXVpcmVfcmluZyhpOTE1LCBlYl9yaW5nKGUpKTsKKwkJCWlndF9yZXF1aXJlKGdlbV9jYW5fc3Rv
cmVfZHdvcmQoaTkxNSwgZWJfcmluZyhlKSkpOwogCiAJCQlnZW1fcXVpZXNjZW50X2dwdShpOTE1
KTsKIAkJCXRlc3Rfc3luYyhpOTE1LCB2Z2VtLCBlLT5leGVjX2lkLCBlLT5mbGFncyk7CkBAIC04
NjAsOCArODYwLDggQEAgaWd0X21haW4KIAkJaWd0X3N1YnRlc3RfZigiJXNidXN5LSVzIiwKIAkJ
CSAgICAgIGUtPmV4ZWNfaWQgPT0gMCA/ICJiYXNpYy0iIDogIiIsCiAJCQkgICAgICBlLT5uYW1l
KSB7Ci0JCQlnZW1fcmVxdWlyZV9yaW5nKGk5MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7Ci0J
CQlpZ3RfcmVxdWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGk5MTUsIGUtPmV4ZWNfaWQgfCBlLT5m
bGFncykpOworCQkJZ2VtX3JlcXVpcmVfcmluZyhpOTE1LCBlYl9yaW5nKGUpKTsKKwkJCWlndF9y
ZXF1aXJlKGdlbV9jYW5fc3RvcmVfZHdvcmQoaTkxNSwgZWJfcmluZyhlKSkpOwogCiAJCQlnZW1f
cXVpZXNjZW50X2dwdShpOTE1KTsKIAkJCXRlc3RfYnVzeShpOTE1LCB2Z2VtLCBlLT5leGVjX2lk
LCBlLT5mbGFncyk7CkBAIC04NzIsOCArODcyLDggQEAgaWd0X21haW4KIAkJaWd0X3N1YnRlc3Rf
ZigiJXN3YWl0LSVzIiwKIAkJCSAgICAgIGUtPmV4ZWNfaWQgPT0gMCA/ICJiYXNpYy0iIDogIiIs
CiAJCQkgICAgICBlLT5uYW1lKSB7Ci0JCQlnZW1fcmVxdWlyZV9yaW5nKGk5MTUsIGUtPmV4ZWNf
aWQgfCBlLT5mbGFncyk7Ci0JCQlpZ3RfcmVxdWlyZShnZW1fY2FuX3N0b3JlX2R3b3JkKGk5MTUs
IGUtPmV4ZWNfaWQgfCBlLT5mbGFncykpOworCQkJZ2VtX3JlcXVpcmVfcmluZyhpOTE1LCBlYl9y
aW5nKGUpKTsKKwkJCWlndF9yZXF1aXJlKGdlbV9jYW5fc3RvcmVfZHdvcmQoaTkxNSwgZWJfcmlu
ZyhlKSkpOwogCiAJCQlnZW1fcXVpZXNjZW50X2dwdShpOTE1KTsKIAkJCXRlc3Rfd2FpdChpOTE1
LCB2Z2VtLCBlLT5leGVjX2lkLCBlLT5mbGFncyk7CkBAIC04OTUsOCArODk1LDggQEAgaWd0X21h
aW4KIAkJCWlndF9zdWJ0ZXN0X2YoIiVzZmVuY2Utd2FpdC0lcyIsCiAJCQkJCWUtPmV4ZWNfaWQg
PT0gMCA/ICJiYXNpYy0iIDogIiIsCiAJCQkJCWUtPm5hbWUpIHsKLQkJCQlnZW1fcmVxdWlyZV9y
aW5nKGk5MTUsIGUtPmV4ZWNfaWQgfCBlLT5mbGFncyk7Ci0JCQkJaWd0X3JlcXVpcmUoZ2VtX2Nh
bl9zdG9yZV9kd29yZChpOTE1LCBlLT5leGVjX2lkIHwgZS0+ZmxhZ3MpKTsKKwkJCQlnZW1fcmVx
dWlyZV9yaW5nKGk5MTUsIGViX3JpbmcoZSkpOworCQkJCWlndF9yZXF1aXJlKGdlbV9jYW5fc3Rv
cmVfZHdvcmQoaTkxNSwgZWJfcmluZyhlKSkpOwogCiAJCQkJZ2VtX3F1aWVzY2VudF9ncHUoaTkx
NSk7CiAJCQkJdGVzdF9mZW5jZV93YWl0KGk5MTUsIHZnZW0sIGUtPmV4ZWNfaWQsIGUtPmZsYWdz
KTsKLS0gCjIuMjQuMC5yYzEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2lu
dGVsLWdmeA==

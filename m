Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 20EB474280
	for <lists+intel-gfx@lfdr.de>; Thu, 25 Jul 2019 02:18:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 48E716E386;
	Thu, 25 Jul 2019 00:18:53 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9A75B6E313
 for <intel-gfx@lists.freedesktop.org>; Thu, 25 Jul 2019 00:18:40 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by fmsmga106.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 24 Jul 2019 17:18:40 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,304,1559545200"; d="scan'208";a="177816916"
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by FMSMGA003.fm.intel.com with ESMTP; 24 Jul 2019 17:18:40 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 24 Jul 2019 17:18:09 -0700
Message-Id: <20190725001813.4740-5-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190725001813.4740-1-daniele.ceraolospurio@intel.com>
References: <20190725001813.4740-1-daniele.ceraolospurio@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v3 4/8] drm/i915/uc: Unify uc_fw status tracking
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2UgY3VycmVudGx5IHRyYWNrIGZldGNoIGFuZCBsb2FkIHN0YXR1cyBzZXBhcmF0ZWx5LCBidXQg
dGhlIDIgYXJlCmFjdHVhbGx5IHNlcXVlbnRpYWwgaW4gdGhlIHVjIGxpZmV0aW1lIChmZXRjaCBt
dXN0IGNvbXBsZXRlIGJlZm9yZSB3ZQpjYW4gYXR0ZW1wdCB0aGUgbG9hZCEpLiBVbmlmeWluZyB0
aGUgMiB2YXJpYWJsZXMgd2UgY2FuIGJldHRlciBmb2xsb3cKdGhlIHNlcXVlbnRpYWwgc3RhdGVz
IGFuZCBpbXByb3ZlIG91ciB0cmFja25nIG9mIHRoZSB1QyBzdGF0ZS4KCkFsc28sIHNwcmlua2xl
IHNvbWUgR0VNX0JVR19PTiB0byBtYWtlIHN1cmUgd2UgdHJhbnNpdGlvbiBjb3JyZWN0bHkKYmV0
d2VlbiBzdGF0ZXMuCgp2MjogcmVuYW1lIHN0YXRlcywgYWRkIHRoZSBydW5uaW5nIHN0YXRlIChN
aWNoYWwpLCBkcm9wIHNvbWUgbG9ncyBpbgogICAgdGhlIGZldGNoIHBhdGggKE1pY2hhbCwgQ2hy
aXMpCgp2MzogcmUtcmVuYW1lIHN0YXRlcywgZXh0ZW5kIGVhcmx5IHN0YXR1cyBjaGVjayB0byBh
bGwgaGVscGVycyAoTWljaGFsKQoKU3VnZ2VzdGVkLWJ5OiBNaWNoYWwgV2FqZGVjemtvIDxtaWNo
YWwud2FqZGVjemtvQGludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogRGFuaWVsZSBDZXJhb2xvIFNw
dXJpbyA8ZGFuaWVsZS5jZXJhb2xvc3B1cmlvQGludGVsLmNvbT4KQ2M6IE1pY2hhbCBXYWpkZWN6
a28gPG1pY2hhbC53YWpkZWN6a29AaW50ZWwuY29tPgpDYzogQ2hyaXMgV2lsc29uIDxjaHJpc0Bj
aHJpcy13aWxzb24uY28udWs+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxf
Z3VjLmggICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1
Y19mdy5jICAgICB8ICA2ICstCiAuLi4vZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJt
aXNzaW9uLmMgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVjLmMg
ICAgICAgIHwgIDggKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2h1Yy5oICAg
ICAgICB8ICA1ICsrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5jICAgICAg
ICAgfCAxMCArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjX2Z3LmMgICAg
ICB8IDc4ICsrKysrKystLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2lu
dGVsX3VjX2Z3LmggICAgICB8IDYzICsrKysrKysrKystLS0tLQogOCBmaWxlcyBjaGFuZ2VkLCA5
MiBpbnNlcnRpb25zKCspLCA4NCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Vj
L2ludGVsX2d1Yy5oCmluZGV4IGFjNjMzM2FkNzEwMi4uNzE0ZTk4OTJhYWZmIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWMuaAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWMuaApAQCAtMTcyLDkgKzE3Miw5IEBAIGludCBpbnRl
bF9ndWNfc3VzcGVuZChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpOwogaW50IGludGVsX2d1Y19yZXN1
bWUoc3RydWN0IGludGVsX2d1YyAqZ3VjKTsKIHN0cnVjdCBpOTE1X3ZtYSAqaW50ZWxfZ3VjX2Fs
bG9jYXRlX3ZtYShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMsIHUzMiBzaXplKTsKIAotc3RhdGljIGlu
bGluZSBib29sIGludGVsX2d1Y19pc19sb2FkZWQoc3RydWN0IGludGVsX2d1YyAqZ3VjKQorc3Rh
dGljIGlubGluZSBib29sIGludGVsX2d1Y19pc19ydW5uaW5nKHN0cnVjdCBpbnRlbF9ndWMgKmd1
YykKIHsKLQlyZXR1cm4gaW50ZWxfdWNfZndfaXNfbG9hZGVkKCZndWMtPmZ3KTsKKwlyZXR1cm4g
aW50ZWxfdWNfZndfaXNfcnVubmluZygmZ3VjLT5mdyk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgaW50
IGludGVsX2d1Y19zYW5pdGl6ZShzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfZncuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3VjL2ludGVsX2d1Y19mdy5jCmluZGV4IDk5ZjQ0ZDhhZTAyNi4uZWVjNzY3Mzgz
ZTkyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfZncu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfZncuYwpAQCAtMjMw
LDUgKzIzMCw5IEBAIHN0YXRpYyBpbnQgZ3VjX2Z3X3hmZXIoc3RydWN0IGludGVsX3VjX2Z3ICpn
dWNfZncpCiAgKi8KIGludCBpbnRlbF9ndWNfZndfdXBsb2FkKHN0cnVjdCBpbnRlbF9ndWMgKmd1
YykKIHsKLQlyZXR1cm4gaW50ZWxfdWNfZndfdXBsb2FkKCZndWMtPmZ3LCBndWNfZndfeGZlcik7
CisJaW50IHJldCA9IGludGVsX3VjX2Z3X3VwbG9hZCgmZ3VjLT5mdywgZ3VjX2Z3X3hmZXIpOwor
CWlmICghcmV0KQorCQlndWMtPmZ3LnN0YXR1cyA9IElOVEVMX1VDX0ZJUk1XQVJFX1JVTk5JTkc7
CisKKwlyZXR1cm4gcmV0OwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
dWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2lu
dGVsX2d1Y19zdWJtaXNzaW9uLmMKaW5kZXggYTBmMmEwMTM2NWJjLi5iNDIzOGZlMTZhMDMgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9u
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24u
YwpAQCAtOTQxLDcgKzk0MSw3IEBAIHN0YXRpYyB2b2lkIF9fZ3VjX2NsaWVudF9kaXNhYmxlKHN0
cnVjdCBpbnRlbF9ndWNfY2xpZW50ICpjbGllbnQpCiAJICogdGhlIGNhc2UsIGluc3RlYWQgb2Yg
dHJ5aW5nIChpbiB2YWluKSB0byBjb21tdW5pY2F0ZSB3aXRoIGl0LCBsZXQncwogCSAqIGp1c3Qg
Y2xlYW51cCB0aGUgZG9vcmJlbGwgSFcgYW5kIG91ciBpbnRlcm5hbCBzdGF0ZS4KIAkgKi8KLQlp
ZiAoaW50ZWxfZ3VjX2lzX2xvYWRlZChjbGllbnQtPmd1YykpCisJaWYgKGludGVsX2d1Y19pc19y
dW5uaW5nKGNsaWVudC0+Z3VjKSkKIAkJZGVzdHJveV9kb29yYmVsbChjbGllbnQpOwogCWVsc2UK
IAkJX19maW5pX2Rvb3JiZWxsKGNsaWVudCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC91Yy9pbnRlbF9odWMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVs
X2h1Yy5jCmluZGV4IGFiNmMxNTY0YjZhNy4uYTQ1OTc2ZTU2YWY3IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9odWMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC91Yy9pbnRlbF9odWMuYwpAQCAtMTE3LDggKzExNyw4IEBAIGludCBpbnRlbF9odWNf
YXV0aChzdHJ1Y3QgaW50ZWxfaHVjICpodWMpCiAJc3RydWN0IGludGVsX2d1YyAqZ3VjID0gJmd0
LT51Yy5ndWM7CiAJaW50IHJldDsKIAotCWlmIChodWMtPmZ3LmxvYWRfc3RhdHVzICE9IElOVEVM
X1VDX0ZJUk1XQVJFX1NVQ0NFU1MpCi0JCXJldHVybiAtRU5PRVhFQzsKKwlHRU1fQlVHX09OKCFp
bnRlbF91Y19md19pc19sb2FkZWQoJmh1Yy0+ZncpKTsKKwlHRU1fQlVHX09OKGludGVsX2h1Y19p
c19hdXRoZW50aWNhdGVkKGh1YykpOwogCiAJcmV0ID0gaW50ZWxfZ3VjX2F1dGhfaHVjKGd1YywK
IAkJCQkgaW50ZWxfZ3VjX2dndHRfb2Zmc2V0KGd1YywgaHVjLT5yc2FfZGF0YSkpOwpAQCAtMTM4
LDEwICsxMzgsMTIgQEAgaW50IGludGVsX2h1Y19hdXRoKHN0cnVjdCBpbnRlbF9odWMgKmh1YykK
IAkJZ290byBmYWlsOwogCX0KIAorCWh1Yy0+Zncuc3RhdHVzID0gSU5URUxfVUNfRklSTVdBUkVf
UlVOTklORzsKKwogCXJldHVybiAwOwogCiBmYWlsOgotCWh1Yy0+ZncubG9hZF9zdGF0dXMgPSBJ
TlRFTF9VQ19GSVJNV0FSRV9GQUlMOworCWh1Yy0+Zncuc3RhdHVzID0gSU5URUxfVUNfRklSTVdB
UkVfRkFJTDsKIAogCURSTV9FUlJPUigiSHVDOiBBdXRoZW50aWNhdGlvbiBmYWlsZWQgJWRcbiIs
IHJldCk7CiAJcmV0dXJuIHJldDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3VjL2ludGVsX2h1Yy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfaHVjLmgK
aW5kZXggOWZhM2Q0NjI5ZjJlLi5lYTM0MGY4NWJjNDYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3VjL2ludGVsX2h1Yy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3VjL2ludGVsX2h1Yy5oCkBAIC01Niw0ICs1Niw5IEBAIHN0YXRpYyBpbmxpbmUgaW50IGludGVs
X2h1Y19zYW5pdGl6ZShzdHJ1Y3QgaW50ZWxfaHVjICpodWMpCiAJcmV0dXJuIDA7CiB9CiAKK3N0
YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9odWNfaXNfYXV0aGVudGljYXRlZChzdHJ1Y3QgaW50ZWxf
aHVjICpodWMpCit7CisJcmV0dXJuIGludGVsX3VjX2Z3X2lzX3J1bm5pbmcoJmh1Yy0+ZncpOwor
fQorCiAjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVs
X3VjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Yy5jCmluZGV4IDNmNjcy
ZWE3NDU2Yi4uYjE4MTVhYmVjZjMwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC91Yy9pbnRlbF91Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3Vj
LmMKQEAgLTU2MCw3ICs1NjAsNyBAQCB2b2lkIGludGVsX3VjX2ZpbmlfaHcoc3RydWN0IGludGVs
X3VjICp1YykKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3VjICpndWMgPSAmdWMtPmd1YzsKIAotCWlmICgh
aW50ZWxfZ3VjX2lzX2xvYWRlZChndWMpKQorCWlmICghaW50ZWxfZ3VjX2lzX3J1bm5pbmcoZ3Vj
KSkKIAkJcmV0dXJuOwogCiAJR0VNX0JVR19PTighaW50ZWxfdWNfZndfc3VwcG9ydGVkKCZndWMt
PmZ3KSk7CkBAIC01ODIsNyArNTgyLDcgQEAgdm9pZCBpbnRlbF91Y19yZXNldF9wcmVwYXJlKHN0
cnVjdCBpbnRlbF91YyAqdWMpCiB7CiAJc3RydWN0IGludGVsX2d1YyAqZ3VjID0gJnVjLT5ndWM7
CiAKLQlpZiAoIWludGVsX2d1Y19pc19sb2FkZWQoZ3VjKSkKKwlpZiAoIWludGVsX2d1Y19pc19y
dW5uaW5nKGd1YykpCiAJCXJldHVybjsKIAogCWd1Y19zdG9wX2NvbW11bmljYXRpb24oZ3VjKTsK
QEAgLTU5NCw3ICs1OTQsNyBAQCB2b2lkIGludGVsX3VjX3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3Qg
aW50ZWxfdWMgKnVjKQogCXN0cnVjdCBpbnRlbF9ndWMgKmd1YyA9ICZ1Yy0+Z3VjOwogCWludCBl
cnI7CiAKLQlpZiAoIWludGVsX2d1Y19pc19sb2FkZWQoZ3VjKSkKKwlpZiAoIWludGVsX2d1Y19p
c19ydW5uaW5nKGd1YykpCiAJCXJldHVybjsKIAogCWVyciA9IGludGVsX2d1Y19zdXNwZW5kKGd1
Yyk7CkBAIC02MDksNyArNjA5LDcgQEAgdm9pZCBpbnRlbF91Y19zdXNwZW5kKHN0cnVjdCBpbnRl
bF91YyAqdWMpCiAJc3RydWN0IGludGVsX2d1YyAqZ3VjID0gJnVjLT5ndWM7CiAJaW50ZWxfd2Fr
ZXJlZl90IHdha2VyZWY7CiAKLQlpZiAoIWludGVsX2d1Y19pc19sb2FkZWQoZ3VjKSkKKwlpZiAo
IWludGVsX2d1Y19pc19ydW5uaW5nKGd1YykpCiAJCXJldHVybjsKIAogCXdpdGhfaW50ZWxfcnVu
dGltZV9wbSgmdWNfdG9fZ3QodWMpLT5pOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKQpAQCAtNjIx
LDcgKzYyMSw3IEBAIGludCBpbnRlbF91Y19yZXN1bWUoc3RydWN0IGludGVsX3VjICp1YykKIAlz
dHJ1Y3QgaW50ZWxfZ3VjICpndWMgPSAmdWMtPmd1YzsKIAlpbnQgZXJyOwogCi0JaWYgKCFpbnRl
bF9ndWNfaXNfbG9hZGVkKGd1YykpCisJaWYgKCFpbnRlbF9ndWNfaXNfcnVubmluZyhndWMpKQog
CQlyZXR1cm4gMDsKIAogCWd1Y19lbmFibGVfY29tbXVuaWNhdGlvbihndWMpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWNfZncuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjX2Z3LmMKaW5kZXggOTIwNmQ0MjIxNzg5Li4xZTdkZjJj
MTkyNjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX3VjX2Z3
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfdWNfZncuYwpAQCAtMTYy
LDEyICsxNjIsMTEgQEAgdm9pZCBpbnRlbF91Y19md19pbml0X2Vhcmx5KHN0cnVjdCBpbnRlbF91
Y19mdyAqdWNfZncsCiAJCQkgICAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJ
LyoKLQkgKiB3ZSB1c2UgRklSTVdBUkVfVU5JTklUSUFMSVpFRCB0byBkZXRlY3QgY2hlY2tzIGFn
YWluc3QgZmV0Y2hfc3RhdHVzCisJICogd2UgdXNlIEZJUk1XQVJFX1VOSU5JVElBTElaRUQgdG8g
ZGV0ZWN0IGNoZWNrcyBhZ2FpbnN0IHVjX2Z3LT5zdGF0dXMKIAkgKiBiZWZvcmUgd2UncmUgbG9v
a2VkIGF0IHRoZSBIVyBjYXBzIHRvIHNlZSBpZiB3ZSBoYXZlIHVjIHN1cHBvcnQKIAkgKi8KIAlC
VUlMRF9CVUdfT04oSU5URUxfVUNfRklSTVdBUkVfVU5JTklUSUFMSVpFRCk7Ci0JR0VNX0JVR19P
Tih1Y19mdy0+ZmV0Y2hfc3RhdHVzKTsKLQlHRU1fQlVHX09OKHVjX2Z3LT5sb2FkX3N0YXR1cyk7
CisJR0VNX0JVR19PTih1Y19mdy0+c3RhdHVzKTsKIAlHRU1fQlVHX09OKHVjX2Z3LT5wYXRoKTsK
IAogCXVjX2Z3LT50eXBlID0gdHlwZTsKQEAgLTE3NiwxMyArMTc1LDEwIEBAIHZvaWQgaW50ZWxf
dWNfZndfaW5pdF9lYXJseShzdHJ1Y3QgaW50ZWxfdWNfZncgKnVjX2Z3LAogCQlfX3VjX2Z3X2F1
dG9fc2VsZWN0KHVjX2Z3LCBJTlRFTF9JTkZPKGk5MTUpLT5wbGF0Zm9ybSwKIAkJCQkgICAgSU5U
RUxfUkVWSUQoaTkxNSkpOwogCi0JaWYgKHVjX2Z3LT5wYXRoKSB7Ci0JCXVjX2Z3LT5mZXRjaF9z
dGF0dXMgPSBJTlRFTF9VQ19GSVJNV0FSRV9OT1RfU1RBUlRFRDsKLQkJdWNfZnctPmxvYWRfc3Rh
dHVzID0gSU5URUxfVUNfRklSTVdBUkVfTk9UX1NUQVJURUQ7Ci0JfSBlbHNlIHsKLQkJdWNfZnct
PmZldGNoX3N0YXR1cyA9IElOVEVMX1VDX0ZJUk1XQVJFX05PVF9TVVBQT1JURUQ7Ci0JCXVjX2Z3
LT5sb2FkX3N0YXR1cyA9IElOVEVMX1VDX0ZJUk1XQVJFX05PVF9TVVBQT1JURUQ7Ci0JfQorCWlm
ICh1Y19mdy0+cGF0aCkKKwkJdWNfZnctPnN0YXR1cyA9IElOVEVMX1VDX0ZJUk1XQVJFX1NFTEVD
VEVEOworCWVsc2UKKwkJdWNfZnctPnN0YXR1cyA9IElOVEVMX1VDX0ZJUk1XQVJFX05PVF9TVVBQ
T1JURUQ7CiB9CiAKIC8qKgpAQCAtMjA1LDIwICsyMDEsOSBAQCB2b2lkIGludGVsX3VjX2Z3X2Zl
dGNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAogCUdFTV9CVUdfT04oIWlu
dGVsX3VjX2Z3X3N1cHBvcnRlZCh1Y19mdykpOwogCi0JRFJNX0RFQlVHX0RSSVZFUigiJXMgZncg
ZmV0Y2ggJXNcbiIsCi0JCQkgaW50ZWxfdWNfZndfdHlwZV9yZXByKHVjX2Z3LT50eXBlKSwgdWNf
ZnctPnBhdGgpOwotCi0JdWNfZnctPmZldGNoX3N0YXR1cyA9IElOVEVMX1VDX0ZJUk1XQVJFX1BF
TkRJTkc7Ci0JRFJNX0RFQlVHX0RSSVZFUigiJXMgZncgZmV0Y2ggJXNcbiIsCi0JCQkgaW50ZWxf
dWNfZndfdHlwZV9yZXByKHVjX2Z3LT50eXBlKSwKLQkJCSBpbnRlbF91Y19md19zdGF0dXNfcmVw
cih1Y19mdy0+ZmV0Y2hfc3RhdHVzKSk7Ci0KIAllcnIgPSByZXF1ZXN0X2Zpcm13YXJlKCZmdywg
dWNfZnctPnBhdGgsICZwZGV2LT5kZXYpOwotCWlmIChlcnIpIHsKLQkJRFJNX0RFQlVHX0RSSVZF
UigiJXMgZncgcmVxdWVzdF9maXJtd2FyZSBlcnI9JWRcbiIsCi0JCQkJIGludGVsX3VjX2Z3X3R5
cGVfcmVwcih1Y19mdy0+dHlwZSksIGVycik7CisJaWYgKGVycikKIAkJZ290byBmYWlsOwotCX0K
IAogCURSTV9ERUJVR19EUklWRVIoIiVzIGZ3IHNpemUgJXp1IHB0ciAlcFxuIiwKIAkJCSBpbnRl
bF91Y19md190eXBlX3JlcHIodWNfZnctPnR5cGUpLCBmdy0+c2l6ZSwgZncpOwpAQCAtMzIwLDE5
ICszMDUsMTMgQEAgdm9pZCBpbnRlbF91Y19md19mZXRjaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCiAKIAl1Y19mdy0+b2JqID0gb2JqOwogCXVjX2Z3LT5zaXplID0gZnctPnNp
emU7Ci0JdWNfZnctPmZldGNoX3N0YXR1cyA9IElOVEVMX1VDX0ZJUk1XQVJFX1NVQ0NFU1M7Ci0J
RFJNX0RFQlVHX0RSSVZFUigiJXMgZncgZmV0Y2ggJXNcbiIsCi0JCQkgaW50ZWxfdWNfZndfdHlw
ZV9yZXByKHVjX2Z3LT50eXBlKSwKLQkJCSBpbnRlbF91Y19md19zdGF0dXNfcmVwcih1Y19mdy0+
ZmV0Y2hfc3RhdHVzKSk7CisJdWNfZnctPnN0YXR1cyA9IElOVEVMX1VDX0ZJUk1XQVJFX0FWQUlM
QUJMRTsKIAogCXJlbGVhc2VfZmlybXdhcmUoZncpOwogCXJldHVybjsKIAogZmFpbDoKLQl1Y19m
dy0+ZmV0Y2hfc3RhdHVzID0gSU5URUxfVUNfRklSTVdBUkVfRkFJTDsKLQlEUk1fREVCVUdfRFJJ
VkVSKCIlcyBmdyBmZXRjaCAlc1xuIiwKLQkJCSBpbnRlbF91Y19md190eXBlX3JlcHIodWNfZnct
PnR5cGUpLAotCQkJIGludGVsX3VjX2Z3X3N0YXR1c19yZXByKHVjX2Z3LT5mZXRjaF9zdGF0dXMp
KTsKKwl1Y19mdy0+c3RhdHVzID0gSU5URUxfVUNfRklSTVdBUkVfTUlTU0lORzsKIAogCURSTV9X
QVJOKCIlczogRmFpbGVkIHRvIGZldGNoIGZpcm13YXJlICVzIChlcnJvciAlZClcbiIsCiAJCSBp
bnRlbF91Y19md190eXBlX3JlcHIodWNfZnctPnR5cGUpLCB1Y19mdy0+cGF0aCwgZXJyKTsKQEAg
LTM4OCwxNCArMzY3LDExIEBAIGludCBpbnRlbF91Y19md191cGxvYWQoc3RydWN0IGludGVsX3Vj
X2Z3ICp1Y19mdywKIAlEUk1fREVCVUdfRFJJVkVSKCIlcyBmdyBsb2FkICVzXG4iLAogCQkJIGlu
dGVsX3VjX2Z3X3R5cGVfcmVwcih1Y19mdy0+dHlwZSksIHVjX2Z3LT5wYXRoKTsKIAotCWlmICh1
Y19mdy0+ZmV0Y2hfc3RhdHVzICE9IElOVEVMX1VDX0ZJUk1XQVJFX1NVQ0NFU1MpCi0JCXJldHVy
biAtRU5PRVhFQzsKLQotCXVjX2Z3LT5sb2FkX3N0YXR1cyA9IElOVEVMX1VDX0ZJUk1XQVJFX1BF
TkRJTkc7Ci0JRFJNX0RFQlVHX0RSSVZFUigiJXMgZncgbG9hZCAlc1xuIiwKLQkJCSBpbnRlbF91
Y19md190eXBlX3JlcHIodWNfZnctPnR5cGUpLAotCQkJIGludGVsX3VjX2Z3X3N0YXR1c19yZXBy
KHVjX2Z3LT5sb2FkX3N0YXR1cykpOworCS8qIG1ha2Ugc3VyZSB0aGUgc3RhdHVzIHdhcyBjbGVh
cmVkIHRoZSBsYXN0IHRpbWUgd2UgcmVzZXQgdGhlIHVjICovCisJR0VNX0JVR19PTihpbnRlbF91
Y19md19pc19sb2FkZWQodWNfZncpKTsKIAorCWlmICghaW50ZWxfdWNfZndfaXNfYXZhaWxhYmxl
KHVjX2Z3KSkKKwkJcmV0dXJuIC1FTk9FWEVDOwogCS8qIENhbGwgY3VzdG9tIGxvYWRlciAqLwog
CWludGVsX3VjX2Z3X2dndHRfYmluZCh1Y19mdyk7CiAJZXJyID0geGZlcih1Y19mdyk7CkBAIC00
MDMsMTAgKzM3OSw5IEBAIGludCBpbnRlbF91Y19md191cGxvYWQoc3RydWN0IGludGVsX3VjX2Z3
ICp1Y19mdywKIAlpZiAoZXJyKQogCQlnb3RvIGZhaWw7CiAKLQl1Y19mdy0+bG9hZF9zdGF0dXMg
PSBJTlRFTF9VQ19GSVJNV0FSRV9TVUNDRVNTOwotCURSTV9ERUJVR19EUklWRVIoIiVzIGZ3IGxv
YWQgJXNcbiIsCi0JCQkgaW50ZWxfdWNfZndfdHlwZV9yZXByKHVjX2Z3LT50eXBlKSwKLQkJCSBp
bnRlbF91Y19md19zdGF0dXNfcmVwcih1Y19mdy0+bG9hZF9zdGF0dXMpKTsKKwl1Y19mdy0+c3Rh
dHVzID0gSU5URUxfVUNfRklSTVdBUkVfVFJBTlNGRVJSRUQ7CisJRFJNX0RFQlVHX0RSSVZFUigi
JXMgZncgeGZlciBjb21wbGV0ZWRcbiIsCisJCQkgaW50ZWxfdWNfZndfdHlwZV9yZXByKHVjX2Z3
LT50eXBlKSk7CiAKIAlEUk1fSU5GTygiJXM6IExvYWRlZCBmaXJtd2FyZSAlcyAodmVyc2lvbiAl
dS4ldSlcbiIsCiAJCSBpbnRlbF91Y19md190eXBlX3JlcHIodWNfZnctPnR5cGUpLApAQCAtNDE2
LDEwICszOTEsOSBAQCBpbnQgaW50ZWxfdWNfZndfdXBsb2FkKHN0cnVjdCBpbnRlbF91Y19mdyAq
dWNfZncsCiAJcmV0dXJuIDA7CiAKIGZhaWw6Ci0JdWNfZnctPmxvYWRfc3RhdHVzID0gSU5URUxf
VUNfRklSTVdBUkVfRkFJTDsKLQlEUk1fREVCVUdfRFJJVkVSKCIlcyBmdyBsb2FkICVzXG4iLAot
CQkJIGludGVsX3VjX2Z3X3R5cGVfcmVwcih1Y19mdy0+dHlwZSksCi0JCQkgaW50ZWxfdWNfZndf
c3RhdHVzX3JlcHIodWNfZnctPmxvYWRfc3RhdHVzKSk7CisJdWNfZnctPnN0YXR1cyA9IElOVEVM
X1VDX0ZJUk1XQVJFX0ZBSUw7CisJRFJNX0RFQlVHX0RSSVZFUigiJXMgZncgbG9hZCBmYWlsZWRc
biIsCisJCQkgaW50ZWxfdWNfZndfdHlwZV9yZXByKHVjX2Z3LT50eXBlKSk7CiAKIAlEUk1fV0FS
TigiJXM6IEZhaWxlZCB0byBsb2FkIGZpcm13YXJlICVzIChlcnJvciAlZClcbiIsCiAJCSBpbnRl
bF91Y19md190eXBlX3JlcHIodWNfZnctPnR5cGUpLCB1Y19mdy0+cGF0aCwgZXJyKTsKQEAgLTQz
MSw3ICs0MDUsMTAgQEAgaW50IGludGVsX3VjX2Z3X2luaXQoc3RydWN0IGludGVsX3VjX2Z3ICp1
Y19mdykKIHsKIAlpbnQgZXJyOwogCi0JaWYgKHVjX2Z3LT5mZXRjaF9zdGF0dXMgIT0gSU5URUxf
VUNfRklSTVdBUkVfU1VDQ0VTUykKKwkvKiB0aGlzIHNob3VsZCBoYXBwZW4gYmVmb3JlIHRoZSBs
b2FkISAqLworCUdFTV9CVUdfT04oaW50ZWxfdWNfZndfaXNfbG9hZGVkKHVjX2Z3KSk7CisKKwlp
ZiAoIWludGVsX3VjX2Z3X2lzX2F2YWlsYWJsZSh1Y19mdykpCiAJCXJldHVybiAtRU5PRVhFQzsK
IAogCWVyciA9IGk5MTVfZ2VtX29iamVjdF9waW5fcGFnZXModWNfZnctPm9iaik7CkBAIC00NDQs
NyArNDIxLDcgQEAgaW50IGludGVsX3VjX2Z3X2luaXQoc3RydWN0IGludGVsX3VjX2Z3ICp1Y19m
dykKIAogdm9pZCBpbnRlbF91Y19md19maW5pKHN0cnVjdCBpbnRlbF91Y19mdyAqdWNfZncpCiB7
Ci0JaWYgKHVjX2Z3LT5mZXRjaF9zdGF0dXMgIT0gSU5URUxfVUNfRklSTVdBUkVfU1VDQ0VTUykK
KwlpZiAoIWludGVsX3VjX2Z3X2lzX2F2YWlsYWJsZSh1Y19mdykpCiAJCXJldHVybjsKIAogCWk5
MTVfZ2VtX29iamVjdF91bnBpbl9wYWdlcyh1Y19mdy0+b2JqKTsKQEAgLTQ3OCw3ICs0NTUsNyBA
QCB2b2lkIGludGVsX3VjX2Z3X2NsZWFudXBfZmV0Y2goc3RydWN0IGludGVsX3VjX2Z3ICp1Y19m
dykKIAlpZiAob2JqKQogCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAKLQl1Y19mdy0+ZmV0
Y2hfc3RhdHVzID0gSU5URUxfVUNfRklSTVdBUkVfTk9UX1NUQVJURUQ7CisJdWNfZnctPnN0YXR1
cyA9IElOVEVMX1VDX0ZJUk1XQVJFX1NFTEVDVEVEOwogfQogCiAvKioKQEAgLTQ5Miw5ICs0Njks
OCBAQCB2b2lkIGludGVsX3VjX2Z3X2R1bXAoY29uc3Qgc3RydWN0IGludGVsX3VjX2Z3ICp1Y19m
dywgc3RydWN0IGRybV9wcmludGVyICpwKQogewogCWRybV9wcmludGYocCwgIiVzIGZpcm13YXJl
OiAlc1xuIiwKIAkJICAgaW50ZWxfdWNfZndfdHlwZV9yZXByKHVjX2Z3LT50eXBlKSwgdWNfZnct
PnBhdGgpOwotCWRybV9wcmludGYocCwgIlx0c3RhdHVzOiBmZXRjaCAlcywgbG9hZCAlc1xuIiwK
LQkJICAgaW50ZWxfdWNfZndfc3RhdHVzX3JlcHIodWNfZnctPmZldGNoX3N0YXR1cyksCi0JCSAg
IGludGVsX3VjX2Z3X3N0YXR1c19yZXByKHVjX2Z3LT5sb2FkX3N0YXR1cykpOworCWRybV9wcmlu
dGYocCwgIlx0c3RhdHVzOiAlc1xuIiwKKwkJICAgaW50ZWxfdWNfZndfc3RhdHVzX3JlcHIodWNf
ZnctPnN0YXR1cykpOwogCWRybV9wcmludGYocCwgIlx0dmVyc2lvbjogd2FudGVkICV1LiV1LCBm
b3VuZCAldS4ldVxuIiwKIAkJICAgdWNfZnctPm1ham9yX3Zlcl93YW50ZWQsIHVjX2Z3LT5taW5v
cl92ZXJfd2FudGVkLAogCQkgICB1Y19mdy0+bWFqb3JfdmVyX2ZvdW5kLCB1Y19mdy0+bWlub3Jf
dmVyX2ZvdW5kKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVs
X3VjX2Z3LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF91Y19mdy5oCmluZGV4
IGM5M2UyNzE5MTdjOS4uZjZhYTJlM2U0ZDFmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC91Yy9pbnRlbF91Y19mdy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Vj
L2ludGVsX3VjX2Z3LmgKQEAgLTM1LDEyICszNSwxNCBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZTsKICNkZWZpbmUgSU5URUxfVUNfRklSTVdBUkVfVVJMICJodHRwczovL2dpdC5rZXJuZWwub3Jn
L3B1Yi9zY20vbGludXgva2VybmVsL2dpdC9maXJtd2FyZS9saW51eC1maXJtd2FyZS5naXQvdHJl
ZS9pOTE1IgogCiBlbnVtIGludGVsX3VjX2Z3X3N0YXR1cyB7Ci0JSU5URUxfVUNfRklSTVdBUkVf
Tk9UX1NVUFBPUlRFRCA9IC0yLCAvKiBubyB1YyBIVyAqLwotCUlOVEVMX1VDX0ZJUk1XQVJFX0ZB
SUwgPSAtMSwKKwlJTlRFTF9VQ19GSVJNV0FSRV9GQUlMID0gLTMsIC8qIGZhaWxlZCB0byB4ZmVy
IG9yIGluaXQvYXV0aCB0aGUgZncgKi8KKwlJTlRFTF9VQ19GSVJNV0FSRV9NSVNTSU5HID0gLTIs
IC8qIGJsb2Igbm90IGZvdW5kIG9uIHRoZSBzeXN0ZW0gKi8KKwlJTlRFTF9VQ19GSVJNV0FSRV9O
T1RfU1VQUE9SVEVEID0gLTEsIC8qIG5vIHVjIEhXICovCiAJSU5URUxfVUNfRklSTVdBUkVfVU5J
TklUSUFMSVpFRCA9IDAsIC8qIHVzZWQgdG8gY2F0Y2ggY2hlY2tzIGRvbmUgdG9vIGVhcmx5ICov
Ci0JSU5URUxfVUNfRklSTVdBUkVfTk9UX1NUQVJURUQgPSAxLAotCUlOVEVMX1VDX0ZJUk1XQVJF
X1BFTkRJTkcsCi0JSU5URUxfVUNfRklSTVdBUkVfU1VDQ0VTUworCUlOVEVMX1VDX0ZJUk1XQVJF
X1NFTEVDVEVELCAvKiBzZWxlY3RlZCB0aGUgYmxvYiB3ZSB3YW50IHRvIGxvYWQgKi8KKwlJTlRF
TF9VQ19GSVJNV0FSRV9BVkFJTEFCTEUsIC8qIGJsb2IgZm91bmQgYW5kIGNvcGllZCBpbiBtZW0g
Ki8KKwlJTlRFTF9VQ19GSVJNV0FSRV9UUkFOU0ZFUlJFRCwgLyogZG1hIHhmZXIgZG9uZSAqLwor
CUlOVEVMX1VDX0ZJUk1XQVJFX1JVTk5JTkcgLyogaW5pdC9hdXRoIGRvbmUgKi8KIH07CiAKIGVu
dW0gaW50ZWxfdWNfZndfdHlwZSB7CkBAIC01Nyw4ICs1OSw3IEBAIHN0cnVjdCBpbnRlbF91Y19m
dyB7CiAJY29uc3QgY2hhciAqcGF0aDsKIAlzaXplX3Qgc2l6ZTsKIAlzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqOwotCWVudW0gaW50ZWxfdWNfZndfc3RhdHVzIGZldGNoX3N0YXR1czsK
LQllbnVtIGludGVsX3VjX2Z3X3N0YXR1cyBsb2FkX3N0YXR1czsKKwllbnVtIGludGVsX3VjX2Z3
X3N0YXR1cyBzdGF0dXM7CiAKIAkvKgogCSAqIFRoZSBmaXJtd2FyZSBidWlsZCBwcm9jZXNzIHdp
bGwgZ2VuZXJhdGUgYSB2ZXJzaW9uIGhlYWRlciBmaWxlIHdpdGggbWFqb3IgYW5kCkBAIC04Mywx
OCArODQsMjIgQEAgc3RhdGljIGlubGluZQogY29uc3QgY2hhciAqaW50ZWxfdWNfZndfc3RhdHVz
X3JlcHIoZW51bSBpbnRlbF91Y19md19zdGF0dXMgc3RhdHVzKQogewogCXN3aXRjaCAoc3RhdHVz
KSB7Ci0JY2FzZSBJTlRFTF9VQ19GSVJNV0FSRV9OT1RfU1VQUE9SVEVEOgotCQlyZXR1cm4gIk4v
QSAtIHVjIEhXIG5vdCBhdmFpbGFibGUiOwogCWNhc2UgSU5URUxfVUNfRklSTVdBUkVfRkFJTDoK
IAkJcmV0dXJuICJGQUlMIjsKKwljYXNlIElOVEVMX1VDX0ZJUk1XQVJFX01JU1NJTkc6CisJCXJl
dHVybiAiTUlTU0lORyI7CisJY2FzZSBJTlRFTF9VQ19GSVJNV0FSRV9OT1RfU1VQUE9SVEVEOgor
CQlyZXR1cm4gIk4vQSI7CiAJY2FzZSBJTlRFTF9VQ19GSVJNV0FSRV9VTklOSVRJQUxJWkVEOgog
CQlyZXR1cm4gIlVOSU5JVElBTElaRUQiOwotCWNhc2UgSU5URUxfVUNfRklSTVdBUkVfTk9UX1NU
QVJURUQ6Ci0JCXJldHVybiAiTk9UX1NUQVJURUQiOwotCWNhc2UgSU5URUxfVUNfRklSTVdBUkVf
UEVORElORzoKLQkJcmV0dXJuICJQRU5ESU5HIjsKLQljYXNlIElOVEVMX1VDX0ZJUk1XQVJFX1NV
Q0NFU1M6Ci0JCXJldHVybiAiU1VDQ0VTUyI7CisJY2FzZSBJTlRFTF9VQ19GSVJNV0FSRV9TRUxF
Q1RFRDoKKwkJcmV0dXJuICJTRUxFQ1RFRCI7CisJY2FzZSBJTlRFTF9VQ19GSVJNV0FSRV9BVkFJ
TEFCTEU6CisJCXJldHVybiAiQVZBSUxBQkxFIjsKKwljYXNlIElOVEVMX1VDX0ZJUk1XQVJFX1RS
QU5TRkVSUkVEOgorCQlyZXR1cm4gIlRSQU5TRkVSUkVEIjsKKwljYXNlIElOVEVMX1VDX0ZJUk1X
QVJFX1JVTk5JTkc6CisJCXJldHVybiAiUlVOTklORyI7CiAJfQogCXJldHVybiAiPGludmFsaWQ+
IjsKIH0KQEAgLTExMCwyMiArMTE1LDM4IEBAIHN0YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqaW50
ZWxfdWNfZndfdHlwZV9yZXByKGVudW0gaW50ZWxfdWNfZndfdHlwZSB0eXBlKQogCXJldHVybiAi
dUMiOwogfQogCitzdGF0aWMgaW5saW5lIGVudW0gaW50ZWxfdWNfZndfc3RhdHVzCitfX2ludGVs
X3VjX2Z3X3N0YXR1cyhzdHJ1Y3QgaW50ZWxfdWNfZncgKnVjX2Z3KQoreworCS8qIHNob3VsZG4n
dCBjYWxsIHRoaXMgYmVmb3JlIGNoZWNraW5nIGh3L2Jsb2IgYXZhaWxhYmlsaXR5ICovCisJR0VN
X0JVR19PTih1Y19mdy0+c3RhdHVzID09IElOVEVMX1VDX0ZJUk1XQVJFX1VOSU5JVElBTElaRUQp
OworCXJldHVybiB1Y19mdy0+c3RhdHVzOworfQorCitzdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxf
dWNfZndfaXNfYXZhaWxhYmxlKHN0cnVjdCBpbnRlbF91Y19mdyAqdWNfZncpCit7CisJcmV0dXJu
IF9faW50ZWxfdWNfZndfc3RhdHVzKHVjX2Z3KSA+PSBJTlRFTF9VQ19GSVJNV0FSRV9BVkFJTEFC
TEU7Cit9CisKIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF91Y19md19pc19sb2FkZWQoc3RydWN0
IGludGVsX3VjX2Z3ICp1Y19mdykKIHsKLQlyZXR1cm4gdWNfZnctPmxvYWRfc3RhdHVzID09IElO
VEVMX1VDX0ZJUk1XQVJFX1NVQ0NFU1M7CisJcmV0dXJuIF9faW50ZWxfdWNfZndfc3RhdHVzKHVj
X2Z3KSA+PSBJTlRFTF9VQ19GSVJNV0FSRV9UUkFOU0ZFUlJFRDsKK30KKworc3RhdGljIGlubGlu
ZSBib29sIGludGVsX3VjX2Z3X2lzX3J1bm5pbmcoc3RydWN0IGludGVsX3VjX2Z3ICp1Y19mdykK
K3sKKwlyZXR1cm4gX19pbnRlbF91Y19md19zdGF0dXModWNfZncpID09IElOVEVMX1VDX0ZJUk1X
QVJFX1JVTk5JTkc7CiB9CiAKIHN0YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF91Y19md19zdXBwb3J0
ZWQoc3RydWN0IGludGVsX3VjX2Z3ICp1Y19mdykKIHsKLQkvKiBzaG91bGRuJ3QgY2FsbCB0aGlz
IGJlZm9yZSBjaGVja2luZyBody9ibG9iIGF2YWlsYWJpbGl0eSAqLwotCUdFTV9CVUdfT04odWNf
ZnctPmZldGNoX3N0YXR1cyA9PSBJTlRFTF9VQ19GSVJNV0FSRV9VTklOSVRJQUxJWkVEKTsKLQly
ZXR1cm4gdWNfZnctPmZldGNoX3N0YXR1cyAhPSBJTlRFTF9VQ19GSVJNV0FSRV9OT1RfU1VQUE9S
VEVEOworCXJldHVybiBfX2ludGVsX3VjX2Z3X3N0YXR1cyh1Y19mdykgIT0gSU5URUxfVUNfRklS
TVdBUkVfTk9UX1NVUFBPUlRFRDsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkIGludGVsX3VjX2Z3
X3Nhbml0aXplKHN0cnVjdCBpbnRlbF91Y19mdyAqdWNfZncpCiB7CiAJaWYgKGludGVsX3VjX2Z3
X2lzX2xvYWRlZCh1Y19mdykpCi0JCXVjX2Z3LT5sb2FkX3N0YXR1cyA9IElOVEVMX1VDX0ZJUk1X
QVJFX1BFTkRJTkc7CisJCXVjX2Z3LT5zdGF0dXMgPSBJTlRFTF9VQ19GSVJNV0FSRV9BVkFJTEFC
TEU7CiB9CiAKIC8qKgpAQCAtMTM4LDcgKzE1OSw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpbnRl
bF91Y19md19zYW5pdGl6ZShzdHJ1Y3QgaW50ZWxfdWNfZncgKnVjX2Z3KQogICovCiBzdGF0aWMg
aW5saW5lIHUzMiBpbnRlbF91Y19md19nZXRfdXBsb2FkX3NpemUoc3RydWN0IGludGVsX3VjX2Z3
ICp1Y19mdykKIHsKLQlpZiAodWNfZnctPmZldGNoX3N0YXR1cyAhPSBJTlRFTF9VQ19GSVJNV0FS
RV9TVUNDRVNTKQorCWlmICghaW50ZWxfdWNfZndfaXNfYXZhaWxhYmxlKHVjX2Z3KSkKIAkJcmV0
dXJuIDA7CiAKIAlyZXR1cm4gdWNfZnctPmhlYWRlcl9zaXplICsgdWNfZnctPnVjb2RlX3NpemU7
Ci0tIAoyLjIyLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdm
eA==

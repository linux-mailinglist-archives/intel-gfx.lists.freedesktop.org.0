Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 64A1AA12B0
	for <lists+intel-gfx@lfdr.de>; Thu, 29 Aug 2019 09:36:13 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3B6D689E63;
	Thu, 29 Aug 2019 07:36:11 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A818789E63;
 Thu, 29 Aug 2019 07:36:09 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by fmsmga101.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 29 Aug 2019 00:36:09 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,442,1559545200"; d="scan'208";a="185890332"
Received: from ssinisal-mobl1.ger.corp.intel.com ([10.249.254.237])
 by orsmga006.jf.intel.com with ESMTP; 29 Aug 2019 00:36:06 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190826152000.23394-1-chris@chris-wilson.co.uk>
From: Abdiel Janulgue <abdiel.janulgue@linux.intel.com>
Message-ID: <4e42e0da-8306-d843-8129-4d2513df85cc@linux.intel.com>
Date: Thu, 29 Aug 2019 10:36:05 +0300
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:60.0)
 Gecko/20100101 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20190826152000.23394-1-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH i-g-t] i915/gem_mmap_gtt: Race mmap offset
 generation against closure
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

WXVwLCB0aGlzIGlzIGEgdmFsaWQgaXNzdWUuCgpSZXZpZXdlZC1ieTogQWJkaWVsIEphbnVsZ3Vl
IDxhYmRpZWwuamFudWxndWVAbGludXguaW50ZWwuY29tPgoKT24gMjYvMDgvMjAxOSAxOC4yMCwg
Q2hyaXMgV2lsc29uIHdyb3RlOgo+IFNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNA
Y2hyaXMtd2lsc29uLmNvLnVrPgo+IENjOiBBYmRpZWwgSmFudWxndWUgPGFiZGllbC5qYW51bGd1
ZUBsaW51eC5pbnRlbC5jb20+Cj4gLS0tCj4gIHRlc3RzL2k5MTUvZ2VtX21tYXBfZ3R0LmMgfCA5
OCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKPiAgMSBmaWxlIGNoYW5n
ZWQsIDk4IGluc2VydGlvbnMoKykKPiAKPiBkaWZmIC0tZ2l0IGEvdGVzdHMvaTkxNS9nZW1fbW1h
cF9ndHQuYyBiL3Rlc3RzL2k5MTUvZ2VtX21tYXBfZ3R0LmMKPiBpbmRleCA4ZWZmOTE4NTAuLjgx
MDY4ZjdkMSAxMDA2NDQKPiAtLS0gYS90ZXN0cy9pOTE1L2dlbV9tbWFwX2d0dC5jCj4gKysrIGIv
dGVzdHMvaTkxNS9nZW1fbW1hcF9ndHQuYwo+IEBAIC0yNiw2ICsyNiw3IEBACj4gICAqLwo+ICAK
PiAgI2luY2x1ZGUgPHVuaXN0ZC5oPgo+ICsjaW5jbHVkZSA8c3RkYXRvbWljLmg+Cj4gICNpbmNs
dWRlIDxzdGRsaWIuaD4KPiAgI2luY2x1ZGUgPHN0ZGlvLmg+Cj4gICNpbmNsdWRlIDxzdHJpbmcu
aD4KPiBAQCAtMzYwLDYgKzM2MSw5OSBAQCB0ZXN0X2lzb2xhdGlvbihpbnQgaTkxNSkKPiAgCWln
dF9hc3NlcnQocHRyID09IE1BUF9GQUlMRUQpOwo+ICB9Cj4gIAo+ICtzdGF0aWMgdm9pZAo+ICt0
ZXN0X2Nsb3NlX3JhY2UoaW50IGk5MTUpCj4gK3sKPiArCWNvbnN0IGludCBuY3B1cyA9IHN5c2Nv
bmYoX1NDX05QUk9DRVNTT1JTX09OTE4pOwo+ICsJdWludDMyX3QgKmhhbmRsZXM7Cj4gKwo+ICsJ
aGFuZGxlcyA9IG1tYXA2NCgwLCA0MDk2LCBQUk9UX1dSSVRFLCBNQVBfU0hBUkVEIHwgTUFQX0FO
T04sIC0xLCAwKTsKPiArCWlndF9hc3NlcnQoaGFuZGxlcyAhPSBNQVBfRkFJTEVEKTsKPiArCj4g
KwlpZ3RfZm9yayhjaGlsZCwgbmNwdXMpIHsKPiArCQlkbyB7Cj4gKwkJCXN0cnVjdCBkcm1faTkx
NV9nZW1fbW1hcF9ndHQgbW1hcF9hcmcgPSB7fTsKPiArCQkJaW50IGkgPSAxICsgcmFuZG9tKCkg
JSBuY3B1czsKPiArCQkJdWludDMyX3Qgb2xkOwo+ICsKPiArCQkJbW1hcF9hcmcuaGFuZGxlID0g
Z2VtX2NyZWF0ZShpOTE1LCA0MDk2KTsKPiArCQkJb2xkID0gYXRvbWljX2V4Y2hhbmdlKCZoYW5k
bGVzW2ldLCBtbWFwX2FyZy5oYW5kbGUpOwo+ICsJCQlpb2N0bChpOTE1LCBEUk1fSU9DVExfR0VN
X0NMT1NFLCAmb2xkKTsKPiArCj4gKwkJCWlmIChpb2N0bChpOTE1LAo+ICsJCQkJICBEUk1fSU9D
VExfSTkxNV9HRU1fTU1BUF9HVFQsCj4gKwkJCQkgICZtbWFwX2FyZykgIT0gLTEpIHsKPiArCQkJ
CXZvaWQgKnB0cjsKPiArCj4gKwkJCQlwdHIgPSBtbWFwNjQoMCwgNDA5NiwKPiArCQkJCQkgICAg
IFBST1RfUkVBRCwgTUFQX1NIQVJFRCwgaTkxNSwKPiArCQkJCQkgICAgIG1tYXBfYXJnLm9mZnNl
dCk7Cj4gKwkJCQlpZiAocHRyICE9IE1BUF9GQUlMRUQpCj4gKwkJCQkJbXVubWFwKHB0ciwgNDA5
Nik7Cj4gKwkJCX0KPiArCQl9IHdoaWxlICghUkVBRF9PTkNFKGhhbmRsZXNbMF0pKTsKPiArCX0K
PiArCj4gKwlzbGVlcCgyMCk7Cj4gKwloYW5kbGVzWzBdID0gMTsKPiArCWlndF93YWl0Y2hpbGRy
ZW4oKTsKPiArCj4gKwlmb3IgKGludCBpID0gMTsgaSA8PSBuY3B1czsgaSsrKQo+ICsJCWlvY3Rs
KGk5MTUsIERSTV9JT0NUTF9HRU1fQ0xPU0UsIGhhbmRsZXNbaV0pOwo+ICsJbXVubWFwKGhhbmRs
ZXMsIDQwOTYpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZAo+ICt0ZXN0X2ZsaW5rX3JhY2UoaW50
IGk5MTUpCj4gK3sKPiArCWNvbnN0IGludCBuY3B1cyA9IHN5c2NvbmYoX1NDX05QUk9DRVNTT1JT
X09OTE4pOwo+ICsJdWludDMyX3QgKmhhbmRsZXM7Cj4gKwo+ICsJaGFuZGxlcyA9IG1tYXA2NCgw
LCA0MDk2LCBQUk9UX1dSSVRFLCBNQVBfU0hBUkVEIHwgTUFQX0FOT04sIC0xLCAwKTsKPiArCWln
dF9hc3NlcnQoaGFuZGxlcyAhPSBNQVBfRkFJTEVEKTsKPiArCj4gKwlpZ3RfZm9yayhjaGlsZCwg
bmNwdXMpIHsKPiArCQlpbnQgZmQgPSBnZW1fcmVvcGVuX2RyaXZlcihpOTE1KTsKPiArCj4gKwkJ
ZG8gewo+ICsJCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX21tYXBfZ3R0IG1tYXBfYXJnID0ge307Cj4g
KwkJCXVpbnQzMl90IG9sZDsKPiArCQkJaW50IGkgPSAxICsgcmFuZG9tKCkgJSBuY3B1czsKPiAr
Cj4gKwkJCW9sZCA9IGF0b21pY19leGNoYW5nZSgmaGFuZGxlc1tpXSwKPiArCQkJCQkgICAgICBn
ZW1fY3JlYXRlKGk5MTUsIDQwOTYpKTsKPiArCQkJaWYgKCFvbGQpCj4gKwkJCQljb250aW51ZTsK
PiArCj4gKwkJCW1tYXBfYXJnLmhhbmRsZSA9Cj4gKwkJCQlnZW1fb3BlbihmZCwgZ2VtX2ZsaW5r
KGk5MTUsIG9sZCkpOwo+ICsJCQlpb2N0bChpOTE1LCBEUk1fSU9DVExfR0VNX0NMT1NFLCAmb2xk
KTsKPiArCj4gKwkJCWlmIChpb2N0bChmZCwKPiArCQkJCSAgRFJNX0lPQ1RMX0k5MTVfR0VNX01N
QVBfR1RULAo+ICsJCQkJICAmbW1hcF9hcmcpICE9IC0xKSB7Cj4gKwkJCQl2b2lkICpwdHI7Cj4g
Kwo+ICsJCQkJcHRyID0gbW1hcDY0KDAsIDQwOTYsCj4gKwkJCQkJICAgICBQUk9UX1JFQUQsIE1B
UF9TSEFSRUQsIGZkLAo+ICsJCQkJCSAgICAgbW1hcF9hcmcub2Zmc2V0KTsKPiArCQkJCWlmIChw
dHIgIT0gTUFQX0ZBSUxFRCkKPiArCQkJCQltdW5tYXAocHRyLCA0MDk2KTsKPiArCQkJfQo+ICsK
PiArCQkJaW9jdGwoZmQsIERSTV9JT0NUTF9HRU1fQ0xPU0UsICZtbWFwX2FyZy5oYW5kbGUpOwo+
ICsJCX0gd2hpbGUgKCFSRUFEX09OQ0UoaGFuZGxlc1swXSkpOwo+ICsJfQo+ICsKPiArCXNsZWVw
KDIwKTsKPiArCWhhbmRsZXNbMF0gPSAxOwo+ICsJaWd0X3dhaXRjaGlsZHJlbigpOwo+ICsKPiAr
CWZvciAoaW50IGkgPSAxOyBpIDw9IG5jcHVzOyBpKyspCj4gKwkJaW9jdGwoaTkxNSwgRFJNX0lP
Q1RMX0dFTV9DTE9TRSwgaGFuZGxlc1tpXSk7Cj4gKwltdW5tYXAoaGFuZGxlcywgNDA5Nik7Cj4g
K30KPiArCj4gIHN0YXRpYyB2b2lkCj4gIHRlc3Rfd3JpdGVfZ3R0KGludCBmZCkKPiAgewo+IEBA
IC05ODUsNiArMTA3OSwxMCBAQCBpZ3RfbWFpbgo+ICAJCXRlc3Rfd2MoZmQpOwo+ICAJaWd0X3N1
YnRlc3QoImlzb2xhdGlvbiIpCj4gIAkJdGVzdF9pc29sYXRpb24oZmQpOwo+ICsJaWd0X3N1YnRl
c3QoImNsb3NlLXJhY2UiKQo+ICsJCXRlc3RfY2xvc2VfcmFjZShmZCk7Cj4gKwlpZ3Rfc3VidGVz
dCgiZmxpbmstcmFjZSIpCj4gKwkJdGVzdF9mbGlua19yYWNlKGZkKTsKPiAgCWlndF9zdWJ0ZXN0
KCJwZi1ub25ibG9jayIpCj4gIAkJdGVzdF9wZl9ub25ibG9jayhmZCk7Cj4gIAo+IApfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

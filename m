Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7F3DB4D036
	for <lists+intel-gfx@lfdr.de>; Thu, 20 Jun 2019 16:19:46 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CC43B6E58B;
	Thu, 20 Jun 2019 14:19:44 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 12B7C6E58B
 for <intel-gfx@lists.freedesktop.org>; Thu, 20 Jun 2019 14:19:43 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 20 Jun 2019 07:19:42 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,397,1557212400"; d="scan'208";a="181867116"
Received: from gaia.fi.intel.com ([10.237.72.169])
 by fmsmga001.fm.intel.com with ESMTP; 20 Jun 2019 07:19:40 -0700
Received: by gaia.fi.intel.com (Postfix, from userid 1000)
 id D751F5C1EC2; Thu, 20 Jun 2019 17:19:32 +0300 (EEST)
From: Mika Kuoppala <mika.kuoppala@linux.intel.com>
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
In-Reply-To: <156103970515.664.11214388171288612871@skylake-alporthouse-com>
References: <20190620070559.30076-1-chris@chris-wilson.co.uk>
 <20190620070559.30076-3-chris@chris-wilson.co.uk>
 <87v9x05pbn.fsf@gaia.fi.intel.com>
 <156103970515.664.11214388171288612871@skylake-alporthouse-com>
Date: Thu, 20 Jun 2019 17:19:32 +0300
Message-ID: <87pnn85ogb.fsf@gaia.fi.intel.com>
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [PATCH 3/3] drm/i915/execlists: Force preemption
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+IHdyaXRlczoKCj4gUXVvdGlu
ZyBNaWthIEt1b3BwYWxhICgyMDE5LTA2LTIwIDE1OjAwOjQ0KQo+PiBDaHJpcyBXaWxzb24gPGNo
cmlzQGNocmlzLXdpbHNvbi5jby51az4gd3JpdGVzOgo+PiAKPj4gPiBJZiB0aGUgcHJlZW1wdGVk
IGNvbnRleHQgdGFrZXMgdG9vIGxvbmcgdG8gcmVsaW5xdWlzaCBjb250cm9sLCBlLmcuIGl0Cj4+
ID4gaXMgc3R1Y2sgaW5zaWRlIGEgc2hhZGVyIHdpdGggYXJiaXRyYXRpb24gZGlzYWJsZWQsIGV2
aWN0IHRoYXQgY29udGV4dAo+PiA+IHdpdGggYW4gZW5naW5lIHJlc2V0LiBUaGlzIGVuc3VyZXMg
dGhhdCBwcmVlbXB0aW9ucyBhcmUgcmVhc29uYWJseQo+PiA+IHJlc3BvbnNpdmUsIHByb3ZpZGlu
ZyBhIHRpZ2h0ZXIgUW9TIGZvciB0aGUgbW9yZSBpbXBvcnRhbnQgY29udGV4dCBhdAo+PiA+IHRo
ZSBjb3N0IG9mIGZsYWdnaW5nIHVucmVzcG9uc2l2ZSBjb250ZXh0cyBtb3JlIGZyZXF1ZW50bHkg
KGkuZS4gaW5zdGVhZAo+PiA+IG9mIHVzaW5nIGFuIH4xMHMgaGFuZ2NoZWNrLCB3ZSBub3cgZXZp
Y3QgYXQgfjEwbXMpLiAgVGhlIGNoYWxsZW5nZSBvZgo+PiA+IGxpZXMgaW4gcGlja2luZyBhIHRp
bWVvdXQgdGhhdCBjYW4gYmUgcmVhc29uYWJseSBzZXJ2aWNlZCBieSBIVyBmb3IKPj4gPiB0eXBp
Y2FsIHdvcmtsb2FkcywgYmFsYW5jaW5nIHRoZSBleGlzdGluZyBjbGllbnRzIGFnYWluc3QgdGhl
IG5lZWRzIGZvcgo+PiA+IHJlc3BvbnNpdmVuZXNzLgo+PiA+Cj4+ID4gU2lnbmVkLW9mZi1ieTog
Q2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Cj4+ID4gQ2M6IE1pa2EgS3Vv
cHBhbGEgPG1pa2Eua3VvcHBhbGFAbGludXguaW50ZWwuY29tPgo+PiA+IENjOiBUdnJ0a28gVXJz
dWxpbiA8dHZydGtvLnVyc3VsaW5AaW50ZWwuY29tPgo+PiA+IC0tLQo+PiA+ICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9LY29uZmlnLnByb2ZpbGUgfCAxMiArKysrKysKPj4gPiAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgIHwgNTYgKysrKysrKysrKysrKysrKysrKysrKysrKyst
LQo+PiA+ICAyIGZpbGVzIGNoYW5nZWQsIDY1IGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0p
Cj4+ID4KPj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9m
aWxlIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9maWxlCj4+ID4gaW5kZXggNDhk
Zjg4ODlhODhhLi44MjczZDNiYWFmZTQgMTAwNjQ0Cj4+ID4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvS2NvbmZpZy5wcm9maWxlCj4+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvS2Nv
bmZpZy5wcm9maWxlCj4+ID4gQEAgLTI1LDMgKzI1LDE1IEBAIGNvbmZpZyBEUk1fSTkxNV9TUElO
X1JFUVVFU1QKPj4gPiAgICAgICAgIE1heSBiZSAwIHRvIGRpc2FibGUgdGhlIGluaXRpYWwgc3Bp
bi4gSW4gcHJhY3RpY2UsIHdlIGVzdGltYXRlCj4+ID4gICAgICAgICB0aGUgY29zdCBvZiBlbmFi
bGluZyB0aGUgaW50ZXJydXB0IChpZiBjdXJyZW50bHkgZGlzYWJsZWQpIHRvIGJlCj4+ID4gICAg
ICAgICBhIGZldyBtaWNyb3NlY29uZHMuCj4+ID4gKwo+PiA+ICtjb25maWcgRFJNX0k5MTVfUFJF
RU1QVF9USU1FT1VUCj4+ID4gKyAgICAgaW50ICJQcmVlbXB0IHRpbWVvdXQgKG1zKSIKPj4gPiAr
ICAgICBkZWZhdWx0IDEwICMgbWlsbGlzZWNvbmRzCj4+ID4gKyAgICAgaGVscAo+PiA+ICsgICAg
ICAgSG93IGxvbmcgdG8gd2FpdCAoaW4gbWlsbGlzZWNvbmRzKSBmb3IgYSBwcmVlbXB0aW9uIGV2
ZW50IHRvIG9jY3VyCj4+ID4gKyAgICAgICB3aGVuIHN1Ym1pdHRpbmcgYSBuZXcgY29udGV4dCB2
aWEgZXhlY2xpc3RzLiBJZiB0aGUgY3VycmVudCBjb250ZXh0Cj4+ID4gKyAgICAgICBkb2VzIG5v
dCBoaXQgYW4gYXJiaXRyYXRpb24gcG9pbnQgYW5kIHlpZWxkIHRvIEhXIGJlZm9yZSB0aGUgdGlt
ZXIKPj4gPiArICAgICAgIGV4cGlyZXMsIHRoZSBIVyB3aWxsIGJlIHJlc2V0IHRvIGFsbG93IHRo
ZSBtb3JlIGltcG9ydGFudCBjb250ZXh0Cj4+ID4gKyAgICAgICB0byBleGVjdXRlLgo+PiA+ICsK
Pj4gPiArICAgICAgIE1heSBiZSAwIHRvIGRpc2FibGUgdGhlIHRpbWVvdXQuCj4+ID4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKPj4gPiBpbmRleCBmY2E3OWFkYjRhYTMuLmU4ZDdkZWJh
M2U0OSAxMDA2NDQKPj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMu
Ywo+PiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCj4+ID4gQEAg
LTg4OSw2ICs4ODksMTUgQEAgZW5hYmxlX3RpbWVzbGljZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUpCj4+ID4gICAgICAgcmV0dXJuIGxhc3QgJiYgbmVlZF90aW1lc2xpY2UoZW5naW5l
LCBsYXN0KTsKPj4gPiAgfQo+PiA+ICAKPj4gPiArc3RhdGljIHVuc2lnbmVkIGxvbmcgcHJlZW1w
dF9leHBpcmVzKHZvaWQpCj4+ID4gK3sKPj4gPiArICAgICB1bnNpZ25lZCBsb25nIHRpbWVvdXQg
PQo+PiAKPj4gY291bGQgYmUgY29uc3QKPj4gCj4+ID4gKyAgICAgICAgICAgICBtc2Vjc190b19q
aWZmaWVzX3RpbWVvdXQoQ09ORklHX0RSTV9JOTE1X1BSRUVNUFRfVElNRU9VVCk7Cj4+ID4gKwo+
PiA+ICsgICAgIGJhcnJpZXIoKTsKPj4gCj4+IFRoaXMgbmVlZHMgYSBjb21tZW50LiBJIGZhaWwg
dG8gY29ubmVjdCB0aGUgZG90cyBhcyBqaWZmaWVzCj4+IGlzIHZvbGF0aWxlIGJ5IG5hdHVyZS4K
Pgo+IEl0J3MganVzdCBjcm9zc2luZyB0aGUgJ3QnIGFuZCBkb3R0aW5nIHRoZSAnaScuIFdoYXQg
SSB3YXMgdGhpbmtpbmcgd2FzCj4gd2UgZG9uJ3Qgd2FudCB0aGUgY29tcGlsZXIgdG8gbG9hZCBq
aWZmaWVzIHRoZW4gY29tcHV0ZSB0aGUgdGltZW91dC4gU28KPiBiYXJyaWVyKCkgdGhlcmUgc2F5
cyB0aGF0IHRpbWVvdXQgaXMgYWx3YXlzIGNvbXB1dGVkIGZpcnN0LiBOb3cgc2luY2UgaXQKPiBp
cyBsaWtlbHkgdG8gYmUgYSBmdW5jdGlvbiBjYWxsIChidXQgSSdtIHRyeWluZyB0byBmaW5kIGEg
d2F5IHRvIGxldCBpdAo+IHByZWNvbXB1dGUgdGhlIGNvbnN0YW50KSwgaXQgd2lsbCBhbHdheXMg
YmUgcHJlY29tcHV0ZWQsIGJ1dCB3aG8gdHJ1c3RzCj4gYSBjb21waWxlci4KPgo+PiA+ICsgICAg
IHJldHVybiBqaWZmaWVzICsgdGltZW91dDsKPj4gPiArfQo+PiA+ICsKPj4gPiAgc3RhdGljIHZv
aWQgZXhlY2xpc3RzX2RlcXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+PiA+
ICB7Cj4+ID4gICAgICAgc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKiBjb25zdCBleGVj
bGlzdHMgPSAmZW5naW5lLT5leGVjbGlzdHM7Cj4+ID4gQEAgLTEyMjAsNiArMTIyOSw5IEBAIHN0
YXRpYyB2b2lkIGV4ZWNsaXN0c19kZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKPj4gPiAgICAgICAgICAgICAgICpwb3J0ID0gZXhlY2xpc3RzX3NjaGVkdWxlX2luKGxhc3Qs
IHBvcnQgLSBleGVjbGlzdHMtPnBlbmRpbmcpOwo+PiA+ICAgICAgICAgICAgICAgbWVtc2V0KHBv
cnQgKyAxLCAwLCAobGFzdF9wb3J0IC0gcG9ydCkgKiBzaXplb2YoKnBvcnQpKTsKPj4gPiAgICAg
ICAgICAgICAgIGV4ZWNsaXN0c19zdWJtaXRfcG9ydHMoZW5naW5lKTsKPj4gPiArCj4+ID4gKyAg
ICAgICAgICAgICBpZiAoQ09ORklHX0RSTV9JOTE1X1BSRUVNUFRfVElNRU9VVCkKPj4gPiArICAg
ICAgICAgICAgICAgICAgICAgbW9kX3RpbWVyKCZleGVjbGlzdHMtPnRpbWVyLCBwcmVlbXB0X2V4
cGlyZXMoKSk7Cj4+ID4gICAgICAgfQo+PiA+ICB9Cj4+ID4gIAo+PiA+IEBAIC0xMzc2LDEzICsx
Mzg4LDQ4IEBAIHN0YXRpYyB2b2lkIHByb2Nlc3NfY3NiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKPj4gPiAgICAgICBpbnZhbGlkYXRlX2NzYl9lbnRyaWVzKCZidWZbMF0sICZidWZb
bnVtX2VudHJpZXMgLSAxXSk7Cj4+ID4gIH0KPj4gPiAgCj4+ID4gLXN0YXRpYyB2b2lkIF9fZXhl
Y2xpc3RzX3N1Ym1pc3Npb25fdGFza2xldChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpjb25zdCBl
bmdpbmUpCj4+ID4gK3N0YXRpYyBib29sIF9fZXhlY2xpc3RzX3N1Ym1pc3Npb25fdGFza2xldChz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpjb25zdCBlbmdpbmUpCj4+ID4gIHsKPj4gPiAgICAgICBs
b2NrZGVwX2Fzc2VydF9oZWxkKCZlbmdpbmUtPmFjdGl2ZS5sb2NrKTsKPj4gPiAgCj4+ID4gICAg
ICAgcHJvY2Vzc19jc2IoZW5naW5lKTsKPj4gPiAtICAgICBpZiAoIWVuZ2luZS0+ZXhlY2xpc3Rz
LnBlbmRpbmdbMF0pCj4+ID4gKyAgICAgaWYgKCFlbmdpbmUtPmV4ZWNsaXN0cy5wZW5kaW5nWzBd
KSB7Cj4+ID4gICAgICAgICAgICAgICBleGVjbGlzdHNfZGVxdWV1ZShlbmdpbmUpOwo+PiA+ICsg
ICAgICAgICAgICAgcmV0dXJuIHRydWU7Cj4+ID4gKyAgICAgfQo+PiA+ICsKPj4gPiArICAgICBy
ZXR1cm4gZmFsc2U7Cj4+ID4gK30KPj4gPiArCj4+ID4gK3N0YXRpYyB2b2lkIHByZWVtcHRfcmVz
ZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+PiA+ICt7Cj4+ID4gKyAgICAgY29u
c3QgdW5zaWduZWQgaW50IGJpdCA9IEk5MTVfUkVTRVRfRU5HSU5FICsgZW5naW5lLT5pZDsKPj4g
PiArICAgICB1bnNpZ25lZCBsb25nICpsb2NrID0gJmVuZ2luZS0+aTkxNS0+Z3B1X2Vycm9yLmZs
YWdzOwo+PiA+ICsKPj4gPiArICAgICBpZiAodGVzdF9hbmRfc2V0X2JpdChiaXQsIGxvY2spKQo+
PiA+ICsgICAgICAgICAgICAgcmV0dXJuOwo+PiA+ICsKPj4gPiArICAgICB0YXNrbGV0X2Rpc2Fi
bGVfbm9zeW5jKCZlbmdpbmUtPmV4ZWNsaXN0cy50YXNrbGV0KTsKPj4gPiArICAgICBzcGluX3Vu
bG9jaygmZW5naW5lLT5hY3RpdmUubG9jayk7Cj4+ID4gKwo+PiAKPj4gV2h5IGRvIHdlIG5lZWQg
dG8gZHJvcCB0aGUgbG9jaz8KPgo+IFdlIHRha2UgaXQgYWdhaW4gaW5zaWRlIHRoZSByZXNldCwg
YW5kIEkgYW0gZmFyIHRvbyBsYXp5IHRvIGxpZnQgaXQgdG8KPiB0aGUgY2FsbGVyIDopIERpc2Fi
bGluZyB0aGUgdGFza2xldCB3aWxsIHByZXZlbnQgb3RoZXIgdGhyZWFkcyBmcm9tCj4gc3VibWl0
dGluZyBhcyB3ZSBkcm9wIHRoZSBsb2NrLgoKV2l0aCB0aGUgYmFycmllciBjb21tZW50ZWQsCgpS
ZXZpZXdlZC1ieTogTWlrYSBLdW9wcGFsYSA8bWlrYS5rdW9wcGFsYUBsaW51eC5pbnRlbC5jb20+
CgpPaywgdGhlIHdheSB5b3UgZ290IHRvIHRpbWVzbGljaW5nIHdpdGggMiBsYXN0IHBhdGNoZXMg
d2FzCnZlcnkgZWxlZ2FudCwgc3VycHJpY2luZ2x5IHNvLgoKTm93IGxldHMgaG9wZSBJIHdhc24n
dCBjb21wbGV0ZWx5IGZvb2xlZCBieSB0aGUgZmlyc3Qgb25lLgpUaGVyZSBpcyBhdGxlYXN0IHNv
bWV3aGF0IHJlYXNzdXJpbmcgYW1vdW50IG9mIENJIGN5Y2xlcwpiZWhpbmQgdGhlc2UgYXQgdGhp
cyBzdGFnZS4KLU1pa2EKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwt
Z2Z4

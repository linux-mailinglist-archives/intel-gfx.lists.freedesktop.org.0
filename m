Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 477D03D71A
	for <lists+intel-gfx@lfdr.de>; Tue, 11 Jun 2019 21:43:48 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 87275891E2;
	Tue, 11 Jun 2019 19:43:46 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4430D891E2
 for <intel-gfx@lists.freedesktop.org>; Tue, 11 Jun 2019 19:43:45 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 16868896-1500050 for multiple; Tue, 11 Jun 2019 20:43:35 +0100
MIME-Version: 1.0
To: Mika Kuoppala <mika.kuoppala@linux.intel.com>,
 intel-gfx@lists.freedesktop.org
From: Chris Wilson <chris@chris-wilson.co.uk>
In-Reply-To: <20190611172731.19174-2-mika.kuoppala@linux.intel.com>
References: <20190611172731.19174-1-mika.kuoppala@linux.intel.com>
 <20190611172731.19174-2-mika.kuoppala@linux.intel.com>
Message-ID: <156028221436.2193.9167442405545791150@skylake-alporthouse-com>
User-Agent: alot/0.6
Date: Tue, 11 Jun 2019 20:43:34 +0100
Subject: Re: [Intel-gfx] [PATCH 2/9] drm/i915/gtt: Use a common type for
 page directories
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBNaWthIEt1b3BwYWxhICgyMDE5LTA2LTExIDE4OjI3OjI0KQo+IEFsbCBwYWdlIGRp
cmVjdG9yaWVzIGFyZSBpZGVudGljYWwgaW4gZnVuY3Rpb24sIG9ubHkgdGhlIHBvc2l0aW9uIGlu
IHRoZQo+IGhpZXJhcmNoeSBkaWZmZXIuIFVzZSBzYW1lIGJhc2UgdHlwZSBmb3IgZGlyZWN0b3J5
IGZ1bmN0aW9uYWxpdHkuCj4gCj4gQ2M6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29u
LmNvLnVrPgo+IENjOiBKb29uYXMgTGFodGluZW4gPGpvb25hcy5sYWh0aW5lbkBsaW51eC5pbnRl
bC5jb20+Cj4gQ2M6IE1hdHRoZXcgQXVsZCA8bWF0dGhldy53aWxsaWFtLmF1bGRAZ21haWwuY29t
Pgo+IENjOiBBYmRpZWwgSmFudWxndWUgPGFiZGllbC5qYW51bGd1ZUBsaW51eC5pbnRlbC5jb20+
Cj4gU2lnbmVkLW9mZi1ieTogTWlrYSBLdW9wcGFsYSA8bWlrYS5rdW9wcGFsYUBsaW51eC5pbnRl
bC5jb20+Cj4gLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0
LmMgfCAgIDIgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjX3JlZy5oICAg
ICB8ICAgMiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMg
IHwgICAyICstCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYyAgICAgICAg
fCAgMzAgKy0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgICAgICAgICB8
IDM0OSArKysrKysrKysrLS0tLS0tLS0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dl
bV9ndHQuaCAgICAgICAgIHwgIDY0ICsrLS0KPiAgNiBmaWxlcyBjaGFuZ2VkLCAyMzQgaW5zZXJ0
aW9ucygrKSwgMjE1IGRlbGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2NvbnRleHQuYwo+IGluZGV4IGM4NmNhOWYyMTUzMi4uZGJhYjBhYjFjZWYxIDEw
MDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMK
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCj4gQEAg
LTEwMzgsNyArMTAzOCw3IEBAIHN0YXRpYyBpbnQgZW1pdF9wcGd0dF91cGRhdGUoc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEsIHZvaWQgKmRhdGEpCj4gIAo+ICAgICAgICAgaWYgKGk5MTVfdm1faXNf
NGx2bCh2bSkpIHsKPiAgICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0ID0g
aTkxNV92bV90b19wcGd0dCh2bSk7Cj4gLSAgICAgICAgICAgICAgIGNvbnN0IGRtYV9hZGRyX3Qg
cGRfZGFkZHIgPSBweF9kbWEoJnBwZ3R0LT5wbWw0KTsKPiArICAgICAgICAgICAgICAgY29uc3Qg
ZG1hX2FkZHJfdCBwZF9kYWRkciA9IHB4X2RtYShwcGd0dC0+cGQpOwo+ICAKPiAgICAgICAgICAg
ICAgICAgY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA2KTsKPiAgICAgICAgICAgICAgICAgaWYg
KElTX0VSUihjcykpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2xyY19yZWcuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyY19yZWcuaAo+IGlu
ZGV4IDVlZjkzMmQ4MTBhNy4uNmJmMzQ3MzhiNGU1IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2xyY19yZWcuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2xyY19yZWcuaAo+IEBAIC01NSw3ICs1NSw3IEBACj4gIAo+ICAjZGVmaW5lIEFT
U0lHTl9DVFhfUE1MNChwcGd0dCwgcmVnX3N0YXRlKSBkbyB7IFwKPiAgICAgICAgIHUzMiAqcmVn
X3N0YXRlX18gPSAocmVnX3N0YXRlKTsgXAo+IC0gICAgICAgY29uc3QgdTY0IGFkZHJfXyA9IHB4
X2RtYSgmcHBndHQtPnBtbDQpOyBcCj4gKyAgICAgICBjb25zdCB1NjQgYWRkcl9fID0gcHhfZG1h
KHBwZ3R0LT5wZCk7IFwKPiAgICAgICAgIChyZWdfc3RhdGVfXylbQ1RYX1BEUDBfVURXICsgMV0g
PSB1cHBlcl8zMl9iaXRzKGFkZHJfXyk7IFwKPiAgICAgICAgIChyZWdfc3RhdGVfXylbQ1RYX1BE
UDBfTERXICsgMV0gPSBsb3dlcl8zMl9iaXRzKGFkZHJfXyk7IFwKPiAgfSB3aGlsZSAoMCkKPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCj4gaW5kZXggYzgzNGQw
MTZjOTY1Li4zYjg1Nzk5NDk0M2MgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfcmluZ2J1ZmZlci5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfcmluZ2J1ZmZlci5jCj4gQEAgLTE1MjMsNyArMTUyMyw3IEBAIHN0YXRpYyBpbnQgbG9hZF9w
ZF9kaXIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIGNvbnN0IHN0cnVjdCBpOTE1X3BwZ3R0ICpw
cGd0dCkKPiAgCj4gICAgICAgICAqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKDEpOwo+ICAg
ICAgICAgKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX1BQX0RJUl9CQVNFKGVuZ2lu
ZS0+bW1pb19iYXNlKSk7Cj4gLSAgICAgICAqY3MrKyA9IHBwZ3R0LT5wZC5iYXNlLmdndHRfb2Zm
c2V0IDw8IDEwOwo+ICsgICAgICAgKmNzKysgPSBwcGd0dC0+cGQtPmJhc2UuZ2d0dF9vZmZzZXQg
PDwgMTA7Cj4gIAo+ICAgICAgICAgaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7Cj4gIAo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKPiBpbmRleCBlMzAxZWZiMThkNDUuLmYxZTEy
NjFhYzNkYiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVy
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKPiBAQCAtMzc1
LDExICszNzUsMTMgQEAgc3RhdGljIGludCBzZXRfY29udGV4dF9wcGd0dF9mcm9tX3NoYWRvdyhz
dHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQsCj4gICAgICAgICAgICAgICAgIHJl
dHVybiAtRUlOVkFMOwo+ICAKPiAgICAgICAgIGlmIChtbS0+cHBndHRfbW0ucm9vdF9lbnRyeV90
eXBlID09IEdUVF9UWVBFX1BQR1RUX1JPT1RfTDRfRU5UUlkpIHsKPiAtICAgICAgICAgICAgICAg
cHhfZG1hKCZwcGd0dC0+cG1sNCkgPSBtbS0+cHBndHRfbW0uc2hhZG93X3BkcHNbMF07Cj4gKyAg
ICAgICAgICAgICAgIHB4X2RtYShwcGd0dC0+cGQpID0gbW0tPnBwZ3R0X21tLnNoYWRvd19wZHBz
WzBdOwo+ICAgICAgICAgfSBlbHNlIHsKPiAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8
IEdWVF9SSU5HX0NUWF9OUl9QRFBTOyBpKyspIHsKPiAtICAgICAgICAgICAgICAgICAgICAgICBw
eF9kbWEocHBndHQtPnBkcC5wYWdlX2RpcmVjdG9yeVtpXSkgPQo+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbW0tPnBwZ3R0X21tLnNoYWRvd19wZHBzW2ldOwo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICogY29uc3QgcGQgPQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaTkxNV9wZF9lbnRyeShwcGd0dC0+cGQsIGkp
Owo+ICsKPiArICAgICAgICAgICAgICAgICAgICAgICBweF9kbWEocGQpID0gbW0tPnBwZ3R0X21t
LnNoYWRvd19wZHBzW2ldOwo+ICAgICAgICAgICAgICAgICB9Cj4gICAgICAgICB9Cj4gIAo+IEBA
IC0xMTI4LDExICsxMTMwLDE0IEBAIGk5MTVfY29udGV4dF9wcGd0dF9yb290X3Jlc3RvcmUoc3Ry
dWN0IGludGVsX3ZncHVfc3VibWlzc2lvbiAqcywKPiAgICAgICAgIGludCBpOwo+ICAKPiAgICAg
ICAgIGlmIChpOTE1X3ZtX2lzXzRsdmwoJnBwZ3R0LT52bSkpIHsKPiAtICAgICAgICAgICAgICAg
cHhfZG1hKCZwcGd0dC0+cG1sNCkgPSBzLT5pOTE1X2NvbnRleHRfcG1sNDsKPiArICAgICAgICAg
ICAgICAgcHhfZG1hKHBwZ3R0LT5wZCkgPSBzLT5pOTE1X2NvbnRleHRfcG1sNDsKPiAgICAgICAg
IH0gZWxzZSB7Cj4gLSAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBHRU44XzNMVkxfUERQ
RVM7IGkrKykKPiAtICAgICAgICAgICAgICAgICAgICAgICBweF9kbWEocHBndHQtPnBkcC5wYWdl
X2RpcmVjdG9yeVtpXSkgPQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcy0+aTkx
NV9jb250ZXh0X3BkcHNbaV07Cj4gKyAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBHRU44
XzNMVkxfUERQRVM7IGkrKykgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBpOTE1
X3BhZ2VfZGlyZWN0b3J5ICogY29uc3QgcGQgPQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaTkxNV9wZF9lbnRyeShwcGd0dC0+cGQsIGkpOwo+ICsKPiArICAgICAgICAgICAgICAg
ICAgICAgICBweF9kbWEocGQpID0gcy0+aTkxNV9jb250ZXh0X3BkcHNbaV07Cj4gKyAgICAgICAg
ICAgICAgIH0KPiAgICAgICAgIH0KPiAgfQo+ICAKPiBAQCAtMTE4NiwxMSArMTE5MSwxNCBAQCBp
OTE1X2NvbnRleHRfcHBndHRfcm9vdF9zYXZlKHN0cnVjdCBpbnRlbF92Z3B1X3N1Ym1pc3Npb24g
KnMsCj4gICAgICAgICBpbnQgaTsKPiAgCj4gICAgICAgICBpZiAoaTkxNV92bV9pc180bHZsKCZw
cGd0dC0+dm0pKSB7Cj4gLSAgICAgICAgICAgICAgIHMtPmk5MTVfY29udGV4dF9wbWw0ID0gcHhf
ZG1hKCZwcGd0dC0+cG1sNCk7Cj4gKyAgICAgICAgICAgICAgIHMtPmk5MTVfY29udGV4dF9wbWw0
ID0gcHhfZG1hKHBwZ3R0LT5wZCk7Cj4gICAgICAgICB9IGVsc2Ugewo+IC0gICAgICAgICAgICAg
ICBmb3IgKGkgPSAwOyBpIDwgR0VOOF8zTFZMX1BEUEVTOyBpKyspCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgcy0+aTkxNV9jb250ZXh0X3BkcHNbaV0gPQo+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcHhfZG1hKHBwZ3R0LT5wZHAucGFnZV9kaXJlY3RvcnlbaV0pOwo+ICsgICAg
ICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgR0VOOF8zTFZMX1BEUEVTOyBpKyspIHsKPiArICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqIGNvbnN0IHBk
ID0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk5MTVfcGRfZW50cnkocHBndHQt
PnBkLCBpKTsKPiArCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcy0+aTkxNV9jb250ZXh0X3Bk
cHNbaV0gPSBweF9kbWEocGQpOwo+ICsgICAgICAgICAgICAgICB9Cj4gICAgICAgICB9Cj4gIH0K
PiAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKPiBpbmRleCAwN2Y4NmQ0NzRmYTIu
LjlhMWY5NTZhODE3YSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dl
bV9ndHQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCj4gQEAg
LTY2MSw3ICs2NjEsOCBAQCBzdGF0aWMgc3RydWN0IGk5MTVfcGFnZV90YWJsZSAqYWxsb2NfcHQo
c3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCj4gICAgICAgICAgICAgICAgIHJldHVybiBF
UlJfUFRSKC1FTk9NRU0pOwo+ICAgICAgICAgfQo+ICAKPiAtICAgICAgIGF0b21pY19zZXQoJnB0
LT51c2VkX3B0ZXMsIDApOwo+ICsgICAgICAgYXRvbWljX3NldCgmcHQtPnVzZWQsIDApOwo+ICsK
PiAgICAgICAgIHJldHVybiBwdDsKPiAgfQo+ICAKPiBAQCAtNjgzLDExICs2ODQsMjggQEAgc3Rh
dGljIHZvaWQgZ2VuNl9pbml0aWFsaXplX3B0KHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
LAo+ICAgICAgICAgZmlsbDMyX3B4KHZtLCBwdCwgdm0tPnNjcmF0Y2hfcHRlKTsKPiAgfQo+ICAK
PiArc3RhdGljIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICpfX2FsbG9jX3BkKGNvbnN0IHVu
c2lnbmVkIGludCBlbnRyaWVzKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVj
dG9yeSAqcGQ7Cj4gKwo+ICsgICAgICAgcGQgPSBrbWFsbG9jKHNpemVvZigqcGQpICsKPiArICAg
ICAgICAgICAgICAgICAgICBlbnRyaWVzICogc2l6ZW9mKHBkLT5lbnRyeVswXSksIEk5MTVfR0ZQ
X0FMTE9XX0ZBSUwpOwo+ICsKPiArICAgICAgIGlmICh1bmxpa2VseSghcGQpKQo+ICsgICAgICAg
ICAgICAgICByZXR1cm4gTlVMTDsKPiArCj4gKyAgICAgICBtZW1zZXQoJnBkLT5iYXNlLCAwLCBz
aXplb2YocGQtPmJhc2UpKTsKPiArICAgICAgIGF0b21pY19zZXQoJnBkLT51c2VkLCAwKTsKPiAr
ICAgICAgIHNwaW5fbG9ja19pbml0KCZwZC0+bG9jayk7Cj4gKwo+ICsgICAgICAgcmV0dXJuIHBk
Owo+ICt9Cj4gKwo+ICBzdGF0aWMgc3RydWN0IGk5MTVfcGFnZV9kaXJlY3RvcnkgKmFsbG9jX3Bk
KHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgaTkx
NV9wYWdlX2RpcmVjdG9yeSAqcGQ7Cj4gIAo+IC0gICAgICAgcGQgPSBrbWFsbG9jKHNpemVvZigq
cGQpLCBJOTE1X0dGUF9BTExPV19GQUlMKTsKPiArICAgICAgIHBkID0gX19hbGxvY19wZCg1MTIp
Owo+ICAgICAgICAgaWYgKHVubGlrZWx5KCFwZCkpCj4gICAgICAgICAgICAgICAgIHJldHVybiBF
UlJfUFRSKC1FTk9NRU0pOwo+ICAKPiBAQCAtNjk2LDggKzcxNCw2IEBAIHN0YXRpYyBzdHJ1Y3Qg
aTkxNV9wYWdlX2RpcmVjdG9yeSAqYWxsb2NfcGQoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm0pCj4gICAgICAgICAgICAgICAgIHJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ICAgICAgICAg
fQo+ICAKPiAtICAgICAgIGF0b21pY19zZXQoJnBkLT51c2VkX3BkZXMsIDApOwo+IC0gICAgICAg
c3Bpbl9sb2NrX2luaXQoJnBkLT5sb2NrKTsKPiAgICAgICAgIHJldHVybiBwZDsKPiAgfQo+ICAK
PiBAQCAtNzEzLDg4ICs3MjksNTYgQEAgc3RhdGljIHZvaWQgZ2VuOF9pbml0aWFsaXplX3BkKHN0
cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAo+ICB7Cj4gICAgICAgICBmaWxsX3B4KHZtLCBw
ZCwKPiAgICAgICAgICAgICAgICAgZ2VuOF9wZGVfZW5jb2RlKHB4X2RtYSh2bS0+c2NyYXRjaF9w
dCksIEk5MTVfQ0FDSEVfTExDKSk7Cj4gLSAgICAgICBtZW1zZXRfcCgodm9pZCAqKilwZC0+cGFn
ZV90YWJsZSwgdm0tPnNjcmF0Y2hfcHQsIEk5MTVfUERFUyk7Cj4gKyAgICAgICBtZW1zZXRfcChw
ZC0+ZW50cnksIHZtLT5zY3JhdGNoX3B0LCBJOTE1X1BERVMpOwo+ICB9Cj4gIAo+IC1zdGF0aWMg
aW50IF9fcGRwX2luaXQoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gLSAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5X3BvaW50ZXIgKnBkcCkKPiAr
c3RhdGljIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICphbGxvY19wZHAoc3RydWN0IGk5MTVf
YWRkcmVzc19zcGFjZSAqdm0pCj4gIHsKPiAtICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBwZHBl
cyA9IGk5MTVfcGRwZXNfcGVyX3BkcCh2bSk7Cj4gKyAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2Rp
cmVjdG9yeSAqcGRwOwo+ICAKPiAtICAgICAgIHBkcC0+cGFnZV9kaXJlY3RvcnkgPSBrbWFsbG9j
X2FycmF5KHBkcGVzLCBzaXplb2YoKnBkcC0+cGFnZV9kaXJlY3RvcnkpLAo+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSTkxNV9HRlBfQUxMT1dfRkFJTCk7Cj4g
LSAgICAgICBpZiAodW5saWtlbHkoIXBkcC0+cGFnZV9kaXJlY3RvcnkpKQo+IC0gICAgICAgICAg
ICAgICByZXR1cm4gLUVOT01FTTsKPiAtCj4gLSAgICAgICBtZW1zZXRfcCgodm9pZCAqKilwZHAt
PnBhZ2VfZGlyZWN0b3J5LCB2bS0+c2NyYXRjaF9wZCwgcGRwZXMpOwo+IC0KPiAtICAgICAgIGF0
b21pY19zZXQoJnBkcC0+dXNlZF9wZHBlcywgMCk7Cj4gLSAgICAgICBzcGluX2xvY2tfaW5pdCgm
cGRwLT5sb2NrKTsKPiAtICAgICAgIHJldHVybiAwOwo+IC19Cj4gLQo+IC1zdGF0aWMgdm9pZCBf
X3BkcF9maW5pKHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5X3BvaW50ZXIgKnBkcCkKPiAtewo+
IC0gICAgICAga2ZyZWUocGRwLT5wYWdlX2RpcmVjdG9yeSk7Cj4gLSAgICAgICBwZHAtPnBhZ2Vf
ZGlyZWN0b3J5ID0gTlVMTDsKPiAtfQo+IC0KPiAtc3RhdGljIHN0cnVjdCBpOTE1X3BhZ2VfZGly
ZWN0b3J5X3BvaW50ZXIgKgo+IC1hbGxvY19wZHAoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm0pCj4gLXsKPiAtICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5X3BvaW50ZXIgKnBk
cDsKPiAtICAgICAgIGludCByZXQgPSAtRU5PTUVNOwo+IC0KPiAtICAgICAgIEdFTV9CVUdfT04o
IWk5MTVfdm1faXNfNGx2bCh2bSkpOwo+IC0KPiAtICAgICAgIHBkcCA9IGttYWxsb2Moc2l6ZW9m
KCpwZHApLCBHRlBfS0VSTkVMKTsKPiArICAgICAgIHBkcCA9IF9fYWxsb2NfcGQoaTkxNV9wZHBl
c19wZXJfcGRwKHZtKSk7Cj4gICAgICAgICBpZiAoIXBkcCkKPiAgICAgICAgICAgICAgICAgcmV0
dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gIAo+IC0gICAgICAgcmV0ID0gX19wZHBfaW5pdCh2bSwg
cGRwKTsKPiAtICAgICAgIGlmIChyZXQpCj4gLSAgICAgICAgICAgICAgIGdvdG8gZmFpbF9iaXRt
YXA7Cj4gLQo+IC0gICAgICAgcmV0ID0gc2V0dXBfcHgodm0sIHBkcCk7Cj4gLSAgICAgICBpZiAo
cmV0KQo+IC0gICAgICAgICAgICAgICBnb3RvIGZhaWxfcGFnZV9tOwo+ICsgICAgICAgaWYgKGk5
MTVfdm1faXNfNGx2bCh2bSkpIHsKPiArICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNldHVw
X3B4KHZtLCBwZHApKSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIGtmcmVlKHBkcCk7Cj4g
KyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gKyAgICAg
ICAgICAgICAgIH0KPiArICAgICAgIH0KPiAgCj4gICAgICAgICByZXR1cm4gcGRwOwo+IC0KPiAt
ZmFpbF9wYWdlX206Cj4gLSAgICAgICBfX3BkcF9maW5pKHBkcCk7Cj4gLWZhaWxfYml0bWFwOgo+
IC0gICAgICAga2ZyZWUocGRwKTsKPiAtCj4gLSAgICAgICByZXR1cm4gRVJSX1BUUihyZXQpOwo+
ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZCBmcmVlX3BkcChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNl
ICp2bSwKPiAtICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeV9w
b2ludGVyICpwZHApCj4gKyAgICAgICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfcGFnZV9kaXJl
Y3RvcnkgKnBkcCkKPiAgewo+IC0gICAgICAgX19wZHBfZmluaShwZHApOwo+IC0KPiAtICAgICAg
IGlmICghaTkxNV92bV9pc180bHZsKHZtKSkKPiAtICAgICAgICAgICAgICAgcmV0dXJuOwo+ICsg
ICAgICAgaWYgKGk5MTVfdm1faXNfNGx2bCh2bSkpCj4gKyAgICAgICAgICAgICAgIGNsZWFudXBf
cHgodm0sIHBkcCk7Cj4gIAo+IC0gICAgICAgY2xlYW51cF9weCh2bSwgcGRwKTsKPiAgICAgICAg
IGtmcmVlKHBkcCk7Cj4gIH0KPiAgCj4gLXN0YXRpYyB2b2lkIGdlbjhfaW5pdGlhbGl6ZV9wZHAo
c3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeV9wb2ludGVyICpwZHApCj4gK3N0YXRp
YyB2b2lkIGdlbjhfaW5pdGlhbGl6ZV80bHZsX3BkcChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNl
ICp2bSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGk5MTVf
cGFnZV9kaXJlY3RvcnkgKnBkcCkKPiAgewo+ICAgICAgICAgZmlsbF9weCh2bSwgcGRwLAo+ICAg
ICAgICAgICAgICAgICBnZW44X3BkcGVfZW5jb2RlKHB4X2RtYSh2bS0+c2NyYXRjaF9wZCksIEk5
MTVfQ0FDSEVfTExDKSk7Cj4gKyAgICAgICBtZW1zZXRfcChwZHAtPmVudHJ5LCB2bS0+c2NyYXRj
aF9wZCwgNTEyKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgZ2VuOF9pbml0aWFsaXplXzNsdmxf
cGRwKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqcGRwKQo+ICt7Cj4g
KyAgICAgICBtZW1zZXRfcChwZHAtPmVudHJ5LCB2bS0+c2NyYXRjaF9wZCwgR0VOOF8zTFZMX1BE
UEVTKTsKPiAgfQo+ICAKPiAgc3RhdGljIHZvaWQgZ2VuOF9pbml0aWFsaXplX3BtbDQoc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IGk5MTVfcG1sNCAqcG1sNCkKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqcG1sNCkKPiAgewo+ICAgICAgICAgZmls
bF9weCh2bSwgcG1sNCwKPiAgICAgICAgICAgICAgICAgZ2VuOF9wbWw0ZV9lbmNvZGUocHhfZG1h
KHZtLT5zY3JhdGNoX3BkcCksIEk5MTVfQ0FDSEVfTExDKSk7Cj4gLSAgICAgICBtZW1zZXRfcCgo
dm9pZCAqKilwbWw0LT5wZHBzLCB2bS0+c2NyYXRjaF9wZHAsIEdFTjhfUE1MNEVTX1BFUl9QTUw0
KTsKPiAtICAgICAgIHNwaW5fbG9ja19pbml0KCZwbWw0LT5sb2NrKTsKPiArICAgICAgIG1lbXNl
dF9wKHBtbDQtPmVudHJ5LCB2bS0+c2NyYXRjaF9wZHAsIEdFTjhfUE1MNEVTX1BFUl9QTUw0KTsK
PiAgfQo+ICAKPiAgLyoKPiBAQCAtODIyLDggKzgwNiw4IEBAIHN0YXRpYyBib29sIGdlbjhfcHBn
dHRfY2xlYXJfcHQoY29uc3Qgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gICAgICAg
ICBtZW1zZXQ2NCh2YWRkciArIGdlbjhfcHRlX2luZGV4KHN0YXJ0KSwgdm0tPnNjcmF0Y2hfcHRl
LCBudW1fZW50cmllcyk7Cj4gICAgICAgICBrdW5tYXBfYXRvbWljKHZhZGRyKTsKPiAgCj4gLSAg
ICAgICBHRU1fQlVHX09OKG51bV9lbnRyaWVzID4gYXRvbWljX3JlYWQoJnB0LT51c2VkX3B0ZXMp
KTsKPiAtICAgICAgIHJldHVybiAhYXRvbWljX3N1Yl9yZXR1cm4obnVtX2VudHJpZXMsICZwdC0+
dXNlZF9wdGVzKTsKPiArICAgICAgIEdFTV9CVUdfT04obnVtX2VudHJpZXMgPiBhdG9taWNfcmVh
ZCgmcHQtPnVzZWQpKTsKPiArICAgICAgIHJldHVybiAhYXRvbWljX3N1Yl9yZXR1cm4obnVtX2Vu
dHJpZXMsICZwdC0+dXNlZCk7Cj4gIH0KPiAgCj4gIHN0YXRpYyB2b2lkIGdlbjhfcHBndHRfc2V0
X3BkZShzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwKPiBAQCAtODU0LDEyICs4MzgsMTIg
QEAgc3RhdGljIGJvb2wgZ2VuOF9wcGd0dF9jbGVhcl9wZChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3Nw
YWNlICp2bSwKPiAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPiAgCj4gICAgICAg
ICAgICAgICAgIHNwaW5fbG9jaygmcGQtPmxvY2spOwo+IC0gICAgICAgICAgICAgICBpZiAoIWF0
b21pY19yZWFkKCZwdC0+dXNlZF9wdGVzKSkgewo+ICsgICAgICAgICAgICAgICBpZiAoIWF0b21p
Y19yZWFkKCZwdC0+dXNlZCkpIHsKPiAgICAgICAgICAgICAgICAgICAgICAgICBnZW44X3BwZ3R0
X3NldF9wZGUodm0sIHBkLCB2bS0+c2NyYXRjaF9wdCwgcGRlKTsKPiAtICAgICAgICAgICAgICAg
ICAgICAgICBwZC0+cGFnZV90YWJsZVtwZGVdID0gdm0tPnNjcmF0Y2hfcHQ7Cj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgcGQtPmVudHJ5W3BkZV0gPSB2bS0+c2NyYXRjaF9wdDsKPiAgCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgR0VNX0JVR19PTighYXRvbWljX3JlYWQoJnBkLT51c2VkX3Bk
ZXMpKTsKPiAtICAgICAgICAgICAgICAgICAgICAgICBhdG9taWNfZGVjKCZwZC0+dXNlZF9wZGVz
KTsKPiArICAgICAgICAgICAgICAgICAgICAgICBHRU1fQlVHX09OKCFhdG9taWNfcmVhZCgmcGQt
PnVzZWQpKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBhdG9taWNfZGVjKCZwZC0+dXNlZCk7
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgZnJlZSA9IHRydWU7Cj4gICAgICAgICAgICAgICAg
IH0KPiAgICAgICAgICAgICAgICAgc3Bpbl91bmxvY2soJnBkLT5sb2NrKTsKPiBAQCAtODY3LDEx
ICs4NTEsMTEgQEAgc3RhdGljIGJvb2wgZ2VuOF9wcGd0dF9jbGVhcl9wZChzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bSwKPiAgICAgICAgICAgICAgICAgICAgICAgICBmcmVlX3B0KHZtLCBw
dCk7Cj4gICAgICAgICB9Cj4gIAo+IC0gICAgICAgcmV0dXJuICFhdG9taWNfcmVhZCgmcGQtPnVz
ZWRfcGRlcyk7Cj4gKyAgICAgICByZXR1cm4gIWF0b21pY19yZWFkKCZwZC0+dXNlZCk7Cj4gIH0K
PiAgCj4gIHN0YXRpYyB2b2lkIGdlbjhfcHBndHRfc2V0X3BkcGUoc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqdm0sCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkx
NV9wYWdlX2RpcmVjdG9yeV9wb2ludGVyICpwZHAsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqcGRwLAo+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfcGFnZV9kaXJlY3RvcnkgKnBkLAo+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHBkcGUpCj4gIHsKPiBAQCAt
ODg5LDcgKzg3Myw3IEBAIHN0YXRpYyB2b2lkIGdlbjhfcHBndHRfc2V0X3BkcGUoc3RydWN0IGk5
MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gICAqIENhbGxlciBjYW4gdXNlIHRoZSByZXR1cm4gdmFs
dWUgdG8gdXBkYXRlIGhpZ2hlci1sZXZlbCBlbnRyaWVzCj4gICAqLwo+ICBzdGF0aWMgYm9vbCBn
ZW44X3BwZ3R0X2NsZWFyX3BkcChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwKPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeV9w
b2ludGVyICpwZHAsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGk5
MTVfcGFnZV9kaXJlY3RvcnkgKiBjb25zdCBwZHAsCj4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdTY0IHN0YXJ0LCB1NjQgbGVuZ3RoKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgaTkx
NV9wYWdlX2RpcmVjdG9yeSAqcGQ7Cj4gQEAgLTkwNCwxMiArODg4LDEyIEBAIHN0YXRpYyBib29s
IGdlbjhfcHBndHRfY2xlYXJfcGRwKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+ICAKPiAgICAgICAgICAgICAgICAgc3Bp
bl9sb2NrKCZwZHAtPmxvY2spOwo+IC0gICAgICAgICAgICAgICBpZiAoIWF0b21pY19yZWFkKCZw
ZC0+dXNlZF9wZGVzKSkgewo+ICsgICAgICAgICAgICAgICBpZiAoIWF0b21pY19yZWFkKCZwZC0+
dXNlZCkpIHsKPiAgICAgICAgICAgICAgICAgICAgICAgICBnZW44X3BwZ3R0X3NldF9wZHBlKHZt
LCBwZHAsIHZtLT5zY3JhdGNoX3BkLCBwZHBlKTsKPiAtICAgICAgICAgICAgICAgICAgICAgICBw
ZHAtPnBhZ2VfZGlyZWN0b3J5W3BkcGVdID0gdm0tPnNjcmF0Y2hfcGQ7Cj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgcGRwLT5lbnRyeVtwZHBlXSA9IHZtLT5zY3JhdGNoX3BkOwo+ICAKPiAtICAg
ICAgICAgICAgICAgICAgICAgICBHRU1fQlVHX09OKCFhdG9taWNfcmVhZCgmcGRwLT51c2VkX3Bk
cGVzKSk7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgYXRvbWljX2RlYygmcGRwLT51c2VkX3Bk
cGVzKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBHRU1fQlVHX09OKCFhdG9taWNfcmVhZCgm
cGRwLT51c2VkKSk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgYXRvbWljX2RlYygmcGRwLT51
c2VkKTsKPiAgICAgICAgICAgICAgICAgICAgICAgICBmcmVlID0gdHJ1ZTsKPiAgICAgICAgICAg
ICAgICAgfQo+ICAgICAgICAgICAgICAgICBzcGluX3VubG9jaygmcGRwLT5sb2NrKTsKPiBAQCAt
OTE3LDE3ICs5MDEsMTcgQEAgc3RhdGljIGJvb2wgZ2VuOF9wcGd0dF9jbGVhcl9wZHAoc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gICAgICAgICAgICAgICAgICAgICAgICAgZnJlZV9w
ZCh2bSwgcGQpOwo+ICAgICAgICAgfQo+ICAKPiAtICAgICAgIHJldHVybiAhYXRvbWljX3JlYWQo
JnBkcC0+dXNlZF9wZHBlcyk7Cj4gKyAgICAgICByZXR1cm4gIWF0b21pY19yZWFkKCZwZHAtPnVz
ZWQpOwo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZCBnZW44X3BwZ3R0X2NsZWFyXzNsdmwoc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHU2NCBzdGFydCwgdTY0IGxlbmd0aCkKPiAgewo+IC0gICAgICAgZ2VuOF9wcGd0dF9jbGVh
cl9wZHAodm0sICZpOTE1X3ZtX3RvX3BwZ3R0KHZtKS0+cGRwLCBzdGFydCwgbGVuZ3RoKTsKPiAr
ICAgICAgIGdlbjhfcHBndHRfY2xlYXJfcGRwKHZtLCBpOTE1X3ZtX3RvX3BwZ3R0KHZtKS0+cGQs
IHN0YXJ0LCBsZW5ndGgpOwo+ICB9Cj4gIAo+IC1zdGF0aWMgdm9pZCBnZW44X3BwZ3R0X3NldF9w
bWw0ZShzdHJ1Y3QgaTkxNV9wbWw0ICpwbWw0LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5X3BvaW50ZXIgKnBkcCwKPiArc3RhdGlj
IHZvaWQgZ2VuOF9wcGd0dF9zZXRfcG1sNGUoc3RydWN0IGk5MTVfcGFnZV9kaXJlY3RvcnkgKnBt
bDQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfcGFnZV9k
aXJlY3RvcnkgKnBkcCwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25l
ZCBpbnQgcG1sNGUpCj4gIHsKPiAgICAgICAgIGdlbjhfcHBndHRfcG1sNGVfdCAqdmFkZHI7Cj4g
QEAgLTk0NSw4ICs5MjksOCBAQCBzdGF0aWMgdm9pZCBnZW44X3BwZ3R0X2NsZWFyXzRsdmwoc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHU2NCBzdGFydCwgdTY0IGxlbmd0aCkKPiAgewo+ICAgICAgICAgc3RydWN0IGk5MTVf
cHBndHQgKnBwZ3R0ID0gaTkxNV92bV90b19wcGd0dCh2bSk7Cj4gLSAgICAgICBzdHJ1Y3QgaTkx
NV9wbWw0ICpwbWw0ID0gJnBwZ3R0LT5wbWw0Owo+IC0gICAgICAgc3RydWN0IGk5MTVfcGFnZV9k
aXJlY3RvcnlfcG9pbnRlciAqcGRwOwo+ICsgICAgICAgc3RydWN0IGk5MTVfcGFnZV9kaXJlY3Rv
cnkgKiBjb25zdCBwbWw0ID0gcHBndHQtPnBkOwo+ICsgICAgICAgc3RydWN0IGk5MTVfcGFnZV9k
aXJlY3RvcnkgKnBkcDsKPiAgICAgICAgIHVuc2lnbmVkIGludCBwbWw0ZTsKPiAgCj4gICAgICAg
ICBHRU1fQlVHX09OKCFpOTE1X3ZtX2lzXzRsdmwodm0pKTsKPiBAQCAtOTU5LDkgKzk0Myw5IEBA
IHN0YXRpYyB2b2lkIGdlbjhfcHBndHRfY2xlYXJfNGx2bChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3Nw
YWNlICp2bSwKPiAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPiAgCj4gICAgICAg
ICAgICAgICAgIHNwaW5fbG9jaygmcG1sNC0+bG9jayk7Cj4gLSAgICAgICAgICAgICAgIGlmICgh
YXRvbWljX3JlYWQoJnBkcC0+dXNlZF9wZHBlcykpIHsKPiArICAgICAgICAgICAgICAgaWYgKCFh
dG9taWNfcmVhZCgmcGRwLT51c2VkKSkgewo+ICAgICAgICAgICAgICAgICAgICAgICAgIGdlbjhf
cHBndHRfc2V0X3BtbDRlKHBtbDQsIHZtLT5zY3JhdGNoX3BkcCwgcG1sNGUpOwo+IC0gICAgICAg
ICAgICAgICAgICAgICAgIHBtbDQtPnBkcHNbcG1sNGVdID0gdm0tPnNjcmF0Y2hfcGRwOwo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIHBtbDQtPmVudHJ5W3BtbDRlXSA9IHZtLT5zY3JhdGNoX3Bk
cDsKPiAgICAgICAgICAgICAgICAgICAgICAgICBmcmVlID0gdHJ1ZTsKPiAgICAgICAgICAgICAg
ICAgfQo+ICAgICAgICAgICAgICAgICBzcGluX3VubG9jaygmcG1sNC0+bG9jayk7Cj4gQEAgLTk5
OCw3ICs5ODIsNyBAQCBzdGF0aWMgX19hbHdheXNfaW5saW5lIHN0cnVjdCBnZW44X2luc2VydF9w
dGUgZ2VuOF9pbnNlcnRfcHRlKHU2NCBzdGFydCkKPiAgCj4gIHN0YXRpYyBfX2Fsd2F5c19pbmxp
bmUgYm9vbAo+ICBnZW44X3BwZ3R0X2luc2VydF9wdGVfZW50cmllcyhzdHJ1Y3QgaTkxNV9wcGd0
dCAqcHBndHQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfcGFn
ZV9kaXJlY3RvcnlfcG9pbnRlciAqcGRwLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICpwZHAsCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IHNndF9kbWEgKml0ZXIsCj4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IGdlbjhfaW5zZXJ0X3B0ZSAqaWR4LAo+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGVudW0gaTkxNV9jYWNoZV9sZXZlbCBjYWNoZV9sZXZlbCwKPiBAQCAtMTAxMCw4
ICs5OTQsOCBAQCBnZW44X3BwZ3R0X2luc2VydF9wdGVfZW50cmllcyhzdHJ1Y3QgaTkxNV9wcGd0
dCAqcHBndHQsCj4gICAgICAgICBib29sIHJldDsKPiAgCj4gICAgICAgICBHRU1fQlVHX09OKGlk
eC0+cGRwZSA+PSBpOTE1X3BkcGVzX3Blcl9wZHAoJnBwZ3R0LT52bSkpOwo+IC0gICAgICAgcGQg
PSBwZHAtPnBhZ2VfZGlyZWN0b3J5W2lkeC0+cGRwZV07Cj4gLSAgICAgICB2YWRkciA9IGttYXBf
YXRvbWljX3B4KHBkLT5wYWdlX3RhYmxlW2lkeC0+cGRlXSk7Cj4gKyAgICAgICBwZCA9IGk5MTVf
cGRfZW50cnkocGRwLCBpZHgtPnBkcGUpOwo+ICsgICAgICAgdmFkZHIgPSBrbWFwX2F0b21pY19w
eChpOTE1X3B0X2VudHJ5KHBkLCBpZHgtPnBkZSkpOwo+ICAgICAgICAgZG8gewo+ICAgICAgICAg
ICAgICAgICB2YWRkcltpZHgtPnB0ZV0gPSBwdGVfZW5jb2RlIHwgaXRlci0+ZG1hOwo+ICAKPiBA
QCAtMTA0MSwxMSArMTAyNSwxMSBAQCBnZW44X3BwZ3R0X2luc2VydF9wdGVfZW50cmllcyhzdHJ1
Y3QgaTkxNV9wcGd0dCAqcHBndHQsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9
Cj4gIAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0VNX0JVR19PTihpZHgtPnBk
cGUgPj0gaTkxNV9wZHBlc19wZXJfcGRwKCZwcGd0dC0+dm0pKTsKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHBkID0gcGRwLT5wYWdlX2RpcmVjdG9yeVtpZHgtPnBkcGVdOwo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGQgPSBwZHAtPmVudHJ5W2lkeC0+cGRwZV07
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgfQo+ICAKPiAgICAgICAgICAgICAgICAgICAgICAg
ICBrdW5tYXBfYXRvbWljKHZhZGRyKTsKPiAtICAgICAgICAgICAgICAgICAgICAgICB2YWRkciA9
IGttYXBfYXRvbWljX3B4KHBkLT5wYWdlX3RhYmxlW2lkeC0+cGRlXSk7Cj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgdmFkZHIgPSBrbWFwX2F0b21pY19weChpOTE1X3B0X2VudHJ5KHBkLCBpZHgt
PnBkZSkpOwo+ICAgICAgICAgICAgICAgICB9Cj4gICAgICAgICB9IHdoaWxlICgxKTsKPiAgICAg
ICAgIGt1bm1hcF9hdG9taWModmFkZHIpOwo+IEBAIC0xMDYyLDE0ICsxMDQ2LDE0IEBAIHN0YXRp
YyB2b2lkIGdlbjhfcHBndHRfaW5zZXJ0XzNsdmwoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm0sCj4gICAgICAgICBzdHJ1Y3Qgc2d0X2RtYSBpdGVyID0gc2d0X2RtYSh2bWEpOwo+ICAgICAg
ICAgc3RydWN0IGdlbjhfaW5zZXJ0X3B0ZSBpZHggPSBnZW44X2luc2VydF9wdGUodm1hLT5ub2Rl
LnN0YXJ0KTsKPiAgCj4gLSAgICAgICBnZW44X3BwZ3R0X2luc2VydF9wdGVfZW50cmllcyhwcGd0
dCwgJnBwZ3R0LT5wZHAsICZpdGVyLCAmaWR4LAo+ICsgICAgICAgZ2VuOF9wcGd0dF9pbnNlcnRf
cHRlX2VudHJpZXMocHBndHQsIHBwZ3R0LT5wZCwgJml0ZXIsICZpZHgsCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZV9sZXZlbCwgZmxhZ3MpOwo+ICAKPiAgICAg
ICAgIHZtYS0+cGFnZV9zaXplcy5ndHQgPSBJOTE1X0dUVF9QQUdFX1NJWkU7Cj4gIH0KPiAgCj4g
IHN0YXRpYyB2b2lkIGdlbjhfcHBndHRfaW5zZXJ0X2h1Z2VfZW50cmllcyhzdHJ1Y3QgaTkxNV92
bWEgKnZtYSwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IGk5MTVfcGFnZV9kaXJlY3RvcnlfcG9pbnRlciAqKnBkcHMsCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICpw
bWw0LAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
c2d0X2RtYSAqaXRlciwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZW51bSBpOTE1X2NhY2hlX2xldmVsIGNhY2hlX2xldmVsLAo+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1MzIgZmxhZ3MpCj4gQEAgLTEwODAsOCArMTA2NCw5
IEBAIHN0YXRpYyB2b2lkIGdlbjhfcHBndHRfaW5zZXJ0X2h1Z2VfZW50cmllcyhzdHJ1Y3QgaTkx
NV92bWEgKnZtYSwKPiAgCj4gICAgICAgICBkbyB7Cj4gICAgICAgICAgICAgICAgIHN0cnVjdCBn
ZW44X2luc2VydF9wdGUgaWR4ID0gZ2VuOF9pbnNlcnRfcHRlKHN0YXJ0KTsKPiAtICAgICAgICAg
ICAgICAgc3RydWN0IGk5MTVfcGFnZV9kaXJlY3RvcnlfcG9pbnRlciAqcGRwID0gcGRwc1tpZHgu
cG1sNGVdOwo+IC0gICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqcGQg
PSBwZHAtPnBhZ2VfZGlyZWN0b3J5W2lkeC5wZHBlXTsKPiArICAgICAgICAgICAgICAgc3RydWN0
IGk5MTVfcGFnZV9kaXJlY3RvcnkgKnBkcCA9Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgaTkx
NV9wZHBfZW50cnkocG1sNCwgaWR4LnBtbDRlKTsKPiArICAgICAgICAgICAgICAgc3RydWN0IGk5
MTVfcGFnZV9kaXJlY3RvcnkgKnBkID0gaTkxNV9wZF9lbnRyeShwZHAsIGlkeC5wZHBlKTsKPiAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHBhZ2Vfc2l6ZTsKPiAgICAgICAgICAgICAgICAg
Ym9vbCBtYXliZV82NEsgPSBmYWxzZTsKPiAgICAgICAgICAgICAgICAgZ2VuOF9wdGVfdCBlbmNv
ZGUgPSBwdGVfZW5jb2RlOwo+IEBAIC0xMDk5LDcgKzEwODQsNyBAQCBzdGF0aWMgdm9pZCBnZW44
X3BwZ3R0X2luc2VydF9odWdlX2VudHJpZXMoc3RydWN0IGk5MTVfdm1hICp2bWEsCj4gIAo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIHZhZGRyID0ga21hcF9hdG9taWNfcHgocGQpOwo+ICAgICAg
ICAgICAgICAgICB9IGVsc2Ugewo+IC0gICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBpOTE1
X3BhZ2VfdGFibGUgKnB0ID0gcGQtPnBhZ2VfdGFibGVbaWR4LnBkZV07Cj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IGk5MTVfcGFnZV90YWJsZSAqcHQgPSBpOTE1X3B0X2VudHJ5KHBk
LCBpZHgucGRlKTsKPiAgCj4gICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBpZHgucHRl
Owo+ICAgICAgICAgICAgICAgICAgICAgICAgIG1heCA9IEdFTjhfUFRFUzsKPiBAQCAtMTE3NCw3
ICsxMTU5LDggQEAgc3RhdGljIHZvaWQgZ2VuOF9wcGd0dF9pbnNlcnRfaHVnZV9lbnRyaWVzKHN0
cnVjdCBpOTE1X3ZtYSAqdm1hLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTE2
IGk7Cj4gIAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2RlID0gdm1hLT52
bS0+c2NyYXRjaF9wdGU7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWRkciA9
IGttYXBfYXRvbWljX3B4KHBkLT5wYWdlX3RhYmxlW2lkeC5wZGVdKTsKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHZhZGRyID0ga21hcF9hdG9taWNfcHgoaTkxNV9wdF9lbnRyeShw
ZCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpZHgucGRlKSk7Cj4gIAo+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZm9yIChpID0gMTsgaSA8IGluZGV4OyBpICs9IDE2KQo+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1zZXQ2NCh2YWRkciArIGksIGVuY29kZSwgMTUp
Owo+IEBAIC0xMTk0LDE1ICsxMTgwLDE2IEBAIHN0YXRpYyB2b2lkIGdlbjhfcHBndHRfaW5zZXJ0
XzRsdmwoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gIHsKPiAgICAgICAgIHN0cnVj
dCBpOTE1X3BwZ3R0ICpwcGd0dCA9IGk5MTVfdm1fdG9fcHBndHQodm0pOwo+ICAgICAgICAgc3Ry
dWN0IHNndF9kbWEgaXRlciA9IHNndF9kbWEodm1hKTsKPiAtICAgICAgIHN0cnVjdCBpOTE1X3Bh
Z2VfZGlyZWN0b3J5X3BvaW50ZXIgKipwZHBzID0gcHBndHQtPnBtbDQucGRwczsKPiArICAgICAg
IHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICogY29uc3QgcG1sNCA9IHBwZ3R0LT5wZDsKPiAg
Cj4gICAgICAgICBpZiAodm1hLT5wYWdlX3NpemVzLnNnID4gSTkxNV9HVFRfUEFHRV9TSVpFKSB7
Cj4gLSAgICAgICAgICAgICAgIGdlbjhfcHBndHRfaW5zZXJ0X2h1Z2VfZW50cmllcyh2bWEsIHBk
cHMsICZpdGVyLCBjYWNoZV9sZXZlbCwKPiArICAgICAgICAgICAgICAgZ2VuOF9wcGd0dF9pbnNl
cnRfaHVnZV9lbnRyaWVzKHZtYSwgcG1sNCwgJml0ZXIsIGNhY2hlX2xldmVsLAo+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxhZ3MpOwo+ICAgICAgICAg
fSBlbHNlIHsKPiAgICAgICAgICAgICAgICAgc3RydWN0IGdlbjhfaW5zZXJ0X3B0ZSBpZHggPSBn
ZW44X2luc2VydF9wdGUodm1hLT5ub2RlLnN0YXJ0KTsKPiAgCj4gLSAgICAgICAgICAgICAgIHdo
aWxlIChnZW44X3BwZ3R0X2luc2VydF9wdGVfZW50cmllcyhwcGd0dCwgcGRwc1tpZHgucG1sNGUr
K10sCj4gKyAgICAgICAgICAgICAgIHdoaWxlIChnZW44X3BwZ3R0X2luc2VydF9wdGVfZW50cmll
cyhwcGd0dCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGk5MTVfcGRwX2VudHJ5KHBtbDQsIGlkeC5wbWw0ZSsrKSwKPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZpdGVyLCAmaWR4LCBjYWNo
ZV9sZXZlbCwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGZsYWdzKSkKPiAgICAgICAgICAgICAgICAgICAgICAgICBHRU1fQlVHX09OKGlkeC5w
bWw0ZSA+PSBHRU44X1BNTDRFU19QRVJfUE1MNCk7Cj4gQEAgLTEyMTcsOCArMTIwNCw4IEBAIHN0
YXRpYyB2b2lkIGdlbjhfZnJlZV9wYWdlX3RhYmxlcyhzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNl
ICp2bSwKPiAgICAgICAgIGludCBpOwo+ICAKPiAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBJOTE1
X1BERVM7IGkrKykgewo+IC0gICAgICAgICAgICAgICBpZiAocGQtPnBhZ2VfdGFibGVbaV0gIT0g
dm0tPnNjcmF0Y2hfcHQpCj4gLSAgICAgICAgICAgICAgICAgICAgICAgZnJlZV9wdCh2bSwgcGQt
PnBhZ2VfdGFibGVbaV0pOwo+ICsgICAgICAgICAgICAgICBpZiAocGQtPmVudHJ5W2ldICE9IHZt
LT5zY3JhdGNoX3B0KQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGZyZWVfcHQodm0sIHBkLT5l
bnRyeVtpXSk7Cj4gICAgICAgICB9Cj4gIH0KPiAgCj4gQEAgLTEyNzcsNyArMTI2NCw3IEBAIHN0
YXRpYyBpbnQgZ2VuOF9pbml0X3NjcmF0Y2goc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0p
Cj4gICAgICAgICBnZW44X2luaXRpYWxpemVfcHQodm0sIHZtLT5zY3JhdGNoX3B0KTsKPiAgICAg
ICAgIGdlbjhfaW5pdGlhbGl6ZV9wZCh2bSwgdm0tPnNjcmF0Y2hfcGQpOwo+ICAgICAgICAgaWYg
KGk5MTVfdm1faXNfNGx2bCh2bSkpCj4gLSAgICAgICAgICAgICAgIGdlbjhfaW5pdGlhbGl6ZV9w
ZHAodm0sIHZtLT5zY3JhdGNoX3BkcCk7Cj4gKyAgICAgICAgICAgICAgIGdlbjhfaW5pdGlhbGl6
ZV80bHZsX3BkcCh2bSwgdm0tPnNjcmF0Y2hfcGRwKTsKPiAgCj4gICAgICAgICByZXR1cm4gMDsK
PiAgCj4gQEAgLTEyOTksNyArMTI4Niw3IEBAIHN0YXRpYyBpbnQgZ2VuOF9wcGd0dF9ub3RpZnlf
dmd0KHN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCwgYm9vbCBjcmVhdGUpCj4gICAgICAgICBpbnQg
aTsKPiAgCj4gICAgICAgICBpZiAoaTkxNV92bV9pc180bHZsKHZtKSkgewo+IC0gICAgICAgICAg
ICAgICBjb25zdCB1NjQgZGFkZHIgPSBweF9kbWEoJnBwZ3R0LT5wbWw0KTsKPiArICAgICAgICAg
ICAgICAgY29uc3QgdTY0IGRhZGRyID0gcHhfZG1hKHBwZ3R0LT5wZCk7Cj4gIAo+ICAgICAgICAg
ICAgICAgICBJOTE1X1dSSVRFKHZndGlmX3JlZyhwZHBbMF0ubG8pLCBsb3dlcl8zMl9iaXRzKGRh
ZGRyKSk7Cj4gICAgICAgICAgICAgICAgIEk5MTVfV1JJVEUodmd0aWZfcmVnKHBkcFswXS5oaSks
IHVwcGVyXzMyX2JpdHMoZGFkZHIpKTsKPiBAQCAtMTMzNiwxNyArMTMyMywxNyBAQCBzdGF0aWMg
dm9pZCBnZW44X2ZyZWVfc2NyYXRjaChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKPiAg
fQo+ICAKPiAgc3RhdGljIHZvaWQgZ2VuOF9wcGd0dF9jbGVhbnVwXzNsdmwoc3RydWN0IGk5MTVf
YWRkcmVzc19zcGFjZSAqdm0sCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IGk5MTVfcGFnZV9kaXJlY3RvcnlfcG9pbnRlciAqcGRwKQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICpwZHApCj4g
IHsKPiAgICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBwZHBlcyA9IGk5MTVfcGRwZXNfcGVyX3Bk
cCh2bSk7Cj4gICAgICAgICBpbnQgaTsKPiAgCj4gICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGRw
ZXM7IGkrKykgewo+IC0gICAgICAgICAgICAgICBpZiAocGRwLT5wYWdlX2RpcmVjdG9yeVtpXSA9
PSB2bS0+c2NyYXRjaF9wZCkKPiArICAgICAgICAgICAgICAgaWYgKHBkcC0+ZW50cnlbaV0gPT0g
dm0tPnNjcmF0Y2hfcGQpCj4gICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7Cj4gIAo+
IC0gICAgICAgICAgICAgICBnZW44X2ZyZWVfcGFnZV90YWJsZXModm0sIHBkcC0+cGFnZV9kaXJl
Y3RvcnlbaV0pOwo+IC0gICAgICAgICAgICAgICBmcmVlX3BkKHZtLCBwZHAtPnBhZ2VfZGlyZWN0
b3J5W2ldKTsKPiArICAgICAgICAgICAgICAgZ2VuOF9mcmVlX3BhZ2VfdGFibGVzKHZtLCBwZHAt
PmVudHJ5W2ldKTsKPiArICAgICAgICAgICAgICAgZnJlZV9wZCh2bSwgcGRwLT5lbnRyeVtpXSk7
Cj4gICAgICAgICB9Cj4gIAo+ICAgICAgICAgZnJlZV9wZHAodm0sIHBkcCk7Cj4gQEAgLTEzNTQs
MTYgKzEzNDEsMTkgQEAgc3RhdGljIHZvaWQgZ2VuOF9wcGd0dF9jbGVhbnVwXzNsdmwoc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gIAo+ICBzdGF0aWMgdm9pZCBnZW44X3BwZ3R0X2Ns
ZWFudXBfNGx2bChzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQpCj4gIHsKPiArICAgICAgIHN0cnVj
dCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICogY29uc3QgcG1sNCA9IHBwZ3R0LT5wZDsKPiAgICAgICAg
IGludCBpOwo+ICAKPiAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBHRU44X1BNTDRFU19QRVJfUE1M
NDsgaSsrKSB7Cj4gLSAgICAgICAgICAgICAgIGlmIChwcGd0dC0+cG1sNC5wZHBzW2ldID09IHBw
Z3R0LT52bS5zY3JhdGNoX3BkcCkKPiArICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfcGFnZV9k
aXJlY3RvcnkgKnBkcCA9IGk5MTVfcGRwX2VudHJ5KHBtbDQsIGkpOwo+ICsKPiArICAgICAgICAg
ICAgICAgaWYgKHBkcCA9PSBwcGd0dC0+dm0uc2NyYXRjaF9wZHApCj4gICAgICAgICAgICAgICAg
ICAgICAgICAgY29udGludWU7Cj4gIAo+IC0gICAgICAgICAgICAgICBnZW44X3BwZ3R0X2NsZWFu
dXBfM2x2bCgmcHBndHQtPnZtLCBwcGd0dC0+cG1sNC5wZHBzW2ldKTsKPiArICAgICAgICAgICAg
ICAgZ2VuOF9wcGd0dF9jbGVhbnVwXzNsdmwoJnBwZ3R0LT52bSwgcGRwKTsKPiAgICAgICAgIH0K
PiAgCj4gLSAgICAgICBjbGVhbnVwX3B4KCZwcGd0dC0+dm0sICZwcGd0dC0+cG1sNCk7Cj4gKyAg
ICAgICBjbGVhbnVwX3B4KCZwcGd0dC0+dm0sIHBtbDQpOwo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9p
ZCBnZW44X3BwZ3R0X2NsZWFudXAoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCj4gQEAg
LTEzNzcsNyArMTM2Nyw3IEBAIHN0YXRpYyB2b2lkIGdlbjhfcHBndHRfY2xlYW51cChzdHJ1Y3Qg
aTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKPiAgICAgICAgIGlmIChpOTE1X3ZtX2lzXzRsdmwodm0p
KQo+ICAgICAgICAgICAgICAgICBnZW44X3BwZ3R0X2NsZWFudXBfNGx2bChwcGd0dCk7Cj4gICAg
ICAgICBlbHNlCj4gLSAgICAgICAgICAgICAgIGdlbjhfcHBndHRfY2xlYW51cF8zbHZsKCZwcGd0
dC0+dm0sICZwcGd0dC0+cGRwKTsKPiArICAgICAgICAgICAgICAgZ2VuOF9wcGd0dF9jbGVhbnVw
XzNsdmwoJnBwZ3R0LT52bSwgcHBndHQtPnBkKTsKPiAgCj4gICAgICAgICBnZW44X2ZyZWVfc2Ny
YXRjaCh2bSk7Cj4gIH0KPiBAQCAtMTQwNiwxMCArMTM5NiwxMCBAQCBzdGF0aWMgaW50IGdlbjhf
cHBndHRfYWxsb2NfcGQoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gICAgICAgICAg
ICAgICAgICAgICAgICAgaWYgKGNvdW50IDwgR0VOOF9QVEVTIHx8IGludGVsX3ZncHVfYWN0aXZl
KHZtLT5pOTE1KSkKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdlbjhfaW5pdGlh
bGl6ZV9wdCh2bSwgcHQpOwo+ICAKPiAtICAgICAgICAgICAgICAgICAgICAgICBvbGQgPSBjbXB4
Y2hnKCZwZC0+cGFnZV90YWJsZVtwZGVdLCB2bS0+c2NyYXRjaF9wdCwgcHQpOwo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIG9sZCA9IGNtcHhjaGcoJnBkLT5lbnRyeVtwZGVdLCB2bS0+c2NyYXRj
aF9wdCwgcHQpOwo+ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvbGQgPT0gdm0tPnNjcmF0
Y2hfcHQpIHsKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdlbjhfcHBndHRfc2V0
X3BkZSh2bSwgcGQsIHB0LCBwZGUpOwo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YXRvbWljX2luYygmcGQtPnVzZWRfcGRlcyk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBhdG9taWNfaW5jKCZwZC0+dXNlZCk7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgfSBl
bHNlIHsKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyZWVfcHQodm0sIHB0KTsK
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB0ID0gb2xkOwo+IEBAIC0xNDE4LDcg
KzE0MDgsNyBAQCBzdGF0aWMgaW50IGdlbjhfcHBndHRfYWxsb2NfcGQoc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm0sCj4gICAgICAgICAgICAgICAgICAgICAgICAgc3Bpbl9sb2NrKCZwZC0+
bG9jayk7Cj4gICAgICAgICAgICAgICAgIH0KPiAgCj4gLSAgICAgICAgICAgICAgIGF0b21pY19h
ZGQoY291bnQsICZwdC0+dXNlZF9wdGVzKTsKPiArICAgICAgICAgICAgICAgYXRvbWljX2FkZChj
b3VudCwgJnB0LT51c2VkKTsKPiAgICAgICAgIH0KPiAgICAgICAgIHNwaW5fdW5sb2NrKCZwZC0+
bG9jayk7Cj4gIAo+IEBAIC0xNDMwLDcgKzE0MjAsNyBAQCBzdGF0aWMgaW50IGdlbjhfcHBndHRf
YWxsb2NfcGQoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gIH0KPiAgCj4gIHN0YXRp
YyBpbnQgZ2VuOF9wcGd0dF9hbGxvY19wZHAoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0s
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RpcmVj
dG9yeV9wb2ludGVyICpwZHAsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqcGRwLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdTY0IHN0YXJ0LCB1NjQgbGVuZ3RoKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgaTkxNV9w
YWdlX2RpcmVjdG9yeSAqcGQ7Cj4gQEAgLTE0NTEsMTEgKzE0NDEsMTAgQEAgc3RhdGljIGludCBn
ZW44X3BwZ3R0X2FsbG9jX3BkcChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwKPiAgCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgZ2VuOF9pbml0aWFsaXplX3BkKHZtLCBwZCk7Cj4gIAo+
IC0gICAgICAgICAgICAgICAgICAgICAgIG9sZCA9IGNtcHhjaGcoJnBkcC0+cGFnZV9kaXJlY3Rv
cnlbcGRwZV0sCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bS0+c2Ny
YXRjaF9wZCwgcGQpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIG9sZCA9IGNtcHhjaGcoJnBk
cC0+ZW50cnlbcGRwZV0sIHZtLT5zY3JhdGNoX3BkLCBwZCk7Cj4gICAgICAgICAgICAgICAgICAg
ICAgICAgaWYgKG9sZCA9PSB2bS0+c2NyYXRjaF9wZCkgewo+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZ2VuOF9wcGd0dF9zZXRfcGRwZSh2bSwgcGRwLCBwZCwgcGRwZSk7Cj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdG9taWNfaW5jKCZwZHAtPnVzZWRfcGRwZXMp
Owo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRvbWljX2luYygmcGRwLT51c2Vk
KTsKPiAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugewo+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZnJlZV9wZCh2bSwgcGQpOwo+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcGQgPSBvbGQ7Cj4gQEAgLTE0NjMsNyArMTQ1Miw3IEBAIHN0YXRpYyBpbnQgZ2Vu
OF9wcGd0dF9hbGxvY19wZHAoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gIAo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIHNwaW5fbG9jaygmcGRwLT5sb2NrKTsKPiAgICAgICAgICAg
ICAgICAgfQo+IC0gICAgICAgICAgICAgICBhdG9taWNfaW5jKCZwZC0+dXNlZF9wZGVzKTsKPiAr
ICAgICAgICAgICAgICAgYXRvbWljX2luYygmcGQtPnVzZWQpOwo+ICAgICAgICAgICAgICAgICBz
cGluX3VubG9jaygmcGRwLT5sb2NrKTsKPiAgCj4gICAgICAgICAgICAgICAgIHJldCA9IGdlbjhf
cHBndHRfYWxsb2NfcGQodm0sIHBkLCBzdGFydCwgbGVuZ3RoKTsKPiBAQCAtMTQ3MSw3ICsxNDYw
LDcgQEAgc3RhdGljIGludCBnZW44X3BwZ3R0X2FsbG9jX3BkcChzdHJ1Y3QgaTkxNV9hZGRyZXNz
X3NwYWNlICp2bSwKPiAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIHVud2luZF9wZDsKPiAg
Cj4gICAgICAgICAgICAgICAgIHNwaW5fbG9jaygmcGRwLT5sb2NrKTsKPiAtICAgICAgICAgICAg
ICAgYXRvbWljX2RlYygmcGQtPnVzZWRfcGRlcyk7Cj4gKyAgICAgICAgICAgICAgIGF0b21pY19k
ZWMoJnBkLT51c2VkKTsKPiAgICAgICAgIH0KPiAgICAgICAgIHNwaW5fdW5sb2NrKCZwZHAtPmxv
Y2spOwo+ICAKPiBAQCAtMTQ3OSwxMCArMTQ2OCwxMCBAQCBzdGF0aWMgaW50IGdlbjhfcHBndHRf
YWxsb2NfcGRwKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAo+ICAKPiAgdW53aW5kX3Bk
Ogo+ICAgICAgICAgc3Bpbl9sb2NrKCZwZHAtPmxvY2spOwo+IC0gICAgICAgaWYgKGF0b21pY19k
ZWNfYW5kX3Rlc3QoJnBkLT51c2VkX3BkZXMpKSB7Cj4gKyAgICAgICBpZiAoYXRvbWljX2RlY19h
bmRfdGVzdCgmcGQtPnVzZWQpKSB7Cj4gICAgICAgICAgICAgICAgIGdlbjhfcHBndHRfc2V0X3Bk
cGUodm0sIHBkcCwgdm0tPnNjcmF0Y2hfcGQsIHBkcGUpOwo+IC0gICAgICAgICAgICAgICBHRU1f
QlVHX09OKCFhdG9taWNfcmVhZCgmcGRwLT51c2VkX3BkcGVzKSk7Cj4gLSAgICAgICAgICAgICAg
IGF0b21pY19kZWMoJnBkcC0+dXNlZF9wZHBlcyk7Cj4gKyAgICAgICAgICAgICAgIEdFTV9CVUdf
T04oIWF0b21pY19yZWFkKCZwZHAtPnVzZWQpKTsKPiArICAgICAgICAgICAgICAgYXRvbWljX2Rl
YygmcGRwLT51c2VkKTsKPiAgICAgICAgICAgICAgICAgZnJlZV9wZCh2bSwgcGQpOwo+ICAgICAg
ICAgfQo+ICAgICAgICAgc3Bpbl91bmxvY2soJnBkcC0+bG9jayk7Cj4gQEAgLTE0OTUsMjMgKzE0
ODQsMjQgQEAgc3RhdGljIGludCBnZW44X3BwZ3R0X2FsbG9jXzNsdmwoc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm0sCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTY0IHN0
YXJ0LCB1NjQgbGVuZ3RoKQo+ICB7Cj4gICAgICAgICByZXR1cm4gZ2VuOF9wcGd0dF9hbGxvY19w
ZHAodm0sCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmk5MTVfdm1fdG9f
cHBndHQodm0pLT5wZHAsIHN0YXJ0LCBsZW5ndGgpOwo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGk5MTVfdm1fdG9fcHBndHQodm0pLT5wZCwgc3RhcnQsIGxlbmd0aCk7Cj4g
IH0KPiAgCj4gIHN0YXRpYyBpbnQgZ2VuOF9wcGd0dF9hbGxvY180bHZsKHN0cnVjdCBpOTE1X2Fk
ZHJlc3Nfc3BhY2UgKnZtLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHU2NCBz
dGFydCwgdTY0IGxlbmd0aCkKPiAgewo+ICAgICAgICAgc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0
ID0gaTkxNV92bV90b19wcGd0dCh2bSk7Cj4gLSAgICAgICBzdHJ1Y3QgaTkxNV9wbWw0ICpwbWw0
ID0gJnBwZ3R0LT5wbWw0Owo+IC0gICAgICAgc3RydWN0IGk5MTVfcGFnZV9kaXJlY3RvcnlfcG9p
bnRlciAqcGRwOwo+ICsgICAgICAgc3RydWN0IGk5MTVfcGFnZV9kaXJlY3RvcnkgKiBjb25zdCBw
bWw0ID0gcHBndHQtPnBkOwo+ICsgICAgICAgc3RydWN0IGk5MTVfcGFnZV9kaXJlY3RvcnkgKnBk
cDsKPiAgICAgICAgIHU2NCBmcm9tID0gc3RhcnQ7Cj4gICAgICAgICB1MzIgcG1sNGU7Cj4gICAg
ICAgICBpbnQgcmV0Owo+ICAKPiAgICAgICAgIHNwaW5fbG9jaygmcG1sNC0+bG9jayk7Cj4gICAg
ICAgICBnZW44X2Zvcl9lYWNoX3BtbDRlKHBkcCwgcG1sNCwgc3RhcnQsIGxlbmd0aCwgcG1sNGUp
IHsKPiArCj4gICAgICAgICAgICAgICAgIGlmIChwZHAgPT0gdm0tPnNjcmF0Y2hfcGRwKSB7Cj4g
LSAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfcGFnZV9kaXJlY3RvcnlfcG9pbnRl
ciAqb2xkOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0
b3J5ICpvbGQ7Cj4gIAo+ICAgICAgICAgICAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZwbWw0
LT5sb2NrKTsKPiAgCj4gQEAgLTE1MTksOSArMTUwOSw5IEBAIHN0YXRpYyBpbnQgZ2VuOF9wcGd0
dF9hbGxvY180bHZsKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAo+ICAgICAgICAgICAg
ICAgICAgICAgICAgIGlmIChJU19FUlIocGRwKSkKPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGdvdG8gdW53aW5kOwo+ICAKPiAtICAgICAgICAgICAgICAgICAgICAgICBnZW44X2lu
aXRpYWxpemVfcGRwKHZtLCBwZHApOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGdlbjhfaW5p
dGlhbGl6ZV80bHZsX3BkcCh2bSwgcGRwKTsKPiAgCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
b2xkID0gY21weGNoZygmcG1sNC0+cGRwc1twbWw0ZV0sIHZtLT5zY3JhdGNoX3BkcCwgcGRwKTsK
PiArICAgICAgICAgICAgICAgICAgICAgICBvbGQgPSBjbXB4Y2hnKCZwbWw0LT5lbnRyeVtwbWw0
ZV0sIHZtLT5zY3JhdGNoX3BkcCwgcGRwKTsKPiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAo
b2xkID09IHZtLT5zY3JhdGNoX3BkcCkgewo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZ2VuOF9wcGd0dF9zZXRfcG1sNGUocG1sNCwgcGRwLCBwbWw0ZSk7Cj4gICAgICAgICAgICAg
ICAgICAgICAgICAgfSBlbHNlIHsKPiBAQCAtMTUzMSw3ICsxNTIxLDcgQEAgc3RhdGljIGludCBn
ZW44X3BwZ3R0X2FsbG9jXzRsdmwoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gIAo+
ICAgICAgICAgICAgICAgICAgICAgICAgIHNwaW5fbG9jaygmcG1sNC0+bG9jayk7Cj4gICAgICAg
ICAgICAgICAgIH0KPiAtICAgICAgICAgICAgICAgYXRvbWljX2luYygmcGRwLT51c2VkX3BkcGVz
KTsKPiArICAgICAgICAgICAgICAgYXRvbWljX2luYygmcGRwLT51c2VkKTsKPiAgICAgICAgICAg
ICAgICAgc3Bpbl91bmxvY2soJnBtbDQtPmxvY2spOwo+ICAKPiAgICAgICAgICAgICAgICAgcmV0
ID0gZ2VuOF9wcGd0dF9hbGxvY19wZHAodm0sIHBkcCwgc3RhcnQsIGxlbmd0aCk7Cj4gQEAgLTE1
MzksNyArMTUyOSw3IEBAIHN0YXRpYyBpbnQgZ2VuOF9wcGd0dF9hbGxvY180bHZsKHN0cnVjdCBp
OTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAo+ICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gdW53
aW5kX3BkcDsKPiAgCj4gICAgICAgICAgICAgICAgIHNwaW5fbG9jaygmcG1sNC0+bG9jayk7Cj4g
LSAgICAgICAgICAgICAgIGF0b21pY19kZWMoJnBkcC0+dXNlZF9wZHBlcyk7Cj4gKyAgICAgICAg
ICAgICAgIGF0b21pY19kZWMoJnBkcC0+dXNlZCk7Cj4gICAgICAgICB9Cj4gICAgICAgICBzcGlu
X3VubG9jaygmcG1sNC0+bG9jayk7Cj4gIAo+IEBAIC0xNTQ3LDcgKzE1MzcsNyBAQCBzdGF0aWMg
aW50IGdlbjhfcHBndHRfYWxsb2NfNGx2bChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwK
PiAgCj4gIHVud2luZF9wZHA6Cj4gICAgICAgICBzcGluX2xvY2soJnBtbDQtPmxvY2spOwo+IC0g
ICAgICAgaWYgKGF0b21pY19kZWNfYW5kX3Rlc3QoJnBkcC0+dXNlZF9wZHBlcykpIHsKPiArICAg
ICAgIGlmIChhdG9taWNfZGVjX2FuZF90ZXN0KCZwZHAtPnVzZWQpKSB7Cj4gICAgICAgICAgICAg
ICAgIGdlbjhfcHBndHRfc2V0X3BtbDRlKHBtbDQsIHZtLT5zY3JhdGNoX3BkcCwgcG1sNGUpOwo+
ICAgICAgICAgICAgICAgICBmcmVlX3BkcCh2bSwgcGRwKTsKPiAgICAgICAgIH0KPiBAQCAtMTU2
MCw3ICsxNTUwLDcgQEAgc3RhdGljIGludCBnZW44X3BwZ3R0X2FsbG9jXzRsdmwoc3RydWN0IGk5
MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gIHN0YXRpYyBpbnQgZ2VuOF9wcmVhbGxvY2F0ZV90b3Bf
bGV2ZWxfcGRwKHN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCkKPiAgewo+ICAgICAgICAgc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSAmcHBndHQtPnZtOwo+IC0gICAgICAgc3RydWN0IGk5
MTVfcGFnZV9kaXJlY3RvcnlfcG9pbnRlciAqcGRwID0gJnBwZ3R0LT5wZHA7Cj4gKyAgICAgICBz
dHJ1Y3QgaTkxNV9wYWdlX2RpcmVjdG9yeSAqcGRwID0gcHBndHQtPnBkOwo+ICAgICAgICAgc3Ry
dWN0IGk5MTVfcGFnZV9kaXJlY3RvcnkgKnBkOwo+ICAgICAgICAgdTY0IHN0YXJ0ID0gMCwgbGVu
Z3RoID0gcHBndHQtPnZtLnRvdGFsOwo+ICAgICAgICAgdTY0IGZyb20gPSBzdGFydDsKPiBAQCAt
MTU3MywxMCArMTU2MywxMiBAQCBzdGF0aWMgaW50IGdlbjhfcHJlYWxsb2NhdGVfdG9wX2xldmVs
X3BkcChzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQpCj4gIAo+ICAgICAgICAgICAgICAgICBnZW44
X2luaXRpYWxpemVfcGQodm0sIHBkKTsKPiAgICAgICAgICAgICAgICAgZ2VuOF9wcGd0dF9zZXRf
cGRwZSh2bSwgcGRwLCBwZCwgcGRwZSk7Cj4gLSAgICAgICAgICAgICAgIGF0b21pY19pbmMoJnBk
cC0+dXNlZF9wZHBlcyk7Cj4gKwo+ICsgICAgICAgICAgICAgICBhdG9taWNfaW5jKCZwZHAtPnVz
ZWQpOwo+ICAgICAgICAgfQo+ICAKPiAtICAgICAgIGF0b21pY19pbmMoJnBkcC0+dXNlZF9wZHBl
cyk7IC8qIG5ldmVyIHJlbW92ZSAqLwo+ICsgICAgICAgYXRvbWljX2luYygmcGRwLT51c2VkKTsg
LyogbmV2ZXIgcmVtb3ZlICovCj4gKwo+ICAgICAgICAgcmV0dXJuIDA7Cj4gIAo+ICB1bndpbmQ6
Cj4gQEAgLTE1ODUsNyArMTU3Nyw3IEBAIHN0YXRpYyBpbnQgZ2VuOF9wcmVhbGxvY2F0ZV90b3Bf
bGV2ZWxfcGRwKHN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCkKPiAgICAgICAgICAgICAgICAgZ2Vu
OF9wcGd0dF9zZXRfcGRwZSh2bSwgcGRwLCB2bS0+c2NyYXRjaF9wZCwgcGRwZSk7Cj4gICAgICAg
ICAgICAgICAgIGZyZWVfcGQodm0sIHBkKTsKPiAgICAgICAgIH0KPiAtICAgICAgIGF0b21pY19z
ZXQoJnBkcC0+dXNlZF9wZHBlcywgMCk7Cj4gKyAgICAgICBhdG9taWNfc2V0KCZwZHAtPnVzZWQs
IDApOwo+ICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gIH0KPiAgCj4gQEAgLTE2NDAsMjcgKzE2
MzIsMjUgQEAgc3RhdGljIHN0cnVjdCBpOTE1X3BwZ3R0ICpnZW44X3BwZ3R0X2NyZWF0ZShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgICAgICAgIGlmIChlcnIpCj4gICAgICAgICAg
ICAgICAgIGdvdG8gZXJyX2ZyZWU7Cj4gIAo+IC0gICAgICAgaWYgKGk5MTVfdm1faXNfNGx2bCgm
cHBndHQtPnZtKSkgewo+IC0gICAgICAgICAgICAgICBlcnIgPSBzZXR1cF9weCgmcHBndHQtPnZt
LCAmcHBndHQtPnBtbDQpOwo+IC0gICAgICAgICAgICAgICBpZiAoZXJyKQo+IC0gICAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gZXJyX3NjcmF0Y2g7Cj4gKyAgICAgICBwcGd0dC0+cGQgPSBhbGxv
Y19wZHAoJnBwZ3R0LT52bSk7Cj4gKyAgICAgICBpZiAoSVNfRVJSKHBwZ3R0LT5wZCkpIHsKPiAr
ICAgICAgICAgICAgICAgZXJyID0gUFRSX0VSUihwcGd0dC0+cGQpOwo+ICsgICAgICAgICAgICAg
ICBnb3RvIGVycl9zY3JhdGNoOwo+ICsgICAgICAgfQo+ICAKPiAtICAgICAgICAgICAgICAgZ2Vu
OF9pbml0aWFsaXplX3BtbDQoJnBwZ3R0LT52bSwgJnBwZ3R0LT5wbWw0KTsKPiArICAgICAgIGlm
IChpOTE1X3ZtX2lzXzRsdmwoJnBwZ3R0LT52bSkpIHsKPiArICAgICAgICAgICAgICAgZ2VuOF9p
bml0aWFsaXplX3BtbDQoJnBwZ3R0LT52bSwgcHBndHQtPnBkKTsKPiAgCj4gICAgICAgICAgICAg
ICAgIHBwZ3R0LT52bS5hbGxvY2F0ZV92YV9yYW5nZSA9IGdlbjhfcHBndHRfYWxsb2NfNGx2bDsK
PiAgICAgICAgICAgICAgICAgcHBndHQtPnZtLmluc2VydF9lbnRyaWVzID0gZ2VuOF9wcGd0dF9p
bnNlcnRfNGx2bDsKPiAgICAgICAgICAgICAgICAgcHBndHQtPnZtLmNsZWFyX3JhbmdlID0gZ2Vu
OF9wcGd0dF9jbGVhcl80bHZsOwo+ICAgICAgICAgfSBlbHNlIHsKPiAtICAgICAgICAgICAgICAg
ZXJyID0gX19wZHBfaW5pdCgmcHBndHQtPnZtLCAmcHBndHQtPnBkcCk7Cj4gLSAgICAgICAgICAg
ICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfc2NyYXRjaDsK
PiArICAgICAgICAgICAgICAgZ2VuOF9pbml0aWFsaXplXzNsdmxfcGRwKCZwcGd0dC0+dm0sIHBw
Z3R0LT5wZCk7Cj4gIAo+ICAgICAgICAgICAgICAgICBpZiAoaW50ZWxfdmdwdV9hY3RpdmUoaTkx
NSkpIHsKPiAgICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSBnZW44X3ByZWFsbG9jYXRlX3Rv
cF9sZXZlbF9wZHAocHBndHQpOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHsK
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fcGRwX2ZpbmkoJnBwZ3R0LT5wZHAp
Owo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfc2NyYXRjaDsKPiAt
ICAgICAgICAgICAgICAgICAgICAgICB9Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVy
cikKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX3BkcDsKPiAgICAg
ICAgICAgICAgICAgfQo+ICAKPiAgICAgICAgICAgICAgICAgcHBndHQtPnZtLmFsbG9jYXRlX3Zh
X3JhbmdlID0gZ2VuOF9wcGd0dF9hbGxvY18zbHZsOwo+IEBAIC0xNjc1LDYgKzE2NjUsOCBAQCBz
dGF0aWMgc3RydWN0IGk5MTVfcHBndHQgKmdlbjhfcHBndHRfY3JlYXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQo+ICAKPiAgICAgICAgIHJldHVybiBwcGd0dDsKPiAgCj4gK2Vycl9w
ZHA6Cj4gKyAgICAgICBmcmVlX3BkcCgmcHBndHQtPnZtLCBwcGd0dC0+cGQpOwo+ICBlcnJfc2Ny
YXRjaDoKPiAgICAgICAgIGdlbjhfZnJlZV9zY3JhdGNoKCZwcGd0dC0+dm0pOwo+ICBlcnJfZnJl
ZToKPiBAQCAtMTc0MCwxNSArMTczMiwxNiBAQCBzdGF0aWMgdm9pZCBnZW42X3BwZ3R0X2VuYWJs
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gIHN0YXRpYyB2b2lkIGdlbjZf
cHBndHRfY2xlYXJfcmFuZ2Uoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1NjQgc3RhcnQsIHU2NCBsZW5ndGgpCj4gIHsK
PiAtICAgICAgIHN0cnVjdCBnZW42X3BwZ3R0ICpwcGd0dCA9IHRvX2dlbjZfcHBndHQoaTkxNV92
bV90b19wcGd0dCh2bSkpOwo+IC0gICAgICAgdW5zaWduZWQgaW50IGZpcnN0X2VudHJ5ID0gc3Rh
cnQgLyBJOTE1X0dUVF9QQUdFX1NJWkU7Cj4gKyAgICAgICBzdHJ1Y3QgZ2VuNl9wcGd0dCAqIGNv
bnN0IHBwZ3R0ID0gdG9fZ2VuNl9wcGd0dChpOTE1X3ZtX3RvX3BwZ3R0KHZtKSk7Cj4gKyAgICAg
ICBjb25zdCB1bnNpZ25lZCBpbnQgZmlyc3RfZW50cnkgPSBzdGFydCAvIEk5MTVfR1RUX1BBR0Vf
U0laRTsKPiArICAgICAgIGNvbnN0IGdlbjZfcHRlX3Qgc2NyYXRjaF9wdGUgPSB2bS0+c2NyYXRj
aF9wdGU7Cj4gICAgICAgICB1bnNpZ25lZCBpbnQgcGRlID0gZmlyc3RfZW50cnkgLyBHRU42X1BU
RVM7Cj4gICAgICAgICB1bnNpZ25lZCBpbnQgcHRlID0gZmlyc3RfZW50cnkgJSBHRU42X1BURVM7
Cj4gICAgICAgICB1bnNpZ25lZCBpbnQgbnVtX2VudHJpZXMgPSBsZW5ndGggLyBJOTE1X0dUVF9Q
QUdFX1NJWkU7Cj4gLSAgICAgICBjb25zdCBnZW42X3B0ZV90IHNjcmF0Y2hfcHRlID0gdm0tPnNj
cmF0Y2hfcHRlOwo+ICAKPiAgICAgICAgIHdoaWxlIChudW1fZW50cmllcykgewo+IC0gICAgICAg
ICAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX3RhYmxlICpwdCA9IHBwZ3R0LT5iYXNlLnBkLnBhZ2Vf
dGFibGVbcGRlKytdOwo+ICsgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9wYWdlX3RhYmxlICog
Y29uc3QgcHQgPQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGk5MTVfcHRfZW50cnkocHBndHQt
PmJhc2UucGQsIHBkZSsrKTsKPiAgICAgICAgICAgICAgICAgY29uc3QgdW5zaWduZWQgaW50IGNv
dW50ID0gbWluKG51bV9lbnRyaWVzLCBHRU42X1BURVMgLSBwdGUpOwo+ICAgICAgICAgICAgICAg
ICBnZW42X3B0ZV90ICp2YWRkcjsKPiAgCj4gQEAgLTE3NTYsOCArMTc0OSw4IEBAIHN0YXRpYyB2
b2lkIGdlbjZfcHBndHRfY2xlYXJfcmFuZ2Uoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0s
Cj4gIAo+ICAgICAgICAgICAgICAgICBudW1fZW50cmllcyAtPSBjb3VudDsKPiAgCj4gLSAgICAg
ICAgICAgICAgIEdFTV9CVUdfT04oY291bnQgPiBhdG9taWNfcmVhZCgmcHQtPnVzZWRfcHRlcykp
Owo+IC0gICAgICAgICAgICAgICBpZiAoIWF0b21pY19zdWJfcmV0dXJuKGNvdW50LCAmcHQtPnVz
ZWRfcHRlcykpCj4gKyAgICAgICAgICAgICAgIEdFTV9CVUdfT04oY291bnQgPiBhdG9taWNfcmVh
ZCgmcHQtPnVzZWQpKTsKPiArICAgICAgICAgICAgICAgaWYgKCFhdG9taWNfc3ViX3JldHVybihj
b3VudCwgJnB0LT51c2VkKSkKPiAgICAgICAgICAgICAgICAgICAgICAgICBwcGd0dC0+c2Nhbl9m
b3JfdW51c2VkX3B0ID0gdHJ1ZTsKPiAgCj4gICAgICAgICAgICAgICAgIC8qCj4gQEAgLTE3ODEs
NiArMTc3NCw3IEBAIHN0YXRpYyB2b2lkIGdlbjZfcHBndHRfaW5zZXJ0X2VudHJpZXMoc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1MzIgZmxhZ3MpCj4gIHsKPiAgICAgICAgIHN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0
dCA9IGk5MTVfdm1fdG9fcHBndHQodm0pOwo+ICsgICAgICAgc3RydWN0IGk5MTVfcGFnZV9kaXJl
Y3RvcnkgKiBjb25zdCBwZCA9IHBwZ3R0LT5wZDsKPiAgICAgICAgIHVuc2lnbmVkIGZpcnN0X2Vu
dHJ5ID0gdm1hLT5ub2RlLnN0YXJ0IC8gSTkxNV9HVFRfUEFHRV9TSVpFOwo+ICAgICAgICAgdW5z
aWduZWQgYWN0X3B0ID0gZmlyc3RfZW50cnkgLyBHRU42X1BURVM7Cj4gICAgICAgICB1bnNpZ25l
ZCBhY3RfcHRlID0gZmlyc3RfZW50cnkgJSBHRU42X1BURVM7Cj4gQEAgLTE3ODgsOSArMTc4Miw5
IEBAIHN0YXRpYyB2b2lkIGdlbjZfcHBndHRfaW5zZXJ0X2VudHJpZXMoc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm0sCj4gICAgICAgICBzdHJ1Y3Qgc2d0X2RtYSBpdGVyID0gc2d0X2RtYSh2
bWEpOwo+ICAgICAgICAgZ2VuNl9wdGVfdCAqdmFkZHI7Cj4gIAo+IC0gICAgICAgR0VNX0JVR19P
TihwcGd0dC0+cGQucGFnZV90YWJsZVthY3RfcHRdID09IHZtLT5zY3JhdGNoX3B0KTsKPiArICAg
ICAgIEdFTV9CVUdfT04oaTkxNV9wdF9lbnRyeShwZCwgYWN0X3B0KSA9PSB2bS0+c2NyYXRjaF9w
dCk7Cj4gIAo+IC0gICAgICAgdmFkZHIgPSBrbWFwX2F0b21pY19weChwcGd0dC0+cGQucGFnZV90
YWJsZVthY3RfcHRdKTsKPiArICAgICAgIHZhZGRyID0ga21hcF9hdG9taWNfcHgoaTkxNV9wdF9l
bnRyeShwZCwgYWN0X3B0KSk7Cj4gICAgICAgICBkbyB7Cj4gICAgICAgICAgICAgICAgIHZhZGRy
W2FjdF9wdGVdID0gcHRlX2VuY29kZSB8IEdFTjZfUFRFX0FERFJfRU5DT0RFKGl0ZXIuZG1hKTsK
PiAgCj4gQEAgLTE4MDYsNyArMTgwMCw3IEBAIHN0YXRpYyB2b2lkIGdlbjZfcHBndHRfaW5zZXJ0
X2VudHJpZXMoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gIAo+ICAgICAgICAgICAg
ICAgICBpZiAoKythY3RfcHRlID09IEdFTjZfUFRFUykgewo+ICAgICAgICAgICAgICAgICAgICAg
ICAgIGt1bm1hcF9hdG9taWModmFkZHIpOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIHZhZGRy
ID0ga21hcF9hdG9taWNfcHgocHBndHQtPnBkLnBhZ2VfdGFibGVbKythY3RfcHRdKTsKPiArICAg
ICAgICAgICAgICAgICAgICAgICB2YWRkciA9IGttYXBfYXRvbWljX3B4KGk5MTVfcHRfZW50cnko
cGQsICsrYWN0X3B0KSk7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgYWN0X3B0ZSA9IDA7Cj4g
ICAgICAgICAgICAgICAgIH0KPiAgICAgICAgIH0gd2hpbGUgKDEpOwo+IEBAIC0xODE5LDYgKzE4
MTMsNyBAQCBzdGF0aWMgaW50IGdlbjZfYWxsb2NfdmFfcmFuZ2Uoc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqdm0sCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHU2NCBzdGFydCwg
dTY0IGxlbmd0aCkKPiAgewo+ICAgICAgICAgc3RydWN0IGdlbjZfcHBndHQgKnBwZ3R0ID0gdG9f
Z2VuNl9wcGd0dChpOTE1X3ZtX3RvX3BwZ3R0KHZtKSk7Cj4gKyAgICAgICBzdHJ1Y3QgaTkxNV9w
YWdlX2RpcmVjdG9yeSAqIGNvbnN0IHBkID0gcHBndHQtPmJhc2UucGQ7Cj4gICAgICAgICBzdHJ1
Y3QgaTkxNV9wYWdlX3RhYmxlICpwdDsKPiAgICAgICAgIGludGVsX3dha2VyZWZfdCB3YWtlcmVm
Owo+ICAgICAgICAgdTY0IGZyb20gPSBzdGFydDsKPiBAQCAtMTgyNywxNCArMTgyMiwxNCBAQCBz
dGF0aWMgaW50IGdlbjZfYWxsb2NfdmFfcmFuZ2Uoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm0sCj4gIAo+ICAgICAgICAgd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KHZtLT5pOTE1
KTsKPiAgCj4gLSAgICAgICBzcGluX2xvY2soJnBwZ3R0LT5iYXNlLnBkLmxvY2spOwo+IC0gICAg
ICAgZ2VuNl9mb3JfZWFjaF9wZGUocHQsICZwcGd0dC0+YmFzZS5wZCwgc3RhcnQsIGxlbmd0aCwg
cGRlKSB7Cj4gKyAgICAgICBzcGluX2xvY2soJnBkLT5sb2NrKTsKPiArICAgICAgIGdlbjZfZm9y
X2VhY2hfcGRlKHB0LCBwZCwgc3RhcnQsIGxlbmd0aCwgcGRlKSB7Cj4gICAgICAgICAgICAgICAg
IGNvbnN0IHVuc2lnbmVkIGludCBjb3VudCA9IGdlbjZfcHRlX2NvdW50KHN0YXJ0LCBsZW5ndGgp
Owo+ICAKPiAgICAgICAgICAgICAgICAgaWYgKHB0ID09IHZtLT5zY3JhdGNoX3B0KSB7Cj4gICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfcGFnZV90YWJsZSAqb2xkOwo+ICAKPiAt
ICAgICAgICAgICAgICAgICAgICAgICBzcGluX3VubG9jaygmcHBndHQtPmJhc2UucGQubG9jayk7
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgc3Bpbl91bmxvY2soJnBkLT5sb2NrKTsKPiAgCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgcHQgPSBhbGxvY19wdCh2bSk7Cj4gICAgICAgICAgICAg
ICAgICAgICAgICAgaWYgKElTX0VSUihwdCkpCj4gQEAgLTE4NDIsMTAgKzE4MzcsOCBAQCBzdGF0
aWMgaW50IGdlbjZfYWxsb2NfdmFfcmFuZ2Uoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0s
Cj4gIAo+ICAgICAgICAgICAgICAgICAgICAgICAgIGdlbjZfaW5pdGlhbGl6ZV9wdCh2bSwgcHQp
Owo+ICAKPiAtICAgICAgICAgICAgICAgICAgICAgICBvbGQgPSBjbXB4Y2hnKCZwcGd0dC0+YmFz
ZS5wZC5wYWdlX3RhYmxlW3BkZV0sCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB2bS0+c2NyYXRjaF9wdCwgcHQpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIG9sZCA9
IGNtcHhjaGcoJnBkLT5lbnRyeVtwZGVdLCB2bS0+c2NyYXRjaF9wdCwgcHQpOwo+ICAgICAgICAg
ICAgICAgICAgICAgICAgIGlmIChvbGQgPT0gdm0tPnNjcmF0Y2hfcHQpIHsKPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHBwZ3R0LT5iYXNlLnBkLnBhZ2VfdGFibGVbcGRlXSA9IHB0
Owo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGk5MTVfdm1hX2lzX2JvdW5k
KHBwZ3R0LT52bWEsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgSTkxNV9WTUFfR0xPQkFMX0JJTkQpKSB7Cj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGdlbjZfd3JpdGVfcGRlKHBwZ3R0LCBwZGUsIHB0KTsKPiBA
QCAtMTg1NiwxMiArMTg0OSwxMiBAQCBzdGF0aWMgaW50IGdlbjZfYWxsb2NfdmFfcmFuZ2Uoc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBwdCA9IG9sZDsKPiAgICAgICAgICAgICAgICAgICAgICAgICB9Cj4gIAo+IC0gICAgICAg
ICAgICAgICAgICAgICAgIHNwaW5fbG9jaygmcHBndHQtPmJhc2UucGQubG9jayk7Cj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgc3Bpbl9sb2NrKCZwZC0+bG9jayk7Cj4gICAgICAgICAgICAgICAg
IH0KPiAgCj4gLSAgICAgICAgICAgICAgIGF0b21pY19hZGQoY291bnQsICZwdC0+dXNlZF9wdGVz
KTsKPiArICAgICAgICAgICAgICAgYXRvbWljX2FkZChjb3VudCwgJnB0LT51c2VkKTsKPiAgICAg
ICAgIH0KPiAtICAgICAgIHNwaW5fdW5sb2NrKCZwcGd0dC0+YmFzZS5wZC5sb2NrKTsKPiArICAg
ICAgIHNwaW5fdW5sb2NrKCZwZC0+bG9jayk7Cj4gIAo+ICAgICAgICAgaWYgKGZsdXNoKSB7Cj4g
ICAgICAgICAgICAgICAgIG1hcmtfdGxic19kaXJ0eSgmcHBndHQtPmJhc2UpOwo+IEBAIC0xODgx
LDYgKzE4NzQsNyBAQCBzdGF0aWMgaW50IGdlbjZfYWxsb2NfdmFfcmFuZ2Uoc3RydWN0IGk5MTVf
YWRkcmVzc19zcGFjZSAqdm0sCj4gIHN0YXRpYyBpbnQgZ2VuNl9wcGd0dF9pbml0X3NjcmF0Y2go
c3RydWN0IGdlbjZfcHBndHQgKnBwZ3R0KQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgaTkxNV9hZGRy
ZXNzX3NwYWNlICogY29uc3Qgdm0gPSAmcHBndHQtPmJhc2Uudm07Cj4gKyAgICAgICBzdHJ1Y3Qg
aTkxNV9wYWdlX2RpcmVjdG9yeSAqIGNvbnN0IHBkID0gcHBndHQtPmJhc2UucGQ7Cj4gICAgICAg
ICBzdHJ1Y3QgaTkxNV9wYWdlX3RhYmxlICp1bnVzZWQ7Cj4gICAgICAgICB1MzIgcGRlOwo+ICAg
ICAgICAgaW50IHJldDsKPiBAQCAtMTkwMCw5ICsxODk0LDkgQEAgc3RhdGljIGludCBnZW42X3Bw
Z3R0X2luaXRfc2NyYXRjaChzdHJ1Y3QgZ2VuNl9wcGd0dCAqcHBndHQpCj4gICAgICAgICB9Cj4g
IAo+ICAgICAgICAgZ2VuNl9pbml0aWFsaXplX3B0KHZtLCB2bS0+c2NyYXRjaF9wdCk7Cj4gLSAg
ICAgICBnZW42X2Zvcl9hbGxfcGRlcyh1bnVzZWQsICZwcGd0dC0+YmFzZS5wZCwgcGRlKQo+IC0g
ICAgICAgICAgICAgICBwcGd0dC0+YmFzZS5wZC5wYWdlX3RhYmxlW3BkZV0gPSB2bS0+c2NyYXRj
aF9wdDsKPiAtICAgICAgIHNwaW5fbG9ja19pbml0KCZwcGd0dC0+YmFzZS5wZC5sb2NrKTsKPiAr
Cj4gKyAgICAgICBnZW42X2Zvcl9hbGxfcGRlcyh1bnVzZWQsIHBkLCBwZGUpCj4gKyAgICAgICAg
ICAgICAgIHBkLT5lbnRyeVtwZGVdID0gdm0tPnNjcmF0Y2hfcHQ7Cj4gIAo+ICAgICAgICAgcmV0
dXJuIDA7Cj4gIH0KPiBAQCAtMTkxNSwxMCArMTkwOSwxMSBAQCBzdGF0aWMgdm9pZCBnZW42X3Bw
Z3R0X2ZyZWVfc2NyYXRjaChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKPiAgCj4gIHN0
YXRpYyB2b2lkIGdlbjZfcHBndHRfZnJlZV9wZChzdHJ1Y3QgZ2VuNl9wcGd0dCAqcHBndHQpCj4g
IHsKPiArICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICogY29uc3QgcGQgPSBwcGd0
dC0+YmFzZS5wZDsKPiAgICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfdGFibGUgKnB0Owo+ICAgICAg
ICAgdTMyIHBkZTsKPiAgCj4gLSAgICAgICBnZW42X2Zvcl9hbGxfcGRlcyhwdCwgJnBwZ3R0LT5i
YXNlLnBkLCBwZGUpCj4gKyAgICAgICBnZW42X2Zvcl9hbGxfcGRlcyhwdCwgcGQsIHBkZSkKPiAg
ICAgICAgICAgICAgICAgaWYgKHB0ICE9IHBwZ3R0LT5iYXNlLnZtLnNjcmF0Y2hfcHQpCj4gICAg
ICAgICAgICAgICAgICAgICAgICAgZnJlZV9wdCgmcHBndHQtPmJhc2Uudm0sIHB0KTsKPiAgfQo+
IEBAIC0xOTgyLDYgKzE5NzcsNyBAQCBzdGF0aWMgdm9pZCBnZW42X3BwZ3R0X2NsZWFudXAoc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCj4gIAo+ICAgICAgICAgZ2VuNl9wcGd0dF9mcmVl
X3BkKHBwZ3R0KTsKPiAgICAgICAgIGdlbjZfcHBndHRfZnJlZV9zY3JhdGNoKHZtKTsKPiArICAg
ICAgIGtmcmVlKHBwZ3R0LT5iYXNlLnBkKTsKPiAgfQo+ICAKPiAgc3RhdGljIGludCBwZF92bWFf
c2V0X3BhZ2VzKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQo+IEBAIC0yMDA3LDEwICsyMDAzLDEwIEBA
IHN0YXRpYyBpbnQgcGRfdm1hX2JpbmQoc3RydWN0IGk5MTVfdm1hICp2bWEsCj4gICAgICAgICBz
dHJ1Y3QgaTkxNV9wYWdlX3RhYmxlICpwdDsKPiAgICAgICAgIHVuc2lnbmVkIGludCBwZGU7Cj4g
IAo+IC0gICAgICAgcHBndHQtPmJhc2UucGQuYmFzZS5nZ3R0X29mZnNldCA9IGdndHRfb2Zmc2V0
ICogc2l6ZW9mKGdlbjZfcHRlX3QpOwo+ICsgICAgICAgcHBndHQtPmJhc2UucGQtPmJhc2UuZ2d0
dF9vZmZzZXQgPSBnZ3R0X29mZnNldCAqIHNpemVvZihnZW42X3B0ZV90KTsKPiAgICAgICAgIHBw
Z3R0LT5wZF9hZGRyID0gKGdlbjZfcHRlX3QgX19pb21lbSAqKWdndHQtPmdzbSArIGdndHRfb2Zm
c2V0Owo+ICAKPiAtICAgICAgIGdlbjZfZm9yX2FsbF9wZGVzKHB0LCAmcHBndHQtPmJhc2UucGQs
IHBkZSkKPiArICAgICAgIGdlbjZfZm9yX2FsbF9wZGVzKHB0LCBwcGd0dC0+YmFzZS5wZCwgcGRl
KQo+ICAgICAgICAgICAgICAgICBnZW42X3dyaXRlX3BkZShwcGd0dCwgcGRlLCBwdCk7Cj4gIAo+
ICAgICAgICAgbWFya190bGJzX2RpcnR5KCZwcGd0dC0+YmFzZSk7Cj4gQEAgLTIwMjIsNiArMjAx
OCw3IEBAIHN0YXRpYyBpbnQgcGRfdm1hX2JpbmQoc3RydWN0IGk5MTVfdm1hICp2bWEsCj4gIHN0
YXRpYyB2b2lkIHBkX3ZtYV91bmJpbmQoc3RydWN0IGk5MTVfdm1hICp2bWEpCj4gIHsKPiAgICAg
ICAgIHN0cnVjdCBnZW42X3BwZ3R0ICpwcGd0dCA9IHZtYS0+cHJpdmF0ZTsKPiArICAgICAgIHN0
cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5ICogY29uc3QgcGQgPSBwcGd0dC0+YmFzZS5wZDsKPiAg
ICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfdGFibGUgKiBjb25zdCBzY3JhdGNoX3B0ID0gcHBndHQt
PmJhc2Uudm0uc2NyYXRjaF9wdDsKPiAgICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfdGFibGUgKnB0
Owo+ICAgICAgICAgdW5zaWduZWQgaW50IHBkZTsKPiBAQCAtMjAzMCwxMiArMjAyNywxMiBAQCBz
dGF0aWMgdm9pZCBwZF92bWFfdW5iaW5kKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQo+ICAgICAgICAg
ICAgICAgICByZXR1cm47Cj4gIAo+ICAgICAgICAgLyogRnJlZSBhbGwgbm8gbG9uZ2VyIHVzZWQg
cGFnZSB0YWJsZXMgKi8KPiAtICAgICAgIGdlbjZfZm9yX2FsbF9wZGVzKHB0LCAmcHBndHQtPmJh
c2UucGQsIHBkZSkgewo+IC0gICAgICAgICAgICAgICBpZiAoYXRvbWljX3JlYWQoJnB0LT51c2Vk
X3B0ZXMpIHx8IHB0ID09IHNjcmF0Y2hfcHQpCj4gKyAgICAgICBnZW42X2Zvcl9hbGxfcGRlcyhw
dCwgcHBndHQtPmJhc2UucGQsIHBkZSkgewo+ICsgICAgICAgICAgICAgICBpZiAoYXRvbWljX3Jl
YWQoJnB0LT51c2VkKSB8fCBwdCA9PSBzY3JhdGNoX3B0KQo+ICAgICAgICAgICAgICAgICAgICAg
ICAgIGNvbnRpbnVlOwo+ICAKPiAgICAgICAgICAgICAgICAgZnJlZV9wdCgmcHBndHQtPmJhc2Uu
dm0sIHB0KTsKPiAtICAgICAgICAgICAgICAgcHBndHQtPmJhc2UucGQucGFnZV90YWJsZVtwZGVd
ID0gc2NyYXRjaF9wdDsKPiArICAgICAgICAgICAgICAgcGQtPmVudHJ5W3BkZV0gPSBzY3JhdGNo
X3B0Owo+ICAgICAgICAgfQo+ICAKPiAgICAgICAgIHBwZ3R0LT5zY2FuX2Zvcl91bnVzZWRfcHQg
PSBmYWxzZTsKPiBAQCAtMjE2NCw5ICsyMTYxLDE1IEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV9wcGd0
dCAqZ2VuNl9wcGd0dF9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gICAg
ICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWU7Cj4gICAgICAgICB9Cj4gIAo+ICsgICAgICAgcHBn
dHQtPmJhc2UucGQgPSBfX2FsbG9jX3BkKDUxMik7Cj4gKyAgICAgICBpZiAoIXBwZ3R0LT5iYXNl
LnBkKSB7Cj4gKyAgICAgICAgICAgICAgIGVyciA9IC1FTk9NRU07Cj4gKyAgICAgICAgICAgICAg
IGdvdG8gZXJyX3dvcms7Cj4gKyAgICAgICB9Cj4gKwo+ICAgICAgICAgZXJyID0gZ2VuNl9wcGd0
dF9pbml0X3NjcmF0Y2gocHBndHQpOwo+ICAgICAgICAgaWYgKGVycikKPiAtICAgICAgICAgICAg
ICAgZ290byBlcnJfd29yazsKPiArICAgICAgICAgICAgICAgZ290byBlcnJfcGQ7Cj4gIAo+ICAg
ICAgICAgcHBndHQtPnZtYSA9IHBkX3ZtYV9jcmVhdGUocHBndHQsIEdFTjZfUERfU0laRSk7Cj4g
ICAgICAgICBpZiAoSVNfRVJSKHBwZ3R0LT52bWEpKSB7Cj4gQEAgLTIxNzgsNiArMjE4MSw4IEBA
IHN0YXRpYyBzdHJ1Y3QgaTkxNV9wcGd0dCAqZ2VuNl9wcGd0dF9jcmVhdGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpCj4gIAo+ICBlcnJfc2NyYXRjaDoKPiAgICAgICAgIGdlbjZfcHBn
dHRfZnJlZV9zY3JhdGNoKCZwcGd0dC0+YmFzZS52bSk7Cj4gK2Vycl9wZDoKPiArICAgICAgIGtm
cmVlKHBwZ3R0LT5iYXNlLnBkKTsKPiAgZXJyX3dvcms6Cj4gICAgICAgICBrZnJlZShwcGd0dC0+
d29yayk7Cj4gIGVycl9mcmVlOgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbV9ndHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5oCj4gaW5k
ZXggODk0MzdkMGE3MjFjLi40OWY0NDA3MWRlZjQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dlbV9ndHQuaAo+IEBAIC0yNDgsMjggKzI0OCwxNCBAQCBzdHJ1Y3QgaTkxNV9wYWdlX2RtYSB7
Cj4gIAo+ICBzdHJ1Y3QgaTkxNV9wYWdlX3RhYmxlIHsKPiAgICAgICAgIHN0cnVjdCBpOTE1X3Bh
Z2VfZG1hIGJhc2U7Cj4gLSAgICAgICBhdG9taWNfdCB1c2VkX3B0ZXM7Cj4gKyAgICAgICBhdG9t
aWNfdCB1c2VkOwo+ICB9Owo+ICAKPiAgc3RydWN0IGk5MTVfcGFnZV9kaXJlY3Rvcnkgewo+ICAg
ICAgICAgc3RydWN0IGk5MTVfcGFnZV9kbWEgYmFzZTsKPiAtCj4gLSAgICAgICBzdHJ1Y3QgaTkx
NV9wYWdlX3RhYmxlICpwYWdlX3RhYmxlW0k5MTVfUERFU107IC8qIFBERXMgKi8KPiAtICAgICAg
IGF0b21pY190IHVzZWRfcGRlczsKPiAtICAgICAgIHNwaW5sb2NrX3QgbG9jazsKPiAtfTsKPiAt
Cj4gLXN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5X3BvaW50ZXIgewo+IC0gICAgICAgc3RydWN0
IGk5MTVfcGFnZV9kbWEgYmFzZTsKPiAtICAgICAgIHN0cnVjdCBpOTE1X3BhZ2VfZGlyZWN0b3J5
ICoqcGFnZV9kaXJlY3Rvcnk7Cj4gLSAgICAgICBhdG9taWNfdCB1c2VkX3BkcGVzOwo+IC0gICAg
ICAgc3BpbmxvY2tfdCBsb2NrOwo+IC19Owo+IC0KPiAtc3RydWN0IGk5MTVfcG1sNCB7Cj4gLSAg
ICAgICBzdHJ1Y3QgaTkxNV9wYWdlX2RtYSBiYXNlOwo+IC0gICAgICAgc3RydWN0IGk5MTVfcGFn
ZV9kaXJlY3RvcnlfcG9pbnRlciAqcGRwc1tHRU44X1BNTDRFU19QRVJfUE1MNF07Cj4gKyAgICAg
ICBhdG9taWNfdCB1c2VkOwo+ICAgICAgICAgc3BpbmxvY2tfdCBsb2NrOwo+ICsgICAgICAgdm9p
ZCAqZW50cnlbMF07Cj4gIH07CgpGdXJ0aGVybW9yZSwgd2UgY2FuIHNheSB0aGF0IG9ubHkgdHdv
IHR5cGVzIG9mIHBvaW50ZXIgY291bGQgYmUgc3RvcmVkCmhlcmUuIEhvd2V2ZXIsIHVuaW9ucyB0
ZW5kIHRvIGVuZCB1cCB3aXRoIG1lc3N5IGNvZGUsIHNvIEkgY2FuCnVuZGVyc3RhbmQgaWYgdGhl
IGltcGxpY2l0IGNhc3RzIGZyb20gdm9pZCBlbmQgdXAgYmVpbmcgbmVhdGVyLgotQ2hyaXMKX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1h
aWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

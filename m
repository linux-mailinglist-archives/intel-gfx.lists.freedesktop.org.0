Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1911FD42AE
	for <lists+intel-gfx@lfdr.de>; Fri, 11 Oct 2019 16:22:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5E7DF6EC4B;
	Fri, 11 Oct 2019 14:22:25 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2DEA26EC4B
 for <intel-gfx@lists.freedesktop.org>; Fri, 11 Oct 2019 14:22:24 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 18805345-1500050 for multiple; Fri, 11 Oct 2019 15:22:20 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>,
 intel-gfx@lists.freedesktop.org
References: <20191010071434.31195-1-chris@chris-wilson.co.uk>
 <20191010071434.31195-8-chris@chris-wilson.co.uk>
 <7bfc079e-e76b-9e43-de61-a00ab6b97b72@linux.intel.com>
In-Reply-To: <7bfc079e-e76b-9e43-de61-a00ab6b97b72@linux.intel.com>
Message-ID: <157080373793.31572.12385908510774881252@skylake-alporthouse-com>
Date: Fri, 11 Oct 2019 15:22:17 +0100
Subject: Re: [Intel-gfx] [PATCH 08/10] drm/i915: Cancel non-persistent
 contexts on close
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBUdnJ0a28gVXJzdWxpbiAoMjAxOS0xMC0xMSAxNDo1NTowMCkKPiAKPiBPbiAxMC8x
MC8yMDE5IDA4OjE0LCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4gPiBOb3JtYWxseSwgd2UgcmVseSBv
biBvdXIgaGFuZ2NoZWNrIHRvIHByZXZlbnQgcGVyc2lzdGVudCBiYXRjaGVzIGZyb20KPiA+IGhv
Z2dpbmcgdGhlIEdQVS4gSG93ZXZlciwgaWYgdGhlIHVzZXIgZGlzYWJsZXMgaGFuZ2NoZWNrLCB0
aGlzIG1lY2hhbmlzbQo+ID4gYnJlYWtzIGRvd24uIERlc3BpdGUgb3VyIGluc2lzdGVuY2UgdGhh
dCB0aGlzIGlzIHVuc2FmZSwgdGhlIHVzZXJzIGFyZQo+ID4gZXF1YWxseSBpbnNpc3RlbnQgdGhh
dCB0aGV5IHdhbnQgdG8gdXNlIGVuZGxlc3MgYmF0Y2hlcyBhbmQgd2lsbCBkaXNhYmxlCj4gPiB0
aGUgaGFuZ2NoZWNrIG1lY2hhbmlzbS4gV2UgYXJlIGxvb2tpbmcgYXQgcGVyaGFwcyByZXBsYWNp
bmcgaGFuZ2NoZWNrCj4gPiB3aXRoIGEgc29mdGVyIG1lY2hhbmlzbSwgdGhhdCBzZW5kcyBhIHB1
bHNlIGRvd24gdGhlIGVuZ2luZSB0byBjaGVjayBpZgo+ID4gaXQgaXMgd2VsbC4gV2UgY2FuIHVz
ZSB0aGUgc2FtZSBwcmVlbXB0aXZlIHB1bHNlIHRvIGZsdXNoIGFuIGFjdGl2ZQo+ID4gcGVyc2lz
dGVudCBjb250ZXh0IG9mZiB0aGUgR1BVIHVwb24gY29udGV4dCBjbG9zZSwgcHJldmVudGluZyBy
ZXNvdXJjZXMKPiA+IGJlaW5nIGxvc3QgYW5kIHVua2lsbGFibGUgcmVxdWVzdHMgcmVtYWluaW5n
IG9uIHRoZSBHUFUgYWZ0ZXIgcHJvY2Vzcwo+ID4gdGVybWluYXRpb24uIFRvIGF2b2lkIGNoYW5n
aW5nIHRoZSBBQkkgYW5kIGFjY2lkZW50YWxseSBicmVha2luZwo+ID4gZXhpc3RpbmcgdXNlcnNw
YWNlLCB3ZSBtYWtlIHRoZSBwZXJzaXN0ZW5jZSBvZiBhIGNvbnRleHQgZXhwbGljaXQgYW5kCj4g
PiBlbmFibGUgaXQgYnkgZGVmYXVsdCAobWF0Y2hpbmcgY3VycmVudCBBQkkpLiBVc2Vyc3BhY2Ug
Y2FuIG9wdCBvdXQgb2YKPiA+IHBlcnNpc3RlbnQgbW9kZSAoZm9yY2luZyByZXF1ZXN0cyB0byBi
ZSBjYW5jZWxsZWQgd2hlbiB0aGUgY29udGV4dCBpcwo+ID4gY2xvc2VkIGJ5IHByb2Nlc3MgdGVy
bWluYXRpb24gb3IgZXhwbGljaXRseSkgYnkgYSBjb250ZXh0IHBhcmFtZXRlci4gVG8KPiA+IGZh
Y2lsaXRhdGUgZXhpc3RpbmcgdXNlLWNhc2VzIG9mIGRpc2FibGluZyBoYW5nY2hlY2ssIGlmIHRo
ZSBtb2RwYXJhbSBpcwo+ID4gZGlzYWJsZWQgKGk5MTUuZW5hYmxlX2hhbmdjaGVjaz0wKSwgd2Ug
ZGlzYWJsZSBwZXJzaXN0ZW5jZSBtb2RlIGJ5Cj4gPiBkZWZhdWx0LiAgKE5vdGUsIG9uZSBvZiB0
aGUgb3V0Y29tZXMgZm9yIHN1cHBvcnRpbmcgZW5kbGVzcyBtb2RlIHdpbGwgYmUKPiA+IHRoZSBy
ZW1vdmFsIG9mIGhhbmdjaGVja2luZywgYXQgd2hpY2ggcG9pbnQgb3B0aW5nIGludG8gcGVyc2lz
dGVudCBtb2RlCj4gPiB3aWxsIGJlIG1hbmRhdG9yeSwgb3IgbWF5YmUgdGhlIGRlZmF1bHQgcGVy
aGFwcyBjb250cm9sbGVkIGJ5IGNncm91cHMuKQo+ID4gCj4gPiB2MjogQ2hlY2sgZm9yIGhhbmdj
aGVja2luZyBhdCBjb250ZXh0IHRlcm1pbmF0aW9uLCBzbyB0aGF0IHdlIGFyZSBub3QKPiA+IGxl
ZnQgd2l0aCB1bmR5aW5nIGNvbnRleHRzIGZyb20gYSBjcmFmdHkgdXNlci4KPiA+IAo+ID4gVGVz
dGNhc2U6IGlndC9nZW1fY3R4X3BlcnNpc3RlbmNlCj4gPiBTaWduZWQtb2ZmLWJ5OiBDaHJpcyBX
aWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KPiA+IENjOiBKb29uYXMgTGFodGluZW4g
PGpvb25hcy5sYWh0aW5lbkBsaW51eC5pbnRlbC5jb20+Cj4gPiBDYzogTWljaGHFgiBXaW5pYXJz
a2kgPG1pY2hhbC53aW5pYXJza2lAaW50ZWwuY29tPgo+ID4gQ2M6IEpvbiBCbG9vbWZpZWxkIDxq
b24uYmxvb21maWVsZEBpbnRlbC5jb20+Cj4gPiBSZXZpZXdlZC1ieTogSm9uIEJsb29tZmllbGQg
PGpvbi5ibG9vbWZpZWxkQGludGVsLmNvbT4KPiA+IC0tLQo+ID4gICBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jICAgfCAxMzIgKysrKysrKysrKysrKysrKysrCj4g
PiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmggICB8ICAxNSAr
Kwo+ID4gICAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmggfCAg
IDEgKwo+ID4gICAuLi4vZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmMg
fCAgIDIgKwo+ID4gICBpbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmggICAgICAgICAgICAgICAg
ICAgfCAgMTUgKysKPiA+ICAgNSBmaWxlcyBjaGFuZ2VkLCAxNjUgaW5zZXJ0aW9ucygrKQo+ID4g
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRl
eHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKPiA+IGlu
ZGV4IDVkODIyMWM3YmE4My4uNDZlNWIzYjUzMjg4IDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwo+ID4gQEAgLTcwLDYgKzcwLDcgQEAKPiA+
ICAgI2luY2x1ZGUgPGRybS9pOTE1X2RybS5oPgo+ID4gICAKPiA+ICAgI2luY2x1ZGUgImd0L2lu
dGVsX2xyY19yZWcuaCIKPiA+ICsjaW5jbHVkZSAiZ3QvaW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5o
Igo+ID4gICAjaW5jbHVkZSAiZ3QvaW50ZWxfZW5naW5lX3VzZXIuaCIKPiA+ICAgCj4gPiAgICNp
bmNsdWRlICJpOTE1X2dlbV9jb250ZXh0LmgiCj4gPiBAQCAtMjY5LDYgKzI3MCw3OCBAQCB2b2lk
IGk5MTVfZ2VtX2NvbnRleHRfcmVsZWFzZShzdHJ1Y3Qga3JlZiAqcmVmKQo+ID4gICAgICAgICAg
ICAgICBzY2hlZHVsZV93b3JrKCZnYy0+ZnJlZV93b3JrKTsKPiA+ICAgfQo+ID4gICAKPiA+ICtz
dGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzICoKPiA+ICtfX2NvbnRleHRfZW5n
aW5lc19zdGF0aWMoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKPiA+ICt7Cj4gPiArICAg
ICByZXR1cm4gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChjdHgtPmVuZ2luZXMsIHRydWUpOwo+
ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBraWxsX2NvbnRleHQoc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKmN0eCkKPiA+ICt7Cj4gPiArICAgICBpbnRlbF9lbmdpbmVfbWFza190IHRtcCwg
YWN0aXZlLCByZXNldDsKPiA+ICsgICAgIHN0cnVjdCBpbnRlbF9ndCAqZ3QgPSAmY3R4LT5pOTE1
LT5ndDsKPiA+ICsgICAgIHN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzX2l0ZXIgaXQ7Cj4gPiArICAg
ICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4gPiArICAgICBzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2U7Cj4gPiArCj4gPiArICAgICAvKgo+ID4gKyAgICAgICogSWYgd2UgYXJlIGFs
cmVhZHkgYmFubmVkLCBpdCB3YXMgZHVlIHRvIGEgZ3VpbHR5IHJlcXVlc3QgY2F1c2luZwo+ID4g
KyAgICAgICogYSByZXNldCBhbmQgdGhlIGVudGlyZSBjb250ZXh0IGJlaW5nIGV2aWN0ZWQgZnJv
bSB0aGUgR1BVLgo+ID4gKyAgICAgICovCj4gPiArICAgICBpZiAoaTkxNV9nZW1fY29udGV4dF9p
c19iYW5uZWQoY3R4KSkKPiA+ICsgICAgICAgICAgICAgcmV0dXJuOwo+ID4gKwo+ID4gKyAgICAg
aTkxNV9nZW1fY29udGV4dF9zZXRfYmFubmVkKGN0eCk7Cj4gPiArCj4gPiArICAgICAvKgo+ID4g
KyAgICAgICogTWFwIHRoZSB1c2VyJ3MgZW5naW5lIGJhY2sgdG8gdGhlIGFjdHVhbCBlbmdpbmVz
OyBvbmUgdmlydHVhbAo+ID4gKyAgICAgICogZW5naW5lIHdpbGwgYmUgbWFwcGVkIHRvIG11bHRp
cGxlIGVuZ2luZXMsIGFuZCB1c2luZyBjdHgtPmVuZ2luZVtdCj4gPiArICAgICAgKiB0aGUgc2Ft
ZSBlbmdpbmUgbWF5IGJlIGhhdmUgbXVsdGlwbGUgaW5zdGFuY2VzIGluIHRoZSB1c2VyJ3MgbWFw
Lgo+ID4gKyAgICAgICogSG93ZXZlciwgd2Ugb25seSBjYXJlIGFib3V0IHBlbmRpbmcgcmVxdWVz
dHMsIHNvIG9ubHkgaW5jbHVkZQo+ID4gKyAgICAgICogZW5naW5lcyBvbiB3aGljaCB0aGVyZSBh
cmUgaW5jb21wbGV0ZSByZXF1ZXN0cy4KPiA+ICsgICAgICAqLwo+ID4gKyAgICAgYWN0aXZlID0g
MDsKPiA+ICsgICAgIGZvcl9lYWNoX2dlbV9lbmdpbmUoY2UsIF9fY29udGV4dF9lbmdpbmVzX3N0
YXRpYyhjdHgpLCBpdCkgewo+ID4gKyAgICAgICAgICAgICBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5j
ZTsKPiA+ICsKPiA+ICsgICAgICAgICAgICAgaWYgKCFjZS0+dGltZWxpbmUpCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgY29udGludWU7Cj4gPiArCj4gPiArICAgICAgICAgICAgIGZlbmNlID0g
aTkxNV9hY3RpdmVfZmVuY2VfZ2V0KCZjZS0+dGltZWxpbmUtPmxhc3RfcmVxdWVzdCk7Cj4gPiAr
ICAgICAgICAgICAgIGlmICghZmVuY2UpCj4gPiArICAgICAgICAgICAgICAgICAgICAgY29udGlu
dWU7Cj4gPiArCj4gPiArICAgICAgICAgICAgIGVuZ2luZSA9IHRvX3JlcXVlc3QoZmVuY2UpLT5l
bmdpbmU7Cj4gPiArICAgICAgICAgICAgIGlmIChIQVNfRVhFQ0xJU1RTKGd0LT5pOTE1KSkKPiA+
ICsgICAgICAgICAgICAgICAgICAgICBlbmdpbmUgPSBpbnRlbF9jb250ZXh0X2luZmxpZ2h0KGNl
KTsKPiAKPiBPa2F5IHByZWVtcHRpb24gaW1wbGllcyBleGVjbGlzdHMsIHdhcyBjb25mdXNlZCBm
b3IgYSBtb21lbnQuCj4gCj4gV2hlbiBjYW4gZW5naW5lIGJlIE5VTEwgaGVyZT8KClRoZSBlbmdp
bmUgaXMgbm90IHBhdXNlZCwgYW5kIGFuIGludGVycnVwdCBjYW4gY2F1c2UgYSBzY2hlZHVsZS1v
dXQgYXMKd2UgZ2F0aGVyIHVwIHRoZSBzdGF0ZS4KCj4gCj4gPiArICAgICAgICAgICAgIGlmIChl
bmdpbmUpCj4gPiArICAgICAgICAgICAgICAgICAgICAgYWN0aXZlIHw9IGVuZ2luZS0+bWFzazsK
PiA+ICsKPiA+ICsgICAgICAgICAgICAgZG1hX2ZlbmNlX3B1dChmZW5jZSk7Cj4gPiArICAgICB9
Cj4gPiArCj4gPiArICAgICAvKgo+ID4gKyAgICAgICogU2VuZCBhICJoaWdoIHByaW9yaXR5IHB1
bHNlIiBkb3duIHRoZSBlbmdpbmUgdG8gY2F1c2UgdGhlCj4gPiArICAgICAgKiBjdXJyZW50IHJl
cXVlc3QgdG8gYmUgbW9tZW50YXJpbHkgcHJlZW1wdGVkLiAoSWYgaXQgZmFpbHMgdG8KPiA+ICsg
ICAgICAqIGJlIHByZWVtcHRlZCwgaXQgd2lsbCBiZSByZXNldCkuIEFzIHdlIGhhdmUgbWFya2Vk
IG91ciBjb250ZXh0Cj4gPiArICAgICAgKiBhcyBiYW5uZWQsIGFueSBpbmNvbXBsZXRlIHJlcXVl
c3QsIGluY2x1ZGluZyBhbnkgcnVubmluZywgd2lsbAo+ID4gKyAgICAgICogYmUgc2tpcHBlZCBm
b2xsb3dpbmcgdGhlIHByZWVtcHRpb24uCj4gPiArICAgICAgKi8KPiA+ICsgICAgIHJlc2V0ID0g
MDsKPiA+ICsgICAgIGZvcl9lYWNoX2VuZ2luZV9tYXNrZWQoZW5naW5lLCBndC0+aTkxNSwgYWN0
aXZlLCB0bXApCj4gPiArICAgICAgICAgICAgIGlmIChpbnRlbF9lbmdpbmVfcHVsc2UoZW5naW5l
KSkKPiA+ICsgICAgICAgICAgICAgICAgICAgICByZXNldCB8PSBlbmdpbmUtPm1hc2s7Cj4gCj4g
V2hhdCBpZiB3ZSB3ZXJlIGFibGUgdG8gc2VuZCBhIHB1bHNlLCBidXQgdGhlIGhvZyBjYW5ub3Qg
YmUgcHJlZW1wdGVkIAo+IGFuZCBoYW5nY2hlY2sgaXMgb2J2aW91c2x5IGRpc2FibGVkIC0gd2hv
IHdpbGwgZG8gdGhlIHJlc2V0PwoKSG1tLCB0aGUgaWRlYSBpcyB0aGF0IGZvcmNlZC1wcmVlbXB0
aW9uIGNhdXNlcyB0aGUgcmVzZXQuCihTZWUgaWd0L2dlbV9jdHhfcGVyc2lzdGVuY2UvaG9zdGls
ZSkKCkhvd2V2ZXIsIGlmIHdlIGdpdmUgdGhlIHN5c2FkbWluIHRoZSBtZWFucyB0byBkaXNhYmxl
IGZvcmNlLXByZWVtcHRpb24sCndlIGp1c3QgZ2F2ZSB0aGVtIGFub3RoZXIgc2hvdmVsIHRvIGRp
ZyBhIGhvbGUgd2l0aC4KCkEgbGFzdCByZXNvcnQgd291bGQgYmUgYW5vdGhlciB0aW1lciBoZXJl
IHRvIGVuc3VyZSB0aGUgY29udGV4dCB3YXMKdGVybWluYXRlZC4KLUNocmlzCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxp
c3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNr
dG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

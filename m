Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id DE4523AF7B
	for <lists+intel-gfx@lfdr.de>; Mon, 10 Jun 2019 09:21:44 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 56A9989109;
	Mon, 10 Jun 2019 07:21:42 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4A4E68910B
 for <intel-gfx@lists.freedesktop.org>; Mon, 10 Jun 2019 07:21:39 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16848374-1500050 
 for multiple; Mon, 10 Jun 2019 08:21:30 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 10 Jun 2019 08:21:19 +0100
Message-Id: <20190610072126.6355-22-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190610072126.6355-1-chris@chris-wilson.co.uk>
References: <20190610072126.6355-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 21/28] drm/i915: Coordinate i915_active with its
 own mutex
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Rm9yZ28gdGhlIHN0cnVjdF9tdXRleCBzZXJpYWxpc2F0aW9uIGZvciBpOTE1X2FjdGl2ZSwgYW5k
IGludGVycG9zZSBpdHMKb3duIG11dGV4IGhhbmRsaW5nIGZvciBhY3RpdmUvcmV0aXJlLgoKVGhp
cyBpcyBhIG11bHRpLWxheWVyZWQgc2xlaWdodC1vZi1oYW5kLiBGaXJzdCwgd2UgaGFkIHRvIGVu
c3VyZSB0aGF0IG5vCmFjdGl2ZS9yZXRpcmUgY2FsbGJhY2tzIGFjY2lkZW50YWxseSBpbnZlcnRl
ZCB0aGUgbXV0ZXggb3JkZXJpbmcgcnVsZXMsCm5vciBhc3N1bWVkIHRoYXQgdGhleSB3ZXJlIHRo
ZW1zZWx2ZXMgc2VyaWFsaXNlZCBieSBzdHJ1Y3RfbXV0ZXguIE1vcmUKY2hhbGxlbmdpbmcgdGhv
dWdoLCBpcyB0aGUgcnVsZSBvdmVyIHVwZGF0aW5nIGVsZW1lbnRzIG9mIHRoZSBhY3RpdmUKcmJ0
cmVlLiBJbnN0ZWFkIG9mIHRoZSB3aG9sZSBpOTE1X2FjdGl2ZSBub3cgYmVpbmcgc2VyaWFsaXNl
ZCBieQpzdHJ1Y3RfbXV0ZXgsIGFsbG9jYXRpb25zL3JvdGF0aW9ucyBvZiB0aGUgdHJlZSBhcmUg
c2VyaWFsaXNlZCBieSB0aGUKaTkxNV9hY3RpdmUubXV0ZXggYW5kIGluZGl2aWR1YWwgbm9kZXMg
YXJlIHNlcmlhbGlzZWQgYnkgdGhlIGNhbGxlcgp1c2luZyB0aGUgaTkxNV90aW1lbGluZS5tdXRl
eCAod2UgbmVlZCB0byB1c2UgbmVzdGVkIHNwaW5sb2NrcyB0bwppbnRlcmFjdCB3aXRoIHRoZSBk
bWFfZmVuY2UgY2FsbGJhY2sgbGlzdHMpLgoKVGhlIHBhaW4gcG9pbnQgaGVyZSBpcyB0aGF0IGlu
c3RlYWQgb2YgYSBzaW5nbGUgbXV0ZXggYXJvdW5kIGV4ZWNidWYsIHdlCm5vdyBoYXZlIHRvIHRh
a2UgYSBtdXRleCBmb3IgYWN0aXZlIHRyYWNrZXIgKG9uZSBmb3IgZWFjaCB2bWEsIGNvbnRleHQs
CmV0YykgYW5kIGEgY291cGxlIG9mIHNwaW5sb2NrcyBmb3IgZWFjaCBmZW5jZSB1cGRhdGUuIFRo
ZSBpbXByb3ZlbWVudCBpbgpmaW5lIGdyYWluZWQgbG9ja2luZyBhbGxvd2luZyBmb3IgbXVsdGlw
bGUgY29uY3VycmVudCBjbGllbnRzCihldmVudHVhbGx5ISkgc2hvdWxkIGJlIHdvcnRoIGl0IGlu
IHR5cGljYWwgbG9hZHMuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlz
LXdpbHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29u
dGV4dC5jICAgfCAgMTIgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZm
ZXIuYyAgICB8ICAgMiArLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5
cGVzLmggIHwgICAyICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jICAg
ICAgICB8ICAgOSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jICAg
ICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jICAgICAg
ICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jICAgICAg
ICB8ICAgNSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jICAgICAgICAg
IHwgICAzIC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMgICAgICAgICAgICB8
IDE2NSArKysrKysrLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaCAg
ICAgICAgICAgIHwgMjA0ICsrKysrLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9hY3RpdmVfdHlwZXMuaCAgICAgIHwgIDE3ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbS5jICAgICAgICAgICAgICAgfCAgNTAgKysrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtX2d0dC5jICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9yZXF1ZXN0LmMgICAgICAgICAgIHwgIDU2ICstLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3JlcXVlc3QuaCAgICAgICAgICAgfCAgIDEgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV90aW1lbGluZS5jICAgICAgICAgIHwgICA5ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3RpbWVsaW5lX3R5cGVzLmggICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfdm1hLmMgICAgICAgICAgICAgICB8ICAzNiArLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9mcm9udGJ1ZmZlci5jICAgICAgfCAgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX292ZXJsYXkuYyAgICAgICAgICB8ICAgNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfYWN0aXZlLmMgIHwgICA1ICstCiAuLi4vZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9tb2NrX3RpbWVsaW5lLmMgICAgfCAgIDIgKy0KIDIyIGZpbGVzIGNoYW5nZWQsIDIyOSBpbnNl
cnRpb25zKCspLCAzNzQgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9jb250ZXh0LmMKaW5kZXggODM3Y2FkMjMzY2M2Li4yZTY4NGY4MTUxZDkgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwpAQCAtOTA5LDIwICs5
MDksMTggQEAgc3RhdGljIGludCBjb250ZXh0X2JhcnJpZXJfdGFzayhzdHJ1Y3QgaTkxNV9nZW1f
Y29udGV4dCAqY3R4LAogCQkJCXZvaWQgKCp0YXNrKSh2b2lkICpkYXRhKSwKIAkJCQl2b2lkICpk
YXRhKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY3R4LT5pOTE1OwogCXN0
cnVjdCBjb250ZXh0X2JhcnJpZXJfdGFzayAqY2I7CiAJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNf
aXRlciBpdDsKIAlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CiAJaW50IGVyciA9IDA7CiAKLQls
b2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlHRU1fQlVHX09O
KCF0YXNrKTsKIAogCWNiID0ga21hbGxvYyhzaXplb2YoKmNiKSwgR0ZQX0tFUk5FTCk7CiAJaWYg
KCFjYikKIAkJcmV0dXJuIC1FTk9NRU07CiAKLQlpOTE1X2FjdGl2ZV9pbml0KGk5MTUsICZjYi0+
YmFzZSwgTlVMTCwgY2JfcmV0aXJlKTsKKwlpOTE1X2FjdGl2ZV9pbml0KCZjYi0+YmFzZSwgTlVM
TCwgY2JfcmV0aXJlKTsKIAllcnIgPSBpOTE1X2FjdGl2ZV9hY3F1aXJlKCZjYi0+YmFzZSk7CiAJ
aWYgKGVycikgewogCQlrZnJlZShjYik7CkBAIC05NTQsNyArOTUyLDkgQEAgc3RhdGljIGludCBj
b250ZXh0X2JhcnJpZXJfdGFzayhzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCQlpZiAo
ZW1pdCkKIAkJCWVyciA9IGVtaXQocnEsIGRhdGEpOwogCQlpZiAoZXJyID09IDApCi0JCQllcnIg
PSBpOTE1X2FjdGl2ZV9yZWYoJmNiLT5iYXNlLCBycS0+ZmVuY2UuY29udGV4dCwgcnEpOworCQkJ
ZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZjYi0+YmFzZSwKKwkJCQkJICAgICAgcnEtPmZlbmNlLmNv
bnRleHQsCisJCQkJCSAgICAgICZycS0+ZmVuY2UpOwogCiAJCWk5MTVfcmVxdWVzdF9hZGQocnEp
OwogCQlpZiAoZXJyKQpAQCAtMTE4OCw3ICsxMTg4LDcgQEAgZ2VuOF9tb2RpZnlfcnBjcyhzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqY2UsIHN0cnVjdCBpbnRlbF9zc2V1IHNzZXUpCiAJCXJldHVybiBQ
VFJfRVJSKHJxKTsKIAogCS8qIFF1ZXVlIHRoaXMgc3dpdGNoIGFmdGVyIGFsbCBvdGhlciBhY3Rp
dml0eSBieSB0aGlzIGNvbnRleHQuICovCi0JcmV0ID0gaTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQo
JmNlLT5yaW5nLT50aW1lbGluZS0+bGFzdF9yZXF1ZXN0LCBycSk7CisJcmV0ID0gaTkxNV9hY3Rp
dmVfZmVuY2Vfc2V0KCZjZS0+cmluZy0+dGltZWxpbmUtPmxhc3RfcmVxdWVzdCwgcnEpOwogCWlm
IChyZXQpCiAJCWdvdG8gb3V0X2FkZDsKIApAQCAtMTIwMCw3ICsxMjAwLDcgQEAgZ2VuOF9tb2Rp
ZnlfcnBjcyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHN0cnVjdCBpbnRlbF9zc2V1IHNzZXUp
CiAJICogd29yZHMgdHJhbnNmZXIgdGhlIHBpbm5lZCBjZSBvYmplY3QgdG8gdHJhY2tlZCBhY3Rp
dmUgcmVxdWVzdC4KIAkgKi8KIAlHRU1fQlVHX09OKGk5MTVfYWN0aXZlX2lzX2lkbGUoJmNlLT5h
Y3RpdmUpKTsKLQlyZXQgPSBpOTE1X2FjdGl2ZV9yZWYoJmNlLT5hY3RpdmUsIHJxLT5mZW5jZS5j
b250ZXh0LCBycSk7CisJcmV0ID0gaTkxNV9hY3RpdmVfcmVmKCZjZS0+YWN0aXZlLCBycS0+ZmVu
Y2UuY29udGV4dCwgJnJxLT5mZW5jZSk7CiAJaWYgKHJldCkKIAkJZ290byBvdXRfYWRkOwogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwppbmRleCAy
YzRmMzIyOTM2MWQuLjYxOTNjODFlYmJlZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCkBAIC0xMzE2LDcgKzEzMTYsNyBAQCByZWxvY2F0ZV9l
bnRyeShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKIAogCWlmICghZWItPnJlbG9jX2NhY2hlLnZhZGRy
ICYmCiAJICAgIChEQkdfRk9SQ0VfUkVMT0MgPT0gRk9SQ0VfR1BVX1JFTE9DIHx8Ci0JICAgICAh
cmVzZXJ2YXRpb25fb2JqZWN0X3Rlc3Rfc2lnbmFsZWRfcmN1KHZtYS0+cmVzdiwgdHJ1ZSkpKSB7
CisJICAgICBpOTE1X3ZtYV9pc19hY3RpdmUodm1hKSkpIHsKIAkJY29uc3QgdW5zaWduZWQgaW50
IGdlbiA9IGViLT5yZWxvY19jYWNoZS5nZW47CiAJCXVuc2lnbmVkIGludCBsZW47CiAJCXUzMiAq
YmF0Y2g7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2Jq
ZWN0X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5
cGVzLmgKaW5kZXggMjFiZmI3YmQwZjU3Li5lODdmY2E0ZDgxOTQgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgKQEAgLTExLDYgKzExLDgg
QEAKIAogI2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+CiAKKyNpbmNsdWRlIDx1YXBpL2RybS9pOTE1
X2RybS5oPgorCiAjaW5jbHVkZSAiaTkxNV9hY3RpdmUuaCIKICNpbmNsdWRlICJpOTE1X3NlbGZ0
ZXN0LmgiCiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9w
bS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKaW5kZXggYjBmMzc2
MjFkZTlmLi4yODMwOTJhYzEzZmUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9w
bS5jCkBAIC0xNSwxNCArMTUsMTEgQEAgc3RhdGljIHZvaWQgY2FsbF9pZGxlX2JhcnJpZXJzKHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlzdHJ1Y3QgbGxpc3Rfbm9kZSAqbm9kZSwg
Km5leHQ7CiAKIAlsbGlzdF9mb3JfZWFjaF9zYWZlKG5vZGUsIG5leHQsIGxsaXN0X2RlbF9hbGwo
JmVuZ2luZS0+YmFycmllcl90YXNrcykpIHsKLQkJc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3Qg
KmFjdGl2ZSA9CisJCXN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAqYWN0aXZlID0KIAkJCWNvbnRh
aW5lcl9vZigoc3RydWN0IGxpc3RfaGVhZCAqKW5vZGUsCi0JCQkJICAgICB0eXBlb2YoKmFjdGl2
ZSksIGxpbmspOworCQkJCSAgICAgdHlwZW9mKCphY3RpdmUpLCBjYi5ub2RlKTsKIAotCQlJTklU
X0xJU1RfSEVBRCgmYWN0aXZlLT5saW5rKTsKLQkJUkNVX0lOSVRfUE9JTlRFUihhY3RpdmUtPnJl
cXVlc3QsIE5VTEwpOwotCi0JCWFjdGl2ZS0+cmV0aXJlKGFjdGl2ZSwgTlVMTCk7CisJCWFjdGl2
ZS0+Y2IuZnVuYyhOVUxMLCAmYWN0aXZlLT5jYik7CiAJfQogfQogCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9jb250ZXh0LmMKaW5kZXggYjlmZWEzMWNmOWVjLi5hMzI2OThmNzY0NWYgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKQEAgLTE4Miw3ICsxODIsNyBA
QCBpbnRlbF9jb250ZXh0X2luaXQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCiAJbXV0ZXhf
aW5pdCgmY2UtPnBpbl9tdXRleCk7CiAKLQlpOTE1X2FjdGl2ZV9pbml0KGN0eC0+aTkxNSwgJmNl
LT5hY3RpdmUsCisJaTkxNV9hY3RpdmVfaW5pdCgmY2UtPmFjdGl2ZSwKIAkJCSBfX2ludGVsX2Nv
bnRleHRfYWN0aXZlLCBfX2ludGVsX2NvbnRleHRfcmV0aXJlKTsKIH0KIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3Jlc2V0LmMKaW5kZXggMWY4MzFmZTc1OWE1Li5jNWE3NzI4ODllYTUgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwpAQCAtODgxLDEwICs4ODEsMTAgQEAg
c3RhdGljIGJvb2wgX19pOTE1X2dlbV91bnNldF93ZWRnZWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCiAJICovCiAJbXV0ZXhfbG9jaygmaTkxNS0+Z3QudGltZWxpbmVzLm11dGV4KTsK
IAlsaXN0X2Zvcl9lYWNoX2VudHJ5KHRsLCAmaTkxNS0+Z3QudGltZWxpbmVzLmFjdGl2ZV9saXN0
LCBsaW5rKSB7Ci0JCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCQlzdHJ1Y3QgZG1hX2ZlbmNl
ICpmZW5jZTsKIAotCQlycSA9IGk5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3VubG9ja2VkKCZ0bC0+
bGFzdF9yZXF1ZXN0KTsKLQkJaWYgKCFycSkKKwkJZmVuY2UgPSBpOTE1X2FjdGl2ZV9mZW5jZV9n
ZXQoJnRsLT5sYXN0X3JlcXVlc3QpOworCQlpZiAoIWZlbmNlKQogCQkJY29udGludWU7CiAKIAkJ
LyoKQEAgLTg5NCw4ICs4OTQsOCBAQCBzdGF0aWMgYm9vbCBfX2k5MTVfZ2VtX3Vuc2V0X3dlZGdl
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJICogKEk5MTVfRkVOQ0VfVElNRU9V
VCkgc28gdGhpcyB3YWl0IHNob3VsZCBub3QgYmUgdW5ib3VuZGVkCiAJCSAqIGluIHRoZSB3b3Jz
dCBjYXNlLgogCQkgKi8KLQkJZG1hX2ZlbmNlX2RlZmF1bHRfd2FpdCgmcnEtPmZlbmNlLCBmYWxz
ZSwgTUFYX1NDSEVEVUxFX1RJTUVPVVQpOwotCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKKwkJZG1h
X2ZlbmNlX2RlZmF1bHRfd2FpdChmZW5jZSwgZmFsc2UsIE1BWF9TQ0hFRFVMRV9USU1FT1VUKTsK
KwkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7CiAJfQogCW11dGV4X3VubG9jaygmaTkxNS0+Z3QudGlt
ZWxpbmVzLm11dGV4KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwppbmRl
eCAzMzgxMTFkNjkwYWMuLjlmYzAzYTQwMDY4NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RfbHJjLmMKQEAgLTg1NCw3ICs4NTQsNiBAQCBzdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVz
dCAqZHVtbXlfcmVxdWVzdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJaWYgKCFy
cSkKIAkJcmV0dXJuIE5VTEw7CiAKLQlJTklUX0xJU1RfSEVBRCgmcnEtPmFjdGl2ZV9saXN0KTsK
IAlycS0+ZW5naW5lID0gZW5naW5lOwogCiAJaTkxNV9zY2hlZF9ub2RlX2luaXQoJnJxLT5zY2hl
ZCk7CkBAIC05NDUsOCArOTQ0LDggQEAgc3RhdGljIGludCBsaXZlX3N1cHByZXNzX3dhaXRfcHJl
ZW1wdCh2b2lkICphcmcpCiAJCQkJfQogCiAJCQkJLyogRGlzYWJsZSBORVdDTElFTlQgcHJvbW90
aW9uICovCi0JCQkJX19pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldCgmcnFbaV0tPnRpbWVsaW5lLT5s
YXN0X3JlcXVlc3QsCi0JCQkJCQkJICBkdW1teSk7CisJCQkJX19pOTE1X2FjdGl2ZV9mZW5jZV9z
ZXQoJnJxW2ldLT50aW1lbGluZS0+bGFzdF9yZXF1ZXN0LAorCQkJCQkJCSZkdW1teS0+ZmVuY2Up
OwogCQkJCWk5MTVfcmVxdWVzdF9hZGQocnFbaV0pOwogCQkJfQogCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dnQvc2NoZWR1bGVyLmMKaW5kZXggNmNkNzJkZDk2YTRiLi4zMTc1MmI3ZWJmZjUgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKQEAgLTM5MSwxMSArMzkxLDggQEAgaW50ZWxfZ3Z0
X3dvcmtsb2FkX3JlcV9hbGxvYyhzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQp
CiB7CiAJc3RydWN0IGludGVsX3ZncHUgKnZncHUgPSB3b3JrbG9hZC0+dmdwdTsKIAlzdHJ1Y3Qg
aW50ZWxfdmdwdV9zdWJtaXNzaW9uICpzID0gJnZncHUtPnN1Ym1pc3Npb247Ci0Jc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdmdwdS0+Z3Z0LT5kZXZfcHJpdjsKIAlzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycTsKIAotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9wcml2LT5kcm0u
c3RydWN0X211dGV4KTsKLQogCWlmICh3b3JrbG9hZC0+cmVxKQogCQlyZXR1cm4gMDsKIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKaW5kZXggZjdmZmE2ZTdiZDlhLi42NWE5YWQyZmM5Yzcg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYwpAQCAtOCw4ICs4LDYgQEAKICNpbmNsdWRl
ICJpOTE1X2FjdGl2ZS5oIgogI2luY2x1ZGUgImk5MTVfZ2xvYmFscy5oIgogCi0jZGVmaW5lIEJL
TChyZWYpICgmKHJlZiktPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpCi0KIC8qCiAgKiBBY3RpdmUg
cmVmcyBtZW1vcnkgbWFuYWdlbWVudAogICoKQEAgLTIzLDcgKzIxLDcgQEAgc3RhdGljIHN0cnVj
dCBpOTE1X2dsb2JhbF9hY3RpdmUgewogfSBnbG9iYWw7CiAKIHN0cnVjdCBhY3RpdmVfbm9kZSB7
Ci0Jc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgYmFzZTsKKwlzdHJ1Y3QgaTkxNV9hY3RpdmVf
ZmVuY2UgYmFzZTsKIAlzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZjsKIAlzdHJ1Y3QgcmJfbm9kZSBu
b2RlOwogCXU2NCB0aW1lbGluZTsKQEAgLTMyLDExICszMCwxMiBAQCBzdHJ1Y3QgYWN0aXZlX25v
ZGUgewogc3RhdGljIHZvaWQKIF9fYWN0aXZlX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJl
ZikKIHsKLQlzdHJ1Y3QgcmJfcm9vdCByb290ID0gUkJfUk9PVDsKIAlzdHJ1Y3QgYWN0aXZlX25v
ZGUgKml0LCAqbjsKKwlzdHJ1Y3QgcmJfcm9vdCByb290OwogCWJvb2wgcmV0aXJlID0gZmFsc2U7
CiAKIAlsb2NrZGVwX2Fzc2VydF9oZWxkKCZyZWYtPm11dGV4KTsKKwlHRU1fQlVHX09OKGk5MTVf
YWN0aXZlX2lzX2lkbGUocmVmKSk7CiAKIAkvKiByZXR1cm4gdGhlIHVudXNlZCBub2RlcyB0byBv
dXIgc2xhYmNhY2hlIC0tIGZsdXNoaW5nIHRoZSBhbGxvY2F0b3IgKi8KIAlpZiAoYXRvbWljX2Rl
Y19hbmRfdGVzdCgmcmVmLT5jb3VudCkpIHsKQEAgLTQ3LDEyICs0NiwxMyBAQCBfX2FjdGl2ZV9y
ZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCiAJfQogCiAJbXV0ZXhfdW5sb2NrKCZyZWYt
Pm11dGV4KTsKKwlpZiAoIXJldGlyZSkKKwkJcmV0dXJuOwogCi0JaWYgKHJldGlyZSkKLQkJcmVm
LT5yZXRpcmUocmVmKTsKKwlyZWYtPnJldGlyZShyZWYpOwogCiAJcmJ0cmVlX3Bvc3RvcmRlcl9m
b3JfZWFjaF9lbnRyeV9zYWZlKGl0LCBuLCAmcm9vdCwgbm9kZSkgewotCQlHRU1fQlVHX09OKGk5
MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQoJml0LT5iYXNlKSk7CisJCUdFTV9CVUdfT04oaTkxNV9h
Y3RpdmVfZmVuY2VfaXNzZXQoJml0LT5iYXNlKSk7CiAJCWttZW1fY2FjaGVfZnJlZShnbG9iYWwu
c2xhYl9jYWNoZSwgaXQpOwogCX0KIH0KQEAgLTg2LDEyICs4NiwxMyBAQCBhY3RpdmVfcmV0aXJl
KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQogfQogCiBzdGF0aWMgdm9pZAotbm9kZV9yZXRpcmUo
c3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmJhc2UsIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
KQorbm9kZV9yZXRpcmUoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UsIHN0cnVjdCBkbWFfZmVuY2Vf
Y2IgKmNiKQogewotCWFjdGl2ZV9yZXRpcmUoY29udGFpbmVyX29mKGJhc2UsIHN0cnVjdCBhY3Rp
dmVfbm9kZSwgYmFzZSktPnJlZik7CisJaTkxNV9hY3RpdmVfZmVuY2VfY2IoZmVuY2UsIGNiKTsK
KwlhY3RpdmVfcmV0aXJlKGNvbnRhaW5lcl9vZihjYiwgc3RydWN0IGFjdGl2ZV9ub2RlLCBiYXNl
LmNiKS0+cmVmKTsKIH0KIAotc3RhdGljIHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICoKK3N0
YXRpYyBzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKgogYWN0aXZlX2luc3RhbmNlKHN0cnVjdCBp
OTE1X2FjdGl2ZSAqcmVmLCB1NjQgaWR4KQogewogCXN0cnVjdCBhY3RpdmVfbm9kZSAqbm9kZSwg
KnByZWFsbG9jOwpAQCAtMTE0LDYgKzExNSw3IEBAIGFjdGl2ZV9pbnN0YW5jZShzdHJ1Y3QgaTkx
NV9hY3RpdmUgKnJlZiwgdTY0IGlkeCkKIAkJcmV0dXJuIE5VTEw7CiAKIAltdXRleF9sb2NrKCZy
ZWYtPm11dGV4KTsKKwlHRU1fQlVHX09OKGk5MTVfYWN0aXZlX2lzX2lkbGUocmVmKSk7CiAKIAlw
YXJlbnQgPSBOVUxMOwogCXAgPSAmcmVmLT50cmVlLnJiX25vZGU7CkBAIC0xMjEsNyArMTIzLDcg
QEAgYWN0aXZlX2luc3RhbmNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCB1NjQgaWR4KQogCQlw
YXJlbnQgPSAqcDsKIAogCQlub2RlID0gcmJfZW50cnkocGFyZW50LCBzdHJ1Y3QgYWN0aXZlX25v
ZGUsIG5vZGUpOwotCQlpZiAobm9kZS0+dGltZWxpbmUgPT0gaWR4ICYmICFJU19FUlIobm9kZS0+
YmFzZS5yZXF1ZXN0KSkgeworCQlpZiAobm9kZS0+dGltZWxpbmUgPT0gaWR4ICYmICFJU19FUlIo
bm9kZS0+YmFzZS5mZW5jZSkpIHsKIAkJCWttZW1fY2FjaGVfZnJlZShnbG9iYWwuc2xhYl9jYWNo
ZSwgcHJlYWxsb2MpOwogCQkJZ290byBvdXQ7CiAJCX0KQEAgLTEzMyw3ICsxMzUsOCBAQCBhY3Rp
dmVfaW5zdGFuY2Uoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsIHU2NCBpZHgpCiAJfQogCiAJbm9k
ZSA9IHByZWFsbG9jOwotCWk5MTVfYWN0aXZlX3JlcXVlc3RfaW5pdCgmbm9kZS0+YmFzZSwgTlVM
TCwgbm9kZV9yZXRpcmUpOworCVJDVV9JTklUX1BPSU5URVIobm9kZS0+YmFzZS5mZW5jZSwgTlVM
TCk7CisJbm9kZS0+YmFzZS5jYi5mdW5jID0gbm9kZV9yZXRpcmU7CiAJbm9kZS0+cmVmID0gcmVm
OwogCW5vZGUtPnRpbWVsaW5lID0gaWR4OwogCkBAIC0xNDcsMTMgKzE1MCwxMSBAQCBhY3RpdmVf
aW5zdGFuY2Uoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsIHU2NCBpZHgpCiAJcmV0dXJuICZub2Rl
LT5iYXNlOwogfQogCi12b2lkIF9faTkxNV9hY3RpdmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKLQkJCXN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAordm9pZCBfX2k5MTVfYWN0
aXZlX2luaXQoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCiAJCQlpbnQgKCphY3RpdmUpKHN0cnVj
dCBpOTE1X2FjdGl2ZSAqcmVmKSwKIAkJCXZvaWQgKCpyZXRpcmUpKHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmKSwKIAkJCXN0cnVjdCBsb2NrX2NsYXNzX2tleSAqa2V5KQogewotCXJlZi0+aTkxNSA9
IGk5MTU7CiAJcmVmLT5hY3RpdmUgPSBhY3RpdmU7CiAJcmVmLT5yZXRpcmUgPSByZXRpcmU7CiAJ
cmVmLT50cmVlID0gUkJfUk9PVDsKQEAgLTE2Niw5ICsxNjcsOSBAQCB2b2lkIF9faTkxNV9hY3Rp
dmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAogaW50IGk5MTVfYWN0aXZl
X3JlZihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwKIAkJICAgIHU2NCB0aW1lbGluZSwKLQkJICAg
IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQorCQkgICAgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2Up
CiB7Ci0Jc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZTsKKwlzdHJ1Y3QgaTkxNV9h
Y3RpdmVfZmVuY2UgKmFjdGl2ZTsKIAlpbnQgZXJyOwogCiAJLyogUHJldmVudCByZWFwaW5nIGlu
IGNhc2Ugd2UgbWFsbG9jL3dhaXQgd2hpbGUgYnVpbGRpbmcgdGhlIHRyZWUgKi8KQEAgLTE4Miw5
ICsxODMsOSBAQCBpbnQgaTkxNV9hY3RpdmVfcmVmKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAog
CQlnb3RvIG91dDsKIAl9CiAKLQlpZiAoIWk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQoYWN0aXZl
KSkKKwlHRU1fQlVHX09OKCFhdG9taWNfcmVhZCgmcmVmLT5jb3VudCkpOworCWlmICghX19pOTE1
X2FjdGl2ZV9mZW5jZV9zZXQoYWN0aXZlLCBmZW5jZSkpCiAJCWF0b21pY19pbmMoJnJlZi0+Y291
bnQpOwotCV9faTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoYWN0aXZlLCBycSk7CiAKIG91dDoKIAlp
OTE1X2FjdGl2ZV9yZWxlYXNlKHJlZik7CkBAIC0yMjIsNjAgKzIyMywzMyBAQCBpbnQgaTkxNV9h
Y3RpdmVfd2FpdChzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKIAlzdHJ1Y3QgYWN0aXZlX25vZGUg
Kml0LCAqbjsKIAlpbnQgZXJyOwogCisJbWlnaHRfc2xlZXAoKTsKIAlpZiAoUkJfRU1QVFlfUk9P
VCgmcmVmLT50cmVlKSkKIAkJcmV0dXJuIDA7CiAKLQllcnIgPSBpOTE1X2FjdGl2ZV9hY3F1aXJl
KHJlZik7IC8qIEF2b2lkIHJldGlyaW5nIG91cnNlbHZlcyAqLworCWVyciA9IG11dGV4X2xvY2tf
aW50ZXJydXB0aWJsZSgmcmVmLT5tdXRleCk7CiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIAot
CWVyciA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmcmVmLT5tdXRleCk7Ci0JaWYgKGVycikK
LQkJZ290byBvdXQ7CisJaWYgKCFhdG9taWNfYWRkX3VubGVzcygmcmVmLT5jb3VudCwgMSwgMCkp
CisJCWdvdG8gdW5sb2NrOwogCiAJcmJ0cmVlX3Bvc3RvcmRlcl9mb3JfZWFjaF9lbnRyeV9zYWZl
KGl0LCBuLCAmcmVmLT50cmVlLCBub2RlKSB7Ci0JCWVyciA9IGk5MTVfYWN0aXZlX3JlcXVlc3Rf
cmV0aXJlKCZpdC0+YmFzZSwgQktMKHJlZikpOwotCQlpZiAoZXJyKQotCQkJYnJlYWs7Ci0JfQot
CW11dGV4X3VubG9jaygmcmVmLT5tdXRleCk7CisJCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwog
Ci1vdXQ6Ci0JaTkxNV9hY3RpdmVfcmVsZWFzZShyZWYpOwotCXJldHVybiBlcnI7Ci19Ci0KLWlu
dCBpOTE1X3JlcXVlc3RfYXdhaXRfYWN0aXZlX3JlcXVlc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnEsCi0JCQkJICAgICAgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSkKLXsKLQlz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpiYXJyaWVyID0KLQkJaTkxNV9hY3RpdmVfcmVxdWVzdF9yYXco
YWN0aXZlLCAmcnEtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCi0JcmV0dXJuIGJhcnJpZXIg
PyBpOTE1X3JlcXVlc3RfYXdhaXRfZG1hX2ZlbmNlKHJxLCAmYmFycmllci0+ZmVuY2UpIDogMDsK
LX0KKwkJZmVuY2UgPSBpOTE1X2FjdGl2ZV9mZW5jZV9nZXQoJml0LT5iYXNlKTsKKwkJaWYgKCFm
ZW5jZSkKKwkJCWNvbnRpbnVlOwogCi1pbnQgaTkxNV9yZXF1ZXN0X2F3YWl0X2FjdGl2ZShzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpycSwgc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCi17Ci0Jc3RydWN0
IGFjdGl2ZV9ub2RlICppdCwgKm47Ci0JaW50IGVycjsKLQotCWlmIChSQl9FTVBUWV9ST09UKCZy
ZWYtPnRyZWUpKQotCQlyZXR1cm4gMDsKLQotCS8qIGF3YWl0IGFsbG9jYXRlcyBhbmQgc28gd2Ug
bmVlZCB0byBhdm9pZCBoaXR0aW5nIHRoZSBzaHJpbmtlciAqLwotCWVyciA9IGk5MTVfYWN0aXZl
X2FjcXVpcmUocmVmKTsKLQlpZiAoZXJyKQotCQlyZXR1cm4gZXJyOwotCi0JbXV0ZXhfbG9jaygm
cmVmLT5tdXRleCk7Ci0JcmJ0cmVlX3Bvc3RvcmRlcl9mb3JfZWFjaF9lbnRyeV9zYWZlKGl0LCBu
LCAmcmVmLT50cmVlLCBub2RlKSB7Ci0JCWVyciA9IGk5MTVfcmVxdWVzdF9hd2FpdF9hY3RpdmVf
cmVxdWVzdChycSwgJml0LT5iYXNlKTsKKwkJZXJyID0gZG1hX2ZlbmNlX3dhaXQoZmVuY2UsIHRy
dWUpOworCQlkbWFfZmVuY2VfcHV0KGZlbmNlKTsKIAkJaWYgKGVycikKIAkJCWJyZWFrOwogCX0K
LQltdXRleF91bmxvY2soJnJlZi0+bXV0ZXgpOworCV9fYWN0aXZlX3JldGlyZShyZWYpOwogCi0J
aTkxNV9hY3RpdmVfcmVsZWFzZShyZWYpOwordW5sb2NrOgorCW11dGV4X3VubG9jaygmcmVmLT5t
dXRleCk7CiAJcmV0dXJuIGVycjsKIH0KIApAQCAtMzA2LDEzICsyODAsMTMgQEAgaW50IGk5MTVf
YWN0aXZlX2FjcXVpcmVfcHJlYWxsb2NhdGVfYmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJl
ZiwKIAkJCWJyZWFrOwogCQl9CiAKLQkJaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KCZub2RlLT5i
YXNlLAotCQkJCQkgKHZvaWQgKillbmdpbmUsIG5vZGVfcmV0aXJlKTsKKwkJUkNVX0lOSVRfUE9J
TlRFUihub2RlLT5iYXNlLmZlbmNlLCAodm9pZCAqKWVuZ2luZSk7CisJCW5vZGUtPmJhc2UuY2Iu
ZnVuYyA9IG5vZGVfcmV0aXJlOwogCQlub2RlLT50aW1lbGluZSA9IGtjdHgtPnJpbmctPnRpbWVs
aW5lLT5mZW5jZV9jb250ZXh0OwogCQlub2RlLT5yZWYgPSByZWY7CiAJCWF0b21pY19pbmMoJnJl
Zi0+Y291bnQpOwogCi0JCWxsaXN0X2FkZCgoc3RydWN0IGxsaXN0X25vZGUgKikmbm9kZS0+YmFz
ZS5saW5rLAorCQlsbGlzdF9hZGQoKHN0cnVjdCBsbGlzdF9ub2RlICopJm5vZGUtPmJhc2UuY2Iu
bm9kZSwKIAkJCSAgJnJlZi0+YmFycmllcnMpOwogCX0KIApAQCAtMzMyLDEwICszMDYsMTAgQEAg
dm9pZCBpOTE1X2FjdGl2ZV9hY3F1aXJlX2JhcnJpZXIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYp
CiAJCXN0cnVjdCByYl9ub2RlICoqcCwgKnBhcmVudDsKIAogCQlub2RlID0gY29udGFpbmVyX29m
KChzdHJ1Y3QgbGlzdF9oZWFkICopcG9zLAotCQkJCSAgICB0eXBlb2YoKm5vZGUpLCBiYXNlLmxp
bmspOworCQkJCSAgICB0eXBlb2YoKm5vZGUpLCBiYXNlLmNiLm5vZGUpOwogCi0JCWVuZ2luZSA9
ICh2b2lkICopcmN1X2FjY2Vzc19wb2ludGVyKG5vZGUtPmJhc2UucmVxdWVzdCk7Ci0JCVJDVV9J
TklUX1BPSU5URVIobm9kZS0+YmFzZS5yZXF1ZXN0LCBFUlJfUFRSKC1FQUdBSU4pKTsKKwkJZW5n
aW5lID0gKHZvaWQgKilyY3VfYWNjZXNzX3BvaW50ZXIobm9kZS0+YmFzZS5mZW5jZSk7CisJCVJD
VV9JTklUX1BPSU5URVIobm9kZS0+YmFzZS5mZW5jZSwgRVJSX1BUUigtRUFHQUlOKSk7CiAKIAkJ
cGFyZW50ID0gTlVMTDsKIAkJcCA9ICZyZWYtPnRyZWUucmJfbm9kZTsKQEAgLTM1MSw3ICszMjUs
NyBAQCB2b2lkIGk5MTVfYWN0aXZlX2FjcXVpcmVfYmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUg
KnJlZikKIAkJcmJfbGlua19ub2RlKCZub2RlLT5ub2RlLCBwYXJlbnQsIHApOwogCQlyYl9pbnNl
cnRfY29sb3IoJm5vZGUtPm5vZGUsICZyZWYtPnRyZWUpOwogCi0JCWxsaXN0X2FkZCgoc3RydWN0
IGxsaXN0X25vZGUgKikmbm9kZS0+YmFzZS5saW5rLAorCQlsbGlzdF9hZGQoKHN0cnVjdCBsbGlz
dF9ub2RlICopJm5vZGUtPmJhc2UuY2Iubm9kZSwKIAkJCSAgJmVuZ2luZS0+YmFycmllcl90YXNr
cyk7CiAJfQogCW11dGV4X3VubG9jaygmcmVmLT5tdXRleCk7CkBAIC0zNjEsMjkgKzMzNSw2NiBA
QCB2b2lkIGk5MTVfcmVxdWVzdF9hZGRfYmFycmllcnMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEp
CiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lID0gcnEtPmVuZ2luZTsKIAlzdHJ1
Y3QgbGxpc3Rfbm9kZSAqbm9kZSwgKm5leHQ7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKworCUdF
TV9CVUdfT04oaW50ZWxfZW5naW5lX2lzX3ZpcnR1YWwoZW5naW5lKSk7CisJbm9kZSA9IGxsaXN0
X2RlbF9hbGwoJmVuZ2luZS0+YmFycmllcl90YXNrcyk7CisJaWYgKCFub2RlKQorCQlyZXR1cm47
CiAKLQlsbGlzdF9mb3JfZWFjaF9zYWZlKG5vZGUsIG5leHQsIGxsaXN0X2RlbF9hbGwoJmVuZ2lu
ZS0+YmFycmllcl90YXNrcykpCi0JCWxpc3RfYWRkX3RhaWwoKHN0cnVjdCBsaXN0X2hlYWQgKilu
b2RlLCAmcnEtPmFjdGl2ZV9saXN0KTsKKwlzcGluX2xvY2tfaXJxc2F2ZSgmcnEtPmxvY2ssIGZs
YWdzKTsKKwlsbGlzdF9mb3JfZWFjaF9zYWZlKG5vZGUsIG5leHQsIG5vZGUpCisJCWxpc3RfYWRk
X3RhaWwoKHN0cnVjdCBsaXN0X2hlYWQgKilub2RlLCAmcnEtPmZlbmNlLmNiX2xpc3QpOworCXNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJnJxLT5sb2NrLCBmbGFncyk7CiB9CiAKLWludCBpOTE1X2Fj
dGl2ZV9yZXF1ZXN0X3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAotCQkJ
ICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQorc3RydWN0IGRtYV9mZW5jZSAqCitfX2k5MTVf
YWN0aXZlX2ZlbmNlX3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSwKKwkJCXN0
cnVjdCBkbWFfZmVuY2UgKmZlbmNlKQogeworCXN0cnVjdCBkbWFfZmVuY2UgKm9sZDsKKwl1bnNp
Z25lZCBsb25nIGZsYWdzOworCisJc3Bpbl9sb2NrX2lycXNhdmUoZmVuY2UtPmxvY2ssIGZsYWdz
KTsKKwlHRU1fQlVHX09OKHRlc3RfYml0KERNQV9GRU5DRV9GTEFHX1NJR05BTEVEX0JJVCwgJmZl
bmNlLT5mbGFncykpOworCisJb2xkID0gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChhY3RpdmUt
PmZlbmNlLCAxKTsKKwlpZiAob2xkKSB7CisJCXNwaW5fbG9ja19uZXN0ZWQob2xkLT5sb2NrLCBT
SU5HTEVfREVQVEhfTkVTVElORyk7CisJCV9fbGlzdF9kZWxfZW50cnkoJmFjdGl2ZS0+Y2Iubm9k
ZSk7CisJCXNwaW5fdW5sb2NrKG9sZC0+bG9jayk7CisJfQorCisJcmN1X2Fzc2lnbl9wb2ludGVy
KGFjdGl2ZS0+ZmVuY2UsIGZlbmNlKTsKKwlsaXN0X2FkZF90YWlsKCZhY3RpdmUtPmNiLm5vZGUs
ICZmZW5jZS0+Y2JfbGlzdCk7CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKGZlbmNlLT5sb2Nr
LCBmbGFncyk7CisKKwlyZXR1cm4gb2xkOworfQorCitpbnQgaTkxNV9hY3RpdmVfZmVuY2Vfc2V0
KHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAqYWN0aXZlLAorCQkJICBzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSkKK3sKKwlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKIAlpbnQgZXJyOwogCiAJLyog
TXVzdCBtYWludGFpbiBvcmRlcmluZyB3cnQgcHJldmlvdXMgYWN0aXZlIHJlcXVlc3RzICovCi0J
ZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X2FjdGl2ZV9yZXF1ZXN0KHJxLCBhY3RpdmUpOwotCWlm
IChlcnIpCi0JCXJldHVybiBlcnI7CisJZmVuY2UgPSBpOTE1X2FjdGl2ZV9mZW5jZV9nZXQoYWN0
aXZlKTsKKwlpZiAoZmVuY2UpIHsKKwkJZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X2RtYV9mZW5j
ZShycSwgZmVuY2UpOworCQlkbWFfZmVuY2VfcHV0KGZlbmNlKTsKKwkJaWYgKGVycikKKwkJCXJl
dHVybiBlcnI7CisJfQogCi0JX19pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldChhY3RpdmUsIHJxKTsK
KwlfX2k5MTVfYWN0aXZlX2ZlbmNlX3NldChhY3RpdmUsICZycS0+ZmVuY2UpOwogCXJldHVybiAw
OwogfQogCi12b2lkIGk5MTVfYWN0aXZlX3JldGlyZV9ub29wKHN0cnVjdCBpOTE1X2FjdGl2ZV9y
ZXF1ZXN0ICphY3RpdmUsCi0JCQkgICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QpCit2
b2lkIGk5MTVfYWN0aXZlX25vb3Aoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UsIHN0cnVjdCBkbWFf
ZmVuY2VfY2IgKmNiKQogewotCS8qIFNwYWNlIGxlZnQgaW50ZW50aW9uYWxseSBibGFuayAqLwor
CWk5MTVfYWN0aXZlX2ZlbmNlX2NiKGZlbmNlLCBjYik7CiB9CiAKICNpZiBJU19FTkFCTEVEKENP
TkZJR19EUk1fSTkxNV9TRUxGVEVTVCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfYWN0aXZlLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oCmluZGV4
IGJkZWM0ZjgxYjZlOC4uMjFhOWNlNmZhNDYxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2FjdGl2ZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZl
LmgKQEAgLTEwLDcgKzEwLDkgQEAKICNpbmNsdWRlIDxsaW51eC9sb2NrZGVwLmg+CiAKICNpbmNs
dWRlICJpOTE1X2FjdGl2ZV90eXBlcy5oIgotI2luY2x1ZGUgImk5MTVfcmVxdWVzdC5oIgorCitz
dHJ1Y3QgaTkxNV9yZXF1ZXN0Oworc3RydWN0IGludGVsX2VuZ2luZV9jczsKIAogLyoKICAqIFdl
IHRyZWF0IHJlcXVlc3RzIGFzIGZlbmNlcy4gVGhpcyBpcyBub3QgYmUgdG8gY29uZnVzZWQgd2l0
aCBvdXIKQEAgLTI4LDEyOCArMzAsNjIgQEAKICAqIHdyaXRlIGFjY2VzcyBzbyB0aGF0IHdlIGNh
biBwZXJmb3JtIGNvbmN1cnJlbnQgcmVhZCBvcGVyYXRpb25zIGJldHdlZW4KICAqIHRoZSBDUFUg
YW5kIEdQVSBlbmdpbmVzLCBhcyB3ZWxsIGFzIHdhaXRpbmcgZm9yIGFsbCByZW5kZXJpbmcgdG8K
ICAqIGNvbXBsZXRlLCBvciB3YWl0aW5nIGZvciB0aGUgbGFzdCBHUFUgdXNlciBvZiBhICJmZW5j
ZSByZWdpc3RlciIuIFRoZQotICogb2JqZWN0IHRoZW4gZW1iZWRzIGEgI2k5MTVfYWN0aXZlX3Jl
cXVlc3QgdG8gdHJhY2sgdGhlIG1vc3QgcmVjZW50IChpbgorICogb2JqZWN0IHRoZW4gZW1iZWRz
IGEgI2k5MTVfYWN0aXZlX2ZlbmNlIHRvIHRyYWNrIHRoZSBtb3N0IHJlY2VudCAoaW4KICAqIHJl
dGlyZW1lbnQgb3JkZXIpIHJlcXVlc3QgcmVsZXZhbnQgZm9yIHRoZSBkZXNpcmVkIG1vZGUgb2Yg
YWNjZXNzLgotICogVGhlICNpOTE1X2FjdGl2ZV9yZXF1ZXN0IGlzIHVwZGF0ZWQgd2l0aCBpOTE1
X2FjdGl2ZV9yZXF1ZXN0X3NldCgpIHRvCisgKiBUaGUgI2k5MTVfYWN0aXZlX2ZlbmNlIGlzIHVw
ZGF0ZWQgd2l0aCBpOTE1X2FjdGl2ZV9mZW5jZV9zZXQoKSB0bwogICogdHJhY2sgdGhlIG1vc3Qg
cmVjZW50IGZlbmNlIHJlcXVlc3QsIHR5cGljYWxseSB0aGlzIGlzIGRvbmUgYXMgcGFydCBvZgog
ICogaTkxNV92bWFfbW92ZV90b19hY3RpdmUoKS4KICAqCi0gKiBXaGVuIHRoZSAjaTkxNV9hY3Rp
dmVfcmVxdWVzdCBjb21wbGV0ZXMgKGlzIHJldGlyZWQpLCBpdCB3aWxsCisgKiBXaGVuIHRoZSAj
aTkxNV9hY3RpdmVfZmVuY2UgY29tcGxldGVzIChpcyByZXRpcmVkKSwgaXQgd2lsbAogICogc2ln
bmFsIGl0cyBjb21wbGV0aW9uIHRvIHRoZSBvd25lciB0aHJvdWdoIGEgY2FsbGJhY2sgYXMgd2Vs
bCBhcyBtYXJrCi0gKiBpdHNlbGYgYXMgaWRsZSAoaTkxNV9hY3RpdmVfcmVxdWVzdC5yZXF1ZXN0
ID09IE5VTEwpLiBUaGUgb3duZXIKKyAqIGl0c2VsZiBhcyBpZGxlIChpOTE1X2FjdGl2ZV9mZW5j
ZS5yZXF1ZXN0ID09IE5VTEwpLiBUaGUgb3duZXIKICAqIGNhbiB0aGVuIHBlcmZvcm0gYW55IGFj
dGlvbiwgc3VjaCBhcyBkZWxheWVkIGZyZWVpbmcgb2YgYW4gYWN0aXZlCiAgKiByZXNvdXJjZSBp
bmNsdWRpbmcgaXRzZWxmLgogICovCiAKLXZvaWQgaTkxNV9hY3RpdmVfcmV0aXJlX25vb3Aoc3Ry
dWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSwKLQkJCSAgICAgc3RydWN0IGk5MTVfcmVx
dWVzdCAqcmVxdWVzdCk7Cit2b2lkIGk5MTVfYWN0aXZlX25vb3Aoc3RydWN0IGRtYV9mZW5jZSAq
ZmVuY2UsIHN0cnVjdCBkbWFfZmVuY2VfY2IgKmNiKTsKIAogLyoqCi0gKiBpOTE1X2FjdGl2ZV9y
ZXF1ZXN0X2luaXQgLSBwcmVwYXJlcyB0aGUgYWN0aXZpdHkgdHJhY2tlciBmb3IgdXNlCisgKiBp
OTE1X2FjdGl2ZV9mZW5jZV9pbml0IC0gcHJlcGFyZXMgdGhlIGFjdGl2aXR5IHRyYWNrZXIgZm9y
IHVzZQogICogQGFjdGl2ZSAtIHRoZSBhY3RpdmUgdHJhY2tlcgogICogQHJxIC0gaW5pdGlhbCBy
ZXF1ZXN0IHRvIHRyYWNrLCBjYW4gYmUgTlVMTAogICogQGZ1bmMgLSBhIGNhbGxiYWNrIHdoZW4g
dGhlbiB0aGUgdHJhY2tlciBpcyByZXRpcmVkIChiZWNvbWVzIGlkbGUpLAogICogICAgICAgICBj
YW4gYmUgTlVMTAogICoKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfaW5pdCgpIHByZXBhcmVzIHRo
ZSBlbWJlZGRlZCBAYWN0aXZlIHN0cnVjdCBmb3IgdXNlIGFzCisgKiBpOTE1X2FjdGl2ZV9mZW5j
ZV9pbml0KCkgcHJlcGFyZXMgdGhlIGVtYmVkZGVkIEBhY3RpdmUgc3RydWN0IGZvciB1c2UgYXMK
ICAqIGFuIGFjdGl2aXR5IHRyYWNrZXIsIHRoYXQgaXMgZm9yIHRyYWNraW5nIHRoZSBsYXN0IGtu
b3duIGFjdGl2ZSByZXF1ZXN0CiAgKiBhc3NvY2lhdGVkIHdpdGggaXQuIFdoZW4gdGhlIGxhc3Qg
cmVxdWVzdCBiZWNvbWVzIGlkbGUsIHdoZW4gaXQgaXMgcmV0aXJlZAogICogYWZ0ZXIgY29tcGxl
dGlvbiwgdGhlIG9wdGlvbmFsIGNhbGxiYWNrIEBmdW5jIGlzIGludm9rZWQuCiAgKi8KIHN0YXRp
YyBpbmxpbmUgdm9pZAotaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KHN0cnVjdCBpOTE1X2FjdGl2
ZV9yZXF1ZXN0ICphY3RpdmUsCi0JCQkgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCi0JCQkgaTkx
NV9hY3RpdmVfcmV0aXJlX2ZuIHJldGlyZSkKK2k5MTVfYWN0aXZlX2ZlbmNlX2luaXQoc3RydWN0
IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUsCisJCSAgICAgICBzdHJ1Y3QgZG1hX2ZlbmNlICpm
ZW5jZSwKKwkJICAgICAgIGRtYV9mZW5jZV9mdW5jX3QgZm4pCiB7Ci0JUkNVX0lOSVRfUE9JTlRF
UihhY3RpdmUtPnJlcXVlc3QsIHJxKTsKLQlJTklUX0xJU1RfSEVBRCgmYWN0aXZlLT5saW5rKTsK
LQlhY3RpdmUtPnJldGlyZSA9IHJldGlyZSA/OiBpOTE1X2FjdGl2ZV9yZXRpcmVfbm9vcDsKKwlS
Q1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+ZmVuY2UsIGZlbmNlKTsKKwlhY3RpdmUtPmNiLmZ1bmMg
PSBmbiA/OiBpOTE1X2FjdGl2ZV9ub29wOwogfQogCi0jZGVmaW5lIElOSVRfQUNUSVZFX1JFUVVF
U1QobmFtZSkgaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KChuYW1lKSwgTlVMTCwgTlVMTCkKKyNk
ZWZpbmUgSU5JVF9BQ1RJVkVfRkVOQ0UoQSkgaTkxNV9hY3RpdmVfZmVuY2VfaW5pdChBLCBOVUxM
LCBOVUxMKQogCi0vKioKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0IC0gdXBkYXRlcyB0aGUg
dHJhY2tlciB0byB3YXRjaCB0aGUgY3VycmVudCByZXF1ZXN0Ci0gKiBAYWN0aXZlIC0gdGhlIGFj
dGl2ZSB0cmFja2VyCi0gKiBAcmVxdWVzdCAtIHRoZSByZXF1ZXN0IHRvIHdhdGNoCi0gKgotICog
X19pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldCgpIHdhdGNoZXMgdGhlIGdpdmVuIEByZXF1ZXN0IGZv
ciBjb21wbGV0aW9uLiBXaGlsc3QKLSAqIHRoYXQgQHJlcXVlc3QgaXMgYnVzeSwgdGhlIEBhY3Rp
dmUgcmVwb3J0cyBidXN5LiBXaGVuIHRoYXQgQHJlcXVlc3QgaXMKLSAqIHJldGlyZWQsIHRoZSBA
YWN0aXZlIHRyYWNrZXIgaXMgdXBkYXRlZCB0byByZXBvcnQgaWRsZS4KLSAqLwotc3RhdGljIGlu
bGluZSB2b2lkCi1fX2k5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9y
ZXF1ZXN0ICphY3RpdmUsCi0JCQkgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QpCi17Ci0J
bGlzdF9tb3ZlKCZhY3RpdmUtPmxpbmssICZyZXF1ZXN0LT5hY3RpdmVfbGlzdCk7Ci0JcmN1X2Fz
c2lnbl9wb2ludGVyKGFjdGl2ZS0+cmVxdWVzdCwgcmVxdWVzdCk7Ci19CitzdHJ1Y3QgZG1hX2Zl
bmNlICoKK19faTkxNV9hY3RpdmVfZmVuY2Vfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAq
YWN0aXZlLAorCQkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpOwogCiBpbnQgX19tdXN0X2NoZWNr
Ci1pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0
aXZlLAotCQkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpOwotCi0vKioKLSAqIGk5MTVfYWN0aXZl
X3JlcXVlc3RfcmF3IC0gcmV0dXJuIHRoZSBhY3RpdmUgcmVxdWVzdAotICogQGFjdGl2ZSAtIHRo
ZSBhY3RpdmUgdHJhY2tlcgotICoKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfcmF3KCkgcmV0dXJu
cyB0aGUgY3VycmVudCByZXF1ZXN0IGJlaW5nIHRyYWNrZWQsIG9yIE5VTEwuCi0gKiBJdCBkb2Vz
IG5vdCBvYnRhaW4gYSByZWZlcmVuY2Ugb24gdGhlIHJlcXVlc3QgZm9yIHRoZSBjYWxsZXIsIHNv
IHRoZSBjYWxsZXIKLSAqIG11c3QgaG9sZCBzdHJ1Y3RfbXV0ZXguCi0gKi8KLXN0YXRpYyBpbmxp
bmUgc3RydWN0IGk5MTVfcmVxdWVzdCAqCi1pOTE1X2FjdGl2ZV9yZXF1ZXN0X3Jhdyhjb25zdCBz
dHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAotCQkJc3RydWN0IG11dGV4ICptdXRl
eCkKLXsKLQlyZXR1cm4gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChhY3RpdmUtPnJlcXVlc3Qs
Ci0JCQkJCSBsb2NrZGVwX2lzX2hlbGQobXV0ZXgpKTsKLX0KK2k5MTVfYWN0aXZlX2ZlbmNlX3Nl
dChzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSwKKwkJICAgICAgc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEpOwogCiAvKioKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfcGVlayAtIHJlcG9y
dCB0aGUgYWN0aXZlIHJlcXVlc3QgYmVpbmcgbW9uaXRvcmVkCisgKiBfX2k5MTVfYWN0aXZlX2Zl
bmNlX2dldF9yY3UgLSByZXR1cm4gYSByZWZlcmVuY2UgdG8gdGhlIGFjdGl2ZSByZXF1ZXN0CiAg
KiBAYWN0aXZlIC0gdGhlIGFjdGl2ZSB0cmFja2VyCiAgKgotICogaTkxNV9hY3RpdmVfcmVxdWVz
dF9wZWVrKCkgcmV0dXJucyB0aGUgY3VycmVudCByZXF1ZXN0IGJlaW5nIHRyYWNrZWQgaWYKLSAq
IHN0aWxsIGFjdGl2ZSwgb3IgTlVMTC4gSXQgZG9lcyBub3Qgb2J0YWluIGEgcmVmZXJlbmNlIG9u
IHRoZSByZXF1ZXN0Ci0gKiBmb3IgdGhlIGNhbGxlciwgc28gdGhlIGNhbGxlciBtdXN0IGhvbGQg
c3RydWN0X211dGV4LgotICovCi1zdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgot
aTkxNV9hY3RpdmVfcmVxdWVzdF9wZWVrKGNvbnN0IHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0
ICphY3RpdmUsCi0JCQkgc3RydWN0IG11dGV4ICptdXRleCkKLXsKLQlzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpyZXF1ZXN0OwotCi0JcmVxdWVzdCA9IGk5MTVfYWN0aXZlX3JlcXVlc3RfcmF3KGFjdGl2
ZSwgbXV0ZXgpOwotCWlmICghcmVxdWVzdCB8fCBpOTE1X3JlcXVlc3RfY29tcGxldGVkKHJlcXVl
c3QpKQotCQlyZXR1cm4gTlVMTDsKLQotCXJldHVybiByZXF1ZXN0OwotfQotCi0vKioKLSAqIGk5
MTVfYWN0aXZlX3JlcXVlc3RfZ2V0IC0gcmV0dXJuIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUg
cmVxdWVzdAotICogQGFjdGl2ZSAtIHRoZSBhY3RpdmUgdHJhY2tlcgotICoKLSAqIGk5MTVfYWN0
aXZlX3JlcXVlc3RfZ2V0KCkgcmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIHJlcXVl
c3QsIG9yIE5VTEwKLSAqIGlmIHRoZSBhY3RpdmUgdHJhY2tlciBpcyBpZGxlLiBUaGUgY2FsbGVy
IG11c3QgaG9sZCBzdHJ1Y3RfbXV0ZXguCi0gKi8KLXN0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVf
cmVxdWVzdCAqCi1pOTE1X2FjdGl2ZV9yZXF1ZXN0X2dldChjb25zdCBzdHJ1Y3QgaTkxNV9hY3Rp
dmVfcmVxdWVzdCAqYWN0aXZlLAotCQkJc3RydWN0IG11dGV4ICptdXRleCkKLXsKLQlyZXR1cm4g
aTkxNV9yZXF1ZXN0X2dldChpOTE1X2FjdGl2ZV9yZXF1ZXN0X3BlZWsoYWN0aXZlLCBtdXRleCkp
OwotfQotCi0vKioKLSAqIF9faTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRfcmN1IC0gcmV0dXJuIGEg
cmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUgcmVxdWVzdAotICogQGFjdGl2ZSAtIHRoZSBhY3RpdmUg
dHJhY2tlcgotICoKLSAqIF9faTkxNV9hY3RpdmVfcmVxdWVzdF9nZXQoKSByZXR1cm5zIGEgcmVm
ZXJlbmNlIHRvIHRoZSBhY3RpdmUgcmVxdWVzdCwKKyAqIF9faTkxNV9hY3RpdmVfZmVuY2VfZ2V0
KCkgcmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIHJlcXVlc3QsCiAgKiBvciBOVUxM
IGlmIHRoZSBhY3RpdmUgdHJhY2tlciBpcyBpZGxlLiBUaGUgY2FsbGVyIG11c3QgaG9sZCB0aGUg
UkNVIHJlYWQKICAqIGxvY2ssIGJ1dCB0aGUgcmV0dXJuZWQgcG9pbnRlciBpcyBzYWZlIHRvIHVz
ZSBvdXRzaWRlIG9mIFJDVS4KICAqLwotc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICoKLV9faTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRfcmN1KGNvbnN0IHN0cnVjdCBpOTE1X2FjdGl2
ZV9yZXF1ZXN0ICphY3RpdmUpCitzdGF0aWMgaW5saW5lIHN0cnVjdCBkbWFfZmVuY2UgKgorX19p
OTE1X2FjdGl2ZV9mZW5jZV9nZXRfcmN1KGNvbnN0IHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAq
YWN0aXZlKQogewogCS8qCiAJICogUGVyZm9ybWluZyBhIGxvY2tsZXNzIHJldHJpZXZhbCBvZiB0
aGUgYWN0aXZlIHJlcXVlc3QgaXMgc3VwZXIKQEAgLTE5OCwxMCArMTM0LDExIEBAIF9faTkxNV9h
Y3RpdmVfcmVxdWVzdF9nZXRfcmN1KGNvbnN0IHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICph
Y3RpdmUpCiAJICogU2VlIGk5MTVfcmVxdWVzdF9hbGxvYygpLgogCSAqLwogCWRvIHsKLQkJc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdDsKKwkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7CiAK
LQkJcmVxdWVzdCA9IHJjdV9kZXJlZmVyZW5jZShhY3RpdmUtPnJlcXVlc3QpOwotCQlpZiAoIXJl
cXVlc3QgfHwgaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChyZXF1ZXN0KSkKKwkJZmVuY2UgPSByY3Vf
ZGVyZWZlcmVuY2UoYWN0aXZlLT5mZW5jZSk7CisJCWlmICghZmVuY2UgfHwKKwkJICAgIHRlc3Rf
Yml0KERNQV9GRU5DRV9GTEFHX1NJR05BTEVEX0JJVCwgJmZlbmNlLT5mbGFncykpCiAJCQlyZXR1
cm4gTlVMTDsKIAogCQkvKgpAQCAtMjE4LDcgKzE1NSw3IEBAIF9faTkxNV9hY3RpdmVfcmVxdWVz
dF9nZXRfcmN1KGNvbnN0IHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUpCiAJCSAq
LwogCQliYXJyaWVyKCk7CiAKLQkJcmVxdWVzdCA9IGk5MTVfcmVxdWVzdF9nZXRfcmN1KHJlcXVl
c3QpOworCQlmZW5jZSA9IGRtYV9mZW5jZV9nZXRfcmN1KGZlbmNlKTsKIAogCQkvKgogCQkgKiBX
aGF0IHN0b3BzIHRoZSBmb2xsb3dpbmcgcmN1X2FjY2Vzc19wb2ludGVyKCkgZnJvbSBvY2N1cnJp
bmcKQEAgLTI0Nyw4MSArMTg0LDU4IEBAIF9faTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRfcmN1KGNv
bnN0IHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUpCiAJCSAqIFRoZSBjb3JyZXNw
b25kaW5nIHdyaXRlIGJhcnJpZXIgaXMgcGFydCBvZgogCQkgKiByY3VfYXNzaWduX3BvaW50ZXIo
KS4KIAkJICovCi0JCWlmICghcmVxdWVzdCB8fCByZXF1ZXN0ID09IHJjdV9hY2Nlc3NfcG9pbnRl
cihhY3RpdmUtPnJlcXVlc3QpKQotCQkJcmV0dXJuIHJjdV9wb2ludGVyX2hhbmRvZmYocmVxdWVz
dCk7CisJCWlmICghZmVuY2UgfHwgZmVuY2UgPT0gcmN1X2FjY2Vzc19wb2ludGVyKGFjdGl2ZS0+
ZmVuY2UpKQorCQkJcmV0dXJuIHJjdV9wb2ludGVyX2hhbmRvZmYoZmVuY2UpOwogCi0JCWk5MTVf
cmVxdWVzdF9wdXQocmVxdWVzdCk7CisJCWRtYV9mZW5jZV9wdXQoZmVuY2UpOwogCX0gd2hpbGUg
KDEpOwogfQogCiAvKioKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3VubG9ja2VkIC0gcmV0
dXJuIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUgcmVxdWVzdAorICogaTkxNV9hY3RpdmVfZmVu
Y2VfZ2V0IC0gcmV0dXJuIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUgcmVxdWVzdAogICogQGFj
dGl2ZSAtIHRoZSBhY3RpdmUgdHJhY2tlcgogICoKLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0
X3VubG9ja2VkKCkgcmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIHJlcXVlc3QsCisg
KiBpOTE1X2FjdGl2ZV9mZW5jZV9nZXQoKSByZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3Rp
dmUgcmVxdWVzdCwKICAqIG9yIE5VTEwgaWYgdGhlIGFjdGl2ZSB0cmFja2VyIGlzIGlkbGUuIFRo
ZSByZWZlcmVuY2UgaXMgb2J0YWluZWQgdW5kZXIgUkNVLAogICogc28gbm8gbG9ja2luZyBpcyBy
ZXF1aXJlZCBieSB0aGUgY2FsbGVyLgogICoKLSAqIFRoZSByZWZlcmVuY2Ugc2hvdWxkIGJlIGZy
ZWVkIHdpdGggaTkxNV9yZXF1ZXN0X3B1dCgpLgorICogVGhlIHJlZmVyZW5jZSBzaG91bGQgYmUg
ZnJlZWQgd2l0aCBkbWFfZmVuY2VfcHV0KCkuCiAgKi8KLXN0YXRpYyBpbmxpbmUgc3RydWN0IGk5
MTVfcmVxdWVzdCAqCi1pOTE1X2FjdGl2ZV9yZXF1ZXN0X2dldF91bmxvY2tlZChjb25zdCBzdHJ1
Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlKQorc3RhdGljIGlubGluZSBzdHJ1Y3QgZG1h
X2ZlbmNlICoKK2k5MTVfYWN0aXZlX2ZlbmNlX2dldChjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVf
ZmVuY2UgKmFjdGl2ZSkKIHsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0OworCXN0cnVj
dCBkbWFfZmVuY2UgKmZlbmNlOwogCiAJcmN1X3JlYWRfbG9jaygpOwotCXJlcXVlc3QgPSBfX2k5
MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3JjdShhY3RpdmUpOworCWZlbmNlID0gX19pOTE1X2FjdGl2
ZV9mZW5jZV9nZXRfcmN1KGFjdGl2ZSk7CiAJcmN1X3JlYWRfdW5sb2NrKCk7CiAKLQlyZXR1cm4g
cmVxdWVzdDsKKwlyZXR1cm4gZmVuY2U7CiB9CiAKIC8qKgotICogaTkxNV9hY3RpdmVfcmVxdWVz
dF9pc3NldCAtIHJlcG9ydCB3aGV0aGVyIHRoZSBhY3RpdmUgdHJhY2tlciBpcyBhc3NpZ25lZAor
ICogaTkxNV9hY3RpdmVfZmVuY2VfaXNzZXQgLSByZXBvcnQgd2hldGhlciB0aGUgYWN0aXZlIHRy
YWNrZXIgaXMgYXNzaWduZWQKICAqIEBhY3RpdmUgLSB0aGUgYWN0aXZlIHRyYWNrZXIKICAqCi0g
KiBpOTE1X2FjdGl2ZV9yZXF1ZXN0X2lzc2V0KCkgcmV0dXJucyB0cnVlIGlmIHRoZSBhY3RpdmUg
dHJhY2tlciBpcyBjdXJyZW50bHkKKyAqIGk5MTVfYWN0aXZlX2ZlbmNlX2lzc2V0KCkgcmV0dXJu
cyB0cnVlIGlmIHRoZSBhY3RpdmUgdHJhY2tlciBpcyBjdXJyZW50bHkKICAqIGFzc2lnbmVkIHRv
IGEgcmVxdWVzdC4gRHVlIHRvIHRoZSBsYXp5IHJldGlyaW5nLCB0aGF0IHJlcXVlc3QgbWF5IGJl
IGlkbGUKICAqIGFuZCB0aGlzIG1heSByZXBvcnQgc3RhbGUgaW5mb3JtYXRpb24uCiAgKi8KIHN0
YXRpYyBpbmxpbmUgYm9vbAotaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldChjb25zdCBzdHJ1Y3Qg
aTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlKQoraTkxNV9hY3RpdmVfZmVuY2VfaXNzZXQoY29u
c3Qgc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUpCiB7Ci0JcmV0dXJuIHJjdV9hY2Nl
c3NfcG9pbnRlcihhY3RpdmUtPnJlcXVlc3QpOworCXJldHVybiByY3VfYWNjZXNzX3BvaW50ZXIo
YWN0aXZlLT5mZW5jZSk7CiB9CiAKLS8qKgotICogaTkxNV9hY3RpdmVfcmVxdWVzdF9yZXRpcmUg
LSB3YWl0cyB1bnRpbCB0aGUgcmVxdWVzdCBpcyByZXRpcmVkCi0gKiBAYWN0aXZlIC0gdGhlIGFj
dGl2ZSByZXF1ZXN0IG9uIHdoaWNoIHRvIHdhaXQKLSAqCi0gKiBpOTE1X2FjdGl2ZV9yZXF1ZXN0
X3JldGlyZSgpIHdhaXRzIHVudGlsIHRoZSByZXF1ZXN0IGlzIGNvbXBsZXRlZCwKLSAqIGFuZCB0
aGVuIGVuc3VyZXMgdGhhdCBhdCBsZWFzdCB0aGUgcmV0aXJlbWVudCBoYW5kbGVyIGZvciB0aGlz
Ci0gKiBAYWN0aXZlIHRyYWNrZXIgaXMgY2FsbGVkIGJlZm9yZSByZXR1cm5pbmcuIElmIHRoZSBA
YWN0aXZlCi0gKiB0cmFja2VyIGlzIGlkbGUsIHRoZSBmdW5jdGlvbiByZXR1cm5zIGltbWVkaWF0
ZWx5LgotICovCi1zdGF0aWMgaW5saW5lIGludCBfX211c3RfY2hlY2sKLWk5MTVfYWN0aXZlX3Jl
cXVlc3RfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCi0JCQkgICBz
dHJ1Y3QgbXV0ZXggKm11dGV4KQorc3RhdGljIGlubGluZSB2b2lkCitpOTE1X2FjdGl2ZV9mZW5j
ZV9jYihzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwKKwkJICAgICBzdHJ1Y3QgZG1hX2ZlbmNlX2Ni
ICpjYikKIHsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0OwotCWxvbmcgcmV0OwotCi0J
cmVxdWVzdCA9IGk5MTVfYWN0aXZlX3JlcXVlc3RfcmF3KGFjdGl2ZSwgbXV0ZXgpOwotCWlmICgh
cmVxdWVzdCkKLQkJcmV0dXJuIDA7Ci0KLQlyZXQgPSBpOTE1X3JlcXVlc3Rfd2FpdChyZXF1ZXN0
LAotCQkJCUk5MTVfV0FJVF9JTlRFUlJVUFRJQkxFIHwgSTkxNV9XQUlUX0xPQ0tFRCwKLQkJCQlN
QVhfU0NIRURVTEVfVElNRU9VVCk7Ci0JaWYgKHJldCA8IDApCi0JCXJldHVybiByZXQ7Ci0KLQls
aXN0X2RlbF9pbml0KCZhY3RpdmUtPmxpbmspOwotCVJDVV9JTklUX1BPSU5URVIoYWN0aXZlLT5y
ZXF1ZXN0LCBOVUxMKTsKLQotCWFjdGl2ZS0+cmV0aXJlKGFjdGl2ZSwgcmVxdWVzdCk7CisJc3Ry
dWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUgPQorCQljb250YWluZXJfb2YoY2IsIHR5cGVv
ZigqYWN0aXZlKSwgY2IpOwogCi0JcmV0dXJuIDA7CisJLy9HRU1fQlVHX09OKHJjdV9hY2Nlc3Nf
cG9pbnRlcihhY3RpdmUtPmZlbmNlKSAhPSBmZW5jZSk7CisJUkNVX0lOSVRfUE9JTlRFUihhY3Rp
dmUtPmZlbmNlLCBOVUxMKTsKIH0KIAogLyoKQEAgLTM1MCwzMSArMjY0LDI5IEBAIGk5MTVfYWN0
aXZlX3JlcXVlc3RfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCiAg
KiBzeW5jaHJvbmlzYXRpb24uCiAgKi8KIAotdm9pZCBfX2k5MTVfYWN0aXZlX2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0JCQlzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwKK3Zv
aWQgX19pOTE1X2FjdGl2ZV9pbml0KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAogCQkJaW50ICgq
YWN0aXZlKShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiksCiAJCQl2b2lkICgqcmV0aXJlKShzdHJ1
Y3QgaTkxNV9hY3RpdmUgKnJlZiksCiAJCQlzdHJ1Y3QgbG9ja19jbGFzc19rZXkgKmtleSk7Ci0j
ZGVmaW5lIGk5MTVfYWN0aXZlX2luaXQoaTkxNSwgcmVmLCBhY3RpdmUsIHJldGlyZSkgZG8gewkJ
XAorI2RlZmluZSBpOTE1X2FjdGl2ZV9pbml0KHJlZiwgYWN0aXZlLCByZXRpcmUpIGRvIHsJCVwK
IAlzdGF0aWMgc3RydWN0IGxvY2tfY2xhc3Nfa2V5IF9fa2V5OwkJCQlcCiAJCQkJCQkJCQlcCi0J
X19pOTE1X2FjdGl2ZV9pbml0KGk5MTUsIHJlZiwgYWN0aXZlLCByZXRpcmUsICZfX2tleSk7CQlc
CisJX19pOTE1X2FjdGl2ZV9pbml0KHJlZiwgYWN0aXZlLCByZXRpcmUsICZfX2tleSk7CQlcCiB9
IHdoaWxlICgwKQogCiBpbnQgaTkxNV9hY3RpdmVfcmVmKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVm
LAogCQkgICAgdTY0IHRpbWVsaW5lLAotCQkgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpOwor
CQkgICAgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpOwogCiBpbnQgaTkxNV9hY3RpdmVfd2FpdChz
dHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7CiAKIGludCBpOTE1X3JlcXVlc3RfYXdhaXRfYWN0aXZl
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCQkJICAgICAgc3RydWN0IGk5MTVfYWN0aXZlICpy
ZWYpOwotaW50IGk5MTVfcmVxdWVzdF9hd2FpdF9hY3RpdmVfcmVxdWVzdChzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSwKLQkJCQkgICAgICBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZl
KTsKK2ludCBpOTE1X3JlcXVlc3RfYXdhaXRfYWN0aXZlX2ZlbmNlKHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxLAorCQkJCSAgICBzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSk7CiAKIGlu
dCBpOTE1X2FjdGl2ZV9hY3F1aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKIHZvaWQgaTkx
NV9hY3RpdmVfcmVsZWFzZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7Ci12b2lkIF9faTkxNV9h
Y3RpdmVfcmVsZWFzZV9uZXN0ZWQoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsIGludCBzdWJjbGFz
cyk7CiAKIHN0YXRpYyBpbmxpbmUgYm9vbAogaTkxNV9hY3RpdmVfaXNfaWRsZShjb25zdCBzdHJ1
Y3QgaTkxNV9hY3RpdmUgKnJlZikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfYWN0aXZlX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBl
cy5oCmluZGV4IDA2YWNkZmZlMGY2ZC4uOTUxOWI2NTIzODAxIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfYWN0aXZlX3R5cGVzLmgKQEAgLTgsMzAgKzgsMjEgQEAKICNkZWZpbmUgX0k5MTVf
QUNUSVZFX1RZUEVTX0hfCiAKICNpbmNsdWRlIDxsaW51eC9hdG9taWMuaD4KKyNpbmNsdWRlIDxs
aW51eC9kbWEtZmVuY2UuaD4KICNpbmNsdWRlIDxsaW51eC9sbGlzdC5oPgogI2luY2x1ZGUgPGxp
bnV4L211dGV4Lmg+CiAjaW5jbHVkZSA8bGludXgvcmJ0cmVlLmg+CiAjaW5jbHVkZSA8bGludXgv
cmN1cGRhdGUuaD4KICNpbmNsdWRlIDxsaW51eC93b3JrcXVldWUuaD4KIAotc3RydWN0IGRybV9p
OTE1X3ByaXZhdGU7Ci1zdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdDsKLXN0cnVjdCBpOTE1X3Jl
cXVlc3Q7Ci0KLXR5cGVkZWYgdm9pZCAoKmk5MTVfYWN0aXZlX3JldGlyZV9mbikoc3RydWN0IGk5
MTVfYWN0aXZlX3JlcXVlc3QgKiwKLQkJCQkgICAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICopOwot
Ci1zdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCB7Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCBfX3Jj
dSAqcmVxdWVzdDsKLQlzdHJ1Y3QgbGlzdF9oZWFkIGxpbms7Ci0JaTkxNV9hY3RpdmVfcmV0aXJl
X2ZuIHJldGlyZTsKK3N0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSB7CisJc3RydWN0IGRtYV9mZW5j
ZSBfX3JjdSAqZmVuY2U7CisJc3RydWN0IGRtYV9mZW5jZV9jYiBjYjsKIH07CiAKIHN0cnVjdCBh
Y3RpdmVfbm9kZTsKIAogc3RydWN0IGk5MTVfYWN0aXZlIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNTsKLQogCXN0cnVjdCBhY3RpdmVfbm9kZSAqY2FjaGU7CiAJc3RydWN0IHJiX3Jv
b3QgdHJlZTsKIAlzdHJ1Y3QgbXV0ZXggbXV0ZXg7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwppbmRl
eCBlMDk3ZjdmY2NlNmYuLmQ3NGZjZGRkODYzZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCkBA
IC05NTEsMzQgKzk1MSwzOCBAQCB3YWl0X2Zvcl90aW1lbGluZXMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCiAKIAltdXRleF9sb2NrKCZndC0+bXV0ZXgpOwogCWxpc3RfZm9yX2VhY2hf
ZW50cnkodGwsICZndC0+YWN0aXZlX2xpc3QsIGxpbmspIHsKLQkJc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnE7CisJCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwogCi0JCXJxID0gaTkxNV9hY3RpdmVf
cmVxdWVzdF9nZXRfdW5sb2NrZWQoJnRsLT5sYXN0X3JlcXVlc3QpOwotCQlpZiAoIXJxKQorCQlm
ZW5jZSA9IGk5MTVfYWN0aXZlX2ZlbmNlX2dldCgmdGwtPmxhc3RfcmVxdWVzdCk7CisJCWlmICgh
ZmVuY2UpCiAJCQljb250aW51ZTsKIAotCQltdXRleF91bmxvY2soJmd0LT5tdXRleCk7Ci0KLQkJ
LyoKLQkJICogIlJhY2UtdG8taWRsZSIuCi0JCSAqCi0JCSAqIFN3aXRjaGluZyB0byB0aGUga2Vy
bmVsIGNvbnRleHQgaXMgb2Z0ZW4gdXNlZCBhIHN5bmNocm9ub3VzCi0JCSAqIHN0ZXAgcHJpb3Ig
dG8gaWRsaW5nLCBlLmcuIGluIHN1c3BlbmQgZm9yIGZsdXNoaW5nIGFsbAotCQkgKiBjdXJyZW50
IG9wZXJhdGlvbnMgdG8gbWVtb3J5IGJlZm9yZSBzbGVlcGluZy4gVGhlc2Ugd2UKLQkJICogd2Fu
dCB0byBjb21wbGV0ZSBhcyBxdWlja2x5IGFzIHBvc3NpYmxlIHRvIGF2b2lkIHByb2xvbmdlZAot
CQkgKiBzdGFsbHMsIHNvIGFsbG93IHRoZSBncHUgdG8gYm9vc3QgdG8gbWF4aW11bSBjbG9ja3Mu
Ci0JCSAqLwotCQlpZiAoZmxhZ3MgJiBJOTE1X1dBSVRfRk9SX0lETEVfQk9PU1QpCi0JCQlnZW42
X3Jwc19ib29zdChycSk7CisJCWlmICghZG1hX2ZlbmNlX2lzX2k5MTUoZmVuY2UpKSB7CisJCQl0
aW1lb3V0ID0gZG1hX2ZlbmNlX3dhaXRfdGltZW91dChmZW5jZSwKKwkJCQkJCQkgZmxhZ3MgJiBJ
OTE1X1dBSVRfSU5URVJSVVBUSUJMRSwKKwkJCQkJCQkgdGltZW91dCk7CisJCX0gZWxzZSB7CisJ
CQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9IHRvX3JlcXVlc3QoZmVuY2UpOworCisJCQkvKgor
CQkJICogIlJhY2UtdG8taWRsZSIuCisJCQkgKgorCQkJICogU3dpdGNoaW5nIHRvIHRoZSBrZXJu
ZWwgY29udGV4dCBpcyBvZnRlbiB1c2VkIGFzCisJCQkgKiBhIHN5bmNocm9ub3VzIHN0ZXAgcHJp
b3IgdG8gaWRsaW5nLCBlLmcuIGluIHN1c3BlbmQKKwkJCSAqIGZvciBmbHVzaGluZyBhbGwgY3Vy
cmVudCBvcGVyYXRpb25zIHRvIG1lbW9yeSBiZWZvcmUKKwkJCSAqIHNsZWVwaW5nLiBUaGVzZSB3
ZSB3YW50IHRvIGNvbXBsZXRlIGFzIHF1aWNrbHkgYXMKKwkJCSAqIHBvc3NpYmxlIHRvIGF2b2lk
IHByb2xvbmdlZCBzdGFsbHMsIHNvIGFsbG93IHRoZSBncHUKKwkJCSAqIHRvIGJvb3N0IHRvIG1h
eGltdW0gY2xvY2tzLgorCQkJICovCisJCQlpZiAoZmxhZ3MgJiBJOTE1X1dBSVRfRk9SX0lETEVf
Qk9PU1QpCisJCQkJZ2VuNl9ycHNfYm9vc3QocnEpOworCisJCQl0aW1lb3V0ID0gaTkxNV9yZXF1
ZXN0X3dhaXQocnEsIGZsYWdzLCB0aW1lb3V0KTsKKwkJfQogCi0JCXRpbWVvdXQgPSBpOTE1X3Jl
cXVlc3Rfd2FpdChycSwgZmxhZ3MsIHRpbWVvdXQpOwotCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsK
KwkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7CiAJCWlmICh0aW1lb3V0IDwgMCkKLQkJCXJldHVybiB0
aW1lb3V0OwotCi0JCS8qIHJlc3RhcnQgYWZ0ZXIgcmVhY3F1aXJpbmcgdGhlIGxvY2sgKi8KLQkJ
bXV0ZXhfbG9jaygmZ3QtPm11dGV4KTsKLQkJdGwgPSBsaXN0X2VudHJ5KCZndC0+YWN0aXZlX2xp
c3QsIHR5cGVvZigqdGwpLCBsaW5rKTsKKwkJCWJyZWFrOwogCX0KIAltdXRleF91bmxvY2soJmd0
LT5tdXRleCk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0
dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKaW5kZXggMDVmZWYxZDM1
NzlkLi42MGY3NTQyOTJhNjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2VtX2d0dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCkBAIC0y
MDYyLDcgKzIwNjIsNyBAQCBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpwZF92bWFfY3JlYXRlKHN0
cnVjdCBnZW42X2h3X3BwZ3R0ICpwcGd0dCwgaW50IHNpemUpCiAJaWYgKCF2bWEpCiAJCXJldHVy
biBFUlJfUFRSKC1FTk9NRU0pOwogCi0JaTkxNV9hY3RpdmVfaW5pdChpOTE1LCAmdm1hLT5hY3Rp
dmUsIE5VTEwsIE5VTEwpOworCWk5MTVfYWN0aXZlX2luaXQoJnZtYS0+YWN0aXZlLCBOVUxMLCBO
VUxMKTsKIAogCXZtYS0+dm0gPSAmZ2d0dC0+dm07CiAJdm1hLT5vcHMgPSAmcGRfdm1hX29wczsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKaW5kZXggYzcxZWRkNmVhODczLi5jYmRmNzFl
ODA2MTYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCkBAIC0yMjksOSArMjI5LDgg
QEAgc3RhdGljIHZvaWQgZnJlZV9jYXB0dXJlX2xpc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVx
dWVzdCkKIAogc3RhdGljIGJvb2wgaTkxNV9yZXF1ZXN0X3JldGlyZShzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSkKIHsKLQlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLCAqbmV4dDsK
Kwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZycS0+dGltZWxpbmUtPm11dGV4KTsKIAotCWxvY2tkZXBf
YXNzZXJ0X2hlbGQoJnJxLT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlpZiAoIWk5MTVfcmVx
dWVzdF9jb21wbGV0ZWQocnEpKQogCQlyZXR1cm4gZmFsc2U7CiAKQEAgLTI0NSwzNSArMjQ0LDYg
QEAgc3RhdGljIGJvb2wgaTkxNV9yZXF1ZXN0X3JldGlyZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cSkKIAogCWFkdmFuY2VfcmluZyhycSk7CiAKLQkvKgotCSAqIFdhbGsgdGhyb3VnaCB0aGUgYWN0
aXZlIGxpc3QsIGNhbGxpbmcgcmV0aXJlIG9uIGVhY2guIFRoaXMgYWxsb3dzCi0JICogb2JqZWN0
cyB0byB0cmFjayB0aGVpciBHUFUgYWN0aXZpdHkgYW5kIG1hcmsgdGhlbXNlbHZlcyBhcyBpZGxl
Ci0JICogd2hlbiB0aGVpciAqbGFzdCogYWN0aXZlIHJlcXVlc3QgaXMgY29tcGxldGVkICh1cGRh
dGluZyBzdGF0ZQotCSAqIHRyYWNraW5nIGxpc3RzIGZvciBldmljdGlvbiwgYWN0aXZlIHJlZmVy
ZW5jZXMgZm9yIEdFTSwgZXRjKS4KLQkgKgotCSAqIEFzIHRoZSAtPnJldGlyZSgpIG1heSBmcmVl
IHRoZSBub2RlLCB3ZSBkZWNvdXBsZSBpdCBmaXJzdCBhbmQKLQkgKiBwYXNzIGFsb25nIHRoZSBh
dXhpbGlhcnkgaW5mb3JtYXRpb24gKHRvIGF2b2lkIGRlcmVmZXJlbmNpbmcKLQkgKiB0aGUgbm9k
ZSBhZnRlciB0aGUgY2FsbGJhY2spLgotCSAqLwotCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShh
Y3RpdmUsIG5leHQsICZycS0+YWN0aXZlX2xpc3QsIGxpbmspIHsKLQkJLyoKLQkJICogSW4gbWlj
cm9iZW5jaG1hcmtzIG9yIGZvY3VzaW5nIHVwb24gdGltZSBpbnNpZGUgdGhlIGtlcm5lbCwKLQkJ
ICogd2UgbWF5IHNwZW5kIGFuIGlub3JkaW5hdGUgYW1vdW50IG9mIHRpbWUgc2ltcGx5IGhhbmRs
aW5nCi0JCSAqIHRoZSByZXRpcmVtZW50IG9mIHJlcXVlc3RzIGFuZCBwcm9jZXNzaW5nIHRoZWly
IGNhbGxiYWNrcy4KLQkJICogT2Ygd2hpY2gsIHRoaXMgbG9vcCBpdHNlbGYgaXMgcGFydGljdWxh
cmx5IGhvdCBkdWUgdG8gdGhlCi0JCSAqIGNhY2hlIG1pc3NlcyB3aGVuIGp1bXBpbmcgYXJvdW5k
IHRoZSBsaXN0IG9mCi0JCSAqIGk5MTVfYWN0aXZlX3JlcXVlc3QuICBTbyB3ZSB0cnkgdG8ga2Vl
cCB0aGlzIGxvb3AgYXMKLQkJICogc3RyZWFtbGluZWQgYXMgcG9zc2libGUgYW5kIGFsc28gcHJl
ZmV0Y2ggdGhlIG5leHQKLQkJICogaTkxNV9hY3RpdmVfcmVxdWVzdCB0byB0cnkgYW5kIGhpZGUg
dGhlIGxpa2VseSBjYWNoZSBtaXNzLgotCQkgKi8KLQkJcHJlZmV0Y2h3KG5leHQpOwotCi0JCUlO
SVRfTElTVF9IRUFEKCZhY3RpdmUtPmxpbmspOwotCQlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+
cmVxdWVzdCwgTlVMTCk7Ci0KLQkJYWN0aXZlLT5yZXRpcmUoYWN0aXZlLCBycSk7Ci0JfQotCiAJ
bG9jYWxfaXJxX2Rpc2FibGUoKTsKIAogCS8qCkBAIC0yODgsOCArMjU4LDcgQEAgc3RhdGljIGJv
b2wgaTkxNV9yZXF1ZXN0X3JldGlyZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAogCXNwaW5f
bG9jaygmcnEtPmxvY2spOwogCWk5MTVfcmVxdWVzdF9tYXJrX2NvbXBsZXRlKHJxKTsKLQlpZiAo
IWk5MTVfcmVxdWVzdF9zaWduYWxlZChycSkpCi0JCWRtYV9mZW5jZV9zaWduYWxfbG9ja2VkKCZy
cS0+ZmVuY2UpOworCWRtYV9mZW5jZV9zaWduYWxfbG9ja2VkKCZycS0+ZmVuY2UpOwogCWlmICh0
ZXN0X2JpdChETUFfRkVOQ0VfRkxBR19FTkFCTEVfU0lHTkFMX0JJVCwgJnJxLT5mZW5jZS5mbGFn
cykpCiAJCWk5MTVfcmVxdWVzdF9jYW5jZWxfYnJlYWRjcnVtYihycSk7CiAJaWYgKHJxLT53YWl0
Ym9vc3QpIHsKQEAgLTMyOCwxMSArMjk3LDkgQEAgdm9pZCBpOTE1X3JlcXVlc3RfcmV0aXJlX3Vw
dG8oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJCSAgcnEtPmZlbmNlLmNvbnRleHQsIHJxLT5m
ZW5jZS5zZXFubywKIAkJICBod3NwX3NlcW5vKHJxKSk7CiAKLQlsb2NrZGVwX2Fzc2VydF9oZWxk
KCZycS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJbG9ja2RlcF9hc3NlcnRfaGVsZCgmcnEt
PnRpbWVsaW5lLT5tdXRleCk7CiAJR0VNX0JVR19PTighaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChy
cSkpOwotCi0JaWYgKGxpc3RfZW1wdHkoJnJxLT5yaW5nX2xpbmspKQotCQlyZXR1cm47CisJR0VN
X0JVR19PTihsaXN0X2VtcHR5KCZycS0+cmluZ19saW5rKSk7CiAKIAlkbyB7CiAJCXRtcCA9IGxp
c3RfZmlyc3RfZW50cnkoJnJpbmctPnJlcXVlc3RfbGlzdCwKQEAgLTU2Nyw2ICs1MzQsNyBAQCBz
dGF0aWMgdm9pZCByaW5nX3JldGlyZV9yZXF1ZXN0cyhzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZykK
IHsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgKnJuOwogCisJbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmcmluZy0+dGltZWxpbmUtPm11dGV4KTsKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUocnEs
IHJuLCAmcmluZy0+cmVxdWVzdF9saXN0LCByaW5nX2xpbmspCiAJCWlmICghaTkxNV9yZXF1ZXN0
X3JldGlyZShycSkpCiAJCQlicmVhazsKQEAgLTY4Nyw3ICs2NTUsNiBAQCBfX2k5MTVfcmVxdWVz
dF9jcmVhdGUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBnZnBfdCBnZnApCiAJcnEtPndhaXRi
b29zdCA9IGZhbHNlOwogCXJxLT5leGVjdXRpb25fbWFzayA9IEFMTF9FTkdJTkVTOwogCi0JSU5J
VF9MSVNUX0hFQUQoJnJxLT5hY3RpdmVfbGlzdCk7CiAJSU5JVF9MSVNUX0hFQUQoJnJxLT5leGVj
dXRlX2NiKTsKIAogCS8qCkBAIC03MjYsNyArNjkzLDYgQEAgX19pOTE1X3JlcXVlc3RfY3JlYXRl
KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgZ2ZwX3QgZ2ZwKQogCWNlLT5yaW5nLT5lbWl0ID0g
cnEtPmhlYWQ7CiAKIAkvKiBNYWtlIHN1cmUgd2UgZGlkbid0IGFkZCBvdXJzZWx2ZXMgdG8gZXh0
ZXJuYWwgc3RhdGUgYmVmb3JlIGZyZWVpbmcgKi8KLQlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZy
cS0+YWN0aXZlX2xpc3QpKTsKIAlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZycS0+c2NoZWQuc2ln
bmFsZXJzX2xpc3QpKTsKIAlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZycS0+c2NoZWQud2FpdGVy
c19saXN0KSk7CiAKQEAgLTExMTMsNyArMTA3OSw4IEBAIF9faTkxNV9yZXF1ZXN0X2FkZF90b190
aW1lbGluZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAkgKiBwcmVjbHVkZXMgb3B0aW1pc2lu
ZyB0byB1c2Ugc2VtYXBob3JlcyBzZXJpYWxpc2F0aW9uIG9mIGEgc2luZ2xlCiAJICogdGltZWxp
bmUgYWNyb3NzIGVuZ2luZXMuCiAJICovCi0JcHJldiA9IHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0
ZWQodGltZWxpbmUtPmxhc3RfcmVxdWVzdC5yZXF1ZXN0LCAxKTsKKwlwcmV2ID0gdG9fcmVxdWVz
dChfX2k5MTVfYWN0aXZlX2ZlbmNlX3NldCgmdGltZWxpbmUtPmxhc3RfcmVxdWVzdCwKKwkJCQkJ
CSAgJnJxLT5mZW5jZSkpOwogCWlmIChwcmV2ICYmICFpOTE1X3JlcXVlc3RfY29tcGxldGVkKHBy
ZXYpKSB7CiAJCWlmIChpc19wb3dlcl9vZl8yKHByZXYtPmVuZ2luZS0+bWFzayB8IHJxLT5lbmdp
bmUtPm1hc2spKQogCQkJaTkxNV9zd19mZW5jZV9hd2FpdF9zd19mZW5jZSgmcnEtPnN1Ym1pdCwK
QEAgLTExMzgsNyArMTEwNSw2IEBAIF9faTkxNV9yZXF1ZXN0X2FkZF90b190aW1lbGluZShzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAkgKiB1cywgdGhlIHRpbWVsaW5lIHdpbGwgaG9sZCBpdHMg
c2Vxbm8gd2hpY2ggaXMgbGF0ZXIgdGhhbiBvdXJzLgogCSAqLwogCUdFTV9CVUdfT04odGltZWxp
bmUtPnNlcW5vICE9IHJxLT5mZW5jZS5zZXFubyk7Ci0JX19pOTE1X2FjdGl2ZV9yZXF1ZXN0X3Nl
dCgmdGltZWxpbmUtPmxhc3RfcmVxdWVzdCwgcnEpOwogCiAJcmV0dXJuIHByZXY7CiB9CkBAIC0x
MzY5LDEwICsxMzM1LDYgQEAgc3RhdGljIHZvaWQgcmVxdWVzdF93YWl0X3dha2Uoc3RydWN0IGRt
YV9mZW5jZSAqZmVuY2UsIHN0cnVjdCBkbWFfZmVuY2VfY2IgKmNiKQogICogbWF4aW11bSBvZiBA
dGltZW91dCBqaWZmaWVzICh3aXRoIE1BWF9TQ0hFRFVMRV9USU1FT1VUIGltcGx5aW5nIGFuCiAg
KiB1bmJvdW5kZWQgd2FpdCkuCiAgKgotICogSWYgdGhlIGNhbGxlciBob2xkcyB0aGUgc3RydWN0
X211dGV4LCB0aGUgY2FsbGVyIG11c3QgcGFzcyBJOTE1X1dBSVRfTE9DS0VECi0gKiBpbiB2aWEg
dGhlIGZsYWdzLCBhbmQgdmljZSB2ZXJzYSBpZiB0aGUgc3RydWN0X211dGV4IGlzIG5vdCBoZWxk
LCB0aGUgY2FsbGVyCi0gKiBtdXN0IG5vdCBzcGVjaWZ5IHRoYXQgdGhlIHdhaXQgaXMgbG9ja2Vk
LgotICoKICAqIFJldHVybnMgdGhlIHJlbWFpbmluZyB0aW1lIChpbiBqaWZmaWVzKSBpZiB0aGUg
cmVxdWVzdCBjb21wbGV0ZWQsIHdoaWNoIG1heQogICogYmUgemVybyBvciAtRVRJTUUgaWYgdGhl
IHJlcXVlc3QgaXMgdW5maW5pc2hlZCBhZnRlciB0aGUgdGltZW91dCBleHBpcmVzLgogICogTWF5
IHJldHVybiAtRUlOVFIgaXMgY2FsbGVkIHdpdGggSTkxNV9XQUlUX0lOVEVSUlVQVElCTEUgYW5k
IGEgc2lnbmFsIGlzCkBAIC0xNDgyLDcgKzE0NDQsMTEgQEAgYm9vbCBpOTE1X3JldGlyZV9yZXF1
ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5
X3NhZmUocmluZywgdG1wLAogCQkJCSAmaTkxNS0+Z3QuYWN0aXZlX3JpbmdzLCBhY3RpdmVfbGlu
aykgewogCQlpbnRlbF9yaW5nX2dldChyaW5nKTsgLyogbGFzdCBycSBob2xkcyByZWZlcmVuY2Uh
ICovCisJCW11dGV4X2xvY2soJnJpbmctPnRpbWVsaW5lLT5tdXRleCk7CisKIAkJcmluZ19yZXRp
cmVfcmVxdWVzdHMocmluZyk7CisKKwkJbXV0ZXhfdW5sb2NrKCZyaW5nLT50aW1lbGluZS0+bXV0
ZXgpOwogCQlpbnRlbF9yaW5nX3B1dChyaW5nKTsKIAl9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9y
ZXF1ZXN0LmgKaW5kZXggYmViYzFlOWI0YTVlLi44Mjc3Y2ZmMGRmNzAgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfcmVxdWVzdC5oCkBAIC0yMTEsNyArMjExLDYgQEAgc3RydWN0IGk5MTVfcmVxdWVz
dCB7CiAJICogb24gdGhlIGFjdGl2ZV9saXN0IChvZiB0aGVpciBmaW5hbCByZXF1ZXN0KS4KIAkg
Ki8KIAlzdHJ1Y3QgaTkxNV9jYXB0dXJlX2xpc3QgKmNhcHR1cmVfbGlzdDsKLQlzdHJ1Y3QgbGlz
dF9oZWFkIGFjdGl2ZV9saXN0OwogCiAJLyoqIFRpbWUgYXQgd2hpY2ggdGhpcyByZXF1ZXN0IHdh
cyBlbWl0dGVkLCBpbiBqaWZmaWVzLiAqLwogCXVuc2lnbmVkIGxvbmcgZW1pdHRlZF9qaWZmaWVz
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90aW1lbGluZS5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV90aW1lbGluZS5jCmluZGV4IGUyZjkzMzZiYWI4My4uNGZm
YjYxOTkxNzY4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5l
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90aW1lbGluZS5jCkBAIC0xNzksOCAr
MTc5LDcgQEAgY2FjaGVsaW5lX2FsbG9jKHN0cnVjdCBpOTE1X3RpbWVsaW5lX2h3c3AgKmh3c3As
IHVuc2lnbmVkIGludCBjYWNoZWxpbmUpCiAJY2wtPmh3c3AgPSBod3NwOwogCWNsLT52YWRkciA9
IHBhZ2VfcGFja19iaXRzKHZhZGRyLCBjYWNoZWxpbmUpOwogCi0JaTkxNV9hY3RpdmVfaW5pdCho
d3NwX3RvX2k5MTUoaHdzcCksICZjbC0+YWN0aXZlLAotCQkJIF9fY2FjaGVsaW5lX2FjdGl2ZSwg
X19jYWNoZWxpbmVfcmV0aXJlKTsKKwlpOTE1X2FjdGl2ZV9pbml0KCZjbC0+YWN0aXZlLCBfX2Nh
Y2hlbGluZV9hY3RpdmUsIF9fY2FjaGVsaW5lX3JldGlyZSk7CiAKIAlyZXR1cm4gY2w7CiB9CkBA
IC0yNjMsNyArMjYyLDcgQEAgaW50IGk5MTVfdGltZWxpbmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKIAogCW11dGV4X2luaXQoJnRpbWVsaW5lLT5tdXRleCk7CiAKLQlJTklU
X0FDVElWRV9SRVFVRVNUKCZ0aW1lbGluZS0+bGFzdF9yZXF1ZXN0KTsKKwlJTklUX0FDVElWRV9G
RU5DRSgmdGltZWxpbmUtPmxhc3RfcmVxdWVzdCk7CiAJSU5JVF9MSVNUX0hFQUQoJnRpbWVsaW5l
LT5yZXF1ZXN0cyk7CiAKIAlpOTE1X3N5bmNtYXBfaW5pdCgmdGltZWxpbmUtPnN5bmMpOwpAQCAt
NDYzLDcgKzQ2Miw3IEBAIF9faTkxNV90aW1lbGluZV9nZXRfc2Vxbm8oc3RydWN0IGk5MTVfdGlt
ZWxpbmUgKnRsLAogCSAqIGFsbCB3cml0ZXMgaW50byB0aGUgY2FjaGVsaW5lIGZyb20gcHJldmlv
dXMgcmVxdWVzdHMgYXJlIGNvbXBsZXRlLgogCSAqLwogCWVyciA9IGk5MTVfYWN0aXZlX3JlZigm
dGwtPmh3c3BfY2FjaGVsaW5lLT5hY3RpdmUsCi0JCQkgICAgICB0bC0+ZmVuY2VfY29udGV4dCwg
cnEpOworCQkJICAgICAgdGwtPmZlbmNlX2NvbnRleHQsICZycS0+ZmVuY2UpOwogCWlmIChlcnIp
CiAJCWdvdG8gZXJyX2NhY2hlbGluZTsKIApAQCAtNTE0LDcgKzUxMyw3IEBAIGludCBpOTE1X3Rp
bWVsaW5lX2dldF9zZXFubyhzdHJ1Y3QgaTkxNV90aW1lbGluZSAqdGwsCiBzdGF0aWMgaW50IGNh
Y2hlbGluZV9yZWYoc3RydWN0IGk5MTVfdGltZWxpbmVfY2FjaGVsaW5lICpjbCwKIAkJCSBzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKLQlyZXR1cm4gaTkxNV9hY3RpdmVfcmVmKCZjbC0+YWN0
aXZlLCBycS0+ZmVuY2UuY29udGV4dCwgcnEpOworCXJldHVybiBpOTE1X2FjdGl2ZV9yZWYoJmNs
LT5hY3RpdmUsIHJxLT5mZW5jZS5jb250ZXh0LCAmcnEtPmZlbmNlKTsKIH0KIAogaW50IGk5MTVf
dGltZWxpbmVfcmVhZF9od3NwKHN0cnVjdCBpOTE1X3JlcXVlc3QgKmZyb20sCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5lX3R5cGVzLmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5lX3R5cGVzLmgKaW5kZXggZmNlNWNiNGYxMDkwLi41YWY2
ZDE4NWQ3MGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdGltZWxpbmVf
dHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5lX3R5cGVzLmgK
QEAgLTQ1LDcgKzQ1LDcgQEAgc3RydWN0IGk5MTVfdGltZWxpbmUgewogCSAqIHRoZSByZXF1ZXN0
IHVzaW5nIGk5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3JlcXVlc3RfcmN1KCksIG9yIGhvbGQgdGhl
CiAJICogc3RydWN0X211dGV4LgogCSAqLwotCXN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0IGxh
c3RfcmVxdWVzdDsKKwlzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgbGFzdF9yZXF1ZXN0OwogCiAJ
LyoqCiAJICogV2UgdHJhY2sgdGhlIG1vc3QgcmVjZW50IHNlcW5vIHRoYXQgd2Ugd2FpdCBvbiBp
biBldmVyeSBjb250ZXh0IHNvCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3ZtYS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwppbmRleCA1YmM1OGQwYmFm
NzMuLmI4YjhhOWNhMWFjNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92
bWEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCkBAIC0xMTQsOCArMTE0
LDcgQEAgdm1hX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCXZtYS0+
c2l6ZSA9IG9iai0+YmFzZS5zaXplOwogCXZtYS0+ZGlzcGxheV9hbGlnbm1lbnQgPSBJOTE1X0dU
VF9NSU5fQUxJR05NRU5UOwogCi0JaTkxNV9hY3RpdmVfaW5pdCh2bS0+aTkxNSwgJnZtYS0+YWN0
aXZlLAotCQkJIF9faTkxNV92bWFfYWN0aXZlLCBfX2k5MTVfdm1hX3JldGlyZSk7CisJaTkxNV9h
Y3RpdmVfaW5pdCgmdm1hLT5hY3RpdmUsIF9faTkxNV92bWFfYWN0aXZlLCBfX2k5MTVfdm1hX3Jl
dGlyZSk7CiAKIAlJTklUX0xJU1RfSEVBRCgmdm1hLT5jbG9zZWRfbGluayk7CiAKQEAgLTkwOSw3
ICs5MDgsNyBAQCBpbnQgaTkxNV92bWFfbW92ZV90b19hY3RpdmUoc3RydWN0IGk5MTVfdm1hICp2
bWEsCiAJICogYWRkIHRoZSBhY3RpdmUgcmVmZXJlbmNlIGZpcnN0IGFuZCBxdWV1ZSBmb3IgaXQg
dG8gYmUgZHJvcHBlZAogCSAqICpsYXN0Ki4KIAkgKi8KLQllcnIgPSBpOTE1X2FjdGl2ZV9yZWYo
JnZtYS0+YWN0aXZlLCBycS0+ZmVuY2UuY29udGV4dCwgcnEpOworCWVyciA9IGk5MTVfYWN0aXZl
X3JlZigmdm1hLT5hY3RpdmUsIHJxLT5mZW5jZS5jb250ZXh0LCAmcnEtPmZlbmNlKTsKIAlpZiAo
ZXJyKQogCQlyZXR1cm4gZXJyOwogCkBAIC05MjAsNyArOTE5LDcgQEAgaW50IGk5MTVfdm1hX21v
dmVfdG9fYWN0aXZlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogCQlpZiAoaW50ZWxfZnJvbnRidWZm
ZXJfaW52YWxpZGF0ZShvYmotPmZyb250YnVmZmVyLCBPUklHSU5fQ1MpKQogCQkJaTkxNV9hY3Rp
dmVfcmVmKCZvYmotPmZyb250YnVmZmVyLT53cml0ZSwKIAkJCQkJcnEtPmZlbmNlLmNvbnRleHQs
Ci0JCQkJCXJxKTsKKwkJCQkJJnJxLT5mZW5jZSk7CiAKIAkJb2JqLT5yZWFkX2RvbWFpbnMgPSAw
OwogCX0KQEAgLTkzOSwzMSArOTM4LDEwIEBAIGludCBpOTE1X3ZtYV91bmJpbmQoc3RydWN0IGk5
MTVfdm1hICp2bWEpCiAKIAlsb2NrZGVwX2Fzc2VydF9oZWxkKCZ2bWEtPnZtLT5pOTE1LT5kcm0u
c3RydWN0X211dGV4KTsKIAotCS8qCi0JICogRmlyc3Qgd2FpdCB1cG9uIGFueSBhY3Rpdml0eSBh
cyByZXRpcmluZyB0aGUgcmVxdWVzdCBtYXkKLQkgKiBoYXZlIHNpZGUtZWZmZWN0cyBzdWNoIGFz
IHVucGlubmluZyBvciBldmVuIHVuYmluZGluZyB0aGlzIHZtYS4KLQkgKi8KLQltaWdodF9zbGVl
cCgpOwotCWlmIChpOTE1X3ZtYV9pc19hY3RpdmUodm1hKSkgewotCQkvKgotCQkgKiBXaGVuIGEg
Y2xvc2VkIFZNQSBpcyByZXRpcmVkLCBpdCBpcyB1bmJvdW5kIC0gZWVrLgotCQkgKiBJbiBvcmRl
ciB0byBwcmV2ZW50IGl0IGZyb20gYmVpbmcgcmVjdXJzaXZlbHkgY2xvc2VkLAotCQkgKiB0YWtl
IGEgcGluIG9uIHRoZSB2bWEgc28gdGhhdCB0aGUgc2Vjb25kIHVuYmluZCBpcwotCQkgKiBhYm9y
dGVkLgotCQkgKgotCQkgKiBFdmVuIG1vcmUgc2NhcnkgaXMgdGhhdCB0aGUgcmV0aXJlIGNhbGxi
YWNrIG1heSBmcmVlCi0JCSAqIHRoZSBvYmplY3QgKGxhc3QgYWN0aXZlIHZtYSkuIFRvIHByZXZl
bnQgdGhlIGV4cGxvc2lvbgotCQkgKiB3ZSBkZWZlciB0aGUgYWN0dWFsIG9iamVjdCBmcmVlIHRv
IGEgd29ya2VyIHRoYXQgY2FuCi0JCSAqIG9ubHkgcHJvY2VlZCBvbmNlIGl0IGFjcXVpcmVzIHRo
ZSBzdHJ1Y3RfbXV0ZXggKHdoaWNoCi0JCSAqIHdlIGN1cnJlbnRseSBob2xkLCB0aGVyZWZvcmUg
aXQgY2Fubm90IGZyZWUgdGhpcyBvYmplY3QKLQkJICogYmVmb3JlIHdlIGFyZSBmaW5pc2hlZCku
Ci0JCSAqLwotCQlfX2k5MTVfdm1hX3Bpbih2bWEpOwotCQlyZXQgPSBpOTE1X2FjdGl2ZV93YWl0
KCZ2bWEtPmFjdGl2ZSk7Ci0JCV9faTkxNV92bWFfdW5waW4odm1hKTsKLQkJaWYgKHJldCkKLQkJ
CXJldHVybiByZXQ7Ci0JfQorCXJldCA9IGk5MTVfYWN0aXZlX3dhaXQoJnZtYS0+YWN0aXZlKTsK
KwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCiAJZmx1c2hfd29yaygmdm1hLT5hY3RpdmUud29y
ayk7CiAJR0VNX0JVR19PTihpOTE1X3ZtYV9pc19hY3RpdmUodm1hKSk7CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Zyb250YnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9mcm9udGJ1ZmZlci5jCmluZGV4IDRmY2VjNDEzZjQwNS4uZThhMWJiMjBm
NTQ4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9mcm9udGJ1ZmZlci5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Zyb250YnVmZmVyLmMKQEAgLTI1Myw4
ICsyNTMsNyBAQCBpbnRlbF9mcm9udGJ1ZmZlcl9nZXQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaikKIAlmYi0+b2JqID0gb2JqOwogCWtyZWZfaW5pdCgmZmItPnJlZik7CiAJYXRvbWlj
X3NldCgmZmItPmJpdHMsIDApOwotCWk5MTVfYWN0aXZlX2luaXQoaTkxNSwgJmZiLT53cml0ZSwK
LQkJCSBmcm9udGJ1ZmZlcl9hY3RpdmUsIGZyb250YnVmZmVyX3JldGlyZSk7CisJaTkxNV9hY3Rp
dmVfaW5pdCgmZmItPndyaXRlLCBmcm9udGJ1ZmZlcl9hY3RpdmUsIGZyb250YnVmZmVyX3JldGly
ZSk7CiAKIAlzcGluX2xvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwogCWlmIChvYmotPmZy
b250YnVmZmVyKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vdmVy
bGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vdmVybGF5LmMKaW5kZXggMzg0OTVk
ZjYwZjdiLi5kYzdiNjZjOTRmNzQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX292ZXJsYXkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9vdmVybGF5LmMK
QEAgLTIzMCw3ICsyMzAsOCBAQCBhbGxvY19yZXF1ZXN0KHN0cnVjdCBpbnRlbF9vdmVybGF5ICpv
dmVybGF5LCB2b2lkICgqZm4pKHN0cnVjdCBpbnRlbF9vdmVybGF5ICopKQogCWlmIChJU19FUlIo
cnEpKQogCQlyZXR1cm4gcnE7CiAKLQllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJm92ZXJsYXktPmxh
c3RfZmxpcCwgcnEtPmZlbmNlLmNvbnRleHQsIHJxKTsKKwllcnIgPSBpOTE1X2FjdGl2ZV9yZWYo
Jm92ZXJsYXktPmxhc3RfZmxpcCwKKwkJCSAgICAgIHJxLT5mZW5jZS5jb250ZXh0LCAmcnEtPmZl
bmNlKTsKIAlpZiAoZXJyKSB7CiAJCWk5MTVfcmVxdWVzdF9hZGQocnEpOwogCQlyZXR1cm4gRVJS
X1BUUihlcnIpOwpAQCAtMTM2Niw4ICsxMzY3LDcgQEAgdm9pZCBpbnRlbF9vdmVybGF5X3NldHVw
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlvdmVybGF5LT5jb250cmFzdCA9
IDc1OwogCW92ZXJsYXktPnNhdHVyYXRpb24gPSAxNDY7CiAKLQlpOTE1X2FjdGl2ZV9pbml0KGRl
dl9wcml2LAotCQkJICZvdmVybGF5LT5sYXN0X2ZsaXAsCisJaTkxNV9hY3RpdmVfaW5pdCgmb3Zl
cmxheS0+bGFzdF9mbGlwLAogCQkJIE5VTEwsIGludGVsX292ZXJsYXlfbGFzdF9mbGlwX3JldGly
ZSk7CiAKIAlyZXQgPSBnZXRfcmVnaXN0ZXJzKG92ZXJsYXksIE9WRVJMQVlfTkVFRFNfUEhZU0lD
QUwoZGV2X3ByaXYpKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9pOTE1X2FjdGl2ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0
aXZlLmMKaW5kZXggM2IzY2E1NjU4MTIyLi4zNzZlYTA0MzUwYjEgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2FjdGl2ZS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2FjdGl2ZS5jCkBAIC0zNiw3ICszNiw3IEBAIHN0YXRp
YyBpbnQgX19saXZlX2FjdGl2ZV9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
IAlpZiAoIXN1Ym1pdCkKIAkJcmV0dXJuIC1FTk9NRU07CiAKLQlpOTE1X2FjdGl2ZV9pbml0KGk5
MTUsICZhY3RpdmUtPmJhc2UsIE5VTEwsIF9fbGl2ZV9hY3RpdmVfcmV0aXJlKTsKKwlpOTE1X2Fj
dGl2ZV9pbml0KCZhY3RpdmUtPmJhc2UsIE5VTEwsIF9fbGl2ZV9hY3RpdmVfcmV0aXJlKTsKIAlh
Y3RpdmUtPnJldGlyZWQgPSBmYWxzZTsKIAogCWVyciA9IGk5MTVfYWN0aXZlX2FjcXVpcmUoJmFj
dGl2ZS0+YmFzZSk7CkBAIC01Nyw3ICs1Nyw4IEBAIHN0YXRpYyBpbnQgX19saXZlX2FjdGl2ZV9z
ZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCQkJCSAgICAgICBHRlBfS0VS
TkVMKTsKIAkJaWYgKGVyciA+PSAwKQogCQkJZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZhY3RpdmUt
PmJhc2UsCi0JCQkJCSAgICAgIHJxLT5mZW5jZS5jb250ZXh0LCBycSk7CisJCQkJCSAgICAgIHJx
LT5mZW5jZS5jb250ZXh0LAorCQkJCQkgICAgICAmcnEtPmZlbmNlKTsKIAkJaTkxNV9yZXF1ZXN0
X2FkZChycSk7CiAJCWlmIChlcnIpIHsKIAkJCXByX2VycigiRmFpbGVkIHRvIHRyYWNrIGFjdGl2
ZSByZWYhXG4iKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9t
b2NrX3RpbWVsaW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja190aW1l
bGluZS5jCmluZGV4IDY1YjUyYmUyM2Q0Mi4uMDI0ZGU3MThmNjZmIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja190aW1lbGluZS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX3RpbWVsaW5lLmMKQEAgLTE1LDcgKzE1LDcgQEAg
dm9pZCBtb2NrX3RpbWVsaW5lX2luaXQoc3RydWN0IGk5MTVfdGltZWxpbmUgKnRpbWVsaW5lLCB1
NjQgY29udGV4dCkKIAogCW11dGV4X2luaXQoJnRpbWVsaW5lLT5tdXRleCk7CiAKLQlJTklUX0FD
VElWRV9SRVFVRVNUKCZ0aW1lbGluZS0+bGFzdF9yZXF1ZXN0KTsKKwlJTklUX0FDVElWRV9GRU5D
RSgmdGltZWxpbmUtPmxhc3RfcmVxdWVzdCk7CiAJSU5JVF9MSVNUX0hFQUQoJnRpbWVsaW5lLT5y
ZXF1ZXN0cyk7CiAKIAlpOTE1X3N5bmNtYXBfaW5pdCgmdGltZWxpbmUtPnN5bmMpOwotLSAKMi4y
MC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRl
bC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9E7C84A481
	for <lists+intel-gfx@lfdr.de>; Tue, 18 Jun 2019 16:54:09 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8807B6E1C0;
	Tue, 18 Jun 2019 14:54:07 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 63FF66E1C0
 for <intel-gfx@lists.freedesktop.org>; Tue, 18 Jun 2019 14:54:06 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 16942161-1500050 for multiple; Tue, 18 Jun 2019 15:54:01 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Ville Syrjala <ville.syrjala@linux.intel.com>,
 intel-gfx@lists.freedesktop.org
References: <20190618142108.9978-1-ville.syrjala@linux.intel.com>
 <20190618142108.9978-3-ville.syrjala@linux.intel.com>
In-Reply-To: <20190618142108.9978-3-ville.syrjala@linux.intel.com>
Message-ID: <156086964155.31375.16801855183444485115@skylake-alporthouse-com>
Date: Tue, 18 Jun 2019 15:54:01 +0100
Subject: Re: [Intel-gfx] [PATCH 2/3] drm/i915: Nuke drm_driver irq vfuncs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBWaWxsZSBTeXJqYWxhICgyMDE5LTA2LTE4IDE1OjIxOjA3KQpbc25pcCBtZWNoYW5p
Y2FsIGNoYW5nZXNdCgo+IEBAIC00ODM5LDY1ICs0NzkyLDE4IEBAIHZvaWQgaW50ZWxfaXJxX2lu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAgICAgICAgZGV2LT5kcml2
ZXItPmdldF92YmxhbmtfdGltZXN0YW1wID0gZHJtX2NhbGNfdmJsdGltZXN0YW1wX2Zyb21fc2Nh
bm91dHBvczsKPiAgICAgICAgIGRldi0+ZHJpdmVyLT5nZXRfc2Nhbm91dF9wb3NpdGlvbiA9IGk5
MTVfZ2V0X2NydGNfc2Nhbm91dHBvczsKPiAgCj4gLSAgICAgICBpZiAoSVNfQ0hFUlJZVklFVyhk
ZXZfcHJpdikpIHsKPiAtICAgICAgICAgICAgICAgZGV2LT5kcml2ZXItPmlycV9oYW5kbGVyID0g
Y2hlcnJ5dmlld19pcnFfaGFuZGxlcjsKPiAtICAgICAgICAgICAgICAgZGV2LT5kcml2ZXItPmly
cV9wcmVpbnN0YWxsID0gY2hlcnJ5dmlld19pcnFfcmVzZXQ7Cj4gLSAgICAgICAgICAgICAgIGRl
di0+ZHJpdmVyLT5pcnFfcG9zdGluc3RhbGwgPSBjaGVycnl2aWV3X2lycV9wb3N0aW5zdGFsbDsK
PiAtICAgICAgICAgICAgICAgZGV2LT5kcml2ZXItPmlycV91bmluc3RhbGwgPSBjaGVycnl2aWV3
X2lycV9yZXNldDsKPiAtICAgICAgICAgICAgICAgZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9z
ZXR1cCA9IGk5MTVfaHBkX2lycV9zZXR1cDsKPiAtICAgICAgIH0gZWxzZSBpZiAoSVNfVkFMTEVZ
VklFVyhkZXZfcHJpdikpIHsKPiAtICAgICAgICAgICAgICAgZGV2LT5kcml2ZXItPmlycV9oYW5k
bGVyID0gdmFsbGV5dmlld19pcnFfaGFuZGxlcjsKPiAtICAgICAgICAgICAgICAgZGV2LT5kcml2
ZXItPmlycV9wcmVpbnN0YWxsID0gdmFsbGV5dmlld19pcnFfcmVzZXQ7Cj4gLSAgICAgICAgICAg
ICAgIGRldi0+ZHJpdmVyLT5pcnFfcG9zdGluc3RhbGwgPSB2YWxsZXl2aWV3X2lycV9wb3N0aW5z
dGFsbDsKPiAtICAgICAgICAgICAgICAgZGV2LT5kcml2ZXItPmlycV91bmluc3RhbGwgPSB2YWxs
ZXl2aWV3X2lycV9yZXNldDsKPiAtICAgICAgICAgICAgICAgZGV2X3ByaXYtPmRpc3BsYXkuaHBk
X2lycV9zZXR1cCA9IGk5MTVfaHBkX2lycV9zZXR1cDsKPiAtICAgICAgIH0gZWxzZSBpZiAoSU5U
RUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewo+IC0gICAgICAgICAgICAgICBkZXYtPmRyaXZlci0+
aXJxX2hhbmRsZXIgPSBnZW4xMV9pcnFfaGFuZGxlcjsKPiAtICAgICAgICAgICAgICAgZGV2LT5k
cml2ZXItPmlycV9wcmVpbnN0YWxsID0gZ2VuMTFfaXJxX3Jlc2V0Owo+IC0gICAgICAgICAgICAg
ICBkZXYtPmRyaXZlci0+aXJxX3Bvc3RpbnN0YWxsID0gZ2VuMTFfaXJxX3Bvc3RpbnN0YWxsOwo+
IC0gICAgICAgICAgICAgICBkZXYtPmRyaXZlci0+aXJxX3VuaW5zdGFsbCA9IGdlbjExX2lycV9y
ZXNldDsKPiAtICAgICAgICAgICAgICAgZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9
IGdlbjExX2hwZF9pcnFfc2V0dXA7Cj4gLSAgICAgICB9IGVsc2UgaWYgKElOVEVMX0dFTihkZXZf
cHJpdikgPj0gOCkgewo+IC0gICAgICAgICAgICAgICBkZXYtPmRyaXZlci0+aXJxX2hhbmRsZXIg
PSBnZW44X2lycV9oYW5kbGVyOwo+IC0gICAgICAgICAgICAgICBkZXYtPmRyaXZlci0+aXJxX3By
ZWluc3RhbGwgPSBnZW44X2lycV9yZXNldDsKPiAtICAgICAgICAgICAgICAgZGV2LT5kcml2ZXIt
PmlycV9wb3N0aW5zdGFsbCA9IGdlbjhfaXJxX3Bvc3RpbnN0YWxsOwo+IC0gICAgICAgICAgICAg
ICBkZXYtPmRyaXZlci0+aXJxX3VuaW5zdGFsbCA9IGdlbjhfaXJxX3Jlc2V0Owo+IC0gICAgICAg
ICAgICAgICBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gKyAgICAgICBpZiAoSEFTX0dNQ0go
ZGV2X3ByaXYpKSB7Cj4gKyAgICAgICAgICAgICAgIGlmIChJOTE1X0hBU19IT1RQTFVHKGRldl9w
cml2KSkKPiArICAgICAgICAgICAgICAgICAgICAgICBkZXZfcHJpdi0+ZGlzcGxheS5ocGRfaXJx
X3NldHVwID0gaTkxNV9ocGRfaXJxX3NldHVwOwoKSW5jbHVkZXMgY2h2L3Zsdi4KCj4gKyAgICAg
ICB9IGVsc2Ugewo+ICsgICAgICAgICAgICAgICBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAx
MSkKPiArICAgICAgICAgICAgICAgICAgICAgICBkZXZfcHJpdi0+ZGlzcGxheS5ocGRfaXJxX3Nl
dHVwID0gZ2VuMTFfaHBkX2lycV9zZXR1cDsKCk9rLgoKPiArICAgICAgICAgICAgICAgZWxzZSBp
ZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpCj4gICAgICAgICAgICAgICAgICAgICAgICAgZGV2X3By
aXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9IGJ4dF9ocGRfaXJxX3NldHVwOwo+ICAgICAgICAg
ICAgICAgICBlbHNlIGlmIChJTlRFTF9QQ0hfVFlQRShkZXZfcHJpdikgPj0gUENIX1NQVCkKPiAg
ICAgICAgICAgICAgICAgICAgICAgICBkZXZfcHJpdi0+ZGlzcGxheS5ocGRfaXJxX3NldHVwID0g
c3B0X2hwZF9pcnFfc2V0dXA7CgpBcyBiZWZvcmUuCgo+ICAgICAgICAgICAgICAgICBlbHNlCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgZGV2X3ByaXYtPmRpc3BsYXkuaHBkX2lycV9zZXR1cCA9
IGlsa19ocGRfaXJxX3NldHVwOwoKVGhlIHJlc3Qgb2YgIUdNQ0guCgpDb2RlIGJlIG9uZSBsZXZl
bCBpZi1jaGFpbiB0aG91Z2guCgo+IEBAIC00OTE4LDYgKzQ4MjQsNzUgQEAgdm9pZCBpbnRlbF9p
cnFfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgICAgICAgICAgICAgICAg
a2ZyZWUoaTkxNS0+bDNfcGFyaXR5LnJlbWFwX2luZm9baV0pOwo+ICB9Cj4gIAo+ICtzdGF0aWMg
aXJxX2hhbmRsZXJfdCBpbnRlbF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCj4gK3sKPiArICAgICAgIGlmIChIQVNfR01DSChkZXZfcHJpdikpIHsKPiArICAg
ICAgICAgICAgICAgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIHJldHVybiBjaGVycnl2aWV3X2lycV9oYW5kbGVyOwo+ICsgICAgICAgICAgICAg
ICBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkKPiArICAgICAgICAgICAgICAgICAg
ICAgICByZXR1cm4gdmFsbGV5dmlld19pcnFfaGFuZGxlcjsKPiArICAgICAgICAgICAgICAgZWxz
ZSBpZiAoSVNfR0VOKGRldl9wcml2LCA0KSkKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1
cm4gaTk2NV9pcnFfaGFuZGxlcjsKPiArICAgICAgICAgICAgICAgZWxzZSBpZiAoSVNfR0VOKGRl
dl9wcml2LCAzKSkKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTkxNV9pcnFfaGFu
ZGxlcjsKPiArICAgICAgICAgICAgICAgZWxzZQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJl
dHVybiBpOHh4X2lycV9oYW5kbGVyOwo+ICsgICAgICAgfSBlbHNlIHsKPiArICAgICAgICAgICAg
ICAgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIGdlbjExX2lycV9oYW5kbGVyOwo+ICsgICAgICAgICAgICAgICBlbHNlIGlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDgpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IGdlbjhfaXJxX2hhbmRsZXI7Cj4gKyAgICAgICAgICAgICAgIGVsc2UKPiArICAgICAgICAgICAg
ICAgICAgICAgICByZXR1cm4gaXJvbmxha2VfaXJxX2hhbmRsZXI7Cj4gKyAgICAgICB9Cj4gK30K
PiArCj4gK3N0YXRpYyB2b2lkIGludGVsX2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCj4gK3sKPiArICAgICAgIGlmIChIQVNfR01DSChkZXZfcHJpdikpIHsKPiAr
ICAgICAgICAgICAgICAgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIGNoZXJyeXZpZXdfaXJxX3Jlc2V0KGRldl9wcml2KTsKPiArICAgICAgICAg
ICAgICAgZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgdmFsbGV5dmlld19pcnFfcmVzZXQoZGV2X3ByaXYpOwo+ICsgICAgICAgICAgICAg
ICBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDQpKQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IGk5NjVfaXJxX3Jlc2V0KGRldl9wcml2KTsKPiArICAgICAgICAgICAgICAgZWxzZSBpZiAoSVNf
R0VOKGRldl9wcml2LCAzKSkKPiArICAgICAgICAgICAgICAgICAgICAgICBpOTE1X2lycV9yZXNl
dChkZXZfcHJpdik7Cj4gKyAgICAgICAgICAgICAgIGVsc2UKPiArICAgICAgICAgICAgICAgICAg
ICAgICBpOHh4X2lycV9yZXNldChkZXZfcHJpdik7Cj4gKyAgICAgICB9IGVsc2Ugewo+ICsgICAg
ICAgICAgICAgICBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKPiArICAgICAgICAgICAg
ICAgICAgICAgICBnZW4xMV9pcnFfcmVzZXQoZGV2X3ByaXYpOwo+ICsgICAgICAgICAgICAgICBl
bHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDgpCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgZ2VuOF9pcnFfcmVzZXQoZGV2X3ByaXYpOwo+ICsgICAgICAgICAgICAgICBlbHNlCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgaXJvbmxha2VfaXJxX3Jlc2V0KGRldl9wcml2KTsKPiArICAg
ICAgIH0KPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaW50ZWxfaXJxX3Bvc3RpbnN0YWxsKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiArewo+ICsgICAgICAgaWYgKEhBU19HTUNI
KGRldl9wcml2KSkgewo+ICsgICAgICAgICAgICAgICBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJp
dikpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY2hlcnJ5dmlld19pcnFfcG9zdGluc3RhbGwo
ZGV2X3ByaXYpOwo+ICsgICAgICAgICAgICAgICBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9w
cml2KSkKPiArICAgICAgICAgICAgICAgICAgICAgICB2YWxsZXl2aWV3X2lycV9wb3N0aW5zdGFs
bChkZXZfcHJpdik7Cj4gKyAgICAgICAgICAgICAgIGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwg
NCkpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgaTk2NV9pcnFfcG9zdGluc3RhbGwoZGV2X3By
aXYpOwo+ICsgICAgICAgICAgICAgICBlbHNlIGlmIChJU19HRU4oZGV2X3ByaXYsIDMpKQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGk5MTVfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKPiAr
ICAgICAgICAgICAgICAgZWxzZQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGk4eHhfaXJxX3Bv
c3RpbnN0YWxsKGRldl9wcml2KTsKPiArICAgICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgICAgICAg
IGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IGdlbjExX2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7Cj4gKyAgICAgICAgICAgICAgIGVsc2Ug
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gOCkKPiArICAgICAgICAgICAgICAgICAgICAgICBn
ZW44X2lycV9wb3N0aW5zdGFsbChkZXZfcHJpdik7Cj4gKyAgICAgICAgICAgICAgIGVsc2UKPiAr
ICAgICAgICAgICAgICAgICAgICAgICBpcm9ubGFrZV9pcnFfcG9zdGluc3RhbGwoZGV2X3ByaXYp
Owo+ICsgICAgICAgfQo+ICt9Cj4gKwo+ICAvKioKPiAgICogaW50ZWxfaXJxX2luc3RhbGwgLSBl
bmFibGVzIHRoZSBoYXJkd2FyZSBpbnRlcnJ1cHQKPiAgICogQGRldl9wcml2OiBpOTE1IGRldmlj
ZSBpbnN0YW5jZQo+IEBAIC00OTMxLDYgKzQ5MDYsOSBAQCB2b2lkIGludGVsX2lycV9maW5pKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgKi8KPiAgaW50IGludGVsX2lycV9pbnN0
YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgewo+ICsgICAgICAgaW50
IGlycSA9IGRldl9wcml2LT5kcm0ucGRldi0+aXJxOwo+ICsgICAgICAgaW50IHJldDsKPiArCj4g
ICAgICAgICAvKgo+ICAgICAgICAgICogV2UgZW5hYmxlIHNvbWUgaW50ZXJydXB0IHNvdXJjZXMg
aW4gb3VyIHBvc3RpbnN0YWxsIGhvb2tzLCBzbyBtYXJrCj4gICAgICAgICAgKiBpbnRlcnJ1cHRz
IGFzIGVuYWJsZWQgX2JlZm9yZV8gYWN0dWFsbHkgZW5hYmxpbmcgdGhlbSB0byBhdm9pZAo+IEBA
IC00OTM4LDcgKzQ5MTYsMjAgQEAgaW50IGludGVsX2lycV9pbnN0YWxsKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKPiAgICAgICAgICAqLwo+ICAgICAgICAgZGV2X3ByaXYtPnJ1
bnRpbWVfcG0uaXJxc19lbmFibGVkID0gdHJ1ZTsKPiAgCj4gLSAgICAgICByZXR1cm4gZHJtX2ly
cV9pbnN0YWxsKCZkZXZfcHJpdi0+ZHJtLCBkZXZfcHJpdi0+ZHJtLnBkZXYtPmlycSk7Cj4gKyAg
ICAgICBkZXZfcHJpdi0+ZHJtLmlycV9lbmFibGVkID0gdHJ1ZTsKPiArCj4gKyAgICAgICBpbnRl
bF9pcnFfcmVzZXQoZGV2X3ByaXYpOwo+ICsKPiArICAgICAgIHJldCA9IHJlcXVlc3RfaXJxKGly
cSwgaW50ZWxfaXJxX2hhbmRsZXIoZGV2X3ByaXYpLAoKT2ggZmFuY3kuCgpSZXZpZXdlZC1ieTog
Q2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci1DaHJpcwpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBs
aXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

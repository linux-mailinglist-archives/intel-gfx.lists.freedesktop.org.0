Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 31BD6349BDE
	for <lists+intel-gfx@lfdr.de>; Thu, 25 Mar 2021 22:48:36 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E6A936EE5B;
	Thu, 25 Mar 2021 21:48:33 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 891A76EE5B
 for <intel-gfx@lists.freedesktop.org>; Thu, 25 Mar 2021 21:48:31 +0000 (UTC)
IronPort-SDR: 7UkALFaacDrsGlM3JYaZdGEgdDnl5ZtkEeMfo0dEQNFVqKaTcWoKInxetWYN+9BZUJMlI1QL/h
 fSl8JFSzjE5Q==
X-IronPort-AV: E=McAfee;i="6000,8403,9934"; a="171005071"
X-IronPort-AV: E=Sophos;i="5.81,278,1610438400"; d="scan'208";a="171005071"
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by fmsmga107.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 25 Mar 2021 14:48:31 -0700
IronPort-SDR: Pg4ovrM5fD7zxATkAdApWnAparOf+JQC7Ah8SgnmB55+59R6iieVretIxYEz2+aF4SpLwOlCox
 3qTx6BIRqpZA==
X-IronPort-AV: E=Sophos;i="5.81,278,1610438400"; d="scan'208";a="375235673"
Received: from ideak-desk.fi.intel.com ([10.237.68.141])
 by orsmga003-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 25 Mar 2021 14:48:30 -0700
From: Imre Deak <imre.deak@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 25 Mar 2021 23:47:58 +0200
Message-Id: <20210325214808.2071517-16-imre.deak@intel.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20210325214808.2071517-1-imre.deak@intel.com>
References: <20210325214808.2071517-1-imre.deak@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2 15/25] drm/i915/intel_fb: Factor out
 calc_plane_normal_size()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RmFjdG9yIG91dCB0byBhIG5ldyBmdW5jdGlvbiB0aGUgbG9naWMgdG8gY2FsY3VsYXRlIGFuIEZC
IHBsYW5lJ3MKbm9ybWFsLXZpZXcgc2l6ZS4KCkluc3RlYWQgb2YgdXNpbmcgaW50ZWxfcmVtYXBw
ZWRfcGxhbmVfaW5mbywgd2hpY2ggaXMgcmVsYXRlZCBvbmx5IHRvCnJlbWFwcGluZywgYWRkIGEg
aGVscGVyIHRvIGdldCB0aGUgdGlsZSBwaXRjaCBhbmQgcm93cyBmb3IgYW4gRkIgcGxhbmUsCnNv
IHRoZXNlIGhlbHBlcnMgY2FuIGJlIHVzZWQgYm90aCBieSB0aGUgbm9ybWFsIHNpemUgY2FsY3Vs
YXRpb24gYW5kIHRoZQpyZW1hcHBpbmcgY29kZS4KCkFsc28gYWRkIGEgbmV3IGZiX3BsYW5lX3Zp
ZXdfZGltcyBzdHJ1Y3QgaW4gd2hpY2ggd2UgY2FuIHBhc3MgYXJvdW5kIHRoZQp2aWV3IChlaXRo
ZXIgRkIgcGxhbmUgb3IgcGxhbmUgc291cmNlKSBhbmQgdGlsZSBkaW1lbnNpb25zIGNvbnZlbmll
bnRseQp0byBmdW5jdGlvbnMgY2FsY3VsYXRpbmcgZnVydGhlciB2aWV3IHBhcmFtZXRlcnMuCgp2
MjoKLSBBZGQgYmFjayB0aGUgKzEgdGlsZSBhZGp1c3RtZW50IGZvciB4IT0wIGluIGNhbGNfcGxh
bmVfbm9ybWFsX3NpemUoKS4gKFZpbGxlKQotIHMvcGFnZXMvdGlsZXMvIGluIGNhbGNfcGxhbmVf
bm9ybWFsX3NpemUoKS4gKFZpbGxlKQotIEFkZCBhIGhlbHBlciBmb3IgdGhlIHBsYW5lIHZpZXcg
d2lkdGggY2FsY3VsYXRpb24uIChWaWxsZSkKLSBSZXR1cm4gdGlsZXMgYXMgdW5zaWduZWQgaW50
IGZyb20gY2FsY19wbGFuZV9ub3JtYWxfc2l6ZSgpLgoKQ2M6IFZpbGxlIFN5cmrDpGzDpCA8dmls
bGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IEltcmUgRGVhayA8aW1y
ZS5kZWFrQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2ZiLmMgfCA5NyArKysrKysrKysrKysrKysrKysrLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgNzYg
aW5zZXJ0aW9ucygrKSwgMjEgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9mYi5jCmluZGV4IDE0MDBhMzFmMGRkNmIuLjZmODIwNjc2OWMzZGYgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZmIuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZiLmMKQEAgLTYzMiw2ICs2MzIsNzQgQEAgc3Rh
dGljIHUzMiBzZXR1cF9mYl9yb3RhdGlvbihpbnQgcGxhbmUsIGNvbnN0IHN0cnVjdCBpbnRlbF9y
ZW1hcHBlZF9wbGFuZV9pbmZvICoKIAlyZXR1cm4gcGxhbmVfaW5mby0+d2lkdGggKiBwbGFuZV9p
bmZvLT5oZWlnaHQ7CiB9CiAKK3N0cnVjdCBmYl9wbGFuZV92aWV3X2RpbXMgeworCXVuc2lnbmVk
IGludCB3aWR0aCwgaGVpZ2h0OworCXVuc2lnbmVkIGludCB0aWxlX3dpZHRoLCB0aWxlX2hlaWdo
dDsKK307CisKK3N0YXRpYyB2b2lkIGluaXRfcGxhbmVfdmlld19kaW1zKGNvbnN0IHN0cnVjdCBp
bnRlbF9mcmFtZWJ1ZmZlciAqZmIsIGludCBjb2xvcl9wbGFuZSwKKwkJCQkgdW5zaWduZWQgaW50
IHdpZHRoLCB1bnNpZ25lZCBpbnQgaGVpZ2h0LAorCQkJCSBzdHJ1Y3QgZmJfcGxhbmVfdmlld19k
aW1zICpkaW1zKQoreworCWRpbXMtPndpZHRoID0gd2lkdGg7CisJZGltcy0+aGVpZ2h0ID0gaGVp
Z2h0OworCisJaW50ZWxfdGlsZV9kaW1zKCZmYi0+YmFzZSwgY29sb3JfcGxhbmUsICZkaW1zLT50
aWxlX3dpZHRoLCAmZGltcy0+dGlsZV9oZWlnaHQpOworfQorCitzdGF0aWMgdW5zaWduZWQgaW50
CitwbGFuZV92aWV3X3N0cmlkZV90aWxlcyhjb25zdCBzdHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIg
KmZiLCBpbnQgY29sb3JfcGxhbmUsCisJCQljb25zdCBzdHJ1Y3QgZmJfcGxhbmVfdmlld19kaW1z
ICpkaW1zKQoreworCXJldHVybiBESVZfUk9VTkRfVVAoZmItPmJhc2UucGl0Y2hlc1tjb2xvcl9w
bGFuZV0sCisJCQkgICAgZGltcy0+dGlsZV93aWR0aCAqIGZiLT5iYXNlLmZvcm1hdC0+Y3BwW2Nv
bG9yX3BsYW5lXSk7Cit9CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQKK3BsYW5lX3ZpZXdfd2lkdGhf
dGlsZXMoY29uc3Qgc3RydWN0IGludGVsX2ZyYW1lYnVmZmVyICpmYiwgaW50IGNvbG9yX3BsYW5l
LAorCQkgICAgICAgY29uc3Qgc3RydWN0IGZiX3BsYW5lX3ZpZXdfZGltcyAqZGltcywKKwkJICAg
ICAgIGludCB4KQoreworCXJldHVybiBESVZfUk9VTkRfVVAoeCArIGRpbXMtPndpZHRoLCBkaW1z
LT50aWxlX3dpZHRoKTsKK30KKworc3RhdGljIHVuc2lnbmVkIGludAorcGxhbmVfdmlld19oZWln
aHRfdGlsZXMoY29uc3Qgc3RydWN0IGludGVsX2ZyYW1lYnVmZmVyICpmYiwgaW50IGNvbG9yX3Bs
YW5lLAorCQkJY29uc3Qgc3RydWN0IGZiX3BsYW5lX3ZpZXdfZGltcyAqZGltcywKKwkJCWludCB5
KQoreworCXJldHVybiBESVZfUk9VTkRfVVAoeSArIGRpbXMtPmhlaWdodCwgZGltcy0+dGlsZV9o
ZWlnaHQpOworfQorCisvKiBSZXR1cm4gbnVtYmVyIG9mIHRpbGVzIEBjb2xvcl9wbGFuZSBuZWVk
cy4gKi8KK3N0YXRpYyB1bnNpZ25lZCBpbnQKK2NhbGNfcGxhbmVfbm9ybWFsX3NpemUoY29uc3Qg
c3RydWN0IGludGVsX2ZyYW1lYnVmZmVyICpmYiwgaW50IGNvbG9yX3BsYW5lLAorCQkgICAgICAg
Y29uc3Qgc3RydWN0IGZiX3BsYW5lX3ZpZXdfZGltcyAqZGltcywKKwkJICAgICAgIGludCB4LCBp
bnQgeSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZmItPmJh
c2UuZGV2KTsKKwl1bnNpZ25lZCBpbnQgdGlsZXM7CisKKwlpZiAoaXNfc3VyZmFjZV9saW5lYXIo
JmZiLT5iYXNlLCBjb2xvcl9wbGFuZSkpIHsKKwkJdW5zaWduZWQgaW50IHNpemU7CisKKwkJc2l6
ZSA9ICh5ICsgZGltcy0+aGVpZ2h0KSAqIGZiLT5iYXNlLnBpdGNoZXNbY29sb3JfcGxhbmVdICsK
KwkJICAgICAgIHggKiBmYi0+YmFzZS5mb3JtYXQtPmNwcFtjb2xvcl9wbGFuZV07CisJCXRpbGVz
ID0gRElWX1JPVU5EX1VQKHNpemUsIGludGVsX3RpbGVfc2l6ZShpOTE1KSk7CisJfSBlbHNlIHsK
KwkJdGlsZXMgPSBwbGFuZV92aWV3X3N0cmlkZV90aWxlcyhmYiwgY29sb3JfcGxhbmUsIGRpbXMp
ICoKKwkJCXBsYW5lX3ZpZXdfaGVpZ2h0X3RpbGVzKGZiLCBjb2xvcl9wbGFuZSwgZGltcywgeSk7
CisJCS8qCisJCSAqIElmIHRoZSBwbGFuZSBpc24ndCBob3Jpem9udGFsbHkgdGlsZSBhbGlnbmVk
LAorCQkgKiB3ZSBuZWVkIG9uZSBtb3JlIHRpbGUuCisJCSAqLworCQlpZiAoeCAhPSAwKQorCQkJ
dGlsZXMrKzsKKwl9CisKKwlyZXR1cm4gdGlsZXM7Cit9CisKIGludCBpbnRlbF9maWxsX2ZiX2lu
Zm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHN0cnVjdCBkcm1fZnJhbWVidWZmZXIg
KmZiKQogewogCXN0cnVjdCBpbnRlbF9mcmFtZWJ1ZmZlciAqaW50ZWxfZmIgPSB0b19pbnRlbF9m
cmFtZWJ1ZmZlcihmYik7CkBAIC02NDIsNiArNzEwLDcgQEAgaW50IGludGVsX2ZpbGxfZmJfaW5m
byhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAq
ZmIKIAl1bnNpZ25lZCBpbnQgdGlsZV9zaXplID0gaW50ZWxfdGlsZV9zaXplKGk5MTUpOwogCiAJ
Zm9yIChpID0gMDsgaSA8IG51bV9wbGFuZXM7IGkrKykgeworCQlzdHJ1Y3QgZmJfcGxhbmVfdmll
d19kaW1zIHZpZXdfZGltczsKIAkJdW5zaWduZWQgaW50IHdpZHRoLCBoZWlnaHQ7CiAJCXVuc2ln
bmVkIGludCBjcHAsIHNpemU7CiAJCXUzMiBvZmZzZXQ7CkBAIC02NjcsNiArNzM2LDggQEAgaW50
IGludGVsX2ZpbGxfZmJfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0
IGRybV9mcmFtZWJ1ZmZlciAqZmIKIAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7CiAKKwkJaW5p
dF9wbGFuZV92aWV3X2RpbXMoaW50ZWxfZmIsIGksIHdpZHRoLCBoZWlnaHQsICZ2aWV3X2RpbXMp
OworCiAJCS8qCiAJCSAqIEZpcnN0IHBpeGVsIG9mIHRoZSBmcmFtZWJ1ZmZlciBmcm9tCiAJCSAq
IHRoZSBzdGFydCBvZiB0aGUgbm9ybWFsIGd0dCBtYXBwaW5nLgpAQCAtNjc4LDM4ICs3NDksMjIg
QEAgaW50IGludGVsX2ZpbGxfZmJfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
c3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIKIAogCQlpZiAoIWlzX3N1cmZhY2VfbGluZWFyKGZi
LCBpKSkgewogCQkJc3RydWN0IGludGVsX3JlbWFwcGVkX3BsYW5lX2luZm8gcGxhbmVfaW5mbzsK
LQkJCXVuc2lnbmVkIGludCB0aWxlX3dpZHRoLCB0aWxlX2hlaWdodDsKLQotCQkJaW50ZWxfdGls
ZV9kaW1zKGZiLCBpLCAmdGlsZV93aWR0aCwgJnRpbGVfaGVpZ2h0KTsKIAogCQkJcGxhbmVfaW5m
by5vZmZzZXQgPSBvZmZzZXQ7Ci0JCQlwbGFuZV9pbmZvLnN0cmlkZSA9IERJVl9ST1VORF9VUChm
Yi0+cGl0Y2hlc1tpXSwKLQkJCQkJCQkgdGlsZV93aWR0aCAqIGNwcCk7Ci0JCQlwbGFuZV9pbmZv
LndpZHRoID0gRElWX1JPVU5EX1VQKHggKyB3aWR0aCwgdGlsZV93aWR0aCk7Ci0JCQlwbGFuZV9p
bmZvLmhlaWdodCA9IERJVl9ST1VORF9VUCh5ICsgaGVpZ2h0LAotCQkJCQkJCSB0aWxlX2hlaWdo
dCk7Ci0KLQkJCS8qIGhvdyBtYW55IHRpbGVzIGRvZXMgdGhpcyBwbGFuZSBuZWVkICovCi0JCQlz
aXplID0gcGxhbmVfaW5mby5zdHJpZGUgKiBwbGFuZV9pbmZvLmhlaWdodDsKLQkJCS8qCi0JCQkg
KiBJZiB0aGUgcGxhbmUgaXNuJ3QgaG9yaXpvbnRhbGx5IHRpbGUgYWxpZ25lZCwKLQkJCSAqIHdl
IG5lZWQgb25lIG1vcmUgdGlsZS4KLQkJCSAqLwotCQkJaWYgKHggIT0gMCkKLQkJCQlzaXplKys7
CisJCQlwbGFuZV9pbmZvLnN0cmlkZSA9IHBsYW5lX3ZpZXdfc3RyaWRlX3RpbGVzKGludGVsX2Zi
LCBpLCAmdmlld19kaW1zKTsKKwkJCXBsYW5lX2luZm8ud2lkdGggPSBwbGFuZV92aWV3X3dpZHRo
X3RpbGVzKGludGVsX2ZiLCBpLCAmdmlld19kaW1zLCB4KTsKKwkJCXBsYW5lX2luZm8uaGVpZ2h0
ID0gcGxhbmVfdmlld19oZWlnaHRfdGlsZXMoaW50ZWxfZmIsIGksICZ2aWV3X2RpbXMsIHkpOwog
CiAJCQlndHRfb2Zmc2V0X3JvdGF0ZWQgKz0KIAkJCQlzZXR1cF9mYl9yb3RhdGlvbihpLCAmcGxh
bmVfaW5mbywKIAkJCQkJCSAgZ3R0X29mZnNldF9yb3RhdGVkLAogCQkJCQkJICB4LCB5LCB3aWR0
aCwgaGVpZ2h0LAogCQkJCQkJICB0aWxlX3NpemUsCi0JCQkJCQkgIHRpbGVfd2lkdGgsIHRpbGVf
aGVpZ2h0LAorCQkJCQkJICB2aWV3X2RpbXMudGlsZV93aWR0aCwgdmlld19kaW1zLnRpbGVfaGVp
Z2h0LAogCQkJCQkJICBmYik7Ci0JCX0gZWxzZSB7Ci0JCQlzaXplID0gRElWX1JPVU5EX1VQKCh5
ICsgaGVpZ2h0KSAqIGZiLT5waXRjaGVzW2ldICsKLQkJCQkJICAgIHggKiBjcHAsIHRpbGVfc2l6
ZSk7CiAJCX0KIAorCQlzaXplID0gY2FsY19wbGFuZV9ub3JtYWxfc2l6ZShpbnRlbF9mYiwgaSwg
JnZpZXdfZGltcywgeCwgeSk7CiAJCS8qIGhvdyBtYW55IHRpbGVzIGluIHRvdGFsIG5lZWRlZCBp
biB0aGUgYm8gKi8KIAkJbWF4X3NpemUgPSBtYXgobWF4X3NpemUsIG9mZnNldCArIHNpemUpOwog
CX0KLS0gCjIuMjUuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwt
Z2Z4Cg==

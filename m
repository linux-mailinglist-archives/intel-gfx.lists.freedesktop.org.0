Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1D9C447AB2
	for <lists+intel-gfx@lfdr.de>; Mon, 17 Jun 2019 09:21:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7030689176;
	Mon, 17 Jun 2019 07:21:23 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1E1AF89176
 for <intel-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 07:21:21 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16923039-1500050 
 for multiple; Mon, 17 Jun 2019 08:19:12 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 17 Jun 2019 08:18:54 +0100
Message-Id: <20190617071912.20256-4-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617071912.20256-1-chris@chris-wilson.co.uk>
References: <20190617071912.20256-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 04/22] drm/i915: Stop passing I915_WAIT_LOCKED
 to i915_request_wait()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: matthew.auld@intel.com, mika.kuoppala@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U2luY2UgY29tbWl0IGViOGQwZjVhZjRlYyAoImRybS9pOTE1OiBSZW1vdmUgR1BVIHJlc2V0IGRl
cGVuZGVuY2Ugb24Kc3RydWN0X211dGV4IiksIHRoZSBJOTE1X1dBSVRfTE9DS0VEIGZsYWdzIHBh
c3NlZCB0byBpOTE1X3JlcXVlc3Rfd2FpdCgpCmhhcyBiZWVuIGRlZnVuY3QuIE5vdyBnbyBhaGVh
ZCBhbmQgcmVtb3ZlIGl0IGZyb20gYWxsIGNhbGxlcnMuCgpSZWZlcmVuY2VzOiBlYjhkMGY1YWY0
ZWMgKCJkcm0vaTkxNTogUmVtb3ZlIEdQVSByZXNldCBkZXBlbmRlbmNlIG9uIHN0cnVjdF9tdXRl
eCIpClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVr
PgotLS0KIC4uLi9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYyB8IDE0
ICsrKy0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jICAg
IHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3dvcmthcm91bmRzLmMgICB8
ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyAgfCAg
OSArKy0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jICAgICAgICB8
IDI0ICsrKysrKy0tLS0tLS0tLQogLi4uL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJv
dW5kcy5jICAgIHwgIDYgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaCAg
ICAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jICAg
ICAgICAgICB8ICA0IC0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oICAgICAg
ICAgICAgIHwgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3JlcXVl
c3QuYyB8IDMwICsrKysrKystLS0tLS0tLS0tLS0KIC4uLi9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2k5MTVfdGltZWxpbmUuYyAgICB8ICA2ICsrLS0KIDExIGZpbGVzIGNoYW5nZWQsIDM2IGluc2Vy
dGlvbnMoKyksIDY2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKaW5kZXggMDNhYzUwMDNhYmYxLi5l
YWEyYjE2NTc0YzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVz
dHMvaTkxNV9nZW1fY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxm
dGVzdHMvaTkxNV9nZW1fY29udGV4dC5jCkBAIC04Myw5ICs4Myw3IEBAIHN0YXRpYyBpbnQgbGl2
ZV9ub3Bfc3dpdGNoKHZvaWQgKmFyZykKIAkJCX0KIAkJCWk5MTVfcmVxdWVzdF9hZGQocnEpOwog
CQl9Ci0JCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwKLQkJCQkgICAgICBJOTE1X1dBSVRfTE9D
S0VELAotCQkJCSAgICAgIEhaIC8gNSkgPCAwKSB7CisJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChy
cSwgMCwgSFogLyA1KSA8IDApIHsKIAkJCXByX2VycigiRmFpbGVkIHRvIHBvcHVsYXRlZCAlZCBj
b250ZXh0c1xuIiwgbmN0eCk7CiAJCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5MTUpOwogCQkJZXJy
ID0gLUVJTzsKQEAgLTEyOCw5ICsxMjYsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2
b2lkICphcmcpCiAKIAkJCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKIAkJCX0KLQkJCWlmIChpOTE1
X3JlcXVlc3Rfd2FpdChycSwKLQkJCQkJICAgICAgSTkxNV9XQUlUX0xPQ0tFRCwKLQkJCQkJICAg
ICAgSFogLyA1KSA8IDApIHsKKwkJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1
KSA8IDApIHsKIAkJCQlwcl9lcnIoIlN3aXRjaGluZyBiZXR3ZWVuICVsZCBjb250ZXh0cyB0aW1l
ZCBvdXRcbiIsCiAJCQkJICAgICAgIHByaW1lKTsKIAkJCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGk5
MTUpOwpAQCAtODkzLDcgKzg4OSw3IEBAIF9fcmVhZF9zbGljZV9jb3VudChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKIAlpZiAoc3BpbikKIAkJaWd0X3NwaW5uZXJfZW5kKHNwaW4pOwog
Ci0JcmV0ID0gaTkxNV9yZXF1ZXN0X3dhaXQocnEsIEk5MTVfV0FJVF9MT0NLRUQsIE1BWF9TQ0hF
RFVMRV9USU1FT1VUKTsKKwlyZXQgPSBpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgTUFYX1NDSEVE
VUxFX1RJTUVPVVQpOwogCWk5MTVfcmVxdWVzdF9wdXQocnEpOwogCWlmIChyZXQgPCAwKQogCQly
ZXR1cm4gcmV0OwpAQCAtOTgwLDkgKzk3Niw3IEBAIF9fc3NldV9maW5pc2goc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCiAJCWlndF9zcGlubmVyX2VuZChzcGluKTsKIAogCWlmICgoZmxh
Z3MgJiBURVNUX0lETEUpICYmIHJldCA9PSAwKSB7Ci0JCXJldCA9IGk5MTVfZ2VtX3dhaXRfZm9y
X2lkbGUoaTkxNSwKLQkJCQkJICAgICBJOTE1X1dBSVRfTE9DS0VELAotCQkJCQkgICAgIE1BWF9T
Q0hFRFVMRV9USU1FT1VUKTsKKwkJcmV0ID0gaTkxNV9nZW1fd2FpdF9mb3JfaWRsZShpOTE1LCAw
LCBNQVhfU0NIRURVTEVfVElNRU9VVCk7CiAJCWlmIChyZXQpCiAJCQlyZXR1cm4gcmV0OwogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMKaW5kZXggMDE5YmYwMzlm
NjE2Li5mODIxOTA5ODcyMDYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3JpbmdidWZmZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5n
YnVmZmVyLmMKQEAgLTE4MTUsNyArMTgxNSw3IEBAIHN0YXRpYyBub2lubGluZSBpbnQgd2FpdF9m
b3Jfc3BhY2Uoc3RydWN0IGludGVsX3JpbmcgKnJpbmcsIHVuc2lnbmVkIGludCBieXRlcykKIAkJ
cmV0dXJuIC1FTk9TUEM7CiAKIAl0aW1lb3V0ID0gaTkxNV9yZXF1ZXN0X3dhaXQodGFyZ2V0LAot
CQkJCSAgICBJOTE1X1dBSVRfSU5URVJSVVBUSUJMRSB8IEk5MTVfV0FJVF9MT0NLRUQsCisJCQkJ
ICAgIEk5MTVfV0FJVF9JTlRFUlJVUFRJQkxFLAogCQkJCSAgICBNQVhfU0NIRURVTEVfVElNRU9V
VCk7CiAJaWYgKHRpbWVvdXQgPCAwKQogCQlyZXR1cm4gdGltZW91dDsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3dvcmthcm91bmRzLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF93b3JrYXJvdW5kcy5jCmluZGV4IDE2NWIwYTQ1ZTAwOS4uOTYyNGQ5
ZTc3NmUzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF93b3JrYXJv
dW5kcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3dvcmthcm91bmRzLmMK
QEAgLTEzODQsNyArMTM4NCw3IEBAIHN0YXRpYyBpbnQgZW5naW5lX3dhX2xpc3RfdmVyaWZ5KHN0
cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKIAkJZ290byBlcnJfdm1hOwogCiAJaTkxNV9yZXF1ZXN0
X2FkZChycSk7Ci0JaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxLCBJOTE1X1dBSVRfTE9DS0VELCBI
WiAvIDUpIDwgMCkgeworCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDAp
IHsKIAkJZXJyID0gLUVUSU1FOwogCQlnb3RvIGVycl92bWE7CiAJfQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYwppbmRleCBiMGIyOTk4ZTU2YjguLjFlZTRj
OTIzMDQ0ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFu
Z2NoZWNrLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNr
LmMKQEAgLTMzOSw4ICszMzksNyBAQCBzdGF0aWMgaW50IGlndF9oYW5nX3Nhbml0eWNoZWNrKHZv
aWQgKmFyZykKIAogCQl0aW1lb3V0ID0gMDsKIAkJaWd0X3dlZGdlX29uX3RpbWVvdXQoJncsIGk5
MTUsIEhaIC8gMTAgLyogMTAwbXMgdGltZW91dCovKQotCQkJdGltZW91dCA9IGk5MTVfcmVxdWVz
dF93YWl0KHJxLAotCQkJCQkJICAgIEk5MTVfV0FJVF9MT0NLRUQsCisJCQl0aW1lb3V0ID0gaTkx
NV9yZXF1ZXN0X3dhaXQocnEsIDAsCiAJCQkJCQkgICAgTUFYX1NDSEVEVUxFX1RJTUVPVVQpOwog
CQlpZiAoaTkxNV9yZXNldF9mYWlsZWQoaTkxNSkpCiAJCQl0aW1lb3V0ID0gLUVJTzsKQEAgLTEw
OTgsNyArMTA5Nyw3IEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X3dhaXQodm9pZCAqYXJnKQogCiAJ
cmVzZXRfY291bnQgPSBmYWtlX2hhbmdjaGVjayhpOTE1LCBBTExfRU5HSU5FUyk7CiAKLQl0aW1l
b3V0ID0gaTkxNV9yZXF1ZXN0X3dhaXQocnEsIEk5MTVfV0FJVF9MT0NLRUQsIDEwKTsKKwl0aW1l
b3V0ID0gaTkxNV9yZXF1ZXN0X3dhaXQocnEsIDAsIDEwKTsKIAlpZiAodGltZW91dCA8IDApIHsK
IAkJcHJfZXJyKCJpOTE1X3JlcXVlc3Rfd2FpdCBmYWlsZWQgb24gYSBzdHVjayByZXF1ZXN0OiBl
cnI9JWxkXG4iLAogCQkgICAgICAgdGltZW91dCk7CkBAIC0xNjY2LDkgKzE2NjUsNyBAQCBzdGF0
aWMgaW50IGlndF9hdG9taWNfcmVzZXRfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSwKIAkJc3RydWN0IGlndF93ZWRnZV9tZSB3OwogCiAJCWlndF93ZWRnZV9vbl90aW1lb3V0
KCZ3LCBpOTE1LCBIWiAvIDIwIC8qIDUwbXMgdGltZW91dCovKQotCQkJaTkxNV9yZXF1ZXN0X3dh
aXQocnEsCi0JCQkJCSAgSTkxNV9XQUlUX0xPQ0tFRCwKLQkJCQkJICBNQVhfU0NIRURVTEVfVElN
RU9VVCk7CisJCQlpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgTUFYX1NDSEVEVUxFX1RJTUVPVVQp
OwogCQlpZiAoaTkxNV9yZXNldF9mYWlsZWQoaTkxNSkpCiAJCQllcnIgPSAtRUlPOwogCX0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKaW5kZXggZDg0ZDMxZTNkYTE5Li40MDFl
OGI1MzkyOTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xy
Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCkBAIC0xOTIs
NyArMTkyLDcgQEAgc3RhdGljIGludCBsaXZlX2J1c3l3YWl0X3ByZWVtcHQodm9pZCAqYXJnKQog
CQl9CiAKIAkJLyogTG93IHByaW9yaXR5IHJlcXVlc3Qgc2hvdWxkIGJlIGJ1c3l3YWl0aW5nIG5v
dyAqLwotCQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQobG8sIEk5MTVfV0FJVF9MT0NLRUQsIDEpICE9
IC1FVElNRSkgeworCQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQobG8sIDAsIDEpICE9IC1FVElNRSkg
ewogCQkJcHJfZXJyKCIlczogQnVzeXdhaXRpbmcgcmVxdWVzdCBkaWQgbm90IVxuIiwKIAkJCSAg
ICAgICBlbmdpbmUtPm5hbWUpOwogCQkJZXJyID0gLUVJTzsKQEAgLTIyMCw3ICsyMjAsNyBAQCBz
dGF0aWMgaW50IGxpdmVfYnVzeXdhaXRfcHJlZW1wdCh2b2lkICphcmcpCiAJCWludGVsX3Jpbmdf
YWR2YW5jZShoaSwgY3MpOwogCQlpOTE1X3JlcXVlc3RfYWRkKGhpKTsKIAotCQlpZiAoaTkxNV9y
ZXF1ZXN0X3dhaXQobG8sIEk5MTVfV0FJVF9MT0NLRUQsIEhaIC8gNSkgPCAwKSB7CisJCWlmIChp
OTE1X3JlcXVlc3Rfd2FpdChsbywgMCwgSFogLyA1KSA8IDApIHsKIAkJCXN0cnVjdCBkcm1fcHJp
bnRlciBwID0gZHJtX2luZm9fcHJpbnRlcihpOTE1LT5kcm0uZGV2KTsKIAogCQkJcHJfZXJyKCIl
czogRmFpbGVkIHRvIHByZWVtcHQgc2VtYXBob3JlIGJ1c3l3YWl0IVxuIiwKQEAgLTczOSw3ICs3
MzksNiBAQCBzdGF0aWMgaW50IGxpdmVfc3VwcHJlc3Nfd2FpdF9wcmVlbXB0KHZvaWQgKmFyZykK
IAkJCUdFTV9CVUdfT04oIWk5MTVfcmVxdWVzdF9zdGFydGVkKHJxWzBdKSk7CiAKIAkJCWlmIChp
OTE1X3JlcXVlc3Rfd2FpdChycVtkZXB0aF0sCi0JCQkJCSAgICAgIEk5MTVfV0FJVF9MT0NLRUQg
fAogCQkJCQkgICAgICBJOTE1X1dBSVRfUFJJT1JJVFksCiAJCQkJCSAgICAgIDEpICE9IC1FVElN
RSkgewogCQkJCXByX2VycigiJXM6IFdhaXRlciBkZXB0aDolZCBjb21wbGV0ZWQhXG4iLApAQCAt
ODQxLDcgKzg0MCw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9jaGFpbl9wcmVlbXB0KHZvaWQgKmFyZykK
IAkJCSBfX2Z1bmNfXywgZW5naW5lLT5uYW1lLCByaW5nX3NpemUpOwogCiAJCWlndF9zcGlubmVy
X2VuZCgmbG8uc3Bpbik7Ci0JCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgSTkxNV9XQUlUX0xP
Q0tFRCwgSFogLyAyKSA8IDApIHsKKwkJaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAv
IDIpIDwgMCkgewogCQkJcHJfZXJyKCJUaW1lZCBvdXQgd2FpdGluZyB0byBmbHVzaCAlc1xuIiwg
ZW5naW5lLT5uYW1lKTsKIAkJCWdvdG8gZXJyX3dlZGdlZDsKIAkJfQpAQCAtODgyLDcgKzg4MSw3
IEBAIHN0YXRpYyBpbnQgbGl2ZV9jaGFpbl9wcmVlbXB0KHZvaWQgKmFyZykKIAkJCWVuZ2luZS0+
c2NoZWR1bGUocnEsICZhdHRyKTsKIAogCQkJaWd0X3NwaW5uZXJfZW5kKCZoaS5zcGluKTsKLQkJ
CWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgSTkxNV9XQUlUX0xPQ0tFRCwgSFogLyA1KSA8IDAp
IHsKKwkJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDApIHsKIAkJCQlz
dHJ1Y3QgZHJtX3ByaW50ZXIgcCA9CiAJCQkJCWRybV9pbmZvX3ByaW50ZXIoaTkxNS0+ZHJtLmRl
dik7CiAKQEAgLTg5OCw3ICs4OTcsNyBAQCBzdGF0aWMgaW50IGxpdmVfY2hhaW5fcHJlZW1wdCh2
b2lkICphcmcpCiAJCQlpZiAoSVNfRVJSKHJxKSkKIAkJCQlnb3RvIGVycl93ZWRnZWQ7CiAJCQlp
OTE1X3JlcXVlc3RfYWRkKHJxKTsKLQkJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgSTkxNV9X
QUlUX0xPQ0tFRCwgSFogLyA1KSA8IDApIHsKKwkJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwg
MCwgSFogLyA1KSA8IDApIHsKIAkJCQlzdHJ1Y3QgZHJtX3ByaW50ZXIgcCA9CiAJCQkJCWRybV9p
bmZvX3ByaW50ZXIoaTkxNS0+ZHJtLmRldik7CiAKQEAgLTEzOTYsOSArMTM5NSw3IEBAIHN0YXRp
YyBpbnQgbm9wX3ZpcnR1YWxfZW5naW5lKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAog
CQl9CiAKIAkJZm9yIChuYyA9IDA7IG5jIDwgbmN0eDsgbmMrKykgewotCQkJaWYgKGk5MTVfcmVx
dWVzdF93YWl0KHJlcXVlc3RbbmNdLAotCQkJCQkgICAgICBJOTE1X1dBSVRfTE9DS0VELAotCQkJ
CQkgICAgICBIWiAvIDEwKSA8IDApIHsKKwkJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChyZXF1ZXN0
W25jXSwgMCwgSFogLyAxMCkgPCAwKSB7CiAJCQkJcHJfZXJyKCIlcyglcyk6IHdhaXQgZm9yICVs
bHg6JWxsZCB0aW1lZCBvdXRcbiIsCiAJCQkJICAgICAgIF9fZnVuY19fLCB2ZVswXS0+ZW5naW5l
LT5uYW1lLAogCQkJCSAgICAgICByZXF1ZXN0W25jXS0+ZmVuY2UuY29udGV4dCwKQEAgLTE1NDUs
NyArMTU0Miw3IEBAIHN0YXRpYyBpbnQgbWFza192aXJ0dWFsX2VuZ2luZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKIAl9CiAKIAlmb3IgKG4gPSAwOyBuIDwgbnNpYmxpbmc7IG4rKykg
ewotCQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocmVxdWVzdFtuXSwgSTkxNV9XQUlUX0xPQ0tFRCwg
SFogLyAxMCkgPCAwKSB7CisJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChyZXF1ZXN0W25dLCAwLCBI
WiAvIDEwKSA8IDApIHsKIAkJCXByX2VycigiJXMoJXMpOiB3YWl0IGZvciAlbGx4OiVsbGQgdGlt
ZWQgb3V0XG4iLAogCQkJICAgICAgIF9fZnVuY19fLCB2ZS0+ZW5naW5lLT5uYW1lLAogCQkJICAg
ICAgIHJlcXVlc3Rbbl0tPmZlbmNlLmNvbnRleHQsCkBAIC0xNzIwLDkgKzE3MTcsNyBAQCBzdGF0
aWMgaW50IGJvbmRfdmlydHVhbF9lbmdpbmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
CiAJCX0KIAkJb25zdGFja19mZW5jZV9maW5pKCZmZW5jZSk7CiAKLQkJaWYgKGk5MTVfcmVxdWVz
dF93YWl0KHJxWzBdLAotCQkJCSAgICAgIEk5MTVfV0FJVF9MT0NLRUQsCi0JCQkJICAgICAgSFog
LyAxMCkgPCAwKSB7CisJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycVswXSwgMCwgSFogLyAxMCkg
PCAwKSB7CiAJCQlwcl9lcnIoIk1hc3RlciByZXF1ZXN0IGRpZCBub3QgZXhlY3V0ZSAob24gJXMp
IVxuIiwKIAkJCSAgICAgICBycVswXS0+ZW5naW5lLT5uYW1lKTsKIAkJCWVyciA9IC1FSU87CkBA
IC0xNzMwLDggKzE3MjUsNyBAQCBzdGF0aWMgaW50IGJvbmRfdmlydHVhbF9lbmdpbmUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCX0KIAogCQlmb3IgKG4gPSAwOyBuIDwgbnNpYmxp
bmc7IG4rKykgewotCQkJaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxW24gKyAxXSwKLQkJCQkJICAg
ICAgSTkxNV9XQUlUX0xPQ0tFRCwKKwkJCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycVtuICsgMV0s
IDAsCiAJCQkJCSAgICAgIE1BWF9TQ0hFRFVMRV9USU1FT1VUKSA8IDApIHsKIAkJCQllcnIgPSAt
RUlPOwogCQkJCWdvdG8gb3V0OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3Rfd29ya2Fyb3VuZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X3dvcmthcm91bmRzLmMKaW5kZXggOTE0NDlkNTE1N2Y2Li44NzQyNmY5MTgzY2QgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rfd29ya2Fyb3VuZHMuYwpAQCAtNTQxLDcg
KzU0MSw3IEBAIHN0YXRpYyBpbnQgY2hlY2tfZGlydHlfd2hpdGVsaXN0KHN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHgsCiAJCWlmIChlcnIpCiAJCQlnb3RvIG91dF9iYXRjaDsKIAotCQlpZiAo
aTkxNV9yZXF1ZXN0X3dhaXQocnEsIEk5MTVfV0FJVF9MT0NLRUQsIEhaIC8gNSkgPCAwKSB7CisJ
CWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDApIHsKIAkJCXByX2Vycigi
JXM6IEZ1dHppbmcgJXggdGltZWRvdXQ7IGNhbmNlbGxpbmcgdGVzdFxuIiwKIAkJCSAgICAgICBl
bmdpbmUtPm5hbWUsIHJlZyk7CiAJCQlpOTE1X2dlbV9zZXRfd2VkZ2VkKGN0eC0+aTkxNSk7CkBA
IC03MzksNyArNzM5LDcgQEAgc3RhdGljIGludCByZWFkX3doaXRlbGlzdGVkX3JlZ2lzdGVycyhz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogZXJyX3JlcToKIAlpOTE1X3JlcXVlc3RfYWRk
KHJxKTsKIAotCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgSTkxNV9XQUlUX0xPQ0tFRCwgSFog
LyA1KSA8IDApCisJaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDUpIDwgMCkKIAkJ
ZXJyID0gLUVJTzsKIAogCXJldHVybiBlcnI7CkBAIC03OTAsNyArNzkwLDcgQEAgc3RhdGljIGlu
dCBzY3J1Yl93aGl0ZWxpc3RlZF9yZWdpc3RlcnMoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eCwKIAogZXJyX3JlcXVlc3Q6CiAJaTkxNV9yZXF1ZXN0X2FkZChycSk7Ci0JaWYgKGk5MTVfcmVx
dWVzdF93YWl0KHJxLCBJOTE1X1dBSVRfTE9DS0VELCBIWiAvIDUpIDwgMCkKKwlpZiAoaTkxNV9y
ZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gNSkgPCAwKQogCQllcnIgPSAtRUlPOwogCiBlcnJfdW5w
aW46CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaAppbmRleCBkNTVkMzc2NzM5NDQuLmMxNGVl
YmY2ZDA3NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oCkBAIC0zMzAsNyArMzMwLDcg
QEAgaTkxNV9hY3RpdmVfcmVxdWVzdF9yZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3Qg
KmFjdGl2ZSwKIAkJcmV0dXJuIDA7CiAKIAlyZXQgPSBpOTE1X3JlcXVlc3Rfd2FpdChyZXF1ZXN0
LAotCQkJCUk5MTVfV0FJVF9JTlRFUlJVUFRJQkxFIHwgSTkxNV9XQUlUX0xPQ0tFRCwKKwkJCQlJ
OTE1X1dBSVRfSU5URVJSVVBUSUJMRSwKIAkJCQlNQVhfU0NIRURVTEVfVElNRU9VVCk7CiAJaWYg
KHJldCA8IDApCiAJCXJldHVybiByZXQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCmlu
ZGV4IDk4MTk0ODNkMWI1ZC4uZDdmZDc3ZThhNzg5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3JlcXVlc3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Jl
cXVlc3QuYwpAQCAtMTM2MCwxMCArMTM2MCw2IEBAIHN0YXRpYyB2b2lkIHJlcXVlc3Rfd2FpdF93
YWtlKHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlLCBzdHJ1Y3QgZG1hX2ZlbmNlX2NiICpjYikKICAq
IG1heGltdW0gb2YgQHRpbWVvdXQgamlmZmllcyAod2l0aCBNQVhfU0NIRURVTEVfVElNRU9VVCBp
bXBseWluZyBhbgogICogdW5ib3VuZGVkIHdhaXQpLgogICoKLSAqIElmIHRoZSBjYWxsZXIgaG9s
ZHMgdGhlIHN0cnVjdF9tdXRleCwgdGhlIGNhbGxlciBtdXN0IHBhc3MgSTkxNV9XQUlUX0xPQ0tF
RAotICogaW4gdmlhIHRoZSBmbGFncywgYW5kIHZpY2UgdmVyc2EgaWYgdGhlIHN0cnVjdF9tdXRl
eCBpcyBub3QgaGVsZCwgdGhlIGNhbGxlcgotICogbXVzdCBub3Qgc3BlY2lmeSB0aGF0IHRoZSB3
YWl0IGlzIGxvY2tlZC4KLSAqCiAgKiBSZXR1cm5zIHRoZSByZW1haW5pbmcgdGltZSAoaW4gamlm
ZmllcykgaWYgdGhlIHJlcXVlc3QgY29tcGxldGVkLCB3aGljaCBtYXkKICAqIGJlIHplcm8gb3Ig
LUVUSU1FIGlmIHRoZSByZXF1ZXN0IGlzIHVuZmluaXNoZWQgYWZ0ZXIgdGhlIHRpbWVvdXQgZXhw
aXJlcy4KICAqIE1heSByZXR1cm4gLUVJTlRSIGlzIGNhbGxlZCB3aXRoIEk5MTVfV0FJVF9JTlRF
UlJVUFRJQkxFIGFuZCBhIHNpZ25hbCBpcwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV90cmFjZS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCmluZGV4
IDVjOGNmYWE3MGQ3Mi4uZjRjZTY0M2IzYmMzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3RyYWNlLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5o
CkBAIC04NjMsMTAgKzg2Myw5IEBAIFRSQUNFX0VWRU5UKGk5MTVfcmVxdWVzdF93YWl0X2JlZ2lu
LAogCQkJICAgX19lbnRyeS0+ZmxhZ3MgPSBmbGFnczsKIAkJCSAgICksCiAKLQkgICAgVFBfcHJp
bnRrKCJkZXY9JXUsIGVuZ2luZT0ldToldSwgaHdfaWQ9JXUsIGN0eD0lbGx1LCBzZXFubz0ldSwg
YmxvY2tpbmc9JXUsIGZsYWdzPTB4JXgiLAorCSAgICBUUF9wcmludGsoImRldj0ldSwgZW5naW5l
PSV1OiV1LCBod19pZD0ldSwgY3R4PSVsbHUsIHNlcW5vPSV1LCBmbGFncz0weCV4IiwKIAkJICAg
ICAgX19lbnRyeS0+ZGV2LCBfX2VudHJ5LT5jbGFzcywgX19lbnRyeS0+aW5zdGFuY2UsCiAJCSAg
ICAgIF9fZW50cnktPmh3X2lkLCBfX2VudHJ5LT5jdHgsIF9fZW50cnktPnNlcW5vLAotCQkgICAg
ICAhIShfX2VudHJ5LT5mbGFncyAmIEk5MTVfV0FJVF9MT0NLRUQpLAogCQkgICAgICBfX2VudHJ5
LT5mbGFncykKICk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3Jl
cXVlc3QuYwppbmRleCAzZGUyNGYzZDRlZDUuLjI5OGJiNzExNmM1MSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVzdC5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYwpAQCAtNzQsMTIgKzc0LDEyIEBA
IHN0YXRpYyBpbnQgaWd0X3dhaXRfcmVxdWVzdCh2b2lkICphcmcpCiAJCWdvdG8gb3V0X3VubG9j
azsKIAl9CiAKLQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocmVxdWVzdCwgSTkxNV9XQUlUX0xPQ0tF
RCwgMCkgIT0gLUVUSU1FKSB7CisJaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJlcXVlc3QsIDAsIDAp
ICE9IC1FVElNRSkgewogCQlwcl9lcnIoInJlcXVlc3Qgd2FpdCAoYnVzeSBxdWVyeSkgc3VjY2Vl
ZGVkIChleHBlY3RlZCB0aW1lb3V0IGJlZm9yZSBzdWJtaXQhKVxuIik7CiAJCWdvdG8gb3V0X3Vu
bG9jazsKIAl9CiAKLQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocmVxdWVzdCwgSTkxNV9XQUlUX0xP
Q0tFRCwgVCkgIT0gLUVUSU1FKSB7CisJaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJlcXVlc3QsIDAs
IFQpICE9IC1FVElNRSkgewogCQlwcl9lcnIoInJlcXVlc3Qgd2FpdCBzdWNjZWVkZWQgKGV4cGVj
dGVkIHRpbWVvdXQgYmVmb3JlIHN1Ym1pdCEpXG4iKTsKIAkJZ290byBvdXRfdW5sb2NrOwogCX0K
QEAgLTkxLDcgKzkxLDcgQEAgc3RhdGljIGludCBpZ3Rfd2FpdF9yZXF1ZXN0KHZvaWQgKmFyZykK
IAogCWk5MTVfcmVxdWVzdF9hZGQocmVxdWVzdCk7CiAKLQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQo
cmVxdWVzdCwgSTkxNV9XQUlUX0xPQ0tFRCwgMCkgIT0gLUVUSU1FKSB7CisJaWYgKGk5MTVfcmVx
dWVzdF93YWl0KHJlcXVlc3QsIDAsIDApICE9IC1FVElNRSkgewogCQlwcl9lcnIoInJlcXVlc3Qg
d2FpdCAoYnVzeSBxdWVyeSkgc3VjY2VlZGVkIChleHBlY3RlZCB0aW1lb3V0IGFmdGVyIHN1Ym1p
dCEpXG4iKTsKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KQEAgLTEwMSwxMiArMTAxLDEyIEBAIHN0
YXRpYyBpbnQgaWd0X3dhaXRfcmVxdWVzdCh2b2lkICphcmcpCiAJCWdvdG8gb3V0X3VubG9jazsK
IAl9CiAKLQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocmVxdWVzdCwgSTkxNV9XQUlUX0xPQ0tFRCwg
VCAvIDIpICE9IC1FVElNRSkgeworCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChyZXF1ZXN0LCAwLCBU
IC8gMikgIT0gLUVUSU1FKSB7CiAJCXByX2VycigicmVxdWVzdCB3YWl0IHN1Y2NlZWRlZCAoZXhw
ZWN0ZWQgdGltZW91dCEpXG4iKTsKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KIAotCWlmIChpOTE1
X3JlcXVlc3Rfd2FpdChyZXF1ZXN0LCBJOTE1X1dBSVRfTE9DS0VELCBUKSA9PSAtRVRJTUUpIHsK
KwlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocmVxdWVzdCwgMCwgVCkgPT0gLUVUSU1FKSB7CiAJCXBy
X2VycigicmVxdWVzdCB3YWl0IHRpbWVkIG91dCFcbiIpOwogCQlnb3RvIG91dF91bmxvY2s7CiAJ
fQpAQCAtMTE2LDcgKzExNiw3IEBAIHN0YXRpYyBpbnQgaWd0X3dhaXRfcmVxdWVzdCh2b2lkICph
cmcpCiAJCWdvdG8gb3V0X3VubG9jazsKIAl9CiAKLQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocmVx
dWVzdCwgSTkxNV9XQUlUX0xPQ0tFRCwgVCkgPT0gLUVUSU1FKSB7CisJaWYgKGk5MTVfcmVxdWVz
dF93YWl0KHJlcXVlc3QsIDAsIFQpID09IC1FVElNRSkgewogCQlwcl9lcnIoInJlcXVlc3Qgd2Fp
dCB0aW1lZCBvdXQgd2hlbiBhbHJlYWR5IGNvbXBsZXRlIVxuIik7CiAJCWdvdG8gb3V0X3VubG9j
azsKIAl9CkBAIC01NzQsOSArNTc0LDcgQEAgc3RhdGljIGludCBsaXZlX25vcF9yZXF1ZXN0KHZv
aWQgKmFyZykKIAogCQkJCWk5MTVfcmVxdWVzdF9hZGQocmVxdWVzdCk7CiAJCQl9Ci0JCQlpOTE1
X3JlcXVlc3Rfd2FpdChyZXF1ZXN0LAotCQkJCQkgIEk5MTVfV0FJVF9MT0NLRUQsCi0JCQkJCSAg
TUFYX1NDSEVEVUxFX1RJTUVPVVQpOworCQkJaTkxNV9yZXF1ZXN0X3dhaXQocmVxdWVzdCwgMCwg
TUFYX1NDSEVEVUxFX1RJTUVPVVQpOwogCiAJCQl0aW1lc1sxXSA9IGt0aW1lX3N1YihrdGltZV9n
ZXRfcmF3KCksIHRpbWVzWzFdKTsKIAkJCWlmIChwcmltZSA9PSAxKQpAQCAtNzA2LDkgKzcwNCw3
IEBAIHN0YXRpYyBpbnQgbGl2ZV9lbXB0eV9yZXF1ZXN0KHZvaWQgKmFyZykKIAkJCWVyciA9IFBU
Ul9FUlIocmVxdWVzdCk7CiAJCQlnb3RvIG91dF9iYXRjaDsKIAkJfQotCQlpOTE1X3JlcXVlc3Rf
d2FpdChyZXF1ZXN0LAotCQkJCSAgSTkxNV9XQUlUX0xPQ0tFRCwKLQkJCQkgIE1BWF9TQ0hFRFVM
RV9USU1FT1VUKTsKKwkJaTkxNV9yZXF1ZXN0X3dhaXQocmVxdWVzdCwgMCwgTUFYX1NDSEVEVUxF
X1RJTUVPVVQpOwogCiAJCWZvcl9lYWNoX3ByaW1lX251bWJlcl9mcm9tKHByaW1lLCAxLCA4MTky
KSB7CiAJCQl0aW1lc1sxXSA9IGt0aW1lX2dldF9yYXcoKTsKQEAgLTcyMCw5ICs3MTYsNyBAQCBz
dGF0aWMgaW50IGxpdmVfZW1wdHlfcmVxdWVzdCh2b2lkICphcmcpCiAJCQkJCWdvdG8gb3V0X2Jh
dGNoOwogCQkJCX0KIAkJCX0KLQkJCWk5MTVfcmVxdWVzdF93YWl0KHJlcXVlc3QsCi0JCQkJCSAg
STkxNV9XQUlUX0xPQ0tFRCwKLQkJCQkJICBNQVhfU0NIRURVTEVfVElNRU9VVCk7CisJCQlpOTE1
X3JlcXVlc3Rfd2FpdChyZXF1ZXN0LCAwLCBNQVhfU0NIRURVTEVfVElNRU9VVCk7CiAKIAkJCXRp
bWVzWzFdID0ga3RpbWVfc3ViKGt0aW1lX2dldF9yYXcoKSwgdGltZXNbMV0pOwogCQkJaWYgKHBy
aW1lID09IDEpCkBAIC04OTUsOCArODg5LDcgQEAgc3RhdGljIGludCBsaXZlX2FsbF9lbmdpbmVz
KHZvaWQgKmFyZykKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgewogCQlsb25n
IHRpbWVvdXQ7CiAKLQkJdGltZW91dCA9IGk5MTVfcmVxdWVzdF93YWl0KHJlcXVlc3RbaWRdLAot
CQkJCQkgICAgSTkxNV9XQUlUX0xPQ0tFRCwKKwkJdGltZW91dCA9IGk5MTVfcmVxdWVzdF93YWl0
KHJlcXVlc3RbaWRdLCAwLAogCQkJCQkgICAgTUFYX1NDSEVEVUxFX1RJTUVPVVQpOwogCQlpZiAo
dGltZW91dCA8IDApIHsKIAkJCWVyciA9IHRpbWVvdXQ7CkBAIC0xMDEzLDggKzEwMDYsNyBAQCBz
dGF0aWMgaW50IGxpdmVfc2VxdWVudGlhbF9lbmdpbmVzKHZvaWQgKmFyZykKIAkJCWdvdG8gb3V0
X3JlcXVlc3Q7CiAJCX0KIAotCQl0aW1lb3V0ID0gaTkxNV9yZXF1ZXN0X3dhaXQocmVxdWVzdFtp
ZF0sCi0JCQkJCSAgICBJOTE1X1dBSVRfTE9DS0VELAorCQl0aW1lb3V0ID0gaTkxNV9yZXF1ZXN0
X3dhaXQocmVxdWVzdFtpZF0sIDAsCiAJCQkJCSAgICBNQVhfU0NIRURVTEVfVElNRU9VVCk7CiAJ
CWlmICh0aW1lb3V0IDwgMCkgewogCQkJZXJyID0gdGltZW91dDsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3RpbWVsaW5lLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaTkxNV90aW1lbGluZS5jCmluZGV4IDcyNGJmMzY1MGIzZS4uNzZk
Mzk3N2YxZDRiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkx
NV90aW1lbGluZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3Rp
bWVsaW5lLmMKQEAgLTcyNCw3ICs3MjQsNyBAQCBzdGF0aWMgaW50IGxpdmVfaHdzcF93cmFwKHZv
aWQgKmFyZykKIAogCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKIAotCQlpZiAoaTkxNV9yZXF1ZXN0
X3dhaXQocnEsIEk5MTVfV0FJVF9MT0NLRUQsIEhaIC8gNSkgPCAwKSB7CisJCWlmIChpOTE1X3Jl
cXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDApIHsKIAkJCXByX2VycigiV2FpdCBmb3IgdGlt
ZWxpbmUgd3JpdGVzIHRpbWVkIG91dCFcbiIpOwogCQkJZXJyID0gLUVJTzsKIAkJCWdvdG8gb3V0
OwpAQCAtNzk3LDkgKzc5Nyw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9od3NwX3JlY3ljbGUodm9pZCAq
YXJnKQogCQkJCWdvdG8gb3V0OwogCQkJfQogCi0JCQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocnEs
Ci0JCQkJCSAgICAgIEk5MTVfV0FJVF9MT0NLRUQsCi0JCQkJCSAgICAgIEhaIC8gNSkgPCAwKSB7
CisJCQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8gNSkgPCAwKSB7CiAJCQkJcHJf
ZXJyKCJXYWl0IGZvciB0aW1lbGluZSB3cml0ZXMgdGltZWQgb3V0IVxuIik7CiAJCQkJaTkxNV90
aW1lbGluZV9wdXQodGwpOwogCQkJCWVyciA9IC1FSU87Ci0tIAoyLjIwLjEKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxp
c3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNr
dG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

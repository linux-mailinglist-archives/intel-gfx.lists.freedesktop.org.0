Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8C046396E17
	for <lists+intel-gfx@lfdr.de>; Tue,  1 Jun 2021 09:47:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EAEA86E878;
	Tue,  1 Jun 2021 07:47:11 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 73F526E852;
 Tue,  1 Jun 2021 07:47:10 +0000 (UTC)
IronPort-SDR: HRzEX97Ifx8fLZsBkPArJHHos3kExbT1OhwkvZn+Aa75H2N6ye9cHsCexciLb9mWxX/H0+dVne
 4ikVbkqmvtOA==
X-IronPort-AV: E=McAfee;i="6200,9189,10001"; a="200481765"
X-IronPort-AV: E=Sophos;i="5.83,239,1616482800"; d="scan'208";a="200481765"
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by fmsmga102.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 01 Jun 2021 00:47:09 -0700
IronPort-SDR: 0NbC/awb9iD4zzS41X3kIqyia/GeUkWOUwzH7AIR3PITy+7Nohar1lcZjM0n20KFNl7d7MJ6qj
 FExdVjh7djfQ==
X-IronPort-AV: E=Sophos;i="5.83,239,1616482800"; d="scan'208";a="549648689"
Received: from clillies-mobl.ger.corp.intel.com (HELO thellst-mobl1.intel.com)
 ([10.249.254.18])
 by fmsmga001-auth.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 01 Jun 2021 00:47:08 -0700
From: =?UTF-8?q?Thomas=20Hellstr=C3=B6m?= <thomas.hellstrom@linux.intel.com>
To: intel-gfx@lists.freedesktop.org,
	dri-devel@lists.freedesktop.org
Date: Tue,  1 Jun 2021 09:46:42 +0200
Message-Id: <20210601074654.3103-4-thomas.hellstrom@linux.intel.com>
X-Mailer: git-send-email 2.31.1
In-Reply-To: <20210601074654.3103-1-thomas.hellstrom@linux.intel.com>
References: <20210601074654.3103-1-thomas.hellstrom@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v9 03/15] drm/i915: Fix i915_sg_page_sizes to
 record dma segments rather than physical pages
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: =?UTF-8?q?Thomas=20Hellstr=C3=B6m?= <thomas.hellstrom@linux.intel.com>,
 Matthew Auld <matthew.auld@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QWxsIHVzZXJzIG9mIHRoaXMgZnVuY3Rpb24gYWN0dWFsbHkgd2FudCB0aGUgZG1hIHNlZ21lbnQg
c2l6ZXMsIGJ1dCB0aGF0J3MKbm90IHdoYXQncyBjYWxjdWxhdGVkLiBGaXggdGhhdCBhbmQgcmVu
YW1lIHRoZSBmdW5jdGlvbiB0bwppOTE1X3NnX2RtYV9zaXplcyB0byByZWZsZWN0IHdoYXQncyBj
YWxjdWxhdGVkLgoKU2lnbmVkLW9mZi1ieTogVGhvbWFzIEhlbGxzdHLDtm0gPHRob21hcy5oZWxs
c3Ryb21AbGludXguaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogTWF0dGhldyBBdWxkIDxtYXR0aGV3
LmF1bGRAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9k
bWFidWYuYyAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BoeXMu
YyAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNlcnB0ci5j
IHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc2NhdHRlcmxpc3QuaCAgICAgfCAx
NiArKysrKysrKysrKystLS0tCiA0IGZpbGVzIGNoYW5nZWQsIDE1IGluc2VydGlvbnMoKyksIDcg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2RtYWJ1Zi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RtYWJ1Zi5j
CmluZGV4IGNjZWRlNzNjNjQ2NS4uNjE2YzNhMmYxYmFmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG1hYnVmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2RtYWJ1Zi5jCkBAIC0yMDksNyArMjA5LDcgQEAgc3RhdGljIGludCBp
OTE1X2dlbV9vYmplY3RfZ2V0X3BhZ2VzX2RtYWJ1ZihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqKQogCWlmIChJU19FUlIocGFnZXMpKQogCQlyZXR1cm4gUFRSX0VSUihwYWdlcyk7CiAK
LQlzZ19wYWdlX3NpemVzID0gaTkxNV9zZ19wYWdlX3NpemVzKHBhZ2VzLT5zZ2wpOworCXNnX3Bh
Z2Vfc2l6ZXMgPSBpOTE1X3NnX2RtYV9zaXplcyhwYWdlcy0+c2dsKTsKIAogCV9faTkxNV9nZW1f
b2JqZWN0X3NldF9wYWdlcyhvYmosIHBhZ2VzLCBzZ19wYWdlX3NpemVzKTsKIApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BoeXMuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9waHlzLmMKaW5kZXggNTFhMDVlNjI4NzVkLi5iZTcyYWQw
NjM0YmEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9waHlz
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BoeXMuYwpAQCAtMjA3
LDcgKzIwNyw3IEBAIHN0YXRpYyBpbnQgaTkxNV9nZW1fb2JqZWN0X3NobWVtX3RvX3BoeXMoc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAogZXJyX3hmZXI6CiAJaWYgKCFJU19FUlJf
T1JfTlVMTChwYWdlcykpIHsKLQkJdW5zaWduZWQgaW50IHNnX3BhZ2Vfc2l6ZXMgPSBpOTE1X3Nn
X3BhZ2Vfc2l6ZXMocGFnZXMtPnNnbCk7CisJCXVuc2lnbmVkIGludCBzZ19wYWdlX3NpemVzID0g
aTkxNV9zZ19kbWFfc2l6ZXMocGFnZXMtPnNnbCk7CiAKIAkJX19pOTE1X2dlbV9vYmplY3Rfc2V0
X3BhZ2VzKG9iaiwgcGFnZXMsIHNnX3BhZ2Vfc2l6ZXMpOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fdXNlcnB0ci5jCmluZGV4IGE2NTdiOTllYzc2MC4uNjAyZjBlZDk4
M2VjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNlcnB0
ci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV91c2VycHRyLmMKQEAg
LTE3Myw3ICsxNzMsNyBAQCBzdGF0aWMgaW50IGk5MTVfZ2VtX3VzZXJwdHJfZ2V0X3BhZ2VzKHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJCWdvdG8gZXJyOwogCX0KIAotCXNnX3Bh
Z2Vfc2l6ZXMgPSBpOTE1X3NnX3BhZ2Vfc2l6ZXMoc3QtPnNnbCk7CisJc2dfcGFnZV9zaXplcyA9
IGk5MTVfc2dfZG1hX3NpemVzKHN0LT5zZ2wpOwogCiAJX19pOTE1X2dlbV9vYmplY3Rfc2V0X3Bh
Z2VzKG9iaiwgc3QsIHNnX3BhZ2Vfc2l6ZXMpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3NjYXR0ZXJsaXN0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Nj
YXR0ZXJsaXN0LmgKaW5kZXggOWNiMjZhMjI0MDM0Li5iOTZiYWFkNjZhM2EgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc2NhdHRlcmxpc3QuaAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3NjYXR0ZXJsaXN0LmgKQEAgLTEwMSwxNSArMTAxLDIzIEBAIHN0YXRp
YyBpbmxpbmUgc3RydWN0IHNjYXR0ZXJsaXN0ICpfX3NnX25leHQoc3RydWN0IHNjYXR0ZXJsaXN0
ICpzZykKIAkgICAgICgoKF9faXRlcikuY3VyciArPSBQQUdFX1NJWkUpID49IChfX2l0ZXIpLm1h
eCkgPwkJXAogCSAgICAgKF9faXRlcikgPSBfX3NndF9pdGVyKF9fc2dfbmV4dCgoX19pdGVyKS5z
Z3ApLCBmYWxzZSksIDAgOiAwKQogCi1zdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBpOTE1X3Nn
X3BhZ2Vfc2l6ZXMoc3RydWN0IHNjYXR0ZXJsaXN0ICpzZykKKy8qKgorICogaTkxNV9zZ19kbWFf
c2l6ZXMgLSBSZWNvcmQgdGhlIGRtYSBzZWdtZW50IHNpemVzIG9mIGEgc2NhdHRlcmxpc3QKKyAq
IEBzZzogVGhlIHNjYXR0ZXJsaXN0CisgKgorICogUmV0dXJuOiBBbiB1bnNpZ25lZCBpbnQgd2l0
aCBzZWdtZW50IHNpemVzIGxvZ2ljYWxseSBvcidlZCB0b2dldGhlci4KKyAqIEEgY2FsbGVyIGNh
biB1c2UgdGhpcyBpbmZvcm1hdGlvbiB0byBkZXRlcm1pbmUgd2hhdCBoYXJkd2FyZSBwYWdlIHRh
YmxlCisgKiBlbnRyeSBzaXplcyBjYW4gYmUgdXNlZCB0byBtYXAgdGhlIG1lbW9yeSByZXByZXNl
bnRlZCBieSB0aGUgc2NhdHRlcmxpc3QuCisgKi8KK3N0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50
IGk5MTVfc2dfZG1hX3NpemVzKHN0cnVjdCBzY2F0dGVybGlzdCAqc2cpCiB7CiAJdW5zaWduZWQg
aW50IHBhZ2Vfc2l6ZXM7CiAKIAlwYWdlX3NpemVzID0gMDsKLQl3aGlsZSAoc2cpIHsKKwl3aGls
ZSAoc2cgJiYgc2dfZG1hX2xlbihzZykpIHsKIAkJR0VNX0JVR19PTihzZy0+b2Zmc2V0KTsKLQkJ
R0VNX0JVR19PTighSVNfQUxJR05FRChzZy0+bGVuZ3RoLCBQQUdFX1NJWkUpKTsKLQkJcGFnZV9z
aXplcyB8PSBzZy0+bGVuZ3RoOworCQlHRU1fQlVHX09OKCFJU19BTElHTkVEKHNnX2RtYV9sZW4o
c2cpLCBQQUdFX1NJWkUpKTsKKwkJcGFnZV9zaXplcyB8PSBzZ19kbWFfbGVuKHNnKTsKIAkJc2cg
PSBfX3NnX25leHQoc2cpOwogCX0KIAotLSAKMi4zMS4xCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdm
eEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9pbnRlbC1nZngK

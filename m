Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id DC06B1A27CC
	for <lists+intel-gfx@lfdr.de>; Wed,  8 Apr 2020 19:15:09 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9CA256EAA2;
	Wed,  8 Apr 2020 17:15:06 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 37D766EAA0;
 Wed,  8 Apr 2020 17:15:05 +0000 (UTC)
IronPort-SDR: P/iu0Ssak+slBDM6B8WckWw0M/jwpvv+7iy2xA21JvVaz5rR+IFnLTGI67DWTMG29WkwPOCtrm
 7dJv4TAN9rgw==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by fmsmga105.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 08 Apr 2020 10:15:04 -0700
IronPort-SDR: wF8ZITA7qBBs9LsrZQrgCPwnlb0Pdsg4THwSgZ+y3KQE86j/pN3YV7o9cKP2ELfuXbr9x+Uk42
 24vJeqzaQ7sQ==
X-IronPort-AV: E=Sophos;i="5.72,359,1580803200"; d="scan'208";a="398265520"
Received: from jkrzyszt-desk.ger.corp.intel.com (HELO
 jkrzyszt-desk.igk.intel.com) ([172.22.244.18])
 by orsmga004-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 08 Apr 2020 10:15:02 -0700
From: Janusz Krzysztofik <janusz.krzysztofik@linux.intel.com>
To: igt-dev@lists.freedesktop.org
Date: Wed,  8 Apr 2020 19:13:44 +0200
Message-Id: <20200408171344.9643-1-janusz.krzysztofik@linux.intel.com>
X-Mailer: git-send-email 2.21.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t v12] tests: Add a test for device hot
 unplug
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Janusz Krzysztofik <janusz.krzysztofik@intel.com>,
 intel-gfx@lists.freedesktop.org, Chris Wilson <chris@chris-wilson.co.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogSmFudXN6IEtyenlzenRvZmlrIDxqYW51c3oua3J6eXN6dG9maWtAaW50ZWwuY29tPgoK
VGhlcmUgaXMgYSB0ZXN0IHdoaWNoIHZlcmlmaWVzIHVubG9hZGluZyBvZiBpOTE1IGRyaXZlciBt
b2R1bGUgYnV0IG5vCnRlc3QgZXhpc3RzIHRoYXQgY2hlY2tzIGhvdyBhIGRyaXZlciBiZWhhdmVz
IHdoZW4gaXQgZ2V0cyB1bmJvdW5kIGZyb20KYSBkZXZpY2Ugb3Igd2hlbiB0aGUgZGV2aWNlIGdl
dHMgdW5wbHVnZ2VkLiAgSW1wbGVtZW50IHN1Y2ggdGVzdCB1c2luZwpzeXNmcyBpbnRlcmZhY2Uu
CgpUd28gbWluaW1hbGlzdGljIHN1YnRlc3RzIC0gInVuYmluZC1yZWJpbmQiIGFuZCAidW5wbHVn
LXJlc2NhbiIgLQpwZXJmb3JtIHRoZSBuYW1lZCBvcGVyYXRpb25zIG9uIGEgRFJNIGRldmljZSB3
aGljaCBpcyBiZWxlaXZlZCB0byBiZQpub3QgaW4gdXNlLiAgQW5vdGhlciBwYWlyIG9mIHN1YnRl
c3RzIG5hbWVkICJob3R1bmJpbmQtbGF0ZWNsb3NlIiBhbmQKaG90dW5wbHVnLWxhdGVjbG9zZSIg
ZG8gdGhlIHNhbWUgb24gYSBEUk0gZGV2aWNlIHdoaWxlIGtlZXBpbmcgaXRzIGZpbGUKZGVzY3Jp
cHRvciBvcGVuIGFuZCBjbG9zZSBpdCB0aGVyZWFmdGVyLgoKdjI6IFJ1biBhIHN1YnByb2Nlc3Mg
d2l0aCBkdW1teV9sb2FkIGluc3RlYWQgb2YgZXh0ZXJuYWwgY29tbWFuZAogICAgKEFudG9uaW8p
Lgp2MzogUnVuIGR1bW15X2xvYWQgZnJvbSB0aGUgdGVzdCBwcm9jZXNzIGRpcmVjdGx5IChBbnRv
bmlvKS4KdjQ6IFJ1biBkdW1teV9sb2FkIGZyb20gaW5zaWRlIHN1YnRlc3RzIChBbnRvbmlvKS4K
djU6IFRyeSB0byByZXN0b3JlIHRoZSBkZXZpY2UgdG8gYSB3b3JraW5nIHN0YXRlIGFmdGVyIGVh
Y2ggc3VidGVzdAogICAgKFBldHJpLCBEYW5pZWwpLgp2NjogUnVuIHdvcmtsb2FkIGluc2lkZSBh
biBpZ3QgaGVscGVyIHN1YnByb2Nlc3Mgc28gcmVzb3VyY2VzIGNvbnN1bWVkCiAgICBieSB0aGUg
d29ya2xvYWQgYXJlIGNsZWFuZWQgdXAgYXV0b21hdGljYWxseSBvbiB3b3JrbG9hZCBzdWJwcm9j
ZXNzCiAgICBjcmFzaCwgd2l0aG91dCBhZmZlY3RpbmcgdGVzdCByZXN1bHRzLAogIC0gbW92ZSB0
aGUgaWd0IGhlbHBlciB3aXRoIHdvcmtsb2FkIGJhY2sgZnJvbSBzdWJ0ZXN0cyB0byBpbml0aWFs
CiAgICBmaXh0dXJlIHNvIHdvcmtsb2FkIGNyYXNoIGFsc28gZG9lcyBub3QgYWZmZWN0IHRlc3Qg
cmVzdWx0cywKICAtIG90aGVyIGNsZWFudXBzIHN1Z2dlc3RlZCBieSBLYXRhcnp5bmEgYW5kIENo
cmlzLgp2NzogTm8gY2hhbmdlcy4Kdjg6IE1vdmUgd29ya2xvYWQgZnVuY3Rpb25zIGJhY2sgZnJv
bSBmaXh0dXJlIHRvIHN1YnRlc3RzLAogIC0gcmVnaXN0ZXIgZGlmZmVyZW50IGFjdGlvbnMgYW5k
IGRpZmZlcmVudCB3b3JrbG9hZHMgaW4gcmVzcGVjdGl2ZQogICAgdGFibGVzIGFuZCBpdGVyYXRl
IG92ZXIgdGhvc2UgdGFibGVzIHdoaWxlIGVudW1lcmF0aW5nIHN1YnRlc3RzLAogIC0gaW50cm9k
dWNlIG5ldyBzdWJ0ZXN0IGZsYXZvcnMgYnkgc2ltcGx5IG9taXRpbmcgbW9kdWxlIHVubG9hZCBz
dGVwLAogIC0gaW5zdGVhZCBvZiBzaW1wbHkgcmVxdWVzdGluZyBidXMgcmVzY2FuIG9yIG5vdCwg
aW50cm9kdWNlIGFjdGlvbgogICAgc3BlY2lmaWMgZGV2aWNlIHJlY292ZXJ5IGhlbHBlcnMsIHJl
cXVpcmVkIHNwZWNpZmljYWxseSB3aXRoIHRob3NlCiAgICBuZXcgc3VidGVzdHMgbm90IHRvdWNo
aW5nIHRoZSBtb2R1bGUsCiAgLSBzcGxpdCB3b3JrbG9hZCBmdW5jdGlvbnMgaW4gdHdvIHBhcnRz
LCBvbmUgc3Bhd25pbmcgdGhlIHdvcmtsb2FkLAogICAgdGhlIG90aGVyIHdhaXRpbmcgZm9yIGl0
cyBjb21wbGV0aW9uLAogIC0gZm9yIHRoZSBuZXcgc3VidGVzdHMgbm90IHJlcXVpcmluZyBtb2R1
bGUgdW5sb2FkLCBydW4gd29ya2xvYWQKICAgIGZ1bmN0aW9ucyBkaXJlY3RseSBmcm9tIHRoZSB0
ZXN0IHByb2Nlc3MgYW5kIHVzZSBuZXcgd29ya2xvYWQKICAgIGNvbXBsZXRpb24gd2FpdCBmdW5j
dGlvbnMgaW4gcGxhY2Ugb2Ygc3VicHJvY2VzcyBjb21wbGV0aW9uIHdhaXQsCiAgLSB0YWtlIG1v
cmUgY29udHJvbCBvdmVyIGxvZ2dpbmcsIGxvbmdqdW1wcyBhbmQgZXhpdCBjb2RlcyBpbgogICAg
d29ya2xvYWQgc3VicHJvY2Vzc2VzLAogIC0gYWRkIHNvbWUgZGVidWcgbWVzc2FnZXMgZm9yIGVh
c3kgcHJvZ3Jlc3Mgd2F0Y2hpbmcsCiAgLSBtb3ZlIGZ1bmN0aW9uIEFQSSBkZXNjcmlwdGlvbnMg
b24gdG9wIG9mIHJlc3BlY3RpdmUgdHlwZWRlZnMuCnY5OiBBbGwgY2hhbmdlcyBhZnRlciBEYW5p
ZWwncyBjb21tZW50cyAtIHRoYW5rcyEKICAtIGZsYXR0ZW4gdGhlIGNvZGUsIGRvbid0IHRyeSB0
byBjcmVhdGUgYSBtaWRsYXllciAoRGFuaWVsKSwKICAtIHByb3ZpZGUgbWltaW1hbCBzdWJ0ZXN0
cyB0aGF0IGV2ZW4gZG9uJ3Qga2VlcCBkZXZpY2Ugb3BlbiAoRGFuaWVsKSwKICAtIGRvbid0IHVz
ZSBkcml2ZXIgdW5iaW5kIGluIG1vcmUgYWR2YW5jZWQgc3VidGVzdHMgKERhbmllbCksCiAgLSBw
cm92aWRlIHN1YnRlc3RzIHdpdGggZGlmZmVyZW50IGxldmVsIG9mIHJlc291cmNlcyBhbGxvY2F0
ZWQKICAgIGR1cmluZyBkZXZpY2UgdW5wbHVnIChEYW5pZWwpLAogIC0gcHJvdmlkZSBzdWJ0ZXN0
cyB3aGljaCBjaGVjayBkcml2ZXIgYmVoYXZpb3IgYWZ0ZXIgZGV2aWNlIGhvdAogICAgdW5wbHVn
IChEYW5pZWwpLgp2MTAgUmVuYW1lIHZhcmlhYmxlcyBhbmQgZnVuY3Rpb24gYXJndW1lbnRzIHRv
IHNvbWV0aGluZyB0aGF0CiAgICBpbmRpY2F0ZXMgdGhleSdyZSBmaWxlIGRlc2NyaXB0b3JzIChE
YW5pZWwpLAogIC0gaW50cm9kdWNlIGEgZGF0YSBzdHJ1Y3R1cmUgdGhhdCBjb250YWlucyB2YXJp
b3VzIGZpbGUgZGVzY3JpcHRvcnMKICAgIGFuZCBhIGhlbHBlciBmdW5jdGlvbiB0byBzZXQgdGhl
bSBhbGwgKERhbmllbCksCiAgLSBmaXggc3RyYW5nZSBpbmRlbnRhdGlvbiAoRGFuaWVsKSwKICAt
IGxpbWl0IHNjb3BlIHRvIGZpcnN0IHRocmVlIHN1YnRlc3RzIGFzIHRoZSBpbml0aWFsIHNldCBv
ZiB0ZXN0cyB0bwogICAgbWVyZ2UgKERhbmllbCkuCnYxMSBGaXggdHlwb3MgaW4gc29tZSBjb21t
ZW50cywKICAtIHVzZSBTUERYIGxpY2Vuc2UgaWRlbnRpZmllciwKICAtIGluY2x1ZGUgYSBwZXIt
cGF0Y2ggY2hhbmdlbG9nIGluIHRoZSBjb21taXQgbWVzc2FnZSAoRGFuaWVsKS4KdjEyIFdlIGRv
bid0IHVzZSBTUERYIGxpY2Vuc2UgaWRlbnRpZmllcnMgbm9yIEdQTC0yLjAgaW4gSUdUIChQZXRy
aSksCiAgLSBhdm9pZCBjaGlwc2V0LCBtYWtlIHN1cmUgd2UgcmVvcGVuIHRoZSBzYW1lIGRldmlj
ZSAoQ2hyaXMpLAogIC0gcmVuYW1lIHN1YnRlc3QgImRybV9vcGVuLWhvdHVucGx1ZyIgdG8gImhv
dHVucGx1Zy1sYXRlY2xvc2UiLAogIC0gYWRkIHN1YnRlc3QgImhvdHVuYmluZC1sYXRlY2xvc2Ui
IChsZXNzIGFmZmVjdGVkIGJ5IElPTU1VIGlzc3VlcyksCiAgLSBtb3ZlIHNvbWUgcmVkdW5kYW50
IGNvZGUgdG8gaGVscGVycywKICAtIHJlb3JkZXIgc29tZSBoZWxwZXJzLAogIC0gcmV3b3JkIHNv
bWUgbWVzc2FnZXMgYW5kIGNvbW1lbnRzLAogIC0gY2xlYW4gdXAgaGVhZGVycy4KCkNjOiBBbnRv
bmlvIEFyZ2Vuemlhbm8gPGFudG9uaW8uYXJnZW56aWFub0BpbnRlbC5jb20+CkNjOiBQZXRyaSBM
YXR2YWxhIDxwZXRyaS5sYXR2YWxhQGludGVsLmNvbT4KQ2M6IERhbmllbCBWZXR0ZXIgPGRhbmll
bEBmZndsbC5jaD4KQ2M6IEthdGFyenluYSBEZWMgPGthdGFyenluYS5kZWNAaW50ZWwuY29tPgpD
YzogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+ClNpZ25lZC1vZmYtYnk6
IEphbnVzeiBLcnp5c3p0b2ZpayA8amFudXN6LmtyenlzenRvZmlrQGludGVsLmNvbT4KLS0tCiB0
ZXN0cy9NYWtlZmlsZS5zb3VyY2VzIHwgICAxICsKIHRlc3RzL2NvcmVfaG90dW5wbHVnLmMgfCAy
NzYgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIHRlc3RzL21lc29u
LmJ1aWxkICAgICAgfCAgIDEgKwogMyBmaWxlcyBjaGFuZ2VkLCAyNzggaW5zZXJ0aW9ucygrKQog
Y3JlYXRlIG1vZGUgMTAwNjQ0IHRlc3RzL2NvcmVfaG90dW5wbHVnLmMKCmRpZmYgLS1naXQgYS90
ZXN0cy9NYWtlZmlsZS5zb3VyY2VzIGIvdGVzdHMvTWFrZWZpbGUuc291cmNlcwppbmRleCA0ZTQ0
Yzk4YzIuLjMyY2JiZjRmOSAxMDA2NDQKLS0tIGEvdGVzdHMvTWFrZWZpbGUuc291cmNlcworKysg
Yi90ZXN0cy9NYWtlZmlsZS5zb3VyY2VzCkBAIC0xOCw2ICsxOCw3IEBAIFRFU1RTX3Byb2dzID0g
XAogCWNvcmVfZ2V0Y2xpZW50IFwKIAljb3JlX2dldHN0YXRzIFwKIAljb3JlX2dldHZlcnNpb24g
XAorCWNvcmVfaG90dW5wbHVnIFwKIAljb3JlX3NldG1hc3RlciBcCiAJY29yZV9zZXRtYXN0ZXJf
dnNfYXV0aCBcCiAJZGVidWdmc190ZXN0IFwKZGlmZiAtLWdpdCBhL3Rlc3RzL2NvcmVfaG90dW5w
bHVnLmMgYi90ZXN0cy9jb3JlX2hvdHVucGx1Zy5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4
IDAwMDAwMDAwMC4uNjRmYjY2MDA1Ci0tLSAvZGV2L251bGwKKysrIGIvdGVzdHMvY29yZV9ob3R1
bnBsdWcuYwpAQCAtMCwwICsxLDI3NiBAQAorLyoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVs
IENvcnBvcmF0aW9uCisgKgorICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBv
ZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkgb2YgdGhpcyBzb2Z0
d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiks
CisgKiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRp
bmcgd2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5
LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAqIGFuZC9vciBzZWxs
IGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRo
ZQorICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xs
b3dpbmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQg
dGhpcyBwZXJtaXNzaW9uIG5vdGljZSAoaW5jbHVkaW5nIHRoZSBuZXh0CisgKiBwYXJhZ3JhcGgp
IHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMg
b2YgdGhlCisgKiBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFT
IElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1QTElF
RCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFO
VEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5G
UklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdI
VCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCisgKiBM
SUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVS
V0lTRSwgQVJJU0lORworICogRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUg
U09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUworICogSU4gVEhFIFNPRlRXQVJF
LgorICovCisKKyNpbmNsdWRlIDxmY250bC5oPgorI2luY2x1ZGUgPGxpbWl0cy5oPgorI2luY2x1
ZGUgPHN0ZGxpYi5oPgorI2luY2x1ZGUgPHN0cmluZy5oPgorI2luY2x1ZGUgPHN5cy9zdGF0Lmg+
CisjaW5jbHVkZSA8c3lzL3R5cGVzLmg+CisjaW5jbHVkZSA8dW5pc3RkLmg+CisKKyNpbmNsdWRl
ICJpZ3QuaCIKKyNpbmNsdWRlICJpZ3RfZGV2aWNlX3NjYW4uaCIKKyNpbmNsdWRlICJpZ3Rfc3lz
ZnMuaCIKKworc3RydWN0IGhvdHVucGx1ZyB7CisJc3RydWN0IHsKKwkJaW50IGRybTsKKwkJaW50
IHN5c2ZzX2RldjsKKwkJaW50IHN5c2ZzX2J1czsKKwkJaW50IHN5c2ZzX2RydjsKKwl9IGZkOwor
CWNoYXIgKmRldl9idXNfYWRkcjsKK307CisKKy8qIEhlbHBlcnMgKi8KKworc3RhdGljIHZvaWQg
cHJlcGFyZV9mb3JfdW5iaW5kKHN0cnVjdCBob3R1bnBsdWcgKnByaXYsIGNoYXIgKmJ1ZiwgaW50
IGJ1ZmxlbikKK3sKKwlpbnQgbGVuOworCisJaWd0X2Fzc2VydChidWZsZW4pOworCisJcHJpdi0+
ZmQuc3lzZnNfZHJ2ID0gb3BlbmF0KHByaXYtPmZkLnN5c2ZzX2RldiwgImRldmljZS9kcml2ZXIi
LAorCQkJCSAgICBPX0RJUkVDVE9SWSk7CisJaWd0X2Fzc2VydChwcml2LT5mZC5zeXNmc19kcnYg
Pj0gMCk7CisKKwlsZW4gPSByZWFkbGlua2F0KHByaXYtPmZkLnN5c2ZzX2RldiwgImRldmljZSIs
IGJ1ZiwgYnVmbGVuIC0gMSk7CisJYnVmW2xlbl0gPSAnXDAnOworCXByaXYtPmRldl9idXNfYWRk
ciA9IHN0cnJjaHIoYnVmLCAnLycpOworCWlndF9hc3NlcnQocHJpdi0+ZGV2X2J1c19hZGRyKysp
OworCisJLyogc3lzZnNfZGV2IG5vIGxvbmdlciBuZWVkZWQgKi8KKwljbG9zZShwcml2LT5mZC5z
eXNmc19kZXYpOworfQorCitzdGF0aWMgdm9pZCBwcmVwYXJlKHN0cnVjdCBob3R1bnBsdWcgKnBy
aXYsIGNoYXIgKmJ1ZiwgaW50IGJ1ZmxlbikKK3sKKwlpZ3RfZGVidWcoIm9wZW5pbmcgZGV2aWNl
XG4iKTsKKwlwcml2LT5mZC5kcm0gPSBfX2RybV9vcGVuX2RyaXZlcihEUklWRVJfQU5ZKTsKKwlp
Z3RfYXNzZXJ0KHByaXYtPmZkLmRybSA+PSAwKTsKKworCXByaXYtPmZkLnN5c2ZzX2RldiA9IGln
dF9zeXNmc19vcGVuKHByaXYtPmZkLmRybSk7CisJaWd0X2Fzc2VydChwcml2LT5mZC5zeXNmc19k
ZXYgPj0gMCk7CisKKwlpZiAoYnVmKSB7CisJCXByZXBhcmVfZm9yX3VuYmluZChwcml2LCBidWYs
IGJ1Zmxlbik7CisJfSBlbHNlIHsKKwkJLyogcHJlcGFyZSBmb3IgYnVzIHJlc2NhbiAqLworCQlw
cml2LT5mZC5zeXNmc19idXMgPSBvcGVuYXQocHJpdi0+ZmQuc3lzZnNfZGV2LAorCQkJCQkgICAg
ImRldmljZS9zdWJzeXN0ZW0iLCBPX0RJUkVDVE9SWSk7CisJCWlndF9hc3NlcnQocHJpdi0+ZmQu
c3lzZnNfYnVzID49IDApOworCX0KK30KKworLyogVW5iaW5kIHRoZSBkcml2ZXIgZnJvbSB0aGUg
ZGV2aWNlICovCitzdGF0aWMgdm9pZCBkcml2ZXJfdW5iaW5kKGludCBmZF9zeXNmc19kcnYsIGNv
bnN0IGNoYXIgKmRldl9idXNfYWRkcikKK3sKKwlpZ3Rfc2V0X3RpbWVvdXQoNjAsICJEcml2ZXIg
dW5iaW5kIHRpbWVvdXQhIik7CisJaWd0X3N5c2ZzX3NldChmZF9zeXNmc19kcnYsICJ1bmJpbmQi
LCBkZXZfYnVzX2FkZHIpOworCWlndF9yZXNldF90aW1lb3V0KCk7CisKKwkvKiBkb24ndCBjbG9z
ZSBmZF9zeXNmc19kcnYsIGl0IHdpbGwgYmUgdXNlZCBmb3IgZHJpdmVyIHJlYmluZGluZyAqLwor
fQorCisvKiBSZS1iaW5kIHRoZSBkcml2ZXIgdG8gdGhlIGRldmljZSAqLworc3RhdGljIHZvaWQg
ZHJpdmVyX2JpbmQoaW50IGZkX3N5c2ZzX2RydiwgY29uc3QgY2hhciAqZGV2X2J1c19hZGRyKQor
eworCWlndF9zZXRfdGltZW91dCg2MCwgIkRyaXZlciByZS1iaW5kIHRpbWVvdXQhIik7CisJaWd0
X3N5c2ZzX3NldChmZF9zeXNmc19kcnYsICJiaW5kIiwgZGV2X2J1c19hZGRyKTsKKwlpZ3RfcmVz
ZXRfdGltZW91dCgpOworCisJY2xvc2UoZmRfc3lzZnNfZHJ2KTsKK30KKworLyogUmVtb3ZlICh2
aXJ0dWFsbHkgdW5wbHVnKSB0aGUgZGV2aWNlIGZyb20gaXRzIGJ1cyAqLworc3RhdGljIHZvaWQg
ZGV2aWNlX3VucGx1ZyhpbnQgZmRfc3lzZnNfZGV2KQoreworCWlndF9zZXRfdGltZW91dCg2MCwg
IkRldmljZSB1bnBsdWcgdGltZW91dCEiKTsKKwlpZ3Rfc3lzZnNfc2V0KGZkX3N5c2ZzX2Rldiwg
ImRldmljZS9yZW1vdmUiLCAiMSIpOworCWlndF9yZXNldF90aW1lb3V0KCk7CisKKwljbG9zZShm
ZF9zeXNmc19kZXYpOworfQorCisvKiBSZS1kaXNjb3ZlciB0aGUgZGV2aWNlIGJ5IHJlc2Nhbm5p
bmcgaXRzIGJ1cyAqLworc3RhdGljIHZvaWQgYnVzX3Jlc2NhbihpbnQgZmRfc3lzZnNfYnVzKQor
eworCWlndF9zZXRfdGltZW91dCg2MCwgIkJ1cyByZXNjYW4gdGltZW91dCEiKTsKKwlpZ3Rfc3lz
ZnNfc2V0KGZkX3N5c2ZzX2J1cywgInJlc2NhbiIsICIxIik7CisJaWd0X3Jlc2V0X3RpbWVvdXQo
KTsKKworCWNsb3NlKGZkX3N5c2ZzX2J1cyk7Cit9CisKK3N0YXRpYyB2b2lkIHNldF9maWx0ZXJf
ZnJvbV9kZXZpY2UoaW50IGZkKQoreworCWNvbnN0IGNoYXIgKmZpbHRlcl90eXBlID0gInN5czoi
OworCWNoYXIgZmlsdGVyW3N0cmxlbihmaWx0ZXJfdHlwZSkgKyBQQVRIX01BWCArIDFdOworCWNo
YXIgKmRzdCA9IHN0cGNweShmaWx0ZXIsIGZpbHRlcl90eXBlKTsKKwljaGFyIHBhdGhbUEFUSF9N
QVggKyAxXTsKKworCWlndF9hc3NlcnQoaWd0X3N5c2ZzX3BhdGgoZmQsIHBhdGgsIFBBVEhfTUFY
KSk7CisJc3RybmNhdChwYXRoLCAiL2RldmljZSIsIFBBVEhfTUFYIC0gc3RybGVuKHBhdGgpKTsK
KwlpZ3RfYXNzZXJ0KHJlYWxwYXRoKHBhdGgsIGRzdCkpOworCisJaWd0X2RldmljZV9maWx0ZXJf
c2V0KGZpbHRlcik7Cit9CisKKy8qIFN1YnRlc3RzICovCisKK3N0YXRpYyB2b2lkIHVuYmluZF9y
ZWJpbmQodm9pZCkKK3sKKwlzdHJ1Y3QgaG90dW5wbHVnIHByaXY7CisJY2hhciBidWZbUEFUSF9N
QVhdOworCisJcHJlcGFyZSgmcHJpdiwgYnVmLCBzaXplb2YoYnVmKSk7CisKKwlpZ3RfZGVidWco
ImNsb3NpbmcgdGhlIGRldmljZVxuIik7CisJY2xvc2UocHJpdi5mZC5kcm0pOworCisJaWd0X2Rl
YnVnKCJ1bmJpbmRpbmcgdGhlIGRyaXZlciBmcm9tIHRoZSBkZXZpY2VcbiIpOworCWRyaXZlcl91
bmJpbmQocHJpdi5mZC5zeXNmc19kcnYsIHByaXYuZGV2X2J1c19hZGRyKTsKKworCWlndF9kZWJ1
ZygicmViaW5kaW5nIHRoZSBkcml2ZXIgdG8gdGhlIGRldmljZVxuIik7CisJZHJpdmVyX2JpbmQo
cHJpdi5mZC5zeXNmc19kcnYsIHByaXYuZGV2X2J1c19hZGRyKTsKKworCS8qIGRldmljZSBuYW1l
IG1heSBoYXZlIGNoYW5nZWQsIHJlYnVpbGQgSUdUIGRldmljZSBsaXN0ICovCisJaWd0X2Rldmlj
ZXNfc2Nhbih0cnVlKTsKKworCWlndF9kZWJ1ZygicmVvcGVuaW5nIHRoZSBkZXZpY2VcbiIpOwor
CXByaXYuZmQuZHJtID0gX19kcm1fb3Blbl9kcml2ZXIoRFJJVkVSX0FOWSk7CisJaWd0X2Fzc2Vy
dChwcml2LmZkLmRybSA+PSAwKTsKKworCWNsb3NlKHByaXYuZmQuZHJtKTsKK30KKworc3RhdGlj
IHZvaWQgdW5wbHVnX3Jlc2Nhbih2b2lkKQoreworCXN0cnVjdCBob3R1bnBsdWcgcHJpdjsKKwor
CXByZXBhcmUoJnByaXYsIE5VTEwsIDApOworCisJaWd0X2RlYnVnKCJjbG9zaW5nIHRoZSBkZXZp
Y2VcbiIpOworCWNsb3NlKHByaXYuZmQuZHJtKTsKKworCWlndF9kZWJ1ZygidW5wbHVnZ2luZyB0
aGUgZGV2aWNlXG4iKTsKKwlkZXZpY2VfdW5wbHVnKHByaXYuZmQuc3lzZnNfZGV2KTsKKworCWln
dF9kZWJ1ZygicmVjb3ZlcmluZyB0aGUgZGV2aWNlXG4iKTsKKwlidXNfcmVzY2FuKHByaXYuZmQu
c3lzZnNfYnVzKTsKKworCS8qIGRldmljZSBuYW1lIG1heSBoYXZlIGNoYW5nZWQsIHJlYnVpbGQg
SUdUIGRldmljZSBsaXN0ICovCisJaWd0X2RldmljZXNfc2Nhbih0cnVlKTsKKworCWlndF9kZWJ1
ZygicmVvcGVuaW5nIHRoZSBkZXZpY2VcbiIpOworCXByaXYuZmQuZHJtID0gX19kcm1fb3Blbl9k
cml2ZXIoRFJJVkVSX0FOWSk7CisJaWd0X2Fzc2VydChwcml2LmZkLmRybSA+PSAwKTsKKworCWNs
b3NlKHByaXYuZmQuZHJtKTsKK30KKworc3RhdGljIHZvaWQgaG90dW5iaW5kX2xhdGVjbG9zZSh2
b2lkKQoreworCXN0cnVjdCBob3R1bnBsdWcgcHJpdjsKKwljaGFyIGJ1ZltQQVRIX01BWF07CisK
KwlwcmVwYXJlKCZwcml2LCBidWYsIHNpemVvZihidWYpKTsKKworCWlndF9kZWJ1ZygiaG90IHVu
YmluZGluZyB0aGUgZHJpdmVyIGZyb20gdGhlIGRldmljZVxuIik7CisJZHJpdmVyX3VuYmluZChw
cml2LmZkLnN5c2ZzX2RydiwgcHJpdi5kZXZfYnVzX2FkZHIpOworCisJaWd0X2RlYnVnKCJyZWJp
bmRpbmcgdGhlIGRyaXZlciB0byB0aGUgZGV2aWNlXG4iKTsKKwlkcml2ZXJfYmluZChwcml2LmZk
LnN5c2ZzX2RydiwgcHJpdi5kZXZfYnVzX2FkZHIpOworCisJaWd0X2RlYnVnKCJsYXRlIGNsb3Np
bmcgdGhlIHVuYm91bmQgZGV2aWNlIGluc3RhbmNlXG4iKTsKKwljbG9zZShwcml2LmZkLmRybSk7
CisKKwkvKiBkZXZpY2UgbmFtZSBoYXMgY2hhbmdlZCwgcmVidWlsZCBJR1QgZGV2aWNlIGxpc3Qg
Ki8KKwlpZ3RfZGV2aWNlc19zY2FuKHRydWUpOworCisJaWd0X2RlYnVnKCJyZW9wZW5pbmcgdGhl
IGRldmljZVxuIik7CisJcHJpdi5mZC5kcm0gPSBfX2RybV9vcGVuX2RyaXZlcihEUklWRVJfQU5Z
KTsKKwlpZ3RfYXNzZXJ0KHByaXYuZmQuZHJtID49IDApOworCisJY2xvc2UocHJpdi5mZC5kcm0p
OworfQorCitzdGF0aWMgdm9pZCBob3R1bnBsdWdfbGF0ZWNsb3NlKHZvaWQpCit7CisJc3RydWN0
IGhvdHVucGx1ZyBwcml2OworCisJcHJlcGFyZSgmcHJpdiwgTlVMTCwgMCk7CisKKwlpZ3RfZGVi
dWcoImhvdCB1bnBsdWdnaW5nIHRoZSBkZXZpY2VcbiIpOworCWRldmljZV91bnBsdWcocHJpdi5m
ZC5zeXNmc19kZXYpOworCisJaWd0X2RlYnVnKCJyZWNvdmVyaW5nIHRoZSBkZXZpY2VcbiIpOwor
CWJ1c19yZXNjYW4ocHJpdi5mZC5zeXNmc19idXMpOworCisJaWd0X2RlYnVnKCJsYXRlIGNsb3Np
bmcgdGhlIHJlbW92ZWQgZGV2aWNlIGluc3RhbmNlXG4iKTsKKwljbG9zZShwcml2LmZkLmRybSk7
CisKKwkvKiBkZXZpY2UgbmFtZSBoYXMgY2hhbmdlZCwgcmVidWlsZCBJR1QgZGV2aWNlIGxpc3Qg
Ki8KKwlpZ3RfZGV2aWNlc19zY2FuKHRydWUpOworCisJaWd0X2RlYnVnKCJyZW9wZW5pbmcgdGhl
IGRldmljZVxuIik7CisJcHJpdi5mZC5kcm0gPSBfX2RybV9vcGVuX2RyaXZlcihEUklWRVJfQU5Z
KTsKKwlpZ3RfYXNzZXJ0KHByaXYuZmQuZHJtID49IDApOworCisJY2xvc2UocHJpdi5mZC5kcm0p
OworfQorCisvKiBNYWluICovCisKK2lndF9tYWluCit7CisJaWd0X2ZpeHR1cmUgeworCQlpbnQg
ZmRfZHJtOworCisJCS8qKgorCQkgKiBBcyBzdWJ0ZXN0cyBtdXN0IGJlIGFibGUgdG8gY2xvc2Ug
ZXhhbWluZWQgZGV2aWNlcworCQkgKiBjb21wbGV0ZWx5LCBkb24ndCB1c2UgZHJtX29wZW5fZHJp
dmVyKCkgYXMgaXQga2VlcHMKKwkJICogYSBkZXZpY2UgZmlsZSBkZXNjcmlwdG9yIG9wZW4gZm9y
IGV4aXQgaGFuZGxlciB1c2UuCisJCSAqLworCQlmZF9kcm0gPSBfX2RybV9vcGVuX2RyaXZlcihE
UklWRVJfQU5ZKTsKKwkJaWd0X2Fzc2VydChmZF9kcm0gPj0gMCk7CisKKwkJLyogTWFrZSBzdXJl
IHN1YnRlc3RzIGFsd2F5cyByZW9wZW4gdGhlIHNhbWUgZGV2aWNlICovCisJCXNldF9maWx0ZXJf
ZnJvbV9kZXZpY2UoZmRfZHJtKTsKKworCQljbG9zZShmZF9kcm0pOworCX0KKworCWlndF9zdWJ0
ZXN0KCJ1bmJpbmQtcmViaW5kIikKKwkJdW5iaW5kX3JlYmluZCgpOworCisJaWd0X3N1YnRlc3Qo
InVucGx1Zy1yZXNjYW4iKQorCQl1bnBsdWdfcmVzY2FuKCk7CisKKwlpZ3Rfc3VidGVzdCgiaG90
dW5iaW5kLWxhdGVjbG9zZSIpCisJCWhvdHVuYmluZF9sYXRlY2xvc2UoKTsKKworCWlndF9zdWJ0
ZXN0KCJob3R1bnBsdWctbGF0ZWNsb3NlIikKKwkJaG90dW5wbHVnX2xhdGVjbG9zZSgpOworfQpk
aWZmIC0tZ2l0IGEvdGVzdHMvbWVzb24uYnVpbGQgYi90ZXN0cy9tZXNvbi5idWlsZAppbmRleCBl
ODgyZjRkY2QuLjBiZGNmYmU0YyAxMDA2NDQKLS0tIGEvdGVzdHMvbWVzb24uYnVpbGQKKysrIGIv
dGVzdHMvbWVzb24uYnVpbGQKQEAgLTMsNiArMyw3IEBAIHRlc3RfcHJvZ3MgPSBbCiAJJ2NvcmVf
Z2V0Y2xpZW50JywKIAknY29yZV9nZXRzdGF0cycsCiAJJ2NvcmVfZ2V0dmVyc2lvbicsCisJJ2Nv
cmVfaG90dW5wbHVnJywKIAknY29yZV9zZXRtYXN0ZXInLAogCSdjb3JlX3NldG1hc3Rlcl92c19h
dXRoJywKIAknZGVidWdmc190ZXN0JywKLS0gCjIuMjEuMQoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1n
ZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

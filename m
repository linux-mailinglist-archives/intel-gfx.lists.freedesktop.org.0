Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7EF3CA8697
	for <lists+intel-gfx@lfdr.de>; Wed,  4 Sep 2019 18:27:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BE63389C0A;
	Wed,  4 Sep 2019 16:27:02 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 001C189C0A
 for <intel-gfx@lists.freedesktop.org>; Wed,  4 Sep 2019 16:27:00 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 04 Sep 2019 09:27:00 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,467,1559545200"; d="scan'208";a="194788176"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by orsmga002.jf.intel.com with SMTP; 04 Sep 2019 09:26:58 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Wed, 04 Sep 2019 19:26:57 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  4 Sep 2019 19:26:21 +0300
Message-Id: <20190904162625.15048-12-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190904162625.15048-1-ville.syrjala@linux.intel.com>
References: <20190904162625.15048-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 11/15] drm/i915: Pass connector state to pfit
 calculations
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClBh
c3MgdGhlIGVudGlyZSBjb25uZWN0b3Igc3RhdGUgdG8gaW50ZWxfe2dtY2gscGNofV9wYW5lbF9m
aXR0aW5nKCkuCkZvciBub3cgd2UganVzdCBuZWVkIHRvIGdldCBhdCAuc2NhbGluZ19tb2RlIGJ1
dCBpbiB0aGUgZnV0dXJlIHdlJ2xsCndhbnQgYWNjZXNzIHRvIHRoZSBtYXJnaW4gcHJvcGVydGll
cyBhcyB3ZWxsLgoKdjI6IERlYWwgd2l0aCBpbnRlbF9kcF95Y2JjcjQyMF9jb25maWcoKQoKU2ln
bmVkLW9mZi1ieTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNv
bT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ljbF9kc2kuYyAgICAgfCAgMiAr
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jICAgIHwgMTggKysrKysr
KystLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWkuYyAg
fCAxMiArKysrKysrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfbHZk
cy5jICB8ICA3ICsrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFu
ZWwuYyB8IDE4ICsrKysrKysrKysrKy0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9wYW5lbC5oIHwgIDQgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS92
bHZfZHNpLmMgICAgIHwgIDYgKystLS0tCiA3IGZpbGVzIGNoYW5nZWQsIDM0IGluc2VydGlvbnMo
KyksIDMzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaWNsX2RzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pY2xfZHNpLmMK
aW5kZXggNjI3Y2JkODgwMjI0Li5kMjUyZjY4ZTVkMDkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaWNsX2RzaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaWNsX2RzaS5jCkBAIC0xMjcyLDcgKzEyNzIsNyBAQCBzdGF0aWMgaW50IGdlbjExX2Rz
aV9jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAogCXBpcGVf
Y29uZmlnLT5vdXRwdXRfZm9ybWF0ID0gSU5URUxfT1VUUFVUX0ZPUk1BVF9SR0I7CiAJaW50ZWxf
Zml4ZWRfcGFuZWxfbW9kZShmaXhlZF9tb2RlLCBhZGp1c3RlZF9tb2RlKTsKLQlpbnRlbF9wY2hf
cGFuZWxfZml0dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0ZS0+c2NhbGluZ19tb2RlKTsKKwlp
bnRlbF9wY2hfcGFuZWxfZml0dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CiAKIAlhZGp1
c3RlZF9tb2RlLT5mbGFncyA9IDA7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZHAuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZHAuYwppbmRleCBmNmVmM2MyNWMwZWQuLmM4YWYxMWYwM2I1NSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZHAuYwpAQCAtMjExNCw5ICsyMTE0LDEwIEBAIGludGVsX2RwX2Nv
bXB1dGVfbGlua19jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAKIHN0YXRp
YyBpbnQKIGludGVsX2RwX3ljYmNyNDIwX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2Rw
LAotCQkJIHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsCi0JCQkgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCisJCQkgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUsCisJCQkgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3Rh
dGUpCiB7CisJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IGNvbm5fc3RhdGUtPmNv
bm5lY3RvcjsKIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfaW5mbyAqaW5mbyA9ICZjb25uZWN0
b3ItPmRpc3BsYXlfaW5mbzsKIAljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0
ZWRfbW9kZSA9CiAJCSZjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7CkBAIC0yMTI4LDcg
KzIxMjksNyBAQCBpbnRlbF9kcF95Y2JjcjQyMF9jb25maWcoc3RydWN0IGludGVsX2RwICppbnRl
bF9kcCwKIAogCWNydGNfc3RhdGUtPm91dHB1dF9mb3JtYXQgPSBJTlRFTF9PVVRQVVRfRk9STUFU
X1lDQkNSNDIwOwogCi0JaW50ZWxfcGNoX3BhbmVsX2ZpdHRpbmcoY3J0Y19zdGF0ZSwgRFJNX01P
REVfU0NBTEVfRlVMTFNDUkVFTik7CisJaW50ZWxfcGNoX3BhbmVsX2ZpdHRpbmcoY3J0Y19zdGF0
ZSwgY29ubl9zdGF0ZSk7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTIxNjYsNyArMjE2Nyw2IEBAIGlu
dGVsX2RwX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCXN0
cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSBlbmNfdG9faW50ZWxfZHAoJmVuY29kZXItPmJhc2Up
OwogCXN0cnVjdCBpbnRlbF9sc3Bjb24gKmxzcGNvbiA9IGVuY190b19pbnRlbF9sc3Bjb24oJmVu
Y29kZXItPmJhc2UpOwogCWVudW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKLQlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMocGlwZV9jb25maWctPmJhc2Uu
Y3J0Yyk7CiAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxfY29ubmVjdG9yID0gaW50ZWxf
ZHAtPmF0dGFjaGVkX2Nvbm5lY3RvcjsKIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9jb25uZWN0b3Jf
c3RhdGUgKmludGVsX2Nvbm5fc3RhdGUgPQogCQl0b19pbnRlbF9kaWdpdGFsX2Nvbm5lY3Rvcl9z
dGF0ZShjb25uX3N0YXRlKTsKQEAgLTIxODEsOCArMjE4MSw4IEBAIGludGVsX2RwX2NvbXB1dGVf
Y29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCWlmIChsc3Bjb24tPmFjdGl2
ZSkKIAkJbHNwY29uX3ljYmNyNDIwX2NvbmZpZygmaW50ZWxfY29ubmVjdG9yLT5iYXNlLCBwaXBl
X2NvbmZpZyk7CiAJZWxzZQotCQlyZXQgPSBpbnRlbF9kcF95Y2JjcjQyMF9jb25maWcoaW50ZWxf
ZHAsICZpbnRlbF9jb25uZWN0b3ItPmJhc2UsCi0JCQkJCSAgICAgICBwaXBlX2NvbmZpZyk7CisJ
CXJldCA9IGludGVsX2RwX3ljYmNyNDIwX2NvbmZpZyhpbnRlbF9kcCwgcGlwZV9jb25maWcsCisJ
CQkJCSAgICAgICBjb25uX3N0YXRlKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBAIC0y
MTk5LDExICsyMTk5LDkgQEAgaW50ZWxfZHBfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCiAJCQkJICAgICAgIGFkanVzdGVkX21vZGUpOwogCiAJCWlmIChIQVNf
R01DSChkZXZfcHJpdikpCi0JCQlpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmcocGlwZV9jb25maWcs
Ci0JCQkJCQkgY29ubl9zdGF0ZS0+c2NhbGluZ19tb2RlKTsKKwkJCWludGVsX2dtY2hfcGFuZWxf
Zml0dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CiAJCWVsc2UKLQkJCWludGVsX3BjaF9w
YW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLAotCQkJCQkJY29ubl9zdGF0ZS0+c2NhbGluZ19tb2Rl
KTsKKwkJCWludGVsX3BjaF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsK
IAl9CiAKIAlpZiAoYWRqdXN0ZWRfbW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX0RCTFNDQU4p
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWkuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRtaS5jCmluZGV4IGM3NDliMDRi
YTQ3Ny4uMWZhNGYwNzNiMjc0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2hkbWkuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2hkbWkuYwpAQCAtMjI2NCwxNyArMjI2NCwxOSBAQCBzdGF0aWMgYm9vbCBoZG1pX2RlZXBfY29s
b3JfcG9zc2libGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiB9
CiAKIHN0YXRpYyBib29sCi1pbnRlbF9oZG1pX3ljYmNyNDIwX2NvbmZpZyhzdHJ1Y3QgZHJtX2Nv
bm5lY3RvciAqY29ubmVjdG9yLAotCQkJICAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNvbmZp
ZykKK2ludGVsX2hkbWlfeWNiY3I0MjBfY29uZmlnKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAorCQkJICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5f
c3RhdGUpCiB7CisJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9IGNvbm5fc3RhdGUt
PmNvbm5lY3RvcjsKKwogCWlmICghY29ubmVjdG9yLT55Y2Jjcl80MjBfYWxsb3dlZCkgewogCQlE
Uk1fRVJST1IoIlBsYXRmb3JtIGRvZXNuJ3Qgc3VwcG9ydCBZQ0JDUjQyMCBvdXRwdXRcbiIpOwog
CQlyZXR1cm4gZmFsc2U7CiAJfQogCi0JY29uZmlnLT5vdXRwdXRfZm9ybWF0ID0gSU5URUxfT1VU
UFVUX0ZPUk1BVF9ZQ0JDUjQyMDsKKwljcnRjX3N0YXRlLT5vdXRwdXRfZm9ybWF0ID0gSU5URUxf
T1VUUFVUX0ZPUk1BVF9ZQ0JDUjQyMDsKIAotCWludGVsX3BjaF9wYW5lbF9maXR0aW5nKGNvbmZp
ZywgRFJNX01PREVfU0NBTEVfRlVMTFNDUkVFTik7CisJaW50ZWxfcGNoX3BhbmVsX2ZpdHRpbmco
Y3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSk7CiAKIAlyZXR1cm4gdHJ1ZTsKIH0KQEAgLTIzODcsNyAr
MjM4OSw3IEBAIGludCBpbnRlbF9oZG1pX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAogCQlwaXBlX2NvbmZpZy0+cGl4ZWxfbXVsdGlwbGllciA9IDI7CiAKIAlp
ZiAoZHJtX21vZGVfaXNfNDIwX29ubHkoJmNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLCBhZGp1c3Rl
ZF9tb2RlKSkgewotCQlpZiAoIWludGVsX2hkbWlfeWNiY3I0MjBfY29uZmlnKGNvbm5lY3Rvciwg
cGlwZV9jb25maWcpKSB7CisJCWlmICghaW50ZWxfaGRtaV95Y2JjcjQyMF9jb25maWcocGlwZV9j
b25maWcsIGNvbm5fc3RhdGUpKSB7CiAJCQlEUk1fRVJST1IoIkNhbid0IHN1cHBvcnQgWUNCQ1I0
MjAgb3V0cHV0XG4iKTsKIAkJCXJldHVybiAtRUlOVkFMOwogCQl9CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2x2ZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfbHZkcy5jCmluZGV4IGU5ODMwMzVhY2E2My4uYWRjOTU5ZjhmOTVh
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2x2ZHMuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2x2ZHMuYwpAQCAtNDMwLDEy
ICs0MzAsOSBAQCBzdGF0aWMgaW50IGludGVsX2x2ZHNfY29tcHV0ZV9jb25maWcoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCiAJaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYp
KSB7CiAJCXBpcGVfY29uZmlnLT5oYXNfcGNoX2VuY29kZXIgPSB0cnVlOwogCi0JCWludGVsX3Bj
aF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLAotCQkJCQljb25uX3N0YXRlLT5zY2FsaW5nX21v
ZGUpOworCQlpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7
CiAJfSBlbHNlIHsKLQkJaW50ZWxfZ21jaF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLAotCQkJ
CQkgY29ubl9zdGF0ZS0+c2NhbGluZ19tb2RlKTsKLQorCQlpbnRlbF9nbWNoX3BhbmVsX2ZpdHRp
bmcocGlwZV9jb25maWcsIGNvbm5fc3RhdGUpOwogCX0KIAogCS8qCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3BhbmVsLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX3BhbmVsLmMKaW5kZXggNmY0MjcwZWNkZWJkLi4xYTBiNjllYzE3
NzggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3BhbmVsLmMKQEAgLTE3
NSwxMCArMTc1LDExIEBAIGludGVsX3BhbmVsX3ZidF9maXhlZF9tb2RlKHN0cnVjdCBpbnRlbF9j
b25uZWN0b3IgKmNvbm5lY3RvcikKIC8qIGFkanVzdGVkX21vZGUgaGFzIGJlZW4gcHJlc2V0IHRv
IGJlIHRoZSBwYW5lbCdzIGZpeGVkIG1vZGUgKi8KIHZvaWQKIGludGVsX3BjaF9wYW5lbF9maXR0
aW5nKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAotCQkJaW50IGZpdHRpbmdf
bW9kZSkKKwkJCWNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQog
ewogCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KIAkJJmNy
dGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKKwlpbnQgc2NhbGluZ19tb2RlID0gY29ubl9z
dGF0ZS0+c2NhbGluZ19tb2RlOwogCWludCB4LCB5LCB3aWR0aCwgaGVpZ2h0OwogCiAJLyogTmF0
aXZlIG1vZGVzIGRvbid0IG5lZWQgZml0dGluZyAqLwpAQCAtMTg3LDcgKzE4OCw3IEBAIGludGVs
X3BjaF9wYW5lbF9maXR0aW5nKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAog
CSAgICBjcnRjX3N0YXRlLT5vdXRwdXRfZm9ybWF0ICE9IElOVEVMX09VVFBVVF9GT1JNQVRfWUNC
Q1I0MjApCiAJCXJldHVybjsKIAotCXN3aXRjaCAoZml0dGluZ19tb2RlKSB7CisJc3dpdGNoIChz
Y2FsaW5nX21vZGUpIHsKIAljYXNlIERSTV9NT0RFX1NDQUxFX0NFTlRFUjoKIAkJd2lkdGggPSBj
cnRjX3N0YXRlLT5waXBlX3NyY193OwogCQloZWlnaHQgPSBjcnRjX3N0YXRlLT5waXBlX3NyY19o
OwpAQCAtMjI0LDYgKzIyNSwxMCBAQCBpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJfQogCQlicmVhazsKIAorCWNhc2UgRFJNX01P
REVfU0NBTEVfTk9ORToKKwkJV0FSTl9PTihhZGp1c3RlZF9tb2RlLT5jcnRjX2hkaXNwbGF5ICE9
IGNydGNfc3RhdGUtPnBpcGVfc3JjX3cpOworCQlXQVJOX09OKGFkanVzdGVkX21vZGUtPmNydGNf
dmRpc3BsYXkgIT0gY3J0Y19zdGF0ZS0+cGlwZV9zcmNfaCk7CisJCS8qIGZhbGwgdGhyb3VnaCAq
LwogCWNhc2UgRFJNX01PREVfU0NBTEVfRlVMTFNDUkVFTjoKIAkJeCA9IHkgPSAwOwogCQl3aWR0
aCA9IGFkanVzdGVkX21vZGUtPmNydGNfaGRpc3BsYXk7CkBAIC0yMzEsNyArMjM2LDcgQEAgaW50
ZWxfcGNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUs
CiAJCWJyZWFrOwogCiAJZGVmYXVsdDoKLQkJTUlTU0lOR19DQVNFKGZpdHRpbmdfbW9kZSk7CisJ
CU1JU1NJTkdfQ0FTRShzY2FsaW5nX21vZGUpOwogCQlyZXR1cm47CiAJfQogCkBAIC0zNzYsMTkg
KzM4MSwyMCBAQCBzdGF0aWMgdm9pZCBpOXh4X3NjYWxlX2FzcGVjdChzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIH0KIAogdm9pZCBpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmco
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCi0JCQkgICAgICBpbnQgZml0dGlu
Z19tb2RlKQorCQkJICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5f
c3RhdGUpCiB7CiAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShjcnRjLT5iYXNlLmRldik7CiAJdTMyIHBmaXRfY29udHJvbCA9IDAsIHBmaXRfcGdt
X3JhdGlvcyA9IDAsIGJvcmRlciA9IDA7CiAJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKmFkanVz
dGVkX21vZGUgPSAmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlOworCWludCBzY2FsaW5n
X21vZGUgPSBjb25uX3N0YXRlLT5zY2FsaW5nX21vZGU7CiAKIAkvKiBOYXRpdmUgbW9kZXMgZG9u
J3QgbmVlZCBmaXR0aW5nICovCiAJaWYgKGFkanVzdGVkX21vZGUtPmNydGNfaGRpc3BsYXkgPT0g
Y3J0Y19zdGF0ZS0+cGlwZV9zcmNfdyAmJgogCSAgICBhZGp1c3RlZF9tb2RlLT5jcnRjX3ZkaXNw
bGF5ID09IGNydGNfc3RhdGUtPnBpcGVfc3JjX2gpCiAJCWdvdG8gb3V0OwogCi0Jc3dpdGNoIChm
aXR0aW5nX21vZGUpIHsKKwlzd2l0Y2ggKHNjYWxpbmdfbW9kZSkgewogCWNhc2UgRFJNX01PREVf
U0NBTEVfQ0VOVEVSOgogCQkvKgogCQkgKiBGb3IgY2VudGVyZWQgbW9kZXMsIHdlIGhhdmUgdG8g
Y2FsY3VsYXRlIGJvcmRlciB3aWR0aHMgJgpAQCAtNDI0LDcgKzQzMCw3IEBAIHZvaWQgaW50ZWxf
Z21jaF9wYW5lbF9maXR0aW5nKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAog
CQl9CiAJCWJyZWFrOwogCWRlZmF1bHQ6Ci0JCVdBUk4oMSwgImJhZCBwYW5lbCBmaXQgbW9kZTog
JWRcbiIsIGZpdHRpbmdfbW9kZSk7CisJCU1JU1NJTkdfQ0FTRShzY2FsaW5nX21vZGUpOwogCQly
ZXR1cm47CiAJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX3BhbmVsLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3BhbmVsLmgK
aW5kZXggZTE4MDRlNmU4MzI1Li5lMmZhMTU0M2E2MWYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX3BhbmVsLmgKQEAgLTI2LDkgKzI2LDkgQEAgdm9pZCBpbnRlbF9wYW5l
bF9maW5pKHN0cnVjdCBpbnRlbF9wYW5lbCAqcGFuZWwpOwogdm9pZCBpbnRlbF9maXhlZF9wYW5l
bF9tb2RlKGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpmaXhlZF9tb2RlLAogCQkJICAg
IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlKTsKIHZvaWQgaW50ZWxfcGNo
X3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCi0JCQkg
ICAgIGludCBmaXR0aW5nX21vZGUpOworCQkJICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
cl9zdGF0ZSAqY29ubl9zdGF0ZSk7CiB2b2lkIGludGVsX2dtY2hfcGFuZWxfZml0dGluZyhzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKLQkJCSAgICAgIGludCBmaXR0aW5nX21v
ZGUpOworCQkJICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3Rh
dGUpOwogdm9pZCBpbnRlbF9wYW5lbF9zZXRfYmFja2xpZ2h0X2FjcGkoY29uc3Qgc3RydWN0IGRy
bV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUsCiAJCQkJICAgIHUzMiBsZXZlbCwgdTMyIG1h
eCk7CiBpbnQgaW50ZWxfcGFuZWxfc2V0dXBfYmFja2xpZ2h0KHN0cnVjdCBkcm1fY29ubmVjdG9y
ICpjb25uZWN0b3IsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L3Zs
dl9kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvdmx2X2RzaS5jCmluZGV4IDZh
MjBjNDE2OWE1My4uOWY0ZjdjNjcwY2M4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L3Zsdl9kc2kuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L3Zs
dl9kc2kuYwpAQCAtMjcyLDExICsyNzIsOSBAQCBzdGF0aWMgaW50IGludGVsX2RzaV9jb21wdXRl
X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJaW50ZWxfZml4ZWRfcGFu
ZWxfbW9kZShmaXhlZF9tb2RlLCBhZGp1c3RlZF9tb2RlKTsKIAogCQlpZiAoSEFTX0dNQ0goZGV2
X3ByaXYpKQotCQkJaW50ZWxfZ21jaF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLAotCQkJCQkJ
IGNvbm5fc3RhdGUtPnNjYWxpbmdfbW9kZSk7CisJCQlpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmco
cGlwZV9jb25maWcsIGNvbm5fc3RhdGUpOwogCQllbHNlCi0JCQlpbnRlbF9wY2hfcGFuZWxfZml0
dGluZyhwaXBlX2NvbmZpZywKLQkJCQkJCWNvbm5fc3RhdGUtPnNjYWxpbmdfbW9kZSk7CisJCQlp
bnRlbF9wY2hfcGFuZWxfZml0dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CiAJfQogCiAJ
aWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVfRkxBR19EQkxTQ0FOKQotLSAKMi4y
MS4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRl
bC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

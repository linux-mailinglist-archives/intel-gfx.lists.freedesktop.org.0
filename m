Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 962EA36708C
	for <lists+intel-gfx@lfdr.de>; Wed, 21 Apr 2021 18:49:16 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4B3166E9DF;
	Wed, 21 Apr 2021 16:49:13 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4A45B6E9DA
 for <intel-gfx@lists.freedesktop.org>; Wed, 21 Apr 2021 16:49:12 +0000 (UTC)
IronPort-SDR: Ki7XkRtY7/eJri6AS6tNCpJTp01VRjDPeeqSG2HKNjRb/yLm/UlFcOat7YIXR24HUA3REuRtfc
 Y611YWFAzUpA==
X-IronPort-AV: E=McAfee;i="6200,9189,9961"; a="216376726"
X-IronPort-AV: E=Sophos;i="5.82,240,1613462400"; d="scan'208";a="216376726"
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by fmsmga101.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 21 Apr 2021 09:48:57 -0700
IronPort-SDR: iVfm/F2lnVF93Ae8z9qY3bSnlqGNuiQtgZKX1DP9UnYvvHW5VHNgJ4J5V3amL6mrXvAG0bfmjB
 DHjUYN1TLrvg==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.82,240,1613462400"; d="scan'208";a="391532317"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.171])
 by fmsmga007.fm.intel.com with SMTP; 21 Apr 2021 09:48:55 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Wed, 21 Apr 2021 19:48:55 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 21 Apr 2021 19:48:34 +0300
Message-Id: <20210421164849.12806-3-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.26.3
In-Reply-To: <20210421164849.12806-1-ville.syrjala@linux.intel.com>
References: <20210421164849.12806-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 02/17] drm/i915: Introduce hsw_get_buf_trans()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KCkFs
bCB0aGUgb3RoZXIgcGxhdGZvcm1zIGhhbmRsZSB0aGUgb3V0cHV0X3R5cGUgc3R1ZmYgaW4gdGhl
aXIKKl9nZXRfYnVmX3RyYW5zKCkgZnVuY3Rpb25zLiBEbyB0aGUgc2FtZSBmb3IgaHN3L2Jkdy9z
a2wuCgpTaWduZWQtb2ZmLWJ5OiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXgu
aW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMg
ICAgICB8IDI3ICsrKystLS0tLS0tLQogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpX2J1
Zl90cmFucy5jICAgIHwgNDMgKysrKysrKysrKysrKy0tLS0tLQogLi4uL2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGRpX2J1Zl90cmFucy5oICAgIHwgMTAgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZmRpLmMgICAgICB8ICAyICstCiA0IGZpbGVzIGNoYW5nZWQsIDQz
IGluc2VydGlvbnMoKyksIDM5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2RkaS5jCmluZGV4IGY0MDQ3MmNmY2UxMC4uM2ViZjM1MDNiZGY3IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMKQEAgLTEwMiwxMiArMTAyLDEwIEBA
IHZvaWQgaHN3X3ByZXBhcmVfZHBfZGRpX2J1ZmZlcnMoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCiAJZW51bSBwb3J0IHBvcnQgPSBlbmNvZGVyLT5wb3J0OwogCWNvbnN0IHN0cnVjdCBo
c3dfZGRpX2J1Zl90cmFucyAqZGRpX3RyYW5zbGF0aW9uczsKIAotCWlmIChpbnRlbF9jcnRjX2hh
c190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9BTkFMT0cpKQotCQlkZGlfdHJhbnNsYXRp
b25zID0gaHN3X2RkaV9nZXRfYnVmX3RyYW5zX2ZkaShkZXZfcHJpdiwgJm5fZW50cmllcyk7Ci0J
ZWxzZSBpZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfRURQ
KSkKLQkJZGRpX3RyYW5zbGF0aW9ucyA9IGhzd19kZGlfZ2V0X2J1Zl90cmFuc19lZHAoZW5jb2Rl
ciwgJm5fZW50cmllcyk7Ci0JZWxzZQotCQlkZGlfdHJhbnNsYXRpb25zID0gaHN3X2RkaV9nZXRf
YnVmX3RyYW5zX2RwKGVuY29kZXIsICZuX2VudHJpZXMpOworCWRkaV90cmFuc2xhdGlvbnMgPSBo
c3dfZ2V0X2J1Zl90cmFucyhlbmNvZGVyLCBjcnRjX3N0YXRlLCAmbl9lbnRyaWVzKTsKKworCWlm
IChkcm1fV0FSTl9PTl9PTkNFKCZkZXZfcHJpdi0+ZHJtLCAhZGRpX3RyYW5zbGF0aW9ucykpCisJ
CXJldHVybjsKIAogCS8qIElmIHdlJ3JlIGJvb3N0aW5nIHRoZSBjdXJyZW50LCBzZXQgYml0IDMx
IG9mIHRyYW5zMSAqLwogCWlmIChESVNQTEFZX1ZFUihkZXZfcHJpdikgPT0gOSAmJiAhSVNfQlJP
WFRPTihkZXZfcHJpdikgJiYKQEAgLTEyOCw2ICsxMjYsNyBAQCB2b2lkIGhzd19wcmVwYXJlX2Rw
X2RkaV9idWZmZXJzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogICogSERNSS9EVkkg
dXNlIGNhc2VzLgogICovCiBzdGF0aWMgdm9pZCBoc3dfcHJlcGFyZV9oZG1pX2RkaV9idWZmZXJz
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorCQkJCQkgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkJCSBpbnQgbGV2ZWwpCiB7CiAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7CkBA
IC0xMzYsNyArMTM1LDcgQEAgc3RhdGljIHZvaWQgaHN3X3ByZXBhcmVfaGRtaV9kZGlfYnVmZmVy
cyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAllbnVtIHBvcnQgcG9ydCA9IGVuY29k
ZXItPnBvcnQ7CiAJY29uc3Qgc3RydWN0IGhzd19kZGlfYnVmX3RyYW5zICpkZGlfdHJhbnNsYXRp
b25zOwogCi0JZGRpX3RyYW5zbGF0aW9ucyA9IGhzd19kZGlfZ2V0X2J1Zl90cmFuc19oZG1pKGVu
Y29kZXIsICZuX2VudHJpZXMpOworCWRkaV90cmFuc2xhdGlvbnMgPSBoc3dfZ2V0X2J1Zl90cmFu
cyhlbmNvZGVyLCBjcnRjX3N0YXRlLCAgJm5fZW50cmllcyk7CiAKIAlpZiAoZHJtX1dBUk5fT05f
T05DRSgmZGV2X3ByaXYtPmRybSwgIWRkaV90cmFuc2xhdGlvbnMpKQogCQlyZXR1cm47CkBAIC05
MTIsMTIgKzkxMSw3IEBAIHN0YXRpYyB2b2lkIHNrbF9kZGlfc2V0X2lib29zdChzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJY29uc3Qgc3RydWN0IGhzd19kZGlfYnVmX3RyYW5zICpk
ZGlfdHJhbnNsYXRpb25zOwogCQlpbnQgbl9lbnRyaWVzOwogCi0JCWlmIChpbnRlbF9jcnRjX2hh
c190eXBlKGNydGNfc3RhdGUsIElOVEVMX09VVFBVVF9IRE1JKSkKLQkJCWRkaV90cmFuc2xhdGlv
bnMgPSBoc3dfZGRpX2dldF9idWZfdHJhbnNfaGRtaShlbmNvZGVyLCAmbl9lbnRyaWVzKTsKLQkJ
ZWxzZSBpZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfRURQ
KSkKLQkJCWRkaV90cmFuc2xhdGlvbnMgPSBoc3dfZGRpX2dldF9idWZfdHJhbnNfZWRwKGVuY29k
ZXIsICZuX2VudHJpZXMpOwotCQllbHNlCi0JCQlkZGlfdHJhbnNsYXRpb25zID0gaHN3X2RkaV9n
ZXRfYnVmX3RyYW5zX2RwKGVuY29kZXIsICZuX2VudHJpZXMpOworCQlkZGlfdHJhbnNsYXRpb25z
ID0gaHN3X2dldF9idWZfdHJhbnMoZW5jb2RlciwgY3J0Y19zdGF0ZSwgJm5fZW50cmllcyk7CiAK
IAkJaWYgKGRybV9XQVJOX09OX09OQ0UoJmRldl9wcml2LT5kcm0sICFkZGlfdHJhbnNsYXRpb25z
KSkKIAkJCXJldHVybjsKQEAgLTk4OSwxMCArOTgzLDcgQEAgc3RhdGljIHU4IGludGVsX2RkaV9k
cF92b2x0YWdlX21heChzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAogCX0gZWxzZSBpZiAoSVNf
R0VNSU5JTEFLRShkZXZfcHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKIAkJYnh0X2dl
dF9idWZfdHJhbnMoZW5jb2RlciwgY3J0Y19zdGF0ZSwgJm5fZW50cmllcyk7CiAJfSBlbHNlIHsK
LQkJaWYgKGludGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0VEUCkp
Ci0JCQloc3dfZGRpX2dldF9idWZfdHJhbnNfZWRwKGVuY29kZXIsICZuX2VudHJpZXMpOwotCQll
bHNlCi0JCQloc3dfZGRpX2dldF9idWZfdHJhbnNfZHAoZW5jb2RlciwgJm5fZW50cmllcyk7CisJ
CWhzd19nZXRfYnVmX3RyYW5zKGVuY29kZXIsIGNydGNfc3RhdGUsICZuX2VudHJpZXMpOwogCX0K
IAogCWlmIChkcm1fV0FSTl9PTigmZGV2X3ByaXYtPmRybSwgbl9lbnRyaWVzIDwgMSkpCkBAIC0z
MDk4LDcgKzMwODksNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfZGRpX2hkbWkoc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShkZXZf
cHJpdikgfHwgSVNfQlJPWFRPTihkZXZfcHJpdikpCiAJCWJ4dF9kZGlfdnN3aW5nX3NlcXVlbmNl
KGVuY29kZXIsIGNydGNfc3RhdGUsIGxldmVsKTsKIAllbHNlCi0JCWhzd19wcmVwYXJlX2hkbWlf
ZGRpX2J1ZmZlcnMoZW5jb2RlciwgbGV2ZWwpOworCQloc3dfcHJlcGFyZV9oZG1pX2RkaV9idWZm
ZXJzKGVuY29kZXIsIGNydGNfc3RhdGUsIGxldmVsKTsKIAogCWlmIChESVNQTEFZX1ZFUihkZXZf
cHJpdikgPT0gOSAmJiAhSVNfQlJPWFRPTihkZXZfcHJpdikpCiAJCXNrbF9kZGlfc2V0X2lib29z
dChlbmNvZGVyLCBjcnRjX3N0YXRlLCBsZXZlbCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaV9idWZfdHJhbnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGRpX2J1Zl90cmFucy5jCmluZGV4IDViOGM2N2M0MzlhNy4uNTZi
NTIxZDAzMGUxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RkaV9idWZfdHJhbnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RkaV9idWZfdHJhbnMuYwpAQCAtODQ2LDggKzg0Niw4IEBAIHN0YXRpYyBpbnQgc2tsX2J1Zl90
cmFuc19udW1fZW50cmllcyhlbnVtIHBvcnQgcG9ydCwgaW50IG5fZW50cmllcykKIAkJcmV0dXJu
IG1pbihuX2VudHJpZXMsIDkpOwogfQogCi1jb25zdCBzdHJ1Y3QgaHN3X2RkaV9idWZfdHJhbnMg
KgotaHN3X2RkaV9nZXRfYnVmX3RyYW5zX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LCBpbnQgKm5fZW50cmllcykKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaHN3X2RkaV9idWZfdHJhbnMg
KgoraHN3X2dldF9idWZfdHJhbnNfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIGlu
dCAqbl9lbnRyaWVzKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwogCkBAIC04NzUsOCArODc1LDggQEAgaHN3X2RkaV9n
ZXRfYnVmX3RyYW5zX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLCBpbnQgKm5fZW50
cmllcykKIAlyZXR1cm4gTlVMTDsKIH0KIAotY29uc3Qgc3RydWN0IGhzd19kZGlfYnVmX3RyYW5z
ICoKLWhzd19kZGlfZ2V0X2J1Zl90cmFuc19lZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsIGludCAqbl9lbnRyaWVzKQorc3RhdGljIGNvbnN0IHN0cnVjdCBoc3dfZGRpX2J1Zl90cmFu
cyAqCitoc3dfZ2V0X2J1Zl90cmFuc19lZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
IGludCAqbl9lbnRyaWVzKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwogCkBAIC04OTYsMTAgKzg5NiwxMiBAQCBoc3df
ZGRpX2dldF9idWZfdHJhbnNfZWRwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLCBpbnQg
Km5fZW50cmllcykKIAlyZXR1cm4gTlVMTDsKIH0KIAotY29uc3Qgc3RydWN0IGhzd19kZGlfYnVm
X3RyYW5zICoKLWhzd19kZGlfZ2V0X2J1Zl90cmFuc19mZGkoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAotCQkJICBpbnQgKm5fZW50cmllcykKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qg
aHN3X2RkaV9idWZfdHJhbnMgKgoraHN3X2dldF9idWZfdHJhbnNfZmRpKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAorCQkgICAgICBpbnQgKm5fZW50cmllcykKIHsKKwlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2UuZGV2KTsKKwog
CWlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7CiAJCSpuX2VudHJpZXMgPSBBUlJBWV9TSVpF
KGJkd19kZGlfdHJhbnNsYXRpb25zX2ZkaSk7CiAJCXJldHVybiBiZHdfZGRpX3RyYW5zbGF0aW9u
c19mZGk7CkBAIC05MTIsOSArOTE0LDkgQEAgaHN3X2RkaV9nZXRfYnVmX3RyYW5zX2ZkaShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJcmV0dXJuIE5VTEw7CiB9CiAKLWNvbnN0
IHN0cnVjdCBoc3dfZGRpX2J1Zl90cmFucyAqCi1oc3dfZGRpX2dldF9idWZfdHJhbnNfaGRtaShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKLQkJCSAgIGludCAqbl9lbnRyaWVzKQorc3Rh
dGljIGNvbnN0IHN0cnVjdCBoc3dfZGRpX2J1Zl90cmFucyAqCitoc3dfZ2V0X2J1Zl90cmFuc19o
ZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorCQkgICAgICAgaW50ICpuX2VudHJp
ZXMpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShlbmNv
ZGVyLT5iYXNlLmRldik7CiAKQEAgLTkzMiw2ICs5MzQsMjEgQEAgaHN3X2RkaV9nZXRfYnVmX3Ry
YW5zX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJcmV0dXJuIE5VTEw7CiB9
CiAKK2NvbnN0IHN0cnVjdCBoc3dfZGRpX2J1Zl90cmFucyAqCitoc3dfZ2V0X2J1Zl90cmFucyhz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKKwkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKKwkJICBpbnQgKm5fZW50cmllcykKK3sKKwlpZiAoaW50ZWxf
Y3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfQU5BTE9HKSkKKwkJcmV0dXJu
IGhzd19nZXRfYnVmX3RyYW5zX2ZkaShlbmNvZGVyLCBuX2VudHJpZXMpOworCWVsc2UgaWYgKGlu
dGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0hETUkpKQorCQlyZXR1
cm4gaHN3X2dldF9idWZfdHJhbnNfaGRtaShlbmNvZGVyLCBuX2VudHJpZXMpOworCWVsc2UgaWYg
KGludGVsX2NydGNfaGFzX3R5cGUoY3J0Y19zdGF0ZSwgSU5URUxfT1VUUFVUX0VEUCkpCisJCXJl
dHVybiBoc3dfZ2V0X2J1Zl90cmFuc19lZHAoZW5jb2Rlciwgbl9lbnRyaWVzKTsKKwllbHNlCisJ
CXJldHVybiBoc3dfZ2V0X2J1Zl90cmFuc19kcChlbmNvZGVyLCBuX2VudHJpZXMpOworfQorCiBz
dGF0aWMgY29uc3Qgc3RydWN0IGJ4dF9kZGlfYnVmX3RyYW5zICoKIGJ4dF9nZXRfYnVmX3RyYW5z
X2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLCBpbnQgKm5fZW50cmllcykKIHsKQEAg
LTEzNzMsMTMgKzEzOTAsMTMgQEAgaW50IGludGVsX2RkaV9oZG1pX251bV9lbnRyaWVzKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQlieHRfZ2V0X2J1Zl90cmFuc19oZG1pKGVuY29k
ZXIsICZuX2VudHJpZXMpOwogCQkqZGVmYXVsdF9lbnRyeSA9IG5fZW50cmllcyAtIDE7CiAJfSBl
bHNlIGlmIChESVNQTEFZX1ZFUihkZXZfcHJpdikgPT0gOSkgewotCQloc3dfZGRpX2dldF9idWZf
dHJhbnNfaGRtaShlbmNvZGVyLCAmbl9lbnRyaWVzKTsKKwkJaHN3X2dldF9idWZfdHJhbnNfaGRt
aShlbmNvZGVyLCAmbl9lbnRyaWVzKTsKIAkJKmRlZmF1bHRfZW50cnkgPSA4OwogCX0gZWxzZSBp
ZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkgewotCQloc3dfZGRpX2dldF9idWZfdHJhbnNfaGRt
aShlbmNvZGVyLCAmbl9lbnRyaWVzKTsKKwkJaHN3X2dldF9idWZfdHJhbnNfaGRtaShlbmNvZGVy
LCAmbl9lbnRyaWVzKTsKIAkJKmRlZmF1bHRfZW50cnkgPSA3OwogCX0gZWxzZSBpZiAoSVNfSEFT
V0VMTChkZXZfcHJpdikpIHsKLQkJaHN3X2RkaV9nZXRfYnVmX3RyYW5zX2hkbWkoZW5jb2Rlciwg
Jm5fZW50cmllcyk7CisJCWhzd19nZXRfYnVmX3RyYW5zX2hkbWkoZW5jb2RlciwgJm5fZW50cmll
cyk7CiAJCSpkZWZhdWx0X2VudHJ5ID0gNjsKIAl9IGVsc2UgewogCQlkcm1fV0FSTigmZGV2X3By
aXYtPmRybSwgMSwgImRkaSB0cmFuc2xhdGlvbiB0YWJsZSBtaXNzaW5nXG4iKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpX2J1Zl90cmFucy5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGlfYnVmX3RyYW5zLmgKaW5kZXgg
NjE0N2QwODllOGU0Li5lNWI2NGU5NDAzMGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGRpX2J1Zl90cmFucy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGRpX2J1Zl90cmFucy5oCkBAIC01MiwxMyArNTIsOSBAQCBpbnQg
aW50ZWxfZGRpX2hkbWlfbnVtX2VudHJpZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
CiAJCQkgICAgICAgaW50ICpkZWZhdWx0X2VudHJ5KTsKIAogY29uc3Qgc3RydWN0IGhzd19kZGlf
YnVmX3RyYW5zICoKLWhzd19kZGlfZ2V0X2J1Zl90cmFuc19lZHAoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsIGludCAqbl9lbnRyaWVzKTsKLWNvbnN0IHN0cnVjdCBoc3dfZGRpX2J1Zl90
cmFucyAqCi1oc3dfZGRpX2dldF9idWZfdHJhbnNfZmRpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwgaW50ICpuX2VudHJpZXMpOwotY29uc3Qgc3RydWN0IGhzd19kZGlfYnVmX3Ry
YW5zICoKLWhzd19kZGlfZ2V0X2J1Zl90cmFuc19oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLCBpbnQgKm5fZW50cmllcyk7Ci1jb25zdCBzdHJ1Y3QgaHN3X2RkaV9idWZfdHJhbnMg
KgotaHN3X2RkaV9nZXRfYnVmX3RyYW5zX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LCBpbnQgKm5fZW50cmllcyk7Citoc3dfZ2V0X2J1Zl90cmFucyhzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKKwkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKKwkJICBpbnQgKm5fZW50cmllcyk7CiAKIGNvbnN0IHN0cnVjdCBieHRfZGRpX2J1Zl90cmFu
cyAqCiBieHRfZ2V0X2J1Zl90cmFucyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZmRpLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZkaS5jCmluZGV4IDRlZTdkZDJlMTI0Zi4u
MjIzNzYyMDIwYWZlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2ZkaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZmRpLmMK
QEAgLTU2OCw3ICs1NjgsNyBAQCB2b2lkIGhzd19mZGlfbGlua190cmFpbihzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKIAl1MzIgdGVtcCwgaSwgcnhfY3RsX3ZhbDsKIAlpbnQgbl9lbnRy
aWVzOwogCi0JaHN3X2RkaV9nZXRfYnVmX3RyYW5zX2ZkaShkZXZfcHJpdiwgJm5fZW50cmllcyk7
CisJaHN3X2dldF9idWZfdHJhbnMoZW5jb2RlciwgY3J0Y19zdGF0ZSwgJm5fZW50cmllcyk7CiAK
IAloc3dfcHJlcGFyZV9kcF9kZGlfYnVmZmVycyhlbmNvZGVyLCBjcnRjX3N0YXRlKTsKIAotLSAK
Mi4yNi4zCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJ
bnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

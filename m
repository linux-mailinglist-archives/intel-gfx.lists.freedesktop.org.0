Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CC0C4E3E04
	for <lists+intel-gfx@lfdr.de>; Thu, 24 Oct 2019 23:16:54 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1B4196E823;
	Thu, 24 Oct 2019 21:16:53 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E3D8C6E822
 for <intel-gfx@lists.freedesktop.org>; Thu, 24 Oct 2019 21:16:47 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18955106-1500050 
 for <intel-gfx@lists.freedesktop.org>; Thu, 24 Oct 2019 22:16:43 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 24 Oct 2019 22:16:41 +0100
Message-Id: <20191024211642.7688-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc0
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 1/2] drm/i915: Extract GT render power state
 management
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQW5kaSBTaHl0aSA8YW5kaUBldGV6aWFuLm9yZz4KCmk5MTVfaXJxLmMgaXMgbGFyZ2Uu
IE9uZSByZWFzb24gZm9yIHRoaXMgaXMgdGhhdCBoYXMgYSBsYXJnZSBjaHVuayBvZgp0aGUgR1Qg
cmVuZGVyIHBvd2VyIG1hbmFnZW1lbnQgc3Rhc2hlZCBhd2F5IGluIGl0LiBFeHRyYWN0IHRoYXQg
bG9naWMKb3V0IG9mIGk5MTVfaXJxLmMgYW5kIGludGVsX3BtLmMgYW5kIHB1dCBpdCB1bmRlciBv
bmUgcm9vZi4KCkJhc2VkIG9uIGEgcGF0Y2ggYnkgQ2hyaXMgV2lsc29uLgoKU2lnbmVkLW9mZi1i
eTogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+CkNjOiBDaHJpcyBXaWxzb24gPGNo
cmlzQGNocmlzLXdpbHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmls
ZSAgICAgICAgICAgICAgICAgfCAgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheS5jICB8ICAgIDggKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0LmMgICAgICAgICAgICB8ICAgMTMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0X2lycS5jICAgICAgICB8ICAgIDUgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0X3BtLmMgICAgICAgICB8ICAgMjggKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0X3BtLmggICAgICAgICB8ICAgIDEgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
Z3RfdHlwZXMuaCAgICAgIHwgICAgMiArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9s
bGMuYyAgICAgICAgICAgfCAgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
cHMuYyAgICAgICAgICAgfCAxODcyICsrKysrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfcnBzLmggICAgICAgICAgIHwgICAzNyArCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ycHNfdHlwZXMuaCAgICAgfCAgIDkzICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3NlbGZ0ZXN0X2xsYy5jICAgICAgICB8ICAgIDcgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ3Qv
dWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYyB8ICAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8ICAgNzMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmMgICAgICAgICAgICAgICB8ICAgIDMgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9kcnYuaCAgICAgICAgICAgICAgIHwgICA5NiAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbS5jICAgICAgICAgICAgICAgfCAgICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2lycS5jICAgICAgICAgICAgICAgfCAgMzU5ICstLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9pcnEuaCAgICAgICAgICAgICAgIHwgICAgMyAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3BtdS5jICAgICAgICAgICAgICAgfCAgIDEwICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3JlcXVlc3QuYyAgICAgICAgICAgfCAgICA3ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3N5c2ZzLmMgICAgICAgICAgICAgfCAgIDc0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9wbS5jICAgICAgICAgICAgICAgfCAyMTIxICsrLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oICAgICAgICAgICAgICAgfCAgIDIyIC0KIDI0IGZpbGVz
IGNoYW5nZWQsIDIzMzAgaW5zZXJ0aW9ucygrKSwgMjUxNCBkZWxldGlvbnMoLSkKIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ycHMuYwogY3JlYXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jwcy5oCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcnBzX3R5cGVzLmgKCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L01ha2VmaWxlCmluZGV4IDliZjFjMGIyMDM3MC4uNTkxYmE1NWMyNGQxIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9NYWtlZmlsZQpAQCAtOTUsNiArOTUsNyBAQCBndC15ICs9IFwKIAlndC9pbnRlbF9yZXNldC5v
IFwKIAlndC9pbnRlbF9yaW5nLm8gXAogCWd0L2ludGVsX3Jpbmdfc3VibWlzc2lvbi5vIFwKKwln
dC9pbnRlbF9ycHMubyBcCiAJZ3QvaW50ZWxfc3NldS5vIFwKIAlndC9pbnRlbF90aW1lbGluZS5v
IFwKIAlndC9pbnRlbF93b3JrYXJvdW5kcy5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfZGlzcGxheS5jCmluZGV4IDZkYzNjOTMxZWRiMS4uNWVkMTNlMzU0NmIyIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwpAQCAtNTUsNiAr
NTUsOCBAQAogI2luY2x1ZGUgImRpc3BsYXkvaW50ZWxfdHYuaCIKICNpbmNsdWRlICJkaXNwbGF5
L2ludGVsX3Zkc2MuaCIKIAorI2luY2x1ZGUgImd0L2ludGVsX3Jwcy5oIgorCiAjaW5jbHVkZSAi
aTkxNV9kcnYuaCIKICNpbmNsdWRlICJpOTE1X3RyYWNlLmgiCiAjaW5jbHVkZSAiaW50ZWxfYWNw
aS5oIgpAQCAtMTQ5NDMsNyArMTQ5NDUsNyBAQCBzdGF0aWMgaW50IGRvX3Jwc19ib29zdChzdHJ1
Y3Qgd2FpdF9xdWV1ZV9lbnRyeSAqX3dhaXQsCiAJICogdmJsYW5rIHdpdGhvdXQgb3VyIGludGVy
dmVudGlvbiwgc28gbGVhdmUgUlBTIGFsb25lLgogCSAqLwogCWlmICghaTkxNV9yZXF1ZXN0X3N0
YXJ0ZWQocnEpKQotCQlnZW42X3Jwc19ib29zdChycSk7CisJCWludGVsX3Jwc19ib29zdChycSk7
CiAJaTkxNV9yZXF1ZXN0X3B1dChycSk7CiAKIAlkcm1fY3J0Y192YmxhbmtfcHV0KHdhaXQtPmNy
dGMpOwpAQCAtMTUxMzcsNyArMTUxMzksNyBAQCBpbnRlbF9wcmVwYXJlX3BsYW5lX2ZiKHN0cnVj
dCBkcm1fcGxhbmUgKnBsYW5lLAogCSAqIG1heGltdW0gY2xvY2tzIGZvbGxvd2luZyBhIHZibGFu
ayBtaXNzIChzZWUgZG9fcnBzX2Jvb3N0KCkpLgogCSAqLwogCWlmICghaW50ZWxfc3RhdGUtPnJw
c19pbnRlcmFjdGl2ZSkgewotCQlpbnRlbF9ycHNfbWFya19pbnRlcmFjdGl2ZShkZXZfcHJpdiwg
dHJ1ZSk7CisJCWludGVsX3Jwc19tYXJrX2ludGVyYWN0aXZlKCZkZXZfcHJpdi0+Z3QucnBzLCB0
cnVlKTsKIAkJaW50ZWxfc3RhdGUtPnJwc19pbnRlcmFjdGl2ZSA9IHRydWU7CiAJfQogCkBAIC0x
NTE2Miw3ICsxNTE2NCw3IEBAIGludGVsX2NsZWFudXBfcGxhbmVfZmIoc3RydWN0IGRybV9wbGFu
ZSAqcGxhbmUsCiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShw
bGFuZS0+ZGV2KTsKIAogCWlmIChpbnRlbF9zdGF0ZS0+cnBzX2ludGVyYWN0aXZlKSB7Ci0JCWlu
dGVsX3Jwc19tYXJrX2ludGVyYWN0aXZlKGRldl9wcml2LCBmYWxzZSk7CisJCWludGVsX3Jwc19t
YXJrX2ludGVyYWN0aXZlKCZkZXZfcHJpdi0+Z3QucnBzLCBmYWxzZSk7CiAJCWludGVsX3N0YXRl
LT5ycHNfaW50ZXJhY3RpdmUgPSBmYWxzZTsKIAl9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2d0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9n
dC5jCmluZGV4IDM1MTI3Njk5NTkxZC4uZjI0NDAxMTNmZGY4IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2d0LmMKQEAgLTksNiArOSw3IEBACiAjaW5jbHVkZSAiaW50ZWxfZ3RfcmVxdWVzdHMu
aCIKICNpbmNsdWRlICJpbnRlbF9tb2NzLmgiCiAjaW5jbHVkZSAiaW50ZWxfcmM2LmgiCisjaW5j
bHVkZSAiaW50ZWxfcnBzLmgiCiAjaW5jbHVkZSAiaW50ZWxfdW5jb3JlLmgiCiAjaW5jbHVkZSAi
aW50ZWxfcG0uaCIKIApAQCAtMzEsOSArMzIsNiBAQCB2b2lkIGludGVsX2d0X2luaXRfZWFybHko
c3RydWN0IGludGVsX2d0ICpndCwgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB2b2lk
IGludGVsX2d0X2luaXRfaHdfZWFybHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7
CiAJaTkxNS0+Z3QuZ2d0dCA9ICZpOTE1LT5nZ3R0OwotCi0JLyogQklPUyBvZnRlbiBsZWF2ZXMg
UkM2IGVuYWJsZWQsIGJ1dCBkaXNhYmxlIGl0IGZvciBodyBpbml0ICovCi0JaW50ZWxfZ3RfcG1f
ZGlzYWJsZSgmaTkxNS0+Z3QpOwogfQogCiBzdGF0aWMgdm9pZCBpbml0X3VudXNlZF9yaW5nKHN0
cnVjdCBpbnRlbF9ndCAqZ3QsIHUzMiBiYXNlKQpAQCAtMzIwLDggKzMxOCw3IEBAIHZvaWQgaW50
ZWxfZ3RfY2hpcHNldF9mbHVzaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCiB2b2lkIGludGVsX2d0
X2RyaXZlcl9yZWdpc3RlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewotCWlmIChJU19HRU4oZ3Qt
Pmk5MTUsIDUpKQotCQlpbnRlbF9ncHVfaXBzX2luaXQoZ3QtPmk5MTUpOworCWludGVsX3Jwc19k
cml2ZXJfcmVnaXN0ZXIoJmd0LT5ycHMpOwogfQogCiBzdGF0aWMgaW50IGludGVsX2d0X2luaXRf
c2NyYXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1bnNpZ25lZCBpbnQgc2l6ZSkKQEAgLTM3OSwy
MCArMzc2LDE2IEBAIGludCBpbnRlbF9ndF9pbml0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB2b2lk
IGludGVsX2d0X2RyaXZlcl9yZW1vdmUoc3RydWN0IGludGVsX2d0ICpndCkKIHsKIAlHRU1fQlVH
X09OKGd0LT5hd2FrZSk7Ci0JaW50ZWxfZ3RfcG1fZGlzYWJsZShndCk7CiB9CiAKIHZvaWQgaW50
ZWxfZ3RfZHJpdmVyX3VucmVnaXN0ZXIoc3RydWN0IGludGVsX2d0ICpndCkKIHsKLQlpbnRlbF9n
cHVfaXBzX3RlYXJkb3duKCk7CisJaW50ZWxfcnBzX2RyaXZlcl91bnJlZ2lzdGVyKCZndC0+cnBz
KTsKIH0KIAogdm9pZCBpbnRlbF9ndF9kcml2ZXJfcmVsZWFzZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0
KQogewotCS8qIFBhcmFub2lhOiBtYWtlIHN1cmUgd2UgaGF2ZSBkaXNhYmxlZCBldmVyeXRoaW5n
IGJlZm9yZSB3ZSBleGl0LiAqLwotCWludGVsX2d0X3BtX2Rpc2FibGUoZ3QpOwogCWludGVsX2d0
X3BtX2ZpbmkoZ3QpOwotCiAJaW50ZWxfZ3RfZmluaV9zY3JhdGNoKGd0KTsKIH0KIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfaXJxLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9pcnEuYwppbmRleCAzNGE0ZmI2MjRiZjcuLjk3M2VlN2Vk
ZWQ2NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfaXJxLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfaXJxLmMKQEAgLTExLDYgKzEx
LDcgQEAKICNpbmNsdWRlICJpbnRlbF9ndC5oIgogI2luY2x1ZGUgImludGVsX2d0X2lycS5oIgog
I2luY2x1ZGUgImludGVsX3VuY29yZS5oIgorI2luY2x1ZGUgImludGVsX3Jwcy5oIgogCiBzdGF0
aWMgdm9pZCBndWNfaXJxX2hhbmRsZXIoc3RydWN0IGludGVsX2d1YyAqZ3VjLCB1MTYgaWlyKQog
ewpAQCAtNzcsNyArNzgsNyBAQCBnZW4xMV9vdGhlcl9pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxf
Z3QgKmd0LCBjb25zdCB1OCBpbnN0YW5jZSwKIAkJcmV0dXJuIGd1Y19pcnFfaGFuZGxlcigmZ3Qt
PnVjLmd1YywgaWlyKTsKIAogCWlmIChpbnN0YW5jZSA9PSBPVEhFUl9HVFBNX0lOU1RBTkNFKQot
CQlyZXR1cm4gZ2VuMTFfcnBzX2lycV9oYW5kbGVyKGd0LCBpaXIpOworCQlyZXR1cm4gZ2VuMTFf
cnBzX2lycV9oYW5kbGVyKCZndC0+cnBzLCBpaXIpOwogCiAJV0FSTl9PTkNFKDEsICJ1bmhhbmRs
ZWQgb3RoZXIgaW50ZXJydXB0IGluc3RhbmNlPTB4JXgsIGlpcj0weCV4XG4iLAogCQkgIGluc3Rh
bmNlLCBpaXIpOwpAQCAtMzM2LDcgKzMzNyw3IEBAIHZvaWQgZ2VuOF9ndF9pcnFfaGFuZGxlcihz
dHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1MzIgbWFzdGVyX2N0bCwgdTMyIGd0X2lpcls0XSkKIAl9CiAK
IAlpZiAobWFzdGVyX2N0bCAmIChHRU44X0dUX1BNX0lSUSB8IEdFTjhfR1RfR1VDX0lSUSkpIHsK
LQkJZ2VuNl9ycHNfaXJxX2hhbmRsZXIoZ3QtPmk5MTUsIGd0X2lpclsyXSk7CisJCWdlbjZfcnBz
X2lycV9oYW5kbGVyKCZndC0+cnBzLCBndF9paXJbMl0pOwogCQlndWNfaXJxX2hhbmRsZXIoJmd0
LT51Yy5ndWMsIGd0X2lpclsyXSA+PiAxNik7CiAJfQogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2d0X3BtLmMKaW5kZXggYWZmNGVkYTQ3ODE5Li4zMmJlY2YxNWQ0ZTAgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYwpAQCAtMTIsOCArMTIsMTAgQEAKICNpbmNsdWRlICJp
bnRlbF9ndC5oIgogI2luY2x1ZGUgImludGVsX2d0X3BtLmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3Rf
cmVxdWVzdHMuaCIKKyNpbmNsdWRlICJpbnRlbF9sbGMuaCIKICNpbmNsdWRlICJpbnRlbF9wbS5o
IgogI2luY2x1ZGUgImludGVsX3JjNi5oIgorI2luY2x1ZGUgImludGVsX3Jwcy5oIgogI2luY2x1
ZGUgImludGVsX3dha2VyZWYuaCIKIAogc3RhdGljIGludCBfX2d0X3VucGFyayhzdHJ1Y3QgaW50
ZWxfd2FrZXJlZiAqd2YpCkBAIC0zOSwxMiArNDEsNyBAQCBzdGF0aWMgaW50IF9fZ3RfdW5wYXJr
KHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIAlndC0+YXdha2UgPSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2dldChpOTE1LCBQT1dFUl9ET01BSU5fR1RfSVJRKTsKIAlHRU1fQlVHX09OKCFndC0+YXdh
a2UpOwogCi0JaW50ZWxfZW5hYmxlX2d0X3Bvd2Vyc2F2ZShpOTE1KTsKLQotCWk5MTVfdXBkYXRl
X2dmeF92YWwoaTkxNSk7Ci0JaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQotCQlnZW42X3Jwc19i
dXN5KGk5MTUpOwotCisJaW50ZWxfcnBzX3VucGFyaygmZ3QtPnJwcyk7CiAJaTkxNV9wbXVfZ3Rf
dW5wYXJrZWQoaTkxNSk7CiAKIAlpbnRlbF9ndF91bnBhcmtfcmVxdWVzdHMoZ3QpOwpAQCAtNjQs
OCArNjEsNyBAQCBzdGF0aWMgaW50IF9fZ3RfcGFyayhzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2Yp
CiAKIAlpOTE1X3ZtYV9wYXJrZWQoZ3QpOwogCWk5MTVfcG11X2d0X3BhcmtlZChpOTE1KTsKLQlp
ZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCi0JCWdlbjZfcnBzX2lkbGUoaTkxNSk7CisJaW50ZWxf
cnBzX3BhcmsoJmd0LT5ycHMpOwogCiAJLyogRXZlcnl0aGluZyBzd2l0Y2hlZCBvZmYsIGZsdXNo
IGFueSByZXNpZHVhbCBpbnRlcnJ1cHQganVzdCBpbiBjYXNlICovCiAJaW50ZWxfc3luY2hyb25p
emVfaXJxKGk5MTUpOwpAQCAtOTcsNiArOTMsNyBAQCB2b2lkIGludGVsX2d0X3BtX2luaXQoc3Ry
dWN0IGludGVsX2d0ICpndCkKIAkgKiB1c2VyLgogCSAqLwogCWludGVsX3JjNl9pbml0KCZndC0+
cmM2KTsKKwlpbnRlbF9ycHNfaW5pdCgmZ3QtPnJwcyk7CiB9CiAKIHN0YXRpYyBib29sIHJlc2V0
X2VuZ2luZXMoc3RydWN0IGludGVsX2d0ICpndCkKQEAgLTE0MCwxMiArMTM3LDYgQEAgdm9pZCBp
bnRlbF9ndF9zYW5pdGl6ZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBib29sIGZvcmNlKQogCQkJZW5n
aW5lLT5yZXNldC5maW5pc2goZW5naW5lKTsKIH0KIAotdm9pZCBpbnRlbF9ndF9wbV9kaXNhYmxl
KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCi17Ci0JaWYgKCFpc19tb2NrX2d0KGd0KSkKLQkJaW50ZWxf
c2FuaXRpemVfZ3RfcG93ZXJzYXZlKGd0LT5pOTE1KTsKLX0KLQogdm9pZCBpbnRlbF9ndF9wbV9m
aW5pKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJaW50ZWxfcmM2X2ZpbmkoJmd0LT5yYzYpOwpA
QCAtMTY0LDkgKzE1NSwxMyBAQCBpbnQgaW50ZWxfZ3RfcmVzdW1lKHN0cnVjdCBpbnRlbF9ndCAq
Z3QpCiAJICogYWxsb3dpbmcgdXMgdG8gZml4dXAgdGhlIHVzZXIgY29udGV4dHMgb24gdGhlaXIg
Zmlyc3QgcGluLgogCSAqLwogCWludGVsX2d0X3BtX2dldChndCk7CisKIAlpbnRlbF91bmNvcmVf
Zm9yY2V3YWtlX2dldChndC0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAlpbnRlbF9yYzZfc2Fu
aXRpemUoJmd0LT5yYzYpOwogCisJaW50ZWxfcnBzX2VuYWJsZSgmZ3QtPnJwcyk7CisJaW50ZWxf
bGxjX2VuYWJsZSgmZ3QtPmxsYyk7CisKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQp
IHsKIAkJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwogCkBAIC0yMTcsOCArMjEyLDExIEBAIHZv
aWQgaW50ZWxfZ3Rfc3VzcGVuZChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCS8qIFdlIGV4cGVjdCB0
byBiZSBpZGxlIGFscmVhZHk7IGJ1dCBhbHNvIHdhbnQgdG8gYmUgaW5kZXBlbmRlbnQgKi8KIAl3
YWl0X2Zvcl9pZGxlKGd0KTsKIAotCXdpdGhfaW50ZWxfcnVudGltZV9wbShndC0+dW5jb3JlLT5y
cG0sIHdha2VyZWYpCisJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGd0LT51bmNvcmUtPnJwbSwgd2Fr
ZXJlZikgeworCQlpbnRlbF9ycHNfZGlzYWJsZSgmZ3QtPnJwcyk7CiAJCWludGVsX3JjNl9kaXNh
YmxlKCZndC0+cmM2KTsKKwkJaW50ZWxfbGxjX2Rpc2FibGUoJmd0LT5sbGMpOworCX0KIH0KIAog
dm9pZCBpbnRlbF9ndF9ydW50aW1lX3N1c3BlbmQoc3RydWN0IGludGVsX2d0ICpndCkKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5oCmluZGV4IDBlZDg3ZGE0YmI2OC4uZDkyNGM5ODRj
NzRkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmgKQEAgLTM5LDcgKzM5LDYg
QEAgc3RhdGljIGlubGluZSBpbnQgaW50ZWxfZ3RfcG1fd2FpdF9mb3JfaWRsZShzdHJ1Y3QgaW50
ZWxfZ3QgKmd0KQogCiB2b2lkIGludGVsX2d0X3BtX2luaXRfZWFybHkoc3RydWN0IGludGVsX2d0
ICpndCk7CiB2b2lkIGludGVsX2d0X3BtX2luaXQoc3RydWN0IGludGVsX2d0ICpndCk7Ci12b2lk
IGludGVsX2d0X3BtX2Rpc2FibGUoc3RydWN0IGludGVsX2d0ICpndCk7CiB2b2lkIGludGVsX2d0
X3BtX2Zpbmkoc3RydWN0IGludGVsX2d0ICpndCk7CiAKIHZvaWQgaW50ZWxfZ3Rfc2FuaXRpemUo
c3RydWN0IGludGVsX2d0ICpndCwgYm9vbCBmb3JjZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZ3RfdHlwZXMuaAppbmRleCBmY2IzYTZjOTQyMWMuLmQ0ZTE0ZGJkMTcyZSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF90eXBlcy5oCkBAIC0yMCw2ICsyMCw3IEBACiAj
aW5jbHVkZSAiaW50ZWxfbGxjX3R5cGVzLmgiCiAjaW5jbHVkZSAiaW50ZWxfcmVzZXRfdHlwZXMu
aCIKICNpbmNsdWRlICJpbnRlbF9yYzZfdHlwZXMuaCIKKyNpbmNsdWRlICJpbnRlbF9ycHNfdHlw
ZXMuaCIKICNpbmNsdWRlICJpbnRlbF93YWtlcmVmLmgiCiAKIHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlOwpAQCAtNzMsNiArNzQsNyBAQCBzdHJ1Y3QgaW50ZWxfZ3QgewogCiAJc3RydWN0IGludGVs
X2xsYyBsbGM7CiAJc3RydWN0IGludGVsX3JjNiByYzY7CisJc3RydWN0IGludGVsX3JwcyBycHM7
CiAKIAlrdGltZV90IGxhc3RfaW5pdF90aW1lOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9sbGMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xs
Yy5jCmluZGV4IDM1MDkzZWI1ZjI0ZS4uY2ViNzg1Yjc1YzI1IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9sbGMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9sbGMuYwpAQCAtNDgsNyArNDgsNyBAQCBzdGF0aWMgYm9vbCBnZXRfaWFfY29uc3Rh
bnRzKHN0cnVjdCBpbnRlbF9sbGMgKmxsYywKIAkJCSAgICAgc3RydWN0IGlhX2NvbnN0YW50cyAq
Y29uc3RzKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbGxjX3RvX2d0KGxs
YyktPmk5MTU7Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0X3BtLnJwczsKKwlz
dHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmbGxjX3RvX2d0KGxsYyktPnJwczsKIAogCWlmIChycHMt
Pm1heF9mcmVxIDw9IHJwcy0+bWluX2ZyZXEpCiAJCXJldHVybiBmYWxzZTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jwcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfcnBzLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li4zMGY1NmM3ODY0NjgKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9ycHMuYwpAQCAtMCwwICsxLDE4NzIgQEAKKy8qCisgKiBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogTUlUCisgKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24K
KyAqLworCisjaW5jbHVkZSAiaTkxNV9kcnYuaCIKKyNpbmNsdWRlICJpbnRlbF9ndC5oIgorI2lu
Y2x1ZGUgImludGVsX2d0X2lycS5oIgorI2luY2x1ZGUgImludGVsX2d0X3BtX2lycS5oIgorI2lu
Y2x1ZGUgImludGVsX3Jwcy5oIgorI2luY2x1ZGUgImludGVsX3NpZGViYW5kLmgiCisjaW5jbHVk
ZSAiLi4vLi4vLi4vcGxhdGZvcm0veDg2L2ludGVsX2lwcy5oIgorCisvKgorICogTG9jayBwcm90
ZWN0aW5nIElQUyByZWxhdGVkIGRhdGEgc3RydWN0dXJlcworICovCitzdGF0aWMgREVGSU5FX1NQ
SU5MT0NLKG1jaGRldl9sb2NrKTsKKworc3RhdGljIHN0cnVjdCBpbnRlbF9ndCAqcnBzX3RvX2d0
KHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlyZXR1cm4gY29udGFpbmVyX29mKHJwcywgc3Ry
dWN0IGludGVsX2d0LCBycHMpOworfQorCitzdGF0aWMgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KnJwc190b19pOTE1KHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlyZXR1cm4gcnBzX3RvX2d0
KHJwcyktPmk5MTU7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgaW50ZWxfdW5jb3JlICpycHNfdG9fdW5j
b3JlKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlyZXR1cm4gcnBzX3RvX2d0KHJwcyktPnVu
Y29yZTsKK30KKworc3RhdGljIHUzMiBycHNfcG1fc2FuaXRpemVfbWFzayhzdHJ1Y3QgaW50ZWxf
cnBzICpycHMsIHUzMiBtYXNrKQoreworCXJldHVybiBtYXNrICYgfnJwcy0+cG1faW50cm1za19t
Yno7Cit9CisKK3N0YXRpYyB1MzIgcnBzX3BtX21hc2soc3RydWN0IGludGVsX3JwcyAqcnBzLCB1
OCB2YWwpCit7CisJdTMyIG1hc2sgPSAwOworCisJLyogV2UgdXNlIFVQX0VJX0VYUElSRUQgaW50
ZXJydXB0cyBmb3IgYm90aCB1cC9kb3duIGluIG1hbnVhbCBtb2RlICovCisJaWYgKHZhbCA+IHJw
cy0+bWluX2ZyZXFfc29mdGxpbWl0KQorCQltYXNrIHw9IChHRU42X1BNX1JQX1VQX0VJX0VYUElS
RUQgfAorCQkJIEdFTjZfUE1fUlBfRE9XTl9USFJFU0hPTEQgfAorCQkJIEdFTjZfUE1fUlBfRE9X
Tl9USU1FT1VUKTsKKworCWlmICh2YWwgPCBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCkKKwkJbWFz
ayB8PSBHRU42X1BNX1JQX1VQX0VJX0VYUElSRUQgfCBHRU42X1BNX1JQX1VQX1RIUkVTSE9MRDsK
KworCW1hc2sgJj0gcnBzLT5wbV9ldmVudHM7CisKKwlyZXR1cm4gcnBzX3BtX3Nhbml0aXplX21h
c2socnBzLCB+bWFzayk7Cit9CisKK3N0YXRpYyB2b2lkIHJwc19yZXNldF9laShzdHJ1Y3QgaW50
ZWxfcnBzICpycHMpCit7CisJbWVtc2V0KCZycHMtPmVpLCAwLCBzaXplb2YocnBzLT5laSkpOwor
fQorCitzdGF0aWMgdm9pZCBycHNfZW5hYmxlX2ludGVycnVwdHMoc3RydWN0IGludGVsX3JwcyAq
cnBzKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBycHNfdG9fZ3QocnBzKTsKKworCXJwc19y
ZXNldF9laShycHMpOworCisJaWYgKElTX1ZBTExFWVZJRVcoZ3QtPmk5MTUpKQorCQkvKiBXYUdz
dlJDMFJlc2lkZW5jeU1ldGhvZDp2bHYgKi8KKwkJcnBzLT5wbV9ldmVudHMgPSBHRU42X1BNX1JQ
X1VQX0VJX0VYUElSRUQ7CisJZWxzZQorCQlycHMtPnBtX2V2ZW50cyA9IChHRU42X1BNX1JQX1VQ
X1RIUkVTSE9MRCB8CisJCQkJICBHRU42X1BNX1JQX0RPV05fVEhSRVNIT0xEIHwKKwkJCQkgIEdF
TjZfUE1fUlBfRE9XTl9USU1FT1VUKTsKKworCXNwaW5fbG9ja19pcnEoJmd0LT5pcnFfbG9jayk7
CisJZ2VuNl9ndF9wbV9lbmFibGVfaXJxKGd0LCBycHMtPnBtX2V2ZW50cyk7CisJc3Bpbl91bmxv
Y2tfaXJxKCZndC0+aXJxX2xvY2spOworCisJaW50ZWxfdW5jb3JlX3dyaXRlKGd0LT51bmNvcmUs
IEdFTjZfUE1JTlRSTVNLLAorCQkJICAgcnBzX3BtX21hc2socnBzLCBycHMtPmN1cl9mcmVxKSk7
Cit9CisKK3N0YXRpYyB2b2lkIGdlbjZfcnBzX3Jlc2V0X2ludGVycnVwdHMoc3RydWN0IGludGVs
X3JwcyAqcnBzKQoreworCWdlbjZfZ3RfcG1fcmVzZXRfaWlyKHJwc190b19ndChycHMpLCBHRU42
X1BNX1JQU19FVkVOVFMpOworfQorCitzdGF0aWMgdm9pZCBnZW4xMV9ycHNfcmVzZXRfaW50ZXJy
dXB0cyhzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJd2hpbGUgKGdlbjExX2d0X3Jlc2V0X29u
ZV9paXIocnBzX3RvX2d0KHJwcyksIDAsIEdFTjExX0dUUE0pKQorCQk7Cit9CisKK3N0YXRpYyB2
b2lkIHJwc19yZXNldF9pbnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1
Y3QgaW50ZWxfZ3QgKmd0ID0gcnBzX3RvX2d0KHJwcyk7CisKKwlzcGluX2xvY2tfaXJxKCZndC0+
aXJxX2xvY2spOworCWlmIChJTlRFTF9HRU4oZ3QtPmk5MTUpID49IDExKQorCQlnZW4xMV9ycHNf
cmVzZXRfaW50ZXJydXB0cyhycHMpOworCWVsc2UKKwkJZ2VuNl9ycHNfcmVzZXRfaW50ZXJydXB0
cyhycHMpOworCisJcnBzLT5wbV9paXIgPSAwOworCXNwaW5fdW5sb2NrX2lycSgmZ3QtPmlycV9s
b2NrKTsKK30KKworc3RhdGljIHZvaWQgcnBzX2Rpc2FibGVfaW50ZXJydXB0cyhzdHJ1Y3QgaW50
ZWxfcnBzICpycHMpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IHJwc190b19ndChycHMpOwor
CisJcnBzLT5wbV9ldmVudHMgPSAwOworCisJaW50ZWxfdW5jb3JlX3dyaXRlKGd0LT51bmNvcmUs
IEdFTjZfUE1JTlRSTVNLLAorCQkJICAgcnBzX3BtX3Nhbml0aXplX21hc2socnBzLCB+MHUpKTsK
KworCXNwaW5fbG9ja19pcnEoJmd0LT5pcnFfbG9jayk7CisJZ2VuNl9ndF9wbV9kaXNhYmxlX2ly
cShndCwgR0VONl9QTV9SUFNfRVZFTlRTKTsKKwlzcGluX3VubG9ja19pcnEoJmd0LT5pcnFfbG9j
ayk7CisKKwlpbnRlbF9zeW5jaHJvbml6ZV9pcnEoZ3QtPmk5MTUpOworCisJLyoKKwkgKiBOb3cg
dGhhdCB3ZSB3aWxsIG5vdCBiZSBnZW5lcmF0aW5nIGFueSBtb3JlIHdvcmssIGZsdXNoIGFueQor
CSAqIG91dHN0YW5kaW5nIHRhc2tzLiBBcyB3ZSBhcmUgY2FsbGVkIG9uIHRoZSBSUFMgaWRsZSBw
YXRoLAorCSAqIHdlIHdpbGwgcmVzZXQgdGhlIEdQVSB0byBtaW5pbXVtIGZyZXF1ZW5jaWVzLCBz
byB0aGUgY3VycmVudAorCSAqIHN0YXRlIG9mIHRoZSB3b3JrZXIgY2FuIGJlIGRpc2NhcmRlZC4K
KwkgKi8KKwljYW5jZWxfd29ya19zeW5jKCZycHMtPndvcmspOworCisJcnBzX3Jlc2V0X2ludGVy
cnVwdHMocnBzKTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBjcGFyYW1zIHsKKwl1MTYgaTsK
Kwl1MTYgdDsKKwl1MTYgbTsKKwl1MTYgYzsKK30gY3BhcmFtc1tdID0geworCXsgMSwgMTMzMywg
MzAxLCAyODY2NCB9LAorCXsgMSwgMTA2NiwgMjk0LCAyNDQ2MCB9LAorCXsgMSwgODAwLCAyOTQs
IDI1MTkyIH0sCisJeyAwLCAxMzMzLCAyNzYsIDI3NjA1IH0sCisJeyAwLCAxMDY2LCAyNzYsIDI3
NjA1IH0sCisJeyAwLCA4MDAsIDIzMSwgMjM3ODQgfSwKK307CisKK3N0YXRpYyB2b2lkIGdlbjVf
cnBzX2luaXQoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUgPSBycHNfdG9fdW5jb3JlKHJwcyk7CisJdTggZm1heCwgZm1pbiwgZnN0YXJ0OworCXUzMiBy
Z3Ztb2RlY3RsOworCWludCBjX20sIGk7CisKKwlpZiAoaTkxNS0+ZnNiX2ZyZXEgPD0gMzIwMCkK
KwkJY19tID0gMDsKKwllbHNlIGlmIChpOTE1LT5mc2JfZnJlcSA8PSA0ODAwKQorCQljX20gPSAx
OworCWVsc2UKKwkJY19tID0gMjsKKworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGNwYXJh
bXMpOyBpKyspIHsKKwkJaWYgKGNwYXJhbXNbaV0uaSA9PSBjX20gJiYgY3BhcmFtc1tpXS50ID09
IGk5MTUtPm1lbV9mcmVxKSB7CisJCQlycHMtPmlwcy5tID0gY3BhcmFtc1tpXS5tOworCQkJcnBz
LT5pcHMuYyA9IGNwYXJhbXNbaV0uYzsKKwkJCWJyZWFrOworCQl9CisJfQorCisJcmd2bW9kZWN0
bCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgTUVNTU9ERUNUTCk7CisKKwkvKiBTZXQgdXAg
bWluLCBtYXgsIGFuZCBjdXIgZm9yIGludGVycnVwdCBoYW5kbGluZyAqLworCWZtYXggPSAocmd2
bW9kZWN0bCAmIE1FTU1PREVfRk1BWF9NQVNLKSA+PiBNRU1NT0RFX0ZNQVhfU0hJRlQ7CisJZm1p
biA9IChyZ3Ztb2RlY3RsICYgTUVNTU9ERV9GTUlOX01BU0spOworCWZzdGFydCA9IChyZ3Ztb2Rl
Y3RsICYgTUVNTU9ERV9GU1RBUlRfTUFTSykgPj4KKwkJTUVNTU9ERV9GU1RBUlRfU0hJRlQ7CisJ
RFJNX0RFQlVHX0RSSVZFUigiZm1heDogJWQsIGZtaW46ICVkLCBmc3RhcnQ6ICVkXG4iLAorCQkJ
IGZtYXgsIGZtaW4sIGZzdGFydCk7CisKKwlycHMtPm1pbl9mcmVxID0gLWZzdGFydDsKKwlycHMt
Pm1heF9mcmVxID0gLWZtaW47CisKKwlycHMtPmlkbGVfZnJlcSA9IHJwcy0+bWluX2ZyZXE7CisJ
cnBzLT5jdXJfZnJlcSA9IHJwcy0+aWRsZV9mcmVxOworfQorCitzdGF0aWMgdW5zaWduZWQgbG9u
ZworX19pcHNfY2hpcHNldF92YWwoc3RydWN0IGludGVsX2lwcyAqaXBzKQoreworCXN0cnVjdCBp
bnRlbF91bmNvcmUgKnVuY29yZSA9CisJCXJwc190b191bmNvcmUoY29udGFpbmVyX29mKGlwcywg
c3RydWN0IGludGVsX3JwcywgaXBzKSk7CisJdW5zaWduZWQgbG9uZyBub3cgPSBqaWZmaWVzX3Rv
X21zZWNzKGppZmZpZXMpLCBkdDsKKwl1bnNpZ25lZCBsb25nIHJlc3VsdDsKKwl1NjQgdG90YWws
IGRlbHRhOworCisJbG9ja2RlcF9hc3NlcnRfaGVsZCgmbWNoZGV2X2xvY2spOworCisJLyoKKwkg
KiBQcmV2ZW50IGRpdmlzaW9uLWJ5LXplcm8gaWYgd2UgYXJlIGFza2luZyB0b28gZmFzdC4KKwkg
KiBBbHNvLCB3ZSBkb24ndCBnZXQgaW50ZXJlc3RpbmcgcmVzdWx0cyBpZiB3ZSBhcmUgcG9sbGlu
ZworCSAqIGZhc3RlciB0aGFuIG9uY2UgaW4gMTBtcywgc28ganVzdCByZXR1cm4gdGhlIHNhdmVk
IHZhbHVlCisJICogaW4gc3VjaCBjYXNlcy4KKwkgKi8KKwlkdCA9IG5vdyAtIGlwcy0+bGFzdF90
aW1lMTsKKwlpZiAoZHQgPD0gMTApCisJCXJldHVybiBpcHMtPmNoaXBzZXRfcG93ZXI7CisKKwkv
KiBGSVhNRTogaGFuZGxlIHBlci1jb3VudGVyIG92ZXJmbG93ICovCisJdG90YWwgPSBpbnRlbF91
bmNvcmVfcmVhZCh1bmNvcmUsIERNSUVDKTsKKwl0b3RhbCArPSBpbnRlbF91bmNvcmVfcmVhZCh1
bmNvcmUsIEREUkVDKTsKKwl0b3RhbCArPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIENTSUVD
KTsKKworCWRlbHRhID0gdG90YWwgLSBpcHMtPmxhc3RfY291bnQxOworCisJcmVzdWx0ID0gZGl2
X3U2NChkaXZfdTY0KGlwcy0+bSAqIGRlbHRhLCBkdCkgKyBpcHMtPmMsIDEwKTsKKworCWlwcy0+
bGFzdF9jb3VudDEgPSB0b3RhbDsKKwlpcHMtPmxhc3RfdGltZTEgPSBub3c7CisKKwlpcHMtPmNo
aXBzZXRfcG93ZXIgPSByZXN1bHQ7CisKKwlyZXR1cm4gcmVzdWx0OworfQorCitzdGF0aWMgdW5z
aWduZWQgbG9uZyBpcHNfbWNoX3ZhbChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpCit7CisJ
dW5zaWduZWQgaW50IG0sIHgsIGI7CisJdTMyIHRzZnM7CisKKwl0c2ZzID0gaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBUU0ZTKTsKKwl4ID0gaW50ZWxfdW5jb3JlX3JlYWQ4KHVuY29yZSwgVFIx
KTsKKworCWIgPSB0c2ZzICYgVFNGU19JTlRSX01BU0s7CisJbSA9ICh0c2ZzICYgVFNGU19TTE9Q
RV9NQVNLKSA+PiBUU0ZTX1NMT1BFX1NISUZUOworCisJcmV0dXJuIG0gKiB4IC8gMTI3IC0gYjsK
K30KKworc3RhdGljIGludCBfcHh2aWRfdG9fdmQodTggcHh2aWQpCit7CisJaWYgKHB4dmlkID09
IDApCisJCXJldHVybiAwOworCisJaWYgKHB4dmlkID49IDggJiYgcHh2aWQgPCAzMSkKKwkJcHh2
aWQgPSAzMTsKKworCXJldHVybiAocHh2aWQgKyAyKSAqIDEyNTsKK30KKworc3RhdGljIHUzMiBw
dmlkX3RvX2V4dHZpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdTggcHh2aWQpCit7
CisJY29uc3QgaW50IHZkID0gX3B4dmlkX3RvX3ZkKHB4dmlkKTsKKworCWlmIChJTlRFTF9JTkZP
KGk5MTUpLT5pc19tb2JpbGUpCisJCXJldHVybiBtYXgodmQgLSAxMTI1LCAwKTsKKworCXJldHVy
biB2ZDsKK30KKworc3RhdGljIHZvaWQgX19nZW41X2lwc191cGRhdGUoc3RydWN0IGludGVsX2lw
cyAqaXBzKQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9CisJCXJwc190b191bmNv
cmUoY29udGFpbmVyX29mKGlwcywgc3RydWN0IGludGVsX3JwcywgaXBzKSk7CisJdTY0IG5vdywg
ZGVsdGEsIGR0OworCXUzMiBjb3VudDsKKworCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJm1jaGRldl9s
b2NrKTsKKworCW5vdyA9IGt0aW1lX2dldF9yYXdfbnMoKTsKKwlkdCA9IG5vdyAtIGlwcy0+bGFz
dF90aW1lMjsKKwlkb19kaXYoZHQsIE5TRUNfUEVSX01TRUMpOworCisJLyogRG9uJ3QgZGl2aWRl
IGJ5IDAgKi8KKwlpZiAoZHQgPD0gMTApCisJCXJldHVybjsKKworCWNvdW50ID0gaW50ZWxfdW5j
b3JlX3JlYWQodW5jb3JlLCBHRlhFQyk7CisJZGVsdGEgPSBjb3VudCAtIGlwcy0+bGFzdF9jb3Vu
dDI7CisKKwlpcHMtPmxhc3RfY291bnQyID0gY291bnQ7CisJaXBzLT5sYXN0X3RpbWUyID0gbm93
OworCisJLyogTW9yZSBtYWdpYyBjb25zdGFudHMuLi4gKi8KKwlpcHMtPmdmeF9wb3dlciA9IGRp
dl91NjQoZGVsdGEgKiAxMTgxLCBkdCAqIDEwKTsKK30KKworc3RhdGljIHZvaWQgZ2VuNV9ycHNf
dXBkYXRlKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzcGluX2xvY2tfaXJxKCZtY2hkZXZf
bG9jayk7CisJX19nZW41X2lwc191cGRhdGUoJnJwcy0+aXBzKTsKKwlzcGluX3VubG9ja19pcnEo
Jm1jaGRldl9sb2NrKTsKK30KKworc3RhdGljIGJvb2wgZ2VuNV9ycHNfc2V0KHN0cnVjdCBpbnRl
bF9ycHMgKnJwcywgdTggdmFsKQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJw
c190b191bmNvcmUocnBzKTsKKwl1MTYgcmd2c3djdGw7CisKKwlsb2NrZGVwX2Fzc2VydF9oZWxk
KCZtY2hkZXZfbG9jayk7CisKKwlyZ3Zzd2N0bCA9IGludGVsX3VuY29yZV9yZWFkMTYodW5jb3Jl
LCBNRU1TV0NUTCk7CisJaWYgKHJndnN3Y3RsICYgTUVNQ1RMX0NNRF9TVFMpIHsKKwkJRFJNX0RF
QlVHKCJncHUgYnVzeSwgUkNTIGNoYW5nZSByZWplY3RlZFxuIik7CisJCXJldHVybiBmYWxzZTsg
Lyogc3RpbGwgYnVzeSB3aXRoIGFub3RoZXIgY29tbWFuZCAqLworCX0KKworCXZhbCA9IC12YWw7
CisKKwlyZ3Zzd2N0bCA9CisJCShNRU1DVExfQ01EX0NIRlJFUSA8PCBNRU1DVExfQ01EX1NISUZU
KSB8CisJCSh2YWwgPDwgTUVNQ1RMX0ZSRVFfU0hJRlQpIHwKKwkJTUVNQ1RMX1NGQ0FWTTsKKwlp
bnRlbF91bmNvcmVfd3JpdGUxNih1bmNvcmUsIE1FTVNXQ1RMLCByZ3Zzd2N0bCk7CisJaW50ZWxf
dW5jb3JlX3Bvc3RpbmdfcmVhZDE2KHVuY29yZSwgTUVNU1dDVEwpOworCisJcmd2c3djdGwgfD0g
TUVNQ1RMX0NNRF9TVFM7CisJaW50ZWxfdW5jb3JlX3dyaXRlMTYodW5jb3JlLCBNRU1TV0NUTCwg
cmd2c3djdGwpOworCisJcmV0dXJuIHRydWU7Cit9CisKK3N0YXRpYyB1bnNpZ25lZCBsb25nIGlu
dGVsX3B4ZnJlcSh1MzIgdmlkZnJlcSkKK3sKKwlpbnQgZGl2ID0gKHZpZGZyZXEgJiAweDNmMDAw
MCkgPj4gMTY7CisJaW50IHBvc3QgPSAodmlkZnJlcSAmIDB4MzAwMCkgPj4gMTI7CisJaW50IHBy
ZSA9ICh2aWRmcmVxICYgMHg3KTsKKworCWlmICghcHJlKQorCQlyZXR1cm4gMDsKKworCXJldHVy
biBkaXYgKiAxMzMzMzMgLyAocHJlIDw8IHBvc3QpOworfQorCitzdGF0aWMgdW5zaWduZWQgaW50
IGluaXRfZW1vbihzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpCit7CisJdTggcHh3WzE2XTsK
KwlpbnQgaTsKKworCS8qIERpc2FibGUgdG8gcHJvZ3JhbSAqLworCWludGVsX3VuY29yZV93cml0
ZSh1bmNvcmUsIEVDUiwgMCk7CisJaW50ZWxfdW5jb3JlX3Bvc3RpbmdfcmVhZCh1bmNvcmUsIEVD
Uik7CisKKwkvKiBQcm9ncmFtIGVuZXJneSB3ZWlnaHRzIGZvciB2YXJpb3VzIGV2ZW50cyAqLwor
CWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIFNERVcsIDB4MTUwNDBkMDApOworCWludGVsX3Vu
Y29yZV93cml0ZSh1bmNvcmUsIENTSUVXMCwgMHgwMDdmMDAwMCk7CisJaW50ZWxfdW5jb3JlX3dy
aXRlKHVuY29yZSwgQ1NJRVcxLCAweDFlMjIwMDA0KTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5j
b3JlLCBDU0lFVzIsIDB4MDQwMDAwMDQpOworCisJZm9yIChpID0gMDsgaSA8IDU7IGkrKykKKwkJ
aW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgUEVXKGkpLCAwKTsKKwlmb3IgKGkgPSAwOyBpIDwg
MzsgaSsrKQorCQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBERVcoaSksIDApOworCisJLyog
UHJvZ3JhbSBQLXN0YXRlIHdlaWdodHMgdG8gYWNjb3VudCBmb3IgZnJlcXVlbmN5IHBvd2VyIGFk
anVzdG1lbnQgKi8KKwlmb3IgKGkgPSAwOyBpIDwgMTY7IGkrKykgeworCQl1MzIgcHh2aWRmcmVx
ID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBQWFZGUkVRKGkpKTsKKwkJdW5zaWduZWQgaW50
IGZyZXEgPSBpbnRlbF9weGZyZXEocHh2aWRmcmVxKTsKKwkJdW5zaWduZWQgaW50IHZpZCA9CisJ
CQkocHh2aWRmcmVxICYgUFhWRlJFUV9QWF9NQVNLKSA+PiBQWFZGUkVRX1BYX1NISUZUOworCQl1
bnNpZ25lZCBpbnQgdmFsOworCisJCXZhbCA9IHZpZCAqIHZpZCAqIGZyZXEgLyAxMDAwICogMjU1
OworCQl2YWwgLz0gMTI3ICogMTI3ICogOTAwOworCisJCXB4d1tpXSA9IHZhbDsKKwl9CisJLyog
UmVuZGVyIHN0YW5kYnkgc3RhdGVzIGdldCAwIHdlaWdodCAqLworCXB4d1sxNF0gPSAwOworCXB4
d1sxNV0gPSAwOworCisJZm9yIChpID0gMDsgaSA8IDQ7IGkrKykgeworCQlpbnRlbF91bmNvcmVf
d3JpdGUodW5jb3JlLCBQWFcoaSksCisJCQkJICAgcHh3W2kgKiA0ICsgMF0gPDwgMjQgfAorCQkJ
CSAgIHB4d1tpICogNCArIDFdIDw8IDE2IHwKKwkJCQkgICBweHdbaSAqIDQgKyAyXSA8PCAgOCB8
CisJCQkJICAgcHh3W2kgKiA0ICsgM10gPDwgIDApOworCX0KKworCS8qIEFkanVzdCBtYWdpYyBy
ZWdzIHRvIG1hZ2ljIHZhbHVlcyAobW9yZSBleHBlcmltZW50YWwgcmVzdWx0cykgKi8KKwlpbnRl
bF91bmNvcmVfd3JpdGUodW5jb3JlLCBPR1cwLCAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5j
b3JlLCBPR1cxLCAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBFRzAsIDB4MDAwMDdm
MDApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEVHMSwgMHgwMDAwMDAwZSk7CisJaW50
ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgRUcyLCAweDAwMGUwMDAwKTsKKwlpbnRlbF91bmNvcmVf
d3JpdGUodW5jb3JlLCBFRzMsIDB4NjgwMDAzMDApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNv
cmUsIEVHNCwgMHg0MjAwMDAwMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgRUc1LCAw
eDAwMTQwMDMxKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBFRzYsIDApOworCWludGVs
X3VuY29yZV93cml0ZSh1bmNvcmUsIEVHNywgMCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgODsgaSsr
KQorCQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBQWFdMKGkpLCAwKTsKKworCS8qIEVuYWJs
ZSBQTU9OICsgc2VsZWN0IGV2ZW50cyAqLworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEVD
UiwgMHg4MDAwMDAxOSk7CisKKwlyZXR1cm4gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBMQ0ZV
U0UwMikgJiBMQ0ZVU0VfSElWX01BU0s7Cit9CisKK3N0YXRpYyBib29sIGdlbjVfcnBzX2VuYWJs
ZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3Jl
ID0gcnBzX3RvX3VuY29yZShycHMpOworCXU4IGZzdGFydCwgdnN0YXJ0OworCXUzMiByZ3Ztb2Rl
Y3RsOworCisJc3Bpbl9sb2NrX2lycSgmbWNoZGV2X2xvY2spOworCisJcmd2bW9kZWN0bCA9IGlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgTUVNTU9ERUNUTCk7CisKKwkvKiBFbmFibGUgdGVtcCBy
ZXBvcnRpbmcgKi8KKwlpbnRlbF91bmNvcmVfd3JpdGUxNih1bmNvcmUsIFBNTUlTQywKKwkJCSAg
ICAgaW50ZWxfdW5jb3JlX3JlYWQxNih1bmNvcmUsIFBNTUlTQykgfCBNQ1BQQ0VfRU4pOworCWlu
dGVsX3VuY29yZV93cml0ZTE2KHVuY29yZSwgVFNDMSwKKwkJCSAgICAgaW50ZWxfdW5jb3JlX3Jl
YWQxNih1bmNvcmUsIFRTQzEpIHwgVFNFKTsKKworCS8qIDEwMG1zIFJDIGV2YWx1YXRpb24gaW50
ZXJ2YWxzICovCisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgUkNVUEVJLCAxMDAwMDApOwor
CWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIFJDRE5FSSwgMTAwMDAwKTsKKworCS8qIFNldCBt
YXgvbWluIHRocmVzaG9sZHMgdG8gOTBtcyBhbmQgODBtcyByZXNwZWN0aXZlbHkgKi8KKwlpbnRl
bF91bmNvcmVfd3JpdGUodW5jb3JlLCBSQ0JNQVhBVkcsIDkwMDAwKTsKKwlpbnRlbF91bmNvcmVf
d3JpdGUodW5jb3JlLCBSQ0JNSU5BVkcsIDgwMDAwKTsKKworCWludGVsX3VuY29yZV93cml0ZSh1
bmNvcmUsIE1FTUlIWVNULCAxKTsKKworCS8qIFNldCB1cCBtaW4sIG1heCwgYW5kIGN1ciBmb3Ig
aW50ZXJydXB0IGhhbmRsaW5nICovCisJZnN0YXJ0ID0gKHJndm1vZGVjdGwgJiBNRU1NT0RFX0ZT
VEFSVF9NQVNLKSA+PgorCQlNRU1NT0RFX0ZTVEFSVF9TSElGVDsKKworCXZzdGFydCA9IChpbnRl
bF91bmNvcmVfcmVhZCh1bmNvcmUsIFBYVkZSRVEoZnN0YXJ0KSkgJgorCQkgIFBYVkZSRVFfUFhf
TUFTSykgPj4gUFhWRlJFUV9QWF9TSElGVDsKKworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUs
CisJCQkgICBNRU1JTlRSRU4sCisJCQkgICBNRU1JTlRfQ1hfU1VQUl9FTiB8IE1FTUlOVF9FVkFM
X0NIR19FTik7CisKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBWSURTVEFSVCwgdnN0YXJ0
KTsKKwlpbnRlbF91bmNvcmVfcG9zdGluZ19yZWFkKHVuY29yZSwgVklEU1RBUlQpOworCisJcmd2
bW9kZWN0bCB8PSBNRU1NT0RFX1NXTU9ERV9FTjsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3Jl
LCBNRU1NT0RFQ1RMLCByZ3Ztb2RlY3RsKTsKKworCWlmICh3YWl0X2Zvcl9hdG9taWMoKGludGVs
X3VuY29yZV9yZWFkKHVuY29yZSwgTUVNU1dDVEwpICYKKwkJCSAgICAgTUVNQ1RMX0NNRF9TVFMp
ID09IDAsIDEwKSkKKwkJRFJNX0VSUk9SKCJzdHVjayB0cnlpbmcgdG8gY2hhbmdlIHBlcmYgbW9k
ZVxuIik7CisJbWRlbGF5KDEpOworCisJZ2VuNV9ycHNfc2V0KHJwcywgcnBzLT5jdXJfZnJlcSk7
CisKKwlycHMtPmlwcy5sYXN0X2NvdW50MSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgRE1J
RUMpOworCXJwcy0+aXBzLmxhc3RfY291bnQxICs9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwg
RERSRUMpOworCXJwcy0+aXBzLmxhc3RfY291bnQxICs9IGludGVsX3VuY29yZV9yZWFkKHVuY29y
ZSwgQ1NJRUMpOworCXJwcy0+aXBzLmxhc3RfdGltZTEgPSBqaWZmaWVzX3RvX21zZWNzKGppZmZp
ZXMpOworCisJcnBzLT5pcHMubGFzdF9jb3VudDIgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IEdGWEVDKTsKKwlycHMtPmlwcy5sYXN0X3RpbWUyID0ga3RpbWVfZ2V0X3Jhd19ucygpOworCisJ
c3Bpbl91bmxvY2tfaXJxKCZtY2hkZXZfbG9jayk7CisKKwlycHMtPmlwcy5jb3JyID0gaW5pdF9l
bW9uKHVuY29yZSk7CisKKwlyZXR1cm4gdHJ1ZTsKK30KKworc3RhdGljIHZvaWQgZ2VuNV9ycHNf
ZGlzYWJsZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAq
dW5jb3JlID0gcnBzX3RvX3VuY29yZShycHMpOworCXUxNiByZ3Zzd2N0bDsKKworCXNwaW5fbG9j
a19pcnEoJm1jaGRldl9sb2NrKTsKKworCXJndnN3Y3RsID0gaW50ZWxfdW5jb3JlX3JlYWQxNih1
bmNvcmUsIE1FTVNXQ1RMKTsKKworCS8qIEFjayBpbnRlcnJ1cHRzLCBkaXNhYmxlIEVGQyBpbnRl
cnJ1cHQgKi8KKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBNRU1JTlRSRU4sCisJCQkgICBp
bnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIE1FTUlOVFJFTikgJgorCQkJICAgfk1FTUlOVF9FVkFM
X0NIR19FTik7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgTUVNSU5UUlNUUywgTUVNSU5U
X0VWQUxfQ0hHKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBERUlFUiwKKwkJCSAgIGlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgREVJRVIpICYgfkRFX1BDVV9FVkVOVCk7CisJaW50ZWxf
dW5jb3JlX3dyaXRlKHVuY29yZSwgREVJSVIsIERFX1BDVV9FVkVOVCk7CisJaW50ZWxfdW5jb3Jl
X3dyaXRlKHVuY29yZSwgREVJTVIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIERF
SU1SKSB8IERFX1BDVV9FVkVOVCk7CisKKwkvKiBHbyBiYWNrIHRvIHRoZSBzdGFydGluZyBmcmVx
dWVuY3kgKi8KKwlnZW41X3Jwc19zZXQocnBzLCBycHMtPmlkbGVfZnJlcSk7CisJbWRlbGF5KDEp
OworCXJndnN3Y3RsIHw9IE1FTUNUTF9DTURfU1RTOworCWludGVsX3VuY29yZV93cml0ZSh1bmNv
cmUsIE1FTVNXQ1RMLCByZ3Zzd2N0bCk7CisJbWRlbGF5KDEpOworCisJc3Bpbl91bmxvY2tfaXJx
KCZtY2hkZXZfbG9jayk7Cit9CisKK3N0YXRpYyB1MzIgcnBzX2xpbWl0cyhzdHJ1Y3QgaW50ZWxf
cnBzICpycHMsIHU4IHZhbCkKK3sKKwl1MzIgbGltaXRzOworCisJLyoKKwkgKiBPbmx5IHNldCB0
aGUgZG93biBsaW1pdCB3aGVuIHdlJ3ZlIHJlYWNoZWQgdGhlIGxvd2VzdCBsZXZlbCB0byBhdm9p
ZAorCSAqIGdldHRpbmcgbW9yZSBpbnRlcnJ1cHRzLCBvdGhlcndpc2UgbGVhdmUgdGhpcyBjbGVh
ci4gVGhpcyBwcmV2ZW50cyBhCisJICogcmFjZSBpbiB0aGUgaHcgd2hlbiBjb21pbmcgb3V0IG9m
IHJjNjogVGhlcmUncyBhIHRpbnkgd2luZG93IHdoZXJlCisJICogdGhlIGh3IHJ1bnMgYXQgdGhl
IG1pbmltYWwgY2xvY2sgYmVmb3JlIHNlbGVjdGluZyB0aGUgZGVzaXJlZAorCSAqIGZyZXF1ZW5j
eSwgaWYgdGhlIGRvd24gdGhyZXNob2xkIGV4cGlyZXMgaW4gdGhhdCB3aW5kb3cgd2Ugd2lsbCBu
b3QKKwkgKiByZWNlaXZlIGEgZG93biBpbnRlcnJ1cHQuCisJICovCisJaWYgKElOVEVMX0dFTihy
cHNfdG9faTkxNShycHMpKSA+PSA5KSB7CisJCWxpbWl0cyA9IHJwcy0+bWF4X2ZyZXFfc29mdGxp
bWl0IDw8IDIzOworCQlpZiAodmFsIDw9IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KQorCQkJbGlt
aXRzIHw9IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0IDw8IDE0OworCX0gZWxzZSB7CisJCWxpbWl0
cyA9IHJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0IDw8IDI0OworCQlpZiAodmFsIDw9IHJwcy0+bWlu
X2ZyZXFfc29mdGxpbWl0KQorCQkJbGltaXRzIHw9IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0IDw8
IDE2OworCX0KKworCXJldHVybiBsaW1pdHM7Cit9CisKK3N0YXRpYyB2b2lkIHJwc19zZXRfcG93
ZXIoc3RydWN0IGludGVsX3JwcyAqcnBzLCBpbnQgbmV3X3Bvd2VyKQoreworCXN0cnVjdCBpbnRl
bF91bmNvcmUgKnVuY29yZSA9IHJwc190b191bmNvcmUocnBzKTsKKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7CisJdTMyIHRocmVzaG9sZF91cCA9IDAs
IHRocmVzaG9sZF9kb3duID0gMDsgLyogaW4gJSAqLworCXUzMiBlaV91cCA9IDAsIGVpX2Rvd24g
PSAwOworCisJbG9ja2RlcF9hc3NlcnRfaGVsZCgmcnBzLT5wb3dlci5tdXRleCk7CisKKwlpZiAo
bmV3X3Bvd2VyID09IHJwcy0+cG93ZXIubW9kZSkKKwkJcmV0dXJuOworCisJLyogTm90ZSB0aGUg
dW5pdHMgaGVyZSBhcmUgbm90IGV4YWN0bHkgMXVzLCBidXQgMTI4MG5zLiAqLworCXN3aXRjaCAo
bmV3X3Bvd2VyKSB7CisJY2FzZSBMT1dfUE9XRVI6CisJCS8qIFVwY2xvY2sgaWYgbW9yZSB0aGFu
IDk1JSBidXN5IG92ZXIgMTZtcyAqLworCQllaV91cCA9IDE2MDAwOworCQl0aHJlc2hvbGRfdXAg
PSA5NTsKKworCQkvKiBEb3duY2xvY2sgaWYgbGVzcyB0aGFuIDg1JSBidXN5IG92ZXIgMzJtcyAq
LworCQllaV9kb3duID0gMzIwMDA7CisJCXRocmVzaG9sZF9kb3duID0gODU7CisJCWJyZWFrOwor
CisJY2FzZSBCRVRXRUVOOgorCQkvKiBVcGNsb2NrIGlmIG1vcmUgdGhhbiA5MCUgYnVzeSBvdmVy
IDEzbXMgKi8KKwkJZWlfdXAgPSAxMzAwMDsKKwkJdGhyZXNob2xkX3VwID0gOTA7CisKKwkJLyog
RG93bmNsb2NrIGlmIGxlc3MgdGhhbiA3NSUgYnVzeSBvdmVyIDMybXMgKi8KKwkJZWlfZG93biA9
IDMyMDAwOworCQl0aHJlc2hvbGRfZG93biA9IDc1OworCQlicmVhazsKKworCWNhc2UgSElHSF9Q
T1dFUjoKKwkJLyogVXBjbG9jayBpZiBtb3JlIHRoYW4gODUlIGJ1c3kgb3ZlciAxMG1zICovCisJ
CWVpX3VwID0gMTAwMDA7CisJCXRocmVzaG9sZF91cCA9IDg1OworCisJCS8qIERvd25jbG9jayBp
ZiBsZXNzIHRoYW4gNjAlIGJ1c3kgb3ZlciAzMm1zICovCisJCWVpX2Rvd24gPSAzMjAwMDsKKwkJ
dGhyZXNob2xkX2Rvd24gPSA2MDsKKwkJYnJlYWs7CisJfQorCisJLyogV2hlbiBieXQgY2FuIHN1
cnZpdmUgd2l0aG91dCBzeXN0ZW0gaGFuZyB3aXRoIGR5bmFtaWMKKwkgKiBzdyBmcmVxIGFkanVz
dG1lbnRzLCB0aGlzIHJlc3RyaWN0aW9uIGNhbiBiZSBsaWZ0ZWQuCisJICovCisJaWYgKElTX1ZB
TExFWVZJRVcoaTkxNSkpCisJCWdvdG8gc2tpcF9od193cml0ZTsKKworCWludGVsX3VuY29yZV93
cml0ZSh1bmNvcmUsIEdFTjZfUlBfVVBfRUksCisJCQkgICBHVF9JTlRFUlZBTF9GUk9NX1VTKGk5
MTUsIGVpX3VwKSk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VONl9SUF9VUF9USFJF
U0hPTEQsCisJCQkgICBHVF9JTlRFUlZBTF9GUk9NX1VTKGk5MTUsCisJCQkJCSAgICAgICBlaV91
cCAqIHRocmVzaG9sZF91cCAvIDEwMCkpOworCisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwg
R0VONl9SUF9ET1dOX0VJLAorCQkJICAgR1RfSU5URVJWQUxfRlJPTV9VUyhpOTE1LCBlaV9kb3du
KSk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VONl9SUF9ET1dOX1RIUkVTSE9MRCwK
KwkJCSAgIEdUX0lOVEVSVkFMX0ZST01fVVMoaTkxNSwKKwkJCQkJICAgICAgIGVpX2Rvd24gKiB0
aHJlc2hvbGRfZG93biAvIDEwMCkpOworCisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VO
Nl9SUF9DT05UUk9MLAorCQkJICAgKElOVEVMX0dFTihpOTE1KSA+IDkgPyAwIDogR0VONl9SUF9N
RURJQV9UVVJCTykgfAorCQkJICAgR0VONl9SUF9NRURJQV9IV19OT1JNQUxfTU9ERSB8CisJCQkg
ICBHRU42X1JQX01FRElBX0lTX0dGWCB8CisJCQkgICBHRU42X1JQX0VOQUJMRSB8CisJCQkgICBH
RU42X1JQX1VQX0JVU1lfQVZHIHwKKwkJCSAgIEdFTjZfUlBfRE9XTl9JRExFX0FWRyk7CisKK3Nr
aXBfaHdfd3JpdGU6CisJcnBzLT5wb3dlci5tb2RlID0gbmV3X3Bvd2VyOworCXJwcy0+cG93ZXIu
dXBfdGhyZXNob2xkID0gdGhyZXNob2xkX3VwOworCXJwcy0+cG93ZXIuZG93bl90aHJlc2hvbGQg
PSB0aHJlc2hvbGRfZG93bjsKK30KKworc3RhdGljIHZvaWQgZ2VuNl9ycHNfc2V0X3RocmVzaG9s
ZHMoc3RydWN0IGludGVsX3JwcyAqcnBzLCB1OCB2YWwpCit7CisJaW50IG5ld19wb3dlcjsKKwor
CW5ld19wb3dlciA9IHJwcy0+cG93ZXIubW9kZTsKKwlzd2l0Y2ggKHJwcy0+cG93ZXIubW9kZSkg
eworCWNhc2UgTE9XX1BPV0VSOgorCQlpZiAodmFsID4gcnBzLT5lZmZpY2llbnRfZnJlcSArIDEg
JiYKKwkJICAgIHZhbCA+IHJwcy0+Y3VyX2ZyZXEpCisJCQluZXdfcG93ZXIgPSBCRVRXRUVOOwor
CQlicmVhazsKKworCWNhc2UgQkVUV0VFTjoKKwkJaWYgKHZhbCA8PSBycHMtPmVmZmljaWVudF9m
cmVxICYmCisJCSAgICB2YWwgPCBycHMtPmN1cl9mcmVxKQorCQkJbmV3X3Bvd2VyID0gTE9XX1BP
V0VSOworCQllbHNlIGlmICh2YWwgPj0gcnBzLT5ycDBfZnJlcSAmJgorCQkJIHZhbCA+IHJwcy0+
Y3VyX2ZyZXEpCisJCQluZXdfcG93ZXIgPSBISUdIX1BPV0VSOworCQlicmVhazsKKworCWNhc2Ug
SElHSF9QT1dFUjoKKwkJaWYgKHZhbCA8IChycHMtPnJwMV9mcmVxICsgcnBzLT5ycDBfZnJlcSkg
Pj4gMSAmJgorCQkgICAgdmFsIDwgcnBzLT5jdXJfZnJlcSkKKwkJCW5ld19wb3dlciA9IEJFVFdF
RU47CisJCWJyZWFrOworCX0KKwkvKiBNYXgvbWluIGJpbnMgYXJlIHNwZWNpYWwgKi8KKwlpZiAo
dmFsIDw9IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KQorCQluZXdfcG93ZXIgPSBMT1dfUE9XRVI7
CisJaWYgKHZhbCA+PSBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCkKKwkJbmV3X3Bvd2VyID0gSElH
SF9QT1dFUjsKKworCW11dGV4X2xvY2soJnJwcy0+cG93ZXIubXV0ZXgpOworCWlmIChycHMtPnBv
d2VyLmludGVyYWN0aXZlKQorCQluZXdfcG93ZXIgPSBISUdIX1BPV0VSOworCXJwc19zZXRfcG93
ZXIocnBzLCBuZXdfcG93ZXIpOworCW11dGV4X3VubG9jaygmcnBzLT5wb3dlci5tdXRleCk7Cit9
CisKK3ZvaWQgaW50ZWxfcnBzX21hcmtfaW50ZXJhY3RpdmUoc3RydWN0IGludGVsX3JwcyAqcnBz
LCBib29sIGludGVyYWN0aXZlKQoreworCWlmICghcnBzLT5lbmFibGVkKQorCQlyZXR1cm47CisK
KwltdXRleF9sb2NrKCZycHMtPnBvd2VyLm11dGV4KTsKKwlpZiAoaW50ZXJhY3RpdmUpIHsKKwkJ
aWYgKCFycHMtPnBvd2VyLmludGVyYWN0aXZlKysgJiYgcnBzLT5hY3RpdmUpCisJCQlycHNfc2V0
X3Bvd2VyKHJwcywgSElHSF9QT1dFUik7CisJfSBlbHNlIHsKKwkJR0VNX0JVR19PTighcnBzLT5w
b3dlci5pbnRlcmFjdGl2ZSk7CisJCXJwcy0+cG93ZXIuaW50ZXJhY3RpdmUtLTsKKwl9CisJbXV0
ZXhfdW5sb2NrKCZycHMtPnBvd2VyLm11dGV4KTsKK30KKworc3RhdGljIGludCBnZW42X3Jwc19z
ZXQoc3RydWN0IGludGVsX3JwcyAqcnBzLCB1OCB2YWwpCit7CisJc3RydWN0IGludGVsX3VuY29y
ZSAqdW5jb3JlID0gcnBzX3RvX3VuY29yZShycHMpOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKwl1MzIgc3dyZXE7CisKKwlpZiAoSU5URUxfR0VO
KGk5MTUpID49IDkpCisJCXN3cmVxID0gR0VOOV9GUkVRVUVOQ1kodmFsKTsKKwllbHNlIGlmIChJ
U19IQVNXRUxMKGk5MTUpIHx8IElTX0JST0FEV0VMTChpOTE1KSkKKwkJc3dyZXEgPSBIU1dfRlJF
UVVFTkNZKHZhbCk7CisJZWxzZQorCQlzd3JlcSA9IChHRU42X0ZSRVFVRU5DWSh2YWwpIHwKKwkJ
CSBHRU42X09GRlNFVCgwKSB8CisJCQkgR0VONl9BR0dSRVNTSVZFX1RVUkJPKTsKKwlpbnRlbF91
bmNvcmVfd3JpdGUodW5jb3JlLCBHRU42X1JQTlNXUkVRLCBzd3JlcSk7CisKKwlyZXR1cm4gMDsK
K30KKworc3RhdGljIGludCB2bHZfcnBzX3NldChzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIHU4IHZh
bCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7
CisJaW50IGVycjsKKworCXZsdl9wdW5pdF9nZXQoaTkxNSk7CisJZXJyID0gdmx2X3B1bml0X3dy
aXRlKGk5MTUsIFBVTklUX1JFR19HUFVfRlJFUV9SRVEsIHZhbCk7CisJdmx2X3B1bml0X3B1dChp
OTE1KTsKKworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgcnBzX3NldChzdHJ1Y3QgaW50
ZWxfcnBzICpycHMsIHU4IHZhbCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHJwc190b19pOTE1KHJwcyk7CisJaW50IGVycjsKKworCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA2
KQorCQlyZXR1cm4gMDsKKworCWlmICh2YWwgPT0gcnBzLT5sYXN0X2ZyZXEpCisJCXJldHVybiAw
OworCisJaWYgKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkKKwkJ
ZXJyID0gdmx2X3Jwc19zZXQocnBzLCB2YWwpOworCWVsc2UKKwkJZXJyID0gZ2VuNl9ycHNfc2V0
KHJwcywgdmFsKTsKKwlpZiAoZXJyKQorCQlyZXR1cm4gZXJyOworCisJZ2VuNl9ycHNfc2V0X3Ro
cmVzaG9sZHMocnBzLCB2YWwpOworCXJwcy0+bGFzdF9mcmVxID0gdmFsOworCisJcmV0dXJuIDA7
Cit9CisKK3ZvaWQgaW50ZWxfcnBzX3VucGFyayhzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJ
dTggZnJlcTsKKworCWlmICghcnBzLT5lbmFibGVkKQorCQlyZXR1cm47CisKKwkvKgorCSAqIFVz
ZSB0aGUgdXNlcidzIGRlc2lyZWQgZnJlcXVlbmN5IGFzIGEgZ3VpZGUsIGJ1dCBmb3IgYmV0dGVy
CisJICogcGVyZm9ybWFuY2UsIGp1bXAgZGlyZWN0bHkgdG8gUlBlIGFzIG91ciBzdGFydGluZyBm
cmVxdWVuY3kuCisJICovCisJbXV0ZXhfbG9jaygmcnBzLT5sb2NrKTsKKwlycHMtPmFjdGl2ZSA9
IHRydWU7CisJZnJlcSA9IG1heChycHMtPmN1cl9mcmVxLCBycHMtPmVmZmljaWVudF9mcmVxKSwK
KwlmcmVxID0gY2xhbXAoZnJlcSwgcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQsIHJwcy0+bWF4X2Zy
ZXFfc29mdGxpbWl0KTsKKwlpbnRlbF9ycHNfc2V0KHJwcywgZnJlcSk7CisJcnBzLT5sYXN0X2Fk
aiA9IDA7CisJbXV0ZXhfdW5sb2NrKCZycHMtPmxvY2spOworCisJaWYgKElOVEVMX0dFTihycHNf
dG9faTkxNShycHMpKSA+PSA2KQorCQlycHNfZW5hYmxlX2ludGVycnVwdHMocnBzKTsKKworCWlm
IChJU19HRU4ocnBzX3RvX2k5MTUocnBzKSwgNSkpCisJCWdlbjVfcnBzX3VwZGF0ZShycHMpOwor
fQorCit2b2lkIGludGVsX3Jwc19wYXJrKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7CisKKwlpZiAoIXJw
cy0+ZW5hYmxlZCkKKwkJcmV0dXJuOworCisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQorCQly
cHNfZGlzYWJsZV9pbnRlcnJ1cHRzKHJwcyk7CisKKwlycHMtPmFjdGl2ZSA9IGZhbHNlOworCWlm
IChycHMtPmxhc3RfZnJlcSA8PSBycHMtPmlkbGVfZnJlcSkKKwkJcmV0dXJuOworCisJLyoKKwkg
KiBUaGUgcHVuaXQgZGVsYXlzIHRoZSB3cml0ZSBvZiB0aGUgZnJlcXVlbmN5IGFuZCB2b2x0YWdl
IHVudGlsIGl0CisJICogZGV0ZXJtaW5lcyB0aGUgR1BVIGlzIGF3YWtlLiBEdXJpbmcgbm9ybWFs
IHVzYWdlIHdlIGRvbid0IHdhbnQgdG8KKwkgKiB3YXN0ZSBwb3dlciBjaGFuZ2luZyB0aGUgZnJl
cXVlbmN5IGlmIHRoZSBHUFUgaXMgc2xlZXBpbmcgKHJjNikuCisJICogSG93ZXZlciwgdGhlIEdQ
VSBhbmQgZHJpdmVyIGlzIG5vdyBpZGxlIGFuZCB3ZSBkbyBub3Qgd2FudCB0byBkZWxheQorCSAq
IHN3aXRjaGluZyB0byBtaW5pbXVtIHZvbHRhZ2UgKHJlZHVjaW5nIHBvd2VyIHdoaWxzdCBpZGxl
KSBhcyB3ZSBkbworCSAqIG5vdCBleHBlY3QgdG8gYmUgd29rZW4gaW4gdGhlIG5lYXIgZnV0dXJl
IGFuZCBzbyBtdXN0IGZsdXNoIHRoZQorCSAqIGNoYW5nZSBieSB3YWtpbmcgdGhlIGRldmljZS4K
KwkgKgorCSAqIFdlIGNob29zZSB0byB0YWtlIHRoZSBtZWRpYSBwb3dlcndlbGwgKGVpdGhlciB3
b3VsZCBkbyB0byB0cmljayB0aGUKKwkgKiBwdW5pdCBpbnRvIGNvbW1pdHRpbmcgdGhlIHZvbHRh
Z2UgY2hhbmdlKSBhcyB0aGF0IHRha2VzIGEgbG90IGxlc3MKKwkgKiBwb3dlciB0aGFuIHRoZSBy
ZW5kZXIgcG93ZXJ3ZWxsLgorCSAqLworCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KHJwc190
b191bmNvcmUocnBzKSwgRk9SQ0VXQUtFX01FRElBKTsKKwlycHNfc2V0KHJwcywgcnBzLT5pZGxl
X2ZyZXEpOworCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KHJwc190b191bmNvcmUocnBzKSwg
Rk9SQ0VXQUtFX01FRElBKTsKK30KKwordm9pZCBpbnRlbF9ycHNfYm9vc3Qoc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEpCit7CisJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJnJxLT5lbmdpbmUtPmd0
LT5ycHM7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKworCWlmIChpOTE1X3JlcXVlc3Rfc2lnbmFs
ZWQocnEpIHx8ICFycHMtPmFjdGl2ZSkKKwkJcmV0dXJuOworCisJLyogU2VyaWFsaXplcyB3aXRo
IGk5MTVfcmVxdWVzdF9yZXRpcmUoKSAqLworCXNwaW5fbG9ja19pcnFzYXZlKCZycS0+bG9jaywg
ZmxhZ3MpOworCWlmICghaTkxNV9yZXF1ZXN0X2hhc193YWl0Ym9vc3QocnEpICYmCisJICAgICFk
bWFfZmVuY2VfaXNfc2lnbmFsZWRfbG9ja2VkKCZycS0+ZmVuY2UpKSB7CisJCXJxLT5mbGFncyB8
PSBJOTE1X1JFUVVFU1RfV0FJVEJPT1NUOworCisJCWlmICghYXRvbWljX2ZldGNoX2luYygmcnBz
LT5udW1fd2FpdGVycykgJiYKKwkJICAgIFJFQURfT05DRShycHMtPmN1cl9mcmVxKSA8IHJwcy0+
Ym9vc3RfZnJlcSkKKwkJCXNjaGVkdWxlX3dvcmsoJnJwcy0+d29yayk7CisKKwkJYXRvbWljX2lu
YygmcnBzLT5ib29zdHMpOworCX0KKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZycS0+bG9jaywg
ZmxhZ3MpOworfQorCitpbnQgaW50ZWxfcnBzX3NldChzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIHU4
IHZhbCkKK3sKKwlpbnQgZXJyID0gMDsKKworCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnJwcy0+bG9j
ayk7CisJR0VNX0JVR19PTih2YWwgPiBycHMtPm1heF9mcmVxKTsKKwlHRU1fQlVHX09OKHZhbCA8
IHJwcy0+bWluX2ZyZXEpOworCisJaWYgKHJwcy0+YWN0aXZlKSB7CisJCWVyciA9IHJwc19zZXQo
cnBzLCB2YWwpOworCisJCS8qCisJCSAqIE1ha2Ugc3VyZSB3ZSBjb250aW51ZSB0byBnZXQgaW50
ZXJydXB0cworCQkgKiB1bnRpbCB3ZSBoaXQgdGhlIG1pbmltdW0gb3IgbWF4aW11bSBmcmVxdWVu
Y2llcy4KKwkJICovCisJCWlmIChJTlRFTF9HRU4ocnBzX3RvX2k5MTUocnBzKSkgPj0gNikgewor
CQkJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcnBzX3RvX3VuY29yZShycHMpOworCisJ
CQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU42X1JQX0lOVEVSUlVQVF9MSU1JVFMsCisJ
CQkJCSAgIHJwc19saW1pdHMocnBzLCB2YWwpKTsKKworCQkJaW50ZWxfdW5jb3JlX3dyaXRlKHVu
Y29yZSwgR0VONl9QTUlOVFJNU0ssCisJCQkJCSAgIHJwc19wbV9tYXNrKHJwcywgdmFsKSk7CisJ
CX0KKwl9CisKKwlpZiAoZXJyID09IDApCisJCXJwcy0+Y3VyX2ZyZXEgPSB2YWw7CisKKwlyZXR1
cm4gZXJyOworfQorCitzdGF0aWMgdm9pZCBnZW42X3Jwc19pbml0KHN0cnVjdCBpbnRlbF9ycHMg
KnJwcykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJwc190b19pOTE1KHJw
cyk7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcnBzX3RvX3VuY29yZShycHMpOwor
CisJLyogQWxsIG9mIHRoZXNlIHZhbHVlcyBhcmUgaW4gdW5pdHMgb2YgNTBNSHogKi8KKworCS8q
IHN0YXRpYyB2YWx1ZXMgZnJvbSBIVzogUlAwID4gUlAxID4gUlBuIChtaW5fZnJlcSkgKi8KKwlp
ZiAoSVNfR0VOOV9MUChpOTE1KSkgeworCQl1MzIgcnBfc3RhdGVfY2FwID0gaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBCWFRfUlBfU1RBVEVfQ0FQKTsKKworCQlycHMtPnJwMF9mcmVxID0gKHJw
X3N0YXRlX2NhcCA+PiAxNikgJiAweGZmOworCQlycHMtPnJwMV9mcmVxID0gKHJwX3N0YXRlX2Nh
cCA+PiAgOCkgJiAweGZmOworCQlycHMtPm1pbl9mcmVxID0gKHJwX3N0YXRlX2NhcCA+PiAgMCkg
JiAweGZmOworCX0gZWxzZSB7CisJCXUzMiBycF9zdGF0ZV9jYXAgPSBpbnRlbF91bmNvcmVfcmVh
ZCh1bmNvcmUsIEdFTjZfUlBfU1RBVEVfQ0FQKTsKKworCQlycHMtPnJwMF9mcmVxID0gKHJwX3N0
YXRlX2NhcCA+PiAgMCkgJiAweGZmOworCQlycHMtPnJwMV9mcmVxID0gKHJwX3N0YXRlX2NhcCA+
PiAgOCkgJiAweGZmOworCQlycHMtPm1pbl9mcmVxID0gKHJwX3N0YXRlX2NhcCA+PiAxNikgJiAw
eGZmOworCX0KKworCS8qIGh3X21heCA9IFJQMCB1bnRpbCB3ZSBjaGVjayBmb3Igb3ZlcmNsb2Nr
aW5nICovCisJcnBzLT5tYXhfZnJlcSA9IHJwcy0+cnAwX2ZyZXE7CisKKwlycHMtPmVmZmljaWVu
dF9mcmVxID0gcnBzLT5ycDFfZnJlcTsKKwlpZiAoSVNfSEFTV0VMTChpOTE1KSB8fCBJU19CUk9B
RFdFTEwoaTkxNSkgfHwKKwkgICAgSVNfR0VOOV9CQyhpOTE1KSB8fCBJTlRFTF9HRU4oaTkxNSkg
Pj0gMTApIHsKKwkJdTMyIGRkY2Nfc3RhdHVzID0gMDsKKworCQlpZiAoc2FuZHlicmlkZ2VfcGNv
ZGVfcmVhZChpOTE1LAorCQkJCQkgICBIU1dfUENPREVfRFlOQU1JQ19EVVRZX0NZQ0xFX0NPTlRS
T0wsCisJCQkJCSAgICZkZGNjX3N0YXR1cywgTlVMTCkgPT0gMCkKKwkJCXJwcy0+ZWZmaWNpZW50
X2ZyZXEgPQorCQkJCWNsYW1wX3QodTgsCisJCQkJCShkZGNjX3N0YXR1cyA+PiA4KSAmIDB4ZmYs
CisJCQkJCXJwcy0+bWluX2ZyZXEsCisJCQkJCXJwcy0+bWF4X2ZyZXEpOworCX0KKworCWlmIChJ
U19HRU45X0JDKGk5MTUpIHx8IElOVEVMX0dFTihpOTE1KSA+PSAxMCkgeworCQkvKiBTdG9yZSB0
aGUgZnJlcXVlbmN5IHZhbHVlcyBpbiAxNi42NiBNSFogdW5pdHMsIHdoaWNoIGlzCisJCSAqIHRo
ZSBuYXR1cmFsIGhhcmR3YXJlIHVuaXQgZm9yIFNLTAorCQkgKi8KKwkJcnBzLT5ycDBfZnJlcSAq
PSBHRU45X0ZSRVFfU0NBTEVSOworCQlycHMtPnJwMV9mcmVxICo9IEdFTjlfRlJFUV9TQ0FMRVI7
CisJCXJwcy0+bWluX2ZyZXEgKj0gR0VOOV9GUkVRX1NDQUxFUjsKKwkJcnBzLT5tYXhfZnJlcSAq
PSBHRU45X0ZSRVFfU0NBTEVSOworCQlycHMtPmVmZmljaWVudF9mcmVxICo9IEdFTjlfRlJFUV9T
Q0FMRVI7CisJfQorfQorCitzdGF0aWMgYm9vbCBycHNfcmVzZXQoc3RydWN0IGludGVsX3JwcyAq
cnBzKQoreworCS8qIGZvcmNlIGEgcmVzZXQgKi8KKwlycHMtPnBvd2VyLm1vZGUgPSAtMTsKKwly
cHMtPmxhc3RfZnJlcSA9IC0xOworCisJaWYgKHJwc19zZXQocnBzLCBycHMtPm1pbl9mcmVxKSkg
eworCQlEUk1fRVJST1IoIkZhaWxlZCB0byByZXNldCBSUFMgdG8gaW5pdGlhbCB2YWx1ZXNcbiIp
OworCQlyZXR1cm4gZmFsc2U7CisJfQorCisJcnBzLT5jdXJfZnJlcSA9IHJwcy0+bWluX2ZyZXE7
CisJcmV0dXJuIHRydWU7Cit9CisKKy8qIFNlZSB0aGUgR2VuOV9HVF9QTV9Qcm9ncmFtbWluZ19H
dWlkZSBkb2MgZm9yIHRoZSBiZWxvdyAqLworc3RhdGljIGJvb2wgZ2VuOV9ycHNfZW5hYmxlKHN0
cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHJwc190b19pOTE1KHJwcyk7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcnBzX3Rv
X3VuY29yZShycHMpOworCisJLyogUHJvZ3JhbSBkZWZhdWx0cyBhbmQgdGhyZXNob2xkcyBmb3Ig
UlBTICovCisJaWYgKElTX0dFTihpOTE1LCA5KSkKKwkJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVu
Y29yZSwgR0VONl9SQ19WSURFT19GUkVRLAorCQkJCSAgICAgIEdFTjlfRlJFUVVFTkNZKHJwcy0+
cnAxX2ZyZXEpKTsKKworCS8qIDEgc2Vjb25kIHRpbWVvdXQgKi8KKwlpbnRlbF91bmNvcmVfd3Jp
dGVfZncodW5jb3JlLCBHRU42X1JQX0RPV05fVElNRU9VVCwKKwkJCSAgICAgIEdUX0lOVEVSVkFM
X0ZST01fVVMoaTkxNSwgMTAwMDAwMCkpOworCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29y
ZSwgR0VONl9SUF9JRExFX0hZU1RFUlNJUywgMHhhKTsKKworCXJldHVybiBycHNfcmVzZXQocnBz
KTsKK30KKworc3RhdGljIGJvb2wgZ2VuOF9ycHNfZW5hYmxlKHN0cnVjdCBpbnRlbF9ycHMgKnJw
cykKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBycHNfdG9fdW5jb3JlKHJwcyk7
CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JDX1ZJREVPX0ZSRVEsCisJ
CQkgICAgICBIU1dfRlJFUVVFTkNZKHJwcy0+cnAxX2ZyZXEpKTsKKworCS8qIE5COiBEb2NzIHNh
eSAxcywgYW5kIDEwMDAwMDAgLSB3aGljaCBhcmVuJ3QgZXF1aXZhbGVudCAqLworCWludGVsX3Vu
Y29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUlBfRE9XTl9USU1FT1VULAorCQkJICAgICAgMTAw
MDAwMDAwIC8gMTI4KTsgLyogMSBzZWNvbmQgdGltZW91dCAqLworCisJaW50ZWxfdW5jb3JlX3dy
aXRlX2Z3KHVuY29yZSwgR0VONl9SUF9JRExFX0hZU1RFUlNJUywgMTApOworCisJcmV0dXJuIHJw
c19yZXNldChycHMpOworfQorCitzdGF0aWMgYm9vbCBnZW42X3Jwc19lbmFibGUoc3RydWN0IGlu
dGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJwc190b191
bmNvcmUocnBzKTsKKworCS8qIFBvd2VyIGRvd24gaWYgY29tcGxldGVseSBpZGxlIGZvciBvdmVy
IDUwbXMgKi8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JQX0RPV05fVElN
RU9VVCwgNTAwMDApOworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUlBfSURM
RV9IWVNURVJTSVMsIDEwKTsKKworCXJldHVybiBycHNfcmVzZXQocnBzKTsKK30KKworc3RhdGlj
IGludCBjaHZfcnBzX21heF9mcmVxKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7CisJdTMyIHZhbDsKKwor
CXZhbCA9IHZsdl9wdW5pdF9yZWFkKGk5MTUsIEZCX0dGWF9GTUFYX0FUX1ZNQVhfRlVTRSk7CisK
Kwlzd2l0Y2ggKFJVTlRJTUVfSU5GTyhpOTE1KS0+c3NldS5ldV90b3RhbCkgeworCWNhc2UgODoK
KwkJLyogKDIgKiA0KSBjb25maWcgKi8KKwkJdmFsID4+PSBGQl9HRlhfRk1BWF9BVF9WTUFYXzJT
UzRFVV9GVVNFX1NISUZUOworCQlicmVhazsKKwljYXNlIDEyOgorCQkvKiAoMiAqIDYpIGNvbmZp
ZyAqLworCQl2YWwgPj49IEZCX0dGWF9GTUFYX0FUX1ZNQVhfMlNTNkVVX0ZVU0VfU0hJRlQ7CisJ
CWJyZWFrOworCWNhc2UgMTY6CisJCS8qICgyICogOCkgY29uZmlnICovCisJZGVmYXVsdDoKKwkJ
LyogU2V0dGluZyAoMiAqIDgpIE1pbiBSUDAgZm9yIGFueSBvdGhlciBjb21iaW5hdGlvbiAqLwor
CQl2YWwgPj49IEZCX0dGWF9GTUFYX0FUX1ZNQVhfMlNTOEVVX0ZVU0VfU0hJRlQ7CisJCWJyZWFr
OworCX0KKworCXJldHVybiB2YWwgJiBGQl9HRlhfRlJFUV9GVVNFX01BU0s7Cit9CisKK3N0YXRp
YyBpbnQgY2h2X3Jwc19ycGVfZnJlcShzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOworCXUzMiB2YWw7CisK
Kwl2YWwgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9HUFVfRFVUWUNZQ0xFX1JFRyk7CisJ
dmFsID4+PSBQVU5JVF9HUFVfRFVUWUNZQ0xFX1JQRV9GUkVRX1NISUZUOworCisJcmV0dXJuIHZh
bCAmIFBVTklUX0dQVV9EVVRZQ1lDTEVfUlBFX0ZSRVFfTUFTSzsKK30KKworc3RhdGljIGludCBj
aHZfcnBzX2d1YXJfZnJlcShzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOworCXUzMiB2YWw7CisKKwl2YWwg
PSB2bHZfcHVuaXRfcmVhZChpOTE1LCBGQl9HRlhfRk1BWF9BVF9WTUFYX0ZVU0UpOworCisJcmV0
dXJuIHZhbCAmIEZCX0dGWF9GUkVRX0ZVU0VfTUFTSzsKK30KKworc3RhdGljIHUzMiBjaHZfcnBz
X21pbl9mcmVxKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7CisJdTMyIHZhbDsKKworCXZhbCA9IHZsdl9w
dW5pdF9yZWFkKGk5MTUsIEZCX0dGWF9GTUlOX0FUX1ZNSU5fRlVTRSk7CisJdmFsID4+PSBGQl9H
RlhfRk1JTl9BVF9WTUlOX0ZVU0VfU0hJRlQ7CisKKwlyZXR1cm4gdmFsICYgRkJfR0ZYX0ZSRVFf
RlVTRV9NQVNLOworfQorCitzdGF0aWMgYm9vbCBjaHZfcnBzX2VuYWJsZShzdHJ1Y3QgaW50ZWxf
cnBzICpycHMpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcnBzX3RvX3VuY29y
ZShycHMpOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcnBzX3RvX2k5MTUocnBz
KTsKKwl1MzIgdmFsOworCisJLyogMTogUHJvZ3JhbSBkZWZhdWx0cyBhbmQgdGhyZXNob2xkcyBm
b3IgUlBTKi8KKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42X1JQX0RPV05fVElN
RU9VVCwgMTAwMDAwMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SUF9V
UF9USFJFU0hPTEQsIDU5NDAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3JlLCBHRU42
X1JQX0RPV05fVEhSRVNIT0xELCAyNDUwMDApOworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNv
cmUsIEdFTjZfUlBfVVBfRUksIDY2MDAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3Jl
LCBHRU42X1JQX0RPV05fRUksIDM1MDAwMCk7CisKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5j
b3JlLCBHRU42X1JQX0lETEVfSFlTVEVSU0lTLCAxMCk7CisKKwkvKiAyOiBFbmFibGUgUlBTICov
CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SUF9DT05UUk9MLAorCQkJICAg
ICAgR0VONl9SUF9NRURJQV9IV19OT1JNQUxfTU9ERSB8CisJCQkgICAgICBHRU42X1JQX01FRElB
X0lTX0dGWCB8CisJCQkgICAgICBHRU42X1JQX0VOQUJMRSB8CisJCQkgICAgICBHRU42X1JQX1VQ
X0JVU1lfQVZHIHwKKwkJCSAgICAgIEdFTjZfUlBfRE9XTl9JRExFX0FWRyk7CisKKwkvKiBTZXR0
aW5nIEZpeGVkIEJpYXMgKi8KKwl2bHZfcHVuaXRfZ2V0KGk5MTUpOworCisJdmFsID0gVkxWX09W
RVJSSURFX0VOIHwgVkxWX1NPQ19URFBfRU4gfCBDSFZfQklBU19DUFVfNTBfU09DXzUwOworCXZs
dl9wdW5pdF93cml0ZShpOTE1LCBWTFZfVFVSQk9fU09DX09WRVJSSURFLCB2YWwpOworCisJdmFs
ID0gdmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRfUkVHX0dQVV9GUkVRX1NUUyk7CisKKwl2bHZf
cHVuaXRfcHV0KGk5MTUpOworCisJLyogUlBTIGNvZGUgYXNzdW1lcyBHUExMIGlzIHVzZWQgKi8K
KwlXQVJOX09OQ0UoKHZhbCAmIEdQTExFTkFCTEUpID09IDAsICJHUExMIG5vdCBlbmFibGVkXG4i
KTsKKworCURSTV9ERUJVR19EUklWRVIoIkdQTEwgZW5hYmxlZD8gJXNcbiIsIHllc25vKHZhbCAm
IEdQTExFTkFCTEUpKTsKKwlEUk1fREVCVUdfRFJJVkVSKCJHUFUgc3RhdHVzOiAweCUwOHhcbiIs
IHZhbCk7CisKKwlyZXR1cm4gcnBzX3Jlc2V0KHJwcyk7Cit9CisKK3N0YXRpYyBpbnQgdmx2X3Jw
c19ndWFyX2ZyZXEoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKwl1MzIgdmFsLCBycDE7CisKKwl2YWwg
PSB2bHZfbmNfcmVhZChpOTE1LCBJT1NGX05DX0ZCX0dGWF9GUkVRX0ZVU0UpOworCisJcnAxID0g
dmFsICYgRkJfR0ZYX0ZHVUFSQU5URUVEX0ZSRVFfRlVTRV9NQVNLOworCXJwMSA+Pj0gRkJfR0ZY
X0ZHVUFSQU5URUVEX0ZSRVFfRlVTRV9TSElGVDsKKworCXJldHVybiBycDE7Cit9CisKK3N0YXRp
YyBpbnQgdmx2X3Jwc19tYXhfZnJlcShzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOworCXUzMiB2YWwsIHJw
MDsKKworCXZhbCA9IHZsdl9uY19yZWFkKGk5MTUsIElPU0ZfTkNfRkJfR0ZYX0ZSRVFfRlVTRSk7
CisKKwlycDAgPSAodmFsICYgRkJfR0ZYX01BWF9GUkVRX0ZVU0VfTUFTSykgPj4gRkJfR0ZYX01B
WF9GUkVRX0ZVU0VfU0hJRlQ7CisJLyogQ2xhbXAgdG8gbWF4ICovCisJcnAwID0gbWluX3QodTMy
LCBycDAsIDB4ZWEpOworCisJcmV0dXJuIHJwMDsKK30KKworc3RhdGljIGludCB2bHZfcnBzX3Jw
ZV9mcmVxKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7CisJdTMyIHZhbCwgcnBlOworCisJdmFsID0gdmx2
X25jX3JlYWQoaTkxNSwgSU9TRl9OQ19GQl9HRlhfRk1BWF9GVVNFX0xPKTsKKwlycGUgPSAodmFs
ICYgRkJfRk1BWF9WTUlOX0ZSRVFfTE9fTUFTSykgPj4gRkJfRk1BWF9WTUlOX0ZSRVFfTE9fU0hJ
RlQ7CisJdmFsID0gdmx2X25jX3JlYWQoaTkxNSwgSU9TRl9OQ19GQl9HRlhfRk1BWF9GVVNFX0hJ
KTsKKwlycGUgfD0gKHZhbCAmIEZCX0ZNQVhfVk1JTl9GUkVRX0hJX01BU0spIDw8IDU7CisKKwly
ZXR1cm4gcnBlOworfQorCitzdGF0aWMgaW50IHZsdl9ycHNfbWluX2ZyZXEoc3RydWN0IGludGVs
X3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcnBzX3RvX2k5
MTUocnBzKTsKKwl1MzIgdmFsOworCisJdmFsID0gdmx2X3B1bml0X3JlYWQoaTkxNSwgUFVOSVRf
UkVHX0dQVV9MRk0pICYgMHhmZjsKKwkvKgorCSAqIEFjY29yZGluZyB0byB0aGUgQllUIFB1bml0
IEdQVSB0dXJibyBIQVMgMS4xLjYuMyB0aGUgbWluaW11bSB2YWx1ZQorCSAqIGZvciB0aGUgbWlu
aW11bSBmcmVxdWVuY3kgaW4gR1BMTCBtb2RlIGlzIDB4YzEuIENvbnRyYXJ5IHRvIHRoaXMgb24K
KwkgKiBhIEJZVC1NIEIwIHRoZSBhYm92ZSByZWdpc3RlciBjb250YWlucyAweGJmLiBNb3Jlb3Zl
ciB3aGVuIHNldHRpbmcKKwkgKiBhIGZyZXF1ZW5jeSBQdW5pdCB3aWxsIG5vdCBhbGxvdyB2YWx1
ZXMgYmVsb3cgMHhjMC4gQ2xhbXAgaXQgMHhjMAorCSAqIHRvIG1ha2Ugc3VyZSBpdCBtYXRjaGVz
IHdoYXQgUHVuaXQgYWNjZXB0cy4KKwkgKi8KKwlyZXR1cm4gbWF4X3QodTMyLCB2YWwsIDB4YzAp
OworfQorCitzdGF0aWMgYm9vbCB2bHZfcnBzX2VuYWJsZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMp
Cit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcnBzX3RvX3VuY29yZShycHMpOwor
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKwl1MzIg
dmFsOworCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9SUF9ET1dOX1RJTUVP
VVQsIDEwMDAwMDApOworCWludGVsX3VuY29yZV93cml0ZV9mdyh1bmNvcmUsIEdFTjZfUlBfVVBf
VEhSRVNIT0xELCA1OTQwMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwgR0VONl9S
UF9ET1dOX1RIUkVTSE9MRCwgMjQ1MDAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGVfZncodW5jb3Jl
LCBHRU42X1JQX1VQX0VJLCA2NjAwMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29yZSwg
R0VONl9SUF9ET1dOX0VJLCAzNTAwMDApOworCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3KHVuY29y
ZSwgR0VONl9SUF9JRExFX0hZU1RFUlNJUywgMTApOworCisJaW50ZWxfdW5jb3JlX3dyaXRlX2Z3
KHVuY29yZSwgR0VONl9SUF9DT05UUk9MLAorCQkJICAgICAgR0VONl9SUF9NRURJQV9UVVJCTyB8
CisJCQkgICAgICBHRU42X1JQX01FRElBX0hXX05PUk1BTF9NT0RFIHwKKwkJCSAgICAgIEdFTjZf
UlBfTUVESUFfSVNfR0ZYIHwKKwkJCSAgICAgIEdFTjZfUlBfRU5BQkxFIHwKKwkJCSAgICAgIEdF
TjZfUlBfVVBfQlVTWV9BVkcgfAorCQkJICAgICAgR0VONl9SUF9ET1dOX0lETEVfQ09OVCk7CisK
Kwl2bHZfcHVuaXRfZ2V0KGk5MTUpOworCisJLyogU2V0dGluZyBGaXhlZCBCaWFzICovCisJdmFs
ID0gVkxWX09WRVJSSURFX0VOIHwgVkxWX1NPQ19URFBfRU4gfCBWTFZfQklBU19DUFVfMTI1X1NP
Q184NzU7CisJdmx2X3B1bml0X3dyaXRlKGk5MTUsIFZMVl9UVVJCT19TT0NfT1ZFUlJJREUsIHZh
bCk7CisKKwl2YWwgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdfR1BVX0ZSRVFfU1RT
KTsKKworCXZsdl9wdW5pdF9wdXQoaTkxNSk7CisKKwkvKiBSUFMgY29kZSBhc3N1bWVzIEdQTEwg
aXMgdXNlZCAqLworCVdBUk5fT05DRSgodmFsICYgR1BMTEVOQUJMRSkgPT0gMCwgIkdQTEwgbm90
IGVuYWJsZWRcbiIpOworCisJRFJNX0RFQlVHX0RSSVZFUigiR1BMTCBlbmFibGVkPyAlc1xuIiwg
eWVzbm8odmFsICYgR1BMTEVOQUJMRSkpOworCURSTV9ERUJVR19EUklWRVIoIkdQVSBzdGF0dXM6
IDB4JTA4eFxuIiwgdmFsKTsKKworCXJldHVybiBycHNfcmVzZXQocnBzKTsKK30KKworc3RhdGlj
IHVuc2lnbmVkIGxvbmcgX19pcHNfZ2Z4X3ZhbChzdHJ1Y3QgaW50ZWxfaXBzICppcHMpCit7CisJ
c3RydWN0IGludGVsX3JwcyAqcnBzID0gY29udGFpbmVyX29mKGlwcywgdHlwZW9mKCpycHMpLCBp
cHMpOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IHJwc190b191bmNvcmUocnBzKTsK
Kwl1bnNpZ25lZCBsb25nIHQsIGNvcnIsIHN0YXRlMSwgY29ycjIsIHN0YXRlMjsKKwl1MzIgcHh2
aWQsIGV4dF92OworCisJbG9ja2RlcF9hc3NlcnRfaGVsZCgmbWNoZGV2X2xvY2spOworCisJcHh2
aWQgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFBYVkZSRVEocnBzLT5jdXJfZnJlcSkpOwor
CXB4dmlkID0gKHB4dmlkID4+IDI0KSAmIDB4N2Y7CisJZXh0X3YgPSBwdmlkX3RvX2V4dHZpZChy
cHNfdG9faTkxNShycHMpLCBweHZpZCk7CisKKwlzdGF0ZTEgPSBleHRfdjsKKworCS8qIFJldmVs
IGluIHRoZSBlbXBpcmljYWxseSBkZXJpdmVkIGNvbnN0YW50cyAqLworCisJLyogQ29ycmVjdGlv
biBmYWN0b3IgaW4gMS8xMDAwMDAgdW5pdHMgKi8KKwl0ID0gaXBzX21jaF92YWwodW5jb3JlKTsK
KwlpZiAodCA+IDgwKQorCQljb3JyID0gdCAqIDIzNDkgKyAxMzU5NDA7CisJZWxzZSBpZiAodCA+
PSA1MCkKKwkJY29yciA9IHQgKiA5NjQgKyAyOTMxNzsKKwllbHNlIC8qIDwgNTAgKi8KKwkJY29y
ciA9IHQgKiAzMDEgKyAxMDA0OworCisJY29yciA9IGNvcnIgKiAxNTAxNDIgKiBzdGF0ZTEgLyAx
MDAwMCAtIDc4NjQyOworCWNvcnIgLz0gMTAwMDAwOworCWNvcnIyID0gY29yciAqIGlwcy0+Y29y
cjsKKworCXN0YXRlMiA9IGNvcnIyICogc3RhdGUxIC8gMTAwMDA7CisJc3RhdGUyIC89IDEwMDsg
LyogY29udmVydCB0byBtVyAqLworCisJX19nZW41X2lwc191cGRhdGUoaXBzKTsKKworCXJldHVy
biBpcHMtPmdmeF9wb3dlciArIHN0YXRlMjsKK30KKwordm9pZCBpbnRlbF9ycHNfZW5hYmxlKHN0
cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHJwc190b19pOTE1KHJwcyk7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gcnBzX3Rv
X3VuY29yZShycHMpOworCisJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQodW5jb3JlLCBGT1JD
RVdBS0VfQUxMKTsKKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkKKwkJcnBzLT5lbmFibGVkID0g
Y2h2X3Jwc19lbmFibGUocnBzKTsKKwllbHNlIGlmIChJU19WQUxMRVlWSUVXKGk5MTUpKQorCQly
cHMtPmVuYWJsZWQgPSB2bHZfcnBzX2VuYWJsZShycHMpOworCWVsc2UgaWYgKElOVEVMX0dFTihp
OTE1KSA+PSA5KQorCQlycHMtPmVuYWJsZWQgPSBnZW45X3Jwc19lbmFibGUocnBzKTsKKwllbHNl
IGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOCkKKwkJcnBzLT5lbmFibGVkID0gZ2VuOF9ycHNfZW5h
YmxlKHJwcyk7CisJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCisJCXJwcy0+ZW5hYmxl
ZCA9IGdlbjZfcnBzX2VuYWJsZShycHMpOworCWVsc2UgaWYgKElTX0lST05MQUtFX00oaTkxNSkp
CisJCXJwcy0+ZW5hYmxlZCA9IGdlbjVfcnBzX2VuYWJsZShycHMpOworCWludGVsX3VuY29yZV9m
b3JjZXdha2VfcHV0KHVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7CisJaWYgKCFycHMtPmVuYWJsZWQp
CisJCXJldHVybjsKKworCVdBUk5fT04ocnBzLT5tYXhfZnJlcSA8IHJwcy0+bWluX2ZyZXEpOwor
CVdBUk5fT04ocnBzLT5pZGxlX2ZyZXEgPiBycHMtPm1heF9mcmVxKTsKKworCVdBUk5fT04ocnBz
LT5lZmZpY2llbnRfZnJlcSA8IHJwcy0+bWluX2ZyZXEpOworCVdBUk5fT04ocnBzLT5lZmZpY2ll
bnRfZnJlcSA+IHJwcy0+bWF4X2ZyZXEpOworfQorCitzdGF0aWMgdm9pZCBnZW42X3Jwc19kaXNh
YmxlKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlpbnRlbF91bmNvcmVfd3JpdGUocnBzX3Rv
X3VuY29yZShycHMpLCBHRU42X1JQX0NPTlRST0wsIDApOworfQorCit2b2lkIGludGVsX3Jwc19k
aXNhYmxlKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7CisKKwlycHMtPmVuYWJsZWQgPSBmYWxzZTsKKwor
CWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKKwkJZ2VuNl9ycHNfZGlzYWJsZShycHMpOworCWVs
c2UgaWYgKElTX0lST05MQUtFX00oaTkxNSkpCisJCWdlbjVfcnBzX2Rpc2FibGUocnBzKTsKK30K
Kworc3RhdGljIGludCBieXRfZ3B1X2ZyZXEoc3RydWN0IGludGVsX3JwcyAqcnBzLCBpbnQgdmFs
KQoreworCS8qCisJICogTiA9IHZhbCAtIDB4YjcKKwkgKiBTbG93ID0gRmFzdCA9IEdQTEwgcmVm
ICogTgorCSAqLworCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVChycHMtPmdwbGxfcmVmX2ZyZXEg
KiAodmFsIC0gMHhiNyksIDEwMDApOworfQorCitzdGF0aWMgaW50IGJ5dF9mcmVxX29wY29kZShz
dHJ1Y3QgaW50ZWxfcnBzICpycHMsIGludCB2YWwpCit7CisJcmV0dXJuIERJVl9ST1VORF9DTE9T
RVNUKDEwMDAgKiB2YWwsIHJwcy0+Z3BsbF9yZWZfZnJlcSkgKyAweGI3OworfQorCitzdGF0aWMg
aW50IGNodl9ncHVfZnJlcShzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIGludCB2YWwpCit7CisJLyoK
KwkgKiBOID0gdmFsIC8gMgorCSAqIENVIChzbG93KSA9IENVMnggKGZhc3QpIC8gMiA9IEdQTEwg
cmVmICogTiAvIDIKKwkgKi8KKwlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QocnBzLT5ncGxsX3Jl
Zl9mcmVxICogdmFsLCAyICogMiAqIDEwMDApOworfQorCitzdGF0aWMgaW50IGNodl9mcmVxX29w
Y29kZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIGludCB2YWwpCit7CisJLyogQ0hWIG5lZWRzIGV2
ZW4gdmFsdWVzICovCisJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKDIgKiAxMDAwICogdmFsLCBy
cHMtPmdwbGxfcmVmX2ZyZXEpICogMjsKK30KKworaW50IGludGVsX2dwdV9mcmVxKHN0cnVjdCBp
bnRlbF9ycHMgKnJwcywgaW50IHZhbCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHJwc190b19pOTE1KHJwcyk7CisKKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDkpCisJCXJl
dHVybiBESVZfUk9VTkRfQ0xPU0VTVCh2YWwgKiBHVF9GUkVRVUVOQ1lfTVVMVElQTElFUiwKKwkJ
CQkJIEdFTjlfRlJFUV9TQ0FMRVIpOworCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpCisJ
CXJldHVybiBjaHZfZ3B1X2ZyZXEocnBzLCB2YWwpOworCWVsc2UgaWYgKElTX1ZBTExFWVZJRVco
aTkxNSkpCisJCXJldHVybiBieXRfZ3B1X2ZyZXEocnBzLCB2YWwpOworCWVsc2UKKwkJcmV0dXJu
IHZhbCAqIEdUX0ZSRVFVRU5DWV9NVUxUSVBMSUVSOworfQorCitpbnQgaW50ZWxfZnJlcV9vcGNv
ZGUoc3RydWN0IGludGVsX3JwcyAqcnBzLCBpbnQgdmFsKQoreworCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKworCWlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gOSkKKwkJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKHZhbCAqIEdFTjlfRlJFUV9TQ0FMRVIs
CisJCQkJCSBHVF9GUkVRVUVOQ1lfTVVMVElQTElFUik7CisJZWxzZSBpZiAoSVNfQ0hFUlJZVklF
VyhpOTE1KSkKKwkJcmV0dXJuIGNodl9mcmVxX29wY29kZShycHMsIHZhbCk7CisJZWxzZSBpZiAo
SVNfVkFMTEVZVklFVyhpOTE1KSkKKwkJcmV0dXJuIGJ5dF9mcmVxX29wY29kZShycHMsIHZhbCk7
CisJZWxzZQorCQlyZXR1cm4gRElWX1JPVU5EX0NMT1NFU1QodmFsLCBHVF9GUkVRVUVOQ1lfTVVM
VElQTElFUik7Cit9CisKK3N0YXRpYyB2b2lkIHZsdl9pbml0X2dwbGxfcmVmX2ZyZXEoc3RydWN0
IGludGVsX3JwcyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcnBz
X3RvX2k5MTUocnBzKTsKKworCXJwcy0+Z3BsbF9yZWZfZnJlcSA9CisJCXZsdl9nZXRfY2NrX2Ns
b2NrKGk5MTUsICJHUExMIHJlZiIsCisJCQkJICBDQ0tfR1BMTF9DTE9DS19DT05UUk9MLAorCQkJ
CSAgaTkxNS0+Y3pjbGtfZnJlcSk7CisKKwlEUk1fREVCVUdfRFJJVkVSKCJHUExMIHJlZmVyZW5j
ZSBmcmVxOiAlZCBrSHpcbiIsIHJwcy0+Z3BsbF9yZWZfZnJlcSk7Cit9CisKK3N0YXRpYyB2b2lk
IHZsdl9ycHNfaW5pdChzdHJ1Y3QgaW50ZWxfcnBzICpycHMpCit7CisJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBycHNfdG9faTkxNShycHMpOworCXUzMiB2YWw7CisKKwl2bHZfaW9z
Zl9zYl9nZXQoaTkxNSwKKwkJCUJJVChWTFZfSU9TRl9TQl9QVU5JVCkgfAorCQkJQklUKFZMVl9J
T1NGX1NCX05DKSB8CisJCQlCSVQoVkxWX0lPU0ZfU0JfQ0NLKSk7CisKKwl2bHZfaW5pdF9ncGxs
X3JlZl9mcmVxKHJwcyk7CisKKwl2YWwgPSB2bHZfcHVuaXRfcmVhZChpOTE1LCBQVU5JVF9SRUdf
R1BVX0ZSRVFfU1RTKTsKKwlzd2l0Y2ggKCh2YWwgPj4gNikgJiAzKSB7CisJY2FzZSAwOgorCWNh
c2UgMToKKwkJaTkxNS0+bWVtX2ZyZXEgPSA4MDA7CisJCWJyZWFrOworCWNhc2UgMjoKKwkJaTkx
NS0+bWVtX2ZyZXEgPSAxMDY2OworCQlicmVhazsKKwljYXNlIDM6CisJCWk5MTUtPm1lbV9mcmVx
ID0gMTMzMzsKKwkJYnJlYWs7CisJfQorCURSTV9ERUJVR19EUklWRVIoIkREUiBzcGVlZDogJWQg
TUh6XG4iLCBpOTE1LT5tZW1fZnJlcSk7CisKKwlycHMtPm1heF9mcmVxID0gdmx2X3Jwc19tYXhf
ZnJlcShycHMpOworCXJwcy0+cnAwX2ZyZXEgPSBycHMtPm1heF9mcmVxOworCURSTV9ERUJVR19E
UklWRVIoIm1heCBHUFUgZnJlcTogJWQgTUh6ICgldSlcbiIsCisJCQkgaW50ZWxfZ3B1X2ZyZXEo
cnBzLCBycHMtPm1heF9mcmVxKSwKKwkJCSBycHMtPm1heF9mcmVxKTsKKworCXJwcy0+ZWZmaWNp
ZW50X2ZyZXEgPSB2bHZfcnBzX3JwZV9mcmVxKHJwcyk7CisJRFJNX0RFQlVHX0RSSVZFUigiUlBl
IEdQVSBmcmVxOiAlZCBNSHogKCV1KVxuIiwKKwkJCSBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+
ZWZmaWNpZW50X2ZyZXEpLAorCQkJIHJwcy0+ZWZmaWNpZW50X2ZyZXEpOworCisJcnBzLT5ycDFf
ZnJlcSA9IHZsdl9ycHNfZ3Vhcl9mcmVxKHJwcyk7CisJRFJNX0RFQlVHX0RSSVZFUigiUlAxKEd1
YXIgRnJlcSkgR1BVIGZyZXE6ICVkIE1IeiAoJXUpXG4iLAorCQkJIGludGVsX2dwdV9mcmVxKHJw
cywgcnBzLT5ycDFfZnJlcSksCisJCQkgcnBzLT5ycDFfZnJlcSk7CisKKwlycHMtPm1pbl9mcmVx
ID0gdmx2X3Jwc19taW5fZnJlcShycHMpOworCURSTV9ERUJVR19EUklWRVIoIm1pbiBHUFUgZnJl
cTogJWQgTUh6ICgldSlcbiIsCisJCQkgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1pbl9mcmVx
KSwKKwkJCSBycHMtPm1pbl9mcmVxKTsKKworCXZsdl9pb3NmX3NiX3B1dChpOTE1LAorCQkJQklU
KFZMVl9JT1NGX1NCX1BVTklUKSB8CisJCQlCSVQoVkxWX0lPU0ZfU0JfTkMpIHwKKwkJCUJJVChW
TFZfSU9TRl9TQl9DQ0spKTsKK30KKworc3RhdGljIHZvaWQgY2h2X3Jwc19pbml0KHN0cnVjdCBp
bnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHJwc190
b19pOTE1KHJwcyk7CisJdTMyIHZhbDsKKworCXZsdl9pb3NmX3NiX2dldChpOTE1LAorCQkJQklU
KFZMVl9JT1NGX1NCX1BVTklUKSB8CisJCQlCSVQoVkxWX0lPU0ZfU0JfTkMpIHwKKwkJCUJJVChW
TFZfSU9TRl9TQl9DQ0spKTsKKworCXZsdl9pbml0X2dwbGxfcmVmX2ZyZXEocnBzKTsKKworCXZh
bCA9IHZsdl9jY2tfcmVhZChpOTE1LCBDQ0tfRlVTRV9SRUcpOworCisJc3dpdGNoICgodmFsID4+
IDIpICYgMHg3KSB7CisJY2FzZSAzOgorCQlpOTE1LT5tZW1fZnJlcSA9IDIwMDA7CisJCWJyZWFr
OworCWRlZmF1bHQ6CisJCWk5MTUtPm1lbV9mcmVxID0gMTYwMDsKKwkJYnJlYWs7CisJfQorCURS
TV9ERUJVR19EUklWRVIoIkREUiBzcGVlZDogJWQgTUh6XG4iLCBpOTE1LT5tZW1fZnJlcSk7CisK
KwlycHMtPm1heF9mcmVxID0gY2h2X3Jwc19tYXhfZnJlcShycHMpOworCXJwcy0+cnAwX2ZyZXEg
PSBycHMtPm1heF9mcmVxOworCURSTV9ERUJVR19EUklWRVIoIm1heCBHUFUgZnJlcTogJWQgTUh6
ICgldSlcbiIsCisJCQkgaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1heF9mcmVxKSwKKwkJCSBy
cHMtPm1heF9mcmVxKTsKKworCXJwcy0+ZWZmaWNpZW50X2ZyZXEgPSBjaHZfcnBzX3JwZV9mcmVx
KHJwcyk7CisJRFJNX0RFQlVHX0RSSVZFUigiUlBlIEdQVSBmcmVxOiAlZCBNSHogKCV1KVxuIiwK
KwkJCSBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpLAorCQkJIHJwcy0+
ZWZmaWNpZW50X2ZyZXEpOworCisJcnBzLT5ycDFfZnJlcSA9IGNodl9ycHNfZ3Vhcl9mcmVxKHJw
cyk7CisJRFJNX0RFQlVHX0RSSVZFUigiUlAxKEd1YXIpIEdQVSBmcmVxOiAlZCBNSHogKCV1KVxu
IiwKKwkJCSBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+cnAxX2ZyZXEpLAorCQkJIHJwcy0+cnAx
X2ZyZXEpOworCisJcnBzLT5taW5fZnJlcSA9IGNodl9ycHNfbWluX2ZyZXEocnBzKTsKKwlEUk1f
REVCVUdfRFJJVkVSKCJtaW4gR1BVIGZyZXE6ICVkIE1IeiAoJXUpXG4iLAorCQkJIGludGVsX2dw
dV9mcmVxKHJwcywgcnBzLT5taW5fZnJlcSksCisJCQkgcnBzLT5taW5fZnJlcSk7CisKKwl2bHZf
aW9zZl9zYl9wdXQoaTkxNSwKKwkJCUJJVChWTFZfSU9TRl9TQl9QVU5JVCkgfAorCQkJQklUKFZM
Vl9JT1NGX1NCX05DKSB8CisJCQlCSVQoVkxWX0lPU0ZfU0JfQ0NLKSk7CisKKwlXQVJOX09OQ0Uo
KHJwcy0+bWF4X2ZyZXEgfCBycHMtPmVmZmljaWVudF9mcmVxIHwgcnBzLT5ycDFfZnJlcSB8CisJ
CSAgIHJwcy0+bWluX2ZyZXEpICYgMSwKKwkJICAiT2RkIEdQVSBmcmVxIHZhbHVlc1xuIik7Cit9
CisKK3N0YXRpYyB2b2lkIHZsdl9jMF9yZWFkKHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwg
c3RydWN0IGludGVsX3Jwc19laSAqZWkpCit7CisJZWktPmt0aW1lID0ga3RpbWVfZ2V0X3Jhdygp
OworCWVpLT5yZW5kZXJfYzAgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFZMVl9SRU5ERVJf
QzBfQ09VTlQpOworCWVpLT5tZWRpYV9jMCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgVkxW
X01FRElBX0MwX0NPVU5UKTsKK30KKworc3RhdGljIHUzMiB2bHZfd2FfYzBfZWkoc3RydWN0IGlu
dGVsX3JwcyAqcnBzLCB1MzIgcG1faWlyKQoreworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29y
ZSA9IHJwc190b191bmNvcmUocnBzKTsKKwljb25zdCBzdHJ1Y3QgaW50ZWxfcnBzX2VpICpwcmV2
ID0gJnJwcy0+ZWk7CisJc3RydWN0IGludGVsX3Jwc19laSBub3c7CisJdTMyIGV2ZW50cyA9IDA7
CisKKwlpZiAoKHBtX2lpciAmIEdFTjZfUE1fUlBfVVBfRUlfRVhQSVJFRCkgPT0gMCkKKwkJcmV0
dXJuIDA7CisKKwl2bHZfYzBfcmVhZCh1bmNvcmUsICZub3cpOworCisJaWYgKHByZXYtPmt0aW1l
KSB7CisJCXU2NCB0aW1lLCBjMDsKKwkJdTMyIHJlbmRlciwgbWVkaWE7CisKKwkJdGltZSA9IGt0
aW1lX3VzX2RlbHRhKG5vdy5rdGltZSwgcHJldi0+a3RpbWUpOworCisJCXRpbWUgKj0gcnBzX3Rv
X2k5MTUocnBzKS0+Y3pjbGtfZnJlcTsKKworCQkvKiBXb3JrbG9hZCBjYW4gYmUgc3BsaXQgYmV0
d2VlbiByZW5kZXIgKyBtZWRpYSwKKwkJICogZS5nLiBTd2FwQnVmZmVycyBiZWluZyBibGl0dGVk
IGluIFggYWZ0ZXIgYmVpbmcgcmVuZGVyZWQgaW4KKwkJICogbWVzYS4gVG8gYWNjb3VudCBmb3Ig
dGhpcyB3ZSBuZWVkIHRvIGNvbWJpbmUgYm90aCBlbmdpbmVzCisJCSAqIGludG8gb3VyIGFjdGl2
aXR5IGNvdW50ZXIuCisJCSAqLworCQlyZW5kZXIgPSBub3cucmVuZGVyX2MwIC0gcHJldi0+cmVu
ZGVyX2MwOworCQltZWRpYSA9IG5vdy5tZWRpYV9jMCAtIHByZXYtPm1lZGlhX2MwOworCQljMCA9
IG1heChyZW5kZXIsIG1lZGlhKTsKKwkJYzAgKj0gMTAwMCAqIDEwMCA8PCA4OyAvKiB0byB1c2Vj
cyBhbmQgc2NhbGUgdG8gdGhyZXNob2xkJSAqLworCisJCWlmIChjMCA+IHRpbWUgKiBycHMtPnBv
d2VyLnVwX3RocmVzaG9sZCkKKwkJCWV2ZW50cyA9IEdFTjZfUE1fUlBfVVBfVEhSRVNIT0xEOwor
CQllbHNlIGlmIChjMCA8IHRpbWUgKiBycHMtPnBvd2VyLmRvd25fdGhyZXNob2xkKQorCQkJZXZl
bnRzID0gR0VONl9QTV9SUF9ET1dOX1RIUkVTSE9MRDsKKwl9CisKKwlycHMtPmVpID0gbm93Owor
CXJldHVybiBldmVudHM7Cit9CisKK3N0YXRpYyB2b2lkIHJwc193b3JrKHN0cnVjdCB3b3JrX3N0
cnVjdCAqd29yaykKK3sKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSBjb250YWluZXJfb2Yod29y
aywgdHlwZW9mKCpycHMpLCB3b3JrKTsKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gcnBzX3RvX2d0
KHJwcyk7CisJYm9vbCBjbGllbnRfYm9vc3QgPSBmYWxzZTsKKwlpbnQgbmV3X2ZyZXEsIGFkaiwg
bWluLCBtYXg7CisJdTMyIHBtX2lpciA9IDA7CisKKwlzcGluX2xvY2tfaXJxKCZndC0+aXJxX2xv
Y2spOworCXBtX2lpciA9IGZldGNoX2FuZF96ZXJvKCZycHMtPnBtX2lpcik7CisJY2xpZW50X2Jv
b3N0ID0gYXRvbWljX3JlYWQoJnJwcy0+bnVtX3dhaXRlcnMpOworCXNwaW5fdW5sb2NrX2lycSgm
Z3QtPmlycV9sb2NrKTsKKworCS8qIE1ha2Ugc3VyZSB3ZSBkaWRuJ3QgcXVldWUgYW55dGhpbmcg
d2UncmUgbm90IGdvaW5nIHRvIHByb2Nlc3MuICovCisJaWYgKChwbV9paXIgJiBycHMtPnBtX2V2
ZW50cykgPT0gMCAmJiAhY2xpZW50X2Jvb3N0KQorCQlnb3RvIG91dDsKKworCW11dGV4X2xvY2so
JnJwcy0+bG9jayk7CisKKwlwbV9paXIgfD0gdmx2X3dhX2MwX2VpKHJwcywgcG1faWlyKTsKKwor
CWFkaiA9IHJwcy0+bGFzdF9hZGo7CisJbmV3X2ZyZXEgPSBycHMtPmN1cl9mcmVxOworCW1pbiA9
IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0OworCW1heCA9IHJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0
OworCWlmIChjbGllbnRfYm9vc3QpCisJCW1heCA9IHJwcy0+bWF4X2ZyZXE7CisJaWYgKGNsaWVu
dF9ib29zdCAmJiBuZXdfZnJlcSA8IHJwcy0+Ym9vc3RfZnJlcSkgeworCQluZXdfZnJlcSA9IHJw
cy0+Ym9vc3RfZnJlcTsKKwkJYWRqID0gMDsKKwl9IGVsc2UgaWYgKHBtX2lpciAmIEdFTjZfUE1f
UlBfVVBfVEhSRVNIT0xEKSB7CisJCWlmIChhZGogPiAwKQorCQkJYWRqICo9IDI7CisJCWVsc2Ug
LyogQ0hWIG5lZWRzIGV2ZW4gZW5jb2RlIHZhbHVlcyAqLworCQkJYWRqID0gSVNfQ0hFUlJZVklF
VyhndC0+aTkxNSkgPyAyIDogMTsKKworCQlpZiAobmV3X2ZyZXEgPj0gcnBzLT5tYXhfZnJlcV9z
b2Z0bGltaXQpCisJCQlhZGogPSAwOworCX0gZWxzZSBpZiAoY2xpZW50X2Jvb3N0KSB7CisJCWFk
aiA9IDA7CisJfSBlbHNlIGlmIChwbV9paXIgJiBHRU42X1BNX1JQX0RPV05fVElNRU9VVCkgewor
CQlpZiAocnBzLT5jdXJfZnJlcSA+IHJwcy0+ZWZmaWNpZW50X2ZyZXEpCisJCQluZXdfZnJlcSA9
IHJwcy0+ZWZmaWNpZW50X2ZyZXE7CisJCWVsc2UgaWYgKHJwcy0+Y3VyX2ZyZXEgPiBycHMtPm1p
bl9mcmVxX3NvZnRsaW1pdCkKKwkJCW5ld19mcmVxID0gcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQ7
CisJCWFkaiA9IDA7CisJfSBlbHNlIGlmIChwbV9paXIgJiBHRU42X1BNX1JQX0RPV05fVEhSRVNI
T0xEKSB7CisJCWlmIChhZGogPCAwKQorCQkJYWRqICo9IDI7CisJCWVsc2UgLyogQ0hWIG5lZWRz
IGV2ZW4gZW5jb2RlIHZhbHVlcyAqLworCQkJYWRqID0gSVNfQ0hFUlJZVklFVyhndC0+aTkxNSkg
PyAtMiA6IC0xOworCisJCWlmIChuZXdfZnJlcSA8PSBycHMtPm1pbl9mcmVxX3NvZnRsaW1pdCkK
KwkJCWFkaiA9IDA7CisJfSBlbHNlIHsgLyogdW5rbm93biBldmVudCAqLworCQlhZGogPSAwOwor
CX0KKworCXJwcy0+bGFzdF9hZGogPSBhZGo7CisKKwkvKgorCSAqIExpbWl0IGRlYm9vc3Rpbmcg
YW5kIGJvb3N0aW5nIHRvIGtlZXAgb3Vyc2VsdmVzIGF0IHRoZSBleHRyZW1lcworCSAqIHdoZW4g
aW4gdGhlIHJlc3BlY3RpdmUgcG93ZXIgbW9kZXMgKGkuZS4gc2xvd2x5IGRlY3JlYXNlIGZyZXF1
ZW5jaWVzCisJICogd2hpbGUgaW4gdGhlIEhJR0hfUE9XRVIgem9uZSBhbmQgc2xvd2x5IGluY3Jl
YXNlIGZyZXF1ZW5jaWVzIHdoaWxlCisJICogaW4gdGhlIExPV19QT1dFUiB6b25lKS4gT24gaWRs
ZSwgd2Ugd2lsbCBoaXQgdGhlIHRpbWVvdXQgYW5kIGRyb3AKKwkgKiB0byB0aGUgbmV4dCBsZXZl
bCBxdWlja2x5LCBhbmQgY29udmVyc2VseSBpZiBidXN5IHdlIGV4cGVjdCB0bworCSAqIGhpdCBh
IHdhaXRib29zdCBhbmQgcmFwaWRseSBzd2l0Y2ggaW50byBtYXggcG93ZXIuCisJICovCisJaWYg
KChhZGogPCAwICYmIHJwcy0+cG93ZXIubW9kZSA9PSBISUdIX1BPV0VSKSB8fAorCSAgICAoYWRq
ID4gMCAmJiBycHMtPnBvd2VyLm1vZGUgPT0gTE9XX1BPV0VSKSkKKwkJcnBzLT5sYXN0X2FkaiA9
IDA7CisKKwkvKiBzeXNmcyBmcmVxdWVuY3kgaW50ZXJmYWNlcyBtYXkgaGF2ZSBzbnVjayBpbiB3
aGlsZSBzZXJ2aWNpbmcgdGhlCisJICogaW50ZXJydXB0CisJICovCisJbmV3X2ZyZXEgKz0gYWRq
OworCW5ld19mcmVxID0gY2xhbXBfdChpbnQsIG5ld19mcmVxLCBtaW4sIG1heCk7CisKKwlpZiAo
aW50ZWxfcnBzX3NldChycHMsIG5ld19mcmVxKSkgeworCQlEUk1fREVCVUdfRFJJVkVSKCJGYWls
ZWQgdG8gc2V0IG5ldyBHUFUgZnJlcXVlbmN5XG4iKTsKKwkJcnBzLT5sYXN0X2FkaiA9IDA7CisJ
fQorCisJbXV0ZXhfdW5sb2NrKCZycHMtPmxvY2spOworCitvdXQ6CisJc3Bpbl9sb2NrX2lycSgm
Z3QtPmlycV9sb2NrKTsKKwlnZW42X2d0X3BtX3VubWFza19pcnEoZ3QsIHJwcy0+cG1fZXZlbnRz
KTsKKwlzcGluX3VubG9ja19pcnEoJmd0LT5pcnFfbG9jayk7Cit9CisKK3ZvaWQgZ2VuMTFfcnBz
X2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ycHMgKnJwcywgdTMyIHBtX2lpcikKK3sKKwlzdHJ1
Y3QgaW50ZWxfZ3QgKmd0ID0gcnBzX3RvX2d0KHJwcyk7CisJY29uc3QgdTMyIGV2ZW50cyA9IHJw
cy0+cG1fZXZlbnRzICYgcG1faWlyOworCisJbG9ja2RlcF9hc3NlcnRfaGVsZCgmZ3QtPmlycV9s
b2NrKTsKKworCWlmICh1bmxpa2VseSghZXZlbnRzKSkKKwkJcmV0dXJuOworCisJZ2VuNl9ndF9w
bV9tYXNrX2lycShndCwgZXZlbnRzKTsKKworCXJwcy0+cG1faWlyIHw9IGV2ZW50czsKKwlzY2hl
ZHVsZV93b3JrKCZycHMtPndvcmspOworfQorCit2b2lkIGdlbjZfcnBzX2lycV9oYW5kbGVyKHN0
cnVjdCBpbnRlbF9ycHMgKnJwcywgdTMyIHBtX2lpcikKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHJwc190b19pOTE1KHJwcyk7CisKKwlpZiAocG1faWlyICYgcnBzLT5wbV9l
dmVudHMpIHsKKwkJc3RydWN0IGludGVsX2d0ICpndCA9IHJwc190b19ndChycHMpOworCisJCXNw
aW5fbG9jaygmZ3QtPmlycV9sb2NrKTsKKwkJZ2VuNl9ndF9wbV9tYXNrX2lycShndCwgcG1faWly
ICYgcnBzLT5wbV9ldmVudHMpOworCQlycHMtPnBtX2lpciB8PSBwbV9paXIgJiBycHMtPnBtX2V2
ZW50czsKKwkJc2NoZWR1bGVfd29yaygmcnBzLT53b3JrKTsKKwkJc3Bpbl91bmxvY2soJmd0LT5p
cnFfbG9jayk7CisJfQorCisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KQorCQlyZXR1cm47CisK
KwlpZiAocG1faWlyICYgUE1fVkVCT1hfVVNFUl9JTlRFUlJVUFQpCisJCWludGVsX2VuZ2luZV9i
cmVhZGNydW1ic19pcnEoaTkxNS0+ZW5naW5lW1ZFQ1MwXSk7CisKKwlpZiAocG1faWlyICYgUE1f
VkVCT1hfQ1NfRVJST1JfSU5URVJSVVBUKQorCQlEUk1fREVCVUcoIkNvbW1hbmQgcGFyc2VyIGVy
cm9yLCBwbV9paXIgMHglMDh4XG4iLCBwbV9paXIpOworfQorCit2b2lkIGdlbjVfcnBzX2lycV9o
YW5kbGVyKHN0cnVjdCBpbnRlbF9ycHMgKnJwcykKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUgPSBycHNfdG9fdW5jb3JlKHJwcyk7CisJdTMyIGJ1c3lfdXAsIGJ1c3lfZG93biwgbWF4
X2F2ZywgbWluX2F2ZzsKKwl1OCBuZXdfZnJlcTsKKworCXNwaW5fbG9jaygmbWNoZGV2X2xvY2sp
OworCisJaW50ZWxfdW5jb3JlX3dyaXRlMTYodW5jb3JlLAorCQkJICAgICBNRU1JTlRSU1RTLAor
CQkJICAgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIE1FTUlOVFJTVFMpKTsKKworCWludGVs
X3VuY29yZV93cml0ZTE2KHVuY29yZSwgTUVNSU5UUlNUUywgTUVNSU5UX0VWQUxfQ0hHKTsKKwli
dXN5X3VwID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBSQ1BSRVZCU1lUVVBBVkcpOworCWJ1
c3lfZG93biA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgUkNQUkVWQlNZVEROQVZHKTsKKwlt
YXhfYXZnID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBSQ0JNQVhBVkcpOworCW1pbl9hdmcg
PSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFJDQk1JTkFWRyk7CisKKwkvKiBIYW5kbGUgUkNT
IGNoYW5nZSByZXF1ZXN0IGZyb20gaHcgKi8KKwluZXdfZnJlcSA9IHJwcy0+Y3VyX2ZyZXE7CisJ
aWYgKGJ1c3lfdXAgPiBtYXhfYXZnKQorCQluZXdfZnJlcSsrOworCWVsc2UgaWYgKGJ1c3lfZG93
biA8IG1pbl9hdmcpCisJCW5ld19mcmVxLS07CisJbmV3X2ZyZXEgPSBjbGFtcChuZXdfZnJlcSwK
KwkJCSBycHMtPm1pbl9mcmVxX3NvZnRsaW1pdCwKKwkJCSBycHMtPm1heF9mcmVxX3NvZnRsaW1p
dCk7CisKKwlpZiAobmV3X2ZyZXEgIT0gcnBzLT5jdXJfZnJlcSAmJiBnZW41X3Jwc19zZXQocnBz
LCBuZXdfZnJlcSkpCisJCXJwcy0+Y3VyX2ZyZXEgPSBuZXdfZnJlcTsKKworCXNwaW5fdW5sb2Nr
KCZtY2hkZXZfbG9jayk7Cit9CisKK3ZvaWQgaW50ZWxfcnBzX2luaXQoc3RydWN0IGludGVsX3Jw
cyAqcnBzKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcnBzX3RvX2k5MTUo
cnBzKTsKKworCW11dGV4X2luaXQoJnJwcy0+bG9jayk7CisJbXV0ZXhfaW5pdCgmcnBzLT5wb3dl
ci5tdXRleCk7CisKKwlJTklUX1dPUksoJnJwcy0+d29yaywgcnBzX3dvcmspOworCisJYXRvbWlj
X3NldCgmcnBzLT5udW1fd2FpdGVycywgMCk7CisKKwlpZiAoSVNfQ0hFUlJZVklFVyhpOTE1KSkK
KwkJY2h2X3Jwc19pbml0KHJwcyk7CisJZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhpOTE1KSkKKwkJ
dmx2X3Jwc19pbml0KHJwcyk7CisJZWxzZSBpZiAoSU5URUxfR0VOKGk5MTUpID49IDYpCisJCWdl
bjZfcnBzX2luaXQocnBzKTsKKwllbHNlIGlmIChJU19JUk9OTEFLRV9NKGk5MTUpKQorCQlnZW41
X3Jwc19pbml0KHJwcyk7CisKKwkvKiBEZXJpdmUgaW5pdGlhbCB1c2VyIHByZWZlcmVuY2VzL2xp
bWl0cyBmcm9tIHRoZSBoYXJkd2FyZSBsaW1pdHMgKi8KKwlycHMtPm1heF9mcmVxX3NvZnRsaW1p
dCA9IHJwcy0+bWF4X2ZyZXE7CisJcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQgPSBycHMtPm1pbl9m
cmVxOworCisJLyogQWZ0ZXIgc2V0dGluZyBtYXgtc29mdGxpbWl0LCBmaW5kIHRoZSBvdmVyY2xv
Y2sgbWF4IGZyZXEgKi8KKwlpZiAoSVNfR0VOKGk5MTUsIDYpIHx8IElTX0lWWUJSSURHRShpOTE1
KSB8fCBJU19IQVNXRUxMKGk5MTUpKSB7CisJCXUzMiBwYXJhbXMgPSAwOworCisJCXNhbmR5YnJp
ZGdlX3Bjb2RlX3JlYWQoaTkxNSwgR0VONl9SRUFEX09DX1BBUkFNUywKKwkJCQkgICAgICAgJnBh
cmFtcywgTlVMTCk7CisJCWlmIChwYXJhbXMgJiBCSVQoMzEpKSB7IC8qIE9DIHN1cHBvcnRlZCAq
LworCQkJRFJNX0RFQlVHX0RSSVZFUigiT3ZlcmNsb2NraW5nIHN1cHBvcnRlZCwgbWF4OiAlZE1I
eiwgb3ZlcmNsb2NrOiAlZE1IelxuIiwKKwkJCQkJIChycHMtPm1heF9mcmVxICYgMHhmZikgKiA1
MCwKKwkJCQkJIChwYXJhbXMgJiAweGZmKSAqIDUwKTsKKwkJCXJwcy0+bWF4X2ZyZXEgPSBwYXJh
bXMgJiAweGZmOworCQl9CisJfQorCisJLyogRmluYWxseSBhbGxvdyB1cyB0byBib29zdCB0byBt
YXggYnkgZGVmYXVsdCAqLworCXJwcy0+Ym9vc3RfZnJlcSA9IHJwcy0+bWF4X2ZyZXE7CisJcnBz
LT5pZGxlX2ZyZXEgPSBycHMtPm1pbl9mcmVxOworCXJwcy0+Y3VyX2ZyZXEgPSBycHMtPmlkbGVf
ZnJlcTsKKworCXJwcy0+cG1faW50cm1za19tYnogPSAwOworCisJLyoKKwkgKiBTTkIsSVZCLEhT
VyBjYW4gd2hpbGUgVkxWLENIViBtYXkgaGFyZCBoYW5nIG9uIGxvb3BpbmcgYmF0Y2hidWZmZXIK
KwkgKiBpZiBHRU42X1BNX1VQX0VJX0VYUElSRUQgaXMgbWFza2VkLgorCSAqCisJICogVE9ETzog
dmVyaWZ5IGlmIHRoaXMgY2FuIGJlIHJlcHJvZHVjZWQgb24gVkxWLENIVi4KKwkgKi8KKwlpZiAo
SU5URUxfR0VOKGk5MTUpIDw9IDcpCisJCXJwcy0+cG1faW50cm1za19tYnogfD0gR0VONl9QTV9S
UF9VUF9FSV9FWFBJUkVEOworCisJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA4KQorCQlycHMtPnBt
X2ludHJtc2tfbWJ6IHw9IEdFTjhfUE1JTlRSX0RJU0FCTEVfUkVESVJFQ1RfVE9fR1VDOworfQor
Cit1MzIgaW50ZWxfZ2V0X2NhZ2Yoc3RydWN0IGludGVsX3JwcyAqcnBzLCB1MzIgcnBzdGF0KQor
eworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gcnBzX3RvX2k5MTUocnBzKTsKKwl1
MzIgY2FnZjsKKworCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gOSkKKwkJY2FnZiA9IChycHN0YXQg
JiBHRU45X0NBR0ZfTUFTSykgPj4gR0VOOV9DQUdGX1NISUZUOworCWVsc2UgaWYgKElTX0hBU1dF
TEwoaTkxNSkgfHwgSVNfQlJPQURXRUxMKGk5MTUpKQorCQljYWdmID0gKHJwc3RhdCAmIEhTV19D
QUdGX01BU0spID4+IEhTV19DQUdGX1NISUZUOworCWVsc2UKKwkJY2FnZiA9IChycHN0YXQgJiBH
RU42X0NBR0ZfTUFTSykgPj4gR0VONl9DQUdGX1NISUZUOworCisJcmV0dXJuICBjYWdmOworfQor
CisvKiBFeHRlcm5hbCBpbnRlcmZhY2UgZm9yIGludGVsX2lwcy5rbyAqLworCitzdGF0aWMgc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgX19yY3UgKmlwc19tY2hkZXY7CisKKy8qKgorICogVGVsbHMg
dGhlIGludGVsX2lwcyBkcml2ZXIgdGhhdCB0aGUgaTkxNSBkcml2ZXIgaXMgbm93IGxvYWRlZCwg
aWYKKyAqIElQUyBnb3QgbG9hZGVkIGZpcnN0LgorICoKKyAqIFRoaXMgYXdrd2FyZCBkYW5jZSBp
cyBzbyB0aGF0IG5laXRoZXIgbW9kdWxlIGhhcyB0byBkZXBlbmQgb24gdGhlCisgKiBvdGhlciBp
biBvcmRlciBmb3IgSVBTIHRvIGRvIHRoZSBhcHByb3ByaWF0ZSBjb21tdW5pY2F0aW9uIG9mCisg
KiBHUFUgdHVyYm8gbGltaXRzIHRvIGk5MTUuCisgKi8KK3N0YXRpYyB2b2lkCitpcHNfcGluZ19m
b3JfaTkxNV9sb2FkKHZvaWQpCit7CisJdm9pZCAoKmxpbmspKHZvaWQpOworCisJbGluayA9IHN5
bWJvbF9nZXQoaXBzX2xpbmtfdG9faTkxNV9kcml2ZXIpOworCWlmIChsaW5rKSB7CisJCWxpbmso
KTsKKwkJc3ltYm9sX3B1dChpcHNfbGlua190b19pOTE1X2RyaXZlcik7CisJfQorfQorCit2b2lk
IGludGVsX3Jwc19kcml2ZXJfcmVnaXN0ZXIoc3RydWN0IGludGVsX3JwcyAqcnBzKQoreworCXN0
cnVjdCBpbnRlbF9ndCAqZ3QgPSBycHNfdG9fZ3QocnBzKTsKKworCS8qCisJICogV2Ugb25seSBy
ZWdpc3RlciB0aGUgaTkxNSBpcHMgcGFydCB3aXRoIGludGVsLWlwcyBvbmNlIGV2ZXJ5dGhpbmcg
aXMKKwkgKiBzZXQgdXAsIHRvIGF2b2lkIGludGVsLWlwcyBzbmVha2luZyBpbiBhbmQgcmVhZGlu
ZyBib2d1cyB2YWx1ZXMuCisJICovCisJaWYgKElTX0dFTihndC0+aTkxNSwgNSkpIHsKKwkJcmN1
X2Fzc2lnbl9wb2ludGVyKGlwc19tY2hkZXYsIGd0LT5pOTE1KTsKKwkJaXBzX3BpbmdfZm9yX2k5
MTVfbG9hZCgpOworCX0KK30KKwordm9pZCBpbnRlbF9ycHNfZHJpdmVyX3VucmVnaXN0ZXIoc3Ry
dWN0IGludGVsX3JwcyAqcnBzKQoreworCXJjdV9hc3NpZ25fcG9pbnRlcihpcHNfbWNoZGV2LCBO
VUxMKTsKK30KKworc3RhdGljIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICptY2hkZXZfZ2V0KHZv
aWQpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7CisKKwlyY3VfcmVhZF9sb2Nr
KCk7CisJaTkxNSA9IHJjdV9kZXJlZmVyZW5jZShpcHNfbWNoZGV2KTsKKwlpZiAoIWtyZWZfZ2V0
X3VubGVzc196ZXJvKCZpOTE1LT5kcm0ucmVmKSkKKwkJaTkxNSA9IE5VTEw7CisJcmN1X3JlYWRf
dW5sb2NrKCk7CisKKwlyZXR1cm4gaTkxNTsKK30KKworLyoqCisgKiBpOTE1X3JlYWRfbWNoX3Zh
bCAtIHJldHVybiB2YWx1ZSBmb3IgSVBTIHVzZQorICoKKyAqIENhbGN1bGF0ZSBhbmQgcmV0dXJu
IGEgdmFsdWUgZm9yIHRoZSBJUFMgZHJpdmVyIHRvIHVzZSB3aGVuIGRlY2lkaW5nIHdoZXRoZXIK
KyAqIHdlIGhhdmUgdGhlcm1hbCBhbmQgcG93ZXIgaGVhZHJvb20gdG8gaW5jcmVhc2UgQ1BVIG9y
IEdQVSBwb3dlciBidWRnZXQuCisgKi8KK3Vuc2lnbmVkIGxvbmcgaTkxNV9yZWFkX21jaF92YWwo
dm9pZCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKKwl1bnNpZ25lZCBsb25n
IGNoaXBzZXRfdmFsID0gMDsKKwl1bnNpZ25lZCBsb25nIGdyYXBoaWNzX3ZhbCA9IDA7CisJaW50
ZWxfd2FrZXJlZl90IHdha2VyZWY7CisKKwlpOTE1ID0gbWNoZGV2X2dldCgpOworCWlmICghaTkx
NSkKKwkJcmV0dXJuIDA7CisKKwl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmk5MTUtPnJ1bnRpbWVf
cG0sIHdha2VyZWYpIHsKKwkJc3RydWN0IGludGVsX2lwcyAqaXBzID0gJmk5MTUtPmd0LnJwcy5p
cHM7CisKKwkJc3Bpbl9sb2NrX2lycSgmbWNoZGV2X2xvY2spOworCQljaGlwc2V0X3ZhbCA9IF9f
aXBzX2NoaXBzZXRfdmFsKGlwcyk7CisJCWdyYXBoaWNzX3ZhbCA9IF9faXBzX2dmeF92YWwoaXBz
KTsKKwkJc3Bpbl91bmxvY2tfaXJxKCZtY2hkZXZfbG9jayk7CisJfQorCisJZHJtX2Rldl9wdXQo
Jmk5MTUtPmRybSk7CisJcmV0dXJuIGNoaXBzZXRfdmFsICsgZ3JhcGhpY3NfdmFsOworfQorRVhQ
T1JUX1NZTUJPTF9HUEwoaTkxNV9yZWFkX21jaF92YWwpOworCisvKioKKyAqIGk5MTVfZ3B1X3Jh
aXNlIC0gcmFpc2UgR1BVIGZyZXF1ZW5jeSBsaW1pdAorICoKKyAqIFJhaXNlIHRoZSBsaW1pdDsg
SVBTIGluZGljYXRlcyB3ZSBoYXZlIHRoZXJtYWwgaGVhZHJvb20uCisgKi8KK2Jvb2wgaTkxNV9n
cHVfcmFpc2Uodm9pZCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKKwlzdHJ1
Y3QgaW50ZWxfcnBzICpycHM7CisKKwlpOTE1ID0gbWNoZGV2X2dldCgpOworCWlmICghaTkxNSkK
KwkJcmV0dXJuIGZhbHNlOworCisJcnBzID0gJmk5MTUtPmd0LnJwczsKKworCXNwaW5fbG9ja19p
cnEoJm1jaGRldl9sb2NrKTsKKwlpZiAocnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQgPCBycHMtPm1h
eF9mcmVxKQorCQlycHMtPm1heF9mcmVxX3NvZnRsaW1pdCsrOworCXNwaW5fdW5sb2NrX2lycSgm
bWNoZGV2X2xvY2spOworCisJZHJtX2Rldl9wdXQoJmk5MTUtPmRybSk7CisJcmV0dXJuIHRydWU7
Cit9CitFWFBPUlRfU1lNQk9MX0dQTChpOTE1X2dwdV9yYWlzZSk7CisKKy8qKgorICogaTkxNV9n
cHVfbG93ZXIgLSBsb3dlciBHUFUgZnJlcXVlbmN5IGxpbWl0CisgKgorICogSVBTIGluZGljYXRl
cyB3ZSdyZSBjbG9zZSB0byBhIHRoZXJtYWwgbGltaXQsIHNvIHRocm90dGxlIGJhY2sgdGhlIEdQ
VQorICogZnJlcXVlbmN5IG1heGltdW0uCisgKi8KK2Jvb2wgaTkxNV9ncHVfbG93ZXIodm9pZCkK
K3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpy
cHM7CisKKwlpOTE1ID0gbWNoZGV2X2dldCgpOworCWlmICghaTkxNSkKKwkJcmV0dXJuIGZhbHNl
OworCisJcnBzID0gJmk5MTUtPmd0LnJwczsKKworCXNwaW5fbG9ja19pcnEoJm1jaGRldl9sb2Nr
KTsKKwlpZiAocnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQgPiBycHMtPm1pbl9mcmVxKQorCQlycHMt
Pm1heF9mcmVxX3NvZnRsaW1pdC0tOworCXNwaW5fdW5sb2NrX2lycSgmbWNoZGV2X2xvY2spOwor
CisJZHJtX2Rldl9wdXQoJmk5MTUtPmRybSk7CisJcmV0dXJuIHRydWU7Cit9CitFWFBPUlRfU1lN
Qk9MX0dQTChpOTE1X2dwdV9sb3dlcik7CisKKy8qKgorICogaTkxNV9ncHVfYnVzeSAtIGluZGlj
YXRlIEdQVSBidXNpbmVzcyB0byBJUFMKKyAqCisgKiBUZWxsIHRoZSBJUFMgZHJpdmVyIHdoZXRo
ZXIgb3Igbm90IHRoZSBHUFUgaXMgYnVzeS4KKyAqLworYm9vbCBpOTE1X2dwdV9idXN5KHZvaWQp
Cit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7CisJYm9vbCByZXQ7CisKKwlpOTE1
ID0gbWNoZGV2X2dldCgpOworCWlmICghaTkxNSkKKwkJcmV0dXJuIGZhbHNlOworCisJcmV0ID0g
aTkxNS0+Z3QuYXdha2U7CisKKwlkcm1fZGV2X3B1dCgmaTkxNS0+ZHJtKTsKKwlyZXR1cm4gcmV0
OworfQorRVhQT1JUX1NZTUJPTF9HUEwoaTkxNV9ncHVfYnVzeSk7CisKKy8qKgorICogaTkxNV9n
cHVfdHVyYm9fZGlzYWJsZSAtIGRpc2FibGUgZ3JhcGhpY3MgdHVyYm8KKyAqCisgKiBEaXNhYmxl
IGdyYXBoaWNzIHR1cmJvIGJ5IHJlc2V0dGluZyB0aGUgbWF4IGZyZXF1ZW5jeSBhbmQgc2V0dGlu
ZyB0aGUKKyAqIGN1cnJlbnQgZnJlcXVlbmN5IHRvIHRoZSBkZWZhdWx0LgorICovCitib29sIGk5
MTVfZ3B1X3R1cmJvX2Rpc2FibGUodm9pZCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNTsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHM7CisJYm9vbCByZXQ7CisKKwlpOTE1ID0gbWNo
ZGV2X2dldCgpOworCWlmICghaTkxNSkKKwkJcmV0dXJuIGZhbHNlOworCisJcnBzID0gJmk5MTUt
Pmd0LnJwczsKKworCXNwaW5fbG9ja19pcnEoJm1jaGRldl9sb2NrKTsKKwlycHMtPm1heF9mcmVx
X3NvZnRsaW1pdCA9IHJwcy0+bWluX2ZyZXE7CisJcmV0ID0gZ2VuNV9ycHNfc2V0KCZpOTE1LT5n
dC5ycHMsIHJwcy0+bWluX2ZyZXEpOworCXNwaW5fdW5sb2NrX2lycSgmbWNoZGV2X2xvY2spOwor
CisJZHJtX2Rldl9wdXQoJmk5MTUtPmRybSk7CisJcmV0dXJuIHJldDsKK30KK0VYUE9SVF9TWU1C
T0xfR1BMKGk5MTVfZ3B1X3R1cmJvX2Rpc2FibGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfcnBzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
cHMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjk5N2E0YjRlMDIw
NwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jwcy5o
CkBAIC0wLDAgKzEsMzcgQEAKKy8qCisgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisg
KgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaWZuZGVm
IElOVEVMX1JQU19ICisjZGVmaW5lIElOVEVMX1JQU19ICisKKyNpbmNsdWRlICJpbnRlbF9ycHNf
dHlwZXMuaCIKKworc3RydWN0IGk5MTVfcmVxdWVzdDsKKwordm9pZCBpbnRlbF9ycHNfaW5pdChz
dHJ1Y3QgaW50ZWxfcnBzICpycHMpOworCit2b2lkIGludGVsX3Jwc19kcml2ZXJfcmVnaXN0ZXIo
c3RydWN0IGludGVsX3JwcyAqcnBzKTsKK3ZvaWQgaW50ZWxfcnBzX2RyaXZlcl91bnJlZ2lzdGVy
KHN0cnVjdCBpbnRlbF9ycHMgKnJwcyk7CisKK3ZvaWQgaW50ZWxfcnBzX2VuYWJsZShzdHJ1Y3Qg
aW50ZWxfcnBzICpycHMpOwordm9pZCBpbnRlbF9ycHNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMpOworCit2b2lkIGludGVsX3Jwc19wYXJrKHN0cnVjdCBpbnRlbF9ycHMgKnJwcyk7Cit2
b2lkIGludGVsX3Jwc191bnBhcmsoc3RydWN0IGludGVsX3JwcyAqcnBzKTsKK3ZvaWQgaW50ZWxf
cnBzX2Jvb3N0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKTsKKworaW50IGludGVsX3Jwc19zZXQo
c3RydWN0IGludGVsX3JwcyAqcnBzLCB1OCB2YWwpOwordm9pZCBpbnRlbF9ycHNfbWFya19pbnRl
cmFjdGl2ZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIGJvb2wgaW50ZXJhY3RpdmUpOworCitpbnQg
aW50ZWxfZ3B1X2ZyZXEoc3RydWN0IGludGVsX3JwcyAqcnBzLCBpbnQgdmFsKTsKK2ludCBpbnRl
bF9mcmVxX29wY29kZShzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIGludCB2YWwpOwordTMyIGludGVs
X2dldF9jYWdmKHN0cnVjdCBpbnRlbF9ycHMgKnJwcywgdTMyIHJwc3RhdDEpOworCit2b2lkIGdl
bjVfcnBzX2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ycHMgKnJwcyk7Cit2b2lkIGdlbjZfcnBz
X2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ycHMgKnJwcywgdTMyIHBtX2lpcik7Cit2b2lkIGdl
bjExX3Jwc19pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfcnBzICpycHMsIHUzMiBwbV9paXIpOwor
CisjZW5kaWYgLyogSU5URUxfUlBTX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3Jwc190eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
cnBzX3R5cGVzLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5jMmUy
NzkxNTRiZDUKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ycHNfdHlwZXMuaApAQCAtMCwwICsxLDkzIEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50
aWZpZXI6IE1JVAorICoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisg
Ki8KKworI2lmbmRlZiBJTlRFTF9SUFNfVFlQRVNfSAorI2RlZmluZSBJTlRFTF9SUFNfVFlQRVNf
SAorCisjaW5jbHVkZSA8bGludXgvYXRvbWljLmg+CisjaW5jbHVkZSA8bGludXgva3RpbWUuaD4K
KyNpbmNsdWRlIDxsaW51eC9tdXRleC5oPgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5j
bHVkZSA8bGludXgvd29ya3F1ZXVlLmg+CisKK3N0cnVjdCBpbnRlbF9pcHMgeworCXU2NCBsYXN0
X2NvdW50MTsKKwl1bnNpZ25lZCBsb25nIGxhc3RfdGltZTE7CisJdW5zaWduZWQgbG9uZyBjaGlw
c2V0X3Bvd2VyOworCXU2NCBsYXN0X2NvdW50MjsKKwl1NjQgbGFzdF90aW1lMjsKKwl1bnNpZ25l
ZCBsb25nIGdmeF9wb3dlcjsKKwl1OCBjb3JyOworCisJaW50IGMsIG07Cit9OworCitzdHJ1Y3Qg
aW50ZWxfcnBzX2VpIHsKKwlrdGltZV90IGt0aW1lOworCXUzMiByZW5kZXJfYzA7CisJdTMyIG1l
ZGlhX2MwOworfTsKKworc3RydWN0IGludGVsX3JwcyB7CisJc3RydWN0IG11dGV4IGxvY2s7IC8q
IHByb3RlY3RzIGVuYWJsaW5nIGFuZCB0aGUgd29ya2VyICovCisKKwkvKgorCSAqIHdvcmssIGlu
dGVycnVwdHNfZW5hYmxlZCBhbmQgcG1faWlyIGFyZSBwcm90ZWN0ZWQgYnkKKwkgKiBkZXZfcHJp
di0+aXJxX2xvY2sKKwkgKi8KKwlzdHJ1Y3Qgd29ya19zdHJ1Y3Qgd29yazsKKwlib29sIGVuYWJs
ZWQ7CisJYm9vbCBhY3RpdmU7CisJdTMyIHBtX2lpcjsKKworCS8qIFBNIGludGVycnVwdCBiaXRz
IHRoYXQgc2hvdWxkIG5ldmVyIGJlIG1hc2tlZCAqLworCXUzMiBwbV9pbnRybXNrX21iejsKKwl1
MzIgcG1fZXZlbnRzOworCisJLyogRnJlcXVlbmNpZXMgYXJlIHN0b3JlZCBpbiBwb3RlbnRpYWxs
eSBwbGF0Zm9ybSBkZXBlbmRlbnQgbXVsdGlwbGVzLgorCSAqIEluIG90aGVyIHdvcmRzLCAqX2Zy
ZXEgbmVlZHMgdG8gYmUgbXVsdGlwbGllZCBieSBYIHRvIGJlIGludGVyZXN0aW5nLgorCSAqIFNv
ZnQgbGltaXRzIGFyZSB0aG9zZSB3aGljaCBhcmUgdXNlZCBmb3IgdGhlIGR5bmFtaWMgcmVjbG9j
a2luZyBkb25lCisJICogYnkgdGhlIGRyaXZlciAocmFpc2UgZnJlcXVlbmNpZXMgdW5kZXIgaGVh
dnkgbG9hZHMsIGFuZCBsb3dlciBmb3IKKwkgKiBsaWdodGVyIGxvYWRzKS4gSGFyZCBsaW1pdHMg
YXJlIHRob3NlIGltcG9zZWQgYnkgdGhlIGhhcmR3YXJlLgorCSAqCisJICogQSBkaXN0aW5jdGlv
biBpcyBtYWRlIGZvciBvdmVyY2xvY2tpbmcsIHdoaWNoIGlzIG5ldmVyIGVuYWJsZWQgYnkKKwkg
KiBkZWZhdWx0LCBhbmQgaXMgY29uc2lkZXJlZCB0byBiZSBhYm92ZSB0aGUgaGFyZCBsaW1pdCBp
ZiBpdCdzCisJICogcG9zc2libGUgYXQgYWxsLgorCSAqLworCXU4IGN1cl9mcmVxOwkJLyogQ3Vy
cmVudCBmcmVxdWVuY3kgKGNhY2hlZCwgbWF5IG5vdCA9PSBIVykgKi8KKwl1OCBsYXN0X2ZyZXE7
CQkvKiBMYXN0IFNXUkVRIGZyZXF1ZW5jeSAqLworCXU4IG1pbl9mcmVxX3NvZnRsaW1pdDsJLyog
TWluaW11bSBmcmVxdWVuY3kgcGVybWl0dGVkIGJ5IHRoZSBkcml2ZXIgKi8KKwl1OCBtYXhfZnJl
cV9zb2Z0bGltaXQ7CS8qIE1heCBmcmVxdWVuY3kgcGVybWl0dGVkIGJ5IHRoZSBkcml2ZXIgKi8K
Kwl1OCBtYXhfZnJlcTsJCS8qIE1heGltdW0gZnJlcXVlbmN5LCBSUDAgaWYgbm90IG92ZXJjbG9j
a2luZyAqLworCXU4IG1pbl9mcmVxOwkJLyogQUtBIFJQbi4gTWluaW11bSBmcmVxdWVuY3kgKi8K
Kwl1OCBib29zdF9mcmVxOwkJLyogRnJlcXVlbmN5IHRvIHJlcXVlc3Qgd2hlbiB3YWl0IGJvb3N0
aW5nICovCisJdTggaWRsZV9mcmVxOwkJLyogRnJlcXVlbmN5IHRvIHJlcXVlc3Qgd2hlbiB3ZSBh
cmUgaWRsZSAqLworCXU4IGVmZmljaWVudF9mcmVxOwkvKiBBS0EgUlBlLiBQcmUtZGV0ZXJtaW5l
ZCBiYWxhbmNlZCBmcmVxdWVuY3kgKi8KKwl1OCBycDFfZnJlcTsJCS8qICJsZXNzIHRoYW4iIFJQ
MCBwb3dlci9mcmVxZW5jeSAqLworCXU4IHJwMF9mcmVxOwkJLyogTm9uLW92ZXJjbG9ja2VkIG1h
eCBmcmVxdWVuY3kuICovCisJdTE2IGdwbGxfcmVmX2ZyZXE7CS8qIHZsdi9jaHYgR1BMTCByZWZl
cmVuY2UgZnJlcXVlbmN5ICovCisKKwlpbnQgbGFzdF9hZGo7CisKKwlzdHJ1Y3QgeworCQlzdHJ1
Y3QgbXV0ZXggbXV0ZXg7CisKKwkJZW51bSB7IExPV19QT1dFUiwgQkVUV0VFTiwgSElHSF9QT1dF
UiB9IG1vZGU7CisJCXVuc2lnbmVkIGludCBpbnRlcmFjdGl2ZTsKKworCQl1OCB1cF90aHJlc2hv
bGQ7IC8qIEN1cnJlbnQgJWJ1c3kgcmVxdWlyZWQgdG8gdXBsb2NrICovCisJCXU4IGRvd25fdGhy
ZXNob2xkOyAvKiBDdXJyZW50ICVidXN5IHJlcXVpcmVkIHRvIGRvd25jbG9jayAqLworCX0gcG93
ZXI7CisKKwlhdG9taWNfdCBudW1fd2FpdGVyczsKKwlhdG9taWNfdCBib29zdHM7CisKKwkvKiBt
YW51YWwgd2EgcmVzaWRlbmN5IGNhbGN1bGF0aW9ucyAqLworCXN0cnVjdCBpbnRlbF9ycHNfZWkg
ZWk7CisJc3RydWN0IGludGVsX2lwcyBpcHM7Cit9OworCisjZW5kaWYgLyogSU5URUxfUlBTX1RZ
UEVTX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xs
Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbGxjLmMKaW5kZXggYTcwNTc3
ODVlNDIwLi5mZDM3NzBlNDhhYzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X2xsYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xs
Yy5jCkBAIC02LDYgKzYsNyBAQAogCiAjaW5jbHVkZSAiaW50ZWxfcG0uaCIgLyogaW50ZWxfZ3B1
X2ZyZXEoKSAqLwogI2luY2x1ZGUgInNlbGZ0ZXN0X2xsYy5oIgorI2luY2x1ZGUgImludGVsX3Jw
cy5oIgogCiBzdGF0aWMgaW50IGdlbjZfdmVyaWZ5X3JpbmdfZnJlcShzdHJ1Y3QgaW50ZWxfbGxj
ICpsbGMpCiB7CkBAIC0yNSw2ICsyNiw4IEBAIHN0YXRpYyBpbnQgZ2VuNl92ZXJpZnlfcmluZ19m
cmVxKHN0cnVjdCBpbnRlbF9sbGMgKmxsYykKIAlmb3IgKGdwdV9mcmVxID0gY29uc3RzLm1pbl9n
cHVfZnJlcTsKIAkgICAgIGdwdV9mcmVxIDw9IGNvbnN0cy5tYXhfZ3B1X2ZyZXE7CiAJICAgICBn
cHVfZnJlcSsrKSB7CisJCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZsbGNfdG9fZ3QobGxjKS0+
cnBzOworCiAJCXVuc2lnbmVkIGludCBpYV9mcmVxLCByaW5nX2ZyZXEsIGZvdW5kOwogCQl1MzIg
dmFsOwogCkBAIC00NCw3ICs0Nyw3IEBAIHN0YXRpYyBpbnQgZ2VuNl92ZXJpZnlfcmluZ19mcmVx
KHN0cnVjdCBpbnRlbF9sbGMgKmxsYykKIAkJaWYgKGZvdW5kICE9IGlhX2ZyZXEpIHsKIAkJCXBy
X2VycigiTWluIGZyZXEgdGFibGUoJWQvWyVkLCAlZF0pOiVkTUh6IGRpZCBub3QgbWF0Y2ggZXhw
ZWN0ZWQgQ1BVIGZyZXEsIGZvdW5kICVkLCBleHBlY3RlZCAlZFxuIiwKIAkJCSAgICAgICBncHVf
ZnJlcSwgY29uc3RzLm1pbl9ncHVfZnJlcSwgY29uc3RzLm1heF9ncHVfZnJlcSwKLQkJCSAgICAg
ICBpbnRlbF9ncHVfZnJlcShpOTE1LCBncHVfZnJlcSAqIChJTlRFTF9HRU4oaTkxNSkgPj0gOSA/
IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKSksCisJCQkgICAgICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBn
cHVfZnJlcSAqIChJTlRFTF9HRU4oaTkxNSkgPj0gOSA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKSks
CiAJCQkgICAgICAgZm91bmQsIGlhX2ZyZXEpOwogCQkJZXJyID0gLUVJTlZBTDsKIAkJCWJyZWFr
OwpAQCAtNTQsNyArNTcsNyBAQCBzdGF0aWMgaW50IGdlbjZfdmVyaWZ5X3JpbmdfZnJlcShzdHJ1
Y3QgaW50ZWxfbGxjICpsbGMpCiAJCWlmIChmb3VuZCAhPSByaW5nX2ZyZXEpIHsKIAkJCXByX2Vy
cigiTWluIGZyZXEgdGFibGUoJWQvWyVkLCAlZF0pOiVkTUh6IGRpZCBub3QgbWF0Y2ggZXhwZWN0
ZWQgcmluZyBmcmVxLCBmb3VuZCAlZCwgZXhwZWN0ZWQgJWRcbiIsCiAJCQkgICAgICAgZ3B1X2Zy
ZXEsIGNvbnN0cy5taW5fZ3B1X2ZyZXEsIGNvbnN0cy5tYXhfZ3B1X2ZyZXEsCi0JCQkgICAgICAg
aW50ZWxfZ3B1X2ZyZXEoaTkxNSwgZ3B1X2ZyZXEgKiAoSU5URUxfR0VOKGk5MTUpID49IDkgPyBH
RU45X0ZSRVFfU0NBTEVSIDogMSkpLAorCQkJICAgICAgIGludGVsX2dwdV9mcmVxKHJwcywgZ3B1
X2ZyZXEgKiAoSU5URUxfR0VOKGk5MTUpID49IDkgPyBHRU45X0ZSRVFfU0NBTEVSIDogMSkpLAog
CQkJICAgICAgIGZvdW5kLCByaW5nX2ZyZXEpOwogCQkJZXJyID0gLUVJTlZBTDsKIAkJCWJyZWFr
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1p
c3Npb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9u
LmMKaW5kZXggMWIxNjkxYWFlZDI4Li5iN2Y4NTE0ZTliMWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwpAQCAtMTAxMSw3ICsxMDEx
LDcgQEAgdm9pZCBpbnRlbF9ndWNfc3VibWlzc2lvbl9maW5pKHN0cnVjdCBpbnRlbF9ndWMgKmd1
YykKIAogc3RhdGljIHZvaWQgZ3VjX2ludGVycnVwdHNfY2FwdHVyZShzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0KQogewotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZndC0+aTkxNS0+Z3RfcG0ucnBzOwor
CXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZndC0+cnBzOwogCXN0cnVjdCBpbnRlbF91bmNvcmUg
KnVuY29yZSA9IGd0LT51bmNvcmU7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwog
CWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwpAQCAtMTA1Nyw3ICsxMDU3LDcgQEAgc3RhdGljIHZv
aWQgZ3VjX2ludGVycnVwdHNfY2FwdHVyZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCiBzdGF0aWMg
dm9pZCBndWNfaW50ZXJydXB0c19yZWxlYXNlKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7Ci0Jc3Ry
dWN0IGludGVsX3JwcyAqcnBzID0gJmd0LT5pOTE1LT5ndF9wbS5ycHM7CisJc3RydWN0IGludGVs
X3JwcyAqcnBzID0gJmd0LT5ycHM7CiAJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3Qt
PnVuY29yZTsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CiAJZW51bSBpbnRlbF9l
bmdpbmVfaWQgaWQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVn
ZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCmluZGV4IGIzZjc4ZTY0
OTVmZC4uNTdmZWE3NTI4YTY2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2RlYnVnZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwpAQCAt
NDQsNiArNDQsNyBAQAogI2luY2x1ZGUgImd0L2ludGVsX2d0X3JlcXVlc3RzLmgiCiAjaW5jbHVk
ZSAiZ3QvaW50ZWxfcmVzZXQuaCIKICNpbmNsdWRlICJndC9pbnRlbF9yYzYuaCIKKyNpbmNsdWRl
ICJndC9pbnRlbF9ycHMuaCIKICNpbmNsdWRlICJndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5o
IgogCiAjaW5jbHVkZSAiaTkxNV9kZWJ1Z2ZzLmgiCkBAIC03OTEsNyArNzkyLDcgQEAgc3RhdGlj
IGludCBpOTE1X2ZyZXF1ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2Vk
KQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNSht
LT5wcml2YXRlKTsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVu
Y29yZTsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKKwlz
dHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0LnJwczsKIAlpbnRlbF93YWtlcmVm
X3Qgd2FrZXJlZjsKIAlpbnQgcmV0ID0gMDsKIApAQCAtODI3LDIzICs4MjgsMjMgQEAgc3RhdGlj
IGludCBpOTE1X2ZyZXF1ZW5jeV9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2Vk
KQogCQlzZXFfcHJpbnRmKG0sICJERFIgZnJlcTogJWQgTUh6XG4iLCBkZXZfcHJpdi0+bWVtX2Zy
ZXEpOwogCiAJCXNlcV9wcmludGYobSwgImFjdHVhbCBHUFUgZnJlcTogJWQgTUh6XG4iLAotCQkJ
ICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIChmcmVxX3N0cyA+PiA4KSAmIDB4ZmYpKTsKKwkJ
CSAgIGludGVsX2dwdV9mcmVxKHJwcywgKGZyZXFfc3RzID4+IDgpICYgMHhmZikpOwogCiAJCXNl
cV9wcmludGYobSwgImN1cnJlbnQgR1BVIGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dw
dV9mcmVxKGRldl9wcml2LCBycHMtPmN1cl9mcmVxKSk7CisJCQkgICBpbnRlbF9ncHVfZnJlcShy
cHMsIHJwcy0+Y3VyX2ZyZXEpKTsKIAogCQlzZXFfcHJpbnRmKG0sICJtYXggR1BVIGZyZXE6ICVk
IE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPm1heF9mcmVxKSk7
CisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKIAogCQlzZXFfcHJp
bnRmKG0sICJtaW4gR1BVIGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRl
dl9wcml2LCBycHMtPm1pbl9mcmVxKSk7CisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+
bWluX2ZyZXEpKTsKIAogCQlzZXFfcHJpbnRmKG0sICJpZGxlIEdQVSBmcmVxOiAlZCBNSHpcbiIs
Ci0JCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5pZGxlX2ZyZXEpKTsKKwkJCSAg
IGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5pZGxlX2ZyZXEpKTsKIAogCQlzZXFfcHJpbnRmKG0s
CiAJCQkgICAiZWZmaWNpZW50IChSUGUpIGZyZXF1ZW5jeTogJWQgTUh6XG4iLAotCQkJICAgaW50
ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpKTsKKwkJCSAgIGludGVs
X2dwdV9mcmVxKHJwcywgcnBzLT5lZmZpY2llbnRfZnJlcSkpOwogCX0gZWxzZSBpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA+PSA2KSB7CiAJCXUzMiBycF9zdGF0ZV9saW1pdHM7CiAJCXUzMiBndF9w
ZXJmX3N0YXR1czsKQEAgLTg3Nyw3ICs4NzgsNyBAQCBzdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5
X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJCQllbHNlCiAJCQkJcmVx
ZiA+Pj0gMjU7CiAJCX0KLQkJcmVxZiA9IGludGVsX2dwdV9mcmVxKGRldl9wcml2LCByZXFmKTsK
KwkJcmVxZiA9IGludGVsX2dwdV9mcmVxKHJwcywgcmVxZik7CiAKIAkJcnBtb2RlY3RsID0gSTkx
NV9SRUFEKEdFTjZfUlBfQ09OVFJPTCk7CiAJCXJwaW5jbGltaXQgPSBJOTE1X1JFQUQoR0VONl9S
UF9VUF9USFJFU0hPTEQpOwpAQCAtODkwLDggKzg5MSw3IEBAIHN0YXRpYyBpbnQgaTkxNV9mcmVx
dWVuY3lfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAkJcnBkb3duZWkg
PSBJOTE1X1JFQUQoR0VONl9SUF9DVVJfRE9XTl9FSSkgJiBHRU42X0NVUklBVkdfTUFTSzsKIAkJ
cnBjdXJkb3duID0gSTkxNV9SRUFEKEdFTjZfUlBfQ1VSX0RPV04pICYgR0VONl9DVVJCU1lUQVZH
X01BU0s7CiAJCXJwcHJldmRvd24gPSBJOTE1X1JFQUQoR0VONl9SUF9QUkVWX0RPV04pICYgR0VO
Nl9DVVJCU1lUQVZHX01BU0s7Ci0JCWNhZ2YgPSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwKLQkJ
CQkgICAgICBpbnRlbF9nZXRfY2FnZihkZXZfcHJpdiwgcnBzdGF0KSk7CisJCWNhZ2YgPSBpbnRl
bF9ncHVfZnJlcShycHMsIGludGVsX2dldF9jYWdmKHJwcywgcnBzdGF0KSk7CiAKIAkJaW50ZWxf
dW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwog
CkBAIC05NjgsMzcgKzk2OCwzNyBAQCBzdGF0aWMgaW50IGk5MTVfZnJlcXVlbmN5X2luZm8oc3Ry
dWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJCW1heF9mcmVxICo9IChJU19HRU45X0JD
KGRldl9wcml2KSB8fAogCQkJICAgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwID8gR0VOOV9G
UkVRX1NDQUxFUiA6IDEpOwogCQlzZXFfcHJpbnRmKG0sICJMb3dlc3QgKFJQTikgZnJlcXVlbmN5
OiAlZE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBtYXhfZnJlcSkpOwor
CQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBtYXhfZnJlcSkpOwogCiAJCW1heF9mcmVxID0gKHJw
X3N0YXRlX2NhcCAmIDB4ZmYwMCkgPj4gODsKIAkJbWF4X2ZyZXEgKj0gKElTX0dFTjlfQkMoZGV2
X3ByaXYpIHx8CiAJCQkgICAgIElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTAgPyBHRU45X0ZSRVFf
U0NBTEVSIDogMSk7CiAJCXNlcV9wcmludGYobSwgIk5vbWluYWwgKFJQMSkgZnJlcXVlbmN5OiAl
ZE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBtYXhfZnJlcSkpOworCQkJ
ICAgaW50ZWxfZ3B1X2ZyZXEocnBzLCBtYXhfZnJlcSkpOwogCiAJCW1heF9mcmVxID0gKElTX0dF
TjlfTFAoZGV2X3ByaXYpID8gcnBfc3RhdGVfY2FwID4+IDE2IDoKIAkJCSAgICBycF9zdGF0ZV9j
YXAgPj4gMCkgJiAweGZmOwogCQltYXhfZnJlcSAqPSAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwK
IAkJCSAgICAgSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCA/IEdFTjlfRlJFUV9TQ0FMRVIgOiAx
KTsKIAkJc2VxX3ByaW50ZihtLCAiTWF4IG5vbi1vdmVyY2xvY2tlZCAoUlAwKSBmcmVxdWVuY3k6
ICVkTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIG1heF9mcmVxKSk7CisJ
CQkgICBpbnRlbF9ncHVfZnJlcShycHMsIG1heF9mcmVxKSk7CiAJCXNlcV9wcmludGYobSwgIk1h
eCBvdmVyY2xvY2tlZCBmcmVxdWVuY3k6ICVkTUh6XG4iLAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEo
ZGV2X3ByaXYsIHJwcy0+bWF4X2ZyZXEpKTsKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBz
LT5tYXhfZnJlcSkpOwogCiAJCXNlcV9wcmludGYobSwgIkN1cnJlbnQgZnJlcTogJWQgTUh6XG4i
LAotCQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+Y3VyX2ZyZXEpKTsKKwkJCSAg
IGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5jdXJfZnJlcSkpOwogCQlzZXFfcHJpbnRmKG0sICJB
Y3R1YWwgZnJlcTogJWQgTUh6XG4iLCBjYWdmKTsKIAkJc2VxX3ByaW50ZihtLCAiSWRsZSBmcmVx
OiAlZCBNSHpcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5pZGxlX2Zy
ZXEpKTsKKwkJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5pZGxlX2ZyZXEpKTsKIAkJc2Vx
X3ByaW50ZihtLCAiTWluIGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRl
dl9wcml2LCBycHMtPm1pbl9mcmVxKSk7CisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+
bWluX2ZyZXEpKTsKIAkJc2VxX3ByaW50ZihtLCAiQm9vc3QgZnJlcTogJWQgTUh6XG4iLAotCQkJ
ICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+Ym9vc3RfZnJlcSkpOworCQkJICAgaW50
ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmJvb3N0X2ZyZXEpKTsKIAkJc2VxX3ByaW50ZihtLCAiTWF4
IGZyZXE6ICVkIE1IelxuIiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPm1h
eF9mcmVxKSk7CisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXEpKTsKIAkJ
c2VxX3ByaW50ZihtLAogCQkJICAgImVmZmljaWVudCAoUlBlKSBmcmVxdWVuY3k6ICVkIE1Ielxu
IiwKLQkJCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPmVmZmljaWVudF9mcmVxKSk7
CisJCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpKTsKIAl9IGVs
c2UgewogCQlzZXFfcHV0cyhtLCAibm8gUC1zdGF0ZSBpbmZvIGF2YWlsYWJsZVxuIik7CiAJfQpA
QCAtMTM3NSw3ICsxMzc1LDcgQEAgc3RhdGljIGludCBpOTE1X3NyX3N0YXR1cyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIHN0YXRpYyBpbnQgaTkxNV9yaW5nX2ZyZXFfdGFibGUo
c3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiB7CiAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCXN0cnVjdCBpbnRl
bF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOworCXN0cnVjdCBpbnRlbF9ycHMgKnJw
cyA9ICZkZXZfcHJpdi0+Z3QucnBzOwogCXVuc2lnbmVkIGludCBtYXhfZ3B1X2ZyZXEsIG1pbl9n
cHVfZnJlcTsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAlpbnQgZ3B1X2ZyZXEsIGlhX2Zy
ZXE7CkBAIC0xNDAwLDEwICsxNDAwLDExIEBAIHN0YXRpYyBpbnQgaTkxNV9yaW5nX2ZyZXFfdGFi
bGUoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJCQkJICAgICAgIEdFTjZfUENP
REVfUkVBRF9NSU5fRlJFUV9UQUJMRSwKIAkJCQkgICAgICAgJmlhX2ZyZXEsIE5VTEwpOwogCQlz
ZXFfcHJpbnRmKG0sICIlZFx0XHQlZFx0XHRcdFx0JWRcbiIsCi0JCQkgICBpbnRlbF9ncHVfZnJl
cShkZXZfcHJpdiwgKGdwdV9mcmVxICoKLQkJCQkJCSAgICAgKElTX0dFTjlfQkMoZGV2X3ByaXYp
IHx8Ci0JCQkJCQkgICAgICBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwID8KLQkJCQkJCSAgICAg
IEdFTjlfRlJFUV9TQ0FMRVIgOiAxKSkpLAorCQkJICAgaW50ZWxfZ3B1X2ZyZXEocnBzLAorCQkJ
CQkgIChncHVfZnJlcSAqCisJCQkJCSAgIChJU19HRU45X0JDKGRldl9wcml2KSB8fAorCQkJCQkg
ICAgSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMCA/CisJCQkJCSAgICBHRU45X0ZSRVFfU0NBTEVS
IDogMSkpKSwKIAkJCSAgICgoaWFfZnJlcSA+PiAwKSAmIDB4ZmYpICogMTAwLAogCQkJICAgKChp
YV9mcmVxID4+IDgpICYgMHhmZikgKiAxMDApOwogCX0KQEAgLTE2MzEsNyArMTYzMiw3IEBAIHN0
YXRpYyBjb25zdCBjaGFyICpycHNfcG93ZXJfdG9fc3RyKHVuc2lnbmVkIGludCBwb3dlcikKIHN0
YXRpYyBpbnQgaTkxNV9ycHNfYm9vc3RfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRh
dGEpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1
KG0tPnByaXZhdGUpOwotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0u
cnBzOworCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3QucnBzOwogCXUzMiBh
Y3RfZnJlcSA9IHJwcy0+Y3VyX2ZyZXE7CiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CiAKQEAg
LTE2NDMsNyArMTY0NCw3IEBAIHN0YXRpYyBpbnQgaTkxNV9ycHNfYm9vc3RfaW5mbyhzdHJ1Y3Qg
c2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJCQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKIAkJ
CWFjdF9mcmVxID0gKGFjdF9mcmVxID4+IDgpICYgMHhmZjsKIAkJfSBlbHNlIHsKLQkJCWFjdF9m
cmVxID0gaW50ZWxfZ2V0X2NhZ2YoZGV2X3ByaXYsCisJCQlhY3RfZnJlcSA9IGludGVsX2dldF9j
YWdmKHJwcywKIAkJCQkJCSAgSTkxNV9SRUFEKEdFTjZfUlBTVEFUMSkpOwogCQl9CiAJfQpAQCAt
MTY1NCwxNyArMTY1NSwxNyBAQCBzdGF0aWMgaW50IGk5MTVfcnBzX2Jvb3N0X2luZm8oc3RydWN0
IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogCQkgICBhdG9taWNfcmVhZCgmcnBzLT5udW1fd2Fp
dGVycykpOwogCXNlcV9wcmludGYobSwgIkludGVyYWN0aXZlPyAlZFxuIiwgUkVBRF9PTkNFKHJw
cy0+cG93ZXIuaW50ZXJhY3RpdmUpKTsKIAlzZXFfcHJpbnRmKG0sICJGcmVxdWVuY3kgcmVxdWVz
dGVkICVkLCBhY3R1YWwgJWRcbiIsCi0JCSAgIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMt
PmN1cl9mcmVxKSwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIGFjdF9mcmVxKSk7CisJ
CSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5jdXJfZnJlcSksCisJCSAgIGludGVsX2dwdV9m
cmVxKHJwcywgYWN0X2ZyZXEpKTsKIAlzZXFfcHJpbnRmKG0sICIgIG1pbiBoYXJkOiVkLCBzb2Z0
OiVkOyBtYXggc29mdDolZCwgaGFyZDolZFxuIiwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3By
aXYsIHJwcy0+bWluX2ZyZXEpLAotCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5t
aW5fZnJlcV9zb2Z0bGltaXQpLAotCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5t
YXhfZnJlcV9zb2Z0bGltaXQpLAotCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5t
YXhfZnJlcSkpOworCQkgICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXEpLAorCQkg
ICBpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KSwKKwkJICAgaW50
ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCksCisJCSAgIGludGVsX2dw
dV9mcmVxKHJwcywgcnBzLT5tYXhfZnJlcSkpOwogCXNlcV9wcmludGYobSwgIiAgaWRsZTolZCwg
ZWZmaWNpZW50OiVkLCBib29zdDolZFxuIiwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYs
IHJwcy0+aWRsZV9mcmVxKSwKLQkJICAgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+ZWZm
aWNpZW50X2ZyZXEpLAotCQkgICBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5ib29zdF9m
cmVxKSk7CisJCSAgIGludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5pZGxlX2ZyZXEpLAorCQkgICBp
bnRlbF9ncHVfZnJlcShycHMsIHJwcy0+ZWZmaWNpZW50X2ZyZXEpLAorCQkgICBpbnRlbF9ncHVf
ZnJlcShycHMsIHJwcy0+Ym9vc3RfZnJlcSkpOwogCiAJc2VxX3ByaW50ZihtLCAiV2FpdCBib29z
dHM6ICVkXG4iLCBhdG9taWNfcmVhZCgmcnBzLT5ib29zdHMpKTsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmMKaW5kZXggMjRhMzk4ODI4MWQyLi4zNTU1MjZhMzVkNTggMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuYwpAQCAtMTc5NCw3ICsxNzk0LDYgQEAgc3RhdGljIGludCBpOTE1X2RybV9yZXN1bWUo
c3RydWN0IGRybV9kZXZpY2UgKmRldikKIAlpbnQgcmV0OwogCiAJZGlzYWJsZV9ycG1fd2FrZXJl
Zl9hc3NlcnRzKCZkZXZfcHJpdi0+cnVudGltZV9wbSk7Ci0JaW50ZWxfZ3RfcG1fZGlzYWJsZSgm
ZGV2X3ByaXYtPmd0KTsKIAogCWk5MTVfZ2VtX3Nhbml0aXplKGRldl9wcml2KTsKIApAQCAtMTky
NSw4ICsxOTI0LDYgQEAgc3RhdGljIGludCBpOTE1X2RybV9yZXN1bWVfZWFybHkoc3RydWN0IGRy
bV9kZXZpY2UgKmRldikKIAogCWludGVsX2Rpc3BsYXlfcG93ZXJfcmVzdW1lX2Vhcmx5KGRldl9w
cml2KTsKIAotCWludGVsX2d0X3BtX2Rpc2FibGUoJmRldl9wcml2LT5ndCk7Ci0KIAlpbnRlbF9w
b3dlcl9kb21haW5zX3Jlc3VtZShkZXZfcHJpdik7CiAKIAlpbnRlbF9ndF9zYW5pdGl6ZSgmZGV2
X3ByaXYtPmd0LCB0cnVlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4IDE2ZTU4YTc0ZmE2
Zi4uNGI4MDU3YjQ4MTFlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Ry
di5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKQEAgLTU0Myw5NCArNTQz
LDYgQEAgc3RydWN0IGk5MTVfc3VzcGVuZF9zYXZlZF9yZWdpc3RlcnMgewogCiBzdHJ1Y3Qgdmx2
X3MwaXhfc3RhdGU7CiAKLXN0cnVjdCBpbnRlbF9ycHNfZWkgewotCWt0aW1lX3Qga3RpbWU7Ci0J
dTMyIHJlbmRlcl9jMDsKLQl1MzIgbWVkaWFfYzA7Ci19OwotCi1zdHJ1Y3QgaW50ZWxfcnBzIHsK
LQlzdHJ1Y3QgbXV0ZXggbG9jazsgLyogcHJvdGVjdHMgZW5hYmxpbmcgYW5kIHRoZSB3b3JrZXIg
Ki8KLQotCS8qCi0JICogd29yaywgaW50ZXJydXB0c19lbmFibGVkIGFuZCBwbV9paXIgYXJlIHBy
b3RlY3RlZCBieQotCSAqIGRldl9wcml2LT5pcnFfbG9jawotCSAqLwotCXN0cnVjdCB3b3JrX3N0
cnVjdCB3b3JrOwotCWJvb2wgaW50ZXJydXB0c19lbmFibGVkOwotCXUzMiBwbV9paXI7Ci0KLQkv
KiBQTSBpbnRlcnJ1cHQgYml0cyB0aGF0IHNob3VsZCBuZXZlciBiZSBtYXNrZWQgKi8KLQl1MzIg
cG1faW50cm1za19tYno7Ci0KLQkvKiBGcmVxdWVuY2llcyBhcmUgc3RvcmVkIGluIHBvdGVudGlh
bGx5IHBsYXRmb3JtIGRlcGVuZGVudCBtdWx0aXBsZXMuCi0JICogSW4gb3RoZXIgd29yZHMsICpf
ZnJlcSBuZWVkcyB0byBiZSBtdWx0aXBsaWVkIGJ5IFggdG8gYmUgaW50ZXJlc3RpbmcuCi0JICog
U29mdCBsaW1pdHMgYXJlIHRob3NlIHdoaWNoIGFyZSB1c2VkIGZvciB0aGUgZHluYW1pYyByZWNs
b2NraW5nIGRvbmUKLQkgKiBieSB0aGUgZHJpdmVyIChyYWlzZSBmcmVxdWVuY2llcyB1bmRlciBo
ZWF2eSBsb2FkcywgYW5kIGxvd2VyIGZvcgotCSAqIGxpZ2h0ZXIgbG9hZHMpLiBIYXJkIGxpbWl0
cyBhcmUgdGhvc2UgaW1wb3NlZCBieSB0aGUgaGFyZHdhcmUuCi0JICoKLQkgKiBBIGRpc3RpbmN0
aW9uIGlzIG1hZGUgZm9yIG92ZXJjbG9ja2luZywgd2hpY2ggaXMgbmV2ZXIgZW5hYmxlZCBieQot
CSAqIGRlZmF1bHQsIGFuZCBpcyBjb25zaWRlcmVkIHRvIGJlIGFib3ZlIHRoZSBoYXJkIGxpbWl0
IGlmIGl0J3MKLQkgKiBwb3NzaWJsZSBhdCBhbGwuCi0JICovCi0JdTggY3VyX2ZyZXE7CQkvKiBD
dXJyZW50IGZyZXF1ZW5jeSAoY2FjaGVkLCBtYXkgbm90ID09IEhXKSAqLwotCXU4IG1pbl9mcmVx
X3NvZnRsaW1pdDsJLyogTWluaW11bSBmcmVxdWVuY3kgcGVybWl0dGVkIGJ5IHRoZSBkcml2ZXIg
Ki8KLQl1OCBtYXhfZnJlcV9zb2Z0bGltaXQ7CS8qIE1heCBmcmVxdWVuY3kgcGVybWl0dGVkIGJ5
IHRoZSBkcml2ZXIgKi8KLQl1OCBtYXhfZnJlcTsJCS8qIE1heGltdW0gZnJlcXVlbmN5LCBSUDAg
aWYgbm90IG92ZXJjbG9ja2luZyAqLwotCXU4IG1pbl9mcmVxOwkJLyogQUtBIFJQbi4gTWluaW11
bSBmcmVxdWVuY3kgKi8KLQl1OCBib29zdF9mcmVxOwkJLyogRnJlcXVlbmN5IHRvIHJlcXVlc3Qg
d2hlbiB3YWl0IGJvb3N0aW5nICovCi0JdTggaWRsZV9mcmVxOwkJLyogRnJlcXVlbmN5IHRvIHJl
cXVlc3Qgd2hlbiB3ZSBhcmUgaWRsZSAqLwotCXU4IGVmZmljaWVudF9mcmVxOwkvKiBBS0EgUlBl
LiBQcmUtZGV0ZXJtaW5lZCBiYWxhbmNlZCBmcmVxdWVuY3kgKi8KLQl1OCBycDFfZnJlcTsJCS8q
ICJsZXNzIHRoYW4iIFJQMCBwb3dlci9mcmVxZW5jeSAqLwotCXU4IHJwMF9mcmVxOwkJLyogTm9u
LW92ZXJjbG9ja2VkIG1heCBmcmVxdWVuY3kuICovCi0JdTE2IGdwbGxfcmVmX2ZyZXE7CS8qIHZs
di9jaHYgR1BMTCByZWZlcmVuY2UgZnJlcXVlbmN5ICovCi0KLQlpbnQgbGFzdF9hZGo7Ci0KLQlz
dHJ1Y3QgewotCQlzdHJ1Y3QgbXV0ZXggbXV0ZXg7Ci0KLQkJZW51bSB7IExPV19QT1dFUiwgQkVU
V0VFTiwgSElHSF9QT1dFUiB9IG1vZGU7Ci0JCXVuc2lnbmVkIGludCBpbnRlcmFjdGl2ZTsKLQot
CQl1OCB1cF90aHJlc2hvbGQ7IC8qIEN1cnJlbnQgJWJ1c3kgcmVxdWlyZWQgdG8gdXBsb2NrICov
Ci0JCXU4IGRvd25fdGhyZXNob2xkOyAvKiBDdXJyZW50ICVidXN5IHJlcXVpcmVkIHRvIGRvd25j
bG9jayAqLwotCX0gcG93ZXI7Ci0KLQlib29sIGVuYWJsZWQ7Ci0JYXRvbWljX3QgbnVtX3dhaXRl
cnM7Ci0JYXRvbWljX3QgYm9vc3RzOwotCi0JLyogbWFudWFsIHdhIHJlc2lkZW5jeSBjYWxjdWxh
dGlvbnMgKi8KLQlzdHJ1Y3QgaW50ZWxfcnBzX2VpIGVpOwotfTsKLQotc3RydWN0IGludGVsX2dl
bjZfcG93ZXJfbWdtdCB7Ci0Jc3RydWN0IGludGVsX3JwcyBycHM7Ci19OwotCi0vKiBkZWZpbmVk
IGludGVsX3BtLmMgKi8KLWV4dGVybiBzcGlubG9ja190IG1jaGRldl9sb2NrOwotCi1zdHJ1Y3Qg
aW50ZWxfaWxrX3Bvd2VyX21nbXQgewotCXU4IGN1cl9kZWxheTsKLQl1OCBtaW5fZGVsYXk7Ci0J
dTggbWF4X2RlbGF5OwotCXU4IGZtYXg7Ci0JdTggZnN0YXJ0OwotCi0JdTY0IGxhc3RfY291bnQx
OwotCXVuc2lnbmVkIGxvbmcgbGFzdF90aW1lMTsKLQl1bnNpZ25lZCBsb25nIGNoaXBzZXRfcG93
ZXI7Ci0JdTY0IGxhc3RfY291bnQyOwotCXU2NCBsYXN0X3RpbWUyOwotCXVuc2lnbmVkIGxvbmcg
Z2Z4X3Bvd2VyOwotCXU4IGNvcnI7Ci0KLQlpbnQgY19tOwotCWludCByX3Q7Ci19OwotCiAjZGVm
aW5lIE1BWF9MM19TTElDRVMgMgogc3RydWN0IGludGVsX2wzX3Bhcml0eSB7CiAJdTMyICpyZW1h
cF9pbmZvW01BWF9MM19TTElDRVNdOwpAQCAtMTA2Nyw3ICs5NzksNiBAQCBzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSB7CiAJCXUzMiBpcnFfbWFzazsKIAkJdTMyIGRlX2lycV9tYXNrW0k5MTVfTUFY
X1BJUEVTXTsKIAl9OwotCXUzMiBwbV9ycHNfZXZlbnRzOwogCXUzMiBwaXBlc3RhdF9pcnFfbWFz
a1tJOTE1X01BWF9QSVBFU107CiAKIAlzdHJ1Y3QgaTkxNV9ob3RwbHVnIGhvdHBsdWc7CkBAIC0x
MjA3LDEzICsxMTE4LDYgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgewogCSAqLwogCXUzMiBl
ZHJhbV9zaXplX21iOwogCi0JLyogZ2VuNisgR1QgUE0gc3RhdGUgKi8KLQlzdHJ1Y3QgaW50ZWxf
Z2VuNl9wb3dlcl9tZ210IGd0X3BtOwotCi0JLyogaWxrLW9ubHkgaXBzL3JwcyBzdGF0ZS4gRXZl
cnl0aGluZyBpbiBoZXJlIGlzIHByb3RlY3RlZCBieSB0aGUgZ2xvYmFsCi0JICogbWNoZGV2X2xv
Y2sgaW4gaW50ZWxfcG0uYyAqLwotCXN0cnVjdCBpbnRlbF9pbGtfcG93ZXJfbWdtdCBpcHM7Ci0K
IAlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zIHBvd2VyX2RvbWFpbnM7CiAKIAlzdHJ1Y3QgaTkx
NV9wc3IgcHNyOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKaW5kZXggMzE5ZTk2ZDgzM2ZhLi4wZjI3
MWE1MzAxMmQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwpAQCAtNTIsNiArNTIsNyBAQAogI2lu
Y2x1ZGUgImd0L2ludGVsX21vY3MuaCIKICNpbmNsdWRlICJndC9pbnRlbF9yZXNldC5oIgogI2lu
Y2x1ZGUgImd0L2ludGVsX3JlbmRlcnN0YXRlLmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxfcnBzLmgi
CiAjaW5jbHVkZSAiZ3QvaW50ZWxfd29ya2Fyb3VuZHMuaCIKIAogI2luY2x1ZGUgImk5MTVfZHJ2
LmgiCkBAIC0xMjY5LDggKzEyNzAsNiBAQCBpbnQgaTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCWdvdG8gZXJyX2NvbnRleHQ7CiAJfQogCi0JaW50ZWxf
aW5pdF9ndF9wb3dlcnNhdmUoZGV2X3ByaXYpOwotCiAJaW50ZWxfdWNfaW5pdCgmZGV2X3ByaXYt
Pmd0LnVjKTsKIAogCXJldCA9IGludGVsX2d0X2luaXRfaHcoJmRldl9wcml2LT5ndCk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9pcnEuYwppbmRleCA1NzJhNWMzN2NjNjEuLjU5ODkyNGIzYzU1NiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2lycS5jCkBAIC00NSw2ICs0NSw3IEBACiAjaW5jbHVkZSAiZ3QvaW50ZWxf
Z3QuaCIKICNpbmNsdWRlICJndC9pbnRlbF9ndF9pcnEuaCIKICNpbmNsdWRlICJndC9pbnRlbF9n
dF9wbV9pcnEuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9ycHMuaCIKIAogI2luY2x1ZGUgImk5MTVf
ZHJ2LmgiCiAjaW5jbHVkZSAiaTkxNV9pcnEuaCIKQEAgLTMyNyw4NyArMzI4LDYgQEAgc3RhdGlj
IGk5MTVfcmVnX3QgZ2VuNl9wbV9paXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQogCXJldHVybiBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDggPyBHRU44X0dUX0lJUigyKSA6IEdF
TjZfUE1JSVI7CiB9CiAKLXZvaWQgZ2VuMTFfcmVzZXRfcnBzX2ludGVycnVwdHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSAmZGV2
X3ByaXYtPmd0OwotCi0Jc3Bpbl9sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKLQotCXdoaWxlIChn
ZW4xMV9ndF9yZXNldF9vbmVfaWlyKGd0LCAwLCBHRU4xMV9HVFBNKSkKLQkJOwotCi0JZGV2X3By
aXYtPmd0X3BtLnJwcy5wbV9paXIgPSAwOwotCi0Jc3Bpbl91bmxvY2tfaXJxKCZndC0+aXJxX2xv
Y2spOwotfQotCi12b2lkIGdlbjZfcmVzZXRfcnBzX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSAmZGV2X3ByaXYt
Pmd0OwotCi0Jc3Bpbl9sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKLQlnZW42X2d0X3BtX3Jlc2V0
X2lpcihndCwgR0VONl9QTV9SUFNfRVZFTlRTKTsKLQlkZXZfcHJpdi0+Z3RfcG0ucnBzLnBtX2lp
ciA9IDA7Ci0Jc3Bpbl91bmxvY2tfaXJxKCZndC0+aXJxX2xvY2spOwotfQotCi12b2lkIGdlbjZf
ZW5hYmxlX3Jwc19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
LXsKLQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gJmRldl9wcml2LT5ndDsKLQlzdHJ1Y3QgaW50ZWxf
cnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKLQotCWlmIChSRUFEX09OQ0UocnBzLT5p
bnRlcnJ1cHRzX2VuYWJsZWQpKQotCQlyZXR1cm47Ci0KLQlzcGluX2xvY2tfaXJxKCZndC0+aXJx
X2xvY2spOwotCVdBUk5fT05fT05DRShycHMtPnBtX2lpcik7Ci0KLQlpZiAoSU5URUxfR0VOKGRl
dl9wcml2KSA+PSAxMSkKLQkJV0FSTl9PTl9PTkNFKGdlbjExX2d0X3Jlc2V0X29uZV9paXIoZ3Qs
IDAsIEdFTjExX0dUUE0pKTsKLQllbHNlCi0JCVdBUk5fT05fT05DRShJOTE1X1JFQUQoZ2VuNl9w
bV9paXIoZGV2X3ByaXYpKSAmIGRldl9wcml2LT5wbV9ycHNfZXZlbnRzKTsKLQotCXJwcy0+aW50
ZXJydXB0c19lbmFibGVkID0gdHJ1ZTsKLQlnZW42X2d0X3BtX2VuYWJsZV9pcnEoZ3QsIGRldl9w
cml2LT5wbV9ycHNfZXZlbnRzKTsKLQotCXNwaW5fdW5sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsK
LX0KLQotdTMyIGdlbjZfc2FuaXRpemVfcnBzX3BtX21hc2soY29uc3Qgc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsIHUzMiBtYXNrKQotewotCXJldHVybiBtYXNrICYgfmk5MTUtPmd0X3Bt
LnJwcy5wbV9pbnRybXNrX21iejsKLX0KLQotdm9pZCBnZW42X2Rpc2FibGVfcnBzX2ludGVycnVw
dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBpbnRlbF9y
cHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSAm
ZGV2X3ByaXYtPmd0OwotCi0JaWYgKCFSRUFEX09OQ0UocnBzLT5pbnRlcnJ1cHRzX2VuYWJsZWQp
KQotCQlyZXR1cm47Ci0KLQlzcGluX2xvY2tfaXJxKCZndC0+aXJxX2xvY2spOwotCXJwcy0+aW50
ZXJydXB0c19lbmFibGVkID0gZmFsc2U7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUE1JTlRSTVNLLCBn
ZW42X3Nhbml0aXplX3Jwc19wbV9tYXNrKGRldl9wcml2LCB+MHUpKTsKLQotCWdlbjZfZ3RfcG1f
ZGlzYWJsZV9pcnEoZ3QsIEdFTjZfUE1fUlBTX0VWRU5UUyk7Ci0KLQlzcGluX3VubG9ja19pcnEo
Jmd0LT5pcnFfbG9jayk7Ci0JaW50ZWxfc3luY2hyb25pemVfaXJxKGRldl9wcml2KTsKLQotCS8q
IE5vdyB0aGF0IHdlIHdpbGwgbm90IGJlIGdlbmVyYXRpbmcgYW55IG1vcmUgd29yaywgZmx1c2gg
YW55Ci0JICogb3V0c3RhbmRpbmcgdGFza3MuIEFzIHdlIGFyZSBjYWxsZWQgb24gdGhlIFJQUyBp
ZGxlIHBhdGgsCi0JICogd2Ugd2lsbCByZXNldCB0aGUgR1BVIHRvIG1pbmltdW0gZnJlcXVlbmNp
ZXMsIHNvIHRoZSBjdXJyZW50Ci0JICogc3RhdGUgb2YgdGhlIHdvcmtlciBjYW4gYmUgZGlzY2Fy
ZGVkLgotCSAqLwotCWNhbmNlbF93b3JrX3N5bmMoJnJwcy0+d29yayk7Ci0JaWYgKElOVEVMX0dF
TihkZXZfcHJpdikgPj0gMTEpCi0JCWdlbjExX3Jlc2V0X3Jwc19pbnRlcnJ1cHRzKGRldl9wcml2
KTsKLQllbHNlCi0JCWdlbjZfcmVzZXRfcnBzX2ludGVycnVwdHMoZGV2X3ByaXYpOwotfQotCiB2
b2lkIGdlbjlfcmVzZXRfZ3VjX2ludGVycnVwdHMoc3RydWN0IGludGVsX2d1YyAqZ3VjKQogewog
CXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBndWNfdG9fZ3QoZ3VjKTsKQEAgLTEwNjUsMTk5ICs5ODUs
NiBAQCBpbnQgaW50ZWxfZ2V0X2NydGNfc2NhbmxpbmUoc3RydWN0IGludGVsX2NydGMgKmNydGMp
CiAJcmV0dXJuIHBvc2l0aW9uOwogfQogCi1zdGF0aWMgdm9pZCBpcm9ubGFrZV9ycHNfY2hhbmdl
X2lycV9oYW5kbGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlzdHJ1
Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKLQl1MzIgYnVzeV91
cCwgYnVzeV9kb3duLCBtYXhfYXZnLCBtaW5fYXZnOwotCXU4IG5ld19kZWxheTsKLQotCXNwaW5f
bG9jaygmbWNoZGV2X2xvY2spOwotCi0JaW50ZWxfdW5jb3JlX3dyaXRlMTYodW5jb3JlLAotCQkJ
ICAgICBNRU1JTlRSU1RTLAotCQkJICAgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIE1FTUlO
VFJTVFMpKTsKLQotCW5ld19kZWxheSA9IGRldl9wcml2LT5pcHMuY3VyX2RlbGF5OwotCi0JaW50
ZWxfdW5jb3JlX3dyaXRlMTYodW5jb3JlLCBNRU1JTlRSU1RTLCBNRU1JTlRfRVZBTF9DSEcpOwot
CWJ1c3lfdXAgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFJDUFJFVkJTWVRVUEFWRyk7Ci0J
YnVzeV9kb3duID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBSQ1BSRVZCU1lURE5BVkcpOwot
CW1heF9hdmcgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFJDQk1BWEFWRyk7Ci0JbWluX2F2
ZyA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgUkNCTUlOQVZHKTsKLQotCS8qIEhhbmRsZSBS
Q1MgY2hhbmdlIHJlcXVlc3QgZnJvbSBodyAqLwotCWlmIChidXN5X3VwID4gbWF4X2F2Zykgewot
CQlpZiAoZGV2X3ByaXYtPmlwcy5jdXJfZGVsYXkgIT0gZGV2X3ByaXYtPmlwcy5tYXhfZGVsYXkp
Ci0JCQluZXdfZGVsYXkgPSBkZXZfcHJpdi0+aXBzLmN1cl9kZWxheSAtIDE7Ci0JCWlmIChuZXdf
ZGVsYXkgPCBkZXZfcHJpdi0+aXBzLm1heF9kZWxheSkKLQkJCW5ld19kZWxheSA9IGRldl9wcml2
LT5pcHMubWF4X2RlbGF5OwotCX0gZWxzZSBpZiAoYnVzeV9kb3duIDwgbWluX2F2ZykgewotCQlp
ZiAoZGV2X3ByaXYtPmlwcy5jdXJfZGVsYXkgIT0gZGV2X3ByaXYtPmlwcy5taW5fZGVsYXkpCi0J
CQluZXdfZGVsYXkgPSBkZXZfcHJpdi0+aXBzLmN1cl9kZWxheSArIDE7Ci0JCWlmIChuZXdfZGVs
YXkgPiBkZXZfcHJpdi0+aXBzLm1pbl9kZWxheSkKLQkJCW5ld19kZWxheSA9IGRldl9wcml2LT5p
cHMubWluX2RlbGF5OwotCX0KLQotCWlmIChpcm9ubGFrZV9zZXRfZHJwcyhkZXZfcHJpdiwgbmV3
X2RlbGF5KSkKLQkJZGV2X3ByaXYtPmlwcy5jdXJfZGVsYXkgPSBuZXdfZGVsYXk7Ci0KLQlzcGlu
X3VubG9jaygmbWNoZGV2X2xvY2spOwotCi0JcmV0dXJuOwotfQotCi1zdGF0aWMgdm9pZCB2bHZf
YzBfcmVhZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQlzdHJ1Y3QgaW50
ZWxfcnBzX2VpICplaSkKLXsKLQllaS0+a3RpbWUgPSBrdGltZV9nZXRfcmF3KCk7Ci0JZWktPnJl
bmRlcl9jMCA9IEk5MTVfUkVBRChWTFZfUkVOREVSX0MwX0NPVU5UKTsKLQllaS0+bWVkaWFfYzAg
PSBJOTE1X1JFQUQoVkxWX01FRElBX0MwX0NPVU5UKTsKLX0KLQotdm9pZCBnZW42X3Jwc19yZXNl
dF9laShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JbWVtc2V0KCZkZXZf
cHJpdi0+Z3RfcG0ucnBzLmVpLCAwLCBzaXplb2YoZGV2X3ByaXYtPmd0X3BtLnJwcy5laSkpOwot
fQotCi1zdGF0aWMgdTMyIHZsdl93YV9jMF9laShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIHUzMiBwbV9paXIpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2
LT5ndF9wbS5ycHM7Ci0JY29uc3Qgc3RydWN0IGludGVsX3Jwc19laSAqcHJldiA9ICZycHMtPmVp
OwotCXN0cnVjdCBpbnRlbF9ycHNfZWkgbm93OwotCXUzMiBldmVudHMgPSAwOwotCi0JaWYgKChw
bV9paXIgJiBHRU42X1BNX1JQX1VQX0VJX0VYUElSRUQpID09IDApCi0JCXJldHVybiAwOwotCi0J
dmx2X2MwX3JlYWQoZGV2X3ByaXYsICZub3cpOwotCi0JaWYgKHByZXYtPmt0aW1lKSB7Ci0JCXU2
NCB0aW1lLCBjMDsKLQkJdTMyIHJlbmRlciwgbWVkaWE7Ci0KLQkJdGltZSA9IGt0aW1lX3VzX2Rl
bHRhKG5vdy5rdGltZSwgcHJldi0+a3RpbWUpOwotCi0JCXRpbWUgKj0gZGV2X3ByaXYtPmN6Y2xr
X2ZyZXE7Ci0KLQkJLyogV29ya2xvYWQgY2FuIGJlIHNwbGl0IGJldHdlZW4gcmVuZGVyICsgbWVk
aWEsCi0JCSAqIGUuZy4gU3dhcEJ1ZmZlcnMgYmVpbmcgYmxpdHRlZCBpbiBYIGFmdGVyIGJlaW5n
IHJlbmRlcmVkIGluCi0JCSAqIG1lc2EuIFRvIGFjY291bnQgZm9yIHRoaXMgd2UgbmVlZCB0byBj
b21iaW5lIGJvdGggZW5naW5lcwotCQkgKiBpbnRvIG91ciBhY3Rpdml0eSBjb3VudGVyLgotCQkg
Ki8KLQkJcmVuZGVyID0gbm93LnJlbmRlcl9jMCAtIHByZXYtPnJlbmRlcl9jMDsKLQkJbWVkaWEg
PSBub3cubWVkaWFfYzAgLSBwcmV2LT5tZWRpYV9jMDsKLQkJYzAgPSBtYXgocmVuZGVyLCBtZWRp
YSk7Ci0JCWMwICo9IDEwMDAgKiAxMDAgPDwgODsgLyogdG8gdXNlY3MgYW5kIHNjYWxlIHRvIHRo
cmVzaG9sZCUgKi8KLQotCQlpZiAoYzAgPiB0aW1lICogcnBzLT5wb3dlci51cF90aHJlc2hvbGQp
Ci0JCQlldmVudHMgPSBHRU42X1BNX1JQX1VQX1RIUkVTSE9MRDsKLQkJZWxzZSBpZiAoYzAgPCB0
aW1lICogcnBzLT5wb3dlci5kb3duX3RocmVzaG9sZCkKLQkJCWV2ZW50cyA9IEdFTjZfUE1fUlBf
RE9XTl9USFJFU0hPTEQ7Ci0JfQotCi0JcnBzLT5laSA9IG5vdzsKLQlyZXR1cm4gZXZlbnRzOwot
fQotCi1zdGF0aWMgdm9pZCBnZW42X3BtX3Jwc193b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29y
aykKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQotCQljb250YWluZXJf
b2Yod29yaywgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUsIGd0X3BtLnJwcy53b3JrKTsKLQlzdHJ1
Y3QgaW50ZWxfZ3QgKmd0ID0gJmRldl9wcml2LT5ndDsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMg
PSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKLQlib29sIGNsaWVudF9ib29zdCA9IGZhbHNlOwotCWlu
dCBuZXdfZGVsYXksIGFkaiwgbWluLCBtYXg7Ci0JdTMyIHBtX2lpciA9IDA7Ci0KLQlzcGluX2xv
Y2tfaXJxKCZndC0+aXJxX2xvY2spOwotCWlmIChycHMtPmludGVycnVwdHNfZW5hYmxlZCkgewot
CQlwbV9paXIgPSBmZXRjaF9hbmRfemVybygmcnBzLT5wbV9paXIpOwotCQljbGllbnRfYm9vc3Qg
PSBhdG9taWNfcmVhZCgmcnBzLT5udW1fd2FpdGVycyk7Ci0JfQotCXNwaW5fdW5sb2NrX2lycSgm
Z3QtPmlycV9sb2NrKTsKLQotCS8qIE1ha2Ugc3VyZSB3ZSBkaWRuJ3QgcXVldWUgYW55dGhpbmcg
d2UncmUgbm90IGdvaW5nIHRvIHByb2Nlc3MuICovCi0JV0FSTl9PTihwbV9paXIgJiB+ZGV2X3By
aXYtPnBtX3Jwc19ldmVudHMpOwotCWlmICgocG1faWlyICYgZGV2X3ByaXYtPnBtX3Jwc19ldmVu
dHMpID09IDAgJiYgIWNsaWVudF9ib29zdCkKLQkJZ290byBvdXQ7Ci0KLQltdXRleF9sb2NrKCZy
cHMtPmxvY2spOwotCi0JcG1faWlyIHw9IHZsdl93YV9jMF9laShkZXZfcHJpdiwgcG1faWlyKTsK
LQotCWFkaiA9IHJwcy0+bGFzdF9hZGo7Ci0JbmV3X2RlbGF5ID0gcnBzLT5jdXJfZnJlcTsKLQlt
aW4gPSBycHMtPm1pbl9mcmVxX3NvZnRsaW1pdDsKLQltYXggPSBycHMtPm1heF9mcmVxX3NvZnRs
aW1pdDsKLQlpZiAoY2xpZW50X2Jvb3N0KQotCQltYXggPSBycHMtPm1heF9mcmVxOwotCWlmIChj
bGllbnRfYm9vc3QgJiYgbmV3X2RlbGF5IDwgcnBzLT5ib29zdF9mcmVxKSB7Ci0JCW5ld19kZWxh
eSA9IHJwcy0+Ym9vc3RfZnJlcTsKLQkJYWRqID0gMDsKLQl9IGVsc2UgaWYgKHBtX2lpciAmIEdF
TjZfUE1fUlBfVVBfVEhSRVNIT0xEKSB7Ci0JCWlmIChhZGogPiAwKQotCQkJYWRqICo9IDI7Ci0J
CWVsc2UgLyogQ0hWIG5lZWRzIGV2ZW4gZW5jb2RlIHZhbHVlcyAqLwotCQkJYWRqID0gSVNfQ0hF
UlJZVklFVyhkZXZfcHJpdikgPyAyIDogMTsKLQotCQlpZiAobmV3X2RlbGF5ID49IHJwcy0+bWF4
X2ZyZXFfc29mdGxpbWl0KQotCQkJYWRqID0gMDsKLQl9IGVsc2UgaWYgKGNsaWVudF9ib29zdCkg
ewotCQlhZGogPSAwOwotCX0gZWxzZSBpZiAocG1faWlyICYgR0VONl9QTV9SUF9ET1dOX1RJTUVP
VVQpIHsKLQkJaWYgKHJwcy0+Y3VyX2ZyZXEgPiBycHMtPmVmZmljaWVudF9mcmVxKQotCQkJbmV3
X2RlbGF5ID0gcnBzLT5lZmZpY2llbnRfZnJlcTsKLQkJZWxzZSBpZiAocnBzLT5jdXJfZnJlcSA+
IHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KQotCQkJbmV3X2RlbGF5ID0gcnBzLT5taW5fZnJlcV9z
b2Z0bGltaXQ7Ci0JCWFkaiA9IDA7Ci0JfSBlbHNlIGlmIChwbV9paXIgJiBHRU42X1BNX1JQX0RP
V05fVEhSRVNIT0xEKSB7Ci0JCWlmIChhZGogPCAwKQotCQkJYWRqICo9IDI7Ci0JCWVsc2UgLyog
Q0hWIG5lZWRzIGV2ZW4gZW5jb2RlIHZhbHVlcyAqLwotCQkJYWRqID0gSVNfQ0hFUlJZVklFVyhk
ZXZfcHJpdikgPyAtMiA6IC0xOwotCi0JCWlmIChuZXdfZGVsYXkgPD0gcnBzLT5taW5fZnJlcV9z
b2Z0bGltaXQpCi0JCQlhZGogPSAwOwotCX0gZWxzZSB7IC8qIHVua25vd24gZXZlbnQgKi8KLQkJ
YWRqID0gMDsKLQl9Ci0KLQlycHMtPmxhc3RfYWRqID0gYWRqOwotCi0JLyoKLQkgKiBMaW1pdCBk
ZWJvb3N0aW5nIGFuZCBib29zdGluZyB0byBrZWVwIG91cnNlbHZlcyBhdCB0aGUgZXh0cmVtZXMK
LQkgKiB3aGVuIGluIHRoZSByZXNwZWN0aXZlIHBvd2VyIG1vZGVzIChpLmUuIHNsb3dseSBkZWNy
ZWFzZSBmcmVxdWVuY2llcwotCSAqIHdoaWxlIGluIHRoZSBISUdIX1BPV0VSIHpvbmUgYW5kIHNs
b3dseSBpbmNyZWFzZSBmcmVxdWVuY2llcyB3aGlsZQotCSAqIGluIHRoZSBMT1dfUE9XRVIgem9u
ZSkuIE9uIGlkbGUsIHdlIHdpbGwgaGl0IHRoZSB0aW1lb3V0IGFuZCBkcm9wCi0JICogdG8gdGhl
IG5leHQgbGV2ZWwgcXVpY2tseSwgYW5kIGNvbnZlcnNlbHkgaWYgYnVzeSB3ZSBleHBlY3QgdG8K
LQkgKiBoaXQgYSB3YWl0Ym9vc3QgYW5kIHJhcGlkbHkgc3dpdGNoIGludG8gbWF4IHBvd2VyLgot
CSAqLwotCWlmICgoYWRqIDwgMCAmJiBycHMtPnBvd2VyLm1vZGUgPT0gSElHSF9QT1dFUikgfHwK
LQkgICAgKGFkaiA+IDAgJiYgcnBzLT5wb3dlci5tb2RlID09IExPV19QT1dFUikpCi0JCXJwcy0+
bGFzdF9hZGogPSAwOwotCi0JLyogc3lzZnMgZnJlcXVlbmN5IGludGVyZmFjZXMgbWF5IGhhdmUg
c251Y2sgaW4gd2hpbGUgc2VydmljaW5nIHRoZQotCSAqIGludGVycnVwdAotCSAqLwotCW5ld19k
ZWxheSArPSBhZGo7Ci0JbmV3X2RlbGF5ID0gY2xhbXBfdChpbnQsIG5ld19kZWxheSwgbWluLCBt
YXgpOwotCi0JaWYgKGludGVsX3NldF9ycHMoZGV2X3ByaXYsIG5ld19kZWxheSkpIHsKLQkJRFJN
X0RFQlVHX0RSSVZFUigiRmFpbGVkIHRvIHNldCBuZXcgR1BVIGZyZXF1ZW5jeVxuIik7Ci0JCXJw
cy0+bGFzdF9hZGogPSAwOwotCX0KLQotCW11dGV4X3VubG9jaygmcnBzLT5sb2NrKTsKLQotb3V0
OgotCS8qIE1ha2Ugc3VyZSBub3QgdG8gY29ycnVwdCBQTUlNUiBzdGF0ZSB1c2VkIGJ5IHJpbmdi
dWZmZXIgb24gR0VONiAqLwotCXNwaW5fbG9ja19pcnEoJmd0LT5pcnFfbG9jayk7Ci0JaWYgKHJw
cy0+aW50ZXJydXB0c19lbmFibGVkKQotCQlnZW42X2d0X3BtX3VubWFza19pcnEoZ3QsIGRldl9w
cml2LT5wbV9ycHNfZXZlbnRzKTsKLQlzcGluX3VubG9ja19pcnEoJmd0LT5pcnFfbG9jayk7Ci19
Ci0KLQogLyoqCiAgKiBpdnlicmlkZ2VfcGFyaXR5X3dvcmsgLSBXb3JrcXVldWUgY2FsbGVkIHdo
ZW4gYSBwYXJpdHkgZXJyb3IgaW50ZXJydXB0CiAgKiBvY2N1cnJlZC4KQEAgLTE2MzEsNTQgKzEz
NTgsNiBAQCBzdGF0aWMgdm9pZCBpOXh4X3BpcGVfY3JjX2lycV9oYW5kbGVyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJCQkgICAgIHJlczEsIHJlczIpOwogfQogCi0vKiBU
aGUgUlBTIGV2ZW50cyBuZWVkIGZvcmNld2FrZSwgc28gd2UgYWRkIHRoZW0gdG8gYSB3b3JrIHF1
ZXVlIGFuZCBtYXNrIHRoZWlyCi0gKiBJTVIgYml0cyB1bnRpbCB0aGUgd29yayBpcyBkb25lLiBP
dGhlciBpbnRlcnJ1cHRzIGNhbiBiZSBwcm9jZXNzZWQgd2l0aG91dAotICogdGhlIHdvcmsgcXVl
dWUuICovCi12b2lkIGdlbjExX3Jwc19pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1
MzIgcG1faWlyKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7
Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0X3BtLnJwczsKLQljb25zdCB1MzIg
ZXZlbnRzID0gaTkxNS0+cG1fcnBzX2V2ZW50cyAmIHBtX2lpcjsKLQotCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmd0LT5pcnFfbG9jayk7Ci0KLQlpZiAodW5saWtlbHkoIWV2ZW50cykpCi0JCXJldHVy
bjsKLQotCWdlbjZfZ3RfcG1fbWFza19pcnEoZ3QsIGV2ZW50cyk7Ci0KLQlpZiAoIXJwcy0+aW50
ZXJydXB0c19lbmFibGVkKQotCQlyZXR1cm47Ci0KLQlycHMtPnBtX2lpciB8PSBldmVudHM7Ci0J
c2NoZWR1bGVfd29yaygmcnBzLT53b3JrKTsKLX0KLQotdm9pZCBnZW42X3Jwc19pcnFfaGFuZGxl
cihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwbV9paXIpCi17Ci0Jc3Ry
dWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0Jc3RydWN0IGludGVs
X2d0ICpndCA9ICZkZXZfcHJpdi0+Z3Q7Ci0KLQlpZiAocG1faWlyICYgZGV2X3ByaXYtPnBtX3Jw
c19ldmVudHMpIHsKLQkJc3Bpbl9sb2NrKCZndC0+aXJxX2xvY2spOwotCQlnZW42X2d0X3BtX21h
c2tfaXJxKGd0LCBwbV9paXIgJiBkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyk7Ci0JCWlmIChycHMt
PmludGVycnVwdHNfZW5hYmxlZCkgewotCQkJcnBzLT5wbV9paXIgfD0gcG1faWlyICYgZGV2X3By
aXYtPnBtX3Jwc19ldmVudHM7Ci0JCQlzY2hlZHVsZV93b3JrKCZycHMtPndvcmspOwotCQl9Ci0J
CXNwaW5fdW5sb2NrKCZndC0+aXJxX2xvY2spOwotCX0KLQotCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDgpCi0JCXJldHVybjsKLQotCWlmIChwbV9paXIgJiBQTV9WRUJPWF9VU0VSX0lOVEVS
UlVQVCkKLQkJaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2lycShkZXZfcHJpdi0+ZW5naW5lW1ZF
Q1MwXSk7Ci0KLQlpZiAocG1faWlyICYgUE1fVkVCT1hfQ1NfRVJST1JfSU5URVJSVVBUKQotCQlE
Uk1fREVCVUcoIkNvbW1hbmQgcGFyc2VyIGVycm9yLCBwbV9paXIgMHglMDh4XG4iLCBwbV9paXIp
OwotfQotCiBzdGF0aWMgdm9pZCBpOXh4X3BpcGVzdGF0X2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJZW51bSBwaXBlIHBpcGU7CkBAIC0xOTg5LDcgKzE2
NjgsNyBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgdmFsbGV5dmlld19pcnFfaGFuZGxlcihpbnQgaXJx
LCB2b2lkICphcmcpCiAJCWlmIChndF9paXIpCiAJCQlnZW42X2d0X2lycV9oYW5kbGVyKCZkZXZf
cHJpdi0+Z3QsIGd0X2lpcik7CiAJCWlmIChwbV9paXIpCi0JCQlnZW42X3Jwc19pcnFfaGFuZGxl
cihkZXZfcHJpdiwgcG1faWlyKTsKKwkJCWdlbjZfcnBzX2lycV9oYW5kbGVyKCZkZXZfcHJpdi0+
Z3QucnBzLCBwbV9paXIpOwogCiAJCWlmIChob3RwbHVnX3N0YXR1cykKIAkJCWk5eHhfaHBkX2ly
cV9oYW5kbGVyKGRldl9wcml2LCBob3RwbHVnX3N0YXR1cyk7CkBAIC0yMzkzLDcgKzIwNzIsNyBA
QCBzdGF0aWMgdm9pZCBpbGtfZGlzcGxheV9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCiAJfQogCiAJaWYgKElTX0dFTihkZXZfcHJpdiwgNSkgJiYgZGVfaWly
ICYgREVfUENVX0VWRU5UKQotCQlpcm9ubGFrZV9ycHNfY2hhbmdlX2lycV9oYW5kbGVyKGRldl9w
cml2KTsKKwkJZ2VuNV9ycHNfaXJxX2hhbmRsZXIoJmRldl9wcml2LT5ndC5ycHMpOwogfQogCiBz
dGF0aWMgdm9pZCBpdmJfZGlzcGxheV9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCkBAIC0yNDk4LDcgKzIxNzcsNyBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgaXJv
bmxha2VfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQogCQlpZiAocG1faWlyKSB7CiAJ
CQlJOTE1X1dSSVRFKEdFTjZfUE1JSVIsIHBtX2lpcik7CiAJCQlyZXQgPSBJUlFfSEFORExFRDsK
LQkJCWdlbjZfcnBzX2lycV9oYW5kbGVyKGRldl9wcml2LCBwbV9paXIpOworCQkJZ2VuNl9ycHNf
aXJxX2hhbmRsZXIoJmRldl9wcml2LT5ndC5ycHMsIHBtX2lpcik7CiAJCX0KIAl9CiAKQEAgLTQy
NzAsMTMgKzM5NDksMTAgQEAgc3RhdGljIGlycXJldHVybl90IGk5NjVfaXJxX2hhbmRsZXIoaW50
IGlycSwgdm9pZCAqYXJnKQogdm9pZCBpbnRlbF9pcnFfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCiB7CiAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+
ZHJtOwotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwogCWlu
dCBpOwogCiAJaW50ZWxfaHBkX2luaXRfd29yayhkZXZfcHJpdik7CiAKLQlJTklUX1dPUksoJnJw
cy0+d29yaywgZ2VuNl9wbV9ycHNfd29yayk7Ci0KIAlJTklUX1dPUksoJmRldl9wcml2LT5sM19w
YXJpdHkuZXJyb3Jfd29yaywgaXZ5YnJpZGdlX3Bhcml0eV93b3JrKTsKIAlmb3IgKGkgPSAwOyBp
IDwgTUFYX0wzX1NMSUNFUzsgKytpKQogCQlkZXZfcHJpdi0+bDNfcGFyaXR5LnJlbWFwX2luZm9b
aV0gPSBOVUxMOwpAQCAtNDI4NSwzMyArMzk2MSw2IEBAIHZvaWQgaW50ZWxfaXJxX2luaXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCWlmIChIQVNfR1RfVUMoZGV2X3ByaXYp
ICYmIElOVEVMX0dFTihkZXZfcHJpdikgPCAxMSkKIAkJZGV2X3ByaXYtPmd0LnBtX2d1Y19ldmVu
dHMgPSBHVUNfSU5UUl9HVUMySE9TVCA8PCAxNjsKIAotCS8qIExldCdzIHRyYWNrIHRoZSBlbmFi
bGVkIHJwcyBldmVudHMgKi8KLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCi0JCS8qIFdh
R3N2UkMwUmVzaWRlbmN5TWV0aG9kOnZsdiAqLwotCQlkZXZfcHJpdi0+cG1fcnBzX2V2ZW50cyA9
IEdFTjZfUE1fUlBfVVBfRUlfRVhQSVJFRDsKLQllbHNlCi0JCWRldl9wcml2LT5wbV9ycHNfZXZl
bnRzID0gKEdFTjZfUE1fUlBfVVBfVEhSRVNIT0xEIHwKLQkJCQkJICAgR0VONl9QTV9SUF9ET1dO
X1RIUkVTSE9MRCB8Ci0JCQkJCSAgIEdFTjZfUE1fUlBfRE9XTl9USU1FT1VUKTsKLQotCS8qIFdl
IHNoYXJlIHRoZSByZWdpc3RlciB3aXRoIG90aGVyIGVuZ2luZSAqLwotCWlmIChJTlRFTF9HRU4o
ZGV2X3ByaXYpID4gOSkKLQkJR0VNX1dBUk5fT04oZGV2X3ByaXYtPnBtX3Jwc19ldmVudHMgJiAw
eGZmZmYwMDAwKTsKLQotCXJwcy0+cG1faW50cm1za19tYnogPSAwOwotCi0JLyoKLQkgKiBTTkIs
SVZCLEhTVyBjYW4gd2hpbGUgVkxWLENIViBtYXkgaGFyZCBoYW5nIG9uIGxvb3BpbmcgYmF0Y2hi
dWZmZXIKLQkgKiBpZiBHRU42X1BNX1VQX0VJX0VYUElSRUQgaXMgbWFza2VkLgotCSAqCi0JICog
VE9ETzogdmVyaWZ5IGlmIHRoaXMgY2FuIGJlIHJlcHJvZHVjZWQgb24gVkxWLENIVi4KLQkgKi8K
LQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8PSA3KQotCQlycHMtPnBtX2ludHJtc2tfbWJ6IHw9
IEdFTjZfUE1fUlBfVVBfRUlfRVhQSVJFRDsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49
IDgpCi0JCXJwcy0+cG1faW50cm1za19tYnogfD0gR0VOOF9QTUlOVFJfRElTQUJMRV9SRURJUkVD
VF9UT19HVUM7Ci0KIAlkZXYtPnZibGFua19kaXNhYmxlX2ltbWVkaWF0ZSA9IHRydWU7CiAKIAkv
KiBNb3N0IHBsYXRmb3JtcyB0cmVhdCB0aGUgZGlzcGxheSBpcnEgYmxvY2sgYXMgYW4gYWx3YXlz
LW9uCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuaAppbmRleCAxOWEzYmMwMTk1MzUuLmQwZDkxYzZlMDBk
NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5oCkBAIC0yMiw5ICsyMiw2IEBAIHN0cnVjdCBpbnRl
bF9ndDsKIHN0cnVjdCBpbnRlbF9ndWM7CiBzdHJ1Y3QgaW50ZWxfdW5jb3JlOwogCi12b2lkIGdl
bjExX3Jwc19pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1MzIgcG1faWlyKTsKLXZv
aWQgZ2VuNl9ycHNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCB1MzIgcG1faWlyKTsKLQogdm9pZCBpbnRlbF9pcnFfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBpbnRlbF9pcnFfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwogaW50IGludGVsX2lycV9pbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3BtdS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYwppbmRleCA4NTkxMjkxN2Mw
NjIuLjI2NmQ2NmIxZmI3YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9w
bXUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jCkBAIC0xMiw2ICsxMiw3
IEBACiAjaW5jbHVkZSAiZ3QvaW50ZWxfZW5naW5lX3VzZXIuaCIKICNpbmNsdWRlICJndC9pbnRl
bF9ndF9wbS5oIgogI2luY2x1ZGUgImd0L2ludGVsX3JjNi5oIgorI2luY2x1ZGUgImd0L2ludGVs
X3Jwcy5oIgogCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRlICJpOTE1X3BtdS5oIgpA
QCAtMzU4LDI1ICszNTksMjYgQEAgZnJlcXVlbmN5X3NhbXBsZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0
LCB1bnNpZ25lZCBpbnQgcGVyaW9kX25zKQogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
ID0gZ3QtPmk5MTU7CiAJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsK
IAlzdHJ1Y3QgaTkxNV9wbXUgKnBtdSA9ICZpOTE1LT5wbXU7CisJc3RydWN0IGludGVsX3JwcyAq
cnBzID0gJmd0LT5ycHM7CiAKIAlpZiAocG11LT5lbmFibGUgJiBjb25maWdfZW5hYmxlZF9tYXNr
KEk5MTVfUE1VX0FDVFVBTF9GUkVRVUVOQ1kpKSB7CiAJCXUzMiB2YWw7CiAKLQkJdmFsID0gaTkx
NS0+Z3RfcG0ucnBzLmN1cl9mcmVxOworCQl2YWwgPSBycHMtPmN1cl9mcmVxOwogCQlpZiAoaW50
ZWxfZ3RfcG1fZ2V0X2lmX2F3YWtlKGd0KSkgewogCQkJdmFsID0gaW50ZWxfdW5jb3JlX3JlYWRf
bm90cmFjZSh1bmNvcmUsIEdFTjZfUlBTVEFUMSk7Ci0JCQl2YWwgPSBpbnRlbF9nZXRfY2FnZihp
OTE1LCB2YWwpOworCQkJdmFsID0gaW50ZWxfZ2V0X2NhZ2YocnBzLCB2YWwpOwogCQkJaW50ZWxf
Z3RfcG1fcHV0KGd0KTsKIAkJfQogCiAJCWFkZF9zYW1wbGVfbXVsdCgmcG11LT5zYW1wbGVbX19J
OTE1X1NBTVBMRV9GUkVRX0FDVF0sCi0JCQkJaW50ZWxfZ3B1X2ZyZXEoaTkxNSwgdmFsKSwKKwkJ
CQlpbnRlbF9ncHVfZnJlcShycHMsIHZhbCksCiAJCQkJcGVyaW9kX25zIC8gMTAwMCk7CiAJfQog
CiAJaWYgKHBtdS0+ZW5hYmxlICYgY29uZmlnX2VuYWJsZWRfbWFzayhJOTE1X1BNVV9SRVFVRVNU
RURfRlJFUVVFTkNZKSkgewogCQlhZGRfc2FtcGxlX211bHQoJnBtdS0+c2FtcGxlW19fSTkxNV9T
QU1QTEVfRlJFUV9SRVFdLAotCQkJCWludGVsX2dwdV9mcmVxKGk5MTUsIGk5MTUtPmd0X3BtLnJw
cy5jdXJfZnJlcSksCisJCQkJaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmN1cl9mcmVxKSwKIAkJ
CQlwZXJpb2RfbnMgLyAxMDAwKTsKIAl9CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5j
CmluZGV4IDkzMmM1Y2YxOTBiNS4uMDRkNmI4MTUzYjQxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3JlcXVlc3QuYwpAQCAtMzIsNiArMzIsNyBAQAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jb250
ZXh0LmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfY29udGV4dC5oIgogI2luY2x1ZGUgImd0L2ludGVs
X3JpbmcuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9ycHMuaCIKIAogI2luY2x1ZGUgImk5MTVfYWN0
aXZlLmgiCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKQEAgLTI1OCw4ICsyNTksOCBAQCBib29sIGk5
MTVfcmVxdWVzdF9yZXRpcmUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJaWYgKHRlc3RfYml0
KERNQV9GRU5DRV9GTEFHX0VOQUJMRV9TSUdOQUxfQklULCAmcnEtPmZlbmNlLmZsYWdzKSkKIAkJ
aTkxNV9yZXF1ZXN0X2NhbmNlbF9icmVhZGNydW1iKHJxKTsKIAlpZiAoaTkxNV9yZXF1ZXN0X2hh
c193YWl0Ym9vc3QocnEpKSB7Ci0JCUdFTV9CVUdfT04oIWF0b21pY19yZWFkKCZycS0+aTkxNS0+
Z3RfcG0ucnBzLm51bV93YWl0ZXJzKSk7Ci0JCWF0b21pY19kZWMoJnJxLT5pOTE1LT5ndF9wbS5y
cHMubnVtX3dhaXRlcnMpOworCQlHRU1fQlVHX09OKCFhdG9taWNfcmVhZCgmcnEtPmVuZ2luZS0+
Z3QtPnJwcy5udW1fd2FpdGVycykpOworCQlhdG9taWNfZGVjKCZycS0+ZW5naW5lLT5ndC0+cnBz
Lm51bV93YWl0ZXJzKTsKIAl9CiAJaWYgKCF0ZXN0X2JpdChJOTE1X0ZFTkNFX0ZMQUdfQUNUSVZF
LCAmcnEtPmZlbmNlLmZsYWdzKSkgewogCQlzZXRfYml0KEk5MTVfRkVOQ0VfRkxBR19BQ1RJVkUs
ICZycS0+ZmVuY2UuZmxhZ3MpOwpAQCAtMTQ2Nyw3ICsxNDY4LDcgQEAgbG9uZyBpOTE1X3JlcXVl
c3Rfd2FpdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAkgKi8KIAlpZiAoZmxhZ3MgJiBJOTE1
X1dBSVRfUFJJT1JJVFkpIHsKIAkJaWYgKCFpOTE1X3JlcXVlc3Rfc3RhcnRlZChycSkgJiYgSU5U
RUxfR0VOKHJxLT5pOTE1KSA+PSA2KQotCQkJZ2VuNl9ycHNfYm9vc3QocnEpOworCQkJaW50ZWxf
cnBzX2Jvb3N0KHJxKTsKIAkJaTkxNV9zY2hlZHVsZV9idW1wX3ByaW9yaXR5KHJxLCBJOTE1X1BS
SU9SSVRZX1dBSVQpOwogCX0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9zeXNmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jCmluZGV4IGJmMDM5
YjhiYTU5My4uNjU0NzY5MDlkMWJmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3N5c2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jCkBAIC0z
MSw2ICszMSw3IEBACiAjaW5jbHVkZSA8bGludXgvc3lzZnMuaD4KIAogI2luY2x1ZGUgImd0L2lu
dGVsX3JjNi5oIgorI2luY2x1ZGUgImd0L2ludGVsX3Jwcy5oIgogCiAjaW5jbHVkZSAiaTkxNV9k
cnYuaCIKICNpbmNsdWRlICJpOTE1X3N5c2ZzLmgiCkBAIC0yNTksNiArMjYwLDcgQEAgc3RhdGlj
IHNzaXplX3QgZ3RfYWN0X2ZyZXFfbWh6X3Nob3coc3RydWN0IGRldmljZSAqa2RldiwKIAkJCQkg
ICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKIHsKIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7CisJ
c3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndC5ycHM7CiAJaW50ZWxfd2FrZXJl
Zl90IHdha2VyZWY7CiAJdTMyIGZyZXE7CiAKQEAgLTI3MSwzMSArMjczLDMxIEBAIHN0YXRpYyBz
c2l6ZV90IGd0X2FjdF9mcmVxX21oel9zaG93KHN0cnVjdCBkZXZpY2UgKmtkZXYsCiAKIAkJZnJl
cSA9IChmcmVxID4+IDgpICYgMHhmZjsKIAl9IGVsc2UgewotCQlmcmVxID0gaW50ZWxfZ2V0X2Nh
Z2YoZGV2X3ByaXYsIEk5MTVfUkVBRChHRU42X1JQU1RBVDEpKTsKKwkJZnJlcSA9IGludGVsX2dl
dF9jYWdmKHJwcywgSTkxNV9SRUFEKEdFTjZfUlBTVEFUMSkpOwogCX0KIAogCWludGVsX3J1bnRp
bWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAKLQlyZXR1cm4gc25w
cmludGYoYnVmLCBQQUdFX1NJWkUsICIlZFxuIiwgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIGZy
ZXEpKTsKKwlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIlZFxuIiwgaW50ZWxfZ3B1
X2ZyZXEocnBzLCBmcmVxKSk7CiB9CiAKIHN0YXRpYyBzc2l6ZV90IGd0X2N1cl9mcmVxX21oel9z
aG93KHN0cnVjdCBkZXZpY2UgKmtkZXYsCiAJCQkJICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRl
ICphdHRyLCBjaGFyICpidWYpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOworCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZk
ZXZfcHJpdi0+Z3QucnBzOwogCiAJcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJWRc
biIsCi0JCQlpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwKLQkJCQkgICAgICAgZGV2X3ByaXYtPmd0
X3BtLnJwcy5jdXJfZnJlcSkpOworCQkJaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPmN1cl9mcmVx
KSk7CiB9CiAKIHN0YXRpYyBzc2l6ZV90IGd0X2Jvb3N0X2ZyZXFfbWh6X3Nob3coc3RydWN0IGRl
dmljZSAqa2Rldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKIHsK
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUo
a2Rldik7CisJc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndC5ycHM7CiAKIAly
ZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIlZFxuIiwKLQkJCWludGVsX2dwdV9mcmVx
KGRldl9wcml2LAotCQkJCSAgICAgICBkZXZfcHJpdi0+Z3RfcG0ucnBzLmJvb3N0X2ZyZXEpKTsK
KwkJCWludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5ib29zdF9mcmVxKSk7CiB9CiAKIHN0YXRpYyBz
c2l6ZV90IGd0X2Jvb3N0X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCkBAIC0z
MDMsNyArMzA1LDcgQEAgc3RhdGljIHNzaXplX3QgZ3RfYm9vc3RfZnJlcV9taHpfc3RvcmUoc3Ry
dWN0IGRldmljZSAqa2RldiwKIAkJCQkgICAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgY291
bnQpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl9taW5vcl90
b19pOTE1KGtkZXYpOwotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0u
cnBzOworCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3QucnBzOwogCWJvb2wg
Ym9vc3QgPSBmYWxzZTsKIAlzc2l6ZV90IHJldDsKIAl1MzIgdmFsOwpAQCAtMzEzLDcgKzMxNSw3
IEBAIHN0YXRpYyBzc2l6ZV90IGd0X2Jvb3N0X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2Ug
KmtkZXYsCiAJCXJldHVybiByZXQ7CiAKIAkvKiBWYWxpZGF0ZSBhZ2FpbnN0IChzdGF0aWMpIGhh
cmR3YXJlIGxpbWl0cyAqLwotCXZhbCA9IGludGVsX2ZyZXFfb3Bjb2RlKGRldl9wcml2LCB2YWwp
OworCXZhbCA9IGludGVsX2ZyZXFfb3Bjb2RlKHJwcywgdmFsKTsKIAlpZiAodmFsIDwgcnBzLT5t
aW5fZnJlcSB8fCB2YWwgPiBycHMtPm1heF9mcmVxKQogCQlyZXR1cm4gLUVJTlZBTDsKIApAQCAt
MzMzLDE5ICszMzUsMTkgQEAgc3RhdGljIHNzaXplX3Qgdmx2X3JwZV9mcmVxX21oel9zaG93KHN0
cnVjdCBkZXZpY2UgKmtkZXYsCiAJCQkJICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0
ciwgY2hhciAqYnVmKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtk
ZXZfbWlub3JfdG9faTkxNShrZGV2KTsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3By
aXYtPmd0LnJwczsKIAogCXJldHVybiBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIiVkXG4iLAot
CQkJaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsCi0JCQkJICAgICAgIGRldl9wcml2LT5ndF9wbS5y
cHMuZWZmaWNpZW50X2ZyZXEpKTsKKwkJCWludGVsX2dwdV9mcmVxKHJwcywgcnBzLT5lZmZpY2ll
bnRfZnJlcSkpOwogfQogCiBzdGF0aWMgc3NpemVfdCBndF9tYXhfZnJlcV9taHpfc2hvdyhzdHJ1
Y3QgZGV2aWNlICprZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVm
KQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9f
aTkxNShrZGV2KTsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0LnJwczsK
IAogCXJldHVybiBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIiVkXG4iLAotCQkJaW50ZWxfZ3B1
X2ZyZXEoZGV2X3ByaXYsCi0JCQkJICAgICAgIGRldl9wcml2LT5ndF9wbS5ycHMubWF4X2ZyZXFf
c29mdGxpbWl0KSk7CisJCQlpbnRlbF9ncHVfZnJlcShycHMsIHJwcy0+bWF4X2ZyZXFfc29mdGxp
bWl0KSk7CiB9CiAKIHN0YXRpYyBzc2l6ZV90IGd0X21heF9mcmVxX21oel9zdG9yZShzdHJ1Y3Qg
ZGV2aWNlICprZGV2LApAQCAtMzUzLDE5ICszNTUsMTcgQEAgc3RhdGljIHNzaXplX3QgZ3RfbWF4
X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCiAJCQkJICAgICBjb25zdCBjaGFy
ICpidWYsIHNpemVfdCBjb3VudCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0g
JmRldl9wcml2LT5ndF9wbS5ycHM7Ci0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0JdTMyIHZh
bDsKKwlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0LnJwczsKIAlzc2l6ZV90
IHJldDsKKwl1MzIgdmFsOwogCiAJcmV0ID0ga3N0cnRvdTMyKGJ1ZiwgMCwgJnZhbCk7CiAJaWYg
KHJldCkKIAkJcmV0dXJuIHJldDsKIAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgm
ZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCW11dGV4X2xvY2soJnJwcy0+bG9jayk7CiAKLQl2YWwg
PSBpbnRlbF9mcmVxX29wY29kZShkZXZfcHJpdiwgdmFsKTsKKwl2YWwgPSBpbnRlbF9mcmVxX29w
Y29kZShycHMsIHZhbCk7CiAJaWYgKHZhbCA8IHJwcy0+bWluX2ZyZXEgfHwKIAkgICAgdmFsID4g
cnBzLT5tYXhfZnJlcSB8fAogCSAgICB2YWwgPCBycHMtPm1pbl9mcmVxX3NvZnRsaW1pdCkgewpA
QCAtMzc1LDcgKzM3NSw3IEBAIHN0YXRpYyBzc2l6ZV90IGd0X21heF9mcmVxX21oel9zdG9yZShz
dHJ1Y3QgZGV2aWNlICprZGV2LAogCiAJaWYgKHZhbCA+IHJwcy0+cnAwX2ZyZXEpCiAJCURSTV9E
RUJVRygiVXNlciByZXF1ZXN0ZWQgb3ZlcmNsb2NraW5nIHRvICVkXG4iLAotCQkJICBpbnRlbF9n
cHVfZnJlcShkZXZfcHJpdiwgdmFsKSk7CisJCQkgIGludGVsX2dwdV9mcmVxKHJwcywgdmFsKSk7
CiAKIAlycHMtPm1heF9mcmVxX3NvZnRsaW1pdCA9IHZhbDsKIApAQCAtMzgzLDE0ICszODMsMTUg
QEAgc3RhdGljIHNzaXplX3QgZ3RfbWF4X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtk
ZXYsCiAJCSAgICAgIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0LAogCQkgICAgICBycHMtPm1heF9m
cmVxX3NvZnRsaW1pdCk7CiAKLQkvKiBXZSBzdGlsbCBuZWVkICpfc2V0X3JwcyB0byBwcm9jZXNz
IHRoZSBuZXcgbWF4X2RlbGF5IGFuZAorCS8qCisJICogV2Ugc3RpbGwgbmVlZCAqX3NldF9ycHMg
dG8gcHJvY2VzcyB0aGUgbmV3IG1heF9kZWxheSBhbmQKIAkgKiB1cGRhdGUgdGhlIGludGVycnVw
dCBsaW1pdHMgYW5kIFBNSU5UUk1TSyBldmVuIHRob3VnaAotCSAqIGZyZXF1ZW5jeSByZXF1ZXN0
IG1heSBiZSB1bmNoYW5nZWQuICovCi0JcmV0ID0gaW50ZWxfc2V0X3JwcyhkZXZfcHJpdiwgdmFs
KTsKKwkgKiBmcmVxdWVuY3kgcmVxdWVzdCBtYXkgYmUgdW5jaGFuZ2VkLgorCSAqLworCWludGVs
X3Jwc19zZXQocnBzLCB2YWwpOwogCiB1bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZycHMtPmxvY2sp
OwotCWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7
CiAKIAlyZXR1cm4gcmV0ID86IGNvdW50OwogfQpAQCAtMzk4LDEwICszOTksMTAgQEAgc3RhdGlj
IHNzaXplX3QgZ3RfbWF4X2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYsCiBzdGF0
aWMgc3NpemVfdCBndF9taW5fZnJlcV9taHpfc2hvdyhzdHJ1Y3QgZGV2aWNlICprZGV2LCBzdHJ1
Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQogewogCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKKwlzdHJ1Y3Qg
aW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0LnJwczsKIAogCXJldHVybiBzbnByaW50Zihi
dWYsIFBBR0VfU0laRSwgIiVkXG4iLAotCQkJaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsCi0JCQkJ
ICAgICAgIGRldl9wcml2LT5ndF9wbS5ycHMubWluX2ZyZXFfc29mdGxpbWl0KSk7CisJCQlpbnRl
bF9ncHVfZnJlcShycHMsIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KSk7CiB9CiAKIHN0YXRpYyBz
c2l6ZV90IGd0X21pbl9mcmVxX21oel9zdG9yZShzdHJ1Y3QgZGV2aWNlICprZGV2LApAQCAtNDA5
LDE5ICs0MTAsMTcgQEAgc3RhdGljIHNzaXplX3QgZ3RfbWluX2ZyZXFfbWh6X3N0b3JlKHN0cnVj
dCBkZXZpY2UgKmtkZXYsCiAJCQkJICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCkK
IHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5
MTUoa2Rldik7Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7
Ci0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0JdTMyIHZhbDsKKwlzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMgPSAmZGV2X3ByaXYtPmd0LnJwczsKIAlzc2l6ZV90IHJldDsKKwl1MzIgdmFsOwogCiAJ
cmV0ID0ga3N0cnRvdTMyKGJ1ZiwgMCwgJnZhbCk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsK
IAotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0p
OwogCW11dGV4X2xvY2soJnJwcy0+bG9jayk7CiAKLQl2YWwgPSBpbnRlbF9mcmVxX29wY29kZShk
ZXZfcHJpdiwgdmFsKTsKKwl2YWwgPSBpbnRlbF9mcmVxX29wY29kZShycHMsIHZhbCk7CiAJaWYg
KHZhbCA8IHJwcy0+bWluX2ZyZXEgfHwKIAkgICAgdmFsID4gcnBzLT5tYXhfZnJlcSB8fAogCSAg
ICB2YWwgPiBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCkgewpAQCAtNDM1LDE0ICs0MzQsMTUgQEAg
c3RhdGljIHNzaXplX3QgZ3RfbWluX2ZyZXFfbWh6X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmtkZXYs
CiAJCSAgICAgIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0LAogCQkgICAgICBycHMtPm1heF9mcmVx
X3NvZnRsaW1pdCk7CiAKLQkvKiBXZSBzdGlsbCBuZWVkICpfc2V0X3JwcyB0byBwcm9jZXNzIHRo
ZSBuZXcgbWluX2RlbGF5IGFuZAorCS8qCisJICogV2Ugc3RpbGwgbmVlZCAqX3NldF9ycHMgdG8g
cHJvY2VzcyB0aGUgbmV3IG1pbl9kZWxheSBhbmQKIAkgKiB1cGRhdGUgdGhlIGludGVycnVwdCBs
aW1pdHMgYW5kIFBNSU5UUk1TSyBldmVuIHRob3VnaAotCSAqIGZyZXF1ZW5jeSByZXF1ZXN0IG1h
eSBiZSB1bmNoYW5nZWQuICovCi0JcmV0ID0gaW50ZWxfc2V0X3JwcyhkZXZfcHJpdiwgdmFsKTsK
KwkgKiBmcmVxdWVuY3kgcmVxdWVzdCBtYXkgYmUgdW5jaGFuZ2VkLgorCSAqLworCWludGVsX3Jw
c19zZXQocnBzLCB2YWwpOwogCiB1bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZycHMtPmxvY2spOwot
CWludGVsX3J1bnRpbWVfcG1fcHV0KCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZik7CiAK
IAlyZXR1cm4gcmV0ID86IGNvdW50OwogfQpAQCAtNDY0LDE1ICs0NjQsMTUgQEAgc3RhdGljIERF
VklDRV9BVFRSKGd0X1JQbl9mcmVxX21oeiwgU19JUlVHTywgZ3RfcnBfbWh6X3Nob3csIE5VTEwp
Owogc3RhdGljIHNzaXplX3QgZ3RfcnBfbWh6X3Nob3coc3RydWN0IGRldmljZSAqa2Rldiwgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKIHsKIAlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Ci0Jc3RydWN0
IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7CisJc3RydWN0IGludGVsX3Jw
cyAqcnBzID0gJmRldl9wcml2LT5ndC5ycHM7CiAJdTMyIHZhbDsKIAogCWlmIChhdHRyID09ICZk
ZXZfYXR0cl9ndF9SUDBfZnJlcV9taHopCi0JCXZhbCA9IGludGVsX2dwdV9mcmVxKGRldl9wcml2
LCBycHMtPnJwMF9mcmVxKTsKKwkJdmFsID0gaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPnJwMF9m
cmVxKTsKIAllbHNlIGlmIChhdHRyID09ICZkZXZfYXR0cl9ndF9SUDFfZnJlcV9taHopCi0JCXZh
bCA9IGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPnJwMV9mcmVxKTsKKwkJdmFsID0gaW50
ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPnJwMV9mcmVxKTsKIAllbHNlIGlmIChhdHRyID09ICZkZXZf
YXR0cl9ndF9SUG5fZnJlcV9taHopCi0JCXZhbCA9IGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBy
cHMtPm1pbl9mcmVxKTsKKwkJdmFsID0gaW50ZWxfZ3B1X2ZyZXEocnBzLCBycHMtPm1pbl9mcmVx
KTsKIAllbHNlCiAJCUJVRygpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwppbmRleCA2YjM3ZDIy
ZmM2OGQuLjVkMmI0NjBkM2VlNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50
ZWxfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCkBAIC0xOTcsOCAr
MTk3LDYgQEAgc3RhdGljIHZvaWQgaTkxNV9pcm9ubGFrZV9nZXRfbWVtX2ZyZXEoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQlicmVhazsKIAl9CiAKLQlkZXZfcHJpdi0+aXBz
LnJfdCA9IGRldl9wcml2LT5tZW1fZnJlcTsKLQogCXN3aXRjaCAoY3NpcGxsICYgMHgzZmYpIHsK
IAljYXNlIDB4MDBjOgogCQlkZXZfcHJpdi0+ZnNiX2ZyZXEgPSAzMjAwOwpAQCAtMjI3LDE0ICsy
MjUsNiBAQCBzdGF0aWMgdm9pZCBpOTE1X2lyb25sYWtlX2dldF9tZW1fZnJlcShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCWRldl9wcml2LT5mc2JfZnJlcSA9IDA7CiAJCWJy
ZWFrOwogCX0KLQotCWlmIChkZXZfcHJpdi0+ZnNiX2ZyZXEgPT0gMzIwMCkgewotCQlkZXZfcHJp
di0+aXBzLmNfbSA9IDA7Ci0JfSBlbHNlIGlmIChkZXZfcHJpdi0+ZnNiX2ZyZXEgPiAzMjAwICYm
IGRldl9wcml2LT5mc2JfZnJlcSA8PSA0ODAwKSB7Ci0JCWRldl9wcml2LT5pcHMuY19tID0gMTsK
LQl9IGVsc2UgewotCQlkZXZfcHJpdi0+aXBzLmNfbSA9IDI7Ci0JfQogfQogCiBzdGF0aWMgY29u
c3Qgc3RydWN0IGN4c3JfbGF0ZW5jeSBjeHNyX2xhdGVuY3lfdGFibGVbXSA9IHsKQEAgLTYyNTIs
MTg4NSArNjI0MiwyNjQgQEAgdm9pZCBpbnRlbF9pbml0X2lwYyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCiAJaW50ZWxfZW5hYmxlX2lwYyhkZXZfcHJpdik7CiB9CiAKLS8qCi0g
KiBMb2NrIHByb3RlY3RpbmcgSVBTIHJlbGF0ZWQgZGF0YSBzdHJ1Y3R1cmVzCi0gKi8KLURFRklO
RV9TUElOTE9DSyhtY2hkZXZfbG9jayk7CitzdGF0aWMgdm9pZCBpYnhfaW5pdF9jbG9ja19nYXRp
bmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQoreworCS8qCisJICogT24gSWJl
eCBQZWFrIGFuZCBDb3VnYXIgUG9pbnQsIHdlIG5lZWQgdG8gZGlzYWJsZSBjbG9jaworCSAqIGdh
dGluZyBmb3IgdGhlIHBhbmVsIHBvd2VyIHNlcXVlbmNlciBvciBpdCB3aWxsIGZhaWwgdG8KKwkg
KiBzdGFydCB1cCB3aGVuIG5vIHBvcnRzIGFyZSBhY3RpdmUuCisJICovCisJSTkxNV9XUklURShT
T1VUSF9EU1BDTEtfR0FURV9ELCBQQ0hfRFBMU1VOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFKTsKK30K
IAotYm9vbCBpcm9ubGFrZV9zZXRfZHJwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwg
dTggdmFsKQorc3RhdGljIHZvaWQgZzR4X2Rpc2FibGVfdHJpY2tsZV9mZWVkKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUg
PSAmaTkxNS0+dW5jb3JlOwotCXUxNiByZ3Zzd2N0bDsKKwllbnVtIHBpcGUgcGlwZTsKIAotCWxv
Y2tkZXBfYXNzZXJ0X2hlbGQoJm1jaGRldl9sb2NrKTsKKwlmb3JfZWFjaF9waXBlKGRldl9wcml2
LCBwaXBlKSB7CisJCUk5MTVfV1JJVEUoRFNQQ05UUihwaXBlKSwKKwkJCSAgIEk5MTVfUkVBRChE
U1BDTlRSKHBpcGUpKSB8CisJCQkgICBESVNQUExBTkVfVFJJQ0tMRV9GRUVEX0RJU0FCTEUpOwog
Ci0Jcmd2c3djdGwgPSBpbnRlbF91bmNvcmVfcmVhZDE2KHVuY29yZSwgTUVNU1dDVEwpOwotCWlm
IChyZ3Zzd2N0bCAmIE1FTUNUTF9DTURfU1RTKSB7Ci0JCURSTV9ERUJVRygiZ3B1IGJ1c3ksIFJD
UyBjaGFuZ2UgcmVqZWN0ZWRcbiIpOwotCQlyZXR1cm4gZmFsc2U7IC8qIHN0aWxsIGJ1c3kgd2l0
aCBhbm90aGVyIGNvbW1hbmQgKi8KKwkJSTkxNV9XUklURShEU1BTVVJGKHBpcGUpLCBJOTE1X1JF
QUQoRFNQU1VSRihwaXBlKSkpOworCQlQT1NUSU5HX1JFQUQoRFNQU1VSRihwaXBlKSk7CiAJfQot
Ci0Jcmd2c3djdGwgPSAoTUVNQ1RMX0NNRF9DSEZSRVEgPDwgTUVNQ1RMX0NNRF9TSElGVCkgfAot
CQkodmFsIDw8IE1FTUNUTF9GUkVRX1NISUZUKSB8IE1FTUNUTF9TRkNBVk07Ci0JaW50ZWxfdW5j
b3JlX3dyaXRlMTYodW5jb3JlLCBNRU1TV0NUTCwgcmd2c3djdGwpOwotCWludGVsX3VuY29yZV9w
b3N0aW5nX3JlYWQxNih1bmNvcmUsIE1FTVNXQ1RMKTsKLQotCXJndnN3Y3RsIHw9IE1FTUNUTF9D
TURfU1RTOwotCWludGVsX3VuY29yZV93cml0ZTE2KHVuY29yZSwgTUVNU1dDVEwsIHJndnN3Y3Rs
KTsKLQotCXJldHVybiB0cnVlOwogfQogCi1zdGF0aWMgdm9pZCBpcm9ubGFrZV9lbmFibGVfZHJw
cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCitzdGF0aWMgdm9pZCBpbGtfaW5p
dF9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCXN0
cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwotCXUzMiByZ3Zt
b2RlY3RsOwotCXU4IGZtYXgsIGZtaW4sIGZzdGFydCwgdnN0YXJ0OwotCi0Jc3Bpbl9sb2NrX2ly
cSgmbWNoZGV2X2xvY2spOwotCi0Jcmd2bW9kZWN0bCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29y
ZSwgTUVNTU9ERUNUTCk7Ci0KLQkvKiBFbmFibGUgdGVtcCByZXBvcnRpbmcgKi8KLQlpbnRlbF91
bmNvcmVfd3JpdGUxNih1bmNvcmUsIFBNTUlTQywgSTkxNV9SRUFEKFBNTUlTQykgfCBNQ1BQQ0Vf
RU4pOwotCWludGVsX3VuY29yZV93cml0ZTE2KHVuY29yZSwgVFNDMSwgSTkxNV9SRUFEKFRTQzEp
IHwgVFNFKTsKLQotCS8qIDEwMG1zIFJDIGV2YWx1YXRpb24gaW50ZXJ2YWxzICovCi0JaW50ZWxf
dW5jb3JlX3dyaXRlKHVuY29yZSwgUkNVUEVJLCAxMDAwMDApOwotCWludGVsX3VuY29yZV93cml0
ZSh1bmNvcmUsIFJDRE5FSSwgMTAwMDAwKTsKLQotCS8qIFNldCBtYXgvbWluIHRocmVzaG9sZHMg
dG8gOTBtcyBhbmQgODBtcyByZXNwZWN0aXZlbHkgKi8KLQlpbnRlbF91bmNvcmVfd3JpdGUodW5j
b3JlLCBSQ0JNQVhBVkcsIDkwMDAwKTsKLQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBSQ0JN
SU5BVkcsIDgwMDAwKTsKLQotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIE1FTUlIWVNULCAx
KTsKLQotCS8qIFNldCB1cCBtaW4sIG1heCwgYW5kIGN1ciBmb3IgaW50ZXJydXB0IGhhbmRsaW5n
ICovCi0JZm1heCA9IChyZ3Ztb2RlY3RsICYgTUVNTU9ERV9GTUFYX01BU0spID4+IE1FTU1PREVf
Rk1BWF9TSElGVDsKLQlmbWluID0gKHJndm1vZGVjdGwgJiBNRU1NT0RFX0ZNSU5fTUFTSyk7Ci0J
ZnN0YXJ0ID0gKHJndm1vZGVjdGwgJiBNRU1NT0RFX0ZTVEFSVF9NQVNLKSA+PgotCQlNRU1NT0RF
X0ZTVEFSVF9TSElGVDsKLQotCXZzdGFydCA9IChpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIFBY
VkZSRVEoZnN0YXJ0KSkgJgotCQkgIFBYVkZSRVFfUFhfTUFTSykgPj4gUFhWRlJFUV9QWF9TSElG
VDsKLQotCWRldl9wcml2LT5pcHMuZm1heCA9IGZtYXg7IC8qIElQUyBjYWxsYmFjayB3aWxsIGlu
Y3JlYXNlIHRoaXMgKi8KLQlkZXZfcHJpdi0+aXBzLmZzdGFydCA9IGZzdGFydDsKKwl1MzIgZHNw
Y2xrX2dhdGUgPSBJTEtfVlJIVU5JVF9DTE9DS19HQVRFX0RJU0FCTEU7CiAKLQlkZXZfcHJpdi0+
aXBzLm1heF9kZWxheSA9IGZzdGFydDsKLQlkZXZfcHJpdi0+aXBzLm1pbl9kZWxheSA9IGZtaW47
Ci0JZGV2X3ByaXYtPmlwcy5jdXJfZGVsYXkgPSBmc3RhcnQ7CisJLyoKKwkgKiBSZXF1aXJlZCBm
b3IgRkJDCisJICogV2FGYmNEaXNhYmxlRHBmY0Nsb2NrR2F0aW5nOmlsaworCSAqLworCWRzcGNs
a19nYXRlIHw9IElMS19EUEZDUlVOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFIHwKKwkJICAgSUxLX0RQ
RkNVTklUX0NMT0NLX0dBVEVfRElTQUJMRSB8CisJCSAgIElMS19EUEZEVU5JVF9DTE9DS19HQVRF
X0VOQUJMRTsKIAotCURSTV9ERUJVR19EUklWRVIoImZtYXg6ICVkLCBmbWluOiAlZCwgZnN0YXJ0
OiAlZFxuIiwKLQkJCSBmbWF4LCBmbWluLCBmc3RhcnQpOworCUk5MTVfV1JJVEUoUENIXzNEQ0dE
SVMwLAorCQkgICBNQVJJVU5JVF9DTE9DS19HQVRFX0RJU0FCTEUgfAorCQkgICBTVlNNVU5JVF9D
TE9DS19HQVRFX0RJU0FCTEUpOworCUk5MTVfV1JJVEUoUENIXzNEQ0dESVMxLAorCQkgICBWRk1V
TklUX0NMT0NLX0dBVEVfRElTQUJMRSk7CiAKLQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLAot
CQkJICAgTUVNSU5UUkVOLAotCQkJICAgTUVNSU5UX0NYX1NVUFJfRU4gfCBNRU1JTlRfRVZBTF9D
SEdfRU4pOworCS8qCisJICogQWNjb3JkaW5nIHRvIHRoZSBzcGVjIHRoZSBmb2xsb3dpbmcgYml0
cyBzaG91bGQgYmUgc2V0IGluCisJICogb3JkZXIgdG8gZW5hYmxlIG1lbW9yeSBzZWxmLXJlZnJl
c2gKKwkgKiBUaGUgYml0IDIyLzIxIG9mIDB4NDIwMDQKKwkgKiBUaGUgYml0IDUgb2YgMHg0MjAy
MAorCSAqIFRoZSBiaXQgMTUgb2YgMHg0NTAwMAorCSAqLworCUk5MTVfV1JJVEUoSUxLX0RJU1BM
QVlfQ0hJQ0tFTjIsCisJCSAgIChJOTE1X1JFQUQoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIpIHwKKwkJ
ICAgIElMS19EUEFSQl9HQVRFIHwgSUxLX1ZTRFBGRF9GVUxMKSk7CisJZHNwY2xrX2dhdGUgfD0g
SUxLX0RQQVJCVU5JVF9DTE9DS19HQVRFX0VOQUJMRTsKKwlJOTE1X1dSSVRFKERJU1BfQVJCX0NU
TCwKKwkJICAgKEk5MTVfUkVBRChESVNQX0FSQl9DVEwpIHwKKwkJICAgIERJU1BfRkJDX1dNX0RJ
UykpOwogCiAJLyoKLQkgKiBJbnRlcnJ1cHRzIHdpbGwgYmUgZW5hYmxlZCBpbiBpcm9ubGFrZV9p
cnFfcG9zdGluc3RhbGwKKwkgKiBCYXNlZCBvbiB0aGUgZG9jdW1lbnQgZnJvbSBoYXJkd2FyZSBn
dXlzIHRoZSBmb2xsb3dpbmcgYml0cworCSAqIHNob3VsZCBiZSBzZXQgdW5jb25kaXRpb25hbGx5
IGluIG9yZGVyIHRvIGVuYWJsZSBGQkMuCisJICogVGhlIGJpdCAyMiBvZiAweDQyMDAwCisJICog
VGhlIGJpdCAyMiBvZiAweDQyMDA0CisJICogVGhlIGJpdCA3LDgsOSBvZiAweDQyMDIwLgogCSAq
LworCWlmIChJU19JUk9OTEFLRV9NKGRldl9wcml2KSkgeworCQkvKiBXYUZiY0FzeW5jaEZsaXBE
aXNhYmxlRmJjUXVldWU6aWxrICovCisJCUk5MTVfV1JJVEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjEs
CisJCQkgICBJOTE1X1JFQUQoSUxLX0RJU1BMQVlfQ0hJQ0tFTjEpIHwKKwkJCSAgIElMS19GQkNR
X0RJUyk7CisJCUk5MTVfV1JJVEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIsCisJCQkgICBJOTE1X1JF
QUQoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIpIHwKKwkJCSAgIElMS19EUEFSQl9HQVRFKTsKKwl9CiAK
LQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBWSURTVEFSVCwgdnN0YXJ0KTsKLQlpbnRlbF91
bmNvcmVfcG9zdGluZ19yZWFkKHVuY29yZSwgVklEU1RBUlQpOworCUk5MTVfV1JJVEUoSUxLX0RT
UENMS19HQVRFX0QsIGRzcGNsa19nYXRlKTsKIAotCXJndm1vZGVjdGwgfD0gTUVNTU9ERV9TV01P
REVfRU47Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgTUVNTU9ERUNUTCwgcmd2bW9kZWN0
bCk7CisJSTkxNV9XUklURShJTEtfRElTUExBWV9DSElDS0VOMiwKKwkJICAgSTkxNV9SRUFEKElM
S19ESVNQTEFZX0NISUNLRU4yKSB8CisJCSAgIElMS19FTFBJTl80MDlfU0VMRUNUKTsKKwlJOTE1
X1dSSVRFKF8zRF9DSElDS0VOMiwKKwkJICAgXzNEX0NISUNLRU4yX1dNX1JFQURfUElQRUxJTkVE
IDw8IDE2IHwKKwkJICAgXzNEX0NISUNLRU4yX1dNX1JFQURfUElQRUxJTkVEKTsKIAotCWlmICh3
YWl0X2Zvcl9hdG9taWMoKGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgTUVNU1dDVEwpICYKLQkJ
CSAgICAgTUVNQ1RMX0NNRF9TVFMpID09IDAsIDEwKSkKLQkJRFJNX0VSUk9SKCJzdHVjayB0cnlp
bmcgdG8gY2hhbmdlIHBlcmYgbW9kZVxuIik7Ci0JbWRlbGF5KDEpOworCS8qIFdhRGlzYWJsZVJl
bmRlckNhY2hlUGlwZWxpbmVkRmx1c2g6aWxrICovCisJSTkxNV9XUklURShDQUNIRV9NT0RFXzAs
CisJCSAgIF9NQVNLRURfQklUX0VOQUJMRShDTTBfUElQRUxJTkVEX1JFTkRFUl9GTFVTSF9ESVNB
QkxFKSk7CiAKLQlpcm9ubGFrZV9zZXRfZHJwcyhkZXZfcHJpdiwgZnN0YXJ0KTsKKwkvKiBXYURp
c2FibGVfUmVuZGVyQ2FjaGVfT3BlcmF0aW9uYWxGbHVzaDppbGsgKi8KKwlJOTE1X1dSSVRFKENB
Q0hFX01PREVfMCwgX01BU0tFRF9CSVRfRElTQUJMRShSQ19PUF9GTFVTSF9FTkFCTEUpKTsKIAot
CWRldl9wcml2LT5pcHMubGFzdF9jb3VudDEgPQotCQlpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IERNSUVDKSArCi0JCWludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgRERSRUMpICsKLQkJaW50ZWxf
dW5jb3JlX3JlYWQodW5jb3JlLCBDU0lFQyk7Ci0JZGV2X3ByaXYtPmlwcy5sYXN0X3RpbWUxID0g
amlmZmllc190b19tc2VjcyhqaWZmaWVzKTsKLQlkZXZfcHJpdi0+aXBzLmxhc3RfY291bnQyID0g
aW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRlhFQyk7Ci0JZGV2X3ByaXYtPmlwcy5sYXN0X3Rp
bWUyID0ga3RpbWVfZ2V0X3Jhd19ucygpOworCWc0eF9kaXNhYmxlX3RyaWNrbGVfZmVlZChkZXZf
cHJpdik7CiAKLQlzcGluX3VubG9ja19pcnEoJm1jaGRldl9sb2NrKTsKKwlpYnhfaW5pdF9jbG9j
a19nYXRpbmcoZGV2X3ByaXYpOwogfQogCi1zdGF0aWMgdm9pZCBpcm9ubGFrZV9kaXNhYmxlX2Ry
cHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0aWMgdm9pZCBjcHRfaW5pdF9j
bG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCXN0cnVj
dCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7Ci0JdTE2IHJndnN3Y3RsOwot
Ci0Jc3Bpbl9sb2NrX2lycSgmbWNoZGV2X2xvY2spOwotCi0Jcmd2c3djdGwgPSBpbnRlbF91bmNv
cmVfcmVhZDE2KHVuY29yZSwgTUVNU1dDVEwpOwotCi0JLyogQWNrIGludGVycnVwdHMsIGRpc2Fi
bGUgRUZDIGludGVycnVwdCAqLwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsCi0JCQkgICBN
RU1JTlRSRU4sCi0JCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIE1FTUlOVFJFTikgJgot
CQkJICAgfk1FTUlOVF9FVkFMX0NIR19FTik7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwg
TUVNSU5UUlNUUywgTUVNSU5UX0VWQUxfQ0hHKTsKLQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3Jl
LAotCQkJICAgREVJRVIsCi0JCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIERFSUVSKSAm
IH5ERV9QQ1VfRVZFTlQpOwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIERFSUlSLCBERV9Q
Q1VfRVZFTlQpOwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsCi0JCQkgICBERUlNUiwKLQkJ
CSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgREVJTVIpIHwgREVfUENVX0VWRU5UKTsKLQot
CS8qIEdvIGJhY2sgdG8gdGhlIHN0YXJ0aW5nIGZyZXF1ZW5jeSAqLwotCWlyb25sYWtlX3NldF9k
cnBzKGk5MTUsIGk5MTUtPmlwcy5mc3RhcnQpOwotCW1kZWxheSgxKTsKLQlyZ3Zzd2N0bCB8PSBN
RU1DVExfQ01EX1NUUzsKLQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBNRU1TV0NUTCwgcmd2
c3djdGwpOwotCW1kZWxheSgxKTsKKwllbnVtIHBpcGUgcGlwZTsKKwl1MzIgdmFsOwogCi0Jc3Bp
bl91bmxvY2tfaXJxKCZtY2hkZXZfbG9jayk7CisJLyoKKwkgKiBPbiBJYmV4IFBlYWsgYW5kIENv
dWdhciBQb2ludCwgd2UgbmVlZCB0byBkaXNhYmxlIGNsb2NrCisJICogZ2F0aW5nIGZvciB0aGUg
cGFuZWwgcG93ZXIgc2VxdWVuY2VyIG9yIGl0IHdpbGwgZmFpbCB0bworCSAqIHN0YXJ0IHVwIHdo
ZW4gbm8gcG9ydHMgYXJlIGFjdGl2ZS4KKwkgKi8KKwlJOTE1X1dSSVRFKFNPVVRIX0RTUENMS19H
QVRFX0QsIFBDSF9EUExTVU5JVF9DTE9DS19HQVRFX0RJU0FCTEUgfAorCQkgICBQQ0hfRFBMVU5J
VF9DTE9DS19HQVRFX0RJU0FCTEUgfAorCQkgICBQQ0hfQ1BVTklUX0NMT0NLX0dBVEVfRElTQUJM
RSk7CisJSTkxNV9XUklURShTT1VUSF9DSElDS0VOMiwgSTkxNV9SRUFEKFNPVVRIX0NISUNLRU4y
KSB8CisJCSAgIERQTFNfRURQX1BQU19GSVhfRElTKTsKKwkvKiBUaGUgYmVsb3cgZml4ZXMgdGhl
IHdlaXJkIGRpc3BsYXkgY29ycnVwdGlvbiwgYSBmZXcgcGl4ZWxzIHNoaWZ0ZWQKKwkgKiBkb3du
d2FyZCwgb24gKG9ubHkpIExWRFMgb2Ygc29tZSBIUCBsYXB0b3BzIHdpdGggSVZZLgorCSAqLwor
CWZvcl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKKwkJdmFsID0gSTkxNV9SRUFEKFRSQU5T
X0NISUNLRU4yKHBpcGUpKTsKKwkJdmFsIHw9IFRSQU5TX0NISUNLRU4yX1RJTUlOR19PVkVSUklE
RTsKKwkJdmFsICY9IH5UUkFOU19DSElDS0VOMl9GRElfUE9MQVJJVFlfUkVWRVJTRUQ7CisJCWlm
IChkZXZfcHJpdi0+dmJ0LmZkaV9yeF9wb2xhcml0eV9pbnZlcnRlZCkKKwkJCXZhbCB8PSBUUkFO
U19DSElDS0VOMl9GRElfUE9MQVJJVFlfUkVWRVJTRUQ7CisJCXZhbCAmPSB+VFJBTlNfQ0hJQ0tF
TjJfRlJBTUVfU1RBUlRfREVMQVlfTUFTSzsKKwkJdmFsICY9IH5UUkFOU19DSElDS0VOMl9ESVNB
QkxFX0RFRVBfQ09MT1JfQ09VTlRFUjsKKwkJdmFsICY9IH5UUkFOU19DSElDS0VOMl9ESVNBQkxF
X0RFRVBfQ09MT1JfTU9ERVNXSVRDSDsKKwkJSTkxNV9XUklURShUUkFOU19DSElDS0VOMihwaXBl
KSwgdmFsKTsKKwl9CisJLyogV0FEUDBDbG9ja0dhdGluZ0Rpc2FibGUgKi8KKwlmb3JfZWFjaF9w
aXBlKGRldl9wcml2LCBwaXBlKSB7CisJCUk5MTVfV1JJVEUoVFJBTlNfQ0hJQ0tFTjEocGlwZSks
CisJCQkgICBUUkFOU19DSElDS0VOMV9EUDBVTklUX0dDX0RJU0FCTEUpOworCX0KIH0KIAotLyog
VGhlcmUncyBhIGZ1bm55IGh3IGlzc3VlIHdoZXJlIHRoZSBodyByZXR1cm5zIGFsbCAwIHdoZW4g
cmVhZGluZyBmcm9tCi0gKiBHRU42X1JQX0lOVEVSUlVQVF9MSU1JVFMuIEhlbmNlIHdlIGFsd2F5
cyBuZWVkIHRvIGNvbXB1dGUgdGhlIGRlc2lyZWQgdmFsdWUKLSAqIG91cnNlbHZlcywgaW5zdGVh
ZCBvZiBkb2luZyBhIHJtdyBjeWNsZSAod2hpY2ggbWlnaHQgcmVzdWx0IGluIHVzIGNsZWFyaW5n
Ci0gKiBhbGwgbGltaXRzIGFuZCB0aGUgZ3B1IHN0dWNrIGF0IHdoYXRldmVyIGZyZXF1ZW5jeSBp
dCBpcyBhdCBhdG0pLgotICovCi1zdGF0aWMgdTMyIGludGVsX3Jwc19saW1pdHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCB2YWwpCitzdGF0aWMgdm9pZCBnZW42X2NoZWNr
X21jaF9zZXR1cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0Jc3RydWN0
IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0JdTMyIGxpbWl0czsKLQot
CS8qIE9ubHkgc2V0IHRoZSBkb3duIGxpbWl0IHdoZW4gd2UndmUgcmVhY2hlZCB0aGUgbG93ZXN0
IGxldmVsIHRvIGF2b2lkCi0JICogZ2V0dGluZyBtb3JlIGludGVycnVwdHMsIG90aGVyd2lzZSBs
ZWF2ZSB0aGlzIGNsZWFyLiBUaGlzIHByZXZlbnRzIGEKLQkgKiByYWNlIGluIHRoZSBodyB3aGVu
IGNvbWluZyBvdXQgb2YgcmM2OiBUaGVyZSdzIGEgdGlueSB3aW5kb3cgd2hlcmUKLQkgKiB0aGUg
aHcgcnVucyBhdCB0aGUgbWluaW1hbCBjbG9jayBiZWZvcmUgc2VsZWN0aW5nIHRoZSBkZXNpcmVk
Ci0JICogZnJlcXVlbmN5LCBpZiB0aGUgZG93biB0aHJlc2hvbGQgZXhwaXJlcyBpbiB0aGF0IHdp
bmRvdyB3ZSB3aWxsIG5vdAotCSAqIHJlY2VpdmUgYSBkb3duIGludGVycnVwdC4gKi8KLQlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Ci0JCWxpbWl0cyA9IChycHMtPm1heF9mcmVxX3Nv
ZnRsaW1pdCkgPDwgMjM7Ci0JCWlmICh2YWwgPD0gcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQpCi0J
CQlsaW1pdHMgfD0gKHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0KSA8PCAxNDsKLQl9IGVsc2Ugewot
CQlsaW1pdHMgPSBycHMtPm1heF9mcmVxX3NvZnRsaW1pdCA8PCAyNDsKLQkJaWYgKHZhbCA8PSBy
cHMtPm1pbl9mcmVxX3NvZnRsaW1pdCkKLQkJCWxpbWl0cyB8PSBycHMtPm1pbl9mcmVxX3NvZnRs
aW1pdCA8PCAxNjsKLQl9CisJdTMyIHRtcDsKIAotCXJldHVybiBsaW1pdHM7CisJdG1wID0gSTkx
NV9SRUFEKE1DSF9TU0tQRCk7CisJaWYgKCh0bXAgJiBNQ0hfU1NLUERfV00wX01BU0spICE9IE1D
SF9TU0tQRF9XTTBfVkFMKQorCQlEUk1fREVCVUdfS01TKCJXcm9uZyBNQ0hfU1NLUEQgdmFsdWU6
IDB4JTA4eCBUaGlzIGNhbiBjYXVzZSB1bmRlcnJ1bnMuXG4iLAorCQkJICAgICAgdG1wKTsKIH0K
IAotc3RhdGljIHZvaWQgcnBzX3NldF9wb3dlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsIGludCBuZXdfcG93ZXIpCitzdGF0aWMgdm9pZCBnZW42X2luaXRfY2xvY2tfZ2F0aW5n
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlzdHJ1Y3QgaW50ZWxfcnBz
ICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKLQl1MzIgdGhyZXNob2xkX3VwID0gMCwgdGhy
ZXNob2xkX2Rvd24gPSAwOyAvKiBpbiAlICovCi0JdTMyIGVpX3VwID0gMCwgZWlfZG93biA9IDA7
Ci0KLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZycHMtPnBvd2VyLm11dGV4KTsKKwl1MzIgZHNwY2xr
X2dhdGUgPSBJTEtfVlJIVU5JVF9DTE9DS19HQVRFX0RJU0FCTEU7CiAKLQlpZiAobmV3X3Bvd2Vy
ID09IHJwcy0+cG93ZXIubW9kZSkKLQkJcmV0dXJuOworCUk5MTVfV1JJVEUoSUxLX0RTUENMS19H
QVRFX0QsIGRzcGNsa19nYXRlKTsKIAotCS8qIE5vdGUgdGhlIHVuaXRzIGhlcmUgYXJlIG5vdCBl
eGFjdGx5IDF1cywgYnV0IDEyODBucy4gKi8KLQlzd2l0Y2ggKG5ld19wb3dlcikgewotCWNhc2Ug
TE9XX1BPV0VSOgotCQkvKiBVcGNsb2NrIGlmIG1vcmUgdGhhbiA5NSUgYnVzeSBvdmVyIDE2bXMg
Ki8KLQkJZWlfdXAgPSAxNjAwMDsKLQkJdGhyZXNob2xkX3VwID0gOTU7CisJSTkxNV9XUklURShJ
TEtfRElTUExBWV9DSElDS0VOMiwKKwkJICAgSTkxNV9SRUFEKElMS19ESVNQTEFZX0NISUNLRU4y
KSB8CisJCSAgIElMS19FTFBJTl80MDlfU0VMRUNUKTsKIAotCQkvKiBEb3duY2xvY2sgaWYgbGVz
cyB0aGFuIDg1JSBidXN5IG92ZXIgMzJtcyAqLwotCQllaV9kb3duID0gMzIwMDA7Ci0JCXRocmVz
aG9sZF9kb3duID0gODU7Ci0JCWJyZWFrOworCS8qIFdhRGlzYWJsZUhpWlBsYW5lc1doZW5NU0FB
RW5hYmxlZDpzbmIgKi8KKwlJOTE1X1dSSVRFKF8zRF9DSElDS0VOLAorCQkgICBfTUFTS0VEX0JJ
VF9FTkFCTEUoXzNEX0NISUNLRU5fSElaX1BMQU5FX0RJU0FCTEVfTVNBQV80WF9TTkIpKTsKIAot
CWNhc2UgQkVUV0VFTjoKLQkJLyogVXBjbG9jayBpZiBtb3JlIHRoYW4gOTAlIGJ1c3kgb3ZlciAx
M21zICovCi0JCWVpX3VwID0gMTMwMDA7Ci0JCXRocmVzaG9sZF91cCA9IDkwOworCS8qIFdhRGlz
YWJsZV9SZW5kZXJDYWNoZV9PcGVyYXRpb25hbEZsdXNoOnNuYiAqLworCUk5MTVfV1JJVEUoQ0FD
SEVfTU9ERV8wLCBfTUFTS0VEX0JJVF9ESVNBQkxFKFJDX09QX0ZMVVNIX0VOQUJMRSkpOwogCi0J
CS8qIERvd25jbG9jayBpZiBsZXNzIHRoYW4gNzUlIGJ1c3kgb3ZlciAzMm1zICovCi0JCWVpX2Rv
d24gPSAzMjAwMDsKLQkJdGhyZXNob2xkX2Rvd24gPSA3NTsKLQkJYnJlYWs7CisJLyoKKwkgKiBC
U3BlYyByZWNvb21lbmRzIDh4NCB3aGVuIE1TQUEgaXMgdXNlZCwKKwkgKiBob3dldmVyIGluIHBy
YWN0aWNlIDE2eDQgc2VlbXMgZmFzdGVzdC4KKwkgKgorCSAqIE5vdGUgdGhhdCBQUy9XTSB0aHJl
YWQgY291bnRzIGRlcGVuZCBvbiB0aGUgV0laIGhhc2hpbmcKKwkgKiBkaXNhYmxlIGJpdCwgd2hp
Y2ggd2UgZG9uJ3QgdG91Y2ggaGVyZSwgYnV0IGl0J3MgZ29vZAorCSAqIHRvIGtlZXAgaW4gbWlu
ZCAoc2VlIDNEU1RBVEVfUFMgYW5kIDNEU1RBVEVfV00pLgorCSAqLworCUk5MTVfV1JJVEUoR0VO
Nl9HVF9NT0RFLAorCQkgICBfTUFTS0VEX0ZJRUxEKEdFTjZfV0laX0hBU0hJTkdfTUFTSywgR0VO
Nl9XSVpfSEFTSElOR18xNng0KSk7CiAKLQljYXNlIEhJR0hfUE9XRVI6Ci0JCS8qIFVwY2xvY2sg
aWYgbW9yZSB0aGFuIDg1JSBidXN5IG92ZXIgMTBtcyAqLwotCQllaV91cCA9IDEwMDAwOwotCQl0
aHJlc2hvbGRfdXAgPSA4NTsKKwlJOTE1X1dSSVRFKENBQ0hFX01PREVfMCwKKwkJICAgX01BU0tF
RF9CSVRfRElTQUJMRShDTTBfU1RDX0VWSUNUX0RJU0FCTEVfTFJBX1NOQikpOwogCi0JCS8qIERv
d25jbG9jayBpZiBsZXNzIHRoYW4gNjAlIGJ1c3kgb3ZlciAzMm1zICovCi0JCWVpX2Rvd24gPSAz
MjAwMDsKLQkJdGhyZXNob2xkX2Rvd24gPSA2MDsKLQkJYnJlYWs7Ci0JfQorCUk5MTVfV1JJVEUo
R0VONl9VQ0dDVEwxLAorCQkgICBJOTE1X1JFQUQoR0VONl9VQ0dDVEwxKSB8CisJCSAgIEdFTjZf
QkxCVU5JVF9DTE9DS19HQVRFX0RJU0FCTEUgfAorCQkgICBHRU42X0NTVU5JVF9DTE9DS19HQVRF
X0RJU0FCTEUpOwogCi0JLyogV2hlbiBieXQgY2FuIHN1cnZpdmUgd2l0aG91dCBzeXN0ZW0gaGFu
ZyB3aXRoIGR5bmFtaWMKLQkgKiBzdyBmcmVxIGFkanVzdG1lbnRzLCB0aGlzIHJlc3RyaWN0aW9u
IGNhbiBiZSBsaWZ0ZWQuCisJLyogQWNjb3JkaW5nIHRvIHRoZSBCU3BlYyB2b2wxZywgYml0IDEy
IChSQ1BCVU5JVCkgY2xvY2sKKwkgKiBnYXRpbmcgZGlzYWJsZSBtdXN0IGJlIHNldC4gIEZhaWx1
cmUgdG8gc2V0IGl0IHJlc3VsdHMgaW4KKwkgKiBmbGlja2VyaW5nIHBpeGVscyBkdWUgdG8gWiB3
cml0ZSBvcmRlcmluZyBmYWlsdXJlcyBhZnRlcgorCSAqIHNvbWUgYW1vdW50IG9mIHJ1bnRpbWUg
aW4gdGhlIE1lc2EgImZpcmUiIGRlbW8sIGFuZCBVbmlnaW5lCisJICogU2FuY3R1YXJ5IGFuZCBU
cm9waWNzLCBhbmQgYXBwYXJlbnRseSBhbnl0aGluZyBlbHNlIHdpdGgKKwkgKiBhbHBoYSB0ZXN0
IG9yIHBpeGVsIGRpc2NhcmQuCisJICoKKwkgKiBBY2NvcmRpbmcgdG8gdGhlIHNwZWMsIGJpdCAx
MSAoUkNDVU5JVCkgbXVzdCBhbHNvIGJlIHNldCwKKwkgKiBidXQgd2UgZGlkbid0IGRlYnVnIGFj
dHVhbCB0ZXN0Y2FzZXMgdG8gZmluZCBpdCBvdXQuCisJICoKKwkgKiBXYURpc2FibGVSQ0NVbml0
Q2xvY2tHYXRpbmc6c25iCisJICogV2FEaXNhYmxlUkNQQlVuaXRDbG9ja0dhdGluZzpzbmIKIAkg
Ki8KLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCi0JCWdvdG8gc2tpcF9od193cml0ZTsK
LQotCUk5MTVfV1JJVEUoR0VONl9SUF9VUF9FSSwKLQkJICAgR1RfSU5URVJWQUxfRlJPTV9VUyhk
ZXZfcHJpdiwgZWlfdXApKTsKLQlJOTE1X1dSSVRFKEdFTjZfUlBfVVBfVEhSRVNIT0xELAotCQkg
ICBHVF9JTlRFUlZBTF9GUk9NX1VTKGRldl9wcml2LAotCQkJCSAgICAgICBlaV91cCAqIHRocmVz
aG9sZF91cCAvIDEwMCkpOwotCi0JSTkxNV9XUklURShHRU42X1JQX0RPV05fRUksCi0JCSAgIEdU
X0lOVEVSVkFMX0ZST01fVVMoZGV2X3ByaXYsIGVpX2Rvd24pKTsKLQlJOTE1X1dSSVRFKEdFTjZf
UlBfRE9XTl9USFJFU0hPTEQsCi0JCSAgIEdUX0lOVEVSVkFMX0ZST01fVVMoZGV2X3ByaXYsCi0J
CQkJICAgICAgIGVpX2Rvd24gKiB0aHJlc2hvbGRfZG93biAvIDEwMCkpOwotCi0JSTkxNV9XUklU
RShHRU42X1JQX0NPTlRST0wsCi0JCSAgIChJTlRFTF9HRU4oZGV2X3ByaXYpID4gOSA/IDAgOiBH
RU42X1JQX01FRElBX1RVUkJPKSB8Ci0JCSAgIEdFTjZfUlBfTUVESUFfSFdfTk9STUFMX01PREUg
fAotCQkgICBHRU42X1JQX01FRElBX0lTX0dGWCB8Ci0JCSAgIEdFTjZfUlBfRU5BQkxFIHwKLQkJ
ICAgR0VONl9SUF9VUF9CVVNZX0FWRyB8Ci0JCSAgIEdFTjZfUlBfRE9XTl9JRExFX0FWRyk7Ci0K
LXNraXBfaHdfd3JpdGU6Ci0JcnBzLT5wb3dlci5tb2RlID0gbmV3X3Bvd2VyOwotCXJwcy0+cG93
ZXIudXBfdGhyZXNob2xkID0gdGhyZXNob2xkX3VwOwotCXJwcy0+cG93ZXIuZG93bl90aHJlc2hv
bGQgPSB0aHJlc2hvbGRfZG93bjsKLX0KLQotc3RhdGljIHZvaWQgZ2VuNl9zZXRfcnBzX3RocmVz
aG9sZHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCB2YWwpCi17Ci0Jc3Ry
dWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0JaW50IG5ld19wb3dl
cjsKLQotCW5ld19wb3dlciA9IHJwcy0+cG93ZXIubW9kZTsKLQlzd2l0Y2ggKHJwcy0+cG93ZXIu
bW9kZSkgewotCWNhc2UgTE9XX1BPV0VSOgotCQlpZiAodmFsID4gcnBzLT5lZmZpY2llbnRfZnJl
cSArIDEgJiYKLQkJICAgIHZhbCA+IHJwcy0+Y3VyX2ZyZXEpCi0JCQluZXdfcG93ZXIgPSBCRVRX
RUVOOwotCQlicmVhazsKKwlJOTE1X1dSSVRFKEdFTjZfVUNHQ1RMMiwKKwkJICAgR0VONl9SQ1BC
VU5JVF9DTE9DS19HQVRFX0RJU0FCTEUgfAorCQkgICBHRU42X1JDQ1VOSVRfQ0xPQ0tfR0FURV9E
SVNBQkxFKTsKIAotCWNhc2UgQkVUV0VFTjoKLQkJaWYgKHZhbCA8PSBycHMtPmVmZmljaWVudF9m
cmVxICYmCi0JCSAgICB2YWwgPCBycHMtPmN1cl9mcmVxKQotCQkJbmV3X3Bvd2VyID0gTE9XX1BP
V0VSOwotCQllbHNlIGlmICh2YWwgPj0gcnBzLT5ycDBfZnJlcSAmJgotCQkJIHZhbCA+IHJwcy0+
Y3VyX2ZyZXEpCi0JCQluZXdfcG93ZXIgPSBISUdIX1BPV0VSOwotCQlicmVhazsKKwkvKiBXYVN0
cmlwc0ZhbnNEaXNhYmxlRmFzdENsaXBQZXJmb3JtYW5jZUZpeDpzbmIgKi8KKwlJOTE1X1dSSVRF
KF8zRF9DSElDS0VOMywKKwkJICAgX01BU0tFRF9CSVRfRU5BQkxFKF8zRF9DSElDS0VOM19TRl9E
SVNBQkxFX0ZBU1RDTElQX0NVTEwpKTsKIAotCWNhc2UgSElHSF9QT1dFUjoKLQkJaWYgKHZhbCA8
IChycHMtPnJwMV9mcmVxICsgcnBzLT5ycDBfZnJlcSkgPj4gMSAmJgotCQkgICAgdmFsIDwgcnBz
LT5jdXJfZnJlcSkKLQkJCW5ld19wb3dlciA9IEJFVFdFRU47Ci0JCWJyZWFrOwotCX0KLQkvKiBN
YXgvbWluIGJpbnMgYXJlIHNwZWNpYWwgKi8KLQlpZiAodmFsIDw9IHJwcy0+bWluX2ZyZXFfc29m
dGxpbWl0KQotCQluZXdfcG93ZXIgPSBMT1dfUE9XRVI7Ci0JaWYgKHZhbCA+PSBycHMtPm1heF9m
cmVxX3NvZnRsaW1pdCkKLQkJbmV3X3Bvd2VyID0gSElHSF9QT1dFUjsKKwkvKgorCSAqIEJzcGVj
IHNheXM6CisJICogIlRoaXMgYml0IG11c3QgYmUgc2V0IGlmIDNEU1RBVEVfQ0xJUCBjbGlwIG1v
ZGUgaXMgc2V0IHRvIG5vcm1hbCBhbmQKKwkgKiAzRFNUQVRFX1NGIG51bWJlciBvZiBTRiBvdXRw
dXQgYXR0cmlidXRlcyBpcyBtb3JlIHRoYW4gMTYuIgorCSAqLworCUk5MTVfV1JJVEUoXzNEX0NI
SUNLRU4zLAorCQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoXzNEX0NISUNLRU4zX1NGX0RJU0FCTEVf
UElQRUxJTkVEX0FUVFJfRkVUQ0gpKTsKIAotCW11dGV4X2xvY2soJnJwcy0+cG93ZXIubXV0ZXgp
OwotCWlmIChycHMtPnBvd2VyLmludGVyYWN0aXZlKQotCQluZXdfcG93ZXIgPSBISUdIX1BPV0VS
OwotCXJwc19zZXRfcG93ZXIoZGV2X3ByaXYsIG5ld19wb3dlcik7Ci0JbXV0ZXhfdW5sb2NrKCZy
cHMtPnBvd2VyLm11dGV4KTsKLX0KKwkvKgorCSAqIEFjY29yZGluZyB0byB0aGUgc3BlYyB0aGUg
Zm9sbG93aW5nIGJpdHMgc2hvdWxkIGJlCisJICogc2V0IGluIG9yZGVyIHRvIGVuYWJsZSBtZW1v
cnkgc2VsZi1yZWZyZXNoIGFuZCBmYmM6CisJICogVGhlIGJpdDIxIGFuZCBiaXQyMiBvZiAweDQy
MDAwCisJICogVGhlIGJpdDIxIGFuZCBiaXQyMiBvZiAweDQyMDA0CisJICogVGhlIGJpdDUgYW5k
IGJpdDcgb2YgMHg0MjAyMAorCSAqIFRoZSBiaXQxNCBvZiAweDcwMTgwCisJICogVGhlIGJpdDE0
IG9mIDB4NzExODAKKwkgKgorCSAqIFdhRmJjQXN5bmNoRmxpcERpc2FibGVGYmNRdWV1ZTpzbmIK
KwkgKi8KKwlJOTE1X1dSSVRFKElMS19ESVNQTEFZX0NISUNLRU4xLAorCQkgICBJOTE1X1JFQUQo
SUxLX0RJU1BMQVlfQ0hJQ0tFTjEpIHwKKwkJICAgSUxLX0ZCQ1FfRElTIHwgSUxLX1BBQlNUUkVU
Q0hfRElTKTsKKwlJOTE1X1dSSVRFKElMS19ESVNQTEFZX0NISUNLRU4yLAorCQkgICBJOTE1X1JF
QUQoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIpIHwKKwkJICAgSUxLX0RQQVJCX0dBVEUgfCBJTEtfVlNE
UEZEX0ZVTEwpOworCUk5MTVfV1JJVEUoSUxLX0RTUENMS19HQVRFX0QsCisJCSAgIEk5MTVfUkVB
RChJTEtfRFNQQ0xLX0dBVEVfRCkgfAorCQkgICBJTEtfRFBBUkJVTklUX0NMT0NLX0dBVEVfRU5B
QkxFICB8CisJCSAgIElMS19EUEZEVU5JVF9DTE9DS19HQVRFX0VOQUJMRSk7CiAKLXZvaWQgaW50
ZWxfcnBzX21hcmtfaW50ZXJhY3RpdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIGJv
b2wgaW50ZXJhY3RpdmUpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmk5MTUtPmd0X3Bt
LnJwczsKKwlnNHhfZGlzYWJsZV90cmlja2xlX2ZlZWQoZGV2X3ByaXYpOwogCi0JaWYgKElOVEVM
X0dFTihpOTE1KSA8IDYpCi0JCXJldHVybjsKKwljcHRfaW5pdF9jbG9ja19nYXRpbmcoZGV2X3By
aXYpOwogCi0JbXV0ZXhfbG9jaygmcnBzLT5wb3dlci5tdXRleCk7Ci0JaWYgKGludGVyYWN0aXZl
KSB7Ci0JCWlmICghcnBzLT5wb3dlci5pbnRlcmFjdGl2ZSsrICYmIFJFQURfT05DRShpOTE1LT5n
dC5hd2FrZSkpCi0JCQlycHNfc2V0X3Bvd2VyKGk5MTUsIEhJR0hfUE9XRVIpOwotCX0gZWxzZSB7
Ci0JCUdFTV9CVUdfT04oIXJwcy0+cG93ZXIuaW50ZXJhY3RpdmUpOwotCQlycHMtPnBvd2VyLmlu
dGVyYWN0aXZlLS07Ci0JfQotCW11dGV4X3VubG9jaygmcnBzLT5wb3dlci5tdXRleCk7CisJZ2Vu
Nl9jaGVja19tY2hfc2V0dXAoZGV2X3ByaXYpOwogfQogCi1zdGF0aWMgdTMyIGdlbjZfcnBzX3Bt
X21hc2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCB2YWwpCitzdGF0aWMg
dm9pZCBnZW43X3NldHVwX2ZpeGVkX2Z1bmNfc2NoZWR1bGVyKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKIHsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0
X3BtLnJwczsKLQl1MzIgbWFzayA9IDA7Ci0KLQkvKiBXZSB1c2UgVVBfRUlfRVhQSVJFRCBpbnRl
cnVwdHMgZm9yIGJvdGggdXAvZG93biBpbiBtYW51YWwgbW9kZSAqLwotCWlmICh2YWwgPiBycHMt
Pm1pbl9mcmVxX3NvZnRsaW1pdCkKLQkJbWFzayB8PSBHRU42X1BNX1JQX1VQX0VJX0VYUElSRUQg
fCBHRU42X1BNX1JQX0RPV05fVEhSRVNIT0xEIHwgR0VONl9QTV9SUF9ET1dOX1RJTUVPVVQ7Ci0J
aWYgKHZhbCA8IHJwcy0+bWF4X2ZyZXFfc29mdGxpbWl0KQotCQltYXNrIHw9IEdFTjZfUE1fUlBf
VVBfRUlfRVhQSVJFRCB8IEdFTjZfUE1fUlBfVVBfVEhSRVNIT0xEOworCXUzMiByZWcgPSBJOTE1
X1JFQUQoR0VON19GRl9USFJFQURfTU9ERSk7CiAKLQltYXNrICY9IGRldl9wcml2LT5wbV9ycHNf
ZXZlbnRzOworCS8qCisJICogV2FWU1RocmVhZERpc3BhdGNoT3ZlcnJpZGU6aXZiLHZsdgorCSAq
CisJICogVGhpcyBhY3R1YWxseSBvdmVycmlkZXMgdGhlIGRpc3BhdGNoCisJICogbW9kZSBmb3Ig
YWxsIHRocmVhZCB0eXBlcy4KKwkgKi8KKwlyZWcgJj0gfkdFTjdfRkZfU0NIRURfTUFTSzsKKwly
ZWcgfD0gR0VON19GRl9UU19TQ0hFRF9IVzsKKwlyZWcgfD0gR0VON19GRl9WU19TQ0hFRF9IVzsK
KwlyZWcgfD0gR0VON19GRl9EU19TQ0hFRF9IVzsKIAotCXJldHVybiBnZW42X3Nhbml0aXplX3Jw
c19wbV9tYXNrKGRldl9wcml2LCB+bWFzayk7CisJSTkxNV9XUklURShHRU43X0ZGX1RIUkVBRF9N
T0RFLCByZWcpOwogfQogCi0vKiBnZW42X3NldF9ycHMgaXMgY2FsbGVkIHRvIHVwZGF0ZSB0aGUg
ZnJlcXVlbmN5IHJlcXVlc3QsIGJ1dCBzaG91bGQgYWxzbyBiZQotICogY2FsbGVkIHdoZW4gdGhl
IHJhbmdlIChtaW5fZGVsYXkgYW5kIG1heF9kZWxheSkgaXMgbW9kaWZpZWQgc28gdGhhdCB3ZSBj
YW4KLSAqIHVwZGF0ZSB0aGUgR0VONl9SUF9JTlRFUlJVUFRfTElNSVRTIHJlZ2lzdGVyIGFjY29y
ZGluZ2x5LiAqLwotc3RhdGljIGludCBnZW42X3NldF9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LCB1OCB2YWwpCitzdGF0aWMgdm9pZCBscHRfaW5pdF9jbG9ja19nYXRpbmco
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCXN0cnVjdCBpbnRlbF9ycHMg
KnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwotCi0JLyogbWluL21heCBkZWxheSBtYXkgc3Rp
bGwgaGF2ZSBiZWVuIG1vZGlmaWVkIHNvIGJlIHN1cmUgdG8KLQkgKiB3cml0ZSB0aGUgbGltaXRz
IHZhbHVlLgotCSAqLwotCWlmICh2YWwgIT0gcnBzLT5jdXJfZnJlcSkgewotCQlnZW42X3NldF9y
cHNfdGhyZXNob2xkcyhkZXZfcHJpdiwgdmFsKTsKLQotCQlpZiAoSU5URUxfR0VOKGRldl9wcml2
KSA+PSA5KQotCQkJSTkxNV9XUklURShHRU42X1JQTlNXUkVRLAotCQkJCSAgIEdFTjlfRlJFUVVF
TkNZKHZhbCkpOwotCQllbHNlIGlmIChJU19IQVNXRUxMKGRldl9wcml2KSB8fCBJU19CUk9BRFdF
TEwoZGV2X3ByaXYpKQotCQkJSTkxNV9XUklURShHRU42X1JQTlNXUkVRLAotCQkJCSAgIEhTV19G
UkVRVUVOQ1kodmFsKSk7Ci0JCWVsc2UKLQkJCUk5MTVfV1JJVEUoR0VONl9SUE5TV1JFUSwKLQkJ
CQkgICBHRU42X0ZSRVFVRU5DWSh2YWwpIHwKLQkJCQkgICBHRU42X09GRlNFVCgwKSB8Ci0JCQkJ
ICAgR0VONl9BR0dSRVNTSVZFX1RVUkJPKTsKLQl9Ci0KLQkvKiBNYWtlIHN1cmUgd2UgY29udGlu
dWUgdG8gZ2V0IGludGVycnVwdHMKLQkgKiB1bnRpbCB3ZSBoaXQgdGhlIG1pbmltdW0gb3IgbWF4
aW11bSBmcmVxdWVuY2llcy4KLQkgKi8KLQlJOTE1X1dSSVRFKEdFTjZfUlBfSU5URVJSVVBUX0xJ
TUlUUywgaW50ZWxfcnBzX2xpbWl0cyhkZXZfcHJpdiwgdmFsKSk7Ci0JSTkxNV9XUklURShHRU42
X1BNSU5UUk1TSywgZ2VuNl9ycHNfcG1fbWFzayhkZXZfcHJpdiwgdmFsKSk7Ci0KLQlycHMtPmN1
cl9mcmVxID0gdmFsOwotCXRyYWNlX2ludGVsX2dwdV9mcmVxX2NoYW5nZShpbnRlbF9ncHVfZnJl
cShkZXZfcHJpdiwgdmFsKSk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIGludCB2YWxsZXl2
aWV3X3NldF9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1OCB2YWwpCi17
Ci0JaW50IGVycjsKLQotCWlmIChXQVJOX09OQ0UoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikgJiYg
KHZhbCAmIDEpLAotCQkgICAgICAiT2RkIEdQVSBmcmVxIHZhbHVlXG4iKSkKLQkJdmFsICY9IH4x
OwotCi0JSTkxNV9XUklURShHRU42X1BNSU5UUk1TSywgZ2VuNl9ycHNfcG1fbWFzayhkZXZfcHJp
diwgdmFsKSk7Ci0KLQlpZiAodmFsICE9IGRldl9wcml2LT5ndF9wbS5ycHMuY3VyX2ZyZXEpIHsK
LQkJdmx2X3B1bml0X2dldChkZXZfcHJpdik7Ci0JCWVyciA9IHZsdl9wdW5pdF93cml0ZShkZXZf
cHJpdiwgUFVOSVRfUkVHX0dQVV9GUkVRX1JFUSwgdmFsKTsKLQkJdmx2X3B1bml0X3B1dChkZXZf
cHJpdik7Ci0JCWlmIChlcnIpCi0JCQlyZXR1cm4gZXJyOwotCi0JCWdlbjZfc2V0X3Jwc190aHJl
c2hvbGRzKGRldl9wcml2LCB2YWwpOwotCX0KLQotCWRldl9wcml2LT5ndF9wbS5ycHMuY3VyX2Zy
ZXEgPSB2YWw7Ci0JdHJhY2VfaW50ZWxfZ3B1X2ZyZXFfY2hhbmdlKGludGVsX2dwdV9mcmVxKGRl
dl9wcml2LCB2YWwpKTsKLQotCXJldHVybiAwOwotfQotCi0vKiB2bHZfc2V0X3Jwc19pZGxlOiBT
ZXQgdGhlIGZyZXF1ZW5jeSB0byBpZGxlLCBpZiBHZnggY2xvY2tzIGFyZSBkb3duCi0gKgotICog
KiBJZiBHZnggaXMgSWRsZSwgdGhlbgotICogMS4gRm9yY2V3YWtlIE1lZGlhIHdlbGwuCi0gKiAy
LiBSZXF1ZXN0IGlkbGUgZnJlcS4KLSAqIDMuIFJlbGVhc2UgRm9yY2V3YWtlIG9mIE1lZGlhIHdl
bGwuCi0qLwotc3RhdGljIHZvaWQgdmx2X3NldF9ycHNfaWRsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5n
dF9wbS5ycHM7Ci0JdTMyIHZhbCA9IHJwcy0+aWRsZV9mcmVxOwotCWludCBlcnI7Ci0KLQlpZiAo
cnBzLT5jdXJfZnJlcSA8PSB2YWwpCi0JCXJldHVybjsKLQotCS8qIFRoZSBwdW5pdCBkZWxheXMg
dGhlIHdyaXRlIG9mIHRoZSBmcmVxdWVuY3kgYW5kIHZvbHRhZ2UgdW50aWwgaXQKLQkgKiBkZXRl
cm1pbmVzIHRoZSBHUFUgaXMgYXdha2UuIER1cmluZyBub3JtYWwgdXNhZ2Ugd2UgZG9uJ3Qgd2Fu
dCB0bwotCSAqIHdhc3RlIHBvd2VyIGNoYW5naW5nIHRoZSBmcmVxdWVuY3kgaWYgdGhlIEdQVSBp
cyBzbGVlcGluZyAocmM2KS4KLQkgKiBIb3dldmVyLCB0aGUgR1BVIGFuZCBkcml2ZXIgaXMgbm93
IGlkbGUgYW5kIHdlIGRvIG5vdCB3YW50IHRvIGRlbGF5Ci0JICogc3dpdGNoaW5nIHRvIG1pbmlt
dW0gdm9sdGFnZSAocmVkdWNpbmcgcG93ZXIgd2hpbHN0IGlkbGUpIGFzIHdlIGRvCi0JICogbm90
IGV4cGVjdCB0byBiZSB3b2tlbiBpbiB0aGUgbmVhciBmdXR1cmUgYW5kIHNvIG11c3QgZmx1c2gg
dGhlCi0JICogY2hhbmdlIGJ5IHdha2luZyB0aGUgZGV2aWNlLgotCSAqCi0JICogV2UgY2hvb3Nl
IHRvIHRha2UgdGhlIG1lZGlhIHBvd2Vyd2VsbCAoZWl0aGVyIHdvdWxkIGRvIHRvIHRyaWNrIHRo
ZQotCSAqIHB1bml0IGludG8gY29tbWl0dGluZyB0aGUgdm9sdGFnZSBjaGFuZ2UpIGFzIHRoYXQg
dGFrZXMgYSBsb3QgbGVzcwotCSAqIHBvd2VyIHRoYW4gdGhlIHJlbmRlciBwb3dlcndlbGwuCi0J
ICovCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNF
V0FLRV9NRURJQSk7Ci0JZXJyID0gdmFsbGV5dmlld19zZXRfcnBzKGRldl9wcml2LCB2YWwpOwot
CWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0Vf
TUVESUEpOwotCi0JaWYgKGVycikKLQkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gc2V0IFJQUyBmb3Ig
aWRsZVxuIik7Ci19Ci0KLXZvaWQgZ2VuNl9ycHNfYnVzeShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9w
bS5ycHM7Ci0KLQltdXRleF9sb2NrKCZycHMtPmxvY2spOwotCWlmIChycHMtPmVuYWJsZWQpIHsK
LQkJdTggZnJlcTsKLQotCQlpZiAoZGV2X3ByaXYtPnBtX3Jwc19ldmVudHMgJiBHRU42X1BNX1JQ
X1VQX0VJX0VYUElSRUQpCi0JCQlnZW42X3Jwc19yZXNldF9laShkZXZfcHJpdik7Ci0JCUk5MTVf
V1JJVEUoR0VONl9QTUlOVFJNU0ssCi0JCQkgICBnZW42X3Jwc19wbV9tYXNrKGRldl9wcml2LCBy
cHMtPmN1cl9mcmVxKSk7Ci0KLQkJZ2VuNl9lbmFibGVfcnBzX2ludGVycnVwdHMoZGV2X3ByaXYp
OwotCi0JCS8qIFVzZSB0aGUgdXNlcidzIGRlc2lyZWQgZnJlcXVlbmN5IGFzIGEgZ3VpZGUsIGJ1
dCBmb3IgYmV0dGVyCi0JCSAqIHBlcmZvcm1hbmNlLCBqdW1wIGRpcmVjdGx5IHRvIFJQZSBhcyBv
dXIgc3RhcnRpbmcgZnJlcXVlbmN5LgotCQkgKi8KLQkJZnJlcSA9IG1heChycHMtPmN1cl9mcmVx
LAotCQkJICAgcnBzLT5lZmZpY2llbnRfZnJlcSk7Ci0KLQkJaWYgKGludGVsX3NldF9ycHMoZGV2
X3ByaXYsCi0JCQkJICBjbGFtcChmcmVxLAotCQkJCQlycHMtPm1pbl9mcmVxX3NvZnRsaW1pdCwK
LQkJCQkJcnBzLT5tYXhfZnJlcV9zb2Z0bGltaXQpKSkKLQkJCURSTV9ERUJVR19EUklWRVIoIkZh
aWxlZCB0byBzZXQgaWRsZSBmcmVxdWVuY3lcbiIpOwotCX0KLQltdXRleF91bmxvY2soJnJwcy0+
bG9jayk7Ci19Ci0KLXZvaWQgZ2VuNl9ycHNfaWRsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5y
cHM7Ci0KLQkvKiBGbHVzaCBvdXIgYm90dG9tLWhhbGYgc28gdGhhdCBpdCBkb2VzIG5vdCByYWNl
IHdpdGggdXMKLQkgKiBzZXR0aW5nIHRoZSBpZGxlIGZyZXF1ZW5jeSBhbmQgc28gdGhhdCBpdCBp
cyBib3VuZGVkIGJ5Ci0JICogb3VyIHJwbSB3YWtlcmVmLiBBbmQgdGhlbiBkaXNhYmxlIHRoZSBp
bnRlcnJ1cHRzIHRvIHN0b3AgYW55Ci0JICogZnV0aGVyIFJQUyByZWNsb2NraW5nIHdoaWxzdCB3
ZSBhcmUgYXNsZWVwLgotCSAqLwotCWdlbjZfZGlzYWJsZV9ycHNfaW50ZXJydXB0cyhkZXZfcHJp
dik7Ci0KLQltdXRleF9sb2NrKCZycHMtPmxvY2spOwotCWlmIChycHMtPmVuYWJsZWQpIHsKLQkJ
aWYgKElTX1ZBTExFWVZJRVcoZGV2X3ByaXYpIHx8IElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQot
CQkJdmx2X3NldF9ycHNfaWRsZShkZXZfcHJpdik7Ci0JCWVsc2UKLQkJCWdlbjZfc2V0X3Jwcyhk
ZXZfcHJpdiwgcnBzLT5pZGxlX2ZyZXEpOwotCQlycHMtPmxhc3RfYWRqID0gMDsKLQkJSTkxNV9X
UklURShHRU42X1BNSU5UUk1TSywKLQkJCSAgIGdlbjZfc2FuaXRpemVfcnBzX3BtX21hc2soZGV2
X3ByaXYsIH4wKSk7Ci0JfQotCW11dGV4X3VubG9jaygmcnBzLT5sb2NrKTsKLX0KLQotdm9pZCBn
ZW42X3Jwc19ib29zdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKLXsKLQlzdHJ1Y3QgaW50ZWxf
cnBzICpycHMgPSAmcnEtPmk5MTUtPmd0X3BtLnJwczsKLQl1bnNpZ25lZCBsb25nIGZsYWdzOwot
CWJvb2wgYm9vc3Q7Ci0KLQkvKiBUaGlzIGlzIGludGVudGlvbmFsbHkgcmFjeSEgV2UgcGVlayBh
dCB0aGUgc3RhdGUgaGVyZSwgdGhlbgotCSAqIHZhbGlkYXRlIGluc2lkZSB0aGUgUlBTIHdvcmtl
ci4KLQkgKi8KLQlpZiAoIXJwcy0+ZW5hYmxlZCkKLQkJcmV0dXJuOwotCi0JaWYgKGk5MTVfcmVx
dWVzdF9zaWduYWxlZChycSkpCi0JCXJldHVybjsKLQotCS8qIFNlcmlhbGl6ZXMgd2l0aCBpOTE1
X3JlcXVlc3RfcmV0aXJlKCkgKi8KLQlib29zdCA9IGZhbHNlOwotCXNwaW5fbG9ja19pcnFzYXZl
KCZycS0+bG9jaywgZmxhZ3MpOwotCWlmICghaTkxNV9yZXF1ZXN0X2hhc193YWl0Ym9vc3QocnEp
ICYmCi0JICAgICFkbWFfZmVuY2VfaXNfc2lnbmFsZWRfbG9ja2VkKCZycS0+ZmVuY2UpKSB7Ci0J
CWJvb3N0ID0gIWF0b21pY19mZXRjaF9pbmMoJnJwcy0+bnVtX3dhaXRlcnMpOwotCQlycS0+Zmxh
Z3MgfD0gSTkxNV9SRVFVRVNUX1dBSVRCT09TVDsKLQl9Ci0Jc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmcnEtPmxvY2ssIGZsYWdzKTsKLQlpZiAoIWJvb3N0KQotCQlyZXR1cm47Ci0KLQlpZiAoUkVB
RF9PTkNFKHJwcy0+Y3VyX2ZyZXEpIDwgcnBzLT5ib29zdF9mcmVxKQotCQlzY2hlZHVsZV93b3Jr
KCZycHMtPndvcmspOwotCi0JYXRvbWljX2luYygmcnBzLT5ib29zdHMpOwotfQotCi1pbnQgaW50
ZWxfc2V0X3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHZhbCkKLXsK
LQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKLQlpbnQgZXJy
OwotCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmcnBzLT5sb2NrKTsKLQlHRU1fQlVHX09OKHZhbCA+
IHJwcy0+bWF4X2ZyZXEpOwotCUdFTV9CVUdfT04odmFsIDwgcnBzLT5taW5fZnJlcSk7Ci0KLQlp
ZiAoIXJwcy0+ZW5hYmxlZCkgewotCQlycHMtPmN1cl9mcmVxID0gdmFsOwotCQlyZXR1cm4gMDsK
LQl9Ci0KLQlpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikgfHwgSVNfQ0hFUlJZVklFVyhkZXZf
cHJpdikpCi0JCWVyciA9IHZhbGxleXZpZXdfc2V0X3JwcyhkZXZfcHJpdiwgdmFsKTsKLQllbHNl
Ci0JCWVyciA9IGdlbjZfc2V0X3JwcyhkZXZfcHJpdiwgdmFsKTsKLQotCXJldHVybiBlcnI7Ci19
Ci0KLXN0YXRpYyB2b2lkIGdlbjlfZGlzYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQotewotCUk5MTVfV1JJVEUoR0VONl9SUF9DT05UUk9MLCAwKTsKLX0KLQotc3Rh
dGljIHZvaWQgZ2VuNl9kaXNhYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCi17Ci0JSTkxNV9XUklURShHRU42X1JQTlNXUkVRLCAxIDw8IDMxKTsKLQlJOTE1X1dSSVRF
KEdFTjZfUlBfQ09OVFJPTCwgMCk7Ci19Ci0KLXN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfZGlzYWJs
ZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCUk5MTVfV1JJVEUo
R0VONl9SUF9DT05UUk9MLCAwKTsKLX0KLQotc3RhdGljIHZvaWQgdmFsbGV5dmlld19kaXNhYmxl
X3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JSTkxNV9XUklURShH
RU42X1JQX0NPTlRST0wsIDApOwotfQotCi1zdGF0aWMgdm9pZCBnZW42X2luaXRfcnBzX2ZyZXF1
ZW5jaWVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlzdHJ1Y3QgaW50
ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKLQotCS8qIEFsbCBvZiB0aGVzZSB2
YWx1ZXMgYXJlIGluIHVuaXRzIG9mIDUwTUh6ICovCi0KLQkvKiBzdGF0aWMgdmFsdWVzIGZyb20g
SFc6IFJQMCA+IFJQMSA+IFJQbiAobWluX2ZyZXEpICovCi0JaWYgKElTX0dFTjlfTFAoZGV2X3By
aXYpKSB7Ci0JCXUzMiBycF9zdGF0ZV9jYXAgPSBJOTE1X1JFQUQoQlhUX1JQX1NUQVRFX0NBUCk7
Ci0JCXJwcy0+cnAwX2ZyZXEgPSAocnBfc3RhdGVfY2FwID4+IDE2KSAmIDB4ZmY7Ci0JCXJwcy0+
cnAxX2ZyZXEgPSAocnBfc3RhdGVfY2FwID4+ICA4KSAmIDB4ZmY7Ci0JCXJwcy0+bWluX2ZyZXEg
PSAocnBfc3RhdGVfY2FwID4+ICAwKSAmIDB4ZmY7Ci0JfSBlbHNlIHsKLQkJdTMyIHJwX3N0YXRl
X2NhcCA9IEk5MTVfUkVBRChHRU42X1JQX1NUQVRFX0NBUCk7Ci0JCXJwcy0+cnAwX2ZyZXEgPSAo
cnBfc3RhdGVfY2FwID4+ICAwKSAmIDB4ZmY7Ci0JCXJwcy0+cnAxX2ZyZXEgPSAocnBfc3RhdGVf
Y2FwID4+ICA4KSAmIDB4ZmY7Ci0JCXJwcy0+bWluX2ZyZXEgPSAocnBfc3RhdGVfY2FwID4+IDE2
KSAmIDB4ZmY7Ci0JfQotCS8qIGh3X21heCA9IFJQMCB1bnRpbCB3ZSBjaGVjayBmb3Igb3ZlcmNs
b2NraW5nICovCi0JcnBzLT5tYXhfZnJlcSA9IHJwcy0+cnAwX2ZyZXE7Ci0KLQlycHMtPmVmZmlj
aWVudF9mcmVxID0gcnBzLT5ycDFfZnJlcTsKLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwg
SVNfQlJPQURXRUxMKGRldl9wcml2KSB8fAotCSAgICBJU19HRU45X0JDKGRldl9wcml2KSB8fCBJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSB7Ci0JCXUzMiBkZGNjX3N0YXR1cyA9IDA7Ci0KLQkJ
aWYgKHNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoZGV2X3ByaXYsCi0JCQkJCSAgIEhTV19QQ09ERV9E
WU5BTUlDX0RVVFlfQ1lDTEVfQ09OVFJPTCwKLQkJCQkJICAgJmRkY2Nfc3RhdHVzLCBOVUxMKSA9
PSAwKQotCQkJcnBzLT5lZmZpY2llbnRfZnJlcSA9Ci0JCQkJY2xhbXBfdCh1OCwKLQkJCQkJKChk
ZGNjX3N0YXR1cyA+PiA4KSAmIDB4ZmYpLAotCQkJCQlycHMtPm1pbl9mcmVxLAotCQkJCQlycHMt
Pm1heF9mcmVxKTsKLQl9Ci0KLQlpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikgfHwgSU5URUxfR0VO
KGRldl9wcml2KSA+PSAxMCkgewotCQkvKiBTdG9yZSB0aGUgZnJlcXVlbmN5IHZhbHVlcyBpbiAx
Ni42NiBNSFogdW5pdHMsIHdoaWNoIGlzCi0JCSAqIHRoZSBuYXR1cmFsIGhhcmR3YXJlIHVuaXQg
Zm9yIFNLTAotCQkgKi8KLQkJcnBzLT5ycDBfZnJlcSAqPSBHRU45X0ZSRVFfU0NBTEVSOwotCQly
cHMtPnJwMV9mcmVxICo9IEdFTjlfRlJFUV9TQ0FMRVI7Ci0JCXJwcy0+bWluX2ZyZXEgKj0gR0VO
OV9GUkVRX1NDQUxFUjsKLQkJcnBzLT5tYXhfZnJlcSAqPSBHRU45X0ZSRVFfU0NBTEVSOwotCQly
cHMtPmVmZmljaWVudF9mcmVxICo9IEdFTjlfRlJFUV9TQ0FMRVI7Ci0JfQotfQotCi1zdGF0aWMg
dm9pZCByZXNldF9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkgICAg
ICBpbnQgKCpzZXQpKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICosIHU4KSkKLXsKLQlzdHJ1Y3Qg
aW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsKLQl1OCBmcmVxID0gcnBzLT5j
dXJfZnJlcTsKLQotCS8qIGZvcmNlIGEgcmVzZXQgKi8KLQlycHMtPnBvd2VyLm1vZGUgPSAtMTsK
LQlycHMtPmN1cl9mcmVxID0gLTE7Ci0KLQlpZiAoc2V0KGRldl9wcml2LCBmcmVxKSkKLQkJRFJN
X0VSUk9SKCJGYWlsZWQgdG8gcmVzZXQgUlBTIHRvIGluaXRpYWwgdmFsdWVzXG4iKTsKLX0KLQot
LyogU2VlIHRoZSBHZW45X0dUX1BNX1Byb2dyYW1taW5nX0d1aWRlIGRvYyBmb3IgdGhlIGJlbG93
ICovCi1zdGF0aWMgdm9pZCBnZW45X2VuYWJsZV9ycHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQotewotCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5j
b3JlLCBGT1JDRVdBS0VfQUxMKTsKLQotCS8qIFByb2dyYW0gZGVmYXVsdHMgYW5kIHRocmVzaG9s
ZHMgZm9yIFJQUyAqLwotCWlmIChJU19HRU4oZGV2X3ByaXYsIDkpKQotCQlJOTE1X1dSSVRFKEdF
TjZfUkNfVklERU9fRlJFUSwKLQkJCUdFTjlfRlJFUVVFTkNZKGRldl9wcml2LT5ndF9wbS5ycHMu
cnAxX2ZyZXEpKTsKLQotCS8qIDEgc2Vjb25kIHRpbWVvdXQqLwotCUk5MTVfV1JJVEUoR0VONl9S
UF9ET1dOX1RJTUVPVVQsCi0JCUdUX0lOVEVSVkFMX0ZST01fVVMoZGV2X3ByaXYsIDEwMDAwMDAp
KTsKLQotCUk5MTVfV1JJVEUoR0VONl9SUF9JRExFX0hZU1RFUlNJUywgMHhhKTsKLQotCS8qIExl
YW5pbmcgb24gdGhlIGJlbG93IGNhbGwgdG8gZ2VuNl9zZXRfcnBzIHRvIHByb2dyYW0vc2V0dXAg
dGhlCi0JICogVXAvRG93biBFSSAmIHRocmVzaG9sZCByZWdpc3RlcnMsIGFzIHdlbGwgYXMgdGhl
IFJQX0NPTlRST0wsCi0JICogUlBfSU5URVJSVVBUX0xJTUlUUyAmIFJQTlNXUkVRIHJlZ2lzdGVy
cyAqLwotCXJlc2V0X3JwcyhkZXZfcHJpdiwgZ2VuNl9zZXRfcnBzKTsKLQotCWludGVsX3VuY29y
ZV9mb3JjZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLX0KLQot
c3RhdGljIHZvaWQgZ2VuOF9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKLXsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsK
LQotCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdB
S0VfQUxMKTsKLQotCS8qIDEgUHJvZ3JhbSBkZWZhdWx0cyBhbmQgdGhyZXNob2xkcyBmb3IgUlBT
Ki8KLQlJOTE1X1dSSVRFKEdFTjZfUlBOU1dSRVEsCi0JCSAgIEhTV19GUkVRVUVOQ1kocnBzLT5y
cDFfZnJlcSkpOwotCUk5MTVfV1JJVEUoR0VONl9SQ19WSURFT19GUkVRLAotCQkgICBIU1dfRlJF
UVVFTkNZKHJwcy0+cnAxX2ZyZXEpKTsKLQkvKiBOQjogRG9jcyBzYXkgMXMsIGFuZCAxMDAwMDAw
IC0gd2hpY2ggYXJlbid0IGVxdWl2YWxlbnQgKi8KLQlJOTE1X1dSSVRFKEdFTjZfUlBfRE9XTl9U
SU1FT1VULCAxMDAwMDAwMDAgLyAxMjgpOyAvKiAxIHNlY29uZCB0aW1lb3V0ICovCi0KLQkvKiBE
b2NzIHJlY29tbWVuZCA5MDBNSHosIGFuZCAzMDAgTUh6IHJlc3BlY3RpdmVseSAqLwotCUk5MTVf
V1JJVEUoR0VONl9SUF9JTlRFUlJVUFRfTElNSVRTLAotCQkgICBycHMtPm1heF9mcmVxX3NvZnRs
aW1pdCA8PCAyNCB8Ci0JCSAgIHJwcy0+bWluX2ZyZXFfc29mdGxpbWl0IDw8IDE2KTsKLQotCUk5
MTVfV1JJVEUoR0VONl9SUF9VUF9USFJFU0hPTEQsIDc2MDAwMDAgLyAxMjgpOyAvKiA3Nm1zIGJ1
c3luZXNzIHBlciBFSSwgOTAlICovCi0JSTkxNV9XUklURShHRU42X1JQX0RPV05fVEhSRVNIT0xE
LCAzMTMwMDAwMCAvIDEyOCk7IC8qIDMxM21zIGJ1c3luZXNzIHBlciBFSSwgNzAlKi8KLQlJOTE1
X1dSSVRFKEdFTjZfUlBfVVBfRUksIDY2MDAwKTsgLyogODQuNDhtcywgWFhYOiByYW5kb20/ICov
Ci0JSTkxNV9XUklURShHRU42X1JQX0RPV05fRUksIDM1MDAwMCk7IC8qIDQ0OG1zLCBYWFg6IHJh
bmRvbT8gKi8KLQotCUk5MTVfV1JJVEUoR0VONl9SUF9JRExFX0hZU1RFUlNJUywgMTApOwotCi0J
LyogMjogRW5hYmxlIFJQUyAqLwotCUk5MTVfV1JJVEUoR0VONl9SUF9DT05UUk9MLAotCQkgICBH
RU42X1JQX01FRElBX1RVUkJPIHwKLQkJICAgR0VONl9SUF9NRURJQV9IV19OT1JNQUxfTU9ERSB8
Ci0JCSAgIEdFTjZfUlBfTUVESUFfSVNfR0ZYIHwKLQkJICAgR0VONl9SUF9FTkFCTEUgfAotCQkg
ICBHRU42X1JQX1VQX0JVU1lfQVZHIHwKLQkJICAgR0VONl9SUF9ET1dOX0lETEVfQVZHKTsKLQot
CXJlc2V0X3JwcyhkZXZfcHJpdiwgZ2VuNl9zZXRfcnBzKTsKLQotCWludGVsX3VuY29yZV9mb3Jj
ZXdha2VfcHV0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKLX0KLQotc3RhdGlj
IHZvaWQgZ2VuNl9lbmFibGVfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
LXsKLQkvKiBIZXJlIGJlZ2lucyBhIG1hZ2ljIHNlcXVlbmNlIG9mIHJlZ2lzdGVyIHdyaXRlcyB0
byBlbmFibGUKLQkgKiBhdXRvLWRvd25jbG9ja2luZy4KLQkgKgotCSAqIFBlcmhhcHMgdGhlcmUg
bWlnaHQgYmUgc29tZSB2YWx1ZSBpbiBleHBvc2luZyB0aGVzZSB0bwotCSAqIHVzZXJzcGFjZS4u
LgotCSAqLwotCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBG
T1JDRVdBS0VfQUxMKTsKLQotCS8qIFBvd2VyIGRvd24gaWYgY29tcGxldGVseSBpZGxlIGZvciBv
dmVyIDUwbXMgKi8KLQlJOTE1X1dSSVRFKEdFTjZfUlBfRE9XTl9USU1FT1VULCA1MDAwMCk7Ci0J
STkxNV9XUklURShHRU42X1JQX0lETEVfSFlTVEVSU0lTLCAxMCk7Ci0KLQlyZXNldF9ycHMoZGV2
X3ByaXYsIGdlbjZfc2V0X3Jwcyk7Ci0KLQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2
X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci19Ci0KLXN0YXRpYyBpbnQgY2hlcnJ5dmll
d19ycHNfbWF4X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXUz
MiB2YWwsIHJwMDsKLQotCXZhbCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBGQl9HRlhfRk1B
WF9BVF9WTUFYX0ZVU0UpOwotCi0Jc3dpdGNoIChSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1
LmV1X3RvdGFsKSB7Ci0JY2FzZSA4OgotCQkvKiAoMiAqIDQpIGNvbmZpZyAqLwotCQlycDAgPSAo
dmFsID4+IEZCX0dGWF9GTUFYX0FUX1ZNQVhfMlNTNEVVX0ZVU0VfU0hJRlQpOwotCQlicmVhazsK
LQljYXNlIDEyOgotCQkvKiAoMiAqIDYpIGNvbmZpZyAqLwotCQlycDAgPSAodmFsID4+IEZCX0dG
WF9GTUFYX0FUX1ZNQVhfMlNTNkVVX0ZVU0VfU0hJRlQpOwotCQlicmVhazsKLQljYXNlIDE2Ogot
CQkvKiAoMiAqIDgpIGNvbmZpZyAqLwotCWRlZmF1bHQ6Ci0JCS8qIFNldHRpbmcgKDIgKiA4KSBN
aW4gUlAwIGZvciBhbnkgb3RoZXIgY29tYmluYXRpb24gKi8KLQkJcnAwID0gKHZhbCA+PiBGQl9H
RlhfRk1BWF9BVF9WTUFYXzJTUzhFVV9GVVNFX1NISUZUKTsKLQkJYnJlYWs7Ci0JfQotCi0JcnAw
ID0gKHJwMCAmIEZCX0dGWF9GUkVRX0ZVU0VfTUFTSyk7Ci0KLQlyZXR1cm4gcnAwOwotfQotCi1z
dGF0aWMgaW50IGNoZXJyeXZpZXdfcnBzX3JwZV9mcmVxKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKLXsKLQl1MzIgdmFsLCBycGU7Ci0KLQl2YWwgPSB2bHZfcHVuaXRfcmVhZChk
ZXZfcHJpdiwgUFVOSVRfR1BVX0RVVFlDWUNMRV9SRUcpOwotCXJwZSA9ICh2YWwgPj4gUFVOSVRf
R1BVX0RVVFlDWUNMRV9SUEVfRlJFUV9TSElGVCkgJiBQVU5JVF9HUFVfRFVUWUNZQ0xFX1JQRV9G
UkVRX01BU0s7Ci0KLQlyZXR1cm4gcnBlOwotfQotCi1zdGF0aWMgaW50IGNoZXJyeXZpZXdfcnBz
X2d1YXJfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTMyIHZh
bCwgcnAxOwotCi0JdmFsID0gdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIEZCX0dGWF9GTUFYX0FU
X1ZNQVhfRlVTRSk7Ci0JcnAxID0gKHZhbCAmIEZCX0dGWF9GUkVRX0ZVU0VfTUFTSyk7Ci0KLQly
ZXR1cm4gcnAxOwotfQotCi1zdGF0aWMgdTMyIGNoZXJyeXZpZXdfcnBzX21pbl9mcmVxKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQl1MzIgdmFsLCBycG47Ci0KLQl2YWwg
PSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgRkJfR0ZYX0ZNSU5fQVRfVk1JTl9GVVNFKTsKLQly
cG4gPSAoKHZhbCA+PiBGQl9HRlhfRk1JTl9BVF9WTUlOX0ZVU0VfU0hJRlQpICYKLQkJICAgICAg
IEZCX0dGWF9GUkVRX0ZVU0VfTUFTSyk7Ci0KLQlyZXR1cm4gcnBuOwotfQotCi1zdGF0aWMgaW50
IHZhbGxleXZpZXdfcnBzX2d1YXJfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCi17Ci0JdTMyIHZhbCwgcnAxOwotCi0JdmFsID0gdmx2X25jX3JlYWQoZGV2X3ByaXYsIElP
U0ZfTkNfRkJfR0ZYX0ZSRVFfRlVTRSk7Ci0KLQlycDEgPSAodmFsICYgRkJfR0ZYX0ZHVUFSQU5U
RUVEX0ZSRVFfRlVTRV9NQVNLKSA+PiBGQl9HRlhfRkdVQVJBTlRFRURfRlJFUV9GVVNFX1NISUZU
OwotCi0JcmV0dXJuIHJwMTsKLX0KLQotc3RhdGljIGludCB2YWxsZXl2aWV3X3Jwc19tYXhfZnJl
cShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTMyIHZhbCwgcnAwOwot
Ci0JdmFsID0gdmx2X25jX3JlYWQoZGV2X3ByaXYsIElPU0ZfTkNfRkJfR0ZYX0ZSRVFfRlVTRSk7
Ci0KLQlycDAgPSAodmFsICYgRkJfR0ZYX01BWF9GUkVRX0ZVU0VfTUFTSykgPj4gRkJfR0ZYX01B
WF9GUkVRX0ZVU0VfU0hJRlQ7Ci0JLyogQ2xhbXAgdG8gbWF4ICovCi0JcnAwID0gbWluX3QodTMy
LCBycDAsIDB4ZWEpOwotCi0JcmV0dXJuIHJwMDsKLX0KLQotc3RhdGljIGludCB2YWxsZXl2aWV3
X3Jwc19ycGVfZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTMy
IHZhbCwgcnBlOwotCi0JdmFsID0gdmx2X25jX3JlYWQoZGV2X3ByaXYsIElPU0ZfTkNfRkJfR0ZY
X0ZNQVhfRlVTRV9MTyk7Ci0JcnBlID0gKHZhbCAmIEZCX0ZNQVhfVk1JTl9GUkVRX0xPX01BU0sp
ID4+IEZCX0ZNQVhfVk1JTl9GUkVRX0xPX1NISUZUOwotCXZhbCA9IHZsdl9uY19yZWFkKGRldl9w
cml2LCBJT1NGX05DX0ZCX0dGWF9GTUFYX0ZVU0VfSEkpOwotCXJwZSB8PSAodmFsICYgRkJfRk1B
WF9WTUlOX0ZSRVFfSElfTUFTSykgPDwgNTsKLQotCXJldHVybiBycGU7Ci19Ci0KLXN0YXRpYyBp
bnQgdmFsbGV5dmlld19ycHNfbWluX2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQotewotCXUzMiB2YWw7Ci0KLQl2YWwgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVO
SVRfUkVHX0dQVV9MRk0pICYgMHhmZjsKLQkvKgotCSAqIEFjY29yZGluZyB0byB0aGUgQllUIFB1
bml0IEdQVSB0dXJibyBIQVMgMS4xLjYuMyB0aGUgbWluaW11bSB2YWx1ZQotCSAqIGZvciB0aGUg
bWluaW11bSBmcmVxdWVuY3kgaW4gR1BMTCBtb2RlIGlzIDB4YzEuIENvbnRyYXJ5IHRvIHRoaXMg
b24KLQkgKiBhIEJZVC1NIEIwIHRoZSBhYm92ZSByZWdpc3RlciBjb250YWlucyAweGJmLiBNb3Jl
b3ZlciB3aGVuIHNldHRpbmcKLQkgKiBhIGZyZXF1ZW5jeSBQdW5pdCB3aWxsIG5vdCBhbGxvdyB2
YWx1ZXMgYmVsb3cgMHhjMC4gQ2xhbXAgaXQgMHhjMAotCSAqIHRvIG1ha2Ugc3VyZSBpdCBtYXRj
aGVzIHdoYXQgUHVuaXQgYWNjZXB0cy4KLQkgKi8KLQlyZXR1cm4gbWF4X3QodTMyLCB2YWwsIDB4
YzApOwotfQotCi1zdGF0aWMgdm9pZCB2bHZfaW5pdF9ncGxsX3JlZl9mcmVxKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlkZXZfcHJpdi0+Z3RfcG0ucnBzLmdwbGxfcmVm
X2ZyZXEgPQotCQl2bHZfZ2V0X2Nja19jbG9jayhkZXZfcHJpdiwgIkdQTEwgcmVmIiwKLQkJCQkg
IENDS19HUExMX0NMT0NLX0NPTlRST0wsCi0JCQkJICBkZXZfcHJpdi0+Y3pjbGtfZnJlcSk7Ci0K
LQlEUk1fREVCVUdfRFJJVkVSKCJHUExMIHJlZmVyZW5jZSBmcmVxOiAlZCBrSHpcbiIsCi0JCQkg
ZGV2X3ByaXYtPmd0X3BtLnJwcy5ncGxsX3JlZl9mcmVxKTsKLX0KLQotc3RhdGljIHZvaWQgdmFs
bGV5dmlld19pbml0X2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0J
dTMyIHZhbDsKLQotCXZsdl9pb3NmX3NiX2dldChkZXZfcHJpdiwKLQkJCUJJVChWTFZfSU9TRl9T
Ql9QVU5JVCkgfAotCQkJQklUKFZMVl9JT1NGX1NCX05DKSB8Ci0JCQlCSVQoVkxWX0lPU0ZfU0Jf
Q0NLKSk7Ci0KLQl2bHZfaW5pdF9ncGxsX3JlZl9mcmVxKGRldl9wcml2KTsKLQotCXZhbCA9IHZs
dl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfR1BVX0ZSRVFfU1RTKTsKLQlzd2l0Y2gg
KCh2YWwgPj4gNikgJiAzKSB7Ci0JY2FzZSAwOgotCWNhc2UgMToKLQkJZGV2X3ByaXYtPm1lbV9m
cmVxID0gODAwOwotCQlicmVhazsKLQljYXNlIDI6Ci0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDEw
NjY7Ci0JCWJyZWFrOwotCWNhc2UgMzoKLQkJZGV2X3ByaXYtPm1lbV9mcmVxID0gMTMzMzsKLQkJ
YnJlYWs7Ci0JfQotCURSTV9ERUJVR19EUklWRVIoIkREUiBzcGVlZDogJWQgTUh6XG4iLCBkZXZf
cHJpdi0+bWVtX2ZyZXEpOwotCi0JcnBzLT5tYXhfZnJlcSA9IHZhbGxleXZpZXdfcnBzX21heF9m
cmVxKGRldl9wcml2KTsKLQlycHMtPnJwMF9mcmVxID0gcnBzLT5tYXhfZnJlcTsKLQlEUk1fREVC
VUdfRFJJVkVSKCJtYXggR1BVIGZyZXE6ICVkIE1IeiAoJXUpXG4iLAotCQkJIGludGVsX2dwdV9m
cmVxKGRldl9wcml2LCBycHMtPm1heF9mcmVxKSwKLQkJCSBycHMtPm1heF9mcmVxKTsKLQotCXJw
cy0+ZWZmaWNpZW50X2ZyZXEgPSB2YWxsZXl2aWV3X3Jwc19ycGVfZnJlcShkZXZfcHJpdik7Ci0J
RFJNX0RFQlVHX0RSSVZFUigiUlBlIEdQVSBmcmVxOiAlZCBNSHogKCV1KVxuIiwKLQkJCSBpbnRl
bF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5lZmZpY2llbnRfZnJlcSksCi0JCQkgcnBzLT5lZmZp
Y2llbnRfZnJlcSk7Ci0KLQlycHMtPnJwMV9mcmVxID0gdmFsbGV5dmlld19ycHNfZ3Vhcl9mcmVx
KGRldl9wcml2KTsKLQlEUk1fREVCVUdfRFJJVkVSKCJSUDEoR3VhciBGcmVxKSBHUFUgZnJlcTog
JWQgTUh6ICgldSlcbiIsCi0JCQkgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+cnAxX2Zy
ZXEpLAotCQkJIHJwcy0+cnAxX2ZyZXEpOwotCi0JcnBzLT5taW5fZnJlcSA9IHZhbGxleXZpZXdf
cnBzX21pbl9mcmVxKGRldl9wcml2KTsKLQlEUk1fREVCVUdfRFJJVkVSKCJtaW4gR1BVIGZyZXE6
ICVkIE1IeiAoJXUpXG4iLAotCQkJIGludGVsX2dwdV9mcmVxKGRldl9wcml2LCBycHMtPm1pbl9m
cmVxKSwKLQkJCSBycHMtPm1pbl9mcmVxKTsKLQotCXZsdl9pb3NmX3NiX3B1dChkZXZfcHJpdiwK
LQkJCUJJVChWTFZfSU9TRl9TQl9QVU5JVCkgfAotCQkJQklUKFZMVl9JT1NGX1NCX05DKSB8Ci0J
CQlCSVQoVkxWX0lPU0ZfU0JfQ0NLKSk7Ci19Ci0KLXN0YXRpYyB2b2lkIGNoZXJyeXZpZXdfaW5p
dF9ndF9wb3dlcnNhdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0
cnVjdCBpbnRlbF9ycHMgKnJwcyA9ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwotCXUzMiB2YWw7Ci0K
LQl2bHZfaW9zZl9zYl9nZXQoZGV2X3ByaXYsCi0JCQlCSVQoVkxWX0lPU0ZfU0JfUFVOSVQpIHwK
LQkJCUJJVChWTFZfSU9TRl9TQl9OQykgfAotCQkJQklUKFZMVl9JT1NGX1NCX0NDSykpOwotCi0J
dmx2X2luaXRfZ3BsbF9yZWZfZnJlcShkZXZfcHJpdik7Ci0KLQl2YWwgPSB2bHZfY2NrX3JlYWQo
ZGV2X3ByaXYsIENDS19GVVNFX1JFRyk7Ci0KLQlzd2l0Y2ggKCh2YWwgPj4gMikgJiAweDcpIHsK
LQljYXNlIDM6Ci0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDIwMDA7Ci0JCWJyZWFrOwotCWRlZmF1
bHQ6Ci0JCWRldl9wcml2LT5tZW1fZnJlcSA9IDE2MDA7Ci0JCWJyZWFrOwotCX0KLQlEUk1fREVC
VUdfRFJJVkVSKCJERFIgc3BlZWQ6ICVkIE1IelxuIiwgZGV2X3ByaXYtPm1lbV9mcmVxKTsKLQot
CXJwcy0+bWF4X2ZyZXEgPSBjaGVycnl2aWV3X3Jwc19tYXhfZnJlcShkZXZfcHJpdik7Ci0JcnBz
LT5ycDBfZnJlcSA9IHJwcy0+bWF4X2ZyZXE7Ci0JRFJNX0RFQlVHX0RSSVZFUigibWF4IEdQVSBm
cmVxOiAlZCBNSHogKCV1KVxuIiwKLQkJCSBpbnRlbF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5t
YXhfZnJlcSksCi0JCQkgcnBzLT5tYXhfZnJlcSk7Ci0KLQlycHMtPmVmZmljaWVudF9mcmVxID0g
Y2hlcnJ5dmlld19ycHNfcnBlX2ZyZXEoZGV2X3ByaXYpOwotCURSTV9ERUJVR19EUklWRVIoIlJQ
ZSBHUFUgZnJlcTogJWQgTUh6ICgldSlcbiIsCi0JCQkgaW50ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYs
IHJwcy0+ZWZmaWNpZW50X2ZyZXEpLAotCQkJIHJwcy0+ZWZmaWNpZW50X2ZyZXEpOwotCi0JcnBz
LT5ycDFfZnJlcSA9IGNoZXJyeXZpZXdfcnBzX2d1YXJfZnJlcShkZXZfcHJpdik7Ci0JRFJNX0RF
QlVHX0RSSVZFUigiUlAxKEd1YXIpIEdQVSBmcmVxOiAlZCBNSHogKCV1KVxuIiwKLQkJCSBpbnRl
bF9ncHVfZnJlcShkZXZfcHJpdiwgcnBzLT5ycDFfZnJlcSksCi0JCQkgcnBzLT5ycDFfZnJlcSk7
Ci0KLQlycHMtPm1pbl9mcmVxID0gY2hlcnJ5dmlld19ycHNfbWluX2ZyZXEoZGV2X3ByaXYpOwot
CURSTV9ERUJVR19EUklWRVIoIm1pbiBHUFUgZnJlcTogJWQgTUh6ICgldSlcbiIsCi0JCQkgaW50
ZWxfZ3B1X2ZyZXEoZGV2X3ByaXYsIHJwcy0+bWluX2ZyZXEpLAotCQkJIHJwcy0+bWluX2ZyZXEp
OwotCi0Jdmx2X2lvc2Zfc2JfcHV0KGRldl9wcml2LAotCQkJQklUKFZMVl9JT1NGX1NCX1BVTklU
KSB8Ci0JCQlCSVQoVkxWX0lPU0ZfU0JfTkMpIHwKLQkJCUJJVChWTFZfSU9TRl9TQl9DQ0spKTsK
LQotCVdBUk5fT05DRSgocnBzLT5tYXhfZnJlcSB8IHJwcy0+ZWZmaWNpZW50X2ZyZXEgfCBycHMt
PnJwMV9mcmVxIHwKLQkJICAgcnBzLT5taW5fZnJlcSkgJiAxLAotCQkgICJPZGQgR1BVIGZyZXEg
dmFsdWVzXG4iKTsKLX0KLQotc3RhdGljIHZvaWQgY2hlcnJ5dmlld19lbmFibGVfcnBzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQl1MzIgdmFsOwotCi0JaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9nZXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotCi0J
LyogMTogUHJvZ3JhbSBkZWZhdWx0cyBhbmQgdGhyZXNob2xkcyBmb3IgUlBTKi8KLQlJOTE1X1dS
SVRFKEdFTjZfUlBfRE9XTl9USU1FT1VULCAxMDAwMDAwKTsKLQlJOTE1X1dSSVRFKEdFTjZfUlBf
VVBfVEhSRVNIT0xELCA1OTQwMCk7Ci0JSTkxNV9XUklURShHRU42X1JQX0RPV05fVEhSRVNIT0xE
LCAyNDUwMDApOwotCUk5MTVfV1JJVEUoR0VONl9SUF9VUF9FSSwgNjYwMDApOwotCUk5MTVfV1JJ
VEUoR0VONl9SUF9ET1dOX0VJLCAzNTAwMDApOwotCi0JSTkxNV9XUklURShHRU42X1JQX0lETEVf
SFlTVEVSU0lTLCAxMCk7Ci0KLQkvKiAyOiBFbmFibGUgUlBTICovCi0JSTkxNV9XUklURShHRU42
X1JQX0NPTlRST0wsCi0JCSAgIEdFTjZfUlBfTUVESUFfSFdfTk9STUFMX01PREUgfAotCQkgICBH
RU42X1JQX01FRElBX0lTX0dGWCB8Ci0JCSAgIEdFTjZfUlBfRU5BQkxFIHwKLQkJICAgR0VONl9S
UF9VUF9CVVNZX0FWRyB8Ci0JCSAgIEdFTjZfUlBfRE9XTl9JRExFX0FWRyk7Ci0KLQkvKiBTZXR0
aW5nIEZpeGVkIEJpYXMgKi8KLQl2bHZfcHVuaXRfZ2V0KGRldl9wcml2KTsKLQotCXZhbCA9IFZM
Vl9PVkVSUklERV9FTiB8IFZMVl9TT0NfVERQX0VOIHwgQ0hWX0JJQVNfQ1BVXzUwX1NPQ181MDsK
LQl2bHZfcHVuaXRfd3JpdGUoZGV2X3ByaXYsIFZMVl9UVVJCT19TT0NfT1ZFUlJJREUsIHZhbCk7
Ci0KLQl2YWwgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX0dQVV9GUkVRX1NU
Uyk7Ci0KLQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKLQotCS8qIFJQUyBjb2RlIGFzc3VtZXMg
R1BMTCBpcyB1c2VkICovCi0JV0FSTl9PTkNFKCh2YWwgJiBHUExMRU5BQkxFKSA9PSAwLCAiR1BM
TCBub3QgZW5hYmxlZFxuIik7Ci0KLQlEUk1fREVCVUdfRFJJVkVSKCJHUExMIGVuYWJsZWQ/ICVz
XG4iLCB5ZXNubyh2YWwgJiBHUExMRU5BQkxFKSk7Ci0JRFJNX0RFQlVHX0RSSVZFUigiR1BVIHN0
YXR1czogMHglMDh4XG4iLCB2YWwpOwotCi0JcmVzZXRfcnBzKGRldl9wcml2LCB2YWxsZXl2aWV3
X3NldF9ycHMpOwotCi0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNv
cmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCi1zdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2VuYWJsZV9y
cHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXUzMiB2YWw7Ci0KLQlp
bnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FM
TCk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUlBfRE9XTl9USU1FT1VULCAxMDAwMDAwKTsKLQlJOTE1
X1dSSVRFKEdFTjZfUlBfVVBfVEhSRVNIT0xELCA1OTQwMCk7Ci0JSTkxNV9XUklURShHRU42X1JQ
X0RPV05fVEhSRVNIT0xELCAyNDUwMDApOwotCUk5MTVfV1JJVEUoR0VONl9SUF9VUF9FSSwgNjYw
MDApOwotCUk5MTVfV1JJVEUoR0VONl9SUF9ET1dOX0VJLCAzNTAwMDApOwotCi0JSTkxNV9XUklU
RShHRU42X1JQX0lETEVfSFlTVEVSU0lTLCAxMCk7Ci0KLQlJOTE1X1dSSVRFKEdFTjZfUlBfQ09O
VFJPTCwKLQkJICAgR0VONl9SUF9NRURJQV9UVVJCTyB8Ci0JCSAgIEdFTjZfUlBfTUVESUFfSFdf
Tk9STUFMX01PREUgfAotCQkgICBHRU42X1JQX01FRElBX0lTX0dGWCB8Ci0JCSAgIEdFTjZfUlBf
RU5BQkxFIHwKLQkJICAgR0VONl9SUF9VUF9CVVNZX0FWRyB8Ci0JCSAgIEdFTjZfUlBfRE9XTl9J
RExFX0NPTlQpOwotCi0Jdmx2X3B1bml0X2dldChkZXZfcHJpdik7Ci0KLQkvKiBTZXR0aW5nIEZp
eGVkIEJpYXMgKi8KLQl2YWwgPSBWTFZfT1ZFUlJJREVfRU4gfCBWTFZfU09DX1REUF9FTiB8IFZM
Vl9CSUFTX0NQVV8xMjVfU09DXzg3NTsKLQl2bHZfcHVuaXRfd3JpdGUoZGV2X3ByaXYsIFZMVl9U
VVJCT19TT0NfT1ZFUlJJREUsIHZhbCk7Ci0KLQl2YWwgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJp
diwgUFVOSVRfUkVHX0dQVV9GUkVRX1NUUyk7Ci0KLQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsK
LQotCS8qIFJQUyBjb2RlIGFzc3VtZXMgR1BMTCBpcyB1c2VkICovCi0JV0FSTl9PTkNFKCh2YWwg
JiBHUExMRU5BQkxFKSA9PSAwLCAiR1BMTCBub3QgZW5hYmxlZFxuIik7Ci0KLQlEUk1fREVCVUdf
RFJJVkVSKCJHUExMIGVuYWJsZWQ/ICVzXG4iLCB5ZXNubyh2YWwgJiBHUExMRU5BQkxFKSk7Ci0J
RFJNX0RFQlVHX0RSSVZFUigiR1BVIHN0YXR1czogMHglMDh4XG4iLCB2YWwpOwotCi0JcmVzZXRf
cnBzKGRldl9wcml2LCB2YWxsZXl2aWV3X3NldF9ycHMpOwotCi0JaW50ZWxfdW5jb3JlX2ZvcmNl
d2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwotfQotCi1zdGF0aWMg
dW5zaWduZWQgbG9uZyBpbnRlbF9weGZyZXEodTMyIHZpZGZyZXEpCi17Ci0JdW5zaWduZWQgbG9u
ZyBmcmVxOwotCWludCBkaXYgPSAodmlkZnJlcSAmIDB4M2YwMDAwKSA+PiAxNjsKLQlpbnQgcG9z
dCA9ICh2aWRmcmVxICYgMHgzMDAwKSA+PiAxMjsKLQlpbnQgcHJlID0gKHZpZGZyZXEgJiAweDcp
OwotCi0JaWYgKCFwcmUpCi0JCXJldHVybiAwOwotCi0JZnJlcSA9ICgoZGl2ICogMTMzMzMzKSAv
ICgoMTw8cG9zdCkgKiBwcmUpKTsKLQotCXJldHVybiBmcmVxOwotfQotCi1zdGF0aWMgY29uc3Qg
c3RydWN0IGNwYXJhbXMgewotCXUxNiBpOwotCXUxNiB0OwotCXUxNiBtOwotCXUxNiBjOwotfSBj
cGFyYW1zW10gPSB7Ci0JeyAxLCAxMzMzLCAzMDEsIDI4NjY0IH0sCi0JeyAxLCAxMDY2LCAyOTQs
IDI0NDYwIH0sCi0JeyAxLCA4MDAsIDI5NCwgMjUxOTIgfSwKLQl7IDAsIDEzMzMsIDI3NiwgMjc2
MDUgfSwKLQl7IDAsIDEwNjYsIDI3NiwgMjc2MDUgfSwKLQl7IDAsIDgwMCwgMjMxLCAyMzc4NCB9
LAotfTsKLQotc3RhdGljIHVuc2lnbmVkIGxvbmcgX19pOTE1X2NoaXBzZXRfdmFsKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQl1NjQgdG90YWxfY291bnQsIGRpZmYsIHJl
dDsKLQl1MzIgY291bnQxLCBjb3VudDIsIGNvdW50MywgbSA9IDAsIGMgPSAwOwotCXVuc2lnbmVk
IGxvbmcgbm93ID0gamlmZmllc190b19tc2VjcyhqaWZmaWVzKSwgZGlmZjE7Ci0JaW50IGk7Ci0K
LQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZtY2hkZXZfbG9jayk7Ci0KLQlkaWZmMSA9IG5vdyAtIGRl
dl9wcml2LT5pcHMubGFzdF90aW1lMTsKLQotCS8qIFByZXZlbnQgZGl2aXNpb24tYnktemVybyBp
ZiB3ZSBhcmUgYXNraW5nIHRvbyBmYXN0LgotCSAqIEFsc28sIHdlIGRvbid0IGdldCBpbnRlcmVz
dGluZyByZXN1bHRzIGlmIHdlIGFyZSBwb2xsaW5nCi0JICogZmFzdGVyIHRoYW4gb25jZSBpbiAx
MG1zLCBzbyBqdXN0IHJldHVybiB0aGUgc2F2ZWQgdmFsdWUKLQkgKiBpbiBzdWNoIGNhc2VzLgot
CSAqLwotCWlmIChkaWZmMSA8PSAxMCkKLQkJcmV0dXJuIGRldl9wcml2LT5pcHMuY2hpcHNldF9w
b3dlcjsKLQotCWNvdW50MSA9IEk5MTVfUkVBRChETUlFQyk7Ci0JY291bnQyID0gSTkxNV9SRUFE
KEREUkVDKTsKLQljb3VudDMgPSBJOTE1X1JFQUQoQ1NJRUMpOwotCi0JdG90YWxfY291bnQgPSBj
b3VudDEgKyBjb3VudDIgKyBjb3VudDM7Ci0KLQkvKiBGSVhNRTogaGFuZGxlIHBlci1jb3VudGVy
IG92ZXJmbG93ICovCi0JaWYgKHRvdGFsX2NvdW50IDwgZGV2X3ByaXYtPmlwcy5sYXN0X2NvdW50
MSkgewotCQlkaWZmID0gfjBVTCAtIGRldl9wcml2LT5pcHMubGFzdF9jb3VudDE7Ci0JCWRpZmYg
Kz0gdG90YWxfY291bnQ7Ci0JfSBlbHNlIHsKLQkJZGlmZiA9IHRvdGFsX2NvdW50IC0gZGV2X3By
aXYtPmlwcy5sYXN0X2NvdW50MTsKLQl9Ci0KLQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShj
cGFyYW1zKTsgaSsrKSB7Ci0JCWlmIChjcGFyYW1zW2ldLmkgPT0gZGV2X3ByaXYtPmlwcy5jX20g
JiYKLQkJICAgIGNwYXJhbXNbaV0udCA9PSBkZXZfcHJpdi0+aXBzLnJfdCkgewotCQkJbSA9IGNw
YXJhbXNbaV0ubTsKLQkJCWMgPSBjcGFyYW1zW2ldLmM7Ci0JCQlicmVhazsKLQkJfQotCX0KLQot
CWRpZmYgPSBkaXZfdTY0KGRpZmYsIGRpZmYxKTsKLQlyZXQgPSAoKG0gKiBkaWZmKSArIGMpOwot
CXJldCA9IGRpdl91NjQocmV0LCAxMCk7Ci0KLQlkZXZfcHJpdi0+aXBzLmxhc3RfY291bnQxID0g
dG90YWxfY291bnQ7Ci0JZGV2X3ByaXYtPmlwcy5sYXN0X3RpbWUxID0gbm93OwotCi0JZGV2X3By
aXYtPmlwcy5jaGlwc2V0X3Bvd2VyID0gcmV0OwotCi0JcmV0dXJuIHJldDsKLX0KLQotdW5zaWdu
ZWQgbG9uZyBpOTE1X2NoaXBzZXRfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKLXsKLQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKLQl1bnNpZ25lZCBsb25nIHZhbCA9IDA7
Ci0KLQlpZiAoIUlTX0dFTihkZXZfcHJpdiwgNSkpCi0JCXJldHVybiAwOwotCi0Jd2l0aF9pbnRl
bF9ydW50aW1lX3BtKCZkZXZfcHJpdi0+cnVudGltZV9wbSwgd2FrZXJlZikgewotCQlzcGluX2xv
Y2tfaXJxKCZtY2hkZXZfbG9jayk7Ci0JCXZhbCA9IF9faTkxNV9jaGlwc2V0X3ZhbChkZXZfcHJp
dik7Ci0JCXNwaW5fdW5sb2NrX2lycSgmbWNoZGV2X2xvY2spOwotCX0KLQotCXJldHVybiB2YWw7
Ci19Ci0KLXVuc2lnbmVkIGxvbmcgaTkxNV9tY2hfdmFsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQotewotCXVuc2lnbmVkIGxvbmcgbSwgeCwgYjsKLQl1MzIgdHNmczsKLQotCXRzZnMg
PSBpbnRlbF91bmNvcmVfcmVhZCgmaTkxNS0+dW5jb3JlLCBUU0ZTKTsKLQotCW0gPSAoKHRzZnMg
JiBUU0ZTX1NMT1BFX01BU0spID4+IFRTRlNfU0xPUEVfU0hJRlQpOwotCXggPSBpbnRlbF91bmNv
cmVfcmVhZDgoJmk5MTUtPnVuY29yZSwgVFIxKTsKLQotCWIgPSB0c2ZzICYgVFNGU19JTlRSX01B
U0s7Ci0KLQlyZXR1cm4gKChtICogeCkgLyAxMjcpIC0gYjsKLX0KLQotc3RhdGljIGludCBfcHh2
aWRfdG9fdmQodTggcHh2aWQpCi17Ci0JaWYgKHB4dmlkID09IDApCi0JCXJldHVybiAwOwotCi0J
aWYgKHB4dmlkID49IDggJiYgcHh2aWQgPCAzMSkKLQkJcHh2aWQgPSAzMTsKLQotCXJldHVybiAo
cHh2aWQgKyAyKSAqIDEyNTsKLX0KLQotc3RhdGljIHUzMiBwdmlkX3RvX2V4dHZpZChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHU4IHB4dmlkKQotewotCWNvbnN0IGludCB2ZCA9
IF9weHZpZF90b192ZChweHZpZCk7Ci0JY29uc3QgaW50IHZtID0gdmQgLSAxMTI1OwotCi0JaWYg
KElOVEVMX0lORk8oZGV2X3ByaXYpLT5pc19tb2JpbGUpCi0JCXJldHVybiB2bSA+IDAgPyB2bSA6
IDA7Ci0KLQlyZXR1cm4gdmQ7Ci19Ci0KLXN0YXRpYyB2b2lkIF9faTkxNV91cGRhdGVfZ2Z4X3Zh
bChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTY0IG5vdywgZGlmZiwg
ZGlmZm1zOwotCXUzMiBjb3VudDsKLQotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJm1jaGRldl9sb2Nr
KTsKLQotCW5vdyA9IGt0aW1lX2dldF9yYXdfbnMoKTsKLQlkaWZmbXMgPSBub3cgLSBkZXZfcHJp
di0+aXBzLmxhc3RfdGltZTI7Ci0JZG9fZGl2KGRpZmZtcywgTlNFQ19QRVJfTVNFQyk7Ci0KLQkv
KiBEb24ndCBkaXZpZGUgYnkgMCAqLwotCWlmICghZGlmZm1zKQotCQlyZXR1cm47Ci0KLQljb3Vu
dCA9IEk5MTVfUkVBRChHRlhFQyk7Ci0KLQlpZiAoY291bnQgPCBkZXZfcHJpdi0+aXBzLmxhc3Rf
Y291bnQyKSB7Ci0JCWRpZmYgPSB+MFVMIC0gZGV2X3ByaXYtPmlwcy5sYXN0X2NvdW50MjsKLQkJ
ZGlmZiArPSBjb3VudDsKLQl9IGVsc2UgewotCQlkaWZmID0gY291bnQgLSBkZXZfcHJpdi0+aXBz
Lmxhc3RfY291bnQyOwotCX0KLQotCWRldl9wcml2LT5pcHMubGFzdF9jb3VudDIgPSBjb3VudDsK
LQlkZXZfcHJpdi0+aXBzLmxhc3RfdGltZTIgPSBub3c7Ci0KLQkvKiBNb3JlIG1hZ2ljIGNvbnN0
YW50cy4uLiAqLwotCWRpZmYgPSBkaWZmICogMTE4MTsKLQlkaWZmID0gZGl2X3U2NChkaWZmLCBk
aWZmbXMgKiAxMCk7Ci0JZGV2X3ByaXYtPmlwcy5nZnhfcG93ZXIgPSBkaWZmOwotfQotCi12b2lk
IGk5MTVfdXBkYXRlX2dmeF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQot
ewotCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCi0JaWYgKCFJU19HRU4oZGV2X3ByaXYsIDUp
KQotCQlyZXR1cm47Ci0KLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmRldl9wcml2LT5ydW50aW1l
X3BtLCB3YWtlcmVmKSB7Ci0JCXNwaW5fbG9ja19pcnEoJm1jaGRldl9sb2NrKTsKLQkJX19pOTE1
X3VwZGF0ZV9nZnhfdmFsKGRldl9wcml2KTsKLQkJc3Bpbl91bmxvY2tfaXJxKCZtY2hkZXZfbG9j
ayk7Ci0JfQotfQotCi1zdGF0aWMgdW5zaWduZWQgbG9uZyBfX2k5MTVfZ2Z4X3ZhbChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdW5zaWduZWQgbG9uZyB0LCBjb3JyLCBz
dGF0ZTEsIGNvcnIyLCBzdGF0ZTI7Ci0JdTMyIHB4dmlkLCBleHRfdjsKLQotCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJm1jaGRldl9sb2NrKTsKLQotCXB4dmlkID0gSTkxNV9SRUFEKFBYVkZSRVEoZGV2
X3ByaXYtPmd0X3BtLnJwcy5jdXJfZnJlcSkpOwotCXB4dmlkID0gKHB4dmlkID4+IDI0KSAmIDB4
N2Y7Ci0JZXh0X3YgPSBwdmlkX3RvX2V4dHZpZChkZXZfcHJpdiwgcHh2aWQpOwotCi0Jc3RhdGUx
ID0gZXh0X3Y7Ci0KLQl0ID0gaTkxNV9tY2hfdmFsKGRldl9wcml2KTsKLQotCS8qIFJldmVsIGlu
IHRoZSBlbXBpcmljYWxseSBkZXJpdmVkIGNvbnN0YW50cyAqLwotCi0JLyogQ29ycmVjdGlvbiBm
YWN0b3IgaW4gMS8xMDAwMDAgdW5pdHMgKi8KLQlpZiAodCA+IDgwKQotCQljb3JyID0gKCh0ICog
MjM0OSkgKyAxMzU5NDApOwotCWVsc2UgaWYgKHQgPj0gNTApCi0JCWNvcnIgPSAoKHQgKiA5NjQp
ICsgMjkzMTcpOwotCWVsc2UgLyogPCA1MCAqLwotCQljb3JyID0gKCh0ICogMzAxKSArIDEwMDQp
OwotCi0JY29yciA9IGNvcnIgKiAoKDE1MDE0MiAqIHN0YXRlMSkgLyAxMDAwMCAtIDc4NjQyKTsK
LQljb3JyIC89IDEwMDAwMDsKLQljb3JyMiA9IChjb3JyICogZGV2X3ByaXYtPmlwcy5jb3JyKTsK
LQotCXN0YXRlMiA9IChjb3JyMiAqIHN0YXRlMSkgLyAxMDAwMDsKLQlzdGF0ZTIgLz0gMTAwOyAv
KiBjb252ZXJ0IHRvIG1XICovCi0KLQlfX2k5MTVfdXBkYXRlX2dmeF92YWwoZGV2X3ByaXYpOwot
Ci0JcmV0dXJuIGRldl9wcml2LT5pcHMuZ2Z4X3Bvd2VyICsgc3RhdGUyOwotfQotCi11bnNpZ25l
ZCBsb25nIGk5MTVfZ2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17
Ci0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Ci0JdW5zaWduZWQgbG9uZyB2YWwgPSAwOwotCi0J
aWYgKCFJU19HRU4oZGV2X3ByaXYsIDUpKQotCQlyZXR1cm4gMDsKLQotCXdpdGhfaW50ZWxfcnVu
dGltZV9wbSgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpIHsKLQkJc3Bpbl9sb2NrX2ly
cSgmbWNoZGV2X2xvY2spOwotCQl2YWwgPSBfX2k5MTVfZ2Z4X3ZhbChkZXZfcHJpdik7Ci0JCXNw
aW5fdW5sb2NrX2lycSgmbWNoZGV2X2xvY2spOwotCX0KLQotCXJldHVybiB2YWw7Ci19Ci0KLXN0
YXRpYyBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSBfX3JjdSAqaTkxNV9tY2hfZGV2OwotCi1zdGF0
aWMgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKm1jaGRldl9nZXQodm9pZCkKLXsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKLQotCXJjdV9yZWFkX2xvY2soKTsKLQlpOTE1ID0gcmN1
X2RlcmVmZXJlbmNlKGk5MTVfbWNoX2Rldik7Ci0JaWYgKCFrcmVmX2dldF91bmxlc3NfemVybygm
aTkxNS0+ZHJtLnJlZikpCi0JCWk5MTUgPSBOVUxMOwotCXJjdV9yZWFkX3VubG9jaygpOwotCi0J
cmV0dXJuIGk5MTU7Ci19Ci0KLS8qKgotICogaTkxNV9yZWFkX21jaF92YWwgLSByZXR1cm4gdmFs
dWUgZm9yIElQUyB1c2UKLSAqCi0gKiBDYWxjdWxhdGUgYW5kIHJldHVybiBhIHZhbHVlIGZvciB0
aGUgSVBTIGRyaXZlciB0byB1c2Ugd2hlbiBkZWNpZGluZyB3aGV0aGVyCi0gKiB3ZSBoYXZlIHRo
ZXJtYWwgYW5kIHBvd2VyIGhlYWRyb29tIHRvIGluY3JlYXNlIENQVSBvciBHUFUgcG93ZXIgYnVk
Z2V0LgotICovCi11bnNpZ25lZCBsb25nIGk5MTVfcmVhZF9tY2hfdmFsKHZvaWQpCi17Ci0Jc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7Ci0JdW5zaWduZWQgbG9uZyBjaGlwc2V0X3ZhbCA9
IDA7Ci0JdW5zaWduZWQgbG9uZyBncmFwaGljc192YWwgPSAwOwotCWludGVsX3dha2VyZWZfdCB3
YWtlcmVmOwotCi0JaTkxNSA9IG1jaGRldl9nZXQoKTsKLQlpZiAoIWk5MTUpCi0JCXJldHVybiAw
OwotCi0Jd2l0aF9pbnRlbF9ydW50aW1lX3BtKCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKSB7
Ci0JCXNwaW5fbG9ja19pcnEoJm1jaGRldl9sb2NrKTsKLQkJY2hpcHNldF92YWwgPSBfX2k5MTVf
Y2hpcHNldF92YWwoaTkxNSk7Ci0JCWdyYXBoaWNzX3ZhbCA9IF9faTkxNV9nZnhfdmFsKGk5MTUp
OwotCQlzcGluX3VubG9ja19pcnEoJm1jaGRldl9sb2NrKTsKLQl9Ci0KLQlkcm1fZGV2X3B1dCgm
aTkxNS0+ZHJtKTsKLQlyZXR1cm4gY2hpcHNldF92YWwgKyBncmFwaGljc192YWw7Ci19Ci1FWFBP
UlRfU1lNQk9MX0dQTChpOTE1X3JlYWRfbWNoX3ZhbCk7Ci0KLS8qKgotICogaTkxNV9ncHVfcmFp
c2UgLSByYWlzZSBHUFUgZnJlcXVlbmN5IGxpbWl0Ci0gKgotICogUmFpc2UgdGhlIGxpbWl0OyBJ
UFMgaW5kaWNhdGVzIHdlIGhhdmUgdGhlcm1hbCBoZWFkcm9vbS4KLSAqLwotYm9vbCBpOTE1X2dw
dV9yYWlzZSh2b2lkKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1OwotCi0JaTkx
NSA9IG1jaGRldl9nZXQoKTsKLQlpZiAoIWk5MTUpCi0JCXJldHVybiBmYWxzZTsKLQotCXNwaW5f
bG9ja19pcnEoJm1jaGRldl9sb2NrKTsKLQlpZiAoaTkxNS0+aXBzLm1heF9kZWxheSA+IGk5MTUt
Pmlwcy5mbWF4KQotCQlpOTE1LT5pcHMubWF4X2RlbGF5LS07Ci0Jc3Bpbl91bmxvY2tfaXJxKCZt
Y2hkZXZfbG9jayk7Ci0KLQlkcm1fZGV2X3B1dCgmaTkxNS0+ZHJtKTsKLQlyZXR1cm4gdHJ1ZTsK
LX0KLUVYUE9SVF9TWU1CT0xfR1BMKGk5MTVfZ3B1X3JhaXNlKTsKLQotLyoqCi0gKiBpOTE1X2dw
dV9sb3dlciAtIGxvd2VyIEdQVSBmcmVxdWVuY3kgbGltaXQKLSAqCi0gKiBJUFMgaW5kaWNhdGVz
IHdlJ3JlIGNsb3NlIHRvIGEgdGhlcm1hbCBsaW1pdCwgc28gdGhyb3R0bGUgYmFjayB0aGUgR1BV
Ci0gKiBmcmVxdWVuY3kgbWF4aW11bS4KLSAqLwotYm9vbCBpOTE1X2dwdV9sb3dlcih2b2lkKQot
ewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1OwotCi0JaTkxNSA9IG1jaGRldl9nZXQo
KTsKLQlpZiAoIWk5MTUpCi0JCXJldHVybiBmYWxzZTsKLQotCXNwaW5fbG9ja19pcnEoJm1jaGRl
dl9sb2NrKTsKLQlpZiAoaTkxNS0+aXBzLm1heF9kZWxheSA8IGk5MTUtPmlwcy5taW5fZGVsYXkp
Ci0JCWk5MTUtPmlwcy5tYXhfZGVsYXkrKzsKLQlzcGluX3VubG9ja19pcnEoJm1jaGRldl9sb2Nr
KTsKLQotCWRybV9kZXZfcHV0KCZpOTE1LT5kcm0pOwotCXJldHVybiB0cnVlOwotfQotRVhQT1JU
X1NZTUJPTF9HUEwoaTkxNV9ncHVfbG93ZXIpOwotCi0vKioKLSAqIGk5MTVfZ3B1X2J1c3kgLSBp
bmRpY2F0ZSBHUFUgYnVzaW5lc3MgdG8gSVBTCi0gKgotICogVGVsbCB0aGUgSVBTIGRyaXZlciB3
aGV0aGVyIG9yIG5vdCB0aGUgR1BVIGlzIGJ1c3kuCi0gKi8KLWJvb2wgaTkxNV9ncHVfYnVzeSh2
b2lkKQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1OwotCWJvb2wgcmV0OwotCi0J
aTkxNSA9IG1jaGRldl9nZXQoKTsKLQlpZiAoIWk5MTUpCi0JCXJldHVybiBmYWxzZTsKLQotCXJl
dCA9IGk5MTUtPmd0LmF3YWtlOwotCi0JZHJtX2Rldl9wdXQoJmk5MTUtPmRybSk7Ci0JcmV0dXJu
IHJldDsKLX0KLUVYUE9SVF9TWU1CT0xfR1BMKGk5MTVfZ3B1X2J1c3kpOwotCi0vKioKLSAqIGk5
MTVfZ3B1X3R1cmJvX2Rpc2FibGUgLSBkaXNhYmxlIGdyYXBoaWNzIHR1cmJvCi0gKgotICogRGlz
YWJsZSBncmFwaGljcyB0dXJibyBieSByZXNldHRpbmcgdGhlIG1heCBmcmVxdWVuY3kgYW5kIHNl
dHRpbmcgdGhlCi0gKiBjdXJyZW50IGZyZXF1ZW5jeSB0byB0aGUgZGVmYXVsdC4KLSAqLwotYm9v
bCBpOTE1X2dwdV90dXJib19kaXNhYmxlKHZvaWQpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTU7Ci0JYm9vbCByZXQ7Ci0KLQlpOTE1ID0gbWNoZGV2X2dldCgpOwotCWlmICghaTkx
NSkKLQkJcmV0dXJuIGZhbHNlOwotCi0Jc3Bpbl9sb2NrX2lycSgmbWNoZGV2X2xvY2spOwotCWk5
MTUtPmlwcy5tYXhfZGVsYXkgPSBpOTE1LT5pcHMuZnN0YXJ0OwotCXJldCA9IGlyb25sYWtlX3Nl
dF9kcnBzKGk5MTUsIGk5MTUtPmlwcy5mc3RhcnQpOwotCXNwaW5fdW5sb2NrX2lycSgmbWNoZGV2
X2xvY2spOwotCi0JZHJtX2Rldl9wdXQoJmk5MTUtPmRybSk7Ci0JcmV0dXJuIHJldDsKLX0KLUVY
UE9SVF9TWU1CT0xfR1BMKGk5MTVfZ3B1X3R1cmJvX2Rpc2FibGUpOwotCi0vKioKLSAqIFRlbGxz
IHRoZSBpbnRlbF9pcHMgZHJpdmVyIHRoYXQgdGhlIGk5MTUgZHJpdmVyIGlzIG5vdyBsb2FkZWQs
IGlmCi0gKiBJUFMgZ290IGxvYWRlZCBmaXJzdC4KLSAqCi0gKiBUaGlzIGF3a3dhcmQgZGFuY2Ug
aXMgc28gdGhhdCBuZWl0aGVyIG1vZHVsZSBoYXMgdG8gZGVwZW5kIG9uIHRoZQotICogb3RoZXIg
aW4gb3JkZXIgZm9yIElQUyB0byBkbyB0aGUgYXBwcm9wcmlhdGUgY29tbXVuaWNhdGlvbiBvZgot
ICogR1BVIHR1cmJvIGxpbWl0cyB0byBpOTE1LgotICovCi1zdGF0aWMgdm9pZAotaXBzX3Bpbmdf
Zm9yX2k5MTVfbG9hZCh2b2lkKQotewotCXZvaWQgKCpsaW5rKSh2b2lkKTsKLQotCWxpbmsgPSBz
eW1ib2xfZ2V0KGlwc19saW5rX3RvX2k5MTVfZHJpdmVyKTsKLQlpZiAobGluaykgewotCQlsaW5r
KCk7Ci0JCXN5bWJvbF9wdXQoaXBzX2xpbmtfdG9faTkxNV9kcml2ZXIpOwotCX0KLX0KLQotdm9p
ZCBpbnRlbF9ncHVfaXBzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQot
ewotCS8qIFdlIG9ubHkgcmVnaXN0ZXIgdGhlIGk5MTUgaXBzIHBhcnQgd2l0aCBpbnRlbC1pcHMg
b25jZSBldmVyeXRoaW5nIGlzCi0JICogc2V0IHVwLCB0byBhdm9pZCBpbnRlbC1pcHMgc25lYWtp
bmcgaW4gYW5kIHJlYWRpbmcgYm9ndXMgdmFsdWVzLiAqLwotCXJjdV9hc3NpZ25fcG9pbnRlcihp
OTE1X21jaF9kZXYsIGRldl9wcml2KTsKLQotCWlwc19waW5nX2Zvcl9pOTE1X2xvYWQoKTsKLX0K
LQotdm9pZCBpbnRlbF9ncHVfaXBzX3RlYXJkb3duKHZvaWQpCi17Ci0JcmN1X2Fzc2lnbl9wb2lu
dGVyKGk5MTVfbWNoX2RldiwgTlVMTCk7Ci19Ci0KLXN0YXRpYyB2b2lkIGludGVsX2luaXRfZW1v
bihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTMyIGxjZnVzZTsKLQl1
OCBweHdbMTZdOwotCWludCBpOwotCi0JLyogRGlzYWJsZSB0byBwcm9ncmFtICovCi0JSTkxNV9X
UklURShFQ1IsIDApOwotCVBPU1RJTkdfUkVBRChFQ1IpOwotCi0JLyogUHJvZ3JhbSBlbmVyZ3kg
d2VpZ2h0cyBmb3IgdmFyaW91cyBldmVudHMgKi8KLQlJOTE1X1dSSVRFKFNERVcsIDB4MTUwNDBk
MDApOwotCUk5MTVfV1JJVEUoQ1NJRVcwLCAweDAwN2YwMDAwKTsKLQlJOTE1X1dSSVRFKENTSUVX
MSwgMHgxZTIyMDAwNCk7Ci0JSTkxNV9XUklURShDU0lFVzIsIDB4MDQwMDAwMDQpOwotCi0JZm9y
IChpID0gMDsgaSA8IDU7IGkrKykKLQkJSTkxNV9XUklURShQRVcoaSksIDApOwotCWZvciAoaSA9
IDA7IGkgPCAzOyBpKyspCi0JCUk5MTVfV1JJVEUoREVXKGkpLCAwKTsKLQotCS8qIFByb2dyYW0g
UC1zdGF0ZSB3ZWlnaHRzIHRvIGFjY291bnQgZm9yIGZyZXF1ZW5jeSBwb3dlciBhZGp1c3RtZW50
ICovCi0JZm9yIChpID0gMDsgaSA8IDE2OyBpKyspIHsKLQkJdTMyIHB4dmlkZnJlcSA9IEk5MTVf
UkVBRChQWFZGUkVRKGkpKTsKLQkJdW5zaWduZWQgbG9uZyBmcmVxID0gaW50ZWxfcHhmcmVxKHB4
dmlkZnJlcSk7Ci0JCXVuc2lnbmVkIGxvbmcgdmlkID0gKHB4dmlkZnJlcSAmIFBYVkZSRVFfUFhf
TUFTSykgPj4KLQkJCVBYVkZSRVFfUFhfU0hJRlQ7Ci0JCXVuc2lnbmVkIGxvbmcgdmFsOwotCi0J
CXZhbCA9IHZpZCAqIHZpZDsKLQkJdmFsICo9IChmcmVxIC8gMTAwMCk7Ci0JCXZhbCAqPSAyNTU7
Ci0JCXZhbCAvPSAoMTI3KjEyNyo5MDApOwotCQlpZiAodmFsID4gMHhmZikKLQkJCURSTV9FUlJP
UigiYmFkIHB4dmFsOiAlbGRcbiIsIHZhbCk7Ci0JCXB4d1tpXSA9IHZhbDsKLQl9Ci0JLyogUmVu
ZGVyIHN0YW5kYnkgc3RhdGVzIGdldCAwIHdlaWdodCAqLwotCXB4d1sxNF0gPSAwOwotCXB4d1sx
NV0gPSAwOwotCi0JZm9yIChpID0gMDsgaSA8IDQ7IGkrKykgewotCQl1MzIgdmFsID0gKHB4d1tp
KjRdIDw8IDI0KSB8IChweHdbKGkqNCkrMV0gPDwgMTYpIHwKLQkJCShweHdbKGkqNCkrMl0gPDwg
OCkgfCAocHh3WyhpKjQpKzNdKTsKLQkJSTkxNV9XUklURShQWFcoaSksIHZhbCk7Ci0JfQotCi0J
LyogQWRqdXN0IG1hZ2ljIHJlZ3MgdG8gbWFnaWMgdmFsdWVzIChtb3JlIGV4cGVyaW1lbnRhbCBy
ZXN1bHRzKSAqLwotCUk5MTVfV1JJVEUoT0dXMCwgMCk7Ci0JSTkxNV9XUklURShPR1cxLCAwKTsK
LQlJOTE1X1dSSVRFKEVHMCwgMHgwMDAwN2YwMCk7Ci0JSTkxNV9XUklURShFRzEsIDB4MDAwMDAw
MGUpOwotCUk5MTVfV1JJVEUoRUcyLCAweDAwMGUwMDAwKTsKLQlJOTE1X1dSSVRFKEVHMywgMHg2
ODAwMDMwMCk7Ci0JSTkxNV9XUklURShFRzQsIDB4NDIwMDAwMDApOwotCUk5MTVfV1JJVEUoRUc1
LCAweDAwMTQwMDMxKTsKLQlJOTE1X1dSSVRFKEVHNiwgMCk7Ci0JSTkxNV9XUklURShFRzcsIDAp
OwotCi0JZm9yIChpID0gMDsgaSA8IDg7IGkrKykKLQkJSTkxNV9XUklURShQWFdMKGkpLCAwKTsK
LQotCS8qIEVuYWJsZSBQTU9OICsgc2VsZWN0IGV2ZW50cyAqLwotCUk5MTVfV1JJVEUoRUNSLCAw
eDgwMDAwMDE5KTsKLQotCWxjZnVzZSA9IEk5MTVfUkVBRChMQ0ZVU0UwMik7Ci0KLQlkZXZfcHJp
di0+aXBzLmNvcnIgPSAobGNmdXNlICYgTENGVVNFX0hJVl9NQVNLKTsKLX0KLQotdm9pZCBpbnRl
bF9pbml0X2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17
Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5ycHM7Ci0KLQkvKiBQ
b3dlcnNhdmluZyBpcyBjb250cm9sbGVkIGJ5IHRoZSBob3N0IHdoZW4gaW5zaWRlIGEgVk0gKi8K
LQlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoZGV2X3ByaXYpKQotCQlta3dyaXRlX2RldmljZV9pbmZv
KGRldl9wcml2KS0+aGFzX3JwcyA9IGZhbHNlOwotCi0JLyogSW5pdGlhbGl6ZSBSUFMgbGltaXRz
IChmb3IgdXNlcnNwYWNlKSAqLwotCWlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkKLQkJY2hl
cnJ5dmlld19pbml0X2d0X3Bvd2Vyc2F2ZShkZXZfcHJpdik7Ci0JZWxzZSBpZiAoSVNfVkFMTEVZ
VklFVyhkZXZfcHJpdikpCi0JCXZhbGxleXZpZXdfaW5pdF9ndF9wb3dlcnNhdmUoZGV2X3ByaXYp
OwotCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikKLQkJZ2VuNl9pbml0X3Jwc19m
cmVxdWVuY2llcyhkZXZfcHJpdik7Ci0KLQkvKiBEZXJpdmUgaW5pdGlhbCB1c2VyIHByZWZlcmVu
Y2VzL2xpbWl0cyBmcm9tIHRoZSBoYXJkd2FyZSBsaW1pdHMgKi8KLQlycHMtPm1heF9mcmVxX3Nv
ZnRsaW1pdCA9IHJwcy0+bWF4X2ZyZXE7Ci0JcnBzLT5taW5fZnJlcV9zb2Z0bGltaXQgPSBycHMt
Pm1pbl9mcmVxOwotCi0JLyogQWZ0ZXIgc2V0dGluZyBtYXgtc29mdGxpbWl0LCBmaW5kIHRoZSBv
dmVyY2xvY2sgbWF4IGZyZXEgKi8KLQlpZiAoSVNfR0VOKGRldl9wcml2LCA2KSB8fAotCSAgICBJ
U19JVllCUklER0UoZGV2X3ByaXYpIHx8IElTX0hBU1dFTEwoZGV2X3ByaXYpKSB7Ci0JCXUzMiBw
YXJhbXMgPSAwOwotCi0JCXNhbmR5YnJpZGdlX3Bjb2RlX3JlYWQoZGV2X3ByaXYsIEdFTjZfUkVB
RF9PQ19QQVJBTVMsCi0JCQkJICAgICAgICZwYXJhbXMsIE5VTEwpOwotCQlpZiAocGFyYW1zICYg
QklUKDMxKSkgeyAvKiBPQyBzdXBwb3J0ZWQgKi8KLQkJCURSTV9ERUJVR19EUklWRVIoIk92ZXJj
bG9ja2luZyBzdXBwb3J0ZWQsIG1heDogJWRNSHosIG92ZXJjbG9jazogJWRNSHpcbiIsCi0JCQkJ
CSAocnBzLT5tYXhfZnJlcSAmIDB4ZmYpICogNTAsCi0JCQkJCSAocGFyYW1zICYgMHhmZikgKiA1
MCk7Ci0JCQlycHMtPm1heF9mcmVxID0gcGFyYW1zICYgMHhmZjsKLQkJfQotCX0KLQotCS8qIEZp
bmFsbHkgYWxsb3cgdXMgdG8gYm9vc3QgdG8gbWF4IGJ5IGRlZmF1bHQgKi8KLQlycHMtPmJvb3N0
X2ZyZXEgPSBycHMtPm1heF9mcmVxOwotCXJwcy0+aWRsZV9mcmVxID0gcnBzLT5taW5fZnJlcTsK
LQlycHMtPmN1cl9mcmVxID0gcnBzLT5pZGxlX2ZyZXE7Ci19Ci0KLXZvaWQgaW50ZWxfc2FuaXRp
emVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlk
ZXZfcHJpdi0+Z3RfcG0ucnBzLmVuYWJsZWQgPSB0cnVlOyAvKiBmb3JjZSBSUFMgZGlzYWJsaW5n
ICovCi0JaW50ZWxfZGlzYWJsZV9ndF9wb3dlcnNhdmUoZGV2X3ByaXYpOwotCi0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gMTEpCi0JCWdlbjExX3Jlc2V0X3Jwc19pbnRlcnJ1cHRzKGRldl9w
cml2KTsKLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpCi0JCWdlbjZfcmVzZXRf
cnBzX2ludGVycnVwdHMoZGV2X3ByaXYpOwotfQotCi1zdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxl
X3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JbG9ja2RlcF9hc3Nl
cnRfaGVsZCgmZGV2X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKLQotCWlmICghZGV2X3ByaXYtPmd0
X3BtLnJwcy5lbmFibGVkKQotCQlyZXR1cm47Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+
PSA5KQotCQlnZW45X2Rpc2FibGVfcnBzKGRldl9wcml2KTsKLQllbHNlIGlmIChJU19DSEVSUllW
SUVXKGRldl9wcml2KSkKLQkJY2hlcnJ5dmlld19kaXNhYmxlX3JwcyhkZXZfcHJpdik7Ci0JZWxz
ZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpCi0JCXZhbGxleXZpZXdfZGlzYWJsZV9ycHMo
ZGV2X3ByaXYpOwotCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNikKLQkJZ2VuNl9k
aXNhYmxlX3JwcyhkZXZfcHJpdik7Ci0JZWxzZSBpZiAoSVNfSVJPTkxBS0VfTShkZXZfcHJpdikp
Ci0JCWlyb25sYWtlX2Rpc2FibGVfZHJwcyhkZXZfcHJpdik7Ci0KLQlkZXZfcHJpdi0+Z3RfcG0u
cnBzLmVuYWJsZWQgPSBmYWxzZTsKLX0KLQotdm9pZCBpbnRlbF9kaXNhYmxlX2d0X3Bvd2Vyc2F2
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JbXV0ZXhfbG9jaygmZGV2
X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKLQotCWludGVsX2Rpc2FibGVfcnBzKGRldl9wcml2KTsK
LQlpZiAoSEFTX0xMQyhkZXZfcHJpdikpCi0JCWludGVsX2xsY19kaXNhYmxlKCZkZXZfcHJpdi0+
Z3QubGxjKTsKLQotCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKLX0K
LQotc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX3JwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9wcml2LT5ndF9wbS5y
cHM7Ci0KLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZycHMtPmxvY2spOwotCi0JaWYgKHJwcy0+ZW5h
YmxlZCkKLQkJcmV0dXJuOwotCi0JaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7Ci0JCWNo
ZXJyeXZpZXdfZW5hYmxlX3JwcyhkZXZfcHJpdik7Ci0JfSBlbHNlIGlmIChJU19WQUxMRVlWSUVX
KGRldl9wcml2KSkgewotCQl2YWxsZXl2aWV3X2VuYWJsZV9ycHMoZGV2X3ByaXYpOwotCX0gZWxz
ZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA5KSB7Ci0JCWdlbjlfZW5hYmxlX3JwcyhkZXZf
cHJpdik7Ci0JfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Ci0JCWdlbjhfZW5h
YmxlX3JwcyhkZXZfcHJpdik7Ci0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYp
IHsKLQkJZ2VuNl9lbmFibGVfcnBzKGRldl9wcml2KTsKLQl9IGVsc2UgaWYgKElTX0lST05MQUtF
X00oZGV2X3ByaXYpKSB7Ci0JCWlyb25sYWtlX2VuYWJsZV9kcnBzKGRldl9wcml2KTsKLQkJaW50
ZWxfaW5pdF9lbW9uKGRldl9wcml2KTsKLQl9Ci0KLQlXQVJOX09OKHJwcy0+bWF4X2ZyZXEgPCBy
cHMtPm1pbl9mcmVxKTsKLQlXQVJOX09OKHJwcy0+aWRsZV9mcmVxID4gcnBzLT5tYXhfZnJlcSk7
Ci0KLQlXQVJOX09OKHJwcy0+ZWZmaWNpZW50X2ZyZXEgPCBycHMtPm1pbl9mcmVxKTsKLQlXQVJO
X09OKHJwcy0+ZWZmaWNpZW50X2ZyZXEgPiBycHMtPm1heF9mcmVxKTsKLQotCXJwcy0+ZW5hYmxl
ZCA9IHRydWU7Ci19Ci0KLXZvaWQgaW50ZWxfZW5hYmxlX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JLyogUG93ZXJzYXZpbmcgaXMgY29udHJvbGxl
ZCBieSB0aGUgaG9zdCB3aGVuIGluc2lkZSBhIFZNICovCi0JaWYgKGludGVsX3ZncHVfYWN0aXZl
KGRldl9wcml2KSkKLQkJcmV0dXJuOwotCi0JbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmd0X3BtLnJw
cy5sb2NrKTsKLQotCWlmIChIQVNfUlBTKGRldl9wcml2KSkKLQkJaW50ZWxfZW5hYmxlX3Jwcyhk
ZXZfcHJpdik7Ci0KLQlpbnRlbF9sbGNfZW5hYmxlKCZkZXZfcHJpdi0+Z3QubGxjKTsKLQotCW11
dGV4X3VubG9jaygmZGV2X3ByaXYtPmd0X3BtLnJwcy5sb2NrKTsKLX0KLQotc3RhdGljIHZvaWQg
aWJ4X2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
LXsKLQkvKgotCSAqIE9uIEliZXggUGVhayBhbmQgQ291Z2FyIFBvaW50LCB3ZSBuZWVkIHRvIGRp
c2FibGUgY2xvY2sKLQkgKiBnYXRpbmcgZm9yIHRoZSBwYW5lbCBwb3dlciBzZXF1ZW5jZXIgb3Ig
aXQgd2lsbCBmYWlsIHRvCi0JICogc3RhcnQgdXAgd2hlbiBubyBwb3J0cyBhcmUgYWN0aXZlLgot
CSAqLwotCUk5MTVfV1JJVEUoU09VVEhfRFNQQ0xLX0dBVEVfRCwgUENIX0RQTFNVTklUX0NMT0NL
X0dBVEVfRElTQUJMRSk7Ci19Ci0KLXN0YXRpYyB2b2lkIGc0eF9kaXNhYmxlX3RyaWNrbGVfZmVl
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JZW51bSBwaXBlIHBpcGU7
Ci0KLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKSB7Ci0JCUk5MTVfV1JJVEUoRFNQQ05U
UihwaXBlKSwKLQkJCSAgIEk5MTVfUkVBRChEU1BDTlRSKHBpcGUpKSB8Ci0JCQkgICBESVNQUExB
TkVfVFJJQ0tMRV9GRUVEX0RJU0FCTEUpOwotCi0JCUk5MTVfV1JJVEUoRFNQU1VSRihwaXBlKSwg
STkxNV9SRUFEKERTUFNVUkYocGlwZSkpKTsKLQkJUE9TVElOR19SRUFEKERTUFNVUkYocGlwZSkp
OwotCX0KLX0KLQotc3RhdGljIHZvaWQgaWxrX2luaXRfY2xvY2tfZ2F0aW5nKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQl1MzIgZHNwY2xrX2dhdGUgPSBJTEtfVlJIVU5J
VF9DTE9DS19HQVRFX0RJU0FCTEU7Ci0KLQkvKgotCSAqIFJlcXVpcmVkIGZvciBGQkMKLQkgKiBX
YUZiY0Rpc2FibGVEcGZjQ2xvY2tHYXRpbmc6aWxrCi0JICovCi0JZHNwY2xrX2dhdGUgfD0gSUxL
X0RQRkNSVU5JVF9DTE9DS19HQVRFX0RJU0FCTEUgfAotCQkgICBJTEtfRFBGQ1VOSVRfQ0xPQ0tf
R0FURV9ESVNBQkxFIHwKLQkJICAgSUxLX0RQRkRVTklUX0NMT0NLX0dBVEVfRU5BQkxFOwotCi0J
STkxNV9XUklURShQQ0hfM0RDR0RJUzAsCi0JCSAgIE1BUklVTklUX0NMT0NLX0dBVEVfRElTQUJM
RSB8Ci0JCSAgIFNWU01VTklUX0NMT0NLX0dBVEVfRElTQUJMRSk7Ci0JSTkxNV9XUklURShQQ0hf
M0RDR0RJUzEsCi0JCSAgIFZGTVVOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFKTsKLQotCS8qCi0JICog
QWNjb3JkaW5nIHRvIHRoZSBzcGVjIHRoZSBmb2xsb3dpbmcgYml0cyBzaG91bGQgYmUgc2V0IGlu
Ci0JICogb3JkZXIgdG8gZW5hYmxlIG1lbW9yeSBzZWxmLXJlZnJlc2gKLQkgKiBUaGUgYml0IDIy
LzIxIG9mIDB4NDIwMDQKLQkgKiBUaGUgYml0IDUgb2YgMHg0MjAyMAotCSAqIFRoZSBiaXQgMTUg
b2YgMHg0NTAwMAotCSAqLwotCUk5MTVfV1JJVEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIsCi0JCSAg
IChJOTE1X1JFQUQoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIpIHwKLQkJICAgIElMS19EUEFSQl9HQVRF
IHwgSUxLX1ZTRFBGRF9GVUxMKSk7Ci0JZHNwY2xrX2dhdGUgfD0gSUxLX0RQQVJCVU5JVF9DTE9D
S19HQVRFX0VOQUJMRTsKLQlJOTE1X1dSSVRFKERJU1BfQVJCX0NUTCwKLQkJICAgKEk5MTVfUkVB
RChESVNQX0FSQl9DVEwpIHwKLQkJICAgIERJU1BfRkJDX1dNX0RJUykpOwotCi0JLyoKLQkgKiBC
YXNlZCBvbiB0aGUgZG9jdW1lbnQgZnJvbSBoYXJkd2FyZSBndXlzIHRoZSBmb2xsb3dpbmcgYml0
cwotCSAqIHNob3VsZCBiZSBzZXQgdW5jb25kaXRpb25hbGx5IGluIG9yZGVyIHRvIGVuYWJsZSBG
QkMuCi0JICogVGhlIGJpdCAyMiBvZiAweDQyMDAwCi0JICogVGhlIGJpdCAyMiBvZiAweDQyMDA0
Ci0JICogVGhlIGJpdCA3LDgsOSBvZiAweDQyMDIwLgotCSAqLwotCWlmIChJU19JUk9OTEFLRV9N
KGRldl9wcml2KSkgewotCQkvKiBXYUZiY0FzeW5jaEZsaXBEaXNhYmxlRmJjUXVldWU6aWxrICov
Ci0JCUk5MTVfV1JJVEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjEsCi0JCQkgICBJOTE1X1JFQUQoSUxL
X0RJU1BMQVlfQ0hJQ0tFTjEpIHwKLQkJCSAgIElMS19GQkNRX0RJUyk7Ci0JCUk5MTVfV1JJVEUo
SUxLX0RJU1BMQVlfQ0hJQ0tFTjIsCi0JCQkgICBJOTE1X1JFQUQoSUxLX0RJU1BMQVlfQ0hJQ0tF
TjIpIHwKLQkJCSAgIElMS19EUEFSQl9HQVRFKTsKLQl9Ci0KLQlJOTE1X1dSSVRFKElMS19EU1BD
TEtfR0FURV9ELCBkc3BjbGtfZ2F0ZSk7Ci0KLQlJOTE1X1dSSVRFKElMS19ESVNQTEFZX0NISUNL
RU4yLAotCQkgICBJOTE1X1JFQUQoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIpIHwKLQkJICAgSUxLX0VM
UElOXzQwOV9TRUxFQ1QpOwotCUk5MTVfV1JJVEUoXzNEX0NISUNLRU4yLAotCQkgICBfM0RfQ0hJ
Q0tFTjJfV01fUkVBRF9QSVBFTElORUQgPDwgMTYgfAotCQkgICBfM0RfQ0hJQ0tFTjJfV01fUkVB
RF9QSVBFTElORUQpOwotCi0JLyogV2FEaXNhYmxlUmVuZGVyQ2FjaGVQaXBlbGluZWRGbHVzaDpp
bGsgKi8KLQlJOTE1X1dSSVRFKENBQ0hFX01PREVfMCwKLQkJICAgX01BU0tFRF9CSVRfRU5BQkxF
KENNMF9QSVBFTElORURfUkVOREVSX0ZMVVNIX0RJU0FCTEUpKTsKLQotCS8qIFdhRGlzYWJsZV9S
ZW5kZXJDYWNoZV9PcGVyYXRpb25hbEZsdXNoOmlsayAqLwotCUk5MTVfV1JJVEUoQ0FDSEVfTU9E
RV8wLCBfTUFTS0VEX0JJVF9ESVNBQkxFKFJDX09QX0ZMVVNIX0VOQUJMRSkpOwotCi0JZzR4X2Rp
c2FibGVfdHJpY2tsZV9mZWVkKGRldl9wcml2KTsKLQotCWlieF9pbml0X2Nsb2NrX2dhdGluZyhk
ZXZfcHJpdik7Ci19Ci0KLXN0YXRpYyB2b2lkIGNwdF9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JZW51bSBwaXBlIHBpcGU7Ci0JdTMyIHZh
bDsKLQotCS8qCi0JICogT24gSWJleCBQZWFrIGFuZCBDb3VnYXIgUG9pbnQsIHdlIG5lZWQgdG8g
ZGlzYWJsZSBjbG9jawotCSAqIGdhdGluZyBmb3IgdGhlIHBhbmVsIHBvd2VyIHNlcXVlbmNlciBv
ciBpdCB3aWxsIGZhaWwgdG8KLQkgKiBzdGFydCB1cCB3aGVuIG5vIHBvcnRzIGFyZSBhY3RpdmUu
Ci0JICovCi0JSTkxNV9XUklURShTT1VUSF9EU1BDTEtfR0FURV9ELCBQQ0hfRFBMU1VOSVRfQ0xP
Q0tfR0FURV9ESVNBQkxFIHwKLQkJICAgUENIX0RQTFVOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFIHwK
LQkJICAgUENIX0NQVU5JVF9DTE9DS19HQVRFX0RJU0FCTEUpOwotCUk5MTVfV1JJVEUoU09VVEhf
Q0hJQ0tFTjIsIEk5MTVfUkVBRChTT1VUSF9DSElDS0VOMikgfAotCQkgICBEUExTX0VEUF9QUFNf
RklYX0RJUyk7Ci0JLyogVGhlIGJlbG93IGZpeGVzIHRoZSB3ZWlyZCBkaXNwbGF5IGNvcnJ1cHRp
b24sIGEgZmV3IHBpeGVscyBzaGlmdGVkCi0JICogZG93bndhcmQsIG9uIChvbmx5KSBMVkRTIG9m
IHNvbWUgSFAgbGFwdG9wcyB3aXRoIElWWS4KLQkgKi8KLQlmb3JfZWFjaF9waXBlKGRldl9wcml2
LCBwaXBlKSB7Ci0JCXZhbCA9IEk5MTVfUkVBRChUUkFOU19DSElDS0VOMihwaXBlKSk7Ci0JCXZh
bCB8PSBUUkFOU19DSElDS0VOMl9USU1JTkdfT1ZFUlJJREU7Ci0JCXZhbCAmPSB+VFJBTlNfQ0hJ
Q0tFTjJfRkRJX1BPTEFSSVRZX1JFVkVSU0VEOwotCQlpZiAoZGV2X3ByaXYtPnZidC5mZGlfcnhf
cG9sYXJpdHlfaW52ZXJ0ZWQpCi0JCQl2YWwgfD0gVFJBTlNfQ0hJQ0tFTjJfRkRJX1BPTEFSSVRZ
X1JFVkVSU0VEOwotCQl2YWwgJj0gflRSQU5TX0NISUNLRU4yX0ZSQU1FX1NUQVJUX0RFTEFZX01B
U0s7Ci0JCXZhbCAmPSB+VFJBTlNfQ0hJQ0tFTjJfRElTQUJMRV9ERUVQX0NPTE9SX0NPVU5URVI7
Ci0JCXZhbCAmPSB+VFJBTlNfQ0hJQ0tFTjJfRElTQUJMRV9ERUVQX0NPTE9SX01PREVTV0lUQ0g7
Ci0JCUk5MTVfV1JJVEUoVFJBTlNfQ0hJQ0tFTjIocGlwZSksIHZhbCk7Ci0JfQotCS8qIFdBRFAw
Q2xvY2tHYXRpbmdEaXNhYmxlICovCi0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewot
CQlJOTE1X1dSSVRFKFRSQU5TX0NISUNLRU4xKHBpcGUpLAotCQkJICAgVFJBTlNfQ0hJQ0tFTjFf
RFAwVU5JVF9HQ19ESVNBQkxFKTsKLQl9Ci19Ci0KLXN0YXRpYyB2b2lkIGdlbjZfY2hlY2tfbWNo
X3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQl1MzIgdG1wOwot
Ci0JdG1wID0gSTkxNV9SRUFEKE1DSF9TU0tQRCk7Ci0JaWYgKCh0bXAgJiBNQ0hfU1NLUERfV00w
X01BU0spICE9IE1DSF9TU0tQRF9XTTBfVkFMKQotCQlEUk1fREVCVUdfS01TKCJXcm9uZyBNQ0hf
U1NLUEQgdmFsdWU6IDB4JTA4eCBUaGlzIGNhbiBjYXVzZSB1bmRlcnJ1bnMuXG4iLAotCQkJICAg
ICAgdG1wKTsKLX0KLQotc3RhdGljIHZvaWQgZ2VuNl9pbml0X2Nsb2NrX2dhdGluZyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTMyIGRzcGNsa19nYXRlID0gSUxLX1ZS
SFVOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFOwotCi0JSTkxNV9XUklURShJTEtfRFNQQ0xLX0dBVEVf
RCwgZHNwY2xrX2dhdGUpOwotCi0JSTkxNV9XUklURShJTEtfRElTUExBWV9DSElDS0VOMiwKLQkJ
ICAgSTkxNV9SRUFEKElMS19ESVNQTEFZX0NISUNLRU4yKSB8Ci0JCSAgIElMS19FTFBJTl80MDlf
U0VMRUNUKTsKLQotCS8qIFdhRGlzYWJsZUhpWlBsYW5lc1doZW5NU0FBRW5hYmxlZDpzbmIgKi8K
LQlJOTE1X1dSSVRFKF8zRF9DSElDS0VOLAotCQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoXzNEX0NI
SUNLRU5fSElaX1BMQU5FX0RJU0FCTEVfTVNBQV80WF9TTkIpKTsKLQotCS8qIFdhRGlzYWJsZV9S
ZW5kZXJDYWNoZV9PcGVyYXRpb25hbEZsdXNoOnNuYiAqLwotCUk5MTVfV1JJVEUoQ0FDSEVfTU9E
RV8wLCBfTUFTS0VEX0JJVF9ESVNBQkxFKFJDX09QX0ZMVVNIX0VOQUJMRSkpOwotCi0JLyoKLQkg
KiBCU3BlYyByZWNvb21lbmRzIDh4NCB3aGVuIE1TQUEgaXMgdXNlZCwKLQkgKiBob3dldmVyIGlu
IHByYWN0aWNlIDE2eDQgc2VlbXMgZmFzdGVzdC4KLQkgKgotCSAqIE5vdGUgdGhhdCBQUy9XTSB0
aHJlYWQgY291bnRzIGRlcGVuZCBvbiB0aGUgV0laIGhhc2hpbmcKLQkgKiBkaXNhYmxlIGJpdCwg
d2hpY2ggd2UgZG9uJ3QgdG91Y2ggaGVyZSwgYnV0IGl0J3MgZ29vZAotCSAqIHRvIGtlZXAgaW4g
bWluZCAoc2VlIDNEU1RBVEVfUFMgYW5kIDNEU1RBVEVfV00pLgotCSAqLwotCUk5MTVfV1JJVEUo
R0VONl9HVF9NT0RFLAotCQkgICBfTUFTS0VEX0ZJRUxEKEdFTjZfV0laX0hBU0hJTkdfTUFTSywg
R0VONl9XSVpfSEFTSElOR18xNng0KSk7Ci0KLQlJOTE1X1dSSVRFKENBQ0hFX01PREVfMCwKLQkJ
ICAgX01BU0tFRF9CSVRfRElTQUJMRShDTTBfU1RDX0VWSUNUX0RJU0FCTEVfTFJBX1NOQikpOwot
Ci0JSTkxNV9XUklURShHRU42X1VDR0NUTDEsCi0JCSAgIEk5MTVfUkVBRChHRU42X1VDR0NUTDEp
IHwKLQkJICAgR0VONl9CTEJVTklUX0NMT0NLX0dBVEVfRElTQUJMRSB8Ci0JCSAgIEdFTjZfQ1NV
TklUX0NMT0NLX0dBVEVfRElTQUJMRSk7Ci0KLQkvKiBBY2NvcmRpbmcgdG8gdGhlIEJTcGVjIHZv
bDFnLCBiaXQgMTIgKFJDUEJVTklUKSBjbG9jawotCSAqIGdhdGluZyBkaXNhYmxlIG11c3QgYmUg
c2V0LiAgRmFpbHVyZSB0byBzZXQgaXQgcmVzdWx0cyBpbgotCSAqIGZsaWNrZXJpbmcgcGl4ZWxz
IGR1ZSB0byBaIHdyaXRlIG9yZGVyaW5nIGZhaWx1cmVzIGFmdGVyCi0JICogc29tZSBhbW91bnQg
b2YgcnVudGltZSBpbiB0aGUgTWVzYSAiZmlyZSIgZGVtbywgYW5kIFVuaWdpbmUKLQkgKiBTYW5j
dHVhcnkgYW5kIFRyb3BpY3MsIGFuZCBhcHBhcmVudGx5IGFueXRoaW5nIGVsc2Ugd2l0aAotCSAq
IGFscGhhIHRlc3Qgb3IgcGl4ZWwgZGlzY2FyZC4KLQkgKgotCSAqIEFjY29yZGluZyB0byB0aGUg
c3BlYywgYml0IDExIChSQ0NVTklUKSBtdXN0IGFsc28gYmUgc2V0LAotCSAqIGJ1dCB3ZSBkaWRu
J3QgZGVidWcgYWN0dWFsIHRlc3RjYXNlcyB0byBmaW5kIGl0IG91dC4KLQkgKgotCSAqIFdhRGlz
YWJsZVJDQ1VuaXRDbG9ja0dhdGluZzpzbmIKLQkgKiBXYURpc2FibGVSQ1BCVW5pdENsb2NrR2F0
aW5nOnNuYgotCSAqLwotCUk5MTVfV1JJVEUoR0VONl9VQ0dDVEwyLAotCQkgICBHRU42X1JDUEJV
TklUX0NMT0NLX0dBVEVfRElTQUJMRSB8Ci0JCSAgIEdFTjZfUkNDVU5JVF9DTE9DS19HQVRFX0RJ
U0FCTEUpOwotCi0JLyogV2FTdHJpcHNGYW5zRGlzYWJsZUZhc3RDbGlwUGVyZm9ybWFuY2VGaXg6
c25iICovCi0JSTkxNV9XUklURShfM0RfQ0hJQ0tFTjMsCi0JCSAgIF9NQVNLRURfQklUX0VOQUJM
RShfM0RfQ0hJQ0tFTjNfU0ZfRElTQUJMRV9GQVNUQ0xJUF9DVUxMKSk7Ci0KLQkvKgotCSAqIEJz
cGVjIHNheXM6Ci0JICogIlRoaXMgYml0IG11c3QgYmUgc2V0IGlmIDNEU1RBVEVfQ0xJUCBjbGlw
IG1vZGUgaXMgc2V0IHRvIG5vcm1hbCBhbmQKLQkgKiAzRFNUQVRFX1NGIG51bWJlciBvZiBTRiBv
dXRwdXQgYXR0cmlidXRlcyBpcyBtb3JlIHRoYW4gMTYuIgotCSAqLwotCUk5MTVfV1JJVEUoXzNE
X0NISUNLRU4zLAotCQkgICBfTUFTS0VEX0JJVF9FTkFCTEUoXzNEX0NISUNLRU4zX1NGX0RJU0FC
TEVfUElQRUxJTkVEX0FUVFJfRkVUQ0gpKTsKLQotCS8qCi0JICogQWNjb3JkaW5nIHRvIHRoZSBz
cGVjIHRoZSBmb2xsb3dpbmcgYml0cyBzaG91bGQgYmUKLQkgKiBzZXQgaW4gb3JkZXIgdG8gZW5h
YmxlIG1lbW9yeSBzZWxmLXJlZnJlc2ggYW5kIGZiYzoKLQkgKiBUaGUgYml0MjEgYW5kIGJpdDIy
IG9mIDB4NDIwMDAKLQkgKiBUaGUgYml0MjEgYW5kIGJpdDIyIG9mIDB4NDIwMDQKLQkgKiBUaGUg
Yml0NSBhbmQgYml0NyBvZiAweDQyMDIwCi0JICogVGhlIGJpdDE0IG9mIDB4NzAxODAKLQkgKiBU
aGUgYml0MTQgb2YgMHg3MTE4MAotCSAqCi0JICogV2FGYmNBc3luY2hGbGlwRGlzYWJsZUZiY1F1
ZXVlOnNuYgotCSAqLwotCUk5MTVfV1JJVEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjEsCi0JCSAgIEk5
MTVfUkVBRChJTEtfRElTUExBWV9DSElDS0VOMSkgfAotCQkgICBJTEtfRkJDUV9ESVMgfCBJTEtf
UEFCU1RSRVRDSF9ESVMpOwotCUk5MTVfV1JJVEUoSUxLX0RJU1BMQVlfQ0hJQ0tFTjIsCi0JCSAg
IEk5MTVfUkVBRChJTEtfRElTUExBWV9DSElDS0VOMikgfAotCQkgICBJTEtfRFBBUkJfR0FURSB8
IElMS19WU0RQRkRfRlVMTCk7Ci0JSTkxNV9XUklURShJTEtfRFNQQ0xLX0dBVEVfRCwKLQkJICAg
STkxNV9SRUFEKElMS19EU1BDTEtfR0FURV9EKSB8Ci0JCSAgIElMS19EUEFSQlVOSVRfQ0xPQ0tf
R0FURV9FTkFCTEUgIHwKLQkJICAgSUxLX0RQRkRVTklUX0NMT0NLX0dBVEVfRU5BQkxFKTsKLQot
CWc0eF9kaXNhYmxlX3RyaWNrbGVfZmVlZChkZXZfcHJpdik7Ci0KLQljcHRfaW5pdF9jbG9ja19n
YXRpbmcoZGV2X3ByaXYpOwotCi0JZ2VuNl9jaGVja19tY2hfc2V0dXAoZGV2X3ByaXYpOwotfQot
Ci1zdGF0aWMgdm9pZCBnZW43X3NldHVwX2ZpeGVkX2Z1bmNfc2NoZWR1bGVyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQl1MzIgcmVnID0gSTkxNV9SRUFEKEdFTjdfRkZf
VEhSRUFEX01PREUpOwotCi0JLyoKLQkgKiBXYVZTVGhyZWFkRGlzcGF0Y2hPdmVycmlkZTppdmIs
dmx2Ci0JICoKLQkgKiBUaGlzIGFjdHVhbGx5IG92ZXJyaWRlcyB0aGUgZGlzcGF0Y2gKLQkgKiBt
b2RlIGZvciBhbGwgdGhyZWFkIHR5cGVzLgotCSAqLwotCXJlZyAmPSB+R0VON19GRl9TQ0hFRF9N
QVNLOwotCXJlZyB8PSBHRU43X0ZGX1RTX1NDSEVEX0hXOwotCXJlZyB8PSBHRU43X0ZGX1ZTX1ND
SEVEX0hXOwotCXJlZyB8PSBHRU43X0ZGX0RTX1NDSEVEX0hXOwotCi0JSTkxNV9XUklURShHRU43
X0ZGX1RIUkVBRF9NT0RFLCByZWcpOwotfQotCi1zdGF0aWMgdm9pZCBscHRfaW5pdF9jbG9ja19n
YXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCS8qCi0JICogVE9E
TzogdGhpcyBiaXQgc2hvdWxkIG9ubHkgYmUgZW5hYmxlZCB3aGVuIHJlYWxseSBuZWVkZWQsIHRo
ZW4KLQkgKiBkaXNhYmxlZCB3aGVuIG5vdCBuZWVkZWQgYW55bW9yZSBpbiBvcmRlciB0byBzYXZl
IHBvd2VyLgorCS8qCisJICogVE9ETzogdGhpcyBiaXQgc2hvdWxkIG9ubHkgYmUgZW5hYmxlZCB3
aGVuIHJlYWxseSBuZWVkZWQsIHRoZW4KKwkgKiBkaXNhYmxlZCB3aGVuIG5vdCBuZWVkZWQgYW55
bW9yZSBpbiBvcmRlciB0byBzYXZlIHBvd2VyLgogCSAqLwogCWlmIChIQVNfUENIX0xQVF9MUChk
ZXZfcHJpdikpCiAJCUk5MTVfV1JJVEUoU09VVEhfRFNQQ0xLX0dBVEVfRCwKQEAgLTg4NTUsOTAg
KzcyMjQsOCBAQCB2b2lkIGludGVsX2luaXRfcG0oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQogCX0KIH0KIAotc3RhdGljIGludCBieXRfZ3B1X2ZyZXEoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgdmFsKQotewotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9
ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwotCi0JLyoKLQkgKiBOID0gdmFsIC0gMHhiNwotCSAqIFNs
b3cgPSBGYXN0ID0gR1BMTCByZWYgKiBOCi0JICovCi0JcmV0dXJuIERJVl9ST1VORF9DTE9TRVNU
KHJwcy0+Z3BsbF9yZWZfZnJlcSAqICh2YWwgLSAweGI3KSwgMTAwMCk7Ci19Ci0KLXN0YXRpYyBp
bnQgYnl0X2ZyZXFfb3Bjb2RlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50
IHZhbCkKLXsKLQlzdHJ1Y3QgaW50ZWxfcnBzICpycHMgPSAmZGV2X3ByaXYtPmd0X3BtLnJwczsK
LQotCXJldHVybiBESVZfUk9VTkRfQ0xPU0VTVCgxMDAwICogdmFsLCBycHMtPmdwbGxfcmVmX2Zy
ZXEpICsgMHhiNzsKLX0KLQotc3RhdGljIGludCBjaHZfZ3B1X2ZyZXEoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgdmFsKQotewotCXN0cnVjdCBpbnRlbF9ycHMgKnJwcyA9
ICZkZXZfcHJpdi0+Z3RfcG0ucnBzOwotCi0JLyoKLQkgKiBOID0gdmFsIC8gMgotCSAqIENVIChz
bG93KSA9IENVMnggKGZhc3QpIC8gMiA9IEdQTEwgcmVmICogTiAvIDIKLQkgKi8KLQlyZXR1cm4g
RElWX1JPVU5EX0NMT1NFU1QocnBzLT5ncGxsX3JlZl9mcmVxICogdmFsLCAyICogMiAqIDEwMDAp
OwotfQotCi1zdGF0aWMgaW50IGNodl9mcmVxX29wY29kZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIGludCB2YWwpCi17Ci0Jc3RydWN0IGludGVsX3JwcyAqcnBzID0gJmRldl9w
cml2LT5ndF9wbS5ycHM7Ci0KLQkvKiBDSFYgbmVlZHMgZXZlbiB2YWx1ZXMgKi8KLQlyZXR1cm4g
RElWX1JPVU5EX0NMT1NFU1QoMiAqIDEwMDAgKiB2YWwsIHJwcy0+Z3BsbF9yZWZfZnJlcSkgKiAy
OwotfQotCi1pbnQgaW50ZWxfZ3B1X2ZyZXEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LCBpbnQgdmFsKQotewotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCi0JCXJldHVy
biBESVZfUk9VTkRfQ0xPU0VTVCh2YWwgKiBHVF9GUkVRVUVOQ1lfTVVMVElQTElFUiwKLQkJCQkJ
IEdFTjlfRlJFUV9TQ0FMRVIpOwotCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQot
CQlyZXR1cm4gY2h2X2dwdV9mcmVxKGRldl9wcml2LCB2YWwpOwotCWVsc2UgaWYgKElTX1ZBTExF
WVZJRVcoZGV2X3ByaXYpKQotCQlyZXR1cm4gYnl0X2dwdV9mcmVxKGRldl9wcml2LCB2YWwpOwot
CWVsc2UKLQkJcmV0dXJuIHZhbCAqIEdUX0ZSRVFVRU5DWV9NVUxUSVBMSUVSOwotfQotCi1pbnQg
aW50ZWxfZnJlcV9vcGNvZGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQg
dmFsKQotewotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCi0JCXJldHVybiBESVZfUk9V
TkRfQ0xPU0VTVCh2YWwgKiBHRU45X0ZSRVFfU0NBTEVSLAotCQkJCQkgR1RfRlJFUVVFTkNZX01V
TFRJUExJRVIpOwotCWVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQotCQlyZXR1cm4g
Y2h2X2ZyZXFfb3Bjb2RlKGRldl9wcml2LCB2YWwpOwotCWVsc2UgaWYgKElTX1ZBTExFWVZJRVco
ZGV2X3ByaXYpKQotCQlyZXR1cm4gYnl0X2ZyZXFfb3Bjb2RlKGRldl9wcml2LCB2YWwpOwotCWVs
c2UKLQkJcmV0dXJuIERJVl9ST1VORF9DTE9TRVNUKHZhbCwgR1RfRlJFUVVFTkNZX01VTFRJUExJ
RVIpOwotfQotCiB2b2lkIGludGVsX3BtX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKIHsKLQltdXRleF9pbml0KCZkZXZfcHJpdi0+Z3RfcG0ucnBzLmxvY2spOwotCW11
dGV4X2luaXQoJmRldl9wcml2LT5ndF9wbS5ycHMucG93ZXIubXV0ZXgpOwotCi0JYXRvbWljX3Nl
dCgmZGV2X3ByaXYtPmd0X3BtLnJwcy5udW1fd2FpdGVycywgMCk7Ci0KIAlkZXZfcHJpdi0+cnVu
dGltZV9wbS5zdXNwZW5kZWQgPSBmYWxzZTsKIAlhdG9taWNfc2V0KCZkZXZfcHJpdi0+cnVudGlt
ZV9wbS53YWtlcmVmX2NvdW50LCAwKTsKIH0KLQotdTMyIGludGVsX2dldF9jYWdmKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHJwc3RhdCkKLXsKLQl1MzIgY2FnZjsKLQot
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDkpCi0JCWNhZ2YgPSAocnBzdGF0ICYgR0VOOV9D
QUdGX01BU0spID4+IEdFTjlfQ0FHRl9TSElGVDsKLQllbHNlIGlmIChJU19IQVNXRUxMKGRldl9w
cml2KSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQotCQljYWdmID0gKHJwc3RhdCAmIEhTV19D
QUdGX01BU0spID4+IEhTV19DQUdGX1NISUZUOwotCWVsc2UKLQkJY2FnZiA9IChycHN0YXQgJiBH
RU42X0NBR0ZfTUFTSykgPj4gR0VONl9DQUdGX1NISUZUOwotCi0JcmV0dXJuICBjYWdmOwotfQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uaCBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2ludGVsX3BtLmgKaW5kZXggMDBhNTgwMWRmYzA2Li5iNTc5YzcyNGI5MTUgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmgKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfcG0uaApAQCAtMjksMTUgKzI5LDYgQEAgdm9pZCBpbnRlbF91cGRh
dGVfd2F0ZXJtYXJrcyhzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0Yyk7CiB2b2lkIGludGVsX2luaXRf
cG0oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIHZvaWQgaW50ZWxfaW5pdF9j
bG9ja19nYXRpbmdfaG9va3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIHZv
aWQgaW50ZWxfcG1fc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZv
aWQgaW50ZWxfZ3B1X2lwc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Ci12b2lkIGludGVsX2dwdV9pcHNfdGVhcmRvd24odm9pZCk7Ci12b2lkIGludGVsX2luaXRfZ3Rf
cG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12b2lkIGludGVs
X3Nhbml0aXplX2d0X3Bvd2Vyc2F2ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owotdm9pZCBpbnRlbF9lbmFibGVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Ci12b2lkIGludGVsX2Rpc2FibGVfZ3RfcG93ZXJzYXZlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12b2lkIGdlbjZfcnBzX2J1c3koc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQgZ2VuNl9ycHNfaWRsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBnZW42X3Jwc19ib29zdChzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSk7CiB2b2lkIGc0eF93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KTsKIHZvaWQgdmx2X3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBpbGtfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CkBAIC02NywxOSArNTgsNiBAQCBib29sIGlsa19k
aXNhYmxlX2xwX3dtKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOwogdm9pZCBpbnRlbF9pbml0X2lw
YyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBpbnRlbF9lbmFibGVf
aXBjKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiAKLWludCBpbnRlbF9ncHVf
ZnJlcShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGludCB2YWwpOwotaW50IGlu
dGVsX2ZyZXFfb3Bjb2RlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IHZh
bCk7Ci0KLXUzMiBpbnRlbF9nZXRfY2FnZihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIHUzMiBycHN0YXQxKTsKLQotdW5zaWduZWQgbG9uZyBpOTE1X2NoaXBzZXRfdmFsKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci11bnNpZ25lZCBsb25nIGk5MTVfbWNoX3Zh
bChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdW5zaWduZWQgbG9uZyBpOTE1
X2dmeF92YWwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQgaTkxNV91
cGRhdGVfZ2Z4X3ZhbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotCi1ib29s
IGlyb25sYWtlX3NldF9kcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTgg
dmFsKTsKLWludCBpbnRlbF9zZXRfcnBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgdTggdmFsKTsKLXZvaWQgaW50ZWxfcnBzX21hcmtfaW50ZXJhY3RpdmUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsIGJvb2wgaW50ZXJhY3RpdmUpOwogYm9vbCBpbnRlbF9zZXRfbWVt
b3J5X2N4c3Ioc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIGVuYWJsZSk7
CiAKICNlbmRpZiAvKiBfX0lOVEVMX1BNX0hfXyAqLwotLSAKMi4yNC4wLnJjMAoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcg
bGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

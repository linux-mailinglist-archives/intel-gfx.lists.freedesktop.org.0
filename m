Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 20B51A8698
	for <lists+intel-gfx@lfdr.de>; Wed,  4 Sep 2019 18:27:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6D7D989C29;
	Wed,  4 Sep 2019 16:27:05 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BF53A89C29
 for <intel-gfx@lists.freedesktop.org>; Wed,  4 Sep 2019 16:27:03 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
 by orsmga104.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 04 Sep 2019 09:27:03 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,467,1559545200"; d="scan'208";a="183955710"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by fmsmga007.fm.intel.com with SMTP; 04 Sep 2019 09:27:01 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Wed, 04 Sep 2019 19:27:00 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  4 Sep 2019 19:26:22 +0300
Message-Id: <20190904162625.15048-13-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190904162625.15048-1-ville.syrjala@linux.intel.com>
References: <20190904162625.15048-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 12/15] drm/i915: Have pfit calculations return
 an error code
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KCkNo
YW5nZSBpbnRlbF97Z21jaCxwY2h9X3BhbmVsX2ZpdHRpbmcoKSB0byByZXR1cm4gYSBub3JtYWwK
ZXJyb3IgdnMuIHN1Y2Nlc3MgaW50LiBXZSdsbCBuZWVkIHRoaXMgbGF0ZXIgdG8gdmFsaWRhdGUg
dGhhdAp0aGUgbWFyZ2luIHByb3BlcnRpZXMgYXJlbid0IG1pc2NvbmZpZ3VyZWQuCgpTaWduZWQt
b2ZmLWJ5OiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgot
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaWNsX2RzaS5jICAgICB8IDEwICsrKysr
KystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYyAgICB8IDEwICsr
KysrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRtaS5jICB8IDIy
ICsrKysrKysrKysrLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfbHZkcy5jICB8IDEzICsrKysrKysrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfcGFuZWwuYyB8IDE5ICsrKysrKysrKysrLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuaCB8ICA2ICsrKy0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS92bHZfZHNpLmMgICAgIHwgIDYgKysrKy0tCiA3IGZpbGVzIGNoYW5nZWQs
IDQ5IGluc2VydGlvbnMoKyksIDM3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaWNsX2RzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pY2xfZHNpLmMKaW5kZXggZDI1MmY2OGU1ZDA5Li4yMDEwYWQ5OTE4NzYgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaWNsX2RzaS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaWNsX2RzaS5jCkBAIC0xMjY2LDEzICsxMjY2LDE3IEBAIHN0
YXRpYyBpbnQgZ2VuMTFfZHNpX2NvbXB1dGVfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAogCQkJCQkJICAgYmFzZSk7CiAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqaW50ZWxf
Y29ubmVjdG9yID0gaW50ZWxfZHNpLT5hdHRhY2hlZF9jb25uZWN0b3I7CiAJY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGUgPQotCQkJCQlpbnRlbF9jb25uZWN0b3ItPnBh
bmVsLmZpeGVkX21vZGU7CisJCWludGVsX2Nvbm5lY3Rvci0+cGFuZWwuZml4ZWRfbW9kZTsKIAlz
dHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9Ci0JCQkJCSZwaXBlX2NvbmZp
Zy0+YmFzZS5hZGp1c3RlZF9tb2RlOworCQkmcGlwZV9jb25maWctPmJhc2UuYWRqdXN0ZWRfbW9k
ZTsKKwlpbnQgcmV0OwogCiAJcGlwZV9jb25maWctPm91dHB1dF9mb3JtYXQgPSBJTlRFTF9PVVRQ
VVRfRk9STUFUX1JHQjsKIAlpbnRlbF9maXhlZF9wYW5lbF9tb2RlKGZpeGVkX21vZGUsIGFkanVz
dGVkX21vZGUpOwotCWludGVsX3BjaF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLCBjb25uX3N0
YXRlKTsKKworCXJldCA9IGludGVsX3BjaF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLCBjb25u
X3N0YXRlKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OwogCiAJYWRqdXN0ZWRfbW9kZS0+Zmxh
Z3MgPSAwOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RwLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMKaW5kZXggYzhh
ZjExZjAzYjU1Li4wNThjMzQwMTNmNTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZHAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2RwLmMKQEAgLTIxMjksOSArMjEyOSw3IEBAIGludGVsX2RwX3ljYmNyNDIwX2NvbmZpZyhz
dHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAogCiAJY3J0Y19zdGF0ZS0+b3V0cHV0X2Zvcm1hdCA9
IElOVEVMX09VVFBVVF9GT1JNQVRfWUNCQ1I0MjA7CiAKLQlpbnRlbF9wY2hfcGFuZWxfZml0dGlu
ZyhjcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsKLQotCXJldHVybiAwOworCXJldHVybiBpbnRlbF9w
Y2hfcGFuZWxfZml0dGluZyhjcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsKIH0KIAogYm9vbCBpbnRl
bF9kcF9saW1pdGVkX2NvbG9yX3JhbmdlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLApAQCAtMjE5OSw5ICsyMTk3LDExIEBAIGludGVsX2RwX2NvbXB1dGVfY29uZmln
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSAgICAgICBhZGp1c3RlZF9tb2Rl
KTsKIAogCQlpZiAoSEFTX0dNQ0goZGV2X3ByaXYpKQotCQkJaW50ZWxfZ21jaF9wYW5lbF9maXR0
aW5nKHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKKwkJCXJldCA9IGludGVsX2dtY2hfcGFuZWxf
Zml0dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CiAJCWVsc2UKLQkJCWludGVsX3BjaF9w
YW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKKwkJCXJldCA9IGludGVsX3Bj
aF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKKwkJaWYgKHJldCkKKwkJ
CXJldHVybiByZXQ7CiAJfQogCiAJaWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJNX01PREVf
RkxBR19EQkxTQ0FOKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9oZG1pLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWkuYwpp
bmRleCAxZmE0ZjA3M2IyNzQuLjdiYWNkOWIxMzVlYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9oZG1pLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9oZG1pLmMKQEAgLTIyNjMsMjIgKzIyNjMsMjUgQEAgc3RhdGljIGJvb2wg
aGRtaV9kZWVwX2NvbG9yX3Bvc3NpYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAogCXJldHVybiB0cnVlOwogfQogCi1zdGF0aWMgYm9vbAorc3RhdGljIGludAog
aW50ZWxfaGRtaV95Y2JjcjQyMF9jb25maWcoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCiAJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0
ZSkKIHsKIAlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gY29ubl9zdGF0ZS0+Y29u
bmVjdG9yOworCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0K
KwkJJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKKworCWlmICghZHJtX21vZGVfaXNf
NDIwX29ubHkoJmNvbm5lY3Rvci0+ZGlzcGxheV9pbmZvLCBhZGp1c3RlZF9tb2RlKSkKKwkJcmV0
dXJuIDA7CiAKIAlpZiAoIWNvbm5lY3Rvci0+eWNiY3JfNDIwX2FsbG93ZWQpIHsKIAkJRFJNX0VS
Uk9SKCJQbGF0Zm9ybSBkb2Vzbid0IHN1cHBvcnQgWUNCQ1I0MjAgb3V0cHV0XG4iKTsKLQkJcmV0
dXJuIGZhbHNlOworCQlyZXR1cm4gLUVJTlZBTDsKIAl9CiAKIAljcnRjX3N0YXRlLT5vdXRwdXRf
Zm9ybWF0ID0gSU5URUxfT1VUUFVUX0ZPUk1BVF9ZQ0JDUjQyMDsKIAotCWludGVsX3BjaF9wYW5l
bF9maXR0aW5nKGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOwotCi0JcmV0dXJuIHRydWU7CisJcmV0
dXJuIGludGVsX3BjaF9wYW5lbF9maXR0aW5nKGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOwogfQog
CiBzdGF0aWMgaW50IGludGVsX2hkbWlfcG9ydF9jbG9jayhpbnQgY2xvY2ssIGludCBicGMpCkBA
IC0yMzg4LDEyICsyMzkxLDkgQEAgaW50IGludGVsX2hkbWlfY29tcHV0ZV9jb25maWcoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJaWYgKGFkanVzdGVkX21vZGUtPmZsYWdzICYgRFJN
X01PREVfRkxBR19EQkxDTEspCiAJCXBpcGVfY29uZmlnLT5waXhlbF9tdWx0aXBsaWVyID0gMjsK
IAotCWlmIChkcm1fbW9kZV9pc180MjBfb25seSgmY29ubmVjdG9yLT5kaXNwbGF5X2luZm8sIGFk
anVzdGVkX21vZGUpKSB7Ci0JCWlmICghaW50ZWxfaGRtaV95Y2JjcjQyMF9jb25maWcocGlwZV9j
b25maWcsIGNvbm5fc3RhdGUpKSB7Ci0JCQlEUk1fRVJST1IoIkNhbid0IHN1cHBvcnQgWUNCQ1I0
MjAgb3V0cHV0XG4iKTsKLQkJCXJldHVybiAtRUlOVkFMOwotCQl9Ci0JfQorCXJldCA9IGludGVs
X2hkbWlfeWNiY3I0MjBfY29uZmlnKHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKKwlpZiAocmV0
KQorCQlyZXR1cm4gcmV0OwogCiAJaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpICYmICFIQVNf
RERJKGRldl9wcml2KSkKIAkJcGlwZV9jb25maWctPmhhc19wY2hfZW5jb2RlciA9IHRydWU7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2x2ZHMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfbHZkcy5jCmluZGV4IGFkYzk1OWY4Zjk1
YS4uNWU3N2Q5OGQyMGY3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2x2ZHMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2x2
ZHMuYwpAQCAtMzk1LDYgKzM5NSw3IEBAIHN0YXRpYyBpbnQgaW50ZWxfbHZkc19jb21wdXRlX2Nv
bmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKIAlzdHJ1Y3QgZHJtX2Rp
c3BsYXlfbW9kZSAqYWRqdXN0ZWRfbW9kZSA9ICZwaXBlX2NvbmZpZy0+YmFzZS5hZGp1c3RlZF9t
b2RlOwogCXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhwaXBl
X2NvbmZpZy0+YmFzZS5jcnRjKTsKIAl1bnNpZ25lZCBpbnQgbHZkc19icHA7CisJaW50IHJldDsK
IAogCS8qIFNob3VsZCBuZXZlciBoYXBwZW4hISAqLwogCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
IDwgNCAmJiBpbnRlbF9jcnRjLT5waXBlID09IDApIHsKQEAgLTQyNywxMyArNDI4LDE1IEBAIHN0
YXRpYyBpbnQgaW50ZWxfbHZkc19jb21wdXRlX2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
aW50ZWxfZW5jb2RlciwKIAlpZiAoYWRqdXN0ZWRfbW9kZS0+ZmxhZ3MgJiBEUk1fTU9ERV9GTEFH
X0RCTFNDQU4pCiAJCXJldHVybiAtRUlOVkFMOwogCi0JaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3By
aXYpKSB7CisJaWYgKEhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKQogCQlwaXBlX2NvbmZpZy0+aGFz
X3BjaF9lbmNvZGVyID0gdHJ1ZTsKIAotCQlpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhwaXBlX2Nv
bmZpZywgY29ubl9zdGF0ZSk7Ci0JfSBlbHNlIHsKLQkJaW50ZWxfZ21jaF9wYW5lbF9maXR0aW5n
KHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKLQl9CisJaWYgKEhBU19HTUNIKGRldl9wcml2KSkK
KwkJcmV0ID0gaW50ZWxfZ21jaF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLCBjb25uX3N0YXRl
KTsKKwllbHNlCisJCXJldCA9IGludGVsX3BjaF9wYW5lbF9maXR0aW5nKHBpcGVfY29uZmlnLCBj
b25uX3N0YXRlKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OwogCiAJLyoKIAkgKiBYWFg6IEl0
IHdvdWxkIGJlIG5pY2UgdG8gc3VwcG9ydCBsb3dlciByZWZyZXNoIHJhdGVzIG9uIHRoZQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wYW5lbC5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wYW5lbC5jCmluZGV4IDFhMGI2OWVjMTc3
OC4uZjY0ZmE3MzU4N2VmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX3BhbmVsLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9w
YW5lbC5jCkBAIC0xNzMsOSArMTczLDggQEAgaW50ZWxfcGFuZWxfdmJ0X2ZpeGVkX21vZGUoc3Ry
dWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogfQogCiAvKiBhZGp1c3RlZF9tb2RlIGhh
cyBiZWVuIHByZXNldCB0byBiZSB0aGUgcGFuZWwncyBmaXhlZCBtb2RlICovCi12b2lkCi1pbnRl
bF9wY2hfcGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwK
LQkJCWNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQoraW50IGlu
dGVsX3BjaF9wYW5lbF9maXR0aW5nKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
LAorCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQog
ewogCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KIAkJJmNy
dGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZTsKQEAgLTE4Niw3ICsxODUsNyBAQCBpbnRlbF9w
Y2hfcGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAlp
ZiAoYWRqdXN0ZWRfbW9kZS0+Y3J0Y19oZGlzcGxheSA9PSBjcnRjX3N0YXRlLT5waXBlX3NyY193
ICYmCiAJICAgIGFkanVzdGVkX21vZGUtPmNydGNfdmRpc3BsYXkgPT0gY3J0Y19zdGF0ZS0+cGlw
ZV9zcmNfaCAmJgogCSAgICBjcnRjX3N0YXRlLT5vdXRwdXRfZm9ybWF0ICE9IElOVEVMX09VVFBV
VF9GT1JNQVRfWUNCQ1I0MjApCi0JCXJldHVybjsKKwkJcmV0dXJuIDA7CiAKIAlzd2l0Y2ggKHNj
YWxpbmdfbW9kZSkgewogCWNhc2UgRFJNX01PREVfU0NBTEVfQ0VOVEVSOgpAQCAtMjM3LDcgKzIz
Niw3IEBAIGludGVsX3BjaF9wYW5lbF9maXR0aW5nKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLAogCiAJZGVmYXVsdDoKIAkJTUlTU0lOR19DQVNFKHNjYWxpbmdfbW9kZSk7Ci0J
CXJldHVybjsKKwkJcmV0dXJuIC1FSU5WQUw7CiAJfQogCiAJY3J0Y19zdGF0ZS0+cGNoX3BmaXQu
ZHN0LngxID0geDsKQEAgLTI0NSw2ICsyNDQsOCBAQCBpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAljcnRjX3N0YXRlLT5wY2hfcGZp
dC5kc3QueDIgPSB4ICsgd2lkdGg7CiAJY3J0Y19zdGF0ZS0+cGNoX3BmaXQuZHN0LnkyID0geSAr
IGhlaWdodDsKIAljcnRjX3N0YXRlLT5wY2hfcGZpdC5lbmFibGVkID0gdHJ1ZTsKKworCXJldHVy
biAwOwogfQogCiBzdGF0aWMgdm9pZApAQCAtMzgwLDggKzM4MSw4IEBAIHN0YXRpYyB2b2lkIGk5
eHhfc2NhbGVfYXNwZWN0KHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCX0K
IH0KIAotdm9pZCBpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUsCi0JCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0
ZSAqY29ubl9zdGF0ZSkKK2ludCBpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmcoc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCisJCQkgICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVj
dG9yX3N0YXRlICpjb25uX3N0YXRlKQogewogCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9f
aW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5kZXYpOwpAQCAtNDMxLDcgKzQzMiw3
IEBAIHZvaWQgaW50ZWxfZ21jaF9wYW5lbF9maXR0aW5nKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlLAogCQlicmVhazsKIAlkZWZhdWx0OgogCQlNSVNTSU5HX0NBU0Uoc2NhbGlu
Z19tb2RlKTsKLQkJcmV0dXJuOworCQlyZXR1cm4gLUVJTlZBTDsKIAl9CiAKIAkvKiA5NjUrIHdh
bnRzIGZ1enp5IGZpdHRpbmcgKi8KQEAgLTQ1Miw2ICs0NTMsOCBAQCB2b2lkIGludGVsX2dtY2hf
cGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAljcnRj
X3N0YXRlLT5nbWNoX3BmaXQuY29udHJvbCA9IHBmaXRfY29udHJvbDsKIAljcnRjX3N0YXRlLT5n
bWNoX3BmaXQucGdtX3JhdGlvcyA9IHBmaXRfcGdtX3JhdGlvczsKIAljcnRjX3N0YXRlLT5nbWNo
X3BmaXQubHZkc19ib3JkZXJfYml0cyA9IGJvcmRlcjsKKworCXJldHVybiAwOwogfQogCiAvKioK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuaCBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuaAppbmRleCBlMmZhMTU0
M2E2MWYuLmE1YzkzMjMyZWI2ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9wYW5lbC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfcGFuZWwuaApAQCAtMjUsMTAgKzI1LDEwIEBAIGludCBpbnRlbF9wYW5lbF9pbml0KHN0cnVj
dCBpbnRlbF9wYW5lbCAqcGFuZWwsCiB2b2lkIGludGVsX3BhbmVsX2Zpbmkoc3RydWN0IGludGVs
X3BhbmVsICpwYW5lbCk7CiB2b2lkIGludGVsX2ZpeGVkX3BhbmVsX21vZGUoY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKmZpeGVkX21vZGUsCiAJCQkgICAgc3RydWN0IGRybV9kaXNwbGF5
X21vZGUgKmFkanVzdGVkX21vZGUpOwotdm9pZCBpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKK2ludCBpbnRlbF9wY2hfcGFuZWxfZml0
dGluZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKKwkJCSAgICBjb25zdCBz
dHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSk7CitpbnQgaW50ZWxfZ21jaF9w
YW5lbF9maXR0aW5nKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJICAg
ICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSk7Ci12b2lkIGlu
dGVsX2dtY2hfcGFuZWxfZml0dGluZyhzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKLQkJCSAgICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRl
KTsKIHZvaWQgaW50ZWxfcGFuZWxfc2V0X2JhY2tsaWdodF9hY3BpKGNvbnN0IHN0cnVjdCBkcm1f
Y29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlLAogCQkJCSAgICB1MzIgbGV2ZWwsIHUzMiBtYXgp
OwogaW50IGludGVsX3BhbmVsX3NldHVwX2JhY2tsaWdodChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAq
Y29ubmVjdG9yLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS92bHZf
ZHNpLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L3Zsdl9kc2kuYwppbmRleCA5ZjRm
N2M2NzBjYzguLjdiMDAwN2ZhYTU3OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS92bHZfZHNpLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS92bHZf
ZHNpLmMKQEAgLTI3Miw5ICsyNzIsMTEgQEAgc3RhdGljIGludCBpbnRlbF9kc2lfY29tcHV0ZV9j
b25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCWludGVsX2ZpeGVkX3BhbmVs
X21vZGUoZml4ZWRfbW9kZSwgYWRqdXN0ZWRfbW9kZSk7CiAKIAkJaWYgKEhBU19HTUNIKGRldl9w
cml2KSkKLQkJCWludGVsX2dtY2hfcGFuZWxfZml0dGluZyhwaXBlX2NvbmZpZywgY29ubl9zdGF0
ZSk7CisJCQlyZXQgPSBpbnRlbF9nbWNoX3BhbmVsX2ZpdHRpbmcocGlwZV9jb25maWcsIGNvbm5f
c3RhdGUpOwogCQllbHNlCi0JCQlpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhwaXBlX2NvbmZpZywg
Y29ubl9zdGF0ZSk7CisJCQlyZXQgPSBpbnRlbF9wY2hfcGFuZWxfZml0dGluZyhwaXBlX2NvbmZp
ZywgY29ubl9zdGF0ZSk7CisJCWlmIChyZXQpCisJCQlyZXR1cm4gcmV0OwogCX0KIAogCWlmIChh
ZGp1c3RlZF9tb2RlLT5mbGFncyAmIERSTV9NT0RFX0ZMQUdfREJMU0NBTikKLS0gCjIuMjEuMAoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4
IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8E33D3D03F4
	for <lists+intel-gfx@lfdr.de>; Tue, 20 Jul 2021 23:40:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E5FC46E17B;
	Tue, 20 Jul 2021 21:40:19 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mail-yb1-xb30.google.com (mail-yb1-xb30.google.com
 [IPv6:2607:f8b0:4864:20::b30])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BD6CE6E17B
 for <intel-gfx@lists.freedesktop.org>; Tue, 20 Jul 2021 21:40:18 +0000 (UTC)
Received: by mail-yb1-xb30.google.com with SMTP id b13so513653ybk.4
 for <intel-gfx@lists.freedesktop.org>; Tue, 20 Jul 2021 14:40:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=jlekstrand-net.20150623.gappssmtp.com; s=20150623;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=TydgYjiDu+K9WfvEJ/2DPhuqw3bQdNqcRensimEeGxw=;
 b=Q8xPld+Y1yX0Vlg0bvRHZa5sF09GPquIBxKxvO2N4t6cviVIHkKF1X78O3F+3f/wOI
 abr9cb/XytUrQ5FUEfqCj+pQIPcjSV3n5bZcBU90oV0zAH0F4+cU2rcHFO3QJzwgNERZ
 VdbvrjVGELTsxUgL8Zmj0DPeCWSDseBxpRAWOV3przdCwTdNtBGMa/qNDqj/QWSOkfxe
 qBJ0dun/p22MPNQ2CD8RpN9uZJbYOLPj+KpeWkJNHsBE5uuP8kJhNW1im66Y7jUwZDof
 gEsqzApVdkjWWUvR+o++foR+XEYRrRjKG/zX77o2CEZMsD2N7JKDSGaQk/iBTyDBZViN
 d7nQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=TydgYjiDu+K9WfvEJ/2DPhuqw3bQdNqcRensimEeGxw=;
 b=mIOF+Cy5FNVGv92Dps07VYIQRQHWu/VUrSHVuo1MlIjquZhgk5DLeuyGd8Qyj5PkNv
 qJ3IT4MlB+EBTfy6tBaXS4YTkOlqyZIzn9uCIMs7yJqF18nbLHQzX+fG5+QTQ/s3VJlD
 F3O/E3/bd//k+LtQZM2V5DbhoHh0iXb+D0heGAwSon38BmYePf4CcXkgi+Zr+BFDyy3v
 Q2Vh+TI6qPXbAFjq+HdZBitmui6V7NXRs5UC8bH3uh+xU7pmo0KCaAL6cNzc2422jcAV
 854YzHHA3Uu1QjiwyB/rh4G22tbqWw/EfkIJeF+hgvWtL0fFEF42f73LJb80gRdFxLgL
 EUDQ==
X-Gm-Message-State: AOAM530BbrPVIoToETF0tsc2gMdM1Qwrlj8xwhsSnCk4m/K+MK6V8x11
 YJYTPq4s7bf5tIkJWC/FIPCY6B/Dvw/r7wAAUCboZg==
X-Google-Smtp-Source: ABdhPJwjOSFkfFHuZiw+9VR6/rBUfAxrMsnp7snlUFTbnetrRL6MiH0UKb1eKovCVGoxuNGXuaHsaFjR/rptNDhdku4=
X-Received: by 2002:a25:d113:: with SMTP id i19mr42997002ybg.180.1626817217624; 
 Tue, 20 Jul 2021 14:40:17 -0700 (PDT)
MIME-Version: 1.0
References: <20210716141426.1904528-1-jason@jlekstrand.net>
 <20210716141426.1904528-8-jason@jlekstrand.net>
 <CAM0jSHNqgEpt6cjm3yERyPFN8jXDiSi8zUfLM4PpZL3jroXsmQ@mail.gmail.com>
In-Reply-To: <CAM0jSHNqgEpt6cjm3yERyPFN8jXDiSi8zUfLM4PpZL3jroXsmQ@mail.gmail.com>
From: Jason Ekstrand <jason@jlekstrand.net>
Date: Tue, 20 Jul 2021 16:40:05 -0500
Message-ID: <CAOFGe97NTrBmzTiGM+7ygW0SrFNhLi_yh=ROiuE9uVDGTtvJDQ@mail.gmail.com>
To: Matthew Auld <matthew.william.auld@gmail.com>
Subject: Re: [Intel-gfx] [PATCH 7/7] drm/i915/gem: Migrate to system at
 dma-buf attach time (v6)
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: =?UTF-8?Q?Thomas_Hellstr=C3=B6m?= <thomas.hellstrom@linux.intel.com>,
 Intel Graphics Development <intel-gfx@lists.freedesktop.org>,
 ML dri-devel <dri-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Rml4ZWQgYWxsIHRoZSBuaXRzIGJlbG93IGxvY2FsbHkuICBJdCdsbCBiZSBpbiB0aGUgbmV4dCBz
ZW5kLgoKT24gVHVlLCBKdWwgMjAsIDIwMjEgYXQgNTo1MyBBTSBNYXR0aGV3IEF1bGQKPG1hdHRo
ZXcud2lsbGlhbS5hdWxkQGdtYWlsLmNvbT4gd3JvdGU6Cj4KPiBPbiBGcmksIDE2IEp1bCAyMDIx
IGF0IDE1OjE0LCBKYXNvbiBFa3N0cmFuZCA8amFzb25Aamxla3N0cmFuZC5uZXQ+IHdyb3RlOgo+
ID4KPiA+IEZyb206IFRob21hcyBIZWxsc3Ryw7ZtIDx0aG9tYXMuaGVsbHN0cm9tQGxpbnV4Lmlu
dGVsLmNvbT4KPiA+Cj4gPiBVbnRpbCB3ZSBzdXBwb3J0IHAycCBkbWEgb3IgYXMgYSBjb21wbGVt
ZW50IHRvIHRoYXQsIG1pZ3JhdGUgZGF0YQo+ID4gdG8gc3lzdGVtIG1lbW9yeSBhdCBkbWEtYnVm
IGF0dGFjaCB0aW1lIGlmIHBvc3NpYmxlLgo+ID4KPiA+IHYyOgo+ID4gLSBSZWJhc2Ugb24gZHlu
YW1pYyBleHBvcnRlci4gVXBkYXRlIHRoZSBpZ3RfZG1hYnVmX2ltcG9ydF9zYW1lX2RyaXZlcgo+
ID4gICBzZWxmdGVzdCB0byBtaWdyYXRlIGlmIHdlIGFyZSBMTUVNIGNhcGFibGUuCj4gPiB2MzoK
PiA+IC0gTWlncmF0ZSBhbHNvIGluIHRoZSBwaW4oKSBjYWxsYmFjay4KPiA+IHY0Ogo+ID4gLSBN
aWdyYXRlIGluIGF0dGFjaAo+ID4gdjU6IChqYXNvbikKPiA+IC0gTG9jayBhcm91bmQgdGhlIG1p
Z3JhdGlvbgo+ID4gdjY6IChqYXNvbikKPiA+IC0gTW92ZSB0aGUgY2FuX21pZ3JhdGUgY2hlY2sg
b3V0c2lkZSB0aGUgbG9jawo+ID4gLSBSZXdvcmsgdGhlIHNlbGZ0ZXN0cyB0byB0ZXN0IG1vcmUg
bWlncmF0aW9uIGNvbmRpdGlvbnMuICBJbgo+ID4gICBwYXJ0aWN1bGFyLCBTTUVNLCBMTUVNLCBh
bmQgTE1FTStTTUVNIGFyZSBhbGwgY2hlY2tlZC4KPiA+Cj4gPiBTaWduZWQtb2ZmLWJ5OiBUaG9t
YXMgSGVsbHN0csO2bSA8dGhvbWFzLmhlbGxzdHJvbUBsaW51eC5pbnRlbC5jb20+Cj4gPiBTaWdu
ZWQtb2ZmLWJ5OiBNaWNoYWVsIEouIFJ1aGwgPG1pY2hhZWwuai5ydWhsQGludGVsLmNvbT4KPiA+
IFJlcG9ydGVkLWJ5OiBrZXJuZWwgdGVzdCByb2JvdCA8bGtwQGludGVsLmNvbT4KPiA+IFNpZ25l
ZC1vZmYtYnk6IEphc29uIEVrc3RyYW5kIDxqYXNvbkBqbGVrc3RyYW5kLm5ldD4KPiA+IFJldmll
d2VkLWJ5OiBKYXNvbiBFa3N0cmFuZCA8amFzb25Aamxla3N0cmFuZC5uZXQ+Cj4gPiAtLS0KPiA+
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY3JlYXRlLmMgICAgfCAgMiArLQo+
ID4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kbWFidWYuYyAgICB8IDIzICsr
KystCj4gPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oICAgIHwg
IDQgKwo+ID4gIC4uLi9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2RtYWJ1Zi5jICB8
IDg5ICsrKysrKysrKysrKysrKysrKy0KPiA+ICA0IGZpbGVzIGNoYW5nZWQsIDExMiBpbnNlcnRp
b25zKCspLCA2IGRlbGV0aW9ucygtKQo+ID4KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fY3JlYXRlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fY3JlYXRlLmMKPiA+IGluZGV4IDAzOWU0ZjNiMzljNzkuLjQxYzRjZDNlMWVhMDEg
MTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY3JlYXRl
LmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jcmVhdGUuYwo+
ID4gQEAgLTgyLDcgKzgyLDcgQEAgc3RhdGljIGludCBpOTE1X2dlbV9wdWJsaXNoKHN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gPiAgICAgICAgIHJldHVybiAwOwo+ID4gIH0KPiA+
Cj4gPiAtc3RhdGljIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICoKPiA+ICtzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqCj4gPiAgaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV91c2VyKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LCB1NjQgc2l6ZSwKPiA+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgaW50ZWxfbWVtb3J5X3JlZ2lvbiAqKnBsYWNlbWVudHMsCj4gPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG5fcGxhY2VtZW50cykKPiA+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG1hYnVmLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG1hYnVmLmMKPiA+IGluZGV4IDlh
NjU1ZjY5YTA2NzEuLjVkNDM4Yjk1ODI2YjkgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fZG1hYnVmLmMKPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9kbWFidWYuYwo+ID4gQEAgLTE3MCw4ICsxNzAsMjkgQEAgc3RhdGlj
IGludCBpOTE1X2dlbV9kbWFidWZfYXR0YWNoKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsCj4gPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRtYV9idWZfYXR0YWNobWVu
dCAqYXR0YWNoKQo+ID4gIHsKPiA+ICAgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaiA9IGRtYV9idWZfdG9fb2JqKGRtYWJ1Zik7Cj4gPiArICAgICAgIHN0cnVjdCBpOTE1X2dl
bV93d19jdHggd3c7Cj4gPiArICAgICAgIGludCBlcnI7Cj4gPiArCj4gPiArICAgICAgIGlmICgh
aTkxNV9nZW1fb2JqZWN0X2Nhbl9taWdyYXRlKG9iaiwgSU5URUxfUkVHSU9OX1NNRU0pKQo+ID4g
KyAgICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsKPiA+ICsKPiA+ICsgICAgICAgZm9y
X2k5MTVfZ2VtX3d3KCZ3dywgZXJyLCB0cnVlKSB7Cj4gPiArICAgICAgICAgICAgICAgZXJyID0g
aTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqLCAmd3cpOwo+ID4gKyAgICAgICAgICAgICAgIGlmIChl
cnIpCj4gPiArICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPiA+ICsKPiA+ICsgICAg
ICAgICAgICAgICBlcnIgPSBpOTE1X2dlbV9vYmplY3RfbWlncmF0ZShvYmosICZ3dywgSU5URUxf
UkVHSU9OX1NNRU0pOwo+ID4gKyAgICAgICAgICAgICAgIGlmIChlcnIpCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgICBjb250aW51ZTsKPiA+Cj4gPiAtICAgICAgIHJldHVybiBpOTE1X2dlbV9v
YmplY3RfcGluX3BhZ2VzX3VubG9ja2VkKG9iaik7Cj4gPiArICAgICAgICAgICAgICAgZXJyID0g
aTkxNV9nZW1fb2JqZWN0X3dhaXRfbWlncmF0aW9uKG9iaiwgMCk7Cj4gPiArICAgICAgICAgICAg
ICAgaWYgKGVycikKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+ID4gKwo+
ID4gKyAgICAgICAgICAgICAgIGVyciA9IGk5MTVfZ2VtX29iamVjdF9waW5fcGFnZXMob2JqKTsK
PiA+ICsgICAgICAgfQo+ID4gKwo+ID4gKyAgICAgICByZXR1cm4gZXJyOwo+ID4gIH0KPiA+Cj4g
PiAgc3RhdGljIHZvaWQgaTkxNV9nZW1fZG1hYnVmX2RldGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1h
YnVmLAo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9v
YmplY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaAo+ID4g
aW5kZXggOGJlNGZhZGVlZTQ4Ny4uZmJhZTUzYmQ0NjM4NCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaAo+ID4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCj4gPiBAQCAtNjEsNiArNjEsMTAgQEAg
aTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKPiA+ICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqCj4gPiAgaTkxNV9nZW1fb2JqZWN0
X2NyZWF0ZV9zaG1lbV9mcm9tX2RhdGEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCj4g
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2b2lkICpkYXRh
LCByZXNvdXJjZV9zaXplX3Qgc2l6ZSk7Cj4gPiArc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Kgo+ID4gK2k5MTVfZ2VtX29iamVjdF9jcmVhdGVfdXNlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwgdTY0IHNpemUsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IGludGVsX21lbW9yeV9yZWdpb24gKipwbGFjZW1lbnRzLAo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHVuc2lnbmVkIGludCBuX3BsYWNlbWVudHMpOwo+ID4KPiA+ICBleHRlcm4gY29u
c3Qgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Rfb3BzIGk5MTVfZ2VtX3NobWVtX29wczsKPiA+
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1
X2dlbV9kbWFidWYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9n
ZW1fZG1hYnVmLmMKPiA+IGluZGV4IDQ0NTFiYmI0OTE3ZTQuLjdiNzY0N2U3ZTIyMGEgMTAwNjQ0
Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2Rt
YWJ1Zi5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVf
Z2VtX2RtYWJ1Zi5jCj4gPiBAQCAtODUsOSArODUsNjIgQEAgc3RhdGljIGludCBpZ3RfZG1hYnVm
X2ltcG9ydF9zZWxmKHZvaWQgKmFyZykKPiA+ICAgICAgICAgcmV0dXJuIGVycjsKPiA+ICB9Cj4g
Pgo+ID4gLXN0YXRpYyBpbnQgaWd0X2RtYWJ1Zl9pbXBvcnRfc2FtZV9kcml2ZXIodm9pZCAqYXJn
KQo+ID4gK3N0YXRpYyBpbnQgaWd0X2RtYWJ1Zl9pbXBvcnRfc2FtZV9kcml2ZXJfbG1lbSh2b2lk
ICphcmcpCj4gPiAgewo+ID4gICAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IGFyZzsKPiA+ICsgICAgICAgc3RydWN0IGludGVsX21lbW9yeV9yZWdpb24gKmxtZW0gPSBpOTE1
LT5tbS5yZWdpb25zW0lOVEVMX1JFR0lPTl9MTUVNXTsKPiA+ICsgICAgICAgc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iajsKPiA+ICsgICAgICAgc3RydWN0IGRybV9nZW1fb2JqZWN0ICpp
bXBvcnQ7Cj4gPiArICAgICAgIHN0cnVjdCBkbWFfYnVmICpkbWFidWY7Cj4gPiArICAgICAgIGlu
dCBlcnI7Cj4gPiArCj4gPiArICAgICAgIGlmICghaTkxNS0+bW0ucmVnaW9uc1tJTlRFTF9SRUdJ
T05fTE1FTV0pCj4KPiAhbG1lbQo+Cj4gPiArICAgICAgICAgICAgICAgcmV0dXJuIDA7Cj4gPiAr
Cj4gPiArICAgICAgIGZvcmNlX2RpZmZlcmVudF9kZXZpY2VzID0gdHJ1ZTsKPiA+ICsKPiA+ICsg
ICAgICAgb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV91c2VyKGk5MTUsIFBBR0VfU0laRSwg
JmxtZW0sIDEpOwo+ID4gKyAgICAgICBpZiAoSVNfRVJSKG9iaikpIHsKPiA+ICsgICAgICAgICAg
ICAgICBwcl9lcnIoImk5MTVfZ2VtX29iamVjdF9jcmVhdGVfdXNlciBmYWlsZWQgd2l0aCBlcnI9
JWRcbiIsCj4gPiArICAgICAgICAgICAgICAgICAgICAgIChpbnQpUFRSX0VSUihkbWFidWYpKTsK
Pgo+IFBUUl9FUlIob2JqKQo+Cj4gPiArICAgICAgICAgICAgICAgZXJyID0gUFRSX0VSUihvYmop
Owo+ID4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0X3JldDsKPiA+ICsgICAgICAgfQo+ID4gKwo+
ID4gKyAgICAgICBkbWFidWYgPSBpOTE1X2dlbV9wcmltZV9leHBvcnQoJm9iai0+YmFzZSwgMCk7
Cj4gPiArICAgICAgIGlmIChJU19FUlIoZG1hYnVmKSkgewo+ID4gKyAgICAgICAgICAgICAgIHBy
X2VycigiaTkxNV9nZW1fcHJpbWVfZXhwb3J0IGZhaWxlZCB3aXRoIGVycj0lZFxuIiwKPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgKGludClQVFJfRVJSKGRtYWJ1ZikpOwo+ID4gKyAgICAgICAg
ICAgICAgIGVyciA9IFBUUl9FUlIoZG1hYnVmKTsKPiA+ICsgICAgICAgICAgICAgICBnb3RvIG91
dDsKPiA+ICsgICAgICAgfQo+ID4gKwo+ID4gKyAgICAgICAvKiBXZSBleHBlY3QgYW4gaW1wb3J0
IG9mIGFuIExNRU0tb25seSBvYmplY3QgdG8gZmFpbCB3aXRoCj4gPiArICAgICAgICAqIC1FT1BO
T1RTVVBQIGJlY2F1c2UgaXQgY2FuJ3QgYmUgbWlncmF0ZWQgdG8gU01FTS4KPiA+ICsgICAgICAg
ICovCj4KPiAvKgo+ICAqIFdlIGV4cGVjdC4uLgo+ICAqLwo+Cj4gPiArICAgICAgIGltcG9ydCA9
IGk5MTVfZ2VtX3ByaW1lX2ltcG9ydCgmaTkxNS0+ZHJtLCBkbWFidWYpOwo+ID4gKyAgICAgICBp
ZiAoIUlTX0VSUihpbXBvcnQpKSB7Cj4gPiArICAgICAgICAgICAgICAgZHJtX2dlbV9vYmplY3Rf
cHV0KGltcG9ydCk7Cj4gPiArICAgICAgICAgICAgICAgcHJfZXJyKCJpOTE1X2dlbV9wcmltZV9p
bXBvcnQgc3VjY2VlZGVkIHdoZW4gaXQgc2hvdWxkbid0IGhhdmVcbiIpOwo+ID4gKyAgICAgICAg
ICAgICAgIGVyciA9IC1FSU5WQUw7Cj4gPiArICAgICAgIH0gZWxzZSBpZiAoUFRSX0VSUihpbXBv
cnQpICE9IC1FT1BOT1RTVVBQKSB7Cj4gPiArICAgICAgICAgICAgICAgcHJfZXJyKCJpOTE1X2dl
bV9wcmltZV9pbXBvcnQgZmFpbGVkIHdpdGggdGhlIHdyb25nIGVycj0lZFxuIiwKPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgKGludClQVFJfRVJSKGltcG9ydCkpOwo+ID4gKyAgICAgICAgICAg
ICAgIGVyciA9IFBUUl9FUlIoaW1wb3J0KTsKPiA+ICsgICAgICAgfQo+ID4gKwo+ID4gKyAgICAg
ICBkbWFfYnVmX3B1dChkbWFidWYpOwo+ID4gK291dDoKPiA+ICsgICAgICAgaTkxNV9nZW1fb2Jq
ZWN0X3B1dChvYmopOwo+ID4gK291dF9yZXQ6Cj4gPiArICAgICAgIGZvcmNlX2RpZmZlcmVudF9k
ZXZpY2VzID0gZmFsc2U7Cj4gPiArICAgICAgIHJldHVybiBlcnI7Cj4gPiArfQo+ID4gKwo+ID4g
K3N0YXRpYyBpbnQgaWd0X2RtYWJ1Zl9pbXBvcnRfc2FtZV9kcml2ZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0cnVjdCBpbnRlbF9tZW1vcnlfcmVnaW9uICoqcmVnaW9ucywKPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG51bV9yZWdpb25zKQo+
ID4gK3sKPiA+ICAgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwgKmltcG9y
dF9vYmo7Cj4gPiAgICAgICAgIHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqaW1wb3J0Owo+ID4gICAg
ICAgICBzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmOwo+ID4gQEAgLTk3LDkgKzE1MCwxNSBAQCBzdGF0
aWMgaW50IGlndF9kbWFidWZfaW1wb3J0X3NhbWVfZHJpdmVyKHZvaWQgKmFyZykKPiA+ICAgICAg
ICAgaW50IGVycjsKPiA+Cj4gPiAgICAgICAgIGZvcmNlX2RpZmZlcmVudF9kZXZpY2VzID0gdHJ1
ZTsKPiA+IC0gICAgICAgb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zaG1lbShpOTE1LCBQ
QUdFX1NJWkUpOwo+ID4gLSAgICAgICBpZiAoSVNfRVJSKG9iaikpCj4gPiArCj4gPiArICAgICAg
IG9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfdXNlcihpOTE1LCBQQUdFX1NJWkUsCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWdpb25zLCBudW1fcmVn
aW9ucyk7Cj4gPiArICAgICAgIGlmIChJU19FUlIob2JqKSkgewo+ID4gKyAgICAgICAgICAgICAg
IHByX2VycigiaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV91c2VyIGZhaWxlZCB3aXRoIGVycj0lZFxu
IiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgKGludClQVFJfRVJSKGRtYWJ1ZikpOwo+Cj4g
UFRSX0VSUihvYmopCj4KPiA+ICsgICAgICAgICAgICAgICBlcnIgPSBQVFJfRVJSKG9iaik7Cj4g
PiAgICAgICAgICAgICAgICAgZ290byBvdXRfcmV0Owo+ID4gKyAgICAgICB9Cj4gPgo+ID4gICAg
ICAgICBkbWFidWYgPSBpOTE1X2dlbV9wcmltZV9leHBvcnQoJm9iai0+YmFzZSwgMCk7Cj4gPiAg
ICAgICAgIGlmIChJU19FUlIoZG1hYnVmKSkgewo+ID4gQEAgLTE3NCw2ICsyMzMsMjYgQEAgc3Rh
dGljIGludCBpZ3RfZG1hYnVmX2ltcG9ydF9zYW1lX2RyaXZlcih2b2lkICphcmcpCj4gPiAgICAg
ICAgIHJldHVybiBlcnI7Cj4gPiAgfQo+ID4KPiA+ICtzdGF0aWMgaW50IGlndF9kbWFidWZfaW1w
b3J0X3NhbWVfZHJpdmVyX3NtZW0odm9pZCAqYXJnKQo+ID4gK3sKPiA+ICsgICAgICAgc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBhcmc7Cj4gPiArICAgICAgIHN0cnVjdCBpbnRlbF9t
ZW1vcnlfcmVnaW9uICpzbWVtID0gaTkxNS0+bW0ucmVnaW9uc1tJTlRFTF9SRUdJT05fU01FTV07
Cj4KPiBOZXdsaW5lLgo+Cj4gPiArICAgICAgIHJldHVybiBpZ3RfZG1hYnVmX2ltcG9ydF9zYW1l
X2RyaXZlcihpOTE1LCAmc21lbSwgMSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgaWd0
X2RtYWJ1Zl9pbXBvcnRfc2FtZV9kcml2ZXJfbG1lbV9zbWVtKHZvaWQgKmFyZykKPiA+ICt7Cj4g
PiArICAgICAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwo+ID4gKyAgICAg
ICBzdHJ1Y3QgaW50ZWxfbWVtb3J5X3JlZ2lvbiAqcmVnaW9uc1syXTsKPiA+ICsKPiA+ICsgICAg
ICAgaWYgKCFpOTE1LT5tbS5yZWdpb25zW0lOVEVMX1JFR0lPTl9MTUVNXSkKPiA+ICsgICAgICAg
ICAgICAgICByZXR1cm4gMDsKPiA+ICsKPiA+ICsgICAgICAgcmVnaW9uc1swXSA9IGk5MTUtPm1t
LnJlZ2lvbnNbSU5URUxfUkVHSU9OX0xNRU1dOwo+ID4gKyAgICAgICByZWdpb25zWzFdID0gaTkx
NS0+bW0ucmVnaW9uc1tJTlRFTF9SRUdJT05fU01FTV07Cj4gPiArICAgICAgIHJldHVybiBpZ3Rf
ZG1hYnVmX2ltcG9ydF9zYW1lX2RyaXZlcihpOTE1LCByZWdpb25zLCAyKTsKPiA+ICt9Cj4gPiAr
Cj4gPiAgc3RhdGljIGludCBpZ3RfZG1hYnVmX2ltcG9ydCh2b2lkICphcmcpCj4gPiAgewo+ID4g
ICAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKPiA+IEBAIC0zODQs
NyArNDYzLDkgQEAgaW50IGk5MTVfZ2VtX2RtYWJ1Zl9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiA+ICB7Cj4gPiAgICAgICAgIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7Cj4gPiAgICAgICAgICAgICAgICAgU1VCVEVTVChp
Z3RfZG1hYnVmX2V4cG9ydCksCj4gPiAtICAgICAgICAgICAgICAgU1VCVEVTVChpZ3RfZG1hYnVm
X2ltcG9ydF9zYW1lX2RyaXZlciksCj4gPiArICAgICAgICAgICAgICAgU1VCVEVTVChpZ3RfZG1h
YnVmX2ltcG9ydF9zYW1lX2RyaXZlcl9sbWVtKSwKPiA+ICsgICAgICAgICAgICAgICBTVUJURVNU
KGlndF9kbWFidWZfaW1wb3J0X3NhbWVfZHJpdmVyX3NtZW0pLAo+ID4gKyAgICAgICAgICAgICAg
IFNVQlRFU1QoaWd0X2RtYWJ1Zl9pbXBvcnRfc2FtZV9kcml2ZXJfbG1lbV9zbWVtKSwKPiA+ICAg
ICAgICAgfTsKPiA+Cj4gPiAgICAgICAgIHJldHVybiBpOTE1X3N1YnRlc3RzKHRlc3RzLCBpOTE1
KTsKPiA+IC0tCj4gPiAyLjMxLjEKPiA+Cj4gPiBfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwo+ID4gSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdAo+ID4gSW50ZWwt
Z2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+ID4gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vaW50ZWwtZ2Z4Cg==

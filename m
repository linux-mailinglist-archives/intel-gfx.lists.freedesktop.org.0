Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 2FC39DD7E5
	for <lists+intel-gfx@lfdr.de>; Sat, 19 Oct 2019 12:05:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B438F89D7F;
	Sat, 19 Oct 2019 10:05:11 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B028F89D7D
 for <intel-gfx@lists.freedesktop.org>; Sat, 19 Oct 2019 10:05:09 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18893442-1500050 
 for multiple; Sat, 19 Oct 2019 11:04:41 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sat, 19 Oct 2019 11:04:39 +0100
Message-Id: <20191019100439.24640-3-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc0
In-Reply-To: <20191019100439.24640-1-chris@chris-wilson.co.uk>
References: <20191019100439.24640-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 3/3] i915: Exercise timeslice sysfs
 property
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2UgW3dpbGxdIGV4cG9zZSB2YXJpb3VzIHBlci1lbmdpbmUgc2NoZWR1bGluZyBjb250cm9scy4g
T25lIG9mIHdoaWNoLAondGltZXNsaWNlX2R1cmF0aW9uX21zJywgZGVmaW5lcyB0aGUgc2NoZWR1
bGluZyBxdWFudHVtLiBJZiBhIGNvbnRleHQKZXhoYXVzdHMgaXRzIHRpbWVzbGljZSwgaXQgd2ls
bCBiZSBwcmVlbXB0ZWQgaW4gZmF2b3VyIG9mIHJ1bm5pbmcgb25lIG9mCml0cyBjb21wYXRyaW90
cy4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVr
PgotLS0KIHRlc3RzL01ha2VmaWxlLnNvdXJjZXMgICAgICAgICAgICAgICAgfCAgIDEgKwogdGVz
dHMvaTkxNS9zeXNmc190aW1lc2xpY2VfZHVyYXRpb24uYyB8IDMxMCArKysrKysrKysrKysrKysr
KysrKysrKysrKwogdGVzdHMvbWVzb24uYnVpbGQgICAgICAgICAgICAgICAgICAgICB8ICAgMSAr
CiAzIGZpbGVzIGNoYW5nZWQsIDMxMiBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQg
dGVzdHMvaTkxNS9zeXNmc190aW1lc2xpY2VfZHVyYXRpb24uYwoKZGlmZiAtLWdpdCBhL3Rlc3Rz
L01ha2VmaWxlLnNvdXJjZXMgYi90ZXN0cy9NYWtlZmlsZS5zb3VyY2VzCmluZGV4IDQ0OTRkMmMw
NS4uOWJmZTIxNGQ3IDEwMDY0NAotLS0gYS90ZXN0cy9NYWtlZmlsZS5zb3VyY2VzCisrKyBiL3Rl
c3RzL01ha2VmaWxlLnNvdXJjZXMKQEAgLTEwMCw2ICsxMDAsNyBAQCBURVNUU19wcm9ncyA9IFwK
IAl2Z2VtX3Nsb3cgXAogCWk5MTUvc3lzZnNfaGVhcnRiZWF0X2ludGVydmFsIFwKIAlpOTE1L3N5
c2ZzX3ByZWVtcHRpb25fdGltZW91dCBcCisJaTkxNS9zeXNmc190aW1lc2xpY2VfZHVyYXRpb24g
XAogCSQoTlVMTCkKIAogVEVTVFNfcHJvZ3MgKz0gZ2VtX2JhZF9yZWxvYwpkaWZmIC0tZ2l0IGEv
dGVzdHMvaTkxNS9zeXNmc190aW1lc2xpY2VfZHVyYXRpb24uYyBiL3Rlc3RzL2k5MTUvc3lzZnNf
dGltZXNsaWNlX2R1cmF0aW9uLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAw
Li40YzcyNTkyM2IKLS0tIC9kZXYvbnVsbAorKysgYi90ZXN0cy9pOTE1L3N5c2ZzX3RpbWVzbGlj
ZV9kdXJhdGlvbi5jCkBAIC0wLDAgKzEsMzEwIEBACisvKgorICogQ29weXJpZ2h0IMKpIDIwMTkg
SW50ZWwgQ29ycG9yYXRpb24KKyAqCisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBm
cmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQorICogY29weSBvZiB0aGlz
IHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdh
cmUiKSwKKyAqIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGlu
Y2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24KKyAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBt
b2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLAorICogYW5kL29y
IHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdo
b20gdGhlCisgKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhl
IGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNl
IGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIChpbmNsdWRpbmcgdGhlIG5leHQKKyAqIHBhcmFn
cmFwaCkgc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0
aW9ucyBvZiB0aGUKKyAqIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURF
RCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCisgKiBJ
TVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1F
UkNIQU5UQUJJTElUWSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBO
T05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTAorICogVEhFIEFVVEhPUlMgT1IgQ09Q
WVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIK
KyAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Ig
T1RIRVJXSVNFLCBBUklTSU5HCisgKiBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRI
IFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTCisgKiBJTiBUSEUgU09G
VFdBUkUuCisgKi8KKworI2luY2x1ZGUgPGRpcmVudC5oPgorI2luY2x1ZGUgPGVycm5vLmg+Cisj
aW5jbHVkZSA8ZmNudGwuaD4KKyNpbmNsdWRlIDxpbnR0eXBlcy5oPgorI2luY2x1ZGUgPHN5cy9z
dGF0Lmg+CisjaW5jbHVkZSA8c3lzL3R5cGVzLmg+CisjaW5jbHVkZSA8dW5pc3RkLmg+CisKKyNp
bmNsdWRlICJkcm10ZXN0LmgiIC8qIGdlbV9xdWllc2NlbnRfZ3B1KCkhICovCisjaW5jbHVkZSAi
aTkxNS9nZW1fZW5naW5lX3RvcG9sb2d5LmgiCisjaW5jbHVkZSAiaWd0X2R1bW15bG9hZC5oIgor
I2luY2x1ZGUgImlndF9zeXNmcy5oIgorI2luY2x1ZGUgImlvY3RsX3dyYXBwZXJzLmgiIC8qIGln
dF9yZXF1aXJlX2dlbSgpISAqLworI2luY2x1ZGUgInN3X3N5bmMuaCIKKworI2luY2x1ZGUgImln
dF9kZWJ1Z2ZzLmgiCisKK3N0YXRpYyBib29sIF9fZW5hYmxlX2hhbmdjaGVjayhpbnQgZGlyLCBi
b29sIHN0YXRlKQoreworCXJldHVybiBpZ3Rfc3lzZnNfc2V0KGRpciwgImVuYWJsZV9oYW5nY2hl
Y2siLCBzdGF0ZSA/ICIxIiA6ICIwIik7Cit9CisKK3N0YXRpYyBib29sIGVuYWJsZV9oYW5nY2hl
Y2soaW50IGk5MTUsIGJvb2wgc3RhdGUpCit7CisJYm9vbCBzdWNjZXNzOworCWludCBkaXI7CisK
KwlkaXIgPSBpZ3Rfc3lzZnNfb3Blbl9wYXJhbWV0ZXJzKGk5MTUpOworCWlmIChkaXIgPCAwKSAv
KiBubyBwYXJhbWV0ZXJzLCBtdXN0IGJlIGRlZmF1bHQhICovCisJCXJldHVybiBmYWxzZTsKKwor
CXN1Y2Nlc3MgPSBfX2VuYWJsZV9oYW5nY2hlY2soZGlyLCBzdGF0ZSk7CisJY2xvc2UoZGlyKTsK
KworCXJldHVybiBzdWNjZXNzOworfQorCitzdGF0aWMgdm9pZCBzZXRfdGltZXNsaWNlKGludCBl
bmdpbmUsIHVuc2lnbmVkIGludCB2YWx1ZSkKK3sKKwl1bnNpZ25lZCBpbnQgZGVsYXk7CisKKwlp
Z3Rfc3lzZnNfcHJpbnRmKGVuZ2luZSwgInRpbWVzbGljZV9kdXJhdGlvbl9tcyIsICIldSIsIHZh
bHVlKTsKKwlpZ3Rfc3lzZnNfc2NhbmYoZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9uX21zIiwg
IiV1IiwgJmRlbGF5KTsKKwlpZ3RfYXNzZXJ0X2VxKGRlbGF5LCB2YWx1ZSk7Cit9CisKK3N0YXRp
YyB2b2lkIHRlc3RfaWRlbXBvdGVudChpbnQgaTkxNSwgaW50IGVuZ2luZSkKK3sKKwljb25zdCB1
bnNpZ25lZCBpbnQgZGVsYXlzW10gPSB7IDAsIDEsIDEyMzQsIDY1NDMyMSB9OworCXVuc2lnbmVk
IGludCBzYXZlZDsKKworCWlndF9hc3NlcnQoaWd0X3N5c2ZzX3NjYW5mKGVuZ2luZSwgInRpbWVz
bGljZV9kdXJhdGlvbl9tcyIsICIldSIsICZzYXZlZCkgPT0gMSk7CisJaWd0X2RlYnVnKCJJbml0
aWFsIHRpbWVzbGljZV9kdXJhdGlvbl9tczoldVxuIiwgc2F2ZWQpOworCisJZm9yIChpbnQgaSA9
IDA7IGkgPCBBUlJBWV9TSVpFKGRlbGF5cyk7IGkrKykKKwkJc2V0X3RpbWVzbGljZShlbmdpbmUs
IGRlbGF5c1tpXSk7CisKKwlzZXRfdGltZXNsaWNlKGVuZ2luZSwgc2F2ZWQpOworfQorCitzdGF0
aWMgdm9pZCB0ZXN0X2ludmFsaWQoaW50IGk5MTUsIGludCBlbmdpbmUpCit7CisJdW5zaWduZWQg
aW50IHNhdmVkLCBkZWxheTsKKworCWlndF9hc3NlcnQoaWd0X3N5c2ZzX3NjYW5mKGVuZ2luZSwg
InRpbWVzbGljZV9kdXJhdGlvbl9tcyIsICIldSIsICZzYXZlZCkgPT0gMSk7CisJaWd0X2RlYnVn
KCJJbml0aWFsIHRpbWVzbGljZV9kdXJhdGlvbl9tczoldVxuIiwgc2F2ZWQpOworCisJaWd0X3N5
c2ZzX3ByaW50ZihlbmdpbmUsICJ0aW1lc2xpY2VfZHVyYXRpb25fbXMiLCBQUkl1NjQsIC0xKTsK
KwlpZ3Rfc3lzZnNfc2NhbmYoZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9uX21zIiwgIiV1Iiwg
JmRlbGF5KTsKKwlpZ3RfYXNzZXJ0X2VxKGRlbGF5LCBzYXZlZCk7CisKKwlpZ3Rfc3lzZnNfcHJp
bnRmKGVuZ2luZSwgInRpbWVzbGljZV9kdXJhdGlvbl9tcyIsICIlZCIsIC0xKTsKKwlpZ3Rfc3lz
ZnNfc2NhbmYoZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9uX21zIiwgIiV1IiwgJmRlbGF5KTsK
KwlpZ3RfYXNzZXJ0X2VxKGRlbGF5LCBzYXZlZCk7CisKKwlpZ3Rfc3lzZnNfcHJpbnRmKGVuZ2lu
ZSwgInRpbWVzbGljZV9kdXJhdGlvbl9tcyIsIFBSSXU2NCwgMTIzdWxsIDw8IDMyKTsKKwlpZ3Rf
c3lzZnNfc2NhbmYoZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9uX21zIiwgIiV1IiwgJmRlbGF5
KTsKKwlpZ3RfYXNzZXJ0X2VxKGRlbGF5LCBzYXZlZCk7Cit9CisKK3N0YXRpYyB2b2lkIHNldF91
bmJhbm5hYmxlKGludCBpOTE1LCB1aW50MzJfdCBjdHgpCit7CisJc3RydWN0IGRybV9pOTE1X2dl
bV9jb250ZXh0X3BhcmFtIHAgPSB7CisJCS5jdHhfaWQgPSBjdHgsCisJCS5wYXJhbSA9IEk5MTVf
Q09OVEVYVF9QQVJBTV9CQU5OQUJMRSwKKwl9OworCisJaWd0X2Fzc2VydF9lcShfX2dlbV9jb250
ZXh0X3NldF9wYXJhbShpOTE1LCAmcCksIDApOworfQorCitzdGF0aWMgdWludDMyX3QgY3JlYXRl
X2NvbnRleHQoaW50IGk5MTUsIHVuc2lnbmVkIGludCBjbGFzcywgdW5zaWduZWQgaW50IGluc3Qs
IGludCBwcmlvKQoreworCXVpbnQzMl90IGN0eDsKKworCWN0eCA9IGdlbV9jb250ZXh0X2NyZWF0
ZV9mb3JfZW5naW5lKGk5MTUsIGNsYXNzLCBpbnN0KTsKKwlzZXRfdW5iYW5uYWJsZShpOTE1LCBj
dHgpOworCWdlbV9jb250ZXh0X3NldF9wcmlvcml0eShpOTE1LCBjdHgsIHByaW8pOworCisJcmV0
dXJuIGN0eDsKK30KKworc3RhdGljIHVpbnQ2NF90IF9fdGVzdF90aW1lb3V0KGludCBpOTE1LCBp
bnQgZW5naW5lLCB1bnNpZ25lZCBpbnQgdGltZW91dCkKK3sKKwl1bnNpZ25lZCBpbnQgY2xhc3Ms
IGluc3Q7CisJc3RydWN0IHRpbWVzcGVjIHRzID0ge307CisJaWd0X3NwaW5fdCAqc3BpblsyXTsK
Kwl1aW50NjRfdCBlbGFwc2VkOworCXVpbnQzMl90IGN0eFsyXTsKKworCWlndF9hc3NlcnQoaWd0
X3N5c2ZzX3NjYW5mKGVuZ2luZSwgImNsYXNzIiwgIiV1IiwgJmNsYXNzKSA9PSAxKTsKKwlpZ3Rf
YXNzZXJ0KGlndF9zeXNmc19zY2FuZihlbmdpbmUsICJpbnN0YW5jZSIsICIldSIsICZpbnN0KSA9
PSAxKTsKKworCWlndF9zeXNmc19wcmludGYoZW5naW5lLCAidGltZXNsaWNlX2R1cmF0aW9uX21z
IiwgIiV1IiwgdGltZW91dCk7CisKKwljdHhbMF0gPSBjcmVhdGVfY29udGV4dChpOTE1LCBjbGFz
cywgaW5zdCwgMCk7CisJc3BpblswXSA9IGlndF9zcGluX25ldyhpOTE1LCBjdHhbMF0sCisJCQkg
ICAgICAgLmZsYWdzID0gKElHVF9TUElOX05PX1BSRUVNUFRJT04gfAorCQkJCQkgSUdUX1NQSU5f
UE9MTF9SVU4gfAorCQkJCQkgSUdUX1NQSU5fRkVOQ0VfT1VUKSk7CisJaWd0X3NwaW5fYnVzeXdh
aXRfdW50aWxfc3RhcnRlZChzcGluWzBdKTsKKworCWN0eFsxXSA9IGNyZWF0ZV9jb250ZXh0KGk5
MTUsIGNsYXNzLCBpbnN0LCAwKTsKKwlpZ3RfbnNlY19lbGFwc2VkKCZ0cyk7CisJc3BpblsxXSA9
IGlndF9zcGluX25ldyhpOTE1LCBjdHhbMV0sIC5mbGFncyA9IElHVF9TUElOX1BPTExfUlVOKTsK
KwlpZ3Rfc3Bpbl9idXN5d2FpdF91bnRpbF9zdGFydGVkKHNwaW5bMV0pOworCWVsYXBzZWQgPSBp
Z3RfbnNlY19lbGFwc2VkKCZ0cyk7CisKKwlpZ3Rfc3Bpbl9mcmVlKGk5MTUsIHNwaW5bMV0pOwor
CisJaWd0X2Fzc2VydF9lcShzeW5jX2ZlbmNlX3dhaXQoc3BpblswXS0+b3V0X2ZlbmNlLCAxKSwg
MCk7CisJaWd0X2Fzc2VydF9lcShzeW5jX2ZlbmNlX3N0YXR1cyhzcGluWzBdLT5vdXRfZmVuY2Up
LCAtRUlPKTsKKworCWlndF9zcGluX2ZyZWUoaTkxNSwgc3BpblswXSk7CisKKwlnZW1fY29udGV4
dF9kZXN0cm95KGk5MTUsIGN0eFsxXSk7CisJZ2VtX2NvbnRleHRfZGVzdHJveShpOTE1LCBjdHhb
MF0pOworCWdlbV9xdWllc2NlbnRfZ3B1KGk5MTUpOworCisJcmV0dXJuIGVsYXBzZWQ7Cit9CisK
K3N0YXRpYyB2b2lkIHRlc3RfdGltZW91dChpbnQgaTkxNSwgaW50IGVuZ2luZSkKK3sKKwlpbnQg
ZGVsYXlzW10gPSB7IDEsIDUwLCAxMDAsIDUwMCB9OworCXVuc2lnbmVkIGludCBzYXZlZDsKKwor
CWlndF9yZXF1aXJlKGlndF9zeXNmc19wcmludGYoZW5naW5lLCAicHJlZW1wdF90aW1lb3V0X21z
IiwgIiV1IiwgMSkgPT0gMSk7CisJaWd0X2Fzc2VydChpZ3Rfc3lzZnNfc2NhbmYoZW5naW5lLCAi
dGltZXNsaWNlX2R1cmF0aW9uX21zIiwgIiV1IiwgJnNhdmVkKSA9PSAxKTsKKwlpZ3RfZGVidWco
IkluaXRpYWwgdGltZXNsaWNlX2R1cmF0aW9uX21zOiV1XG4iLCBzYXZlZCk7CisKKwlnZW1fcXVp
ZXNjZW50X2dwdShpOTE1KTsKKwlpZ3RfcmVxdWlyZShlbmFibGVfaGFuZ2NoZWNrKGk5MTUsIGZh
bHNlKSk7CisKKwlmb3IgKGludCBpID0gMDsgaSA8IEFSUkFZX1NJWkUoZGVsYXlzKTsgaSsrKSB7
CisJCXVpbnQ2NF90IGVsYXBzZWQ7CisKKwkJZWxhcHNlZCA9IF9fdGVzdF90aW1lb3V0KGk5MTUs
IGVuZ2luZSwgZGVsYXlzW2ldKTsKKwkJaWd0X2luZm8oInRpbWVzbGljZV9kdXJhdGlvbl9tczol
ZCwgZWxhcHNlZD0lLjNmbXNcbiIsCisJCQkgZGVsYXlzW2ldLCBlbGFwc2VkICogMWUtNik7CisK
KwkJLyoKKwkJICogV2UgbmVlZCB0byBnaXZlIGEgY291cGxlIG9mIGppZmZpZXMgc2xhY2sgZm9y
IHRoZSBzY2hlZHVsZXIgdGltZW91dHMKKwkJICogYW5kIHRoZW4gYSBsaXR0bGUgbW9yZSBzbGFj
ayBmciB0aGUgb3ZlcmhlYWQgaW4gc3VibWl0dGluZyBhbmQKKwkJICogbWVhc3VyaW5nLiA1MG1z
IHNob3VsZCBjb3ZlciBhbGwgb2Ygb3VyIHNpbnMgYW5kIGJlIHVzZWZ1bAorCQkgKiB0b2xlcmFu
Y2UuCisJCSAqLworCQlpZ3RfYXNzZXJ0X2YoZWxhcHNlZCAvIDEwMDAgLyAxMDAwIDwgZGVsYXlz
W2ldICsgNTAsCisJCQkgICAgICJGb3JjZWQgcHJlZW1wdGlvbiB0aW1lb3V0IGV4Y2VlZGVkIHJl
cXVlc3QhXG4iKTsKKworCX0KKworCWlndF9hc3NlcnQoZW5hYmxlX2hhbmdjaGVjayhpOTE1LCB0
cnVlKSk7CisJZ2VtX3F1aWVzY2VudF9ncHUoaTkxNSk7CisKKwlzZXRfdGltZXNsaWNlKGVuZ2lu
ZSwgc2F2ZWQpOworfQorCitzdGF0aWMgdm9pZCB0ZXN0X29mZihpbnQgaTkxNSwgaW50IGVuZ2lu
ZSkKK3sKKwl1bnNpZ25lZCBpbnQgY2xhc3MsIGluc3Q7CisJdW5zaWduZWQgaW50IHNhdmVkOwor
CWlndF9zcGluX3QgKnNwaW5bMl07CisJdWludDMyX3QgY3R4WzJdOworCisJaWd0X3JlcXVpcmUo
aWd0X3N5c2ZzX3ByaW50ZihlbmdpbmUsICJwcmVlbXB0X3RpbWVvdXRfbXMiLCAiJXUiLCAxKSA9
PSAxKTsKKwlpZ3RfYXNzZXJ0KGlndF9zeXNmc19zY2FuZihlbmdpbmUsICJ0aW1lc2xpY2VfZHVy
YXRpb25fbXMiLCAiJXUiLCAmc2F2ZWQpID09IDEpOworCWlndF9kZWJ1ZygiSW5pdGlhbCB0aW1l
c2xpY2VfZHVyYXRpb25fbXM6JXVcbiIsIHNhdmVkKTsKKworCWdlbV9xdWllc2NlbnRfZ3B1KGk5
MTUpOworCWlndF9yZXF1aXJlKGVuYWJsZV9oYW5nY2hlY2soaTkxNSwgZmFsc2UpKTsKKworCWln
dF9hc3NlcnQoaWd0X3N5c2ZzX3NjYW5mKGVuZ2luZSwgImNsYXNzIiwgIiV1IiwgJmNsYXNzKSA9
PSAxKTsKKwlpZ3RfYXNzZXJ0KGlndF9zeXNmc19zY2FuZihlbmdpbmUsICJpbnN0YW5jZSIsICIl
dSIsICZpbnN0KSA9PSAxKTsKKworCWlndF9zeXNmc19wcmludGYoZW5naW5lLCAidGltZXNsaWNl
X2R1cmF0aW9uX21zIiwgIiV1IiwgMCk7CisKKwljdHhbMF0gPSBjcmVhdGVfY29udGV4dChpOTE1
LCBjbGFzcywgaW5zdCwgMCk7CisJc3BpblswXSA9IGlndF9zcGluX25ldyhpOTE1LCBjdHhbMF0s
CisJCQkgICAgICAgLmZsYWdzID0gKElHVF9TUElOX05PX1BSRUVNUFRJT04gfAorCQkJCQkgSUdU
X1NQSU5fUE9MTF9SVU4gfAorCQkJCQkgSUdUX1NQSU5fRkVOQ0VfT1VUKSk7CisJaWd0X3NwaW5f
YnVzeXdhaXRfdW50aWxfc3RhcnRlZChzcGluWzBdKTsKKworCWN0eFsxXSA9IGNyZWF0ZV9jb250
ZXh0KGk5MTUsIGNsYXNzLCBpbnN0LCAwKTsKKwlzcGluWzFdID0gaWd0X3NwaW5fbmV3KGk5MTUs
IGN0eFsxXSwgLmZsYWdzID0gSUdUX1NQSU5fUE9MTF9SVU4pOworCisJZm9yIChpbnQgaSA9IDA7
IGkgPCAxNTA7IGkrKykgeworCQlpZ3RfYXNzZXJ0X2VxKHN5bmNfZmVuY2Vfc3RhdHVzKHNwaW5b
MF0tPm91dF9mZW5jZSksIDApOworCQlzbGVlcCgxKTsKKwl9CisKKwlpZ3Rfc3lzZnNfcHJpbnRm
KGVuZ2luZSwgInRpbWVzbGljZV9kdXJhdGlvbl9tcyIsICIldSIsIDEpOworCisJaWd0X3NwaW5f
YnVzeXdhaXRfdW50aWxfc3RhcnRlZChzcGluWzFdKTsKKwlpZ3Rfc3Bpbl9mcmVlKGk5MTUsIHNw
aW5bMV0pOworCisJaWd0X2Fzc2VydF9lcShzeW5jX2ZlbmNlX3dhaXQoc3BpblswXS0+b3V0X2Zl
bmNlLCAxKSwgMCk7CisJaWd0X2Fzc2VydF9lcShzeW5jX2ZlbmNlX3N0YXR1cyhzcGluWzBdLT5v
dXRfZmVuY2UpLCAtRUlPKTsKKworCWlndF9zcGluX2ZyZWUoaTkxNSwgc3BpblswXSk7CisKKwln
ZW1fY29udGV4dF9kZXN0cm95KGk5MTUsIGN0eFsxXSk7CisJZ2VtX2NvbnRleHRfZGVzdHJveShp
OTE1LCBjdHhbMF0pOworCisJaWd0X2Fzc2VydChlbmFibGVfaGFuZ2NoZWNrKGk5MTUsIHRydWUp
KTsKKwlnZW1fcXVpZXNjZW50X2dwdShpOTE1KTsKKworCXNldF90aW1lc2xpY2UoZW5naW5lLCBz
YXZlZCk7Cit9CisKK2lndF9tYWluCit7CisJY29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9l
bmdpbmUyICppdDsKKwlpbnQgaTkxNSA9IC0xLCBlbmdpbmVzID0gLTE7CisKKwlpZ3RfZml4dHVy
ZSB7CisJCWludCBzeXM7CisKKwkJaTkxNSA9IGRybV9vcGVuX2RyaXZlcihEUklWRVJfSU5URUwp
OworCQlpZ3RfcmVxdWlyZV9nZW0oaTkxNSk7CisKKwkJc3lzID0gaWd0X3N5c2ZzX29wZW4oaTkx
NSk7CisJCWlndF9yZXF1aXJlKHN5cyAhPSAtMSk7CisKKwkJZW5naW5lcyA9IG9wZW5hdChzeXMs
ICJlbmdpbmUiLCBPX1JET05MWSk7CisJCWlndF9yZXF1aXJlKGVuZ2luZXMgIT0gLTEpOworCisJ
CWNsb3NlKHN5cyk7CisJfQorCisJX19mb3JfZWFjaF9zdGF0aWNfZW5naW5lKGl0KSB7CisJCWln
dF9zdWJ0ZXN0X2dyb3VwIHsKKwkJCWludCBlbmdpbmUgPSAtMTsKKwkJCWNoYXIgKm5hbWUgPSBO
VUxMOworCisJCQlpZ3RfZml4dHVyZSB7CisJCQkJc3RydWN0IHN0YXQgc3Q7CisKKwkJCQllbmdp
bmUgPSBvcGVuYXQoZW5naW5lcywgaXQtPm5hbWUsIE9fUkRPTkxZKTsKKwkJCQlpZ3RfcmVxdWly
ZShmc3RhdGF0KGVuZ2luZSwKKwkJCQkJCQkidGltZXNsaWNlX2R1cmF0aW9uX21zIiwKKwkJCQkJ
CQkmc3QsIDApID09IDApOworCisJCQkJbmFtZSA9IGlndF9zeXNmc19nZXQoZW5naW5lLCAibmFt
ZSIpOworCQkJfQorCQkJaWYgKCFuYW1lKQorCQkJCWNvbnRpbnVlOworCisJCQlpZ3Rfc3VidGVz
dF9mKCIlcy1pZGVtcG90ZW50IiwgbmFtZSkKKwkJCQl0ZXN0X2lkZW1wb3RlbnQoaTkxNSwgZW5n
aW5lKTsKKwkJCWlndF9zdWJ0ZXN0X2YoIiVzLWludmFsaWQiLCBuYW1lKQorCQkJCXRlc3RfaW52
YWxpZChpOTE1LCBlbmdpbmUpOworCQkJaWd0X3N1YnRlc3RfZigiJXMtdGltZW91dCIsIG5hbWUp
CisJCQkJdGVzdF90aW1lb3V0KGk5MTUsIGVuZ2luZSk7CisJCQlpZ3Rfc3VidGVzdF9mKCIlcy1v
ZmYiLCBuYW1lKQorCQkJCXRlc3Rfb2ZmKGk5MTUsIGVuZ2luZSk7CisKKwkJCWZyZWUobmFtZSk7
CisJCQljbG9zZShlbmdpbmUpOworCQl9CisJfQorCisJaWd0X2ZpeHR1cmUgeworCQljbG9zZShl
bmdpbmVzKTsKKwkJY2xvc2UoaTkxNSk7CisJfQorfQpkaWZmIC0tZ2l0IGEvdGVzdHMvbWVzb24u
YnVpbGQgYi90ZXN0cy9tZXNvbi5idWlsZAppbmRleCAyM2Y3MzBjMjAuLmY2MDNhYjNlMCAxMDA2
NDQKLS0tIGEvdGVzdHMvbWVzb24uYnVpbGQKKysrIGIvdGVzdHMvbWVzb24uYnVpbGQKQEAgLTI0
MCw2ICsyNDAsNyBAQCBpOTE1X3Byb2dzID0gWwogCSdpOTE1X3N1c3BlbmQnLAogCSdzeXNmc19o
ZWFydGJlYXRfaW50ZXJ2YWwnLAogCSdzeXNmc19wcmVlbXB0aW9uX3RpbWVvdXQnLAorCSdzeXNm
c190aW1lc2xpY2VfZHVyYXRpb24nLAogXQogCiB0ZXN0X2RlcHMgPSBbIGlndF9kZXBzIF0KLS0g
CjIuMjQuMC5yYzAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdm
eA==

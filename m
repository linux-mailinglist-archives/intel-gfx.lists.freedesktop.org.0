Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 42F2635E11
	for <lists+intel-gfx@lfdr.de>; Wed,  5 Jun 2019 15:39:11 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A55DB89956;
	Wed,  5 Jun 2019 13:39:09 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B28B889956
 for <intel-gfx@lists.freedesktop.org>; Wed,  5 Jun 2019 13:39:08 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by fmsmga106.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 05 Jun 2019 06:39:08 -0700
X-ExtLoop1: 1
Received: from mkopansk-mobl1.ger.corp.intel.com (HELO
 delly.ger.corp.intel.com) ([10.249.139.46])
 by fmsmga008.fm.intel.com with ESMTP; 05 Jun 2019 06:39:06 -0700
From: Lionel Landwerlin <lionel.g.landwerlin@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  5 Jun 2019 16:38:48 +0300
Message-Id: <20190605133852.4493-5-lionel.g.landwerlin@intel.com>
X-Mailer: git-send-email 2.21.0.392.gf8f6787159e
In-Reply-To: <20190605133852.4493-1-lionel.g.landwerlin@intel.com>
References: <20190605133852.4493-1-lionel.g.landwerlin@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v4 4/7] drm/i915: add syncobj timeline support
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SW50cm9kdWNlcyBhIG5ldyBwYXJhbWV0ZXJzIHRvIGV4ZWNidWYgc28gdGhhdCB3ZSBjYW4gc3Bl
Y2lmeSBzeW5jb2JqCmhhbmRsZXMgYXMgd2VsbCBhcyB0aW1lbGluZSBwb2ludHMuCgp2MjogUmV1
c2UgaTkxNV91c2VyX2V4dGVuc2lvbl9mbgoKU2lnbmVkLW9mZi1ieTogTGlvbmVsIExhbmR3ZXJs
aW4gPGxpb25lbC5nLmxhbmR3ZXJsaW5AaW50ZWwuY29tPgotLS0KIC4uLi9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyAgICB8IDI3OSArKysrKysrKysrKysrKy0tLS0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAgICB8ICAgNCArLQogaW5j
bHVkZS91YXBpL2RybS9pOTE1X2RybS5oICAgICAgICAgICAgICAgICAgIHwgIDM3ICsrKwogMyBm
aWxlcyBjaGFuZ2VkLCAyNjMgaW5zZXJ0aW9ucygrKSwgNTcgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKaW5kZXggYTk2MWZh
YjcwZmIyLi44Njg2NGVjNzZhOGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX2V4ZWNidWZmZXIuYwpAQCAtMjExLDYgKzIxMSwxMyBAQCBlbnVtIHsKICAqIHRoZSBi
YXRjaGJ1ZmZlciBpbiB0cnVzdGVkIG1vZGUsIG90aGVyd2lzZSB0aGUgaW9jdGwgaXMgcmVqZWN0
ZWQuCiAgKi8KIAorc3RydWN0IGk5MTVfZHJtX2RtYV9mZW5jZXMgeworCXN0cnVjdCBkcm1fc3lu
Y29iaiAqc3luY29iajsgLyogVXNlIHdpdGggcHRyX21hc2tfYml0cygpICovCisJc3RydWN0IGRt
YV9mZW5jZSAqZG1hX2ZlbmNlOworCXU2NCB2YWx1ZTsKKwlzdHJ1Y3QgZG1hX2ZlbmNlX2NoYWlu
ICpjaGFpbl9mZW5jZTsKK307CisKIHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgewogCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1OyAvKiogaTkxNSBiYWNrcG9pbnRlciAqLwogCXN0cnVjdCBk
cm1fZmlsZSAqZmlsZTsgLyoqIHBlci1maWxlIGxvb2t1cCB0YWJsZXMgYW5kIGxpbWl0cyAqLwpA
QCAtMjczLDYgKzI4MCw3IEBAIHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgewogCiAJc3RydWN0IHsK
IAkJdTY0IGZsYWdzOyAvKiogQXZhaWxhYmxlIGV4dGVuc2lvbnMgcGFyYW1ldGVycyAqLworCQlz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXJfZXh0X3RpbWVsaW5lX2ZlbmNlcyB0aW1lbGlu
ZV9mZW5jZXM7CiAJfSBleHRlbnNpb25zOwogfTsKIApAQCAtMjIxMyw2NyArMjIyMSwxOTMgQEAg
ZWJfc2VsZWN0X2VuZ2luZShzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwKIH0KIAogc3RhdGlj
IHZvaWQKLV9fZnJlZV9mZW5jZV9hcnJheShzdHJ1Y3QgZHJtX3N5bmNvYmogKipmZW5jZXMsIHVu
c2lnbmVkIGludCBuKQorX19mcmVlX2ZlbmNlX2FycmF5KHN0cnVjdCBpOTE1X2RybV9kbWFfZmVu
Y2VzICpmZW5jZXMsIHVuc2lnbmVkIGludCBuKQogewotCXdoaWxlIChuLS0pCi0JCWRybV9zeW5j
b2JqX3B1dChwdHJfbWFza19iaXRzKGZlbmNlc1tuXSwgMikpOworCXdoaWxlIChuLS0pIHsKKwkJ
ZHJtX3N5bmNvYmpfcHV0KHB0cl9tYXNrX2JpdHMoZmVuY2VzW25dLnN5bmNvYmosIDIpKTsKKwkJ
ZG1hX2ZlbmNlX3B1dChmZW5jZXNbbl0uZG1hX2ZlbmNlKTsKKwkJa2ZyZWUoZmVuY2VzW25dLmNo
YWluX2ZlbmNlKTsKKwl9CiAJa3ZmcmVlKGZlbmNlcyk7CiB9CiAKLXN0YXRpYyBzdHJ1Y3QgZHJt
X3N5bmNvYmogKioKLWdldF9mZW5jZV9hcnJheShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZm
ZXIyICphcmdzLAotCQlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCitzdGF0aWMgc3RydWN0IGk5MTVf
ZHJtX2RtYV9mZW5jZXMgKgorZ2V0X3RpbWVsaW5lX2ZlbmNlX2FycmF5KHN0cnVjdCBpOTE1X2V4
ZWNidWZmZXIgKmViLCBpbnQgKm91dF9uX2ZlbmNlcykKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X2V4ZWNidWZmZXJfZXh0X3RpbWVsaW5lX2ZlbmNlcyAqdGltZWxpbmVfZmVuY2VzID0KKwkJJmVi
LT5leHRlbnNpb25zLnRpbWVsaW5lX2ZlbmNlczsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNf
ZmVuY2UgX191c2VyICp1c2VyX2ZlbmNlczsKKwlzdHJ1Y3QgaTkxNV9kcm1fZG1hX2ZlbmNlcyAq
ZmVuY2VzOworCXU2NCBfX3VzZXIgKnVzZXJfdmFsdWVzOworCXVuc2lnbmVkIGxvbmcgbjsKKwlp
bnQgZXJyOworCisJKm91dF9uX2ZlbmNlcyA9IHRpbWVsaW5lX2ZlbmNlcy0+aGFuZGxlX2NvdW50
OworCisJLyogQ2hlY2sgbXVsdGlwbGljYXRpb24gb3ZlcmZsb3cgZm9yIGFjY2Vzc19vaygpIGFu
ZCBrdm1hbGxvY19hcnJheSgpICovCisJQlVJTERfQlVHX09OKHNpemVvZihzaXplX3QpID4gc2l6
ZW9mKHVuc2lnbmVkIGxvbmcpKTsKKwlpZiAoKm91dF9uX2ZlbmNlcyA+IG1pbl90KHVuc2lnbmVk
IGxvbmcsCisJCQkJICBVTE9OR19NQVggLyBzaXplb2YoKnVzZXJfZmVuY2VzKSwKKwkJCQkgIFNJ
WkVfTUFYIC8gc2l6ZW9mKCpmZW5jZXMpKSkKKwkJcmV0dXJuIEVSUl9QVFIoLUVJTlZBTCk7CisK
Kwl1c2VyX2ZlbmNlcyA9IHU2NF90b191c2VyX3B0cih0aW1lbGluZV9mZW5jZXMtPmhhbmRsZXNf
cHRyKTsKKwlpZiAoIWFjY2Vzc19vayh1c2VyX2ZlbmNlcywgKm91dF9uX2ZlbmNlcyAqIHNpemVv
ZigqdXNlcl9mZW5jZXMpKSkKKwkJcmV0dXJuIEVSUl9QVFIoLUVGQVVMVCk7CisKKwl1c2VyX3Zh
bHVlcyA9IHU2NF90b191c2VyX3B0cih0aW1lbGluZV9mZW5jZXMtPnZhbHVlc19wdHIpOworCWlm
ICghYWNjZXNzX29rKHVzZXJfdmFsdWVzLCAqb3V0X25fZmVuY2VzICogc2l6ZW9mKCp1c2VyX3Zh
bHVlcykpKQorCQlyZXR1cm4gRVJSX1BUUigtRUZBVUxUKTsKKworCWZlbmNlcyA9IGt2bWFsbG9j
X2FycmF5KCpvdXRfbl9mZW5jZXMsIHNpemVvZigqZmVuY2VzKSwKKwkJCQlfX0dGUF9OT1dBUk4g
fCBHRlBfS0VSTkVMKTsKKwlpZiAoIWZlbmNlcykKKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7
CisKKwlCVUlMRF9CVUdfT04ofihBUkNIX0tNQUxMT0NfTUlOQUxJR04gLSAxKSAmCisJCSAgICAg
fl9fSTkxNV9FWEVDX0ZFTkNFX1VOS05PV05fRkxBR1MpOworCisJZm9yIChuID0gMDsgbiA8ICpv
dXRfbl9mZW5jZXM7IG4rKykgeworCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfZmVuY2UgdXNl
cl9mZW5jZTsKKwkJc3RydWN0IGRybV9zeW5jb2JqICpzeW5jb2JqOworCQlzdHJ1Y3QgZG1hX2Zl
bmNlICpmZW5jZSA9IE5VTEw7CisJCXU2NCBwb2ludDsKKworCQlpZiAoX19jb3B5X2Zyb21fdXNl
cigmdXNlcl9mZW5jZSwgdXNlcl9mZW5jZXMrKywgc2l6ZW9mKHVzZXJfZmVuY2UpKSkgeworCQkJ
ZXJyID0gLUVGQVVMVDsKKwkJCWdvdG8gZXJyOworCQl9CisKKwkJaWYgKHVzZXJfZmVuY2UuZmxh
Z3MgJiBfX0k5MTVfRVhFQ19GRU5DRV9VTktOT1dOX0ZMQUdTKSB7CisJCQllcnIgPSAtRUlOVkFM
OworCQkJZ290byBlcnI7CisJCX0KKworCQlpZiAoX19nZXRfdXNlcihwb2ludCwgdXNlcl92YWx1
ZXMrKykpIHsKKwkJCWVyciA9IC1FRkFVTFQ7CisJCQlnb3RvIGVycjsKKwkJfQorCisJCXN5bmNv
YmogPSBkcm1fc3luY29ial9maW5kKGViLT5maWxlLCB1c2VyX2ZlbmNlLmhhbmRsZSk7CisJCWlm
ICghc3luY29iaikgeworCQkJRFJNX0RFQlVHKCJJbnZhbGlkIHN5bmNvYmogaGFuZGxlIHByb3Zp
ZGVkXG4iKTsKKwkJCWVyciA9IC1FSU5WQUw7CisJCQlnb3RvIGVycjsKKwkJfQorCisJCWlmICh1
c2VyX2ZlbmNlLmZsYWdzICYgSTkxNV9FWEVDX0ZFTkNFX1dBSVQpIHsKKwkJCWZlbmNlID0gZHJt
X3N5bmNvYmpfZmVuY2VfZ2V0KHN5bmNvYmopOworCQkJaWYgKCFmZW5jZSkgeworCQkJCURSTV9E
RUJVRygiU3luY29iaiBoYW5kbGUgaGFzIG5vIGZlbmNlXG4iKTsKKwkJCQlkcm1fc3luY29ial9w
dXQoc3luY29iaik7CisJCQkJZXJyID0gLUVJTlZBTDsKKwkJCQlnb3RvIGVycjsKKwkJCX0KKwor
CQkJZXJyID0gZG1hX2ZlbmNlX2NoYWluX2ZpbmRfc2Vxbm8oJmZlbmNlLCBwb2ludCk7CisJCQlp
ZiAoZXJyKSB7CisJCQkJRFJNX0RFQlVHKCJTeW5jb2JqIGhhbmRsZSBtaXNzaW5nIHJlcXVlc3Rl
ZCBwb2ludFxuIik7CisJCQkJZ290byBlcnI7CisJCQl9CisJCX0KKworCQkvKgorCQkgKiBGb3Ig
dGltZWxpbmUgc3luY29ianMgd2UgbmVlZCB0byBjcmVhdGUgYSBjaGFpbi4KKwkJICovCisJCWlm
IChwb2ludCAhPSAwICYmIHVzZXJfZmVuY2UuZmxhZ3MgJiBJOTE1X0VYRUNfRkVOQ0VfU0lHTkFM
KSB7CisJCQlmZW5jZXNbbl0uY2hhaW5fZmVuY2UgPQorCQkJCWttYWxsb2Moc2l6ZW9mKCpmZW5j
ZXNbbl0uY2hhaW5fZmVuY2UpLAorCQkJCQlHRlBfS0VSTkVMKTsKKwkJCWlmICghZmVuY2VzW25d
LmNoYWluX2ZlbmNlKSB7CisJCQkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7CisJCQkJZHJtX3N5bmNv
YmpfcHV0KHN5bmNvYmopOworCQkJCWVyciA9IC1FTk9NRU07CisJCQkJRFJNX0RFQlVHKCJVbmFi
bGUgdG8gYWxsb2MgY2hhaW5fZmVuY2VcbiIpOworCQkJCWdvdG8gZXJyOworCQkJfQorCQl9IGVs
c2UgeworCQkJZmVuY2VzW25dLmNoYWluX2ZlbmNlID0gTlVMTDsKKwkJfQorCisJCWZlbmNlc1tu
XS5zeW5jb2JqID0gcHRyX3BhY2tfYml0cyhzeW5jb2JqLCB1c2VyX2ZlbmNlLmZsYWdzLCAyKTsK
KwkJZmVuY2VzW25dLmRtYV9mZW5jZSA9IGZlbmNlOworCQlmZW5jZXNbbl0udmFsdWUgPSBwb2lu
dDsKKwl9CisKKwlyZXR1cm4gZmVuY2VzOworCitlcnI6CisJX19mcmVlX2ZlbmNlX2FycmF5KGZl
bmNlcywgbik7CisJcmV0dXJuIEVSUl9QVFIoZXJyKTsKK30KKworc3RhdGljIHN0cnVjdCBpOTE1
X2RybV9kbWFfZmVuY2VzICoKK2dldF9sZWdhY3lfZmVuY2VfYXJyYXkoc3RydWN0IGk5MTVfZXhl
Y2J1ZmZlciAqZWIsCisJCSAgICAgICBpbnQgKm91dF9uX2ZlbmNlcykKIHsKLQljb25zdCB1bnNp
Z25lZCBsb25nIG5mZW5jZXMgPSBhcmdzLT5udW1fY2xpcHJlY3RzOworCXN0cnVjdCBkcm1faTkx
NV9nZW1fZXhlY2J1ZmZlcjIgKmFyZ3MgPSBlYi0+YXJnczsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X2V4ZWNfZmVuY2UgX191c2VyICp1c2VyOwotCXN0cnVjdCBkcm1fc3luY29iaiAqKmZlbmNlczsK
KwlzdHJ1Y3QgaTkxNV9kcm1fZG1hX2ZlbmNlcyAqZmVuY2VzOwogCXVuc2lnbmVkIGxvbmcgbjsK
IAlpbnQgZXJyOwogCi0JaWYgKCEoYXJncy0+ZmxhZ3MgJiBJOTE1X0VYRUNfRkVOQ0VfQVJSQVkp
KQotCQlyZXR1cm4gTlVMTDsKKwkqb3V0X25fZmVuY2VzID0gYXJncy0+bnVtX2NsaXByZWN0czsK
IAogCS8qIENoZWNrIG11bHRpcGxpY2F0aW9uIG92ZXJmbG93IGZvciBhY2Nlc3Nfb2soKSBhbmQg
a3ZtYWxsb2NfYXJyYXkoKSAqLwogCUJVSUxEX0JVR19PTihzaXplb2Yoc2l6ZV90KSA+IHNpemVv
Zih1bnNpZ25lZCBsb25nKSk7Ci0JaWYgKG5mZW5jZXMgPiBtaW5fdCh1bnNpZ25lZCBsb25nLAot
CQkJICAgIFVMT05HX01BWCAvIHNpemVvZigqdXNlciksCi0JCQkgICAgU0laRV9NQVggLyBzaXpl
b2YoKmZlbmNlcykpKQorCWlmICgqb3V0X25fZmVuY2VzID4gbWluX3QodW5zaWduZWQgbG9uZywK
KwkJCQkgIFVMT05HX01BWCAvIHNpemVvZigqdXNlciksCisJCQkJICBTSVpFX01BWCAvIHNpemVv
ZigqZmVuY2VzKSkpCiAJCXJldHVybiBFUlJfUFRSKC1FSU5WQUwpOwogCiAJdXNlciA9IHU2NF90
b191c2VyX3B0cihhcmdzLT5jbGlwcmVjdHNfcHRyKTsKLQlpZiAoIWFjY2Vzc19vayh1c2VyLCBu
ZmVuY2VzICogc2l6ZW9mKCp1c2VyKSkpCisJaWYgKCFhY2Nlc3Nfb2sodXNlciwgKm91dF9uX2Zl
bmNlcyAqIHNpemVvZigqdXNlcikpKQogCQlyZXR1cm4gRVJSX1BUUigtRUZBVUxUKTsKIAotCWZl
bmNlcyA9IGt2bWFsbG9jX2FycmF5KG5mZW5jZXMsIHNpemVvZigqZmVuY2VzKSwKKwlmZW5jZXMg
PSBrdm1hbGxvY19hcnJheSgqb3V0X25fZmVuY2VzLCBzaXplb2YoKmZlbmNlcyksCiAJCQkJX19H
RlBfTk9XQVJOIHwgR0ZQX0tFUk5FTCk7CiAJaWYgKCFmZW5jZXMpCiAJCXJldHVybiBFUlJfUFRS
KC1FTk9NRU0pOwogCi0JZm9yIChuID0gMDsgbiA8IG5mZW5jZXM7IG4rKykgewotCQlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX2V4ZWNfZmVuY2UgZmVuY2U7CisJZm9yIChuID0gMDsgbiA8ICpvdXRfbl9m
ZW5jZXM7IG4rKykgeworCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfZmVuY2UgdXNlcl9mZW5j
ZTsKIAkJc3RydWN0IGRybV9zeW5jb2JqICpzeW5jb2JqOworCQlzdHJ1Y3QgZG1hX2ZlbmNlICpm
ZW5jZSA9IE5VTEw7CiAKLQkJaWYgKF9fY29weV9mcm9tX3VzZXIoJmZlbmNlLCB1c2VyKyssIHNp
emVvZihmZW5jZSkpKSB7CisJCWlmIChfX2NvcHlfZnJvbV91c2VyKCZ1c2VyX2ZlbmNlLCB1c2Vy
KyssIHNpemVvZih1c2VyX2ZlbmNlKSkpIHsKIAkJCWVyciA9IC1FRkFVTFQ7CiAJCQlnb3RvIGVy
cjsKIAkJfQogCi0JCWlmIChmZW5jZS5mbGFncyAmIF9fSTkxNV9FWEVDX0ZFTkNFX1VOS05PV05f
RkxBR1MpIHsKKwkJaWYgKHVzZXJfZmVuY2UuZmxhZ3MgJiBfX0k5MTVfRVhFQ19GRU5DRV9VTktO
T1dOX0ZMQUdTKSB7CiAJCQllcnIgPSAtRUlOVkFMOwogCQkJZ290byBlcnI7CiAJCX0KIAotCQlz
eW5jb2JqID0gZHJtX3N5bmNvYmpfZmluZChmaWxlLCBmZW5jZS5oYW5kbGUpOworCQlzeW5jb2Jq
ID0gZHJtX3N5bmNvYmpfZmluZChlYi0+ZmlsZSwgdXNlcl9mZW5jZS5oYW5kbGUpOwogCQlpZiAo
IXN5bmNvYmopIHsKIAkJCURSTV9ERUJVRygiSW52YWxpZCBzeW5jb2JqIGhhbmRsZSBwcm92aWRl
ZFxuIik7CiAJCQllcnIgPSAtRU5PRU5UOwogCQkJZ290byBlcnI7CiAJCX0KIAorCQlpZiAodXNl
cl9mZW5jZS5mbGFncyAmIEk5MTVfRVhFQ19GRU5DRV9XQUlUKSB7CisJCQlmZW5jZSA9IGRybV9z
eW5jb2JqX2ZlbmNlX2dldChzeW5jb2JqKTsKKwkJCWlmICghZmVuY2UpIHsKKwkJCQlEUk1fREVC
VUcoIlN5bmNvYmogaGFuZGxlIGhhcyBubyBmZW5jZVxuIik7CisJCQkJZHJtX3N5bmNvYmpfcHV0
KHN5bmNvYmopOworCQkJCWVyciA9IC1FSU5WQUw7CisJCQkJZ290byBlcnI7CisJCQl9CisJCX0K
KwogCQlCVUlMRF9CVUdfT04ofihBUkNIX0tNQUxMT0NfTUlOQUxJR04gLSAxKSAmCiAJCQkgICAg
IH5fX0k5MTVfRVhFQ19GRU5DRV9VTktOT1dOX0ZMQUdTKTsKIAotCQlmZW5jZXNbbl0gPSBwdHJf
cGFja19iaXRzKHN5bmNvYmosIGZlbmNlLmZsYWdzLCAyKTsKKwkJZmVuY2VzW25dLnN5bmNvYmog
PSBwdHJfcGFja19iaXRzKHN5bmNvYmosIHVzZXJfZmVuY2UuZmxhZ3MsIDIpOworCQlmZW5jZXNb
bl0uZG1hX2ZlbmNlID0gZmVuY2U7CisJCWZlbmNlc1tuXS52YWx1ZSA9IDA7CisJCWZlbmNlc1tu
XS5jaGFpbl9mZW5jZSA9IE5VTEw7CiAJfQogCiAJcmV0dXJuIGZlbmNlczsKQEAgLTIyODMsMzcg
KzI0MTcsNDcgQEAgZ2V0X2ZlbmNlX2FycmF5KHN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZl
cjIgKmFyZ3MsCiAJcmV0dXJuIEVSUl9QVFIoZXJyKTsKIH0KIAorc3RhdGljIHN0cnVjdCBpOTE1
X2RybV9kbWFfZmVuY2VzICoKK2dldF9mZW5jZV9hcnJheShzdHJ1Y3QgaTkxNV9leGVjYnVmZmVy
ICplYiwgaW50ICpvdXRfbl9mZW5jZXMpCit7CisJaWYgKGViLT5hcmdzLT5mbGFncyAmIEk5MTVf
RVhFQ19GRU5DRV9BUlJBWSkgeworCQkvKiBUaW1lbGluZSBmZW5jZXMgYXJlIGluY29tcGF0aWJs
ZSB3aXRoIHRoZSBmZW5jZSBhcnJheS4gKi8KKwkJaWYgKGViLT5leHRlbnNpb25zLmZsYWdzICYg
QklUKERSTV9JOTE1X0dFTV9FWEVDQlVGRkVSX0VYVF9USU1FTElORV9GRU5DRVMpKQorCQkJcmV0
dXJuIEVSUl9QVFIoLUVJTlZBTCk7CisKKwkJcmV0dXJuIGdldF9sZWdhY3lfZmVuY2VfYXJyYXko
ZWIsIG91dF9uX2ZlbmNlcyk7CisJfSBlbHNlIGlmIChlYi0+ZXh0ZW5zaW9ucy5mbGFncyAmIEJJ
VChEUk1fSTkxNV9HRU1fRVhFQ0JVRkZFUl9FWFRfVElNRUxJTkVfRkVOQ0VTKSkgeworCQlyZXR1
cm4gZ2V0X3RpbWVsaW5lX2ZlbmNlX2FycmF5KGViLCBvdXRfbl9mZW5jZXMpOworCX0KKworCXJl
dHVybiBOVUxMOworfQorCiBzdGF0aWMgdm9pZAotcHV0X2ZlbmNlX2FycmF5KHN0cnVjdCBkcm1f
aTkxNV9nZW1fZXhlY2J1ZmZlcjIgKmFyZ3MsCi0JCXN0cnVjdCBkcm1fc3luY29iaiAqKmZlbmNl
cykKK3B1dF9mZW5jZV9hcnJheShzdHJ1Y3QgaTkxNV9kcm1fZG1hX2ZlbmNlcyAqZmVuY2VzLCBp
bnQgbmZlbmNlcykKIHsKIAlpZiAoZmVuY2VzKQotCQlfX2ZyZWVfZmVuY2VfYXJyYXkoZmVuY2Vz
LCBhcmdzLT5udW1fY2xpcHJlY3RzKTsKKwkJX19mcmVlX2ZlbmNlX2FycmF5KGZlbmNlcywgbmZl
bmNlcyk7CiB9CiAKIHN0YXRpYyBpbnQKIGF3YWl0X2ZlbmNlX2FycmF5KHN0cnVjdCBpOTE1X2V4
ZWNidWZmZXIgKmViLAotCQkgIHN0cnVjdCBkcm1fc3luY29iaiAqKmZlbmNlcykKKwkJICBzdHJ1
Y3QgaTkxNV9kcm1fZG1hX2ZlbmNlcyAqZmVuY2VzLAorCQkgIGludCBuZmVuY2VzKQogewotCWNv
bnN0IHVuc2lnbmVkIGludCBuZmVuY2VzID0gZWItPmFyZ3MtPm51bV9jbGlwcmVjdHM7CiAJdW5z
aWduZWQgaW50IG47CiAJaW50IGVycjsKIAogCWZvciAobiA9IDA7IG4gPCBuZmVuY2VzOyBuKysp
IHsKIAkJc3RydWN0IGRybV9zeW5jb2JqICpzeW5jb2JqOwotCQlzdHJ1Y3QgZG1hX2ZlbmNlICpm
ZW5jZTsKIAkJdW5zaWduZWQgaW50IGZsYWdzOwogCi0JCXN5bmNvYmogPSBwdHJfdW5wYWNrX2Jp
dHMoZmVuY2VzW25dLCAmZmxhZ3MsIDIpOworCQlzeW5jb2JqID0gcHRyX3VucGFja19iaXRzKGZl
bmNlc1tuXS5zeW5jb2JqLCAmZmxhZ3MsIDIpOwogCQlpZiAoIShmbGFncyAmIEk5MTVfRVhFQ19G
RU5DRV9XQUlUKSkKIAkJCWNvbnRpbnVlOwogCi0JCWZlbmNlID0gZHJtX3N5bmNvYmpfZmVuY2Vf
Z2V0KHN5bmNvYmopOwotCQlpZiAoIWZlbmNlKQotCQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQkJZXJy
ID0gaTkxNV9yZXF1ZXN0X2F3YWl0X2RtYV9mZW5jZShlYi0+cmVxdWVzdCwgZmVuY2UpOwotCQlk
bWFfZmVuY2VfcHV0KGZlbmNlKTsKKwkJZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X2RtYV9mZW5j
ZShlYi0+cmVxdWVzdCwKKwkJCQkJCSAgIGZlbmNlc1tuXS5kbWFfZmVuY2UpOwogCQlpZiAoZXJy
IDwgMCkKIAkJCXJldHVybiBlcnI7CiAJfQpAQCAtMjMyMyw5ICsyNDY3LDkgQEAgYXdhaXRfZmVu
Y2VfYXJyYXkoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIsCiAKIHN0YXRpYyB2b2lkCiBzaWdu
YWxfZmVuY2VfYXJyYXkoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIsCi0JCSAgIHN0cnVjdCBk
cm1fc3luY29iaiAqKmZlbmNlcykKKwkJICAgc3RydWN0IGk5MTVfZHJtX2RtYV9mZW5jZXMgKmZl
bmNlcywKKwkJICAgaW50IG5mZW5jZXMpCiB7Ci0JY29uc3QgdW5zaWduZWQgaW50IG5mZW5jZXMg
PSBlYi0+YXJncy0+bnVtX2NsaXByZWN0czsKIAlzdHJ1Y3QgZG1hX2ZlbmNlICogY29uc3QgZmVu
Y2UgPSAmZWItPnJlcXVlc3QtPmZlbmNlOwogCXVuc2lnbmVkIGludCBuOwogCkBAIC0yMzMzLDE1
ICsyNDc3LDM5IEBAIHNpZ25hbF9mZW5jZV9hcnJheShzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICpl
YiwKIAkJc3RydWN0IGRybV9zeW5jb2JqICpzeW5jb2JqOwogCQl1bnNpZ25lZCBpbnQgZmxhZ3M7
CiAKLQkJc3luY29iaiA9IHB0cl91bnBhY2tfYml0cyhmZW5jZXNbbl0sICZmbGFncywgMik7CisJ
CXN5bmNvYmogPSBwdHJfdW5wYWNrX2JpdHMoZmVuY2VzW25dLnN5bmNvYmosICZmbGFncywgMik7
CiAJCWlmICghKGZsYWdzICYgSTkxNV9FWEVDX0ZFTkNFX1NJR05BTCkpCiAJCQljb250aW51ZTsK
IAotCQlkcm1fc3luY29ial9yZXBsYWNlX2ZlbmNlKHN5bmNvYmosIGZlbmNlKTsKKwkJaWYgKGZl
bmNlc1tuXS5jaGFpbl9mZW5jZSkgeworCQkJZHJtX3N5bmNvYmpfYWRkX3BvaW50KHN5bmNvYmos
IGZlbmNlc1tuXS5jaGFpbl9mZW5jZSwKKwkJCQkJICAgICAgZmVuY2UsIGZlbmNlc1tuXS52YWx1
ZSk7CisJCQkvKgorCQkJICogVGhlIGNoYWluJ3Mgb3duZXJzaGlwIGlzIHRyYW5zZmVyZWQgdG8g
dGhlCisJCQkgKiB0aW1lbGluZS4KKwkJCSAqLworCQkJZmVuY2VzW25dLmNoYWluX2ZlbmNlID0g
TlVMTDsKKwkJfSBlbHNlIHsKKwkJCWRybV9zeW5jb2JqX3JlcGxhY2VfZmVuY2Uoc3luY29iaiwg
ZmVuY2UpOworCQl9CiAJfQogfQogCitzdGF0aWMgaW50IHBhcnNlX3RpbWVsaW5lX2ZlbmNlcyhz
dHJ1Y3QgaTkxNV91c2VyX2V4dGVuc2lvbiBfX3VzZXIgKmV4dCwgdm9pZCAqZGF0YSkKK3sKKwlz
dHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiA9IGRhdGE7CisKKwlpZiAoY29weV9mcm9tX3VzZXIo
JmViLT5leHRlbnNpb25zLnRpbWVsaW5lX2ZlbmNlcywgZXh0LAorCQkJICAgc2l6ZW9mKGViLT5l
eHRlbnNpb25zLnRpbWVsaW5lX2ZlbmNlcykpKQorCQlyZXR1cm4gLUVGQVVMVDsKKworCWViLT5l
eHRlbnNpb25zLmZsYWdzIHw9IEJJVChEUk1fSTkxNV9HRU1fRVhFQ0JVRkZFUl9FWFRfVElNRUxJ
TkVfRkVOQ0VTKTsKKworCXJldHVybiAwOworfQorCiBzdGF0aWMgY29uc3QgaTkxNV91c2VyX2V4
dGVuc2lvbl9mbiBleGVjYnVmX2V4dGVuc2lvbnNbXSA9IHsKKyAgICAgICAgW0RSTV9JOTE1X0dF
TV9FWEVDQlVGRkVSX0VYVF9USU1FTElORV9GRU5DRVNdID0gcGFyc2VfdGltZWxpbmVfZmVuY2Vz
LAogfTsKIAogc3RhdGljIGludApAQCAtMjM2MSwxNCArMjUyOSwxNSBAQCBzdGF0aWMgaW50CiBp
OTE1X2dlbV9kb19leGVjYnVmZmVyKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCSAgICAgICBz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbGUsCiAJCSAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNi
dWZmZXIyICphcmdzLAotCQkgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIg
KmV4ZWMsCi0JCSAgICAgICBzdHJ1Y3QgZHJtX3N5bmNvYmogKipmZW5jZXMpCisJCSAgICAgICBz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiAqZXhlYykKIHsKIAlzdHJ1Y3QgaTkxNV9l
eGVjYnVmZmVyIGViOwogCXN0cnVjdCBkbWFfZmVuY2UgKmluX2ZlbmNlID0gTlVMTDsKIAlzdHJ1
Y3QgZG1hX2ZlbmNlICpleGVjX2ZlbmNlID0gTlVMTDsKIAlzdHJ1Y3Qgc3luY19maWxlICpvdXRf
ZmVuY2UgPSBOVUxMOworCXN0cnVjdCBpOTE1X2RybV9kbWFfZmVuY2VzICpmZW5jZXMgPSBOVUxM
OwogCWludCBvdXRfZmVuY2VfZmQgPSAtMTsKKwlpbnQgbmZlbmNlcyA9IDA7CiAJaW50IGVycjsK
IAogCUJVSUxEX0JVR19PTihfX0VYRUNfSU5URVJOQUxfRkxBR1MgJiB+X19JOTE1X0VYRUNfSUxM
RUdBTF9GTEFHUyk7CkBAIC0yNDEwLDEwICsyNTc5LDE2IEBAIGk5MTVfZ2VtX2RvX2V4ZWNidWZm
ZXIoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJCXJldHVybiBlcnI7CiAJfQogCisJZmVuY2Vz
ID0gZ2V0X2ZlbmNlX2FycmF5KCZlYiwgJm5mZW5jZXMpOworCWlmIChJU19FUlIoZmVuY2VzKSkK
KwkJcmV0dXJuIFBUUl9FUlIoZmVuY2VzKTsKKwogCWlmIChhcmdzLT5mbGFncyAmIEk5MTVfRVhF
Q19GRU5DRV9JTikgewogCQlpbl9mZW5jZSA9IHN5bmNfZmlsZV9nZXRfZmVuY2UobG93ZXJfMzJf
Yml0cyhhcmdzLT5yc3ZkMikpOwotCQlpZiAoIWluX2ZlbmNlKQotCQkJcmV0dXJuIC1FSU5WQUw7
CisJCWlmICghaW5fZmVuY2UpIHsKKwkJCWVyciA9IC1FSU5WQUw7CisJCQlnb3RvIGVycl9mZW5j
ZXM7CisJCX0KIAl9CiAKIAlpZiAoYXJncy0+ZmxhZ3MgJiBJOTE1X0VYRUNfRkVOQ0VfU1VCTUlU
KSB7CkBAIC0yNTcxLDcgKzI3NDYsNyBAQCBpOTE1X2dlbV9kb19leGVjYnVmZmVyKHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsCiAJfQogCiAJaWYgKGZlbmNlcykgewotCQllcnIgPSBhd2FpdF9mZW5j
ZV9hcnJheSgmZWIsIGZlbmNlcyk7CisJCWVyciA9IGF3YWl0X2ZlbmNlX2FycmF5KCZlYiwgZmVu
Y2VzLCBuZmVuY2VzKTsKIAkJaWYgKGVycikKIAkJCWdvdG8gZXJyX3JlcXVlc3Q7CiAJfQpAQCAt
MjYwMCw3ICsyNzc1LDcgQEAgaTkxNV9nZW1fZG9fZXhlY2J1ZmZlcihzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LAogCWk5MTVfcmVxdWVzdF9hZGQoZWIucmVxdWVzdCk7CiAKIAlpZiAoZmVuY2VzKQot
CQlzaWduYWxfZmVuY2VfYXJyYXkoJmViLCBmZW5jZXMpOworCQlzaWduYWxfZmVuY2VfYXJyYXko
JmViLCBmZW5jZXMsIG5mZW5jZXMpOwogCiAJaWYgKG91dF9mZW5jZSkgewogCQlpZiAoZXJyID09
IDApIHsKQEAgLTI2MzUsNiArMjgxMCw4IEBAIGk5MTVfZ2VtX2RvX2V4ZWNidWZmZXIoc3RydWN0
IGRybV9kZXZpY2UgKmRldiwKIAlkbWFfZmVuY2VfcHV0KGV4ZWNfZmVuY2UpOwogZXJyX2luX2Zl
bmNlOgogCWRtYV9mZW5jZV9wdXQoaW5fZmVuY2UpOworZXJyX2ZlbmNlczoKKwlwdXRfZmVuY2Vf
YXJyYXkoZmVuY2VzLCBuZmVuY2VzKTsKIAlyZXR1cm4gZXJyOwogfQogCkBAIC0yNzI4LDcgKzI5
MDUsNyBAQCBpOTE1X2dlbV9leGVjYnVmZmVyX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHZvaWQgKmRhdGEsCiAJCQlleGVjMl9saXN0W2ldLmZsYWdzID0gMDsKIAl9CiAKLQllcnIgPSBp
OTE1X2dlbV9kb19leGVjYnVmZmVyKGRldiwgZmlsZSwgJmV4ZWMyLCBleGVjMl9saXN0LCBOVUxM
KTsKKwllcnIgPSBpOTE1X2dlbV9kb19leGVjYnVmZmVyKGRldiwgZmlsZSwgJmV4ZWMyLCBleGVj
Ml9saXN0KTsKIAlpZiAoZXhlYzIuZmxhZ3MgJiBfX0VYRUNfSEFTX1JFTE9DKSB7CiAJCXN0cnVj
dCBkcm1faTkxNV9nZW1fZXhlY19vYmplY3QgX191c2VyICp1c2VyX2V4ZWNfbGlzdCA9CiAJCQl1
NjRfdG9fdXNlcl9wdHIoYXJncy0+YnVmZmVyc19wdHIpOwpAQCAtMjc1OSw3ICsyOTM2LDYgQEAg
aTkxNV9nZW1fZXhlY2J1ZmZlcjJfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAq
ZGF0YSwKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXIyICphcmdzID0gZGF0YTsK
IAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiAqZXhlYzJfbGlzdDsKLQlzdHJ1Y3Qg
ZHJtX3N5bmNvYmogKipmZW5jZXMgPSBOVUxMOwogCWNvbnN0IHNpemVfdCBjb3VudCA9IGFyZ3Mt
PmJ1ZmZlcl9jb3VudDsKIAlpbnQgZXJyOwogCkBAIC0yNzg3LDE1ICsyOTYzLDcgQEAgaTkxNV9n
ZW1fZXhlY2J1ZmZlcjJfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
IAkJcmV0dXJuIC1FRkFVTFQ7CiAJfQogCi0JaWYgKGFyZ3MtPmZsYWdzICYgSTkxNV9FWEVDX0ZF
TkNFX0FSUkFZKSB7Ci0JCWZlbmNlcyA9IGdldF9mZW5jZV9hcnJheShhcmdzLCBmaWxlKTsKLQkJ
aWYgKElTX0VSUihmZW5jZXMpKSB7Ci0JCQlrdmZyZWUoZXhlYzJfbGlzdCk7Ci0JCQlyZXR1cm4g
UFRSX0VSUihmZW5jZXMpOwotCQl9Ci0JfQotCi0JZXJyID0gaTkxNV9nZW1fZG9fZXhlY2J1ZmZl
cihkZXYsIGZpbGUsIGFyZ3MsIGV4ZWMyX2xpc3QsIGZlbmNlcyk7CisJZXJyID0gaTkxNV9nZW1f
ZG9fZXhlY2J1ZmZlcihkZXYsIGZpbGUsIGFyZ3MsIGV4ZWMyX2xpc3QpOwogCiAJLyoKIAkgKiBO
b3cgdGhhdCB3ZSBoYXZlIGJlZ3VuIGV4ZWN1dGlvbiBvZiB0aGUgYmF0Y2hidWZmZXIsIHdlIGln
bm9yZQpAQCAtMjgzNSw3ICszMDAzLDYgQEAgZW5kOjsKIAl9CiAKIAlhcmdzLT5mbGFncyAmPSB+
X19JOTE1X0VYRUNfVU5LTk9XTl9GTEFHUzsKLQlwdXRfZmVuY2VfYXJyYXkoYXJncywgZmVuY2Vz
KTsKIAlrdmZyZWUoZXhlYzJfbGlzdCk7CiAJcmV0dXJuIGVycjsKIH0KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2Rydi5jCmluZGV4IDllZDRkMDAxNmVlMS4uYTg3Mjc5MWY5OGJkIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZHJ2LmMKQEAgLTQ0OCw2ICs0NDgsNyBAQCBzdGF0aWMgaW50IGk5MTVfZ2V0cGFyYW1faW9j
dGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAljYXNlIEk5MTVfUEFSQU1f
SEFTX0VYRUNfQkFUQ0hfRklSU1Q6CiAJY2FzZSBJOTE1X1BBUkFNX0hBU19FWEVDX0ZFTkNFX0FS
UkFZOgogCWNhc2UgSTkxNV9QQVJBTV9IQVNfRVhFQ19TVUJNSVRfRkVOQ0U6CisJY2FzZSBJOTE1
X1BBUkFNX0hBU19FWEVDX1RJTUVMSU5FX0ZFTkNFUzoKIAkJLyogRm9yIHRoZSB0aW1lIGJlaW5n
IGFsbCBvZiB0aGVzZSBhcmUgYWx3YXlzIHRydWU7CiAJCSAqIGlmIHNvbWUgc3VwcG9ydGVkIGhh
cmR3YXJlIGRvZXMgbm90IGhhdmUgb25lIG9mIHRoZXNlCiAJCSAqIGZlYXR1cmVzIHRoaXMgdmFs
dWUgbmVlZHMgdG8gYmUgcHJvdmlkZWQgZnJvbQpAQCAtMzE5Miw3ICszMTkzLDggQEAgc3RhdGlj
IHN0cnVjdCBkcm1fZHJpdmVyIGRyaXZlciA9IHsKIAkgKi8KIAkuZHJpdmVyX2ZlYXR1cmVzID0K
IAkgICAgRFJJVkVSX0dFTSB8IERSSVZFUl9QUklNRSB8Ci0JICAgIERSSVZFUl9SRU5ERVIgfCBE
UklWRVJfTU9ERVNFVCB8IERSSVZFUl9BVE9NSUMgfCBEUklWRVJfU1lOQ09CSiwKKwkgICAgRFJJ
VkVSX1JFTkRFUiB8IERSSVZFUl9NT0RFU0VUIHwgRFJJVkVSX0FUT01JQyB8IERSSVZFUl9TWU5D
T0JKIHwKKwkgICAgRFJJVkVSX1NZTkNPQkpfVElNRUxJTkUsCiAJLnJlbGVhc2UgPSBpOTE1X2Ry
aXZlcl9yZWxlYXNlLAogCS5vcGVuID0gaTkxNV9kcml2ZXJfb3BlbiwKIAkubGFzdGNsb3NlID0g
aTkxNV9kcml2ZXJfbGFzdGNsb3NlLApkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2RybS9pOTE1
X2RybS5oIGIvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCmluZGV4IGVmYTE5NWQ2OTk0ZS4u
YjdmZTE5MTVlMzRkIDEwMDY0NAotLS0gYS9pbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmgKKysr
IGIvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCkBAIC02MTcsNiArNjE3LDEyIEBAIHR5cGVk
ZWYgc3RydWN0IGRybV9pOTE1X2lycV93YWl0IHsKICAqLwogI2RlZmluZSBJOTE1X1BBUkFNX1BF
UkZfUkVWSVNJT04JNTQKIAorLyogUXVlcnkgd2hldGhlciBEUk1fSTkxNV9HRU1fRVhFQ0JVRkZF
UjIgc3VwcG9ydHMgc3VwcGx5aW5nIGFuIGFycmF5IG9mCisgKiB0aW1lbGluZSBzeW5jb2JqIHRo
cm91Z2ggZHJtX2k5MTVfZ2VtX2V4ZWNidWZfZXh0X3RpbWVsaW5lX2ZlbmNlcy4gU2VlCisgKiBJ
OTE1X0VYRUNfRVhULgorICovCisjZGVmaW5lIEk5MTVfUEFSQU1fSEFTX0VYRUNfVElNRUxJTkVf
RkVOQ0VTIDU1CisKIC8qIE11c3QgYmUga2VwdCBjb21wYWN0IC0tIG5vIGhvbGVzIGFuZCB3ZWxs
IGRvY3VtZW50ZWQgKi8KIAogdHlwZWRlZiBzdHJ1Y3QgZHJtX2k5MTVfZ2V0cGFyYW0gewpAQCAt
MTAxNCw5ICsxMDIwLDQwIEBAIHN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY19mZW5jZSB7CiB9Owog
CiBlbnVtIGRybV9pOTE1X2dlbV9leGVjYnVmZmVyX2V4dCB7CisJLyoqCisJICogVGhpcyBpZGVu
dGlmaWVyIGlzIGFzc29jaWF0ZWQgd2l0aAorCSAqIGRybV9pOTE1X2dlbV9leGVjYnVmX2V4dF90
aW1lbGluZV9mZW5jZXMuCisJICovCisJRFJNX0k5MTVfR0VNX0VYRUNCVUZGRVJfRVhUX1RJTUVM
SU5FX0ZFTkNFUywKKwogCURSTV9JOTE1X0dFTV9FWEVDQlVGRkVSX0VYVF9NQVggLyogbm9uLUFC
SSAqLwogfTsKIAorLyoqCisgKiBUaGlzIHN0cnVjdHVyZSBkZXNjcmliZXMgYW4gYXJyYXkgb2Yg
ZHJtX3N5bmNvYmogYW5kIGFzc29jaWF0ZWQgcG9pbnRzIGZvcgorICogdGltZWxpbmUgdmFyaWFu
dHMgb2YgZHJtX3N5bmNvYmouIEl0IGlzIGludmFsaWQgdG8gYXBwZW5kIHRoaXMgc3RydWN0dXJl
IHRvCisgKiB0aGUgZXhlY2J1ZiBpZiBJOTE1X0VYRUNfRkVOQ0VfQVJSQVkgaXMgc2V0LgorICov
CitzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNidWZmZXJfZXh0X3RpbWVsaW5lX2ZlbmNlcyB7CisJ
c3RydWN0IGk5MTVfdXNlcl9leHRlbnNpb24gYmFzZTsKKworCS8qKgorCSAqIE51bWJlciBvZiBl
bGVtZW50IGluIHRoZSBoYW5kbGVzX3B0ciAmIHZhbHVlX3B0ciBhcnJheXMuCisJICovCisJX191
NjQgaGFuZGxlX2NvdW50OworCisJLyoqCisJICogUG9pbnRlciB0byBhbiBhcnJheSBvZiBzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNfZmVuY2Ugb2Ygc2l6ZSBoYW5kbGVfY291bnQuCisJICovCisJ
X191NjQgaGFuZGxlc19wdHI7CisKKwkvKioKKwkgKiBQb2ludGVyIHRvIGFuIGFycmF5IG9mIHU2
NCB2YWx1ZXMgb2Ygc2l6ZSBoYW5kbGVfY291bnQuIFZhbHVlcyBtdXN0CisJICogYmUgMCBmb3Ig
YSBiaW5hcnkgZHJtX3N5bmNvYmouCisJICovCisJX191NjQgdmFsdWVzX3B0cjsKK307CisKIHN0
cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgewogCS8qKgogCSAqIExpc3Qgb2YgZ2VtX2V4
ZWNfb2JqZWN0MiBzdHJ1Y3RzCi0tIAoyLjIxLjAuMzkyLmdmOGY2Nzg3MTU5ZQoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcg
bGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 3A8E568528
	for <lists+intel-gfx@lfdr.de>; Mon, 15 Jul 2019 10:28:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 422B68940E;
	Mon, 15 Jul 2019 08:27:58 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5961D8940E
 for <intel-gfx@lists.freedesktop.org>; Mon, 15 Jul 2019 08:27:54 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17303258-1500050 
 for multiple; Mon, 15 Jul 2019 09:09:54 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 15 Jul 2019 09:09:43 +0100
Message-Id: <20190715080946.15593-21-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190715080946.15593-1-chris@chris-wilson.co.uk>
References: <20190715080946.15593-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 21/24] drm/i915: Remove logical HW ID
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2Ugb25seSBuZWVkIHRvIGtlZXAgYSB1bmlxdWUgdGFnIGZvciB0aGUgYWN0aXZlIGxpZmV0aW1l
IG9mIHRoZQpjb250ZXh0LCBhbmQgZm9yIGFzIGxvbmcgYXMgd2UgbmVlZCB0byBpZGVudGlmeSB0
aGF0IGNvbnRleHQuIFRoZSBIVwp1c2VzIHRoZSB0YWcgdG8gZGV0ZXJtaW5lIGlmIGl0IHNob3Vs
ZCB1c2UgYSBsaXRlLXJlc3RvcmUgKHdoeSBub3QgdGhlCkxSQ0E/KSBhbmQgcGFzc2VzIHRoZSB0
YWcgYmFjayBmb3IgdmFyaW91cyBzdGF0dXMgaWRlbnRpZmllcy4gVGhlIG9ubHkKc3RhdHVzIHdl
IG5lZWQgdG8gdHJhY2sgaXMgZm9yIE9BLCBzbyB3aGVuIHVzaW5nIHBlcmYsIHdlIGFzc2lnbiB0
aGUKc3BlY2lmaWMgY29udGV4dCBhIHVuaXF1ZSB0YWcuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBX
aWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fY29udGV4dC5jICAgfCAxNTEgLS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oICAgfCAgMTUgLS0KIC4uLi9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaCB8ICAxOCAtLS0KIC4uLi9k
cm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYyB8ICAxMyArLQogLi4uL2dw
dS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5jIHwgICA4IC0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHRfdHlwZXMuaCB8ICAgMSArCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCAgfCAgIDUgKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAgICB8ICAyOCArKy0tCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndnQva3ZtZ3QuYyAgICAgICAgICAgICAgfCAgMTcgLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jICAgICAgICAgICB8ICAgMyAtCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jICAgICAgICAgfCAgIDcgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmggICAgICAgICB8ICAgMSAtCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3BlcmYuYyAgICAgICAgICAgICAgfCAgMjggKystLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV90cmFjZS5oICAgICAgICAgICAgIHwgIDM4ICsrLS0tCiAuLi4vZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3ZtYS5jICAgICB8ICAgMiArLQogMTYgZmlsZXMgY2hhbmdl
ZCwgNTEgaW5zZXJ0aW9ucygrKSwgMjg4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCmluZGV4IGU5ZjVlMTkyNjViOS4uMjY2OWUwMzg2
NjFlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4
dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAg
LTE2Nyw5NSArMTY3LDYgQEAgbG9va3VwX3VzZXJfZW5naW5lKHN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHgsCiAJcmV0dXJuIGk5MTVfZ2VtX2NvbnRleHRfZ2V0X2VuZ2luZShjdHgsIGlkeCk7
CiB9CiAKLXN0YXRpYyBpbmxpbmUgaW50IG5ld19od19pZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwgZ2ZwX3QgZ2ZwKQotewotCXVuc2lnbmVkIGludCBtYXg7Ci0KLQlsb2NrZGVwX2Fz
c2VydF9oZWxkKCZpOTE1LT5jb250ZXh0cy5tdXRleCk7Ci0KLQlpZiAoSU5URUxfR0VOKGk5MTUp
ID49IDExKQotCQltYXggPSBHRU4xMV9NQVhfQ09OVEVYVF9IV19JRDsKLQllbHNlIGlmIChVU0VT
X0dVQ19TVUJNSVNTSU9OKGk5MTUpKQotCQkvKgotCQkgKiBXaGVuIHVzaW5nIEd1QyBpbiBwcm94
eSBzdWJtaXNzaW9uLCBHdUMgY29uc3VtZXMgdGhlCi0JCSAqIGhpZ2hlc3QgYml0IGluIHRoZSBj
b250ZXh0IGlkIHRvIGluZGljYXRlIHByb3h5IHN1Ym1pc3Npb24uCi0JCSAqLwotCQltYXggPSBN
QVhfR1VDX0NPTlRFWFRfSFdfSUQ7Ci0JZWxzZQotCQltYXggPSBNQVhfQ09OVEVYVF9IV19JRDsK
LQotCXJldHVybiBpZGFfc2ltcGxlX2dldCgmaTkxNS0+Y29udGV4dHMuaHdfaWRhLCAwLCBtYXgs
IGdmcCk7Ci19Ci0KLXN0YXRpYyBpbnQgc3RlYWxfaHdfaWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCi17Ci0Jc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwgKmNuOwotCUxJU1Rf
SEVBRChwaW5uZWQpOwotCWludCBpZCA9IC1FTk9TUEM7Ci0KLQlsb2NrZGVwX2Fzc2VydF9oZWxk
KCZpOTE1LT5jb250ZXh0cy5tdXRleCk7Ci0KLQlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoY3R4
LCBjbiwKLQkJCQkgJmk5MTUtPmNvbnRleHRzLmh3X2lkX2xpc3QsIGh3X2lkX2xpbmspIHsKLQkJ
aWYgKGF0b21pY19yZWFkKCZjdHgtPmh3X2lkX3Bpbl9jb3VudCkpIHsKLQkJCWxpc3RfbW92ZV90
YWlsKCZjdHgtPmh3X2lkX2xpbmssICZwaW5uZWQpOwotCQkJY29udGludWU7Ci0JCX0KLQotCQlH
RU1fQlVHX09OKCFjdHgtPmh3X2lkKTsgLyogcGVybWEtcGlubmVkIGtlcm5lbCBjb250ZXh0ICov
Ci0JCWxpc3RfZGVsX2luaXQoJmN0eC0+aHdfaWRfbGluayk7Ci0JCWlkID0gY3R4LT5od19pZDsK
LQkJYnJlYWs7Ci0JfQotCi0JLyoKLQkgKiBSZW1lbWJlciBob3cgZmFyIHdlIGdvdCB1cCBvbiB0
aGUgbGFzdCByZXBvc3Nlc2lvbiBzY2FuLCBzbyB0aGUKLQkgKiBsaXN0IGlzIGtlcHQgaW4gYSAi
bGVhc3QgcmVjZW50bHkgc2Nhbm5lZCIgb3JkZXIuCi0JICovCi0JbGlzdF9zcGxpY2VfdGFpbCgm
cGlubmVkLCAmaTkxNS0+Y29udGV4dHMuaHdfaWRfbGlzdCk7Ci0JcmV0dXJuIGlkOwotfQotCi1z
dGF0aWMgaW50IGFzc2lnbl9od19pZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdW5z
aWduZWQgaW50ICpvdXQpCi17Ci0JaW50IHJldDsKLQotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5
MTUtPmNvbnRleHRzLm11dGV4KTsKLQotCS8qCi0JICogV2UgcHJlZmVyIHRvIHN0ZWFsL3N0YWxs
IG91cnNlbHZlcyBhbmQgb3VyIHVzZXJzIG92ZXIgdGhhdCBvZiB0aGUKLQkgKiBlbnRpcmUgc3lz
dGVtLiBUaGF0IG1heSBiZSBhIGxpdHRsZSB1bmZhaXIgdG8gb3VyIHVzZXJzLCBhbmQKLQkgKiBl
dmVuIGh1cnQgaGlnaCBwcmlvcml0eSBjbGllbnRzLiBUaGUgY2hvaWNlIGlzIHdoZXRoZXIgdG8g
b29ta2lsbAotCSAqIHNvbWV0aGluZyBlbHNlLCBvciBzdGVhbCBhIGNvbnRleHQgaWQuCi0JICov
Ci0JcmV0ID0gbmV3X2h3X2lkKGk5MTUsIEdGUF9LRVJORUwgfCBfX0dGUF9SRVRSWV9NQVlGQUlM
IHwgX19HRlBfTk9XQVJOKTsKLQlpZiAodW5saWtlbHkocmV0IDwgMCkpIHsKLQkJcmV0ID0gc3Rl
YWxfaHdfaWQoaTkxNSk7Ci0JCWlmIChyZXQgPCAwKSAvKiBvbmNlIGFnYWluIGZvciB0aGUgY29y
cmVjdCBlcnJubyBjb2RlICovCi0JCQlyZXQgPSBuZXdfaHdfaWQoaTkxNSwgR0ZQX0tFUk5FTCk7
Ci0JCWlmIChyZXQgPCAwKQotCQkJcmV0dXJuIHJldDsKLQl9Ci0KLQkqb3V0ID0gcmV0OwotCXJl
dHVybiAwOwotfQotCi1zdGF0aWMgdm9pZCByZWxlYXNlX2h3X2lkKHN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0ICpjdHgpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBjdHgtPmk5
MTU7Ci0KLQlpZiAobGlzdF9lbXB0eSgmY3R4LT5od19pZF9saW5rKSkKLQkJcmV0dXJuOwotCi0J
bXV0ZXhfbG9jaygmaTkxNS0+Y29udGV4dHMubXV0ZXgpOwotCWlmICghbGlzdF9lbXB0eSgmY3R4
LT5od19pZF9saW5rKSkgewotCQlpZGFfc2ltcGxlX3JlbW92ZSgmaTkxNS0+Y29udGV4dHMuaHdf
aWRhLCBjdHgtPmh3X2lkKTsKLQkJbGlzdF9kZWxfaW5pdCgmY3R4LT5od19pZF9saW5rKTsKLQl9
Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5jb250ZXh0cy5tdXRleCk7Ci19Ci0KIHN0YXRpYyB2b2lk
IF9fZnJlZV9lbmdpbmVzKHN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzICplLCB1bnNpZ25lZCBpbnQg
Y291bnQpCiB7CiAJd2hpbGUgKGNvdW50LS0pIHsKQEAgLTMwOSw3ICsyMjAsNiBAQCBzdGF0aWMg
dm9pZCBpOTE1X2dlbV9jb250ZXh0X2ZyZWUoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkK
IAlsb2NrZGVwX2Fzc2VydF9oZWxkKCZjdHgtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCUdF
TV9CVUdfT04oIWk5MTVfZ2VtX2NvbnRleHRfaXNfY2xvc2VkKGN0eCkpOwogCi0JcmVsZWFzZV9o
d19pZChjdHgpOwogCWlmIChjdHgtPnZtKQogCQlpOTE1X3ZtX3B1dChjdHgtPnZtKTsKIApAQCAt
MzgxLDEyICsyOTEsNiBAQCBzdGF0aWMgdm9pZCBjb250ZXh0X2Nsb3NlKHN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHgpCiAJaTkxNV9nZW1fY29udGV4dF9zZXRfY2xvc2VkKGN0eCk7CiAJY3R4
LT5maWxlX3ByaXYgPSBFUlJfUFRSKC1FQkFERik7CiAKLQkvKgotCSAqIFRoaXMgY29udGV4dCB3
aWxsIG5ldmVyIGFnYWluIGJlIGFzc2luZ2VkIHRvIEhXLCBzbyB3ZSBjYW4KLQkgKiByZXVzZSBp
dHMgSUQgZm9yIHRoZSBuZXh0IGNvbnRleHQuCi0JICovCi0JcmVsZWFzZV9od19pZChjdHgpOwot
CiAJLyoKIAkgKiBUaGUgTFVUIHVzZXMgdGhlIFZNQSBhcyBhIGJhY2twb2ludGVyIHRvIHVucmVm
IHRoZSBvYmplY3QsCiAJICogc28gd2UgbmVlZCB0byBjbGVhciB0aGUgTFVUIGJlZm9yZSB3ZSBj
bG9zZSBhbGwgdGhlIFZNQSAoaW5zaWRlCkBAIC00NDksNyArMzUzLDYgQEAgX19jcmVhdGVfY29u
dGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlSQ1VfSU5JVF9QT0lOVEVSKGN0
eC0+ZW5naW5lcywgZSk7CiAKIAlJTklUX1JBRElYX1RSRUUoJmN0eC0+aGFuZGxlc192bWEsIEdG
UF9LRVJORUwpOwotCUlOSVRfTElTVF9IRUFEKCZjdHgtPmh3X2lkX2xpbmspOwogCiAJLyogTkI6
IE1hcmsgYWxsIHNsaWNlcyBhcyBuZWVkaW5nIGEgcmVtYXAgc28gdGhhdCB3aGVuIHRoZSBjb250
ZXh0IGZpcnN0CiAJICogbG9hZHMgaXQgd2lsbCByZXN0b3JlIHdoYXRldmVyIHJlbWFwIHN0YXRl
IGFscmVhZHkgZXhpc3RzLiBJZiB0aGVyZQpAQCAtNTcyLDEzICs0NzUsNiBAQCBpOTE1X2dlbV9j
b250ZXh0X2NyZWF0ZV9ndnQoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAlpZiAoSVNfRVJSKGN0
eCkpCiAJCWdvdG8gb3V0OwogCi0JcmV0ID0gaTkxNV9nZW1fY29udGV4dF9waW5faHdfaWQoY3R4
KTsKLQlpZiAocmV0KSB7Ci0JCWNvbnRleHRfY2xvc2UoY3R4KTsKLQkJY3R4ID0gRVJSX1BUUihy
ZXQpOwotCQlnb3RvIG91dDsKLQl9Ci0KIAljdHgtPmZpbGVfcHJpdiA9IEVSUl9QVFIoLUVCQURG
KTsKIAlpOTE1X2dlbV9jb250ZXh0X3NldF9jbG9zZWQoY3R4KTsgLyogbm90IHVzZXIgYWNjZXNz
aWJsZSAqLwogCWk5MTVfZ2VtX2NvbnRleHRfY2xlYXJfYmFubmFibGUoY3R4KTsKQEAgLTYwOSwx
OCArNTA1LDExIEBAIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICoKIGk5MTVfZ2VtX2NvbnRleHRf
Y3JlYXRlX2tlcm5lbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHByaW8pCiB7
CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eDsKLQlpbnQgZXJyOwogCiAJY3R4ID0gaTkx
NV9nZW1fY3JlYXRlX2NvbnRleHQoaTkxNSwgMCk7CiAJaWYgKElTX0VSUihjdHgpKQogCQlyZXR1
cm4gY3R4OwogCi0JZXJyID0gaTkxNV9nZW1fY29udGV4dF9waW5faHdfaWQoY3R4KTsKLQlpZiAo
ZXJyKSB7Ci0JCWRlc3Ryb3lfa2VybmVsX2NvbnRleHQoJmN0eCk7Ci0JCXJldHVybiBFUlJfUFRS
KGVycik7Ci0JfQotCiAJaTkxNV9nZW1fY29udGV4dF9jbGVhcl9iYW5uYWJsZShjdHgpOwogCWN0
eC0+c2NoZWQucHJpb3JpdHkgPSBJOTE1X1VTRVJfUFJJT1JJVFkocHJpbyk7CiAJY3R4LT5yaW5n
X3NpemUgPSBQQUdFX1NJWkU7CkBAIC02NjAsMTUgKzU0OSw2IEBAIGludCBpOTE1X2dlbV9jb250
ZXh0c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJRFJNX0VSUk9S
KCJGYWlsZWQgdG8gY3JlYXRlIGRlZmF1bHQgZ2xvYmFsIGNvbnRleHRcbiIpOwogCQlyZXR1cm4g
UFRSX0VSUihjdHgpOwogCX0KLQkvKgotCSAqIEZvciBlYXN5IHJlY29nbmlzYWJsaXR5LCB3ZSB3
YW50IHRoZSBrZXJuZWwgY29udGV4dCB0byBiZSAwIGFuZCB0aGVuCi0JICogYWxsIHVzZXIgY29u
dGV4dHMgd2lsbCBoYXZlIG5vbi16ZXJvIGh3X2lkLiBLZXJuZWwgY29udGV4dHMgYXJlCi0JICog
cGVybWFuZW50bHkgcGlubmVkLCBzbyB0aGF0IHdlIG5ldmVyIHN1ZmZlciBhIHN0YWxsIGFuZCBj
YW4KLQkgKiB1c2UgdGhlbSBmcm9tIGFueSBhbGxvY2F0aW9uIGNvbnRleHQgKGUuZy4gZm9yIGV2
aWN0aW5nIG90aGVyCi0JICogY29udGV4dHMgYW5kIGZyb20gaW5zaWRlIHRoZSBzaHJpbmtlciku
Ci0JICovCi0JR0VNX0JVR19PTihjdHgtPmh3X2lkKTsKLQlHRU1fQlVHX09OKCFhdG9taWNfcmVh
ZCgmY3R4LT5od19pZF9waW5fY291bnQpKTsKIAlkZXZfcHJpdi0+a2VybmVsX2NvbnRleHQgPSBj
dHg7CiAKIAlEUk1fREVCVUdfRFJJVkVSKCIlcyBjb250ZXh0IHN1cHBvcnQgaW5pdGlhbGl6ZWRc
biIsCkBAIC02ODIsMTAgKzU2Miw2IEBAIHZvaWQgaTkxNV9nZW1fY29udGV4dHNfZmluaShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKIAogCWRlc3Ryb3lfa2VybmVsX2NvbnRleHQoJmk5MTUtPmtlcm5l
bF9jb250ZXh0KTsKLQotCS8qIE11c3QgZnJlZSBhbGwgZGVmZXJyZWQgY29udGV4dHMgKHZpYSBm
bHVzaF93b3JrcXVldWUpIGZpcnN0ICovCi0JR0VNX0JVR19PTighbGlzdF9lbXB0eSgmaTkxNS0+
Y29udGV4dHMuaHdfaWRfbGlzdCkpOwotCWlkYV9kZXN0cm95KCZpOTE1LT5jb250ZXh0cy5od19p
ZGEpOwogfQogCiBzdGF0aWMgaW50IGNvbnRleHRfaWRyX2NsZWFudXAoaW50IGlkLCB2b2lkICpw
LCB2b2lkICpkYXRhKQpAQCAtMjM2NiwzMyArMjI0Miw2IEBAIGludCBpOTE1X2dlbV9jb250ZXh0
X3Jlc2V0X3N0YXRzX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJcmV0dXJuIHJldDsK
IH0KIAotaW50IF9faTkxNV9nZW1fY29udGV4dF9waW5faHdfaWQoc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eCkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkx
NTsKLQlpbnQgZXJyID0gMDsKLQotCW11dGV4X2xvY2soJmk5MTUtPmNvbnRleHRzLm11dGV4KTsK
LQotCUdFTV9CVUdfT04oaTkxNV9nZW1fY29udGV4dF9pc19jbG9zZWQoY3R4KSk7Ci0KLQlpZiAo
bGlzdF9lbXB0eSgmY3R4LT5od19pZF9saW5rKSkgewotCQlHRU1fQlVHX09OKGF0b21pY19yZWFk
KCZjdHgtPmh3X2lkX3Bpbl9jb3VudCkpOwotCi0JCWVyciA9IGFzc2lnbl9od19pZChpOTE1LCAm
Y3R4LT5od19pZCk7Ci0JCWlmIChlcnIpCi0JCQlnb3RvIG91dF91bmxvY2s7Ci0KLQkJbGlzdF9h
ZGRfdGFpbCgmY3R4LT5od19pZF9saW5rLCAmaTkxNS0+Y29udGV4dHMuaHdfaWRfbGlzdCk7Ci0J
fQotCi0JR0VNX0JVR19PTihhdG9taWNfcmVhZCgmY3R4LT5od19pZF9waW5fY291bnQpID09IH4w
dSk7Ci0JYXRvbWljX2luYygmY3R4LT5od19pZF9waW5fY291bnQpOwotCi1vdXRfdW5sb2NrOgot
CW11dGV4X3VubG9jaygmaTkxNS0+Y29udGV4dHMubXV0ZXgpOwotCXJldHVybiBlcnI7Ci19Ci0K
IC8qIEdFTSBjb250ZXh0LWVuZ2luZXMgaXRlcmF0b3I6IGZvcl9lYWNoX2dlbV9lbmdpbmUoKSAq
Lwogc3RydWN0IGludGVsX2NvbnRleHQgKgogaTkxNV9nZW1fZW5naW5lc19pdGVyX25leHQoc3Ry
dWN0IGk5MTVfZ2VtX2VuZ2luZXNfaXRlciAqaXQpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2NvbnRleHQuaAppbmRleCAxMDZlMmNjZjdhNGMuLjZmYjNhZDdlMDNmYyAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCkBAIC0xMTIsMjEg
KzExMiw2IEBAIGk5MTVfZ2VtX2NvbnRleHRfY2xlYXJfdXNlcl9lbmdpbmVzKHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgpCiAJY2xlYXJfYml0KENPTlRFWFRfVVNFUl9FTkdJTkVTLCAmY3R4
LT5mbGFncyk7CiB9CiAKLWludCBfX2k5MTVfZ2VtX2NvbnRleHRfcGluX2h3X2lkKHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpjdHgpOwotc3RhdGljIGlubGluZSBpbnQgaTkxNV9nZW1fY29udGV4
dF9waW5faHdfaWQoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKLXsKLQlpZiAoYXRvbWlj
X2luY19ub3RfemVybygmY3R4LT5od19pZF9waW5fY291bnQpKQotCQlyZXR1cm4gMDsKLQotCXJl
dHVybiBfX2k5MTVfZ2VtX2NvbnRleHRfcGluX2h3X2lkKGN0eCk7Ci19Ci0KLXN0YXRpYyBpbmxp
bmUgdm9pZCBpOTE1X2dlbV9jb250ZXh0X3VucGluX2h3X2lkKHN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHgpCi17Ci0JR0VNX0JVR19PTihhdG9taWNfcmVhZCgmY3R4LT5od19pZF9waW5fY291
bnQpID09IDB1KTsKLQlhdG9taWNfZGVjKCZjdHgtPmh3X2lkX3Bpbl9jb3VudCk7Ci19Ci0KIHN0
YXRpYyBpbmxpbmUgYm9vbCBpOTE1X2dlbV9jb250ZXh0X2lzX2tlcm5lbChzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dCAqY3R4KQogewogCXJldHVybiAhY3R4LT5maWxlX3ByaXY7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaAppbmRleCAwZWU2
MTQ4MmVmOTQuLjgwY2QzYWIzNTVlMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oCkBAIC0xNDcsMjQgKzE0Nyw2IEBAIHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0IHsKICNkZWZpbmUgQ09OVEVYVF9GT1JDRV9TSU5HTEVfU1VCTUlTU0lP
TgkyCiAjZGVmaW5lIENPTlRFWFRfVVNFUl9FTkdJTkVTCQkzCiAKLQkvKioKLQkgKiBAaHdfaWQ6
IC0gdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBjb250ZXh0Ci0JICoKLQkgKiBUaGUgaGFyZHdh
cmUgbmVlZHMgdG8gdW5pcXVlbHkgaWRlbnRpZnkgdGhlIGNvbnRleHQgZm9yIGEgZmV3Ci0JICog
ZnVuY3Rpb25zIGxpa2UgZmF1bHQgcmVwb3J0aW5nLCBQQVNJRCwgc2NoZWR1bGluZy4gVGhlCi0J
ICogJmRybV9pOTE1X3ByaXZhdGUuY29udGV4dF9od19pZGEgaXMgdXNlZCB0byBhc3NpZ24gYSB1
bnFpdWUKLQkgKiBpZCBmb3IgdGhlIGxpZmV0aW1lIG9mIHRoZSBjb250ZXh0LgotCSAqCi0JICog
QGh3X2lkX3Bpbl9jb3VudDogLSBudW1iZXIgb2YgdGltZXMgdGhpcyBjb250ZXh0IGhhZCBiZWVu
IHBpbm5lZAotCSAqIGZvciB1c2UgKHNob3VsZCBiZSwgYXQgbW9zdCwgb25jZSBwZXIgZW5naW5l
KS4KLQkgKgotCSAqIEBod19pZF9saW5rOiAtIGFsbCBjb250ZXh0cyB3aXRoIGFuIGFzc2lnbmVk
IGlkIGFyZSB0cmFja2VkCi0JICogZm9yIHBvc3NpYmxlIHJlcG9zc2Vzc2lvbi4KLQkgKi8KLQl1
bnNpZ25lZCBpbnQgaHdfaWQ7Ci0JYXRvbWljX3QgaHdfaWRfcGluX2NvdW50OwotCXN0cnVjdCBs
aXN0X2hlYWQgaHdfaWRfbGluazsKLQogCXN0cnVjdCBtdXRleCBtdXRleDsKIAogCXN0cnVjdCBp
OTE1X3NjaGVkX2F0dHIgc2NoZWQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jCmluZGV4IGRiNzg1NmYwZjMxZS4uYTdiNmRh
MjlmM2RmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5
MTVfZ2VtX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3Rz
L2k5MTVfZ2VtX2NvbnRleHQuYwpAQCAtNTI0LDkgKzUyNCw5IEBAIHN0YXRpYyBpbnQgaWd0X2N0
eF9leGVjKHZvaWQgKmFyZykKIAogCQkJZXJyID0gZ3B1X2ZpbGwob2JqLCBjdHgsIGVuZ2luZSwg
ZHcpOwogCQkJaWYgKGVycikgewotCQkJCXByX2VycigiRmFpbGVkIHRvIGZpbGwgZHdvcmQgJWx1
IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMpIGluIGN0eCAldSBbZnVsbC1wcGd0dD8gJXNdLCBlcnI9
JWRcbiIsCisJCQkJcHJfZXJyKCJGYWlsZWQgdG8gZmlsbCBkd29yZCAlbHUgWyVsdS8lbHVdIHdp
dGggZ3B1ICglcykgW2Z1bGwtcHBndHQ/ICVzXSwgZXJyPSVkXG4iLAogCQkJCSAgICAgICBuZHdv
cmRzLCBkdywgbWF4X2R3b3JkcyhvYmopLAotCQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGN0eC0+
aHdfaWQsCisJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwKIAkJCQkgICAgICAgeWVzbm8oISFjdHgt
PnZtKSwgZXJyKTsKIAkJCQlnb3RvIG91dF91bmxvY2s7CiAJCQl9CkBAIC02NDMsOSArNjQzLDkg
QEAgc3RhdGljIGludCBpZ3Rfc2hhcmVkX2N0eF9leGVjKHZvaWQgKmFyZykKIAogCQkJZXJyID0g
Z3B1X2ZpbGwob2JqLCBjdHgsIGVuZ2luZSwgZHcpOwogCQkJaWYgKGVycikgewotCQkJCXByX2Vy
cigiRmFpbGVkIHRvIGZpbGwgZHdvcmQgJWx1IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMpIGluIGN0
eCAldSBbZnVsbC1wcGd0dD8gJXNdLCBlcnI9JWRcbiIsCisJCQkJcHJfZXJyKCJGYWlsZWQgdG8g
ZmlsbCBkd29yZCAlbHUgWyVsdS8lbHVdIHdpdGggZ3B1ICglcykgW2Z1bGwtcHBndHQ/ICVzXSwg
ZXJyPSVkXG4iLAogCQkJCSAgICAgICBuZHdvcmRzLCBkdywgbWF4X2R3b3JkcyhvYmopLAotCQkJ
CSAgICAgICBlbmdpbmUtPm5hbWUsIGN0eC0+aHdfaWQsCisJCQkJICAgICAgIGVuZ2luZS0+bmFt
ZSwKIAkJCQkgICAgICAgeWVzbm8oISFjdHgtPnZtKSwgZXJyKTsKIAkJCQlrZXJuZWxfY29udGV4
dF9jbG9zZShjdHgpOwogCQkJCWdvdG8gb3V0X3Rlc3Q7CkBAIC0xMjE5LDEwICsxMjE5LDkgQEAg
c3RhdGljIGludCBpZ3RfY3R4X3JlYWRvbmx5KHZvaWQgKmFyZykKIAogCQkJZXJyID0gZ3B1X2Zp
bGwob2JqLCBjdHgsIGVuZ2luZSwgZHcpOwogCQkJaWYgKGVycikgewotCQkJCXByX2VycigiRmFp
bGVkIHRvIGZpbGwgZHdvcmQgJWx1IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMpIGluIGN0eCAldSBb
ZnVsbC1wcGd0dD8gJXNdLCBlcnI9JWRcbiIsCisJCQkJcHJfZXJyKCJGYWlsZWQgdG8gZmlsbCBk
d29yZCAlbHUgWyVsdS8lbHVdIHdpdGggZ3B1ICglcykgW2Z1bGwtcHBndHQ/ICVzXSwgZXJyPSVk
XG4iLAogCQkJCSAgICAgICBuZHdvcmRzLCBkdywgbWF4X2R3b3JkcyhvYmopLAotCQkJCSAgICAg
ICBlbmdpbmUtPm5hbWUsIGN0eC0+aHdfaWQsCi0JCQkJICAgICAgIHllc25vKCEhY3R4LT52bSks
IGVycik7CisJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwgeWVzbm8oISFjdHgtPnZtKSwgZXJyKTsK
IAkJCQlnb3RvIG91dF91bmxvY2s7CiAJCQl9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5jCmluZGV4IGJlODk3NGNjZmYyNC4uMDEwNGYx
NmIxMzI3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL21v
Y2tfY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvbW9j
a19jb250ZXh0LmMKQEAgLTEzLDcgKzEzLDYgQEAgbW9ja19jb250ZXh0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAogewogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CiAJc3Ry
dWN0IGk5MTVfZ2VtX2VuZ2luZXMgKmU7Ci0JaW50IHJldDsKIAogCWN0eCA9IGt6YWxsb2Moc2l6
ZW9mKCpjdHgpLCBHRlBfS0VSTkVMKTsKIAlpZiAoIWN0eCkKQEAgLTMwLDEzICsyOSw4IEBAIG1v
Y2tfY29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlSQ1VfSU5JVF9QT0lO
VEVSKGN0eC0+ZW5naW5lcywgZSk7CiAKIAlJTklUX1JBRElYX1RSRUUoJmN0eC0+aGFuZGxlc192
bWEsIEdGUF9LRVJORUwpOwotCUlOSVRfTElTVF9IRUFEKCZjdHgtPmh3X2lkX2xpbmspOwogCW11
dGV4X2luaXQoJmN0eC0+bXV0ZXgpOwogCi0JcmV0ID0gaTkxNV9nZW1fY29udGV4dF9waW5faHdf
aWQoY3R4KTsKLQlpZiAocmV0IDwgMCkKLQkJZ290byBlcnJfZW5naW5lczsKLQogCWlmIChuYW1l
KSB7CiAJCXN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dDsKIApAQCAtNTQsOCArNDgsNiBAQCBtb2Nr
X2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAKIAlyZXR1cm4gY3R4Owog
Ci1lcnJfZW5naW5lczoKLQlmcmVlX2VuZ2luZXMocmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+ZW5n
aW5lcykpOwogZXJyX2ZyZWU6CiAJa2ZyZWUoY3R4KTsKIAlyZXR1cm4gTlVMTDsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHRfdHlwZXMuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHRfdHlwZXMuaAppbmRleCBjMDA0MTllMzhh
NzcuLjM2Mzk0ZDQwNjFlNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfY29udGV4dF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Nv
bnRleHRfdHlwZXMuaApAQCAtNTIsNiArNTIsNyBAQCBzdHJ1Y3QgaW50ZWxfY29udGV4dCB7CiAK
IAl1MzIgKmxyY19yZWdfc3RhdGU7CiAJdTY0IGxyY19kZXNjOworCXUzMiBod190YWc7CiAKIAl1
bnNpZ25lZCBpbnQgYWN0aXZlX2NvdW50OyAvKiBwcm90ZWN0ZWQgYnkgdGltZWxpbmUtPm11dGV4
ICovCiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90
eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKaW5k
ZXggMWRhOGQyZjM0YzU2Li4xMjFhYmU1YjA4ZTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCkBAIC0yNzAsMTAgKzI3MCwxMyBAQCBzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzIHsKIAogCXU4IGNsYXNzOwogCXU4IGluc3RhbmNlOworCisJdTMyIHVhYmlf
Y2FwYWJpbGl0aWVzOwogCXUzMiBjb250ZXh0X3NpemU7CiAJdTMyIG1taW9fYmFzZTsKIAotCXUz
MiB1YWJpX2NhcGFiaWxpdGllczsKKwl1bnNpZ25lZCBpbnQgaHdfdGFnOworI2RlZmluZSBOVU1f
SFdfVEFHICgyNTYpCiAKIAlzdHJ1Y3QgcmJfbm9kZSB1YWJpX25vZGU7CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfbHJjLmMKaW5kZXggMThkOWRkYzVjZDU4Li5hZTE1ZTBkZDk4YWMgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCkBAIC00MTIsOSArNDEyLDYgQEAgbHJjX2Rlc2Ny
aXB0b3Ioc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUpCiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9IGNlLT5nZW1fY29udGV4dDsK
IAl1NjQgZGVzYzsKIAotCUJVSUxEX0JVR19PTihNQVhfQ09OVEVYVF9IV19JRCA+IChCSVQoR0VO
OF9DVFhfSURfV0lEVEgpKSk7Ci0JQlVJTERfQlVHX09OKEdFTjExX01BWF9DT05URVhUX0hXX0lE
ID4gKEJJVChHRU4xMV9TV19DVFhfSURfV0lEVEgpKSk7Ci0KIAlkZXNjID0gY3R4LT5kZXNjX3Rl
bXBsYXRlOwkJCQkvKiBiaXRzICAwLTExICovCiAJR0VNX0JVR19PTihkZXNjICYgR0VOTUFTS19V
TEwoNjMsIDEyKSk7CiAKQEAgLTQyOCwyMCArNDI1LDExIEBAIGxyY19kZXNjcmlwdG9yKHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSwgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCSAq
IGFueXRoaW5nIGJlbG93LgogCSAqLwogCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAx
MSkgewotCQlHRU1fQlVHX09OKGN0eC0+aHdfaWQgPj0gQklUKEdFTjExX1NXX0NUWF9JRF9XSURU
SCkpOwotCQlkZXNjIHw9ICh1NjQpY3R4LT5od19pZCA8PCBHRU4xMV9TV19DVFhfSURfU0hJRlQ7
Ci0JCQkJCQkJCS8qIGJpdHMgMzctNDcgKi8KLQogCQlkZXNjIHw9ICh1NjQpZW5naW5lLT5pbnN0
YW5jZSA8PCBHRU4xMV9FTkdJTkVfSU5TVEFOQ0VfU0hJRlQ7CiAJCQkJCQkJCS8qIGJpdHMgNDgt
NTMgKi8KIAotCQkvKiBUT0RPOiBkZWNpZGUgd2hhdCB0byBkbyB3aXRoIFNXIGNvdW50ZXIgKGJp
dHMgNTUtNjApICovCi0KIAkJZGVzYyB8PSAodTY0KWVuZ2luZS0+Y2xhc3MgPDwgR0VOMTFfRU5H
SU5FX0NMQVNTX1NISUZUOwogCQkJCQkJCQkvKiBiaXRzIDYxLTYzICovCi0JfSBlbHNlIHsKLQkJ
R0VNX0JVR19PTihjdHgtPmh3X2lkID49IEJJVChHRU44X0NUWF9JRF9XSURUSCkpOwotCQlkZXNj
IHw9ICh1NjQpY3R4LT5od19pZCA8PCBHRU44X0NUWF9JRF9TSElGVDsJLyogYml0cyAzMi01MiAq
LwogCX0KIAogCXJldHVybiBkZXNjOwpAQCAtNTM3LDYgKzUyNSwxNSBAQCBleGVjbGlzdHNfc2No
ZWR1bGVfaW4oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIGludCBpZHgpCiAJCWludGVsX2NvbnRl
eHRfZ2V0KGNlKTsKIAkJY2UtPmluZmxpZ2h0ID0gcnEtPmVuZ2luZTsKIAorCQlpZiAoY2UtPmh3
X3RhZykgeworCQkJY2UtPmxyY19kZXNjIHw9ICh1NjQpY2UtPmh3X3RhZyA8PCAzMjsKKwkJfSBl
bHNlIHsKKwkJCWNlLT5scmNfZGVzYyAmPSB+R0VOTUFTS19VTEwoNDcsIDM3KTsKKwkJCWNlLT5s
cmNfZGVzYyB8PQorCQkJCSh1NjQpKHJxLT5lbmdpbmUtPmh3X3RhZysrICUgTlVNX0hXX1RBRykg
PDwKKwkJCQlHRU4xMV9TV19DVFhfSURfU0hJRlQ7CisJCX0KKwogCQlleGVjbGlzdHNfY29udGV4
dF9zdGF0dXNfY2hhbmdlKHJxLCBJTlRFTF9DT05URVhUX1NDSEVEVUxFX0lOKTsKIAkJaW50ZWxf
ZW5naW5lX2NvbnRleHRfaW4oY2UtPmluZmxpZ2h0KTsKIAl9CkBAIC0xNTUxLDcgKzE1NDgsNiBA
QCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfY29udGV4dF9kZXN0cm95KHN0cnVjdCBrcmVmICprcmVm
KQogCiBzdGF0aWMgdm9pZCBleGVjbGlzdHNfY29udGV4dF91bnBpbihzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqY2UpCiB7Ci0JaTkxNV9nZW1fY29udGV4dF91bnBpbl9od19pZChjZS0+Z2VtX2NvbnRl
eHQpOwogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoY2UtPnN0YXRlLT5vYmopOwogCWludGVs
X3JpbmdfcmVzZXQoY2UtPnJpbmcsIGNlLT5yaW5nLT50YWlsKTsKIH0KQEAgLTE2MDYsMTggKzE2
MDIsMTIgQEAgX19leGVjbGlzdHNfY29udGV4dF9waW4oc3RydWN0IGludGVsX2NvbnRleHQgKmNl
LAogCQlnb3RvIHVucGluX2FjdGl2ZTsKIAl9CiAKLQlyZXQgPSBpOTE1X2dlbV9jb250ZXh0X3Bp
bl9od19pZChjZS0+Z2VtX2NvbnRleHQpOwotCWlmIChyZXQpCi0JCWdvdG8gdW5waW5fbWFwOwot
CiAJY2UtPmxyY19kZXNjID0gbHJjX2Rlc2NyaXB0b3IoY2UsIGVuZ2luZSk7CiAJY2UtPmxyY19y
ZWdfc3RhdGUgPSB2YWRkciArIExSQ19TVEFURV9QTiAqIFBBR0VfU0laRTsKIAlfX2V4ZWNsaXN0
c191cGRhdGVfcmVnX3N0YXRlKGNlLCBlbmdpbmUpOwogCiAJcmV0dXJuIDA7CiAKLXVucGluX21h
cDoKLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGNlLT5zdGF0ZS0+b2JqKTsKIHVucGluX2Fj
dGl2ZToKIAlpbnRlbF9jb250ZXh0X2FjdGl2ZV9yZWxlYXNlKGNlKTsKIGVycjoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9rdm1ndC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Z0L2t2bWd0LmMKaW5kZXggMTQ0MzAxYjc3OGRmLi45NDFkMGYwOGIwNDcgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9rdm1ndC5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9rdm1ndC5jCkBAIC0xNTY2LDI3ICsxNTY2LDEwIEBAIHZncHVfaWRfc2hvdyhz
dHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAogCXJldHVy
biBzcHJpbnRmKGJ1ZiwgIlxuIik7CiB9CiAKLXN0YXRpYyBzc2l6ZV90Ci1od19pZF9zaG93KHN0
cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCi0JICAgY2hh
ciAqYnVmKQotewotCXN0cnVjdCBtZGV2X2RldmljZSAqbWRldiA9IG1kZXZfZnJvbV9kZXYoZGV2
KTsKLQotCWlmIChtZGV2KSB7Ci0JCXN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1ID0gKHN0cnVjdCBp
bnRlbF92Z3B1ICopCi0JCQltZGV2X2dldF9kcnZkYXRhKG1kZXYpOwotCQlyZXR1cm4gc3ByaW50
ZihidWYsICIldVxuIiwKLQkJCSAgICAgICB2Z3B1LT5zdWJtaXNzaW9uLnNoYWRvd1swXS0+Z2Vt
X2NvbnRleHQtPmh3X2lkKTsKLQl9Ci0JcmV0dXJuIHNwcmludGYoYnVmLCAiXG4iKTsKLX0KLQog
c3RhdGljIERFVklDRV9BVFRSX1JPKHZncHVfaWQpOwotc3RhdGljIERFVklDRV9BVFRSX1JPKGh3
X2lkKTsKIAogc3RhdGljIHN0cnVjdCBhdHRyaWJ1dGUgKmludGVsX3ZncHVfYXR0cnNbXSA9IHsK
IAkmZGV2X2F0dHJfdmdwdV9pZC5hdHRyLAotCSZkZXZfYXR0cl9od19pZC5hdHRyLAogCU5VTEwK
IH07CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggYjZiODA5NjNmOTkyLi5i
N2VjOWYzY2RjMmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdm
cy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC0xNTgxLDkg
KzE1ODEsNiBAQCBzdGF0aWMgaW50IGk5MTVfY29udGV4dF9zdGF0dXMoc3RydWN0IHNlcV9maWxl
ICptLCB2b2lkICp1bnVzZWQpCiAJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKIAogCQlzZXFf
cHV0cyhtLCAiSFcgY29udGV4dCAiKTsKLQkJaWYgKCFsaXN0X2VtcHR5KCZjdHgtPmh3X2lkX2xp
bmspKQotCQkJc2VxX3ByaW50ZihtLCAiJXggW3BpbiAldV0iLCBjdHgtPmh3X2lkLAotCQkJCSAg
IGF0b21pY19yZWFkKCZjdHgtPmh3X2lkX3Bpbl9jb3VudCkpOwogCQlpZiAoY3R4LT5waWQpIHsK
IAkJCXN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzazsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1
X2Vycm9yLmMKaW5kZXggMDI2ZWUxZjU1MzZkLi43NTY3MWZhZjI2M2QgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9ncHVfZXJyb3IuYwpAQCAtNTA2LDkgKzUwNiw5IEBAIHN0YXRpYyB2b2lkIGVy
cm9yX3ByaW50X2NvbnRleHQoc3RydWN0IGRybV9pOTE1X2Vycm9yX3N0YXRlX2J1ZiAqbSwKIAkJ
CQljb25zdCBjaGFyICpoZWFkZXIsCiAJCQkJY29uc3Qgc3RydWN0IGRybV9pOTE1X2Vycm9yX2Nv
bnRleHQgKmN0eCkKIHsKLQllcnJfcHJpbnRmKG0sICIlcyVzWyVkXSBod19pZCAlZCwgcHJpbyAl
ZCwgZ3VpbHR5ICVkIGFjdGl2ZSAlZFxuIiwKLQkJICAgaGVhZGVyLCBjdHgtPmNvbW0sIGN0eC0+
cGlkLCBjdHgtPmh3X2lkLAotCQkgICBjdHgtPnNjaGVkX2F0dHIucHJpb3JpdHksIGN0eC0+Z3Vp
bHR5LCBjdHgtPmFjdGl2ZSk7CisJZXJyX3ByaW50ZihtLCAiJXMlc1slZF0gcHJpbyAlZCwgZ3Vp
bHR5ICVkIGFjdGl2ZSAlZFxuIiwKKwkJICAgaGVhZGVyLCBjdHgtPmNvbW0sIGN0eC0+cGlkLCBj
dHgtPnNjaGVkX2F0dHIucHJpb3JpdHksCisJCSAgIGN0eC0+Z3VpbHR5LCBjdHgtPmFjdGl2ZSk7
CiB9CiAKIHN0YXRpYyB2b2lkIGVycm9yX3ByaW50X2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfZXJy
b3Jfc3RhdGVfYnVmICptLApAQCAtMTMxMCw3ICsxMzEwLDYgQEAgc3RhdGljIHZvaWQgcmVjb3Jk
X2NvbnRleHQoc3RydWN0IGRybV9pOTE1X2Vycm9yX2NvbnRleHQgKmUsCiAJCXJjdV9yZWFkX3Vu
bG9jaygpOwogCX0KIAotCWUtPmh3X2lkID0gY3R4LT5od19pZDsKIAllLT5zY2hlZF9hdHRyID0g
Y3R4LT5zY2hlZDsKIAllLT5ndWlsdHkgPSBhdG9taWNfcmVhZCgmY3R4LT5ndWlsdHlfY291bnQp
OwogCWUtPmFjdGl2ZSA9IGF0b21pY19yZWFkKCZjdHgtPmFjdGl2ZV9jb3VudCk7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuaAppbmRleCBhMjRjMzUxMDdkMTYuLjFkOTUxZWFlN2Uy
ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5oCkBAIC0xMTcsNyArMTE3LDYg
QEAgc3RydWN0IGk5MTVfZ3B1X3N0YXRlIHsKIAkJc3RydWN0IGRybV9pOTE1X2Vycm9yX2NvbnRl
eHQgewogCQkJY2hhciBjb21tW1RBU0tfQ09NTV9MRU5dOwogCQkJcGlkX3QgcGlkOwotCQkJdTMy
IGh3X2lkOwogCQkJaW50IGFjdGl2ZTsKIAkJCWludCBndWlsdHk7CiAJCQlzdHJ1Y3QgaTkxNV9z
Y2hlZF9hdHRyIHNjaGVkX2F0dHI7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3BlcmYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCmluZGV4IDU4YTcx
ZWZjMjVkYi4uZGYwMmUwZmUwNzAxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3BlcmYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwpAQCAtMTI5
MywxOSArMTI5MywxNCBAQCBzdGF0aWMgaW50IG9hX2dldF9yZW5kZXJfY3R4X2lkKHN0cnVjdCBp
OTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCiAJCQlpOTE1LT5wZXJmLm9hLnNwZWNpZmljX2N0eF9p
ZF9tYXNrID0KIAkJCQkoMVUgPDwgR0VOOF9DVFhfSURfV0lEVEgpIC0gMTsKIAkJCWk5MTUtPnBl
cmYub2Euc3BlY2lmaWNfY3R4X2lkID0KLQkJCQl1cHBlcl8zMl9iaXRzKGNlLT5scmNfZGVzYyk7
Ci0JCQlpOTE1LT5wZXJmLm9hLnNwZWNpZmljX2N0eF9pZCAmPQogCQkJCWk5MTUtPnBlcmYub2Eu
c3BlY2lmaWNfY3R4X2lkX21hc2s7CiAJCX0KIAkJYnJlYWs7CiAKIAljYXNlIDExOiB7CiAJCWk5
MTUtPnBlcmYub2Euc3BlY2lmaWNfY3R4X2lkX21hc2sgPQotCQkJKCgxVSA8PCBHRU4xMV9TV19D
VFhfSURfV0lEVEgpIC0gMSkgPDwgKEdFTjExX1NXX0NUWF9JRF9TSElGVCAtIDMyKSB8Ci0JCQko
KDFVIDw8IEdFTjExX0VOR0lORV9JTlNUQU5DRV9XSURUSCkgLSAxKSA8PCAoR0VOMTFfRU5HSU5F
X0lOU1RBTkNFX1NISUZUIC0gMzIpIHwKLQkJCSgoMSA8PCBHRU4xMV9FTkdJTkVfQ0xBU1NfV0lE
VEgpIC0gMSkgPDwgKEdFTjExX0VOR0lORV9DTEFTU19TSElGVCAtIDMyKTsKLQkJaTkxNS0+cGVy
Zi5vYS5zcGVjaWZpY19jdHhfaWQgPSB1cHBlcl8zMl9iaXRzKGNlLT5scmNfZGVzYyk7Ci0JCWk5
MTUtPnBlcmYub2Euc3BlY2lmaWNfY3R4X2lkICY9CisJCQkoKDFVIDw8IEdFTjExX1NXX0NUWF9J
RF9XSURUSCkgLSAxKSA8PCAoR0VOMTFfU1dfQ1RYX0lEX1NISUZUIC0gMzIpOworCQlpOTE1LT5w
ZXJmLm9hLnNwZWNpZmljX2N0eF9pZCA9CiAJCQlpOTE1LT5wZXJmLm9hLnNwZWNpZmljX2N0eF9p
ZF9tYXNrOwogCQlicmVhazsKIAl9CkBAIC0xMzE0LDYgKzEzMDksOCBAQCBzdGF0aWMgaW50IG9h
X2dldF9yZW5kZXJfY3R4X2lkKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0pCiAJCU1J
U1NJTkdfQ0FTRShJTlRFTF9HRU4oaTkxNSkpOwogCX0KIAorCWNlLT5od190YWcgPSBpOTE1LT5w
ZXJmLm9hLnNwZWNpZmljX2N0eF9pZF9tYXNrOworCiAJRFJNX0RFQlVHX0RSSVZFUigiZmlsdGVy
aW5nIG9uIGN0eF9pZD0weCV4IGN0eF9pZF9tYXNrPTB4JXhcbiIsCiAJCQkgaTkxNS0+cGVyZi5v
YS5zcGVjaWZpY19jdHhfaWQsCiAJCQkgaTkxNS0+cGVyZi5vYS5zcGVjaWZpY19jdHhfaWRfbWFz
ayk7CkBAIC0xMzMwLDE4ICsxMzI3LDE5IEBAIHN0YXRpYyBpbnQgb2FfZ2V0X3JlbmRlcl9jdHhf
aWQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKICAqLwogc3RhdGljIHZvaWQgb2Ff
cHV0X3JlbmRlcl9jdHhfaWQoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKIHsKLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBzdHJlYW0tPmRldl9wcml2OworCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gc3RyZWFtLT5kZXZfcHJpdjsKIAlzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2U7CiAKLQlkZXZfcHJpdi0+cGVyZi5vYS5zcGVjaWZpY19jdHhfaWQg
PSBJTlZBTElEX0NUWF9JRDsKLQlkZXZfcHJpdi0+cGVyZi5vYS5zcGVjaWZpY19jdHhfaWRfbWFz
ayA9IDA7Ci0KLQljZSA9IGZldGNoX2FuZF96ZXJvKCZkZXZfcHJpdi0+cGVyZi5vYS5waW5uZWRf
Y3R4KTsKLQlpZiAoY2UpIHsKLQkJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0
ZXgpOworCWNlID0gZmV0Y2hfYW5kX3plcm8oJmk5MTUtPnBlcmYub2EucGlubmVkX2N0eCk7CisJ
aWYgKGNlKSAgeworCQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwkJY2Ut
Pmh3X3RhZyA9IDA7CiAJCWludGVsX2NvbnRleHRfdW5waW4oY2UpOwotCQltdXRleF91bmxvY2so
JmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKKwkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0u
c3RydWN0X211dGV4KTsKIAl9CisKKwlpOTE1LT5wZXJmLm9hLnNwZWNpZmljX2N0eF9pZCA9IElO
VkFMSURfQ1RYX0lEOworCWk5MTUtPnBlcmYub2Euc3BlY2lmaWNfY3R4X2lkX21hc2sgPSAwOwog
fQogCiBzdGF0aWMgdm9pZApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90
cmFjZS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCmluZGV4IGRhMThiOGQ2
YjgwYy4uZmJmNmRkMGViNWM5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3RyYWNlLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCkBAIC02NjUs
NyArNjY1LDYgQEAgVFJBQ0VfRVZFTlQoaTkxNV9yZXF1ZXN0X3F1ZXVlLAogCiAJICAgIFRQX1NU
UlVDVF9fZW50cnkoCiAJCQkgICAgIF9fZmllbGQodTMyLCBkZXYpCi0JCQkgICAgIF9fZmllbGQo
dTMyLCBod19pZCkKIAkJCSAgICAgX19maWVsZCh1NjQsIGN0eCkKIAkJCSAgICAgX19maWVsZCh1
MTYsIGNsYXNzKQogCQkJICAgICBfX2ZpZWxkKHUxNiwgaW5zdGFuY2UpCkBAIC02NzUsNyArNjc0
LDYgQEAgVFJBQ0VfRVZFTlQoaTkxNV9yZXF1ZXN0X3F1ZXVlLAogCiAJICAgIFRQX2Zhc3RfYXNz
aWduKAogCQkJICAgX19lbnRyeS0+ZGV2ID0gcnEtPmk5MTUtPmRybS5wcmltYXJ5LT5pbmRleDsK
LQkJCSAgIF9fZW50cnktPmh3X2lkID0gcnEtPmdlbV9jb250ZXh0LT5od19pZDsKIAkJCSAgIF9f
ZW50cnktPmNsYXNzID0gcnEtPmVuZ2luZS0+dWFiaV9jbGFzczsKIAkJCSAgIF9fZW50cnktPmlu
c3RhbmNlID0gcnEtPmVuZ2luZS0+aW5zdGFuY2U7CiAJCQkgICBfX2VudHJ5LT5jdHggPSBycS0+
ZmVuY2UuY29udGV4dDsKQEAgLTY4MywxMCArNjgxLDkgQEAgVFJBQ0VfRVZFTlQoaTkxNV9yZXF1
ZXN0X3F1ZXVlLAogCQkJICAgX19lbnRyeS0+ZmxhZ3MgPSBmbGFnczsKIAkJCSAgICksCiAKLQkg
ICAgVFBfcHJpbnRrKCJkZXY9JXUsIGVuZ2luZT0ldToldSwgaHdfaWQ9JXUsIGN0eD0lbGx1LCBz
ZXFubz0ldSwgZmxhZ3M9MHgleCIsCisJICAgIFRQX3ByaW50aygiZGV2PSV1LCBlbmdpbmU9JXU6
JXUsIGN0eD0lbGx1LCBzZXFubz0ldSwgZmxhZ3M9MHgleCIsCiAJCSAgICAgIF9fZW50cnktPmRl
diwgX19lbnRyeS0+Y2xhc3MsIF9fZW50cnktPmluc3RhbmNlLAotCQkgICAgICBfX2VudHJ5LT5o
d19pZCwgX19lbnRyeS0+Y3R4LCBfX2VudHJ5LT5zZXFubywKLQkJICAgICAgX19lbnRyeS0+Zmxh
Z3MpCisJCSAgICAgIF9fZW50cnktPmN0eCwgX19lbnRyeS0+c2Vxbm8sIF9fZW50cnktPmZsYWdz
KQogKTsKIAogREVDTEFSRV9FVkVOVF9DTEFTUyhpOTE1X3JlcXVlc3QsCkBAIC02OTUsNyArNjky
LDYgQEAgREVDTEFSRV9FVkVOVF9DTEFTUyhpOTE1X3JlcXVlc3QsCiAKIAkgICAgVFBfU1RSVUNU
X19lbnRyeSgKIAkJCSAgICAgX19maWVsZCh1MzIsIGRldikKLQkJCSAgICAgX19maWVsZCh1MzIs
IGh3X2lkKQogCQkJICAgICBfX2ZpZWxkKHU2NCwgY3R4KQogCQkJICAgICBfX2ZpZWxkKHUxNiwg
Y2xhc3MpCiAJCQkgICAgIF9fZmllbGQodTE2LCBpbnN0YW5jZSkKQEAgLTcwNCwxNiArNzAwLDE1
IEBAIERFQ0xBUkVfRVZFTlRfQ0xBU1MoaTkxNV9yZXF1ZXN0LAogCiAJICAgIFRQX2Zhc3RfYXNz
aWduKAogCQkJICAgX19lbnRyeS0+ZGV2ID0gcnEtPmk5MTUtPmRybS5wcmltYXJ5LT5pbmRleDsK
LQkJCSAgIF9fZW50cnktPmh3X2lkID0gcnEtPmdlbV9jb250ZXh0LT5od19pZDsKIAkJCSAgIF9f
ZW50cnktPmNsYXNzID0gcnEtPmVuZ2luZS0+dWFiaV9jbGFzczsKIAkJCSAgIF9fZW50cnktPmlu
c3RhbmNlID0gcnEtPmVuZ2luZS0+aW5zdGFuY2U7CiAJCQkgICBfX2VudHJ5LT5jdHggPSBycS0+
ZmVuY2UuY29udGV4dDsKIAkJCSAgIF9fZW50cnktPnNlcW5vID0gcnEtPmZlbmNlLnNlcW5vOwog
CQkJICAgKSwKIAotCSAgICBUUF9wcmludGsoImRldj0ldSwgZW5naW5lPSV1OiV1LCBod19pZD0l
dSwgY3R4PSVsbHUsIHNlcW5vPSV1IiwKKwkgICAgVFBfcHJpbnRrKCJkZXY9JXUsIGVuZ2luZT0l
dToldSwgY3R4PSVsbHUsIHNlcW5vPSV1IiwKIAkJICAgICAgX19lbnRyeS0+ZGV2LCBfX2VudHJ5
LT5jbGFzcywgX19lbnRyeS0+aW5zdGFuY2UsCi0JCSAgICAgIF9fZW50cnktPmh3X2lkLCBfX2Vu
dHJ5LT5jdHgsIF9fZW50cnktPnNlcW5vKQorCQkgICAgICBfX2VudHJ5LT5jdHgsIF9fZW50cnkt
PnNlcW5vKQogKTsKIAogREVGSU5FX0VWRU5UKGk5MTVfcmVxdWVzdCwgaTkxNV9yZXF1ZXN0X2Fk
ZCwKQEAgLTczOCw3ICs3MzMsNiBAQCBUUkFDRV9FVkVOVChpOTE1X3JlcXVlc3RfaW4sCiAKIAkg
ICAgVFBfU1RSVUNUX19lbnRyeSgKIAkJCSAgICAgX19maWVsZCh1MzIsIGRldikKLQkJCSAgICAg
X19maWVsZCh1MzIsIGh3X2lkKQogCQkJICAgICBfX2ZpZWxkKHU2NCwgY3R4KQogCQkJICAgICBf
X2ZpZWxkKHUxNiwgY2xhc3MpCiAJCQkgICAgIF9fZmllbGQodTE2LCBpbnN0YW5jZSkKQEAgLTc0
OSw3ICs3NDMsNiBAQCBUUkFDRV9FVkVOVChpOTE1X3JlcXVlc3RfaW4sCiAKIAkgICAgVFBfZmFz
dF9hc3NpZ24oCiAJCQkgICBfX2VudHJ5LT5kZXYgPSBycS0+aTkxNS0+ZHJtLnByaW1hcnktPmlu
ZGV4OwotCQkJICAgX19lbnRyeS0+aHdfaWQgPSBycS0+Z2VtX2NvbnRleHQtPmh3X2lkOwogCQkJ
ICAgX19lbnRyeS0+Y2xhc3MgPSBycS0+ZW5naW5lLT51YWJpX2NsYXNzOwogCQkJICAgX19lbnRy
eS0+aW5zdGFuY2UgPSBycS0+ZW5naW5lLT5pbnN0YW5jZTsKIAkJCSAgIF9fZW50cnktPmN0eCA9
IHJxLT5mZW5jZS5jb250ZXh0OwpAQCAtNzU4LDkgKzc1MSw5IEBAIFRSQUNFX0VWRU5UKGk5MTVf
cmVxdWVzdF9pbiwKIAkJCSAgIF9fZW50cnktPnBvcnQgPSBwb3J0OwogCQkJICAgKSwKIAotCSAg
ICBUUF9wcmludGsoImRldj0ldSwgZW5naW5lPSV1OiV1LCBod19pZD0ldSwgY3R4PSVsbHUsIHNl
cW5vPSV1LCBwcmlvPSV1LCBwb3J0PSV1IiwKKwkgICAgVFBfcHJpbnRrKCJkZXY9JXUsIGVuZ2lu
ZT0ldToldSwgY3R4PSVsbHUsIHNlcW5vPSV1LCBwcmlvPSV1LCBwb3J0PSV1IiwKIAkJICAgICAg
X19lbnRyeS0+ZGV2LCBfX2VudHJ5LT5jbGFzcywgX19lbnRyeS0+aW5zdGFuY2UsCi0JCSAgICAg
IF9fZW50cnktPmh3X2lkLCBfX2VudHJ5LT5jdHgsIF9fZW50cnktPnNlcW5vLAorCQkgICAgICBf
X2VudHJ5LT5jdHgsIF9fZW50cnktPnNlcW5vLAogCQkgICAgICBfX2VudHJ5LT5wcmlvLCBfX2Vu
dHJ5LT5wb3J0KQogKTsKIApAQCAtNzcwLDcgKzc2Myw2IEBAIFRSQUNFX0VWRU5UKGk5MTVfcmVx
dWVzdF9vdXQsCiAKIAkgICAgVFBfU1RSVUNUX19lbnRyeSgKIAkJCSAgICAgX19maWVsZCh1MzIs
IGRldikKLQkJCSAgICAgX19maWVsZCh1MzIsIGh3X2lkKQogCQkJICAgICBfX2ZpZWxkKHU2NCwg
Y3R4KQogCQkJICAgICBfX2ZpZWxkKHUxNiwgY2xhc3MpCiAJCQkgICAgIF9fZmllbGQodTE2LCBp
bnN0YW5jZSkKQEAgLTc4MCw3ICs3NzIsNiBAQCBUUkFDRV9FVkVOVChpOTE1X3JlcXVlc3Rfb3V0
LAogCiAJICAgIFRQX2Zhc3RfYXNzaWduKAogCQkJICAgX19lbnRyeS0+ZGV2ID0gcnEtPmk5MTUt
PmRybS5wcmltYXJ5LT5pbmRleDsKLQkJCSAgIF9fZW50cnktPmh3X2lkID0gcnEtPmdlbV9jb250
ZXh0LT5od19pZDsKIAkJCSAgIF9fZW50cnktPmNsYXNzID0gcnEtPmVuZ2luZS0+dWFiaV9jbGFz
czsKIAkJCSAgIF9fZW50cnktPmluc3RhbmNlID0gcnEtPmVuZ2luZS0+aW5zdGFuY2U7CiAJCQkg
ICBfX2VudHJ5LT5jdHggPSBycS0+ZmVuY2UuY29udGV4dDsKQEAgLTc4OCwxMCArNzc5LDkgQEAg
VFJBQ0VfRVZFTlQoaTkxNV9yZXF1ZXN0X291dCwKIAkJCSAgIF9fZW50cnktPmNvbXBsZXRlZCA9
IGk5MTVfcmVxdWVzdF9jb21wbGV0ZWQocnEpOwogCQkJICAgKSwKIAotCQkgICAgVFBfcHJpbnRr
KCJkZXY9JXUsIGVuZ2luZT0ldToldSwgaHdfaWQ9JXUsIGN0eD0lbGx1LCBzZXFubz0ldSwgY29t
cGxldGVkPz0ldSIsCisJCSAgICBUUF9wcmludGsoImRldj0ldSwgZW5naW5lPSV1OiV1LCBjdHg9
JWxsdSwgc2Vxbm89JXUsIGNvbXBsZXRlZD89JXUiLAogCQkJICAgICAgX19lbnRyeS0+ZGV2LCBf
X2VudHJ5LT5jbGFzcywgX19lbnRyeS0+aW5zdGFuY2UsCi0JCQkgICAgICBfX2VudHJ5LT5od19p
ZCwgX19lbnRyeS0+Y3R4LCBfX2VudHJ5LT5zZXFubywKLQkJCSAgICAgIF9fZW50cnktPmNvbXBs
ZXRlZCkKKwkJCSAgICAgIF9fZW50cnktPmN0eCwgX19lbnRyeS0+c2Vxbm8sIF9fZW50cnktPmNv
bXBsZXRlZCkKICk7CiAKICNlbHNlCkBAIC04MjksNyArODE5LDYgQEAgVFJBQ0VfRVZFTlQoaTkx
NV9yZXF1ZXN0X3dhaXRfYmVnaW4sCiAKIAkgICAgVFBfU1RSVUNUX19lbnRyeSgKIAkJCSAgICAg
X19maWVsZCh1MzIsIGRldikKLQkJCSAgICAgX19maWVsZCh1MzIsIGh3X2lkKQogCQkJICAgICBf
X2ZpZWxkKHU2NCwgY3R4KQogCQkJICAgICBfX2ZpZWxkKHUxNiwgY2xhc3MpCiAJCQkgICAgIF9f
ZmllbGQodTE2LCBpbnN0YW5jZSkKQEAgLTg0NSw3ICs4MzQsNiBAQCBUUkFDRV9FVkVOVChpOTE1
X3JlcXVlc3Rfd2FpdF9iZWdpbiwKIAkgICAgICovCiAJICAgIFRQX2Zhc3RfYXNzaWduKAogCQkJ
ICAgX19lbnRyeS0+ZGV2ID0gcnEtPmk5MTUtPmRybS5wcmltYXJ5LT5pbmRleDsKLQkJCSAgIF9f
ZW50cnktPmh3X2lkID0gcnEtPmdlbV9jb250ZXh0LT5od19pZDsKIAkJCSAgIF9fZW50cnktPmNs
YXNzID0gcnEtPmVuZ2luZS0+dWFiaV9jbGFzczsKIAkJCSAgIF9fZW50cnktPmluc3RhbmNlID0g
cnEtPmVuZ2luZS0+aW5zdGFuY2U7CiAJCQkgICBfX2VudHJ5LT5jdHggPSBycS0+ZmVuY2UuY29u
dGV4dDsKQEAgLTg1Myw5ICs4NDEsOSBAQCBUUkFDRV9FVkVOVChpOTE1X3JlcXVlc3Rfd2FpdF9i
ZWdpbiwKIAkJCSAgIF9fZW50cnktPmZsYWdzID0gZmxhZ3M7CiAJCQkgICApLAogCi0JICAgIFRQ
X3ByaW50aygiZGV2PSV1LCBlbmdpbmU9JXU6JXUsIGh3X2lkPSV1LCBjdHg9JWxsdSwgc2Vxbm89
JXUsIGZsYWdzPTB4JXgiLAorCSAgICBUUF9wcmludGsoImRldj0ldSwgZW5naW5lPSV1OiV1LCBj
dHg9JWxsdSwgc2Vxbm89JXUsIGZsYWdzPTB4JXgiLAogCQkgICAgICBfX2VudHJ5LT5kZXYsIF9f
ZW50cnktPmNsYXNzLCBfX2VudHJ5LT5pbnN0YW5jZSwKLQkJICAgICAgX19lbnRyeS0+aHdfaWQs
IF9fZW50cnktPmN0eCwgX19lbnRyeS0+c2Vxbm8sCisJCSAgICAgIF9fZW50cnktPmN0eCwgX19l
bnRyeS0+c2Vxbm8sCiAJCSAgICAgIF9fZW50cnktPmZsYWdzKQogKTsKIApAQCAtOTU4LDE5ICs5
NDYsMTcgQEAgREVDTEFSRV9FVkVOVF9DTEFTUyhpOTE1X2NvbnRleHQsCiAJVFBfU1RSVUNUX19l
bnRyeSgKIAkJCV9fZmllbGQodTMyLCBkZXYpCiAJCQlfX2ZpZWxkKHN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0ICosIGN0eCkKLQkJCV9fZmllbGQodTMyLCBod19pZCkKIAkJCV9fZmllbGQoc3RydWN0
IGk5MTVfYWRkcmVzc19zcGFjZSAqLCB2bSkKIAkpLAogCiAJVFBfZmFzdF9hc3NpZ24oCiAJCQlf
X2VudHJ5LT5kZXYgPSBjdHgtPmk5MTUtPmRybS5wcmltYXJ5LT5pbmRleDsKIAkJCV9fZW50cnkt
PmN0eCA9IGN0eDsKLQkJCV9fZW50cnktPmh3X2lkID0gY3R4LT5od19pZDsKIAkJCV9fZW50cnkt
PnZtID0gY3R4LT52bTsKIAkpLAogCi0JVFBfcHJpbnRrKCJkZXY9JXUsIGN0eD0lcCwgY3R4X3Zt
PSVwLCBod19pZD0ldSIsCi0JCSAgX19lbnRyeS0+ZGV2LCBfX2VudHJ5LT5jdHgsIF9fZW50cnkt
PnZtLCBfX2VudHJ5LT5od19pZCkKKwlUUF9wcmludGsoImRldj0ldSwgY3R4PSVwLCBjdHhfdm09
JXAiLAorCQkgIF9fZW50cnktPmRldiwgX19lbnRyeS0+Y3R4LCBfX2VudHJ5LT52bSkKICkKIAog
REVGSU5FX0VWRU5UKGk5MTVfY29udGV4dCwgaTkxNV9jb250ZXh0X2NyZWF0ZSwKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMKaW5kZXggYjY0NDlk
MGE4YzE3Li4wN2FiODIyYjIyNGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9ldmljdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0
ZXN0cy9pOTE1X2dlbV9ldmljdC5jCkBAIC00NzUsOCArNDc1LDggQEAgc3RhdGljIGludCBpZ3Rf
ZXZpY3RfY29udGV4dHModm9pZCAqYXJnKQogCQkJaWYgKElTX0VSUihycSkpIHsKIAkJCQkvKiBX
aGVuIGZ1bGwsIGZhaWxfaWZfYnVzeSB3aWxsIHRyaWdnZXIgRUJVU1kgKi8KIAkJCQlpZiAoUFRS
X0VSUihycSkgIT0gLUVCVVNZKSB7Ci0JCQkJCXByX2VycigiVW5leHBlY3RlZCBlcnJvciBmcm9t
IHJlcXVlc3QgYWxsb2MgKGN0eCBodyBpZCAldSwgb24gJXMpOiAlZFxuIiwKLQkJCQkJICAgICAg
IGN0eC0+aHdfaWQsIGVuZ2luZS0+bmFtZSwKKwkJCQkJcHJfZXJyKCJVbmV4cGVjdGVkIGVycm9y
IGZyb20gcmVxdWVzdCBhbGxvYyAob24gJXMpOiAlZFxuIiwKKwkJCQkJICAgICAgIGVuZ2luZS0+
bmFtZSwKIAkJCQkJICAgICAgIChpbnQpUFRSX0VSUihycSkpOwogCQkJCQllcnIgPSBQVFJfRVJS
KHJxKTsKIAkJCQl9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
aTkxNV92bWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3ZtYS5jCmlu
ZGV4IGZiYzc5YjE0ODIzYS4uODUwMDhmNGZjNzhjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV92bWEuYwpAQCAtMTcwLDcgKzE3MCw3IEBAIHN0YXRpYyBpbnQgaWd0X3Zt
YV9jcmVhdGUodm9pZCAqYXJnKQogCQl9CiAKIAkJbmMgPSAwOwotCQlmb3JfZWFjaF9wcmltZV9u
dW1iZXIobnVtX2N0eCwgTUFYX0NPTlRFWFRfSFdfSUQpIHsKKwkJZm9yX2VhY2hfcHJpbWVfbnVt
YmVyKG51bV9jdHgsIE5VTV9IV19UQUcpIHsKIAkJCWZvciAoOyBuYyA8IG51bV9jdHg7IG5jKysp
IHsKIAkJCQljdHggPSBtb2NrX2NvbnRleHQoaTkxNSwgIm1vY2siKTsKIAkJCQlpZiAoIWN0eCkK
LS0gCjIuMjIuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DD976167A25
	for <lists+intel-gfx@lfdr.de>; Fri, 21 Feb 2020 11:08:10 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 23FB06E25C;
	Fri, 21 Feb 2020 10:08:09 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3683A6E25C;
 Fri, 21 Feb 2020 10:08:07 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 20299529-1500050 
 for multiple; Fri, 21 Feb 2020 10:08:02 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 21 Feb 2020 10:08:00 +0000
Message-Id: <20200221100800.2587034-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20200221094321.2534304-1-chris@chris-wilson.co.uk>
References: <20200221094321.2534304-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t] i915: Exercise I915_CONTEXT_PARAM_RINGSIZE
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

STkxNV9DT05URVhUX1BBUkFNX1JJTkdTSVpFIHNwZWNpZmllcyBob3cgbGFyZ2UgdG8gY3JlYXRl
IHRoZSBjb21tYW5kCnJpbmdidWZmZXIgZm9yIGxvZ2ljYWwgcmluZyBjb250ZWN0cy4gVGhpcyBk
aXJlY3RseSBhZmZlY3RzIHRoZSBudW1iZXIKb2YgYmF0Y2hlcyB1c2Vyc3BhY2UgY2FuIHN1Ym1p
dCBiZWZvcmUgYmxvY2tpbmcgd2FpdGluZyBmb3Igc3BhY2UuCgpTaWduZWQtb2ZmLWJ5OiBDaHJp
cyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KLS0tCiB0ZXN0cy9NYWtlZmlsZS5z
b3VyY2VzICAgICAgICB8ICAgMyArCiB0ZXN0cy9pOTE1L2dlbV9jdHhfcmluZ3NpemUuYyB8IDM1
MCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiB0ZXN0cy9tZXNvbi5idWlsZCAg
ICAgICAgICAgICB8ICAgMSArCiAzIGZpbGVzIGNoYW5nZWQsIDM1NCBpbnNlcnRpb25zKCspCiBj
cmVhdGUgbW9kZSAxMDA2NDQgdGVzdHMvaTkxNS9nZW1fY3R4X3JpbmdzaXplLmMKCmRpZmYgLS1n
aXQgYS90ZXN0cy9NYWtlZmlsZS5zb3VyY2VzIGIvdGVzdHMvTWFrZWZpbGUuc291cmNlcwppbmRl
eCBiODdkNjMzM2IuLjc2Y2Y5OWRhNSAxMDA2NDQKLS0tIGEvdGVzdHMvTWFrZWZpbGUuc291cmNl
cworKysgYi90ZXN0cy9NYWtlZmlsZS5zb3VyY2VzCkBAIC0xNjMsNiArMTYzLDkgQEAgZ2VtX2N0
eF9wYXJhbV9TT1VSQ0VTID0gaTkxNS9nZW1fY3R4X3BhcmFtLmMKIFRFU1RTX3Byb2dzICs9IGdl
bV9jdHhfcGVyc2lzdGVuY2UKIGdlbV9jdHhfcGVyc2lzdGVuY2VfU09VUkNFUyA9IGk5MTUvZ2Vt
X2N0eF9wZXJzaXN0ZW5jZS5jCiAKK1RFU1RTX3Byb2dzICs9IGdlbV9jdHhfcmluZ3NpemUKK2dl
bV9jdHhfcmluZ3NpemVfU09VUkNFUyA9IGk5MTUvZ2VtX2N0eF9yaW5nc2l6ZS5jCisKIFRFU1RT
X3Byb2dzICs9IGdlbV9jdHhfc2hhcmVkCiBnZW1fY3R4X3NoYXJlZF9TT1VSQ0VTID0gaTkxNS9n
ZW1fY3R4X3NoYXJlZC5jCiAKZGlmZiAtLWdpdCBhL3Rlc3RzL2k5MTUvZ2VtX2N0eF9yaW5nc2l6
ZS5jIGIvdGVzdHMvaTkxNS9nZW1fY3R4X3JpbmdzaXplLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMDAwLi41NGJkYzYzOWIKLS0tIC9kZXYvbnVsbAorKysgYi90ZXN0cy9pOTE1
L2dlbV9jdHhfcmluZ3NpemUuYwpAQCAtMCwwICsxLDM1MCBAQAorLyoKKyAqIENvcHlyaWdodCDC
qSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKgorICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3Jh
bnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKKyAqIGNvcHkg
b2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUg
IlNvZnR3YXJlIiksCisgKiB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0
aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uCisgKiB0aGUgcmlnaHRzIHRvIHVzZSwg
Y29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKKyAq
IGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29u
cyB0byB3aG9tIHRoZQorICogU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0
IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUgY29weXJpZ2h0
IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSAoaW5jbHVkaW5nIHRoZSBuZXh0Cisg
KiBwYXJhZ3JhcGgpIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRp
YWwgcG9ydGlvbnMgb2YgdGhlCisgKiBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMg
UFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBP
UgorICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElF
UyBPRiBNRVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9T
RSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwKKyAqIFRIRSBBVVRIT1JT
IE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9S
IE9USEVSCisgKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBU
T1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORworICogRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJ
T04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUworICogSU4g
VEhFIFNPRlRXQVJFLgorICovCisKKyNpbmNsdWRlIDxlcnJuby5oPgorI2luY2x1ZGUgPGZjbnRs
Lmg+CisjaW5jbHVkZSA8aW50dHlwZXMuaD4KKyNpbmNsdWRlIDxtYXRoLmg+CisjaW5jbHVkZSA8
c3lzL2lvY3RsLmg+CisjaW5jbHVkZSA8c3lzL3R5cGVzLmg+CisjaW5jbHVkZSA8dW5pc3RkLmg+
CisKKyNpbmNsdWRlICJkcm10ZXN0LmgiIC8qIGdlbV9xdWllc2NlbnRfZ3B1KCkhICovCisjaW5j
bHVkZSAiaTkxNS9nZW1fY29udGV4dC5oIgorI2luY2x1ZGUgImk5MTUvZ2VtX2VuZ2luZV90b3Bv
bG9neS5oIgorI2luY2x1ZGUgImlvY3RsX3dyYXBwZXJzLmgiIC8qIGdlbV93YWl0KCkhICovCisj
aW5jbHVkZSAic3dfc3luYy5oIgorCisjZGVmaW5lIEk5MTVfQ09OVEVYVF9QQVJBTV9SSU5HU0la
RSAweGMKKworc3RhdGljIGJvb2wgaGFzX3JpbmdzaXplKGludCBpOTE1KQoreworCXN0cnVjdCBk
cm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSBwID0geworCQkucGFyYW0gPSBJOTE1X0NPTlRFWFRf
UEFSQU1fUklOR1NJWkUsCisJfTsKKworCXJldHVybiBfX2dlbV9jb250ZXh0X2dldF9wYXJhbShp
OTE1LCAmcCkgPT0gMDsKK30KKworc3RhdGljIHZvaWQgdGVzdF9pZGVtcG90ZW50KGludCBpOTE1
KQoreworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSBwID0geworCQkucGFyYW0g
PSBJOTE1X0NPTlRFWFRfUEFSQU1fUklOR1NJWkUsCisJfTsKKwl1aW50MzJfdCBzYXZlZDsKKwor
CS8qCisJICogU2ltcGxlIHRlc3QgdG8gdmVyaWZ5IHRoYXQgd2UgYXJlIGFibGUgdG8gcmVhZCBi
YWNrIHRoZSBzYW1lCisJICogdmFsdWUgYXMgd2Ugc2V0LgorCSAqLworCisJZ2VtX2NvbnRleHRf
Z2V0X3BhcmFtKGk5MTUsICZwKTsKKwlzYXZlZCA9IHAudmFsdWU7CisKKwlmb3IgKHVpbnQzMl90
IHggPSAxIDw8IDEyOyB4IDw9IDEyOCA8PCAxMjsgeCA8PD0gMSkgeworCQlwLnZhbHVlID0geDsK
KwkJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZwKTsKKwkJZ2VtX2NvbnRleHRfZ2V0X3Bh
cmFtKGk5MTUsICZwKTsKKwkJaWd0X2Fzc2VydF9lcV91MzIocC52YWx1ZSwgeCk7CisJfQorCisJ
cC52YWx1ZSA9IHNhdmVkOworCWdlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcCk7Cit9CisK
K3N0YXRpYyB2b2lkIHRlc3RfaW52YWxpZChpbnQgaTkxNSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX2NvbnRleHRfcGFyYW0gcCA9IHsKKwkJLnBhcmFtID0gSTkxNV9DT05URVhUX1BBUkFNX1JJ
TkdTSVpFLAorCX07CisJdWludDY0X3QgaW52YWxpZFtdID0geworCQkwLCAxLCA0MDk1LCA0MDk3
LCA4MTkxLCA4MTkzLAorCQkvKiB1cHBlciBsaW1pdCBtYXkgYmUgSFcgZGVwZW5kZW50LCBhdG0g
aXQgaXMgNTEyS2lCICovCisJCSg1MTIgPDwgMTApIC0gMSwgKDUxMiA8PCAxMCkgKyAxLAorCQkt
MSwgLTF1CisJfTsKKwl1aW50MzJfdCBzYXZlZDsKKworCS8qCisJICogVGhlIEhXIG9ubHkgYWNj
ZXB0cyBjZXJ0YWluIGFsaWduZWQgdmFsdWVzIGFuZCBzbyB3ZSByZWplY3QKKwkgKiBhbnkgaW52
YWxpZCBzaXplcyBzcGVjaWZpZWQgYnkgdGhlIHVzZXIuCisJICoKKwkgKiBDdXJyZW50bHksIHRo
ZSBIVyBvbmx5IGFjY2VwdHMgNEtpQiAtIDUxMktpQiBpbiA0SyBpbmNyZW1lbnRzLAorCSAqIGFu
ZCBpcyB1bmxpa2VseSB0byBldmVyIGFjY2VwdCBzbWFsbGVyLgorCSAqLworCisJZ2VtX2NvbnRl
eHRfZ2V0X3BhcmFtKGk5MTUsICZwKTsKKwlzYXZlZCA9IHAudmFsdWU7CisKKwlmb3IgKGludCBp
ID0gMDsgaSA8IEFSUkFZX1NJWkUoaW52YWxpZCk7IGkrKykgeworCQlwLnZhbHVlID0gaW52YWxp
ZFtpXTsKKwkJaWd0X2Fzc2VydF9lcShfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmcCks
IC1FSU5WQUwpOworCQlnZW1fY29udGV4dF9nZXRfcGFyYW0oaTkxNSwgJnApOworCQlpZ3RfYXNz
ZXJ0X2VxX3U2NChwLnZhbHVlLCBzYXZlZCk7CisJfQorfQorCitzdGF0aWMgaW50IGNyZWF0ZV9l
eHRfaW9jdGwoaW50IGk5MTUsCisJCQkgICAgc3RydWN0IGRybV9pOTE1X2dlbV9jb250ZXh0X2Ny
ZWF0ZV9leHQgKmFyZykKK3sKKwlpbnQgZXJyOworCisJZXJyID0gMDsKKwlpZiAoaWd0X2lvY3Rs
KGk5MTUsIERSTV9JT0NUTF9JOTE1X0dFTV9DT05URVhUX0NSRUFURV9FWFQsIGFyZykpIHsKKwkJ
ZXJyID0gLWVycm5vOworCQlpZ3RfYXNzdW1lKGVycik7CisJfQorCisJZXJybm8gPSAwOworCXJl
dHVybiBlcnI7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3RfY3JlYXRlKGludCBpOTE1KQoreworCXN0
cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9jcmVhdGVfZXh0X3NldHBhcmFtIHAgPSB7CisJCS5i
YXNlID0geworCQkJLm5hbWUgPSBJOTE1X0NPTlRFWFRfQ1JFQVRFX0VYVF9TRVRQQVJBTSwKKwkJ
CS5uZXh0X2V4dGVuc2lvbiA9IDAsIC8qIGVuZCBvZiBjaGFpbiAqLworCQl9LAorCQkucGFyYW0g
PSB7CisJCQkucGFyYW0gPSBJOTE1X0NPTlRFWFRfUEFSQU1fUklOR1NJWkUsCisJCQkudmFsdWUg
PSA1MTIgPDwgMTAsCisJCX0KKwl9OworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9jcmVh
dGVfZXh0IGNyZWF0ZSA9IHsKKwkJLmZsYWdzID0gSTkxNV9DT05URVhUX0NSRUFURV9GTEFHU19V
U0VfRVhURU5TSU9OUywKKwkJLmV4dGVuc2lvbnMgPSB0b191c2VyX3BvaW50ZXIoJnApLAorCX07
CisKKwkvKgorCSAqIENoZWNrIHRoYXQgdGhlIHJpbmdzaXplIHBhcmFtZXRlciBpcyB1c2VkIGR1
cmluZyBjb250ZXh0IGNvbnN0dWN0aW9uLgorCSAqLworCisJaWd0X2Fzc2VydF9lcShjcmVhdGVf
ZXh0X2lvY3RsKGk5MTUsICZjcmVhdGUpLCAgMCk7CisKKwlwLnBhcmFtLmN0eF9pZCA9IGNyZWF0
ZS5jdHhfaWQ7CisJcC5wYXJhbS52YWx1ZSA9IDA7CisJZ2VtX2NvbnRleHRfZ2V0X3BhcmFtKGk5
MTUsICZwLnBhcmFtKTsKKwlpZ3RfYXNzZXJ0X2VxKHAucGFyYW0udmFsdWUsIDUxMiA8PCAxMCk7
CisKKwlnZW1fY29udGV4dF9kZXN0cm95KGk5MTUsIGNyZWF0ZS5jdHhfaWQpOworfQorCitzdGF0
aWMgdm9pZCB0ZXN0X2Nsb25lKGludCBpOTE1KQoreworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29u
dGV4dF9jcmVhdGVfZXh0X3NldHBhcmFtIHAgPSB7CisJCS5iYXNlID0geworCQkJLm5hbWUgPSBJ
OTE1X0NPTlRFWFRfQ1JFQVRFX0VYVF9TRVRQQVJBTSwKKwkJCS5uZXh0X2V4dGVuc2lvbiA9IDAs
IC8qIGVuZCBvZiBjaGFpbiAqLworCQl9LAorCQkucGFyYW0gPSB7CisJCQkucGFyYW0gPSBJOTE1
X0NPTlRFWFRfUEFSQU1fUklOR1NJWkUsCisJCQkudmFsdWUgPSA1MTIgPDwgMTAsCisJCX0KKwl9
OworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9jcmVhdGVfZXh0IGNyZWF0ZSA9IHsKKwkJ
LmZsYWdzID0gSTkxNV9DT05URVhUX0NSRUFURV9GTEFHU19VU0VfRVhURU5TSU9OUywKKwkJLmV4
dGVuc2lvbnMgPSB0b191c2VyX3BvaW50ZXIoJnApLAorCX07CisKKwkvKgorCSAqIENoZWNrIHRo
YXQgdGhlIHJpbmdzaXplIGlzIGNvcGllZCBhY3Jvc3MgZHVyaW5nIGNvbnRleHQgY2xvbmluZy4K
KwkgKi8KKworCWlndF9hc3NlcnRfZXEoY3JlYXRlX2V4dF9pb2N0bChpOTE1LCAmY3JlYXRlKSwg
IDApOworCisJcC5wYXJhbS5jdHhfaWQgPSBnZW1fY29udGV4dF9jbG9uZShpOTE1LCBjcmVhdGUu
Y3R4X2lkLAorCQkJCQkgICBJOTE1X0NPTlRFWFRfQ0xPTkVfRU5HSU5FUywgMCk7CisJaWd0X2Fz
c2VydF9uZXEocC5wYXJhbS5jdHhfaWQsIGNyZWF0ZS5jdHhfaWQpOworCWdlbV9jb250ZXh0X2Rl
c3Ryb3koaTkxNSwgY3JlYXRlLmN0eF9pZCk7CisKKwlwLnBhcmFtLnZhbHVlID0gMDsKKwlnZW1f
Y29udGV4dF9nZXRfcGFyYW0oaTkxNSwgJnAucGFyYW0pOworCWlndF9hc3NlcnRfZXEocC5wYXJh
bS52YWx1ZSwgNTEyIDw8IDEwKTsKKworCWdlbV9jb250ZXh0X2Rlc3Ryb3koaTkxNSwgcC5wYXJh
bS5jdHhfaWQpOworfQorCitzdGF0aWMgaW50IF9fZXhlY2J1ZihpbnQgaTkxNSwgc3RydWN0IGRy
bV9pOTE1X2dlbV9leGVjYnVmZmVyMiAqZXhlY2J1ZikKK3sKKwlpbnQgZXJyOworCisJZXJyID0g
MDsKKwlpZiAoaW9jdGwoaTkxNSwgRFJNX0lPQ1RMX0k5MTVfR0VNX0VYRUNCVUZGRVIyLCBleGVj
YnVmKSkgeworCQllcnIgPSAtZXJybm87CisJCWlndF9hc3N1bWUoZXJyKTsKKwl9CisKKwllcnJu
byA9IDA7CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIHVpbnQzMl90IF9fYmF0Y2hfY3JlYXRl
KGludCBpOTE1LCB1aW50MzJfdCBvZmZzZXQpCit7CisJY29uc3QgdWludDMyX3QgYmJlID0gMHhh
IDw8IDIzOworCXVpbnQzMl90IGhhbmRsZTsKKworCWhhbmRsZSA9IGdlbV9jcmVhdGUoaTkxNSwg
b2Zmc2V0ICsgc2l6ZW9mKGJiZSkpOworCWdlbV93cml0ZShpOTE1LCBoYW5kbGUsIG9mZnNldCwg
JmJiZSwgc2l6ZW9mKGJiZSkpOworCisJcmV0dXJuIGhhbmRsZTsKK30KKworc3RhdGljIHVpbnQz
Ml90IGJhdGNoX2NyZWF0ZShpbnQgaTkxNSkKK3sKKwlyZXR1cm4gX19iYXRjaF9jcmVhdGUoaTkx
NSwgMCk7Cit9CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgbWVhc3VyZV9pbmZsaWdodChpbnQgaTkx
NSwgdW5zaWduZWQgaW50IGVuZ2luZSwgaW50IHRpbWVvdXQpCit7CisJSUdUX0NPUktfRkVOQ0Uo
Y29yayk7CisJc3RydWN0IGRybV9pOTE1X2dlbV9leGVjX29iamVjdDIgb2JqID0geworCQkuaGFu
ZGxlID0gYmF0Y2hfY3JlYXRlKGk5MTUpCisJfTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2V4ZWNi
dWZmZXIyIGV4ZWNidWYgPSB7CisJCS5idWZmZXJzX3B0ciA9IHRvX3VzZXJfcG9pbnRlcigmb2Jq
KSwKKwkJLmJ1ZmZlcl9jb3VudCA9IDEsCisJCS5mbGFncyA9IGVuZ2luZSB8IEk5MTVfRVhFQ19G
RU5DRV9JTiwKKwkJLnJzdmQyID0gaWd0X2NvcmtfcGx1ZygmY29yaywgaTkxNSksCisJfTsKKwl1
bnNpZ25lZCBpbnQgY291bnQ7CisJaW50IGVycjsKKworCWZjbnRsKGk5MTUsIEZfU0VURkwsIGZj
bnRsKGk5MTUsIEZfR0VURkwpIHwgT19OT05CTE9DSyk7CisJaWd0X3NldF90aW1lb3V0KHRpbWVv
dXQsICJleGVjYnVmIGJsb2NrZWQhIik7CisKKwlnZW1fZXhlY2J1ZihpOTE1LCAmZXhlY2J1Zik7
CisJZm9yIChjb3VudCA9IDE7IChlcnIgPSBfX2V4ZWNidWYoaTkxNSwgJmV4ZWNidWYpKSA9PSAw
OyBjb3VudCsrKQorCQk7CisJaWd0X2Fzc2VydF9lcShlcnIsIC1FV09VTERCTE9DSyk7CisJY2xv
c2UoZXhlY2J1Zi5yc3ZkMik7CisKKwlpZ3RfcmVzZXRfdGltZW91dCgpOworCWZjbnRsKGk5MTUs
IEZfU0VURkwsIGZjbnRsKGk5MTUsIEZfR0VURkwpICYgfk9fTk9OQkxPQ0spOworCisJaWd0X2Nv
cmtfdW5wbHVnKCZjb3JrKTsKKwlnZW1fY2xvc2UoaTkxNSwgb2JqLmhhbmRsZSk7CisKKwlyZXR1
cm4gY291bnQ7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3RfcmVzaXplKGludCBpOTE1LAorCQkJY29u
c3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUyICplLAorCQkJdm9pZCAqZGF0YSkKKyNk
ZWZpbmUgSURMRSAoMSA8PCAwKQorI2RlZmluZSBhc19wb2ludGVyKHgpICh2b2lkICopKHVpbnRw
dHJfdCkoeCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRfcGFyYW0gcCA9IHsKKwkJ
LnBhcmFtID0gSTkxNV9DT05URVhUX1BBUkFNX1JJTkdTSVpFLAorCX07CisJdW5zaWduZWQgbG9u
ZyBmbGFncyA9ICh1aW50cHRyX3QpZGF0YTsKKwl1bnNpZ25lZCBpbnQgcHJldlsyXSA9IHt9Owor
CXVpbnQ2NF90IGVsYXBzZWQ7CisJdWludDMyX3Qgc2F2ZWQ7CisKKwkvKgorCSAqIFRoZSByaW5n
c2l6ZSBkaXJlY3RseSBhZmZlY3RzIHRoZSBudW1iZXIgb2YgYmF0Y2hlcyB3ZSBjYW4gaGF2ZQor
CSAqIGluZmxpZ2h0IC0tIHdoZW4gd2UgcnVuIG91dCBvZiByb29tIGluIHRoZSByaW5nLCB0aGUg
Y2xpZW50IGlzCisJICogYmxvY2tlZCAob3IgaWYgT19OT05CTE9DSyBpcyBzcGVjaWZpZWQsIC1F
V09VTERCTE9DSyBpcyByZXBvcnRlZCkuCisJICogVGhlIGtlcm5lbCB0aHJvdHRsZXMgdGhlIGNs
aWVudCB3aGVuIHRoZXkgZW50ZXIgdGhlIGxhc3QgNEtpQiBwYWdlLAorCSAqIHNvIGFzIHdlIGRv
dWJsZSB0aGUgc2l6ZSBvZiB0aGUgcmluZywgd2UgbmVhcmx5IGRvdWJsZSB0aGUgbnVtYmVyCisJ
ICogb2YgcmVxdWVzdHMgd2UgY2FuIGZpdCBhcyAyXm4tMTogaS5lIDAsIDEsIDMsIDcsIDE1LCAz
MSBwYWdlcy4KKwkgKi8KKworCWdlbV9jb250ZXh0X2dldF9wYXJhbShpOTE1LCAmcCk7CisJc2F2
ZWQgPSBwLnZhbHVlOworCisJZWxhcHNlZCA9IDA7CisJZ2VtX3F1aWVzY2VudF9ncHUoaTkxNSk7
CisJZm9yIChwLnZhbHVlID0gMSA8PCAxMjsgcC52YWx1ZSA8PSAxMjggPDwgMTI7IHAudmFsdWUg
PDw9IDEpIHsKKwkJc3RydWN0IHRpbWVzcGVjIHR2ID0ge307CisJCXVuc2lnbmVkIGludCBjb3Vu
dDsKKworCQlnZW1fY29udGV4dF9zZXRfcGFyYW0oaTkxNSwgJnApOworCisJCWlndF9uc2VjX2Vs
YXBzZWQoJnR2KTsKKwkJY291bnQgPSBtZWFzdXJlX2luZmxpZ2h0KGk5MTUsIGUtPmZsYWdzLCAx
ICsgY2VpbCgyICogZWxhcHNlZCoxZS05KSk7CisJCWVsYXBzZWQgPSBpZ3RfbnNlY19lbGFwc2Vk
KCZ0dik7CisKKwkJaWd0X2luZm8oIiVzOiAlbGx4IC0+ICVkXG4iLCBlLT5uYW1lLCBwLnZhbHVl
LCBjb3VudCk7CisJCWlndF9hc3NlcnQoY291bnQgPiAzICogKHByZXZbMV0gLSBwcmV2WzBdKSAv
IDQgKyBwcmV2WzFdKTsKKwkJaWYgKGZsYWdzICYgSURMRSkKKwkJCWdlbV9xdWllc2NlbnRfZ3B1
KGk5MTUpOworCisJCXByZXZbMF0gPSBwcmV2WzFdOworCQlwcmV2WzFdID0gY291bnQ7CisJfQor
CWdlbV9xdWllc2NlbnRfZ3B1KGk5MTUpOworCisJcC52YWx1ZSA9IHNhdmVkOworCWdlbV9jb250
ZXh0X3NldF9wYXJhbShpOTE1LCAmcCk7Cit9CisKK3N0YXRpYyB2b2lkIGdlbV90ZXN0X2VhY2hf
ZW5naW5lKGludCBpOTE1LCBjb25zdCBjaGFyICpuYW1lLAorCQkJCSB2b2lkICgqZm4pKGludCBp
OTE1LAorCQkJCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUyICplLAor
CQkJCQkgICAgdm9pZCAqZGF0YSksCisJCQkJIHZvaWQgKmRhdGEpCit7CisJY29uc3Qgc3RydWN0
IGludGVsX2V4ZWN1dGlvbl9lbmdpbmUyICplOworCisJaWd0X3N1YnRlc3Rfd2l0aF9keW5hbWlj
KG5hbWUpIHsKKwkJX19mb3JfZWFjaF9waHlzaWNhbF9lbmdpbmUoaTkxNSwgZSkgeworCQkJaWd0
X2R5bmFtaWNfZigiJXMiLCBlLT5uYW1lKQorCQkJCWZuKGk5MTUsIGUsIGRhdGEpOworCQl9CisJ
fQorfQorCitpZ3RfbWFpbgoreworCWNvbnN0IHN0cnVjdCBpbnRlbF9leGVjdXRpb25fZW5naW5l
MiAqZTsKKwlpbnQgaTkxNTsKKworCWlndF9maXh0dXJlIHsKKwkJaTkxNSA9IGRybV9vcGVuX2Ry
aXZlcihEUklWRVJfSU5URUwpOworCQlpZ3RfcmVxdWlyZV9nZW0oaTkxNSk7CisKKwkJaWd0X3Jl
cXVpcmUoaGFzX3JpbmdzaXplKGk5MTUpKTsKKwl9CisKKwlpZ3Rfc3VidGVzdCgiaWRlbXBvdGVu
dCIpCisJCXRlc3RfaWRlbXBvdGVudChpOTE1KTsKKworCWlndF9zdWJ0ZXN0KCJpbnZhbGlkIikK
KwkJdGVzdF9pbnZhbGlkKGk5MTUpOworCisJaWd0X3N1YnRlc3QoImNyZWF0ZSIpCisJCXRlc3Rf
Y3JlYXRlKGk5MTUpOworCWlndF9zdWJ0ZXN0KCJjbG9uZSIpCisJCXRlc3RfY2xvbmUoaTkxNSk7
CisKKwlnZW1fdGVzdF9lYWNoX2VuZ2luZShpOTE1LCAiaWRsZSIsIHRlc3RfcmVzaXplLCBhc19w
b2ludGVyKElETEUpKTsKKwlnZW1fdGVzdF9lYWNoX2VuZ2luZShpOTE1LCAiYWN0aXZlIiwgdGVz
dF9yZXNpemUsIDApOworCisJLyogWFhYIGN0eC0+ZW5naW5lc1tdPyBDbG9uZSAoYWJvdmUpIHNo
b3VsZCBiZSBlbm91Z2ggKi8KKworCWlndF9maXh0dXJlIHsKKwkJY2xvc2UoaTkxNSk7CisJfQor
fQpkaWZmIC0tZ2l0IGEvdGVzdHMvbWVzb24uYnVpbGQgYi90ZXN0cy9tZXNvbi5idWlsZAppbmRl
eCBmYTAxMDNlM2EuLmM5NDBlODViMCAxMDA2NDQKLS0tIGEvdGVzdHMvbWVzb24uYnVpbGQKKysr
IGIvdGVzdHMvbWVzb24uYnVpbGQKQEAgLTEyNCw2ICsxMjQsNyBAQCBpOTE1X3Byb2dzID0gWwog
CSdnZW1fY3R4X2lzb2xhdGlvbicsCiAJJ2dlbV9jdHhfcGFyYW0nLAogCSdnZW1fY3R4X3BlcnNp
c3RlbmNlJywKKwknZ2VtX2N0eF9yaW5nc2l6ZScsCiAJJ2dlbV9jdHhfc2hhcmVkJywKIAknZ2Vt
X2N0eF9zd2l0Y2gnLAogCSdnZW1fY3R4X3RocmFzaCcsCi0tIAoyLjI1LjEKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxp
c3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNr
dG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

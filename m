Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 21838E58D6
	for <lists+intel-gfx@lfdr.de>; Sat, 26 Oct 2019 08:18:02 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C92B26EBEC;
	Sat, 26 Oct 2019 06:17:59 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 720006EBEC
 for <intel-gfx@lists.freedesktop.org>; Sat, 26 Oct 2019 06:17:58 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18971312-1500050 
 for multiple; Sat, 26 Oct 2019 07:17:38 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sat, 26 Oct 2019 07:17:36 +0100
Message-Id: <20191026061736.22594-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/tgl: Adjust the location of
 RING_MI_MODE in the context image
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIGxvY2F0aW9uIG9mIFJJTkdfTUlfTU9ERSAodXNlZCB0byBzdG9wIHRoZSByaW5nIGFjcm9z
cyByZXNldHMpIG1vdmVkCmZvciBUaWdlcmxha2UuIEZpeHVwIHRoZSBuZXcgbG9jYXRpb24gYW5k
IGluY2x1ZGUgYSBzZWxmdGVzdCB0byB2ZXJpZnkKdGhlIGxvY2F0aW9uIGluIHRoZSBkZWZhdWx0
IGNvbnRleHQgaW1hZ2UuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlz
LXdpbHNvbi5jby51az4KQ2M6IE1pa2EgS3VvcHBhbGEgPG1pa2Eua3VvcHBhbGFAbGludXguaW50
ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jICAgIHwgMTgg
KysrKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMgfCA3MyArKysr
KysrKysrKysrKysrKysrKysrKysrKwogMiBmaWxlcyBjaGFuZ2VkLCA4OCBpbnNlcnRpb25zKCsp
LCAzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKaW5kZXggNTIz
ZGUxZmQ0NDUyLi4wOWExMmQyMDk4N2IgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5j
CkBAIC0yOTM1LDE0ICsyOTM1LDI2IEBAIHN0YXRpYyB2b2lkIHJlc2V0X2NzYl9wb2ludGVycyhz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCQkgICAgICAgJmV4ZWNsaXN0cy0+Y3Ni
X3N0YXR1c1tyZXNldF92YWx1ZV0pOwogfQogCitzdGF0aWMgaW50IGxyY19yaW5nX21pX21vZGUo
Y29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCWlmIChJTlRFTF9HRU4o
ZW5naW5lLT5pOTE1KSA+PSAxMikKKwkJcmV0dXJuIDB4NjA7CisJZWxzZSBpZiAoSU5URUxfR0VO
KGVuZ2luZS0+aTkxNSkgPj0gOSkKKwkJcmV0dXJuIDB4NTQ7CisJZWxzZQorCQlyZXR1cm4gMHg1
ODsKK30KKwogc3RhdGljIHZvaWQgX19leGVjbGlzdHNfcmVzZXRfcmVnX3N0YXRlKGNvbnN0IHN0
cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKIAkJCQkJY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQogewogCXUzMiAqcmVncyA9IGNlLT5scmNfcmVnX3N0YXRlOworCWludCB4Owog
Ci0JaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkpIHsKLQkJcmVnc1tHRU45X0NUWF9S
SU5HX01JX01PREUgKyAxXSAmPSB+U1RPUF9SSU5HOwotCQlyZWdzW0dFTjlfQ1RYX1JJTkdfTUlf
TU9ERSArIDFdIHw9IFNUT1BfUklORyA8PCAxNjsKKwl4ID0gbHJjX3JpbmdfbWlfbW9kZShlbmdp
bmUpOworCWlmICh4ICE9IC0xKSB7CisJCXJlZ3NbeCArIDFdICY9IH5TVE9QX1JJTkc7CisJCXJl
Z3NbeCArIDFdIHw9IFNUT1BfUklORyA8PCAxNjsKIAl9CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Qvc2VsZnRlc3RfbHJjLmMKaW5kZXggZDVkMjY4YmU1NTRlLi40NmZhMTdlOWFlMGIgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCkBAIC0zMTY1LDYgKzMxNjUsNzggQEAg
c3RhdGljIGludCBsaXZlX2xyY19sYXlvdXQodm9pZCAqYXJnKQogCXJldHVybiBlcnI7CiB9CiAK
K3N0YXRpYyBpbnQgZmluZF9vZmZzZXQoY29uc3QgdTMyICpscmksIHUzMiBvZmZzZXQpCit7CisJ
aW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgUEFHRV9TSVpFIC8gc2l6ZW9mKHUzMik7IGkrKykK
KwkJaWYgKGxyaVtpXSA9PSBvZmZzZXQpCisJCQlyZXR1cm4gaTsKKworCXJldHVybiAtMTsKK30K
Kworc3RhdGljIGludCBsaXZlX2xyY19maXhlZCh2b2lkICphcmcpCit7CisJc3RydWN0IGludGVs
X2d0ICpndCA9IGFyZzsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBp
bnRlbF9lbmdpbmVfaWQgaWQ7CisJaW50IGVycjsKKworCS8qCisJICogQ2hlY2sgdGhlIGFzc3Vt
ZWQgcmVnaXN0ZXIgb2Zmc2V0cyBtYXRjaCB0aGUgYWN0dWFsIGxvY2F0aW9ucyBpbgorCSAqIHRo
ZSBjb250ZXh0IGltYWdlLgorCSAqLworCisJZXJyID0gMDsKKwlmb3JfZWFjaF9lbmdpbmUoZW5n
aW5lLCBndCwgaWQpIHsKKwkJY29uc3Qgc3RydWN0IHsKKwkJCXUzMiByZWc7CisJCQl1MzIgb2Zm
c2V0OworCQkJY29uc3QgY2hhciAqbmFtZTsKKwkJfSB0YmxbXSA9IHsKKwkJCXsKKwkJCQlpOTE1
X21taW9fcmVnX29mZnNldChSSU5HX01JX01PREUoZW5naW5lLT5tbWlvX2Jhc2UpKSwKKwkJCQls
cmNfcmluZ19taV9tb2RlKGVuZ2luZSksCisJCQkJIlJJTkdfTUlfTU9ERSIsCisJCQl9LAorCQkJ
eyB9LAorCQl9LCAqdDsKKwkJdTMyICpodzsKKworCQlpZiAoIWVuZ2luZS0+ZGVmYXVsdF9zdGF0
ZSkKKwkJCWNvbnRpbnVlOworCisJCWh3ID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoZW5naW5l
LT5kZWZhdWx0X3N0YXRlLAorCQkJCQkgICAgIEk5MTVfTUFQX1dCKTsKKwkJaWYgKElTX0VSUiho
dykpIHsKKwkJCWVyciA9IFBUUl9FUlIoaHcpOworCQkJYnJlYWs7CisJCX0KKwkJaHcgKz0gTFJD
X1NUQVRFX1BOICogUEFHRV9TSVpFIC8gc2l6ZW9mKCpodyk7CisKKwkJZm9yICh0ID0gdGJsOyB0
LT5uYW1lOyB0KyspIHsKKwkJCWludCBkdyA9IGZpbmRfb2Zmc2V0KGh3LCB0LT5yZWcpOworCisJ
CQlpZiAoZHcgIT0gdC0+b2Zmc2V0KSB7CisJCQkJcHJfZXJyKCIlczogT2Zmc2V0IGZvciAlcyBb
MHgleF0gbWlzbWF0Y2gsIGZvdW5kICV4LCBleHBlY3RlZCAleFxuIiwKKwkJCQkgICAgICAgZW5n
aW5lLT5uYW1lLAorCQkJCSAgICAgICB0LT5uYW1lLAorCQkJCSAgICAgICB0LT5yZWcsCisJCQkJ
ICAgICAgIGR3LAorCQkJCSAgICAgICB0LT5vZmZzZXQpOworCQkJCWVyciA9IC1FSU5WQUw7CisJ
CQl9CisJCX0KKworCQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGVuZ2luZS0+ZGVmYXVsdF9z
dGF0ZSk7CisJCWlmIChlcnIpCisJCQlicmVhazsKKwl9CisKKwlyZXR1cm4gZXJyOworfQorCiBz
dGF0aWMgaW50IF9fbGl2ZV9scmNfc3RhdGUoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmZpeG1l
LAogCQkJICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJCSAgICBzdHJ1Y3Qg
aTkxNV92bWEgKnNjcmF0Y2gpCkBAIC0zNDM3LDYgKzM1MDksNyBAQCBpbnQgaW50ZWxfbHJjX2xp
dmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogCXN0YXRpYyBj
b25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7CiAJCVNVQlRFU1QobGl2ZV9scmNf
bGF5b3V0KSwKKwkJU1VCVEVTVChsaXZlX2xyY19maXhlZCksCiAJCVNVQlRFU1QobGl2ZV9scmNf
c3RhdGUpLAogCQlTVUJURVNUKGxpdmVfZ3ByX2NsZWFyKSwKIAl9OwotLSAKMi4yNC4wLnJjMQoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4
IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

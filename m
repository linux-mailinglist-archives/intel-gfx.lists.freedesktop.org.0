Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0B0616A731
	for <lists+intel-gfx@lfdr.de>; Tue, 16 Jul 2019 13:18:09 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id AD1B06E0D2;
	Tue, 16 Jul 2019 11:18:06 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 81DA96E0D2
 for <intel-gfx@lists.freedesktop.org>; Tue, 16 Jul 2019 11:18:04 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 17340821-1500050 for multiple; Tue, 16 Jul 2019 12:17:59 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>,
 intel-gfx@lists.freedesktop.org
References: <20190715080946.15593-1-chris@chris-wilson.co.uk>
 <20190715080946.15593-7-chris@chris-wilson.co.uk>
 <6ee58779-725d-9f9a-d202-8e050b6c0519@linux.intel.com>
In-Reply-To: <6ee58779-725d-9f9a-d202-8e050b6c0519@linux.intel.com>
Message-ID: <156327587949.9436.16914125748395710051@skylake-alporthouse-com>
Date: Tue, 16 Jul 2019 12:17:59 +0100
Subject: Re: [Intel-gfx] [PATCH 07/24] drm/i915: Rely on spinlock protection
 for GPU error capture
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBUdnJ0a28gVXJzdWxpbiAoMjAxOS0wNy0xNiAxMTo0ODoyOCkKPiAKPiBPbiAxNS8w
Ny8yMDE5IDA5OjA5LCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4gPiArLyogc2luZ2xlIHRocmVhZGVk
IHBhZ2UgYWxsb2NhdG9yIHdpdGggYSByZXNlcnZlZCBzdGFzaCBmb3IgZW1lcmdlbmNpZXMgKi8K
PiA+ICtzdHJ1Y3QgcG9vbCB7Cj4gPiArICAgICB2b2lkICpzdGFzaFszMV07Cj4gCj4gV2h5IDMx
PwoKUmFuZG9tIHBvd2VyLW9mLXR3by4gSSBjb25zaWRlcmVkIGp1c3QgdXNpbmcgc3RydWN0IHBh
Z2V2ZWMuCj4gCj4gPiArICAgICB1bnNpZ25lZCBpbnQgY291bnQ7Cj4gPiArfTsKCj4gPiAgIHN0
YXRpYyBib29sIGNvbXByZXNzX2luaXQoc3RydWN0IGNvbXByZXNzICpjKQo+ID4gICB7Cj4gPiAt
ICAgICBzdHJ1Y3Qgel9zdHJlYW1fcyAqenN0cmVhbSA9IG1lbXNldCgmYy0+enN0cmVhbSwgMCwg
c2l6ZW9mKGMtPnpzdHJlYW0pKTsKPiA+ICsgICAgIHN0cnVjdCB6X3N0cmVhbV9zICp6c3RyZWFt
ID0gJmMtPnpzdHJlYW07Cj4gPiAgIAo+ID4gLSAgICAgenN0cmVhbS0+d29ya3NwYWNlID0KPiA+
IC0gICAgICAgICAgICAga21hbGxvYyh6bGliX2RlZmxhdGVfd29ya3NwYWNlc2l6ZShNQVhfV0JJ
VFMsIE1BWF9NRU1fTEVWRUwpLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgIEdGUF9BVE9NSUMg
fCBfX0dGUF9OT1dBUk4pOwo+ID4gLSAgICAgaWYgKCF6c3RyZWFtLT53b3Jrc3BhY2UpCj4gPiAr
ICAgICBpZiAocG9vbF9pbml0KCZjLT5wb29sLCBBTExPV19GQUlMKSkKPiA+ICAgICAgICAgICAg
ICAgcmV0dXJuIGZhbHNlOwo+ID4gICAKPiA+IC0gICAgIGlmICh6bGliX2RlZmxhdGVJbml0KHpz
dHJlYW0sIFpfREVGQVVMVF9DT01QUkVTU0lPTikgIT0gWl9PSykgewo+ID4gLSAgICAgICAgICAg
ICBrZnJlZSh6c3RyZWFtLT53b3Jrc3BhY2UpOwo+ID4gKyAgICAgenN0cmVhbS0+d29ya3NwYWNl
ID0KPiA+ICsgICAgICAgICAgICAga21hbGxvYyh6bGliX2RlZmxhdGVfd29ya3NwYWNlc2l6ZShN
QVhfV0JJVFMsIE1BWF9NRU1fTEVWRUwpLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgIEFMTE9X
X0ZBSUwpOwo+ID4gKyAgICAgaWYgKCF6c3RyZWFtLT53b3Jrc3BhY2UpIHsKPiA+ICsgICAgICAg
ICAgICAgcG9vbF9maW5pKCZjLT5wb29sKTsKPiA+ICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNl
Owo+ID4gICAgICAgfQo+ID4gICAKPiA+ICAgICAgIGMtPnRtcCA9IE5VTEw7Cj4gPiAgICAgICBp
ZiAoaTkxNV9oYXNfbWVtY3B5X2Zyb21fd2MoKSkKPiA+IC0gICAgICAgICAgICAgYy0+dG1wID0g
KHZvaWQgKilfX2dldF9mcmVlX3BhZ2UoR0ZQX0FUT01JQyB8IF9fR0ZQX05PV0FSTik7Cj4gPiAr
ICAgICAgICAgICAgIGMtPnRtcCA9IHBvb2xfYWxsb2MoJmMtPnBvb2wsIEFMTE9XX0ZBSUwpOwo+
IAo+IFNvIDMxIHN0YXNoZWQgcGFnZXMgd2lsbCBiZSBlbm91Z2ggdG8gbm90IG5lZWQgYXRvbWlj
IGFsbG9jYXRpb25zLCBvciBJIAo+IG1pc3NlZCBhIHBvaW50PwoKTm8uIEl0J3MganVzdCBhIGJh
Y2t1cCBpbiBjYXNlIHdlIHJ1biBvdXQgb2YgYXRvbWljIGFsbG9jYXRpb25zLiBJdCdzCm1vZGVs
ZWQgb24gbWVtcG9vbCwgZXhjZXB0IHRoYXQgbWVtcG9vbCBkb2Vzbid0IGFsbG93IHlvdSB0byBy
ZWZpbGwgaW4KYmV0d2VlbiBhdG9taWMgc2VjdGlvbnMgYW5kIGluc3RlYWQgcmVsaWVzIG9uIHRo
b3NlIGJlaW5nIGZyZWVkLiBTaW5jZQp3ZSBjb250aW51YWxseSBhbGxvY2F0ZSBhbmQga2VlcCB0
aGUgcGFnZXMgZXNzZW50aWFsbHkgZm9yZXZlciwgbWVtcG9vbApkb2Vzbid0IGhlbHAuCiAKPiBX
aGF0IGRldGVybWluZXMgMzEgaXMgZW5vdWdoPwoKSXQncyBqdXN0IGEgYmFja3VwLCBzbyB3ZSBo
YXZlIGEgYml0IG1vcmUgbGVld2F5IHRoYW4gY3VycmVudC4KQ3VycmVudGx5LCB3ZSBoYXZlIG5v
IG5vbi1hdG9taWMgcGhhc2UgaW4gd2hpY2ggdG8gd2FpdCBmb3IgYWxsb2NhdGlvbnMsCnNvIHdl
IHNob3VsZCBmYXJlIG11Y2ggYmV0dGVyIGFuZCBoYXZlIGZld2VyIGJsYW5rIGVycm9yIHN0YXRl
cy4KCk1vc3QgY29tcHJlc3NlZCBlcnJvciBzdGF0ZXMgYXJlIGxlc3MgdGhhbiAxMjhrLCBzbyBJ
IHBsdWNrZWQgdGhhdCBhcwpiZWluZyBzdWZmaWNpZW50bHkgbGFyZ2UgZW5vdWdoIHRvIGNhcHR1
cmUgYSBzaW5nbGUgY29tcHJlc3NlZCBidWZmZXIgaW4KY2FzZSB3ZSByYW4gb3V0IG9mIGF0b21p
Yy4KCj4gPiAtc3RhdGljIHZvaWQgcHJpbnRfZXJyb3JfYnVmZmVycyhzdHJ1Y3QgZHJtX2k5MTVf
ZXJyb3Jfc3RhdGVfYnVmICptLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29u
c3QgY2hhciAqbmFtZSwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBk
cm1faTkxNV9lcnJvcl9idWZmZXIgKmVyciwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGludCBjb3VudCkKPiA+IC17Cj4gPiAtICAgICBlcnJfcHJpbnRmKG0sICIlcyBbJWRdOlxu
IiwgbmFtZSwgY291bnQpOwo+ID4gLQo+ID4gLSAgICAgd2hpbGUgKGNvdW50LS0pIHsKPiA+IC0g
ICAgICAgICAgICAgZXJyX3ByaW50ZihtLCAiICAgICUwOHhfJTA4eCAlOHUgJTAyeCAlMDJ4IiwK
PiA+IC0gICAgICAgICAgICAgICAgICAgICAgICB1cHBlcl8zMl9iaXRzKGVyci0+Z3R0X29mZnNl
dCksCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJfMzJfYml0cyhlcnItPmd0dF9v
ZmZzZXQpLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgIGVyci0+c2l6ZSwKPiA+IC0gICAg
ICAgICAgICAgICAgICAgICAgICBlcnItPnJlYWRfZG9tYWlucywKPiA+IC0gICAgICAgICAgICAg
ICAgICAgICAgICBlcnItPndyaXRlX2RvbWFpbik7Cj4gPiAtICAgICAgICAgICAgIGVycl9wdXRz
KG0sIHRpbGluZ19mbGFnKGVyci0+dGlsaW5nKSk7Cj4gPiAtICAgICAgICAgICAgIGVycl9wdXRz
KG0sIGRpcnR5X2ZsYWcoZXJyLT5kaXJ0eSkpOwo+ID4gLSAgICAgICAgICAgICBlcnJfcHV0cyht
LCBwdXJnZWFibGVfZmxhZyhlcnItPnB1cmdlYWJsZSkpOwo+ID4gLSAgICAgICAgICAgICBlcnJf
cHV0cyhtLCBlcnItPnVzZXJwdHIgPyAiIHVzZXJwdHIiIDogIiIpOwo+ID4gLSAgICAgICAgICAg
ICBlcnJfcHV0cyhtLCBpOTE1X2NhY2hlX2xldmVsX3N0cihtLT5pOTE1LCBlcnItPmNhY2hlX2xl
dmVsKSk7Cj4gPiAtCj4gPiAtICAgICAgICAgICAgIGlmIChlcnItPm5hbWUpCj4gPiAtICAgICAg
ICAgICAgICAgICAgICAgZXJyX3ByaW50ZihtLCAiIChuYW1lOiAlZCkiLCBlcnItPm5hbWUpOwo+
ID4gLSAgICAgICAgICAgICBpZiAoZXJyLT5mZW5jZV9yZWcgIT0gSTkxNV9GRU5DRV9SRUdfTk9O
RSkKPiA+IC0gICAgICAgICAgICAgICAgICAgICBlcnJfcHJpbnRmKG0sICIgKGZlbmNlOiAlZCki
LCBlcnItPmZlbmNlX3JlZyk7Cj4gPiAtCj4gPiAtICAgICAgICAgICAgIGVycl9wdXRzKG0sICJc
biIpOwo+ID4gLSAgICAgICAgICAgICBlcnIrKzsKPiA+IC0gICAgIH0KPiA+IC19Cj4gCj4gU28g
bm8gYWN0aXZlIGFuZCBwaW5uZWQgYm9zIGFueSBtb3JlLgo+IAo+IENhIHlvdSBwdXQgaW4gdGhl
IGNvbW1pdCBtZXNzYWdlIHdoYXQgZGF0YSBpcyBnb25lIGFuZCB3aGF0IHJlbWFpbnM/IEFuZCAK
PiBzb21lIG5vdGVzIG9uIGhvdyBkb2VzIHRoYXQgYWZmZWN0IHRoZSB1c2VmdWxuZXNzIG9mIGVy
cm9yIHN0YXRlLgoKTXkgcHVycG9zZSBmb3IgaW5jbHVkaW5nIHRoZW0gd2FzIGZvciBjcm9zcy1j
aGVja2luZyByZWxvY2F0aW9ucyBpbiB0aGUKYmF0Y2guIEl0J3MgYmVlbiBhIGxvbmcgdGltZSBz
aW5jZSBJJ3ZlIGhhZCB0byBkbyB0aGF0LCBhbmQgbm93IG1lc2EKbGlrZXMgdG8gdGFnIGV2ZXJ5
dGhpbmcgaW1wb3J0YW50IHdpdGggRVhFQ19DQVBUVVJFIHNvIHRoZSBidWZmZXJzIGFyZQppbmNs
dWRlZCBpbiB0aGVpciBlbnRpcmV0eS4KLUNocmlzCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2ludGVsLWdmeA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2AEE742334
	for <lists+intel-gfx@lfdr.de>; Wed, 12 Jun 2019 13:00:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7F9EE894B7;
	Wed, 12 Jun 2019 11:00:12 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9AD82894B7
 for <intel-gfx@lists.freedesktop.org>; Wed, 12 Jun 2019 11:00:11 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by orsmga104.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 12 Jun 2019 04:00:10 -0700
X-ExtLoop1: 1
Received: from gaia.fi.intel.com ([10.237.72.169])
 by orsmga004.jf.intel.com with ESMTP; 12 Jun 2019 04:00:09 -0700
Received: by gaia.fi.intel.com (Postfix, from userid 1000)
 id A7F7C5C1F41; Wed, 12 Jun 2019 14:00:07 +0300 (EEST)
From: Mika Kuoppala <mika.kuoppala@linux.intel.com>
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
In-Reply-To: <20190612085246.16374-1-chris@chris-wilson.co.uk>
References: <20190612085246.16374-1-chris@chris-wilson.co.uk>
Date: Wed, 12 Jun 2019 14:00:07 +0300
Message-ID: <878su79ih4.fsf@gaia.fi.intel.com>
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [PATCH] drm/i915: Prevent lock-cycles between GPU
 waits and GPU resets
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+IHdyaXRlczoKCj4gV2UgY2Fu
bm90IGFsbG93IG91cnNlbHZlcyB0byB3YWl0IG9uIHRoZSBHUFUgd2hpbGUgaG9sZGluZyBhbnkg
bG9jayB3ZQoKcy93ZS9hcyB3ZT8KCk15IGVuZ2xpc2ggcGFyc2VyIGlzIG5vdCBzdHJvbmcuCgo+
IG1heSBuZWVkIHRvIHJlc2V0IHRoZSBHUFUuIFdoaWxlIHRoZXJlIGlzIG5vdCBhbiBleHBsaWNp
dCBsb2NrIGJldHdlZW4KPiB0aGUgdHdvIG9wZXJhdGlvbnMsIGxvY2tkZXAgY2Fubm90IGRldGVj
dCB0aGUgZGVwZW5kZW5jeS4gU28gbGV0J3MgdGVsbAo+IGxvY2tkZXAgYWJvdXQgdGhlIHdhaXQv
cmVzZXQgZGVwZW5kZW5jeSB3aXRoIGFuIGV4cGxpY2l0IGxvY2ttYXAuCj4KPiBTaWduZWQtb2Zm
LWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KPiBDYzogTWlrYSBL
dW9wcGFsYSA8bWlrYS5rdW9wcGFsYUBsaW51eC5pbnRlbC5jb20+Cj4gQ2M6IFR2cnRrbyBVcnN1
bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+Cj4gLS0tCj4gVGhpcyBpcyAqYW5ub3lpbmds
eSogZ29vZCBhdCBkZXRlY3RpbmcgbG9jayBjeWNsZXMgaW4gR1BVIHJlc2V0Lgo+IC1DaHJpcwo+
IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jICAgICAgICAgICAg
fCA1ICsrKystCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAg
ICAgICB8IDggKysrKysrKysKPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyAgICAg
ICAgICAgICAgICAgIHwgMyArKysKPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0
LmMgICAgICAgICAgICAgIHwgMiArKwo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
bW9ja19nZW1fZGV2aWNlLmMgfCAyICsrCj4gIDUgZmlsZXMgY2hhbmdlZCwgMTkgaW5zZXJ0aW9u
cygrKSwgMSBkZWxldGlvbigtKQo+Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX3Jlc2V0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5j
Cj4gaW5kZXggNjBkMjQxMTBhZjgwLi42MzY4YjM3ZjI2ZDEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3Jlc2V0LmMKPiBAQCAtOTc4LDEwICs5NzgsMTEgQEAgdm9pZCBpOTE1X3Jl
c2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAo+ICAKPiAgCW1pZ2h0X3NsZWVwKCk7
Cj4gIAlHRU1fQlVHX09OKCF0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZlcnJvci0+Zmxh
Z3MpKTsKPiArCWxvY2tfbWFwX2FjcXVpcmUoJmk5MTUtPmd0LnJlc2V0X2xvY2ttYXApOwo+ICAK
PiAgCS8qIENsZWFyIGFueSBwcmV2aW91cyBmYWlsZWQgYXR0ZW1wdHMgYXQgcmVjb3ZlcnkuIFRp
bWUgdG8gdHJ5IGFnYWluLiAqLwo+ICAJaWYgKCFfX2k5MTVfZ2VtX3Vuc2V0X3dlZGdlZChpOTE1
KSkKPiAtCQlyZXR1cm47Cj4gKwkJZ290byB1bmxvY2s7Cj4gIAo+ICAJaWYgKHJlYXNvbikKPiAg
CQlkZXZfbm90aWNlKGk5MTUtPmRybS5kZXYsICJSZXNldHRpbmcgY2hpcCBmb3IgJXNcbiIsIHJl
YXNvbik7Cj4gQEAgLTEwMjksNiArMTAzMCw4IEBAIHZvaWQgaTkxNV9yZXNldChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgCj4gIGZpbmlzaDoKPiAgCXJlc2V0X2ZpbmlzaChpOTE1
KTsKPiArdW5sb2NrOgo+ICsJbG9ja19tYXBfcmVsZWFzZSgmaTkxNS0+Z3QucmVzZXRfbG9ja21h
cCk7Cj4gIAlyZXR1cm47CgpUaGUgcmV0dXJuIHBhdHRlciBpbiB0aGlzIGZ1bmN0aW9uIGlzIHJh
dGhlciB1bm9ydGhvZG94LiBNaWdodCBiZQpldmVuIHRoYXQgSSByZXZpZXdlZCBpdC4gVmVyeSBj
bG9zZSB0aGF0IEkgZmVsbCBpbnRvIHRyYXAgb2YgdGhpbmtpbmcKdGhhdCB5b3UgcmV0dXJuIHdp
dGggbG9jayBoZWxkLgo+ICAKPiAgdGFpbnQ6Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCj4gaW5k
ZXggMGVhN2Y3OGFlMjI3Li45Y2ZhOTUwMGZjYzQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kcnYuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2
LmgKPiBAQCAtMTkxOSw2ICsxOTE5LDE0IEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlIHsKPiAg
CQlrdGltZV90IGxhc3RfaW5pdF90aW1lOwo+ICAKPiAgCQlzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0
Y2g7Cj4gKwo+ICsJCS8qCj4gKwkJICogV2UgbXVzdCBuZXZlciB3YWl0IG9uIHRoZSBHUFUgd2hp
bGUgaG9sZGluZyBhIGxvY2sgd2UgbWF5CgpNeSBlbmdsaXNoIHBhcnNlciBzdGlsbCBleHBlY3Rl
ZCAnYXMnIHNvbWV3aGVyZSBpbiB0aGVyZS4KClJlZ2FyZGxlc3MsIGEgbmVhdCB3YXkgdG8gdXNl
IGxvY2tkZXAgdG8gZW5mb3JjZSBvdXIgZXhwZWN0YXRpb25zLgoKUmV2aWV3ZWQtYnk6IE1pa2Eg
S3VvcHBhbGEgPG1pa2Eua3VvcHBhbGFAbGludXguaW50ZWwuY29tPgoKPiArCQkgKiBuZWVkIHRv
IHBlcmZvcm0gYSBHUFUgcmVzZXQuIFNvIHdoaWxlIHdlIGRvbid0IG5lZWQgdG8KPiArCQkgKiBz
ZXJpYWxpc2Ugd2FpdC9yZXNldCB3aXRoIGFuIGV4cGxpY2l0IGxvY2ssIHdlIGRvIHdhbnQKPiAr
CQkgKiBsb2NrZGVwIHRvIGRldGVjdCBwb3RlbnRpYWwgZGVwZW5kZW5jeSBjeWNsZXMuCj4gKwkJ
ICovCj4gKwkJc3RydWN0IGxvY2tkZXBfbWFwIHJlc2V0X2xvY2ttYXA7Cj4gIAl9IGd0Owo+ICAK
PiAgCXN0cnVjdCB7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2Vt
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCj4gaW5kZXggZTk4MGMxZWUzZGNm
Li4yNGYwZjNkYjFiZmIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW0uYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKPiBAQCAtMTc4Miw2
ICsxNzgyLDcgQEAgc3RhdGljIHZvaWQgaTkxNV9nZW1faW5pdF9fbW0oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCj4gIAo+ICBpbnQgaTkxNV9nZW1faW5pdF9lYXJseShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gIHsKPiArCXN0YXRpYyBzdHJ1Y3QgbG9ja19jbGFz
c19rZXkgcmVzZXRfa2V5Owo+ICAJaW50IGVycjsKPiAgCj4gIAlpbnRlbF9ndF9wbV9pbml0KGRl
dl9wcml2KTsKPiBAQCAtMTc4OSw2ICsxNzkwLDggQEAgaW50IGk5MTVfZ2VtX2luaXRfZWFybHko
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+ICAJSU5JVF9MSVNUX0hFQUQoJmRl
dl9wcml2LT5ndC5hY3RpdmVfcmluZ3MpOwo+ICAJSU5JVF9MSVNUX0hFQUQoJmRldl9wcml2LT5n
dC5jbG9zZWRfdm1hKTsKPiAgCXNwaW5fbG9ja19pbml0KCZkZXZfcHJpdi0+Z3QuY2xvc2VkX2xv
Y2spOwo+ICsJbG9ja2RlcF9pbml0X21hcCgmZGV2X3ByaXYtPmd0LnJlc2V0X2xvY2ttYXAsCj4g
KwkJCSAiaTkxNS5yZXNldCIsICZyZXNldF9rZXksIDApOwo+ICAKPiAgCWk5MTVfZ2VtX2luaXRf
X21tKGRldl9wcml2KTsKPiAgCWk5MTVfZ2VtX2luaXRfX3BtKGRldl9wcml2KTsKPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3JlcXVlc3QuYwo+IGluZGV4IDFhOTQ4NDcxODI5ZC4uY2Q0Y2U0NGRjNGU1
IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKPiBAQCAtMTQ0NCw2ICsxNDQ0
LDcgQEAgbG9uZyBpOTE1X3JlcXVlc3Rfd2FpdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKPiAg
CQlyZXR1cm4gLUVUSU1FOwo+ICAKPiAgCXRyYWNlX2k5MTVfcmVxdWVzdF93YWl0X2JlZ2luKHJx
LCBmbGFncyk7Cj4gKwlsb2NrX21hcF9hY3F1aXJlKCZycS0+aTkxNS0+Z3QucmVzZXRfbG9ja21h
cCk7Cj4gIAo+ICAJLyoKPiAgCSAqIE9wdGltaXN0aWMgc3BpbiBiZWZvcmUgdG91Y2hpbmcgSVJR
cy4KPiBAQCAtMTUxNyw2ICsxNTE4LDcgQEAgbG9uZyBpOTE1X3JlcXVlc3Rfd2FpdChzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycSwKPiAgCWRtYV9mZW5jZV9yZW1vdmVfY2FsbGJhY2soJnJxLT5mZW5j
ZSwgJndhaXQuY2IpOwo+ICAKPiAgb3V0Ogo+ICsJbG9ja19tYXBfcmVsZWFzZSgmcnEtPmk5MTUt
Pmd0LnJlc2V0X2xvY2ttYXApOwo+ICAJdHJhY2VfaTkxNV9yZXF1ZXN0X3dhaXRfZW5kKHJxKTsK
PiAgCXJldHVybiB0aW1lb3V0Owo+ICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3Nl
bGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYwo+IGluZGV4IGI3ZjNmYmI0YWU4OS4uMWU5ZmZjZWQ3
OGMxIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dl
bV9kZXZpY2UuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dl
bV9kZXZpY2UuYwo+IEBAIC0xMzAsNiArMTMwLDcgQEAgc3RhdGljIHN0cnVjdCBkZXZfcG1fZG9t
YWluIHBtX2RvbWFpbiA9IHsKPiAgCj4gIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICptb2NrX2dl
bV9kZXZpY2Uodm9pZCkKPiAgewo+ICsJc3RhdGljIHN0cnVjdCBsb2NrX2NsYXNzX2tleSByZXNl
dF9rZXk7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNTsKPiAgCXN0cnVjdCBwY2lf
ZGV2ICpwZGV2Owo+ICAJaW50IGVycjsKPiBAQCAtMjA0LDYgKzIwNSw3IEBAIHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICptb2NrX2dlbV9kZXZpY2Uodm9pZCkKPiAgCUlOSVRfTElTVF9IRUFEKCZp
OTE1LT5ndC5hY3RpdmVfcmluZ3MpOwo+ICAJSU5JVF9MSVNUX0hFQUQoJmk5MTUtPmd0LmNsb3Nl
ZF92bWEpOwo+ICAJc3Bpbl9sb2NrX2luaXQoJmk5MTUtPmd0LmNsb3NlZF9sb2NrKTsKPiArCWxv
Y2tkZXBfaW5pdF9tYXAoJmk5MTUtPmd0LnJlc2V0X2xvY2ttYXAsICJpOTE1LnJlc2V0IiwgJnJl
c2V0X2tleSwgMCk7Cj4gIAo+ICAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Cj4gIAo+IC0tIAo+IDIuMjAuMQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9p
bnRlbC1nZng=

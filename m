Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id C93BBCF903
	for <lists+intel-gfx@lfdr.de>; Tue,  8 Oct 2019 13:57:56 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 779156E0F8;
	Tue,  8 Oct 2019 11:57:54 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 88D5F6E0F8
 for <intel-gfx@lists.freedesktop.org>; Tue,  8 Oct 2019 11:57:53 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 08 Oct 2019 04:57:52 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.67,270,1566889200"; d="scan'208";a="394648653"
Received: from obreen-mobl.ger.corp.intel.com (HELO [10.252.5.132])
 ([10.252.5.132])
 by fmsmga006.fm.intel.com with ESMTP; 08 Oct 2019 04:57:51 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20191004170452.15410-1-matthew.auld@intel.com>
 <20191004170452.15410-3-matthew.auld@intel.com>
 <157052516398.5063.14609672594270239962@skylake-alporthouse-com>
From: Matthew Auld <matthew.auld@intel.com>
Message-ID: <d3cd9d29-a74c-2c0f-1e4b-3dbf812b509b@intel.com>
Date: Tue, 8 Oct 2019 12:57:50 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.1.0
MIME-Version: 1.0
In-Reply-To: <157052516398.5063.14609672594270239962@skylake-alporthouse-com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH v3 02/21] drm/i915: introduce
 intel_memory_region
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gMDgvMTAvMjAxOSAwOTo1OSwgQ2hyaXMgV2lsc29uIHdyb3RlOgo+IFF1b3RpbmcgTWF0dGhl
dyBBdWxkICgyMDE5LTEwLTA0IDE4OjA0OjMzKQo+PiAraW50Cj4+ICtpOTE1X2dlbV9vYmplY3Rf
Z2V0X3BhZ2VzX2J1ZGR5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCj4+ICt7Cj4+
ICsgICAgICAgc3RydWN0IGludGVsX21lbW9yeV9yZWdpb24gKm1lbSA9IG9iai0+bW0ucmVnaW9u
Owo+PiArICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmJsb2NrcyA9ICZvYmotPm1tLmJsb2NrczsK
Pj4gKyAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MgPSBJOTE1X0FMTE9DX01JTl9QQUdFX1NJWkU7
Cj4+ICsgICAgICAgcmVzb3VyY2Vfc2l6ZV90IHNpemUgPSBvYmotPmJhc2Uuc2l6ZTsKPj4gKyAg
ICAgICByZXNvdXJjZV9zaXplX3QgcHJldl9lbmQ7Cj4+ICsgICAgICAgc3RydWN0IGk5MTVfYnVk
ZHlfYmxvY2sgKmJsb2NrOwo+PiArICAgICAgIHN0cnVjdCBzZ190YWJsZSAqc3Q7Cj4+ICsgICAg
ICAgc3RydWN0IHNjYXR0ZXJsaXN0ICpzZzsKPj4gKyAgICAgICB1bnNpZ25lZCBpbnQgc2dfcGFn
ZV9zaXplczsKPj4gKyAgICAgICB1bnNpZ25lZCBsb25nIGk7Cj4+ICsgICAgICAgaW50IHJldDsK
Pj4gKwo+PiArICAgICAgIHN0ID0ga21hbGxvYyhzaXplb2YoKnN0KSwgR0ZQX0tFUk5FTCk7Cj4+
ICsgICAgICAgaWYgKCFzdCkKPj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+PiAr
Cj4+ICsgICAgICAgaWYgKHNnX2FsbG9jX3RhYmxlKHN0LCBzaXplID4+IGlsb2cyKG1lbS0+bW0u
Y2h1bmtfc2l6ZSksIEdGUF9LRVJORUwpKSB7Cj4+ICsgICAgICAgICAgICAgICBrZnJlZShzdCk7
Cj4+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPj4gKyAgICAgICB9Cj4+ICsKPj4g
KyAgICAgICByZXQgPSBfX2ludGVsX21lbW9yeV9yZWdpb25fZ2V0X3BhZ2VzX2J1ZGR5KG1lbSwg
c2l6ZSwgZmxhZ3MsIGJsb2Nrcyk7Cj4+ICsgICAgICAgaWYgKHJldCkKPj4gKyAgICAgICAgICAg
ICAgIGdvdG8gZXJyX2ZyZWVfc2c7Cj4+ICsKPj4gKyAgICAgICBHRU1fQlVHX09OKGxpc3RfZW1w
dHkoYmxvY2tzKSk7Cj4+ICsKPj4gKyAgICAgICBzZyA9IHN0LT5zZ2w7Cj4+ICsgICAgICAgc3Qt
Pm5lbnRzID0gMDsKPj4gKyAgICAgICBzZ19wYWdlX3NpemVzID0gMDsKPj4gKyAgICAgICBpID0g
MDsKPj4gKwo+PiArICAgICAgIGxpc3RfZm9yX2VhY2hfZW50cnkoYmxvY2ssIGJsb2NrcywgbGlu
aykgewo+PiArICAgICAgICAgICAgICAgdTY0IGJsb2NrX3NpemUsIG9mZnNldDsKPj4gKwo+PiAr
ICAgICAgICAgICAgICAgYmxvY2tfc2l6ZSA9IGk5MTVfYnVkZHlfYmxvY2tfc2l6ZSgmbWVtLT5t
bSwgYmxvY2spOwo+PiArICAgICAgICAgICAgICAgb2Zmc2V0ID0gaTkxNV9idWRkeV9ibG9ja19v
ZmZzZXQoYmxvY2spOwo+PiArCj4+ICsgICAgICAgICAgICAgICBHRU1fQlVHX09OKG92ZXJmbG93
c190eXBlKGJsb2NrX3NpemUsIHNnLT5sZW5ndGgpKTsKPj4gKwo+PiArICAgICAgICAgICAgICAg
aWYgKCFpIHx8IG9mZnNldCAhPSBwcmV2X2VuZCB8fAo+PiArICAgICAgICAgICAgICAgICAgIGFk
ZF9vdmVyZmxvd3NfdCh0eXBlb2Yoc2ctPmxlbmd0aCksIHNnLT5sZW5ndGgsIGJsb2NrX3NpemUp
KSB7Cj4+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmIChpKSB7Cj4gCj4gaSBpcyBvbmx5IGJl
aW5nIGhlcmUgdG8gZGV0ZWN0IHRoZSBzdGFydC4KPiBwcmV2X2VuZCA9IChyZXNvdXJjZV9zaXpl
X3QpLTE7Cj4gVGhlbiBJIGRvbid0IGhhdmUgdG8gd29ycnkgYWJvdXQgaSBvdmVyZmxvd2luZywg
YWx0aG91Z2ggdGhhdCBzZWVtcwo+IGhhcm1sZXNzLCBhbmQgYXMgcmlkaWN1bG91cyBhcyB0aGF0
IG1heSBiZS4KPiAKPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZ19wYWdlX3Np
emVzIHw9IHNnLT5sZW5ndGg7Cj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2cg
PSBfX3NnX25leHQoc2cpOwo+PiArICAgICAgICAgICAgICAgICAgICAgICB9Cj4+ICsKPj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgc2dfZG1hX2FkZHJlc3Moc2cpID0gbWVtLT5yZWdpb24uc3Rh
cnQgKyBvZmZzZXQ7Cj4+ICsgICAgICAgICAgICAgICAgICAgICAgIHNnX2RtYV9sZW4oc2cpID0g
YmxvY2tfc2l6ZTsKPj4gKwo+PiArICAgICAgICAgICAgICAgICAgICAgICBzZy0+bGVuZ3RoID0g
YmxvY2tfc2l6ZTsKPj4gKwo+PiArICAgICAgICAgICAgICAgICAgICAgICBzdC0+bmVudHMrKzsK
Pj4gKyAgICAgICAgICAgICAgIH0gZWxzZSB7Cj4+ICsgICAgICAgICAgICAgICAgICAgICAgIHNn
LT5sZW5ndGggKz0gYmxvY2tfc2l6ZTsKPj4gKyAgICAgICAgICAgICAgICAgICAgICAgc2dfZG1h
X2xlbihzZykgKz0gYmxvY2tfc2l6ZTsKPj4gKyAgICAgICAgICAgICAgIH0KPj4gKwo+PiArICAg
ICAgICAgICAgICAgcHJldl9lbmQgPSBvZmZzZXQgKyBibG9ja19zaXplOwo+PiArICAgICAgICAg
ICAgICAgaSsrOwo+PiArICAgICAgIH07Cj4+ICsKPj4gKyAgICAgICBzZ19wYWdlX3NpemVzIHw9
IHNnLT5sZW5ndGg7Cj4+ICsgICAgICAgc2dfbWFya19lbmQoc2cpOwo+PiArICAgICAgIGk5MTVf
c2dfdHJpbShzdCk7Cj4+ICsKPj4gKyAgICAgICBfX2k5MTVfZ2VtX29iamVjdF9zZXRfcGFnZXMo
b2JqLCBzdCwgc2dfcGFnZV9zaXplcyk7Cj4+ICsKPj4gKyAgICAgICByZXR1cm4gMDsKPj4gKwo+
PiArZXJyX2ZyZWVfc2c6Cj4+ICsgICAgICAgc2dfZnJlZV90YWJsZShzdCk7Cj4+ICsgICAgICAg
a2ZyZWUoc3QpOwo+PiArICAgICAgIHJldHVybiByZXQ7Cj4+ICt9Cj4gCj4+ICtzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqCj4+ICtpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3JlZ2lvbihzdHJ1
Y3QgaW50ZWxfbWVtb3J5X3JlZ2lvbiAqbWVtLAo+PiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICByZXNvdXJjZV9zaXplX3Qgc2l6ZSwKPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdW5zaWduZWQgaW50IGZsYWdzKQo+PiArewo+PiArICAgICAgIHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmo7Cj4+ICsKPj4gKyAgICAgICBpZiAoIW1lbSkKPj4gKyAgICAgICAgICAg
ICAgIHJldHVybiBFUlJfUFRSKC1FTk9ERVYpOwo+PiArCj4+ICsgICAgICAgc2l6ZSA9IHJvdW5k
X3VwKHNpemUsIG1lbS0+bWluX3BhZ2Vfc2l6ZSk7Cj4+ICsKPj4gKyAgICAgICBHRU1fQlVHX09O
KCFzaXplKTsKPj4gKyAgICAgICBHRU1fQlVHX09OKCFJU19BTElHTkVEKHNpemUsIEk5MTVfR1RU
X01JTl9BTElHTk1FTlQpKTsKPj4gKwo+IAo+IFB1dCB0aGUgRklYTUUgaGVyZSBmcm9tIHRoZSBz
dGFydAo+IAo+PiArICAgICAgIGlmIChzaXplID4+IFBBR0VfU0hJRlQgPiBJTlRfTUFYKQo+PiAr
ICAgICAgICAgICAgICAgcmV0dXJuIEVSUl9QVFIoLUUyQklHKTsKPj4gKwo+PiArICAgICAgIGlm
IChvdmVyZmxvd3NfdHlwZShzaXplLCBvYmotPmJhc2Uuc2l6ZSkpCj4+ICsgICAgICAgICAgICAg
ICByZXR1cm4gRVJSX1BUUigtRTJCSUcpOwo+PiArCj4+ICsgICAgICAgcmV0dXJuIG1lbS0+b3Bz
LT5jcmVhdGVfb2JqZWN0KG1lbSwgc2l6ZSwgZmxhZ3MpOwo+PiArfQo+IAo+IEknbSBoYXBweSB3
aXRoIHRoaXMuIEJ1dCBJIHdvdWxkIGxpa2UgYSBkaXNjdXNzaW9uIG9uIHdoeQo+IHJlc291cmNl
X3NpemVfdCB3YXMgY2hvc2VuIGFuZCBmb3IgdGhhdCByYXRpb25hbGUgdG8gYmUgY2FwdHVyZWQg
aW4gdGhlCj4gY29kZSBjb21tZW50cy4gQXQgdGhlIGVuZCBvZiB0aGUgZGF5LCB3ZSBuZWVkIHRv
IGJ1bXAgb2JqLT5iYXNlLnNpemUgdG8KPiBzdWl0LgoKTm8gZ29vZCByZWFzb24sIEkgZ3Vlc3Mg
aXQganVzdCBzdGVtcyBmcm9tIHVzaW5nICJzdHJ1Y3QgcmVzb3VyY2UgCnJlZ2lvbiIuIE1heWJl
IGZvciB0aGUgb2JqZWN0X2NyZWF0ZSBpbnRlcmZhY2Ugd2Ugc2hvdWxkIGp1c3QgdXNlIHU2ND8K
Ck9uIHRoYXQgdG9waWMgc2hvdWxkIHdlIGFsc28gc3RvcCB1c2luZyAic3RydWN0IHJlc291cmNl
IiBoZXJlLCBzaW5jZSAKdGhhdCdzIHN0YXJ0aW5nIHRvIGdldCBjb25mdXNpbmcsIG1heWJlIHVz
ZSB1NjQgdGhlcmUgYWxzbz8KCj4gLUNocmlzCj4gCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2ludGVsLWdmeA==

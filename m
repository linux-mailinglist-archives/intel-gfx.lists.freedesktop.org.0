Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 571ED51B77
	for <lists+intel-gfx@lfdr.de>; Mon, 24 Jun 2019 21:37:19 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 29E3489D5C;
	Mon, 24 Jun 2019 19:37:17 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mail-ua1-x942.google.com (mail-ua1-x942.google.com
 [IPv6:2607:f8b0:4864:20::942])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 964C589D5C
 for <intel-gfx@lists.freedesktop.org>; Mon, 24 Jun 2019 19:37:16 +0000 (UTC)
Received: by mail-ua1-x942.google.com with SMTP id j21so6153652uap.2
 for <intel-gfx@lists.freedesktop.org>; Mon, 24 Jun 2019 12:37:16 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=hL4sNLHT2iM6ZevyVWDT4rw6tI+KLs8VclJdy9YDY1g=;
 b=LjhM9S7TcZnmKtwOPB+83vFTfD3ujRuxIq2vq4h7gyMIJE3tES/3fnUtRntY6X3tqN
 hwHAPZBZ8eWuehgOsB5utn7I1XGXnfKw3feOTd92NMG511vH+RrU+TYAOSquYNgpnbAG
 3TvmpJdl6hidJupKzEM+P5NbJ2pgSJynFVzRLM7YnRDTnI8GC0tBUDHFOCmNBltHBKXx
 rsgQAKlVU+zbYRK5AWzUVjb/jChlGERuvwsczq+zGoQS/dYuK9EMJEEFLMhDxJmh41FI
 DbF1tEu7toHtoEKgN2610E/0t+XPc8SfNwIxjnVrUsBVBjj2tm/t7B0Ua3g3ESBiJ380
 dq6g==
X-Gm-Message-State: APjAAAVXzmaDEZ5+AgVorp1n8Yy8216GRaBtTKVOMU/l5/e3HAhObdGa
 Uj+zqxnkmKmF9HYgVTt/qjqaVVBpgdEG//ZUY+U=
X-Google-Smtp-Source: APXvYqyj8wod0xb6GQBeCqaUfn5OyrC525qXIE6fOuztNsbNKHriB1imnkYFc+qCKLUnbBjKU2pX+IgyvqpkSn06nnY=
X-Received: by 2002:a9f:25e9:: with SMTP id 96mr69289638uaf.95.1561405035673; 
 Mon, 24 Jun 2019 12:37:15 -0700 (PDT)
MIME-Version: 1.0
References: <20190624054315.18910-1-chris@chris-wilson.co.uk>
 <20190624054315.18910-19-chris@chris-wilson.co.uk>
In-Reply-To: <20190624054315.18910-19-chris@chris-wilson.co.uk>
From: Matthew Auld <matthew.william.auld@gmail.com>
Date: Mon, 24 Jun 2019 20:36:49 +0100
Message-ID: <CAM0jSHMoON+ujP7poKiKxwyOqqPjjm++AWiLXQss91sE-_ctPw@mail.gmail.com>
To: Chris Wilson <chris@chris-wilson.co.uk>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=hL4sNLHT2iM6ZevyVWDT4rw6tI+KLs8VclJdy9YDY1g=;
 b=JOUKdozMgm5Zide5vmaAGAaw+5dpR5enlnKv7u7bOiF5VeIjQ1GJ+hmBN4mLBy7NMq
 Cfgsu23ckeXdrjUt277iCaXYgvB5xHajBYkJPRqdFThzKbpx81M3EqNnrJDAru3F1SoA
 YU5Q2FNKKRdg4ryz1W3AlD2RDXy8ZBcNz1n5yQu/mURZyNiUtUad/Doxy37c93MH8BXP
 FV+0x3pDVvKpkoPu/8aitK/OYDf/ekuBJ6PQWjlNdcFjFK5inRmjh72oBD5Kj+hzZnlN
 zJy8AJ0+g5WyoGfCotrRchpdg3V++zlk3ywtmA6e+iJ9VHNe3wC+cmOINwxR1RP7Bq1A
 pF8g==
Subject: Re: [Intel-gfx] [PATCH 19/19] drm/i915: Replace struct_mutex for
 batch pool serialisation
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel Graphics Development <intel-gfx@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gTW9uLCAyNCBKdW4gMjAxOSBhdCAwNjo0NSwgQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13
aWxzb24uY28udWs+IHdyb3RlOgo+Cj4gU3dpdGNoIHRvIHRyYWNraW5nIGFjdGl2aXR5IHZpYSBp
OTE1X2FjdGl2ZSBvbiBpbmRpdmlkdWFsIG5vZGVzLCBvbmx5Cj4ga2VlcGluZyBhIGxpc3Qgb2Yg
cmV0aXJlZCBvYmplY3RzIGluIHRoZSBjYWNoZSwgYW5kIHJlYXBpbmcgdGhlIGNhY2hlCj4gd2hl
biB0aGUgZW5naW5lIGl0c2VsZiBpZGxlcy4KPgo+IFNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNv
biA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9NYWtlZmlsZSAgICAgICAgICAgICAgICAgfCAgIDIgKy0KPiAgLi4uL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jICAgIHwgIDU4ICsrKystLS0KPiAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jICAgIHwgICAxIC0KPiAgLi4uL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmggIHwgICAxIC0KPiAgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgICAgICAgIHwgICA0ICstCj4gIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oICAgICAgICB8ICAgMSAtCj4gIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jICAgICB8ICAxMSArLQo+ICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYyAgICAgfCAgIDIgKwo+ICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5jICAgfCAxNjQgKysrKysrKysrKysrKysr
KysrCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmggICB8ICAz
NCArKysrCj4gIC4uLi9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2xfdHlwZXMuaCB8
ICAyOSArKysrCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5o
ICB8ICAgNiArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9tb2NrX2VuZ2luZS5jICAgICAg
ICAgfCAgIDMgKwo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyAgICAgICAg
ICAgfCAgNjggLS0tLS0tLS0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fYmF0Y2hf
cG9vbC5oICAgIHwgIDI2IC0tLQo+ICAxNSBmaWxlcyBjaGFuZ2VkLCAyNzcgaW5zZXJ0aW9ucygr
KSwgMTMzIGRlbGV0aW9ucygtKQo+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuYwo+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuaAo+ICBjcmVhdGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2xfdHlwZXMuaAo+ICBk
ZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fYmF0Y2hfcG9v
bC5oCgppOTE1X2dlbV9iYXRjaF9wb29sLmMgaXMgc3RpbGwgc2t1bGtpbmcgYXJvdW5kIHNvbWV3
aGVyZSA6KQoKW3NuaXBdCgo+ICtzdGF0aWMgc3RydWN0IGxpc3RfaGVhZCAqCj4gK2J1Y2tldF9m
b3Jfc2l6ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgKnBvb2wsIHNpemVfdCBzeikKPiArewo+
ICsgICAgICAgaW50IG47Cj4gKwo+ICsgICAgICAgLyoKPiArICAgICAgICAqIENvbXB1dGUgYSBw
b3dlci1vZi10d28gYnVja2V0LCBidXQgdGhyb3cgZXZlcnl0aGluZyBncmVhdGVyIHRoYW4KPiAr
ICAgICAgICAqIDE2S2lCIGludG8gdGhlIHNhbWUgYnVja2V0OiBpLmUuIHRoZSB0aGUgYnVja2V0
cyBob2xkIG9iamVjdHMgb2YKCnRoZSBidWNrZXRzCgo+ICsgICAgICAgICogKDEgcGFnZSwgMiBw
YWdlcywgNCBwYWdlcywgOCsgcGFnZXMpLgo+ICsgICAgICAgICovCj4gKyAgICAgICBuID0gZmxz
KHN6ID4+IFBBR0VfU0hJRlQpIC0gMTsKPiArICAgICAgIGlmIChuID49IEFSUkFZX1NJWkUocG9v
bC0+Y2FjaGVfbGlzdCkpCj4gKyAgICAgICAgICAgICAgIG4gPSBBUlJBWV9TSVpFKHBvb2wtPmNh
Y2hlX2xpc3QpIC0gMTsKPiArCj4gKyAgICAgICByZXR1cm4gJnBvb2wtPmNhY2hlX2xpc3Rbbl07
Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIG5vZGVfZnJlZShzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bv
b2xfbm9kZSAqbm9kZSkKPiArewo+ICsgICAgICAgaTkxNV9nZW1fb2JqZWN0X3B1dChub2RlLT5v
YmopOwo+ICsgICAgICAga2ZyZWUobm9kZSk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgcG9vbF9h
Y3RpdmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gK3sKPiArICAgICAgIHN0cnVjdCBpbnRl
bF9lbmdpbmVfcG9vbF9ub2RlICpub2RlID0KPiArICAgICAgICAgICAgICAgY29udGFpbmVyX29m
KHJlZiwgdHlwZW9mKCpub2RlKSwgYWN0aXZlKTsKPiArICAgICAgIHN0cnVjdCByZXNlcnZhdGlv
bl9vYmplY3QgKnJlc3YgPSBub2RlLT5vYmotPmJhc2UucmVzdjsKPiArCj4gKyAgICAgICBpZiAo
cmVzZXJ2YXRpb25fb2JqZWN0X3RyeWxvY2socmVzdikpIHsKPiArICAgICAgICAgICAgICAgcmVz
ZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNsX2ZlbmNlKHJlc3YsIE5VTEwpOwo+ICsgICAgICAgICAg
ICAgICByZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKHJlc3YpOwo+ICsgICAgICAgfQo+ICsKPiAr
ICAgICAgIHJldHVybiBpOTE1X2dlbV9vYmplY3RfcGluX3BhZ2VzKG5vZGUtPm9iaik7Cj4gK30K
PiArCj4gK3N0YXRpYyB2b2lkIHBvb2xfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+
ICt7Cj4gKyAgICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2xfbm9kZSAqbm9kZSA9Cj4gKyAg
ICAgICAgICAgICAgIGNvbnRhaW5lcl9vZihyZWYsIHR5cGVvZigqbm9kZSksIGFjdGl2ZSk7Cj4g
KyAgICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgKnBvb2wgPSBub2RlLT5wb29sOwo+ICsg
ICAgICAgc3RydWN0IGxpc3RfaGVhZCAqbGlzdCA9IGJ1Y2tldF9mb3Jfc2l6ZShwb29sLCBub2Rl
LT5vYmotPmJhc2Uuc2l6ZSk7Cj4gKyAgICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOwo+ICsKPiAr
ICAgICAgIEdFTV9CVUdfT04oIWludGVsX2VuZ2luZV9wbV9pc19hd2FrZSh0b19lbmdpbmUocG9v
bCkpKTsKPiArCj4gKyAgICAgICBpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMobm9kZS0+b2Jq
KTsKPiArCj4gKyAgICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmcG9vbC0+bG9jaywgZmxhZ3MpOwo+
ICsgICAgICAgbGlzdF9hZGQoJm5vZGUtPmxpbmssIGxpc3QpOwo+ICsgICAgICAgc3Bpbl91bmxv
Y2tfaXJxcmVzdG9yZSgmcG9vbC0+bG9jaywgZmxhZ3MpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgc3Ry
dWN0IGludGVsX2VuZ2luZV9wb29sX25vZGUgKgo+ICtub2RlX2NyZWF0ZShzdHJ1Y3QgaW50ZWxf
ZW5naW5lX3Bvb2wgKnBvb2wsIHNpemVfdCBzeikKPiArewo+ICsgICAgICAgc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lID0gdG9fZW5naW5lKHBvb2wpOwo+ICsgICAgICAgc3RydWN0IGlu
dGVsX2VuZ2luZV9wb29sX25vZGUgKm5vZGU7Cj4gKyAgICAgICBzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCAqb2JqOwo+ICsKPiArICAgICAgIG5vZGUgPSBrbWFsbG9jKHNpemVvZigqbm9kZSks
Cj4gKyAgICAgICAgICAgICAgICAgICAgICBHRlBfS0VSTkVMIHwgX19HRlBfUkVUUllfTUFZRkFJ
TCB8IF9fR0ZQX05PV0FSTik7Cj4gKyAgICAgICBpZiAoIW5vZGUpCj4gKyAgICAgICAgICAgICAg
IHJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ICsKPiArICAgICAgIG5vZGUtPnBvb2wgPSBwb29s
Owo+ICsgICAgICAgaTkxNV9hY3RpdmVfaW5pdChlbmdpbmUtPmk5MTUsICZub2RlLT5hY3RpdmUs
IHBvb2xfYWN0aXZlLCBwb29sX3JldGlyZSk7Cj4gKwo+ICsgICAgICAgb2JqID0gaTkxNV9nZW1f
b2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChlbmdpbmUtPmk5MTUsIHN6KTsKPiArICAgICAgIGlmIChJ
U19FUlIob2JqKSkgewo+ICsgICAgICAgICAgICAgICBrZnJlZShub2RlKTsKPiArICAgICAgICAg
ICAgICAgcmV0dXJuIEVSUl9DQVNUKG9iaik7CgppOTE1X2FjdGl2ZV9maW5pKCkgc29tZXdoZXJl
LCBkaXR0byBmb3Igbm9kZV9mcmVlPwoKQW55d2F5LCBsb29rcyBnb29kLgpSZXZpZXdlZC1ieTog
TWF0dGhldyBBdWxkIDxtYXR0aGV3LmF1bGRAaW50ZWwuY29tPgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVs
LWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcv
bWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

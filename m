Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9734D883F4
	for <lists+intel-gfx@lfdr.de>; Fri,  9 Aug 2019 22:29:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 722F16EE9E;
	Fri,  9 Aug 2019 20:29:32 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4908B6EE99
 for <intel-gfx@lists.freedesktop.org>; Fri,  9 Aug 2019 20:29:31 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 09 Aug 2019 13:29:31 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,366,1559545200"; d="scan'208";a="204035017"
Received: from jmath3-mobl1.ger.corp.intel.com (HELO
 mwahaha-bdw.ger.corp.intel.com) ([10.252.5.86])
 by fmsmga002.fm.intel.com with ESMTP; 09 Aug 2019 13:29:30 -0700
From: Matthew Auld <matthew.auld@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri,  9 Aug 2019 21:29:26 +0100
Message-Id: <20190809202926.14545-4-matthew.auld@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190809202926.14545-1-matthew.auld@intel.com>
References: <20190809202926.14545-1-matthew.auld@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 3/3] drm/i915/blt: bump the size restriction
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgcG9pbnRlZCBvdXQgYnkgQ2hyaXMsIHdpdGggb3VyIGN1cnJlbnQgYXBwcm9hY2ggd2UgYXJl
IGFjdHVhbGx5CmxpbWl0ZWQgdG8gUzE2X01BWCAqIFBBR0VfU0laRSBmb3Igb3VyIHNpemUgd2hl
biB1c2luZyB0aGUgYmx0IHRvIGNsZWFyCnBhZ2VzLiBLZWVwaW5nIHRoaW5ncyBzaW1wbGUgdHJ5
IHRvIGZpeCB0aGlzIGJ5IHJlZHVjaW5nIHRoZSBjb3B5IHRvIGEKc2VxdWVuY2Ugb2YgUzE2X01B
WCAqIFBBR0VfU0laRSBibG9ja3MuCgpSZXBvcnRlZC1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0Bj
aHJpcy13aWxzb24uY28udWs+ClNpZ25lZC1vZmYtYnk6IE1hdHRoZXcgQXVsZCA8bWF0dGhldy5h
dWxkQGludGVsLmNvbT4KQ2M6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVr
PgotLS0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsaWVudF9ibHQuYyAgICB8ICAz
MSArKystCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfYmx0LmMgICAgfCAx
MzkgKysrKysrKysrKysrKystLS0tCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmpl
Y3RfYmx0LmggICAgfCAgIDkgKy0KIC4uLi9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY2xp
ZW50X2JsdC5jICB8ICAxNiArLQogLi4uL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9vYmpl
Y3RfYmx0LmMgIHwgIDIyICsrLQogNSBmaWxlcyBjaGFuZ2VkLCAxNzAgaW5zZXJ0aW9ucygrKSwg
NDcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX2NsaWVudF9ibHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9j
bGllbnRfYmx0LmMKaW5kZXggMDhhODRjOTQwZDhkLi40YjA5NjMwOWE5N2UgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsaWVudF9ibHQuYwpAQCAtNSw2ICs1LDgg
QEAKIAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfY29udGV4dC5o
IgorI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV9wbS5oIgorI2luY2x1ZGUgImd0L2ludGVsX2Vu
Z2luZV9wb29sLmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1fY2xpZW50X2JsdC5oIgogI2luY2x1ZGUg
Imk5MTVfZ2VtX29iamVjdF9ibHQuaCIKIApAQCAtMTU2LDcgKzE1OCw5IEBAIHN0YXRpYyB2b2lk
IGNsZWFyX3BhZ2VzX3dvcmtlcihzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB3LT5jZS0+ZW5naW5lLT5pOTE1OwogCXN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmogPSB3LT5zbGVldmUtPnZtYS0+b2JqOwogCXN0cnVjdCBpOTE1
X3ZtYSAqdm1hID0gdy0+c2xlZXZlLT52bWE7CisJc3RydWN0IGludGVsX2VuZ2luZV9wb29sX25v
ZGUgKnBvb2w7CiAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJc3RydWN0IGk5MTVfdm1hICpi
YXRjaDsKIAlpbnQgZXJyID0gdy0+ZG1hLmVycm9yOwogCiAJaWYgKHVubGlrZWx5KGVycikpCkBA
IC0xNzYsMTAgKzE4MCwxNyBAQCBzdGF0aWMgdm9pZCBjbGVhcl9wYWdlc193b3JrZXIoc3RydWN0
IHdvcmtfc3RydWN0ICp3b3JrKQogCWlmICh1bmxpa2VseShlcnIpKQogCQlnb3RvIG91dF91bmxv
Y2s7CiAKKwlpbnRlbF9lbmdpbmVfcG1fZ2V0KHctPmNlLT5lbmdpbmUpOworCWJhdGNoID0gaW50
ZWxfZW1pdF92bWFfZmlsbF9ibHQoJnBvb2wsIHctPmNlLCB2bWEsIHctPnZhbHVlKTsKKwlpZiAo
SVNfRVJSKGJhdGNoKSkgeworCQllcnIgPSBQVFJfRVJSKGJhdGNoKTsKKwkJZ290byBvdXRfdW5w
aW47CisJfQorCiAJcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KHctPmNlKTsKIAlp
ZiAoSVNfRVJSKHJxKSkgewogCQllcnIgPSBQVFJfRVJSKHJxKTsKLQkJZ290byBvdXRfdW5waW47
CisJCWdvdG8gb3V0X2JhdGNoOwogCX0KIAogCS8qIFRoZXJlJ3Mgbm8gd2F5IHRoZSBmZW5jZSBo
YXMgc2lnbmFsbGVkICovCkBAIC0xODcsNiArMTk4LDE2IEBAIHN0YXRpYyB2b2lkIGNsZWFyX3Bh
Z2VzX3dvcmtlcihzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAJCQkJICAgY2xlYXJfcGFnZXNf
ZG1hX2ZlbmNlX2NiKSkKIAkJR0VNX0JVR19PTigxKTsKIAorCWk5MTVfdm1hX2xvY2soYmF0Y2gp
OworCWVyciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKGJhdGNoLCBycSwgMCk7CisJaTkxNV92
bWFfdW5sb2NrKGJhdGNoKTsKKwlpZiAodW5saWtlbHkoZXJyKSkKKwkJZ290byBvdXRfcmVxdWVz
dDsKKworCWVyciA9IGludGVsX2VuZ2luZV9wb29sX21hcmtfYWN0aXZlKHBvb2wsIHJxKTsKKwlp
ZiAodW5saWtlbHkoZXJyKSkKKwkJZ290byBvdXRfcmVxdWVzdDsKKwogCWlmICh3LT5jZS0+ZW5n
aW5lLT5lbWl0X2luaXRfYnJlYWRjcnVtYikgewogCQllcnIgPSB3LT5jZS0+ZW5naW5lLT5lbWl0
X2luaXRfYnJlYWRjcnVtYihycSk7CiAJCWlmICh1bmxpa2VseShlcnIpKQpAQCAtMjAyLDcgKzIy
Myw5IEBAIHN0YXRpYyB2b2lkIGNsZWFyX3BhZ2VzX3dvcmtlcihzdHJ1Y3Qgd29ya19zdHJ1Y3Qg
KndvcmspCiAJaWYgKGVycikKIAkJZ290byBvdXRfcmVxdWVzdDsKIAotCWVyciA9IGludGVsX2Vt
aXRfdm1hX2ZpbGxfYmx0KHJxLCB2bWEsIHctPnZhbHVlKTsKKwllcnIgPSB3LT5jZS0+ZW5naW5l
LT5lbWl0X2JiX3N0YXJ0KHJxLAorCQkJCQkgICBiYXRjaC0+bm9kZS5zdGFydCwgYmF0Y2gtPm5v
ZGUuc2l6ZSwKKwkJCQkJICAgMCk7CiBvdXRfcmVxdWVzdDoKIAlpZiAodW5saWtlbHkoZXJyKSkg
ewogCQlpOTE1X3JlcXVlc3Rfc2tpcChycSwgZXJyKTsKQEAgLTIxMCw3ICsyMzMsMTEgQEAgc3Rh
dGljIHZvaWQgY2xlYXJfcGFnZXNfd29ya2VyKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIAl9
CiAKIAlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKK291dF9iYXRjaDoKKwlpOTE1X3ZtYV91bnBpbihi
YXRjaCk7CisJaW50ZWxfZW5naW5lX3Bvb2xfcHV0KHBvb2wpOwogb3V0X3VucGluOgorCWludGVs
X2VuZ2luZV9wbV9wdXQody0+Y2UtPmVuZ2luZSk7CiAJaTkxNV92bWFfdW5waW4odm1hKTsKIG91
dF91bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfYmx0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X2JsdC5jCmluZGV4IGZhOTBj
MzhjOGIwNy4uYzFlNWVkZDFlMzU5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fb2JqZWN0X2JsdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3RfYmx0LmMKQEAgLTUsNDkgKzUsMTAzIEBACiAKICNpbmNsdWRlICJpOTE1
X2Rydi5oIgogI2luY2x1ZGUgImd0L2ludGVsX2NvbnRleHQuaCIKKyNpbmNsdWRlICJndC9pbnRl
bF9lbmdpbmVfcG0uaCIKKyNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmVfcG9vbC5oIgorI2luY2x1
ZGUgImd0L2ludGVsX2d0LmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1fY2xmbHVzaC5oIgogI2luY2x1
ZGUgImk5MTVfZ2VtX29iamVjdF9ibHQuaCIKIAotaW50IGludGVsX2VtaXRfdm1hX2ZpbGxfYmx0
KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAotCQkJICAgIHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAot
CQkJICAgIHUzMiB2YWx1ZSkKK3N0cnVjdCBpOTE1X3ZtYSAqaW50ZWxfZW1pdF92bWFfZmlsbF9i
bHQoc3RydWN0IGludGVsX2VuZ2luZV9wb29sX25vZGUgKipwLAorCQkJCQkgc3RydWN0IGludGVs
X2NvbnRleHQgKmNlLAorCQkJCQkgc3RydWN0IGk5MTVfdm1hICp2bWEsCisJCQkJCSB1MzIgdmFs
dWUpCiB7Ci0JdTMyICpjczsKLQotCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgOCk7Ci0JaWYg
KElTX0VSUihjcykpCi0JCXJldHVybiBQVFJfRVJSKGNzKTsKLQotCWlmIChJTlRFTF9HRU4ocnEt
Pmk5MTUpID49IDgpIHsKLQkJKmNzKysgPSBYWV9DT0xPUl9CTFRfQ01EIHwgQkxUX1dSSVRFX1JH
QkEgfCAoNyAtIDIpOwotCQkqY3MrKyA9IEJMVF9ERVBUSF8zMiB8IEJMVF9ST1BfQ09MT1JfQ09Q
WSB8IFBBR0VfU0laRTsKLQkJKmNzKysgPSAwOwotCQkqY3MrKyA9IHZtYS0+c2l6ZSA+PiBQQUdF
X1NISUZUIDw8IDE2IHwgUEFHRV9TSVpFIC8gNDsKLQkJKmNzKysgPSBsb3dlcl8zMl9iaXRzKHZt
YS0+bm9kZS5zdGFydCk7Ci0JCSpjcysrID0gdXBwZXJfMzJfYml0cyh2bWEtPm5vZGUuc3RhcnQp
OwotCQkqY3MrKyA9IHZhbHVlOwotCQkqY3MrKyA9IE1JX05PT1A7Ci0JfSBlbHNlIHsKLQkJKmNz
KysgPSBYWV9DT0xPUl9CTFRfQ01EIHwgQkxUX1dSSVRFX1JHQkEgfCAoNiAtIDIpOwotCQkqY3Mr
KyA9IEJMVF9ERVBUSF8zMiB8IEJMVF9ST1BfQ09MT1JfQ09QWSB8IFBBR0VfU0laRTsKLQkJKmNz
KysgPSAwOwotCQkqY3MrKyA9IHZtYS0+c2l6ZSA+PiBQQUdFX1NISUZUIDw8IDE2IHwgUEFHRV9T
SVpFIC8gNDsKLQkJKmNzKysgPSB2bWEtPm5vZGUuc3RhcnQ7Ci0JCSpjcysrID0gdmFsdWU7Ci0J
CSpjcysrID0gTUlfTk9PUDsKLQkJKmNzKysgPSBNSV9OT09QOworCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gY2UtPnZtLT5pOTE1OworCWNvbnN0IHUzMiBibG9ja19zaXplID0gUzE2
X01BWCAqIFBBR0VfU0laRTsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2xfbm9kZSAqcG9vbDsK
KwlzdHJ1Y3QgaTkxNV92bWEgKmJhdGNoOworCXU2NCBvZmZzZXQ7CisJdTY0IGNvdW50OworCXU2
NCByZW07CisJdTMyIHNpemU7CisJdTMyICpjbWQ7CisJaW50IGVycjsKKworCWNvdW50ID0gZGl2
X3U2NCh2bWEtPnNpemUsIGJsb2NrX3NpemUpOworCXNpemUgPSAoMSArIDggKiBjb3VudCkgKiBz
aXplb2YodTMyKTsKKwlzaXplID0gcm91bmRfdXAoc2l6ZSwgUEFHRV9TSVpFKTsKKwlwb29sID0g
aW50ZWxfZW5naW5lX3Bvb2xfZ2V0KCZjZS0+ZW5naW5lLT5wb29sLCBzaXplKTsKKwlpZiAoSVNf
RVJSKHBvb2wpKQorCQlyZXR1cm4gRVJSX0NBU1QocG9vbCk7CisKKwljbWQgPSBpOTE1X2dlbV9v
YmplY3RfcGluX21hcChwb29sLT5vYmosIEk5MTVfTUFQX1dDKTsKKwlpZiAoSVNfRVJSKGNtZCkp
IHsKKwkJZXJyID0gUFRSX0VSUihjbWQpOworCQlnb3RvIG91dF9wdXQ7CisJfQorCisJcmVtID0g
dm1hLT5zaXplOworCW9mZnNldCA9IHZtYS0+bm9kZS5zdGFydDsKKworCWRvIHsKKwkJdTMyIHNp
emUgPSBtaW5fdCh1NjQsIHJlbSwgYmxvY2tfc2l6ZSk7CisKKwkJR0VNX0JVR19PTihzaXplID4+
IFBBR0VfU0hJRlQgPiBTMTZfTUFYKTsKKworCQlpZiAoSU5URUxfR0VOKGk5MTUpID49IDgpIHsK
KwkJCSpjbWQrKyA9IFhZX0NPTE9SX0JMVF9DTUQgfCBCTFRfV1JJVEVfUkdCQSB8ICg3IC0gMik7
CisJCQkqY21kKysgPSBCTFRfREVQVEhfMzIgfCBCTFRfUk9QX0NPTE9SX0NPUFkgfCBQQUdFX1NJ
WkU7CisJCQkqY21kKysgPSAwOworCQkJKmNtZCsrID0gc2l6ZSA+PiBQQUdFX1NISUZUIDw8IDE2
IHwgUEFHRV9TSVpFIC8gNDsKKwkJCSpjbWQrKyA9IGxvd2VyXzMyX2JpdHMob2Zmc2V0KTsKKwkJ
CSpjbWQrKyA9IHVwcGVyXzMyX2JpdHMob2Zmc2V0KTsKKwkJCSpjbWQrKyA9IHZhbHVlOworCQl9
IGVsc2UgeworCQkJKmNtZCsrID0gWFlfQ09MT1JfQkxUX0NNRCB8IEJMVF9XUklURV9SR0JBIHwg
KDYgLSAyKTsKKwkJCSpjbWQrKyA9IEJMVF9ERVBUSF8zMiB8IEJMVF9ST1BfQ09MT1JfQ09QWSB8
IFBBR0VfU0laRTsKKwkJCSpjbWQrKyA9IDA7CisJCQkqY21kKysgPSBzaXplID4+IFBBR0VfU0hJ
RlQgPDwgMTYgfCBQQUdFX1NJWkUgLyA0OworCQkJKmNtZCsrID0gb2Zmc2V0OworCQkJKmNtZCsr
ID0gdmFsdWU7CisJCX0KKworCQkvKiBBbGxvdyBvdXJzZWx2ZXMgdG8gYmUgcHJlZW1wdGVkIGlu
IGJldHdlZW4gYmxvY2tzLiAqLworCQkqY21kKysgPSBNSV9BUkJfQ0hFQ0s7CisKKwkJb2Zmc2V0
ICs9IHNpemU7CisJCXJlbSAtPSBzaXplOworCX0gd2hpbGUgKHJlbSk7CisKKwkqY21kID0gTUlf
QkFUQ0hfQlVGRkVSX0VORDsKKwlpbnRlbF9ndF9jaGlwc2V0X2ZsdXNoKGNlLT52bS0+Z3QpOwor
CisJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChwb29sLT5vYmopOworCisJYmF0Y2ggPSBpOTE1
X3ZtYV9pbnN0YW5jZShwb29sLT5vYmosIGNlLT52bSwgTlVMTCk7CisJaWYgKElTX0VSUihiYXRj
aCkpIHsKKwkJZXJyID0gUFRSX0VSUihiYXRjaCk7CisJCWdvdG8gb3V0X3B1dDsKIAl9CiAKLQlp
bnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKKwllcnIgPSBpOTE1X3ZtYV9waW4oYmF0Y2gsIDAs
IDAsIFBJTl9VU0VSKTsKKwlpZiAodW5saWtlbHkoZXJyKSkKKwkJZ290byBvdXRfcHV0OworCisJ
KnAgPSBwb29sOworCXJldHVybiBiYXRjaDsKIAotCXJldHVybiAwOworb3V0X3B1dDoKKwlpbnRl
bF9lbmdpbmVfcG9vbF9wdXQocG9vbCk7CisJcmV0dXJuIEVSUl9QVFIoZXJyKTsKIH0KIAogaW50
IGk5MTVfZ2VtX29iamVjdF9maWxsX2JsdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
LAogCQkJICAgICBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJCQkgICAgIHUzMiB2YWx1ZSkK
IHsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2xfbm9kZSAqcG9vbDsKIAlzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycTsKKwlzdHJ1Y3QgaTkxNV92bWEgKmJhdGNoOwogCXN0cnVjdCBpOTE1X3ZtYSAq
dm1hOwogCWludCBlcnI7CiAKQEAgLTY1LDEyICsxMTksMjkgQEAgaW50IGk5MTVfZ2VtX29iamVj
dF9maWxsX2JsdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCQlpOTE1X2dlbV9v
YmplY3RfdW5sb2NrKG9iaik7CiAJfQogCisJaW50ZWxfZW5naW5lX3BtX2dldChjZS0+ZW5naW5l
KTsKKwliYXRjaCA9IGludGVsX2VtaXRfdm1hX2ZpbGxfYmx0KCZwb29sLCBjZSwgdm1hLCB2YWx1
ZSk7CisJaWYgKElTX0VSUihiYXRjaCkpIHsKKwkJZXJyID0gUFRSX0VSUihiYXRjaCk7CisJCWdv
dG8gb3V0X3VucGluOworCX0KKwogCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChj
ZSk7CiAJaWYgKElTX0VSUihycSkpIHsKIAkJZXJyID0gUFRSX0VSUihycSk7Ci0JCWdvdG8gb3V0
X3VucGluOworCQlnb3RvIG91dF9iYXRjaDsKIAl9CiAKKwlpOTE1X3ZtYV9sb2NrKGJhdGNoKTsK
KwllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShiYXRjaCwgcnEsIDApOworCWk5MTVfdm1h
X3VubG9jayhiYXRjaCk7CisJaWYgKHVubGlrZWx5KGVycikpCisJCWdvdG8gb3V0X3JlcXVlc3Q7
CisKKwllcnIgPSBpbnRlbF9lbmdpbmVfcG9vbF9tYXJrX2FjdGl2ZShwb29sLCBycSk7CisJaWYg
KHVubGlrZWx5KGVycikpCisJCWdvdG8gb3V0X3JlcXVlc3Q7CisKIAllcnIgPSBpOTE1X3JlcXVl
c3RfYXdhaXRfb2JqZWN0KHJxLCBvYmosIHRydWUpOwogCWlmICh1bmxpa2VseShlcnIpKQogCQln
b3RvIG91dF9yZXF1ZXN0OwpAQCAtODcsMTMgKzE1OCwxOSBAQCBpbnQgaTkxNV9nZW1fb2JqZWN0
X2ZpbGxfYmx0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJaWYgKHVubGlrZWx5
KGVycikpCiAJCWdvdG8gb3V0X3JlcXVlc3Q7CiAKLQllcnIgPSBpbnRlbF9lbWl0X3ZtYV9maWxs
X2JsdChycSwgdm1hLCB2YWx1ZSk7CisJZXJyID0gY2UtPmVuZ2luZS0+ZW1pdF9iYl9zdGFydChy
cSwKKwkJCQkJYmF0Y2gtPm5vZGUuc3RhcnQsIGJhdGNoLT5ub2RlLnNpemUsCisJCQkJCTApOwog
b3V0X3JlcXVlc3Q6CiAJaWYgKHVubGlrZWx5KGVycikpCiAJCWk5MTVfcmVxdWVzdF9za2lwKHJx
LCBlcnIpOwogCiAJaTkxNV9yZXF1ZXN0X2FkZChycSk7CitvdXRfYmF0Y2g6CisJaTkxNV92bWFf
dW5waW4oYmF0Y2gpOworCWludGVsX2VuZ2luZV9wb29sX3B1dChwb29sKTsKIG91dF91bnBpbjoK
KwlpbnRlbF9lbmdpbmVfcG1fcHV0KGNlLT5lbmdpbmUpOwogCWk5MTVfdm1hX3VucGluKHZtYSk7
CiAJcmV0dXJuIGVycjsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3RfYmx0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
b2JqZWN0X2JsdC5oCmluZGV4IDdlYzdkZTZhYzBjMC4uYTc0MjVjMjM0ZDUwIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X2JsdC5oCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfYmx0LmgKQEAgLTksMTMgKzks
MTQgQEAKICNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgogCiBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdDsKK3N0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbF9ub2RlOwogc3RydWN0IGludGVsX2NvbnRl
eHQ7Ci1zdHJ1Y3QgaTkxNV9yZXF1ZXN0Owogc3RydWN0IGk5MTVfdm1hOwogCi1pbnQgaW50ZWxf
ZW1pdF92bWFfZmlsbF9ibHQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCi0JCQkgICAgc3RydWN0
IGk5MTVfdm1hICp2bWEsCi0JCQkgICAgdTMyIHZhbHVlKTsKK3N0cnVjdCBpOTE1X3ZtYSAqaW50
ZWxfZW1pdF92bWFfZmlsbF9ibHQoc3RydWN0IGludGVsX2VuZ2luZV9wb29sX25vZGUgKipwLAor
CQkJCQkgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkJCQkgc3RydWN0IGk5MTVfdm1hICp2
bWEsCisJCQkJCSB1MzIgdmFsdWUpOwogCiBpbnQgaTkxNV9nZW1fb2JqZWN0X2ZpbGxfYmx0KHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCQkgICAgIHN0cnVjdCBpbnRlbF9jb250
ZXh0ICpjZSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMv
aTkxNV9nZW1fY2xpZW50X2JsdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0
cy9pOTE1X2dlbV9jbGllbnRfYmx0LmMKaW5kZXggMjc1YzI4OTI2MDY3Li5kODgwNGE4NDc5NDUg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1f
Y2xpZW50X2JsdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkx
NV9nZW1fY2xpZW50X2JsdC5jCkBAIC05LDYgKzksNyBAQAogCiAjaW5jbHVkZSAic2VsZnRlc3Rz
L2lndF9mbHVzaF90ZXN0LmgiCiAjaW5jbHVkZSAic2VsZnRlc3RzL21vY2tfZHJtLmgiCisjaW5j
bHVkZSAiaHVnZV9nZW1fb2JqZWN0LmgiCiAjaW5jbHVkZSAibW9ja19jb250ZXh0LmgiCiAKIHN0
YXRpYyBpbnQgaWd0X2NsaWVudF9maWxsKHZvaWQgKmFyZykKQEAgLTI0LDE1ICsyNSwxOSBAQCBz
dGF0aWMgaW50IGlndF9jbGllbnRfZmlsbCh2b2lkICphcmcpCiAJcHJhbmRvbV9zZWVkX3N0YXRl
KCZwcm5nLCBpOTE1X3NlbGZ0ZXN0LnJhbmRvbV9zZWVkKTsKIAogCWRvIHsKLQkJdTMyIHN6ID0g
cHJhbmRvbV91MzJfc3RhdGUoJnBybmcpICUgU1pfMzJNOworCQljb25zdCB1MzIgbWF4X2Jsb2Nr
X3NpemUgPSBTMTZfTUFYICogUEFHRV9TSVpFOworCQl1MzIgc3ogPSBtaW5fdCh1NjQsIGNlLT52
bS0+dG90YWwgPj4gNCwgcHJhbmRvbV91MzJfc3RhdGUoJnBybmcpKTsKKwkJdTMyIHBoeXNfc3og
PSBzeiAlIChtYXhfYmxvY2tfc2l6ZSArIDEpOwogCQl1MzIgdmFsID0gcHJhbmRvbV91MzJfc3Rh
dGUoJnBybmcpOwogCQl1MzIgaTsKIAogCQlzeiA9IHJvdW5kX3VwKHN6LCBQQUdFX1NJWkUpOwor
CQlwaHlzX3N6ID0gcm91bmRfdXAocGh5c19zeiwgUEFHRV9TSVpFKTsKIAotCQlwcl9kZWJ1Zygi
JXMgd2l0aCBzej0leCwgdmFsPSV4XG4iLCBfX2Z1bmNfXywgc3osIHZhbCk7CisJCXByX2RlYnVn
KCIlcyB3aXRoIHBoeXNfc3o9ICV4LCBzej0leCwgdmFsPSV4XG4iLCBfX2Z1bmNfXywKKwkJCSBw
aHlzX3N6LCBzeiwgdmFsKTsKIAotCQlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX2ludGVy
bmFsKGk5MTUsIHN6KTsKKwkJb2JqID0gaHVnZV9nZW1fb2JqZWN0KGk5MTUsIHBoeXNfc3osIHN6
KTsKIAkJaWYgKElTX0VSUihvYmopKSB7CiAJCQllcnIgPSBQVFJfRVJSKG9iaik7CiAJCQlnb3Rv
IGVycl9mbHVzaDsKQEAgLTU0LDcgKzU5LDggQEAgc3RhdGljIGludCBpZ3RfY2xpZW50X2ZpbGwo
dm9pZCAqYXJnKQogCQkgKiB2YWx1ZXMgYWZ0ZXIgd2UgZG8gdGhlIHNldF90b19jcHVfZG9tYWlu
IGFuZCBwaWNrIGl0IHVwIGFzIGEKIAkJICogdGVzdCBmYWlsdXJlLgogCQkgKi8KLQkJbWVtc2V0
MzIodmFkZHIsIHZhbCBeIDB4ZGVhZGJlYWYsIG9iai0+YmFzZS5zaXplIC8gc2l6ZW9mKHUzMikp
OworCQltZW1zZXQzMih2YWRkciwgdmFsIF4gMHhkZWFkYmVhZiwKKwkJCSBodWdlX2dlbV9vYmpl
Y3RfcGh5c19zaXplKG9iaikgLyBzaXplb2YodTMyKSk7CiAKIAkJaWYgKCEob2JqLT5jYWNoZV9j
b2hlcmVudCAmIEk5MTVfQk9fQ0FDSEVfQ09IRVJFTlRfRk9SX1dSSVRFKSkKIAkJCW9iai0+Y2Fj
aGVfZGlydHkgPSB0cnVlOwpAQCAtNzEsNyArNzcsNyBAQCBzdGF0aWMgaW50IGlndF9jbGllbnRf
ZmlsbCh2b2lkICphcmcpCiAJCWlmIChlcnIpCiAJCQlnb3RvIGVycl91bnBpbjsKIAotCQlmb3Ig
KGkgPSAwOyBpIDwgb2JqLT5iYXNlLnNpemUgLyBzaXplb2YodTMyKTsgKytpKSB7CisJCWZvciAo
aSA9IDA7IGkgPCBodWdlX2dlbV9vYmplY3RfcGh5c19zaXplKG9iaikgLyBzaXplb2YodTMyKTsg
KytpKSB7CiAJCQlpZiAodmFkZHJbaV0gIT0gdmFsKSB7CiAJCQkJcHJfZXJyKCJ2YWRkclsldV09
JXgsIGV4cGVjdGVkPSV4XG4iLCBpLAogCQkJCSAgICAgICB2YWRkcltpXSwgdmFsKTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fb2JqZWN0
X2JsdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9vYmpl
Y3RfYmx0LmMKaW5kZXggMTk4NDNhY2M4NGQzLi5jNmUxZWViZTUzZjUgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fb2JqZWN0X2JsdC5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fb2JqZWN0X2Js
dC5jCkBAIC05LDYgKzksNyBAQAogCiAjaW5jbHVkZSAic2VsZnRlc3RzL2lndF9mbHVzaF90ZXN0
LmgiCiAjaW5jbHVkZSAic2VsZnRlc3RzL21vY2tfZHJtLmgiCisjaW5jbHVkZSAiaHVnZV9nZW1f
b2JqZWN0LmgiCiAjaW5jbHVkZSAibW9ja19jb250ZXh0LmgiCiAKIHN0YXRpYyBpbnQgaWd0X2Zp
bGxfYmx0KHZvaWQgKmFyZykKQEAgLTIzLDE2ICsyNCwyNiBAQCBzdGF0aWMgaW50IGlndF9maWxs
X2JsdCh2b2lkICphcmcpCiAKIAlwcmFuZG9tX3NlZWRfc3RhdGUoJnBybmcsIGk5MTVfc2VsZnRl
c3QucmFuZG9tX3NlZWQpOwogCisJLyoKKwkgKiBYWFg6IG5lZWRzIHNvbWUgdGhyZWFkcyB0byBz
Y2FsZSBhbGwgdGhlc2UgdGVzdHMsIGFsc28gbWF5YmUgdGhyb3cKKwkgKiBpbiBzdWJtaXNzaW9u
IGZyb20gaGlnaGVyIHByaW9yaXR5IGNvbnRleHQgdG8gc2VlIGlmIHdlIGFyZQorCSAqIHByZWVt
cHRlZCBmb3IgdmVyeSBsYXJnZSBvYmplY3RzLi4uCisJICovCisKIAlkbyB7Ci0JCXUzMiBzeiA9
IHByYW5kb21fdTMyX3N0YXRlKCZwcm5nKSAlIFNaXzMyTTsKKwkJY29uc3QgdTMyIG1heF9ibG9j
a19zaXplID0gUzE2X01BWCAqIFBBR0VfU0laRTsKKwkJdTMyIHN6ID0gbWluX3QodTY0LCBjZS0+
dm0tPnRvdGFsID4+IDQsIHByYW5kb21fdTMyX3N0YXRlKCZwcm5nKSk7CisJCXUzMiBwaHlzX3N6
ID0gc3ogJSAobWF4X2Jsb2NrX3NpemUgKyAxKTsKIAkJdTMyIHZhbCA9IHByYW5kb21fdTMyX3N0
YXRlKCZwcm5nKTsKIAkJdTMyIGk7CiAKIAkJc3ogPSByb3VuZF91cChzeiwgUEFHRV9TSVpFKTsK
KwkJcGh5c19zeiA9IHJvdW5kX3VwKHBoeXNfc3osIFBBR0VfU0laRSk7CiAKLQkJcHJfZGVidWco
IiVzIHdpdGggc3o9JXgsIHZhbD0leFxuIiwgX19mdW5jX18sIHN6LCB2YWwpOworCQlwcl9kZWJ1
ZygiJXMgd2l0aCBwaHlzX3N6PSAleCwgc3o9JXgsIHZhbD0leFxuIiwgX19mdW5jX18sCisJCQkg
cGh5c19zeiwgc3osIHZhbCk7CiAKLQkJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRl
cm5hbChpOTE1LCBzeik7CisJCW9iaiA9IGh1Z2VfZ2VtX29iamVjdChpOTE1LCBwaHlzX3N6LCBz
eik7CiAJCWlmIChJU19FUlIob2JqKSkgewogCQkJZXJyID0gUFRSX0VSUihvYmopOwogCQkJZ290
byBlcnJfZmx1c2g7CkBAIC00OCw3ICs1OSw4IEBAIHN0YXRpYyBpbnQgaWd0X2ZpbGxfYmx0KHZv
aWQgKmFyZykKIAkJICogTWFrZSBzdXJlIHRoZSBwb3RlbnRpYWxseSBhc3luYyBjbGZsdXNoIGRv
ZXMgaXRzIGpvYiwgaWYKIAkJICogcmVxdWlyZWQuCiAJCSAqLwotCQltZW1zZXQzMih2YWRkciwg
dmFsIF4gMHhkZWFkYmVhZiwgb2JqLT5iYXNlLnNpemUgLyBzaXplb2YodTMyKSk7CisJCW1lbXNl
dDMyKHZhZGRyLCB2YWwgXiAweGRlYWRiZWFmLAorCQkJIGh1Z2VfZ2VtX29iamVjdF9waHlzX3Np
emUob2JqKSAvIHNpemVvZih1MzIpKTsKIAogCQlpZiAoIShvYmotPmNhY2hlX2NvaGVyZW50ICYg
STkxNV9CT19DQUNIRV9DT0hFUkVOVF9GT1JfV1JJVEUpKQogCQkJb2JqLT5jYWNoZV9kaXJ0eSA9
IHRydWU7CkBAIC02NSw3ICs3Nyw3IEBAIHN0YXRpYyBpbnQgaWd0X2ZpbGxfYmx0KHZvaWQgKmFy
ZykKIAkJaWYgKGVycikKIAkJCWdvdG8gZXJyX3VucGluOwogCi0JCWZvciAoaSA9IDA7IGkgPCBv
YmotPmJhc2Uuc2l6ZSAvIHNpemVvZih1MzIpOyArK2kpIHsKKwkJZm9yIChpID0gMDsgaSA8IGh1
Z2VfZ2VtX29iamVjdF9waHlzX3NpemUob2JqKSAvIHNpemVvZih1MzIpOyArK2kpIHsKIAkJCWlm
ICh2YWRkcltpXSAhPSB2YWwpIHsKIAkJCQlwcl9lcnIoInZhZGRyWyV1XT0leCwgZXhwZWN0ZWQ9
JXhcbiIsIGksCiAJCQkJICAgICAgIHZhZGRyW2ldLCB2YWwpOwotLSAKMi4yMC4xCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

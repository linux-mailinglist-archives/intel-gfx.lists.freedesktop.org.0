Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 68E42151B92
	for <lists+intel-gfx@lfdr.de>; Tue,  4 Feb 2020 14:43:12 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D432D6EEC0;
	Tue,  4 Feb 2020 13:43:10 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 565F36EEC0
 for <intel-gfx@lists.freedesktop.org>; Tue,  4 Feb 2020 13:43:09 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by fmsmga106.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 04 Feb 2020 05:43:08 -0800
X-IronPort-AV: E=Sophos;i="5.70,401,1574150400"; d="scan'208";a="249347239"
Received: from jnikula-mobl3.fi.intel.com (HELO localhost) ([10.237.66.161])
 by orsmga002-auth.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 04 Feb 2020 05:43:07 -0800
From: Jani Nikula <jani.nikula@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue,  4 Feb 2020 15:42:26 +0200
Message-Id: <7fc880135aa33aa1eab703c881fd6ecb0480befc.1580823606.git.jani.nikula@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <cover.1580823606.git.jani.nikula@intel.com>
References: <cover.1580823606.git.jani.nikula@intel.com>
MIME-Version: 1.0
Organization: Intel Finland Oy - BIC 0357606-4 - Westendinkatu 7, 02160 Espoo
Subject: [Intel-gfx] [PATCH 7/9] drm/i915: split intel_modeset_init()
 pre/post gem init
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: jani.nikula@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VHVybiBjdXJyZW50IGludGVsX21vZGVzZXRfaW5pdCgpIHRvIGEgcHJlLWdlbSBpbml0IGZ1bmN0
aW9uLCBhbmQgYWRkIGEKbmV3IGludGVsX21vZGVzZXRfaW5pdCgpIGZ1bmN0aW9uIGFuZCBtb3Zl
IGFsbCBwb3N0LWdlbSBtb2Rlc2V0IGluaXQKdGhlcmUsIGluIHRoZSBjb3JyZWN0IGxheWVyLiBB
Z2FpbiwgYXBhcnQgZnJvbSBwb3NzaWJsZSBmYWlsdXJlIHBhdGhzLApubyBmdW5jdGlvbmFsIGNo
YW5nZXMuCgpDYzogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNv
bT4KU2lnbmVkLW9mZi1ieTogSmFuaSBOaWt1bGEgPGphbmkubmlrdWxhQGludGVsLmNvbT4KLS0t
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyB8IDI2ICsrKysr
KysrKysrKysrKysrKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXkuaCB8ICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAg
IHwgMTQgKystLS0tLS0tLS0KIDMgZmlsZXMgY2hhbmdlZCwgMjcgaW5zZXJ0aW9ucygrKSwgMTQg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXkuYwppbmRleCAyY2FjNmQ2MWRiYTIuLjM5YzEyYTYwODEwMyAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTE3ODg0LDggKzE3ODg0LDggQEAg
aW50IGludGVsX21vZGVzZXRfaW5pdF9ub2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKIAlyZXR1cm4gMDsKIH0KIAotLyogcGFydCAjMjogY2FsbCBhZnRlciBpcnEgaW5zdGFsbCAq
LwotaW50IGludGVsX21vZGVzZXRfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
Ky8qIHBhcnQgIzI6IGNhbGwgYWZ0ZXIgaXJxIGluc3RhbGwsIGJ1dCBiZWZvcmUgZ2VtIGluaXQg
Ki8KK2ludCBpbnRlbF9tb2Rlc2V0X2luaXRfbm9nZW0oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCiB7CiAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZpOTE1LT5kcm07CiAJZW51bSBw
aXBlIHBpcGU7CkBAIC0xNzk3NCw2ICsxNzk3NCwyOCBAQCBpbnQgaW50ZWxfbW9kZXNldF9pbml0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCXJldHVybiAwOwogfQogCisvKiBwYXJ0
ICMzOiBjYWxsIGFmdGVyIGdlbSBpbml0ICovCitpbnQgaW50ZWxfbW9kZXNldF9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQoreworCWludCByZXQ7CisKKwlpbnRlbF9vdmVybGF5
X3NldHVwKGk5MTUpOworCisJaWYgKCFIQVNfRElTUExBWShpOTE1KSB8fCAhSU5URUxfRElTUExB
WV9FTkFCTEVEKGk5MTUpKQorCQlyZXR1cm4gMDsKKworCXJldCA9IGludGVsX2ZiZGV2X2luaXQo
Jmk5MTUtPmRybSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCS8qIE9ubHkgZW5hYmxl
IGhvdHBsdWcgaGFuZGxpbmcgb25jZSB0aGUgZmJkZXYgaXMgZnVsbHkgc2V0IHVwLiAqLworCWlu
dGVsX2hwZF9pbml0KGk5MTUpOworCisJaW50ZWxfaW5pdF9pcGMoaTkxNSk7CisKKwlyZXR1cm4g
MDsKK30KKwogdm9pZCBpODMwX2VuYWJsZV9waXBlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgZW51bSBwaXBlIHBpcGUpCiB7CiAJc3RydWN0IGludGVsX2NydGMgKmNydGMgPSBp
bnRlbF9nZXRfY3J0Y19mb3JfcGlwZShkZXZfcHJpdiwgcGlwZSk7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5oCmluZGV4IDhmOTk0MjQ0Y2NjNy4uNjJlZTli
OWQyMTJjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rp
c3BsYXkuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXku
aApAQCAtNjE1LDYgKzYxNSw3IEBAIGludGVsX2Zvcm1hdF9pbmZvX2lzX3l1dl9zZW1pcGxhbmFy
KGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8gKmluZm8sCiAvKiBtb2Rlc2V0dGluZyAqLwog
dm9pZCBpbnRlbF9tb2Rlc2V0X2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
OwogaW50IGludGVsX21vZGVzZXRfaW5pdF9ub2lycShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7CitpbnQgaW50ZWxfbW9kZXNldF9pbml0X25vZ2VtKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKIGludCBpbnRlbF9tb2Rlc2V0X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwogdm9pZCBpbnRlbF9tb2Rlc2V0X2RyaXZlcl9yZW1vdmUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwogdm9pZCBpbnRlbF9tb2Rlc2V0X2RyaXZlcl9yZW1vdmVfbm9p
cnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMK
aW5kZXggOTA1Mjc3NDkwMDI0Li4yMWYwNzcwOWRjOWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYu
YwpAQCAtMzE2LDcgKzMxNiw3IEBAIHN0YXRpYyBpbnQgaTkxNV9kcml2ZXJfbW9kZXNldF9wcm9i
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAogCS8qIEltcG9ydGFudDogVGhlIG91
dHB1dCBzZXR1cCBmdW5jdGlvbnMgY2FsbGVkIGJ5IG1vZGVzZXRfaW5pdCBuZWVkCiAJICogd29y
a2luZyBpcnFzIGZvciBlLmcuIGdtYnVzIGFuZCBkcCBhdXggdHJhbnNmZXJzLiAqLwotCXJldCA9
IGludGVsX21vZGVzZXRfaW5pdChpOTE1KTsKKwlyZXQgPSBpbnRlbF9tb2Rlc2V0X2luaXRfbm9n
ZW0oaTkxNSk7CiAJaWYgKHJldCkKIAkJZ290byBvdXQ7CiAKQEAgLTMyNCwyMCArMzI0LDEwIEBA
IHN0YXRpYyBpbnQgaTkxNV9kcml2ZXJfbW9kZXNldF9wcm9iZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKIAlpZiAocmV0KQogCQlnb3RvIGNsZWFudXBfbW9kZXNldDsKIAotCWludGVs
X292ZXJsYXlfc2V0dXAoaTkxNSk7Ci0KLQlpZiAoIUhBU19ESVNQTEFZKGk5MTUpIHx8ICFJTlRF
TF9ESVNQTEFZX0VOQUJMRUQoaTkxNSkpCi0JCXJldHVybiAwOwotCi0JcmV0ID0gaW50ZWxfZmJk
ZXZfaW5pdCgmaTkxNS0+ZHJtKTsKKwlyZXQgPSBpbnRlbF9tb2Rlc2V0X2luaXQoaTkxNSk7CiAJ
aWYgKHJldCkKIAkJZ290byBjbGVhbnVwX2dlbTsKIAotCS8qIE9ubHkgZW5hYmxlIGhvdHBsdWcg
aGFuZGxpbmcgb25jZSB0aGUgZmJkZXYgaXMgZnVsbHkgc2V0IHVwLiAqLwotCWludGVsX2hwZF9p
bml0KGk5MTUpOwotCi0JaW50ZWxfaW5pdF9pcGMoaTkxNSk7Ci0KIAlyZXR1cm4gMDsKIAogY2xl
YW51cF9nZW06Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L2ludGVsLWdmeAo=

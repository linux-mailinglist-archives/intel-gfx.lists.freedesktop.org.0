Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 24B4D2E64CD
	for <lists+intel-gfx@lfdr.de>; Mon, 28 Dec 2020 16:54:27 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 651E289BAF;
	Mon, 28 Dec 2020 15:54:25 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9F7C38925D
 for <intel-gfx@lists.freedesktop.org>; Mon, 28 Dec 2020 15:52:55 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 23448211-1500050 
 for multiple; Mon, 28 Dec 2020 15:52:38 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 28 Dec 2020 15:52:07 +0000
Message-Id: <20201228155229.9516-32-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20201228155229.9516-1-chris@chris-wilson.co.uk>
References: <20201228155229.9516-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 32/54] drm/i915: Replace priolist rbtree with a
 skiplist
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Chris Wilson <chris@chris-wilson.co.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UmVwbGFjZSB0aGUgcHJpb2xpc3QgcmJ0cmVlIHdpdGggYSBza2lwbGlzdC4gVGhlIGNydWNpYWwg
ZGlmZmVyZW5jZSBpcwp0aGF0IHdhbGtpbmcgYW5kIHJlbW92aW5nIHRoZSBmaXJzdCBlbGVtZW50
IG9mIGEgc2tpcGxpc3QgaXMgTygxKSwgYnV0Ck8obGdOKSBmb3IgYW4gcmJ0cmVlLCBhcyB3ZSBu
ZWVkIHRvIHJlYmFsYW5jZSBvbiByZW1vdmUuIFRoaXMgaXMgYQpoaW5kcmFuY2UgZm9yIHN1Ym1p
c3Npb24gbGF0ZW5jeSBhcyBpdCBvY2N1cnMgYmV0d2VlbiBwaWNraW5nIGEgcmVxdWVzdApmb3Ig
dGhlIHByaW9saXN0IGFuZCBzdWJtaXR0aW5nIGl0IHRvIGhhcmR3YXJlLCBhcyB3ZWxsIGVmZmVj
dGl2ZWx5CnRyaXBwbGluZyB0aGUgbnVtYmVyIG9mIE8obGdOKSBvcGVyYXRpb25zIHJlcXVpcmVk
IHVuZGVyIHRoZSBpcnFvZmYgbG9jay4KVGhpcyBpcyBjcml0aWNhbCB0byByZWR1Y2luZyB0aGUg
bGF0ZW5jeSBqaXR0ZXIgd2l0aCBtdWx0aXBsZSBjbGllbnRzLgoKVGhlIGRvd25zaWRlcyB0byBz
a2lwbGlzdHMgYXJlIHRoYXQgbG9va3VwL2luc2VydGlvbiBpcyBvbmx5CnByb2JhYmxpc3RpY2Fs
bHkgTyhsZ04pIGFuZCB0aGVyZSBpcyBhIHNpZ25pZmljYW50IG1lbW9yeSBwZW5hbHR5IHRvCmFz
IGVhY2ggc2tpcCBub2RlIGlzIGxhcmdlciB0aGFuIHRoZSByYnRyZWUgZXF1aXZhbGVudC4gRnVy
dGhlcm1vcmUsIHdlCmRvbid0IHVzZSBkeW5hbWljIGFycmF5cyBmb3IgdGhlIHNraXBsaXN0LCBz
byB0aGUgYWxsb2NhdGlvbiBpcyBmaXhlZCwKYW5kIGltcG9zZXMgYW4gdXBwZXIgYm91bmQgb24g
dGhlIHNjYWxhYmlsaXR5IHdydCB0byB0aGUgbnVtYmVyIG9mCmluZmxpZ2h0IHJlcXVlc3RzLgoK
U2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0t
LQogLi4uL2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMgIHwgIDYzICsr
LS0tCiAuLi4vZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMgfCAgMzAg
Ky0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ByaW9saXN0X3R5cGVzLmggICAgfCAgMjkg
KystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3NjaGVkdWxlci5jICAgICAgICAgfCAyMzMg
KysrKysrKysrKysrKy0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3NjaGVkdWxlci5o
ICAgICAgICAgfCAgMTEgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc2NoZWR1bGVyX3R5
cGVzLmggICB8ICAgMiArLQogLi4uL2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X21vY2tfc2VsZnRl
c3RzLmggIHwgICAxICsKIC4uLi9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfc2NoZWR1bGVy
LmMgICB8ICA0MiArKystCiA4IGZpbGVzIGNoYW5nZWQsIDI5NCBpbnNlcnRpb25zKCspLCAxMTcg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZXhlY2xpc3RzX3N1Ym1pc3Npb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4
ZWNsaXN0c19zdWJtaXNzaW9uLmMKaW5kZXggMjI3Nzk1OGFlZmQ5Li4yN2MyNmZkZTMwMjEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNz
aW9uLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1p
c3Npb24uYwpAQCAtMjU2LDExICsyNTYsNiBAQCByaW5nX3NldF9wYXVzZWQoY29uc3Qgc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBpbnQgc3RhdGUpCiAJCXdtYigpOwogfQogCi1zdGF0
aWMgaW5saW5lIHN0cnVjdCBpOTE1X3ByaW9saXN0ICp0b19wcmlvbGlzdChzdHJ1Y3QgcmJfbm9k
ZSAqcmIpCi17Ci0JcmV0dXJuIHJiX2VudHJ5KHJiLCBzdHJ1Y3QgaTkxNV9wcmlvbGlzdCwgbm9k
ZSk7Ci19Ci0KIHN0YXRpYyBpbmxpbmUgaW50IHJxX3ByaW8oY29uc3Qgc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnEpCiB7CiAJcmV0dXJuIFJFQURfT05DRShycS0+c2NoZWQuYXR0ci5wcmlvcml0eSk7
CkBAIC0yODQsMTUgKzI3OSwzMSBAQCBzdGF0aWMgaW50IGVmZmVjdGl2ZV9wcmlvKGNvbnN0IHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCXJldHVybiBwcmlvOwogfQogCi1zdGF0aWMgaW50IHF1
ZXVlX3ByaW8oY29uc3Qgc3RydWN0IGk5MTVfc2NoZWRfZW5naW5lICpzZSkKK3N0YXRpYyBzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpmaXJzdF9yZXF1ZXN0KHN0cnVjdCBpOTE1X3NjaGVkX2VuZ2luZSAq
c2UpCiB7Ci0Jc3RydWN0IHJiX25vZGUgKnJiOworCXN0cnVjdCBpOTE1X3ByaW9saXN0ICpwbDsK
KworCWZvcl9lYWNoX3ByaW9saXN0KHBsLCAmc2UtPnF1ZXVlKSB7CisJCWlmIChsaWtlbHkoIWxp
c3RfZW1wdHkoJnBsLT5yZXF1ZXN0cykpKQorCQkJcmV0dXJuIGxpc3RfZmlyc3RfZW50cnkoJnBs
LT5yZXF1ZXN0cywKKwkJCQkJCXN0cnVjdCBpOTE1X3JlcXVlc3QsCisJCQkJCQlzY2hlZC5saW5r
KTsKKworCQlpOTE1X3ByaW9saXN0X2FkdmFuY2UoJnNlLT5xdWV1ZSwgcGwpOworCX0KKworCXJl
dHVybiBOVUxMOworfQogCi0JcmIgPSByYl9maXJzdF9jYWNoZWQoJnNlLT5xdWV1ZSk7Ci0JaWYg
KCFyYikKK3N0YXRpYyBpbnQgcXVldWVfcHJpbyhzdHJ1Y3QgaTkxNV9zY2hlZF9lbmdpbmUgKnNl
KQoreworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCisJcnEgPSBmaXJzdF9yZXF1ZXN0KHNl
KTsKKwlpZiAoIXJxKQogCQlyZXR1cm4gSU5UX01JTjsKIAotCXJldHVybiB0b19wcmlvbGlzdChy
YiktPnByaW9yaXR5OworCXJldHVybiBycV9wcmlvKHJxKTsKIH0KIAogc3RhdGljIGludCB2aXJ0
dWFsX3ByaW8oY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKmVsKQpAQCAtMzAy
LDcgKzMxMyw3IEBAIHN0YXRpYyBpbnQgdmlydHVhbF9wcmlvKGNvbnN0IHN0cnVjdCBpbnRlbF9l
bmdpbmVfZXhlY2xpc3RzICplbCkKIAlyZXR1cm4gcmIgPyByYl9lbnRyeShyYiwgc3RydWN0IHZl
X25vZGUsIHJiKS0+cHJpbyA6IElOVF9NSU47CiB9CiAKLXN0YXRpYyBpbmxpbmUgYm9vbCBuZWVk
X3ByZWVtcHQoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorc3RhdGljIGlu
bGluZSBib29sIG5lZWRfcHJlZW1wdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJ
CQkJY29uc3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CiAJaW50IGxhc3RfcHJpbzsKQEAg
LTExMzksNiArMTE1MCw3IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19kZXF1ZXVlKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoqIGNvbnN0IGxh
c3RfcG9ydCA9IHBvcnQgKyBleGVjbGlzdHMtPnBvcnRfbWFzazsKIAlzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpsYXN0LCAqIGNvbnN0ICphY3RpdmU7CiAJc3RydWN0IHZpcnR1YWxfZW5naW5lICp2ZTsK
KwlzdHJ1Y3QgaTkxNV9wcmlvbGlzdCAqcGw7CiAJc3RydWN0IHJiX25vZGUgKnJiOwogCWJvb2wg
c3VibWl0ID0gZmFsc2U7CiAKQEAgLTEzMzgsMTEgKzEzNTAsMTAgQEAgc3RhdGljIHZvaWQgZXhl
Y2xpc3RzX2RlcXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkJYnJlYWs7
CiAJfQogCi0Jd2hpbGUgKChyYiA9IHJiX2ZpcnN0X2NhY2hlZCgmZW5naW5lLT5hY3RpdmUucXVl
dWUpKSkgewotCQlzdHJ1Y3QgaTkxNV9wcmlvbGlzdCAqcCA9IHRvX3ByaW9saXN0KHJiKTsKKwlm
b3JfZWFjaF9wcmlvbGlzdChwbCwgJmVuZ2luZS0+YWN0aXZlLnF1ZXVlKSB7CiAJCXN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxLCAqcm47CiAKLQkJcHJpb2xpc3RfZm9yX2VhY2hfcmVxdWVzdF9jb25z
dW1lKHJxLCBybiwgcCkgeworCQlwcmlvbGlzdF9mb3JfZWFjaF9yZXF1ZXN0X3NhZmUocnEsIHJu
LCBwbCkgewogCQkJYm9vbCBtZXJnZSA9IHRydWU7CiAKIAkJCS8qCkBAIC0xNDE3LDggKzE0Mjgs
NyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUpCiAJCQl9CiAJCX0KIAotCQlyYl9lcmFzZV9jYWNoZWQoJnAtPm5vZGUsICZlbmdp
bmUtPmFjdGl2ZS5xdWV1ZSk7Ci0JCWk5MTVfcHJpb2xpc3RfZnJlZShwKTsKKwkJaTkxNV9wcmlv
bGlzdF9hZHZhbmNlKCZlbmdpbmUtPmFjdGl2ZS5xdWV1ZSwgcGwpOwogCX0KIGRvbmU6CiAJKnBv
cnQrKyA9IGk5MTVfcmVxdWVzdF9nZXQobGFzdCk7CkBAIC0yNjQzLDYgKzI2NTMsNyBAQCBzdGF0
aWMgdm9pZCBleGVjbGlzdHNfcmVzZXRfY2FuY2VsKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0
cyA9ICZlbmdpbmUtPmV4ZWNsaXN0czsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgKnJuOwor
CXN0cnVjdCBpOTE1X3ByaW9saXN0ICpwbDsKIAlzdHJ1Y3QgcmJfbm9kZSAqcmI7CiAJdW5zaWdu
ZWQgbG9uZyBmbGFnczsKIApAQCAtMjY3MywxNiArMjY4NCwxMiBAQCBzdGF0aWMgdm9pZCBleGVj
bGlzdHNfcmVzZXRfY2FuY2VsKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlpbnRl
bF9lbmdpbmVfc2lnbmFsX2JyZWFkY3J1bWJzKGVuZ2luZSk7CiAKIAkvKiBGbHVzaCB0aGUgcXVl
dWVkIHJlcXVlc3RzIHRvIHRoZSB0aW1lbGluZSBsaXN0IChmb3IgcmV0aXJpbmcpLiAqLwotCXdo
aWxlICgocmIgPSByYl9maXJzdF9jYWNoZWQoJmVuZ2luZS0+YWN0aXZlLnF1ZXVlKSkpIHsKLQkJ
c3RydWN0IGk5MTVfcHJpb2xpc3QgKnAgPSB0b19wcmlvbGlzdChyYik7Ci0KLQkJcHJpb2xpc3Rf
Zm9yX2VhY2hfcmVxdWVzdF9jb25zdW1lKHJxLCBybiwgcCkgeworCWZvcl9lYWNoX3ByaW9saXN0
KHBsLCAmZW5naW5lLT5hY3RpdmUucXVldWUpIHsKKwkJcHJpb2xpc3RfZm9yX2VhY2hfcmVxdWVz
dF9zYWZlKHJxLCBybiwgcGwpIHsKIAkJCW1hcmtfZWlvKHJxKTsKIAkJCV9faTkxNV9yZXF1ZXN0
X3N1Ym1pdChycSk7CiAJCX0KLQotCQlyYl9lcmFzZV9jYWNoZWQoJnAtPm5vZGUsICZlbmdpbmUt
PmFjdGl2ZS5xdWV1ZSk7Ci0JCWk5MTVfcHJpb2xpc3RfZnJlZShwKTsKKwkJaTkxNV9wcmlvbGlz
dF9hZHZhbmNlKCZlbmdpbmUtPmFjdGl2ZS5xdWV1ZSwgcGwpOwogCX0KIAlHRU1fQlVHX09OKCFp
OTE1X3NjaGVkX2lzX2lkbGUoJmVuZ2luZS0+YWN0aXZlKSk7CiAKQEAgLTI3MTUsNyArMjcyMiw2
IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19yZXNldF9jYW5jZWwoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQogCS8qIFJlbWFpbmluZyBfdW5yZWFkeV8gcmVxdWVzdHMgd2lsbCBiZSBu
b3AnZWQgd2hlbiBzdWJtaXR0ZWQgKi8KIAogCWV4ZWNsaXN0cy0+cXVldWVfcHJpb3JpdHlfaGlu
dCA9IElOVF9NSU47Ci0JZW5naW5lLT5hY3RpdmUucXVldWUgPSBSQl9ST09UX0NBQ0hFRDsKIAog
CUdFTV9CVUdfT04oX190YXNrbGV0X2lzX2VuYWJsZWQoJmVuZ2luZS0+YWN0aXZlLnRhc2tsZXQp
KTsKIAllbmdpbmUtPmFjdGl2ZS50YXNrbGV0LmZ1bmMgPSBub3Bfc3VibWlzc2lvbl90YXNrbGV0
OwpAQCAtMzA5OCw2ICszMTA0LDggQEAgc3RhdGljIHZvaWQgdmlydHVhbF9jb250ZXh0X2V4aXQo
c3RydWN0IGludGVsX2NvbnRleHQgKmNlKQogCiAJZm9yIChuID0gMDsgbiA8IHZlLT5udW1fc2li
bGluZ3M7IG4rKykKIAkJaW50ZWxfZW5naW5lX3BtX3B1dCh2ZS0+c2libGluZ3Nbbl0pOworCisJ
aTkxNV9zY2hlZF9wYXJrX2VuZ2luZSgmdmUtPmJhc2UuYWN0aXZlKTsKIH0KIAogc3RhdGljIGNv
bnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0X29wcyB2aXJ0dWFsX2NvbnRleHRfb3BzID0gewpAQCAt
MzUwOCw2ICszNTE2LDcgQEAgdm9pZCBpbnRlbF9leGVjbGlzdHNfc2hvd19yZXF1ZXN0cyhzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiB7CiAJY29uc3Qgc3RydWN0IGludGVsX2VuZ2lu
ZV9leGVjbGlzdHMgKmV4ZWNsaXN0cyA9ICZlbmdpbmUtPmV4ZWNsaXN0czsKIAlzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycSwgKmxhc3Q7CisJc3RydWN0IGk5MTVfcHJpb2xpc3QgKnBsOwogCXVuc2ln
bmVkIGxvbmcgZmxhZ3M7CiAJdW5zaWduZWQgaW50IGNvdW50OwogCXN0cnVjdCByYl9ub2RlICpy
YjsKQEAgLTM1MzcsMTAgKzM1NDYsOCBAQCB2b2lkIGludGVsX2V4ZWNsaXN0c19zaG93X3JlcXVl
c3RzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAogCWxhc3QgPSBOVUxMOwogCWNv
dW50ID0gMDsKLQlmb3IgKHJiID0gcmJfZmlyc3RfY2FjaGVkKCZlbmdpbmUtPmFjdGl2ZS5xdWV1
ZSk7IHJiOyByYiA9IHJiX25leHQocmIpKSB7Ci0JCXN0cnVjdCBpOTE1X3ByaW9saXN0ICpwID0g
cmJfZW50cnkocmIsIHR5cGVvZigqcCksIG5vZGUpOwotCi0JCXByaW9saXN0X2Zvcl9lYWNoX3Jl
cXVlc3QocnEsIHApIHsKKwlmb3JfZWFjaF9wcmlvbGlzdChwbCwgJmVuZ2luZS0+YWN0aXZlLnF1
ZXVlKSB7CisJCXByaW9saXN0X2Zvcl9lYWNoX3JlcXVlc3QocnEsIHBsKSB7CiAJCQlpZiAoY291
bnQrKyA8IG1heCAtIDEpCiAJCQkJc2hvd19yZXF1ZXN0KG0sIHJxLCAiXHRcdCIsIDApOwogCQkJ
ZWxzZQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1
Ym1pc3Npb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNz
aW9uLmMKaW5kZXggYjljYjY4MDdkMTAxLi4zNGJlOGRjODk0OWUgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYwpAQCAtNTUsMTEgKzU1
LDYgQEAKICAqCiAgKi8KIAotc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9wcmlvbGlzdCAqdG9f
cHJpb2xpc3Qoc3RydWN0IHJiX25vZGUgKnJiKQotewotCXJldHVybiByYl9lbnRyeShyYiwgc3Ry
dWN0IGk5MTVfcHJpb2xpc3QsIG5vZGUpOwotfQotCiBzdGF0aWMgc3RydWN0IGd1Y19zdGFnZV9k
ZXNjICpfX2dldF9zdGFnZV9kZXNjKHN0cnVjdCBpbnRlbF9ndWMgKmd1YywgdTMyIGlkKQogewog
CXN0cnVjdCBndWNfc3RhZ2VfZGVzYyAqYmFzZSA9IGd1Yy0+c3RhZ2VfZGVzY19wb29sX3ZhZGRy
OwpAQCAtMjkyLDggKzI4Nyw4IEBAIHN0YXRpYyB2b2lkIF9fZ3VjX2RlcXVldWUoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCXN0cnVjdCBpOTE1X3JlcXVlc3QgKiogY29uc3QgbGFz
dF9wb3J0ID0gZmlyc3QgKyBleGVjbGlzdHMtPnBvcnRfbWFzazsKIAlzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpsYXN0ID0gZmlyc3RbMF07CiAJc3RydWN0IGk5MTVfcmVxdWVzdCAqKnBvcnQ7CisJc3Ry
dWN0IGk5MTVfcHJpb2xpc3QgKnBsOwogCWJvb2wgc3VibWl0ID0gZmFsc2U7Ci0Jc3RydWN0IHJi
X25vZGUgKnJiOwogCiAJbG9ja2RlcF9hc3NlcnRfaGVsZCgmZW5naW5lLT5hY3RpdmUubG9jayk7
CiAKQEAgLTMxMCwxMSArMzA1LDEwIEBAIHN0YXRpYyB2b2lkIF9fZ3VjX2RlcXVldWUoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCSAqIGV2ZW50LgogCSAqLwogCXBvcnQgPSBmaXJz
dDsKLQl3aGlsZSAoKHJiID0gcmJfZmlyc3RfY2FjaGVkKCZlbmdpbmUtPmFjdGl2ZS5xdWV1ZSkp
KSB7Ci0JCXN0cnVjdCBpOTE1X3ByaW9saXN0ICpwID0gdG9fcHJpb2xpc3QocmIpOworCWZvcl9l
YWNoX3ByaW9saXN0KHBsLCAmZW5naW5lLT5hY3RpdmUucXVldWUpIHsKIAkJc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEsICpybjsKIAotCQlwcmlvbGlzdF9mb3JfZWFjaF9yZXF1ZXN0X2NvbnN1bWUo
cnEsIHJuLCBwKSB7CisJCXByaW9saXN0X2Zvcl9lYWNoX3JlcXVlc3Rfc2FmZShycSwgcm4sIHBs
KSB7CiAJCQlpZiAobGFzdCAmJiBycS0+Y29udGV4dCAhPSBsYXN0LT5jb250ZXh0KSB7CiAJCQkJ
aWYgKHBvcnQgPT0gbGFzdF9wb3J0KQogCQkJCQlnb3RvIGRvbmU7CkBAIC0zMzAsMTIgKzMyNCwx
MSBAQCBzdGF0aWMgdm9pZCBfX2d1Y19kZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKIAkJCWxhc3QgPSBycTsKIAkJfQogCi0JCXJiX2VyYXNlX2NhY2hlZCgmcC0+bm9kZSwg
JmVuZ2luZS0+YWN0aXZlLnF1ZXVlKTsKLQkJaTkxNV9wcmlvbGlzdF9mcmVlKHApOworCQlpOTE1
X3ByaW9saXN0X2FkdmFuY2UoJmVuZ2luZS0+YWN0aXZlLnF1ZXVlLCBwbCk7CiAJfQogZG9uZToK
IAlleGVjbGlzdHMtPnF1ZXVlX3ByaW9yaXR5X2hpbnQgPQotCQlyYiA/IHRvX3ByaW9saXN0KHJi
KS0+cHJpb3JpdHkgOiBJTlRfTUlOOworCQlwbCAhPSAmZW5naW5lLT5hY3RpdmUucXVldWUuc2Vu
dGluZWwgPyBwbC0+cHJpb3JpdHkgOiBJTlRfTUlOOwogCWlmIChzdWJtaXQpIHsKIAkJKnBvcnQg
PSBzY2hlZHVsZV9pbihsYXN0LCBwb3J0IC0gZXhlY2xpc3RzLT5pbmZsaWdodCk7CiAJCSorK3Bv
cnQgPSBOVUxMOwpAQCAtNDUwLDcgKzQ0Myw3IEBAIHN0YXRpYyB2b2lkIGd1Y19yZXNldF9jYW5j
ZWwoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCXN0cnVjdCBpbnRlbF9lbmdp
bmVfZXhlY2xpc3RzICogY29uc3QgZXhlY2xpc3RzID0gJmVuZ2luZS0+ZXhlY2xpc3RzOwogCXN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCAqcm47Ci0Jc3RydWN0IHJiX25vZGUgKnJiOworCXN0cnVj
dCBpOTE1X3ByaW9saXN0ICpwOwogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAKIAlFTkdJTkVfVFJB
Q0UoZW5naW5lLCAiXG4iKTsKQEAgLTQ4MSwyNSArNDc0LDIwIEBAIHN0YXRpYyB2b2lkIGd1Y19y
ZXNldF9jYW5jZWwoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCX0KIAogCS8qIEZs
dXNoIHRoZSBxdWV1ZWQgcmVxdWVzdHMgdG8gdGhlIHRpbWVsaW5lIGxpc3QgKGZvciByZXRpcmlu
ZykuICovCi0Jd2hpbGUgKChyYiA9IHJiX2ZpcnN0X2NhY2hlZCgmZW5naW5lLT5hY3RpdmUucXVl
dWUpKSkgewotCQlzdHJ1Y3QgaTkxNV9wcmlvbGlzdCAqcCA9IHRvX3ByaW9saXN0KHJiKTsKLQot
CQlwcmlvbGlzdF9mb3JfZWFjaF9yZXF1ZXN0X2NvbnN1bWUocnEsIHJuLCBwKSB7CisJZm9yX2Vh
Y2hfcHJpb2xpc3QocCwgJmVuZ2luZS0+YWN0aXZlLnF1ZXVlKSB7CisJCXByaW9saXN0X2Zvcl9l
YWNoX3JlcXVlc3Rfc2FmZShycSwgcm4sIHApIHsKIAkJCWxpc3RfZGVsX2luaXQoJnJxLT5zY2hl
ZC5saW5rKTsKIAkJCV9faTkxNV9yZXF1ZXN0X3N1Ym1pdChycSk7CiAJCQlkbWFfZmVuY2Vfc2V0
X2Vycm9yKCZycS0+ZmVuY2UsIC1FSU8pOwogCQkJaTkxNV9yZXF1ZXN0X21hcmtfY29tcGxldGUo
cnEpOwogCQl9Ci0KLQkJcmJfZXJhc2VfY2FjaGVkKCZwLT5ub2RlLCAmZW5naW5lLT5hY3RpdmUu
cXVldWUpOwotCQlpOTE1X3ByaW9saXN0X2ZyZWUocCk7CisJCWk5MTVfcHJpb2xpc3RfYWR2YW5j
ZSgmZW5naW5lLT5hY3RpdmUucXVldWUsIHApOwogCX0KIAlHRU1fQlVHX09OKCFpOTE1X3NjaGVk
X2lzX2lkbGUoJmVuZ2luZS0+YWN0aXZlKSk7CiAKIAkvKiBSZW1haW5pbmcgX3VucmVhZHlfIHJl
cXVlc3RzIHdpbGwgYmUgbm9wJ2VkIHdoZW4gc3VibWl0dGVkICovCiAKIAlleGVjbGlzdHMtPnF1
ZXVlX3ByaW9yaXR5X2hpbnQgPSBJTlRfTUlOOwotCWVuZ2luZS0+YWN0aXZlLnF1ZXVlID0gUkJf
Uk9PVF9DQUNIRUQ7CiAKIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZlbmdpbmUtPmFjdGl2ZS5s
b2NrLCBmbGFncyk7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3By
aW9saXN0X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ByaW9saXN0X3R5cGVz
LmgKaW5kZXggYmMyZmE4NGY5OGE4Li44MDdjZDhmNjU0ODEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfcHJpb2xpc3RfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3ByaW9saXN0X3R5cGVzLmgKQEAgLTM4LDEwICszOCwzNyBAQCBlbnVtIHsKICNk
ZWZpbmUgSTkxNV9QUklPUklUWV9VTlBSRUVNUFRBQkxFIElOVF9NQVgKICNkZWZpbmUgSTkxNV9Q
UklPUklUWV9CQVJSSUVSIChJOTE1X1BSSU9SSVRZX1VOUFJFRU1QVEFCTEUgLSAxKQogCisjaWZk
ZWYgQ09ORklHXzY0QklUCisjZGVmaW5lIEk5MTVfUFJJT0xJU1RfSEVJR0hUIDEyCisjZWxzZQor
I2RlZmluZSBJOTE1X1BSSU9MSVNUX0hFSUdIVCAxMQorI2VuZGlmCisKIHN0cnVjdCBpOTE1X3By
aW9saXN0IHsKIAlzdHJ1Y3QgbGlzdF9oZWFkIHJlcXVlc3RzOwotCXN0cnVjdCByYl9ub2RlIG5v
ZGU7CiAJaW50IHByaW9yaXR5OworCisJaW50IGxldmVsOworCXN0cnVjdCBpOTE1X3ByaW9saXN0
ICpuZXh0W0k5MTVfUFJJT0xJU1RfSEVJR0hUXTsKK307CisKK3N0cnVjdCBpOTE1X3ByaW9saXN0
X3Jvb3QgeworCXN0cnVjdCBpOTE1X3ByaW9saXN0IHNlbnRpbmVsOworCXUzMiBwcm5nOwogfTsK
IAorI2RlZmluZSBwcmlvbGlzdF9maXJzdChyb290KSAoKHJvb3QpLT5zZW50aW5lbC5uZXh0WzBd
KQorI2RlZmluZSBpOTE1X3ByaW9saXN0X2lzX2VtcHR5KHJvb3QpIChwcmlvbGlzdF9maXJzdChy
b290KSA9PSAmKHJvb3QpLT5zZW50aW5lbCkKKworI2RlZmluZSBmb3JfZWFjaF9wcmlvbGlzdChw
LCByb290KSBcCisJZm9yICgocCkgPSBwcmlvbGlzdF9maXJzdChyb290KTsgXAorCSAgICAgKHAp
ICE9ICYocm9vdCktPnNlbnRpbmVsOyBcCisJICAgICAocCkgPSAocCktPm5leHRbMF0pCisKKyNk
ZWZpbmUgcHJpb2xpc3RfZm9yX2VhY2hfcmVxdWVzdChpdCwgcGxpc3QpIFwKKwlsaXN0X2Zvcl9l
YWNoX2VudHJ5KGl0LCAmKHBsaXN0KS0+cmVxdWVzdHMsIHNjaGVkLmxpbmspCisKKyNkZWZpbmUg
cHJpb2xpc3RfZm9yX2VhY2hfcmVxdWVzdF9zYWZlKGl0LCBuLCBwbGlzdCkgXAorCWxpc3RfZm9y
X2VhY2hfZW50cnlfc2FmZShpdCwgbiwgJihwbGlzdCktPnJlcXVlc3RzLCBzY2hlZC5saW5rKQor
CiAjZW5kaWYgLyogX0k5MTVfUFJJT0xJU1RfVFlQRVNfSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfc2NoZWR1bGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3NjaGVkdWxlci5jCmluZGV4IGY5OWQ3NTdkNGQ1Yy4uZmE2MjYyZjkyYWZkIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3NjaGVkdWxlci5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfc2NoZWR1bGVyLmMKQEAgLTQsNyArNCw5IEBACiAgKiBDb3B5cmln
aHQgwqkgMjAxOCBJbnRlbCBDb3Jwb3JhdGlvbgogICovCiAKKyNpbmNsdWRlIDxsaW51eC9iaXRv
cHMuaD4KICNpbmNsdWRlIDxsaW51eC9tdXRleC5oPgorI2luY2x1ZGUgPGxpbnV4L3ByYW5kb20u
aD4KIAogI2luY2x1ZGUgImd0L2ludGVsX3JpbmcuaCIKICNpbmNsdWRlICJndC9pbnRlbF9scmNf
cmVnLmgiCkBAIC05MSwxNSArOTMsMjMgQEAgc3RhdGljIHZvaWQgaTkxNV9zY2hlZF9pbml0X2lw
aShzdHJ1Y3QgaTkxNV9zY2hlZF9pcGkgKmlwaSkKIAlpcGktPmxpc3QgPSBOVUxMOwogfQogCitz
dGF0aWMgdm9pZCBpbml0X3ByaW9saXN0KHN0cnVjdCBpOTE1X3ByaW9saXN0X3Jvb3QgKmNvbnN0
IHJvb3QpCit7CisJc3RydWN0IGk5MTVfcHJpb2xpc3QgKnBsID0gJnJvb3QtPnNlbnRpbmVsOwor
CisJbWVtc2V0X3AoKHZvaWQgKiopcGwtPm5leHQsIHBsLCBBUlJBWV9TSVpFKHBsLT5uZXh0KSk7
CisJcGwtPnByaW9yaXR5ID0gSU5UX01JTjsKK30KKwogdm9pZCBpOTE1X3NjaGVkX2luaXRfZW5n
aW5lKHN0cnVjdCBpOTE1X3NjaGVkX2VuZ2luZSAqc2UsCiAJCQkgICAgdW5zaWduZWQgaW50IHN1
YmNsYXNzKQogewogCXNwaW5fbG9ja19pbml0KCZzZS0+bG9jayk7CiAJbG9ja2RlcF9zZXRfc3Vi
Y2xhc3MoJnNlLT5sb2NrLCBzdWJjbGFzcyk7CiAKKwlpbml0X3ByaW9saXN0KCZzZS0+cXVldWUp
OwogCUlOSVRfTElTVF9IRUFEKCZzZS0+cmVxdWVzdHMpOwogCUlOSVRfTElTVF9IRUFEKCZzZS0+
aG9sZCk7Ci0Jc2UtPnF1ZXVlID0gUkJfUk9PVF9DQUNIRUQ7CiAKIAlpOTE1X3NjaGVkX2luaXRf
aXBpKCZzZS0+aXBpKTsKIApAQCAtMTE2LDggKzEyNiw1NyBAQCB2b2lkIGk5MTVfc2NoZWRfaW5p
dF9lbmdpbmUoc3RydWN0IGk5MTVfc2NoZWRfZW5naW5lICpzZSwKICNlbmRpZgogfQogCitfX21h
eWJlX3VudXNlZCBzdGF0aWMgYm9vbCBwcmlvbGlzdF9pZGxlKHN0cnVjdCBpOTE1X3ByaW9saXN0
X3Jvb3QgKnJvb3QpCit7CisJc3RydWN0IGk5MTVfcHJpb2xpc3QgKnBsID0gJnJvb3QtPnNlbnRp
bmVsOworCWludCBsdmw7CisKKwlmb3IgKGx2bCA9IDA7IGx2bCA8IEFSUkFZX1NJWkUocGwtPm5l
eHQpOyBsdmwrKykgeworCQlpZiAocGwtPm5leHRbbHZsXSAhPSBwbCkgeworCQkJR0VNX1RSQUNF
X0VSUigicm9vdFslZF0gaXMgbm90IGVtcHR5XG4iLCBsdmwpOworCQkJcmV0dXJuIGZhbHNlOwor
CQl9CisJfQorCisJaWYgKHBsLT5sZXZlbCkgeworCQlHRU1fVFJBQ0VfRVJSKCJyb290IGlzIG5v
dCBjbGVhcjogJWRcbiIsIHBsLT5sZXZlbCk7CisJCXJldHVybiBmYWxzZTsKKwl9CisKKwlyZXR1
cm4gdHJ1ZTsKK30KKworc3RhdGljIHZvaWQgcGxfcHVzaChzdHJ1Y3QgaTkxNV9wcmlvbGlzdCAq
cGwsIHN0cnVjdCBsaXN0X2hlYWQgKmhlYWQpCit7CisJcGwtPnJlcXVlc3RzLm5leHQgPSBoZWFk
LT5uZXh0OworCWhlYWQtPm5leHQgPSAmcGwtPnJlcXVlc3RzOworfQorCitzdGF0aWMgc3RydWN0
IGk5MTVfcHJpb2xpc3QgKnBsX3BvcChzdHJ1Y3QgbGlzdF9oZWFkICpoZWFkKQoreworCXN0cnVj
dCBpOTE1X3ByaW9saXN0ICpwbDsKKworCXBsID0gY29udGFpbmVyX29mKGhlYWQtPm5leHQsIHR5
cGVvZigqcGwpLCByZXF1ZXN0cyk7CisJaGVhZC0+bmV4dCA9IHBsLT5yZXF1ZXN0cy5uZXh0Owor
CisJcmV0dXJuIHBsOworfQorCitzdGF0aWMgYm9vbCBwbF9lbXB0eShzdHJ1Y3QgbGlzdF9oZWFk
ICpoZWFkKQoreworCXJldHVybiAhaGVhZC0+bmV4dDsKK30KKwogdm9pZCBpOTE1X3NjaGVkX3Bh
cmtfZW5naW5lKHN0cnVjdCBpOTE1X3NjaGVkX2VuZ2luZSAqc2UpCiB7CisJc3RydWN0IGk5MTVf
cHJpb2xpc3Rfcm9vdCAqcm9vdCA9ICZzZS0+cXVldWU7CisJc3RydWN0IGxpc3RfaGVhZCAqbGlz
dCA9ICZyb290LT5zZW50aW5lbC5yZXF1ZXN0czsKKworCUdFTV9CVUdfT04oIXByaW9saXN0X2lk
bGUocm9vdCkpOworCisJd2hpbGUgKCFwbF9lbXB0eShsaXN0KSkKKwkJa21lbV9jYWNoZV9mcmVl
KGdsb2JhbC5zbGFiX3ByaW9yaXRpZXMsIHBsX3BvcChsaXN0KSk7CisKIAlHRU1fQlVHX09OKCFp
OTE1X3NjaGVkX2lzX2lkbGUoc2UpKTsKIAlzZS0+bm9fcHJpb2xpc3QgPSBmYWxzZTsKIH0KQEAg
LTE4Myw3MSArMjQyLDU1IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBub2RlX3NpZ25hbGVkKGNvbnN0
IHN0cnVjdCBpOTE1X3NjaGVkX25vZGUgKm5vZGUpCiAJcmV0dXJuIGk5MTVfcmVxdWVzdF9jb21w
bGV0ZWQobm9kZV90b19yZXF1ZXN0KG5vZGUpKTsKIH0KIAotc3RhdGljIGlubGluZSBzdHJ1Y3Qg
aTkxNV9wcmlvbGlzdCAqdG9fcHJpb2xpc3Qoc3RydWN0IHJiX25vZGUgKnJiKQotewotCXJldHVy
biByYl9lbnRyeShyYiwgc3RydWN0IGk5MTVfcHJpb2xpc3QsIG5vZGUpOwotfQotCi1zdGF0aWMg
dm9pZCBhc3NlcnRfcHJpb2xpc3RzKHN0cnVjdCBpOTE1X3NjaGVkX2VuZ2luZSAqIGNvbnN0IHNl
KQorc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQgcmFuZG9tX2xldmVsKHN0cnVjdCBpOTE1X3By
aW9saXN0X3Jvb3QgKnJvb3QpCiB7Ci0Jc3RydWN0IHJiX25vZGUgKnJiOwotCWxvbmcgbGFzdF9w
cmlvOwotCi0JaWYgKCFJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0pKQotCQly
ZXR1cm47Ci0KLQlHRU1fQlVHX09OKHJiX2ZpcnN0X2NhY2hlZCgmc2UtPnF1ZXVlKSAhPQotCQkg
ICByYl9maXJzdCgmc2UtPnF1ZXVlLnJiX3Jvb3QpKTsKLQotCWxhc3RfcHJpbyA9IElOVF9NQVg7
Ci0JZm9yIChyYiA9IHJiX2ZpcnN0X2NhY2hlZCgmc2UtPnF1ZXVlKTsgcmI7IHJiID0gcmJfbmV4
dChyYikpIHsKLQkJY29uc3Qgc3RydWN0IGk5MTVfcHJpb2xpc3QgKnAgPSB0b19wcmlvbGlzdChy
Yik7Ci0KLQkJR0VNX0JVR19PTihwLT5wcmlvcml0eSA+IGxhc3RfcHJpbyk7Ci0JCWxhc3RfcHJp
byA9IHAtPnByaW9yaXR5OwotCX0KKwlyb290LT5wcm5nID0gbmV4dF9wc2V1ZG9fcmFuZG9tMzIo
cm9vdC0+cHJuZyk7CisJcmV0dXJuIG1pbl90KGludCwgX19mZnMocm9vdC0+cHJuZykgLyAyLCBJ
OTE1X1BSSU9MSVNUX0hFSUdIVCAtIDEpOwogfQogCiBzdGF0aWMgc3RydWN0IGxpc3RfaGVhZCAq
CiBsb29rdXBfcHJpb2xpc3Qoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBpbnQgcHJp
bykKIHsKKwlzdHJ1Y3QgaTkxNV9wcmlvbGlzdCAqdXBkYXRlW0k5MTVfUFJJT0xJU1RfSEVJR0hU
XTsKIAlzdHJ1Y3QgaTkxNV9zY2hlZF9lbmdpbmUgKiBjb25zdCBzZSA9ICZlbmdpbmUtPmFjdGl2
ZTsKLQlzdHJ1Y3QgaTkxNV9wcmlvbGlzdCAqcDsKLQlzdHJ1Y3QgcmJfbm9kZSAqKnBhcmVudCwg
KnJiOwotCWJvb2wgZmlyc3QgPSB0cnVlOwotCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZW5naW5l
LT5hY3RpdmUubG9jayk7Ci0JYXNzZXJ0X3ByaW9saXN0cyhzZSk7CisJc3RydWN0IGk5MTVfcHJp
b2xpc3Rfcm9vdCAqcm9vdCA9ICZzZS0+cXVldWU7CisJc3RydWN0IGk5MTVfcHJpb2xpc3QgKnBs
LCAqdG1wOworCWludCBsdmw7CiAKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZzZS0+bG9jayk7CiAJ
aWYgKHVubGlrZWx5KHNlLT5ub19wcmlvbGlzdCkpCiAJCXByaW8gPSBJOTE1X1BSSU9SSVRZX05P
Uk1BTDsKIAotZmluZF9wcmlvbGlzdDoKLQkvKiBtb3N0IHBvc2l0aXZlIHByaW9yaXR5IGlzIHNj
aGVkdWxlZCBmaXJzdCwgZXF1YWwgcHJpb3JpdGllcyBmaWZvICovCi0JcmIgPSBOVUxMOwotCXBh
cmVudCA9ICZzZS0+cXVldWUucmJfcm9vdC5yYl9ub2RlOwotCXdoaWxlICgqcGFyZW50KSB7Ci0J
CXJiID0gKnBhcmVudDsKLQkJcCA9IHRvX3ByaW9saXN0KHJiKTsKLQkJaWYgKHByaW8gPiBwLT5w
cmlvcml0eSkgewotCQkJcGFyZW50ID0gJnJiLT5yYl9sZWZ0OwotCQl9IGVsc2UgaWYgKHByaW8g
PCBwLT5wcmlvcml0eSkgewotCQkJcGFyZW50ID0gJnJiLT5yYl9yaWdodDsKLQkJCWZpcnN0ID0g
ZmFsc2U7Ci0JCX0gZWxzZSB7Ci0JCQlyZXR1cm4gJnAtPnJlcXVlc3RzOwotCQl9CisJZm9yX2Vh
Y2hfcHJpb2xpc3QocGwsIHJvb3QpIHsgLyogcmVjeWNsZSBhbnkgZW1wdHkgZWxlbWVudHMgYmVm
b3JlIHVzICovCisJCWlmIChwbC0+cHJpb3JpdHkgPj0gcHJpbyB8fCAhbGlzdF9lbXB0eSgmcGwt
PnJlcXVlc3RzKSkKKwkJCWJyZWFrOworCisJCWk5MTVfcHJpb2xpc3RfYWR2YW5jZShyb290LCBw
bCk7CiAJfQogCitmaW5kX3ByaW9saXN0OgorCXBsID0gJnJvb3QtPnNlbnRpbmVsOworCWx2bCA9
IHBsLT5sZXZlbDsKKwlkbyB7CisJCXdoaWxlICh0bXAgPSBwbC0+bmV4dFtsdmxdLCB0bXAtPnBy
aW9yaXR5ID49IHByaW8pCisJCQlwbCA9IHRtcDsKKwkJaWYgKHBsLT5wcmlvcml0eSA9PSBwcmlv
KQorCQkJZ290byBvdXQ7CisJCXVwZGF0ZVtsdmxdID0gcGw7CisJfSB3aGlsZSAoLS1sdmwgPj0g
MCk7CisKIAlpZiAocHJpbyA9PSBJOTE1X1BSSU9SSVRZX05PUk1BTCkgewotCQlwID0gJnNlLT5k
ZWZhdWx0X3ByaW9saXN0OworCQlwbCA9ICZzZS0+ZGVmYXVsdF9wcmlvbGlzdDsKKwl9IGVsc2Ug
aWYgKCFwbF9lbXB0eSgmcm9vdC0+c2VudGluZWwucmVxdWVzdHMpKSB7CisJCXBsID0gcGxfcG9w
KCZyb290LT5zZW50aW5lbC5yZXF1ZXN0cyk7CiAJfSBlbHNlIHsKLQkJcCA9IGttZW1fY2FjaGVf
YWxsb2MoZ2xvYmFsLnNsYWJfcHJpb3JpdGllcywgR0ZQX0FUT01JQyk7CisJCXBsID0ga21lbV9j
YWNoZV9hbGxvYyhnbG9iYWwuc2xhYl9wcmlvcml0aWVzLCBHRlBfQVRPTUlDKTsKIAkJLyogQ29u
dmVydCBhbiBhbGxvY2F0aW9uIGZhaWx1cmUgdG8gYSBwcmlvcml0eSBidW1wICovCi0JCWlmICh1
bmxpa2VseSghcCkpIHsKKwkJaWYgKHVubGlrZWx5KCFwbCkpIHsKIAkJCXByaW8gPSBJOTE1X1BS
SU9SSVRZX05PUk1BTDsgLyogcmVjdXJzZXMganVzdCBvbmNlICovCiAKLQkJCS8qIFRvIG1haW50
YWluIG9yZGVyaW5nIHdpdGggYWxsIHJlbmRlcmluZywgYWZ0ZXIgYW4KKwkJCS8qCisJCQkgKiBU
byBtYWludGFpbiBvcmRlcmluZyB3aXRoIGFsbCByZW5kZXJpbmcsIGFmdGVyIGFuCiAJCQkgKiBh
bGxvY2F0aW9uIGZhaWx1cmUgd2UgaGF2ZSB0byBkaXNhYmxlIGFsbCBzY2hlZHVsaW5nLgogCQkJ
ICogUmVxdWVzdHMgd2lsbCB0aGVuIGJlIGV4ZWN1dGVkIGluIGZpZm8sIGFuZCBzY2hlZHVsZQog
CQkJICogd2lsbCBlbnN1cmUgdGhhdCBkZXBlbmRlbmNpZXMgYXJlIGVtaXR0ZWQgaW4gZmlmby4K
QEAgLTI2MCwxOCArMzAzLDkxIEBAIGxvb2t1cF9wcmlvbGlzdChzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsIGludCBwcmlvKQogCQl9CiAJfQogCi0JcC0+cHJpb3JpdHkgPSBwcmlvOwot
CUlOSVRfTElTVF9IRUFEKCZwLT5yZXF1ZXN0cyk7CisJcGwtPnByaW9yaXR5ID0gcHJpbzsKKwlJ
TklUX0xJU1RfSEVBRCgmcGwtPnJlcXVlc3RzKTsKKworCWx2bCA9IHJhbmRvbV9sZXZlbChyb290
KTsKKwlpZiAobHZsID4gcm9vdC0+c2VudGluZWwubGV2ZWwpIHsKKwkJbHZsID0gKytyb290LT5z
ZW50aW5lbC5sZXZlbDsKKwkJdXBkYXRlW2x2bF0gPSAmcm9vdC0+c2VudGluZWw7CisJfQorCisJ
cGwtPmxldmVsID0gbHZsOworCWRvIHsKKwkJdG1wID0gdXBkYXRlW2x2bF07CisJCXBsLT5uZXh0
W2x2bF0gPSB1cGRhdGVbbHZsXS0+bmV4dFtsdmxdOworCQl0bXAtPm5leHRbbHZsXSA9IHBsOwor
CX0gd2hpbGUgKC0tbHZsID49IDApOworCisJaWYgKElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1
X0RFQlVHX0dFTSkpIHsKKwkJc3RydWN0IGk5MTVfcHJpb2xpc3QgKmNoazsKKworCQljaGsgPSAm
cm9vdC0+c2VudGluZWw7CisJCWx2bCA9IGNoay0+bGV2ZWw7CisJCWRvIHsKKwkJCXdoaWxlICh0
bXAgPSBjaGstPm5leHRbbHZsXSwgdG1wLT5wcmlvcml0eSA+PSBwcmlvKQorCQkJCWNoayA9IHRt
cDsKKwkJfSB3aGlsZSAoLS1sdmwgPj0gMCk7CisKKwkJR0VNX0JVR19PTihjaGsgIT0gcGwpOwor
CX0KIAotCXJiX2xpbmtfbm9kZSgmcC0+bm9kZSwgcmIsIHBhcmVudCk7Ci0JcmJfaW5zZXJ0X2Nv
bG9yX2NhY2hlZCgmcC0+bm9kZSwgJnNlLT5xdWV1ZSwgZmlyc3QpOworb3V0OgorCUdFTV9CVUdf
T04ocGwgPT0gJnJvb3QtPnNlbnRpbmVsKTsKKwlyZXR1cm4gJnBsLT5yZXF1ZXN0czsKK30KIAot
CXJldHVybiAmcC0+cmVxdWVzdHM7CitzdGF0aWMgdm9pZCByZW1vdmVfcHJpb2xpc3Qoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkJICAgIHN0cnVjdCBsaXN0X2hlYWQgKnBsaXN0
KQoreworCXN0cnVjdCBpOTE1X3NjaGVkX2VuZ2luZSAqIGNvbnN0IHNlID0gJmVuZ2luZS0+YWN0
aXZlOworCXN0cnVjdCBpOTE1X3ByaW9saXN0X3Jvb3QgKnJvb3QgPSAmc2UtPnF1ZXVlOworCXN0
cnVjdCBpOTE1X3ByaW9saXN0ICpwbCwgKnRtcDsKKwlzdHJ1Y3QgaTkxNV9wcmlvbGlzdCAqb2xk
ID0KKwkJY29udGFpbmVyX29mKHBsaXN0LCBzdHJ1Y3QgaTkxNV9wcmlvbGlzdCwgcmVxdWVzdHMp
OworCWludCBwcmlvID0gb2xkLT5wcmlvcml0eTsKKwlpbnQgbHZsOworCisJbG9ja2RlcF9hc3Nl
cnRfaGVsZCgmc2UtPmxvY2spOworCUdFTV9CVUdfT04oIWxpc3RfZW1wdHkocGxpc3QpKTsKKwor
CXBsX3B1c2gob2xkLCAmcm9vdC0+c2VudGluZWwucmVxdWVzdHMpOworCisJcGwgPSAmcm9vdC0+
c2VudGluZWw7CisJbHZsID0gcGwtPmxldmVsOworCWRvIHsKKwkJd2hpbGUgKHRtcCA9IHBsLT5u
ZXh0W2x2bF0sIHRtcC0+cHJpb3JpdHkgPiBwcmlvKQorCQkJcGwgPSB0bXA7CisJCWlmIChsdmwg
PD0gb2xkLT5sZXZlbCkgeworCQkJcGwtPm5leHRbbHZsXSA9IG9sZC0+bmV4dFtsdmxdOworCQkJ
aWYgKHBsID09ICZyb290LT5zZW50aW5lbCAmJiBvbGQtPm5leHRbbHZsXSA9PSBwbCkKKwkJCQlw
bC0+bGV2ZWwtLTsKKwkJfQorCX0gd2hpbGUgKC0tbHZsID49IDApOworCUdFTV9CVUdfT04oJnRt
cC0+cmVxdWVzdHMgIT0gcGxpc3QpOwogfQogCi12b2lkIF9faTkxNV9wcmlvbGlzdF9mcmVlKHN0
cnVjdCBpOTE1X3ByaW9saXN0ICpwKQordm9pZCBpOTE1X3ByaW9saXN0X2FkdmFuY2Uoc3RydWN0
IGk5MTVfcHJpb2xpc3Rfcm9vdCAqcm9vdCwKKwkJCSAgIHN0cnVjdCBpOTE1X3ByaW9saXN0ICpw
bCkKIHsKLQlrbWVtX2NhY2hlX2ZyZWUoZ2xvYmFsLnNsYWJfcHJpb3JpdGllcywgcCk7CisJaW50
IGx2bDsKKworCUdFTV9CVUdfT04oIWxpc3RfZW1wdHkoJnBsLT5yZXF1ZXN0cykpOworCUdFTV9C
VUdfT04ocGwgPT0gJnJvb3QtPnNlbnRpbmVsKTsKKworCWlmIChwbC0+cHJpb3JpdHkgIT0gSTkx
NV9QUklPUklUWV9OT1JNQUwpCisJCXBsX3B1c2gocGwsICZyb290LT5zZW50aW5lbC5yZXF1ZXN0
cyk7CisKKwlmb3IgKGx2bCA9IDA7IGx2bCA8PSBwbC0+bGV2ZWw7IGx2bCsrKQorCQlyb290LT5z
ZW50aW5lbC5uZXh0W2x2bF0gPSBwbC0+bmV4dFtsdmxdOworCisJaWYgKHBsLT5sZXZlbCA+IDAg
JiYgcGwtPmxldmVsID09IHJvb3QtPnNlbnRpbmVsLmxldmVsKSB7CisJCXBsID0gJnJvb3QtPnNl
bnRpbmVsOworCQlsdmwgPSBwbC0+bGV2ZWw7CisJCXdoaWxlIChsdmwgPiAwICYmIHBsLT5uZXh0
W2x2bF0gPT0gcGwpCisJCQlsdmwtLTsKKwkJcGwtPmxldmVsID0gbHZsOworCX0KIH0KIAogc3Rh
dGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgpAQCAtNDIwLDggKzUzNiwxMyBAQCBzdGF0aWMgdm9p
ZCBfX2k5MTVfcmVxdWVzdF9zZXRfcHJpb3JpdHkoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsIGlu
dCBwcmlvKQogCQkJY29udGludWU7CiAKIAkJR0VNX0JVR19PTihycS0+ZW5naW5lICE9IGVuZ2lu
ZSk7Ci0JCWlmIChpOTE1X3JlcXVlc3RfaW5fcHJpb3JpdHlfcXVldWUocnEpKQorCQlpZiAoaTkx
NV9yZXF1ZXN0X2luX3ByaW9yaXR5X3F1ZXVlKHJxKSkgeworCQkJc3RydWN0IGxpc3RfaGVhZCAq
cHJldiA9IHJxLT5zY2hlZC5saW5rLnByZXY7CisKIAkJCWxpc3RfbW92ZV90YWlsKCZycS0+c2No
ZWQubGluaywgcGxpc3QpOworCQkJaWYgKGxpc3RfZW1wdHkocHJldikpCisJCQkJcmVtb3ZlX3By
aW9saXN0KGVuZ2luZSwgcHJldik7CisJCX0KIAogCQkvKiBEZWZlciAodGFza2xldCkgc3VibWlz
c2lvbiB1bnRpbCBhZnRlciBhbGwgdXBkYXRlcy4gKi8KIAkJa2lja19zdWJtaXNzaW9uKGVuZ2lu
ZSwgcnEsIHByaW8pOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hl
ZHVsZXIuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc2NoZWR1bGVyLmgKaW5kZXggYTY4
NzQ3ZDY4MmQyLi40NDMyYWFiMjMwYjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfc2NoZWR1bGVyLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVs
ZXIuaApAQCAtMTYsMTIgKzE2LDYgQEAKIAogc3RydWN0IGRybV9wcmludGVyOwogCi0jZGVmaW5l
IHByaW9saXN0X2Zvcl9lYWNoX3JlcXVlc3QoaXQsIHBsaXN0KSBcCi0JbGlzdF9mb3JfZWFjaF9l
bnRyeShpdCwgJihwbGlzdCktPnJlcXVlc3RzLCBzY2hlZC5saW5rKQotCi0jZGVmaW5lIHByaW9s
aXN0X2Zvcl9lYWNoX3JlcXVlc3RfY29uc3VtZShpdCwgbiwgcGxpc3QpIFwKLQlsaXN0X2Zvcl9l
YWNoX2VudHJ5X3NhZmUoaXQsIG4sICYocGxpc3QpLT5yZXF1ZXN0cywgc2NoZWQubGluaykKLQog
dm9pZCBpOTE1X3NjaGVkX25vZGVfaW5pdChzdHJ1Y3QgaTkxNV9zY2hlZF9ub2RlICpub2RlKTsK
IHZvaWQgaTkxNV9zY2hlZF9ub2RlX3JlaW5pdChzdHJ1Y3QgaTkxNV9zY2hlZF9ub2RlICpub2Rl
KTsKIApAQCAtNjQsNyArNTgsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV9wcmlvbGlzdF9m
cmVlKHN0cnVjdCBpOTE1X3ByaW9saXN0ICpwKQogCiBzdGF0aWMgaW5saW5lIGJvb2wgaTkxNV9z
Y2hlZF9pc19pZGxlKGNvbnN0IHN0cnVjdCBpOTE1X3NjaGVkX2VuZ2luZSAqc2UpCiB7Ci0JcmV0
dXJuIFJCX0VNUFRZX1JPT1QoJnNlLT5xdWV1ZS5yYl9yb290KTsKKwlyZXR1cm4gaTkxNV9wcmlv
bGlzdF9pc19lbXB0eSgmc2UtPnF1ZXVlKTsKIH0KIAogc3RhdGljIGlubGluZSBib29sCkBAIC05
NCw2ICs4OCw5IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpOTE1X3NjaGVkX2tpY2soc3RydWN0IGk5
MTVfc2NoZWRfZW5naW5lICpzZSkKIAl0YXNrbGV0X2hpX3NjaGVkdWxlKCZzZS0+dGFza2xldCk7
CiB9CiAKK3ZvaWQgaTkxNV9wcmlvbGlzdF9hZHZhbmNlKHN0cnVjdCBpOTE1X3ByaW9saXN0X3Jv
b3QgKnJvb3QsCisJCQkgICBzdHJ1Y3QgaTkxNV9wcmlvbGlzdCAqb2xkKTsKKwogdm9pZCBpOTE1
X3JlcXVlc3Rfc2hvd193aXRoX3NjaGVkdWxlKHN0cnVjdCBkcm1fcHJpbnRlciAqbSwKIAkJCQkg
ICAgIGNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCQkJCSAgICAgY29uc3QgY2hhciAq
cHJlZml4LApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVsZXJf
dHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc2NoZWR1bGVyX3R5cGVzLmgKaW5k
ZXggOTIzMzJmYjcxYjE0Li5jMTU1ZTRmYWEzMGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfc2NoZWR1bGVyX3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9zY2hlZHVsZXJfdHlwZXMuaApAQCAtODksNyArODksNyBAQCBzdHJ1Y3QgaTkxNV9zY2hl
ZF9lbmdpbmUgewogCS8qKgogCSAqIEBxdWV1ZTogcXVldWUgb2YgcmVxdWVzdHMsIGluIHByaW9y
aXR5IGxpc3RzCiAJICovCi0Jc3RydWN0IHJiX3Jvb3RfY2FjaGVkIHF1ZXVlOworCXN0cnVjdCBp
OTE1X3ByaW9saXN0X3Jvb3QgcXVldWU7CiAKIAlzdHJ1Y3QgaTkxNV9zY2hlZF9pcGkgaXBpOwog
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9tb2NrX3Nl
bGZ0ZXN0cy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfbW9ja19zZWxm
dGVzdHMuaAppbmRleCAzZGIzNGQzZWVhNTguLjk0NmM5MzQ0MWMxZiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfbW9ja19zZWxmdGVzdHMuaAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9tb2NrX3NlbGZ0ZXN0cy5oCkBAIC0y
NSw2ICsyNSw3IEBAIHNlbGZ0ZXN0KHJpbmcsIGludGVsX3JpbmdfbW9ja19zZWxmdGVzdHMpCiBz
ZWxmdGVzdChlbmdpbmUsIGludGVsX2VuZ2luZV9jc19tb2NrX3NlbGZ0ZXN0cykKIHNlbGZ0ZXN0
KHRpbWVsaW5lcywgaW50ZWxfdGltZWxpbmVfbW9ja19zZWxmdGVzdHMpCiBzZWxmdGVzdChyZXF1
ZXN0cywgaTkxNV9yZXF1ZXN0X21vY2tfc2VsZnRlc3RzKQorc2VsZnRlc3Qoc2NoZWR1bGVyLCBp
OTE1X3NjaGVkdWxlcl9tb2NrX3NlbGZ0ZXN0cykKIHNlbGZ0ZXN0KG9iamVjdHMsIGk5MTVfZ2Vt
X29iamVjdF9tb2NrX3NlbGZ0ZXN0cykKIHNlbGZ0ZXN0KHBoeXMsIGk5MTVfZ2VtX3BoeXNfbW9j
a19zZWxmdGVzdHMpCiBzZWxmdGVzdChkbWFidWYsIGk5MTVfZ2VtX2RtYWJ1Zl9tb2NrX3NlbGZ0
ZXN0cykKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3Nj
aGVkdWxlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfc2NoZWR1bGVy
LmMKaW5kZXggNWIxZGQyMjdlMjRlLi5hODUxYTE1NmQ0NjAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3NjaGVkdWxlci5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3NjaGVkdWxlci5jCkBAIC0xMiw2ICsxMiw0MyBAQAog
I2luY2x1ZGUgInNlbGZ0ZXN0cy9pZ3Rfc3Bpbm5lci5oIgogI2luY2x1ZGUgInNlbGZ0ZXN0cy9p
OTE1X3JhbmRvbS5oIgogCitzdGF0aWMgaW50IG1vY2tfc2tpcGxpc3RfbGV2ZWxzKHZvaWQgKmR1
bW15KQoreworCXN0cnVjdCBpOTE1X3ByaW9saXN0X3Jvb3Qgcm9vdCA9IHt9OworCXN0cnVjdCBp
OTE1X3ByaW9saXN0ICpwbCA9ICZyb290LnNlbnRpbmVsOworCWludCBjb3VudCwgbHZsOworCisJ
Zm9yIChjb3VudCA9IDA7IGNvdW50IDwgMTYzODQ7IGNvdW50KyspIHsKKwkJbHZsID0gcmFuZG9t
X2xldmVsKCZyb290KTsKKwkJaWYgKGx2bCA+IHBsLT5sZXZlbCkKKwkJCWx2bCA9ICsrcGwtPmxl
dmVsOworCisJCXBsLT5uZXh0W2x2bF0gPSBwdHJfaW5jKHBsLT5uZXh0W2x2bF0pOworCX0KKwor
CWZvciAobHZsID0gMDsgbHZsIDw9IHBsLT5sZXZlbDsgbHZsKyspIHsKKwkJaW50IHggPSBpbG9n
MigodW5zaWduZWQgbG9uZylwbC0+bmV4dFtsdmxdKTsKKwkJY2hhciByb3dbODBdOworCisJCW1l
bXNldChyb3csICcqJywgeCk7CisJCXJvd1t4XSA9ICdcMCc7CisKKwkJcHJfaW5mbygiWyUyZF0g
JTVsdSAlc1xuIiwKKwkJCWx2bCwgKHVuc2lnbmVkIGxvbmcpcGwtPm5leHRbbHZsXSwgcm93KTsK
Kwl9CisKKwlyZXR1cm4gMDsKK30KKworaW50IGk5MTVfc2NoZWR1bGVyX21vY2tfc2VsZnRlc3Rz
KHZvaWQpCit7CisJc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsK
KwkJU1VCVEVTVChtb2NrX3NraXBsaXN0X2xldmVscyksCisJfTsKKworCXJldHVybiBpOTE1X3N1
YnRlc3RzKHRlc3RzLCBOVUxMKTsKK30KKwogc3RhdGljIHZvaWQgc2NoZWR1bGluZ19kaXNhYmxl
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAllbmdpbmUtPnByb3BzLnByZWVt
cHRfdGltZW91dF9tcyA9IDA7CkBAIC04MCw5ICsxMTcsOSBAQCBzdGF0aWMgaW50IGFsbF9lbmdp
bmVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogc3RhdGljIGJvb2wgY2hlY2tfY29u
dGV4dF9vcmRlcihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJdTY0IGxhc3Rf
c2Vxbm8sIGxhc3RfY29udGV4dDsKKwlzdHJ1Y3QgaTkxNV9wcmlvbGlzdCAqcDsKIAl1bnNpZ25l
ZCBsb25nIGNvdW50OwogCWJvb2wgcmVzdWx0ID0gZmFsc2U7Ci0Jc3RydWN0IHJiX25vZGUgKnJi
OwogCWludCBsYXN0X3ByaW87CiAKIAkvKiBXZSBleHBlY3QgdGhlIGV4ZWN1dGlvbiBvcmRlciB0
byBmb2xsb3cgYXNjZW5kaW5nIGZlbmNlLWNvbnRleHQgKi8KQEAgLTkyLDggKzEyOSw3IEBAIHN0
YXRpYyBib29sIGNoZWNrX2NvbnRleHRfb3JkZXIoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKQogCWxhc3RfY29udGV4dCA9IDA7CiAJbGFzdF9zZXFubyA9IDA7CiAJbGFzdF9wcmlvID0g
MDsKLQlmb3IgKHJiID0gcmJfZmlyc3RfY2FjaGVkKCZlbmdpbmUtPmFjdGl2ZS5xdWV1ZSk7IHJi
OyByYiA9IHJiX25leHQocmIpKSB7Ci0JCXN0cnVjdCBpOTE1X3ByaW9saXN0ICpwID0gcmJfZW50
cnkocmIsIHR5cGVvZigqcCksIG5vZGUpOworCWZvcl9lYWNoX3ByaW9saXN0KHAsICZlbmdpbmUt
PmFjdGl2ZS5xdWV1ZSkgewogCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKIAogCQlwcmlvbGlz
dF9mb3JfZWFjaF9yZXF1ZXN0KHJxLCBwKSB7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50
ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

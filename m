Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6EE3749AEB
	for <lists+intel-gfx@lfdr.de>; Tue, 18 Jun 2019 09:43:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EDE356E115;
	Tue, 18 Jun 2019 07:43:11 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8AE586E115
 for <intel-gfx@lists.freedesktop.org>; Tue, 18 Jun 2019 07:43:05 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16935662-1500050 
 for multiple; Tue, 18 Jun 2019 08:42:39 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 18 Jun 2019 08:41:48 +0100
Message-Id: <20190618074153.16055-21-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190618074153.16055-1-chris@chris-wilson.co.uk>
References: <20190618074153.16055-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 21/26] drm/i915: Extract intel_frontbuffer
 active tracking
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

TW92ZSB0aGUgYWN0aXZlIHRyYWNraW5nIGZvciB0aGUgZnJvbnRidWZmZXIgb3BlcmF0aW9ucyBv
dXQgb2YgdGhlCmk5MTVfZ2VtX29iamVjdCBhbmQgaW50byBpdHMgb3duIGZpcnN0IGNsYXNzIChy
ZWZjb3VudGVkKSBvYmplY3QuIEluIHRoZQpwcm9jZXNzIG9mIGRldGFuZ2xpbmcsIHdlIHN3aXRj
aCBmcm9tIGxvdyBsZXZlbCByZXF1ZXN0IHRyYWNraW5nIHRvIHRoZQplYXNpZXIgaTkxNV9hY3Rp
dmUgLS0gd2l0aCB0aGUgcGxhbiB0aGF0IHRoaXMgYXZvaWRzIGFueSBwb3RlbnRpYWwKYXRvbWlj
IGNhbGxiYWNrcyBhcyB0aGUgZnJvbnRidWZmZXIgdHJhY2tpbmcgd2lzaGVzIHRvIHNsZWVwIGFz
IGl0CmZsdXNoZXMuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdp
bHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXkuYyAgfCAgNzAgKysrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZmJk
ZXYuYyAgICB8ICA0MCArKy0KIC4uLi9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mcm9udGJ1
ZmZlci5jICB8IDI1NSArKysrKysrKysrKysrLS0tLS0KIC4uLi9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9mcm9udGJ1ZmZlci5oICB8ICA3MCArKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9vdmVybGF5LmMgIHwgICA4ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fY2xmbHVzaC5jICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9kb21haW4uYyAgICB8ICAxNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX21tYW4uYyAgICAgIHwgICA0IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3QuYyAgICB8ICAyOCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX29iamVjdC5oICAgIHwgICAyICstCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9vYmplY3RfdHlwZXMuaCAgfCAgIDggKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVi
dWdmcy5jICAgICAgICAgICB8ICAgNSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5o
ICAgICAgICAgICAgICAgfCAgIDQgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyAg
ICAgICAgICAgICAgIHwgIDQ3ICstLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMg
ICAgICAgICAgICAgICB8ICAgNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2Lmgg
ICAgICAgICAgICAgIHwgICAxICsKIDE2IGZpbGVzIGNoYW5nZWQsIDMwNiBpbnNlcnRpb25zKCsp
LCAyNTggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Rpc3BsYXkuYwppbmRleCA4ZDdlNGM4YjYwYmMuLmZlMDkxODE1NzYyMSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTMwNDgsMTIgKzMwNDgs
MTMgQEAgaW50ZWxfYWxsb2NfaW5pdGlhbF9wbGFuZV9vYmooc3RydWN0IGludGVsX2NydGMgKmNy
dGMsCiB7CiAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNydGMtPmJhc2UuZGV2OwogCXN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKLQlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqID0gTlVMTDsKIAlzdHJ1Y3QgZHJtX21vZGVfZmJfY21kMiBt
b2RlX2NtZCA9IHsgMCB9OwogCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gJnBsYW5lX2Nv
bmZpZy0+ZmItPmJhc2U7CiAJdTMyIGJhc2VfYWxpZ25lZCA9IHJvdW5kX2Rvd24ocGxhbmVfY29u
ZmlnLT5iYXNlLCBQQUdFX1NJWkUpOwogCXUzMiBzaXplX2FsaWduZWQgPSByb3VuZF91cChwbGFu
ZV9jb25maWctPmJhc2UgKyBwbGFuZV9jb25maWctPnNpemUsCiAJCQkJICAgIFBBR0VfU0laRSk7
CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwlib29sIHJldCA9IGZhbHNlOwog
CiAJc2l6ZV9hbGlnbmVkIC09IGJhc2VfYWxpZ25lZDsKIApAQCAtMzA5NSw3ICszMDk2LDcgQEAg
aW50ZWxfYWxsb2NfaW5pdGlhbF9wbGFuZV9vYmooc3RydWN0IGludGVsX2NydGMgKmNydGMsCiAJ
CWJyZWFrOwogCWRlZmF1bHQ6CiAJCU1JU1NJTkdfQ0FTRShwbGFuZV9jb25maWctPnRpbGluZyk7
Ci0JCXJldHVybiBmYWxzZTsKKwkJZ290byBvdXQ7CiAJfQogCiAJbW9kZV9jbWQucGl4ZWxfZm9y
bWF0ID0gZmItPmZvcm1hdC0+Zm9ybWF0OwpAQCAtMzEwNywxNiArMzEwOCwxNSBAQCBpbnRlbF9h
bGxvY19pbml0aWFsX3BsYW5lX29iaihzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKIAogCWlmIChp
bnRlbF9mcmFtZWJ1ZmZlcl9pbml0KHRvX2ludGVsX2ZyYW1lYnVmZmVyKGZiKSwgb2JqLCAmbW9k
ZV9jbWQpKSB7CiAJCURSTV9ERUJVR19LTVMoImludGVsIGZiIGluaXQgZmFpbGVkXG4iKTsKLQkJ
Z290byBvdXRfdW5yZWZfb2JqOworCQlnb3RvIG91dDsKIAl9CiAKIAogCURSTV9ERUJVR19LTVMo
ImluaXRpYWwgcGxhbmUgZmIgb2JqICVwXG4iLCBvYmopOwotCXJldHVybiB0cnVlOwotCi1vdXRf
dW5yZWZfb2JqOgorCXJldCA9IHRydWU7CitvdXQ6CiAJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmop
OwotCXJldHVybiBmYWxzZTsKKwlyZXR1cm4gcmV0OwogfQogCiBzdGF0aWMgdm9pZApAQCAtMzE3
Myw2ICszMTczLDEyIEBAIHN0YXRpYyB2b2lkIGludGVsX3BsYW5lX2Rpc2FibGVfbm9hdG9taWMo
c3RydWN0IGludGVsX2NydGMgKmNydGMsCiAJaW50ZWxfZGlzYWJsZV9wbGFuZShwbGFuZSwgY3J0
Y19zdGF0ZSk7CiB9CiAKK3N0YXRpYyBzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKgordG9faW50
ZWxfZnJvbnRidWZmZXIoc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIpCit7CisJcmV0dXJuIGZi
ID8gdG9faW50ZWxfZnJhbWVidWZmZXIoZmIpLT5mcm9udGJ1ZmZlciA6IE5VTEw7Cit9CisKIHN0
YXRpYyB2b2lkCiBpbnRlbF9maW5kX2luaXRpYWxfcGxhbmVfb2JqKHN0cnVjdCBpbnRlbF9jcnRj
ICppbnRlbF9jcnRjLAogCQkJICAgICBzdHJ1Y3QgaW50ZWxfaW5pdGlhbF9wbGFuZV9jb25maWcg
KnBsYW5lX2NvbmZpZykKQEAgLTMxODAsNyArMzE4Niw2IEBAIGludGVsX2ZpbmRfaW5pdGlhbF9w
bGFuZV9vYmooc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCiAJc3RydWN0IGRybV9kZXZp
Y2UgKmRldiA9IGludGVsX2NydGMtPmJhc2UuZGV2OwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKIAlzdHJ1Y3QgZHJtX2NydGMgKmM7Ci0Jc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3QgZHJtX3BsYW5lICpwcmltYXJ5ID0g
aW50ZWxfY3J0Yy0+YmFzZS5wcmltYXJ5OwogCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlID0gcHJpbWFyeS0+c3RhdGU7CiAJc3RydWN0IGludGVsX3BsYW5lICppbnRlbF9wbGFu
ZSA9IHRvX2ludGVsX3BsYW5lKHByaW1hcnkpOwpAQCAtMzI1Niw4ICszMjYxLDcgQEAgaW50ZWxf
ZmluZF9pbml0aWFsX3BsYW5lX29iaihzdHJ1Y3QgaW50ZWxfY3J0YyAqaW50ZWxfY3J0YywKIAkJ
cmV0dXJuOwogCX0KIAotCW9iaiA9IGludGVsX2ZiX29iaihmYik7Ci0JaW50ZWxfZmJfb2JqX2Zs
dXNoKG9iaiwgT1JJR0lOX0RJUlRZRkIpOworCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKHRvX2lu
dGVsX2Zyb250YnVmZmVyKGZiKSwgT1JJR0lOX0RJUlRZRkIpOwogCiAJcGxhbmVfc3RhdGUtPnNy
Y194ID0gMDsKIAlwbGFuZV9zdGF0ZS0+c3JjX3kgPSAwOwpAQCAtMzI3MiwxNCArMzI3NiwxNCBA
QCBpbnRlbF9maW5kX2luaXRpYWxfcGxhbmVfb2JqKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9j
cnRjLAogCWludGVsX3N0YXRlLT5iYXNlLnNyYyA9IGRybV9wbGFuZV9zdGF0ZV9zcmMocGxhbmVf
c3RhdGUpOwogCWludGVsX3N0YXRlLT5iYXNlLmRzdCA9IGRybV9wbGFuZV9zdGF0ZV9kZXN0KHBs
YW5lX3N0YXRlKTsKIAotCWlmIChpOTE1X2dlbV9vYmplY3RfaXNfdGlsZWQob2JqKSkKKwlpZiAo
cGxhbmVfY29uZmlnLT50aWxpbmcpCiAJCWRldl9wcml2LT5wcmVzZXJ2ZV9iaW9zX3N3aXp6bGUg
PSB0cnVlOwogCiAJcGxhbmVfc3RhdGUtPmZiID0gZmI7CiAJcGxhbmVfc3RhdGUtPmNydGMgPSAm
aW50ZWxfY3J0Yy0+YmFzZTsKIAogCWF0b21pY19vcih0b19pbnRlbF9wbGFuZShwcmltYXJ5KS0+
ZnJvbnRidWZmZXJfYml0LAotCQkgICZvYmotPmZyb250YnVmZmVyX2JpdHMpOworCQkgICZ0b19p
bnRlbF9mcm9udGJ1ZmZlcihmYiktPmJpdHMpOwogfQogCiBzdGF0aWMgaW50IHNrbF9tYXhfcGxh
bmVfd2lkdGgoY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIsCkBAIC0xMzk4Miw5ICsx
Mzk4Niw5IEBAIHN0YXRpYyB2b2lkIGludGVsX2F0b21pY190cmFja19mYnMoc3RydWN0IGRybV9h
dG9taWNfc3RhdGUgKnN0YXRlKQogCWludCBpOwogCiAJZm9yX2VhY2hfb2xkbmV3X3BsYW5lX2lu
X3N0YXRlKHN0YXRlLCBwbGFuZSwgb2xkX3BsYW5lX3N0YXRlLCBuZXdfcGxhbmVfc3RhdGUsIGkp
Ci0JCWk5MTVfZ2VtX3RyYWNrX2ZiKGludGVsX2ZiX29iaihvbGRfcGxhbmVfc3RhdGUtPmZiKSwK
LQkJCQkgIGludGVsX2ZiX29iaihuZXdfcGxhbmVfc3RhdGUtPmZiKSwKLQkJCQkgIHRvX2ludGVs
X3BsYW5lKHBsYW5lKS0+ZnJvbnRidWZmZXJfYml0KTsKKwkJaW50ZWxfZnJvbnRidWZmZXJfdHJh
Y2sodG9faW50ZWxfZnJvbnRidWZmZXIob2xkX3BsYW5lX3N0YXRlLT5mYiksCisJCQkJCXRvX2lu
dGVsX2Zyb250YnVmZmVyKG5ld19wbGFuZV9zdGF0ZS0+ZmIpLAorCQkJCQl0b19pbnRlbF9wbGFu
ZShwbGFuZSktPmZyb250YnVmZmVyX2JpdCk7CiB9CiAKIC8qKgpAQCAtMTQyOTQsNyArMTQyOTgs
NyBAQCBpbnRlbF9wcmVwYXJlX3BsYW5lX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAogCQly
ZXR1cm4gcmV0OwogCiAJZmJfb2JqX2J1bXBfcmVuZGVyX3ByaW9yaXR5KG9iaik7Ci0JaW50ZWxf
ZmJfb2JqX2ZsdXNoKG9iaiwgT1JJR0lOX0RJUlRZRkIpOworCWludGVsX2Zyb250YnVmZmVyX2Zs
dXNoKG9iai0+ZnJvbnRidWZmZXIsIE9SSUdJTl9ESVJUWUZCKTsKIAogCWlmICghbmV3X3N0YXRl
LT5mZW5jZSkgeyAvKiBpbXBsaWNpdCBmZW5jaW5nICovCiAJCXN0cnVjdCBkbWFfZmVuY2UgKmZl
bmNlOwpAQCAtMTQ1NTcsMTMgKzE0NTYxLDEyIEBAIGludGVsX2xlZ2FjeV9jdXJzb3JfdXBkYXRl
KHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLAogCQkJICAgc3RydWN0IGRybV9tb2Rlc2V0X2FjcXVp
cmVfY3R4ICpjdHgpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShjcnRjLT5kZXYpOwotCWludCByZXQ7CiAJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqb2xk
X3BsYW5lX3N0YXRlLCAqbmV3X3BsYW5lX3N0YXRlOwogCXN0cnVjdCBpbnRlbF9wbGFuZSAqaW50
ZWxfcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZSk7Ci0Jc3RydWN0IGRybV9mcmFtZWJ1ZmZl
ciAqb2xkX2ZiOwogCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlID0KIAkJdG9f
aW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5zdGF0ZSk7CiAJc3RydWN0IGludGVsX2NydGNfc3RhdGUg
Km5ld19jcnRjX3N0YXRlOworCWludCByZXQ7CiAKIAkvKgogCSAqIFdoZW4gY3J0YyBpcyBpbmFj
dGl2ZSBvciB0aGVyZSBpcyBhIG1vZGVzZXQgcGVuZGluZywKQEAgLTE0NjMxLDExICsxNDYzNCwx
MCBAQCBpbnRlbF9sZWdhY3lfY3Vyc29yX3VwZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwK
IAlpZiAocmV0KQogCQlnb3RvIG91dF91bmxvY2s7CiAKLQlpbnRlbF9mYl9vYmpfZmx1c2goaW50
ZWxfZmJfb2JqKGZiKSwgT1JJR0lOX0ZMSVApOwotCi0Jb2xkX2ZiID0gb2xkX3BsYW5lX3N0YXRl
LT5mYjsKLQlpOTE1X2dlbV90cmFja19mYihpbnRlbF9mYl9vYmoob2xkX2ZiKSwgaW50ZWxfZmJf
b2JqKGZiKSwKLQkJCSAgaW50ZWxfcGxhbmUtPmZyb250YnVmZmVyX2JpdCk7CisJaW50ZWxfZnJv
bnRidWZmZXJfZmx1c2godG9faW50ZWxfZnJvbnRidWZmZXIoZmIpLCBPUklHSU5fRkxJUCk7CisJ
aW50ZWxfZnJvbnRidWZmZXJfdHJhY2sodG9faW50ZWxfZnJvbnRidWZmZXIob2xkX3BsYW5lX3N0
YXRlLT5mYiksCisJCQkJdG9faW50ZWxfZnJvbnRidWZmZXIoZmIpLAorCQkJCWludGVsX3BsYW5l
LT5mcm9udGJ1ZmZlcl9iaXQpOwogCiAJLyogU3dhcCBwbGFuZSBzdGF0ZSAqLwogCXBsYW5lLT5z
dGF0ZSA9IG5ld19wbGFuZV9zdGF0ZTsKQEAgLTE1MzIzLDE1ICsxNTMyNSw5IEBAIHN0YXRpYyB2
b2lkIGludGVsX3NldHVwX291dHB1dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQogc3RhdGljIHZvaWQgaW50ZWxfdXNlcl9mcmFtZWJ1ZmZlcl9kZXN0cm95KHN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKmZiKQogewogCXN0cnVjdCBpbnRlbF9mcmFtZWJ1ZmZlciAqaW50ZWxfZmIg
PSB0b19pbnRlbF9mcmFtZWJ1ZmZlcihmYik7Ci0Jc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaiA9IGludGVsX2ZiX29iaihmYik7CiAKIAlkcm1fZnJhbWVidWZmZXJfY2xlYW51cChmYik7
Ci0KLQlpOTE1X2dlbV9vYmplY3RfbG9jayhvYmopOwotCVdBUk5fT04oIW9iai0+ZnJhbWVidWZm
ZXJfcmVmZXJlbmNlcy0tKTsKLQlpOTE1X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7Ci0KLQlpOTE1
X2dlbV9vYmplY3RfcHV0KG9iaik7CisJaW50ZWxfZnJvbnRidWZmZXJfcHV0KGludGVsX2ZiLT5m
cm9udGJ1ZmZlcik7CiAKIAlrZnJlZShpbnRlbF9mYik7CiB9CkBAIC0xNTM1OSw3ICsxNTM1NSw3
IEBAIHN0YXRpYyBpbnQgaW50ZWxfdXNlcl9mcmFtZWJ1ZmZlcl9kaXJ0eShzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICpmYiwKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gaW50ZWxf
ZmJfb2JqKGZiKTsKIAogCWk5MTVfZ2VtX29iamVjdF9mbHVzaF9pZl9kaXNwbGF5KG9iaik7Ci0J
aW50ZWxfZmJfb2JqX2ZsdXNoKG9iaiwgT1JJR0lOX0RJUlRZRkIpOworCWludGVsX2Zyb250YnVm
ZmVyX2ZsdXNoKHRvX2ludGVsX2Zyb250YnVmZmVyKGZiKSwgT1JJR0lOX0RJUlRZRkIpOwogCiAJ
cmV0dXJuIDA7CiB9CkBAIC0xNTM4MSw4ICsxNTM3NywxMSBAQCBzdGF0aWMgaW50IGludGVsX2Zy
YW1lYnVmZmVyX2luaXQoc3RydWN0IGludGVsX2ZyYW1lYnVmZmVyICppbnRlbF9mYiwKIAlpbnQg
cmV0ID0gLUVJTlZBTDsKIAlpbnQgaTsKIAorCWludGVsX2ZiLT5mcm9udGJ1ZmZlciA9IGludGVs
X2Zyb250YnVmZmVyX2dldChvYmopOworCWlmICghaW50ZWxfZmItPmZyb250YnVmZmVyKQorCQly
ZXR1cm4gLUVOT01FTTsKKwogCWk5MTVfZ2VtX29iamVjdF9sb2NrKG9iaik7Ci0Jb2JqLT5mcmFt
ZWJ1ZmZlcl9yZWZlcmVuY2VzKys7CiAJdGlsaW5nID0gaTkxNV9nZW1fb2JqZWN0X2dldF90aWxp
bmcob2JqKTsKIAlzdHJpZGUgPSBpOTE1X2dlbV9vYmplY3RfZ2V0X3N0cmlkZShvYmopOwogCWk5
MTVfZ2VtX29iamVjdF91bmxvY2sob2JqKTsKQEAgLTE1NDk5LDkgKzE1NDk4LDcgQEAgc3RhdGlj
IGludCBpbnRlbF9mcmFtZWJ1ZmZlcl9pbml0KHN0cnVjdCBpbnRlbF9mcmFtZWJ1ZmZlciAqaW50
ZWxfZmIsCiAJcmV0dXJuIDA7CiAKIGVycjoKLQlpOTE1X2dlbV9vYmplY3RfbG9jayhvYmopOwot
CW9iai0+ZnJhbWVidWZmZXJfcmVmZXJlbmNlcy0tOwotCWk5MTVfZ2VtX29iamVjdF91bmxvY2so
b2JqKTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl9wdXQoaW50ZWxfZmItPmZyb250YnVmZmVyKTsKIAly
ZXR1cm4gcmV0OwogfQogCkBAIC0xNTUxOSw4ICsxNTUxNiw3IEBAIGludGVsX3VzZXJfZnJhbWVi
dWZmZXJfY3JlYXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCXJldHVybiBFUlJfUFRSKC1F
Tk9FTlQpOwogCiAJZmIgPSBpbnRlbF9mcmFtZWJ1ZmZlcl9jcmVhdGUob2JqLCAmbW9kZV9jbWQp
OwotCWlmIChJU19FUlIoZmIpKQotCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJaTkxNV9n
ZW1fb2JqZWN0X3B1dChvYmopOwogCiAJcmV0dXJuIGZiOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmRldi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9mYmRldi5jCmluZGV4IDFlZGQ0NGVlMzJiMi4uNGI1N2NkZDc2Njk5
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2ZiZGV2LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmRldi5jCkBAIC00Nywx
MyArNDcsMTQgQEAKICNpbmNsdWRlICJpbnRlbF9mYmRldi5oIgogI2luY2x1ZGUgImludGVsX2Zy
b250YnVmZmVyLmgiCiAKLXN0YXRpYyB2b2lkIGludGVsX2ZiZGV2X2ludmFsaWRhdGUoc3RydWN0
IGludGVsX2ZiZGV2ICppZmJkZXYpCitzdGF0aWMgc3RydWN0IGludGVsX2Zyb250YnVmZmVyICp0
b19mcm9udGJ1ZmZlcihzdHJ1Y3QgaW50ZWxfZmJkZXYgKmlmYmRldikKIHsKLQlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqID0gaW50ZWxfZmJfb2JqKCZpZmJkZXYtPmZiLT5iYXNlKTsK
LQl1bnNpZ25lZCBpbnQgb3JpZ2luID0KLQkJaWZiZGV2LT52bWFfZmxhZ3MgJiBQTEFORV9IQVNf
RkVOQ0UgPyBPUklHSU5fR1RUIDogT1JJR0lOX0NQVTsKKwlyZXR1cm4gaWZiZGV2LT5mYi0+ZnJv
bnRidWZmZXI7Cit9CiAKLQlpbnRlbF9mYl9vYmpfaW52YWxpZGF0ZShvYmosIG9yaWdpbik7Citz
dGF0aWMgdm9pZCBpbnRlbF9mYmRldl9pbnZhbGlkYXRlKHN0cnVjdCBpbnRlbF9mYmRldiAqaWZi
ZGV2KQoreworCWludGVsX2Zyb250YnVmZmVyX2ludmFsaWRhdGUodG9fZnJvbnRidWZmZXIoaWZi
ZGV2KSwgT1JJR0lOX0NQVSk7CiB9CiAKIHN0YXRpYyBpbnQgaW50ZWxfZmJkZXZfc2V0X3Bhcihz
dHJ1Y3QgZmJfaW5mbyAqaW5mbykKQEAgLTEyMCw3ICsxMjEsNyBAQCBzdGF0aWMgaW50IGludGVs
ZmJfYWxsb2Moc3RydWN0IGRybV9mYl9oZWxwZXIgKmhlbHBlciwKIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7CiAJc3RydWN0IGRybV9tb2RlX2ZiX2Nt
ZDIgbW9kZV9jbWQgPSB7fTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwotCWlu
dCBzaXplLCByZXQ7CisJaW50IHNpemU7CiAKIAkvKiB3ZSBkb24ndCBkbyBwYWNrZWQgMjRicHAg
Ki8KIAlpZiAoc2l6ZXMtPnN1cmZhY2VfYnBwID09IDI0KQpAQCAtMTQ3LDI0ICsxNDgsMTYgQEAg
c3RhdGljIGludCBpbnRlbGZiX2FsbG9jKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCiAJ
CW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0oZGV2X3ByaXYsIHNpemUpOwogCWlm
IChJU19FUlIob2JqKSkgewogCQlEUk1fRVJST1IoImZhaWxlZCB0byBhbGxvY2F0ZSBmcmFtZWJ1
ZmZlclxuIik7Ci0JCXJldCA9IFBUUl9FUlIob2JqKTsKLQkJZ290byBlcnI7CisJCXJldHVybiBQ
VFJfRVJSKG9iaik7CiAJfQogCiAJZmIgPSBpbnRlbF9mcmFtZWJ1ZmZlcl9jcmVhdGUob2JqLCAm
bW9kZV9jbWQpOwotCWlmIChJU19FUlIoZmIpKSB7Ci0JCXJldCA9IFBUUl9FUlIoZmIpOwotCQln
b3RvIGVycl9vYmo7Ci0JfQorCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKKwlpZiAoSVNfRVJS
KGZiKSkKKwkJcmV0dXJuIFBUUl9FUlIoZmIpOwogCiAJaWZiZGV2LT5mYiA9IHRvX2ludGVsX2Zy
YW1lYnVmZmVyKGZiKTsKLQogCXJldHVybiAwOwotCi1lcnJfb2JqOgotCWk5MTVfZ2VtX29iamVj
dF9wdXQob2JqKTsKLWVycjoKLQlyZXR1cm4gcmV0OwogfQogCiBzdGF0aWMgaW50IGludGVsZmJf
Y3JlYXRlKHN0cnVjdCBkcm1fZmJfaGVscGVyICpoZWxwZXIsCkBAIC0xODAsNyArMTczLDYgQEAg
c3RhdGljIGludCBpbnRlbGZiX2NyZWF0ZShzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAqaGVscGVyLAog
CWNvbnN0IHN0cnVjdCBpOTE1X2dndHRfdmlldyB2aWV3ID0gewogCQkudHlwZSA9IEk5MTVfR0dU
VF9WSUVXX05PUk1BTCwKIAl9OwotCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiOwogCWludGVs
X3dha2VyZWZfdCB3YWtlcmVmOwogCXN0cnVjdCBmYl9pbmZvICppbmZvOwogCXN0cnVjdCBpOTE1
X3ZtYSAqdm1hOwpAQCAtMjI2LDggKzIxOCw3IEBAIHN0YXRpYyBpbnQgaW50ZWxmYl9jcmVhdGUo
c3RydWN0IGRybV9mYl9oZWxwZXIgKmhlbHBlciwKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KIAot
CWZiID0gJmlmYmRldi0+ZmItPmJhc2U7Ci0JaW50ZWxfZmJfb2JqX2ZsdXNoKGludGVsX2ZiX29i
aihmYiksIE9SSUdJTl9ESVJUWUZCKTsKKwlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaCh0b19mcm9u
dGJ1ZmZlcihpZmJkZXYpLCBPUklHSU5fRElSVFlGQik7CiAKIAlpbmZvID0gZHJtX2ZiX2hlbHBl
cl9hbGxvY19mYmkoaGVscGVyKTsKIAlpZiAoSVNfRVJSKGluZm8pKSB7CkBAIC0yMzYsNyArMjI3
LDcgQEAgc3RhdGljIGludCBpbnRlbGZiX2NyZWF0ZShzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAqaGVs
cGVyLAogCQlnb3RvIG91dF91bnBpbjsKIAl9CiAKLQlpZmJkZXYtPmhlbHBlci5mYiA9IGZiOwor
CWlmYmRldi0+aGVscGVyLmZiID0gJmlmYmRldi0+ZmItPmJhc2U7CiAKIAlpbmZvLT5mYm9wcyA9
ICZpbnRlbGZiX29wczsKIApAQCAtMjYyLDEzICsyNTMsMTQgQEAgc3RhdGljIGludCBpbnRlbGZi
X2NyZWF0ZShzdHJ1Y3QgZHJtX2ZiX2hlbHBlciAqaGVscGVyLAogCSAqIElmIHRoZSBvYmplY3Qg
aXMgc3RvbGVuIGhvd2V2ZXIsIGl0IHdpbGwgYmUgZnVsbCBvZiB3aGF0ZXZlcgogCSAqIGdhcmJh
Z2Ugd2FzIGxlZnQgaW4gdGhlcmUuCiAJICovCi0JaWYgKGludGVsX2ZiX29iaihmYiktPnN0b2xl
biAmJiAhcHJlYWxsb2MpCisJaWYgKHZtYS0+b2JqLT5zdG9sZW4gJiYgIXByZWFsbG9jKQogCQlt
ZW1zZXRfaW8oaW5mby0+c2NyZWVuX2Jhc2UsIDAsIGluZm8tPnNjcmVlbl9zaXplKTsKIAogCS8q
IFVzZSBkZWZhdWx0IHNjcmF0Y2ggcGl4bWFwIChpbmZvLT5waXhtYXAuZmxhZ3MgPSBGQl9QSVhN
QVBfU1lTVEVNKSAqLwogCiAJRFJNX0RFQlVHX0tNUygiYWxsb2NhdGVkICVkeCVkIGZiOiAweCUw
OHhcbiIsCi0JCSAgICAgIGZiLT53aWR0aCwgZmItPmhlaWdodCwgaTkxNV9nZ3R0X29mZnNldCh2
bWEpKTsKKwkJICAgICAgaWZiZGV2LT5mYi0+YmFzZS53aWR0aCwgaWZiZGV2LT5mYi0+YmFzZS5o
ZWlnaHQsCisJCSAgICAgIGk5MTVfZ2d0dF9vZmZzZXQodm1hKSk7CiAJaWZiZGV2LT52bWEgPSB2
bWE7CiAJaWZiZGV2LT52bWFfZmxhZ3MgPSBmbGFnczsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mcm9udGJ1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9mcm9udGJ1ZmZlci5jCmluZGV4IDQ0MjczYzEwY2VhNS4uNzEy
ODE0ODE1NWRjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2Zyb250YnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9m
cm9udGJ1ZmZlci5jCkBAIC0zMCwxMSArMzAsMTEgQEAKICAqIE1hbnkgZmVhdHVyZXMgcmVxdWly
ZSB1cyB0byB0cmFjayBjaGFuZ2VzIHRvIHRoZSBjdXJyZW50bHkgYWN0aXZlCiAgKiBmcm9udGJ1
ZmZlciwgZXNwZWNpYWxseSByZW5kZXJpbmcgdGFyZ2V0ZWQgYXQgdGhlIGZyb250YnVmZmVyLgog
ICoKLSAqIFRvIGJlIGFibGUgdG8gZG8gc28gR0VNIHRyYWNrcyBmcm9udGJ1ZmZlcnMgdXNpbmcg
YSBiaXRtYXNrIGZvciBhbGwgcG9zc2libGUKLSAqIGZyb250YnVmZmVyIHNsb3RzIHRocm91Z2gg
aTkxNV9nZW1fdHJhY2tfZmIoKS4gVGhlIGZ1bmN0aW9uIGluIHRoaXMgZmlsZSBhcmUKLSAqIHRo
ZW4gY2FsbGVkIHdoZW4gdGhlIGNvbnRlbnRzIG9mIHRoZSBmcm9udGJ1ZmZlciBhcmUgaW52YWxp
ZGF0ZWQsIHdoZW4KLSAqIGZyb250YnVmZmVyIHJlbmRlcmluZyBoYXMgc3RvcHBlZCBhZ2FpbiB0
byBmbHVzaCBvdXQgYWxsIHRoZSBjaGFuZ2VzIGFuZCB3aGVuCi0gKiB0aGUgZnJvbnRidWZmZXIg
aXMgZXhjaGFuZ2VkIHdpdGggYSBmbGlwLiBTdWJzeXN0ZW1zIGludGVyZXN0ZWQgaW4KKyAqIFRv
IGJlIGFibGUgdG8gZG8gc28gd2UgdHJhY2sgZnJvbnRidWZmZXJzIHVzaW5nIGEgYml0bWFzayBm
b3IgYWxsIHBvc3NpYmxlCisgKiBmcm9udGJ1ZmZlciBzbG90cyB0aHJvdWdoIGludGVsX2Zyb250
YnVmZmVyX3RyYWNrKCkuIFRoZSBmdW5jdGlvbnMgaW4gdGhpcworICogZmlsZSBhcmUgdGhlbiBj
YWxsZWQgd2hlbiB0aGUgY29udGVudHMgb2YgdGhlIGZyb250YnVmZmVyIGFyZSBpbnZhbGlkYXRl
ZCwKKyAqIHdoZW4gZnJvbnRidWZmZXIgcmVuZGVyaW5nIGhhcyBzdG9wcGVkIGFnYWluIHRvIGZs
dXNoIG91dCBhbGwgdGhlIGNoYW5nZXMKKyAqIGFuZCB3aGVuIHRoZSBmcm9udGJ1ZmZlciBpcyBl
eGNoYW5nZWQgd2l0aCBhIGZsaXAuIFN1YnN5c3RlbXMgaW50ZXJlc3RlZCBpbgogICogZnJvbnRi
dWZmZXIgY2hhbmdlcyAoZS5nLiBQU1IsIEZCQywgRFJSUykgc2hvdWxkIGRpcmVjdGx5IHB1dCB0
aGVpciBjYWxsYmFja3MKICAqIGludG8gdGhlIHJlbGV2YW50IHBsYWNlcyBhbmQgZmlsdGVyIGZv
ciB0aGUgZnJvbnRidWZmZXIgc2xvdHMgdGhhdCB0aGV5IGFyZQogICogaW50ZXJlc3RlZCBpbnQu
CkBAIC02MywyOCArNjMsOSBAQAogI2luY2x1ZGUgImludGVsX2Zyb250YnVmZmVyLmgiCiAjaW5j
bHVkZSAiaW50ZWxfcHNyLmgiCiAKLXZvaWQgX19pbnRlbF9mYl9vYmpfaW52YWxpZGF0ZShzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAotCQkJICAgICAgIGVudW0gZmJfb3Bfb3JpZ2lu
IG9yaWdpbiwKLQkJCSAgICAgICB1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0cykKLXsKLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYp
OwotCi0JaWYgKG9yaWdpbiA9PSBPUklHSU5fQ1MpIHsKLQkJc3Bpbl9sb2NrKCZkZXZfcHJpdi0+
ZmJfdHJhY2tpbmcubG9jayk7Ci0JCWRldl9wcml2LT5mYl90cmFja2luZy5idXN5X2JpdHMgfD0g
ZnJvbnRidWZmZXJfYml0czsKLQkJZGV2X3ByaXYtPmZiX3RyYWNraW5nLmZsaXBfYml0cyAmPSB+
ZnJvbnRidWZmZXJfYml0czsKLQkJc3Bpbl91bmxvY2soJmRldl9wcml2LT5mYl90cmFja2luZy5s
b2NrKTsKLQl9Ci0KLQltaWdodF9zbGVlcCgpOwotCWludGVsX3Bzcl9pbnZhbGlkYXRlKGRldl9w
cml2LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwotCWludGVsX2VkcF9kcnJzX2ludmFsaWRh
dGUoZGV2X3ByaXYsIGZyb250YnVmZmVyX2JpdHMpOwotCWludGVsX2ZiY19pbnZhbGlkYXRlKGRl
dl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwotfQotCiAvKioKLSAqIGludGVsX2Zy
b250YnVmZmVyX2ZsdXNoIC0gZmx1c2ggZnJvbnRidWZmZXIKLSAqIEBkZXZfcHJpdjogaTkxNSBk
ZXZpY2UKKyAqIGZyb250YnVmZmVyX2ZsdXNoIC0gZmx1c2ggZnJvbnRidWZmZXIKKyAqIEBpOTE1
OiBpOTE1IGRldmljZQogICogQGZyb250YnVmZmVyX2JpdHM6IGZyb250YnVmZmVyIHBsYW5lIHRy
YWNraW5nIGJpdHMKICAqIEBvcmlnaW46IHdoaWNoIG9wZXJhdGlvbiBjYXVzZWQgdGhlIGZsdXNo
CiAgKgpAQCAtOTQsNDUgKzc1LDI3IEBAIHZvaWQgX19pbnRlbF9mYl9vYmpfaW52YWxpZGF0ZShz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogICoKICAqIENhbiBiZSBjYWxsZWQgd2l0
aG91dCBhbnkgbG9ja3MgaGVsZC4KICAqLwotc3RhdGljIHZvaWQgaW50ZWxfZnJvbnRidWZmZXJf
Zmx1c2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCSAgICB1bnNpZ25l
ZCBmcm9udGJ1ZmZlcl9iaXRzLAotCQkJCSAgICBlbnVtIGZiX29wX29yaWdpbiBvcmlnaW4pCitz
dGF0aWMgdm9pZCBmcm9udGJ1ZmZlcl9mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwKKwkJCSAgICAgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzLAorCQkJICAgICAgZW51
bSBmYl9vcF9vcmlnaW4gb3JpZ2luKQogewogCS8qIERlbGF5IGZsdXNoaW5nIHdoZW4gcmluZ3Mg
YXJlIHN0aWxsIGJ1c3kuKi8KLQlzcGluX2xvY2soJmRldl9wcml2LT5mYl90cmFja2luZy5sb2Nr
KTsKLQlmcm9udGJ1ZmZlcl9iaXRzICY9IH5kZXZfcHJpdi0+ZmJfdHJhY2tpbmcuYnVzeV9iaXRz
OwotCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7CisJc3Bpbl9sb2Nr
KCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKKwlmcm9udGJ1ZmZlcl9iaXRzICY9IH5pOTE1LT5m
Yl90cmFja2luZy5idXN5X2JpdHM7CisJc3Bpbl91bmxvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxv
Y2spOwogCiAJaWYgKCFmcm9udGJ1ZmZlcl9iaXRzKQogCQlyZXR1cm47CiAKIAltaWdodF9zbGVl
cCgpOwotCWludGVsX2VkcF9kcnJzX2ZsdXNoKGRldl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRzKTsK
LQlpbnRlbF9wc3JfZmx1c2goZGV2X3ByaXYsIGZyb250YnVmZmVyX2JpdHMsIG9yaWdpbik7Ci0J
aW50ZWxfZmJjX2ZsdXNoKGRldl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwotfQot
Ci12b2lkIF9faW50ZWxfZmJfb2JqX2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmosCi0JCQkgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwKLQkJCSAgdW5zaWduZWQgaW50IGZy
b250YnVmZmVyX2JpdHMpCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0g
dG9faTkxNShvYmotPmJhc2UuZGV2KTsKLQotCWlmIChvcmlnaW4gPT0gT1JJR0lOX0NTKSB7Ci0J
CXNwaW5fbG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwotCQkvKiBGaWx0ZXIgb3V0
IG5ldyBiaXRzIHNpbmNlIHJlbmRlcmluZyBzdGFydGVkLiAqLwotCQlmcm9udGJ1ZmZlcl9iaXRz
ICY9IGRldl9wcml2LT5mYl90cmFja2luZy5idXN5X2JpdHM7Ci0JCWRldl9wcml2LT5mYl90cmFj
a2luZy5idXN5X2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Ci0JCXNwaW5fdW5sb2NrKCZkZXZf
cHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7Ci0JfQotCi0JaWYgKGZyb250YnVmZmVyX2JpdHMpCi0J
CWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKGRldl9wcml2LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmln
aW4pOworCWludGVsX2VkcF9kcnJzX2ZsdXNoKGk5MTUsIGZyb250YnVmZmVyX2JpdHMpOworCWlu
dGVsX3Bzcl9mbHVzaChpOTE1LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOworCWludGVsX2Zi
Y19mbHVzaChpOTE1LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOwogfQogCiAvKioKICAqIGlu
dGVsX2Zyb250YnVmZmVyX2ZsaXBfcHJlcGFyZSAtIHByZXBhcmUgYXN5bmNocm9ub3VzIGZyb250
YnVmZmVyIGZsaXAKLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UKKyAqIEBpOTE1OiBpOTE1IGRl
dmljZQogICogQGZyb250YnVmZmVyX2JpdHM6IGZyb250YnVmZmVyIHBsYW5lIHRyYWNraW5nIGJp
dHMKICAqCiAgKiBUaGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIGFmdGVyIHNjaGVkdWxpbmcgYSBm
bGlwIG9uIEBvYmouIFRoZSBhY3R1YWwKQEAgLTE0MiwxOSArMTA1LDE5IEBAIHZvaWQgX19pbnRl
bF9mYl9vYmpfZmx1c2goc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKICAqCiAgKiBD
YW4gYmUgY2FsbGVkIHdpdGhvdXQgYW55IGxvY2tzIGhlbGQuCiAgKi8KLXZvaWQgaW50ZWxfZnJv
bnRidWZmZXJfZmxpcF9wcmVwYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
K3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9wcmVwYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1LAogCQkJCSAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzKQogewotCXNwaW5f
bG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwotCWRldl9wcml2LT5mYl90cmFja2lu
Zy5mbGlwX2JpdHMgfD0gZnJvbnRidWZmZXJfYml0czsKKwlzcGluX2xvY2soJmk5MTUtPmZiX3Ry
YWNraW5nLmxvY2spOworCWk5MTUtPmZiX3RyYWNraW5nLmZsaXBfYml0cyB8PSBmcm9udGJ1ZmZl
cl9iaXRzOwogCS8qIFJlbW92ZSBzdGFsZSBidXN5IGJpdHMgZHVlIHRvIHRoZSBvbGQgYnVmZmVy
LiAqLwotCWRldl9wcml2LT5mYl90cmFja2luZy5idXN5X2JpdHMgJj0gfmZyb250YnVmZmVyX2Jp
dHM7Ci0Jc3Bpbl91bmxvY2soJmRldl9wcml2LT5mYl90cmFja2luZy5sb2NrKTsKKwlpOTE1LT5m
Yl90cmFja2luZy5idXN5X2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7CisJc3Bpbl91bmxvY2so
Jmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOwogfQogCiAvKioKICAqIGludGVsX2Zyb250YnVmZmVy
X2ZsaXBfY29tcGxldGUgLSBjb21wbGV0ZSBhc3luY2hyb25vdXMgZnJvbnRidWZmZXIgZmxpcAot
ICogQGRldl9wcml2OiBpOTE1IGRldmljZQorICogQGk5MTU6IGk5MTUgZGV2aWNlCiAgKiBAZnJv
bnRidWZmZXJfYml0czogZnJvbnRidWZmZXIgcGxhbmUgdHJhY2tpbmcgYml0cwogICoKICAqIFRo
aXMgZnVuY3Rpb24gZ2V0cyBjYWxsZWQgYWZ0ZXIgdGhlIGZsaXAgaGFzIGJlZW4gbGF0Y2hlZCBh
bmQgd2lsbCBjb21wbGV0ZQpAQCAtMTYyLDIzICsxMjUsMjIgQEAgdm9pZCBpbnRlbF9mcm9udGJ1
ZmZlcl9mbGlwX3ByZXBhcmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogICoK
ICAqIENhbiBiZSBjYWxsZWQgd2l0aG91dCBhbnkgbG9ja3MgaGVsZC4KICAqLwotdm9pZCBpbnRl
bF9mcm9udGJ1ZmZlcl9mbGlwX2NvbXBsZXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKK3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9jb21wbGV0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCQkgICAgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMpCiB7
Ci0Jc3Bpbl9sb2NrKCZkZXZfcHJpdi0+ZmJfdHJhY2tpbmcubG9jayk7CisJc3Bpbl9sb2NrKCZp
OTE1LT5mYl90cmFja2luZy5sb2NrKTsKIAkvKiBNYXNrIGFueSBjYW5jZWxsZWQgZmxpcHMuICov
Ci0JZnJvbnRidWZmZXJfYml0cyAmPSBkZXZfcHJpdi0+ZmJfdHJhY2tpbmcuZmxpcF9iaXRzOwot
CWRldl9wcml2LT5mYl90cmFja2luZy5mbGlwX2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7Ci0J
c3Bpbl91bmxvY2soJmRldl9wcml2LT5mYl90cmFja2luZy5sb2NrKTsKKwlmcm9udGJ1ZmZlcl9i
aXRzICY9IGk5MTUtPmZiX3RyYWNraW5nLmZsaXBfYml0czsKKwlpOTE1LT5mYl90cmFja2luZy5m
bGlwX2JpdHMgJj0gfmZyb250YnVmZmVyX2JpdHM7CisJc3Bpbl91bmxvY2soJmk5MTUtPmZiX3Ry
YWNraW5nLmxvY2spOwogCiAJaWYgKGZyb250YnVmZmVyX2JpdHMpCi0JCWludGVsX2Zyb250YnVm
ZmVyX2ZsdXNoKGRldl9wcml2LAotCQkJCQlmcm9udGJ1ZmZlcl9iaXRzLCBPUklHSU5fRkxJUCk7
CisJCWZyb250YnVmZmVyX2ZsdXNoKGk5MTUsIGZyb250YnVmZmVyX2JpdHMsIE9SSUdJTl9GTElQ
KTsKIH0KIAogLyoqCiAgKiBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwIC0gc3luY2hyb25vdXMgZnJv
bnRidWZmZXIgZmxpcAotICogQGRldl9wcml2OiBpOTE1IGRldmljZQorICogQGk5MTU6IGk5MTUg
ZGV2aWNlCiAgKiBAZnJvbnRidWZmZXJfYml0czogZnJvbnRidWZmZXIgcGxhbmUgdHJhY2tpbmcg
Yml0cwogICoKICAqIFRoaXMgZnVuY3Rpb24gZ2V0cyBjYWxsZWQgYWZ0ZXIgc2NoZWR1bGluZyBh
IGZsaXAgb24gQG9iai4gVGhpcyBpcyBmb3IKQEAgLTE4NywxMyArMTQ5LDE2MCBAQCB2b2lkIGlu
dGVsX2Zyb250YnVmZmVyX2ZsaXBfY29tcGxldGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAogICoKICAqIENhbiBiZSBjYWxsZWQgd2l0aG91dCBhbnkgbG9ja3MgaGVsZC4KICAq
Lwotdm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKK3ZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKIAkJCSAgICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzKQogewotCXNwaW5f
bG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOworCXNwaW5fbG9jaygmaTkxNS0+ZmJf
dHJhY2tpbmcubG9jayk7CiAJLyogUmVtb3ZlIHN0YWxlIGJ1c3kgYml0cyBkdWUgdG8gdGhlIG9s
ZCBidWZmZXIuICovCi0JZGV2X3ByaXYtPmZiX3RyYWNraW5nLmJ1c3lfYml0cyAmPSB+ZnJvbnRi
dWZmZXJfYml0czsKLQlzcGluX3VubG9jaygmZGV2X3ByaXYtPmZiX3RyYWNraW5nLmxvY2spOwor
CWk5MTUtPmZiX3RyYWNraW5nLmJ1c3lfYml0cyAmPSB+ZnJvbnRidWZmZXJfYml0czsKKwlzcGlu
X3VubG9jaygmaTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CiAKLQlpbnRlbF9mcm9udGJ1ZmZlcl9m
bHVzaChkZXZfcHJpdiwgZnJvbnRidWZmZXJfYml0cywgT1JJR0lOX0ZMSVApOworCWZyb250YnVm
ZmVyX2ZsdXNoKGk5MTUsIGZyb250YnVmZmVyX2JpdHMsIE9SSUdJTl9GTElQKTsKK30KKwordm9p
ZCBfX2ludGVsX2ZiX2ludmFsaWRhdGUoc3RydWN0IGludGVsX2Zyb250YnVmZmVyICpmcm9udCwK
KwkJCSAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbiwKKwkJCSAgIHVuc2lnbmVkIGludCBmcm9u
dGJ1ZmZlcl9iaXRzKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShmcm9udC0+b2JqLT5iYXNlLmRldik7CisKKwlpZiAob3JpZ2luID09IE9SSUdJTl9DUykgewor
CQlzcGluX2xvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOworCQlpOTE1LT5mYl90cmFja2lu
Zy5idXN5X2JpdHMgfD0gZnJvbnRidWZmZXJfYml0czsKKwkJaTkxNS0+ZmJfdHJhY2tpbmcuZmxp
cF9iaXRzICY9IH5mcm9udGJ1ZmZlcl9iaXRzOworCQlzcGluX3VubG9jaygmaTkxNS0+ZmJfdHJh
Y2tpbmcubG9jayk7CisJfQorCisJbWlnaHRfc2xlZXAoKTsKKwlpbnRlbF9wc3JfaW52YWxpZGF0
ZShpOTE1LCBmcm9udGJ1ZmZlcl9iaXRzLCBvcmlnaW4pOworCWludGVsX2VkcF9kcnJzX2ludmFs
aWRhdGUoaTkxNSwgZnJvbnRidWZmZXJfYml0cyk7CisJaW50ZWxfZmJjX2ludmFsaWRhdGUoaTkx
NSwgZnJvbnRidWZmZXJfYml0cywgb3JpZ2luKTsKK30KKwordm9pZCBfX2ludGVsX2ZiX2ZsdXNo
KHN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqZnJvbnQsCisJCSAgICAgIGVudW0gZmJfb3Bfb3Jp
Z2luIG9yaWdpbiwKKwkJICAgICAgdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMpCit7CisJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGZyb250LT5vYmotPmJhc2Uu
ZGV2KTsKKworCWlmIChvcmlnaW4gPT0gT1JJR0lOX0NTKSB7CisJCXNwaW5fbG9jaygmaTkxNS0+
ZmJfdHJhY2tpbmcubG9jayk7CisJCS8qIEZpbHRlciBvdXQgbmV3IGJpdHMgc2luY2UgcmVuZGVy
aW5nIHN0YXJ0ZWQuICovCisJCWZyb250YnVmZmVyX2JpdHMgJj0gaTkxNS0+ZmJfdHJhY2tpbmcu
YnVzeV9iaXRzOworCQlpOTE1LT5mYl90cmFja2luZy5idXN5X2JpdHMgJj0gfmZyb250YnVmZmVy
X2JpdHM7CisJCXNwaW5fdW5sb2NrKCZpOTE1LT5mYl90cmFja2luZy5sb2NrKTsKKwl9CisKKwlp
ZiAoZnJvbnRidWZmZXJfYml0cykKKwkJZnJvbnRidWZmZXJfZmx1c2goaTkxNSwgZnJvbnRidWZm
ZXJfYml0cywgb3JpZ2luKTsKK30KKworc3RhdGljIGludCBmcm9udGJ1ZmZlcl9hY3RpdmUoc3Ry
dWN0IGk5MTVfYWN0aXZlICpyZWYpCit7CisJc3RydWN0IGludGVsX2Zyb250YnVmZmVyICpmcm9u
dCA9CisJCWNvbnRhaW5lcl9vZihyZWYsIHR5cGVvZigqZnJvbnQpLCB3cml0ZSk7CisKKwlrcmVm
X2dldCgmZnJvbnQtPnJlZik7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGZyb250YnVm
ZmVyX3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKK3sKKwlzdHJ1Y3QgaW50ZWxfZnJv
bnRidWZmZXIgKmZyb250ID0KKwkJY29udGFpbmVyX29mKHJlZiwgdHlwZW9mKCpmcm9udCksIHdy
aXRlKTsKKworCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKGZyb250LCBPUklHSU5fQ1MpOworCWlu
dGVsX2Zyb250YnVmZmVyX3B1dChmcm9udCk7Cit9CisKK3N0YXRpYyB2b2lkIGZyb250YnVmZmVy
X3JlbGVhc2Uoc3RydWN0IGtyZWYgKnJlZikKK3sKKwlzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIg
KmZyb250ID0KKwkJY29udGFpbmVyX29mKHJlZiwgdHlwZW9mKCpmcm9udCksIHJlZik7CisKKwlm
cm9udC0+b2JqLT5mcm9udGJ1ZmZlciA9IE5VTEw7CisJc3Bpbl91bmxvY2soJnRvX2k5MTUoZnJv
bnQtPm9iai0+YmFzZS5kZXYpLT5mYl90cmFja2luZy5sb2NrKTsKKworCWk5MTVfZ2VtX29iamVj
dF9wdXQoZnJvbnQtPm9iaik7CisJa2ZyZWUoZnJvbnQpOworfQorCitzdHJ1Y3QgaW50ZWxfZnJv
bnRidWZmZXIgKgoraW50ZWxfZnJvbnRidWZmZXJfZ2V0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KG9i
ai0+YmFzZS5kZXYpOworCXN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqZnJvbnQ7CisKKwlzcGlu
X2xvY2soJmk5MTUtPmZiX3RyYWNraW5nLmxvY2spOworCWZyb250ID0gb2JqLT5mcm9udGJ1ZmZl
cjsKKwlpZiAoZnJvbnQpCisJCWtyZWZfZ2V0KCZmcm9udC0+cmVmKTsKKwlzcGluX3VubG9jaygm
aTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CisJaWYgKGZyb250KQorCQlyZXR1cm4gZnJvbnQ7CisK
Kwlmcm9udCA9IGttYWxsb2Moc2l6ZW9mKCpmcm9udCksIEdGUF9LRVJORUwpOworCWlmICghZnJv
bnQpCisJCXJldHVybiBOVUxMOworCisJZnJvbnQtPm9iaiA9IG9iajsKKwlrcmVmX2luaXQoJmZy
b250LT5yZWYpOworCWF0b21pY19zZXQoJmZyb250LT5iaXRzLCAwKTsKKwlpOTE1X2FjdGl2ZV9p
bml0KGk5MTUsICZmcm9udC0+d3JpdGUsCisJCQkgZnJvbnRidWZmZXJfYWN0aXZlLAorCQkJIGk5
MTVfYWN0aXZlX21heV9zbGVlcChmcm9udGJ1ZmZlcl9yZXRpcmUpKTsKKworCXNwaW5fbG9jaygm
aTkxNS0+ZmJfdHJhY2tpbmcubG9jayk7CisJaWYgKG9iai0+ZnJvbnRidWZmZXIpIHsKKwkJa2Zy
ZWUoZnJvbnQpOworCQlmcm9udCA9IG9iai0+ZnJvbnRidWZmZXI7CisJCWtyZWZfZ2V0KCZmcm9u
dC0+cmVmKTsKKwl9IGVsc2UgeworCQlpOTE1X2dlbV9vYmplY3RfZ2V0KG9iaik7CisJCW9iai0+
ZnJvbnRidWZmZXIgPSBmcm9udDsKKwl9CisJc3Bpbl91bmxvY2soJmk5MTUtPmZiX3RyYWNraW5n
LmxvY2spOworCisJcmV0dXJuIGZyb250OworfQorCit2b2lkIGludGVsX2Zyb250YnVmZmVyX3B1
dChzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250KQoreworCWtyZWZfcHV0X2xvY2soJmZy
b250LT5yZWYsCisJCSAgICAgIGZyb250YnVmZmVyX3JlbGVhc2UsCisJCSAgICAgICZ0b19pOTE1
KGZyb250LT5vYmotPmJhc2UuZGV2KS0+ZmJfdHJhY2tpbmcubG9jayk7Cit9CisKKy8qKgorICog
aW50ZWxfZnJvbnRidWZmZXJfdHJhY2sgLSB1cGRhdGUgZnJvbnRidWZmZXIgdHJhY2tpbmcKKyAq
IEBvbGQ6IGN1cnJlbnQgYnVmZmVyIGZvciB0aGUgZnJvbnRidWZmZXIgc2xvdHMKKyAqIEBuZXc6
IG5ldyBidWZmZXIgZm9yIHRoZSBmcm9udGJ1ZmZlciBzbG90cworICogQGZyb250YnVmZmVyX2Jp
dHM6IGJpdG1hc2sgb2YgZnJvbnRidWZmZXIgc2xvdHMKKyAqCisgKiBUaGlzIHVwZGF0ZXMgdGhl
IGZyb250YnVmZmVyIHRyYWNraW5nIGJpdHMgQGZyb250YnVmZmVyX2JpdHMgYnkgY2xlYXJpbmcg
dGhlbQorICogZnJvbSBAb2xkIGFuZCBzZXR0aW5nIHRoZW0gaW4gQG5ldy4gQm90aCBAb2xkIGFu
ZCBAbmV3IGNhbiBiZSBOVUxMLgorICovCit2b2lkIGludGVsX2Zyb250YnVmZmVyX3RyYWNrKHN0
cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqb2xkLAorCQkJICAgICBzdHJ1Y3QgaW50ZWxfZnJvbnRi
dWZmZXIgKm5ldywKKwkJCSAgICAgdW5zaWduZWQgaW50IGZyb250YnVmZmVyX2JpdHMpCit7CisJ
LyoKKwkgKiBDb250cm9sIG9mIGluZGl2aWR1YWwgYml0cyB3aXRoaW4gdGhlIG1hc2sgYXJlIGd1
YXJkZWQgYnkKKwkgKiB0aGUgb3duaW5nIHBsYW5lLT5tdXRleCwgaS5lLiB3ZSBjYW4gbmV2ZXIg
c2VlIGNvbmN1cnJlbnQKKwkgKiBtYW5pcHVsYXRpb24gb2YgaW5kaXZpZHVhbCBiaXRzLiBCdXQg
c2luY2UgdGhlIGJpdGZpZWxkIGFzIGEgd2hvbGUKKwkgKiBpcyB1cGRhdGVkIHVzaW5nIFJNVywg
d2UgbmVlZCB0byB1c2UgYXRvbWljcyBpbiBvcmRlciB0byB1cGRhdGUKKwkgKiB0aGUgYml0cy4K
KwkgKi8KKwlCVUlMRF9CVUdfT04oSU5URUxfRlJPTlRCVUZGRVJfQklUU19QRVJfUElQRSAqIEk5
MTVfTUFYX1BJUEVTID4KKwkJICAgICBCSVRTX1BFUl9UWVBFKGF0b21pY190KSk7CisKKwlpZiAo
b2xkKSB7CisJCVdBUk5fT04oIShhdG9taWNfcmVhZCgmb2xkLT5iaXRzKSAmIGZyb250YnVmZmVy
X2JpdHMpKTsKKwkJYXRvbWljX2FuZG5vdChmcm9udGJ1ZmZlcl9iaXRzLCAmb2xkLT5iaXRzKTsK
Kwl9CisKKwlpZiAobmV3KSB7CisJCVdBUk5fT04oYXRvbWljX3JlYWQoJm5ldy0+Yml0cykgJiBm
cm9udGJ1ZmZlcl9iaXRzKTsKKwkJYXRvbWljX29yKGZyb250YnVmZmVyX2JpdHMsICZuZXctPmJp
dHMpOworCX0KIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZnJvbnRidWZmZXIuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZnJv
bnRidWZmZXIuaAppbmRleCA1NzI3MzIwYzgwODQuLmFkYzY0ZDYxYTRhNSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mcm9udGJ1ZmZlci5oCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZnJvbnRidWZmZXIuaApAQCAtMjQsNyAr
MjQsMTAgQEAKICNpZm5kZWYgX19JTlRFTF9GUk9OVEJVRkZFUl9IX18KICNkZWZpbmUgX19JTlRF
TF9GUk9OVEJVRkZFUl9IX18KIAotI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9vYmplY3QuaCIKKyNp
bmNsdWRlIDxsaW51eC9hdG9taWMuaD4KKyNpbmNsdWRlIDxsaW51eC9rcmVmLmg+CisKKyNpbmNs
dWRlICJpOTE1X2FjdGl2ZS5oIgogCiBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKIHN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0OwpAQCAtMzcsMjMgKzQwLDMwIEBAIGVudW0gZmJfb3Bfb3JpZ2lu
IHsKIAlPUklHSU5fRElSVFlGQiwKIH07CiAKLXZvaWQgaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9w
cmVwYXJlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKK3N0cnVjdCBpbnRlbF9m
cm9udGJ1ZmZlciB7CisJc3RydWN0IGtyZWYgcmVmOworCWF0b21pY190IGJpdHM7CisJc3RydWN0
IGk5MTVfYWN0aXZlIHdyaXRlOworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Cit9
OworCit2b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXBfcHJlcGFyZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKIAkJCQkgICAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0cyk7Ci12b2lk
IGludGVsX2Zyb250YnVmZmVyX2ZsaXBfY29tcGxldGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAordm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwX2NvbXBsZXRlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJCSAgICAgdW5zaWduZWQgZnJvbnRidWZmZXJfYml0
cyk7Ci12b2lkIGludGVsX2Zyb250YnVmZmVyX2ZsaXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LAordm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl9mbGlwKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAogCQkJICAgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMpOwogCi12b2lk
IF9faW50ZWxfZmJfb2JqX2ludmFsaWRhdGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aiwKLQkJCSAgICAgICBlbnVtIGZiX29wX29yaWdpbiBvcmlnaW4sCi0JCQkgICAgICAgdW5zaWdu
ZWQgaW50IGZyb250YnVmZmVyX2JpdHMpOwotdm9pZCBfX2ludGVsX2ZiX29ial9mbHVzaChzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAotCQkJICBlbnVtIGZiX29wX29yaWdpbiBvcmln
aW4sCi0JCQkgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzKTsKK3N0cnVjdCBpbnRlbF9m
cm9udGJ1ZmZlciAqCitpbnRlbF9mcm9udGJ1ZmZlcl9nZXQoc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaik7CisKK3ZvaWQgX19pbnRlbF9mYl9pbnZhbGlkYXRlKHN0cnVjdCBpbnRlbF9m
cm9udGJ1ZmZlciAqZnJvbnQsCisJCQkgICBlbnVtIGZiX29wX29yaWdpbiBvcmlnaW4sCisJCQkg
ICB1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0cyk7CiAKIC8qKgotICogaW50ZWxfZmJfb2Jq
X2ludmFsaWRhdGUgLSBpbnZhbGlkYXRlIGZyb250YnVmZmVyIG9iamVjdAotICogQG9iajogR0VN
IG9iamVjdCB0byBpbnZhbGlkYXRlCisgKiBpbnRlbF9mcm9udGJ1ZmZlcl9pbnZhbGlkYXRlIC0g
aW52YWxpZGF0ZSBmcm9udGJ1ZmZlciBvYmplY3QKKyAqIEBmcm9udDogR0VNIG9iamVjdCB0byBp
bnZhbGlkYXRlCiAgKiBAb3JpZ2luOiB3aGljaCBvcGVyYXRpb24gY2F1c2VkIHRoZSBpbnZhbGlk
YXRpb24KICAqCiAgKiBUaGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIGV2ZXJ5IHRpbWUgcmVuZGVy
aW5nIG9uIHRoZSBnaXZlbiBvYmplY3Qgc3RhcnRzIGFuZApAQCAtNjIsMzcgKzcyLDUzIEBAIHZv
aWQgX19pbnRlbF9mYl9vYmpfZmx1c2goc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwK
ICAqIHVudGlsIHRoZSByZW5kZXJpbmcgY29tcGxldGVzIG9yIGEgZmxpcCBvbiB0aGlzIGZyb250
YnVmZmVyIHBsYW5lIGlzCiAgKiBzY2hlZHVsZWQuCiAgKi8KLXN0YXRpYyBpbmxpbmUgYm9vbCBp
bnRlbF9mYl9vYmpfaW52YWxpZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAot
CQkJCQkgICBlbnVtIGZiX29wX29yaWdpbiBvcmlnaW4pCitzdGF0aWMgaW5saW5lIGJvb2wgaW50
ZWxfZnJvbnRidWZmZXJfaW52YWxpZGF0ZShzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250
LAorCQkJCQkJZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luKQogewogCXVuc2lnbmVkIGludCBmcm9u
dGJ1ZmZlcl9iaXRzOwogCi0JZnJvbnRidWZmZXJfYml0cyA9IGF0b21pY19yZWFkKCZvYmotPmZy
b250YnVmZmVyX2JpdHMpOworCWlmICghZnJvbnQpCisJCXJldHVybiBmYWxzZTsKKworCWZyb250
YnVmZmVyX2JpdHMgPSBhdG9taWNfcmVhZCgmZnJvbnQtPmJpdHMpOwogCWlmICghZnJvbnRidWZm
ZXJfYml0cykKIAkJcmV0dXJuIGZhbHNlOwogCi0JX19pbnRlbF9mYl9vYmpfaW52YWxpZGF0ZShv
YmosIG9yaWdpbiwgZnJvbnRidWZmZXJfYml0cyk7CisJX19pbnRlbF9mYl9pbnZhbGlkYXRlKGZy
b250LCBvcmlnaW4sIGZyb250YnVmZmVyX2JpdHMpOwogCXJldHVybiB0cnVlOwogfQogCit2b2lk
IF9faW50ZWxfZmJfZmx1c2goc3RydWN0IGludGVsX2Zyb250YnVmZmVyICpmcm9udCwKKwkJICAg
ICAgZW51bSBmYl9vcF9vcmlnaW4gb3JpZ2luLAorCQkgICAgICB1bnNpZ25lZCBpbnQgZnJvbnRi
dWZmZXJfYml0cyk7CisKIC8qKgotICogaW50ZWxfZmJfb2JqX2ZsdXNoIC0gZmx1c2ggZnJvbnRi
dWZmZXIgb2JqZWN0Ci0gKiBAb2JqOiBHRU0gb2JqZWN0IHRvIGZsdXNoCisgKiBpbnRlbF9mcm9u
dGJ1ZmZlcl9mbHVzaCAtIGZsdXNoIGZyb250YnVmZmVyIG9iamVjdAorICogQGZyb250OiBHRU0g
b2JqZWN0IHRvIGZsdXNoCiAgKiBAb3JpZ2luOiB3aGljaCBvcGVyYXRpb24gY2F1c2VkIHRoZSBm
bHVzaAogICoKICAqIFRoaXMgZnVuY3Rpb24gZ2V0cyBjYWxsZWQgZXZlcnkgdGltZSByZW5kZXJp
bmcgb24gdGhlIGdpdmVuIG9iamVjdCBoYXMKICAqIGNvbXBsZXRlZCBhbmQgZnJvbnRidWZmZXIg
Y2FjaGluZyBjYW4gYmUgc3RhcnRlZCBhZ2Fpbi4KICAqLwotc3RhdGljIGlubGluZSB2b2lkIGlu
dGVsX2ZiX29ial9mbHVzaChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAotCQkJCSAg
ICAgIGVudW0gZmJfb3Bfb3JpZ2luIG9yaWdpbikKK3N0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9m
cm9udGJ1ZmZlcl9mbHVzaChzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250LAorCQkJCQkg
ICBlbnVtIGZiX29wX29yaWdpbiBvcmlnaW4pCiB7CiAJdW5zaWduZWQgaW50IGZyb250YnVmZmVy
X2JpdHM7CiAKLQlmcm9udGJ1ZmZlcl9iaXRzID0gYXRvbWljX3JlYWQoJm9iai0+ZnJvbnRidWZm
ZXJfYml0cyk7CisJaWYgKCFmcm9udCkKKwkJcmV0dXJuOworCisJZnJvbnRidWZmZXJfYml0cyA9
IGF0b21pY19yZWFkKCZmcm9udC0+Yml0cyk7CiAJaWYgKCFmcm9udGJ1ZmZlcl9iaXRzKQogCQly
ZXR1cm47CiAKLQlfX2ludGVsX2ZiX29ial9mbHVzaChvYmosIG9yaWdpbiwgZnJvbnRidWZmZXJf
Yml0cyk7CisJX19pbnRlbF9mYl9mbHVzaChmcm9udCwgb3JpZ2luLCBmcm9udGJ1ZmZlcl9iaXRz
KTsKIH0KIAordm9pZCBpbnRlbF9mcm9udGJ1ZmZlcl90cmFjayhzdHJ1Y3QgaW50ZWxfZnJvbnRi
dWZmZXIgKm9sZCwKKwkJCSAgICAgc3RydWN0IGludGVsX2Zyb250YnVmZmVyICpuZXcsCisJCQkg
ICAgIHVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9iaXRzKTsKKwordm9pZCBpbnRlbF9mcm9udGJ1
ZmZlcl9wdXQoc3RydWN0IGludGVsX2Zyb250YnVmZmVyICpmcm9udCk7CisKICNlbmRpZiAvKiBf
X0lOVEVMX0ZST05UQlVGRkVSX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9vdmVybGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX292ZXJsYXkuYwppbmRleCBjN2QyZDk4MGRmOGMuLmYwNzQzYWY3OWZjYiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9vdmVybGF5LmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9vdmVybGF5LmMKQEAgLTI4MSw5ICsy
ODEsOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9vdmVybGF5X2ZsaXBfcHJlcGFyZShzdHJ1Y3QgaW50
ZWxfb3ZlcmxheSAqb3ZlcmxheSwKIAogCVdBUk5fT04ob3ZlcmxheS0+b2xkX3ZtYSk7CiAKLQlp
OTE1X2dlbV90cmFja19mYihvdmVybGF5LT52bWEgPyBvdmVybGF5LT52bWEtPm9iaiA6IE5VTEws
Ci0JCQkgIHZtYSA/IHZtYS0+b2JqIDogTlVMTCwKLQkJCSAgSU5URUxfRlJPTlRCVUZGRVJfT1ZF
UkxBWShwaXBlKSk7CisJaW50ZWxfZnJvbnRidWZmZXJfdHJhY2sob3ZlcmxheS0+dm1hID8gb3Zl
cmxheS0+dm1hLT5vYmotPmZyb250YnVmZmVyIDogTlVMTCwKKwkJCQl2bWEgPyB2bWEtPm9iai0+
ZnJvbnRidWZmZXIgOiBOVUxMLAorCQkJCUlOVEVMX0ZST05UQlVGRkVSX09WRVJMQVkocGlwZSkp
OwogCiAJaW50ZWxfZnJvbnRidWZmZXJfZmxpcF9wcmVwYXJlKG92ZXJsYXktPmk5MTUsCiAJCQkJ
ICAgICAgIElOVEVMX0ZST05UQlVGRkVSX09WRVJMQVkocGlwZSkpOwpAQCAtNzY4LDcgKzc2OCw3
IEBAIHN0YXRpYyBpbnQgaW50ZWxfb3ZlcmxheV9kb19wdXRfaW1hZ2Uoc3RydWN0IGludGVsX292
ZXJsYXkgKm92ZXJsYXksCiAJCXJldCA9IFBUUl9FUlIodm1hKTsKIAkJZ290byBvdXRfcGluX3Nl
Y3Rpb247CiAJfQotCWludGVsX2ZiX29ial9mbHVzaChuZXdfYm8sIE9SSUdJTl9ESVJUWUZCKTsK
KwlpbnRlbF9mcm9udGJ1ZmZlcl9mbHVzaChuZXdfYm8tPmZyb250YnVmZmVyLCBPUklHSU5fRElS
VFlGQik7CiAKIAlyZXQgPSBpOTE1X3ZtYV9wdXRfZmVuY2Uodm1hKTsKIAlpZiAocmV0KQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsZmx1c2guYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGZsdXNoLmMKaW5kZXggOTAxOGUxMmI1
MzZiLi4zMzM0YjNjNmM2ZWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9jbGZsdXNoLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2NsZmx1c2guYwpAQCAtNDgsNyArNDgsNyBAQCBzdGF0aWMgdm9pZCBfX2k5MTVfZG9fY2xmbHVz
aChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewogCUdFTV9CVUdfT04oIWk5MTVf
Z2VtX29iamVjdF9oYXNfcGFnZXMob2JqKSk7CiAJZHJtX2NsZmx1c2hfc2cob2JqLT5tbS5wYWdl
cyk7Ci0JaW50ZWxfZmJfb2JqX2ZsdXNoKG9iaiwgT1JJR0lOX0NQVSk7CisJaW50ZWxfZnJvbnRi
dWZmZXJfZmx1c2gob2JqLT5mcm9udGJ1ZmZlciwgT1JJR0lOX0NQVSk7CiB9CiAKIHN0YXRpYyB2
b2lkIGk5MTVfY2xmbHVzaF93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4uYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4uYwppbmRleCAyZTNjZTJhNjk2NTMuLmEx
YWZjMjY5MGU5ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2RvbWFpbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4u
YwpAQCAtNTUxLDEzICs1NTEsNiBAQCBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX2NwdV9kb21haW4o
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwgYm9vbCB3cml0ZSkKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGlubGluZSBlbnVtIGZiX29wX29yaWdpbgotZmJfd3JpdGVfb3JpZ2luKHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosIHVuc2lnbmVkIGludCBkb21haW4pCi17Ci0J
cmV0dXJuIChkb21haW4gPT0gSTkxNV9HRU1fRE9NQUlOX0dUVCA/Ci0JCW9iai0+ZnJvbnRidWZm
ZXJfZ2d0dF9vcmlnaW4gOiBPUklHSU5fQ1BVKTsKLX0KLQogLyoqCiAgKiBDYWxsZWQgd2hlbiB1
c2VyIHNwYWNlIHByZXBhcmVzIHRvIHVzZSBhbiBvYmplY3Qgd2l0aCB0aGUgQ1BVLCBlaXRoZXIK
ICAqIHRocm91Z2ggdGhlIG1tYXAgaW9jdGwncyBtYXBwaW5nIG9yIGEgR1RUIG1hcHBpbmcuCkBA
IC02NjEsOSArNjU0LDggQEAgaTkxNV9nZW1fc2V0X2RvbWFpbl9pb2N0bChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCB2b2lkICpkYXRhLAogCiAJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmopOwog
Ci0JaWYgKHdyaXRlX2RvbWFpbiAhPSAwKQotCQlpbnRlbF9mYl9vYmpfaW52YWxpZGF0ZShvYmos
Ci0JCQkJCWZiX3dyaXRlX29yaWdpbihvYmosIHdyaXRlX2RvbWFpbikpOworCWlmICh3cml0ZV9k
b21haW4pCisJCWludGVsX2Zyb250YnVmZmVyX2ludmFsaWRhdGUob2JqLT5mcm9udGJ1ZmZlciwg
T1JJR0lOX0NQVSk7CiAKIG91dF91bnBpbjoKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMo
b2JqKTsKQEAgLTc4Myw3ICs3NzUsNyBAQCBpbnQgaTkxNV9nZW1fb2JqZWN0X3ByZXBhcmVfd3Jp
dGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAl9CiAKIG91dDoKLQlpbnRlbF9m
Yl9vYmpfaW52YWxpZGF0ZShvYmosIE9SSUdJTl9DUFUpOworCWludGVsX2Zyb250YnVmZmVyX2lu
dmFsaWRhdGUob2JqLT5mcm9udGJ1ZmZlciwgT1JJR0lOX0NQVSk7CiAJb2JqLT5tbS5kaXJ0eSA9
IHRydWU7CiAJLyogcmV0dXJuIHdpdGggdGhlIHBhZ2VzIHBpbm5lZCAqLwogCXJldHVybiAwOwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMKaW5kZXggMzkxNjIxZWUzY2Ji
Li5iY2M1M2MyYjRmNjkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9tbWFuLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4u
YwpAQCAtOTksOSArOTksNiBAQCBpOTE1X2dlbV9tbWFwX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYsIHZvaWQgKmRhdGEsCiAJCXVwX3dyaXRlKCZtbS0+bW1hcF9zZW0pOwogCQlpZiAoSVNf
RVJSX1ZBTFVFKGFkZHIpKQogCQkJZ290byBlcnI7Ci0KLQkJLyogVGhpcyBtYXkgcmFjZSwgYnV0
IHRoYXQncyBvaywgaXQgb25seSBnZXRzIHNldCAqLwotCQlXUklURV9PTkNFKG9iai0+ZnJvbnRi
dWZmZXJfZ2d0dF9vcmlnaW4sIE9SSUdJTl9DUFUpOwogCX0KIAlpOTE1X2dlbV9vYmplY3RfcHV0
KG9iaik7CiAKQEAgLTI4MSw3ICsyNzgsNiBAQCB2bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0
cnVjdCB2bV9mYXVsdCAqdm1mKQogCQkgKiBVc2Vyc3BhY2UgaXMgbm93IHdyaXRpbmcgdGhyb3Vn
aCBhbiB1bnRyYWNrZWQgVk1BLCBhYmFuZG9uCiAJCSAqIGFsbCBob3BlIHRoYXQgdGhlIGhhcmR3
YXJlIGlzIGFibGUgdG8gdHJhY2sgZnV0dXJlIHdyaXRlcy4KIAkJICovCi0JCW9iai0+ZnJvbnRi
dWZmZXJfZ2d0dF9vcmlnaW4gPSBPUklHSU5fQ1BVOwogCiAJCXZtYSA9IGk5MTVfZ2VtX29iamVj
dF9nZ3R0X3BpbihvYmosICZ2aWV3LCAwLCAwLCBmbGFncyk7CiAJCWlmIChJU19FUlIodm1hKSAm
JiAhdmlldy50eXBlKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0
LmMKaW5kZXggMGExMDViYzI5NDk0Li44YjI3ZjE5M2Q1ZjkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKQEAgLTQ1LDE2ICs0NSw2IEBAIHZvaWQgaTkxNV9n
ZW1fb2JqZWN0X2ZyZWUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAlyZXR1cm4g
a21lbV9jYWNoZV9mcmVlKGdsb2JhbC5zbGFiX29iamVjdHMsIG9iaik7CiB9CiAKLXN0YXRpYyB2
b2lkCi1mcm9udGJ1ZmZlcl9yZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2
ZSwKLQkJICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCkKLXsKLQlzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqID0KLQkJY29udGFpbmVyX29mKGFjdGl2ZSwgdHlwZW9mKCpvYmop
LCBmcm9udGJ1ZmZlcl93cml0ZSk7Ci0KLQlpbnRlbF9mYl9vYmpfZmx1c2gob2JqLCBPUklHSU5f
Q1MpOwotfQotCiB2b2lkIGk5MTVfZ2VtX29iamVjdF9pbml0KHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmosCiAJCQkgIGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0X29wcyAq
b3BzKQogewpAQCAtNzMsMTAgKzYzLDYgQEAgdm9pZCBpOTE1X2dlbV9vYmplY3RfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCXJlc2VydmF0aW9uX29iamVjdF9pbml0KCZv
YmotPl9fYnVpbHRpbl9yZXN2KTsKIAlvYmotPnJlc3YgPSAmb2JqLT5fX2J1aWx0aW5fcmVzdjsK
IAotCW9iai0+ZnJvbnRidWZmZXJfZ2d0dF9vcmlnaW4gPSBPUklHSU5fR1RUOwotCWk5MTVfYWN0
aXZlX3JlcXVlc3RfaW5pdCgmb2JqLT5mcm9udGJ1ZmZlcl93cml0ZSwKLQkJCQkgTlVMTCwgZnJv
bnRidWZmZXJfcmV0aXJlKTsKLQogCW9iai0+bW0ubWFkdiA9IEk5MTVfTUFEVl9XSUxMTkVFRDsK
IAlJTklUX1JBRElYX1RSRUUoJm9iai0+bW0uZ2V0X3BhZ2UucmFkaXgsIEdGUF9LRVJORUwgfCBf
X0dGUF9OT1dBUk4pOwogCW11dGV4X2luaXQoJm9iai0+bW0uZ2V0X3BhZ2UubG9jayk7CkBAIC0x
OTEsNyArMTc3LDYgQEAgc3RhdGljIHZvaWQgX19pOTE1X2dlbV9mcmVlX29iamVjdHMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAKIAkJR0VNX0JVR19PTihhdG9taWNfcmVhZCgmb2Jq
LT5iaW5kX2NvdW50KSk7CiAJCUdFTV9CVUdfT04ob2JqLT51c2VyZmF1bHRfY291bnQpOwotCQlH
RU1fQlVHX09OKGF0b21pY19yZWFkKCZvYmotPmZyb250YnVmZmVyX2JpdHMpKTsKIAkJR0VNX0JV
R19PTighbGlzdF9lbXB0eSgmb2JqLT5sdXRfbGlzdCkpOwogCiAJCWlmIChvYmotPm9wcy0+cmVs
ZWFzZSkKQEAgLTI5NSw2ICsyODAsOCBAQCB2b2lkIGk5MTVfZ2VtX2ZyZWVfb2JqZWN0KHN0cnVj
dCBkcm1fZ2VtX29iamVjdCAqZ2VtX29iaikKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqID0gdG9faW50ZWxfYm8oZ2VtX29iaik7CiAKKwlHRU1fQlVHX09OKGk5MTVfZ2VtX29i
amVjdF9pc19mcmFtZWJ1ZmZlcihvYmopKTsKKwogCS8qCiAJICogQmVmb3JlIHdlIGZyZWUgdGhl
IG9iamVjdCwgbWFrZSBzdXJlIGFueSBwdXJlIFJDVS1vbmx5CiAJICogcmVhZC1zaWRlIGNyaXRp
Y2FsIHNlY3Rpb25zIGFyZSBjb21wbGV0ZSwgZS5nLgpAQCAtMzA1LDEzICsyOTIsNiBAQCB2b2lk
IGk5MTVfZ2VtX2ZyZWVfb2JqZWN0KHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ2VtX29iaikKIAlj
YWxsX3JjdSgmb2JqLT5yY3UsIF9faTkxNV9nZW1fZnJlZV9vYmplY3RfcmN1KTsKIH0KIAotc3Rh
dGljIGlubGluZSBlbnVtIGZiX29wX29yaWdpbgotZmJfd3JpdGVfb3JpZ2luKHN0cnVjdCBkcm1f
aTkxNV9nZW1fb2JqZWN0ICpvYmosIHVuc2lnbmVkIGludCBkb21haW4pCi17Ci0JcmV0dXJuIChk
b21haW4gPT0gSTkxNV9HRU1fRE9NQUlOX0dUVCA/Ci0JCW9iai0+ZnJvbnRidWZmZXJfZ2d0dF9v
cmlnaW4gOiBPUklHSU5fQ1BVKTsKLX0KLQogc3RhdGljIGJvb2wgZ3B1X3dyaXRlX25lZWRzX2Ns
Zmx1c2goc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIHsKIAlyZXR1cm4gIShvYmot
PmNhY2hlX2xldmVsID09IEk5MTVfQ0FDSEVfTk9ORSB8fApAQCAtMzMzLDkgKzMxMyw3IEBAIGk5
MTVfZ2VtX29iamVjdF9mbHVzaF93cml0ZV9kb21haW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaiwKIAlzd2l0Y2ggKG9iai0+d3JpdGVfZG9tYWluKSB7CiAJY2FzZSBJOTE1X0dFTV9E
T01BSU5fR1RUOgogCQlpOTE1X2dlbV9mbHVzaF9nZ3R0X3dyaXRlcyhkZXZfcHJpdik7Ci0KLQkJ
aW50ZWxfZmJfb2JqX2ZsdXNoKG9iaiwKLQkJCQkgICBmYl93cml0ZV9vcmlnaW4ob2JqLCBJOTE1
X0dFTV9ET01BSU5fR1RUKSk7CisJCWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKG9iai0+ZnJvbnRi
dWZmZXIsIE9SSUdJTl9DUFUpOwogCiAJCWZvcl9lYWNoX2dndHRfdm1hKHZtYSwgb2JqKSB7CiAJ
CQlpZiAodm1hLT5pb21hcCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmpl
Y3QuaAppbmRleCA0NTRiZmI0OTgwMDEuLjY3ZDcwZDE0NGJkOSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaApAQCAtMTYxLDcgKzE2MSw3IEBAIGk5MTVfZ2Vt
X29iamVjdF9uZWVkc19hc3luY19jYW5jZWwoY29uc3Qgc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaikKIHN0YXRpYyBpbmxpbmUgYm9vbAogaTkxNV9nZW1fb2JqZWN0X2lzX2ZyYW1lYnVm
ZmVyKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiB7Ci0JcmV0dXJuIFJF
QURfT05DRShvYmotPmZyYW1lYnVmZmVyX3JlZmVyZW5jZXMpOworCXJldHVybiBSRUFEX09OQ0Uo
b2JqLT5mcm9udGJ1ZmZlcik7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgKaW5kZXgg
YzI5OWZlZDJjNmIxLi4yMWJmYjdiZDBmNTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgKQEAgLTE1LDYgKzE1LDcgQEAKICNpbmNsdWRl
ICJpOTE1X3NlbGZ0ZXN0LmgiCiAKIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0Oworc3RydWN0
IGludGVsX2Zyb25idWZmZXI7CiAKIC8qCiAgKiBzdHJ1Y3QgaTkxNV9sdXRfaGFuZGxlIHRyYWNr
cyB0aGUgZmFzdCBsb29rdXBzIGZyb20gaGFuZGxlIHRvIHZtYSB1c2VkCkBAIC0xNDQsOSArMTQ1
LDcgQEAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgewogCSAqLwogCXUxNiB3cml0ZV9kb21h
aW47CiAKLQlhdG9taWNfdCBmcm9udGJ1ZmZlcl9iaXRzOwotCXVuc2lnbmVkIGludCBmcm9udGJ1
ZmZlcl9nZ3R0X29yaWdpbjsgLyogd3JpdGUgb25jZSAqLwotCXN0cnVjdCBpOTE1X2FjdGl2ZV9y
ZXF1ZXN0IGZyb250YnVmZmVyX3dyaXRlOworCXN0cnVjdCBpbnRlbF9mcm9udGJ1ZmZlciAqZnJv
bnRidWZmZXI7CiAKIAkvKiogQ3VycmVudCB0aWxpbmcgc3RyaWRlIGZvciB0aGUgb2JqZWN0LCBp
ZiBpdCdzIHRpbGVkLiAqLwogCXVuc2lnbmVkIGludCB0aWxpbmdfYW5kX3N0cmlkZTsKQEAgLTIz
OSw5ICsyMzgsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCB7CiAJICovCiAJc3RydWN0
IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdjsKIAotCS8qKiBSZWZlcmVuY2VzIGZyb20gZnJhbWVi
dWZmZXJzLCBsb2NrcyBvdXQgdGlsaW5nIGNoYW5nZXMuICovCi0JdW5zaWduZWQgaW50IGZyYW1l
YnVmZmVyX3JlZmVyZW5jZXM7Ci0KIAkvKiogUmVjb3JkIG9mIGFkZHJlc3MgYml0IDE3IG9mIGVh
Y2ggcGFnZSBhdCBsYXN0IHVuYmluZC4gKi8KIAl1bnNpZ25lZCBsb25nICpiaXRfMTc7CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggMmM4NTgwZjM3NWZiLi4wNmIzMTQ3ZDgx
ZjcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC0xMzYsNyArMTM2LDYgQEAg
ZGVzY3JpYmVfb2JqKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaikKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KG9i
ai0+YmFzZS5kZXYpOwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKIAlzdHJ1Y3Qg
aTkxNV92bWEgKnZtYTsKLQl1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0czsKIAlpbnQgcGlu
X2NvdW50ID0gMDsKIAogCXNlcV9wcmludGYobSwgIiVwSzogJWMlYyVjJWMgJTh6ZEtpQiAlMDJ4
ICUwMnggJXMlcyVzIiwKQEAgLTIyNiwxMCArMjI1LDYgQEAgZGVzY3JpYmVfb2JqKHN0cnVjdCBz
ZXFfZmlsZSAqbSwgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAllbmdpbmUgPSBp
OTE1X2dlbV9vYmplY3RfbGFzdF93cml0ZV9lbmdpbmUob2JqKTsKIAlpZiAoZW5naW5lKQogCQlz
ZXFfcHJpbnRmKG0sICIgKCVzKSIsIGVuZ2luZS0+bmFtZSk7Ci0KLQlmcm9udGJ1ZmZlcl9iaXRz
ID0gYXRvbWljX3JlYWQoJm9iai0+ZnJvbnRidWZmZXJfYml0cyk7Ci0JaWYgKGZyb250YnVmZmVy
X2JpdHMpCi0JCXNlcV9wcmludGYobSwgIiAoZnJvbnRidWZmZXI6IDB4JTAzeCkiLCBmcm9udGJ1
ZmZlcl9iaXRzKTsKIH0KIAogc3RydWN0IGZpbGVfc3RhdHMgewpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2
LmgKaW5kZXggNTk2OWM4M2QzYmE4Li4zYWY1NDBlNDY2ZDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
cnYuaApAQCAtMjUzOSwxMCArMjUzOSw2IEBAIGludCBpOTE1X2dlbV9tbWFwX2d0dChzdHJ1Y3Qg
ZHJtX2ZpbGUgKmZpbGVfcHJpdiwgc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJICAgICAgdTMy
IGhhbmRsZSwgdTY0ICpvZmZzZXQpOwogaW50IGk5MTVfZ2VtX21tYXBfZ3R0X3ZlcnNpb24odm9p
ZCk7CiAKLXZvaWQgaTkxNV9nZW1fdHJhY2tfZmIoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9sZCwKLQkJICAgICAgIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpuZXcsCi0JCSAgICAg
ICB1bnNpZ25lZCBmcm9udGJ1ZmZlcl9iaXRzKTsKLQogaW50IF9fbXVzdF9jaGVjayBpOTE1X2dl
bV9zZXRfZ2xvYmFsX3NlcW5vKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHUzMiBzZXFubyk7CiAK
IHN0YXRpYyBpbmxpbmUgYm9vbCBfX2k5MTVfd2VkZ2VkKHN0cnVjdCBpOTE1X2dwdV9lcnJvciAq
ZXJyb3IpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwppbmRleCAxOTBhZDU0ZmIwNzIuLmIxZTRkYjI1
Zjk0ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCkBAIC0xMzQsMTcgKzEzNCwxOSBAQCBpOTE1
X2dlbV9waHlzX3B3cml0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCXZvaWQg
KnZhZGRyID0gb2JqLT5waHlzX2hhbmRsZS0+dmFkZHIgKyBhcmdzLT5vZmZzZXQ7CiAJY2hhciBf
X3VzZXIgKnVzZXJfZGF0YSA9IHU2NF90b191c2VyX3B0cihhcmdzLT5kYXRhX3B0cik7CiAKLQkv
KiBXZSBtYW51YWxseSBjb250cm9sIHRoZSBkb21haW4gaGVyZSBhbmQgcHJldGVuZCB0aGF0IGl0
CisJLyoKKwkgKiBXZSBtYW51YWxseSBjb250cm9sIHRoZSBkb21haW4gaGVyZSBhbmQgcHJldGVu
ZCB0aGF0IGl0CiAJICogcmVtYWlucyBjb2hlcmVudCBpLmUuIGluIHRoZSBHVFQgZG9tYWluLCBs
aWtlIHNobWVtX3B3cml0ZS4KIAkgKi8KLQlpbnRlbF9mYl9vYmpfaW52YWxpZGF0ZShvYmosIE9S
SUdJTl9DUFUpOworCWludGVsX2Zyb250YnVmZmVyX2ludmFsaWRhdGUob2JqLT5mcm9udGJ1ZmZl
ciwgT1JJR0lOX0NQVSk7CisKIAlpZiAoY29weV9mcm9tX3VzZXIodmFkZHIsIHVzZXJfZGF0YSwg
YXJncy0+c2l6ZSkpCiAJCXJldHVybiAtRUZBVUxUOwogCiAJZHJtX2NsZmx1c2hfdmlydF9yYW5n
ZSh2YWRkciwgYXJncy0+c2l6ZSk7CiAJaTkxNV9nZW1fY2hpcHNldF9mbHVzaCh0b19pOTE1KG9i
ai0+YmFzZS5kZXYpKTsKIAotCWludGVsX2ZiX29ial9mbHVzaChvYmosIE9SSUdJTl9DUFUpOwor
CWludGVsX2Zyb250YnVmZmVyX2ZsdXNoKG9iai0+ZnJvbnRidWZmZXIsIE9SSUdJTl9DUFUpOwog
CXJldHVybiAwOwogfQogCkBAIC02MzIsNyArNjM0LDcgQEAgaTkxNV9nZW1fZ3R0X3B3cml0ZV9m
YXN0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCWdvdG8gb3V0X3VucGluOwog
CX0KIAotCWludGVsX2ZiX29ial9pbnZhbGlkYXRlKG9iaiwgT1JJR0lOX0NQVSk7CisJaW50ZWxf
ZnJvbnRidWZmZXJfaW52YWxpZGF0ZShvYmotPmZyb250YnVmZmVyLCBPUklHSU5fQ1BVKTsKIAog
CXVzZXJfZGF0YSA9IHU2NF90b191c2VyX3B0cihhcmdzLT5kYXRhX3B0cik7CiAJb2Zmc2V0ID0g
YXJncy0+b2Zmc2V0OwpAQCAtNjczLDcgKzY3NSw3IEBAIGk5MTVfZ2VtX2d0dF9wd3JpdGVfZmFz
dChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCQl1c2VyX2RhdGEgKz0gcGFnZV9s
ZW5ndGg7CiAJCW9mZnNldCArPSBwYWdlX2xlbmd0aDsKIAl9Ci0JaW50ZWxfZmJfb2JqX2ZsdXNo
KG9iaiwgT1JJR0lOX0NQVSk7CisJaW50ZWxfZnJvbnRidWZmZXJfZmx1c2gob2JqLT5mcm9udGJ1
ZmZlciwgT1JJR0lOX0NQVSk7CiAKIAlpOTE1X2dlbV9vYmplY3RfdW5sb2NrX2ZlbmNlKG9iaiwg
ZmVuY2UpOwogb3V0X3VucGluOgpAQCAtNzY2LDcgKzc2OCw3IEBAIGk5MTVfZ2VtX3NobWVtX3B3
cml0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCQlvZmZzZXQgPSAwOwogCX0K
IAotCWludGVsX2ZiX29ial9mbHVzaChvYmosIE9SSUdJTl9DUFUpOworCWludGVsX2Zyb250YnVm
ZmVyX2ZsdXNoKG9iai0+ZnJvbnRidWZmZXIsIE9SSUdJTl9DUFUpOwogCWk5MTVfZ2VtX29iamVj
dF91bmxvY2tfZmVuY2Uob2JqLCBmZW5jZSk7CiAKIAlyZXR1cm4gcmV0OwpAQCAtMTg3MiwzOSAr
MTg3NCw2IEBAIGludCBpOTE1X2dlbV9vcGVuKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCiAJcmV0dXJuIHJldDsKIH0KIAotLyoqCi0gKiBpOTE1
X2dlbV90cmFja19mYiAtIHVwZGF0ZSBmcm9udGJ1ZmZlciB0cmFja2luZwotICogQG9sZDogY3Vy
cmVudCBHRU0gYnVmZmVyIGZvciB0aGUgZnJvbnRidWZmZXIgc2xvdHMKLSAqIEBuZXc6IG5ldyBH
RU0gYnVmZmVyIGZvciB0aGUgZnJvbnRidWZmZXIgc2xvdHMKLSAqIEBmcm9udGJ1ZmZlcl9iaXRz
OiBiaXRtYXNrIG9mIGZyb250YnVmZmVyIHNsb3RzCi0gKgotICogVGhpcyB1cGRhdGVzIHRoZSBm
cm9udGJ1ZmZlciB0cmFja2luZyBiaXRzIEBmcm9udGJ1ZmZlcl9iaXRzIGJ5IGNsZWFyaW5nIHRo
ZW0KLSAqIGZyb20gQG9sZCBhbmQgc2V0dGluZyB0aGVtIGluIEBuZXcuIEJvdGggQG9sZCBhbmQg
QG5ldyBjYW4gYmUgTlVMTC4KLSAqLwotdm9pZCBpOTE1X2dlbV90cmFja19mYihzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2xkLAotCQkgICAgICAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm5ldywKLQkJICAgICAgIHVuc2lnbmVkIGZyb250YnVmZmVyX2JpdHMpCi17Ci0JLyogQ29u
dHJvbCBvZiBpbmRpdmlkdWFsIGJpdHMgd2l0aGluIHRoZSBtYXNrIGFyZSBndWFyZGVkIGJ5Ci0J
ICogdGhlIG93bmluZyBwbGFuZS0+bXV0ZXgsIGkuZS4gd2UgY2FuIG5ldmVyIHNlZSBjb25jdXJy
ZW50Ci0JICogbWFuaXB1bGF0aW9uIG9mIGluZGl2aWR1YWwgYml0cy4gQnV0IHNpbmNlIHRoZSBi
aXRmaWVsZCBhcyBhIHdob2xlCi0JICogaXMgdXBkYXRlZCB1c2luZyBSTVcsIHdlIG5lZWQgdG8g
dXNlIGF0b21pY3MgaW4gb3JkZXIgdG8gdXBkYXRlCi0JICogdGhlIGJpdHMuCi0JICovCi0JQlVJ
TERfQlVHX09OKElOVEVMX0ZST05UQlVGRkVSX0JJVFNfUEVSX1BJUEUgKiBJOTE1X01BWF9QSVBF
UyA+Ci0JCSAgICAgQklUU19QRVJfVFlQRShhdG9taWNfdCkpOwotCi0JaWYgKG9sZCkgewotCQlX
QVJOX09OKCEoYXRvbWljX3JlYWQoJm9sZC0+ZnJvbnRidWZmZXJfYml0cykgJiBmcm9udGJ1ZmZl
cl9iaXRzKSk7Ci0JCWF0b21pY19hbmRub3QoZnJvbnRidWZmZXJfYml0cywgJm9sZC0+ZnJvbnRi
dWZmZXJfYml0cyk7Ci0JfQotCi0JaWYgKG5ldykgewotCQlXQVJOX09OKGF0b21pY19yZWFkKCZu
ZXctPmZyb250YnVmZmVyX2JpdHMpICYgZnJvbnRidWZmZXJfYml0cyk7Ci0JCWF0b21pY19vcihm
cm9udGJ1ZmZlcl9iaXRzLCAmbmV3LT5mcm9udGJ1ZmZlcl9iaXRzKTsKLQl9Ci19Ci0KICNpZiBJ
U19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9TRUxGVEVTVCkKICNpbmNsdWRlICJzZWxmdGVzdHMv
bW9ja19nZW1fZGV2aWNlLmMiCiAjaW5jbHVkZSAic2VsZnRlc3RzL2k5MTVfZ2VtLmMiCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV92bWEuYwppbmRleCBiODg4ZGRhYjNjOGIuLjk3MjIyNjk0MTBiNyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3ZtYS5jCkBAIC05MTksOCArOTE5LDEwIEBAIGludCBpOTE1X3ZtYV9tb3Zl
X3RvX2FjdGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKIAlpZiAoZmxhZ3MgJiBFWEVDX09CSkVD
VF9XUklURSkgewogCQlvYmotPndyaXRlX2RvbWFpbiA9IEk5MTVfR0VNX0RPTUFJTl9SRU5ERVI7
CiAKLQkJaWYgKGludGVsX2ZiX29ial9pbnZhbGlkYXRlKG9iaiwgT1JJR0lOX0NTKSkKLQkJCV9f
aTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoJm9iai0+ZnJvbnRidWZmZXJfd3JpdGUsIHJxKTsKKwkJ
aWYgKGludGVsX2Zyb250YnVmZmVyX2ludmFsaWRhdGUob2JqLT5mcm9udGJ1ZmZlciwgT1JJR0lO
X0NTKSkKKwkJCWk5MTVfYWN0aXZlX3JlZigmb2JqLT5mcm9udGJ1ZmZlci0+d3JpdGUsCisJCQkJ
CXJxLT5mZW5jZS5jb250ZXh0LAorCQkJCQlycSk7CiAKIAkJb2JqLT5yZWFkX2RvbWFpbnMgPSAw
OwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rydi5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmgKaW5kZXggMWQ1OGY3ZWM1ZDg0Li4zMTM0NDkw
NTY0MmQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rydi5oCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rydi5oCkBAIC02OSw2ICs2OSw3IEBAIGVudW0g
aW50ZWxfb3V0cHV0X3R5cGUgewogCiBzdHJ1Y3QgaW50ZWxfZnJhbWVidWZmZXIgewogCXN0cnVj
dCBkcm1fZnJhbWVidWZmZXIgYmFzZTsKKwlzdHJ1Y3QgaW50ZWxfZnJvbnRidWZmZXIgKmZyb250
YnVmZmVyOwogCXN0cnVjdCBpbnRlbF9yb3RhdGlvbl9pbmZvIHJvdF9pbmZvOwogCiAJLyogZm9y
IGVhY2ggcGxhbmUgaW4gdGhlIG5vcm1hbCBHVFQgdmlldyAqLwotLSAKMi4yMC4xCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

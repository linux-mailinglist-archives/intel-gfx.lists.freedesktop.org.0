Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0FAA6D7653
	for <lists+intel-gfx@lfdr.de>; Tue, 15 Oct 2019 14:19:44 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1F0E66E7BC;
	Tue, 15 Oct 2019 12:19:42 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 07FF86E7BC
 for <intel-gfx@lists.freedesktop.org>; Tue, 15 Oct 2019 12:19:40 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 18843844-1500050 for multiple; Tue, 15 Oct 2019 13:19:36 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>,
 intel-gfx@lists.freedesktop.org
References: <20191014220534.1662-1-chris@chris-wilson.co.uk>
 <20191014220534.1662-7-chris@chris-wilson.co.uk>
 <0e202636-8a4b-a691-6991-762907750286@linux.intel.com>
In-Reply-To: <0e202636-8a4b-a691-6991-762907750286@linux.intel.com>
Message-ID: <157114197406.22469.15002274583158401191@skylake-alporthouse-com>
Date: Tue, 15 Oct 2019 13:19:34 +0100
Subject: Re: [Intel-gfx] [PATCH 07/10] drm/i915/gem: Cancel non-persistent
 contexts on close
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBUdnJ0a28gVXJzdWxpbiAoMjAxOS0xMC0xNSAxMzoxNTo0OSkKPiAKPiBPbiAxNC8x
MC8yMDE5IDIzOjA1LCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4gPiBOb3JtYWxseSwgd2UgcmVseSBv
biBvdXIgaGFuZ2NoZWNrIHRvIHByZXZlbnQgcGVyc2lzdGVudCBiYXRjaGVzIGZyb20KPiA+IGhv
Z2dpbmcgdGhlIEdQVS4gSG93ZXZlciwgaWYgdGhlIHVzZXIgZGlzYWJsZXMgaGFuZ2NoZWNrLCB0
aGlzIG1lY2hhbmlzbQo+ID4gYnJlYWtzIGRvd24uIERlc3BpdGUgb3VyIGluc2lzdGVuY2UgdGhh
dCB0aGlzIGlzIHVuc2FmZSwgdGhlIHVzZXJzIGFyZQo+ID4gZXF1YWxseSBpbnNpc3RlbnQgdGhh
dCB0aGV5IHdhbnQgdG8gdXNlIGVuZGxlc3MgYmF0Y2hlcyBhbmQgd2lsbCBkaXNhYmxlCj4gPiB0
aGUgaGFuZ2NoZWNrIG1lY2hhbmlzbS4gV2UgYXJlIGxvb2tpbmcgYXQgcGVyaGFwcyByZXBsYWNp
bmcgaGFuZ2NoZWNrCj4gPiB3aXRoIGEgc29mdGVyIG1lY2hhbmlzbSwgdGhhdCBzZW5kcyBhIHB1
bHNlIGRvd24gdGhlIGVuZ2luZSB0byBjaGVjayBpZgo+ID4gaXQgaXMgd2VsbC4gV2UgY2FuIHVz
ZSB0aGUgc2FtZSBwcmVlbXB0aXZlIHB1bHNlIHRvIGZsdXNoIGFuIGFjdGl2ZQo+ID4gcGVyc2lz
dGVudCBjb250ZXh0IG9mZiB0aGUgR1BVIHVwb24gY29udGV4dCBjbG9zZSwgcHJldmVudGluZyBy
ZXNvdXJjZXMKPiA+IGJlaW5nIGxvc3QgYW5kIHVua2lsbGFibGUgcmVxdWVzdHMgcmVtYWluaW5n
IG9uIHRoZSBHUFUgYWZ0ZXIgcHJvY2Vzcwo+ID4gdGVybWluYXRpb24uIFRvIGF2b2lkIGNoYW5n
aW5nIHRoZSBBQkkgYW5kIGFjY2lkZW50YWxseSBicmVha2luZwo+ID4gZXhpc3RpbmcgdXNlcnNw
YWNlLCB3ZSBtYWtlIHRoZSBwZXJzaXN0ZW5jZSBvZiBhIGNvbnRleHQgZXhwbGljaXQgYW5kCj4g
PiBlbmFibGUgaXQgYnkgZGVmYXVsdCAobWF0Y2hpbmcgY3VycmVudCBBQkkpLiBVc2Vyc3BhY2Ug
Y2FuIG9wdCBvdXQgb2YKPiA+IHBlcnNpc3RlbnQgbW9kZSAoZm9yY2luZyByZXF1ZXN0cyB0byBi
ZSBjYW5jZWxsZWQgd2hlbiB0aGUgY29udGV4dCBpcwo+ID4gY2xvc2VkIGJ5IHByb2Nlc3MgdGVy
bWluYXRpb24gb3IgZXhwbGljaXRseSkgYnkgYSBjb250ZXh0IHBhcmFtZXRlci4gVG8KPiA+IGZh
Y2lsaXRhdGUgZXhpc3RpbmcgdXNlLWNhc2VzIG9mIGRpc2FibGluZyBoYW5nY2hlY2ssIGlmIHRo
ZSBtb2RwYXJhbSBpcwo+ID4gZGlzYWJsZWQgKGk5MTUuZW5hYmxlX2hhbmdjaGVjaz0wKSwgd2Ug
ZGlzYWJsZSBwZXJzaXN0ZW5jZSBtb2RlIGJ5Cj4gPiBkZWZhdWx0LiAgKE5vdGUsIG9uZSBvZiB0
aGUgb3V0Y29tZXMgZm9yIHN1cHBvcnRpbmcgZW5kbGVzcyBtb2RlIHdpbGwgYmUKPiA+IHRoZSBy
ZW1vdmFsIG9mIGhhbmdjaGVja2luZywgYXQgd2hpY2ggcG9pbnQgb3B0aW5nIGludG8gcGVyc2lz
dGVudCBtb2RlCj4gPiB3aWxsIGJlIG1hbmRhdG9yeSwgb3IgbWF5YmUgdGhlIGRlZmF1bHQgcGVy
aGFwcyBjb250cm9sbGVkIGJ5IGNncm91cHMuKQo+ID4gCj4gPiB2MjogQ2hlY2sgZm9yIGhhbmdj
aGVja2luZyBhdCBjb250ZXh0IHRlcm1pbmF0aW9uLCBzbyB0aGF0IHdlIGFyZSBub3QKPiA+IGxl
ZnQgd2l0aCB1bmR5aW5nIGNvbnRleHRzIGZyb20gYSBjcmFmdHkgdXNlci4KPiA+IHYzOiBGb3Jj
ZSBjb250ZXh0IHRlcm1pbmF0aW9uIGV2ZW4gaWYgZm9yY2VkLXByZWVtcHRpb24gaXMgZGlzYWJs
ZWQuCj4gPiAKPiA+IFRlc3RjYXNlOiBpZ3QvZ2VtX2N0eF9wZXJzaXN0ZW5jZQo+ID4gU2lnbmVk
LW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Cj4gPiBDYzog
Sm9vbmFzIExhaHRpbmVuIDxqb29uYXMubGFodGluZW5AbGludXguaW50ZWwuY29tPgo+ID4gQ2M6
IE1pY2hhxYIgV2luaWFyc2tpIDxtaWNoYWwud2luaWFyc2tpQGludGVsLmNvbT4KPiA+IENjOiBK
b24gQmxvb21maWVsZCA8am9uLmJsb29tZmllbGRAaW50ZWwuY29tPgo+ID4gUmV2aWV3ZWQtYnk6
IEpvbiBCbG9vbWZpZWxkIDxqb24uYmxvb21maWVsZEBpbnRlbC5jb20+Cj4gPiAtLS0KPiA+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyAgIHwgMTg5ICsrKysr
KysrKysrKysrKysrKwo+ID4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29u
dGV4dC5oICAgfCAgMTUgKysKPiA+ICAgLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29u
dGV4dF90eXBlcy5oIHwgICAxICsKPiA+ICAgLi4uL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3Rz
L21vY2tfY29udGV4dC5jIHwgICAyICsKPiA+ICAgaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5o
ICAgICAgICAgICAgICAgICAgIHwgIDE1ICsrCj4gPiAgIDUgZmlsZXMgY2hhbmdlZCwgMjIyIGlu
c2VydGlvbnMoKykKPiA+IAo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
Y29udGV4dC5jCj4gPiBpbmRleCA1ZDgyMjFjN2JhODMuLjQ5ZjM3YmJhNTY5MyAxMDA2NDQKPiA+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKPiA+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKPiA+IEBAIC03
MCw2ICs3MCw3IEBACj4gPiAgICNpbmNsdWRlIDxkcm0vaTkxNV9kcm0uaD4KPiA+ICAgCj4gPiAg
ICNpbmNsdWRlICJndC9pbnRlbF9scmNfcmVnLmgiCj4gPiArI2luY2x1ZGUgImd0L2ludGVsX2Vu
Z2luZV9oZWFydGJlYXQuaCIKPiA+ICAgI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV91c2VyLmgi
Cj4gPiAgIAo+ID4gICAjaW5jbHVkZSAiaTkxNV9nZW1fY29udGV4dC5oIgo+ID4gQEAgLTI2OSw2
ICsyNzAsMTM1IEBAIHZvaWQgaTkxNV9nZW1fY29udGV4dF9yZWxlYXNlKHN0cnVjdCBrcmVmICpy
ZWYpCj4gPiAgICAgICAgICAgICAgIHNjaGVkdWxlX3dvcmsoJmdjLT5mcmVlX3dvcmspOwo+ID4g
ICB9Cj4gPiAgIAo+ID4gK3N0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXMgKgo+
ID4gK19fY29udGV4dF9lbmdpbmVzX3N0YXRpYyhjb25zdCBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4KQo+ID4gK3sKPiA+ICsgICAgIHJldHVybiByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVk
KGN0eC0+ZW5naW5lcywgdHJ1ZSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBib29sIF9fcmVz
ZXRfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiA+ICt7Cj4gPiArICAg
ICBzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gZW5naW5lLT5ndDsKPiA+ICsgICAgIGJvb2wgc3VjY2Vz
cyA9IGZhbHNlOwo+ID4gKwo+ID4gKyAgICAgaWYgKCFpbnRlbF9oYXNfcmVzZXRfZW5naW5lKGd0
KSkKPiA+ICsgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwo+ID4gKwo+ID4gKyAgICAgaWYgKCF0
ZXN0X2FuZF9zZXRfYml0KEk5MTVfUkVTRVRfRU5HSU5FICsgZW5naW5lLT5pZCwKPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAmZ3QtPnJlc2V0LmZsYWdzKSkgewo+ID4gKyAgICAgICAg
ICAgICBzdWNjZXNzID0gaW50ZWxfZW5naW5lX3Jlc2V0KGVuZ2luZSwgTlVMTCkgPT0gMDsKPiA+
ICsgICAgICAgICAgICAgY2xlYXJfYW5kX3dha2VfdXBfYml0KEk5MTVfUkVTRVRfRU5HSU5FICsg
ZW5naW5lLT5pZCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZndC0+
cmVzZXQuZmxhZ3MpOwo+ID4gKyAgICAgfQo+ID4gKwo+ID4gKyAgICAgcmV0dXJuIHN1Y2Nlc3M7
Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIF9fcmVzZXRfY29udGV4dChzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gPiArewo+ID4gKyAgICAgaW50ZWxfZ3RfaGFuZGxl
X2Vycm9yKGVuZ2luZS0+Z3QsIGVuZ2luZS0+bWFzaywgMCwKPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAiY29udGV4dCBjbG9zdXJlIGluICVzIiwgY3R4LT5uYW1lKTsKPiA+ICt9Cj4g
PiArCj4gPiArc3RhdGljIGJvb2wgX19jYW5jZWxfZW5naW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKPiA+ICt7Cj4gPiArICAgICAvKgo+ID4gKyAgICAgICogU2VuZCBhICJoaWdo
IHByaW9yaXR5IHB1bHNlIiBkb3duIHRoZSBlbmdpbmUgdG8gY2F1c2UgdGhlCj4gPiArICAgICAg
KiBjdXJyZW50IHJlcXVlc3QgdG8gYmUgbW9tZW50YXJpbHkgcHJlZW1wdGVkLiAoSWYgaXQgZmFp
bHMgdG8KPiA+ICsgICAgICAqIGJlIHByZWVtcHRlZCwgaXQgd2lsbCBiZSByZXNldCkuIEFzIHdl
IGhhdmUgbWFya2VkIG91ciBjb250ZXh0Cj4gPiArICAgICAgKiBhcyBiYW5uZWQsIGFueSBpbmNv
bXBsZXRlIHJlcXVlc3QsIGluY2x1ZGluZyBhbnkgcnVubmluZywgd2lsbAo+ID4gKyAgICAgICog
YmUgc2tpcHBlZCBmb2xsb3dpbmcgdGhlIHByZWVtcHRpb24uCj4gPiArICAgICAgKgo+ID4gKyAg
ICAgICogSWYgdGhlcmUgaXMgbm8gaGFuZ2NoZWNraW5nIChvbmUgb2YgdGhlIHJlYXNvbnMgd2h5
IHdlIHRyeSB0bwo+ID4gKyAgICAgICogY2FuY2VsIHRoZSBjb250ZXh0KSBhbmQgbm8gZm9yY2Vk
IHByZWVtcHRpb24sIHRoZXJlIG1heSBiZSBubwo+ID4gKyAgICAgICogbWVhbnMgYnkgd2hpY2gg
d2UgcmVzZXQgdGhlIEdQVSBhbmQgZXZpY3QgdGhlIHBlcnNpc3RlbnQgaG9nLgo+ID4gKyAgICAg
ICogRXJnbyBpZiB3ZSBhcmUgdW5hYmxlIHRvIGluamVjdCBhIHByZWVtcHRpdmUgcHVsc2UgdGhh
dCBjYW4KPiA+ICsgICAgICAqIGtpbGwgdGhlIGJhbm5lZCBjb250ZXh0LCB3ZSBmYWxsYmFjayB0
byBkb2luZyBhIGxvY2FsIHJlc2V0Cj4gPiArICAgICAgKiBpbnN0ZWFkLgo+ID4gKyAgICAgICov
Cj4gPiArICAgICBpZiAoQ09ORklHX0RSTV9JOTE1X1BSRUVNUFRfVElNRU9VVCAmJiAhaW50ZWxf
ZW5naW5lX3B1bHNlKGVuZ2luZSkpCj4gPiArICAgICAgICAgICAgIHJldHVybiB0cnVlOwo+ID4g
Kwo+ID4gKyAgICAgLyogSWYgd2UgYXJlIHVuYWJsZSB0byBzZW5kIGEgcHVsc2UsIHRyeSByZXNl
dHRpbmcgdGhpcyBlbmdpbmUuICovCj4gPiArICAgICByZXR1cm4gX19yZXNldF9lbmdpbmUoZW5n
aW5lKTsKPiAKPiBPcGVuIGZyb20gbGFzdCByb3VuZCBpcyBob3cgbGlrZWx5IGlzIGZvcmNlZCBw
cmVlbXB0aW9uIHRvIGJlIGNvbXBpbGVkIAo+IG91dCwgaW4gd2hpY2ggY2FzZSB0aGUgY29kZSB3
aWxsIGFsd2F5cyBmYWxsIGJhY2sgdG8gcmVzZXQgaW1tZWRpYXRlbHksIAo+IGV2ZW4gaWYgd29y
a2xvYWQgd291bGQgb3RoZXJ3aXNlIHByZWVtcHQganVzdCBmaW5lLiAoR2l2ZW4gdGhlIGRhbmdl
cnMgCj4gb2YgcmVzZXQgaGl0dGluZyBzb21ldGhpbmcgdW5yZWxhdGVkIGFzIHlvdSBleHBsYWlu
ZWQuKQo+IAo+IENvdWxkIHlvdSBhbHdheXMgY29tcGlsZSBpbiBmb3JjZWQgcHJlZW1wdGlvbiBz
byBpdCBjb3VsZCBiZSB1c2VkIG9uIAo+IGNvbnRleHQgY2xvc2U/IEkgYW0gdGhpbmtpbmcsIGFs
bG93IGl0IHRvIGJlIGRpc2FibGVkIHZpYSBzeXNmcyBvbiBpdHMgCj4gb3duLCBidXQgb24gY29u
dGV4dCBjbG9zZSBoYXZlIGl0IGFjdGl2ZSBmb3IgdGhlIGNvbnRleHQgYmVpbmcgY2xvc2VkIHNv
IAo+IHRoYXQgaWYgdGhlIHB1bHNlIGRvZXMgbm90IHdvcmsgaXQgY2FuIGtpY2sgaW4gYW5kIHJl
c2V0LiBTb3VuZHMgbmljZXIgCj4gdGhhbiBqdXN0IHJlc29ydGluZyB0byBlbmdpbmUgcmVzZXQs
IHdoaWNoIGFzIHlvdSBkZXNjcmliZWQsIGNhbiBpbXBhY3QgCj4gc29tZW9uZSBpbm5vY2VudC4K
Ckkgd2FzIHRoaW5raW5nIHRoYXQgdGhvc2Ugd2hvIGNhcmUgYWJvdXQgaW50ZXJydXB0aW9ucyB3
b3VsZCBub3QKdG9sZXJhdGUgZXZlbiBoYXZpbmcgYSBwcmVlbXB0IHRpbWVyIHJ1bm5pbmcuIEkg
d291bGQgc2F5IGl0cyBtYXNvY2hpc20KYW5kIHdvdWxkIG5vdCBleHBlY3QgaXQgdG8gYmUgZGlz
YWJsZWQsIGJ1dCBJIGFsc28gc2F5IHRoZSBzYW1lIHRoaW5nCmFib3V0IFJULgoKSW4gc2hvcnQs
IEkgbWFkZSBpdCBvcHRpb25hbCBhdCBjb21waWxldGltZSBqdXN0IGJlY2F1c2UgSSBjb3VsZC4K
LUNocmlzCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCklu
dGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRw
czovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

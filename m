Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1D7CE7612F
	for <lists+intel-gfx@lfdr.de>; Fri, 26 Jul 2019 10:46:51 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A4AF96E8B4;
	Fri, 26 Jul 2019 08:46:48 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 399D86E8A9
 for <intel-gfx@lists.freedesktop.org>; Fri, 26 Jul 2019 08:46:30 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17621081-1500050 
 for multiple; Fri, 26 Jul 2019 09:46:15 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 26 Jul 2019 09:45:54 +0100
Message-Id: <20190726084613.22129-8-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190726084613.22129-1-chris@chris-wilson.co.uk>
References: <20190726084613.22129-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 08/27] drm/i915: Remove lrc default desc from
 GEM context
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2Ugb25seSBjb21wdXRlIHRoZSBscmNfZGVzY3JpcHRvcigpIG9uIHBpbm5pbmcgdGhlIGNvbnRl
eHQsIGkuZS4KaW5mcmVxdWVudGx5LCBzbyB3ZSBkbyBub3QgYmVuZWZpdCBmcm9tIHN0b3Jpbmcg
dGhlIHRlbXBsYXRlIGFzIHRoZQphZGRyZXNzaW5nIG1vZGUgaXMgYWxzbyBmaXhlZCBmb3IgdGhl
IGxpZmV0aW1lIG9mIHRoZSBpbnRlbF9jb250ZXh0LgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2ls
c29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2NvbnRleHQuYyAgIHwgMjggKystLS0tLS0tLS0tLS0tLS0tLQogLi4uL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oIHwgIDIgLS0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAgICB8IDEyICsrKysrLS0tCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMgICAgICAgICAgfCAgMyAtLQogNCBmaWxl
cyBjaGFuZ2VkLCAxMCBpbnNlcnRpb25zKCspLCAzNSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwppbmRleCBiMjhjN2NhNjgxYTguLjFi
M2RjNzI1OGVmMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4
dC5jCkBAIC0zOTcsMzAgKzM5Nyw2IEBAIHN0YXRpYyB2b2lkIGNvbnRleHRfY2xvc2Uoc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAlpOTE1X2dlbV9jb250ZXh0X3B1dChjdHgpOwogfQog
Ci1zdGF0aWMgdTMyIGRlZmF1bHRfZGVzY190ZW1wbGF0ZShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKLQkJCQkgY29uc3Qgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0p
Ci17Ci0JdTMyIGFkZHJlc3NfbW9kZTsKLQl1MzIgZGVzYzsKLQotCWRlc2MgPSBHRU44X0NUWF9W
QUxJRCB8IEdFTjhfQ1RYX1BSSVZJTEVHRTsKLQotCWFkZHJlc3NfbW9kZSA9IElOVEVMX0xFR0FD
WV8zMkJfQ09OVEVYVDsKLQlpZiAodm0gJiYgaTkxNV92bV9pc180bHZsKHZtKSkKLQkJYWRkcmVz
c19tb2RlID0gSU5URUxfTEVHQUNZXzY0Ql9DT05URVhUOwotCWRlc2MgfD0gYWRkcmVzc19tb2Rl
IDw8IEdFTjhfQ1RYX0FERFJFU1NJTkdfTU9ERV9TSElGVDsKLQotCWlmIChJU19HRU4oaTkxNSwg
OCkpCi0JCWRlc2MgfD0gR0VOOF9DVFhfTDNMTENfQ09IRVJFTlQ7Ci0KLQkvKiBUT0RPOiBXYURp
c2FibGVMaXRlUmVzdG9yZSB3aGVuIHdlIHN0YXJ0IHVzaW5nIHNlbWFwaG9yZQotCSAqIHNpZ25h
bGxpbmcgYmV0d2VlbiBDb21tYW5kIFN0cmVhbWVycwotCSAqIHJpbmctPmN0eF9kZXNjX3RlbXBs
YXRlIHw9IEdFTjhfQ1RYX0ZPUkNFX1JFU1RPUkU7Ci0JICovCi0KLQlyZXR1cm4gZGVzYzsKLX0K
LQogc3RhdGljIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICoKIF9fY3JlYXRlX2NvbnRleHQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CkBAIC00NTksNyArNDM1LDYgQEAgX19jcmVh
dGVfY29udGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlpOTE1X2dlbV9jb250
ZXh0X3NldF9yZWNvdmVyYWJsZShjdHgpOwogCiAJY3R4LT5yaW5nX3NpemUgPSA0ICogUEFHRV9T
SVpFOwotCWN0eC0+ZGVzY190ZW1wbGF0ZSA9IGRlZmF1bHRfZGVzY190ZW1wbGF0ZShpOTE1LCBO
VUxMKTsKIAogCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGN0eC0+aGFuZ190aW1lc3RhbXAp
OyBpKyspCiAJCWN0eC0+aGFuZ190aW1lc3RhbXBbaV0gPSBqaWZmaWVzIC0gQ09OVEVYVF9GQVNU
X0hBTkdfSklGRklFUzsKQEAgLTQ3OCw4ICs0NTMsOSBAQCBfX3NldF9wcGd0dChzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4LCBzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKIAlzdHJ1
Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVyIGl0OwogCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsK
IAorCUdFTV9CVUdfT04ob2xkICYmIGk5MTVfdm1faXNfNGx2bCh2bSkgIT0gaTkxNV92bV9pc180
bHZsKG9sZCkpOworCiAJY3R4LT52bSA9IGk5MTVfdm1fZ2V0KHZtKTsKLQljdHgtPmRlc2NfdGVt
cGxhdGUgPSBkZWZhdWx0X2Rlc2NfdGVtcGxhdGUoY3R4LT5pOTE1LCB2bSk7CiAKIAlmb3JfZWFj
aF9nZW1fZW5naW5lKGNlLCBpOTE1X2dlbV9jb250ZXh0X2xvY2tfZW5naW5lcyhjdHgpLCBpdCkg
ewogCQlpOTE1X3ZtX3B1dChjZS0+dm0pOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmgKaW5kZXggMGVlNjE0ODJlZjk0Li5hMDJkOTg0OTQw
NzggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0
X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRf
dHlwZXMuaApAQCAtMTcxLDggKzE3MSw2IEBAIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0IHsKIAog
CS8qKiByaW5nX3NpemU6IHNpemUgZm9yIGFsbG9jYXRpbmcgdGhlIHBlci1lbmdpbmUgcmluZyBi
dWZmZXIgKi8KIAl1MzIgcmluZ19zaXplOwotCS8qKiBkZXNjX3RlbXBsYXRlOiBpbnZhcmlhbnQg
ZmllbGRzIGZvciB0aGUgSFcgY29udGV4dCBkZXNjcmlwdG9yICovCi0JdTMyIGRlc2NfdGVtcGxh
dGU7CiAKIAkvKiogZ3VpbHR5X2NvdW50OiBIb3cgbWFueSB0aW1lcyB0aGlzIGNvbnRleHQgaGFz
IGNhdXNlZCBhIEdQVSBoYW5nLiAqLwogCWF0b21pY190IGd1aWx0eV9jb3VudDsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfbHJjLmMKaW5kZXggZDQ2YTZkOWIzMzE2Li43NTE3OTlkNWQxYTkgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCkBAIC00MTgsMTMgKzQxOCwxNyBAQCBscmNf
ZGVzY3JpcHRvcihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKIAlCVUlMRF9CVUdfT04oTUFYX0NPTlRFWFRfSFdfSUQgPiAoQklUKEdFTjhf
Q1RYX0lEX1dJRFRIKSkpOwogCUJVSUxEX0JVR19PTihHRU4xMV9NQVhfQ09OVEVYVF9IV19JRCA+
IChCSVQoR0VOMTFfU1dfQ1RYX0lEX1dJRFRIKSkpOwogCi0JZGVzYyA9IGN0eC0+ZGVzY190ZW1w
bGF0ZTsJCQkJLyogYml0cyAgMC0xMSAqLwotCUdFTV9CVUdfT04oZGVzYyAmIEdFTk1BU0tfVUxM
KDYzLCAxMikpOworCWRlc2MgPSBJTlRFTF9MRUdBQ1lfMzJCX0NPTlRFWFQ7CisJaWYgKGk5MTVf
dm1faXNfNGx2bChjZS0+dm0pKQorCQlkZXNjID0gSU5URUxfTEVHQUNZXzY0Ql9DT05URVhUOwor
CWRlc2MgPDw9IEdFTjhfQ1RYX0FERFJFU1NJTkdfTU9ERV9TSElGVDsKKworCWRlc2MgfD0gR0VO
OF9DVFhfVkFMSUQgfCBHRU44X0NUWF9QUklWSUxFR0U7CisJaWYgKElTX0dFTihlbmdpbmUtPmk5
MTUsIDgpKQorCQlkZXNjIHw9IEdFTjhfQ1RYX0wzTExDX0NPSEVSRU5UOwogCiAJZGVzYyB8PSBp
OTE1X2dndHRfb2Zmc2V0KGNlLT5zdGF0ZSkgKyBMUkNfSEVBREVSX1BBR0VTICogUEFHRV9TSVpF
OwogCQkJCQkJCQkvKiBiaXRzIDEyLTMxICovCi0JR0VNX0JVR19PTihkZXNjICYgR0VOTUFTS19V
TEwoNjMsIDMyKSk7Ci0KIAkvKgogCSAqIFRoZSBmb2xsb3dpbmcgMzJiaXRzIGFyZSBjb3BpZWQg
aW50byB0aGUgT0EgcmVwb3J0cyAoZHdvcmQgMikuCiAJICogQ29uc2lkZXIgdXBkYXRpbmcgb2Ff
Z2V0X3JlbmRlcl9jdHhfaWQgaW4gaTkxNV9wZXJmLmMgd2hlbiBjaGFuZ2luZwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Z0L3NjaGVkdWxlci5jCmluZGV4IGY2ODc5OGFiMWU3Yy4uNGMwMThmYjEzNTljIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCkBAIC0yOTEsOSArMjkxLDYgQEAgc2hh
ZG93X2NvbnRleHRfZGVzY3JpcHRvcl91cGRhdGUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAog
CSAqIFVwZGF0ZSBiaXRzIDAtMTEgb2YgdGhlIGNvbnRleHQgZGVzY3JpcHRvciB3aGljaCBpbmNs
dWRlcyBmbGFncwogCSAqIGxpa2UgR0VOOF9DVFhfKiBjYWNoZWQgaW4gZGVzY190ZW1wbGF0ZQog
CSAqLwotCWRlc2MgJj0gVTY0X01BWCA8PCAxMjsKLQlkZXNjIHw9IGNlLT5nZW1fY29udGV4dC0+
ZGVzY190ZW1wbGF0ZSAmICgoMVVMTCA8PCAxMikgLSAxKTsKLQogCWRlc2MgJj0gfigweDMgPDwg
R0VOOF9DVFhfQUREUkVTU0lOR19NT0RFX1NISUZUKTsKIAlkZXNjIHw9IHdvcmtsb2FkLT5jdHhf
ZGVzYy5hZGRyZXNzaW5nX21vZGUgPDwKIAkJR0VOOF9DVFhfQUREUkVTU0lOR19NT0RFX1NISUZU
OwotLSAKMi4yMi4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5v
cmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1n
Zng=

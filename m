Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 79AF02FC16E
	for <lists+intel-gfx@lfdr.de>; Tue, 19 Jan 2021 21:45:08 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 123AC892C1;
	Tue, 19 Jan 2021 20:45:01 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 59949892C1
 for <intel-gfx@lists.freedesktop.org>; Tue, 19 Jan 2021 20:44:59 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 23643504-1500050 
 for <intel-gfx@lists.freedesktop.org>; Tue, 19 Jan 2021 20:44:54 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 19 Jan 2021 20:44:54 +0000
Message-Id: <20210119204454.10343-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915/display: Apply interactive priority to
 explicit flip fences
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q3VycmVudGx5LCBpZiBhIG1vZGVzZXQvcGFnZWZsaXAgbmVlZHMgdG8gd2FpdCBmb3IgcmVuZGVy
IGNvbXBsZXRpb24gdG8KYW4gb2JqZWN0LCB3ZSBib29zdCB0aGUgcHJpb3JpdHkgb2YgdGhhdCBy
ZW5kZXJpbmcgYWJvdmUgYWxsIG90aGVyIHdvcmsuCldlIGNhbiBhcHBseSB0aGUgc2FtZSBpbnRl
cmFjdGl2ZSBwcmlvcml0eSBib29zdGluZyB0byBleHBsaWNpdCBmZW5jZXMKdGhhdCB3ZSBjYW4g
dW53cmFwIGludG8gYSBuYXRpdmUgaTkxNV9yZXF1ZXN0IChpLmUuIHN5bmNfZmlsZSkuCgpTaWdu
ZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KQ2M6IFR2
cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+CkNjOiBWaWxsZSBTeXJqw6Rs
w6QgPHZpbGxlLnN5cmphbGFAbGludXguaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogVmlsbGUgU3ly
asOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYyB8IDE2ICsrKy0tLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaCAgIHwgIDMgKysKIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV93YWl0LmMgICAgIHwgNDYgKysrKysrKysrKysrKystLS0tLS0K
IDMgZmlsZXMgY2hhbmdlZCwgNDIgaW5zZXJ0aW9ucygrKSwgMjMgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXkuYwppbmRleCAzMmZmOWQy
MDFhZWIuLjczNzNmNTRiMjE2ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kaXNwbGF5LmMKQEAgLTEzNTI3LDE1ICsxMzUyNyw2IEBAIHZvaWQgaW50ZWxfcGxhbmVf
dW5waW5fZmIoc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpvbGRfcGxhbmVfc3RhdGUpCiAJCWlu
dGVsX3VucGluX2ZiX3ZtYSh2bWEsIG9sZF9wbGFuZV9zdGF0ZS0+ZmxhZ3MpOwogfQogCi1zdGF0
aWMgdm9pZCBmYl9vYmpfYnVtcF9yZW5kZXJfcHJpb3JpdHkoc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaikKLXsKLQlzdHJ1Y3QgaTkxNV9zY2hlZF9hdHRyIGF0dHIgPSB7Ci0JCS5wcmlv
cml0eSA9IEk5MTVfVVNFUl9QUklPUklUWShJOTE1X1BSSU9SSVRZX0RJU1BMQVkpLAotCX07Ci0K
LQlpOTE1X2dlbV9vYmplY3Rfd2FpdF9wcmlvcml0eShvYmosIDAsICZhdHRyKTsKLX0KLQogLyoq
CiAgKiBpbnRlbF9wcmVwYXJlX3BsYW5lX2ZiIC0gUHJlcGFyZSBmYiBmb3IgdXNhZ2Ugb24gcGxh
bmUKICAqIEBfcGxhbmU6IGRybSBwbGFuZSB0byBwcmVwYXJlIGZvcgpAQCAtMTM1NTIsNiArMTM1
NDMsOSBAQCBpbnQKIGludGVsX3ByZXBhcmVfcGxhbmVfZmIoc3RydWN0IGRybV9wbGFuZSAqX3Bs
YW5lLAogCQkgICAgICAgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqX25ld19wbGFuZV9zdGF0ZSkK
IHsKKwlzdHJ1Y3QgaTkxNV9zY2hlZF9hdHRyIGF0dHIgPSB7CisJCS5wcmlvcml0eSA9IEk5MTVf
VVNFUl9QUklPUklUWShJOTE1X1BSSU9SSVRZX0RJU1BMQVkpLAorCX07CiAJc3RydWN0IGludGVs
X3BsYW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKF9wbGFuZSk7CiAJc3RydWN0IGludGVsX3Bs
YW5lX3N0YXRlICpuZXdfcGxhbmVfc3RhdGUgPQogCQl0b19pbnRlbF9wbGFuZV9zdGF0ZShfbmV3
X3BsYW5lX3N0YXRlKTsKQEAgLTEzNTkxLDYgKzEzNTg1LDggQEAgaW50ZWxfcHJlcGFyZV9wbGFu
ZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpfcGxhbmUsCiAJfQogCiAJaWYgKG5ld19wbGFuZV9zdGF0
ZS0+dWFwaS5mZW5jZSkgeyAvKiBleHBsaWNpdCBmZW5jaW5nICovCisJCWk5MTVfZ2VtX2ZlbmNl
X3dhaXRfcHJpb3JpdHkobmV3X3BsYW5lX3N0YXRlLT51YXBpLmZlbmNlLAorCQkJCQkgICAgICZh
dHRyKTsKIAkJcmV0ID0gaTkxNV9zd19mZW5jZV9hd2FpdF9kbWFfZmVuY2UoJnN0YXRlLT5jb21t
aXRfcmVhZHksCiAJCQkJCQkgICAgbmV3X3BsYW5lX3N0YXRlLT51YXBpLmZlbmNlLAogCQkJCQkJ
ICAgIGk5MTVfZmVuY2VfdGltZW91dChkZXZfcHJpdiksCkBAIC0xMzYxMiw3ICsxMzYwOCw3IEBA
IGludGVsX3ByZXBhcmVfcGxhbmVfZmIoc3RydWN0IGRybV9wbGFuZSAqX3BsYW5lLAogCWlmIChy
ZXQpCiAJCXJldHVybiByZXQ7CiAKLQlmYl9vYmpfYnVtcF9yZW5kZXJfcHJpb3JpdHkob2JqKTsK
KwlpOTE1X2dlbV9vYmplY3Rfd2FpdF9wcmlvcml0eShvYmosIDAsICZhdHRyKTsKIAlpOTE1X2dl
bV9vYmplY3RfZmx1c2hfZnJvbnRidWZmZXIob2JqLCBPUklHSU5fRElSVFlGQik7CiAKIAlpZiAo
IW5ld19wbGFuZV9zdGF0ZS0+dWFwaS5mZW5jZSkgeyAvKiBpbXBsaWNpdCBmZW5jaW5nICovCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmggYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmgKaW5kZXggYTIxNzE0ZGIy
ZTRjLi45MDg4N2I0ZjU0MDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9vYmplY3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
b2JqZWN0LmgKQEAgLTUwNCw2ICs1MDQsOSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgX19zdGFydF9j
cHVfd3JpdGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAkJb2JqLT5jYWNoZV9k
aXJ0eSA9IHRydWU7CiB9CiAKK3ZvaWQgaTkxNV9nZW1fZmVuY2Vfd2FpdF9wcmlvcml0eShzdHJ1
Y3QgZG1hX2ZlbmNlICpmZW5jZSwKKwkJCQkgIGNvbnN0IHN0cnVjdCBpOTE1X3NjaGVkX2F0dHIg
KmF0dHIpOworCiBpbnQgaTkxNV9nZW1fb2JqZWN0X3dhaXQoc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iaiwKIAkJCSB1bnNpZ25lZCBpbnQgZmxhZ3MsCiAJCQkgbG9uZyB0aW1lb3V0KTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV93YWl0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fd2FpdC5jCmluZGV4IGMxYjEzYWM1MGQw
Zi4uNGI5ODU2ZDViYTE0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fd2FpdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV93YWl0
LmMKQEAgLTUsNiArNSw3IEBACiAgKi8KIAogI2luY2x1ZGUgPGxpbnV4L2RtYS1mZW5jZS1hcnJh
eS5oPgorI2luY2x1ZGUgPGxpbnV4L2RtYS1mZW5jZS1jaGFpbi5oPgogI2luY2x1ZGUgPGxpbnV4
L2ppZmZpZXMuaD4KIAogI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZS5oIgpAQCAtNDQsOCArNDUs
NyBAQCBpOTE1X2dlbV9vYmplY3Rfd2FpdF9yZXNlcnZhdGlvbihzdHJ1Y3QgZG1hX3Jlc3YgKnJl
c3YsCiAJCXVuc2lnbmVkIGludCBjb3VudCwgaTsKIAkJaW50IHJldDsKIAotCQlyZXQgPSBkbWFf
cmVzdl9nZXRfZmVuY2VzX3JjdShyZXN2LAotCQkJCQkJCSZleGNsLCAmY291bnQsICZzaGFyZWQp
OworCQlyZXQgPSBkbWFfcmVzdl9nZXRfZmVuY2VzX3JjdShyZXN2LCAmZXhjbCwgJmNvdW50LCAm
c2hhcmVkKTsKIAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7CiAKQEAgLTkxLDggKzkxLDggQEAg
aTkxNV9nZW1fb2JqZWN0X3dhaXRfcmVzZXJ2YXRpb24oc3RydWN0IGRtYV9yZXN2ICpyZXN2LAog
CXJldHVybiB0aW1lb3V0OwogfQogCi1zdGF0aWMgdm9pZCBfX2ZlbmNlX3NldF9wcmlvcml0eShz
dHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwKLQkJCQkgY29uc3Qgc3RydWN0IGk5MTVfc2NoZWRfYXR0
ciAqYXR0cikKK3N0YXRpYyB2b2lkIGZlbmNlX3NldF9wcmlvcml0eShzdHJ1Y3QgZG1hX2ZlbmNl
ICpmZW5jZSwKKwkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaTkxNV9zY2hlZF9hdHRyICphdHRyKQog
ewogCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZTsKQEAgLTEwMywyNyArMTAzLDQ3IEBAIHN0YXRpYyB2b2lkIF9fZmVuY2Vfc2V0X3ByaW9y
aXR5KHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlLAogCXJxID0gdG9fcmVxdWVzdChmZW5jZSk7CiAJ
ZW5naW5lID0gcnEtPmVuZ2luZTsKIAotCWxvY2FsX2JoX2Rpc2FibGUoKTsKIAlyY3VfcmVhZF9s
b2NrKCk7IC8qIFJDVSBzZXJpYWxpc2F0aW9uIGZvciBzZXQtd2VkZ2VkIHByb3RlY3Rpb24gKi8K
IAlpZiAoZW5naW5lLT5zY2hlZHVsZSkKIAkJZW5naW5lLT5zY2hlZHVsZShycSwgYXR0cik7CiAJ
cmN1X3JlYWRfdW5sb2NrKCk7Ci0JbG9jYWxfYmhfZW5hYmxlKCk7IC8qIGtpY2sgdGhlIHRhc2ts
ZXRzIGlmIHF1ZXVlcyB3ZXJlIHJlcHJpb3JpdGlzZWQgKi8KIH0KIAotc3RhdGljIHZvaWQgZmVu
Y2Vfc2V0X3ByaW9yaXR5KHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlLAotCQkJICAgICAgIGNvbnN0
IHN0cnVjdCBpOTE1X3NjaGVkX2F0dHIgKmF0dHIpCitzdGF0aWMgaW5saW5lIGJvb2wgX19kbWFf
ZmVuY2VfaXNfY2hhaW4oY29uc3Qgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpCiB7CisJcmV0dXJu
IGZlbmNlLT5vcHMgPT0gJmRtYV9mZW5jZV9jaGFpbl9vcHM7Cit9CisKK3ZvaWQgaTkxNV9nZW1f
ZmVuY2Vfd2FpdF9wcmlvcml0eShzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwKKwkJCQkgIGNvbnN0
IHN0cnVjdCBpOTE1X3NjaGVkX2F0dHIgKmF0dHIpCit7CisJaWYgKGRtYV9mZW5jZV9pc19zaWdu
YWxlZChmZW5jZSkpCisJCXJldHVybjsKKworCWxvY2FsX2JoX2Rpc2FibGUoKTsKKwogCS8qIFJl
Y3Vyc2Ugb25jZSBpbnRvIGEgZmVuY2UtYXJyYXkgKi8KIAlpZiAoZG1hX2ZlbmNlX2lzX2FycmF5
KGZlbmNlKSkgewogCQlzdHJ1Y3QgZG1hX2ZlbmNlX2FycmF5ICphcnJheSA9IHRvX2RtYV9mZW5j
ZV9hcnJheShmZW5jZSk7CiAJCWludCBpOwogCiAJCWZvciAoaSA9IDA7IGkgPCBhcnJheS0+bnVt
X2ZlbmNlczsgaSsrKQotCQkJX19mZW5jZV9zZXRfcHJpb3JpdHkoYXJyYXktPmZlbmNlc1tpXSwg
YXR0cik7CisJCQlmZW5jZV9zZXRfcHJpb3JpdHkoYXJyYXktPmZlbmNlc1tpXSwgYXR0cik7CisJ
fSBlbHNlIGlmIChfX2RtYV9mZW5jZV9pc19jaGFpbihmZW5jZSkpIHsKKwkJc3RydWN0IGRtYV9m
ZW5jZSAqaXRlcjsKKworCQkvKiBUaGUgY2hhaW4gaXMgb3JkZXJlZDsgaWYgd2UgYm9vc3QgdGhl
IGxhc3QsIHdlIGJvb3N0IGFsbCAqLworCQlkbWFfZmVuY2VfY2hhaW5fZm9yX2VhY2goaXRlciwg
ZmVuY2UpIHsKKwkJCWZlbmNlX3NldF9wcmlvcml0eSh0b19kbWFfZmVuY2VfY2hhaW4oaXRlcikt
PmZlbmNlLAorCQkJCQkgICBhdHRyKTsKKwkJCWJyZWFrOworCQl9CisJCWRtYV9mZW5jZV9wdXQo
aXRlcik7CiAJfSBlbHNlIHsKLQkJX19mZW5jZV9zZXRfcHJpb3JpdHkoZmVuY2UsIGF0dHIpOwor
CQlmZW5jZV9zZXRfcHJpb3JpdHkoZmVuY2UsIGF0dHIpOwogCX0KKworCWxvY2FsX2JoX2VuYWJs
ZSgpOyAvKiBraWNrIHRoZSB0YXNrbGV0cyBpZiBxdWV1ZXMgd2VyZSByZXByaW9yaXRpc2VkICov
CiB9CiAKIGludApAQCAtMTM5LDEyICsxNTksMTIgQEAgaTkxNV9nZW1fb2JqZWN0X3dhaXRfcHJp
b3JpdHkoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAkJaW50IHJldDsKIAogCQly
ZXQgPSBkbWFfcmVzdl9nZXRfZmVuY2VzX3JjdShvYmotPmJhc2UucmVzdiwKLQkJCQkJCQkmZXhj
bCwgJmNvdW50LCAmc2hhcmVkKTsKKwkJCQkJICAgICAgJmV4Y2wsICZjb3VudCwgJnNoYXJlZCk7
CiAJCWlmIChyZXQpCiAJCQlyZXR1cm4gcmV0OwogCiAJCWZvciAoaSA9IDA7IGkgPCBjb3VudDsg
aSsrKSB7Ci0JCQlmZW5jZV9zZXRfcHJpb3JpdHkoc2hhcmVkW2ldLCBhdHRyKTsKKwkJCWk5MTVf
Z2VtX2ZlbmNlX3dhaXRfcHJpb3JpdHkoc2hhcmVkW2ldLCBhdHRyKTsKIAkJCWRtYV9mZW5jZV9w
dXQoc2hhcmVkW2ldKTsKIAkJfQogCkBAIC0xNTQsNyArMTc0LDcgQEAgaTkxNV9nZW1fb2JqZWN0
X3dhaXRfcHJpb3JpdHkoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAl9CiAKIAlp
ZiAoZXhjbCkgewotCQlmZW5jZV9zZXRfcHJpb3JpdHkoZXhjbCwgYXR0cik7CisJCWk5MTVfZ2Vt
X2ZlbmNlX3dhaXRfcHJpb3JpdHkoZXhjbCwgYXR0cik7CiAJCWRtYV9mZW5jZV9wdXQoZXhjbCk7
CiAJfQogCXJldHVybiAwOwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0
cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9s
aXN0aW5mby9pbnRlbC1nZngK

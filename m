Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 8D247115025
	for <lists+intel-gfx@lfdr.de>; Fri,  6 Dec 2019 13:04:23 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B13856E081;
	Fri,  6 Dec 2019 12:04:21 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4240D6E081
 for <intel-gfx@lists.freedesktop.org>; Fri,  6 Dec 2019 12:04:20 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 19483565-1500050 for multiple; Fri, 06 Dec 2019 12:04:16 +0000
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Chuansheng Liu <chuansheng.liu@intel.com>, intel-gfx@lists.freedesktop.org
References: <20191206115635.46931-1-chuansheng.liu@intel.com>
In-Reply-To: <20191206115635.46931-1-chuansheng.liu@intel.com>
Message-ID: <157563385458.8568.7627960428331911090@skylake-alporthouse-com>
Date: Fri, 06 Dec 2019 12:04:14 +0000
Subject: Re: [Intel-gfx] [PATCH] drm/i915: Fix the use-after-free between
 i915_active_ref and __active_retire
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBDaHVhbnNoZW5nIExpdSAoMjAxOS0xMi0wNiAxMTo1NjozNSkKPiBXZSBlYXNpbHkg
aGl0IGRybS9pOTE1IHBhbmljIG9uIFRHTCB3aGVuIHJ1bm5pbmcgZ2xtYXJrMiwgYW5kIGZpbmFs
bHkKPiBjYXVnaHQgdGhlIHJhY2UgY29uZGl0aW9uIG9mIHVzZS1hZnRlci1mcmVlIHdpdGggZW5h
YmxpbmcgS0FTQU4uCj4gCj4gVGhlIGNhbGwgc3RhY2sgaXMgYmVsb3c6Cj4gPT09Cj4gWyAgNTM0
LjQ3MjY3NV0gQlVHOiBLQVNBTjogdXNlLWFmdGVyLWZyZWUgaW4gX19pOTE1X2FjdGl2ZV9mZW5j
ZV9zZXQrMHgyNmQvMHgzZDAgW2k5MTVdCj4gWyAgNTM0LjQ3MjY3OV0gV3JpdGUgb2Ygc2l6ZSA4
IGF0IGFkZHIgZmZmZjg4ODNmMDM3MjM4OCBieSB0YXNrIGdsbWFyazIvMzE5OQo+IAo+IFsgIDUz
NC40NzI2ODRdIENQVTogMyBQSUQ6IDMxOTkgQ29tbTogZ2xtYXJrMiBUYWludGVkOiBHICAgICBV
ICAgICAgRSAgICAgNS40LjAtcmM4ICM4Cj4gWyAgNTM0LjQ3MjY4N10gQ2FsbCBUcmFjZToKPiBb
ICA1MzQuNDcyNjkzXSAgZHVtcF9zdGFjaysweDk1LzB4ZDUKPiBbICA1MzQuNDcyNzIyXSAgPyBf
X2k5MTVfYWN0aXZlX2ZlbmNlX3NldCsweDI2ZC8weDNkMCBbaTkxNV0KPiBbICA1MzQuNDcyNzI3
XSAgcHJpbnRfYWRkcmVzc19kZXNjcmlwdGlvbi5jb25zdHByb3AuNSsweDIwLzB4MzIwCj4gWyAg
NTM0LjQ3Mjc1MV0gID8gX19pOTE1X2FjdGl2ZV9mZW5jZV9zZXQrMHgyNmQvMHgzZDAgW2k5MTVd
Cj4gWyAgNTM0LjQ3Mjc5Ml0gID8gX19pOTE1X2FjdGl2ZV9mZW5jZV9zZXQrMHgyNmQvMHgzZDAg
W2k5MTVdCj4gWyAgNTM0LjQ3Mjc5NF0gIF9fa2FzYW5fcmVwb3J0KzB4MTQ5LzB4MThjCj4gWyAg
NTM0LjQ3Mjc5OF0gID8gX3Jhd19zcGluX2xvY2srMHgxLzB4ZDAKPiBbICA1MzQuNDcyODIwXSAg
PyBfX2k5MTVfYWN0aXZlX2ZlbmNlX3NldCsweDI2ZC8weDNkMCBbaTkxNV0KPiBbICA1MzQuNDcy
ODIyXSAga2FzYW5fcmVwb3J0KzB4MTIvMHgyMAo+IFsgIDUzNC40NzI4MjVdICBfX2FzYW5fcmVw
b3J0X3N0b3JlOF9ub2Fib3J0KzB4MTcvMHgyMAo+IFsgIDUzNC40NzI4NDddICBfX2k5MTVfYWN0
aXZlX2ZlbmNlX3NldCsweDI2ZC8weDNkMCBbaTkxNV0KPiBbICA1MzQuNDcyODcwXSAgaTkxNV9h
Y3RpdmVfcmVmKzB4MmM4LzB4NTMwIFtpOTE1XQo+IFsgIDUzNC40NzI4NzRdICA/IGRtYV9yZXN2
X2FkZF9zaGFyZWRfZmVuY2UrMHgyOTEvMHg0NjAKPiBbICA1MzQuNDcyOTAyXSAgX19pOTE1X3Zt
YV9tb3ZlX3RvX2FjdGl2ZSsweDU2LzB4NzAgW2k5MTVdCj4gWyAgNTM0LjQ3MjkyN10gIGk5MTVf
dm1hX21vdmVfdG9fYWN0aXZlKzB4NTQvMHg0MjAgW2k5MTVdCj4gWyAgNTM0LjQ3MjkzMV0gID8g
bXV0ZXhfdW5sb2NrKzB4MjIvMHg0MAo+IFsgIDUzNC40NzI5NTddICBpOTE1X2dlbV9kb19leGVj
YnVmZmVyKzB4MWQ0NS8weDNlMjAgW2k5MTVdCj4gWyAgNTM0LjQ3Mjk1OV0gID8gX19rbWFsbG9j
X25vZGUrMHgxMmMvMHgzNTAKPiBbICA1MzQuNDcyOTgzXSAgPyBlYl9yZWxvY2F0ZV9zbG93KzB4
YjQwLzB4YjQwIFtpOTE1XQo+IFsgIDUzNC40NzI5ODVdICA/IF9yYXdfd3JpdGVfdHJ5bG9jaysw
eDExMC8weDExMAo+IFsgIDUzNC40NzI5ODddICA/IGdldF9wYXJ0aWFsX25vZGUuaXNyYS43Misw
eDUxLzB4MjYwCj4gWyAgNTM0LjQ3Mjk5MV0gID8gdW5peF9zdHJlYW1fcmVhZF9nZW5lcmljKzB4
NTgzLzB4MWE4MAo+IFsgIDUzNC40NzI5OTRdICA/IF9fX3NsYWJfYWxsb2MrMHgxZDgvMHg1NTAK
PiBbICA1MzQuNDcyOTk4XSAgPyBrdm1hbGxvY19ub2RlKzB4MzEvMHg4MAo+IFsgIDUzNC40NzMw
MDBdICA/IGthc2FuX3VucG9pc29uX3NoYWRvdysweDM1LzB4NTAKPiBbICA1MzQuNDczMDAyXSAg
PyBfcmF3X3NwaW5fbG9jaysweDdiLzB4ZDAKPiBbICA1MzQuNDczMDA0XSAgPyByYWRpeF90cmVl
X2xvb2t1cCsweGQvMHgxMAo+IFsgIDUzNC40NzMwMDZdICA/IGlkcl9maW5kKzB4M2IvMHg2MAo+
IFsgIDUzNC40NzMwMjldICBpOTE1X2dlbV9leGVjYnVmZmVyMl9pb2N0bCsweDYzNC8weDhhMCBb
aTkxNV0KPiBbICA1MzQuNDczMDUyXSAgPyBpOTE1X2dlbV9leGVjYnVmZmVyX2lvY3RsKzB4ZDUw
LzB4ZDUwIFtpOTE1XQo+IFsgIDUzNC40NzMwNTRdICA/IHVuaXhfc3RyZWFtX3JlY3Ztc2crMHg5
Ny8weGQwCj4gWyAgNTM0LjQ3MzA1Nl0gID8gdW5peF9zdHJlYW1fc3BsaWNlX3JlYWQrMHgxYzAv
MHgxYzAKPiBbICA1MzQuNDczMDU4XSAgPyBfX3VuaXhfaW5zZXJ0X3NvY2tldCsweDE4MC8weDE4
MAo+IFsgIDUzNC40NzMwODFdICA/IGk5MTVfZ2VtX2V4ZWNidWZmZXJfaW9jdGwrMHhkNTAvMHhk
NTAgW2k5MTVdCj4gWyAgNTM0LjQ3MzA5NF0gIGRybV9pb2N0bF9rZXJuZWwrMHgxZWQvMHgyYjAg
W2RybV0KPiBbICA1MzQuNDczMTAzXSAgPyBkcm1fc2V0dmVyc2lvbisweDhjMC8weDhjMCBbZHJt
XQo+IFsgIDUzNC40NzMxMDZdICA/IF9fa2FzYW5fY2hlY2tfd3JpdGUrMHgxNC8weDIwCj4gWyAg
NTM0LjQ3MzExNV0gIGRybV9pb2N0bCsweDY4Yi8weGFhMCBbZHJtXQo+IC4uLgo+IAo+IFsgIDUz
NC40NzMyMzldIEFsbG9jYXRlZCBieSB0YXNrIDMxOTk6Cj4gWyAgNTM0LjQ3MzI0MV0gIHNhdmVf
c3RhY2srMHgyMS8weDkwCj4gWyAgNTM0LjQ3MzI0M10gIF9fa2FzYW5fa21hbGxvYy5jb25zdHBy
b3AuOCsweGE3LzB4ZDAKPiBbICA1MzQuNDczMjQ1XSAga2FzYW5fc2xhYl9hbGxvYysweDExLzB4
MjAKPiBbICA1MzQuNDczMjQ2XSAga21lbV9jYWNoZV9hbGxvYysweGNlLzB4MjQwCj4gWyAgNTM0
LjQ3MzI3M10gIGk5MTVfYWN0aXZlX3JlZisweGMyLzB4NTMwIFtpOTE1XQo+IFsgIDUzNC40NzMz
MDJdICBfX2k5MTVfdm1hX21vdmVfdG9fYWN0aXZlKzB4NTYvMHg3MCBbaTkxNV0KPiBbICA1MzQu
NDczMzI4XSAgaTkxNV92bWFfbW92ZV90b19hY3RpdmUrMHg1NC8weDQyMCBbaTkxNV0KPiBbICA1
MzQuNDczMzU1XSAgaTkxNV9nZW1fZG9fZXhlY2J1ZmZlcisweDFkNDUvMHgzZTIwIFtpOTE1XQo+
IFsgIDUzNC40NzMzODFdICBpOTE1X2dlbV9leGVjYnVmZmVyMl9pb2N0bCsweDYzNC8weDhhMCBb
aTkxNV0KPiBbICA1MzQuNDczMzkyXSAgZHJtX2lvY3RsX2tlcm5lbCsweDFlZC8weDJiMCBbZHJt
XQo+IFsgIDUzNC40NzM0MDJdICBkcm1faW9jdGwrMHg2OGIvMHhhYTAgW2RybV0KPiBbICA1MzQu
NDczNDA0XSAgZG9fdmZzX2lvY3RsKzB4MTlhLzB4ZjEwCj4gWyAgNTM0LjQ3MzQwNV0gIGtzeXNf
aW9jdGwrMHg3NS8weDgwCj4gWyAgNTM0LjQ3MzQwN10gIF9feDY0X3N5c19pb2N0bCsweDczLzB4
YjAKPiBbICA1MzQuNDczNDA4XSAgZG9fc3lzY2FsbF82NCsweDlmLzB4M2EwCj4gWyAgNTM0LjQ3
MzQxMF0gIGVudHJ5X1NZU0NBTExfNjRfYWZ0ZXJfaHdmcmFtZSsweDQ0LzB4YTkKPiAKPiBbICA1
MzQuNDczNDEyXSBGcmVlZCBieSB0YXNrIDA6Cj4gWyAgNTM0LjQ3MzQxNF0gIHNhdmVfc3RhY2sr
MHgyMS8weDkwCj4gWyAgNTM0LjQ3MzQxNV0gIF9fa2FzYW5fc2xhYl9mcmVlKzB4MTM3LzB4MTkw
Cj4gWyAgNTM0LjQ3MzQxN10gIGthc2FuX3NsYWJfZnJlZSsweGUvMHgxMAo+IFsgIDUzNC40NzM0
MThdICBrbWVtX2NhY2hlX2ZyZWUrMHhlYi8weDJjMAo+IFsgIDUzNC40NzM0NDRdICBfX2FjdGl2
ZV9yZXRpcmUrMHgxZjIvMHgyNDAgW2k5MTVdCj4gWyAgNTM0LjQ3MzQ3MV0gIGFjdGl2ZV9yZXRp
cmUrMHgxM2IvMHgxYjAgW2k5MTVdCj4gWyAgNTM0LjQ3MzQ5Nl0gIG5vZGVfcmV0aXJlKzB4NTQv
MHg4MCBbaTkxNV0KPiBbICA1MzQuNDczNTIzXSAgaW50ZWxfZW5naW5lX2JyZWFkY3J1bWJzX2ly
cSsweDVmMC8weGQxMCBbaTkxNV0KPiBbICA1MzQuNDczNTQ5XSAgY3NfaXJxX2hhbmRsZXIrMHg2
Ni8weGIwIFtpOTE1XQo+IFsgIDUzNC40NzM1NzVdICBnZW4xMV9ndF9pcnFfaGFuZGxlcisweDI2
Yy8weDQwMCBbaTkxNV0KPiBbICA1MzQuNDczNjAwXSAgZ2VuMTFfaXJxX2hhbmRsZXIrMHhjMy8w
eDI1MCBbaTkxNV0KPiBbICA1MzQuNDczNjAzXSAgX19oYW5kbGVfaXJxX2V2ZW50X3BlcmNwdSsw
eGUwLzB4NGMwCj4gWyAgNTM0LjQ3MzYwNV0gIGhhbmRsZV9pcnFfZXZlbnRfcGVyY3B1KzB4NzEv
MHgxNDAKPiBbICA1MzQuNDczNjA2XSAgaGFuZGxlX2lycV9ldmVudCsweGFkLzB4MTQwCj4gWyAg
NTM0LjQ3MzYwOF0gIGhhbmRsZV9lZGdlX2lycSsweDFmNi8weDc4MAo+IFsgIDUzNC40NzM2MTBd
ICBkb19JUlErMHg5Zi8weDFmMAo+IAo+IFsgIDUzNC40NzM2MTJdIFRoZSBidWdneSBhZGRyZXNz
IGJlbG9uZ3MgdG8gdGhlIG9iamVjdCBhdCBmZmZmODg4M2YwMzcyMzgwCj4gICAgICAgICAgICAg
ICAgIHdoaWNoIGJlbG9uZ3MgdG8gdGhlIGNhY2hlIGFjdGl2ZV9ub2RlIG9mIHNpemUgNzIKPiBb
ICA1MzQuNDczNjE1XSBUaGUgYnVnZ3kgYWRkcmVzcyBpcyBsb2NhdGVkIDggYnl0ZXMgaW5zaWRl
IG9mCj4gCj4gPT09Cj4gCj4gVGhlIHJhY2Ugc2NlbmVyaW8gaXMgbGlrZToKPiBJbml0aWFsbHkg
cmVmLT5jb3VudCBpcyAxLCBpbnRlcnJ1cHQgaGFuZGxlciBpcyB0cnlpbmcgdG8gZnJlZSB0aGUK
PiBub2RlLgo+IAo+ID09PQo+IENQVUEgaW4gaW50ZXJydXB0IGNvbnRleHQgICAgICAgICAgICAg
ICAgQ1BVQiBpbiBpOTE1X2dlbV9leGVjYnVmZmVyMl9pb2N0bAo+IF9fYWN0aXZlX3JldGlyZSAt
LT4KPiAgIHNwaW5fbG9jaygmcmVmLT50cmVlX2xvY2spCj4gICBkZWNyZWFzZSByZWYtPmNvdW50
IHRvIDAKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk5MTVfYWN0
aXZlX3JlZiAtLT4KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
aW5jcmVhc2UgcmVmLT5jb3VudCB0byAxCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIChpOTE1X2FjdGl2ZV9hY3F1aXJlKQo+IAo+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBnZXQgdGhlIGRpcnR5IHJlZi0+Y2FjaGUKPiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKFJFQURfT05DRShyZWYt
PmNhY2hlKSkKPiAKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cmV0dXJuIHRoZSBkaXJ0eSBub2RlCj4gCj4gICBzZXQgcmVmLT5jYWNoZSB0byBOVUxMCj4gICBz
cGluX3VubG9jaygmcmVmLT50cmVlX2xvY2spCj4gICBmcmVlIHRoZSBub2RlCj4gCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpdCB1c2UtYWZ0ZXItZnJlZSBp
bgo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2k5MTVf
YWN0aXZlX2ZlbmNlX3NldCgpCj4gCj4gPT09Cj4gCj4gSGVyZSB3ZSBuZWVkIHRvIHVzZSBzcGlu
bG9jayByZWYtPnRyZWVfbG9jayB0byBwcm90ZWN0IHRoZSBhY2Nlc3MKPiBvZiBSRUFEX09OQ0Uo
cmVmLT5jYWNoZSksIHRoZW4gdGhlIHJhY2Ugc2NlbmVyaW8gY2FuIGJlIHJlc29sdmVkLgo+IAo+
IHdpdGggdGhpcyBwYXRjaCwgaXQgcGFzc2VkIG91ciBzdHJlc3MgdGVzdCBmb3IgYSB2ZXJ5IGxv
bmcgdGltZS4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBDaHVhbnNoZW5nIExpdSA8Y2h1YW5zaGVuZy5s
aXVAaW50ZWwuY29tPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5j
IHwgMyArKysKPiAgMSBmaWxlIGNoYW5nZWQsIDMgaW5zZXJ0aW9ucygrKQo+IAo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9hY3RpdmUuYwo+IGluZGV4IGRjYTE1YWNlODhmNi4uM2Q2OGI5MTBlOTQ5IDEw
MDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jCj4gQEAgLTIxNCw3ICsyMTQsMTAgQEAg
YWN0aXZlX2luc3RhbmNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBzdHJ1Y3QgaW50ZWxfdGlt
ZWxpbmUgKnRsKQo+ICAgICAgICAgICogYWZ0ZXIgdGhlIHByZXZpb3VzIGFjdGl2aXR5IGhhcyBi
ZWVuIHJldGlyZWQsIG9yIGlmIGl0IG1hdGNoZXMgdGhlCj4gICAgICAgICAgKiBjdXJyZW50IHRp
bWVsaW5lLgo+ICAgICAgICAgICovCj4gKyAgICAgICBzcGluX2xvY2tfaXJxKCZyZWYtPnRyZWVf
bG9jayk7Cj4gICAgICAgICBub2RlID0gUkVBRF9PTkNFKHJlZi0+Y2FjaGUpOwo+ICsgICAgICAg
c3Bpbl91bmxvY2tfaXJxKCZyZWYtPnRyZWVfbG9jayk7CgpJbmNvcnJlY3QuIFRoZSBzZXJpYWxp
c2F0aW9uIHdpdGggX19hY3RpdmVfcmV0aXJlIGlzIHJlcXVpcmVkIGF0Cmk5MTVfYWN0aXZlX2Fj
cXVpcmUuIFRoZSBwcm9ibGVtIGlzIHRoYXQgc2VyaWFsaXNhdGlvbiB3YXMgcHJvdmlkZWQgYnkK
T0RFQlVHIGZvciBvdXIgQ0kgc28gaXQgd2VudCB1bmRlciB0aGUgcmFkYXIuCi1DaHJpcwpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFp
bGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

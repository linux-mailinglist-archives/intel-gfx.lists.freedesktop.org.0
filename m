Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E2ABE464C96
	for <lists+intel-gfx@lfdr.de>; Wed,  1 Dec 2021 12:30:09 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DCD246EB68;
	Wed,  1 Dec 2021 11:30:07 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E27EB6EB30
 for <intel-gfx@lists.freedesktop.org>; Wed,  1 Dec 2021 11:30:06 +0000 (UTC)
X-IronPort-AV: E=McAfee;i="6200,9189,10184"; a="236259192"
X-IronPort-AV: E=Sophos;i="5.87,278,1631602800"; d="scan'208";a="236259192"
Received: from fmsmga004.fm.intel.com ([10.253.24.48])
 by orsmga102.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 01 Dec 2021 03:30:03 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.87,278,1631602800"; d="scan'208";a="576243456"
Received: from irsmsx606.ger.corp.intel.com ([163.33.146.139])
 by fmsmga004.fm.intel.com with ESMTP; 01 Dec 2021 03:30:02 -0800
Received: from irsmsx605.ger.corp.intel.com (163.33.146.138) by
 IRSMSX606.ger.corp.intel.com (163.33.146.139) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.2308.20; Wed, 1 Dec 2021 11:30:01 +0000
Received: from irsmsx605.ger.corp.intel.com ([163.33.146.138]) by
 IRSMSX605.ger.corp.intel.com ([163.33.146.138]) with mapi id 15.01.2308.020;
 Wed, 1 Dec 2021 11:30:01 +0000
From: "Kahola, Mika" <mika.kahola@intel.com>
To: Ville Syrjala <ville.syrjala@linux.intel.com>,
 "intel-gfx@lists.freedesktop.org" <intel-gfx@lists.freedesktop.org>
Thread-Topic: [Intel-gfx] [PATCH 17/20] drm/i915/fbc: Move plane pointer into
 intel_fbc_state
Thread-Index: AQHX4Se8QM1S/s/QAUWp+Zfw6pfGYKwdixvA
Date: Wed, 1 Dec 2021 11:30:01 +0000
Message-ID: <a897c2b024dd4ab48f8769e9a0ae16a1@intel.com>
References: <20211124113652.22090-1-ville.syrjala@linux.intel.com>
 <20211124113652.22090-18-ville.syrjala@linux.intel.com>
In-Reply-To: <20211124113652.22090-18-ville.syrjala@linux.intel.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [163.33.253.164]
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [PATCH 17/20] drm/i915/fbc: Move plane pointer into
 intel_fbc_state
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

PiAtLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0tLQ0KPiBGcm9tOiBJbnRlbC1nZnggPGludGVsLWdm
eC1ib3VuY2VzQGxpc3RzLmZyZWVkZXNrdG9wLm9yZz4gT24gQmVoYWxmIE9mIFZpbGxlDQo+IFN5
cmphbGENCj4gU2VudDogV2VkbmVzZGF5LCBOb3ZlbWJlciAyNCwgMjAyMSAxOjM3IFBNDQo+IFRv
OiBpbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnDQo+IFN1YmplY3Q6IFtJbnRlbC1nZnhd
IFtQQVRDSCAxNy8yMF0gZHJtL2k5MTUvZmJjOiBNb3ZlIHBsYW5lIHBvaW50ZXIgaW50bw0KPiBp
bnRlbF9mYmNfc3RhdGUNCj4gDQo+IEZyb206IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFs
YUBsaW51eC5pbnRlbC5jb20+DQo+IA0KPiBDdXJyZW50bHkgd2UgdHJhY2sgdGhlIEZCQyBwbGFu
ZSBhcyBhIHBvaW50ZXIgdW5kZXIgaW50ZWxfZmJjIGFuZCBhbHNvIGFzIGENCj4gaTl4eF9wbGFu
ZV9pZCB1bmRlciBpbnRlbF9mYmNfc3RhdGUuIEp1c3Qgc3RvcmUgdGhlIHBvaW50ZXIgb25jZSBp
biB0aGUgZmJjIHN0YXRlLg0KPiANCj4gU2lnbmVkLW9mZi1ieTogVmlsbGUgU3lyasOkbMOkIDx2
aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4NCg0KUmV2aWV3ZWQtYnk6IE1pa2EgS2Fob2xh
IDxtaWthLmthaG9sYUBpbnRlbC5jb20+DQoNCj4gLS0tDQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ludGVsX2ZiYy5jIHwgNTQgKysrKysrKysrKysrLS0tLS0tLS0tLS0tDQo+ICAx
IGZpbGUgY2hhbmdlZCwgMjYgaW5zZXJ0aW9ucygrKSwgMjggZGVsZXRpb25zKC0pDQo+IA0KPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9mYmMuYw0KPiBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZmJjLmMNCj4gaW5kZXggN2QxMjhh
NDllOGUxLi5iNjkxOWNhODcxMzggMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZmJjLmMNCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9mYmMuYw0KPiBAQCAtNjAsNyArNjAsNyBAQCBzdHJ1Y3QgaW50ZWxfZmJjX2Z1bmNz
IHsgIH07DQo+IA0KPiAgc3RydWN0IGludGVsX2ZiY19zdGF0ZSB7DQo+IC0JZW51bSBpOXh4X3Bs
YW5lX2lkIGk5eHhfcGxhbmU7DQo+ICsJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsNCj4gIAl1
bnNpZ25lZCBpbnQgY2ZiX3N0cmlkZTsNCj4gIAl1bnNpZ25lZCBpbnQgY2ZiX3NpemU7DQo+ICAJ
dW5zaWduZWQgaW50IGZlbmNlX3lfb2Zmc2V0Ow0KPiBAQCAtODEsNyArODEsNiBAQCBzdHJ1Y3Qg
aW50ZWxfZmJjIHsNCj4gIAlzdHJ1Y3QgbXV0ZXggbG9jazsNCj4gIAl1bnNpZ25lZCBpbnQgcG9z
c2libGVfZnJhbWVidWZmZXJfYml0czsNCj4gIAl1bnNpZ25lZCBpbnQgYnVzeV9iaXRzOw0KPiAt
CXN0cnVjdCBpbnRlbF9wbGFuZSAqcGxhbmU7DQo+IA0KPiAgCXN0cnVjdCBkcm1fbW1fbm9kZSBj
b21wcmVzc2VkX2ZiOw0KPiAgCXN0cnVjdCBkcm1fbW1fbm9kZSBjb21wcmVzc2VkX2xsYjsNCj4g
QEAgLTI0NCw3ICsyNDMsNyBAQCBzdGF0aWMgdTMyIGk5NjVfZmJjX2N0bDIoc3RydWN0IGludGVs
X2ZiYyAqZmJjKQ0KPiAgCXUzMiBmYmNfY3RsMjsNCj4gDQo+ICAJZmJjX2N0bDIgPSBGQkNfQ1RM
X0ZFTkNFX0RCTCB8IEZCQ19DVExfSURMRV9JTU0gfA0KPiAtCQlGQkNfQ1RMX1BMQU5FKHBhcmFt
cy0+aTl4eF9wbGFuZSk7DQo+ICsJCUZCQ19DVExfUExBTkUocGFyYW1zLT5wbGFuZS0+aTl4eF9w
bGFuZSk7DQo+IA0KPiAgCWlmIChwYXJhbXMtPmZlbmNlX2lkID49IDApDQo+ICAJCWZiY19jdGwy
IHw9IEZCQ19DVExfQ1BVX0ZFTkNFX0VOOw0KPiBAQCAtMzA4LDcgKzMwNyw3IEBAIHN0YXRpYyBi
b29sIGk4eHhfZmJjX2lzX2NvbXByZXNzaW5nKHN0cnVjdCBpbnRlbF9mYmMNCj4gKmZiYykgIHN0
YXRpYyB2b2lkIGk4eHhfZmJjX251a2Uoc3RydWN0IGludGVsX2ZiYyAqZmJjKSAgew0KPiAgCXN0
cnVjdCBpbnRlbF9mYmNfc3RhdGUgKnBhcmFtcyA9ICZmYmMtPnBhcmFtczsNCj4gLQllbnVtIGk5
eHhfcGxhbmVfaWQgaTl4eF9wbGFuZSA9IHBhcmFtcy0+aTl4eF9wbGFuZTsNCj4gKwllbnVtIGk5
eHhfcGxhbmVfaWQgaTl4eF9wbGFuZSA9IHBhcmFtcy0+cGxhbmUtPmk5eHhfcGxhbmU7DQo+ICAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZmJjLT5pOTE1Ow0KPiANCj4gIAlz
cGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+dW5jb3JlLmxvY2spOw0KPiBAQCAtMzQ0LDcgKzM0Myw3
IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfZmJjX2Z1bmNzIGk4eHhfZmJjX2Z1bmNzID0g
ew0KPiBzdGF0aWMgdm9pZCBpOTY1X2ZiY19udWtlKHN0cnVjdCBpbnRlbF9mYmMgKmZiYykgIHsN
Cj4gIAlzdHJ1Y3QgaW50ZWxfZmJjX3N0YXRlICpwYXJhbXMgPSAmZmJjLT5wYXJhbXM7DQo+IC0J
ZW51bSBpOXh4X3BsYW5lX2lkIGk5eHhfcGxhbmUgPSBwYXJhbXMtPmk5eHhfcGxhbmU7DQo+ICsJ
ZW51bSBpOXh4X3BsYW5lX2lkIGk5eHhfcGxhbmUgPSBwYXJhbXMtPnBsYW5lLT5pOXh4X3BsYW5l
Ow0KPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGZiYy0+aTkxNTsNCj4g
DQo+ICAJc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrKTsNCj4gQEAgLTM4NCw3
ICszODMsNyBAQCBzdGF0aWMgdTMyIGc0eF9kcGZjX2N0bChzdHJ1Y3QgaW50ZWxfZmJjICpmYmMp
DQo+ICAJdTMyIGRwZmNfY3RsOw0KPiANCj4gIAlkcGZjX2N0bCA9IGc0eF9kcGZjX2N0bF9saW1p
dChmYmMpIHwNCj4gLQkJRFBGQ19DVExfUExBTkVfRzRYKHBhcmFtcy0+aTl4eF9wbGFuZSk7DQo+
ICsJCURQRkNfQ1RMX1BMQU5FX0c0WChwYXJhbXMtPnBsYW5lLT5pOXh4X3BsYW5lKTsNCj4gDQo+
ICAJaWYgKElTX0c0WChpOTE1KSkNCj4gIAkJZHBmY19jdGwgfD0gRFBGQ19DVExfU1JfRU47DQo+
IEBAIC01NzYsNyArNTc1LDcgQEAgc3RhdGljIHUzMiBpdmJfZHBmY19jdGwoc3RydWN0IGludGVs
X2ZiYyAqZmJjKQ0KPiAgCWRwZmNfY3RsID0gZzR4X2RwZmNfY3RsX2xpbWl0KGZiYyk7DQo+IA0K
PiAgCWlmIChJU19JVllCUklER0UoaTkxNSkpDQo+IC0JCWRwZmNfY3RsIHw9IERQRkNfQ1RMX1BM
QU5FX0lWQihwYXJhbXMtPmk5eHhfcGxhbmUpOw0KPiArCQlkcGZjX2N0bCB8PSBEUEZDX0NUTF9Q
TEFORV9JVkIocGFyYW1zLT5wbGFuZS0+aTl4eF9wbGFuZSk7DQo+IA0KPiAgCWlmIChwYXJhbXMt
PmZlbmNlX2lkID49IDApDQo+ICAJCWRwZmNfY3RsIHw9IERQRkNfQ1RMX0ZFTkNFX0VOX0lWQjsN
Cj4gQEAgLTYzMiw3ICs2MzEsNyBAQCBzdGF0aWMgYm9vbCBpbnRlbF9mYmNfaHdfaXNfYWN0aXZl
KHN0cnVjdCBpbnRlbF9mYmMgKmZiYykNCj4gDQo+ICBzdGF0aWMgdm9pZCBpbnRlbF9mYmNfaHdf
YWN0aXZhdGUoc3RydWN0IGludGVsX2ZiYyAqZmJjKSAgew0KPiAtCXRyYWNlX2ludGVsX2ZiY19h
Y3RpdmF0ZShmYmMtPnBsYW5lKTsNCj4gKwl0cmFjZV9pbnRlbF9mYmNfYWN0aXZhdGUoZmJjLT5w
YXJhbXMucGxhbmUpOw0KPiANCj4gIAlmYmMtPmFjdGl2ZSA9IHRydWU7DQo+ICAJZmJjLT5hY3Rp
dmF0ZWQgPSB0cnVlOw0KPiBAQCAtNjQyLDcgKzY0MSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Zi
Y19od19hY3RpdmF0ZShzdHJ1Y3QgaW50ZWxfZmJjICpmYmMpDQo+IA0KPiAgc3RhdGljIHZvaWQg
aW50ZWxfZmJjX2h3X2RlYWN0aXZhdGUoc3RydWN0IGludGVsX2ZiYyAqZmJjKSAgew0KPiAtCXRy
YWNlX2ludGVsX2ZiY19kZWFjdGl2YXRlKGZiYy0+cGxhbmUpOw0KPiArCXRyYWNlX2ludGVsX2Zi
Y19kZWFjdGl2YXRlKGZiYy0+cGFyYW1zLnBsYW5lKTsNCj4gDQo+ICAJZmJjLT5hY3RpdmUgPSBm
YWxzZTsNCj4gDQo+IEBAIC02NTYsNyArNjU1LDcgQEAgc3RhdGljIGJvb2wgaW50ZWxfZmJjX2lz
X2NvbXByZXNzaW5nKHN0cnVjdCBpbnRlbF9mYmMNCj4gKmZiYykNCj4gDQo+ICBzdGF0aWMgdm9p
ZCBpbnRlbF9mYmNfbnVrZShzdHJ1Y3QgaW50ZWxfZmJjICpmYmMpICB7DQo+IC0JdHJhY2VfaW50
ZWxfZmJjX251a2UoZmJjLT5wbGFuZSk7DQo+ICsJdHJhY2VfaW50ZWxfZmJjX251a2UoZmJjLT5w
YXJhbXMucGxhbmUpOw0KPiANCj4gIAlmYmMtPmZ1bmNzLT5udWtlKGZiYyk7DQo+ICB9DQo+IEBA
IC05NTksNyArOTU4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZmJjX3VwZGF0ZV9zdGF0ZV9jYWNo
ZShzdHJ1Y3QNCj4gaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwNCj4gIAlpZiAocGxhbmVfc3Rh
dGUtPm5vX2ZiY19yZWFzb24pDQo+ICAJCXJldHVybjsNCj4gDQo+IC0JY2FjaGUtPmk5eHhfcGxh
bmUgPSBwbGFuZS0+aTl4eF9wbGFuZTsNCj4gKwljYWNoZS0+cGxhbmUgPSBwbGFuZTsNCj4gDQo+
ICAJLyogRkJDMSBjb21wcmVzc2lvbiBpbnRlcnZhbDogYXJiaXRyYXJ5IGNob2ljZSBvZiAxIHNl
Y29uZCAqLw0KPiAgCWNhY2hlLT5pbnRlcnZhbCA9IGRybV9tb2RlX3ZyZWZyZXNoKCZjcnRjX3N0
YXRlLQ0KPiA+aHcuYWRqdXN0ZWRfbW9kZSk7DQo+IEBAIC0xMjMzLDcgKzEyMzIsNyBAQCBib29s
IGludGVsX2ZiY19wcmVfdXBkYXRlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUNCj4gKnN0YXRl
LA0KPiANCj4gIAkJbXV0ZXhfbG9jaygmZmJjLT5sb2NrKTsNCj4gDQo+IC0JCWlmIChmYmMtPnBs
YW5lID09IHBsYW5lKQ0KPiArCQlpZiAoZmJjLT5wYXJhbXMucGxhbmUgPT0gcGxhbmUpDQo+ICAJ
CQluZWVkX3ZibGFua193YWl0IHw9IF9faW50ZWxfZmJjX3ByZV91cGRhdGUoc3RhdGUsDQo+IGNy
dGMsIHBsYW5lKTsNCj4gDQo+ICAJCW11dGV4X3VubG9jaygmZmJjLT5sb2NrKTsNCj4gQEAgLTEy
NDUsMTAgKzEyNDQsMTAgQEAgYm9vbCBpbnRlbF9mYmNfcHJlX3VwZGF0ZShzdHJ1Y3QNCj4gaW50
ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwgIHN0YXRpYyB2b2lkIF9faW50ZWxfZmJjX2Rpc2FibGUo
c3RydWN0IGludGVsX2ZiYyAqZmJjKQ0KPiB7DQo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBmYmMtPmk5MTU7DQo+IC0Jc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IGZiYy0+
cGxhbmU7DQo+ICsJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSA9IGZiYy0+cGFyYW1zLnBsYW5l
Ow0KPiANCj4gIAlkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCAhbXV0ZXhfaXNfbG9ja2VkKCZmYmMt
PmxvY2spKTsNCj4gLQlkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCAhZmJjLT5wbGFuZSk7DQo+ICsJ
ZHJtX1dBUk5fT04oJmk5MTUtPmRybSwgIWZiYy0+cGFyYW1zLnBsYW5lKTsNCj4gIAlkcm1fV0FS
Tl9PTigmaTkxNS0+ZHJtLCBmYmMtPmFjdGl2ZSk7DQo+IA0KPiAgCWRybV9kYmdfa21zKCZpOTE1
LT5kcm0sICJEaXNhYmxpbmcgRkJDIG9uIFtQTEFORTolZDolc11cbiIsIEBAIC0NCj4gMTI1Niw3
ICsxMjU1LDcgQEAgc3RhdGljIHZvaWQgX19pbnRlbF9mYmNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxf
ZmJjICpmYmMpDQo+IA0KPiAgCV9faW50ZWxfZmJjX2NsZWFudXBfY2ZiKGZiYyk7DQo+IA0KPiAt
CWZiYy0+cGxhbmUgPSBOVUxMOw0KPiArCWZiYy0+cGFyYW1zLnBsYW5lID0gTlVMTDsNCj4gIH0N
Cj4gDQo+ICBzdGF0aWMgdm9pZCBfX2ludGVsX2ZiY19wb3N0X3VwZGF0ZShzdHJ1Y3QgaW50ZWxf
ZmJjICpmYmMpIEBAIC0xMjg2LDcgKzEyODUsNw0KPiBAQCB2b2lkIGludGVsX2ZiY19wb3N0X3Vw
ZGF0ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwNCj4gDQo+ICAJCW11dGV4X2xv
Y2soJmZiYy0+bG9jayk7DQo+IA0KPiAtCQlpZiAoZmJjLT5wbGFuZSA9PSBwbGFuZSkgew0KPiAr
CQlpZiAoZmJjLT5wYXJhbXMucGxhbmUgPT0gcGxhbmUpIHsNCj4gIAkJCWZiYy0+ZmxpcF9wZW5k
aW5nID0gZmFsc2U7DQo+ICAJCQlfX2ludGVsX2ZiY19wb3N0X3VwZGF0ZShmYmMpOw0KPiAgCQl9
DQo+IEBAIC0xMjk3LDggKzEyOTYsOCBAQCB2b2lkIGludGVsX2ZiY19wb3N0X3VwZGF0ZShzdHJ1
Y3QgaW50ZWxfYXRvbWljX3N0YXRlDQo+ICpzdGF0ZSwNCj4gDQo+ICBzdGF0aWMgdW5zaWduZWQg
aW50IGludGVsX2ZiY19nZXRfZnJvbnRidWZmZXJfYml0KHN0cnVjdCBpbnRlbF9mYmMgKmZiYykg
IHsNCj4gLQlpZiAoZmJjLT5wbGFuZSkNCj4gLQkJcmV0dXJuIGZiYy0+cGxhbmUtPmZyb250YnVm
ZmVyX2JpdDsNCj4gKwlpZiAoZmJjLT5wYXJhbXMucGxhbmUpDQo+ICsJCXJldHVybiBmYmMtPnBh
cmFtcy5wbGFuZS0+ZnJvbnRidWZmZXJfYml0Ow0KPiAgCWVsc2UNCj4gIAkJcmV0dXJuIGZiYy0+
cG9zc2libGVfZnJhbWVidWZmZXJfYml0czsgIH0gQEAgLTEzMTksNyArMTMxOCw3DQo+IEBAIHZv
aWQgaW50ZWxfZmJjX2ludmFsaWRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsDQo+
IA0KPiAgCWZiYy0+YnVzeV9iaXRzIHw9IGludGVsX2ZiY19nZXRfZnJvbnRidWZmZXJfYml0KGZi
YykgJiBmcm9udGJ1ZmZlcl9iaXRzOw0KPiANCj4gLQlpZiAoZmJjLT5wbGFuZSAmJiBmYmMtPmJ1
c3lfYml0cykNCj4gKwlpZiAoZmJjLT5wYXJhbXMucGxhbmUgJiYgZmJjLT5idXN5X2JpdHMpDQo+
ICAJCWludGVsX2ZiY19kZWFjdGl2YXRlKGZiYywgImZyb250YnVmZmVyIHdyaXRlIik7DQo+IA0K
PiAgCW11dGV4X3VubG9jaygmZmJjLT5sb2NrKTsNCj4gQEAgLTEzNDAsNyArMTMzOSw3IEBAIHZv
aWQgaW50ZWxfZmJjX2ZsdXNoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LA0KPiAgCWlm
IChvcmlnaW4gPT0gT1JJR0lOX0ZMSVAgfHwgb3JpZ2luID09IE9SSUdJTl9DVVJTT1JfVVBEQVRF
KQ0KPiAgCQlnb3RvIG91dDsNCj4gDQo+IC0JaWYgKCFmYmMtPmJ1c3lfYml0cyAmJiBmYmMtPnBs
YW5lICYmDQo+ICsJaWYgKCFmYmMtPmJ1c3lfYml0cyAmJiBmYmMtPnBhcmFtcy5wbGFuZSAmJg0K
PiAgCSAgICAoZnJvbnRidWZmZXJfYml0cyAmIGludGVsX2ZiY19nZXRfZnJvbnRidWZmZXJfYml0
KGZiYykpKSB7DQo+ICAJCWlmIChmYmMtPmFjdGl2ZSkNCj4gIAkJCWludGVsX2ZiY19udWtlKGZi
Yyk7DQo+IEBAIC0xMzc4LDggKzEzNzcsOCBAQCBzdGF0aWMgdm9pZCBfX2ludGVsX2ZiY19lbmFi
bGUoc3RydWN0DQo+IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsDQo+ICAJCWludGVsX2F0b21p
Y19nZXRfbmV3X3BsYW5lX3N0YXRlKHN0YXRlLCBwbGFuZSk7DQo+ICAJc3RydWN0IGludGVsX2Zi
YyAqZmJjID0gcGxhbmUtPmZiYzsNCj4gDQo+IC0JaWYgKGZiYy0+cGxhbmUpIHsNCj4gLQkJaWYg
KGZiYy0+cGxhbmUgIT0gcGxhbmUpDQo+ICsJaWYgKGZiYy0+cGFyYW1zLnBsYW5lKSB7DQo+ICsJ
CWlmIChmYmMtPnBhcmFtcy5wbGFuZSAhPSBwbGFuZSkNCj4gIAkJCXJldHVybjsNCj4gDQo+ICAJ
CWlmIChpbnRlbF9mYmNfaXNfb2socGxhbmVfc3RhdGUpKQ0KPiBAQCAtMTQxNSw3ICsxNDE0LDYg
QEAgc3RhdGljIHZvaWQgX19pbnRlbF9mYmNfZW5hYmxlKHN0cnVjdA0KPiBpbnRlbF9hdG9taWNf
c3RhdGUgKnN0YXRlLA0KPiAgCWZiYy0+bm9fZmJjX3JlYXNvbiA9ICJGQkMgZW5hYmxlZCBidXQg
bm90IGFjdGl2ZSB5ZXRcbiI7DQo+IA0KPiAgCWludGVsX2ZiY191cGRhdGVfc3RhdGVfY2FjaGUo
c3RhdGUsIGNydGMsIHBsYW5lKTsNCj4gLQlmYmMtPnBsYW5lID0gcGxhbmU7DQo+IA0KPiAgCWlu
dGVsX2ZiY19wcm9ncmFtX2NmYihmYmMpOw0KPiAgfQ0KPiBAQCAtMTQzOCw3ICsxNDM2LDcgQEAg
dm9pZCBpbnRlbF9mYmNfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykNCj4gIAkJCWNv
bnRpbnVlOw0KPiANCj4gIAkJbXV0ZXhfbG9jaygmZmJjLT5sb2NrKTsNCj4gLQkJaWYgKGZiYy0+
cGxhbmUgPT0gcGxhbmUpDQo+ICsJCWlmIChmYmMtPnBhcmFtcy5wbGFuZSA9PSBwbGFuZSkNCj4g
IAkJCV9faW50ZWxfZmJjX2Rpc2FibGUoZmJjKTsNCj4gIAkJbXV0ZXhfdW5sb2NrKCZmYmMtPmxv
Y2spOw0KPiAgCX0NCj4gQEAgLTE0NjIsNyArMTQ2MCw3IEBAIHZvaWQgaW50ZWxfZmJjX3VwZGF0
ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlDQo+ICpzdGF0ZSwNCj4gIAkJbXV0ZXhfbG9jaygm
ZmJjLT5sb2NrKTsNCj4gDQo+ICAJCWlmIChjcnRjX3N0YXRlLT51cGRhdGVfcGlwZSAmJiBwbGFu
ZV9zdGF0ZS0+bm9fZmJjX3JlYXNvbikgew0KPiAtCQkJaWYgKGZiYy0+cGxhbmUgPT0gcGxhbmUp
DQo+ICsJCQlpZiAoZmJjLT5wYXJhbXMucGxhbmUgPT0gcGxhbmUpDQo+ICAJCQkJX19pbnRlbF9m
YmNfZGlzYWJsZShmYmMpOw0KPiAgCQl9IGVsc2Ugew0KPiAgCQkJX19pbnRlbF9mYmNfZW5hYmxl
KHN0YXRlLCBjcnRjLCBwbGFuZSk7IEBAIC0xNDg2LDcNCj4gKzE0ODQsNyBAQCB2b2lkIGludGVs
X2ZiY19nbG9iYWxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkNCj4gIAkJ
cmV0dXJuOw0KPiANCj4gIAltdXRleF9sb2NrKCZmYmMtPmxvY2spOw0KPiAtCWlmIChmYmMtPnBs
YW5lKQ0KPiArCWlmIChmYmMtPnBhcmFtcy5wbGFuZSkNCj4gIAkJX19pbnRlbF9mYmNfZGlzYWJs
ZShmYmMpOw0KPiAgCW11dGV4X3VubG9jaygmZmJjLT5sb2NrKTsNCj4gIH0NCj4gQEAgLTE0OTks
NyArMTQ5Nyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2ZiY191bmRlcnJ1bl93b3JrX2ZuKHN0cnVj
dA0KPiB3b3JrX3N0cnVjdCAqd29yaykNCj4gIAltdXRleF9sb2NrKCZmYmMtPmxvY2spOw0KPiAN
Cj4gIAkvKiBNYXliZSB3ZSB3ZXJlIHNjaGVkdWxlZCB0d2ljZS4gKi8NCj4gLQlpZiAoZmJjLT51
bmRlcnJ1bl9kZXRlY3RlZCB8fCAhZmJjLT5wbGFuZSkNCj4gKwlpZiAoZmJjLT51bmRlcnJ1bl9k
ZXRlY3RlZCB8fCAhZmJjLT5wYXJhbXMucGxhbmUpDQo+ICAJCWdvdG8gb3V0Ow0KPiANCj4gIAlk
cm1fZGJnX2ttcygmaTkxNS0+ZHJtLCAiRGlzYWJsaW5nIEZCQyBkdWUgdG8gRklGTyB1bmRlcnJ1
bi5cbiIpOw0KPiBAQCAtMTUwNyw3ICsxNTA1LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZmJjX3Vu
ZGVycnVuX3dvcmtfZm4oc3RydWN0DQo+IHdvcmtfc3RydWN0ICp3b3JrKQ0KPiANCj4gIAlpbnRl
bF9mYmNfZGVhY3RpdmF0ZShmYmMsICJGSUZPIHVuZGVycnVuIik7DQo+ICAJaWYgKCFmYmMtPmZs
aXBfcGVuZGluZykNCj4gLQkJaW50ZWxfd2FpdF9mb3JfdmJsYW5rKGk5MTUsIGZiYy0+cGxhbmUt
PnBpcGUpOw0KPiArCQlpbnRlbF93YWl0X2Zvcl92YmxhbmsoaTkxNSwgZmJjLT5wYXJhbXMucGxh
bmUtPnBpcGUpOw0KPiAgCV9faW50ZWxfZmJjX2Rpc2FibGUoZmJjKTsNCj4gIG91dDoNCj4gIAlt
dXRleF91bmxvY2soJmZiYy0+bG9jayk7DQo+IC0tDQo+IDIuMzIuMA0KDQo=

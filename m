Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CA49226317
	for <lists+intel-gfx@lfdr.de>; Wed, 22 May 2019 13:38:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 17A6089998;
	Wed, 22 May 2019 11:38:54 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4323989998;
 Wed, 22 May 2019 11:38:52 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16639705-1500050 
 for multiple; Wed, 22 May 2019 12:37:13 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 22 May 2019 12:37:02 +0100
Message-Id: <20190522113712.23512-2-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190522113712.23512-1-chris@chris-wilson.co.uk>
References: <20190522113712.23512-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 02/12] i915/gem_ctx_param: Test set/get
 (copy) VM
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RXhlcmNpc2UgcmV1c2luZyB0aGUgR1RUIG9mIG9uZSBjdHggaW4gYW5vdGhlci4KCnYyOiBUZXN0
IHNldHRpbmcgYmFjayB0byB0aGUgc2FtZSBWTQp2MzogQ2hlY2sgdGhlIFZNIHN0aWxsIGV4aXN0
cyBhZnRlciB0aGUgcGFyZW50IGN0eCBhcmUgZGVhZC4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdp
bHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRr
by51cnN1bGluQGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28u
dXJzdWxpbkBpbnRlbC5jb20+Ci0tLQogdGVzdHMvaTkxNS9nZW1fY3R4X3BhcmFtLmMgfCAxMTYg
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLQogMSBmaWxlIGNoYW5nZWQsIDEw
NCBpbnNlcnRpb25zKCspLCAxMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1
L2dlbV9jdHhfcGFyYW0uYyBiL3Rlc3RzL2k5MTUvZ2VtX2N0eF9wYXJhbS5jCmluZGV4IGI2ZjU3
MjM2Yy4uZmEwYWI1MjAyIDEwMDY0NAotLS0gYS90ZXN0cy9pOTE1L2dlbV9jdHhfcGFyYW0uYwor
KysgYi90ZXN0cy9pOTE1L2dlbV9jdHhfcGFyYW0uYwpAQCAtMjgsNiArMjgsNyBAQAogI2luY2x1
ZGUgPGxpbWl0cy5oPgogCiAjaW5jbHVkZSAiaWd0LmgiCisjaW5jbHVkZSAiaTkxNS9nZW1fdm0u
aCIKIAogSUdUX1RFU1RfREVTQ1JJUFRJT04oIkJhc2ljIHRlc3QgZm9yIGNvbnRleHQgc2V0L2dl
dCBwYXJhbSBpbnB1dCB2YWxpZGF0aW9uLiIpOwogCkBAIC0zNiwxNyArMzcsNiBAQCBJR1RfVEVT
VF9ERVNDUklQVElPTigiQmFzaWMgdGVzdCBmb3IgY29udGV4dCBzZXQvZ2V0IHBhcmFtIGlucHV0
IHZhbGlkYXRpb24uIik7CiAjZGVmaW5lIE5FV19DVFgJQklUKDApCiAjZGVmaW5lIFVTRVIgQklU
KDEpCiAKLXN0YXRpYyBpbnQgcmVvcGVuX2RyaXZlcihpbnQgZmQpCi17Ci0JY2hhciBwYXRoWzI1
Nl07Ci0KLQlzbnByaW50ZihwYXRoLCBzaXplb2YocGF0aCksICIvcHJvYy9zZWxmL2ZkLyVkIiwg
ZmQpOwotCWZkID0gb3BlbihwYXRoLCBPX1JEV1IpOwotCWlndF9hc3NlcnRfbHRlKDAsIGZkKTsK
LQotCXJldHVybiBmZDsKLX0KLQogc3RhdGljIHZvaWQgc2V0X3ByaW9yaXR5KGludCBpOTE1KQog
ewogCXN0YXRpYyBjb25zdCBpbnQ2NF90IHRlc3RfdmFsdWVzW10gPSB7CkBAIC05MSw3ICs4MSw3
IEBAIHN0YXRpYyB2b2lkIHNldF9wcmlvcml0eShpbnQgaTkxNSkKIAlpZ3RfcGVybXV0ZV9hcnJh
eSh2YWx1ZXMsIHNpemUsIGlndF9leGNoYW5nZV9pbnQ2NCk7CiAKIAlpZ3RfZm9yayhmbGFncywg
TkVXX0NUWCB8IFVTRVIpIHsKLQkJaW50IGZkID0gcmVvcGVuX2RyaXZlcihpOTE1KTsKKwkJaW50
IGZkID0gZ2VtX3Jlb3Blbl9kcml2ZXIoaTkxNSk7CiAJCXN0cnVjdCBkcm1faTkxNV9nZW1fY29u
dGV4dF9wYXJhbSBhcmcgPSB7CiAJCQkucGFyYW0gPSBJOTE1X0NPTlRFWFRfUEFSQU1fUFJJT1JJ
VFksCiAJCQkuY3R4X2lkID0gZmxhZ3MgJiBORVdfQ1RYID8gZ2VtX2NvbnRleHRfY3JlYXRlKGZk
KSA6IDAsCkBAIC0xNDMsNiArMTMzLDEwNSBAQCBzdGF0aWMgdm9pZCBzZXRfcHJpb3JpdHkoaW50
IGk5MTUpCiAJZnJlZSh2YWx1ZXMpOwogfQogCitzdGF0aWMgdWludDMyX3QgX19iYXRjaF9jcmVh
dGUoaW50IGk5MTUsIHVpbnQzMl90IG9mZnNldCkKK3sKKwljb25zdCB1aW50MzJfdCBiYmUgPSBN
SV9CQVRDSF9CVUZGRVJfRU5EOworCXVpbnQzMl90IGhhbmRsZTsKKworCWhhbmRsZSA9IGdlbV9j
cmVhdGUoaTkxNSwgQUxJR04ob2Zmc2V0ICsgNCwgNDA5NikpOworCWdlbV93cml0ZShpOTE1LCBo
YW5kbGUsIG9mZnNldCwgJmJiZSwgc2l6ZW9mKGJiZSkpOworCisJcmV0dXJuIGhhbmRsZTsKK30K
Kworc3RhdGljIHVpbnQzMl90IGJhdGNoX2NyZWF0ZShpbnQgaTkxNSkKK3sKKwlyZXR1cm4gX19i
YXRjaF9jcmVhdGUoaTkxNSwgMCk7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3Rfdm0oaW50IGk5MTUp
Cit7CisJY29uc3QgdWludDY0X3Qgbm9uemVyb19vZmZzZXQgPSA0OCA8PCAyMDsKKwlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiBiYXRjaCA9IHsKKwkJLmhhbmRsZSA9IGJhdGNoX2Ny
ZWF0ZShpOTE1KSwKKwl9OworCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgZWIgPSB7
CisJCS5idWZmZXJzX3B0ciA9IHRvX3VzZXJfcG9pbnRlcigmYmF0Y2gpLAorCQkuYnVmZmVyX2Nv
dW50ID0gMSwKKwl9OworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSBhcmcgPSB7
CisJCS5wYXJhbSA9IEk5MTVfQ09OVEVYVF9QQVJBTV9WTSwKKwl9OworCXVpbnQzMl90IHBhcmVu
dCwgY2hpbGQ7CisKKwkvKgorCSAqIFByb3ZpbmcgMiBjb250ZXh0cyBzaGFyZSB0aGUgc2FtZSBH
VFQgaXMgcXVpdGUgdHJpY2t5IGFzIHdlIGhhdmUgbm8KKwkgKiBtZWFucyBvZiBkaXJlY3RseSBj
b21wYXJpbmcgdGhlbSAoZWFjaCBoYW5kbGUgcmV0dXJuZWQgdG8gdXNlcnNwYWNlCisJICogaXMg
dW5pcXVlKS4gV2hhdCB3ZSBkbyBpbnN0ZWFkIGlzIHJlbHkgb24gYSBxdWlyayBvZiBleGVjYnVm
IHRoYXQKKwkgKiBpdCBkb2VzIG5vdCB0cnkgdG8gbW92ZSBhbiBWTUEgd2l0aG91dCBnb29kIHJl
YXNvbiwgYW5kIHNvIHRoYXQKKwkgKiBoYXZpbmcgdXNlZCBhbiBvYmplY3QgaW4gb25lIGNvbnRl
eHQsIGl0IHdpbGwgaGF2ZSB0aGUgc2FtZSBhZGRyZXNzCisJICogaW4gdGhlIG5leHQgY29udGV4
dCB0aGF0IHNoYXJlZCB0aGUgVk0uCisJICovCisKKwlhcmcudmFsdWUgPSAtMXVsbDsKKwlpZ3Rf
cmVxdWlyZShfX2dlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmYXJnKSA9PSAtRU5PRU5UKTsK
KworCXBhcmVudCA9IGdlbV9jb250ZXh0X2NyZWF0ZShpOTE1KTsKKwljaGlsZCA9IGdlbV9jb250
ZXh0X2NyZWF0ZShpOTE1KTsKKworCS8qIFVzaW5nIGltcGxpY2l0IHNvZnQtcGlubmluZyAqLwor
CWViLnJzdmQxID0gcGFyZW50OworCWJhdGNoLm9mZnNldCA9IG5vbnplcm9fb2Zmc2V0OworCWdl
bV9leGVjYnVmKGk5MTUsICZlYik7CisJaWd0X2Fzc2VydF9lcV91NjQoYmF0Y2gub2Zmc2V0LCBu
b256ZXJvX29mZnNldCk7CisKKwllYi5yc3ZkMSA9IGNoaWxkOworCWJhdGNoLm9mZnNldCA9IDA7
CisJZ2VtX2V4ZWNidWYoaTkxNSwgJmViKTsKKwlpZ3RfYXNzZXJ0X2VxX3U2NChiYXRjaC5vZmZz
ZXQsIDApOworCisJZWIucnN2ZDEgPSBwYXJlbnQ7CisJZ2VtX2V4ZWNidWYoaTkxNSwgJmViKTsK
KwlpZ3RfYXNzZXJ0X2VxX3U2NChiYXRjaC5vZmZzZXQsIG5vbnplcm9fb2Zmc2V0KTsKKworCWFy
Zy5jdHhfaWQgPSBwYXJlbnQ7CisJZ2VtX2NvbnRleHRfZ2V0X3BhcmFtKGk5MTUsICZhcmcpOwor
CWdlbV9jb250ZXh0X3NldF9wYXJhbShpOTE1LCAmYXJnKTsKKworCS8qIFN0aWxsIHRoZSBzYW1l
IFZNLCBzbyBleHBlY3QgdGhlIG9sZCBWTUEgYWdhaW4gKi8KKwliYXRjaC5vZmZzZXQgPSAwOwor
CWdlbV9leGVjYnVmKGk5MTUsICZlYik7CisJaWd0X2Fzc2VydF9lcV91NjQoYmF0Y2gub2Zmc2V0
LCBub256ZXJvX29mZnNldCk7CisKKwlhcmcuY3R4X2lkID0gY2hpbGQ7CisJZ2VtX2NvbnRleHRf
c2V0X3BhcmFtKGk5MTUsICZhcmcpOworCisJZWIucnN2ZDEgPSBjaGlsZDsKKwliYXRjaC5vZmZz
ZXQgPSAwOworCWdlbV9leGVjYnVmKGk5MTUsICZlYik7CisJaWd0X2Fzc2VydF9lcV91NjQoYmF0
Y2gub2Zmc2V0LCBub256ZXJvX29mZnNldCk7CisKKwlnZW1fY29udGV4dF9kZXN0cm95KGk5MTUs
IGNoaWxkKTsKKwlnZW1fY29udGV4dF9kZXN0cm95KGk5MTUsIHBhcmVudCk7CisKKwkvKiBib3Ro
IGNvbnRleHRzIGRlc3Ryb3llZCwgYnV0IHdlIHN0aWxsIGtlZXAgaG9sZCBvZiB0aGUgdm0gKi8K
KwljaGlsZCA9IGdlbV9jb250ZXh0X2NyZWF0ZShpOTE1KTsKKworCWFyZy5jdHhfaWQgPSBjaGls
ZDsKKwlnZW1fY29udGV4dF9zZXRfcGFyYW0oaTkxNSwgJmFyZyk7CisKKwllYi5yc3ZkMSA9IGNo
aWxkOworCWJhdGNoLm9mZnNldCA9IDA7CisJZ2VtX2V4ZWNidWYoaTkxNSwgJmViKTsKKwlpZ3Rf
YXNzZXJ0X2VxX3U2NChiYXRjaC5vZmZzZXQsIG5vbnplcm9fb2Zmc2V0KTsKKworCWdlbV9jb250
ZXh0X2Rlc3Ryb3koaTkxNSwgY2hpbGQpOworCWdlbV92bV9kZXN0cm95KGk5MTUsIGFyZy52YWx1
ZSk7CisKKwlnZW1fc3luYyhpOTE1LCBiYXRjaC5oYW5kbGUpOworCWdlbV9jbG9zZShpOTE1LCBi
YXRjaC5oYW5kbGUpOworfQorCiBpZ3RfbWFpbgogewogCXN0cnVjdCBkcm1faTkxNV9nZW1fY29u
dGV4dF9wYXJhbSBhcmc7CkBAIC0yNTMsNiArMzQyLDkgQEAgaWd0X21haW4KIAkJZ2VtX2NvbnRl
eHRfc2V0X3BhcmFtKGZkLCAmYXJnKTsKIAl9CiAKKwlpZ3Rfc3VidGVzdCgidm0iKQorCQl0ZXN0
X3ZtKGZkKTsKKwogCWFyZy5wYXJhbSA9IEk5MTVfQ09OVEVYVF9QQVJBTV9QUklPUklUWTsKIAog
CWlndF9zdWJ0ZXN0KCJzZXQtcHJpb3JpdHktbm90LXN1cHBvcnRlZCIpIHsKLS0gCjIuMjAuMQoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4
IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

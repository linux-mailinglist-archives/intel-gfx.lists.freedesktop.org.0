Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B91527EF84
	for <lists+intel-gfx@lfdr.de>; Fri,  2 Aug 2019 10:41:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 12ABB6ED50;
	Fri,  2 Aug 2019 08:41:33 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4AD0C6ED50
 for <intel-gfx@lists.freedesktop.org>; Fri,  2 Aug 2019 08:41:31 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by fmsmga101.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 02 Aug 2019 01:41:30 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,337,1559545200"; d="scan'208";a="184518856"
Received: from gadevlin-mobl.ger.corp.intel.com (HELO [10.251.95.57])
 ([10.251.95.57])
 by orsmga002.jf.intel.com with ESMTP; 02 Aug 2019 01:41:28 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190801182657.5311-1-chris@chris-wilson.co.uk>
 <20190801182657.5311-2-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <7d15a1bb-8aed-a9f7-6451-946225037c74@linux.intel.com>
Date: Fri, 2 Aug 2019 09:41:26 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20190801182657.5311-2-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 2/2] drm/i915/pmu: Use GT parked for
 estimating RC6 while asleep
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDAxLzA4LzIwMTkgMTk6MjYsIENocmlzIFdpbHNvbiB3cm90ZToKPiBBcyB3ZSB0cmFjayB3
aGVuIHdlIHB1dCB0aGUgR1QgZGV2aWNlIHRvIHNsZWVwIHVwb24gaWRsaW5nLCB3ZSBjYW4gdXNl
Cj4gdGhhdCBjYWxsYmFjayB0byBzYW1wbGUgdGhlIGN1cnJlbnQgcmM2IGNvdW50ZXJzIGFuZCBy
ZWNvcmQgdGhlCj4gdGltZXN0YW1wIGZvciBlc3RpbWF0aW5nIHNhbXBsZXMgYWZ0ZXIgdGhhdCBw
b2ludCB3aGlsZSBhc2xlZXAuCj4gCj4gU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJp
c0BjaHJpcy13aWxzb24uY28udWs+Cj4gQ2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxp
bkBpbnRlbC5jb20+Cj4gLS0tCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMu
YyB8ICAyMSArKy0tLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYyAgICAgfCAx
MjIgKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9wbXUuaCAgICAgfCAgIDQgKy0KPiAgIDMgZmlsZXMgY2hhbmdlZCwgNzEgaW5zZXJ0aW9u
cygrKSwgNzYgZGVsZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMK
PiBpbmRleCAyNDc4N2JiNDhjOWYuLmE5NmU2MzBkM2Y4NiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZGVidWdmcy5jCj4gQEAgLTM5LDYgKzM5LDcgQEAKPiAgICNpbmNsdWRlICJkaXNwbGF5
L2ludGVsX3Bzci5oIgo+ICAgCj4gICAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCIK
PiArI2luY2x1ZGUgImd0L2ludGVsX2d0X3BtLmgiCj4gICAjaW5jbHVkZSAiZ3QvaW50ZWxfcmVz
ZXQuaCIKPiAgICNpbmNsdWRlICJndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5oIgo+ICAgCj4g
QEAgLTQwNTcsMTMgKzQwNTgsMTEgQEAgc3RhdGljIGludCBpOTE1X3NzZXVfc3RhdHVzKHN0cnVj
dCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQo+ICAgc3RhdGljIGludCBpOTE1X2ZvcmNld2Fr
ZV9vcGVuKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQo+ICAgewo+ICAg
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gaW5vZGUtPmlfcHJpdmF0ZTsKPiArCXN0
cnVjdCBpbnRlbF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7Cj4gICAKPiAtCWlmIChJTlRFTF9HRU4oaTkx
NSkgPCA2KQo+IC0JCXJldHVybiAwOwo+IC0KPiAtCWZpbGUtPnByaXZhdGVfZGF0YSA9Cj4gLQkJ
KHZvaWQgKikodWludHB0cl90KWludGVsX3J1bnRpbWVfcG1fZ2V0KCZpOTE1LT5ydW50aW1lX3Bt
KTsKPiAtCWludGVsX3VuY29yZV9mb3JjZXdha2VfdXNlcl9nZXQoJmk5MTUtPnVuY29yZSk7Cj4g
KwlpbnRlbF9ndF9wbV9nZXQoZ3QpOwo+ICsJaWYgKElOVEVMX0dFTihpOTE1KSA+PSA2KQo+ICsJ
CWludGVsX3VuY29yZV9mb3JjZXdha2VfdXNlcl9nZXQoZ3QtPnVuY29yZSk7Cj4gICAKPiAgIAly
ZXR1cm4gMDsKPiAgIH0KPiBAQCAtNDA3MSwxMyArNDA3MCwxMSBAQCBzdGF0aWMgaW50IGk5MTVf
Zm9yY2V3YWtlX29wZW4oc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCj4g
ICBzdGF0aWMgaW50IGk5MTVfZm9yY2V3YWtlX3JlbGVhc2Uoc3RydWN0IGlub2RlICppbm9kZSwg
c3RydWN0IGZpbGUgKmZpbGUpCj4gICB7Cj4gICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUgPSBpbm9kZS0+aV9wcml2YXRlOwo+ICsJc3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1LT5n
dDsKPiAgIAo+IC0JaWYgKElOVEVMX0dFTihpOTE1KSA8IDYpCj4gLQkJcmV0dXJuIDA7Cj4gLQo+
IC0JaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV91c2VyX3B1dCgmaTkxNS0+dW5jb3JlKTsKPiAtCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLAo+IC0JCQkgICAgIChpbnRlbF93
YWtlcmVmX3QpKHVpbnRwdHJfdClmaWxlLT5wcml2YXRlX2RhdGEpOwo+ICsJaWYgKElOVEVMX0dF
TihpOTE1KSA+PSA2KQo+ICsJCWludGVsX3VuY29yZV9mb3JjZXdha2VfdXNlcl9wdXQoJmk5MTUt
PnVuY29yZSk7Cj4gKwlpbnRlbF9ndF9wbV9wdXQoZ3QpOwo+ICAgCj4gICAJcmV0dXJuIDA7Cj4g
ICB9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5jCj4gaW5kZXggNGQ3Y2FiZWVhNjg3Li42ODA2MThi
ZDM4NWMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuYwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmMKPiBAQCAtMTE0LDE3ICsxMTQsNTAg
QEAgc3RhdGljIGJvb2wgcG11X25lZWRzX3RpbWVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBib29sIGdwdV9hY3RpdmUpCj4gICAJcmV0dXJuIGVuYWJsZTsKPiAgIH0KPiAgIAo+ICtz
dGF0aWMgdTY0IF9fZ2V0X3JjNihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQo+ICt7Cj4gKwlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGd0LT5pOTE1Owo+ICsJdTY0IHZhbDsKPiArCj4gKwl2
YWwgPSBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKGk5MTUsCj4gKwkJCQkgICAgIElTX1ZBTExFWVZJ
RVcoaTkxNSkgPwo+ICsJCQkJICAgICBWTFZfR1RfUkVOREVSX1JDNiA6Cj4gKwkJCQkgICAgIEdF
TjZfR1RfR0ZYX1JDNik7Cj4gKwo+ICsJaWYgKEhBU19SQzZwKGk5MTUpKQo+ICsJCXZhbCArPSBp
bnRlbF9yYzZfcmVzaWRlbmN5X25zKGk5MTUsIEdFTjZfR1RfR0ZYX1JDNnApOwo+ICsKPiArCWlm
IChIQVNfUkM2cHAoaTkxNSkpCj4gKwkJdmFsICs9IGludGVsX3JjNl9yZXNpZGVuY3lfbnMoaTkx
NSwgR0VONl9HVF9HRlhfUkM2cHApOwo+ICsKPiArCXJldHVybiB2YWw7Cj4gK30KPiArCj4gICB2
b2lkIGk5MTVfcG11X2d0X3BhcmtlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAg
IHsKPiArCXU2NCB2YWw7Cj4gKwo+ICAgCWlmICghaTkxNS0+cG11LmJhc2UuZXZlbnRfaW5pdCkK
PiAgIAkJcmV0dXJuOwo+ICAgCj4gKwl2YWwgPSAwOwo+ICsJaWYgKGk5MTUtPnBtdS5zYW1wbGVb
X19JOTE1X1NBTVBMRV9SQzZdLmN1cikKPiArCQl2YWwgPSBfX2dldF9yYzYoJmk5MTUtPmd0KTsK
ClRoZSBjb25kaXRpb25hbCBjb3VsZCBiZSByYWN5IG91dHNpZGUgdGhlIGxvY2suIElmIGEgcGFy
YWxsZWwgcGVyZiAKcmVhZGVyIHVwZGF0ZXMgLmN1ciBmcm9tIHplcm8gdG8gbm9uLXplcm8gdGhl
IGhvdXNlIGtlZXAgYmVsb3cgd291bGQgc2VlIAp2YWwgYXMgemVyby4gUGVyaGFwcyB5b3UgY2Fu
IHN0b3JlIHZhbCA9IF9fZ2V0X3JjNiBvdXRzaWRlIHRoZSBsb2NrLCBhbmQgCnRoZW4gZGVjaWRl
IHdoaWNoIHZhbCB0byB1c2UgaW5zaWRlIHRoZSBsb2NrPwoKPiArCj4gICAJc3Bpbl9sb2NrX2ly
cSgmaTkxNS0+cG11LmxvY2spOwo+ICsKPiArCWlmICh2YWwgPj0gaTkxNS0+cG11LnNhbXBsZVtf
X0k5MTVfU0FNUExFX1JDNl9FU1RJTUFURURdLmN1cikgewo+ICsJCWk5MTUtPnBtdS5zYW1wbGVb
X19JOTE1X1NBTVBMRV9SQzZfRVNUSU1BVEVEXS5jdXIgPSAwOwo+ICsJCWk5MTUtPnBtdS5zYW1w
bGVbX19JOTE1X1NBTVBMRV9SQzZdLmN1ciA9IHZhbDsKPiArCX0KPiArCWk5MTUtPnBtdS5zbGVl
cF90aW1lc3RhbXAgPSBqaWZmaWVzOwoKa3RpbWUgd291bGQgYmUgYmV0dGVyIEkgdGhpbmsuIE1v
cmUgcHJlY2lzaW9uIGJ1dCBqdXN0IHdoeSB1c2UgYXJjaGFpYyAKamlmZmllcy4KCj4gKwo+ICAg
CS8qCj4gICAJICogU2lnbmFsIHNhbXBsaW5nIHRpbWVyIHRvIHN0b3AgaWYgb25seSBlbmdpbmUg
ZXZlbnRzIGFyZSBlbmFibGVkIGFuZAo+ICAgCSAqIEdQVSB3ZW50IGlkbGUuCj4gICAJICovCj4g
ICAJaTkxNS0+cG11LnRpbWVyX2VuYWJsZWQgPSBwbXVfbmVlZHNfdGltZXIoaTkxNSwgZmFsc2Up
Owo+ICsKPiAgIAlzcGluX3VubG9ja19pcnEoJmk5MTUtPnBtdS5sb2NrKTsKPiAgIH0KPiAgIAo+
IEBAIC0xNDUsMTAgKzE3OCwyMyBAQCB2b2lkIGk5MTVfcG11X2d0X3VucGFya2VkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgCQlyZXR1cm47Cj4gICAKPiAgIAlzcGluX2xvY2tf
aXJxKCZpOTE1LT5wbXUubG9jayk7Cj4gKwo+ICAgCS8qCj4gICAJICogUmUtZW5hYmxlIHNhbXBs
aW5nIHRpbWVyIHdoZW4gR1BVIGdvZXMgYWN0aXZlLgo+ICAgCSAqLwo+ICAgCV9faTkxNV9wbXVf
bWF5YmVfc3RhcnRfdGltZXIoaTkxNSk7Cj4gKwo+ICsJLyogRXN0aW1hdGUgaG93IGxvbmcgd2Ug
c2xlcHQgYW5kIGFjY3VtdWxhdGUgdGhhdCBpbnRvIHJjNiBjb3VudGVycyAqLwo+ICsJaWYgKGk5
MTUtPnBtdS5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZdLmN1cikgewo+ICsJCXU2NCB2YWw7Cj4g
Kwo+ICsJCXZhbCA9IGppZmZpZXMgLSBpOTE1LT5wbXUuc2xlZXBfdGltZXN0YW1wOwo+ICsJCXZh
bCA9IGppZmZpZXNfdG9fbnNlY3ModmFsKTsKPiArCQl2YWwgKz0gaTkxNS0+cG11LnNhbXBsZVtf
X0k5MTVfU0FNUExFX1JDNl0uY3VyOwo+ICsKPiArCQlpOTE1LT5wbXUuc2FtcGxlW19fSTkxNV9T
QU1QTEVfUkM2X0VTVElNQVRFRF0uY3VyID0gdmFsOwo+ICsJfQo+ICsKPiAgIAlzcGluX3VubG9j
a19pcnEoJmk5MTUtPnBtdS5sb2NrKTsKPiAgIH0KPiAgIAo+IEBAIC00MTcsMzYgKzQ2MywxNyBA
QCBzdGF0aWMgaW50IGk5MTVfcG11X2V2ZW50X2luaXQoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50
KQo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB1NjQgX19nZXRfcmM2KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICtzdGF0aWMgdTY0IGdldF9yYzYoc3RydWN0IGlu
dGVsX2d0ICpndCkKPiAgIHsKPiAtCXU2NCB2YWw7Cj4gLQo+IC0JdmFsID0gaW50ZWxfcmM2X3Jl
c2lkZW5jeV9ucyhpOTE1LAo+IC0JCQkJICAgICBJU19WQUxMRVlWSUVXKGk5MTUpID8KPiAtCQkJ
CSAgICAgVkxWX0dUX1JFTkRFUl9SQzYgOgo+IC0JCQkJICAgICBHRU42X0dUX0dGWF9SQzYpOwo+
IC0KPiAtCWlmIChIQVNfUkM2cChpOTE1KSkKPiAtCQl2YWwgKz0gaW50ZWxfcmM2X3Jlc2lkZW5j
eV9ucyhpOTE1LCBHRU42X0dUX0dGWF9SQzZwKTsKPiAtCj4gLQlpZiAoSEFTX1JDNnBwKGk5MTUp
KQo+IC0JCXZhbCArPSBpbnRlbF9yYzZfcmVzaWRlbmN5X25zKGk5MTUsIEdFTjZfR1RfR0ZYX1JD
NnBwKTsKPiAtCj4gLQlyZXR1cm4gdmFsOwo+IC19Cj4gLQo+IC1zdGF0aWMgdTY0IGdldF9yYzYo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCj4gLXsKPiAtI2lmIElTX0VOQUJMRUQoQ09O
RklHX1BNKQoKV2Ugc3RpbGwgZW5kIHVwIHdpdGggbmV2ZXIgZ2V0dGluZyBpbnRvIGVzdGltYXRp
b24gbW9kZSwgZXZlbiB3aGVuIApwYXJrZWQsIHJpZ2h0PyBIbS4uIHdoeSBJIGFkZGVkIHRoaXMu
LiBuZXZlciBtaW5kLgoKPiAtCXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0gPSAmaTkxNS0+
cnVudGltZV9wbTsKPiAtCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICsJc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+aTkxNTsKPiAgIAl1bnNpZ25lZCBsb25nIGZsYWdzOwo+
ICAgCXU2NCB2YWw7Cj4gICAKPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9p
bl91c2UocnBtKTsKPiAtCWlmICh3YWtlcmVmKSB7Cj4gLQkJdmFsID0gX19nZXRfcmM2KGk5MTUp
Owo+IC0JCWludGVsX3J1bnRpbWVfcG1fcHV0KHJwbSwgd2FrZXJlZik7Cj4gKwlzcGluX2xvY2tf
aXJxc2F2ZSgmaTkxNS0+cG11LmxvY2ssIGZsYWdzKTsKPiArCj4gKwlpZiAoaW50ZWxfZ3RfcG1f
Z2V0X2lmX2F3YWtlKGd0KSkgewo+ICsJCXZhbCA9IF9fZ2V0X3JjNihndCk7CgpJIHRob3VnaHQg
ZWFybGllciBpbiB0aGUgcGF0Y2ggeW91IHdlcmUgYXZvaWRpbmcgdG8gY2FsbCBfX2dldF9yYzYg
dW5kZXIgCnRoZSBpcnEgb2ZmIGxvY2suIEl0IGxvb2tzIHRvIGJlIHNhZmUsIHVubGVzcyBJIGFt
IG1pc3NpbmcgeWV0IGFub3RoZXIgCm5hc3R5IGNwdSBob3RwbHVnIGxvY2sgaW50ZXJhY3Rpb24s
IGJ1dCBpdCB3b3VsZCBiZSBnb29kIHRvIGJlIGNvbnNpc3RlbnQuCgo+ICsJCWludGVsX2d0X3Bt
X3B1dChndCk7Cj4gICAKPiAgIAkJLyoKPiAgIAkJICogSWYgd2UgYXJlIGNvbWluZyBiYWNrIGZy
b20gYmVpbmcgcnVudGltZSBzdXNwZW5kZWQgd2UgbXVzdAo+IEBAIC00NTQsNyArNDgxLDYgQEAg
c3RhdGljIHU2NCBnZXRfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgCQkg
KiBwcmV2aW91c2x5Lgo+ICAgCQkgKi8KPiAgIAo+IC0JCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1
LT5wbXUubG9jaywgZmxhZ3MpOwo+ICAgCj4gICAJCWlmICh2YWwgPj0gaTkxNS0+cG11LnNhbXBs
ZVtfX0k5MTVfU0FNUExFX1JDNl9FU1RJTUFURURdLmN1cikgewo+ICAgCQkJaTkxNS0+cG11LnNh
bXBsZVtfX0k5MTVfU0FNUExFX1JDNl9FU1RJTUFURURdLmN1ciA9IDA7Cj4gQEAgLTQ2MiwxMSAr
NDg4LDcgQEAgc3RhdGljIHU2NCBnZXRfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQo+ICAgCQl9IGVsc2Ugewo+ICAgCQkJdmFsID0gaTkxNS0+cG11LnNhbXBsZVtfX0k5MTVfU0FN
UExFX1JDNl9FU1RJTUFURURdLmN1cjsKPiAgIAkJfQo+IC0KPiAtCQlzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZpOTE1LT5wbXUubG9jaywgZmxhZ3MpOwo+ICAgCX0gZWxzZSB7Cj4gLQkJc3RydWN0
IGRldmljZSAqa2RldiA9IHJwbS0+a2RldjsKPiAtCj4gICAJCS8qCj4gICAJCSAqIFdlIGFyZSBy
dW50aW1lIHN1c3BlbmRlZC4KPiAgIAkJICoKPiBAQCAtNDc0LDQyICs0OTYsMTggQEAgc3RhdGlj
IHU2NCBnZXRfcmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgCQkgKiBvbiB0
b3Agb2YgdGhlIGxhc3Qga25vd24gcmVhbCB2YWx1ZSwgYXMgdGhlIGFwcHJveGltYXRlZCBSQzYK
PiAgIAkJICogY291bnRlciB2YWx1ZS4KPiAgIAkJICovCj4gLQkJc3Bpbl9sb2NrX2lycXNhdmUo
Jmk5MTUtPnBtdS5sb2NrLCBmbGFncyk7Cj4gICAKPiAtCQkvKgo+IC0JCSAqIEFmdGVyIHRoZSBh
Ym92ZSBicmFuY2ggaW50ZWxfcnVudGltZV9wbV9nZXRfaWZfaW5fdXNlIGZhaWxlZAo+IC0JCSAq
IHRvIGdldCB0aGUgcnVudGltZSBQTSByZWZlcmVuY2Ugd2UgY2Fubm90IGFzc3VtZSB3ZSBhcmUg
aW4KPiAtCQkgKiBydW50aW1lIHN1c3BlbmQgc2luY2Ugd2UgY2FuIGVpdGhlcjogYSkgcmFjZSB3
aXRoIGNvbWluZyBvdXQKPiAtCQkgKiBvZiBpdCBiZWZvcmUgd2UgdG9vayB0aGUgcG93ZXIubG9j
aywgb3IgYikgdGhlcmUgYXJlIG90aGVyCj4gLQkJICogc3RhdGVzIHRoYW4gc3VzcGVuZGVkIHdo
aWNoIGNhbiBicmluZyB1cyBoZXJlLgo+IC0JCSAqCj4gLQkJICogV2UgbmVlZCB0byBkb3VibGUt
Y2hlY2sgdGhhdCB3ZSBhcmUgaW5kZWVkIGN1cnJlbnRseSBydW50aW1lCj4gLQkJICogc3VzcGVu
ZGVkIGFuZCBpZiBub3Qgd2UgY2Fubm90IGRvIGJldHRlciB0aGFuIHJlcG9ydCB0aGUgbGFzdAo+
IC0JCSAqIGtub3duIFJDNiB2YWx1ZS4KPiAtCQkgKi8KCllvdSB0aGluayB0aGlzIHJhY2UgaXMg
bm90IGEgY29uY2VybiBhbnkgbW9yZT8gVGhlIGlzc3VlIG9mIGluY29uc2lzdGVudCAKc3RhdGUg
aW4gY29yZSBpc24ndCBhbnkgbW9yZSBzaW5jZSAyOTI0YmRlZTIxZWRkLCBhbHRob3VnaCBJIGFt
IG5vdCBzdXJlIAppZiAzYjRlZDJlMmViNTU4IGJyb2tlIGl0LiBQcmVzdW1hYmx5IG5vdCBzaW5j
ZSBJIHJldmlld2VkIGl0IGJhY2sgdGhlbi4gCkJ1dCBpZiB3ZSBnb3Qgd29rZW4gdXAgYnkgbm93
IHJlYWRlciB3aWxsIHNlZSB0b28gbXVjaCByYzYgc2xlZXAuIEkgCmd1ZXNzIGl0J3Mgbm9pc2Ug
bGV2ZWwuIENhbid0IGltYWdpbmUgZXZlbiBJR1Qgd291bGQgYmUgc28gc2Vuc2l0aXZlIHRvIApn
ZXQgYWZmZWN0ZWQgYnkgaXQuCgo+IC0JCWlmIChwbV9ydW50aW1lX3N0YXR1c19zdXNwZW5kZWQo
a2RldikpIHsKPiAtCQkJdmFsID0gcG1fcnVudGltZV9zdXNwZW5kZWRfdGltZShrZGV2KTsKPiAr
CQl2YWwgPSBqaWZmaWVzIC0gaTkxNS0+cG11LnNsZWVwX3RpbWVzdGFtcDsKPiArCQl2YWwgPSBq
aWZmaWVzX3RvX25zZWNzKHZhbCk7Cj4gKwkJdmFsICs9IGk5MTUtPnBtdS5zYW1wbGVbX19JOTE1
X1NBTVBMRV9SQzZdLmN1cjsKPiAgIAo+IC0JCQlpZiAoIWk5MTUtPnBtdS5zYW1wbGVbX19JOTE1
X1NBTVBMRV9SQzZfRVNUSU1BVEVEXS5jdXIpCj4gLQkJCQlpOTE1LT5wbXUuc3VzcGVuZGVkX3Rp
bWVfbGFzdCA9IHZhbDsKPiArCQlpOTE1LT5wbXUuc2FtcGxlW19fSTkxNV9TQU1QTEVfUkM2X0VT
VElNQVRFRF0uY3VyID0gdmFsOwo+ICAgCj4gLQkJCXZhbCAtPSBpOTE1LT5wbXUuc3VzcGVuZGVk
X3RpbWVfbGFzdDsKPiAtCQkJdmFsICs9IGk5MTUtPnBtdS5zYW1wbGVbX19JOTE1X1NBTVBMRV9S
QzZdLmN1cjsKPiAtCj4gLQkJCWk5MTUtPnBtdS5zYW1wbGVbX19JOTE1X1NBTVBMRV9SQzZfRVNU
SU1BVEVEXS5jdXIgPSB2YWw7Cj4gLQkJfSBlbHNlIGlmIChpOTE1LT5wbXUuc2FtcGxlW19fSTkx
NV9TQU1QTEVfUkM2X0VTVElNQVRFRF0uY3VyKSB7Cj4gLQkJCXZhbCA9IGk5MTUtPnBtdS5zYW1w
bGVbX19JOTE1X1NBTVBMRV9SQzZfRVNUSU1BVEVEXS5jdXI7Cj4gLQkJfSBlbHNlIHsKPiAtCQkJ
dmFsID0gaTkxNS0+cG11LnNhbXBsZVtfX0k5MTVfU0FNUExFX1JDNl0uY3VyOwo+IC0JCX0KPiAt
Cj4gLQkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+cG11LmxvY2ssIGZsYWdzKTsKPiAg
IAl9Cj4gICAKPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPnBtdS5sb2NrLCBmbGFn
cyk7Cj4gKwo+ICAgCXJldHVybiB2YWw7Cj4gLSNlbHNlCj4gLQlyZXR1cm4gX19nZXRfcmM2KGk5
MTUpOwo+IC0jZW5kaWYKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHU2NCBfX2k5MTVfcG11X2V2ZW50
X3JlYWQoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KQo+IEBAIC01NTAsNyArNTQ4LDcgQEAgc3Rh
dGljIHU2NCBfX2k5MTVfcG11X2V2ZW50X3JlYWQoc3RydWN0IHBlcmZfZXZlbnQgKmV2ZW50KQo+
ICAgCQkJdmFsID0gY291bnRfaW50ZXJydXB0cyhpOTE1KTsKPiAgIAkJCWJyZWFrOwo+ICAgCQlj
YXNlIEk5MTVfUE1VX1JDNl9SRVNJREVOQ1k6Cj4gLQkJCXZhbCA9IGdldF9yYzYoaTkxNSk7Cj4g
KwkJCXZhbCA9IGdldF9yYzYoJmk5MTUtPmd0KTsKPiAgIAkJCWJyZWFrOwo+ICAgCQl9Cj4gICAJ
fQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuaAo+IGluZGV4IDRmYzRmMjQ3ODMwMS4uNmZhMDI0MGEx
NzA0IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11LmgKPiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5oCj4gQEAgLTk3LDkgKzk3LDkgQEAgc3Ry
dWN0IGk5MTVfcG11IHsKPiAgIAkgKi8KPiAgIAlzdHJ1Y3QgaTkxNV9wbXVfc2FtcGxlIHNhbXBs
ZVtfX0k5MTVfTlVNX1BNVV9TQU1QTEVSU107Cj4gICAJLyoqCj4gLQkgKiBAc3VzcGVuZGVkX3Rp
bWVfbGFzdDogQ2FjaGVkIHN1c3BlbmQgdGltZSBmcm9tIFBNIGNvcmUuCj4gKwkgKiBAc2xlZXBf
dGltZXN0YW1wOiBMYXN0IHRpbWUgR1QgcGFya2VkIGZvciBSQzYgZXN0aW1hdGlvbi4KPiAgIAkg
Ki8KPiAtCXU2NCBzdXNwZW5kZWRfdGltZV9sYXN0Owo+ICsJdW5zaWduZWQgbG9uZyBzbGVlcF90
aW1lc3RhbXA7Cj4gICAJLyoqCj4gICAJICogQGk5MTVfYXR0cjogTWVtb3J5IGJsb2NrIGhvbGRp
bmcgZGV2aWNlIGF0dHJpYnV0ZXMuCj4gICAJICovCj4gCgpZZWFoIEkgbGlrZSBpdC4gTXVjaCBi
ZXR0ZXIgdGhhdCB3ZSBzdGF5IHdpdGhpbiBjb25maW5lcyBvZiBvdXIgb3duIApjb2RlLiBJIHdv
bmRlciB3aGF0IGl0IHdpbGwgbWVhbiBpZiB0aGlzIGZpeGVzIHRoZSBvY2Nhc2lvbmFsIElHVCBm
YWlscy4gClRoYXQgc29tZXRoaW5nIGluIGNvcmUgcnBtIHN1YnN5c3RlbSBhY2NvdW50aW5nIHdh
cyBnb2luZyB3cm9uZz8KClJlZ2FyZHMsCgpUdnJ0a28KX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vaW50ZWwtZ2Z4

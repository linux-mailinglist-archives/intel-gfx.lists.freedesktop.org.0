Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id AAA35BF2D0
	for <lists+intel-gfx@lfdr.de>; Thu, 26 Sep 2019 14:21:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C925B6E0BC;
	Thu, 26 Sep 2019 12:21:13 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9E9F76E0BC
 for <intel-gfx@lists.freedesktop.org>; Thu, 26 Sep 2019 12:21:12 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 26 Sep 2019 05:21:11 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,551,1559545200"; d="scan'208";a="390694796"
Received: from irsmsx102.ger.corp.intel.com ([163.33.3.155])
 by fmsmga006.fm.intel.com with ESMTP; 26 Sep 2019 05:21:10 -0700
Received: from localhost (172.28.172.64) by IRSMSX102.ger.corp.intel.com
 (163.33.3.155) with Microsoft SMTP Server (TLS) id 14.3.439.0; Thu, 26 Sep
 2019 13:21:10 +0100
From: =?UTF-8?q?Micha=C5=82=20Winiarski?= <michal.winiarski@intel.com>
To: <intel-gfx@lists.freedesktop.org>
Date: Thu, 26 Sep 2019 14:20:19 +0200
Message-ID: <20190926122019.29325-1-michal.winiarski@intel.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190926100635.9416-6-michal.winiarski@intel.com>
References: <20190926100635.9416-6-michal.winiarski@intel.com>
MIME-Version: 1.0
X-Originating-IP: [172.28.172.64]
Subject: [Intel-gfx] [PATCH v2 6/6] drm/i915/execlists: Don't allocate
 scratch
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2UncmUgbm8gbG9uZ2VyIHVzaW5nIGl0IG9uIGV4ZWNsaXN0cyBwbGF0Zm9ybXMuIFRoZXJlJ3Mg
bm8gcG9pbnQgaW4KYWxsb2NhdGluZyBpdC4KCnYyOiBNb3ZlIHNjcmF0Y2ggaW5pdCB0byBsZWdh
Y3kgcmluZyBzdWJtaXNzaW9uIGJhY2tlbmQuIChDaHJpcykKClNpZ25lZC1vZmYtYnk6IE1pY2hh
xYIgV2luaWFyc2tpIDxtaWNoYWwud2luaWFyc2tpQGludGVsLmNvbT4KQ2M6IENocmlzIFdpbHNv
biA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9jcy5jICB8ICAyIC0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ndC5jICAgICAgICAgfCAxNyArKysrKy0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZ3QuaCAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3JpbmdidWZmZXIuYyB8ICA1ICsrKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dlbS5jICAgICAgICAgICAgfCAgMiAtLQogNSBmaWxlcyBjaGFuZ2VkLCAxMSBpbnNlcnRpb25z
KCspLCAxNyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9lbmdpbmVfY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2lu
ZV9jcy5jCmluZGV4IGY0NTFkNTA3NmJkZS4uYTRlNWFjZWZmNjc4IDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwpAQCAtNjY5LDggKzY2OSw2IEBAIHN0YXRpYyBp
bnQgbWVhc3VyZV9icmVhZGNydW1iX2R3KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
IAlzdHJ1Y3QgbWVhc3VyZV9icmVhZGNydW1iICpmcmFtZTsKIAlpbnQgZHcgPSAtRU5PTUVNOwog
Ci0JR0VNX0JVR19PTighZW5naW5lLT5ndC0+c2NyYXRjaCk7Ci0KIAlmcmFtZSA9IGt6YWxsb2Mo
c2l6ZW9mKCpmcmFtZSksIEdGUF9LRVJORUwpOwogCWlmICghZnJhbWUpCiAJCXJldHVybiAtRU5P
TUVNOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMKaW5kZXggZWVmOWJkYWU4ZWJiLi5lNjdh
NmNhYmM4MWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYwpAQCAtMzIyLDEzICszMjIs
MTcgQEAgdm9pZCBpbnRlbF9ndF9kcml2ZXJfcmVnaXN0ZXIoc3RydWN0IGludGVsX2d0ICpndCkK
IAkJaW50ZWxfZ3B1X2lwc19pbml0KGd0LT5pOTE1KTsKIH0KIAotc3RhdGljIGludCBpbnRlbF9n
dF9pbml0X3NjcmF0Y2goc3RydWN0IGludGVsX2d0ICpndCwgdW5zaWduZWQgaW50IHNpemUpCitp
bnQgaW50ZWxfZ3RfaW5pdF9zY3JhdGNoKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHVuc2lnbmVkIGlu
dCBzaXplKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7CiAJ
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsK
IAlpbnQgcmV0OwogCisJLyogQ3JlYXRlZCBsYXppbHkgLSBzdWJtaXNzaW9uIGJhY2tlbmQgY2Fs
bHMgdXMgYXQgaXRzIGluaXQgdGltZSAqLworCWlmIChndC0+c2NyYXRjaCkKKwkJcmV0dXJuIDA7
CisKIAlvYmogPSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3N0b2xlbihpOTE1LCBzaXplKTsKIAlp
ZiAoIW9iaikKIAkJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1LCBz
aXplKTsKQEAgLTM2MSwxNyArMzY1LDYgQEAgc3RhdGljIHZvaWQgaW50ZWxfZ3RfZmluaV9zY3Jh
dGNoKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJaTkxNV92bWFfdW5waW5fYW5kX3JlbGVhc2UoJmd0
LT5zY3JhdGNoLCAwKTsKIH0KIAotaW50IGludGVsX2d0X2luaXQoc3RydWN0IGludGVsX2d0ICpn
dCkKLXsKLQlpbnQgZXJyOwotCi0JZXJyID0gaW50ZWxfZ3RfaW5pdF9zY3JhdGNoKGd0LCBJU19H
RU4oZ3QtPmk5MTUsIDIpID8gU1pfMjU2SyA6IFNaXzRLKTsKLQlpZiAoZXJyKQotCQlyZXR1cm4g
ZXJyOwotCi0JcmV0dXJuIDA7Ci19Ci0KIHZvaWQgaW50ZWxfZ3RfZHJpdmVyX3JlbW92ZShzdHJ1
Y3QgaW50ZWxfZ3QgKmd0KQogewogCUdFTV9CVUdfT04oZ3QtPmF3YWtlKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ndC5oCmluZGV4IGU2YWIwYmZmMGVmYi4uYjllZDhlYTM3MDZlIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2d0LmgKQEAgLTMwLDcgKzMwLDcgQEAgc3RhdGljIGlubGluZSBz
dHJ1Y3QgaW50ZWxfZ3QgKmh1Y190b19ndChzdHJ1Y3QgaW50ZWxfaHVjICpodWMpCiB2b2lkIGlu
dGVsX2d0X2luaXRfZWFybHkoc3RydWN0IGludGVsX2d0ICpndCwgc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwogdm9pZCBpbnRlbF9ndF9pbml0X2h3X2Vhcmx5KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KTsKIGludCBfX211c3RfY2hlY2sgaW50ZWxfZ3RfaW5pdF9odyhzdHJ1
Y3QgaW50ZWxfZ3QgKmd0KTsKLWludCBpbnRlbF9ndF9pbml0KHN0cnVjdCBpbnRlbF9ndCAqZ3Qp
OworaW50IGludGVsX2d0X2luaXRfc2NyYXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1bnNpZ25l
ZCBpbnQgc2l6ZSk7CiB2b2lkIGludGVsX2d0X2RyaXZlcl9yZWdpc3RlcihzdHJ1Y3QgaW50ZWxf
Z3QgKmd0KTsKIAogdm9pZCBpbnRlbF9ndF9kcml2ZXJfdW5yZWdpc3RlcihzdHJ1Y3QgaW50ZWxf
Z3QgKmd0KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jpbmdi
dWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYwppbmRl
eCAwNzQ3YjhjOWY3NjguLjY0ZDIyMjM5ZGY4YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3JpbmdidWZmZXIuYwpAQCAtMjMxNSw2ICsyMzE1LDExIEBAIGludCBpbnRlbF9yaW5n
X3N1Ym1pc3Npb25faW5pdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJc3RydWN0
IGludGVsX3JpbmcgKnJpbmc7CiAJaW50IGVycjsKIAorCWVyciA9IGludGVsX2d0X2luaXRfc2Ny
YXRjaChlbmdpbmUtPmd0LAorCQkJCSAgICBJU19HRU4oZW5naW5lLT5pOTE1LCAyKSA/IFNaXzI1
NksgOiBTWl80Syk7CisJaWYgKGVycikKKwkJZ290byBlcnI7CisKIAl0aW1lbGluZSA9IGludGVs
X3RpbWVsaW5lX2NyZWF0ZShlbmdpbmUtPmd0LCBlbmdpbmUtPnN0YXR1c19wYWdlLnZtYSk7CiAJ
aWYgKElTX0VSUih0aW1lbGluZSkpIHsKIAkJZXJyID0gUFRSX0VSUih0aW1lbGluZSk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW0uYwppbmRleCBlMjg5N2E2NjYyMjUuLjA5ZDM4N2Y0ZDQ2YiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2dlbS5jCkBAIC0xMzM3LDggKzEzMzcsNiBAQCBpbnQgaTkxNV9nZW1faW5p
dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCWdvdG8gZXJyX3VubG9jazsK
IAl9CiAKLQlpbnRlbF9ndF9pbml0KCZkZXZfcHJpdi0+Z3QpOwotCiAJcmV0ID0gaW50ZWxfZW5n
aW5lc19zZXR1cChkZXZfcHJpdik7CiAJaWYgKHJldCkgewogCQlHRU1fQlVHX09OKHJldCA9PSAt
RUlPKTsKLS0gCjIuMjEuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50
ZWwtZ2Z4

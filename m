Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A1B4AB9505
	for <lists+intel-gfx@lfdr.de>; Fri, 20 Sep 2019 18:14:51 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C44276FD1F;
	Fri, 20 Sep 2019 16:14:49 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 01D6D6E08C
 for <intel-gfx@lists.freedesktop.org>; Fri, 20 Sep 2019 16:14:47 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 20 Sep 2019 09:14:47 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,529,1559545200"; d="scan'208";a="199777918"
Received: from leonidf-mobl.ger.corp.intel.com (HELO [10.252.3.171])
 ([10.252.3.171])
 by orsmga002.jf.intel.com with ESMTP; 20 Sep 2019 09:14:44 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190902040303.14195-1-chris@chris-wilson.co.uk>
 <20190902040303.14195-15-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <7c57c74a-f6d6-168a-b53b-f15323b4ca55@linux.intel.com>
Date: Fri, 20 Sep 2019 17:14:43 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20190902040303.14195-15-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 15/21] drm/i915: Coordinate i915_active with
 its own mutex
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDAyLzA5LzIwMTkgMDU6MDIsIENocmlzIFdpbHNvbiB3cm90ZToKPiBGb3JnbyB0aGUgc3Ry
dWN0X211dGV4IHNlcmlhbGlzYXRpb24gZm9yIGk5MTVfYWN0aXZlLCBhbmQgaW50ZXJwb3NlIGl0
cwo+IG93biBtdXRleCBoYW5kbGluZyBmb3IgYWN0aXZlL3JldGlyZS4KPiAKPiBUaGlzIGlzIGEg
bXVsdGktbGF5ZXJlZCBzbGVpZ2h0LW9mLWhhbmQuIEZpcnN0LCB3ZSBoYWQgdG8gZW5zdXJlIHRo
YXQgbm8KPiBhY3RpdmUvcmV0aXJlIGNhbGxiYWNrcyBhY2NpZGVudGFsbHkgaW52ZXJ0ZWQgdGhl
IG11dGV4IG9yZGVyaW5nIHJ1bGVzLAo+IG5vciBhc3N1bWVkIHRoYXQgdGhleSB3ZXJlIHRoZW1z
ZWx2ZXMgc2VyaWFsaXNlZCBieSBzdHJ1Y3RfbXV0ZXguIE1vcmUKPiBjaGFsbGVuZ2luZyB0aG91
Z2gsIGlzIHRoZSBydWxlIG92ZXIgdXBkYXRpbmcgZWxlbWVudHMgb2YgdGhlIGFjdGl2ZQo+IHJi
dHJlZS4gSW5zdGVhZCBvZiB0aGUgd2hvbGUgaTkxNV9hY3RpdmUgbm93IGJlaW5nIHNlcmlhbGlz
ZWQgYnkKPiBzdHJ1Y3RfbXV0ZXgsIGFsbG9jYXRpb25zL3JvdGF0aW9ucyBvZiB0aGUgdHJlZSBh
cmUgc2VyaWFsaXNlZCBieSB0aGUKPiBpOTE1X2FjdGl2ZS5tdXRleCBhbmQgaW5kaXZpZHVhbCBu
b2RlcyBhcmUgc2VyaWFsaXNlZCBieSB0aGUgY2FsbGVyCj4gdXNpbmcgdGhlIGk5MTVfdGltZWxp
bmUubXV0ZXggKHdlIG5lZWQgdG8gdXNlIG5lc3RlZCBzcGlubG9ja3MgdG8KPiBpbnRlcmFjdCB3
aXRoIHRoZSBkbWFfZmVuY2UgY2FsbGJhY2sgbGlzdHMpLgo+IAo+IFRoZSBwYWluIHBvaW50IGhl
cmUgaXMgdGhhdCBpbnN0ZWFkIG9mIGEgc2luZ2xlIG11dGV4IGFyb3VuZCBleGVjYnVmLCB3ZQo+
IG5vdyBoYXZlIHRvIHRha2UgYSBtdXRleCBmb3IgYWN0aXZlIHRyYWNrZXIgKG9uZSBmb3IgZWFj
aCB2bWEsIGNvbnRleHQsCj4gZXRjKSBhbmQgYSBjb3VwbGUgb2Ygc3BpbmxvY2tzIGZvciBlYWNo
IGZlbmNlIHVwZGF0ZS4gVGhlIGltcHJvdmVtZW50IGluCj4gZmluZSBncmFpbmVkIGxvY2tpbmcg
YWxsb3dpbmcgZm9yIG11bHRpcGxlIGNvbmN1cnJlbnQgY2xpZW50cwo+IChldmVudHVhbGx5ISkg
c2hvdWxkIGJlIHdvcnRoIGl0IGluIHR5cGljYWwgbG9hZHMuCj4gCj4gU2lnbmVkLW9mZi1ieTog
Q2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Cj4gLS0tCj4gICAuLi4vZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZnJvbnRidWZmZXIuYyAgfCAgIDIgKy0KPiAgIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3ZlcmxheS5jICB8ICAgNSArLQo+ICAgLi4u
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xpZW50X2JsdC5jICAgIHwgICAyICstCj4gICBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jICAgfCAgIDggKy0KPiAg
IC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oICB8ICAgMSArCj4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYyAgICAgICAgfCAgIDkgKy0K
PiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYyAgICAgICB8ICAgNiAr
LQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuYyAgIHwgICAy
ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5oICAgfCAg
IDIgKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgICAgICAgICB8
ICAxMCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuYyAgICAg
IHwgICA5ICstCj4gICAuLi4vZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lX3R5cGVzLmgg
ICAgfCAgIDIgKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQu
YyAgICB8ICAxNiArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMg
ICAgICAgIHwgIDEwICstCj4gICAuLi4vZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0cy9tb2NrX3Rp
bWVsaW5lLmMgfCAgIDIgKy0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIu
YyAgICAgICAgICB8ICAgMyAtCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5j
ICAgICAgICAgICAgfCAyOTEgKysrKysrKy0tLS0tLS0tLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9hY3RpdmUuaCAgICAgICAgICAgIHwgMzE4ICsrKystLS0tLS0tLS0tLS0tLQo+ICAg
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMuaCAgICAgIHwgIDIzICstCj4g
ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jICAgICAgICAgICAgICAgfCAgNDIgKyst
Cj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYyAgICAgICAgICAgfCAgIDMg
Ky0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMgICAgICAgICB8ICAg
NCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMgICAgICAgICAgIHwg
IDM5ICstLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmggICAgICAgICAg
IHwgICAxIC0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMgICAgICAgICAgICAg
ICB8ICAgOCArLQo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZl
LmMgIHwgIDM2ICstCj4gICAyNiBmaWxlcyBjaGFuZ2VkLCAyNzQgaW5zZXJ0aW9ucygrKSwgNTgw
IGRlbGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Zyb250YnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2Zyb250YnVmZmVyLmMKPiBpbmRleCA2NDI4YjhkZDcwZDMuLjg0YjE2NGYzMTg5NSAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Zyb250YnVmZmVy
LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Zyb250YnVmZmVy
LmMKPiBAQCAtMjU3LDcgKzI1Nyw3IEBAIGludGVsX2Zyb250YnVmZmVyX2dldChzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqKQo+ICAgCWZyb250LT5vYmogPSBvYmo7Cj4gICAJa3JlZl9p
bml0KCZmcm9udC0+cmVmKTsKPiAgIAlhdG9taWNfc2V0KCZmcm9udC0+Yml0cywgMCk7Cj4gLQlp
OTE1X2FjdGl2ZV9pbml0KGk5MTUsICZmcm9udC0+d3JpdGUsCj4gKwlpOTE1X2FjdGl2ZV9pbml0
KCZmcm9udC0+d3JpdGUsCj4gICAJCQkgZnJvbnRidWZmZXJfYWN0aXZlLAo+ICAgCQkJIGk5MTVf
YWN0aXZlX21heV9zbGVlcChmcm9udGJ1ZmZlcl9yZXRpcmUpKTsKPiAgIAo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfb3ZlcmxheS5jCj4gaW5kZXggNGYzNjU1N2IzZjNi
Li41NDRlOTUzMzQyZWEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9vdmVybGF5LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX292ZXJsYXkuYwo+IEBAIC0yMzAsNyArMjMwLDcgQEAgYWxsb2NfcmVxdWVzdChzdHJ1Y3Qg
aW50ZWxfb3ZlcmxheSAqb3ZlcmxheSwgdm9pZCAoKmZuKShzdHJ1Y3QgaW50ZWxfb3ZlcmxheSAq
KSkKPiAgIAlpZiAoSVNfRVJSKHJxKSkKPiAgIAkJcmV0dXJuIHJxOwo+ICAgCj4gLQllcnIgPSBp
OTE1X2FjdGl2ZV9yZWYoJm92ZXJsYXktPmxhc3RfZmxpcCwgcnEtPnRpbWVsaW5lLCBycSk7Cj4g
KwllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJm92ZXJsYXktPmxhc3RfZmxpcCwgcnEtPnRpbWVsaW5l
LCAmcnEtPmZlbmNlKTsKPiAgIAlpZiAoZXJyKSB7Cj4gICAJCWk5MTVfcmVxdWVzdF9hZGQocnEp
Owo+ICAgCQlyZXR1cm4gRVJSX1BUUihlcnIpOwo+IEBAIC0xMzYwLDggKzEzNjAsNyBAQCB2b2lk
IGludGVsX292ZXJsYXlfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQo+
ICAgCW92ZXJsYXktPmNvbnRyYXN0ID0gNzU7Cj4gICAJb3ZlcmxheS0+c2F0dXJhdGlvbiA9IDE0
NjsKPiAgIAo+IC0JaTkxNV9hY3RpdmVfaW5pdChkZXZfcHJpdiwKPiAtCQkJICZvdmVybGF5LT5s
YXN0X2ZsaXAsCj4gKwlpOTE1X2FjdGl2ZV9pbml0KCZvdmVybGF5LT5sYXN0X2ZsaXAsCj4gICAJ
CQkgTlVMTCwgaW50ZWxfb3ZlcmxheV9sYXN0X2ZsaXBfcmV0aXJlKTsKPiAgIAo+ICAgCXJldCA9
IGdldF9yZWdpc3RlcnMob3ZlcmxheSwgT1ZFUkxBWV9ORUVEU19QSFlTSUNBTChkZXZfcHJpdikp
Owo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xpZW50
X2JsdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsaWVudF9ibHQuYwo+
IGluZGV4IDllNzJiNDJhODZmNS4uYWNlNTBiYjllZTFmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xpZW50X2JsdC5jCj4gQEAgLTE2MCw3ICsxNjAsNyBA
QCBzdGF0aWMgaW50IG1vdmVfdG9fYWN0aXZlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLCBzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycSkKPiAgIAlpZiAoZXJyKQo+ICAgCQlyZXR1cm4gZXJyOwo+ICAgCj4g
LQlyZXR1cm4gaTkxNV9hY3RpdmVfcmVmKCZ2bWEtPmFjdGl2ZSwgcnEtPnRpbWVsaW5lLCBycSk7
Cj4gKwlyZXR1cm4gaTkxNV9hY3RpdmVfcmVmKCZ2bWEtPmFjdGl2ZSwgcnEtPnRpbWVsaW5lLCAm
cnEtPmZlbmNlKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgY2xlYXJfcGFnZXNfd29ya2Vy
KHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9jb250ZXh0LmMKPiBpbmRleCA0ZjMwM2NiOTQ2OTguLmI4ZGRjZjc4OTlhMSAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwo+IEBAIC04
NjgsMjAgKzg2OCwxOCBAQCBzdGF0aWMgaW50IGNvbnRleHRfYmFycmllcl90YXNrKHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpjdHgsCj4gICAJCQkJdm9pZCAoKnRhc2spKHZvaWQgKmRhdGEpLAo+
ICAgCQkJCXZvaWQgKmRhdGEpCj4gICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IGN0eC0+aTkxNTsKPiAgIAlzdHJ1Y3QgY29udGV4dF9iYXJyaWVyX3Rhc2sgKmNiOwo+ICAg
CXN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzX2l0ZXIgaXQ7Cj4gICAJc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlOwo+ICAgCWludCBlcnIgPSAwOwo+ICAgCj4gLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZp
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAgIAlHRU1fQlVHX09OKCF0YXNrKTsKPiAgIAo+ICAg
CWNiID0ga21hbGxvYyhzaXplb2YoKmNiKSwgR0ZQX0tFUk5FTCk7Cj4gICAJaWYgKCFjYikKPiAg
IAkJcmV0dXJuIC1FTk9NRU07Cj4gICAKPiAtCWk5MTVfYWN0aXZlX2luaXQoaTkxNSwgJmNiLT5i
YXNlLCBOVUxMLCBjYl9yZXRpcmUpOwo+ICsJaTkxNV9hY3RpdmVfaW5pdCgmY2ItPmJhc2UsIE5V
TEwsIGNiX3JldGlyZSk7Cj4gICAJZXJyID0gaTkxNV9hY3RpdmVfYWNxdWlyZSgmY2ItPmJhc2Up
Owo+ICAgCWlmIChlcnIpIHsKPiAgIAkJa2ZyZWUoY2IpOwo+IEBAIC05MTMsNyArOTExLDkgQEAg
c3RhdGljIGludCBjb250ZXh0X2JhcnJpZXJfdGFzayhzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
Y3R4LAo+ICAgCQlpZiAoZW1pdCkKPiAgIAkJCWVyciA9IGVtaXQocnEsIGRhdGEpOwo+ICAgCQlp
ZiAoZXJyID09IDApCj4gLQkJCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmY2ItPmJhc2UsIHJxLT50
aW1lbGluZSwgcnEpOwo+ICsJCQllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJmNiLT5iYXNlLAo+ICsJ
CQkJCSAgICAgIHJxLT50aW1lbGluZSwKPiArCQkJCQkgICAgICAmcnEtPmZlbmNlKTsKPiAgIAo+
ICAgCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKPiAgIAkJaWYgKGVycikKPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCj4gaW5kZXggYjA1NTA3
MjdlNjlhLi4wM2UxZTMyMDZhYjMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCj4gQEAgLTgsNiArOCw3IEBACj4gICAjZGVmaW5l
IF9fSTkxNV9HRU1fT0JKRUNUX1RZUEVTX0hfXwo+ICAgCj4gICAjaW5jbHVkZSA8ZHJtL2RybV9n
ZW0uaD4KPiArI2luY2x1ZGUgPHVhcGkvZHJtL2k5MTVfZHJtLmg+Cj4gICAKPiAgICNpbmNsdWRl
ICJpOTE1X2FjdGl2ZS5oIgo+ICAgI2luY2x1ZGUgImk5MTVfc2VsZnRlc3QuaCIKPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYwo+IGluZGV4IDkyZTUzYzI1NDI0Yy4uOTI1NThm
YTQ3MTA4IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9w
bS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKPiBAQCAt
MTYsMTQgKzE2LDExIEBAIHN0YXRpYyB2b2lkIGNhbGxfaWRsZV9iYXJyaWVycyhzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICAJc3RydWN0IGxsaXN0X25vZGUgKm5vZGUsICpuZXh0
Owo+ICAgCj4gICAJbGxpc3RfZm9yX2VhY2hfc2FmZShub2RlLCBuZXh0LCBsbGlzdF9kZWxfYWxs
KCZlbmdpbmUtPmJhcnJpZXJfdGFza3MpKSB7Cj4gLQkJc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVl
c3QgKmFjdGl2ZSA9Cj4gKwkJc3RydWN0IGRtYV9mZW5jZV9jYiAqY2IgPQo+ICAgCQkJY29udGFp
bmVyX29mKChzdHJ1Y3QgbGlzdF9oZWFkICopbm9kZSwKPiAtCQkJCSAgICAgdHlwZW9mKCphY3Rp
dmUpLCBsaW5rKTsKPiArCQkJCSAgICAgdHlwZW9mKCpjYiksIG5vZGUpOwo+ICAgCj4gLQkJSU5J
VF9MSVNUX0hFQUQoJmFjdGl2ZS0+bGluayk7Cj4gLQkJUkNVX0lOSVRfUE9JTlRFUihhY3RpdmUt
PnJlcXVlc3QsIE5VTEwpOwo+IC0KPiAtCQlhY3RpdmUtPnJldGlyZShhY3RpdmUsIE5VTEwpOwo+
ICsJCWNiLT5mdW5jKE5VTEwsIGNiKTsKPiAgIAl9Cj4gICB9Cj4gICAKPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jCj4gaW5kZXggYWU3YzI2ODllZjMwLi41N2UxM2M2ZjU5
YzUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jCj4gQEAgLTI0
MCw3ICsyNDAsNyBAQCBpbnRlbF9jb250ZXh0X2luaXQoc3RydWN0IGludGVsX2NvbnRleHQgKmNl
LAo+ICAgCj4gICAJbXV0ZXhfaW5pdCgmY2UtPnBpbl9tdXRleCk7Cj4gICAKPiAtCWk5MTVfYWN0
aXZlX2luaXQoY3R4LT5pOTE1LCAmY2UtPmFjdGl2ZSwKPiArCWk5MTVfYWN0aXZlX2luaXQoJmNl
LT5hY3RpdmUsCj4gICAJCQkgX19pbnRlbF9jb250ZXh0X2FjdGl2ZSwgX19pbnRlbF9jb250ZXh0
X3JldGlyZSk7Cj4gICB9Cj4gICAKPiBAQCAtMzA3LDcgKzMwNyw3IEBAIGludCBpbnRlbF9jb250
ZXh0X3ByZXBhcmVfcmVtb3RlX3JlcXVlc3Qoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAo+ICAg
CQkJcmV0dXJuIGVycjsKPiAgIAo+ICAgCQkvKiBRdWV1ZSB0aGlzIHN3aXRjaCBhZnRlciBjdXJy
ZW50IGFjdGl2aXR5IGJ5IHRoaXMgY29udGV4dC4gKi8KPiAtCQllcnIgPSBpOTE1X2FjdGl2ZV9y
ZXF1ZXN0X3NldCgmdGwtPmxhc3RfcmVxdWVzdCwgcnEpOwo+ICsJCWVyciA9IGk5MTVfYWN0aXZl
X2ZlbmNlX3NldCgmdGwtPmxhc3RfcmVxdWVzdCwgcnEpOwo+ICAgCQltdXRleF91bmxvY2soJnRs
LT5tdXRleCk7Cj4gICAJCWlmIChlcnIpCj4gICAJCQlyZXR1cm4gZXJyOwo+IEBAIC0zMjEsNyAr
MzIxLDcgQEAgaW50IGludGVsX2NvbnRleHRfcHJlcGFyZV9yZW1vdGVfcmVxdWVzdChzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsCj4gICAJICogd29yZHMgdHJhbnNmZXIgdGhlIHBpbm5lZCBjZSBv
YmplY3QgdG8gdHJhY2tlZCBhY3RpdmUgcmVxdWVzdC4KPiAgIAkgKi8KPiAgIAlHRU1fQlVHX09O
KGk5MTVfYWN0aXZlX2lzX2lkbGUoJmNlLT5hY3RpdmUpKTsKPiAtCXJldHVybiBpOTE1X2FjdGl2
ZV9yZWYoJmNlLT5hY3RpdmUsIHJxLT50aW1lbGluZSwgcnEpOwo+ICsJcmV0dXJuIGk5MTVfYWN0
aXZlX3JlZigmY2UtPmFjdGl2ZSwgcnEtPnRpbWVsaW5lLCAmcnEtPmZlbmNlKTsKPiAgIH0KPiAg
IAo+ICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9lbmdpbmVfcG9vbC5jCj4gaW5kZXggODFmYWIxMDFmZGI0Li4zY2RiZDVmOGI1YmUgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuYwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmMKPiBAQCAtOTUs
NyArOTUsNyBAQCBub2RlX2NyZWF0ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgKnBvb2wsIHNp
emVfdCBzeikKPiAgIAkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7Cj4gICAKPiAgIAlub2RlLT5w
b29sID0gcG9vbDsKPiAtCWk5MTVfYWN0aXZlX2luaXQoZW5naW5lLT5pOTE1LCAmbm9kZS0+YWN0
aXZlLCBwb29sX2FjdGl2ZSwgcG9vbF9yZXRpcmUpOwo+ICsJaTkxNV9hY3RpdmVfaW5pdCgmbm9k
ZS0+YWN0aXZlLCBwb29sX2FjdGl2ZSwgcG9vbF9yZXRpcmUpOwo+ICAgCj4gICAJb2JqID0gaTkx
NV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChlbmdpbmUtPmk5MTUsIHN6KTsKPiAgIAlpZiAo
SVNfRVJSKG9iaikpIHsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZW5naW5lX3Bvb2wuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9w
b29sLmgKPiBpbmRleCA3ZTIxMjNiMzM1OTQuLjRiMGYzYWUwYzdlMiAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5oCj4gKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuaAo+IEBAIC0xOCw3ICsxOCw3IEBA
IHN0YXRpYyBpbmxpbmUgaW50Cj4gICBpbnRlbF9lbmdpbmVfcG9vbF9tYXJrX2FjdGl2ZShzdHJ1
Y3QgaW50ZWxfZW5naW5lX3Bvb2xfbm9kZSAqbm9kZSwKPiAgIAkJCSAgICAgIHN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxKQo+ICAgewo+IC0JcmV0dXJuIGk5MTVfYWN0aXZlX3JlZigmbm9kZS0+YWN0
aXZlLCBycS0+dGltZWxpbmUsIHJxKTsKPiArCXJldHVybiBpOTE1X2FjdGl2ZV9yZWYoJm5vZGUt
PmFjdGl2ZSwgcnEtPnRpbWVsaW5lLCAmcnEtPmZlbmNlKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGlj
IGlubGluZSB2b2lkCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X3Jlc2V0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCj4gaW5kZXgg
YjlkODRkNTJlOTg2Li40ODI1YzgyYWVmZWUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3Jlc2V0LmMKPiBAQCAtODE0LDEwICs4MTQsMTAgQEAgc3RhdGljIGJvb2wgX19pbnRlbF9n
dF91bnNldF93ZWRnZWQoc3RydWN0IGludGVsX2d0ICpndCkKPiAgIAkgKi8KPiAgIAlzcGluX2xv
Y2tfaXJxc2F2ZSgmdGltZWxpbmVzLT5sb2NrLCBmbGFncyk7Cj4gICAJbGlzdF9mb3JfZWFjaF9l
bnRyeSh0bCwgJnRpbWVsaW5lcy0+YWN0aXZlX2xpc3QsIGxpbmspIHsKPiAtCQlzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycTsKPiArCQlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKPiAgIAo+IC0JCXJx
ID0gaTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRfdW5sb2NrZWQoJnRsLT5sYXN0X3JlcXVlc3QpOwo+
IC0JCWlmICghcnEpCj4gKwkJZmVuY2UgPSBpOTE1X2FjdGl2ZV9mZW5jZV9nZXQoJnRsLT5sYXN0
X3JlcXVlc3QpOwo+ICsJCWlmICghZmVuY2UpCj4gICAJCQljb250aW51ZTsKPiAgIAo+ICAgCQlz
cGluX3VubG9ja19pcnFyZXN0b3JlKCZ0aW1lbGluZXMtPmxvY2ssIGZsYWdzKTsKPiBAQCAtODI5
LDggKzgyOSw4IEBAIHN0YXRpYyBib29sIF9faW50ZWxfZ3RfdW5zZXRfd2VkZ2VkKHN0cnVjdCBp
bnRlbF9ndCAqZ3QpCj4gICAJCSAqIChJOTE1X0ZFTkNFX1RJTUVPVVQpIHNvIHRoaXMgd2FpdCBz
aG91bGQgbm90IGJlIHVuYm91bmRlZAo+ICAgCQkgKiBpbiB0aGUgd29yc3QgY2FzZS4KPiAgIAkJ
ICovCj4gLQkJZG1hX2ZlbmNlX2RlZmF1bHRfd2FpdCgmcnEtPmZlbmNlLCBmYWxzZSwgTUFYX1ND
SEVEVUxFX1RJTUVPVVQpOwo+IC0JCWk5MTVfcmVxdWVzdF9wdXQocnEpOwo+ICsJCWRtYV9mZW5j
ZV9kZWZhdWx0X3dhaXQoZmVuY2UsIGZhbHNlLCBNQVhfU0NIRURVTEVfVElNRU9VVCk7Cj4gKwkJ
ZG1hX2ZlbmNlX3B1dChmZW5jZSk7Cj4gICAKPiAgIAkJLyogUmVzdGFydCBpdGVyYXRpb24gYWZ0
ZXIgZHJvcGluZyBsb2NrICovCj4gICAJCXNwaW5fbG9ja19pcnFzYXZlKCZ0aW1lbGluZXMtPmxv
Y2ssIGZsYWdzKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
dGltZWxpbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmMKPiBp
bmRleCBkODI0YmNhNDNkNTUuLjc1ZDg5NjE2N2NmYiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfdGltZWxpbmUuYwo+IEBAIC0xNzgsOCArMTc4LDcgQEAgY2FjaGVsaW5lX2Fs
bG9jKHN0cnVjdCBpbnRlbF90aW1lbGluZV9od3NwICpod3NwLCB1bnNpZ25lZCBpbnQgY2FjaGVs
aW5lKQo+ICAgCWNsLT5od3NwID0gaHdzcDsKPiAgIAljbC0+dmFkZHIgPSBwYWdlX3BhY2tfYml0
cyh2YWRkciwgY2FjaGVsaW5lKTsKPiAgIAo+IC0JaTkxNV9hY3RpdmVfaW5pdChod3NwLT5ndC0+
aTkxNSwgJmNsLT5hY3RpdmUsCj4gLQkJCSBfX2NhY2hlbGluZV9hY3RpdmUsIF9fY2FjaGVsaW5l
X3JldGlyZSk7Cj4gKwlpOTE1X2FjdGl2ZV9pbml0KCZjbC0+YWN0aXZlLCBfX2NhY2hlbGluZV9h
Y3RpdmUsIF9fY2FjaGVsaW5lX3JldGlyZSk7Cj4gICAKPiAgIAlyZXR1cm4gY2w7Cj4gICB9Cj4g
QEAgLTI1NSw3ICsyNTQsNyBAQCBpbnQgaW50ZWxfdGltZWxpbmVfaW5pdChzdHJ1Y3QgaW50ZWxf
dGltZWxpbmUgKnRpbWVsaW5lLAo+ICAgCj4gICAJbXV0ZXhfaW5pdCgmdGltZWxpbmUtPm11dGV4
KTsKPiAgIAo+IC0JSU5JVF9BQ1RJVkVfUkVRVUVTVCgmdGltZWxpbmUtPmxhc3RfcmVxdWVzdCwg
JnRpbWVsaW5lLT5tdXRleCk7Cj4gKwlJTklUX0FDVElWRV9GRU5DRSgmdGltZWxpbmUtPmxhc3Rf
cmVxdWVzdCwgJnRpbWVsaW5lLT5tdXRleCk7Cj4gICAJSU5JVF9MSVNUX0hFQUQoJnRpbWVsaW5l
LT5yZXF1ZXN0cyk7Cj4gICAKPiAgIAlpOTE1X3N5bmNtYXBfaW5pdCgmdGltZWxpbmUtPnN5bmMp
Owo+IEBAIC00NDMsNyArNDQyLDcgQEAgX19pbnRlbF90aW1lbGluZV9nZXRfc2Vxbm8oc3RydWN0
IGludGVsX3RpbWVsaW5lICp0bCwKPiAgIAkgKiBmcmVlIGl0IGFmdGVyIHRoZSBjdXJyZW50IHJl
cXVlc3QgaXMgcmV0aXJlZCwgd2hpY2ggZW5zdXJlcyB0aGF0Cj4gICAJICogYWxsIHdyaXRlcyBp
bnRvIHRoZSBjYWNoZWxpbmUgZnJvbSBwcmV2aW91cyByZXF1ZXN0cyBhcmUgY29tcGxldGUuCj4g
ICAJICovCj4gLQllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJnRsLT5od3NwX2NhY2hlbGluZS0+YWN0
aXZlLCB0bCwgcnEpOwo+ICsJZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZ0bC0+aHdzcF9jYWNoZWxp
bmUtPmFjdGl2ZSwgdGwsICZycS0+ZmVuY2UpOwo+ICAgCWlmIChlcnIpCj4gICAJCWdvdG8gZXJy
X2NhY2hlbGluZTsKPiAgIAo+IEBAIC00OTQsNyArNDkzLDcgQEAgaW50IGludGVsX3RpbWVsaW5l
X2dldF9zZXFubyhzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsLAo+ICAgc3RhdGljIGludCBjYWNo
ZWxpbmVfcmVmKHN0cnVjdCBpbnRlbF90aW1lbGluZV9jYWNoZWxpbmUgKmNsLAo+ICAgCQkJIHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQo+ICAgewo+IC0JcmV0dXJuIGk5MTVfYWN0aXZlX3JlZigm
Y2wtPmFjdGl2ZSwgcnEtPnRpbWVsaW5lLCBycSk7Cj4gKwlyZXR1cm4gaTkxNV9hY3RpdmVfcmVm
KCZjbC0+YWN0aXZlLCBycS0+dGltZWxpbmUsICZycS0+ZmVuY2UpOwo+ICAgfQo+ICAgCj4gICBp
bnQgaW50ZWxfdGltZWxpbmVfcmVhZF9od3NwKHN0cnVjdCBpOTE1X3JlcXVlc3QgKmZyb20sCj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lX3R5cGVz
LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZV90eXBlcy5oCj4gaW5k
ZXggMmIxYmFmMmZjYzhlLi42ZDdhYzEyOWNlOGEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmVfdHlwZXMuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lX3R5cGVzLmgKPiBAQCAtNjMsNyArNjMsNyBAQCBzdHJ1
Y3QgaW50ZWxfdGltZWxpbmUgewo+ICAgCSAqIHRoZSByZXF1ZXN0IHVzaW5nIGk5MTVfYWN0aXZl
X3JlcXVlc3RfZ2V0X3JlcXVlc3RfcmN1KCksIG9yIGhvbGQgdGhlCgpMb29rcyBsaWtlIGEgc3Rh
bGUgY29tbWVudC4KCj4gICAJICogc3RydWN0X211dGV4Lgo+ICAgCSAqLwo+IC0Jc3RydWN0IGk5
MTVfYWN0aXZlX3JlcXVlc3QgbGFzdF9yZXF1ZXN0Owo+ICsJc3RydWN0IGk5MTVfYWN0aXZlX2Zl
bmNlIGxhc3RfcmVxdWVzdDsKCldvcnRoIHJlbmFtaW5nIHRvIGxhc3RfZmVuY2Ugbm93IHRoYXQg
cmVxdWVzdCBuYW1pbmcgaXMgb3RoZXJ3aXNlIGdvbmUgCmZyb20gaTkxNV9hY3RpdmU/Cgo+ICAg
Cj4gICAJLyoqCj4gICAJICogV2UgdHJhY2sgdGhlIG1vc3QgcmVjZW50IHNlcW5vIHRoYXQgd2Ug
d2FpdCBvbiBpbiBldmVyeSBjb250ZXh0IHNvCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X2NvbnRleHQuYwo+IGluZGV4IDlkMWVhMjZjN2EyZC4uMTQyMDUzM2U4ZmQ1IDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYwo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYwo+IEBAIC00MSwy
NCArNDEsMjAgQEAgc3RhdGljIGludCBjb250ZXh0X3N5bmMoc3RydWN0IGludGVsX2NvbnRleHQg
KmNlKQo+ICAgCj4gICAJbXV0ZXhfbG9jaygmdGwtPm11dGV4KTsKPiAgIAlkbyB7Cj4gLQkJc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnE7Cj4gKwkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7Cj4gICAJ
CWxvbmcgdGltZW91dDsKPiAgIAo+IC0JCXJjdV9yZWFkX2xvY2soKTsKPiAtCQlycSA9IHJjdV9k
ZXJlZmVyZW5jZSh0bC0+bGFzdF9yZXF1ZXN0LnJlcXVlc3QpOwo+IC0JCWlmIChycSkKPiAtCQkJ
cnEgPSBpOTE1X3JlcXVlc3RfZ2V0X3JjdShycSk7Cj4gLQkJcmN1X3JlYWRfdW5sb2NrKCk7Cj4g
LQkJaWYgKCFycSkKPiArCQlmZW5jZSA9IGk5MTVfYWN0aXZlX2ZlbmNlX2dldCgmdGwtPmxhc3Rf
cmVxdWVzdCk7Cj4gKwkJaWYgKCFmZW5jZSkKPiAgIAkJCWJyZWFrOwo+ICAgCj4gLQkJdGltZW91
dCA9IGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDEwKTsKPiArCQl0aW1lb3V0ID0gZG1h
X2ZlbmNlX3dhaXRfdGltZW91dChmZW5jZSwgZmFsc2UsIEhaIC8gMTApOwo+ICAgCQlpZiAodGlt
ZW91dCA8IDApCj4gICAJCQllcnIgPSB0aW1lb3V0Owo+ICAgCQllbHNlCj4gLQkJCWk5MTVfcmVx
dWVzdF9yZXRpcmVfdXB0byhycSk7Cj4gKwkJCWk5MTVfcmVxdWVzdF9yZXRpcmVfdXB0byh0b19y
ZXF1ZXN0KGZlbmNlKSk7Cj4gICAKPiAtCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKPiArCQlkbWFf
ZmVuY2VfcHV0KGZlbmNlKTsKPiAgIAl9IHdoaWxlICghZXJyKTsKPiAgIAltdXRleF91bmxvY2so
JnRsLT5tdXRleCk7Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwo+
IGluZGV4IGQ3OTExNTg5ODhkNi4uYWNhMWIzYTljNWRlIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKPiBAQCAtOTg0LDkgKzk4NCwxMyBAQCBzdGF0aWMgc3RydWN0
IGk5MTVfcmVxdWVzdCAqZHVtbXlfcmVxdWVzdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCj4gICAJaWYgKCFycSkKPiAgIAkJcmV0dXJuIE5VTEw7Cj4gICAKPiAtCUlOSVRfTElTVF9I
RUFEKCZycS0+YWN0aXZlX2xpc3QpOwo+ICAgCXJxLT5lbmdpbmUgPSBlbmdpbmU7Cj4gICAKPiAr
CXNwaW5fbG9ja19pbml0KCZycS0+bG9jayk7Cj4gKwlJTklUX0xJU1RfSEVBRCgmcnEtPmZlbmNl
LmNiX2xpc3QpOwo+ICsJcnEtPmZlbmNlLmxvY2sgPSAmcnEtPmxvY2s7Cj4gKwlycS0+ZmVuY2Uu
b3BzID0gJmk5MTVfZmVuY2Vfb3BzOwo+ICsKPiAgIAlpOTE1X3NjaGVkX25vZGVfaW5pdCgmcnEt
PnNjaGVkKTsKPiAgIAo+ICAgCS8qIG1hcmsgdGhpcyByZXF1ZXN0IGFzIHBlcm1hbmVudGx5IGlu
Y29tcGxldGUgKi8KPiBAQCAtMTA3OSw4ICsxMDgzLDggQEAgc3RhdGljIGludCBsaXZlX3N1cHBy
ZXNzX3dhaXRfcHJlZW1wdCh2b2lkICphcmcpCj4gICAJCQkJfQo+ICAgCj4gICAJCQkJLyogRGlz
YWJsZSBORVdDTElFTlQgcHJvbW90aW9uICovCj4gLQkJCQlfX2k5MTVfYWN0aXZlX3JlcXVlc3Rf
c2V0KCZycVtpXS0+dGltZWxpbmUtPmxhc3RfcmVxdWVzdCwKPiAtCQkJCQkJCSAgZHVtbXkpOwo+
ICsJCQkJX19pOTE1X2FjdGl2ZV9mZW5jZV9zZXQoJnJxW2ldLT50aW1lbGluZS0+bGFzdF9yZXF1
ZXN0LAo+ICsJCQkJCQkJJmR1bW15LT5mZW5jZSk7Cj4gICAJCQkJaTkxNV9yZXF1ZXN0X2FkZChy
cVtpXSk7Cj4gICAJCQl9Cj4gICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Qvc2VsZnRlc3RzL21vY2tfdGltZWxpbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0cy9tb2NrX3RpbWVsaW5lLmMKPiBpbmRleCA1OTgxNzBlZmNhZjYuLjJhNzdjMDUxZjM2
YSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdHMvbW9ja190
aW1lbGluZS5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RzL21vY2tf
dGltZWxpbmUuYwo+IEBAIC0xNSw3ICsxNSw3IEBAIHZvaWQgbW9ja190aW1lbGluZV9pbml0KHN0
cnVjdCBpbnRlbF90aW1lbGluZSAqdGltZWxpbmUsIHU2NCBjb250ZXh0KQo+ICAgCj4gICAJbXV0
ZXhfaW5pdCgmdGltZWxpbmUtPm11dGV4KTsKPiAgIAo+IC0JSU5JVF9BQ1RJVkVfUkVRVUVTVCgm
dGltZWxpbmUtPmxhc3RfcmVxdWVzdCwgJnRpbWVsaW5lLT5tdXRleCk7Cj4gKwlJTklUX0FDVElW
RV9GRU5DRSgmdGltZWxpbmUtPmxhc3RfcmVxdWVzdCwgJnRpbWVsaW5lLT5tdXRleCk7Cj4gICAJ
SU5JVF9MSVNUX0hFQUQoJnRpbWVsaW5lLT5yZXF1ZXN0cyk7Cj4gICAKPiAgIAlpOTE1X3N5bmNt
YXBfaW5pdCgmdGltZWxpbmUtPnN5bmMpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvc2NoZWR1bGVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVy
LmMKPiBpbmRleCA4OTQwZmE4ZDM5MWEuLjZiZWI3NTNiMWVhMSAxMDA2NDQKPiAtLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvc2NoZWR1bGVyLmMKPiBAQCAtMzg1LDExICszODUsOCBAQCBpbnRlbF9ndnRfd29y
a2xvYWRfcmVxX2FsbG9jKHN0cnVjdCBpbnRlbF92Z3B1X3dvcmtsb2FkICp3b3JrbG9hZCkKPiAg
IHsKPiAgIAlzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSA9IHdvcmtsb2FkLT52Z3B1Owo+ICAgCXN0
cnVjdCBpbnRlbF92Z3B1X3N1Ym1pc3Npb24gKnMgPSAmdmdwdS0+c3VibWlzc2lvbjsKPiAtCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZncHUtPmd2dC0+ZGV2X3ByaXY7Cj4g
ICAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Cj4gICAKPiAtCWxvY2tkZXBfYXNzZXJ0X2hlbGQo
JmRldl9wcml2LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCj4gICAJaWYgKHdvcmtsb2FkLT5yZXEp
Cj4gICAJCXJldHVybiAwOwo+ICAgCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfYWN0aXZlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jCj4gaW5k
ZXggZjgyZDZkOTMxODI0Li4yZTJhYjgxNzY2MjAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9hY3RpdmUuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
YWN0aXZlLmMKPiBAQCAtMTIsOCArMTIsNiBAQAo+ICAgI2luY2x1ZGUgImk5MTVfYWN0aXZlLmgi
Cj4gICAjaW5jbHVkZSAiaTkxNV9nbG9iYWxzLmgiCj4gICAKPiAtI2RlZmluZSBCS0wocmVmKSAo
JihyZWYpLT5pOTE1LT5kcm0uc3RydWN0X211dGV4KQo+IC0KPiAgIC8qCj4gICAgKiBBY3RpdmUg
cmVmcyBtZW1vcnkgbWFuYWdlbWVudAo+ICAgICoKPiBAQCAtMjcsMzUgKzI1LDM1IEBAIHN0YXRp
YyBzdHJ1Y3QgaTkxNV9nbG9iYWxfYWN0aXZlIHsKPiAgIH0gZ2xvYmFsOwo+ICAgCj4gICBzdHJ1
Y3QgYWN0aXZlX25vZGUgewo+IC0Jc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgYmFzZTsKPiAr
CXN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSBiYXNlOwo+ICAgCXN0cnVjdCBpOTE1X2FjdGl2ZSAq
cmVmOwo+ICAgCXN0cnVjdCByYl9ub2RlIG5vZGU7Cj4gICAJdTY0IHRpbWVsaW5lOwo+ICAgfTsK
PiAgIAo+ICAgc3RhdGljIGlubGluZSBzdHJ1Y3QgYWN0aXZlX25vZGUgKgo+IC1ub2RlX2Zyb21f
YWN0aXZlKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUpCj4gK25vZGVfZnJvbV9h
Y3RpdmUoc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUpCj4gICB7Cj4gICAJcmV0dXJu
IGNvbnRhaW5lcl9vZihhY3RpdmUsIHN0cnVjdCBhY3RpdmVfbm9kZSwgYmFzZSk7Cj4gICB9Cj4g
ICAKPiAgICNkZWZpbmUgdGFrZV9wcmVhbGxvY2F0ZWRfYmFycmllcnMoeCkgbGxpc3RfZGVsX2Fs
bCgmKHgpLT5wcmVhbGxvY2F0ZWRfYmFycmllcnMpCj4gICAKPiAtc3RhdGljIGlubGluZSBib29s
IGlzX2JhcnJpZXIoY29uc3Qgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSkKPiAr
c3RhdGljIGlubGluZSBib29sIGlzX2JhcnJpZXIoY29uc3Qgc3RydWN0IGk5MTVfYWN0aXZlX2Zl
bmNlICphY3RpdmUpCj4gICB7Cj4gLQlyZXR1cm4gSVNfRVJSKHJjdV9hY2Nlc3NfcG9pbnRlcihh
Y3RpdmUtPnJlcXVlc3QpKTsKPiArCXJldHVybiBJU19FUlIocmN1X2FjY2Vzc19wb2ludGVyKGFj
dGl2ZS0+ZmVuY2UpKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGlubGluZSBzdHJ1Y3QgbGxpc3Rf
bm9kZSAqYmFycmllcl90b19sbChzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGUpCj4gICB7Cj4gICAJ
R0VNX0JVR19PTighaXNfYmFycmllcigmbm9kZS0+YmFzZSkpOwo+IC0JcmV0dXJuIChzdHJ1Y3Qg
bGxpc3Rfbm9kZSAqKSZub2RlLT5iYXNlLmxpbms7Cj4gKwlyZXR1cm4gKHN0cnVjdCBsbGlzdF9u
b2RlICopJm5vZGUtPmJhc2UuY2Iubm9kZTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGlubGluZSBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICoKPiAgIF9fYmFycmllcl90b19lbmdpbmUoc3RydWN0IGFj
dGl2ZV9ub2RlICpub2RlKQo+ICAgewo+IC0JcmV0dXJuIChzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICopUkVBRF9PTkNFKG5vZGUtPmJhc2UubGluay5wcmV2KTsKPiArCXJldHVybiAoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqKVJFQURfT05DRShub2RlLT5iYXNlLmNiLm5vZGUucHJldik7Cj4gICB9
Cj4gICAKPiAgIHN0YXRpYyBpbmxpbmUgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqCj4gQEAgLTY4
LDcgKzY2LDcgQEAgYmFycmllcl90b19lbmdpbmUoc3RydWN0IGFjdGl2ZV9ub2RlICpub2RlKQo+
ICAgc3RhdGljIGlubGluZSBzdHJ1Y3QgYWN0aXZlX25vZGUgKmJhcnJpZXJfZnJvbV9sbChzdHJ1
Y3QgbGxpc3Rfbm9kZSAqeCkKPiAgIHsKPiAgIAlyZXR1cm4gY29udGFpbmVyX29mKChzdHJ1Y3Qg
bGlzdF9oZWFkICopeCwKPiAtCQkJICAgIHN0cnVjdCBhY3RpdmVfbm9kZSwgYmFzZS5saW5rKTsK
PiArCQkJICAgIHN0cnVjdCBhY3RpdmVfbm9kZSwgYmFzZS5jYi5ub2RlKTsKPiAgIH0KPiAgIAo+
ICAgI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkgJiYgSVNfRU5BQkxF
RChDT05GSUdfREVCVUdfT0JKRUNUUykKPiBAQCAtMTQ3LDE1ICsxNDUsMTggQEAgX19hY3RpdmVf
cmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICAgCWlmICghcmV0aXJlKQo+ICAgCQly
ZXR1cm47Cj4gICAKPiAtCUdFTV9CVUdfT04ocmN1X2FjY2Vzc19wb2ludGVyKHJlZi0+ZXhjbCkp
Owo+ICsJR0VNX0JVR19PTihyY3VfYWNjZXNzX3BvaW50ZXIocmVmLT5leGNsLmZlbmNlKSk7Cj4g
ICAJcmJ0cmVlX3Bvc3RvcmRlcl9mb3JfZWFjaF9lbnRyeV9zYWZlKGl0LCBuLCAmcm9vdCwgbm9k
ZSkgewo+IC0JCUdFTV9CVUdfT04oaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldCgmaXQtPmJhc2Up
KTsKPiArCQlHRU1fQlVHX09OKGk5MTVfYWN0aXZlX2ZlbmNlX2lzc2V0KCZpdC0+YmFzZSkpOwo+
ICAgCQlrbWVtX2NhY2hlX2ZyZWUoZ2xvYmFsLnNsYWJfY2FjaGUsIGl0KTsKPiAgIAl9Cj4gICAK
PiAgIAkvKiBBZnRlciB0aGUgZmluYWwgcmV0aXJlLCB0aGUgZW50aXJlIHN0cnVjdCBtYXkgYmUg
ZnJlZWQgKi8KPiAgIAlpZiAocmVmLT5yZXRpcmUpCj4gICAJCXJlZi0+cmV0aXJlKHJlZik7Cj4g
Kwo+ICsJLyogLi4uIGV4Y2VwdCBpZiB5b3Ugd2FpdCBvbiBpdCwgeW91IG11c3QgbWFuYWdlIHlv
dXIgb3duIHJlZmVyZW5jZXMhICovCj4gKwl3YWtlX3VwX3ZhcihyZWYpOwo+ICAgfQo+ICAgCj4g
ICBzdGF0aWMgdm9pZAo+IEBAIC0xODksMTIgKzE5MCwyMCBAQCBhY3RpdmVfcmV0aXJlKHN0cnVj
dCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICAgfQo+ICAgCj4gICBzdGF0aWMgdm9pZAo+IC1ub2RlX3Jl
dGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYmFzZSwgc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnEpCj4gK25vZGVfcmV0aXJlKHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlLCBzdHJ1Y3QgZG1h
X2ZlbmNlX2NiICpjYikKPiAgIHsKPiAtCWFjdGl2ZV9yZXRpcmUobm9kZV9mcm9tX2FjdGl2ZShi
YXNlKS0+cmVmKTsKPiArCWk5MTVfYWN0aXZlX2ZlbmNlX2NiKGZlbmNlLCBjYik7Cj4gKwlhY3Rp
dmVfcmV0aXJlKGNvbnRhaW5lcl9vZihjYiwgc3RydWN0IGFjdGl2ZV9ub2RlLCBiYXNlLmNiKS0+
cmVmKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKgo+
ICtzdGF0aWMgdm9pZAo+ICtleGNsX3JldGlyZShzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwgc3Ry
dWN0IGRtYV9mZW5jZV9jYiAqY2IpCj4gK3sKPiArCWk5MTVfYWN0aXZlX2ZlbmNlX2NiKGZlbmNl
LCBjYik7Cj4gKwlhY3RpdmVfcmV0aXJlKGNvbnRhaW5lcl9vZihjYiwgc3RydWN0IGk5MTVfYWN0
aXZlLCBleGNsLmNiKSk7Cj4gK30KPiArCj4gK3N0YXRpYyBzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVu
Y2UgKgo+ICAgYWN0aXZlX2luc3RhbmNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBzdHJ1Y3Qg
aW50ZWxfdGltZWxpbmUgKnRsKQo+ICAgewo+ICAgCXN0cnVjdCBhY3RpdmVfbm9kZSAqbm9kZSwg
KnByZWFsbG9jOwo+IEBAIC0yMzgsNyArMjQ3LDcgQEAgYWN0aXZlX2luc3RhbmNlKHN0cnVjdCBp
OTE1X2FjdGl2ZSAqcmVmLCBzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsKQo+ICAgCX0KPiAgIAo+
ICAgCW5vZGUgPSBwcmVhbGxvYzsKPiAtCWk5MTVfYWN0aXZlX3JlcXVlc3RfaW5pdCgmbm9kZS0+
YmFzZSwgJnRsLT5tdXRleCwgTlVMTCwgbm9kZV9yZXRpcmUpOwo+ICsJX19pOTE1X2FjdGl2ZV9m
ZW5jZV9pbml0KCZub2RlLT5iYXNlLCAmdGwtPm11dGV4LCBOVUxMLCBub2RlX3JldGlyZSk7Cj4g
ICAJbm9kZS0+cmVmID0gcmVmOwo+ICAgCW5vZGUtPnRpbWVsaW5lID0gaWR4Owo+ICAgCj4gQEAg
LTI1Myw4ICsyNjIsNyBAQCBhY3RpdmVfaW5zdGFuY2Uoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYs
IHN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGwpCj4gICAJcmV0dXJuICZub2RlLT5iYXNlOwo+ICAg
fQo+ICAgCj4gLXZvaWQgX19pOTE1X2FjdGl2ZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAo+IC0JCQlzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiwKPiArdm9pZCBfX2k5MTVfYWN0
aXZlX2luaXQoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCj4gICAJCQlpbnQgKCphY3RpdmUpKHN0
cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKSwKPiAgIAkJCXZvaWQgKCpyZXRpcmUpKHN0cnVjdCBpOTE1
X2FjdGl2ZSAqcmVmKSwKPiAgIAkJCXN0cnVjdCBsb2NrX2NsYXNzX2tleSAqa2V5KQo+IEBAIC0y
NjMsMTkgKzI3MSwxOCBAQCB2b2lkIF9faTkxNV9hY3RpdmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKPiAgIAo+ICAgCWRlYnVnX2FjdGl2ZV9pbml0KHJlZik7Cj4gICAKPiAt
CXJlZi0+aTkxNSA9IGk5MTU7Cj4gICAJcmVmLT5mbGFncyA9IDA7Cj4gICAJcmVmLT5hY3RpdmUg
PSBhY3RpdmU7Cj4gICAJcmVmLT5yZXRpcmUgPSBwdHJfdW5wYWNrX2JpdHMocmV0aXJlLCAmYml0
cywgMik7Cj4gICAJaWYgKGJpdHMgJiBJOTE1X0FDVElWRV9NQVlfU0xFRVApCj4gICAJCXJlZi0+
ZmxhZ3MgfD0gSTkxNV9BQ1RJVkVfUkVUSVJFX1NMRUVQUzsKPiAgIAo+IC0JcmVmLT5leGNsID0g
TlVMTDsKPiAgIAlyZWYtPnRyZWUgPSBSQl9ST09UOwo+ICAgCXJlZi0+Y2FjaGUgPSBOVUxMOwo+
ICAgCWluaXRfbGxpc3RfaGVhZCgmcmVmLT5wcmVhbGxvY2F0ZWRfYmFycmllcnMpOwo+ICAgCWF0
b21pY19zZXQoJnJlZi0+Y291bnQsIDApOwo+ICAgCV9fbXV0ZXhfaW5pdCgmcmVmLT5tdXRleCwg
Imk5MTVfYWN0aXZlIiwga2V5KTsKPiArCV9faTkxNV9hY3RpdmVfZmVuY2VfaW5pdCgmcmVmLT5l
eGNsLCAmcmVmLT5tdXRleCwgTlVMTCwgZXhjbF9yZXRpcmUpOwo+ICAgCUlOSVRfV09SSygmcmVm
LT53b3JrLCBhY3RpdmVfd29yayk7Cj4gICB9Cj4gICAKPiBAQCAtMzI5LDkgKzMzNiw5IEBAIF9f
YWN0aXZlX2RlbF9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBzdHJ1Y3QgYWN0aXZl
X25vZGUgKm5vZGUpCj4gICAKPiAgIGludCBpOTE1X2FjdGl2ZV9yZWYoc3RydWN0IGk5MTVfYWN0
aXZlICpyZWYsCj4gICAJCSAgICBzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsLAo+IC0JCSAgICBz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiArCQkgICAgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2Up
Cj4gICB7Cj4gLQlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlOwo+ICsJc3RydWN0
IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmU7Cj4gICAJaW50IGVycjsKPiAgIAo+ICAgCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJnRsLT5tdXRleCk7Cj4gQEAgLTM1NCw2NSArMzYxLDM4IEBAIGludCBp
OTE1X2FjdGl2ZV9yZWYoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCj4gICAJCSAqIHJlcXVlc3Qg
dGhhdCB3ZSB3YW50IHRvIGVtaXQgb24gdGhlIGtlcm5lbF9jb250ZXh0Lgo+ICAgCQkgKi8KPiAg
IAkJX19hY3RpdmVfZGVsX2JhcnJpZXIocmVmLCBub2RlX2Zyb21fYWN0aXZlKGFjdGl2ZSkpOwo+
IC0JCVJDVV9JTklUX1BPSU5URVIoYWN0aXZlLT5yZXF1ZXN0LCBOVUxMKTsKPiAtCQlJTklUX0xJ
U1RfSEVBRCgmYWN0aXZlLT5saW5rKTsKPiAtCX0gZWxzZSB7Cj4gLQkJaWYgKCFpOTE1X2FjdGl2
ZV9yZXF1ZXN0X2lzc2V0KGFjdGl2ZSkpCj4gLQkJCWF0b21pY19pbmMoJnJlZi0+Y291bnQpOwo+
ICsJCVJDVV9JTklUX1BPSU5URVIoYWN0aXZlLT5mZW5jZSwgTlVMTCk7Cj4gKwkJYXRvbWljX2Rl
YygmcmVmLT5jb3VudCk7Cj4gICAJfQo+IC0JR0VNX0JVR19PTighYXRvbWljX3JlYWQoJnJlZi0+
Y291bnQpKTsKPiAtCV9faTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoYWN0aXZlLCBycSk7Cj4gKwlp
ZiAoIV9faTkxNV9hY3RpdmVfZmVuY2Vfc2V0KGFjdGl2ZSwgZmVuY2UpKQo+ICsJCWF0b21pY19p
bmMoJnJlZi0+Y291bnQpOwo+ICAgCj4gICBvdXQ6Cj4gICAJaTkxNV9hY3RpdmVfcmVsZWFzZShy
ZWYpOwo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gICAKPiAtc3RhdGljIHZvaWQgZXhjbF9jYihz
dHJ1Y3QgZG1hX2ZlbmNlICpmLCBzdHJ1Y3QgZG1hX2ZlbmNlX2NiICpjYikKPiAtewo+IC0Jc3Ry
dWN0IGk5MTVfYWN0aXZlICpyZWYgPSBjb250YWluZXJfb2YoY2IsIHR5cGVvZigqcmVmKSwgZXhj
bF9jYik7Cj4gLQo+IC0JUkNVX0lOSVRfUE9JTlRFUihyZWYtPmV4Y2wsIE5VTEwpOwo+IC0JZG1h
X2ZlbmNlX3B1dChmKTsKPiAtCj4gLQlhY3RpdmVfcmV0aXJlKHJlZik7Cj4gLX0KPiAtCj4gICB2
b2lkIGk5MTVfYWN0aXZlX3NldF9leGNsdXNpdmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsIHN0
cnVjdCBkbWFfZmVuY2UgKmYpCj4gICB7Cj4gICAJR0VNX0JVR19PTihpOTE1X2FjdGl2ZV9pc19p
ZGxlKHJlZikpOwo+ICAgCj4gLQlkbWFfZmVuY2VfZ2V0KGYpOwo+IC0KPiAtCXJjdV9yZWFkX2xv
Y2soKTsKPiAtCWlmIChyY3VfYWNjZXNzX3BvaW50ZXIocmVmLT5leGNsKSkgewo+IC0JCXN0cnVj
dCBkbWFfZmVuY2UgKm9sZDsKPiAtCj4gLQkJb2xkID0gZG1hX2ZlbmNlX2dldF9yY3Vfc2FmZSgm
cmVmLT5leGNsKTsKPiAtCQlpZiAob2xkKSB7Cj4gLQkJCWlmIChkbWFfZmVuY2VfcmVtb3ZlX2Nh
bGxiYWNrKG9sZCwgJnJlZi0+ZXhjbF9jYikpCj4gLQkJCQlhdG9taWNfZGVjKCZyZWYtPmNvdW50
KTsKPiAtCQkJZG1hX2ZlbmNlX3B1dChvbGQpOwo+IC0JCX0KPiAtCX0KPiAtCXJjdV9yZWFkX3Vu
bG9jaygpOwo+IC0KPiAtCWF0b21pY19pbmMoJnJlZi0+Y291bnQpOwo+IC0JcmN1X2Fzc2lnbl9w
b2ludGVyKHJlZi0+ZXhjbCwgZik7Cj4gKwltdXRleF9hY3F1aXJlKCZyZWYtPm11dGV4LmRlcF9t
YXAsIDAsIDAsIF9USElTX0lQXyk7CgpUaGlzIGp1c3QgbG9ja2RlcCBhbm5vdGF0aW9uPyBQcm9i
YWJseSBkZXNlcnZlcyBhIGNvbW1lbnQuCgo+ICsJaWYgKCFfX2k5MTVfYWN0aXZlX2ZlbmNlX3Nl
dCgmcmVmLT5leGNsLCBmKSkKPiArCQlhdG9taWNfaW5jKCZyZWYtPmNvdW50KTsKClJlZmNvdW50
IG1hbmFnZW1lbnQgaXMgbm90IGJldHRlciBkb25lIGZyb20gaW5zaWRlIF9faTkxNV9hY3RpdmVf
ZmVuY2Vfc2V0PwoKPiArCW11dGV4X3JlbGVhc2UoJnJlZi0+bXV0ZXguZGVwX21hcCwgMCwgX1RI
SVNfSVBfKTsKPiArfQo+ICAgCj4gLQlpZiAoZG1hX2ZlbmNlX2FkZF9jYWxsYmFjayhmLCAmcmVm
LT5leGNsX2NiLCBleGNsX2NiKSkgewo+IC0JCVJDVV9JTklUX1BPSU5URVIocmVmLT5leGNsLCBO
VUxMKTsKPiAtCQlhdG9taWNfZGVjKCZyZWYtPmNvdW50KTsKPiAtCQlkbWFfZmVuY2VfcHV0KGYp
Owo+IC0JfQo+ICtib29sIGk5MTVfYWN0aXZlX2FjcXVpcmVfaWZfYnVzeShzdHJ1Y3QgaTkxNV9h
Y3RpdmUgKnJlZikKPiArewo+ICsJZGVidWdfYWN0aXZlX2Fzc2VydChyZWYpOwo+ICsJcmV0dXJu
IGF0b21pY19hZGRfdW5sZXNzKCZyZWYtPmNvdW50LCAxLCAwKTsKPiAgIH0KPiAgIAo+ICAgaW50
IGk5MTVfYWN0aXZlX2FjcXVpcmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICB7Cj4gICAJ
aW50IGVycjsKPiAgIAo+IC0JZGVidWdfYWN0aXZlX2Fzc2VydChyZWYpOwo+IC0JaWYgKGF0b21p
Y19hZGRfdW5sZXNzKCZyZWYtPmNvdW50LCAxLCAwKSkKPiArCWlmIChpOTE1X2FjdGl2ZV9hY3F1
aXJlX2lmX2J1c3kocmVmKSkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAgIAllcnIgPSBtdXRleF9s
b2NrX2ludGVycnVwdGlibGUoJnJlZi0+bXV0ZXgpOwo+IEBAIC00MzcsMTIxICs0MTcsNDkgQEAg
dm9pZCBpOTE1X2FjdGl2ZV9yZWxlYXNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICAgCWFj
dGl2ZV9yZXRpcmUocmVmKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCBfX2FjdGl2ZV91bmdy
YWIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gLXsKPiAtCWNsZWFyX2FuZF93YWtlX3VwX2Jp
dChJOTE1X0FDVElWRV9HUkFCX0JJVCwgJnJlZi0+ZmxhZ3MpOwo+IC19Cj4gLQo+IC1ib29sIGk5
MTVfYWN0aXZlX3RyeWdyYWIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gLXsKPiAtCWRlYnVn
X2FjdGl2ZV9hc3NlcnQocmVmKTsKPiAtCj4gLQlpZiAodGVzdF9hbmRfc2V0X2JpdChJOTE1X0FD
VElWRV9HUkFCX0JJVCwgJnJlZi0+ZmxhZ3MpKQo+IC0JCXJldHVybiBmYWxzZTsKPiAtCj4gLQlp
ZiAoIWF0b21pY19hZGRfdW5sZXNzKCZyZWYtPmNvdW50LCAxLCAwKSkgewo+IC0JCV9fYWN0aXZl
X3VuZ3JhYihyZWYpOwo+IC0JCXJldHVybiBmYWxzZTsKPiAtCX0KPiAtCj4gLQlyZXR1cm4gdHJ1
ZTsKPiAtfQo+IC0KPiAtdm9pZCBpOTE1X2FjdGl2ZV91bmdyYWIoc3RydWN0IGk5MTVfYWN0aXZl
ICpyZWYpCj4gLXsKPiAtCUdFTV9CVUdfT04oIXRlc3RfYml0KEk5MTVfQUNUSVZFX0dSQUJfQklU
LCAmcmVmLT5mbGFncykpOwo+IC0KPiAtCWFjdGl2ZV9yZXRpcmUocmVmKTsKPiAtCV9fYWN0aXZl
X3VuZ3JhYihyZWYpOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGV4Y2xfd2FpdChzdHJ1Y3QgaTkx
NV9hY3RpdmUgKnJlZikKPiAtewo+IC0Jc3RydWN0IGRtYV9mZW5jZSAqb2xkOwo+IC0JaW50IGVy
ciA9IDA7Cj4gLQo+IC0JaWYgKCFyY3VfYWNjZXNzX3BvaW50ZXIocmVmLT5leGNsKSkKPiAtCQly
ZXR1cm4gMDsKPiAtCj4gLQlyY3VfcmVhZF9sb2NrKCk7Cj4gLQlvbGQgPSBkbWFfZmVuY2VfZ2V0
X3JjdV9zYWZlKCZyZWYtPmV4Y2wpOwo+IC0JcmN1X3JlYWRfdW5sb2NrKCk7Cj4gLQlpZiAob2xk
KSB7Cj4gLQkJZXJyID0gZG1hX2ZlbmNlX3dhaXQob2xkLCB0cnVlKTsKPiAtCQlkbWFfZmVuY2Vf
cHV0KG9sZCk7Cj4gLQl9Cj4gLQo+IC0JcmV0dXJuIGVycjsKPiAtfQo+IC0KPiAgIGludCBpOTE1
X2FjdGl2ZV93YWl0KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQo+ICAgewo+ICAgCXN0cnVjdCBh
Y3RpdmVfbm9kZSAqaXQsICpuOwo+IC0JaW50IGVycjsKPiArCWludCBlcnIgPSAwOwo+ICAgCj4g
ICAJbWlnaHRfc2xlZXAoKTsKPiAtCW1pZ2h0X2xvY2soJnJlZi0+bXV0ZXgpOwo+ICAgCj4gLQlp
ZiAoaTkxNV9hY3RpdmVfaXNfaWRsZShyZWYpKQo+ICsJaWYgKCFpOTE1X2FjdGl2ZV9hY3F1aXJl
X2lmX2J1c3kocmVmKSkKPiAgIAkJcmV0dXJuIDA7Cj4gICAKPiAtCWVyciA9IG11dGV4X2xvY2tf
aW50ZXJydXB0aWJsZSgmcmVmLT5tdXRleCk7Cj4gLQlpZiAoZXJyKQo+IC0JCXJldHVybiBlcnI7
Cj4gLQo+IC0JaWYgKCFhdG9taWNfYWRkX3VubGVzcygmcmVmLT5jb3VudCwgMSwgMCkpIHsKPiAt
CQltdXRleF91bmxvY2soJnJlZi0+bXV0ZXgpOwo+IC0JCXJldHVybiAwOwo+IC0JfQo+ICsJLyog
Rmx1c2ggbGF6eSBzaWduYWxzICovCj4gKwlyYnRyZWVfcG9zdG9yZGVyX2Zvcl9lYWNoX2VudHJ5
X3NhZmUoaXQsIG4sICZyZWYtPnRyZWUsIG5vZGUpIHsKPiArCQlzdHJ1Y3QgZG1hX2ZlbmNlICpm
ZW5jZTsKPiAgIAo+IC0JZXJyID0gZXhjbF93YWl0KHJlZik7Cj4gLQlpZiAoZXJyKQo+IC0JCWdv
dG8gb3V0Owo+ICsJCWlmIChpc19iYXJyaWVyKCZpdC0+YmFzZSkpIC8qIHVuY29ubmVjdGVkIGlk
bGUgYmFycmllciAqLwo+ICsJCQljb250aW51ZTsKPiAgIAo+IC0JcmJ0cmVlX3Bvc3RvcmRlcl9m
b3JfZWFjaF9lbnRyeV9zYWZlKGl0LCBuLCAmcmVmLT50cmVlLCBub2RlKSB7Cj4gLQkJaWYgKGlz
X2JhcnJpZXIoJml0LT5iYXNlKSkgeyAvKiB1bmNvbm5lY3RlZCBpZGxlLWJhcnJpZXIgKi8KPiAt
CQkJZXJyID0gLUVCVVNZOwo+IC0JCQlicmVhazsKPiArCQlmZW5jZSA9IGk5MTVfYWN0aXZlX2Zl
bmNlX2dldCgmaXQtPmJhc2UpOwo+ICsJCWlmIChmZW5jZSkgewo+ICsJCQlkbWFfZmVuY2VfZW5h
YmxlX3N3X3NpZ25hbGluZyhmZW5jZSk7Cj4gKwkJCWRtYV9mZW5jZV9wdXQoZmVuY2UpOwo+ICAg
CQl9Cj4gLQo+IC0JCWVyciA9IGk5MTVfYWN0aXZlX3JlcXVlc3RfcmV0aXJlKCZpdC0+YmFzZSwg
QktMKHJlZikpOwo+IC0JCWlmIChlcnIpCj4gLQkJCWJyZWFrOwo+ICAgCX0KPiAtCj4gLW91dDoK
PiAtCV9fYWN0aXZlX3JldGlyZShyZWYpOwo+ICsJLyogQW55IGZlbmNlIGFkZGVkIGFmdGVyIHRo
ZSB3YWl0IGJlZ2lucyB3aWxsIG5vdCBiZSBhdXRvLXNpZ25hbGVkICovCj4gKwlpOTE1X2FjdGl2
ZV9yZWxlYXNlKHJlZik7Cj4gICAJaWYgKGVycikKPiAgIAkJcmV0dXJuIGVycjsKPiAgIAo+IC0J
aWYgKHdhaXRfb25fYml0KCZyZWYtPmZsYWdzLCBJOTE1X0FDVElWRV9HUkFCX0JJVCwgVEFTS19L
SUxMQUJMRSkpCj4gKwlpZiAod2FpdF92YXJfZXZlbnRfaW50ZXJydXB0aWJsZShyZWYsIGk5MTVf
YWN0aXZlX2lzX2lkbGUocmVmKSkpCj4gICAJCXJldHVybiAtRUlOVFI7Cj4gICAKPiAtCWZsdXNo
X3dvcmsoJnJlZi0+d29yayk7Cj4gLQlpZiAoIWk5MTVfYWN0aXZlX2lzX2lkbGUocmVmKSkKPiAt
CQlyZXR1cm4gLUVCVVNZOwo+IC0KPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+IC1pbnQgaTkx
NV9yZXF1ZXN0X2F3YWl0X2FjdGl2ZV9yZXF1ZXN0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAo+
IC0JCQkJICAgICAgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSkKPiAtewo+IC0J
c3RydWN0IGk5MTVfcmVxdWVzdCAqYmFycmllciA9Cj4gLQkJaTkxNV9hY3RpdmVfcmVxdWVzdF9y
YXcoYWN0aXZlLCAmcnEtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+IC0KPiAtCXJldHVybiBi
YXJyaWVyID8gaTkxNV9yZXF1ZXN0X2F3YWl0X2RtYV9mZW5jZShycSwgJmJhcnJpZXItPmZlbmNl
KSA6IDA7Cj4gLX0KPiAtCj4gICBpbnQgaTkxNV9yZXF1ZXN0X2F3YWl0X2FjdGl2ZShzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycSwgc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICB7Cj4gICAJaW50
IGVyciA9IDA7Cj4gICAKPiAtCWlmIChyY3VfYWNjZXNzX3BvaW50ZXIocmVmLT5leGNsKSkgewo+
ICsJaWYgKHJjdV9hY2Nlc3NfcG9pbnRlcihyZWYtPmV4Y2wuZmVuY2UpKSB7Cj4gICAJCXN0cnVj
dCBkbWFfZmVuY2UgKmZlbmNlOwo+ICAgCj4gICAJCXJjdV9yZWFkX2xvY2soKTsKPiAtCQlmZW5j
ZSA9IGRtYV9mZW5jZV9nZXRfcmN1X3NhZmUoJnJlZi0+ZXhjbCk7Cj4gKwkJZmVuY2UgPSBkbWFf
ZmVuY2VfZ2V0X3JjdV9zYWZlKCZyZWYtPmV4Y2wuZmVuY2UpOwo+ICAgCQlyY3VfcmVhZF91bmxv
Y2soKTsKPiAgIAkJaWYgKGZlbmNlKSB7Cj4gICAJCQllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRf
ZG1hX2ZlbmNlKHJxLCBmZW5jZSk7Cj4gQEAgLTU3Nyw3ICs0ODUsNyBAQCB2b2lkIGk5MTVfYWN0
aXZlX2Zpbmkoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICAKPiAgIHN0YXRpYyBpbmxpbmUg
Ym9vbCBpc19pZGxlX2JhcnJpZXIoc3RydWN0IGFjdGl2ZV9ub2RlICpub2RlLCB1NjQgaWR4KQo+
ICAgewo+IC0JcmV0dXJuIG5vZGUtPnRpbWVsaW5lID09IGlkeCAmJiAhaTkxNV9hY3RpdmVfcmVx
dWVzdF9pc3NldCgmbm9kZS0+YmFzZSk7Cj4gKwlyZXR1cm4gbm9kZS0+dGltZWxpbmUgPT0gaWR4
ICYmICFpOTE1X2FjdGl2ZV9mZW5jZV9pc3NldCgmbm9kZS0+YmFzZSk7Cj4gICB9Cj4gICAKPiAg
IHN0YXRpYyBzdHJ1Y3QgYWN0aXZlX25vZGUgKnJldXNlX2lkbGVfYmFycmllcihzdHJ1Y3QgaTkx
NV9hY3RpdmUgKnJlZiwgdTY0IGlkeCkKPiBAQCAtNjk3LDEzICs2MDUsMTMgQEAgaW50IGk5MTVf
YWN0aXZlX2FjcXVpcmVfcHJlYWxsb2NhdGVfYmFycmllcihzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJl
ZiwKPiAgIAkJCW5vZGUtPmJhc2UubG9jayA9Cj4gICAJCQkJJmVuZ2luZS0+a2VybmVsX2NvbnRl
eHQtPnRpbWVsaW5lLT5tdXRleDsKPiAgICNlbmRpZgo+IC0JCQlSQ1VfSU5JVF9QT0lOVEVSKG5v
ZGUtPmJhc2UucmVxdWVzdCwgTlVMTCk7Cj4gLQkJCW5vZGUtPmJhc2UucmV0aXJlID0gbm9kZV9y
ZXRpcmU7Cj4gKwkJCVJDVV9JTklUX1BPSU5URVIobm9kZS0+YmFzZS5mZW5jZSwgTlVMTCk7Cj4g
KwkJCW5vZGUtPmJhc2UuY2IuZnVuYyA9IG5vZGVfcmV0aXJlOwo+ICAgCQkJbm9kZS0+dGltZWxp
bmUgPSBpZHg7Cj4gICAJCQlub2RlLT5yZWYgPSByZWY7Cj4gICAJCX0KPiAgIAo+IC0JCWlmICgh
aTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldCgmbm9kZS0+YmFzZSkpIHsKPiArCQlpZiAoIWk5MTVf
YWN0aXZlX2ZlbmNlX2lzc2V0KCZub2RlLT5iYXNlKSkgewo+ICAgCQkJLyoKPiAgIAkJCSAqIE1h
cmsgdGhpcyBhcyBiZWluZyAqb3VyKiB1bmNvbm5lY3RlZCBwcm90by1ub2RlLgo+ICAgCQkJICoK
PiBAQCAtNzEzLDggKzYyMSw4IEBAIGludCBpOTE1X2FjdGl2ZV9hY3F1aXJlX3ByZWFsbG9jYXRl
X2JhcnJpZXIoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCj4gICAJCQkgKiBhbmQgdGhlbiB3ZSBj
YW4gdXNlIHRoZSByYl9ub2RlIGFuZCBsaXN0IHBvaW50ZXJzCj4gICAJCQkgKiBmb3Igb3VyIHRy
YWNraW5nIG9mIHRoZSBwZW5kaW5nIGJhcnJpZXIuCj4gICAJCQkgKi8KPiAtCQkJUkNVX0lOSVRf
UE9JTlRFUihub2RlLT5iYXNlLnJlcXVlc3QsIEVSUl9QVFIoLUVBR0FJTikpOwo+IC0JCQlub2Rl
LT5iYXNlLmxpbmsucHJldiA9ICh2b2lkICopZW5naW5lOwo+ICsJCQlSQ1VfSU5JVF9QT0lOVEVS
KG5vZGUtPmJhc2UuZmVuY2UsIEVSUl9QVFIoLUVBR0FJTikpOwo+ICsJCQlub2RlLT5iYXNlLmNi
Lm5vZGUucHJldiA9ICh2b2lkICopZW5naW5lOwo+ICAgCQkJYXRvbWljX2luYygmcmVmLT5jb3Vu
dCk7Cj4gICAJCX0KPiAgIAo+IEBAIC03ODEsMjUgKzY4OSw2NSBAQCB2b2lkIGk5MTVfcmVxdWVz
dF9hZGRfYWN0aXZlX2JhcnJpZXJzKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQo+ICAgewo+ICAg
CXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSA9IHJxLT5lbmdpbmU7Cj4gICAJc3RydWN0
IGxsaXN0X25vZGUgKm5vZGUsICpuZXh0Owo+ICsJdW5zaWduZWQgbG9uZyBmbGFnczsKPiAgIAo+
ICAgCUdFTV9CVUdfT04oaW50ZWxfZW5naW5lX2lzX3ZpcnR1YWwoZW5naW5lKSk7Cj4gICAJR0VN
X0JVR19PTihycS0+dGltZWxpbmUgIT0gZW5naW5lLT5rZXJuZWxfY29udGV4dC0+dGltZWxpbmUp
Owo+ICAgCj4gKwlub2RlID0gbGxpc3RfZGVsX2FsbCgmZW5naW5lLT5iYXJyaWVyX3Rhc2tzKTsK
PiArCWlmICghbm9kZSkKPiArCQlyZXR1cm47Cj4gICAJLyoKPiAgIAkgKiBBdHRhY2ggdGhlIGxp
c3Qgb2YgcHJvdG8tZmVuY2VzIHRvIHRoZSBpbi1mbGlnaHQgcmVxdWVzdCBzdWNoCj4gICAJICog
dGhhdCB0aGUgcGFyZW50IGk5MTVfYWN0aXZlIHdpbGwgYmUgcmVsZWFzZWQgd2hlbiB0aGlzIHJl
cXVlc3QKPiAgIAkgKiBpcyByZXRpcmVkLgo+ICAgCSAqLwo+IC0JbGxpc3RfZm9yX2VhY2hfc2Fm
ZShub2RlLCBuZXh0LCBsbGlzdF9kZWxfYWxsKCZlbmdpbmUtPmJhcnJpZXJfdGFza3MpKSB7Cj4g
LQkJUkNVX0lOSVRfUE9JTlRFUihiYXJyaWVyX2Zyb21fbGwobm9kZSktPmJhc2UucmVxdWVzdCwg
cnEpOwo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJnJxLT5sb2NrLCBmbGFncyk7Cj4gKwlsbGlzdF9m
b3JfZWFjaF9zYWZlKG5vZGUsIG5leHQsIG5vZGUpIHsKPiArCQlSQ1VfSU5JVF9QT0lOVEVSKGJh
cnJpZXJfZnJvbV9sbChub2RlKS0+YmFzZS5mZW5jZSwgJnJxLT5mZW5jZSk7Cj4gICAJCXNtcF93
bWIoKTsgLyogc2VyaWFsaXNlIHdpdGggcmV1c2VfaWRsZV9iYXJyaWVyICovCj4gLQkJbGlzdF9h
ZGRfdGFpbCgoc3RydWN0IGxpc3RfaGVhZCAqKW5vZGUsICZycS0+YWN0aXZlX2xpc3QpOwo+ICsJ
CWxpc3RfYWRkX3RhaWwoKHN0cnVjdCBsaXN0X2hlYWQgKilub2RlLCAmcnEtPmZlbmNlLmNiX2xp
c3QpOwo+ICsJfQo+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmcnEtPmxvY2ssIGZsYWdzKTsK
PiArfQo+ICsKPiArI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkKPiAr
I2RlZmluZSBhY3RpdmVfaXNfaGVsZChhY3RpdmUpIGxvY2tkZXBfaXNfaGVsZCgoYWN0aXZlKS0+
bG9jaykKPiArI2Vsc2UKPiArI2RlZmluZSBhY3RpdmVfaXNfaGVsZChhY3RpdmUpIHRydWUKPiAr
I2VuZGlmCj4gKwo+ICtzdHJ1Y3QgZG1hX2ZlbmNlICoKPiArX19pOTE1X2FjdGl2ZV9mZW5jZV9z
ZXQoc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUsCj4gKwkJCXN0cnVjdCBkbWFfZmVu
Y2UgKmZlbmNlKQo+ICt7Cj4gKwlzdHJ1Y3QgZG1hX2ZlbmNlICpwcmV2Owo+ICsJdW5zaWduZWQg
bG9uZyBmbGFnczsKPiArCj4gKwkvKiBOQjogdXBkYXRlcyBtdXN0IGJlIHNlcmlhbGlzZWQgYnkg
YW4gb3V0ZXIgdGltZWxpbmUgbXV0ZXggKi8KPiArCXNwaW5fbG9ja19pcnFzYXZlKGZlbmNlLT5s
b2NrLCBmbGFncyk7Cj4gKwlHRU1fQlVHX09OKHRlc3RfYml0KERNQV9GRU5DRV9GTEFHX1NJR05B
TEVEX0JJVCwgJmZlbmNlLT5mbGFncykpOwo+ICsKPiArCXByZXYgPSByY3VfZGVyZWZlcmVuY2Vf
cHJvdGVjdGVkKGFjdGl2ZS0+ZmVuY2UsIGFjdGl2ZV9pc19oZWxkKGFjdGl2ZSkpOwo+ICsJaWYg
KHByZXYpIHsKPiArCQlzcGluX2xvY2tfbmVzdGVkKHByZXYtPmxvY2ssIFNJTkdMRV9ERVBUSF9O
RVNUSU5HKTsKPiArCQlfX2xpc3RfZGVsX2VudHJ5KCZhY3RpdmUtPmNiLm5vZGUpOwo+ICsJCXNw
aW5fdW5sb2NrKHByZXYtPmxvY2spOyAvKiBzZXJpYWxpc2Ugd2l0aCBwcmV2LT5jYl9saXN0ICov
Cj4gKwkJcHJldiA9IHJjdV9hY2Nlc3NfcG9pbnRlcihhY3RpdmUtPmZlbmNlKTsKCldoeSBpdCBp
cyBpbXBvcnRhbnQgdG8gcmUtcmVhZCBhY3RpdmUtPmZlbmNlIGFuZCBkb2VzIGl0IHRoZW4gbmVl
ZCBhIApjb21tZW50PwoKSG93IGRvZXMgaXQgdGllIHdpdGggaTkxNV9hY3RpdmUtPmNvdW50IHJl
ZmNvdW50aW5nIHdoaWNoIGlzIGRvbmUgb24gdGhlIApiYXNpcyBvZiByZXR1cm4gdmFsdWUgZnJv
bSB0aGlzIGZ1bmN0aW9uPwoKPiAgIAl9Cj4gKwo+ICsJcmN1X2Fzc2lnbl9wb2ludGVyKGFjdGl2
ZS0+ZmVuY2UsIGZlbmNlKTsKPiArCWxpc3RfYWRkX3RhaWwoJmFjdGl2ZS0+Y2Iubm9kZSwgJmZl
bmNlLT5jYl9saXN0KTsKPiArCj4gKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKGZlbmNlLT5sb2Nr
LCBmbGFncyk7Cj4gKwo+ICsJcmV0dXJuIHByZXY7Cj4gICB9Cj4gICAKPiAtaW50IGk5MTVfYWN0
aXZlX3JlcXVlc3Rfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCj4gLQkJ
CSAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiAraW50IGk5MTVfYWN0aXZlX2ZlbmNlX3Nl
dChzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSwKPiArCQkJICBzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSkKPiAgIHsKPiArCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwo+ICAgCWludCBl
cnI7Cj4gICAKPiAgICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0pCj4g
QEAgLTgwNywxOCArNzU1LDI1IEBAIGludCBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldChzdHJ1Y3Qg
aTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAo+ICAgI2VuZGlmCj4gICAKPiAgIAkvKiBNdXN0
IG1haW50YWluIG9yZGVyaW5nIHdydCBwcmV2aW91cyBhY3RpdmUgcmVxdWVzdHMgKi8KPiAtCWVy
ciA9IGk5MTVfcmVxdWVzdF9hd2FpdF9hY3RpdmVfcmVxdWVzdChycSwgYWN0aXZlKTsKPiAtCWlm
IChlcnIpCj4gLQkJcmV0dXJuIGVycjsKPiArCXJjdV9yZWFkX2xvY2soKTsKPiArCWZlbmNlID0g
X19pOTE1X2FjdGl2ZV9mZW5jZV9zZXQoYWN0aXZlLCAmcnEtPmZlbmNlKTsKPiArCWlmIChmZW5j
ZSkKPiArCQlmZW5jZSA9IGRtYV9mZW5jZV9nZXRfcmN1KGZlbmNlKTsgPiArCXJjdV9yZWFkX3Vu
bG9jaygpOwo+ICsKPiArCWlmIChmZW5jZSkgewo+ICsJCWVyciA9IGk5MTVfcmVxdWVzdF9hd2Fp
dF9kbWFfZmVuY2UocnEsIGZlbmNlKTsKPiArCQlkbWFfZmVuY2VfcHV0KGZlbmNlKTsKPiArCQlp
ZiAoZXJyKQo+ICsJCQlyZXR1cm4gZXJyOwo+ICsJfQo+ICAgCj4gLQlfX2k5MTVfYWN0aXZlX3Jl
cXVlc3Rfc2V0KGFjdGl2ZSwgcnEpOwo+ICAgCXJldHVybiAwOwo+ICAgfQo+ICAgCj4gLXZvaWQg
aTkxNV9hY3RpdmVfcmV0aXJlX25vb3Aoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2
ZSwKPiAtCQkJICAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0KQo+ICt2b2lkIGk5MTVf
YWN0aXZlX25vb3Aoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UsIHN0cnVjdCBkbWFfZmVuY2VfY2Ig
KmNiKQo+ICAgewo+IC0JLyogU3BhY2UgbGVmdCBpbnRlbnRpb25hbGx5IGJsYW5rICovCj4gKwlp
OTE1X2FjdGl2ZV9mZW5jZV9jYihmZW5jZSwgY2IpOwo+ICAgfQo+ICAgCj4gICAjaWYgSVNfRU5B
QkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1QpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfYWN0aXZlLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2
ZS5oCj4gaW5kZXggYWYzZDUzNmUyNmZkLi5lMTkxMmQ1MzkwMTQgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfYWN0aXZlLmgKPiBAQCAtMTAsNyArMTAsMTAgQEAKPiAgICNpbmNsdWRlIDxsaW51
eC9sb2NrZGVwLmg+Cj4gICAKPiAgICNpbmNsdWRlICJpOTE1X2FjdGl2ZV90eXBlcy5oIgo+IC0j
aW5jbHVkZSAiaTkxNV9yZXF1ZXN0LmgiCj4gKwo+ICtzdHJ1Y3QgaTkxNV9yZXF1ZXN0Owo+ICtz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzOwo+ICtzdHJ1Y3QgaW50ZWxfdGltZWxpbmU7Cj4gICAKPiAg
IC8qCj4gICAgKiBXZSB0cmVhdCByZXF1ZXN0cyBhcyBmZW5jZXMuIFRoaXMgaXMgbm90IGJlIHRv
IGNvbmZ1c2VkIHdpdGggb3VyCj4gQEAgLTI4LDMwOCArMzEsMTA4IEBACj4gICAgKiB3cml0ZSBh
Y2Nlc3Mgc28gdGhhdCB3ZSBjYW4gcGVyZm9ybSBjb25jdXJyZW50IHJlYWQgb3BlcmF0aW9ucyBi
ZXR3ZWVuCj4gICAgKiB0aGUgQ1BVIGFuZCBHUFUgZW5naW5lcywgYXMgd2VsbCBhcyB3YWl0aW5n
IGZvciBhbGwgcmVuZGVyaW5nIHRvCj4gICAgKiBjb21wbGV0ZSwgb3Igd2FpdGluZyBmb3IgdGhl
IGxhc3QgR1BVIHVzZXIgb2YgYSAiZmVuY2UgcmVnaXN0ZXIiLiBUaGUKPiAtICogb2JqZWN0IHRo
ZW4gZW1iZWRzIGEgI2k5MTVfYWN0aXZlX3JlcXVlc3QgdG8gdHJhY2sgdGhlIG1vc3QgcmVjZW50
IChpbgo+ICsgKiBvYmplY3QgdGhlbiBlbWJlZHMgYSAjaTkxNV9hY3RpdmVfZmVuY2UgdG8gdHJh
Y2sgdGhlIG1vc3QgcmVjZW50IChpbgo+ICAgICogcmV0aXJlbWVudCBvcmRlcikgcmVxdWVzdCBy
ZWxldmFudCBmb3IgdGhlIGRlc2lyZWQgbW9kZSBvZiBhY2Nlc3MuCj4gLSAqIFRoZSAjaTkxNV9h
Y3RpdmVfcmVxdWVzdCBpcyB1cGRhdGVkIHdpdGggaTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoKSB0
bwo+ICsgKiBUaGUgI2k5MTVfYWN0aXZlX2ZlbmNlIGlzIHVwZGF0ZWQgd2l0aCBpOTE1X2FjdGl2
ZV9mZW5jZV9zZXQoKSB0bwo+ICAgICogdHJhY2sgdGhlIG1vc3QgcmVjZW50IGZlbmNlIHJlcXVl
c3QsIHR5cGljYWxseSB0aGlzIGlzIGRvbmUgYXMgcGFydCBvZgo+ICAgICogaTkxNV92bWFfbW92
ZV90b19hY3RpdmUoKS4KPiAgICAqCj4gLSAqIFdoZW4gdGhlICNpOTE1X2FjdGl2ZV9yZXF1ZXN0
IGNvbXBsZXRlcyAoaXMgcmV0aXJlZCksIGl0IHdpbGwKPiArICogV2hlbiB0aGUgI2k5MTVfYWN0
aXZlX2ZlbmNlIGNvbXBsZXRlcyAoaXMgcmV0aXJlZCksIGl0IHdpbGwKPiAgICAqIHNpZ25hbCBp
dHMgY29tcGxldGlvbiB0byB0aGUgb3duZXIgdGhyb3VnaCBhIGNhbGxiYWNrIGFzIHdlbGwgYXMg
bWFyawo+IC0gKiBpdHNlbGYgYXMgaWRsZSAoaTkxNV9hY3RpdmVfcmVxdWVzdC5yZXF1ZXN0ID09
IE5VTEwpLiBUaGUgb3duZXIKPiArICogaXRzZWxmIGFzIGlkbGUgKGk5MTVfYWN0aXZlX2ZlbmNl
LnJlcXVlc3QgPT0gTlVMTCkuIFRoZSBvd25lcgo+ICAgICogY2FuIHRoZW4gcGVyZm9ybSBhbnkg
YWN0aW9uLCBzdWNoIGFzIGRlbGF5ZWQgZnJlZWluZyBvZiBhbiBhY3RpdmUKPiAgICAqIHJlc291
cmNlIGluY2x1ZGluZyBpdHNlbGYuCj4gICAgKi8KPiAgIAo+IC12b2lkIGk5MTVfYWN0aXZlX3Jl
dGlyZV9ub29wKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCj4gLQkJCSAgICAg
c3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCk7Cj4gK3ZvaWQgaTkxNV9hY3RpdmVfbm9vcChz
dHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwgc3RydWN0IGRtYV9mZW5jZV9jYiAqY2IpOwo+ICAgCj4g
ICAvKioKPiAtICogaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0IC0gcHJlcGFyZXMgdGhlIGFjdGl2
aXR5IHRyYWNrZXIgZm9yIHVzZQo+ICsgKiBfX2k5MTVfYWN0aXZlX2ZlbmNlX2luaXQgLSBwcmVw
YXJlcyB0aGUgYWN0aXZpdHkgdHJhY2tlciBmb3IgdXNlCj4gICAgKiBAYWN0aXZlIC0gdGhlIGFj
dGl2ZSB0cmFja2VyCj4gLSAqIEBycSAtIGluaXRpYWwgcmVxdWVzdCB0byB0cmFjaywgY2FuIGJl
IE5VTEwKPiArICogQGZlbmNlIC0gaW5pdGlhbCBmZW5jZSB0byB0cmFjaywgY2FuIGJlIE5VTEwK
PiAgICAqIEBmdW5jIC0gYSBjYWxsYmFjayB3aGVuIHRoZW4gdGhlIHRyYWNrZXIgaXMgcmV0aXJl
ZCAoYmVjb21lcyBpZGxlKSwKPiAgICAqICAgICAgICAgY2FuIGJlIE5VTEwKPiAgICAqCj4gLSAq
IGk5MTVfYWN0aXZlX3JlcXVlc3RfaW5pdCgpIHByZXBhcmVzIHRoZSBlbWJlZGRlZCBAYWN0aXZl
IHN0cnVjdCBmb3IgdXNlIGFzCj4gLSAqIGFuIGFjdGl2aXR5IHRyYWNrZXIsIHRoYXQgaXMgZm9y
IHRyYWNraW5nIHRoZSBsYXN0IGtub3duIGFjdGl2ZSByZXF1ZXN0Cj4gLSAqIGFzc29jaWF0ZWQg
d2l0aCBpdC4gV2hlbiB0aGUgbGFzdCByZXF1ZXN0IGJlY29tZXMgaWRsZSwgd2hlbiBpdCBpcyBy
ZXRpcmVkCj4gKyAqIGk5MTVfYWN0aXZlX2ZlbmNlX2luaXQoKSBwcmVwYXJlcyB0aGUgZW1iZWRk
ZWQgQGFjdGl2ZSBzdHJ1Y3QgZm9yIHVzZSBhcwo+ICsgKiBhbiBhY3Rpdml0eSB0cmFja2VyLCB0
aGF0IGlzIGZvciB0cmFja2luZyB0aGUgbGFzdCBrbm93biBhY3RpdmUgZmVuY2UKPiArICogYXNz
b2NpYXRlZCB3aXRoIGl0LiBXaGVuIHRoZSBsYXN0IGZlbmNlIGJlY29tZXMgaWRsZSwgd2hlbiBp
dCBpcyByZXRpcmVkCj4gICAgKiBhZnRlciBjb21wbGV0aW9uLCB0aGUgb3B0aW9uYWwgY2FsbGJh
Y2sgQGZ1bmMgaXMgaW52b2tlZC4KPiAgICAqLwo+ICAgc3RhdGljIGlubGluZSB2b2lkCj4gLWk5
MTVfYWN0aXZlX3JlcXVlc3RfaW5pdChzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZl
LAo+ICtfX2k5MTVfYWN0aXZlX2ZlbmNlX2luaXQoc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICph
Y3RpdmUsCj4gICAJCQkgc3RydWN0IG11dGV4ICpsb2NrLAo+IC0JCQkgc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnEsCj4gLQkJCSBpOTE1X2FjdGl2ZV9yZXRpcmVfZm4gcmV0aXJlKQo+ICsJCQkgdm9p
ZCAqZmVuY2UsCj4gKwkJCSBkbWFfZmVuY2VfZnVuY190IGZuKQo+ICAgewo+IC0JUkNVX0lOSVRf
UE9JTlRFUihhY3RpdmUtPnJlcXVlc3QsIHJxKTsKPiAtCUlOSVRfTElTVF9IRUFEKCZhY3RpdmUt
PmxpbmspOwo+IC0JYWN0aXZlLT5yZXRpcmUgPSByZXRpcmUgPzogaTkxNV9hY3RpdmVfcmV0aXJl
X25vb3A7Cj4gKwlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+ZmVuY2UsIGZlbmNlKTsKPiArCWFj
dGl2ZS0+Y2IuZnVuYyA9IGZuID86IGk5MTVfYWN0aXZlX25vb3A7Cj4gICAjaWYgSVNfRU5BQkxF
RChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKQo+ICAgCWFjdGl2ZS0+bG9jayA9IGxvY2s7Cj4g
ICAjZW5kaWYKPiAgIH0KPiAgIAo+IC0jZGVmaW5lIElOSVRfQUNUSVZFX1JFUVVFU1QobmFtZSwg
bG9jaykgXAo+IC0JaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KChuYW1lKSwgKGxvY2spLCBOVUxM
LCBOVUxMKQo+IC0KPiAtLyoqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0IC0gdXBkYXRl
cyB0aGUgdHJhY2tlciB0byB3YXRjaCB0aGUgY3VycmVudCByZXF1ZXN0Cj4gLSAqIEBhY3RpdmUg
LSB0aGUgYWN0aXZlIHRyYWNrZXIKPiAtICogQHJlcXVlc3QgLSB0aGUgcmVxdWVzdCB0byB3YXRj
aAo+IC0gKgo+IC0gKiBfX2k5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KCkgd2F0Y2hlcyB0aGUgZ2l2
ZW4gQHJlcXVlc3QgZm9yIGNvbXBsZXRpb24uIFdoaWxzdAo+IC0gKiB0aGF0IEByZXF1ZXN0IGlz
IGJ1c3ksIHRoZSBAYWN0aXZlIHJlcG9ydHMgYnVzeS4gV2hlbiB0aGF0IEByZXF1ZXN0IGlzCj4g
LSAqIHJldGlyZWQsIHRoZSBAYWN0aXZlIHRyYWNrZXIgaXMgdXBkYXRlZCB0byByZXBvcnQgaWRs
ZS4KPiAtICovCj4gLXN0YXRpYyBpbmxpbmUgdm9pZAo+IC1fX2k5MTVfYWN0aXZlX3JlcXVlc3Rf
c2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCj4gLQkJCSAgc3RydWN0IGk5
MTVfcmVxdWVzdCAqcmVxdWVzdCkKPiAtewo+IC0jaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5
MTVfREVCVUdfR0VNKQo+IC0JbG9ja2RlcF9hc3NlcnRfaGVsZChhY3RpdmUtPmxvY2spOwo+IC0j
ZW5kaWYKPiAtCWxpc3RfbW92ZSgmYWN0aXZlLT5saW5rLCAmcmVxdWVzdC0+YWN0aXZlX2xpc3Qp
Owo+IC0JcmN1X2Fzc2lnbl9wb2ludGVyKGFjdGl2ZS0+cmVxdWVzdCwgcmVxdWVzdCk7Cj4gLX0K
PiArI2RlZmluZSBJTklUX0FDVElWRV9GRU5DRShBLCBMT0NLKSBcCj4gKwlfX2k5MTVfYWN0aXZl
X2ZlbmNlX2luaXQoKEEpLCAoTE9DSyksIE5VTEwsIE5VTEwpCj4gICAKPiAtaW50IF9fbXVzdF9j
aGVjawo+IC1pOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVz
dCAqYWN0aXZlLAo+IC0JCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSk7Cj4gK3N0cnVjdCBkbWFf
ZmVuY2UgKgo+ICtfX2k5MTVfYWN0aXZlX2ZlbmNlX3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfZmVu
Y2UgKmFjdGl2ZSwKPiArCQkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpOwo+ICAgCj4gICAvKioK
PiAtICogaTkxNV9hY3RpdmVfcmVxdWVzdF9yYXcgLSByZXR1cm4gdGhlIGFjdGl2ZSByZXF1ZXN0
Cj4gKyAqIGk5MTVfYWN0aXZlX2ZlbmNlX3NldCAtIHVwZGF0ZXMgdGhlIHRyYWNrZXIgdG8gd2F0
Y2ggdGhlIGN1cnJlbnQgZmVuY2UKPiAgICAqIEBhY3RpdmUgLSB0aGUgYWN0aXZlIHRyYWNrZXIK
PiArICogQHJxIC0gdGhlIHJlcXVlc3QgdG8gd2F0Y2gKPiAgICAqCj4gLSAqIGk5MTVfYWN0aXZl
X3JlcXVlc3RfcmF3KCkgcmV0dXJucyB0aGUgY3VycmVudCByZXF1ZXN0IGJlaW5nIHRyYWNrZWQs
IG9yIE5VTEwuCj4gLSAqIEl0IGRvZXMgbm90IG9idGFpbiBhIHJlZmVyZW5jZSBvbiB0aGUgcmVx
dWVzdCBmb3IgdGhlIGNhbGxlciwgc28gdGhlIGNhbGxlcgo+IC0gKiBtdXN0IGhvbGQgc3RydWN0
X211dGV4Lgo+ICsgKiBpOTE1X2FjdGl2ZV9mZW5jZV9zZXQoKSB3YXRjaGVzIHRoZSBnaXZlbiBA
cnEgZm9yIGNvbXBsZXRpb24uIFdoaWxlCj4gKyAqIHRoYXQgQHJxIGlzIGJ1c3ksIHRoZSBAYWN0
aXZlIHJlcG9ydHMgYnVzeS4gV2hlbiB0aGF0IEBycSBpcyBzaWduYWxlZAo+ICsgKiAob3IgZWxz
ZSByZXRpcmVkKSB0aGUgQGFjdGl2ZSB0cmFja2VyIGlzIHVwZGF0ZWQgdG8gcmVwb3J0IGlkbGUu
Cj4gICAgKi8KPiAtc3RhdGljIGlubGluZSBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoKPiAtaTkxNV9h
Y3RpdmVfcmVxdWVzdF9yYXcoY29uc3Qgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2
ZSwKPiAtCQkJc3RydWN0IG11dGV4ICptdXRleCkKPiAtewo+IC0JcmV0dXJuIHJjdV9kZXJlZmVy
ZW5jZV9wcm90ZWN0ZWQoYWN0aXZlLT5yZXF1ZXN0LAo+IC0JCQkJCSBsb2NrZGVwX2lzX2hlbGQo
bXV0ZXgpKTsKPiAtfQo+IC0KPiAtLyoqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfcGVlayAt
IHJlcG9ydCB0aGUgYWN0aXZlIHJlcXVlc3QgYmVpbmcgbW9uaXRvcmVkCj4gLSAqIEBhY3RpdmUg
LSB0aGUgYWN0aXZlIHRyYWNrZXIKPiAtICoKPiAtICogaTkxNV9hY3RpdmVfcmVxdWVzdF9wZWVr
KCkgcmV0dXJucyB0aGUgY3VycmVudCByZXF1ZXN0IGJlaW5nIHRyYWNrZWQgaWYKPiAtICogc3Rp
bGwgYWN0aXZlLCBvciBOVUxMLiBJdCBkb2VzIG5vdCBvYnRhaW4gYSByZWZlcmVuY2Ugb24gdGhl
IHJlcXVlc3QKPiAtICogZm9yIHRoZSBjYWxsZXIsIHNvIHRoZSBjYWxsZXIgbXVzdCBob2xkIHN0
cnVjdF9tdXRleC4KPiAtICovCj4gLXN0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVfcmVxdWVzdCAq
Cj4gLWk5MTVfYWN0aXZlX3JlcXVlc3RfcGVlayhjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVx
dWVzdCAqYWN0aXZlLAo+IC0JCQkgc3RydWN0IG11dGV4ICptdXRleCkKPiAtewo+IC0Jc3RydWN0
IGk5MTVfcmVxdWVzdCAqcmVxdWVzdDsKPiAtCj4gLQlyZXF1ZXN0ID0gaTkxNV9hY3RpdmVfcmVx
dWVzdF9yYXcoYWN0aXZlLCBtdXRleCk7Cj4gLQlpZiAoIXJlcXVlc3QgfHwgaTkxNV9yZXF1ZXN0
X2NvbXBsZXRlZChyZXF1ZXN0KSkKPiAtCQlyZXR1cm4gTlVMTDsKPiAtCj4gLQlyZXR1cm4gcmVx
dWVzdDsKPiAtfQo+IC0KPiAtLyoqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0IC0gcmV0
dXJuIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUgcmVxdWVzdAo+IC0gKiBAYWN0aXZlIC0gdGhl
IGFjdGl2ZSB0cmFja2VyCj4gLSAqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0KCkgcmV0
dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIHJlcXVlc3QsIG9yIE5VTEwKPiAtICogaWYg
dGhlIGFjdGl2ZSB0cmFja2VyIGlzIGlkbGUuIFRoZSBjYWxsZXIgbXVzdCBob2xkIHN0cnVjdF9t
dXRleC4KPiAtICovCj4gLXN0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVfcmVxdWVzdCAqCj4gLWk5
MTVfYWN0aXZlX3JlcXVlc3RfZ2V0KGNvbnN0IHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICph
Y3RpdmUsCj4gLQkJCXN0cnVjdCBtdXRleCAqbXV0ZXgpCj4gLXsKPiAtCXJldHVybiBpOTE1X3Jl
cXVlc3RfZ2V0KGk5MTVfYWN0aXZlX3JlcXVlc3RfcGVlayhhY3RpdmUsIG11dGV4KSk7Cj4gLX0K
PiAtCj4gLS8qKgo+IC0gKiBfX2k5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3JjdSAtIHJldHVybiBh
IHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIHJlcXVlc3QKPiAtICogQGFjdGl2ZSAtIHRoZSBhY3Rp
dmUgdHJhY2tlcgo+IC0gKgo+IC0gKiBfX2k5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0KCkgcmV0dXJu
cyBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIHJlcXVlc3QsCj4gLSAqIG9yIE5VTEwgaWYgdGhl
IGFjdGl2ZSB0cmFja2VyIGlzIGlkbGUuIFRoZSBjYWxsZXIgbXVzdCBob2xkIHRoZSBSQ1UgcmVh
ZAo+IC0gKiBsb2NrLCBidXQgdGhlIHJldHVybmVkIHBvaW50ZXIgaXMgc2FmZSB0byB1c2Ugb3V0
c2lkZSBvZiBSQ1UuCj4gLSAqLwo+IC1zdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X3JlcXVlc3Qg
Kgo+IC1fX2k5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3JjdShjb25zdCBzdHJ1Y3QgaTkxNV9hY3Rp
dmVfcmVxdWVzdCAqYWN0aXZlKQo+IC17Cj4gLQkvKgo+IC0JICogUGVyZm9ybWluZyBhIGxvY2ts
ZXNzIHJldHJpZXZhbCBvZiB0aGUgYWN0aXZlIHJlcXVlc3QgaXMgc3VwZXIKPiAtCSAqIHRyaWNr
eS4gU0xBQl9UWVBFU0FGRV9CWV9SQ1UgbWVyZWx5IGd1YXJhbnRlZXMgdGhhdCB0aGUgYmFja2lu
Zwo+IC0JICogc2xhYiBvZiByZXF1ZXN0IG9iamVjdHMgd2lsbCBub3QgYmUgZnJlZWQgd2hpbHN0
IHdlIGhvbGQgdGhlCj4gLQkgKiBSQ1UgcmVhZCBsb2NrLiBJdCBkb2VzIG5vdCBndWFyYW50ZWUg
dGhhdCB0aGUgcmVxdWVzdCBpdHNlbGYKPiAtCSAqIHdpbGwgbm90IGJlIGZyZWVkIGFuZCB0aGVu
ICpyZXVzZWQqLiBWaXosCj4gLQkgKgo+IC0JICogVGhyZWFkIEEJCQlUaHJlYWQgQgo+IC0JICoK
PiAtCSAqIHJxID0gYWN0aXZlLnJlcXVlc3QKPiAtCSAqCQkJCXJldGlyZShycSkgLT4gZnJlZShy
cSk7Cj4gLQkgKgkJCQkocnEgaXMgbm93IGZpcnN0IG9uIHRoZSBzbGFiIGZyZWVsaXN0KQo+IC0J
ICoJCQkJYWN0aXZlLnJlcXVlc3QgPSBOVUxMCj4gLQkgKgo+IC0JICoJCQkJcnEgPSBuZXcgc3Vi
bWlzc2lvbiBvbiBhIG5ldyBvYmplY3QKPiAtCSAqIHJlZihycSkKPiAtCSAqCj4gLQkgKiBUbyBw
cmV2ZW50IHRoZSByZXF1ZXN0IGZyb20gYmVpbmcgcmV1c2VkIHdoaWxzdCB0aGUgY2FsbGVyCj4g
LQkgKiB1c2VzIGl0LCB3ZSB0YWtlIGEgcmVmZXJlbmNlIGxpa2Ugbm9ybWFsLiBXaGlsc3QgYWNx
dWlyaW5nCj4gLQkgKiB0aGUgcmVmZXJlbmNlIHdlIGNoZWNrIHRoYXQgaXQgaXMgbm90IGluIGEg
ZGVzdHJveWVkIHN0YXRlCj4gLQkgKiAocmVmY250ID09IDApLiBUaGF0IHByZXZlbnRzIHRoZSBy
ZXF1ZXN0IGJlaW5nIHJlYWxsb2NhdGVkCj4gLQkgKiB3aGlsc3QgdGhlIGNhbGxlciBob2xkcyBv
biB0byBpdC4gVG8gY2hlY2sgdGhhdCB0aGUgcmVxdWVzdAo+IC0JICogd2FzIG5vdCByZWFsbG9j
YXRlZCBhcyB3ZSBhY3F1aXJlZCB0aGUgcmVmZXJlbmNlIHdlIGhhdmUgdG8KPiAtCSAqIGNoZWNr
IHRoYXQgb3VyIHJlcXVlc3QgcmVtYWlucyB0aGUgYWN0aXZlIHJlcXVlc3QgYWNyb3NzCj4gLQkg
KiB0aGUgbG9va3VwLCBpbiB0aGUgc2FtZSBtYW5uZXIgYXMgYSBzZXFsb2NrLiBUaGUgdmlzaWJp
bGl0eQo+IC0JICogb2YgdGhlIHBvaW50ZXIgdmVyc3VzIHRoZSByZWZlcmVuY2UgY291bnRpbmcg
aXMgY29udHJvbGxlZAo+IC0JICogYnkgdXNpbmcgUkNVIGJhcnJpZXJzIChyY3VfZGVyZWZlcmVu
Y2UgYW5kIHJjdV9hc3NpZ25fcG9pbnRlcikuCj4gLQkgKgo+IC0JICogSW4gdGhlIG1pZGRsZSBv
ZiBhbGwgdGhhdCwgd2UgaW5zcGVjdCB3aGV0aGVyIHRoZSByZXF1ZXN0IGlzCj4gLQkgKiBjb21w
bGV0ZS4gUmV0aXJpbmcgaXMgbGF6eSBzbyB0aGUgcmVxdWVzdCBtYXkgYmUgY29tcGxldGVkIGxv
bmcKPiAtCSAqIGJlZm9yZSB0aGUgYWN0aXZlIHRyYWNrZXIgaXMgdXBkYXRlZC4gUXVlcnlpbmcg
d2hldGhlciB0aGUKPiAtCSAqIHJlcXVlc3QgaXMgY29tcGxldGUgaXMgZmFyIGNoZWFwZXIgKGFz
IGl0IGludm9sdmVzIG5vIGxvY2tlZAo+IC0JICogaW5zdHJ1Y3Rpb25zIHNldHRpbmcgY2FjaGVs
aW5lcyB0byBleGNsdXNpdmUpIHRoYW4gYWNxdWlyaW5nCj4gLQkgKiB0aGUgcmVmZXJlbmNlLCBz
byB3ZSBkbyBpdCBmaXJzdC4gVGhlIFJDVSByZWFkIGxvY2sgZW5zdXJlcyB0aGUKPiAtCSAqIHBv
aW50ZXIgZGVyZWZlcmVuY2UgaXMgdmFsaWQsIGJ1dCBkb2VzIG5vdCBlbnN1cmUgdGhhdCB0aGUK
PiAtCSAqIHNlcW5vIG5vciBIV1MgaXMgdGhlIHJpZ2h0IG9uZSEgSG93ZXZlciwgaWYgdGhlIHJl
cXVlc3Qgd2FzCj4gLQkgKiByZWFsbG9jYXRlZCwgdGhhdCBtZWFucyB0aGUgYWN0aXZlIHRyYWNr
ZXIncyByZXF1ZXN0IHdhcyBjb21wbGV0ZS4KPiAtCSAqIElmIHRoZSBuZXcgcmVxdWVzdCBpcyBh
bHNvIGNvbXBsZXRlLCB0aGVuIGJvdGggYXJlIGFuZCB3ZSBjYW4KPiAtCSAqIGp1c3QgcmVwb3J0
IHRoZSBhY3RpdmUgdHJhY2tlciBpcyBpZGxlLiBJZiB0aGUgbmV3IHJlcXVlc3QgaXMKPiAtCSAq
IGluY29tcGxldGUsIHRoZW4gd2UgYWNxdWlyZSBhIHJlZmVyZW5jZSBvbiBpdCBhbmQgY2hlY2sg
dGhhdAo+IC0JICogaXQgcmVtYWluZWQgdGhlIGFjdGl2ZSByZXF1ZXN0Lgo+IC0JICoKPiAtCSAq
IEl0IGlzIHRoZW4gaW1wZXJhdGl2ZSB0aGF0IHdlIGRvIG5vdCB6ZXJvIHRoZSByZXF1ZXN0IG9u
Cj4gLQkgKiByZWFsbG9jYXRpb24sIHNvIHRoYXQgd2UgY2FuIGNoYXNlIHRoZSBkYW5nbGluZyBw
b2ludGVycyEKPiAtCSAqIFNlZSBpOTE1X3JlcXVlc3RfYWxsb2MoKS4KPiAtCSAqLwo+IC0JZG8g
ewo+IC0JCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3Q7Cj4gLQo+IC0JCXJlcXVlc3QgPSBy
Y3VfZGVyZWZlcmVuY2UoYWN0aXZlLT5yZXF1ZXN0KTsKPiAtCQlpZiAoIXJlcXVlc3QgfHwgaTkx
NV9yZXF1ZXN0X2NvbXBsZXRlZChyZXF1ZXN0KSkKPiAtCQkJcmV0dXJuIE5VTEw7Cj4gLQo+IC0J
CS8qCj4gLQkJICogQW4gZXNwZWNpYWxseSBzaWxseSBjb21waWxlciBjb3VsZCBkZWNpZGUgdG8g
cmVjb21wdXRlIHRoZQo+IC0JCSAqIHJlc3VsdCBvZiBpOTE1X3JlcXVlc3RfY29tcGxldGVkLCBt
b3JlIHNwZWNpZmljYWxseQo+IC0JCSAqIHJlLWVtaXQgdGhlIGxvYWQgZm9yIHJlcXVlc3QtPmZl
bmNlLnNlcW5vLiBBIHJhY2Ugd291bGQgY2F0Y2gKPiAtCQkgKiBhIGxhdGVyIHNlcW5vIHZhbHVl
LCB3aGljaCBjb3VsZCBmbGlwIHRoZSByZXN1bHQgZnJvbSB0cnVlIHRvCj4gLQkJICogZmFsc2Uu
IFdoaWNoIG1lYW5zIHBhcnQgb2YgdGhlIGluc3RydWN0aW9ucyBiZWxvdyBtaWdodCBub3QKPiAt
CQkgKiBiZSBleGVjdXRlZCwgd2hpbGUgbGF0ZXIgb24gaW5zdHJ1Y3Rpb25zIGFyZSBleGVjdXRl
ZC4gRHVlIHRvCj4gLQkJICogYmFycmllcnMgd2l0aGluIHRoZSByZWZjb3VudGluZyB0aGUgaW5j
b25zaXN0ZW5jeSBjYW4ndCByZWFjaAo+IC0JCSAqIHBhc3QgdGhlIGNhbGwgdG8gaTkxNV9yZXF1
ZXN0X2dldF9yY3UsIGJ1dCBub3QgZXhlY3V0aW5nCj4gLQkJICogdGhhdCB3aGlsZSBzdGlsbCBl
eGVjdXRpbmcgaTkxNV9yZXF1ZXN0X3B1dCgpIGNyZWF0ZXMKPiAtCQkgKiBoYXZvYyBlbm91Z2gu
ICBQcmV2ZW50IHRoaXMgd2l0aCBhIGNvbXBpbGVyIGJhcnJpZXIuCj4gLQkJICovCj4gLQkJYmFy
cmllcigpOwo+IC0KPiAtCQlyZXF1ZXN0ID0gaTkxNV9yZXF1ZXN0X2dldF9yY3UocmVxdWVzdCk7
Cj4gLQo+IC0JCS8qCj4gLQkJICogV2hhdCBzdG9wcyB0aGUgZm9sbG93aW5nIHJjdV9hY2Nlc3Nf
cG9pbnRlcigpIGZyb20gb2NjdXJyaW5nCj4gLQkJICogYmVmb3JlIHRoZSBhYm92ZSBpOTE1X3Jl
cXVlc3RfZ2V0X3JjdSgpPyBJZiB3ZSB3ZXJlCj4gLQkJICogdG8gcmVhZCB0aGUgdmFsdWUgYmVm
b3JlIHBhdXNpbmcgdG8gZ2V0IHRoZSByZWZlcmVuY2UgdG8KPiAtCQkgKiB0aGUgcmVxdWVzdCwg
d2UgbWF5IG5vdCBub3RpY2UgYSBjaGFuZ2UgaW4gdGhlIGFjdGl2ZQo+IC0JCSAqIHRyYWNrZXIu
Cj4gLQkJICoKPiAtCQkgKiBUaGUgcmN1X2FjY2Vzc19wb2ludGVyKCkgaXMgYSBtZXJlIGNvbXBp
bGVyIGJhcnJpZXIsIHdoaWNoCj4gLQkJICogbWVhbnMgYm90aCB0aGUgQ1BVIGFuZCBjb21waWxl
ciBhcmUgZnJlZSB0byBwZXJmb3JtIHRoZQo+IC0JCSAqIG1lbW9yeSByZWFkIHdpdGhvdXQgY29u
c3RyYWludC4gVGhlIGNvbXBpbGVyIG9ubHkgaGFzIHRvCj4gLQkJICogZW5zdXJlIHRoYXQgYW55
IG9wZXJhdGlvbnMgYWZ0ZXIgdGhlIHJjdV9hY2Nlc3NfcG9pbnRlcigpCj4gLQkJICogb2NjdXIg
YWZ0ZXJ3YXJkcyBpbiBwcm9ncmFtIG9yZGVyLiBUaGlzIG1lYW5zIHRoZSByZWFkIG1heQo+IC0J
CSAqIGJlIHBlcmZvcm1lZCBlYXJsaWVyIGJ5IGFuIG91dC1vZi1vcmRlciBDUFUsIG9yIGFkdmVu
dHVyb3VzCj4gLQkJICogY29tcGlsZXIuCj4gLQkJICoKPiAtCQkgKiBUaGUgYXRvbWljIG9wZXJh
dGlvbiBhdCB0aGUgaGVhcnQgb2YKPiAtCQkgKiBpOTE1X3JlcXVlc3RfZ2V0X3JjdSgpLCBzZWUg
ZG1hX2ZlbmNlX2dldF9yY3UoKSwgaXMKPiAtCQkgKiBhdG9taWNfaW5jX25vdF96ZXJvKCkgd2hp
Y2ggaXMgb25seSBhIGZ1bGwgbWVtb3J5IGJhcnJpZXIKPiAtCQkgKiB3aGVuIHN1Y2Nlc3NmdWwu
IFRoYXQgaXMsIGlmIGk5MTVfcmVxdWVzdF9nZXRfcmN1KCkKPiAtCQkgKiByZXR1cm5zIHRoZSBy
ZXF1ZXN0IChhbmQgc28gd2l0aCB0aGUgcmVmZXJlbmNlIGNvdW50ZWQKPiAtCQkgKiBpbmNyZW1l
bnRlZCkgdGhlbiB0aGUgZm9sbG93aW5nIHJlYWQgZm9yIHJjdV9hY2Nlc3NfcG9pbnRlcigpCj4g
LQkJICogbXVzdCBvY2N1ciBhZnRlciB0aGUgYXRvbWljIG9wZXJhdGlvbiBhbmQgc28gY29uZmly
bQo+IC0JCSAqIHRoYXQgdGhpcyByZXF1ZXN0IGlzIHRoZSBvbmUgY3VycmVudGx5IGJlaW5nIHRy
YWNrZWQuCj4gLQkJICoKPiAtCQkgKiBUaGUgY29ycmVzcG9uZGluZyB3cml0ZSBiYXJyaWVyIGlz
IHBhcnQgb2YKPiAtCQkgKiByY3VfYXNzaWduX3BvaW50ZXIoKS4KPiAtCQkgKi8KPiAtCQlpZiAo
IXJlcXVlc3QgfHwgcmVxdWVzdCA9PSByY3VfYWNjZXNzX3BvaW50ZXIoYWN0aXZlLT5yZXF1ZXN0
KSkKPiAtCQkJcmV0dXJuIHJjdV9wb2ludGVyX2hhbmRvZmYocmVxdWVzdCk7Cj4gLQo+IC0JCWk5
MTVfcmVxdWVzdF9wdXQocmVxdWVzdCk7Cj4gLQl9IHdoaWxlICgxKTsKPiAtfQo+IC0KPiAraW50
IF9fbXVzdF9jaGVjawo+ICtpOTE1X2FjdGl2ZV9mZW5jZV9zZXQoc3RydWN0IGk5MTVfYWN0aXZl
X2ZlbmNlICphY3RpdmUsCj4gKwkJICAgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpOwo+ICAg
LyoqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfZ2V0X3VubG9ja2VkIC0gcmV0dXJuIGEgcmVm
ZXJlbmNlIHRvIHRoZSBhY3RpdmUgcmVxdWVzdAo+ICsgKiBpOTE1X2FjdGl2ZV9mZW5jZV9nZXQg
LSByZXR1cm4gYSByZWZlcmVuY2UgdG8gdGhlIGFjdGl2ZSBmZW5jZQo+ICAgICogQGFjdGl2ZSAt
IHRoZSBhY3RpdmUgdHJhY2tlcgo+ICAgICoKPiAtICogaTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRf
dW5sb2NrZWQoKSByZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUgcmVxdWVzdCwKPiAr
ICogaTkxNV9hY3RpdmVfZmVuY2VfZ2V0KCkgcmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgYWN0
aXZlIGZlbmNlLAo+ICAgICogb3IgTlVMTCBpZiB0aGUgYWN0aXZlIHRyYWNrZXIgaXMgaWRsZS4g
VGhlIHJlZmVyZW5jZSBpcyBvYnRhaW5lZCB1bmRlciBSQ1UsCj4gICAgKiBzbyBubyBsb2NraW5n
IGlzIHJlcXVpcmVkIGJ5IHRoZSBjYWxsZXIuCj4gICAgKgo+IC0gKiBUaGUgcmVmZXJlbmNlIHNo
b3VsZCBiZSBmcmVlZCB3aXRoIGk5MTVfcmVxdWVzdF9wdXQoKS4KPiArICogVGhlIHJlZmVyZW5j
ZSBzaG91bGQgYmUgZnJlZWQgd2l0aCBkbWFfZmVuY2VfcHV0KCkuCj4gICAgKi8KPiAtc3RhdGlj
IGlubGluZSBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoKPiAtaTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRf
dW5sb2NrZWQoY29uc3Qgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSkKPiArc3Rh
dGljIGlubGluZSBzdHJ1Y3QgZG1hX2ZlbmNlICoKPiAraTkxNV9hY3RpdmVfZmVuY2VfZ2V0KHN0
cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAqYWN0aXZlKQo+ICAgewo+IC0Jc3RydWN0IGk5MTVfcmVx
dWVzdCAqcmVxdWVzdDsKPiArCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwo+ICAgCj4gICAJcmN1
X3JlYWRfbG9jaygpOwo+IC0JcmVxdWVzdCA9IF9faTkxNV9hY3RpdmVfcmVxdWVzdF9nZXRfcmN1
KGFjdGl2ZSk7Cj4gKwlmZW5jZSA9IGRtYV9mZW5jZV9nZXRfcmN1X3NhZmUoJmFjdGl2ZS0+ZmVu
Y2UpOwo+ICAgCXJjdV9yZWFkX3VubG9jaygpOwo+ICAgCj4gLQlyZXR1cm4gcmVxdWVzdDsKPiAr
CXJldHVybiBmZW5jZTsKPiAgIH0KPiAgIAo+ICAgLyoqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVl
c3RfaXNzZXQgLSByZXBvcnQgd2hldGhlciB0aGUgYWN0aXZlIHRyYWNrZXIgaXMgYXNzaWduZWQK
PiArICogaTkxNV9hY3RpdmVfZmVuY2VfaXNzZXQgLSByZXBvcnQgd2hldGhlciB0aGUgYWN0aXZl
IHRyYWNrZXIgaXMgYXNzaWduZWQKPiAgICAqIEBhY3RpdmUgLSB0aGUgYWN0aXZlIHRyYWNrZXIK
PiAgICAqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQoKSByZXR1cm5zIHRydWUgaWYg
dGhlIGFjdGl2ZSB0cmFja2VyIGlzIGN1cnJlbnRseQo+IC0gKiBhc3NpZ25lZCB0byBhIHJlcXVl
c3QuIER1ZSB0byB0aGUgbGF6eSByZXRpcmluZywgdGhhdCByZXF1ZXN0IG1heSBiZSBpZGxlCj4g
KyAqIGk5MTVfYWN0aXZlX2ZlbmNlX2lzc2V0KCkgcmV0dXJucyB0cnVlIGlmIHRoZSBhY3RpdmUg
dHJhY2tlciBpcyBjdXJyZW50bHkKPiArICogYXNzaWduZWQgdG8gYSBmZW5jZS4gRHVlIHRvIHRo
ZSBsYXp5IHJldGlyaW5nLCB0aGF0IGZlbmNlIG1heSBiZSBpZGxlCj4gICAgKiBhbmQgdGhpcyBt
YXkgcmVwb3J0IHN0YWxlIGluZm9ybWF0aW9uLgo+ICAgICovCj4gICBzdGF0aWMgaW5saW5lIGJv
b2wKPiAtaTkxNV9hY3RpdmVfcmVxdWVzdF9pc3NldChjb25zdCBzdHJ1Y3QgaTkxNV9hY3RpdmVf
cmVxdWVzdCAqYWN0aXZlKQo+ICtpOTE1X2FjdGl2ZV9mZW5jZV9pc3NldChjb25zdCBzdHJ1Y3Qg
aTkxNV9hY3RpdmVfZmVuY2UgKmFjdGl2ZSkKPiAgIHsKPiAtCXJldHVybiByY3VfYWNjZXNzX3Bv
aW50ZXIoYWN0aXZlLT5yZXF1ZXN0KTsKPiArCXJldHVybiByY3VfYWNjZXNzX3BvaW50ZXIoYWN0
aXZlLT5mZW5jZSk7Cj4gICB9Cj4gICAKPiAtLyoqCj4gLSAqIGk5MTVfYWN0aXZlX3JlcXVlc3Rf
cmV0aXJlIC0gd2FpdHMgdW50aWwgdGhlIHJlcXVlc3QgaXMgcmV0aXJlZAo+IC0gKiBAYWN0aXZl
IC0gdGhlIGFjdGl2ZSByZXF1ZXN0IG9uIHdoaWNoIHRvIHdhaXQKPiAtICoKPiAtICogaTkxNV9h
Y3RpdmVfcmVxdWVzdF9yZXRpcmUoKSB3YWl0cyB1bnRpbCB0aGUgcmVxdWVzdCBpcyBjb21wbGV0
ZWQsCj4gLSAqIGFuZCB0aGVuIGVuc3VyZXMgdGhhdCBhdCBsZWFzdCB0aGUgcmV0aXJlbWVudCBo
YW5kbGVyIGZvciB0aGlzCj4gLSAqIEBhY3RpdmUgdHJhY2tlciBpcyBjYWxsZWQgYmVmb3JlIHJl
dHVybmluZy4gSWYgdGhlIEBhY3RpdmUKPiAtICogdHJhY2tlciBpcyBpZGxlLCB0aGUgZnVuY3Rp
b24gcmV0dXJucyBpbW1lZGlhdGVseS4KPiAtICovCj4gLXN0YXRpYyBpbmxpbmUgaW50IF9fbXVz
dF9jaGVjawo+IC1pOTE1X2FjdGl2ZV9yZXF1ZXN0X3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmVf
cmVxdWVzdCAqYWN0aXZlLAo+IC0JCQkgICBzdHJ1Y3QgbXV0ZXggKm11dGV4KQo+ICtzdGF0aWMg
aW5saW5lIHZvaWQKPiAraTkxNV9hY3RpdmVfZmVuY2VfY2Ioc3RydWN0IGRtYV9mZW5jZSAqZmVu
Y2UsIHN0cnVjdCBkbWFfZmVuY2VfY2IgKmNiKQo+ICAgewo+IC0Jc3RydWN0IGk5MTVfcmVxdWVz
dCAqcmVxdWVzdDsKPiAtCWxvbmcgcmV0Owo+IC0KPiAtCXJlcXVlc3QgPSBpOTE1X2FjdGl2ZV9y
ZXF1ZXN0X3JhdyhhY3RpdmUsIG11dGV4KTsKPiAtCWlmICghcmVxdWVzdCkKPiAtCQlyZXR1cm4g
MDsKPiAtCj4gLQlyZXQgPSBpOTE1X3JlcXVlc3Rfd2FpdChyZXF1ZXN0LAo+IC0JCQkJSTkxNV9X
QUlUX0lOVEVSUlVQVElCTEUsCj4gLQkJCQlNQVhfU0NIRURVTEVfVElNRU9VVCk7Cj4gLQlpZiAo
cmV0IDwgMCkKPiAtCQlyZXR1cm4gcmV0Owo+ICsJc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICph
Y3RpdmUgPQo+ICsJCWNvbnRhaW5lcl9vZihjYiwgdHlwZW9mKCphY3RpdmUpLCBjYik7Cj4gICAK
PiAtCWxpc3RfZGVsX2luaXQoJmFjdGl2ZS0+bGluayk7Cj4gLQlSQ1VfSU5JVF9QT0lOVEVSKGFj
dGl2ZS0+cmVxdWVzdCwgTlVMTCk7Cj4gLQo+IC0JYWN0aXZlLT5yZXRpcmUoYWN0aXZlLCByZXF1
ZXN0KTsKPiAtCj4gLQlyZXR1cm4gMDsKPiArCVJDVV9JTklUX1BPSU5URVIoYWN0aXZlLT5mZW5j
ZSwgTlVMTCk7Cj4gICB9Cj4gICAKPiAgIC8qCj4gQEAgLTM1OCw0MSArMTYxLDM0IEBAIGk5MTVf
YWN0aXZlX3JlcXVlc3RfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUs
Cj4gICAgKiBzeW5jaHJvbmlzYXRpb24uCj4gICAgKi8KPiAgIAo+IC12b2lkIF9faTkxNV9hY3Rp
dmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAtCQkJc3RydWN0IGk5MTVf
YWN0aXZlICpyZWYsCj4gK3ZvaWQgX19pOTE1X2FjdGl2ZV9pbml0KHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmLAo+ICAgCQkJaW50ICgqYWN0aXZlKShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiksCj4g
ICAJCQl2b2lkICgqcmV0aXJlKShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZiksCj4gICAJCQlzdHJ1
Y3QgbG9ja19jbGFzc19rZXkgKmtleSk7Cj4gLSNkZWZpbmUgaTkxNV9hY3RpdmVfaW5pdChpOTE1
LCByZWYsIGFjdGl2ZSwgcmV0aXJlKSBkbyB7CQlcCj4gKyNkZWZpbmUgaTkxNV9hY3RpdmVfaW5p
dChyZWYsIGFjdGl2ZSwgcmV0aXJlKSBkbyB7CQlcCj4gICAJc3RhdGljIHN0cnVjdCBsb2NrX2Ns
YXNzX2tleSBfX2tleTsJCQkJXAo+ICAgCQkJCQkJCQkJXAo+IC0JX19pOTE1X2FjdGl2ZV9pbml0
KGk5MTUsIHJlZiwgYWN0aXZlLCByZXRpcmUsICZfX2tleSk7CQlcCj4gKwlfX2k5MTVfYWN0aXZl
X2luaXQocmVmLCBhY3RpdmUsIHJldGlyZSwgJl9fa2V5KTsJCVwKPiAgIH0gd2hpbGUgKDApCj4g
ICAKPiAgIGludCBpOTE1X2FjdGl2ZV9yZWYoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsCj4gICAJ
CSAgICBzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsLAo+IC0JCSAgICBzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSk7Cj4gKwkJICAgIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKTsKPiAgIAo+ICAgdm9p
ZCBpOTE1X2FjdGl2ZV9zZXRfZXhjbHVzaXZlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBzdHJ1
Y3QgZG1hX2ZlbmNlICpmKTsKPiAgIAo+ICAgc3RhdGljIGlubGluZSBib29sIGk5MTVfYWN0aXZl
X2hhc19leGNsdXNpdmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICB7Cj4gLQlyZXR1cm4g
cmN1X2FjY2Vzc19wb2ludGVyKHJlZi0+ZXhjbCk7Cj4gKwlyZXR1cm4gcmN1X2FjY2Vzc19wb2lu
dGVyKHJlZi0+ZXhjbC5mZW5jZSk7Cj4gICB9Cj4gICAKPiAgIGludCBpOTE1X2FjdGl2ZV93YWl0
KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKPiAgIAo+IC1pbnQgaTkxNV9yZXF1ZXN0X2F3YWl0
X2FjdGl2ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKPiAtCQkJICAgICAgc3RydWN0IGk5MTVf
YWN0aXZlICpyZWYpOwo+IC1pbnQgaTkxNV9yZXF1ZXN0X2F3YWl0X2FjdGl2ZV9yZXF1ZXN0KHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAo+IC0JCQkJICAgICAgc3RydWN0IGk5MTVfYWN0aXZlX3Jl
cXVlc3QgKmFjdGl2ZSk7Cj4gK2ludCBpOTE1X3JlcXVlc3RfYXdhaXRfYWN0aXZlKHN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxLCBzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7Cj4gICAKPiAgIGludCBp
OTE1X2FjdGl2ZV9hY3F1aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKPiArYm9vbCBpOTE1
X2FjdGl2ZV9hY3F1aXJlX2lmX2J1c3koc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpOwo+ICAgdm9p
ZCBpOTE1X2FjdGl2ZV9yZWxlYXNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKPiAtdm9pZCBf
X2k5MTVfYWN0aXZlX3JlbGVhc2VfbmVzdGVkKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBpbnQg
c3ViY2xhc3MpOwo+IC0KPiAtYm9vbCBpOTE1X2FjdGl2ZV90cnlncmFiKHN0cnVjdCBpOTE1X2Fj
dGl2ZSAqcmVmKTsKPiAtdm9pZCBpOTE1X2FjdGl2ZV91bmdyYWIoc3RydWN0IGk5MTVfYWN0aXZl
ICpyZWYpOwo+ICAgCj4gICBzdGF0aWMgaW5saW5lIGJvb2wKPiAgIGk5MTVfYWN0aXZlX2lzX2lk
bGUoY29uc3Qgc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2FjdGl2ZV90eXBlcy5oCj4gaW5kZXggMDIxMTY3ZjAwMDRkLi5kODlhNzRjMTQyYzYgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMuaAo+ICsr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmgKPiBAQCAtMTcsMTcg
KzE3LDkgQEAKPiAgIAo+ICAgI2luY2x1ZGUgImk5MTVfdXRpbHMuaCIKPiAgIAo+IC1zdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZTsKPiAtc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3Q7Cj4gLXN0cnVj
dCBpOTE1X3JlcXVlc3Q7Cj4gLQo+IC10eXBlZGVmIHZvaWQgKCppOTE1X2FjdGl2ZV9yZXRpcmVf
Zm4pKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICosCj4gLQkJCQkgICAgICBzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICopOwo+IC0KPiAtc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3Qgewo+IC0Jc3Ry
dWN0IGk5MTVfcmVxdWVzdCBfX3JjdSAqcmVxdWVzdDsKPiAtCXN0cnVjdCBsaXN0X2hlYWQgbGlu
azsKPiAtCWk5MTVfYWN0aXZlX3JldGlyZV9mbiByZXRpcmU7Cj4gK3N0cnVjdCBpOTE1X2FjdGl2
ZV9mZW5jZSB7Cj4gKwlzdHJ1Y3QgZG1hX2ZlbmNlIF9fcmN1ICpmZW5jZTsKPiArCXN0cnVjdCBk
bWFfZmVuY2VfY2IgY2I7Cj4gICAjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdf
R0VNKQo+ICAgCS8qCj4gICAJICogSW5jb3Jwb3JlYWwhCj4gQEAgLTUzLDIwICs0NSwxNyBAQCBz
dHJ1Y3QgYWN0aXZlX25vZGU7Cj4gICAjZGVmaW5lIGk5MTVfYWN0aXZlX21heV9zbGVlcChmbikg
cHRyX3BhY2tfYml0cygmKGZuKSwgSTkxNV9BQ1RJVkVfTUFZX1NMRUVQLCAyKQo+ICAgCj4gICBz
dHJ1Y3QgaTkxNV9hY3RpdmUgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTU7Cj4g
KwlhdG9taWNfdCBjb3VudDsKPiArCXN0cnVjdCBtdXRleCBtdXRleDsKPiAgIAo+ICAgCXN0cnVj
dCBhY3RpdmVfbm9kZSAqY2FjaGU7Cj4gICAJc3RydWN0IHJiX3Jvb3QgdHJlZTsKPiAtCXN0cnVj
dCBtdXRleCBtdXRleDsKPiAtCWF0b21pY190IGNvdW50Owo+ICAgCj4gICAJLyogUHJlYWxsb2Nh
dGVkICJleGNsdXNpdmUiIG5vZGUgKi8KPiAtCXN0cnVjdCBkbWFfZmVuY2UgX19yY3UgKmV4Y2w7
Cj4gLQlzdHJ1Y3QgZG1hX2ZlbmNlX2NiIGV4Y2xfY2I7Cj4gKwlzdHJ1Y3QgaTkxNV9hY3RpdmVf
ZmVuY2UgZXhjbDsKPiAgIAo+ICAgCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gICAjZGVmaW5lIEk5
MTVfQUNUSVZFX1JFVElSRV9TTEVFUFMgQklUKDApCj4gLSNkZWZpbmUgSTkxNV9BQ1RJVkVfR1JB
Ql9CSVQgMQo+ICAgCj4gICAJaW50ICgqYWN0aXZlKShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7
Cj4gICAJdm9pZCAoKnJldGlyZSkoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpOwo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9nZW0uYwo+IGluZGV4IDNlZWQyZWZhOGQxMy4uMWFhZGFiMWNkZDI0IDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dlbS5jCj4gQEAgLTkwMCwyOCArOTAwLDM4IEBAIHdhaXRfZm9yX3Rp
bWVsaW5lcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAgIAo+ICAgCXNwaW5fbG9j
a19pcnFzYXZlKCZ0aW1lbGluZXMtPmxvY2ssIGZsYWdzKTsKPiAgIAlsaXN0X2Zvcl9lYWNoX2Vu
dHJ5KHRsLCAmdGltZWxpbmVzLT5hY3RpdmVfbGlzdCwgbGluaykgewo+IC0JCXN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxOwo+ICsJCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOwo+ICAgCj4gLQkJcnEg
PSBpOTE1X2FjdGl2ZV9yZXF1ZXN0X2dldF91bmxvY2tlZCgmdGwtPmxhc3RfcmVxdWVzdCk7Cj4g
LQkJaWYgKCFycSkKPiArCQlmZW5jZSA9IGk5MTVfYWN0aXZlX2ZlbmNlX2dldCgmdGwtPmxhc3Rf
cmVxdWVzdCk7Cj4gKwkJaWYgKCFmZW5jZSkKPiAgIAkJCWNvbnRpbnVlOwo+ICAgCj4gICAJCXNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJnRpbWVsaW5lcy0+bG9jaywgZmxhZ3MpOwo+ICAgCj4gLQkJ
LyoKPiAtCQkgKiAiUmFjZS10by1pZGxlIi4KPiAtCQkgKgo+IC0JCSAqIFN3aXRjaGluZyB0byB0
aGUga2VybmVsIGNvbnRleHQgaXMgb2Z0ZW4gdXNlZCBhIHN5bmNocm9ub3VzCj4gLQkJICogc3Rl
cCBwcmlvciB0byBpZGxpbmcsIGUuZy4gaW4gc3VzcGVuZCBmb3IgZmx1c2hpbmcgYWxsCj4gLQkJ
ICogY3VycmVudCBvcGVyYXRpb25zIHRvIG1lbW9yeSBiZWZvcmUgc2xlZXBpbmcuIFRoZXNlIHdl
Cj4gLQkJICogd2FudCB0byBjb21wbGV0ZSBhcyBxdWlja2x5IGFzIHBvc3NpYmxlIHRvIGF2b2lk
IHByb2xvbmdlZAo+IC0JCSAqIHN0YWxscywgc28gYWxsb3cgdGhlIGdwdSB0byBib29zdCB0byBt
YXhpbXVtIGNsb2Nrcy4KPiAtCQkgKi8KPiAtCQlpZiAod2FpdCAmIEk5MTVfV0FJVF9GT1JfSURM
RV9CT09TVCkKPiAtCQkJZ2VuNl9ycHNfYm9vc3QocnEpOwo+ICsJCWlmICghZG1hX2ZlbmNlX2lz
X2k5MTUoZmVuY2UpKSB7Cj4gKwkJCXRpbWVvdXQgPSBkbWFfZmVuY2Vfd2FpdF90aW1lb3V0KGZl
bmNlLAo+ICsJCQkJCQkJIGZsYWdzICYgSTkxNV9XQUlUX0lOVEVSUlVQVElCTEUsCj4gKwkJCQkJ
CQkgdGltZW91dCk7CgpXZSBkaWQgbm90IGhhdmUgc3VwcG9ydCBmb3Igbm9uLWk5MTUgZmVuY2Vz
IGJlZm9yZSB0aGlzIHBhdGNoIHJpZ2h0PyAKV291bGQgaXQgYmUgYmV0dGVyIHRvIHNwbGl0IHRo
aXMgb3V0IGluIHRoaXMgY2FzZT8KCj4gKwkJfSBlbHNlIHsKPiArCQkJc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnEgPSB0b19yZXF1ZXN0KGZlbmNlKTsKPiArCj4gKwkJCS8qCj4gKwkJCSAqICJSYWNl
LXRvLWlkbGUiLgo+ICsJCQkgKgo+ICsJCQkgKiBTd2l0Y2hpbmcgdG8gdGhlIGtlcm5lbCBjb250
ZXh0IGlzIG9mdGVuIHVzZWQgYXMKPiArCQkJICogYSBzeW5jaHJvbm91cyBzdGVwIHByaW9yIHRv
IGlkbGluZywgZS5nLiBpbiBzdXNwZW5kCj4gKwkJCSAqIGZvciBmbHVzaGluZyBhbGwgY3VycmVu
dCBvcGVyYXRpb25zIHRvIG1lbW9yeSBiZWZvcmUKPiArCQkJICogc2xlZXBpbmcuIFRoZXNlIHdl
IHdhbnQgdG8gY29tcGxldGUgYXMgcXVpY2tseSBhcwo+ICsJCQkgKiBwb3NzaWJsZSB0byBhdm9p
ZCBwcm9sb25nZWQgc3RhbGxzLCBzbyBhbGxvdyB0aGUgZ3B1Cj4gKwkJCSAqIHRvIGJvb3N0IHRv
IG1heGltdW0gY2xvY2tzLgo+ICsJCQkgKi8KPiArCQkJaWYgKGZsYWdzICYgSTkxNV9XQUlUX0ZP
Ul9JRExFX0JPT1NUKQo+ICsJCQkJZ2VuNl9ycHNfYm9vc3QocnEpOwo+ICsKPiArCQkJdGltZW91
dCA9IGk5MTVfcmVxdWVzdF93YWl0KHJxLCBmbGFncywgdGltZW91dCk7Cj4gKwkJfQo+ICAgCj4g
LQkJdGltZW91dCA9IGk5MTVfcmVxdWVzdF93YWl0KHJxLCB3YWl0LCB0aW1lb3V0KTsKPiAtCQlp
OTE1X3JlcXVlc3RfcHV0KHJxKTsKPiArCQlkbWFfZmVuY2VfcHV0KGZlbmNlKTsKPiAgIAkJaWYg
KHRpbWVvdXQgPCAwKQo+ICAgCQkJcmV0dXJuIHRpbWVvdXQ7Cj4gICAKPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbV9ndHQuYwo+IGluZGV4IGIyZTQ4Mjc3ODhmYy4uNjA2NzZkZTA1OWE3IDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCj4gKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKPiBAQCAtMTg1OCw3ICsxODU4LDYgQEAg
c3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3ZtYV9vcHMgcGRfdm1hX29wcyA9IHsKPiAgIAo+ICAg
c3RhdGljIHN0cnVjdCBpOTE1X3ZtYSAqcGRfdm1hX2NyZWF0ZShzdHJ1Y3QgZ2VuNl9wcGd0dCAq
cHBndHQsIGludCBzaXplKQo+ICAgewo+IC0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSBwcGd0dC0+YmFzZS52bS5pOTE1Owo+ICAgCXN0cnVjdCBpOTE1X2dndHQgKmdndHQgPSBwcGd0
dC0+YmFzZS52bS5ndC0+Z2d0dDsKPiAgIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKPiAgIAo+IEBA
IC0xODY5LDcgKzE4NjgsNyBAQCBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpwZF92bWFfY3JlYXRl
KHN0cnVjdCBnZW42X3BwZ3R0ICpwcGd0dCwgaW50IHNpemUpCj4gICAJaWYgKCF2bWEpCj4gICAJ
CXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwo+ICAgCj4gLQlpOTE1X2FjdGl2ZV9pbml0KGk5MTUs
ICZ2bWEtPmFjdGl2ZSwgTlVMTCwgTlVMTCk7Cj4gKwlpOTE1X2FjdGl2ZV9pbml0KCZ2bWEtPmFj
dGl2ZSwgTlVMTCwgTlVMTCk7Cj4gICAKPiAgIAltdXRleF9pbml0KCZ2bWEtPnBhZ2VzX211dGV4
KTsKPiAgIAl2bWEtPnZtID0gaTkxNV92bV9nZXQoJmdndHQtPnZtKTsKPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ3B1X2Vycm9yLmMKPiBpbmRleCAzY2NmN2ZkOTMwN2YuLjJjMDA3MWZmMmQyZCAx
MDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCj4gKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYwo+IEBAIC0xMjkyLDcgKzEy
OTIsNyBAQCBjYXB0dXJlX3ZtYShzdHJ1Y3QgY2FwdHVyZV92bWEgKm5leHQsCj4gICAJaWYgKCFj
KQo+ICAgCQlyZXR1cm4gbmV4dDsKPiAgIAo+IC0JaWYgKCFpOTE1X2FjdGl2ZV90cnlncmFiKCZ2
bWEtPmFjdGl2ZSkpIHsKPiArCWlmICghaTkxNV9hY3RpdmVfYWNxdWlyZV9pZl9idXN5KCZ2bWEt
PmFjdGl2ZSkpIHsKPiAgIAkJa2ZyZWUoYyk7Cj4gICAJCXJldHVybiBuZXh0Owo+ICAgCX0KPiBA
QCAtMTQzMiw3ICsxNDMyLDcgQEAgZ2VtX3JlY29yZF9yaW5ncyhzdHJ1Y3QgaTkxNV9ncHVfc3Rh
dGUgKmVycm9yLCBzdHJ1Y3QgY29tcHJlc3MgKmNvbXByZXNzKQo+ICAgCQkJKnRoaXMtPnNsb3Qg
PQo+ICAgCQkJCWk5MTVfZXJyb3Jfb2JqZWN0X2NyZWF0ZShpOTE1LCB2bWEsIGNvbXByZXNzKTsK
PiAgIAo+IC0JCQlpOTE1X2FjdGl2ZV91bmdyYWIoJnZtYS0+YWN0aXZlKTsKPiArCQkJaTkxNV9h
Y3RpdmVfcmVsZWFzZSgmdm1hLT5hY3RpdmUpOwo+ICAgCQkJaTkxNV92bWFfcHV0KHZtYSk7Cj4g
ICAKPiAgIAkJCWNhcHR1cmUgPSB0aGlzLT5uZXh0Owo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVx
dWVzdC5jCj4gaW5kZXggNzU0YTc4MzY0YTYzLi40ZWNmYWUxNDMyNzYgMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3JlcXVlc3QuYwo+IEBAIC0xOTcsOSArMTk3LDggQEAgc3RhdGljIHZvaWQg
ZnJlZV9jYXB0dXJlX2xpc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCkKPiAgIAo+ICAg
c3RhdGljIGJvb2wgaTkxNV9yZXF1ZXN0X3JldGlyZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkK
PiAgIHsKPiAtCXN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsICpuZXh0Owo+IC0K
PiAgIAlsb2NrZGVwX2Fzc2VydF9oZWxkKCZycS0+dGltZWxpbmUtPm11dGV4KTsKPiArCj4gICAJ
aWYgKCFpOTE1X3JlcXVlc3RfY29tcGxldGVkKHJxKSkKPiAgIAkJcmV0dXJuIGZhbHNlOwo+ICAg
Cj4gQEAgLTIyMywzNSArMjIyLDYgQEAgc3RhdGljIGJvb2wgaTkxNV9yZXF1ZXN0X3JldGlyZShz
dHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiAgIAlHRU1fQlVHX09OKCFsaXN0X2lzX2ZpcnN0KCZy
cS0+bGluaywgJnJxLT50aW1lbGluZS0+cmVxdWVzdHMpKTsKPiAgIAlycS0+cmluZy0+aGVhZCA9
IHJxLT5wb3N0Zml4Owo+ICAgCj4gLQkvKgo+IC0JICogV2FsayB0aHJvdWdoIHRoZSBhY3RpdmUg
bGlzdCwgY2FsbGluZyByZXRpcmUgb24gZWFjaC4gVGhpcyBhbGxvd3MKPiAtCSAqIG9iamVjdHMg
dG8gdHJhY2sgdGhlaXIgR1BVIGFjdGl2aXR5IGFuZCBtYXJrIHRoZW1zZWx2ZXMgYXMgaWRsZQo+
IC0JICogd2hlbiB0aGVpciAqbGFzdCogYWN0aXZlIHJlcXVlc3QgaXMgY29tcGxldGVkICh1cGRh
dGluZyBzdGF0ZQo+IC0JICogdHJhY2tpbmcgbGlzdHMgZm9yIGV2aWN0aW9uLCBhY3RpdmUgcmVm
ZXJlbmNlcyBmb3IgR0VNLCBldGMpLgo+IC0JICoKPiAtCSAqIEFzIHRoZSAtPnJldGlyZSgpIG1h
eSBmcmVlIHRoZSBub2RlLCB3ZSBkZWNvdXBsZSBpdCBmaXJzdCBhbmQKPiAtCSAqIHBhc3MgYWxv
bmcgdGhlIGF1eGlsaWFyeSBpbmZvcm1hdGlvbiAodG8gYXZvaWQgZGVyZWZlcmVuY2luZwo+IC0J
ICogdGhlIG5vZGUgYWZ0ZXIgdGhlIGNhbGxiYWNrKS4KPiAtCSAqLwo+IC0JbGlzdF9mb3JfZWFj
aF9lbnRyeV9zYWZlKGFjdGl2ZSwgbmV4dCwgJnJxLT5hY3RpdmVfbGlzdCwgbGluaykgewo+IC0J
CS8qCj4gLQkJICogSW4gbWljcm9iZW5jaG1hcmtzIG9yIGZvY3VzaW5nIHVwb24gdGltZSBpbnNp
ZGUgdGhlIGtlcm5lbCwKPiAtCQkgKiB3ZSBtYXkgc3BlbmQgYW4gaW5vcmRpbmF0ZSBhbW91bnQg
b2YgdGltZSBzaW1wbHkgaGFuZGxpbmcKPiAtCQkgKiB0aGUgcmV0aXJlbWVudCBvZiByZXF1ZXN0
cyBhbmQgcHJvY2Vzc2luZyB0aGVpciBjYWxsYmFja3MuCj4gLQkJICogT2Ygd2hpY2gsIHRoaXMg
bG9vcCBpdHNlbGYgaXMgcGFydGljdWxhcmx5IGhvdCBkdWUgdG8gdGhlCj4gLQkJICogY2FjaGUg
bWlzc2VzIHdoZW4ganVtcGluZyBhcm91bmQgdGhlIGxpc3Qgb2YKPiAtCQkgKiBpOTE1X2FjdGl2
ZV9yZXF1ZXN0LiAgU28gd2UgdHJ5IHRvIGtlZXAgdGhpcyBsb29wIGFzCj4gLQkJICogc3RyZWFt
bGluZWQgYXMgcG9zc2libGUgYW5kIGFsc28gcHJlZmV0Y2ggdGhlIG5leHQKPiAtCQkgKiBpOTE1
X2FjdGl2ZV9yZXF1ZXN0IHRvIHRyeSBhbmQgaGlkZSB0aGUgbGlrZWx5IGNhY2hlIG1pc3MuCj4g
LQkJICovCj4gLQkJcHJlZmV0Y2h3KG5leHQpOwo+IC0KPiAtCQlJTklUX0xJU1RfSEVBRCgmYWN0
aXZlLT5saW5rKTsKPiAtCQlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+cmVxdWVzdCwgTlVMTCk7
Cj4gLQo+IC0JCWFjdGl2ZS0+cmV0aXJlKGFjdGl2ZSwgcnEpOwo+IC0JfQo+IC0KPiAgIAlsb2Nh
bF9pcnFfZGlzYWJsZSgpOwo+ICAgCj4gICAJLyoKPiBAQCAtNjY0LDcgKzYzNCw2IEBAIF9faTkx
NV9yZXF1ZXN0X2NyZWF0ZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIGdmcF90IGdmcCkKPiAg
IAlycS0+ZmxhZ3MgPSAwOwo+ICAgCXJxLT5leGVjdXRpb25fbWFzayA9IEFMTF9FTkdJTkVTOwo+
ICAgCj4gLQlJTklUX0xJU1RfSEVBRCgmcnEtPmFjdGl2ZV9saXN0KTsKPiAgIAlJTklUX0xJU1Rf
SEVBRCgmcnEtPmV4ZWN1dGVfY2IpOwo+ICAgCj4gICAJLyoKPiBAQCAtNzAzLDcgKzY3Miw2IEBA
IF9faTkxNV9yZXF1ZXN0X2NyZWF0ZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIGdmcF90IGdm
cCkKPiAgIAljZS0+cmluZy0+ZW1pdCA9IHJxLT5oZWFkOwo+ICAgCj4gICAJLyogTWFrZSBzdXJl
IHdlIGRpZG4ndCBhZGQgb3Vyc2VsdmVzIHRvIGV4dGVybmFsIHN0YXRlIGJlZm9yZSBmcmVlaW5n
ICovCj4gLQlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZycS0+YWN0aXZlX2xpc3QpKTsKPiAgIAlH
RU1fQlVHX09OKCFsaXN0X2VtcHR5KCZycS0+c2NoZWQuc2lnbmFsZXJzX2xpc3QpKTsKPiAgIAlH
RU1fQlVHX09OKCFsaXN0X2VtcHR5KCZycS0+c2NoZWQud2FpdGVyc19saXN0KSk7Cj4gICAKPiBA
QCAtMTA5Niw4ICsxMDY0LDggQEAgX19pOTE1X3JlcXVlc3RfYWRkX3RvX3RpbWVsaW5lKHN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxKQo+ICAgCSAqIHByZWNsdWRlcyBvcHRpbWlzaW5nIHRvIHVzZSBz
ZW1hcGhvcmVzIHNlcmlhbGlzYXRpb24gb2YgYSBzaW5nbGUKPiAgIAkgKiB0aW1lbGluZSBhY3Jv
c3MgZW5naW5lcy4KPiAgIAkgKi8KPiAtCXByZXYgPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVk
KHRpbWVsaW5lLT5sYXN0X3JlcXVlc3QucmVxdWVzdCwKPiAtCQkJCQkgbG9ja2RlcF9pc19oZWxk
KCZ0aW1lbGluZS0+bXV0ZXgpKTsKPiArCXByZXYgPSB0b19yZXF1ZXN0KF9faTkxNV9hY3RpdmVf
ZmVuY2Vfc2V0KCZ0aW1lbGluZS0+bGFzdF9yZXF1ZXN0LAo+ICsJCQkJCQkgICZycS0+ZmVuY2Up
KTsKPiAgIAlpZiAocHJldiAmJiAhaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChwcmV2KSkgewo+ICAg
CQlpZiAoaXNfcG93ZXJfb2ZfMihwcmV2LT5lbmdpbmUtPm1hc2sgfCBycS0+ZW5naW5lLT5tYXNr
KSkKPiAgIAkJCWk5MTVfc3dfZmVuY2VfYXdhaXRfc3dfZmVuY2UoJnJxLT5zdWJtaXQsCj4gQEAg
LTExMjIsNyArMTA5MCw2IEBAIF9faTkxNV9yZXF1ZXN0X2FkZF90b190aW1lbGluZShzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycSkKPiAgIAkgKiB1cywgdGhlIHRpbWVsaW5lIHdpbGwgaG9sZCBpdHMg
c2Vxbm8gd2hpY2ggaXMgbGF0ZXIgdGhhbiBvdXJzLgo+ICAgCSAqLwo+ICAgCUdFTV9CVUdfT04o
dGltZWxpbmUtPnNlcW5vICE9IHJxLT5mZW5jZS5zZXFubyk7Cj4gLQlfX2k5MTVfYWN0aXZlX3Jl
cXVlc3Rfc2V0KCZ0aW1lbGluZS0+bGFzdF9yZXF1ZXN0LCBycSk7Cj4gICAKPiAgIAlyZXR1cm4g
cHJldjsKPiAgIH0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1
ZXN0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuaAo+IGluZGV4IDhhYzZl
MTIyNmE1Ni4uMzI1MWQyYmRiZWVhIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfcmVxdWVzdC5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0
LmgKPiBAQCAtMjExLDcgKzIxMSw2IEBAIHN0cnVjdCBpOTE1X3JlcXVlc3Qgewo+ICAgCSAqIG9u
IHRoZSBhY3RpdmVfbGlzdCAob2YgdGhlaXIgZmluYWwgcmVxdWVzdCkuCj4gICAJICovCj4gICAJ
c3RydWN0IGk5MTVfY2FwdHVyZV9saXN0ICpjYXB0dXJlX2xpc3Q7Cj4gLQlzdHJ1Y3QgbGlzdF9o
ZWFkIGFjdGl2ZV9saXN0Owo+ICAgCj4gICAJLyoqIFRpbWUgYXQgd2hpY2ggdGhpcyByZXF1ZXN0
IHdhcyBlbWl0dGVkLCBpbiBqaWZmaWVzLiAqLwo+ICAgCXVuc2lnbmVkIGxvbmcgZW1pdHRlZF9q
aWZmaWVzOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwo+IGluZGV4IDVlYzhjOTcwZjlhMi4uMmM3
MDNmZDNjMmI5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMK
PiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCj4gQEAgLTEyMCw4ICsxMjAs
NyBAQCB2bWFfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCj4gICAJdm1h
LT5zaXplID0gb2JqLT5iYXNlLnNpemU7Cj4gICAJdm1hLT5kaXNwbGF5X2FsaWdubWVudCA9IEk5
MTVfR1RUX01JTl9BTElHTk1FTlQ7Cj4gICAKPiAtCWk5MTVfYWN0aXZlX2luaXQodm0tPmk5MTUs
ICZ2bWEtPmFjdGl2ZSwKPiAtCQkJIF9faTkxNV92bWFfYWN0aXZlLCBfX2k5MTVfdm1hX3JldGly
ZSk7Cj4gKwlpOTE1X2FjdGl2ZV9pbml0KCZ2bWEtPmFjdGl2ZSwgX19pOTE1X3ZtYV9hY3RpdmUs
IF9faTkxNV92bWFfcmV0aXJlKTsKPiAgIAo+ICAgCS8qIERlY2xhcmUgb3Vyc2VsdmVzIHNhZmUg
Zm9yIHVzZSBpbnNpZGUgc2hyaW5rZXJzICovCj4gICAJaWYgKElTX0VOQUJMRUQoQ09ORklHX0xP
Q0tERVApKSB7Cj4gQEAgLTExMDAsNyArMTA5OSw3IEBAIGludCBpOTE1X3ZtYV9tb3ZlX3RvX2Fj
dGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKPiAgIAkgKiBhZGQgdGhlIGFjdGl2ZSByZWZlcmVu
Y2UgZmlyc3QgYW5kIHF1ZXVlIGZvciBpdCB0byBiZSBkcm9wcGVkCj4gICAJICogKmxhc3QqLgo+
ICAgCSAqLwo+IC0JZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZ2bWEtPmFjdGl2ZSwgcnEtPnRpbWVs
aW5lLCBycSk7Cj4gKwllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJnZtYS0+YWN0aXZlLCBycS0+dGlt
ZWxpbmUsICZycS0+ZmVuY2UpOwo+ICAgCWlmICh1bmxpa2VseShlcnIpKQo+ICAgCQlyZXR1cm4g
ZXJyOwo+ICAgCj4gQEAgLTExMDgsNyArMTEwNyw3IEBAIGludCBpOTE1X3ZtYV9tb3ZlX3RvX2Fj
dGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKPiAgIAkJaWYgKGludGVsX2Zyb250YnVmZmVyX2lu
dmFsaWRhdGUob2JqLT5mcm9udGJ1ZmZlciwgT1JJR0lOX0NTKSkKPiAgIAkJCWk5MTVfYWN0aXZl
X3JlZigmb2JqLT5mcm9udGJ1ZmZlci0+d3JpdGUsCj4gICAJCQkJCXJxLT50aW1lbGluZSwKPiAt
CQkJCQlycSk7Cj4gKwkJCQkJJnJxLT5mZW5jZSk7Cj4gICAKPiAgIAkJZG1hX3Jlc3ZfYWRkX2V4
Y2xfZmVuY2Uodm1hLT5yZXN2LCAmcnEtPmZlbmNlKTsKPiAgIAkJb2JqLT53cml0ZV9kb21haW4g
PSBJOTE1X0dFTV9ET01BSU5fUkVOREVSOwo+IEBAIC0xMTQ2LDYgKzExNDUsNyBAQCBpbnQgaTkx
NV92bWFfdW5iaW5kKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQo+ICAgCWlmIChyZXQpCj4gICAJCXJl
dHVybiByZXQ7Cj4gICAKPiArCUdFTV9CVUdfT04oaTkxNV92bWFfaXNfYWN0aXZlKHZtYSkpOwo+
ICAgCWlmIChpOTE1X3ZtYV9pc19waW5uZWQodm1hKSkgewo+ICAgCQl2bWFfcHJpbnRfYWxsb2Nh
dG9yKHZtYSwgImlzIHBpbm5lZCIpOwo+ICAgCQlyZXR1cm4gLUVCVVNZOwo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9hY3RpdmUuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2FjdGl2ZS5jCj4gaW5kZXggZDVhYzk5NDRkMDkz
Li5hZjU4MjdhYWM3YjIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfYWN0aXZlLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
aTkxNV9hY3RpdmUuYwo+IEBAIC02OCw3ICs2OCw3IEBAIHN0YXRpYyBzdHJ1Y3QgbGl2ZV9hY3Rp
dmUgKl9fbGl2ZV9hbGxvYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIAkJcmV0
dXJuIE5VTEw7Cj4gICAKPiAgIAlrcmVmX2luaXQoJmFjdGl2ZS0+cmVmKTsKPiAtCWk5MTVfYWN0
aXZlX2luaXQoaTkxNSwgJmFjdGl2ZS0+YmFzZSwgX19saXZlX2FjdGl2ZSwgX19saXZlX3JldGly
ZSk7Cj4gKwlpOTE1X2FjdGl2ZV9pbml0KCZhY3RpdmUtPmJhc2UsIF9fbGl2ZV9hY3RpdmUsIF9f
bGl2ZV9yZXRpcmUpOwo+ICAgCj4gICAJcmV0dXJuIGFjdGl2ZTsKPiAgIH0KPiBAQCAtMTEwLDcg
KzExMCw5IEBAIF9fbGl2ZV9hY3RpdmVfc2V0dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCj4gICAJCQkJCQkgICAgICAgc3VibWl0LAo+ICAgCQkJCQkJICAgICAgIEdGUF9LRVJORUwp
Owo+ICAgCQlpZiAoZXJyID49IDApCj4gLQkJCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmYWN0aXZl
LT5iYXNlLCBycS0+dGltZWxpbmUsIHJxKTsKPiArCQkJZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZh
Y3RpdmUtPmJhc2UsCj4gKwkJCQkJICAgICAgcnEtPnRpbWVsaW5lLAo+ICsJCQkJCSAgICAgICZy
cS0+ZmVuY2UpOwo+ICAgCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKPiAgIAkJaWYgKGVycikgewo+
ICAgCQkJcHJfZXJyKCJGYWlsZWQgdG8gdHJhY2sgYWN0aXZlIHJlZiFcbiIpOwo+IEBAIC0xNDYs
MTkgKzE0OCwxMyBAQCBzdGF0aWMgaW50IGxpdmVfYWN0aXZlX3dhaXQodm9pZCAqYXJnKQo+ICAg
ewo+ICAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwo+ICAgCXN0cnVjdCBs
aXZlX2FjdGl2ZSAqYWN0aXZlOwo+IC0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJaW50
IGVyciA9IDA7Cj4gICAKPiAgIAkvKiBDaGVjayB0aGF0IHdlIGdldCBhIGNhbGxiYWNrIHdoZW4g
cmVxdWVzdHMgcmV0aXJlIHVwb24gd2FpdGluZyAqLwo+ICAgCj4gLQltdXRleF9sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgm
aTkxNS0+cnVudGltZV9wbSk7Cj4gLQo+ICAgCWFjdGl2ZSA9IF9fbGl2ZV9hY3RpdmVfc2V0dXAo
aTkxNSk7Cj4gLQlpZiAoSVNfRVJSKGFjdGl2ZSkpIHsKPiAtCQllcnIgPSBQVFJfRVJSKGFjdGl2
ZSk7Cj4gLQkJZ290byBlcnI7Cj4gLQl9Cj4gKwlpZiAoSVNfRVJSKGFjdGl2ZSkpCj4gKwkJcmV0
dXJuIFBUUl9FUlIoYWN0aXZlKTsKPiAgIAo+ICAgCWk5MTVfYWN0aXZlX3dhaXQoJmFjdGl2ZS0+
YmFzZSk7Cj4gICAJaWYgKCFSRUFEX09OQ0UoYWN0aXZlLT5yZXRpcmVkKSkgewo+IEBAIC0xNjgs
MTEgKzE2NCw5IEBAIHN0YXRpYyBpbnQgbGl2ZV9hY3RpdmVfd2FpdCh2b2lkICphcmcpCj4gICAK
PiAgIAlfX2xpdmVfcHV0KGFjdGl2ZSk7Cj4gICAKPiArCW11dGV4X2xvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwo+ICAgCWlmIChpZ3RfZmx1c2hfdGVzdChpOTE1LCBJOTE1X1dBSVRfTE9D
S0VEKSkKPiAgIAkJZXJyID0gLUVJTzsKPiAtCj4gLWVycjoKPiAtCWludGVsX3J1bnRpbWVfcG1f
cHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKPiAgIAltdXRleF91bmxvY2soJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCj4gICAJcmV0dXJuIGVycjsKPiBAQCAtMTgyLDIzICsx
NzYsMTkgQEAgc3RhdGljIGludCBsaXZlX2FjdGl2ZV9yZXRpcmUodm9pZCAqYXJnKQo+ICAgewo+
ICAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJnOwo+ICAgCXN0cnVjdCBsaXZl
X2FjdGl2ZSAqYWN0aXZlOwo+IC0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7Cj4gICAJaW50IGVy
ciA9IDA7Cj4gICAKPiAgIAkvKiBDaGVjayB0aGF0IHdlIGdldCBhIGNhbGxiYWNrIHdoZW4gcmVx
dWVzdHMgYXJlIGluZGlyZWN0bHkgcmV0aXJlZCAqLwo+ICAgCj4gLQltdXRleF9sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKPiAtCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgm
aTkxNS0+cnVudGltZV9wbSk7Cj4gLQo+ICAgCWFjdGl2ZSA9IF9fbGl2ZV9hY3RpdmVfc2V0dXAo
aTkxNSk7Cj4gLQlpZiAoSVNfRVJSKGFjdGl2ZSkpIHsKPiAtCQllcnIgPSBQVFJfRVJSKGFjdGl2
ZSk7Cj4gLQkJZ290byBlcnI7Cj4gLQl9Cj4gKwlpZiAoSVNfRVJSKGFjdGl2ZSkpCj4gKwkJcmV0
dXJuIFBUUl9FUlIoYWN0aXZlKTsKPiAgIAo+ICAgCS8qIHdhaXRzIGZvciAmIHJldGlyZXMgYWxs
IHJlcXVlc3RzICovCj4gKwltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKPiAg
IAlpZiAoaWd0X2ZsdXNoX3Rlc3QoaTkxNSwgSTkxNV9XQUlUX0xPQ0tFRCkpCj4gICAJCWVyciA9
IC1FSU87Cj4gKwltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwo+ICAgCj4g
ICAJaWYgKCFSRUFEX09OQ0UoYWN0aXZlLT5yZXRpcmVkKSkgewo+ICAgCQlwcl9lcnIoImk5MTVf
YWN0aXZlIG5vdCByZXRpcmVkIGFmdGVyIGZsdXNoaW5nIVxuIik7Cj4gQEAgLTIwNywxMCArMTk3
LDYgQEAgc3RhdGljIGludCBsaXZlX2FjdGl2ZV9yZXRpcmUodm9pZCAqYXJnKQo+ICAgCj4gICAJ
X19saXZlX3B1dChhY3RpdmUpOwo+ICAgCj4gLWVycjoKPiAtCWludGVsX3J1bnRpbWVfcG1fcHV0
KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKPiAtCW11dGV4X3VubG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7Cj4gLQo+ICAgCXJldHVybiBlcnI7Cj4gICB9Cj4gICAKPiAKCkkgY2Fu
J3QgcmVhbGx5IGdyYXNwIGl0IGZyb20gdGhlIGRpZmYuIFdpbGwgbmVlZCB0byBhcHBseSBhbmQg
dHJ5IGFnYWluLiAKSXQgcmVtb3ZlcyBhIGxvdCBvZiBjb2RlIHNvIGJvbnVzIHBvaW50cyBmb3Ig
dGhhdC4gOikKClJlZ2FyZHMsCgpUdnJ0a28KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vaW50ZWwtZ2Z4

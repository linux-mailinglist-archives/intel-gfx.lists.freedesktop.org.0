Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D44C3E3E4
	for <lists+intel-gfx@lfdr.de>; Mon, 29 Apr 2019 15:43:50 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0A3CE8930F;
	Mon, 29 Apr 2019 13:43:49 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 237698930F
 for <intel-gfx@lists.freedesktop.org>; Mon, 29 Apr 2019 13:43:48 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 29 Apr 2019 06:43:47 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.60,409,1549958400"; d="scan'208";a="139778500"
Received: from jbartcza-mobl.ger.corp.intel.com (HELO [10.251.88.64])
 ([10.251.88.64])
 by orsmga006.jf.intel.com with ESMTP; 29 Apr 2019 06:43:45 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190425092004.9995-1-chris@chris-wilson.co.uk>
 <20190425092004.9995-19-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <782198b1-d430-892e-1b2b-39ef9e75e364@linux.intel.com>
Date: Mon, 29 Apr 2019 14:43:45 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.6.1
MIME-Version: 1.0
In-Reply-To: <20190425092004.9995-19-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 19/45] drm/i915: Load balancing across a
 virtual engine
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDI1LzA0LzIwMTkgMTA6MTksIENocmlzIFdpbHNvbiB3cm90ZToKPiBIYXZpbmcgYWxsb3dl
ZCB0aGUgdXNlciB0byBkZWZpbmUgYSBzZXQgb2YgZW5naW5lcyB0aGF0IHRoZXkgd2lsbCB3YW50
Cj4gdG8gb25seSB1c2UsIHdlIGdvIG9uZSBzdGVwIGZ1cnRoZXIgYW5kIGFsbG93IHRoZW0gdG8g
YmluZCB0aG9zZSBlbmdpbmVzCj4gaW50byBhIHNpbmdsZSB2aXJ0dWFsIGluc3RhbmNlLiBTdWJt
aXR0aW5nIGEgYmF0Y2ggdG8gdGhlIHZpcnR1YWwgZW5naW5lCj4gd2lsbCB0aGVuIGZvcndhcmQg
aXQgdG8gYW55IG9uZSBvZiB0aGUgc2V0IGluIGEgbWFubmVyIGFzIGJlc3QgdG8KPiBkaXN0cmli
dXRlIGxvYWQuICBUaGUgdmlydHVhbCBlbmdpbmUgaGFzIGEgc2luZ2xlIHRpbWVsaW5lIGFjcm9z
cyBhbGwKPiBlbmdpbmVzIChpdCBvcGVyYXRlcyBhcyBhIHNpbmdsZSBxdWV1ZSksIHNvIGl0IGlz
IG5vdCBhYmxlIHRvIGNvbmN1cnJlbnRseQo+IHJ1biBiYXRjaGVzIGFjcm9zcyBtdWx0aXBsZSBl
bmdpbmVzIGJ5IGl0c2VsZjsgdGhhdCBpcyBsZWZ0IHVwIHRvIHRoZSB1c2VyCj4gdG8gc3VibWl0
IG11bHRpcGxlIGNvbmN1cnJlbnQgYmF0Y2hlcyB0byBtdWx0aXBsZSBxdWV1ZXMuIE11bHRpcGxl
IHVzZXJzCj4gd2lsbCBiZSBsb2FkIGJhbGFuY2VkIGFjcm9zcyB0aGUgc3lzdGVtLgo+IAo+IFRo
ZSBtZWNoYW5pc20gdXNlZCBmb3IgbG9hZCBiYWxhbmNpbmcgaW4gdGhpcyBwYXRjaCBpcyBhIGxh
dGUgZ3JlZWR5Cj4gYmFsYW5jZXIuIFdoZW4gYSByZXF1ZXN0IGlzIHJlYWR5IGZvciBleGVjdXRp
b24sIGl0IGlzIGFkZGVkIHRvIGVhY2gKPiBlbmdpbmUncyBxdWV1ZSwgYW5kIHdoZW4gYW4gZW5n
aW5lIGlzIHJlYWR5IGZvciBpdHMgbmV4dCByZXF1ZXN0IGl0Cj4gY2xhaW1zIGl0IGZyb20gdGhl
IHZpcnR1YWwgZW5naW5lLiBUaGUgZmlyc3QgZW5naW5lIHRvIGRvIHNvLCB3aW5zLCBpLmUuCj4g
dGhlIHJlcXVlc3QgaXMgZXhlY3V0ZWQgYXQgdGhlIGVhcmxpZXN0IG9wcG9ydHVuaXR5IChpZGxl
IG1vbWVudCkgaW4gdGhlCj4gc3lzdGVtLgo+IAo+IEFzIG5vdCBhbGwgSFcgaXMgY3JlYXRlZCBl
cXVhbCwgdGhlIHVzZXIgaXMgc3RpbGwgYWJsZSB0byBza2lwIHRoZQo+IHZpcnR1YWwgZW5naW5l
IGFuZCBleGVjdXRlIHRoZSBiYXRjaCBvbiBhIHNwZWNpZmljIGVuZ2luZSwgYWxsIHdpdGhpbiB0
aGUKPiBzYW1lIHF1ZXVlLiBJdCB3aWxsIHRoZW4gYmUgZXhlY3V0ZWQgaW4gb3JkZXIgb24gdGhl
IGNvcnJlY3QgZW5naW5lLAo+IHdpdGggZXhlY3V0aW9uIG9uIG90aGVyIHZpcnR1YWwgZW5naW5l
cyBiZWluZyBtb3ZlZCBhd2F5IGR1ZSB0byB0aGUgbG9hZAo+IGRldGVjdGlvbi4KPiAKPiBBIGNv
dXBsZSBvZiBhcmVhcyBmb3IgcG90ZW50aWFsIGltcHJvdmVtZW50IGxlZnQhCj4gCj4gLSBUaGUg
dmlydHVhbCBlbmdpbmUgYWx3YXlzIHRha2UgcHJpb3JpdHkgb3ZlciBlcXVhbC1wcmlvcml0eSB0
YXNrcy4KPiBNb3N0bHkgYnJva2VuIHVwIGJ5IGFwcGx5aW5nIEZRX0NPREVMIHJ1bGVzIGZvciBw
cmlvcml0aXNpbmcgbmV3IGNsaWVudHMsCj4gYW5kIGhvcGVmdWxseSB0aGUgdmlydHVhbCBhbmQg
cmVhbCBlbmdpbmVzIGFyZSBub3QgdGhlbiBjb25nZXN0ZWQgKGkuZS4KPiBhbGwgd29yayBpcyB2
aWEgdmlydHVhbCBlbmdpbmVzLCBvciBhbGwgd29yayBpcyB0byB0aGUgcmVhbCBlbmdpbmUpLgo+
IAo+IC0gV2UgcmVxdWlyZSB0aGUgYnJlYWRjcnVtYiBpcnEgYXJvdW5kIGV2ZXJ5IHZpcnR1YWwg
ZW5naW5lIHJlcXVlc3QuIEZvcgo+IG5vcm1hbCBlbmdpbmVzLCB3ZSBlbGltaW5hdGUgdGhlIG5l
ZWQgZm9yIHRoZSBzbG93IHJvdW5kIHRyaXAgdmlhCj4gaW50ZXJydXB0IGJ5IHVzaW5nIHRoZSBz
dWJtaXQgZmVuY2UgYW5kIHF1ZXVlaW5nIGluIG9yZGVyLiBGb3IgdmlydHVhbAo+IGVuZ2luZXMs
IHdlIGhhdmUgdG8gYWxsb3cgYW55IGpvYiB0byB0cmFuc2ZlciB0byBhIG5ldyByaW5nLCBhbmQg
Y2Fubm90Cj4gY29hbGVzY2UgdGhlIHN1Ym1pc3Npb25zLCBzbyByZXF1aXJlIHRoZSBjb21wbGV0
aW9uIGZlbmNlIGluc3RlYWQsCj4gZm9yY2luZyB0aGUgcGVyc2lzdGVudCB1c2Ugb2YgaW50ZXJy
dXB0cy4KPiAKPiAtIFdlIG9ubHkgZHJpcCBmZWVkIHNpbmdsZSByZXF1ZXN0cyB0aHJvdWdoIGVh
Y2ggdmlydHVhbCBlbmdpbmUgYW5kIG9udG8KPiB0aGUgcGh5c2ljYWwgZW5naW5lcywgZXZlbiBp
ZiB0aGVyZSB3YXMgZW5vdWdoIHdvcmsgdG8gZmlsbCBhbGwgRUxTUCwKPiBsZWF2aW5nIHNtYWxs
IHN0YWxscyB3aXRoIGFuIGlkbGUgQ1MgZXZlbnQgYXQgdGhlIGVuZCBvZiBldmVyeSByZXF1ZXN0
Lgo+IENvdWxkIHdlIGJlIGdyZWVkeSBhbmQgZmlsbCBib3RoIHNsb3RzPyBCZWluZyBsYXp5IGlz
IHZpcnR1b3VzIGZvciBsb2FkCj4gZGlzdHJpYnV0aW9uIG9uIGxlc3MtdGhhbi1mdWxsIHdvcmts
b2FkcyB0aG91Z2guCj4gCj4gT3RoZXIgYXJlYXMgb2YgaW1wcm92ZW1lbnQgYXJlIG1vcmUgZ2Vu
ZXJhbCwgc3VjaCBhcyByZWR1Y2luZyBsb2NrCj4gY29udGVudGlvbiwgcmVkdWNpbmcgZGlzcGF0
Y2ggb3ZlcmhlYWQsIGxvb2tpbmcgYXQgZGlyZWN0IHN1Ym1pc3Npb24KPiByYXRoZXIgdGhhbiBi
b3VuY2luZyBhcm91bmQgdGFza2xldHMgZXRjLgo+IAo+IHNzZXU6IExpZnQgdGhlIHJlc3RyaWN0
aW9uIHRvIGFsbG93IHNzZXUgdG8gYmUgcmVjb25maWd1cmVkIG9uIHZpcnR1YWwKPiBlbmdpbmVz
IGNvbXBvc2VkIG9mIFJFTkRFUl9DTEFTUyAocmNzKS4KPiAKPiB2MjogbWFjcm9pemUgY2hlY2tf
dXNlcl9tYnooKQo+IHYzOiBDYW5jZWwgdmlydHVhbCBlbmdpbmVzIG9uIHdlZGdpbmcKPiB2NDog
Q29tbWVuY2UgY29tbWVudGluZwo+IHY1OiBSZXBsYWNlIDY0YiBzaWJsaW5nX21hc2sgd2l0aCBh
IGxpc3Qgb2YgY2xhc3M6aW5zdGFuY2UKPiAKPiBTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24g
PGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KPiBDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51
cnN1bGluQGludGVsLmNvbT4KPiAtLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2JyZWFkY3J1bWJzLmMgIHwgICA2ICstCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9lbmdpbmVfdHlwZXMuaCB8ICAgOCArCj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9scmMuYyAgICAgICAgICB8IDY1NiArKysrKysrKysrKysrKysrKystCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuaCAgICAgICAgICB8ICAgOSArCj4gICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyAgICAgICB8IDE4MCArKysrKwo+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uaCAgICAgICAgICAgICAgfCAgIDUgKwo+ICAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fY29udGV4dC5jICAgICAgfCAxMTggKysrLQo+ICAgZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVsZXIuYyAgICAgICAgfCAgMTggKy0KPiAgIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdGltZWxpbmVfdHlwZXMuaCAgIHwgICAxICsKPiAgIGlu
Y2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaCAgICAgICAgICAgICAgICAgIHwgIDM5ICsrCj4gICAx
MCBmaWxlcyBjaGFuZ2VkLCAxMDEyIGluc2VydGlvbnMoKyksIDI4IGRlbGV0aW9ucygtKQo+IAo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9icmVhZGNydW1icy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfYnJlYWRjcnVtYnMuYwo+IGluZGV4IDQy
ODMyMjQyNDlkNC4uMzVlZWYwMmIzZjA5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9icmVhZGNydW1icy5jCj4gQEAgLTI5MCw4ICsyOTAsMTIgQEAgYm9vbCBpOTE1X3Jl
cXVlc3RfZW5hYmxlX2JyZWFkY3J1bWIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCj4gICAJCQkJ
YnJlYWs7Cj4gICAJCX0KPiAgIAkJbGlzdF9hZGQoJnJxLT5zaWduYWxfbGluaywgcG9zKTsKPiAt
CQlpZiAocG9zID09ICZjZS0+c2lnbmFscykgLyogY2F0Y2ggdHJhbnNpdGlvbnMgZnJvbSBlbXB0
eSBsaXN0ICovCj4gKwkJaWYgKHBvcyA9PSAmY2UtPnNpZ25hbHMpIHsgLyogY2F0Y2ggdHJhbnNp
dGlvbnMgZnJvbSBlbXB0eSAqLwo+ICAgCQkJbGlzdF9tb3ZlX3RhaWwoJmNlLT5zaWduYWxfbGlu
aywgJmItPnNpZ25hbGVycyk7Cj4gKwkJfSBlbHNlIGlmIChjZS0+ZW5naW5lICE9IHJxLT5lbmdp
bmUpIHsgLyogdmlydHVhbGlzZWQgKi8KPiArCQkJbGlzdF9tb3ZlX3RhaWwoJmNlLT5zaWduYWxf
bGluaywgJmItPnNpZ25hbGVycyk7Cj4gKwkJCWludGVsX2VuZ2luZV9xdWV1ZV9icmVhZGNydW1i
cyhycS0+ZW5naW5lKTsKPiArCQl9Cj4gICAKPiAgIAkJc2V0X2JpdChJOTE1X0ZFTkNFX0ZMQUdf
U0lHTkFMLCAmcnEtPmZlbmNlLmZsYWdzKTsKPiAgIAkJc3Bpbl91bmxvY2soJmItPmlycV9sb2Nr
KTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5
cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaAo+IGlu
ZGV4IDlkNjRlMzNmODQyNy4uYjA3ZDM2ODVlMmNiIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCj4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKPiBAQCAtMjI3LDYgKzIyNyw3IEBAIHN0cnVj
dCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzIHsKPiAgIAkgKiBAcXVldWU6IHF1ZXVlIG9mIHJlcXVl
c3RzLCBpbiBwcmlvcml0eSBsaXN0cwo+ICAgCSAqLwo+ICAgCXN0cnVjdCByYl9yb290X2NhY2hl
ZCBxdWV1ZTsKPiArCXN0cnVjdCByYl9yb290X2NhY2hlZCB2aXJ0dWFsOwo+ICAgCj4gICAJLyoq
Cj4gICAJICogQGNzYl93cml0ZTogY29udHJvbCByZWdpc3RlciBmb3IgQ29udGV4dCBTd2l0Y2gg
YnVmZmVyCj4gQEAgLTQ0NSw2ICs0NDYsNyBAQCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzIHsKPiAg
ICNkZWZpbmUgSTkxNV9FTkdJTkVfSEFTX1BSRUVNUFRJT04gICBCSVQoMikKPiAgICNkZWZpbmUg
STkxNV9FTkdJTkVfSEFTX1NFTUFQSE9SRVMgICBCSVQoMykKPiAgICNkZWZpbmUgSTkxNV9FTkdJ
TkVfTkVFRFNfQlJFQURDUlVNQl9UQVNLTEVUIEJJVCg0KQo+ICsjZGVmaW5lIEk5MTVfRU5HSU5F
X0lTX1ZJUlRVQUwgICAgICAgQklUKDUpCj4gICAJdW5zaWduZWQgaW50IGZsYWdzOwo+ICAgCj4g
ICAJLyoKPiBAQCAtNTM0LDYgKzUzNiwxMiBAQCBpbnRlbF9lbmdpbmVfbmVlZHNfYnJlYWRjcnVt
Yl90YXNrbGV0KGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIAlyZXR1
cm4gZW5naW5lLT5mbGFncyAmIEk5MTVfRU5HSU5FX05FRURTX0JSRUFEQ1JVTUJfVEFTS0xFVDsK
PiAgIH0KPiAgIAo+ICtzdGF0aWMgaW5saW5lIGJvb2wKPiAraW50ZWxfZW5naW5lX2lzX3ZpcnR1
YWwoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ICt7Cj4gKwlyZXR1cm4g
ZW5naW5lLT5mbGFncyAmIEk5MTVfRU5HSU5FX0lTX1ZJUlRVQUw7Cj4gK30KPiArCj4gICAjZGVm
aW5lIGluc3Rkb25lX3NsaWNlX21hc2soZGV2X3ByaXZfXykgXAo+ICAgCShJU19HRU4oZGV2X3By
aXZfXywgNykgPyBcCj4gICAJIDEgOiBSVU5USU1FX0lORk8oZGV2X3ByaXZfXyktPnNzZXUuc2xp
Y2VfbWFzaykKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJj
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwo+IGluZGV4IDJlNzRjNzky
MTA0ZS4uZThmYWYzNDE3ZjljIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2xyYy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMK
PiBAQCAtMTM2LDYgKzEzNiw3IEBACj4gICAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKPiAgICNpbmNs
dWRlICJpOTE1X2dlbV9yZW5kZXJfc3RhdGUuaCIKPiAgICNpbmNsdWRlICJpOTE1X3ZncHUuaCIK
PiArI2luY2x1ZGUgImludGVsX2VuZ2luZV9wbS5oIgo+ICAgI2luY2x1ZGUgImludGVsX2xyY19y
ZWcuaCIKPiAgICNpbmNsdWRlICJpbnRlbF9tb2NzLmgiCj4gICAjaW5jbHVkZSAiaW50ZWxfcmVz
ZXQuaCIKPiBAQCAtMTY1LDYgKzE2Niw0MSBAQAo+ICAgCj4gICAjZGVmaW5lIEFDVElWRV9QUklP
UklUWSAoSTkxNV9QUklPUklUWV9ORVdDTElFTlQgfCBJOTE1X1BSSU9SSVRZX05PU0VNQVBIT1JF
KQo+ICAgCj4gK3N0cnVjdCB2aXJ0dWFsX2VuZ2luZSB7Cj4gKwlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzIGJhc2U7Cj4gKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCBjb250ZXh0Owo+ICsKPiArCS8qCj4g
KwkgKiBXZSBhbGxvdyBvbmx5IGEgc2luZ2xlIHJlcXVlc3QgdGhyb3VnaCB0aGUgdmlydHVhbCBl
bmdpbmUgYXQgYSB0aW1lCj4gKwkgKiAoZWFjaCByZXF1ZXN0IGluIHRoZSB0aW1lbGluZSB3YWl0
cyBmb3IgdGhlIGNvbXBsZXRpb24gZmVuY2Ugb2YKPiArCSAqIHRoZSBwcmV2aW91cyBiZWZvcmUg
YmVpbmcgc3VibWl0dGVkKS4gQnkgcmVzdHJpY3Rpbmcgb3Vyc2VsdmVzIHRvCj4gKwkgKiBvbmx5
IHN1Ym1pdHRpbmcgYSBzaW5nbGUgcmVxdWVzdCwgZWFjaCByZXF1ZXN0IGlzIHBsYWNlZCBvbiB0
byBhCj4gKwkgKiBwaHlzaWNhbCB0byBtYXhpbWlzZSBsb2FkIHNwcmVhZGluZyAoYnkgdmlydHVl
IG9mIHRoZSBsYXRlIGdyZWVkeQo+ICsJICogc2NoZWR1bGluZyAtLSBlYWNoIHJlYWwgZW5naW5l
IHRha2VzIHRoZSBuZXh0IGF2YWlsYWJsZSByZXF1ZXN0Cj4gKwkgKiB1cG9uIGlkbGluZykuCj4g
KwkgKi8KPiArCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3Q7Cj4gKwo+ICsJLyoKPiArCSAq
IFdlIGtlZXAgYSByYnRyZWUgb2YgYXZhaWxhYmxlIHZpcnR1YWwgZW5naW5lcyBpbnNpZGUgZWFj
aCBwaHlzaWNhbAo+ICsJICogZW5naW5lLCBzb3J0ZWQgYnkgcHJpb3JpdHkuIEhlcmUgd2UgcHJl
YWxsb2NhdGUgdGhlIG5vZGVzIHdlIG5lZWQKPiArCSAqIGZvciB0aGUgdmlydHVhbCBlbmdpbmUs
IGluZGV4ZWQgYnkgcGh5c2ljYWxfZW5naW5lLT5pZC4KPiArCSAqLwo+ICsJc3RydWN0IHZlX25v
ZGUgewo+ICsJCXN0cnVjdCByYl9ub2RlIHJiOwo+ICsJCWludCBwcmlvOwo+ICsJfSBub2Rlc1tJ
OTE1X05VTV9FTkdJTkVTXTsKPiArCj4gKwkvKiBBbmQgZmluYWxseSwgd2hpY2ggcGh5c2ljYWwg
ZW5naW5lcyB0aGlzIHZpcnR1YWwgZW5naW5lIG1hcHMgb250by4gKi8KPiArCXVuc2lnbmVkIGlu
dCBudW1fc2libGluZ3M7Cj4gKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpzaWJsaW5nc1swXTsK
PiArfTsKPiArCj4gK3N0YXRpYyBzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnRvX3ZpcnR1YWxfZW5n
aW5lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiArewoKV291bGQgR0VNX0JVR19P
TighKGVuZ2luZS0+ZmxhZ3MgJiAuLlZJUlRVQUwuLikpIGJlIHRvbyBtdWNoPwoKUmVnYXJkcywK
ClR2cnRrbwoKPiArCXJldHVybiBjb250YWluZXJfb2YoZW5naW5lLCBzdHJ1Y3QgdmlydHVhbF9l
bmdpbmUsIGJhc2UpOwo+ICt9Cj4gKwo+ICAgc3RhdGljIGludCBleGVjbGlzdHNfY29udGV4dF9k
ZWZlcnJlZF9hbGxvYyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCj4gICAJCQkJCSAgICBzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwo+ICAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2lu
aXRfcmVnX3N0YXRlKHUzMiAqcmVnX3N0YXRlLAo+IEBAIC0yMjgsNyArMjY0LDggQEAgc3RhdGlj
IGludCBxdWV1ZV9wcmlvKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICpleGVj
bGlzdHMpCj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbmxpbmUgYm9vbCBuZWVkX3ByZWVtcHQoY29u
c3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAo+IC0JCQkJY29uc3Qgc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnEpCj4gKwkJCQljb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKPiAr
CQkJCXN0cnVjdCByYl9ub2RlICpyYikKPiAgIHsKPiAgIAlpbnQgbGFzdF9wcmlvOwo+ICAgCj4g
QEAgLTI2Myw2ICszMDAsMjUgQEAgc3RhdGljIGlubGluZSBib29sIG5lZWRfcHJlZW1wdChjb25z
dCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCj4gICAJICAgIHJxX3ByaW8obGlzdF9u
ZXh0X2VudHJ5KHJxLCBsaW5rKSkgPiBsYXN0X3ByaW8pCj4gICAJCXJldHVybiB0cnVlOwo+ICAg
Cj4gKwlpZiAocmIpIHsKPiArCQlzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZlID0KPiArCQkJcmJf
ZW50cnkocmIsIHR5cGVvZigqdmUpLCBub2Rlc1tlbmdpbmUtPmlkXS5yYik7Cj4gKwkJYm9vbCBw
cmVlbXB0ID0gZmFsc2U7Cj4gKwo+ICsJCWlmIChlbmdpbmUgPT0gdmUtPnNpYmxpbmdzWzBdKSB7
IC8qIG9ubHkgcHJlZW1wdCBvbmUgc2libGluZyAqLwo+ICsJCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpuZXh0Owo+ICsKPiArCQkJcmN1X3JlYWRfbG9jaygpOwo+ICsJCQluZXh0ID0gUkVBRF9PTkNF
KHZlLT5yZXF1ZXN0KTsKPiArCQkJaWYgKG5leHQpCj4gKwkJCQlwcmVlbXB0ID0gcnFfcHJpbyhu
ZXh0KSA+IGxhc3RfcHJpbzsKPiArCQkJcmN1X3JlYWRfdW5sb2NrKCk7Cj4gKwkJfQo+ICsKPiAr
CQlpZiAocHJlZW1wdCkKPiArCQkJcmV0dXJuIHByZWVtcHQ7Cj4gKwl9Cj4gKwo+ICAgCS8qCj4g
ICAJICogSWYgdGhlIGluZmxpZ2h0IGNvbnRleHQgZGlkIG5vdCB0cmlnZ2VyIHRoZSBwcmVlbXB0
aW9uLCB0aGVuIG1heWJlCj4gICAJICogaXQgd2FzIHRoZSBzZXQgb2YgcXVldWVkIHJlcXVlc3Rz
PyBQaWNrIHRoZSBoaWdoZXN0IHByaW9yaXR5IGluCj4gQEAgLTM4MSw2ICs0MzcsOCBAQCBfX3Vu
d2luZF9pbmNvbXBsZXRlX3JlcXVlc3RzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
PiAgIAlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmVfcmV2ZXJzZShycSwgcm4sCj4gICAJCQkJCSAm
ZW5naW5lLT50aW1lbGluZS5yZXF1ZXN0cywKPiAgIAkJCQkJIGxpbmspIHsKPiArCQlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICpvd25lcjsKPiArCj4gICAJCWlmIChpOTE1X3JlcXVlc3RfY29tcGxl
dGVkKHJxKSkKPiAgIAkJCWJyZWFrOwo+ICAgCj4gQEAgLTM4OSwxNiArNDQ3LDMyIEBAIF9fdW53
aW5kX2luY29tcGxldGVfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+
ICAgCj4gICAJCUdFTV9CVUdfT04ocnEtPmh3X2NvbnRleHQtPmFjdGl2ZSk7Cj4gICAKPiAtCQlH
RU1fQlVHX09OKHJxX3ByaW8ocnEpID09IEk5MTVfUFJJT1JJVFlfSU5WQUxJRCk7Cj4gLQkJaWYg
KHJxX3ByaW8ocnEpICE9IHByaW8pIHsKPiAtCQkJcHJpbyA9IHJxX3ByaW8ocnEpOwo+IC0JCQlw
bCA9IGk5MTVfc2NoZWRfbG9va3VwX3ByaW9saXN0KGVuZ2luZSwgcHJpbyk7Cj4gLQkJfQo+IC0J
CUdFTV9CVUdfT04oUkJfRU1QVFlfUk9PVCgmZW5naW5lLT5leGVjbGlzdHMucXVldWUucmJfcm9v
dCkpOwo+ICsJCS8qCj4gKwkJICogUHVzaCB0aGUgcmVxdWVzdCBiYWNrIGludG8gdGhlIHF1ZXVl
IGZvciBsYXRlciByZXN1Ym1pc3Npb24uCj4gKwkJICogSWYgdGhpcyByZXF1ZXN0IGlzIG5vdCBu
YXRpdmUgdG8gdGhpcyBwaHlzaWNhbCBlbmdpbmUgKGkuZS4KPiArCQkgKiBpdCBjYW1lIGZyb20g
YSB2aXJ0dWFsIHNvdXJjZSksIHB1c2ggaXQgYmFjayBvbnRvIHRoZSB2aXJ0dWFsCj4gKwkJICog
ZW5naW5lIHNvIHRoYXQgaXQgY2FuIGJlIG1vdmVkIGFjcm9zcyBvbnRvIGFub3RoZXIgcGh5c2lj
YWwKPiArCQkgKiBlbmdpbmUgYXMgbG9hZCBkaWN0YXRlcy4KPiArCQkgKi8KPiArCQlvd25lciA9
IHJxLT5od19jb250ZXh0LT5lbmdpbmU7Cj4gKwkJaWYgKGxpa2VseShvd25lciA9PSBlbmdpbmUp
KSB7Cj4gKwkJCUdFTV9CVUdfT04ocnFfcHJpbyhycSkgPT0gSTkxNV9QUklPUklUWV9JTlZBTElE
KTsKPiArCQkJaWYgKHJxX3ByaW8ocnEpICE9IHByaW8pIHsKPiArCQkJCXByaW8gPSBycV9wcmlv
KHJxKTsKPiArCQkJCXBsID0gaTkxNV9zY2hlZF9sb29rdXBfcHJpb2xpc3QoZW5naW5lLCBwcmlv
KTsKPiArCQkJfQo+ICsJCQlHRU1fQlVHX09OKFJCX0VNUFRZX1JPT1QoJmVuZ2luZS0+ZXhlY2xp
c3RzLnF1ZXVlLnJiX3Jvb3QpKTsKPiAgIAo+IC0JCWxpc3RfYWRkKCZycS0+c2NoZWQubGluaywg
cGwpOwo+ICsJCQlsaXN0X2FkZCgmcnEtPnNjaGVkLmxpbmssIHBsKTsKPiArCQkJYWN0aXZlID0g
cnE7Cj4gKwkJfSBlbHNlIHsKPiArCQkJaWYgKF9faTkxNV9yZXF1ZXN0X2hhc19zdGFydGVkKHJx
KSkKPiArCQkJCXJxLT5zY2hlZC5hdHRyLnByaW9yaXR5IHw9IEFDVElWRV9QUklPUklUWTsKPiAg
IAo+IC0JCWFjdGl2ZSA9IHJxOwo+ICsJCQlycS0+ZW5naW5lID0gb3duZXI7Cj4gKwkJCW93bmVy
LT5zdWJtaXRfcmVxdWVzdChycSk7Cj4gKwkJCWFjdGl2ZSA9IE5VTEw7Cj4gKwkJfQo+ICAgCX0K
PiAgIAo+ICAgCS8qCj4gQEAgLTQxOCw3ICs0OTIsOCBAQCBfX3Vud2luZF9pbmNvbXBsZXRlX3Jl
cXVlc3RzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIAkgKiBpbiB0aGUgcHJp
b3JpdHkgcXVldWUsIGJ1dCB0aGV5IHdpbGwgbm90IGdhaW4gaW1tZWRpYXRlIGFjY2VzcyB0bwo+
ICAgCSAqIHRoZSBHUFUuCj4gICAJICovCj4gLQlpZiAofnByaW8gJiBBQ1RJVkVfUFJJT1JJVFkg
JiYgX19pOTE1X3JlcXVlc3RfaGFzX3N0YXJ0ZWQoYWN0aXZlKSkgewo+ICsJaWYgKCB+cHJpbyAm
IEFDVElWRV9QUklPUklUWSAmJgo+ICsJICAgIGFjdGl2ZSAmJiBfX2k5MTVfcmVxdWVzdF9oYXNf
c3RhcnRlZChhY3RpdmUpKSB7Cj4gICAJCXByaW8gfD0gQUNUSVZFX1BSSU9SSVRZOwo+ICAgCQlh
Y3RpdmUtPnNjaGVkLmF0dHIucHJpb3JpdHkgPSBwcmlvOwo+ICAgCQlsaXN0X21vdmVfdGFpbCgm
YWN0aXZlLT5zY2hlZC5saW5rLAo+IEBAIC02NTgsNiArNzMzLDcyIEBAIHN0YXRpYyB2b2lkIGNv
bXBsZXRlX3ByZWVtcHRfY29udGV4dChzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqZXhl
Y2xpc3RzKQo+ICAgCQkJCQkJICBleGVjbGlzdHMpKTsKPiAgIH0KPiAgIAo+ICtzdGF0aWMgdm9p
ZCB2aXJ0dWFsX3VwZGF0ZV9yZWdpc3Rlcl9vZmZzZXRzKHUzMiAqcmVncywKPiArCQkJCQkgICAg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ICt7Cj4gKwl1MzIgYmFzZSA9IGVuZ2lu
ZS0+bW1pb19iYXNlOwo+ICsKPiArCXJlZ3NbQ1RYX0NPTlRFWFRfQ09OVFJPTF0gPQo+ICsJCWk5
MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQ09OVEVYVF9DT05UUk9MKGJhc2UpKTsKPiArCXJlZ3Nb
Q1RYX1JJTkdfSEVBRF0gPSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0hFQUQoYmFzZSkpOwo+
ICsJcmVnc1tDVFhfUklOR19UQUlMXSA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfVEFJTChi
YXNlKSk7Cj4gKwlyZWdzW0NUWF9SSU5HX0JVRkZFUl9TVEFSVF0gPSBpOTE1X21taW9fcmVnX29m
ZnNldChSSU5HX1NUQVJUKGJhc2UpKTsKPiArCXJlZ3NbQ1RYX1JJTkdfQlVGRkVSX0NPTlRST0xd
ID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DVEwoYmFzZSkpOwo+ICsKPiArCXJlZ3NbQ1RY
X0JCX0hFQURfVV0gPSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0JCQUREUl9VRFcoYmFzZSkp
Owo+ICsJcmVnc1tDVFhfQkJfSEVBRF9MXSA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQkJB
RERSKGJhc2UpKTsKPiArCXJlZ3NbQ1RYX0JCX1NUQVRFXSA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0
KFJJTkdfQkJTVEFURShiYXNlKSk7Cj4gKwlyZWdzW0NUWF9TRUNPTkRfQkJfSEVBRF9VXSA9Cj4g
KwkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19TQkJBRERSX1VEVyhiYXNlKSk7Cj4gKwlyZWdz
W0NUWF9TRUNPTkRfQkJfSEVBRF9MXSA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfU0JCQURE
UihiYXNlKSk7Cj4gKwlyZWdzW0NUWF9TRUNPTkRfQkJfU1RBVEVdID0gaTkxNV9tbWlvX3JlZ19v
ZmZzZXQoUklOR19TQkJTVEFURShiYXNlKSk7Cj4gKwo+ICsJcmVnc1tDVFhfQ1RYX1RJTUVTVEFN
UF0gPQo+ICsJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQ1RYX1RJTUVTVEFNUChiYXNlKSk7
Cj4gKwlyZWdzW0NUWF9QRFAzX1VEV10gPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdf
UERQX1VEVyhiYXNlLCAzKSk7Cj4gKwlyZWdzW0NUWF9QRFAzX0xEV10gPSBpOTE1X21taW9fcmVn
X29mZnNldChHRU44X1JJTkdfUERQX0xEVyhiYXNlLCAzKSk7Cj4gKwlyZWdzW0NUWF9QRFAyX1VE
V10gPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfUERQX1VEVyhiYXNlLCAyKSk7Cj4g
KwlyZWdzW0NUWF9QRFAyX0xEV10gPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfUERQ
X0xEVyhiYXNlLCAyKSk7Cj4gKwlyZWdzW0NUWF9QRFAxX1VEV10gPSBpOTE1X21taW9fcmVnX29m
ZnNldChHRU44X1JJTkdfUERQX1VEVyhiYXNlLCAxKSk7Cj4gKwlyZWdzW0NUWF9QRFAxX0xEV10g
PSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfUERQX0xEVyhiYXNlLCAxKSk7Cj4gKwly
ZWdzW0NUWF9QRFAwX1VEV10gPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfUERQX1VE
VyhiYXNlLCAwKSk7Cj4gKwlyZWdzW0NUWF9QRFAwX0xEV10gPSBpOTE1X21taW9fcmVnX29mZnNl
dChHRU44X1JJTkdfUERQX0xEVyhiYXNlLCAwKSk7Cj4gKwo+ICsJaWYgKGVuZ2luZS0+Y2xhc3Mg
PT0gUkVOREVSX0NMQVNTKSB7Cj4gKwkJcmVnc1tDVFhfUkNTX0lORElSRUNUX0NUWF0gPQo+ICsJ
CQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0lORElSRUNUX0NUWChiYXNlKSk7Cj4gKwkJcmVn
c1tDVFhfUkNTX0lORElSRUNUX0NUWF9PRkZTRVRdID0KPiArCQkJaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoUklOR19JTkRJUkVDVF9DVFhfT0ZGU0VUKGJhc2UpKTsKPiArCQlyZWdzW0NUWF9CQl9QRVJf
Q1RYX1BUUl0gPQo+ICsJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0JCX1BFUl9DVFhfUFRS
KGJhc2UpKTsKPiArCj4gKwkJcmVnc1tDVFhfUl9QV1JfQ0xLX1NUQVRFXSA9Cj4gKwkJCWk5MTVf
bW1pb19yZWdfb2Zmc2V0KEdFTjhfUl9QV1JfQ0xLX1NUQVRFKTsKPiArCX0KPiArfQo+ICsKPiAr
c3RhdGljIGJvb2wgdmlydHVhbF9tYXRjaGVzKGNvbnN0IHN0cnVjdCB2aXJ0dWFsX2VuZ2luZSAq
dmUsCj4gKwkJCSAgICBjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKPiArCQkJICAgIGNv
bnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiArewo+ICsJY29uc3Qgc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqYWN0aXZlOwo+ICsKPiArCS8qCj4gKwkgKiBXZSB0cmFjayB3aGVu
IHRoZSBIVyBoYXMgY29tcGxldGVkIHNhdmluZyB0aGUgY29udGV4dCBpbWFnZQo+ICsJICogKGku
ZS4gd2hlbiB3ZSBoYXZlIHNlZW4gdGhlIGZpbmFsIENTIGV2ZW50IHN3aXRjaGluZyBvdXQgb2YK
PiArCSAqIHRoZSBjb250ZXh0KSBhbmQgbXVzdCBub3Qgb3ZlcndyaXRlIHRoZSBjb250ZXh0IGlt
YWdlIGJlZm9yZQo+ICsJICogdGhlbi4gVGhpcyByZXN0cmljdHMgdXMgdG8gb25seSB1c2luZyB0
aGUgYWN0aXZlIGVuZ2luZQo+ICsJICogd2hpbGUgdGhlIHByZXZpb3VzIHZpcnR1YWxpemVkIHJl
cXVlc3QgaXMgaW5mbGlnaHQgKHNvCj4gKwkgKiB3ZSByZXVzZSB0aGUgcmVnaXN0ZXIgb2Zmc2V0
cykuIFRoaXMgaXMgYSB2ZXJ5IHNtYWxsCj4gKwkgKiBoeXN0ZXJzaXMgb24gdGhlIGdyZWVkeSBz
ZWVsY3Rpb24gYWxnb3JpdGhtLgo+ICsJICovCj4gKwlhY3RpdmUgPSBSRUFEX09OQ0UodmUtPmNv
bnRleHQuYWN0aXZlKTsKPiArCWlmIChhY3RpdmUgJiYgYWN0aXZlICE9IGVuZ2luZSkKPiArCQly
ZXR1cm4gZmFsc2U7Cj4gKwo+ICsJcmV0dXJuIHRydWU7Cj4gK30KPiArCj4gICBzdGF0aWMgdm9p
ZCBleGVjbGlzdHNfZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCj4gICB7
Cj4gICAJc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKiBjb25zdCBleGVjbGlzdHMgPSAm
ZW5naW5lLT5leGVjbGlzdHM7Cj4gQEAgLTY5MCw2ICs4MzEsMjYgQEAgc3RhdGljIHZvaWQgZXhl
Y2xpc3RzX2RlcXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQo+ICAgCSAqIGFu
ZCBjb250ZXh0IHN3aXRjaGVzKSBzdWJtaXNzaW9uLgo+ICAgCSAqLwo+ICAgCj4gKwlmb3IgKHJi
ID0gcmJfZmlyc3RfY2FjaGVkKCZleGVjbGlzdHMtPnZpcnR1YWwpOyByYjsgKSB7Cj4gKwkJc3Ry
dWN0IHZpcnR1YWxfZW5naW5lICp2ZSA9Cj4gKwkJCXJiX2VudHJ5KHJiLCB0eXBlb2YoKnZlKSwg
bm9kZXNbZW5naW5lLT5pZF0ucmIpOwo+ICsJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxID0gUkVB
RF9PTkNFKHZlLT5yZXF1ZXN0KTsKPiArCj4gKwkJaWYgKCFycSkgeyAvKiBsYXppbHkgY2xlYW51
cCBhZnRlciBhbm90aGVyIGVuZ2luZSBoYW5kbGVkIHJxICovCj4gKwkJCXJiX2VyYXNlX2NhY2hl
ZChyYiwgJmV4ZWNsaXN0cy0+dmlydHVhbCk7Cj4gKwkJCVJCX0NMRUFSX05PREUocmIpOwo+ICsJ
CQlyYiA9IHJiX2ZpcnN0X2NhY2hlZCgmZXhlY2xpc3RzLT52aXJ0dWFsKTsKPiArCQkJY29udGlu
dWU7Cj4gKwkJfQo+ICsKPiArCQlpZiAoIXZpcnR1YWxfbWF0Y2hlcyh2ZSwgcnEsIGVuZ2luZSkp
IHsKPiArCQkJcmIgPSByYl9uZXh0KHJiKTsKPiArCQkJY29udGludWU7Cj4gKwkJfQo+ICsKPiAr
CQlicmVhazsKPiArCX0KPiArCj4gICAJaWYgKGxhc3QpIHsKPiAgIAkJLyoKPiAgIAkJICogRG9u
J3QgcmVzdWJtaXQgb3Igc3dpdGNoIHVudGlsIGFsbCBvdXRzdGFuZGluZwo+IEBAIC03MTEsNyAr
ODcyLDcgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2RlcXVldWUoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQo+ICAgCQlpZiAoIWV4ZWNsaXN0c19pc19hY3RpdmUoZXhlY2xpc3RzLCBF
WEVDTElTVFNfQUNUSVZFX0hXQUNLKSkKPiAgIAkJCXJldHVybjsKPiAgIAo+IC0JCWlmIChuZWVk
X3ByZWVtcHQoZW5naW5lLCBsYXN0KSkgewo+ICsJCWlmIChuZWVkX3ByZWVtcHQoZW5naW5lLCBs
YXN0LCByYikpIHsKPiAgIAkJCWluamVjdF9wcmVlbXB0X2NvbnRleHQoZW5naW5lKTsKPiAgIAkJ
CXJldHVybjsKPiAgIAkJfQo+IEBAIC03NTEsNiArOTEyLDg5IEBAIHN0YXRpYyB2b2lkIGV4ZWNs
aXN0c19kZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIAkJbGFzdC0+
dGFpbCA9IGxhc3QtPndhX3RhaWw7Cj4gICAJfQo+ICAgCj4gKwl3aGlsZSAocmIpIHsgLyogWFhY
IHZpcnR1YWwgaXMgYWx3YXlzIHRha2luZyBwcmVjZWRlbmNlICovCj4gKwkJc3RydWN0IHZpcnR1
YWxfZW5naW5lICp2ZSA9Cj4gKwkJCXJiX2VudHJ5KHJiLCB0eXBlb2YoKnZlKSwgbm9kZXNbZW5n
aW5lLT5pZF0ucmIpOwo+ICsJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwo+ICsKPiArCQlzcGlu
X2xvY2soJnZlLT5iYXNlLnRpbWVsaW5lLmxvY2spOwo+ICsKPiArCQlycSA9IHZlLT5yZXF1ZXN0
Owo+ICsJCWlmICh1bmxpa2VseSghcnEpKSB7IC8qIGxvc3QgdGhlIHJhY2UgdG8gYSBzaWJsaW5n
ICovCj4gKwkJCXNwaW5fdW5sb2NrKCZ2ZS0+YmFzZS50aW1lbGluZS5sb2NrKTsKPiArCQkJcmJf
ZXJhc2VfY2FjaGVkKHJiLCAmZXhlY2xpc3RzLT52aXJ0dWFsKTsKPiArCQkJUkJfQ0xFQVJfTk9E
RShyYik7Cj4gKwkJCXJiID0gcmJfZmlyc3RfY2FjaGVkKCZleGVjbGlzdHMtPnZpcnR1YWwpOwo+
ICsJCQljb250aW51ZTsKPiArCQl9Cj4gKwo+ICsJCUdFTV9CVUdfT04ocnEgIT0gdmUtPnJlcXVl
c3QpOwo+ICsJCUdFTV9CVUdfT04ocnEtPmVuZ2luZSAhPSAmdmUtPmJhc2UpOwo+ICsJCUdFTV9C
VUdfT04ocnEtPmh3X2NvbnRleHQgIT0gJnZlLT5jb250ZXh0KTsKPiArCj4gKwkJaWYgKHJxX3By
aW8ocnEpID49IHF1ZXVlX3ByaW8oZXhlY2xpc3RzKSkgewo+ICsJCQlpZiAoIXZpcnR1YWxfbWF0
Y2hlcyh2ZSwgcnEsIGVuZ2luZSkpIHsKPiArCQkJCXNwaW5fdW5sb2NrKCZ2ZS0+YmFzZS50aW1l
bGluZS5sb2NrKTsKPiArCQkJCXJiID0gcmJfbmV4dChyYik7Cj4gKwkJCQljb250aW51ZTsKPiAr
CQkJfQo+ICsKPiArCQkJaWYgKGxhc3QgJiYgIWNhbl9tZXJnZV9ycShsYXN0LCBycSkpIHsKPiAr
CQkJCXNwaW5fdW5sb2NrKCZ2ZS0+YmFzZS50aW1lbGluZS5sb2NrKTsKPiArCQkJCXJldHVybjsg
LyogbGVhdmUgdGhpcyBycSBmb3IgYW5vdGhlciBlbmdpbmUgKi8KPiArCQkJfQo+ICsKPiArCQkJ
R0VNX1RSQUNFKCIlczogdmlydHVhbCBycT0lbGx4OiVsbGQlcywgbmV3IGVuZ2luZT8gJXNcbiIs
Cj4gKwkJCQkgIGVuZ2luZS0+bmFtZSwKPiArCQkJCSAgcnEtPmZlbmNlLmNvbnRleHQsCj4gKwkJ
CQkgIHJxLT5mZW5jZS5zZXFubywKPiArCQkJCSAgaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSkg
PyAiISIgOgo+ICsJCQkJICBpOTE1X3JlcXVlc3Rfc3RhcnRlZChycSkgPyAiKiIgOgo+ICsJCQkJ
ICAiIiwKPiArCQkJCSAgeWVzbm8oZW5naW5lICE9IHZlLT5zaWJsaW5nc1swXSkpOwo+ICsKPiAr
CQkJdmUtPnJlcXVlc3QgPSBOVUxMOwo+ICsJCQl2ZS0+YmFzZS5leGVjbGlzdHMucXVldWVfcHJp
b3JpdHlfaGludCA9IElOVF9NSU47Cj4gKwkJCXJiX2VyYXNlX2NhY2hlZChyYiwgJmV4ZWNsaXN0
cy0+dmlydHVhbCk7Cj4gKwkJCVJCX0NMRUFSX05PREUocmIpOwo+ICsKPiArCQkJcnEtPmVuZ2lu
ZSA9IGVuZ2luZTsKPiArCj4gKwkJCWlmIChlbmdpbmUgIT0gdmUtPnNpYmxpbmdzWzBdKSB7Cj4g
KwkJCQl1MzIgKnJlZ3MgPSB2ZS0+Y29udGV4dC5scmNfcmVnX3N0YXRlOwo+ICsJCQkJdW5zaWdu
ZWQgaW50IG47Cj4gKwo+ICsJCQkJR0VNX0JVR19PTihSRUFEX09OQ0UodmUtPmNvbnRleHQuYWN0
aXZlKSk7Cj4gKwkJCQl2aXJ0dWFsX3VwZGF0ZV9yZWdpc3Rlcl9vZmZzZXRzKHJlZ3MsIGVuZ2lu
ZSk7Cj4gKwo+ICsJCQkJLyoKPiArCQkJCSAqIE1vdmUgdGhlIGJvdW5kIGVuZ2luZSB0byB0aGUg
dG9wIG9mIHRoZSBsaXN0Cj4gKwkJCQkgKiBmb3IgZnV0dXJlIGV4ZWN1dGlvbi4gV2UgdGhlbiBr
aWNrIHRoaXMKPiArCQkJCSAqIHRhc2tsZXQgZmlyc3QgYmVmb3JlIGNoZWNraW5nIG90aGVycywg
c28gdGhhdAo+ICsJCQkJICogd2UgcHJlZmVyZW50aWFsbHkgcmV1c2UgdGhpcyBzZXQgb2YgYm91
bmQKPiArCQkJCSAqIHJlZ2lzdGVycy4KPiArCQkJCSAqLwo+ICsJCQkJZm9yIChuID0gMTsgbiA8
IHZlLT5udW1fc2libGluZ3M7IG4rKykgewo+ICsJCQkJCWlmICh2ZS0+c2libGluZ3Nbbl0gPT0g
ZW5naW5lKSB7Cj4gKwkJCQkJCXN3YXAodmUtPnNpYmxpbmdzW25dLAo+ICsJCQkJCQkgICAgIHZl
LT5zaWJsaW5nc1swXSk7Cj4gKwkJCQkJCWJyZWFrOwo+ICsJCQkJCX0KPiArCQkJCX0KPiArCj4g
KwkJCQlHRU1fQlVHX09OKHZlLT5zaWJsaW5nc1swXSAhPSBlbmdpbmUpOwo+ICsJCQl9Cj4gKwo+
ICsJCQlfX2k5MTVfcmVxdWVzdF9zdWJtaXQocnEpOwo+ICsJCQl0cmFjZV9pOTE1X3JlcXVlc3Rf
aW4ocnEsIHBvcnRfaW5kZXgocG9ydCwgZXhlY2xpc3RzKSk7Cj4gKwkJCXN1Ym1pdCA9IHRydWU7
Cj4gKwkJCWxhc3QgPSBycTsKPiArCQl9Cj4gKwo+ICsJCXNwaW5fdW5sb2NrKCZ2ZS0+YmFzZS50
aW1lbGluZS5sb2NrKTsKPiArCQlicmVhazsKPiArCX0KPiArCj4gICAJd2hpbGUgKChyYiA9IHJi
X2ZpcnN0X2NhY2hlZCgmZXhlY2xpc3RzLT5xdWV1ZSkpKSB7Cj4gICAJCXN0cnVjdCBpOTE1X3By
aW9saXN0ICpwID0gdG9fcHJpb2xpc3QocmIpOwo+ICAgCQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cSwgKnJuOwo+IEBAIC0xODc0LDYgKzIxMTgsMjUgQEAgc3RhdGljIHZvaWQgcmVzZXRfY3NiX3Bv
aW50ZXJzKHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICpleGVjbGlzdHMpCj4gICAJCQkg
ICAgICAgJmV4ZWNsaXN0cy0+Y3NiX3N0YXR1c1tyZXNldF92YWx1ZV0pOwo+ICAgfQo+ICAgCj4g
K3N0YXRpYyBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICphY3RpdmVfcmVxdWVzdChzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycSkKPiArewo+ICsJY29uc3Qgc3RydWN0IGxpc3RfaGVhZCAqIGNvbnN0IGxpc3Qg
PSAmcnEtPmVuZ2luZS0+dGltZWxpbmUucmVxdWVzdHM7Cj4gKwljb25zdCBzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqIGNvbnN0IGNvbnRleHQgPSBycS0+aHdfY29udGV4dDsKPiArCXN0cnVjdCBpOTE1
X3JlcXVlc3QgKmFjdGl2ZSA9IE5VTEw7Cj4gKwo+ICsJbGlzdF9mb3JfZWFjaF9lbnRyeV9mcm9t
X3JldmVyc2UocnEsIGxpc3QsIGxpbmspIHsKPiArCQlpZiAoaTkxNV9yZXF1ZXN0X2NvbXBsZXRl
ZChycSkpCj4gKwkJCWJyZWFrOwo+ICsKPiArCQlpZiAocnEtPmh3X2NvbnRleHQgIT0gY29udGV4
dCkKPiArCQkJYnJlYWs7Cj4gKwo+ICsJCWFjdGl2ZSA9IHJxOwo+ICsJfQo+ICsKPiArCXJldHVy
biBhY3RpdmU7Cj4gK30KPiArCj4gICBzdGF0aWMgdm9pZCBfX2V4ZWNsaXN0c19yZXNldChzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIGJvb2wgc3RhbGxlZCkKPiAgIHsKPiAgIAlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0cyA9ICZlbmdpbmUtPmV4
ZWNsaXN0czsKPiBAQCAtMTg5NCw3ICsyMTU3LDggQEAgc3RhdGljIHZvaWQgX19leGVjbGlzdHNf
cmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxsZWQpCj4gICAJ
aWYgKCFwb3J0X2lzc2V0KGV4ZWNsaXN0cy0+cG9ydCkpCj4gICAJCWdvdG8gb3V0X2NsZWFyOwo+
ICAgCj4gLQljZSA9IHBvcnRfcmVxdWVzdChleGVjbGlzdHMtPnBvcnQpLT5od19jb250ZXh0Owo+
ICsJcnEgPSBwb3J0X3JlcXVlc3QoZXhlY2xpc3RzLT5wb3J0KTsKPiArCWNlID0gcnEtPmh3X2Nv
bnRleHQ7Cj4gICAKPiAgIAkvKgo+ICAgCSAqIENhdGNoIHVwIHdpdGggYW55IG1pc3NlZCBjb250
ZXh0LXN3aXRjaCBpbnRlcnJ1cHRzLgo+IEBAIC0xOTA3LDE2ICsyMTcxLDEwIEBAIHN0YXRpYyB2
b2lkIF9fZXhlY2xpc3RzX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9v
bCBzdGFsbGVkKQo+ICAgCSAqLwo+ICAgCWV4ZWNsaXN0c19jYW5jZWxfcG9ydF9yZXF1ZXN0cyhl
eGVjbGlzdHMpOwo+ICAgCj4gLQkvKiBQdXNoIGJhY2sgYW55IGluY29tcGxldGUgcmVxdWVzdHMg
Zm9yIHJlcGxheSBhZnRlciB0aGUgcmVzZXQuICovCj4gLQlycSA9IF9fdW53aW5kX2luY29tcGxl
dGVfcmVxdWVzdHMoZW5naW5lKTsKPiArCXJxID0gYWN0aXZlX3JlcXVlc3QocnEpOwo+ICAgCWlm
ICghcnEpCj4gICAJCWdvdG8gb3V0X3JlcGxheTsKPiAgIAo+IC0JaWYgKHJxLT5od19jb250ZXh0
ICE9IGNlKSB7IC8qIGNhdWdodCBqdXN0IGJlZm9yZSBhIENTIGV2ZW50ICovCj4gLQkJcnEgPSBO
VUxMOwo+IC0JCWdvdG8gb3V0X3JlcGxheTsKPiAtCX0KPiAtCj4gICAJLyoKPiAgIAkgKiBJZiB0
aGlzIHJlcXVlc3QgaGFzbid0IHN0YXJ0ZWQgeWV0LCBlLmcuIGl0IGlzIHdhaXRpbmcgb24gYQo+
ICAgCSAqIHNlbWFwaG9yZSwgd2UgbmVlZCB0byBhdm9pZCBza2lwcGluZyB0aGUgcmVxdWVzdCBv
ciBlbHNlIHdlCj4gQEAgLTE5NjMsMTMgKzIyMjEsMTYgQEAgc3RhdGljIHZvaWQgX19leGVjbGlz
dHNfcmVzZXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxsZWQpCj4g
ICAJfQo+ICAgCWV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZShyZWdzLCBjZSwgZW5naW5lLCBjZS0+
cmluZyk7Cj4gICAKPiAtCS8qIFJlcnVuIHRoZSByZXF1ZXN0OyBpdHMgcGF5bG9hZCBoYXMgYmVl
biBuZXV0ZXJlZCAoaWYgZ3VpbHR5KS4gKi8KPiAgIG91dF9yZXBsYXk6Cj4gKwkvKiBSZXJ1biB0
aGUgcmVxdWVzdDsgaXRzIHBheWxvYWQgaGFzIGJlZW4gbmV1dGVyZWQgKGlmIGd1aWx0eSkuICov
Cj4gICAJY2UtPnJpbmctPmhlYWQgPQo+ICAgCQlycSA/IGludGVsX3Jpbmdfd3JhcChjZS0+cmlu
ZywgcnEtPmhlYWQpIDogY2UtPnJpbmctPnRhaWw7Cj4gICAJaW50ZWxfcmluZ191cGRhdGVfc3Bh
Y2UoY2UtPnJpbmcpOwo+ICAgCV9fZXhlY2xpc3RzX3VwZGF0ZV9yZWdfc3RhdGUoY2UsIGVuZ2lu
ZSk7Cj4gICAKPiArCS8qIFB1c2ggYmFjayBhbnkgaW5jb21wbGV0ZSByZXF1ZXN0cyBmb3IgcmVw
bGF5IGFmdGVyIHRoZSByZXNldC4gKi8KPiArCV9fdW53aW5kX2luY29tcGxldGVfcmVxdWVzdHMo
ZW5naW5lKTsKPiArCj4gICBvdXRfY2xlYXI6Cj4gICAJZXhlY2xpc3RzX2NsZWFyX2FsbF9hY3Rp
dmUoZXhlY2xpc3RzKTsKPiAgIH0KPiBAQCAtMjA0Myw2ICsyMzA0LDI2IEBAIHN0YXRpYyB2b2lk
IGV4ZWNsaXN0c19jYW5jZWxfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQo+ICAgCQlpOTE1X3ByaW9saXN0X2ZyZWUocCk7Cj4gICAJfQo+ICAgCj4gKwkvKiBDYW5jZWwg
YWxsIGF0dGFjaGVkIHZpcnR1YWwgZW5naW5lcyAqLwo+ICsJd2hpbGUgKChyYiA9IHJiX2ZpcnN0
X2NhY2hlZCgmZXhlY2xpc3RzLT52aXJ0dWFsKSkpIHsKPiArCQlzdHJ1Y3QgdmlydHVhbF9lbmdp
bmUgKnZlID0KPiArCQkJcmJfZW50cnkocmIsIHR5cGVvZigqdmUpLCBub2Rlc1tlbmdpbmUtPmlk
XS5yYik7Cj4gKwo+ICsJCXJiX2VyYXNlX2NhY2hlZChyYiwgJmV4ZWNsaXN0cy0+dmlydHVhbCk7
Cj4gKwkJUkJfQ0xFQVJfTk9ERShyYik7Cj4gKwo+ICsJCXNwaW5fbG9jaygmdmUtPmJhc2UudGlt
ZWxpbmUubG9jayk7Cj4gKwkJaWYgKHZlLT5yZXF1ZXN0KSB7Cj4gKwkJCXZlLT5yZXF1ZXN0LT5l
bmdpbmUgPSBlbmdpbmU7Cj4gKwkJCV9faTkxNV9yZXF1ZXN0X3N1Ym1pdCh2ZS0+cmVxdWVzdCk7
Cj4gKwkJCWRtYV9mZW5jZV9zZXRfZXJyb3IoJnZlLT5yZXF1ZXN0LT5mZW5jZSwgLUVJTyk7Cj4g
KwkJCWk5MTVfcmVxdWVzdF9tYXJrX2NvbXBsZXRlKHZlLT5yZXF1ZXN0KTsKPiArCQkJdmUtPmJh
c2UuZXhlY2xpc3RzLnF1ZXVlX3ByaW9yaXR5X2hpbnQgPSBJTlRfTUlOOwo+ICsJCQl2ZS0+cmVx
dWVzdCA9IE5VTEw7Cj4gKwkJfQo+ICsJCXNwaW5fdW5sb2NrKCZ2ZS0+YmFzZS50aW1lbGluZS5s
b2NrKTsKPiArCX0KPiArCj4gICAJLyogUmVtYWluaW5nIF91bnJlYWR5XyByZXF1ZXN0cyB3aWxs
IGJlIG5vcCdlZCB3aGVuIHN1Ym1pdHRlZCAqLwo+ICAgCj4gICAJZXhlY2xpc3RzLT5xdWV1ZV9w
cmlvcml0eV9oaW50ID0gSU5UX01JTjsKPiBAQCAtMjc2MCw2ICszMDQxLDMxOCBAQCBzdGF0aWMg
aW50IGV4ZWNsaXN0c19jb250ZXh0X2RlZmVycmVkX2FsbG9jKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSwKPiAgIAlyZXR1cm4gcmV0Owo+ICAgfQo+ICAgCj4gK3N0YXRpYyB2b2lkIHZpcnR1YWxf
Y29udGV4dF9kZXN0cm95KHN0cnVjdCBrcmVmICprcmVmKQo+ICt7Cj4gKwlzdHJ1Y3QgdmlydHVh
bF9lbmdpbmUgKnZlID0KPiArCQljb250YWluZXJfb2Yoa3JlZiwgdHlwZW9mKCp2ZSksIGNvbnRl
eHQucmVmKTsKPiArCXVuc2lnbmVkIGludCBuOwo+ICsKPiArCUdFTV9CVUdfT04odmUtPnJlcXVl
c3QpOwo+ICsJR0VNX0JVR19PTih2ZS0+Y29udGV4dC5hY3RpdmUpOwo+ICsKPiArCWZvciAobiA9
IDA7IG4gPCB2ZS0+bnVtX3NpYmxpbmdzOyBuKyspIHsKPiArCQlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICpzaWJsaW5nID0gdmUtPnNpYmxpbmdzW25dOwo+ICsJCXN0cnVjdCByYl9ub2RlICpub2Rl
ID0gJnZlLT5ub2Rlc1tzaWJsaW5nLT5pZF0ucmI7Cj4gKwo+ICsJCWlmIChSQl9FTVBUWV9OT0RF
KG5vZGUpKQo+ICsJCQljb250aW51ZTsKPiArCj4gKwkJc3Bpbl9sb2NrX2lycSgmc2libGluZy0+
dGltZWxpbmUubG9jayk7Cj4gKwo+ICsJCWlmICghUkJfRU1QVFlfTk9ERShub2RlKSkKPiArCQkJ
cmJfZXJhc2VfY2FjaGVkKG5vZGUsICZzaWJsaW5nLT5leGVjbGlzdHMudmlydHVhbCk7Cj4gKwo+
ICsJCXNwaW5fdW5sb2NrX2lycSgmc2libGluZy0+dGltZWxpbmUubG9jayk7Cj4gKwl9Cj4gKwlH
RU1fQlVHX09OKF9fdGFza2xldF9pc19zY2hlZHVsZWQoJnZlLT5iYXNlLmV4ZWNsaXN0cy50YXNr
bGV0KSk7Cj4gKwo+ICsJaWYgKHZlLT5jb250ZXh0LnN0YXRlKQo+ICsJCV9fZXhlY2xpc3RzX2Nv
bnRleHRfZmluaSgmdmUtPmNvbnRleHQpOwo+ICsKPiArCWk5MTVfdGltZWxpbmVfZmluaSgmdmUt
PmJhc2UudGltZWxpbmUpOwo+ICsJa2ZyZWUodmUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB2
aXJ0dWFsX2VuZ2luZV9pbml0aWFsX2hpbnQoc3RydWN0IHZpcnR1YWxfZW5naW5lICp2ZSkKPiAr
ewo+ICsJaW50IHN3cDsKPiArCj4gKwkvKgo+ICsJICogUGljayBhIHJhbmRvbSBzaWJsaW5nIG9u
IHN0YXJ0aW5nIHRvIGhlbHAgc3ByZWFkIHRoZSBsb2FkIGFyb3VuZC4KPiArCSAqCj4gKwkgKiBO
ZXcgY29udGV4dHMgYXJlIHR5cGljYWxseSBjcmVhdGVkIHdpdGggZXhhY3RseSB0aGUgc2FtZSBv
cmRlcgo+ICsJICogb2Ygc2libGluZ3MsIGFuZCBvZnRlbiBzdGFydGVkIGluIGJhdGNoZXMuIER1
ZSB0byB0aGUgd2F5IHdlIGl0ZXJhdGUKPiArCSAqIHRoZSBhcnJheSBvZiBzaWJsaW5nIHdoZW4g
c3VibWl0dGluZyByZXF1ZXN0cywgc2libGluZ1swXSBpcwo+ICsJICogcHJpb3JpdGlzZWQgZm9y
IGRlcXVldWluZy4gSWYgd2UgbWFrZSBzdXJlIHRoYXQgc2libGluZ1swXSBpcyBmYWlybHkKPiAr
CSAqIHJhbmRvbWlzZWQgYWNyb3NzIHRoZSBzeXN0ZW0sIHdlIGFsc28gaGVscCBzcHJlYWQgdGhl
IGxvYWQgYnkgdGhlCj4gKwkgKiBmaXJzdCBlbmdpbmUgd2UgaW5zcGVjdCBiZWluZyBkaWZmZXJl
bnQgZWFjaCB0aW1lLgo+ICsJICoKPiArCSAqIE5CIFRoaXMgZG9lcyBub3QgZm9yY2UgdXMgdG8g
ZXhlY3V0ZSBvbiB0aGlzIGVuZ2luZSwgaXQgd2lsbCBqdXN0Cj4gKwkgKiB0eXBpY2FsbHkgYmUg
dGhlIGZpcnN0IHdlIGluc3BlY3QgZm9yIHN1Ym1pc3Npb24uCj4gKwkgKi8KPiArCXN3cCA9IHBy
YW5kb21fdTMyX21heCh2ZS0+bnVtX3NpYmxpbmdzKTsKPiArCWlmICghc3dwKQo+ICsJCXJldHVy
bjsKPiArCj4gKwlzd2FwKHZlLT5zaWJsaW5nc1tzd3BdLCB2ZS0+c2libGluZ3NbMF0pOwo+ICsJ
dmlydHVhbF91cGRhdGVfcmVnaXN0ZXJfb2Zmc2V0cyh2ZS0+Y29udGV4dC5scmNfcmVnX3N0YXRl
LAo+ICsJCQkJCXZlLT5zaWJsaW5nc1swXSk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdmlydHVh
bF9jb250ZXh0X3BpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCj4gK3sKPiArCXN0cnVjdCB2
aXJ0dWFsX2VuZ2luZSAqdmUgPSBjb250YWluZXJfb2YoY2UsIHR5cGVvZigqdmUpLCBjb250ZXh0
KTsKPiArCWludCBlcnI7Cj4gKwo+ICsJLyogTm90ZTogd2UgbXVzdCB1c2UgYSByZWFsIGVuZ2lu
ZSBjbGFzcyBmb3Igc2V0dGluZyB1cCByZWcgc3RhdGUgKi8KPiArCWVyciA9IF9fZXhlY2xpc3Rz
X2NvbnRleHRfcGluKGNlLCB2ZS0+c2libGluZ3NbMF0pOwo+ICsJaWYgKGVycikKPiArCQlyZXR1
cm4gZXJyOwo+ICsKPiArCXZpcnR1YWxfZW5naW5lX2luaXRpYWxfaGludCh2ZSk7Cj4gKwlyZXR1
cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmlydHVhbF9jb250ZXh0X2VudGVyKHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSkKPiArewo+ICsJc3RydWN0IHZpcnR1YWxfZW5naW5lICp2ZSA9
IGNvbnRhaW5lcl9vZihjZSwgdHlwZW9mKCp2ZSksIGNvbnRleHQpOwo+ICsJdW5zaWduZWQgaW50
IG47Cj4gKwo+ICsJZm9yIChuID0gMDsgbiA8IHZlLT5udW1fc2libGluZ3M7IG4rKykKPiArCQlp
bnRlbF9lbmdpbmVfcG1fZ2V0KHZlLT5zaWJsaW5nc1tuXSk7Cj4gK30KPiArCj4gK3N0YXRpYyB2
b2lkIHZpcnR1YWxfY29udGV4dF9leGl0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKPiArewo+
ICsJc3RydWN0IHZpcnR1YWxfZW5naW5lICp2ZSA9IGNvbnRhaW5lcl9vZihjZSwgdHlwZW9mKCp2
ZSksIGNvbnRleHQpOwo+ICsJdW5zaWduZWQgaW50IG47Cj4gKwo+ICsJZm9yIChuID0gMDsgbiA8
IHZlLT5udW1fc2libGluZ3M7IG4rKykKPiArCQlpbnRlbF9lbmdpbmVfcG1fcHV0KHZlLT5zaWJs
aW5nc1tuXSk7Cj4gK30KPiArCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dF9v
cHMgdmlydHVhbF9jb250ZXh0X29wcyA9IHsKPiArCS5waW4gPSB2aXJ0dWFsX2NvbnRleHRfcGlu
LAo+ICsJLnVucGluID0gZXhlY2xpc3RzX2NvbnRleHRfdW5waW4sCj4gKwo+ICsJLmVudGVyID0g
dmlydHVhbF9jb250ZXh0X2VudGVyLAo+ICsJLmV4aXQgPSB2aXJ0dWFsX2NvbnRleHRfZXhpdCwK
PiArCj4gKwkuZGVzdHJveSA9IHZpcnR1YWxfY29udGV4dF9kZXN0cm95LAo+ICt9Owo+ICsKPiAr
c3RhdGljIHZvaWQgdmlydHVhbF9zdWJtaXNzaW9uX3Rhc2tsZXQodW5zaWduZWQgbG9uZyBkYXRh
KQo+ICt7Cj4gKwlzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKiBjb25zdCB2ZSA9IChzdHJ1Y3Qgdmly
dHVhbF9lbmdpbmUgKilkYXRhOwo+ICsJY29uc3QgaW50IHByaW8gPSB2ZS0+YmFzZS5leGVjbGlz
dHMucXVldWVfcHJpb3JpdHlfaGludDsKPiArCXVuc2lnbmVkIGludCBuOwo+ICsKPiArCWxvY2Fs
X2lycV9kaXNhYmxlKCk7Cj4gKwlmb3IgKG4gPSAwOyBSRUFEX09OQ0UodmUtPnJlcXVlc3QpICYm
IG4gPCB2ZS0+bnVtX3NpYmxpbmdzOyBuKyspIHsKPiArCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICpzaWJsaW5nID0gdmUtPnNpYmxpbmdzW25dOwo+ICsJCXN0cnVjdCB2ZV9ub2RlICogY29uc3Qg
bm9kZSA9ICZ2ZS0+bm9kZXNbc2libGluZy0+aWRdOwo+ICsJCXN0cnVjdCByYl9ub2RlICoqcGFy
ZW50LCAqcmI7Cj4gKwkJYm9vbCBmaXJzdDsKPiArCj4gKwkJc3Bpbl9sb2NrKCZzaWJsaW5nLT50
aW1lbGluZS5sb2NrKTsKPiArCj4gKwkJaWYgKCFSQl9FTVBUWV9OT0RFKCZub2RlLT5yYikpIHsK
PiArCQkJLyoKPiArCQkJICogQ2hlYXQgYW5kIGF2b2lkIHJlYmFsYW5jaW5nIHRoZSB0cmVlIGlm
IHdlIGNhbgo+ICsJCQkgKiByZXVzZSB0aGlzIG5vZGUgaW4gc2l0dS4KPiArCQkJICovCj4gKwkJ
CWZpcnN0ID0gcmJfZmlyc3RfY2FjaGVkKCZzaWJsaW5nLT5leGVjbGlzdHMudmlydHVhbCkgPT0K
PiArCQkJCSZub2RlLT5yYjsKPiArCQkJaWYgKHByaW8gPT0gbm9kZS0+cHJpbyB8fCAocHJpbyA+
IG5vZGUtPnByaW8gJiYgZmlyc3QpKQo+ICsJCQkJZ290byBzdWJtaXRfZW5naW5lOwo+ICsKPiAr
CQkJcmJfZXJhc2VfY2FjaGVkKCZub2RlLT5yYiwgJnNpYmxpbmctPmV4ZWNsaXN0cy52aXJ0dWFs
KTsKPiArCQl9Cj4gKwo+ICsJCXJiID0gTlVMTDsKPiArCQlmaXJzdCA9IHRydWU7Cj4gKwkJcGFy
ZW50ID0gJnNpYmxpbmctPmV4ZWNsaXN0cy52aXJ0dWFsLnJiX3Jvb3QucmJfbm9kZTsKPiArCQl3
aGlsZSAoKnBhcmVudCkgewo+ICsJCQlzdHJ1Y3QgdmVfbm9kZSAqb3RoZXI7Cj4gKwo+ICsJCQly
YiA9ICpwYXJlbnQ7Cj4gKwkJCW90aGVyID0gcmJfZW50cnkocmIsIHR5cGVvZigqb3RoZXIpLCBy
Yik7Cj4gKwkJCWlmIChwcmlvID4gb3RoZXItPnByaW8pIHsKPiArCQkJCXBhcmVudCA9ICZyYi0+
cmJfbGVmdDsKPiArCQkJfSBlbHNlIHsKPiArCQkJCXBhcmVudCA9ICZyYi0+cmJfcmlnaHQ7Cj4g
KwkJCQlmaXJzdCA9IGZhbHNlOwo+ICsJCQl9Cj4gKwkJfQo+ICsKPiArCQlyYl9saW5rX25vZGUo
Jm5vZGUtPnJiLCByYiwgcGFyZW50KTsKPiArCQlyYl9pbnNlcnRfY29sb3JfY2FjaGVkKCZub2Rl
LT5yYiwKPiArCQkJCSAgICAgICAmc2libGluZy0+ZXhlY2xpc3RzLnZpcnR1YWwsCj4gKwkJCQkg
ICAgICAgZmlyc3QpOwo+ICsKPiArc3VibWl0X2VuZ2luZToKPiArCQlHRU1fQlVHX09OKFJCX0VN
UFRZX05PREUoJm5vZGUtPnJiKSk7Cj4gKwkJbm9kZS0+cHJpbyA9IHByaW87Cj4gKwkJaWYgKGZp
cnN0ICYmIHByaW8gPiBzaWJsaW5nLT5leGVjbGlzdHMucXVldWVfcHJpb3JpdHlfaGludCkgewo+
ICsJCQlzaWJsaW5nLT5leGVjbGlzdHMucXVldWVfcHJpb3JpdHlfaGludCA9IHByaW87Cj4gKwkJ
CXRhc2tsZXRfaGlfc2NoZWR1bGUoJnNpYmxpbmctPmV4ZWNsaXN0cy50YXNrbGV0KTsKPiArCQl9
Cj4gKwo+ICsJCXNwaW5fdW5sb2NrKCZzaWJsaW5nLT50aW1lbGluZS5sb2NrKTsKPiArCX0KPiAr
CWxvY2FsX2lycV9lbmFibGUoKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdmlydHVhbF9zdWJt
aXRfcmVxdWVzdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPiArewo+ICsJc3RydWN0IHZpcnR1
YWxfZW5naW5lICp2ZSA9IHRvX3ZpcnR1YWxfZW5naW5lKHJxLT5lbmdpbmUpOwo+ICsKPiArCUdF
TV9UUkFDRSgiJXM6IHJxPSVsbHg6JWxsZFxuIiwKPiArCQkgIHZlLT5iYXNlLm5hbWUsCj4gKwkJ
ICBycS0+ZmVuY2UuY29udGV4dCwKPiArCQkgIHJxLT5mZW5jZS5zZXFubyk7Cj4gKwo+ICsJR0VN
X0JVR19PTih2ZS0+YmFzZS5zdWJtaXRfcmVxdWVzdCAhPSB2aXJ0dWFsX3N1Ym1pdF9yZXF1ZXN0
KTsKPiArCj4gKwlHRU1fQlVHX09OKHZlLT5yZXF1ZXN0KTsKPiArCXZlLT5iYXNlLmV4ZWNsaXN0
cy5xdWV1ZV9wcmlvcml0eV9oaW50ID0gcnFfcHJpbyhycSk7Cj4gKwlXUklURV9PTkNFKHZlLT5y
ZXF1ZXN0LCBycSk7Cj4gKwo+ICsJdGFza2xldF9zY2hlZHVsZSgmdmUtPmJhc2UuZXhlY2xpc3Rz
LnRhc2tsZXQpOwo+ICt9Cj4gKwo+ICtzdHJ1Y3QgaW50ZWxfY29udGV4dCAqCj4gK2ludGVsX2V4
ZWNsaXN0c19jcmVhdGVfdmlydHVhbChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAo+ICsJ
CQkgICAgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqKnNpYmxpbmdzLAo+ICsJCQkgICAgICAg
dW5zaWduZWQgaW50IGNvdW50KQo+ICt7Cj4gKwlzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZlOwo+
ICsJdW5zaWduZWQgaW50IG47Cj4gKwlpbnQgZXJyOwo+ICsKPiArCWlmIChjb3VudCA9PSAwKQo+
ICsJCXJldHVybiBFUlJfUFRSKC1FSU5WQUwpOwo+ICsKPiArCWlmIChjb3VudCA9PSAxKQo+ICsJ
CXJldHVybiBpbnRlbF9jb250ZXh0X2NyZWF0ZShjdHgsIHNpYmxpbmdzWzBdKTsKPiArCj4gKwl2
ZSA9IGt6YWxsb2Moc3RydWN0X3NpemUodmUsIHNpYmxpbmdzLCBjb3VudCksIEdGUF9LRVJORUwp
Owo+ICsJaWYgKCF2ZSkKPiArCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKPiArCj4gKwl2ZS0+
YmFzZS5pOTE1ID0gY3R4LT5pOTE1Owo+ICsJdmUtPmJhc2UuaWQgPSAtMTsKPiArCXZlLT5iYXNl
LmNsYXNzID0gT1RIRVJfQ0xBU1M7Cj4gKwl2ZS0+YmFzZS51YWJpX2NsYXNzID0gSTkxNV9FTkdJ
TkVfQ0xBU1NfSU5WQUxJRDsKPiArCXZlLT5iYXNlLmluc3RhbmNlID0gSTkxNV9FTkdJTkVfQ0xB
U1NfSU5WQUxJRF9WSVJUVUFMOwo+ICsJdmUtPmJhc2UuZmxhZ3MgPSBJOTE1X0VOR0lORV9JU19W
SVJUVUFMOwo+ICsKPiArCXNucHJpbnRmKHZlLT5iYXNlLm5hbWUsIHNpemVvZih2ZS0+YmFzZS5u
YW1lKSwgInZpcnR1YWwiKTsKPiArCj4gKwllcnIgPSBpOTE1X3RpbWVsaW5lX2luaXQoY3R4LT5p
OTE1LCAmdmUtPmJhc2UudGltZWxpbmUsIE5VTEwpOwo+ICsJaWYgKGVycikKPiArCQlnb3RvIGVy
cl9wdXQ7Cj4gKwlpOTE1X3RpbWVsaW5lX3NldF9zdWJjbGFzcygmdmUtPmJhc2UudGltZWxpbmUs
IFRJTUVMSU5FX1ZJUlRVQUwpOwo+ICsKPiArCWludGVsX2VuZ2luZV9pbml0X2V4ZWNsaXN0cygm
dmUtPmJhc2UpOwo+ICsKPiArCXZlLT5iYXNlLmNvcHMgPSAmdmlydHVhbF9jb250ZXh0X29wczsK
PiArCXZlLT5iYXNlLnJlcXVlc3RfYWxsb2MgPSBleGVjbGlzdHNfcmVxdWVzdF9hbGxvYzsKPiAr
Cj4gKwl2ZS0+YmFzZS5zY2hlZHVsZSA9IGk5MTVfc2NoZWR1bGU7Cj4gKwl2ZS0+YmFzZS5zdWJt
aXRfcmVxdWVzdCA9IHZpcnR1YWxfc3VibWl0X3JlcXVlc3Q7Cj4gKwo+ICsJdmUtPmJhc2UuZXhl
Y2xpc3RzLnF1ZXVlX3ByaW9yaXR5X2hpbnQgPSBJTlRfTUlOOwo+ICsJdGFza2xldF9pbml0KCZ2
ZS0+YmFzZS5leGVjbGlzdHMudGFza2xldCwKPiArCQkgICAgIHZpcnR1YWxfc3VibWlzc2lvbl90
YXNrbGV0LAo+ICsJCSAgICAgKHVuc2lnbmVkIGxvbmcpdmUpOwo+ICsKPiArCWludGVsX2NvbnRl
eHRfaW5pdCgmdmUtPmNvbnRleHQsIGN0eCwgJnZlLT5iYXNlKTsKPiArCj4gKwlmb3IgKG4gPSAw
OyBuIDwgY291bnQ7IG4rKykgewo+ICsJCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKnNpYmxpbmcg
PSBzaWJsaW5nc1tuXTsKPiArCj4gKwkJR0VNX0JVR19PTighaXNfcG93ZXJfb2ZfMihzaWJsaW5n
LT5tYXNrKSk7Cj4gKwkJaWYgKHNpYmxpbmctPm1hc2sgJiB2ZS0+YmFzZS5tYXNrKSB7Cj4gKwkJ
CURSTV9ERUJVRygiZHVwbGljYXRlICVzIGVudHJ5IGluIGxvYWQgYmFsYW5jZXJcbiIsCj4gKwkJ
CQkgIHNpYmxpbmctPm5hbWUpOwo+ICsJCQllcnIgPSAtRUlOVkFMOwo+ICsJCQlnb3RvIGVycl9w
dXQ7Cj4gKwkJfQo+ICsKPiArCQkvKgo+ICsJCSAqIFRoZSB2aXJ0dWFsIGVuZ2luZSBpbXBsZW1l
bnRhdGlvbiBpcyB0aWdodGx5IGNvdXBsZWQgdG8KPiArCQkgKiB0aGUgZXhlY2xpc3RzIGJhY2tl
bmQgLS0gd2UgcHVzaCBvdXQgcmVxdWVzdCBkaXJlY3RseQo+ICsJCSAqIGludG8gYSB0cmVlIGlu
c2lkZSBlYWNoIHBoeXNpY2FsIGVuZ2luZS4gV2UgY291bGQgc3VwcG9ydAo+ICsJCSAqIGxheWVy
aW5nIGlmIHdlIGhhbmRsZSBjbG9uaW5nIG9mIHRoZSByZXF1ZXN0cyBhbmQKPiArCQkgKiBzdWJt
aXR0aW5nIGEgY29weSBpbnRvIGVhY2ggYmFja2VuZC4KPiArCQkgKi8KPiArCQlpZiAoc2libGlu
Zy0+ZXhlY2xpc3RzLnRhc2tsZXQuZnVuYyAhPQo+ICsJCSAgICBleGVjbGlzdHNfc3VibWlzc2lv
bl90YXNrbGV0KSB7Cj4gKwkJCWVyciA9IC1FTk9ERVY7Cj4gKwkJCWdvdG8gZXJyX3B1dDsKPiAr
CQl9Cj4gKwo+ICsJCUdFTV9CVUdfT04oUkJfRU1QVFlfTk9ERSgmdmUtPm5vZGVzW3NpYmxpbmct
PmlkXS5yYikpOwo+ICsJCVJCX0NMRUFSX05PREUoJnZlLT5ub2Rlc1tzaWJsaW5nLT5pZF0ucmIp
Owo+ICsKPiArCQl2ZS0+c2libGluZ3NbdmUtPm51bV9zaWJsaW5ncysrXSA9IHNpYmxpbmc7Cj4g
KwkJdmUtPmJhc2UubWFzayB8PSBzaWJsaW5nLT5tYXNrOwo+ICsKPiArCQkvKgo+ICsJCSAqIEFs
bCBwaHlzaWNhbCBlbmdpbmVzIG11c3QgYmUgY29tcGF0aWJsZSBmb3IgdGhlaXIgZW1pc3Npb24K
PiArCQkgKiBmdW5jdGlvbnMgKGFzIHdlIGJ1aWxkIHRoZSBpbnN0cnVjdGlvbnMgZHVyaW5nIHJl
cXVlc3QKPiArCQkgKiBjb25zdHJ1Y3Rpb24gYW5kIGRvIG5vdCBhbHRlciB0aGVtIGJlZm9yZSBz
dWJtaXNzaW9uCj4gKwkJICogb24gdGhlIHBoeXNpY2FsIGVuZ2luZSkuIFdlIHVzZSB0aGUgZW5n
aW5lIGNsYXNzIGFzIGEgZ3VpZGUKPiArCQkgKiBoZXJlLCBhbHRob3VnaCB0aGF0IGNvdWxkIGJl
IHJlZmluZWQuCj4gKwkJICovCj4gKwkJaWYgKHZlLT5iYXNlLmNsYXNzICE9IE9USEVSX0NMQVNT
KSB7Cj4gKwkJCWlmICh2ZS0+YmFzZS5jbGFzcyAhPSBzaWJsaW5nLT5jbGFzcykgewo+ICsJCQkJ
RFJNX0RFQlVHKCJpbnZhbGlkIG1peGluZyBvZiBlbmdpbmUgY2xhc3MsIHNpYmxpbmcgJWQsIGFs
cmVhZHkgJWRcbiIsCj4gKwkJCQkJICBzaWJsaW5nLT5jbGFzcywgdmUtPmJhc2UuY2xhc3MpOwo+
ICsJCQkJZXJyID0gLUVJTlZBTDsKPiArCQkJCWdvdG8gZXJyX3B1dDsKPiArCQkJfQo+ICsJCQlj
b250aW51ZTsKPiArCQl9Cj4gKwo+ICsJCXZlLT5iYXNlLmNsYXNzID0gc2libGluZy0+Y2xhc3M7
Cj4gKwkJdmUtPmJhc2UudWFiaV9jbGFzcyA9IHNpYmxpbmctPnVhYmlfY2xhc3M7Cj4gKwkJc25w
cmludGYodmUtPmJhc2UubmFtZSwgc2l6ZW9mKHZlLT5iYXNlLm5hbWUpLAo+ICsJCQkgInYlZHgl
ZCIsIHZlLT5iYXNlLmNsYXNzLCBjb3VudCk7Cj4gKwkJdmUtPmJhc2UuY29udGV4dF9zaXplID0g
c2libGluZy0+Y29udGV4dF9zaXplOwo+ICsKPiArCQl2ZS0+YmFzZS5lbWl0X2JiX3N0YXJ0ID0g
c2libGluZy0+ZW1pdF9iYl9zdGFydDsKPiArCQl2ZS0+YmFzZS5lbWl0X2ZsdXNoID0gc2libGlu
Zy0+ZW1pdF9mbHVzaDsKPiArCQl2ZS0+YmFzZS5lbWl0X2luaXRfYnJlYWRjcnVtYiA9IHNpYmxp
bmctPmVtaXRfaW5pdF9icmVhZGNydW1iOwo+ICsJCXZlLT5iYXNlLmVtaXRfZmluaV9icmVhZGNy
dW1iID0gc2libGluZy0+ZW1pdF9maW5pX2JyZWFkY3J1bWI7Cj4gKwkJdmUtPmJhc2UuZW1pdF9m
aW5pX2JyZWFkY3J1bWJfZHcgPQo+ICsJCQlzaWJsaW5nLT5lbWl0X2ZpbmlfYnJlYWRjcnVtYl9k
dzsKPiArCX0KPiArCj4gKwlyZXR1cm4gJnZlLT5jb250ZXh0Owo+ICsKPiArZXJyX3B1dDoKPiAr
CWludGVsX2NvbnRleHRfcHV0KCZ2ZS0+Y29udGV4dCk7Cj4gKwlyZXR1cm4gRVJSX1BUUihlcnIp
Owo+ICt9Cj4gKwo+ICtzdHJ1Y3QgaW50ZWxfY29udGV4dCAqCj4gK2ludGVsX2V4ZWNsaXN0c19j
bG9uZV92aXJ0dWFsKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCj4gKwkJCSAgICAgIHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKnNyYykKPiArewo+ICsJc3RydWN0IHZpcnR1YWxfZW5naW5l
ICpzZSA9IHRvX3ZpcnR1YWxfZW5naW5lKHNyYyk7Cj4gKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
ZHN0Owo+ICsKPiArCWRzdCA9IGludGVsX2V4ZWNsaXN0c19jcmVhdGVfdmlydHVhbChjdHgsCj4g
KwkJCQkJICAgICBzZS0+c2libGluZ3MsCj4gKwkJCQkJICAgICBzZS0+bnVtX3NpYmxpbmdzKTsK
PiArCWlmIChJU19FUlIoZHN0KSkKPiArCQlyZXR1cm4gZHN0Owo+ICsKPiArCXJldHVybiBkc3Q7
Cj4gK30KPiArCj4gICB2b2lkIGludGVsX2V4ZWNsaXN0c19zaG93X3JlcXVlc3RzKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKPiAgIAkJCQkgICBzdHJ1Y3QgZHJtX3ByaW50ZXIgKm0s
Cj4gICAJCQkJICAgdm9pZCAoKnNob3dfcmVxdWVzdCkoc3RydWN0IGRybV9wcmludGVyICptLAo+
IEBAIC0yODE3LDYgKzM0MTAsMjkgQEAgdm9pZCBpbnRlbF9leGVjbGlzdHNfc2hvd19yZXF1ZXN0
cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCj4gICAJCXNob3dfcmVxdWVzdChtLCBs
YXN0LCAiXHRcdFEgIik7Cj4gICAJfQo+ICAgCj4gKwlsYXN0ID0gTlVMTDsKPiArCWNvdW50ID0g
MDsKPiArCWZvciAocmIgPSByYl9maXJzdF9jYWNoZWQoJmV4ZWNsaXN0cy0+dmlydHVhbCk7IHJi
OyByYiA9IHJiX25leHQocmIpKSB7Cj4gKwkJc3RydWN0IHZpcnR1YWxfZW5naW5lICp2ZSA9Cj4g
KwkJCXJiX2VudHJ5KHJiLCB0eXBlb2YoKnZlKSwgbm9kZXNbZW5naW5lLT5pZF0ucmIpOwo+ICsJ
CXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxID0gUkVBRF9PTkNFKHZlLT5yZXF1ZXN0KTsKPiArCj4g
KwkJaWYgKHJxKSB7Cj4gKwkJCWlmIChjb3VudCsrIDwgbWF4IC0gMSkKPiArCQkJCXNob3dfcmVx
dWVzdChtLCBycSwgIlx0XHRWICIpOwo+ICsJCQllbHNlCj4gKwkJCQlsYXN0ID0gcnE7Cj4gKwkJ
fQo+ICsJfQo+ICsJaWYgKGxhc3QpIHsKPiArCQlpZiAoY291bnQgPiBtYXgpIHsKPiArCQkJZHJt
X3ByaW50ZihtLAo+ICsJCQkJICAgIlx0XHQuLi5za2lwcGluZyAlZCB2aXJ0dWFsIHJlcXVlc3Rz
Li4uXG4iLAo+ICsJCQkJICAgY291bnQgLSBtYXgpOwo+ICsJCX0KPiArCQlzaG93X3JlcXVlc3Qo
bSwgbGFzdCwgIlx0XHRWICIpOwo+ICsJfQo+ICsKPiAgIAlzcGluX3VubG9ja19pcnFyZXN0b3Jl
KCZlbmdpbmUtPnRpbWVsaW5lLmxvY2ssIGZsYWdzKTsKPiAgIH0KPiAgIAo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2xyYy5oCj4gaW5kZXggYTBkYzkwN2E3MjQ5Li41NTMwNjA2MDUyZTUgMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmgKPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuaAo+IEBAIC0xMTQsNCArMTE0LDEzIEBA
IHZvaWQgaW50ZWxfZXhlY2xpc3RzX3Nob3dfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lLAo+ICAgCQkJCQkJCWNvbnN0IGNoYXIgKnByZWZpeCksCj4gICAJCQkJICAgdW5z
aWduZWQgaW50IG1heCk7Cj4gICAKPiArc3RydWN0IGludGVsX2NvbnRleHQgKgo+ICtpbnRlbF9l
eGVjbGlzdHNfY3JlYXRlX3ZpcnR1YWwoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKPiAr
CQkJICAgICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKipzaWJsaW5ncywKPiArCQkJICAgICAg
IHVuc2lnbmVkIGludCBjb3VudCk7Cj4gKwo+ICtzdHJ1Y3QgaW50ZWxfY29udGV4dCAqCj4gK2lu
dGVsX2V4ZWNsaXN0c19jbG9uZV92aXJ0dWFsKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgs
Cj4gKwkJCSAgICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKnNyYyk7Cj4gKwo+ICAgI2VuZGlm
IC8qIF9JTlRFTF9MUkNfSF8gKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3Qvc2VsZnRlc3RfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMu
Ywo+IGluZGV4IDZmMjIzZjdmYWNkZS4uNTU4Mzk5ZTVjN2JiIDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKPiBAQCAtMTMwMSw2ICsxMzAxLDE4NSBAQCBzdGF0aWMg
aW50IGxpdmVfcHJlZW1wdF9zbW9rZSh2b2lkICphcmcpCj4gICAJcmV0dXJuIGVycjsKPiAgIH0K
PiAgIAo+ICtzdGF0aWMgaW50IG5vcF92aXJ0dWFsX2VuZ2luZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKPiArCQkJICAgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqKnNpYmxpbmdz
LAo+ICsJCQkgICAgICB1bnNpZ25lZCBpbnQgbnNpYmxpbmcsCj4gKwkJCSAgICAgIHVuc2lnbmVk
IGludCBuY3R4LAo+ICsJCQkgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpCj4gKyNkZWZpbmUgQ0hB
SU4gQklUKDApCj4gK3sKPiArCUlHVF9USU1FT1VUKGVuZF90aW1lKTsKPiArCXN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJlcXVlc3RbMTZdOwo+ICsJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eFsx
Nl07Cj4gKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqdmVbMTZdOwo+ICsJdW5zaWduZWQgbG9uZyBu
LCBwcmltZSwgbmM7Cj4gKwlzdHJ1Y3QgaWd0X2xpdmVfdGVzdCB0Owo+ICsJa3RpbWVfdCB0aW1l
c1syXSA9IHt9Owo+ICsJaW50IGVycjsKPiArCj4gKwlHRU1fQlVHX09OKCFuY3R4IHx8IG5jdHgg
PiBBUlJBWV9TSVpFKGN0eCkpOwo+ICsKPiArCWZvciAobiA9IDA7IG4gPCBuY3R4OyBuKyspIHsK
PiArCQljdHhbbl0gPSBrZXJuZWxfY29udGV4dChpOTE1KTsKPiArCQlpZiAoIWN0eFtuXSkgewo+
ICsJCQllcnIgPSAtRU5PTUVNOwo+ICsJCQluY3R4ID0gbjsKPiArCQkJZ290byBvdXQ7Cj4gKwkJ
fQo+ICsKPiArCQl2ZVtuXSA9IGludGVsX2V4ZWNsaXN0c19jcmVhdGVfdmlydHVhbChjdHhbbl0s
Cj4gKwkJCQkJCSAgICAgICBzaWJsaW5ncywgbnNpYmxpbmcpOwo+ICsJCWlmIChJU19FUlIodmVb
bl0pKSB7Cj4gKwkJCWtlcm5lbF9jb250ZXh0X2Nsb3NlKGN0eFtuXSk7Cj4gKwkJCWVyciA9IFBU
Ul9FUlIodmVbbl0pOwo+ICsJCQluY3R4ID0gbjsKPiArCQkJZ290byBvdXQ7Cj4gKwkJfQo+ICsK
PiArCQllcnIgPSBpbnRlbF9jb250ZXh0X3Bpbih2ZVtuXSk7Cj4gKwkJaWYgKGVycikgewo+ICsJ
CQlpbnRlbF9jb250ZXh0X3B1dCh2ZVtuXSk7Cj4gKwkJCWtlcm5lbF9jb250ZXh0X2Nsb3NlKGN0
eFtuXSk7Cj4gKwkJCW5jdHggPSBuOwo+ICsJCQlnb3RvIG91dDsKPiArCQl9Cj4gKwl9Cj4gKwo+
ICsJZXJyID0gaWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19mdW5jX18sIHZlWzBdLT5l
bmdpbmUtPm5hbWUpOwo+ICsJaWYgKGVycikKPiArCQlnb3RvIG91dDsKPiArCj4gKwlmb3JfZWFj
aF9wcmltZV9udW1iZXJfZnJvbShwcmltZSwgMSwgODE5Mikgewo+ICsJCXRpbWVzWzFdID0ga3Rp
bWVfZ2V0X3JhdygpOwo+ICsKPiArCQlpZiAoZmxhZ3MgJiBDSEFJTikgewo+ICsJCQlmb3IgKG5j
ID0gMDsgbmMgPCBuY3R4OyBuYysrKSB7Cj4gKwkJCQlmb3IgKG4gPSAwOyBuIDwgcHJpbWU7IG4r
Kykgewo+ICsJCQkJCXJlcXVlc3RbbmNdID0KPiArCQkJCQkJaTkxNV9yZXF1ZXN0X2NyZWF0ZSh2
ZVtuY10pOwo+ICsJCQkJCWlmIChJU19FUlIocmVxdWVzdFtuY10pKSB7Cj4gKwkJCQkJCWVyciA9
IFBUUl9FUlIocmVxdWVzdFtuY10pOwo+ICsJCQkJCQlnb3RvIG91dDsKPiArCQkJCQl9Cj4gKwo+
ICsJCQkJCWk5MTVfcmVxdWVzdF9hZGQocmVxdWVzdFtuY10pOwo+ICsJCQkJfQo+ICsJCQl9Cj4g
KwkJfSBlbHNlIHsKPiArCQkJZm9yIChuID0gMDsgbiA8IHByaW1lOyBuKyspIHsKPiArCQkJCWZv
ciAobmMgPSAwOyBuYyA8IG5jdHg7IG5jKyspIHsKPiArCQkJCQlyZXF1ZXN0W25jXSA9Cj4gKwkJ
CQkJCWk5MTVfcmVxdWVzdF9jcmVhdGUodmVbbmNdKTsKPiArCQkJCQlpZiAoSVNfRVJSKHJlcXVl
c3RbbmNdKSkgewo+ICsJCQkJCQllcnIgPSBQVFJfRVJSKHJlcXVlc3RbbmNdKTsKPiArCQkJCQkJ
Z290byBvdXQ7Cj4gKwkJCQkJfQo+ICsKPiArCQkJCQlpOTE1X3JlcXVlc3RfYWRkKHJlcXVlc3Rb
bmNdKTsKPiArCQkJCX0KPiArCQkJfQo+ICsJCX0KPiArCj4gKwkJZm9yIChuYyA9IDA7IG5jIDwg
bmN0eDsgbmMrKykgewo+ICsJCQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocmVxdWVzdFtuY10sCj4g
KwkJCQkJICAgICAgSTkxNV9XQUlUX0xPQ0tFRCwKPiArCQkJCQkgICAgICBIWiAvIDEwKSA8IDAp
IHsKPiArCQkJCXByX2VycigiJXMoJXMpOiB3YWl0IGZvciAlbGx4OiVsbGQgdGltZWQgb3V0XG4i
LAo+ICsJCQkJICAgICAgIF9fZnVuY19fLCB2ZVswXS0+ZW5naW5lLT5uYW1lLAo+ICsJCQkJICAg
ICAgIHJlcXVlc3RbbmNdLT5mZW5jZS5jb250ZXh0LAo+ICsJCQkJICAgICAgIHJlcXVlc3RbbmNd
LT5mZW5jZS5zZXFubyk7Cj4gKwo+ICsJCQkJR0VNX1RSQUNFKCIlcyglcykgZmFpbGVkIGF0IHJl
cXVlc3QgJWxseDolbGxkXG4iLAo+ICsJCQkJCSAgX19mdW5jX18sIHZlWzBdLT5lbmdpbmUtPm5h
bWUsCj4gKwkJCQkJICByZXF1ZXN0W25jXS0+ZmVuY2UuY29udGV4dCwKPiArCQkJCQkgIHJlcXVl
c3RbbmNdLT5mZW5jZS5zZXFubyk7Cj4gKwkJCQlHRU1fVFJBQ0VfRFVNUCgpOwo+ICsJCQkJaTkx
NV9nZW1fc2V0X3dlZGdlZChpOTE1KTsKPiArCQkJCWJyZWFrOwo+ICsJCQl9Cj4gKwkJfQo+ICsK
PiArCQl0aW1lc1sxXSA9IGt0aW1lX3N1YihrdGltZV9nZXRfcmF3KCksIHRpbWVzWzFdKTsKPiAr
CQlpZiAocHJpbWUgPT0gMSkKPiArCQkJdGltZXNbMF0gPSB0aW1lc1sxXTsKPiArCj4gKwkJaWYg
KF9faWd0X3RpbWVvdXQoZW5kX3RpbWUsIE5VTEwpKQo+ICsJCQlicmVhazsKPiArCX0KPiArCj4g
KwllcnIgPSBpZ3RfbGl2ZV90ZXN0X2VuZCgmdCk7Cj4gKwlpZiAoZXJyKQo+ICsJCWdvdG8gb3V0
Owo+ICsKPiArCXByX2luZm8oIlJlcXVlc3R4JWQgbGF0ZW5jaWVzIG9uICVzOiAxID0gJWxsdW5z
LCAlbHUgPSAlbGx1bnNcbiIsCj4gKwkJbmN0eCwgdmVbMF0tPmVuZ2luZS0+bmFtZSwga3RpbWVf
dG9fbnModGltZXNbMF0pLAo+ICsJCXByaW1lLCBkaXY2NF91NjQoa3RpbWVfdG9fbnModGltZXNb
MV0pLCBwcmltZSkpOwo+ICsKPiArb3V0Ogo+ICsJaWYgKGlndF9mbHVzaF90ZXN0KGk5MTUsIEk5
MTVfV0FJVF9MT0NLRUQpKQo+ICsJCWVyciA9IC1FSU87Cj4gKwo+ICsJZm9yIChuYyA9IDA7IG5j
IDwgbmN0eDsgbmMrKykgewo+ICsJCWludGVsX2NvbnRleHRfdW5waW4odmVbbmNdKTsKPiArCQlp
bnRlbF9jb250ZXh0X3B1dCh2ZVtuY10pOwo+ICsJCWtlcm5lbF9jb250ZXh0X2Nsb3NlKGN0eFtu
Y10pOwo+ICsJfQo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIGludCBsaXZlX3Zp
cnR1YWxfZW5naW5lKHZvaWQgKmFyZykKPiArewo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBhcmc7Cj4gKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpzaWJsaW5nc1tNQVhfRU5H
SU5FX0lOU1RBTkNFICsgMV07Cj4gKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Cj4g
KwllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKPiArCXVuc2lnbmVkIGludCBjbGFzcywgaW5zdDsK
PiArCWludCBlcnIgPSAtRU5PREVWOwo+ICsKPiArCWlmIChVU0VTX0dVQ19TVUJNSVNTSU9OKGk5
MTUpKQo+ICsJCXJldHVybiAwOwo+ICsKPiArCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwo+ICsKPiArCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKSB7Cj4gKwkJ
ZXJyID0gbm9wX3ZpcnR1YWxfZW5naW5lKGk5MTUsICZlbmdpbmUsIDEsIDEsIDApOwo+ICsJCWlm
IChlcnIpIHsKPiArCQkJcHJfZXJyKCJGYWlsZWQgdG8gd3JhcCBlbmdpbmUgJXM6IGVycj0lZFxu
IiwKPiArCQkJICAgICAgIGVuZ2luZS0+bmFtZSwgZXJyKTsKPiArCQkJZ290byBvdXRfdW5sb2Nr
Owo+ICsJCX0KPiArCX0KPiArCj4gKwlmb3IgKGNsYXNzID0gMDsgY2xhc3MgPD0gTUFYX0VOR0lO
RV9DTEFTUzsgY2xhc3MrKykgewo+ICsJCWludCBuc2libGluZywgbjsKPiArCj4gKwkJbnNpYmxp
bmcgPSAwOwo+ICsJCWZvciAoaW5zdCA9IDA7IGluc3QgPD0gTUFYX0VOR0lORV9JTlNUQU5DRTsg
aW5zdCsrKSB7Cj4gKwkJCWlmICghaTkxNS0+ZW5naW5lX2NsYXNzW2NsYXNzXVtpbnN0XSkKPiAr
CQkJCWJyZWFrOwo+ICsKPiArCQkJc2libGluZ3NbbnNpYmxpbmcrK10gPSBpOTE1LT5lbmdpbmVf
Y2xhc3NbY2xhc3NdW2luc3RdOwo+ICsJCX0KPiArCQlpZiAobnNpYmxpbmcgPCAyKQo+ICsJCQlj
b250aW51ZTsKPiArCj4gKwkJZm9yIChuID0gMTsgbiA8PSBuc2libGluZyArIDE7IG4rKykgewo+
ICsJCQllcnIgPSBub3BfdmlydHVhbF9lbmdpbmUoaTkxNSwgc2libGluZ3MsIG5zaWJsaW5nLAo+
ICsJCQkJCQkgbiwgMCk7Cj4gKwkJCWlmIChlcnIpCj4gKwkJCQlnb3RvIG91dF91bmxvY2s7Cj4g
KwkJfQo+ICsKPiArCQllcnIgPSBub3BfdmlydHVhbF9lbmdpbmUoaTkxNSwgc2libGluZ3MsIG5z
aWJsaW5nLCBuLCBDSEFJTik7Cj4gKwkJaWYgKGVycikKPiArCQkJZ290byBvdXRfdW5sb2NrOwo+
ICsJfQo+ICsKPiArb3V0X3VubG9jazoKPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7Cj4gKwlyZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICAgaW50IGludGVsX2V4ZWNsaXN0
c19saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKPiAgIHsKPiAg
IAlzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfc3VidGVzdCB0ZXN0c1tdID0gewo+IEBAIC0xMzEz
LDYgKzE0OTIsNyBAQCBpbnQgaW50ZWxfZXhlY2xpc3RzX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgCQlTVUJURVNUKGxpdmVfY2hhaW5fcHJlZW1wdCks
Cj4gICAJCVNVQlRFU1QobGl2ZV9wcmVlbXB0X2hhbmcpLAo+ICAgCQlTVUJURVNUKGxpdmVfcHJl
ZW1wdF9zbW9rZSksCj4gKwkJU1VCVEVTVChsaXZlX3ZpcnR1YWxfZW5naW5lKSwKPiAgIAl9Owo+
ICAgCj4gICAJaWYgKCFIQVNfRVhFQ0xJU1RTKGk5MTUpKQo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0u
aAo+IGluZGV4IDY3ZjhhNGE4MDdhMC4uZmU4MmQzNTcxMDcyIDEwMDY0NAo+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbS5oCj4gQEAgLTkxLDQgKzkxLDkgQEAgc3RhdGljIGlubGluZSBib29sIF9fdGFza2xl
dF9lbmFibGUoc3RydWN0IHRhc2tsZXRfc3RydWN0ICp0KQo+ICAgCXJldHVybiBhdG9taWNfZGVj
X2FuZF90ZXN0KCZ0LT5jb3VudCk7Cj4gICB9Cj4gICAKPiArc3RhdGljIGlubGluZSBib29sIF9f
dGFza2xldF9pc19zY2hlZHVsZWQoc3RydWN0IHRhc2tsZXRfc3RydWN0ICp0KQo+ICt7Cj4gKwly
ZXR1cm4gdGVzdF9iaXQoVEFTS0xFVF9TVEFURV9TQ0hFRCwgJnQtPnN0YXRlKTsKPiArfQo+ICsK
PiAgICNlbmRpZiAvKiBfX0k5MTVfR0VNX0hfXyAqLwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dlbV9jb250ZXh0LmMKPiBpbmRleCBiYTc1ODJkOTU1ZDEuLjU3YjA5ZjYyNGJiNCAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9jb250ZXh0LmMKPiArKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9jb250ZXh0LmMKPiBAQCAtODYsNiArODYsNyBA
QAo+ICAgICovCj4gICAKPiAgICNpbmNsdWRlIDxsaW51eC9sb2cyLmg+Cj4gKyNpbmNsdWRlIDxs
aW51eC9ub3NwZWMuaD4KPiAgIAo+ICAgI2luY2x1ZGUgPGRybS9pOTE1X2RybS5oPgo+ICAgCj4g
QEAgLTEyMDksNyArMTIxMCw2IEBAIF9faW50ZWxfY29udGV4dF9yZWNvbmZpZ3VyZV9zc2V1KHN0
cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKPiAgIAlpbnQgcmV0Owo+ICAgCj4gICAJR0VNX0JVR19P
TihJTlRFTF9HRU4oY2UtPmdlbV9jb250ZXh0LT5pOTE1KSA8IDgpOwo+IC0JR0VNX0JVR19PTihj
ZS0+ZW5naW5lLT5pZCAhPSBSQ1MwKTsKPiAgIAo+ICAgCXJldCA9IGludGVsX2NvbnRleHRfbG9j
a19waW5uZWQoY2UpOwo+ICAgCWlmIChyZXQpCj4gQEAgLTEzOTcsNyArMTM5NywxMDIgQEAgc3Ry
dWN0IHNldF9lbmdpbmVzIHsKPiAgIAlzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lcyAqZW5naW5lczsK
PiAgIH07Cj4gICAKPiArc3RhdGljIGludAo+ICtzZXRfZW5naW5lc19fbG9hZF9iYWxhbmNlKHN0
cnVjdCBpOTE1X3VzZXJfZXh0ZW5zaW9uIF9fdXNlciAqYmFzZSwgdm9pZCAqZGF0YSkKPiArewo+
ICsJc3RydWN0IGk5MTVfY29udGV4dF9lbmdpbmVzX2xvYWRfYmFsYW5jZSBfX3VzZXIgKmV4dCA9
Cj4gKwkJY29udGFpbmVyX29mX3VzZXIoYmFzZSwgdHlwZW9mKCpleHQpLCBiYXNlKTsKPiArCWNv
bnN0IHN0cnVjdCBzZXRfZW5naW5lcyAqc2V0ID0gZGF0YTsKPiArCXN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKnN0YWNrWzE2XTsKPiArCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKipzaWJsaW5nczsK
PiArCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKPiArCXUxNiBudW1fc2libGluZ3MsIGlkeDsK
PiArCXVuc2lnbmVkIGludCBuOwo+ICsJaW50IGVycjsKPiArCj4gKwlpZiAoIUhBU19FWEVDTElT
VFMoc2V0LT5jdHgtPmk5MTUpKQo+ICsJCXJldHVybiAtRU5PREVWOwo+ICsKPiArCWlmIChVU0VT
X0dVQ19TVUJNSVNTSU9OKHNldC0+Y3R4LT5pOTE1KSkKPiArCQlyZXR1cm4gLUVOT0RFVjsgLyog
bm90IGltcGxlbWVudCB5ZXQgKi8KPiArCj4gKwlpZiAoZ2V0X3VzZXIoaWR4LCAmZXh0LT5lbmdp
bmVfaW5kZXgpKQo+ICsJCXJldHVybiAtRUZBVUxUOwo+ICsKPiArCWlmIChpZHggPj0gc2V0LT5l
bmdpbmVzLT5udW1fZW5naW5lcykgewo+ICsJCURSTV9ERUJVRygiSW52YWxpZCBwbGFjZW1lbnQg
dmFsdWUsICVkID49ICVkXG4iLAo+ICsJCQkgIGlkeCwgc2V0LT5lbmdpbmVzLT5udW1fZW5naW5l
cyk7Cj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwl9Cj4gKwo+ICsJaWR4ID0gYXJyYXlfaW5kZXhf
bm9zcGVjKGlkeCwgc2V0LT5lbmdpbmVzLT5udW1fZW5naW5lcyk7Cj4gKwlpZiAoc2V0LT5lbmdp
bmVzLT5lbmdpbmVzW2lkeF0pIHsKPiArCQlEUk1fREVCVUcoIkludmFsaWQgcGxhY2VtZW50WyVk
XSwgYWxyZWFkeSBvY2N1cGllZFxuIiwgaWR4KTsKPiArCQlyZXR1cm4gLUVFWElTVDsKPiArCX0K
PiArCj4gKwlpZiAoZ2V0X3VzZXIobnVtX3NpYmxpbmdzLCAmZXh0LT5udW1fc2libGluZ3MpKQo+
ICsJCXJldHVybiAtRUZBVUxUOwo+ICsKPiArCWVyciA9IGNoZWNrX3VzZXJfbWJ6KCZleHQtPmZs
YWdzKTsKPiArCWlmIChlcnIpCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwlmb3IgKG4gPSAwOyBu
IDwgQVJSQVlfU0laRShleHQtPm1iejY0KTsgbisrKSB7Cj4gKwkJZXJyID0gY2hlY2tfdXNlcl9t
YnooJmV4dC0+bWJ6NjRbbl0pOwo+ICsJCWlmIChlcnIpCj4gKwkJCXJldHVybiBlcnI7Cj4gKwl9
Cj4gKwo+ICsJc2libGluZ3MgPSBzdGFjazsKPiArCWlmIChudW1fc2libGluZ3MgPiBBUlJBWV9T
SVpFKHN0YWNrKSkgewo+ICsJCXNpYmxpbmdzID0ga21hbGxvY19hcnJheShudW1fc2libGluZ3Ms
Cj4gKwkJCQkJIHNpemVvZigqc2libGluZ3MpLAo+ICsJCQkJCSBHRlBfS0VSTkVMKTsKPiArCQlp
ZiAoIXNpYmxpbmdzKQo+ICsJCQlyZXR1cm4gLUVOT01FTTsKPiArCX0KPiArCj4gKwlmb3IgKG4g
PSAwOyBuIDwgbnVtX3NpYmxpbmdzOyBuKyspIHsKPiArCQlzdHJ1Y3QgaTkxNV9lbmdpbmVfY2xh
c3NfaW5zdGFuY2UgY2k7Cj4gKwo+ICsJCWlmIChjb3B5X2Zyb21fdXNlcigmY2ksICZleHQtPmVu
Z2luZXNbbl0sIHNpemVvZihjaSkpKSB7Cj4gKwkJCWVyciA9IC1FRkFVTFQ7Cj4gKwkJCWdvdG8g
b3V0X3NpYmxpbmdzOwo+ICsJCX0KPiArCj4gKwkJc2libGluZ3Nbbl0gPSBpbnRlbF9lbmdpbmVf
bG9va3VwX3VzZXIoc2V0LT5jdHgtPmk5MTUsCj4gKwkJCQkJCSAgICAgICBjaS5lbmdpbmVfY2xh
c3MsCj4gKwkJCQkJCSAgICAgICBjaS5lbmdpbmVfaW5zdGFuY2UpOwo+ICsJCWlmICghc2libGlu
Z3Nbbl0pIHsKPiArCQkJRFJNX0RFQlVHKCJJbnZhbGlkIHNpYmxpbmdbJWRdOiB7IGNsYXNzOiVk
LCBpbnN0OiVkIH1cbiIsCj4gKwkJCQkgIG4sIGNpLmVuZ2luZV9jbGFzcywgY2kuZW5naW5lX2lu
c3RhbmNlKTsKPiArCQkJZXJyID0gLUVJTlZBTDsKPiArCQkJZ290byBvdXRfc2libGluZ3M7Cj4g
KwkJfQo+ICsJfQo+ICsKPiArCWNlID0gaW50ZWxfZXhlY2xpc3RzX2NyZWF0ZV92aXJ0dWFsKHNl
dC0+Y3R4LCBzaWJsaW5ncywgbik7Cj4gKwlpZiAoSVNfRVJSKGNlKSkgewo+ICsJCWVyciA9IFBU
Ul9FUlIoY2UpOwo+ICsJCWdvdG8gb3V0X3NpYmxpbmdzOwo+ICsJfQo+ICsKPiArCWlmIChjbXB4
Y2hnKCZzZXQtPmVuZ2luZXMtPmVuZ2luZXNbaWR4XSwgTlVMTCwgY2UpKSB7Cj4gKwkJaW50ZWxf
Y29udGV4dF9wdXQoY2UpOwo+ICsJCWVyciA9IC1FRVhJU1Q7Cj4gKwkJZ290byBvdXRfc2libGlu
Z3M7Cj4gKwl9Cj4gKwo+ICtvdXRfc2libGluZ3M6Cj4gKwlpZiAoc2libGluZ3MgIT0gc3RhY2sp
Cj4gKwkJa2ZyZWUoc2libGluZ3MpOwo+ICsKPiArCXJldHVybiBlcnI7Cj4gK30KPiArCj4gICBz
dGF0aWMgY29uc3QgaTkxNV91c2VyX2V4dGVuc2lvbl9mbiBzZXRfZW5naW5lc19fZXh0ZW5zaW9u
c1tdID0gewo+ICsJW0k5MTVfQ09OVEVYVF9FTkdJTkVTX0VYVF9MT0FEX0JBTEFOQ0VdID0gc2V0
X2VuZ2luZXNfX2xvYWRfYmFsYW5jZSwKPiAgIH07Cj4gICAKPiAgIHN0YXRpYyBpbnQKPiBAQCAt
MTY5NiwxNCArMTc5MSwyOSBAQCBzdGF0aWMgaW50IGNsb25lX2VuZ2luZXMoc3RydWN0IGk5MTVf
Z2VtX2NvbnRleHQgKmRzdCwKPiAgIAo+ICAgCWNsb25lLT5pOTE1ID0gZHN0LT5pOTE1Owo+ICAg
CWZvciAobiA9IDA7IG4gPCBlLT5udW1fZW5naW5lczsgbisrKSB7Cj4gKwkJc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lOwo+ICsKPiAgIAkJaWYgKCFlLT5lbmdpbmVzW25dKSB7Cj4gICAJ
CQljbG9uZS0+ZW5naW5lc1tuXSA9IE5VTEw7Cj4gICAJCQljb250aW51ZTsKPiAgIAkJfQo+ICsJ
CWVuZ2luZSA9IGUtPmVuZ2luZXNbbl0tPmVuZ2luZTsKPiAgIAo+IC0JCWNsb25lLT5lbmdpbmVz
W25dID0KPiAtCQkJaW50ZWxfY29udGV4dF9jcmVhdGUoZHN0LCBlLT5lbmdpbmVzW25dLT5lbmdp
bmUpOwo+IC0JCWlmICghY2xvbmUtPmVuZ2luZXNbbl0pIHsKPiArCQkvKgo+ICsJCSAqIFZpcnR1
YWwgZW5naW5lcyBhcmUgc2luZ2xldG9uczsgdGhleSBjYW4gb25seSBleGlzdAo+ICsJCSAqIGlu
c2lkZSBhIHNpbmdsZSBjb250ZXh0LCBiZWNhdXNlIHRoZXkgZW1iZWQgdGhlaXIKPiArCQkgKiBI
VyBjb250ZXh0Li4uIEFzIGVhY2ggdmlydHVhbCBjb250ZXh0IGltcGxpZXMgYSBzaW5nbGUKPiAr
CQkgKiB0aW1lbGluZSAoZWFjaCBlbmdpbmUgY2FuIG9ubHkgZGVxdWV1ZSBhIHNpbmdsZSByZXF1
ZXN0Cj4gKwkJICogYXQgYW55IHRpbWUpLCBpdCB3b3VsZCBiZSBzdXJwcmlzaW5nIGZvciB0d28g
Y29udGV4dHMKPiArCQkgKiB0byB1c2UgdGhlIHNhbWUgZW5naW5lLiBTbyBsZXQncyBjcmVhdGUg
YSBjb3B5IG9mCj4gKwkJICogdGhlIHZpcnR1YWwgZW5naW5lIGluc3RlYWQuCj4gKwkJICovCj4g
KwkJaWYgKGludGVsX2VuZ2luZV9pc192aXJ0dWFsKGVuZ2luZSkpCj4gKwkJCWNsb25lLT5lbmdp
bmVzW25dID0KPiArCQkJCWludGVsX2V4ZWNsaXN0c19jbG9uZV92aXJ0dWFsKGRzdCwgZW5naW5l
KTsKPiArCQllbHNlCj4gKwkJCWNsb25lLT5lbmdpbmVzW25dID0gaW50ZWxfY29udGV4dF9jcmVh
dGUoZHN0LCBlbmdpbmUpOwo+ICsJCWlmIChJU19FUlJfT1JfTlVMTChjbG9uZS0+ZW5naW5lc1tu
XSkpIHsKPiAgIAkJCV9fZnJlZV9lbmdpbmVzKGNsb25lLCBuKTsKPiAgIAkJCWdvdG8gZXJyX3Vu
bG9jazsKPiAgIAkJfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Nj
aGVkdWxlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVsZXIuYwo+IGluZGV4
IDM5YmM0ZjU0ZTI3Mi4uYjU4ZDljMjNhODc2IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfc2NoZWR1bGVyLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3NjaGVkdWxlci5jCj4gQEAgLTI0OCwxNyArMjQ4LDI2IEBAIHNjaGVkX2xvY2tfZW5naW5lKGNv
bnN0IHN0cnVjdCBpOTE1X3NjaGVkX25vZGUgKm5vZGUsCj4gICAJCSAgc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqbG9ja2VkLAo+ICAgCQkgIHN0cnVjdCBzY2hlZF9jYWNoZSAqY2FjaGUpCj4gICB7
Cj4gLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUgPSBub2RlX3RvX3JlcXVlc3Qobm9k
ZSktPmVuZ2luZTsKPiArCWNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxID0gbm9kZV90b19y
ZXF1ZXN0KG5vZGUpOwo+ICsJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwo+ICAgCj4g
ICAJR0VNX0JVR19PTighbG9ja2VkKTsKPiAgIAo+IC0JaWYgKGVuZ2luZSAhPSBsb2NrZWQpIHsK
PiArCS8qCj4gKwkgKiBWaXJ0dWFsIGVuZ2luZXMgY29tcGxpY2F0ZSBhY3F1aXJpbmcgdGhlIGVu
Z2luZSB0aW1lbGluZSBsb2NrLAo+ICsJICogYXMgdGhlaXIgcnEtPmVuZ2luZSBwb2ludGVyIGlz
IG5vdCBzdGFibGUgdW50aWwgdW5kZXIgdGhhdAo+ICsJICogZW5naW5lIGxvY2suIFRoZSBzaW1w
bGUgcGxveSB3ZSB1c2UgaXMgdG8gdGFrZSB0aGUgbG9jayB0aGVuCj4gKwkgKiBjaGVjayB0aGF0
IHRoZSBycSBzdGlsbCBiZWxvbmdzIHRvIHRoZSBuZXdseSBsb2NrZWQgZW5naW5lLgo+ICsJICov
Cj4gKwl3aGlsZSAobG9ja2VkICE9IChlbmdpbmUgPSBSRUFEX09OQ0UocnEtPmVuZ2luZSkpKSB7
Cj4gICAJCXNwaW5fdW5sb2NrKCZsb2NrZWQtPnRpbWVsaW5lLmxvY2spOwo+ICAgCQltZW1zZXQo
Y2FjaGUsIDAsIHNpemVvZigqY2FjaGUpKTsKPiAgIAkJc3Bpbl9sb2NrKCZlbmdpbmUtPnRpbWVs
aW5lLmxvY2spOwo+ICsJCWxvY2tlZCA9IGVuZ2luZTsKPiAgIAl9Cj4gICAKPiAtCXJldHVybiBl
bmdpbmU7Cj4gKwlHRU1fQlVHX09OKGxvY2tlZCAhPSBlbmdpbmUpOwo+ICsJcmV0dXJuIGxvY2tl
ZDsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGJvb2wgaW5mbGlnaHQoY29uc3Qgc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEsCj4gQEAgLTM3MSw4ICszODAsMTEgQEAgc3RhdGljIHZvaWQgX19pOTE1X3Nj
aGVkdWxlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAo+ICAgCQlpZiAocHJpbyA8PSBub2RlLT5h
dHRyLnByaW9yaXR5IHx8IG5vZGVfc2lnbmFsZWQobm9kZSkpCj4gICAJCQljb250aW51ZTsKPiAg
IAo+ICsJCUdFTV9CVUdfT04obm9kZV90b19yZXF1ZXN0KG5vZGUpLT5lbmdpbmUgIT0gZW5naW5l
KTsKPiArCj4gICAJCW5vZGUtPmF0dHIucHJpb3JpdHkgPSBwcmlvOwo+ICAgCQlpZiAoIWxpc3Rf
ZW1wdHkoJm5vZGUtPmxpbmspKSB7Cj4gKwkJCUdFTV9CVUdfT04oaW50ZWxfZW5naW5lX2lzX3Zp
cnR1YWwoZW5naW5lKSk7Cj4gICAJCQlpZiAoIWNhY2hlLnByaW9saXN0KQo+ICAgCQkJCWNhY2hl
LnByaW9saXN0ID0KPiAgIAkJCQkJaTkxNV9zY2hlZF9sb29rdXBfcHJpb2xpc3QoZW5naW5lLAo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5lX3R5cGVzLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5lX3R5cGVzLmgKPiBpbmRleCA1MjU2
YTBiNWM1ZjcuLjE2ODg3MDVmNGEyYiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3RpbWVsaW5lX3R5cGVzLmgKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3RpbWVsaW5lX3R5cGVzLmgKPiBAQCAtMjYsNiArMjYsNyBAQCBzdHJ1Y3QgaTkxNV90aW1lbGlu
ZSB7Cj4gICAJc3BpbmxvY2tfdCBsb2NrOwo+ICAgI2RlZmluZSBUSU1FTElORV9DTElFTlQgMCAv
KiBkZWZhdWx0IHN1YmNsYXNzICovCj4gICAjZGVmaW5lIFRJTUVMSU5FX0VOR0lORSAxCj4gKyNk
ZWZpbmUgVElNRUxJTkVfVklSVFVBTCAyCj4gICAJc3RydWN0IG11dGV4IG11dGV4OyAvKiBwcm90
ZWN0cyB0aGUgZmxvdyBvZiByZXF1ZXN0cyAqLwo+ICAgCj4gICAJdW5zaWduZWQgaW50IHBpbl9j
b3VudDsKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oIGIvaW5jbHVk
ZS91YXBpL2RybS9pOTE1X2RybS5oCj4gaW5kZXggNzY5NDExMzM2MmQ0Li5mZjJhYmFiYzA5ODQg
MTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCj4gKysrIGIvaW5jbHVk
ZS91YXBpL2RybS9pOTE1X2RybS5oCj4gQEAgLTEzNyw2ICsxMzcsNyBAQCBzdHJ1Y3QgaTkxNV9l
bmdpbmVfY2xhc3NfaW5zdGFuY2Ugewo+ICAgCV9fdTE2IGVuZ2luZV9jbGFzczsgLyogc2VlIGVu
dW0gZHJtX2k5MTVfZ2VtX2VuZ2luZV9jbGFzcyAqLwo+ICAgCV9fdTE2IGVuZ2luZV9pbnN0YW5j
ZTsKPiAgICNkZWZpbmUgSTkxNV9FTkdJTkVfQ0xBU1NfSU5WQUxJRF9OT05FIC0xCj4gKyNkZWZp
bmUgSTkxNV9FTkdJTkVfQ0xBU1NfSU5WQUxJRF9WSVJUVUFMIC0yCj4gICB9Owo+ICAgCj4gICAv
KioKPiBAQCAtMTYwNyw4ICsxNjA4LDQ2IEBAIHN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9w
YXJhbV9zc2V1IHsKPiAgIAlfX3UzMiByc3ZkOwo+ICAgfTsKPiAgIAo+ICsvKgo+ICsgKiBpOTE1
X2NvbnRleHRfZW5naW5lc19sb2FkX2JhbGFuY2U6Cj4gKyAqCj4gKyAqIEVuYWJsZSBsb2FkIGJh
bGFuY2luZyBhY3Jvc3MgdGhpcyBzZXQgb2YgZW5naW5lcy4KPiArICoKPiArICogSW50byB0aGUg
STkxNV9FWEVDX0RFRkFVTFQgc2xvdCBbMF0sIGEgdmlydHVhbCBlbmdpbmUgaXMgY3JlYXRlZCB0
aGF0IHdoZW4KPiArICogdXNlZCB3aWxsIHByb3h5IHRoZSBleGVjYnVmZmVyIHJlcXVlc3Qgb250
byBvbmUgb2YgdGhlIHNldCBvZiBlbmdpbmVzCj4gKyAqIGluIHN1Y2ggYSB3YXkgYXMgdG8gZGlz
dHJpYnV0ZSB0aGUgbG9hZCBldmVubHkgYWNyb3NzIHRoZSBzZXQuCj4gKyAqCj4gKyAqIFRoZSBz
ZXQgb2YgZW5naW5lcyBtdXN0IGJlIGNvbXBhdGlibGUgKGUuZy4gdGhlIHNhbWUgSFcgY2xhc3Mp
IGFzIHRoZXkKPiArICogd2lsbCBzaGFyZSB0aGUgc2FtZSBsb2dpY2FsIEdQVSBjb250ZXh0IGFu
ZCByaW5nLgo+ICsgKgo+ICsgKiBUbyBpbnRlcm1peCByZW5kZXJpbmcgd2l0aCB0aGUgdmlydHVh
bCBlbmdpbmUgYW5kIGRpcmVjdCByZW5kZXJpbmcgb250bwo+ICsgKiB0aGUgYmFja2luZyBlbmdp
bmVzIChieXBhc3NpbmcgdGhlIGxvYWQgYmFsYW5jaW5nIHByb3h5KSwgdGhlIGNvbnRleHQgbXVz
dAo+ICsgKiBiZSBkZWZpbmVkIHRvIHVzZSBhIHNpbmdsZSB0aW1lbGluZSBmb3IgYWxsIGVuZ2lu
ZXMuCj4gKyAqLwo+ICtzdHJ1Y3QgaTkxNV9jb250ZXh0X2VuZ2luZXNfbG9hZF9iYWxhbmNlIHsK
PiArCXN0cnVjdCBpOTE1X3VzZXJfZXh0ZW5zaW9uIGJhc2U7Cj4gKwo+ICsJX191MTYgZW5naW5l
X2luZGV4Owo+ICsJX191MTYgbnVtX3NpYmxpbmdzOwo+ICsJX191MzIgZmxhZ3M7IC8qIGFsbCB1
bmRlZmluZWQgZmxhZ3MgbXVzdCBiZSB6ZXJvICovCj4gKwo+ICsJX191NjQgbWJ6NjRbMV07IC8q
IHJlc2VydmVkIGZvciBmdXR1cmUgdXNlOyBtdXN0IGJlIHplcm8gKi8KPiArCj4gKwlzdHJ1Y3Qg
aTkxNV9lbmdpbmVfY2xhc3NfaW5zdGFuY2UgZW5naW5lc1swXTsKPiArfSBfX2F0dHJpYnV0ZV9f
KChwYWNrZWQpKTsKPiArCj4gKyNkZWZpbmUgSTkxNV9ERUZJTkVfQ09OVEVYVF9FTkdJTkVTX0xP
QURfQkFMQU5DRShuYW1lX18sIE5fXykgc3RydWN0IHsgXAo+ICsJc3RydWN0IGk5MTVfdXNlcl9l
eHRlbnNpb24gYmFzZTsgXAo+ICsJX191MTYgZW5naW5lX2luZGV4OyBcCj4gKwlfX3UxNiBudW1f
c2libGluZ3M7IFwKPiArCV9fdTMyIGZsYWdzOyBcCj4gKwlfX3U2NCBtYno2NFsxXTsgXAo+ICsJ
c3RydWN0IGk5MTVfZW5naW5lX2NsYXNzX2luc3RhbmNlIGVuZ2luZXNbTl9fXTsgXAo+ICt9IF9f
YXR0cmlidXRlX18oKHBhY2tlZCkpIG5hbWVfXwo+ICsKPiAgIHN0cnVjdCBpOTE1X2NvbnRleHRf
cGFyYW1fZW5naW5lcyB7Cj4gICAJX191NjQgZXh0ZW5zaW9uczsgLyogbGlua2VkIGNoYWluIG9m
IGV4dGVuc2lvbiBibG9ja3MsIDAgdGVybWluYXRlcyAqLwo+ICsjZGVmaW5lIEk5MTVfQ09OVEVY
VF9FTkdJTkVTX0VYVF9MT0FEX0JBTEFOQ0UgMCAvKiBzZWUgaTkxNV9jb250ZXh0X2VuZ2luZXNf
bG9hZF9iYWxhbmNlICovCj4gICAJc3RydWN0IGk5MTVfZW5naW5lX2NsYXNzX2luc3RhbmNlIGVu
Z2luZXNbMF07Cj4gICB9IF9fYXR0cmlidXRlX18oKHBhY2tlZCkpOwo+ICAgCj4gCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5n
IGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

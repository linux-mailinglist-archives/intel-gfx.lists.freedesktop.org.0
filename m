Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 52A1B11243F
	for <lists+intel-gfx@lfdr.de>; Wed,  4 Dec 2019 09:15:51 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 25CEB6F452;
	Wed,  4 Dec 2019 08:15:49 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 15CEA6F443
 for <intel-gfx@lists.freedesktop.org>; Wed,  4 Dec 2019 08:15:46 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19452229-1500050 
 for <intel-gfx@lists.freedesktop.org>; Wed, 04 Dec 2019 08:15:42 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  4 Dec 2019 08:15:43 +0000
Message-Id: <20191204081543.3588538-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915: Introduce DRM_I915_GEM_MMAP_OFFSET
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQWJkaWVsIEphbnVsZ3VlIDxhYmRpZWwuamFudWxndWVAbGludXguaW50ZWwuY29tPgoK
VGhpcyBpcyByZWFsbHkganVzdCBhbiBhbGlhcyBvZiBtbWFwX2d0dC4gVGhlICdtbWFwIG9mZnNl
dCcgbm9tZW5jbGF0dXJlCmNvbWVzIGZyb20gdGhlIHZhbHVlIHJldHVybmVkIGJ5IHRoaXMgaW9j
dGwgd2hpY2ggaXMgdGhlIG9mZnNldCBpbnRvIHRoZQpkZXZpY2UgZmQgd2hpY2ggdXNlcnBhY2Ug
dXNlcyB3aXRoIG1tYXAoMikuCgptbWFwX2d0dCB3YXMgb3VyIGluaXRpYWwgbW1hcF9vZmZzZXQg
aW1wbGVtZW50YXRpb24sIHRoaXMgZXh0ZW5kcwpvdXIgQ1BVIG1tYXAgc3VwcG9ydCB0byBhbGxv
dyBhZGRpdGlvbmFsIGZhdWx0IGhhbmRsZXJzIHRoYXQgZGVwZW5kcyBvbgp0aGUgb2JqZWN0J3Mg
YmFja2luZyBwYWdlcy4KCk5vdGUgdGhhdCB3ZSBtdWx0aXBsZXggbW1hcF9ndHQgYW5kIG1tYXBf
b2Zmc2V0IHRocm91Z2ggdGhlIHNhbWUgaW9jdGwsCmFuZCB1c2UgdGhlIHplcm8gZXh0ZW5kaW5n
IGJlaGF2aW91ciBvZiBkcm0gdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuCnRoZW0sIHdoZW4gd2Ug
aW5zcGVjdCB0aGUgZmxhZ3MuCgpUbyBzdXBwb3J0IG11bHRpcGxlIG1tYXAgdHlwZXMgb24gYW4g
b2JqZWN0IHdlIG5lZWQgdG8gc3VwcG9ydCBtdWx0aXBsZQptbWFwX29mZnNldHMgZm9yIGFuIG9i
amVjdCAoZWFjaCBvZmZzZXQgaW4gdGhlIGdsb2JhbCBkZXZpY2UgYWRkcmVzcwpzcGFjZSBjb3Jy
ZXNwb25kaW5nIHRvIGEgdW5pcXVlIGluc3RhbmNlIG9mIHRoZSBvYmplY3QgZm9yIGEgZmlsZSAr
IG1tYXAKdHlwZSkuIEFzIHdlIGRyb3AgdGhlIHNpbXBsaWZpZWQgZHJtIGNvcmUgaWRlYSBvZiBh
IHNpbmdsZSBtbWFwX29mZnNldCwKd2UgbmVlZCB0byBwcm92aWRlIHJlcGxhY2VtZW50IGhvb2tz
IGZvciB0aGUgZHVtYiBtbWFwIGludGVyZmFjZSBhcwp3ZWxsLgoKTGluazogaHR0cHM6Ly9naXRs
YWIuZnJlZWRlc2t0b3Aub3JnL21lc2EvbWVzYS9tZXJnZV9yZXF1ZXN0cy8xNjc1ClRlc3RjYXNl
OiBpZ3QvZ2VtX21tYXBfb2Zmc2V0ClNpZ25lZC1vZmYtYnk6IEFiZGllbCBKYW51bGd1ZSA8YWJk
aWVsLmphbnVsZ3VlQGxpbnV4LmludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogTWF0dGhldyBBdWxk
IDxtYXR0aGV3LmF1bGRAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9kb21haW4uYyAgICB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1faW9jdGxzLmggICAgfCAgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9tbWFuLmMgICAgICB8IDQ2MSArKysrKysrKysrKysrKy0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmggICAgICB8ICAzMSArKwogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jICAgIHwgIDI2ICsKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaCAgICB8ICAgNyArLQogLi4uL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmggIHwgIDIzICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9wYWdlcy5jICAgICB8ICAgMyArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fdGlsaW5nLmMgICAgfCAgIDEgKwogLi4uL2RybS9pOTE1L2dlbS9zZWxmdGVz
dHMvaTkxNV9nZW1fbW1hbi5jICAgIHwgIDg4ICsrKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3Jlc2V0LmMgICAgICAgICB8ICAgNyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuYyAgICAgICAgICAgICAgIHwgIDE1ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2Rydi5oICAgICAgICAgICAgICAgfCAgIDQgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW0uYyAgICAgICAgICAgICAgIHwgICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dl
dHBhcmFtLmMgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEu
YyAgICAgICAgICAgICAgIHwgICA1ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5o
ICAgICAgICAgICAgICAgfCAgIDMgKwogaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oICAgICAg
ICAgICAgICAgICAgIHwgIDMyICsrCiAxOCBmaWxlcyBjaGFuZ2VkLCA1NzMgaW5zZXJ0aW9ucygr
KSwgMTQyIGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9tbWFuLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fZG9tYWluLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fZG9tYWluLmMKaW5kZXggMzExOWY3YmU5YmMwLi5mMjA2NDk1MDYyMmIgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4uYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG9tYWluLmMKQEAgLTEzLDYgKzEzLDcgQEAKICNp
bmNsdWRlICJpOTE1X2dlbV9vYmplY3QuaCIKICNpbmNsdWRlICJpOTE1X3ZtYS5oIgogI2luY2x1
ZGUgImk5MTVfZ2VtX2xtZW0uaCIKKyNpbmNsdWRlICJpOTE1X2dlbV9tbWFuLmgiCiAKIHN0YXRp
YyB2b2lkIF9faTkxNV9nZW1fb2JqZWN0X2ZsdXNoX2Zvcl9kaXNwbGF5KHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmopCiB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1faW9jdGxzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
aW9jdGxzLmgKaW5kZXggZGRjN2YyYTUyYjNlLi44N2Q4YjI3ZjQyNmQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9pb2N0bHMuaAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1faW9jdGxzLmgKQEAgLTI4LDggKzI4LDggQEAgaW50IGk5
MTVfZ2VtX21hZHZpc2VfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
IAkJCSAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7CiBpbnQgaTkxNV9nZW1fbW1hcF9pb2N0bChz
dHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJc3RydWN0IGRybV9maWxlICpm
aWxlKTsKLWludCBpOTE1X2dlbV9tbWFwX2d0dF9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCB2b2lkICpkYXRhLAotCQkJICAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7CitpbnQgaTkxNV9n
ZW1fbW1hcF9vZmZzZXRfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
KwkJCSAgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwogaW50IGk5MTVfZ2VtX3ByZWFkX2lv
Y3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJCQkgc3RydWN0IGRybV9m
aWxlICpmaWxlKTsKIGludCBpOTE1X2dlbV9wd3JpdGVfaW9jdGwoc3RydWN0IGRybV9kZXZpY2Ug
KmRldiwgdm9pZCAqZGF0YSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9tbWFuLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5j
CmluZGV4IGQ2MDk3MzYwM2NjMS4uYzU2YzI3MWUxY2ExIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9tbWFuLmMKQEAgLTUsNiArNSw3IEBACiAgKi8KIAogI2luY2x1ZGUgPGxp
bnV4L21tYW4uaD4KKyNpbmNsdWRlIDxsaW51eC9wZm5fdC5oPgogI2luY2x1ZGUgPGxpbnV4L3Np
emVzLmg+CiAKICNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgpAQCAtMTQsNiArMTUsNyBAQAogI2lu
Y2x1ZGUgImk5MTVfZ2VtX2d0dC5oIgogI2luY2x1ZGUgImk5MTVfZ2VtX2lvY3Rscy5oIgogI2lu
Y2x1ZGUgImk5MTVfZ2VtX29iamVjdC5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX21tYW4uaCIKICNp
bmNsdWRlICJpOTE1X3RyYWNlLmgiCiAjaW5jbHVkZSAiaTkxNV92bWEuaCIKIApAQCAtMTQ0LDYg
KzE0Niw5IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgdGlsZV9yb3dfcGFnZXMoY29uc3Qgc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKICAqIDMgLSBSZW1vdmUgaW1wbGljaXQgc2V0LWRv
bWFpbihHVFQpIGFuZCBzeW5jaHJvbmlzYXRpb24gb24gaW5pdGlhbAogICogICAgIHBhZ2VmYXVs
dDsgc3dhcGluIHJlbWFpbnMgdHJhbnNwYXJlbnQuCiAgKgorICogNCAtIFN1cHBvcnQgbXVsdGlw
bGUgZmF1bHQgaGFuZGxlcnMgcGVyIG9iamVjdCBkZXBlbmRpbmcgb24gb2JqZWN0J3MKKyAqICAg
ICBiYWNraW5nIHN0b3JhZ2UgKGEuay5hLiBNTUFQX09GRlNFVCkuCisgKgogICogUmVzdHJpY3Rp
b25zOgogICoKICAqICAqIHNub29wYWJsZSBvYmplY3RzIGNhbm5vdCBiZSBhY2Nlc3NlZCB2aWEg
dGhlIEdUVC4gSXQgY2FuIGNhdXNlIG1hY2hpbmUKQEAgLTE3MSw3ICsxNzYsNyBAQCBzdGF0aWMg
dW5zaWduZWQgaW50IHRpbGVfcm93X3BhZ2VzKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCiAgKi8KIGludCBpOTE1X2dlbV9tbWFwX2d0dF92ZXJzaW9uKHZvaWQpCiB7Ci0J
cmV0dXJuIDM7CisJcmV0dXJuIDQ7CiB9CiAKIHN0YXRpYyBpbmxpbmUgc3RydWN0IGk5MTVfZ2d0
dF92aWV3CkBAIC0xOTcsMjkgKzIwMiw4MyBAQCBjb21wdXRlX3BhcnRpYWxfdmlldyhjb25zdCBz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCXJldHVybiB2aWV3OwogfQogCi0vKioK
LSAqIGk5MTVfZ2VtX2ZhdWx0IC0gZmF1bHQgYSBwYWdlIGludG8gdGhlIEdUVAotICogQHZtZjog
ZmF1bHQgaW5mbwotICoKLSAqIFRoZSBmYXVsdCBoYW5kbGVyIGlzIHNldCB1cCBieSBkcm1fZ2Vt
X21tYXAoKSB3aGVuIGEgb2JqZWN0IGlzIEdUVCBtYXBwZWQKLSAqIGZyb20gdXNlcnNwYWNlLiAg
VGhlIGZhdWx0IGhhbmRsZXIgdGFrZXMgY2FyZSBvZiBiaW5kaW5nIHRoZSBvYmplY3QgdG8KLSAq
IHRoZSBHVFQgKGlmIG5lZWRlZCksIGFsbG9jYXRpbmcgYW5kIHByb2dyYW1taW5nIGEgZmVuY2Ug
cmVnaXN0ZXIgKGFnYWluLAotICogb25seSBpZiBuZWVkZWQgYmFzZWQgb24gd2hldGhlciB0aGUg
b2xkIHJlZyBpcyBzdGlsbCB2YWxpZCBvciB0aGUgb2JqZWN0Ci0gKiBpcyB0aWxlZCkgYW5kIGlu
c2VydGluZyBhIG5ldyBQVEUgaW50byB0aGUgZmF1bHRpbmcgcHJvY2Vzcy4KLSAqCi0gKiBOb3Rl
IHRoYXQgdGhlIGZhdWx0aW5nIHByb2Nlc3MgbWF5IGludm9sdmUgZXZpY3RpbmcgZXhpc3Rpbmcg
b2JqZWN0cwotICogZnJvbSB0aGUgR1RUIGFuZC9vciBmZW5jZSByZWdpc3RlcnMgdG8gbWFrZSBy
b29tLiAgU28gcGVyZm9ybWFuY2UgbWF5Ci0gKiBzdWZmZXIgaWYgdGhlIEdUVCB3b3JraW5nIHNl
dCBpcyBsYXJnZSBvciB0aGVyZSBhcmUgZmV3IGZlbmNlIHJlZ2lzdGVycwotICogbGVmdC4KLSAq
Ci0gKiBUaGUgY3VycmVudCBmZWF0dXJlIHNldCBzdXBwb3J0ZWQgYnkgaTkxNV9nZW1fZmF1bHQo
KSBhbmQgdGh1cyBHVFQgbW1hcHMKLSAqIGlzIGV4cG9zZWQgdmlhIEk5MTVfUEFSQU1fTU1BUF9H
VFRfVkVSU0lPTiAoc2VlIGk5MTVfZ2VtX21tYXBfZ3R0X3ZlcnNpb24pLgotICovCi12bV9mYXVs
dF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQorc3RhdGljIHZtX2ZhdWx0
X3QgaTkxNV9lcnJvcl90b192bWZfZmF1bHQoaW50IGVycikKK3sKKwlzd2l0Y2ggKGVycikgewor
CWRlZmF1bHQ6CisJCVdBUk5fT05DRShlcnIsICJ1bmhhbmRsZWQgZXJyb3IgaW4gJXM6ICVpXG4i
LCBfX2Z1bmNfXywgZXJyKTsKKwkJLyogZmFsbHRocm91Z2ggKi8KKwljYXNlIC1FSU86IC8qIHNo
bWVtZnMgZmFpbHVyZSBmcm9tIHN3YXAgZGV2aWNlICovCisJY2FzZSAtRUZBVUxUOiAvKiBwdXJn
ZWQgb2JqZWN0ICovCisJY2FzZSAtRU5PREVWOiAvKiBiYWQgb2JqZWN0LCBob3cgZGlkIHlvdSBn
ZXQgaGVyZSEgKi8KKwkJcmV0dXJuIFZNX0ZBVUxUX1NJR0JVUzsKKworCWNhc2UgLUVOT1NQQzog
Lyogc2htZW1mcyBhbGxvY2F0aW9uIGZhaWx1cmUgKi8KKwljYXNlIC1FTk9NRU06IC8qIG91ciBh
bGxvY2F0aW9uIGZhaWx1cmUgKi8KKwkJcmV0dXJuIFZNX0ZBVUxUX09PTTsKKworCWNhc2UgMDoK
KwljYXNlIC1FQUdBSU46CisJY2FzZSAtRVJFU1RBUlRTWVM6CisJY2FzZSAtRUlOVFI6CisJY2Fz
ZSAtRUJVU1k6CisJCS8qCisJCSAqIEVCVVNZIGlzIG9rOiB0aGlzIGp1c3QgbWVhbnMgdGhhdCBh
bm90aGVyIHRocmVhZAorCQkgKiBhbHJlYWR5IGRpZCB0aGUgam9iLgorCQkgKi8KKwkJcmV0dXJu
IFZNX0ZBVUxUX05PUEFHRTsKKwl9Cit9CisKK3N0YXRpYyB2bV9mYXVsdF90IHZtX2ZhdWx0X2Nw
dShzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKK3sKKwlzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKmFyZWEg
PSB2bWYtPnZtYTsKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqcHJpdiA9IGFyZWEtPnZtX3By
aXZhdGVfZGF0YTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gcHJpdi0+b2Jq
OworCXVuc2lnbmVkIGxvbmcgaSwgc2l6ZSA9IGFyZWEtPnZtX2VuZCAtIGFyZWEtPnZtX3N0YXJ0
OworCWJvb2wgd3JpdGUgPSBhcmVhLT52bV9mbGFncyAmIFZNX1dSSVRFOworCXZtX2ZhdWx0X3Qg
cmV0ID0gVk1fRkFVTFRfU0lHQlVTOworCWludCBlcnI7CisKKwlpZiAoIWk5MTVfZ2VtX29iamVj
dF9oYXNfc3RydWN0X3BhZ2Uob2JqKSkKKwkJcmV0dXJuIHJldDsKKworCS8qIFNhbml0eSBjaGVj
ayB0aGF0IHdlIGFsbG93IHdyaXRpbmcgaW50byB0aGlzIG9iamVjdCAqLworCWlmIChpOTE1X2dl
bV9vYmplY3RfaXNfcmVhZG9ubHkob2JqKSAmJiB3cml0ZSkKKwkJcmV0dXJuIHJldDsKKworCWVy
ciA9IGk5MTVfZ2VtX29iamVjdF9waW5fcGFnZXMob2JqKTsKKwlpZiAoZXJyKQorCQlyZXR1cm4g
aTkxNV9lcnJvcl90b192bWZfZmF1bHQoZXJyKTsKKworCS8qIFBURXMgYXJlIHJldm9rZWQgaW4g
b2JqLT5vcHMtPnB1dF9wYWdlcygpICovCisJZm9yIChpID0gMDsgaSA8IHNpemUgPj4gUEFHRV9T
SElGVDsgaSsrKSB7CisJCXN0cnVjdCBwYWdlICpwYWdlID0gaTkxNV9nZW1fb2JqZWN0X2dldF9w
YWdlKG9iaiwgaSk7CisKKwkJcmV0ID0gdm1mX2luc2VydF9wZm4oYXJlYSwKKwkJCQkgICAgICh1
bnNpZ25lZCBsb25nKWFyZWEtPnZtX3N0YXJ0ICsgaSAqIFBBR0VfU0laRSwKKwkJCQkgICAgIHBh
Z2VfdG9fcGZuKHBhZ2UpKTsKKwkJaWYgKHJldCAhPSBWTV9GQVVMVF9OT1BBR0UpCisJCQlicmVh
azsKKwl9CisKKwlpZiAod3JpdGUpIHsKKwkJR0VNX0JVR19PTighaTkxNV9nZW1fb2JqZWN0X2hh
c19waW5uZWRfcGFnZXMob2JqKSk7CisJCW9iai0+Y2FjaGVfZGlydHkgPSB0cnVlOyAvKiBYWFgg
Zmx1c2ggYWZ0ZXIgUEFUIHVwZGF0ZT8gKi8KKwkJb2JqLT5tbS5kaXJ0eSA9IHRydWU7CisJfQor
CisJaTkxNV9nZW1fb2JqZWN0X3VucGluX3BhZ2VzKG9iaik7CisKKwlyZXR1cm4gcmV0OworfQor
CitzdGF0aWMgdm1fZmF1bHRfdCB2bV9mYXVsdF9ndHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiB7
CiAjZGVmaW5lIE1JTl9DSFVOS19QQUdFUyAoU1pfMU0gPj4gUEFHRV9TSElGVCkKIAlzdHJ1Y3Qg
dm1fYXJlYV9zdHJ1Y3QgKmFyZWEgPSB2bWYtPnZtYTsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqID0gdG9faW50ZWxfYm8oYXJlYS0+dm1fcHJpdmF0ZV9kYXRhKTsKKwlzdHJ1Y3Qg
aTkxNV9tbWFwX29mZnNldCAqcHJpdiA9IGFyZWEtPnZtX3ByaXZhdGVfZGF0YTsKKwlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gcHJpdi0+b2JqOwogCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSBvYmotPmJhc2UuZGV2OwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0g
dG9faTkxNShkZXYpOwogCXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtICpycG0gPSAmaTkxNS0+cnVu
dGltZV9wbTsKQEAgLTMxMiw2ICszNzEsOSBAQCB2bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0
cnVjdCB2bV9mYXVsdCAqdm1mKQogCQlsaXN0X2FkZCgmb2JqLT51c2VyZmF1bHRfbGluaywgJmk5
MTUtPmdndHQudXNlcmZhdWx0X2xpc3QpOwogCW11dGV4X3VubG9jaygmaTkxNS0+Z2d0dC52bS5t
dXRleCk7CiAKKwkvKiBUcmFjayB0aGUgbW1vIGFzc29jaWF0ZWQgd2l0aCB0aGUgZmVuY2VkIHZt
YSAqLworCXZtYS0+bW1vID0gcHJpdjsKKwogCWlmIChJU19BQ1RJVkUoQ09ORklHX0RSTV9JOTE1
X1VTRVJGQVVMVF9BVVRPU1VTUEVORCkpCiAJCWludGVsX3dha2VyZWZfYXV0bygmaTkxNS0+Z2d0
dC51c2VyZmF1bHRfd2FrZXJlZiwKIAkJCQkgICBtc2Vjc190b19qaWZmaWVzX3RpbWVvdXQoQ09O
RklHX0RSTV9JOTE1X1VTRVJGQVVMVF9BVVRPU1VTUEVORCkpOwpAQCAtMzMyLDY3ICszOTQsMzYg
QEAgdm1fZmF1bHRfdCBpOTE1X2dlbV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKIAlpbnRl
bF9ydW50aW1lX3BtX3B1dChycG0sIHdha2VyZWYpOwogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9w
YWdlcyhvYmopOwogZXJyOgotCXN3aXRjaCAocmV0KSB7Ci0JZGVmYXVsdDoKLQkJV0FSTl9PTkNF
KHJldCwgInVuaGFuZGxlZCBlcnJvciBpbiAlczogJWlcbiIsIF9fZnVuY19fLCByZXQpOwotCQkv
KiBmYWxsdGhyb3VnaCAqLwotCWNhc2UgLUVJTzogLyogc2htZW1mcyBmYWlsdXJlIGZyb20gc3dh
cCBkZXZpY2UgKi8KLQljYXNlIC1FRkFVTFQ6IC8qIHB1cmdlZCBvYmplY3QgKi8KLQljYXNlIC1F
Tk9ERVY6IC8qIGJhZCBvYmplY3QsIGhvdyBkaWQgeW91IGdldCBoZXJlISAqLwotCQlyZXR1cm4g
Vk1fRkFVTFRfU0lHQlVTOwotCi0JY2FzZSAtRU5PU1BDOiAvKiBzaG1lbWZzIGFsbG9jYXRpb24g
ZmFpbHVyZSAqLwotCWNhc2UgLUVOT01FTTogLyogb3VyIGFsbG9jYXRpb24gZmFpbHVyZSAqLwot
CQlyZXR1cm4gVk1fRkFVTFRfT09NOwotCi0JY2FzZSAwOgotCWNhc2UgLUVBR0FJTjoKLQljYXNl
IC1FUkVTVEFSVFNZUzoKLQljYXNlIC1FSU5UUjoKLQljYXNlIC1FQlVTWToKLQkJLyoKLQkJICog
RUJVU1kgaXMgb2s6IHRoaXMganVzdCBtZWFucyB0aGF0IGFub3RoZXIgdGhyZWFkCi0JCSAqIGFs
cmVhZHkgZGlkIHRoZSBqb2IuCi0JCSAqLwotCQlyZXR1cm4gVk1fRkFVTFRfTk9QQUdFOwotCX0K
KwlyZXR1cm4gaTkxNV9lcnJvcl90b192bWZfZmF1bHQocmV0KTsKIH0KIAotdm9pZCBfX2k5MTVf
Z2VtX29iamVjdF9yZWxlYXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikK
K3ZvaWQgX19pOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwX2d0dChzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqKQogewogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwogCiAJR0VNX0JVR19P
Tighb2JqLT51c2VyZmF1bHRfY291bnQpOwogCi0Jb2JqLT51c2VyZmF1bHRfY291bnQgPSAwOwot
CWxpc3RfZGVsKCZvYmotPnVzZXJmYXVsdF9saW5rKTsKLQlkcm1fdm1hX25vZGVfdW5tYXAoJm9i
ai0+YmFzZS52bWFfbm9kZSwKLQkJCSAgIG9iai0+YmFzZS5kZXYtPmFub25faW5vZGUtPmlfbWFw
cGluZyk7Ci0KIAlmb3JfZWFjaF9nZ3R0X3ZtYSh2bWEsIG9iaikKLQkJaTkxNV92bWFfdW5zZXRf
dXNlcmZhdWx0KHZtYSk7CisJCWk5MTVfdm1hX3Jldm9rZV9tbWFwKHZtYSk7CisKKwlHRU1fQlVH
X09OKG9iai0+dXNlcmZhdWx0X2NvdW50KTsKIH0KIAotLyoqCi0gKiBpOTE1X2dlbV9vYmplY3Rf
cmVsZWFzZV9tbWFwIC0gcmVtb3ZlIHBoeXNpY2FsIHBhZ2UgbWFwcGluZ3MKLSAqIEBvYmo6IG9i
aiBpbiBxdWVzdGlvbgotICoKLSAqIFByZXNlcnZlIHRoZSByZXNlcnZhdGlvbiBvZiB0aGUgbW1h
cHBpbmcgd2l0aCB0aGUgRFJNIGNvcmUgY29kZSwgYnV0Ci0gKiByZWxpbnF1aXNoIG93bmVyc2hp
cCBvZiB0aGUgcGFnZXMgYmFjayB0byB0aGUgc3lzdGVtLgotICoKKy8qCiAgKiBJdCBpcyB2aXRh
bCB0aGF0IHdlIHJlbW92ZSB0aGUgcGFnZSBtYXBwaW5nIGlmIHdlIGhhdmUgbWFwcGVkIGEgdGls
ZWQKICAqIG9iamVjdCB0aHJvdWdoIHRoZSBHVFQgYW5kIHRoZW4gbG9zZSB0aGUgZmVuY2UgcmVn
aXN0ZXIgZHVlIHRvCiAgKiByZXNvdXJjZSBwcmVzc3VyZS4gU2ltaWxhcmx5IGlmIHRoZSBvYmpl
Y3QgaGFzIGJlZW4gbW92ZWQgb3V0IG9mIHRoZQogICogYXBlcnR1cmUsIHRoYW4gcGFnZXMgbWFw
cGVkIGludG8gdXNlcnNwYWNlIG11c3QgYmUgcmV2b2tlZC4gUmVtb3ZpbmcgdGhlCiAgKiBtYXBw
aW5nIHdpbGwgdGhlbiB0cmlnZ2VyIGEgcGFnZSBmYXVsdCBvbiB0aGUgbmV4dCB1c2VyIGFjY2Vz
cywgYWxsb3dpbmcKLSAqIGZpeHVwIGJ5IGk5MTVfZ2VtX2ZhdWx0KCkuCisgKiBmaXh1cCBieSB2
bV9mYXVsdF9ndHQoKS4KICAqLwotdm9pZCBpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCitzdGF0aWMgdm9pZCBpOTE1X2dlbV9vYmpl
Y3RfcmVsZWFzZV9tbWFwX2d0dChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewog
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsK
IAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKIAotCS8qIFNlcmlhbGlzYXRpb24gYmV0d2VlbiB1
c2VyIEdUVCBhY2Nlc3MgYW5kIG91ciBjb2RlIGRlcGVuZHMgdXBvbgorCS8qCisJICogU2VyaWFs
aXNhdGlvbiBiZXR3ZWVuIHVzZXIgR1RUIGFjY2VzcyBhbmQgb3VyIGNvZGUgZGVwZW5kcyB1cG9u
CiAJICogcmV2b2tpbmcgdGhlIENQVSdzIFBURSB3aGlsc3QgdGhlIG11dGV4IGlzIGhlbGQuIFRo
ZSBuZXh0IHVzZXIKIAkgKiBwYWdlZmF1bHQgdGhlbiBoYXMgdG8gd2FpdCB1bnRpbCB3ZSByZWxl
YXNlIHRoZSBtdXRleC4KIAkgKgpAQCAtNDA2LDkgKzQzNywxMCBAQCB2b2lkIGk5MTVfZ2VtX29i
amVjdF9yZWxlYXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAlpZiAo
IW9iai0+dXNlcmZhdWx0X2NvdW50KQogCQlnb3RvIG91dDsKIAotCV9faTkxNV9nZW1fb2JqZWN0
X3JlbGVhc2VfbW1hcChvYmopOworCV9faTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9ndHQo
b2JqKTsKIAotCS8qIEVuc3VyZSB0aGF0IHRoZSBDUFUncyBQVEUgYXJlIHJldm9rZWQgYW5kIHRo
ZXJlIGFyZSBub3Qgb3V0c3RhbmRpbmcKKwkvKgorCSAqIEVuc3VyZSB0aGF0IHRoZSBDUFUncyBQ
VEUgYXJlIHJldm9rZWQgYW5kIHRoZXJlIGFyZSBub3Qgb3V0c3RhbmRpbmcKIAkgKiBtZW1vcnkg
dHJhbnNhY3Rpb25zIGZyb20gdXNlcnNwYWNlIGJlZm9yZSB3ZSByZXR1cm4uIFRoZSBUTEIKIAkg
KiBmbHVzaGluZyBpbXBsaWVkIGFib3ZlIGJ5IGNoYW5naW5nIHRoZSBQVEUgYWJvdmUgKnNob3Vs
ZCogYmUKIAkgKiBzdWZmaWNpZW50LCBhbiBleHRyYSBiYXJyaWVyIGhlcmUganVzdCBwcm92aWRl
cyB1cyB3aXRoIGEgYml0CkBAIC00MjIsNTcgKzQ1NCwxNDkgQEAgdm9pZCBpOTE1X2dlbV9vYmpl
Y3RfcmVsZWFzZV9tbWFwKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJaW50ZWxf
cnVudGltZV9wbV9wdXQoJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpOwogfQogCi1zdGF0aWMg
aW50IGNyZWF0ZV9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQor
dm9pZCBpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqb2JqKQoreworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW87CisKKwlz
cGluX2xvY2soJm9iai0+bW1vLmxvY2spOworCWxpc3RfZm9yX2VhY2hfZW50cnkobW1vLCAmb2Jq
LT5tbW8ub2Zmc2V0cywgb2Zmc2V0KSB7CisJCS8qCisJCSAqIHZtYV9ub2RlX3VubWFwIGZvciBH
VFQgbW1hcHMgaGFuZGxlZCBhbHJlYWR5IGluCisJCSAqIF9faTkxNV9nZW1fb2JqZWN0X3JlbGVh
c2VfbW1hcF9ndHQKKwkJICovCisJCWlmIChtbW8tPm1tYXBfdHlwZSA9PSBJOTE1X01NQVBfVFlQ
RV9HVFQpCisJCQljb250aW51ZTsKKworCQlzcGluX3VubG9jaygmb2JqLT5tbW8ubG9jayk7CisJ
CWRybV92bWFfbm9kZV91bm1hcCgmbW1vLT52bWFfbm9kZSwKKwkJCQkgICBvYmotPmJhc2UuZGV2
LT5hbm9uX2lub2RlLT5pX21hcHBpbmcpOworCQlzcGluX2xvY2soJm9iai0+bW1vLmxvY2spOwor
CX0KKwlzcGluX3VubG9jaygmb2JqLT5tbW8ubG9jayk7Cit9CisKKy8qKgorICogaTkxNV9nZW1f
b2JqZWN0X3JlbGVhc2VfbW1hcCAtIHJlbW92ZSBwaHlzaWNhbCBwYWdlIG1hcHBpbmdzCisgKiBA
b2JqOiBvYmogaW4gcXVlc3Rpb24KKyAqCisgKiBQcmVzZXJ2ZSB0aGUgcmVzZXJ2YXRpb24gb2Yg
dGhlIG1tYXBwaW5nIHdpdGggdGhlIERSTSBjb3JlIGNvZGUsIGJ1dAorICogcmVsaW5xdWlzaCBv
d25lcnNoaXAgb2YgdGhlIHBhZ2VzIGJhY2sgdG8gdGhlIHN5c3RlbS4KKyAqLwordm9pZCBpOTE1
X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmop
Cit7CisJaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9ndHQob2JqKTsKKwlpOTE1X2dlbV9v
YmplY3RfcmVsZWFzZV9tbWFwX29mZnNldChvYmopOworfQorCitzdGF0aWMgc3RydWN0IGk5MTVf
bW1hcF9vZmZzZXQgKgorbW1hcF9vZmZzZXRfYXR0YWNoKHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmosCisJCSAgIGVudW0gaTkxNV9tbWFwX3R5cGUgbW1hcF90eXBlLAorCQkgICBzdHJ1
Y3QgZHJtX2ZpbGUgKmZpbGUpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KG9iai0+YmFzZS5kZXYpOwotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7
CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbzsKIAlpbnQgZXJyOwogCi0JZXJyID0gZHJt
X2dlbV9jcmVhdGVfbW1hcF9vZmZzZXQoJm9iai0+YmFzZSk7CisJbW1vID0ga21hbGxvYyhzaXpl
b2YoKm1tbyksIEdGUF9LRVJORUwpOworCWlmICghbW1vKQorCQlyZXR1cm4gRVJSX1BUUigtRU5P
TUVNKTsKKworCW1tby0+b2JqID0gb2JqOworCW1tby0+ZGV2ID0gb2JqLT5iYXNlLmRldjsKKwlt
bW8tPmZpbGUgPSBmaWxlOworCW1tby0+bW1hcF90eXBlID0gbW1hcF90eXBlOworCWRybV92bWFf
bm9kZV9yZXNldCgmbW1vLT52bWFfbm9kZSk7CisKKwllcnIgPSBkcm1fdm1hX29mZnNldF9hZGQo
bW1vLT5kZXYtPnZtYV9vZmZzZXRfbWFuYWdlciwgJm1tby0+dm1hX25vZGUsCisJCQkJIG9iai0+
YmFzZS5zaXplIC8gUEFHRV9TSVpFKTsKIAlpZiAobGlrZWx5KCFlcnIpKQotCQlyZXR1cm4gMDsK
KwkJZ290byBvdXQ7CiAKIAkvKiBBdHRlbXB0IHRvIHJlYXAgc29tZSBtbWFwIHNwYWNlIGZyb20g
ZGVhZCBvYmplY3RzICovCi0JZXJyID0gaW50ZWxfZ3RfcmV0aXJlX3JlcXVlc3RzX3RpbWVvdXQo
Z3QsIE1BWF9TQ0hFRFVMRV9USU1FT1VUKTsKKwllcnIgPSBpbnRlbF9ndF9yZXRpcmVfcmVxdWVz
dHNfdGltZW91dCgmaTkxNS0+Z3QsIE1BWF9TQ0hFRFVMRV9USU1FT1VUKTsKIAlpZiAoZXJyKQot
CQlyZXR1cm4gZXJyOworCQlnb3RvIGVycjsKIAogCWk5MTVfZ2VtX2RyYWluX2ZyZWVkX29iamVj
dHMoaTkxNSk7Ci0JcmV0dXJuIGRybV9nZW1fY3JlYXRlX21tYXBfb2Zmc2V0KCZvYmotPmJhc2Up
OworCWVyciA9IGRybV92bWFfb2Zmc2V0X2FkZChtbW8tPmRldi0+dm1hX29mZnNldF9tYW5hZ2Vy
LCAmbW1vLT52bWFfbm9kZSwKKwkJCQkgb2JqLT5iYXNlLnNpemUgLyBQQUdFX1NJWkUpOworCWlm
IChlcnIpCisJCWdvdG8gZXJyOworCitvdXQ6CisJc3Bpbl9sb2NrKCZvYmotPm1tby5sb2NrKTsK
KwlsaXN0X2FkZCgmbW1vLT5vZmZzZXQsICZvYmotPm1tby5vZmZzZXRzKTsKKwlzcGluX3VubG9j
aygmb2JqLT5tbW8ubG9jayk7CisKKwlpZiAoZmlsZSkKKwkJZHJtX3ZtYV9ub2RlX2FsbG93KCZt
bW8tPnZtYV9ub2RlLCBmaWxlKTsKKworCXJldHVybiBtbW87CisKK2VycjoKKwlrZnJlZShtbW8p
OworCXJldHVybiBFUlJfUFRSKGVycik7CiB9CiAKLWludAotaTkxNV9nZW1fbW1hcF9ndHQoc3Ry
dWN0IGRybV9maWxlICpmaWxlLAotCQkgIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCi0JCSAgdTMy
IGhhbmRsZSwKLQkJICB1NjQgKm9mZnNldCkKK3N0YXRpYyBpbnQKK19fYXNzaWduX21tYXBfb2Zm
c2V0KHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwKKwkJICAgICB1MzIgaGFuZGxlLAorCQkgICAgIGVu
dW0gaTkxNV9tbWFwX3R5cGUgbW1hcF90eXBlLAorCQkgICAgIHU2NCAqb2Zmc2V0KQogewogCXN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Ci0JaW50IHJldDsKLQotCWlmICghaTkxNV9n
Z3R0X2hhc19hcGVydHVyZSgmdG9faTkxNShkZXYpLT5nZ3R0KSkKLQkJcmV0dXJuIC1FTk9ERVY7
CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbzsKKwlpbnQgZXJyOwogCiAJb2JqID0gaTkx
NV9nZW1fb2JqZWN0X2xvb2t1cChmaWxlLCBoYW5kbGUpOwogCWlmICghb2JqKQogCQlyZXR1cm4g
LUVOT0VOVDsKIAotCWlmIChpOTE1X2dlbV9vYmplY3RfbmV2ZXJfYmluZF9nZ3R0KG9iaikpIHsK
LQkJcmV0ID0gLUVOT0RFVjsKKwlpZiAobW1hcF90eXBlID09IEk5MTVfTU1BUF9UWVBFX0dUVCAm
JgorCSAgICBpOTE1X2dlbV9vYmplY3RfbmV2ZXJfYmluZF9nZ3R0KG9iaikpIHsKKwkJZXJyID0g
LUVOT0RFVjsKIAkJZ290byBvdXQ7CiAJfQogCi0JcmV0ID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9i
aik7Ci0JaWYgKHJldCA9PSAwKQotCQkqb2Zmc2V0ID0gZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRy
KCZvYmotPmJhc2Uudm1hX25vZGUpOworCWlmIChtbWFwX3R5cGUgIT0gSTkxNV9NTUFQX1RZUEVf
R1RUICYmCisJICAgICFpOTE1X2dlbV9vYmplY3RfaGFzX3N0cnVjdF9wYWdlKG9iaikpIHsKKwkJ
ZXJyID0gLUVOT0RFVjsKKwkJZ290byBvdXQ7CisJfQorCisJbW1vID0gbW1hcF9vZmZzZXRfYXR0
YWNoKG9iaiwgbW1hcF90eXBlLCBmaWxlKTsKKwlpZiAoSVNfRVJSKG1tbykpIHsKKwkJZXJyID0g
UFRSX0VSUihtbW8pOworCQlnb3RvIG91dDsKKwl9CiAKKwkqb2Zmc2V0ID0gZHJtX3ZtYV9ub2Rl
X29mZnNldF9hZGRyKCZtbW8tPnZtYV9ub2RlKTsKKwllcnIgPSAwOwogb3V0OgogCWk5MTVfZ2Vt
X29iamVjdF9wdXQob2JqKTsKLQlyZXR1cm4gcmV0OworCXJldHVybiBlcnI7Cit9CisKK2ludAor
aTkxNV9nZW1fZHVtYl9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUsCisJCQkgIHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsCisJCQkgIHUzMiBoYW5kbGUsCisJCQkgIHU2NCAqb2Zmc2V0
KQoreworCWVudW0gaTkxNV9tbWFwX3R5cGUgbW1hcF90eXBlOworCisJaWYgKGJvb3RfY3B1X2hh
cyhYODZfRkVBVFVSRV9QQVQpKQorCQltbWFwX3R5cGUgPSBJOTE1X01NQVBfVFlQRV9XQzsKKwll
bHNlIGlmICghaTkxNV9nZ3R0X2hhc19hcGVydHVyZSgmdG9faTkxNShkZXYpLT5nZ3R0KSkKKwkJ
cmV0dXJuIC1FTk9ERVY7CisJZWxzZQorCQltbWFwX3R5cGUgPSBJOTE1X01NQVBfVFlQRV9HVFQ7
CisKKwlyZXR1cm4gX19hc3NpZ25fbW1hcF9vZmZzZXQoZmlsZSwgaGFuZGxlLCBtbWFwX3R5cGUs
IG9mZnNldCk7CiB9CiAKIC8qKgotICogaTkxNV9nZW1fbW1hcF9ndHRfaW9jdGwgLSBwcmVwYXJl
IGFuIG9iamVjdCBmb3IgR1RUIG1tYXAnaW5nCisgKiBpOTE1X2dlbV9tbWFwX29mZnNldF9pb2N0
bCAtIHByZXBhcmUgYW4gb2JqZWN0IGZvciBHVFQgbW1hcCdpbmcKICAqIEBkZXY6IERSTSBkZXZp
Y2UKICAqIEBkYXRhOiBHVFQgbWFwcGluZyBpb2N0bCBkYXRhCiAgKiBAZmlsZTogR0VNIG9iamVj
dCBpbmZvCkBAIC00ODcsMTIgKzYxMSwxNjcgQEAgaTkxNV9nZW1fbW1hcF9ndHQoc3RydWN0IGRy
bV9maWxlICpmaWxlLAogICogdXNlcnNwYWNlLgogICovCiBpbnQKLWk5MTVfZ2VtX21tYXBfZ3R0
X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCi0JCQlzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGUpCitpOTE1X2dlbV9tbWFwX29mZnNldF9pb2N0bChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LCB2b2lkICpkYXRhLAorCQkJICAgc3RydWN0IGRybV9maWxlICpmaWxlKQogewotCXN0
cnVjdCBkcm1faTkxNV9nZW1fbW1hcF9ndHQgKmFyZ3MgPSBkYXRhOworCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOworCXN0cnVjdCBkcm1faTkxNV9nZW1fbW1h
cF9vZmZzZXQgKmFyZ3MgPSBkYXRhOworCWVudW0gaTkxNV9tbWFwX3R5cGUgdHlwZTsKKworCWlm
IChhcmdzLT5leHRlbnNpb25zKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXN3aXRjaCAoYXJncy0+
ZmxhZ3MpIHsKKwljYXNlIEk5MTVfTU1BUF9PRkZTRVRfR1RUOgorCQlpZiAoIWk5MTVfZ2d0dF9o
YXNfYXBlcnR1cmUoJmk5MTUtPmdndHQpKQorCQkJcmV0dXJuIC1FTk9ERVY7CisJCXR5cGUgPSBJ
OTE1X01NQVBfVFlQRV9HVFQ7CisJCWJyZWFrOworCisJY2FzZSBJOTE1X01NQVBfT0ZGU0VUX1dD
OgorCQlpZiAoIWJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9QQVQpKQorCQkJcmV0dXJuIC1FTk9E
RVY7CisJCXR5cGUgPSBJOTE1X01NQVBfVFlQRV9XQzsKKwkJYnJlYWs7CisKKwljYXNlIEk5MTVf
TU1BUF9PRkZTRVRfV0I6CisJCXR5cGUgPSBJOTE1X01NQVBfVFlQRV9XQjsKKwkJYnJlYWs7CisK
KwljYXNlIEk5MTVfTU1BUF9PRkZTRVRfVUM6CisJCWlmICghYm9vdF9jcHVfaGFzKFg4Nl9GRUFU
VVJFX1BBVCkpCisJCQlyZXR1cm4gLUVOT0RFVjsKKwkJdHlwZSA9IEk5MTVfTU1BUF9UWVBFX1VD
OworCQlicmVhazsKKworCWRlZmF1bHQ6CisJCXJldHVybiAtRUlOVkFMOworCX0KIAotCXJldHVy
biBpOTE1X2dlbV9tbWFwX2d0dChmaWxlLCBkZXYsIGFyZ3MtPmhhbmRsZSwgJmFyZ3MtPm9mZnNl
dCk7CisJcmV0dXJuIF9fYXNzaWduX21tYXBfb2Zmc2V0KGZpbGUsIGFyZ3MtPmhhbmRsZSwgdHlw
ZSwgJmFyZ3MtPm9mZnNldCk7Cit9CisKK3N0YXRpYyB2b2lkIHZtX29wZW4oc3RydWN0IHZtX2Fy
ZWFfc3RydWN0ICp2bWEpCit7CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbyA9IHZtYS0+
dm1fcHJpdmF0ZV9kYXRhOworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSBtbW8t
Pm9iajsKKworCUdFTV9CVUdfT04oIW9iaik7CisJaTkxNV9nZW1fb2JqZWN0X2dldChvYmopOwor
fQorCitzdGF0aWMgdm9pZCB2bV9jbG9zZShzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKK3sK
KwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1vID0gdm1hLT52bV9wcml2YXRlX2RhdGE7CisJ
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IG1tby0+b2JqOworCisJR0VNX0JVR19P
Tighb2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7Cit9CisKK3N0YXRpYyBjb25zdCBz
dHJ1Y3Qgdm1fb3BlcmF0aW9uc19zdHJ1Y3Qgdm1fb3BzX2d0dCA9IHsKKwkuZmF1bHQgPSB2bV9m
YXVsdF9ndHQsCisJLm9wZW4gPSB2bV9vcGVuLAorCS5jbG9zZSA9IHZtX2Nsb3NlLAorfTsKKwor
c3RhdGljIGNvbnN0IHN0cnVjdCB2bV9vcGVyYXRpb25zX3N0cnVjdCB2bV9vcHNfY3B1ID0gewor
CS5mYXVsdCA9IHZtX2ZhdWx0X2NwdSwKKwkub3BlbiA9IHZtX29wZW4sCisJLmNsb3NlID0gdm1f
Y2xvc2UsCit9OworCisvKgorICogVGhpcyBvdmVyY29tZXMgdGhlIGxpbWl0YXRpb24gaW4gZHJt
X2dlbV9tbWFwJ3MgYXNzaWdubWVudCBvZiBhCisgKiBkcm1fZ2VtX29iamVjdCBhcyB0aGUgdm1h
LT52bV9wcml2YXRlX2RhdGEuIFNpbmNlIHdlIG5lZWQgdG8KKyAqIGJlIGFibGUgdG8gcmVzb2x2
ZSBtdWx0aXBsZSBtbWFwIG9mZnNldHMgd2hpY2ggY291bGQgYmUgdGllZAorICogdG8gYSBzaW5n
bGUgZ2VtIG9iamVjdC4KKyAqLworaW50IGk5MTVfZ2VtX21tYXAoc3RydWN0IGZpbGUgKmZpbHAs
IHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKQoreworCXN0cnVjdCBkcm1fdm1hX29mZnNldF9u
b2RlICpub2RlOworCXN0cnVjdCBkcm1fZmlsZSAqcHJpdiA9IGZpbHAtPnByaXZhdGVfZGF0YTsK
KwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gcHJpdi0+bWlub3ItPmRldjsKKwlzdHJ1Y3QgaTkx
NV9tbWFwX29mZnNldCAqbW1vID0gTlVMTDsKKwlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaiA9
IE5VTEw7CisKKwlpZiAoZHJtX2Rldl9pc191bnBsdWdnZWQoZGV2KSkKKwkJcmV0dXJuIC1FTk9E
RVY7CisKKwlkcm1fdm1hX29mZnNldF9sb2NrX2xvb2t1cChkZXYtPnZtYV9vZmZzZXRfbWFuYWdl
cik7CisJbm9kZSA9IGRybV92bWFfb2Zmc2V0X2V4YWN0X2xvb2t1cF9sb2NrZWQoZGV2LT52bWFf
b2Zmc2V0X21hbmFnZXIsCisJCQkJCQkgIHZtYS0+dm1fcGdvZmYsCisJCQkJCQkgIHZtYV9wYWdl
cyh2bWEpKTsKKwlpZiAobGlrZWx5KG5vZGUpKSB7CisJCW1tbyA9IGNvbnRhaW5lcl9vZihub2Rl
LCBzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCwKKwkJCQkgICB2bWFfbm9kZSk7CisJCS8qCisJCSAq
IEluIG91ciBkZXBlbmRlbmN5IGNoYWluLCB0aGUgZHJtX3ZtYV9vZmZzZXRfbm9kZQorCQkgKiBk
ZXBlbmRzIG9uIHRoZSB2YWxpZGl0eSBvZiB0aGUgbW1vLCB3aGljaCBkZXBlbmRzIG9uCisJCSAq
IHRoZSBnZW0gb2JqZWN0LiBIb3dldmVyIHRoZSBvbmx5IHJlZmVyZW5jZSB3ZSBoYXZlCisJCSAq
IGF0IHRoaXMgcG9pbnQgaXMgdGhlIG1tbyAoYXMgdGhlIHBhcmVudCBvZiB0aGUgbm9kZSkuCisJ
CSAqIFRyeSB0byBjaGVjayBpZiB0aGUgZ2VtIG9iamVjdCB3YXMgYXQgbGVhc3QgY2xlYXJlZC4K
KwkJICovCisJCWlmICghbW1vIHx8ICFtbW8tPm9iaikgeworCQkJZHJtX3ZtYV9vZmZzZXRfdW5s
b2NrX2xvb2t1cChkZXYtPnZtYV9vZmZzZXRfbWFuYWdlcik7CisJCQlyZXR1cm4gLUVJTlZBTDsK
KwkJfQorCQkvKgorCQkgKiBTa2lwIDAtcmVmY250ZWQgb2JqZWN0cyBhcyBpdCBpcyBpbiB0aGUg
cHJvY2VzcyBvZiBiZWluZworCQkgKiBkZXN0cm95ZWQgYW5kIHdpbGwgYmUgaW52YWxpZCB3aGVu
IHRoZSB2bWEgbWFuYWdlciBsb2NrCisJCSAqIGlzIHJlbGVhc2VkLgorCQkgKi8KKwkJb2JqID0g
Jm1tby0+b2JqLT5iYXNlOworCQlpZiAoIWtyZWZfZ2V0X3VubGVzc196ZXJvKCZvYmotPnJlZmNv
dW50KSkKKwkJCW9iaiA9IE5VTEw7CisJfQorCWRybV92bWFfb2Zmc2V0X3VubG9ja19sb29rdXAo
ZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIpOworCWlmICghb2JqKQorCQlyZXR1cm4gLUVJTlZBTDsK
KworCWlmICghZHJtX3ZtYV9ub2RlX2lzX2FsbG93ZWQobm9kZSwgcHJpdikpIHsKKwkJZHJtX2dl
bV9vYmplY3RfcHV0X3VubG9ja2VkKG9iaik7CisJCXJldHVybiAtRUFDQ0VTOworCX0KKworCWlm
IChpOTE1X2dlbV9vYmplY3RfaXNfcmVhZG9ubHkodG9faW50ZWxfYm8ob2JqKSkpIHsKKwkJaWYg
KHZtYS0+dm1fZmxhZ3MgJiBWTV9XUklURSkgeworCQkJZHJtX2dlbV9vYmplY3RfcHV0X3VubG9j
a2VkKG9iaik7CisJCQlyZXR1cm4gLUVJTlZBTDsKKwkJfQorCQl2bWEtPnZtX2ZsYWdzICY9IH5W
TV9NQVlXUklURTsKKwl9CisKKwl2bWEtPnZtX2ZsYWdzIHw9IFZNX1BGTk1BUCB8IFZNX0RPTlRF
WFBBTkQgfCBWTV9ET05URFVNUDsKKwl2bWEtPnZtX3ByaXZhdGVfZGF0YSA9IG1tbzsKKworCXN3
aXRjaCAobW1vLT5tbWFwX3R5cGUpIHsKKwljYXNlIEk5MTVfTU1BUF9UWVBFX1dDOgorCQl2bWEt
PnZtX3BhZ2VfcHJvdCA9CisJCQlwZ3Byb3Rfd3JpdGVjb21iaW5lKHZtX2dldF9wYWdlX3Byb3Qo
dm1hLT52bV9mbGFncykpOworCQl2bWEtPnZtX29wcyA9ICZ2bV9vcHNfY3B1OworCQlicmVhazsK
KworCWNhc2UgSTkxNV9NTUFQX1RZUEVfV0I6CisJCXZtYS0+dm1fcGFnZV9wcm90ID0gdm1fZ2V0
X3BhZ2VfcHJvdCh2bWEtPnZtX2ZsYWdzKTsKKwkJdm1hLT52bV9vcHMgPSAmdm1fb3BzX2NwdTsK
KwkJYnJlYWs7CisKKwljYXNlIEk5MTVfTU1BUF9UWVBFX1VDOgorCQl2bWEtPnZtX3BhZ2VfcHJv
dCA9CisJCQlwZ3Byb3Rfbm9uY2FjaGVkKHZtX2dldF9wYWdlX3Byb3Qodm1hLT52bV9mbGFncykp
OworCQl2bWEtPnZtX29wcyA9ICZ2bV9vcHNfY3B1OworCQlicmVhazsKKworCWNhc2UgSTkxNV9N
TUFQX1RZUEVfR1RUOgorCQl2bWEtPnZtX3BhZ2VfcHJvdCA9CisJCQlwZ3Byb3Rfd3JpdGVjb21i
aW5lKHZtX2dldF9wYWdlX3Byb3Qodm1hLT52bV9mbGFncykpOworCQl2bWEtPnZtX29wcyA9ICZ2
bV9vcHNfZ3R0OworCQlicmVhazsKKwl9CisJdm1hLT52bV9wYWdlX3Byb3QgPSBwZ3Byb3RfZGVj
cnlwdGVkKHZtYS0+dm1fcGFnZV9wcm90KTsKKworCXJldHVybiAwOwogfQogCiAjaWYgSVNfRU5B
QkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1QpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX21tYW4uaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjg2
MmUwMWI3Y2I2OQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9tbWFuLmgKQEAgLTAsMCArMSwzMSBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBNSVQKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgor
ICovCisKKyNpZm5kZWYgX19JOTE1X0dFTV9NTUFOX0hfXworI2RlZmluZSBfX0k5MTVfR0VNX01N
QU5fSF9fCisKKyNpbmNsdWRlIDxsaW51eC9tbV90eXBlcy5oPgorI2luY2x1ZGUgPGxpbnV4L3R5
cGVzLmg+CisKK3N0cnVjdCBkcm1fZGV2aWNlOworc3RydWN0IGRybV9maWxlOworc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3Q7CitzdHJ1Y3QgZmlsZTsKK3N0cnVjdCBpOTE1X21tYXBfb2Zmc2V0
Oworc3RydWN0IG11dGV4OworCitpbnQgaTkxNV9nZW1fbW1hcF9ndHRfdmVyc2lvbih2b2lkKTsK
K2ludCBpOTE1X2dlbV9tbWFwKHN0cnVjdCBmaWxlICpmaWxwLCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1
Y3QgKnZtYSk7CisKK2ludCBpOTE1X2dlbV9kdW1iX21tYXBfb2Zmc2V0KHN0cnVjdCBkcm1fZmls
ZSAqZmlsZV9wcml2LAorCQkJICAgICAgc3RydWN0IGRybV9kZXZpY2UgKmRldiwKKwkJCSAgICAg
IHUzMiBoYW5kbGUsIHU2NCAqb2Zmc2V0KTsKKwordm9pZCBfX2k5MTVfZ2VtX29iamVjdF9yZWxl
YXNlX21tYXBfZ3R0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopOwordm9pZCBpOTE1
X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmop
Owordm9pZCBpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqKTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fb2JqZWN0LmMKaW5kZXggNDU4OTQ1ZTE4MjNlLi5iNzM1NTQ5ZDk2YjQgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKQEAgLTI5LDYgKzI5LDcg
QEAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgogI2luY2x1ZGUgImk5MTVfZ2VtX2NsZmx1c2guaCIK
ICNpbmNsdWRlICJpOTE1X2dlbV9jb250ZXh0LmgiCisjaW5jbHVkZSAiaTkxNV9nZW1fbW1hbi5o
IgogI2luY2x1ZGUgImk5MTVfZ2VtX29iamVjdC5oIgogI2luY2x1ZGUgImk5MTVfZ2xvYmFscy5o
IgogI2luY2x1ZGUgImk5MTVfdHJhY2UuaCIKQEAgLTYxLDYgKzYyLDkgQEAgdm9pZCBpOTE1X2dl
bV9vYmplY3RfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCiAJSU5JVF9M
SVNUX0hFQUQoJm9iai0+bHV0X2xpc3QpOwogCisJc3Bpbl9sb2NrX2luaXQoJm9iai0+bW1vLmxv
Y2spOworCUlOSVRfTElTVF9IRUFEKCZvYmotPm1tby5vZmZzZXRzKTsKKwogCWluaXRfcmN1X2hl
YWQoJm9iai0+cmN1KTsKIAogCW9iai0+b3BzID0gb3BzOwpAQCAtOTcsNiArMTAxLDcgQEAgdm9p
ZCBpOTE1X2dlbV9jbG9zZV9vYmplY3Qoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW0sIHN0cnVj
dCBkcm1fZmlsZSAqZmlsZSkKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gdG9f
aW50ZWxfYm8oZ2VtKTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmcHJpdiA9IGZp
bGUtPmRyaXZlcl9wcml2OwogCXN0cnVjdCBpOTE1X2x1dF9oYW5kbGUgKmx1dCwgKmxuOworCXN0
cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW8sICpvbjsKIAlMSVNUX0hFQUQoY2xvc2UpOwogCiAJ
aTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqKTsKQEAgLTExMSw2ICsxMTYsMTcgQEAgdm9pZCBpOTE1
X2dlbV9jbG9zZV9vYmplY3Qoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW0sIHN0cnVjdCBkcm1f
ZmlsZSAqZmlsZSkKIAl9CiAJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmopOwogCisJc3Bpbl9s
b2NrKCZvYmotPm1tby5sb2NrKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUobW1vLCBvbiwg
Jm9iai0+bW1vLm9mZnNldHMsIG9mZnNldCkgeworCQlpZiAobW1vLT5maWxlICE9IGZpbGUpCisJ
CQljb250aW51ZTsKKworCQlzcGluX3VubG9jaygmb2JqLT5tbW8ubG9jayk7CisJCWRybV92bWFf
bm9kZV9yZXZva2UoJm1tby0+dm1hX25vZGUsIGZpbGUpOworCQlzcGluX2xvY2soJm9iai0+bW1v
LmxvY2spOworCX0KKwlzcGluX3VubG9jaygmb2JqLT5tbW8ubG9jayk7CisKIAlsaXN0X2Zvcl9l
YWNoX2VudHJ5X3NhZmUobHV0LCBsbiwgJmNsb3NlLCBvYmpfbGluaykgewogCQlzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4ID0gbHV0LT5jdHg7CiAJCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwpA
QCAtMTU4LDYgKzE3NCw4IEBAIHN0YXRpYyB2b2lkIF9faTkxNV9nZW1fZnJlZV9vYmplY3RzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCiAJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVf
cG1fZ2V0KCZpOTE1LT5ydW50aW1lX3BtKTsKIAlsbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKG9i
aiwgb24sIGZyZWVkLCBmcmVlZCkgeworCQlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1vLCAq
bW47CisKIAkJdHJhY2VfaTkxNV9nZW1fb2JqZWN0X2Rlc3Ryb3kob2JqKTsKIAogCQlpZiAoIWxp
c3RfZW1wdHkoJm9iai0+dm1hLmxpc3QpKSB7CkBAIC0xODMsNiArMjAxLDE0IEBAIHN0YXRpYyB2
b2lkIF9faTkxNV9nZW1fZnJlZV9vYmplY3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAogCQkJc3Bpbl91bmxvY2soJm9iai0+dm1hLmxvY2spOwogCQl9CiAKKwkJaTkxNV9nZW1fb2Jq
ZWN0X3JlbGVhc2VfbW1hcChvYmopOworCisJCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShtbW8s
IG1uLCAmb2JqLT5tbW8ub2Zmc2V0cywgb2Zmc2V0KSB7CisJCQlkcm1fdm1hX29mZnNldF9yZW1v
dmUob2JqLT5iYXNlLmRldi0+dm1hX29mZnNldF9tYW5hZ2VyLAorCQkJCQkgICAgICAmbW1vLT52
bWFfbm9kZSk7CisJCQlrZnJlZShtbW8pOworCQl9CisKIAkJR0VNX0JVR19PTihhdG9taWNfcmVh
ZCgmb2JqLT5iaW5kX2NvdW50KSk7CiAJCUdFTV9CVUdfT04ob2JqLT51c2VyZmF1bHRfY291bnQp
OwogCQlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZvYmotPmx1dF9saXN0KSk7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmgKaW5kZXggZTU3NTBkNTA2Y2M5Li5hMWVi
N2MwYjIzYWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9v
YmplY3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmgK
QEAgLTEzMiwxMyArMTMyLDEzIEBAIHZvaWQgaTkxNV9nZW1fb2JqZWN0X3VubG9ja19mZW5jZShz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogc3RhdGljIGlubGluZSB2b2lkCiBpOTE1
X2dlbV9vYmplY3Rfc2V0X3JlYWRvbmx5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmop
CiB7Ci0Jb2JqLT5iYXNlLnZtYV9ub2RlLnJlYWRvbmx5ID0gdHJ1ZTsKKwlvYmotPmZsYWdzIHw9
IEk5MTVfQk9fUkVBRE9OTFk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgYm9vbAogaTkxNV9nZW1fb2Jq
ZWN0X2lzX3JlYWRvbmx5KGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiB7
Ci0JcmV0dXJuIG9iai0+YmFzZS52bWFfbm9kZS5yZWFkb25seTsKKwlyZXR1cm4gb2JqLT5mbGFn
cyAmIEk5MTVfQk9fUkVBRE9OTFk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgYm9vbApAQCAtMzg3LDkg
KzM4Nyw2IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX3Bh
Z2VzKG9iaik7CiB9CiAKLXZvaWQgX19pOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKHN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopOwotdm9pZCBpOTE1X2dlbV9vYmplY3RfcmVsZWFz
ZV9tbWFwKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopOwotCiB2b2lkCiBpOTE1X2dl
bV9vYmplY3RfZmx1c2hfd3JpdGVfZG9tYWluKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmosCiAJCQkJICAgdW5zaWduZWQgaW50IGZsdXNoX2RvbWFpbnMpOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCmluZGV4IDE1ZjgyOTdkYzM0
ZS4uMmQ0MDRlNmY2M2RmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fb2JqZWN0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX29iamVjdF90eXBlcy5oCkBAIC02Myw2ICs2MywyMyBAQCBzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdF9vcHMgewogCXZvaWQgKCpyZWxlYXNlKShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqKTsKIH07CiAKK2VudW0gaTkxNV9tbWFwX3R5cGUgeworCUk5MTVfTU1BUF9UWVBFX0dU
VCA9IDAsCisJSTkxNV9NTUFQX1RZUEVfV0MsCisJSTkxNV9NTUFQX1RZUEVfV0IsCisJSTkxNV9N
TUFQX1RZUEVfVUMsCit9OworCitzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCB7CisJc3RydWN0IGRy
bV9kZXZpY2UgKmRldjsKKwlzdHJ1Y3QgZHJtX3ZtYV9vZmZzZXRfbm9kZSB2bWFfbm9kZTsKKwlz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOworCXN0cnVjdCBkcm1fZmlsZSAqZmlsZTsK
KwllbnVtIGk5MTVfbW1hcF90eXBlIG1tYXBfdHlwZTsKKworCXN0cnVjdCBsaXN0X2hlYWQgb2Zm
c2V0OworfTsKKwogc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgewogCXN0cnVjdCBkcm1fZ2Vt
X29iamVjdCBiYXNlOwogCkBAIC0xMTgsMTIgKzEzNSwxOCBAQCBzdHJ1Y3QgZHJtX2k5MTVfZ2Vt
X29iamVjdCB7CiAJdW5zaWduZWQgaW50IHVzZXJmYXVsdF9jb3VudDsKIAlzdHJ1Y3QgbGlzdF9o
ZWFkIHVzZXJmYXVsdF9saW5rOwogCisJc3RydWN0IHsKKwkJc3BpbmxvY2tfdCBsb2NrOyAvKiBQ
cm90ZWN0cyBhY2Nlc3MgdG8gbW1vIG9mZnNldHMgKi8KKwkJc3RydWN0IGxpc3RfaGVhZCBvZmZz
ZXRzOworCX0gbW1vOworCiAJSTkxNV9TRUxGVEVTVF9ERUNMQVJFKHN0cnVjdCBsaXN0X2hlYWQg
c3RfbGluayk7CiAKIAl1bnNpZ25lZCBsb25nIGZsYWdzOwogI2RlZmluZSBJOTE1X0JPX0FMTE9D
X0NPTlRJR1VPVVMgQklUKDApCiAjZGVmaW5lIEk5MTVfQk9fQUxMT0NfVk9MQVRJTEUgICBCSVQo
MSkKICNkZWZpbmUgSTkxNV9CT19BTExPQ19GTEFHUyAoSTkxNV9CT19BTExPQ19DT05USUdVT1VT
IHwgSTkxNV9CT19BTExPQ19WT0xBVElMRSkKKyNkZWZpbmUgSTkxNV9CT19SRUFET05MWSAgICAg
ICAgIEJJVCgyKQogCiAJLyoKIAkgKiBJcyB0aGUgb2JqZWN0IHRvIGJlIG1hcHBlZCBhcyByZWFk
LW9ubHkgdG8gdGhlIEdQVQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX3BhZ2VzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcGFnZXMu
YwppbmRleCBmNDAyYzJjNDE1YzIuLjc1MTk3Y2E2OTZhOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMKQEAgLTgsNiArOCw3IEBACiAjaW5jbHVkZSAiaTkxNV9n
ZW1fb2JqZWN0LmgiCiAjaW5jbHVkZSAiaTkxNV9zY2F0dGVybGlzdC5oIgogI2luY2x1ZGUgImk5
MTVfZ2VtX2xtZW0uaCIKKyNpbmNsdWRlICJpOTE1X2dlbV9tbWFuLmgiCiAKIHZvaWQgX19pOTE1
X2dlbV9vYmplY3Rfc2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJ
CQkJIHN0cnVjdCBzZ190YWJsZSAqcGFnZXMsCkBAIC0yMDcsNiArMjA4LDggQEAgaW50IF9faTkx
NV9nZW1fb2JqZWN0X3B1dF9wYWdlcyhzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQog
CQlnb3RvIHVubG9jazsKIAl9CiAKKwlpOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwX29mZnNl
dChvYmopOworCiAJLyoKIAkgKiAtPnB1dF9wYWdlcyBtaWdodCBuZWVkIHRvIGFsbG9jYXRlIG1l
bW9yeSBmb3IgdGhlIGJpdDE3IHN3aXp6bGUKIAkgKiBhcnJheSwgaGVuY2UgcHJvdGVjdCB0aGVt
IGZyb20gYmVpbmcgcmVhcGVkIGJ5IHJlbW92aW5nIHRoZW0gZnJvbSBndHQKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90aWxpbmcuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90aWxpbmcuYwppbmRleCAxZmE1OTJkODJhZjUuLjZjNzgy
NWEyZGMyYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Rp
bGluZy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90aWxpbmcuYwpA
QCAtMTEsNiArMTEsNyBAQAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5jbHVkZSAiaTkxNV9n
ZW0uaCIKICNpbmNsdWRlICJpOTE1X2dlbV9pb2N0bHMuaCIKKyNpbmNsdWRlICJpOTE1X2dlbV9t
bWFuLmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1fb2JqZWN0LmgiCiAKIC8qKgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4uYwppbmRleCA2Y2U5
MTY3ZjhjOWYuLjU5MTQzNWM1ZjM2OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKQEAgLTU2NSwxNiArNTY1LDE2IEBAIHN0YXRp
YyBib29sIGFzc2VydF9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
IAkJCSAgICAgICBpbnQgZXhwZWN0ZWQpCiB7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iajsKLQlpbnQgZXJyOworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW87CiAKIAlvYmog
PSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX2ludGVybmFsKGk5MTUsIHNpemUpOwogCWlmIChJU19F
UlIob2JqKSkKIAkJcmV0dXJuIFBUUl9FUlIob2JqKTsKIAotCWVyciA9IGNyZWF0ZV9tbWFwX29m
ZnNldChvYmopOworCW1tbyA9IG1tYXBfb2Zmc2V0X2F0dGFjaChvYmosIEk5MTVfTU1BUF9PRkZT
RVRfR1RULCBOVUxMKTsKIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAKLQlyZXR1cm4gZXJy
ID09IGV4cGVjdGVkOworCXJldHVybiBQVFJfRVJSX09SX1pFUk8obW1vKSA9PSBleHBlY3RlZDsK
IH0KIAogc3RhdGljIHZvaWQgZGlzYWJsZV9yZXRpcmVfd29ya2VyKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQpAQCAtNjA5LDcgKzYwOSw4IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfb2Zm
c2V0X2V4aGF1c3Rpb24odm9pZCAqYXJnKQogCXN0cnVjdCBkcm1fbW0gKm1tID0gJmk5MTUtPmRy
bS52bWFfb2Zmc2V0X21hbmFnZXItPnZtX2FkZHJfc3BhY2VfbW07CiAJc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3QgZHJtX21tX25vZGUgKmhvbGUsICpuZXh0OwotCWlu
dCBsb29wLCBlcnI7CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbzsKKwlpbnQgbG9vcCwg
ZXJyID0gMDsKIAogCS8qIERpc2FibGUgYmFja2dyb3VuZCByZWFwZXIgKi8KIAlkaXNhYmxlX3Jl
dGlyZV93b3JrZXIoaTkxNSk7CkBAIC02NzMsOSArNjc0LDEwIEBAIHN0YXRpYyBpbnQgaWd0X21t
YXBfb2Zmc2V0X2V4aGF1c3Rpb24odm9pZCAqYXJnKQogCQlnb3RvIG91dDsKIAl9CiAKLQllcnIg
PSBjcmVhdGVfbW1hcF9vZmZzZXQob2JqKTsKLQlpZiAoZXJyKSB7CisJbW1vID0gbW1hcF9vZmZz
ZXRfYXR0YWNoKG9iaiwgSTkxNV9NTUFQX09GRlNFVF9HVFQsIE5VTEwpOworCWlmIChJU19FUlIo
bW1vKSkgewogCQlwcl9lcnIoIlVuYWJsZSB0byBpbnNlcnQgb2JqZWN0IGludG8gcmVjbGFpbWVk
IGhvbGVcbiIpOworCQllcnIgPSBQVFJfRVJSKG1tbyk7CiAJCWdvdG8gZXJyX29iajsKIAl9CiAK
QEAgLTcyNCwxNCArNzI2LDE1IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfb2Zmc2V0X2V4aGF1c3Rp
b24odm9pZCAqYXJnKQogfQogCiAjZGVmaW5lIGV4cGFuZDMyKHgpICgoKHgpIDw8IDApIHwgKCh4
KSA8PCA4KSB8ICgoeCkgPDwgMTYpIHwgKCh4KSA8PCAyNCkpCi1zdGF0aWMgaW50IGlndF9tbWFw
X2d0dCh2b2lkICphcmcpCitzdGF0aWMgaW50IGlndF9tbWFwKHZvaWQgKmFyZywgZW51bSBpOTE1
X21tYXBfdHlwZSB0eXBlKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gYXJn
OwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5MTVfbW1hcF9v
ZmZzZXQgKm1tbzsKIAlzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKmFyZWE7CiAJdW5zaWduZWQgbG9u
ZyBhZGRyOwogCXZvaWQgKnZhZGRyOwotCWludCBlcnIsIGk7CisJaW50IGVyciA9IDAsIGk7CiAK
IAlpZiAoIWk5MTVfZ2d0dF9oYXNfYXBlcnR1cmUoJmk5MTUtPmdndHQpKQogCQlyZXR1cm4gMDsK
QEAgLTc0OSwxOCArNzUyLDE5IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0KHZvaWQgKmFyZykK
IAlpOTE1X2dlbV9vYmplY3RfZmx1c2hfbWFwKG9iaik7CiAJaTkxNV9nZW1fb2JqZWN0X3VucGlu
X21hcChvYmopOwogCi0JZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9iaik7Ci0JaWYgKGVycikK
KwltbW8gPSBtbWFwX29mZnNldF9hdHRhY2gob2JqLCB0eXBlLCBOVUxMKTsKKwlpZiAoSVNfRVJS
KG1tbykpIHsKKwkJZXJyID0gUFRSX0VSUihtbW8pOwogCQlnb3RvIG91dDsKKwl9CiAKLQlhZGRy
ID0gaWd0X21tYXBfbm9kZShpOTE1LCAmb2JqLT5iYXNlLnZtYV9ub2RlLAotCQkJICAgICAwLCBQ
Uk9UX1dSSVRFLCBNQVBfU0hBUkVEKTsKKwlhZGRyID0gaWd0X21tYXBfbm9kZShpOTE1LCAmbW1v
LT52bWFfbm9kZSwgMCwgUFJPVF9XUklURSwgTUFQX1NIQVJFRCk7CiAJaWYgKElTX0VSUl9WQUxV
RShhZGRyKSkgewogCQllcnIgPSBhZGRyOwogCQlnb3RvIG91dDsKIAl9CiAKLQlwcl9kZWJ1Zygi
aWd0X21tYXAob2JqOmd0dCkgQCAlbHhcbiIsIGFkZHIpOworCXByX2RlYnVnKCJpZ3RfbW1hcCgp
IEAgJWx4XG4iLCBhZGRyKTsKIAogCWFyZWEgPSBmaW5kX3ZtYShjdXJyZW50LT5tbSwgYWRkcik7
CiAJaWYgKCFhcmVhKSB7CkBAIC03NjksOCArNzczLDggQEAgc3RhdGljIGludCBpZ3RfbW1hcF9n
dHQodm9pZCAqYXJnKQogCQlnb3RvIG91dF91bm1hcDsKIAl9CiAKLQlpZiAoYXJlYS0+dm1fcHJp
dmF0ZV9kYXRhICE9IG9iaikgewotCQlwcl9lcnIoInZtX2FyZWFfc3RydWN0IGRpZCBub3QgcG9p
bnQgYmFjayB0byBvdXIgb2JqZWN0IVxuIik7CisJaWYgKGFyZWEtPnZtX3ByaXZhdGVfZGF0YSAh
PSBtbW8pIHsKKwkJcHJfZXJyKCJ2bV9hcmVhX3N0cnVjdCBkaWQgbm90IHBvaW50IGJhY2sgdG8g
b3VyIG1tYXBfb2Zmc2V0IG9iamVjdCFcbiIpOwogCQllcnIgPSAtRUlOVkFMOwogCQlnb3RvIG91
dF91bm1hcDsKIAl9CkBAIC03ODAsMTQgKzc4NCwxNCBAQCBzdGF0aWMgaW50IGlndF9tbWFwX2d0
dCh2b2lkICphcmcpCiAJCXUzMiB4OwogCiAJCWlmIChnZXRfdXNlcih4LCB1eCkpIHsKLQkJCXBy
X2VycigiVW5hYmxlIHRvIHJlYWQgZnJvbSBHVFQgbW1hcCwgb2Zmc2V0OiV6ZFxuIiwKKwkJCXBy
X2VycigiVW5hYmxlIHRvIHJlYWQgZnJvbSBtbWFwLCBvZmZzZXQ6JXpkXG4iLAogCQkJICAgICAg
IGkgKiBzaXplb2YoeCkpOwogCQkJZXJyID0gLUVGQVVMVDsKIAkJCWJyZWFrOwogCQl9CiAKIAkJ
aWYgKHggIT0gZXhwYW5kMzIoUE9JU09OX0lOVVNFKSkgewotCQkJcHJfZXJyKCJSZWFkIGluY29y
cmVjdCB2YWx1ZSBmcm9tIEdUVCBtbWFwLCBvZmZzZXQ6JXpkLCBmb3VuZDoleCwgZXhwZWN0ZWQ6
JXhcbiIsCisJCQlwcl9lcnIoIlJlYWQgaW5jb3JyZWN0IHZhbHVlIGZyb20gbW1hcCwgb2Zmc2V0
OiV6ZCwgZm91bmQ6JXgsIGV4cGVjdGVkOiV4XG4iLAogCQkJICAgICAgIGkgKiBzaXplb2YoeCks
IHgsIGV4cGFuZDMyKFBPSVNPTl9JTlVTRSkpOwogCQkJZXJyID0gLUVJTlZBTDsKIAkJCWJyZWFr
OwpAQCAtNzk1LDcgKzc5OSw3IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0KHZvaWQgKmFyZykK
IAogCQl4ID0gZXhwYW5kMzIoUE9JU09OX0ZSRUUpOwogCQlpZiAocHV0X3VzZXIoeCwgdXgpKSB7
Ci0JCQlwcl9lcnIoIlVuYWJsZSB0byB3cml0ZSB0byBHVFQgbW1hcCwgb2Zmc2V0OiV6ZFxuIiwK
KwkJCXByX2VycigiVW5hYmxlIHRvIHdyaXRlIHRvIG1tYXAsIG9mZnNldDolemRcbiIsCiAJCQkg
ICAgICAgaSAqIHNpemVvZih4KSk7CiAJCQllcnIgPSAtRUZBVUxUOwogCQkJYnJlYWs7CkBAIC04
MTEsNyArODE1LDcgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9ndHQodm9pZCAqYXJnKQogCQlnb3Rv
IG91dDsKIAl9CiAJaWYgKGVyciA9PSAwICYmIG1lbWNocl9pbnYodmFkZHIsIFBPSVNPTl9GUkVF
LCBQQUdFX1NJWkUpKSB7Ci0JCXByX2VycigiV3JpdGUgdmlhIEdHVFQgbW1hcCBkaWQgbm90IGxh
bmQgaW4gYmFja2luZyBzdG9yZVxuIik7CisJCXByX2VycigiV3JpdGUgdmlhIG1tYXAgZGlkIG5v
dCBsYW5kIGluIGJhY2tpbmcgc3RvcmVcbiIpOwogCQllcnIgPSAtRUlOVkFMOwogCX0KIAlpOTE1
X2dlbV9vYmplY3RfdW5waW5fbWFwKG9iaik7CkBAIC04MjEsNiArODI1LDE2IEBAIHN0YXRpYyBp
bnQgaWd0X21tYXBfZ3R0KHZvaWQgKmFyZykKIAlyZXR1cm4gZXJyOwogfQogCitzdGF0aWMgaW50
IGlndF9tbWFwX2d0dCh2b2lkICphcmcpCit7CisJcmV0dXJuIGlndF9tbWFwKGFyZywgSTkxNV9N
TUFQX1RZUEVfR1RUKTsKK30KKworc3RhdGljIGludCBpZ3RfbW1hcF9jcHUodm9pZCAqYXJnKQor
eworCXJldHVybiBpZ3RfbW1hcChhcmcsIEk5MTVfTU1BUF9UWVBFX1dDKTsKK30KKwogc3RhdGlj
IGludCBjaGVja19wcmVzZW50X3B0ZShwdGVfdCAqcHRlLCB1bnNpZ25lZCBsb25nIGFkZHIsIHZv
aWQgKmRhdGEpCiB7CiAJaWYgKCFwdGVfcHJlc2VudCgqcHRlKSB8fCBwdGVfbm9uZSgqcHRlKSkg
ewpAQCAtODczLDEwICs4ODcsMTEgQEAgc3RhdGljIGludCBwcmVmYXVsdF9yYW5nZSh1NjQgc3Rh
cnQsIHU2NCBsZW4pCiAJcmV0dXJuIF9fZ2V0X3VzZXIoYywgZW5kIC0gMSk7CiB9CiAKLXN0YXRp
YyBpbnQgaWd0X21tYXBfZ3R0X3Jldm9rZSh2b2lkICphcmcpCitzdGF0aWMgaW50IGlndF9tbWFw
X3Jldm9rZSh2b2lkICphcmcsIGVudW0gaTkxNV9tbWFwX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqOworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW87CiAJdW5zaWduZWQgbG9uZyBh
ZGRyOwogCWludCBlcnI7CiAKQEAgLTg4NywxMiArOTAyLDEzIEBAIHN0YXRpYyBpbnQgaWd0X21t
YXBfZ3R0X3Jldm9rZSh2b2lkICphcmcpCiAJaWYgKElTX0VSUihvYmopKQogCQlyZXR1cm4gUFRS
X0VSUihvYmopOwogCi0JZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9iaik7Ci0JaWYgKGVycikK
KwltbW8gPSBtbWFwX29mZnNldF9hdHRhY2gob2JqLCB0eXBlLCBOVUxMKTsKKwlpZiAoSVNfRVJS
KG1tbykpIHsKKwkJZXJyID0gUFRSX0VSUihtbW8pOwogCQlnb3RvIG91dDsKKwl9CiAKLQlhZGRy
ID0gaWd0X21tYXBfbm9kZShpOTE1LCAmb2JqLT5iYXNlLnZtYV9ub2RlLAotCQkJICAgICAwLCBQ
Uk9UX1dSSVRFLCBNQVBfU0hBUkVEKTsKKwlhZGRyID0gaWd0X21tYXBfbm9kZShpOTE1LCAmbW1v
LT52bWFfbm9kZSwgMCwgUFJPVF9XUklURSwgTUFQX1NIQVJFRCk7CiAJaWYgKElTX0VSUl9WQUxV
RShhZGRyKSkgewogCQllcnIgPSBhZGRyOwogCQlnb3RvIG91dDsKQEAgLTkwMiw3ICs5MTgsOCBA
QCBzdGF0aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uodm9pZCAqYXJnKQogCWlmIChlcnIpCiAJ
CWdvdG8gb3V0X3VubWFwOwogCi0JR0VNX0JVR19PTighYXRvbWljX3JlYWQoJm9iai0+YmluZF9j
b3VudCkpOworCUdFTV9CVUdfT04obW1vLT5tbWFwX3R5cGUgPT0gSTkxNV9NTUFQX1RZUEVfR1RU
ICYmCisJCSAgICFhdG9taWNfcmVhZCgmb2JqLT5iaW5kX2NvdW50KSk7CiAKIAllcnIgPSBjaGVj
a19wcmVzZW50KGFkZHIsIG9iai0+YmFzZS5zaXplKTsKIAlpZiAoZXJyKQpAQCAtOTIwLDYgKzkz
NywxNSBAQCBzdGF0aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uodm9pZCAqYXJnKQogCX0KIAlH
RU1fQlVHX09OKGF0b21pY19yZWFkKCZvYmotPmJpbmRfY291bnQpKTsKIAorCWlmICh0eXBlICE9
IEk5MTVfTU1BUF9UWVBFX0dUVCkgeworCQlfX2k5MTVfZ2VtX29iamVjdF9wdXRfcGFnZXMob2Jq
KTsKKwkJaWYgKGk5MTVfZ2VtX29iamVjdF9oYXNfcGFnZXMob2JqKSkgeworCQkJcHJfZXJyKCJG
YWlsZWQgdG8gcHV0LXBhZ2VzIG9iamVjdCFcbiIpOworCQkJZXJyID0gLUVJTlZBTDsKKwkJCWdv
dG8gb3V0X3VubWFwOworCQl9CisJfQorCiAJZXJyID0gY2hlY2tfYWJzZW50KGFkZHIsIG9iai0+
YmFzZS5zaXplKTsKIAlpZiAoZXJyKQogCQlnb3RvIG91dF91bm1hcDsKQEAgLTkzMSw2ICs5NTcs
MTYgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9ndHRfcmV2b2tlKHZvaWQgKmFyZykKIAlyZXR1cm4g
ZXJyOwogfQogCitzdGF0aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uodm9pZCAqYXJnKQorewor
CXJldHVybiBpZ3RfbW1hcF9yZXZva2UoYXJnLCBJOTE1X01NQVBfVFlQRV9HVFQpOworfQorCitz
dGF0aWMgaW50IGlndF9tbWFwX2NwdV9yZXZva2Uodm9pZCAqYXJnKQoreworCXJldHVybiBpZ3Rf
bW1hcF9yZXZva2UoYXJnLCBJOTE1X01NQVBfVFlQRV9XQyk7Cit9CisKIGludCBpOTE1X2dlbV9t
bWFuX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogCXN0
YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7CkBAIC05MzgsNyArOTc0
LDkgQEAgaW50IGk5MTVfZ2VtX21tYW5fbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCiAJCVNVQlRFU1QoaWd0X3Ntb2tlX3RpbGluZyksCiAJCVNVQlRFU1QoaWd0
X21tYXBfb2Zmc2V0X2V4aGF1c3Rpb24pLAogCQlTVUJURVNUKGlndF9tbWFwX2d0dCksCisJCVNV
QlRFU1QoaWd0X21tYXBfY3B1KSwKIAkJU1VCVEVTVChpZ3RfbW1hcF9ndHRfcmV2b2tlKSwKKwkJ
U1VCVEVTVChpZ3RfbW1hcF9jcHVfcmV2b2tlKSwKIAl9OwogCiAJcmV0dXJuIGk5MTVfc3VidGVz
dHModGVzdHMsIGk5MTUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKaW5kZXgg
MzYxODkyMzhlMTNjLi4wZTk0YjcyMGM5OTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3Jlc2V0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
cmVzZXQuYwpAQCAtNjc4LDggKzY3OCwxMyBAQCBzdGF0aWMgdm9pZCByZXZva2VfbW1hcHMoc3Ry
dWN0IGludGVsX2d0ICpndCkKIAkJCWNvbnRpbnVlOwogCiAJCUdFTV9CVUdfT04odm1hLT5mZW5j
ZSAhPSAmZ3QtPmdndHQtPmZlbmNlX3JlZ3NbaV0pOwotCQlub2RlID0gJnZtYS0+b2JqLT5iYXNl
LnZtYV9ub2RlOworCisJCWlmICghdm1hLT5tbW8pCisJCQljb250aW51ZTsKKworCQlub2RlID0g
JnZtYS0+bW1vLT52bWFfbm9kZTsKIAkJdm1hX29mZnNldCA9IHZtYS0+Z2d0dF92aWV3LnBhcnRp
YWwub2Zmc2V0IDw8IFBBR0VfU0hJRlQ7CisKIAkJdW5tYXBfbWFwcGluZ19yYW5nZShndC0+aTkx
NS0+ZHJtLmFub25faW5vZGUtPmlfbWFwcGluZywKIAkJCQkgICAgZHJtX3ZtYV9ub2RlX29mZnNl
dF9hZGRyKG5vZGUpICsgdm1hX29mZnNldCwKIAkJCQkgICAgdm1hLT5zaXplLApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmMKaW5kZXggMzQzNDRiNjMyZTFmLi43M2EzODVmODA5ZDMgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kcnYuYwpAQCAtNjEsNiArNjEsNyBAQAogCiAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2Vt
X2NvbnRleHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1faW9jdGxzLmgiCisjaW5jbHVkZSAi
Z2VtL2k5MTVfZ2VtX21tYW4uaCIKICNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgogI2luY2x1ZGUg
Imd0L2ludGVsX2d0X3BtLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfcmM2LmgiCkBAIC0yNjYwLDE4
ICsyNjYxLDEyIEBAIGNvbnN0IHN0cnVjdCBkZXZfcG1fb3BzIGk5MTVfcG1fb3BzID0gewogCS5y
dW50aW1lX3Jlc3VtZSA9IGludGVsX3J1bnRpbWVfcmVzdW1lLAogfTsKIAotc3RhdGljIGNvbnN0
IHN0cnVjdCB2bV9vcGVyYXRpb25zX3N0cnVjdCBpOTE1X2dlbV92bV9vcHMgPSB7Ci0JLmZhdWx0
ID0gaTkxNV9nZW1fZmF1bHQsCi0JLm9wZW4gPSBkcm1fZ2VtX3ZtX29wZW4sCi0JLmNsb3NlID0g
ZHJtX2dlbV92bV9jbG9zZSwKLX07Ci0KIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRp
b25zIGk5MTVfZHJpdmVyX2ZvcHMgPSB7CiAJLm93bmVyID0gVEhJU19NT0RVTEUsCiAJLm9wZW4g
PSBkcm1fb3BlbiwKIAkucmVsZWFzZSA9IGRybV9yZWxlYXNlLAogCS51bmxvY2tlZF9pb2N0bCA9
IGRybV9pb2N0bCwKLQkubW1hcCA9IGRybV9nZW1fbW1hcCwKKwkubW1hcCA9IGk5MTVfZ2VtX21t
YXAsCiAJLnBvbGwgPSBkcm1fcG9sbCwKIAkucmVhZCA9IGRybV9yZWFkLAogCS5jb21wYXRfaW9j
dGwgPSBpOTE1X2NvbXBhdF9pb2N0bCwKQEAgLTI3MTgsNyArMjcxMyw3IEBAIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX2lvY3RsX2Rlc2MgaTkxNV9pb2N0bHNbXSA9IHsKIAlEUk1fSU9DVExfREVG
X0RSVihJOTE1X0dFTV9QUkVBRCwgaTkxNV9nZW1fcHJlYWRfaW9jdGwsIERSTV9SRU5ERVJfQUxM
T1cpLAogCURSTV9JT0NUTF9ERUZfRFJWKEk5MTVfR0VNX1BXUklURSwgaTkxNV9nZW1fcHdyaXRl
X2lvY3RsLCBEUk1fUkVOREVSX0FMTE9XKSwKIAlEUk1fSU9DVExfREVGX0RSVihJOTE1X0dFTV9N
TUFQLCBpOTE1X2dlbV9tbWFwX2lvY3RsLCBEUk1fUkVOREVSX0FMTE9XKSwKLQlEUk1fSU9DVExf
REVGX0RSVihJOTE1X0dFTV9NTUFQX0dUVCwgaTkxNV9nZW1fbW1hcF9ndHRfaW9jdGwsIERSTV9S
RU5ERVJfQUxMT1cpLAorCURSTV9JT0NUTF9ERUZfRFJWKEk5MTVfR0VNX01NQVBfT0ZGU0VULCBp
OTE1X2dlbV9tbWFwX29mZnNldF9pb2N0bCwgRFJNX1JFTkRFUl9BTExPVyksCiAJRFJNX0lPQ1RM
X0RFRl9EUlYoSTkxNV9HRU1fU0VUX0RPTUFJTiwgaTkxNV9nZW1fc2V0X2RvbWFpbl9pb2N0bCwg
RFJNX1JFTkRFUl9BTExPVyksCiAJRFJNX0lPQ1RMX0RFRl9EUlYoSTkxNV9HRU1fU1dfRklOSVNI
LCBpOTE1X2dlbV9zd19maW5pc2hfaW9jdGwsIERSTV9SRU5ERVJfQUxMT1cpLAogCURSTV9JT0NU
TF9ERUZfRFJWKEk5MTVfR0VNX1NFVF9USUxJTkcsIGk5MTVfZ2VtX3NldF90aWxpbmdfaW9jdGws
IERSTV9SRU5ERVJfQUxMT1cpLApAQCAtMjc2MCw3ICsyNzU1LDYgQEAgc3RhdGljIHN0cnVjdCBk
cm1fZHJpdmVyIGRyaXZlciA9IHsKIAogCS5nZW1fY2xvc2Vfb2JqZWN0ID0gaTkxNV9nZW1fY2xv
c2Vfb2JqZWN0LAogCS5nZW1fZnJlZV9vYmplY3RfdW5sb2NrZWQgPSBpOTE1X2dlbV9mcmVlX29i
amVjdCwKLQkuZ2VtX3ZtX29wcyA9ICZpOTE1X2dlbV92bV9vcHMsCiAKIAkucHJpbWVfaGFuZGxl
X3RvX2ZkID0gZHJtX2dlbV9wcmltZV9oYW5kbGVfdG9fZmQsCiAJLnByaW1lX2ZkX3RvX2hhbmRs
ZSA9IGRybV9nZW1fcHJpbWVfZmRfdG9faGFuZGxlLApAQCAtMjc3MSw3ICsyNzY1LDggQEAgc3Rh
dGljIHN0cnVjdCBkcm1fZHJpdmVyIGRyaXZlciA9IHsKIAkuZ2V0X3NjYW5vdXRfcG9zaXRpb24g
PSBpOTE1X2dldF9jcnRjX3NjYW5vdXRwb3MsCiAKIAkuZHVtYl9jcmVhdGUgPSBpOTE1X2dlbV9k
dW1iX2NyZWF0ZSwKLQkuZHVtYl9tYXBfb2Zmc2V0ID0gaTkxNV9nZW1fbW1hcF9ndHQsCisJLmR1
bWJfbWFwX29mZnNldCA9IGk5MTVfZ2VtX2R1bWJfbW1hcF9vZmZzZXQsCisKIAkuaW9jdGxzID0g
aTkxNV9pb2N0bHMsCiAJLm51bV9pb2N0bHMgPSBBUlJBWV9TSVpFKGk5MTVfaW9jdGxzKSwKIAku
Zm9wcyA9ICZpOTE1X2RyaXZlcl9mb3BzLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKaW5kZXggMTQ3
NDRjMTE0NDc1Li4wZDRhZDE4ZTEwZGQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtMTg1
Nyw5ICsxODU3LDYgQEAgaTkxNV9tdXRleF9sb2NrX2ludGVycnVwdGlibGUoc3RydWN0IGRybV9k
ZXZpY2UgKmRldikKIGludCBpOTE1X2dlbV9kdW1iX2NyZWF0ZShzdHJ1Y3QgZHJtX2ZpbGUgKmZp
bGVfcHJpdiwKIAkJCSBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkJIHN0cnVjdCBkcm1fbW9k
ZV9jcmVhdGVfZHVtYiAqYXJncyk7Ci1pbnQgaTkxNV9nZW1fbW1hcF9ndHQoc3RydWN0IGRybV9m
aWxlICpmaWxlX3ByaXYsIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCi0JCSAgICAgIHUzMiBoYW5k
bGUsIHU2NCAqb2Zmc2V0KTsKLWludCBpOTE1X2dlbV9tbWFwX2d0dF92ZXJzaW9uKHZvaWQpOwog
CiBpbnQgX19tdXN0X2NoZWNrIGk5MTVfZ2VtX3NldF9nbG9iYWxfc2Vxbm8oc3RydWN0IGRybV9k
ZXZpY2UgKmRldiwgdTMyIHNlcW5vKTsKIApAQCAtMTg4Miw3ICsxODc5LDYgQEAgdm9pZCBpOTE1
X2dlbV9kcml2ZXJfcmVsZWFzZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwog
dm9pZCBpOTE1X2dlbV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
CiB2b2lkIGk5MTVfZ2VtX3N1c3BlbmRfbGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwogdm9pZCBpOTE1X2dlbV9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKLXZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYp
OwogCiBpbnQgaTkxNV9nZW1fb3BlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3Ry
dWN0IGRybV9maWxlICpmaWxlKTsKIHZvaWQgaTkxNV9nZW1fcmVsZWFzZShzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMK
aW5kZXggZWI5ZTI2MDljNTY5Li4wN2I3YThhNjcxZDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0u
YwpAQCAtNDQsNiArNDQsNyBAQAogI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9jbGZsdXNoLmgiCiAj
aW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1f
aW9jdGxzLmgiCisjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX21tYW4uaCIKICNpbmNsdWRlICJnZW0v
aTkxNV9nZW1fcG0uaCIKICNpbmNsdWRlICJndC9pbnRlbF9jb250ZXh0LmgiCiAjaW5jbHVkZSAi
Z3QvaW50ZWxfZW5naW5lX3VzZXIuaCIKQEAgLTg4NSw3ICs4ODYsNyBAQCB2b2lkIGk5MTVfZ2Vt
X3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAogCWxpc3Rf
Zm9yX2VhY2hfZW50cnlfc2FmZShvYmosIG9uLAogCQkJCSAmaTkxNS0+Z2d0dC51c2VyZmF1bHRf
bGlzdCwgdXNlcmZhdWx0X2xpbmspCi0JCV9faTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcChv
YmopOworCQlfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfZ3R0KG9iaik7CiAKIAkvKgog
CSAqIFRoZSBmZW5jZSB3aWxsIGJlIGxvc3Qgd2hlbiB0aGUgZGV2aWNlIHBvd2VycyBkb3duLiBJ
ZiBhbnkgd2VyZQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJh
bS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5jCmluZGV4IGNmOGE4YzNl
ZjA0Ny4uNTRmY2U4MWQ1NzI0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dldHBhcmFtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5jCkBA
IC0yLDYgKzIsNyBAQAogICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAogICovCiAKKyNp
bmNsdWRlICJnZW0vaTkxNV9nZW1fbW1hbi5oIgogI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV91
c2VyLmgiCiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV92bWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKaW5k
ZXggZTU1MTJmMjZlMjBhLi41NjRmYTk3NTU4YzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfdm1hLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwpA
QCAtMTA1NCwxNyArMTA1NCwxNiBAQCBzdGF0aWMgdm9pZCBfX2k5MTVfdm1hX2lvdW5tYXAoc3Ry
dWN0IGk5MTVfdm1hICp2bWEpCiAKIHZvaWQgaTkxNV92bWFfcmV2b2tlX21tYXAoc3RydWN0IGk5
MTVfdm1hICp2bWEpCiB7Ci0Jc3RydWN0IGRybV92bWFfb2Zmc2V0X25vZGUgKm5vZGUgPSAmdm1h
LT5vYmotPmJhc2Uudm1hX25vZGU7CisJc3RydWN0IGRybV92bWFfb2Zmc2V0X25vZGUgKm5vZGU7
CiAJdTY0IHZtYV9vZmZzZXQ7CiAKLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZ2bWEtPnZtLT5tdXRl
eCk7Ci0KIAlpZiAoIWk5MTVfdm1hX2hhc191c2VyZmF1bHQodm1hKSkKIAkJcmV0dXJuOwogCiAJ
R0VNX0JVR19PTighaTkxNV92bWFfaXNfbWFwX2FuZF9mZW5jZWFibGUodm1hKSk7CiAJR0VNX0JV
R19PTighdm1hLT5vYmotPnVzZXJmYXVsdF9jb3VudCk7CiAKKwlub2RlID0gJnZtYS0+bW1vLT52
bWFfbm9kZTsKIAl2bWFfb2Zmc2V0ID0gdm1hLT5nZ3R0X3ZpZXcucGFydGlhbC5vZmZzZXQgPDwg
UEFHRV9TSElGVDsKIAl1bm1hcF9tYXBwaW5nX3JhbmdlKHZtYS0+dm0tPmk5MTUtPmRybS5hbm9u
X2lub2RlLT5pX21hcHBpbmcsCiAJCQkgICAgZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKG5vZGUp
ICsgdm1hX29mZnNldCwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1h
LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5oCmluZGV4IDQ2NTkzMjgxM2JjNS4u
ZjA5ZjRmNTEzYzQxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5o
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmgKQEAgLTYzLDYgKzYzLDkgQEAg
c3RydWN0IGk5MTVfdm1hIHsKIAl1NjQgZGlzcGxheV9hbGlnbm1lbnQ7CiAJc3RydWN0IGk5MTVf
cGFnZV9zaXplcyBwYWdlX3NpemVzOwogCisJLyogbW1hcC1vZmZzZXQgYXNzb2NpYXRlZCB3aXRo
IGZlbmNpbmcgZm9yIHRoaXMgdm1hICovCisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQJKm1tbzsK
KwogCXUzMiBmZW5jZV9zaXplOwogCXUzMiBmZW5jZV9hbGlnbm1lbnQ7CiAKZGlmZiAtLWdpdCBh
L2luY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaCBiL2luY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0u
aAppbmRleCA1NDAwZDdlMDU3ZjEuLjgyOWMwYTQ4NTc3ZiAxMDA2NDQKLS0tIGEvaW5jbHVkZS91
YXBpL2RybS9pOTE1X2RybS5oCisrKyBiL2luY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaApAQCAt
Mzk1LDYgKzM5NSw3IEBAIHR5cGVkZWYgc3RydWN0IF9kcm1faTkxNV9zYXJlYSB7CiAjZGVmaW5l
IERSTV9JT0NUTF9JOTE1X0dFTV9QV1JJVEUJRFJNX0lPVyAoRFJNX0NPTU1BTkRfQkFTRSArIERS
TV9JOTE1X0dFTV9QV1JJVEUsIHN0cnVjdCBkcm1faTkxNV9nZW1fcHdyaXRlKQogI2RlZmluZSBE
Uk1fSU9DVExfSTkxNV9HRU1fTU1BUAkJRFJNX0lPV1IoRFJNX0NPTU1BTkRfQkFTRSArIERSTV9J
OTE1X0dFTV9NTUFQLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX21tYXApCiAjZGVmaW5lIERSTV9JT0NU
TF9JOTE1X0dFTV9NTUFQX0dUVAlEUk1fSU9XUihEUk1fQ09NTUFORF9CQVNFICsgRFJNX0k5MTVf
R0VNX01NQVBfR1RULCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX21tYXBfZ3R0KQorI2RlZmluZSBEUk1f
SU9DVExfSTkxNV9HRU1fTU1BUF9PRkZTRVQJRFJNX0lPV1IoRFJNX0NPTU1BTkRfQkFTRSArIERS
TV9JOTE1X0dFTV9NTUFQX0dUVCwgc3RydWN0IGRybV9pOTE1X2dlbV9tbWFwX29mZnNldCkKICNk
ZWZpbmUgRFJNX0lPQ1RMX0k5MTVfR0VNX1NFVF9ET01BSU4JRFJNX0lPVyAoRFJNX0NPTU1BTkRf
QkFTRSArIERSTV9JOTE1X0dFTV9TRVRfRE9NQUlOLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX3NldF9k
b21haW4pCiAjZGVmaW5lIERSTV9JT0NUTF9JOTE1X0dFTV9TV19GSU5JU0gJRFJNX0lPVyAoRFJN
X0NPTU1BTkRfQkFTRSArIERSTV9JOTE1X0dFTV9TV19GSU5JU0gsIHN0cnVjdCBkcm1faTkxNV9n
ZW1fc3dfZmluaXNoKQogI2RlZmluZSBEUk1fSU9DVExfSTkxNV9HRU1fU0VUX1RJTElORwlEUk1f
SU9XUiAoRFJNX0NPTU1BTkRfQkFTRSArIERSTV9JOTE1X0dFTV9TRVRfVElMSU5HLCBzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX3NldF90aWxpbmcpCkBAIC03OTMsNiArNzk0LDM3IEBAIHN0cnVjdCBkcm1f
aTkxNV9nZW1fbW1hcF9ndHQgewogCV9fdTY0IG9mZnNldDsKIH07CiAKK3N0cnVjdCBkcm1faTkx
NV9nZW1fbW1hcF9vZmZzZXQgeworCS8qKiBIYW5kbGUgZm9yIHRoZSBvYmplY3QgYmVpbmcgbWFw
cGVkLiAqLworCV9fdTMyIGhhbmRsZTsKKwlfX3UzMiBwYWQ7CisJLyoqCisJICogRmFrZSBvZmZz
ZXQgdG8gdXNlIGZvciBzdWJzZXF1ZW50IG1tYXAgY2FsbAorCSAqCisJICogVGhpcyBpcyBhIGZp
eGVkLXNpemUgdHlwZSBmb3IgMzIvNjQgY29tcGF0aWJpbGl0eS4KKwkgKi8KKwlfX3U2NCBvZmZz
ZXQ7CisKKwkvKioKKwkgKiBGbGFncyBmb3IgZXh0ZW5kZWQgYmVoYXZpb3VyLgorCSAqCisJICog
SXQgaXMgbWFuZGF0b3J5IHRoYXQgb25lIG9mIHRoZSBNTUFQX09GRlNFVCB0eXBlcworCSAqIChH
VFQsIFdDLCBXQiwgVUMsIGV0Yykgc2hvdWxkIGJlIGluY2x1ZGVkLgorCSAqLworCV9fdTY0IGZs
YWdzOworI2RlZmluZSBJOTE1X01NQVBfT0ZGU0VUX0dUVCAwCisjZGVmaW5lIEk5MTVfTU1BUF9P
RkZTRVRfV0MgIDEKKyNkZWZpbmUgSTkxNV9NTUFQX09GRlNFVF9XQiAgMgorI2RlZmluZSBJOTE1
X01NQVBfT0ZGU0VUX1VDICAzCisKKwkvKgorCSAqIFplcm8tdGVybWluYXRlZCBjaGFpbiBvZiBl
eHRlbnNpb25zLgorCSAqCisJICogTm8gY3VycmVudCBleHRlbnNpb25zIGRlZmluZWQ7IG1iei4K
KwkgKi8KKwlfX3U2NCBleHRlbnNpb25zOworfTsKKwogc3RydWN0IGRybV9pOTE1X2dlbV9zZXRf
ZG9tYWluIHsKIAkvKiogSGFuZGxlIGZvciB0aGUgb2JqZWN0ICovCiAJX191MzIgaGFuZGxlOwot
LSAKMi4yNC4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

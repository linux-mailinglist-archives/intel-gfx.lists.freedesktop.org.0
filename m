Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 762313AF8D
	for <lists+intel-gfx@lfdr.de>; Mon, 10 Jun 2019 09:22:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B644F89145;
	Mon, 10 Jun 2019 07:21:57 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9269989132
 for <intel-gfx@lists.freedesktop.org>; Mon, 10 Jun 2019 07:21:51 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16848359-1500050 
 for multiple; Mon, 10 Jun 2019 08:21:28 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 10 Jun 2019 08:21:04 +0100
Message-Id: <20190610072126.6355-7-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190610072126.6355-1-chris@chris-wilson.co.uk>
References: <20190610072126.6355-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 06/28] drm/i915: Keep contexts pinned until
 after the next kernel context switch
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2UgbmVlZCB0byBrZWVwIHRoZSBjb250ZXh0IGltYWdlIHBpbm5lZCBpbiBtZW1vcnkgdW50aWwg
YWZ0ZXIgdGhlIEdQVQpoYXMgZmluaXNoZWQgd3JpdGluZyBpbnRvIGl0LiBTaW5jZSBpdCBjb250
aW51ZXMgdG8gd3JpdGUgYXMgd2Ugc2lnbmFsCnRoZSBmaW5hbCBicmVhZGNydW1iLCB3ZSBuZWVk
IHRvIGtlZXAgaXQgcGlubmVkIHVudGlsIHRoZSByZXF1ZXN0IGFmdGVyCml0IGlzIGNvbXBsZXRl
LiBDdXJyZW50bHkgd2Uga25vdyB0aGUgb3JkZXIgaW4gd2hpY2ggcmVxdWVzdHMgZXhlY3V0ZSBv
bgplYWNoIGVuZ2luZSwgYW5kIHNvIHRvIHJlbW92ZSB0aGF0IHByZXN1bXB0aW9uIHdlIG5lZWQg
dG8gaWRlbnRpZnkgYQpyZXF1ZXN0L2NvbnRleHQtc3dpdGNoIHdlIGtub3cgbXVzdCBvY2N1ciBh
ZnRlciBvdXIgY29tcGxldGlvbi4gQW55CnJlcXVlc3QgcXVldWVkIGFmdGVyIHRoZSBzaWduYWwg
bXVzdCBpbXBseSBhIGNvbnRleHQgc3dpdGNoLCBmb3IKc2ltcGxpY2l0eSB3ZSB1c2UgYSBmcmVz
aCByZXF1ZXN0IGZyb20gdGhlIGtlcm5lbCBjb250ZXh0LgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMg
V2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyAgIHwgMjQgKystLS0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oICAgfCAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fcG0uYyAgICAgICAgfCAyMCArKysrLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfY29udGV4dC5jICAgICAgIHwgODAgKysrKysrKysrKysrKysrKy0tLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oICAgICAgIHwgIDMgKwogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF90eXBlcy5oIHwgIDYgKy0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oICAgICAgICB8ICAyIC0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jICAgICB8IDIzICstLS0tLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgICAgIHwgIDIgKwogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmggIHwgMTMgKy0tCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9scmMuYyAgICAgICAgICAgfCA2MiArKy0tLS0tLS0tLS0tLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jICAgIHwgNDQgKy0tLS0tLS0t
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvbW9ja19lbmdpbmUuYyAgICAgICAgIHwgMTEgKy0t
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jICAgICAgICAgICAgfCA4MCArKysr
KysrKysrKysrKysrKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oICAgICAg
ICAgICAgfCAgNSArKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMuaCAg
ICAgIHwgIDMgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyAgICAgICAgICAgICAg
IHwgIDQgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMgICAgICAgICAgIHwg
MTUgLS0tLQogLi4uL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19nZW1fZGV2aWNlLmMgIHwg
IDEgLQogMTkgZmlsZXMgY2hhbmdlZCwgMjE0IGluc2VydGlvbnMoKyksIDE4NSBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4
dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwppbmRleCBk
ZDlhYTc3ZTM4YWUuLjFmZGFlM2E2MmNlZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fY29udGV4dC5jCkBAIC02OTEsMTcgKzY5MSw2IEBAIGludCBpOTE1X2dlbV9jb250
ZXh0c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlyZXR1cm4gMDsK
IH0KIAotdm9pZCBpOTE1X2dlbV9jb250ZXh0c19sb3N0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKLXsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBp
bnRlbF9lbmdpbmVfaWQgaWQ7Ci0KLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJpdi0+ZHJt
LnN0cnVjdF9tdXRleCk7Ci0KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdiwgaWQp
Ci0JCWludGVsX2VuZ2luZV9sb3N0X2NvbnRleHQoZW5naW5lKTsKLX0KLQogdm9pZCBpOTE1X2dl
bV9jb250ZXh0c19maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwpAQCAtMTE5OSwxMCArMTE4
OCw2IEBAIGdlbjhfbW9kaWZ5X3JwY3Moc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBzdHJ1Y3Qg
aW50ZWxfc3NldSBzc2V1KQogCWlmIChyZXQpCiAJCWdvdG8gb3V0X2FkZDsKIAotCXJldCA9IGdl
bjhfZW1pdF9ycGNzX2NvbmZpZyhycSwgY2UsIHNzZXUpOwotCWlmIChyZXQpCi0JCWdvdG8gb3V0
X2FkZDsKLQogCS8qCiAJICogR3VhcmFudGVlIGNvbnRleHQgaW1hZ2UgYW5kIHRoZSB0aW1lbGlu
ZSByZW1haW5zIHBpbm5lZCB1bnRpbCB0aGUKIAkgKiBtb2RpZnlpbmcgcmVxdWVzdCBpcyByZXRp
cmVkIGJ5IHNldHRpbmcgdGhlIGNlIGFjdGl2aXR5IHRyYWNrZXIuCkBAIC0xMjEwLDkgKzExOTUs
MTIgQEAgZ2VuOF9tb2RpZnlfcnBjcyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHN0cnVjdCBp
bnRlbF9zc2V1IHNzZXUpCiAJICogQnV0IHdlIG9ubHkgbmVlZCB0byB0YWtlIG9uZSBwaW4gb24g
dGhlIGFjY291bnQgb2YgaXQuIE9yIGluIG90aGVyCiAJICogd29yZHMgdHJhbnNmZXIgdGhlIHBp
bm5lZCBjZSBvYmplY3QgdG8gdHJhY2tlZCBhY3RpdmUgcmVxdWVzdC4KIAkgKi8KLQlpZiAoIWk5
MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQoJmNlLT5hY3RpdmVfdHJhY2tlcikpCi0JCV9faW50ZWxf
Y29udGV4dF9waW4oY2UpOwotCV9faTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoJmNlLT5hY3RpdmVf
dHJhY2tlciwgcnEpOworCUdFTV9CVUdfT04oaTkxNV9hY3RpdmVfaXNfaWRsZSgmY2UtPmFjdGl2
ZSkpOworCXJldCA9IGk5MTVfYWN0aXZlX3JlZigmY2UtPmFjdGl2ZSwgcnEtPmZlbmNlLmNvbnRl
eHQsIHJxKTsKKwlpZiAocmV0KQorCQlnb3RvIG91dF9hZGQ7CisKKwlyZXQgPSBnZW44X2VtaXRf
cnBjc19jb25maWcocnEsIGNlLCBzc2V1KTsKIAogb3V0X2FkZDoKIAlpOTE1X3JlcXVlc3RfYWRk
KHJxKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250
ZXh0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCmluZGV4
IDYzMDM5MmM3N2U0OC4uOTY5MWRkMDYyZjcyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9jb250ZXh0LmgKQEAgLTEzNCw3ICsxMzQsNiBAQCBzdGF0aWMgaW5saW5lIGJv
b2wgaTkxNV9nZW1fY29udGV4dF9pc19rZXJuZWwoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eCkKIAogLyogaTkxNV9nZW1fY29udGV4dC5jICovCiBpbnQgX19tdXN0X2NoZWNrIGk5MTVfZ2Vt
X2NvbnRleHRzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQg
aTkxNV9nZW1fY29udGV4dHNfbG9zdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owogdm9pZCBpOTE1X2dlbV9jb250ZXh0c19maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7CiAKIGludCBpOTE1X2dlbV9jb250ZXh0X29wZW4oc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jCmluZGV4IGEx
YWRkNWU2YjY1OC4uYjBmMzc2MjFkZTlmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fcG0uYwpAQCAtMTAsNiArMTAsMjIgQEAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgogI2luY2x1
ZGUgImk5MTVfZ2xvYmFscy5oIgogCitzdGF0aWMgdm9pZCBjYWxsX2lkbGVfYmFycmllcnMoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCXN0cnVjdCBsbGlzdF9ub2RlICpub2Rl
LCAqbmV4dDsKKworCWxsaXN0X2Zvcl9lYWNoX3NhZmUobm9kZSwgbmV4dCwgbGxpc3RfZGVsX2Fs
bCgmZW5naW5lLT5iYXJyaWVyX3Rhc2tzKSkgeworCQlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVz
dCAqYWN0aXZlID0KKwkJCWNvbnRhaW5lcl9vZigoc3RydWN0IGxpc3RfaGVhZCAqKW5vZGUsCisJ
CQkJICAgICB0eXBlb2YoKmFjdGl2ZSksIGxpbmspOworCisJCUlOSVRfTElTVF9IRUFEKCZhY3Rp
dmUtPmxpbmspOworCQlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+cmVxdWVzdCwgTlVMTCk7CisK
KwkJYWN0aXZlLT5yZXRpcmUoYWN0aXZlLCBOVUxMKTsKKwl9Cit9CisKIHN0YXRpYyB2b2lkIGk5
MTVfZ2VtX3Bhcmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lOwpAQCAtMTcsOCArMzMsMTAgQEAgc3RhdGljIHZvaWQgaTkx
NV9nZW1fcGFyayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAogCWxvY2tkZXBfYXNz
ZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCi0JZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgaTkxNSwgaWQpCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKKwkJ
Y2FsbF9pZGxlX2JhcnJpZXJzKGVuZ2luZSk7IC8qIGNsZWFudXAgYWZ0ZXIgd2VkZ2luZyAqLwog
CQlpOTE1X2dlbV9iYXRjaF9wb29sX2ZpbmkoJmVuZ2luZS0+YmF0Y2hfcG9vbCk7CisJfQogCiAJ
aTkxNV90aW1lbGluZXNfcGFyayhpOTE1KTsKIAlpOTE1X3ZtYV9wYXJrZWQoaTkxNSk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKaW5kZXggN2UyYjE4ZGRkYTE5Li4wMTAy
ZjZiYjYyZWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRl
eHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKQEAgLTYx
LDcgKzYxLDYgQEAgaW50IF9faW50ZWxfY29udGV4dF9kb19waW4oc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQogCiAJCWk5MTVfZ2VtX2NvbnRleHRfZ2V0KGNlLT5nZW1fY29udGV4dCk7IC8qIGZv
ciBjdHgtPnBwZ3R0ICovCiAKLQkJaW50ZWxfY29udGV4dF9nZXQoY2UpOwogCQlzbXBfbWJfX2Jl
Zm9yZV9hdG9taWMoKTsgLyogZmx1c2ggcGluIGJlZm9yZSBpdCBpcyB2aXNpYmxlICovCiAJfQog
CkBAIC04OSwyMCArODgsNDUgQEAgdm9pZCBpbnRlbF9jb250ZXh0X3VucGluKHN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZSkKIAkJY2UtPm9wcy0+dW5waW4oY2UpOwogCiAJCWk5MTVfZ2VtX2NvbnRl
eHRfcHV0KGNlLT5nZW1fY29udGV4dCk7Ci0JCWludGVsX2NvbnRleHRfcHV0KGNlKTsKKwkJaW50
ZWxfY29udGV4dF9pbmFjdGl2ZShjZSk7CiAJfQogCiAJbXV0ZXhfdW5sb2NrKCZjZS0+cGluX211
dGV4KTsKIAlpbnRlbF9jb250ZXh0X3B1dChjZSk7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2Nv
bnRleHRfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCi0JCQkJIHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQorc3RhdGljIGludCBfX2NvbnRleHRfcGluX3N0YXRlKHN0
cnVjdCBpOTE1X3ZtYSAqdm1hLCB1bnNpZ25lZCBsb25nIGZsYWdzKQogewotCXN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZSA9Ci0JCWNvbnRhaW5lcl9vZihhY3RpdmUsIHR5cGVvZigqY2UpLCBhY3Rp
dmVfdHJhY2tlcik7CisJaW50IGVycjsKIAotCWludGVsX2NvbnRleHRfdW5waW4oY2UpOworCWVy
ciA9IGk5MTVfdm1hX3Bpbih2bWEsIDAsIDAsIGZsYWdzIHwgUElOX0dMT0JBTCk7CisJaWYgKGVy
cikKKwkJcmV0dXJuIGVycjsKKworCS8qCisJICogQW5kIG1hcmsgaXQgYXMgYSBnbG9iYWxseSBw
aW5uZWQgb2JqZWN0IHRvIGxldCB0aGUgc2hyaW5rZXIga25vdworCSAqIGl0IGNhbm5vdCByZWNs
YWltIHRoZSBvYmplY3QgdW50aWwgd2UgcmVsZWFzZSBpdC4KKwkgKi8KKwl2bWEtPm9iai0+cGlu
X2dsb2JhbCsrOworCXZtYS0+b2JqLT5tbS5kaXJ0eSA9IHRydWU7CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIHZvaWQgX19jb250ZXh0X3VucGluX3N0YXRlKHN0cnVjdCBpOTE1X3ZtYSAqdm1h
KQoreworCXZtYS0+b2JqLT5waW5fZ2xvYmFsLS07CisJX19pOTE1X3ZtYV91bnBpbih2bWEpOwor
fQorCitzdGF0aWMgdm9pZCBpbnRlbF9jb250ZXh0X3JldGlyZShzdHJ1Y3QgaTkxNV9hY3RpdmUg
KmFjdGl2ZSkKK3sKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UgPSBjb250YWluZXJfb2YoYWN0
aXZlLCB0eXBlb2YoKmNlKSwgYWN0aXZlKTsKKworCWlmIChjZS0+c3RhdGUpCisJCV9fY29udGV4
dF91bnBpbl9zdGF0ZShjZS0+c3RhdGUpOworCisJaW50ZWxfY29udGV4dF9wdXQoY2UpOwogfQog
CiB2b2lkCkBAIC0xMjQsOCArMTQ4LDQ2IEBAIGludGVsX2NvbnRleHRfaW5pdChzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UsCiAKIAltdXRleF9pbml0KCZjZS0+cGluX211dGV4KTsKIAotCWk5MTVf
YWN0aXZlX3JlcXVlc3RfaW5pdCgmY2UtPmFjdGl2ZV90cmFja2VyLAotCQkJCSBOVUxMLCBpbnRl
bF9jb250ZXh0X3JldGlyZSk7CisJaTkxNV9hY3RpdmVfaW5pdChjdHgtPmk5MTUsICZjZS0+YWN0
aXZlLCBpbnRlbF9jb250ZXh0X3JldGlyZSk7Cit9CisKK2ludCBpbnRlbF9jb250ZXh0X2FjdGl2
ZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHVuc2lnbmVkIGxvbmcgZmxhZ3MpCit7CisJaW50
IGVycjsKKworCWlmICghaTkxNV9hY3RpdmVfYWNxdWlyZSgmY2UtPmFjdGl2ZSkpCisJCXJldHVy
biAwOworCisJaW50ZWxfY29udGV4dF9nZXQoY2UpOworCisJaWYgKCFjZS0+c3RhdGUpCisJCXJl
dHVybiAwOworCisJZXJyID0gX19jb250ZXh0X3Bpbl9zdGF0ZShjZS0+c3RhdGUsIGZsYWdzKTsK
KwlpZiAoZXJyKSB7CisJCWk5MTVfYWN0aXZlX2NhbmNlbCgmY2UtPmFjdGl2ZSk7CisJCWludGVs
X2NvbnRleHRfcHV0KGNlKTsKKwkJcmV0dXJuIGVycjsKKwl9CisKKwkvKiBQcmVhbGxvY2F0ZSB0
cmFja2luZyBub2RlcyAqLworCWlmICghaTkxNV9nZW1fY29udGV4dF9pc19rZXJuZWwoY2UtPmdl
bV9jb250ZXh0KSkgeworCQllcnIgPSBpOTE1X2FjdGl2ZV9hY3F1aXJlX3ByZWFsbG9jYXRlX2Jh
cnJpZXIoJmNlLT5hY3RpdmUsCisJCQkJCQkJICAgICAgY2UtPmVuZ2luZSk7CisJCWlmIChlcnIp
IHsKKwkJCWk5MTVfYWN0aXZlX3JlbGVhc2UoJmNlLT5hY3RpdmUpOworCQkJcmV0dXJuIGVycjsK
KwkJfQorCX0KKworCXJldHVybiAwOworfQorCit2b2lkIGludGVsX2NvbnRleHRfaW5hY3RpdmUo
c3RydWN0IGludGVsX2NvbnRleHQgKmNlKQoreworCS8qIE5vZGVzIHByZWFsbG9jYXRlZCBpbiBp
bnRlbF9jb250ZXh0X2FjdGl2ZSgpICovCisJaTkxNV9hY3RpdmVfYWNxdWlyZV9iYXJyaWVyKCZj
ZS0+YWN0aXZlKTsKKwlpOTE1X2FjdGl2ZV9yZWxlYXNlKCZjZS0+YWN0aXZlKTsKIH0KIAogc3Rh
dGljIHZvaWQgaTkxNV9nbG9iYWxfY29udGV4dF9zaHJpbmsodm9pZCkKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2NvbnRleHQuaAppbmRleCA2MzM5MmM4OGNkOTguLmU3MTYyOWY3YzJlMCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuaApAQCAtMTAyLDYgKzEwMiw5
IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpbnRlbF9jb250ZXh0X2V4aXQoc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlKQogCQljZS0+b3BzLT5leGl0KGNlKTsKIH0KIAoraW50IGludGVsX2NvbnRleHRf
YWN0aXZlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdW5zaWduZWQgbG9uZyBmbGFncyk7Cit2
b2lkIGludGVsX2NvbnRleHRfaW5hY3RpdmUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKTsKKwog
c3RhdGljIGlubGluZSBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqaW50ZWxfY29udGV4dF9nZXQoc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlKQogewogCWtyZWZfZ2V0KCZjZS0+cmVmKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHRfdHlwZXMuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHRfdHlwZXMuaAppbmRleCBlNDdkNWI3YWY1
ZDQuLjA4MDQ5ZWU5MWNlZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfY29udGV4dF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2Nv
bnRleHRfdHlwZXMuaApAQCAtNTQsMTAgKzU0LDEwIEBAIHN0cnVjdCBpbnRlbF9jb250ZXh0IHsK
IAlzdHJ1Y3QgbXV0ZXggcGluX211dGV4OyAvKiBndWFyZHMgcGlubmluZyBhbmQgYXNzb2NpYXRl
ZCBvbi1ncHVpbmcgKi8KIAogCS8qKgotCSAqIGFjdGl2ZV90cmFja2VyOiBBY3RpdmUgdHJhY2tl
ciBmb3IgdGhlIGV4dGVybmFsIHJxIGFjdGl2aXR5Ci0JICogb24gdGhpcyBpbnRlbF9jb250ZXh0
IG9iamVjdC4KKwkgKiBhY3RpdmU6IEFjdGl2ZSB0cmFja2VyIGZvciB0aGUgcnEgYWN0aXZpdHkg
KGluYy4gZXh0ZXJuYWwpIG9uIHRoaXMKKwkgKiBpbnRlbF9jb250ZXh0IG9iamVjdC4KIAkgKi8K
LQlzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCBhY3RpdmVfdHJhY2tlcjsKKwlzdHJ1Y3QgaTkx
NV9hY3RpdmUgYWN0aXZlOwogCiAJY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHRfb3BzICpvcHM7
CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKaW5kZXggMjAxYmJkMmE0ZmFm
Li5iOWZkODhmMjE2MDkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2VuZ2luZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCkBA
IC00NjYsOCArNDY2LDYgQEAgc3RhdGljIGlubGluZSB2b2lkIGludGVsX2VuZ2luZV9yZXNldChz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiBib29sIGludGVsX2VuZ2luZV9pc19pZGxl
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CiBib29sIGludGVsX2VuZ2luZXNfYXJl
X2lkbGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIAotdm9pZCBpbnRlbF9l
bmdpbmVfbG9zdF9jb250ZXh0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Ci0KIHZv
aWQgaW50ZWxfZW5naW5lc19yZXNldF9kZWZhdWx0X3N1Ym1pc3Npb24oc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpOwogdW5zaWduZWQgaW50IGludGVsX2VuZ2luZXNfaGFzX2NvbnRleHRf
aXNvbGF0aW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwppbmRleCA2YjgzODk0OGJhMjQuLjk4YjIxNzYy
MTQ3NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2Nz
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKQEAgLTYx
MSw2ICs2MTEsOCBAQCBzdGF0aWMgaW50IGludGVsX2VuZ2luZV9zZXR1cF9jb21tb24oc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewogCWludCBlcnI7CiAKKwlpbml0X2xsaXN0X2hl
YWQoJmVuZ2luZS0+YmFycmllcl90YXNrcyk7CisKIAllcnIgPSBpbml0X3N0YXR1c19wYWdlKGVu
Z2luZSk7CiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKQEAgLTg3MCw2ICs4NzIsNyBAQCB2b2lk
IGludGVsX2VuZ2luZV9jbGVhbnVwX2NvbW1vbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCiAJaWYgKGVuZ2luZS0+cHJlZW1wdF9jb250ZXh0KQogCQlpbnRlbF9jb250ZXh0X3VucGlu
KGVuZ2luZS0+cHJlZW1wdF9jb250ZXh0KTsKIAlpbnRlbF9jb250ZXh0X3VucGluKGVuZ2luZS0+
a2VybmVsX2NvbnRleHQpOworCUdFTV9CVUdfT04oIWxsaXN0X2VtcHR5KCZlbmdpbmUtPmJhcnJp
ZXJfdGFza3MpKTsKIAogCWk5MTVfdGltZWxpbmVfZmluaSgmZW5naW5lLT50aW1lbGluZSk7CiAK
QEAgLTEyMDAsMjYgKzEyMDMsNiBAQCB2b2lkIGludGVsX2VuZ2luZXNfcmVzZXRfZGVmYXVsdF9z
dWJtaXNzaW9uKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCQllbmdpbmUtPnNldF9k
ZWZhdWx0X3N1Ym1pc3Npb24oZW5naW5lKTsKIH0KIAotLyoqCi0gKiBpbnRlbF9lbmdpbmVfbG9z
dF9jb250ZXh0OiBjYWxsZWQgd2hlbiB0aGUgR1BVIGlzIHJlc2V0IGludG8gdW5rbm93biBzdGF0
ZQotICogQGVuZ2luZTogdGhlIGVuZ2luZQotICoKLSAqIFdlIGhhdmUgZWl0aGVyIHJlc2V0IHRo
ZSBHUFUgb3Igb3RoZXJ3aXNlIGFib3V0IHRvIGxvc2Ugc3RhdGUgdHJhY2tpbmcgb2YKLSAqIHRo
ZSBjdXJyZW50IEdQVSBsb2dpY2FsIHN0YXRlIChlLmcuIHN1c3BlbmQpLiBPbiBuZXh0IHVzZSwg
aXQgaXMgdGhlcmVmb3JlCi0gKiBpbXBlcmF0aXZlIHRoYXQgd2UgbWFrZSBubyBwcmVzdW1wdGlv
bnMgYWJvdXQgdGhlIGN1cnJlbnQgc3RhdGUgYW5kIGxvYWQKLSAqIGZyb20gc2NyYXRjaC4KLSAq
Lwotdm9pZCBpbnRlbF9lbmdpbmVfbG9zdF9jb250ZXh0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKLXsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Ci0KLQlsb2NrZGVwX2Fzc2Vy
dF9oZWxkKCZlbmdpbmUtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCi0JY2UgPSBmZXRjaF9h
bmRfemVybygmZW5naW5lLT5sYXN0X3JldGlyZWRfY29udGV4dCk7Ci0JaWYgKGNlKQotCQlpbnRl
bF9jb250ZXh0X3VucGluKGNlKTsKLX0KLQogYm9vbCBpbnRlbF9lbmdpbmVfY2FuX3N0b3JlX2R3
b3JkKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlzd2l0Y2ggKElOVEVMX0dF
TihlbmdpbmUtPmk5MTUpKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9lbmdpbmVfcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9w
bS5jCmluZGV4IDdiZmZhMGM2ZjVhMi4uMjUyODcxNDBmYjYxIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwpAQCAtODgsNiArODgsOCBAQCBzdGF0aWMgYm9vbCBz
d2l0Y2hfdG9fa2VybmVsX2NvbnRleHQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQog
CiAJLyogQ2hlY2sgYWdhaW4gb24gdGhlIG5leHQgcmV0aXJlbWVudC4gKi8KIAllbmdpbmUtPndh
a2VyZWZfc2VyaWFsID0gZW5naW5lLT5zZXJpYWwgKyAxOworCisJaTkxNV9yZXF1ZXN0X2FkZF9i
YXJyaWVycyhycSk7CiAJX19pOTE1X3JlcXVlc3RfY29tbWl0KHJxKTsKIAogCXJldHVybiBmYWxz
ZTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBl
cy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKaW5kZXgg
ZDJkZmY5MDU2ZWEwLi41MmY0OTg3YTU3ZTUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV90eXBlcy5oCkBAIC0xMSw2ICsxMSw3IEBACiAjaW5jbHVkZSA8bGludXgv
aXJxX3dvcmsuaD4KICNpbmNsdWRlIDxsaW51eC9rcmVmLmg+CiAjaW5jbHVkZSA8bGludXgvbGlz
dC5oPgorI2luY2x1ZGUgPGxpbnV4L2xsaXN0Lmg+CiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4K
IAogI2luY2x1ZGUgImk5MTVfZ2VtLmgiCkBAIC0yODgsNiArMjg5LDcgQEAgc3RydWN0IGludGVs
X2VuZ2luZV9jcyB7CiAJc3RydWN0IGludGVsX3JpbmcgKmJ1ZmZlcjsKIAogCXN0cnVjdCBpOTE1
X3RpbWVsaW5lIHRpbWVsaW5lOworCXN0cnVjdCBsbGlzdF9oZWFkIGJhcnJpZXJfdGFza3M7CiAK
IAlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqa2VybmVsX2NvbnRleHQ7IC8qIHBpbm5lZCAqLwogCXN0
cnVjdCBpbnRlbF9jb250ZXh0ICpwcmVlbXB0X2NvbnRleHQ7IC8qIHBpbm5lZDsgb3B0aW9uYWwg
Ki8KQEAgLTQzNywxNyArNDM5LDYgQEAgc3RydWN0IGludGVsX2VuZ2luZV9jcyB7CiAKIAlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyBleGVjbGlzdHM7CiAKLQkvKiBDb250ZXh0cyBhcmUg
cGlubmVkIHdoaWxzdCB0aGV5IGFyZSBhY3RpdmUgb24gdGhlIEdQVS4gVGhlIGxhc3QKLQkgKiBj
b250ZXh0IGV4ZWN1dGVkIHJlbWFpbnMgYWN0aXZlIHdoaWxzdCB0aGUgR1BVIGlzIGlkbGUgLSB0
aGUKLQkgKiBzd2l0Y2ggYXdheSBhbmQgd3JpdGUgdG8gdGhlIGNvbnRleHQgb2JqZWN0IG9ubHkg
b2NjdXJzIG9uIHRoZQotCSAqIG5leHQgZXhlY3V0aW9uLiAgQ29udGV4dHMgYXJlIG9ubHkgdW5w
aW5uZWQgb24gcmV0aXJlbWVudCBvZiB0aGUKLQkgKiBmb2xsb3dpbmcgcmVxdWVzdCBlbnN1cmlu
ZyB0aGF0IHdlIGNhbiBhbHdheXMgd3JpdGUgdG8gdGhlIG9iamVjdAotCSAqIG9uIHRoZSBjb250
ZXh0IHN3aXRjaCBldmVuIGFmdGVyIGlkbGluZy4gQWNyb3NzIHN1c3BlbmQsIHdlIHN3aXRjaAot
CSAqIHRvIHRoZSBrZXJuZWwgY29udGV4dCBhbmQgdHJhc2ggaXQgYXMgdGhlIHNhdmUgbWF5IG5v
dCBoYXBwZW4KLQkgKiBiZWZvcmUgdGhlIGhhcmR3YXJlIGlzIHBvd2VyZWQgZG93bi4KLQkgKi8K
LQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqbGFzdF9yZXRpcmVkX2NvbnRleHQ7Ci0KIAkvKiBzdGF0
dXNfbm90aWZpZXI6IGxpc3Qgb2YgY2FsbGJhY2tzIGZvciBjb250ZXh0LXN3aXRjaCBjaGFuZ2Vz
ICovCiAJc3RydWN0IGF0b21pY19ub3RpZmllcl9oZWFkIGNvbnRleHRfc3RhdHVzX25vdGlmaWVy
OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmluZGV4IDYyMjIwY2Y5ZDI4MS4uYjM5
ZmQzZTc5ZjUxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtMTQyMiw2MCAr
MTQyMiwxMSBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfY29udGV4dF9kZXN0cm95KHN0cnVjdCBr
cmVmICprcmVmKQogCWludGVsX2NvbnRleHRfZnJlZShjZSk7CiB9CiAKLXN0YXRpYyBpbnQgX19j
b250ZXh0X3BpbihzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKLXsKLQl1bnNpZ25lZCBpbnQgZmxhZ3M7
Ci0JaW50IGVycjsKLQotCWZsYWdzID0gUElOX0dMT0JBTCB8IFBJTl9ISUdIOwotCWZsYWdzIHw9
IFBJTl9PRkZTRVRfQklBUyB8IGk5MTVfZ2d0dF9waW5fYmlhcyh2bWEpOwotCi0JZXJyID0gaTkx
NV92bWFfcGluKHZtYSwgMCwgMCwgZmxhZ3MpOwotCWlmIChlcnIpCi0JCXJldHVybiBlcnI7Ci0K
LQl2bWEtPm9iai0+cGluX2dsb2JhbCsrOwotCXZtYS0+b2JqLT5tbS5kaXJ0eSA9IHRydWU7Ci0K
LQlyZXR1cm4gMDsKLX0KLQotc3RhdGljIHZvaWQgX19jb250ZXh0X3VucGluKHN0cnVjdCBpOTE1
X3ZtYSAqdm1hKQotewotCXZtYS0+b2JqLT5waW5fZ2xvYmFsLS07Ci0JX19pOTE1X3ZtYV91bnBp
bih2bWEpOwotfQotCiBzdGF0aWMgdm9pZCBleGVjbGlzdHNfY29udGV4dF91bnBpbihzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UpCiB7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwot
Ci0JLyoKLQkgKiBUaGUgdGFza2xldCBtYXkgc3RpbGwgYmUgdXNpbmcgYSBwb2ludGVyIHRvIG91
ciBzdGF0ZSwgdmlhIGFuCi0JICogb2xkIHJlcXVlc3QuIEhvd2V2ZXIsIHNpbmNlIHdlIGtub3cg
d2Ugb25seSB1bnBpbiB0aGUgY29udGV4dAotCSAqIG9uIHJldGlyZW1lbnQgb2YgdGhlIGZvbGxv
d2luZyByZXF1ZXN0LCB3ZSBrbm93IHRoYXQgdGhlIGxhc3QKLQkgKiByZXF1ZXN0IHJlZmVyZW5j
aW5nIHVzIHdpbGwgaGF2ZSBoYWQgYSBjb21wbGV0aW9uIENTIGludGVycnVwdC4KLQkgKiBJZiB3
ZSBzZWUgdGhhdCBpdCBpcyBzdGlsbCBhY3RpdmUsIGl0IG1lYW5zIHRoYXQgdGhlIHRhc2tsZXQg
aGFzbid0Ci0JICogaGFkIHRoZSBjaGFuY2UgdG8gcnVuIHlldDsgbGV0IGl0IHJ1biBiZWZvcmUg
d2UgdGVhcmRvd24gdGhlCi0JICogcmVmZXJlbmNlIGl0IG1heSB1c2UuCi0JICovCi0JZW5naW5l
ID0gUkVBRF9PTkNFKGNlLT5pbmZsaWdodCk7Ci0JaWYgKHVubGlrZWx5KGVuZ2luZSkpIHsKLQkJ
dW5zaWduZWQgbG9uZyBmbGFnczsKLQotCQlzcGluX2xvY2tfaXJxc2F2ZSgmZW5naW5lLT50aW1l
bGluZS5sb2NrLCBmbGFncyk7Ci0JCXByb2Nlc3NfY3NiKGVuZ2luZSk7Ci0JCXNwaW5fdW5sb2Nr
X2lycXJlc3RvcmUoJmVuZ2luZS0+dGltZWxpbmUubG9jaywgZmxhZ3MpOwotCi0JCUdFTV9CVUdf
T04oUkVBRF9PTkNFKGNlLT5pbmZsaWdodCkpOwotCX0KLQogCWk5MTVfZ2VtX2NvbnRleHRfdW5w
aW5faHdfaWQoY2UtPmdlbV9jb250ZXh0KTsKLQotCWludGVsX3JpbmdfdW5waW4oY2UtPnJpbmcp
OwotCiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChjZS0+c3RhdGUtPm9iaik7Ci0JX19jb250
ZXh0X3VucGluKGNlLT5zdGF0ZSk7CisJaW50ZWxfcmluZ191bnBpbihjZS0+cmluZyk7CiB9CiAK
IHN0YXRpYyB2b2lkCkBAIC0xNTEyLDcgKzE0NjMsMTAgQEAgX19leGVjbGlzdHNfY29udGV4dF9w
aW4oc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCQlnb3RvIGVycjsKIAlHRU1fQlVHX09OKCFj
ZS0+c3RhdGUpOwogCi0JcmV0ID0gX19jb250ZXh0X3BpbihjZS0+c3RhdGUpOworCXJldCA9IGlu
dGVsX2NvbnRleHRfYWN0aXZlKGNlLAorCQkJCSAgIGVuZ2luZS0+aTkxNS0+Z2d0dC5waW5fYmlh
cyB8CisJCQkJICAgUElOX09GRlNFVF9CSUFTIHwKKwkJCQkgICBQSU5fSElHSCk7CiAJaWYgKHJl
dCkKIAkJZ290byBlcnI7CiAKQEAgLTE1MjEsNyArMTQ3NSw3IEBAIF9fZXhlY2xpc3RzX2NvbnRl
eHRfcGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKIAkJCQkJSTkxNV9NQVBfT1ZFUlJJREUp
OwogCWlmIChJU19FUlIodmFkZHIpKSB7CiAJCXJldCA9IFBUUl9FUlIodmFkZHIpOwotCQlnb3Rv
IHVucGluX3ZtYTsKKwkJZ290byB1bnBpbl9hY3RpdmU7CiAJfQogCiAJcmV0ID0gaW50ZWxfcmlu
Z19waW4oY2UtPnJpbmcpOwpAQCAtMTU0Miw4ICsxNDk2LDggQEAgX19leGVjbGlzdHNfY29udGV4
dF9waW4oc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCWludGVsX3JpbmdfdW5waW4oY2UtPnJp
bmcpOwogdW5waW5fbWFwOgogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoY2UtPnN0YXRlLT5v
YmopOwotdW5waW5fdm1hOgotCV9fY29udGV4dF91bnBpbihjZS0+c3RhdGUpOwordW5waW5fYWN0
aXZlOgorCWludGVsX2NvbnRleHRfaW5hY3RpdmUoY2UpOwogZXJyOgogCXJldHVybiByZXQ7CiB9
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMKaW5kZXggZmY1OGQ2
NThlM2UyLi5mYzU5NmFkYzYzN2EgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3JpbmdidWZmZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
aW5nYnVmZmVyLmMKQEAgLTEzNDksNDUgKzEzNDksOSBAQCBzdGF0aWMgdm9pZCBfX2NvbnRleHRf
dW5waW5fcHBndHQoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAkJZ2VuNl9wcGd0dF91
bnBpbihwcGd0dCk7CiB9CiAKLXN0YXRpYyBpbnQgX19jb250ZXh0X3BpbihzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UpCi17Ci0Jc3RydWN0IGk5MTVfdm1hICp2bWE7Ci0JaW50IGVycjsKLQotCXZt
YSA9IGNlLT5zdGF0ZTsKLQlpZiAoIXZtYSkKLQkJcmV0dXJuIDA7Ci0KLQllcnIgPSBpOTE1X3Zt
YV9waW4odm1hLCAwLCAwLCBQSU5fR0xPQkFMIHwgUElOX0hJR0gpOwotCWlmIChlcnIpCi0JCXJl
dHVybiBlcnI7Ci0KLQkvKgotCSAqIEFuZCBtYXJrIGlzIGFzIGEgZ2xvYmFsbHkgcGlubmVkIG9i
amVjdCB0byBsZXQgdGhlIHNocmlua2VyIGtub3cKLQkgKiBpdCBjYW5ub3QgcmVjbGFpbSB0aGUg
b2JqZWN0IHVudGlsIHdlIHJlbGVhc2UgaXQuCi0JICovCi0Jdm1hLT5vYmotPnBpbl9nbG9iYWwr
KzsKLQl2bWEtPm9iai0+bW0uZGlydHkgPSB0cnVlOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRp
YyB2b2lkIF9fY29udGV4dF91bnBpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCi17Ci0Jc3Ry
dWN0IGk5MTVfdm1hICp2bWE7Ci0KLQl2bWEgPSBjZS0+c3RhdGU7Ci0JaWYgKCF2bWEpCi0JCXJl
dHVybjsKLQotCXZtYS0+b2JqLT5waW5fZ2xvYmFsLS07Ci0JaTkxNV92bWFfdW5waW4odm1hKTsK
LX0KLQogc3RhdGljIHZvaWQgcmluZ19jb250ZXh0X3VucGluKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSkKIHsKIAlfX2NvbnRleHRfdW5waW5fcHBndHQoY2UtPmdlbV9jb250ZXh0KTsKLQlfX2Nv
bnRleHRfdW5waW4oY2UpOwogfQogCiBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICoKQEAgLTE0Nzcs
MTggKzE0NDEsMTggQEAgc3RhdGljIGludCByaW5nX2NvbnRleHRfcGluKHN0cnVjdCBpbnRlbF9j
b250ZXh0ICpjZSkKIAkJY2UtPnN0YXRlID0gdm1hOwogCX0KIAotCWVyciA9IF9fY29udGV4dF9w
aW4oY2UpOworCWVyciA9IGludGVsX2NvbnRleHRfYWN0aXZlKGNlLCBQSU5fSElHSCk7CiAJaWYg
KGVycikKIAkJcmV0dXJuIGVycjsKIAogCWVyciA9IF9fY29udGV4dF9waW5fcHBndHQoY2UtPmdl
bV9jb250ZXh0KTsKIAlpZiAoZXJyKQotCQlnb3RvIGVycl91bnBpbjsKKwkJZ290byBlcnJfYWN0
aXZlOwogCiAJcmV0dXJuIDA7CiAKLWVycl91bnBpbjoKLQlfX2NvbnRleHRfdW5waW4oY2UpOwor
ZXJyX2FjdGl2ZToKKwlpbnRlbF9jb250ZXh0X2luYWN0aXZlKGNlKTsKIAlyZXR1cm4gZXJyOwog
fQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9tb2NrX2VuZ2luZS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvbW9ja19lbmdpbmUuYwppbmRleCA2ZDc1NjI3NjllYjIu
LmI3Njc1ZWYxODUyMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvbW9ja19l
bmdpbmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9tb2NrX2VuZ2luZS5jCkBAIC0x
NDYsMTIgKzE0NiwxOCBAQCBzdGF0aWMgdm9pZCBtb2NrX2NvbnRleHRfZGVzdHJveShzdHJ1Y3Qg
a3JlZiAqcmVmKQogCiBzdGF0aWMgaW50IG1vY2tfY29udGV4dF9waW4oc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlKQogeworCWludCByZXQ7CisKIAlpZiAoIWNlLT5yaW5nKSB7CiAJCWNlLT5yaW5n
ID0gbW9ja19yaW5nKGNlLT5lbmdpbmUpOwogCQlpZiAoIWNlLT5yaW5nKQogCQkJcmV0dXJuIC1F
Tk9NRU07CiAJfQogCisJcmV0ID0gaW50ZWxfY29udGV4dF9hY3RpdmUoY2UsIFBJTl9ISUdIKTsK
KwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCiAJbW9ja190aW1lbGluZV9waW4oY2UtPnJpbmct
PnRpbWVsaW5lKTsKIAlyZXR1cm4gMDsKIH0KQEAgLTMyOCwxNCArMzM0LDkgQEAgdm9pZCBtb2Nr
X2VuZ2luZV9mcmVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlzdHJ1Y3Qg
bW9ja19lbmdpbmUgKm1vY2sgPQogCQljb250YWluZXJfb2YoZW5naW5lLCB0eXBlb2YoKm1vY2sp
LCBiYXNlKTsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CiAKIAlHRU1fQlVHX09OKHRpbWVy
X3BlbmRpbmcoJm1vY2stPmh3X2RlbGF5KSk7CiAKLQljZSA9IGZldGNoX2FuZF96ZXJvKCZlbmdp
bmUtPmxhc3RfcmV0aXJlZF9jb250ZXh0KTsKLQlpZiAoY2UpCi0JCWludGVsX2NvbnRleHRfdW5w
aW4oY2UpOwotCiAJaW50ZWxfY29udGV4dF91bnBpbihlbmdpbmUtPmtlcm5lbF9jb250ZXh0KTsK
IAogCWludGVsX2VuZ2luZV9maW5pX2JyZWFkY3J1bWJzKGVuZ2luZSk7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9hY3RpdmUuYwppbmRleCA4NjNhZTEyNzA3YmEuLjEwMGU0MGFmYzlkNiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2FjdGl2ZS5jCkBAIC0xMDAsNyArMTAwLDcgQEAgYWN0aXZlX2luc3RhbmNl
KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCB1NjQgaWR4KQogCQlwYXJlbnQgPSAqcDsKIAogCQlu
b2RlID0gcmJfZW50cnkocGFyZW50LCBzdHJ1Y3QgYWN0aXZlX25vZGUsIG5vZGUpOwotCQlpZiAo
bm9kZS0+dGltZWxpbmUgPT0gaWR4KQorCQlpZiAobm9kZS0+dGltZWxpbmUgPT0gaWR4ICYmICFJ
U19FUlIobm9kZS0+YmFzZS5yZXF1ZXN0KSkKIAkJCWdvdG8gcmVwbGFjZTsKIAogCQlpZiAobm9k
ZS0+dGltZWxpbmUgPCBpZHgpCkBAIC0xNTcsNiArMTU3LDcgQEAgdm9pZCBpOTE1X2FjdGl2ZV9p
bml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCXJlZi0+cmV0aXJlID0gcmV0aXJl
OwogCXJlZi0+dHJlZSA9IFJCX1JPT1Q7CiAJaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KCZyZWYt
Pmxhc3QsIE5VTEwsIGxhc3RfcmV0aXJlKTsKKwlpbml0X2xsaXN0X2hlYWQoJnJlZi0+YmFycmll
cnMpOwogCXJlZi0+Y291bnQgPSAwOwogfQogCkBAIC0yNjMsNiArMjY0LDgzIEBAIHZvaWQgaTkx
NV9hY3RpdmVfZmluaShzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKIH0KICNlbmRpZgogCitpbnQg
aTkxNV9hY3RpdmVfYWNxdWlyZV9wcmVhbGxvY2F0ZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmLAorCQkJCQkgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZW5naW5lLT5pOTE1OworCXVuc2lnbmVkIGxv
bmcgdG1wOworCWludCBlcnIgPSAwOworCisJR0VNX0JVR19PTighZW5naW5lLT5tYXNrKTsKKwlm
b3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2luZSwgaTkxNSwgZW5naW5lLT5tYXNrLCB0bXApIHsK
KwkJc3RydWN0IGludGVsX2NvbnRleHQgKmtjdHggPSBlbmdpbmUtPmtlcm5lbF9jb250ZXh0Owor
CQlzdHJ1Y3QgYWN0aXZlX25vZGUgKm5vZGU7CisKKwkJbm9kZSA9IGttZW1fY2FjaGVfYWxsb2Mo
Z2xvYmFsLnNsYWJfY2FjaGUsIEdGUF9LRVJORUwpOworCQlpZiAodW5saWtlbHkoIW5vZGUpKSB7
CisJCQllcnIgPSAtRU5PTUVNOworCQkJYnJlYWs7CisJCX0KKworCQlpOTE1X2FjdGl2ZV9yZXF1
ZXN0X2luaXQoJm5vZGUtPmJhc2UsCisJCQkJCSAodm9pZCAqKWVuZ2luZSwgbm9kZV9yZXRpcmUp
OworCQlub2RlLT50aW1lbGluZSA9IGtjdHgtPnJpbmctPnRpbWVsaW5lLT5mZW5jZV9jb250ZXh0
OworCQlub2RlLT5yZWYgPSByZWY7CisJCXJlZi0+Y291bnQrKzsKKworCQlsbGlzdF9hZGQoKHN0
cnVjdCBsbGlzdF9ub2RlICopJm5vZGUtPmJhc2UubGluaywKKwkJCSAgJnJlZi0+YmFycmllcnMp
OworCX0KKworCXJldHVybiBlcnI7Cit9CisKK3ZvaWQgaTkxNV9hY3RpdmVfYWNxdWlyZV9iYXJy
aWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQoreworCXN0cnVjdCBsbGlzdF9ub2RlICpwb3Ms
ICpuZXh0OworCisJaTkxNV9hY3RpdmVfYWNxdWlyZShyZWYpOworCisJbGxpc3RfZm9yX2VhY2hf
c2FmZShwb3MsIG5leHQsIGxsaXN0X2RlbF9hbGwoJnJlZi0+YmFycmllcnMpKSB7CisJCXN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwkJc3RydWN0IGFjdGl2ZV9ub2RlICpub2RlOwor
CQlzdHJ1Y3QgcmJfbm9kZSAqKnAsICpwYXJlbnQ7CisKKwkJbm9kZSA9IGNvbnRhaW5lcl9vZigo
c3RydWN0IGxpc3RfaGVhZCAqKXBvcywKKwkJCQkgICAgdHlwZW9mKCpub2RlKSwgYmFzZS5saW5r
KTsKKworCQllbmdpbmUgPSAodm9pZCAqKXJjdV9hY2Nlc3NfcG9pbnRlcihub2RlLT5iYXNlLnJl
cXVlc3QpOworCQlSQ1VfSU5JVF9QT0lOVEVSKG5vZGUtPmJhc2UucmVxdWVzdCwgRVJSX1BUUigt
RUFHQUlOKSk7CisKKwkJcGFyZW50ID0gTlVMTDsKKwkJcCA9ICZyZWYtPnRyZWUucmJfbm9kZTsK
KwkJd2hpbGUgKCpwKSB7CisJCQlwYXJlbnQgPSAqcDsKKwkJCWlmIChyYl9lbnRyeShwYXJlbnQs
CisJCQkJICAgICBzdHJ1Y3QgYWN0aXZlX25vZGUsCisJCQkJICAgICBub2RlKS0+dGltZWxpbmUg
PCBub2RlLT50aW1lbGluZSkKKwkJCQlwID0gJnBhcmVudC0+cmJfcmlnaHQ7CisJCQllbHNlCisJ
CQkJcCA9ICZwYXJlbnQtPnJiX2xlZnQ7CisJCX0KKwkJcmJfbGlua19ub2RlKCZub2RlLT5ub2Rl
LCBwYXJlbnQsIHApOworCQlyYl9pbnNlcnRfY29sb3IoJm5vZGUtPm5vZGUsICZyZWYtPnRyZWUp
OworCisJCWxsaXN0X2FkZCgoc3RydWN0IGxsaXN0X25vZGUgKikmbm9kZS0+YmFzZS5saW5rLAor
CQkJICAmZW5naW5lLT5iYXJyaWVyX3Rhc2tzKTsKKwl9CisJaTkxNV9hY3RpdmVfcmVsZWFzZShy
ZWYpOworfQorCit2b2lkIGk5MTVfcmVxdWVzdF9hZGRfYmFycmllcnMoc3RydWN0IGk5MTVfcmVx
dWVzdCAqcnEpCit7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lID0gcnEtPmVuZ2lu
ZTsKKwlzdHJ1Y3QgbGxpc3Rfbm9kZSAqbm9kZSwgKm5leHQ7CisKKwlsbGlzdF9mb3JfZWFjaF9z
YWZlKG5vZGUsIG5leHQsIGxsaXN0X2RlbF9hbGwoJmVuZ2luZS0+YmFycmllcl90YXNrcykpCisJ
CWxpc3RfYWRkX3RhaWwoKHN0cnVjdCBsaXN0X2hlYWQgKilub2RlLCAmcnEtPmFjdGl2ZV9saXN0
KTsKK30KKwogaW50IGk5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9y
ZXF1ZXN0ICphY3RpdmUsCiAJCQkgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9hY3RpdmUuaAppbmRleCA3ZDc1ODcxOWNlMzkuLmQ1NWQzNzY3Mzk0NCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oCkBAIC00MDYsNCArNDA2LDkgQEAgdm9pZCBp
OTE1X2FjdGl2ZV9maW5pKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKIHN0YXRpYyBpbmxpbmUg
dm9pZCBpOTE1X2FjdGl2ZV9maW5pKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKSB7IH0KICNlbmRp
ZgogCitpbnQgaTkxNV9hY3RpdmVfYWNxdWlyZV9wcmVhbGxvY2F0ZV9iYXJyaWVyKHN0cnVjdCBp
OTE1X2FjdGl2ZSAqcmVmLAorCQkJCQkgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KTsKK3ZvaWQgaTkxNV9hY3RpdmVfYWNxdWlyZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAq
cmVmKTsKK3ZvaWQgaTkxNV9yZXF1ZXN0X2FkZF9iYXJyaWVycyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycSk7CisKICNlbmRpZiAvKiBfSTkxNV9BQ1RJVkVfSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2FjdGl2ZV90eXBlcy5oCmluZGV4IGI2NzkyNTNiNTNhNS4uYzAyNTk5MWI5MjMzIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBlcy5oCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlX3R5cGVzLmgKQEAgLTcsNiArNyw3IEBA
CiAjaWZuZGVmIF9JOTE1X0FDVElWRV9UWVBFU19IXwogI2RlZmluZSBfSTkxNV9BQ1RJVkVfVFlQ
RVNfSF8KIAorI2luY2x1ZGUgPGxpbnV4L2xsaXN0Lmg+CiAjaW5jbHVkZSA8bGludXgvcmJ0cmVl
Lmg+CiAjaW5jbHVkZSA8bGludXgvcmN1cGRhdGUuaD4KIApAQCAtMzEsNiArMzIsOCBAQCBzdHJ1
Y3QgaTkxNV9hY3RpdmUgewogCXVuc2lnbmVkIGludCBjb3VudDsKIAogCXZvaWQgKCpyZXRpcmUp
KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKKworCXN0cnVjdCBsbGlzdF9oZWFkIGJhcnJpZXJz
OwogfTsKIAogI2VuZGlmIC8qIF9JOTE1X0FDVElWRV9UWVBFU19IXyAqLwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZ2VtLmMKaW5kZXggMjVmNmEyYzMxMzllLi44MzAzYTcwMmQ5ZmUgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW0uYwpAQCAtMTE5NywxMCArMTE5Nyw2IEBAIHZvaWQgaTkxNV9nZW1fc2FuaXRpemUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAKIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtl
X3B1dCgmaTkxNS0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAlpbnRlbF9ydW50aW1lX3BtX3B1
dChpOTE1LCB3YWtlcmVmKTsKLQotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
OwotCWk5MTVfZ2VtX2NvbnRleHRzX2xvc3QoaTkxNSk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKIH0KIAogdm9pZCBpOTE1X2dlbV9pbml0X3N3aXp6bGluZyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVz
dC5jCmluZGV4IDgxMDBjY2YwNGMwYi4uYmU4MzBmMGVhNzZkIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3JlcXVlc3QuYwpAQCAtMjEzLDE4ICsyMTMsNiBAQCBzdGF0aWMgdm9pZCBfX3JldGlyZV9l
bmdpbmVfcmVxdWVzdChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJc3Bpbl91bmxv
Y2soJnJxLT5sb2NrKTsKIAogCWxvY2FsX2lycV9lbmFibGUoKTsKLQotCS8qCi0JICogVGhlIGJh
Y2tpbmcgb2JqZWN0IGZvciB0aGUgY29udGV4dCBpcyBkb25lIGFmdGVyIHN3aXRjaGluZyB0byB0
aGUKLQkgKiAqbmV4dCogY29udGV4dC4gVGhlcmVmb3JlIHdlIGNhbm5vdCByZXRpcmUgdGhlIHBy
ZXZpb3VzIGNvbnRleHQgdW50aWwKLQkgKiB0aGUgbmV4dCBjb250ZXh0IGhhcyBhbHJlYWR5IHN0
YXJ0ZWQgcnVubmluZy4gSG93ZXZlciwgc2luY2Ugd2UKLQkgKiBjYW5ub3QgdGFrZSB0aGUgcmVx
dWlyZWQgbG9ja3MgYXQgaTkxNV9yZXF1ZXN0X3N1Ym1pdCgpIHdlCi0JICogZGVmZXIgdGhlIHVu
cGlubmluZyBvZiB0aGUgYWN0aXZlIGNvbnRleHQgdG8gbm93LCByZXRpcmVtZW50IG9mCi0JICog
dGhlIHN1YnNlcXVlbnQgcmVxdWVzdC4KLQkgKi8KLQlpZiAoZW5naW5lLT5sYXN0X3JldGlyZWRf
Y29udGV4dCkKLQkJaW50ZWxfY29udGV4dF91bnBpbihlbmdpbmUtPmxhc3RfcmV0aXJlZF9jb250
ZXh0KTsKLQllbmdpbmUtPmxhc3RfcmV0aXJlZF9jb250ZXh0ID0gcnEtPmh3X2NvbnRleHQ7CiB9
CiAKIHN0YXRpYyB2b2lkIF9fcmV0aXJlX2VuZ2luZV91cHRvKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwKQEAgLTc1OSw5ICs3NDcsNiBAQCBfX2k5MTVfcmVxdWVzdF9jcmVhdGUoc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlLCBnZnBfdCBnZnApCiAKIAlycS0+aW5maXggPSBycS0+cmlu
Zy0+ZW1pdDsgLyogZW5kIG9mIGhlYWRlcjsgc3RhcnQgb2YgdXNlciBwYXlsb2FkICovCiAKLQkv
KiBLZWVwIGEgc2Vjb25kIHBpbiBmb3IgdGhlIGR1YWwgcmV0aXJlbWVudCBhbG9uZyBlbmdpbmUg
YW5kIHJpbmcgKi8KLQlfX2ludGVsX2NvbnRleHRfcGluKGNlKTsKLQogCWludGVsX2NvbnRleHRf
bWFya19hY3RpdmUoY2UpOwogCXJldHVybiBycTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jCmluZGV4IGI3ZjNmYmI0YWU4OS4uYTk2ZDBj
MDEyZDQ2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19n
ZW1fZGV2aWNlLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2Vt
X2RldmljZS5jCkBAIC01Niw3ICs1Niw2IEBAIHN0YXRpYyB2b2lkIG1vY2tfZGV2aWNlX3JlbGVh
c2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1
Y3RfbXV0ZXgpOwogCW1vY2tfZGV2aWNlX2ZsdXNoKGk5MTUpOwotCWk5MTVfZ2VtX2NvbnRleHRz
X2xvc3QoaTkxNSk7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAog
CWZsdXNoX3dvcmsoJmk5MTUtPmdlbS5pZGxlX3dvcmspOwotLSAKMi4yMC4xCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBs
aXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

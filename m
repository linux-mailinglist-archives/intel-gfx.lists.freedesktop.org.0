Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2072685BBA
	for <lists+intel-gfx@lfdr.de>; Thu,  8 Aug 2019 09:42:29 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 302206E790;
	Thu,  8 Aug 2019 07:42:27 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A87836E790
 for <intel-gfx@lists.freedesktop.org>; Thu,  8 Aug 2019 07:42:24 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17926062-1500050 
 for multiple; Thu, 08 Aug 2019 08:42:12 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  8 Aug 2019 08:42:07 +0100
Message-Id: <20190808074207.18274-19-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0.rc1
In-Reply-To: <20190808074207.18274-1-chris@chris-wilson.co.uk>
References: <20190808074207.18274-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 19/19] drm/i915: Markup expected timeline locks
 for i915_active
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgZXZlcnkgaTkxNV9hY3RpdmVfcmVxdWVzdCBzaG91bGQgYmUgc2VyaWFsaXNlZCBieSBhIGRl
ZGljYXRlZCBsb2NrLAppOTE1X2FjdGl2ZSBjb25zaXN0cyBvZiBhIHRyZWUgb2YgbG9ja3M7IG9u
ZSBmb3IgZWFjaCBub2RlLiBNYXJrdXAgdXAKdGhlIGk5MTVfYWN0aXZlX3JlcXVlc3Qgd2l0aCB3
aGF0IGxvY2sgaXMgc3VwcG9zZWQgdG8gYmUgZ3VhcmRpbmcgaXQgc28KdGhhdCB3ZSBjYW4gdmVy
aWZ5IHRoYXQgdGhlIHNlcmlhbGlzZWQgdXBkYXRlZCBhcmUgaW5kZWVkIHNlcmlhbGlzZWQuCgpT
aWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KLS0t
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYyAgfCAgMiArLQog
Li4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xpZW50X2JsdC5jICAgIHwgIDIgKy0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgICB8ICAyICstCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgICAgICAgfCAxMSArKystLS0tLS0t
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuaCAgIHwgIDIgKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmMgICAgICB8ICA3ICsrKy0t
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3RpbWVsaW5lLmMgICB8ICA0ICsr
KysKIC4uLi9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RzL21vY2tfdGltZWxpbmUuYyB8ICAyICst
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5jICAgICAgICAgICAgfCAxOSArKysr
KysrKysrKysrKystLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oICAgICAg
ICAgICAgfCAxMiArKysrKysrKysrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZl
X3R5cGVzLmggICAgICB8ICAzICsrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYyAg
ICAgICAgICAgICAgIHwgIDQgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfYWN0aXZlLmMgIHwgIDMgKy0tCiAxMyBmaWxlcyBjaGFuZ2VkLCA0NiBpbnNlcnRpb25zKCsp
LCAyNyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX292ZXJsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
b3ZlcmxheS5jCmluZGV4IGUxMjQ4ZWFjZTBlMS4uZWNhNDFjNGE1YWE2IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX292ZXJsYXkuYwpAQCAtMjMwLDcgKzIzMCw3IEBA
IGFsbG9jX3JlcXVlc3Qoc3RydWN0IGludGVsX292ZXJsYXkgKm92ZXJsYXksIHZvaWQgKCpmbiko
c3RydWN0IGludGVsX292ZXJsYXkgKikpCiAJaWYgKElTX0VSUihycSkpCiAJCXJldHVybiBycTsK
IAotCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmb3ZlcmxheS0+bGFzdF9mbGlwLCBycS0+ZmVuY2Uu
Y29udGV4dCwgcnEpOworCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmb3ZlcmxheS0+bGFzdF9mbGlw
LCBycS0+dGltZWxpbmUsIHJxKTsKIAlpZiAoZXJyKSB7CiAJCWk5MTVfcmVxdWVzdF9hZGQocnEp
OwogCQlyZXR1cm4gRVJSX1BUUihlcnIpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2NsaWVudF9ibHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9jbGllbnRfYmx0LmMKaW5kZXggZGU2NjE2YmRiM2E2Li4zMTFjMWM4NTM4NmQgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsaWVudF9ibHQuYwpAQCAt
MTk3LDcgKzE5Nyw3IEBAIHN0YXRpYyB2b2lkIGNsZWFyX3BhZ2VzX3dvcmtlcihzdHJ1Y3Qgd29y
a19zdHJ1Y3QgKndvcmspCiAJICoga2VlcCB0cmFjayBvZiB0aGUgR1BVIGFjdGl2aXR5IHdpdGhp
biB0aGlzIHZtYS9yZXF1ZXN0LCBhbmQKIAkgKiBwcm9wYWdhdGUgdGhlIHNpZ25hbCBmcm9tIHRo
ZSByZXF1ZXN0IHRvIHctPmRtYS4KIAkgKi8KLQllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJnZtYS0+
YWN0aXZlLCBycS0+ZmVuY2UuY29udGV4dCwgcnEpOworCWVyciA9IGk5MTVfYWN0aXZlX3JlZigm
dm1hLT5hY3RpdmUsIHJxLT50aW1lbGluZSwgcnEpOwogCWlmIChlcnIpCiAJCWdvdG8gb3V0X3Jl
cXVlc3Q7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9j
b250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCmlu
ZGV4IGU4NjhjYWFmYzIyOS4uZTJiMmQ2OTY0NTFhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTk2Nyw3ICs5NjcsNyBAQCBzdGF0aWMgaW50IGNv
bnRleHRfYmFycmllcl90YXNrKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiAJCWlmIChl
bWl0KQogCQkJZXJyID0gZW1pdChycSwgZGF0YSk7CiAJCWlmIChlcnIgPT0gMCkKLQkJCWVyciA9
IGk5MTVfYWN0aXZlX3JlZigmY2ItPmJhc2UsIHJxLT5mZW5jZS5jb250ZXh0LCBycSk7CisJCQll
cnIgPSBpOTE1X2FjdGl2ZV9yZWYoJmNiLT5iYXNlLCBycS0+dGltZWxpbmUsIHJxKTsKIAogCQlp
OTE1X3JlcXVlc3RfYWRkKHJxKTsKIAkJaWYgKGVycikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2NvbnRleHQuYwppbmRleCA5MTE0OTUzYmY5MjAuLmY1NTY5MWQxNTFhZSAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwpAQCAtMzA2LDEwICszMDYsMTAgQEAgaW50
IGludGVsX2NvbnRleHRfcHJlcGFyZV9yZW1vdGVfcmVxdWVzdChzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UsCiAKIAkJLyogUXVldWUgdGhpcyBzd2l0Y2ggYWZ0ZXIgY3VycmVudCBhY3Rpdml0eSBi
eSB0aGlzIGNvbnRleHQuICovCiAJCWVyciA9IGk5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KCZ0bC0+
bGFzdF9yZXF1ZXN0LCBycSk7CisJCW11dGV4X3VubG9jaygmdGwtPm11dGV4KTsKIAkJaWYgKGVy
cikKLQkJCWdvdG8gdW5sb2NrOworCQkJcmV0dXJuIGVycjsKIAl9Ci0JbG9ja2RlcF9hc3NlcnRf
aGVsZCgmdGwtPm11dGV4KTsKIAogCS8qCiAJICogR3VhcmFudGVlIGNvbnRleHQgaW1hZ2UgYW5k
IHRoZSB0aW1lbGluZSByZW1haW5zIHBpbm5lZCB1bnRpbCB0aGUKQEAgLTMxOSwxMiArMzE5LDcg
QEAgaW50IGludGVsX2NvbnRleHRfcHJlcGFyZV9yZW1vdGVfcmVxdWVzdChzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UsCiAJICogd29yZHMgdHJhbnNmZXIgdGhlIHBpbm5lZCBjZSBvYmplY3QgdG8g
dHJhY2tlZCBhY3RpdmUgcmVxdWVzdC4KIAkgKi8KIAlHRU1fQlVHX09OKGk5MTVfYWN0aXZlX2lz
X2lkbGUoJmNlLT5hY3RpdmUpKTsKLQllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJmNlLT5hY3RpdmUs
IHJxLT5mZW5jZS5jb250ZXh0LCBycSk7Ci0KLXVubG9jazoKLQlpZiAocnEtPnRpbWVsaW5lICE9
IHRsKQotCQltdXRleF91bmxvY2soJnRsLT5tdXRleCk7Ci0JcmV0dXJuIGVycjsKKwlyZXR1cm4g
aTkxNV9hY3RpdmVfcmVmKCZjZS0+YWN0aXZlLCBycS0+dGltZWxpbmUsIHJxKTsKIH0KIAogc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9lbmdpbmVfcG9vbC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bv
b2wuaAppbmRleCBmN2EwYTY2MGMxYzkuLjhkMDY5ZWZkOTQ1NyAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5oCkBAIC0xOCw3ICsxOCw3IEBAIHN0YXRpYyBp
bmxpbmUgaW50CiBpbnRlbF9lbmdpbmVfcG9vbF9tYXJrX2FjdGl2ZShzdHJ1Y3QgaW50ZWxfZW5n
aW5lX3Bvb2xfbm9kZSAqbm9kZSwKIAkJCSAgICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQog
ewotCXJldHVybiBpOTE1X2FjdGl2ZV9yZWYoJm5vZGUtPmFjdGl2ZSwgcnEtPmZlbmNlLmNvbnRl
eHQsIHJxKTsKKwlyZXR1cm4gaTkxNV9hY3RpdmVfcmVmKCZub2RlLT5hY3RpdmUsIHJxLT50aW1l
bGluZSwgcnEpOwogfQogCiBzdGF0aWMgaW5saW5lIHZvaWQKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF90aW1lbGluZS5jCmluZGV4IGVhZmQ5NGQ1ZTIxMS4uMDJmYmUxMWI2NzFiIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZS5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmMKQEAgLTI1NCw3ICsyNTQsNyBA
QCBpbnQgaW50ZWxfdGltZWxpbmVfaW5pdChzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRpbWVsaW5l
LAogCiAJbXV0ZXhfaW5pdCgmdGltZWxpbmUtPm11dGV4KTsKIAotCUlOSVRfQUNUSVZFX1JFUVVF
U1QoJnRpbWVsaW5lLT5sYXN0X3JlcXVlc3QpOworCUlOSVRfQUNUSVZFX1JFUVVFU1QoJnRpbWVs
aW5lLT5sYXN0X3JlcXVlc3QsICZ0aW1lbGluZS0+bXV0ZXgpOwogCUlOSVRfTElTVF9IRUFEKCZ0
aW1lbGluZS0+cmVxdWVzdHMpOwogCiAJaTkxNV9zeW5jbWFwX2luaXQoJnRpbWVsaW5lLT5zeW5j
KTsKQEAgLTQ0MCw4ICs0NDAsNyBAQCBfX2ludGVsX3RpbWVsaW5lX2dldF9zZXFubyhzdHJ1Y3Qg
aW50ZWxfdGltZWxpbmUgKnRsLAogCSAqIGZyZWUgaXQgYWZ0ZXIgdGhlIGN1cnJlbnQgcmVxdWVz
dCBpcyByZXRpcmVkLCB3aGljaCBlbnN1cmVzIHRoYXQKIAkgKiBhbGwgd3JpdGVzIGludG8gdGhl
IGNhY2hlbGluZSBmcm9tIHByZXZpb3VzIHJlcXVlc3RzIGFyZSBjb21wbGV0ZS4KIAkgKi8KLQll
cnIgPSBpOTE1X2FjdGl2ZV9yZWYoJnRsLT5od3NwX2NhY2hlbGluZS0+YWN0aXZlLAotCQkJICAg
ICAgdGwtPmZlbmNlX2NvbnRleHQsIHJxKTsKKwllcnIgPSBpOTE1X2FjdGl2ZV9yZWYoJnRsLT5o
d3NwX2NhY2hlbGluZS0+YWN0aXZlLCB0bCwgcnEpOwogCWlmIChlcnIpCiAJCWdvdG8gZXJyX2Nh
Y2hlbGluZTsKIApAQCAtNDkyLDcgKzQ5MSw3IEBAIGludCBpbnRlbF90aW1lbGluZV9nZXRfc2Vx
bm8oc3RydWN0IGludGVsX3RpbWVsaW5lICp0bCwKIHN0YXRpYyBpbnQgY2FjaGVsaW5lX3JlZihz
dHJ1Y3QgaW50ZWxfdGltZWxpbmVfY2FjaGVsaW5lICpjbCwKIAkJCSBzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSkKIHsKLQlyZXR1cm4gaTkxNV9hY3RpdmVfcmVmKCZjbC0+YWN0aXZlLCBycS0+ZmVu
Y2UuY29udGV4dCwgcnEpOworCXJldHVybiBpOTE1X2FjdGl2ZV9yZWYoJmNsLT5hY3RpdmUsIHJx
LT50aW1lbGluZSwgcnEpOwogfQogCiBpbnQgaW50ZWxfdGltZWxpbmVfcmVhZF9od3NwKHN0cnVj
dCBpOTE1X3JlcXVlc3QgKmZyb20sCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9zZWxmdGVzdF90aW1lbGluZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rf
dGltZWxpbmUuYwppbmRleCBkNTQxMTM2OTc3NDUuLjMyMTQ4MTQwMzE2NSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfdGltZWxpbmUuYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF90aW1lbGluZS5jCkBAIC02ODksNyArNjg5LDkgQEAg
c3RhdGljIGludCBsaXZlX2h3c3Bfd3JhcCh2b2lkICphcmcpCiAKIAkJdGwtPnNlcW5vID0gLTR1
OwogCisJCW11dGV4X2xvY2tfbmVzdGVkKCZ0bC0+bXV0ZXgsIFNJTkdMRV9ERVBUSF9ORVNUSU5H
KTsKIAkJZXJyID0gaW50ZWxfdGltZWxpbmVfZ2V0X3NlcW5vKHRsLCBycSwgJnNlcW5vWzBdKTsK
KwkJbXV0ZXhfdW5sb2NrKCZ0bC0+bXV0ZXgpOwogCQlpZiAoZXJyKSB7CiAJCQlpOTE1X3JlcXVl
c3RfYWRkKHJxKTsKIAkJCWdvdG8gb3V0OwpAQCAtNzA0LDcgKzcwNiw5IEBAIHN0YXRpYyBpbnQg
bGl2ZV9od3NwX3dyYXAodm9pZCAqYXJnKQogCQl9CiAJCWh3c3Bfc2Vxbm9bMF0gPSB0bC0+aHdz
cF9zZXFubzsKIAorCQltdXRleF9sb2NrX25lc3RlZCgmdGwtPm11dGV4LCBTSU5HTEVfREVQVEhf
TkVTVElORyk7CiAJCWVyciA9IGludGVsX3RpbWVsaW5lX2dldF9zZXFubyh0bCwgcnEsICZzZXFu
b1sxXSk7CisJCW11dGV4X3VubG9jaygmdGwtPm11dGV4KTsKIAkJaWYgKGVycikgewogCQkJaTkx
NV9yZXF1ZXN0X2FkZChycSk7CiAJCQlnb3RvIG91dDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3NlbGZ0ZXN0cy9tb2NrX3RpbWVsaW5lLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9zZWxmdGVzdHMvbW9ja190aW1lbGluZS5jCmluZGV4IDVjNTQ5MjA1ODI4YS4uNTk4
MTcwZWZjYWY2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdHMv
bW9ja190aW1lbGluZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0cy9t
b2NrX3RpbWVsaW5lLmMKQEAgLTE1LDcgKzE1LDcgQEAgdm9pZCBtb2NrX3RpbWVsaW5lX2luaXQo
c3RydWN0IGludGVsX3RpbWVsaW5lICp0aW1lbGluZSwgdTY0IGNvbnRleHQpCiAKIAltdXRleF9p
bml0KCZ0aW1lbGluZS0+bXV0ZXgpOwogCi0JSU5JVF9BQ1RJVkVfUkVRVUVTVCgmdGltZWxpbmUt
Pmxhc3RfcmVxdWVzdCk7CisJSU5JVF9BQ1RJVkVfUkVRVUVTVCgmdGltZWxpbmUtPmxhc3RfcmVx
dWVzdCwgJnRpbWVsaW5lLT5tdXRleCk7CiAJSU5JVF9MSVNUX0hFQUQoJnRpbWVsaW5lLT5yZXF1
ZXN0cyk7CiAKIAlpOTE1X3N5bmNtYXBfaW5pdCgmdGltZWxpbmUtPnN5bmMpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfYWN0aXZlLmMKaW5kZXggNzY5OGZjYWE2NDhhLi44ZWM1M2YyZGMxZGMgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYwpAQCAtMTYzLDEwICsxNjMsMTEgQEAgbm9kZV9yZXRp
cmUoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmJhc2UsIHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxKQogfQogCiBzdGF0aWMgc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKgotYWN0aXZlX2lu
c3RhbmNlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCB1NjQgaWR4KQorYWN0aXZlX2luc3RhbmNl
KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLCBzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsKQogewog
CXN0cnVjdCBhY3RpdmVfbm9kZSAqbm9kZSwgKnByZWFsbG9jOwogCXN0cnVjdCByYl9ub2RlICoq
cCwgKnBhcmVudDsKKwl1NjQgaWR4ID0gdGwtPmZlbmNlX2NvbnRleHQ7CiAKIAkvKgogCSAqIFdl
IHRyYWNrIHRoZSBtb3N0IHJlY2VudGx5IHVzZWQgdGltZWxpbmUgdG8gc2tpcCBhIHJidHJlZSBz
ZWFyY2gKQEAgLTIwNSw3ICsyMDYsNyBAQCBhY3RpdmVfaW5zdGFuY2Uoc3RydWN0IGk5MTVfYWN0
aXZlICpyZWYsIHU2NCBpZHgpCiAJfQogCiAJbm9kZSA9IHByZWFsbG9jOwotCWk5MTVfYWN0aXZl
X3JlcXVlc3RfaW5pdCgmbm9kZS0+YmFzZSwgTlVMTCwgbm9kZV9yZXRpcmUpOworCWk5MTVfYWN0
aXZlX3JlcXVlc3RfaW5pdCgmbm9kZS0+YmFzZSwgJnRsLT5tdXRleCwgTlVMTCwgbm9kZV9yZXRp
cmUpOwogCW5vZGUtPnJlZiA9IHJlZjsKIAlub2RlLT50aW1lbGluZSA9IGlkeDsKIApAQCAtMjgx
LDE4ICsyODIsMjAgQEAgc3RhdGljIGJvb2wgX19hY3RpdmVfZGVsX2JhcnJpZXIoc3RydWN0IGk5
MTVfYWN0aXZlICpyZWYsCiB9CiAKIGludCBpOTE1X2FjdGl2ZV9yZWYoc3RydWN0IGk5MTVfYWN0
aXZlICpyZWYsCi0JCSAgICB1NjQgdGltZWxpbmUsCisJCSAgICBzdHJ1Y3QgaW50ZWxfdGltZWxp
bmUgKnRsLAogCQkgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CiAJc3RydWN0IGk5MTVf
YWN0aXZlX3JlcXVlc3QgKmFjdGl2ZTsKIAlpbnQgZXJyOwogCisJbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmdGwtPm11dGV4KTsKKwogCS8qIFByZXZlbnQgcmVhcGluZyBpbiBjYXNlIHdlIG1hbGxvYy93
YWl0IHdoaWxlIGJ1aWxkaW5nIHRoZSB0cmVlICovCiAJZXJyID0gaTkxNV9hY3RpdmVfYWNxdWly
ZShyZWYpOwogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKLQlhY3RpdmUgPSBhY3RpdmVfaW5z
dGFuY2UocmVmLCB0aW1lbGluZSk7CisJYWN0aXZlID0gYWN0aXZlX2luc3RhbmNlKHJlZiwgdGwp
OwogCWlmICghYWN0aXZlKSB7CiAJCWVyciA9IC1FTk9NRU07CiAJCWdvdG8gb3V0OwpAQCAtNTc5
LDYgKzU4MiwxMCBAQCBpbnQgaTkxNV9hY3RpdmVfYWNxdWlyZV9wcmVhbGxvY2F0ZV9iYXJyaWVy
KHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAogCQkJCWdvdG8gdW53aW5kOwogCQkJfQogCisjaWYg
SVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKQorCQkJbm9kZS0+YmFzZS5sb2Nr
ID0KKwkJCQkmZW5naW5lLT5rZXJuZWxfY29udGV4dC0+dGltZWxpbmUtPm11dGV4OworI2VuZGlm
CiAJCQlSQ1VfSU5JVF9QT0lOVEVSKG5vZGUtPmJhc2UucmVxdWVzdCwgTlVMTCk7CiAJCQlub2Rl
LT5iYXNlLnJldGlyZSA9IG5vZGVfcmV0aXJlOwogCQkJbm9kZS0+dGltZWxpbmUgPSBpZHg7CkBA
IC02ODMsNiArNjkwLDEwIEBAIGludCBpOTE1X2FjdGl2ZV9yZXF1ZXN0X3NldChzdHJ1Y3QgaTkx
NV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAogewogCWludCBlcnI7CiAKKyNpZiBJU19FTkFCTEVE
KENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0pCisJbG9ja2RlcF9hc3NlcnRfaGVsZChhY3RpdmUt
PmxvY2spOworI2VuZGlmCisKIAkvKiBNdXN0IG1haW50YWluIG9yZGVyaW5nIHdydCBwcmV2aW91
cyBhY3RpdmUgcmVxdWVzdHMgKi8KIAllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfYWN0aXZlX3Jl
cXVlc3QocnEsIGFjdGl2ZSk7CiAJaWYgKGVycikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfYWN0aXZlLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5o
CmluZGV4IGY2ZDczMGNmMmZlNi4uZjk1MDU4Zjk5MDU3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
YWN0aXZlLmgKQEAgLTU4LDE1ICs1OCwyMCBAQCB2b2lkIGk5MTVfYWN0aXZlX3JldGlyZV9ub29w
KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCiAgKi8KIHN0YXRpYyBpbmxpbmUg
dm9pZAogaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0
ICphY3RpdmUsCisJCQkgc3RydWN0IG11dGV4ICpsb2NrLAogCQkJIHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxLAogCQkJIGk5MTVfYWN0aXZlX3JldGlyZV9mbiByZXRpcmUpCiB7CiAJUkNVX0lOSVRf
UE9JTlRFUihhY3RpdmUtPnJlcXVlc3QsIHJxKTsKIAlJTklUX0xJU1RfSEVBRCgmYWN0aXZlLT5s
aW5rKTsKIAlhY3RpdmUtPnJldGlyZSA9IHJldGlyZSA/OiBpOTE1X2FjdGl2ZV9yZXRpcmVfbm9v
cDsKKyNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0pCisJYWN0aXZlLT5s
b2NrID0gbG9jazsKKyNlbmRpZgogfQogCi0jZGVmaW5lIElOSVRfQUNUSVZFX1JFUVVFU1QobmFt
ZSkgaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KChuYW1lKSwgTlVMTCwgTlVMTCkKKyNkZWZpbmUg
SU5JVF9BQ1RJVkVfUkVRVUVTVChuYW1lLCBsb2NrKSBcCisJaTkxNV9hY3RpdmVfcmVxdWVzdF9p
bml0KChuYW1lKSwgKGxvY2spLCBOVUxMLCBOVUxMKQogCiAvKioKICAqIGk5MTVfYWN0aXZlX3Jl
cXVlc3Rfc2V0IC0gdXBkYXRlcyB0aGUgdHJhY2tlciB0byB3YXRjaCB0aGUgY3VycmVudCByZXF1
ZXN0CkBAIC04MSw2ICs4Niw5IEBAIHN0YXRpYyBpbmxpbmUgdm9pZAogX19pOTE1X2FjdGl2ZV9y
ZXF1ZXN0X3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAogCQkJICBzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0KQogeworI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9J
OTE1X0RFQlVHX0dFTSkKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKGFjdGl2ZS0+bG9jayk7CisjZW5k
aWYKIAlsaXN0X21vdmUoJmFjdGl2ZS0+bGluaywgJnJlcXVlc3QtPmFjdGl2ZV9saXN0KTsKIAly
Y3VfYXNzaWduX3BvaW50ZXIoYWN0aXZlLT5yZXF1ZXN0LCByZXF1ZXN0KTsKIH0KQEAgLTM2Miw3
ICszNzAsNyBAQCB2b2lkIF9faTkxNV9hY3RpdmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKIH0gd2hpbGUgKDApCiAKIGludCBpOTE1X2FjdGl2ZV9yZWYoc3RydWN0IGk5MTVf
YWN0aXZlICpyZWYsCi0JCSAgICB1NjQgdGltZWxpbmUsCisJCSAgICBzdHJ1Y3QgaW50ZWxfdGlt
ZWxpbmUgKnRsLAogCQkgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpOwogCiBpbnQgaTkxNV9h
Y3RpdmVfd2FpdChzdHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZik7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9hY3RpdmVfdHlwZXMuaAppbmRleCBhZTNlZTQ0MWMxMTQuLmQ4NTdiZDEyYWE3ZSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlwZXMuaAorKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBlcy5oCkBAIC0yNCw2ICsyNCw5IEBA
IHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0IHsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0IF9fcmN1
ICpyZXF1ZXN0OwogCXN0cnVjdCBsaXN0X2hlYWQgbGluazsKIAlpOTE1X2FjdGl2ZV9yZXRpcmVf
Zm4gcmV0aXJlOworI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX0dFTSkKKwlz
dHJ1Y3QgbXV0ZXggKmxvY2s7CisjZW5kaWYKIH07CiAKIHN0cnVjdCBhY3RpdmVfbm9kZTsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3ZtYS5jCmluZGV4IGQzOGVmMmVmM2NlNC4uNjgyNjBiNDA5ODJiIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfdm1hLmMKQEAgLTkwMywxNCArOTAzLDE0IEBAIGludCBpOTE1X3ZtYV9t
b3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKIAkgKiBhZGQgdGhlIGFjdGl2ZSBy
ZWZlcmVuY2UgZmlyc3QgYW5kIHF1ZXVlIGZvciBpdCB0byBiZSBkcm9wcGVkCiAJICogKmxhc3Qq
LgogCSAqLwotCWVyciA9IGk5MTVfYWN0aXZlX3JlZigmdm1hLT5hY3RpdmUsIHJxLT5mZW5jZS5j
b250ZXh0LCBycSk7CisJZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZ2bWEtPmFjdGl2ZSwgcnEtPnRp
bWVsaW5lLCBycSk7CiAJaWYgKHVubGlrZWx5KGVycikpCiAJCXJldHVybiBlcnI7CiAKIAlpZiAo
ZmxhZ3MgJiBFWEVDX09CSkVDVF9XUklURSkgewogCQlpZiAoaW50ZWxfZnJvbnRidWZmZXJfaW52
YWxpZGF0ZShvYmotPmZyb250YnVmZmVyLCBPUklHSU5fQ1MpKQogCQkJaTkxNV9hY3RpdmVfcmVm
KCZvYmotPmZyb250YnVmZmVyLT53cml0ZSwKLQkJCQkJcnEtPmZlbmNlLmNvbnRleHQsCisJCQkJ
CXJxLT50aW1lbGluZSwKIAkJCQkJcnEpOwogCiAJCXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhj
bF9mZW5jZSh2bWEtPnJlc3YsICZycS0+ZmVuY2UpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9hY3RpdmUuYwppbmRleCBlNWNkNWQ0N2UzODAuLjc3ZDg0NGFjOGI3MSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfYWN0aXZlLmMKQEAgLTEx
MCw4ICsxMTAsNyBAQCBfX2xpdmVfYWN0aXZlX3NldHVwKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQogCQkJCQkJICAgICAgIHN1Ym1pdCwKIAkJCQkJCSAgICAgICBHRlBfS0VSTkVMKTsK
IAkJaWYgKGVyciA+PSAwKQotCQkJZXJyID0gaTkxNV9hY3RpdmVfcmVmKCZhY3RpdmUtPmJhc2Us
Ci0JCQkJCSAgICAgIHJxLT5mZW5jZS5jb250ZXh0LCBycSk7CisJCQllcnIgPSBpOTE1X2FjdGl2
ZV9yZWYoJmFjdGl2ZS0+YmFzZSwgcnEtPnRpbWVsaW5lLCBycSk7CiAJCWk5MTVfcmVxdWVzdF9h
ZGQocnEpOwogCQlpZiAoZXJyKSB7CiAJCQlwcl9lcnIoIkZhaWxlZCB0byB0cmFjayBhY3RpdmUg
cmVmIVxuIik7Ci0tIAoyLjIzLjAucmMxCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5m
cmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0
aW5mby9pbnRlbC1nZng=

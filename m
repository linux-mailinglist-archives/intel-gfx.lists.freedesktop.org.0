Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 6CFE4EB2F1
	for <lists+intel-gfx@lfdr.de>; Thu, 31 Oct 2019 15:40:59 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BC0866EEB3;
	Thu, 31 Oct 2019 14:40:57 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0A5C86EEA8
 for <intel-gfx@lists.freedesktop.org>; Thu, 31 Oct 2019 14:40:55 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 19034578-1500050 for multiple; Thu, 31 Oct 2019 14:40:52 +0000
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Mika Kuoppala <mika.kuoppala@linux.intel.com>,
 intel-gfx@lists.freedesktop.org
References: <20191031104747.5308-1-chris@chris-wilson.co.uk>
 <87y2x1j89m.fsf@gaia.fi.intel.com>
In-Reply-To: <87y2x1j89m.fsf@gaia.fi.intel.com>
Message-ID: <157253285086.11954.12097715789006191101@skylake-alporthouse-com>
Date: Thu, 31 Oct 2019 14:40:50 +0000
Subject: Re: [Intel-gfx] [PATCH] drm/i915/execlists: Verify context register
 state before execution
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBNaWthIEt1b3BwYWxhICgyMDE5LTEwLTMxIDE0OjMyOjA1KQo+IENocmlzIFdpbHNv
biA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPiB3cml0ZXM6Cj4gCj4gPiBDaGVjayB0aGF0IHRo
ZSBjb250ZXh0J3MgcmluZyByZWdpc3RlciBzdGF0ZSBzdGlsbCBtYXRjaGVzIG91cgo+ID4gZXhw
ZWN0YXRpb25zIHByaW9yIHRvIGV4ZWN1dGlvbi4KPiA+Cj4gPiBTaWduZWQtb2ZmLWJ5OiBDaHJp
cyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KPiA+IENjOiBNaWthIEt1b3BwYWxh
IDxtaWthLmt1b3BwYWxhQGxpbnV4LmludGVsLmNvbT4KPiA+IC0tLQo+ID4gIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jICAgICB8IDczICsrKysrKysrKysrKysrKysrKysrLS0t
LS0KPiA+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmNfcmVnLmggfCAgNCArLQo+
ID4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jICB8ICA0ICstCj4gPiAg
MyBmaWxlcyBjaGFuZ2VkLCA2MyBpbnNlcnRpb25zKCspLCAxOCBkZWxldGlvbnMoLSkKPiA+Cj4g
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwo+ID4gaW5kZXggNWY2MWNkMTI4ZDljLi42
NjZlNzA5MzE1MjQgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9scmMuYwo+ID4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKPiA+
IEBAIC0xMTQ2LDYgKzExNDYsNjAgQEAgZXhlY2xpc3RzX3NjaGVkdWxlX291dChzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycSkKPiA+ICAgICAgIGk5MTVfcmVxdWVzdF9wdXQocnEpOwo+ID4gIH0KPiA+
ICAKPiA+ICtzdGF0aWMgaW50IGxyY19yaW5nX21pX21vZGUoY29uc3Qgc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQo+ID4gK3sKPiA+ICsgICAgIGlmIChJTlRFTF9HRU4oZW5naW5lLT5p
OTE1KSA+PSAxMikKPiA+ICsgICAgICAgICAgICAgcmV0dXJuIDB4NjA7Cj4gPiArICAgICBlbHNl
IGlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSA5KQo+ID4gKyAgICAgICAgICAgICByZXR1
cm4gMHg1NDsKPiA+ICsgICAgIGVsc2UgaWYgKGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNT
KQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gMHg1ODsKPiA+ICsgICAgIGVsc2UKPiA+ICsgICAg
ICAgICAgICAgcmV0dXJuIC0xOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZAo+ID4gK2V4
ZWNsaXN0c19jaGVja19jb250ZXh0KGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKPiA+
ICsgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCj4gPiArewo+ID4gKyAgICAgY29uc3Qgc3RydWN0IGludGVsX3JpbmcgKnJpbmcgPSBjZS0+
cmluZzsKPiA+ICsgICAgIHUzMiAqcmVncyA9IGNlLT5scmNfcmVnX3N0YXRlOwo+ID4gKyAgICAg
aW50IHg7Cj4gPiArCj4gPiArICAgICBpZiAocmVnc1tDVFhfUklOR19TVEFSVF0gIT0gaTkxNV9n
Z3R0X29mZnNldChyaW5nLT52bWEpKSB7Cj4gPiArICAgICAgICAgICAgIHByX2Vycl9vbmNlKCIl
czogY29udGV4dCBzdWJtaXR0ZWQgd2l0aCBpbmNvcnJlY3QgUklOR19CVUZGRVJfU1RBUlQgWyUw
OHhdLCBleHBlY3RlZCAlMDh4XG4iLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICBlbmdp
bmUtPm5hbWUsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ3NbQ1RYX1JJTkdfU1RB
UlRdLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICBpOTE1X2dndHRfb2Zmc2V0KHJpbmct
PnZtYSkpOwo+ID4gKyAgICAgICAgICAgICByZWdzW0NUWF9SSU5HX1NUQVJUXSA9IGk5MTVfZ2d0
dF9vZmZzZXQocmluZy0+dm1hKTsKPiA+ICsgICAgIH0KPiA+ICsKPiA+ICsgICAgIGlmICgocmVn
c1tDVFhfUklOR19DVExdICYgfihSSU5HX1dBSVQgfCBSSU5HX1dBSVRfU0VNQVBIT1JFKSkgIT0K
PiA+ICsgICAgICAgICAoUklOR19DVExfU0laRShyaW5nLT5zaXplKSB8IFJJTkdfVkFMSUQpKSB7
Cj4gPiArICAgICAgICAgICAgIHByX2Vycl9vbmNlKCIlczogY29udGV4dCBzdWJtaXR0ZWQgd2l0
aCBpbmNvcnJlY3QgUklOR19CVUZGRVJfQ09OVFJPTCBbJTA4eF0sIGV4cGVjdGVkICUwOHhcbiIs
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgIGVuZ2luZS0+bmFtZSwKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgcmVnc1tDVFhfUklOR19DVExdLAo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAodTMyKShSSU5HX0NUTF9TSVpFKHJpbmctPnNpemUpIHwgUklOR19WQUxJRCkp
Owo+ID4gKyAgICAgICAgICAgICByZWdzW0NUWF9SSU5HX0NUTF0gPSBSSU5HX0NUTF9TSVpFKHJp
bmctPnNpemUpIHwgUklOR19WQUxJRDsKPiAKPiBXZSBhcmUgZ29pbmcgdG8gc3VibWl0IGJ5IGNs
ZWFyaW5nIHRoZSB3YWl0cy4gRmlyc3QgSSB0aG91Z2h0IHRoaXMgd2lsbAo+IGxlYWQgdG8gZGlz
YXN0ZXIgYnV0IHRoZSBoYXJkd2FyZSB3b3JrcyBzbyB0aGF0IHdlIGNsZWFyIG9uIHdyaXRpbmcg
JzEnLgoKQWZhaWssIHRoZXkgYXJlIG9ubHkgaW5kaWNhdG9yIGJpdHMuIFNvIHRoZSBIVyBpZ25v
cmVzIHRob3NlIGJpdHMgd2hlbgp3ZSB3cml0ZSB0byB0aGUgcmVnaXN0ZXIuCgo+ID4gKyAgICAg
aWYgKHJlZ3NbQ1RYX0JCX1NUQVRFXSAhPSBSSU5HX0JCX1BQR1RUKSB7Cj4gPiArICAgICAgICAg
ICAgIHByX2Vycl9vbmNlKCIlczogY29udGV4dCBzdWJtaXR0ZWQgd2l0aCBpbmNvcnJlY3QgQkJf
U1RBVEUgWyUwOHhdLCBleHBlY3RlZCAlMDh4XG4iLAo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICBlbmdpbmUtPm5hbWUsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ3NbQ1RY
X0JCX1NUQVRFXSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgUklOR19CQl9QUEdUVCk7
Cj4gPiArICAgICAgICAgICAgIHJlZ3NbQ1RYX0JCX1NUQVRFXSA9IFJJTkdfQkJfUFBHVFQ7Cj4g
PiArICAgICB9Cj4gPiArCj4gPiArICAgICB4ID0gbHJjX3JpbmdfbWlfbW9kZShlbmdpbmUpOwo+
ID4gKyAgICAgaWYgKHggIT0gLTEgJiYgcmVnc1t4ICsgMV0gJiBTVE9QX1JJTkcpIHsKPiA+ICsg
ICAgICAgICAgICAgcHJfZXJyX29uY2UoIiVzOiBjb250ZXh0IHN1Ym1pdHRlZCB3aXRoIFNUT1Bf
UklORyBbJTA4eF0gaW4gUklOR19NSV9NT0RFXG4iLAo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICBlbmdpbmUtPm5hbWUsIHJlZ3NbeCArIDFdKTsKPiA+ICsgICAgICAgICAgICAgcmVnc1t4
ICsgMV0gJj0gflNUT1BfUklORzsKPiA+ICsgICAgICAgICAgICAgcmVnc1t4ICsgMV0gfD0gU1RP
UF9SSU5HIDw8IDE2Owo+IAo+IE9rIHlvdSB3YW50IG9ubHkgdG8gY2FyZSBhYm91dCB0aGlzIG9u
ZS4gV2FzIHBvbmRlcmluZyBvZiByZXN0b3JpbmcgcmVzdAo+IG9mIHRoZSBzdGF0ZSBmcm9tIHBy
ZXZpb3VzLgoKSXQgd2FzIG1vc3RseSBpbiB0aGUgc3Bpcml0IG9mICJub3cgdGhhdCB3ZSBhcmUg
aGVyZSwgd2UgbWlnaHQgYXMgd2VsbApmaXggaXQgdXAiLiBJdCdzIG1haW5seSB0aGUgcGFyYW5v
aWEgaW4gdHJ5aW5nIHRvIGFzY2VydGFpbiBpZiB3ZSBhcmUKZmVlZGluZyBnYXJiYWdlIGludG8g
dGhlIEdQVS4gVGhlcmUncyBwcm9iYWJseSBhIGxvdCBtb3JlIHdlIGNhbiBjaGVjaywKYnV0IHRo
ZSByaW5nIHJlZ2lzdGVycyBhcmUgZXNzZW50aWFsIDopCgo+IFdpbGwgdGhlIGhhcmR3YXJlIGV2
ZW4gY2FyZSBvbiBtYXNrcyBhdCB0aGlzIHBvaW50IG9yIGlzIHRoZSBzYXZpbmcgcGFydAo+IHNl
dHRpbmcgdGhlbSBhY2NvcmRpbmdseT8KCkFpdWksIGl0IHVzZXMgdGhlIG1hc2tzIG9uIHRoZSBp
bXBsaWNpdCBMUkkgaW4gdGhlIGNvbnRleHQgcmVzdG9yZSB0bwpjb250cm9sIHdoZXJlIG9yIG5v
dCB0byBhY3R1YWxseSBhcHBseSB0aGUgYml0cy4gTm90IHRoYXQgSSBoYXZlIGNoZWNrZWQKdG8g
c2VlIHdoYXQgdGhlIEhXIGlzIGRvaW5nICh3ZSB3aWxsIHNlZSBpZiBpdCBldmVyIGZsYWdzIGFu
IGVycm9yKSwgYnV0Cm1lbW9yeSBzYXlzIGZyb20gZWxzZXdlcmUgaXQgdXNlcyAweGZmZmZ4eHh4
LgotQ2hyaXMKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
SW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8DE6DCAF24
	for <lists+intel-gfx@lfdr.de>; Thu,  3 Oct 2019 21:25:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7956E6EA5A;
	Thu,  3 Oct 2019 19:25:05 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0158B6EA57
 for <intel-gfx@lists.freedesktop.org>; Thu,  3 Oct 2019 19:25:03 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 03 Oct 2019 12:25:03 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.67,253,1566889200"; d="scan'208";a="191358381"
Received: from bkokkula-mobl1.ger.corp.intel.com (HELO
 mwahaha-bdw.ger.corp.intel.com) ([10.252.7.77])
 by fmsmga008.fm.intel.com with ESMTP; 03 Oct 2019 12:25:03 -0700
From: Matthew Auld <matthew.auld@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  3 Oct 2019 20:24:31 +0100
Message-Id: <20191003192444.10113-10-matthew.auld@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20191003192444.10113-1-matthew.auld@intel.com>
References: <20191003192444.10113-1-matthew.auld@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2 09/22] drm/i915/selftests: add write-dword
 test for LMEM
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U2ltcGxlIHRlc3Qgd3JpdGluZyB0byBkd29yZHMgYWNyb3NzIGFuIG9iamVjdCwgdXNpbmcgdmFy
aW91cyBlbmdpbmVzIGluCmEgcmFuZG9taXplZCBvcmRlciwgY2hlY2tpbmcgdGhhdCBvdXIgd3Jp
dGVzIGxhbmQgZnJvbSB0aGUgY3B1LgoKU2lnbmVkLW9mZi1ieTogTWF0dGhldyBBdWxkIDxtYXR0
aGV3LmF1bGRAaW50ZWwuY29tPgotLS0KIC4uLi9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfbWVt
b3J5X3JlZ2lvbi5jICB8IDE3MSArKysrKysrKysrKysrKysrKysKIDEgZmlsZSBjaGFuZ2VkLCAx
NzEgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0
ZXN0cy9pbnRlbF9tZW1vcnlfcmVnaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvaW50ZWxfbWVtb3J5X3JlZ2lvbi5jCmluZGV4IDFhZDc1NWU3NWU1Ny4uYWZiMjQ4ZjE3NWRm
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfbWVtb3J5
X3JlZ2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9tZW1v
cnlfcmVnaW9uLmMKQEAgLTcsMTMgKzcsMTYgQEAKIAogI2luY2x1ZGUgIi4uL2k5MTVfc2VsZnRl
c3QuaCIKIAorCiAjaW5jbHVkZSAibW9ja19kcm0uaCIKICNpbmNsdWRlICJtb2NrX2dlbV9kZXZp
Y2UuaCIKICNpbmNsdWRlICJtb2NrX3JlZ2lvbi5oIgogCisjaW5jbHVkZSAiZ2VtL2k5MTVfZ2Vt
X2NvbnRleHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fbG1lbS5oIgogI2luY2x1ZGUgImdl
bS9pOTE1X2dlbV9yZWdpb24uaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fb2JqZWN0X2JsdC5o
IgorI2luY2x1ZGUgImdlbS9zZWxmdGVzdHMvaWd0X2dlbV91dGlscy5oIgogI2luY2x1ZGUgImdl
bS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3QuaCIKICNp
bmNsdWRlICJzZWxmdGVzdHMvaWd0X2ZsdXNoX3Rlc3QuaCIKQEAgLTI1NSw2ICsyNTgsMTI1IEBA
IHN0YXRpYyBpbnQgaWd0X21vY2tfY29udGlndW91cyh2b2lkICphcmcpCiAJcmV0dXJuIGVycjsK
IH0KIAorc3RhdGljIGludCBpZ3RfZ3B1X3dyaXRlX2R3KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSwKKwkJCSAgICBzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKKwkJCSAgICB1MzIgZHdvcmQsCisJCQkg
ICAgdTMyIHZhbHVlKQoreworCXJldHVybiBpZ3RfZ3B1X2ZpbGxfZHcoY2UsIHZtYSwgZHdvcmQg
KiBzaXplb2YodTMyKSwKKwkJCSAgICAgICB2bWEtPnNpemUgPj4gUEFHRV9TSElGVCwgdmFsdWUp
OworfQorCitzdGF0aWMgaW50IGlndF9jcHVfY2hlY2soc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iaiwgdTMyIGR3b3JkLCB1MzIgdmFsKQoreworCXVuc2lnbmVkIGxvbmcgbjsKKwlpbnQg
ZXJyOworCisJaTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqKTsKKwllcnIgPSBpOTE1X2dlbV9vYmpl
Y3Rfc2V0X3RvX3djX2RvbWFpbihvYmosIGZhbHNlKTsKKwlpOTE1X2dlbV9vYmplY3RfdW5sb2Nr
KG9iaik7CisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworCWVyciA9IGk5MTVfZ2VtX29iamVj
dF9waW5fcGFnZXMob2JqKTsKKwlpZiAoZXJyKQorCQlyZXR1cm4gZXJyOworCisJZm9yIChuID0g
MDsgbiA8IG9iai0+YmFzZS5zaXplID4+IFBBR0VfU0hJRlQ7ICsrbikgeworCQl1MzIgX19pb21l
bSAqYmFzZTsKKwkJdTMyIHJlYWRfdmFsOworCisJCWJhc2UgPSBpOTE1X2dlbV9vYmplY3RfbG1l
bV9pb19tYXBfcGFnZV9hdG9taWMob2JqLCBuKTsKKworCQlyZWFkX3ZhbCA9IGlvcmVhZDMyKGJh
c2UgKyBkd29yZCk7CisJCWlvX21hcHBpbmdfdW5tYXBfYXRvbWljKGJhc2UpOworCQlpZiAocmVh
ZF92YWwgIT0gdmFsKSB7CisJCQlwcl9lcnIoIm49JWx1IGJhc2VbJXVdPSV1LCB2YWw9JXVcbiIs
CisJCQkgICAgICAgbiwgZHdvcmQsIHJlYWRfdmFsLCB2YWwpOworCQkJZXJyID0gLUVJTlZBTDsK
KwkJCWJyZWFrOworCQl9CisJfQorCisJaTkxNV9nZW1fb2JqZWN0X3VucGluX3BhZ2VzKG9iaik7
CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBpZ3RfZ3B1X3dyaXRlKHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgsCisJCQkgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikK
K3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkxNTsKKwlzdHJ1Y3Qg
aTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07CisJc3Ry
dWN0IGk5MTVfZ2VtX2VuZ2luZXMgKmVuZ2luZXM7CisJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNf
aXRlciBpdDsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CisJSTkxNV9STkRfU1RBVEUocHJu
Zyk7CisJSUdUX1RJTUVPVVQoZW5kX3RpbWUpOworCXVuc2lnbmVkIGludCBjb3VudDsKKwlzdHJ1
Y3QgaTkxNV92bWEgKnZtYTsKKwlpbnQgKm9yZGVyOworCWludCBpLCBuOworCWludCBlcnIgPSAw
OworCisJR0VNX0JVR19PTighaTkxNV9nZW1fb2JqZWN0X2hhc19waW5uZWRfcGFnZXMob2JqKSk7
CisKKwluID0gMDsKKwljb3VudCA9IDA7CisJZm9yX2VhY2hfZ2VtX2VuZ2luZShjZSwgaTkxNV9n
ZW1fY29udGV4dF9sb2NrX2VuZ2luZXMoY3R4KSwgaXQpIHsKKwkJY291bnQrKzsKKwkJaWYgKCFp
bnRlbF9lbmdpbmVfY2FuX3N0b3JlX2R3b3JkKGNlLT5lbmdpbmUpKQorCQkJY29udGludWU7CisK
KwkJbisrOworCX0KKwlpOTE1X2dlbV9jb250ZXh0X3VubG9ja19lbmdpbmVzKGN0eCk7CisJaWYg
KCFuKQorCQlyZXR1cm4gMDsKKworCW9yZGVyID0gaTkxNV9yYW5kb21fb3JkZXIoY291bnQgKiBj
b3VudCwgJnBybmcpOworCWlmICghb3JkZXIpCisJCXJldHVybiAtRU5PTUVNOworCisJdm1hID0g
aTkxNV92bWFfaW5zdGFuY2Uob2JqLCB2bSwgTlVMTCk7CisJaWYgKElTX0VSUih2bWEpKSB7CisJ
CWVyciA9IFBUUl9FUlIodm1hKTsKKwkJZ290byBvdXRfZnJlZTsKKwl9CisKKwllcnIgPSBpOTE1
X3ZtYV9waW4odm1hLCAwLCAwLCBQSU5fVVNFUik7CisJaWYgKGVycikKKwkJZ290byBvdXRfZnJl
ZTsKKworCWkgPSAwOworCWVuZ2luZXMgPSBpOTE1X2dlbV9jb250ZXh0X2xvY2tfZW5naW5lcyhj
dHgpOworCWRvIHsKKwkJdTMyIHJuZyA9IHByYW5kb21fdTMyX3N0YXRlKCZwcm5nKTsKKwkJdTMy
IGR3b3JkID0gb2Zmc2V0X2luX3BhZ2Uocm5nKSAvIDQ7CisKKwkJY2UgPSBlbmdpbmVzLT5lbmdp
bmVzW29yZGVyW2ldICUgZW5naW5lcy0+bnVtX2VuZ2luZXNdOworCQlpID0gKGkgKyAxKSAlIChj
b3VudCAqIGNvdW50KTsKKwkJaWYgKCFjZSB8fCAhaW50ZWxfZW5naW5lX2Nhbl9zdG9yZV9kd29y
ZChjZS0+ZW5naW5lKSkKKwkJCWNvbnRpbnVlOworCisJCWVyciA9IGlndF9ncHVfd3JpdGVfZHco
Y2UsIHZtYSwgZHdvcmQsIHJuZyk7CisJCWlmIChlcnIpCisJCQlicmVhazsKKworCQllcnIgPSBp
Z3RfY3B1X2NoZWNrKG9iaiwgZHdvcmQsIHJuZyk7CisJCWlmIChlcnIpCisJCQlicmVhazsKKwl9
IHdoaWxlICghX19pZ3RfdGltZW91dChlbmRfdGltZSwgTlVMTCkpOworCWk5MTVfZ2VtX2NvbnRl
eHRfdW5sb2NrX2VuZ2luZXMoY3R4KTsKKworb3V0X2ZyZWU6CisJa2ZyZWUob3JkZXIpOworCisJ
aWYgKGVyciA9PSAtRU5PTUVNKQorCQllcnIgPSAwOworCisJcmV0dXJuIGVycjsKK30KKwogc3Rh
dGljIGludCBpZ3RfbG1lbV9jcmVhdGUodm9pZCAqYXJnKQogewogCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gYXJnOwpAQCAtMjc2LDYgKzM5OCw1NCBAQCBzdGF0aWMgaW50IGlndF9s
bWVtX2NyZWF0ZSh2b2lkICphcmcpCiAJcmV0dXJuIGVycjsKIH0KIAorc3RhdGljIGludCBpZ3Rf
bG1lbV93cml0ZV9ncHUodm9pZCAqYXJnKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gYXJnOworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHQgKmN0eDsKKwlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7CisJSTkxNV9STkRf
U1RBVEUocHJuZyk7CisJdTMyIHN6OworCWludCBlcnI7CisKKwltdXRleF91bmxvY2soJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOworCWZpbGUgPSBtb2NrX2ZpbGUoaTkxNSk7CisJbXV0ZXhfbG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJaWYgKElTX0VSUihmaWxlKSkKKwkJcmV0dXJu
IFBUUl9FUlIoZmlsZSk7CisKKwljdHggPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7CisJaWYg
KElTX0VSUihjdHgpKSB7CisJCWVyciA9IFBUUl9FUlIoY3R4KTsKKwkJZ290byBvdXRfZmlsZTsK
Kwl9CisKKwlzeiA9IHJvdW5kX3VwKHByYW5kb21fdTMyX3N0YXRlKCZwcm5nKSAlIFNaXzMyTSwg
UEFHRV9TSVpFKTsKKworCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfbG1lbShpOTE1LCBz
eiwgMCk7CisJaWYgKElTX0VSUihvYmopKSB7CisJCWVyciA9IFBUUl9FUlIob2JqKTsKKwkJZ290
byBvdXRfZmlsZTsKKwl9CisKKwllcnIgPSBpOTE1X2dlbV9vYmplY3RfcGluX3BhZ2VzKG9iaik7
CisJaWYgKGVycikKKwkJZ290byBvdXRfcHV0OworCisJZXJyID0gaWd0X2dwdV93cml0ZShjdHgs
IG9iaik7CisJaWYgKGVycikKKwkJcHJfZXJyKCJpZ3RfZ3B1X3dyaXRlIGZhaWxlZCglZClcbiIs
IGVycik7CisKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMob2JqKTsKK291dF9wdXQ6CisJ
aTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworb3V0X2ZpbGU6CisJbXV0ZXhfdW5sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKKwltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKKwltdXRl
eF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwlyZXR1cm4gZXJyOworfQorCiBzdGF0
aWMgaW50IGlndF9sbWVtX3dyaXRlX2NwdSh2b2lkICphcmcpCiB7CiAJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBhcmc7CkBAIC00MjcsNiArNTk3LDcgQEAgaW50IGludGVsX21lbW9y
eV9yZWdpb25fbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJ
c3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsKIAkJU1VCVEVTVChp
Z3RfbG1lbV9jcmVhdGUpLAogCQlTVUJURVNUKGlndF9sbWVtX3dyaXRlX2NwdSksCisJCVNVQlRF
U1QoaWd0X2xtZW1fd3JpdGVfZ3B1KSwKIAl9OwogCWludCBlcnI7CiAKLS0gCjIuMjAuMQoKX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1h
aWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B2432BB28D
	for <lists+intel-gfx@lfdr.de>; Mon, 23 Sep 2019 13:01:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6AE926E86C;
	Mon, 23 Sep 2019 11:01:02 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2FDF86E86C
 for <intel-gfx@lists.freedesktop.org>; Mon, 23 Sep 2019 11:01:01 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18585098-1500050 
 for <intel-gfx@lists.freedesktop.org>; Mon, 23 Sep 2019 12:01:00 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 23 Sep 2019 12:00:56 +0100
Message-Id: <20190923110056.15176-4-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20190923110056.15176-1-chris@chris-wilson.co.uk>
References: <20190923110056.15176-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 4/4] drm/i915/execlists: Refactor -EIO markup of
 hung requests
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UHVsbCBzZXR0aW5nIC1FSU8gb24gdGhlIGh1bmcgcmVxdWVzdHMgaW50byBpdHMgb3duIHV0aWxp
dHkgZnVuY3Rpb24uCkhhdmluZyBhbGxvd2VkIG91cnNlbHZlcyB0byBzaG9ydC1jaXJjdWl0IHN1
Ym1pc3Npb24gb2YgY29tcGxldGVkCnJlcXVlc3RzLCB3ZSBjYW4gbm93IGRvIHRoZSBtYXJrX2Vp
bygpIHByaW9yIHRvIHN1Ym1pc3Npb24gYW5kIGF2b2lkCnNvbWUgcmVkdW5kYW50IG9wZXJhdGlv
bnMuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51
az4KUmV2aWV3ZWQtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+
Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgfCAzMSArKysrKysrKysr
KysrKysrLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDE3IGluc2VydGlvbnMoKyksIDE0
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKaW5kZXggYmM5YmFk
ZDljMDQ2Li5iZmY0YzZhNzM1Y2YgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCkBA
IC0yMzQsNiArMjM0LDEzIEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh1
MzIgKnJlZ19zdGF0ZSwKIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwK
IAkJCQkgICAgIHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nKTsKIAorc3RhdGljIHZvaWQgbWFya19l
aW8oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCit7CisJaWYgKCFpOTE1X3JlcXVlc3Rfc2lnbmFs
ZWQocnEpKQorCQlkbWFfZmVuY2Vfc2V0X2Vycm9yKCZycS0+ZmVuY2UsIC1FSU8pOworCWk5MTVf
cmVxdWVzdF9tYXJrX2NvbXBsZXRlKHJxKTsKK30KKwogc3RhdGljIGlubGluZSB1MzIgaW50ZWxf
aHdzX3ByZWVtcHRfYWRkcmVzcyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJ
cmV0dXJuIChpOTE1X2dndHRfb2Zmc2V0KGVuZ2luZS0+c3RhdHVzX3BhZ2Uudm1hKSArCkBAIC0y
NTE3LDEyICsyNTI0LDggQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NhbmNlbF9yZXF1ZXN0cyhz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJX19leGVjbGlzdHNfcmVzZXQoZW5naW5l
LCB0cnVlKTsKIAogCS8qIE1hcmsgYWxsIGV4ZWN1dGluZyByZXF1ZXN0cyBhcyBza2lwcGVkLiAq
LwotCWxpc3RfZm9yX2VhY2hfZW50cnkocnEsICZlbmdpbmUtPmFjdGl2ZS5yZXF1ZXN0cywgc2No
ZWQubGluaykgewotCQlpZiAoIWk5MTVfcmVxdWVzdF9zaWduYWxlZChycSkpCi0JCQlkbWFfZmVu
Y2Vfc2V0X2Vycm9yKCZycS0+ZmVuY2UsIC1FSU8pOwotCi0JCWk5MTVfcmVxdWVzdF9tYXJrX2Nv
bXBsZXRlKHJxKTsKLQl9CisJbGlzdF9mb3JfZWFjaF9lbnRyeShycSwgJmVuZ2luZS0+YWN0aXZl
LnJlcXVlc3RzLCBzY2hlZC5saW5rKQorCQltYXJrX2VpbyhycSk7CiAKIAkvKiBGbHVzaCB0aGUg
cXVldWVkIHJlcXVlc3RzIHRvIHRoZSB0aW1lbGluZSBsaXN0IChmb3IgcmV0aXJpbmcpLiAqLwog
CXdoaWxlICgocmIgPSByYl9maXJzdF9jYWNoZWQoJmV4ZWNsaXN0cy0+cXVldWUpKSkgewpAQCAt
MjUzMCw5ICsyNTMzLDggQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NhbmNlbF9yZXF1ZXN0cyhz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCWludCBpOwogCiAJCXByaW9saXN0X2Zv
cl9lYWNoX3JlcXVlc3RfY29uc3VtZShycSwgcm4sIHAsIGkpIHsKKwkJCW1hcmtfZWlvKHJxKTsK
IAkJCV9faTkxNV9yZXF1ZXN0X3N1Ym1pdChycSk7Ci0JCQlkbWFfZmVuY2Vfc2V0X2Vycm9yKCZy
cS0+ZmVuY2UsIC1FSU8pOwotCQkJaTkxNV9yZXF1ZXN0X21hcmtfY29tcGxldGUocnEpOwogCQl9
CiAKIAkJcmJfZXJhc2VfY2FjaGVkKCZwLT5ub2RlLCAmZXhlY2xpc3RzLT5xdWV1ZSk7CkBAIC0y
NTQ4LDEzICsyNTUwLDE0IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19jYW5jZWxfcmVxdWVzdHMo
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQlSQl9DTEVBUl9OT0RFKHJiKTsKIAog
CQlzcGluX2xvY2soJnZlLT5iYXNlLmFjdGl2ZS5sb2NrKTsKLQkJaWYgKHZlLT5yZXF1ZXN0KSB7
Ci0JCQl2ZS0+cmVxdWVzdC0+ZW5naW5lID0gZW5naW5lOwotCQkJX19pOTE1X3JlcXVlc3Rfc3Vi
bWl0KHZlLT5yZXF1ZXN0KTsKLQkJCWRtYV9mZW5jZV9zZXRfZXJyb3IoJnZlLT5yZXF1ZXN0LT5m
ZW5jZSwgLUVJTyk7Ci0JCQlpOTE1X3JlcXVlc3RfbWFya19jb21wbGV0ZSh2ZS0+cmVxdWVzdCk7
CisJCXJxID0gZmV0Y2hfYW5kX3plcm8oJnZlLT5yZXF1ZXN0KTsKKwkJaWYgKHJxKSB7CisJCQlt
YXJrX2VpbyhycSk7CisKKwkJCXJxLT5lbmdpbmUgPSBlbmdpbmU7CisJCQlfX2k5MTVfcmVxdWVz
dF9zdWJtaXQocnEpOworCiAJCQl2ZS0+YmFzZS5leGVjbGlzdHMucXVldWVfcHJpb3JpdHlfaGlu
dCA9IElOVF9NSU47Ci0JCQl2ZS0+cmVxdWVzdCA9IE5VTEw7CiAJCX0KIAkJc3Bpbl91bmxvY2so
JnZlLT5iYXNlLmFjdGl2ZS5sb2NrKTsKIAl9Ci0tIAoyLjIzLjAKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50
ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

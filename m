Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C5616205AFA
	for <lists+intel-gfx@lfdr.de>; Tue, 23 Jun 2020 20:41:29 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B59256E0A8;
	Tue, 23 Jun 2020 18:41:26 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 37D9B6E0A8
 for <intel-gfx@lists.freedesktop.org>; Tue, 23 Jun 2020 18:41:24 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 21594010-1500050 for multiple; Tue, 23 Jun 2020 19:41:26 +0100
MIME-Version: 1.0
In-Reply-To: <60e198c5-bfc1-2bc6-05a3-487763f7a609@shipmail.org>
References: <20200622095921.15530-1-chris@chris-wilson.co.uk>
 <20200622095921.15530-7-chris@chris-wilson.co.uk>
 <1712fc5b-9b1e-0632-13c0-e0bc2c1d889d@shipmail.org>
 <159293017861.3967.12926784772086320588@build.alporthouse.com>
 <60e198c5-bfc1-2bc6-05a3-487763f7a609@shipmail.org>
From: Chris Wilson <chris@chris-wilson.co.uk>
To: Thomas Hellstr√∂m (Intel) <thomas_os@shipmail.org>, intel-gfx@lists.freedesktop.org
Message-ID: <159293768060.3967.16328770521784351822@build.alporthouse.com>
User-Agent: alot/0.8.1
Date: Tue, 23 Jun 2020 19:41:20 +0100
Subject: Re: [Intel-gfx] [PATCH 7/7] drm/i915/gem: Acquire all vma/objects
 under reservation_ww_class
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBUaG9tYXMgSGVsbHN0csO2bSAoSW50ZWwpICgyMDIwLTA2LTIzIDE5OjIxOjI4KQo+
IAo+IE9uIDYvMjMvMjAgNjozNiBQTSwgQ2hyaXMgV2lsc29uIHdyb3RlOgo+ID4gUXVvdGluZyBU
aG9tYXMgSGVsbHN0csO2bSAoSW50ZWwpICgyMDIwLTA2LTIzIDEyOjIyOjExKQo+ID4+IEhpLCBD
aHJpcywKPiA+Pgo+ID4+IE9uIDYvMjIvMjAgMTE6NTkgQU0sIENocmlzIFdpbHNvbiB3cm90ZToK
PiA+Pj4gSW4gb3JkZXIgdG8gYWN0dWFsbHkgaGFuZGxlIGV2aWN0aW9uIGFuZCB3aGF0IG5vdCwg
d2UgbmVlZCB0byBwcm9jZXNzCj4gPj4+IGFsbCB0aGUgb2JqZWN0cyB0b2dldGhlciB1bmRlciBh
IGNvbW1vbiBsb2NrLCByZXNlcnZhdGlvbl93d19jbGFzcy4gQXMKPiA+Pj4gc3VjaCwgZG8gYSBt
ZW1vcnkgcmVzZXJ2YXRpb24gcGFzcyBhZnRlciBsb29raW5nIHVwIHRoZSBvYmplY3Qvdm1hLAo+
ID4+PiB3aGljaCB0aGVuIGZlZWRzIGludG8gdGhlIHJlc3Qgb2YgZXhlY2J1ZiBbcmVsb2NhdGlv
biwgY21kcGFyc2luZywKPiA+Pj4gZmx1c2hpbmcgYW5kIG9mYyBleGVjdXRpb25dLgo+ID4+Pgo+
ID4+PiBTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51
az4KPiA+Pj4gLS0tCj4gPj4+ICAgIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNi
dWZmZXIuYyAgICB8IDkxICsrKysrKysrKysrKysrLS0tLS0KPiA+Pj4gICAgMSBmaWxlIGNoYW5n
ZWQsIDcwIGluc2VydGlvbnMoKyksIDIxIGRlbGV0aW9ucygtKQo+ID4+Pgo+ID4+PiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKPiA+Pj4gaW5kZXgg
NDZmY2JkZjgxNjFjLi44ZGIyZTAxMzQ2NWYgMTAwNjQ0Cj4gPj4+IC0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKPiA+Pj4gKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwo+ID4+PiBAQCAtNTMsMTAgKzUz
LDkgQEAgc3RydWN0IGViX3ZtYV9hcnJheSB7Cj4gPj4+ICAgIAo+ID4+PiAgICAjZGVmaW5lIF9f
RVhFQ19PQkpFQ1RfSEFTX1BJTiAgICAgICAgICAgICAgIEJJVCgzMSkKPiA+Pj4gICAgI2RlZmlu
ZSBfX0VYRUNfT0JKRUNUX0hBU19GRU5DRSAgICAgICAgICAgICBCSVQoMzApCj4gPj4+IC0jZGVm
aW5lIF9fRVhFQ19PQkpFQ1RfSEFTX1BBR0VTICAgICAgICAgICAgICBCSVQoMjkpCj4gPj4+IC0j
ZGVmaW5lIF9fRVhFQ19PQkpFQ1RfTkVFRFNfTUFQICAgICAgICAgICAgICBCSVQoMjgpCj4gPj4+
IC0jZGVmaW5lIF9fRVhFQ19PQkpFQ1RfTkVFRFNfQklBUyAgICAgQklUKDI3KQo+ID4+PiAtI2Rl
ZmluZSBfX0VYRUNfT0JKRUNUX0lOVEVSTkFMX0ZMQUdTICh+MHUgPDwgMjcpIC8qIGFsbCBvZiB0
aGUgYWJvdmUgKi8KPiA+Pj4gKyNkZWZpbmUgX19FWEVDX09CSkVDVF9ORUVEU19NQVAgICAgICAg
ICAgICAgIEJJVCgyOSkKPiA+Pj4gKyNkZWZpbmUgX19FWEVDX09CSkVDVF9ORUVEU19CSUFTICAg
ICBCSVQoMjgpCj4gPj4+ICsjZGVmaW5lIF9fRVhFQ19PQkpFQ1RfSU5URVJOQUxfRkxBR1MgKH4w
dSA8PCAyOCkgLyogYWxsIG9mIHRoZSBhYm92ZSAqLwo+ID4+PiAgICAKPiA+Pj4gICAgI2RlZmlu
ZSBfX0VYRUNfSEFTX1JFTE9DICAgIEJJVCgzMSkKPiA+Pj4gICAgI2RlZmluZSBfX0VYRUNfSU5U
RVJOQUxfRkxBR1MgICAgICAgKH4wdSA8PCAzMSkKPiA+Pj4gQEAgLTI0MSw2ICsyNDAsOCBAQCBz
dHJ1Y3QgaTkxNV9leGVjYnVmZmVyIHsKPiA+Pj4gICAgICAgIHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjb250ZXh0OyAvKiBsb2dpY2FsIHN0YXRlIGZvciB0aGUgcmVxdWVzdCAqLwo+ID4+PiAgICAg
ICAgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmdlbV9jb250ZXh0OyAvKiogY2FsbGVyJ3MgY29u
dGV4dCAqLwo+ID4+PiAgICAKPiA+Pj4gKyAgICAgc3RydWN0IGRtYV9mZW5jZSAqbW1fZmVuY2U7
Cj4gPj4+ICsKPiA+Pj4gICAgICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3Q7IC8qKiBv
dXIgcmVxdWVzdCB0byBidWlsZCAqLwo+ID4+PiAgICAgICAgc3RydWN0IGViX3ZtYSAqYmF0Y2g7
IC8qKiBpZGVudGl0eSBvZiB0aGUgYmF0Y2ggb2JqL3ZtYSAqLwo+ID4+PiAgICAgICAgc3RydWN0
IGk5MTVfdm1hICp0cmFtcG9saW5lOyAvKiogdHJhbXBvbGluZSB1c2VkIGZvciBjaGFpbmluZyAq
Lwo+ID4+PiBAQCAtMzMxLDEyICszMzIsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgZWJfdW5yZXNl
cnZlX3ZtYShzdHJ1Y3QgZWJfdm1hICpldikKPiA+Pj4gICAgICAgIGlmIChldi0+ZmxhZ3MgJiBf
X0VYRUNfT0JKRUNUX0hBU19QSU4pCj4gPj4+ICAgICAgICAgICAgICAgIF9faTkxNV92bWFfdW5w
aW4odm1hKTsKPiA+Pj4gICAgCj4gPj4+IC0gICAgIGlmIChldi0+ZmxhZ3MgJiBfX0VYRUNfT0JK
RUNUX0hBU19QQUdFUykKPiA+Pj4gLSAgICAgICAgICAgICBpOTE1X2dlbV9vYmplY3RfdW5waW5f
cGFnZXModm1hLT5vYmopOwo+ID4+PiAtCj4gPj4+IC0gICAgIGV2LT5mbGFncyAmPSB+KF9fRVhF
Q19PQkpFQ1RfSEFTX1BJTiB8Cj4gPj4+IC0gICAgICAgICAgICAgICAgICAgIF9fRVhFQ19PQkpF
Q1RfSEFTX0ZFTkNFIHwKPiA+Pj4gLSAgICAgICAgICAgICAgICAgICAgX19FWEVDX09CSkVDVF9I
QVNfUEFHRVMpOwo+ID4+PiArICAgICBldi0+ZmxhZ3MgJj0gfihfX0VYRUNfT0JKRUNUX0hBU19Q
SU4gfCBfX0VYRUNfT0JKRUNUX0hBU19GRU5DRSk7Cj4gPj4+ICAgIH0KPiA+Pj4gICAgCj4gPj4+
ICAgIHN0YXRpYyB2b2lkIGViX3ZtYV9hcnJheV9kZXN0cm95KHN0cnVjdCBrcmVmICprcmVmKQo+
ID4+PiBAQCAtNjY3LDYgKzY2Myw1NSBAQCBlYl9hZGRfdm1hKHN0cnVjdCBpOTE1X2V4ZWNidWZm
ZXIgKmViLAo+ID4+PiAgICAgICAgbGlzdF9hZGRfdGFpbCgmZXYtPmxvY2tfbGluaywgJmViLT5s
b2NrKTsKPiA+Pj4gICAgfQo+ID4+PiAgICAKPiA+Pj4gK3N0YXRpYyBpbnQgZWJfdm1hX2dldF9w
YWdlcyhzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwKPiA+Pj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgZWJfdm1hICpldiwKPiA+Pj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICB1NjQgaWR4KQo+ID4+PiArewo+ID4+PiArICAgICBzdHJ1Y3QgaTkxNV92bWEgKnZtYSA9IGV2
LT52bWE7Cj4gPj4+ICsgICAgIGludCBlcnI7Cj4gPj4+ICsKPiA+Pj4gKyAgICAgLyogWFhYIGFs
c28gcHJlYWxsb2NhdGUgUEQgZm9yIHZtYSAqLwo+ID4+PiArCj4gPj4+ICsgICAgIGVyciA9IF9f
X19pOTE1X2dlbV9vYmplY3RfZ2V0X3BhZ2VzX2FzeW5jKHZtYS0+b2JqKTsKPiA+Pj4gKyAgICAg
aWYgKGVycikKPiA+Pj4gKyAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ID4+PiArCj4gPj4+ICsg
ICAgIHJldHVybiBpOTE1X2FjdGl2ZV9yZWYoJnZtYS0+b2JqLT5tbS5hY3RpdmUsIGlkeCwgZWIt
Pm1tX2ZlbmNlKTsKPiA+Pj4gK30KPiA+Pj4gKwo+ID4+PiArc3RhdGljIGludCBlYl9yZXNlcnZl
X21tKHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViKQo+ID4+PiArewo+ID4+PiArICAgICBjb25z
dCB1NjQgaWR4ID0gZWItPmNvbnRleHQtPnRpbWVsaW5lLT5mZW5jZV9jb250ZXh0Owo+ID4+PiAr
ICAgICBzdHJ1Y3Qgd3dfYWNxdWlyZV9jdHggYWNxdWlyZTsKPiA+Pj4gKyAgICAgc3RydWN0IGVi
X3ZtYSAqZXY7Cj4gPj4+ICsgICAgIGludCBlcnI7Cj4gPj4+ICsKPiA+Pj4gKyAgICAgZWItPm1t
X2ZlbmNlID0gX19kbWFfZmVuY2VfY3JlYXRlX3Byb3h5KDAsIDApOwo+ID4+PiArICAgICBpZiAo
IWViLT5tbV9mZW5jZSkKPiA+Pj4gKyAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiA+PiBR
dWVzdGlvbjogZWIgaXMgbG9jYWwgdG8gdGhpcyB0aHJlYWQsIHJpZ2h0LCBzbyBlYi0+bW1fZmVu
Y2UgaXMgbm90Cj4gPj4gY29uc2lkZXJlZCAicHVibGlzaGVkIiB5ZXQ/Cj4gPj4KPiA+Pj4gKwo+
ID4+PiArICAgICB3d19hY3F1aXJlX2luaXQoJmFjcXVpcmUsICZyZXNlcnZhdGlvbl93d19jbGFz
cyk7Cj4gPj4+ICsKPiA+Pj4gKyAgICAgZXJyID0gZWJfbG9ja192bWEoZWIsICZhY3F1aXJlKTsK
PiA+Pj4gKyAgICAgaWYgKGVycikKPiA+Pj4gKyAgICAgICAgICAgICBnb3RvIG91dDsKPiA+Pj4g
Kwo+ID4+PiArICAgICB3d19hY3F1aXJlX2RvbmUoJmFjcXVpcmUpOwo+ID4+PiArCj4gPj4+ICsg
ICAgIGxpc3RfZm9yX2VhY2hfZW50cnkoZXYsICZlYi0+bG9jaywgbG9ja19saW5rKSB7Cj4gPj4+
ICsgICAgICAgICAgICAgc3RydWN0IGk5MTVfdm1hICp2bWEgPSBldi0+dm1hOwo+ID4+PiArCj4g
Pj4+ICsgICAgICAgICAgICAgaWYgKGVyciA9PSAwKQo+ID4+PiArICAgICAgICAgICAgICAgICAg
ICAgZXJyID0gZWJfdm1hX2dldF9wYWdlcyhlYiwgZXYsIGlkeCk7Cj4gPj4gSSBmaWd1cmUgdGhp
cyBpcyB3aGVyZSB5b3UgcHVibGlzaCB0aGUgcHJveHkgZmVuY2U/IElmIHNvLCB0aGUgZmVuY2UK
PiA+PiBzaWduYWxpbmcgY3JpdGljYWwgcGF0aCBzdGFydHMgd2l0aCB0aGlzIGxvb3AsCj4gPiBI
bW0sIGFjdHVhbGx5IGF0IHRoaXMgbW9tZW50LCB0aGUgZmVuY2UgaXMgc3RpbGwgdmVyeSBtdWNo
IGludGVybmFsCj4gPiBiZWluZyBvbmx5IHVzZWQgYXMgYSByZWZlcmVuY2UgdG9rZW4sCj4gSSB0
aGluayBhcyBsb25nIGFzIGFub3RoZXIgdGhyZWFkLCBydW5uaW5nIGluIHRoaXMgZHJpdmVyIG9y
IGFub3RoZXIgZ3B1IAo+IGRyaXZlciBjYW4gdGhlb3JldGljYWxseSByZWZlcmVuY2UgdGhlIGZl
bmNlIHBvaW50ZXIgZnJvbSB0aGUgCj4gcmVzZXJ2YXRpb24gb2JqZWN0IGFuZCB3YWl0IGZvciB0
aGUgZmVuY2UgaXQncyBjb25zaWRlcmVkIHB1Ymxpc2hlZC4KCkl0J3Mgbm90IGluIHRoZSByZXNl
cnZhdGlvbiBvYmplY3QuCiAKPiBBbHNvIHRoZSB3d19tdXRleGVzIGluIHRoaXMgY29udGV4dCBh
cmUgcmVhbGx5IGFsbCBhYm91dCBncmFiYmluZyBhIAo+IHJhbmRvbSBzZXQgb2YgcmVzb3VyY2Vz
IGFuZCBhc3NvY2lhdGUgdGhlbSB3aXRoIGEgcG9pbnQgaW4gYSB0aW1lbGluZSwgCj4gYXMgdGhl
IHd3X211dGV4ZXMgYXJlIHJlbGVhc2VkLCB0aGUgZmVuY2UgcG9pbnRlcihzKSBuZWVkIHRvIHBv
aW50IHRvIAo+IHB1Ymxpc2hlZCBmZW5jZShzKS4KClRoYXQncyBub3QgdGhlIHB1cnBvc2Ugb2Yg
dGhlc2UgZmVuY2VzLCB0aG91Z2guIFRoZXkgZXhpc3QgdG8gcHJvdmlkZQpyZWZlcmVuY2UgY291
bnRpbmcgb24gdGhlIGJhY2tpbmcgc3RvcmUsIGFsb25nIHNpZGUgdGhlIG1pZ3JhdGlvbiBmZW5j
ZS4KSXQncyBleHRyYSBkZXRhaWwgdGFja2VkIG9uIHRoZSBlcXVpdmFsZW50IG9mIGJvLT5tb3Zp
bmcuCgpUaGF0IGlzIG5vdCB0byBzYXkgdGhhdCBvbmUgY291bGQgYnVpbGQgdXAgYW4gYXN5bmMg
bWlncmF0aW9uIGNoYWluIHdoaWNoCmZvcm0gYSBncmFwaCBiYWNrIHRvIHRoZXNlLCB0aGF0IGNo
YWluIGNvdWxkIG9ubHkgYmUgZm9ybWVkIG9uY2UgdGhlCm9wZXJhdGlvbiBpdHNlbGYgaGFzIGJl
ZW4gcHVibGlzaGVkIGluIHRoZSBkbWFfcmVzdiB0aG91Z2guCi1DaHJpcwpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0
CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3Rv
cC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

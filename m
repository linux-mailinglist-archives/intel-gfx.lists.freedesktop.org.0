Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 2E6872DC89F
	for <lists+intel-gfx@lfdr.de>; Wed, 16 Dec 2020 23:04:02 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 04A4E89BB3;
	Wed, 16 Dec 2020 22:04:00 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (unknown [77.68.26.236])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 408EE89BB3
 for <intel-gfx@lists.freedesktop.org>; Wed, 16 Dec 2020 22:03:56 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from build.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 23348975-1500050 
 for <intel-gfx@lists.freedesktop.org>; Wed, 16 Dec 2020 22:03:51 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 16 Dec 2020 22:03:52 +0000
Message-Id: <20201216220353.18430-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 1/2] drm/i915/gt: Split logical ring contexts from
 execlist submission
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U3BsaXQgdGhlIGRlZmluaXRpb24sIGNvbnN0cnVjdGlvbiBhbmQgdXBkYXRpbmcgb2YgdGhlIExv
Z2ljYWwgUmluZwpDb250ZXh0IGZyb20gdGhlIGV4ZWNsaXN0IHN1Ym1pc3Npb24gaW50ZXJmYWNl
LiBUaGUgTFJDIGlzIHVzZWQgYnkgdGhlCkhXLCBpcnJlc3BlY3RpdmUgb2Ygb3VyIGRpZmZlcmVu
dCBzdWJtaXNzaW9uIGJhY2tlbmRzLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJp
c0BjaHJpcy13aWxzb24uY28udWs+ClJldmlld2VkLWJ5OiBEYW5pZWxlIENlcmFvbG8gU3B1cmlv
IDxkYW5pZWxlLmNlcmFvbG9zcHVyaW9AaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuYyAgICAgIHwgICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1LmMgIHwgICAgMyArLQogLi4uL2RybS9pOTE1L2d0L2lu
dGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMgIHwgMTUyMiArLS0tLS0tLS0tLS0tLQogLi4uL2Ry
bS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmggIHwgICAxNyAtCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyAgICAgICAgICAgfCAxNDcyICsrKysrKysrKysr
KysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5oICAgICAgICAgICB8ICAgNjcg
KwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjX3JlZy5oICAgICAgIHwgICAgMiAr
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9leGVjbGlzdHMuYyAgfCAxNzc2ICst
LS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jICAg
ICAgICB8IDE4NjQgKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Vj
L2ludGVsX2d1Y19hZHMuYyAgICB8ICAgIDIgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50
ZWxfZ3VjX3N1Ym1pc3Npb24uYyB8ICAgMjYgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9z
Y2hlZHVsZXIuYyAgICAgICAgICB8ICAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9w
ZXJmLmMgICAgICAgICAgICAgIHwgICAgMiArLQogMTQgZmlsZXMgY2hhbmdlZCwgMzQ1NyBpbnNl
cnRpb25zKCspLCAzMzAwIGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L01ha2VmaWxlIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKaW5kZXggZjll
ZjUxOTliMTI0Li44NDljN2IzZmM5NDEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L01ha2VmaWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCkBAIC0xMDQsNiAr
MTA0LDcgQEAgZ3QteSArPSBcCiAJZ3QvaW50ZWxfZ3RfcmVxdWVzdHMubyBcCiAJZ3QvaW50ZWxf
Z3R0Lm8gXAogCWd0L2ludGVsX2xsYy5vIFwKKwlndC9pbnRlbF9scmMubyBcCiAJZ3QvaW50ZWxf
bW9jcy5vIFwKIAlndC9pbnRlbF9wcGd0dC5vIFwKIAlndC9pbnRlbF9yYzYubyBcCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVfY3MuYwppbmRleCA5YzZmMGViZmEzY2YuLjE5NzJk
ZDVkY2EwMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZ2VuOF9lbmdpbmVf
Y3MuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9nZW44X2VuZ2luZV9jcy5jCkBAIC01
LDcgKzUsNyBAQAogCiAjaW5jbHVkZSAiZ2VuOF9lbmdpbmVfY3MuaCIKICNpbmNsdWRlICJpOTE1
X2Rydi5oIgotI2luY2x1ZGUgImludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmgiIC8qIFhYWCAq
LworI2luY2x1ZGUgImludGVsX2xyYy5oIgogI2luY2x1ZGUgImludGVsX2dwdV9jb21tYW5kcy5o
IgogI2luY2x1ZGUgImludGVsX3JpbmcuaCIKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9jb250ZXh0X3NzZXUuYwppbmRleCA1Zjk0YjQ0MDIyZGMuLjhkZmQ4ZjY1NmFhYSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF9zc2V1LmMKQEAgLTgsOCAr
OCw3IEBACiAjaW5jbHVkZSAiaW50ZWxfY29udGV4dC5oIgogI2luY2x1ZGUgImludGVsX2VuZ2lu
ZV9wbS5oIgogI2luY2x1ZGUgImludGVsX2dwdV9jb21tYW5kcy5oIgotI2luY2x1ZGUgImludGVs
X2V4ZWNsaXN0c19zdWJtaXNzaW9uLmgiCi0jaW5jbHVkZSAiaW50ZWxfbHJjX3JlZy5oIgorI2lu
Y2x1ZGUgImludGVsX2xyYy5oIgogI2luY2x1ZGUgImludGVsX3JpbmcuaCIKICNpbmNsdWRlICJp
bnRlbF9zc2V1LmgiCiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2V4ZWNsaXN0c19zdWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9l
eGVjbGlzdHNfc3VibWlzc2lvbi5jCmluZGV4IGRjZWNjMjg4Nzg5MS4uNjVmZjNmMzAxM2E3IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3VibWlz
c2lvbi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJt
aXNzaW9uLmMKQEAgLTEwOSw3ICsxMDksNiBAQAogI2luY2x1ZGUgPGxpbnV4L2ludGVycnVwdC5o
PgogCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKLSNpbmNsdWRlICJpOTE1X3BlcmYuaCIKICNpbmNs
dWRlICJpOTE1X3RyYWNlLmgiCiAjaW5jbHVkZSAiaTkxNV92Z3B1LmgiCiAjaW5jbHVkZSAiZ2Vu
OF9lbmdpbmVfY3MuaCIKQEAgLTEyMCw2ICsxMTksNyBAQAogI2luY2x1ZGUgImludGVsX2d0Lmgi
CiAjaW5jbHVkZSAiaW50ZWxfZ3RfcG0uaCIKICNpbmNsdWRlICJpbnRlbF9ndF9yZXF1ZXN0cy5o
IgorI2luY2x1ZGUgImludGVsX2xyYy5oIgogI2luY2x1ZGUgImludGVsX2xyY19yZWcuaCIKICNp
bmNsdWRlICJpbnRlbF9tb2NzLmgiCiAjaW5jbHVkZSAiaW50ZWxfcmVzZXQuaCIKQEAgLTE0NCw4
ICsxNDQsNiBAQAogI2RlZmluZSBHRU44X0NUWF9TVEFUVVNfQ09NUExFVEVEX01BU0sgXAogCSAo
R0VOOF9DVFhfU1RBVFVTX0NPTVBMRVRFIHwgR0VOOF9DVFhfU1RBVFVTX1BSRUVNUFRFRCkKIAot
I2RlZmluZSBDVFhfREVTQ19GT1JDRV9SRVNUT1JFIEJJVF9VTEwoMikKLQogI2RlZmluZSBHRU4x
Ml9DVFhfU1RBVFVTX1NXSVRDSEVEX1RPX05FV19RVUVVRQkoMHgxKSAvKiBsb3dlciBjc2IgZHdv
cmQgKi8KICNkZWZpbmUgR0VOMTJfQ1RYX1NXSVRDSF9ERVRBSUwoY3NiX2R3KQkoKGNzYl9kdykg
JiAweEYpIC8qIHVwcGVyIGNzYiBkd29yZCAqLwogI2RlZmluZSBHRU4xMl9DU0JfU1dfQ1RYX0lE
X01BU0sJCUdFTk1BU0soMjUsIDE1KQpAQCAtMjA4LDEzMyArMjA2LDYgQEAgc3RhdGljIHN0cnVj
dCB2aXJ0dWFsX2VuZ2luZSAqdG9fdmlydHVhbF9lbmdpbmUoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQogc3RhdGljIGludCBfX2V4ZWNsaXN0c19jb250ZXh0X2FsbG9jKHN0cnVjdCBp
bnRlbF9jb250ZXh0ICpjZSwKIAkJCQkgICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSk7CiAKLXN0YXRpYyB2b2lkIGV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh1MzIgKnJlZ19zdGF0
ZSwKLQkJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKLQkJCQkgICAgIGNv
bnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCQkgICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9yaW5nICpyaW5nLAotCQkJCSAgICAgYm9vbCBjbG9zZSk7Ci1zdGF0aWMgdm9pZAot
X19leGVjbGlzdHNfdXBkYXRlX3JlZ19zdGF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UsCi0JCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAg
ICAgdTMyIGhlYWQpOwotCi1zdGF0aWMgaW50IGxyY19yaW5nX21pX21vZGUoY29uc3Qgc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1
KSA+PSAxMikKLQkJcmV0dXJuIDB4NjA7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkx
NSkgPj0gOSkKLQkJcmV0dXJuIDB4NTQ7Ci0JZWxzZSBpZiAoZW5naW5lLT5jbGFzcyA9PSBSRU5E
RVJfQ0xBU1MpCi0JCXJldHVybiAweDU4OwotCWVsc2UKLQkJcmV0dXJuIC0xOwotfQotCi1zdGF0
aWMgaW50IGxyY19yaW5nX2dwcjAoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQotewotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikKLQkJcmV0dXJuIDB4NzQ7
Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gOSkKLQkJcmV0dXJuIDB4Njg7
Ci0JZWxzZSBpZiAoZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpCi0JCXJldHVybiAweGQ4
OwotCWVsc2UKLQkJcmV0dXJuIC0xOwotfQotCi1zdGF0aWMgaW50IGxyY19yaW5nX3dhX2JiX3Bl
cl9jdHgoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWlmIChJTlRF
TF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikKLQkJcmV0dXJuIDB4MTI7Ci0JZWxzZSBpZiAoSU5U
RUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gOSB8fCBlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFT
UykKLQkJcmV0dXJuIDB4MTg7Ci0JZWxzZQotCQlyZXR1cm4gLTE7Ci19Ci0KLXN0YXRpYyBpbnQg
bHJjX3JpbmdfaW5kaXJlY3RfcHRyKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKLXsKLQlpbnQgeDsKLQotCXggPSBscmNfcmluZ193YV9iYl9wZXJfY3R4KGVuZ2luZSk7Ci0J
aWYgKHggPCAwKQotCQlyZXR1cm4geDsKLQotCXJldHVybiB4ICsgMjsKLX0KLQotc3RhdGljIGlu
dCBscmNfcmluZ19pbmRpcmVjdF9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQotewotCWludCB4OwotCi0JeCA9IGxyY19yaW5nX2luZGlyZWN0X3B0cihlbmdpbmUp
OwotCWlmICh4IDwgMCkKLQkJcmV0dXJuIHg7Ci0KLQlyZXR1cm4geCArIDI7Ci19Ci0KLXN0YXRp
YyBpbnQgbHJjX3JpbmdfY21kX2J1Zl9jY3RsKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKLXsKLQlpZiAoZW5naW5lLT5jbGFzcyAhPSBSRU5ERVJfQ0xBU1MpCi0JCXJldHVy
biAtMTsKLQotCWlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikKLQkJcmV0dXJuIDB4
YjY7Ci0JZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTEpCi0JCXJldHVybiAw
eGFhOwotCWVsc2UKLQkJcmV0dXJuIC0xOwotfQotCi1zdGF0aWMgdTMyCi1scmNfcmluZ19pbmRp
cmVjdF9vZmZzZXRfZGVmYXVsdChjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
Ci17Ci0Jc3dpdGNoIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSkgewotCWRlZmF1bHQ6Ci0JCU1J
U1NJTkdfQ0FTRShJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSk7Ci0JCWZhbGx0aHJvdWdoOwotCWNh
c2UgMTI6Ci0JCXJldHVybiBHRU4xMl9DVFhfUkNTX0lORElSRUNUX0NUWF9PRkZTRVRfREVGQVVM
VDsKLQljYXNlIDExOgotCQlyZXR1cm4gR0VOMTFfQ1RYX1JDU19JTkRJUkVDVF9DVFhfT0ZGU0VU
X0RFRkFVTFQ7Ci0JY2FzZSAxMDoKLQkJcmV0dXJuIEdFTjEwX0NUWF9SQ1NfSU5ESVJFQ1RfQ1RY
X09GRlNFVF9ERUZBVUxUOwotCWNhc2UgOToKLQkJcmV0dXJuIEdFTjlfQ1RYX1JDU19JTkRJUkVD
VF9DVFhfT0ZGU0VUX0RFRkFVTFQ7Ci0JY2FzZSA4OgotCQlyZXR1cm4gR0VOOF9DVFhfUkNTX0lO
RElSRUNUX0NUWF9PRkZTRVRfREVGQVVMVDsKLQl9Ci19Ci0KLXN0YXRpYyB2b2lkCi1scmNfcmlu
Z19zZXR1cF9pbmRpcmVjdF9jdHgodTMyICpyZWdzLAotCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAgICB1MzIgY3R4X2JiX2dndHRfYWRkciwKLQkJCSAg
ICB1MzIgc2l6ZSkKLXsKLQlHRU1fQlVHX09OKCFzaXplKTsKLQlHRU1fQlVHX09OKCFJU19BTElH
TkVEKHNpemUsIENBQ0hFTElORV9CWVRFUykpOwotCUdFTV9CVUdfT04obHJjX3JpbmdfaW5kaXJl
Y3RfcHRyKGVuZ2luZSkgPT0gLTEpOwotCXJlZ3NbbHJjX3JpbmdfaW5kaXJlY3RfcHRyKGVuZ2lu
ZSkgKyAxXSA9Ci0JCWN0eF9iYl9nZ3R0X2FkZHIgfCAoc2l6ZSAvIENBQ0hFTElORV9CWVRFUyk7
Ci0KLQlHRU1fQlVHX09OKGxyY19yaW5nX2luZGlyZWN0X29mZnNldChlbmdpbmUpID09IC0xKTsK
LQlyZWdzW2xyY19yaW5nX2luZGlyZWN0X29mZnNldChlbmdpbmUpICsgMV0gPQotCQlscmNfcmlu
Z19pbmRpcmVjdF9vZmZzZXRfZGVmYXVsdChlbmdpbmUpIDw8IDY7Ci19Ci0KLXN0YXRpYyB1MzIg
aW50ZWxfY29udGV4dF9nZXRfcnVudGltZShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Up
Ci17Ci0JLyoKLQkgKiBXZSBjYW4gdXNlIGVpdGhlciBwcEhXU1BbMTZdIHdoaWNoIGlzIHJlY29y
ZGVkIGJlZm9yZSB0aGUgY29udGV4dAotCSAqIHN3aXRjaCAoYW5kIHNvIGV4Y2x1ZGVzIHRoZSBj
b3N0IG9mIGNvbnRleHQgc3dpdGNoZXMpIG9yIHVzZSB0aGUKLQkgKiB2YWx1ZSBmcm9tIHRoZSBj
b250ZXh0IGltYWdlIGl0c2VsZiwgd2hpY2ggaXMgc2F2ZWQvcmVzdG9yZWQgZWFybGllcgotCSAq
IGFuZCBzbyBpbmNsdWRlcyB0aGUgY29zdCBvZiB0aGUgc2F2ZS4KLQkgKi8KLQlyZXR1cm4gUkVB
RF9PTkNFKGNlLT5scmNfcmVnX3N0YXRlW0NUWF9USU1FU1RBTVBdKTsKLX0KLQogc3RhdGljIHZv
aWQgbWFya19laW8oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CiAJaWYgKGk5MTVfcmVxdWVz
dF9jb21wbGV0ZWQocnEpKQpAQCAtNTEzLDU2OCArMzg0LDYgQEAgYXNzZXJ0X3ByaW9yaXR5X3F1
ZXVlKGNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnByZXYsCiAJcmV0dXJuIHJxX3ByaW8ocHJl
dikgPj0gcnFfcHJpbyhuZXh0KTsKIH0KIAotLyoKLSAqIFRoZSBjb250ZXh0IGRlc2NyaXB0b3Ig
ZW5jb2RlcyB2YXJpb3VzIGF0dHJpYnV0ZXMgb2YgYSBjb250ZXh0LAotICogaW5jbHVkaW5nIGl0
cyBHVFQgYWRkcmVzcyBhbmQgc29tZSBmbGFncy4gQmVjYXVzZSBpdCdzIGZhaXJseQotICogZXhw
ZW5zaXZlIHRvIGNhbGN1bGF0ZSwgd2UnbGwganVzdCBkbyBpdCBvbmNlIGFuZCBjYWNoZSB0aGUg
cmVzdWx0LAotICogd2hpY2ggcmVtYWlucyB2YWxpZCB1bnRpbCB0aGUgY29udGV4dCBpcyB1bnBp
bm5lZC4KLSAqCi0gKiBUaGlzIGlzIHdoYXQgYSBkZXNjcmlwdG9yIGxvb2tzIGxpa2UsIGZyb20g
TFNCIHRvIE1TQjo6Ci0gKgotICogICAgICBiaXRzICAwLTExOiAgICBmbGFncywgR0VOOF9DVFhf
KiAoY2FjaGVkIGluIGN0eC0+ZGVzY190ZW1wbGF0ZSkKLSAqICAgICAgYml0cyAxMi0zMTogICAg
TFJDQSwgR1RUIGFkZHJlc3Mgb2YgKHRoZSBIV1NQIG9mKSB0aGlzIGNvbnRleHQKLSAqICAgICAg
Yml0cyAzMi01MjogICAgY3R4IElELCBhIGdsb2JhbGx5IHVuaXF1ZSB0YWcgKGhpZ2hlc3QgYml0
IHVzZWQgYnkgR3VDKQotICogICAgICBiaXRzIDUzLTU0OiAgICBtYnosIHJlc2VydmVkIGZvciB1
c2UgYnkgaGFyZHdhcmUKLSAqICAgICAgYml0cyA1NS02MzogICAgZ3JvdXAgSUQsIGN1cnJlbnRs
eSB1bnVzZWQgYW5kIHNldCB0byAwCi0gKgotICogU3RhcnRpbmcgZnJvbSBHZW4xMSwgdGhlIHVw
cGVyIGR3b3JkIG9mIHRoZSBkZXNjcmlwdG9yIGhhcyBhIG5ldyBmb3JtYXQ6Ci0gKgotICogICAg
ICBiaXRzIDMyLTM2OiAgICByZXNlcnZlZAotICogICAgICBiaXRzIDM3LTQ3OiAgICBTVyBjb250
ZXh0IElECi0gKiAgICAgIGJpdHMgNDg6NTM6ICAgIGVuZ2luZSBpbnN0YW5jZQotICogICAgICBi
aXQgNTQ6ICAgICAgICBtYnosIHJlc2VydmVkIGZvciB1c2UgYnkgaGFyZHdhcmUKLSAqICAgICAg
Yml0cyA1NS02MDogICAgU1cgY291bnRlcgotICogICAgICBiaXRzIDYxLTYzOiAgICBlbmdpbmUg
Y2xhc3MKLSAqCi0gKiBlbmdpbmUgaW5mbywgU1cgY29udGV4dCBJRCBhbmQgU1cgY291bnRlciBu
ZWVkIHRvIGZvcm0gYSB1bmlxdWUgbnVtYmVyCi0gKiAoQ29udGV4dCBJRCkgcGVyIGxyYy4KLSAq
Lwotc3RhdGljIHUzMgotbHJjX2Rlc2NyaXB0b3Ioc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0JdTMyIGRlc2M7Ci0KLQlkZXNjID0g
SU5URUxfTEVHQUNZXzMyQl9DT05URVhUOwotCWlmIChpOTE1X3ZtX2lzXzRsdmwoY2UtPnZtKSkK
LQkJZGVzYyA9IElOVEVMX0xFR0FDWV82NEJfQ09OVEVYVDsKLQlkZXNjIDw8PSBHRU44X0NUWF9B
RERSRVNTSU5HX01PREVfU0hJRlQ7Ci0KLQlkZXNjIHw9IEdFTjhfQ1RYX1ZBTElEIHwgR0VOOF9D
VFhfUFJJVklMRUdFOwotCWlmIChJU19HRU4oZW5naW5lLT5pOTE1LCA4KSkKLQkJZGVzYyB8PSBH
RU44X0NUWF9MM0xMQ19DT0hFUkVOVDsKLQotCXJldHVybiBpOTE1X2dndHRfb2Zmc2V0KGNlLT5z
dGF0ZSkgfCBkZXNjOwotfQotCi1zdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBkd29yZF9pbl9w
YWdlKHZvaWQgKmFkZHIpCi17Ci0JcmV0dXJuIG9mZnNldF9pbl9wYWdlKGFkZHIpIC8gc2l6ZW9m
KHUzMik7Ci19Ci0KLXN0YXRpYyB2b2lkIHNldF9vZmZzZXRzKHUzMiAqcmVncywKLQkJCWNvbnN0
IHU4ICpkYXRhLAotCQkJY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJ
Ym9vbCBjbGVhcikKLSNkZWZpbmUgTk9QKHgpIChCSVQoNykgfCAoeCkpCi0jZGVmaW5lIExSSShj
b3VudCwgZmxhZ3MpICgoZmxhZ3MpIDw8IDYgfCAoY291bnQpIHwgQlVJTERfQlVHX09OX1pFUk8o
Y291bnQgPj0gQklUKDYpKSkKLSNkZWZpbmUgUE9TVEVEIEJJVCgwKQotI2RlZmluZSBSRUcoeCkg
KCgoeCkgPj4gMikgfCBCVUlMRF9CVUdfT05fWkVSTyh4ID49IDB4MjAwKSkKLSNkZWZpbmUgUkVH
MTYoeCkgXAotCSgoKHgpID4+IDkpIHwgQklUKDcpIHwgQlVJTERfQlVHX09OX1pFUk8oeCA+PSAw
eDEwMDAwKSksIFwKLQkoKCh4KSA+PiAyKSAmIDB4N2YpCi0jZGVmaW5lIEVORCh0b3RhbF9zdGF0
ZV9zaXplKSAwLCAodG90YWxfc3RhdGVfc2l6ZSkKLXsKLQljb25zdCB1MzIgYmFzZSA9IGVuZ2lu
ZS0+bW1pb19iYXNlOwotCi0Jd2hpbGUgKCpkYXRhKSB7Ci0JCXU4IGNvdW50LCBmbGFnczsKLQot
CQlpZiAoKmRhdGEgJiBCSVQoNykpIHsgLyogc2tpcCAqLwotCQkJY291bnQgPSAqZGF0YSsrICYg
fkJJVCg3KTsKLQkJCWlmIChjbGVhcikKLQkJCQltZW1zZXQzMihyZWdzLCBNSV9OT09QLCBjb3Vu
dCk7Ci0JCQlyZWdzICs9IGNvdW50OwotCQkJY29udGludWU7Ci0JCX0KLQotCQljb3VudCA9ICpk
YXRhICYgMHgzZjsKLQkJZmxhZ3MgPSAqZGF0YSA+PiA2OwotCQlkYXRhKys7Ci0KLQkJKnJlZ3Mg
PSBNSV9MT0FEX1JFR0lTVEVSX0lNTShjb3VudCk7Ci0JCWlmIChmbGFncyAmIFBPU1RFRCkKLQkJ
CSpyZWdzIHw9IE1JX0xSSV9GT1JDRV9QT1NURUQ7Ci0JCWlmIChJTlRFTF9HRU4oZW5naW5lLT5p
OTE1KSA+PSAxMSkKLQkJCSpyZWdzIHw9IE1JX0xSSV9MUk1fQ1NfTU1JTzsKLQkJcmVncysrOwot
Ci0JCUdFTV9CVUdfT04oIWNvdW50KTsKLQkJZG8gewotCQkJdTMyIG9mZnNldCA9IDA7Ci0JCQl1
OCB2OwotCi0JCQlkbyB7Ci0JCQkJdiA9ICpkYXRhKys7Ci0JCQkJb2Zmc2V0IDw8PSA3OwotCQkJ
CW9mZnNldCB8PSB2ICYgfkJJVCg3KTsKLQkJCX0gd2hpbGUgKHYgJiBCSVQoNykpOwotCi0JCQly
ZWdzWzBdID0gYmFzZSArIChvZmZzZXQgPDwgMik7Ci0JCQlpZiAoY2xlYXIpCi0JCQkJcmVnc1sx
XSA9IDA7Ci0JCQlyZWdzICs9IDI7Ci0JCX0gd2hpbGUgKC0tY291bnQpOwotCX0KLQotCWlmIChj
bGVhcikgewotCQl1OCBjb3VudCA9ICorK2RhdGE7Ci0KLQkJLyogQ2xlYXIgcGFzdCB0aGUgdGFp
bCBmb3IgSFcgYWNjZXNzICovCi0JCUdFTV9CVUdfT04oZHdvcmRfaW5fcGFnZShyZWdzKSA+IGNv
dW50KTsKLQkJbWVtc2V0MzIocmVncywgTUlfTk9PUCwgY291bnQgLSBkd29yZF9pbl9wYWdlKHJl
Z3MpKTsKLQotCQkvKiBDbG9zZSB0aGUgYmF0Y2g7IHVzZWQgbWFpbmx5IGJ5IGxpdmVfbHJjX2xh
eW91dCgpICovCi0JCSpyZWdzID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsKLQkJaWYgKElOVEVMX0dF
TihlbmdpbmUtPmk5MTUpID49IDEwKQotCQkJKnJlZ3MgfD0gQklUKDApOwotCX0KLX0KLQotc3Rh
dGljIGNvbnN0IHU4IGdlbjhfeGNzX29mZnNldHNbXSA9IHsKLQlOT1AoMSksCi0JTFJJKDExLCAw
KSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4MDM0KSwKLQlSRUcoMHgwMzApLAotCVJFRygweDAz
OCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgxNjgpLAotCVJFRygweDE0MCksCi0JUkVHKDB4MTEw
KSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDExNCksCi0JUkVHKDB4MTE4KSwKLQotCU5PUCg5KSwK
LQlMUkkoOSwgMCksCi0JUkVHMTYoMHgzYTgpLAotCVJFRzE2KDB4MjhjKSwKLQlSRUcxNigweDI4
OCksCi0JUkVHMTYoMHgyODQpLAotCVJFRzE2KDB4MjgwKSwKLQlSRUcxNigweDI3YyksCi0JUkVH
MTYoMHgyNzgpLAotCVJFRzE2KDB4Mjc0KSwKLQlSRUcxNigweDI3MCksCi0KLQlOT1AoMTMpLAot
CUxSSSgyLCAwKSwKLQlSRUcxNigweDIwMCksCi0JUkVHKDB4MDI4KSwKLQotCUVORCg4MCkKLX07
Ci0KLXN0YXRpYyBjb25zdCB1OCBnZW45X3hjc19vZmZzZXRzW10gPSB7Ci0JTk9QKDEpLAotCUxS
SSgxNCwgUE9TVEVEKSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4MDM0KSwKLQlSRUcoMHgwMzAp
LAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgxNjgpLAotCVJFRygweDE0MCks
Ci0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDExNCksCi0JUkVHKDB4MTE4KSwK
LQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4KSwKLQotCU5PUCgzKSwKLQlM
UkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYoMHgyOGMpLAotCVJFRzE2KDB4
Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAotCVJFRzE2KDB4MjdjKSwKLQlS
RUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4MjcwKSwKLQotCU5PUCgxMyks
Ci0JTFJJKDEsIFBPU1RFRCksCi0JUkVHMTYoMHgyMDApLAotCi0JTk9QKDEzKSwKLQlMUkkoNDQs
IFBPU1RFRCksCi0JUkVHKDB4MDI4KSwKLQlSRUcoMHgwOWMpLAotCVJFRygweDBjMCksCi0JUkVH
KDB4MTc4KSwKLQlSRUcoMHgxN2MpLAotCVJFRzE2KDB4MzU4KSwKLQlSRUcoMHgxNzApLAotCVJF
RygweDE1MCksCi0JUkVHKDB4MTU0KSwKLQlSRUcoMHgxNTgpLAotCVJFRzE2KDB4NDFjKSwKLQlS
RUcxNigweDYwMCksCi0JUkVHMTYoMHg2MDQpLAotCVJFRzE2KDB4NjA4KSwKLQlSRUcxNigweDYw
YyksCi0JUkVHMTYoMHg2MTApLAotCVJFRzE2KDB4NjE0KSwKLQlSRUcxNigweDYxOCksCi0JUkVH
MTYoMHg2MWMpLAotCVJFRzE2KDB4NjIwKSwKLQlSRUcxNigweDYyNCksCi0JUkVHMTYoMHg2Mjgp
LAotCVJFRzE2KDB4NjJjKSwKLQlSRUcxNigweDYzMCksCi0JUkVHMTYoMHg2MzQpLAotCVJFRzE2
KDB4NjM4KSwKLQlSRUcxNigweDYzYyksCi0JUkVHMTYoMHg2NDApLAotCVJFRzE2KDB4NjQ0KSwK
LQlSRUcxNigweDY0OCksCi0JUkVHMTYoMHg2NGMpLAotCVJFRzE2KDB4NjUwKSwKLQlSRUcxNigw
eDY1NCksCi0JUkVHMTYoMHg2NTgpLAotCVJFRzE2KDB4NjVjKSwKLQlSRUcxNigweDY2MCksCi0J
UkVHMTYoMHg2NjQpLAotCVJFRzE2KDB4NjY4KSwKLQlSRUcxNigweDY2YyksCi0JUkVHMTYoMHg2
NzApLAotCVJFRzE2KDB4Njc0KSwKLQlSRUcxNigweDY3OCksCi0JUkVHMTYoMHg2N2MpLAotCVJF
RygweDA2OCksCi0KLQlFTkQoMTc2KQotfTsKLQotc3RhdGljIGNvbnN0IHU4IGdlbjEyX3hjc19v
ZmZzZXRzW10gPSB7Ci0JTk9QKDEpLAotCUxSSSgxMywgUE9TVEVEKSwKLQlSRUcxNigweDI0NCks
Ci0JUkVHKDB4MDM0KSwKLQlSRUcoMHgwMzApLAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwK
LQlSRUcoMHgxNjgpLAotCVJFRygweDE0MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxYzApLAot
CVJFRygweDFjNCksCi0JUkVHKDB4MWM4KSwKLQlSRUcoMHgxODApLAotCVJFRzE2KDB4MmI0KSwK
LQotCU5PUCg1KSwKLQlMUkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYoMHgy
OGMpLAotCVJFRzE2KDB4Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAotCVJF
RzE2KDB4MjdjKSwKLQlSRUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4Mjcw
KSwKLQotCUVORCg4MCkKLX07Ci0KLXN0YXRpYyBjb25zdCB1OCBnZW44X3Jjc19vZmZzZXRzW10g
PSB7Ci0JTk9QKDEpLAotCUxSSSgxNCwgUE9TVEVEKSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4
MDM0KSwKLQlSRUcoMHgwMzApLAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgx
NjgpLAotCVJFRygweDE0MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDEx
NCksCi0JUkVHKDB4MTE4KSwKLQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4
KSwKLQotCU5PUCgzKSwKLQlMUkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYo
MHgyOGMpLAotCVJFRzE2KDB4Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAot
CVJFRzE2KDB4MjdjKSwKLQlSRUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4
MjcwKSwKLQotCU5PUCgxMyksCi0JTFJJKDEsIDApLAotCVJFRygweDBjOCksCi0KLQlFTkQoODAp
Ci19OwotCi1zdGF0aWMgY29uc3QgdTggZ2VuOV9yY3Nfb2Zmc2V0c1tdID0gewotCU5PUCgxKSwK
LQlMUkkoMTQsIFBPU1RFRCksCi0JUkVHMTYoMHgyNDQpLAotCVJFRygweDM0KSwKLQlSRUcoMHgz
MCksCi0JUkVHKDB4MzgpLAotCVJFRygweDNjKSwKLQlSRUcoMHgxNjgpLAotCVJFRygweDE0MCks
Ci0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDExNCksCi0JUkVHKDB4MTE4KSwK
LQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4KSwKLQotCU5PUCgzKSwKLQlM
UkkoOSwgUE9TVEVEKSwKLQlSRUcxNigweDNhOCksCi0JUkVHMTYoMHgyOGMpLAotCVJFRzE2KDB4
Mjg4KSwKLQlSRUcxNigweDI4NCksCi0JUkVHMTYoMHgyODApLAotCVJFRzE2KDB4MjdjKSwKLQlS
RUcxNigweDI3OCksCi0JUkVHMTYoMHgyNzQpLAotCVJFRzE2KDB4MjcwKSwKLQotCU5PUCgxMyks
Ci0JTFJJKDEsIDApLAotCVJFRygweGM4KSwKLQotCU5PUCgxMyksCi0JTFJJKDQ0LCBQT1NURUQp
LAotCVJFRygweDI4KSwKLQlSRUcoMHg5YyksCi0JUkVHKDB4YzApLAotCVJFRygweDE3OCksCi0J
UkVHKDB4MTdjKSwKLQlSRUcxNigweDM1OCksCi0JUkVHKDB4MTcwKSwKLQlSRUcoMHgxNTApLAot
CVJFRygweDE1NCksCi0JUkVHKDB4MTU4KSwKLQlSRUcxNigweDQxYyksCi0JUkVHMTYoMHg2MDAp
LAotCVJFRzE2KDB4NjA0KSwKLQlSRUcxNigweDYwOCksCi0JUkVHMTYoMHg2MGMpLAotCVJFRzE2
KDB4NjEwKSwKLQlSRUcxNigweDYxNCksCi0JUkVHMTYoMHg2MTgpLAotCVJFRzE2KDB4NjFjKSwK
LQlSRUcxNigweDYyMCksCi0JUkVHMTYoMHg2MjQpLAotCVJFRzE2KDB4NjI4KSwKLQlSRUcxNigw
eDYyYyksCi0JUkVHMTYoMHg2MzApLAotCVJFRzE2KDB4NjM0KSwKLQlSRUcxNigweDYzOCksCi0J
UkVHMTYoMHg2M2MpLAotCVJFRzE2KDB4NjQwKSwKLQlSRUcxNigweDY0NCksCi0JUkVHMTYoMHg2
NDgpLAotCVJFRzE2KDB4NjRjKSwKLQlSRUcxNigweDY1MCksCi0JUkVHMTYoMHg2NTQpLAotCVJF
RzE2KDB4NjU4KSwKLQlSRUcxNigweDY1YyksCi0JUkVHMTYoMHg2NjApLAotCVJFRzE2KDB4NjY0
KSwKLQlSRUcxNigweDY2OCksCi0JUkVHMTYoMHg2NmMpLAotCVJFRzE2KDB4NjcwKSwKLQlSRUcx
NigweDY3NCksCi0JUkVHMTYoMHg2NzgpLAotCVJFRzE2KDB4NjdjKSwKLQlSRUcoMHg2OCksCi0K
LQlFTkQoMTc2KQotfTsKLQotc3RhdGljIGNvbnN0IHU4IGdlbjExX3Jjc19vZmZzZXRzW10gPSB7
Ci0JTk9QKDEpLAotCUxSSSgxNSwgUE9TVEVEKSwKLQlSRUcxNigweDI0NCksCi0JUkVHKDB4MDM0
KSwKLQlSRUcoMHgwMzApLAotCVJFRygweDAzOCksCi0JUkVHKDB4MDNjKSwKLQlSRUcoMHgxNjgp
LAotCVJFRygweDE0MCksCi0JUkVHKDB4MTEwKSwKLQlSRUcoMHgxMWMpLAotCVJFRygweDExNCks
Ci0JUkVHKDB4MTE4KSwKLQlSRUcoMHgxYzApLAotCVJFRygweDFjNCksCi0JUkVHKDB4MWM4KSwK
LQlSRUcoMHgxODApLAotCi0JTk9QKDEpLAotCUxSSSg5LCBQT1NURUQpLAotCVJFRzE2KDB4M2E4
KSwKLQlSRUcxNigweDI4YyksCi0JUkVHMTYoMHgyODgpLAotCVJFRzE2KDB4Mjg0KSwKLQlSRUcx
NigweDI4MCksCi0JUkVHMTYoMHgyN2MpLAotCVJFRzE2KDB4Mjc4KSwKLQlSRUcxNigweDI3NCks
Ci0JUkVHMTYoMHgyNzApLAotCi0JTFJJKDEsIFBPU1RFRCksCi0JUkVHKDB4MWIwKSwKLQotCU5P
UCgxMCksCi0JTFJJKDEsIDApLAotCVJFRygweDBjOCksCi0KLQlFTkQoODApCi19OwotCi1zdGF0
aWMgY29uc3QgdTggZ2VuMTJfcmNzX29mZnNldHNbXSA9IHsKLQlOT1AoMSksCi0JTFJJKDEzLCBQ
T1NURUQpLAotCVJFRzE2KDB4MjQ0KSwKLQlSRUcoMHgwMzQpLAotCVJFRygweDAzMCksCi0JUkVH
KDB4MDM4KSwKLQlSRUcoMHgwM2MpLAotCVJFRygweDE2OCksCi0JUkVHKDB4MTQwKSwKLQlSRUco
MHgxMTApLAotCVJFRygweDFjMCksCi0JUkVHKDB4MWM0KSwKLQlSRUcoMHgxYzgpLAotCVJFRygw
eDE4MCksCi0JUkVHMTYoMHgyYjQpLAotCi0JTk9QKDUpLAotCUxSSSg5LCBQT1NURUQpLAotCVJF
RzE2KDB4M2E4KSwKLQlSRUcxNigweDI4YyksCi0JUkVHMTYoMHgyODgpLAotCVJFRzE2KDB4Mjg0
KSwKLQlSRUcxNigweDI4MCksCi0JUkVHMTYoMHgyN2MpLAotCVJFRzE2KDB4Mjc4KSwKLQlSRUcx
NigweDI3NCksCi0JUkVHMTYoMHgyNzApLAotCi0JTFJJKDMsIFBPU1RFRCksCi0JUkVHKDB4MWIw
KSwKLQlSRUcxNigweDVhOCksCi0JUkVHMTYoMHg1YWMpLAotCi0JTk9QKDYpLAotCUxSSSgxLCAw
KSwKLQlSRUcoMHgwYzgpLAotCU5PUCgzICsgOSArIDEpLAotCi0JTFJJKDUxLCBQT1NURUQpLAot
CVJFRzE2KDB4NTg4KSwKLQlSRUcxNigweDU4OCksCi0JUkVHMTYoMHg1ODgpLAotCVJFRzE2KDB4
NTg4KSwKLQlSRUcxNigweDU4OCksCi0JUkVHMTYoMHg1ODgpLAotCVJFRygweDAyOCksCi0JUkVH
KDB4MDljKSwKLQlSRUcoMHgwYzApLAotCVJFRygweDE3OCksCi0JUkVHKDB4MTdjKSwKLQlSRUcx
NigweDM1OCksCi0JUkVHKDB4MTcwKSwKLQlSRUcoMHgxNTApLAotCVJFRygweDE1NCksCi0JUkVH
KDB4MTU4KSwKLQlSRUcxNigweDQxYyksCi0JUkVHMTYoMHg2MDApLAotCVJFRzE2KDB4NjA0KSwK
LQlSRUcxNigweDYwOCksCi0JUkVHMTYoMHg2MGMpLAotCVJFRzE2KDB4NjEwKSwKLQlSRUcxNigw
eDYxNCksCi0JUkVHMTYoMHg2MTgpLAotCVJFRzE2KDB4NjFjKSwKLQlSRUcxNigweDYyMCksCi0J
UkVHMTYoMHg2MjQpLAotCVJFRzE2KDB4NjI4KSwKLQlSRUcxNigweDYyYyksCi0JUkVHMTYoMHg2
MzApLAotCVJFRzE2KDB4NjM0KSwKLQlSRUcxNigweDYzOCksCi0JUkVHMTYoMHg2M2MpLAotCVJF
RzE2KDB4NjQwKSwKLQlSRUcxNigweDY0NCksCi0JUkVHMTYoMHg2NDgpLAotCVJFRzE2KDB4NjRj
KSwKLQlSRUcxNigweDY1MCksCi0JUkVHMTYoMHg2NTQpLAotCVJFRzE2KDB4NjU4KSwKLQlSRUcx
NigweDY1YyksCi0JUkVHMTYoMHg2NjApLAotCVJFRzE2KDB4NjY0KSwKLQlSRUcxNigweDY2OCks
Ci0JUkVHMTYoMHg2NmMpLAotCVJFRzE2KDB4NjcwKSwKLQlSRUcxNigweDY3NCksCi0JUkVHMTYo
MHg2NzgpLAotCVJFRzE2KDB4NjdjKSwKLQlSRUcoMHgwNjgpLAotCVJFRygweDA4NCksCi0JTk9Q
KDEpLAotCi0JRU5EKDE5MikKLX07Ci0KLSN1bmRlZiBFTkQKLSN1bmRlZiBSRUcxNgotI3VuZGVm
IFJFRwotI3VuZGVmIExSSQotI3VuZGVmIE5PUAotCi1zdGF0aWMgY29uc3QgdTggKnJlZ19vZmZz
ZXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQkvKgotCSAqIFRo
ZSBnZW4xMisgbGlzdHMgb25seSBoYXZlIHRoZSByZWdpc3RlcnMgd2UgcHJvZ3JhbSBpbiB0aGUg
YmFzaWMKLQkgKiBkZWZhdWx0IHN0YXRlLiBXZSByZWx5IG9uIHRoZSBjb250ZXh0IGltYWdlIHVz
aW5nIHJlbGF0aXZlCi0JICogYWRkcmVzc2luZyB0byBhdXRvbWF0aWMgZml4dXAgdGhlIHJlZ2lz
dGVyIHN0YXRlIGJldHdlZW4gdGhlCi0JICogcGh5c2ljYWwgZW5naW5lcyBmb3IgdmlydHVhbCBl
bmdpbmUuCi0JICovCi0JR0VNX0JVR19PTihJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMiAm
JgotCQkgICAhaW50ZWxfZW5naW5lX2hhc19yZWxhdGl2ZV9tbWlvKGVuZ2luZSkpOwotCi0JaWYg
KGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKSB7Ci0JCWlmIChJTlRFTF9HRU4oZW5naW5l
LT5pOTE1KSA+PSAxMikKLQkJCXJldHVybiBnZW4xMl9yY3Nfb2Zmc2V0czsKLQkJZWxzZSBpZiAo
SU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTEpCi0JCQlyZXR1cm4gZ2VuMTFfcmNzX29mZnNl
dHM7Ci0JCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkpCi0JCQlyZXR1cm4g
Z2VuOV9yY3Nfb2Zmc2V0czsKLQkJZWxzZQotCQkJcmV0dXJuIGdlbjhfcmNzX29mZnNldHM7Ci0J
fSBlbHNlIHsKLQkJaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEyKQotCQkJcmV0dXJu
IGdlbjEyX3hjc19vZmZzZXRzOwotCQllbHNlIGlmIChJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+
PSA5KQotCQkJcmV0dXJuIGdlbjlfeGNzX29mZnNldHM7Ci0JCWVsc2UKLQkJCXJldHVybiBnZW44
X3hjc19vZmZzZXRzOwotCX0KLX0KLQogc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgogX191
bndpbmRfaW5jb21wbGV0ZV9yZXF1ZXN0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUp
CiB7CkBAIC0xMTg3LDU4ICs0OTYsNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmdpbmVfY29udGV4
dF9vdXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCXdyaXRlX3NlcXVubG9ja19p
cnFyZXN0b3JlKCZlbmdpbmUtPnN0YXRzLmxvY2ssIGZsYWdzKTsKIH0KIAotc3RhdGljIHZvaWQK
LWV4ZWNsaXN0c19jaGVja19jb250ZXh0KGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwK
LQkJCWNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCWNvbnN0IGNoYXIg
KndoZW4pCi17Ci0JY29uc3Qgc3RydWN0IGludGVsX3JpbmcgKnJpbmcgPSBjZS0+cmluZzsKLQl1
MzIgKnJlZ3MgPSBjZS0+bHJjX3JlZ19zdGF0ZTsKLQlib29sIHZhbGlkID0gdHJ1ZTsKLQlpbnQg
eDsKLQotCWlmIChyZWdzW0NUWF9SSU5HX1NUQVJUXSAhPSBpOTE1X2dndHRfb2Zmc2V0KHJpbmct
PnZtYSkpIHsKLQkJcHJfZXJyKCIlczogY29udGV4dCBzdWJtaXR0ZWQgd2l0aCBpbmNvcnJlY3Qg
UklOR19TVEFSVCBbJTA4eF0sIGV4cGVjdGVkICUwOHhcbiIsCi0JCSAgICAgICBlbmdpbmUtPm5h
bWUsCi0JCSAgICAgICByZWdzW0NUWF9SSU5HX1NUQVJUXSwKLQkJICAgICAgIGk5MTVfZ2d0dF9v
ZmZzZXQocmluZy0+dm1hKSk7Ci0JCXJlZ3NbQ1RYX1JJTkdfU1RBUlRdID0gaTkxNV9nZ3R0X29m
ZnNldChyaW5nLT52bWEpOwotCQl2YWxpZCA9IGZhbHNlOwotCX0KLQotCWlmICgocmVnc1tDVFhf
UklOR19DVExdICYgfihSSU5HX1dBSVQgfCBSSU5HX1dBSVRfU0VNQVBIT1JFKSkgIT0KLQkgICAg
KFJJTkdfQ1RMX1NJWkUocmluZy0+c2l6ZSkgfCBSSU5HX1ZBTElEKSkgewotCQlwcl9lcnIoIiVz
OiBjb250ZXh0IHN1Ym1pdHRlZCB3aXRoIGluY29ycmVjdCBSSU5HX0NUTCBbJTA4eF0sIGV4cGVj
dGVkICUwOHhcbiIsCi0JCSAgICAgICBlbmdpbmUtPm5hbWUsCi0JCSAgICAgICByZWdzW0NUWF9S
SU5HX0NUTF0sCi0JCSAgICAgICAodTMyKShSSU5HX0NUTF9TSVpFKHJpbmctPnNpemUpIHwgUklO
R19WQUxJRCkpOwotCQlyZWdzW0NUWF9SSU5HX0NUTF0gPSBSSU5HX0NUTF9TSVpFKHJpbmctPnNp
emUpIHwgUklOR19WQUxJRDsKLQkJdmFsaWQgPSBmYWxzZTsKLQl9Ci0KLQl4ID0gbHJjX3Jpbmdf
bWlfbW9kZShlbmdpbmUpOwotCWlmICh4ICE9IC0xICYmIHJlZ3NbeCArIDFdICYgKHJlZ3NbeCAr
IDFdID4+IDE2KSAmIFNUT1BfUklORykgewotCQlwcl9lcnIoIiVzOiBjb250ZXh0IHN1Ym1pdHRl
ZCB3aXRoIFNUT1BfUklORyBbJTA4eF0gaW4gUklOR19NSV9NT0RFXG4iLAotCQkgICAgICAgZW5n
aW5lLT5uYW1lLCByZWdzW3ggKyAxXSk7Ci0JCXJlZ3NbeCArIDFdICY9IH5TVE9QX1JJTkc7Ci0J
CXJlZ3NbeCArIDFdIHw9IFNUT1BfUklORyA8PCAxNjsKLQkJdmFsaWQgPSBmYWxzZTsKLQl9Ci0K
LQlXQVJOX09OQ0UoIXZhbGlkLCAiSW52YWxpZCBscmMgc3RhdGUgZm91bmQgJXMgc3VibWlzc2lv
blxuIiwgd2hlbik7Ci19Ci0KLXN0YXRpYyB2b2lkIHJlc3RvcmVfZGVmYXVsdF9zdGF0ZShzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0JCQkJICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCi17Ci0JdTMyICpyZWdzOwotCi0JcmVncyA9IG1lbXNldChjZS0+bHJjX3JlZ19zdGF0ZSwg
MCwgZW5naW5lLT5jb250ZXh0X3NpemUgLSBQQUdFX1NJWkUpOwotCWV4ZWNsaXN0c19pbml0X3Jl
Z19zdGF0ZShyZWdzLCBjZSwgZW5naW5lLCBjZS0+cmluZywgdHJ1ZSk7Ci0KLQljZS0+cnVudGlt
ZS5sYXN0ID0gaW50ZWxfY29udGV4dF9nZXRfcnVudGltZShjZSk7Ci19Ci0KIHN0YXRpYyB2b2lk
IHJlc2V0X2FjdGl2ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAkJCSBzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCiB7CkBAIC0xMjcxLDExICs1MjgsMTAgQEAgc3RhdGljIHZvaWQg
cmVzZXRfYWN0aXZlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCWhlYWQgPSBpbnRlbF9yaW5n
X3dyYXAoY2UtPnJpbmcsIGhlYWQpOwogCiAJLyogU2NydWIgdGhlIGNvbnRleHQgaW1hZ2UgdG8g
cHJldmVudCByZXBsYXlpbmcgdGhlIHByZXZpb3VzIGJhdGNoICovCi0JcmVzdG9yZV9kZWZhdWx0
X3N0YXRlKGNlLCBlbmdpbmUpOwotCV9fZXhlY2xpc3RzX3VwZGF0ZV9yZWdfc3RhdGUoY2UsIGVu
Z2luZSwgaGVhZCk7CisJbHJjX3Jlc3RvcmVfZGVmYXVsdHMoY2UsIGVuZ2luZSk7CiAKIAkvKiBX
ZSd2ZSBzd2l0Y2hlZCBhd2F5LCBzbyB0aGlzIHNob3VsZCBiZSBhIG5vLW9wLCBidXQgaW50ZW50
IG1hdHRlcnMgKi8KLQljZS0+bHJjLmRlc2MgfD0gQ1RYX0RFU0NfRk9SQ0VfUkVTVE9SRTsKKwlj
ZS0+bHJjLmxyY2EgPSBscmNfdXBkYXRlX3JlZ3MoY2UsIGVuZ2luZSwgaGVhZCk7CiB9CiAKIHN0
YXRpYyB2b2lkIHN0X3VwZGF0ZV9ydW50aW1lX3VuZGVyZmxvdyhzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UsIHMzMiBkdCkKQEAgLTEyOTUsNyArNTUxLDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfY29u
dGV4dF91cGRhdGVfcnVudGltZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCiAJCXJldHVybjsK
IAogCW9sZCA9IGNlLT5ydW50aW1lLmxhc3Q7Ci0JY2UtPnJ1bnRpbWUubGFzdCA9IGludGVsX2Nv
bnRleHRfZ2V0X3J1bnRpbWUoY2UpOworCWNlLT5ydW50aW1lLmxhc3QgPSBscmNfZ2V0X3J1bnRp
bWUoY2UpOwogCWR0ID0gY2UtPnJ1bnRpbWUubGFzdCAtIG9sZDsKIAogCWlmICh1bmxpa2VseShk
dCA8IDApKSB7CkBAIC0xMzIxLDcgKzU3Nyw3IEBAIF9fZXhlY2xpc3RzX3NjaGVkdWxlX2luKHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCQlyZXNldF9hY3RpdmUocnEsIGVuZ2luZSk7CiAKIAlp
ZiAoSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKSkKLQkJZXhlY2xpc3RzX2No
ZWNrX2NvbnRleHQoY2UsIGVuZ2luZSwgImJlZm9yZSIpOworCQlscmNfY2hlY2tfcmVncyhjZSwg
ZW5naW5lLCAiYmVmb3JlIik7CiAKIAlpZiAoY2UtPnRhZykgewogCQkvKiBVc2UgYSBmaXhlZCB0
YWcgZm9yIE9BIGFuZCBmcmllbmRzICovCkBAIC0xMzkzLDcgKzY0OSw3IEBAIF9fZXhlY2xpc3Rz
X3NjaGVkdWxlX291dChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAkgKi8KIAogCWlmIChJU19F
TkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0pKQotCQlleGVjbGlzdHNfY2hlY2tfY29u
dGV4dChjZSwgZW5naW5lLCAiYWZ0ZXIiKTsKKwkJbHJjX2NoZWNrX3JlZ3MoY2UsIGVuZ2luZSwg
ImFmdGVyIik7CiAKIAkvKgogCSAqIElmIHdlIGhhdmUganVzdCBjb21wbGV0ZWQgdGhpcyBjb250
ZXh0LCB0aGUgZW5naW5lIG1heSBub3cgYmUKQEAgLTE3NTIsMTIgKzEwMDgsNiBAQCBzdGF0aWMg
Ym9vbCBjYW5fbWVyZ2VfcnEoY29uc3Qgc3RydWN0IGk5MTVfcmVxdWVzdCAqcHJldiwKIAlyZXR1
cm4gdHJ1ZTsKIH0KIAotc3RhdGljIHZvaWQgdmlydHVhbF91cGRhdGVfcmVnaXN0ZXJfb2Zmc2V0
cyh1MzIgKnJlZ3MsCi0JCQkJCSAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17
Ci0Jc2V0X29mZnNldHMocmVncywgcmVnX29mZnNldHMoZW5naW5lKSwgZW5naW5lLCBmYWxzZSk7
Ci19Ci0KIHN0YXRpYyBib29sIHZpcnR1YWxfbWF0Y2hlcyhjb25zdCBzdHJ1Y3QgdmlydHVhbF9l
bmdpbmUgKnZlLAogCQkJICAgIGNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAogCQkJICAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKQEAgLTE3OTMsOCArMTA0Myw3
IEBAIHN0YXRpYyB2b2lkIHZpcnR1YWxfeGZlcl9jb250ZXh0KHN0cnVjdCB2aXJ0dWFsX2VuZ2lu
ZSAqdmUsCiAKIAlHRU1fQlVHX09OKFJFQURfT05DRSh2ZS0+Y29udGV4dC5pbmZsaWdodCkpOwog
CWlmICghaW50ZWxfZW5naW5lX2hhc19yZWxhdGl2ZV9tbWlvKGVuZ2luZSkpCi0JCXZpcnR1YWxf
dXBkYXRlX3JlZ2lzdGVyX29mZnNldHModmUtPmNvbnRleHQubHJjX3JlZ19zdGF0ZSwKLQkJCQkJ
CWVuZ2luZSk7CisJCWxyY191cGRhdGVfb2Zmc2V0cygmdmUtPmNvbnRleHQsIGVuZ2luZSk7CiAK
IAkvKgogCSAqIE1vdmUgdGhlIGJvdW5kIGVuZ2luZSB0byB0aGUgdG9wIG9mIHRoZSBsaXN0IGZv
cgpAQCAtMzMwNywzNSArMjU1Niw5IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19jb250ZXh0X2Rl
c3Ryb3koc3RydWN0IGtyZWYgKmtyZWYpCiAJaW50ZWxfY29udGV4dF9mcmVlKGNlKTsKIH0KIAot
c3RhdGljIHZvaWQKLXNldF9yZWR6b25lKHZvaWQgKnZhZGRyLCBjb25zdCBzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCi17Ci0JaWYgKCFJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9E
RUJVR19HRU0pKQotCQlyZXR1cm47Ci0KLQl2YWRkciArPSBlbmdpbmUtPmNvbnRleHRfc2l6ZTsK
LQotCW1lbXNldCh2YWRkciwgQ09OVEVYVF9SRURaT05FLCBJOTE1X0dUVF9QQUdFX1NJWkUpOwot
fQotCi1zdGF0aWMgdm9pZAotY2hlY2tfcmVkem9uZShjb25zdCB2b2lkICp2YWRkciwgY29uc3Qg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWlmICghSVNfRU5BQkxFRChDT05G
SUdfRFJNX0k5MTVfREVCVUdfR0VNKSkKLQkJcmV0dXJuOwotCi0JdmFkZHIgKz0gZW5naW5lLT5j
b250ZXh0X3NpemU7Ci0KLQlpZiAobWVtY2hyX2ludih2YWRkciwgQ09OVEVYVF9SRURaT05FLCBJ
OTE1X0dUVF9QQUdFX1NJWkUpKQotCQlkcm1fZXJyX29uY2UoJmVuZ2luZS0+aTkxNS0+ZHJtLAot
CQkJICAgICAiJXMgY29udGV4dCByZWR6b25lIG92ZXJ3cml0dGVuIVxuIiwKLQkJCSAgICAgZW5n
aW5lLT5uYW1lKTsKLX0KLQogc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NvbnRleHRfdW5waW4oc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlKQogewotCWNoZWNrX3JlZHpvbmUoKHZvaWQgKiljZS0+bHJj
X3JlZ19zdGF0ZSAtIExSQ19TVEFURV9PRkZTRVQsCi0JCSAgICAgIGNlLT5lbmdpbmUpOworCWxy
Y19jaGVja19yZWR6b25lKGNlKTsKIH0KIAogc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NvbnRleHRf
cG9zdF91bnBpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCkBAIC0zMzQzLDE2MyArMjU2Niw2
IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19jb250ZXh0X3Bvc3RfdW5waW4oc3RydWN0IGludGVs
X2NvbnRleHQgKmNlKQogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoY2UtPnN0YXRlLT5vYmop
OwogfQogCi1zdGF0aWMgdTMyICoKLWdlbjEyX2VtaXRfdGltZXN0YW1wX3dhKGNvbnN0IHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykKLXsKLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNU
RVJfTUVNX0dFTjggfAotCQlNSV9TUk1fTFJNX0dMT0JBTF9HVFQgfAotCQlNSV9MUklfTFJNX0NT
X01NSU87Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfQ1NfR1BSKDAs
IDApKTsKLQkqY3MrKyA9IGk5MTVfZ2d0dF9vZmZzZXQoY2UtPnN0YXRlKSArIExSQ19TVEFURV9P
RkZTRVQgKwotCQlDVFhfVElNRVNUQU1QICogc2l6ZW9mKHUzMik7Ci0JKmNzKysgPSAwOwotCi0J
KmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX1JFRyB8Ci0JCU1JX0xSUl9TT1VSQ0VfQ1NfTU1JTyB8
Ci0JCU1JX0xSSV9MUk1fQ1NfTU1JTzsKLQkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdF
TjhfUklOR19DU19HUFIoMCwgMCkpOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklO
R19DVFhfVElNRVNUQU1QKDApKTsKLQotCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9SRUcgfAot
CQlNSV9MUlJfU09VUkNFX0NTX01NSU8gfAotCQlNSV9MUklfTFJNX0NTX01NSU87Ci0JKmNzKysg
PSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfQ1NfR1BSKDAsIDApKTsKLQkqY3MrKyA9
IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQ1RYX1RJTUVTVEFNUCgwKSk7Ci0KLQlyZXR1cm4g
Y3M7Ci19Ci0KLXN0YXRpYyB1MzIgKgotZ2VuMTJfZW1pdF9yZXN0b3JlX3NjcmF0Y2goY29uc3Qg
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1MzIgKmNzKQotewotCUdFTV9CVUdfT04obHJjX3Jp
bmdfZ3ByMChjZS0+ZW5naW5lKSA9PSAtMSk7Ci0KLQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJf
TUVNX0dFTjggfAotCQlNSV9TUk1fTFJNX0dMT0JBTF9HVFQgfAotCQlNSV9MUklfTFJNX0NTX01N
SU87Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfQ1NfR1BSKDAsIDAp
KTsKLQkqY3MrKyA9IGk5MTVfZ2d0dF9vZmZzZXQoY2UtPnN0YXRlKSArIExSQ19TVEFURV9PRkZT
RVQgKwotCQkobHJjX3JpbmdfZ3ByMChjZS0+ZW5naW5lKSArIDEpICogc2l6ZW9mKHUzMik7Ci0J
KmNzKysgPSAwOwotCi0JcmV0dXJuIGNzOwotfQotCi1zdGF0aWMgdTMyICoKLWdlbjEyX2VtaXRf
Y21kX2J1Zl93YShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3MpCi17Ci0J
R0VNX0JVR19PTihscmNfcmluZ19jbWRfYnVmX2NjdGwoY2UtPmVuZ2luZSkgPT0gLTEpOwotCi0J
KmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX01FTV9HRU44IHwKLQkJTUlfU1JNX0xSTV9HTE9CQUxf
R1RUIHwKLQkJTUlfTFJJX0xSTV9DU19NTUlPOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoR0VOOF9SSU5HX0NTX0dQUigwLCAwKSk7Ci0JKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KGNl
LT5zdGF0ZSkgKyBMUkNfU1RBVEVfT0ZGU0VUICsKLQkJKGxyY19yaW5nX2NtZF9idWZfY2N0bChj
ZS0+ZW5naW5lKSArIDEpICogc2l6ZW9mKHUzMik7Ci0JKmNzKysgPSAwOwotCi0JKmNzKysgPSBN
SV9MT0FEX1JFR0lTVEVSX1JFRyB8Ci0JCU1JX0xSUl9TT1VSQ0VfQ1NfTU1JTyB8Ci0JCU1JX0xS
SV9MUk1fQ1NfTU1JTzsKLQkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfUklOR19D
U19HUFIoMCwgMCkpOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DTURfQlVG
X0NDVEwoMCkpOwotCi0JcmV0dXJuIGNzOwotfQotCi1zdGF0aWMgdTMyICoKLWdlbjEyX2VtaXRf
aW5kaXJlY3RfY3R4X3Jjcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3Mp
Ci17Ci0JY3MgPSBnZW4xMl9lbWl0X3RpbWVzdGFtcF93YShjZSwgY3MpOwotCWNzID0gZ2VuMTJf
ZW1pdF9jbWRfYnVmX3dhKGNlLCBjcyk7Ci0JY3MgPSBnZW4xMl9lbWl0X3Jlc3RvcmVfc2NyYXRj
aChjZSwgY3MpOwotCi0JcmV0dXJuIGNzOwotfQotCi1zdGF0aWMgdTMyICoKLWdlbjEyX2VtaXRf
aW5kaXJlY3RfY3R4X3hjcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3Mp
Ci17Ci0JY3MgPSBnZW4xMl9lbWl0X3RpbWVzdGFtcF93YShjZSwgY3MpOwotCWNzID0gZ2VuMTJf
ZW1pdF9yZXN0b3JlX3NjcmF0Y2goY2UsIGNzKTsKLQotCXJldHVybiBjczsKLX0KLQotc3RhdGlj
IGlubGluZSB1MzIgY29udGV4dF93YV9iYl9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQotewotCXJldHVybiBQQUdFX1NJWkUgKiBjZS0+d2FfYmJfcGFnZTsKLX0KLQotc3Rh
dGljIHUzMiAqY29udGV4dF9pbmRpcmVjdF9iYihjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UpCi17Ci0Jdm9pZCAqcHRyOwotCi0JR0VNX0JVR19PTighY2UtPndhX2JiX3BhZ2UpOwotCi0J
cHRyID0gY2UtPmxyY19yZWdfc3RhdGU7Ci0JcHRyIC09IExSQ19TVEFURV9PRkZTRVQ7IC8qIGJh
Y2sgdG8gc3RhcnQgb2YgY29udGV4dCBpbWFnZSAqLwotCXB0ciArPSBjb250ZXh0X3dhX2JiX29m
ZnNldChjZSk7Ci0KLQlyZXR1cm4gcHRyOwotfQotCi1zdGF0aWMgdm9pZAotc2V0dXBfaW5kaXJl
Y3RfY3R4X2JiKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKLQkJICAgICAgY29uc3Qg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkgICAgICB1MzIgKigqZW1pdCkoY29u
c3Qgc3RydWN0IGludGVsX2NvbnRleHQgKiwgdTMyICopKQotewotCXUzMiAqIGNvbnN0IHN0YXJ0
ID0gY29udGV4dF9pbmRpcmVjdF9iYihjZSk7Ci0JdTMyICpjczsKLQotCWNzID0gZW1pdChjZSwg
c3RhcnQpOwotCUdFTV9CVUdfT04oY3MgLSBzdGFydCA+IEk5MTVfR1RUX1BBR0VfU0laRSAvIHNp
emVvZigqY3MpKTsKLQl3aGlsZSAoKHVuc2lnbmVkIGxvbmcpY3MgJSBDQUNIRUxJTkVfQllURVMp
Ci0JCSpjcysrID0gTUlfTk9PUDsKLQotCWxyY19yaW5nX3NldHVwX2luZGlyZWN0X2N0eChjZS0+
bHJjX3JlZ19zdGF0ZSwgZW5naW5lLAotCQkJCSAgICBpOTE1X2dndHRfb2Zmc2V0KGNlLT5zdGF0
ZSkgKwotCQkJCSAgICBjb250ZXh0X3dhX2JiX29mZnNldChjZSksCi0JCQkJICAgIChjcyAtIHN0
YXJ0KSAqIHNpemVvZigqY3MpKTsKLX0KLQotc3RhdGljIHZvaWQKLV9fZXhlY2xpc3RzX3VwZGF0
ZV9yZWdfc3RhdGUoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAotCQkJICAgICBjb25z
dCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkgICAgIHUzMiBoZWFkKQotewot
CXN0cnVjdCBpbnRlbF9yaW5nICpyaW5nID0gY2UtPnJpbmc7Ci0JdTMyICpyZWdzID0gY2UtPmxy
Y19yZWdfc3RhdGU7Ci0KLQlHRU1fQlVHX09OKCFpbnRlbF9yaW5nX29mZnNldF92YWxpZChyaW5n
LCBoZWFkKSk7Ci0JR0VNX0JVR19PTighaW50ZWxfcmluZ19vZmZzZXRfdmFsaWQocmluZywgcmlu
Zy0+dGFpbCkpOwotCi0JcmVnc1tDVFhfUklOR19TVEFSVF0gPSBpOTE1X2dndHRfb2Zmc2V0KHJp
bmctPnZtYSk7Ci0JcmVnc1tDVFhfUklOR19IRUFEXSA9IGhlYWQ7Ci0JcmVnc1tDVFhfUklOR19U
QUlMXSA9IHJpbmctPnRhaWw7Ci0JcmVnc1tDVFhfUklOR19DVExdID0gUklOR19DVExfU0laRShy
aW5nLT5zaXplKSB8IFJJTkdfVkFMSUQ7Ci0KLQkvKiBSUENTICovCi0JaWYgKGVuZ2luZS0+Y2xh
c3MgPT0gUkVOREVSX0NMQVNTKSB7Ci0JCXJlZ3NbQ1RYX1JfUFdSX0NMS19TVEFURV0gPQotCQkJ
aW50ZWxfc3NldV9tYWtlX3JwY3MoZW5naW5lLT5ndCwgJmNlLT5zc2V1KTsKLQotCQlpOTE1X29h
X2luaXRfcmVnX3N0YXRlKGNlLCBlbmdpbmUpOwotCX0KLQotCWlmIChjZS0+d2FfYmJfcGFnZSkg
ewotCQl1MzIgKigqZm4pKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcyk7
Ci0KLQkJZm4gPSBnZW4xMl9lbWl0X2luZGlyZWN0X2N0eF94Y3M7Ci0JCWlmIChjZS0+ZW5naW5l
LT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpCi0JCQlmbiA9IGdlbjEyX2VtaXRfaW5kaXJlY3RfY3R4
X3JjczsKLQotCQkvKiBNdXR1YWxseSBleGNsdXNpdmUgd3J0IHRvIGdsb2JhbCBpbmRpcmVjdCBi
YiAqLwotCQlHRU1fQlVHX09OKGVuZ2luZS0+d2FfY3R4LmluZGlyZWN0X2N0eC5zaXplKTsKLQkJ
c2V0dXBfaW5kaXJlY3RfY3R4X2JiKGNlLCBlbmdpbmUsIGZuKTsKLQl9Ci19Ci0KIHN0YXRpYyBp
bnQKIGV4ZWNsaXN0c19jb250ZXh0X3ByZV9waW4oc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAog
CQkJICBzdHJ1Y3QgaTkxNV9nZW1fd3dfY3R4ICp3dywgdm9pZCAqKnZhZGRyKQpAQCAtMzUxOSwx
MCArMjU4NSw4IEBAIF9fZXhlY2xpc3RzX2NvbnRleHRfcGluKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSwKIAkJCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJCXZvaWQgKnZhZGRy
KQogewotCWNlLT5scmMubHJjYSA9IGxyY19kZXNjcmlwdG9yKGNlLCBlbmdpbmUpIHwgQ1RYX0RF
U0NfRk9SQ0VfUkVTVE9SRTsKIAljZS0+bHJjX3JlZ19zdGF0ZSA9IHZhZGRyICsgTFJDX1NUQVRF
X09GRlNFVDsKLQlfX2V4ZWNsaXN0c191cGRhdGVfcmVnX3N0YXRlKGNlLCBlbmdpbmUsIGNlLT5y
aW5nLT50YWlsKTsKLQorCWNlLT5scmMubHJjYSA9IGxyY191cGRhdGVfcmVncyhjZSwgZW5naW5l
LCBjZS0+cmluZy0+dGFpbCk7CiAJcmV0dXJuIDA7CiB9CiAKQEAgLTM1NDQsMTEgKzI2MDgsOCBA
QCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfY29udGV4dF9yZXNldChzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UpCiAJaW50ZWxfcmluZ19yZXNldChjZS0+cmluZywgY2UtPnJpbmctPmVtaXQpOwogCiAJ
LyogU2NydWIgYXdheSB0aGUgZ2FyYmFnZSAqLwotCWV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZShj
ZS0+bHJjX3JlZ19zdGF0ZSwKLQkJCQkgY2UsIGNlLT5lbmdpbmUsIGNlLT5yaW5nLCB0cnVlKTsK
LQlfX2V4ZWNsaXN0c191cGRhdGVfcmVnX3N0YXRlKGNlLCBjZS0+ZW5naW5lLCBjZS0+cmluZy0+
dGFpbCk7Ci0KLQljZS0+bHJjLmRlc2MgfD0gQ1RYX0RFU0NfRk9SQ0VfUkVTVE9SRTsKKwlscmNf
aW5pdF9yZWdzKGNlLCBjZS0+ZW5naW5lLCBjZS0+cmluZywgdHJ1ZSk7CisJY2UtPmxyYy5scmNh
ID0gbHJjX3VwZGF0ZV9yZWdzKGNlLCBjZS0+ZW5naW5lLCBjZS0+cmluZy0+dGFpbCk7CiB9CiAK
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dF9vcHMgZXhlY2xpc3RzX2NvbnRleHRf
b3BzID0gewpAQCAtMzY1MCwzMzAgKzI3MTEsNiBAQCBzdGF0aWMgaW50IGV4ZWNsaXN0c19yZXF1
ZXN0X2FsbG9jKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJlcXVlc3QpCiAJcmV0dXJuIDA7CiB9CiAK
LS8qCi0gKiBJbiB0aGlzIFdBIHdlIG5lZWQgdG8gc2V0IEdFTjhfTDNTUUNSRUc0WzIxOjIxXSBh
bmQgcmVzZXQgaXQgYWZ0ZXIKLSAqIFBJUEVfQ09OVFJPTCBpbnN0cnVjdGlvbi4gVGhpcyBpcyBy
ZXF1aXJlZCBmb3IgdGhlIGZsdXNoIHRvIGhhcHBlbiBjb3JyZWN0bHkKLSAqIGJ1dCB0aGVyZSBp
cyBhIHNsaWdodCBjb21wbGljYXRpb24gYXMgdGhpcyBpcyBhcHBsaWVkIGluIFdBIGJhdGNoIHdo
ZXJlIHRoZQotICogdmFsdWVzIGFyZSBvbmx5IGluaXRpYWxpemVkIG9uY2Ugc28gd2UgY2Fubm90
IHRha2UgcmVnaXN0ZXIgdmFsdWUgYXQgdGhlCi0gKiBiZWdpbm5pbmcgYW5kIHJldXNlIGl0IGZ1
cnRoZXI7IGhlbmNlIHdlIHNhdmUgaXRzIHZhbHVlIHRvIG1lbW9yeSwgdXBsb2FkIGEKLSAqIGNv
bnN0YW50IHZhbHVlIHdpdGggYml0MjEgc2V0IGFuZCB0aGVuIHdlIHJlc3RvcmUgaXQgYmFjayB3
aXRoIHRoZSBzYXZlZCB2YWx1ZS4KLSAqIFRvIHNpbXBsaWZ5IHRoZSBXQSwgYSBjb25zdGFudCB2
YWx1ZSBpcyBmb3JtZWQgYnkgdXNpbmcgdGhlIGRlZmF1bHQgdmFsdWUKLSAqIG9mIHRoaXMgcmVn
aXN0ZXIuIFRoaXMgc2hvdWxkbid0IGJlIGEgcHJvYmxlbSBiZWNhdXNlIHdlIGFyZSBvbmx5IG1v
ZGlmeWluZwotICogaXQgZm9yIGEgc2hvcnQgcGVyaW9kIGFuZCB0aGlzIGJhdGNoIGluIG5vbi1w
cmVtcHRpYmxlLiBXZSBjYW4gb2Zjb3Vyc2UKLSAqIHVzZSBhZGRpdGlvbmFsIGluc3RydWN0aW9u
cyB0aGF0IHJlYWQgdGhlIGFjdHVhbCB2YWx1ZSBvZiB0aGUgcmVnaXN0ZXIKLSAqIGF0IHRoYXQg
dGltZSBhbmQgc2V0IG91ciBiaXQgb2YgaW50ZXJlc3QgYnV0IGl0IG1ha2VzIHRoZSBXQSBjb21w
bGljYXRlZC4KLSAqCi0gKiBUaGlzIFdBIGlzIGFsc28gcmVxdWlyZWQgZm9yIEdlbjkgc28gZXh0
cmFjdGluZyBhcyBhIGZ1bmN0aW9uIGF2b2lkcwotICogY29kZSBkdXBsaWNhdGlvbi4KLSAqLwot
c3RhdGljIHUzMiAqCi1nZW44X2VtaXRfZmx1c2hfY29oZXJlbnRsM193YShzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsIHUzMiAqYmF0Y2gpCi17Ci0JLyogTkIgbm8gb25lIGVsc2UgaXMg
YWxsb3dlZCB0byBzY3JpYmJsZSBvdmVyIHNjcmF0Y2ggKyAyNTYhICovCi0JKmJhdGNoKysgPSBN
SV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1NSTV9MUk1fR0xPQkFMX0dUVDsKLQkqYmF0
Y2grKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfTDNTUUNSRUc0KTsKLQkqYmF0Y2grKyA9
IGludGVsX2d0X3NjcmF0Y2hfb2Zmc2V0KGVuZ2luZS0+Z3QsCi0JCQkJCSAgIElOVEVMX0dUX1ND
UkFUQ0hfRklFTERfQ09IRVJFTlRMM19XQSk7Ci0JKmJhdGNoKysgPSAwOwotCi0JKmJhdGNoKysg
PSBNSV9MT0FEX1JFR0lTVEVSX0lNTSgxKTsKLQkqYmF0Y2grKyA9IGk5MTVfbW1pb19yZWdfb2Zm
c2V0KEdFTjhfTDNTUUNSRUc0KTsKLQkqYmF0Y2grKyA9IDB4NDA0MDAwMDAgfCBHRU44X0xRU0Nf
RkxVU0hfQ09IRVJFTlRfTElORVM7Ci0KLQliYXRjaCA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2wo
YmF0Y2gsCi0JCQkJICAgICAgIFBJUEVfQ09OVFJPTF9DU19TVEFMTCB8Ci0JCQkJICAgICAgIFBJ
UEVfQ09OVFJPTF9EQ19GTFVTSF9FTkFCTEUsCi0JCQkJICAgICAgIDApOwotCi0JKmJhdGNoKysg
PSBNSV9MT0FEX1JFR0lTVEVSX01FTV9HRU44IHwgTUlfU1JNX0xSTV9HTE9CQUxfR1RUOwotCSpi
YXRjaCsrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9MM1NRQ1JFRzQpOwotCSpiYXRjaCsr
ID0gaW50ZWxfZ3Rfc2NyYXRjaF9vZmZzZXQoZW5naW5lLT5ndCwKLQkJCQkJICAgSU5URUxfR1Rf
U0NSQVRDSF9GSUVMRF9DT0hFUkVOVEwzX1dBKTsKLQkqYmF0Y2grKyA9IDA7Ci0KLQlyZXR1cm4g
YmF0Y2g7Ci19Ci0KLS8qCi0gKiBUeXBpY2FsbHkgd2Ugb25seSBoYXZlIG9uZSBpbmRpcmVjdF9j
dHggYW5kIHBlcl9jdHggYmF0Y2ggYnVmZmVyIHdoaWNoIGFyZQotICogaW5pdGlhbGl6ZWQgYXQg
dGhlIGJlZ2lubmluZyBhbmQgc2hhcmVkIGFjcm9zcyBhbGwgY29udGV4dHMgYnV0IHRoaXMgZmll
bGQKLSAqIGhlbHBzIHVzIHRvIGhhdmUgbXVsdGlwbGUgYmF0Y2hlcyBhdCBkaWZmZXJlbnQgb2Zm
c2V0cyBhbmQgc2VsZWN0IHRoZW0gYmFzZWQKLSAqIG9uIGEgY3JpdGVyaWEuIEF0IHRoZSBtb21l
bnQgdGhpcyBiYXRjaCBhbHdheXMgc3RhcnQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgcGFnZQot
ICogYW5kIGF0IHRoaXMgcG9pbnQgd2UgZG9uJ3QgaGF2ZSBtdWx0aXBsZSB3YV9jdHggYmF0Y2gg
YnVmZmVycy4KLSAqCi0gKiBUaGUgbnVtYmVyIG9mIFdBIGFwcGxpZWQgYXJlIG5vdCBrbm93biBh
dCB0aGUgYmVnaW5uaW5nOyB3ZSB1c2UgdGhpcyBmaWVsZAotICogdG8gcmV0dXJuIHRoZSBubyBv
ZiBEV09SRFMgd3JpdHRlbi4KLSAqCi0gKiBJdCBpcyB0byBiZSBub3RlZCB0aGF0IHRoaXMgYmF0
Y2ggZG9lcyBub3QgY29udGFpbiBNSV9CQVRDSF9CVUZGRVJfRU5ECi0gKiBzbyBpdCBhZGRzIE5P
T1BzIGFzIHBhZGRpbmcgdG8gbWFrZSBpdCBjYWNoZWxpbmUgYWxpZ25lZC4KLSAqIE1JX0JBVENI
X0JVRkZFUl9FTkQgd2lsbCBiZSBhZGRlZCB0byBwZXJjdHggYmF0Y2ggYW5kIGJvdGggb2YgdGhl
bSB0b2dldGhlcgotICogbWFrZXMgYSBjb21wbGV0ZSBiYXRjaCBidWZmZXIuCi0gKi8KLXN0YXRp
YyB1MzIgKmdlbjhfaW5pdF9pbmRpcmVjdGN0eF9iYihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsIHUzMiAqYmF0Y2gpCi17Ci0JLyogV2FEaXNhYmxlQ3R4UmVzdG9yZUFyYml0cmF0aW9u
OmJkdyxjaHYgKi8KLQkqYmF0Y2grKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRElTQUJMRTsK
LQotCS8qIFdhRmx1c2hDb2hlcmVudEwzQ2FjaGVMaW5lc0F0Q29udGV4dFN3aXRjaDpiZHcgKi8K
LQlpZiAoSVNfQlJPQURXRUxMKGVuZ2luZS0+aTkxNSkpCi0JCWJhdGNoID0gZ2VuOF9lbWl0X2Zs
dXNoX2NvaGVyZW50bDNfd2EoZW5naW5lLCBiYXRjaCk7Ci0KLQkvKiBXYUNsZWFyU2xtU3BhY2VB
dENvbnRleHRTd2l0Y2g6YmR3LGNodiAqLwotCS8qIEFjdHVhbCBzY3JhdGNoIGxvY2F0aW9uIGlz
IGF0IDEyOCBieXRlcyBvZmZzZXQgKi8KLQliYXRjaCA9IGdlbjhfZW1pdF9waXBlX2NvbnRyb2wo
YmF0Y2gsCi0JCQkJICAgICAgIFBJUEVfQ09OVFJPTF9GTFVTSF9MMyB8Ci0JCQkJICAgICAgIFBJ
UEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVYIHwKLQkJCQkgICAgICAgUElQRV9DT05UUk9MX0NT
X1NUQUxMIHwKLQkJCQkgICAgICAgUElQRV9DT05UUk9MX1FXX1dSSVRFLAotCQkJCSAgICAgICBM
UkNfUFBIV1NQX1NDUkFUQ0hfQUREUik7Ci0KLQkqYmF0Y2grKyA9IE1JX0FSQl9PTl9PRkYgfCBN
SV9BUkJfRU5BQkxFOwotCi0JLyogUGFkIHRvIGVuZCBvZiBjYWNoZWxpbmUgKi8KLQl3aGlsZSAo
KHVuc2lnbmVkIGxvbmcpYmF0Y2ggJSBDQUNIRUxJTkVfQllURVMpCi0JCSpiYXRjaCsrID0gTUlf
Tk9PUDsKLQotCS8qCi0JICogTUlfQkFUQ0hfQlVGRkVSX0VORCBpcyBub3QgcmVxdWlyZWQgaW4g
SW5kaXJlY3QgY3R4IEJCIGJlY2F1c2UKLQkgKiBleGVjdXRpb24gZGVwZW5kcyBvbiB0aGUgbGVu
Z3RoIHNwZWNpZmllZCBpbiB0ZXJtcyBvZiBjYWNoZSBsaW5lcwotCSAqIGluIHRoZSByZWdpc3Rl
ciBDVFhfUkNTX0lORElSRUNUX0NUWAotCSAqLwotCi0JcmV0dXJuIGJhdGNoOwotfQotCi1zdHJ1
Y3QgbHJpIHsKLQlpOTE1X3JlZ190IHJlZzsKLQl1MzIgdmFsdWU7Ci19OwotCi1zdGF0aWMgdTMy
ICplbWl0X2xyaSh1MzIgKmJhdGNoLCBjb25zdCBzdHJ1Y3QgbHJpICpscmksIHVuc2lnbmVkIGlu
dCBjb3VudCkKLXsKLQlHRU1fQlVHX09OKCFjb3VudCB8fCBjb3VudCA+IDYzKTsKLQotCSpiYXRj
aCsrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oY291bnQpOwotCWRvIHsKLQkJKmJhdGNoKysgPSBp
OTE1X21taW9fcmVnX29mZnNldChscmktPnJlZyk7Ci0JCSpiYXRjaCsrID0gbHJpLT52YWx1ZTsK
LQl9IHdoaWxlIChscmkrKywgLS1jb3VudCk7Ci0JKmJhdGNoKysgPSBNSV9OT09QOwotCi0JcmV0
dXJuIGJhdGNoOwotfQotCi1zdGF0aWMgdTMyICpnZW45X2luaXRfaW5kaXJlY3RjdHhfYmIoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQotewotCXN0YXRpYyBjb25z
dCBzdHJ1Y3QgbHJpIGxyaVtdID0gewotCQkvKiBXYURpc2FibGVHYXRoZXJBdFNldFNoYWRlckNv
bW1vblNsaWNlOnNrbCxieHQsa2JsLGdsayAqLwotCQl7Ci0JCQlDT01NT05fU0xJQ0VfQ0hJQ0tF
TjIsCi0JCQlfX01BU0tFRF9GSUVMRChHRU45X0RJU0FCTEVfR0FUSEVSX0FUX1NFVF9TSEFERVJf
Q09NTU9OX1NMSUNFLAotCQkJCSAgICAgICAwKSwKLQkJfSwKLQotCQkvKiBCU3BlYzogMTEzOTEg
Ki8KLQkJewotCQkJRkZfU0xJQ0VfQ0hJQ0tFTiwKLQkJCV9fTUFTS0VEX0ZJRUxEKEZGX1NMSUNF
X0NISUNLRU5fQ0xfUFJPVk9LSU5HX1ZFUlRFWF9GSVgsCi0JCQkJICAgICAgIEZGX1NMSUNFX0NI
SUNLRU5fQ0xfUFJPVk9LSU5HX1ZFUlRFWF9GSVgpLAotCQl9LAotCi0JCS8qIEJTcGVjOiAxMTI5
OSAqLwotCQl7Ci0JCQlfM0RfQ0hJQ0tFTjMsCi0JCQlfX01BU0tFRF9GSUVMRChfM0RfQ0hJQ0tF
Tl9TRl9QUk9WT0tJTkdfVkVSVEVYX0ZJWCwKLQkJCQkgICAgICAgXzNEX0NISUNLRU5fU0ZfUFJP
Vk9LSU5HX1ZFUlRFWF9GSVgpLAotCQl9Ci0JfTsKLQotCSpiYXRjaCsrID0gTUlfQVJCX09OX09G
RiB8IE1JX0FSQl9ESVNBQkxFOwotCi0JLyogV2FGbHVzaENvaGVyZW50TDNDYWNoZUxpbmVzQXRD
b250ZXh0U3dpdGNoOnNrbCxieHQsZ2xrICovCi0JYmF0Y2ggPSBnZW44X2VtaXRfZmx1c2hfY29o
ZXJlbnRsM193YShlbmdpbmUsIGJhdGNoKTsKLQotCS8qIFdhQ2xlYXJTbG1TcGFjZUF0Q29udGV4
dFN3aXRjaDpza2wsYnh0LGtibCxnbGssY2ZsICovCi0JYmF0Y2ggPSBnZW44X2VtaXRfcGlwZV9j
b250cm9sKGJhdGNoLAotCQkJCSAgICAgICBQSVBFX0NPTlRST0xfRkxVU0hfTDMgfAotCQkJCSAg
ICAgICBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWCB8Ci0JCQkJICAgICAgIFBJUEVfQ09O
VFJPTF9DU19TVEFMTCB8Ci0JCQkJICAgICAgIFBJUEVfQ09OVFJPTF9RV19XUklURSwKLQkJCQkg
ICAgICAgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOwotCi0JYmF0Y2ggPSBlbWl0X2xyaShiYXRj
aCwgbHJpLCBBUlJBWV9TSVpFKGxyaSkpOwotCi0JLyogV2FNZWRpYVBvb2xTdGF0ZUNtZEluV0FC
QjpieHQsZ2xrICovCi0JaWYgKEhBU19QT09MRURfRVUoZW5naW5lLT5pOTE1KSkgewotCQkvKgot
CQkgKiBFVSBwb29sIGNvbmZpZ3VyYXRpb24gaXMgc2V0dXAgYWxvbmcgd2l0aCBnb2xkZW4gY29u
dGV4dAotCQkgKiBkdXJpbmcgY29udGV4dCBpbml0aWFsaXphdGlvbi4gVGhpcyB2YWx1ZSBkZXBl
bmRzIG9uCi0JCSAqIGRldmljZSB0eXBlICgyeDYgb3IgM3g2KSBhbmQgbmVlZHMgdG8gYmUgdXBk
YXRlZCBiYXNlZAotCQkgKiBvbiB3aGljaCBzdWJzbGljZSBpcyBkaXNhYmxlZCBlc3BlY2lhbGx5
IGZvciAyeDYKLQkJICogZGV2aWNlcywgaG93ZXZlciBpdCBpcyBzYWZlIHRvIGxvYWQgZGVmYXVs
dAotCQkgKiBjb25maWd1cmF0aW9uIG9mIDN4NiBkZXZpY2UgaW5zdGVhZCBvZiBtYXNraW5nIG9m
ZgotCQkgKiBjb3JyZXNwb25kaW5nIGJpdHMgYmVjYXVzZSBIVyBpZ25vcmVzIGJpdHMgb2YgYSBk
aXNhYmxlZAotCQkgKiBzdWJzbGljZSBhbmQgZHJvcHMgZG93biB0byBhcHByb3ByaWF0ZSBjb25m
aWcuIFBsZWFzZQotCQkgKiBzZWUgcmVuZGVyX3N0YXRlX3NldHVwKCkgaW4gaTkxNV9nZW1fcmVu
ZGVyX3N0YXRlLmMgZm9yCi0JCSAqIHBvc3NpYmxlIGNvbmZpZ3VyYXRpb25zLCB0byBhdm9pZCBk
dXBsaWNhdGlvbiB0aGV5IGFyZQotCQkgKiBub3Qgc2hvd24gaGVyZSBhZ2Fpbi4KLQkJICovCi0J
CSpiYXRjaCsrID0gR0VOOV9NRURJQV9QT09MX1NUQVRFOwotCQkqYmF0Y2grKyA9IEdFTjlfTUVE
SUFfUE9PTF9FTkFCTEU7Ci0JCSpiYXRjaCsrID0gMHgwMDc3NzAwMDsKLQkJKmJhdGNoKysgPSAw
OwotCQkqYmF0Y2grKyA9IDA7Ci0JCSpiYXRjaCsrID0gMDsKLQl9Ci0KLQkqYmF0Y2grKyA9IE1J
X0FSQl9PTl9PRkYgfCBNSV9BUkJfRU5BQkxFOwotCi0JLyogUGFkIHRvIGVuZCBvZiBjYWNoZWxp
bmUgKi8KLQl3aGlsZSAoKHVuc2lnbmVkIGxvbmcpYmF0Y2ggJSBDQUNIRUxJTkVfQllURVMpCi0J
CSpiYXRjaCsrID0gTUlfTk9PUDsKLQotCXJldHVybiBiYXRjaDsKLX0KLQotc3RhdGljIHUzMiAq
Ci1nZW4xMF9pbml0X2luZGlyZWN0Y3R4X2JiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSwgdTMyICpiYXRjaCkKLXsKLQlpbnQgaTsKLQotCS8qCi0JICogV2FQaXBlQ29udHJvbEJlZm9y
ZTNEU3RhdGVTYW1wbGVQYXR0ZXJuOiBjbmwKLQkgKgotCSAqIEVuc3VyZSB0aGUgZW5naW5lIGlz
IGlkbGUgcHJpb3IgdG8gcHJvZ3JhbW1pbmcgYQotCSAqIDNEU1RBVEVfU0FNUExFX1BBVFRFUk4g
ZHVyaW5nIGEgY29udGV4dCByZXN0b3JlLgotCSAqLwotCWJhdGNoID0gZ2VuOF9lbWl0X3BpcGVf
Y29udHJvbChiYXRjaCwKLQkJCQkgICAgICAgUElQRV9DT05UUk9MX0NTX1NUQUxMLAotCQkJCSAg
ICAgICAwKTsKLQkvKgotCSAqIFdhUGlwZUNvbnRyb2xCZWZvcmUzRFN0YXRlU2FtcGxlUGF0dGVy
biBzYXlzIHdlIG5lZWQgNCBkd29yZHMgZm9yCi0JICogdGhlIFBJUEVfQ09OVFJPTCBmb2xsb3dl
ZCBieSAxMiBkd29yZHMgb2YgMHgwLCBzbyAxNiBkd29yZHMgaW4KLQkgKiB0b3RhbC4gSG93ZXZl
ciwgYSBQSVBFX0NPTlRST0wgaXMgNiBkd29yZHMgbG9uZywgbm90IDQsIHdoaWNoIGlzCi0JICog
Y29uZnVzaW5nLiBTaW5jZSBnZW44X2VtaXRfcGlwZV9jb250cm9sKCkgYWxyZWFkeSBhZHZhbmNl
cyB0aGUKLQkgKiBiYXRjaCBieSA2IGR3b3Jkcywgd2UgYWR2YW5jZSB0aGUgb3RoZXIgMTAgaGVy
ZSwgY29tcGxldGluZyBhCi0JICogY2FjaGVsaW5lLiBJdCdzIG5vdCBjbGVhciBpZiB0aGUgd29y
a2Fyb3VuZCByZXF1aXJlcyB0aGlzIHBhZGRpbmcKLQkgKiBiZWZvcmUgb3RoZXIgY29tbWFuZHMs
IG9yIGlmIGl0J3MganVzdCB0aGUgcmVndWxhciBwYWRkaW5nIHdlIHdvdWxkCi0JICogYWxyZWFk
eSBoYXZlIGZvciB0aGUgd29ya2Fyb3VuZCBiYiwgc28gbGVhdmUgaXQgaGVyZSBmb3Igbm93Lgot
CSAqLwotCWZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKQotCQkqYmF0Y2grKyA9IE1JX05PT1A7Ci0K
LQkvKiBQYWQgdG8gZW5kIG9mIGNhY2hlbGluZSAqLwotCXdoaWxlICgodW5zaWduZWQgbG9uZyli
YXRjaCAlIENBQ0hFTElORV9CWVRFUykKLQkJKmJhdGNoKysgPSBNSV9OT09QOwotCi0JcmV0dXJu
IGJhdGNoOwotfQotCi0jZGVmaW5lIENUWF9XQV9CQl9PQkpfU0laRSAoUEFHRV9TSVpFKQotCi1z
dGF0aWMgaW50IGxyY19zZXR1cF93YV9jdHgoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQotewotCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Ci0Jc3RydWN0IGk5MTVfdm1h
ICp2bWE7Ci0JaW50IGVycjsKLQotCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc2htZW0o
ZW5naW5lLT5pOTE1LCBDVFhfV0FfQkJfT0JKX1NJWkUpOwotCWlmIChJU19FUlIob2JqKSkKLQkJ
cmV0dXJuIFBUUl9FUlIob2JqKTsKLQotCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgJmVu
Z2luZS0+Z3QtPmdndHQtPnZtLCBOVUxMKTsKLQlpZiAoSVNfRVJSKHZtYSkpIHsKLQkJZXJyID0g
UFRSX0VSUih2bWEpOwotCQlnb3RvIGVycjsKLQl9Ci0KLQllcnIgPSBpOTE1X2dndHRfcGluKHZt
YSwgTlVMTCwgMCwgUElOX0hJR0gpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyOwotCi0JZW5naW5l
LT53YV9jdHgudm1hID0gdm1hOwotCXJldHVybiAwOwotCi1lcnI6Ci0JaTkxNV9nZW1fb2JqZWN0
X3B1dChvYmopOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyB2b2lkIGxyY19kZXN0cm95X3dh
X2N0eChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0JaTkxNV92bWFfdW5waW5f
YW5kX3JlbGVhc2UoJmVuZ2luZS0+d2FfY3R4LnZtYSwgMCk7Ci19Ci0KLXR5cGVkZWYgdTMyICoo
KndhX2JiX2Z1bmNfdCkoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNo
KTsKLQotc3RhdGljIGludCBpbnRlbF9pbml0X3dvcmthcm91bmRfYmIoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQotewotCXN0cnVjdCBpOTE1X2N0eF93b3JrYXJvdW5kcyAqd2FfY3R4
ID0gJmVuZ2luZS0+d2FfY3R4OwotCXN0cnVjdCBpOTE1X3dhX2N0eF9iYiAqd2FfYmJbMl0gPSB7
ICZ3YV9jdHgtPmluZGlyZWN0X2N0eCwKLQkJCQkJICAgICZ3YV9jdHgtPnBlcl9jdHggfTsKLQl3
YV9iYl9mdW5jX3Qgd2FfYmJfZm5bMl07Ci0Jdm9pZCAqYmF0Y2gsICpiYXRjaF9wdHI7Ci0JdW5z
aWduZWQgaW50IGk7Ci0JaW50IHJldDsKLQotCWlmIChlbmdpbmUtPmNsYXNzICE9IFJFTkRFUl9D
TEFTUykKLQkJcmV0dXJuIDA7Ci0KLQlzd2l0Y2ggKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpKSB7
Ci0JY2FzZSAxMjoKLQljYXNlIDExOgotCQlyZXR1cm4gMDsKLQljYXNlIDEwOgotCQl3YV9iYl9m
blswXSA9IGdlbjEwX2luaXRfaW5kaXJlY3RjdHhfYmI7Ci0JCXdhX2JiX2ZuWzFdID0gTlVMTDsK
LQkJYnJlYWs7Ci0JY2FzZSA5OgotCQl3YV9iYl9mblswXSA9IGdlbjlfaW5pdF9pbmRpcmVjdGN0
eF9iYjsKLQkJd2FfYmJfZm5bMV0gPSBOVUxMOwotCQlicmVhazsKLQljYXNlIDg6Ci0JCXdhX2Ji
X2ZuWzBdID0gZ2VuOF9pbml0X2luZGlyZWN0Y3R4X2JiOwotCQl3YV9iYl9mblsxXSA9IE5VTEw7
Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCU1JU1NJTkdfQ0FTRShJTlRFTF9HRU4oZW5naW5lLT5p
OTE1KSk7Ci0JCXJldHVybiAwOwotCX0KLQotCXJldCA9IGxyY19zZXR1cF93YV9jdHgoZW5naW5l
KTsKLQlpZiAocmV0KSB7Ci0JCWRybV9kYmcoJmVuZ2luZS0+aTkxNS0+ZHJtLAotCQkJIkZhaWxl
ZCB0byBzZXR1cCBjb250ZXh0IFdBIHBhZ2U6ICVkXG4iLCByZXQpOwotCQlyZXR1cm4gcmV0Owot
CX0KLQotCWJhdGNoID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAod2FfY3R4LT52bWEtPm9iaiwg
STkxNV9NQVBfV0IpOwotCi0JLyoKLQkgKiBFbWl0IHRoZSB0d28gd29ya2Fyb3VuZCBiYXRjaCBi
dWZmZXJzLCByZWNvcmRpbmcgdGhlIG9mZnNldCBmcm9tIHRoZQotCSAqIHN0YXJ0IG9mIHRoZSB3
b3JrYXJvdW5kIGJhdGNoIGJ1ZmZlciBvYmplY3QgZm9yIGVhY2ggYW5kIHRoZWlyCi0JICogcmVz
cGVjdGl2ZSBzaXplcy4KLQkgKi8KLQliYXRjaF9wdHIgPSBiYXRjaDsKLQlmb3IgKGkgPSAwOyBp
IDwgQVJSQVlfU0laRSh3YV9iYl9mbik7IGkrKykgewotCQl3YV9iYltpXS0+b2Zmc2V0ID0gYmF0
Y2hfcHRyIC0gYmF0Y2g7Ci0JCWlmIChHRU1fREVCVUdfV0FSTl9PTighSVNfQUxJR05FRCh3YV9i
YltpXS0+b2Zmc2V0LAotCQkJCQkJICBDQUNIRUxJTkVfQllURVMpKSkgewotCQkJcmV0ID0gLUVJ
TlZBTDsKLQkJCWJyZWFrOwotCQl9Ci0JCWlmICh3YV9iYl9mbltpXSkKLQkJCWJhdGNoX3B0ciA9
IHdhX2JiX2ZuW2ldKGVuZ2luZSwgYmF0Y2hfcHRyKTsKLQkJd2FfYmJbaV0tPnNpemUgPSBiYXRj
aF9wdHIgLSAoYmF0Y2ggKyB3YV9iYltpXS0+b2Zmc2V0KTsKLQl9Ci0JR0VNX0JVR19PTihiYXRj
aF9wdHIgLSBiYXRjaCA+IENUWF9XQV9CQl9PQkpfU0laRSk7Ci0KLQlfX2k5MTVfZ2VtX29iamVj
dF9mbHVzaF9tYXAod2FfY3R4LT52bWEtPm9iaiwgMCwgYmF0Y2hfcHRyIC0gYmF0Y2gpOwotCV9f
aTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbWFwKHdhX2N0eC0+dm1hLT5vYmopOwotCWlmIChyZXQp
Ci0JCWxyY19kZXN0cm95X3dhX2N0eChlbmdpbmUpOwotCi0JcmV0dXJuIHJldDsKLX0KLQogc3Rh
dGljIHZvaWQgcmVzZXRfY3NiX3BvaW50ZXJzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0cyA9
ICZlbmdpbmUtPmV4ZWNsaXN0czsKQEAgLTQxODUsMjUgKzI5MjIsNiBAQCBzdGF0aWMgdm9pZCBl
eGVjbGlzdHNfcmVzZXRfcHJlcGFyZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJ
ZW5naW5lLT5leGVjbGlzdHMucmVzZXRfY2NpZCA9IGFjdGl2ZV9jY2lkKGVuZ2luZSk7CiB9CiAK
LXN0YXRpYyB2b2lkIF9fcmVzZXRfc3RvcF9yaW5nKHUzMiAqcmVncywgY29uc3Qgc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWludCB4OwotCi0JeCA9IGxyY19yaW5nX21pX21v
ZGUoZW5naW5lKTsKLQlpZiAoeCAhPSAtMSkgewotCQlyZWdzW3ggKyAxXSAmPSB+U1RPUF9SSU5H
OwotCQlyZWdzW3ggKyAxXSB8PSBTVE9QX1JJTkcgPDwgMTY7Ci0JfQotfQotCi1zdGF0aWMgdm9p
ZCBfX2V4ZWNsaXN0c19yZXNldF9yZWdfc3RhdGUoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQg
KmNlLAotCQkJCQljb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCi17Ci0JdTMy
ICpyZWdzID0gY2UtPmxyY19yZWdfc3RhdGU7Ci0KLQlfX3Jlc2V0X3N0b3BfcmluZyhyZWdzLCBl
bmdpbmUpOwotfQotCiBzdGF0aWMgdm9pZCBfX2V4ZWNsaXN0c19yZXNldChzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUsIGJvb2wgc3RhbGxlZCkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0cyA9ICZlbmdpbmUtPmV4ZWNsaXN0czsKQEAgLTQy
ODcsOSArMzAwNSw4IEBAIHN0YXRpYyB2b2lkIF9fZXhlY2xpc3RzX3Jlc2V0KHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSwgYm9vbCBzdGFsbGVkKQogb3V0X3JlcGxheToKIAlFTkdJTkVf
VFJBQ0UoZW5naW5lLCAicmVwbGF5IHtoZWFkOiUwNHgsIHRhaWw6JTA0eH1cbiIsCiAJCSAgICAg
aGVhZCwgY2UtPnJpbmctPnRhaWwpOwotCV9fZXhlY2xpc3RzX3Jlc2V0X3JlZ19zdGF0ZShjZSwg
ZW5naW5lKTsKLQlfX2V4ZWNsaXN0c191cGRhdGVfcmVnX3N0YXRlKGNlLCBlbmdpbmUsIGhlYWQp
OwotCWNlLT5scmMuZGVzYyB8PSBDVFhfREVTQ19GT1JDRV9SRVNUT1JFOyAvKiBwYXJhbm9pZDog
R1BVIHdhcyByZXNldCEgKi8KKwlscmNfcmVzZXRfcmVncyhjZSwgZW5naW5lKTsKKwljZS0+bHJj
LmxyY2EgPSBscmNfdXBkYXRlX3JlZ3MoY2UsIGVuZ2luZSwgaGVhZCk7CiAKIHVud2luZDoKIAkv
KiBQdXNoIGJhY2sgYW55IGluY29tcGxldGUgcmVxdWVzdHMgZm9yIHJlcGxheSBhZnRlciB0aGUg
cmVzZXQuICovCkBAIC00NDg3LDcgKzMyMDQsNyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfcmVs
ZWFzZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJZXhlY2xpc3RzX3NodXRkb3du
KGVuZ2luZSk7CiAKIAlpbnRlbF9lbmdpbmVfY2xlYW51cF9jb21tb24oZW5naW5lKTsKLQlscmNf
ZGVzdHJveV93YV9jdHgoZW5naW5lKTsKKwlscmNfZmluaV93YV9jdHgoZW5naW5lKTsKIH0KIAog
c3RhdGljIHZvaWQKQEAgLTQ1ODEsNyArMzI5OCw3IEBAIGludCBpbnRlbF9leGVjbGlzdHNfc3Vi
bWlzc2lvbl9zZXR1cChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJaWYgKGVuZ2lu
ZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKQogCQlyY3Nfc3VibWlzc2lvbl9vdmVycmlkZShlbmdp
bmUpOwogCi0JaWYgKGludGVsX2luaXRfd29ya2Fyb3VuZF9iYihlbmdpbmUpKQorCWlmIChscmNf
aW5pdF93YV9jdHgoZW5naW5lKSkKIAkJLyoKIAkJICogV2UgY29udGludWUgZXZlbiBpZiB3ZSBm
YWlsIHRvIGluaXRpYWxpemUgV0EgYmF0Y2gKIAkJICogYmVjYXVzZSB3ZSBvbmx5IGV4cGVjdCBy
YXJlIGdsaXRjaGVzIGJ1dCBub3RoaW5nCkBAIC00NjIyLDEzNiArMzMzOSw2IEBAIGludCBpbnRl
bF9leGVjbGlzdHNfc3VibWlzc2lvbl9zZXR1cChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdp
bmUpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyB2b2lkIGluaXRfY29tbW9uX3JlZ19zdGF0ZSh1
MzIgKiBjb25zdCByZWdzLAotCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lLAotCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX3JpbmcgKnJpbmcsCi0JCQkJICBib29sIGlu
aGliaXQpCi17Ci0JdTMyIGN0bDsKLQotCWN0bCA9IF9NQVNLRURfQklUX0VOQUJMRShDVFhfQ1RS
TF9JTkhJQklUX1NZTl9DVFhfU1dJVENIKTsKLQljdGwgfD0gX01BU0tFRF9CSVRfRElTQUJMRShD
VFhfQ1RSTF9FTkdJTkVfQ1RYX1JFU1RPUkVfSU5ISUJJVCk7Ci0JaWYgKGluaGliaXQpCi0JCWN0
bCB8PSBDVFhfQ1RSTF9FTkdJTkVfQ1RYX1JFU1RPUkVfSU5ISUJJVDsKLQlpZiAoSU5URUxfR0VO
KGVuZ2luZS0+aTkxNSkgPCAxMSkKLQkJY3RsIHw9IF9NQVNLRURfQklUX0RJU0FCTEUoQ1RYX0NU
UkxfRU5HSU5FX0NUWF9TQVZFX0lOSElCSVQgfAotCQkJCQkgICBDVFhfQ1RSTF9SU19DVFhfRU5B
QkxFKTsKLQlyZWdzW0NUWF9DT05URVhUX0NPTlRST0xdID0gY3RsOwotCi0JcmVnc1tDVFhfUklO
R19DVExdID0gUklOR19DVExfU0laRShyaW5nLT5zaXplKSB8IFJJTkdfVkFMSUQ7Ci0JcmVnc1tD
VFhfVElNRVNUQU1QXSA9IDA7Ci19Ci0KLXN0YXRpYyB2b2lkIGluaXRfd2FfYmJfcmVnX3N0YXRl
KHUzMiAqIGNvbnN0IHJlZ3MsCi0JCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKLXsKLQljb25zdCBzdHJ1Y3QgaTkxNV9jdHhfd29ya2Fyb3VuZHMgKiBjb25zdCB3YV9j
dHggPSAmZW5naW5lLT53YV9jdHg7Ci0KLQlpZiAod2FfY3R4LT5wZXJfY3R4LnNpemUpIHsKLQkJ
Y29uc3QgdTMyIGdndHRfb2Zmc2V0ID0gaTkxNV9nZ3R0X29mZnNldCh3YV9jdHgtPnZtYSk7Ci0K
LQkJR0VNX0JVR19PTihscmNfcmluZ193YV9iYl9wZXJfY3R4KGVuZ2luZSkgPT0gLTEpOwotCQly
ZWdzW2xyY19yaW5nX3dhX2JiX3Blcl9jdHgoZW5naW5lKSArIDFdID0KLQkJCShnZ3R0X29mZnNl
dCArIHdhX2N0eC0+cGVyX2N0eC5vZmZzZXQpIHwgMHgwMTsKLQl9Ci0KLQlpZiAod2FfY3R4LT5p
bmRpcmVjdF9jdHguc2l6ZSkgewotCQlscmNfcmluZ19zZXR1cF9pbmRpcmVjdF9jdHgocmVncywg
ZW5naW5lLAotCQkJCQkgICAgaTkxNV9nZ3R0X29mZnNldCh3YV9jdHgtPnZtYSkgKwotCQkJCQkg
ICAgd2FfY3R4LT5pbmRpcmVjdF9jdHgub2Zmc2V0LAotCQkJCQkgICAgd2FfY3R4LT5pbmRpcmVj
dF9jdHguc2l6ZSk7Ci0JfQotfQotCi1zdGF0aWMgdm9pZCBpbml0X3BwZ3R0X3JlZ19zdGF0ZSh1
MzIgKnJlZ3MsIGNvbnN0IHN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCkKLXsKLQlpZiAoaTkxNV92
bV9pc180bHZsKCZwcGd0dC0+dm0pKSB7Ci0JCS8qIDY0YiBQUEdUVCAoNDhiaXQgY2Fub25pY2Fs
KQotCQkgKiBQRFAwX0RFU0NSSVBUT1IgY29udGFpbnMgdGhlIGJhc2UgYWRkcmVzcyB0byBQTUw0
IGFuZAotCQkgKiBvdGhlciBQRFAgRGVzY3JpcHRvcnMgYXJlIGlnbm9yZWQuCi0JCSAqLwotCQlB
U1NJR05fQ1RYX1BNTDQocHBndHQsIHJlZ3MpOwotCX0gZWxzZSB7Ci0JCUFTU0lHTl9DVFhfUERQ
KHBwZ3R0LCByZWdzLCAzKTsKLQkJQVNTSUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDIpOwotCQlB
U1NJR05fQ1RYX1BEUChwcGd0dCwgcmVncywgMSk7Ci0JCUFTU0lHTl9DVFhfUERQKHBwZ3R0LCBy
ZWdzLCAwKTsKLQl9Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgaTkxNV9wcGd0dCAqdm1fYWxpYXMoc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCi17Ci0JaWYgKGk5MTVfaXNfZ2d0dCh2bSkpCi0J
CXJldHVybiBpOTE1X3ZtX3RvX2dndHQodm0pLT5hbGlhczsKLQllbHNlCi0JCXJldHVybiBpOTE1
X3ZtX3RvX3BwZ3R0KHZtKTsKLX0KLQotc3RhdGljIHZvaWQgZXhlY2xpc3RzX2luaXRfcmVnX3N0
YXRlKHUzMiAqcmVncywKLQkJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwK
LQkJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCQkgICAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nLAotCQkJCSAgICAgYm9vbCBpbmhpYml0KQot
ewotCS8qCi0JICogQSBjb250ZXh0IGlzIGFjdHVhbGx5IGEgYmlnIGJhdGNoIGJ1ZmZlciB3aXRo
IHNldmVyYWwKLQkgKiBNSV9MT0FEX1JFR0lTVEVSX0lNTSBjb21tYW5kcyBmb2xsb3dlZCBieSAo
cmVnLCB2YWx1ZSkgcGFpcnMuIFRoZQotCSAqIHZhbHVlcyB3ZSBhcmUgc2V0dGluZyBoZXJlIGFy
ZSBvbmx5IGZvciB0aGUgZmlyc3QgY29udGV4dCByZXN0b3JlOgotCSAqIG9uIGEgc3Vic2VxdWVu
dCBzYXZlLCB0aGUgR1BVIHdpbGwgcmVjcmVhdGUgdGhpcyBiYXRjaGJ1ZmZlciB3aXRoIG5ldwot
CSAqIHZhbHVlcyAoaW5jbHVkaW5nIGFsbCB0aGUgbWlzc2luZyBNSV9MT0FEX1JFR0lTVEVSX0lN
TSBjb21tYW5kcyB0aGF0Ci0JICogd2UgYXJlIG5vdCBpbml0aWFsaXppbmcgaGVyZSkuCi0JICoK
LQkgKiBNdXN0IGtlZXAgY29uc2lzdGVudCB3aXRoIHZpcnR1YWxfdXBkYXRlX3JlZ2lzdGVyX29m
ZnNldHMoKS4KLQkgKi8KLQlzZXRfb2Zmc2V0cyhyZWdzLCByZWdfb2Zmc2V0cyhlbmdpbmUpLCBl
bmdpbmUsIGluaGliaXQpOwotCi0JaW5pdF9jb21tb25fcmVnX3N0YXRlKHJlZ3MsIGVuZ2luZSwg
cmluZywgaW5oaWJpdCk7Ci0JaW5pdF9wcGd0dF9yZWdfc3RhdGUocmVncywgdm1fYWxpYXMoY2Ut
PnZtKSk7Ci0KLQlpbml0X3dhX2JiX3JlZ19zdGF0ZShyZWdzLCBlbmdpbmUpOwotCi0JX19yZXNl
dF9zdG9wX3JpbmcocmVncywgZW5naW5lKTsKLX0KLQotc3RhdGljIGludAotcG9wdWxhdGVfbHJf
Y29udGV4dChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0JCSAgICBzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX29iamVjdCAqY3R4X29iaiwKLQkJICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSwKLQkJICAgIHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nKQotewotCWJvb2wgaW5oaWJpdCA9IHRy
dWU7Ci0Jdm9pZCAqdmFkZHI7Ci0KLQl2YWRkciA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKGN0
eF9vYmosIEk5MTVfTUFQX1dCKTsKLQlpZiAoSVNfRVJSKHZhZGRyKSkgewotCQlkcm1fZGJnKCZl
bmdpbmUtPmk5MTUtPmRybSwgIkNvdWxkIG5vdCBtYXAgb2JqZWN0IHBhZ2VzIVxuIik7Ci0JCXJl
dHVybiBQVFJfRVJSKHZhZGRyKTsKLQl9Ci0KLQlzZXRfcmVkem9uZSh2YWRkciwgZW5naW5lKTsK
LQotCWlmIChlbmdpbmUtPmRlZmF1bHRfc3RhdGUpIHsKLQkJc2htZW1fcmVhZChlbmdpbmUtPmRl
ZmF1bHRfc3RhdGUsIDAsCi0JCQkgICB2YWRkciwgZW5naW5lLT5jb250ZXh0X3NpemUpOwotCQlf
X3NldF9iaXQoQ09OVEVYVF9WQUxJRF9CSVQsICZjZS0+ZmxhZ3MpOwotCQlpbmhpYml0ID0gZmFs
c2U7Ci0JfQotCi0JLyogQ2xlYXIgdGhlIHBwSFdTUCAoaW5jLiBwZXItY29udGV4dCBjb3VudGVy
cykgKi8KLQltZW1zZXQodmFkZHIsIDAsIFBBR0VfU0laRSk7Ci0KLQkvKgotCSAqIFRoZSBzZWNv
bmQgcGFnZSBvZiB0aGUgY29udGV4dCBvYmplY3QgY29udGFpbnMgc29tZSByZWdpc3RlcnMgd2hp
Y2gKLQkgKiBtdXN0IGJlIHNldCB1cCBwcmlvciB0byB0aGUgZmlyc3QgZXhlY3V0aW9uLgotCSAq
LwotCWV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh2YWRkciArIExSQ19TVEFURV9PRkZTRVQsCi0J
CQkJIGNlLCBlbmdpbmUsIHJpbmcsIGluaGliaXQpOwotCi0JX19pOTE1X2dlbV9vYmplY3RfZmx1
c2hfbWFwKGN0eF9vYmosIDAsIGVuZ2luZS0+Y29udGV4dF9zaXplKTsKLQlpOTE1X2dlbV9vYmpl
Y3RfdW5waW5fbWFwKGN0eF9vYmopOwotCXJldHVybiAwOwotfQotCiBzdGF0aWMgc3RydWN0IGlu
dGVsX3RpbWVsaW5lICpwaW5uZWRfdGltZWxpbmUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQog
ewogCXN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGwgPSBmZXRjaF9hbmRfemVybygmY2UtPnRpbWVs
aW5lKTsKQEAgLTQ3NjMsMzIgKzMzNTAsMTEgQEAgc3RhdGljIHN0cnVjdCBpbnRlbF90aW1lbGlu
ZSAqcGlubmVkX3RpbWVsaW5lKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIHN0YXRpYyBpbnQg
X19leGVjbGlzdHNfY29udGV4dF9hbGxvYyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJCQkJ
ICAgICBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7Ci0Jc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKmN0eF9vYmo7Ci0Jc3RydWN0IGludGVsX3JpbmcgKnJpbmc7Ci0Jc3RydWN0
IGk5MTVfdm1hICp2bWE7Ci0JdTMyIGNvbnRleHRfc2l6ZTsKLQlpbnQgcmV0OwotCi0JR0VNX0JV
R19PTihjZS0+c3RhdGUpOwotCWNvbnRleHRfc2l6ZSA9IHJvdW5kX3VwKGVuZ2luZS0+Y29udGV4
dF9zaXplLCBJOTE1X0dUVF9QQUdFX1NJWkUpOwotCi0JaWYgKElTX0VOQUJMRUQoQ09ORklHX0RS
TV9JOTE1X0RFQlVHX0dFTSkpCi0JCWNvbnRleHRfc2l6ZSArPSBJOTE1X0dUVF9QQUdFX1NJWkU7
IC8qIGZvciByZWR6b25lICovCi0KLQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPT0gMTIp
IHsKLQkJY2UtPndhX2JiX3BhZ2UgPSBjb250ZXh0X3NpemUgLyBQQUdFX1NJWkU7Ci0JCWNvbnRl
eHRfc2l6ZSArPSBQQUdFX1NJWkU7Ci0JfQotCi0JY3R4X29iaiA9IGk5MTVfZ2VtX29iamVjdF9j
cmVhdGVfc2htZW0oZW5naW5lLT5pOTE1LCBjb250ZXh0X3NpemUpOwotCWlmIChJU19FUlIoY3R4
X29iaikpCi0JCXJldHVybiBQVFJfRVJSKGN0eF9vYmopOworCWludCBlcnI7CiAKLQl2bWEgPSBp
OTE1X3ZtYV9pbnN0YW5jZShjdHhfb2JqLCAmZW5naW5lLT5ndC0+Z2d0dC0+dm0sIE5VTEwpOwot
CWlmIChJU19FUlIodm1hKSkgewotCQlyZXQgPSBQVFJfRVJSKHZtYSk7Ci0JCWdvdG8gZXJyb3Jf
ZGVyZWZfb2JqOwotCX0KKwllcnIgPSBscmNfYWxsb2MoY2UsIGVuZ2luZSk7CisJaWYgKGVycikK
KwkJcmV0dXJuIGVycjsKIAogCWlmICghcGFnZV9tYXNrX2JpdHMoY2UtPnRpbWVsaW5lKSkgewog
CQlzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsOwpAQCAtNDgwMSwzNyArMzM2NywxMyBAQCBzdGF0
aWMgaW50IF9fZXhlY2xpc3RzX2NvbnRleHRfYWxsb2Moc3RydWN0IGludGVsX2NvbnRleHQgKmNl
LAogCQkJdGwgPSBwaW5uZWRfdGltZWxpbmUoY2UpOwogCQllbHNlCiAJCQl0bCA9IGludGVsX3Rp
bWVsaW5lX2NyZWF0ZShlbmdpbmUtPmd0KTsKLQkJaWYgKElTX0VSUih0bCkpIHsKLQkJCXJldCA9
IFBUUl9FUlIodGwpOwotCQkJZ290byBlcnJvcl9kZXJlZl9vYmo7Ci0JCX0KKwkJaWYgKElTX0VS
Uih0bCkpCisJCQlyZXR1cm4gUFRSX0VSUih0bCk7CiAKIAkJY2UtPnRpbWVsaW5lID0gdGw7CiAJ
fQogCi0JcmluZyA9IGludGVsX2VuZ2luZV9jcmVhdGVfcmluZyhlbmdpbmUsICh1bnNpZ25lZCBs
b25nKWNlLT5yaW5nKTsKLQlpZiAoSVNfRVJSKHJpbmcpKSB7Ci0JCXJldCA9IFBUUl9FUlIocmlu
Zyk7Ci0JCWdvdG8gZXJyb3JfZGVyZWZfb2JqOwotCX0KLQotCXJldCA9IHBvcHVsYXRlX2xyX2Nv
bnRleHQoY2UsIGN0eF9vYmosIGVuZ2luZSwgcmluZyk7Ci0JaWYgKHJldCkgewotCQlkcm1fZGJn
KCZlbmdpbmUtPmk5MTUtPmRybSwKLQkJCSJGYWlsZWQgdG8gcG9wdWxhdGUgTFJDOiAlZFxuIiwg
cmV0KTsKLQkJZ290byBlcnJvcl9yaW5nX2ZyZWU7Ci0JfQotCi0JY2UtPnJpbmcgPSByaW5nOwot
CWNlLT5zdGF0ZSA9IHZtYTsKLQogCXJldHVybiAwOwotCi1lcnJvcl9yaW5nX2ZyZWU6Ci0JaW50
ZWxfcmluZ19wdXQocmluZyk7Ci1lcnJvcl9kZXJlZl9vYmo6Ci0JaTkxNV9nZW1fb2JqZWN0X3B1
dChjdHhfb2JqKTsKLQlyZXR1cm4gcmV0OwogfQogCiBzdGF0aWMgc3RydWN0IGxpc3RfaGVhZCAq
dmlydHVhbF9xdWV1ZShzdHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZlKQpAQCAtNTQ3MCwyOCArNDAx
Miw2IEBAIHZvaWQgaW50ZWxfZXhlY2xpc3RzX3Nob3dfcmVxdWVzdHMoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lLAogCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVuZ2luZS0+YWN0aXZl
LmxvY2ssIGZsYWdzKTsKIH0KIAotdm9pZCBpbnRlbF9scl9jb250ZXh0X3Jlc2V0KHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAgICBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Us
Ci0JCQkgICAgdTMyIGhlYWQsCi0JCQkgICAgYm9vbCBzY3J1YikKLXsKLQlHRU1fQlVHX09OKCFp
bnRlbF9jb250ZXh0X2lzX3Bpbm5lZChjZSkpOwotCi0JLyoKLQkgKiBXZSB3YW50IGEgc2ltcGxl
IGNvbnRleHQgKyByaW5nIHRvIGV4ZWN1dGUgdGhlIGJyZWFkY3J1bWIgdXBkYXRlLgotCSAqIFdl
IGNhbm5vdCByZWx5IG9uIHRoZSBjb250ZXh0IGJlaW5nIGludGFjdCBhY3Jvc3MgdGhlIEdQVSBo
YW5nLAotCSAqIHNvIGNsZWFyIGl0IGFuZCByZWJ1aWxkIGp1c3Qgd2hhdCB3ZSBuZWVkIGZvciB0
aGUgYnJlYWRjcnVtYi4KLQkgKiBBbGwgcGVuZGluZyByZXF1ZXN0cyBmb3IgdGhpcyBjb250ZXh0
IHdpbGwgYmUgemFwcGVkLCBhbmQgYW55Ci0JICogZnV0dXJlIHJlcXVlc3Qgd2lsbCBiZSBhZnRl
ciB1c2Vyc3BhY2UgaGFzIGhhZCB0aGUgb3Bwb3J0dW5pdHkKLQkgKiB0byByZWNyZWF0ZSBpdHMg
b3duIHN0YXRlLgotCSAqLwotCWlmIChzY3J1YikKLQkJcmVzdG9yZV9kZWZhdWx0X3N0YXRlKGNl
LCBlbmdpbmUpOwotCi0JLyogUmVydW4gdGhlIHJlcXVlc3Q7IGl0cyBwYXlsb2FkIGhhcyBiZWVu
IG5ldXRlcmVkIChpZiBndWlsdHkpLiAqLwotCV9fZXhlY2xpc3RzX3VwZGF0ZV9yZWdfc3RhdGUo
Y2UsIGVuZ2luZSwgaGVhZCk7Ci19Ci0KIGJvb2wKIGludGVsX2VuZ2luZV9pbl9leGVjbGlzdHNf
c3VibWlzc2lvbl9tb2RlKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJt
aXNzaW9uLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3VibWlz
c2lvbi5oCmluZGV4IDJjOWQ3MzU0YjQyZi4uMGM2NzViYmZmMzUxIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5oCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2V4ZWNsaXN0c19zdWJtaXNzaW9uLmgKQEAgLTIy
LDI1ICsyMiw4IEBAIGVudW0gewogCiBpbnQgaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb25fc2V0
dXAoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKIAotLyogTG9naWNhbCBSaW5nIENv
bnRleHRzICovCi0vKiBBdCB0aGUgc3RhcnQgb2YgdGhlIGNvbnRleHQgaW1hZ2UgaXMgaXRzIHBl
ci1wcm9jZXNzIEhXUyBwYWdlICovCi0jZGVmaW5lIExSQ19QUEhXU1BfUE4JKDApCi0jZGVmaW5l
IExSQ19QUEhXU1BfU1oJKDEpCi0vKiBBZnRlciB0aGUgUFBIV1NQIHdlIGhhdmUgdGhlIGxvZ2lj
YWwgc3RhdGUgZm9yIHRoZSBjb250ZXh0ICovCi0jZGVmaW5lIExSQ19TVEFURV9QTgkoTFJDX1BQ
SFdTUF9QTiArIExSQ19QUEhXU1BfU1opCi0jZGVmaW5lIExSQ19TVEFURV9PRkZTRVQgKExSQ19T
VEFURV9QTiAqIFBBR0VfU0laRSkKLQotLyogU3BhY2Ugd2l0aGluIFBQSFdTUCByZXNlcnZlZCB0
byBiZSB1c2VkIGFzIHNjcmF0Y2ggKi8KLSNkZWZpbmUgTFJDX1BQSFdTUF9TQ1JBVENICQkweDM0
Ci0jZGVmaW5lIExSQ19QUEhXU1BfU0NSQVRDSF9BRERSCQkoTFJDX1BQSFdTUF9TQ1JBVENIICog
c2l6ZW9mKHUzMikpCi0KIHZvaWQgaW50ZWxfZXhlY2xpc3RzX3NldF9kZWZhdWx0X3N1Ym1pc3Np
b24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKIAotdm9pZCBpbnRlbF9scl9jb250
ZXh0X3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCSAgICBzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsCi0JCQkgICAgdTMyIGhlYWQsCi0JCQkgICAgYm9vbCBzY3J1Yik7
Ci0KIHZvaWQgaW50ZWxfZXhlY2xpc3RzX3Nob3dfcmVxdWVzdHMoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lLAogCQkJCSAgIHN0cnVjdCBkcm1fcHJpbnRlciAqbSwKIAkJCQkgICB2b2lk
ICgqc2hvd19yZXF1ZXN0KShzdHJ1Y3QgZHJtX3ByaW50ZXIgKm0sCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2xyYy5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNzI2
NDMwMmFkMTQxCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfbHJjLmMKQEAgLTAsMCArMSwxNDcyIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
TUlUCisvKgorICogQ29weXJpZ2h0IMKpIDIwMTQgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisj
aW5jbHVkZSAiZ2VuOF9lbmdpbmVfY3MuaCIKKyNpbmNsdWRlICJpOTE1X2Rydi5oIgorI2luY2x1
ZGUgImk5MTVfcGVyZi5oIgorI2luY2x1ZGUgImludGVsX2VuZ2luZS5oIgorI2luY2x1ZGUgImlu
dGVsX2dwdV9jb21tYW5kcy5oIgorI2luY2x1ZGUgImludGVsX2d0LmgiCisjaW5jbHVkZSAiaW50
ZWxfbHJjLmgiCisjaW5jbHVkZSAiaW50ZWxfbHJjX3JlZy5oIgorI2luY2x1ZGUgImludGVsX3Jp
bmcuaCIKKyNpbmNsdWRlICJzaG1lbV91dGlscy5oIgorCitzdGF0aWMgaW5saW5lIHVuc2lnbmVk
IGludCBkd29yZF9pbl9wYWdlKHZvaWQgKmFkZHIpCit7CisJcmV0dXJuIG9mZnNldF9pbl9wYWdl
KGFkZHIpIC8gc2l6ZW9mKHUzMik7Cit9CisKK3N0YXRpYyB2b2lkIHNldF9vZmZzZXRzKHUzMiAq
cmVncywKKwkJCWNvbnN0IHU4ICpkYXRhLAorCQkJY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lLAorCQkJYm9vbCBjbGVhcikKKyNkZWZpbmUgTk9QKHgpIChCSVQoNykgfCAoeCkp
CisjZGVmaW5lIExSSShjb3VudCwgZmxhZ3MpICgoZmxhZ3MpIDw8IDYgfCAoY291bnQpIHwgQlVJ
TERfQlVHX09OX1pFUk8oY291bnQgPj0gQklUKDYpKSkKKyNkZWZpbmUgUE9TVEVEIEJJVCgwKQor
I2RlZmluZSBSRUcoeCkgKCgoeCkgPj4gMikgfCBCVUlMRF9CVUdfT05fWkVSTyh4ID49IDB4MjAw
KSkKKyNkZWZpbmUgUkVHMTYoeCkgXAorCSgoKHgpID4+IDkpIHwgQklUKDcpIHwgQlVJTERfQlVH
X09OX1pFUk8oeCA+PSAweDEwMDAwKSksIFwKKwkoKCh4KSA+PiAyKSAmIDB4N2YpCisjZGVmaW5l
IEVORCh0b3RhbF9zdGF0ZV9zaXplKSAwLCAodG90YWxfc3RhdGVfc2l6ZSkKK3sKKwljb25zdCB1
MzIgYmFzZSA9IGVuZ2luZS0+bW1pb19iYXNlOworCisJd2hpbGUgKCpkYXRhKSB7CisJCXU4IGNv
dW50LCBmbGFnczsKKworCQlpZiAoKmRhdGEgJiBCSVQoNykpIHsgLyogc2tpcCAqLworCQkJY291
bnQgPSAqZGF0YSsrICYgfkJJVCg3KTsKKwkJCWlmIChjbGVhcikKKwkJCQltZW1zZXQzMihyZWdz
LCBNSV9OT09QLCBjb3VudCk7CisJCQlyZWdzICs9IGNvdW50OworCQkJY29udGludWU7CisJCX0K
KworCQljb3VudCA9ICpkYXRhICYgMHgzZjsKKwkJZmxhZ3MgPSAqZGF0YSA+PiA2OworCQlkYXRh
Kys7CisKKwkJKnJlZ3MgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShjb3VudCk7CisJCWlmIChmbGFn
cyAmIFBPU1RFRCkKKwkJCSpyZWdzIHw9IE1JX0xSSV9GT1JDRV9QT1NURUQ7CisJCWlmIChJTlRF
TF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMSkKKwkJCSpyZWdzIHw9IE1JX0xSSV9MUk1fQ1NfTU1J
TzsKKwkJcmVncysrOworCisJCUdFTV9CVUdfT04oIWNvdW50KTsKKwkJZG8geworCQkJdTMyIG9m
ZnNldCA9IDA7CisJCQl1OCB2OworCisJCQlkbyB7CisJCQkJdiA9ICpkYXRhKys7CisJCQkJb2Zm
c2V0IDw8PSA3OworCQkJCW9mZnNldCB8PSB2ICYgfkJJVCg3KTsKKwkJCX0gd2hpbGUgKHYgJiBC
SVQoNykpOworCisJCQlyZWdzWzBdID0gYmFzZSArIChvZmZzZXQgPDwgMik7CisJCQlpZiAoY2xl
YXIpCisJCQkJcmVnc1sxXSA9IDA7CisJCQlyZWdzICs9IDI7CisJCX0gd2hpbGUgKC0tY291bnQp
OworCX0KKworCWlmIChjbGVhcikgeworCQl1OCBjb3VudCA9ICorK2RhdGE7CisKKwkJLyogQ2xl
YXIgcGFzdCB0aGUgdGFpbCBmb3IgSFcgYWNjZXNzICovCisJCUdFTV9CVUdfT04oZHdvcmRfaW5f
cGFnZShyZWdzKSA+IGNvdW50KTsKKwkJbWVtc2V0MzIocmVncywgTUlfTk9PUCwgY291bnQgLSBk
d29yZF9pbl9wYWdlKHJlZ3MpKTsKKworCQkvKiBDbG9zZSB0aGUgYmF0Y2g7IHVzZWQgbWFpbmx5
IGJ5IGxpdmVfbHJjX2xheW91dCgpICovCisJCSpyZWdzID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsK
KwkJaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDEwKQorCQkJKnJlZ3MgfD0gQklUKDAp
OworCX0KK30KKworc3RhdGljIGNvbnN0IHU4IGdlbjhfeGNzX29mZnNldHNbXSA9IHsKKwlOT1Ao
MSksCisJTFJJKDExLCAwKSwKKwlSRUcxNigweDI0NCksCisJUkVHKDB4MDM0KSwKKwlSRUcoMHgw
MzApLAorCVJFRygweDAzOCksCisJUkVHKDB4MDNjKSwKKwlSRUcoMHgxNjgpLAorCVJFRygweDE0
MCksCisJUkVHKDB4MTEwKSwKKwlSRUcoMHgxMWMpLAorCVJFRygweDExNCksCisJUkVHKDB4MTE4
KSwKKworCU5PUCg5KSwKKwlMUkkoOSwgMCksCisJUkVHMTYoMHgzYTgpLAorCVJFRzE2KDB4Mjhj
KSwKKwlSRUcxNigweDI4OCksCisJUkVHMTYoMHgyODQpLAorCVJFRzE2KDB4MjgwKSwKKwlSRUcx
NigweDI3YyksCisJUkVHMTYoMHgyNzgpLAorCVJFRzE2KDB4Mjc0KSwKKwlSRUcxNigweDI3MCks
CisKKwlOT1AoMTMpLAorCUxSSSgyLCAwKSwKKwlSRUcxNigweDIwMCksCisJUkVHKDB4MDI4KSwK
KworCUVORCg4MCkKK307CisKK3N0YXRpYyBjb25zdCB1OCBnZW45X3hjc19vZmZzZXRzW10gPSB7
CisJTk9QKDEpLAorCUxSSSgxNCwgUE9TVEVEKSwKKwlSRUcxNigweDI0NCksCisJUkVHKDB4MDM0
KSwKKwlSRUcoMHgwMzApLAorCVJFRygweDAzOCksCisJUkVHKDB4MDNjKSwKKwlSRUcoMHgxNjgp
LAorCVJFRygweDE0MCksCisJUkVHKDB4MTEwKSwKKwlSRUcoMHgxMWMpLAorCVJFRygweDExNCks
CisJUkVHKDB4MTE4KSwKKwlSRUcoMHgxYzApLAorCVJFRygweDFjNCksCisJUkVHKDB4MWM4KSwK
KworCU5PUCgzKSwKKwlMUkkoOSwgUE9TVEVEKSwKKwlSRUcxNigweDNhOCksCisJUkVHMTYoMHgy
OGMpLAorCVJFRzE2KDB4Mjg4KSwKKwlSRUcxNigweDI4NCksCisJUkVHMTYoMHgyODApLAorCVJF
RzE2KDB4MjdjKSwKKwlSRUcxNigweDI3OCksCisJUkVHMTYoMHgyNzQpLAorCVJFRzE2KDB4Mjcw
KSwKKworCU5PUCgxMyksCisJTFJJKDEsIFBPU1RFRCksCisJUkVHMTYoMHgyMDApLAorCisJTk9Q
KDEzKSwKKwlMUkkoNDQsIFBPU1RFRCksCisJUkVHKDB4MDI4KSwKKwlSRUcoMHgwOWMpLAorCVJF
RygweDBjMCksCisJUkVHKDB4MTc4KSwKKwlSRUcoMHgxN2MpLAorCVJFRzE2KDB4MzU4KSwKKwlS
RUcoMHgxNzApLAorCVJFRygweDE1MCksCisJUkVHKDB4MTU0KSwKKwlSRUcoMHgxNTgpLAorCVJF
RzE2KDB4NDFjKSwKKwlSRUcxNigweDYwMCksCisJUkVHMTYoMHg2MDQpLAorCVJFRzE2KDB4NjA4
KSwKKwlSRUcxNigweDYwYyksCisJUkVHMTYoMHg2MTApLAorCVJFRzE2KDB4NjE0KSwKKwlSRUcx
NigweDYxOCksCisJUkVHMTYoMHg2MWMpLAorCVJFRzE2KDB4NjIwKSwKKwlSRUcxNigweDYyNCks
CisJUkVHMTYoMHg2MjgpLAorCVJFRzE2KDB4NjJjKSwKKwlSRUcxNigweDYzMCksCisJUkVHMTYo
MHg2MzQpLAorCVJFRzE2KDB4NjM4KSwKKwlSRUcxNigweDYzYyksCisJUkVHMTYoMHg2NDApLAor
CVJFRzE2KDB4NjQ0KSwKKwlSRUcxNigweDY0OCksCisJUkVHMTYoMHg2NGMpLAorCVJFRzE2KDB4
NjUwKSwKKwlSRUcxNigweDY1NCksCisJUkVHMTYoMHg2NTgpLAorCVJFRzE2KDB4NjVjKSwKKwlS
RUcxNigweDY2MCksCisJUkVHMTYoMHg2NjQpLAorCVJFRzE2KDB4NjY4KSwKKwlSRUcxNigweDY2
YyksCisJUkVHMTYoMHg2NzApLAorCVJFRzE2KDB4Njc0KSwKKwlSRUcxNigweDY3OCksCisJUkVH
MTYoMHg2N2MpLAorCVJFRygweDA2OCksCisKKwlFTkQoMTc2KQorfTsKKworc3RhdGljIGNvbnN0
IHU4IGdlbjEyX3hjc19vZmZzZXRzW10gPSB7CisJTk9QKDEpLAorCUxSSSgxMywgUE9TVEVEKSwK
KwlSRUcxNigweDI0NCksCisJUkVHKDB4MDM0KSwKKwlSRUcoMHgwMzApLAorCVJFRygweDAzOCks
CisJUkVHKDB4MDNjKSwKKwlSRUcoMHgxNjgpLAorCVJFRygweDE0MCksCisJUkVHKDB4MTEwKSwK
KwlSRUcoMHgxYzApLAorCVJFRygweDFjNCksCisJUkVHKDB4MWM4KSwKKwlSRUcoMHgxODApLAor
CVJFRzE2KDB4MmI0KSwKKworCU5PUCg1KSwKKwlMUkkoOSwgUE9TVEVEKSwKKwlSRUcxNigweDNh
OCksCisJUkVHMTYoMHgyOGMpLAorCVJFRzE2KDB4Mjg4KSwKKwlSRUcxNigweDI4NCksCisJUkVH
MTYoMHgyODApLAorCVJFRzE2KDB4MjdjKSwKKwlSRUcxNigweDI3OCksCisJUkVHMTYoMHgyNzQp
LAorCVJFRzE2KDB4MjcwKSwKKworCUVORCg4MCkKK307CisKK3N0YXRpYyBjb25zdCB1OCBnZW44
X3Jjc19vZmZzZXRzW10gPSB7CisJTk9QKDEpLAorCUxSSSgxNCwgUE9TVEVEKSwKKwlSRUcxNigw
eDI0NCksCisJUkVHKDB4MDM0KSwKKwlSRUcoMHgwMzApLAorCVJFRygweDAzOCksCisJUkVHKDB4
MDNjKSwKKwlSRUcoMHgxNjgpLAorCVJFRygweDE0MCksCisJUkVHKDB4MTEwKSwKKwlSRUcoMHgx
MWMpLAorCVJFRygweDExNCksCisJUkVHKDB4MTE4KSwKKwlSRUcoMHgxYzApLAorCVJFRygweDFj
NCksCisJUkVHKDB4MWM4KSwKKworCU5PUCgzKSwKKwlMUkkoOSwgUE9TVEVEKSwKKwlSRUcxNigw
eDNhOCksCisJUkVHMTYoMHgyOGMpLAorCVJFRzE2KDB4Mjg4KSwKKwlSRUcxNigweDI4NCksCisJ
UkVHMTYoMHgyODApLAorCVJFRzE2KDB4MjdjKSwKKwlSRUcxNigweDI3OCksCisJUkVHMTYoMHgy
NzQpLAorCVJFRzE2KDB4MjcwKSwKKworCU5PUCgxMyksCisJTFJJKDEsIDApLAorCVJFRygweDBj
OCksCisKKwlFTkQoODApCit9OworCitzdGF0aWMgY29uc3QgdTggZ2VuOV9yY3Nfb2Zmc2V0c1td
ID0geworCU5PUCgxKSwKKwlMUkkoMTQsIFBPU1RFRCksCisJUkVHMTYoMHgyNDQpLAorCVJFRygw
eDM0KSwKKwlSRUcoMHgzMCksCisJUkVHKDB4MzgpLAorCVJFRygweDNjKSwKKwlSRUcoMHgxNjgp
LAorCVJFRygweDE0MCksCisJUkVHKDB4MTEwKSwKKwlSRUcoMHgxMWMpLAorCVJFRygweDExNCks
CisJUkVHKDB4MTE4KSwKKwlSRUcoMHgxYzApLAorCVJFRygweDFjNCksCisJUkVHKDB4MWM4KSwK
KworCU5PUCgzKSwKKwlMUkkoOSwgUE9TVEVEKSwKKwlSRUcxNigweDNhOCksCisJUkVHMTYoMHgy
OGMpLAorCVJFRzE2KDB4Mjg4KSwKKwlSRUcxNigweDI4NCksCisJUkVHMTYoMHgyODApLAorCVJF
RzE2KDB4MjdjKSwKKwlSRUcxNigweDI3OCksCisJUkVHMTYoMHgyNzQpLAorCVJFRzE2KDB4Mjcw
KSwKKworCU5PUCgxMyksCisJTFJJKDEsIDApLAorCVJFRygweGM4KSwKKworCU5PUCgxMyksCisJ
TFJJKDQ0LCBQT1NURUQpLAorCVJFRygweDI4KSwKKwlSRUcoMHg5YyksCisJUkVHKDB4YzApLAor
CVJFRygweDE3OCksCisJUkVHKDB4MTdjKSwKKwlSRUcxNigweDM1OCksCisJUkVHKDB4MTcwKSwK
KwlSRUcoMHgxNTApLAorCVJFRygweDE1NCksCisJUkVHKDB4MTU4KSwKKwlSRUcxNigweDQxYyks
CisJUkVHMTYoMHg2MDApLAorCVJFRzE2KDB4NjA0KSwKKwlSRUcxNigweDYwOCksCisJUkVHMTYo
MHg2MGMpLAorCVJFRzE2KDB4NjEwKSwKKwlSRUcxNigweDYxNCksCisJUkVHMTYoMHg2MTgpLAor
CVJFRzE2KDB4NjFjKSwKKwlSRUcxNigweDYyMCksCisJUkVHMTYoMHg2MjQpLAorCVJFRzE2KDB4
NjI4KSwKKwlSRUcxNigweDYyYyksCisJUkVHMTYoMHg2MzApLAorCVJFRzE2KDB4NjM0KSwKKwlS
RUcxNigweDYzOCksCisJUkVHMTYoMHg2M2MpLAorCVJFRzE2KDB4NjQwKSwKKwlSRUcxNigweDY0
NCksCisJUkVHMTYoMHg2NDgpLAorCVJFRzE2KDB4NjRjKSwKKwlSRUcxNigweDY1MCksCisJUkVH
MTYoMHg2NTQpLAorCVJFRzE2KDB4NjU4KSwKKwlSRUcxNigweDY1YyksCisJUkVHMTYoMHg2NjAp
LAorCVJFRzE2KDB4NjY0KSwKKwlSRUcxNigweDY2OCksCisJUkVHMTYoMHg2NmMpLAorCVJFRzE2
KDB4NjcwKSwKKwlSRUcxNigweDY3NCksCisJUkVHMTYoMHg2NzgpLAorCVJFRzE2KDB4NjdjKSwK
KwlSRUcoMHg2OCksCisKKwlFTkQoMTc2KQorfTsKKworc3RhdGljIGNvbnN0IHU4IGdlbjExX3Jj
c19vZmZzZXRzW10gPSB7CisJTk9QKDEpLAorCUxSSSgxNSwgUE9TVEVEKSwKKwlSRUcxNigweDI0
NCksCisJUkVHKDB4MDM0KSwKKwlSRUcoMHgwMzApLAorCVJFRygweDAzOCksCisJUkVHKDB4MDNj
KSwKKwlSRUcoMHgxNjgpLAorCVJFRygweDE0MCksCisJUkVHKDB4MTEwKSwKKwlSRUcoMHgxMWMp
LAorCVJFRygweDExNCksCisJUkVHKDB4MTE4KSwKKwlSRUcoMHgxYzApLAorCVJFRygweDFjNCks
CisJUkVHKDB4MWM4KSwKKwlSRUcoMHgxODApLAorCisJTk9QKDEpLAorCUxSSSg5LCBQT1NURUQp
LAorCVJFRzE2KDB4M2E4KSwKKwlSRUcxNigweDI4YyksCisJUkVHMTYoMHgyODgpLAorCVJFRzE2
KDB4Mjg0KSwKKwlSRUcxNigweDI4MCksCisJUkVHMTYoMHgyN2MpLAorCVJFRzE2KDB4Mjc4KSwK
KwlSRUcxNigweDI3NCksCisJUkVHMTYoMHgyNzApLAorCisJTFJJKDEsIFBPU1RFRCksCisJUkVH
KDB4MWIwKSwKKworCU5PUCgxMCksCisJTFJJKDEsIDApLAorCVJFRygweDBjOCksCisKKwlFTkQo
ODApCit9OworCitzdGF0aWMgY29uc3QgdTggZ2VuMTJfcmNzX29mZnNldHNbXSA9IHsKKwlOT1Ao
MSksCisJTFJJKDEzLCBQT1NURUQpLAorCVJFRzE2KDB4MjQ0KSwKKwlSRUcoMHgwMzQpLAorCVJF
RygweDAzMCksCisJUkVHKDB4MDM4KSwKKwlSRUcoMHgwM2MpLAorCVJFRygweDE2OCksCisJUkVH
KDB4MTQwKSwKKwlSRUcoMHgxMTApLAorCVJFRygweDFjMCksCisJUkVHKDB4MWM0KSwKKwlSRUco
MHgxYzgpLAorCVJFRygweDE4MCksCisJUkVHMTYoMHgyYjQpLAorCisJTk9QKDUpLAorCUxSSSg5
LCBQT1NURUQpLAorCVJFRzE2KDB4M2E4KSwKKwlSRUcxNigweDI4YyksCisJUkVHMTYoMHgyODgp
LAorCVJFRzE2KDB4Mjg0KSwKKwlSRUcxNigweDI4MCksCisJUkVHMTYoMHgyN2MpLAorCVJFRzE2
KDB4Mjc4KSwKKwlSRUcxNigweDI3NCksCisJUkVHMTYoMHgyNzApLAorCisJTFJJKDMsIFBPU1RF
RCksCisJUkVHKDB4MWIwKSwKKwlSRUcxNigweDVhOCksCisJUkVHMTYoMHg1YWMpLAorCisJTk9Q
KDYpLAorCUxSSSgxLCAwKSwKKwlSRUcoMHgwYzgpLAorCU5PUCgzICsgOSArIDEpLAorCisJTFJJ
KDUxLCBQT1NURUQpLAorCVJFRzE2KDB4NTg4KSwKKwlSRUcxNigweDU4OCksCisJUkVHMTYoMHg1
ODgpLAorCVJFRzE2KDB4NTg4KSwKKwlSRUcxNigweDU4OCksCisJUkVHMTYoMHg1ODgpLAorCVJF
RygweDAyOCksCisJUkVHKDB4MDljKSwKKwlSRUcoMHgwYzApLAorCVJFRygweDE3OCksCisJUkVH
KDB4MTdjKSwKKwlSRUcxNigweDM1OCksCisJUkVHKDB4MTcwKSwKKwlSRUcoMHgxNTApLAorCVJF
RygweDE1NCksCisJUkVHKDB4MTU4KSwKKwlSRUcxNigweDQxYyksCisJUkVHMTYoMHg2MDApLAor
CVJFRzE2KDB4NjA0KSwKKwlSRUcxNigweDYwOCksCisJUkVHMTYoMHg2MGMpLAorCVJFRzE2KDB4
NjEwKSwKKwlSRUcxNigweDYxNCksCisJUkVHMTYoMHg2MTgpLAorCVJFRzE2KDB4NjFjKSwKKwlS
RUcxNigweDYyMCksCisJUkVHMTYoMHg2MjQpLAorCVJFRzE2KDB4NjI4KSwKKwlSRUcxNigweDYy
YyksCisJUkVHMTYoMHg2MzApLAorCVJFRzE2KDB4NjM0KSwKKwlSRUcxNigweDYzOCksCisJUkVH
MTYoMHg2M2MpLAorCVJFRzE2KDB4NjQwKSwKKwlSRUcxNigweDY0NCksCisJUkVHMTYoMHg2NDgp
LAorCVJFRzE2KDB4NjRjKSwKKwlSRUcxNigweDY1MCksCisJUkVHMTYoMHg2NTQpLAorCVJFRzE2
KDB4NjU4KSwKKwlSRUcxNigweDY1YyksCisJUkVHMTYoMHg2NjApLAorCVJFRzE2KDB4NjY0KSwK
KwlSRUcxNigweDY2OCksCisJUkVHMTYoMHg2NmMpLAorCVJFRzE2KDB4NjcwKSwKKwlSRUcxNigw
eDY3NCksCisJUkVHMTYoMHg2NzgpLAorCVJFRzE2KDB4NjdjKSwKKwlSRUcoMHgwNjgpLAorCVJF
RygweDA4NCksCisJTk9QKDEpLAorCisJRU5EKDE5MikKK307CisKKyN1bmRlZiBFTkQKKyN1bmRl
ZiBSRUcxNgorI3VuZGVmIFJFRworI3VuZGVmIExSSQorI3VuZGVmIE5PUAorCitzdGF0aWMgY29u
c3QgdTggKnJlZ19vZmZzZXRzKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
K3sKKwkvKgorCSAqIFRoZSBnZW4xMisgbGlzdHMgb25seSBoYXZlIHRoZSByZWdpc3RlcnMgd2Ug
cHJvZ3JhbSBpbiB0aGUgYmFzaWMKKwkgKiBkZWZhdWx0IHN0YXRlLiBXZSByZWx5IG9uIHRoZSBj
b250ZXh0IGltYWdlIHVzaW5nIHJlbGF0aXZlCisJICogYWRkcmVzc2luZyB0byBhdXRvbWF0aWMg
Zml4dXAgdGhlIHJlZ2lzdGVyIHN0YXRlIGJldHdlZW4gdGhlCisJICogcGh5c2ljYWwgZW5naW5l
cyBmb3IgdmlydHVhbCBlbmdpbmUuCisJICovCisJR0VNX0JVR19PTihJTlRFTF9HRU4oZW5naW5l
LT5pOTE1KSA+PSAxMiAmJgorCQkgICAhaW50ZWxfZW5naW5lX2hhc19yZWxhdGl2ZV9tbWlvKGVu
Z2luZSkpOworCisJaWYgKGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKSB7CisJCWlmIChJ
TlRFTF9HRU4oZW5naW5lLT5pOTE1KSA+PSAxMikKKwkJCXJldHVybiBnZW4xMl9yY3Nfb2Zmc2V0
czsKKwkJZWxzZSBpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTEpCisJCQlyZXR1cm4g
Z2VuMTFfcmNzX29mZnNldHM7CisJCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49
IDkpCisJCQlyZXR1cm4gZ2VuOV9yY3Nfb2Zmc2V0czsKKwkJZWxzZQorCQkJcmV0dXJuIGdlbjhf
cmNzX29mZnNldHM7CisJfSBlbHNlIHsKKwkJaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49
IDEyKQorCQkJcmV0dXJuIGdlbjEyX3hjc19vZmZzZXRzOworCQllbHNlIGlmIChJTlRFTF9HRU4o
ZW5naW5lLT5pOTE1KSA+PSA5KQorCQkJcmV0dXJuIGdlbjlfeGNzX29mZnNldHM7CisJCWVsc2UK
KwkJCXJldHVybiBnZW44X3hjc19vZmZzZXRzOworCX0KK30KKworc3RhdGljIGludCBscmNfcmlu
Z19taV9tb2RlKGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpZiAo
SU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCisJCXJldHVybiAweDYwOworCWVsc2UgaWYg
KElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkpCisJCXJldHVybiAweDU0OworCWVsc2UgaWYg
KGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTKQorCQlyZXR1cm4gMHg1ODsKKwllbHNlCisJ
CXJldHVybiAtMTsKK30KKworc3RhdGljIGludCBscmNfcmluZ19ncHIwKGNvbnN0IHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkg
Pj0gMTIpCisJCXJldHVybiAweDc0OworCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUp
ID49IDkpCisJCXJldHVybiAweDY4OworCWVsc2UgaWYgKGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVS
X0NMQVNTKQorCQlyZXR1cm4gMHhkODsKKwllbHNlCisJCXJldHVybiAtMTsKK30KKworc3RhdGlj
IGludCBscmNfcmluZ193YV9iYl9wZXJfY3R4KGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKK3sKKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPj0gMTIpCisJCXJldHVy
biAweDEyOworCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID49IDkgfHwgZW5naW5l
LT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpCisJCXJldHVybiAweDE4OworCWVsc2UKKwkJcmV0dXJu
IC0xOworfQorCitzdGF0aWMgaW50IGxyY19yaW5nX2luZGlyZWN0X3B0cihjb25zdCBzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJaW50IHg7CisKKwl4ID0gbHJjX3Jpbmdfd2Ff
YmJfcGVyX2N0eChlbmdpbmUpOworCWlmICh4IDwgMCkKKwkJcmV0dXJuIHg7CisKKwlyZXR1cm4g
eCArIDI7Cit9CisKK3N0YXRpYyBpbnQgbHJjX3JpbmdfaW5kaXJlY3Rfb2Zmc2V0KGNvbnN0IHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpbnQgeDsKKworCXggPSBscmNfcmlu
Z19pbmRpcmVjdF9wdHIoZW5naW5lKTsKKwlpZiAoeCA8IDApCisJCXJldHVybiB4OworCisJcmV0
dXJuIHggKyAyOworfQorCitzdGF0aWMgaW50IGxyY19yaW5nX2NtZF9idWZfY2N0bChjb25zdCBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJaWYgKGVuZ2luZS0+Y2xhc3MgIT0g
UkVOREVSX0NMQVNTKQorCQlyZXR1cm4gLTE7CisKKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkx
NSkgPj0gMTIpCisJCXJldHVybiAweGI2OworCWVsc2UgaWYgKElOVEVMX0dFTihlbmdpbmUtPmk5
MTUpID49IDExKQorCQlyZXR1cm4gMHhhYTsKKwllbHNlCisJCXJldHVybiAtMTsKK30KKworc3Rh
dGljIHUzMgorbHJjX3JpbmdfaW5kaXJlY3Rfb2Zmc2V0X2RlZmF1bHQoY29uc3Qgc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCXN3aXRjaCAoSU5URUxfR0VOKGVuZ2luZS0+aTkx
NSkpIHsKKwlkZWZhdWx0OgorCQlNSVNTSU5HX0NBU0UoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkp
OworCQlmYWxsdGhyb3VnaDsKKwljYXNlIDEyOgorCQlyZXR1cm4gR0VOMTJfQ1RYX1JDU19JTkRJ
UkVDVF9DVFhfT0ZGU0VUX0RFRkFVTFQ7CisJY2FzZSAxMToKKwkJcmV0dXJuIEdFTjExX0NUWF9S
Q1NfSU5ESVJFQ1RfQ1RYX09GRlNFVF9ERUZBVUxUOworCWNhc2UgMTA6CisJCXJldHVybiBHRU4x
MF9DVFhfUkNTX0lORElSRUNUX0NUWF9PRkZTRVRfREVGQVVMVDsKKwljYXNlIDk6CisJCXJldHVy
biBHRU45X0NUWF9SQ1NfSU5ESVJFQ1RfQ1RYX09GRlNFVF9ERUZBVUxUOworCWNhc2UgODoKKwkJ
cmV0dXJuIEdFTjhfQ1RYX1JDU19JTkRJUkVDVF9DVFhfT0ZGU0VUX0RFRkFVTFQ7CisJfQorfQor
CitzdGF0aWMgdm9pZAorbHJjX3NldHVwX2luZGlyZWN0X2N0eCh1MzIgKnJlZ3MsCisJCSAgICAg
ICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCSAgICAgICB1MzIgY3R4
X2JiX2dndHRfYWRkciwKKwkJICAgICAgIHUzMiBzaXplKQoreworCUdFTV9CVUdfT04oIXNpemUp
OworCUdFTV9CVUdfT04oIUlTX0FMSUdORUQoc2l6ZSwgQ0FDSEVMSU5FX0JZVEVTKSk7CisJR0VN
X0JVR19PTihscmNfcmluZ19pbmRpcmVjdF9wdHIoZW5naW5lKSA9PSAtMSk7CisJcmVnc1tscmNf
cmluZ19pbmRpcmVjdF9wdHIoZW5naW5lKSArIDFdID0KKwkJY3R4X2JiX2dndHRfYWRkciB8IChz
aXplIC8gQ0FDSEVMSU5FX0JZVEVTKTsKKworCUdFTV9CVUdfT04obHJjX3JpbmdfaW5kaXJlY3Rf
b2Zmc2V0KGVuZ2luZSkgPT0gLTEpOworCXJlZ3NbbHJjX3JpbmdfaW5kaXJlY3Rfb2Zmc2V0KGVu
Z2luZSkgKyAxXSA9CisJCWxyY19yaW5nX2luZGlyZWN0X29mZnNldF9kZWZhdWx0KGVuZ2luZSkg
PDwgNjsKK30KKworc3RhdGljIHZvaWQgaW5pdF9jb21tb25fcmVncyh1MzIgKiBjb25zdCByZWdz
LAorCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCQkgICAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nLAorCQkJICAgICBib29sIGluaGliaXQpCit7
CisJdTMyIGN0bDsKKworCWN0bCA9IF9NQVNLRURfQklUX0VOQUJMRShDVFhfQ1RSTF9JTkhJQklU
X1NZTl9DVFhfU1dJVENIKTsKKwljdGwgfD0gX01BU0tFRF9CSVRfRElTQUJMRShDVFhfQ1RSTF9F
TkdJTkVfQ1RYX1JFU1RPUkVfSU5ISUJJVCk7CisJaWYgKGluaGliaXQpCisJCWN0bCB8PSBDVFhf
Q1RSTF9FTkdJTkVfQ1RYX1JFU1RPUkVfSU5ISUJJVDsKKwlpZiAoSU5URUxfR0VOKGVuZ2luZS0+
aTkxNSkgPCAxMSkKKwkJY3RsIHw9IF9NQVNLRURfQklUX0RJU0FCTEUoQ1RYX0NUUkxfRU5HSU5F
X0NUWF9TQVZFX0lOSElCSVQgfAorCQkJCQkgICBDVFhfQ1RSTF9SU19DVFhfRU5BQkxFKTsKKwly
ZWdzW0NUWF9DT05URVhUX0NPTlRST0xdID0gY3RsOworCisJcmVnc1tDVFhfUklOR19DVExdID0g
UklOR19DVExfU0laRShyaW5nLT5zaXplKSB8IFJJTkdfVkFMSUQ7CisJcmVnc1tDVFhfVElNRVNU
QU1QXSA9IDA7Cit9CisKK3N0YXRpYyB2b2lkIGluaXRfd2FfYmJfcmVncyh1MzIgKiBjb25zdCBy
ZWdzLAorCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlj
b25zdCBzdHJ1Y3QgaTkxNV9jdHhfd29ya2Fyb3VuZHMgKiBjb25zdCB3YV9jdHggPSAmZW5naW5l
LT53YV9jdHg7CisKKwlpZiAod2FfY3R4LT5wZXJfY3R4LnNpemUpIHsKKwkJY29uc3QgdTMyIGdn
dHRfb2Zmc2V0ID0gaTkxNV9nZ3R0X29mZnNldCh3YV9jdHgtPnZtYSk7CisKKwkJR0VNX0JVR19P
TihscmNfcmluZ193YV9iYl9wZXJfY3R4KGVuZ2luZSkgPT0gLTEpOworCQlyZWdzW2xyY19yaW5n
X3dhX2JiX3Blcl9jdHgoZW5naW5lKSArIDFdID0KKwkJCShnZ3R0X29mZnNldCArIHdhX2N0eC0+
cGVyX2N0eC5vZmZzZXQpIHwgMHgwMTsKKwl9CisKKwlpZiAod2FfY3R4LT5pbmRpcmVjdF9jdHgu
c2l6ZSkgeworCQlscmNfc2V0dXBfaW5kaXJlY3RfY3R4KHJlZ3MsIGVuZ2luZSwKKwkJCQkgICAg
ICAgaTkxNV9nZ3R0X29mZnNldCh3YV9jdHgtPnZtYSkgKworCQkJCSAgICAgICB3YV9jdHgtPmlu
ZGlyZWN0X2N0eC5vZmZzZXQsCisJCQkJICAgICAgIHdhX2N0eC0+aW5kaXJlY3RfY3R4LnNpemUp
OworCX0KK30KKworc3RhdGljIHZvaWQgaW5pdF9wcGd0dF9yZWdzKHUzMiAqcmVncywgY29uc3Qg
c3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0KQoreworCWlmIChpOTE1X3ZtX2lzXzRsdmwoJnBwZ3R0
LT52bSkpIHsKKwkJLyogNjRiIFBQR1RUICg0OGJpdCBjYW5vbmljYWwpCisJCSAqIFBEUDBfREVT
Q1JJUFRPUiBjb250YWlucyB0aGUgYmFzZSBhZGRyZXNzIHRvIFBNTDQgYW5kCisJCSAqIG90aGVy
IFBEUCBEZXNjcmlwdG9ycyBhcmUgaWdub3JlZC4KKwkJICovCisJCUFTU0lHTl9DVFhfUE1MNChw
cGd0dCwgcmVncyk7CisJfSBlbHNlIHsKKwkJQVNTSUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDMp
OworCQlBU1NJR05fQ1RYX1BEUChwcGd0dCwgcmVncywgMik7CisJCUFTU0lHTl9DVFhfUERQKHBw
Z3R0LCByZWdzLCAxKTsKKwkJQVNTSUdOX0NUWF9QRFAocHBndHQsIHJlZ3MsIDApOworCX0KK30K
Kworc3RhdGljIHN0cnVjdCBpOTE1X3BwZ3R0ICp2bV9hbGlhcyhzdHJ1Y3QgaTkxNV9hZGRyZXNz
X3NwYWNlICp2bSkKK3sKKwlpZiAoaTkxNV9pc19nZ3R0KHZtKSkKKwkJcmV0dXJuIGk5MTVfdm1f
dG9fZ2d0dCh2bSktPmFsaWFzOworCWVsc2UKKwkJcmV0dXJuIGk5MTVfdm1fdG9fcHBndHQodm0p
OworfQorCitzdGF0aWMgdm9pZCBfX3Jlc2V0X3N0b3BfcmluZyh1MzIgKnJlZ3MsIGNvbnN0IHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpbnQgeDsKKworCXggPSBscmNfcmlu
Z19taV9tb2RlKGVuZ2luZSk7CisJaWYgKHggIT0gLTEpIHsKKwkJcmVnc1t4ICsgMV0gJj0gflNU
T1BfUklORzsKKwkJcmVnc1t4ICsgMV0gfD0gU1RPUF9SSU5HIDw8IDE2OworCX0KK30KKworc3Rh
dGljIHZvaWQgX19scmNfaW5pdF9yZWdzKHUzMiAqcmVncywKKwkJCSAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqY2UsCisJCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lLAorCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nLAorCQkJICAgIGJv
b2wgaW5oaWJpdCkKK3sKKwkvKgorCSAqIEEgY29udGV4dCBpcyBhY3R1YWxseSBhIGJpZyBiYXRj
aCBidWZmZXIgd2l0aCBzZXZlcmFsCisJICogTUlfTE9BRF9SRUdJU1RFUl9JTU0gY29tbWFuZHMg
Zm9sbG93ZWQgYnkgKHJlZywgdmFsdWUpIHBhaXJzLiBUaGUKKwkgKiB2YWx1ZXMgd2UgYXJlIHNl
dHRpbmcgaGVyZSBhcmUgb25seSBmb3IgdGhlIGZpcnN0IGNvbnRleHQgcmVzdG9yZToKKwkgKiBv
biBhIHN1YnNlcXVlbnQgc2F2ZSwgdGhlIEdQVSB3aWxsIHJlY3JlYXRlIHRoaXMgYmF0Y2hidWZm
ZXIgd2l0aCBuZXcKKwkgKiB2YWx1ZXMgKGluY2x1ZGluZyBhbGwgdGhlIG1pc3NpbmcgTUlfTE9B
RF9SRUdJU1RFUl9JTU0gY29tbWFuZHMgdGhhdAorCSAqIHdlIGFyZSBub3QgaW5pdGlhbGl6aW5n
IGhlcmUpLgorCSAqCisJICogTXVzdCBrZWVwIGNvbnNpc3RlbnQgd2l0aCB2aXJ0dWFsX3VwZGF0
ZV9yZWdpc3Rlcl9vZmZzZXRzKCkuCisJICovCisJc2V0X29mZnNldHMocmVncywgcmVnX29mZnNl
dHMoZW5naW5lKSwgZW5naW5lLCBpbmhpYml0KTsKKworCWluaXRfY29tbW9uX3JlZ3MocmVncywg
ZW5naW5lLCByaW5nLCBpbmhpYml0KTsKKwlpbml0X3BwZ3R0X3JlZ3MocmVncywgdm1fYWxpYXMo
Y2UtPnZtKSk7CisKKwlpbml0X3dhX2JiX3JlZ3MocmVncywgZW5naW5lKTsKKworCV9fcmVzZXRf
c3RvcF9yaW5nKHJlZ3MsIGVuZ2luZSk7Cit9CisKK3ZvaWQgbHJjX2luaXRfcmVncyhjb25zdCBz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwKKwkJICAgY29uc3Qgc3RydWN0IGludGVsX3JpbmcgKnJpbmcsCisJCSAgIGJv
b2wgaW5oaWJpdCkKK3sKKwlfX2xyY19pbml0X3JlZ3MoY2UtPmxyY19yZWdfc3RhdGUsIGNlLCBl
bmdpbmUsIHJpbmcsIGluaGliaXQpOworfQorCit2b2lkIGxyY19yZXNldF9yZWdzKGNvbnN0IHN0
cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKK3sKKwlfX3Jlc2V0X3N0b3BfcmluZyhjZS0+bHJjX3JlZ19zdGF0ZSwgZW5n
aW5lKTsKK30KKwordm9pZCBscmNfcmVzdG9yZV9kZWZhdWx0cyhzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UsCisJCQkgIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwl1MzIgKnJl
Z3M7CisKKwlyZWdzID0gbWVtc2V0KGNlLT5scmNfcmVnX3N0YXRlLCAwLCBlbmdpbmUtPmNvbnRl
eHRfc2l6ZSAtIFBBR0VfU0laRSk7CisJX19scmNfaW5pdF9yZWdzKHJlZ3MsIGNlLCBlbmdpbmUs
IGNlLT5yaW5nLCB0cnVlKTsKKworCWNlLT5ydW50aW1lLmxhc3QgPSBscmNfZ2V0X3J1bnRpbWUo
Y2UpOworfQorCitzdGF0aWMgdm9pZAorc2V0X3JlZHpvbmUodm9pZCAqdmFkZHIsIGNvbnN0IHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpZiAoIUlTX0VOQUJMRUQoQ09ORklH
X0RSTV9JOTE1X0RFQlVHX0dFTSkpCisJCXJldHVybjsKKworCXZhZGRyICs9IGVuZ2luZS0+Y29u
dGV4dF9zaXplOworCisJbWVtc2V0KHZhZGRyLCBDT05URVhUX1JFRFpPTkUsIEk5MTVfR1RUX1BB
R0VfU0laRSk7Cit9CisKK3N0YXRpYyB2b2lkCitjaGVja19yZWR6b25lKGNvbnN0IHZvaWQgKnZh
ZGRyLCBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJaWYgKCFJU19F
TkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0pKQorCQlyZXR1cm47CisKKwl2YWRkciAr
PSBlbmdpbmUtPmNvbnRleHRfc2l6ZTsKKworCWlmIChtZW1jaHJfaW52KHZhZGRyLCBDT05URVhU
X1JFRFpPTkUsIEk5MTVfR1RUX1BBR0VfU0laRSkpCisJCWRybV9lcnJfb25jZSgmZW5naW5lLT5p
OTE1LT5kcm0sCisJCQkgICAgICIlcyBjb250ZXh0IHJlZHpvbmUgb3ZlcndyaXR0ZW4hXG4iLAor
CQkJICAgICBlbmdpbmUtPm5hbWUpOworfQorCit2b2lkIGxyY19jaGVja19yZWR6b25lKHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwljaGVja19yZWR6b25lKCh2b2lkICopY2UtPmxyY19y
ZWdfc3RhdGUgLSBMUkNfU1RBVEVfT0ZGU0VULCBjZS0+ZW5naW5lKTsKK30KKworc3RhdGljIGlu
dCBfX2xyY19zZXR1cChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCSAgICAgICBzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAorCQkgICAgICAgc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lLAorCQkgICAgICAgc3RydWN0IGludGVsX3JpbmcgKnJpbmcpCit7CisJYm9vbCBp
bmhpYml0ID0gdHJ1ZTsKKwl2b2lkICp2YWRkcjsKKworCXZhZGRyID0gaTkxNV9nZW1fb2JqZWN0
X3Bpbl9tYXAob2JqLCBJOTE1X01BUF9XQik7CisJaWYgKElTX0VSUih2YWRkcikpIHsKKwkJZHJt
X2RiZygmZW5naW5lLT5pOTE1LT5kcm0sICJDb3VsZCBub3QgbWFwIG9iamVjdCBwYWdlcyFcbiIp
OworCQlyZXR1cm4gUFRSX0VSUih2YWRkcik7CisJfQorCisJc2V0X3JlZHpvbmUodmFkZHIsIGVu
Z2luZSk7CisKKwlpZiAoZW5naW5lLT5kZWZhdWx0X3N0YXRlKSB7CisJCXNobWVtX3JlYWQoZW5n
aW5lLT5kZWZhdWx0X3N0YXRlLCAwLAorCQkJICAgdmFkZHIsIGVuZ2luZS0+Y29udGV4dF9zaXpl
KTsKKwkJX19zZXRfYml0KENPTlRFWFRfVkFMSURfQklULCAmY2UtPmZsYWdzKTsKKwkJaW5oaWJp
dCA9IGZhbHNlOworCX0KKworCS8qIENsZWFyIHRoZSBwcEhXU1AgKGluYy4gcGVyLWNvbnRleHQg
Y291bnRlcnMpICovCisJbWVtc2V0KHZhZGRyLCAwLCBQQUdFX1NJWkUpOworCisJLyoKKwkgKiBU
aGUgc2Vjb25kIHBhZ2Ugb2YgdGhlIGNvbnRleHQgb2JqZWN0IGNvbnRhaW5zIHNvbWUgcmVnaXN0
ZXJzIHdoaWNoCisJICogbXVzdCBiZSBzZXQgdXAgcHJpb3IgdG8gdGhlIGZpcnN0IGV4ZWN1dGlv
bi4KKwkgKi8KKwlfX2xyY19pbml0X3JlZ3ModmFkZHIgKyBMUkNfU1RBVEVfT0ZGU0VULCBjZSwg
ZW5naW5lLCByaW5nLCBpbmhpYml0KTsKKworCV9faTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcChv
YmosIDAsIGVuZ2luZS0+Y29udGV4dF9zaXplKTsKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFw
KG9iaik7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKgorX19scmNf
YWxsb2Nfc3RhdGUoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCit7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwlzdHJ1
Y3QgaTkxNV92bWEgKnZtYTsKKwl1MzIgY29udGV4dF9zaXplOworCisJY29udGV4dF9zaXplID0g
cm91bmRfdXAoZW5naW5lLT5jb250ZXh0X3NpemUsIEk5MTVfR1RUX1BBR0VfU0laRSk7CisKKwlp
ZiAoSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfR0VNKSkKKwkJY29udGV4dF9zaXpl
ICs9IEk5MTVfR1RUX1BBR0VfU0laRTsgLyogZm9yIHJlZHpvbmUgKi8KKworCWlmIChJTlRFTF9H
RU4oZW5naW5lLT5pOTE1KSA9PSAxMikgeworCQljZS0+d2FfYmJfcGFnZSA9IGNvbnRleHRfc2l6
ZSAvIFBBR0VfU0laRTsKKwkJY29udGV4dF9zaXplICs9IFBBR0VfU0laRTsKKwl9CisKKwlvYmog
PSBpOTE1X2dlbV9vYmplY3RfY3JlYXRlX3NobWVtKGVuZ2luZS0+aTkxNSwgY29udGV4dF9zaXpl
KTsKKwlpZiAoSVNfRVJSKG9iaikpCisJCXJldHVybiBFUlJfQ0FTVChvYmopOworCisJdm1hID0g
aTkxNV92bWFfaW5zdGFuY2Uob2JqLCAmZW5naW5lLT5ndC0+Z2d0dC0+dm0sIE5VTEwpOworCWlm
IChJU19FUlIodm1hKSkgeworCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJCXJldHVybiB2
bWE7CisJfQorCisJcmV0dXJuIHZtYTsKK30KKworaW50IGxyY19hbGxvYyhzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1Y3Qg
aW50ZWxfcmluZyAqcmluZzsKKwlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKKwlpbnQgZXJyOworCisJ
R0VNX0JVR19PTihjZS0+c3RhdGUpOworCisJdm1hID0gX19scmNfYWxsb2Nfc3RhdGUoY2UsIGVu
Z2luZSk7CisJaWYgKElTX0VSUih2bWEpKQorCQlyZXR1cm4gUFRSX0VSUih2bWEpOworCisJcmlu
ZyA9IGludGVsX2VuZ2luZV9jcmVhdGVfcmluZyhlbmdpbmUsICh1bnNpZ25lZCBsb25nKWNlLT5y
aW5nKTsKKwlpZiAoSVNfRVJSKHJpbmcpKSB7CisJCWVyciA9IFBUUl9FUlIocmluZyk7CisJCWdv
dG8gZXJyX3ZtYTsKKwl9CisKKwllcnIgPSBfX2xyY19zZXR1cChjZSwgdm1hLT5vYmosIGVuZ2lu
ZSwgcmluZyk7CisJaWYgKGVycikKKwkJZ290byBlcnJfcmluZzsKKworCWNlLT5yaW5nID0gcmlu
ZzsKKwljZS0+c3RhdGUgPSB2bWE7CisJcmV0dXJuIDA7CisKK2Vycl9yaW5nOgorCWludGVsX3Jp
bmdfcHV0KHJpbmcpOworZXJyX3ZtYToKKwlpOTE1X3ZtYV9wdXQodm1hKTsKKwlyZXR1cm4gZXJy
OworfQorCitzdGF0aWMgdTMyICoKK2dlbjEyX2VtaXRfdGltZXN0YW1wX3dhKGNvbnN0IHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykKK3sKKwkqY3MrKyA9IE1JX0xPQURfUkVHSVNU
RVJfTUVNX0dFTjggfAorCQlNSV9TUk1fTFJNX0dMT0JBTF9HVFQgfAorCQlNSV9MUklfTFJNX0NT
X01NSU87CisJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfQ1NfR1BSKDAs
IDApKTsKKwkqY3MrKyA9IGk5MTVfZ2d0dF9vZmZzZXQoY2UtPnN0YXRlKSArIExSQ19TVEFURV9P
RkZTRVQgKworCQlDVFhfVElNRVNUQU1QICogc2l6ZW9mKHUzMik7CisJKmNzKysgPSAwOworCisJ
KmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX1JFRyB8CisJCU1JX0xSUl9TT1VSQ0VfQ1NfTU1JTyB8
CisJCU1JX0xSSV9MUk1fQ1NfTU1JTzsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdF
TjhfUklOR19DU19HUFIoMCwgMCkpOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklO
R19DVFhfVElNRVNUQU1QKDApKTsKKworCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9SRUcgfAor
CQlNSV9MUlJfU09VUkNFX0NTX01NSU8gfAorCQlNSV9MUklfTFJNX0NTX01NSU87CisJKmNzKysg
PSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfQ1NfR1BSKDAsIDApKTsKKwkqY3MrKyA9
IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQ1RYX1RJTUVTVEFNUCgwKSk7CisKKwlyZXR1cm4g
Y3M7Cit9CisKK3N0YXRpYyB1MzIgKgorZ2VuMTJfZW1pdF9yZXN0b3JlX3NjcmF0Y2goY29uc3Qg
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1MzIgKmNzKQoreworCUdFTV9CVUdfT04obHJjX3Jp
bmdfZ3ByMChjZS0+ZW5naW5lKSA9PSAtMSk7CisKKwkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJf
TUVNX0dFTjggfAorCQlNSV9TUk1fTFJNX0dMT0JBTF9HVFQgfAorCQlNSV9MUklfTFJNX0NTX01N
SU87CisJKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChHRU44X1JJTkdfQ1NfR1BSKDAsIDAp
KTsKKwkqY3MrKyA9IGk5MTVfZ2d0dF9vZmZzZXQoY2UtPnN0YXRlKSArIExSQ19TVEFURV9PRkZT
RVQgKworCQkobHJjX3JpbmdfZ3ByMChjZS0+ZW5naW5lKSArIDEpICogc2l6ZW9mKHUzMik7CisJ
KmNzKysgPSAwOworCisJcmV0dXJuIGNzOworfQorCitzdGF0aWMgdTMyICoKK2dlbjEyX2VtaXRf
Y21kX2J1Zl93YShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3MpCit7CisJ
R0VNX0JVR19PTihscmNfcmluZ19jbWRfYnVmX2NjdGwoY2UtPmVuZ2luZSkgPT0gLTEpOworCisJ
KmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX01FTV9HRU44IHwKKwkJTUlfU1JNX0xSTV9HTE9CQUxf
R1RUIHwKKwkJTUlfTFJJX0xSTV9DU19NTUlPOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoR0VOOF9SSU5HX0NTX0dQUigwLCAwKSk7CisJKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KGNl
LT5zdGF0ZSkgKyBMUkNfU1RBVEVfT0ZGU0VUICsKKwkJKGxyY19yaW5nX2NtZF9idWZfY2N0bChj
ZS0+ZW5naW5lKSArIDEpICogc2l6ZW9mKHUzMik7CisJKmNzKysgPSAwOworCisJKmNzKysgPSBN
SV9MT0FEX1JFR0lTVEVSX1JFRyB8CisJCU1JX0xSUl9TT1VSQ0VfQ1NfTU1JTyB8CisJCU1JX0xS
SV9MUk1fQ1NfTU1JTzsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfUklOR19D
U19HUFIoMCwgMCkpOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DTURfQlVG
X0NDVEwoMCkpOworCisJcmV0dXJuIGNzOworfQorCitzdGF0aWMgdTMyICoKK2dlbjEyX2VtaXRf
aW5kaXJlY3RfY3R4X3Jjcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3Mp
Cit7CisJY3MgPSBnZW4xMl9lbWl0X3RpbWVzdGFtcF93YShjZSwgY3MpOworCWNzID0gZ2VuMTJf
ZW1pdF9jbWRfYnVmX3dhKGNlLCBjcyk7CisJY3MgPSBnZW4xMl9lbWl0X3Jlc3RvcmVfc2NyYXRj
aChjZSwgY3MpOworCisJcmV0dXJuIGNzOworfQorCitzdGF0aWMgdTMyICoKK2dlbjEyX2VtaXRf
aW5kaXJlY3RfY3R4X3hjcyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiAqY3Mp
Cit7CisJY3MgPSBnZW4xMl9lbWl0X3RpbWVzdGFtcF93YShjZSwgY3MpOworCWNzID0gZ2VuMTJf
ZW1pdF9yZXN0b3JlX3NjcmF0Y2goY2UsIGNzKTsKKworCXJldHVybiBjczsKK30KKworc3RhdGlj
IGlubGluZSB1MzIgY29udGV4dF93YV9iYl9vZmZzZXQoY29uc3Qgc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQoreworCXJldHVybiBQQUdFX1NJWkUgKiBjZS0+d2FfYmJfcGFnZTsKK30KKworc3Rh
dGljIHUzMiAqY29udGV4dF9pbmRpcmVjdF9iYihjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UpCit7CisJdm9pZCAqcHRyOworCisJR0VNX0JVR19PTighY2UtPndhX2JiX3BhZ2UpOworCisJ
cHRyID0gY2UtPmxyY19yZWdfc3RhdGU7CisJcHRyIC09IExSQ19TVEFURV9PRkZTRVQ7IC8qIGJh
Y2sgdG8gc3RhcnQgb2YgY29udGV4dCBpbWFnZSAqLworCXB0ciArPSBjb250ZXh0X3dhX2JiX29m
ZnNldChjZSk7CisKKwlyZXR1cm4gcHRyOworfQorCitzdGF0aWMgdm9pZAorc2V0dXBfaW5kaXJl
Y3RfY3R4X2JiKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJICAgICAgY29uc3Qg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkgICAgICB1MzIgKigqZW1pdCkoY29u
c3Qgc3RydWN0IGludGVsX2NvbnRleHQgKiwgdTMyICopKQoreworCXUzMiAqIGNvbnN0IHN0YXJ0
ID0gY29udGV4dF9pbmRpcmVjdF9iYihjZSk7CisJdTMyICpjczsKKworCWNzID0gZW1pdChjZSwg
c3RhcnQpOworCUdFTV9CVUdfT04oY3MgLSBzdGFydCA+IEk5MTVfR1RUX1BBR0VfU0laRSAvIHNp
emVvZigqY3MpKTsKKwl3aGlsZSAoKHVuc2lnbmVkIGxvbmcpY3MgJSBDQUNIRUxJTkVfQllURVMp
CisJCSpjcysrID0gTUlfTk9PUDsKKworCWxyY19zZXR1cF9pbmRpcmVjdF9jdHgoY2UtPmxyY19y
ZWdfc3RhdGUsIGVuZ2luZSwKKwkJCSAgICAgICBpOTE1X2dndHRfb2Zmc2V0KGNlLT5zdGF0ZSkg
KworCQkJICAgICAgIGNvbnRleHRfd2FfYmJfb2Zmc2V0KGNlKSwKKwkJCSAgICAgICAoY3MgLSBz
dGFydCkgKiBzaXplb2YoKmNzKSk7Cit9CisKKy8qCisgKiBUaGUgY29udGV4dCBkZXNjcmlwdG9y
IGVuY29kZXMgdmFyaW91cyBhdHRyaWJ1dGVzIG9mIGEgY29udGV4dCwKKyAqIGluY2x1ZGluZyBp
dHMgR1RUIGFkZHJlc3MgYW5kIHNvbWUgZmxhZ3MuIEJlY2F1c2UgaXQncyBmYWlybHkKKyAqIGV4
cGVuc2l2ZSB0byBjYWxjdWxhdGUsIHdlJ2xsIGp1c3QgZG8gaXQgb25jZSBhbmQgY2FjaGUgdGhl
IHJlc3VsdCwKKyAqIHdoaWNoIHJlbWFpbnMgdmFsaWQgdW50aWwgdGhlIGNvbnRleHQgaXMgdW5w
aW5uZWQuCisgKgorICogVGhpcyBpcyB3aGF0IGEgZGVzY3JpcHRvciBsb29rcyBsaWtlLCBmcm9t
IExTQiB0byBNU0I6OgorICoKKyAqICAgICAgYml0cyAgMC0xMTogICAgZmxhZ3MsIEdFTjhfQ1RY
XyogKGNhY2hlZCBpbiBjdHgtPmRlc2NfdGVtcGxhdGUpCisgKiAgICAgIGJpdHMgMTItMzE6ICAg
IExSQ0EsIEdUVCBhZGRyZXNzIG9mICh0aGUgSFdTUCBvZikgdGhpcyBjb250ZXh0CisgKiAgICAg
IGJpdHMgMzItNTI6ICAgIGN0eCBJRCwgYSBnbG9iYWxseSB1bmlxdWUgdGFnIChoaWdoZXN0IGJp
dCB1c2VkIGJ5IEd1QykKKyAqICAgICAgYml0cyA1My01NDogICAgbWJ6LCByZXNlcnZlZCBmb3Ig
dXNlIGJ5IGhhcmR3YXJlCisgKiAgICAgIGJpdHMgNTUtNjM6ICAgIGdyb3VwIElELCBjdXJyZW50
bHkgdW51c2VkIGFuZCBzZXQgdG8gMAorICoKKyAqIFN0YXJ0aW5nIGZyb20gR2VuMTEsIHRoZSB1
cHBlciBkd29yZCBvZiB0aGUgZGVzY3JpcHRvciBoYXMgYSBuZXcgZm9ybWF0OgorICoKKyAqICAg
ICAgYml0cyAzMi0zNjogICAgcmVzZXJ2ZWQKKyAqICAgICAgYml0cyAzNy00NzogICAgU1cgY29u
dGV4dCBJRAorICogICAgICBiaXRzIDQ4OjUzOiAgICBlbmdpbmUgaW5zdGFuY2UKKyAqICAgICAg
Yml0IDU0OiAgICAgICAgbWJ6LCByZXNlcnZlZCBmb3IgdXNlIGJ5IGhhcmR3YXJlCisgKiAgICAg
IGJpdHMgNTUtNjA6ICAgIFNXIGNvdW50ZXIKKyAqICAgICAgYml0cyA2MS02MzogICAgZW5naW5l
IGNsYXNzCisgKgorICogZW5naW5lIGluZm8sIFNXIGNvbnRleHQgSUQgYW5kIFNXIGNvdW50ZXIg
bmVlZCB0byBmb3JtIGEgdW5pcXVlIG51bWJlcgorICogKENvbnRleHQgSUQpIHBlciBscmMuCisg
Ki8KK3N0YXRpYyBpbmxpbmUgdTMyIGxyY19kZXNjcmlwdG9yKGNvbnN0IHN0cnVjdCBpbnRlbF9j
b250ZXh0ICpjZSkKK3sKKwl1MzIgZGVzYzsKKworCWRlc2MgPSBJTlRFTF9MRUdBQ1lfMzJCX0NP
TlRFWFQ7CisJaWYgKGk5MTVfdm1faXNfNGx2bChjZS0+dm0pKQorCQlkZXNjID0gSU5URUxfTEVH
QUNZXzY0Ql9DT05URVhUOworCWRlc2MgPDw9IEdFTjhfQ1RYX0FERFJFU1NJTkdfTU9ERV9TSElG
VDsKKworCWRlc2MgfD0gR0VOOF9DVFhfVkFMSUQgfCBHRU44X0NUWF9QUklWSUxFR0U7CisJaWYg
KElTX0dFTihjZS0+dm0tPmk5MTUsIDgpKQorCQlkZXNjIHw9IEdFTjhfQ1RYX0wzTExDX0NPSEVS
RU5UOworCisJcmV0dXJuIGk5MTVfZ2d0dF9vZmZzZXQoY2UtPnN0YXRlKSB8IGRlc2M7Cit9CisK
K3UzMiBscmNfdXBkYXRlX3JlZ3MoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkg
ICAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkgICAgdTMyIGhlYWQp
Cit7CisJc3RydWN0IGludGVsX3JpbmcgKnJpbmcgPSBjZS0+cmluZzsKKwl1MzIgKnJlZ3MgPSBj
ZS0+bHJjX3JlZ19zdGF0ZTsKKworCUdFTV9CVUdfT04oIWludGVsX3Jpbmdfb2Zmc2V0X3ZhbGlk
KHJpbmcsIGhlYWQpKTsKKwlHRU1fQlVHX09OKCFpbnRlbF9yaW5nX29mZnNldF92YWxpZChyaW5n
LCByaW5nLT50YWlsKSk7CisKKwlyZWdzW0NUWF9SSU5HX1NUQVJUXSA9IGk5MTVfZ2d0dF9vZmZz
ZXQocmluZy0+dm1hKTsKKwlyZWdzW0NUWF9SSU5HX0hFQURdID0gaGVhZDsKKwlyZWdzW0NUWF9S
SU5HX1RBSUxdID0gcmluZy0+dGFpbDsKKwlyZWdzW0NUWF9SSU5HX0NUTF0gPSBSSU5HX0NUTF9T
SVpFKHJpbmctPnNpemUpIHwgUklOR19WQUxJRDsKKworCS8qIFJQQ1MgKi8KKwlpZiAoZW5naW5l
LT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1MpIHsKKwkJcmVnc1tDVFhfUl9QV1JfQ0xLX1NUQVRFXSA9
CisJCQlpbnRlbF9zc2V1X21ha2VfcnBjcyhlbmdpbmUtPmd0LCAmY2UtPnNzZXUpOworCisJCWk5
MTVfb2FfaW5pdF9yZWdfc3RhdGUoY2UsIGVuZ2luZSk7CisJfQorCisJaWYgKGNlLT53YV9iYl9w
YWdlKSB7CisJCXUzMiAqKCpmbikoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1MzIg
KmNzKTsKKworCQlmbiA9IGdlbjEyX2VtaXRfaW5kaXJlY3RfY3R4X3hjczsKKwkJaWYgKGNlLT5l
bmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFTUykKKwkJCWZuID0gZ2VuMTJfZW1pdF9pbmRpcmVj
dF9jdHhfcmNzOworCisJCS8qIE11dHVhbGx5IGV4Y2x1c2l2ZSB3cnQgdG8gZ2xvYmFsIGluZGly
ZWN0IGJiICovCisJCUdFTV9CVUdfT04oZW5naW5lLT53YV9jdHguaW5kaXJlY3RfY3R4LnNpemUp
OworCQlzZXR1cF9pbmRpcmVjdF9jdHhfYmIoY2UsIGVuZ2luZSwgZm4pOworCX0KKworCXJldHVy
biBscmNfZGVzY3JpcHRvcihjZSkgfCBDVFhfREVTQ19GT1JDRV9SRVNUT1JFOworfQorCit2b2lk
IGxyY191cGRhdGVfb2Zmc2V0cyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCQlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJc2V0X29mZnNldHMoY2UtPmxyY19yZWdfc3Rh
dGUsIHJlZ19vZmZzZXRzKGVuZ2luZSksIGVuZ2luZSwgZmFsc2UpOworfQorCit2b2lkIGxyY19j
aGVja19yZWdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJICAgIGNvbnN0IHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKKwkJICAgIGNvbnN0IGNoYXIgKndoZW4pCit7
CisJY29uc3Qgc3RydWN0IGludGVsX3JpbmcgKnJpbmcgPSBjZS0+cmluZzsKKwl1MzIgKnJlZ3Mg
PSBjZS0+bHJjX3JlZ19zdGF0ZTsKKwlib29sIHZhbGlkID0gdHJ1ZTsKKwlpbnQgeDsKKworCWlm
IChyZWdzW0NUWF9SSU5HX1NUQVJUXSAhPSBpOTE1X2dndHRfb2Zmc2V0KHJpbmctPnZtYSkpIHsK
KwkJcHJfZXJyKCIlczogY29udGV4dCBzdWJtaXR0ZWQgd2l0aCBpbmNvcnJlY3QgUklOR19TVEFS
VCBbJTA4eF0sIGV4cGVjdGVkICUwOHhcbiIsCisJCSAgICAgICBlbmdpbmUtPm5hbWUsCisJCSAg
ICAgICByZWdzW0NUWF9SSU5HX1NUQVJUXSwKKwkJICAgICAgIGk5MTVfZ2d0dF9vZmZzZXQocmlu
Zy0+dm1hKSk7CisJCXJlZ3NbQ1RYX1JJTkdfU1RBUlRdID0gaTkxNV9nZ3R0X29mZnNldChyaW5n
LT52bWEpOworCQl2YWxpZCA9IGZhbHNlOworCX0KKworCWlmICgocmVnc1tDVFhfUklOR19DVExd
ICYgfihSSU5HX1dBSVQgfCBSSU5HX1dBSVRfU0VNQVBIT1JFKSkgIT0KKwkgICAgKFJJTkdfQ1RM
X1NJWkUocmluZy0+c2l6ZSkgfCBSSU5HX1ZBTElEKSkgeworCQlwcl9lcnIoIiVzOiBjb250ZXh0
IHN1Ym1pdHRlZCB3aXRoIGluY29ycmVjdCBSSU5HX0NUTCBbJTA4eF0sIGV4cGVjdGVkICUwOHhc
biIsCisJCSAgICAgICBlbmdpbmUtPm5hbWUsCisJCSAgICAgICByZWdzW0NUWF9SSU5HX0NUTF0s
CisJCSAgICAgICAodTMyKShSSU5HX0NUTF9TSVpFKHJpbmctPnNpemUpIHwgUklOR19WQUxJRCkp
OworCQlyZWdzW0NUWF9SSU5HX0NUTF0gPSBSSU5HX0NUTF9TSVpFKHJpbmctPnNpemUpIHwgUklO
R19WQUxJRDsKKwkJdmFsaWQgPSBmYWxzZTsKKwl9CisKKwl4ID0gbHJjX3JpbmdfbWlfbW9kZShl
bmdpbmUpOworCWlmICh4ICE9IC0xICYmIHJlZ3NbeCArIDFdICYgKHJlZ3NbeCArIDFdID4+IDE2
KSAmIFNUT1BfUklORykgeworCQlwcl9lcnIoIiVzOiBjb250ZXh0IHN1Ym1pdHRlZCB3aXRoIFNU
T1BfUklORyBbJTA4eF0gaW4gUklOR19NSV9NT0RFXG4iLAorCQkgICAgICAgZW5naW5lLT5uYW1l
LCByZWdzW3ggKyAxXSk7CisJCXJlZ3NbeCArIDFdICY9IH5TVE9QX1JJTkc7CisJCXJlZ3NbeCAr
IDFdIHw9IFNUT1BfUklORyA8PCAxNjsKKwkJdmFsaWQgPSBmYWxzZTsKKwl9CisKKwlXQVJOX09O
Q0UoIXZhbGlkLCAiSW52YWxpZCBscmMgc3RhdGUgZm91bmQgJXMgc3VibWlzc2lvblxuIiwgd2hl
bik7Cit9CisKKy8qCisgKiBJbiB0aGlzIFdBIHdlIG5lZWQgdG8gc2V0IEdFTjhfTDNTUUNSRUc0
WzIxOjIxXSBhbmQgcmVzZXQgaXQgYWZ0ZXIKKyAqIFBJUEVfQ09OVFJPTCBpbnN0cnVjdGlvbi4g
VGhpcyBpcyByZXF1aXJlZCBmb3IgdGhlIGZsdXNoIHRvIGhhcHBlbiBjb3JyZWN0bHkKKyAqIGJ1
dCB0aGVyZSBpcyBhIHNsaWdodCBjb21wbGljYXRpb24gYXMgdGhpcyBpcyBhcHBsaWVkIGluIFdB
IGJhdGNoIHdoZXJlIHRoZQorICogdmFsdWVzIGFyZSBvbmx5IGluaXRpYWxpemVkIG9uY2Ugc28g
d2UgY2Fubm90IHRha2UgcmVnaXN0ZXIgdmFsdWUgYXQgdGhlCisgKiBiZWdpbm5pbmcgYW5kIHJl
dXNlIGl0IGZ1cnRoZXI7IGhlbmNlIHdlIHNhdmUgaXRzIHZhbHVlIHRvIG1lbW9yeSwgdXBsb2Fk
IGEKKyAqIGNvbnN0YW50IHZhbHVlIHdpdGggYml0MjEgc2V0IGFuZCB0aGVuIHdlIHJlc3RvcmUg
aXQgYmFjayB3aXRoIHRoZSBzYXZlZCB2YWx1ZS4KKyAqIFRvIHNpbXBsaWZ5IHRoZSBXQSwgYSBj
b25zdGFudCB2YWx1ZSBpcyBmb3JtZWQgYnkgdXNpbmcgdGhlIGRlZmF1bHQgdmFsdWUKKyAqIG9m
IHRoaXMgcmVnaXN0ZXIuIFRoaXMgc2hvdWxkbid0IGJlIGEgcHJvYmxlbSBiZWNhdXNlIHdlIGFy
ZSBvbmx5IG1vZGlmeWluZworICogaXQgZm9yIGEgc2hvcnQgcGVyaW9kIGFuZCB0aGlzIGJhdGNo
IGluIG5vbi1wcmVtcHRpYmxlLiBXZSBjYW4gb2Zjb3Vyc2UKKyAqIHVzZSBhZGRpdGlvbmFsIGlu
c3RydWN0aW9ucyB0aGF0IHJlYWQgdGhlIGFjdHVhbCB2YWx1ZSBvZiB0aGUgcmVnaXN0ZXIKKyAq
IGF0IHRoYXQgdGltZSBhbmQgc2V0IG91ciBiaXQgb2YgaW50ZXJlc3QgYnV0IGl0IG1ha2VzIHRo
ZSBXQSBjb21wbGljYXRlZC4KKyAqCisgKiBUaGlzIFdBIGlzIGFsc28gcmVxdWlyZWQgZm9yIEdl
bjkgc28gZXh0cmFjdGluZyBhcyBhIGZ1bmN0aW9uIGF2b2lkcworICogY29kZSBkdXBsaWNhdGlv
bi4KKyAqLworc3RhdGljIHUzMiAqCitnZW44X2VtaXRfZmx1c2hfY29oZXJlbnRsM193YShzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsIHUzMiAqYmF0Y2gpCit7CisJLyogTkIgbm8gb25l
IGVsc2UgaXMgYWxsb3dlZCB0byBzY3JpYmJsZSBvdmVyIHNjcmF0Y2ggKyAyNTYhICovCisJKmJh
dGNoKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1NSTV9MUk1fR0xPQkFMX0dU
VDsKKwkqYmF0Y2grKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KEdFTjhfTDNTUUNSRUc0KTsKKwkq
YmF0Y2grKyA9IGludGVsX2d0X3NjcmF0Y2hfb2Zmc2V0KGVuZ2luZS0+Z3QsCisJCQkJCSAgIElO
VEVMX0dUX1NDUkFUQ0hfRklFTERfQ09IRVJFTlRMM19XQSk7CisJKmJhdGNoKysgPSAwOworCisJ
KmJhdGNoKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTSgxKTsKKwkqYmF0Y2grKyA9IGk5MTVfbW1p
b19yZWdfb2Zmc2V0KEdFTjhfTDNTUUNSRUc0KTsKKwkqYmF0Y2grKyA9IDB4NDA0MDAwMDAgfCBH
RU44X0xRU0NfRkxVU0hfQ09IRVJFTlRfTElORVM7CisKKwliYXRjaCA9IGdlbjhfZW1pdF9waXBl
X2NvbnRyb2woYmF0Y2gsCisJCQkJICAgICAgIFBJUEVfQ09OVFJPTF9DU19TVEFMTCB8CisJCQkJ
ICAgICAgIFBJUEVfQ09OVFJPTF9EQ19GTFVTSF9FTkFCTEUsCisJCQkJICAgICAgIDApOworCisJ
KmJhdGNoKysgPSBNSV9MT0FEX1JFR0lTVEVSX01FTV9HRU44IHwgTUlfU1JNX0xSTV9HTE9CQUxf
R1RUOworCSpiYXRjaCsrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9MM1NRQ1JFRzQpOwor
CSpiYXRjaCsrID0gaW50ZWxfZ3Rfc2NyYXRjaF9vZmZzZXQoZW5naW5lLT5ndCwKKwkJCQkJICAg
SU5URUxfR1RfU0NSQVRDSF9GSUVMRF9DT0hFUkVOVEwzX1dBKTsKKwkqYmF0Y2grKyA9IDA7CisK
KwlyZXR1cm4gYmF0Y2g7Cit9CisKKy8qCisgKiBUeXBpY2FsbHkgd2Ugb25seSBoYXZlIG9uZSBp
bmRpcmVjdF9jdHggYW5kIHBlcl9jdHggYmF0Y2ggYnVmZmVyIHdoaWNoIGFyZQorICogaW5pdGlh
bGl6ZWQgYXQgdGhlIGJlZ2lubmluZyBhbmQgc2hhcmVkIGFjcm9zcyBhbGwgY29udGV4dHMgYnV0
IHRoaXMgZmllbGQKKyAqIGhlbHBzIHVzIHRvIGhhdmUgbXVsdGlwbGUgYmF0Y2hlcyBhdCBkaWZm
ZXJlbnQgb2Zmc2V0cyBhbmQgc2VsZWN0IHRoZW0gYmFzZWQKKyAqIG9uIGEgY3JpdGVyaWEuIEF0
IHRoZSBtb21lbnQgdGhpcyBiYXRjaCBhbHdheXMgc3RhcnQgYXQgdGhlIGJlZ2lubmluZyBvZiB0
aGUgcGFnZQorICogYW5kIGF0IHRoaXMgcG9pbnQgd2UgZG9uJ3QgaGF2ZSBtdWx0aXBsZSB3YV9j
dHggYmF0Y2ggYnVmZmVycy4KKyAqCisgKiBUaGUgbnVtYmVyIG9mIFdBIGFwcGxpZWQgYXJlIG5v
dCBrbm93biBhdCB0aGUgYmVnaW5uaW5nOyB3ZSB1c2UgdGhpcyBmaWVsZAorICogdG8gcmV0dXJu
IHRoZSBubyBvZiBEV09SRFMgd3JpdHRlbi4KKyAqCisgKiBJdCBpcyB0byBiZSBub3RlZCB0aGF0
IHRoaXMgYmF0Y2ggZG9lcyBub3QgY29udGFpbiBNSV9CQVRDSF9CVUZGRVJfRU5ECisgKiBzbyBp
dCBhZGRzIE5PT1BzIGFzIHBhZGRpbmcgdG8gbWFrZSBpdCBjYWNoZWxpbmUgYWxpZ25lZC4KKyAq
IE1JX0JBVENIX0JVRkZFUl9FTkQgd2lsbCBiZSBhZGRlZCB0byBwZXJjdHggYmF0Y2ggYW5kIGJv
dGggb2YgdGhlbSB0b2dldGhlcgorICogbWFrZXMgYSBjb21wbGV0ZSBiYXRjaCBidWZmZXIuCisg
Ki8KK3N0YXRpYyB1MzIgKmdlbjhfaW5pdF9pbmRpcmVjdGN0eF9iYihzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUsIHUzMiAqYmF0Y2gpCit7CisJLyogV2FEaXNhYmxlQ3R4UmVzdG9yZUFy
Yml0cmF0aW9uOmJkdyxjaHYgKi8KKwkqYmF0Y2grKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJf
RElTQUJMRTsKKworCS8qIFdhRmx1c2hDb2hlcmVudEwzQ2FjaGVMaW5lc0F0Q29udGV4dFN3aXRj
aDpiZHcgKi8KKwlpZiAoSVNfQlJPQURXRUxMKGVuZ2luZS0+aTkxNSkpCisJCWJhdGNoID0gZ2Vu
OF9lbWl0X2ZsdXNoX2NvaGVyZW50bDNfd2EoZW5naW5lLCBiYXRjaCk7CisKKwkvKiBXYUNsZWFy
U2xtU3BhY2VBdENvbnRleHRTd2l0Y2g6YmR3LGNodiAqLworCS8qIEFjdHVhbCBzY3JhdGNoIGxv
Y2F0aW9uIGlzIGF0IDEyOCBieXRlcyBvZmZzZXQgKi8KKwliYXRjaCA9IGdlbjhfZW1pdF9waXBl
X2NvbnRyb2woYmF0Y2gsCisJCQkJICAgICAgIFBJUEVfQ09OVFJPTF9GTFVTSF9MMyB8CisJCQkJ
ICAgICAgIFBJUEVfQ09OVFJPTF9TVE9SRV9EQVRBX0lOREVYIHwKKwkJCQkgICAgICAgUElQRV9D
T05UUk9MX0NTX1NUQUxMIHwKKwkJCQkgICAgICAgUElQRV9DT05UUk9MX1FXX1dSSVRFLAorCQkJ
CSAgICAgICBMUkNfUFBIV1NQX1NDUkFUQ0hfQUREUik7CisKKwkqYmF0Y2grKyA9IE1JX0FSQl9P
Tl9PRkYgfCBNSV9BUkJfRU5BQkxFOworCisJLyogUGFkIHRvIGVuZCBvZiBjYWNoZWxpbmUgKi8K
Kwl3aGlsZSAoKHVuc2lnbmVkIGxvbmcpYmF0Y2ggJSBDQUNIRUxJTkVfQllURVMpCisJCSpiYXRj
aCsrID0gTUlfTk9PUDsKKworCS8qCisJICogTUlfQkFUQ0hfQlVGRkVSX0VORCBpcyBub3QgcmVx
dWlyZWQgaW4gSW5kaXJlY3QgY3R4IEJCIGJlY2F1c2UKKwkgKiBleGVjdXRpb24gZGVwZW5kcyBv
biB0aGUgbGVuZ3RoIHNwZWNpZmllZCBpbiB0ZXJtcyBvZiBjYWNoZSBsaW5lcworCSAqIGluIHRo
ZSByZWdpc3RlciBDVFhfUkNTX0lORElSRUNUX0NUWAorCSAqLworCisJcmV0dXJuIGJhdGNoOwor
fQorCitzdHJ1Y3QgbHJpIHsKKwlpOTE1X3JlZ190IHJlZzsKKwl1MzIgdmFsdWU7Cit9OworCitz
dGF0aWMgdTMyICplbWl0X2xyaSh1MzIgKmJhdGNoLCBjb25zdCBzdHJ1Y3QgbHJpICpscmksIHVu
c2lnbmVkIGludCBjb3VudCkKK3sKKwlHRU1fQlVHX09OKCFjb3VudCB8fCBjb3VudCA+IDYzKTsK
KworCSpiYXRjaCsrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oY291bnQpOworCWRvIHsKKwkJKmJh
dGNoKysgPSBpOTE1X21taW9fcmVnX29mZnNldChscmktPnJlZyk7CisJCSpiYXRjaCsrID0gbHJp
LT52YWx1ZTsKKwl9IHdoaWxlIChscmkrKywgLS1jb3VudCk7CisJKmJhdGNoKysgPSBNSV9OT09Q
OworCisJcmV0dXJuIGJhdGNoOworfQorCitzdGF0aWMgdTMyICpnZW45X2luaXRfaW5kaXJlY3Rj
dHhfYmIoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKQoreworCXN0
YXRpYyBjb25zdCBzdHJ1Y3QgbHJpIGxyaVtdID0geworCQkvKiBXYURpc2FibGVHYXRoZXJBdFNl
dFNoYWRlckNvbW1vblNsaWNlOnNrbCxieHQsa2JsLGdsayAqLworCQl7CisJCQlDT01NT05fU0xJ
Q0VfQ0hJQ0tFTjIsCisJCQlfX01BU0tFRF9GSUVMRChHRU45X0RJU0FCTEVfR0FUSEVSX0FUX1NF
VF9TSEFERVJfQ09NTU9OX1NMSUNFLAorCQkJCSAgICAgICAwKSwKKwkJfSwKKworCQkvKiBCU3Bl
YzogMTEzOTEgKi8KKwkJeworCQkJRkZfU0xJQ0VfQ0hJQ0tFTiwKKwkJCV9fTUFTS0VEX0ZJRUxE
KEZGX1NMSUNFX0NISUNLRU5fQ0xfUFJPVk9LSU5HX1ZFUlRFWF9GSVgsCisJCQkJICAgICAgIEZG
X1NMSUNFX0NISUNLRU5fQ0xfUFJPVk9LSU5HX1ZFUlRFWF9GSVgpLAorCQl9LAorCisJCS8qIEJT
cGVjOiAxMTI5OSAqLworCQl7CisJCQlfM0RfQ0hJQ0tFTjMsCisJCQlfX01BU0tFRF9GSUVMRChf
M0RfQ0hJQ0tFTl9TRl9QUk9WT0tJTkdfVkVSVEVYX0ZJWCwKKwkJCQkgICAgICAgXzNEX0NISUNL
RU5fU0ZfUFJPVk9LSU5HX1ZFUlRFWF9GSVgpLAorCQl9CisJfTsKKworCSpiYXRjaCsrID0gTUlf
QVJCX09OX09GRiB8IE1JX0FSQl9ESVNBQkxFOworCisJLyogV2FGbHVzaENvaGVyZW50TDNDYWNo
ZUxpbmVzQXRDb250ZXh0U3dpdGNoOnNrbCxieHQsZ2xrICovCisJYmF0Y2ggPSBnZW44X2VtaXRf
Zmx1c2hfY29oZXJlbnRsM193YShlbmdpbmUsIGJhdGNoKTsKKworCS8qIFdhQ2xlYXJTbG1TcGFj
ZUF0Q29udGV4dFN3aXRjaDpza2wsYnh0LGtibCxnbGssY2ZsICovCisJYmF0Y2ggPSBnZW44X2Vt
aXRfcGlwZV9jb250cm9sKGJhdGNoLAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfRkxVU0hfTDMg
fAorCQkJCSAgICAgICBQSVBFX0NPTlRST0xfU1RPUkVfREFUQV9JTkRFWCB8CisJCQkJICAgICAg
IFBJUEVfQ09OVFJPTF9DU19TVEFMTCB8CisJCQkJICAgICAgIFBJUEVfQ09OVFJPTF9RV19XUklU
RSwKKwkJCQkgICAgICAgTFJDX1BQSFdTUF9TQ1JBVENIX0FERFIpOworCisJYmF0Y2ggPSBlbWl0
X2xyaShiYXRjaCwgbHJpLCBBUlJBWV9TSVpFKGxyaSkpOworCisJLyogV2FNZWRpYVBvb2xTdGF0
ZUNtZEluV0FCQjpieHQsZ2xrICovCisJaWYgKEhBU19QT09MRURfRVUoZW5naW5lLT5pOTE1KSkg
eworCQkvKgorCQkgKiBFVSBwb29sIGNvbmZpZ3VyYXRpb24gaXMgc2V0dXAgYWxvbmcgd2l0aCBn
b2xkZW4gY29udGV4dAorCQkgKiBkdXJpbmcgY29udGV4dCBpbml0aWFsaXphdGlvbi4gVGhpcyB2
YWx1ZSBkZXBlbmRzIG9uCisJCSAqIGRldmljZSB0eXBlICgyeDYgb3IgM3g2KSBhbmQgbmVlZHMg
dG8gYmUgdXBkYXRlZCBiYXNlZAorCQkgKiBvbiB3aGljaCBzdWJzbGljZSBpcyBkaXNhYmxlZCBl
c3BlY2lhbGx5IGZvciAyeDYKKwkJICogZGV2aWNlcywgaG93ZXZlciBpdCBpcyBzYWZlIHRvIGxv
YWQgZGVmYXVsdAorCQkgKiBjb25maWd1cmF0aW9uIG9mIDN4NiBkZXZpY2UgaW5zdGVhZCBvZiBt
YXNraW5nIG9mZgorCQkgKiBjb3JyZXNwb25kaW5nIGJpdHMgYmVjYXVzZSBIVyBpZ25vcmVzIGJp
dHMgb2YgYSBkaXNhYmxlZAorCQkgKiBzdWJzbGljZSBhbmQgZHJvcHMgZG93biB0byBhcHByb3By
aWF0ZSBjb25maWcuIFBsZWFzZQorCQkgKiBzZWUgcmVuZGVyX3N0YXRlX3NldHVwKCkgaW4gaTkx
NV9nZW1fcmVuZGVyX3N0YXRlLmMgZm9yCisJCSAqIHBvc3NpYmxlIGNvbmZpZ3VyYXRpb25zLCB0
byBhdm9pZCBkdXBsaWNhdGlvbiB0aGV5IGFyZQorCQkgKiBub3Qgc2hvd24gaGVyZSBhZ2Fpbi4K
KwkJICovCisJCSpiYXRjaCsrID0gR0VOOV9NRURJQV9QT09MX1NUQVRFOworCQkqYmF0Y2grKyA9
IEdFTjlfTUVESUFfUE9PTF9FTkFCTEU7CisJCSpiYXRjaCsrID0gMHgwMDc3NzAwMDsKKwkJKmJh
dGNoKysgPSAwOworCQkqYmF0Y2grKyA9IDA7CisJCSpiYXRjaCsrID0gMDsKKwl9CisKKwkqYmF0
Y2grKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRU5BQkxFOworCisJLyogUGFkIHRvIGVuZCBv
ZiBjYWNoZWxpbmUgKi8KKwl3aGlsZSAoKHVuc2lnbmVkIGxvbmcpYmF0Y2ggJSBDQUNIRUxJTkVf
QllURVMpCisJCSpiYXRjaCsrID0gTUlfTk9PUDsKKworCXJldHVybiBiYXRjaDsKK30KKworc3Rh
dGljIHUzMiAqCitnZW4xMF9pbml0X2luZGlyZWN0Y3R4X2JiKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSwgdTMyICpiYXRjaCkKK3sKKwlpbnQgaTsKKworCS8qCisJICogV2FQaXBlQ29u
dHJvbEJlZm9yZTNEU3RhdGVTYW1wbGVQYXR0ZXJuOiBjbmwKKwkgKgorCSAqIEVuc3VyZSB0aGUg
ZW5naW5lIGlzIGlkbGUgcHJpb3IgdG8gcHJvZ3JhbW1pbmcgYQorCSAqIDNEU1RBVEVfU0FNUExF
X1BBVFRFUk4gZHVyaW5nIGEgY29udGV4dCByZXN0b3JlLgorCSAqLworCWJhdGNoID0gZ2VuOF9l
bWl0X3BpcGVfY29udHJvbChiYXRjaCwKKwkJCQkgICAgICAgUElQRV9DT05UUk9MX0NTX1NUQUxM
LAorCQkJCSAgICAgICAwKTsKKwkvKgorCSAqIFdhUGlwZUNvbnRyb2xCZWZvcmUzRFN0YXRlU2Ft
cGxlUGF0dGVybiBzYXlzIHdlIG5lZWQgNCBkd29yZHMgZm9yCisJICogdGhlIFBJUEVfQ09OVFJP
TCBmb2xsb3dlZCBieSAxMiBkd29yZHMgb2YgMHgwLCBzbyAxNiBkd29yZHMgaW4KKwkgKiB0b3Rh
bC4gSG93ZXZlciwgYSBQSVBFX0NPTlRST0wgaXMgNiBkd29yZHMgbG9uZywgbm90IDQsIHdoaWNo
IGlzCisJICogY29uZnVzaW5nLiBTaW5jZSBnZW44X2VtaXRfcGlwZV9jb250cm9sKCkgYWxyZWFk
eSBhZHZhbmNlcyB0aGUKKwkgKiBiYXRjaCBieSA2IGR3b3Jkcywgd2UgYWR2YW5jZSB0aGUgb3Ro
ZXIgMTAgaGVyZSwgY29tcGxldGluZyBhCisJICogY2FjaGVsaW5lLiBJdCdzIG5vdCBjbGVhciBp
ZiB0aGUgd29ya2Fyb3VuZCByZXF1aXJlcyB0aGlzIHBhZGRpbmcKKwkgKiBiZWZvcmUgb3RoZXIg
Y29tbWFuZHMsIG9yIGlmIGl0J3MganVzdCB0aGUgcmVndWxhciBwYWRkaW5nIHdlIHdvdWxkCisJ
ICogYWxyZWFkeSBoYXZlIGZvciB0aGUgd29ya2Fyb3VuZCBiYiwgc28gbGVhdmUgaXQgaGVyZSBm
b3Igbm93LgorCSAqLworCWZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKQorCQkqYmF0Y2grKyA9IE1J
X05PT1A7CisKKwkvKiBQYWQgdG8gZW5kIG9mIGNhY2hlbGluZSAqLworCXdoaWxlICgodW5zaWdu
ZWQgbG9uZyliYXRjaCAlIENBQ0hFTElORV9CWVRFUykKKwkJKmJhdGNoKysgPSBNSV9OT09QOwor
CisJcmV0dXJuIGJhdGNoOworfQorCisjZGVmaW5lIENUWF9XQV9CQl9TSVpFIChQQUdFX1NJWkUp
CisKK3N0YXRpYyBpbnQgbHJjX3NldHVwX3dhX2N0eChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUpCit7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwlzdHJ1Y3QgaTkx
NV92bWEgKnZtYTsKKwlpbnQgZXJyOworCisJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9z
aG1lbShlbmdpbmUtPmk5MTUsIENUWF9XQV9CQl9TSVpFKTsKKwlpZiAoSVNfRVJSKG9iaikpCisJ
CXJldHVybiBQVFJfRVJSKG9iaik7CisKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosICZl
bmdpbmUtPmd0LT5nZ3R0LT52bSwgTlVMTCk7CisJaWYgKElTX0VSUih2bWEpKSB7CisJCWVyciA9
IFBUUl9FUlIodm1hKTsKKwkJZ290byBlcnI7CisJfQorCisJZXJyID0gaTkxNV9nZ3R0X3Bpbih2
bWEsIE5VTEwsIDAsIFBJTl9ISUdIKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycjsKKworCWVuZ2lu
ZS0+d2FfY3R4LnZtYSA9IHZtYTsKKwlyZXR1cm4gMDsKKworZXJyOgorCWk5MTVfZ2VtX29iamVj
dF9wdXQob2JqKTsKKwlyZXR1cm4gZXJyOworfQorCit2b2lkIGxyY19maW5pX3dhX2N0eChzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJaTkxNV92bWFfdW5waW5fYW5kX3JlbGVh
c2UoJmVuZ2luZS0+d2FfY3R4LnZtYSwgMCk7Cit9CisKK3R5cGVkZWYgdTMyICooKndhX2JiX2Z1
bmNfdCkoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIgKmJhdGNoKTsKKworaW50
IGxyY19pbml0X3dhX2N0eChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCit7CisJc3Ry
dWN0IGk5MTVfY3R4X3dvcmthcm91bmRzICp3YV9jdHggPSAmZW5naW5lLT53YV9jdHg7CisJc3Ry
dWN0IGk5MTVfd2FfY3R4X2JiICp3YV9iYltdID0geworCQkmd2FfY3R4LT5pbmRpcmVjdF9jdHgs
ICZ3YV9jdHgtPnBlcl9jdHgKKwl9OworCXdhX2JiX2Z1bmNfdCB3YV9iYl9mbltBUlJBWV9TSVpF
KHdhX2JiKV07CisJdm9pZCAqYmF0Y2gsICpiYXRjaF9wdHI7CisJdW5zaWduZWQgaW50IGk7CisJ
aW50IHJldDsKKworCWlmIChlbmdpbmUtPmNsYXNzICE9IFJFTkRFUl9DTEFTUykKKwkJcmV0dXJu
IDA7CisKKwlzd2l0Y2ggKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpKSB7CisJY2FzZSAxMjoKKwlj
YXNlIDExOgorCQlyZXR1cm4gMDsKKwljYXNlIDEwOgorCQl3YV9iYl9mblswXSA9IGdlbjEwX2lu
aXRfaW5kaXJlY3RjdHhfYmI7CisJCXdhX2JiX2ZuWzFdID0gTlVMTDsKKwkJYnJlYWs7CisJY2Fz
ZSA5OgorCQl3YV9iYl9mblswXSA9IGdlbjlfaW5pdF9pbmRpcmVjdGN0eF9iYjsKKwkJd2FfYmJf
Zm5bMV0gPSBOVUxMOworCQlicmVhazsKKwljYXNlIDg6CisJCXdhX2JiX2ZuWzBdID0gZ2VuOF9p
bml0X2luZGlyZWN0Y3R4X2JiOworCQl3YV9iYl9mblsxXSA9IE5VTEw7CisJCWJyZWFrOworCWRl
ZmF1bHQ6CisJCU1JU1NJTkdfQ0FTRShJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSk7CisJCXJldHVy
biAwOworCX0KKworCXJldCA9IGxyY19zZXR1cF93YV9jdHgoZW5naW5lKTsKKwlpZiAocmV0KSB7
CisJCWRybV9kYmcoJmVuZ2luZS0+aTkxNS0+ZHJtLAorCQkJIkZhaWxlZCB0byBzZXR1cCBjb250
ZXh0IFdBIHBhZ2U6ICVkXG4iLCByZXQpOworCQlyZXR1cm4gcmV0OworCX0KKworCWJhdGNoID0g
aTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAod2FfY3R4LT52bWEtPm9iaiwgSTkxNV9NQVBfV0IpOwor
CisJLyoKKwkgKiBFbWl0IHRoZSB0d28gd29ya2Fyb3VuZCBiYXRjaCBidWZmZXJzLCByZWNvcmRp
bmcgdGhlIG9mZnNldCBmcm9tIHRoZQorCSAqIHN0YXJ0IG9mIHRoZSB3b3JrYXJvdW5kIGJhdGNo
IGJ1ZmZlciBvYmplY3QgZm9yIGVhY2ggYW5kIHRoZWlyCisJICogcmVzcGVjdGl2ZSBzaXplcy4K
KwkgKi8KKwliYXRjaF9wdHIgPSBiYXRjaDsKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRSh3
YV9iYl9mbik7IGkrKykgeworCQl3YV9iYltpXS0+b2Zmc2V0ID0gYmF0Y2hfcHRyIC0gYmF0Y2g7
CisJCWlmIChHRU1fREVCVUdfV0FSTl9PTighSVNfQUxJR05FRCh3YV9iYltpXS0+b2Zmc2V0LAor
CQkJCQkJICBDQUNIRUxJTkVfQllURVMpKSkgeworCQkJcmV0ID0gLUVJTlZBTDsKKwkJCWJyZWFr
OworCQl9CisJCWlmICh3YV9iYl9mbltpXSkKKwkJCWJhdGNoX3B0ciA9IHdhX2JiX2ZuW2ldKGVu
Z2luZSwgYmF0Y2hfcHRyKTsKKwkJd2FfYmJbaV0tPnNpemUgPSBiYXRjaF9wdHIgLSAoYmF0Y2gg
KyB3YV9iYltpXS0+b2Zmc2V0KTsKKwl9CisJR0VNX0JVR19PTihiYXRjaF9wdHIgLSBiYXRjaCA+
IENUWF9XQV9CQl9TSVpFKTsKKworCV9faTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcCh3YV9jdHgt
PnZtYS0+b2JqLCAwLCBiYXRjaF9wdHIgLSBiYXRjaCk7CisJX19pOTE1X2dlbV9vYmplY3RfcmVs
ZWFzZV9tYXAod2FfY3R4LT52bWEtPm9iaik7CisJaWYgKHJldCkKKwkJbHJjX2Zpbmlfd2FfY3R4
KGVuZ2luZSk7CisKKwlyZXR1cm4gcmV0OworfQorCisjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJN
X0k5MTVfU0VMRlRFU1QpCisjaW5jbHVkZSAic2VsZnRlc3RfbHJjLmMiCisjZW5kaWYKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi5kMTFhZjZmYTQ4ZGEKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9scmMuaApAQCAtMCwwICsxLDY3IEBACisvKiBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogTUlUICovCisvKgorICogQ29weXJpZ2h0IMKpIDIwMTQgSW50ZWwgQ29ycG9yYXRp
b24KKyAqLworCisjaWZuZGVmIF9fSU5URUxfTFJDX0hfXworI2RlZmluZSBfX0lOVEVMX0xSQ19I
X18KKworI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisKKyNpbmNsdWRlICJpbnRlbF9jb250ZXh0
LmgiCisjaW5jbHVkZSAiaW50ZWxfbHJjX3JlZy5oIgorCitzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdDsKK3N0cnVjdCBpbnRlbF9lbmdpbmVfY3M7CitzdHJ1Y3QgaW50ZWxfcmluZzsKKworLyog
QXQgdGhlIHN0YXJ0IG9mIHRoZSBjb250ZXh0IGltYWdlIGlzIGl0cyBwZXItcHJvY2VzcyBIV1Mg
cGFnZSAqLworI2RlZmluZSBMUkNfUFBIV1NQX1BOCSgwKQorI2RlZmluZSBMUkNfUFBIV1NQX1Na
CSgxKQorLyogQWZ0ZXIgdGhlIFBQSFdTUCB3ZSBoYXZlIHRoZSBsb2dpY2FsIHN0YXRlIGZvciB0
aGUgY29udGV4dCAqLworI2RlZmluZSBMUkNfU1RBVEVfUE4JKExSQ19QUEhXU1BfUE4gKyBMUkNf
UFBIV1NQX1NaKQorI2RlZmluZSBMUkNfU1RBVEVfT0ZGU0VUIChMUkNfU1RBVEVfUE4gKiBQQUdF
X1NJWkUpCisKKy8qIFNwYWNlIHdpdGhpbiBQUEhXU1AgcmVzZXJ2ZWQgdG8gYmUgdXNlZCBhcyBz
Y3JhdGNoICovCisjZGVmaW5lIExSQ19QUEhXU1BfU0NSQVRDSAkJMHgzNAorI2RlZmluZSBMUkNf
UFBIV1NQX1NDUkFUQ0hfQUREUgkJKExSQ19QUEhXU1BfU0NSQVRDSCAqIHNpemVvZih1MzIpKQor
CitpbnQgbHJjX2luaXRfd2FfY3R4KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Cit2
b2lkIGxyY19maW5pX3dhX2N0eChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOworCitp
bnQgbHJjX2FsbG9jKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkgICAgICBzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpOworCit2b2lkIGxyY19yZXN0b3JlX2RlZmF1bHRzKHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJCSAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KTsKKwordm9pZCBscmNfaW5pdF9yZWdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwK
KwkJICAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkgICBjb25zdCBz
dHJ1Y3QgaW50ZWxfcmluZyAqcmluZywKKwkJICAgYm9vbCBjbG9zZSk7Cit2b2lkIGxyY19yZXNl
dF9yZWdzKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKKwkJICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CisKK3UzMiBscmNfdXBkYXRlX3JlZ3MoY29uc3Qg
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lLAorCQkgICAgdTMyIGhlYWQpOwordm9pZCBscmNfdXBkYXRlX29mZnNldHMo
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLAorCQkJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKTsKKwordm9pZCBscmNfY2hlY2tfcmVncyhjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UsCisJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCisJCSAgICBj
b25zdCBjaGFyICp3aGVuKTsKK3ZvaWQgbHJjX2NoZWNrX3JlZHpvbmUoc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlKTsKKworc3RhdGljIGlubGluZSB1MzIgbHJjX2dldF9ydW50aW1lKGNvbnN0IHN0
cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwkvKgorCSAqIFdlIGNhbiB1c2UgZWl0aGVyIHBw
SFdTUFsxNl0gd2hpY2ggaXMgcmVjb3JkZWQgYmVmb3JlIHRoZSBjb250ZXh0CisJICogc3dpdGNo
IChhbmQgc28gZXhjbHVkZXMgdGhlIGNvc3Qgb2YgY29udGV4dCBzd2l0Y2hlcykgb3IgdXNlIHRo
ZQorCSAqIHZhbHVlIGZyb20gdGhlIGNvbnRleHQgaW1hZ2UgaXRzZWxmLCB3aGljaCBpcyBzYXZl
ZC9yZXN0b3JlZCBlYXJsaWVyCisJICogYW5kIHNvIGluY2x1ZGVzIHRoZSBjb3N0IG9mIHRoZSBz
YXZlLgorCSAqLworCXJldHVybiBSRUFEX09OQ0UoY2UtPmxyY19yZWdfc3RhdGVbQ1RYX1RJTUVT
VEFNUF0pOworfQorCisjZW5kaWYgLyogX19JTlRFTF9MUkNfSF9fICovCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmNfcmVnLmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9scmNfcmVnLmgKaW5kZXggYjJlMDNjZTM1NTk5Li42NWZlNzY3MzgzMzUg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyY19yZWcuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmNfcmVnLmgKQEAgLTksNiArOSw4IEBA
CiAKICNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgogCisjZGVmaW5lIENUWF9ERVNDX0ZPUkNFX1JF
U1RPUkUgQklUX1VMTCgyKQorCiAvKiBHRU44IHRvIEdFTjEyIFJlZyBTdGF0ZSBDb250ZXh0ICov
CiAjZGVmaW5lIENUWF9DT05URVhUX0NPTlRST0wJCSgweDAyICsgMSkKICNkZWZpbmUgQ1RYX1JJ
TkdfSEVBRAkJCSgweDA0ICsgMSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X2V4ZWNsaXN0cy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rf
ZXhlY2xpc3RzLmMKaW5kZXggOTVkNDFjMDFkMGUwLi4zNGMyYmI4MzEzZWIgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2V4ZWNsaXN0cy5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2V4ZWNsaXN0cy5jCkBAIC0yNDksNyArMjQ5LDcg
QEAgc3RhdGljIGludCBsaXZlX3VubGl0ZV9yZXN0b3JlKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGlu
dCBwcmlvKQogCQl9CiAJCUdFTV9CVUdfT04oIWNlWzFdLT5yaW5nLT5zaXplKTsKIAkJaW50ZWxf
cmluZ19yZXNldChjZVsxXS0+cmluZywgY2VbMV0tPnJpbmctPnNpemUgLyAyKTsKLQkJX19leGVj
bGlzdHNfdXBkYXRlX3JlZ19zdGF0ZShjZVsxXSwgZW5naW5lLCBjZVsxXS0+cmluZy0+aGVhZCk7
CisJCWxyY191cGRhdGVfcmVncyhjZVsxXSwgZW5naW5lLCBjZVsxXS0+cmluZy0+aGVhZCk7CiAK
IAkJcnFbMF0gPSBpZ3Rfc3Bpbm5lcl9jcmVhdGVfcmVxdWVzdCgmc3BpbiwgY2VbMF0sIE1JX0FS
Ql9DSEVDSyk7CiAJCWlmIChJU19FUlIocnFbMF0pKSB7CkBAIC00NzA1LDE3NzcgKzQ3MDUsMyBA
QCBpbnQgaW50ZWxfZXhlY2xpc3RzX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQogCiAJcmV0dXJuIGludGVsX2d0X2xpdmVfc3VidGVzdHModGVzdHMsICZpOTE1
LT5ndCk7CiB9Ci0KLXN0YXRpYyBpbnQgZW1pdF9zZW1hcGhvcmVfc2lnbmFsKHN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZSwgdm9pZCAqc2xvdCkKLXsKLQljb25zdCB1MzIgb2Zmc2V0ID0KLQkJaTkx
NV9nZ3R0X29mZnNldChjZS0+ZW5naW5lLT5zdGF0dXNfcGFnZS52bWEpICsKLQkJb2Zmc2V0X2lu
X3BhZ2Uoc2xvdCk7Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Ci0JdTMyICpjczsKLQotCXJx
ID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7Ci0JaWYgKElTX0VSUihycSkpCi0J
CXJldHVybiBQVFJfRVJSKHJxKTsKLQotCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgNCk7Ci0J
aWYgKElTX0VSUihjcykpIHsKLQkJaTkxNV9yZXF1ZXN0X2FkZChycSk7Ci0JCXJldHVybiBQVFJf
RVJSKGNzKTsKLQl9Ci0KLQkqY3MrKyA9IE1JX1NUT1JFX0RXT1JEX0lNTV9HRU40IHwgTUlfVVNF
X0dHVFQ7Ci0JKmNzKysgPSBvZmZzZXQ7Ci0JKmNzKysgPSAwOwotCSpjcysrID0gMTsKLQotCWlu
dGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOwotCi0JcnEtPnNjaGVkLmF0dHIucHJpb3JpdHkgPSBJ
OTE1X1BSSU9SSVRZX0JBUlJJRVI7Ci0JaTkxNV9yZXF1ZXN0X2FkZChycSk7Ci0JcmV0dXJuIDA7
Ci19Ci0KLXN0YXRpYyBpbnQgY29udGV4dF9mbHVzaChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Us
IGxvbmcgdGltZW91dCkKLXsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQlzdHJ1Y3QgZG1h
X2ZlbmNlICpmZW5jZTsKLQlpbnQgZXJyID0gMDsKLQotCXJxID0gaW50ZWxfZW5naW5lX2NyZWF0
ZV9rZXJuZWxfcmVxdWVzdChjZS0+ZW5naW5lKTsKLQlpZiAoSVNfRVJSKHJxKSkKLQkJcmV0dXJu
IFBUUl9FUlIocnEpOwotCi0JZmVuY2UgPSBpOTE1X2FjdGl2ZV9mZW5jZV9nZXQoJmNlLT50aW1l
bGluZS0+bGFzdF9yZXF1ZXN0KTsKLQlpZiAoZmVuY2UpIHsKLQkJaTkxNV9yZXF1ZXN0X2F3YWl0
X2RtYV9mZW5jZShycSwgZmVuY2UpOwotCQlkbWFfZmVuY2VfcHV0KGZlbmNlKTsKLQl9Ci0KLQly
cSA9IGk5MTVfcmVxdWVzdF9nZXQocnEpOwotCWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCWlmIChp
OTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgdGltZW91dCkgPCAwKQotCQllcnIgPSAtRVRJTUU7Ci0J
aTkxNV9yZXF1ZXN0X3B1dChycSk7Ci0KLQlybWIoKTsgLyogV2Uga25vdyB0aGUgcmVxdWVzdCBp
cyB3cml0dGVuLCBtYWtlIHN1cmUgYWxsIHN0YXRlIGlzIHRvbyEgKi8KLQlyZXR1cm4gZXJyOwot
fQotCi1zdGF0aWMgaW50IGxpdmVfbHJjX2xheW91dCh2b2lkICphcmcpCi17Ci0Jc3RydWN0IGlu
dGVsX2d0ICpndCA9IGFyZzsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51
bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0JdTMyICpscmM7Ci0JaW50IGVycjsKLQotCS8qCi0JICog
Q2hlY2sgdGhlIHJlZ2lzdGVycyBvZmZzZXRzIHdlIHVzZSB0byBjcmVhdGUgdGhlIGluaXRpYWwg
cmVnIHN0YXRlCi0JICogbWF0Y2ggdGhlIGxheW91dCBzYXZlZCBieSBIVy4KLQkgKi8KLQotCWxy
YyA9IGttYWxsb2MoUEFHRV9TSVpFLCBHRlBfS0VSTkVMKTsKLQlpZiAoIWxyYykKLQkJcmV0dXJu
IC1FTk9NRU07Ci0KLQllcnIgPSAwOwotCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkg
ewotCQl1MzIgKmh3OwotCQlpbnQgZHc7Ci0KLQkJaWYgKCFlbmdpbmUtPmRlZmF1bHRfc3RhdGUp
Ci0JCQljb250aW51ZTsKLQotCQlodyA9IHNobWVtX3Bpbl9tYXAoZW5naW5lLT5kZWZhdWx0X3N0
YXRlKTsKLQkJaWYgKElTX0VSUihodykpIHsKLQkJCWVyciA9IFBUUl9FUlIoaHcpOwotCQkJYnJl
YWs7Ci0JCX0KLQkJaHcgKz0gTFJDX1NUQVRFX09GRlNFVCAvIHNpemVvZigqaHcpOwotCi0JCWV4
ZWNsaXN0c19pbml0X3JlZ19zdGF0ZShtZW1zZXQobHJjLCBQT0lTT05fSU5VU0UsIFBBR0VfU0la
RSksCi0JCQkJCSBlbmdpbmUtPmtlcm5lbF9jb250ZXh0LAotCQkJCQkgZW5naW5lLAotCQkJCQkg
ZW5naW5lLT5rZXJuZWxfY29udGV4dC0+cmluZywKLQkJCQkJIHRydWUpOwotCi0JCWR3ID0gMDsK
LQkJZG8gewotCQkJdTMyIGxyaSA9IGh3W2R3XTsKLQotCQkJaWYgKGxyaSA9PSAwKSB7Ci0JCQkJ
ZHcrKzsKLQkJCQljb250aW51ZTsKLQkJCX0KLQotCQkJaWYgKGxyY1tkd10gPT0gMCkgewotCQkJ
CXByX2RlYnVnKCIlczogc2tpcHBlZCBpbnN0cnVjdGlvbiAleCBhdCBkd29yZCAlZFxuIiwKLQkJ
CQkJIGVuZ2luZS0+bmFtZSwgbHJpLCBkdyk7Ci0JCQkJZHcrKzsKLQkJCQljb250aW51ZTsKLQkJ
CX0KLQotCQkJaWYgKChscmkgJiBHRU5NQVNLKDMxLCAyMykpICE9IE1JX0lOU1RSKDB4MjIsIDAp
KSB7Ci0JCQkJcHJfZXJyKCIlczogRXhwZWN0ZWQgTFJJIGNvbW1hbmQgYXQgZHdvcmQgJWQsIGZv
dW5kICUwOHhcbiIsCi0JCQkJICAgICAgIGVuZ2luZS0+bmFtZSwgZHcsIGxyaSk7Ci0JCQkJZXJy
ID0gLUVJTlZBTDsKLQkJCQlicmVhazsKLQkJCX0KLQotCQkJaWYgKGxyY1tkd10gIT0gbHJpKSB7
Ci0JCQkJcHJfZXJyKCIlczogTFJJIGNvbW1hbmQgbWlzbWF0Y2ggYXQgZHdvcmQgJWQsIGV4cGVj
dGVkICUwOHggZm91bmQgJTA4eFxuIiwKLQkJCQkgICAgICAgZW5naW5lLT5uYW1lLCBkdywgbHJp
LCBscmNbZHddKTsKLQkJCQllcnIgPSAtRUlOVkFMOwotCQkJCWJyZWFrOwotCQkJfQotCi0JCQls
cmkgJj0gMHg3ZjsKLQkJCWxyaSsrOwotCQkJZHcrKzsKLQotCQkJd2hpbGUgKGxyaSkgewotCQkJ
CWlmIChod1tkd10gIT0gbHJjW2R3XSkgewotCQkJCQlwcl9lcnIoIiVzOiBEaWZmZXJlbnQgcmVn
aXN0ZXJzIGZvdW5kIGF0IGR3b3JkICVkLCBleHBlY3RlZCAleCwgZm91bmQgJXhcbiIsCi0JCQkJ
CSAgICAgICBlbmdpbmUtPm5hbWUsIGR3LCBod1tkd10sIGxyY1tkd10pOwotCQkJCQllcnIgPSAt
RUlOVkFMOwotCQkJCQlicmVhazsKLQkJCQl9Ci0KLQkJCQkvKgotCQkJCSAqIFNraXAgb3ZlciB0
aGUgYWN0dWFsIHJlZ2lzdGVyIHZhbHVlIGFzIHdlCi0JCQkJICogZXhwZWN0IHRoYXQgdG8gZGlm
ZmVyLgotCQkJCSAqLwotCQkJCWR3ICs9IDI7Ci0JCQkJbHJpIC09IDI7Ci0JCQl9Ci0JCX0gd2hp
bGUgKChscmNbZHddICYgfkJJVCgwKSkgIT0gTUlfQkFUQ0hfQlVGRkVSX0VORCk7Ci0KLQkJaWYg
KGVycikgewotCQkJcHJfaW5mbygiJXM6IEhXIHJlZ2lzdGVyIGltYWdlOlxuIiwgZW5naW5lLT5u
YW1lKTsKLQkJCWlndF9oZXhkdW1wKGh3LCBQQUdFX1NJWkUpOwotCi0JCQlwcl9pbmZvKCIlczog
U1cgcmVnaXN0ZXIgaW1hZ2U6XG4iLCBlbmdpbmUtPm5hbWUpOwotCQkJaWd0X2hleGR1bXAobHJj
LCBQQUdFX1NJWkUpOwotCQl9Ci0KLQkJc2htZW1fdW5waW5fbWFwKGVuZ2luZS0+ZGVmYXVsdF9z
dGF0ZSwgaHcpOwotCQlpZiAoZXJyKQotCQkJYnJlYWs7Ci0JfQotCi0Ja2ZyZWUobHJjKTsKLQly
ZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IGZpbmRfb2Zmc2V0KGNvbnN0IHUzMiAqbHJpLCB1
MzIgb2Zmc2V0KQotewotCWludCBpOwotCi0JZm9yIChpID0gMDsgaSA8IFBBR0VfU0laRSAvIHNp
emVvZih1MzIpOyBpKyspCi0JCWlmIChscmlbaV0gPT0gb2Zmc2V0KQotCQkJcmV0dXJuIGk7Ci0K
LQlyZXR1cm4gLTE7Ci19Ci0KLXN0YXRpYyBpbnQgbGl2ZV9scmNfZml4ZWQodm9pZCAqYXJnKQot
ewotCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwotCWludCBlcnIgPSAwOwotCi0JLyoK
LQkgKiBDaGVjayB0aGUgYXNzdW1lZCByZWdpc3RlciBvZmZzZXRzIG1hdGNoIHRoZSBhY3R1YWwg
bG9jYXRpb25zIGluCi0JICogdGhlIGNvbnRleHQgaW1hZ2UuCi0JICovCi0KLQlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBndCwgaWQpIHsKLQkJY29uc3Qgc3RydWN0IHsKLQkJCXUzMiByZWc7Ci0J
CQl1MzIgb2Zmc2V0OwotCQkJY29uc3QgY2hhciAqbmFtZTsKLQkJfSB0YmxbXSA9IHsKLQkJCXsK
LQkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX1NUQVJUKGVuZ2luZS0+bW1pb19iYXNlKSks
Ci0JCQkJQ1RYX1JJTkdfU1RBUlQgLSAxLAotCQkJCSJSSU5HX1NUQVJUIgotCQkJfSwKLQkJCXsK
LQkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0NUTChlbmdpbmUtPm1taW9fYmFzZSkpLAot
CQkJCUNUWF9SSU5HX0NUTCAtIDEsCi0JCQkJIlJJTkdfQ1RMIgotCQkJfSwKLQkJCXsKLQkJCQlp
OTE1X21taW9fcmVnX29mZnNldChSSU5HX0hFQUQoZW5naW5lLT5tbWlvX2Jhc2UpKSwKLQkJCQlD
VFhfUklOR19IRUFEIC0gMSwKLQkJCQkiUklOR19IRUFEIgotCQkJfSwKLQkJCXsKLQkJCQlpOTE1
X21taW9fcmVnX29mZnNldChSSU5HX1RBSUwoZW5naW5lLT5tbWlvX2Jhc2UpKSwKLQkJCQlDVFhf
UklOR19UQUlMIC0gMSwKLQkJCQkiUklOR19UQUlMIgotCQkJfSwKLQkJCXsKLQkJCQlpOTE1X21t
aW9fcmVnX29mZnNldChSSU5HX01JX01PREUoZW5naW5lLT5tbWlvX2Jhc2UpKSwKLQkJCQlscmNf
cmluZ19taV9tb2RlKGVuZ2luZSksCi0JCQkJIlJJTkdfTUlfTU9ERSIKLQkJCX0sCi0JCQl7Ci0J
CQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19CQlNUQVRFKGVuZ2luZS0+bW1pb19iYXNlKSks
Ci0JCQkJQ1RYX0JCX1NUQVRFIC0gMSwKLQkJCQkiQkJfU1RBVEUiCi0JCQl9LAotCQkJewotCQkJ
CWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfQkJfUEVSX0NUWF9QVFIoZW5naW5lLT5tbWlvX2Jh
c2UpKSwKLQkJCQlscmNfcmluZ193YV9iYl9wZXJfY3R4KGVuZ2luZSksCi0JCQkJIlJJTkdfQkJf
UEVSX0NUWF9QVFIiCi0JCQl9LAotCQkJewotCQkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdf
SU5ESVJFQ1RfQ1RYKGVuZ2luZS0+bW1pb19iYXNlKSksCi0JCQkJbHJjX3JpbmdfaW5kaXJlY3Rf
cHRyKGVuZ2luZSksCi0JCQkJIlJJTkdfSU5ESVJFQ1RfQ1RYX1BUUiIKLQkJCX0sCi0JCQl7Ci0J
CQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19JTkRJUkVDVF9DVFhfT0ZGU0VUKGVuZ2luZS0+
bW1pb19iYXNlKSksCi0JCQkJbHJjX3JpbmdfaW5kaXJlY3Rfb2Zmc2V0KGVuZ2luZSksCi0JCQkJ
IlJJTkdfSU5ESVJFQ1RfQ1RYX09GRlNFVCIKLQkJCX0sCi0JCQl7Ci0JCQkJaTkxNV9tbWlvX3Jl
Z19vZmZzZXQoUklOR19DVFhfVElNRVNUQU1QKGVuZ2luZS0+bW1pb19iYXNlKSksCi0JCQkJQ1RY
X1RJTUVTVEFNUCAtIDEsCi0JCQkJIlJJTkdfQ1RYX1RJTUVTVEFNUCIKLQkJCX0sCi0JCQl7Ci0J
CQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoR0VOOF9SSU5HX0NTX0dQUihlbmdpbmUtPm1taW9fYmFz
ZSwgMCkpLAotCQkJCWxyY19yaW5nX2dwcjAoZW5naW5lKSwKLQkJCQkiUklOR19DU19HUFIwIgot
CQkJfSwKLQkJCXsKLQkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0NNRF9CVUZfQ0NUTChl
bmdpbmUtPm1taW9fYmFzZSkpLAotCQkJCWxyY19yaW5nX2NtZF9idWZfY2N0bChlbmdpbmUpLAot
CQkJCSJSSU5HX0NNRF9CVUZfQ0NUTCIKLQkJCX0sCi0JCQl7IH0sCi0JCX0sICp0OwotCQl1MzIg
Kmh3OwotCi0JCWlmICghZW5naW5lLT5kZWZhdWx0X3N0YXRlKQotCQkJY29udGludWU7Ci0KLQkJ
aHcgPSBzaG1lbV9waW5fbWFwKGVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSk7Ci0JCWlmIChJU19FUlIo
aHcpKSB7Ci0JCQllcnIgPSBQVFJfRVJSKGh3KTsKLQkJCWJyZWFrOwotCQl9Ci0JCWh3ICs9IExS
Q19TVEFURV9PRkZTRVQgLyBzaXplb2YoKmh3KTsKLQotCQlmb3IgKHQgPSB0Ymw7IHQtPm5hbWU7
IHQrKykgewotCQkJaW50IGR3ID0gZmluZF9vZmZzZXQoaHcsIHQtPnJlZyk7Ci0KLQkJCWlmIChk
dyAhPSB0LT5vZmZzZXQpIHsKLQkJCQlwcl9lcnIoIiVzOiBPZmZzZXQgZm9yICVzIFsweCV4XSBt
aXNtYXRjaCwgZm91bmQgJXgsIGV4cGVjdGVkICV4XG4iLAotCQkJCSAgICAgICBlbmdpbmUtPm5h
bWUsCi0JCQkJICAgICAgIHQtPm5hbWUsCi0JCQkJICAgICAgIHQtPnJlZywKLQkJCQkgICAgICAg
ZHcsCi0JCQkJICAgICAgIHQtPm9mZnNldCk7Ci0JCQkJZXJyID0gLUVJTlZBTDsKLQkJCX0KLQkJ
fQotCi0JCXNobWVtX3VucGluX21hcChlbmdpbmUtPmRlZmF1bHRfc3RhdGUsIGh3KTsKLQl9Ci0K
LQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IF9fbGl2ZV9scmNfc3RhdGUoc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJICAgIHN0cnVjdCBpOTE1X3ZtYSAqc2NyYXRjaCkK
LXsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7
Ci0Jc3RydWN0IGk5MTVfZ2VtX3d3X2N0eCB3dzsKLQllbnVtIHsKLQkJUklOR19TVEFSVF9JRFgg
PSAwLAotCQlSSU5HX1RBSUxfSURYLAotCQlNQVhfSURYCi0JfTsKLQl1MzIgZXhwZWN0ZWRbTUFY
X0lEWF07Ci0JdTMyICpjczsKLQlpbnQgZXJyOwotCWludCBuOwotCi0JY2UgPSBpbnRlbF9jb250
ZXh0X2NyZWF0ZShlbmdpbmUpOwotCWlmIChJU19FUlIoY2UpKQotCQlyZXR1cm4gUFRSX0VSUihj
ZSk7Ci0KLQlpOTE1X2dlbV93d19jdHhfaW5pdCgmd3csIGZhbHNlKTsKLXJldHJ5OgotCWVyciA9
IGk5MTVfZ2VtX29iamVjdF9sb2NrKHNjcmF0Y2gtPm9iaiwgJnd3KTsKLQlpZiAoIWVycikKLQkJ
ZXJyID0gaW50ZWxfY29udGV4dF9waW5fd3coY2UsICZ3dyk7Ci0JaWYgKGVycikKLQkJZ290byBl
cnJfcHV0OwotCi0JcnEgPSBpOTE1X3JlcXVlc3RfY3JlYXRlKGNlKTsKLQlpZiAoSVNfRVJSKHJx
KSkgewotCQllcnIgPSBQVFJfRVJSKHJxKTsKLQkJZ290byBlcnJfdW5waW47Ci0JfQotCi0JY3Mg
PSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA0ICogTUFYX0lEWCk7Ci0JaWYgKElTX0VSUihjcykpIHsK
LQkJZXJyID0gUFRSX0VSUihjcyk7Ci0JCWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCQlnb3RvIGVy
cl91bnBpbjsKLQl9Ci0KLQkqY3MrKyA9IE1JX1NUT1JFX1JFR0lTVEVSX01FTV9HRU44IHwgTUlf
VVNFX0dHVFQ7Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX1NUQVJUKGVuZ2lu
ZS0+bW1pb19iYXNlKSk7Ci0JKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KHNjcmF0Y2gpICsgUklO
R19TVEFSVF9JRFggKiBzaXplb2YodTMyKTsKLQkqY3MrKyA9IDA7Ci0KLQlleHBlY3RlZFtSSU5H
X1NUQVJUX0lEWF0gPSBpOTE1X2dndHRfb2Zmc2V0KGNlLT5yaW5nLT52bWEpOwotCi0JKmNzKysg
PSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1VTRV9HR1RUOwotCSpjcysrID0gaTkx
NV9tbWlvX3JlZ19vZmZzZXQoUklOR19UQUlMKGVuZ2luZS0+bW1pb19iYXNlKSk7Ci0JKmNzKysg
PSBpOTE1X2dndHRfb2Zmc2V0KHNjcmF0Y2gpICsgUklOR19UQUlMX0lEWCAqIHNpemVvZih1MzIp
OwotCSpjcysrID0gMDsKLQotCWVyciA9IGk5MTVfcmVxdWVzdF9hd2FpdF9vYmplY3QocnEsIHNj
cmF0Y2gtPm9iaiwgdHJ1ZSk7Ci0JaWYgKCFlcnIpCi0JCWVyciA9IGk5MTVfdm1hX21vdmVfdG9f
YWN0aXZlKHNjcmF0Y2gsIHJxLCBFWEVDX09CSkVDVF9XUklURSk7Ci0KLQlpOTE1X3JlcXVlc3Rf
Z2V0KHJxKTsKLQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycl9y
cTsKLQotCWludGVsX2VuZ2luZV9mbHVzaF9zdWJtaXNzaW9uKGVuZ2luZSk7Ci0JZXhwZWN0ZWRb
UklOR19UQUlMX0lEWF0gPSBjZS0+cmluZy0+dGFpbDsKLQotCWlmIChpOTE1X3JlcXVlc3Rfd2Fp
dChycSwgMCwgSFogLyA1KSA8IDApIHsKLQkJZXJyID0gLUVUSU1FOwotCQlnb3RvIGVycl9ycTsK
LQl9Ci0KLQljcyA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKHNjcmF0Y2gtPm9iaiwgSTkxNV9N
QVBfV0IpOwotCWlmIChJU19FUlIoY3MpKSB7Ci0JCWVyciA9IFBUUl9FUlIoY3MpOwotCQlnb3Rv
IGVycl9ycTsKLQl9Ci0KLQlmb3IgKG4gPSAwOyBuIDwgTUFYX0lEWDsgbisrKSB7Ci0JCWlmIChj
c1tuXSAhPSBleHBlY3RlZFtuXSkgewotCQkJcHJfZXJyKCIlczogU3RvcmVkIHJlZ2lzdGVyWyVk
XSB2YWx1ZVsweCV4XSBkaWQgbm90IG1hdGNoIGV4cGVjdGVkWzB4JXhdXG4iLAotCQkJICAgICAg
IGVuZ2luZS0+bmFtZSwgbiwgY3Nbbl0sIGV4cGVjdGVkW25dKTsKLQkJCWVyciA9IC1FSU5WQUw7
Ci0JCQlicmVhazsKLQkJfQotCX0KLQotCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoc2NyYXRj
aC0+b2JqKTsKLQotZXJyX3JxOgotCWk5MTVfcmVxdWVzdF9wdXQocnEpOwotZXJyX3VucGluOgot
CWludGVsX2NvbnRleHRfdW5waW4oY2UpOwotZXJyX3B1dDoKLQlpZiAoZXJyID09IC1FREVBRExL
KSB7Ci0JCWVyciA9IGk5MTVfZ2VtX3d3X2N0eF9iYWNrb2ZmKCZ3dyk7Ci0JCWlmICghZXJyKQot
CQkJZ290byByZXRyeTsKLQl9Ci0JaTkxNV9nZW1fd3dfY3R4X2ZpbmkoJnd3KTsKLQlpbnRlbF9j
b250ZXh0X3B1dChjZSk7Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIGludCBsaXZlX2xyY19z
dGF0ZSh2b2lkICphcmcpCi17Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKLQlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0Jc3RydWN0IGk5MTVfdm1hICpzY3JhdGNoOwotCWVu
dW0gaW50ZWxfZW5naW5lX2lkIGlkOwotCWludCBlcnIgPSAwOwotCi0JLyoKLQkgKiBDaGVjayB0
aGUgbGl2ZSByZWdpc3RlciBzdGF0ZSBtYXRjaGVzIHdoYXQgd2UgZXhwZWN0IGZvciB0aGlzCi0J
ICogaW50ZWxfY29udGV4dC4KLQkgKi8KLQotCXNjcmF0Y2ggPSBjcmVhdGVfc2NyYXRjaChndCk7
Ci0JaWYgKElTX0VSUihzY3JhdGNoKSkKLQkJcmV0dXJuIFBUUl9FUlIoc2NyYXRjaCk7Ci0KLQlm
b3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQpIHsKLQkJZXJyID0gX19saXZlX2xyY19zdGF0
ZShlbmdpbmUsIHNjcmF0Y2gpOwotCQlpZiAoZXJyKQotCQkJYnJlYWs7Ci0JfQotCi0JaWYgKGln
dF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKLQkJZXJyID0gLUVJTzsKLQotCWk5MTVfdm1hX3VucGlu
X2FuZF9yZWxlYXNlKCZzY3JhdGNoLCAwKTsKLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgaW50
IGdwcl9tYWtlX2RpcnR5KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKLXsKLQlzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycTsKLQl1MzIgKmNzOwotCWludCBuOwotCi0JcnEgPSBpbnRlbF9jb250ZXh0
X2NyZWF0ZV9yZXF1ZXN0KGNlKTsKLQlpZiAoSVNfRVJSKHJxKSkKLQkJcmV0dXJuIFBUUl9FUlIo
cnEpOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCAyICogTlVNX0dQUl9EVyArIDIpOwot
CWlmIChJU19FUlIoY3MpKSB7Ci0JCWk5MTVfcmVxdWVzdF9hZGQocnEpOwotCQlyZXR1cm4gUFRS
X0VSUihjcyk7Ci0JfQotCi0JKmNzKysgPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShOVU1fR1BSX0RX
KTsKLQlmb3IgKG4gPSAwOyBuIDwgTlVNX0dQUl9EVzsgbisrKSB7Ci0JCSpjcysrID0gQ1NfR1BS
KGNlLT5lbmdpbmUsIG4pOwotCQkqY3MrKyA9IFNUQUNLX01BR0lDOwotCX0KLQkqY3MrKyA9IE1J
X05PT1A7Ci0KLQlpbnRlbF9yaW5nX2FkdmFuY2UocnEsIGNzKTsKLQotCXJxLT5zY2hlZC5hdHRy
LnByaW9yaXR5ID0gSTkxNV9QUklPUklUWV9CQVJSSUVSOwotCWk5MTVfcmVxdWVzdF9hZGQocnEp
OwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoKLV9fZ3By
X3JlYWQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2gs
IHUzMiAqc2xvdCkKLXsKLQljb25zdCB1MzIgb2Zmc2V0ID0KLQkJaTkxNV9nZ3R0X29mZnNldChj
ZS0+ZW5naW5lLT5zdGF0dXNfcGFnZS52bWEpICsKLQkJb2Zmc2V0X2luX3BhZ2Uoc2xvdCk7Ci0J
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Ci0JdTMyICpjczsKLQlpbnQgZXJyOwotCWludCBuOwot
Ci0JcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KGNlKTsKLQlpZiAoSVNfRVJSKHJx
KSkKLQkJcmV0dXJuIHJxOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCA2ICsgNCAqIE5V
TV9HUFJfRFcpOwotCWlmIChJU19FUlIoY3MpKSB7Ci0JCWk5MTVfcmVxdWVzdF9hZGQocnEpOwot
CQlyZXR1cm4gRVJSX0NBU1QoY3MpOwotCX0KLQotCSpjcysrID0gTUlfQVJCX09OX09GRiB8IE1J
X0FSQl9FTkFCTEU7Ci0JKmNzKysgPSBNSV9OT09QOwotCi0JKmNzKysgPSBNSV9TRU1BUEhPUkVf
V0FJVCB8Ci0JCU1JX1NFTUFQSE9SRV9HTE9CQUxfR1RUIHwKLQkJTUlfU0VNQVBIT1JFX1BPTEwg
fAotCQlNSV9TRU1BUEhPUkVfU0FEX05FUV9TREQ7Ci0JKmNzKysgPSAwOwotCSpjcysrID0gb2Zm
c2V0OwotCSpjcysrID0gMDsKLQotCWZvciAobiA9IDA7IG4gPCBOVU1fR1BSX0RXOyBuKyspIHsK
LQkJKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1VTRV9HR1RUOwotCQkq
Y3MrKyA9IENTX0dQUihjZS0+ZW5naW5lLCBuKTsKLQkJKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0
KHNjcmF0Y2gpICsgbiAqIHNpemVvZih1MzIpOwotCQkqY3MrKyA9IDA7Ci0JfQotCi0JaTkxNV92
bWFfbG9jayhzY3JhdGNoKTsKLQllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfb2JqZWN0KHJxLCBz
Y3JhdGNoLT5vYmosIHRydWUpOwotCWlmICghZXJyKQotCQllcnIgPSBpOTE1X3ZtYV9tb3ZlX3Rv
X2FjdGl2ZShzY3JhdGNoLCBycSwgRVhFQ19PQkpFQ1RfV1JJVEUpOwotCWk5MTVfdm1hX3VubG9j
ayhzY3JhdGNoKTsKLQotCWk5MTVfcmVxdWVzdF9nZXQocnEpOwotCWk5MTVfcmVxdWVzdF9hZGQo
cnEpOwotCWlmIChlcnIpIHsKLQkJaTkxNV9yZXF1ZXN0X3B1dChycSk7Ci0JCXJxID0gRVJSX1BU
UihlcnIpOwotCX0KLQotCXJldHVybiBycTsKLX0KLQotc3RhdGljIGludCBfX2xpdmVfbHJjX2dw
cihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkgIHN0cnVjdCBpOTE1X3ZtYSAq
c2NyYXRjaCwKLQkJCSAgYm9vbCBwcmVlbXB0KQotewotCXUzMiAqc2xvdCA9IG1lbXNldDMyKGVu
Z2luZS0+c3RhdHVzX3BhZ2UuYWRkciArIDEwMDAsIDAsIDQpOwotCXN0cnVjdCBpbnRlbF9jb250
ZXh0ICpjZTsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQl1MzIgKmNzOwotCWludCBlcnI7
Ci0JaW50IG47Ci0KLQlpZiAoSU5URUxfR0VOKGVuZ2luZS0+aTkxNSkgPCA5ICYmIGVuZ2luZS0+
Y2xhc3MgIT0gUkVOREVSX0NMQVNTKQotCQlyZXR1cm4gMDsgLyogR1BSIG9ubHkgb24gcmNzMCBm
b3IgZ2VuOCAqLwotCi0JZXJyID0gZ3ByX21ha2VfZGlydHkoZW5naW5lLT5rZXJuZWxfY29udGV4
dCk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVycjsKLQotCWNlID0gaW50ZWxfY29udGV4dF9jcmVh
dGUoZW5naW5lKTsKLQlpZiAoSVNfRVJSKGNlKSkKLQkJcmV0dXJuIFBUUl9FUlIoY2UpOwotCi0J
cnEgPSBfX2dwcl9yZWFkKGNlLCBzY3JhdGNoLCBzbG90KTsKLQlpZiAoSVNfRVJSKHJxKSkgewot
CQllcnIgPSBQVFJfRVJSKHJxKTsKLQkJZ290byBlcnJfcHV0OwotCX0KLQotCWVyciA9IHdhaXRf
Zm9yX3N1Ym1pdChlbmdpbmUsIHJxLCBIWiAvIDIpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyX3Jx
OwotCi0JaWYgKHByZWVtcHQpIHsKLQkJZXJyID0gZ3ByX21ha2VfZGlydHkoZW5naW5lLT5rZXJu
ZWxfY29udGV4dCk7Ci0JCWlmIChlcnIpCi0JCQlnb3RvIGVycl9ycTsKLQotCQllcnIgPSBlbWl0
X3NlbWFwaG9yZV9zaWduYWwoZW5naW5lLT5rZXJuZWxfY29udGV4dCwgc2xvdCk7Ci0JCWlmIChl
cnIpCi0JCQlnb3RvIGVycl9ycTsKLQl9IGVsc2UgewotCQlzbG90WzBdID0gMTsKLQkJd21iKCk7
Ci0JfQotCi0JaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDUpIDwgMCkgewotCQll
cnIgPSAtRVRJTUU7Ci0JCWdvdG8gZXJyX3JxOwotCX0KLQotCWNzID0gaTkxNV9nZW1fb2JqZWN0
X3Bpbl9tYXAoc2NyYXRjaC0+b2JqLCBJOTE1X01BUF9XQik7Ci0JaWYgKElTX0VSUihjcykpIHsK
LQkJZXJyID0gUFRSX0VSUihjcyk7Ci0JCWdvdG8gZXJyX3JxOwotCX0KLQotCWZvciAobiA9IDA7
IG4gPCBOVU1fR1BSX0RXOyBuKyspIHsKLQkJaWYgKGNzW25dKSB7Ci0JCQlwcl9lcnIoIiVzOiBH
UFJbJWRdLiVzIHdhcyBub3QgemVybywgZm91bmQgMHglMDh4IVxuIiwKLQkJCSAgICAgICBlbmdp
bmUtPm5hbWUsCi0JCQkgICAgICAgbiAvIDIsIG4gJiAxID8gInVkdyIgOiAibGR3IiwKLQkJCSAg
ICAgICBjc1tuXSk7Ci0JCQllcnIgPSAtRUlOVkFMOwotCQkJYnJlYWs7Ci0JCX0KLQl9Ci0KLQlp
OTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHNjcmF0Y2gtPm9iaik7Ci0KLWVycl9ycToKLQltZW1z
ZXQzMigmc2xvdFswXSwgLTEsIDQpOwotCXdtYigpOwotCWk5MTVfcmVxdWVzdF9wdXQocnEpOwot
ZXJyX3B1dDoKLQlpbnRlbF9jb250ZXh0X3B1dChjZSk7Ci0JcmV0dXJuIGVycjsKLX0KLQotc3Rh
dGljIGludCBsaXZlX2xyY19ncHIodm9pZCAqYXJnKQotewotCXN0cnVjdCBpbnRlbF9ndCAqZ3Qg
PSBhcmc7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCXN0cnVjdCBpOTE1X3Zt
YSAqc2NyYXRjaDsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKLQlpbnQgZXJyID0gMDsKLQot
CS8qCi0JICogQ2hlY2sgdGhhdCBHUFIgcmVnaXN0ZXJzIGFyZSBjbGVhcmVkIGluIG5ldyBjb250
ZXh0cyBhcyB3ZSBuZWVkCi0JICogdG8gYXZvaWQgbGVha2luZyBhbnkgaW5mb3JtYXRpb24gZnJv
bSBwcmV2aW91cyBjb250ZXh0cy4KLQkgKi8KLQotCXNjcmF0Y2ggPSBjcmVhdGVfc2NyYXRjaChn
dCk7Ci0JaWYgKElTX0VSUihzY3JhdGNoKSkKLQkJcmV0dXJuIFBUUl9FUlIoc2NyYXRjaCk7Ci0K
LQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQpIHsKLQkJc3RfZW5naW5lX2hlYXJ0YmVh
dF9kaXNhYmxlKGVuZ2luZSk7Ci0KLQkJZXJyID0gX19saXZlX2xyY19ncHIoZW5naW5lLCBzY3Jh
dGNoLCBmYWxzZSk7Ci0JCWlmIChlcnIpCi0JCQlnb3RvIGVycjsKLQotCQllcnIgPSBfX2xpdmVf
bHJjX2dwcihlbmdpbmUsIHNjcmF0Y2gsIHRydWUpOwotCQlpZiAoZXJyKQotCQkJZ290byBlcnI7
Ci0KLWVycjoKLQkJc3RfZW5naW5lX2hlYXJ0YmVhdF9lbmFibGUoZW5naW5lKTsKLQkJaWYgKGln
dF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKLQkJCWVyciA9IC1FSU87Ci0JCWlmIChlcnIpCi0JCQli
cmVhazsKLQl9Ci0KLQlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgmc2NyYXRjaCwgMCk7Ci0J
cmV0dXJuIGVycjsKLX0KLQotc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgotY3JlYXRlX3Rp
bWVzdGFtcChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHZvaWQgKnNsb3QsIGludCBpZHgpCi17
Ci0JY29uc3QgdTMyIG9mZnNldCA9Ci0JCWk5MTVfZ2d0dF9vZmZzZXQoY2UtPmVuZ2luZS0+c3Rh
dHVzX3BhZ2Uudm1hKSArCi0JCW9mZnNldF9pbl9wYWdlKHNsb3QpOwotCXN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxOwotCXUzMiAqY3M7Ci0JaW50IGVycjsKLQotCXJxID0gaW50ZWxfY29udGV4dF9j
cmVhdGVfcmVxdWVzdChjZSk7Ci0JaWYgKElTX0VSUihycSkpCi0JCXJldHVybiBycTsKLQotCWNz
ID0gaW50ZWxfcmluZ19iZWdpbihycSwgMTApOwotCWlmIChJU19FUlIoY3MpKSB7Ci0JCWVyciA9
IFBUUl9FUlIoY3MpOwotCQlnb3RvIGVycjsKLQl9Ci0KLQkqY3MrKyA9IE1JX0FSQl9PTl9PRkYg
fCBNSV9BUkJfRU5BQkxFOwotCSpjcysrID0gTUlfTk9PUDsKLQotCSpjcysrID0gTUlfU0VNQVBI
T1JFX1dBSVQgfAotCQlNSV9TRU1BUEhPUkVfR0xPQkFMX0dUVCB8Ci0JCU1JX1NFTUFQSE9SRV9Q
T0xMIHwKLQkJTUlfU0VNQVBIT1JFX1NBRF9ORVFfU0REOwotCSpjcysrID0gMDsKLQkqY3MrKyA9
IG9mZnNldDsKLQkqY3MrKyA9IDA7Ci0KLQkqY3MrKyA9IE1JX1NUT1JFX1JFR0lTVEVSX01FTV9H
RU44IHwgTUlfVVNFX0dHVFQ7Ci0JKmNzKysgPSBpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0NU
WF9USU1FU1RBTVAocnEtPmVuZ2luZS0+bW1pb19iYXNlKSk7Ci0JKmNzKysgPSBvZmZzZXQgKyBp
ZHggKiBzaXplb2YodTMyKTsKLQkqY3MrKyA9IDA7Ci0KLQlpbnRlbF9yaW5nX2FkdmFuY2UocnEs
IGNzKTsKLQotCXJxLT5zY2hlZC5hdHRyLnByaW9yaXR5ID0gSTkxNV9QUklPUklUWV9NQVNLOwot
CWVyciA9IDA7Ci1lcnI6Ci0JaTkxNV9yZXF1ZXN0X2dldChycSk7Ci0JaTkxNV9yZXF1ZXN0X2Fk
ZChycSk7Ci0JaWYgKGVycikgewotCQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKLQkJcmV0dXJuIEVS
Ul9QVFIoZXJyKTsKLQl9Ci0KLQlyZXR1cm4gcnE7Ci19Ci0KLXN0cnVjdCBscmNfdGltZXN0YW1w
IHsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0Jc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlWzJdOwotCXUzMiBwb2lzb247Ci19OwotCi1zdGF0aWMgYm9vbCB0aW1lc3RhbXBfYWR2
YW5jZWQodTMyIHN0YXJ0LCB1MzIgZW5kKQotewotCXJldHVybiAoczMyKShlbmQgLSBzdGFydCkg
PiAwOwotfQotCi1zdGF0aWMgaW50IF9fbHJjX3RpbWVzdGFtcChjb25zdCBzdHJ1Y3QgbHJjX3Rp
bWVzdGFtcCAqYXJnLCBib29sIHByZWVtcHQpCi17Ci0JdTMyICpzbG90ID0gbWVtc2V0MzIoYXJn
LT5lbmdpbmUtPnN0YXR1c19wYWdlLmFkZHIgKyAxMDAwLCAwLCA0KTsKLQlzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycTsKLQl1MzIgdGltZXN0YW1wOwotCWludCBlcnIgPSAwOwotCi0JYXJnLT5jZVsw
XS0+bHJjX3JlZ19zdGF0ZVtDVFhfVElNRVNUQU1QXSA9IGFyZy0+cG9pc29uOwotCXJxID0gY3Jl
YXRlX3RpbWVzdGFtcChhcmctPmNlWzBdLCBzbG90LCAxKTsKLQlpZiAoSVNfRVJSKHJxKSkKLQkJ
cmV0dXJuIFBUUl9FUlIocnEpOwotCi0JZXJyID0gd2FpdF9mb3Jfc3VibWl0KHJxLT5lbmdpbmUs
IHJxLCBIWiAvIDIpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyOwotCi0JaWYgKHByZWVtcHQpIHsK
LQkJYXJnLT5jZVsxXS0+bHJjX3JlZ19zdGF0ZVtDVFhfVElNRVNUQU1QXSA9IDB4ZGVhZGJlZWY7
Ci0JCWVyciA9IGVtaXRfc2VtYXBob3JlX3NpZ25hbChhcmctPmNlWzFdLCBzbG90KTsKLQkJaWYg
KGVycikKLQkJCWdvdG8gZXJyOwotCX0gZWxzZSB7Ci0JCXNsb3RbMF0gPSAxOwotCQl3bWIoKTsK
LQl9Ci0KLQkvKiBBbmQgd2FpdCBmb3Igc3dpdGNoIHRvIGtlcm5lbCAodG8gc2F2ZSBvdXIgY29u
dGV4dCB0byBtZW1vcnkpICovCi0JZXJyID0gY29udGV4dF9mbHVzaChhcmctPmNlWzBdLCBIWiAv
IDIpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyOwotCi0JaWYgKCF0aW1lc3RhbXBfYWR2YW5jZWQo
YXJnLT5wb2lzb24sIHNsb3RbMV0pKSB7Ci0JCXByX2VycigiJXMoJXMpOiBpbnZhbGlkIHRpbWVz
dGFtcCBvbiByZXN0b3JlLCBjb250ZXh0OiV4LCByZXF1ZXN0OiV4XG4iLAotCQkgICAgICAgYXJn
LT5lbmdpbmUtPm5hbWUsIHByZWVtcHQgPyAicHJlZW1wdCIgOiAic2ltcGxlIiwKLQkJICAgICAg
IGFyZy0+cG9pc29uLCBzbG90WzFdKTsKLQkJZXJyID0gLUVJTlZBTDsKLQl9Ci0KLQl0aW1lc3Rh
bXAgPSBSRUFEX09OQ0UoYXJnLT5jZVswXS0+bHJjX3JlZ19zdGF0ZVtDVFhfVElNRVNUQU1QXSk7
Ci0JaWYgKCF0aW1lc3RhbXBfYWR2YW5jZWQoc2xvdFsxXSwgdGltZXN0YW1wKSkgewotCQlwcl9l
cnIoIiVzKCVzKTogaW52YWxpZCB0aW1lc3RhbXAgb24gc2F2ZSwgcmVxdWVzdDoleCwgY29udGV4
dDoleFxuIiwKLQkJICAgICAgIGFyZy0+ZW5naW5lLT5uYW1lLCBwcmVlbXB0ID8gInByZWVtcHQi
IDogInNpbXBsZSIsCi0JCSAgICAgICBzbG90WzFdLCB0aW1lc3RhbXApOwotCQllcnIgPSAtRUlO
VkFMOwotCX0KLQotZXJyOgotCW1lbXNldDMyKHNsb3QsIC0xLCA0KTsKLQlpOTE1X3JlcXVlc3Rf
cHV0KHJxKTsKLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IGxpdmVfbHJjX3RpbWVzdGFt
cCh2b2lkICphcmcpCi17Ci0Jc3RydWN0IGxyY190aW1lc3RhbXAgZGF0YSA9IHt9OwotCXN0cnVj
dCBpbnRlbF9ndCAqZ3QgPSBhcmc7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0JY29uc3Qg
dTMyIHBvaXNvbltdID0gewotCQkwLAotCQlTMzJfTUFYLAotCQkodTMyKVMzMl9NQVggKyAxLAot
CQlVMzJfTUFYLAotCX07Ci0KLQkvKgotCSAqIFdlIHdhbnQgdG8gdmVyaWZ5IHRoYXQgdGhlIHRp
bWVzdGFtcCBpcyBzYXZlZCBhbmQgcmVzdG9yZSBhY3Jvc3MKLQkgKiBjb250ZXh0IHN3aXRjaGVz
IGFuZCBpcyBtb25vdG9uaWMuCi0JICoKLQkgKiBTbyB3ZSBkbyB0aGlzIHdpdGggYSBsaXR0bGUg
Yml0IG9mIExSQyBwb2lzb25pbmcgdG8gY2hlY2sgdmFyaW91cwotCSAqIGJvdW5kYXJ5IGNvbmRp
dGlvbnMsIGFuZCBzZWUgd2hhdCBoYXBwZW5zIGlmIHdlIHByZWVtcHQgdGhlIGNvbnRleHQKLQkg
KiB3aXRoIGEgc2Vjb25kIHJlcXVlc3QgKGNhcnJ5aW5nIG1vcmUgcG9pc29uIGludG8gdGhlIHRp
bWVzdGFtcCkuCi0JICovCi0KLQlmb3JfZWFjaF9lbmdpbmUoZGF0YS5lbmdpbmUsIGd0LCBpZCkg
ewotCQlpbnQgaSwgZXJyID0gMDsKLQotCQlzdF9lbmdpbmVfaGVhcnRiZWF0X2Rpc2FibGUoZGF0
YS5lbmdpbmUpOwotCi0JCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGRhdGEuY2UpOyBpKysp
IHsKLQkJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICp0bXA7Ci0KLQkJCXRtcCA9IGludGVsX2NvbnRl
eHRfY3JlYXRlKGRhdGEuZW5naW5lKTsKLQkJCWlmIChJU19FUlIodG1wKSkgewotCQkJCWVyciA9
IFBUUl9FUlIodG1wKTsKLQkJCQlnb3RvIGVycjsKLQkJCX0KLQotCQkJZXJyID0gaW50ZWxfY29u
dGV4dF9waW4odG1wKTsKLQkJCWlmIChlcnIpIHsKLQkJCQlpbnRlbF9jb250ZXh0X3B1dCh0bXAp
OwotCQkJCWdvdG8gZXJyOwotCQkJfQotCi0JCQlkYXRhLmNlW2ldID0gdG1wOwotCQl9Ci0KLQkJ
Zm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUocG9pc29uKTsgaSsrKSB7Ci0JCQlkYXRhLnBvaXNv
biA9IHBvaXNvbltpXTsKLQotCQkJZXJyID0gX19scmNfdGltZXN0YW1wKCZkYXRhLCBmYWxzZSk7
Ci0JCQlpZiAoZXJyKQotCQkJCWJyZWFrOwotCi0JCQllcnIgPSBfX2xyY190aW1lc3RhbXAoJmRh
dGEsIHRydWUpOwotCQkJaWYgKGVycikKLQkJCQlicmVhazsKLQkJfQotCi1lcnI6Ci0JCXN0X2Vu
Z2luZV9oZWFydGJlYXRfZW5hYmxlKGRhdGEuZW5naW5lKTsKLQkJZm9yIChpID0gMDsgaSA8IEFS
UkFZX1NJWkUoZGF0YS5jZSk7IGkrKykgewotCQkJaWYgKCFkYXRhLmNlW2ldKQotCQkJCWJyZWFr
OwotCi0JCQlpbnRlbF9jb250ZXh0X3VucGluKGRhdGEuY2VbaV0pOwotCQkJaW50ZWxfY29udGV4
dF9wdXQoZGF0YS5jZVtpXSk7Ci0JCX0KLQotCQlpZiAoaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUp
KQotCQkJZXJyID0gLUVJTzsKLQkJaWYgKGVycikKLQkJCXJldHVybiBlcnI7Ci0JfQotCi0JcmV0
dXJuIDA7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKgotY3JlYXRlX3VzZXJfdm1hKHN0
cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLCB1bnNpZ25lZCBsb25nIHNpemUpCi17Ci0Jc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKLQlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKLQlp
bnQgZXJyOwotCi0Jb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbCh2bS0+aTkx
NSwgc2l6ZSk7Ci0JaWYgKElTX0VSUihvYmopKQotCQlyZXR1cm4gRVJSX0NBU1Qob2JqKTsKLQot
CXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgdm0sIE5VTEwpOwotCWlmIChJU19FUlIodm1h
KSkgewotCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7Ci0JCXJldHVybiB2bWE7Ci0JfQotCi0J
ZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwgUElOX1VTRVIpOwotCWlmIChlcnIpIHsKLQkJ
aTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwotCQlyZXR1cm4gRVJSX1BUUihlcnIpOwotCX0KLQot
CXJldHVybiB2bWE7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKgotc3RvcmVfY29udGV4
dChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHN0cnVjdCBpOTE1X3ZtYSAqc2NyYXRjaCkKLXsK
LQlzdHJ1Y3QgaTkxNV92bWEgKmJhdGNoOwotCXUzMiBkdywgeCwgKmNzLCAqaHc7Ci0JdTMyICpk
ZWZhdWx0czsKLQotCWJhdGNoID0gY3JlYXRlX3VzZXJfdm1hKGNlLT52bSwgU1pfNjRLKTsKLQlp
ZiAoSVNfRVJSKGJhdGNoKSkKLQkJcmV0dXJuIGJhdGNoOwotCi0JY3MgPSBpOTE1X2dlbV9vYmpl
Y3RfcGluX21hcChiYXRjaC0+b2JqLCBJOTE1X01BUF9XQyk7Ci0JaWYgKElTX0VSUihjcykpIHsK
LQkJaTkxNV92bWFfcHV0KGJhdGNoKTsKLQkJcmV0dXJuIEVSUl9DQVNUKGNzKTsKLQl9Ci0KLQlk
ZWZhdWx0cyA9IHNobWVtX3Bpbl9tYXAoY2UtPmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSk7Ci0JaWYg
KCFkZWZhdWx0cykgewotCQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGJhdGNoLT5vYmopOwot
CQlpOTE1X3ZtYV9wdXQoYmF0Y2gpOwotCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKLQl9Ci0K
LQl4ID0gMDsKLQlkdyA9IDA7Ci0JaHcgPSBkZWZhdWx0czsKLQlodyArPSBMUkNfU1RBVEVfT0ZG
U0VUIC8gc2l6ZW9mKCpodyk7Ci0JZG8gewotCQl1MzIgbGVuID0gaHdbZHddICYgMHg3ZjsKLQot
CQlpZiAoaHdbZHddID09IDApIHsKLQkJCWR3Kys7Ci0JCQljb250aW51ZTsKLQkJfQotCi0JCWlm
ICgoaHdbZHddICYgR0VOTUFTSygzMSwgMjMpKSAhPSBNSV9JTlNUUigweDIyLCAwKSkgewotCQkJ
ZHcgKz0gbGVuICsgMjsKLQkJCWNvbnRpbnVlOwotCQl9Ci0KLQkJZHcrKzsKLQkJbGVuID0gKGxl
biArIDEpIC8gMjsKLQkJd2hpbGUgKGxlbi0tKSB7Ci0JCQkqY3MrKyA9IE1JX1NUT1JFX1JFR0lT
VEVSX01FTV9HRU44OwotCQkJKmNzKysgPSBod1tkd107Ci0JCQkqY3MrKyA9IGxvd2VyXzMyX2Jp
dHMoc2NyYXRjaC0+bm9kZS5zdGFydCArIHgpOwotCQkJKmNzKysgPSB1cHBlcl8zMl9iaXRzKHNj
cmF0Y2gtPm5vZGUuc3RhcnQgKyB4KTsKLQotCQkJZHcgKz0gMjsKLQkJCXggKz0gNDsKLQkJfQot
CX0gd2hpbGUgKGR3IDwgUEFHRV9TSVpFIC8gc2l6ZW9mKHUzMikgJiYKLQkJIChod1tkd10gJiB+
QklUKDApKSAhPSBNSV9CQVRDSF9CVUZGRVJfRU5EKTsKLQotCSpjcysrID0gTUlfQkFUQ0hfQlVG
RkVSX0VORDsKLQotCXNobWVtX3VucGluX21hcChjZS0+ZW5naW5lLT5kZWZhdWx0X3N0YXRlLCBk
ZWZhdWx0cyk7Ci0KLQlpOTE1X2dlbV9vYmplY3RfZmx1c2hfbWFwKGJhdGNoLT5vYmopOwotCWk5
MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoYmF0Y2gtPm9iaik7Ci0KLQlyZXR1cm4gYmF0Y2g7Ci19
Ci0KLXN0YXRpYyBpbnQgbW92ZV90b19hY3RpdmUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCi0J
CQkgIHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAotCQkJICB1bnNpZ25lZCBpbnQgZmxhZ3MpCi17Ci0J
aW50IGVycjsKLQotCWk5MTVfdm1hX2xvY2sodm1hKTsKLQllcnIgPSBpOTE1X3JlcXVlc3RfYXdh
aXRfb2JqZWN0KHJxLCB2bWEtPm9iaiwgZmxhZ3MpOwotCWlmICghZXJyKQotCQllcnIgPSBpOTE1
X3ZtYV9tb3ZlX3RvX2FjdGl2ZSh2bWEsIHJxLCBmbGFncyk7Ci0JaTkxNV92bWFfdW5sb2NrKHZt
YSk7Ci0KLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVzdCAqCi1y
ZWNvcmRfcmVnaXN0ZXJzKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKLQkJIHN0cnVjdCBpOTE1
X3ZtYSAqYmVmb3JlLAotCQkgc3RydWN0IGk5MTVfdm1hICphZnRlciwKLQkJIHUzMiAqc2VtYSkK
LXsKLQlzdHJ1Y3QgaTkxNV92bWEgKmJfYmVmb3JlLCAqYl9hZnRlcjsKLQlzdHJ1Y3QgaTkxNV9y
ZXF1ZXN0ICpycTsKLQl1MzIgKmNzOwotCWludCBlcnI7Ci0KLQliX2JlZm9yZSA9IHN0b3JlX2Nv
bnRleHQoY2UsIGJlZm9yZSk7Ci0JaWYgKElTX0VSUihiX2JlZm9yZSkpCi0JCXJldHVybiBFUlJf
Q0FTVChiX2JlZm9yZSk7Ci0KLQliX2FmdGVyID0gc3RvcmVfY29udGV4dChjZSwgYWZ0ZXIpOwot
CWlmIChJU19FUlIoYl9hZnRlcikpIHsKLQkJcnEgPSBFUlJfQ0FTVChiX2FmdGVyKTsKLQkJZ290
byBlcnJfYmVmb3JlOwotCX0KLQotCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChj
ZSk7Ci0JaWYgKElTX0VSUihycSkpCi0JCWdvdG8gZXJyX2FmdGVyOwotCi0JZXJyID0gbW92ZV90
b19hY3RpdmUocnEsIGJlZm9yZSwgRVhFQ19PQkpFQ1RfV1JJVEUpOwotCWlmIChlcnIpCi0JCWdv
dG8gZXJyX3JxOwotCi0JZXJyID0gbW92ZV90b19hY3RpdmUocnEsIGJfYmVmb3JlLCAwKTsKLQlp
ZiAoZXJyKQotCQlnb3RvIGVycl9ycTsKLQotCWVyciA9IG1vdmVfdG9fYWN0aXZlKHJxLCBhZnRl
ciwgRVhFQ19PQkpFQ1RfV1JJVEUpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyX3JxOwotCi0JZXJy
ID0gbW92ZV90b19hY3RpdmUocnEsIGJfYWZ0ZXIsIDApOwotCWlmIChlcnIpCi0JCWdvdG8gZXJy
X3JxOwotCi0JY3MgPSBpbnRlbF9yaW5nX2JlZ2luKHJxLCAxNCk7Ci0JaWYgKElTX0VSUihjcykp
IHsKLQkJZXJyID0gUFRSX0VSUihjcyk7Ci0JCWdvdG8gZXJyX3JxOwotCX0KLQotCSpjcysrID0g
TUlfQVJCX09OX09GRiB8IE1JX0FSQl9ESVNBQkxFOwotCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVS
X1NUQVJUX0dFTjggfCBCSVQoOCk7Ci0JKmNzKysgPSBsb3dlcl8zMl9iaXRzKGJfYmVmb3JlLT5u
b2RlLnN0YXJ0KTsKLQkqY3MrKyA9IHVwcGVyXzMyX2JpdHMoYl9iZWZvcmUtPm5vZGUuc3RhcnQp
OwotCi0JKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0VOQUJMRTsKLQkqY3MrKyA9IE1J
X1NFTUFQSE9SRV9XQUlUIHwKLQkJTUlfU0VNQVBIT1JFX0dMT0JBTF9HVFQgfAotCQlNSV9TRU1B
UEhPUkVfUE9MTCB8Ci0JCU1JX1NFTUFQSE9SRV9TQURfTkVRX1NERDsKLQkqY3MrKyA9IDA7Ci0J
KmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KGNlLT5lbmdpbmUtPnN0YXR1c19wYWdlLnZtYSkgKwot
CQlvZmZzZXRfaW5fcGFnZShzZW1hKTsKLQkqY3MrKyA9IDA7Ci0JKmNzKysgPSBNSV9OT09QOwot
Ci0JKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0RJU0FCTEU7Ci0JKmNzKysgPSBNSV9C
QVRDSF9CVUZGRVJfU1RBUlRfR0VOOCB8IEJJVCg4KTsKLQkqY3MrKyA9IGxvd2VyXzMyX2JpdHMo
Yl9hZnRlci0+bm9kZS5zdGFydCk7Ci0JKmNzKysgPSB1cHBlcl8zMl9iaXRzKGJfYWZ0ZXItPm5v
ZGUuc3RhcnQpOwotCi0JaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7Ci0KLQlXUklURV9PTkNF
KCpzZW1hLCAwKTsKLQlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKLQlpOTE1X3JlcXVlc3RfYWRkKHJx
KTsKLWVycl9hZnRlcjoKLQlpOTE1X3ZtYV9wdXQoYl9hZnRlcik7Ci1lcnJfYmVmb3JlOgotCWk5
MTVfdm1hX3B1dChiX2JlZm9yZSk7Ci0JcmV0dXJuIHJxOwotCi1lcnJfcnE6Ci0JaTkxNV9yZXF1
ZXN0X2FkZChycSk7Ci0JcnEgPSBFUlJfUFRSKGVycik7Ci0JZ290byBlcnJfYWZ0ZXI7Ci19Ci0K
LXN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKmxvYWRfY29udGV4dChzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UsIHUzMiBwb2lzb24pCi17Ci0Jc3RydWN0IGk5MTVfdm1hICpiYXRjaDsKLQl1MzIgZHcs
ICpjcywgKmh3OwotCXUzMiAqZGVmYXVsdHM7Ci0KLQliYXRjaCA9IGNyZWF0ZV91c2VyX3ZtYShj
ZS0+dm0sIFNaXzY0Syk7Ci0JaWYgKElTX0VSUihiYXRjaCkpCi0JCXJldHVybiBiYXRjaDsKLQot
CWNzID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoYmF0Y2gtPm9iaiwgSTkxNV9NQVBfV0MpOwot
CWlmIChJU19FUlIoY3MpKSB7Ci0JCWk5MTVfdm1hX3B1dChiYXRjaCk7Ci0JCXJldHVybiBFUlJf
Q0FTVChjcyk7Ci0JfQotCi0JZGVmYXVsdHMgPSBzaG1lbV9waW5fbWFwKGNlLT5lbmdpbmUtPmRl
ZmF1bHRfc3RhdGUpOwotCWlmICghZGVmYXVsdHMpIHsKLQkJaTkxNV9nZW1fb2JqZWN0X3VucGlu
X21hcChiYXRjaC0+b2JqKTsKLQkJaTkxNV92bWFfcHV0KGJhdGNoKTsKLQkJcmV0dXJuIEVSUl9Q
VFIoLUVOT01FTSk7Ci0JfQotCi0JZHcgPSAwOwotCWh3ID0gZGVmYXVsdHM7Ci0JaHcgKz0gTFJD
X1NUQVRFX09GRlNFVCAvIHNpemVvZigqaHcpOwotCWRvIHsKLQkJdTMyIGxlbiA9IGh3W2R3XSAm
IDB4N2Y7Ci0KLQkJaWYgKGh3W2R3XSA9PSAwKSB7Ci0JCQlkdysrOwotCQkJY29udGludWU7Ci0J
CX0KLQotCQlpZiAoKGh3W2R3XSAmIEdFTk1BU0soMzEsIDIzKSkgIT0gTUlfSU5TVFIoMHgyMiwg
MCkpIHsKLQkJCWR3ICs9IGxlbiArIDI7Ci0JCQljb250aW51ZTsKLQkJfQotCi0JCWR3Kys7Ci0J
CWxlbiA9IChsZW4gKyAxKSAvIDI7Ci0JCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0obGVu
KTsKLQkJd2hpbGUgKGxlbi0tKSB7Ci0JCQkqY3MrKyA9IGh3W2R3XTsKLQkJCSpjcysrID0gcG9p
c29uOwotCQkJZHcgKz0gMjsKLQkJfQotCX0gd2hpbGUgKGR3IDwgUEFHRV9TSVpFIC8gc2l6ZW9m
KHUzMikgJiYKLQkJIChod1tkd10gJiB+QklUKDApKSAhPSBNSV9CQVRDSF9CVUZGRVJfRU5EKTsK
LQotCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX0VORDsKLQotCXNobWVtX3VucGluX21hcChjZS0+
ZW5naW5lLT5kZWZhdWx0X3N0YXRlLCBkZWZhdWx0cyk7Ci0KLQlpOTE1X2dlbV9vYmplY3RfZmx1
c2hfbWFwKGJhdGNoLT5vYmopOwotCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoYmF0Y2gtPm9i
aik7Ci0KLQlyZXR1cm4gYmF0Y2g7Ci19Ci0KLXN0YXRpYyBpbnQgcG9pc29uX3JlZ2lzdGVycyhz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHUzMiBwb2lzb24sIHUzMiAqc2VtYSkKLXsKLQlzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQlzdHJ1Y3QgaTkxNV92bWEgKmJhdGNoOwotCXUzMiAqY3M7
Ci0JaW50IGVycjsKLQotCWJhdGNoID0gbG9hZF9jb250ZXh0KGNlLCBwb2lzb24pOwotCWlmIChJ
U19FUlIoYmF0Y2gpKQotCQlyZXR1cm4gUFRSX0VSUihiYXRjaCk7Ci0KLQlycSA9IGludGVsX2Nv
bnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOwotCWlmIChJU19FUlIocnEpKSB7Ci0JCWVyciA9IFBU
Ul9FUlIocnEpOwotCQlnb3RvIGVycl9iYXRjaDsKLQl9Ci0KLQllcnIgPSBtb3ZlX3RvX2FjdGl2
ZShycSwgYmF0Y2gsIDApOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyX3JxOwotCi0JY3MgPSBpbnRl
bF9yaW5nX2JlZ2luKHJxLCA4KTsKLQlpZiAoSVNfRVJSKGNzKSkgewotCQllcnIgPSBQVFJfRVJS
KGNzKTsKLQkJZ290byBlcnJfcnE7Ci0JfQotCi0JKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlf
QVJCX0RJU0FCTEU7Ci0JKmNzKysgPSBNSV9CQVRDSF9CVUZGRVJfU1RBUlRfR0VOOCB8IEJJVCg4
KTsKLQkqY3MrKyA9IGxvd2VyXzMyX2JpdHMoYmF0Y2gtPm5vZGUuc3RhcnQpOwotCSpjcysrID0g
dXBwZXJfMzJfYml0cyhiYXRjaC0+bm9kZS5zdGFydCk7Ci0KLQkqY3MrKyA9IE1JX1NUT1JFX0RX
T1JEX0lNTV9HRU40IHwgTUlfVVNFX0dHVFQ7Ci0JKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KGNl
LT5lbmdpbmUtPnN0YXR1c19wYWdlLnZtYSkgKwotCQlvZmZzZXRfaW5fcGFnZShzZW1hKTsKLQkq
Y3MrKyA9IDA7Ci0JKmNzKysgPSAxOwotCi0JaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7Ci0K
LQlycS0+c2NoZWQuYXR0ci5wcmlvcml0eSA9IEk5MTVfUFJJT1JJVFlfQkFSUklFUjsKLWVycl9y
cToKLQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKLWVycl9iYXRjaDoKLQlpOTE1X3ZtYV9wdXQoYmF0
Y2gpOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBib29sIGlzX21vdmluZyh1MzIgYSwgdTMy
IGIpCi17Ci0JcmV0dXJuIGEgIT0gYjsKLX0KLQotc3RhdGljIGludCBjb21wYXJlX2lzb2xhdGlv
bihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCi0JCQkgICAgIHN0cnVjdCBpOTE1X3Zt
YSAqcmVmWzJdLAotCQkJICAgICBzdHJ1Y3QgaTkxNV92bWEgKnJlc3VsdFsyXSwKLQkJCSAgICAg
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLAotCQkJICAgICB1MzIgcG9pc29uKQotewotCXUzMiB4
LCBkdywgKmh3LCAqbHJjOwotCXUzMiAqQVsyXSwgKkJbMl07Ci0JdTMyICpkZWZhdWx0czsKLQlp
bnQgZXJyID0gMDsKLQotCUFbMF0gPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChyZWZbMF0tPm9i
aiwgSTkxNV9NQVBfV0MpOwotCWlmIChJU19FUlIoQVswXSkpCi0JCXJldHVybiBQVFJfRVJSKEFb
MF0pOwotCi0JQVsxXSA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKHJlZlsxXS0+b2JqLCBJOTE1
X01BUF9XQyk7Ci0JaWYgKElTX0VSUihBWzFdKSkgewotCQllcnIgPSBQVFJfRVJSKEFbMV0pOwot
CQlnb3RvIGVycl9BMDsKLQl9Ci0KLQlCWzBdID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAocmVz
dWx0WzBdLT5vYmosIEk5MTVfTUFQX1dDKTsKLQlpZiAoSVNfRVJSKEJbMF0pKSB7Ci0JCWVyciA9
IFBUUl9FUlIoQlswXSk7Ci0JCWdvdG8gZXJyX0ExOwotCX0KLQotCUJbMV0gPSBpOTE1X2dlbV9v
YmplY3RfcGluX21hcChyZXN1bHRbMV0tPm9iaiwgSTkxNV9NQVBfV0MpOwotCWlmIChJU19FUlIo
QlsxXSkpIHsKLQkJZXJyID0gUFRSX0VSUihCWzFdKTsKLQkJZ290byBlcnJfQjA7Ci0JfQotCi0J
bHJjID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoY2UtPnN0YXRlLT5vYmosCi0JCQkJICAgICAg
aTkxNV9jb2hlcmVudF9tYXBfdHlwZShlbmdpbmUtPmk5MTUpKTsKLQlpZiAoSVNfRVJSKGxyYykp
IHsKLQkJZXJyID0gUFRSX0VSUihscmMpOwotCQlnb3RvIGVycl9CMTsKLQl9Ci0JbHJjICs9IExS
Q19TVEFURV9PRkZTRVQgLyBzaXplb2YoKmh3KTsKLQotCWRlZmF1bHRzID0gc2htZW1fcGluX21h
cChjZS0+ZW5naW5lLT5kZWZhdWx0X3N0YXRlKTsKLQlpZiAoIWRlZmF1bHRzKSB7Ci0JCWVyciA9
IC1FTk9NRU07Ci0JCWdvdG8gZXJyX2xyYzsKLQl9Ci0KLQl4ID0gMDsKLQlkdyA9IDA7Ci0JaHcg
PSBkZWZhdWx0czsKLQlodyArPSBMUkNfU1RBVEVfT0ZGU0VUIC8gc2l6ZW9mKCpodyk7Ci0JZG8g
ewotCQl1MzIgbGVuID0gaHdbZHddICYgMHg3ZjsKLQotCQlpZiAoaHdbZHddID09IDApIHsKLQkJ
CWR3Kys7Ci0JCQljb250aW51ZTsKLQkJfQotCi0JCWlmICgoaHdbZHddICYgR0VOTUFTSygzMSwg
MjMpKSAhPSBNSV9JTlNUUigweDIyLCAwKSkgewotCQkJZHcgKz0gbGVuICsgMjsKLQkJCWNvbnRp
bnVlOwotCQl9Ci0KLQkJZHcrKzsKLQkJbGVuID0gKGxlbiArIDEpIC8gMjsKLQkJd2hpbGUgKGxl
bi0tKSB7Ci0JCQlpZiAoIWlzX21vdmluZyhBWzBdW3hdLCBBWzFdW3hdKSAmJgotCQkJICAgIChB
WzBdW3hdICE9IEJbMF1beF0gfHwgQVsxXVt4XSAhPSBCWzFdW3hdKSkgewotCQkJCXN3aXRjaCAo
aHdbZHddICYgNDA5NSkgewotCQkJCWNhc2UgMHgzMDogLyogUklOR19IRUFEICovCi0JCQkJY2Fz
ZSAweDM0OiAvKiBSSU5HX1RBSUwgKi8KLQkJCQkJYnJlYWs7Ci0KLQkJCQlkZWZhdWx0OgotCQkJ
CQlwcl9lcnIoIiVzWyVkXTogTWlzbWF0Y2ggZm9yIHJlZ2lzdGVyICU0eCwgZGVmYXVsdCAlMDh4
LCByZWZlcmVuY2UgJTA4eCwgcmVzdWx0ICglMDh4LCAlMDh4KSwgcG9pc29uICUwOHgsIGNvbnRl
eHQgJTA4eFxuIiwKLQkJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwgZHcsCi0JCQkJCSAgICAgICBo
d1tkd10sIGh3W2R3ICsgMV0sCi0JCQkJCSAgICAgICBBWzBdW3hdLCBCWzBdW3hdLCBCWzFdW3hd
LAotCQkJCQkgICAgICAgcG9pc29uLCBscmNbZHcgKyAxXSk7Ci0JCQkJCWVyciA9IC1FSU5WQUw7
Ci0JCQkJfQotCQkJfQotCQkJZHcgKz0gMjsKLQkJCXgrKzsKLQkJfQotCX0gd2hpbGUgKGR3IDwg
UEFHRV9TSVpFIC8gc2l6ZW9mKHUzMikgJiYKLQkJIChod1tkd10gJiB+QklUKDApKSAhPSBNSV9C
QVRDSF9CVUZGRVJfRU5EKTsKLQotCXNobWVtX3VucGluX21hcChjZS0+ZW5naW5lLT5kZWZhdWx0
X3N0YXRlLCBkZWZhdWx0cyk7Ci1lcnJfbHJjOgotCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAo
Y2UtPnN0YXRlLT5vYmopOwotZXJyX0IxOgotCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAocmVz
dWx0WzFdLT5vYmopOwotZXJyX0IwOgotCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAocmVzdWx0
WzBdLT5vYmopOwotZXJyX0ExOgotCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAocmVmWzFdLT5v
YmopOwotZXJyX0EwOgotCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAocmVmWzBdLT5vYmopOwot
CXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBpbnQgX19scmNfaXNvbGF0aW9uKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMyIHBvaXNvbikKLXsKLQl1MzIgKnNlbWEgPSBtZW1zZXQz
MihlbmdpbmUtPnN0YXR1c19wYWdlLmFkZHIgKyAxMDAwLCAwLCAxKTsKLQlzdHJ1Y3QgaTkxNV92
bWEgKnJlZlsyXSwgKnJlc3VsdFsyXTsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqQSwgKkI7Ci0J
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Ci0JaW50IGVycjsKLQotCUEgPSBpbnRlbF9jb250ZXh0
X2NyZWF0ZShlbmdpbmUpOwotCWlmIChJU19FUlIoQSkpCi0JCXJldHVybiBQVFJfRVJSKEEpOwot
Ci0JQiA9IGludGVsX2NvbnRleHRfY3JlYXRlKGVuZ2luZSk7Ci0JaWYgKElTX0VSUihCKSkgewot
CQllcnIgPSBQVFJfRVJSKEIpOwotCQlnb3RvIGVycl9BOwotCX0KLQotCXJlZlswXSA9IGNyZWF0
ZV91c2VyX3ZtYShBLT52bSwgU1pfNjRLKTsKLQlpZiAoSVNfRVJSKHJlZlswXSkpIHsKLQkJZXJy
ID0gUFRSX0VSUihyZWZbMF0pOwotCQlnb3RvIGVycl9COwotCX0KLQotCXJlZlsxXSA9IGNyZWF0
ZV91c2VyX3ZtYShBLT52bSwgU1pfNjRLKTsKLQlpZiAoSVNfRVJSKHJlZlsxXSkpIHsKLQkJZXJy
ID0gUFRSX0VSUihyZWZbMV0pOwotCQlnb3RvIGVycl9yZWYwOwotCX0KLQotCXJxID0gcmVjb3Jk
X3JlZ2lzdGVycyhBLCByZWZbMF0sIHJlZlsxXSwgc2VtYSk7Ci0JaWYgKElTX0VSUihycSkpIHsK
LQkJZXJyID0gUFRSX0VSUihycSk7Ci0JCWdvdG8gZXJyX3JlZjE7Ci0JfQotCi0JV1JJVEVfT05D
RSgqc2VtYSwgMSk7Ci0Jd21iKCk7Ci0KLQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocnEsIDAsIEha
IC8gMikgPCAwKSB7Ci0JCWk5MTVfcmVxdWVzdF9wdXQocnEpOwotCQllcnIgPSAtRVRJTUU7Ci0J
CWdvdG8gZXJyX3JlZjE7Ci0JfQotCWk5MTVfcmVxdWVzdF9wdXQocnEpOwotCi0JcmVzdWx0WzBd
ID0gY3JlYXRlX3VzZXJfdm1hKEEtPnZtLCBTWl82NEspOwotCWlmIChJU19FUlIocmVzdWx0WzBd
KSkgewotCQllcnIgPSBQVFJfRVJSKHJlc3VsdFswXSk7Ci0JCWdvdG8gZXJyX3JlZjE7Ci0JfQot
Ci0JcmVzdWx0WzFdID0gY3JlYXRlX3VzZXJfdm1hKEEtPnZtLCBTWl82NEspOwotCWlmIChJU19F
UlIocmVzdWx0WzFdKSkgewotCQllcnIgPSBQVFJfRVJSKHJlc3VsdFsxXSk7Ci0JCWdvdG8gZXJy
X3Jlc3VsdDA7Ci0JfQotCi0JcnEgPSByZWNvcmRfcmVnaXN0ZXJzKEEsIHJlc3VsdFswXSwgcmVz
dWx0WzFdLCBzZW1hKTsKLQlpZiAoSVNfRVJSKHJxKSkgewotCQllcnIgPSBQVFJfRVJSKHJxKTsK
LQkJZ290byBlcnJfcmVzdWx0MTsKLQl9Ci0KLQllcnIgPSBwb2lzb25fcmVnaXN0ZXJzKEIsIHBv
aXNvbiwgc2VtYSk7Ci0JaWYgKGVycikgewotCQlXUklURV9PTkNFKCpzZW1hLCAtMSk7Ci0JCWk5
MTVfcmVxdWVzdF9wdXQocnEpOwotCQlnb3RvIGVycl9yZXN1bHQxOwotCX0KLQotCWlmIChpOTE1
X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyAyKSA8IDApIHsKLQkJaTkxNV9yZXF1ZXN0X3B1dChy
cSk7Ci0JCWVyciA9IC1FVElNRTsKLQkJZ290byBlcnJfcmVzdWx0MTsKLQl9Ci0JaTkxNV9yZXF1
ZXN0X3B1dChycSk7Ci0KLQllcnIgPSBjb21wYXJlX2lzb2xhdGlvbihlbmdpbmUsIHJlZiwgcmVz
dWx0LCBBLCBwb2lzb24pOwotCi1lcnJfcmVzdWx0MToKLQlpOTE1X3ZtYV9wdXQocmVzdWx0WzFd
KTsKLWVycl9yZXN1bHQwOgotCWk5MTVfdm1hX3B1dChyZXN1bHRbMF0pOwotZXJyX3JlZjE6Ci0J
aTkxNV92bWFfcHV0KHJlZlsxXSk7Ci1lcnJfcmVmMDoKLQlpOTE1X3ZtYV9wdXQocmVmWzBdKTsK
LWVycl9COgotCWludGVsX2NvbnRleHRfcHV0KEIpOwotZXJyX0E6Ci0JaW50ZWxfY29udGV4dF9w
dXQoQSk7Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIGJvb2wgc2tpcF9pc29sYXRpb24oY29u
c3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCWlmIChlbmdpbmUtPmNsYXNz
ID09IENPUFlfRU5HSU5FX0NMQVNTICYmIElOVEVMX0dFTihlbmdpbmUtPmk5MTUpID09IDkpCi0J
CXJldHVybiB0cnVlOwotCi0JaWYgKGVuZ2luZS0+Y2xhc3MgPT0gUkVOREVSX0NMQVNTICYmIElO
VEVMX0dFTihlbmdpbmUtPmk5MTUpID09IDExKQotCQlyZXR1cm4gdHJ1ZTsKLQotCXJldHVybiBm
YWxzZTsKLX0KLQotc3RhdGljIGludCBsaXZlX2xyY19pc29sYXRpb24odm9pZCAqYXJnKQotewot
CXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOwotCWNvbnN0IHUzMiBwb2lzb25bXSA9IHsK
LQkJU1RBQ0tfTUFHSUMsCi0JCTB4M2EzYTNhM2EsCi0JCTB4NWM1YzVjNWMsCi0JCTB4ZmZmZmZm
ZmYsCi0JCTB4ZmZmZjAwMDAsCi0JfTsKLQlpbnQgZXJyID0gMDsKLQotCS8qCi0JICogT3VyIGdv
YWwgaXMgdHJ5IGFuZCB2ZXJpZnkgdGhhdCBwZXItY29udGV4dCBzdGF0ZSBjYW5ub3QgYmUKLQkg
KiB0YW1wZXJlZCB3aXRoIGJ5IGFub3RoZXIgbm9uLXByaXZpbGVnZWQgY2xpZW50LgotCSAqCi0J
ICogV2UgdGFrZSB0aGUgbGlzdCBvZiBjb250ZXh0IHJlZ2lzdGVycyBmcm9tIHRoZSBMUkkgaW4g
dGhlIGRlZmF1bHQKLQkgKiBjb250ZXh0IGltYWdlIGFuZCBhdHRlbXB0IHRvIG1vZGlmeSB0aGF0
IGxpc3QgZnJvbSBhIHJlbW90ZSBjb250ZXh0LgotCSAqLwotCi0JZm9yX2VhY2hfZW5naW5lKGVu
Z2luZSwgZ3QsIGlkKSB7Ci0JCWludCBpOwotCi0JCS8qIEp1c3QgZG9uJ3QgZXZlbiBhc2sgKi8K
LQkJaWYgKCFJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9TRUxGVEVTVF9CUk9LRU4pICYmCi0J
CSAgICBza2lwX2lzb2xhdGlvbihlbmdpbmUpKQotCQkJY29udGludWU7Ci0KLQkJaW50ZWxfZW5n
aW5lX3BtX2dldChlbmdpbmUpOwotCQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShwb2lzb24p
OyBpKyspIHsKLQkJCWludCByZXN1bHQ7Ci0KLQkJCXJlc3VsdCA9IF9fbHJjX2lzb2xhdGlvbihl
bmdpbmUsIHBvaXNvbltpXSk7Ci0JCQlpZiAocmVzdWx0ICYmICFlcnIpCi0JCQkJZXJyID0gcmVz
dWx0OwotCi0JCQlyZXN1bHQgPSBfX2xyY19pc29sYXRpb24oZW5naW5lLCB+cG9pc29uW2ldKTsK
LQkJCWlmIChyZXN1bHQgJiYgIWVycikKLQkJCQllcnIgPSByZXN1bHQ7Ci0JCX0KLQkJaW50ZWxf
ZW5naW5lX3BtX3B1dChlbmdpbmUpOwotCQlpZiAoaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUpKSB7
Ci0JCQllcnIgPSAtRUlPOwotCQkJYnJlYWs7Ci0JCX0KLQl9Ci0KLQlyZXR1cm4gZXJyOwotfQot
Ci1zdGF0aWMgaW50IGluZGlyZWN0X2N0eF9zdWJtaXRfcmVxKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSkKLXsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKLQlpbnQgZXJyID0gMDsKLQotCXJx
ID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7Ci0JaWYgKElTX0VSUihycSkpCi0J
CXJldHVybiBQVFJfRVJSKHJxKTsKLQotCWk5MTVfcmVxdWVzdF9nZXQocnEpOwotCWk5MTVfcmVx
dWVzdF9hZGQocnEpOwotCi0JaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDUpIDwg
MCkKLQkJZXJyID0gLUVUSU1FOwotCi0JaTkxNV9yZXF1ZXN0X3B1dChycSk7Ci0KLQlyZXR1cm4g
ZXJyOwotfQotCi0jZGVmaW5lIENUWF9CQl9DQU5BUllfT0ZGU0VUICgzICogMTAyNCkKLSNkZWZp
bmUgQ1RYX0JCX0NBTkFSWV9JTkRFWCAgKENUWF9CQl9DQU5BUllfT0ZGU0VUIC8gc2l6ZW9mKHUz
MikpCi0KLXN0YXRpYyB1MzIgKgotZW1pdF9pbmRpcmVjdF9jdHhfYmJfY2FuYXJ5KGNvbnN0IHN0
cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdTMyICpjcykKLXsKLQkqY3MrKyA9IE1JX1NUT1JFX1JF
R0lTVEVSX01FTV9HRU44IHwKLQkJTUlfU1JNX0xSTV9HTE9CQUxfR1RUIHwKLQkJTUlfTFJJX0xS
TV9DU19NTUlPOwotCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19TVEFSVCgwKSk7
Ci0JKmNzKysgPSBpOTE1X2dndHRfb2Zmc2V0KGNlLT5zdGF0ZSkgKwotCQljb250ZXh0X3dhX2Ji
X29mZnNldChjZSkgKwotCQlDVFhfQkJfQ0FOQVJZX09GRlNFVDsKLQkqY3MrKyA9IDA7Ci0KLQly
ZXR1cm4gY3M7Ci19Ci0KLXN0YXRpYyB2b2lkCi1pbmRpcmVjdF9jdHhfYmJfc2V0dXAoc3RydWN0
IGludGVsX2NvbnRleHQgKmNlKQotewotCXUzMiAqY3MgPSBjb250ZXh0X2luZGlyZWN0X2JiKGNl
KTsKLQotCWNzW0NUWF9CQl9DQU5BUllfSU5ERVhdID0gMHhkZWFkZjAwZDsKLQotCXNldHVwX2lu
ZGlyZWN0X2N0eF9iYihjZSwgY2UtPmVuZ2luZSwgZW1pdF9pbmRpcmVjdF9jdHhfYmJfY2FuYXJ5
KTsKLX0KLQotc3RhdGljIGJvb2wgY2hlY2tfcmluZ19zdGFydChzdHJ1Y3QgaW50ZWxfY29udGV4
dCAqY2UpCi17Ci0JY29uc3QgdTMyICogY29uc3QgY3R4X2JiID0gKHZvaWQgKikoY2UtPmxyY19y
ZWdfc3RhdGUpIC0KLQkJTFJDX1NUQVRFX09GRlNFVCArIGNvbnRleHRfd2FfYmJfb2Zmc2V0KGNl
KTsKLQotCWlmIChjdHhfYmJbQ1RYX0JCX0NBTkFSWV9JTkRFWF0gPT0gY2UtPmxyY19yZWdfc3Rh
dGVbQ1RYX1JJTkdfU1RBUlRdKQotCQlyZXR1cm4gdHJ1ZTsKLQotCXByX2VycigicmluZyBzdGFy
dCBtaXNtYXRjaDogY2FuYXJ5IDB4JTA4eCB2cyBzdGF0ZSAweCUwOHhcbiIsCi0JICAgICAgIGN0
eF9iYltDVFhfQkJfQ0FOQVJZX0lOREVYXSwKLQkgICAgICAgY2UtPmxyY19yZWdfc3RhdGVbQ1RY
X1JJTkdfU1RBUlRdKTsKLQotCXJldHVybiBmYWxzZTsKLX0KLQotc3RhdGljIGludCBpbmRpcmVj
dF9jdHhfYmJfY2hlY2soc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQotewotCWludCBlcnI7Ci0K
LQllcnIgPSBpbmRpcmVjdF9jdHhfc3VibWl0X3JlcShjZSk7Ci0JaWYgKGVycikKLQkJcmV0dXJu
IGVycjsKLQotCWlmICghY2hlY2tfcmluZ19zdGFydChjZSkpCi0JCXJldHVybiAtRUlOVkFMOwot
Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgX19saXZlX2xyY19pbmRpcmVjdF9jdHhfYmIo
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCXN0cnVjdCBpbnRlbF9jb250ZXh0
ICphLCAqYjsKLQlpbnQgZXJyOwotCi0JYSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGVuZ2luZSk7
Ci0JaWYgKElTX0VSUihhKSkKLQkJcmV0dXJuIFBUUl9FUlIoYSk7Ci0JZXJyID0gaW50ZWxfY29u
dGV4dF9waW4oYSk7Ci0JaWYgKGVycikKLQkJZ290byBwdXRfYTsKLQotCWIgPSBpbnRlbF9jb250
ZXh0X2NyZWF0ZShlbmdpbmUpOwotCWlmIChJU19FUlIoYikpIHsKLQkJZXJyID0gUFRSX0VSUihi
KTsKLQkJZ290byB1bnBpbl9hOwotCX0KLQllcnIgPSBpbnRlbF9jb250ZXh0X3BpbihiKTsKLQlp
ZiAoZXJyKQotCQlnb3RvIHB1dF9iOwotCi0JLyogV2UgdXNlIHRoZSBhbHJlYWR5IHJlc2VydmVk
IGV4dHJhIHBhZ2UgaW4gY29udGV4dCBzdGF0ZSAqLwotCWlmICghYS0+d2FfYmJfcGFnZSkgewot
CQlHRU1fQlVHX09OKGItPndhX2JiX3BhZ2UpOwotCQlHRU1fQlVHX09OKElOVEVMX0dFTihlbmdp
bmUtPmk5MTUpID09IDEyKTsKLQkJZ290byB1bnBpbl9iOwotCX0KLQotCS8qCi0JICogSW4gb3Jk
ZXIgdG8gdGVzdCB0aGF0IG91ciBwZXIgY29udGV4dCBiYiBpcyB0cnVseSBwZXIgY29udGV4dCwK
LQkgKiBhbmQgZXhlY3V0ZXMgYXQgdGhlIGludGVuZGVkIHNwb3Qgb24gY29udGV4dCByZXN0b3Jp
bmcgcHJvY2VzcywKLQkgKiBtYWtlIHRoZSBiYXRjaCBzdG9yZSB0aGUgcmluZyBzdGFydCB2YWx1
ZSB0byBtZW1vcnkuCi0JICogQXMgcmluZyBzdGFydCBpcyByZXN0b3JlZCBhcHJpb3JpIG9mIHN0
YXJ0aW5nIHRoZSBpbmRpcmVjdCBjdHggYmIgYW5kCi0JICogYXMgaXQgd2lsbCBiZSBkaWZmZXJl
bnQgZm9yIGVhY2ggY29udGV4dCwgaXQgZml0cyB0byB0aGlzIHB1cnBvc2UuCi0JICovCi0JaW5k
aXJlY3RfY3R4X2JiX3NldHVwKGEpOwotCWluZGlyZWN0X2N0eF9iYl9zZXR1cChiKTsKLQotCWVy
ciA9IGluZGlyZWN0X2N0eF9iYl9jaGVjayhhKTsKLQlpZiAoZXJyKQotCQlnb3RvIHVucGluX2I7
Ci0KLQllcnIgPSBpbmRpcmVjdF9jdHhfYmJfY2hlY2soYik7Ci0KLXVucGluX2I6Ci0JaW50ZWxf
Y29udGV4dF91bnBpbihiKTsKLXB1dF9iOgotCWludGVsX2NvbnRleHRfcHV0KGIpOwotdW5waW5f
YToKLQlpbnRlbF9jb250ZXh0X3VucGluKGEpOwotcHV0X2E6Ci0JaW50ZWxfY29udGV4dF9wdXQo
YSk7Ci0KLQlyZXR1cm4gZXJyOwotfQotCi1zdGF0aWMgaW50IGxpdmVfbHJjX2luZGlyZWN0X2N0
eF9iYih2b2lkICphcmcpCi17Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKLQlzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0JaW50
IGVyciA9IDA7Ci0KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQpIHsKLQkJaW50ZWxf
ZW5naW5lX3BtX2dldChlbmdpbmUpOwotCQllcnIgPSBfX2xpdmVfbHJjX2luZGlyZWN0X2N0eF9i
YihlbmdpbmUpOwotCQlpbnRlbF9lbmdpbmVfcG1fcHV0KGVuZ2luZSk7Ci0KLQkJaWYgKGlndF9m
bHVzaF90ZXN0KGd0LT5pOTE1KSkKLQkJCWVyciA9IC1FSU87Ci0KLQkJaWYgKGVycikKLQkJCWJy
ZWFrOwotCX0KLQotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyB2b2lkIGdhcmJhZ2VfcmVzZXQo
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycSkKLXsKLQljb25zdCB1bnNpZ25lZCBpbnQgYml0ID0gSTkxNV9SRVNFVF9FTkdJTkUgKyBl
bmdpbmUtPmlkOwotCXVuc2lnbmVkIGxvbmcgKmxvY2sgPSAmZW5naW5lLT5ndC0+cmVzZXQuZmxh
Z3M7Ci0KLQlpZiAodGVzdF9hbmRfc2V0X2JpdChiaXQsIGxvY2spKQotCQlyZXR1cm47Ci0KLQl0
YXNrbGV0X2Rpc2FibGUoJmVuZ2luZS0+ZXhlY2xpc3RzLnRhc2tsZXQpOwotCi0JaWYgKCFycS0+
ZmVuY2UuZXJyb3IpCi0JCWludGVsX2VuZ2luZV9yZXNldChlbmdpbmUsIE5VTEwpOwotCi0JdGFz
a2xldF9lbmFibGUoJmVuZ2luZS0+ZXhlY2xpc3RzLnRhc2tsZXQpOwotCWNsZWFyX2FuZF93YWtl
X3VwX2JpdChiaXQsIGxvY2spOwotfQotCi1zdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVzdCAqZ2Fy
YmFnZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCi0JCQkJICAgIHN0cnVjdCBybmRfc3RhdGUg
KnBybmcpCi17Ci0Jc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7Ci0JaW50IGVycjsKLQotCWVyciA9
IGludGVsX2NvbnRleHRfcGluKGNlKTsKLQlpZiAoZXJyKQotCQlyZXR1cm4gRVJSX1BUUihlcnIp
OwotCi0JcHJhbmRvbV9ieXRlc19zdGF0ZShwcm5nLAotCQkJICAgIGNlLT5scmNfcmVnX3N0YXRl
LAotCQkJICAgIGNlLT5lbmdpbmUtPmNvbnRleHRfc2l6ZSAtCi0JCQkgICAgTFJDX1NUQVRFX09G
RlNFVCk7Ci0KLQlycSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOwotCWlmIChJ
U19FUlIocnEpKSB7Ci0JCWVyciA9IFBUUl9FUlIocnEpOwotCQlnb3RvIGVycl91bnBpbjsKLQl9
Ci0KLQlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKLQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKLQlyZXR1
cm4gcnE7Ci0KLWVycl91bnBpbjoKLQlpbnRlbF9jb250ZXh0X3VucGluKGNlKTsKLQlyZXR1cm4g
RVJSX1BUUihlcnIpOwotfQotCi1zdGF0aWMgaW50IF9fbHJjX2dhcmJhZ2Uoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLCBzdHJ1Y3Qgcm5kX3N0YXRlICpwcm5nKQotewotCXN0cnVjdCBp
bnRlbF9jb250ZXh0ICpjZTsKLQlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpoYW5nOwotCWludCBlcnIg
PSAwOwotCi0JY2UgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUpOwotCWlmIChJU19FUlIo
Y2UpKQotCQlyZXR1cm4gUFRSX0VSUihjZSk7Ci0KLQloYW5nID0gZ2FyYmFnZShjZSwgcHJuZyk7
Ci0JaWYgKElTX0VSUihoYW5nKSkgewotCQllcnIgPSBQVFJfRVJSKGhhbmcpOwotCQlnb3RvIGVy
cl9jZTsKLQl9Ci0KLQlpZiAod2FpdF9mb3Jfc3VibWl0KGVuZ2luZSwgaGFuZywgSFogLyAyKSkg
ewotCQlpOTE1X3JlcXVlc3RfcHV0KGhhbmcpOwotCQllcnIgPSAtRVRJTUU7Ci0JCWdvdG8gZXJy
X2NlOwotCX0KLQotCWludGVsX2NvbnRleHRfc2V0X2Jhbm5lZChjZSk7Ci0JZ2FyYmFnZV9yZXNl
dChlbmdpbmUsIGhhbmcpOwotCi0JaW50ZWxfZW5naW5lX2ZsdXNoX3N1Ym1pc3Npb24oZW5naW5l
KTsKLQlpZiAoIWhhbmctPmZlbmNlLmVycm9yKSB7Ci0JCWk5MTVfcmVxdWVzdF9wdXQoaGFuZyk7
Ci0JCXByX2VycigiJXM6IGNvcnJ1cHRlZCBjb250ZXh0IHdhcyBub3QgcmVzZXRcbiIsCi0JCSAg
ICAgICBlbmdpbmUtPm5hbWUpOwotCQllcnIgPSAtRUlOVkFMOwotCQlnb3RvIGVycl9jZTsKLQl9
Ci0KLQlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQoaGFuZywgMCwgSFogLyAyKSA8IDApIHsKLQkJcHJf
ZXJyKCIlczogY29ycnVwdGVkIGNvbnRleHQgZGlkIG5vdCByZWNvdmVyXG4iLAotCQkgICAgICAg
ZW5naW5lLT5uYW1lKTsKLQkJaTkxNV9yZXF1ZXN0X3B1dChoYW5nKTsKLQkJZXJyID0gLUVJTzsK
LQkJZ290byBlcnJfY2U7Ci0JfQotCWk5MTVfcmVxdWVzdF9wdXQoaGFuZyk7Ci0KLWVycl9jZToK
LQlpbnRlbF9jb250ZXh0X3B1dChjZSk7Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIGludCBs
aXZlX2xyY19nYXJiYWdlKHZvaWQgKmFyZykKLXsKLQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJn
OwotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGludGVsX2VuZ2luZV9p
ZCBpZDsKLQotCS8qCi0JICogVmVyaWZ5IHRoYXQgd2UgY2FuIHJlY292ZXIgaWYgb25lIGNvbnRl
eHQgc3RhdGUgaXMgY29tcGxldGVseQotCSAqIGNvcnJ1cHRlZC4KLQkgKi8KLQotCWlmICghSVNf
RU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1RfQlJPS0VOKSkKLQkJcmV0dXJuIDA7Ci0K
LQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQpIHsKLQkJSTkxNV9STkRfU1RBVEUocHJu
Zyk7Ci0JCWludCBlcnIgPSAwLCBpOwotCi0JCWlmICghaW50ZWxfaGFzX3Jlc2V0X2VuZ2luZShl
bmdpbmUtPmd0KSkKLQkJCWNvbnRpbnVlOwotCi0JCWludGVsX2VuZ2luZV9wbV9nZXQoZW5naW5l
KTsKLQkJZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewotCQkJZXJyID0gX19scmNfZ2FyYmFnZShl
bmdpbmUsICZwcm5nKTsKLQkJCWlmIChlcnIpCi0JCQkJYnJlYWs7Ci0JCX0KLQkJaW50ZWxfZW5n
aW5lX3BtX3B1dChlbmdpbmUpOwotCi0JCWlmIChpZ3RfZmx1c2hfdGVzdChndC0+aTkxNSkpCi0J
CQllcnIgPSAtRUlPOwotCQlpZiAoZXJyKQotCQkJcmV0dXJuIGVycjsKLQl9Ci0KLQlyZXR1cm4g
MDsKLX0KLQotc3RhdGljIGludCBfX2xpdmVfcHBod3NwX3J1bnRpbWUoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQotewotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKLQlzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycTsKLQlJR1RfVElNRU9VVChlbmRfdGltZSk7Ci0JaW50IGVycjsKLQot
CWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5naW5lKTsKLQlpZiAoSVNfRVJSKGNlKSkKLQkJ
cmV0dXJuIFBUUl9FUlIoY2UpOwotCi0JY2UtPnJ1bnRpbWUubnVtX3VuZGVyZmxvdyA9IDA7Ci0J
Y2UtPnJ1bnRpbWUubWF4X3VuZGVyZmxvdyA9IDA7Ci0KLQlkbyB7Ci0JCXVuc2lnbmVkIGludCBs
b29wID0gMTAyNDsKLQotCQl3aGlsZSAobG9vcCkgewotCQkJcnEgPSBpbnRlbF9jb250ZXh0X2Ny
ZWF0ZV9yZXF1ZXN0KGNlKTsKLQkJCWlmIChJU19FUlIocnEpKSB7Ci0JCQkJZXJyID0gUFRSX0VS
UihycSk7Ci0JCQkJZ290byBlcnJfcnE7Ci0JCQl9Ci0KLQkJCWlmICgtLWxvb3AgPT0gMCkKLQkJ
CQlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKLQotCQkJaTkxNV9yZXF1ZXN0X2FkZChycSk7Ci0JCX0K
LQotCQlpZiAoX19pZ3RfdGltZW91dChlbmRfdGltZSwgTlVMTCkpCi0JCQlicmVhazsKLQotCQlp
OTE1X3JlcXVlc3RfcHV0KHJxKTsKLQl9IHdoaWxlICgxKTsKLQotCWVyciA9IGk5MTVfcmVxdWVz
dF93YWl0KHJxLCAwLCBIWiAvIDUpOwotCWlmIChlcnIgPCAwKSB7Ci0JCXByX2VycigiJXM6IHJl
cXVlc3Qgbm90IGNvbXBsZXRlZCFcbiIsIGVuZ2luZS0+bmFtZSk7Ci0JCWdvdG8gZXJyX3dhaXQ7
Ci0JfQotCi0JaWd0X2ZsdXNoX3Rlc3QoZW5naW5lLT5pOTE1KTsKLQotCXByX2luZm8oIiVzOiBw
cGh3c3AgcnVudGltZSAlbGx1bnMsIGF2ZXJhZ2UgJWxsdW5zXG4iLAotCQllbmdpbmUtPm5hbWUs
Ci0JCWludGVsX2NvbnRleHRfZ2V0X3RvdGFsX3J1bnRpbWVfbnMoY2UpLAotCQlpbnRlbF9jb250
ZXh0X2dldF9hdmdfcnVudGltZV9ucyhjZSkpOwotCi0JZXJyID0gMDsKLQlpZiAoY2UtPnJ1bnRp
bWUubnVtX3VuZGVyZmxvdykgewotCQlwcl9lcnIoIiVzOiBwcGh3c3AgdW5kZXJmbG93ICV1IHRp
bWUocyksIG1heCAldSBjeWNsZXMhXG4iLAotCQkgICAgICAgZW5naW5lLT5uYW1lLAotCQkgICAg
ICAgY2UtPnJ1bnRpbWUubnVtX3VuZGVyZmxvdywKLQkJICAgICAgIGNlLT5ydW50aW1lLm1heF91
bmRlcmZsb3cpOwotCQlHRU1fVFJBQ0VfRFVNUCgpOwotCQllcnIgPSAtRU9WRVJGTE9XOwotCX0K
LQotZXJyX3dhaXQ6Ci0JaTkxNV9yZXF1ZXN0X3B1dChycSk7Ci1lcnJfcnE6Ci0JaW50ZWxfY29u
dGV4dF9wdXQoY2UpOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBpbnQgbGl2ZV9wcGh3c3Bf
cnVudGltZSh2b2lkICphcmcpCi17Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKLQlzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0JZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0J
aW50IGVyciA9IDA7Ci0KLQkvKgotCSAqIENoZWNrIHRoYXQgY3VtdWxhdGl2ZSBjb250ZXh0IHJ1
bnRpbWUgYXMgc3RvcmVkIGluIHRoZSBwcGh3c3BbMTZdCi0JICogaXMgbW9ub3RvbmljLgotCSAq
LwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7Ci0JCWVyciA9IF9fbGl2ZV9w
cGh3c3BfcnVudGltZShlbmdpbmUpOwotCQlpZiAoZXJyKQotCQkJYnJlYWs7Ci0JfQotCi0JaWYg
KGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKLQkJZXJyID0gLUVJTzsKLQotCXJldHVybiBlcnI7
Ci19Ci0KLWludCBpbnRlbF9scmNfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCi17Ci0Jc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9
IHsKLQkJU1VCVEVTVChsaXZlX2xyY19sYXlvdXQpLAotCQlTVUJURVNUKGxpdmVfbHJjX2ZpeGVk
KSwKLQkJU1VCVEVTVChsaXZlX2xyY19zdGF0ZSksCi0JCVNVQlRFU1QobGl2ZV9scmNfZ3ByKSwK
LQkJU1VCVEVTVChsaXZlX2xyY19pc29sYXRpb24pLAotCQlTVUJURVNUKGxpdmVfbHJjX3RpbWVz
dGFtcCksCi0JCVNVQlRFU1QobGl2ZV9scmNfZ2FyYmFnZSksCi0JCVNVQlRFU1QobGl2ZV9wcGh3
c3BfcnVudGltZSksCi0JCVNVQlRFU1QobGl2ZV9scmNfaW5kaXJlY3RfY3R4X2JiKSwKLQl9Owot
Ci0JaWYgKCFIQVNfTE9HSUNBTF9SSU5HX0NPTlRFWFRTKGk5MTUpKQotCQlyZXR1cm4gMDsKLQot
CXJldHVybiBpbnRlbF9ndF9saXZlX3N1YnRlc3RzKHRlc3RzLCAmaTkxNS0+Z3QpOwotfQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRl
eCAwMDAwMDAwMDAwMDAuLmVlZGQyMzI3NWMyMwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCkBAIC0wLDAgKzEsMTg2NCBAQAorLy8gU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorLyoKKyAqIENvcHlyaWdodCDCqSAyMDE4IEludGVs
IENvcnBvcmF0aW9uCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L3ByaW1lX251bWJlcnMuaD4KKwor
I2luY2x1ZGUgImk5MTVfc2VsZnRlc3QuaCIKKyNpbmNsdWRlICJpbnRlbF9lbmdpbmVfaGVhcnRi
ZWF0LmgiCisjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3BtLmgiCisjaW5jbHVkZSAiaW50ZWxfcmVz
ZXQuaCIKKyNpbmNsdWRlICJpbnRlbF9yaW5nLmgiCisjaW5jbHVkZSAic2VsZnRlc3RfZW5naW5l
X2hlYXJ0YmVhdC5oIgorI2luY2x1ZGUgInNlbGZ0ZXN0cy9pOTE1X3JhbmRvbS5oIgorI2luY2x1
ZGUgInNlbGZ0ZXN0cy9pZ3RfZmx1c2hfdGVzdC5oIgorI2luY2x1ZGUgInNlbGZ0ZXN0cy9pZ3Rf
bGl2ZV90ZXN0LmgiCisjaW5jbHVkZSAic2VsZnRlc3RzL2lndF9zcGlubmVyLmgiCisjaW5jbHVk
ZSAic2VsZnRlc3RzL2xpYl9zd19mZW5jZS5oIgorI2luY2x1ZGUgInNobWVtX3V0aWxzLmgiCisK
KyNpbmNsdWRlICJnZW0vc2VsZnRlc3RzL2lndF9nZW1fdXRpbHMuaCIKKyNpbmNsdWRlICJnZW0v
c2VsZnRlc3RzL21vY2tfY29udGV4dC5oIgorCisjZGVmaW5lIENTX0dQUihlbmdpbmUsIG4pICgo
ZW5naW5lKS0+bW1pb19iYXNlICsgMHg2MDAgKyAobikgKiA0KQorI2RlZmluZSBOVU1fR1BSIDE2
CisjZGVmaW5lIE5VTV9HUFJfRFcgKE5VTV9HUFIgKiAyKSAvKiBlYWNoIEdQUiBpcyAyIGR3b3Jk
cyAqLworCitzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpjcmVhdGVfc2NyYXRjaChzdHJ1Y3QgaW50
ZWxfZ3QgKmd0KQoreworCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0
IGk5MTVfdm1hICp2bWE7CisJaW50IGVycjsKKworCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9jcmVh
dGVfaW50ZXJuYWwoZ3QtPmk5MTUsIFBBR0VfU0laRSk7CisJaWYgKElTX0VSUihvYmopKQorCQly
ZXR1cm4gRVJSX0NBU1Qob2JqKTsKKworCWk5MTVfZ2VtX29iamVjdF9zZXRfY2FjaGVfY29oZXJl
bmN5KG9iaiwgSTkxNV9DQUNISU5HX0NBQ0hFRCk7CisKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5j
ZShvYmosICZndC0+Z2d0dC0+dm0sIE5VTEwpOworCWlmIChJU19FUlIodm1hKSkgeworCQlpOTE1
X2dlbV9vYmplY3RfcHV0KG9iaik7CisJCXJldHVybiB2bWE7CisJfQorCisJZXJyID0gaTkxNV92
bWFfcGluKHZtYSwgMCwgMCwgUElOX0dMT0JBTCk7CisJaWYgKGVycikgeworCQlpOTE1X2dlbV9v
YmplY3RfcHV0KG9iaik7CisJCXJldHVybiBFUlJfUFRSKGVycik7CisJfQorCisJcmV0dXJuIHZt
YTsKK30KKworc3RhdGljIGJvb2wgaXNfYWN0aXZlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQor
eworCWlmIChpOTE1X3JlcXVlc3RfaXNfYWN0aXZlKHJxKSkKKwkJcmV0dXJuIHRydWU7CisKKwlp
ZiAoaTkxNV9yZXF1ZXN0X29uX2hvbGQocnEpKQorCQlyZXR1cm4gdHJ1ZTsKKworCWlmIChpOTE1
X3JlcXVlc3RfaGFzX2luaXRpYWxfYnJlYWRjcnVtYihycSkgJiYgaTkxNV9yZXF1ZXN0X3N0YXJ0
ZWQocnEpKQorCQlyZXR1cm4gdHJ1ZTsKKworCXJldHVybiBmYWxzZTsKK30KKworc3RhdGljIGlu
dCB3YWl0X2Zvcl9zdWJtaXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkJICAg
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCisJCQkgICB1bnNpZ25lZCBsb25nIHRpbWVvdXQpCit7
CisJdGltZW91dCArPSBqaWZmaWVzOworCWRvIHsKKwkJYm9vbCBkb25lID0gdGltZV9hZnRlcihq
aWZmaWVzLCB0aW1lb3V0KTsKKworCQlpZiAoaTkxNV9yZXF1ZXN0X2NvbXBsZXRlZChycSkpIC8q
IHRoYXQgd2FzIHF1aWNrISAqLworCQkJcmV0dXJuIDA7CisKKwkJLyogV2FpdCB1bnRpbCB0aGUg
SFcgaGFzIGFja25vd2xlZ2VkIHRoZSBzdWJtaXNzaW9uIChvciBlcnIpICovCisJCWludGVsX2Vu
Z2luZV9mbHVzaF9zdWJtaXNzaW9uKGVuZ2luZSk7CisJCWlmICghUkVBRF9PTkNFKGVuZ2luZS0+
ZXhlY2xpc3RzLnBlbmRpbmdbMF0pICYmIGlzX2FjdGl2ZShycSkpCisJCQlyZXR1cm4gMDsKKwor
CQlpZiAoZG9uZSkKKwkJCXJldHVybiAtRVRJTUU7CisKKwkJY29uZF9yZXNjaGVkKCk7CisJfSB3
aGlsZSAoMSk7Cit9CisKK3N0YXRpYyBpbnQgZW1pdF9zZW1hcGhvcmVfc2lnbmFsKHN0cnVjdCBp
bnRlbF9jb250ZXh0ICpjZSwgdm9pZCAqc2xvdCkKK3sKKwljb25zdCB1MzIgb2Zmc2V0ID0KKwkJ
aTkxNV9nZ3R0X29mZnNldChjZS0+ZW5naW5lLT5zdGF0dXNfcGFnZS52bWEpICsKKwkJb2Zmc2V0
X2luX3BhZ2Uoc2xvdCk7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJdTMyICpjczsKKwor
CXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7CisJaWYgKElTX0VSUihycSkp
CisJCXJldHVybiBQVFJfRVJSKHJxKTsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgNCk7
CisJaWYgKElTX0VSUihjcykpIHsKKwkJaTkxNV9yZXF1ZXN0X2FkZChycSk7CisJCXJldHVybiBQ
VFJfRVJSKGNzKTsKKwl9CisKKwkqY3MrKyA9IE1JX1NUT1JFX0RXT1JEX0lNTV9HRU40IHwgTUlf
VVNFX0dHVFQ7CisJKmNzKysgPSBvZmZzZXQ7CisJKmNzKysgPSAwOworCSpjcysrID0gMTsKKwor
CWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCisJcnEtPnNjaGVkLmF0dHIucHJpb3JpdHkg
PSBJOTE1X1BSSU9SSVRZX0JBUlJJRVI7CisJaTkxNV9yZXF1ZXN0X2FkZChycSk7CisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgY29udGV4dF9mbHVzaChzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UsIGxvbmcgdGltZW91dCkKK3sKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKKwlzdHJ1Y3Qg
ZG1hX2ZlbmNlICpmZW5jZTsKKwlpbnQgZXJyID0gMDsKKworCXJxID0gaW50ZWxfZW5naW5lX2Ny
ZWF0ZV9rZXJuZWxfcmVxdWVzdChjZS0+ZW5naW5lKTsKKwlpZiAoSVNfRVJSKHJxKSkKKwkJcmV0
dXJuIFBUUl9FUlIocnEpOworCisJZmVuY2UgPSBpOTE1X2FjdGl2ZV9mZW5jZV9nZXQoJmNlLT50
aW1lbGluZS0+bGFzdF9yZXF1ZXN0KTsKKwlpZiAoZmVuY2UpIHsKKwkJaTkxNV9yZXF1ZXN0X2F3
YWl0X2RtYV9mZW5jZShycSwgZmVuY2UpOworCQlkbWFfZmVuY2VfcHV0KGZlbmNlKTsKKwl9CisK
KwlycSA9IGk5MTVfcmVxdWVzdF9nZXQocnEpOworCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCWlm
IChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgdGltZW91dCkgPCAwKQorCQllcnIgPSAtRVRJTUU7
CisJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisKKwlybWIoKTsgLyogV2Uga25vdyB0aGUgcmVxdWVz
dCBpcyB3cml0dGVuLCBtYWtlIHN1cmUgYWxsIHN0YXRlIGlzIHRvbyEgKi8KKwlyZXR1cm4gZXJy
OworfQorCitzdGF0aWMgaW50IGxpdmVfbHJjX2xheW91dCh2b2lkICphcmcpCit7CisJc3RydWN0
IGludGVsX2d0ICpndCA9IGFyZzsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7CisJ
ZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJdTMyICpscmM7CisJaW50IGVycjsKKworCS8qCisJ
ICogQ2hlY2sgdGhlIHJlZ2lzdGVycyBvZmZzZXRzIHdlIHVzZSB0byBjcmVhdGUgdGhlIGluaXRp
YWwgcmVnIHN0YXRlCisJICogbWF0Y2ggdGhlIGxheW91dCBzYXZlZCBieSBIVy4KKwkgKi8KKwor
CWxyYyA9IGttYWxsb2MoUEFHRV9TSVpFLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWxyYykKKwkJcmV0
dXJuIC1FTk9NRU07CisKKwllcnIgPSAwOworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBp
ZCkgeworCQl1MzIgKmh3OworCQlpbnQgZHc7CisKKwkJaWYgKCFlbmdpbmUtPmRlZmF1bHRfc3Rh
dGUpCisJCQljb250aW51ZTsKKworCQlodyA9IHNobWVtX3Bpbl9tYXAoZW5naW5lLT5kZWZhdWx0
X3N0YXRlKTsKKwkJaWYgKElTX0VSUihodykpIHsKKwkJCWVyciA9IFBUUl9FUlIoaHcpOworCQkJ
YnJlYWs7CisJCX0KKwkJaHcgKz0gTFJDX1NUQVRFX09GRlNFVCAvIHNpemVvZigqaHcpOworCisJ
CV9fbHJjX2luaXRfcmVncyhtZW1zZXQobHJjLCBQT0lTT05fSU5VU0UsIFBBR0VfU0laRSksCisJ
CQkJZW5naW5lLT5rZXJuZWxfY29udGV4dCwKKwkJCQllbmdpbmUsCisJCQkJZW5naW5lLT5rZXJu
ZWxfY29udGV4dC0+cmluZywKKwkJCQl0cnVlKTsKKworCQlkdyA9IDA7CisJCWRvIHsKKwkJCXUz
MiBscmkgPSBod1tkd107CisKKwkJCWlmIChscmkgPT0gMCkgeworCQkJCWR3Kys7CisJCQkJY29u
dGludWU7CisJCQl9CisKKwkJCWlmIChscmNbZHddID09IDApIHsKKwkJCQlwcl9kZWJ1ZygiJXM6
IHNraXBwZWQgaW5zdHJ1Y3Rpb24gJXggYXQgZHdvcmQgJWRcbiIsCisJCQkJCSBlbmdpbmUtPm5h
bWUsIGxyaSwgZHcpOworCQkJCWR3Kys7CisJCQkJY29udGludWU7CisJCQl9CisKKwkJCWlmICgo
bHJpICYgR0VOTUFTSygzMSwgMjMpKSAhPSBNSV9JTlNUUigweDIyLCAwKSkgeworCQkJCXByX2Vy
cigiJXM6IEV4cGVjdGVkIExSSSBjb21tYW5kIGF0IGR3b3JkICVkLCBmb3VuZCAlMDh4XG4iLAor
CQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGR3LCBscmkpOworCQkJCWVyciA9IC1FSU5WQUw7CisJ
CQkJYnJlYWs7CisJCQl9CisKKwkJCWlmIChscmNbZHddICE9IGxyaSkgeworCQkJCXByX2Vycigi
JXM6IExSSSBjb21tYW5kIG1pc21hdGNoIGF0IGR3b3JkICVkLCBleHBlY3RlZCAlMDh4IGZvdW5k
ICUwOHhcbiIsCisJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwgZHcsIGxyaSwgbHJjW2R3XSk7CisJ
CQkJZXJyID0gLUVJTlZBTDsKKwkJCQlicmVhazsKKwkJCX0KKworCQkJbHJpICY9IDB4N2Y7CisJ
CQlscmkrKzsKKwkJCWR3Kys7CisKKwkJCXdoaWxlIChscmkpIHsKKwkJCQlpZiAoaHdbZHddICE9
IGxyY1tkd10pIHsKKwkJCQkJcHJfZXJyKCIlczogRGlmZmVyZW50IHJlZ2lzdGVycyBmb3VuZCBh
dCBkd29yZCAlZCwgZXhwZWN0ZWQgJXgsIGZvdW5kICV4XG4iLAorCQkJCQkgICAgICAgZW5naW5l
LT5uYW1lLCBkdywgaHdbZHddLCBscmNbZHddKTsKKwkJCQkJZXJyID0gLUVJTlZBTDsKKwkJCQkJ
YnJlYWs7CisJCQkJfQorCisJCQkJLyoKKwkJCQkgKiBTa2lwIG92ZXIgdGhlIGFjdHVhbCByZWdp
c3RlciB2YWx1ZSBhcyB3ZQorCQkJCSAqIGV4cGVjdCB0aGF0IHRvIGRpZmZlci4KKwkJCQkgKi8K
KwkJCQlkdyArPSAyOworCQkJCWxyaSAtPSAyOworCQkJfQorCQl9IHdoaWxlICgobHJjW2R3XSAm
IH5CSVQoMCkpICE9IE1JX0JBVENIX0JVRkZFUl9FTkQpOworCisJCWlmIChlcnIpIHsKKwkJCXBy
X2luZm8oIiVzOiBIVyByZWdpc3RlciBpbWFnZTpcbiIsIGVuZ2luZS0+bmFtZSk7CisJCQlpZ3Rf
aGV4ZHVtcChodywgUEFHRV9TSVpFKTsKKworCQkJcHJfaW5mbygiJXM6IFNXIHJlZ2lzdGVyIGlt
YWdlOlxuIiwgZW5naW5lLT5uYW1lKTsKKwkJCWlndF9oZXhkdW1wKGxyYywgUEFHRV9TSVpFKTsK
KwkJfQorCisJCXNobWVtX3VucGluX21hcChlbmdpbmUtPmRlZmF1bHRfc3RhdGUsIGh3KTsKKwkJ
aWYgKGVycikKKwkJCWJyZWFrOworCX0KKworCWtmcmVlKGxyYyk7CisJcmV0dXJuIGVycjsKK30K
Kworc3RhdGljIGludCBmaW5kX29mZnNldChjb25zdCB1MzIgKmxyaSwgdTMyIG9mZnNldCkKK3sK
KwlpbnQgaTsKKworCWZvciAoaSA9IDA7IGkgPCBQQUdFX1NJWkUgLyBzaXplb2YodTMyKTsgaSsr
KQorCQlpZiAobHJpW2ldID09IG9mZnNldCkKKwkJCXJldHVybiBpOworCisJcmV0dXJuIC0xOwor
fQorCitzdGF0aWMgaW50IGxpdmVfbHJjX2ZpeGVkKHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3QgaW50
ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwllbnVt
IGludGVsX2VuZ2luZV9pZCBpZDsKKwlpbnQgZXJyID0gMDsKKworCS8qCisJICogQ2hlY2sgdGhl
IGFzc3VtZWQgcmVnaXN0ZXIgb2Zmc2V0cyBtYXRjaCB0aGUgYWN0dWFsIGxvY2F0aW9ucyBpbgor
CSAqIHRoZSBjb250ZXh0IGltYWdlLgorCSAqLworCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwg
Z3QsIGlkKSB7CisJCWNvbnN0IHN0cnVjdCB7CisJCQl1MzIgcmVnOworCQkJdTMyIG9mZnNldDsK
KwkJCWNvbnN0IGNoYXIgKm5hbWU7CisJCX0gdGJsW10gPSB7CisJCQl7CisJCQkJaTkxNV9tbWlv
X3JlZ19vZmZzZXQoUklOR19TVEFSVChlbmdpbmUtPm1taW9fYmFzZSkpLAorCQkJCUNUWF9SSU5H
X1NUQVJUIC0gMSwKKwkJCQkiUklOR19TVEFSVCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlv
X3JlZ19vZmZzZXQoUklOR19DVEwoZW5naW5lLT5tbWlvX2Jhc2UpKSwKKwkJCQlDVFhfUklOR19D
VEwgLSAxLAorCQkJCSJSSU5HX0NUTCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19v
ZmZzZXQoUklOR19IRUFEKGVuZ2luZS0+bW1pb19iYXNlKSksCisJCQkJQ1RYX1JJTkdfSEVBRCAt
IDEsCisJCQkJIlJJTkdfSEVBRCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZz
ZXQoUklOR19UQUlMKGVuZ2luZS0+bW1pb19iYXNlKSksCisJCQkJQ1RYX1JJTkdfVEFJTCAtIDEs
CisJCQkJIlJJTkdfVEFJTCIKKwkJCX0sCisJCQl7CisJCQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQo
UklOR19NSV9NT0RFKGVuZ2luZS0+bW1pb19iYXNlKSksCisJCQkJbHJjX3JpbmdfbWlfbW9kZShl
bmdpbmUpLAorCQkJCSJSSU5HX01JX01PREUiCisJCQl9LAorCQkJeworCQkJCWk5MTVfbW1pb19y
ZWdfb2Zmc2V0KFJJTkdfQkJTVEFURShlbmdpbmUtPm1taW9fYmFzZSkpLAorCQkJCUNUWF9CQl9T
VEFURSAtIDEsCisJCQkJIkJCX1NUQVRFIgorCQkJfSwKKwkJCXsKKwkJCQlpOTE1X21taW9fcmVn
X29mZnNldChSSU5HX0JCX1BFUl9DVFhfUFRSKGVuZ2luZS0+bW1pb19iYXNlKSksCisJCQkJbHJj
X3Jpbmdfd2FfYmJfcGVyX2N0eChlbmdpbmUpLAorCQkJCSJSSU5HX0JCX1BFUl9DVFhfUFRSIgor
CQkJfSwKKwkJCXsKKwkJCQlpOTE1X21taW9fcmVnX29mZnNldChSSU5HX0lORElSRUNUX0NUWChl
bmdpbmUtPm1taW9fYmFzZSkpLAorCQkJCWxyY19yaW5nX2luZGlyZWN0X3B0cihlbmdpbmUpLAor
CQkJCSJSSU5HX0lORElSRUNUX0NUWF9QVFIiCisJCQl9LAorCQkJeworCQkJCWk5MTVfbW1pb19y
ZWdfb2Zmc2V0KFJJTkdfSU5ESVJFQ1RfQ1RYX09GRlNFVChlbmdpbmUtPm1taW9fYmFzZSkpLAor
CQkJCWxyY19yaW5nX2luZGlyZWN0X29mZnNldChlbmdpbmUpLAorCQkJCSJSSU5HX0lORElSRUNU
X0NUWF9PRkZTRVQiCisJCQl9LAorCQkJeworCQkJCWk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdf
Q1RYX1RJTUVTVEFNUChlbmdpbmUtPm1taW9fYmFzZSkpLAorCQkJCUNUWF9USU1FU1RBTVAgLSAx
LAorCQkJCSJSSU5HX0NUWF9USU1FU1RBTVAiCisJCQl9LAorCQkJeworCQkJCWk5MTVfbW1pb19y
ZWdfb2Zmc2V0KEdFTjhfUklOR19DU19HUFIoZW5naW5lLT5tbWlvX2Jhc2UsIDApKSwKKwkJCQls
cmNfcmluZ19ncHIwKGVuZ2luZSksCisJCQkJIlJJTkdfQ1NfR1BSMCIKKwkJCX0sCisJCQl7CisJ
CQkJaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DTURfQlVGX0NDVEwoZW5naW5lLT5tbWlvX2Jh
c2UpKSwKKwkJCQlscmNfcmluZ19jbWRfYnVmX2NjdGwoZW5naW5lKSwKKwkJCQkiUklOR19DTURf
QlVGX0NDVEwiCisJCQl9LAorCQkJeyB9LAorCQl9LCAqdDsKKwkJdTMyICpodzsKKworCQlpZiAo
IWVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSkKKwkJCWNvbnRpbnVlOworCisJCWh3ID0gc2htZW1fcGlu
X21hcChlbmdpbmUtPmRlZmF1bHRfc3RhdGUpOworCQlpZiAoSVNfRVJSKGh3KSkgeworCQkJZXJy
ID0gUFRSX0VSUihodyk7CisJCQlicmVhazsKKwkJfQorCQlodyArPSBMUkNfU1RBVEVfT0ZGU0VU
IC8gc2l6ZW9mKCpodyk7CisKKwkJZm9yICh0ID0gdGJsOyB0LT5uYW1lOyB0KyspIHsKKwkJCWlu
dCBkdyA9IGZpbmRfb2Zmc2V0KGh3LCB0LT5yZWcpOworCisJCQlpZiAoZHcgIT0gdC0+b2Zmc2V0
KSB7CisJCQkJcHJfZXJyKCIlczogT2Zmc2V0IGZvciAlcyBbMHgleF0gbWlzbWF0Y2gsIGZvdW5k
ICV4LCBleHBlY3RlZCAleFxuIiwKKwkJCQkgICAgICAgZW5naW5lLT5uYW1lLAorCQkJCSAgICAg
ICB0LT5uYW1lLAorCQkJCSAgICAgICB0LT5yZWcsCisJCQkJICAgICAgIGR3LAorCQkJCSAgICAg
ICB0LT5vZmZzZXQpOworCQkJCWVyciA9IC1FSU5WQUw7CisJCQl9CisJCX0KKworCQlzaG1lbV91
bnBpbl9tYXAoZW5naW5lLT5kZWZhdWx0X3N0YXRlLCBodyk7CisJfQorCisJcmV0dXJuIGVycjsK
K30KKworc3RhdGljIGludCBfX2xpdmVfbHJjX3N0YXRlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSwKKwkJCSAgICBzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2gpCit7CisJc3RydWN0IGlu
dGVsX2NvbnRleHQgKmNlOworCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCXN0cnVjdCBpOTE1
X2dlbV93d19jdHggd3c7CisJZW51bSB7CisJCVJJTkdfU1RBUlRfSURYID0gMCwKKwkJUklOR19U
QUlMX0lEWCwKKwkJTUFYX0lEWAorCX07CisJdTMyIGV4cGVjdGVkW01BWF9JRFhdOworCXUzMiAq
Y3M7CisJaW50IGVycjsKKwlpbnQgbjsKKworCWNlID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5n
aW5lKTsKKwlpZiAoSVNfRVJSKGNlKSkKKwkJcmV0dXJuIFBUUl9FUlIoY2UpOworCisJaTkxNV9n
ZW1fd3dfY3R4X2luaXQoJnd3LCBmYWxzZSk7CityZXRyeToKKwllcnIgPSBpOTE1X2dlbV9vYmpl
Y3RfbG9jayhzY3JhdGNoLT5vYmosICZ3dyk7CisJaWYgKCFlcnIpCisJCWVyciA9IGludGVsX2Nv
bnRleHRfcGluX3d3KGNlLCAmd3cpOworCWlmIChlcnIpCisJCWdvdG8gZXJyX3B1dDsKKworCXJx
ID0gaTkxNV9yZXF1ZXN0X2NyZWF0ZShjZSk7CisJaWYgKElTX0VSUihycSkpIHsKKwkJZXJyID0g
UFRSX0VSUihycSk7CisJCWdvdG8gZXJyX3VucGluOworCX0KKworCWNzID0gaW50ZWxfcmluZ19i
ZWdpbihycSwgNCAqIE1BWF9JRFgpOworCWlmIChJU19FUlIoY3MpKSB7CisJCWVyciA9IFBUUl9F
UlIoY3MpOworCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKKwkJZ290byBlcnJfdW5waW47CisJfQor
CisJKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1VTRV9HR1RUOworCSpj
cysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19TVEFSVChlbmdpbmUtPm1taW9fYmFzZSkp
OworCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChzY3JhdGNoKSArIFJJTkdfU1RBUlRfSURYICog
c2l6ZW9mKHUzMik7CisJKmNzKysgPSAwOworCisJZXhwZWN0ZWRbUklOR19TVEFSVF9JRFhdID0g
aTkxNV9nZ3R0X29mZnNldChjZS0+cmluZy0+dm1hKTsKKworCSpjcysrID0gTUlfU1RPUkVfUkVH
SVNURVJfTUVNX0dFTjggfCBNSV9VU0VfR0dUVDsKKwkqY3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zm
c2V0KFJJTkdfVEFJTChlbmdpbmUtPm1taW9fYmFzZSkpOworCSpjcysrID0gaTkxNV9nZ3R0X29m
ZnNldChzY3JhdGNoKSArIFJJTkdfVEFJTF9JRFggKiBzaXplb2YodTMyKTsKKwkqY3MrKyA9IDA7
CisKKwllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfb2JqZWN0KHJxLCBzY3JhdGNoLT5vYmosIHRy
dWUpOworCWlmICghZXJyKQorCQllcnIgPSBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzY3JhdGNo
LCBycSwgRVhFQ19PQkpFQ1RfV1JJVEUpOworCisJaTkxNV9yZXF1ZXN0X2dldChycSk7CisJaTkx
NV9yZXF1ZXN0X2FkZChycSk7CisJaWYgKGVycikKKwkJZ290byBlcnJfcnE7CisKKwlpbnRlbF9l
bmdpbmVfZmx1c2hfc3VibWlzc2lvbihlbmdpbmUpOworCWV4cGVjdGVkW1JJTkdfVEFJTF9JRFhd
ID0gY2UtPnJpbmctPnRhaWw7CisKKwlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQocnEsIDAsIEhaIC8g
NSkgPCAwKSB7CisJCWVyciA9IC1FVElNRTsKKwkJZ290byBlcnJfcnE7CisJfQorCisJY3MgPSBp
OTE1X2dlbV9vYmplY3RfcGluX21hcChzY3JhdGNoLT5vYmosIEk5MTVfTUFQX1dCKTsKKwlpZiAo
SVNfRVJSKGNzKSkgeworCQllcnIgPSBQVFJfRVJSKGNzKTsKKwkJZ290byBlcnJfcnE7CisJfQor
CisJZm9yIChuID0gMDsgbiA8IE1BWF9JRFg7IG4rKykgeworCQlpZiAoY3Nbbl0gIT0gZXhwZWN0
ZWRbbl0pIHsKKwkJCXByX2VycigiJXM6IFN0b3JlZCByZWdpc3RlclslZF0gdmFsdWVbMHgleF0g
ZGlkIG5vdCBtYXRjaCBleHBlY3RlZFsweCV4XVxuIiwKKwkJCSAgICAgICBlbmdpbmUtPm5hbWUs
IG4sIGNzW25dLCBleHBlY3RlZFtuXSk7CisJCQllcnIgPSAtRUlOVkFMOworCQkJYnJlYWs7CisJ
CX0KKwl9CisKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHNjcmF0Y2gtPm9iaik7CisKK2Vy
cl9ycToKKwlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKK2Vycl91bnBpbjoKKwlpbnRlbF9jb250ZXh0
X3VucGluKGNlKTsKK2Vycl9wdXQ6CisJaWYgKGVyciA9PSAtRURFQURMSykgeworCQllcnIgPSBp
OTE1X2dlbV93d19jdHhfYmFja29mZigmd3cpOworCQlpZiAoIWVycikKKwkJCWdvdG8gcmV0cnk7
CisJfQorCWk5MTVfZ2VtX3d3X2N0eF9maW5pKCZ3dyk7CisJaW50ZWxfY29udGV4dF9wdXQoY2Up
OworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9scmNfc3RhdGUodm9pZCAqYXJn
KQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CisJc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lOworCXN0cnVjdCBpOTE1X3ZtYSAqc2NyYXRjaDsKKwllbnVtIGludGVsX2VuZ2lu
ZV9pZCBpZDsKKwlpbnQgZXJyID0gMDsKKworCS8qCisJICogQ2hlY2sgdGhlIGxpdmUgcmVnaXN0
ZXIgc3RhdGUgbWF0Y2hlcyB3aGF0IHdlIGV4cGVjdCBmb3IgdGhpcworCSAqIGludGVsX2NvbnRl
eHQuCisJICovCisKKwlzY3JhdGNoID0gY3JlYXRlX3NjcmF0Y2goZ3QpOworCWlmIChJU19FUlIo
c2NyYXRjaCkpCisJCXJldHVybiBQVFJfRVJSKHNjcmF0Y2gpOworCisJZm9yX2VhY2hfZW5naW5l
KGVuZ2luZSwgZ3QsIGlkKSB7CisJCWVyciA9IF9fbGl2ZV9scmNfc3RhdGUoZW5naW5lLCBzY3Jh
dGNoKTsKKwkJaWYgKGVycikKKwkJCWJyZWFrOworCX0KKworCWlmIChpZ3RfZmx1c2hfdGVzdChn
dC0+aTkxNSkpCisJCWVyciA9IC1FSU87CisKKwlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgm
c2NyYXRjaCwgMCk7CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBncHJfbWFrZV9kaXJ0
eShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCit7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7
CisJdTMyICpjczsKKwlpbnQgbjsKKworCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVz
dChjZSk7CisJaWYgKElTX0VSUihycSkpCisJCXJldHVybiBQVFJfRVJSKHJxKTsKKworCWNzID0g
aW50ZWxfcmluZ19iZWdpbihycSwgMiAqIE5VTV9HUFJfRFcgKyAyKTsKKwlpZiAoSVNfRVJSKGNz
KSkgeworCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKKwkJcmV0dXJuIFBUUl9FUlIoY3MpOworCX0K
KworCSpjcysrID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oTlVNX0dQUl9EVyk7CisJZm9yIChuID0g
MDsgbiA8IE5VTV9HUFJfRFc7IG4rKykgeworCQkqY3MrKyA9IENTX0dQUihjZS0+ZW5naW5lLCBu
KTsKKwkJKmNzKysgPSBTVEFDS19NQUdJQzsKKwl9CisJKmNzKysgPSBNSV9OT09QOworCisJaW50
ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7CisKKwlycS0+c2NoZWQuYXR0ci5wcmlvcml0eSA9IEk5
MTVfUFJJT1JJVFlfQkFSUklFUjsKKwlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKKworCXJldHVybiAw
OworfQorCitzdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVzdCAqCitfX2dwcl9yZWFkKHN0cnVjdCBp
bnRlbF9jb250ZXh0ICpjZSwgc3RydWN0IGk5MTVfdm1hICpzY3JhdGNoLCB1MzIgKnNsb3QpCit7
CisJY29uc3QgdTMyIG9mZnNldCA9CisJCWk5MTVfZ2d0dF9vZmZzZXQoY2UtPmVuZ2luZS0+c3Rh
dHVzX3BhZ2Uudm1hKSArCisJCW9mZnNldF9pbl9wYWdlKHNsb3QpOworCXN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxOworCXUzMiAqY3M7CisJaW50IGVycjsKKwlpbnQgbjsKKworCXJxID0gaW50ZWxf
Y29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7CisJaWYgKElTX0VSUihycSkpCisJCXJldHVybiBy
cTsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihycSwgNiArIDQgKiBOVU1fR1BSX0RXKTsKKwlp
ZiAoSVNfRVJSKGNzKSkgeworCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKKwkJcmV0dXJuIEVSUl9D
QVNUKGNzKTsKKwl9CisKKwkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRU5BQkxFOwor
CSpjcysrID0gTUlfTk9PUDsKKworCSpjcysrID0gTUlfU0VNQVBIT1JFX1dBSVQgfAorCQlNSV9T
RU1BUEhPUkVfR0xPQkFMX0dUVCB8CisJCU1JX1NFTUFQSE9SRV9QT0xMIHwKKwkJTUlfU0VNQVBI
T1JFX1NBRF9ORVFfU0REOworCSpjcysrID0gMDsKKwkqY3MrKyA9IG9mZnNldDsKKwkqY3MrKyA9
IDA7CisKKwlmb3IgKG4gPSAwOyBuIDwgTlVNX0dQUl9EVzsgbisrKSB7CisJCSpjcysrID0gTUlf
U1RPUkVfUkVHSVNURVJfTUVNX0dFTjggfCBNSV9VU0VfR0dUVDsKKwkJKmNzKysgPSBDU19HUFIo
Y2UtPmVuZ2luZSwgbik7CisJCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChzY3JhdGNoKSArIG4g
KiBzaXplb2YodTMyKTsKKwkJKmNzKysgPSAwOworCX0KKworCWk5MTVfdm1hX2xvY2soc2NyYXRj
aCk7CisJZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X29iamVjdChycSwgc2NyYXRjaC0+b2JqLCB0
cnVlKTsKKwlpZiAoIWVycikKKwkJZXJyID0gaTkxNV92bWFfbW92ZV90b19hY3RpdmUoc2NyYXRj
aCwgcnEsIEVYRUNfT0JKRUNUX1dSSVRFKTsKKwlpOTE1X3ZtYV91bmxvY2soc2NyYXRjaCk7CisK
KwlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKKwlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKKwlpZiAoZXJy
KSB7CisJCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCQlycSA9IEVSUl9QVFIoZXJyKTsKKwl9CisK
KwlyZXR1cm4gcnE7Cit9CisKK3N0YXRpYyBpbnQgX19saXZlX2xyY19ncHIoc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLAorCQkJICBzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2gsCisJCQkg
IGJvb2wgcHJlZW1wdCkKK3sKKwl1MzIgKnNsb3QgPSBtZW1zZXQzMihlbmdpbmUtPnN0YXR1c19w
YWdlLmFkZHIgKyAxMDAwLCAwLCA0KTsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CisJc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJdTMyICpjczsKKwlpbnQgZXJyOworCWludCBuOworCisJ
aWYgKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpIDwgOSAmJiBlbmdpbmUtPmNsYXNzICE9IFJFTkRF
Ul9DTEFTUykKKwkJcmV0dXJuIDA7IC8qIEdQUiBvbmx5IG9uIHJjczAgZm9yIGdlbjggKi8KKwor
CWVyciA9IGdwcl9tYWtlX2RpcnR5KGVuZ2luZS0+a2VybmVsX2NvbnRleHQpOworCWlmIChlcnIp
CisJCXJldHVybiBlcnI7CisKKwljZSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGVuZ2luZSk7CisJ
aWYgKElTX0VSUihjZSkpCisJCXJldHVybiBQVFJfRVJSKGNlKTsKKworCXJxID0gX19ncHJfcmVh
ZChjZSwgc2NyYXRjaCwgc2xvdCk7CisJaWYgKElTX0VSUihycSkpIHsKKwkJZXJyID0gUFRSX0VS
UihycSk7CisJCWdvdG8gZXJyX3B1dDsKKwl9CisKKwllcnIgPSB3YWl0X2Zvcl9zdWJtaXQoZW5n
aW5lLCBycSwgSFogLyAyKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9ycTsKKworCWlmIChwcmVl
bXB0KSB7CisJCWVyciA9IGdwcl9tYWtlX2RpcnR5KGVuZ2luZS0+a2VybmVsX2NvbnRleHQpOwor
CQlpZiAoZXJyKQorCQkJZ290byBlcnJfcnE7CisKKwkJZXJyID0gZW1pdF9zZW1hcGhvcmVfc2ln
bmFsKGVuZ2luZS0+a2VybmVsX2NvbnRleHQsIHNsb3QpOworCQlpZiAoZXJyKQorCQkJZ290byBl
cnJfcnE7CisJfSBlbHNlIHsKKwkJc2xvdFswXSA9IDE7CisJCXdtYigpOworCX0KKworCWlmIChp
OTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDApIHsKKwkJZXJyID0gLUVUSU1FOwor
CQlnb3RvIGVycl9ycTsKKwl9CisKKwljcyA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKHNjcmF0
Y2gtPm9iaiwgSTkxNV9NQVBfV0IpOworCWlmIChJU19FUlIoY3MpKSB7CisJCWVyciA9IFBUUl9F
UlIoY3MpOworCQlnb3RvIGVycl9ycTsKKwl9CisKKwlmb3IgKG4gPSAwOyBuIDwgTlVNX0dQUl9E
VzsgbisrKSB7CisJCWlmIChjc1tuXSkgeworCQkJcHJfZXJyKCIlczogR1BSWyVkXS4lcyB3YXMg
bm90IHplcm8sIGZvdW5kIDB4JTA4eCFcbiIsCisJCQkgICAgICAgZW5naW5lLT5uYW1lLAorCQkJ
ICAgICAgIG4gLyAyLCBuICYgMSA/ICJ1ZHciIDogImxkdyIsCisJCQkgICAgICAgY3Nbbl0pOwor
CQkJZXJyID0gLUVJTlZBTDsKKwkJCWJyZWFrOworCQl9CisJfQorCisJaTkxNV9nZW1fb2JqZWN0
X3VucGluX21hcChzY3JhdGNoLT5vYmopOworCitlcnJfcnE6CisJbWVtc2V0MzIoJnNsb3RbMF0s
IC0xLCA0KTsKKwl3bWIoKTsKKwlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKK2Vycl9wdXQ6CisJaW50
ZWxfY29udGV4dF9wdXQoY2UpOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9s
cmNfZ3ByKHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOworCXN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwlzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2g7CisJ
ZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJaW50IGVyciA9IDA7CisKKwkvKgorCSAqIENoZWNr
IHRoYXQgR1BSIHJlZ2lzdGVycyBhcmUgY2xlYXJlZCBpbiBuZXcgY29udGV4dHMgYXMgd2UgbmVl
ZAorCSAqIHRvIGF2b2lkIGxlYWtpbmcgYW55IGluZm9ybWF0aW9uIGZyb20gcHJldmlvdXMgY29u
dGV4dHMuCisJICovCisKKwlzY3JhdGNoID0gY3JlYXRlX3NjcmF0Y2goZ3QpOworCWlmIChJU19F
UlIoc2NyYXRjaCkpCisJCXJldHVybiBQVFJfRVJSKHNjcmF0Y2gpOworCisJZm9yX2VhY2hfZW5n
aW5lKGVuZ2luZSwgZ3QsIGlkKSB7CisJCXN0X2VuZ2luZV9oZWFydGJlYXRfZGlzYWJsZShlbmdp
bmUpOworCisJCWVyciA9IF9fbGl2ZV9scmNfZ3ByKGVuZ2luZSwgc2NyYXRjaCwgZmFsc2UpOwor
CQlpZiAoZXJyKQorCQkJZ290byBlcnI7CisKKwkJZXJyID0gX19saXZlX2xyY19ncHIoZW5naW5l
LCBzY3JhdGNoLCB0cnVlKTsKKwkJaWYgKGVycikKKwkJCWdvdG8gZXJyOworCitlcnI6CisJCXN0
X2VuZ2luZV9oZWFydGJlYXRfZW5hYmxlKGVuZ2luZSk7CisJCWlmIChpZ3RfZmx1c2hfdGVzdChn
dC0+aTkxNSkpCisJCQllcnIgPSAtRUlPOworCQlpZiAoZXJyKQorCQkJYnJlYWs7CisJfQorCisJ
aTkxNV92bWFfdW5waW5fYW5kX3JlbGVhc2UoJnNjcmF0Y2gsIDApOworCXJldHVybiBlcnI7Cit9
CisKK3N0YXRpYyBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoKK2NyZWF0ZV90aW1lc3RhbXAoc3RydWN0
IGludGVsX2NvbnRleHQgKmNlLCB2b2lkICpzbG90LCBpbnQgaWR4KQoreworCWNvbnN0IHUzMiBv
ZmZzZXQgPQorCQlpOTE1X2dndHRfb2Zmc2V0KGNlLT5lbmdpbmUtPnN0YXR1c19wYWdlLnZtYSkg
KworCQlvZmZzZXRfaW5fcGFnZShzbG90KTsKKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKKwl1
MzIgKmNzOworCWludCBlcnI7CisKKwlycSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3Qo
Y2UpOworCWlmIChJU19FUlIocnEpKQorCQlyZXR1cm4gcnE7CisKKwljcyA9IGludGVsX3Jpbmdf
YmVnaW4ocnEsIDEwKTsKKwlpZiAoSVNfRVJSKGNzKSkgeworCQllcnIgPSBQVFJfRVJSKGNzKTsK
KwkJZ290byBlcnI7CisJfQorCisJKmNzKysgPSBNSV9BUkJfT05fT0ZGIHwgTUlfQVJCX0VOQUJM
RTsKKwkqY3MrKyA9IE1JX05PT1A7CisKKwkqY3MrKyA9IE1JX1NFTUFQSE9SRV9XQUlUIHwKKwkJ
TUlfU0VNQVBIT1JFX0dMT0JBTF9HVFQgfAorCQlNSV9TRU1BUEhPUkVfUE9MTCB8CisJCU1JX1NF
TUFQSE9SRV9TQURfTkVRX1NERDsKKwkqY3MrKyA9IDA7CisJKmNzKysgPSBvZmZzZXQ7CisJKmNz
KysgPSAwOworCisJKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOOCB8IE1JX1VTRV9H
R1RUOworCSpjcysrID0gaTkxNV9tbWlvX3JlZ19vZmZzZXQoUklOR19DVFhfVElNRVNUQU1QKHJx
LT5lbmdpbmUtPm1taW9fYmFzZSkpOworCSpjcysrID0gb2Zmc2V0ICsgaWR4ICogc2l6ZW9mKHUz
Mik7CisJKmNzKysgPSAwOworCisJaW50ZWxfcmluZ19hZHZhbmNlKHJxLCBjcyk7CisKKwlycS0+
c2NoZWQuYXR0ci5wcmlvcml0eSA9IEk5MTVfUFJJT1JJVFlfTUFTSzsKKwllcnIgPSAwOworZXJy
OgorCWk5MTVfcmVxdWVzdF9nZXQocnEpOworCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCWlmIChl
cnIpIHsKKwkJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisJCXJldHVybiBFUlJfUFRSKGVycik7CisJ
fQorCisJcmV0dXJuIHJxOworfQorCitzdHJ1Y3QgbHJjX3RpbWVzdGFtcCB7CisJc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lOworCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZVsyXTsKKwl1
MzIgcG9pc29uOworfTsKKworc3RhdGljIGJvb2wgdGltZXN0YW1wX2FkdmFuY2VkKHUzMiBzdGFy
dCwgdTMyIGVuZCkKK3sKKwlyZXR1cm4gKHMzMikoZW5kIC0gc3RhcnQpID4gMDsKK30KKworc3Rh
dGljIGludCBfX2xyY190aW1lc3RhbXAoY29uc3Qgc3RydWN0IGxyY190aW1lc3RhbXAgKmFyZywg
Ym9vbCBwcmVlbXB0KQoreworCXUzMiAqc2xvdCA9IG1lbXNldDMyKGFyZy0+ZW5naW5lLT5zdGF0
dXNfcGFnZS5hZGRyICsgMTAwMCwgMCwgNCk7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJ
dTMyIHRpbWVzdGFtcDsKKwlpbnQgZXJyID0gMDsKKworCWFyZy0+Y2VbMF0tPmxyY19yZWdfc3Rh
dGVbQ1RYX1RJTUVTVEFNUF0gPSBhcmctPnBvaXNvbjsKKwlycSA9IGNyZWF0ZV90aW1lc3RhbXAo
YXJnLT5jZVswXSwgc2xvdCwgMSk7CisJaWYgKElTX0VSUihycSkpCisJCXJldHVybiBQVFJfRVJS
KHJxKTsKKworCWVyciA9IHdhaXRfZm9yX3N1Ym1pdChycS0+ZW5naW5lLCBycSwgSFogLyAyKTsK
KwlpZiAoZXJyKQorCQlnb3RvIGVycjsKKworCWlmIChwcmVlbXB0KSB7CisJCWFyZy0+Y2VbMV0t
PmxyY19yZWdfc3RhdGVbQ1RYX1RJTUVTVEFNUF0gPSAweGRlYWRiZWVmOworCQllcnIgPSBlbWl0
X3NlbWFwaG9yZV9zaWduYWwoYXJnLT5jZVsxXSwgc2xvdCk7CisJCWlmIChlcnIpCisJCQlnb3Rv
IGVycjsKKwl9IGVsc2UgeworCQlzbG90WzBdID0gMTsKKwkJd21iKCk7CisJfQorCisJLyogQW5k
IHdhaXQgZm9yIHN3aXRjaCB0byBrZXJuZWwgKHRvIHNhdmUgb3VyIGNvbnRleHQgdG8gbWVtb3J5
KSAqLworCWVyciA9IGNvbnRleHRfZmx1c2goYXJnLT5jZVswXSwgSFogLyAyKTsKKwlpZiAoZXJy
KQorCQlnb3RvIGVycjsKKworCWlmICghdGltZXN0YW1wX2FkdmFuY2VkKGFyZy0+cG9pc29uLCBz
bG90WzFdKSkgeworCQlwcl9lcnIoIiVzKCVzKTogaW52YWxpZCB0aW1lc3RhbXAgb24gcmVzdG9y
ZSwgY29udGV4dDoleCwgcmVxdWVzdDoleFxuIiwKKwkJICAgICAgIGFyZy0+ZW5naW5lLT5uYW1l
LCBwcmVlbXB0ID8gInByZWVtcHQiIDogInNpbXBsZSIsCisJCSAgICAgICBhcmctPnBvaXNvbiwg
c2xvdFsxXSk7CisJCWVyciA9IC1FSU5WQUw7CisJfQorCisJdGltZXN0YW1wID0gUkVBRF9PTkNF
KGFyZy0+Y2VbMF0tPmxyY19yZWdfc3RhdGVbQ1RYX1RJTUVTVEFNUF0pOworCWlmICghdGltZXN0
YW1wX2FkdmFuY2VkKHNsb3RbMV0sIHRpbWVzdGFtcCkpIHsKKwkJcHJfZXJyKCIlcyglcyk6IGlu
dmFsaWQgdGltZXN0YW1wIG9uIHNhdmUsIHJlcXVlc3Q6JXgsIGNvbnRleHQ6JXhcbiIsCisJCSAg
ICAgICBhcmctPmVuZ2luZS0+bmFtZSwgcHJlZW1wdCA/ICJwcmVlbXB0IiA6ICJzaW1wbGUiLAor
CQkgICAgICAgc2xvdFsxXSwgdGltZXN0YW1wKTsKKwkJZXJyID0gLUVJTlZBTDsKKwl9CisKK2Vy
cjoKKwltZW1zZXQzMihzbG90LCAtMSwgNCk7CisJaTkxNV9yZXF1ZXN0X3B1dChycSk7CisJcmV0
dXJuIGVycjsKK30KKworc3RhdGljIGludCBsaXZlX2xyY190aW1lc3RhbXAodm9pZCAqYXJnKQor
eworCXN0cnVjdCBscmNfdGltZXN0YW1wIGRhdGEgPSB7fTsKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0
ID0gYXJnOworCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOworCWNvbnN0IHUzMiBwb2lzb25bXSA9
IHsKKwkJMCwKKwkJUzMyX01BWCwKKwkJKHUzMilTMzJfTUFYICsgMSwKKwkJVTMyX01BWCwKKwl9
OworCisJLyoKKwkgKiBXZSB3YW50IHRvIHZlcmlmeSB0aGF0IHRoZSB0aW1lc3RhbXAgaXMgc2F2
ZWQgYW5kIHJlc3RvcmUgYWNyb3NzCisJICogY29udGV4dCBzd2l0Y2hlcyBhbmQgaXMgbW9ub3Rv
bmljLgorCSAqCisJICogU28gd2UgZG8gdGhpcyB3aXRoIGEgbGl0dGxlIGJpdCBvZiBMUkMgcG9p
c29uaW5nIHRvIGNoZWNrIHZhcmlvdXMKKwkgKiBib3VuZGFyeSBjb25kaXRpb25zLCBhbmQgc2Vl
IHdoYXQgaGFwcGVucyBpZiB3ZSBwcmVlbXB0IHRoZSBjb250ZXh0CisJICogd2l0aCBhIHNlY29u
ZCByZXF1ZXN0IChjYXJyeWluZyBtb3JlIHBvaXNvbiBpbnRvIHRoZSB0aW1lc3RhbXApLgorCSAq
LworCisJZm9yX2VhY2hfZW5naW5lKGRhdGEuZW5naW5lLCBndCwgaWQpIHsKKwkJaW50IGksIGVy
ciA9IDA7CisKKwkJc3RfZW5naW5lX2hlYXJ0YmVhdF9kaXNhYmxlKGRhdGEuZW5naW5lKTsKKwor
CQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShkYXRhLmNlKTsgaSsrKSB7CisJCQlzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqdG1wOworCisJCQl0bXAgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShkYXRh
LmVuZ2luZSk7CisJCQlpZiAoSVNfRVJSKHRtcCkpIHsKKwkJCQllcnIgPSBQVFJfRVJSKHRtcCk7
CisJCQkJZ290byBlcnI7CisJCQl9CisKKwkJCWVyciA9IGludGVsX2NvbnRleHRfcGluKHRtcCk7
CisJCQlpZiAoZXJyKSB7CisJCQkJaW50ZWxfY29udGV4dF9wdXQodG1wKTsKKwkJCQlnb3RvIGVy
cjsKKwkJCX0KKworCQkJZGF0YS5jZVtpXSA9IHRtcDsKKwkJfQorCisJCWZvciAoaSA9IDA7IGkg
PCBBUlJBWV9TSVpFKHBvaXNvbik7IGkrKykgeworCQkJZGF0YS5wb2lzb24gPSBwb2lzb25baV07
CisKKwkJCWVyciA9IF9fbHJjX3RpbWVzdGFtcCgmZGF0YSwgZmFsc2UpOworCQkJaWYgKGVycikK
KwkJCQlicmVhazsKKworCQkJZXJyID0gX19scmNfdGltZXN0YW1wKCZkYXRhLCB0cnVlKTsKKwkJ
CWlmIChlcnIpCisJCQkJYnJlYWs7CisJCX0KKworZXJyOgorCQlzdF9lbmdpbmVfaGVhcnRiZWF0
X2VuYWJsZShkYXRhLmVuZ2luZSk7CisJCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGRhdGEu
Y2UpOyBpKyspIHsKKwkJCWlmICghZGF0YS5jZVtpXSkKKwkJCQlicmVhazsKKworCQkJaW50ZWxf
Y29udGV4dF91bnBpbihkYXRhLmNlW2ldKTsKKwkJCWludGVsX2NvbnRleHRfcHV0KGRhdGEuY2Vb
aV0pOworCQl9CisKKwkJaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkKKwkJCWVyciA9IC1F
SU87CisJCWlmIChlcnIpCisJCQlyZXR1cm4gZXJyOworCX0KKworCXJldHVybiAwOworfQorCitz
dGF0aWMgc3RydWN0IGk5MTVfdm1hICoKK2NyZWF0ZV91c2VyX3ZtYShzdHJ1Y3QgaTkxNV9hZGRy
ZXNzX3NwYWNlICp2bSwgdW5zaWduZWQgbG9uZyBzaXplKQoreworCXN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5MTVfdm1hICp2bWE7CisJaW50IGVycjsKKworCW9i
aiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwodm0tPmk5MTUsIHNpemUpOworCWlm
IChJU19FUlIob2JqKSkKKwkJcmV0dXJuIEVSUl9DQVNUKG9iaik7CisKKwl2bWEgPSBpOTE1X3Zt
YV9pbnN0YW5jZShvYmosIHZtLCBOVUxMKTsKKwlpZiAoSVNfRVJSKHZtYSkpIHsKKwkJaTkxNV9n
ZW1fb2JqZWN0X3B1dChvYmopOworCQlyZXR1cm4gdm1hOworCX0KKworCWVyciA9IGk5MTVfdm1h
X3Bpbih2bWEsIDAsIDAsIFBJTl9VU0VSKTsKKwlpZiAoZXJyKSB7CisJCWk5MTVfZ2VtX29iamVj
dF9wdXQob2JqKTsKKwkJcmV0dXJuIEVSUl9QVFIoZXJyKTsKKwl9CisKKwlyZXR1cm4gdm1hOwor
fQorCitzdGF0aWMgc3RydWN0IGk5MTVfdm1hICoKK3N0b3JlX2NvbnRleHQoc3RydWN0IGludGVs
X2NvbnRleHQgKmNlLCBzdHJ1Y3QgaTkxNV92bWEgKnNjcmF0Y2gpCit7CisJc3RydWN0IGk5MTVf
dm1hICpiYXRjaDsKKwl1MzIgZHcsIHgsICpjcywgKmh3OworCXUzMiAqZGVmYXVsdHM7CisKKwli
YXRjaCA9IGNyZWF0ZV91c2VyX3ZtYShjZS0+dm0sIFNaXzY0Syk7CisJaWYgKElTX0VSUihiYXRj
aCkpCisJCXJldHVybiBiYXRjaDsKKworCWNzID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAoYmF0
Y2gtPm9iaiwgSTkxNV9NQVBfV0MpOworCWlmIChJU19FUlIoY3MpKSB7CisJCWk5MTVfdm1hX3B1
dChiYXRjaCk7CisJCXJldHVybiBFUlJfQ0FTVChjcyk7CisJfQorCisJZGVmYXVsdHMgPSBzaG1l
bV9waW5fbWFwKGNlLT5lbmdpbmUtPmRlZmF1bHRfc3RhdGUpOworCWlmICghZGVmYXVsdHMpIHsK
KwkJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChiYXRjaC0+b2JqKTsKKwkJaTkxNV92bWFfcHV0
KGJhdGNoKTsKKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisJfQorCisJeCA9IDA7CisJZHcg
PSAwOworCWh3ID0gZGVmYXVsdHM7CisJaHcgKz0gTFJDX1NUQVRFX09GRlNFVCAvIHNpemVvZigq
aHcpOworCWRvIHsKKwkJdTMyIGxlbiA9IGh3W2R3XSAmIDB4N2Y7CisKKwkJaWYgKGh3W2R3XSA9
PSAwKSB7CisJCQlkdysrOworCQkJY29udGludWU7CisJCX0KKworCQlpZiAoKGh3W2R3XSAmIEdF
Tk1BU0soMzEsIDIzKSkgIT0gTUlfSU5TVFIoMHgyMiwgMCkpIHsKKwkJCWR3ICs9IGxlbiArIDI7
CisJCQljb250aW51ZTsKKwkJfQorCisJCWR3Kys7CisJCWxlbiA9IChsZW4gKyAxKSAvIDI7CisJ
CXdoaWxlIChsZW4tLSkgeworCQkJKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VOODsK
KwkJCSpjcysrID0gaHdbZHddOworCQkJKmNzKysgPSBsb3dlcl8zMl9iaXRzKHNjcmF0Y2gtPm5v
ZGUuc3RhcnQgKyB4KTsKKwkJCSpjcysrID0gdXBwZXJfMzJfYml0cyhzY3JhdGNoLT5ub2RlLnN0
YXJ0ICsgeCk7CisKKwkJCWR3ICs9IDI7CisJCQl4ICs9IDQ7CisJCX0KKwl9IHdoaWxlIChkdyA8
IFBBR0VfU0laRSAvIHNpemVvZih1MzIpICYmCisJCSAoaHdbZHddICYgfkJJVCgwKSkgIT0gTUlf
QkFUQ0hfQlVGRkVSX0VORCk7CisKKwkqY3MrKyA9IE1JX0JBVENIX0JVRkZFUl9FTkQ7CisKKwlz
aG1lbV91bnBpbl9tYXAoY2UtPmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwgZGVmYXVsdHMpOworCisJ
aTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcChiYXRjaC0+b2JqKTsKKwlpOTE1X2dlbV9vYmplY3Rf
dW5waW5fbWFwKGJhdGNoLT5vYmopOworCisJcmV0dXJuIGJhdGNoOworfQorCitzdGF0aWMgaW50
IG1vdmVfdG9fYWN0aXZlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAorCQkJICBzdHJ1Y3QgaTkx
NV92bWEgKnZtYSwKKwkJCSAgdW5zaWduZWQgaW50IGZsYWdzKQoreworCWludCBlcnI7CisKKwlp
OTE1X3ZtYV9sb2NrKHZtYSk7CisJZXJyID0gaTkxNV9yZXF1ZXN0X2F3YWl0X29iamVjdChycSwg
dm1hLT5vYmosIGZsYWdzKTsKKwlpZiAoIWVycikKKwkJZXJyID0gaTkxNV92bWFfbW92ZV90b19h
Y3RpdmUodm1hLCBycSwgZmxhZ3MpOworCWk5MTVfdm1hX3VubG9jayh2bWEpOworCisJcmV0dXJu
IGVycjsKK30KKworc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKgorcmVjb3JkX3JlZ2lzdGVy
cyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCisJCSBzdHJ1Y3QgaTkxNV92bWEgKmJlZm9yZSwK
KwkJIHN0cnVjdCBpOTE1X3ZtYSAqYWZ0ZXIsCisJCSB1MzIgKnNlbWEpCit7CisJc3RydWN0IGk5
MTVfdm1hICpiX2JlZm9yZSwgKmJfYWZ0ZXI7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJ
dTMyICpjczsKKwlpbnQgZXJyOworCisJYl9iZWZvcmUgPSBzdG9yZV9jb250ZXh0KGNlLCBiZWZv
cmUpOworCWlmIChJU19FUlIoYl9iZWZvcmUpKQorCQlyZXR1cm4gRVJSX0NBU1QoYl9iZWZvcmUp
OworCisJYl9hZnRlciA9IHN0b3JlX2NvbnRleHQoY2UsIGFmdGVyKTsKKwlpZiAoSVNfRVJSKGJf
YWZ0ZXIpKSB7CisJCXJxID0gRVJSX0NBU1QoYl9hZnRlcik7CisJCWdvdG8gZXJyX2JlZm9yZTsK
Kwl9CisKKwlycSA9IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOworCWlmIChJU19F
UlIocnEpKQorCQlnb3RvIGVycl9hZnRlcjsKKworCWVyciA9IG1vdmVfdG9fYWN0aXZlKHJxLCBi
ZWZvcmUsIEVYRUNfT0JKRUNUX1dSSVRFKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9ycTsKKwor
CWVyciA9IG1vdmVfdG9fYWN0aXZlKHJxLCBiX2JlZm9yZSwgMCk7CisJaWYgKGVycikKKwkJZ290
byBlcnJfcnE7CisKKwllcnIgPSBtb3ZlX3RvX2FjdGl2ZShycSwgYWZ0ZXIsIEVYRUNfT0JKRUNU
X1dSSVRFKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9ycTsKKworCWVyciA9IG1vdmVfdG9fYWN0
aXZlKHJxLCBiX2FmdGVyLCAwKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9ycTsKKworCWNzID0g
aW50ZWxfcmluZ19iZWdpbihycSwgMTQpOworCWlmIChJU19FUlIoY3MpKSB7CisJCWVyciA9IFBU
Ul9FUlIoY3MpOworCQlnb3RvIGVycl9ycTsKKwl9CisKKwkqY3MrKyA9IE1JX0FSQl9PTl9PRkYg
fCBNSV9BUkJfRElTQUJMRTsKKwkqY3MrKyA9IE1JX0JBVENIX0JVRkZFUl9TVEFSVF9HRU44IHwg
QklUKDgpOworCSpjcysrID0gbG93ZXJfMzJfYml0cyhiX2JlZm9yZS0+bm9kZS5zdGFydCk7CisJ
KmNzKysgPSB1cHBlcl8zMl9iaXRzKGJfYmVmb3JlLT5ub2RlLnN0YXJ0KTsKKworCSpjcysrID0g
TUlfQVJCX09OX09GRiB8IE1JX0FSQl9FTkFCTEU7CisJKmNzKysgPSBNSV9TRU1BUEhPUkVfV0FJ
VCB8CisJCU1JX1NFTUFQSE9SRV9HTE9CQUxfR1RUIHwKKwkJTUlfU0VNQVBIT1JFX1BPTEwgfAor
CQlNSV9TRU1BUEhPUkVfU0FEX05FUV9TREQ7CisJKmNzKysgPSAwOworCSpjcysrID0gaTkxNV9n
Z3R0X29mZnNldChjZS0+ZW5naW5lLT5zdGF0dXNfcGFnZS52bWEpICsKKwkJb2Zmc2V0X2luX3Bh
Z2Uoc2VtYSk7CisJKmNzKysgPSAwOworCSpjcysrID0gTUlfTk9PUDsKKworCSpjcysrID0gTUlf
QVJCX09OX09GRiB8IE1JX0FSQl9ESVNBQkxFOworCSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX1NU
QVJUX0dFTjggfCBCSVQoOCk7CisJKmNzKysgPSBsb3dlcl8zMl9iaXRzKGJfYWZ0ZXItPm5vZGUu
c3RhcnQpOworCSpjcysrID0gdXBwZXJfMzJfYml0cyhiX2FmdGVyLT5ub2RlLnN0YXJ0KTsKKwor
CWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCisJV1JJVEVfT05DRSgqc2VtYSwgMCk7CisJ
aTkxNV9yZXF1ZXN0X2dldChycSk7CisJaTkxNV9yZXF1ZXN0X2FkZChycSk7CitlcnJfYWZ0ZXI6
CisJaTkxNV92bWFfcHV0KGJfYWZ0ZXIpOworZXJyX2JlZm9yZToKKwlpOTE1X3ZtYV9wdXQoYl9i
ZWZvcmUpOworCXJldHVybiBycTsKKworZXJyX3JxOgorCWk5MTVfcmVxdWVzdF9hZGQocnEpOwor
CXJxID0gRVJSX1BUUihlcnIpOworCWdvdG8gZXJyX2FmdGVyOworfQorCitzdGF0aWMgc3RydWN0
IGk5MTVfdm1hICpsb2FkX2NvbnRleHQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCB1MzIgcG9p
c29uKQoreworCXN0cnVjdCBpOTE1X3ZtYSAqYmF0Y2g7CisJdTMyIGR3LCAqY3MsICpodzsKKwl1
MzIgKmRlZmF1bHRzOworCisJYmF0Y2ggPSBjcmVhdGVfdXNlcl92bWEoY2UtPnZtLCBTWl82NEsp
OworCWlmIChJU19FUlIoYmF0Y2gpKQorCQlyZXR1cm4gYmF0Y2g7CisKKwljcyA9IGk5MTVfZ2Vt
X29iamVjdF9waW5fbWFwKGJhdGNoLT5vYmosIEk5MTVfTUFQX1dDKTsKKwlpZiAoSVNfRVJSKGNz
KSkgeworCQlpOTE1X3ZtYV9wdXQoYmF0Y2gpOworCQlyZXR1cm4gRVJSX0NBU1QoY3MpOworCX0K
KworCWRlZmF1bHRzID0gc2htZW1fcGluX21hcChjZS0+ZW5naW5lLT5kZWZhdWx0X3N0YXRlKTsK
KwlpZiAoIWRlZmF1bHRzKSB7CisJCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoYmF0Y2gtPm9i
aik7CisJCWk5MTVfdm1hX3B1dChiYXRjaCk7CisJCXJldHVybiBFUlJfUFRSKC1FTk9NRU0pOwor
CX0KKworCWR3ID0gMDsKKwlodyA9IGRlZmF1bHRzOworCWh3ICs9IExSQ19TVEFURV9PRkZTRVQg
LyBzaXplb2YoKmh3KTsKKwlkbyB7CisJCXUzMiBsZW4gPSBod1tkd10gJiAweDdmOworCisJCWlm
IChod1tkd10gPT0gMCkgeworCQkJZHcrKzsKKwkJCWNvbnRpbnVlOworCQl9CisKKwkJaWYgKCho
d1tkd10gJiBHRU5NQVNLKDMxLCAyMykpICE9IE1JX0lOU1RSKDB4MjIsIDApKSB7CisJCQlkdyAr
PSBsZW4gKyAyOworCQkJY29udGludWU7CisJCX0KKworCQlkdysrOworCQlsZW4gPSAobGVuICsg
MSkgLyAyOworCQkqY3MrKyA9IE1JX0xPQURfUkVHSVNURVJfSU1NKGxlbik7CisJCXdoaWxlIChs
ZW4tLSkgeworCQkJKmNzKysgPSBod1tkd107CisJCQkqY3MrKyA9IHBvaXNvbjsKKwkJCWR3ICs9
IDI7CisJCX0KKwl9IHdoaWxlIChkdyA8IFBBR0VfU0laRSAvIHNpemVvZih1MzIpICYmCisJCSAo
aHdbZHddICYgfkJJVCgwKSkgIT0gTUlfQkFUQ0hfQlVGRkVSX0VORCk7CisKKwkqY3MrKyA9IE1J
X0JBVENIX0JVRkZFUl9FTkQ7CisKKwlzaG1lbV91bnBpbl9tYXAoY2UtPmVuZ2luZS0+ZGVmYXVs
dF9zdGF0ZSwgZGVmYXVsdHMpOworCisJaTkxNV9nZW1fb2JqZWN0X2ZsdXNoX21hcChiYXRjaC0+
b2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGJhdGNoLT5vYmopOworCisJcmV0dXJu
IGJhdGNoOworfQorCitzdGF0aWMgaW50IHBvaXNvbl9yZWdpc3RlcnMoc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlLCB1MzIgcG9pc29uLCB1MzIgKnNlbWEpCit7CisJc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnE7CisJc3RydWN0IGk5MTVfdm1hICpiYXRjaDsKKwl1MzIgKmNzOworCWludCBlcnI7CisK
KwliYXRjaCA9IGxvYWRfY29udGV4dChjZSwgcG9pc29uKTsKKwlpZiAoSVNfRVJSKGJhdGNoKSkK
KwkJcmV0dXJuIFBUUl9FUlIoYmF0Y2gpOworCisJcnEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9y
ZXF1ZXN0KGNlKTsKKwlpZiAoSVNfRVJSKHJxKSkgeworCQllcnIgPSBQVFJfRVJSKHJxKTsKKwkJ
Z290byBlcnJfYmF0Y2g7CisJfQorCisJZXJyID0gbW92ZV90b19hY3RpdmUocnEsIGJhdGNoLCAw
KTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycl9ycTsKKworCWNzID0gaW50ZWxfcmluZ19iZWdpbihy
cSwgOCk7CisJaWYgKElTX0VSUihjcykpIHsKKwkJZXJyID0gUFRSX0VSUihjcyk7CisJCWdvdG8g
ZXJyX3JxOworCX0KKworCSpjcysrID0gTUlfQVJCX09OX09GRiB8IE1JX0FSQl9ESVNBQkxFOwor
CSpjcysrID0gTUlfQkFUQ0hfQlVGRkVSX1NUQVJUX0dFTjggfCBCSVQoOCk7CisJKmNzKysgPSBs
b3dlcl8zMl9iaXRzKGJhdGNoLT5ub2RlLnN0YXJ0KTsKKwkqY3MrKyA9IHVwcGVyXzMyX2JpdHMo
YmF0Y2gtPm5vZGUuc3RhcnQpOworCisJKmNzKysgPSBNSV9TVE9SRV9EV09SRF9JTU1fR0VONCB8
IE1JX1VTRV9HR1RUOworCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChjZS0+ZW5naW5lLT5zdGF0
dXNfcGFnZS52bWEpICsKKwkJb2Zmc2V0X2luX3BhZ2Uoc2VtYSk7CisJKmNzKysgPSAwOworCSpj
cysrID0gMTsKKworCWludGVsX3JpbmdfYWR2YW5jZShycSwgY3MpOworCisJcnEtPnNjaGVkLmF0
dHIucHJpb3JpdHkgPSBJOTE1X1BSSU9SSVRZX0JBUlJJRVI7CitlcnJfcnE6CisJaTkxNV9yZXF1
ZXN0X2FkZChycSk7CitlcnJfYmF0Y2g6CisJaTkxNV92bWFfcHV0KGJhdGNoKTsKKwlyZXR1cm4g
ZXJyOworfQorCitzdGF0aWMgYm9vbCBpc19tb3ZpbmcodTMyIGEsIHUzMiBiKQoreworCXJldHVy
biBhICE9IGI7Cit9CisKK3N0YXRpYyBpbnQgY29tcGFyZV9pc29sYXRpb24oc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lLAorCQkJICAgICBzdHJ1Y3QgaTkxNV92bWEgKnJlZlsyXSwKKwkJ
CSAgICAgc3RydWN0IGk5MTVfdm1hICpyZXN1bHRbMl0sCisJCQkgICAgIHN0cnVjdCBpbnRlbF9j
b250ZXh0ICpjZSwKKwkJCSAgICAgdTMyIHBvaXNvbikKK3sKKwl1MzIgeCwgZHcsICpodywgKmxy
YzsKKwl1MzIgKkFbMl0sICpCWzJdOworCXUzMiAqZGVmYXVsdHM7CisJaW50IGVyciA9IDA7CisK
KwlBWzBdID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAocmVmWzBdLT5vYmosIEk5MTVfTUFQX1dD
KTsKKwlpZiAoSVNfRVJSKEFbMF0pKQorCQlyZXR1cm4gUFRSX0VSUihBWzBdKTsKKworCUFbMV0g
PSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChyZWZbMV0tPm9iaiwgSTkxNV9NQVBfV0MpOworCWlm
IChJU19FUlIoQVsxXSkpIHsKKwkJZXJyID0gUFRSX0VSUihBWzFdKTsKKwkJZ290byBlcnJfQTA7
CisJfQorCisJQlswXSA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKHJlc3VsdFswXS0+b2JqLCBJ
OTE1X01BUF9XQyk7CisJaWYgKElTX0VSUihCWzBdKSkgeworCQllcnIgPSBQVFJfRVJSKEJbMF0p
OworCQlnb3RvIGVycl9BMTsKKwl9CisKKwlCWzFdID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAo
cmVzdWx0WzFdLT5vYmosIEk5MTVfTUFQX1dDKTsKKwlpZiAoSVNfRVJSKEJbMV0pKSB7CisJCWVy
ciA9IFBUUl9FUlIoQlsxXSk7CisJCWdvdG8gZXJyX0IwOworCX0KKworCWxyYyA9IGk5MTVfZ2Vt
X29iamVjdF9waW5fbWFwKGNlLT5zdGF0ZS0+b2JqLAorCQkJCSAgICAgIGk5MTVfY29oZXJlbnRf
bWFwX3R5cGUoZW5naW5lLT5pOTE1KSk7CisJaWYgKElTX0VSUihscmMpKSB7CisJCWVyciA9IFBU
Ul9FUlIobHJjKTsKKwkJZ290byBlcnJfQjE7CisJfQorCWxyYyArPSBMUkNfU1RBVEVfT0ZGU0VU
IC8gc2l6ZW9mKCpodyk7CisKKwlkZWZhdWx0cyA9IHNobWVtX3Bpbl9tYXAoY2UtPmVuZ2luZS0+
ZGVmYXVsdF9zdGF0ZSk7CisJaWYgKCFkZWZhdWx0cykgeworCQllcnIgPSAtRU5PTUVNOworCQln
b3RvIGVycl9scmM7CisJfQorCisJeCA9IDA7CisJZHcgPSAwOworCWh3ID0gZGVmYXVsdHM7CisJ
aHcgKz0gTFJDX1NUQVRFX09GRlNFVCAvIHNpemVvZigqaHcpOworCWRvIHsKKwkJdTMyIGxlbiA9
IGh3W2R3XSAmIDB4N2Y7CisKKwkJaWYgKGh3W2R3XSA9PSAwKSB7CisJCQlkdysrOworCQkJY29u
dGludWU7CisJCX0KKworCQlpZiAoKGh3W2R3XSAmIEdFTk1BU0soMzEsIDIzKSkgIT0gTUlfSU5T
VFIoMHgyMiwgMCkpIHsKKwkJCWR3ICs9IGxlbiArIDI7CisJCQljb250aW51ZTsKKwkJfQorCisJ
CWR3Kys7CisJCWxlbiA9IChsZW4gKyAxKSAvIDI7CisJCXdoaWxlIChsZW4tLSkgeworCQkJaWYg
KCFpc19tb3ZpbmcoQVswXVt4XSwgQVsxXVt4XSkgJiYKKwkJCSAgICAoQVswXVt4XSAhPSBCWzBd
W3hdIHx8IEFbMV1beF0gIT0gQlsxXVt4XSkpIHsKKwkJCQlzd2l0Y2ggKGh3W2R3XSAmIDQwOTUp
IHsKKwkJCQljYXNlIDB4MzA6IC8qIFJJTkdfSEVBRCAqLworCQkJCWNhc2UgMHgzNDogLyogUklO
R19UQUlMICovCisJCQkJCWJyZWFrOworCisJCQkJZGVmYXVsdDoKKwkJCQkJcHJfZXJyKCIlc1sl
ZF06IE1pc21hdGNoIGZvciByZWdpc3RlciAlNHgsIGRlZmF1bHQgJTA4eCwgcmVmZXJlbmNlICUw
OHgsIHJlc3VsdCAoJTA4eCwgJTA4eCksIHBvaXNvbiAlMDh4LCBjb250ZXh0ICUwOHhcbiIsCisJ
CQkJCSAgICAgICBlbmdpbmUtPm5hbWUsIGR3LAorCQkJCQkgICAgICAgaHdbZHddLCBod1tkdyAr
IDFdLAorCQkJCQkgICAgICAgQVswXVt4XSwgQlswXVt4XSwgQlsxXVt4XSwKKwkJCQkJICAgICAg
IHBvaXNvbiwgbHJjW2R3ICsgMV0pOworCQkJCQllcnIgPSAtRUlOVkFMOworCQkJCX0KKwkJCX0K
KwkJCWR3ICs9IDI7CisJCQl4Kys7CisJCX0KKwl9IHdoaWxlIChkdyA8IFBBR0VfU0laRSAvIHNp
emVvZih1MzIpICYmCisJCSAoaHdbZHddICYgfkJJVCgwKSkgIT0gTUlfQkFUQ0hfQlVGRkVSX0VO
RCk7CisKKwlzaG1lbV91bnBpbl9tYXAoY2UtPmVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSwgZGVmYXVs
dHMpOworZXJyX2xyYzoKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKGNlLT5zdGF0ZS0+b2Jq
KTsKK2Vycl9CMToKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJlc3VsdFsxXS0+b2JqKTsK
K2Vycl9CMDoKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJlc3VsdFswXS0+b2JqKTsKK2Vy
cl9BMToKKwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJlZlsxXS0+b2JqKTsKK2Vycl9BMDoK
KwlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJlZlswXS0+b2JqKTsKKwlyZXR1cm4gZXJyOwor
fQorCitzdGF0aWMgaW50IF9fbHJjX2lzb2xhdGlvbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsIHUzMiBwb2lzb24pCit7CisJdTMyICpzZW1hID0gbWVtc2V0MzIoZW5naW5lLT5zdGF0
dXNfcGFnZS5hZGRyICsgMTAwMCwgMCwgMSk7CisJc3RydWN0IGk5MTVfdm1hICpyZWZbMl0sICpy
ZXN1bHRbMl07CisJc3RydWN0IGludGVsX2NvbnRleHQgKkEsICpCOworCXN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxOworCWludCBlcnI7CisKKwlBID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5naW5l
KTsKKwlpZiAoSVNfRVJSKEEpKQorCQlyZXR1cm4gUFRSX0VSUihBKTsKKworCUIgPSBpbnRlbF9j
b250ZXh0X2NyZWF0ZShlbmdpbmUpOworCWlmIChJU19FUlIoQikpIHsKKwkJZXJyID0gUFRSX0VS
UihCKTsKKwkJZ290byBlcnJfQTsKKwl9CisKKwlyZWZbMF0gPSBjcmVhdGVfdXNlcl92bWEoQS0+
dm0sIFNaXzY0Syk7CisJaWYgKElTX0VSUihyZWZbMF0pKSB7CisJCWVyciA9IFBUUl9FUlIocmVm
WzBdKTsKKwkJZ290byBlcnJfQjsKKwl9CisKKwlyZWZbMV0gPSBjcmVhdGVfdXNlcl92bWEoQS0+
dm0sIFNaXzY0Syk7CisJaWYgKElTX0VSUihyZWZbMV0pKSB7CisJCWVyciA9IFBUUl9FUlIocmVm
WzFdKTsKKwkJZ290byBlcnJfcmVmMDsKKwl9CisKKwlycSA9IHJlY29yZF9yZWdpc3RlcnMoQSwg
cmVmWzBdLCByZWZbMV0sIHNlbWEpOworCWlmIChJU19FUlIocnEpKSB7CisJCWVyciA9IFBUUl9F
UlIocnEpOworCQlnb3RvIGVycl9yZWYxOworCX0KKworCVdSSVRFX09OQ0UoKnNlbWEsIDEpOwor
CXdtYigpOworCisJaWYgKGk5MTVfcmVxdWVzdF93YWl0KHJxLCAwLCBIWiAvIDIpIDwgMCkgewor
CQlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKKwkJZXJyID0gLUVUSU1FOworCQlnb3RvIGVycl9yZWYx
OworCX0KKwlpOTE1X3JlcXVlc3RfcHV0KHJxKTsKKworCXJlc3VsdFswXSA9IGNyZWF0ZV91c2Vy
X3ZtYShBLT52bSwgU1pfNjRLKTsKKwlpZiAoSVNfRVJSKHJlc3VsdFswXSkpIHsKKwkJZXJyID0g
UFRSX0VSUihyZXN1bHRbMF0pOworCQlnb3RvIGVycl9yZWYxOworCX0KKworCXJlc3VsdFsxXSA9
IGNyZWF0ZV91c2VyX3ZtYShBLT52bSwgU1pfNjRLKTsKKwlpZiAoSVNfRVJSKHJlc3VsdFsxXSkp
IHsKKwkJZXJyID0gUFRSX0VSUihyZXN1bHRbMV0pOworCQlnb3RvIGVycl9yZXN1bHQwOworCX0K
KworCXJxID0gcmVjb3JkX3JlZ2lzdGVycyhBLCByZXN1bHRbMF0sIHJlc3VsdFsxXSwgc2VtYSk7
CisJaWYgKElTX0VSUihycSkpIHsKKwkJZXJyID0gUFRSX0VSUihycSk7CisJCWdvdG8gZXJyX3Jl
c3VsdDE7CisJfQorCisJZXJyID0gcG9pc29uX3JlZ2lzdGVycyhCLCBwb2lzb24sIHNlbWEpOwor
CWlmIChlcnIpIHsKKwkJV1JJVEVfT05DRSgqc2VtYSwgLTEpOworCQlpOTE1X3JlcXVlc3RfcHV0
KHJxKTsKKwkJZ290byBlcnJfcmVzdWx0MTsKKwl9CisKKwlpZiAoaTkxNV9yZXF1ZXN0X3dhaXQo
cnEsIDAsIEhaIC8gMikgPCAwKSB7CisJCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCQllcnIgPSAt
RVRJTUU7CisJCWdvdG8gZXJyX3Jlc3VsdDE7CisJfQorCWk5MTVfcmVxdWVzdF9wdXQocnEpOwor
CisJZXJyID0gY29tcGFyZV9pc29sYXRpb24oZW5naW5lLCByZWYsIHJlc3VsdCwgQSwgcG9pc29u
KTsKKworZXJyX3Jlc3VsdDE6CisJaTkxNV92bWFfcHV0KHJlc3VsdFsxXSk7CitlcnJfcmVzdWx0
MDoKKwlpOTE1X3ZtYV9wdXQocmVzdWx0WzBdKTsKK2Vycl9yZWYxOgorCWk5MTVfdm1hX3B1dChy
ZWZbMV0pOworZXJyX3JlZjA6CisJaTkxNV92bWFfcHV0KHJlZlswXSk7CitlcnJfQjoKKwlpbnRl
bF9jb250ZXh0X3B1dChCKTsKK2Vycl9BOgorCWludGVsX2NvbnRleHRfcHV0KEEpOworCXJldHVy
biBlcnI7Cit9CisKK3N0YXRpYyBib29sIHNraXBfaXNvbGF0aW9uKGNvbnN0IHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlpZiAoZW5naW5lLT5jbGFzcyA9PSBDT1BZX0VOR0lO
RV9DTEFTUyAmJiBJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA9PSA5KQorCQlyZXR1cm4gdHJ1ZTsK
KworCWlmIChlbmdpbmUtPmNsYXNzID09IFJFTkRFUl9DTEFTUyAmJiBJTlRFTF9HRU4oZW5naW5l
LT5pOTE1KSA9PSAxMSkKKwkJcmV0dXJuIHRydWU7CisKKwlyZXR1cm4gZmFsc2U7Cit9CisKK3N0
YXRpYyBpbnQgbGl2ZV9scmNfaXNvbGF0aW9uKHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3QgaW50ZWxf
Z3QgKmd0ID0gYXJnOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKKwllbnVtIGlu
dGVsX2VuZ2luZV9pZCBpZDsKKwljb25zdCB1MzIgcG9pc29uW10gPSB7CisJCVNUQUNLX01BR0lD
LAorCQkweDNhM2EzYTNhLAorCQkweDVjNWM1YzVjLAorCQkweGZmZmZmZmZmLAorCQkweGZmZmYw
MDAwLAorCX07CisJaW50IGVyciA9IDA7CisKKwkvKgorCSAqIE91ciBnb2FsIGlzIHRyeSBhbmQg
dmVyaWZ5IHRoYXQgcGVyLWNvbnRleHQgc3RhdGUgY2Fubm90IGJlCisJICogdGFtcGVyZWQgd2l0
aCBieSBhbm90aGVyIG5vbi1wcml2aWxlZ2VkIGNsaWVudC4KKwkgKgorCSAqIFdlIHRha2UgdGhl
IGxpc3Qgb2YgY29udGV4dCByZWdpc3RlcnMgZnJvbSB0aGUgTFJJIGluIHRoZSBkZWZhdWx0CisJ
ICogY29udGV4dCBpbWFnZSBhbmQgYXR0ZW1wdCB0byBtb2RpZnkgdGhhdCBsaXN0IGZyb20gYSBy
ZW1vdGUgY29udGV4dC4KKwkgKi8KKworCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkg
eworCQlpbnQgaTsKKworCQkvKiBKdXN0IGRvbid0IGV2ZW4gYXNrICovCisJCWlmICghSVNfRU5B
QkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRFU1RfQlJPS0VOKSAmJgorCQkgICAgc2tpcF9pc29s
YXRpb24oZW5naW5lKSkKKwkJCWNvbnRpbnVlOworCisJCWludGVsX2VuZ2luZV9wbV9nZXQoZW5n
aW5lKTsKKwkJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUocG9pc29uKTsgaSsrKSB7CisJCQlp
bnQgcmVzdWx0OworCisJCQlyZXN1bHQgPSBfX2xyY19pc29sYXRpb24oZW5naW5lLCBwb2lzb25b
aV0pOworCQkJaWYgKHJlc3VsdCAmJiAhZXJyKQorCQkJCWVyciA9IHJlc3VsdDsKKworCQkJcmVz
dWx0ID0gX19scmNfaXNvbGF0aW9uKGVuZ2luZSwgfnBvaXNvbltpXSk7CisJCQlpZiAocmVzdWx0
ICYmICFlcnIpCisJCQkJZXJyID0gcmVzdWx0OworCQl9CisJCWludGVsX2VuZ2luZV9wbV9wdXQo
ZW5naW5lKTsKKwkJaWYgKGlndF9mbHVzaF90ZXN0KGd0LT5pOTE1KSkgeworCQkJZXJyID0gLUVJ
TzsKKwkJCWJyZWFrOworCQl9CisJfQorCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBp
bmRpcmVjdF9jdHhfc3VibWl0X3JlcShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCit7CisJc3Ry
dWN0IGk5MTVfcmVxdWVzdCAqcnE7CisJaW50IGVyciA9IDA7CisKKwlycSA9IGludGVsX2NvbnRl
eHRfY3JlYXRlX3JlcXVlc3QoY2UpOworCWlmIChJU19FUlIocnEpKQorCQlyZXR1cm4gUFRSX0VS
UihycSk7CisKKwlpOTE1X3JlcXVlc3RfZ2V0KHJxKTsKKwlpOTE1X3JlcXVlc3RfYWRkKHJxKTsK
KworCWlmIChpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDApCisJCWVyciA9IC1F
VElNRTsKKworCWk5MTVfcmVxdWVzdF9wdXQocnEpOworCisJcmV0dXJuIGVycjsKK30KKworI2Rl
ZmluZSBDVFhfQkJfQ0FOQVJZX09GRlNFVCAoMyAqIDEwMjQpCisjZGVmaW5lIENUWF9CQl9DQU5B
UllfSU5ERVggIChDVFhfQkJfQ0FOQVJZX09GRlNFVCAvIHNpemVvZih1MzIpKQorCitzdGF0aWMg
dTMyICoKK2VtaXRfaW5kaXJlY3RfY3R4X2JiX2NhbmFyeShjb25zdCBzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqY2UsIHUzMiAqY3MpCit7CisJKmNzKysgPSBNSV9TVE9SRV9SRUdJU1RFUl9NRU1fR0VO
OCB8CisJCU1JX1NSTV9MUk1fR0xPQkFMX0dUVCB8CisJCU1JX0xSSV9MUk1fQ1NfTU1JTzsKKwkq
Y3MrKyA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KFJJTkdfU1RBUlQoMCkpOworCSpjcysrID0gaTkx
NV9nZ3R0X29mZnNldChjZS0+c3RhdGUpICsKKwkJY29udGV4dF93YV9iYl9vZmZzZXQoY2UpICsK
KwkJQ1RYX0JCX0NBTkFSWV9PRkZTRVQ7CisJKmNzKysgPSAwOworCisJcmV0dXJuIGNzOworfQor
CitzdGF0aWMgdm9pZAoraW5kaXJlY3RfY3R4X2JiX3NldHVwKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSkKK3sKKwl1MzIgKmNzID0gY29udGV4dF9pbmRpcmVjdF9iYihjZSk7CisKKwljc1tDVFhf
QkJfQ0FOQVJZX0lOREVYXSA9IDB4ZGVhZGYwMGQ7CisKKwlzZXR1cF9pbmRpcmVjdF9jdHhfYmIo
Y2UsIGNlLT5lbmdpbmUsIGVtaXRfaW5kaXJlY3RfY3R4X2JiX2NhbmFyeSk7Cit9CisKK3N0YXRp
YyBib29sIGNoZWNrX3Jpbmdfc3RhcnQoc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQoreworCWNv
bnN0IHUzMiAqIGNvbnN0IGN0eF9iYiA9ICh2b2lkICopKGNlLT5scmNfcmVnX3N0YXRlKSAtCisJ
CUxSQ19TVEFURV9PRkZTRVQgKyBjb250ZXh0X3dhX2JiX29mZnNldChjZSk7CisKKwlpZiAoY3R4
X2JiW0NUWF9CQl9DQU5BUllfSU5ERVhdID09IGNlLT5scmNfcmVnX3N0YXRlW0NUWF9SSU5HX1NU
QVJUXSkKKwkJcmV0dXJuIHRydWU7CisKKwlwcl9lcnIoInJpbmcgc3RhcnQgbWlzbWF0Y2g6IGNh
bmFyeSAweCUwOHggdnMgc3RhdGUgMHglMDh4XG4iLAorCSAgICAgICBjdHhfYmJbQ1RYX0JCX0NB
TkFSWV9JTkRFWF0sCisJICAgICAgIGNlLT5scmNfcmVnX3N0YXRlW0NUWF9SSU5HX1NUQVJUXSk7
CisKKwlyZXR1cm4gZmFsc2U7Cit9CisKK3N0YXRpYyBpbnQgaW5kaXJlY3RfY3R4X2JiX2NoZWNr
KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwlpbnQgZXJyOworCisJZXJyID0gaW5kaXJl
Y3RfY3R4X3N1Ym1pdF9yZXEoY2UpOworCWlmIChlcnIpCisJCXJldHVybiBlcnI7CisKKwlpZiAo
IWNoZWNrX3Jpbmdfc3RhcnQoY2UpKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IF9fbGl2ZV9scmNfaW5kaXJlY3RfY3R4X2JiKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKK3sKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqYSwgKmI7CisJaW50
IGVycjsKKworCWEgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShlbmdpbmUpOworCWlmIChJU19FUlIo
YSkpCisJCXJldHVybiBQVFJfRVJSKGEpOworCWVyciA9IGludGVsX2NvbnRleHRfcGluKGEpOwor
CWlmIChlcnIpCisJCWdvdG8gcHV0X2E7CisKKwliID0gaW50ZWxfY29udGV4dF9jcmVhdGUoZW5n
aW5lKTsKKwlpZiAoSVNfRVJSKGIpKSB7CisJCWVyciA9IFBUUl9FUlIoYik7CisJCWdvdG8gdW5w
aW5fYTsKKwl9CisJZXJyID0gaW50ZWxfY29udGV4dF9waW4oYik7CisJaWYgKGVycikKKwkJZ290
byBwdXRfYjsKKworCS8qIFdlIHVzZSB0aGUgYWxyZWFkeSByZXNlcnZlZCBleHRyYSBwYWdlIGlu
IGNvbnRleHQgc3RhdGUgKi8KKwlpZiAoIWEtPndhX2JiX3BhZ2UpIHsKKwkJR0VNX0JVR19PTihi
LT53YV9iYl9wYWdlKTsKKwkJR0VNX0JVR19PTihJTlRFTF9HRU4oZW5naW5lLT5pOTE1KSA9PSAx
Mik7CisJCWdvdG8gdW5waW5fYjsKKwl9CisKKwkvKgorCSAqIEluIG9yZGVyIHRvIHRlc3QgdGhh
dCBvdXIgcGVyIGNvbnRleHQgYmIgaXMgdHJ1bHkgcGVyIGNvbnRleHQsCisJICogYW5kIGV4ZWN1
dGVzIGF0IHRoZSBpbnRlbmRlZCBzcG90IG9uIGNvbnRleHQgcmVzdG9yaW5nIHByb2Nlc3MsCisJ
ICogbWFrZSB0aGUgYmF0Y2ggc3RvcmUgdGhlIHJpbmcgc3RhcnQgdmFsdWUgdG8gbWVtb3J5Lgor
CSAqIEFzIHJpbmcgc3RhcnQgaXMgcmVzdG9yZWQgYXByaW9yaSBvZiBzdGFydGluZyB0aGUgaW5k
aXJlY3QgY3R4IGJiIGFuZAorCSAqIGFzIGl0IHdpbGwgYmUgZGlmZmVyZW50IGZvciBlYWNoIGNv
bnRleHQsIGl0IGZpdHMgdG8gdGhpcyBwdXJwb3NlLgorCSAqLworCWluZGlyZWN0X2N0eF9iYl9z
ZXR1cChhKTsKKwlpbmRpcmVjdF9jdHhfYmJfc2V0dXAoYik7CisKKwllcnIgPSBpbmRpcmVjdF9j
dHhfYmJfY2hlY2soYSk7CisJaWYgKGVycikKKwkJZ290byB1bnBpbl9iOworCisJZXJyID0gaW5k
aXJlY3RfY3R4X2JiX2NoZWNrKGIpOworCit1bnBpbl9iOgorCWludGVsX2NvbnRleHRfdW5waW4o
Yik7CitwdXRfYjoKKwlpbnRlbF9jb250ZXh0X3B1dChiKTsKK3VucGluX2E6CisJaW50ZWxfY29u
dGV4dF91bnBpbihhKTsKK3B1dF9hOgorCWludGVsX2NvbnRleHRfcHV0KGEpOworCisJcmV0dXJu
IGVycjsKK30KKworc3RhdGljIGludCBsaXZlX2xyY19pbmRpcmVjdF9jdHhfYmIodm9pZCAqYXJn
KQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CisJc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lOworCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOworCWludCBlcnIgPSAwOworCisJ
Zm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QsIGlkKSB7CisJCWludGVsX2VuZ2luZV9wbV9nZXQo
ZW5naW5lKTsKKwkJZXJyID0gX19saXZlX2xyY19pbmRpcmVjdF9jdHhfYmIoZW5naW5lKTsKKwkJ
aW50ZWxfZW5naW5lX3BtX3B1dChlbmdpbmUpOworCisJCWlmIChpZ3RfZmx1c2hfdGVzdChndC0+
aTkxNSkpCisJCQllcnIgPSAtRUlPOworCisJCWlmIChlcnIpCisJCQlicmVhazsKKwl9CisKKwly
ZXR1cm4gZXJyOworfQorCitzdGF0aWMgdm9pZCBnYXJiYWdlX3Jlc2V0KHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSwKKwkJCSAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCit7CisJY29u
c3QgdW5zaWduZWQgaW50IGJpdCA9IEk5MTVfUkVTRVRfRU5HSU5FICsgZW5naW5lLT5pZDsKKwl1
bnNpZ25lZCBsb25nICpsb2NrID0gJmVuZ2luZS0+Z3QtPnJlc2V0LmZsYWdzOworCisJaWYgKHRl
c3RfYW5kX3NldF9iaXQoYml0LCBsb2NrKSkKKwkJcmV0dXJuOworCisJdGFza2xldF9kaXNhYmxl
KCZlbmdpbmUtPmV4ZWNsaXN0cy50YXNrbGV0KTsKKworCWlmICghcnEtPmZlbmNlLmVycm9yKQor
CQlpbnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCBOVUxMKTsKKworCXRhc2tsZXRfZW5hYmxlKCZl
bmdpbmUtPmV4ZWNsaXN0cy50YXNrbGV0KTsKKwljbGVhcl9hbmRfd2FrZV91cF9iaXQoYml0LCBs
b2NrKTsKK30KKworc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKmdhcmJhZ2Uoc3RydWN0IGlu
dGVsX2NvbnRleHQgKmNlLAorCQkJCSAgICBzdHJ1Y3Qgcm5kX3N0YXRlICpwcm5nKQoreworCXN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxOworCWludCBlcnI7CisKKwllcnIgPSBpbnRlbF9jb250ZXh0
X3BpbihjZSk7CisJaWYgKGVycikKKwkJcmV0dXJuIEVSUl9QVFIoZXJyKTsKKworCXByYW5kb21f
Ynl0ZXNfc3RhdGUocHJuZywKKwkJCSAgICBjZS0+bHJjX3JlZ19zdGF0ZSwKKwkJCSAgICBjZS0+
ZW5naW5lLT5jb250ZXh0X3NpemUgLQorCQkJICAgIExSQ19TVEFURV9PRkZTRVQpOworCisJcnEg
PSBpbnRlbF9jb250ZXh0X2NyZWF0ZV9yZXF1ZXN0KGNlKTsKKwlpZiAoSVNfRVJSKHJxKSkgewor
CQllcnIgPSBQVFJfRVJSKHJxKTsKKwkJZ290byBlcnJfdW5waW47CisJfQorCisJaTkxNV9yZXF1
ZXN0X2dldChycSk7CisJaTkxNV9yZXF1ZXN0X2FkZChycSk7CisJcmV0dXJuIHJxOworCitlcnJf
dW5waW46CisJaW50ZWxfY29udGV4dF91bnBpbihjZSk7CisJcmV0dXJuIEVSUl9QVFIoZXJyKTsK
K30KKworc3RhdGljIGludCBfX2xyY19nYXJiYWdlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSwgc3RydWN0IHJuZF9zdGF0ZSAqcHJuZykKK3sKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2U7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqaGFuZzsKKwlpbnQgZXJyID0gMDsKKworCWNlID0g
aW50ZWxfY29udGV4dF9jcmVhdGUoZW5naW5lKTsKKwlpZiAoSVNfRVJSKGNlKSkKKwkJcmV0dXJu
IFBUUl9FUlIoY2UpOworCisJaGFuZyA9IGdhcmJhZ2UoY2UsIHBybmcpOworCWlmIChJU19FUlIo
aGFuZykpIHsKKwkJZXJyID0gUFRSX0VSUihoYW5nKTsKKwkJZ290byBlcnJfY2U7CisJfQorCisJ
aWYgKHdhaXRfZm9yX3N1Ym1pdChlbmdpbmUsIGhhbmcsIEhaIC8gMikpIHsKKwkJaTkxNV9yZXF1
ZXN0X3B1dChoYW5nKTsKKwkJZXJyID0gLUVUSU1FOworCQlnb3RvIGVycl9jZTsKKwl9CisKKwlp
bnRlbF9jb250ZXh0X3NldF9iYW5uZWQoY2UpOworCWdhcmJhZ2VfcmVzZXQoZW5naW5lLCBoYW5n
KTsKKworCWludGVsX2VuZ2luZV9mbHVzaF9zdWJtaXNzaW9uKGVuZ2luZSk7CisJaWYgKCFoYW5n
LT5mZW5jZS5lcnJvcikgeworCQlpOTE1X3JlcXVlc3RfcHV0KGhhbmcpOworCQlwcl9lcnIoIiVz
OiBjb3JydXB0ZWQgY29udGV4dCB3YXMgbm90IHJlc2V0XG4iLAorCQkgICAgICAgZW5naW5lLT5u
YW1lKTsKKwkJZXJyID0gLUVJTlZBTDsKKwkJZ290byBlcnJfY2U7CisJfQorCisJaWYgKGk5MTVf
cmVxdWVzdF93YWl0KGhhbmcsIDAsIEhaIC8gMikgPCAwKSB7CisJCXByX2VycigiJXM6IGNvcnJ1
cHRlZCBjb250ZXh0IGRpZCBub3QgcmVjb3ZlclxuIiwKKwkJICAgICAgIGVuZ2luZS0+bmFtZSk7
CisJCWk5MTVfcmVxdWVzdF9wdXQoaGFuZyk7CisJCWVyciA9IC1FSU87CisJCWdvdG8gZXJyX2Nl
OworCX0KKwlpOTE1X3JlcXVlc3RfcHV0KGhhbmcpOworCitlcnJfY2U6CisJaW50ZWxfY29udGV4
dF9wdXQoY2UpOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgbGl2ZV9scmNfZ2FyYmFn
ZSh2b2lkICphcmcpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGFyZzsKKwlzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisKKwkvKgor
CSAqIFZlcmlmeSB0aGF0IHdlIGNhbiByZWNvdmVyIGlmIG9uZSBjb250ZXh0IHN0YXRlIGlzIGNv
bXBsZXRlbHkKKwkgKiBjb3JydXB0ZWQuCisJICovCisKKwlpZiAoIUlTX0VOQUJMRUQoQ09ORklH
X0RSTV9JOTE1X1NFTEZURVNUX0JST0tFTikpCisJCXJldHVybiAwOworCisJZm9yX2VhY2hfZW5n
aW5lKGVuZ2luZSwgZ3QsIGlkKSB7CisJCUk5MTVfUk5EX1NUQVRFKHBybmcpOworCQlpbnQgZXJy
ID0gMCwgaTsKKworCQlpZiAoIWludGVsX2hhc19yZXNldF9lbmdpbmUoZW5naW5lLT5ndCkpCisJ
CQljb250aW51ZTsKKworCQlpbnRlbF9lbmdpbmVfcG1fZ2V0KGVuZ2luZSk7CisJCWZvciAoaSA9
IDA7IGkgPCAzOyBpKyspIHsKKwkJCWVyciA9IF9fbHJjX2dhcmJhZ2UoZW5naW5lLCAmcHJuZyk7
CisJCQlpZiAoZXJyKQorCQkJCWJyZWFrOworCQl9CisJCWludGVsX2VuZ2luZV9wbV9wdXQoZW5n
aW5lKTsKKworCQlpZiAoaWd0X2ZsdXNoX3Rlc3QoZ3QtPmk5MTUpKQorCQkJZXJyID0gLUVJTzsK
KwkJaWYgKGVycikKKwkJCXJldHVybiBlcnI7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBpbnQgX19saXZlX3BwaHdzcF9ydW50aW1lKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSkKK3sKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnE7CisJSUdUX1RJTUVPVVQoZW5kX3RpbWUpOworCWludCBlcnI7CisKKwljZSA9IGludGVsX2Nv
bnRleHRfY3JlYXRlKGVuZ2luZSk7CisJaWYgKElTX0VSUihjZSkpCisJCXJldHVybiBQVFJfRVJS
KGNlKTsKKworCWNlLT5ydW50aW1lLm51bV91bmRlcmZsb3cgPSAwOworCWNlLT5ydW50aW1lLm1h
eF91bmRlcmZsb3cgPSAwOworCisJZG8geworCQl1bnNpZ25lZCBpbnQgbG9vcCA9IDEwMjQ7CisK
KwkJd2hpbGUgKGxvb3ApIHsKKwkJCXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChj
ZSk7CisJCQlpZiAoSVNfRVJSKHJxKSkgeworCQkJCWVyciA9IFBUUl9FUlIocnEpOworCQkJCWdv
dG8gZXJyX3JxOworCQkJfQorCisJCQlpZiAoLS1sb29wID09IDApCisJCQkJaTkxNV9yZXF1ZXN0
X2dldChycSk7CisKKwkJCWk5MTVfcmVxdWVzdF9hZGQocnEpOworCQl9CisKKwkJaWYgKF9faWd0
X3RpbWVvdXQoZW5kX3RpbWUsIE5VTEwpKQorCQkJYnJlYWs7CisKKwkJaTkxNV9yZXF1ZXN0X3B1
dChycSk7CisJfSB3aGlsZSAoMSk7CisKKwllcnIgPSBpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwg
SFogLyA1KTsKKwlpZiAoZXJyIDwgMCkgeworCQlwcl9lcnIoIiVzOiByZXF1ZXN0IG5vdCBjb21w
bGV0ZWQhXG4iLCBlbmdpbmUtPm5hbWUpOworCQlnb3RvIGVycl93YWl0OworCX0KKworCWlndF9m
bHVzaF90ZXN0KGVuZ2luZS0+aTkxNSk7CisKKwlwcl9pbmZvKCIlczogcHBod3NwIHJ1bnRpbWUg
JWxsdW5zLCBhdmVyYWdlICVsbHVuc1xuIiwKKwkJZW5naW5lLT5uYW1lLAorCQlpbnRlbF9jb250
ZXh0X2dldF90b3RhbF9ydW50aW1lX25zKGNlKSwKKwkJaW50ZWxfY29udGV4dF9nZXRfYXZnX3J1
bnRpbWVfbnMoY2UpKTsKKworCWVyciA9IDA7CisJaWYgKGNlLT5ydW50aW1lLm51bV91bmRlcmZs
b3cpIHsKKwkJcHJfZXJyKCIlczogcHBod3NwIHVuZGVyZmxvdyAldSB0aW1lKHMpLCBtYXggJXUg
Y3ljbGVzIVxuIiwKKwkJICAgICAgIGVuZ2luZS0+bmFtZSwKKwkJICAgICAgIGNlLT5ydW50aW1l
Lm51bV91bmRlcmZsb3csCisJCSAgICAgICBjZS0+cnVudGltZS5tYXhfdW5kZXJmbG93KTsKKwkJ
R0VNX1RSQUNFX0RVTVAoKTsKKwkJZXJyID0gLUVPVkVSRkxPVzsKKwl9CisKK2Vycl93YWl0Ogor
CWk5MTVfcmVxdWVzdF9wdXQocnEpOworZXJyX3JxOgorCWludGVsX2NvbnRleHRfcHV0KGNlKTsK
KwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgaW50IGxpdmVfcHBod3NwX3J1bnRpbWUodm9pZCAq
YXJnKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBhcmc7CisJc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lOworCWVudW0gaW50ZWxfZW5naW5lX2lkIGlkOworCWludCBlcnIgPSAwOwor
CisJLyoKKwkgKiBDaGVjayB0aGF0IGN1bXVsYXRpdmUgY29udGV4dCBydW50aW1lIGFzIHN0b3Jl
ZCBpbiB0aGUgcHBod3NwWzE2XQorCSAqIGlzIG1vbm90b25pYy4KKwkgKi8KKworCWZvcl9lYWNo
X2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgeworCQllcnIgPSBfX2xpdmVfcHBod3NwX3J1bnRpbWUo
ZW5naW5lKTsKKwkJaWYgKGVycikKKwkJCWJyZWFrOworCX0KKworCWlmIChpZ3RfZmx1c2hfdGVz
dChndC0+aTkxNSkpCisJCWVyciA9IC1FSU87CisKKwlyZXR1cm4gZXJyOworfQorCitpbnQgaW50
ZWxfbHJjX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQorewor
CXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7CisJCVNVQlRFU1Qo
bGl2ZV9scmNfbGF5b3V0KSwKKwkJU1VCVEVTVChsaXZlX2xyY19maXhlZCksCisJCVNVQlRFU1Qo
bGl2ZV9scmNfc3RhdGUpLAorCQlTVUJURVNUKGxpdmVfbHJjX2dwciksCisJCVNVQlRFU1QobGl2
ZV9scmNfaXNvbGF0aW9uKSwKKwkJU1VCVEVTVChsaXZlX2xyY190aW1lc3RhbXApLAorCQlTVUJU
RVNUKGxpdmVfbHJjX2dhcmJhZ2UpLAorCQlTVUJURVNUKGxpdmVfcHBod3NwX3J1bnRpbWUpLAor
CQlTVUJURVNUKGxpdmVfbHJjX2luZGlyZWN0X2N0eF9iYiksCisJfTsKKworCWlmICghSEFTX0xP
R0lDQUxfUklOR19DT05URVhUUyhpOTE1KSkKKwkJcmV0dXJuIDA7CisKKwlyZXR1cm4gaW50ZWxf
Z3RfbGl2ZV9zdWJ0ZXN0cyh0ZXN0cywgJmk5MTUtPmd0KTsKK30KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19hZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3VjL2ludGVsX2d1Y19hZHMuYwppbmRleCAxYTJlNGY2MzE3NjMuLjE3NTI2NzE3MzY4
YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX2Fkcy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19hZHMuYwpAQCAtMyw4
ICszLDggQEAKICAqIENvcHlyaWdodCDCqSAyMDE0LTIwMTkgSW50ZWwgQ29ycG9yYXRpb24KICAq
LwogCi0jaW5jbHVkZSAiZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uaCIgLyogbHJjIGxh
eW91dCAqLwogI2luY2x1ZGUgImd0L2ludGVsX2d0LmgiCisjaW5jbHVkZSAiZ3QvaW50ZWxfbHJj
LmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3VjX2Fkcy5oIgogI2luY2x1ZGUgImludGVsX3VjLmgiCiAj
aW5jbHVkZSAiaTkxNV9kcnYuaCIKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9p
bnRlbF9ndWNfc3VibWlzc2lvbi5jCmluZGV4IDg1MjhhYjU3NGRiZS4uMTc5MjI3OThkNDBjIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lv
bi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19zdWJtaXNzaW9u
LmMKQEAgLTExLDcgKzExLDcgQEAKICNpbmNsdWRlICJndC9pbnRlbF9leGVjbGlzdHNfc3VibWlz
c2lvbi5oIiAvKiBYWFggKi8KICNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgogI2luY2x1ZGUgImd0
L2ludGVsX2d0X3BtLmgiCi0jaW5jbHVkZSAiZ3QvaW50ZWxfbHJjX3JlZy5oIgorI2luY2x1ZGUg
Imd0L2ludGVsX2xyYy5oIgogI2luY2x1ZGUgImd0L2ludGVsX3JpbmcuaCIKIAogI2luY2x1ZGUg
ImludGVsX2d1Y19zdWJtaXNzaW9uLmgiCkBAIC00MDIsNiArNDAyLDI4IEBAIGNhbmNlbF9wb3J0
X3JlcXVlc3RzKHN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3QgZXhlY2xpc3Rz
KQogCQltZW1zZXQoZXhlY2xpc3RzLT5pbmZsaWdodCwgMCwgc2l6ZW9mKGV4ZWNsaXN0cy0+aW5m
bGlnaHQpKTsKIH0KIAorc3RhdGljIHZvaWQgbHJjX3Jlc2V0KHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSwKKwkJICAgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQkgICAgICB1
MzIgaGVhZCwKKwkJICAgICAgYm9vbCBzY3J1YikKK3sKKwlHRU1fQlVHX09OKCFpbnRlbF9jb250
ZXh0X2lzX3Bpbm5lZChjZSkpOworCisJLyoKKwkgKiBXZSB3YW50IGEgc2ltcGxlIGNvbnRleHQg
KyByaW5nIHRvIGV4ZWN1dGUgdGhlIGJyZWFkY3J1bWIgdXBkYXRlLgorCSAqIFdlIGNhbm5vdCBy
ZWx5IG9uIHRoZSBjb250ZXh0IGJlaW5nIGludGFjdCBhY3Jvc3MgdGhlIEdQVSBoYW5nLAorCSAq
IHNvIGNsZWFyIGl0IGFuZCByZWJ1aWxkIGp1c3Qgd2hhdCB3ZSBuZWVkIGZvciB0aGUgYnJlYWRj
cnVtYi4KKwkgKiBBbGwgcGVuZGluZyByZXF1ZXN0cyBmb3IgdGhpcyBjb250ZXh0IHdpbGwgYmUg
emFwcGVkLCBhbmQgYW55CisJICogZnV0dXJlIHJlcXVlc3Qgd2lsbCBiZSBhZnRlciB1c2Vyc3Bh
Y2UgaGFzIGhhZCB0aGUgb3Bwb3J0dW5pdHkKKwkgKiB0byByZWNyZWF0ZSBpdHMgb3duIHN0YXRl
LgorCSAqLworCWlmIChzY3J1YikKKwkJbHJjX3Jlc3RvcmVfZGVmYXVsdHMoY2UsIGVuZ2luZSk7
CisKKwkvKiBSZXJ1biB0aGUgcmVxdWVzdDsgaXRzIHBheWxvYWQgaGFzIGJlZW4gbmV1dGVyZWQg
KGlmIGd1aWx0eSkuICovCisJbHJjX3VwZGF0ZV9yZWdzKGNlLCBlbmdpbmUsIGhlYWQpOworfQor
CiBzdGF0aWMgdm9pZCBndWNfcmVzZXRfcmV3aW5kKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSwgYm9vbCBzdGFsbGVkKQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICog
Y29uc3QgZXhlY2xpc3RzID0gJmVuZ2luZS0+ZXhlY2xpc3RzOwpAQCAtNDIxLDcgKzQ0Myw3IEBA
IHN0YXRpYyB2b2lkIGd1Y19yZXNldF9yZXdpbmQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lLCBib29sIHN0YWxsZWQpCiAJCXN0YWxsZWQgPSBmYWxzZTsKIAogCV9faTkxNV9yZXF1ZXN0
X3Jlc2V0KHJxLCBzdGFsbGVkKTsKLQlpbnRlbF9scl9jb250ZXh0X3Jlc2V0KGVuZ2luZSwgcnEt
PmNvbnRleHQsIHJxLT5oZWFkLCBzdGFsbGVkKTsKKwlscmNfcmVzZXQocnEtPmNvbnRleHQsIGVu
Z2luZSwgcnEtPmhlYWQsIHN0YWxsZWQpOwogCiBvdXRfdW5sb2NrOgogCXNwaW5fdW5sb2NrX2ly
cXJlc3RvcmUoJmVuZ2luZS0+YWN0aXZlLmxvY2ssIGZsYWdzKTsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2
dC9zY2hlZHVsZXIuYwppbmRleCBlZDMwZmRkZTQxMTQuLjZhZjVjMDZjYWVlMCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYwpAQCAtMzgsNiArMzgsNyBAQAogI2luY2x1ZGUgImdl
bS9pOTE1X2dlbV9wbS5oIgogI2luY2x1ZGUgImd0L2ludGVsX2NvbnRleHQuaCIKICNpbmNsdWRl
ICJndC9pbnRlbF9leGVjbGlzdHNfc3VibWlzc2lvbi5oIgorI2luY2x1ZGUgImd0L2ludGVsX2xy
Yy5oIgogI2luY2x1ZGUgImd0L2ludGVsX3JpbmcuaCIKIAogI2luY2x1ZGUgImk5MTVfZHJ2Lmgi
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCmluZGV4IDU4Y2FhM2YxYTM4Yi4uZjY1YzMyYmQ5NzBl
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwpAQCAtMjAxLDcgKzIwMSw3IEBACiAjaW5jbHVk
ZSAiZ3QvaW50ZWxfZXhlY2xpc3RzX3N1Ym1pc3Npb24uaCIKICNpbmNsdWRlICJndC9pbnRlbF9n
cHVfY29tbWFuZHMuaCIKICNpbmNsdWRlICJndC9pbnRlbF9ndC5oIgotI2luY2x1ZGUgImd0L2lu
dGVsX2xyY19yZWcuaCIKKyNpbmNsdWRlICJndC9pbnRlbF9scmMuaCIKICNpbmNsdWRlICJndC9p
bnRlbF9yaW5nLmgiCiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgotLSAKMi4yMC4xCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

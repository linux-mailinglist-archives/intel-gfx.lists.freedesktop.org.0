Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 64BE047AB6
	for <lists+intel-gfx@lfdr.de>; Mon, 17 Jun 2019 09:22:36 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 828988919F;
	Mon, 17 Jun 2019 07:22:34 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F1BDD8918F
 for <intel-gfx@lists.freedesktop.org>; Mon, 17 Jun 2019 07:22:30 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16923058-1500050 
 for multiple; Mon, 17 Jun 2019 08:19:16 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 17 Jun 2019 08:19:11 +0100
Message-Id: <20190617071912.20256-21-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190617071912.20256-1-chris@chris-wilson.co.uk>
References: <20190617071912.20256-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 21/22] drm/i915: Replace struct_mutex for batch
 pool serialisation
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: matthew.auld@intel.com, mika.kuoppala@intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U3dpdGNoIHRvIHRyYWNraW5nIGFjdGl2aXR5IHZpYSBpOTE1X2FjdGl2ZSBvbiBpbmRpdmlkdWFs
IG5vZGVzLCBvbmx5CmtlZXBpbmcgYSBsaXN0IG9mIHJldGlyZWQgb2JqZWN0cyBpbiB0aGUgY2Fj
aGUsIGFuZCByZWFwaW5nIHRoZSBjYWNoZQp3aGVuIHRoZSBlbmdpbmUgaXRzZWxmIGlkbGVzLgoK
U2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0t
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgICAgICAgICAgICAgICAgIHwgICAyICst
CiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgICAgfCAgNTggKysr
Ky0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jICAgIHwgICAx
IC0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oICB8ICAgMSAt
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYyAgICAgICAgfCAgIDQgKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oICAgICAgICB8ICAgMSAtCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyAgICAgfCAgMTEgKy0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jICAgICB8ICAgMiArCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5jICAgfCAxNjMgKysrKysrKysr
KysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbC5oICAg
fCAgMzMgKysrKwogLi4uL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbF90eXBlcy5o
IHwgIDI5ICsrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5o
ICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgICAgICAgICAg
IHwgIDY4IC0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9iYXRjaF9wb29s
LmMgICAgfCAxMzIgLS0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2Vt
X2JhdGNoX3Bvb2wuaCAgICB8ICAyNiAtLS0KIDE1IGZpbGVzIGNoYW5nZWQsIDI3MSBpbnNlcnRp
b25zKCspLCAyNjQgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmgKIGNyZWF0ZSBtb2RlIDEwMDY0
NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbF90eXBlcy5oCiBkZWxl
dGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fYmF0Y2hfcG9vbC5j
CiBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fYmF0Y2hf
cG9vbC5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQppbmRleCBmNDk3MTkwMDA4N2EuLmRjNmMyMmI0MGVm
ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKQEAgLTcwLDYgKzcwLDcgQEAgb2JqLXkgKz0gZ3QvCiBn
dC15ICs9IFwKIAlndC9pbnRlbF9icmVhZGNydW1icy5vIFwKIAlndC9pbnRlbF9jb250ZXh0Lm8g
XAorCWd0L2ludGVsX2VuZ2luZV9wb29sLm8gXAogCWd0L2ludGVsX2VuZ2luZV9jcy5vIFwKIAln
dC9pbnRlbF9lbmdpbmVfcG0ubyBcCiAJZ3QvaW50ZWxfZ3RfcG0ubyBcCkBAIC0xMTQsNyArMTE1
LDYgQEAgaTkxNS15ICs9IFwKIAkgICQoZ2VtLXkpIFwKIAkgIGk5MTVfYWN0aXZlLm8gXAogCSAg
aTkxNV9jbWRfcGFyc2VyLm8gXAotCSAgaTkxNV9nZW1fYmF0Y2hfcG9vbC5vIFwKIAkgIGk5MTVf
Z2VtX2V2aWN0Lm8gXAogCSAgaTkxNV9nZW1fZmVuY2VfcmVnLm8gXAogCSAgaTkxNV9nZW1fZ3R0
Lm8gXApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNi
dWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMK
aW5kZXggZWViNGM2Y2RiMDFkLi5iMDliZTI2YzQzNDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwpAQCAtMTQsNiArMTQsNyBAQAogCiAjaW5j
bHVkZSAiZ2VtL2k5MTVfZ2VtX2lvY3Rscy5oIgogI2luY2x1ZGUgImd0L2ludGVsX2NvbnRleHQu
aCIKKyNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmVfcG9vbC5oIgogI2luY2x1ZGUgImd0L2ludGVs
X2d0X3BtLmgiCiAKICNpbmNsdWRlICJpOTE1X2dlbV9pb2N0bHMuaCIKQEAgLTEyMDAsMjUgKzEy
MDEsMjYgQEAgc3RhdGljIGludCBfX3JlbG9jX2dwdV9hbGxvYyhzdHJ1Y3QgaTkxNV9leGVjYnVm
ZmVyICplYiwKIAkJCSAgICAgdW5zaWduZWQgaW50IGxlbikKIHsKIAlzdHJ1Y3QgcmVsb2NfY2Fj
aGUgKmNhY2hlID0gJmViLT5yZWxvY19jYWNoZTsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqOworCXN0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbF9ub2RlICpwb29sOwogCXN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxOwogCXN0cnVjdCBpOTE1X3ZtYSAqYmF0Y2g7CiAJdTMyICpjbWQ7CiAJ
aW50IGVycjsKIAotCW9iaiA9IGk5MTVfZ2VtX2JhdGNoX3Bvb2xfZ2V0KCZlYi0+ZW5naW5lLT5i
YXRjaF9wb29sLCBQQUdFX1NJWkUpOwotCWlmIChJU19FUlIob2JqKSkKLQkJcmV0dXJuIFBUUl9F
UlIob2JqKTsKKwlwb29sID0gaW50ZWxfZW5naW5lX3Bvb2xfZ2V0KCZlYi0+ZW5naW5lLT5wb29s
LCBQQUdFX1NJWkUpOworCWlmIChJU19FUlIocG9vbCkpCisJCXJldHVybiBQVFJfRVJSKHBvb2wp
OwogCi0JY21kID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAob2JqLAorCWNtZCA9IGk5MTVfZ2Vt
X29iamVjdF9waW5fbWFwKHBvb2wtPm9iaiwKIAkJCQkgICAgICBjYWNoZS0+aGFzX2xsYyA/CiAJ
CQkJICAgICAgSTkxNV9NQVBfRk9SQ0VfV0IgOgogCQkJCSAgICAgIEk5MTVfTUFQX0ZPUkNFX1dD
KTsKLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFnZXMob2JqKTsKLQlpZiAoSVNfRVJSKGNtZCkp
Ci0JCXJldHVybiBQVFJfRVJSKGNtZCk7CisJaWYgKElTX0VSUihjbWQpKSB7CisJCWVyciA9IFBU
Ul9FUlIoY21kKTsKKwkJZ290byBvdXRfcG9vbDsKKwl9CiAKLQliYXRjaCA9IGk5MTVfdm1hX2lu
c3RhbmNlKG9iaiwgdm1hLT52bSwgTlVMTCk7CisJYmF0Y2ggPSBpOTE1X3ZtYV9pbnN0YW5jZShw
b29sLT5vYmosIHZtYS0+dm0sIE5VTEwpOwogCWlmIChJU19FUlIoYmF0Y2gpKSB7CiAJCWVyciA9
IFBUUl9FUlIoYmF0Y2gpOwogCQlnb3RvIGVycl91bm1hcDsKQEAgLTEyMzQsNiArMTIzNiwxMCBA
QCBzdGF0aWMgaW50IF9fcmVsb2NfZ3B1X2FsbG9jKHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmVi
LAogCQlnb3RvIGVycl91bnBpbjsKIAl9CiAKKwllcnIgPSBpbnRlbF9lbmdpbmVfcG9vbF9tYXJr
X2FjdGl2ZShwb29sLCBycSk7CisJaWYgKGVycikKKwkJZ290byBlcnJfcmVxdWVzdDsKKwogCWVy
ciA9IHJlbG9jX21vdmVfdG9fZ3B1KHJxLCB2bWEpOwogCWlmIChlcnIpCiAJCWdvdG8gZXJyX3Jl
cXVlc3Q7CkBAIC0xMjU5LDcgKzEyNjUsNyBAQCBzdGF0aWMgaW50IF9fcmVsb2NfZ3B1X2FsbG9j
KHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViLAogCWNhY2hlLT5ycV9zaXplID0gMDsKIAogCS8q
IFJldHVybiB3aXRoIGJhdGNoIG1hcHBpbmcgKGNtZCkgc3RpbGwgcGlubmVkICovCi0JcmV0dXJu
IDA7CisJZ290byBvdXRfcG9vbDsKIAogc2tpcF9yZXF1ZXN0OgogCWk5MTVfcmVxdWVzdF9za2lw
KHJxLCBlcnIpOwpAQCAtMTI2OCw3ICsxMjc0LDkgQEAgc3RhdGljIGludCBfX3JlbG9jX2dwdV9h
bGxvYyhzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwKIGVycl91bnBpbjoKIAlpOTE1X3ZtYV91
bnBpbihiYXRjaCk7CiBlcnJfdW5tYXA6Ci0JaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChvYmop
OworCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAocG9vbC0+b2JqKTsKK291dF9wb29sOgorCWlu
dGVsX2VuZ2luZV9wb29sX3B1dChwb29sKTsKIAlyZXR1cm4gZXJyOwogfQogCkBAIC0yMDEyLDE4
ICsyMDIwLDE3IEBAIHN0YXRpYyBpbnQgaTkxNV9yZXNldF9nZW43X3NvbF9vZmZzZXRzKHN0cnVj
dCBpOTE1X3JlcXVlc3QgKnJxKQogCiBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICplYl9wYXJzZShz
dHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwgYm9vbCBpc19tYXN0ZXIpCiB7Ci0Jc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKnNoYWRvd19iYXRjaF9vYmo7CisJc3RydWN0IGludGVsX2VuZ2lu
ZV9wb29sX25vZGUgKnBvb2w7CiAJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAJaW50IGVycjsKIAot
CXNoYWRvd19iYXRjaF9vYmogPSBpOTE1X2dlbV9iYXRjaF9wb29sX2dldCgmZWItPmVuZ2luZS0+
YmF0Y2hfcG9vbCwKLQkJCQkJCSAgIFBBR0VfQUxJR04oZWItPmJhdGNoX2xlbikpOwotCWlmIChJ
U19FUlIoc2hhZG93X2JhdGNoX29iaikpCi0JCXJldHVybiBFUlJfQ0FTVChzaGFkb3dfYmF0Y2hf
b2JqKTsKKwlwb29sID0gaW50ZWxfZW5naW5lX3Bvb2xfZ2V0KCZlYi0+ZW5naW5lLT5wb29sLCBl
Yi0+YmF0Y2hfbGVuKTsKKwlpZiAoSVNfRVJSKHBvb2wpKQorCQlyZXR1cm4gRVJSX0NBU1QocG9v
bCk7CiAKIAllcnIgPSBpbnRlbF9lbmdpbmVfY21kX3BhcnNlcihlYi0+ZW5naW5lLAogCQkJCSAg
ICAgIGViLT5iYXRjaC0+b2JqLAotCQkJCSAgICAgIHNoYWRvd19iYXRjaF9vYmosCisJCQkJICAg
ICAgcG9vbC0+b2JqLAogCQkJCSAgICAgIGViLT5iYXRjaF9zdGFydF9vZmZzZXQsCiAJCQkJICAg
ICAgZWItPmJhdGNoX2xlbiwKIAkJCQkgICAgICBpc19tYXN0ZXIpOwpAQCAtMjAzMiwxMiArMjAz
OSwxMiBAQCBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICplYl9wYXJzZShzdHJ1Y3QgaTkxNV9leGVj
YnVmZmVyICplYiwgYm9vbCBpc19tYXN0ZXIpCiAJCQl2bWEgPSBOVUxMOwogCQllbHNlCiAJCQl2
bWEgPSBFUlJfUFRSKGVycik7Ci0JCWdvdG8gb3V0OworCQlnb3RvIGVycjsKIAl9CiAKLQl2bWEg
PSBpOTE1X2dlbV9vYmplY3RfZ2d0dF9waW4oc2hhZG93X2JhdGNoX29iaiwgTlVMTCwgMCwgMCwg
MCk7CisJdm1hID0gaTkxNV9nZW1fb2JqZWN0X2dndHRfcGluKHBvb2wtPm9iaiwgTlVMTCwgMCwg
MCwgMCk7CiAJaWYgKElTX0VSUih2bWEpKQotCQlnb3RvIG91dDsKKwkJZ290byBlcnI7CiAKIAll
Yi0+dm1hW2ViLT5idWZmZXJfY291bnRdID0gaTkxNV92bWFfZ2V0KHZtYSk7CiAJZWItPmZsYWdz
W2ViLT5idWZmZXJfY291bnRdID0KQEAgLTIwNDUsOCArMjA1MiwxMSBAQCBzdGF0aWMgc3RydWN0
IGk5MTVfdm1hICplYl9wYXJzZShzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwgYm9vbCBpc19t
YXN0ZXIpCiAJdm1hLT5leGVjX2ZsYWdzID0gJmViLT5mbGFnc1tlYi0+YnVmZmVyX2NvdW50XTsK
IAllYi0+YnVmZmVyX2NvdW50Kys7CiAKLW91dDoKLQlpOTE1X2dlbV9vYmplY3RfdW5waW5fcGFn
ZXMoc2hhZG93X2JhdGNoX29iaik7CisJdm1hLT5wcml2YXRlID0gcG9vbDsKKwlyZXR1cm4gdm1h
OworCitlcnI6CisJaW50ZWxfZW5naW5lX3Bvb2xfcHV0KHBvb2wpOwogCXJldHVybiB2bWE7CiB9
CiAKQEAgLTI1NzMsNiArMjU4Myw4IEBAIGk5MTVfZ2VtX2RvX2V4ZWNidWZmZXIoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwKIAkgKiB0byBleHBsaWNpdGx5IGhvbGQgYW5vdGhlciByZWZlcmVuY2Ug
aGVyZS4KIAkgKi8KIAllYi5yZXF1ZXN0LT5iYXRjaCA9IGViLmJhdGNoOworCWlmIChlYi5iYXRj
aC0+cHJpdmF0ZSkKKwkJaW50ZWxfZW5naW5lX3Bvb2xfbWFya19hY3RpdmUoZWIuYmF0Y2gtPnBy
aXZhdGUsIGViLnJlcXVlc3QpOwogCiAJdHJhY2VfaTkxNV9yZXF1ZXN0X3F1ZXVlKGViLnJlcXVl
c3QsIGViLmJhdGNoX2ZsYWdzKTsKIAllcnIgPSBlYl9zdWJtaXQoJmViKTsKQEAgLTI1OTcsNiAr
MjYwOSw4IEBAIGk5MTVfZ2VtX2RvX2V4ZWNidWZmZXIoc3RydWN0IGRybV9kZXZpY2UgKmRldiwK
IGVycl9iYXRjaF91bnBpbjoKIAlpZiAoZWIuYmF0Y2hfZmxhZ3MgJiBJOTE1X0RJU1BBVENIX1NF
Q1VSRSkKIAkJaTkxNV92bWFfdW5waW4oZWIuYmF0Y2gpOworCWlmIChlYi5iYXRjaC0+cHJpdmF0
ZSkKKwkJaW50ZWxfZW5naW5lX3Bvb2xfcHV0KGViLmJhdGNoLT5wcml2YXRlKTsKIGVycl92bWE6
CiAJaWYgKGViLmV4ZWMpCiAJCWViX3JlbGVhc2Vfdm1hcygmZWIpOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jCmluZGV4IDkxYzM5OTgzNTFkOS4uMTdjMTdkOWZi
NWM5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jCkBAIC01
Myw3ICs1Myw2IEBAIHZvaWQgaTkxNV9nZW1fb2JqZWN0X2luaXQoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaiwKIAlJTklUX0xJU1RfSEVBRCgmb2JqLT52bWEubGlzdCk7CiAKIAlJTklU
X0xJU1RfSEVBRCgmb2JqLT5sdXRfbGlzdCk7Ci0JSU5JVF9MSVNUX0hFQUQoJm9iai0+YmF0Y2hf
cG9vbF9saW5rKTsKIAogCWluaXRfcmN1X2hlYWQoJm9iai0+cmN1KTsKIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCmluZGV4IGU4N2ZjYTRk
ODE5NC4uZTNiM2ZhMDc0NDA0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX29iamVjdF90eXBlcy5oCkBAIC0xMTksNyArMTE5LDYgQEAgc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgewogCXVuc2lnbmVkIGludCB1c2VyZmF1bHRfY291bnQ7CiAJc3RydWN0IGxp
c3RfaGVhZCB1c2VyZmF1bHRfbGluazsKIAotCXN0cnVjdCBsaXN0X2hlYWQgYmF0Y2hfcG9vbF9s
aW5rOwogCUk5MTVfU0VMRlRFU1RfREVDTEFSRShzdHJ1Y3QgbGlzdF9oZWFkIHN0X2xpbmspOwog
CiAJLyoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKaW5kZXggMzViNzNjMzQ3
ODg3Li5jOTQzM2NkZTRiOWEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9wbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5j
CkBAIC0zMCwxMCArMzAsOCBAQCBzdGF0aWMgdm9pZCBpOTE1X2dlbV9wYXJrKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQogCiAJbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7CiAKLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpZCkgeworCWZv
cl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQogCQljYWxsX2lkbGVfYmFycmllcnMoZW5n
aW5lKTsgLyogY2xlYW51cCBhZnRlciB3ZWRnaW5nICovCi0JCWk5MTVfZ2VtX2JhdGNoX3Bvb2xf
ZmluaSgmZW5naW5lLT5iYXRjaF9wb29sKTsKLQl9CiAKIAlpOTE1X3RpbWVsaW5lc19wYXJrKGk5
MTUpOwogCWk5MTVfdm1hX3BhcmtlZChpOTE1KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZW5naW5lLmgKaW5kZXggOWJiNmZmNzY2ODBlLi41MTcwYjhmZjU1NDEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCkBAIC05LDcgKzksNiBAQAogI2luY2x1ZGUgPGxpbnV4
L3JhbmRvbS5oPgogI2luY2x1ZGUgPGxpbnV4L3NlcWxvY2suaD4KIAotI2luY2x1ZGUgImk5MTVf
Z2VtX2JhdGNoX3Bvb2wuaCIKICNpbmNsdWRlICJpOTE1X3BtdS5oIgogI2luY2x1ZGUgImk5MTVf
cmVnLmgiCiAjaW5jbHVkZSAiaTkxNV9yZXF1ZXN0LmgiCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2VuZ2luZV9jcy5jCmluZGV4IDY1Y2YwOGE4YjIwOS4uYWRhNDFhNDU5OWVmIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwpAQCAtMzAsNiArMzAsNyBA
QAogCiAjaW5jbHVkZSAiaW50ZWxfZW5naW5lLmgiCiAjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3Bt
LmgiCisjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3Bvb2wuaCIKICNpbmNsdWRlICJpbnRlbF9jb250
ZXh0LmgiCiAjaW5jbHVkZSAiaW50ZWxfbHJjLmgiCiAjaW5jbHVkZSAiaW50ZWxfcmVzZXQuaCIK
QEAgLTQ5NSwxMSArNDk2LDYgQEAgaW50IGludGVsX2VuZ2luZXNfaW5pdChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKIAlyZXR1cm4gZXJyOwogfQogCi1zdGF0aWMgdm9pZCBpbnRlbF9l
bmdpbmVfaW5pdF9iYXRjaF9wb29sKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsK
LQlpOTE1X2dlbV9iYXRjaF9wb29sX2luaXQoJmVuZ2luZS0+YmF0Y2hfcG9vbCwgZW5naW5lKTsK
LX0KLQogdm9pZCBpbnRlbF9lbmdpbmVfaW5pdF9leGVjbGlzdHMoc3RydWN0IGludGVsX2VuZ2lu
ZV9jcyAqZW5naW5lKQogewogCXN0cnVjdCBpbnRlbF9lbmdpbmVfZXhlY2xpc3RzICogY29uc3Qg
ZXhlY2xpc3RzID0gJmVuZ2luZS0+ZXhlY2xpc3RzOwpAQCAtNjI1LDEwICs2MjEsMTEgQEAgc3Rh
dGljIGludCBpbnRlbF9lbmdpbmVfc2V0dXBfY29tbW9uKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSkKIAlpbnRlbF9lbmdpbmVfaW5pdF9icmVhZGNydW1icyhlbmdpbmUpOwogCWludGVs
X2VuZ2luZV9pbml0X2V4ZWNsaXN0cyhlbmdpbmUpOwogCWludGVsX2VuZ2luZV9pbml0X2hhbmdj
aGVjayhlbmdpbmUpOwotCWludGVsX2VuZ2luZV9pbml0X2JhdGNoX3Bvb2woZW5naW5lKTsKIAlp
bnRlbF9lbmdpbmVfaW5pdF9jbWRfcGFyc2VyKGVuZ2luZSk7CiAJaW50ZWxfZW5naW5lX2luaXRf
X3BtKGVuZ2luZSk7CiAKKwlpbnRlbF9lbmdpbmVfcG9vbF9pbml0KCZlbmdpbmUtPnBvb2wpOwor
CiAJLyogVXNlIHRoZSB3aG9sZSBkZXZpY2UgYnkgZGVmYXVsdCAqLwogCWVuZ2luZS0+c3NldSA9
CiAJCWludGVsX3NzZXVfZnJvbV9kZXZpY2VfaW5mbygmUlVOVElNRV9JTkZPKGVuZ2luZS0+aTkx
NSktPnNzZXUpOwpAQCAtODc4LDkgKzg3NSw5IEBAIHZvaWQgaW50ZWxfZW5naW5lX2NsZWFudXBf
Y29tbW9uKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAogCWNsZWFudXBfc3RhdHVz
X3BhZ2UoZW5naW5lKTsKIAorCWludGVsX2VuZ2luZV9wb29sX2ZpbmkoJmVuZ2luZS0+cG9vbCk7
CiAJaW50ZWxfZW5naW5lX2ZpbmlfYnJlYWRjcnVtYnMoZW5naW5lKTsKIAlpbnRlbF9lbmdpbmVf
Y2xlYW51cF9jbWRfcGFyc2VyKGVuZ2luZSk7Ci0JaTkxNV9nZW1fYmF0Y2hfcG9vbF9maW5pKCZl
bmdpbmUtPmJhdGNoX3Bvb2wpOwogCiAJaWYgKGVuZ2luZS0+ZGVmYXVsdF9zdGF0ZSkKIAkJaTkx
NV9nZW1fb2JqZWN0X3B1dChlbmdpbmUtPmRlZmF1bHRfc3RhdGUpOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwppbmRleCAyY2UwMGQzZGM0MmEuLmQ1ZDNhYWM1YzI2
OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKQEAgLTcsNiAr
Nyw3IEBACiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKIAogI2luY2x1ZGUgImludGVsX2VuZ2luZS5o
IgorI2luY2x1ZGUgImludGVsX2VuZ2luZV9wb29sLmgiCiAjaW5jbHVkZSAiaW50ZWxfZW5naW5l
X3BtLmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3RfcG0uaCIKIApAQCAtMTE1LDYgKzExNiw3IEBAIHN0
YXRpYyBpbnQgX19lbmdpbmVfcGFyayhzdHJ1Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiAJR0VNX1RS
QUNFKCIlc1xuIiwgZW5naW5lLT5uYW1lKTsKIAogCWludGVsX2VuZ2luZV9kaXNhcm1fYnJlYWRj
cnVtYnMoZW5naW5lKTsKKwlpbnRlbF9lbmdpbmVfcG9vbF9wYXJrKCZlbmdpbmUtPnBvb2wpOwog
CiAJLyogTXVzdCBiZSByZXNldCB1cG9uIGlkbGluZywgb3Igd2UgbWF5IG1pc3MgdGhlIGJ1c3kg
d2FrZXVwLiAqLwogCUdFTV9CVUdfT04oZW5naW5lLT5leGVjbGlzdHMucXVldWVfcHJpb3JpdHlf
aGludCAhPSBJTlRfTUlOKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2VuZ2luZV9wb29sLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVf
cG9vbC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uY2FjY2RmZWZj
NDA5Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5n
aW5lX3Bvb2wuYwpAQCAtMCwwICsxLDE2MyBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBNSVQKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxNC0yMDE4IEludGVsIENvcnBvcmF0aW9u
CisgKi8KKworI2luY2x1ZGUgImdlbS9pOTE1X2dlbV9vYmplY3QuaCIKKworI2luY2x1ZGUgImk5
MTVfZHJ2LmgiCisjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3Bvb2wuaCIKKworc3RhdGljIHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKnRvX2VuZ2luZShzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgKnBv
b2wpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihwb29sLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
LCBwb29sKTsKK30KKworc3RhdGljIHN0cnVjdCBsaXN0X2hlYWQgKgorYnVja2V0X2Zvcl9zaXpl
KHN0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbCAqcG9vbCwgc2l6ZV90IHN6KQoreworCWludCBuOwor
CisJLyoKKwkgKiBDb21wdXRlIGEgcG93ZXItb2YtdHdvIGJ1Y2tldCwgYnV0IHRocm93IGV2ZXJ5
dGhpbmcgZ3JlYXRlciB0aGFuCisJICogMTZLaUIgaW50byB0aGUgc2FtZSBidWNrZXQ6IGkuZS4g
dGhlIHRoZSBidWNrZXRzIGhvbGQgb2JqZWN0cyBvZgorCSAqICgxIHBhZ2UsIDIgcGFnZXMsIDQg
cGFnZXMsIDgrIHBhZ2VzKS4KKwkgKi8KKwluID0gZmxzKHN6ID4+IFBBR0VfU0hJRlQpIC0gMTsK
KwlpZiAobiA+PSBBUlJBWV9TSVpFKHBvb2wtPmNhY2hlX2xpc3QpKQorCQluID0gQVJSQVlfU0la
RShwb29sLT5jYWNoZV9saXN0KSAtIDE7CisKKwlyZXR1cm4gJnBvb2wtPmNhY2hlX2xpc3Rbbl07
Cit9CisKK3N0YXRpYyB2b2lkIG5vZGVfZnJlZShzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2xfbm9k
ZSAqbm9kZSkKK3sKKwlpOTE1X2dlbV9vYmplY3RfcHV0KG5vZGUtPm9iaik7CisJa2ZyZWUobm9k
ZSk7Cit9CisKK3N0YXRpYyBpbnQgcG9vbF9hY3RpdmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYp
Cit7CisJc3RydWN0IGludGVsX2VuZ2luZV9wb29sX25vZGUgKm5vZGUgPQorCQljb250YWluZXJf
b2YocmVmLCB0eXBlb2YoKm5vZGUpLCBhY3RpdmUpOworCisJaWYgKHJlc2VydmF0aW9uX29iamVj
dF90cnlsb2NrKG5vZGUtPm9iai0+cmVzdikpIHsKKwkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9l
eGNsX2ZlbmNlKG5vZGUtPm9iai0+cmVzdiwgTlVMTCk7CisJCXJlc2VydmF0aW9uX29iamVjdF91
bmxvY2sobm9kZS0+b2JqLT5yZXN2KTsKKwl9CisKKwlyZXR1cm4gaTkxNV9nZW1fb2JqZWN0X3Bp
bl9wYWdlcyhub2RlLT5vYmopOworfQorCitfX2k5MTVfYWN0aXZlX2NhbGwKK3N0YXRpYyB2b2lk
IHBvb2xfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKQoreworCXN0cnVjdCBpbnRlbF9l
bmdpbmVfcG9vbF9ub2RlICpub2RlID0KKwkJY29udGFpbmVyX29mKHJlZiwgdHlwZW9mKCpub2Rl
KSwgYWN0aXZlKTsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgKnBvb2wgPSBub2RlLT5wb29s
OworCXN0cnVjdCBsaXN0X2hlYWQgKmxpc3QgPSBidWNrZXRfZm9yX3NpemUocG9vbCwgbm9kZS0+
b2JqLT5iYXNlLnNpemUpOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlHRU1fQlVHX09OKCFp
bnRlbF93YWtlcmVmX2FjdGl2ZSgmdG9fZW5naW5lKHBvb2wpLT53YWtlcmVmKSk7CisKKwlpOTE1
X2dlbV9vYmplY3RfdW5waW5fcGFnZXMobm9kZS0+b2JqKTsKKworCXNwaW5fbG9ja19pcnFzYXZl
KCZwb29sLT5sb2NrLCBmbGFncyk7CisJbGlzdF9hZGQoJm5vZGUtPmxpbmssIGxpc3QpOworCXNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJnBvb2wtPmxvY2ssIGZsYWdzKTsKK30KKworc3RhdGljIHN0
cnVjdCBpbnRlbF9lbmdpbmVfcG9vbF9ub2RlICoKK25vZGVfY3JlYXRlKHN0cnVjdCBpbnRlbF9l
bmdpbmVfcG9vbCAqcG9vbCwgc2l6ZV90IHN6KQoreworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZSA9IHRvX2VuZ2luZShwb29sKTsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2xfbm9k
ZSAqbm9kZTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOworCisJbm9kZSA9IGtt
YWxsb2Moc2l6ZW9mKCpub2RlKSwKKwkJICAgICAgIEdGUF9LRVJORUwgfCBfX0dGUF9SRVRSWV9N
QVlGQUlMIHwgX19HRlBfTk9XQVJOKTsKKwlpZiAoIW5vZGUpCisJCXJldHVybiBFUlJfUFRSKC1F
Tk9NRU0pOworCisJbm9kZS0+cG9vbCA9IHBvb2w7CisJaTkxNV9hY3RpdmVfaW5pdCgmbm9kZS0+
YWN0aXZlLCBwb29sX2FjdGl2ZSwgcG9vbF9yZXRpcmUpOworCisJb2JqID0gaTkxNV9nZW1fb2Jq
ZWN0X2NyZWF0ZV9pbnRlcm5hbChlbmdpbmUtPmk5MTUsIHN6KTsKKwlpZiAoSVNfRVJSKG9iaikp
IHsKKwkJa2ZyZWUobm9kZSk7CisJCXJldHVybiBFUlJfQ0FTVChvYmopOworCX0KKworCW5vZGUt
Pm9iaiA9IG9iajsKKwlyZXR1cm4gbm9kZTsKK30KKworc3RydWN0IGludGVsX2VuZ2luZV9wb29s
X25vZGUgKgoraW50ZWxfZW5naW5lX3Bvb2xfZ2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbCAq
cG9vbCwgc2l6ZV90IHNpemUpCit7CisJc3RydWN0IGludGVsX2VuZ2luZV9wb29sX25vZGUgKm5v
ZGU7CisJc3RydWN0IGxpc3RfaGVhZCAqbGlzdDsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCWlu
dCByZXQ7CisKKwlHRU1fQlVHX09OKCFpbnRlbF93YWtlcmVmX2FjdGl2ZSgmdG9fZW5naW5lKHBv
b2wpLT53YWtlcmVmKSk7CisKKwlzaXplID0gUEFHRV9BTElHTihzaXplKTsKKwlsaXN0ID0gYnVj
a2V0X2Zvcl9zaXplKHBvb2wsIHNpemUpOworCisJc3Bpbl9sb2NrX2lycXNhdmUoJnBvb2wtPmxv
Y2ssIGZsYWdzKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KG5vZGUsIGxpc3QsIGxpbmspIHsKKwkJ
aWYgKG5vZGUtPm9iai0+YmFzZS5zaXplIDwgc2l6ZSkKKwkJCWNvbnRpbnVlOworCQlsaXN0X2Rl
bCgmbm9kZS0+bGluayk7CisJCWJyZWFrOworCX0KKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZw
b29sLT5sb2NrLCBmbGFncyk7CisKKwlpZiAoJm5vZGUtPmxpbmsgPT0gbGlzdCkgeworCQlub2Rl
ID0gbm9kZV9jcmVhdGUocG9vbCwgc2l6ZSk7CisJCWlmIChJU19FUlIobm9kZSkpCisJCQlyZXR1
cm4gbm9kZTsKKwl9CisKKwlyZXQgPSBpOTE1X2FjdGl2ZV9hY3F1aXJlKCZub2RlLT5hY3RpdmUp
OworCWlmIChyZXQpIHsKKwkJbm9kZV9mcmVlKG5vZGUpOworCQlyZXR1cm4gRVJSX1BUUihyZXQp
OworCX0KKworCXJldHVybiBub2RlOworfQorCit2b2lkIGludGVsX2VuZ2luZV9wb29sX2luaXQo
c3RydWN0IGludGVsX2VuZ2luZV9wb29sICpwb29sKQoreworCWludCBuOworCisJc3Bpbl9sb2Nr
X2luaXQoJnBvb2wtPmxvY2spOworCWZvciAobiA9IDA7IG4gPCBBUlJBWV9TSVpFKHBvb2wtPmNh
Y2hlX2xpc3QpOyBuKyspCisJCUlOSVRfTElTVF9IRUFEKCZwb29sLT5jYWNoZV9saXN0W25dKTsK
K30KKwordm9pZCBpbnRlbF9lbmdpbmVfcG9vbF9wYXJrKHN0cnVjdCBpbnRlbF9lbmdpbmVfcG9v
bCAqcG9vbCkKK3sKKwlpbnQgbjsKKworCWZvciAobiA9IDA7IG4gPCBBUlJBWV9TSVpFKHBvb2wt
PmNhY2hlX2xpc3QpOyBuKyspIHsKKwkJc3RydWN0IGxpc3RfaGVhZCAqbGlzdCA9ICZwb29sLT5j
YWNoZV9saXN0W25dOworCQlzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2xfbm9kZSAqbm9kZSwgKm5u
OworCisJCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShub2RlLCBubiwgbGlzdCwgbGluaykKKwkJ
CW5vZGVfZnJlZShub2RlKTsKKworCQlJTklUX0xJU1RfSEVBRChsaXN0KTsKKwl9Cit9CisKK3Zv
aWQgaW50ZWxfZW5naW5lX3Bvb2xfZmluaShzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgKnBvb2wp
Cit7CisJaW50IG47CisKKwlmb3IgKG4gPSAwOyBuIDwgQVJSQVlfU0laRShwb29sLT5jYWNoZV9s
aXN0KTsgbisrKQorCQlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZwb29sLT5jYWNoZV9saXN0W25d
KSk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVf
cG9vbC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2wuaApuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjZiYzY0YmYxOTQ4NQotLS0gL2Rl
di9udWxsCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sLmgK
QEAgLTAsMCArMSwzMyBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQKKyAq
CisgKiBDb3B5cmlnaHQgwqkgMjAxNC0yMDE4IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2lm
bmRlZiBJTlRFTF9FTkdJTkVfUE9PTF9ICisjZGVmaW5lIElOVEVMX0VOR0lORV9QT09MX0gKKwor
I2luY2x1ZGUgImludGVsX2VuZ2luZV9wb29sX3R5cGVzLmgiCisjaW5jbHVkZSAiaTkxNV9yZXF1
ZXN0LmgiCisKK3N0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbF9ub2RlICoKK2ludGVsX2VuZ2luZV9w
b29sX2dldChzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgKnBvb2wsIHNpemVfdCBzaXplKTsKKwor
c3RhdGljIGlubGluZSBpbnQKK2ludGVsX2VuZ2luZV9wb29sX21hcmtfYWN0aXZlKHN0cnVjdCBp
bnRlbF9lbmdpbmVfcG9vbF9ub2RlICpub2RlLAorCQkJICAgICAgc3RydWN0IGk5MTVfcmVxdWVz
dCAqcnEpCit7CisJcmV0dXJuIGk5MTVfYWN0aXZlX3JlZigmbm9kZS0+YWN0aXZlLCBycS0+ZmVu
Y2UuY29udGV4dCwgJnJxLT5mZW5jZSk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZAoraW50ZWxf
ZW5naW5lX3Bvb2xfcHV0KHN0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbF9ub2RlICpub2RlKQorewor
CWk5MTVfYWN0aXZlX3JlbGVhc2UoJm5vZGUtPmFjdGl2ZSk7Cit9CisKK3ZvaWQgaW50ZWxfZW5n
aW5lX3Bvb2xfaW5pdChzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgKnBvb2wpOwordm9pZCBpbnRl
bF9lbmdpbmVfcG9vbF9wYXJrKHN0cnVjdCBpbnRlbF9lbmdpbmVfcG9vbCAqcG9vbCk7Cit2b2lk
IGludGVsX2VuZ2luZV9wb29sX2Zpbmkoc3RydWN0IGludGVsX2VuZ2luZV9wb29sICpwb29sKTsK
KworI2VuZGlmIC8qIElOVEVMX0VOR0lORV9QT09MX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wb29sX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG9vbF90eXBlcy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IDAwMDAwMDAwMDAwMC4uOTllNGU1ZDU0ZmU2Ci0tLSAvZGV2L251bGwKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3Bvb2xfdHlwZXMuaApAQCAtMCwwICsx
LDI5IEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAqIENvcHly
aWdodCDCqSAyMDE0LTIwMTggSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaWZuZGVmIElOVEVM
X0VOR0lORV9QT09MX1RZUEVTX0gKKyNkZWZpbmUgSU5URUxfRU5HSU5FX1BPT0xfVFlQRVNfSAor
CisjaW5jbHVkZSA8bGludXgvbGlzdC5oPgorI2luY2x1ZGUgPGxpbnV4L3NwaW5sb2NrLmg+CisK
KyNpbmNsdWRlICJpOTE1X2FjdGl2ZS5oIgorCitzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdDsK
Kworc3RydWN0IGludGVsX2VuZ2luZV9wb29sIHsKKwlzcGlubG9ja190IGxvY2s7CisJc3RydWN0
IGxpc3RfaGVhZCBjYWNoZV9saXN0WzRdOworfTsKKworc3RydWN0IGludGVsX2VuZ2luZV9wb29s
X25vZGUgeworCXN0cnVjdCBpOTE1X2FjdGl2ZSBhY3RpdmU7CisJc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iajsKKwlzdHJ1Y3QgbGlzdF9oZWFkIGxpbms7CisJc3RydWN0IGludGVsX2Vu
Z2luZV9wb29sICpwb29sOworfTsKKworI2VuZGlmIC8qIElOVEVMX0VOR0lORV9QT09MX1RZUEVT
X0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90
eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKaW5k
ZXggMWNiZTEwYTBmZWM3Li4zMWRhOTY2ZDA2NjkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCkBAIC0xNiwxMSArMTYsMTEgQEAKICNpbmNsdWRlIDxs
aW51eC90eXBlcy5oPgogCiAjaW5jbHVkZSAiaTkxNV9nZW0uaCIKLSNpbmNsdWRlICJpOTE1X2dl
bV9iYXRjaF9wb29sLmgiCiAjaW5jbHVkZSAiaTkxNV9wbXUuaCIKICNpbmNsdWRlICJpOTE1X3By
aW9saXN0X3R5cGVzLmgiCiAjaW5jbHVkZSAiaTkxNV9zZWxmdGVzdC5oIgogI2luY2x1ZGUgImk5
MTVfdGltZWxpbmVfdHlwZXMuaCIKKyNpbmNsdWRlICJpbnRlbF9lbmdpbmVfcG9vbF90eXBlcy5o
IgogI2luY2x1ZGUgImludGVsX3NzZXUuaCIKICNpbmNsdWRlICJpbnRlbF93YWtlcmVmLmgiCiAj
aW5jbHVkZSAiaW50ZWxfd29ya2Fyb3VuZHNfdHlwZXMuaCIKQEAgLTMyMyw3ICszMjMsNyBAQCBz
dHJ1Y3QgaW50ZWxfZW5naW5lX2NzIHsKIAkgKiB3aGVuIHRoZSBjb21tYW5kIHBhcnNlciBpcyBl
bmFibGVkLiBQcmV2ZW50cyB0aGUgY2xpZW50IGZyb20KIAkgKiBtb2RpZnlpbmcgdGhlIGJhdGNo
IGNvbnRlbnRzIGFmdGVyIHNvZnR3YXJlIHBhcnNpbmcuCiAJICovCi0Jc3RydWN0IGk5MTVfZ2Vt
X2JhdGNoX3Bvb2wgYmF0Y2hfcG9vbDsKKwlzdHJ1Y3QgaW50ZWxfZW5naW5lX3Bvb2wgcG9vbDsK
IAogCXN0cnVjdCBpbnRlbF9od19zdGF0dXNfcGFnZSBzdGF0dXNfcGFnZTsKIAlzdHJ1Y3QgaTkx
NV9jdHhfd29ya2Fyb3VuZHMgd2FfY3R4OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwpp
bmRleCA4ZTJhZDMxYTdkZjkuLjk0YjQyZTVhYTE3NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
ZWJ1Z2ZzLmMKQEAgLTI4NywyNyArMjg3LDYgQEAgc3RhdGljIGludCBwZXJfZmlsZV9zdGF0cyhp
bnQgaWQsIHZvaWQgKnB0ciwgdm9pZCAqZGF0YSkKIAkJCSAgIHN0YXRzLmNsb3NlZCk7IFwKIH0g
d2hpbGUgKDApCiAKLXN0YXRpYyB2b2lkIHByaW50X2JhdGNoX3Bvb2xfc3RhdHMoc3RydWN0IHNl
cV9maWxlICptLAotCQkJCSAgIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsK
LQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwotCXN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZTsKLQlzdHJ1Y3QgZmlsZV9zdGF0cyBzdGF0cyA9IHt9OwotCWVudW0gaW50ZWxf
ZW5naW5lX2lkIGlkOwotCWludCBqOwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZGV2X3By
aXYsIGlkKSB7Ci0JCWZvciAoaiA9IDA7IGogPCBBUlJBWV9TSVpFKGVuZ2luZS0+YmF0Y2hfcG9v
bC5jYWNoZV9saXN0KTsgaisrKSB7Ci0JCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwKLQkJCQkJ
ICAgICZlbmdpbmUtPmJhdGNoX3Bvb2wuY2FjaGVfbGlzdFtqXSwKLQkJCQkJICAgIGJhdGNoX3Bv
b2xfbGluaykKLQkJCQlwZXJfZmlsZV9zdGF0cygwLCBvYmosICZzdGF0cyk7Ci0JCX0KLQl9Ci0K
LQlwcmludF9maWxlX3N0YXRzKG0sICJba11iYXRjaCBwb29sIiwgc3RhdHMpOwotfQotCiBzdGF0
aWMgdm9pZCBwcmludF9jb250ZXh0X3N0YXRzKHN0cnVjdCBzZXFfZmlsZSAqbSwKIAkJCQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKQEAgLTM2NSw1OCArMzQ0LDEyIEBAIHN0YXRp
YyBpbnQgaTkxNV9nZW1fb2JqZWN0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRh
KQogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKLQlwcmludF9iYXRjaF9wb29sX3N0YXRzKG0s
IGk5MTUpOwogCXByaW50X2NvbnRleHRfc3RhdHMobSwgaTkxNSk7CiAJbXV0ZXhfdW5sb2NrKCZp
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGk5
MTVfZ2VtX2JhdGNoX3Bvb2xfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCi17
Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnBy
aXZhdGUpOwotCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKLQlzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKLQlpbnQgdG90YWwgPSAwOwotCWludCBy
ZXQsIGo7Ci0KLQlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmRldi0+c3RydWN0X211
dGV4KTsKLQlpZiAocmV0KQotCQlyZXR1cm4gcmV0OwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgZGV2X3ByaXYsIGlkKSB7Ci0JCWZvciAoaiA9IDA7IGogPCBBUlJBWV9TSVpFKGVuZ2luZS0+
YmF0Y2hfcG9vbC5jYWNoZV9saXN0KTsgaisrKSB7Ci0JCQlpbnQgY291bnQ7Ci0KLQkJCWNvdW50
ID0gMDsKLQkJCWxpc3RfZm9yX2VhY2hfZW50cnkob2JqLAotCQkJCQkgICAgJmVuZ2luZS0+YmF0
Y2hfcG9vbC5jYWNoZV9saXN0W2pdLAotCQkJCQkgICAgYmF0Y2hfcG9vbF9saW5rKQotCQkJCWNv
dW50Kys7Ci0JCQlzZXFfcHJpbnRmKG0sICIlcyBjYWNoZVslZF06ICVkIG9iamVjdHNcbiIsCi0J
CQkJICAgZW5naW5lLT5uYW1lLCBqLCBjb3VudCk7Ci0KLQkJCWxpc3RfZm9yX2VhY2hfZW50cnko
b2JqLAotCQkJCQkgICAgJmVuZ2luZS0+YmF0Y2hfcG9vbC5jYWNoZV9saXN0W2pdLAotCQkJCQkg
ICAgYmF0Y2hfcG9vbF9saW5rKSB7Ci0JCQkJc2VxX3B1dHMobSwgIiAgICIpOwotCQkJCWRlc2Ny
aWJlX29iaihtLCBvYmopOwotCQkJCXNlcV9wdXRjKG0sICdcbicpOwotCQkJfQotCi0JCQl0b3Rh
bCArPSBjb3VudDsKLQkJfQotCX0KLQotCXNlcV9wcmludGYobSwgInRvdGFsOiAlZFxuIiwgdG90
YWwpOwotCi0JbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7Ci0KLQlyZXR1cm4gMDsK
LX0KLQogc3RhdGljIHZvaWQgZ2VuOF9kaXNwbGF5X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFf
ZmlsZSAqbSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3Rv
X2k5MTUobS0+cHJpdmF0ZSk7CkBAIC00MzU2LDcgKzQyODksNiBAQCBzdGF0aWMgY29uc3Qgc3Ry
dWN0IGRybV9pbmZvX2xpc3QgaTkxNV9kZWJ1Z2ZzX2xpc3RbXSA9IHsKIAl7Imk5MTVfZ2VtX29i
amVjdHMiLCBpOTE1X2dlbV9vYmplY3RfaW5mbywgMH0sCiAJeyJpOTE1X2dlbV9mZW5jZV9yZWdz
IiwgaTkxNV9nZW1fZmVuY2VfcmVnc19pbmZvLCAwfSwKIAl7Imk5MTVfZ2VtX2ludGVycnVwdCIs
IGk5MTVfaW50ZXJydXB0X2luZm8sIDB9LAotCXsiaTkxNV9nZW1fYmF0Y2hfcG9vbCIsIGk5MTVf
Z2VtX2JhdGNoX3Bvb2xfaW5mbywgMH0sCiAJeyJpOTE1X2d1Y19pbmZvIiwgaTkxNV9ndWNfaW5m
bywgMH0sCiAJeyJpOTE1X2d1Y19sb2FkX3N0YXR1cyIsIGk5MTVfZ3VjX2xvYWRfc3RhdHVzX2lu
Zm8sIDB9LAogCXsiaTkxNV9ndWNfbG9nX2R1bXAiLCBpOTE1X2d1Y19sb2dfZHVtcCwgMH0sCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9iYXRjaF9wb29sLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9iYXRjaF9wb29sLmMKZGVsZXRlZCBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDFiNzU5NWUyYWMyMS4uMDAwMDAwMDAwMDAwCi0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtX2JhdGNoX3Bvb2wuYworKysgL2Rldi9udWxsCkBAIC0xLDEz
MiArMCwwIEBACi0vKgotICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAotICoKLSAqIENv
cHlyaWdodCDCqSAyMDE0LTIwMTggSW50ZWwgQ29ycG9yYXRpb24KLSAqLwotCi0jaW5jbHVkZSAi
aTkxNV9nZW1fYmF0Y2hfcG9vbC5oIgotI2luY2x1ZGUgImk5MTVfZHJ2LmgiCi0KLS8qKgotICog
RE9DOiBiYXRjaCBwb29sCi0gKgotICogSW4gb3JkZXIgdG8gc3VibWl0IGJhdGNoIGJ1ZmZlcnMg
YXMgJ3NlY3VyZScsIHRoZSBzb2Z0d2FyZSBjb21tYW5kIHBhcnNlcgotICogbXVzdCBlbnN1cmUg
dGhhdCBhIGJhdGNoIGJ1ZmZlciBjYW5ub3QgYmUgbW9kaWZpZWQgYWZ0ZXIgcGFyc2luZy4gSXQg
ZG9lcwotICogdGhpcyBieSBjb3B5aW5nIHRoZSB1c2VyIHByb3ZpZGVkIGJhdGNoIGJ1ZmZlciBj
b250ZW50cyB0byBhIGtlcm5lbCBvd25lZAotICogYnVmZmVyIGZyb20gd2hpY2ggdGhlIGhhcmR3
YXJlIHdpbGwgYWN0dWFsbHkgZXhlY3V0ZSwgYW5kIGJ5IGNhcmVmdWxseQotICogbWFuYWdpbmcg
dGhlIGFkZHJlc3Mgc3BhY2UgYmluZGluZ3MgZm9yIHN1Y2ggYnVmZmVycy4KLSAqCi0gKiBUaGUg
YmF0Y2ggcG9vbCBmcmFtZXdvcmsgcHJvdmlkZXMgYSBtZWNoYW5pc20gZm9yIHRoZSBkcml2ZXIg
dG8gbWFuYWdlIGEKLSAqIHNldCBvZiBzY3JhdGNoIGJ1ZmZlcnMgdG8gdXNlIGZvciB0aGlzIHB1
cnBvc2UuIFRoZSBmcmFtZXdvcmsgY2FuIGJlCi0gKiBleHRlbmRlZCB0byBzdXBwb3J0IG90aGVy
IHVzZXMgY2FzZXMgc2hvdWxkIHRoZXkgYXJpc2UuCi0gKi8KLQotLyoqCi0gKiBpOTE1X2dlbV9i
YXRjaF9wb29sX2luaXQoKSAtIGluaXRpYWxpemUgYSBiYXRjaCBidWZmZXIgcG9vbAotICogQHBv
b2w6IHRoZSBiYXRjaCBidWZmZXIgcG9vbAotICogQGVuZ2luZTogdGhlIGFzc29jaWF0ZWQgcmVx
dWVzdCBzdWJtaXNzaW9uIGVuZ2luZQotICovCi12b2lkIGk5MTVfZ2VtX2JhdGNoX3Bvb2xfaW5p
dChzdHJ1Y3QgaTkxNV9nZW1fYmF0Y2hfcG9vbCAqcG9vbCwKLQkJCSAgICAgIHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlpbnQgbjsKLQotCXBvb2wtPmVuZ2luZSA9IGVuZ2lu
ZTsKLQotCWZvciAobiA9IDA7IG4gPCBBUlJBWV9TSVpFKHBvb2wtPmNhY2hlX2xpc3QpOyBuKysp
Ci0JCUlOSVRfTElTVF9IRUFEKCZwb29sLT5jYWNoZV9saXN0W25dKTsKLX0KLQotLyoqCi0gKiBp
OTE1X2dlbV9iYXRjaF9wb29sX2ZpbmkoKSAtIGNsZWFuIHVwIGEgYmF0Y2ggYnVmZmVyIHBvb2wK
LSAqIEBwb29sOiB0aGUgcG9vbCB0byBjbGVhbiB1cAotICoKLSAqIE5vdGU6IENhbGxlcnMgbXVz
dCBob2xkIHRoZSBzdHJ1Y3RfbXV0ZXguCi0gKi8KLXZvaWQgaTkxNV9nZW1fYmF0Y2hfcG9vbF9m
aW5pKHN0cnVjdCBpOTE1X2dlbV9iYXRjaF9wb29sICpwb29sKQotewotCWludCBuOwotCi0JbG9j
a2RlcF9hc3NlcnRfaGVsZCgmcG9vbC0+ZW5naW5lLT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
LQotCWZvciAobiA9IDA7IG4gPCBBUlJBWV9TSVpFKHBvb2wtPmNhY2hlX2xpc3QpOyBuKyspIHsK
LQkJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwgKm5leHQ7Ci0KLQkJbGlzdF9mb3Jf
ZWFjaF9lbnRyeV9zYWZlKG9iaiwgbmV4dCwKLQkJCQkJICZwb29sLT5jYWNoZV9saXN0W25dLAot
CQkJCQkgYmF0Y2hfcG9vbF9saW5rKQotCQkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwotCi0J
CUlOSVRfTElTVF9IRUFEKCZwb29sLT5jYWNoZV9saXN0W25dKTsKLQl9Ci19Ci0KLS8qKgotICog
aTkxNV9nZW1fYmF0Y2hfcG9vbF9nZXQoKSAtIGFsbG9jYXRlIGEgYnVmZmVyIGZyb20gdGhlIHBv
b2wKLSAqIEBwb29sOiB0aGUgYmF0Y2ggYnVmZmVyIHBvb2wKLSAqIEBzaXplOiB0aGUgbWluaW11
bSBkZXNpcmVkIHNpemUgb2YgdGhlIHJldHVybmVkIGJ1ZmZlcgotICoKLSAqIFJldHVybnMgYW4g
aW5hY3RpdmUgYnVmZmVyIGZyb20gQHBvb2wgd2l0aCBhdCBsZWFzdCBAc2l6ZSBieXRlcywKLSAq
IHdpdGggdGhlIHBhZ2VzIHBpbm5lZC4gVGhlIGNhbGxlciBtdXN0IGk5MTVfZ2VtX29iamVjdF91
bnBpbl9wYWdlcygpCi0gKiBvbiB0aGUgcmV0dXJuZWQgb2JqZWN0LgotICoKLSAqIE5vdGU6IENh
bGxlcnMgbXVzdCBob2xkIHRoZSBzdHJ1Y3RfbXV0ZXgKLSAqCi0gKiBSZXR1cm46IHRoZSBidWZm
ZXIgb2JqZWN0IG9yIGFuIGVycm9yIHBvaW50ZXIKLSAqLwotc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKgotaTkxNV9nZW1fYmF0Y2hfcG9vbF9nZXQoc3RydWN0IGk5MTVfZ2VtX2JhdGNoX3Bv
b2wgKnBvb2wsCi0JCQlzaXplX3Qgc2l6ZSkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqOwotCXN0cnVjdCBsaXN0X2hlYWQgKmxpc3Q7Ci0JaW50IG4sIHJldDsKLQotCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJnBvb2wtPmVuZ2luZS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0K
LQkvKiBDb21wdXRlIGEgcG93ZXItb2YtdHdvIGJ1Y2tldCwgYnV0IHRocm93IGV2ZXJ5dGhpbmcg
Z3JlYXRlciB0aGFuCi0JICogMTZLaUIgaW50byB0aGUgc2FtZSBidWNrZXQ6IGkuZS4gdGhlIHRo
ZSBidWNrZXRzIGhvbGQgb2JqZWN0cyBvZgotCSAqICgxIHBhZ2UsIDIgcGFnZXMsIDQgcGFnZXMs
IDgrIHBhZ2VzKS4KLQkgKi8KLQluID0gZmxzKHNpemUgPj4gUEFHRV9TSElGVCkgLSAxOwotCWlm
IChuID49IEFSUkFZX1NJWkUocG9vbC0+Y2FjaGVfbGlzdCkpCi0JCW4gPSBBUlJBWV9TSVpFKHBv
b2wtPmNhY2hlX2xpc3QpIC0gMTsKLQlsaXN0ID0gJnBvb2wtPmNhY2hlX2xpc3Rbbl07Ci0KLQls
aXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgbGlzdCwgYmF0Y2hfcG9vbF9saW5rKSB7Ci0JCXN0cnVj
dCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3YgPSBvYmotPnJlc3Y7Ci0KLQkJLyogVGhlIGJhdGNo
ZXMgYXJlIHN0cmljdGx5IExSVSBvcmRlcmVkICovCi0JCWlmICghcmVzZXJ2YXRpb25fb2JqZWN0
X3Rlc3Rfc2lnbmFsZWRfcmN1KHJlc3YsIHRydWUpKQotCQkJYnJlYWs7Ci0KLQkJLyoKLQkJICog
VGhlIG9iamVjdCBpcyBub3cgaWRsZSwgY2xlYXIgdGhlIGFycmF5IG9mIHNoYXJlZAotCQkgKiBm
ZW5jZXMgYmVmb3JlIHdlIGFkZCBhIG5ldyByZXF1ZXN0LiBBbHRob3VnaCwgd2UKLQkJICogcmVt
YWluIG9uIHRoZSBzYW1lIGVuZ2luZSwgd2UgbWF5IGJlIG9uIGEgZGlmZmVyZW50Ci0JCSAqIHRp
bWVsaW5lIGFuZCBzbyBtYXkgY29udGludWFsbHkgZ3JvdyB0aGUgYXJyYXksCi0JCSAqIHRyYXBw
aW5nIGEgcmVmZXJlbmNlIHRvIGFsbCB0aGUgb2xkIGZlbmNlcywgcmF0aGVyCi0JCSAqIHRoYW4g
cmVwbGFjZSB0aGUgZXhpc3RpbmcgZmVuY2UuCi0JCSAqLwotCQlpZiAocmN1X2FjY2Vzc19wb2lu
dGVyKHJlc3YtPmZlbmNlKSkgewotCQkJcmVzZXJ2YXRpb25fb2JqZWN0X2xvY2socmVzdiwgTlVM
TCk7Ci0JCQlyZXNlcnZhdGlvbl9vYmplY3RfYWRkX2V4Y2xfZmVuY2UocmVzdiwgTlVMTCk7Ci0J
CQlyZXNlcnZhdGlvbl9vYmplY3RfdW5sb2NrKHJlc3YpOwotCQl9Ci0KLQkJaWYgKG9iai0+YmFz
ZS5zaXplID49IHNpemUpCi0JCQlnb3RvIGZvdW5kOwotCX0KLQotCW9iaiA9IGk5MTVfZ2VtX29i
amVjdF9jcmVhdGVfaW50ZXJuYWwocG9vbC0+ZW5naW5lLT5pOTE1LCBzaXplKTsKLQlpZiAoSVNf
RVJSKG9iaikpCi0JCXJldHVybiBvYmo7Ci0KLWZvdW5kOgotCXJldCA9IGk5MTVfZ2VtX29iamVj
dF9waW5fcGFnZXMob2JqKTsKLQlpZiAocmV0KQotCQlyZXR1cm4gRVJSX1BUUihyZXQpOwotCi0J
bGlzdF9tb3ZlX3RhaWwoJm9iai0+YmF0Y2hfcG9vbF9saW5rLCBsaXN0KTsKLQlyZXR1cm4gb2Jq
OwotfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fYmF0Y2hfcG9v
bC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fYmF0Y2hfcG9vbC5oCmRlbGV0ZWQg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCBmZWVlZWVhYTU0ZDguLjAwMDAwMDAwMDAwMAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9iYXRjaF9wb29sLmgKKysrIC9kZXYvbnVsbApA
QCAtMSwyNiArMCwwIEBACi0vKgotICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAotICoK
LSAqIENvcHlyaWdodCDCqSAyMDE0LTIwMTggSW50ZWwgQ29ycG9yYXRpb24KLSAqLwotCi0jaWZu
ZGVmIEk5MTVfR0VNX0JBVENIX1BPT0xfSAotI2RlZmluZSBJOTE1X0dFTV9CQVRDSF9QT09MX0gK
LQotI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Ci0KLXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
Owotc3RydWN0IGludGVsX2VuZ2luZV9jczsKLQotc3RydWN0IGk5MTVfZ2VtX2JhdGNoX3Bvb2wg
ewotCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQlzdHJ1Y3QgbGlzdF9oZWFkIGNh
Y2hlX2xpc3RbNF07Ci19OwotCi12b2lkIGk5MTVfZ2VtX2JhdGNoX3Bvb2xfaW5pdChzdHJ1Y3Qg
aTkxNV9nZW1fYmF0Y2hfcG9vbCAqcG9vbCwKLQkJCSAgICAgIHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSk7Ci12b2lkIGk5MTVfZ2VtX2JhdGNoX3Bvb2xfZmluaShzdHJ1Y3QgaTkxNV9n
ZW1fYmF0Y2hfcG9vbCAqcG9vbCk7Ci1zdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqCi1pOTE1
X2dlbV9iYXRjaF9wb29sX2dldChzdHJ1Y3QgaTkxNV9nZW1fYmF0Y2hfcG9vbCAqcG9vbCwgc2l6
ZV90IHNpemUpOwotCi0jZW5kaWYgLyogSTkxNV9HRU1fQkFUQ0hfUE9PTF9IICovCi0tIAoyLjIw
LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVs
LWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

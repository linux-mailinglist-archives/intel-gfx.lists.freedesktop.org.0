Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 648023AD67
	for <lists+intel-gfx@lfdr.de>; Mon, 10 Jun 2019 05:05:00 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C1B50890AB;
	Mon, 10 Jun 2019 03:04:58 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F3C5F890B0
 for <intel-gfx@lists.freedesktop.org>; Mon, 10 Jun 2019 03:04:56 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16847195-1500050 
 for multiple; Mon, 10 Jun 2019 04:04:18 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 10 Jun 2019 04:04:16 +0100
Message-Id: <20190610030416.4471-4-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190610030416.4471-1-chris@chris-wilson.co.uk>
References: <20190610030416.4471-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 4/4] drm/i915: Promote i915->mm.obj_lock to be
 irqsafe
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIGludGVudCBpcyB0byBiZSB1cGRhdGUgdGhlIG1tLmxpc3RzIGZyb20gaW5zaWRlIGEgaXJx
c29mZiBzZWN0aW9uCihlLmcuIGZyb20gYSBzb2Z0aXJxIHJjdSB3b3JrcXVldWUpLCBlcmdvIHdl
IG5lZWQgdG8gbWFrZSB0aGUgbW0ub2JqX2xvY2sKaXJxc2FmZS4KCkZpeGVzOiAzYjRmYTk2NDBj
Y2QgKCJkcm0vaTkxNTogVHJhY2sgdGhlIHB1cmdlYWJsZSBvYmplY3RzIG9uIGEgc2VwYXJhdGUg
ZXZpY3Rpb24gbGlzdCIpClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMt
d2lsc29uLmNvLnVrPgpDYzogSm9vbmFzIExhaHRpbmVuIDxqb29uYXMubGFodGluZW5AbGludXgu
aW50ZWwuY29tPgpDYzogTWF0dGhldyBBdWxkIDxtYXR0aGV3LndpbGxpYW0uYXVsZEBnbWFpbC5j
b20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jICAgfCAg
OCArKysrKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jICAg
fCAxMiArKysrKysrKy0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdl
cy5jICAgIHwgMTMgKysrKysrKysrLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX3Nocmlua2VyLmMgfCAxNCArKysrKysrKy0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW0uYyAgICAgICAgICAgICAgfCAgOCArKysrKystLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV92bWEuYyAgICAgICAgICAgICAgfCAgNyArKysrKy0tCiA2IGZpbGVzIGNoYW5nZWQs
IDQyIGluc2VydGlvbnMoKyksIDIwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9kb21haW4uYwppbmRleCA2MTE1MTA5YTI4MTAuLmJkMTgwZWY0NmFlYiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9kb21haW4uYwpAQCAtNDc2LDEw
ICs0NzYsMTQgQEAgc3RhdGljIHZvaWQgaTkxNV9nZW1fb2JqZWN0X2J1bXBfaW5hY3RpdmVfZ2d0
dChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCW11dGV4X3VubG9jaygmaTkxNS0+
Z2d0dC52bS5tdXRleCk7CiAKIAlpZiAoaTkxNV9nZW1fb2JqZWN0X2lzX3Nocmlua2FibGUob2Jq
KSkgewotCQlzcGluX2xvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKKwkJdW5zaWduZWQgbG9uZyBm
bGFnczsKKworCQlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsK
KwogCQlpZiAob2JqLT5tbS5tYWR2ID09IEk5MTVfTUFEVl9XSUxMTkVFRCkKIAkJCWxpc3RfbW92
ZV90YWlsKCZvYmotPm1tLmxpbmssICZpOTE1LT5tbS5zaHJpbmtfbGlzdCk7Ci0JCXNwaW5fdW5s
b2NrKCZpOTE1LT5tbS5vYmpfbG9jayk7CisKKwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkx
NS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKIAl9CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9vYmplY3QuYwppbmRleCA3YTA3ZTcyNmVjODMuLjAzNzI1Y2E0MmNjNyAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYwpAQCAtMjA3LDkgKzIw
NywxMSBAQCBzdGF0aWMgdm9pZCBfX2k5MTVfZ2VtX2ZyZWVfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwKIAkJICovCiAJCWlmIChpOTE1X2dlbV9vYmplY3RfaGFzX3BhZ2Vz
KG9iaikgJiYKIAkJICAgIGk5MTVfZ2VtX29iamVjdF9pc19zaHJpbmthYmxlKG9iaikpIHsKLQkJ
CXNwaW5fbG9jaygmaTkxNS0+bW0ub2JqX2xvY2spOworCQkJdW5zaWduZWQgbG9uZyBmbGFnczsK
KworCQkJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPm1tLm9ial9sb2NrLCBmbGFncyk7CiAJCQls
aXN0X2RlbF9pbml0KCZvYmotPm1tLmxpbmspOwotCQkJc3Bpbl91bmxvY2soJmk5MTUtPm1tLm9i
al9sb2NrKTsKKwkJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPm1tLm9ial9sb2NrLCBm
bGFncyk7CiAJCX0KIAogCQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwpA
QCAtMzMxLDkgKzMzMywxMSBAQCB2b2lkIGk5MTVfZ2VtX2ZyZWVfb2JqZWN0KHN0cnVjdCBkcm1f
Z2VtX29iamVjdCAqZ2VtX29iaikKIAogCQlpZiAoaTkxNV9nZW1fb2JqZWN0X2hhc19wYWdlcyhv
YmopICYmCiAJCSAgICBpOTE1X2dlbV9vYmplY3RfaXNfc2hyaW5rYWJsZShvYmopKSB7Ci0JCQlz
cGluX2xvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKKwkJCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisK
KwkJCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwogCQkJbGlz
dF9tb3ZlX3RhaWwoJm9iai0+bW0ubGluaywgJmk5MTUtPm1tLnB1cmdlX2xpc3QpOwotCQkJc3Bp
bl91bmxvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKKwkJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUo
Jmk5MTUtPm1tLm9ial9sb2NrLCBmbGFncyk7CiAJCX0KIAl9CiAKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMKaW5kZXggNzg2OGRkNDhkOTMxLi5iMzZhZDI2OWY0ZWEg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jCkBAIC01OCw4ICs1
OCw5IEBAIHZvaWQgX19pOTE1X2dlbV9vYmplY3Rfc2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmosCiAKIAlpZiAoaTkxNV9nZW1fb2JqZWN0X2lzX3Nocmlua2FibGUob2Jq
KSkgewogCQlzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0OworCQl1bnNpZ25lZCBsb25nIGZsYWdzOwog
Ci0JCXNwaW5fbG9jaygmaTkxNS0+bW0ub2JqX2xvY2spOworCQlzcGluX2xvY2tfaXJxc2F2ZSgm
aTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKIAogCQlpOTE1LT5tbS5zaHJpbmtfY291bnQrKzsK
IAkJaTkxNS0+bW0uc2hyaW5rX21lbW9yeSArPSBvYmotPmJhc2Uuc2l6ZTsKQEAgLTcwLDcgKzcx
LDcgQEAgdm9pZCBfX2k5MTVfZ2VtX29iamVjdF9zZXRfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaiwKIAkJCWxpc3QgPSAmaTkxNS0+bW0uc2hyaW5rX2xpc3Q7CiAJCWxpc3Rf
YWRkX3RhaWwoJm9iai0+bW0ubGluaywgbGlzdCk7CiAKLQkJc3Bpbl91bmxvY2soJmk5MTUtPm1t
Lm9ial9sb2NrKTsKKwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+bW0ub2JqX2xvY2ss
IGZsYWdzKTsKIAl9CiB9CiAKQEAgLTE2MCwxMSArMTYxLDE1IEBAIF9faTkxNV9nZW1fb2JqZWN0
X3Vuc2V0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJCXJldHVybiBw
YWdlczsKIAogCWlmIChpOTE1X2dlbV9vYmplY3RfaXNfc2hyaW5rYWJsZShvYmopKSB7Ci0JCXNw
aW5fbG9jaygmaTkxNS0+bW0ub2JqX2xvY2spOworCQl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJ
CXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOworCiAJCWxpc3Rf
ZGVsKCZvYmotPm1tLmxpbmspOwogCQlpOTE1LT5tbS5zaHJpbmtfY291bnQtLTsKIAkJaTkxNS0+
bW0uc2hyaW5rX21lbW9yeSAtPSBvYmotPmJhc2Uuc2l6ZTsKLQkJc3Bpbl91bmxvY2soJmk5MTUt
Pm1tLm9ial9sb2NrKTsKKworCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5tbS5vYmpf
bG9jaywgZmxhZ3MpOwogCX0KIAogCWlmIChvYmotPm1tLm1hcHBpbmcpIHsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJpbmtlci5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Nocmlua2VyLmMKaW5kZXggMWU3ZjQ4ZGI3YjNlLi44
OGU2M2FmZDFkM2QgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9zaHJpbmtlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJp
bmtlci5jCkBAIC0yMDksNiArMjA5LDcgQEAgaTkxNV9nZW1fc2hyaW5rKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAogCWZvciAocGhhc2UgPSBwaGFzZXM7IHBoYXNlLT5saXN0OyBwaGFz
ZSsrKSB7CiAJCXN0cnVjdCBsaXN0X2hlYWQgc3RpbGxfaW5fbGlzdDsKIAkJc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iajsKKwkJdW5zaWduZWQgbG9uZyBmbGFnczsKIAogCQlpZiAoKGZs
YWdzICYgcGhhc2UtPmJpdCkgPT0gMCkKIAkJCWNvbnRpbnVlOwpAQCAtMjIyLDcgKzIyMyw3IEBA
IGk5MTVfZ2VtX3NocmluayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJICogdG8g
YmUgYWJsZSB0byBzaHJpbmsgdGhlaXIgcGFnZXMsIHNvIHRoZXkgcmVtYWluIG9uCiAJCSAqIHRo
ZSB1bmJvdW5kL2JvdW5kIGxpc3QgdW50aWwgYWN0dWFsbHkgZnJlZWQuCiAJCSAqLwotCQlzcGlu
X2xvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKKwkJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPm1t
Lm9ial9sb2NrLCBmbGFncyk7CiAJCXdoaWxlIChjb3VudCA8IHRhcmdldCAmJgogCQkgICAgICAg
KG9iaiA9IGxpc3RfZmlyc3RfZW50cnlfb3JfbnVsbChwaGFzZS0+bGlzdCwKIAkJCQkJCSAgICAg
ICB0eXBlb2YoKm9iaiksCkBAIC0yNDUsNyArMjQ2LDcgQEAgaTkxNV9nZW1fc2hyaW5rKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJaWYgKCFjYW5fcmVsZWFzZV9wYWdlcyhvYmop
KQogCQkJCWNvbnRpbnVlOwogCi0JCQlzcGluX3VubG9jaygmaTkxNS0+bW0ub2JqX2xvY2spOwor
CQkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKIAog
CQkJaWYgKHVuc2FmZV9kcm9wX3BhZ2VzKG9iaikpIHsKIAkJCQkvKiBNYXkgYXJyaXZlIGZyb20g
Z2V0X3BhZ2VzIG9uIGFub3RoZXIgYm8gKi8KQEAgLTI1OSwxMCArMjYwLDEwIEBAIGk5MTVfZ2Vt
X3NocmluayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCX0KIAkJCXNjYW5uZWQg
Kz0gb2JqLT5iYXNlLnNpemUgPj4gUEFHRV9TSElGVDsKIAotCQkJc3Bpbl9sb2NrKCZpOTE1LT5t
bS5vYmpfbG9jayk7CisJCQlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZs
YWdzKTsKIAkJfQogCQlsaXN0X3NwbGljZV90YWlsKCZzdGlsbF9pbl9saXN0LCBwaGFzZS0+bGlz
dCk7Ci0JCXNwaW5fdW5sb2NrKCZpOTE1LT5tbS5vYmpfbG9jayk7CisJCXNwaW5fdW5sb2NrX2ly
cXJlc3RvcmUoJmk5MTUtPm1tLm9ial9sb2NrLCBmbGFncyk7CiAJfQogCiAJaWYgKGZsYWdzICYg
STkxNV9TSFJJTktfQk9VTkQpCkBAIC0zODEsNiArMzgyLDcgQEAgaTkxNV9nZW1fc2hyaW5rZXJf
b29tKHN0cnVjdCBub3RpZmllcl9ibG9jayAqbmIsIHVuc2lnbmVkIGxvbmcgZXZlbnQsIHZvaWQg
KnB0cikKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwogCXVuc2lnbmVkIGxvbmcg
dW5ldmljdGFibGUsIGF2YWlsYWJsZSwgZnJlZWRfcGFnZXM7CiAJaW50ZWxfd2FrZXJlZl90IHdh
a2VyZWY7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKIAogCWZyZWVkX3BhZ2VzID0gMDsKIAl3aXRo
X2ludGVsX3J1bnRpbWVfcG0oaTkxNSwgd2FrZXJlZikKQEAgLTM5NCwxNCArMzk2LDE0IEBAIGk5
MTVfZ2VtX3Nocmlua2VyX29vbShzdHJ1Y3Qgbm90aWZpZXJfYmxvY2sgKm5iLCB1bnNpZ25lZCBs
b25nIGV2ZW50LCB2b2lkICpwdHIpCiAJICogYmVpbmcgcG9pbnRlZCB0byBieSBoYXJkd2FyZS4K
IAkgKi8KIAlhdmFpbGFibGUgPSB1bmV2aWN0YWJsZSA9IDA7Ci0Jc3Bpbl9sb2NrKCZpOTE1LT5t
bS5vYmpfbG9jayk7CisJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPm1tLm9ial9sb2NrLCBmbGFn
cyk7CiAJbGlzdF9mb3JfZWFjaF9lbnRyeShvYmosICZpOTE1LT5tbS5zaHJpbmtfbGlzdCwgbW0u
bGluaykgewogCQlpZiAoIWNhbl9yZWxlYXNlX3BhZ2VzKG9iaikpCiAJCQl1bmV2aWN0YWJsZSAr
PSBvYmotPmJhc2Uuc2l6ZSA+PiBQQUdFX1NISUZUOwogCQllbHNlCiAJCQlhdmFpbGFibGUgKz0g
b2JqLT5iYXNlLnNpemUgPj4gUEFHRV9TSElGVDsKIAl9Ci0Jc3Bpbl91bmxvY2soJmk5MTUtPm1t
Lm9ial9sb2NrKTsKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9jaywg
ZmxhZ3MpOwogCiAJaWYgKGZyZWVkX3BhZ2VzIHx8IGF2YWlsYWJsZSkKIAkJcHJfaW5mbygiUHVy
Z2luZyBHUFUgbWVtb3J5LCAlbHUgcGFnZXMgZnJlZWQsICIKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5j
CmluZGV4IDBhZWNhNDJjYjA2MS4uMjVmNmEyYzMxMzllIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2Vt
LmMKQEAgLTExNDAsMTMgKzExNDAsMTcgQEAgaTkxNV9nZW1fbWFkdmlzZV9pb2N0bChzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQlzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0Owog
CiAJCWlmIChpOTE1X2dlbV9vYmplY3RfaXNfc2hyaW5rYWJsZShvYmopKSB7Ci0JCQlzcGluX2xv
Y2soJmk5MTUtPm1tLm9ial9sb2NrKTsKKwkJCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwkJCXNw
aW5fbG9ja19pcnFzYXZlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOworCiAJCQlpZiAob2Jq
LT5tbS5tYWR2ICE9IEk5MTVfTUFEVl9XSUxMTkVFRCkKIAkJCQlsaXN0ID0gJmk5MTUtPm1tLnB1
cmdlX2xpc3Q7CiAJCQllbHNlCiAJCQkJbGlzdCA9ICZpOTE1LT5tbS5zaHJpbmtfbGlzdDsKIAkJ
CWxpc3RfbW92ZV90YWlsKCZvYmotPm1tLmxpbmssIGxpc3QpOwotCQkJc3Bpbl91bmxvY2soJmk5
MTUtPm1tLm9ial9sb2NrKTsKKworCQkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+bW0u
b2JqX2xvY2ssIGZsYWdzKTsKIAkJfQogCX0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV92bWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKaW5kZXgg
YTNjYjA4ZjYwMmY5Li41YzA3NWNkNmY5ZmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfdm1hLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwpAQCAt
ODAsMTAgKzgwLDEzIEBAIHN0YXRpYyB2b2lkIHZtYV9wcmludF9hbGxvY2F0b3Ioc3RydWN0IGk5
MTVfdm1hICp2bWEsIGNvbnN0IGNoYXIgKnJlYXNvbikKIHN0YXRpYyB2b2lkIG9ial9idW1wX21y
dShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewogCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsKKwl1bnNpZ25lZCBsb25nIGZs
YWdzOworCisJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPm1tLm9ial9sb2NrLCBmbGFncyk7CiAK
LQlzcGluX2xvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKIAlsaXN0X21vdmVfdGFpbCgmb2JqLT5t
bS5saW5rLCAmaTkxNS0+bW0uc2hyaW5rX2xpc3QpOwotCXNwaW5fdW5sb2NrKCZpOTE1LT5tbS5v
YmpfbG9jayk7CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9jaywg
ZmxhZ3MpOwogCiAJb2JqLT5tbS5kaXJ0eSA9IHRydWU7IC8qIGJlIHBhcmFub2lkICAqLwogfQot
LSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

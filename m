Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0940087329
	for <lists+intel-gfx@lfdr.de>; Fri,  9 Aug 2019 09:37:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3B5A66E1E0;
	Fri,  9 Aug 2019 07:37:33 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 651EB6E1E0
 for <intel-gfx@lists.freedesktop.org>; Fri,  9 Aug 2019 07:37:31 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17938702-1500050 
 for multiple; Fri, 09 Aug 2019 08:37:24 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri,  9 Aug 2019 08:37:23 +0100
Message-Id: <20190809073723.6593-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0.rc1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915/execlists: Backtrack along timeline
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QWZ0ZXIgYSBwcmVlbXB0LXRvLWJ1c3ksIHdlIG1heSBmaW5kIGFuIGFjdGl2ZSByZXF1ZXN0IHRo
YXQgaXMgY2F1Z2h0CmJldHdlZW4gZXhlY3V0aW9uIHN0YXRlcy4gV2FsayBiYWNrIGFsb25nIHRo
ZSB0aW1lbGluZSBpbnN0ZWFkIG9mIHRoZQpleGVjdXRpb24gbGlzdCB0byBiZSBzYWZlLgoKWyAg
MTA2LjQxNzU0MV0gaTkxNSAwMDAwOjAwOjAyLjA6IFJlc2V0dGluZyByY3MwIGZvciBwcmVlbXB0
aW9uIHRpbWUgb3V0ClsgIDEwNi40MTc2NTldID09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpbICAxMDYuNDE4MDQxXSBCVUc6
IEtBU0FOOiBzbGFiLW91dC1vZi1ib3VuZHMgaW4gX19leGVjbGlzdHNfcmVzZXQrMHgyZjIvMHg0
NDAgW2k5MTVdClsgIDEwNi40MTgxMjNdIFJlYWQgb2Ygc2l6ZSA4IGF0IGFkZHIgZmZmZjg4ODcw
MzUwNmIzMCBieSB0YXNrIHN3YXBwZXIvMS8wClsgIDEwNi40MTgxOTRdClsgIDEwNi40MTgyNjdd
IENQVTogMSBQSUQ6IDAgQ29tbTogc3dhcHBlci8xIFRhaW50ZWQ6IEcgICAgIFUgICAgICAgICAg
ICA1LjMuMC1yYzMrICM1ClsgIDEwNi40MTgzNDRdIEhhcmR3YXJlIG5hbWU6IEludGVsIENvcnBv
cmF0aW9uIE5VQzdpNUJOSy9OVUM3aTVCTkIsIEJJT1MgQk5LQkwzNTcuODZBLjAwNTIuMjAxNy4w
OTE4LjEzNDYgMDkvMTgvMjAxNwpbICAxMDYuNDE4NDM0XSBDYWxsIFRyYWNlOgpbICAxMDYuNDE4
NTA4XSAgPElSUT4KWyAgMTA2LjQxODU4NV0gIGR1bXBfc3RhY2srMHg1Yi8weDkwClsgIDEwNi40
MTg5NDFdICA/IF9fZXhlY2xpc3RzX3Jlc2V0KzB4MmYyLzB4NDQwIFtpOTE1XQpbICAxMDYuNDE5
MDIyXSAgcHJpbnRfYWRkcmVzc19kZXNjcmlwdGlvbisweDY3LzB4MzJkClsgIDEwNi40MTkzNzZd
ICA/IF9fZXhlY2xpc3RzX3Jlc2V0KzB4MmYyLzB4NDQwIFtpOTE1XQpbICAxMDYuNDE5NzMxXSAg
PyBfX2V4ZWNsaXN0c19yZXNldCsweDJmMi8weDQ0MCBbaTkxNV0KWyAgMTA2LjQxOTgxMF0gIF9f
a2FzYW5fcmVwb3J0LmNvbGQuNisweDFhLzB4M2MKWyAgMTA2LjQxOTg4OF0gID8gX190cmFjZV9i
cHJpbnRrKzB4YzAvMHhkMApbICAxMDYuNDIwMjM5XSAgPyBfX2V4ZWNsaXN0c19yZXNldCsweDJm
Mi8weDQ0MCBbaTkxNV0KWyAgMTA2LjQyMDMxOF0gIGNoZWNrX21lbW9yeV9yZWdpb24rMHgxNDQv
MHgxYzAKWyAgMTA2LjQyMDY3MV0gIF9fZXhlY2xpc3RzX3Jlc2V0KzB4MmYyLzB4NDQwIFtpOTE1
XQpbICAxMDYuNDIxMDI5XSAgZXhlY2xpc3RzX3Jlc2V0KzB4M2QvMHg1MCBbaTkxNV0KWyAgMTA2
LjQyMTM4N10gIGludGVsX2VuZ2luZV9yZXNldCsweDIwMy8weDNhMCBbaTkxNV0KWyAgMTA2LjQy
MTc0NF0gID8gaWd0X3Jlc2V0X25vcCsweDJiMC8weDJiMCBbaTkxNV0KWyAgMTA2LjQyMTgyNV0g
ID8gX3Jhd19zcGluX3RyeWxvY2tfYmgrMHhlMC8weGUwClsgIDEwNi40MjE5MDFdICA/IHJjdV9j
b3JlKzB4MWI5LzB4NmEwClsgIDEwNi40MjIyNTFdICBwcmVlbXB0X3Jlc2V0KzB4OWEvMHhmMCBb
aTkxNV0KWyAgMTA2LjQyMjMzM10gIHRhc2tsZXRfYWN0aW9uX2NvbW1vbi5pc3JhLjE1KzB4YzAv
MHgxZTAKWyAgMTA2LjQyMjY4NV0gID8gZXhlY2xpc3RzX3N1Ym1pdF9yZXF1ZXN0KzB4MjAwLzB4
MjAwIFtpOTE1XQpbICAxMDYuNDIyNzY0XSAgX19kb19zb2Z0aXJxKzB4MTA2LzB4M2NmClsgIDEw
Ni40MjI4NDBdICBpcnFfZXhpdCsweGRjLzB4ZjAKWyAgMTA2LjQyMjkxNF0gIHNtcF9hcGljX3Rp
bWVyX2ludGVycnVwdCsweDgxLzB4MWMwClsgIDEwNi40MjI5ODhdICBhcGljX3RpbWVyX2ludGVy
cnVwdCsweGYvMHgyMApbICAxMDYuNDIzMDU5XSAgPC9JUlE+ClsgIDEwNi40MjMxNDRdIFJJUDog
MDAxMDpjcHVpZGxlX2VudGVyX3N0YXRlKzB4YzMvMHg2MjAKWyAgMTA2LjQyMzIyMl0gQ29kZTog
MjQgMGYgMWYgNDQgMDAgMDAgMzEgZmYgZTggZGEgODcgOWMgZmYgODAgN2MgMjQgMTAgMDAgNzQg
MTIgOWMgNTggZjYgYzQgMDIgMGYgODUgMzMgMDUgMDAgMDAgMzEgZmYgZTggYzEgNzcgYTMgZmYg
ZmIgNDUgODUgZTQgPDBmPiA4OSBiZiAwMiAwMCAwMCA0OCA4ZCA3ZCAxMCBlOCA0ZSA0NSBiOSBm
ZiBjNyA0NSAxMCAwMCAwMCAwMCAwMApbICAxMDYuNDIzMzExXSBSU1A6IDAwMTg6ZmZmZjg4ODgx
YzMwZmRhOCBFRkxBR1M6IDAwMDAwMjAyIE9SSUdfUkFYOiBmZmZmZmZmZmZmZmZmZjEzClsgIDEw
Ni40MjMzOTBdIFJBWDogMDAwMDAwMDAwMDAwMDAwMCBSQlg6IGZmZmZmZmZmODI1YjRjODAgUkNY
OiBmZmZmZmZmZjgxMGM4YTAwClsgIDEwNi40MjM0NjVdIFJEWDogZGZmZmZjMDAwMDAwMDAwMCBS
U0k6IDAwMDAwMDAwMzlmODk2MjAgUkRJOiBmZmZmODg4ODFmNmIwMGE4ClsgIDEwNi40MjM1NDBd
IFJCUDogZmZmZjg4ODgxZjZiNWJmOCBSMDg6IDAwMDAwMDAwMDAwMDAwMDIgUjA5OiAwMDAwMDAw
MDAwMDJlZDgwClsgIDEwNi40MjM2MTZdIFIxMDogMDAwMDAwM2ZkZDk1NjE0NiBSMTE6IGZmZmY4
ODg4MWMyZDFlNDcgUjEyOiAwMDAwMDAwMDAwMDAwMDA4ClsgIDEwNi40MjM2OTFdIFIxMzogMDAw
MDAwMDAwMDAwMDAwOCBSMTQ6IGZmZmZmZmZmODI1YjRmODAgUjE1OiBmZmZmZmZmZjgyNWI0ZmMw
ClsgIDEwNi40MjM3NzJdICA/IHNjaGVkX2lkbGVfc2V0X3N0YXRlKzB4MjAvMHgzMApbICAxMDYu
NDIzODUxXSAgPyBjcHVpZGxlX2VudGVyX3N0YXRlKzB4YTYvMHg2MjAKWyAgMTA2LjQyMzg3NF0g
ID8gdGlja19ub2h6X2lkbGVfc3RvcF90aWNrKzB4MWQxLzB4M2YwClsgIDEwNi40MjM4OTZdICBj
cHVpZGxlX2VudGVyKzB4MzcvMHg2MApbICAxMDYuNDIzOTE5XSAgZG9faWRsZSsweDI0Ni8weDI4
MApbICAxMDYuNDIzOTQxXSAgPyBhcmNoX2NwdV9pZGxlX2V4aXQrMHgzMC8weDMwClsgIDEwNi40
MjM5NjRdICA/IF9fd2FrZV91cF9jb21tb24rMHg0Ni8weDI0MApbICAxMDYuNDIzOTg2XSAgY3B1
X3N0YXJ0dXBfZW50cnkrMHgxNC8weDIwClsgIDEwNi40MjQwMDldICBzdGFydF9zZWNvbmRhcnkr
MHgxYjAvMHgyMDAKWyAgMTA2LjQyNDAzMV0gID8gc2V0X2NwdV9zaWJsaW5nX21hcCsweDk5MC8w
eDk5MApbICAxMDYuNDI0MDU0XSAgc2Vjb25kYXJ5X3N0YXJ0dXBfNjQrMHhhNC8weGIwClsgIDEw
Ni40MjQwNzVdClsgIDEwNi40MjQwOTZdIEFsbG9jYXRlZCBieSB0YXNrIDYyNjoKWyAgMTA2LjQy
NDExOV0gIHNhdmVfc3RhY2srMHgxOS8weDgwClsgIDEwNi40MjQxNDNdICBfX2thc2FuX2ttYWxs
b2MuY29uc3Rwcm9wLjcrMHhjMS8weGQwClsgIDEwNi40MjQxNjVdICBrbWVtX2NhY2hlX2FsbG9j
KzB4YjIvMHgxZDAKWyAgMTA2LjQyNDI3N10gIGk5MTVfc2NoZWRfbG9va3VwX3ByaW9saXN0KzB4
MWFiLzB4MzIwIFtpOTE1XQpbICAxMDYuNDI0Mzg1XSAgZXhlY2xpc3RzX3N1Ym1pdF9yZXF1ZXN0
KzB4NzMvMHgyMDAgW2k5MTVdClsgIDEwNi40MjQ0OThdICBzdWJtaXRfbm90aWZ5KzB4NTkvMHg2
MCBbaTkxNV0KWyAgMTA2LjQyNDYwMF0gIF9faTkxNV9zd19mZW5jZV9jb21wbGV0ZSsweDliLzB4
MzMwIFtpOTE1XQpbICAxMDYuNDI0NzEzXSAgX19pOTE1X3JlcXVlc3RfY29tbWl0KzB4NGJmLzB4
NTcwIFtpOTE1XQpbICAxMDYuNDI0ODE4XSAgaW50ZWxfZW5naW5lX3B1bHNlKzB4MjEzLzB4MzEw
IFtpOTE1XQpbICAxMDYuNDI0OTI1XSAgY29udGV4dF9jbG9zZSsweDIyZi8weDQ3MCBbaTkxNV0K
WyAgMTA2LjQyNTAzM10gIGk5MTVfZ2VtX2NvbnRleHRfZGVzdHJveV9pb2N0bCsweDdiLzB4YTAg
W2k5MTVdClsgIDEwNi40MjUwNThdICBkcm1faW9jdGxfa2VybmVsKzB4MTMxLzB4MTcwClsgIDEw
Ni40MjUwODFdICBkcm1faW9jdGwrMHgyZDkvMHg0ZjEKWyAgMTA2LjQyNTEwNF0gIGRvX3Zmc19p
b2N0bCsweDExNS8weDg5MApbICAxMDYuNDI1MTI2XSAga3N5c19pb2N0bCsweDM1LzB4NzAKWyAg
MTA2LjQyNTE0N10gIF9feDY0X3N5c19pb2N0bCsweDM4LzB4NDAKWyAgMTA2LjQyNTE2OV0gIGRv
X3N5c2NhbGxfNjQrMHg2Ni8weDIyMApbICAxMDYuNDI1MTkxXSAgZW50cnlfU1lTQ0FMTF82NF9h
ZnRlcl9od2ZyYW1lKzB4NDQvMHhhOQpbICAxMDYuNDI1MjEzXQpbICAxMDYuNDI1MjM0XSBGcmVl
ZCBieSB0YXNrIDA6ClsgIDEwNi40MjUyNTVdIChzdGFjayBpcyBub3QgYXZhaWxhYmxlKQpbICAx
MDYuNDI1Mjc2XQpbICAxMDYuNDI1Mjk3XSBUaGUgYnVnZ3kgYWRkcmVzcyBiZWxvbmdzIHRvIHRo
ZSBvYmplY3QgYXQgZmZmZjg4ODcwMzUwNmE0MApbICAxMDYuNDI1Mjk3XSAgd2hpY2ggYmVsb25n
cyB0byB0aGUgY2FjaGUgaTkxNV9wcmlvbGlzdCBvZiBzaXplIDEwNApbICAxMDYuNDI1MzIxXSBU
aGUgYnVnZ3kgYWRkcmVzcyBpcyBsb2NhdGVkIDEzNiBieXRlcyB0byB0aGUgcmlnaHQgb2YKWyAg
MTA2LjQyNTMyMV0gIDEwNC1ieXRlIHJlZ2lvbiBbZmZmZjg4ODcwMzUwNmE0MCwgZmZmZjg4ODcw
MzUwNmFhOCkKWyAgMTA2LjQyNTM0NV0gVGhlIGJ1Z2d5IGFkZHJlc3MgYmVsb25ncyB0byB0aGUg
cGFnZToKWyAgMTA2LjQyNTM2N10gcGFnZTpmZmZmZWEwMDFjMGQ0MTgwIHJlZmNvdW50OjEgbWFw
Y291bnQ6MCBtYXBwaW5nOmZmZmY4ODg3M2UxY2Y3NDAgaW5kZXg6MHhmZmZmODg4NzAzNTA2ZTQw
IGNvbXBvdW5kX21hcGNvdW50OiAwClsgIDEwNi40MjUzOTFdIGZsYWdzOiAweDgwMDAwMDAwMDAw
MTAyMDAoc2xhYnxoZWFkKQpbICAxMDYuNDI1NDE1XSByYXc6IDgwMDAwMDAwMDAwMTAyMDAgZmZm
ZmVhMDAyMDE5MmI4OCBmZmZmODg4ODE3NGI1NDUwIGZmZmY4ODg3M2UxY2Y3NDAKWyAgMTA2LjQy
NTQzOV0gcmF3OiBmZmZmODg4NzAzNTA2ZTQwIDAwMDAwMDAwMDAxMDAwMGUgMDAwMDAwMDFmZmZm
ZmZmZiAwMDAwMDAwMDAwMDAwMDAwClsgIDEwNi40MjU0NjRdIHBhZ2UgZHVtcGVkIGJlY2F1c2U6
IGthc2FuOiBiYWQgYWNjZXNzIGRldGVjdGVkClsgIDEwNi40MjU0ODZdClsgIDEwNi40MjU1MDZd
IE1lbW9yeSBzdGF0ZSBhcm91bmQgdGhlIGJ1Z2d5IGFkZHJlc3M6ClsgIDEwNi40MjU1MjhdICBm
ZmZmODg4NzAzNTA2YTAwOiBmYyBmYyBmYyBmYyBmYyBmYyBmYyBmYyAwMCAwMCAwMCAwMCAwMCAw
MCAwMCAwMApbICAxMDYuNDI1NTUxXSAgZmZmZjg4ODcwMzUwNmE4MDogMDAgMDAgMDAgMDAgMDAg
ZmMgZmMgZmMgZmMgZmMgZmMgZmMgZmMgZmMgZmMgZmMKWyAgMTA2LjQyNTU3M10gPmZmZmY4ODg3
MDM1MDZiMDA6IGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZjIGZj
ClsgIDEwNi40MjU1OTddICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBeClsg
IDEwNi40MjU2MTldICBmZmZmODg4NzAzNTA2YjgwOiBmYyBmYyBmYyBmYyBmYyBmYyBmYyBmYyBm
YyBmYyBmYyBmYyBmYyBmYyBmYyBmYwpbICAxMDYuNDI1NjQyXSAgZmZmZjg4ODcwMzUwNmMwMDog
ZmMgZmMgZmMgZmMgZmMgZmMgZmMgZmMgMDAgMDAgMDAgMDAgMDAgMDAgMDAgMDAKWyAgMTA2LjQy
NTY2NF0gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09CgpGaXhlczogMjJiN2E0MjZiYmUxICgiZHJtL2k5MTUvZXhlY2xpc3Rz
OiBQcmVlbXB0LXRvLWJ1c3kiKQpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNo
cmlzLXdpbHNvbi5jby51az4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMu
YyB8IDggKysrKy0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMoKyksIDQgZGVsZXRp
b25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwppbmRleCAxOTE4OTJmN2IzYTku
LjY0NWY2YjIxZDhjNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
bHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKQEAgLTIyNDYs
MTUgKzIyNDYsMTUgQEAgc3RhdGljIHZvaWQgcmVzZXRfY3NiX3BvaW50ZXJzKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKIAogc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVlc3QgKmFjdGl2
ZV9yZXF1ZXN0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewotCWNvbnN0IHN0cnVjdCBsaXN0
X2hlYWQgKiBjb25zdCBsaXN0ID0gJnJxLT5lbmdpbmUtPmFjdGl2ZS5yZXF1ZXN0czsKLQljb25z
dCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqIGNvbnN0IGNvbnRleHQgPSBycS0+aHdfY29udGV4dDsK
Kwljb25zdCBzdHJ1Y3QgbGlzdF9oZWFkICogY29uc3QgbGlzdCA9ICZycS0+dGltZWxpbmUtPnJl
cXVlc3RzOworCWNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBycS0+aHdf
Y29udGV4dDsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICphY3RpdmUgPSBOVUxMOwogCi0JbGlzdF9m
b3JfZWFjaF9lbnRyeV9mcm9tX3JldmVyc2UocnEsIGxpc3QsIHNjaGVkLmxpbmspIHsKKwlsaXN0
X2Zvcl9lYWNoX2VudHJ5X2Zyb21fcmV2ZXJzZShycSwgbGlzdCwgbGluaykgewogCQlpZiAoaTkx
NV9yZXF1ZXN0X2NvbXBsZXRlZChycSkpCiAJCQlicmVhazsKIAotCQlpZiAocnEtPmh3X2NvbnRl
eHQgIT0gY29udGV4dCkKKwkJaWYgKHJxLT5od19jb250ZXh0ICE9IGNlKQogCQkJYnJlYWs7CiAK
IAkJYWN0aXZlID0gcnE7Ci0tIAoyLjIzLjAucmMxCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 995B8391846
	for <lists+intel-gfx@lfdr.de>; Wed, 26 May 2021 15:00:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F2C176ED03;
	Wed, 26 May 2021 13:00:50 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9F3C26ED0A;
 Wed, 26 May 2021 13:00:47 +0000 (UTC)
IronPort-SDR: RLIwBPuK4LulpFZ/Ygn21w7loU9j+e0nuw3e2VKinOOUlbkS2ep8rlY8YjsnrViKkDxm9gy698
 iw1p8scrkiag==
X-IronPort-AV: E=McAfee;i="6200,9189,9996"; a="182101748"
X-IronPort-AV: E=Sophos;i="5.82,331,1613462400"; d="scan'208";a="182101748"
Received: from orsmga005.jf.intel.com ([10.7.209.41])
 by fmsmga106.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 26 May 2021 06:00:47 -0700
IronPort-SDR: XKDeu4Oy7SaSci8Lgv+rpYorfbsVv9ouV3zKhhW8Q9WDZaHMUYpP0zsbaEEcrCCD+q9VXmivLl
 b9NecmxR7N8g==
X-IronPort-AV: E=Sophos;i="5.82,331,1613462400"; d="scan'208";a="614942154"
Received: from mschan-mobl1.amr.corp.intel.com (HELO mwauld-desk1.intel.com)
 ([10.212.100.144])
 by orsmga005-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 26 May 2021 06:00:45 -0700
From: Matthew Auld <matthew.auld@intel.com>
To: igt-dev@lists.freedesktop.org
Date: Wed, 26 May 2021 14:00:23 +0100
Message-Id: <20210526130025.249629-7-matthew.auld@intel.com>
X-Mailer: git-send-email 2.26.3
In-Reply-To: <20210526130025.249629-1-matthew.auld@intel.com>
References: <20210526130025.249629-1-matthew.auld@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t v3 7/9] tests/i915/gem_media_fill: Use
 memory region interface
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org,
 Dominik Grzegorzek <dominik.grzegorzek@intel.com>,
 Andrzej Turko <andrzej.turko@linux.intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQW5kcnplaiBUdXJrbyA8YW5kcnplai50dXJrb0BsaW51eC5pbnRlbC5jb20+CgpDb252
ZXJ0ZWQgdGhlIHRlc3QgZ2VtX21lZGlhX2ZpbGwgdG8gdXNlIG1lbW9yeSByZWdpb24gdWFwaS4K
ClNpZ25lZC1vZmYtYnk6IEFuZHJ6ZWogVHVya28gPGFuZHJ6ZWoudHVya29AbGludXguaW50ZWwu
Y29tPgpDYzogWmJpZ25pZXcgS2VtcGN6eW5za2kgPHpiaWduaWV3LmtlbXBjenluc2tpQGludGVs
LmNvbT4KQ2M6IERvbWluaWsgR3J6ZWdvcnplayA8ZG9taW5pay5ncnplZ29yemVrQGludGVsLmNv
bT4KQ2M6IFBldHJpIExhdHZhbGEgPHBldHJpLmxhdHZhbGFAaW50ZWwuY29tPgpTaWduZWQtb2Zm
LWJ5OiBNYXR0aGV3IEF1bGQgPG1hdHRoZXcuYXVsZEBpbnRlbC5jb20+CkFja2VkLWJ5OiBQZXRy
aSBMYXR2YWxhIDxwZXRyaS5sYXR2YWxhQGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IFpiaWduaWV3
IEtlbXBjennFhHNraSA8emJpZ25pZXcua2VtcGN6eW5za2lAaW50ZWwuY29tPgotLS0KIHRlc3Rz
L2k5MTUvZ2VtX21lZGlhX2ZpbGwuYyB8IDU3ICsrKysrKysrKysrKysrKysrKysrKysrKysrKyst
LS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA0NCBpbnNlcnRpb25zKCspLCAxMyBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS90ZXN0cy9pOTE1L2dlbV9tZWRpYV9maWxsLmMgYi90ZXN0cy9pOTE1
L2dlbV9tZWRpYV9maWxsLmMKaW5kZXggMjRkMTdmYWIuLjI4YzE4ZTc5IDEwMDY0NAotLS0gYS90
ZXN0cy9pOTE1L2dlbV9tZWRpYV9maWxsLmMKKysrIGIvdGVzdHMvaTkxNS9nZW1fbWVkaWFfZmls
bC5jCkBAIC02NCwyMSArNjQsMjQgQEAgdHlwZWRlZiBzdHJ1Y3QgewogfSBkYXRhX3Q7CiAKIHN0
YXRpYyBzdHJ1Y3QgaW50ZWxfYnVmICoKLWNyZWF0ZV9idWYoZGF0YV90ICpkYXRhLCBpbnQgd2lk
dGgsIGludCBoZWlnaHQsIHVpbnQ4X3QgY29sb3IpCitjcmVhdGVfYnVmKGRhdGFfdCAqZGF0YSwg
aW50IHdpZHRoLCBpbnQgaGVpZ2h0LCB1aW50OF90IGNvbG9yLCB1aW50MzJfdCByZWdpb24pCiB7
CiAJc3RydWN0IGludGVsX2J1ZiAqYnVmOworCXVpbnQzMl90IGhhbmRsZTsKIAl1aW50OF90ICpw
dHI7CiAJaW50IGk7CiAKIAlidWYgPSBjYWxsb2MoMSwgc2l6ZW9mKCpidWYpKTsKIAlpZ3RfYXNz
ZXJ0KGJ1Zik7CiAKKwloYW5kbGUgPSBnZW1fY3JlYXRlX2luX21lbW9yeV9yZWdpb25zKGRhdGEt
PmRybV9mZCwgU0laRSwgcmVnaW9uKTsKKwogCS8qCiAJICogTGVnYWN5IGNvZGUgdXNlcyAzMiBi
cHAgYWZ0ZXIgYnVmZmVyIGNyZWF0aW9uLgogCSAqIExldCdzIGRvIHRoZSBzYW1lIGR1ZSB0byBr
ZWVwIHNoYWRlciBpbnRhY3QuCiAJICovCi0JaW50ZWxfYnVmX2luaXQoZGF0YS0+Ym9wcywgYnVm
LCB3aWR0aC80LCBoZWlnaHQsIDMyLCAwLAotCQkgICAgICAgSTkxNV9USUxJTkdfTk9ORSwgMCk7
CisJaW50ZWxfYnVmX2luaXRfdXNpbmdfaGFuZGxlKGRhdGEtPmJvcHMsIGhhbmRsZSwgYnVmLCB3
aWR0aC80LAorCQkJCSAgICBoZWlnaHQsIDMyLCAwLCBJOTE1X1RJTElOR19OT05FLCAwKTsKIAog
CXB0ciA9IGdlbV9tbWFwX19jcHVfY29oZXJlbnQoZGF0YS0+ZHJtX2ZkLCBidWYtPmhhbmRsZSwg
MCwKIAkJCQkgICAgIGJ1Zi0+c3VyZmFjZVswXS5zaXplLCBQUk9UX1dSSVRFKTsKQEAgLTEwMSwx
MyArMTA0LDE2IEBAIHN0YXRpYyB2b2lkIGJ1Zl9jaGVjayh1aW50OF90ICpwdHIsIGludCB4LCBp
bnQgeSwgdWludDhfdCBjb2xvcikKIAkJICAgICBjb2xvciwgdmFsLCB4LCB5KTsKIH0KIAotc3Rh
dGljIHZvaWQgbWVkaWFfZmlsbChkYXRhX3QgKmRhdGEsIGlndF9maWxsZnVuY190IGZpbGwpCitz
dGF0aWMgdm9pZCBtZWRpYV9maWxsKGRhdGFfdCAqZGF0YSwgaWd0X2ZpbGxmdW5jX3QgZmlsbCwK
KwkJICAgICAgIHN0cnVjdCBpZ3RfY29sbGVjdGlvbiAqbWVtcmVnaW9uX3NldCkKIHsKIAlzdHJ1
Y3QgaW50ZWxfYnVmICpidWY7CisJdWludDMyX3QgcmVnaW9uOwogCXVpbnQ4X3QgKnB0cjsKIAlp
bnQgaSwgajsKIAotCWJ1ZiA9IGNyZWF0ZV9idWYoZGF0YSwgV0lEVEgsIEhFSUdIVCwgQ09MT1Jf
QzQpOworCXJlZ2lvbiA9IGlndF9jb2xsZWN0aW9uX2dldF92YWx1ZShtZW1yZWdpb25fc2V0LCAw
KTsKKwlidWYgPSBjcmVhdGVfYnVmKGRhdGEsIFdJRFRILCBIRUlHSFQsIENPTE9SX0M0LCByZWdp
b24pOwogCXB0ciA9IGdlbV9tbWFwX19kZXZpY2VfY29oZXJlbnQoZGF0YS0+ZHJtX2ZkLCBidWYt
PmhhbmRsZSwKIAkJCQkJMCwgYnVmLT5zdXJmYWNlWzBdLnNpemUsIFBST1RfUkVBRCk7CiAJZm9y
IChpID0gMDsgaSA8IFdJRFRIOyBpKyspCkBAIC0xMjYsMjAgKzEzMiw0NSBAQCBzdGF0aWMgdm9p
ZCBtZWRpYV9maWxsKGRhdGFfdCAqZGF0YSwgaWd0X2ZpbGxmdW5jX3QgZmlsbCkKIAltdW5tYXAo
cHRyLCBidWYtPnN1cmZhY2VbMF0uc2l6ZSk7CiB9CiAKLWlndF9zaW1wbGVfbWFpbgoraWd0X21h
aW4KIHsKIAlkYXRhX3QgZGF0YSA9IHswLCB9OwogCWlndF9maWxsZnVuY190IGZpbGxfZm4gPSBO
VUxMOworCXN0cnVjdCBkcm1faTkxNV9xdWVyeV9tZW1vcnlfcmVnaW9ucyAqcXVlcnlfaW5mbzsK
KwlzdHJ1Y3QgaWd0X2NvbGxlY3Rpb24gKnNldCwgKnJlZ2lvbl9zZXQ7CisKKwlpZ3RfZml4dHVy
ZSB7CisJCWRhdGEuZHJtX2ZkID0gZHJtX29wZW5fZHJpdmVyX3JlbmRlcihEUklWRVJfSU5URUwp
OworCQlpZ3RfcmVxdWlyZV9nZW0oZGF0YS5kcm1fZmQpOworCisJCWRhdGEuZGV2aWQgPSBpbnRl
bF9nZXRfZHJtX2RldmlkKGRhdGEuZHJtX2ZkKTsKKwkJZGF0YS5ib3BzID0gYnVmX29wc19jcmVh
dGUoZGF0YS5kcm1fZmQpOworCisJCWZpbGxfZm4gPSBpZ3RfZ2V0X21lZGlhX2ZpbGxmdW5jKGRh
dGEuZGV2aWQpOworCisJCWlndF9yZXF1aXJlX2YoZmlsbF9mbiwgIm5vIG1lZGlhLWZpbGwgZnVu
Y3Rpb25cbiIpOworCisJCXF1ZXJ5X2luZm8gPSBnZW1fZ2V0X3F1ZXJ5X21lbW9yeV9yZWdpb25z
KGRhdGEuZHJtX2ZkKTsKKwkJaWd0X2Fzc2VydChxdWVyeV9pbmZvKTsKKworCQlzZXQgPSBnZXRf
bWVtb3J5X3JlZ2lvbl9zZXQocXVlcnlfaW5mbywKKwkJCQkJICAgIEk5MTVfU1lTVEVNX01FTU9S
WSk7CiAKLQlkYXRhLmRybV9mZCA9IGRybV9vcGVuX2RyaXZlcl9yZW5kZXIoRFJJVkVSX0lOVEVM
KTsKLQlpZ3RfcmVxdWlyZV9nZW0oZGF0YS5kcm1fZmQpOworCQlpZ3RfZm9ya19oYW5nX2RldGVj
dG9yKGRhdGEuZHJtX2ZkKTsKKwl9CiAKLQlkYXRhLmRldmlkID0gaW50ZWxfZ2V0X2RybV9kZXZp
ZChkYXRhLmRybV9mZCk7Ci0JZGF0YS5ib3BzID0gYnVmX29wc19jcmVhdGUoZGF0YS5kcm1fZmQp
OworCWlndF9zdWJ0ZXN0X3dpdGhfZHluYW1pYygibWVkaWEtZmlsbCIpCisJCWZvcl9lYWNoX2Nv
bWJpbmF0aW9uKHJlZ2lvbl9zZXQsIDEsIHNldCkgeworCQkJY2hhciAqc3ViX25hbWUgPSBtZW1y
ZWdpb25fZHluYW1pY19zdWJ0ZXN0X25hbWUocmVnaW9uX3NldCk7CiAKLQlmaWxsX2ZuID0gaWd0
X2dldF9tZWRpYV9maWxsZnVuYyhkYXRhLmRldmlkKTsKKwkJCWlndF9keW5hbWljX2YoIiVzIiwg
c3ViX25hbWUpCisJCQkJbWVkaWFfZmlsbCgmZGF0YSwgZmlsbF9mbiwgcmVnaW9uX3NldCk7CiAK
LQlpZ3RfcmVxdWlyZV9mKGZpbGxfZm4sICJubyBtZWRpYS1maWxsIGZ1bmN0aW9uXG4iKTsKKwkJ
CWZyZWUoc3ViX25hbWUpOworCX0KIAotCW1lZGlhX2ZpbGwoJmRhdGEsIGZpbGxfZm4pOworCWln
dF9maXh0dXJlIHsKKwkJaWd0X2NvbGxlY3Rpb25fZGVzdHJveShzZXQpOworCQlpZ3Rfc3RvcF9o
YW5nX2RldGVjdG9yKCk7CisJfQogfQotLSAKMi4yNi4zCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdm
eEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9pbnRlbC1nZngK

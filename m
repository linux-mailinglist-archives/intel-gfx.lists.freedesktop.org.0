Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 1A643D4387
	for <lists+intel-gfx@lfdr.de>; Fri, 11 Oct 2019 16:56:44 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4CE6A6E408;
	Fri, 11 Oct 2019 14:56:42 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 993746EB01
 for <intel-gfx@lists.freedesktop.org>; Fri, 11 Oct 2019 14:56:41 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 11 Oct 2019 07:56:40 -0700
X-IronPort-AV: E=Sophos;i="5.67,284,1566889200"; d="scan'208";a="197599412"
Received: from hemavenk-mobl1.ger.corp.intel.com (HELO [10.251.81.25])
 ([10.251.81.25])
 by orsmga003-auth.jf.intel.com with ESMTP/TLS/AES256-SHA;
 11 Oct 2019 07:56:39 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20191010071434.31195-1-chris@chris-wilson.co.uk>
 <20191010071434.31195-10-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <a087c394-da92-e35c-f5c8-f1baefe0342f@linux.intel.com>
Date: Fri, 11 Oct 2019 15:56:35 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20191010071434.31195-10-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 10/10] drm/i915: Flush idle barriers when
 waiting
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDEwLzEwLzIwMTkgMDg6MTQsIENocmlzIFdpbHNvbiB3cm90ZToKPiBJZiB3ZSBkbyBmaW5k
IG91cnNlbHZlcyB3aXRoIGFuIGlkbGUgYmFycmllciBpbnNpZGUgb3VyIGFjdGl2ZSB3aGlsZQo+
IHdhaXRpbmcsIGF0dGVtcHQgdG8gZmx1c2ggaXQgYnkgZW1pdHRpbmcgYSBwdWxzZSB1c2luZyB0
aGUga2VybmVsCj4gY29udGV4dC4KClRoZSBwb2ludCBvZiB0aGlzIG9uZSBjb21wbGV0ZWx5IGVz
Y2FwZXMgbWUgYXQgdGhlIG1vbWVudC4gSWRsZSBiYXJyaWVycyAKYXJlIGtlcHQgaW4gdGhlcmUg
dG8gYmUgY29uc3VtZWQgYnkgdGhlIGVuZ2luZV9wbSBwYXJraW5nLCBzbyBpZiBhbnkgCnJhbmRv
bSB3YWl0ZXIgZmluZHMgc29tZSAodGhlcmUgd2lsbCBhbHdheXMgYmUgc29tZSwgYXMgbG9uZyBh
cyB0aGUgCmVuZ2luZSBleGVjdXRlZCBzb21lIHVzZXIgY29udGV4dCwgcmlnaHQ/KSwgd2h5IHdv
dWxkIGl0IHdhbnQgdG8gaGFuZGxlIAp0aGVtPyBBZ2FpbiBqdXN0IHRvIHVzZSB0aGUgb3Bwb3J0
dW5pdHkgZm9yIHNvbWUgaG91c2Uga2VlcGluZz8gQnV0IHdoYXQgCmlmIHRoZSBzeXN0ZW0gaXMg
b3RoZXJ3aXNlIHF1aXRlIGJ1c3kgYW5kIGEgbG93LXByaW9yaXR5IGNsaWVudCBqdXN0IApoYXBw
ZW5zIHRvIHdhbnQgdG8gd2FpdCBvbiBzb21ldGhpbmcgc2lsbHk/CgpSZWdhcmRzLAoKVHZydGtv
Cgo+IFNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVr
Pgo+IC0tLQo+ICAgLi4uL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmMg
IHwgMTQgKysrKysrKysrKysrKwo+ICAgLi4uL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVf
aGVhcnRiZWF0LmggIHwgIDEgKwo+ICAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUu
YyAgICAgICAgICAgIHwgMjEgKysrKysrKysrKysrKysrKystLQo+ICAgMyBmaWxlcyBjaGFuZ2Vk
LCAzNCBpbnNlcnRpb25zKCspLCAyIGRlbGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmMKPiBpbmRleCBmNjhhY2Y5MTE4
ZjMuLmUyN2JiN2YwMjhiZCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9lbmdpbmVfaGVhcnRiZWF0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9lbmdpbmVfaGVhcnRiZWF0LmMKPiBAQCAtMTY5LDMgKzE2OSwxNyBAQCBpbnQgaW50ZWxf
ZW5naW5lX3B1bHNlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKPiAgIAlpbnRlbF9l
bmdpbmVfcG1fcHV0KGVuZ2luZSk7Cj4gICAJcmV0dXJuIGVycjsKPiAgIH0KPiArCj4gK2ludCBp
bnRlbF9lbmdpbmVfZmx1c2hfYmFycmllcnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQo+ICt7Cj4gKwlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsKPiArCj4gKwlycSA9IGk5MTVfcmVx
dWVzdF9jcmVhdGUoZW5naW5lLT5rZXJuZWxfY29udGV4dCk7Cj4gKwlpZiAoSVNfRVJSKHJxKSkK
PiArCQlyZXR1cm4gUFRSX0VSUihycSk7Cj4gKwo+ICsJaWRsZV9wdWxzZShlbmdpbmUsIHJxKTsK
PiArCWk5MTVfcmVxdWVzdF9hZGQocnEpOwo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaCBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaAo+IGluZGV4
IDM5MzkxMDA0NTU0ZC4uMGMxYWQwZmMwOTFkIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaAo+IEBAIC0xNSw1ICsxNSw2IEBAIHZv
aWQgaW50ZWxfZW5naW5lX3BhcmtfaGVhcnRiZWF0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSk7Cj4gICB2b2lkIGludGVsX2VuZ2luZV91bnBhcmtfaGVhcnRiZWF0KHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSk7Cj4gICAKPiAgIGludCBpbnRlbF9lbmdpbmVfcHVsc2Uoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKPiAraW50IGludGVsX2VuZ2luZV9mbHVzaF9i
YXJyaWVycyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpOwo+ICAgCj4gICAjZW5kaWYg
LyogSU5URUxfRU5HSU5FX0hFQVJUQkVBVF9IICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfYWN0aXZlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2
ZS5jCj4gaW5kZXggYWEzN2MwNzAwNGI5Li45OGQ1ZmUxYzdlMTkgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYwo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfYWN0aXZlLmMKPiBAQCAtNiw2ICs2LDcgQEAKPiAgIAo+ICAgI2luY2x1ZGUgPGxp
bnV4L2RlYnVnb2JqZWN0cy5oPgo+ICAgCj4gKyNpbmNsdWRlICJndC9pbnRlbF9lbmdpbmVfaGVh
cnRiZWF0LmgiCj4gICAjaW5jbHVkZSAiZ3QvaW50ZWxfZW5naW5lX3BtLmgiCj4gICAKPiAgICNp
bmNsdWRlICJpOTE1X2Rydi5oIgo+IEBAIC00MzUsNiArNDM2LDIxIEBAIHN0YXRpYyB2b2lkIGVu
YWJsZV9zaWduYWxpbmcoc3RydWN0IGk5MTVfYWN0aXZlX2ZlbmNlICphY3RpdmUpCj4gICAJZG1h
X2ZlbmNlX3B1dChmZW5jZSk7Cj4gICB9Cj4gICAKPiArc3RhdGljIGludCBmbHVzaF9iYXJyaWVy
KHN0cnVjdCBhY3RpdmVfbm9kZSAqaXQpCj4gK3sKPiArCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZTsKPiArCj4gKwlpZiAoIWlzX2JhcnJpZXIoJml0LT5iYXNlKSkKPiArCQlyZXR1cm4g
MDsKPiArCj4gKwllbmdpbmUgPSBfX2JhcnJpZXJfdG9fZW5naW5lKGl0KTsKPiArCXNtcF9ybWIo
KTsgLyogc2VyaWFsaXNlIHdpdGggYWRkX2FjdGl2ZV9iYXJyaWVycyAqLwo+ICsJaWYgKCFpc19i
YXJyaWVyKCZpdC0+YmFzZSkpCj4gKwkJcmV0dXJuIDA7Cj4gKwo+ICsJcmV0dXJuIGludGVsX2Vu
Z2luZV9mbHVzaF9iYXJyaWVycyhlbmdpbmUpOwo+ICt9Cj4gKwo+ICAgaW50IGk5MTVfYWN0aXZl
X3dhaXQoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCj4gICB7Cj4gICAJc3RydWN0IGFjdGl2ZV9u
b2RlICppdCwgKm47Cj4gQEAgLTQ0OCw4ICs0NjQsOSBAQCBpbnQgaTkxNV9hY3RpdmVfd2FpdChz
dHJ1Y3QgaTkxNV9hY3RpdmUgKnJlZikKPiAgIAkvKiBGbHVzaCBsYXp5IHNpZ25hbHMgKi8KPiAg
IAllbmFibGVfc2lnbmFsaW5nKCZyZWYtPmV4Y2wpOwo+ICAgCXJidHJlZV9wb3N0b3JkZXJfZm9y
X2VhY2hfZW50cnlfc2FmZShpdCwgbiwgJnJlZi0+dHJlZSwgbm9kZSkgewo+IC0JCWlmIChpc19i
YXJyaWVyKCZpdC0+YmFzZSkpIC8qIHVuY29ubmVjdGVkIGlkbGUgYmFycmllciAqLwo+IC0JCQlj
b250aW51ZTsKPiArCQllcnIgPSBmbHVzaF9iYXJyaWVyKGl0KTsgLyogdW5jb25uZWN0ZWQgaWRs
ZSBiYXJyaWVyPyAqLwo+ICsJCWlmIChlcnIpCj4gKwkJCWJyZWFrOwo+ICAgCj4gICAJCWVuYWJs
ZV9zaWduYWxpbmcoJml0LT5iYXNlKTsKPiAgIAl9Cj4gCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3A145FDE4A
	for <lists+intel-gfx@lfdr.de>; Fri, 15 Nov 2019 13:50:34 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8C4636E5D1;
	Fri, 15 Nov 2019 12:50:32 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 7D9BF6E5D1
 for <intel-gfx@lists.freedesktop.org>; Fri, 15 Nov 2019 12:50:31 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 15 Nov 2019 04:50:30 -0800
X-IronPort-AV: E=Sophos;i="5.68,308,1569308400"; d="scan'208";a="199191730"
Received: from mpotanix-mobl2.ccr.corp.intel.com (HELO [10.252.20.183])
 ([10.252.20.183])
 by orsmga008-auth.jf.intel.com with ESMTP/TLS/AES256-SHA;
 15 Nov 2019 04:50:29 -0800
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20191114225736.616885-1-chris@chris-wilson.co.uk>
 <20191114225736.616885-4-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <ac55bdcf-74c8-c5fa-151d-abafc5753cdc@linux.intel.com>
Date: Fri, 15 Nov 2019 12:50:28 +0000
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <20191114225736.616885-4-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 4/5] drm/i915/selftests: Exercise long
 preemption chains
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDE0LzExLzIwMTkgMjI6NTcsIENocmlzIFdpbHNvbiB3cm90ZToKPiBWZXJpZnkgdGhhdCB3
ZSBjYW4gZXhlY3V0ZSBhIGxvbmcgY2hhaW4gb2YgZGVwZW5kZW50IHJlcXVlc3RzIGZyb20KPiB1
c2Vyc3BhY2UsIGVhY2ggb25lIHNsaWdodGx5IG1vcmUgaW1wb3J0YW50IHRoYW4gdGhlIGxhc3Qu
Cj4gCj4gU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28u
dWs+Cj4gQ2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRlbC5jb20+Cj4gLS0t
Cj4gICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyB8IDE5NiArKysrKysr
KysrKysrKysrKysrKysrKysrCj4gICAxIGZpbGUgY2hhbmdlZCwgMTk2IGluc2VydGlvbnMoKykK
PiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwo+IGluZGV4IGQxZWQzYzBm
ODUxYy4uMmVmMDNhOGVmYTI4IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X2xyYy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rf
bHJjLmMKPiBAQCAtMTkxNSw2ICsxOTE1LDIwMSBAQCBzdGF0aWMgaW50IGxpdmVfY2hhaW5fcHJl
ZW1wdCh2b2lkICphcmcpCj4gICAJZ290byBlcnJfY2xpZW50X2xvOwo+ICAgfQo+ICAgCj4gK3N0
YXRpYyBpbnQgY3JlYXRlX2dhbmcoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAo+ICsJ
CSAgICAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICoqcHJldikKPiArewo+ICsJc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iajsKPiArCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKPiArCXN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwo+ICsJc3RydWN0IGk5MTVfdm1hICp2bWE7Cj4gKwl1MzIg
KmNzOwo+ICsJaW50IGVycjsKPiArCj4gKwljZSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGVuZ2lu
ZS0+a2VybmVsX2NvbnRleHQtPmdlbV9jb250ZXh0LCBlbmdpbmUpOwo+ICsJaWYgKElTX0VSUihj
ZSkpCj4gKwkJcmV0dXJuIFBUUl9FUlIoY2UpOwo+ICsKPiArCW9iaiA9IGk5MTVfZ2VtX29iamVj
dF9jcmVhdGVfaW50ZXJuYWwoZW5naW5lLT5pOTE1LCA0MDk2KTsKPiArCWlmIChJU19FUlIob2Jq
KSkgewo+ICsJCWVyciA9IFBUUl9FUlIob2JqKTsKPiArCQlnb3RvIGVycl9jZTsKPiArCX0KPiAr
Cj4gKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIGNlLT52bSwgTlVMTCk7Cj4gKwlpZiAo
SVNfRVJSKHZtYSkpIHsKPiArCQllcnIgPSBQVFJfRVJSKHZtYSk7Cj4gKwkJZ290byBlcnJfb2Jq
Owo+ICsJfQo+ICsKPiArCWVyciA9IGk5MTVfdm1hX3Bpbih2bWEsIDAsIDAsIFBJTl9VU0VSKTsK
PiArCWlmIChlcnIpCj4gKwkJZ290byBlcnJfb2JqOwo+ICsKPiArCWNzID0gaTkxNV9nZW1fb2Jq
ZWN0X3Bpbl9tYXAob2JqLCBJOTE1X01BUF9XQyk7Cj4gKwlpZiAoSVNfRVJSKGNzKSkKPiArCQln
b3RvIGVycl9vYmo7Cj4gKwo+ICsJLyogU2VtYXBob3JlIHRhcmdldDogc3BpbiB1bnRpbCB6ZXJv
ICovCj4gKwkqY3MrKyA9IE1JX0FSQl9PTl9PRkYgfCBNSV9BUkJfRU5BQkxFOwo+ICsKPiArCSpj
cysrID0gTUlfU0VNQVBIT1JFX1dBSVQgfAo+ICsJCU1JX1NFTUFQSE9SRV9QT0xMIHwKPiArCQlN
SV9TRU1BUEhPUkVfU0FEX0VRX1NERDsKPiArCSpjcysrID0gMDsKPiArCSpjcysrID0gbG93ZXJf
MzJfYml0cyh2bWEtPm5vZGUuc3RhcnQpOwo+ICsJKmNzKysgPSB1cHBlcl8zMl9iaXRzKHZtYS0+
bm9kZS5zdGFydCk7Cj4gKwo+ICsJaWYgKCpwcmV2KSB7Cj4gKwkJdTY0IG9mZnNldCA9ICgqcHJl
diktPmJhdGNoLT5ub2RlLnN0YXJ0Owo+ICsKPiArCQkvKiBUZXJtaW5hdGUgdGhlIHNwaW5uZXIg
aW4gdGhlIG5leHQgbG93ZXIgcHJpb3JpdHkgYmF0Y2guICovCj4gKwkJKmNzKysgPSBNSV9TVE9S
RV9EV09SRF9JTU1fR0VONDsKPiArCQkqY3MrKyA9IGxvd2VyXzMyX2JpdHMob2Zmc2V0KTsKPiAr
CQkqY3MrKyA9IHVwcGVyXzMyX2JpdHMob2Zmc2V0KTsKPiArCQkqY3MrKyA9IDA7Cj4gKwl9Cj4g
Kwo+ICsJKmNzKysgPSBNSV9CQVRDSF9CVUZGRVJfRU5EOwo+ICsJaTkxNV9nZW1fb2JqZWN0X2Zs
dXNoX21hcChvYmopOwo+ICsJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChvYmopOwo+ICsKPiAr
CXJxID0gaW50ZWxfY29udGV4dF9jcmVhdGVfcmVxdWVzdChjZSk7Cj4gKwlpZiAoSVNfRVJSKHJx
KSkKPiArCQlnb3RvIGVycl9vYmo7Cj4gKwo+ICsJcnEtPmJhdGNoID0gdm1hOwo+ICsJaTkxNV9y
ZXF1ZXN0X2dldChycSk7Cj4gKwo+ICsJaTkxNV92bWFfbG9jayh2bWEpOwo+ICsJZXJyID0gaTkx
NV9yZXF1ZXN0X2F3YWl0X29iamVjdChycSwgdm1hLT5vYmosIGZhbHNlKTsKPiArCWlmICghZXJy
KQo+ICsJCWVyciA9IGk5MTVfdm1hX21vdmVfdG9fYWN0aXZlKHZtYSwgcnEsIDApOwo+ICsJaWYg
KCFlcnIpCj4gKwkJZXJyID0gcnEtPmVuZ2luZS0+ZW1pdF9iYl9zdGFydChycSwKPiArCQkJCQkJ
dm1hLT5ub2RlLnN0YXJ0LAo+ICsJCQkJCQlQQUdFX1NJWkUsIDApOwo+ICsJaTkxNV92bWFfdW5s
b2NrKHZtYSk7Cj4gKwlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKPiArCWlmIChlcnIpCj4gKwkJZ290
byBlcnJfcnE7Cj4gKwo+ICsJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwo+ICsJaW50ZWxfY29u
dGV4dF9wdXQoY2UpOwo+ICsKPiArCXJxLT5jbGllbnRfbGluay5uZXh0ID0gJigqcHJldiktPmNs
aWVudF9saW5rOwo+ICsJKnByZXYgPSBycTsKPiArCXJldHVybiAwOwo+ICsKPiArZXJyX3JxOgo+
ICsJaTkxNV9yZXF1ZXN0X3B1dChycSk7Cj4gK2Vycl9vYmo6Cj4gKwlpOTE1X2dlbV9vYmplY3Rf
cHV0KG9iaik7Cj4gK2Vycl9jZToKPiArCWludGVsX2NvbnRleHRfcHV0KGNlKTsKPiArCXJldHVy
biBlcnI7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgbGl2ZV9wcmVlbXB0X2dhbmcodm9pZCAqYXJn
KQo+ICt7Cj4gKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwo+ICsJc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lOwo+ICsJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Cj4gKwo+ICsJaWYg
KCFIQVNfTE9HSUNBTF9SSU5HX1BSRUVNUFRJT04oZ3QtPmk5MTUpKQo+ICsJCXJldHVybiAwOwo+
ICsKPiArCS8qCj4gKwkgKiBCdWlsZCBhcyBsb25nIGEgY2hhaW4gb2YgcHJlZW1wdGVycyBhcyB3
ZSBjYW4sIHdpdGggZWFjaAo+ICsJICogcmVxdWVzdCBoaWdoZXIgcHJpb3JpdHkgdGhhbiB0aGUg
bGFzdC4gT25jZSB3ZSBhcmUgcmVhZHksIHdlIHJlbGVhc2UKPiArCSAqIHRoZSBsYXN0IGJhdGNo
IHdoaWNoIHRoZW4gcHJlY29sYXRlcyBkb3duIHRoZSBjaGFpbiwgZWFjaCByZWxlYXNpbmcKPiAr
CSAqIHRoZSBuZXh0IG9sZGVzdCBpbiB0dXJuLiBUaGUgaW50ZW50IGlzIHRvIHNpbXBseSBwdXNo
IGFzIGhhcmQgYXMgd2UKPiArCSAqIGNhbiB3aXRoIHRoZSBudW1iZXIgb2YgcHJlZW1wdGlvbnMs
IHRyeWluZyB0byBleGNlZWQgbmFycm93IEhXCj4gKwkgKiBsaW1pdHMuIEF0IGEgbWluaW11bSwg
d2UgaW5zaXN0IHRoYXQgd2UgY2FuIHNvcnQgYWxsIHRoZSB1c2VyCj4gKwkgKiBoaWdoIHByaW9y
aXR5IGxldmVscyBpbnRvIGV4ZWN1dGlvbiBvcmRlci4KPiArCSAqLwo+ICsKPiArCWZvcl9lYWNo
X2VuZ2luZShlbmdpbmUsIGd0LCBpZCkgewo+ICsJCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxID0g
TlVMTDsKPiArCQlzdHJ1Y3QgaWd0X2xpdmVfdGVzdCB0Owo+ICsJCUlHVF9USU1FT1VUKGVuZF90
aW1lKTsKPiArCQlpbnQgcHJpbyA9IDA7Cj4gKwkJaW50IGVyciA9IDA7Cj4gKwkJdTMyICpjczsK
PiArCj4gKwkJaWYgKCFpbnRlbF9lbmdpbmVfaGFzX3ByZWVtcHRpb24oZW5naW5lKSkKPiArCQkJ
Y29udGludWU7Cj4gKwo+ICsJCWlmIChpZ3RfbGl2ZV90ZXN0X2JlZ2luKCZ0LCBndC0+aTkxNSwg
X19mdW5jX18sIGVuZ2luZS0+bmFtZSkpCj4gKwkJCXJldHVybiAtRUlPOwo+ICsKPiArCQlkbyB7
Cj4gKwkJCXN0cnVjdCBpOTE1X3NjaGVkX2F0dHIgYXR0ciA9IHsKPiArCQkJCS5wcmlvcml0eSA9
IEk5MTVfVVNFUl9QUklPUklUWShwcmlvKyspLAo+ICsJCQl9Owo+ICsKPiArCQkJZXJyID0gY3Jl
YXRlX2dhbmcoZW5naW5lLCAmcnEpOwo+ICsJCQlpZiAoZXJyKQo+ICsJCQkJYnJlYWs7Cj4gKwo+
ICsJCQkvKiBTdWJtaXQgZWFjaCBzcGlubmVyIGF0IGluY3JlYXNpbmcgcHJpb3JpdHkgKi8KPiAr
CQkJZW5naW5lLT5zY2hlZHVsZShycSwgJmF0dHIpOwo+ICsKPiArCQkJaWYgKHByaW8gPD0gSTkx
NV9QUklPUklUWV9NQVgpCj4gKwkJCQljb250aW51ZTsKPiArCj4gKwkJCWlmIChwcmlvID4gKElO
VF9NQVggPj4gSTkxNV9VU0VSX1BSSU9SSVRZX1NISUZUKSkKPiArCQkJCWJyZWFrOwo+ICsKPiAr
CQkJaWYgKF9faWd0X3RpbWVvdXQoZW5kX3RpbWUsIE5VTEwpKQo+ICsJCQkJYnJlYWs7Cj4gKwkJ
fSB3aGlsZSAoMSk7Cj4gKwkJcHJfZGVidWcoIiVzOiBQcmVlbXB0IGNoYWluIG9mICVkIHJlcXVl
c3RzXG4iLAo+ICsJCQkgZW5naW5lLT5uYW1lLCBwcmlvKTsKPiArCj4gKwkJLyoKPiArCQkgKiBT
dWNoIHRoYXQgdGhlIGxhc3Qgc3Bpbm5lciBpcyB0aGUgaGlnaGVyIHByaW9yaXR5IGFuZAo+ICsJ
CSAqIHNob3VsZCBleGVjdXRlIGZpcnN0LiBXaGVuIHRoYXQgc3Bpbm5lciBjb21wbGV0ZXMsCj4g
KwkJICogaXQgd2lsbCB0ZXJtaW5hdGUgdGhlIG5leHQgbG93ZXN0IHNwaW5uZXIgdW50aWwgdGhl
cmUKPiArCQkgKiBhcmUgbm8gbW9yZSBzcGlubmVycyBhbmQgdGhlIGdhbmcgaXMgY29tcGxldGUu
Cj4gKwkJICovCj4gKwkJY3MgPSBpOTE1X2dlbV9vYmplY3RfcGluX21hcChycS0+YmF0Y2gtPm9i
aiwgSTkxNV9NQVBfV0MpOwo+ICsJCWlmICghSVNfRVJSKGNzKSkgewo+ICsJCQkqY3MgPSAwOwo+
ICsJCQlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHJxLT5iYXRjaC0+b2JqKTsKPiArCQl9IGVs
c2Ugewo+ICsJCQllcnIgPSBQVFJfRVJSKGNzKTsKPiArCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZChn
dCk7Cj4gKwkJfQo+ICsKPiArCQl3aGlsZSAocnEpIHsgLyogd2FpdCBmb3IgZWFjaCBycSBmcm9t
IGhpZ2hlc3QgdG8gbG93ZXN0IHByaW8gKi8KPiArCQkJc3RydWN0IGk5MTVfcmVxdWVzdCAqbiA9
Cj4gKwkJCQlsaXN0X25leHRfZW50cnkocnEsIGNsaWVudF9saW5rKTsKPiArCj4gKwkJCWlmIChl
cnIgPT0gMCAmJiBpOTE1X3JlcXVlc3Rfd2FpdChycSwgMCwgSFogLyA1KSA8IDApIHsKPiArCQkJ
CXN0cnVjdCBkcm1fcHJpbnRlciBwID0KPiArCQkJCQlkcm1faW5mb19wcmludGVyKGVuZ2luZS0+
aTkxNS0+ZHJtLmRldik7Cj4gKwo+ICsJCQkJcHJfZXJyKCJGYWlsZWQgdG8gZmx1c2ggY2hhaW4g
b2YgJWQgcmVxdWVzdHMsIGF0ICVkXG4iLAo+ICsJCQkJICAgICAgIHByaW8sIHJxX3ByaW8ocnEp
ID4+IEk5MTVfVVNFUl9QUklPUklUWV9TSElGVCk7Cj4gKwkJCQlpbnRlbF9lbmdpbmVfZHVtcChl
bmdpbmUsICZwLAo+ICsJCQkJCQkgICIlc1xuIiwgZW5naW5lLT5uYW1lKTsKPiArCj4gKwkJCQll
cnIgPSAtRVRJTUU7Cj4gKwkJCX0KPiArCj4gKwkJCWk5MTVfcmVxdWVzdF9wdXQocnEpOwo+ICsJ
CQlycSA9IG47Cj4gKwkJfQo+ICsKPiArCQlpZiAoaWd0X2xpdmVfdGVzdF9lbmQoJnQpKQo+ICsJ
CQllcnIgPSAtRUlPOwo+ICsJCWlmIChlcnIpCj4gKwkJCXJldHVybiBlcnI7Cj4gKwl9Cj4gKwo+
ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gICBzdGF0aWMgaW50IGxpdmVfcHJlZW1wdF9oYW5nKHZv
aWQgKmFyZykKPiAgIHsKPiAgIAlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gYXJnOwo+IEBAIC0zMDI4
LDYgKzMyMjMsNyBAQCBpbnQgaW50ZWxfZXhlY2xpc3RzX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQo+ICAgCQlTVUJURVNUKGxpdmVfc3VwcHJlc3Nfc2VsZl9w
cmVlbXB0KSwKPiAgIAkJU1VCVEVTVChsaXZlX3N1cHByZXNzX3dhaXRfcHJlZW1wdCksCj4gICAJ
CVNVQlRFU1QobGl2ZV9jaGFpbl9wcmVlbXB0KSwKPiArCQlTVUJURVNUKGxpdmVfcHJlZW1wdF9n
YW5nKSwKPiAgIAkJU1VCVEVTVChsaXZlX3ByZWVtcHRfaGFuZyksCj4gICAJCVNVQlRFU1QobGl2
ZV9wcmVlbXB0X3RpbWVvdXQpLAo+ICAgCQlTVUJURVNUKGxpdmVfcHJlZW1wdF9zbW9rZSksCj4g
CgpSZXZpZXdlZC1ieTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4K
ClJlZ2FyZHMsCgpUdnJ0a28KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50
ZWwtZ2Z4

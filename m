Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 344D2C872C
	for <lists+intel-gfx@lfdr.de>; Wed,  2 Oct 2019 13:22:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 59B876E952;
	Wed,  2 Oct 2019 11:22:07 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 53BDD6E93B
 for <intel-gfx@lists.freedesktop.org>; Wed,  2 Oct 2019 11:22:00 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18692038-1500050 
 for multiple; Wed, 02 Oct 2019 12:20:11 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  2 Oct 2019 12:19:53 +0100
Message-Id: <20191002112000.12280-23-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191002112000.12280-1-chris@chris-wilson.co.uk>
References: <20191002112000.12280-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 23/30] drm/i915: Move context management under
 GEM
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

S2VlcCB0cmFjayBvZiB0aGUgR0VNIGNvbnRleHRzIHVuZGVybmVhdGggaTkxNS0+Z2VtLmNvbnRl
eHRzIGFuZCBhc3NpZ24KdGhlbSB0aGVpciBvd24gbG9jayBmb3IgdGhlIHB1cnBvc2VzIG9mIGxp
c3QgbWFuYWdlbWVudC4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMt
d2lsc29uLmNvLnVrPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNv
bT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jICAgfCAx
NTUgKysrKysrKy0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
Y29udGV4dC5oICAgfCAgIDQgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRl
eHRfdHlwZXMuaCB8ICAgMiArLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1
ZmZlci5jICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNl
cnB0ci5jICAgfCAgIDIgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3Bh
Z2VzLmMgICB8ICAxMiArLQogLi4uL2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29u
dGV4dC5jIHwgMTQzICsrKysrKystLS0tLS0tLS0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0
ZXN0cy9tb2NrX2NvbnRleHQuYyB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfY29udGV4dC5jICAgICAgIHwgICA4ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9scmMuYyAgICAgICAgICAgfCAgIDUgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRl
c3RfY29udGV4dC5jICAgIHwgIDI0ICstLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRl
c3RfaGFuZ2NoZWNrLmMgIHwgIDE5ICstLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRl
c3RfbHJjLmMgICAgICAgIHwgICA0ICstCiAuLi4vZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dv
cmthcm91bmRzLmMgICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hlZHVs
ZXIuYyAgICAgICAgICB8ICAyMCArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdm
cy5jICAgICAgICAgICB8ICA1MCArKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2
LmMgICAgICAgICAgICAgICB8ICAgMiAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5o
ICAgICAgICAgICAgICAgfCAgMjcgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5j
ICAgICAgICAgICAgICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0
dC5jICAgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMg
ICAgICAgICAgICAgIHwgIDI0ICsrLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5j
ICAgICAgICAgICAgIHwgIDc3ICsrKystLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90
cmFjZS5oICAgICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvaTkxNV9nZW0uYyAgICAgfCAgIDggLQogLi4uL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkx
NV9nZW1fZXZpY3QuYyAgIHwgICAzIC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9p
OTE1X2dlbV9ndHQuYyB8ICAgNiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfcmVxdWVzdC5jIHwgIDExICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkx
NV92bWEuYyAgICAgfCAgIDUgKy0KIC4uLi9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2Vt
X2RldmljZS5jICB8ICAgNiArLQogMjkgZmlsZXMgY2hhbmdlZCwgMjg2IGluc2VydGlvbnMoKyks
IDM2MyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2Nv
bnRleHQuYwppbmRleCA0ZTU5YjgwOWQ5MDEuLmE3N2Y0MzkzNThkNyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCkBAIC0yMTksOSArMjE5LDEyIEBAIHN0
YXRpYyBzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lcyAqZGVmYXVsdF9lbmdpbmVzKHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgpCiAKIHN0YXRpYyB2b2lkIGk5MTVfZ2VtX2NvbnRleHRfZnJlZShz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogewotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmN0
eC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJR0VNX0JVR19PTighaTkxNV9nZW1fY29udGV4
dF9pc19jbG9zZWQoY3R4KSk7CiAKKwlzcGluX2xvY2soJmN0eC0+aTkxNS0+Z2VtLmNvbnRleHRz
LmxvY2spOworCWxpc3RfZGVsKCZjdHgtPmxpbmspOworCXNwaW5fdW5sb2NrKCZjdHgtPmk5MTUt
PmdlbS5jb250ZXh0cy5sb2NrKTsKKwogCWZyZWVfZW5naW5lcyhyY3VfYWNjZXNzX3BvaW50ZXIo
Y3R4LT5lbmdpbmVzKSk7CiAJbXV0ZXhfZGVzdHJveSgmY3R4LT5lbmdpbmVzX211dGV4KTsKIApA
QCAtMjMxLDU2ICsyMzQsNDAgQEAgc3RhdGljIHZvaWQgaTkxNV9nZW1fY29udGV4dF9mcmVlKHN0
cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJa2ZyZWUoY3R4LT5uYW1lKTsKIAlwdXRfcGlk
KGN0eC0+cGlkKTsKIAotCWxpc3RfZGVsKCZjdHgtPmxpbmspOwogCW11dGV4X2Rlc3Ryb3koJmN0
eC0+bXV0ZXgpOwogCiAJa2ZyZWVfcmN1KGN0eCwgcmN1KTsKIH0KIAotc3RhdGljIHZvaWQgY29u
dGV4dHNfZnJlZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3N0YXRpYyB2b2lkIGNv
bnRleHRzX2ZyZWVfYWxsKHN0cnVjdCBsbGlzdF9ub2RlICpsaXN0KQogewotCXN0cnVjdCBsbGlz
dF9ub2RlICpmcmVlZCA9IGxsaXN0X2RlbF9hbGwoJmk5MTUtPmNvbnRleHRzLmZyZWVfbGlzdCk7
CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwgKmNuOwogCi0JbG9ja2RlcF9hc3NlcnRf
aGVsZCgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KLQlsbGlzdF9mb3JfZWFjaF9lbnRyeV9z
YWZlKGN0eCwgY24sIGZyZWVkLCBmcmVlX2xpbmspCisJbGxpc3RfZm9yX2VhY2hfZW50cnlfc2Fm
ZShjdHgsIGNuLCBsaXN0LCBmcmVlX2xpbmspCiAJCWk5MTVfZ2VtX2NvbnRleHRfZnJlZShjdHgp
OwogfQogCi1zdGF0aWMgdm9pZCBjb250ZXh0c19mcmVlX2ZpcnN0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQorc3RhdGljIHZvaWQgY29udGV4dHNfZmx1c2hfZnJlZShzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dHMgKmdjKQogewotCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Ci0J
c3RydWN0IGxsaXN0X25vZGUgKmZyZWVkOwotCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7Ci0KLQlmcmVlZCA9IGxsaXN0X2RlbF9maXJzdCgmaTkxNS0+Y29u
dGV4dHMuZnJlZV9saXN0KTsKLQlpZiAoIWZyZWVkKQotCQlyZXR1cm47Ci0KLQljdHggPSBjb250
YWluZXJfb2YoZnJlZWQsIHR5cGVvZigqY3R4KSwgZnJlZV9saW5rKTsKLQlpOTE1X2dlbV9jb250
ZXh0X2ZyZWUoY3R4KTsKKwljb250ZXh0c19mcmVlX2FsbChsbGlzdF9kZWxfYWxsKCZnYy0+ZnJl
ZV9saXN0KSk7CiB9CiAKIHN0YXRpYyB2b2lkIGNvbnRleHRzX2ZyZWVfd29ya2VyKHN0cnVjdCB3
b3JrX3N0cnVjdCAqd29yaykKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9Ci0J
CWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmk5MTUpLCBjb250ZXh0cy5mcmVlX3dvcmspOwor
CXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0cyAqZ2MgPQorCQljb250YWluZXJfb2Yod29yaywgdHlw
ZW9mKCpnYyksIGZyZWVfd29yayk7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKLQljb250ZXh0c19mcmVlKGk5MTUpOwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7CisJY29udGV4dHNfZmx1c2hfZnJlZShnYyk7CiB9CiAKIHZvaWQgaTkxNV9n
ZW1fY29udGV4dF9yZWxlYXNlKHN0cnVjdCBrcmVmICpyZWYpCiB7CiAJc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKmN0eCA9IGNvbnRhaW5lcl9vZihyZWYsIHR5cGVvZigqY3R4KSwgcmVmKTsKLQlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkxNTsKKwlzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dHMgKmdjID0gJmN0eC0+aTkxNS0+Z2VtLmNvbnRleHRzOwogCiAJdHJhY2VfaTkx
NV9jb250ZXh0X2ZyZWUoY3R4KTsKLQlpZiAobGxpc3RfYWRkKCZjdHgtPmZyZWVfbGluaywgJmk5
MTUtPmNvbnRleHRzLmZyZWVfbGlzdCkpCi0JCXF1ZXVlX3dvcmsoaTkxNS0+d3EsICZpOTE1LT5j
b250ZXh0cy5mcmVlX3dvcmspOworCWlmIChsbGlzdF9hZGQoJmN0eC0+ZnJlZV9saW5rLCAmZ2Mt
PmZyZWVfbGlzdCkpCisJCXF1ZXVlX3dvcmsoY3R4LT5pOTE1LT53cSwgJmdjLT5mcmVlX3dvcmsp
OwogfQogCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2dlbV9lbmdpbmVzICoKQEAgLTM1OSw4
ICszNDYsOCBAQCBzdGF0aWMgdm9pZCBjb250ZXh0X2Nsb3NlKHN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHgpCiB7CiAJaTkxNV9nZW1fY29udGV4dF9zZXRfY2xvc2VkKGN0eCk7CiAKLQlpZiAo
Y3R4LT52bSkKLQkJaTkxNV92bV9jbG9zZShjdHgtPnZtKTsKKwlpZiAocmN1X2FjY2Vzc19wb2lu
dGVyKGN0eC0+dm0pKQorCQlpOTE1X3ZtX2Nsb3NlKHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQo
Y3R4LT52bSwgdHJ1ZSkpOwogCiAJbXV0ZXhfbG9jaygmY3R4LT5tdXRleCk7CiAKQEAgLTM5NCw3
ICszODEsNiBAQCBfX2NyZWF0ZV9jb250ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KQogCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKIAogCWtyZWZfaW5pdCgmY3R4LT5yZWYpOwot
CWxpc3RfYWRkX3RhaWwoJmN0eC0+bGluaywgJmk5MTUtPmNvbnRleHRzLmxpc3QpOwogCWN0eC0+
aTkxNSA9IGk5MTU7CiAJY3R4LT5zY2hlZC5wcmlvcml0eSA9IEk5MTVfVVNFUl9QUklPUklUWShJ
OTE1X1BSSU9SSVRZX05PUk1BTCk7CiAJbXV0ZXhfaW5pdCgmY3R4LT5tdXRleCk7CkBAIC00MzUs
NiArNDIxLDEwIEBAIF9fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpCiAJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoY3R4LT5oYW5nX3RpbWVzdGFtcCk7IGkr
KykKIAkJY3R4LT5oYW5nX3RpbWVzdGFtcFtpXSA9IGppZmZpZXMgLSBDT05URVhUX0ZBU1RfSEFO
R19KSUZGSUVTOwogCisJc3Bpbl9sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7CisJbGlz
dF9hZGRfdGFpbCgmY3R4LT5saW5rLCAmaTkxNS0+Z2VtLmNvbnRleHRzLmxpc3QpOworCXNwaW5f
dW5sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7CisKIAlyZXR1cm4gY3R4OwogCiBlcnJf
ZnJlZToKQEAgLTQ2NCwxMSArNDU0LDExIEBAIHN0YXRpYyB2b2lkIF9fYXBwbHlfcHBndHQoc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlLCB2b2lkICp2bSkKIHN0YXRpYyBzdHJ1Y3QgaTkxNV9hZGRy
ZXNzX3NwYWNlICoKIF9fc2V0X3BwZ3R0KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsIHN0
cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtKQogewotCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3Bh
Y2UgKm9sZCA9IGN0eC0+dm07CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqb2xkID0gcmN1
X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChjdHgtPnZtLCAxKTsKIAogCUdFTV9CVUdfT04ob2xkICYm
IGk5MTVfdm1faXNfNGx2bCh2bSkgIT0gaTkxNV92bV9pc180bHZsKG9sZCkpOwogCi0JY3R4LT52
bSA9IGk5MTVfdm1fb3Blbih2bSk7CisJcmN1X2Fzc2lnbl9wb2ludGVyKGN0eC0+dm0sIGk5MTVf
dm1fb3Blbih2bSkpOwogCWNvbnRleHRfYXBwbHlfYWxsKGN0eCwgX19hcHBseV9wcGd0dCwgdm0p
OwogCiAJcmV0dXJuIG9sZDsKQEAgLTQ3Nyw3ICs0NjcsNyBAQCBfX3NldF9wcGd0dChzdHJ1Y3Qg
aTkxNV9nZW1fY29udGV4dCAqY3R4LCBzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKIHN0
YXRpYyB2b2lkIF9fYXNzaWduX3BwZ3R0KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiAJ
CQkgICBzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKIHsKLQlpZiAodm0gPT0gY3R4LT52
bSkKKwlpZiAodm0gPT0gcmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pKQogCQlyZXR1cm47CiAK
IAl2bSA9IF9fc2V0X3BwZ3R0KGN0eCwgdm0pOwpAQCAtNTA5LDI3ICs0OTksMjUgQEAgc3RhdGlj
IHZvaWQgX19hc3NpZ25fdGltZWxpbmUoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIH0K
IAogc3RhdGljIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICoKLWk5MTVfZ2VtX2NyZWF0ZV9jb250
ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdW5zaWduZWQgaW50IGZsYWdz
KQoraTkxNV9nZW1fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
IHVuc2lnbmVkIGludCBmbGFncykKIHsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owog
Ci0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJ
aWYgKGZsYWdzICYgSTkxNV9DT05URVhUX0NSRUFURV9GTEFHU19TSU5HTEVfVElNRUxJTkUgJiYK
LQkgICAgIUhBU19FWEVDTElTVFMoZGV2X3ByaXYpKQorCSAgICAhSEFTX0VYRUNMSVNUUyhpOTE1
KSkKIAkJcmV0dXJuIEVSUl9QVFIoLUVJTlZBTCk7CiAKLQkvKiBSZWFwIHRoZSBtb3N0IHN0YWxl
IGNvbnRleHQgKi8KLQljb250ZXh0c19mcmVlX2ZpcnN0KGRldl9wcml2KTsKKwkvKiBSZWFwIHRo
ZSBzdGFsZSBjb250ZXh0cyAqLworCWNvbnRleHRzX2ZsdXNoX2ZyZWUoJmk5MTUtPmdlbS5jb250
ZXh0cyk7CiAKLQljdHggPSBfX2NyZWF0ZV9jb250ZXh0KGRldl9wcml2KTsKKwljdHggPSBfX2Ny
ZWF0ZV9jb250ZXh0KGk5MTUpOwogCWlmIChJU19FUlIoY3R4KSkKIAkJcmV0dXJuIGN0eDsKIAot
CWlmIChIQVNfRlVMTF9QUEdUVChkZXZfcHJpdikpIHsKKwlpZiAoSEFTX0ZVTExfUFBHVFQoaTkx
NSkpIHsKIAkJc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0OwogCi0JCXBwZ3R0ID0gaTkxNV9wcGd0
dF9jcmVhdGUoZGV2X3ByaXYpOworCQlwcGd0dCA9IGk5MTVfcHBndHRfY3JlYXRlKGk5MTUpOwog
CQlpZiAoSVNfRVJSKHBwZ3R0KSkgewogCQkJRFJNX0RFQlVHX0RSSVZFUigiUFBHVFQgc2V0dXAg
ZmFpbGVkICglbGQpXG4iLAogCQkJCQkgUFRSX0VSUihwcGd0dCkpOwpAQCAtNTQ0LDcgKzUzMiw3
IEBAIGk5MTVfZ2VtX2NyZWF0ZV9jb250ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwgdW5zaWduZWQgaW50IGZsYWdzKQogCWlmIChmbGFncyAmIEk5MTVfQ09OVEVYVF9DUkVB
VEVfRkxBR1NfU0lOR0xFX1RJTUVMSU5FKSB7CiAJCXN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGlt
ZWxpbmU7CiAKLQkJdGltZWxpbmUgPSBpbnRlbF90aW1lbGluZV9jcmVhdGUoJmRldl9wcml2LT5n
dCwgTlVMTCk7CisJCXRpbWVsaW5lID0gaW50ZWxfdGltZWxpbmVfY3JlYXRlKCZpOTE1LT5ndCwg
TlVMTCk7CiAJCWlmIChJU19FUlIodGltZWxpbmUpKSB7CiAJCQljb250ZXh0X2Nsb3NlKGN0eCk7
CiAJCQlyZXR1cm4gRVJSX0NBU1QodGltZWxpbmUpOwpAQCAtNTkwLDQ4ICs1NzgsNDAgQEAgaTkx
NV9nZW1fY29udGV4dF9jcmVhdGVfa2VybmVsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LCBpbnQgcHJpbykKIAlyZXR1cm4gY3R4OwogfQogCi1zdGF0aWMgdm9pZCBpbml0X2NvbnRleHRz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQorc3RhdGljIHZvaWQgaW5pdF9jb250ZXh0
cyhzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dHMgKmdjKQogewotCW11dGV4X2luaXQoJmk5MTUtPmNv
bnRleHRzLm11dGV4KTsKLQlJTklUX0xJU1RfSEVBRCgmaTkxNS0+Y29udGV4dHMubGlzdCk7Ci0K
LQkvKiBVc2luZyB0aGUgc2ltcGxlIGlkYSBpbnRlcmZhY2UsIHRoZSBtYXggaXMgbGltaXRlZCBi
eSBzaXplb2YoaW50KSAqLwotCUJVSUxEX0JVR19PTihNQVhfQ09OVEVYVF9IV19JRCA+IElOVF9N
QVgpOwotCUJVSUxEX0JVR19PTihHRU4xMV9NQVhfQ09OVEVYVF9IV19JRCA+IElOVF9NQVgpOwot
CWlkYV9pbml0KCZpOTE1LT5jb250ZXh0cy5od19pZGEpOwotCUlOSVRfTElTVF9IRUFEKCZpOTE1
LT5jb250ZXh0cy5od19pZF9saXN0KTsKKwlzcGluX2xvY2tfaW5pdCgmZ2MtPmxvY2spOworCUlO
SVRfTElTVF9IRUFEKCZnYy0+bGlzdCk7CiAKLQlJTklUX1dPUksoJmk5MTUtPmNvbnRleHRzLmZy
ZWVfd29yaywgY29udGV4dHNfZnJlZV93b3JrZXIpOwotCWluaXRfbGxpc3RfaGVhZCgmaTkxNS0+
Y29udGV4dHMuZnJlZV9saXN0KTsKKwlJTklUX1dPUksoJmdjLT5mcmVlX3dvcmssIGNvbnRleHRz
X2ZyZWVfd29ya2VyKTsKKwlpbml0X2xsaXN0X2hlYWQoJmdjLT5mcmVlX2xpc3QpOwogfQogCi1p
bnQgaTkxNV9nZW1fY29udGV4dHNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCitpbnQgaTkxNV9nZW1faW5pdF9jb250ZXh0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKIHsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OwogCiAJLyogUmVhc3N1cmUg
b3Vyc2VsdmVzIHdlIGFyZSBvbmx5IGNhbGxlZCBvbmNlICovCi0JR0VNX0JVR19PTihkZXZfcHJp
di0+a2VybmVsX2NvbnRleHQpOworCUdFTV9CVUdfT04oaTkxNS0+a2VybmVsX2NvbnRleHQpOwog
Ci0JaW5pdF9jb250ZXh0cyhkZXZfcHJpdik7CisJaW5pdF9jb250ZXh0cygmaTkxNS0+Z2VtLmNv
bnRleHRzKTsKIAogCS8qIGxvd2VzdCBwcmlvcml0eTsgaWRsZSB0YXNrICovCi0JY3R4ID0gaTkx
NV9nZW1fY29udGV4dF9jcmVhdGVfa2VybmVsKGRldl9wcml2LCBJOTE1X1BSSU9SSVRZX01JTik7
CisJY3R4ID0gaTkxNV9nZW1fY29udGV4dF9jcmVhdGVfa2VybmVsKGk5MTUsIEk5MTVfUFJJT1JJ
VFlfTUlOKTsKIAlpZiAoSVNfRVJSKGN0eCkpIHsKIAkJRFJNX0VSUk9SKCJGYWlsZWQgdG8gY3Jl
YXRlIGRlZmF1bHQgZ2xvYmFsIGNvbnRleHRcbiIpOwogCQlyZXR1cm4gUFRSX0VSUihjdHgpOwog
CX0KLQlkZXZfcHJpdi0+a2VybmVsX2NvbnRleHQgPSBjdHg7CisJaTkxNS0+a2VybmVsX2NvbnRl
eHQgPSBjdHg7CiAKIAlEUk1fREVCVUdfRFJJVkVSKCIlcyBjb250ZXh0IHN1cHBvcnQgaW5pdGlh
bGl6ZWRcbiIsCi0JCQkgRFJJVkVSX0NBUFMoZGV2X3ByaXYpLT5oYXNfbG9naWNhbF9jb250ZXh0
cyA/CisJCQkgRFJJVkVSX0NBUFMoaTkxNSktPmhhc19sb2dpY2FsX2NvbnRleHRzID8KIAkJCSAi
bG9naWNhbCIgOiAiZmFrZSIpOwogCXJldHVybiAwOwogfQogCi12b2lkIGk5MTVfZ2VtX2NvbnRl
eHRzX2Zpbmkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCit2b2lkIGk5MTVfZ2VtX2Ry
aXZlcl9yZWxlYXNlX19jb250ZXh0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsK
LQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWRlc3Ry
b3lfa2VybmVsX2NvbnRleHQoJmk5MTUtPmtlcm5lbF9jb250ZXh0KTsKIH0KIApAQCAtNjUzLDgg
KzYzMyw4IEBAIHN0YXRpYyBpbnQgZ2VtX2NvbnRleHRfcmVnaXN0ZXIoc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKmN0eCwKIAlpbnQgcmV0OwogCiAJY3R4LT5maWxlX3ByaXYgPSBmcHJpdjsKLQlp
ZiAoY3R4LT52bSkKLQkJY3R4LT52bS0+ZmlsZSA9IGZwcml2OworCWlmIChyY3VfYWNjZXNzX3Bv
aW50ZXIoY3R4LT52bSkpCisJCXJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQoY3R4LT52bSwgdHJ1
ZSktPmZpbGUgPSBmcHJpdjsKIAogCWN0eC0+cGlkID0gZ2V0X3Rhc2tfcGlkKGN1cnJlbnQsIFBJ
RFRZUEVfUElEKTsKIAljdHgtPm5hbWUgPSBrYXNwcmludGYoR0ZQX0tFUk5FTCwgIiVzWyVkXSIs
CkBAIC02OTEsOSArNjcxLDcgQEAgaW50IGk5MTVfZ2VtX2NvbnRleHRfb3BlbihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlpZHJfaW5pdCgmZmlsZV9wcml2LT5jb250ZXh0X2lkcik7
CiAJaWRyX2luaXRfYmFzZSgmZmlsZV9wcml2LT52bV9pZHIsIDEpOwogCi0JbXV0ZXhfbG9jaygm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJY3R4ID0gaTkxNV9nZW1fY3JlYXRlX2NvbnRleHQo
aTkxNSwgMCk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlpZiAo
SVNfRVJSKGN0eCkpIHsKIAkJZXJyID0gUFRSX0VSUihjdHgpOwogCQlnb3RvIGVycjsKQEAgLTcy
MSw2ICs2OTksNyBAQCBpbnQgaTkxNV9nZW1fY29udGV4dF9vcGVuKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAogdm9pZCBpOTE1X2dlbV9jb250ZXh0X2Nsb3NlKHN0cnVjdCBkcm1fZmls
ZSAqZmlsZSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYgPSBm
aWxlLT5kcml2ZXJfcHJpdjsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGZpbGVf
cHJpdi0+ZGV2X3ByaXY7CiAKIAlpZHJfZm9yX2VhY2goJmZpbGVfcHJpdi0+Y29udGV4dF9pZHIs
IGNvbnRleHRfaWRyX2NsZWFudXAsIE5VTEwpOwogCWlkcl9kZXN0cm95KCZmaWxlX3ByaXYtPmNv
bnRleHRfaWRyKTsKQEAgLTcyOSw2ICs3MDgsOCBAQCB2b2lkIGk5MTVfZ2VtX2NvbnRleHRfY2xv
c2Uoc3RydWN0IGRybV9maWxlICpmaWxlKQogCWlkcl9mb3JfZWFjaCgmZmlsZV9wcml2LT52bV9p
ZHIsIHZtX2lkcl9jbGVhbnVwLCBOVUxMKTsKIAlpZHJfZGVzdHJveSgmZmlsZV9wcml2LT52bV9p
ZHIpOwogCW11dGV4X2Rlc3Ryb3koJmZpbGVfcHJpdi0+dm1faWRyX2xvY2spOworCisJY29udGV4
dHNfZmx1c2hfZnJlZSgmaTkxNS0+Z2VtLmNvbnRleHRzKTsKIH0KIAogaW50IGk5MTVfZ2VtX3Zt
X2NyZWF0ZV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLApAQCAtOTA3
LDE2ICs4ODgsMTIgQEAgc3RhdGljIGludCBnZXRfcHBndHQoc3RydWN0IGRybV9pOTE1X2ZpbGVf
cHJpdmF0ZSAqZmlsZV9wcml2LAogCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwogCWlu
dCByZXQ7CiAKLQlpZiAoIWN0eC0+dm0pCisJaWYgKCFyY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52
bSkpCiAJCXJldHVybiAtRU5PREVWOwogCi0JLyogWFhYIHJjdSBhY3F1aXJlPyAqLwotCXJldCA9
IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmY3R4LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
LQlpZiAocmV0KQotCQlyZXR1cm4gcmV0OwotCisJcmN1X3JlYWRfbG9jaygpOwogCXZtID0gaTkx
NV92bV9nZXQoY3R4LT52bSk7Ci0JbXV0ZXhfdW5sb2NrKCZjdHgtPmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOworCXJjdV9yZWFkX3VubG9jaygpOwogCiAJcmV0ID0gbXV0ZXhfbG9ja19pbnRlcnJ1
cHRpYmxlKCZmaWxlX3ByaXYtPnZtX2lkcl9sb2NrKTsKIAlpZiAocmV0KQpAQCAtMTAyNSw3ICsx
MDAyLDcgQEAgc3RhdGljIGludCBzZXRfcHBndHQoc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0
ZSAqZmlsZV9wcml2LAogCWlmIChhcmdzLT5zaXplKQogCQlyZXR1cm4gLUVJTlZBTDsKIAotCWlm
ICghY3R4LT52bSkKKwlpZiAoIXJjdV9hY2Nlc3NfcG9pbnRlcihjdHgtPnZtKSkKIAkJcmV0dXJu
IC1FTk9ERVY7CiAKIAlpZiAodXBwZXJfMzJfYml0cyhhcmdzLT52YWx1ZSkpCkBAIC0xMDM5LDE3
ICsxMDE2LDE1IEBAIHN0YXRpYyBpbnQgc2V0X3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9maWxlX3By
aXZhdGUgKmZpbGVfcHJpdiwKIAlpZiAoIXZtKQogCQlyZXR1cm4gLUVOT0VOVDsKIAotCWVyciA9
IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmY3R4LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
KwllcnIgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmN0eC0+bXV0ZXgpOwogCWlmIChlcnIp
CiAJCWdvdG8gb3V0OwogCi0JaWYgKHZtID09IGN0eC0+dm0pCisJaWYgKHZtID09IHJjdV9hY2Nl
c3NfcG9pbnRlcihjdHgtPnZtKSkKIAkJZ290byB1bmxvY2s7CiAKIAkvKiBUZWFyZG93biB0aGUg
ZXhpc3Rpbmcgb2JqOnZtYSBjYWNoZSwgaXQgd2lsbCBoYXZlIHRvIGJlIHJlYnVpbHQuICovCi0J
bXV0ZXhfbG9jaygmY3R4LT5tdXRleCk7CiAJbHV0X2Nsb3NlKGN0eCk7Ci0JbXV0ZXhfdW5sb2Nr
KCZjdHgtPm11dGV4KTsKIAogCW9sZCA9IF9fc2V0X3BwZ3R0KGN0eCwgdm0pOwogCkBAIC0xMDY5
LDggKzEwNDQsNyBAQCBzdGF0aWMgaW50IHNldF9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9w
cml2YXRlICpmaWxlX3ByaXYsCiAJfQogCiB1bmxvY2s6Ci0JbXV0ZXhfdW5sb2NrKCZjdHgtPmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCisJbXV0ZXhfdW5sb2NrKCZjdHgtPm11dGV4KTsKIG91
dDoKIAlpOTE1X3ZtX3B1dCh2bSk7CiAJcmV0dXJuIGVycjsKQEAgLTE5NTMsNyArMTkyNyw3IEBA
IHN0YXRpYyBpbnQgY2xvbmVfdm0oc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmRzdCwKIAogCXJj
dV9yZWFkX2xvY2soKTsKIAlkbyB7Ci0JCXZtID0gUkVBRF9PTkNFKHNyYy0+dm0pOworCQl2bSA9
IHJjdV9kZXJlZmVyZW5jZShzcmMtPnZtKTsKIAkJaWYgKCF2bSkKIAkJCWJyZWFrOwogCkBAIC0x
OTc1LDcgKzE5NDksNyBAQCBzdGF0aWMgaW50IGNsb25lX3ZtKHN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpkc3QsCiAJCSAqIGl0IGNhbm5vdCBiZSByZWFsbG9jYXRlZCBlbHNld2hlcmUuCiAJCSAq
LwogCi0JCWlmICh2bSA9PSBSRUFEX09OQ0Uoc3JjLT52bSkpCisJCWlmICh2bSA9PSByY3VfYWNj
ZXNzX3BvaW50ZXIoc3JjLT52bSkpCiAJCQlicmVhazsKIAogCQlpOTE1X3ZtX3B1dCh2bSk7CkBA
IC0yMDc3LDEyICsyMDUxLDcgQEAgaW50IGk5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2lvY3RsKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJCXJldHVybiAtRUlPOwogCX0KIAot
CXJldCA9IGk5MTVfbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKGRldik7Ci0JaWYgKHJldCkKLQkJ
cmV0dXJuIHJldDsKLQogCWV4dF9kYXRhLmN0eCA9IGk5MTVfZ2VtX2NyZWF0ZV9jb250ZXh0KGk5
MTUsIGFyZ3MtPmZsYWdzKTsKLQltdXRleF91bmxvY2soJmRldi0+c3RydWN0X211dGV4KTsKIAlp
ZiAoSVNfRVJSKGV4dF9kYXRhLmN0eCkpCiAJCXJldHVybiBQVFJfRVJSKGV4dF9kYXRhLmN0eCk7
CiAKQEAgLTIyMDksMTAgKzIxNzgsMTIgQEAgaW50IGk5MTVfZ2VtX2NvbnRleHRfZ2V0cGFyYW1f
aW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAogCWNhc2UgSTkxNV9D
T05URVhUX1BBUkFNX0dUVF9TSVpFOgogCQlhcmdzLT5zaXplID0gMDsKLQkJaWYgKGN0eC0+dm0p
Ci0JCQlhcmdzLT52YWx1ZSA9IGN0eC0+dm0tPnRvdGFsOworCQlyY3VfcmVhZF9sb2NrKCk7CisJ
CWlmIChyY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpCisJCQlhcmdzLT52YWx1ZSA9IHJjdV9k
ZXJlZmVyZW5jZShjdHgtPnZtKS0+dG90YWw7CiAJCWVsc2UKIAkJCWFyZ3MtPnZhbHVlID0gdG9f
aTkxNShkZXYpLT5nZ3R0LnZtLnRvdGFsOworCQlyY3VfcmVhZF91bmxvY2soKTsKIAkJYnJlYWs7
CiAKIAljYXNlIEk5MTVfQ09OVEVYVF9QQVJBTV9OT19FUlJPUl9DQVBUVVJFOgpAQCAtMjI4Myw3
ICsyMjU0LDcgQEAgaW50IGk5MTVfZ2VtX2NvbnRleHRfc2V0cGFyYW1faW9jdGwoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIGludCBpOTE1X2dlbV9jb250ZXh0X3Jlc2V0X3N0
YXRzX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCiAJCQkJICAgICAgIHZvaWQgKmRhdGEs
IHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYgPSB0b19pOTE1KGRldik7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0
b19pOTE1KGRldik7CiAJc3RydWN0IGRybV9pOTE1X3Jlc2V0X3N0YXRzICphcmdzID0gZGF0YTsK
IAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OwogCWludCByZXQ7CkBAIC0yMzA1LDcgKzIy
NzYsNyBAQCBpbnQgaTkxNV9nZW1fY29udGV4dF9yZXNldF9zdGF0c19pb2N0bChzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LAogCSAqLwogCiAJaWYgKGNhcGFibGUoQ0FQX1NZU19BRE1JTikpCi0JCWFy
Z3MtPnJlc2V0X2NvdW50ID0gaTkxNV9yZXNldF9jb3VudCgmZGV2X3ByaXYtPmdwdV9lcnJvcik7
CisJCWFyZ3MtPnJlc2V0X2NvdW50ID0gaTkxNV9yZXNldF9jb3VudCgmaTkxNS0+Z3B1X2Vycm9y
KTsKIAllbHNlCiAJCWFyZ3MtPnJlc2V0X2NvdW50ID0gMDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKaW5kZXggMWIwZGY1MzQzNmNmLi40ZWU1ZGZjNTc5
NGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0
LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaApAQCAt
MTMzLDggKzEzMyw4IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBpOTE1X2dlbV9jb250ZXh0X2lzX2tl
cm5lbChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogfQogCiAvKiBpOTE1X2dlbV9jb250
ZXh0LmMgKi8KLWludCBfX211c3RfY2hlY2sgaTkxNV9nZW1fY29udGV4dHNfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBpOTE1X2dlbV9jb250ZXh0c19maW5p
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CitpbnQgX19tdXN0X2NoZWNrIGk5
MTVfZ2VtX2luaXRfY29udGV4dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwordm9p
ZCBpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZV9fY29udGV4dHMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpOwogCiBpbnQgaTkxNV9nZW1fY29udGV4dF9vcGVuKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAogCQkJICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmgKaW5kZXggNjQxOWRh
N2M5ZjkwLi5hM2VjZDE5ZjIzMDMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaApAQCAtODgsNyArODgsNyBAQCBzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dCB7CiAJICogSW4gb3RoZXIgbW9kZXMsIHRoaXMgaXMgYSBOVUxMIHBvaW50ZXIg
d2l0aCB0aGUgZXhwZWN0YXRpb24gdGhhdAogCSAqIHRoZSBjYWxsZXIgdXNlcyB0aGUgc2hhcmVk
IGdsb2JhbCBHVFQuCiAJICovCi0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07CisJc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSBfX3JjdSAqdm07CiAKIAkvKioKIAkgKiBAcGlkOiBwcm9j
ZXNzIGlkIG9mIGNyZWF0b3IKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9leGVjYnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
ZXhlY2J1ZmZlci5jCmluZGV4IDg4YTg4MWJlMTJlYy4uOTg4MTZjMzVmZmMzIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKQEAgLTcyOCw3ICs3
MjgsNyBAQCBzdGF0aWMgaW50IGViX3NlbGVjdF9jb250ZXh0KHN0cnVjdCBpOTE1X2V4ZWNidWZm
ZXIgKmViKQogCQlyZXR1cm4gLUVOT0VOVDsKIAogCWViLT5nZW1fY29udGV4dCA9IGN0eDsKLQlp
ZiAoY3R4LT52bSkKKwlpZiAocmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pKQogCQllYi0+aW52
YWxpZF9mbGFncyB8PSBFWEVDX09CSkVDVF9ORUVEU19HVFQ7CiAKIAllYi0+Y29udGV4dF9mbGFn
cyA9IDA7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNl
cnB0ci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYwppbmRl
eCAxNzM4YTE1ZWI5MTEuLjZkMzA5NTVjYjAyMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fdXNlcnB0ci5jCkBAIC03NTgsNyArNzU4LDcgQEAgaTkxNV9nZW1fdXNlcnB0
cl9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkgKiBPbiBhbG1vc3QgYWxsIG9mIHRo
ZSBvbGRlciBodywgd2UgY2Fubm90IHRlbGwgdGhlIEdQVSB0aGF0CiAJCSAqIGEgcGFnZSBpcyBy
ZWFkb25seS4KIAkJICovCi0JCXZtID0gZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0LT52bTsKKwkJ
dm0gPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKGRldl9wcml2LT5rZXJuZWxfY29udGV4dC0+
dm0sIHRydWUpOwogCQlpZiAoIXZtIHx8ICF2bS0+aGFzX3JlYWRfb25seSkKIAkJCXJldHVybiAt
RU5PREVWOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVz
dHMvaHVnZV9wYWdlcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdl
X3BhZ2VzLmMKaW5kZXggOThiMmE2Y2NmY2MxLi5lMjA0ZTY1M2I0NTkgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaHVnZV9wYWdlcy5jCkBAIC0xMzIyLDcgKzEz
MjIsNyBAQCBzdGF0aWMgaW50IGlndF9wcGd0dF9waW5fdXBkYXRlKHZvaWQgKmFyZykKIAlzdHJ1
Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gYXJnOwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiA9IGN0eC0+aTkxNTsKIAl1bnNpZ25lZCBsb25nIHN1cHBvcnRlZCA9IElOVEVM
X0lORk8oZGV2X3ByaXYpLT5wYWdlX3NpemVzOwotCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2Ug
KnZtID0gY3R4LT52bTsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IHJjdV9kZXJl
ZmVyZW5jZV9wcm90ZWN0ZWQoY3R4LT52bSwgMSk7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgKm9iajsKIAlzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVyIGl0OwogCXN0cnVjdCBpbnRl
bF9jb250ZXh0ICpjZTsKQEAgLTE0NjAsNyArMTQ2MCw4IEBAIHN0YXRpYyBpbnQgaWd0X3RtcGZz
X2ZhbGxiYWNrKHZvaWQgKmFyZykKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gYXJn
OwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY3R4LT5pOTE1OwogCXN0cnVjdCB2
ZnNtb3VudCAqZ2VtZnMgPSBpOTE1LT5tbS5nZW1mczsKLQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3Nw
YWNlICp2bSA9IGN0eC0+dm0gPzogJmk5MTUtPmdndHQudm07CisJc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqdm0gPQorCQlyY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKGN0eC0+dm0sIHRydWUp
ID86ICZpOTE1LT5nZ3R0LnZtOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CiAJ
c3RydWN0IGk5MTVfdm1hICp2bWE7CiAJdTMyICp2YWRkcjsKQEAgLTE1MTcsNyArMTUxOCw4IEBA
IHN0YXRpYyBpbnQgaWd0X3Nocmlua190aHAodm9pZCAqYXJnKQogewogCXN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHggPSBhcmc7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBj
dHgtPmk5MTU7Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBjdHgtPnZtID86ICZp
OTE1LT5nZ3R0LnZtOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0KKwkJcmN1X2Rl
cmVmZXJlbmNlX3Byb3RlY3RlZChjdHgtPnZtLCB0cnVlKSA/OiAmaTkxNS0+Z2d0dC52bTsKIAlz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwogCXN0cnVjdCBpOTE1X2dlbV9lbmdpbmVz
X2l0ZXIgaXQ7CiAJc3RydWN0IGludGVsX2NvbnRleHQgKmNlOwpAQCAtMTY5OSw4ICsxNzAxLDgg
QEAgaW50IGk5MTVfZ2VtX2h1Z2VfcGFnZV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KIAotCWlmIChjdHgtPnZtKQot
CQljdHgtPnZtLT5zY3J1Yl82NEsgPSB0cnVlOworCWlmIChyY3VfYWNjZXNzX3BvaW50ZXIoY3R4
LT52bSkpCisJCXJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQoY3R4LT52bSwgdHJ1ZSktPnNjcnVi
XzY0SyA9IHRydWU7CiAKIAllcnIgPSBpOTE1X3N1YnRlc3RzKHRlc3RzLCBjdHgpOwogCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRl
eHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4
dC5jCmluZGV4IDJmYjMxYWRhMmZhNy4uZmZlZGM2N2Y1YzNkIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYwpAQCAtNTMs
MTkgKzUzLDE3IEBAIHN0YXRpYyBpbnQgbGl2ZV9ub3Bfc3dpdGNoKHZvaWQgKmFyZykKIAlpZiAo
SVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJY3R4ID0ga2NhbGxvYyhuY3R4LCBzaXplb2YoKmN0
eCksIEdGUF9LRVJORUwpOwogCWlmICghY3R4KSB7CiAJCWVyciA9IC1FTk9NRU07Ci0JCWdvdG8g
b3V0X3VubG9jazsKKwkJZ290byBvdXRfZmlsZTsKIAl9CiAKIAlmb3IgKG4gPSAwOyBuIDwgbmN0
eDsgbisrKSB7CiAJCWN0eFtuXSA9IGxpdmVfY29udGV4dChpOTE1LCBmaWxlKTsKIAkJaWYgKElT
X0VSUihjdHhbbl0pKSB7CiAJCQllcnIgPSBQVFJfRVJSKGN0eFtuXSk7Ci0JCQlnb3RvIG91dF91
bmxvY2s7CisJCQlnb3RvIG91dF9maWxlOwogCQl9CiAJfQogCkBAIC03OSw3ICs3Nyw3IEBAIHN0
YXRpYyBpbnQgbGl2ZV9ub3Bfc3dpdGNoKHZvaWQgKmFyZykKIAkJCXJxID0gaWd0X3JlcXVlc3Rf
YWxsb2MoY3R4W25dLCBlbmdpbmUpOwogCQkJaWYgKElTX0VSUihycSkpIHsKIAkJCQllcnIgPSBQ
VFJfRVJSKHJxKTsKLQkJCQlnb3RvIG91dF91bmxvY2s7CisJCQkJZ290byBvdXRfZmlsZTsKIAkJ
CX0KIAkJCWk5MTVfcmVxdWVzdF9hZGQocnEpOwogCQl9CkBAIC04Nyw3ICs4NSw3IEBAIHN0YXRp
YyBpbnQgbGl2ZV9ub3Bfc3dpdGNoKHZvaWQgKmFyZykKIAkJCXByX2VycigiRmFpbGVkIHRvIHBv
cHVsYXRlZCAlZCBjb250ZXh0c1xuIiwgbmN0eCk7CiAJCQlpbnRlbF9ndF9zZXRfd2VkZ2VkKCZp
OTE1LT5ndCk7CiAJCQllcnIgPSAtRUlPOwotCQkJZ290byBvdXRfdW5sb2NrOworCQkJZ290byBv
dXRfZmlsZTsKIAkJfQogCiAJCXRpbWVzWzFdID0ga3RpbWVfZ2V0X3JhdygpOwpAQCAtOTcsNyAr
OTUsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICphcmcpCiAKIAkJZXJyID0g
aWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19mdW5jX18sIGVuZ2luZS0+bmFtZSk7CiAJ
CWlmIChlcnIpCi0JCQlnb3RvIG91dF91bmxvY2s7CisJCQlnb3RvIG91dF9maWxlOwogCiAJCWVu
ZF90aW1lID0gamlmZmllcyArIGk5MTVfc2VsZnRlc3QudGltZW91dF9qaWZmaWVzOwogCQlmb3Jf
ZWFjaF9wcmltZV9udW1iZXJfZnJvbShwcmltZSwgMiwgODE5MikgewpAQCAtMTA3LDcgKzEwNSw3
IEBAIHN0YXRpYyBpbnQgbGl2ZV9ub3Bfc3dpdGNoKHZvaWQgKmFyZykKIAkJCQlycSA9IGlndF9y
ZXF1ZXN0X2FsbG9jKGN0eFtuICUgbmN0eF0sIGVuZ2luZSk7CiAJCQkJaWYgKElTX0VSUihycSkp
IHsKIAkJCQkJZXJyID0gUFRSX0VSUihycSk7Ci0JCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQkJ
Z290byBvdXRfZmlsZTsKIAkJCQl9CiAKIAkJCQkvKgpAQCAtMTQzLDcgKzE0MSw3IEBAIHN0YXRp
YyBpbnQgbGl2ZV9ub3Bfc3dpdGNoKHZvaWQgKmFyZykKIAogCQllcnIgPSBpZ3RfbGl2ZV90ZXN0
X2VuZCgmdCk7CiAJCWlmIChlcnIpCi0JCQlnb3RvIG91dF91bmxvY2s7CisJCQlnb3RvIG91dF9m
aWxlOwogCiAJCXByX2luZm8oIlN3aXRjaCBsYXRlbmNpZXMgb24gJXM6IDEgPSAlbGx1bnMsICVs
dSA9ICVsbHVuc1xuIiwKIAkJCWVuZ2luZS0+bmFtZSwKQEAgLTE1MSw4ICsxNDksNyBAQCBzdGF0
aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICphcmcpCiAJCQlwcmltZSAtIDEsIGRpdjY0X3U2
NChrdGltZV90b19ucyh0aW1lc1sxXSksIHByaW1lIC0gMSkpOwogCX0KIAotb3V0X3VubG9jazoK
LQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworb3V0X2ZpbGU6CiAJbW9j
a19maWxlX2ZyZWUoaTkxNSwgZmlsZSk7CiAJcmV0dXJuIGVycjsKIH0KQEAgLTI1MywxMiArMjUw
LDEwIEBAIHN0YXRpYyBpbnQgbGl2ZV9wYXJhbGxlbF9zd2l0Y2godm9pZCAqYXJnKQogCWlmIChJ
U19FUlIoZmlsZSkpCiAJCXJldHVybiBQVFJfRVJSKGZpbGUpOwogCi0JbXV0ZXhfbG9jaygmaTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAljdHggPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7
CiAJaWYgKElTX0VSUihjdHgpKSB7CiAJCWVyciA9IFBUUl9FUlIoY3R4KTsKLQkJZ290byBvdXRf
bG9ja2VkOworCQlnb3RvIG91dF9maWxlOwogCX0KIAogCWVuZ2luZXMgPSBpOTE1X2dlbV9jb250
ZXh0X2xvY2tfZW5naW5lcyhjdHgpOwpAQCAtMjY4LDcgKzI2Myw3IEBAIHN0YXRpYyBpbnQgbGl2
ZV9wYXJhbGxlbF9zd2l0Y2godm9pZCAqYXJnKQogCWlmICghZGF0YSkgewogCQlpOTE1X2dlbV9j
b250ZXh0X3VubG9ja19lbmdpbmVzKGN0eCk7CiAJCWVyciA9IC1FTk9NRU07Ci0JCWdvdG8gb3V0
X2xvY2tlZDsKKwkJZ290byBvdXQ7CiAJfQogCiAJbSA9IDA7IC8qIFVzZSB0aGUgZmlyc3QgY29u
dGV4dCBhcyBvdXIgdGVtcGxhdGUgZm9yIHRoZSBlbmdpbmVzICovCkBAIC0yNzYsNyArMjcxLDcg
QEAgc3RhdGljIGludCBsaXZlX3BhcmFsbGVsX3N3aXRjaCh2b2lkICphcmcpCiAJCWVyciA9IGlu
dGVsX2NvbnRleHRfcGluKGNlKTsKIAkJaWYgKGVycikgewogCQkJaTkxNV9nZW1fY29udGV4dF91
bmxvY2tfZW5naW5lcyhjdHgpOwotCQkJZ290byBvdXRfbG9ja2VkOworCQkJZ290byBvdXQ7CiAJ
CX0KIAkJZGF0YVttKytdLmNlWzBdID0gaW50ZWxfY29udGV4dF9nZXQoY2UpOwogCX0KQEAgLTI4
Nyw3ICsyODIsNyBAQCBzdGF0aWMgaW50IGxpdmVfcGFyYWxsZWxfc3dpdGNoKHZvaWQgKmFyZykK
IAkJY3R4ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCQlpZiAoSVNfRVJSKGN0eCkpIHsK
IAkJCWVyciA9IFBUUl9FUlIoY3R4KTsKLQkJCWdvdG8gb3V0X2xvY2tlZDsKKwkJCWdvdG8gb3V0
OwogCQl9CiAKIAkJZm9yIChtID0gMDsgbSA8IGNvdW50OyBtKyspIHsKQEAgLTI5NiwyMCArMjkx
LDE4IEBAIHN0YXRpYyBpbnQgbGl2ZV9wYXJhbGxlbF9zd2l0Y2godm9pZCAqYXJnKQogCiAJCQlj
ZSA9IGludGVsX2NvbnRleHRfY3JlYXRlKGN0eCwgZGF0YVttXS5jZVswXS0+ZW5naW5lKTsKIAkJ
CWlmIChJU19FUlIoY2UpKQotCQkJCWdvdG8gb3V0X2xvY2tlZDsKKwkJCQlnb3RvIG91dDsKIAog
CQkJZXJyID0gaW50ZWxfY29udGV4dF9waW4oY2UpOwogCQkJaWYgKGVycikgewogCQkJCWludGVs
X2NvbnRleHRfcHV0KGNlKTsKLQkJCQlnb3RvIG91dF9sb2NrZWQ7CisJCQkJZ290byBvdXQ7CiAJ
CQl9CiAKIAkJCWRhdGFbbV0uY2Vbbl0gPSBjZTsKIAkJfQogCX0KIAotCW11dGV4X3VubG9jaygm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAlmb3IgKGZuID0gZnVuYzsgIWVyciAmJiAqZm47
IGZuKyspIHsKIAkJc3RydWN0IGlndF9saXZlX3Rlc3QgdDsKIAkJaW50IG47CkBAIC0zNTQsOCAr
MzQ3LDcgQEAgc3RhdGljIGludCBsaXZlX3BhcmFsbGVsX3N3aXRjaCh2b2lkICphcmcpCiAJCW11
dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJfQogCi0JbXV0ZXhfbG9jaygm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci1vdXRfbG9ja2VkOgorb3V0OgogCWZvciAobiA9IDA7
IG4gPCBjb3VudDsgbisrKSB7CiAJCWZvciAobSA9IDA7IG0gPCBBUlJBWV9TSVpFKGRhdGEtPmNl
KTsgbSsrKSB7CiAJCQlpZiAoIWRhdGFbbl0uY2VbbV0pCkBAIC0zNjUsOCArMzU3LDggQEAgc3Rh
dGljIGludCBsaXZlX3BhcmFsbGVsX3N3aXRjaCh2b2lkICphcmcpCiAJCQlpbnRlbF9jb250ZXh0
X3B1dChkYXRhW25dLmNlW21dKTsKIAkJfQogCX0KLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwogCWtmcmVlKGRhdGEpOworb3V0X2ZpbGU6CiAJbW9ja19maWxlX2ZyZWUo
aTkxNSwgZmlsZSk7CiAJcmV0dXJuIGVycjsKIH0KQEAgLTYyNiwxMSArNjE4LDkgQEAgc3RhdGlj
IGludCBpZ3RfY3R4X2V4ZWModm9pZCAqYXJnKQogCQlpZiAoSVNfRVJSKGZpbGUpKQogCQkJcmV0
dXJuIFBUUl9FUlIoZmlsZSk7CiAKLQkJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7Ci0KIAkJZXJyID0gaWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19mdW5jX18sIGVu
Z2luZS0+bmFtZSk7CiAJCWlmIChlcnIpCi0JCQlnb3RvIG91dF91bmxvY2s7CisJCQlnb3RvIG91
dF9maWxlOwogCiAJCW5jb250ZXh0cyA9IDA7CiAJCW5kd29yZHMgPSAwOwpAQCAtNjQyLDcgKzYz
Miw3IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCWN0eCA9IGtlcm5l
bF9jb250ZXh0KGk5MTUpOwogCQkJaWYgKElTX0VSUihjdHgpKSB7CiAJCQkJZXJyID0gUFRSX0VS
UihjdHgpOwotCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQlnb3RvIG91dF9maWxlOwogCQkJfQog
CiAJCQljZSA9IGk5MTVfZ2VtX2NvbnRleHRfZ2V0X2VuZ2luZShjdHgsIGVuZ2luZS0+bGVnYWN5
X2lkeCk7CkBAIC02NTQsNyArNjQ0LDcgQEAgc3RhdGljIGludCBpZ3RfY3R4X2V4ZWModm9pZCAq
YXJnKQogCQkJCQllcnIgPSBQVFJfRVJSKG9iaik7CiAJCQkJCWludGVsX2NvbnRleHRfcHV0KGNl
KTsKIAkJCQkJa2VybmVsX2NvbnRleHRfY2xvc2UoY3R4KTsKLQkJCQkJZ290byBvdXRfdW5sb2Nr
OworCQkJCQlnb3RvIG91dF9maWxlOwogCQkJCX0KIAkJCX0KIApAQCAtNjYzLDE3ICs2NTMsMTgg
QEAgc3RhdGljIGludCBpZ3RfY3R4X2V4ZWModm9pZCAqYXJnKQogCQkJCXByX2VycigiRmFpbGVk
IHRvIGZpbGwgZHdvcmQgJWx1IFslbHUvJWx1XSB3aXRoIGdwdSAoJXMpIFtmdWxsLXBwZ3R0PyAl
c10sIGVycj0lZFxuIiwKIAkJCQkgICAgICAgbmR3b3JkcywgZHcsIG1heF9kd29yZHMob2JqKSwK
IAkJCQkgICAgICAgZW5naW5lLT5uYW1lLAotCQkJCSAgICAgICB5ZXNubyghIWN0eC0+dm0pLCBl
cnIpOworCQkJCSAgICAgICB5ZXNubyghIXJjdV9hY2Nlc3NfcG9pbnRlcihjdHgtPnZtKSksCisJ
CQkJICAgICAgIGVycik7CiAJCQkJaW50ZWxfY29udGV4dF9wdXQoY2UpOwogCQkJCWtlcm5lbF9j
b250ZXh0X2Nsb3NlKGN0eCk7Ci0JCQkJZ290byBvdXRfdW5sb2NrOworCQkJCWdvdG8gb3V0X2Zp
bGU7CiAJCQl9CiAKIAkJCWVyciA9IHRocm90dGxlKGNlLCB0cSwgQVJSQVlfU0laRSh0cSkpOwog
CQkJaWYgKGVycikgewogCQkJCWludGVsX2NvbnRleHRfcHV0KGNlKTsKIAkJCQlrZXJuZWxfY29u
dGV4dF9jbG9zZShjdHgpOwotCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQlnb3RvIG91dF9maWxl
OwogCQkJfQogCiAJCQlpZiAoKytkdyA9PSBtYXhfZHdvcmRzKG9iaikpIHsKQEAgLTcwMywxMSAr
Njk0LDEwIEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCWR3ICs9IHJl
bTsKIAkJfQogCi1vdXRfdW5sb2NrOgorb3V0X2ZpbGU6CiAJCXRocm90dGxlX3JlbGVhc2UodHEs
IEFSUkFZX1NJWkUodHEpKTsKIAkJaWYgKGlndF9saXZlX3Rlc3RfZW5kKCZ0KSkKIAkJCWVyciA9
IC1FSU87Ci0JCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAkJbW9j
a19maWxlX2ZyZWUoaTkxNSwgZmlsZSk7CiAJCWlmIChlcnIpCkBAIC03NDIsMjIgKzczMiwyMCBA
QCBzdGF0aWMgaW50IGlndF9zaGFyZWRfY3R4X2V4ZWModm9pZCAqYXJnKQogCWlmIChJU19FUlIo
ZmlsZSkpCiAJCXJldHVybiBQVFJfRVJSKGZpbGUpOwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7Ci0KIAlwYXJlbnQgPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7CiAJ
aWYgKElTX0VSUihwYXJlbnQpKSB7CiAJCWVyciA9IFBUUl9FUlIocGFyZW50KTsKLQkJZ290byBv
dXRfdW5sb2NrOworCQlnb3RvIG91dF9maWxlOwogCX0KIAogCWlmICghcGFyZW50LT52bSkgeyAv
KiBub3QgZnVsbC1wcGd0dDsgbm90aGluZyB0byBzaGFyZSAqLwogCQllcnIgPSAwOwotCQlnb3Rv
IG91dF91bmxvY2s7CisJCWdvdG8gb3V0X2ZpbGU7CiAJfQogCiAJZXJyID0gaWd0X2xpdmVfdGVz
dF9iZWdpbigmdCwgaTkxNSwgX19mdW5jX18sICIiKTsKIAlpZiAoZXJyKQotCQlnb3RvIG91dF91
bmxvY2s7CisJCWdvdG8gb3V0X2ZpbGU7CiAKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1
LCBpZCkgewogCQl1bnNpZ25lZCBsb25nIG5jb250ZXh0cywgbmR3b3JkcywgZHc7CkBAIC04MDEs
NyArNzg5LDggQEAgc3RhdGljIGludCBpZ3Rfc2hhcmVkX2N0eF9leGVjKHZvaWQgKmFyZykKIAkJ
CQlwcl9lcnIoIkZhaWxlZCB0byBmaWxsIGR3b3JkICVsdSBbJWx1LyVsdV0gd2l0aCBncHUgKCVz
KSBbZnVsbC1wcGd0dD8gJXNdLCBlcnI9JWRcbiIsCiAJCQkJICAgICAgIG5kd29yZHMsIGR3LCBt
YXhfZHdvcmRzKG9iaiksCiAJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwKLQkJCQkgICAgICAgeWVz
bm8oISFjdHgtPnZtKSwgZXJyKTsKKwkJCQkgICAgICAgeWVzbm8oISFyY3VfYWNjZXNzX3BvaW50
ZXIoY3R4LT52bSkpLAorCQkJCSAgICAgICBlcnIpOwogCQkJCWludGVsX2NvbnRleHRfcHV0KGNl
KTsKIAkJCQlrZXJuZWxfY29udGV4dF9jbG9zZShjdHgpOwogCQkJCWdvdG8gb3V0X3Rlc3Q7CkBA
IC04NDAsMTcgKzgyOSwxMyBAQCBzdGF0aWMgaW50IGlndF9zaGFyZWRfY3R4X2V4ZWModm9pZCAq
YXJnKQogCQkJZHcgKz0gcmVtOwogCQl9CiAKLQkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKIAkJaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhpOTE1KTsKLQkJbXV0
ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJfQogb3V0X3Rlc3Q6CiAJdGhyb3R0
bGVfcmVsZWFzZSh0cSwgQVJSQVlfU0laRSh0cSkpOwogCWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgm
dCkpCiAJCWVyciA9IC1FSU87Ci1vdXRfdW5sb2NrOgotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7Ci0KK291dF9maWxlOgogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUp
OwogCXJldHVybiBlcnI7CiB9CkBAIC0xMjIyLDggKzEyMDcsNiBAQCBfX2lndF9jdHhfc3NldShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlpZiAoZmxhZ3MgJiBURVNUX1JFU0VUKQog
CQlpZ3RfZ2xvYmFsX3Jlc2V0X2xvY2soJmk5MTUtPmd0KTsKIAotCW11dGV4X2xvY2soJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJY3R4ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwog
CWlmIChJU19FUlIoY3R4KSkgewogCQlyZXQgPSBQVFJfRVJSKGN0eCk7CkBAIC0xMjc4LDggKzEy
NjEsNiBAQCBfX2lndF9jdHhfc3NldShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAlp
OTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAKIG91dF91bmxvY2s6Ci0JbXV0ZXhfdW5sb2NrKCZp
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWlmIChmbGFncyAmIFRFU1RfUkVTRVQpCiAJCWln
dF9nbG9iYWxfcmVzZXRfdW5sb2NrKCZpOTE1LT5ndCk7CiAKQEAgLTEzMzksMjMgKzEzMjAsMjQg
QEAgc3RhdGljIGludCBpZ3RfY3R4X3JlYWRvbmx5KHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZp
bGUpKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwotCiAJZXJyID0gaWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19m
dW5jX18sICIiKTsKIAlpZiAoZXJyKQotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8gb3V0X2Zp
bGU7CiAKIAljdHggPSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7CiAJaWYgKElTX0VSUihjdHgp
KSB7CiAJCWVyciA9IFBUUl9FUlIoY3R4KTsKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3RvIG91
dF9maWxlOwogCX0KIAotCXZtID0gY3R4LT52bSA/OiAmaTkxNS0+Z2d0dC5hbGlhcy0+dm07CisJ
cmN1X3JlYWRfbG9jaygpOworCXZtID0gcmN1X2RlcmVmZXJlbmNlKGN0eC0+dm0pID86ICZpOTE1
LT5nZ3R0LmFsaWFzLT52bTsKIAlpZiAoIXZtIHx8ICF2bS0+aGFzX3JlYWRfb25seSkgeworCQly
Y3VfcmVhZF91bmxvY2soKTsKIAkJZXJyID0gMDsKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3Rv
IG91dF9maWxlOwogCX0KKwlyY3VfcmVhZF91bmxvY2soKTsKIAogCW5kd29yZHMgPSAwOwogCWR3
ID0gMDsKQEAgLTEzNzMsNyArMTM1NSw3IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9yZWFkb25seSh2
b2lkICphcmcpCiAJCQkJaWYgKElTX0VSUihvYmopKSB7CiAJCQkJCWVyciA9IFBUUl9FUlIob2Jq
KTsKIAkJCQkJaTkxNV9nZW1fY29udGV4dF91bmxvY2tfZW5naW5lcyhjdHgpOwotCQkJCQlnb3Rv
IG91dF91bmxvY2s7CisJCQkJCWdvdG8gb3V0X2ZpbGU7CiAJCQkJfQogCiAJCQkJaWYgKHByYW5k
b21fdTMyX3N0YXRlKCZwcm5nKSAmIDEpCkBAIC0xMzg0LDE1ICsxMzY2LDE3IEBAIHN0YXRpYyBp
bnQgaWd0X2N0eF9yZWFkb25seSh2b2lkICphcmcpCiAJCQlpZiAoZXJyKSB7CiAJCQkJcHJfZXJy
KCJGYWlsZWQgdG8gZmlsbCBkd29yZCAlbHUgWyVsdS8lbHVdIHdpdGggZ3B1ICglcykgW2Z1bGwt
cHBndHQ/ICVzXSwgZXJyPSVkXG4iLAogCQkJCSAgICAgICBuZHdvcmRzLCBkdywgbWF4X2R3b3Jk
cyhvYmopLAotCQkJCSAgICAgICBjZS0+ZW5naW5lLT5uYW1lLCB5ZXNubyghIWN0eC0+dm0pLCBl
cnIpOworCQkJCSAgICAgICBjZS0+ZW5naW5lLT5uYW1lLAorCQkJCSAgICAgICB5ZXNubyghIXJj
dV9hY2Nlc3NfcG9pbnRlcihjdHgtPnZtKSksCisJCQkJICAgICAgIGVycik7CiAJCQkJaTkxNV9n
ZW1fY29udGV4dF91bmxvY2tfZW5naW5lcyhjdHgpOwotCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJ
CQlnb3RvIG91dF9maWxlOwogCQkJfQogCiAJCQllcnIgPSB0aHJvdHRsZShjZSwgdHEsIEFSUkFZ
X1NJWkUodHEpKTsKIAkJCWlmIChlcnIpIHsKIAkJCQlpOTE1X2dlbV9jb250ZXh0X3VubG9ja19l
bmdpbmVzKGN0eCk7Ci0JCQkJZ290byBvdXRfdW5sb2NrOworCQkJCWdvdG8gb3V0X2ZpbGU7CiAJ
CQl9CiAKIAkJCWlmICgrK2R3ID09IG1heF9kd29yZHMob2JqKSkgewpAQCAtMTQyNCwxMSArMTQw
OCwxMCBAQCBzdGF0aWMgaW50IGlndF9jdHhfcmVhZG9ubHkodm9pZCAqYXJnKQogCQlkdyArPSBy
ZW07CiAJfQogCi1vdXRfdW5sb2NrOgorb3V0X2ZpbGU6CiAJdGhyb3R0bGVfcmVsZWFzZSh0cSwg
QVJSQVlfU0laRSh0cSkpOwogCWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgmdCkpCiAJCWVyciA9IC1F
SU87Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCW1vY2tfZmls
ZV9mcmVlKGk5MTUsIGZpbGUpOwogCXJldHVybiBlcnI7CkBAIC0xNDM3LDcgKzE0MjAsNyBAQCBz
dGF0aWMgaW50IGlndF9jdHhfcmVhZG9ubHkodm9pZCAqYXJnKQogc3RhdGljIGludCBjaGVja19z
Y3JhdGNoKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsIHU2NCBvZmZzZXQpCiB7CiAJc3Ry
dWN0IGRybV9tbV9ub2RlICpub2RlID0KLQkJX19kcm1fbW1faW50ZXJ2YWxfZmlyc3QoJmN0eC0+
dm0tPm1tLAorCQlfX2RybV9tbV9pbnRlcnZhbF9maXJzdCgmcmN1X2RlcmVmZXJlbmNlX3Byb3Rl
Y3RlZChjdHgtPnZtLCB0cnVlKS0+bW0sCiAJCQkJCW9mZnNldCwgb2Zmc2V0ICsgc2l6ZW9mKHUz
MikgLSAxKTsKIAlpZiAoIW5vZGUgfHwgbm9kZS0+c3RhcnQgPiBvZmZzZXQpCiAJCXJldHVybiAw
OwpAQCAtMTQ4Nyw3ICsxNDcwLDkgQEAgc3RhdGljIGludCB3cml0ZV90b19zY3JhdGNoKHN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiAKIAlpbnRlbF9ndF9jaGlwc2V0X2ZsdXNoKGVuZ2lu
ZS0+Z3QpOwogCi0Jdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCBjdHgtPnZtLCBOVUxMKTsK
Kwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosCisJCQkJcmN1X2RlcmVmZXJlbmNlX3Byb3Rl
Y3RlZChjdHgtPnZtLCB0cnVlKSwKKwkJCQlOVUxMKTsKIAlpZiAoSVNfRVJSKHZtYSkpIHsKIAkJ
ZXJyID0gUFRSX0VSUih2bWEpOwogCQlnb3RvIGVycjsKQEAgLTE1ODYsNyArMTU3MSw5IEBAIHN0
YXRpYyBpbnQgcmVhZF9mcm9tX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwK
IAogCWludGVsX2d0X2NoaXBzZXRfZmx1c2goZW5naW5lLT5ndCk7CiAKLQl2bWEgPSBpOTE1X3Zt
YV9pbnN0YW5jZShvYmosIGN0eC0+dm0sIE5VTEwpOworCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNl
KG9iaiwKKwkJCQlyY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKGN0eC0+dm0sIHRydWUpLAorCQkJ
CU5VTEwpOwogCWlmIChJU19FUlIodm1hKSkgewogCQllcnIgPSBQVFJfRVJSKHZtYSk7CiAJCWdv
dG8gZXJyOwpAQCAtMTY3NywyNyArMTY2NCwyNSBAQCBzdGF0aWMgaW50IGlndF92bV9pc29sYXRp
b24odm9pZCAqYXJnKQogCWlmIChJU19FUlIoZmlsZSkpCiAJCXJldHVybiBQVFJfRVJSKGZpbGUp
OwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAllcnIgPSBpZ3Rf
bGl2ZV90ZXN0X2JlZ2luKCZ0LCBpOTE1LCBfX2Z1bmNfXywgIiIpOwogCWlmIChlcnIpCi0JCWdv
dG8gb3V0X3VubG9jazsKKwkJZ290byBvdXRfZmlsZTsKIAogCWN0eF9hID0gbGl2ZV9jb250ZXh0
KGk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIoY3R4X2EpKSB7CiAJCWVyciA9IFBUUl9FUlIoY3R4
X2EpOwotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8gb3V0X2ZpbGU7CiAJfQogCiAJY3R4X2Ig
PSBsaXZlX2NvbnRleHQoaTkxNSwgZmlsZSk7CiAJaWYgKElTX0VSUihjdHhfYikpIHsKIAkJZXJy
ID0gUFRSX0VSUihjdHhfYik7Ci0JCWdvdG8gb3V0X3VubG9jazsKKwkJZ290byBvdXRfZmlsZTsK
IAl9CiAKIAkvKiBXZSBjYW4gb25seSB0ZXN0IHZtIGlzb2xhdGlvbiwgaWYgdGhlIHZtIGFyZSBk
aXN0aW5jdCAqLwogCWlmIChjdHhfYS0+dm0gPT0gY3R4X2ItPnZtKQotCQlnb3RvIG91dF91bmxv
Y2s7CisJCWdvdG8gb3V0X2ZpbGU7CiAKIAl2bV90b3RhbCA9IGN0eF9hLT52bS0+dG90YWw7CiAJ
R0VNX0JVR19PTihjdHhfYi0+dm0tPnRvdGFsICE9IHZtX3RvdGFsKTsKQEAgLTE3MjYsNyArMTcx
MSw3IEBAIHN0YXRpYyBpbnQgaWd0X3ZtX2lzb2xhdGlvbih2b2lkICphcmcpCiAJCQkJZXJyID0g
cmVhZF9mcm9tX3NjcmF0Y2goY3R4X2IsIGVuZ2luZSwKIAkJCQkJCQlvZmZzZXQsICZ2YWx1ZSk7
CiAJCQlpZiAoZXJyKQotCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQlnb3RvIG91dF9maWxlOwog
CiAJCQlpZiAodmFsdWUpIHsKIAkJCQlwcl9lcnIoIiVzOiBSZWFkICUwOHggZnJvbSBzY3JhdGNo
IChvZmZzZXQgMHglMDh4XyUwOHgpLCBhZnRlciAlbHUgcmVhZHMhXG4iLApAQCAtMTczNSw3ICsx
NzIwLDcgQEAgc3RhdGljIGludCBpZ3Rfdm1faXNvbGF0aW9uKHZvaWQgKmFyZykKIAkJCQkgICAg
ICAgbG93ZXJfMzJfYml0cyhvZmZzZXQpLAogCQkJCSAgICAgICB0aGlzKTsKIAkJCQllcnIgPSAt
RUlOVkFMOwotCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQlnb3RvIG91dF9maWxlOwogCQkJfQog
CiAJCQl0aGlzKys7CkBAIC0xNzQ1LDExICsxNzMwLDkgQEAgc3RhdGljIGludCBpZ3Rfdm1faXNv
bGF0aW9uKHZvaWQgKmFyZykKIAlwcl9pbmZvKCJDaGVja2VkICVsdSBzY3JhdGNoIG9mZnNldHMg
YWNyb3NzICVkIGVuZ2luZXNcbiIsCiAJCWNvdW50LCBSVU5USU1FX0lORk8oaTkxNSktPm51bV9l
bmdpbmVzKTsKIAotb3V0X3VubG9jazoKK291dF9maWxlOgogCWlmIChpZ3RfbGl2ZV90ZXN0X2Vu
ZCgmdCkpCiAJCWVyciA9IC1FSU87Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKLQogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwogCXJldHVybiBlcnI7CiB9CkBA
IC0xNzgxLDEzICsxNzY0LDkgQEAgc3RhdGljIGludCBtb2NrX2NvbnRleHRfYmFycmllcih2b2lk
ICphcmcpCiAJICogYSByZXF1ZXN0OyB1c2VmdWwgZm9yIHJldGlyaW5nIG9sZCBzdGF0ZSBhZnRl
ciBsb2FkaW5nIG5ldy4KIAkgKi8KIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwotCiAJY3R4ID0gbW9ja19jb250ZXh0KGk5MTUsICJtb2NrIik7Ci0JaWYgKCFjdHgpIHsK
LQkJZXJyID0gLUVOT01FTTsKLQkJZ290byB1bmxvY2s7Ci0JfQorCWlmICghY3R4KQorCQlyZXR1
cm4gLUVOT01FTTsKIAogCWNvdW50ZXIgPSAwOwogCWVyciA9IGNvbnRleHRfYmFycmllcl90YXNr
KGN0eCwgMCwKQEAgLTE4NjAsOCArMTgzOSw2IEBAIHN0YXRpYyBpbnQgbW9ja19jb250ZXh0X2Jh
cnJpZXIodm9pZCAqYXJnKQogCiBvdXQ6CiAJbW9ja19jb250ZXh0X2Nsb3NlKGN0eCk7Ci11bmxv
Y2s6Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlyZXR1cm4gZXJy
OwogI3VuZGVmIHByX2ZtdAogI2RlZmluZSBwcl9mbXQoeCkgeApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9tb2NrX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmMKaW5kZXggZWJjNDZmMDk4NTYx
Li42ZWY4NmU3OTIzYTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxm
dGVzdHMvbW9ja19jb250ZXh0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0
ZXN0cy9tb2NrX2NvbnRleHQuYwpAQCAtNjcsNyArNjcsNyBAQCB2b2lkIG1vY2tfY29udGV4dF9j
bG9zZShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogCiB2b2lkIG1vY2tfaW5pdF9jb250
ZXh0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKLQlpbml0X2NvbnRleHRzKGk5
MTUpOworCWluaXRfY29udGV4dHMoJmk5MTUtPmdlbS5jb250ZXh0cyk7CiB9CiAKIHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICoKQEAgLTc2LDggKzc2LDYgQEAgbGl2ZV9jb250ZXh0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCiAJc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHQgKmN0eDsKIAlpbnQgZXJyOwogCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgm
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAljdHggPSBpOTE1X2dlbV9jcmVhdGVfY29udGV4
dChpOTE1LCAwKTsKIAlpZiAoSVNfRVJSKGN0eCkpCiAJCXJldHVybiBjdHg7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKaW5kZXggMzVhNDBjMjgyMGEyLi4xMDdlYjAzZDZk
ZDQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKQEAgLTIyNiw3ICsy
MjYsMTMgQEAgaW50ZWxfY29udGV4dF9pbml0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKIAlr
cmVmX2luaXQoJmNlLT5yZWYpOwogCiAJY2UtPmdlbV9jb250ZXh0ID0gY3R4OwotCWNlLT52bSA9
IGk5MTVfdm1fZ2V0KGN0eC0+dm0gPzogJmVuZ2luZS0+Z3QtPmdndHQtPnZtKTsKKwlyY3VfcmVh
ZF9sb2NrKCk7CisJY2UtPnZtID0gcmN1X2RlcmVmZXJlbmNlKGN0eC0+dm0pOworCWlmIChjZS0+
dm0gJiYgIWtyZWZfZ2V0X3VubGVzc196ZXJvKCZjZS0+dm0tPnJlZikpCisJCWNlLT52bSA9IE5V
TEw7CisJaWYgKCFjZS0+dm0pCisJCWNlLT52bSA9IGk5MTVfdm1fZ2V0KCZlbmdpbmUtPmd0LT5n
Z3R0LT52bSk7CisJcmN1X3JlYWRfdW5sb2NrKCk7CiAJaWYgKGN0eC0+dGltZWxpbmUpCiAJCWNl
LT50aW1lbGluZSA9IGludGVsX3RpbWVsaW5lX2dldChjdHgtPnRpbWVsaW5lKTsKIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9scmMuYwppbmRleCA4OTBjZDlhYjA3YTAuLmI0NjM3ZjBjOGRlZiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKQEAgLTk4NCw2ICs5ODQsMTEgQEAgX19l
eGVjbGlzdHNfc2NoZWR1bGVfaW4oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJCWNlLT5scmNf
ZGVzYyB8PQogCQkJKHU2NCkoZW5naW5lLT5jb250ZXh0X3RhZysrICUgTlVNX0NPTlRFWFRfVEFH
KSA8PAogCQkJR0VOMTFfU1dfQ1RYX0lEX1NISUZUOworCisjZGVmaW5lIEdFTjExX01BWF9DT05U
RVhUX0hXX0lEICgxPDwxMSkgLyogZXhjbHVzaXZlICovCisvKiBpbiBHZW4xMiBJRCAweDdGRiBp
cyByZXNlcnZlZCB0byBpbmRpY2F0ZSBpZGxlICovCisjZGVmaW5lIEdFTjEyX01BWF9DT05URVhU
X0hXX0lEICAgICAgICAoR0VOMTFfTUFYX0NPTlRFWFRfSFdfSUQgLSAxKQorCiAJCUJVSUxEX0JV
R19PTihOVU1fQ09OVEVYVF9UQUcgPiBHRU4xMl9NQVhfQ09OVEVYVF9IV19JRCk7CiAJfQogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9jb250ZXh0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9jb250ZXh0LmMKaW5kZXggODZjZmZiYjBh
OWNiLi43YzgzOGE1N2UxNzQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9j
b250ZXh0LmMKQEAgLTE1NSwxMyArMTU1LDkgQEAgc3RhdGljIGludCBsaXZlX2NvbnRleHRfc2l6
ZSh2b2lkICphcmcpCiAJICogSFcgdHJpZXMgdG8gd3JpdGUgcGFzdCB0aGUgZW5kIG9mIG9uZS4K
IAkgKi8KIAotCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWZp
eG1lID0ga2VybmVsX2NvbnRleHQoZ3QtPmk5MTUpOwotCWlmIChJU19FUlIoZml4bWUpKSB7Ci0J
CWVyciA9IFBUUl9FUlIoZml4bWUpOwotCQlnb3RvIHVubG9jazsKLQl9CisJaWYgKElTX0VSUihm
aXhtZSkpCisJCXJldHVybiBQVFJfRVJSKGZpeG1lKTsKIAogCWZvcl9lYWNoX2VuZ2luZShlbmdp
bmUsIGd0LT5pOTE1LCBpZCkgewogCQlzdHJ1Y3QgewpAQCAtMjAxLDggKzE5Nyw2IEBAIHN0YXRp
YyBpbnQgbGl2ZV9jb250ZXh0X3NpemUodm9pZCAqYXJnKQogCX0KIAogCWtlcm5lbF9jb250ZXh0
X2Nsb3NlKGZpeG1lKTsKLXVubG9jazoKLQltdXRleF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKIAlyZXR1cm4gZXJyOwogfQogCkBAIC0zMDUsMTIgKzI5OSwxMCBAQCBzdGF0
aWMgaW50IGxpdmVfYWN0aXZlX2NvbnRleHQodm9pZCAqYXJnKQogCWlmIChJU19FUlIoZmlsZSkp
CiAJCXJldHVybiBQVFJfRVJSKGZpbGUpOwogCi0JbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwotCiAJZml4bWUgPSBsaXZlX2NvbnRleHQoZ3QtPmk5MTUsIGZpbGUpOwog
CWlmIChJU19FUlIoZml4bWUpKSB7CiAJCWVyciA9IFBUUl9FUlIoZml4bWUpOwotCQlnb3RvIHVu
bG9jazsKKwkJZ290byBvdXRfZmlsZTsKIAl9CiAKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBn
dC0+aTkxNSwgaWQpIHsKQEAgLTMyMyw4ICszMTUsNyBAQCBzdGF0aWMgaW50IGxpdmVfYWN0aXZl
X2NvbnRleHQodm9pZCAqYXJnKQogCQkJYnJlYWs7CiAJfQogCi11bmxvY2s6Ci0JbXV0ZXhfdW5s
b2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CitvdXRfZmlsZToKIAltb2NrX2ZpbGVf
ZnJlZShndC0+aTkxNSwgZmlsZSk7CiAJcmV0dXJuIGVycjsKIH0KQEAgLTQxOCwxMiArNDA5LDEw
IEBAIHN0YXRpYyBpbnQgbGl2ZV9yZW1vdGVfY29udGV4dCh2b2lkICphcmcpCiAJaWYgKElTX0VS
UihmaWxlKSkKIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7CiAKLQltdXRleF9sb2NrKCZndC0+aTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAlmaXhtZSA9IGxpdmVfY29udGV4dChndC0+aTkxNSwg
ZmlsZSk7CiAJaWYgKElTX0VSUihmaXhtZSkpIHsKIAkJZXJyID0gUFRSX0VSUihmaXhtZSk7Ci0J
CWdvdG8gdW5sb2NrOworCQlnb3RvIG91dF9maWxlOwogCX0KIAogCWZvcl9lYWNoX2VuZ2luZShl
bmdpbmUsIGd0LT5pOTE1LCBpZCkgewpAQCAtNDM2LDggKzQyNSw3IEBAIHN0YXRpYyBpbnQgbGl2
ZV9yZW1vdGVfY29udGV4dCh2b2lkICphcmcpCiAJCQlicmVhazsKIAl9CiAKLXVubG9jazoKLQlt
dXRleF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKK291dF9maWxlOgogCW1v
Y2tfZmlsZV9mcmVlKGd0LT5pOTE1LCBmaWxlKTsKIAlyZXR1cm4gZXJyOwogfQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYwppbmRleCBiMGNhMzAyMjAxOTMu
LmVjYjQxY2QyYmI0ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRl
c3RfaGFuZ2NoZWNrLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFu
Z2NoZWNrLmMKQEAgLTU4LDkgKzU4LDcgQEAgc3RhdGljIGludCBoYW5nX2luaXQoc3RydWN0IGhh
bmcgKmgsIHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJbWVtc2V0KGgsIDAsIHNpemVvZigqaCkpOwog
CWgtPmd0ID0gZ3Q7CiAKLQltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
CiAJaC0+Y3R4ID0ga2VybmVsX2NvbnRleHQoZ3QtPmk5MTUpOwotCW11dGV4X3VubG9jaygmZ3Qt
Pmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWlmIChJU19FUlIoaC0+Y3R4KSkKIAkJcmV0dXJu
IFBUUl9FUlIoaC0+Y3R4KTsKIApAQCAtMTMzLDcgKzEzMSw4IEBAIHN0YXRpYyBzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICoKIGhhbmdfY3JlYXRlX3JlcXVlc3Qoc3RydWN0IGhhbmcgKmgsIHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gaC0+Z3Q7
Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBoLT5jdHgtPnZtID86ICZlbmdpbmUt
Pmd0LT5nZ3R0LT52bTsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9CisJCXJjdV9k
ZXJlZmVyZW5jZV9wcm90ZWN0ZWQoaC0+Y3R4LT52bSwgdHJ1ZSkgPzogJmVuZ2luZS0+Z3QtPmdn
dHQtPnZtOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CiAJc3RydWN0IGk5MTVf
cmVxdWVzdCAqcnEgPSBOVUxMOwogCXN0cnVjdCBpOTE1X3ZtYSAqaHdzLCAqdm1hOwpAQCAtMzgy
LDkgKzM4MSw3IEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X25vcCh2b2lkICphcmcpCiAJaWYgKElT
X0VSUihmaWxlKSkKIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7CiAKLQltdXRleF9sb2NrKCZndC0+
aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJY3R4ID0gbGl2ZV9jb250ZXh0KGd0LT5pOTE1LCBm
aWxlKTsKLQltdXRleF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlpZiAo
SVNfRVJSKGN0eCkpIHsKIAkJZXJyID0gUFRSX0VSUihjdHgpOwogCQlnb3RvIG91dDsKQEAgLTQ1
OCw5ICs0NTUsNyBAQCBzdGF0aWMgaW50IGlndF9yZXNldF9ub3BfZW5naW5lKHZvaWQgKmFyZykK
IAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xv
Y2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAljdHggPSBsaXZlX2NvbnRleHQoZ3Qt
Pmk5MTUsIGZpbGUpOwotCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgp
OwogCWlmIChJU19FUlIoY3R4KSkgewogCQllcnIgPSBQVFJfRVJSKGN0eCk7CiAJCWdvdG8gb3V0
OwpAQCAtNzA1LDkgKzcwMCw3IEBAIHN0YXRpYyBpbnQgYWN0aXZlX2VuZ2luZSh2b2lkICpkYXRh
KQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAogCWZvciAoY291bnQgPSAwOyBjb3VudCA8IEFS
UkFZX1NJWkUoY3R4KTsgY291bnQrKykgewotCQltdXRleF9sb2NrKCZlbmdpbmUtPmk5MTUtPmRy
bS5zdHJ1Y3RfbXV0ZXgpOwogCQljdHhbY291bnRdID0gbGl2ZV9jb250ZXh0KGVuZ2luZS0+aTkx
NSwgZmlsZSk7Ci0JCW11dGV4X3VubG9jaygmZW5naW5lLT5pOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKIAkJaWYgKElTX0VSUihjdHhbY291bnRdKSkgewogCQkJZXJyID0gUFRSX0VSUihjdHhbY291
bnRdKTsKIAkJCXdoaWxlICgtLWNvdW50KQpAQCAtMTI5OCwxOCArMTI5MSwxOCBAQCBzdGF0aWMg
aW50IGlndF9yZXNldF9ldmljdF9wcGd0dCh2b2lkICphcmcpCiAJaWYgKElTX0VSUihmaWxlKSkK
IAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7CiAKLQltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7CiAJY3R4ID0gbGl2ZV9jb250ZXh0KGd0LT5pOTE1LCBmaWxlKTsKLQltdXRl
eF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlpZiAoSVNfRVJSKGN0eCkp
IHsKIAkJZXJyID0gUFRSX0VSUihjdHgpOwogCQlnb3RvIG91dDsKIAl9CiAKIAllcnIgPSAwOwot
CWlmIChjdHgtPnZtKSAvKiBhbGlhc2luZyA9PSBnbG9iYWwgZ3R0IGxvY2tpbmcsIGNvdmVyZWQg
YWJvdmUgKi8KLQkJZXJyID0gX19pZ3RfcmVzZXRfZXZpY3Rfdm1hKGd0LCBjdHgtPnZtLAorCWlm
IChyY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpIHsKKwkJLyogYWxpYXNpbmcgPT0gZ2xvYmFs
IGd0dCBsb2NraW5nLCBjb3ZlcmVkIGFib3ZlICovCisJCWVyciA9IF9faWd0X3Jlc2V0X2V2aWN0
X3ZtYShndCwgcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChjdHgtPnZtLCB0cnVlKSwKIAkJCQkJ
ICAgIGV2aWN0X3ZtYSwgRVhFQ19PQkpFQ1RfV1JJVEUpOworCX0KIAogb3V0OgogCW1vY2tfZmls
ZV9mcmVlKGd0LT5pOTE1LCBmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3NlbGZ0ZXN0X2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJj
LmMKaW5kZXggN2QzZDljNTNjNDE2Li4wMzU3Y2Y2NDNlM2QgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L3NlbGZ0ZXN0X2xyYy5jCkBAIC0xNjM1LDcgKzE2MzUsOSBAQCBzdGF0aWMgaW50IHNtb2tl
X3N1Ym1pdChzdHJ1Y3QgcHJlZW1wdF9zbW9rZSAqc21va2UsCiAJaW50IGVyciA9IDA7CiAKIAlp
ZiAoYmF0Y2gpIHsKLQkJdm1hID0gaTkxNV92bWFfaW5zdGFuY2UoYmF0Y2gsIGN0eC0+dm0sIE5V
TEwpOworCQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShiYXRjaCwKKwkJCQkJcmN1X2RlcmVmZXJl
bmNlX3Byb3RlY3RlZChjdHgtPnZtLCB0cnVlKSwKKwkJCQkJTlVMTCk7CiAJCWlmIChJU19FUlIo
dm1hKSkKIAkJCXJldHVybiBQVFJfRVJSKHZtYSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jCmluZGV4IDRlZTJlMmJhYmQwZC4uZDE3OTc2ZDlm
YjkxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJv
dW5kcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRz
LmMKQEAgLTMzLDYgKzMzLDggQEAgc3RydWN0IHdhX2xpc3RzIHsKIAl9IGVuZ2luZVtJOTE1X05V
TV9FTkdJTkVTXTsKIH07CiAKKyNkZWZpbmUgY3R4X3ZtKGN0eCkgcmN1X2RlcmVmZXJlbmNlX3By
b3RlY3RlZCgoY3R4KS0+dm0sIHRydWUpCisKIHN0YXRpYyB2b2lkCiByZWZlcmVuY2VfbGlzdHNf
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IHdhX2xpc3RzICpsaXN0
cykKIHsKQEAgLTM2Miw3ICszNjQsNyBAQCBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpjcmVhdGVf
YmF0Y2goc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAlpZiAoSVNfRVJSKG9iaikpCiAJ
CXJldHVybiBFUlJfQ0FTVChvYmopOwogCi0Jdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCBj
dHgtPnZtLCBOVUxMKTsKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIGN0eF92bShjdHgp
LCBOVUxMKTsKIAlpZiAoSVNfRVJSKHZtYSkpIHsKIAkJZXJyID0gUFRSX0VSUih2bWEpOwogCQln
b3RvIGVycl9vYmo7CkBAIC00NjgsNyArNDcwLDcgQEAgc3RhdGljIGludCBjaGVja19kaXJ0eV93
aGl0ZWxpc3Qoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAlpbnQgZXJyID0gMCwgaSwg
djsKIAl1MzIgKmNzLCAqcmVzdWx0czsKIAotCXNjcmF0Y2ggPSBjcmVhdGVfc2NyYXRjaChjdHgt
PnZtLCAyICogQVJSQVlfU0laRSh2YWx1ZXMpICsgMSk7CisJc2NyYXRjaCA9IGNyZWF0ZV9zY3Jh
dGNoKGN0eF92bShjdHgpLCAyICogQVJSQVlfU0laRSh2YWx1ZXMpICsgMSk7CiAJaWYgKElTX0VS
UihzY3JhdGNoKSkKIAkJcmV0dXJuIFBUUl9FUlIoc2NyYXRjaCk7CiAKQEAgLTEwMTgsMTQgKzEw
MjAsMTQgQEAgc3RhdGljIGludCBsaXZlX2lzb2xhdGVkX3doaXRlbGlzdCh2b2lkICphcmcpCiAJ
CQlnb3RvIGVycjsKIAkJfQogCi0JCWNsaWVudFtpXS5zY3JhdGNoWzBdID0gY3JlYXRlX3NjcmF0
Y2goYy0+dm0sIDEwMjQpOworCQljbGllbnRbaV0uc2NyYXRjaFswXSA9IGNyZWF0ZV9zY3JhdGNo
KGN0eF92bShjKSwgMTAyNCk7CiAJCWlmIChJU19FUlIoY2xpZW50W2ldLnNjcmF0Y2hbMF0pKSB7
CiAJCQllcnIgPSBQVFJfRVJSKGNsaWVudFtpXS5zY3JhdGNoWzBdKTsKIAkJCWtlcm5lbF9jb250
ZXh0X2Nsb3NlKGMpOwogCQkJZ290byBlcnI7CiAJCX0KIAotCQljbGllbnRbaV0uc2NyYXRjaFsx
XSA9IGNyZWF0ZV9zY3JhdGNoKGMtPnZtLCAxMDI0KTsKKwkJY2xpZW50W2ldLnNjcmF0Y2hbMV0g
PSBjcmVhdGVfc2NyYXRjaChjdHhfdm0oYyksIDEwMjQpOwogCQlpZiAoSVNfRVJSKGNsaWVudFtp
XS5zY3JhdGNoWzFdKSkgewogCQkJZXJyID0gUFRSX0VSUihjbGllbnRbaV0uc2NyYXRjaFsxXSk7
CiAJCQlpOTE1X3ZtYV91bnBpbl9hbmRfcmVsZWFzZSgmY2xpZW50W2ldLnNjcmF0Y2hbMF0sIDAp
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCmluZGV4IDAzZjU2NzA4NDU0OC4uY2U1
Y2ZmMDFmNDRjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVy
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCkBAIC0zNjUsNyAr
MzY1LDggQEAgc3RhdGljIHZvaWQgc2V0X2NvbnRleHRfcHBndHRfZnJvbV9zaGFkb3coc3RydWN0
IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkLAogCQkJCQkgIHN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0ICpjdHgpCiB7CiAJc3RydWN0IGludGVsX3ZncHVfbW0gKm1tID0gd29ya2xvYWQtPnNo
YWRvd19tbTsKLQlzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQgPSBpOTE1X3ZtX3RvX3BwZ3R0KGN0
eC0+dm0pOworCXN0cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCA9CisJCWk5MTVfdm1fdG9fcHBndHQo
cmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChjdHgtPnZtLCB0cnVlKSk7CiAJaW50IGkgPSAwOwog
CiAJaWYgKG1tLT5wcGd0dF9tbS5yb290X2VudHJ5X3R5cGUgPT0gR1RUX1RZUEVfUFBHVFRfUk9P
VF9MNF9FTlRSWSkgewpAQCAtMTIzMCwyMCArMTIzMSwxOCBAQCBpbnQgaW50ZWxfdmdwdV9zZXR1
cF9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQogCXN0cnVjdCBpbnRlbF92Z3B1
X3N1Ym1pc3Npb24gKnMgPSAmdmdwdS0+c3VibWlzc2lvbjsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmU7CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eDsKKwlzdHJ1Y3QgaTkx
NV9wcGd0dCAqcHBndHQ7CiAJZW51bSBpbnRlbF9lbmdpbmVfaWQgaTsKIAlpbnQgcmV0OwogCi0J
bXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAljdHggPSBpOTE1X2dlbV9j
b250ZXh0X2NyZWF0ZV9rZXJuZWwoaTkxNSwgSTkxNV9QUklPUklUWV9NQVgpOwotCWlmIChJU19F
UlIoY3R4KSkgewotCQlyZXQgPSBQVFJfRVJSKGN0eCk7Ci0JCWdvdG8gb3V0X3VubG9jazsKLQl9
CisJaWYgKElTX0VSUihjdHgpKQorCQlyZXR1cm4gUFRSX0VSUihjdHgpOwogCiAJaTkxNV9nZW1f
Y29udGV4dF9zZXRfZm9yY2Vfc2luZ2xlX3N1Ym1pc3Npb24oY3R4KTsKIAotCWk5MTVfY29udGV4
dF9wcGd0dF9yb290X3NhdmUocywgaTkxNV92bV90b19wcGd0dChjdHgtPnZtKSk7CisJcHBndHQg
PSBpOTE1X3ZtX3RvX3BwZ3R0KHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQoY3R4LT52bSwgdHJ1
ZSkpOworCWk5MTVfY29udGV4dF9wcGd0dF9yb290X3NhdmUocywgcHBndHQpOwogCiAJZm9yX2Vh
Y2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaSkgewogCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7
CkBAIC0xMjg5LDExICsxMjg4LDEwIEBAIGludCBpbnRlbF92Z3B1X3NldHVwX3N1Ym1pc3Npb24o
c3RydWN0IGludGVsX3ZncHUgKnZncHUpCiAJYml0bWFwX3plcm8ocy0+dGxiX2hhbmRsZV9wZW5k
aW5nLCBJOTE1X05VTV9FTkdJTkVTKTsKIAogCWk5MTVfZ2VtX2NvbnRleHRfcHV0KGN0eCk7Ci0J
bXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlyZXR1cm4gMDsKIAogb3V0
X3NoYWRvd19jdHg6Ci0JaTkxNV9jb250ZXh0X3BwZ3R0X3Jvb3RfcmVzdG9yZShzLCBpOTE1X3Zt
X3RvX3BwZ3R0KGN0eC0+dm0pKTsKKwlpOTE1X2NvbnRleHRfcHBndHRfcm9vdF9yZXN0b3JlKHMs
IHBwZ3R0KTsKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpKSB7CiAJCWlmIChJU19F
UlIocy0+c2hhZG93W2ldKSkKIAkJCWJyZWFrOwpAQCAtMTMwMiw4ICsxMzAwLDYgQEAgaW50IGlu
dGVsX3ZncHVfc2V0dXBfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIAkJaW50
ZWxfY29udGV4dF9wdXQocy0+c2hhZG93W2ldKTsKIAl9CiAJaTkxNV9nZW1fY29udGV4dF9wdXQo
Y3R4KTsKLW91dF91bmxvY2s6Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKIAlyZXR1cm4gcmV0OwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2RlYnVnZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCmluZGV4
IDQ1NGRlMjdjNDkxMi4uNjA4MWE0NTM5ZTFlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2RlYnVnZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVn
ZnMuYwpAQCAtMzE2LDEyICszMTYsMTggQEAgc3RhdGljIHZvaWQgcHJpbnRfY29udGV4dF9zdGF0
cyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sCiAJCQkJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
CiB7CiAJc3RydWN0IGZpbGVfc3RhdHMga3N0YXRzID0ge307Ci0Jc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eDsKKwlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LCAqY247CiAKLQlsaXN0
X2Zvcl9lYWNoX2VudHJ5KGN0eCwgJmk5MTUtPmNvbnRleHRzLmxpc3QsIGxpbmspIHsKKwlzcGlu
X2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3Nh
ZmUoY3R4LCBjbiwgJmk5MTUtPmdlbS5jb250ZXh0cy5saXN0LCBsaW5rKSB7CiAJCXN0cnVjdCBp
OTE1X2dlbV9lbmdpbmVzX2l0ZXIgaXQ7CiAJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKIAor
CQlpZiAoIWtyZWZfZ2V0X3VubGVzc196ZXJvKCZjdHgtPnJlZikpCisJCQljb250aW51ZTsKKwor
CQlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCiAJCWZvcl9lYWNoX2dl
bV9lbmdpbmUoY2UsCiAJCQkJICAgIGk5MTVfZ2VtX2NvbnRleHRfbG9ja19lbmdpbmVzKGN0eCks
IGl0KSB7CiAJCQlpbnRlbF9jb250ZXh0X2xvY2tfcGlubmVkKGNlKTsKQEAgLTMzOCw3ICszNDQs
OSBAQCBzdGF0aWMgdm9pZCBwcmludF9jb250ZXh0X3N0YXRzKHN0cnVjdCBzZXFfZmlsZSAqbSwK
IAkJaTkxNV9nZW1fY29udGV4dF91bmxvY2tfZW5naW5lcyhjdHgpOwogCiAJCWlmICghSVNfRVJS
X09SX05VTEwoY3R4LT5maWxlX3ByaXYpKSB7Ci0JCQlzdHJ1Y3QgZmlsZV9zdGF0cyBzdGF0cyA9
IHsgLnZtID0gY3R4LT52bSwgfTsKKwkJCXN0cnVjdCBmaWxlX3N0YXRzIHN0YXRzID0geworCQkJ
CS52bSA9IHJjdV9hY2Nlc3NfcG9pbnRlcihjdHgtPnZtKSwKKwkJCX07CiAJCQlzdHJ1Y3QgZHJt
X2ZpbGUgKmZpbGUgPSBjdHgtPmZpbGVfcHJpdi0+ZmlsZTsKIAkJCXN0cnVjdCB0YXNrX3N0cnVj
dCAqdGFzazsKIAkJCWNoYXIgbmFtZVs4MF07CkBAIC0zNTUsNyArMzYzLDEyIEBAIHN0YXRpYyB2
b2lkIHByaW50X2NvbnRleHRfc3RhdHMoc3RydWN0IHNlcV9maWxlICptLAogCiAJCQlwcmludF9m
aWxlX3N0YXRzKG0sIG5hbWUsIHN0YXRzKTsKIAkJfQorCisJCXNwaW5fbG9jaygmaTkxNS0+Z2Vt
LmNvbnRleHRzLmxvY2spOworCQlsaXN0X3NhZmVfcmVzZXRfbmV4dChjdHgsIGNuLCBsaW5rKTsK
KwkJaTkxNV9nZW1fY29udGV4dF9wdXQoY3R4KTsKIAl9CisJc3Bpbl91bmxvY2soJmk5MTUtPmdl
bS5jb250ZXh0cy5sb2NrKTsKIAogCXByaW50X2ZpbGVfc3RhdHMobSwgIltrXWNvbnRleHRzIiwg
a3N0YXRzKTsKIH0KQEAgLTM2Myw3ICszNzYsNiBAQCBzdGF0aWMgdm9pZCBwcmludF9jb250ZXh0
X3N0YXRzKHN0cnVjdCBzZXFfZmlsZSAqbSwKIHN0YXRpYyBpbnQgaTkxNV9nZW1fb2JqZWN0X2lu
Zm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogewogCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCWludCByZXQ7CiAKIAlz
ZXFfcHJpbnRmKG0sICIldSBzaHJpbmthYmxlIFsldSBmcmVlXSBvYmplY3RzLCAlbGx1IGJ5dGVz
XG4iLAogCQkgICBpOTE1LT5tbS5zaHJpbmtfY291bnQsCkBAIC0zNzIsMTIgKzM4NCw3IEBAIHN0
YXRpYyBpbnQgaTkxNV9nZW1fb2JqZWN0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpk
YXRhKQogCiAJc2VxX3B1dGMobSwgJ1xuJyk7CiAKLQlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVw
dGlibGUoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7
Ci0KIAlwcmludF9jb250ZXh0X3N0YXRzKG0sIGk5MTUpOwotCW11dGV4X3VubG9jaygmaTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTE0OTMsMTkgKzE1MDAsMTkg
QEAgc3RhdGljIHZvaWQgZGVzY3JpYmVfY3R4X3Jpbmcoc3RydWN0IHNlcV9maWxlICptLCBzdHJ1
Y3QgaW50ZWxfcmluZyAqcmluZykKIAogc3RhdGljIGludCBpOTE1X2NvbnRleHRfc3RhdHVzKHN0
cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQogewotCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07Ci0Jc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eDsKLQlpbnQgcmV0OwotCi0JcmV0ID0gbXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZkZXYtPnN0
cnVjdF9tdXRleCk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKKwlzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dCAqY3R4LCAqY247CiAKLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGN0eCwgJmRldl9w
cml2LT5jb250ZXh0cy5saXN0LCBsaW5rKSB7CisJc3Bpbl9sb2NrKCZpOTE1LT5nZW0uY29udGV4
dHMubG9jayk7CisJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGN0eCwgY24sICZpOTE1LT5nZW0u
Y29udGV4dHMubGlzdCwgbGluaykgewogCQlzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVyIGl0
OwogCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CiAKKwkJaWYgKCFrcmVmX2dldF91bmxlc3Nf
emVybygmY3R4LT5yZWYpKQorCQkJY29udGludWU7CisKKwkJc3Bpbl91bmxvY2soJmk5MTUtPmdl
bS5jb250ZXh0cy5sb2NrKTsKKwogCQlzZXFfcHV0cyhtLCAiSFcgY29udGV4dCAiKTsKIAkJaWYg
KGN0eC0+cGlkKSB7CiAJCQlzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2s7CkBAIC0xNTQwLDkgKzE1
NDcsMTIgQEAgc3RhdGljIGludCBpOTE1X2NvbnRleHRfc3RhdHVzKHN0cnVjdCBzZXFfZmlsZSAq
bSwgdm9pZCAqdW51c2VkKQogCQlpOTE1X2dlbV9jb250ZXh0X3VubG9ja19lbmdpbmVzKGN0eCk7
CiAKIAkJc2VxX3B1dGMobSwgJ1xuJyk7Ci0JfQogCi0JbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVj
dF9tdXRleCk7CisJCXNwaW5fbG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCQlsaXN0
X3NhZmVfcmVzZXRfbmV4dChjdHgsIGNuLCBsaW5rKTsKKwkJaTkxNV9nZW1fY29udGV4dF9wdXQo
Y3R4KTsKKwl9CisJc3Bpbl91bmxvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKIAogCXJl
dHVybiAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKaW5kZXggOTQ5ZjA5YmNhOGJhLi45YWM4
ZDNiMjM0YzMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwpAQCAtMTY2MiwxMCArMTY2Miw4IEBA
IHN0YXRpYyB2b2lkIGk5MTVfZHJpdmVyX3Bvc3RjbG9zZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCiB7CiAJc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0
ZSAqZmlsZV9wcml2ID0gZmlsZS0+ZHJpdmVyX3ByaXY7CiAKLQltdXRleF9sb2NrKCZkZXYtPnN0
cnVjdF9tdXRleCk7CiAJaTkxNV9nZW1fY29udGV4dF9jbG9zZShmaWxlKTsKIAlpOTE1X2dlbV9y
ZWxlYXNlKGRldiwgZmlsZSk7Ci0JbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7CiAK
IAlrZnJlZV9yY3UoZmlsZV9wcml2LCByY3UpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAppbmRl
eCA3OWRkYjQ0YjgzNGQuLmM5MWJkZDhiZDEyNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCkBA
IC0xNTM2LDI1ICsxNTM2LDYgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgewogCWludCBhdWRp
b19wb3dlcl9yZWZjb3VudDsKIAl1MzIgYXVkaW9fZnJlcV9jbnRybDsKIAotCXN0cnVjdCB7Ci0J
CXN0cnVjdCBtdXRleCBtdXRleDsKLQkJc3RydWN0IGxpc3RfaGVhZCBsaXN0OwotCQlzdHJ1Y3Qg
bGxpc3RfaGVhZCBmcmVlX2xpc3Q7Ci0JCXN0cnVjdCB3b3JrX3N0cnVjdCBmcmVlX3dvcms7Ci0K
LQkJLyogVGhlIGh3IHdhbnRzIHRvIGhhdmUgYSBzdGFibGUgY29udGV4dCBpZGVudGlmaWVyIGZv
ciB0aGUKLQkJICogbGlmZXRpbWUgb2YgdGhlIGNvbnRleHQgKGZvciBPQSwgUEFTSUQsIGZhdWx0
cywgZXRjKS4KLQkJICogVGhpcyBpcyBsaW1pdGVkIGluIGV4ZWNsaXN0cyB0byAyMSBiaXRzLgot
CQkgKi8KLQkJc3RydWN0IGlkYSBod19pZGE7Ci0jZGVmaW5lIE1BWF9DT05URVhUX0hXX0lEICgx
PDwyMSkgLyogZXhjbHVzaXZlICovCi0jZGVmaW5lIE1BWF9HVUNfQ09OVEVYVF9IV19JRCAoMSA8
PCAyMCkgLyogZXhjbHVzaXZlICovCi0jZGVmaW5lIEdFTjExX01BWF9DT05URVhUX0hXX0lEICgx
PDwxMSkgLyogZXhjbHVzaXZlICovCi0vKiBpbiBHZW4xMiBJRCAweDdGRiBpcyByZXNlcnZlZCB0
byBpbmRpY2F0ZSBpZGxlICovCi0jZGVmaW5lIEdFTjEyX01BWF9DT05URVhUX0hXX0lECShHRU4x
MV9NQVhfQ09OVEVYVF9IV19JRCAtIDEpCi0JCXN0cnVjdCBsaXN0X2hlYWQgaHdfaWRfbGlzdDsK
LQl9IGNvbnRleHRzOwotCiAJdTMyIGZkaV9yeF9jb25maWc7CiAKIAkvKiBTaGFkb3cgZm9yIERJ
U1BMQVlfUEhZX0NPTlRST0wgd2hpY2ggY2FuJ3QgYmUgc2FmZWx5IHJlYWQgKi8KQEAgLTE3MTAs
NiArMTY5MSwxNCBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSB7CiAKIAlzdHJ1Y3QgewogCQlz
dHJ1Y3Qgbm90aWZpZXJfYmxvY2sgcG1fbm90aWZpZXI7CisKKwkJc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHRzIHsKKwkJCXNwaW5sb2NrX3QgbG9jazsgLyogbG9ja3MgbGlzdCAqLworCQkJc3RydWN0
IGxpc3RfaGVhZCBsaXN0OworCisJCQlzdHJ1Y3QgbGxpc3RfaGVhZCBmcmVlX2xpc3Q7CisJCQlz
dHJ1Y3Qgd29ya19zdHJ1Y3QgZnJlZV93b3JrOworCQl9IGNvbnRleHRzOwogCX0gZ2VtOwogCiAJ
LyogRm9yIGk5NDVnbSB2YmxhbmsgaXJxIHZzLiBDMyB3b3JrYXJvdW5kICovCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW0uYwppbmRleCA1YTY2NGJkZWFkOGMuLmY2ZGI0MTU5ODVkNSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbS5jCkBAIC0xMjY2LDcgKzEyNjYsNyBAQCBpbnQgaTkxNV9nZW1faW5pdChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCWdvdG8gZXJyX3VubG9jazsKIAl9CiAK
LQlyZXQgPSBpOTE1X2dlbV9jb250ZXh0c19pbml0KGRldl9wcml2KTsKKwlyZXQgPSBpOTE1X2dl
bV9pbml0X2NvbnRleHRzKGRldl9wcml2KTsKIAlpZiAocmV0KSB7CiAJCUdFTV9CVUdfT04ocmV0
ID09IC1FSU8pOwogCQlnb3RvIGVycl9zY3JhdGNoOwpAQCAtMTM0OCw3ICsxMzQ4LDcgQEAgaW50
IGk5MTVfZ2VtX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCX0KIGVy
cl9jb250ZXh0OgogCWlmIChyZXQgIT0gLUVJTykKLQkJaTkxNV9nZW1fY29udGV4dHNfZmluaShk
ZXZfcHJpdik7CisJCWk5MTVfZ2VtX2RyaXZlcl9yZWxlYXNlX19jb250ZXh0cyhkZXZfcHJpdik7
CiBlcnJfc2NyYXRjaDoKIAlpbnRlbF9ndF9kcml2ZXJfcmVsZWFzZSgmZGV2X3ByaXYtPmd0KTsK
IGVycl91bmxvY2s6CkBAIC0xNDE2LDExICsxNDE2LDkgQEAgdm9pZCBpOTE1X2dlbV9kcml2ZXJf
cmVtb3ZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogdm9pZCBpOTE1X2dl
bV9kcml2ZXJfcmVsZWFzZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0J
bXV0ZXhfbG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWludGVsX2VuZ2luZXNf
Y2xlYW51cChkZXZfcHJpdik7Ci0JaTkxNV9nZW1fY29udGV4dHNfZmluaShkZXZfcHJpdik7CisJ
aTkxNV9nZW1fZHJpdmVyX3JlbGVhc2VfX2NvbnRleHRzKGRldl9wcml2KTsKIAlpbnRlbF9ndF9k
cml2ZXJfcmVsZWFzZSgmZGV2X3ByaXYtPmd0KTsKLQltdXRleF91bmxvY2soJmRldl9wcml2LT5k
cm0uc3RydWN0X211dGV4KTsKIAogCWludGVsX3dhX2xpc3RfZnJlZSgmZGV2X3ByaXYtPmd0X3dh
X2xpc3QpOwogCkBAIC0xNDMwLDcgKzE0MjgsNyBAQCB2b2lkIGk5MTVfZ2VtX2RyaXZlcl9yZWxl
YXNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogCWk5MTVfZ2VtX2RyYWlu
X2ZyZWVkX29iamVjdHMoZGV2X3ByaXYpOwogCi0JV0FSTl9PTighbGlzdF9lbXB0eSgmZGV2X3By
aXYtPmNvbnRleHRzLmxpc3QpKTsKKwlXQVJOX09OKCFsaXN0X2VtcHR5KCZkZXZfcHJpdi0+Z2Vt
LmNvbnRleHRzLmxpc3QpKTsKIH0KIAogdm9pZCBpOTE1X2dlbV9pbml0X21taW8oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbV9ndHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCmluZGV4
IDFkMjY2MzRjYTU5Ny4uNGRkNjY3ODU0ZDRkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbV9ndHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9n
dHQuYwpAQCAtMTM2Niw3ICsxMzY2LDkgQEAgc3RhdGljIGludCBnZW44X2luaXRfc2NyYXRjaChz
dHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKIAlpZiAodm0tPmhhc19yZWFkX29ubHkgJiYK
IAkgICAgdm0tPmk5MTUtPmtlcm5lbF9jb250ZXh0ICYmCiAJICAgIHZtLT5pOTE1LT5rZXJuZWxf
Y29udGV4dC0+dm0pIHsKLQkJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqY2xvbmUgPSB2bS0+
aTkxNS0+a2VybmVsX2NvbnRleHQtPnZtOworCQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICpj
bG9uZSA9CisJCQlyY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKHZtLT5pOTE1LT5rZXJuZWxfY29u
dGV4dC0+dm0sCisJCQkJCQkgIHRydWUpOwogCiAJCUdFTV9CVUdfT04oIWNsb25lLT5oYXNfcmVh
ZF9vbmx5KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwppbmRleCBlY2ZiYzM3YjczOGIuLjIz
MTM4OGQwNmM4MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKQEAgLTE4NTMsOCArMTg1Myw4
IEBAIHN0YXRpYyBpbnQgZ2VuOF9jb25maWd1cmVfYWxsX2NvbnRleHRzKHN0cnVjdCBpOTE1X3Bl
cmZfc3RyZWFtICpzdHJlYW0sCiAJfTsKICN1bmRlZiBjdHhfZmxleGV1TgogCXN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZTsKLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OwotCWlu
dCBpOworCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsICpjbjsKKwlpbnQgaSwgZXJyOwog
CiAJZm9yIChpID0gMjsgaSA8IEFSUkFZX1NJWkUocmVncyk7IGkrKykKIAkJcmVnc1tpXS52YWx1
ZSA9IG9hX2NvbmZpZ19mbGV4X3JlZyhvYV9jb25maWcsIHJlZ3NbaV0ucmVnKTsKQEAgLTE4Nzcs
MTYgKzE4NzcsMjcgQEAgc3RhdGljIGludCBnZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3Ry
dWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKIAkgKiBjb250ZXh0LiBDb250ZXh0cyBpZGxl
IGF0IHRoZSB0aW1lIG9mIHJlY29uZmlndXJhdGlvbiBhcmUgbm90CiAJICogdHJhcHBlZCBiZWhp
bmQgdGhlIGJhcnJpZXIuCiAJICovCi0JbGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsICZpOTE1LT5j
b250ZXh0cy5saXN0LCBsaW5rKSB7Ci0JCWludCBlcnI7Ci0KKwlzcGluX2xvY2soJmk5MTUtPmdl
bS5jb250ZXh0cy5sb2NrKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoY3R4LCBjbiwgJmk5
MTUtPmdlbS5jb250ZXh0cy5saXN0LCBsaW5rKSB7CiAJCWlmIChjdHggPT0gaTkxNS0+a2VybmVs
X2NvbnRleHQpCiAJCQljb250aW51ZTsKIAorCQlpZiAoIWtyZWZfZ2V0X3VubGVzc196ZXJvKCZj
dHgtPnJlZikpCisJCQljb250aW51ZTsKKworCQlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRl
eHRzLmxvY2spOworCiAJCWVyciA9IGdlbjhfY29uZmlndXJlX2NvbnRleHQoY3R4LCByZWdzLCBB
UlJBWV9TSVpFKHJlZ3MpKTsKLQkJaWYgKGVycikKKwkJaWYgKGVycikgeworCQkJaTkxNV9nZW1f
Y29udGV4dF9wdXQoY3R4KTsKIAkJCXJldHVybiBlcnI7CisJCX0KKworCQlzcGluX2xvY2soJmk5
MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKKwkJbGlzdF9zYWZlX3Jlc2V0X25leHQoY3R4LCBjbiwg
bGluayk7CisJCWk5MTVfZ2VtX2NvbnRleHRfcHV0KGN0eCk7CiAJfQorCXNwaW5fdW5sb2NrKCZp
OTE1LT5nZW0uY29udGV4dHMubG9jayk7CiAKIAkvKgogCSAqIEFmdGVyIHVwZGF0aW5nIGFsbCBv
dGhlciBjb250ZXh0cywgd2UgbmVlZCB0byBtb2RpZnkgb3Vyc2VsdmVzLgpAQCAtMTg5NSw3ICsx
OTA2LDYgQEAgc3RhdGljIGludCBnZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3RydWN0IGk5
MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSwKIAkgKi8KIAlmb3JfZWFjaF91YWJpX2VuZ2luZShlbmdp
bmUsIGk5MTUpIHsKIAkJc3RydWN0IGludGVsX2NvbnRleHQgKmNlID0gZW5naW5lLT5rZXJuZWxf
Y29udGV4dDsKLQkJaW50IGVycjsKIAogCQlpZiAoZW5naW5lLT5jbGFzcyAhPSBSRU5ERVJfQ0xB
U1MpCiAJCQljb250aW51ZTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
c3lzZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYwppbmRleCBkYTBjZmNj
NjU4MDIuLjJjYTEwMTNhZTY5MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9zeXNmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYwpAQCAtMTQ1
LDkgKzE0NSw5IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIG1lZGlhX3Jj
Nl9hdHRyX2dyb3VwID0gewogfTsKICNlbmRpZgogCi1zdGF0aWMgaW50IGwzX2FjY2Vzc192YWxp
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGxvZmZfdCBvZmZzZXQpCitzdGF0
aWMgaW50IGwzX2FjY2Vzc192YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgbG9m
Zl90IG9mZnNldCkKIHsKLQlpZiAoIUhBU19MM19EUEYoZGV2X3ByaXYpKQorCWlmICghSEFTX0wz
X0RQRihpOTE1KSkKIAkJcmV0dXJuIC1FUEVSTTsKIAogCWlmIChvZmZzZXQgJSA0ICE9IDApCkBA
IC0xNjUsMzEgKzE2NSwyNCBAQCBpOTE1X2wzX3JlYWQoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVj
dCBrb2JqZWN0ICprb2JqLAogCSAgICAgbG9mZl90IG9mZnNldCwgc2l6ZV90IGNvdW50KQogewog
CXN0cnVjdCBkZXZpY2UgKmtkZXYgPSBrb2JqX3RvX2Rldihrb2JqKTsKLQlzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Ci0Jc3RydWN0
IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+ZHJtOworCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwogCWludCBzbGljZSA9IChpbnQp
KHVpbnRwdHJfdClhdHRyLT5wcml2YXRlOwogCWludCByZXQ7CiAKLQljb3VudCA9IHJvdW5kX2Rv
d24oY291bnQsIDQpOwotCi0JcmV0ID0gbDNfYWNjZXNzX3ZhbGlkKGRldl9wcml2LCBvZmZzZXQp
OworCXJldCA9IGwzX2FjY2Vzc192YWxpZChpOTE1LCBvZmZzZXQpOwogCWlmIChyZXQpCiAJCXJl
dHVybiByZXQ7CiAKKwljb3VudCA9IHJvdW5kX2Rvd24oY291bnQsIDQpOwogCWNvdW50ID0gbWlu
X3Qoc2l6ZV90LCBHRU43X0wzTE9HX1NJWkUgLSBvZmZzZXQsIGNvdW50KTsKKwltZW1zZXQoYnVm
LCAwLCBjb3VudCk7CiAKLQlyZXQgPSBpOTE1X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZShkZXYp
OwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7Ci0KLQlpZiAoZGV2X3ByaXYtPmwzX3Bhcml0eS5y
ZW1hcF9pbmZvW3NsaWNlXSkKKwlzcGluX2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsK
KwlpZiAoaTkxNS0+bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdKQogCQltZW1jcHkoYnVmLAot
CQkgICAgICAgZGV2X3ByaXYtPmwzX3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNlXSArIChvZmZzZXQv
NCksCisJCSAgICAgICBpOTE1LT5sM19wYXJpdHkucmVtYXBfaW5mb1tzbGljZV0gKyBvZmZzZXQg
LyA0LAogCQkgICAgICAgY291bnQpOwotCWVsc2UKLQkJbWVtc2V0KGJ1ZiwgMCwgY291bnQpOwot
Ci0JbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7CisJc3Bpbl91bmxvY2soJmk5MTUt
PmdlbS5jb250ZXh0cy5sb2NrKTsKIAogCXJldHVybiBjb3VudDsKIH0KQEAgLTIwMCw0NiArMTkz
LDQ2IEBAIGk5MTVfbDNfd3JpdGUoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCBrb2JqZWN0ICpr
b2JqLAogCSAgICAgIGxvZmZfdCBvZmZzZXQsIHNpemVfdCBjb3VudCkKIHsKIAlzdHJ1Y3QgZGV2
aWNlICprZGV2ID0ga29ial90b19kZXYoa29iaik7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2ID0ga2Rldl9taW5vcl90b19pOTE1KGtkZXYpOwotCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IGtkZXZfbWlub3JfdG9faTkxNShrZGV2KTsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4
OwogCWludCBzbGljZSA9IChpbnQpKHVpbnRwdHJfdClhdHRyLT5wcml2YXRlOwotCXUzMiAqKnJl
bWFwX2luZm87CisJdTMyICpyZW1hcF9pbmZvLCAqZnJlZW1lID0gTlVMTDsKIAlpbnQgcmV0Owog
Ci0JcmV0ID0gbDNfYWNjZXNzX3ZhbGlkKGRldl9wcml2LCBvZmZzZXQpOworCXJldCA9IGwzX2Fj
Y2Vzc192YWxpZChpOTE1LCBvZmZzZXQpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKLQly
ZXQgPSBpOTE1X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZShkZXYpOwotCWlmIChyZXQpCi0JCXJl
dHVybiByZXQ7CisJcmVtYXBfaW5mbyA9IGt6YWxsb2MoR0VON19MM0xPR19TSVpFLCBHRlBfS0VS
TkVMKTsKKwlpZiAoIXJlbWFwX2luZm8pCisJCXJldHVybiAtRU5PTUVNOwogCi0JcmVtYXBfaW5m
byA9ICZkZXZfcHJpdi0+bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdOwotCWlmICghKnJlbWFw
X2luZm8pIHsKLQkJKnJlbWFwX2luZm8gPSBremFsbG9jKEdFTjdfTDNMT0dfU0laRSwgR0ZQX0tF
Uk5FTCk7Ci0JCWlmICghKnJlbWFwX2luZm8pIHsKLQkJCXJldCA9IC1FTk9NRU07Ci0JCQlnb3Rv
IG91dDsKLQkJfQorCXNwaW5fbG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCisJaWYg
KGk5MTUtPmwzX3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNlXSkgeworCQlmcmVlbWUgPSByZW1hcF9p
bmZvOworCQlyZW1hcF9pbmZvID0gaTkxNS0+bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdOwor
CX0gZWxzZSB7CisJCWk5MTUtPmwzX3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNlXSA9IHJlbWFwX2lu
Zm87CiAJfQogCi0JLyogVE9ETzogSWRlYWxseSB3ZSByZWFsbHkgd2FudCBhIEdQVSByZXNldCBo
ZXJlIHRvIG1ha2Ugc3VyZSBlcnJvcnMKLQkgKiBhcmVuJ3QgcHJvcGFnYXRlZC4gU2luY2UgSSBj
YW5ub3QgZmluZCBhIHN0YWJsZSB3YXkgdG8gcmVzZXQgdGhlIEdQVQotCSAqIGF0IHRoaXMgcG9p
bnQgaXQgaXMgbGVmdCBhcyBhIFRPRE8uCi0JKi8KLQltZW1jcHkoKnJlbWFwX2luZm8gKyAob2Zm
c2V0LzQpLCBidWYsIGNvdW50KTsKKwljb3VudCA9IHJvdW5kX2Rvd24oY291bnQsIDQpOworCW1l
bWNweShyZW1hcF9pbmZvICsgb2Zmc2V0IC8gNCwgYnVmLCBjb3VudCk7CiAKIAkvKiBOQjogV2Ug
ZGVmZXIgdGhlIHJlbWFwcGluZyB1bnRpbCB3ZSBzd2l0Y2ggdG8gdGhlIGNvbnRleHQgKi8KLQls
aXN0X2Zvcl9lYWNoX2VudHJ5KGN0eCwgJmRldl9wcml2LT5jb250ZXh0cy5saXN0LCBsaW5rKQot
CQljdHgtPnJlbWFwX3NsaWNlIHw9ICgxPDxzbGljZSk7CisJbGlzdF9mb3JfZWFjaF9lbnRyeShj
dHgsICZpOTE1LT5nZW0uY29udGV4dHMubGlzdCwgbGluaykKKwkJY3R4LT5yZW1hcF9zbGljZSB8
PSBCSVQoc2xpY2UpOwogCi0JcmV0ID0gY291bnQ7CisJc3Bpbl91bmxvY2soJmk5MTUtPmdlbS5j
b250ZXh0cy5sb2NrKTsKKwlrZnJlZShmcmVlbWUpOwogCi1vdXQ6Ci0JbXV0ZXhfdW5sb2NrKCZk
ZXYtPnN0cnVjdF9tdXRleCk7CisJLyoKKwkgKiBUT0RPOiBJZGVhbGx5IHdlIHJlYWxseSB3YW50
IGEgR1BVIHJlc2V0IGhlcmUgdG8gbWFrZSBzdXJlIGVycm9ycworCSAqIGFyZW4ndCBwcm9wYWdh
dGVkLiBTaW5jZSBJIGNhbm5vdCBmaW5kIGEgc3RhYmxlIHdheSB0byByZXNldCB0aGUgR1BVCisJ
ICogYXQgdGhpcyBwb2ludCBpdCBpcyBsZWZ0IGFzIGEgVE9ETy4KKwkgKi8KIAotCXJldHVybiBy
ZXQ7CisJcmV0dXJuIGNvdW50OwogfQogCiBzdGF0aWMgY29uc3Qgc3RydWN0IGJpbl9hdHRyaWJ1
dGUgZHBmX2F0dHJzID0gewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90
cmFjZS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCmluZGV4IDFmMmNmNmNm
YWZiNS4uN2VmN2ExZTE2NjRjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3RyYWNlLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCkBAIC05NTIs
NyArOTUyLDcgQEAgREVDTEFSRV9FVkVOVF9DTEFTUyhpOTE1X2NvbnRleHQsCiAJVFBfZmFzdF9h
c3NpZ24oCiAJCQlfX2VudHJ5LT5kZXYgPSBjdHgtPmk5MTUtPmRybS5wcmltYXJ5LT5pbmRleDsK
IAkJCV9fZW50cnktPmN0eCA9IGN0eDsKLQkJCV9fZW50cnktPnZtID0gY3R4LT52bTsKKwkJCV9f
ZW50cnktPnZtID0gcmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pOwogCSksCiAKIAlUUF9wcmlu
dGsoImRldj0ldSwgY3R4PSVwLCBjdHhfdm09JXAiLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaTkxNV9nZW0uYwppbmRleCAwMzQ2YzNlNWI2YjYuLmJmYTQwYTViNmQ5OCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMKQEAgLTEzOCwxMSArMTM4LDkg
QEAgc3RhdGljIGludCBpZ3RfZ2VtX3N1c3BlbmQodm9pZCAqYXJnKQogCQlyZXR1cm4gUFRSX0VS
UihmaWxlKTsKIAogCWVyciA9IC1FTk9NRU07Ci0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVj
dF9tdXRleCk7CiAJY3R4ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmICghSVNfRVJS
KGN0eCkpCiAJCWVyciA9IHN3aXRjaF90b19jb250ZXh0KGk5MTUsIGN0eCk7Ci0JbXV0ZXhfdW5s
b2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlpZiAoZXJyKQogCQlnb3RvIG91dDsKIApA
QCAtMTU3LDkgKzE1NSw3IEBAIHN0YXRpYyBpbnQgaWd0X2dlbV9zdXNwZW5kKHZvaWQgKmFyZykK
IAogCXBtX3Jlc3VtZShpOTE1KTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwogCWVyciA9IHN3aXRjaF90b19jb250ZXh0KGk5MTUsIGN0eCk7Ci0JbXV0ZXhfdW5sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIG91dDoKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBm
aWxlKTsKIAlyZXR1cm4gZXJyOwpAQCAtMTc3LDExICsxNzMsOSBAQCBzdGF0aWMgaW50IGlndF9n
ZW1faGliZXJuYXRlKHZvaWQgKmFyZykKIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7CiAKIAllcnIg
PSAtRU5PTUVNOwotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWN0eCA9
IGxpdmVfY29udGV4dChpOTE1LCBmaWxlKTsKIAlpZiAoIUlTX0VSUihjdHgpKQogCQllcnIgPSBz
d2l0Y2hfdG9fY29udGV4dChpOTE1LCBjdHgpOwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7CiAJaWYgKGVycikKIAkJZ290byBvdXQ7CiAKQEAgLTE5Niw5ICsxOTAsNyBA
QCBzdGF0aWMgaW50IGlndF9nZW1faGliZXJuYXRlKHZvaWQgKmFyZykKIAogCXBtX3Jlc3VtZShp
OTE1KTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWVyciA9IHN3
aXRjaF90b19jb250ZXh0KGk5MTUsIGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKIG91dDoKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAlyZXR1cm4g
ZXJyOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2Vt
X2V2aWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3Qu
YwppbmRleCBmMzlmMDI4MmU3OGMuLjBhZjlhNThkMDExZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMKQEAgLTQ3Myw3ICs0NzMsNiBAQCBz
dGF0aWMgaW50IGlndF9ldmljdF9jb250ZXh0cyh2b2lkICphcmcpCiAJCX0KIAogCQljb3VudCA9
IDA7Ci0JCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQlvbnN0YWNrX2Zl
bmNlX2luaXQoJmZlbmNlKTsKIAkJZG8gewogCQkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CkBA
IC01MTAsOCArNTA5LDYgQEAgc3RhdGljIGludCBpZ3RfZXZpY3RfY29udGV4dHModm9pZCAqYXJn
KQogCQkJY291bnQrKzsKIAkJCWVyciA9IDA7CiAJCX0gd2hpbGUoMSk7Ci0JCW11dGV4X3VubG9j
aygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAkJb25zdGFja19mZW5jZV9maW5pKCZmZW5j
ZSk7CiAJCXByX2luZm8oIlN1Ym1pdHRlZCAlbHUgY29udGV4dHMvcmVxdWVzdHMgb24gJXNcbiIs
CiAJCQljb3VudCwgZW5naW5lLT5uYW1lKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0
ZXN0cy9pOTE1X2dlbV9ndHQuYwppbmRleCA5OTM5ZGQ0MGM2YTguLmJkZDMzNmE1MmY5MCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYwpAQCAtMTI0
Niw2ICsxMjQ2LDcgQEAgc3RhdGljIGludCBleGVyY2lzZV9tb2NrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAogCQkJCSAgICAgdW5zaWduZWQgbG9uZyBlbmRfdGltZSkpCiB7CiAJY29u
c3QgdTY0IGxpbWl0ID0gdG90YWxyYW1fcGFnZXMoKSA8PCBQQUdFX1NISUZUOworCXN0cnVjdCBp
OTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CiAJ
SUdUX1RJTUVPVVQoZW5kX3RpbWUpOwogCWludCBlcnI7CkBAIC0xMjU0LDcgKzEyNTUsOCBAQCBz
dGF0aWMgaW50IGV4ZXJjaXNlX21vY2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJ
aWYgKCFjdHgpCiAJCXJldHVybiAtRU5PTUVNOwogCi0JZXJyID0gZnVuYyhpOTE1LCBjdHgtPnZt
LCAwLCBtaW4oY3R4LT52bS0+dG90YWwsIGxpbWl0KSwgZW5kX3RpbWUpOworCXZtID0gcmN1X2Rl
cmVmZXJlbmNlX3Byb3RlY3RlZChjdHgtPnZtLCB0cnVlKTsKKwllcnIgPSBmdW5jKGk5MTUsIHZt
LCAwLCBtaW4odm0tPnRvdGFsLCBsaW1pdCksIGVuZF90aW1lKTsKIAogCW1vY2tfY29udGV4dF9j
bG9zZShjdHgpOwogCXJldHVybiBlcnI7CkBAIC0xNzk4LDcgKzE4MDAsNyBAQCBzdGF0aWMgaW50
IGlndF9jc190bGIodm9pZCAqYXJnKQogCQlnb3RvIG91dF91bmxvY2s7CiAJfQogCi0Jdm0gPSBj
dHgtPnZtOworCXZtID0gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChjdHgtPnZtLCB0cnVlKTsK
IAlpZiAoIXZtKQogCQlnb3RvIG91dF91bmxvY2s7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L3NlbGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYwppbmRleCBkN2Q2OGM2YTZiZDUuLjI0N2UzYmE2MTk0
OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfcmVxdWVz
dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYwpA
QCAtMTgxLDkgKzE4MSw3IEBAIHN0YXRpYyBpbnQgaWd0X3JlcXVlc3RfcmV3aW5kKHZvaWQgKmFy
ZykKIAlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CiAJaW50IGVyciA9IC1FSU5WQUw7CiAKLQlt
dXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAljdHhbMF0gPSBtb2NrX2NvbnRl
eHQoaTkxNSwgIkEiKTsKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwog
CiAJY2UgPSBpOTE1X2dlbV9jb250ZXh0X2dldF9lbmdpbmUoY3R4WzBdLCBSQ1MwKTsKIAlHRU1f
QlVHX09OKElTX0VSUihjZSkpOwpAQCAtMTk3LDkgKzE5NSw3IEBAIHN0YXRpYyBpbnQgaWd0X3Jl
cXVlc3RfcmV3aW5kKHZvaWQgKmFyZykKIAlpOTE1X3JlcXVlc3RfZ2V0KHJlcXVlc3QpOwogCWk5
MTVfcmVxdWVzdF9hZGQocmVxdWVzdCk7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKIAljdHhbMV0gPSBtb2NrX2NvbnRleHQoaTkxNSwgIkIiKTsKLQltdXRleF91bmxv
Y2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJY2UgPSBpOTE1X2dlbV9jb250ZXh0X2dl
dF9lbmdpbmUoY3R4WzFdLCBSQ1MwKTsKIAlHRU1fQlVHX09OKElTX0VSUihjZSkpOwpAQCAtNDM4
LDkgKzQzNCw3IEBAIHN0YXRpYyBpbnQgbW9ja19icmVhZGNydW1ic19zbW9rZXRlc3Qodm9pZCAq
YXJnKQogCX0KIAogCWZvciAobiA9IDA7IG4gPCB0Lm5jb250ZXh0czsgbisrKSB7Ci0JCW11dGV4
X2xvY2soJnQuZW5naW5lLT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAkJdC5jb250ZXh0c1tu
XSA9IG1vY2tfY29udGV4dCh0LmVuZ2luZS0+aTkxNSwgIm1vY2siKTsKLQkJbXV0ZXhfdW5sb2Nr
KCZ0LmVuZ2luZS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJCWlmICghdC5jb250ZXh0c1tu
XSkgewogCQkJcmV0ID0gLUVOT01FTTsKIAkJCWdvdG8gb3V0X2NvbnRleHRzOwpAQCAtNzM0LDcg
KzcyOCw4IEBAIHN0YXRpYyBpbnQgbGl2ZV9lbXB0eV9yZXF1ZXN0KHZvaWQgKmFyZykKIHN0YXRp
YyBzdHJ1Y3QgaTkxNV92bWEgKnJlY3Vyc2l2ZV9iYXRjaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKIHsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gaTkxNS0+a2VybmVs
X2NvbnRleHQ7Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBjdHgtPnZtID86ICZp
OTE1LT5nZ3R0LnZtOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0KKwkJcmN1X2Rl
cmVmZXJlbmNlX3Byb3RlY3RlZChjdHgtPnZtLCB0cnVlKSA/OiAmaTkxNS0+Z2d0dC52bTsKIAlz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwogCWNvbnN0IGludCBnZW4gPSBJTlRFTF9H
RU4oaTkxNSk7CiAJc3RydWN0IGk5MTVfdm1hICp2bWE7CkBAIC0xMjIwLDkgKzEyMTUsNyBAQCBz
dGF0aWMgaW50IGxpdmVfYnJlYWRjcnVtYnNfc21va2V0ZXN0KHZvaWQgKmFyZykKIAl9CiAKIAlm
b3IgKG4gPSAwOyBuIDwgdFswXS5uY29udGV4dHM7IG4rKykgewotCQltdXRleF9sb2NrKCZpOTE1
LT5kcm0uc3RydWN0X211dGV4KTsKIAkJdFswXS5jb250ZXh0c1tuXSA9IGxpdmVfY29udGV4dChp
OTE1LCBmaWxlKTsKLQkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAkJ
aWYgKCF0WzBdLmNvbnRleHRzW25dKSB7CiAJCQlyZXQgPSAtRU5PTUVNOwogCQkJZ290byBvdXRf
Y29udGV4dHM7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkx
NV92bWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3ZtYS5jCmluZGV4
IGFjMWZmNTU4ZWI5MC4uZjZlNmIwYWFlMzhjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaTkxNV92bWEuYwpAQCAtMzgsNyArMzgsNyBAQCBzdGF0aWMgYm9vbCBhc3NlcnRfdm1h
KHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogewogCWJvb2wgb2sgPSB0cnVlOwogCi0JaWYgKHZtYS0+
dm0gIT0gY3R4LT52bSkgeworCWlmICh2bWEtPnZtICE9IHJjdV9hY2Nlc3NfcG9pbnRlcihjdHgt
PnZtKSkgewogCQlwcl9lcnIoIlZNQSBjcmVhdGVkIHdpdGggd3JvbmcgVk1cbiIpOwogCQlvayA9
IGZhbHNlOwogCX0KQEAgLTExMyw3ICsxMTMsOCBAQCBzdGF0aWMgaW50IGNyZWF0ZV92bWFzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCWxpc3RfZm9yX2VhY2hfZW50cnkob2JqLCBv
YmplY3RzLCBzdF9saW5rKSB7CiAJCWZvciAocGlubmVkID0gMDsgcGlubmVkIDw9IDE7IHBpbm5l
ZCsrKSB7CiAJCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGN0eCwgY29udGV4dHMsIGxpbmspIHsKLQkJ
CQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGN0eC0+dm07CisJCQkJc3RydWN0IGk5
MTVfYWRkcmVzc19zcGFjZSAqdm0gPQorCQkJCQlyY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKGN0
eC0+dm0sIHRydWUpOwogCQkJCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwogCQkJCWludCBlcnI7CiAK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZp
Y2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYwpp
bmRleCA0ZTZjZGUwZDQ4NTkuLjMzNWYzN2JhOThkZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZpY2UuYwpAQCAtNTksMTEgKzU5LDkgQEAgc3Rh
dGljIHZvaWQgbW9ja19kZXZpY2VfcmVsZWFzZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KQogCiAJ
aTkxNV9nZW1fZHJhaW5fd29ya3F1ZXVlKGk5MTUpOwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7CiAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpCiAJCW1v
Y2tfZW5naW5lX2ZyZWUoZW5naW5lKTsKLQlpOTE1X2dlbV9jb250ZXh0c19maW5pKGk5MTUpOwot
CW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CisJaTkxNV9nZW1fZHJpdmVy
X3JlbGVhc2VfX2NvbnRleHRzKGk5MTUpOwogCiAJaW50ZWxfdGltZWxpbmVzX2ZpbmkoaTkxNSk7
CiAKQEAgLTIwNiw3ICsyMDQsNyBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqbW9ja19nZW1f
ZGV2aWNlKHZvaWQpCiAJcmV0dXJuIGk5MTU7CiAKIGVycl9jb250ZXh0OgotCWk5MTVfZ2VtX2Nv
bnRleHRzX2ZpbmkoaTkxNSk7CisJaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2VfX2NvbnRleHRzKGk5
MTUpOwogZXJyX2VuZ2luZToKIAltb2NrX2VuZ2luZV9mcmVlKGk5MTUtPmVuZ2luZVtSQ1MwXSk7
CiBlcnJfdW5sb2NrOgotLSAKMi4yMy4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5m
cmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0
aW5mby9pbnRlbC1nZng=

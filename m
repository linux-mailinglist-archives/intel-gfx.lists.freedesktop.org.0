Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 50B6AB28C4
	for <lists+intel-gfx@lfdr.de>; Sat, 14 Sep 2019 01:06:24 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 509176F4A0;
	Fri, 13 Sep 2019 23:06:22 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga14.intel.com (mga14.intel.com [192.55.52.115])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1BDC86F49F
 for <intel-gfx@lists.freedesktop.org>; Fri, 13 Sep 2019 23:06:21 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga005.jf.intel.com ([10.7.209.41])
 by fmsmga103.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 13 Sep 2019 16:06:20 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,489,1559545200"; d="scan'208";a="360924426"
Received: from unerlige-desk.jf.intel.com ([10.165.21.198])
 by orsmga005.jf.intel.com with ESMTP; 13 Sep 2019 16:06:20 -0700
From: Umesh Nerlige Ramappa <umesh.nerlige.ramappa@intel.com>
To: Umesh Nerlige Ramappa <umesh.nerlige.ramappa@intel.com>,
 Lionel G Landwerlin <lionel.g.landwerlin@intel.com>,
 intel-gfx@lists.freedesktop.org
Date: Fri, 13 Sep 2019 16:06:19 -0700
Message-Id: <20190913230620.15906-3-umesh.nerlige.ramappa@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190913230620.15906-1-umesh.nerlige.ramappa@intel.com>
References: <20190913230620.15906-1-umesh.nerlige.ramappa@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 2/3] drm/i915/perf: Add support for report sizes
 that are not power of 2
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T0EgcGVyZiB1bml0IHN1cHBvcnRzIG5vbi1wb3dlciBvZiAyIHJlcG9ydCBzaXplcy4gRW5hYmxl
IHN1cHBvcnQgZm9yCnRoZXNlIHNpemVzIGluIHRoZSBkcml2ZXIuCgpTaWduZWQtb2ZmLWJ5OiBV
bWVzaCBOZXJsaWdlIFJhbWFwcGEgPHVtZXNoLm5lcmxpZ2UucmFtYXBwYUBpbnRlbC5jb20+Ci0t
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMgfCA1OSArKysrKysrKysrKystLS0t
LS0tLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDIxIGluc2VydGlvbnMoKyksIDM4IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKaW5kZXggNTBiNmQxNTRmZDQ2Li40
ODJmY2EzZGE3ZGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCkBAIC00NTAsNyArNDUwLDcg
QEAgc3RhdGljIGJvb2wgb2FfYnVmZmVyX2NoZWNrX3VubG9ja2VkKHN0cnVjdCBpOTE1X3BlcmZf
c3RyZWFtICpzdHJlYW0pCiAJdTMyIGd0dF9vZmZzZXQgPSBpOTE1X2dndHRfb2Zmc2V0KHN0cmVh
bS0+b2FfYnVmZmVyLnZtYSk7CiAJaW50IHJlcG9ydF9zaXplID0gc3RyZWFtLT5vYV9idWZmZXIu
Zm9ybWF0X3NpemU7CiAJdW5zaWduZWQgbG9uZyBmbGFnczsKLQl1MzIgaHdfdGFpbDsKKwl1MzIg
aHdfdGFpbCwgYWdpbmdfdGFpbDsKIAl1NjQgbm93OwogCiAJLyogV2UgaGF2ZSB0byBjb25zaWRl
ciB0aGUgKHVubGlrZWx5KSBwb3NzaWJpbGl0eSB0aGF0IHJlYWQoKSBlcnJvcnMKQEAgLTQ1OSwx
NiArNDU5LDE3IEBAIHN0YXRpYyBib29sIG9hX2J1ZmZlcl9jaGVja191bmxvY2tlZChzdHJ1Y3Qg
aTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQogCSAqLwogCXNwaW5fbG9ja19pcnFzYXZlKCZzdHJl
YW0tPm9hX2J1ZmZlci5wdHJfbG9jaywgZmxhZ3MpOwogCi0JaHdfdGFpbCA9IGRldl9wcml2LT5w
ZXJmLm9wcy5vYV9od190YWlsX3JlYWQoc3RyZWFtKTsKKwlod190YWlsID0gZGV2X3ByaXYtPnBl
cmYub3BzLm9hX2h3X3RhaWxfcmVhZChzdHJlYW0pIC0gZ3R0X29mZnNldDsKKwlhZ2luZ190YWls
ID0gc3RyZWFtLT5vYV9idWZmZXIuYWdpbmdfdGFpbCAtIGd0dF9vZmZzZXQ7CiAKIAkvKiBUaGUg
dGFpbCBwb2ludGVyIGluY3JlYXNlcyBpbiA2NCBieXRlIGluY3JlbWVudHMsCiAJICogbm90IGlu
IHJlcG9ydF9zaXplIHN0ZXBzLi4uCiAJICovCi0JaHdfdGFpbCAmPSB+KHJlcG9ydF9zaXplIC0g
MSk7CisJaHdfdGFpbCA9IE9BX1RBS0VOKGh3X3RhaWwsIChPQV9UQUtFTihod190YWlsLCBhZ2lu
Z190YWlsKSAlIHJlcG9ydF9zaXplKSk7CiAKIAlub3cgPSBrdGltZV9nZXRfbW9ub19mYXN0X25z
KCk7CiAKLQlpZiAoaHdfdGFpbCA9PSBzdHJlYW0tPm9hX2J1ZmZlci5hZ2luZ190YWlsKSB7CisJ
aWYgKGh3X3RhaWwgPT0gYWdpbmdfdGFpbCkgewogCQkvKiBJZiB0aGUgSFcgdGFpbCBoYXNuJ3Qg
bW92ZSBzaW5jZSB0aGUgbGFzdCBjaGVjayBhbmQgdGhlIEhXCiAJCSAqIHRhaWwgaGFzIGJlZW4g
YWdpbmcgZm9yIGxvbmcgZW5vdWdoLCBkZWNsYXJlIGl0IHRoZSBuZXcKIAkJICogdGFpbC4KQEAg
LTQ4Niw4ICs0ODcsNiBAQCBzdGF0aWMgYm9vbCBvYV9idWZmZXJfY2hlY2tfdW5sb2NrZWQoc3Ry
dWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKIAkJICogYSByZWFkKCkgaW4gcHJvZ3Jlc3Mu
CiAJCSAqLwogCQloZWFkID0gc3RyZWFtLT5vYV9idWZmZXIuaGVhZCAtIGd0dF9vZmZzZXQ7Ci0K
LQkJaHdfdGFpbCAtPSBndHRfb2Zmc2V0OwogCQl0YWlsID0gaHdfdGFpbDsKIAogCQkvKiBXYWxr
IHRoZSBzdHJlYW0gYmFja3dhcmQgdW50aWwgd2UgZmluZCBhdCBsZWFzdCAyIHJlcG9ydHMKQEAg
LTYxMyw3ICs2MTIsMTggQEAgc3RhdGljIGludCBhcHBlbmRfb2Ffc2FtcGxlKHN0cnVjdCBpOTE1
X3BlcmZfc3RyZWFtICpzdHJlYW0sCiAJYnVmICs9IHNpemVvZihoZWFkZXIpOwogCiAJaWYgKHNh
bXBsZV9mbGFncyAmIFNBTVBMRV9PQV9SRVBPUlQpIHsKLQkJaWYgKGNvcHlfdG9fdXNlcihidWYs
IHJlcG9ydCwgcmVwb3J0X3NpemUpKQorCQl1OCAqb2FfYnVmX2VuZCA9IHN0cmVhbS0+b2FfYnVm
ZmVyLnZhZGRyICsgT0FfQlVGRkVSX1NJWkU7CisJCWludCByZXBvcnRfc2l6ZV9wYXJ0aWFsID0g
b2FfYnVmX2VuZCAtIHJlcG9ydDsKKworCQlpZiAocmVwb3J0X3NpemVfcGFydGlhbCA8IHJlcG9y
dF9zaXplKSB7CisJCQlpZiAoY29weV90b191c2VyKGJ1ZiwgcmVwb3J0LCByZXBvcnRfc2l6ZV9w
YXJ0aWFsKSkKKwkJCQlyZXR1cm4gLUVGQVVMVDsKKwkJCWJ1ZiArPSByZXBvcnRfc2l6ZV9wYXJ0
aWFsOworCisJCQlpZiAoY29weV90b191c2VyKGJ1Ziwgc3RyZWFtLT5vYV9idWZmZXIudmFkZHIs
CisJCQkJCXJlcG9ydF9zaXplIC0gcmVwb3J0X3NpemVfcGFydGlhbCkpCisJCQkJcmV0dXJuIC1F
RkFVTFQ7CisJCX0gZWxzZSBpZiAoY29weV90b191c2VyKGJ1ZiwgcmVwb3J0LCByZXBvcnRfc2l6
ZSkpCiAJCQlyZXR1cm4gLUVGQVVMVDsKIAl9CiAKQEAgLTY4Miw4ICs2OTIsOCBAQCBzdGF0aWMg
aW50IGdlbjhfYXBwZW5kX29hX3JlcG9ydHMoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVh
bSwKIAkgKiBvbmx5IGJlIGluY3JlbWVudGVkIGJ5IG11bHRpcGxlcyBvZiB0aGUgcmVwb3J0IHNp
emUgKG5vdGFibHkgYWxzbwogCSAqIGFsbCBhIHBvd2VyIG9mIHR3bykuCiAJICovCi0JaWYgKFdB
Uk5fT05DRShoZWFkID4gT0FfQlVGRkVSX1NJWkUgfHwgaGVhZCAlIHJlcG9ydF9zaXplIHx8Ci0J
CSAgICAgIHRhaWwgPiBPQV9CVUZGRVJfU0laRSB8fCB0YWlsICUgcmVwb3J0X3NpemUsCisJaWYg
KFdBUk5fT05DRShoZWFkID4gT0FfQlVGRkVSX1NJWkUgfHwKKwkJICAgICAgdGFpbCA+IE9BX0JV
RkZFUl9TSVpFLAogCQkgICAgICAiSW5jb25zaXN0ZW50IE9BIGJ1ZmZlciBwb2ludGVyczogaGVh
ZCA9ICV1LCB0YWlsID0gJXVcbiIsCiAJCSAgICAgIGhlYWQsIHRhaWwpKQogCQlyZXR1cm4gLUVJ
TzsKQEAgLTY5NywyMCArNzA3LDYgQEAgc3RhdGljIGludCBnZW44X2FwcGVuZF9vYV9yZXBvcnRz
KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCiAJCXUzMiBjdHhfaWQ7CiAJCXUzMiBy
ZWFzb247CiAKLQkJLyoKLQkJICogQWxsIHRoZSByZXBvcnQgc2l6ZXMgZmFjdG9yIG5lYXRseSBp
bnRvIHRoZSBidWZmZXIKLQkJICogc2l6ZSBzbyB3ZSBuZXZlciBleHBlY3QgdG8gc2VlIGEgcmVw
b3J0IHNwbGl0Ci0JCSAqIGJldHdlZW4gdGhlIGJlZ2lubmluZyBhbmQgZW5kIG9mIHRoZSBidWZm
ZXIuCi0JCSAqCi0JCSAqIEdpdmVuIHRoZSBpbml0aWFsIGFsaWdubWVudCBjaGVjayBhIG1pc2Fs
aWdubWVudAotCQkgKiBoZXJlIHdvdWxkIGltcGx5IGEgZHJpdmVyIGJ1ZyB0aGF0IHdvdWxkIHJl
c3VsdAotCQkgKiBpbiBhbiBvdmVycnVuLgotCQkgKi8KLQkJaWYgKFdBUk5fT04oKE9BX0JVRkZF
Ul9TSVpFIC0gaGVhZCkgPCByZXBvcnRfc2l6ZSkpIHsKLQkJCURSTV9FUlJPUigiU3B1cmlvdXMg
T0EgaGVhZCBwdHI6IG5vbi1pbnRlZ3JhbCByZXBvcnQgb2Zmc2V0XG4iKTsKLQkJCWJyZWFrOwot
CQl9Ci0KIAkJLyoKIAkJICogVGhlIHJlYXNvbiBmaWVsZCBpbmNsdWRlcyBmbGFncyBpZGVudGlm
eWluZyB3aGF0CiAJCSAqIHRyaWdnZXJlZCB0aGlzIHNwZWNpZmljIHJlcG9ydCAobW9zdGx5IHRp
bWVyCkBAIC05NTYsOCArOTUyLDggQEAgc3RhdGljIGludCBnZW43X2FwcGVuZF9vYV9yZXBvcnRz
KHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCiAJICogb25seSBiZSBpbmNyZW1lbnRl
ZCBieSBtdWx0aXBsZXMgb2YgdGhlIHJlcG9ydCBzaXplIChub3RhYmx5IGFsc28KIAkgKiBhbGwg
YSBwb3dlciBvZiB0d28pLgogCSAqLwotCWlmIChXQVJOX09OQ0UoaGVhZCA+IE9BX0JVRkZFUl9T
SVpFIHx8IGhlYWQgJSByZXBvcnRfc2l6ZSB8fAotCQkgICAgICB0YWlsID4gT0FfQlVGRkVSX1NJ
WkUgfHwgdGFpbCAlIHJlcG9ydF9zaXplLAorCWlmIChXQVJOX09OQ0UoaGVhZCA+IE9BX0JVRkZF
Ul9TSVpFIHx8CisJCSAgICAgIHRhaWwgPiBPQV9CVUZGRVJfU0laRSwKIAkJICAgICAgIkluY29u
c2lzdGVudCBPQSBidWZmZXIgcG9pbnRlcnM6IGhlYWQgPSAldSwgdGFpbCA9ICV1XG4iLAogCQkg
ICAgICBoZWFkLCB0YWlsKSkKIAkJcmV0dXJuIC1FSU87CkBAIC05NjksMTkgKzk2NSw2IEBAIHN0
YXRpYyBpbnQgZ2VuN19hcHBlbmRfb2FfcmVwb3J0cyhzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAq
c3RyZWFtLAogCQl1OCAqcmVwb3J0ID0gb2FfYnVmX2Jhc2UgKyBoZWFkOwogCQl1MzIgKnJlcG9y
dDMyID0gKHZvaWQgKilyZXBvcnQ7CiAKLQkJLyogQWxsIHRoZSByZXBvcnQgc2l6ZXMgZmFjdG9y
IG5lYXRseSBpbnRvIHRoZSBidWZmZXIKLQkJICogc2l6ZSBzbyB3ZSBuZXZlciBleHBlY3QgdG8g
c2VlIGEgcmVwb3J0IHNwbGl0Ci0JCSAqIGJldHdlZW4gdGhlIGJlZ2lubmluZyBhbmQgZW5kIG9m
IHRoZSBidWZmZXIuCi0JCSAqCi0JCSAqIEdpdmVuIHRoZSBpbml0aWFsIGFsaWdubWVudCBjaGVj
ayBhIG1pc2FsaWdubWVudAotCQkgKiBoZXJlIHdvdWxkIGltcGx5IGEgZHJpdmVyIGJ1ZyB0aGF0
IHdvdWxkIHJlc3VsdAotCQkgKiBpbiBhbiBvdmVycnVuLgotCQkgKi8KLQkJaWYgKFdBUk5fT04o
KE9BX0JVRkZFUl9TSVpFIC0gaGVhZCkgPCByZXBvcnRfc2l6ZSkpIHsKLQkJCURSTV9FUlJPUigi
U3B1cmlvdXMgT0EgaGVhZCBwdHI6IG5vbi1pbnRlZ3JhbCByZXBvcnQgb2Zmc2V0XG4iKTsKLQkJ
CWJyZWFrOwotCQl9Ci0KIAkJLyogVGhlIHJlcG9ydC1JRCBmaWVsZCBmb3IgcGVyaW9kaWMgc2Ft
cGxlcyBpbmNsdWRlcwogCQkgKiBzb21lIHVuZG9jdW1lbnRlZCBmbGFncyByZWxhdGVkIHRvIHdo
YXQgdHJpZ2dlcmVkCiAJCSAqIHRoZSByZXBvcnQgYW5kIGlzIG5ldmVyIGV4cGVjdGVkIHRvIGJl
IHplcm8gc28gd2UKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vaW50ZWwtZ2Z4

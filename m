Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 20A71B600E
	for <lists+intel-gfx@lfdr.de>; Wed, 18 Sep 2019 11:24:22 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 497276EE77;
	Wed, 18 Sep 2019 09:24:20 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4E48F6EE77
 for <intel-gfx@lists.freedesktop.org>; Wed, 18 Sep 2019 09:24:19 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga001.jf.intel.com ([10.7.209.18])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 18 Sep 2019 02:24:18 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,520,1559545200"; d="scan'208";a="270813458"
Received: from slisovsk-lenovo-ideapad-720s-13ikb.fi.intel.com ([10.237.72.89])
 by orsmga001.jf.intel.com with ESMTP; 18 Sep 2019 02:24:16 -0700
From: Stanislav Lisovskiy <stanislav.lisovskiy@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 18 Sep 2019 12:22:01 +0300
Message-Id: <20190918092201.679-1-stanislav.lisovskiy@intel.com>
X-Mailer: git-send-email 2.17.1
Subject: [Intel-gfx] [PATCH v2] drm/i915: Add TigerLake bandwidth checking
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: ville.syrjala@intel.com, martin.peres@intel.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QWRkZWQgYmFuZHdpZHRoIGNhbGN1bGF0aW9uIGFsZ29yaXRobSBhbmQgY2hlY2tzLApzaW1pbGFy
IHdheSBhcyBpdCB3YXMgZG9uZSBmb3IgSUNMLCBzb21lIGNvbnN0YW50cwp3ZXJlIGNvcnJlY3Rl
ZCBhY2NvcmRpbmcgdG8gQlNwZWMuCgpTaWduZWQtb2ZmLWJ5OiBTdGFuaXNsYXYgTGlzb3Zza2l5
IDxzdGFuaXNsYXYubGlzb3Zza2l5QGludGVsLmNvbT4KCnYyOiBTdGFydCB1c2luZyBzYW1lIGlj
bF9nZXRfYndfaW5mbyBmdW5jdGlvbiB0byBhdm9pZAogICAgY29kZSBkdXBsaWNhdGlvbi4gTW92
ZWQgbXBhZ2VzaXplIHRvIG1lbW9yeSBpbmZvCiAgICByZWxhdGVkIHN0cnVjdHVyZSBhcyBpdCBp
cyBub3cgZGVwZW5kYW50IG9uIG1lbW9yeSB0eXBlLgogICAgRml4ZWQgcWkudF9ibCBmaWVsZCBh
c3NpZ25tZW50LgoKRml4ZXM6IGh0dHBzOi8vYnVncy5mcmVlZGVza3RvcC5vcmcvc2hvd19idWcu
Y2dpP2lkPTExMTYwMAotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYncu
YyB8IDMxICsrKysrKysrKysrKysrKysrKysrLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAyNSBpbnNl
cnRpb25zKCspLCA2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfYncuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfYncuYwppbmRleCA2ODg4NThlYmU0ZDAuLmM4OWZjZGNjYWM3ZSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9idy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfYncuYwpAQCAtMTksNiArMTksNyBAQCBzdHJ1Y3QgaW50ZWxf
cWd2X2luZm8gewogCXU4IG51bV9wb2ludHM7CiAJdTggbnVtX2NoYW5uZWxzOwogCXU4IHRfYmw7
CisJdTggbXBhZ2VzaXplOwogCWVudW0gaW50ZWxfZHJhbV90eXBlIGRyYW1fdHlwZTsKIH07CiAK
QEAgLTU2LDcgKzU3LDEzIEBAIHN0YXRpYyBpbnQgaWNsX3Bjb2RlX3JlYWRfbWVtX2dsb2JhbF9p
bmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAlxaS0+bnVtX2NoYW5uZWxz
ID0gKHZhbCAmIDB4ZjApID4+IDQ7CiAJcWktPm51bV9wb2ludHMgPSAodmFsICYgMHhmMDApID4+
IDg7CiAKLQlxaS0+dF9ibCA9IHFpLT5kcmFtX3R5cGUgPT0gSU5URUxfRFJBTV9ERFI0ID8gNCA6
IDg7CisJaWYgKElTX0dFTihkZXZfcHJpdiwgMTEpKSB7CisJCXFpLT5tcGFnZXNpemUgPSAxNjsK
KwkJcWktPnRfYmwgPSBxaS0+ZHJhbV90eXBlID09IElOVEVMX0RSQU1fRERSNCA/IDQgOiA4Owor
CX0gZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCAxMikpIHsKKwkJcWktPm1wYWdlc2l6ZSA9IHFp
LT5kcmFtX3R5cGUgPT0gSU5URUxfRFJBTV9ERFI0ID8gMTYgOiAzMjsKKwkJcWktPnRfYmwgPSBx
aS0+ZHJhbV90eXBlID09IElOVEVMX0RSQU1fRERSNCA/IDQgOiAxNjsKKwl9CiAKIAlyZXR1cm4g
MDsKIH0KQEAgLTEzMiwyMCArMTM5LDI2IEBAIHN0YXRpYyBpbnQgaWNsX3NhZ3ZfbWF4X2RjbGso
Y29uc3Qgc3RydWN0IGludGVsX3Fndl9pbmZvICpxaSkKIH0KIAogc3RydWN0IGludGVsX3NhX2lu
Zm8gewotCXU4IGRlYnVyc3QsIG1wYWdlc2l6ZSwgZGVwcm9nYndsaW1pdCwgZGlzcGxheXJ0aWRz
OworCXUxNiBkaXNwbGF5cnRpZHM7CisJdTggZGVidXJzdCwgZGVwcm9nYndsaW1pdDsKIH07CiAK
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfc2FfaW5mbyBpY2xfc2FfaW5mbyA9IHsKIAkuZGVi
dXJzdCA9IDgsCi0JLm1wYWdlc2l6ZSA9IDE2LAogCS5kZXByb2did2xpbWl0ID0gMjUsIC8qIEdC
L3MgKi8KIAkuZGlzcGxheXJ0aWRzID0gMTI4LAogfTsKIAotc3RhdGljIGludCBpY2xfZ2V0X2J3
X2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQorc3RhdGljIGNvbnN0IHN0
cnVjdCBpbnRlbF9zYV9pbmZvIHRnbF9zYV9pbmZvID0geworCS5kZWJ1cnN0ID0gMTYsCisJLmRl
cHJvZ2J3bGltaXQgPSAzNCwgLyogR0IvcyAqLworCS5kaXNwbGF5cnRpZHMgPSAyNTYsCit9Owor
CisKK3N0YXRpYyBpbnQgaWNsX2dldF9id19pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwgY29uc3Qgc3RydWN0IGludGVsX3NhX2luZm8gKnNhKQogewogCXN0cnVjdCBpbnRl
bF9xZ3ZfaW5mbyBxaSA9IHt9OwotCWNvbnN0IHN0cnVjdCBpbnRlbF9zYV9pbmZvICpzYSA9ICZp
Y2xfc2FfaW5mbzsKIAlib29sIGlzX3lfdGlsZSA9IHRydWU7IC8qIGFzc3VtZSB5IHRpbGUgbWF5
IGJlIHVzZWQgKi8KIAlpbnQgbnVtX2NoYW5uZWxzOwogCWludCBkZWludGVybGVhdmU7CkBAIC0y
MzQsNyArMjQ3LDkgQEAgc3RhdGljIHVuc2lnbmVkIGludCBpY2xfbWF4X2J3KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIHZvaWQgaW50ZWxfYndfaW5pdF9odyhzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJaWYgKElTX0dFTihkZXZfcHJpdiwgMTEpKQot
CQlpY2xfZ2V0X2J3X2luZm8oZGV2X3ByaXYpOworCQlpY2xfZ2V0X2J3X2luZm8oZGV2X3ByaXYs
ICZpY2xfc2FfaW5mbyk7CisJZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCAxMikpCisJCWljbF9n
ZXRfYndfaW5mbyhkZXZfcHJpdiwgJnRnbF9zYV9pbmZvKTsKIH0KIAogc3RhdGljIHVuc2lnbmVk
IGludCBpbnRlbF9tYXhfZGF0YV9yYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKQEAgLTI0OSw2ICsyNjQsMTAgQEAgc3RhdGljIHVuc2lnbmVkIGludCBpbnRlbF9tYXhfZGF0
YV9yYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJcmV0dXJuIG1pbjMo
aWNsX21heF9idyhkZXZfcHJpdiwgbnVtX3BsYW5lcywgMCksCiAJCQkgICAgaWNsX21heF9idyhk
ZXZfcHJpdiwgbnVtX3BsYW5lcywgMSksCiAJCQkgICAgaWNsX21heF9idyhkZXZfcHJpdiwgbnVt
X3BsYW5lcywgMikpOworCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMTIpKQorCQlyZXR1cm4g
bWluMyhpY2xfbWF4X2J3KGRldl9wcml2LCBudW1fcGxhbmVzLCAwKSwKKwkJCSAgICBpY2xfbWF4
X2J3KGRldl9wcml2LCBudW1fcGxhbmVzLCAxKSwKKwkJCSAgICBpY2xfbWF4X2J3KGRldl9wcml2
LCBudW1fcGxhbmVzLCAyKSk7CiAJZWxzZQogCQlyZXR1cm4gVUlOVF9NQVg7CiB9Ci0tIAoyLjE3
LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVs
LWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

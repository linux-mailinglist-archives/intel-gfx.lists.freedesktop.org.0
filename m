Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 8466E45561
	for <lists+intel-gfx@lfdr.de>; Fri, 14 Jun 2019 09:11:09 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9D257893BC;
	Fri, 14 Jun 2019 07:10:58 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 031F589349
 for <intel-gfx@lists.freedesktop.org>; Fri, 14 Jun 2019 07:10:44 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16897508-1500050 
 for multiple; Fri, 14 Jun 2019 08:10:27 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 14 Jun 2019 08:09:49 +0100
Message-Id: <20190614071023.17929-6-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190614071023.17929-1-chris@chris-wilson.co.uk>
References: <20190614071023.17929-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 05/39] drm/i915: Keep contexts pinned until
 after the next kernel context switch
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

V2UgbmVlZCB0byBrZWVwIHRoZSBjb250ZXh0IGltYWdlIHBpbm5lZCBpbiBtZW1vcnkgdW50aWwg
YWZ0ZXIgdGhlIEdQVQpoYXMgZmluaXNoZWQgd3JpdGluZyBpbnRvIGl0LiBTaW5jZSBpdCBjb250
aW51ZXMgdG8gd3JpdGUgYXMgd2Ugc2lnbmFsCnRoZSBmaW5hbCBicmVhZGNydW1iLCB3ZSBuZWVk
IHRvIGtlZXAgaXQgcGlubmVkIHVudGlsIHRoZSByZXF1ZXN0IGFmdGVyCml0IGlzIGNvbXBsZXRl
LiBDdXJyZW50bHkgd2Uga25vdyB0aGUgb3JkZXIgaW4gd2hpY2ggcmVxdWVzdHMgZXhlY3V0ZSBv
bgplYWNoIGVuZ2luZSwgYW5kIHNvIHRvIHJlbW92ZSB0aGF0IHByZXN1bXB0aW9uIHdlIG5lZWQg
dG8gaWRlbnRpZnkgYQpyZXF1ZXN0L2NvbnRleHQtc3dpdGNoIHdlIGtub3cgbXVzdCBvY2N1ciBh
ZnRlciBvdXIgY29tcGxldGlvbi4gQW55CnJlcXVlc3QgcXVldWVkIGFmdGVyIHRoZSBzaWduYWwg
bXVzdCBpbXBseSBhIGNvbnRleHQgc3dpdGNoLCBmb3IKc2ltcGxpY2l0eSB3ZSB1c2UgYSBmcmVz
aCByZXF1ZXN0IGZyb20gdGhlIGtlcm5lbCBjb250ZXh0LgoKVGhlIHNlcXVlbmNlIG9mIG9wZXJh
dGlvbnMgZm9yIGtlZXBpbmcgdGhlIGNvbnRleHQgcGlubmVkIHVudGlsIHNhdmVkIGlzOgoKIC0g
T24gY29udGV4dCBhY3RpdmF0aW9uLCB3ZSBwcmVhbGxvY2F0ZSBhIG5vZGUgZm9yIGVhY2ggcGh5
c2ljYWwgZW5naW5lCiAgIHRoZSBjb250ZXh0IG1heSBvcGVyYXRlIG9uLiBUaGlzIGlzIHRvIGF2
b2lkIGFsbG9jYXRpb25zIGR1cmluZwogICB1bnBpbm5pbmcsIHdoaWNoIG1heSBiZSBmcm9tIGlu
c2lkZSBGU19SRUNMQUlNIGNvbnRleHQgKGFrYSB0aGUKICAgc2hyaW5rZXIpCgogLSBPbiBjb250
ZXh0IGRlYWN0aXZhdGlvbiBvbiByZXRpcmVtZW50IG9mIHRoZSBsYXN0IGFjdGl2ZSByZXF1ZXN0
ICh3aGljaAogICBpcyBiZWZvcmUgd2Uga25vdyB0aGUgY29udGV4dCBoYXMgYmVlbiBzYXZlZCks
IHdlIGFkZCB0aGUKICAgcHJlYWxsb2NhdGVkIG5vZGUgb250byBhIGJhcnJpZXIgbGlzdCBvbiBl
YWNoIGVuZ2luZQoKIC0gT24gZW5naW5lIGlkbGluZywgd2UgZW1pdCBhIHN3aXRjaCB0byBrZXJu
ZWwgY29udGV4dC4gV2hlbiB0aGlzCiAgIHN3aXRjaCBjb21wbGV0ZXMsIHdlIGtub3cgdGhhdCBh
bGwgcHJldmlvdXMgY29udGV4dHMgbXVzdCBoYXZlIGJlZW4KICAgc2F2ZWQsIGFuZCBzbyBvbiBy
ZXRpcmluZyB0aGlzIHJlcXVlc3Qgd2UgY2FuIGZpbmFsbHkgdW5waW4gYWxsIHRoZQogICBjb250
ZXh0cyB0aGF0IHdlcmUgbWFya2VkIGFzIGRlYWN0aXZhdGVkIHByaW9yIHRvIHRoZSBzd2l0Y2gu
CgpXZSBjYW4gZW5oYW5jZSB0aGlzIGluIGZ1dHVyZSBieSBmbHVzaGluZyBhbGwgdGhlIGlkbGUg
Y29udGV4dHMgb24gYQpyZWd1bGFyIGhlYXJ0YmVhdCBwdWxzZSBvZiBhIHN3aXRjaCB0byBrZXJu
ZWwgY29udGV4dCwgd2hpY2ggd2lsbCBhbHNvCmJlIHVzZWQgdG8gY2hlY2sgZm9yIGh1bmcgZW5n
aW5lcy4KCnYyOiBpbnRlbF9jb250ZXh0X2FjdGl2ZV9hY3F1aXJlL19yZWxlYXNlCgpTaWduZWQt
b2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KQ2M6IE1pa2Eg
S3VvcHBhbGEgPG1pa2Eua3VvcHBhbGFAbGludXguaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgICB8IDI0ICsrLS0tLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCAgIHwgIDEgLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgICAgICAgIHwgMjAgKysrKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYyAgICAgICB8IDgwICsrKysrKysrKysrKysrKyst
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuaCAgICAgICB8ICAzICsK
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHRfdHlwZXMuaCB8ICA2ICstCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaCAgICAgICAgfCAgMiAtCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYyAgICAgfCAyMyArLS0tLS0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jICAgICB8ICAyICsKIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oICB8IDEzICstLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgICAgICAgICAgIHwgNjIgKystLS0tLS0tLS0t
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYyAgICB8IDQ0ICst
LS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L21vY2tfZW5naW5lLmMgICAgICAgICB8
IDExICstLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYyAgICAgICAgICAgIHwg
NzggKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5o
ICAgICAgICAgICAgfCAgNSArKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmVfdHlw
ZXMuaCAgICAgIHwgIDMgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyAgICAgICAg
ICAgICAgIHwgIDQgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmMgICAgICAg
ICAgIHwgMTUgLS0tLQogLi4uL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19nZW1fZGV2aWNl
LmMgIHwgIDEgLQogMTkgZmlsZXMgY2hhbmdlZCwgMjEzIGluc2VydGlvbnMoKyksIDE4NCBkZWxl
dGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
Y29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwpp
bmRleCBjODZjYTlmMjE1MzIuLjYyMDAwNjBhZWYwNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCkBAIC02OTIsMTcgKzY5Miw2IEBAIGludCBpOTE1X2dl
bV9jb250ZXh0c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlyZXR1
cm4gMDsKIH0KIAotdm9pZCBpOTE1X2dlbV9jb250ZXh0c19sb3N0KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKLXsKLQlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmU7Ci0J
ZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7Ci0KLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZkZXZfcHJp
di0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KLQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBkZXZfcHJp
diwgaWQpCi0JCWludGVsX2VuZ2luZV9sb3N0X2NvbnRleHQoZW5naW5lKTsKLX0KLQogdm9pZCBp
OTE1X2dlbV9jb250ZXh0c19maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewog
CWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwpAQCAtMTIwMywx
MCArMTE5Miw2IEBAIGdlbjhfbW9kaWZ5X3JwY3Moc3RydWN0IGludGVsX2NvbnRleHQgKmNlLCBz
dHJ1Y3QgaW50ZWxfc3NldSBzc2V1KQogCWlmIChyZXQpCiAJCWdvdG8gb3V0X2FkZDsKIAotCXJl
dCA9IGdlbjhfZW1pdF9ycGNzX2NvbmZpZyhycSwgY2UsIHNzZXUpOwotCWlmIChyZXQpCi0JCWdv
dG8gb3V0X2FkZDsKLQogCS8qCiAJICogR3VhcmFudGVlIGNvbnRleHQgaW1hZ2UgYW5kIHRoZSB0
aW1lbGluZSByZW1haW5zIHBpbm5lZCB1bnRpbCB0aGUKIAkgKiBtb2RpZnlpbmcgcmVxdWVzdCBp
cyByZXRpcmVkIGJ5IHNldHRpbmcgdGhlIGNlIGFjdGl2aXR5IHRyYWNrZXIuCkBAIC0xMjE0LDkg
KzExOTksMTIgQEAgZ2VuOF9tb2RpZnlfcnBjcyhzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHN0
cnVjdCBpbnRlbF9zc2V1IHNzZXUpCiAJICogQnV0IHdlIG9ubHkgbmVlZCB0byB0YWtlIG9uZSBw
aW4gb24gdGhlIGFjY291bnQgb2YgaXQuIE9yIGluIG90aGVyCiAJICogd29yZHMgdHJhbnNmZXIg
dGhlIHBpbm5lZCBjZSBvYmplY3QgdG8gdHJhY2tlZCBhY3RpdmUgcmVxdWVzdC4KIAkgKi8KLQlp
ZiAoIWk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQoJmNlLT5hY3RpdmVfdHJhY2tlcikpCi0JCV9f
aW50ZWxfY29udGV4dF9waW4oY2UpOwotCV9faTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQoJmNlLT5h
Y3RpdmVfdHJhY2tlciwgcnEpOworCUdFTV9CVUdfT04oaTkxNV9hY3RpdmVfaXNfaWRsZSgmY2Ut
PmFjdGl2ZSkpOworCXJldCA9IGk5MTVfYWN0aXZlX3JlZigmY2UtPmFjdGl2ZSwgcnEtPmZlbmNl
LmNvbnRleHQsIHJxKTsKKwlpZiAocmV0KQorCQlnb3RvIG91dF9hZGQ7CisKKwlyZXQgPSBnZW44
X2VtaXRfcnBjc19jb25maWcocnEsIGNlLCBzc2V1KTsKIAogb3V0X2FkZDoKIAlpOTE1X3JlcXVl
c3RfYWRkKHJxKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9jb250ZXh0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5o
CmluZGV4IDYzMDM5MmM3N2U0OC4uOTY5MWRkMDYyZjcyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKQEAgLTEzNCw3ICsxMzQsNiBAQCBzdGF0aWMgaW5s
aW5lIGJvb2wgaTkxNV9nZW1fY29udGV4dF9pc19rZXJuZWwoc3RydWN0IGk5MTVfZ2VtX2NvbnRl
eHQgKmN0eCkKIAogLyogaTkxNV9nZW1fY29udGV4dC5jICovCiBpbnQgX19tdXN0X2NoZWNrIGk5
MTVfZ2VtX2NvbnRleHRzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsK
LXZvaWQgaTkxNV9nZW1fY29udGV4dHNfbG9zdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwogdm9pZCBpOTE1X2dlbV9jb250ZXh0c19maW5pKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7CiAKIGludCBpOTE1X2dlbV9jb250ZXh0X29wZW4oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fcG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jCmlu
ZGV4IGEzM2Y2OTYxMGQ2Zi4uMDUwMTFkNGEzYjg4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fcG0uYwpAQCAtMTAsNiArMTAsMjIgQEAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgog
I2luY2x1ZGUgImk5MTVfZ2xvYmFscy5oIgogCitzdGF0aWMgdm9pZCBjYWxsX2lkbGVfYmFycmll
cnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCXN0cnVjdCBsbGlzdF9ub2Rl
ICpub2RlLCAqbmV4dDsKKworCWxsaXN0X2Zvcl9lYWNoX3NhZmUobm9kZSwgbmV4dCwgbGxpc3Rf
ZGVsX2FsbCgmZW5naW5lLT5iYXJyaWVyX3Rhc2tzKSkgeworCQlzdHJ1Y3QgaTkxNV9hY3RpdmVf
cmVxdWVzdCAqYWN0aXZlID0KKwkJCWNvbnRhaW5lcl9vZigoc3RydWN0IGxpc3RfaGVhZCAqKW5v
ZGUsCisJCQkJICAgICB0eXBlb2YoKmFjdGl2ZSksIGxpbmspOworCisJCUlOSVRfTElTVF9IRUFE
KCZhY3RpdmUtPmxpbmspOworCQlSQ1VfSU5JVF9QT0lOVEVSKGFjdGl2ZS0+cmVxdWVzdCwgTlVM
TCk7CisKKwkJYWN0aXZlLT5yZXRpcmUoYWN0aXZlLCBOVUxMKTsKKwl9Cit9CisKIHN0YXRpYyB2
b2lkIGk5MTVfZ2VtX3Bhcmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwpAQCAtMTcsOCArMzMsMTAgQEAgc3RhdGljIHZv
aWQgaTkxNV9nZW1fcGFyayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAogCWxvY2tk
ZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCi0JZm9yX2VhY2hfZW5n
aW5lKGVuZ2luZSwgaTkxNSwgaWQpCisJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQp
IHsKKwkJY2FsbF9pZGxlX2JhcnJpZXJzKGVuZ2luZSk7IC8qIGNsZWFudXAgYWZ0ZXIgd2VkZ2lu
ZyAqLwogCQlpOTE1X2dlbV9iYXRjaF9wb29sX2ZpbmkoJmVuZ2luZS0+YmF0Y2hfcG9vbCk7CisJ
fQogCiAJaTkxNV90aW1lbGluZXNfcGFyayhpOTE1KTsKIAlpOTE1X3ZtYV9wYXJrZWQoaTkxNSk7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMKaW5kZXggYzc4ZWMwYjU4ZTc3
Li44ZTI5OWM2MzE1NzUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMK
QEAgLTYxLDcgKzYxLDYgQEAgaW50IF9faW50ZWxfY29udGV4dF9kb19waW4oc3RydWN0IGludGVs
X2NvbnRleHQgKmNlKQogCiAJCWk5MTVfZ2VtX2NvbnRleHRfZ2V0KGNlLT5nZW1fY29udGV4dCk7
IC8qIGZvciBjdHgtPnBwZ3R0ICovCiAKLQkJaW50ZWxfY29udGV4dF9nZXQoY2UpOwogCQlzbXBf
bWJfX2JlZm9yZV9hdG9taWMoKTsgLyogZmx1c2ggcGluIGJlZm9yZSBpdCBpcyB2aXNpYmxlICov
CiAJfQogCkBAIC04OSwyMCArODgsNDUgQEAgdm9pZCBpbnRlbF9jb250ZXh0X3VucGluKHN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSkKIAkJY2UtPm9wcy0+dW5waW4oY2UpOwogCiAJCWk5MTVfZ2Vt
X2NvbnRleHRfcHV0KGNlLT5nZW1fY29udGV4dCk7Ci0JCWludGVsX2NvbnRleHRfcHV0KGNlKTsK
KwkJaW50ZWxfY29udGV4dF9hY3RpdmVfcmVsZWFzZShjZSk7CiAJfQogCiAJbXV0ZXhfdW5sb2Nr
KCZjZS0+cGluX211dGV4KTsKIAlpbnRlbF9jb250ZXh0X3B1dChjZSk7CiB9CiAKLXN0YXRpYyB2
b2lkIGludGVsX2NvbnRleHRfcmV0aXJlKHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3Rp
dmUsCi0JCQkJIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQorc3RhdGljIGludCBfX2NvbnRleHRf
cGluX3N0YXRlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLCB1bnNpZ25lZCBsb25nIGZsYWdzKQogewot
CXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSA9Ci0JCWNvbnRhaW5lcl9vZihhY3RpdmUsIHR5cGVv
ZigqY2UpLCBhY3RpdmVfdHJhY2tlcik7CisJaW50IGVycjsKIAotCWludGVsX2NvbnRleHRfdW5w
aW4oY2UpOworCWVyciA9IGk5MTVfdm1hX3Bpbih2bWEsIDAsIDAsIGZsYWdzIHwgUElOX0dMT0JB
TCk7CisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworCS8qCisJICogQW5kIG1hcmsgaXQgYXMg
YSBnbG9iYWxseSBwaW5uZWQgb2JqZWN0IHRvIGxldCB0aGUgc2hyaW5rZXIga25vdworCSAqIGl0
IGNhbm5vdCByZWNsYWltIHRoZSBvYmplY3QgdW50aWwgd2UgcmVsZWFzZSBpdC4KKwkgKi8KKwl2
bWEtPm9iai0+cGluX2dsb2JhbCsrOworCXZtYS0+b2JqLT5tbS5kaXJ0eSA9IHRydWU7CisKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgX19jb250ZXh0X3VucGluX3N0YXRlKHN0cnVjdCBp
OTE1X3ZtYSAqdm1hKQoreworCXZtYS0+b2JqLT5waW5fZ2xvYmFsLS07CisJX19pOTE1X3ZtYV91
bnBpbih2bWEpOworfQorCitzdGF0aWMgdm9pZCBpbnRlbF9jb250ZXh0X3JldGlyZShzdHJ1Y3Qg
aTkxNV9hY3RpdmUgKmFjdGl2ZSkKK3sKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UgPSBjb250
YWluZXJfb2YoYWN0aXZlLCB0eXBlb2YoKmNlKSwgYWN0aXZlKTsKKworCWlmIChjZS0+c3RhdGUp
CisJCV9fY29udGV4dF91bnBpbl9zdGF0ZShjZS0+c3RhdGUpOworCisJaW50ZWxfY29udGV4dF9w
dXQoY2UpOwogfQogCiB2b2lkCkBAIC0xMjUsOCArMTQ5LDQ2IEBAIGludGVsX2NvbnRleHRfaW5p
dChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAKIAltdXRleF9pbml0KCZjZS0+cGluX211dGV4
KTsKIAotCWk5MTVfYWN0aXZlX3JlcXVlc3RfaW5pdCgmY2UtPmFjdGl2ZV90cmFja2VyLAotCQkJ
CSBOVUxMLCBpbnRlbF9jb250ZXh0X3JldGlyZSk7CisJaTkxNV9hY3RpdmVfaW5pdChjdHgtPmk5
MTUsICZjZS0+YWN0aXZlLCBpbnRlbF9jb250ZXh0X3JldGlyZSk7Cit9CisKK2ludCBpbnRlbF9j
b250ZXh0X2FjdGl2ZV9hY3F1aXJlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdW5zaWduZWQg
bG9uZyBmbGFncykKK3sKKwlpbnQgZXJyOworCisJaWYgKCFpOTE1X2FjdGl2ZV9hY3F1aXJlKCZj
ZS0+YWN0aXZlKSkKKwkJcmV0dXJuIDA7CisKKwlpbnRlbF9jb250ZXh0X2dldChjZSk7CisKKwlp
ZiAoIWNlLT5zdGF0ZSkKKwkJcmV0dXJuIDA7CisKKwllcnIgPSBfX2NvbnRleHRfcGluX3N0YXRl
KGNlLT5zdGF0ZSwgZmxhZ3MpOworCWlmIChlcnIpIHsKKwkJaTkxNV9hY3RpdmVfY2FuY2VsKCZj
ZS0+YWN0aXZlKTsKKwkJaW50ZWxfY29udGV4dF9wdXQoY2UpOworCQlyZXR1cm4gZXJyOworCX0K
KworCS8qIFByZWFsbG9jYXRlIHRyYWNraW5nIG5vZGVzICovCisJaWYgKCFpOTE1X2dlbV9jb250
ZXh0X2lzX2tlcm5lbChjZS0+Z2VtX2NvbnRleHQpKSB7CisJCWVyciA9IGk5MTVfYWN0aXZlX2Fj
cXVpcmVfcHJlYWxsb2NhdGVfYmFycmllcigmY2UtPmFjdGl2ZSwKKwkJCQkJCQkgICAgICBjZS0+
ZW5naW5lKTsKKwkJaWYgKGVycikgeworCQkJaTkxNV9hY3RpdmVfcmVsZWFzZSgmY2UtPmFjdGl2
ZSk7CisJCQlyZXR1cm4gZXJyOworCQl9CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3ZvaWQgaW50
ZWxfY29udGV4dF9hY3RpdmVfcmVsZWFzZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCit7CisJ
LyogTm9kZXMgcHJlYWxsb2NhdGVkIGluIGludGVsX2NvbnRleHRfYWN0aXZlKCkgKi8KKwlpOTE1
X2FjdGl2ZV9hY3F1aXJlX2JhcnJpZXIoJmNlLT5hY3RpdmUpOworCWk5MTVfYWN0aXZlX3JlbGVh
c2UoJmNlLT5hY3RpdmUpOwogfQogCiBzdGF0aWMgdm9pZCBpOTE1X2dsb2JhbF9jb250ZXh0X3No
cmluayh2b2lkKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29u
dGV4dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oCmluZGV4IDZk
NTQ1M2JhMmMxZS4uYTQ3Mjc1YmM0ZjAxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9jb250ZXh0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
Y29udGV4dC5oCkBAIC0xMDIsNiArMTAyLDkgQEAgc3RhdGljIGlubGluZSB2b2lkIGludGVsX2Nv
bnRleHRfZXhpdChzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCiAJCWNlLT5vcHMtPmV4aXQoY2Up
OwogfQogCitpbnQgaW50ZWxfY29udGV4dF9hY3RpdmVfYWNxdWlyZShzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqY2UsIHVuc2lnbmVkIGxvbmcgZmxhZ3MpOwordm9pZCBpbnRlbF9jb250ZXh0X2FjdGl2
ZV9yZWxlYXNlKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSk7CisKIHN0YXRpYyBpbmxpbmUgc3Ry
dWN0IGludGVsX2NvbnRleHQgKmludGVsX2NvbnRleHRfZ2V0KHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSkKIHsKIAlrcmVmX2dldCgmY2UtPnJlZik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9jb250ZXh0X3R5cGVzLmgKaW5kZXggODI1ZmNmMGFjOWM0Li5lOTViZTRiZTk2MTIg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHRfdHlwZXMu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3R5cGVzLmgKQEAg
LTU2LDEwICs1NiwxMCBAQCBzdHJ1Y3QgaW50ZWxfY29udGV4dCB7CiAJaW50ZWxfZW5naW5lX21h
c2tfdCBzYXR1cmF0ZWQ7IC8qIHN1Ym1pdHRpbmcgc2VtYXBob3JlcyB0b28gbGF0ZT8gKi8KIAog
CS8qKgotCSAqIGFjdGl2ZV90cmFja2VyOiBBY3RpdmUgdHJhY2tlciBmb3IgdGhlIGV4dGVybmFs
IHJxIGFjdGl2aXR5Ci0JICogb24gdGhpcyBpbnRlbF9jb250ZXh0IG9iamVjdC4KKwkgKiBhY3Rp
dmU6IEFjdGl2ZSB0cmFja2VyIGZvciB0aGUgcnEgYWN0aXZpdHkgKGluYy4gZXh0ZXJuYWwpIG9u
IHRoaXMKKwkgKiBpbnRlbF9jb250ZXh0IG9iamVjdC4KIAkgKi8KLQlzdHJ1Y3QgaTkxNV9hY3Rp
dmVfcmVxdWVzdCBhY3RpdmVfdHJhY2tlcjsKKwlzdHJ1Y3QgaTkxNV9hY3RpdmUgYWN0aXZlOwog
CiAJY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHRfb3BzICpvcHM7CiAKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lLmgKaW5kZXggMTQzOWZhNDA5M2FjLi4zYjVhNmQxNTI5OTcgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZS5oCkBAIC00NjcsOCArNDY3LDYgQEAg
c3RhdGljIGlubGluZSB2b2lkIGludGVsX2VuZ2luZV9yZXNldChzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsCiBib29sIGludGVsX2VuZ2luZV9pc19pZGxlKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSk7CiBib29sIGludGVsX2VuZ2luZXNfYXJlX2lkbGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIAotdm9pZCBpbnRlbF9lbmdpbmVfbG9zdF9jb250ZXh0
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Ci0KIHZvaWQgaW50ZWxfZW5naW5lc19y
ZXNldF9kZWZhdWx0X3N1Ym1pc3Npb24oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwog
dW5zaWduZWQgaW50IGludGVsX2VuZ2luZXNfaGFzX2NvbnRleHRfaXNvbGF0aW9uKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9l
bmdpbmVfY3MuYwppbmRleCBjMGQ5ODZkYjVhNzUuLjVhMDgwMzZhZTc3NCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKQEAgLTYxMSw2ICs2MTEsOCBAQCBzdGF0
aWMgaW50IGludGVsX2VuZ2luZV9zZXR1cF9jb21tb24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lKQogewogCWludCBlcnI7CiAKKwlpbml0X2xsaXN0X2hlYWQoJmVuZ2luZS0+YmFycmll
cl90YXNrcyk7CisKIAllcnIgPSBpbml0X3N0YXR1c19wYWdlKGVuZ2luZSk7CiAJaWYgKGVycikK
IAkJcmV0dXJuIGVycjsKQEAgLTg3MCw2ICs4NzIsNyBAQCB2b2lkIGludGVsX2VuZ2luZV9jbGVh
bnVwX2NvbW1vbihzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJaWYgKGVuZ2luZS0+
cHJlZW1wdF9jb250ZXh0KQogCQlpbnRlbF9jb250ZXh0X3VucGluKGVuZ2luZS0+cHJlZW1wdF9j
b250ZXh0KTsKIAlpbnRlbF9jb250ZXh0X3VucGluKGVuZ2luZS0+a2VybmVsX2NvbnRleHQpOwor
CUdFTV9CVUdfT04oIWxsaXN0X2VtcHR5KCZlbmdpbmUtPmJhcnJpZXJfdGFza3MpKTsKIAogCWk5
MTVfdGltZWxpbmVfZmluaSgmZW5naW5lLT50aW1lbGluZSk7CiAKQEAgLTEyMDEsMjYgKzEyMDQs
NiBAQCB2b2lkIGludGVsX2VuZ2luZXNfcmVzZXRfZGVmYXVsdF9zdWJtaXNzaW9uKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQogCQllbmdpbmUtPnNldF9kZWZhdWx0X3N1Ym1pc3Npb24o
ZW5naW5lKTsKIH0KIAotLyoqCi0gKiBpbnRlbF9lbmdpbmVfbG9zdF9jb250ZXh0OiBjYWxsZWQg
d2hlbiB0aGUgR1BVIGlzIHJlc2V0IGludG8gdW5rbm93biBzdGF0ZQotICogQGVuZ2luZTogdGhl
IGVuZ2luZQotICoKLSAqIFdlIGhhdmUgZWl0aGVyIHJlc2V0IHRoZSBHUFUgb3Igb3RoZXJ3aXNl
IGFib3V0IHRvIGxvc2Ugc3RhdGUgdHJhY2tpbmcgb2YKLSAqIHRoZSBjdXJyZW50IEdQVSBsb2dp
Y2FsIHN0YXRlIChlLmcuIHN1c3BlbmQpLiBPbiBuZXh0IHVzZSwgaXQgaXMgdGhlcmVmb3JlCi0g
KiBpbXBlcmF0aXZlIHRoYXQgd2UgbWFrZSBubyBwcmVzdW1wdGlvbnMgYWJvdXQgdGhlIGN1cnJl
bnQgc3RhdGUgYW5kIGxvYWQKLSAqIGZyb20gc2NyYXRjaC4KLSAqLwotdm9pZCBpbnRlbF9lbmdp
bmVfbG9zdF9jb250ZXh0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKLXsKLQlzdHJ1
Y3QgaW50ZWxfY29udGV4dCAqY2U7Ci0KLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZlbmdpbmUtPmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCi0JY2UgPSBmZXRjaF9hbmRfemVybygmZW5naW5lLT5s
YXN0X3JldGlyZWRfY29udGV4dCk7Ci0JaWYgKGNlKQotCQlpbnRlbF9jb250ZXh0X3VucGluKGNl
KTsKLX0KLQogYm9vbCBpbnRlbF9lbmdpbmVfY2FuX3N0b3JlX2R3b3JkKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlzd2l0Y2ggKElOVEVMX0dFTihlbmdpbmUtPmk5MTUpKSB7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCmluZGV4IGNjZjAzNDc2
NDc0MS4uM2M0NDhhMDYxYWJkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9lbmdpbmVfcG0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdp
bmVfcG0uYwpAQCAtODgsNiArODgsOCBAQCBzdGF0aWMgYm9vbCBzd2l0Y2hfdG9fa2VybmVsX2Nv
bnRleHQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCiAJLyogQ2hlY2sgYWdhaW4g
b24gdGhlIG5leHQgcmV0aXJlbWVudC4gKi8KIAllbmdpbmUtPndha2VyZWZfc2VyaWFsID0gZW5n
aW5lLT5zZXJpYWwgKyAxOworCisJaTkxNV9yZXF1ZXN0X2FkZF9iYXJyaWVycyhycSk7CiAJX19p
OTE1X3JlcXVlc3RfY29tbWl0KHJxKTsKIAogCXJldHVybiBmYWxzZTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKaW5kZXggMDEyMjM4NjQyMzdhLi4zM2Ez
MWFhMmQyYWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2lu
ZV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBl
cy5oCkBAIC0xMSw2ICsxMSw3IEBACiAjaW5jbHVkZSA8bGludXgvaXJxX3dvcmsuaD4KICNpbmNs
dWRlIDxsaW51eC9rcmVmLmg+CiAjaW5jbHVkZSA8bGludXgvbGlzdC5oPgorI2luY2x1ZGUgPGxp
bnV4L2xsaXN0Lmg+CiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KIAogI2luY2x1ZGUgImk5MTVf
Z2VtLmgiCkBAIC0yODgsNiArMjg5LDcgQEAgc3RydWN0IGludGVsX2VuZ2luZV9jcyB7CiAJc3Ry
dWN0IGludGVsX3JpbmcgKmJ1ZmZlcjsKIAogCXN0cnVjdCBpOTE1X3RpbWVsaW5lIHRpbWVsaW5l
OworCXN0cnVjdCBsbGlzdF9oZWFkIGJhcnJpZXJfdGFza3M7CiAKIAlzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqa2VybmVsX2NvbnRleHQ7IC8qIHBpbm5lZCAqLwogCXN0cnVjdCBpbnRlbF9jb250ZXh0
ICpwcmVlbXB0X2NvbnRleHQ7IC8qIHBpbm5lZDsgb3B0aW9uYWwgKi8KQEAgLTQzNSwxNyArNDM3
LDYgQEAgc3RydWN0IGludGVsX2VuZ2luZV9jcyB7CiAKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4
ZWNsaXN0cyBleGVjbGlzdHM7CiAKLQkvKiBDb250ZXh0cyBhcmUgcGlubmVkIHdoaWxzdCB0aGV5
IGFyZSBhY3RpdmUgb24gdGhlIEdQVS4gVGhlIGxhc3QKLQkgKiBjb250ZXh0IGV4ZWN1dGVkIHJl
bWFpbnMgYWN0aXZlIHdoaWxzdCB0aGUgR1BVIGlzIGlkbGUgLSB0aGUKLQkgKiBzd2l0Y2ggYXdh
eSBhbmQgd3JpdGUgdG8gdGhlIGNvbnRleHQgb2JqZWN0IG9ubHkgb2NjdXJzIG9uIHRoZQotCSAq
IG5leHQgZXhlY3V0aW9uLiAgQ29udGV4dHMgYXJlIG9ubHkgdW5waW5uZWQgb24gcmV0aXJlbWVu
dCBvZiB0aGUKLQkgKiBmb2xsb3dpbmcgcmVxdWVzdCBlbnN1cmluZyB0aGF0IHdlIGNhbiBhbHdh
eXMgd3JpdGUgdG8gdGhlIG9iamVjdAotCSAqIG9uIHRoZSBjb250ZXh0IHN3aXRjaCBldmVuIGFm
dGVyIGlkbGluZy4gQWNyb3NzIHN1c3BlbmQsIHdlIHN3aXRjaAotCSAqIHRvIHRoZSBrZXJuZWwg
Y29udGV4dCBhbmQgdHJhc2ggaXQgYXMgdGhlIHNhdmUgbWF5IG5vdCBoYXBwZW4KLQkgKiBiZWZv
cmUgdGhlIGhhcmR3YXJlIGlzIHBvd2VyZWQgZG93bi4KLQkgKi8KLQlzdHJ1Y3QgaW50ZWxfY29u
dGV4dCAqbGFzdF9yZXRpcmVkX2NvbnRleHQ7Ci0KIAkvKiBzdGF0dXNfbm90aWZpZXI6IGxpc3Qg
b2YgY2FsbGJhY2tzIGZvciBjb250ZXh0LXN3aXRjaCBjaGFuZ2VzICovCiAJc3RydWN0IGF0b21p
Y19ub3RpZmllcl9oZWFkIGNvbnRleHRfc3RhdHVzX25vdGlmaWVyOwogCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2xyYy5jCmluZGV4IGI4ZjU1OTJkYTE4Zi4uZDBhNTE3NTIzODZmIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtMTQyMiw2MCArMTQyMiwxMSBAQCBzdGF0aWMg
dm9pZCBleGVjbGlzdHNfY29udGV4dF9kZXN0cm95KHN0cnVjdCBrcmVmICprcmVmKQogCWludGVs
X2NvbnRleHRfZnJlZShjZSk7CiB9CiAKLXN0YXRpYyBpbnQgX19jb250ZXh0X3BpbihzdHJ1Y3Qg
aTkxNV92bWEgKnZtYSkKLXsKLQl1bnNpZ25lZCBpbnQgZmxhZ3M7Ci0JaW50IGVycjsKLQotCWZs
YWdzID0gUElOX0dMT0JBTCB8IFBJTl9ISUdIOwotCWZsYWdzIHw9IFBJTl9PRkZTRVRfQklBUyB8
IGk5MTVfZ2d0dF9waW5fYmlhcyh2bWEpOwotCi0JZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwg
MCwgZmxhZ3MpOwotCWlmIChlcnIpCi0JCXJldHVybiBlcnI7Ci0KLQl2bWEtPm9iai0+cGluX2ds
b2JhbCsrOwotCXZtYS0+b2JqLT5tbS5kaXJ0eSA9IHRydWU7Ci0KLQlyZXR1cm4gMDsKLX0KLQot
c3RhdGljIHZvaWQgX19jb250ZXh0X3VucGluKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQotewotCXZt
YS0+b2JqLT5waW5fZ2xvYmFsLS07Ci0JX19pOTE1X3ZtYV91bnBpbih2bWEpOwotfQotCiBzdGF0
aWMgdm9pZCBleGVjbGlzdHNfY29udGV4dF91bnBpbihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Up
CiB7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwotCi0JLyoKLQkgKiBUaGUgdGFz
a2xldCBtYXkgc3RpbGwgYmUgdXNpbmcgYSBwb2ludGVyIHRvIG91ciBzdGF0ZSwgdmlhIGFuCi0J
ICogb2xkIHJlcXVlc3QuIEhvd2V2ZXIsIHNpbmNlIHdlIGtub3cgd2Ugb25seSB1bnBpbiB0aGUg
Y29udGV4dAotCSAqIG9uIHJldGlyZW1lbnQgb2YgdGhlIGZvbGxvd2luZyByZXF1ZXN0LCB3ZSBr
bm93IHRoYXQgdGhlIGxhc3QKLQkgKiByZXF1ZXN0IHJlZmVyZW5jaW5nIHVzIHdpbGwgaGF2ZSBo
YWQgYSBjb21wbGV0aW9uIENTIGludGVycnVwdC4KLQkgKiBJZiB3ZSBzZWUgdGhhdCBpdCBpcyBz
dGlsbCBhY3RpdmUsIGl0IG1lYW5zIHRoYXQgdGhlIHRhc2tsZXQgaGFzbid0Ci0JICogaGFkIHRo
ZSBjaGFuY2UgdG8gcnVuIHlldDsgbGV0IGl0IHJ1biBiZWZvcmUgd2UgdGVhcmRvd24gdGhlCi0J
ICogcmVmZXJlbmNlIGl0IG1heSB1c2UuCi0JICovCi0JZW5naW5lID0gUkVBRF9PTkNFKGNlLT5p
bmZsaWdodCk7Ci0JaWYgKHVubGlrZWx5KGVuZ2luZSkpIHsKLQkJdW5zaWduZWQgbG9uZyBmbGFn
czsKLQotCQlzcGluX2xvY2tfaXJxc2F2ZSgmZW5naW5lLT50aW1lbGluZS5sb2NrLCBmbGFncyk7
Ci0JCXByb2Nlc3NfY3NiKGVuZ2luZSk7Ci0JCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVuZ2lu
ZS0+dGltZWxpbmUubG9jaywgZmxhZ3MpOwotCi0JCUdFTV9CVUdfT04oUkVBRF9PTkNFKGNlLT5p
bmZsaWdodCkpOwotCX0KLQogCWk5MTVfZ2VtX2NvbnRleHRfdW5waW5faHdfaWQoY2UtPmdlbV9j
b250ZXh0KTsKLQotCWludGVsX3JpbmdfdW5waW4oY2UtPnJpbmcpOwotCiAJaTkxNV9nZW1fb2Jq
ZWN0X3VucGluX21hcChjZS0+c3RhdGUtPm9iaik7Ci0JX19jb250ZXh0X3VucGluKGNlLT5zdGF0
ZSk7CisJaW50ZWxfcmluZ191bnBpbihjZS0+cmluZyk7CiB9CiAKIHN0YXRpYyB2b2lkCkBAIC0x
NTEyLDcgKzE0NjMsMTAgQEAgX19leGVjbGlzdHNfY29udGV4dF9waW4oc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlLAogCQlnb3RvIGVycjsKIAlHRU1fQlVHX09OKCFjZS0+c3RhdGUpOwogCi0JcmV0
ID0gX19jb250ZXh0X3BpbihjZS0+c3RhdGUpOworCXJldCA9IGludGVsX2NvbnRleHRfYWN0aXZl
X2FjcXVpcmUoY2UsCisJCQkJCSAgIGVuZ2luZS0+aTkxNS0+Z2d0dC5waW5fYmlhcyB8CisJCQkJ
CSAgIFBJTl9PRkZTRVRfQklBUyB8CisJCQkJCSAgIFBJTl9ISUdIKTsKIAlpZiAocmV0KQogCQln
b3RvIGVycjsKIApAQCAtMTUyMSw3ICsxNDc1LDcgQEAgX19leGVjbGlzdHNfY29udGV4dF9waW4o
c3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCQkJCQlJOTE1X01BUF9PVkVSUklERSk7CiAJaWYg
KElTX0VSUih2YWRkcikpIHsKIAkJcmV0ID0gUFRSX0VSUih2YWRkcik7Ci0JCWdvdG8gdW5waW5f
dm1hOworCQlnb3RvIHVucGluX2FjdGl2ZTsKIAl9CiAKIAlyZXQgPSBpbnRlbF9yaW5nX3Bpbihj
ZS0+cmluZyk7CkBAIC0xNTQyLDggKzE0OTYsOCBAQCBfX2V4ZWNsaXN0c19jb250ZXh0X3Bpbihz
dHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiAJaW50ZWxfcmluZ191bnBpbihjZS0+cmluZyk7CiB1
bnBpbl9tYXA6CiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChjZS0+c3RhdGUtPm9iaik7Ci11
bnBpbl92bWE6Ci0JX19jb250ZXh0X3VucGluKGNlLT5zdGF0ZSk7Cit1bnBpbl9hY3RpdmU6CisJ
aW50ZWxfY29udGV4dF9hY3RpdmVfcmVsZWFzZShjZSk7CiBlcnI6CiAJcmV0dXJuIHJldDsKIH0K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYwppbmRleCBiM2JmNDdl
ODE2MmYuLmNjOTAxZWRlYzA5YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfcmluZ2J1ZmZlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jp
bmdidWZmZXIuYwpAQCAtMTM0OSw0NSArMTM0OSw5IEBAIHN0YXRpYyB2b2lkIF9fY29udGV4dF91
bnBpbl9wcGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogCQlnZW42X3BwZ3R0X3Vu
cGluKGk5MTVfdm1fdG9fcHBndHQodm0pKTsKIH0KIAotc3RhdGljIGludCBfX2NvbnRleHRfcGlu
KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKLXsKLQlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKLQlp
bnQgZXJyOwotCi0Jdm1hID0gY2UtPnN0YXRlOwotCWlmICghdm1hKQotCQlyZXR1cm4gMDsKLQot
CWVyciA9IGk5MTVfdm1hX3Bpbih2bWEsIDAsIDAsIFBJTl9HTE9CQUwgfCBQSU5fSElHSCk7Ci0J
aWYgKGVycikKLQkJcmV0dXJuIGVycjsKLQotCS8qCi0JICogQW5kIG1hcmsgaXMgYXMgYSBnbG9i
YWxseSBwaW5uZWQgb2JqZWN0IHRvIGxldCB0aGUgc2hyaW5rZXIga25vdwotCSAqIGl0IGNhbm5v
dCByZWNsYWltIHRoZSBvYmplY3QgdW50aWwgd2UgcmVsZWFzZSBpdC4KLQkgKi8KLQl2bWEtPm9i
ai0+cGluX2dsb2JhbCsrOwotCXZtYS0+b2JqLT5tbS5kaXJ0eSA9IHRydWU7Ci0KLQlyZXR1cm4g
MDsKLX0KLQotc3RhdGljIHZvaWQgX19jb250ZXh0X3VucGluKHN0cnVjdCBpbnRlbF9jb250ZXh0
ICpjZSkKLXsKLQlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKLQotCXZtYSA9IGNlLT5zdGF0ZTsKLQlp
ZiAoIXZtYSkKLQkJcmV0dXJuOwotCi0Jdm1hLT5vYmotPnBpbl9nbG9iYWwtLTsKLQlpOTE1X3Zt
YV91bnBpbih2bWEpOwotfQotCiBzdGF0aWMgdm9pZCByaW5nX2NvbnRleHRfdW5waW4oc3RydWN0
IGludGVsX2NvbnRleHQgKmNlKQogewogCV9fY29udGV4dF91bnBpbl9wcGd0dChjZS0+Z2VtX2Nv
bnRleHQpOwotCV9fY29udGV4dF91bnBpbihjZSk7CiB9CiAKIHN0YXRpYyBzdHJ1Y3QgaTkxNV92
bWEgKgpAQCAtMTQ3NywxOCArMTQ0MSwxOCBAQCBzdGF0aWMgaW50IHJpbmdfY29udGV4dF9waW4o
c3RydWN0IGludGVsX2NvbnRleHQgKmNlKQogCQljZS0+c3RhdGUgPSB2bWE7CiAJfQogCi0JZXJy
ID0gX19jb250ZXh0X3BpbihjZSk7CisJZXJyID0gaW50ZWxfY29udGV4dF9hY3RpdmVfYWNxdWly
ZShjZSwgUElOX0hJR0gpOwogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKIAllcnIgPSBfX2Nv
bnRleHRfcGluX3BwZ3R0KGNlLT5nZW1fY29udGV4dCk7CiAJaWYgKGVycikKLQkJZ290byBlcnJf
dW5waW47CisJCWdvdG8gZXJyX2FjdGl2ZTsKIAogCXJldHVybiAwOwogCi1lcnJfdW5waW46Ci0J
X19jb250ZXh0X3VucGluKGNlKTsKK2Vycl9hY3RpdmU6CisJaW50ZWxfY29udGV4dF9hY3RpdmVf
cmVsZWFzZShjZSk7CiAJcmV0dXJuIGVycjsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvbW9ja19lbmdpbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L21vY2tf
ZW5naW5lLmMKaW5kZXggNmQ3NTYyNzY5ZWIyLi5kMWVmNTE1YmFjOGQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L21vY2tfZW5naW5lLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvbW9ja19lbmdpbmUuYwpAQCAtMTQ2LDEyICsxNDYsMTggQEAgc3RhdGljIHZvaWQg
bW9ja19jb250ZXh0X2Rlc3Ryb3koc3RydWN0IGtyZWYgKnJlZikKIAogc3RhdGljIGludCBtb2Nr
X2NvbnRleHRfcGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIHsKKwlpbnQgcmV0OworCiAJ
aWYgKCFjZS0+cmluZykgewogCQljZS0+cmluZyA9IG1vY2tfcmluZyhjZS0+ZW5naW5lKTsKIAkJ
aWYgKCFjZS0+cmluZykKIAkJCXJldHVybiAtRU5PTUVNOwogCX0KIAorCXJldCA9IGludGVsX2Nv
bnRleHRfYWN0aXZlX2FjcXVpcmUoY2UsIFBJTl9ISUdIKTsKKwlpZiAocmV0KQorCQlyZXR1cm4g
cmV0OworCiAJbW9ja190aW1lbGluZV9waW4oY2UtPnJpbmctPnRpbWVsaW5lKTsKIAlyZXR1cm4g
MDsKIH0KQEAgLTMyOCwxNCArMzM0LDkgQEAgdm9pZCBtb2NrX2VuZ2luZV9mcmVlKHN0cnVjdCBp
bnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIHsKIAlzdHJ1Y3QgbW9ja19lbmdpbmUgKm1vY2sgPQog
CQljb250YWluZXJfb2YoZW5naW5lLCB0eXBlb2YoKm1vY2spLCBiYXNlKTsKLQlzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2U7CiAKIAlHRU1fQlVHX09OKHRpbWVyX3BlbmRpbmcoJm1vY2stPmh3X2Rl
bGF5KSk7CiAKLQljZSA9IGZldGNoX2FuZF96ZXJvKCZlbmdpbmUtPmxhc3RfcmV0aXJlZF9jb250
ZXh0KTsKLQlpZiAoY2UpCi0JCWludGVsX2NvbnRleHRfdW5waW4oY2UpOwotCiAJaW50ZWxfY29u
dGV4dF91bnBpbihlbmdpbmUtPmtlcm5lbF9jb250ZXh0KTsKIAogCWludGVsX2VuZ2luZV9maW5p
X2JyZWFkY3J1bWJzKGVuZ2luZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2FjdGl2ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuYwppbmRleCA4
NjNhZTEyNzA3YmEuLjJkMDE5YWM2ZGIyMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9hY3RpdmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5j
CkBAIC0xNTcsNiArMTU3LDcgQEAgdm9pZCBpOTE1X2FjdGl2ZV9pbml0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1LAogCXJlZi0+cmV0aXJlID0gcmV0aXJlOwogCXJlZi0+dHJlZSA9IFJC
X1JPT1Q7CiAJaTkxNV9hY3RpdmVfcmVxdWVzdF9pbml0KCZyZWYtPmxhc3QsIE5VTEwsIGxhc3Rf
cmV0aXJlKTsKKwlpbml0X2xsaXN0X2hlYWQoJnJlZi0+YmFycmllcnMpOwogCXJlZi0+Y291bnQg
PSAwOwogfQogCkBAIC0yNjMsNiArMjY0LDgzIEBAIHZvaWQgaTkxNV9hY3RpdmVfZmluaShzdHJ1
Y3QgaTkxNV9hY3RpdmUgKnJlZikKIH0KICNlbmRpZgogCitpbnQgaTkxNV9hY3RpdmVfYWNxdWly
ZV9wcmVhbGxvY2F0ZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAorCQkJCQkgICAg
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gZW5naW5lLT5pOTE1OworCXVuc2lnbmVkIGxvbmcgdG1wOworCWludCBlcnIg
PSAwOworCisJR0VNX0JVR19PTighZW5naW5lLT5tYXNrKTsKKwlmb3JfZWFjaF9lbmdpbmVfbWFz
a2VkKGVuZ2luZSwgaTkxNSwgZW5naW5lLT5tYXNrLCB0bXApIHsKKwkJc3RydWN0IGludGVsX2Nv
bnRleHQgKmtjdHggPSBlbmdpbmUtPmtlcm5lbF9jb250ZXh0OworCQlzdHJ1Y3QgYWN0aXZlX25v
ZGUgKm5vZGU7CisKKwkJbm9kZSA9IGttZW1fY2FjaGVfYWxsb2MoZ2xvYmFsLnNsYWJfY2FjaGUs
IEdGUF9LRVJORUwpOworCQlpZiAodW5saWtlbHkoIW5vZGUpKSB7CisJCQllcnIgPSAtRU5PTUVN
OworCQkJYnJlYWs7CisJCX0KKworCQlpOTE1X2FjdGl2ZV9yZXF1ZXN0X2luaXQoJm5vZGUtPmJh
c2UsCisJCQkJCSAodm9pZCAqKWVuZ2luZSwgbm9kZV9yZXRpcmUpOworCQlub2RlLT50aW1lbGlu
ZSA9IGtjdHgtPnJpbmctPnRpbWVsaW5lLT5mZW5jZV9jb250ZXh0OworCQlub2RlLT5yZWYgPSBy
ZWY7CisJCXJlZi0+Y291bnQrKzsKKworCQlsbGlzdF9hZGQoKHN0cnVjdCBsbGlzdF9ub2RlICop
Jm5vZGUtPmJhc2UubGluaywKKwkJCSAgJnJlZi0+YmFycmllcnMpOworCX0KKworCXJldHVybiBl
cnI7Cit9CisKK3ZvaWQgaTkxNV9hY3RpdmVfYWNxdWlyZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2Fj
dGl2ZSAqcmVmKQoreworCXN0cnVjdCBsbGlzdF9ub2RlICpwb3MsICpuZXh0OworCisJaTkxNV9h
Y3RpdmVfYWNxdWlyZShyZWYpOworCisJbGxpc3RfZm9yX2VhY2hfc2FmZShwb3MsIG5leHQsIGxs
aXN0X2RlbF9hbGwoJnJlZi0+YmFycmllcnMpKSB7CisJCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZTsKKwkJc3RydWN0IGFjdGl2ZV9ub2RlICpub2RlOworCQlzdHJ1Y3QgcmJfbm9kZSAq
KnAsICpwYXJlbnQ7CisKKwkJbm9kZSA9IGNvbnRhaW5lcl9vZigoc3RydWN0IGxpc3RfaGVhZCAq
KXBvcywKKwkJCQkgICAgdHlwZW9mKCpub2RlKSwgYmFzZS5saW5rKTsKKworCQllbmdpbmUgPSAo
dm9pZCAqKXJjdV9hY2Nlc3NfcG9pbnRlcihub2RlLT5iYXNlLnJlcXVlc3QpOworCQlSQ1VfSU5J
VF9QT0lOVEVSKG5vZGUtPmJhc2UucmVxdWVzdCwgRVJSX1BUUigtRUFHQUlOKSk7CisKKwkJcGFy
ZW50ID0gTlVMTDsKKwkJcCA9ICZyZWYtPnRyZWUucmJfbm9kZTsKKwkJd2hpbGUgKCpwKSB7CisJ
CQlwYXJlbnQgPSAqcDsKKwkJCWlmIChyYl9lbnRyeShwYXJlbnQsCisJCQkJICAgICBzdHJ1Y3Qg
YWN0aXZlX25vZGUsCisJCQkJICAgICBub2RlKS0+dGltZWxpbmUgPCBub2RlLT50aW1lbGluZSkK
KwkJCQlwID0gJnBhcmVudC0+cmJfcmlnaHQ7CisJCQllbHNlCisJCQkJcCA9ICZwYXJlbnQtPnJi
X2xlZnQ7CisJCX0KKwkJcmJfbGlua19ub2RlKCZub2RlLT5ub2RlLCBwYXJlbnQsIHApOworCQly
Yl9pbnNlcnRfY29sb3IoJm5vZGUtPm5vZGUsICZyZWYtPnRyZWUpOworCisJCWxsaXN0X2FkZCgo
c3RydWN0IGxsaXN0X25vZGUgKikmbm9kZS0+YmFzZS5saW5rLAorCQkJICAmZW5naW5lLT5iYXJy
aWVyX3Rhc2tzKTsKKwl9CisJaTkxNV9hY3RpdmVfcmVsZWFzZShyZWYpOworfQorCit2b2lkIGk5
MTVfcmVxdWVzdF9hZGRfYmFycmllcnMoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCit7CisJc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lID0gcnEtPmVuZ2luZTsKKwlzdHJ1Y3QgbGxpc3Rf
bm9kZSAqbm9kZSwgKm5leHQ7CisKKwlsbGlzdF9mb3JfZWFjaF9zYWZlKG5vZGUsIG5leHQsIGxs
aXN0X2RlbF9hbGwoJmVuZ2luZS0+YmFycmllcl90YXNrcykpCisJCWxpc3RfYWRkX3RhaWwoKHN0
cnVjdCBsaXN0X2hlYWQgKilub2RlLCAmcnEtPmFjdGl2ZV9saXN0KTsKK30KKwogaW50IGk5MTVf
YWN0aXZlX3JlcXVlc3Rfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9yZXF1ZXN0ICphY3RpdmUsCiAJ
CQkgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2FjdGl2ZS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9hY3Rp
dmUuaAppbmRleCA3ZDc1ODcxOWNlMzkuLmQ1NWQzNzY3Mzk0NCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9hY3RpdmUuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2FjdGl2ZS5oCkBAIC00MDYsNCArNDA2LDkgQEAgdm9pZCBpOTE1X2FjdGl2ZV9maW5pKHN0
cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKIHN0YXRpYyBpbmxpbmUgdm9pZCBpOTE1X2FjdGl2ZV9m
aW5pKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKSB7IH0KICNlbmRpZgogCitpbnQgaTkxNV9hY3Rp
dmVfYWNxdWlyZV9wcmVhbGxvY2F0ZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmLAor
CQkJCQkgICAgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKK3ZvaWQgaTkxNV9hY3Rp
dmVfYWNxdWlyZV9iYXJyaWVyKHN0cnVjdCBpOTE1X2FjdGl2ZSAqcmVmKTsKK3ZvaWQgaTkxNV9y
ZXF1ZXN0X2FkZF9iYXJyaWVycyhzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSk7CisKICNlbmRpZiAv
KiBfSTkxNV9BQ1RJVkVfSF8gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfYWN0aXZlX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBl
cy5oCmluZGV4IGI2NzkyNTNiNTNhNS4uYzAyNTk5MWI5MjMzIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2FjdGl2ZV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfYWN0aXZlX3R5cGVzLmgKQEAgLTcsNiArNyw3IEBACiAjaWZuZGVmIF9JOTE1X0FD
VElWRV9UWVBFU19IXwogI2RlZmluZSBfSTkxNV9BQ1RJVkVfVFlQRVNfSF8KIAorI2luY2x1ZGUg
PGxpbnV4L2xsaXN0Lmg+CiAjaW5jbHVkZSA8bGludXgvcmJ0cmVlLmg+CiAjaW5jbHVkZSA8bGlu
dXgvcmN1cGRhdGUuaD4KIApAQCAtMzEsNiArMzIsOCBAQCBzdHJ1Y3QgaTkxNV9hY3RpdmUgewog
CXVuc2lnbmVkIGludCBjb3VudDsKIAogCXZvaWQgKCpyZXRpcmUpKHN0cnVjdCBpOTE1X2FjdGl2
ZSAqcmVmKTsKKworCXN0cnVjdCBsbGlzdF9oZWFkIGJhcnJpZXJzOwogfTsKIAogI2VuZGlmIC8q
IF9JOTE1X0FDVElWRV9UWVBFU19IXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKaW5kZXggNzIz
MjM2MTk3M2ZkLi4zMTRjNTMyNDkwZGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwpAQCAtMTE5
OCwxMCArMTE5OCw2IEBAIHZvaWQgaTkxNV9nZW1fc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCiAKIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmaTkxNS0+dW5jb3Jl
LCBGT1JDRVdBS0VfQUxMKTsKIAlpbnRlbF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsK
LQotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCWk5MTVfZ2VtX2NvbnRl
eHRzX2xvc3QoaTkxNSk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
IH0KIAogdm9pZCBpOTE1X2dlbV9pbml0X3N3aXp6bGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVl
c3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCmluZGV4IDUzMTEyODY1
NzhiNy4uYWY3NTdhOTU4NTUzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3JlcXVlc3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYwpAQCAt
MjEzLDE4ICsyMTMsNiBAQCBzdGF0aWMgdm9pZCBfX3JldGlyZV9lbmdpbmVfcmVxdWVzdChzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUsCiAJc3Bpbl91bmxvY2soJnJxLT5sb2NrKTsKIAog
CWxvY2FsX2lycV9lbmFibGUoKTsKLQotCS8qCi0JICogVGhlIGJhY2tpbmcgb2JqZWN0IGZvciB0
aGUgY29udGV4dCBpcyBkb25lIGFmdGVyIHN3aXRjaGluZyB0byB0aGUKLQkgKiAqbmV4dCogY29u
dGV4dC4gVGhlcmVmb3JlIHdlIGNhbm5vdCByZXRpcmUgdGhlIHByZXZpb3VzIGNvbnRleHQgdW50
aWwKLQkgKiB0aGUgbmV4dCBjb250ZXh0IGhhcyBhbHJlYWR5IHN0YXJ0ZWQgcnVubmluZy4gSG93
ZXZlciwgc2luY2Ugd2UKLQkgKiBjYW5ub3QgdGFrZSB0aGUgcmVxdWlyZWQgbG9ja3MgYXQgaTkx
NV9yZXF1ZXN0X3N1Ym1pdCgpIHdlCi0JICogZGVmZXIgdGhlIHVucGlubmluZyBvZiB0aGUgYWN0
aXZlIGNvbnRleHQgdG8gbm93LCByZXRpcmVtZW50IG9mCi0JICogdGhlIHN1YnNlcXVlbnQgcmVx
dWVzdC4KLQkgKi8KLQlpZiAoZW5naW5lLT5sYXN0X3JldGlyZWRfY29udGV4dCkKLQkJaW50ZWxf
Y29udGV4dF91bnBpbihlbmdpbmUtPmxhc3RfcmV0aXJlZF9jb250ZXh0KTsKLQllbmdpbmUtPmxh
c3RfcmV0aXJlZF9jb250ZXh0ID0gcnEtPmh3X2NvbnRleHQ7CiB9CiAKIHN0YXRpYyB2b2lkIF9f
cmV0aXJlX2VuZ2luZV91cHRvKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKQEAgLTc1
OSw5ICs3NDcsNiBAQCBfX2k5MTVfcmVxdWVzdF9jcmVhdGUoc3RydWN0IGludGVsX2NvbnRleHQg
KmNlLCBnZnBfdCBnZnApCiAKIAlycS0+aW5maXggPSBycS0+cmluZy0+ZW1pdDsgLyogZW5kIG9m
IGhlYWRlcjsgc3RhcnQgb2YgdXNlciBwYXlsb2FkICovCiAKLQkvKiBLZWVwIGEgc2Vjb25kIHBp
biBmb3IgdGhlIGR1YWwgcmV0aXJlbWVudCBhbG9uZyBlbmdpbmUgYW5kIHJpbmcgKi8KLQlfX2lu
dGVsX2NvbnRleHRfcGluKGNlKTsKLQogCWludGVsX2NvbnRleHRfbWFya19hY3RpdmUoY2UpOwog
CXJldHVybiBycTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L21vY2tfZ2VtX2RldmljZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tf
Z2VtX2RldmljZS5jCmluZGV4IGI3ZjNmYmI0YWU4OS4uYTk2ZDBjMDEyZDQ2IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19nZW1fZGV2aWNlLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ2VtX2RldmljZS5jCkBAIC01Niw3
ICs1Niw2IEBAIHN0YXRpYyB2b2lkIG1vY2tfZGV2aWNlX3JlbGVhc2Uoc3RydWN0IGRybV9kZXZp
Y2UgKmRldikKIAogCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCW1vY2tf
ZGV2aWNlX2ZsdXNoKGk5MTUpOwotCWk5MTVfZ2VtX2NvbnRleHRzX2xvc3QoaTkxNSk7CiAJbXV0
ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCWZsdXNoX3dvcmsoJmk5MTUt
PmdlbS5pZGxlX3dvcmspOwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0
cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9s
aXN0aW5mby9pbnRlbC1nZng=

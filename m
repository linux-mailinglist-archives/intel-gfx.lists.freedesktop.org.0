Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 060A2C04D7
	for <lists+intel-gfx@lfdr.de>; Fri, 27 Sep 2019 14:08:58 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 599F46EEE4;
	Fri, 27 Sep 2019 12:08:56 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B27066EEE4
 for <intel-gfx@lists.freedesktop.org>; Fri, 27 Sep 2019 12:08:54 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 27 Sep 2019 05:08:54 -0700
X-IronPort-AV: E=Sophos;i="5.64,555,1559545200"; d="scan'208";a="180480909"
Received: from kgalazka-mobl.ger.corp.intel.com (HELO [10.252.3.235])
 ([10.252.3.235])
 by orsmga007-auth.jf.intel.com with ESMTP/TLS/AES256-SHA;
 27 Sep 2019 05:08:53 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190925100137.17956-1-chris@chris-wilson.co.uk>
 <20190925100137.17956-8-chris@chris-wilson.co.uk>
 <a1305fcf-1ac4-6c06-3553-49a6684168ed@linux.intel.com>
 <156958352829.32596.13199670465422748570@skylake-alporthouse-com>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <85a5f7de-3837-3017-cb20-23258a61075f@linux.intel.com>
Date: Fri, 27 Sep 2019 13:08:51 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <156958352829.32596.13199670465422748570@skylake-alporthouse-com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 07/27] drm/i915: Coordinate i915_active with
 its own mutex
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDI3LzA5LzIwMTkgMTI6MjUsIENocmlzIFdpbHNvbiB3cm90ZToKPiBRdW90aW5nIFR2cnRr
byBVcnN1bGluICgyMDE5LTA5LTI3IDEyOjEwOjI5KQo+Pgo+PiBPbiAyNS8wOS8yMDE5IDExOjAx
LCBDaHJpcyBXaWxzb24gd3JvdGU6Cj4+PiAgICB2b2lkIGk5MTVfYWN0aXZlX3NldF9leGNsdXNp
dmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYsIHN0cnVjdCBkbWFfZmVuY2UgKmYpCj4+PiAgICB7
Cj4+PiAgICAgICAgLyogV2UgZXhwZWN0IHRoZSBjYWxsZXIgdG8gbWFuYWdlIHRoZSBleGNsdXNp
dmUgdGltZWxpbmUgb3JkZXJpbmcgKi8KPj4+ICAgICAgICBHRU1fQlVHX09OKGk5MTVfYWN0aXZl
X2lzX2lkbGUocmVmKSk7Cj4+PiAgICAKPj4+IC0gICAgIGRtYV9mZW5jZV9nZXQoZik7Cj4+PiAt
Cj4+PiAtICAgICByY3VfcmVhZF9sb2NrKCk7Cj4+PiAtICAgICBpZiAocmN1X2FjY2Vzc19wb2lu
dGVyKHJlZi0+ZXhjbCkpIHsKPj4+IC0gICAgICAgICAgICAgc3RydWN0IGRtYV9mZW5jZSAqb2xk
Owo+Pj4gLQo+Pj4gLSAgICAgICAgICAgICBvbGQgPSBkbWFfZmVuY2VfZ2V0X3JjdV9zYWZlKCZy
ZWYtPmV4Y2wpOwo+Pj4gLSAgICAgICAgICAgICBpZiAob2xkKSB7Cj4+PiAtICAgICAgICAgICAg
ICAgICAgICAgaWYgKGRtYV9mZW5jZV9yZW1vdmVfY2FsbGJhY2sob2xkLCAmcmVmLT5leGNsX2Ni
KSkKPj4+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0b21pY19kZWMoJnJlZi0+Y291
bnQpOwo+Pj4gLSAgICAgICAgICAgICAgICAgICAgIGRtYV9mZW5jZV9wdXQob2xkKTsKPj4+IC0g
ICAgICAgICAgICAgfQo+Pj4gLSAgICAgfQo+Pj4gLSAgICAgcmN1X3JlYWRfdW5sb2NrKCk7Cj4+
PiAtCj4+PiAtICAgICBhdG9taWNfaW5jKCZyZWYtPmNvdW50KTsKPj4+IC0gICAgIHJjdV9hc3Np
Z25fcG9pbnRlcihyZWYtPmV4Y2wsIGYpOwo+Pj4gKyAgICAgbXV0ZXhfYWNxdWlyZSgmcmVmLT5t
dXRleC5kZXBfbWFwLCAwLCAwLCBfVEhJU19JUF8pOwo+Pj4gKyAgICAgaWYgKCFfX2k5MTVfYWN0
aXZlX2ZlbmNlX3NldCgmcmVmLT5leGNsLCBmKSkKPj4+ICsgICAgICAgICAgICAgYXRvbWljX2lu
YygmcmVmLT5jb3VudCk7Cj4+PiArICAgICBtdXRleF9yZWxlYXNlKCZyZWYtPm11dGV4LmRlcF9t
YXAsIDAsIF9USElTX0lQXyk7Cj4+Cj4+IENvbW1lbnQgZm9yIHRoaXMgYmxvY2sgcGxlYXNlIHRv
IGV4cGxhaW4gd2hhdCdzIGdvaW5nIG9uLgo+IAo+IFRoaXMgd2FzIG1lYW50IHRvIGJlIGNsdWVk
IGluIGJ5IHRoZSBvcGVuaW5nIGNvbW1lbnQgdGhhdCB0aGUgY2FsbGVyIGlzCj4gZXhwZWN0ZWQg
dG8gbWFuYWdlIHRoZSBleGNsdXNpdmUgdGltZWxpbmUuIEJ1dCBzaW5jZSB0aGUKPiBpOTE1X2Fj
dGl2ZV9mZW5jZSBkZWJ1ZyBBUEkgcmVxdWlyZXMgdXMgdG8gZGVjbGFyZSB3aGF0IG11dGV4IGd1
YXJkcwo+IGVhY2ggdGltZWxpbmUsIHdlIGhhZCB0byBmYWtlIG9uZS4KCkkgdGhpbmsgdGhlIGNv
bW1lbnRhcnkgYWJvdXQgZHVhbGl0eSBvZiB3aGljaCBtdXRleCBndWFyZHMgdGhpbmdzIGlzIApv
bmx5IHByZXNlbnQgaW4gdGhlIGNvbW1pdCBtZXNzYWdlIGF0IHRoZSBtb21lbnQgYW5kIGl0IHdv
dWxkIGJlIHJlYWxseSAKZ29vZCB0byBoYXZlIHRoYXQgc29tZXdoZXJlIGluIHRoZSBjb2RlIGFz
IHdlbGwuIEJlY2F1c2UgYWZ0ZXIgYSBmZXcgCm1vbnRocyBvZiByZWZhY3RvcmluZywgZ29pbmcg
ZnJvbSBnaXQgYmxhbWUgdG8gY29tbWl0cyBjYW4gc3RvcCB3b3JraW5nIApzbyB3ZWxsLCBhbmQg
dGhlbiBpbiBjb2RlIGNvbW1lbnRhcnkgYmVjb21lcyB2ZXJ5IHZhbHVhYmxlLgoKPj4+ICtzdHJ1
Y3QgZG1hX2ZlbmNlICoKPj4+ICtfX2k5MTVfYWN0aXZlX2ZlbmNlX3NldChzdHJ1Y3QgaTkxNV9h
Y3RpdmVfZmVuY2UgKmFjdGl2ZSwKPj4+ICsgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZG1h
X2ZlbmNlICpmZW5jZSkKPj4KPj4gQ2FuIHlvdSBhZGQgYSBzaG9ydCBjb21tZW50IGZvciB0aGlz
IGZ1bmN0aW9uIGV4cGxhaW5pbmcgdGhlIHJhY3luZXNzCj4+IGFuZCBzbyB3aHkgaXQgcmV0dXJu
cyBwcmV2IGFuZCB3aGF0IHNob3VsZCB0aGUgY2FsbGVycyBkbyB3aXRoIGl0Pwo+IAo+IEJlZm9y
ZSB1c2luZyB0aGlzIGZ1bmN0aW9uLCB3ZSBoYWQgdGhlIGNhbGxlcnMgZGVjbGFyZSB3aGF0IG11
dGV4IGd1YXJkcwo+IHRoaXMgdGltZWxpbmUgYW5kIHdlIGNoZWNrIGhlcmUgdGhhdCBpcyBoZWxk
LgoKTm8sIEkgbWVhbiBiZWNhdXNlIGl0IGhhcyB0byByZWxvYWQgcHJldiBhbmQgcmV0dXJuIGl0
IHRvIHRoZSBjYWxsZXIsIAp3aGljaCBpbXBsaWVzIHRoYXQgaXMgdG8gaGFuZGxlIHNvbWUgZGVz
aWduZWQtaW4gcmFjeS1uZXNzIHdoaWNoIEkgdGhpbmsgCnNob3VsZCBiZSBtZW50aW9uZWQuCgo+
IAo+Pj4gK3sKPj4+ICsgICAgIHN0cnVjdCBkbWFfZmVuY2UgKnByZXY7Cj4+PiArICAgICB1bnNp
Z25lZCBsb25nIGZsYWdzOwo+Pj4gKwo+Pj4gKyAgICAgLyogTkI6IHVwZGF0ZXMgbXVzdCBiZSBz
ZXJpYWxpc2VkIGJ5IGFuIG91dGVyIHRpbWVsaW5lIG11dGV4ICovCj4+Cj4+IENhbid0IGNoZWNr
IGhlcmU/Cj4gCj4gV2UgZG8sIHNlZSBhY3RpdmVfaXNfaGVsZCgpCgpBY2shCgo+Pj4gKyAgICAg
c3Bpbl9sb2NrX2lycXNhdmUoZmVuY2UtPmxvY2ssIGZsYWdzKTsKPj4+ICsgICAgIEdFTV9CVUdf
T04odGVzdF9iaXQoRE1BX0ZFTkNFX0ZMQUdfU0lHTkFMRURfQklULCAmZmVuY2UtPmZsYWdzKSk7
Cj4+PiArCj4+PiArICAgICBwcmV2ID0gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChhY3RpdmUt
PmZlbmNlLCBhY3RpdmVfaXNfaGVsZChhY3RpdmUpKTsKPj4+ICsgICAgIGlmIChwcmV2KSB7Cj4+
PiArICAgICAgICAgICAgIHNwaW5fbG9ja19uZXN0ZWQocHJldi0+bG9jaywgU0lOR0xFX0RFUFRI
X05FU1RJTkcpOwo+Pj4gKyAgICAgICAgICAgICBfX2xpc3RfZGVsX2VudHJ5KCZhY3RpdmUtPmNi
Lm5vZGUpOwo+Pj4gKyAgICAgICAgICAgICBzcGluX3VubG9jayhwcmV2LT5sb2NrKTsgLyogc2Vy
aWFsaXNlIHdpdGggcHJldi0+Y2JfbGlzdCAqLwo+Pj4gKyAgICAgICAgICAgICBwcmV2ID0gcmN1
X2FjY2Vzc19wb2ludGVyKGFjdGl2ZS0+ZmVuY2UpOwo+Pj4gICAgICAgIH0KPj4+ICsKPj4+ICsg
ICAgIHJjdV9hc3NpZ25fcG9pbnRlcihhY3RpdmUtPmZlbmNlLCBmZW5jZSk7Cj4+PiArICAgICBs
aXN0X2FkZF90YWlsKCZhY3RpdmUtPmNiLm5vZGUsICZmZW5jZS0+Y2JfbGlzdCk7Cj4+PiArCj4+
PiArICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKGZlbmNlLT5sb2NrLCBmbGFncyk7Cj4+PiAr
Cj4+PiArICAgICByZXR1cm4gcHJldjsKPj4+ICAgIH0KPj4+ICAgIAo+Pj4gLWludCBpOTE1X2Fj
dGl2ZV9yZXF1ZXN0X3NldChzdHJ1Y3QgaTkxNV9hY3RpdmVfcmVxdWVzdCAqYWN0aXZlLAo+Pj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKPj4+ICtp
bnQgaTkxNV9hY3RpdmVfZmVuY2Vfc2V0KHN0cnVjdCBpOTE1X2FjdGl2ZV9mZW5jZSAqYWN0aXZl
LAo+Pj4gKyAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCj4+
PiAgICB7Cj4+PiArICAgICBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZTsKPj4+ICAgICAgICBpbnQg
ZXJyOwo+Pj4gICAgCj4+PiAgICAjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdf
R0VNKQo+Pgo+PiBIZXJlIG5vdCBpbiBkaWZmIHdlIGFjdHVhbGx5IGhhdmU6Cj4+Cj4+ICNpZiBJ
U19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19HRU0pCj4+ICAgICAgICAgIGxvY2tkZXBf
YXNzZXJ0X2hlbGQoYWN0aXZlLT5sb2NrKTsKPj4KPj4gU28gd2h5IG9ubHkgdW5kZXIgR0VNIGRl
YnVnIGFuZCBob3cgZG9lcyBpdCByZWxhdGVkIHRvIHRoZSBOQiBjb21tZW50IGluCj4+IF9faTkx
NV9hY3RpdmVfZmVuY2Vfc2V0Pwo+IAo+IFdlIG9ubHkgZXhwYW5kIHRoZSBzdHJ1Y3Qgd2hlbiB3
ZSB3YW50IHRvIGZvciBkZWJ1Z2dpbmcuCgpNaXNzZWQgdGhhdCBkZXRhaWwsIG9rLgoKUmVnYXJk
cywKClR2cnRrbwoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9y
ZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdm
eA==

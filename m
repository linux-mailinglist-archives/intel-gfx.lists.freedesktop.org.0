Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A48DB4EED8
	for <lists+intel-gfx@lfdr.de>; Fri, 21 Jun 2019 20:38:20 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CA52C6E916;
	Fri, 21 Jun 2019 18:38:18 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E36FE6E916
 for <intel-gfx@lists.freedesktop.org>; Fri, 21 Jun 2019 18:38:06 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16983143-1500050 
 for <intel-gfx@lists.freedesktop.org>; Fri, 21 Jun 2019 19:38:02 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 21 Jun 2019 19:37:59 +0100
Message-Id: <20190621183801.23252-3-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190621183801.23252-1-chris@chris-wilson.co.uk>
References: <20190621183801.23252-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 3/5] drm/i915: Throw away the active object
 retirement complexity
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UmVtb3ZlIHRoZSBhY2N1bXVsYXRlZCBvcHRpbWlzYXRpb25zIHRoYXQgd2UgaGF2ZSBmb3IgaTkx
NV92bWFfcmV0aXJlCmFuZCByZWR1Y2UgaXQgdG8gdGhlIGJhcmUgZXNzZW50aWFsIG9mIHRyYWNr
aW5nIHRoZSBhY3RpdmUgb2JqZWN0CnJlZmVyZW5jZS4gVGhpcyBhbGxvd3MgdXMgdG8gb25seSB1
c2UgYXRvbWljIG9wZXJhdGlvbnMsIGFuZCBzbyB3aWxsIGJlCmFibGUgdG8gYXZvaWQgdGhlIHN0
cnVjdF9tdXRleCByZXF1aXJlbWVudC4KClRoZSBwcmluY2lwYWwgbG9zcyBoZXJlIGlzIHRoZSBz
aHJpbmtlciBNUlUgYnVtcGluZywgc28gbm93IGlmIHdlIGhhdmUKdG8gc2hyaW5rLCB3ZSB3aWxs
IGRvIHNvIGluIG11Y2ggbW9yZSByYW5kb20gb3JkZXIgYW5kIG1vcmUgbGlrZWx5IHRvCnRyeSBh
bmQgc2hyaW5rIHJlY2VudGx5IHVzZWQgb2JqZWN0cy4gVGhhdCBpcyBhIG51aXNhbmNlLCBidXQg
c2hyaW5raW5nCmFjdGl2ZSBvYmplY3RzIGlzIGEgc2Vjb25kIHN0ZXAgd2UgdHJ5IHRvIGF2b2lk
IGFuZCB3aWxsIGFsd2F5cyBiZSBhCnN5c3RlbS13aWRlIHBlcmZvcm1hbmNlIGlzc3VlLgoKVGhl
IG90aGVyIGxvc3MgaXMgaGVyZSBpcyBpbiB0aGUgYXV0b21hdGljIHBydW5pbmcgb2YgdGhlCnJl
c2VydmF0aW9uX29iamVjdCB3aGVuIGlkbGluZy4gVGhpcyBpcyBub3QgYXMgbGFyZ2UgYW4gaXNz
dWUgYXMgdXBvbgpyZXNlcnZhdGlvbl9vYmplY3QgaW50cm9kdWN0aW9uIGFzIG5vdyBhZGRpbmcg
bmV3IGZlbmNlcyBpbnRvIHRoZSBvYmplY3QKcmVwbGFjZXMgYWxyZWFkeSBzaWduYWxlZCBmZW5j
ZXMsIGtlZXBpbmcgdGhlIGFycmF5IGNvbXBhY3QuIEJ1dCB3ZSBkbwpsb3NlIHRoZSBhdXRvLWV4
cGlyYXRpb24gb2Ygc3RhbGUgZmVuY2VzIGFuZCB1bnVzZWQgYXJyYXlzLiBUaGF0IG1heSBiZQph
IG5vdGljZWFibGUgcHJvYmxlbSBmb3Igd2hpY2ggd2UgbmVlZCB0byByZS1pbXBsZW1lbnQgYXV0
b3BydW5pbmcuCgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNv
bi5jby51az4KUmV2aWV3ZWQtYnk6IE1hdHRoZXcgQXVsZCA8bWF0dGhldy5hdWxkQGludGVsLmNv
bT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMgICAgfCAg
MSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmggICAgfCAgNiAt
LS0KIC4uLi9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oICB8ICAxIC0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJpbmtlci5jICB8ICA1ICstCiAu
Li4vZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMgICAgfCAgOSAtLS0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyAgICAgICAgICAgfCAgNCArLQogZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jICAgIHwgIDEgLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMgIHwgMzQgKysrKystLS0tLS0t
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYyAgICAgICAgICAgfCAgOCArLS0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2JhdGNoX3Bvb2wuYyAgICB8IDQyICsrKysr
Ky0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYyAgICAgICAgICAgICAg
IHwgNTQgKysrKy0tLS0tLS0tLS0tLS0tLQogMTEgZmlsZXMgY2hhbmdlZCwgNDcgaW5zZXJ0aW9u
cygrKSwgMTE4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV9vYmplY3QuYwppbmRleCA4NzI3NWY5ODgzYWMuLjQzMTk0ZmJjYmMyZSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYwpAQCAtMTYwLDcgKzE2MCw2IEBAIHN0
YXRpYyB2b2lkIF9faTkxNV9nZW1fZnJlZV9vYmplY3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1LAogCiAJCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCi0JCUdF
TV9CVUdfT04oaTkxNV9nZW1fb2JqZWN0X2lzX2FjdGl2ZShvYmopKTsKIAkJbGlzdF9mb3JfZWFj
aF9lbnRyeV9zYWZlKHZtYSwgdm4sICZvYmotPnZtYS5saXN0LCBvYmpfbGluaykgewogCQkJR0VN
X0JVR19PTihpOTE1X3ZtYV9pc19hY3RpdmUodm1hKSk7CiAJCQl2bWEtPmZsYWdzICY9IH5JOTE1
X1ZNQV9QSU5fTUFTSzsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9vYmplY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3Qu
aAppbmRleCBkZmViZDU3MDZmMTYuLjIwNzU0YzE1NDEyYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuaApAQCAtMTU4LDEyICsxNTgsNiBAQCBpOTE1X2dlbV9v
YmplY3RfbmVlZHNfYXN5bmNfY2FuY2VsKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmopCiAJcmV0dXJuIG9iai0+b3BzLT5mbGFncyAmIEk5MTVfR0VNX09CSkVDVF9BU1lOQ19D
QU5DRUw7CiB9CiAKLXN0YXRpYyBpbmxpbmUgYm9vbAotaTkxNV9nZW1fb2JqZWN0X2lzX2FjdGl2
ZShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQotewotCXJldHVybiBSRUFE
X09OQ0Uob2JqLT5hY3RpdmVfY291bnQpOwotfQotCiBzdGF0aWMgaW5saW5lIGJvb2wKIGk5MTVf
Z2VtX29iamVjdF9pc19mcmFtZWJ1ZmZlcihjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqKQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X29iamVjdF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVj
dF90eXBlcy5oCmluZGV4IDE4YmY0ZjhkNmQ4MC4uMzRiNTFmYWQwMmRlIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X3R5cGVzLmgKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oCkBAIC0xNTQsNyAr
MTU0LDYgQEAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgewogCiAJLyoqIENvdW50IG9mIFZN
QSBhY3R1YWxseSBib3VuZCBieSB0aGlzIG9iamVjdCAqLwogCWF0b21pY190IGJpbmRfY291bnQ7
Ci0JdW5zaWduZWQgaW50IGFjdGl2ZV9jb3VudDsKIAkvKiogQ291bnQgb2YgaG93IG1hbnkgZ2xv
YmFsIFZNQSBhcmUgY3VycmVudGx5IHBpbm5lZCBmb3IgdXNlIGJ5IEhXICovCiAJdW5zaWduZWQg
aW50IHBpbl9nbG9iYWw7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9zaHJpbmtlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3No
cmlua2VyLmMKaW5kZXggMWJiYzY5MDQ5NGM3Li5kOTlmMWE2MDBiOTYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJpbmtlci5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJpbmtlci5jCkBAIC0yMjksOCArMjI5LDkgQEAg
aTkxNV9nZW1fc2hyaW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJCWNvbnRp
bnVlOwogCiAJCQlpZiAoIShzaHJpbmsgJiBJOTE1X1NIUklOS19BQ1RJVkUpICYmCi0JCQkgICAg
KGk5MTVfZ2VtX29iamVjdF9pc19hY3RpdmUob2JqKSB8fAotCQkJICAgICBpOTE1X2dlbV9vYmpl
Y3RfaXNfZnJhbWVidWZmZXIob2JqKSkpCisJCQkgICAgKGk5MTVfZ2VtX29iamVjdF9pc19mcmFt
ZWJ1ZmZlcihvYmopIHx8CisJCQkgICAgICFyZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9zaWduYWxl
ZF9yY3Uob2JqLT5iYXNlLnJlc3YsCisJCQkJCQkJCSAgIHRydWUpKSkKIAkJCQljb250aW51ZTsK
IAogCQkJaWYgKCEoc2hyaW5rICYgSTkxNV9TSFJJTktfQk9VTkQpICYmCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4uYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jCmluZGV4IDI4MTJm
N2ZhMjdmZS4uMjRhM2M2NzdjY2Q1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4uYwpAQCAtNDc1LDE1ICs0NzUsNiBAQCBzdGF0aWMg
aW50IGlndF9tbWFwX29mZnNldF9leGhhdXN0aW9uKHZvaWQgKmFyZykKIAkJCXByX2VycigiW2xv
b3AgJWRdIEZhaWxlZCB0byBidXN5IHRoZSBvYmplY3RcbiIsIGxvb3ApOwogCQkJZ290byBlcnJf
b2JqOwogCQl9Ci0KLQkJLyogTkIgd2UgcmVseSBvbiB0aGUgX2FjdGl2ZV8gcmVmZXJlbmNlIHRv
IGFjY2VzcyBvYmogbm93ICovCi0JCUdFTV9CVUdfT04oIWk5MTVfZ2VtX29iamVjdF9pc19hY3Rp
dmUob2JqKSk7Ci0JCWVyciA9IGNyZWF0ZV9tbWFwX29mZnNldChvYmopOwotCQlpZiAoZXJyKSB7
Ci0JCQlwcl9lcnIoIltsb29wICVkXSBjcmVhdGVfbW1hcF9vZmZzZXQgZmFpbGVkIHdpdGggZXJy
PSVkXG4iLAotCQkJICAgICAgIGxvb3AsIGVycik7Ci0JCQlnb3RvIG91dDsKLQkJfQogCX0KIAog
b3V0OgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwppbmRleCBiM2UwZTI1YzVkODAuLmFk
NzYzOGRhNzg1ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJj
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKQEAgLTE0ODYsOSAr
MTQ4Niw3IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19zdWJtaXRfcmVxdWVzdChzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpyZXF1ZXN0KQogc3RhdGljIHZvaWQgX19leGVjbGlzdHNfY29udGV4dF9maW5p
KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIHsKIAlpbnRlbF9yaW5nX3B1dChjZS0+cmluZyk7
Ci0KLQlHRU1fQlVHX09OKGk5MTVfZ2VtX29iamVjdF9pc19hY3RpdmUoY2UtPnN0YXRlLT5vYmop
KTsKLQlpOTE1X2dlbV9vYmplY3RfcHV0KGNlLT5zdGF0ZS0+b2JqKTsKKwlpOTE1X3ZtYV9wdXQo
Y2UtPnN0YXRlKTsKIH0KIAogc3RhdGljIHZvaWQgZXhlY2xpc3RzX2NvbnRleHRfZGVzdHJveShz
dHJ1Y3Qga3JlZiAqa3JlZikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3JpbmdidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZm
ZXIuYwppbmRleCBkNjViOGNiYTFhOGYuLmM5MzM3ZTRiNWVlMCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYwpAQCAtMTMyNyw3ICsxMzI3LDYgQEAgdm9pZCBp
bnRlbF9yaW5nX2ZyZWUoc3RydWN0IGtyZWYgKnJlZikKIAogc3RhdGljIHZvaWQgX19yaW5nX2Nv
bnRleHRfZmluaShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCiB7Ci0JR0VNX0JVR19PTihpOTE1
X2dlbV9vYmplY3RfaXNfYWN0aXZlKGNlLT5zdGF0ZS0+b2JqKSk7CiAJaTkxNV9nZW1fb2JqZWN0
X3B1dChjZS0+c3RhdGUtPm9iaik7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RfaGFuZ2NoZWNrLmMKaW5kZXggMGRjMzg5NmU0OWY1Li4zY2ViMzk3Yzg2NDUgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCkBAIC0xMzEsMzUg
KzEzMSwyOSBAQCBoYW5nX2NyZWF0ZV9yZXF1ZXN0KHN0cnVjdCBoYW5nICpoLCBzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUg
PSBoLT5pOTE1OwogCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gaC0+Y3R4LT52bSA/
OiAmZW5naW5lLT5ndC0+Z2d0dC0+dm07CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
ajsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9IE5VTEw7CiAJc3RydWN0IGk5MTVfdm1hICpo
d3MsICp2bWE7CiAJdW5zaWduZWQgaW50IGZsYWdzOworCXZvaWQgKnZhZGRyOwogCXUzMiAqYmF0
Y2g7CiAJaW50IGVycjsKIAotCWgtPmd0ID0gZW5naW5lLT5ndDsKLQotCWlmIChpOTE1X2dlbV9v
YmplY3RfaXNfYWN0aXZlKGgtPm9iaikpIHsKLQkJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iajsKLQkJdm9pZCAqdmFkZHI7CisJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRl
cm5hbChpOTE1LCBQQUdFX1NJWkUpOworCWlmIChJU19FUlIob2JqKSkKKwkJcmV0dXJuIEVSUl9D
QVNUKG9iaik7CiAKLQkJb2JqID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1
LCBQQUdFX1NJWkUpOwotCQlpZiAoSVNfRVJSKG9iaikpCi0JCQlyZXR1cm4gRVJSX0NBU1Qob2Jq
KTsKLQotCQl2YWRkciA9IGk5MTVfZ2VtX29iamVjdF9waW5fbWFwKG9iaiwKLQkJCQkJCWk5MTVf
Y29oZXJlbnRfbWFwX3R5cGUoaTkxNSkpOwotCQlpZiAoSVNfRVJSKHZhZGRyKSkgewotCQkJaTkx
NV9nZW1fb2JqZWN0X3B1dChvYmopOwotCQkJcmV0dXJuIEVSUl9DQVNUKHZhZGRyKTsKLQkJfQor
CXZhZGRyID0gaTkxNV9nZW1fb2JqZWN0X3Bpbl9tYXAob2JqLCBpOTE1X2NvaGVyZW50X21hcF90
eXBlKGk5MTUpKTsKKwlpZiAoSVNfRVJSKHZhZGRyKSkgeworCQlpOTE1X2dlbV9vYmplY3RfcHV0
KG9iaik7CisJCXJldHVybiBFUlJfQ0FTVCh2YWRkcik7CisJfQogCi0JCWk5MTVfZ2VtX29iamVj
dF91bnBpbl9tYXAoaC0+b2JqKTsKLQkJaTkxNV9nZW1fb2JqZWN0X3B1dChoLT5vYmopOworCWk5
MTVfZ2VtX29iamVjdF91bnBpbl9tYXAoaC0+b2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfcHV0KGgt
Pm9iaik7CiAKLQkJaC0+b2JqID0gb2JqOwotCQloLT5iYXRjaCA9IHZhZGRyOwotCX0KKwloLT5v
YmogPSBvYmo7CisJaC0+YmF0Y2ggPSB2YWRkcjsKIAogCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNl
KGgtPm9iaiwgdm0sIE5VTEwpOwogCWlmIChJU19FUlIodm1hKSkKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kZWJ1Z2ZzLmMKaW5kZXggNjJjZjM0ZGI5MjgwLi5lZWVjZGFkMGUzY2EgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC03NSwxMSArNzUsNiBAQCBzdGF0aWMgaW50IGk5MTVf
Y2FwYWJpbGl0aWVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGNoYXIgZ2V0X2FjdGl2ZV9mbGFnKHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCi17Ci0JcmV0dXJuIGk5MTVfZ2VtX29iamVjdF9pc19hY3RpdmUob2JqKSA/ICcq
JyA6ICcgJzsKLX0KLQogc3RhdGljIGNoYXIgZ2V0X3Bpbl9mbGFnKHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmopCiB7CiAJcmV0dXJuIG9iai0+cGluX2dsb2JhbCA/ICdwJyA6ICcgJzsK
QEAgLTE0NCw5ICsxMzksOCBAQCBkZXNjcmliZV9vYmooc3RydWN0IHNlcV9maWxlICptLCBzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCXVuc2lnbmVkIGludCBmcm9udGJ1ZmZlcl9i
aXRzOwogCWludCBwaW5fY291bnQgPSAwOwogCi0Jc2VxX3ByaW50ZihtLCAiJXBLOiAlYyVjJWMl
YyVjICU4emRLaUIgJTAyeCAlMDJ4ICVzJXMlcyIsCisJc2VxX3ByaW50ZihtLCAiJXBLOiAlYyVj
JWMlYyAlOHpkS2lCICUwMnggJTAyeCAlcyVzJXMiLAogCQkgICAmb2JqLT5iYXNlLAotCQkgICBn
ZXRfYWN0aXZlX2ZsYWcob2JqKSwKIAkJICAgZ2V0X3Bpbl9mbGFnKG9iaiksCiAJCSAgIGdldF90
aWxpbmdfZmxhZyhvYmopLAogCQkgICBnZXRfZ2xvYmFsX2ZsYWcob2JqKSwKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2JhdGNoX3Bvb2wuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZ2VtX2JhdGNoX3Bvb2wuYwppbmRleCAyNWEzZTRkMDlhMmYuLmIxN2Yy
Mzk5MTI1MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fYmF0Y2hf
cG9vbC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2JhdGNoX3Bvb2wuYwpA
QCAtOTQsMzQgKzk0LDI2IEBAIGk5MTVfZ2VtX2JhdGNoX3Bvb2xfZ2V0KHN0cnVjdCBpOTE1X2dl
bV9iYXRjaF9wb29sICpwb29sLAogCWxpc3QgPSAmcG9vbC0+Y2FjaGVfbGlzdFtuXTsKIAogCWxp
c3RfZm9yX2VhY2hfZW50cnkob2JqLCBsaXN0LCBiYXRjaF9wb29sX2xpbmspIHsKKwkJc3RydWN0
IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiA9IG9iai0+YmFzZS5yZXN2OworCiAJCS8qIFRoZSBi
YXRjaGVzIGFyZSBzdHJpY3RseSBMUlUgb3JkZXJlZCAqLwotCQlpZiAoaTkxNV9nZW1fb2JqZWN0
X2lzX2FjdGl2ZShvYmopKSB7Ci0JCQlzdHJ1Y3QgcmVzZXJ2YXRpb25fb2JqZWN0ICpyZXN2ID0g
b2JqLT5iYXNlLnJlc3Y7Ci0KLQkJCWlmICghcmVzZXJ2YXRpb25fb2JqZWN0X3Rlc3Rfc2lnbmFs
ZWRfcmN1KHJlc3YsIHRydWUpKQotCQkJCWJyZWFrOwotCi0JCQlpOTE1X3JldGlyZV9yZXF1ZXN0
cyhwb29sLT5lbmdpbmUtPmk5MTUpOwotCQkJR0VNX0JVR19PTihpOTE1X2dlbV9vYmplY3RfaXNf
YWN0aXZlKG9iaikpOwotCi0JCQkvKgotCQkJICogVGhlIG9iamVjdCBpcyBub3cgaWRsZSwgY2xl
YXIgdGhlIGFycmF5IG9mIHNoYXJlZAotCQkJICogZmVuY2VzIGJlZm9yZSB3ZSBhZGQgYSBuZXcg
cmVxdWVzdC4gQWx0aG91Z2gsIHdlCi0JCQkgKiByZW1haW4gb24gdGhlIHNhbWUgZW5naW5lLCB3
ZSBtYXkgYmUgb24gYSBkaWZmZXJlbnQKLQkJCSAqIHRpbWVsaW5lIGFuZCBzbyBtYXkgY29udGlu
dWFsbHkgZ3JvdyB0aGUgYXJyYXksCi0JCQkgKiB0cmFwcGluZyBhIHJlZmVyZW5jZSB0byBhbGwg
dGhlIG9sZCBmZW5jZXMsIHJhdGhlcgotCQkJICogdGhhbiByZXBsYWNlIHRoZSBleGlzdGluZyBm
ZW5jZS4KLQkJCSAqLwotCQkJaWYgKHJjdV9hY2Nlc3NfcG9pbnRlcihyZXN2LT5mZW5jZSkpIHsK
LQkJCQlyZXNlcnZhdGlvbl9vYmplY3RfbG9jayhyZXN2LCBOVUxMKTsKLQkJCQlyZXNlcnZhdGlv
bl9vYmplY3RfYWRkX2V4Y2xfZmVuY2UocmVzdiwgTlVMTCk7Ci0JCQkJcmVzZXJ2YXRpb25fb2Jq
ZWN0X3VubG9jayhyZXN2KTsKLQkJCX0KKwkJaWYgKCFyZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9z
aWduYWxlZF9yY3UocmVzdiwgdHJ1ZSkpCisJCQlicmVhazsKKworCQkvKgorCQkgKiBUaGUgb2Jq
ZWN0IGlzIG5vdyBpZGxlLCBjbGVhciB0aGUgYXJyYXkgb2Ygc2hhcmVkCisJCSAqIGZlbmNlcyBi
ZWZvcmUgd2UgYWRkIGEgbmV3IHJlcXVlc3QuIEFsdGhvdWdoLCB3ZQorCQkgKiByZW1haW4gb24g
dGhlIHNhbWUgZW5naW5lLCB3ZSBtYXkgYmUgb24gYSBkaWZmZXJlbnQKKwkJICogdGltZWxpbmUg
YW5kIHNvIG1heSBjb250aW51YWxseSBncm93IHRoZSBhcnJheSwKKwkJICogdHJhcHBpbmcgYSBy
ZWZlcmVuY2UgdG8gYWxsIHRoZSBvbGQgZmVuY2VzLCByYXRoZXIKKwkJICogdGhhbiByZXBsYWNl
IHRoZSBleGlzdGluZyBmZW5jZS4KKwkJICovCisJCWlmIChyY3VfYWNjZXNzX3BvaW50ZXIocmVz
di0+ZmVuY2UpKSB7CisJCQlyZXNlcnZhdGlvbl9vYmplY3RfbG9jayhyZXN2LCBOVUxMKTsKKwkJ
CXJlc2VydmF0aW9uX29iamVjdF9hZGRfZXhjbF9mZW5jZShyZXN2LCBOVUxMKTsKKwkJCXJlc2Vy
dmF0aW9uX29iamVjdF91bmxvY2socmVzdik7CiAJCX0KIAotCQlHRU1fQlVHX09OKCFyZXNlcnZh
dGlvbl9vYmplY3RfdGVzdF9zaWduYWxlZF9yY3Uob2JqLT5iYXNlLnJlc3YsCi0JCQkJCQkJCSB0
cnVlKSk7Ci0KIAkJaWYgKG9iai0+YmFzZS5zaXplID49IHNpemUpCiAJCQlnb3RvIGZvdW5kOwog
CX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCmluZGV4IDUwM2YxMTgwYWYxMi4uYzEzYjg2ZTZlZjFm
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKQEAgLTc4LDQzICs3OCwxMSBAQCBzdGF0aWMgdm9p
ZCB2bWFfcHJpbnRfYWxsb2NhdG9yKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLCBjb25zdCBjaGFyICpy
ZWFzb24pCiAKICNlbmRpZgogCi1zdGF0aWMgdm9pZCBvYmpfYnVtcF9tcnUoc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iaikKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9
IHRvX2k5MTUob2JqLT5iYXNlLmRldik7Ci0JdW5zaWduZWQgbG9uZyBmbGFnczsKLQotCXNwaW5f
bG9ja19pcnFzYXZlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwotCWxpc3RfbW92ZV90YWls
KCZvYmotPm1tLmxpbmssICZpOTE1LT5tbS5zaHJpbmtfbGlzdCk7Ci0Jc3Bpbl91bmxvY2tfaXJx
cmVzdG9yZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKLQotCW9iai0+bW0uZGlydHkgPSB0
cnVlOyAvKiBiZSBwYXJhbm9pZCAgKi8KLX0KLQogc3RhdGljIHZvaWQgX19pOTE1X3ZtYV9yZXRp
cmUoc3RydWN0IGk5MTVfYWN0aXZlICpyZWYpCiB7CiAJc3RydWN0IGk5MTVfdm1hICp2bWEgPSBj
b250YWluZXJfb2YocmVmLCB0eXBlb2YoKnZtYSksIGFjdGl2ZSk7Ci0Jc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iaiA9IHZtYS0+b2JqOwotCi0JR0VNX0JVR19PTighaTkxNV9nZW1fb2Jq
ZWN0X2lzX2FjdGl2ZShvYmopKTsKLQlpZiAoLS1vYmotPmFjdGl2ZV9jb3VudCkKLQkJcmV0dXJu
OwotCi0JLyogUHJ1bmUgdGhlIHNoYXJlZCBmZW5jZSBhcnJheXMgaWZmIGNvbXBsZXRlbHkgaWRs
ZSAoaW5jLiBleHRlcm5hbCkgKi8KLQlpZiAocmVzZXJ2YXRpb25fb2JqZWN0X3RyeWxvY2sob2Jq
LT5iYXNlLnJlc3YpKSB7Ci0JCWlmIChyZXNlcnZhdGlvbl9vYmplY3RfdGVzdF9zaWduYWxlZF9y
Y3Uob2JqLT5iYXNlLnJlc3YsIHRydWUpKQotCQkJcmVzZXJ2YXRpb25fb2JqZWN0X2FkZF9leGNs
X2ZlbmNlKG9iai0+YmFzZS5yZXN2LCBOVUxMKTsKLQkJcmVzZXJ2YXRpb25fb2JqZWN0X3VubG9j
ayhvYmotPmJhc2UucmVzdik7Ci0JfQogCi0JLyoKLQkgKiBCdW1wIG91ciBwbGFjZSBvbiB0aGUg
Ym91bmQgbGlzdCB0byBrZWVwIGl0IHJvdWdobHkgaW4gTFJVIG9yZGVyCi0JICogc28gdGhhdCB3
ZSBkb24ndCBzdGVhbCBmcm9tIHJlY2VudGx5IHVzZWQgYnV0IGluYWN0aXZlIG9iamVjdHMKLQkg
KiAodW5sZXNzIHdlIGFyZSBmb3JjZWQgdG8gb2ZjISkKLQkgKi8KLQlpZiAoaTkxNV9nZW1fb2Jq
ZWN0X2lzX3Nocmlua2FibGUob2JqKSkKLQkJb2JqX2J1bXBfbXJ1KG9iaik7Ci0KLQlpOTE1X2dl
bV9vYmplY3RfcHV0KG9iaik7IC8qIGFuZCBkcm9wIHRoZSBhY3RpdmUgcmVmZXJlbmNlICovCisJ
aTkxNV92bWFfcHV0KHZtYSk7CiB9CiAKIHN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKgpAQCAtOTIy
LDYgKzg5MCw3IEBAIGludCBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkxNV92bWEg
KnZtYSwKIAkJCSAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAJc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaiA9IHZtYS0+b2JqOworCWludCBlcnI7CiAKIAlhc3NlcnRfdm1hX2hlbGQo
dm1hKTsKIAlhc3NlcnRfb2JqZWN0X2hlbGQob2JqKTsKQEAgLTkzNSwxNyArOTA0LDEzIEBAIGlu
dCBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKIAkgKiBhZGQg
dGhlIGFjdGl2ZSByZWZlcmVuY2UgZmlyc3QgYW5kIHF1ZXVlIGZvciBpdCB0byBiZSBkcm9wcGVk
CiAJICogKmxhc3QqLgogCSAqLwotCWlmICghdm1hLT5hY3RpdmUuY291bnQgJiYgIW9iai0+YWN0
aXZlX2NvdW50KyspCi0JCWk5MTVfZ2VtX29iamVjdF9nZXQob2JqKTsgLyogb25jZSBtb3JlIGZv
ciB0aGUgYWN0aXZlIHJlZiAqLwotCi0JaWYgKHVubGlrZWx5KGk5MTVfYWN0aXZlX3JlZigmdm1h
LT5hY3RpdmUsIHJxLT5mZW5jZS5jb250ZXh0LCBycSkpKSB7Ci0JCWlmICghdm1hLT5hY3RpdmUu
Y291bnQgJiYgIS0tb2JqLT5hY3RpdmVfY291bnQpCi0JCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9i
aik7Ci0JCXJldHVybiAtRU5PTUVNOwotCX0KKwlpZiAoaTkxNV9hY3RpdmVfYWNxdWlyZSgmdm1h
LT5hY3RpdmUpKQorCQlpOTE1X3ZtYV9nZXQodm1hKTsKIAotCUdFTV9CVUdfT04oIWk5MTVfdm1h
X2lzX2FjdGl2ZSh2bWEpKTsKLQlHRU1fQlVHX09OKCFvYmotPmFjdGl2ZV9jb3VudCk7CisJZXJy
ID0gaTkxNV9hY3RpdmVfcmVmKCZ2bWEtPmFjdGl2ZSwgcnEtPmZlbmNlLmNvbnRleHQsIHJxKTsK
KwlpOTE1X2FjdGl2ZV9yZWxlYXNlKCZ2bWEtPmFjdGl2ZSk7CisJaWYgKHVubGlrZWx5KGVycikp
CisJCXJldHVybiBlcnI7CiAKIAlvYmotPndyaXRlX2RvbWFpbiA9IDA7CiAJaWYgKGZsYWdzICYg
RVhFQ19PQkpFQ1RfV1JJVEUpIHsKQEAgLTk1NywxMSArOTIyLDE0IEBAIGludCBpOTE1X3ZtYV9t
b3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKIAkJb2JqLT5yZWFkX2RvbWFpbnMg
PSAwOwogCX0KIAlvYmotPnJlYWRfZG9tYWlucyB8PSBJOTE1X0dFTV9HUFVfRE9NQUlOUzsKKwlv
YmotPm1tLmRpcnR5ID0gdHJ1ZTsKIAogCWlmIChmbGFncyAmIEVYRUNfT0JKRUNUX05FRURTX0ZF
TkNFKQogCQlfX2k5MTVfYWN0aXZlX3JlcXVlc3Rfc2V0KCZ2bWEtPmxhc3RfZmVuY2UsIHJxKTsK
IAogCWV4cG9ydF9mZW5jZSh2bWEsIHJxLCBmbGFncyk7CisKKwlHRU1fQlVHX09OKCFpOTE1X3Zt
YV9pc19hY3RpdmUodm1hKSk7CiAJcmV0dXJuIDA7CiB9CiAKLS0gCjIuMjAuMQoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcg
bGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

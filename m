Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CDF5C19A194
	for <lists+intel-gfx@lfdr.de>; Wed,  1 Apr 2020 00:04:51 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 29AB06E364;
	Tue, 31 Mar 2020 22:04:50 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from 1.mo69.mail-out.ovh.net (1.mo69.mail-out.ovh.net
 [178.33.251.173])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 933266E364
 for <intel-gfx@lists.freedesktop.org>; Tue, 31 Mar 2020 22:04:48 +0000 (UTC)
Received: from player786.ha.ovh.net (unknown [10.110.171.238])
 by mo69.mail-out.ovh.net (Postfix) with ESMTP id 1F4EF89D34
 for <intel-gfx@lists.freedesktop.org>; Wed,  1 Apr 2020 00:04:45 +0200 (CEST)
Received: from etezian.org (213-243-141-64.bb.dnainternet.fi [213.243.141.64])
 (Authenticated sender: andi@etezian.org)
 by player786.ha.ovh.net (Postfix) with ESMTPSA id 980A411232B1D;
 Tue, 31 Mar 2020 22:04:39 +0000 (UTC)
From: Andi Shyti <andi@etezian.org>
To: Intel GFX <intel-gfx@lists.freedesktop.org>
Date: Wed,  1 Apr 2020 01:04:32 +0300
Message-Id: <20200331220432.55227-1-andi@etezian.org>
X-Mailer: git-send-email 2.25.0
MIME-Version: 1.0
X-Ovh-Tracer-Id: 13726127242968023645
X-VR-SPAMSTATE: OK
X-VR-SPAMSCORE: -100
X-VR-SPAMCAUSE: gggruggvucftvghtrhhoucdtuddrgeduhedrtddtgddufeeiucetufdoteggodetrfdotffvucfrrhhofhhilhgvmecuqfggjfdpvefjgfevmfevgfenuceurghilhhouhhtmecuhedttdenucesvcftvggtihhpihgvnhhtshculddquddttddmnecujfgurhephffvufffkffogggtgfesthekredtredtjeenucfhrhhomheptehnughiucfuhhihthhiuceorghnughisegvthgviihirghnrdhorhhgqeenucfkpheptddrtddrtddrtddpvddufedrvdegfedrudeguddrieegnecuvehluhhsthgvrhfuihiivgeptdenucfrrghrrghmpehmohguvgepshhmthhpqdhouhhtpdhhvghlohepphhlrgihvghrjeekiedrhhgrrdhovhhhrdhnvghtpdhinhgvtheptddrtddrtddrtddpmhgrihhlfhhrohhmpegrnhguihesvghtvgiiihgrnhdrohhrghdprhgtphhtthhopehinhhtvghlqdhgfhigsehlihhsthhsrdhfrhgvvgguvghskhhtohhprdhorhhg
Subject: [Intel-gfx] [PATCH v4] drm/i915/gt: move remaining debugfs
 interfaces into gt
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Chris Wilson <chris@chris-wilson.co.uk>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+CgpUaGUgZm9sbG93aW5nIGlu
dGVyZmFjZXM6CgppOTE1X3dlZGdlZAppOTE1X2ZvcmNld2FrZV91c2VyCmk5MTVfZ2VtX2ludGVy
cnVwdAppOTE1X3NzZXVfc3RhdHVzCgphcmUgZGVwZW5kZW50IG9uIGd0IHZhbHVlcy4gUHV0IHRo
ZW0gaW5zaWRlIGd0LyBhbmQgZHJvcCB0aGUKImk5MTVfIiBwcmVmaXggbmFtZS4gVGhpcyB3b3Vs
ZCBiZSB0aGUgbmV3IHN0cnVjdHVyZToKCiAgZ3QKICB8CiAgKy0tIGZvcmNld2FrZV91c2VyCiAg
fAogICstLSBpbnRlcnJ1cHRfaW5mbwogIHwKICArLS0gc3NldV9zdGF0dXMKICB8CiAgKy0tIHdl
ZGdlCgpTaWduZWQtb2ZmLWJ5OiBBbmRpIFNoeXRpIDxhbmRpLnNoeXRpQGludGVsLmNvbT4KLS0t
CkhpLAoKdGhpcyBwYXRjaCBpcyB0aGUgZmlyc3Qgb2YgYSBzZXJpZXMgdGhhdCBhaW1zIHRvIHJl
ZmFjdG9yIHRoZQpkZWJ1Z2ZzIHN0cnVjdHVyZSBpbiB0aGUgaTkxNS4gU29tZSBjaGFuZ2VzIHdp
bGwgYWZmZWN0IHRoZQpkZWJ1Z2ZzIGZyYW1ld29yayBhcyB3ZWxsLgoKSXQgaGFzIGdvbmUgdGhy
b3VnaCBhIHNlcmllcyBvZiBvZmZsaW5lIHJldmlld3MgbWFpbmx5IGZyb20KVHZydGtvLgoKVGhh
bmtzIFR2cnRrbyBmb3IgdGhlIHJldmlldywKQW5kaQoKQ2hhbmdlbG9nCj09PT09PT09PQp2NDoK
IC0gaW50ZXJydXB0IGFuZCBzc2V1IGRlYnVnZnMgaW50ZXJmYWNlIGFyZSBtb3ZlZCB0byB0aGVp
ciBvd24KICAgImRlYnVnZnNfZ3RfaXJxIiBhbmQgImRlYnVnZnNfZ3Rfc3NldSIgZmlsZXMKIC0g
cmVzZXQgZnVuY3Rpb25zIGFyZSByZW5hbWVkIHRvIHJlc2V0X3Nob3cvc3RvcmUKdjM6CiAtIGJl
dHRlciBhcnJhbmdlbWVudCBvZiB3aGF0IHNob3VsZCBzdGF5IGluIGk5MTVfZGVidWdmcyBhbmQK
ICAgd2hhdCBuZWVkcyB0byBiZSBtb3ZlZCB1bmRlciBndC8KIC0gbW9yZSB1c2Ugb2YgdGhlIGxv
Y2FsICJ1bmNvcmUiIGFuZCAiaTkxNSIgdmFyaWFibGVzIHRvIGltcHJvdmUKICAgcmVhZGFiaWxp
dHkKdjI6CiAtIGRyb3BwZWQgY2hhbmdlcyBvbiAiZHJvcF9jYWNoZXMiLCB0aGV5IHdlcmUgaW5k
ZWVkIGlycmVsZXZhbnQKIC0gaW1wcm92ZWQgaW50ZXJydXB0IGluZm8gZnVuY3Rpb24KCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZSAgICAgICAgICAgICB8ICAgMiArCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0LmMgICAgICB8ICA1MCArKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2RlYnVnZnNfZ3RfaXJxLmMgIHwgMTYyICsrKysrKysrKysKIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3RfaXJxLmggIHwgIDE1ICsKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2RlYnVnZnNfZ3RfcG0uYyAgIHwgIDMyICsrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9kZWJ1Z2ZzX2d0X3NzZXUuYyB8IDI4MiArKysrKysrKysrKysrKysrCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0X3NzZXUuaCB8ICAxNiArCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2RlYnVnZnMuYyAgICAgICB8IDM3MyArLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiA4IGZp
bGVzIGNoYW5nZWQsIDU1OSBpbnNlcnRpb25zKCspLCAzNzMgZGVsZXRpb25zKC0pCiBjcmVhdGUg
bW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndF9pcnEuYwogY3Jl
YXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3RfaXJxLmgK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0X3Nz
ZXUuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNf
Z3Rfc3NldS5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQppbmRleCAyZmNlOGIwMDQwZjMuLmQ0ZGExMTI5
NTFhOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKQEAgLTc5LDYgKzc5LDggQEAgZ3QteSArPSBcCiAJ
Z3QvZGVidWdmc19lbmdpbmVzLm8gXAogCWd0L2RlYnVnZnNfZ3QubyBcCiAJZ3QvZGVidWdmc19n
dF9wbS5vIFwKKwlndC9kZWJ1Z2ZzX2d0X2lycS5vIFwKKwlndC9kZWJ1Z2ZzX2d0X3NzZXUubyBc
CiAJZ3QvZ2VuNl9wcGd0dC5vIFwKIAlndC9nZW43X3JlbmRlcmNsZWFyLm8gXAogCWd0L2dlbjhf
cHBndHQubyBcCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0LmMKaW5kZXggMWRlNWZiYWEx
Y2Y5Li5mOTU2OTUzZTdjMmQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2Rl
YnVnZnNfZ3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0LmMKQEAg
LTgsOSArOCw1MyBAQAogCiAjaW5jbHVkZSAiZGVidWdmc19lbmdpbmVzLmgiCiAjaW5jbHVkZSAi
ZGVidWdmc19ndC5oIgorI2luY2x1ZGUgImRlYnVnZnNfZ3RfaXJxLmgiCiAjaW5jbHVkZSAiZGVi
dWdmc19ndF9wbS5oIgotI2luY2x1ZGUgInVjL2ludGVsX3VjX2RlYnVnZnMuaCIKKyNpbmNsdWRl
ICJkZWJ1Z2ZzX2d0X3NzZXUuaCIKICNpbmNsdWRlICJpOTE1X2Rydi5oIgorI2luY2x1ZGUgImlu
dGVsX2d0X3BtLmgiCisjaW5jbHVkZSAiaW50ZWxfZ3RfcmVxdWVzdHMuaCIKKyNpbmNsdWRlICJ1
Yy9pbnRlbF91Y19kZWJ1Z2ZzLmgiCisKK3N0YXRpYyBpbnQgcmVzZXRfc2hvdyh2b2lkICpkYXRh
LCB1NjQgKnZhbCkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gZGF0YTsKKwlpbnQgcmV0ID0g
aW50ZWxfZ3RfdGVybWluYWxseV93ZWRnZWQoZ3QpOworCisJc3dpdGNoIChyZXQpIHsKKwljYXNl
IC1FSU86CisJCSp2YWwgPSAxOworCQlyZXR1cm4gMDsKKwljYXNlIDA6CisJCSp2YWwgPSAwOwor
CQlyZXR1cm4gMDsKKwlkZWZhdWx0OgorCQlyZXR1cm4gcmV0OworCX0KK30KKworc3RhdGljIGlu
dCByZXNldF9zdG9yZSh2b2lkICpkYXRhLCB1NjQgdmFsKQoreworCXN0cnVjdCBpbnRlbF9ndCAq
Z3QgPSBkYXRhOworCisJLyogRmx1c2ggYW55IHByZXZpb3VzIHJlc2V0IGJlZm9yZSBhcHBseWlu
ZyBmb3IgYSBuZXcgb25lICovCisJd2FpdF9ldmVudChndC0+cmVzZXQucXVldWUsCisJCSAgICF0
ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYsICZndC0+cmVzZXQuZmxhZ3MpKTsKKworCWludGVs
X2d0X2hhbmRsZV9lcnJvcihndCwgdmFsLCBJOTE1X0VSUk9SX0NBUFRVUkUsCisJCQkgICAgICAi
TWFudWFsbHkgcmVzZXQgZW5naW5lIG1hc2sgdG8gJWxseCIsIHZhbCk7CisJcmV0dXJuIDA7Cit9
CitERUZJTkVfU0lNUExFX0FUVFJJQlVURShyZXNldF9mb3BzLCByZXNldF9zaG93LCByZXNldF9z
dG9yZSwgIiVsbHVcbiIpOworCitzdGF0aWMgdm9pZCBfX2RlYnVnZnNfZ3RfcmVnaXN0ZXIoc3Ry
dWN0IGludGVsX2d0ICpndCwgc3RydWN0IGRlbnRyeSAqcm9vdCkKK3sKKwlzdGF0aWMgY29uc3Qg
c3RydWN0IGRlYnVnZnNfZ3RfZmlsZSBmaWxlc1tdID0geworCQl7ICJyZXNldCIsICZyZXNldF9m
b3BzLCBOVUxMIH0sCisJfTsKKworCWludGVsX2d0X2RlYnVnZnNfcmVnaXN0ZXJfZmlsZXMocm9v
dCwgZmlsZXMsIEFSUkFZX1NJWkUoZmlsZXMpLCBndCk7Cit9CiAKIHZvaWQgZGVidWdmc19ndF9y
ZWdpc3RlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogewpAQCAtMjMsOCArNjcsMTIgQEAgdm9pZCBk
ZWJ1Z2ZzX2d0X3JlZ2lzdGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJaWYgKElTX0VSUihyb290
KSkKIAkJcmV0dXJuOwogCisJX19kZWJ1Z2ZzX2d0X3JlZ2lzdGVyKGd0LCByb290KTsKKwogCWRl
YnVnZnNfZW5naW5lc19yZWdpc3RlcihndCwgcm9vdCk7CiAJZGVidWdmc19ndF9wbV9yZWdpc3Rl
cihndCwgcm9vdCk7CisJZGVidWdmc19ndF9yZWdpc3Rlcl9zc2V1KGd0LCByb290KTsKKwlkZWJ1
Z2ZzX2d0X3JlZ2lzdGVyX2lycShndCwgcm9vdCk7CiAKIAlpbnRlbF91Y19kZWJ1Z2ZzX3JlZ2lz
dGVyKCZndC0+dWMsIHJvb3QpOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvZGVidWdmc19ndF9pcnEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3Rf
aXJxLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi44YWFmNzZkZmM1
NzMKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0
X2lycS5jCkBAIC0wLDAgKzEsMTYyIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlU
CisKKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAyMCBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNp
bmNsdWRlICJkZWJ1Z2ZzX2d0LmgiCisjaW5jbHVkZSAiZGVidWdmc19ndF9pcnEuaCIKKyNpbmNs
dWRlICJpOTE1X2Rydi5oIgorCitzdGF0aWMgaW50IGludGVycnVwdF9pbmZvX3Nob3coc3RydWN0
IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBtLT5w
cml2YXRlOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7CisJc3Ry
dWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKKwlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmU7CisJZW51bSBpbnRlbF9lbmdpbmVfaWQgaWQ7CisJaW50ZWxfd2FrZXJl
Zl90IHdha2VyZWY7CisJaW50IGk7CisKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQo
dW5jb3JlLT5ycG0pOworCisJaWYgKElTX0NIRVJSWVZJRVcoaTkxNSkpIHsKKwkJc2VxX3ByaW50
ZihtLCAiTWFzdGVyIEludGVycnVwdCBDb250cm9sOlx0JTA4eFxuIiwKKwkJCSAgIGludGVsX3Vu
Y29yZV9yZWFkKHVuY29yZSwgR0VOOF9NQVNURVJfSVJRKSk7CisKKwkJZm9yIChpID0gMDsgaSA8
IDQ7IGkrKykgeworCQkJc2VxX3ByaW50ZihtLCAiR1QgSW50ZXJydXB0IElNUiAlZDpcdCUwOHhc
biIsCisJCQkJICAgaSwgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkJCUdFTjhfR1Rf
SU1SKGkpKSk7CisJCQlzZXFfcHJpbnRmKG0sICJHVCBJbnRlcnJ1cHQgSUlSICVkOlx0JTA4eFxu
IiwKKwkJCQkgICBpLCBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsCisJCQkJCQkJR0VOOF9HVF9J
SVIoaSkpKTsKKwkJCXNlcV9wcmludGYobSwgIkdUIEludGVycnVwdCBJRVIgJWQ6XHQlMDh4XG4i
LAorCQkJCSAgIGksIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJCQlHRU44X0dUX0lF
UihpKSkpOworCQl9CisKKwl9IGVsc2UgaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMSkgeworCQlz
ZXFfcHJpbnRmKG0sICJNYXN0ZXIgSW50ZXJydXB0IENvbnRyb2w6ICAlMDh4XG4iLAorCQkJICAg
aW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU4xMV9HRlhfTVNUUl9JUlEpKTsKKworCQlzZXFf
cHJpbnRmKG0sICJSZW5kZXIvQ29weSBJbnRyIEVuYWJsZTogICAlMDh4XG4iLAorCQkJICAgaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkgICAgIEdFTjExX1JFTkRFUl9DT1BZX0lOVFJf
RU5BQkxFKSk7CisJCXNlcV9wcmludGYobSwgIlZDUy9WRUNTIEludHIgRW5hYmxlOiAgICAgICUw
OHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsCisJCQkJCSAgICAgR0VOMTFf
VkNTX1ZFQ1NfSU5UUl9FTkFCTEUpKTsKKwkJc2VxX3ByaW50ZihtLCAiR1VDL1NHIEludHIgRW5h
YmxlOlx0ICAgJTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJ
ICAgICBHRU4xMV9HVUNfU0dfSU5UUl9FTkFCTEUpKTsKKwkJc2VxX3ByaW50ZihtLCAiR1BNL1dH
Qk9YUEVSRiBJbnRyIEVuYWJsZTogJTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVu
Y29yZSwKKwkJCQkJICAgICBHRU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfRU5BQkxFKSk7CisJCXNl
cV9wcmludGYobSwgIkNyeXB0byBJbnRyIEVuYWJsZTpcdCAgICUwOHhcbiIsCisJCQkgICBpbnRl
bF91bmNvcmVfcmVhZCh1bmNvcmUsCisJCQkJCSAgICAgR0VOMTFfQ1JZUFRPX1JTVkRfSU5UUl9F
TkFCTEUpKTsKKwkJc2VxX3ByaW50ZihtLCAiR1VuaXQvQ1NNRSBJbnRyIEVuYWJsZTpcdCAgICUw
OHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsCisJCQkJCSAgICAgR0VOMTFf
R1VOSVRfQ1NNRV9JTlRSX0VOQUJMRSkpOworCisJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gOCkgeworCQlzZXFfcHJpbnRmKG0sICJNYXN0ZXIgSW50ZXJydXB0IENvbnRyb2w6XHQlMDh4
XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU44X01BU1RFUl9JUlEpKTsK
KworCQlmb3IgKGkgPSAwOyBpIDwgNDsgaSsrKSB7CisJCQlzZXFfcHJpbnRmKG0sICJHVCBJbnRl
cnJ1cHQgSU1SICVkOlx0JTA4eFxuIiwKKwkJCQkgICBpLCBpbnRlbF91bmNvcmVfcmVhZCh1bmNv
cmUsCisJCQkJCQkJR0VOOF9HVF9JTVIoaSkpKTsKKwkJCXNlcV9wcmludGYobSwgIkdUIEludGVy
cnVwdCBJSVIgJWQ6XHQlMDh4XG4iLAorCQkJCSAgIGksIGludGVsX3VuY29yZV9yZWFkKHVuY29y
ZSwKKwkJCQkJCQlHRU44X0dUX0lJUihpKSkpOworCQkJc2VxX3ByaW50ZihtLCAiR1QgSW50ZXJy
dXB0IElFUiAlZDpcdCUwOHhcbiIsCisJCQkJICAgaSwgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3Jl
LAorCQkJCQkJCUdFTjhfR1RfSUVSKGkpKSk7CisJCX0KKworCX0gZWxzZSBpZiAoSVNfVkFMTEVZ
VklFVyhpOTE1KSkgeworCQlzZXFfcHJpbnRmKG0sICJNYXN0ZXIgSUVSOlx0JTA4eFxuIiwKKwkJ
CSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgVkxWX01BU1RFUl9JRVIpKTsKKworCQlzZXFf
cHJpbnRmKG0sICJSZW5kZXIgSUVSOlx0JTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFk
KHVuY29yZSwgR1RJRVIpKTsKKwkJc2VxX3ByaW50ZihtLCAiUmVuZGVyIElJUjpcdCUwOHhcbiIs
CisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdUSUlSKSk7CisJCXNlcV9wcmludGYo
bSwgIlJlbmRlciBJTVI6XHQlMDh4XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3Jl
LCBHVElNUikpOworCisJCXNlcV9wcmludGYobSwgIlBNIElFUjpcdFx0JTA4eFxuIiwKKwkJCSAg
IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR0VONl9QTUlFUikpOworCQlzZXFfcHJpbnRmKG0s
ICJQTSBJSVI6XHRcdCUwOHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdF
TjZfUE1JSVIpKTsKKwkJc2VxX3ByaW50ZihtLCAiUE0gSU1SOlx0XHQlMDh4XG4iLAorCQkJICAg
aW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBHRU42X1BNSU1SKSk7CisKKwl9IGVsc2UgaWYgKCFI
QVNfUENIX1NQTElUKGk5MTUpKSB7CisJCXNlcV9wcmludGYobSwgIkludGVycnVwdCBlbmFibGU6
ICAgICUwOHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjJfSUVSKSk7
CisJCXNlcV9wcmludGYobSwgIkludGVycnVwdCBpZGVudGl0eTogICUwOHhcbiIsCisJCQkgICBp
bnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjJfSUlSKSk7CisJCXNlcV9wcmludGYobSwgIklu
dGVycnVwdCBtYXNrOiAgICAgICUwOHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNv
cmUsIEdFTjJfSU1SKSk7CisJfSBlbHNlIHsKKwkJc2VxX3ByaW50ZihtLCAiR3JhcGhpY3MgSW50
ZXJydXB0IGVuYWJsZToJCSUwOHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IEdUSUVSKSk7CisJCXNlcV9wcmludGYobSwgIkdyYXBoaWNzIEludGVycnVwdCBpZGVudGl0eToJ
CSUwOHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdUSUlSKSk7CisJCXNl
cV9wcmludGYobSwgIkdyYXBoaWNzIEludGVycnVwdCBtYXNrOgkJJTA4eFxuIiwKKwkJCSAgIGlu
dGVsX3VuY29yZV9yZWFkKHVuY29yZSwgR1RJTVIpKTsKKwl9CisKKwlpZiAoSU5URUxfR0VOKGk5
MTUpID49IDExKSB7CisJCXNlcV9wcmludGYobSwgIlJDUyBJbnRyIE1hc2s6XHQgJTA4eFxuIiwK
KwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJICAgICBHRU4xMV9SQ1MwX1JT
VkRfSU5UUl9NQVNLKSk7CisJCXNlcV9wcmludGYobSwgIkJDUyBJbnRyIE1hc2s6XHQgJTA4eFxu
IiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJICAgICBHRU4xMV9CQ1Nf
UlNWRF9JTlRSX01BU0spKTsKKwkJc2VxX3ByaW50ZihtLCAiVkNTMC9WQ1MxIEludHIgTWFzazpc
dCAlMDh4XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkgICAgIEdF
TjExX1ZDUzBfVkNTMV9JTlRSX01BU0spKTsKKwkJc2VxX3ByaW50ZihtLCAiVkNTMi9WQ1MzIElu
dHIgTWFzazpcdCAlMDh4XG4iLAorCQkJICAgaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJ
CQkgICAgIEdFTjExX1ZDUzJfVkNTM19JTlRSX01BU0spKTsKKwkJc2VxX3ByaW50ZihtLCAiVkVD
UzAvVkVDUzEgSW50ciBNYXNrOlx0ICUwOHhcbiIsCisJCQkgICBpbnRlbF91bmNvcmVfcmVhZCh1
bmNvcmUsCisJCQkJCSAgICAgR0VOMTFfVkVDUzBfVkVDUzFfSU5UUl9NQVNLKSk7CisJCXNlcV9w
cmludGYobSwgIkdVQy9TRyBJbnRyIE1hc2s6XHQgJTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29y
ZV9yZWFkKHVuY29yZSwKKwkJCQkJICAgICBHRU4xMV9HVUNfU0dfSU5UUl9NQVNLKSk7CisJCXNl
cV9wcmludGYobSwgIkdQTS9XR0JPWFBFUkYgSW50ciBNYXNrOiAlMDh4XG4iLAorCQkJICAgaW50
ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkgICAgIEdFTjExX0dQTV9XR0JPWFBFUkZfSU5U
Ul9NQVNLKSk7CisJCXNlcV9wcmludGYobSwgIkNyeXB0byBJbnRyIE1hc2s6XHQgJTA4eFxuIiwK
KwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJICAgICBHRU4xMV9DUllQVE9f
UlNWRF9JTlRSX01BU0spKTsKKwkJc2VxX3ByaW50ZihtLCAiR3VuaXQvQ1NNRSBJbnRyIE1hc2s6
XHQgJTA4eFxuIiwKKwkJCSAgIGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJICAgICBH
RU4xMV9HVU5JVF9DU01FX0lOVFJfTUFTSykpOworCisJfSBlbHNlIGlmIChJTlRFTF9HRU4oaTkx
NSkgPj0gNikgeworCQlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQpIHsKKwkJCXNlcV9w
cmludGYobSwKKwkJCQkgICAiR3JhcGhpY3MgSW50ZXJydXB0IG1hc2sgKCVzKToJJTA4eFxuIiwK
KwkJCQkgICBlbmdpbmUtPm5hbWUsIEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19JTVIpKTsKKwkJ
fQorCX0KKworCWludGVsX3J1bnRpbWVfcG1fcHV0KHVuY29yZS0+cnBtLCB3YWtlcmVmKTsKKwor
CXJldHVybiAwOworfQorREVGSU5FX0dUX0RFQlVHRlNfQVRUUklCVVRFKGludGVycnVwdF9pbmZv
KTsKKwordm9pZCBkZWJ1Z2ZzX2d0X3JlZ2lzdGVyX2lycShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBz
dHJ1Y3QgZGVudHJ5ICpyb290KQoreworCXN0YXRpYyBjb25zdCBzdHJ1Y3QgZGVidWdmc19ndF9m
aWxlIGZpbGVzW10gPSB7CisJCXsgImludGVycnVwdF9pbmZvIiwgJmludGVycnVwdF9pbmZvX2Zv
cHMsIE5VTEwgfSwKKwl9OworCisJaW50ZWxfZ3RfZGVidWdmc19yZWdpc3Rlcl9maWxlcyhyb290
LCBmaWxlcywgQVJSQVlfU0laRShmaWxlcyksIGd0KTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3RfaXJxLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9kZWJ1Z2ZzX2d0X2lycS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAw
MC4uZjNkNjAxYjNkMDE5Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvZGVidWdmc19ndF9pcnEuaApAQCAtMCwwICsxLDE1IEBACisvKiBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogTUlUICovCisKKy8qCisgKiBDb3B5cmlnaHQgwqkgMjAyMCBJbnRlbCBDb3Jwb3Jh
dGlvbgorICovCisKKyNpZm5kZWYgREVCVUdGU19HVF9JUlFfSAorI2RlZmluZSBERUJVR0ZTX0dU
X0lSUV9ICisKK3N0cnVjdCBpbnRlbF9ndDsKK3N0cnVjdCBkZW50cnk7CisKK3ZvaWQgZGVidWdm
c19ndF9yZWdpc3Rlcl9pcnEoc3RydWN0IGludGVsX2d0ICpndCwgc3RydWN0IGRlbnRyeSAqcm9v
dCk7CisKKyNlbmRpZiAvKiBERUJVR0ZTX0dUX0lSUV9IICovCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0X3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9kZWJ1Z2ZzX2d0X3BtLmMKaW5kZXggYWFiMzBkOTA4MDcyLi5jOTRhOTQ2ZTBhZGIgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3RfcG0uYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0X3BtLmMKQEAgLTEwLDYgKzEwLDcgQEAKICNp
bmNsdWRlICJkZWJ1Z2ZzX2d0X3BtLmgiCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRl
ICJpbnRlbF9ndC5oIgorI2luY2x1ZGUgImludGVsX2d0X3BtLmgiCiAjaW5jbHVkZSAiaW50ZWxf
bGxjLmgiCiAjaW5jbHVkZSAiaW50ZWxfcmM2LmgiCiAjaW5jbHVkZSAiaW50ZWxfcnBzLmgiCkBA
IC0xNyw2ICsxOCwzNiBAQAogI2luY2x1ZGUgImludGVsX3NpZGViYW5kLmgiCiAjaW5jbHVkZSAi
aW50ZWxfdW5jb3JlLmgiCiAKK3N0YXRpYyBpbnQgZm9yY2V3YWtlX3VzZXJfb3BlbihzdHJ1Y3Qg
aW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3QgKmd0
ID0gaW5vZGUtPmlfcHJpdmF0ZTsKKworCWF0b21pY19pbmMoJmd0LT51c2VyX3dha2VyZWYpOwor
CWludGVsX2d0X3BtX2dldChndCk7CisJaWYgKElOVEVMX0dFTihndC0+aTkxNSkgPj0gNikKKwkJ
aW50ZWxfdW5jb3JlX2ZvcmNld2FrZV91c2VyX2dldChndC0+dW5jb3JlKTsKKworCXJldHVybiAw
OworfQorCitzdGF0aWMgaW50IGZvcmNld2FrZV91c2VyX3JlbGVhc2Uoc3RydWN0IGlub2RlICpp
bm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IGlub2Rl
LT5pX3ByaXZhdGU7CisKKwlpZiAoSU5URUxfR0VOKGd0LT5pOTE1KSA+PSA2KQorCQlpbnRlbF91
bmNvcmVfZm9yY2V3YWtlX3VzZXJfcHV0KGd0LT51bmNvcmUpOworCWludGVsX2d0X3BtX3B1dChn
dCk7CisJYXRvbWljX2RlYygmZ3QtPnVzZXJfd2FrZXJlZik7CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgZm9yY2V3YWtlX3VzZXJfZm9wcyA9
IHsKKwkub3duZXIgPSBUSElTX01PRFVMRSwKKwkub3BlbiA9IGZvcmNld2FrZV91c2VyX29wZW4s
CisJLnJlbGVhc2UgPSBmb3JjZXdha2VfdXNlcl9yZWxlYXNlLAorfTsKKwogc3RhdGljIGludCBm
d19kb21haW5zX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogewogCXN0cnVj
dCBpbnRlbF9ndCAqZ3QgPSBtLT5wcml2YXRlOwpAQCAtNTk3LDYgKzYyOCw3IEBAIHZvaWQgZGVi
dWdmc19ndF9wbV9yZWdpc3RlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBzdHJ1Y3QgZGVudHJ5ICpy
b290KQogCQl7ICJkcnBjIiwgJmRycGNfZm9wcywgTlVMTCB9LAogCQl7ICJmcmVxdWVuY3kiLCAm
ZnJlcXVlbmN5X2ZvcHMsIE5VTEwgfSwKIAkJeyAiZm9yY2V3YWtlIiwgJmZ3X2RvbWFpbnNfZm9w
cywgTlVMTCB9LAorCQl7ICJmb3JjZXdha2VfdXNlciIsICZmb3JjZXdha2VfdXNlcl9mb3BzLCBO
VUxMfSwKIAkJeyAibGxjIiwgJmxsY19mb3BzLCBsbGNfZXZhbCB9LAogCQl7ICJycHNfYm9vc3Qi
LCAmcnBzX2Jvb3N0X2ZvcHMsIHJwc19ldmFsIH0sCiAJfTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3Rfc3NldS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvZGVidWdmc19ndF9zc2V1LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAw
MDAwLi45NTFlYmQ3YjFkNzkKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9kZWJ1Z2ZzX2d0X3NzZXUuYwpAQCAtMCwwICsxLDI4MiBAQAorLy8gU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IE1JVAorCisvKgorICogQ29weXJpZ2h0IMKpIDIwMjAgSW50ZWwgQ29ycG9y
YXRpb24KKyAqLworCisjaW5jbHVkZSAiZGVidWdmc19ndC5oIgorI2luY2x1ZGUgImRlYnVnZnNf
Z3Rfc3NldS5oIgorI2luY2x1ZGUgImk5MTVfZHJ2LmgiCisKK3N0YXRpYyB2b2lkIGludGVsX3Nz
ZXVfY29weV9zdWJzbGljZXMoY29uc3Qgc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUsCisJCQkJ
ICAgICAgaW50IHNsaWNlLCB1OCAqdG9fbWFzaykKK3sKKwlpbnQgb2Zmc2V0ID0gc2xpY2UgKiBz
c2V1LT5zc19zdHJpZGU7CisKKwltZW1jcHkoJnRvX21hc2tbb2Zmc2V0XSwgJnNzZXUtPnN1YnNs
aWNlX21hc2tbb2Zmc2V0XSwgc3NldS0+c3Nfc3RyaWRlKTsKK30KKworc3RhdGljIHZvaWQgY2hl
cnJ5dmlld19zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0IGludGVsX2d0ICpndCwKKwkJCQkJICBz
dHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSkKK3sKKyNkZWZpbmUgU1NfTUFYIDIKKwlzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3JlOworCWNvbnN0IGludCBzc19tYXggPSBT
U19NQVg7CisJdTMyIHNpZzFbU1NfTUFYXSwgc2lnMltTU19NQVhdOworCWludCBzczsKKworCXNp
ZzFbMF0gPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIENIVl9QT1dFUl9TUzBfU0lHMSk7CisJ
c2lnMVsxXSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgQ0hWX1BPV0VSX1NTMV9TSUcxKTsK
KwlzaWcyWzBdID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLCBDSFZfUE9XRVJfU1MwX1NJRzIp
OworCXNpZzJbMV0gPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIENIVl9QT1dFUl9TUzFfU0lH
Mik7CisKKwlmb3IgKHNzID0gMDsgc3MgPCBzc19tYXg7IHNzKyspIHsKKwkJdW5zaWduZWQgaW50
IGV1X2NudDsKKworCQlpZiAoc2lnMVtzc10gJiBDSFZfU1NfUEdfRU5BQkxFKQorCQkJLyogc2tp
cCBkaXNhYmxlZCBzdWJzbGljZSAqLworCQkJY29udGludWU7CisKKwkJc3NldS0+c2xpY2VfbWFz
ayA9IEJJVCgwKTsKKwkJc3NldS0+c3Vic2xpY2VfbWFza1swXSB8PSBCSVQoc3MpOworCQlldV9j
bnQgPSAoKHNpZzFbc3NdICYgQ0hWX0VVMDhfUEdfRU5BQkxFKSA/IDAgOiAyKSArCisJCQkgKChz
aWcxW3NzXSAmIENIVl9FVTE5X1BHX0VOQUJMRSkgPyAwIDogMikgKworCQkJICgoc2lnMVtzc10g
JiBDSFZfRVUyMTBfUEdfRU5BQkxFKSA/IDAgOiAyKSArCisJCQkgKChzaWcyW3NzXSAmIENIVl9F
VTMxMV9QR19FTkFCTEUpID8gMCA6IDIpOworCQlzc2V1LT5ldV90b3RhbCArPSBldV9jbnQ7CisJ
CXNzZXUtPmV1X3Blcl9zdWJzbGljZSA9IG1heF90KHVuc2lnbmVkIGludCwKKwkJCQkJICAgICAg
c3NldS0+ZXVfcGVyX3N1YnNsaWNlLCBldV9jbnQpOworCX0KKyN1bmRlZiBTU19NQVgKK30KKwor
c3RhdGljIHZvaWQgZ2VuMTBfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBpbnRlbF9ndCAqZ3Qs
CisJCQkJICAgICBzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSkKK3sKKyNkZWZpbmUgU1NfTUFY
IDYKKwljb25zdCBzdHJ1Y3QgaW50ZWxfcnVudGltZV9pbmZvICppbmZvID0gUlVOVElNRV9JTkZP
KGd0LT5pOTE1KTsKKwl1MzIgc19yZWdbU1NfTUFYXSwgZXVfcmVnWzIgKiBTU19NQVhdLCBldV9t
YXNrWzJdOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9IGd0LT51bmNvcmU7CisJaW50
IHMsIHNzOworCisJZm9yIChzID0gMDsgcyA8IGluZm8tPnNzZXUubWF4X3NsaWNlczsgcysrKSB7
CisJCS8qCisJCSAqIEZJWE1FOiBWYWxpZCBTUyBNYXNrIHJlc3BlY3RzIHRoZSBzcGVjIGFuZCBy
ZWFkCisJCSAqIG9ubHkgdmFsaWQgYml0cyBmb3IgdGhvc2UgcmVnaXN0ZXJzLCBleGNsdWRpbmcg
cmVzZXJ2ZWQKKwkJICogYWx0aG91Z2ggdGhpcyBzZWVtcyB3cm9uZyBiZWNhdXNlIGl0IHdvdWxk
IGxlYXZlIG1hbnkKKwkJICogc3Vic2xpY2VzIHdpdGhvdXQgQUNLLgorCQkgKi8KKwkJc19yZWdb
c10gPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdFTjEwX1NMSUNFX1BHQ1RMX0FDSyhzKSkg
JgorCQkJICAgR0VOMTBfUEdDVExfVkFMSURfU1NfTUFTSyhzKTsKKwkJZXVfcmVnWzIgKiBzXSA9
IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwKKwkJCQkJCSAgR0VOMTBfU1MwMV9FVV9QR0NUTF9B
Q0socykpOworCQlldV9yZWdbMiAqIHMgKyAxXSA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwK
KwkJCQkJCSAgR0VOMTBfU1MyM19FVV9QR0NUTF9BQ0socykpOworCX0KKworCWV1X21hc2tbMF0g
PSBHRU45X1BHQ1RMX1NTQV9FVTA4X0FDSyB8CisJCSAgICAgR0VOOV9QR0NUTF9TU0FfRVUxOV9B
Q0sgfAorCQkgICAgIEdFTjlfUEdDVExfU1NBX0VVMjEwX0FDSyB8CisJCSAgICAgR0VOOV9QR0NU
TF9TU0FfRVUzMTFfQUNLOworCWV1X21hc2tbMV0gPSBHRU45X1BHQ1RMX1NTQl9FVTA4X0FDSyB8
CisJCSAgICAgR0VOOV9QR0NUTF9TU0JfRVUxOV9BQ0sgfAorCQkgICAgIEdFTjlfUEdDVExfU1NC
X0VVMjEwX0FDSyB8CisJCSAgICAgR0VOOV9QR0NUTF9TU0JfRVUzMTFfQUNLOworCisJZm9yIChz
ID0gMDsgcyA8IGluZm8tPnNzZXUubWF4X3NsaWNlczsgcysrKSB7CisJCWlmICgoc19yZWdbc10g
JiBHRU45X1BHQ1RMX1NMSUNFX0FDSykgPT0gMCkKKwkJCS8qIHNraXAgZGlzYWJsZWQgc2xpY2Ug
Ki8KKwkJCWNvbnRpbnVlOworCisJCXNzZXUtPnNsaWNlX21hc2sgfD0gQklUKHMpOworCQlpbnRl
bF9zc2V1X2NvcHlfc3Vic2xpY2VzKCZpbmZvLT5zc2V1LCBzLCBzc2V1LT5zdWJzbGljZV9tYXNr
KTsKKworCQlmb3IgKHNzID0gMDsgc3MgPCBpbmZvLT5zc2V1Lm1heF9zdWJzbGljZXM7IHNzKysp
IHsKKwkJCXVuc2lnbmVkIGludCBldV9jbnQ7CisKKwkJCWlmIChpbmZvLT5zc2V1Lmhhc19zdWJz
bGljZV9wZyAmJgorCQkJICAgICEoc19yZWdbc10gJiAoR0VOOV9QR0NUTF9TU19BQ0soc3MpKSkp
CisJCQkJLyogc2tpcCBkaXNhYmxlZCBzdWJzbGljZSAqLworCQkJCWNvbnRpbnVlOworCisJCQll
dV9jbnQgPSAyICogaHdlaWdodDMyKGV1X3JlZ1syICogcyArIHNzIC8gMl0gJgorCQkJCQkgICAg
ICAgZXVfbWFza1tzcyAlIDJdKTsKKwkJCXNzZXUtPmV1X3RvdGFsICs9IGV1X2NudDsKKwkJCXNz
ZXUtPmV1X3Blcl9zdWJzbGljZSA9IG1heF90KHVuc2lnbmVkIGludCwKKwkJCQkJCSAgICAgIHNz
ZXUtPmV1X3Blcl9zdWJzbGljZSwKKwkJCQkJCSAgICAgIGV1X2NudCk7CisJCX0KKwl9CisjdW5k
ZWYgU1NfTUFYCit9CisKK3N0YXRpYyB2b2lkIGdlbjlfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVj
dCBpbnRlbF9ndCAqZ3QsCisJCQkJICAgIHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1KQorewor
I2RlZmluZSBTU19NQVggMworCWNvbnN0IHN0cnVjdCBpbnRlbF9ydW50aW1lX2luZm8gKmluZm8g
PSBSVU5USU1FX0lORk8oZ3QtPmk5MTUpOworCXUzMiBzX3JlZ1tTU19NQVhdLCBldV9yZWdbMiAq
IFNTX01BWF0sIGV1X21hc2tbMl07CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3Qt
PnVuY29yZTsKKwlpbnQgcywgc3M7CisKKwlmb3IgKHMgPSAwOyBzIDwgaW5mby0+c3NldS5tYXhf
c2xpY2VzOyBzKyspIHsKKwkJc19yZWdbc10gPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUsIEdF
TjlfU0xJQ0VfUEdDVExfQUNLKHMpKTsKKwkJZXVfcmVnWzIqc10gPSBpbnRlbF91bmNvcmVfcmVh
ZCh1bmNvcmUsCisJCQkJCQlHRU45X1NTMDFfRVVfUEdDVExfQUNLKHMpKTsKKwkJZXVfcmVnWzIq
cyArIDFdID0gaW50ZWxfdW5jb3JlX3JlYWQodW5jb3JlLAorCQkJCQkJICAgIEdFTjlfU1MyM19F
VV9QR0NUTF9BQ0socykpOworCX0KKworCWV1X21hc2tbMF0gPSBHRU45X1BHQ1RMX1NTQV9FVTA4
X0FDSyB8CisJCSAgICAgR0VOOV9QR0NUTF9TU0FfRVUxOV9BQ0sgfAorCQkgICAgIEdFTjlfUEdD
VExfU1NBX0VVMjEwX0FDSyB8CisJCSAgICAgR0VOOV9QR0NUTF9TU0FfRVUzMTFfQUNLOworCWV1
X21hc2tbMV0gPSBHRU45X1BHQ1RMX1NTQl9FVTA4X0FDSyB8CisJCSAgICAgR0VOOV9QR0NUTF9T
U0JfRVUxOV9BQ0sgfAorCQkgICAgIEdFTjlfUEdDVExfU1NCX0VVMjEwX0FDSyB8CisJCSAgICAg
R0VOOV9QR0NUTF9TU0JfRVUzMTFfQUNLOworCisJZm9yIChzID0gMDsgcyA8IGluZm8tPnNzZXUu
bWF4X3NsaWNlczsgcysrKSB7CisJCWlmICgoc19yZWdbc10gJiBHRU45X1BHQ1RMX1NMSUNFX0FD
SykgPT0gMCkKKwkJCS8qIHNraXAgZGlzYWJsZWQgc2xpY2UgKi8KKwkJCWNvbnRpbnVlOworCisJ
CXNzZXUtPnNsaWNlX21hc2sgfD0gQklUKHMpOworCisJCWlmIChJU19HRU45X0JDKGd0LT5pOTE1
KSkKKwkJCWludGVsX3NzZXVfY29weV9zdWJzbGljZXMoJmluZm8tPnNzZXUsIHMsCisJCQkJCQkg
IHNzZXUtPnN1YnNsaWNlX21hc2spOworCisJCWZvciAoc3MgPSAwOyBzcyA8IGluZm8tPnNzZXUu
bWF4X3N1YnNsaWNlczsgc3MrKykgeworCQkJdW5zaWduZWQgaW50IGV1X2NudDsKKwkJCXU4IHNz
X2lkeCA9IHMgKiBpbmZvLT5zc2V1LnNzX3N0cmlkZSArCisJCQkJICAgIHNzIC8gQklUU19QRVJf
QllURTsKKworCQkJaWYgKElTX0dFTjlfTFAoZ3QtPmk5MTUpKSB7CisJCQkJaWYgKCEoc19yZWdb
c10gJiAoR0VOOV9QR0NUTF9TU19BQ0soc3MpKSkpCisJCQkJCS8qIHNraXAgZGlzYWJsZWQgc3Vi
c2xpY2UgKi8KKwkJCQkJY29udGludWU7CisKKwkJCQlzc2V1LT5zdWJzbGljZV9tYXNrW3NzX2lk
eF0gfD0KKwkJCQkJQklUKHNzICUgQklUU19QRVJfQllURSk7CisJCQl9CisKKwkJCWV1X2NudCA9
IDIgKiBod2VpZ2h0MzIoZXVfcmVnWzIqcyArIHNzLzJdICYKKwkJCQkJICAgICAgIGV1X21hc2tb
c3MlMl0pOworCQkJc3NldS0+ZXVfdG90YWwgKz0gZXVfY250OworCQkJc3NldS0+ZXVfcGVyX3N1
YnNsaWNlID0gbWF4X3QodW5zaWduZWQgaW50LAorCQkJCQkJICAgICAgc3NldS0+ZXVfcGVyX3N1
YnNsaWNlLAorCQkJCQkJICAgICAgZXVfY250KTsKKwkJfQorCX0KKyN1bmRlZiBTU19NQVgKK30K
Kworc3RhdGljIHZvaWQgYmR3X3NzZXVfZGV2aWNlX3N0YXR1cyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0
LAorCQkJCSAgIHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1KQoreworCWNvbnN0IHN0cnVjdCBp
bnRlbF9ydW50aW1lX2luZm8gKmluZm8gPSBSVU5USU1FX0lORk8oZ3QtPmk5MTUpOworCXUzMiBz
bGljZV9pbmZvID0gaW50ZWxfdW5jb3JlX3JlYWQoZ3QtPnVuY29yZSwgR0VOOF9HVF9TTElDRV9J
TkZPKTsKKwlpbnQgczsKKworCXNzZXUtPnNsaWNlX21hc2sgPSBzbGljZV9pbmZvICYgR0VOOF9M
U0xJQ0VTVEFUX01BU0s7CisKKwlpZiAoc3NldS0+c2xpY2VfbWFzaykgeworCQlzc2V1LT5ldV9w
ZXJfc3Vic2xpY2UgPSBpbmZvLT5zc2V1LmV1X3Blcl9zdWJzbGljZTsKKwkJZm9yIChzID0gMDsg
cyA8IGZscyhzc2V1LT5zbGljZV9tYXNrKTsgcysrKQorCQkJaW50ZWxfc3NldV9jb3B5X3N1YnNs
aWNlcygmaW5mby0+c3NldSwgcywKKwkJCQkJCSAgc3NldS0+c3Vic2xpY2VfbWFzayk7CisJCXNz
ZXUtPmV1X3RvdGFsID0gc3NldS0+ZXVfcGVyX3N1YnNsaWNlICoKKwkJCQkgaW50ZWxfc3NldV9z
dWJzbGljZV90b3RhbChzc2V1KTsKKworCQkvKiBzdWJ0cmFjdCBmdXNlZCBvZmYgRVUocykgZnJv
bSBlbmFibGVkIHNsaWNlKHMpICovCisJCWZvciAocyA9IDA7IHMgPCBmbHMoc3NldS0+c2xpY2Vf
bWFzayk7IHMrKykgeworCQkJdTggc3Vic2xpY2VfN2V1ID0gaW5mby0+c3NldS5zdWJzbGljZV83
ZXVbc107CisKKwkJCXNzZXUtPmV1X3RvdGFsIC09IGh3ZWlnaHQ4KHN1YnNsaWNlXzdldSk7CisJ
CX0KKwl9Cit9CisKK3N0YXRpYyB2b2lkIHByaW50X3NzZXVfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUg
Km0sIGJvb2wgaXNfYXZhaWxhYmxlX2luZm8sCisJCQkgICAgY29uc3Qgc3RydWN0IHNzZXVfZGV2
X2luZm8gKnNzZXUpCit7CisJc3RydWN0IGludGVsX2d0ICpndCA9IG0tPnByaXZhdGU7CisJY29u
c3QgY2hhciAqdHlwZSA9IGlzX2F2YWlsYWJsZV9pbmZvID8gIkF2YWlsYWJsZSIgOiAiRW5hYmxl
ZCI7CisJaW50IHM7CisKKwlzZXFfcHJpbnRmKG0sICIgICVzIFNsaWNlIE1hc2s6ICUwNHhcbiIs
IHR5cGUsCisJCSAgIHNzZXUtPnNsaWNlX21hc2spOworCXNlcV9wcmludGYobSwgIiAgJXMgU2xp
Y2UgVG90YWw6ICV1XG4iLCB0eXBlLAorCQkgICBod2VpZ2h0OChzc2V1LT5zbGljZV9tYXNrKSk7
CisJc2VxX3ByaW50ZihtLCAiICAlcyBTdWJzbGljZSBUb3RhbDogJXVcbiIsIHR5cGUsCisJCSAg
IGludGVsX3NzZXVfc3Vic2xpY2VfdG90YWwoc3NldSkpOworCWZvciAocyA9IDA7IHMgPCBmbHMo
c3NldS0+c2xpY2VfbWFzayk7IHMrKykgeworCQlzZXFfcHJpbnRmKG0sICIgICVzIFNsaWNlJWkg
c3Vic2xpY2VzOiAldVxuIiwgdHlwZSwKKwkJCSAgIHMsIGludGVsX3NzZXVfc3Vic2xpY2VzX3Bl
cl9zbGljZShzc2V1LCBzKSk7CisJfQorCXNlcV9wcmludGYobSwgIiAgJXMgRVUgVG90YWw6ICV1
XG4iLCB0eXBlLAorCQkgICBzc2V1LT5ldV90b3RhbCk7CisJc2VxX3ByaW50ZihtLCAiICAlcyBF
VSBQZXIgU3Vic2xpY2U6ICV1XG4iLCB0eXBlLAorCQkgICBzc2V1LT5ldV9wZXJfc3Vic2xpY2Up
OworCisJaWYgKCFpc19hdmFpbGFibGVfaW5mbykKKwkJcmV0dXJuOworCisJc2VxX3ByaW50Ziht
LCAiICBIYXMgUG9vbGVkIEVVOiAlc1xuIiwgeWVzbm8oSEFTX1BPT0xFRF9FVShndC0+aTkxNSkp
KTsKKwlpZiAoSEFTX1BPT0xFRF9FVShndC0+aTkxNSkpCisJCXNlcV9wcmludGYobSwgIiAgTWlu
IEVVIGluIHBvb2w6ICV1XG4iLCBzc2V1LT5taW5fZXVfaW5fcG9vbCk7CisKKwlzZXFfcHJpbnRm
KG0sICIgIEhhcyBTbGljZSBQb3dlciBHYXRpbmc6ICVzXG4iLAorCQkgICB5ZXNubyhzc2V1LT5o
YXNfc2xpY2VfcGcpKTsKKwlzZXFfcHJpbnRmKG0sICIgIEhhcyBTdWJzbGljZSBQb3dlciBHYXRp
bmc6ICVzXG4iLAorCQkgICB5ZXNubyhzc2V1LT5oYXNfc3Vic2xpY2VfcGcpKTsKKwlzZXFfcHJp
bnRmKG0sICIgIEhhcyBFVSBQb3dlciBHYXRpbmc6ICVzXG4iLAorCQkgICB5ZXNubyhzc2V1LT5o
YXNfZXVfcGcpKTsKK30KKworc3RhdGljIGludCBzc2V1X3N0YXR1c19zaG93KHN0cnVjdCBzZXFf
ZmlsZSAqbSwgdm9pZCAqdW51c2VkKQoreworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBtLT5wcml2
YXRlOworCWNvbnN0IHN0cnVjdCBpbnRlbF9ydW50aW1lX2luZm8gKmluZm8gPSBSVU5USU1FX0lO
Rk8oZ3QtPmk5MTUpOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ3QtPmk5MTU7
CisJc3RydWN0IHNzZXVfZGV2X2luZm8gc3NldTsKKwlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsK
KworCWlmIChJTlRFTF9HRU4oaTkxNSkgPCA4KQorCQlyZXR1cm4gLUVOT0RFVjsKKworCXNlcV9w
dXRzKG0sICJTU0VVIERldmljZSBJbmZvXG4iKTsKKwlwcmludF9zc2V1X2luZm8obSwgdHJ1ZSwg
JmluZm8tPnNzZXUpOworCisJc2VxX3B1dHMobSwgIlNTRVUgRGV2aWNlIFN0YXR1c1xuIik7CisJ
bWVtc2V0KCZzc2V1LCAwLCBzaXplb2Yoc3NldSkpOworCWludGVsX3NzZXVfc2V0X2luZm8oJnNz
ZXUsIGluZm8tPnNzZXUubWF4X3NsaWNlcywKKwkJCSAgICBpbmZvLT5zc2V1Lm1heF9zdWJzbGlj
ZXMsCisJCQkgICAgaW5mby0+c3NldS5tYXhfZXVzX3Blcl9zdWJzbGljZSk7CisKKwl3aXRoX2lu
dGVsX3J1bnRpbWVfcG0oZ3QtPnVuY29yZS0+cnBtLCB3YWtlcmVmKSB7CisJCWlmIChJU19DSEVS
UllWSUVXKGk5MTUpKQorCQkJY2hlcnJ5dmlld19zc2V1X2RldmljZV9zdGF0dXMoZ3QsICZzc2V1
KTsKKwkJZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpKQorCQkJYmR3X3NzZXVfZGV2aWNlX3N0
YXR1cyhndCwgJnNzZXUpOworCQllbHNlIGlmIChJU19HRU4oaTkxNSwgOSkpCisJCQlnZW45X3Nz
ZXVfZGV2aWNlX3N0YXR1cyhndCwgJnNzZXUpOworCQllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkg
Pj0gMTApCisJCQlnZW4xMF9zc2V1X2RldmljZV9zdGF0dXMoZ3QsICZzc2V1KTsKKwl9CisKKwlw
cmludF9zc2V1X2luZm8obSwgZmFsc2UsICZzc2V1KTsKKworCXJldHVybiAwOworfQorREVGSU5F
X0dUX0RFQlVHRlNfQVRUUklCVVRFKHNzZXVfc3RhdHVzKTsKKwordm9pZCBkZWJ1Z2ZzX2d0X3Jl
Z2lzdGVyX3NzZXUoc3RydWN0IGludGVsX2d0ICpndCwgc3RydWN0IGRlbnRyeSAqcm9vdCkKK3sK
KwlzdGF0aWMgY29uc3Qgc3RydWN0IGRlYnVnZnNfZ3RfZmlsZSBmaWxlc1tdID0geworCQl7ICJz
c2V1X3N0YXR1cyIsICZzc2V1X3N0YXR1c19mb3BzLCBOVUxMIH0sCisJfTsKKworCWludGVsX2d0
X2RlYnVnZnNfcmVnaXN0ZXJfZmlsZXMocm9vdCwgZmlsZXMsIEFSUkFZX1NJWkUoZmlsZXMpLCBn
dCk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9kZWJ1Z2ZzX2d0X3Nz
ZXUuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2RlYnVnZnNfZ3Rfc3NldS5oCm5ldyBmaWxl
IG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYzY3OWM2ZWUzZTZmCi0tLSAvZGV2L251
bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvZGVidWdmc19ndF9zc2V1LmgKQEAgLTAs
MCArMSwxNiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVCAqLworCisvKgorICog
Q29weXJpZ2h0IMKpIDIwMjAgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaWZuZGVmIERFQlVH
RlNfR1RfU1NFVV9ICisjZGVmaW5lIERFQlVHRlNfR1RfU1NFVV9ICisKK3N0cnVjdCBpbnRlbF9n
dDsKK3N0cnVjdCBkZW50cnk7CitzdHJ1Y3Qgc3NldV9kZXZfaW5mbzsKKwordm9pZCBkZWJ1Z2Zz
X2d0X3JlZ2lzdGVyX3NzZXUoc3RydWN0IGludGVsX2d0ICpndCwgc3RydWN0IGRlbnRyeSAqcm9v
dCk7CisKKyNlbmRpZiAvKiBERUJVR0ZTX0dUX1NTRVVfSCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2RlYnVnZnMuYwppbmRleCA0YzhhODhjNjRjMWQuLjA4OGU4NzczYWM1NyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKQEAgLTQyOSw5ICs0MjksOCBAQCBzdGF0aWMgdm9pZCBnZW44
X2Rpc3BsYXlfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptKQogc3RhdGljIGludCBp
OTE1X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIHsKIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+cHJpdmF0
ZSk7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWludGVsX3dha2VyZWZfdCB3
YWtlcmVmOwotCWludCBpLCBwaXBlOworCWludCBwaXBlOwogCiAJd2FrZXJlZiA9IGludGVsX3J1
bnRpbWVfcG1fZ2V0KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAKQEAgLTQ3NywxNSArNDc2LDYg
QEAgc3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9p
ZCAqZGF0YSkKIAkJCSAgIEk5MTVfUkVBRChEUElOVkdUVCkpOwogCQlpbnRlbF9kaXNwbGF5X3Bv
d2VyX3B1dChkZXZfcHJpdiwgUE9XRVJfRE9NQUlOX0lOSVQsIHByZWYpOwogCi0JCWZvciAoaSA9
IDA7IGkgPCA0OyBpKyspIHsKLQkJCXNlcV9wcmludGYobSwgIkdUIEludGVycnVwdCBJTVIgJWQ6
XHQlMDh4XG4iLAotCQkJCSAgIGksIEk5MTVfUkVBRChHRU44X0dUX0lNUihpKSkpOwotCQkJc2Vx
X3ByaW50ZihtLCAiR1QgSW50ZXJydXB0IElJUiAlZDpcdCUwOHhcbiIsCi0JCQkJICAgaSwgSTkx
NV9SRUFEKEdFTjhfR1RfSUlSKGkpKSk7Ci0JCQlzZXFfcHJpbnRmKG0sICJHVCBJbnRlcnJ1cHQg
SUVSICVkOlx0JTA4eFxuIiwKLQkJCQkgICBpLCBJOTE1X1JFQUQoR0VOOF9HVF9JRVIoaSkpKTsK
LQkJfQotCiAJCXNlcV9wcmludGYobSwgIlBDVSBpbnRlcnJ1cHQgbWFzazpcdCUwOHhcbiIsCiAJ
CQkgICBJOTE1X1JFQUQoR0VOOF9QQ1VfSU1SKSk7CiAJCXNlcV9wcmludGYobSwgIlBDVSBpbnRl
cnJ1cHQgaWRlbnRpdHk6XHQlMDh4XG4iLApAQCAtNDk2LDE5ICs0ODYsNiBAQCBzdGF0aWMgaW50
IGk5MTVfaW50ZXJydXB0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogCQlz
ZXFfcHJpbnRmKG0sICJNYXN0ZXIgSW50ZXJydXB0IENvbnRyb2w6ICAlMDh4XG4iLAogCQkJICAg
STkxNV9SRUFEKEdFTjExX0dGWF9NU1RSX0lSUSkpOwogCi0JCXNlcV9wcmludGYobSwgIlJlbmRl
ci9Db3B5IEludHIgRW5hYmxlOiAgICUwOHhcbiIsCi0JCQkgICBJOTE1X1JFQUQoR0VOMTFfUkVO
REVSX0NPUFlfSU5UUl9FTkFCTEUpKTsKLQkJc2VxX3ByaW50ZihtLCAiVkNTL1ZFQ1MgSW50ciBF
bmFibGU6ICAgICAgJTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHRU4xMV9WQ1NfVkVDU19JTlRS
X0VOQUJMRSkpOwotCQlzZXFfcHJpbnRmKG0sICJHVUMvU0cgSW50ciBFbmFibGU6XHQgICAlMDh4
XG4iLAotCQkJICAgSTkxNV9SRUFEKEdFTjExX0dVQ19TR19JTlRSX0VOQUJMRSkpOwotCQlzZXFf
cHJpbnRmKG0sICJHUE0vV0dCT1hQRVJGIEludHIgRW5hYmxlOiAlMDh4XG4iLAotCQkJICAgSTkx
NV9SRUFEKEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9FTkFCTEUpKTsKLQkJc2VxX3ByaW50Ziht
LCAiQ3J5cHRvIEludHIgRW5hYmxlOlx0ICAgJTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHRU4x
MV9DUllQVE9fUlNWRF9JTlRSX0VOQUJMRSkpOwotCQlzZXFfcHJpbnRmKG0sICJHVW5pdC9DU01F
IEludHIgRW5hYmxlOlx0ICAgJTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHRU4xMV9HVU5JVF9D
U01FX0lOVFJfRU5BQkxFKSk7Ci0KIAkJc2VxX3ByaW50ZihtLCAiRGlzcGxheSBJbnRlcnJ1cHQg
Q29udHJvbDpcdCUwOHhcbiIsCiAJCQkgICBJOTE1X1JFQUQoR0VOMTFfRElTUExBWV9JTlRfQ1RM
KSk7CiAKQEAgLTUxNywxNSArNDk0LDYgQEAgc3RhdGljIGludCBpOTE1X2ludGVycnVwdF9pbmZv
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAkJc2VxX3ByaW50ZihtLCAiTWFzdGVy
IEludGVycnVwdCBDb250cm9sOlx0JTA4eFxuIiwKIAkJCSAgIEk5MTVfUkVBRChHRU44X01BU1RF
Ul9JUlEpKTsKIAotCQlmb3IgKGkgPSAwOyBpIDwgNDsgaSsrKSB7Ci0JCQlzZXFfcHJpbnRmKG0s
ICJHVCBJbnRlcnJ1cHQgSU1SICVkOlx0JTA4eFxuIiwKLQkJCQkgICBpLCBJOTE1X1JFQUQoR0VO
OF9HVF9JTVIoaSkpKTsKLQkJCXNlcV9wcmludGYobSwgIkdUIEludGVycnVwdCBJSVIgJWQ6XHQl
MDh4XG4iLAotCQkJCSAgIGksIEk5MTVfUkVBRChHRU44X0dUX0lJUihpKSkpOwotCQkJc2VxX3By
aW50ZihtLCAiR1QgSW50ZXJydXB0IElFUiAlZDpcdCUwOHhcbiIsCi0JCQkJICAgaSwgSTkxNV9S
RUFEKEdFTjhfR1RfSUVSKGkpKSk7Ci0JCX0KLQogCQlnZW44X2Rpc3BsYXlfaW50ZXJydXB0X2lu
Zm8obSk7CiAJfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkgewogCQlpbnRlbF93
YWtlcmVmX3QgcHJlZjsKQEAgLTU1OSwyMCArNTI3LDYgQEAgc3RhdGljIGludCBpOTE1X2ludGVy
cnVwdF9pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAkJc2VxX3ByaW50Ziht
LCAiTWFzdGVyIElFUjpcdCUwOHhcbiIsCiAJCQkgICBJOTE1X1JFQUQoVkxWX01BU1RFUl9JRVIp
KTsKIAotCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgSUVSOlx0JTA4eFxuIiwKLQkJCSAgIEk5MTVf
UkVBRChHVElFUikpOwotCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgSUlSOlx0JTA4eFxuIiwKLQkJ
CSAgIEk5MTVfUkVBRChHVElJUikpOwotCQlzZXFfcHJpbnRmKG0sICJSZW5kZXIgSU1SOlx0JTA4
eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHVElNUikpOwotCi0JCXNlcV9wcmludGYobSwgIlBNIElF
UjpcdFx0JTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHRU42X1BNSUVSKSk7Ci0JCXNlcV9wcmlu
dGYobSwgIlBNIElJUjpcdFx0JTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHRU42X1BNSUlSKSk7
Ci0JCXNlcV9wcmludGYobSwgIlBNIElNUjpcdFx0JTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChH
RU42X1BNSU1SKSk7Ci0KIAkJcHJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9wcml2
LCBQT1dFUl9ET01BSU5fSU5JVCk7CiAJCXNlcV9wcmludGYobSwgIlBvcnQgaG90cGx1ZzpcdCUw
OHhcbiIsCiAJCQkgICBJOTE1X1JFQUQoUE9SVF9IT1RQTFVHX0VOKSk7CkBAIC02MDYsNDAgKzU2
MCw2IEBAIHN0YXRpYyBpbnQgaTkxNV9pbnRlcnJ1cHRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKmRhdGEpCiAJCQkgICBJOTE1X1JFQUQoU0RFSUlSKSk7CiAJCXNlcV9wcmludGYobSwg
IlNvdXRoIERpc3BsYXkgSW50ZXJydXB0IG1hc2s6CQklMDh4XG4iLAogCQkJICAgSTkxNV9SRUFE
KFNERUlNUikpOwotCQlzZXFfcHJpbnRmKG0sICJHcmFwaGljcyBJbnRlcnJ1cHQgZW5hYmxlOgkJ
JTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHVElFUikpOwotCQlzZXFfcHJpbnRmKG0sICJHcmFw
aGljcyBJbnRlcnJ1cHQgaWRlbnRpdHk6CQklMDh4XG4iLAotCQkJICAgSTkxNV9SRUFEKEdUSUlS
KSk7Ci0JCXNlcV9wcmludGYobSwgIkdyYXBoaWNzIEludGVycnVwdCBtYXNrOgkJJTA4eFxuIiwK
LQkJCSAgIEk5MTVfUkVBRChHVElNUikpOwotCX0KLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDExKSB7Ci0JCXNlcV9wcmludGYobSwgIlJDUyBJbnRyIE1hc2s6XHQgJTA4eFxuIiwKLQkJ
CSAgIEk5MTVfUkVBRChHRU4xMV9SQ1MwX1JTVkRfSU5UUl9NQVNLKSk7Ci0JCXNlcV9wcmludGYo
bSwgIkJDUyBJbnRyIE1hc2s6XHQgJTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHRU4xMV9CQ1Nf
UlNWRF9JTlRSX01BU0spKTsKLQkJc2VxX3ByaW50ZihtLCAiVkNTMC9WQ1MxIEludHIgTWFzazpc
dCAlMDh4XG4iLAotCQkJICAgSTkxNV9SRUFEKEdFTjExX1ZDUzBfVkNTMV9JTlRSX01BU0spKTsK
LQkJc2VxX3ByaW50ZihtLCAiVkNTMi9WQ1MzIEludHIgTWFzazpcdCAlMDh4XG4iLAotCQkJICAg
STkxNV9SRUFEKEdFTjExX1ZDUzJfVkNTM19JTlRSX01BU0spKTsKLQkJc2VxX3ByaW50ZihtLCAi
VkVDUzAvVkVDUzEgSW50ciBNYXNrOlx0ICUwOHhcbiIsCi0JCQkgICBJOTE1X1JFQUQoR0VOMTFf
VkVDUzBfVkVDUzFfSU5UUl9NQVNLKSk7Ci0JCXNlcV9wcmludGYobSwgIkdVQy9TRyBJbnRyIE1h
c2s6XHQgJTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHRU4xMV9HVUNfU0dfSU5UUl9NQVNLKSk7
Ci0JCXNlcV9wcmludGYobSwgIkdQTS9XR0JPWFBFUkYgSW50ciBNYXNrOiAlMDh4XG4iLAotCQkJ
ICAgSTkxNV9SRUFEKEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9NQVNLKSk7Ci0JCXNlcV9wcmlu
dGYobSwgIkNyeXB0byBJbnRyIE1hc2s6XHQgJTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHRU4x
MV9DUllQVE9fUlNWRF9JTlRSX01BU0spKTsKLQkJc2VxX3ByaW50ZihtLCAiR3VuaXQvQ1NNRSBJ
bnRyIE1hc2s6XHQgJTA4eFxuIiwKLQkJCSAgIEk5MTVfUkVBRChHRU4xMV9HVU5JVF9DU01FX0lO
VFJfTUFTSykpOwotCi0JfSBlbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDYpIHsKLQkJ
Zm9yX2VhY2hfdWFiaV9lbmdpbmUoZW5naW5lLCBkZXZfcHJpdikgewotCQkJc2VxX3ByaW50Ziht
LAotCQkJCSAgICJHcmFwaGljcyBJbnRlcnJ1cHQgbWFzayAoJXMpOgklMDh4XG4iLAotCQkJCSAg
IGVuZ2luZS0+bmFtZSwgRU5HSU5FX1JFQUQoZW5naW5lLCBSSU5HX0lNUikpOwotCQl9CiAJfQog
CiAJaW50ZWxfcnVudGltZV9wbV9wdXQoJmRldl9wcml2LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsK
QEAgLTE1NjEsMjk4ICsxNDgxLDEwIEBAIGk5MTVfY2FjaGVfc2hhcmluZ19zZXQodm9pZCAqZGF0
YSwgdTY0IHZhbCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIHZvaWQKLWludGVsX3NzZXVfY29w
eV9zdWJzbGljZXMoY29uc3Qgc3RydWN0IHNzZXVfZGV2X2luZm8gKnNzZXUsIGludCBzbGljZSwK
LQkJCSAgdTggKnRvX21hc2spCi17Ci0JaW50IG9mZnNldCA9IHNsaWNlICogc3NldS0+c3Nfc3Ry
aWRlOwotCi0JbWVtY3B5KCZ0b19tYXNrW29mZnNldF0sICZzc2V1LT5zdWJzbGljZV9tYXNrW29m
ZnNldF0sIHNzZXUtPnNzX3N0cmlkZSk7Ci19Ci0KIERFRklORV9TSU1QTEVfQVRUUklCVVRFKGk5
MTVfY2FjaGVfc2hhcmluZ19mb3BzLAogCQkJaTkxNV9jYWNoZV9zaGFyaW5nX2dldCwgaTkxNV9j
YWNoZV9zaGFyaW5nX3NldCwKIAkJCSIlbGx1XG4iKTsKIAotc3RhdGljIHZvaWQgY2hlcnJ5dmll
d19zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAot
CQkJCQkgIHN0cnVjdCBzc2V1X2Rldl9pbmZvICpzc2V1KQotewotI2RlZmluZSBTU19NQVggMgot
CWNvbnN0IGludCBzc19tYXggPSBTU19NQVg7Ci0JdTMyIHNpZzFbU1NfTUFYXSwgc2lnMltTU19N
QVhdOwotCWludCBzczsKLQotCXNpZzFbMF0gPSBJOTE1X1JFQUQoQ0hWX1BPV0VSX1NTMF9TSUcx
KTsKLQlzaWcxWzFdID0gSTkxNV9SRUFEKENIVl9QT1dFUl9TUzFfU0lHMSk7Ci0Jc2lnMlswXSA9
IEk5MTVfUkVBRChDSFZfUE9XRVJfU1MwX1NJRzIpOwotCXNpZzJbMV0gPSBJOTE1X1JFQUQoQ0hW
X1BPV0VSX1NTMV9TSUcyKTsKLQotCWZvciAoc3MgPSAwOyBzcyA8IHNzX21heDsgc3MrKykgewot
CQl1bnNpZ25lZCBpbnQgZXVfY250OwotCi0JCWlmIChzaWcxW3NzXSAmIENIVl9TU19QR19FTkFC
TEUpCi0JCQkvKiBza2lwIGRpc2FibGVkIHN1YnNsaWNlICovCi0JCQljb250aW51ZTsKLQotCQlz
c2V1LT5zbGljZV9tYXNrID0gQklUKDApOwotCQlzc2V1LT5zdWJzbGljZV9tYXNrWzBdIHw9IEJJ
VChzcyk7Ci0JCWV1X2NudCA9ICgoc2lnMVtzc10gJiBDSFZfRVUwOF9QR19FTkFCTEUpID8gMCA6
IDIpICsKLQkJCSAoKHNpZzFbc3NdICYgQ0hWX0VVMTlfUEdfRU5BQkxFKSA/IDAgOiAyKSArCi0J
CQkgKChzaWcxW3NzXSAmIENIVl9FVTIxMF9QR19FTkFCTEUpID8gMCA6IDIpICsKLQkJCSAoKHNp
ZzJbc3NdICYgQ0hWX0VVMzExX1BHX0VOQUJMRSkgPyAwIDogMik7Ci0JCXNzZXUtPmV1X3RvdGFs
ICs9IGV1X2NudDsKLQkJc3NldS0+ZXVfcGVyX3N1YnNsaWNlID0gbWF4X3QodW5zaWduZWQgaW50
LAotCQkJCQkgICAgICBzc2V1LT5ldV9wZXJfc3Vic2xpY2UsIGV1X2NudCk7Ci0JfQotI3VuZGVm
IFNTX01BWAotfQotCi1zdGF0aWMgdm9pZCBnZW4xMF9zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCSAgICAgc3RydWN0IHNzZXVfZGV2X2lu
Zm8gKnNzZXUpCi17Ci0jZGVmaW5lIFNTX01BWCA2Ci0JY29uc3Qgc3RydWN0IGludGVsX3J1bnRp
bWVfaW5mbyAqaW5mbyA9IFJVTlRJTUVfSU5GTyhkZXZfcHJpdik7Ci0JdTMyIHNfcmVnW1NTX01B
WF0sIGV1X3JlZ1syICogU1NfTUFYXSwgZXVfbWFza1syXTsKLQlpbnQgcywgc3M7Ci0KLQlmb3Ig
KHMgPSAwOyBzIDwgaW5mby0+c3NldS5tYXhfc2xpY2VzOyBzKyspIHsKLQkJLyoKLQkJICogRklY
TUU6IFZhbGlkIFNTIE1hc2sgcmVzcGVjdHMgdGhlIHNwZWMgYW5kIHJlYWQKLQkJICogb25seSB2
YWxpZCBiaXRzIGZvciB0aG9zZSByZWdpc3RlcnMsIGV4Y2x1ZGluZyByZXNlcnZlZAotCQkgKiBh
bHRob3VnaCB0aGlzIHNlZW1zIHdyb25nIGJlY2F1c2UgaXQgd291bGQgbGVhdmUgbWFueQotCQkg
KiBzdWJzbGljZXMgd2l0aG91dCBBQ0suCi0JCSAqLwotCQlzX3JlZ1tzXSA9IEk5MTVfUkVBRChH
RU4xMF9TTElDRV9QR0NUTF9BQ0socykpICYKLQkJCUdFTjEwX1BHQ1RMX1ZBTElEX1NTX01BU0so
cyk7Ci0JCWV1X3JlZ1syICogc10gPSBJOTE1X1JFQUQoR0VOMTBfU1MwMV9FVV9QR0NUTF9BQ0so
cykpOwotCQlldV9yZWdbMiAqIHMgKyAxXSA9IEk5MTVfUkVBRChHRU4xMF9TUzIzX0VVX1BHQ1RM
X0FDSyhzKSk7Ci0JfQotCi0JZXVfbWFza1swXSA9IEdFTjlfUEdDVExfU1NBX0VVMDhfQUNLIHwK
LQkJICAgICBHRU45X1BHQ1RMX1NTQV9FVTE5X0FDSyB8Ci0JCSAgICAgR0VOOV9QR0NUTF9TU0Ff
RVUyMTBfQUNLIHwKLQkJICAgICBHRU45X1BHQ1RMX1NTQV9FVTMxMV9BQ0s7Ci0JZXVfbWFza1sx
XSA9IEdFTjlfUEdDVExfU1NCX0VVMDhfQUNLIHwKLQkJICAgICBHRU45X1BHQ1RMX1NTQl9FVTE5
X0FDSyB8Ci0JCSAgICAgR0VOOV9QR0NUTF9TU0JfRVUyMTBfQUNLIHwKLQkJICAgICBHRU45X1BH
Q1RMX1NTQl9FVTMxMV9BQ0s7Ci0KLQlmb3IgKHMgPSAwOyBzIDwgaW5mby0+c3NldS5tYXhfc2xp
Y2VzOyBzKyspIHsKLQkJaWYgKChzX3JlZ1tzXSAmIEdFTjlfUEdDVExfU0xJQ0VfQUNLKSA9PSAw
KQotCQkJLyogc2tpcCBkaXNhYmxlZCBzbGljZSAqLwotCQkJY29udGludWU7Ci0KLQkJc3NldS0+
c2xpY2VfbWFzayB8PSBCSVQocyk7Ci0JCWludGVsX3NzZXVfY29weV9zdWJzbGljZXMoJmluZm8t
PnNzZXUsIHMsIHNzZXUtPnN1YnNsaWNlX21hc2spOwotCi0JCWZvciAoc3MgPSAwOyBzcyA8IGlu
Zm8tPnNzZXUubWF4X3N1YnNsaWNlczsgc3MrKykgewotCQkJdW5zaWduZWQgaW50IGV1X2NudDsK
LQotCQkJaWYgKGluZm8tPnNzZXUuaGFzX3N1YnNsaWNlX3BnICYmCi0JCQkgICAgIShzX3JlZ1tz
XSAmIChHRU45X1BHQ1RMX1NTX0FDSyhzcykpKSkKLQkJCQkvKiBza2lwIGRpc2FibGVkIHN1YnNs
aWNlICovCi0JCQkJY29udGludWU7Ci0KLQkJCWV1X2NudCA9IDIgKiBod2VpZ2h0MzIoZXVfcmVn
WzIgKiBzICsgc3MgLyAyXSAmCi0JCQkJCSAgICAgICBldV9tYXNrW3NzICUgMl0pOwotCQkJc3Nl
dS0+ZXVfdG90YWwgKz0gZXVfY250OwotCQkJc3NldS0+ZXVfcGVyX3N1YnNsaWNlID0gbWF4X3Qo
dW5zaWduZWQgaW50LAotCQkJCQkJICAgICAgc3NldS0+ZXVfcGVyX3N1YnNsaWNlLAotCQkJCQkJ
ICAgICAgZXVfY250KTsKLQkJfQotCX0KLSN1bmRlZiBTU19NQVgKLX0KLQotc3RhdGljIHZvaWQg
Z2VuOV9zc2V1X2RldmljZV9zdGF0dXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAotCQkJCSAgICBzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSkKLXsKLSNkZWZpbmUgU1NfTUFY
IDMKLQljb25zdCBzdHJ1Y3QgaW50ZWxfcnVudGltZV9pbmZvICppbmZvID0gUlVOVElNRV9JTkZP
KGRldl9wcml2KTsKLQl1MzIgc19yZWdbU1NfTUFYXSwgZXVfcmVnWzIgKiBTU19NQVhdLCBldV9t
YXNrWzJdOwotCWludCBzLCBzczsKLQotCWZvciAocyA9IDA7IHMgPCBpbmZvLT5zc2V1Lm1heF9z
bGljZXM7IHMrKykgewotCQlzX3JlZ1tzXSA9IEk5MTVfUkVBRChHRU45X1NMSUNFX1BHQ1RMX0FD
SyhzKSk7Ci0JCWV1X3JlZ1syKnNdID0gSTkxNV9SRUFEKEdFTjlfU1MwMV9FVV9QR0NUTF9BQ0so
cykpOwotCQlldV9yZWdbMipzICsgMV0gPSBJOTE1X1JFQUQoR0VOOV9TUzIzX0VVX1BHQ1RMX0FD
SyhzKSk7Ci0JfQotCi0JZXVfbWFza1swXSA9IEdFTjlfUEdDVExfU1NBX0VVMDhfQUNLIHwKLQkJ
ICAgICBHRU45X1BHQ1RMX1NTQV9FVTE5X0FDSyB8Ci0JCSAgICAgR0VOOV9QR0NUTF9TU0FfRVUy
MTBfQUNLIHwKLQkJICAgICBHRU45X1BHQ1RMX1NTQV9FVTMxMV9BQ0s7Ci0JZXVfbWFza1sxXSA9
IEdFTjlfUEdDVExfU1NCX0VVMDhfQUNLIHwKLQkJICAgICBHRU45X1BHQ1RMX1NTQl9FVTE5X0FD
SyB8Ci0JCSAgICAgR0VOOV9QR0NUTF9TU0JfRVUyMTBfQUNLIHwKLQkJICAgICBHRU45X1BHQ1RM
X1NTQl9FVTMxMV9BQ0s7Ci0KLQlmb3IgKHMgPSAwOyBzIDwgaW5mby0+c3NldS5tYXhfc2xpY2Vz
OyBzKyspIHsKLQkJaWYgKChzX3JlZ1tzXSAmIEdFTjlfUEdDVExfU0xJQ0VfQUNLKSA9PSAwKQot
CQkJLyogc2tpcCBkaXNhYmxlZCBzbGljZSAqLwotCQkJY29udGludWU7Ci0KLQkJc3NldS0+c2xp
Y2VfbWFzayB8PSBCSVQocyk7Ci0KLQkJaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKQotCQkJaW50
ZWxfc3NldV9jb3B5X3N1YnNsaWNlcygmaW5mby0+c3NldSwgcywKLQkJCQkJCSAgc3NldS0+c3Vi
c2xpY2VfbWFzayk7Ci0KLQkJZm9yIChzcyA9IDA7IHNzIDwgaW5mby0+c3NldS5tYXhfc3Vic2xp
Y2VzOyBzcysrKSB7Ci0JCQl1bnNpZ25lZCBpbnQgZXVfY250OwotCQkJdTggc3NfaWR4ID0gcyAq
IGluZm8tPnNzZXUuc3Nfc3RyaWRlICsKLQkJCQkgICAgc3MgLyBCSVRTX1BFUl9CWVRFOwotCi0J
CQlpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikpIHsKLQkJCQlpZiAoIShzX3JlZ1tzXSAmIChHRU45
X1BHQ1RMX1NTX0FDSyhzcykpKSkKLQkJCQkJLyogc2tpcCBkaXNhYmxlZCBzdWJzbGljZSAqLwot
CQkJCQljb250aW51ZTsKLQotCQkJCXNzZXUtPnN1YnNsaWNlX21hc2tbc3NfaWR4XSB8PQotCQkJ
CQlCSVQoc3MgJSBCSVRTX1BFUl9CWVRFKTsKLQkJCX0KLQotCQkJZXVfY250ID0gMiAqIGh3ZWln
aHQzMihldV9yZWdbMipzICsgc3MvMl0gJgotCQkJCQkgICAgICAgZXVfbWFza1tzcyUyXSk7Ci0J
CQlzc2V1LT5ldV90b3RhbCArPSBldV9jbnQ7Ci0JCQlzc2V1LT5ldV9wZXJfc3Vic2xpY2UgPSBt
YXhfdCh1bnNpZ25lZCBpbnQsCi0JCQkJCQkgICAgICBzc2V1LT5ldV9wZXJfc3Vic2xpY2UsCi0J
CQkJCQkgICAgICBldV9jbnQpOwotCQl9Ci0JfQotI3VuZGVmIFNTX01BWAotfQotCi1zdGF0aWMg
dm9pZCBiZHdfc3NldV9kZXZpY2Vfc3RhdHVzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKLQkJCQkgICBzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSkKLXsKLQljb25zdCBzdHJ1
Y3QgaW50ZWxfcnVudGltZV9pbmZvICppbmZvID0gUlVOVElNRV9JTkZPKGRldl9wcml2KTsKLQl1
MzIgc2xpY2VfaW5mbyA9IEk5MTVfUkVBRChHRU44X0dUX1NMSUNFX0lORk8pOwotCWludCBzOwot
Ci0Jc3NldS0+c2xpY2VfbWFzayA9IHNsaWNlX2luZm8gJiBHRU44X0xTTElDRVNUQVRfTUFTSzsK
LQotCWlmIChzc2V1LT5zbGljZV9tYXNrKSB7Ci0JCXNzZXUtPmV1X3Blcl9zdWJzbGljZSA9IGlu
Zm8tPnNzZXUuZXVfcGVyX3N1YnNsaWNlOwotCQlmb3IgKHMgPSAwOyBzIDwgZmxzKHNzZXUtPnNs
aWNlX21hc2spOyBzKyspCi0JCQlpbnRlbF9zc2V1X2NvcHlfc3Vic2xpY2VzKCZpbmZvLT5zc2V1
LCBzLAotCQkJCQkJICBzc2V1LT5zdWJzbGljZV9tYXNrKTsKLQkJc3NldS0+ZXVfdG90YWwgPSBz
c2V1LT5ldV9wZXJfc3Vic2xpY2UgKgotCQkJCSBpbnRlbF9zc2V1X3N1YnNsaWNlX3RvdGFsKHNz
ZXUpOwotCi0JCS8qIHN1YnRyYWN0IGZ1c2VkIG9mZiBFVShzKSBmcm9tIGVuYWJsZWQgc2xpY2Uo
cykgKi8KLQkJZm9yIChzID0gMDsgcyA8IGZscyhzc2V1LT5zbGljZV9tYXNrKTsgcysrKSB7Ci0J
CQl1OCBzdWJzbGljZV83ZXUgPSBpbmZvLT5zc2V1LnN1YnNsaWNlXzdldVtzXTsKLQotCQkJc3Nl
dS0+ZXVfdG90YWwgLT0gaHdlaWdodDgoc3Vic2xpY2VfN2V1KTsKLQkJfQotCX0KLX0KLQotc3Rh
dGljIHZvaWQgaTkxNV9wcmludF9zc2V1X2luZm8oc3RydWN0IHNlcV9maWxlICptLCBib29sIGlz
X2F2YWlsYWJsZV9pbmZvLAotCQkJCSBjb25zdCBzdHJ1Y3Qgc3NldV9kZXZfaW5mbyAqc3NldSkK
LXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3RvX2k5MTUobS0+
cHJpdmF0ZSk7Ci0JY29uc3QgY2hhciAqdHlwZSA9IGlzX2F2YWlsYWJsZV9pbmZvID8gIkF2YWls
YWJsZSIgOiAiRW5hYmxlZCI7Ci0JaW50IHM7Ci0KLQlzZXFfcHJpbnRmKG0sICIgICVzIFNsaWNl
IE1hc2s6ICUwNHhcbiIsIHR5cGUsCi0JCSAgIHNzZXUtPnNsaWNlX21hc2spOwotCXNlcV9wcmlu
dGYobSwgIiAgJXMgU2xpY2UgVG90YWw6ICV1XG4iLCB0eXBlLAotCQkgICBod2VpZ2h0OChzc2V1
LT5zbGljZV9tYXNrKSk7Ci0Jc2VxX3ByaW50ZihtLCAiICAlcyBTdWJzbGljZSBUb3RhbDogJXVc
biIsIHR5cGUsCi0JCSAgIGludGVsX3NzZXVfc3Vic2xpY2VfdG90YWwoc3NldSkpOwotCWZvciAo
cyA9IDA7IHMgPCBmbHMoc3NldS0+c2xpY2VfbWFzayk7IHMrKykgewotCQlzZXFfcHJpbnRmKG0s
ICIgICVzIFNsaWNlJWkgc3Vic2xpY2VzOiAldVxuIiwgdHlwZSwKLQkJCSAgIHMsIGludGVsX3Nz
ZXVfc3Vic2xpY2VzX3Blcl9zbGljZShzc2V1LCBzKSk7Ci0JfQotCXNlcV9wcmludGYobSwgIiAg
JXMgRVUgVG90YWw6ICV1XG4iLCB0eXBlLAotCQkgICBzc2V1LT5ldV90b3RhbCk7Ci0Jc2VxX3By
aW50ZihtLCAiICAlcyBFVSBQZXIgU3Vic2xpY2U6ICV1XG4iLCB0eXBlLAotCQkgICBzc2V1LT5l
dV9wZXJfc3Vic2xpY2UpOwotCi0JaWYgKCFpc19hdmFpbGFibGVfaW5mbykKLQkJcmV0dXJuOwot
Ci0Jc2VxX3ByaW50ZihtLCAiICBIYXMgUG9vbGVkIEVVOiAlc1xuIiwgeWVzbm8oSEFTX1BPT0xF
RF9FVShkZXZfcHJpdikpKTsKLQlpZiAoSEFTX1BPT0xFRF9FVShkZXZfcHJpdikpCi0JCXNlcV9w
cmludGYobSwgIiAgTWluIEVVIGluIHBvb2w6ICV1XG4iLCBzc2V1LT5taW5fZXVfaW5fcG9vbCk7
Ci0KLQlzZXFfcHJpbnRmKG0sICIgIEhhcyBTbGljZSBQb3dlciBHYXRpbmc6ICVzXG4iLAotCQkg
ICB5ZXNubyhzc2V1LT5oYXNfc2xpY2VfcGcpKTsKLQlzZXFfcHJpbnRmKG0sICIgIEhhcyBTdWJz
bGljZSBQb3dlciBHYXRpbmc6ICVzXG4iLAotCQkgICB5ZXNubyhzc2V1LT5oYXNfc3Vic2xpY2Vf
cGcpKTsKLQlzZXFfcHJpbnRmKG0sICIgIEhhcyBFVSBQb3dlciBHYXRpbmc6ICVzXG4iLAotCQkg
ICB5ZXNubyhzc2V1LT5oYXNfZXVfcGcpKTsKLX0KLQotc3RhdGljIGludCBpOTE1X3NzZXVfc3Rh
dHVzKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQotewotCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IG5vZGVfdG9faTkxNShtLT5wcml2YXRlKTsKLQljb25zdCBz
dHJ1Y3QgaW50ZWxfcnVudGltZV9pbmZvICppbmZvID0gUlVOVElNRV9JTkZPKGRldl9wcml2KTsK
LQlzdHJ1Y3Qgc3NldV9kZXZfaW5mbyBzc2V1OwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwot
Ci0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA4KQotCQlyZXR1cm4gLUVOT0RFVjsKLQotCXNl
cV9wdXRzKG0sICJTU0VVIERldmljZSBJbmZvXG4iKTsKLQlpOTE1X3ByaW50X3NzZXVfaW5mbyht
LCB0cnVlLCAmaW5mby0+c3NldSk7Ci0KLQlzZXFfcHV0cyhtLCAiU1NFVSBEZXZpY2UgU3RhdHVz
XG4iKTsKLQltZW1zZXQoJnNzZXUsIDAsIHNpemVvZihzc2V1KSk7Ci0JaW50ZWxfc3NldV9zZXRf
aW5mbygmc3NldSwgaW5mby0+c3NldS5tYXhfc2xpY2VzLAotCQkJICAgIGluZm8tPnNzZXUubWF4
X3N1YnNsaWNlcywKLQkJCSAgICBpbmZvLT5zc2V1Lm1heF9ldXNfcGVyX3N1YnNsaWNlKTsKLQot
CXdpdGhfaW50ZWxfcnVudGltZV9wbSgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0sIHdha2VyZWYpIHsK
LQkJaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQotCQkJY2hlcnJ5dmlld19zc2V1X2Rldmlj
ZV9zdGF0dXMoZGV2X3ByaXYsICZzc2V1KTsKLQkJZWxzZSBpZiAoSVNfQlJPQURXRUxMKGRldl9w
cml2KSkKLQkJCWJkd19zc2V1X2RldmljZV9zdGF0dXMoZGV2X3ByaXYsICZzc2V1KTsKLQkJZWxz
ZSBpZiAoSVNfR0VOKGRldl9wcml2LCA5KSkKLQkJCWdlbjlfc3NldV9kZXZpY2Vfc3RhdHVzKGRl
dl9wcml2LCAmc3NldSk7Ci0JCWVsc2UgaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApCi0J
CQlnZW4xMF9zc2V1X2RldmljZV9zdGF0dXMoZGV2X3ByaXYsICZzc2V1KTsKLQl9Ci0KLQlpOTE1
X3ByaW50X3NzZXVfaW5mbyhtLCBmYWxzZSwgJnNzZXUpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0
YXRpYyBpbnQgaTkxNV9mb3JjZXdha2Vfb3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3Qg
ZmlsZSAqZmlsZSkKLXsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGlub2RlLT5p
X3ByaXZhdGU7Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKLQotCWF0b21pY19p
bmMoJmd0LT51c2VyX3dha2VyZWYpOwotCWludGVsX2d0X3BtX2dldChndCk7Ci0JaWYgKElOVEVM
X0dFTihpOTE1KSA+PSA2KQotCQlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX3VzZXJfZ2V0KGd0LT51
bmNvcmUpOwotCi0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgaTkxNV9mb3JjZXdha2VfcmVs
ZWFzZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKLXsKLQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGlub2RlLT5pX3ByaXZhdGU7Ci0Jc3RydWN0IGludGVs
X2d0ICpndCA9ICZpOTE1LT5ndDsKLQotCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNikKLQkJaW50
ZWxfdW5jb3JlX2ZvcmNld2FrZV91c2VyX3B1dCgmaTkxNS0+dW5jb3JlKTsKLQlpbnRlbF9ndF9w
bV9wdXQoZ3QpOwotCWF0b21pY19kZWMoJmd0LT51c2VyX3dha2VyZWYpOwotCi0JcmV0dXJuIDA7
Ci19Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGk5MTVfZm9yY2V3YWtl
X2ZvcHMgPSB7Ci0JLm93bmVyID0gVEhJU19NT0RVTEUsCi0JLm9wZW4gPSBpOTE1X2ZvcmNld2Fr
ZV9vcGVuLAotCS5yZWxlYXNlID0gaTkxNV9mb3JjZXdha2VfcmVsZWFzZSwKLX07Ci0KIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgZHJtX2luZm9fbGlzdCBpOTE1X2RlYnVnZnNfbGlzdFtdID0gewogCXsi
aTkxNV9jYXBhYmlsaXRpZXMiLCBpOTE1X2NhcGFiaWxpdGllcywgMH0sCiAJeyJpOTE1X2dlbV9v
YmplY3RzIiwgaTkxNV9nZW1fb2JqZWN0X2luZm8sIDB9LApAQCAtMTg2OCw3ICsxNTAwLDYgQEAg
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGk5MTVfZGVidWdmc19saXN0W10gPSB7
CiAJeyJpOTE1X3Jjc190b3BvbG9neSIsIGk5MTVfcmNzX3RvcG9sb2d5LCAwfSwKIAl7Imk5MTVf
c2hyaW5rZXJfaW5mbyIsIGk5MTVfc2hyaW5rZXJfaW5mbywgMH0sCiAJeyJpOTE1X3dhX3JlZ2lz
dGVycyIsIGk5MTVfd2FfcmVnaXN0ZXJzLCAwfSwKLQl7Imk5MTVfc3NldV9zdGF0dXMiLCBpOTE1
X3NzZXVfc3RhdHVzLCAwfSwKIAl7Imk5MTVfcnBzX2Jvb3N0X2luZm8iLCBpOTE1X3Jwc19ib29z
dF9pbmZvLCAwfSwKIH07CiAjZGVmaW5lIEk5MTVfREVCVUdGU19FTlRSSUVTIEFSUkFZX1NJWkUo
aTkxNV9kZWJ1Z2ZzX2xpc3QpCkBAIC0xODk0LDggKzE1MjUsNiBAQCB2b2lkIGk5MTVfZGVidWdm
c19yZWdpc3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAKIAlpOTE1X2Rl
YnVnZnNfcGFyYW1zKGRldl9wcml2KTsKIAotCWRlYnVnZnNfY3JlYXRlX2ZpbGUoImk5MTVfZm9y
Y2V3YWtlX3VzZXIiLCBTX0lSVVNSLCBtaW5vci0+ZGVidWdmc19yb290LAotCQkJICAgIHRvX2k5
MTUobWlub3ItPmRldiksICZpOTE1X2ZvcmNld2FrZV9mb3BzKTsKIAlmb3IgKGkgPSAwOyBpIDwg
QVJSQVlfU0laRShpOTE1X2RlYnVnZnNfZmlsZXMpOyBpKyspIHsKIAkJZGVidWdmc19jcmVhdGVf
ZmlsZShpOTE1X2RlYnVnZnNfZmlsZXNbaV0ubmFtZSwKIAkJCQkgICAgU19JUlVHTyB8IFNfSVdV
U1IsCi0tIAoyLjI1LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVs
LWdmeAo=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 327CEE33AB
	for <lists+intel-gfx@lfdr.de>; Thu, 24 Oct 2019 15:14:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 53D416E3F4;
	Thu, 24 Oct 2019 13:14:04 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8980C6E3EF
 for <intel-gfx@lists.freedesktop.org>; Thu, 24 Oct 2019 13:13:59 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18949963-1500050 
 for multiple; Thu, 24 Oct 2019 14:13:45 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 24 Oct 2019 14:13:39 +0100
Message-Id: <20191024131343.16194-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc0
MIME-Version: 1.0
Subject: [Intel-gfx] [RFC 1/5] drm/i915: Drop GEM context as a direct link
 from i915_request
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

S2VlcCB0aGUgaW50ZWxfY29udGV4dCBhcyBiZWluZyB0aGUgcHJpbWFyeSBzdGF0ZSBmb3IgaTkx
NV9yZXF1ZXN0LCB3aXRoCnRoZSBHRU0gY29udGV4dCBhIGJhY2twb2ludGVyIGZyb20gdGhlIGxv
dyBsZXZlbCBzdGF0ZSBmb3IgdGhlIHJhcmVyCmNhc2VzIHdlIG5lZWQgY2xpZW50IGluZm9ybWF0
aW9uLiBPdXIgZ29hbCBpcyB0byByZW1vdmUgc3VjaCByZWZlcmVuY2VzCnRvIGNsaWVudHMgZnJv
bSB0aGUgYmFja2VuZCwgYW5kIGxlYXZlIHRoZSBIVyBzdWJtaXNzaW9uIGFnbm9zdGljIHRvCmNs
aWVudCBpbnRlcmZhY2VzIGFuZCBzZWxmLWNvbnRhaW5lZC4KClNpZ25lZC1vZmYtYnk6IENocmlz
IFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgICB8IDE1ICsrLS0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCAgIHwgMzggLS0tLS0tLS0tLS0tLS0tCiAuLi4v
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmggfCAgNyArLS0KIC4uLi9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyAgICB8ICA4ICsrLS0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMgICB8ICA0ICstCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0LmMgICAgICAgfCAgMiArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oICAgICAgIHwgNDIgKysrKysrKysrKysrKysr
KwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF90eXBlcy5oIHwgIDUgKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jICAgICB8ICA2ICstLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgICAgICAgICAgIHwgNDggKysrKysr
KysrLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyAgICAg
ICAgIHwgMzggKysrKysrKystLS0tLS0tCiAuLi4vZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jpbmdf
c3VibWlzc2lvbi5jICAgfCAxMCArKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVz
dF9scmMuYyAgICAgICAgfCAyMCArKysrLS0tLQogLi4uL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRl
bF9ndWNfc3VibWlzc2lvbi5jIHwgIDYgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2No
ZWR1bGVyLmMgICAgICAgICAgfCAyNyArKysrKy0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW0uYyAgICAgICAgICAgICAgIHwgIDYgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dwdV9lcnJvci5jICAgICAgICAgfCAxMSArKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9wZXJmLmMgICAgICAgICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfcmVxdWVzdC5jICAgICAgICAgICB8IDE1ICsrKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9yZXF1ZXN0LmggICAgICAgICAgIHwgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfc2NoZWR1bGVyLmMgICAgICAgICB8ICAyICstCiAyMSBmaWxlcyBjaGFuZ2VkLCAxNTkgaW5z
ZXJ0aW9ucygrKSwgMTU4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fY29udGV4dC5jCmluZGV4IDU1ZjFmOTNjMDkyNS4uZWZhNGY3Yzc2MmMzIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTY5LDYgKzY5
LDcgQEAKIAogI2luY2x1ZGUgPGRybS9pOTE1X2RybS5oPgogCisjaW5jbHVkZSAiZ3QvaW50ZWxf
Y29udGV4dC5oIgogI2luY2x1ZGUgImd0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaCIKICNpbmNs
dWRlICJndC9pbnRlbF9lbmdpbmVfdXNlci5oIgogI2luY2x1ZGUgImd0L2ludGVsX2xyY19yZWcu
aCIKQEAgLTM2NCwxNSArMzY1LDYgQEAgc3RhdGljIHZvaWQga2lsbF9jb250ZXh0KHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNfaXRlciBpdDsK
IAlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CiAKLQkvKgotCSAqIElmIHdlIGFyZSBhbHJlYWR5
IGJhbm5lZCwgaXQgd2FzIGR1ZSB0byBhIGd1aWx0eSByZXF1ZXN0IGNhdXNpbmcKLQkgKiBhIHJl
c2V0IGFuZCB0aGUgZW50aXJlIGNvbnRleHQgYmVpbmcgZXZpY3RlZCBmcm9tIHRoZSBHUFUuCi0J
ICovCi0JaWYgKGk5MTVfZ2VtX2NvbnRleHRfaXNfYmFubmVkKGN0eCkpCi0JCXJldHVybjsKLQot
CWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5lZChjdHgpOwotCiAJLyoKIAkgKiBNYXAgdGhlIHVz
ZXIncyBlbmdpbmUgYmFjayB0byB0aGUgYWN0dWFsIGVuZ2luZXM7IG9uZSB2aXJ0dWFsCiAJICog
ZW5naW5lIHdpbGwgYmUgbWFwcGVkIHRvIG11bHRpcGxlIGVuZ2luZXMsIGFuZCB1c2luZyBjdHgt
PmVuZ2luZVtdCkBAIC0zODQsNiArMzc2LDkgQEAgc3RhdGljIHZvaWQga2lsbF9jb250ZXh0KHN0
cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZTsKIAkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7CiAKKwkJaWYgKCFpbnRlbF9jb250ZXh0
X3NldF9iYW5uZWQoY2UpKQorCQkJY29udGludWU7CisKIAkJaWYgKCFjZS0+dGltZWxpbmUpCiAJ
CQljb250aW51ZTsKIApAQCAtOTk2LDcgKzk5MSw3IEBAIHN0YXRpYyB2b2lkIHNldF9wcGd0dF9i
YXJyaWVyKHZvaWQgKmRhdGEpCiAKIHN0YXRpYyBpbnQgZW1pdF9wcGd0dF91cGRhdGUoc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEsIHZvaWQgKmRhdGEpCiB7Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19z
cGFjZSAqdm0gPSBycS0+aHdfY29udGV4dC0+dm07CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFj
ZSAqdm0gPSBycS0+Y29udGV4dC0+dm07CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
ID0gcnEtPmVuZ2luZTsKIAl1MzIgYmFzZSA9IGVuZ2luZS0+bW1pb19iYXNlOwogCXUzMiAqY3M7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5o
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaAppbmRleCBjZmU4
MDU5MGYwZWQuLjZkMjI2MzY1OGVkYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2NvbnRleHQuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fY29udGV4dC5oCkBAIC03NiwyNiArNzYsNiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaTkx
NV9nZW1fY29udGV4dF9jbGVhcl9yZWNvdmVyYWJsZShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAq
YwogCWNsZWFyX2JpdChVQ09OVEVYVF9SRUNPVkVSQUJMRSwgJmN0eC0+dXNlcl9mbGFncyk7CiB9
CiAKLXN0YXRpYyBpbmxpbmUgYm9vbCBpOTE1X2dlbV9jb250ZXh0X2lzX2Jhbm5lZChjb25zdCBz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQotewotCXJldHVybiB0ZXN0X2JpdChDT05URVhU
X0JBTk5FRCwgJmN0eC0+ZmxhZ3MpOwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQgaTkxNV9nZW1f
Y29udGV4dF9zZXRfYmFubmVkKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCi17Ci0Jc2V0
X2JpdChDT05URVhUX0JBTk5FRCwgJmN0eC0+ZmxhZ3MpOwotfQotCi1zdGF0aWMgaW5saW5lIGJv
b2wgaTkxNV9nZW1fY29udGV4dF9mb3JjZV9zaW5nbGVfc3VibWlzc2lvbihjb25zdCBzdHJ1Y3Qg
aTkxNV9nZW1fY29udGV4dCAqY3R4KQotewotCXJldHVybiB0ZXN0X2JpdChDT05URVhUX0ZPUkNF
X1NJTkdMRV9TVUJNSVNTSU9OLCAmY3R4LT5mbGFncyk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9p
ZCBpOTE1X2dlbV9jb250ZXh0X3NldF9mb3JjZV9zaW5nbGVfc3VibWlzc2lvbihzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4KQotewotCV9fc2V0X2JpdChDT05URVhUX0ZPUkNFX1NJTkdMRV9T
VUJNSVNTSU9OLCAmY3R4LT5mbGFncyk7Ci19Ci0KIHN0YXRpYyBpbmxpbmUgYm9vbAogaTkxNV9n
ZW1fY29udGV4dF91c2VyX2VuZ2luZXMoY29uc3Qgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eCkKIHsKQEAgLTExNCwyNCArOTQsNiBAQCBpOTE1X2dlbV9jb250ZXh0X2NsZWFyX3VzZXJfZW5n
aW5lcyhzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogCWNsZWFyX2JpdChDT05URVhUX1VT
RVJfRU5HSU5FUywgJmN0eC0+ZmxhZ3MpOwogfQogCi1zdGF0aWMgaW5saW5lIGJvb2wKLWk5MTVf
Z2VtX2NvbnRleHRfbm9wcmVlbXB0KGNvbnN0IHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgp
Ci17Ci0JcmV0dXJuIHRlc3RfYml0KENPTlRFWFRfTk9QUkVFTVBULCAmY3R4LT5mbGFncyk7Ci19
Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZAotaTkxNV9nZW1fY29udGV4dF9zZXRfbm9wcmVlbXB0KHN0
cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCi17Ci0Jc2V0X2JpdChDT05URVhUX05PUFJFRU1Q
VCwgJmN0eC0+ZmxhZ3MpOwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQKLWk5MTVfZ2VtX2NvbnRl
eHRfY2xlYXJfbm9wcmVlbXB0KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCi17Ci0JY2xl
YXJfYml0KENPTlRFWFRfTk9QUkVFTVBULCAmY3R4LT5mbGFncyk7Ci19Ci0KIHN0YXRpYyBpbmxp
bmUgYm9vbCBpOTE1X2dlbV9jb250ZXh0X2lzX2tlcm5lbChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4KQogewogCXJldHVybiAhY3R4LT5maWxlX3ByaXY7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90eXBlcy5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaAppbmRleCBmZTk3YjhiYTRmZGEu
LmI3NDBhMTZlY2RlYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2NvbnRleHRfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fY29udGV4dF90eXBlcy5oCkBAIC0xNDIsMTEgKzE0Miw4IEBAIHN0cnVjdCBpOTE1X2dlbV9j
b250ZXh0IHsKIAkgKiBAZmxhZ3M6IHNtYWxsIHNldCBvZiBib29sZWFucwogCSAqLwogCXVuc2ln
bmVkIGxvbmcgZmxhZ3M7Ci0jZGVmaW5lIENPTlRFWFRfQkFOTkVECQkJMAotI2RlZmluZSBDT05U
RVhUX0NMT1NFRAkJCTEKLSNkZWZpbmUgQ09OVEVYVF9GT1JDRV9TSU5HTEVfU1VCTUlTU0lPTgky
Ci0jZGVmaW5lIENPTlRFWFRfVVNFUl9FTkdJTkVTCQkzCi0jZGVmaW5lIENPTlRFWFRfTk9QUkVF
TVBUCQk0CisjZGVmaW5lIENPTlRFWFRfQ0xPU0VECQkJMAorI2RlZmluZSBDT05URVhUX1VTRVJf
RU5HSU5FUwkJMQogCiAJc3RydWN0IG11dGV4IG11dGV4OwogCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwppbmRleCBlNGY1YzI2OTE1MGEuLjZkYzg2
YzEyOWVlZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4
ZWNidWZmZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1
ZmZlci5jCkBAIC03NDYsOSArNzQ2LDYgQEAgc3RhdGljIGludCBlYl9sb29rdXBfdm1hcyhzdHJ1
Y3QgaTkxNV9leGVjYnVmZmVyICplYikKIAl1bnNpZ25lZCBpbnQgaSwgYmF0Y2g7CiAJaW50IGVy
cjsKIAotCWlmICh1bmxpa2VseShpOTE1X2dlbV9jb250ZXh0X2lzX2Jhbm5lZChlYi0+Z2VtX2Nv
bnRleHQpKSkKLQkJcmV0dXJuIC1FSU87Ci0KIAlJTklUX0xJU1RfSEVBRCgmZWItPnJlbG9jcyk7
CiAJSU5JVF9MSVNUX0hFQUQoJmViLT51bmJvdW5kKTsKIApAQCAtMjA3OCw3ICsyMDc1LDcgQEAg
c3RhdGljIGludCBlYl9zdWJtaXQoc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIpCiAJaWYgKGVy
cikKIAkJcmV0dXJuIGVycjsKIAotCWlmIChpOTE1X2dlbV9jb250ZXh0X25vcHJlZW1wdChlYi0+
Z2VtX2NvbnRleHQpKQorCWlmIChpbnRlbF9jb250ZXh0X25vcHJlZW1wdChlYi0+Y29udGV4dCkp
CiAJCWViLT5yZXF1ZXN0LT5mbGFncyB8PSBJOTE1X1JFUVVFU1RfTk9QUkVFTVBUOwogCiAJcmV0
dXJuIDA7CkBAIC0yMTY0LDYgKzIxNjEsOSBAQCBzdGF0aWMgaW50IF9fZWJfcGluX2VuZ2luZShz
dHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYiwgc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQogCWlm
IChlcnIpCiAJCXJldHVybiBlcnI7CiAKKwlpZiAodW5saWtlbHkoaW50ZWxfY29udGV4dF9pc19i
YW5uZWQoY2UpKSkKKwkJcmV0dXJuIC1FSU87CisKIAkvKgogCSAqIFBpbm5pbmcgdGhlIGNvbnRl
eHRzIG1heSBnZW5lcmF0ZSByZXF1ZXN0cyBpbiBvcmRlciB0byBhY3F1aXJlCiAJICogR0dUVCBz
cGFjZSwgc28gZG8gdGhpcyBmaXJzdCBiZWZvcmUgd2UgcmVzZXJ2ZSBhIHNlcW5vIGZvcgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfYnJlYWRjcnVtYnMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMKaW5kZXggNTUzMTcwODFk
NDhiLi4yZjExYmVlNjM4ZDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2JyZWFkY3J1bWJzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfYnJl
YWRjcnVtYnMuYwpAQCAtMjcxLDcgKzI3MSw3IEBAIGJvb2wgaTkxNV9yZXF1ZXN0X2VuYWJsZV9i
cmVhZGNydW1iKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCiAJaWYgKHRlc3RfYml0KEk5MTVf
RkVOQ0VfRkxBR19BQ1RJVkUsICZycS0+ZmVuY2UuZmxhZ3MpKSB7CiAJCXN0cnVjdCBpbnRlbF9i
cmVhZGNydW1icyAqYiA9ICZycS0+ZW5naW5lLT5icmVhZGNydW1iczsKLQkJc3RydWN0IGludGVs
X2NvbnRleHQgKmNlID0gcnEtPmh3X2NvbnRleHQ7CisJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZSA9IHJxLT5jb250ZXh0OwogCQlzdHJ1Y3QgbGlzdF9oZWFkICpwb3M7CiAKIAkJc3Bpbl9sb2Nr
KCZiLT5pcnFfbG9jayk7CkBAIC0zMjYsNyArMzI2LDcgQEAgdm9pZCBpOTE1X3JlcXVlc3RfY2Fu
Y2VsX2JyZWFkY3J1bWIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJICovCiAJc3Bpbl9sb2Nr
KCZiLT5pcnFfbG9jayk7CiAJaWYgKHRlc3RfYml0KEk5MTVfRkVOQ0VfRkxBR19TSUdOQUwsICZy
cS0+ZmVuY2UuZmxhZ3MpKSB7Ci0JCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSA9IHJxLT5od19j
b250ZXh0OworCQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UgPSBycS0+Y29udGV4dDsKIAogCQls
aXN0X2RlbCgmcnEtPnNpZ25hbF9saW5rKTsKIAkJaWYgKGxpc3RfZW1wdHkoJmNlLT5zaWduYWxz
KSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwppbmRleCBlZTlkMmJjZDJj
MTMuLjYyNWY3NWY3ODI1ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQu
YwpAQCAtMzA3LDcgKzMwNyw3IEBAIGludCBpbnRlbF9jb250ZXh0X3ByZXBhcmVfcmVtb3RlX3Jl
cXVlc3Qoc3RydWN0IGludGVsX2NvbnRleHQgKmNlLAogCWludCBlcnI7CiAKIAkvKiBPbmx5IHN1
aXRhYmxlIGZvciB1c2UgaW4gcmVtb3RlbHkgbW9kaWZ5aW5nIHRoaXMgY29udGV4dCAqLwotCUdF
TV9CVUdfT04ocnEtPmh3X2NvbnRleHQgPT0gY2UpOworCUdFTV9CVUdfT04ocnEtPmNvbnRleHQg
PT0gY2UpOwogCiAJaWYgKHJjdV9hY2Nlc3NfcG9pbnRlcihycS0+dGltZWxpbmUpICE9IHRsKSB7
IC8qIHRpbWVsaW5lIHNoYXJpbmchICovCiAJCWVyciA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJs
ZV9uZXN0ZWQoJnRsLT5tdXRleCwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX2NvbnRleHQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQu
aAppbmRleCA2OGIzZDMxN2Q5NTkuLjFlNjA3MzQzZDI1NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2NvbnRleHQuaApAQCAtNyw3ICs3LDkgQEAKICNpZm5kZWYgX19JTlRFTF9DT05U
RVhUX0hfXwogI2RlZmluZSBfX0lOVEVMX0NPTlRFWFRfSF9fCiAKKyNpbmNsdWRlIDxsaW51eC9i
aXRvcHMuaD4KICNpbmNsdWRlIDxsaW51eC9sb2NrZGVwLmg+CisjaW5jbHVkZSA8bGludXgvdHlw
ZXMuaD4KIAogI2luY2x1ZGUgImk5MTVfYWN0aXZlLmgiCiAjaW5jbHVkZSAiaW50ZWxfY29udGV4
dF90eXBlcy5oIgpAQCAtMTUzLDQgKzE1NSw0NCBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBpbnRl
bF9yaW5nICpfX2ludGVsX2NvbnRleHRfcmluZ19zaXplKHU2NCBzeikKIAlyZXR1cm4gdTY0X3Rv
X3B0cihzdHJ1Y3QgaW50ZWxfcmluZywgc3opOwogfQogCitzdGF0aWMgaW5saW5lIGJvb2wgaW50
ZWxfY29udGV4dF9pc19iYW5uZWQoY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQorewor
CXJldHVybiB0ZXN0X2JpdChDT05URVhUX0JBTk5FRCwgJmNlLT5mbGFncyk7Cit9CisKK3N0YXRp
YyBpbmxpbmUgYm9vbCBpbnRlbF9jb250ZXh0X3NldF9iYW5uZWQoc3RydWN0IGludGVsX2NvbnRl
eHQgKmNlKQoreworCXJldHVybiB0ZXN0X2FuZF9zZXRfYml0KENPTlRFWFRfQkFOTkVELCAmY2Ut
PmZsYWdzKTsKK30KKworc3RhdGljIGlubGluZSBib29sCitpbnRlbF9jb250ZXh0X2ZvcmNlX3Np
bmdsZV9zdWJtaXNzaW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwlyZXR1
cm4gdGVzdF9iaXQoQ09OVEVYVF9GT1JDRV9TSU5HTEVfU1VCTUlTU0lPTiwgJmNlLT5mbGFncyk7
Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZAoraW50ZWxfY29udGV4dF9zZXRfc2luZ2xlX3N1Ym1p
c3Npb24oc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQoreworCV9fc2V0X2JpdChDT05URVhUX0ZP
UkNFX1NJTkdMRV9TVUJNSVNTSU9OLCAmY2UtPmZsYWdzKTsKK30KKworc3RhdGljIGlubGluZSBi
b29sCitpbnRlbF9jb250ZXh0X25vcHJlZW1wdChjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UpCit7CisJcmV0dXJuIHRlc3RfYml0KENPTlRFWFRfTk9QUkVFTVBULCAmY2UtPmZsYWdzKTsK
K30KKworc3RhdGljIGlubGluZSB2b2lkCitpbnRlbF9jb250ZXh0X3NldF9ub3ByZWVtcHQoc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlKQoreworCXNldF9iaXQoQ09OVEVYVF9OT1BSRUVNUFQsICZj
ZS0+ZmxhZ3MpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQKK2ludGVsX2NvbnRleHRfY2xlYXJf
bm9wcmVlbXB0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKK3sKKwljbGVhcl9iaXQoQ09OVEVY
VF9OT1BSRUVNUFQsICZjZS0+ZmxhZ3MpOworfQorCiAjZW5kaWYgLyogX19JTlRFTF9DT05URVhU
X0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4
dF90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dF90eXBlcy5o
CmluZGV4IDY5NTliMDVhZTVmOC4uMDI1MWVkYzhmNTY4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9jb250ZXh0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfY29udGV4dF90eXBlcy5oCkBAIC01NCw3ICs1NCwxMCBAQCBzdHJ1Y3Qg
aW50ZWxfY29udGV4dCB7CiAJc3RydWN0IGludGVsX3RpbWVsaW5lICp0aW1lbGluZTsKIAogCXVu
c2lnbmVkIGxvbmcgZmxhZ3M7Ci0jZGVmaW5lIENPTlRFWFRfQUxMT0NfQklUIDAKKyNkZWZpbmUg
Q09OVEVYVF9BTExPQ19CSVQJCTAKKyNkZWZpbmUgQ09OVEVYVF9CQU5ORUQJCQkxCisjZGVmaW5l
IENPTlRFWFRfRk9SQ0VfU0lOR0xFX1NVQk1JU1NJT04JMgorI2RlZmluZSBDT05URVhUX05PUFJF
RU1QVAkJMwogCiAJdTMyICpscmNfcmVnX3N0YXRlOwogCXU2NCBscmNfZGVzYzsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMKaW5kZXggOWNjMWVhNjUxOWVjLi5mMTRm
ODc3NzE5YzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2lu
ZV9jcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCkBA
IC0xNTExLDkgKzE1MTEsOSBAQCB2b2lkIGludGVsX2VuZ2luZV9kdW1wKHN0cnVjdCBpbnRlbF9l
bmdpbmVfY3MgKmVuZ2luZSwKIAogCQlwcmludF9yZXF1ZXN0X3JpbmcobSwgcnEpOwogCi0JCWlm
IChycS0+aHdfY29udGV4dC0+bHJjX3JlZ19zdGF0ZSkgeworCQlpZiAocnEtPmNvbnRleHQtPmxy
Y19yZWdfc3RhdGUpIHsKIAkJCWRybV9wcmludGYobSwgIkxvZ2ljYWwgUmluZyBDb250ZXh0Olxu
Iik7Ci0JCQloZXhkdW1wKG0sIHJxLT5od19jb250ZXh0LT5scmNfcmVnX3N0YXRlLCBQQUdFX1NJ
WkUpOworCQkJaGV4ZHVtcChtLCBycS0+Y29udGV4dC0+bHJjX3JlZ19zdGF0ZSwgUEFHRV9TSVpF
KTsKIAkJfQogCX0KIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZlbmdpbmUtPmFjdGl2ZS5sb2Nr
LCBmbGFncyk7CkBAIC0xNTc0LDcgKzE1NzQsNyBAQCBpbnQgaW50ZWxfZW5hYmxlX2VuZ2luZV9z
dGF0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAKIAkJZm9yIChwb3J0ID0gZXhl
Y2xpc3RzLT5wZW5kaW5nOyAocnEgPSAqcG9ydCk7IHBvcnQrKykgewogCQkJLyogRXhjbHVkZSBh
bnkgY29udGV4dHMgYWxyZWFkeSBjb3VudGVkIGluIGFjdGl2ZSAqLwotCQkJaWYgKCFpbnRlbF9j
b250ZXh0X2luZmxpZ2h0X2NvdW50KHJxLT5od19jb250ZXh0KSkKKwkJCWlmICghaW50ZWxfY29u
dGV4dF9pbmZsaWdodF9jb3VudChycS0+Y29udGV4dCkpCiAJCQkJZW5naW5lLT5zdGF0cy5hY3Rp
dmUrKzsKIAkJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9s
cmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmluZGV4IDczZWFlODVh
MmNjOS4uOThkMjA2NDU5N2UxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9scmMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAt
MjUyLDcgKzI1Miw3IEBAIHN0YXRpYyB2b2lkIG1hcmtfZWlvKHN0cnVjdCBpOTE1X3JlcXVlc3Qg
KnJxKQogCiBzdGF0aWMgc3RydWN0IGk5MTVfcmVxdWVzdCAqYWN0aXZlX3JlcXVlc3Qoc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEpCiB7Ci0JY29uc3Qgc3RydWN0IGludGVsX2NvbnRleHQgKiBjb25z
dCBjZSA9IHJxLT5od19jb250ZXh0OworCWNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICogY29u
c3QgY2UgPSBycS0+Y29udGV4dDsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICphY3RpdmUgPSBOVUxM
OwogCXN0cnVjdCBsaXN0X2hlYWQgKmxpc3Q7CiAKQEAgLTI2NSw3ICsyNjUsNyBAQCBzdGF0aWMg
c3RydWN0IGk5MTVfcmVxdWVzdCAqYWN0aXZlX3JlcXVlc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnEpCiAJCWlmIChpOTE1X3JlcXVlc3RfY29tcGxldGVkKHJxKSkKIAkJCWJyZWFrOwogCi0JCWlm
IChycS0+aHdfY29udGV4dCAhPSBjZSkKKwkJaWYgKHJxLT5jb250ZXh0ICE9IGNlKQogCQkJYnJl
YWs7CiAKIAkJYWN0aXZlID0gcnE7CkBAIC04OTYsNyArODk2LDcgQEAgX191bndpbmRfaW5jb21w
bGV0ZV9yZXF1ZXN0cyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCQlsaXN0X21v
dmUoJnJxLT5zY2hlZC5saW5rLCBwbCk7CiAJCQlhY3RpdmUgPSBycTsKIAkJfSBlbHNlIHsKLQkJ
CXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKm93bmVyID0gcnEtPmh3X2NvbnRleHQtPmVuZ2luZTsK
KwkJCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKm93bmVyID0gcnEtPmNvbnRleHQtPmVuZ2luZTsK
IAogCQkJLyoKIAkJCSAqIERlY291cGxlIHRoZSB2aXJ0dWFsIGJyZWFkY3J1bWIgYmVmb3JlIG1v
dmluZyBpdApAQCAtOTQ4LDcgKzk0OCw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqCiBfX2V4ZWNsaXN0c19zY2hlZHVsZV9pbihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpy
cSkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICogY29uc3QgZW5naW5lID0gcnEtPmVuZ2lu
ZTsKLQlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqIGNvbnN0IGNlID0gcnEtPmh3X2NvbnRleHQ7CisJ
c3RydWN0IGludGVsX2NvbnRleHQgKiBjb25zdCBjZSA9IHJxLT5jb250ZXh0OwogCiAJaW50ZWxf
Y29udGV4dF9nZXQoY2UpOwogCkBAIC05NzQsNyArOTc0LDcgQEAgX19leGVjbGlzdHNfc2NoZWR1
bGVfaW4oc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1
X3JlcXVlc3QgKgogZXhlY2xpc3RzX3NjaGVkdWxlX2luKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
LCBpbnQgaWR4KQogewotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBycS0+aHdf
Y29udGV4dDsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqIGNvbnN0IGNlID0gcnEtPmNvbnRleHQ7
CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqb2xkOwogCiAJR0VNX0JVR19PTighaW50ZWxfZW5n
aW5lX3BtX2lzX2F3YWtlKHJxLT5lbmdpbmUpKTsKQEAgLTEwMTcsNyArMTAxNyw3IEBAIHN0YXRp
YyB2b2lkIHJlc3RvcmVfZGVmYXVsdF9zdGF0ZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsCiBz
dGF0aWMgdm9pZCByZXNldF9hY3RpdmUoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEsCiAJCQkgc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICog
Y29uc3QgY2UgPSBycS0+aHdfY29udGV4dDsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqIGNvbnN0
IGNlID0gcnEtPmNvbnRleHQ7CiAKIAkvKgogCSAqIFRoZSBleGVjdXRpbmcgY29udGV4dCBoYXMg
YmVlbiBjYW5jZWxsZWQuIFdlIHdhbnQgdG8gcHJldmVudApAQCAtMTA1NywxMyArMTA1NywxMyBA
QCBzdGF0aWMgaW5saW5lIHZvaWQKIF9fZXhlY2xpc3RzX3NjaGVkdWxlX291dChzdHJ1Y3QgaTkx
NV9yZXF1ZXN0ICpycSwKIAkJCSBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICogY29uc3QgZW5naW5l
KQogewotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBycS0+aHdfY29udGV4dDsK
KwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqIGNvbnN0IGNlID0gcnEtPmNvbnRleHQ7CiAKIAlpbnRl
bF9lbmdpbmVfY29udGV4dF9vdXQoZW5naW5lKTsKIAlleGVjbGlzdHNfY29udGV4dF9zdGF0dXNf
Y2hhbmdlKHJxLCBJTlRFTF9DT05URVhUX1NDSEVEVUxFX09VVCk7CiAJaW50ZWxfZ3RfcG1fcHV0
KGVuZ2luZS0+Z3QpOwogCi0JaWYgKHVubGlrZWx5KGk5MTVfZ2VtX2NvbnRleHRfaXNfYmFubmVk
KGNlLT5nZW1fY29udGV4dCkpKQorCWlmICh1bmxpa2VseShpbnRlbF9jb250ZXh0X2lzX2Jhbm5l
ZChjZSkpKQogCQlyZXNldF9hY3RpdmUocnEsIGVuZ2luZSk7CiAKIAkvKgpAQCAtMTA4NCw3ICsx
MDg0LDcgQEAgX19leGVjbGlzdHNfc2NoZWR1bGVfb3V0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
LAogc3RhdGljIGlubGluZSB2b2lkCiBleGVjbGlzdHNfc2NoZWR1bGVfb3V0KHN0cnVjdCBpOTE1
X3JlcXVlc3QgKnJxKQogewotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICogY29uc3QgY2UgPSBycS0+
aHdfY29udGV4dDsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqIGNvbnN0IGNlID0gcnEtPmNvbnRl
eHQ7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqY3VyLCAqb2xkOwogCiAJdHJhY2VfaTkxNV9y
ZXF1ZXN0X291dChycSk7CkBAIC0xMTAxLDcgKzExMDEsNyBAQCBleGVjbGlzdHNfc2NoZWR1bGVf
b3V0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCiBzdGF0aWMgdTY0IGV4ZWNsaXN0c191cGRh
dGVfY29udGV4dChjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIHsKLQlzdHJ1Y3QgaW50
ZWxfY29udGV4dCAqY2UgPSBycS0+aHdfY29udGV4dDsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAq
Y2UgPSBycS0+Y29udGV4dDsKIAl1NjQgZGVzYzsKIAogCWNlLT5scmNfcmVnX3N0YXRlW0NUWF9S
SU5HX1RBSUxdID0KQEAgLTExODgsMTMgKzExODgsMTMgQEAgYXNzZXJ0X3BlbmRpbmdfdmFsaWQo
Y29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9leGVjbGlzdHMgKmV4ZWNsaXN0cywKIAl9CiAKIAlm
b3IgKHBvcnQgPSBleGVjbGlzdHMtPnBlbmRpbmc7IChycSA9ICpwb3J0KTsgcG9ydCsrKSB7Ci0J
CWlmIChjZSA9PSBycS0+aHdfY29udGV4dCkgeworCQlpZiAoY2UgPT0gcnEtPmNvbnRleHQpIHsK
IAkJCUdFTV9UUkFDRV9FUlIoIkR1cGxpY2F0ZSBjb250ZXh0IGluIHBlbmRpbmdbJXpkXVxuIiwK
IAkJCQkgICAgICBwb3J0IC0gZXhlY2xpc3RzLT5wZW5kaW5nKTsKIAkJCXJldHVybiBmYWxzZTsK
IAkJfQogCi0JCWNlID0gcnEtPmh3X2NvbnRleHQ7CisJCWNlID0gcnEtPmNvbnRleHQ7CiAJCWlm
IChpOTE1X3JlcXVlc3RfY29tcGxldGVkKHJxKSkKIAkJCWNvbnRpbnVlOwogCkBAIC0xMjU5LDcg
KzEyNTksNyBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfc3VibWl0X3BvcnRzKHN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZSkKIHN0YXRpYyBib29sIGN0eF9zaW5nbGVfcG9ydF9zdWJtaXNz
aW9uKGNvbnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIHsKIAlyZXR1cm4gKElTX0VOQUJM
RUQoQ09ORklHX0RSTV9JOTE1X0dWVCkgJiYKLQkJaTkxNV9nZW1fY29udGV4dF9mb3JjZV9zaW5n
bGVfc3VibWlzc2lvbihjZS0+Z2VtX2NvbnRleHQpKTsKKwkJaW50ZWxfY29udGV4dF9mb3JjZV9z
aW5nbGVfc3VibWlzc2lvbihjZSkpOwogfQogCiBzdGF0aWMgYm9vbCBjYW5fbWVyZ2VfY3R4KGNv
bnN0IHN0cnVjdCBpbnRlbF9jb250ZXh0ICpwcmV2LApAQCAtMTI5NSw3ICsxMjk1LDcgQEAgc3Rh
dGljIGJvb2wgY2FuX21lcmdlX3JxKGNvbnN0IHN0cnVjdCBpOTE1X3JlcXVlc3QgKnByZXYsCiAJ
CSAgICAgKEk5MTVfUkVRVUVTVF9OT1BSRUVNUFQgfCBJOTE1X1JFUVVFU1RfU0VOVElORUwpKSkK
IAkJcmV0dXJuIGZhbHNlOwogCi0JaWYgKCFjYW5fbWVyZ2VfY3R4KHByZXYtPmh3X2NvbnRleHQs
IG5leHQtPmh3X2NvbnRleHQpKQorCWlmICghY2FuX21lcmdlX2N0eChwcmV2LT5jb250ZXh0LCBu
ZXh0LT5jb250ZXh0KSkKIAkJcmV0dXJuIGZhbHNlOwogCiAJcmV0dXJuIHRydWU7CkBAIC0xNDY1
LDcgKzE0NjUsNyBAQCBzdGF0aWMgdW5zaWduZWQgbG9uZyBhY3RpdmVfcHJlZW1wdF90aW1lb3V0
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJcmV0dXJuIDA7CiAKIAkvKiBGb3Jj
ZSBhIGZhc3QgcmVzZXQgZm9yIHRlcm1pbmF0ZWQgY29udGV4dHMgKGlnbm9yaW5nIHN5c2ZzISkg
Ki8KLQlpZiAodW5saWtlbHkoaTkxNV9nZW1fY29udGV4dF9pc19iYW5uZWQocnEtPmdlbV9jb250
ZXh0KSkpCisJaWYgKHVubGlrZWx5KGludGVsX2NvbnRleHRfaXNfYmFubmVkKHJxLT5jb250ZXh0
KSkpCiAJCXJldHVybiAxOwogCiAJcmV0dXJuIFJFQURfT05DRShlbmdpbmUtPnByb3BzLnByZWVt
cHRfdGltZW91dF9tcyk7CkBAIC0xNTczLDcgKzE1NzMsNyBAQCBzdGF0aWMgdm9pZCBleGVjbGlz
dHNfZGVxdWV1ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCQkgKiB0ZW5kZW5j
eSB0byBpZ25vcmUgdXMgcmV3aW5kaW5nIHRoZSBUQUlMIHRvIHRoZQogCQkJICogZW5kIG9mIGFu
IGVhcmxpZXIgcmVxdWVzdC4KIAkJCSAqLwotCQkJbGFzdC0+aHdfY29udGV4dC0+bHJjX2Rlc2Mg
fD0gQ1RYX0RFU0NfRk9SQ0VfUkVTVE9SRTsKKwkJCWxhc3QtPmNvbnRleHQtPmxyY19kZXNjIHw9
IENUWF9ERVNDX0ZPUkNFX1JFU1RPUkU7CiAJCQlsYXN0ID0gTlVMTDsKIAkJfSBlbHNlIGlmIChu
ZWVkX3RpbWVzbGljZShlbmdpbmUsIGxhc3QpICYmCiAJCQkgICB0aW1lcl9leHBpcmVkKCZlbmdp
bmUtPmV4ZWNsaXN0cy50aW1lcikpIHsKQEAgLTE2NTQsNyArMTY1NCw3IEBAIHN0YXRpYyB2b2lk
IGV4ZWNsaXN0c19kZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAogCQlH
RU1fQlVHX09OKHJxICE9IHZlLT5yZXF1ZXN0KTsKIAkJR0VNX0JVR19PTihycS0+ZW5naW5lICE9
ICZ2ZS0+YmFzZSk7Ci0JCUdFTV9CVUdfT04ocnEtPmh3X2NvbnRleHQgIT0gJnZlLT5jb250ZXh0
KTsKKwkJR0VNX0JVR19PTihycS0+Y29udGV4dCAhPSAmdmUtPmNvbnRleHQpOwogCiAJCWlmIChy
cV9wcmlvKHJxKSA+PSBxdWV1ZV9wcmlvKGV4ZWNsaXN0cykpIHsKIAkJCWlmICghdmlydHVhbF9t
YXRjaGVzKHZlLCBycSwgZW5naW5lKSkgewpAQCAtMTc3Myw3ICsxNzczLDcgQEAgc3RhdGljIHZv
aWQgZXhlY2xpc3RzX2RlcXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkJ
CSAqIHNhbWUgTFJDQSwgaS5lLiB3ZSBtdXN0IHN1Ym1pdCAyIGRpZmZlcmVudAogCQkJCSAqIGNv
bnRleHRzIGlmIHdlIHN1Ym1pdCAyIEVMU1AuCiAJCQkJICovCi0JCQkJaWYgKGxhc3QtPmh3X2Nv
bnRleHQgPT0gcnEtPmh3X2NvbnRleHQpCisJCQkJaWYgKGxhc3QtPmNvbnRleHQgPT0gcnEtPmNv
bnRleHQpCiAJCQkJCWdvdG8gZG9uZTsKIAogCQkJCWlmIChpOTE1X3JlcXVlc3RfaGFzX3NlbnRp
bmVsKGxhc3QpKQpAQCAtMTc4Niw4ICsxNzg2LDggQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2Rl
cXVldWUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCQkJCSAqIHRoZSBzYW1lIGNv
bnRleHQgKGV2ZW4gdGhvdWdoIGEgZGlmZmVyZW50CiAJCQkJICogcmVxdWVzdCkgdG8gdGhlIHNl
Y29uZCBwb3J0LgogCQkJCSAqLwotCQkJCWlmIChjdHhfc2luZ2xlX3BvcnRfc3VibWlzc2lvbihs
YXN0LT5od19jb250ZXh0KSB8fAotCQkJCSAgICBjdHhfc2luZ2xlX3BvcnRfc3VibWlzc2lvbihy
cS0+aHdfY29udGV4dCkpCisJCQkJaWYgKGN0eF9zaW5nbGVfcG9ydF9zdWJtaXNzaW9uKGxhc3Qt
PmNvbnRleHQpIHx8CisJCQkJICAgIGN0eF9zaW5nbGVfcG9ydF9zdWJtaXNzaW9uKHJxLT5jb250
ZXh0KSkKIAkJCQkJZ290byBkb25lOwogCiAJCQkJbWVyZ2UgPSBmYWxzZTsKQEAgLTE4MDEsOCAr
MTgwMSw4IEBAIHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19kZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSkKIAkJCQl9CiAKIAkJCQlHRU1fQlVHX09OKGxhc3QgJiYKLQkJCQkJICAg
IWNhbl9tZXJnZV9jdHgobGFzdC0+aHdfY29udGV4dCwKLQkJCQkJCQkgIHJxLT5od19jb250ZXh0
KSk7CisJCQkJCSAgICFjYW5fbWVyZ2VfY3R4KGxhc3QtPmNvbnRleHQsCisJCQkJCQkJICBycS0+
Y29udGV4dCkpOwogCiAJCQkJc3VibWl0ID0gdHJ1ZTsKIAkJCQlsYXN0ID0gcnE7CkBAIC0yNDIx
LDcgKzI0MjEsNyBAQCBzdGF0aWMgaW50IGV4ZWNsaXN0c19yZXF1ZXN0X2FsbG9jKHN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJlcXVlc3QpCiB7CiAJaW50IHJldDsKIAotCUdFTV9CVUdfT04oIWludGVs
X2NvbnRleHRfaXNfcGlubmVkKHJlcXVlc3QtPmh3X2NvbnRleHQpKTsKKwlHRU1fQlVHX09OKCFp
bnRlbF9jb250ZXh0X2lzX3Bpbm5lZChyZXF1ZXN0LT5jb250ZXh0KSk7CiAKIAkvKgogCSAqIEZs
dXNoIGVub3VnaCBzcGFjZSB0byByZWR1Y2UgdGhlIGxpa2VsaWhvb2Qgb2Ygd2FpdGluZyBhZnRl
cgpAQCAtMjkxOCw3ICsyOTE4LDcgQEAgc3RhdGljIHZvaWQgX19leGVjbGlzdHNfcmVzZXQoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCBib29sIHN0YWxsZWQpCiAJLyogV2Ugc3RpbGwg
aGF2ZSByZXF1ZXN0cyBpbi1mbGlnaHQ7IHRoZSBlbmdpbmUgc2hvdWxkIGJlIGFjdGl2ZSAqLwog
CUdFTV9CVUdfT04oIWludGVsX2VuZ2luZV9wbV9pc19hd2FrZShlbmdpbmUpKTsKIAotCWNlID0g
cnEtPmh3X2NvbnRleHQ7CisJY2UgPSBycS0+Y29udGV4dDsKIAlHRU1fQlVHX09OKCFpOTE1X3Zt
YV9pc19waW5uZWQoY2UtPnN0YXRlKSk7CiAKIAlycSA9IGFjdGl2ZV9yZXF1ZXN0KHJxKTsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCmluZGV4IGYwM2UwMDAwNTFjMS4uYjRjMGFk
NGE2MDgxIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKQEAgLTQwLDI3ICs0
MCwzMSBAQCBzdGF0aWMgdm9pZCBybXdfY2xlYXJfZncoc3RydWN0IGludGVsX3VuY29yZSAqdW5j
b3JlLCBpOTE1X3JlZ190IHJlZywgdTMyIGNscikKIHN0YXRpYyB2b2lkIGVuZ2luZV9za2lwX2Nv
bnRleHQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lID0gcnEtPmVuZ2luZTsKLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqaHVuZ19j
dHggPSBycS0+Z2VtX2NvbnRleHQ7CisJc3RydWN0IGludGVsX2NvbnRleHQgKmh1bmdfY3R4ID0g
cnEtPmNvbnRleHQ7CiAKIAlpZiAoIWk5MTVfcmVxdWVzdF9pc19hY3RpdmUocnEpKQotCQlyZXR1
cm47CisJCXJxID0gbGlzdF9maXJzdF9lbnRyeSgmZW5naW5lLT5hY3RpdmUucmVxdWVzdHMsCisJ
CQkJICAgICAgdHlwZW9mKCpycSksIHNjaGVkLmxpbmspOwogCiAJbG9ja2RlcF9hc3NlcnRfaGVs
ZCgmZW5naW5lLT5hY3RpdmUubG9jayk7CiAJbGlzdF9mb3JfZWFjaF9lbnRyeV9jb250aW51ZShy
cSwgJmVuZ2luZS0+YWN0aXZlLnJlcXVlc3RzLCBzY2hlZC5saW5rKQotCQlpZiAocnEtPmdlbV9j
b250ZXh0ID09IGh1bmdfY3R4KQorCQlpZiAocnEtPmNvbnRleHQgPT0gaHVuZ19jdHgpCiAJCQlp
OTE1X3JlcXVlc3Rfc2tpcChycSwgLUVJTyk7CiB9CiAKLXN0YXRpYyB2b2lkIGNsaWVudF9tYXJr
X2d1aWx0eShzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYsCi0JCQkgICAg
ICAgY29uc3Qgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKK3N0YXRpYyB2b2lkIGNsaWVu
dF9tYXJrX2d1aWx0eShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgYm9vbCBiYW5uZWQpCiB7Ci0J
dW5zaWduZWQgaW50IHNjb3JlOworCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBycS0+
Y29udGV4dC0+Z2VtX2NvbnRleHQ7CisJc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZmls
ZV9wcml2ID0gY3R4LT5maWxlX3ByaXY7CiAJdW5zaWduZWQgbG9uZyBwcmV2X2hhbmc7CisJdW5z
aWduZWQgaW50IHNjb3JlOwogCi0JaWYgKGk5MTVfZ2VtX2NvbnRleHRfaXNfYmFubmVkKGN0eCkp
CisJaWYgKElTX0VSUl9PUl9OVUxMKGZpbGVfcHJpdikpCisJCXJldHVybjsKKworCXNjb3JlID0g
MDsKKwlpZiAoYmFubmVkKQogCQlzY29yZSA9IEk5MTVfQ0xJRU5UX1NDT1JFX0NPTlRFWFRfQkFO
OwotCWVsc2UKLQkJc2NvcmUgPSAwOwogCiAJcHJldl9oYW5nID0geGNoZygmZmlsZV9wcml2LT5o
YW5nX3RpbWVzdGFtcCwgamlmZmllcyk7CiAJaWYgKHRpbWVfYmVmb3JlKGppZmZpZXMsIHByZXZf
aGFuZyArIEk5MTVfQ0xJRU5UX0ZBU1RfSEFOR19KSUZGSUVTKSkKQEAgLTc1LDggKzc5LDkgQEAg
c3RhdGljIHZvaWQgY2xpZW50X21hcmtfZ3VpbHR5KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZh
dGUgKmZpbGVfcHJpdiwKIAl9CiB9CiAKLXN0YXRpYyBib29sIGNvbnRleHRfbWFya19ndWlsdHko
c3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKK3N0YXRpYyBib29sIG1hcmtfZ3VpbHR5KHN0
cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogeworCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgg
PSBycS0+Y29udGV4dC0+Z2VtX2NvbnRleHQ7CiAJdW5zaWduZWQgbG9uZyBwcmV2X2hhbmc7CiAJ
Ym9vbCBiYW5uZWQ7CiAJaW50IGk7CkBAIC0xMDAsMTggKzEwNSwxNyBAQCBzdGF0aWMgYm9vbCBj
b250ZXh0X21hcmtfZ3VpbHR5KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCiAJaWYgKGJh
bm5lZCkgewogCQlEUk1fREVCVUdfRFJJVkVSKCJjb250ZXh0ICVzOiBndWlsdHkgJWQsIGJhbm5l
ZFxuIiwKIAkJCQkgY3R4LT5uYW1lLCBhdG9taWNfcmVhZCgmY3R4LT5ndWlsdHlfY291bnQpKTsK
LQkJaTkxNV9nZW1fY29udGV4dF9zZXRfYmFubmVkKGN0eCk7CisJCWludGVsX2NvbnRleHRfc2V0
X2Jhbm5lZChycS0+Y29udGV4dCk7CiAJfQogCi0JaWYgKCFJU19FUlJfT1JfTlVMTChjdHgtPmZp
bGVfcHJpdikpCi0JCWNsaWVudF9tYXJrX2d1aWx0eShjdHgtPmZpbGVfcHJpdiwgY3R4KTsKKwlj
bGllbnRfbWFya19ndWlsdHkocnEsIGJhbm5lZCk7CiAKIAlyZXR1cm4gYmFubmVkOwogfQogCi1z
dGF0aWMgdm9pZCBjb250ZXh0X21hcmtfaW5ub2NlbnQoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQg
KmN0eCkKK3N0YXRpYyB2b2lkIG1hcmtfaW5ub2NlbnQoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEp
CiB7Ci0JYXRvbWljX2luYygmY3R4LT5hY3RpdmVfY291bnQpOworCWF0b21pY19pbmMoJnJxLT5j
b250ZXh0LT5nZW1fY29udGV4dC0+YWN0aXZlX2NvdW50KTsKIH0KIAogdm9pZCBfX2k5MTVfcmVx
dWVzdF9yZXNldChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgYm9vbCBndWlsdHkpCkBAIC0xMjYs
MTEgKzEzMCwxMSBAQCB2b2lkIF9faTkxNV9yZXF1ZXN0X3Jlc2V0KHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxLCBib29sIGd1aWx0eSkKIAogCWlmIChndWlsdHkpIHsKIAkJaTkxNV9yZXF1ZXN0X3Nr
aXAocnEsIC1FSU8pOwotCQlpZiAoY29udGV4dF9tYXJrX2d1aWx0eShycS0+Z2VtX2NvbnRleHQp
KQorCQlpZiAobWFya19ndWlsdHkocnEpKQogCQkJZW5naW5lX3NraXBfY29udGV4dChycSk7CiAJ
fSBlbHNlIHsKIAkJZG1hX2ZlbmNlX3NldF9lcnJvcigmcnEtPmZlbmNlLCAtRUFHQUlOKTsKLQkJ
Y29udGV4dF9tYXJrX2lubm9jZW50KHJxLT5nZW1fY29udGV4dCk7CisJCW1hcmtfaW5ub2NlbnQo
cnEpOwogCX0KIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
cmluZ19zdWJtaXNzaW9uLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nX3N1
Ym1pc3Npb24uYwppbmRleCBhNDdkNWE3YzMyYzkuLjFjMmYzYzNhODg0MCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ19zdWJtaXNzaW9uLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ19zdWJtaXNzaW9uLmMKQEAgLTE0ODUsNyAr
MTQ4NSw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IG1pX3NldF9jb250ZXh0KHN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxLCB1MzIgZmxhZ3MpCiAKIAkqY3MrKyA9IE1JX05PT1A7CiAJKmNzKysgPSBNSV9T
RVRfQ09OVEVYVDsKLQkqY3MrKyA9IGk5MTVfZ2d0dF9vZmZzZXQocnEtPmh3X2NvbnRleHQtPnN0
YXRlKSB8IGZsYWdzOworCSpjcysrID0gaTkxNV9nZ3R0X29mZnNldChycS0+Y29udGV4dC0+c3Rh
dGUpIHwgZmxhZ3M7CiAJLyoKIAkgKiB3L2E6IE1JX1NFVF9DT05URVhUIG11c3QgYWx3YXlzIGJl
IGZvbGxvd2VkIGJ5IE1JX05PT1AKIAkgKiBXYU1pU2V0Q29udGV4dF9IYW5nOnNuYixpdmIsdmx2
CkBAIC0xNTU1LDcgKzE1NTUsNyBAQCBzdGF0aWMgaW50IHJlbWFwX2wzX3NsaWNlKHN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxLCBpbnQgc2xpY2UpCiAKIHN0YXRpYyBpbnQgcmVtYXBfbDMoc3RydWN0
IGk5MTVfcmVxdWVzdCAqcnEpCiB7Ci0Jc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9IHJx
LT5nZW1fY29udGV4dDsKKwlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gcnEtPmNvbnRl
eHQtPmdlbV9jb250ZXh0OwogCWludCBpLCBlcnI7CiAKIAlpZiAoIWN0eC0+cmVtYXBfc2xpY2Up
CkBAIC0xNTc2LDcgKzE1NzYsNyBAQCBzdGF0aWMgaW50IHJlbWFwX2wzKHN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxKQogCiBzdGF0aWMgaW50IHN3aXRjaF9jb250ZXh0KHN0cnVjdCBpOTE1X3JlcXVl
c3QgKnJxKQogewotCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSA9IHJxLT5od19jb250ZXh0Owor
CXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSA9IHJxLT5jb250ZXh0OwogCXN0cnVjdCBpOTE1X2Fk
ZHJlc3Nfc3BhY2UgKnZtID0gdm1fYWxpYXMoY2UpOwogCWludCByZXQ7CiAKQEAgLTE2MDEsNyAr
MTYwMSw3IEBAIHN0YXRpYyBpbnQgc3dpdGNoX2NvbnRleHQoc3RydWN0IGk5MTVfcmVxdWVzdCAq
cnEpCiAJCSAqIGlzIHB1cmVseSB1c2VkIGZvciBmbHVzaGluZyB1c2VyIGNvbnRleHRzLgogCQkg
Ki8KIAkJaHdfZmxhZ3MgPSAwOwotCQlpZiAoaTkxNV9nZW1fY29udGV4dF9pc19rZXJuZWwocnEt
PmdlbV9jb250ZXh0KSkKKwkJaWYgKGk5MTVfZ2VtX2NvbnRleHRfaXNfa2VybmVsKHJxLT5jb250
ZXh0LT5nZW1fY29udGV4dCkpCiAJCQlod19mbGFncyA9IE1JX1JFU1RPUkVfSU5ISUJJVDsKIAog
CQlyZXQgPSBtaV9zZXRfY29udGV4dChycSwgaHdfZmxhZ3MpOwpAQCAtMTY0OCw3ICsxNjQ4LDcg
QEAgc3RhdGljIGludCByaW5nX3JlcXVlc3RfYWxsb2Moc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVx
dWVzdCkKIHsKIAlpbnQgcmV0OwogCi0JR0VNX0JVR19PTighaW50ZWxfY29udGV4dF9pc19waW5u
ZWQocmVxdWVzdC0+aHdfY29udGV4dCkpOworCUdFTV9CVUdfT04oIWludGVsX2NvbnRleHRfaXNf
cGlubmVkKHJlcXVlc3QtPmNvbnRleHQpKTsKIAlHRU1fQlVHX09OKGk5MTVfcmVxdWVzdF90aW1l
bGluZShyZXF1ZXN0KS0+aGFzX2luaXRpYWxfYnJlYWRjcnVtYik7CiAKIAkvKgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwppbmRleCBkNWQyNjhiZTU1NGUuLjQ4OTFmMDI0NGY2
OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKQEAgLTExNzgsMTMgKzEx
NzgsMTMgQEAgc3RhdGljIGludCBfX2NhbmNlbF9hY3RpdmUwKHN0cnVjdCBsaXZlX3ByZWVtcHRf
Y2FuY2VsICphcmcpCiAJCQkJX19mdW5jX18sIGFyZy0+ZW5naW5lLT5uYW1lKSkKIAkJcmV0dXJu
IC1FSU87CiAKLQljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZhcmctPmEuY3R4LT5mbGFncyk7
CiAJcnEgPSBzcGlubmVyX2NyZWF0ZV9yZXF1ZXN0KCZhcmctPmEuc3BpbiwKIAkJCQkgICAgYXJn
LT5hLmN0eCwgYXJnLT5lbmdpbmUsCiAJCQkJICAgIE1JX0FSQl9DSEVDSyk7CiAJaWYgKElTX0VS
UihycSkpCiAJCXJldHVybiBQVFJfRVJSKHJxKTsKIAorCWNsZWFyX2JpdChDT05URVhUX0JBTk5F
RCwgJnJxLT5jb250ZXh0LT5mbGFncyk7CiAJaTkxNV9yZXF1ZXN0X2dldChycSk7CiAJaTkxNV9y
ZXF1ZXN0X2FkZChycSk7CiAJaWYgKCFpZ3Rfd2FpdF9mb3Jfc3Bpbm5lcigmYXJnLT5hLnNwaW4s
IHJxKSkgewpAQCAtMTE5Miw3ICsxMTkyLDcgQEAgc3RhdGljIGludCBfX2NhbmNlbF9hY3RpdmUw
KHN0cnVjdCBsaXZlX3ByZWVtcHRfY2FuY2VsICphcmcpCiAJCWdvdG8gb3V0OwogCX0KIAotCWk5
MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5lZChhcmctPmEuY3R4KTsKKwlpbnRlbF9jb250ZXh0X3Nl
dF9iYW5uZWQocnEtPmNvbnRleHQpOwogCWVyciA9IGludGVsX2VuZ2luZV9wdWxzZShhcmctPmVu
Z2luZSk7CiAJaWYgKGVycikKIAkJZ290byBvdXQ7CkBAIC0xMjI3LDEzICsxMjI3LDEzIEBAIHN0
YXRpYyBpbnQgX19jYW5jZWxfYWN0aXZlMShzdHJ1Y3QgbGl2ZV9wcmVlbXB0X2NhbmNlbCAqYXJn
KQogCQkJCV9fZnVuY19fLCBhcmctPmVuZ2luZS0+bmFtZSkpCiAJCXJldHVybiAtRUlPOwogCi0J
Y2xlYXJfYml0KENPTlRFWFRfQkFOTkVELCAmYXJnLT5hLmN0eC0+ZmxhZ3MpOwogCXJxWzBdID0g
c3Bpbm5lcl9jcmVhdGVfcmVxdWVzdCgmYXJnLT5hLnNwaW4sCiAJCQkJICAgICAgIGFyZy0+YS5j
dHgsIGFyZy0+ZW5naW5lLAogCQkJCSAgICAgICBNSV9OT09QKTsgLyogbm8gcHJlZW1wdGlvbiAq
LwogCWlmIChJU19FUlIocnFbMF0pKQogCQlyZXR1cm4gUFRSX0VSUihycVswXSk7CiAKKwljbGVh
cl9iaXQoQ09OVEVYVF9CQU5ORUQsICZycVswXS0+Y29udGV4dC0+ZmxhZ3MpOwogCWk5MTVfcmVx
dWVzdF9nZXQocnFbMF0pOwogCWk5MTVfcmVxdWVzdF9hZGQocnFbMF0pOwogCWlmICghaWd0X3dh
aXRfZm9yX3NwaW5uZXIoJmFyZy0+YS5zcGluLCBycVswXSkpIHsKQEAgLTEyNDEsNyArMTI0MSw2
IEBAIHN0YXRpYyBpbnQgX19jYW5jZWxfYWN0aXZlMShzdHJ1Y3QgbGl2ZV9wcmVlbXB0X2NhbmNl
bCAqYXJnKQogCQlnb3RvIG91dDsKIAl9CiAKLQljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZh
cmctPmIuY3R4LT5mbGFncyk7CiAJcnFbMV0gPSBzcGlubmVyX2NyZWF0ZV9yZXF1ZXN0KCZhcmct
PmIuc3BpbiwKIAkJCQkgICAgICAgYXJnLT5iLmN0eCwgYXJnLT5lbmdpbmUsCiAJCQkJICAgICAg
IE1JX0FSQl9DSEVDSyk7CkBAIC0xMjUwLDEzICsxMjQ5LDE0IEBAIHN0YXRpYyBpbnQgX19jYW5j
ZWxfYWN0aXZlMShzdHJ1Y3QgbGl2ZV9wcmVlbXB0X2NhbmNlbCAqYXJnKQogCQlnb3RvIG91dDsK
IAl9CiAKKwljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZycVsxXS0+Y29udGV4dC0+ZmxhZ3Mp
OwogCWk5MTVfcmVxdWVzdF9nZXQocnFbMV0pOwogCWVyciA9IGk5MTVfcmVxdWVzdF9hd2FpdF9k
bWFfZmVuY2UocnFbMV0sICZycVswXS0+ZmVuY2UpOwogCWk5MTVfcmVxdWVzdF9hZGQocnFbMV0p
OwogCWlmIChlcnIpCiAJCWdvdG8gb3V0OwogCi0JaTkxNV9nZW1fY29udGV4dF9zZXRfYmFubmVk
KGFyZy0+Yi5jdHgpOworCWludGVsX2NvbnRleHRfc2V0X2Jhbm5lZChycVsxXS0+Y29udGV4dCk7
CiAJZXJyID0gaW50ZWxfZW5naW5lX3B1bHNlKGFyZy0+ZW5naW5lKTsKIAlpZiAoZXJyKQogCQln
b3RvIG91dDsKQEAgLTEyOTksMTMgKzEyOTksMTMgQEAgc3RhdGljIGludCBfX2NhbmNlbF9xdWV1
ZWQoc3RydWN0IGxpdmVfcHJlZW1wdF9jYW5jZWwgKmFyZykKIAkJCQlfX2Z1bmNfXywgYXJnLT5l
bmdpbmUtPm5hbWUpKQogCQlyZXR1cm4gLUVJTzsKIAotCWNsZWFyX2JpdChDT05URVhUX0JBTk5F
RCwgJmFyZy0+YS5jdHgtPmZsYWdzKTsKIAlycVswXSA9IHNwaW5uZXJfY3JlYXRlX3JlcXVlc3Qo
JmFyZy0+YS5zcGluLAogCQkJCSAgICAgICBhcmctPmEuY3R4LCBhcmctPmVuZ2luZSwKIAkJCQkg
ICAgICAgTUlfQVJCX0NIRUNLKTsKIAlpZiAoSVNfRVJSKHJxWzBdKSkKIAkJcmV0dXJuIFBUUl9F
UlIocnFbMF0pOwogCisJY2xlYXJfYml0KENPTlRFWFRfQkFOTkVELCAmcnFbMF0tPmNvbnRleHQt
PmZsYWdzKTsKIAlpOTE1X3JlcXVlc3RfZ2V0KHJxWzBdKTsKIAlpOTE1X3JlcXVlc3RfYWRkKHJx
WzBdKTsKIAlpZiAoIWlndF93YWl0X2Zvcl9zcGlubmVyKCZhcmctPmEuc3BpbiwgcnFbMF0pKSB7
CkBAIC0xMzEzLDEzICsxMzEzLDEzIEBAIHN0YXRpYyBpbnQgX19jYW5jZWxfcXVldWVkKHN0cnVj
dCBsaXZlX3ByZWVtcHRfY2FuY2VsICphcmcpCiAJCWdvdG8gb3V0OwogCX0KIAotCWNsZWFyX2Jp
dChDT05URVhUX0JBTk5FRCwgJmFyZy0+Yi5jdHgtPmZsYWdzKTsKIAlycVsxXSA9IGlndF9yZXF1
ZXN0X2FsbG9jKGFyZy0+Yi5jdHgsIGFyZy0+ZW5naW5lKTsKIAlpZiAoSVNfRVJSKHJxWzFdKSkg
ewogCQllcnIgPSBQVFJfRVJSKHJxWzFdKTsKIAkJZ290byBvdXQ7CiAJfQogCisJY2xlYXJfYml0
KENPTlRFWFRfQkFOTkVELCAmcnFbMV0tPmNvbnRleHQtPmZsYWdzKTsKIAlpOTE1X3JlcXVlc3Rf
Z2V0KHJxWzFdKTsKIAllcnIgPSBpOTE1X3JlcXVlc3RfYXdhaXRfZG1hX2ZlbmNlKHJxWzFdLCAm
cnFbMF0tPmZlbmNlKTsKIAlpOTE1X3JlcXVlc3RfYWRkKHJxWzFdKTsKQEAgLTEzNDAsNyArMTM0
MCw3IEBAIHN0YXRpYyBpbnQgX19jYW5jZWxfcXVldWVkKHN0cnVjdCBsaXZlX3ByZWVtcHRfY2Fu
Y2VsICphcmcpCiAJaWYgKGVycikKIAkJZ290byBvdXQ7CiAKLQlpOTE1X2dlbV9jb250ZXh0X3Nl
dF9iYW5uZWQoYXJnLT5hLmN0eCk7CisJaW50ZWxfY29udGV4dF9zZXRfYmFubmVkKHJxWzJdLT5j
b250ZXh0KTsKIAllcnIgPSBpbnRlbF9lbmdpbmVfcHVsc2UoYXJnLT5lbmdpbmUpOwogCWlmIChl
cnIpCiAJCWdvdG8gb3V0OwpAQCAtMTM4NywxMyArMTM4NywxMyBAQCBzdGF0aWMgaW50IF9fY2Fu
Y2VsX2hvc3RpbGUoc3RydWN0IGxpdmVfcHJlZW1wdF9jYW5jZWwgKmFyZykKIAkJcmV0dXJuIDA7
CiAKIAlHRU1fVFJBQ0UoIiVzKCVzKVxuIiwgX19mdW5jX18sIGFyZy0+ZW5naW5lLT5uYW1lKTsK
LQljbGVhcl9iaXQoQ09OVEVYVF9CQU5ORUQsICZhcmctPmEuY3R4LT5mbGFncyk7CiAJcnEgPSBz
cGlubmVyX2NyZWF0ZV9yZXF1ZXN0KCZhcmctPmEuc3BpbiwKIAkJCQkgICAgYXJnLT5hLmN0eCwg
YXJnLT5lbmdpbmUsCiAJCQkJICAgIE1JX05PT1ApOyAvKiBwcmVlbXB0aW9uIGRpc2FibGVkICov
CiAJaWYgKElTX0VSUihycSkpCiAJCXJldHVybiBQVFJfRVJSKHJxKTsKIAorCWNsZWFyX2JpdChD
T05URVhUX0JBTk5FRCwgJnJxLT5jb250ZXh0LT5mbGFncyk7CiAJaTkxNV9yZXF1ZXN0X2dldChy
cSk7CiAJaTkxNV9yZXF1ZXN0X2FkZChycSk7CiAJaWYgKCFpZ3Rfd2FpdF9mb3Jfc3Bpbm5lcigm
YXJnLT5hLnNwaW4sIHJxKSkgewpAQCAtMTQwMSw3ICsxNDAxLDcgQEAgc3RhdGljIGludCBfX2Nh
bmNlbF9ob3N0aWxlKHN0cnVjdCBsaXZlX3ByZWVtcHRfY2FuY2VsICphcmcpCiAJCWdvdG8gb3V0
OwogCX0KIAotCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Jhbm5lZChhcmctPmEuY3R4KTsKKwlpbnRl
bF9jb250ZXh0X3NldF9iYW5uZWQocnEtPmNvbnRleHQpOwogCWVyciA9IGludGVsX2VuZ2luZV9w
dWxzZShhcmctPmVuZ2luZSk7IC8qIGZvcmNlIHJlc2V0ICovCiAJaWYgKGVycikKIAkJZ290byBv
dXQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3Vi
bWlzc2lvbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Np
b24uYwppbmRleCAxYjE2OTFhYWVkMjguLjJiMzkxNjQzODFkZCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX3N1Ym1pc3Npb24uYworKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfc3VibWlzc2lvbi5jCkBAIC00NzEsNyArNDcx
LDcgQEAgc3RhdGljIHZvaWQgZ3VjX2FkZF9yZXF1ZXN0KHN0cnVjdCBpbnRlbF9ndWMgKmd1Yywg
c3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiB7CiAJc3RydWN0IGludGVsX2d1Y19jbGllbnQgKmNs
aWVudCA9IGd1Yy0+ZXhlY2J1Zl9jbGllbnQ7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lID0gcnEtPmVuZ2luZTsKLQl1MzIgY3R4X2Rlc2MgPSBsb3dlcl8zMl9iaXRzKHJxLT5od19j
b250ZXh0LT5scmNfZGVzYyk7CisJdTMyIGN0eF9kZXNjID0gbG93ZXJfMzJfYml0cyhycS0+Y29u
dGV4dC0+bHJjX2Rlc2MpOwogCXUzMiByaW5nX3RhaWwgPSBpbnRlbF9yaW5nX3NldF90YWlsKHJx
LT5yaW5nLCBycS0+dGFpbCkgLyBzaXplb2YodTY0KTsKIAogCWd1Y193cV9pdGVtX2FwcGVuZChj
bGllbnQsIGVuZ2luZS0+Z3VjX2lkLCBjdHhfZGVzYywKQEAgLTU3Miw3ICs1NzIsNyBAQCBzdGF0
aWMgdm9pZCBfX2d1Y19kZXF1ZXVlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAkJ
aW50IGk7CiAKIAkJcHJpb2xpc3RfZm9yX2VhY2hfcmVxdWVzdF9jb25zdW1lKHJxLCBybiwgcCwg
aSkgewotCQkJaWYgKGxhc3QgJiYgcnEtPmh3X2NvbnRleHQgIT0gbGFzdC0+aHdfY29udGV4dCkg
eworCQkJaWYgKGxhc3QgJiYgcnEtPmNvbnRleHQgIT0gbGFzdC0+Y29udGV4dCkgewogCQkJCWlm
IChwb3J0ID09IGxhc3RfcG9ydCkKIAkJCQkJZ290byBkb25lOwogCkBAIC02NzcsNyArNjc3LDcg
QEAgc3RhdGljIHZvaWQgZ3VjX3Jlc2V0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwg
Ym9vbCBzdGFsbGVkKQogCQlzdGFsbGVkID0gZmFsc2U7CiAKIAlfX2k5MTVfcmVxdWVzdF9yZXNl
dChycSwgc3RhbGxlZCk7Ci0JaW50ZWxfbHJfY29udGV4dF9yZXNldChlbmdpbmUsIHJxLT5od19j
b250ZXh0LCBycS0+aGVhZCwgc3RhbGxlZCk7CisJaW50ZWxfbHJfY29udGV4dF9yZXNldChlbmdp
bmUsIHJxLT5jb250ZXh0LCBycS0+aGVhZCwgc3RhbGxlZCk7CiAKIG91dF91bmxvY2s6CiAJc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmZW5naW5lLT5hY3RpdmUubG9jaywgZmxhZ3MpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCmluZGV4IDM3NzgxMWY4ODUzZi4uOTc2ZDY5NTAyMThl
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCkBAIC01OSw3ICs1OSw3IEBAIHN0
YXRpYyB2b2lkIHNldF9jb250ZXh0X3BkcF9yb290X3BvaW50ZXIoCiBzdGF0aWMgdm9pZCB1cGRh
dGVfc2hhZG93X3BkcHMoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkKQogewog
CXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpjdHhfb2JqID0KLQkJd29ya2xvYWQtPnJlcS0+
aHdfY29udGV4dC0+c3RhdGUtPm9iajsKKwkJd29ya2xvYWQtPnJlcS0+Y29udGV4dC0+c3RhdGUt
Pm9iajsKIAlzdHJ1Y3QgZXhlY2xpc3RfcmluZ19jb250ZXh0ICpzaGFkb3dfcmluZ19jb250ZXh0
OwogCXN0cnVjdCBwYWdlICpwYWdlOwogCkBAIC0xMzAsNyArMTMwLDcgQEAgc3RhdGljIGludCBw
b3B1bGF0ZV9zaGFkb3dfY29udGV4dChzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xv
YWQpCiAJc3RydWN0IGludGVsX2d2dCAqZ3Z0ID0gdmdwdS0+Z3Z0OwogCWludCByaW5nX2lkID0g
d29ya2xvYWQtPnJpbmdfaWQ7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKmN0eF9vYmog
PQotCQl3b3JrbG9hZC0+cmVxLT5od19jb250ZXh0LT5zdGF0ZS0+b2JqOworCQl3b3JrbG9hZC0+
cmVxLT5jb250ZXh0LT5zdGF0ZS0+b2JqOwogCXN0cnVjdCBleGVjbGlzdF9yaW5nX2NvbnRleHQg
KnNoYWRvd19yaW5nX2NvbnRleHQ7CiAJc3RydWN0IHBhZ2UgKnBhZ2U7CiAJdm9pZCAqZHN0OwpA
QCAtMjA1LDkgKzIwNSw5IEBAIHN0YXRpYyBpbnQgcG9wdWxhdGVfc2hhZG93X2NvbnRleHQoc3Ry
dWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkKQogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW5saW5lIGJvb2wgaXNfZ3Z0X3JlcXVlc3Qoc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxKQor
c3RhdGljIGlubGluZSBib29sIGlzX2d2dF9yZXF1ZXN0KHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJx
KQogewotCXJldHVybiBpOTE1X2dlbV9jb250ZXh0X2ZvcmNlX3NpbmdsZV9zdWJtaXNzaW9uKHJl
cS0+Z2VtX2NvbnRleHQpOworCXJldHVybiBpbnRlbF9jb250ZXh0X2ZvcmNlX3NpbmdsZV9zdWJt
aXNzaW9uKHJxLT5jb250ZXh0KTsKIH0KIAogc3RhdGljIHZvaWQgc2F2ZV9yaW5nX2h3X3N0YXRl
KHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1LCBpbnQgcmluZ19pZCkKQEAgLTMwNyw3ICszMDcsNyBA
QCBzdGF0aWMgaW50IGNvcHlfd29ya2xvYWRfdG9fcmluZ19idWZmZXIoc3RydWN0IGludGVsX3Zn
cHVfd29ya2xvYWQgKndvcmtsb2FkKQogCXUzMiAqY3M7CiAJaW50IGVycjsKIAotCWlmIChJU19H
RU4ocmVxLT5pOTE1LCA5KSAmJiBpc19pbmhpYml0X2NvbnRleHQocmVxLT5od19jb250ZXh0KSkK
KwlpZiAoSVNfR0VOKHJlcS0+aTkxNSwgOSkgJiYgaXNfaW5oaWJpdF9jb250ZXh0KHJlcS0+Y29u
dGV4dCkpCiAJCWludGVsX3ZncHVfcmVzdG9yZV9pbmhpYml0X2NvbnRleHQodmdwdSwgcmVxKTsK
IAogCS8qCkBAIC0zNjMsMTEgKzM2MywxMCBAQCBzdGF0aWMgdm9pZCByZWxlYXNlX3NoYWRvd193
YV9jdHgoc3RydWN0IGludGVsX3NoYWRvd193YV9jdHggKndhX2N0eCkKIH0KIAogc3RhdGljIHZv
aWQgc2V0X2NvbnRleHRfcHBndHRfZnJvbV9zaGFkb3coc3RydWN0IGludGVsX3ZncHVfd29ya2xv
YWQgKndvcmtsb2FkLAotCQkJCQkgIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgpCisJCQkJ
CSAgc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQogewogCXN0cnVjdCBpbnRlbF92Z3B1X21tICpt
bSA9IHdvcmtsb2FkLT5zaGFkb3dfbW07Ci0Jc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0ID0KLQkJ
aTkxNV92bV90b19wcGd0dChpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4KSk7CisJc3Ry
dWN0IGk5MTVfcHBndHQgKnBwZ3R0ID0gaTkxNV92bV90b19wcGd0dChjZS0+dm0pOwogCWludCBp
ID0gMDsKIAogCWlmIChtbS0+cHBndHRfbW0ucm9vdF9lbnRyeV90eXBlID09IEdUVF9UWVBFX1BQ
R1RUX1JPT1RfTDRfRU5UUlkpIHsKQEAgLTM4MCw4ICszNzksNiBAQCBzdGF0aWMgdm9pZCBzZXRf
Y29udGV4dF9wcGd0dF9mcm9tX3NoYWRvdyhzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29y
a2xvYWQsCiAJCQlweF9kbWEocGQpID0gbW0tPnBwZ3R0X21tLnNoYWRvd19wZHBzW2ldOwogCQl9
CiAJfQotCi0JaTkxNV92bV9wdXQoJnBwZ3R0LT52bSk7CiB9CiAKIHN0YXRpYyBpbnQKQEAgLTUy
OSw3ICs1MjYsNyBAQCBzdGF0aWMgdm9pZCB1cGRhdGVfd2FfY3R4XzJfc2hhZG93X2N0eChzdHJ1
Y3QgaW50ZWxfc2hhZG93X3dhX2N0eCAqd2FfY3R4KQogCQljb250YWluZXJfb2Yod2FfY3R4LCBz
dHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCwgd2FfY3R4KTsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0
ICpycSA9IHdvcmtsb2FkLT5yZXE7CiAJc3RydWN0IGV4ZWNsaXN0X3JpbmdfY29udGV4dCAqc2hh
ZG93X3JpbmdfY29udGV4dCA9Ci0JCShzdHJ1Y3QgZXhlY2xpc3RfcmluZ19jb250ZXh0ICopcnEt
Pmh3X2NvbnRleHQtPmxyY19yZWdfc3RhdGU7CisJCShzdHJ1Y3QgZXhlY2xpc3RfcmluZ19jb250
ZXh0ICopcnEtPmNvbnRleHQtPmxyY19yZWdfc3RhdGU7CiAKIAlzaGFkb3dfcmluZ19jb250ZXh0
LT5iYl9wZXJfY3R4X3B0ci52YWwgPQogCQkoc2hhZG93X3JpbmdfY29udGV4dC0+YmJfcGVyX2N0
eF9wdHIudmFsICYKQEAgLTYyOCw3ICs2MjUsNyBAQCBzdGF0aWMgaW50IHByZXBhcmVfd29ya2xv
YWQoc3RydWN0IGludGVsX3ZncHVfd29ya2xvYWQgKndvcmtsb2FkKQogCiAJdXBkYXRlX3NoYWRv
d19wZHBzKHdvcmtsb2FkKTsKIAotCXNldF9jb250ZXh0X3BwZ3R0X2Zyb21fc2hhZG93KHdvcmts
b2FkLCBzLT5zaGFkb3dbcmluZ10tPmdlbV9jb250ZXh0KTsKKwlzZXRfY29udGV4dF9wcGd0dF9m
cm9tX3NoYWRvdyh3b3JrbG9hZCwgcy0+c2hhZG93W3JpbmddKTsKIAogCXJldCA9IGludGVsX3Zn
cHVfc3luY19vb3NfcGFnZXMod29ya2xvYWQtPnZncHUpOwogCWlmIChyZXQpIHsKQEAgLTc4Nyw3
ICs3ODQsNyBAQCBzdGF0aWMgdm9pZCB1cGRhdGVfZ3Vlc3RfY29udGV4dChzdHJ1Y3QgaW50ZWxf
dmdwdV93b3JrbG9hZCAqd29ya2xvYWQpCiAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEgPSB3b3Jr
bG9hZC0+cmVxOwogCXN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1ID0gd29ya2xvYWQtPnZncHU7CiAJ
c3RydWN0IGludGVsX2d2dCAqZ3Z0ID0gdmdwdS0+Z3Z0OwotCXN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpjdHhfb2JqID0gcnEtPmh3X2NvbnRleHQtPnN0YXRlLT5vYmo7CisJc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKmN0eF9vYmogPSBycS0+Y29udGV4dC0+c3RhdGUtPm9iajsKIAlz
dHJ1Y3QgZXhlY2xpc3RfcmluZ19jb250ZXh0ICpzaGFkb3dfcmluZ19jb250ZXh0OwogCXN0cnVj
dCBwYWdlICpwYWdlOwogCXZvaWQgKnNyYzsKQEAgLTEyMzIsOCArMTIyOSw2IEBAIGludCBpbnRl
bF92Z3B1X3NldHVwX3N1Ym1pc3Npb24oc3RydWN0IGludGVsX3ZncHUgKnZncHUpCiAJaWYgKElT
X0VSUihjdHgpKQogCQlyZXR1cm4gUFRSX0VSUihjdHgpOwogCi0JaTkxNV9nZW1fY29udGV4dF9z
ZXRfZm9yY2Vfc2luZ2xlX3N1Ym1pc3Npb24oY3R4KTsKLQogCXBwZ3R0ID0gaTkxNV92bV90b19w
cGd0dChpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4KSk7CiAJaTkxNV9jb250ZXh0X3Bw
Z3R0X3Jvb3Rfc2F2ZShzLCBwcGd0dCk7CiAKQEAgLTEyNDksNiArMTI0NCw4IEBAIGludCBpbnRl
bF92Z3B1X3NldHVwX3N1Ym1pc3Npb24oc3RydWN0IGludGVsX3ZncHUgKnZncHUpCiAJCQlnb3Rv
IG91dF9zaGFkb3dfY3R4OwogCQl9CiAKKwkJaW50ZWxfY29udGV4dF9zZXRfc2luZ2xlX3N1Ym1p
c3Npb24oY2UpOworCiAJCWlmICghVVNFU19HVUNfU1VCTUlTU0lPTihpOTE1KSkgeyAvKiBNYXgg
cmluZyBidWZmZXIgc2l6ZSAqLwogCQkJY29uc3QgdW5zaWduZWQgaW50IHJpbmdfc2l6ZSA9IDUx
MiAqIFNaXzRLOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwppbmRleCAzMTllOTZkODMzZmEuLjRj
MDVhNzc5ZDlkNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCkBAIC0xMTM5LDkgKzExMzksOSBA
QCBzdGF0aWMgaW50IF9faW50ZWxfZW5naW5lc19yZWNvcmRfZGVmYXVsdHMoc3RydWN0IGludGVs
X2d0ICpndCkKIAkJCWNvbnRpbnVlOwogCiAJCS8qIFdlIHdhbnQgdG8gYmUgYWJsZSB0byB1bmJp
bmQgdGhlIHN0YXRlIGZyb20gdGhlIEdHVFQgKi8KLQkJR0VNX0JVR19PTihpbnRlbF9jb250ZXh0
X2lzX3Bpbm5lZChycS0+aHdfY29udGV4dCkpOworCQlHRU1fQlVHX09OKGludGVsX2NvbnRleHRf
aXNfcGlubmVkKHJxLT5jb250ZXh0KSk7CiAKLQkJc3RhdGUgPSBycS0+aHdfY29udGV4dC0+c3Rh
dGU7CisJCXN0YXRlID0gcnEtPmNvbnRleHQtPnN0YXRlOwogCQlpZiAoIXN0YXRlKQogCQkJY29u
dGludWU7CiAKQEAgLTExOTMsNyArMTE5Myw3IEBAIHN0YXRpYyBpbnQgX19pbnRlbF9lbmdpbmVz
X3JlY29yZF9kZWZhdWx0cyhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQogCQlpZiAoIXJxKQogCQkJY29u
dGludWU7CiAKLQkJY2UgPSBycS0+aHdfY29udGV4dDsKKwkJY2UgPSBycS0+Y29udGV4dDsKIAkJ
aTkxNV9yZXF1ZXN0X3B1dChycSk7CiAJCWludGVsX2NvbnRleHRfcHV0KGNlKTsKIAl9CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYwppbmRleCA0NzIzOWRmNjUzZjIuLjUxMGYxMTdl
NjNlNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9ncHVfZXJyb3IuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCkBAIC0xMTY4LDcgKzEx
NjgsNyBAQCBzdGF0aWMgdm9pZCBlcnJvcl9yZWNvcmRfZW5naW5lX3JlZ2lzdGVycyhzdHJ1Y3Qg
aTkxNV9ncHVfc3RhdGUgKmVycm9yLAogc3RhdGljIHZvaWQgcmVjb3JkX3JlcXVlc3QoY29uc3Qg
c3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwKIAkJCSAgIHN0cnVjdCBkcm1faTkxNV9lcnJv
cl9yZXF1ZXN0ICplcnEpCiB7Ci0JY29uc3Qgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9
IHJlcXVlc3QtPmdlbV9jb250ZXh0OworCWNvbnN0IHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpj
dHggPSByZXF1ZXN0LT5jb250ZXh0LT5nZW1fY29udGV4dDsKIAogCWVycS0+ZmxhZ3MgPSByZXF1
ZXN0LT5mZW5jZS5mbGFnczsKIAllcnEtPmNvbnRleHQgPSByZXF1ZXN0LT5mZW5jZS5jb250ZXh0
OwpAQCAtMTE4MCw3ICsxMTgwLDcgQEAgc3RhdGljIHZvaWQgcmVjb3JkX3JlcXVlc3QoY29uc3Qg
c3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCwKIAllcnEtPnRhaWwgPSByZXF1ZXN0LT50YWls
OwogCiAJcmN1X3JlYWRfbG9jaygpOwotCWVycS0+cGlkID0gY3R4LT5waWQgPyBwaWRfbnIoY3R4
LT5waWQpIDogMDsKKwllcnEtPnBpZCA9IGN0eCAmJiBjdHgtPnBpZCA/IHBpZF9ucihjdHgtPnBp
ZCkgOiAwOwogCXJjdV9yZWFkX3VubG9jaygpOwogfQogCkBAIC0xMjQ4LDcgKzEyNDgsMTAgQEAg
c3RhdGljIHZvaWQgZXJyb3JfcmVjb3JkX2VuZ2luZV9leGVjbGlzdHMoY29uc3Qgc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lLAogc3RhdGljIGJvb2wgcmVjb3JkX2NvbnRleHQoc3RydWN0
IGRybV9pOTE1X2Vycm9yX2NvbnRleHQgKmUsCiAJCQkgICBjb25zdCBzdHJ1Y3QgaTkxNV9yZXF1
ZXN0ICpycSkKIHsKLQljb25zdCBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4ID0gcnEtPmdl
bV9jb250ZXh0OworCWNvbnN0IHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBycS0+Y29u
dGV4dC0+Z2VtX2NvbnRleHQ7CisKKwlpZiAoIWN0eCkKKwkJcmV0dXJuIGZhbHNlOwogCiAJaWYg
KGN0eC0+cGlkKSB7CiAJCXN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzazsKQEAgLTE0MDIsNyArMTQw
NSw3IEBAIGdlbV9yZWNvcmRfcmluZ3Moc3RydWN0IGk5MTVfZ3B1X3N0YXRlICplcnJvciwgc3Ry
dWN0IGNvbXByZXNzICpjb21wcmVzcykKIAkJY2FwdHVyZSA9IHJlcXVlc3RfcmVjb3JkX3VzZXJf
Ym8ocmVxdWVzdCwgZWUsIGNhcHR1cmUpOwogCiAJCWNhcHR1cmUgPSBjYXB0dXJlX3ZtYShjYXB0
dXJlLAotCQkJCSAgICAgIHJlcXVlc3QtPmh3X2NvbnRleHQtPnN0YXRlLAorCQkJCSAgICAgIHJl
cXVlc3QtPmNvbnRleHQtPnN0YXRlLAogCQkJCSAgICAgICZlZS0+Y3R4KTsKIAogCQljYXB0dXJl
ID0gY2FwdHVyZV92bWEoY2FwdHVyZSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfcGVyZi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKaW5kZXggMzhk
M2RlMmRmYWE2Li5hOWI5N2Q5YmE4M2EgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfcGVyZi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGVyZi5jCkBAIC0y
ODQyLDcgKzI4NDIsNyBAQCBzdGF0aWMgdm9pZCBpOTE1X3BlcmZfZW5hYmxlX2xvY2tlZChzdHJ1
Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtKQogCQlzdHJlYW0tPm9wcy0+ZW5hYmxlKHN0cmVh
bSk7CiAKIAlpZiAoc3RyZWFtLT5ob2xkX3ByZWVtcHRpb24pCi0JCWk5MTVfZ2VtX2NvbnRleHRf
c2V0X25vcHJlZW1wdChzdHJlYW0tPmN0eCk7CisJCWludGVsX2NvbnRleHRfc2V0X25vcHJlZW1w
dChzdHJlYW0tPnBpbm5lZF9jdHgpOwogfQogCiAvKioKQEAgLTI4NjgsNyArMjg2OCw3IEBAIHN0
YXRpYyB2b2lkIGk5MTVfcGVyZl9kaXNhYmxlX2xvY2tlZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVh
bSAqc3RyZWFtKQogCXN0cmVhbS0+ZW5hYmxlZCA9IGZhbHNlOwogCiAJaWYgKHN0cmVhbS0+aG9s
ZF9wcmVlbXB0aW9uKQotCQlpOTE1X2dlbV9jb250ZXh0X2NsZWFyX25vcHJlZW1wdChzdHJlYW0t
PmN0eCk7CisJCWludGVsX2NvbnRleHRfY2xlYXJfbm9wcmVlbXB0KHN0cmVhbS0+cGlubmVkX2N0
eCk7CiAKIAlpZiAoc3RyZWFtLT5vcHMtPmRpc2FibGUpCiAJCXN0cmVhbS0+b3BzLT5kaXNhYmxl
KHN0cmVhbSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3Qu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVxdWVzdC5jCmluZGV4IDkzMmM1Y2YxOTBi
NS4uYjlmYzMxY2VhMzY3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Jl
cXVlc3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlcXVlc3QuYwpAQCAtNzMs
NyArNzMsNyBAQCBzdGF0aWMgY29uc3QgY2hhciAqaTkxNV9mZW5jZV9nZXRfdGltZWxpbmVfbmFt
ZShzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkKIAlpZiAodGVzdF9iaXQoRE1BX0ZFTkNFX0ZMQUdf
U0lHTkFMRURfQklULCAmZmVuY2UtPmZsYWdzKSkKIAkJcmV0dXJuICJzaWduYWxlZCI7CiAKLQly
ZXR1cm4gdG9fcmVxdWVzdChmZW5jZSktPmdlbV9jb250ZXh0LT5uYW1lID86ICJbaTkxNV0iOwor
CXJldHVybiB0b19yZXF1ZXN0KGZlbmNlKS0+Y29udGV4dC0+Z2VtX2NvbnRleHQtPm5hbWUgPzog
IltpOTE1XSI7CiB9CiAKIHN0YXRpYyBib29sIGk5MTVfZmVuY2Vfc2lnbmFsZWQoc3RydWN0IGRt
YV9mZW5jZSAqZmVuY2UpCkBAIC0yNzEsOCArMjcxLDggQEAgYm9vbCBpOTE1X3JlcXVlc3RfcmV0
aXJlKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogCXJlbW92ZV9mcm9tX2NsaWVudChycSk7CiAJ
bGlzdF9kZWwoJnJxLT5saW5rKTsKIAotCWludGVsX2NvbnRleHRfZXhpdChycS0+aHdfY29udGV4
dCk7Ci0JaW50ZWxfY29udGV4dF91bnBpbihycS0+aHdfY29udGV4dCk7CisJaW50ZWxfY29udGV4
dF9leGl0KHJxLT5jb250ZXh0KTsKKwlpbnRlbF9jb250ZXh0X3VucGluKHJxLT5jb250ZXh0KTsK
IAogCWZyZWVfY2FwdHVyZV9saXN0KHJxKTsKIAlpOTE1X3NjaGVkX25vZGVfZmluaSgmcnEtPnNj
aGVkKTsKQEAgLTM3NSw3ICszNzUsNyBAQCBib29sIF9faTkxNV9yZXF1ZXN0X3N1Ym1pdChzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpyZXF1ZXN0KQogCWlmIChpOTE1X3JlcXVlc3RfY29tcGxldGVkKHJl
cXVlc3QpKQogCQlnb3RvIHhmZXI7CiAKLQlpZiAoaTkxNV9nZW1fY29udGV4dF9pc19iYW5uZWQo
cmVxdWVzdC0+Z2VtX2NvbnRleHQpKQorCWlmIChpbnRlbF9jb250ZXh0X2lzX2Jhbm5lZChyZXF1
ZXN0LT5jb250ZXh0KSkKIAkJaTkxNV9yZXF1ZXN0X3NraXAocmVxdWVzdCwgLUVJTyk7CiAKIAkv
KgpAQCAtNjQyLDggKzY0Miw3IEBAIF9faTkxNV9yZXF1ZXN0X2NyZWF0ZShzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqY2UsIGdmcF90IGdmcCkKIAkJZ290byBlcnJfZnJlZTsKIAogCXJxLT5pOTE1ID0g
Y2UtPmVuZ2luZS0+aTkxNTsKLQlycS0+aHdfY29udGV4dCA9IGNlOwotCXJxLT5nZW1fY29udGV4
dCA9IGNlLT5nZW1fY29udGV4dDsKKwlycS0+Y29udGV4dCA9IGNlOwogCXJxLT5lbmdpbmUgPSBj
ZS0+ZW5naW5lOwogCXJxLT5yaW5nID0gY2UtPnJpbmc7CiAJcnEtPmV4ZWN1dGlvbl9tYXNrID0g
Y2UtPmVuZ2luZS0+bWFzazsKQEAgLTg5OCw3ICs4OTcsNyBAQCBpOTE1X3JlcXVlc3RfYXdhaXRf
cmVxdWVzdChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICp0bywgc3RydWN0IGk5MTVfcmVxdWVzdCAqZnJv
bSkKIAkJCQkJCSAgICAgICAmZnJvbS0+c3VibWl0LAogCQkJCQkJICAgICAgIEk5MTVfRkVOQ0Vf
R0ZQKTsKIAl9IGVsc2UgaWYgKGludGVsX2VuZ2luZV9oYXNfc2VtYXBob3Jlcyh0by0+ZW5naW5l
KSAmJgotCQkgICB0by0+Z2VtX2NvbnRleHQtPnNjaGVkLnByaW9yaXR5ID49IEk5MTVfUFJJT1JJ
VFlfTk9STUFMKSB7CisJCSAgIHRvLT5jb250ZXh0LT5nZW1fY29udGV4dC0+c2NoZWQucHJpb3Jp
dHkgPj0gSTkxNV9QUklPUklUWV9OT1JNQUwpIHsKIAkJcmV0ID0gZW1pdF9zZW1hcGhvcmVfd2Fp
dCh0bywgZnJvbSwgSTkxNV9GRU5DRV9HRlApOwogCX0gZWxzZSB7CiAJCXJldCA9IGk5MTVfc3df
ZmVuY2VfYXdhaXRfZG1hX2ZlbmNlKCZ0by0+c3VibWl0LApAQCAtMTIyNiw3ICsxMjI1LDcgQEAg
dm9pZCBfX2k5MTVfcmVxdWVzdF9xdWV1ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwKIAogdm9p
ZCBpOTE1X3JlcXVlc3RfYWRkKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxKQogewotCXN0cnVjdCBp
OTE1X3NjaGVkX2F0dHIgYXR0ciA9IHJxLT5nZW1fY29udGV4dC0+c2NoZWQ7CisJc3RydWN0IGk5
MTVfc2NoZWRfYXR0ciBhdHRyID0gcnEtPmNvbnRleHQtPmdlbV9jb250ZXh0LT5zY2hlZDsKIAlz
dHJ1Y3QgaW50ZWxfdGltZWxpbmUgKiBjb25zdCB0bCA9IGk5MTVfcmVxdWVzdF90aW1lbGluZShy
cSk7CiAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcHJldjsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Jl
cXVlc3QuaAppbmRleCA5Njk5MWQ2NDc1OWMuLmIzYjY1MzRhZTc5OCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZXF1ZXN0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9yZXF1ZXN0LmgKQEAgLTEwOSw5ICsxMDksOCBAQCBzdHJ1Y3QgaTkxNV9yZXF1ZXN0
IHsKIAkgKiBpOTE1X3JlcXVlc3RfZnJlZSgpIHdpbGwgdGhlbiBkZWNyZW1lbnQgdGhlIHJlZmNv
dW50IG9uIHRoZQogCSAqIGNvbnRleHQuCiAJICovCi0Jc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQg
KmdlbV9jb250ZXh0OwogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsKLQlzdHJ1Y3Qg
aW50ZWxfY29udGV4dCAqaHdfY29udGV4dDsKKwlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY29udGV4
dDsKIAlzdHJ1Y3QgaW50ZWxfcmluZyAqcmluZzsKIAlzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgX19y
Y3UgKnRpbWVsaW5lOwogCXN0cnVjdCBsaXN0X2hlYWQgc2lnbmFsX2xpbms7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3NjaGVkdWxlci5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9zY2hlZHVsZXIuYwppbmRleCBkMmVkYjUyN2RjYjguLmJmMDIzYjljMDZmZiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zY2hlZHVsZXIuYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3NjaGVkdWxlci5jCkBAIC0yMTEsNyArMjExLDcgQEAg
c3RhdGljIHZvaWQga2lja19zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSwKIAkgKiBJZiB3ZSBhcmUgYWxyZWFkeSB0aGUgY3VycmVudGx5IGV4ZWN1dGluZyBjb250ZXh0
LCBkb24ndAogCSAqIGJvdGhlciBldmFsdWF0aW5nIGlmIHdlIHNob3VsZCBwcmVlbXB0IG91cnNl
bHZlcy4KIAkgKi8KLQlpZiAoaW5mbGlnaHQtPmh3X2NvbnRleHQgPT0gcnEtPmh3X2NvbnRleHQp
CisJaWYgKGluZmxpZ2h0LT5jb250ZXh0ID09IHJxLT5jb250ZXh0KQogCQlyZXR1cm47CiAKIAll
bmdpbmUtPmV4ZWNsaXN0cy5xdWV1ZV9wcmlvcml0eV9oaW50ID0gcHJpbzsKLS0gCjIuMjQuMC5y
YzAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVs
LWdmeCBtYWlsaW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

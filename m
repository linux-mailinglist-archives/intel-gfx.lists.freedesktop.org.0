Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 10CF310CF5A
	for <lists+intel-gfx@lfdr.de>; Thu, 28 Nov 2019 21:51:38 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B036D6E037;
	Thu, 28 Nov 2019 20:51:35 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 031D76E037
 for <intel-gfx@lists.freedesktop.org>; Thu, 28 Nov 2019 20:51:33 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19382492-1500050 
 for <intel-gfx@lists.freedesktop.org>; Thu, 28 Nov 2019 20:51:30 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 28 Nov 2019 20:51:29 +0000
Message-Id: <20191128205129.404969-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915: Introduce DRM_I915_GEM_MMAP_OFFSET
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQWJkaWVsIEphbnVsZ3VlIDxhYmRpZWwuamFudWxndWVAbGludXguaW50ZWwuY29tPgoK
VGhpcyBpcyByZWFsbHkganVzdCBhbiBhbGlhcyBvZiBtbWFwX2d0dC4gVGhlICdtbWFwIG9mZnNl
dCcgbm9tZW5jbGF0dXJlCmNvbWVzIGZyb20gdGhlIHZhbHVlIHJldHVybmVkIGJ5IHRoaXMgaW9j
dGwgd2hpY2ggaXMgdGhlIG9mZnNldCBpbnRvIHRoZQpkZXZpY2UgZmQgd2hpY2ggdXNlcnBhY2Ug
dXNlcyB3aXRoIG1tYXAoMikuCgptbWFwX2d0dCB3YXMgb3VyIGluaXRpYWwgbW1hcF9vZmZzZXQg
aW1wbGVtZW50YXRpb24sIHRoaXMgZXh0ZW5kcwpvdXIgQ1BVIG1tYXAgc3VwcG9ydCB0byBhbGxv
dyBhZGRpdGlvbmFsIGZhdWx0IGhhbmRsZXJzIHRoYXQgZGVwZW5kcyBvbgp0aGUgb2JqZWN0J3Mg
YmFja2luZyBwYWdlcy4KCk5vdGUgdGhhdCB3ZSBtdWx0aXBsZXggbW1hcF9ndHQgYW5kIG1tYXBf
b2Zmc2V0IHRocm91Z2ggdGhlIHNhbWUgaW9jdGwsCmFuZCB1c2UgdGhlIHplcm8gZXh0ZW5kaW5n
IGJlaGF2aW91ciBvZiBkcm0gdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuCnRoZW0sIHdoZW4gd2Ug
aW5zcGVjdCB0aGUgZmxhZ3MuCgpUbyBzdXBwb3J0IG11bHRpcGxlIG1tYXAgdHlwZXMgb24gYW4g
b2JqZWN0IHdlIG5lZWQgdG8gc3VwcG9ydCBtdWx0aXBsZQptbWFwX29mZnNldHMgZm9yIGFuIG9i
amVjdCAoZWFjaCBvZmZzZXQgaW4gdGhlIGdsb2JhbCBkZXZpY2UgYWRkcmVzcwpzcGFjZSBjb3Jy
ZXNwb25kaW5nIHRvIGEgdW5pcXVlIGluc3RhbmNlIG9mIHRoZSBvYmplY3QgZm9yIGEgZmlsZSAr
IG1tYXAKdHlwZSkuIEFzIHdlIGRyb3AgdGhlIHNpbXBsaWZpZWQgZHJtIGNvcmUgaWRlYSBvZiBh
IHNpbmdsZSBtbWFwX29mZnNldCwKd2UgbmVlZCB0byBwcm92aWRlIHJlcGxhY2VtZW50IGhvb2tz
IGZvciB0aGUgZHVtYiBtbWFwIGludGVyZmFjZSBhcwp3ZWxsLgoKTGluazogaHR0cHM6Ly9naXRs
YWIuZnJlZWRlc2t0b3Aub3JnL21lc2EvbWVzYS9tZXJnZV9yZXF1ZXN0cy8xNjc1ClRlc3RjYXNl
OiBpZ3QvZ2VtX21tYXBfb2Zmc2V0ClNpZ25lZC1vZmYtYnk6IEFiZGllbCBKYW51bGd1ZSA8YWJk
aWVsLmphbnVsZ3VlQGxpbnV4LmludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogTWF0dGhldyBBdWxk
IDxtYXR0aGV3LmF1bGRAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9kb21haW4uYyAgICB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX2lvY3Rscy5oICAgIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fbW1hbi5jICAgICAgfCA0NjcgKysrKysrKysrKysrKystLS0tCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5oICAgICAgfCAgMzQgKysKIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYyAgICB8ICAxOCArCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmggICAgfCAgIDcgKy0KIC4uLi9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX29iamVjdF90eXBlcy5oICB8ICAyMiArCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fcGFnZXMuYyAgICAgfCAgIDMgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX3RpbGluZy5jICAgIHwgICAxICsKIC4uLi9kcm0vaTkxNS9nZW0vc2VsZnRl
c3RzL2k5MTVfZ2VtX21tYW4uYyAgICB8ICA4NCArKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9yZXNldC5jICAgICAgICAgfCAgIDcgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZHJ2LmMgICAgICAgICAgICAgICB8ICAxNSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuaCAgICAgICAgICAgICAgIHwgICA0IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2VtLmMgICAgICAgICAgICAgICB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZXRwYXJhbS5jICAgICAgICAgIHwgICAxICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1h
LmMgICAgICAgICAgICAgICB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEu
aCAgICAgICAgICAgICAgIHwgICAzICsKIGluY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaCAgICAg
ICAgICAgICAgICAgICB8ICAzMiArKwogMTggZmlsZXMgY2hhbmdlZCwgNTcyIGluc2VydGlvbnMo
KyksIDEzOSBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5oCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2RvbWFpbi5jCmluZGV4IDlhZWJjZjI2MzE5MS4uYjA2YzE3MjVkNDQ1IDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG9tYWluLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jCkBAIC0xMyw2ICsxMyw3IEBACiAj
aW5jbHVkZSAiaTkxNV9nZW1fb2JqZWN0LmgiCiAjaW5jbHVkZSAiaTkxNV92bWEuaCIKICNpbmNs
dWRlICJpOTE1X2dlbV9sbWVtLmgiCisjaW5jbHVkZSAiaTkxNV9nZW1fbW1hbi5oIgogCiBzdGF0
aWMgdm9pZCBfX2k5MTVfZ2VtX29iamVjdF9mbHVzaF9mb3JfZGlzcGxheShzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqKQogewpAQCAtMjYzLDcgKzI2NCw3IEBAIGludCBpOTE1X2dlbV9v
YmplY3Rfc2V0X2NhY2hlX2xldmVsKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJ
CQl9CiAKIAkJCWlmIChvYmotPnVzZXJmYXVsdF9jb3VudCkKLQkJCQlfX2k5MTVfZ2VtX29iamVj
dF9yZWxlYXNlX21tYXAob2JqKTsKKwkJCQlfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBf
Z3R0KG9iaik7CiAKIAkJCS8qCiAJCQkgKiBBcyB3ZSBubyBsb25nZXIgbmVlZCBhIGZlbmNlIGZv
ciBHVFQgYWNjZXNzLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2lvY3Rscy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2lvY3Rscy5o
CmluZGV4IGRkYzdmMmE1MmIzZS4uODdkOGIyN2Y0MjZkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1faW9jdGxzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2lvY3Rscy5oCkBAIC0yOCw4ICsyOCw4IEBAIGludCBpOTE1X2dlbV9t
YWR2aXNlX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJCQkgICBz
dHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwogaW50IGk5MTVfZ2VtX21tYXBfaW9jdGwoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAkJCXN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7Ci1p
bnQgaTkxNV9nZW1fbW1hcF9ndHRfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAq
ZGF0YSwKLQkJCSAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOworaW50IGk5MTVfZ2VtX21tYXBf
b2Zmc2V0X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCisJCQkgICAg
ICAgc3RydWN0IGRybV9maWxlICpmaWxlKTsKIGludCBpOTE1X2dlbV9wcmVhZF9pb2N0bChzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJIHN0cnVjdCBkcm1fZmlsZSAqZmls
ZSk7CiBpbnQgaTkxNV9nZW1fcHdyaXRlX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZv
aWQgKmRhdGEsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
bW1hbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYwppbmRleCBk
NjA5NzM2MDNjYzEuLjlmZmU4ZjllNWQyNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fbW1hbi5jCkBAIC01LDYgKzUsNyBAQAogICovCiAKICNpbmNsdWRlIDxsaW51eC9tbWFu
Lmg+CisjaW5jbHVkZSA8bGludXgvcGZuX3QuaD4KICNpbmNsdWRlIDxsaW51eC9zaXplcy5oPgog
CiAjaW5jbHVkZSAiZ3QvaW50ZWxfZ3QuaCIKQEAgLTE0LDYgKzE1LDcgQEAKICNpbmNsdWRlICJp
OTE1X2dlbV9ndHQuaCIKICNpbmNsdWRlICJpOTE1X2dlbV9pb2N0bHMuaCIKICNpbmNsdWRlICJp
OTE1X2dlbV9vYmplY3QuaCIKKyNpbmNsdWRlICJpOTE1X2dlbV9tbWFuLmgiCiAjaW5jbHVkZSAi
aTkxNV90cmFjZS5oIgogI2luY2x1ZGUgImk5MTVfdm1hLmgiCiAKQEAgLTE0NCw2ICsxNDYsOSBA
QCBzdGF0aWMgdW5zaWduZWQgaW50IHRpbGVfcm93X3BhZ2VzKGNvbnN0IHN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmopCiAgKiAzIC0gUmVtb3ZlIGltcGxpY2l0IHNldC1kb21haW4oR1RU
KSBhbmQgc3luY2hyb25pc2F0aW9uIG9uIGluaXRpYWwKICAqICAgICBwYWdlZmF1bHQ7IHN3YXBp
biByZW1haW5zIHRyYW5zcGFyZW50LgogICoKKyAqIDQgLSBTdXBwb3J0IG11bHRpcGxlIGZhdWx0
IGhhbmRsZXJzIHBlciBvYmplY3QgZGVwZW5kaW5nIG9uIG9iamVjdCdzCisgKiAgICAgYmFja2lu
ZyBzdG9yYWdlIChhLmsuYS4gTU1BUF9PRkZTRVQpLgorICoKICAqIFJlc3RyaWN0aW9uczoKICAq
CiAgKiAgKiBzbm9vcGFibGUgb2JqZWN0cyBjYW5ub3QgYmUgYWNjZXNzZWQgdmlhIHRoZSBHVFQu
IEl0IGNhbiBjYXVzZSBtYWNoaW5lCkBAIC0xNzEsNyArMTc2LDcgQEAgc3RhdGljIHVuc2lnbmVk
IGludCB0aWxlX3Jvd19wYWdlcyhjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
KQogICovCiBpbnQgaTkxNV9nZW1fbW1hcF9ndHRfdmVyc2lvbih2b2lkKQogewotCXJldHVybiAz
OworCXJldHVybiA0OwogfQogCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2dndHRfdmlldwpA
QCAtMTk3LDI5ICsyMDIsODIgQEAgY29tcHV0ZV9wYXJ0aWFsX3ZpZXcoY29uc3Qgc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAlyZXR1cm4gdmlldzsKIH0KIAotLyoqCi0gKiBpOTE1
X2dlbV9mYXVsdCAtIGZhdWx0IGEgcGFnZSBpbnRvIHRoZSBHVFQKLSAqIEB2bWY6IGZhdWx0IGlu
Zm8KLSAqCi0gKiBUaGUgZmF1bHQgaGFuZGxlciBpcyBzZXQgdXAgYnkgZHJtX2dlbV9tbWFwKCkg
d2hlbiBhIG9iamVjdCBpcyBHVFQgbWFwcGVkCi0gKiBmcm9tIHVzZXJzcGFjZS4gIFRoZSBmYXVs
dCBoYW5kbGVyIHRha2VzIGNhcmUgb2YgYmluZGluZyB0aGUgb2JqZWN0IHRvCi0gKiB0aGUgR1RU
IChpZiBuZWVkZWQpLCBhbGxvY2F0aW5nIGFuZCBwcm9ncmFtbWluZyBhIGZlbmNlIHJlZ2lzdGVy
IChhZ2FpbiwKLSAqIG9ubHkgaWYgbmVlZGVkIGJhc2VkIG9uIHdoZXRoZXIgdGhlIG9sZCByZWcg
aXMgc3RpbGwgdmFsaWQgb3IgdGhlIG9iamVjdAotICogaXMgdGlsZWQpIGFuZCBpbnNlcnRpbmcg
YSBuZXcgUFRFIGludG8gdGhlIGZhdWx0aW5nIHByb2Nlc3MuCi0gKgotICogTm90ZSB0aGF0IHRo
ZSBmYXVsdGluZyBwcm9jZXNzIG1heSBpbnZvbHZlIGV2aWN0aW5nIGV4aXN0aW5nIG9iamVjdHMK
LSAqIGZyb20gdGhlIEdUVCBhbmQvb3IgZmVuY2UgcmVnaXN0ZXJzIHRvIG1ha2Ugcm9vbS4gIFNv
IHBlcmZvcm1hbmNlIG1heQotICogc3VmZmVyIGlmIHRoZSBHVFQgd29ya2luZyBzZXQgaXMgbGFy
Z2Ugb3IgdGhlcmUgYXJlIGZldyBmZW5jZSByZWdpc3RlcnMKLSAqIGxlZnQuCi0gKgotICogVGhl
IGN1cnJlbnQgZmVhdHVyZSBzZXQgc3VwcG9ydGVkIGJ5IGk5MTVfZ2VtX2ZhdWx0KCkgYW5kIHRo
dXMgR1RUIG1tYXBzCi0gKiBpcyBleHBvc2VkIHZpYSBJOTE1X1BBUkFNX01NQVBfR1RUX1ZFUlNJ
T04gKHNlZSBpOTE1X2dlbV9tbWFwX2d0dF92ZXJzaW9uKS4KLSAqLwotdm1fZmF1bHRfdCBpOTE1
X2dlbV9mYXVsdChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKK3N0YXRpYyB2bV9mYXVsdF90IGk5MTVf
ZXJyb3JfdG9fdm1mX2ZhdWx0KGludCBlcnIpCit7CisJc3dpdGNoIChlcnIpIHsKKwlkZWZhdWx0
OgorCQlXQVJOX09OQ0UoZXJyLCAidW5oYW5kbGVkIGVycm9yIGluICVzOiAlaVxuIiwgX19mdW5j
X18sIGVycik7CisJCS8qIGZhbGx0aHJvdWdoICovCisJY2FzZSAtRUlPOiAvKiBzaG1lbWZzIGZh
aWx1cmUgZnJvbSBzd2FwIGRldmljZSAqLworCWNhc2UgLUVGQVVMVDogLyogcHVyZ2VkIG9iamVj
dCAqLworCWNhc2UgLUVOT0RFVjogLyogYmFkIG9iamVjdCwgaG93IGRpZCB5b3UgZ2V0IGhlcmUh
ICovCisJCXJldHVybiBWTV9GQVVMVF9TSUdCVVM7CisKKwljYXNlIC1FTk9TUEM6IC8qIHNobWVt
ZnMgYWxsb2NhdGlvbiBmYWlsdXJlICovCisJY2FzZSAtRU5PTUVNOiAvKiBvdXIgYWxsb2NhdGlv
biBmYWlsdXJlICovCisJCXJldHVybiBWTV9GQVVMVF9PT007CisKKwljYXNlIDA6CisJY2FzZSAt
RUFHQUlOOgorCWNhc2UgLUVSRVNUQVJUU1lTOgorCWNhc2UgLUVJTlRSOgorCWNhc2UgLUVCVVNZ
OgorCQkvKgorCQkgKiBFQlVTWSBpcyBvazogdGhpcyBqdXN0IG1lYW5zIHRoYXQgYW5vdGhlciB0
aHJlYWQKKwkJICogYWxyZWFkeSBkaWQgdGhlIGpvYi4KKwkJICovCisJCXJldHVybiBWTV9GQVVM
VF9OT1BBR0U7CisJfQorfQorCitzdGF0aWMgdm1fZmF1bHRfdCB2bV9mYXVsdF9jcHUoc3RydWN0
IHZtX2ZhdWx0ICp2bWYpCit7CisJc3RydWN0IHZtX2FyZWFfc3RydWN0ICphcmVhID0gdm1mLT52
bWE7CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKnByaXYgPSBhcmVhLT52bV9wcml2YXRlX2Rh
dGE7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IHByaXYtPm9iajsKKwl1bnNp
Z25lZCBsb25nIGksIHNpemUgPSBhcmVhLT52bV9lbmQgLSBhcmVhLT52bV9zdGFydDsKKwlib29s
IHdyaXRlID0gYXJlYS0+dm1fZmxhZ3MgJiBWTV9XUklURTsKKwl2bV9mYXVsdF90IHJldDsKKwlp
bnQgZXJyOworCisJaWYgKCFpOTE1X2dlbV9vYmplY3RfaGFzX3N0cnVjdF9wYWdlKG9iaikpCisJ
CXJldHVybiBWTV9GQVVMVF9TSUdCVVM7CisKKwkvKiBTYW5pdHkgY2hlY2sgdGhhdCB3ZSBhbGxv
dyB3cml0aW5nIGludG8gdGhpcyBvYmplY3QgKi8KKwlpZiAoaTkxNV9nZW1fb2JqZWN0X2lzX3Jl
YWRvbmx5KG9iaikgJiYgd3JpdGUpCisJCXJldHVybiBWTV9GQVVMVF9TSUdCVVM7CisKKwllcnIg
PSBpOTE1X2dlbV9vYmplY3RfcGluX3BhZ2VzKG9iaik7CisJaWYgKGVycikKKwkJcmV0dXJuIGk5
MTVfZXJyb3JfdG9fdm1mX2ZhdWx0KGVycik7CisKKwkvKiBQVEVzIGFyZSByZXZva2VkIGluIG9i
ai0+b3BzLT5wdXRfcGFnZXMoKSAqLworCWZvciAoaSA9IDA7IGkgPCBzaXplID4+IFBBR0VfU0hJ
RlQ7IGkrKykgeworCQlzdHJ1Y3QgcGFnZSAqcGFnZSA9IGk5MTVfZ2VtX29iamVjdF9nZXRfcGFn
ZShvYmosIGkpOworCisJCXJldCA9IHZtZl9pbnNlcnRfcGZuKGFyZWEsCisJCQkJICAgICAodW5z
aWduZWQgbG9uZylhcmVhLT52bV9zdGFydCArIGkgKiBQQUdFX1NJWkUsCisJCQkJICAgICBwYWdl
X3RvX3BmbihwYWdlKSk7CisJCWlmIChyZXQgIT0gVk1fRkFVTFRfTk9QQUdFKQorCQkJYnJlYWs7
CisJfQorCisJaWYgKHdyaXRlKSB7CisJCUdFTV9CVUdfT04oIWk5MTVfZ2VtX29iamVjdF9oYXNf
cGlubmVkX3BhZ2VzKG9iaikpOworCQlvYmotPm1tLmRpcnR5ID0gdHJ1ZTsKKwl9CisKKwlpOTE1
X2dlbV9vYmplY3RfdW5waW5fcGFnZXMob2JqKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRp
YyB2bV9mYXVsdF90IHZtX2ZhdWx0X2d0dChzdHJ1Y3Qgdm1fZmF1bHQgKnZtZikKIHsKICNkZWZp
bmUgTUlOX0NIVU5LX1BBR0VTIChTWl8xTSA+PiBQQUdFX1NISUZUKQogCXN0cnVjdCB2bV9hcmVh
X3N0cnVjdCAqYXJlYSA9IHZtZi0+dm1hOwotCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmogPSB0b19pbnRlbF9ibyhhcmVhLT52bV9wcml2YXRlX2RhdGEpOworCXN0cnVjdCBpOTE1X21t
YXBfb2Zmc2V0ICpwcml2ID0gYXJlYS0+dm1fcHJpdmF0ZV9kYXRhOworCXN0cnVjdCBkcm1faTkx
NV9nZW1fb2JqZWN0ICpvYmogPSBwcml2LT5vYmo7CiAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9
IG9iai0+YmFzZS5kZXY7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGRldik7CiAJc3RydWN0IGludGVsX3J1bnRpbWVfcG0gKnJwbSA9ICZpOTE1LT5ydW50aW1lX3Bt
OwpAQCAtMzEyLDYgKzM3MCw5IEBAIHZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0IHZt
X2ZhdWx0ICp2bWYpCiAJCWxpc3RfYWRkKCZvYmotPnVzZXJmYXVsdF9saW5rLCAmaTkxNS0+Z2d0
dC51c2VyZmF1bHRfbGlzdCk7CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5nZ3R0LnZtLm11dGV4KTsK
IAorCS8qIFRyYWNrIHRoZSBtbW8gYXNzb2NpYXRlZCB3aXRoIHRoZSBmZW5jZWQgdm1hICovCisJ
dm1hLT5tbW8gPSBwcml2OworCiAJaWYgKElTX0FDVElWRShDT05GSUdfRFJNX0k5MTVfVVNFUkZB
VUxUX0FVVE9TVVNQRU5EKSkKIAkJaW50ZWxfd2FrZXJlZl9hdXRvKCZpOTE1LT5nZ3R0LnVzZXJm
YXVsdF93YWtlcmVmLAogCQkJCSAgIG1zZWNzX3RvX2ppZmZpZXNfdGltZW91dChDT05GSUdfRFJN
X0k5MTVfVVNFUkZBVUxUX0FVVE9TVVNQRU5EKSk7CkBAIC0zMzIsNjcgKzM5MywzNiBAQCB2bV9m
YXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQogCWludGVsX3J1bnRp
bWVfcG1fcHV0KHJwbSwgd2FrZXJlZik7CiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX3BhZ2VzKG9i
aik7CiBlcnI6Ci0Jc3dpdGNoIChyZXQpIHsKLQlkZWZhdWx0OgotCQlXQVJOX09OQ0UocmV0LCAi
dW5oYW5kbGVkIGVycm9yIGluICVzOiAlaVxuIiwgX19mdW5jX18sIHJldCk7Ci0JCS8qIGZhbGx0
aHJvdWdoICovCi0JY2FzZSAtRUlPOiAvKiBzaG1lbWZzIGZhaWx1cmUgZnJvbSBzd2FwIGRldmlj
ZSAqLwotCWNhc2UgLUVGQVVMVDogLyogcHVyZ2VkIG9iamVjdCAqLwotCWNhc2UgLUVOT0RFVjog
LyogYmFkIG9iamVjdCwgaG93IGRpZCB5b3UgZ2V0IGhlcmUhICovCi0JCXJldHVybiBWTV9GQVVM
VF9TSUdCVVM7Ci0KLQljYXNlIC1FTk9TUEM6IC8qIHNobWVtZnMgYWxsb2NhdGlvbiBmYWlsdXJl
ICovCi0JY2FzZSAtRU5PTUVNOiAvKiBvdXIgYWxsb2NhdGlvbiBmYWlsdXJlICovCi0JCXJldHVy
biBWTV9GQVVMVF9PT007Ci0KLQljYXNlIDA6Ci0JY2FzZSAtRUFHQUlOOgotCWNhc2UgLUVSRVNU
QVJUU1lTOgotCWNhc2UgLUVJTlRSOgotCWNhc2UgLUVCVVNZOgotCQkvKgotCQkgKiBFQlVTWSBp
cyBvazogdGhpcyBqdXN0IG1lYW5zIHRoYXQgYW5vdGhlciB0aHJlYWQKLQkJICogYWxyZWFkeSBk
aWQgdGhlIGpvYi4KLQkJICovCi0JCXJldHVybiBWTV9GQVVMVF9OT1BBR0U7Ci0JfQorCXJldHVy
biBpOTE1X2Vycm9yX3RvX3ZtZl9mYXVsdChyZXQpOwogfQogCi12b2lkIF9faTkxNV9nZW1fb2Jq
ZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQordm9pZCBf
X2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfZ3R0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCiB7CiAJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAKIAlHRU1fQlVHX09OKCFvYmot
PnVzZXJmYXVsdF9jb3VudCk7CiAKLQlvYmotPnVzZXJmYXVsdF9jb3VudCA9IDA7Ci0JbGlzdF9k
ZWwoJm9iai0+dXNlcmZhdWx0X2xpbmspOwotCWRybV92bWFfbm9kZV91bm1hcCgmb2JqLT5iYXNl
LnZtYV9ub2RlLAotCQkJICAgb2JqLT5iYXNlLmRldi0+YW5vbl9pbm9kZS0+aV9tYXBwaW5nKTsK
LQogCWZvcl9lYWNoX2dndHRfdm1hKHZtYSwgb2JqKQotCQlpOTE1X3ZtYV91bnNldF91c2VyZmF1
bHQodm1hKTsKKwkJaTkxNV92bWFfcmV2b2tlX21tYXAodm1hKTsKKworCUdFTV9CVUdfT04ob2Jq
LT51c2VyZmF1bHRfY291bnQpOwogfQogCi0vKioKLSAqIGk5MTVfZ2VtX29iamVjdF9yZWxlYXNl
X21tYXAgLSByZW1vdmUgcGh5c2ljYWwgcGFnZSBtYXBwaW5ncwotICogQG9iajogb2JqIGluIHF1
ZXN0aW9uCi0gKgotICogUHJlc2VydmUgdGhlIHJlc2VydmF0aW9uIG9mIHRoZSBtbWFwcGluZyB3
aXRoIHRoZSBEUk0gY29yZSBjb2RlLCBidXQKLSAqIHJlbGlucXVpc2ggb3duZXJzaGlwIG9mIHRo
ZSBwYWdlcyBiYWNrIHRvIHRoZSBzeXN0ZW0uCi0gKgorLyoKICAqIEl0IGlzIHZpdGFsIHRoYXQg
d2UgcmVtb3ZlIHRoZSBwYWdlIG1hcHBpbmcgaWYgd2UgaGF2ZSBtYXBwZWQgYSB0aWxlZAogICog
b2JqZWN0IHRocm91Z2ggdGhlIEdUVCBhbmQgdGhlbiBsb3NlIHRoZSBmZW5jZSByZWdpc3RlciBk
dWUgdG8KICAqIHJlc291cmNlIHByZXNzdXJlLiBTaW1pbGFybHkgaWYgdGhlIG9iamVjdCBoYXMg
YmVlbiBtb3ZlZCBvdXQgb2YgdGhlCiAgKiBhcGVydHVyZSwgdGhhbiBwYWdlcyBtYXBwZWQgaW50
byB1c2Vyc3BhY2UgbXVzdCBiZSByZXZva2VkLiBSZW1vdmluZyB0aGUKICAqIG1hcHBpbmcgd2ls
bCB0aGVuIHRyaWdnZXIgYSBwYWdlIGZhdWx0IG9uIHRoZSBuZXh0IHVzZXIgYWNjZXNzLCBhbGxv
d2luZwotICogZml4dXAgYnkgaTkxNV9nZW1fZmF1bHQoKS4KKyAqIGZpeHVwIGJ5IHZtX2ZhdWx0
X2d0dCgpLgogICovCi12b2lkIGk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAoc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaikKK3N0YXRpYyB2b2lkIGk5MTVfZ2VtX29iamVjdF9yZWxl
YXNlX21tYXBfZ3R0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiB7CiAJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KG9iai0+YmFzZS5kZXYpOwogCWludGVs
X3dha2VyZWZfdCB3YWtlcmVmOwogCi0JLyogU2VyaWFsaXNhdGlvbiBiZXR3ZWVuIHVzZXIgR1RU
IGFjY2VzcyBhbmQgb3VyIGNvZGUgZGVwZW5kcyB1cG9uCisJLyoKKwkgKiBTZXJpYWxpc2F0aW9u
IGJldHdlZW4gdXNlciBHVFQgYWNjZXNzIGFuZCBvdXIgY29kZSBkZXBlbmRzIHVwb24KIAkgKiBy
ZXZva2luZyB0aGUgQ1BVJ3MgUFRFIHdoaWxzdCB0aGUgbXV0ZXggaXMgaGVsZC4gVGhlIG5leHQg
dXNlcgogCSAqIHBhZ2VmYXVsdCB0aGVuIGhhcyB0byB3YWl0IHVudGlsIHdlIHJlbGVhc2UgdGhl
IG11dGV4LgogCSAqCkBAIC00MDYsOSArNDM2LDEwIEBAIHZvaWQgaTkxNV9nZW1fb2JqZWN0X3Jl
bGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCWlmICghb2JqLT51
c2VyZmF1bHRfY291bnQpCiAJCWdvdG8gb3V0OwogCi0JX19pOTE1X2dlbV9vYmplY3RfcmVsZWFz
ZV9tbWFwKG9iaik7CisJX19pOTE1X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwX2d0dChvYmopOwog
Ci0JLyogRW5zdXJlIHRoYXQgdGhlIENQVSdzIFBURSBhcmUgcmV2b2tlZCBhbmQgdGhlcmUgYXJl
IG5vdCBvdXRzdGFuZGluZworCS8qCisJICogRW5zdXJlIHRoYXQgdGhlIENQVSdzIFBURSBhcmUg
cmV2b2tlZCBhbmQgdGhlcmUgYXJlIG5vdCBvdXRzdGFuZGluZwogCSAqIG1lbW9yeSB0cmFuc2Fj
dGlvbnMgZnJvbSB1c2Vyc3BhY2UgYmVmb3JlIHdlIHJldHVybi4gVGhlIFRMQgogCSAqIGZsdXNo
aW5nIGltcGxpZWQgYWJvdmUgYnkgY2hhbmdpbmcgdGhlIFBURSBhYm92ZSAqc2hvdWxkKiBiZQog
CSAqIHN1ZmZpY2llbnQsIGFuIGV4dHJhIGJhcnJpZXIgaGVyZSBqdXN0IHByb3ZpZGVzIHVzIHdp
dGggYSBiaXQKQEAgLTQyMiw1NyArNDUzLDE0NSBAQCB2b2lkIGk5MTVfZ2VtX29iamVjdF9yZWxl
YXNlX21tYXAoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAlpbnRlbF9ydW50aW1l
X3BtX3B1dCgmaTkxNS0+cnVudGltZV9wbSwgd2FrZXJlZik7CiB9CiAKLXN0YXRpYyBpbnQgY3Jl
YXRlX21tYXBfb2Zmc2V0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCit2b2lkIGk5
MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfb2Zmc2V0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCit7CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbzsKKworCW11dGV4X2xv
Y2soJm9iai0+bW1vX2xvY2spOworCWxpc3RfZm9yX2VhY2hfZW50cnkobW1vLCAmb2JqLT5tbWFw
X29mZnNldHMsIG9mZnNldCkgeworCQkvKgorCQkgKiB2bWFfbm9kZV91bm1hcCBmb3IgR1RUIG1t
YXBzIGhhbmRsZWQgYWxyZWFkeSBpbgorCQkgKiBfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21t
YXBfZ3R0CisJCSAqLworCQlpZiAobW1vLT5tbWFwX3R5cGUgIT0gSTkxNV9NTUFQX1RZUEVfR1RU
KQorCQkJZHJtX3ZtYV9ub2RlX3VubWFwKCZtbW8tPnZtYV9ub2RlLAorCQkJCQkgICBvYmotPmJh
c2UuZGV2LT5hbm9uX2lub2RlLT5pX21hcHBpbmcpOworCX0KKwltdXRleF91bmxvY2soJm9iai0+
bW1vX2xvY2spOworfQorCisvKioKKyAqIGk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAgLSBy
ZW1vdmUgcGh5c2ljYWwgcGFnZSBtYXBwaW5ncworICogQG9iajogb2JqIGluIHF1ZXN0aW9uCisg
KgorICogUHJlc2VydmUgdGhlIHJlc2VydmF0aW9uIG9mIHRoZSBtbWFwcGluZyB3aXRoIHRoZSBE
Uk0gY29yZSBjb2RlLCBidXQKKyAqIHJlbGlucXVpc2ggb3duZXJzaGlwIG9mIHRoZSBwYWdlcyBi
YWNrIHRvIHRoZSBzeXN0ZW0uCisgKi8KK3ZvaWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1h
cChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQoreworCWk5MTVfZ2VtX29iamVjdF9y
ZWxlYXNlX21tYXBfZ3R0KG9iaik7CisJaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9vZmZz
ZXQob2JqKTsKK30KKworc3RhdGljIHN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICoKK21tYXBfb2Zm
c2V0X2F0dGFjaChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAorCQkgICBlbnVtIGk5
MTVfbW1hcF90eXBlIG1tYXBfdHlwZSwKKwkJICAgc3RydWN0IGRybV9maWxlICpmaWxlKQogewog
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShvYmotPmJhc2UuZGV2KTsK
LQlzdHJ1Y3QgaW50ZWxfZ3QgKmd0ID0gJmk5MTUtPmd0OworCXN0cnVjdCBpOTE1X21tYXBfb2Zm
c2V0ICptbW87CiAJaW50IGVycjsKIAotCWVyciA9IGRybV9nZW1fY3JlYXRlX21tYXBfb2Zmc2V0
KCZvYmotPmJhc2UpOworCW1tbyA9IGttYWxsb2Moc2l6ZW9mKCptbW8pLCBHRlBfS0VSTkVMKTsK
KwlpZiAoIW1tbykKKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CisKKwltbW8tPm9iaiA9IG9i
ajsKKwltbW8tPmRldiA9IG9iai0+YmFzZS5kZXY7CisJbW1vLT5maWxlID0gZmlsZTsKKwltbW8t
Pm1tYXBfdHlwZSA9IG1tYXBfdHlwZTsKKwlkcm1fdm1hX25vZGVfcmVzZXQoJm1tby0+dm1hX25v
ZGUpOworCisJZXJyID0gZHJtX3ZtYV9vZmZzZXRfYWRkKG1tby0+ZGV2LT52bWFfb2Zmc2V0X21h
bmFnZXIsICZtbW8tPnZtYV9ub2RlLAorCQkJCSBvYmotPmJhc2Uuc2l6ZSAvIFBBR0VfU0laRSk7
CiAJaWYgKGxpa2VseSghZXJyKSkKLQkJcmV0dXJuIDA7CisJCWdvdG8gb3V0OwogCiAJLyogQXR0
ZW1wdCB0byByZWFwIHNvbWUgbW1hcCBzcGFjZSBmcm9tIGRlYWQgb2JqZWN0cyAqLwotCWVyciA9
IGludGVsX2d0X3JldGlyZV9yZXF1ZXN0c190aW1lb3V0KGd0LCBNQVhfU0NIRURVTEVfVElNRU9V
VCk7CisJZXJyID0gaW50ZWxfZ3RfcmV0aXJlX3JlcXVlc3RzX3RpbWVvdXQoJmk5MTUtPmd0LCBN
QVhfU0NIRURVTEVfVElNRU9VVCk7CiAJaWYgKGVycikKLQkJcmV0dXJuIGVycjsKKwkJZ290byBl
cnI7CiAKIAlpOTE1X2dlbV9kcmFpbl9mcmVlZF9vYmplY3RzKGk5MTUpOwotCXJldHVybiBkcm1f
Z2VtX2NyZWF0ZV9tbWFwX29mZnNldCgmb2JqLT5iYXNlKTsKKwllcnIgPSBkcm1fdm1hX29mZnNl
dF9hZGQobW1vLT5kZXYtPnZtYV9vZmZzZXRfbWFuYWdlciwgJm1tby0+dm1hX25vZGUsCisJCQkJ
IG9iai0+YmFzZS5zaXplIC8gUEFHRV9TSVpFKTsKKwlpZiAoZXJyKQorCQlnb3RvIGVycjsKKwor
b3V0OgorCW11dGV4X2xvY2soJm9iai0+bW1vX2xvY2spOworCWxpc3RfYWRkKCZtbW8tPm9mZnNl
dCwgJm9iai0+bW1hcF9vZmZzZXRzKTsKKwltdXRleF91bmxvY2soJm9iai0+bW1vX2xvY2spOwor
CisJaWYgKGZpbGUpCisJCWRybV92bWFfbm9kZV9hbGxvdygmbW1vLT52bWFfbm9kZSwgZmlsZSk7
CisKKwlyZXR1cm4gbW1vOworCitlcnI6CisJa2ZyZWUobW1vKTsKKwlyZXR1cm4gRVJSX1BUUihl
cnIpOwogfQogCi1pbnQKLWk5MTVfZ2VtX21tYXBfZ3R0KHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwK
LQkJICBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAotCQkgIHUzMiBoYW5kbGUsCi0JCSAgdTY0ICpv
ZmZzZXQpCitzdGF0aWMgaW50CitfX2Fzc2lnbl9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2ZpbGUg
KmZpbGUsCisJCSAgICAgdTMyIGhhbmRsZSwKKwkJICAgICBlbnVtIGk5MTVfbW1hcF90eXBlIG1t
YXBfdHlwZSwKKwkJICAgICB1NjQgKm9mZnNldCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqOwotCWludCByZXQ7Ci0KLQlpZiAoIWk5MTVfZ2d0dF9oYXNfYXBlcnR1cmUoJnRv
X2k5MTUoZGV2KS0+Z2d0dCkpCi0JCXJldHVybiAtRU5PREVWOworCXN0cnVjdCBpOTE1X21tYXBf
b2Zmc2V0ICptbW87CisJaW50IGVycjsKIAogCW9iaiA9IGk5MTVfZ2VtX29iamVjdF9sb29rdXAo
ZmlsZSwgaGFuZGxlKTsKIAlpZiAoIW9iaikKIAkJcmV0dXJuIC1FTk9FTlQ7CiAKLQlpZiAoaTkx
NV9nZW1fb2JqZWN0X25ldmVyX2JpbmRfZ2d0dChvYmopKSB7Ci0JCXJldCA9IC1FTk9ERVY7CisJ
aWYgKG1tYXBfdHlwZSA9PSBJOTE1X01NQVBfVFlQRV9HVFQgJiYKKwkgICAgaTkxNV9nZW1fb2Jq
ZWN0X25ldmVyX2JpbmRfZ2d0dChvYmopKSB7CisJCWVyciA9IC1FTk9ERVY7CiAJCWdvdG8gb3V0
OwogCX0KIAotCXJldCA9IGNyZWF0ZV9tbWFwX29mZnNldChvYmopOwotCWlmIChyZXQgPT0gMCkK
LQkJKm9mZnNldCA9IGRybV92bWFfbm9kZV9vZmZzZXRfYWRkcigmb2JqLT5iYXNlLnZtYV9ub2Rl
KTsKKwlpZiAobW1hcF90eXBlICE9IEk5MTVfTU1BUF9UWVBFX0dUVCAmJgorCSAgICAhaTkxNV9n
ZW1fb2JqZWN0X2hhc19zdHJ1Y3RfcGFnZShvYmopKSB7CisJCWVyciA9IC1FTk9ERVY7CisJCWdv
dG8gb3V0OworCX0KIAorCW1tbyA9IG1tYXBfb2Zmc2V0X2F0dGFjaChvYmosIG1tYXBfdHlwZSwg
ZmlsZSk7CisJaWYgKElTX0VSUihtbW8pKSB7CisJCWVyciA9IFBUUl9FUlIobW1vKTsKKwkJZ290
byBvdXQ7CisJfQorCisJKm9mZnNldCA9IGRybV92bWFfbm9kZV9vZmZzZXRfYWRkcigmbW1vLT52
bWFfbm9kZSk7CisJZXJyID0gMDsKIG91dDoKIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7Ci0J
cmV0dXJuIHJldDsKKwlyZXR1cm4gZXJyOworfQorCitpbnQKK2k5MTVfZ2VtX2R1bWJfbW1hcF9v
ZmZzZXQoc3RydWN0IGRybV9maWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LAorCQkJICB1MzIgaGFuZGxlLAorCQkJICB1NjQgKm9mZnNldCkKK3sKKwllbnVtIGk5MTVfbW1h
cF90eXBlIG1tYXBfdHlwZTsKKworCWlmIChib290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfUEFUKSkK
KwkJbW1hcF90eXBlID0gSTkxNV9NTUFQX1RZUEVfV0M7CisJZWxzZSBpZiAoIWk5MTVfZ2d0dF9o
YXNfYXBlcnR1cmUoJnRvX2k5MTUoZGV2KS0+Z2d0dCkpCisJCXJldHVybiAtRU5PREVWOworCWVs
c2UKKwkJbW1hcF90eXBlID0gSTkxNV9NTUFQX1RZUEVfR1RUOworCisJcmV0dXJuIF9fYXNzaWdu
X21tYXBfb2Zmc2V0KGZpbGUsIGhhbmRsZSwgbW1hcF90eXBlLCBvZmZzZXQpOwogfQogCiAvKioK
LSAqIGk5MTVfZ2VtX21tYXBfZ3R0X2lvY3RsIC0gcHJlcGFyZSBhbiBvYmplY3QgZm9yIEdUVCBt
bWFwJ2luZworICogaTkxNV9nZW1fbW1hcF9vZmZzZXRfaW9jdGwgLSBwcmVwYXJlIGFuIG9iamVj
dCBmb3IgR1RUIG1tYXAnaW5nCiAgKiBAZGV2OiBEUk0gZGV2aWNlCiAgKiBAZGF0YTogR1RUIG1h
cHBpbmcgaW9jdGwgZGF0YQogICogQGZpbGU6IEdFTSBvYmplY3QgaW5mbwpAQCAtNDg3LDEyICs2
MDYsMTc4IEBAIGk5MTVfZ2VtX21tYXBfZ3R0KHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwKICAqIHVz
ZXJzcGFjZS4KICAqLwogaW50Ci1pOTE1X2dlbV9tbWFwX2d0dF9pb2N0bChzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2LCB2b2lkICpkYXRhLAotCQkJc3RydWN0IGRybV9maWxlICpmaWxlKQoraTkxNV9n
ZW1fbW1hcF9vZmZzZXRfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwK
KwkJCSAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSA9IHRvX2k5MTUoZGV2KTsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX21tYXBfb2Zmc2V0
ICphcmdzID0gZGF0YTsKKwllbnVtIGk5MTVfbW1hcF90eXBlIHR5cGU7CisKKwlpZiAoYXJncy0+
ZXh0ZW5zaW9ucykKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlzd2l0Y2ggKGFyZ3MtPmZsYWdzKSB7
CisJY2FzZSBJOTE1X01NQVBfT0ZGU0VUX0dUVDoKKwkJaWYgKCFpOTE1X2dndHRfaGFzX2FwZXJ0
dXJlKCZpOTE1LT5nZ3R0KSkKKwkJCXJldHVybiAtRU5PREVWOworCQl0eXBlID0gSTkxNV9NTUFQ
X1RZUEVfR1RUOworCQlicmVhazsKKworCWNhc2UgSTkxNV9NTUFQX09GRlNFVF9XQzoKKwkJaWYg
KCFib290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfUEFUKSkKKwkJCXJldHVybiAtRU5PREVWOworCQl0
eXBlID0gSTkxNV9NTUFQX1RZUEVfV0M7CisJCWJyZWFrOworCisJY2FzZSBJOTE1X01NQVBfT0ZG
U0VUX1dCOgorCQl0eXBlID0gSTkxNV9NTUFQX1RZUEVfV0I7CisJCWJyZWFrOworCisJY2FzZSBJ
OTE1X01NQVBfT0ZGU0VUX1VDOgorCQlpZiAoIWJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9QQVQp
KQorCQkJcmV0dXJuIC1FTk9ERVY7CisJCXR5cGUgPSBJOTE1X01NQVBfVFlQRV9VQzsKKwkJYnJl
YWs7CisKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXR1cm4gX19hc3Np
Z25fbW1hcF9vZmZzZXQoZmlsZSwgYXJncy0+aGFuZGxlLCB0eXBlLCAmYXJncy0+b2Zmc2V0KTsK
K30KKwordm9pZCBpOTE1X21tYXBfb2Zmc2V0X2Rlc3Ryb3koc3RydWN0IGk5MTVfbW1hcF9vZmZz
ZXQgKm1tbywgc3RydWN0IG11dGV4ICptdXRleCkKK3sKKwlkcm1fdm1hX29mZnNldF9yZW1vdmUo
bW1vLT5kZXYtPnZtYV9vZmZzZXRfbWFuYWdlciwgJm1tby0+dm1hX25vZGUpOworCisJbXV0ZXhf
bG9jayhtdXRleCk7CisJbGlzdF9kZWwoJm1tby0+b2Zmc2V0KTsKKwltdXRleF91bmxvY2sobXV0
ZXgpOworCisJa2ZyZWUobW1vKTsKK30KKworc3RhdGljIHZvaWQgdm1fb3BlbihzdHJ1Y3Qgdm1f
YXJlYV9zdHJ1Y3QgKnZtYSkKK3sKKwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldCAqbW1vID0gdm1h
LT52bV9wcml2YXRlX2RhdGE7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IG1t
by0+b2JqOworCisJR0VNX0JVR19PTighb2JqKTsKKwlpOTE1X2dlbV9vYmplY3RfZ2V0KG9iaik7
Cit9CisKK3N0YXRpYyB2b2lkIHZtX2Nsb3NlKHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKQog
ewotCXN0cnVjdCBkcm1faTkxNV9nZW1fbW1hcF9ndHQgKmFyZ3MgPSBkYXRhOworCXN0cnVjdCBp
OTE1X21tYXBfb2Zmc2V0ICptbW8gPSB2bWEtPnZtX3ByaXZhdGVfZGF0YTsKKwlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqID0gbW1vLT5vYmo7CisKKwlHRU1fQlVHX09OKCFvYmopOwor
CWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCB2bV9v
cGVyYXRpb25zX3N0cnVjdCB2bV9vcHNfZ3R0ID0geworCS5mYXVsdCA9IHZtX2ZhdWx0X2d0dCwK
Kwkub3BlbiA9IHZtX29wZW4sCisJLmNsb3NlID0gdm1fY2xvc2UsCit9OworCitzdGF0aWMgY29u
c3Qgc3RydWN0IHZtX29wZXJhdGlvbnNfc3RydWN0IHZtX29wc19jcHUgPSB7CisJLmZhdWx0ID0g
dm1fZmF1bHRfY3B1LAorCS5vcGVuID0gdm1fb3BlbiwKKwkuY2xvc2UgPSB2bV9jbG9zZSwKK307
CiAKLQlyZXR1cm4gaTkxNV9nZW1fbW1hcF9ndHQoZmlsZSwgZGV2LCBhcmdzLT5oYW5kbGUsICZh
cmdzLT5vZmZzZXQpOworLyoKKyAqIFRoaXMgb3ZlcmNvbWVzIHRoZSBsaW1pdGF0aW9uIGluIGRy
bV9nZW1fbW1hcCdzIGFzc2lnbm1lbnQgb2YgYQorICogZHJtX2dlbV9vYmplY3QgYXMgdGhlIHZt
YS0+dm1fcHJpdmF0ZV9kYXRhLiBTaW5jZSB3ZSBuZWVkIHRvCisgKiBiZSBhYmxlIHRvIHJlc29s
dmUgbXVsdGlwbGUgbW1hcCBvZmZzZXRzIHdoaWNoIGNvdWxkIGJlIHRpZWQKKyAqIHRvIGEgc2lu
Z2xlIGdlbSBvYmplY3QuCisgKi8KK2ludCBpOTE1X2dlbV9tbWFwKHN0cnVjdCBmaWxlICpmaWxw
LCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKK3sKKwlzdHJ1Y3QgZHJtX3ZtYV9vZmZzZXRf
bm9kZSAqbm9kZTsKKwlzdHJ1Y3QgZHJtX2ZpbGUgKnByaXYgPSBmaWxwLT5wcml2YXRlX2RhdGE7
CisJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IHByaXYtPm1pbm9yLT5kZXY7CisJc3RydWN0IGk5
MTVfbW1hcF9vZmZzZXQgKm1tbyA9IE5VTEw7CisJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmog
PSBOVUxMOworCisJaWYgKGRybV9kZXZfaXNfdW5wbHVnZ2VkKGRldikpCisJCXJldHVybiAtRU5P
REVWOworCisJZHJtX3ZtYV9vZmZzZXRfbG9ja19sb29rdXAoZGV2LT52bWFfb2Zmc2V0X21hbmFn
ZXIpOworCW5vZGUgPSBkcm1fdm1hX29mZnNldF9leGFjdF9sb29rdXBfbG9ja2VkKGRldi0+dm1h
X29mZnNldF9tYW5hZ2VyLAorCQkJCQkJICB2bWEtPnZtX3Bnb2ZmLAorCQkJCQkJICB2bWFfcGFn
ZXModm1hKSk7CisJaWYgKGxpa2VseShub2RlKSkgeworCQltbW8gPSBjb250YWluZXJfb2Yobm9k
ZSwgc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQsCisJCQkJICAgdm1hX25vZGUpOworCQkvKgorCQkg
KiBJbiBvdXIgZGVwZW5kZW5jeSBjaGFpbiwgdGhlIGRybV92bWFfb2Zmc2V0X25vZGUKKwkJICog
ZGVwZW5kcyBvbiB0aGUgdmFsaWRpdHkgb2YgdGhlIG1tbywgd2hpY2ggZGVwZW5kcyBvbgorCQkg
KiB0aGUgZ2VtIG9iamVjdC4gSG93ZXZlciB0aGUgb25seSByZWZlcmVuY2Ugd2UgaGF2ZQorCQkg
KiBhdCB0aGlzIHBvaW50IGlzIHRoZSBtbW8gKGFzIHRoZSBwYXJlbnQgb2YgdGhlIG5vZGUpLgor
CQkgKiBUcnkgdG8gY2hlY2sgaWYgdGhlIGdlbSBvYmplY3Qgd2FzIGF0IGxlYXN0IGNsZWFyZWQu
CisJCSAqLworCQlpZiAoIW1tbyB8fCAhbW1vLT5vYmopIHsKKwkJCWRybV92bWFfb2Zmc2V0X3Vu
bG9ja19sb29rdXAoZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIpOworCQkJcmV0dXJuIC1FSU5WQUw7
CisJCX0KKwkJLyoKKwkJICogU2tpcCAwLXJlZmNudGVkIG9iamVjdHMgYXMgaXQgaXMgaW4gdGhl
IHByb2Nlc3Mgb2YgYmVpbmcKKwkJICogZGVzdHJveWVkIGFuZCB3aWxsIGJlIGludmFsaWQgd2hl
biB0aGUgdm1hIG1hbmFnZXIgbG9jaworCQkgKiBpcyByZWxlYXNlZC4KKwkJICovCisJCW9iaiA9
ICZtbW8tPm9iai0+YmFzZTsKKwkJaWYgKCFrcmVmX2dldF91bmxlc3NfemVybygmb2JqLT5yZWZj
b3VudCkpCisJCQlvYmogPSBOVUxMOworCX0KKwlkcm1fdm1hX29mZnNldF91bmxvY2tfbG9va3Vw
KGRldi0+dm1hX29mZnNldF9tYW5hZ2VyKTsKKwlpZiAoIW9iaikKKwkJcmV0dXJuIC1FSU5WQUw7
CisKKwlpZiAoIWRybV92bWFfbm9kZV9pc19hbGxvd2VkKG5vZGUsIHByaXYpKSB7CisJCWRybV9n
ZW1fb2JqZWN0X3B1dF91bmxvY2tlZChvYmopOworCQlyZXR1cm4gLUVBQ0NFUzsKKwl9CisKKwlp
ZiAoaTkxNV9nZW1fb2JqZWN0X2lzX3JlYWRvbmx5KHRvX2ludGVsX2JvKG9iaikpKSB7CisJCWlm
ICh2bWEtPnZtX2ZsYWdzICYgVk1fV1JJVEUpIHsKKwkJCWRybV9nZW1fb2JqZWN0X3B1dF91bmxv
Y2tlZChvYmopOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKwkJdm1hLT52bV9mbGFncyAmPSB+
Vk1fTUFZV1JJVEU7CisJfQorCisJdm1hLT52bV9mbGFncyB8PSBWTV9QRk5NQVAgfCBWTV9ET05U
RVhQQU5EIHwgVk1fRE9OVERVTVA7CisJdm1hLT52bV9wcml2YXRlX2RhdGEgPSBtbW87CisKKwlz
d2l0Y2ggKG1tby0+bW1hcF90eXBlKSB7CisJY2FzZSBJOTE1X01NQVBfVFlQRV9XQzoKKwkJdm1h
LT52bV9wYWdlX3Byb3QgPQorCQkJcGdwcm90X3dyaXRlY29tYmluZSh2bV9nZXRfcGFnZV9wcm90
KHZtYS0+dm1fZmxhZ3MpKTsKKwkJdm1hLT52bV9vcHMgPSAmdm1fb3BzX2NwdTsKKwkJYnJlYWs7
CisKKwljYXNlIEk5MTVfTU1BUF9UWVBFX1dCOgorCQl2bWEtPnZtX3BhZ2VfcHJvdCA9IHZtX2dl
dF9wYWdlX3Byb3Qodm1hLT52bV9mbGFncyk7CisJCXZtYS0+dm1fb3BzID0gJnZtX29wc19jcHU7
CisJCWJyZWFrOworCisJY2FzZSBJOTE1X01NQVBfVFlQRV9VQzoKKwkJdm1hLT52bV9wYWdlX3By
b3QgPQorCQkJcGdwcm90X25vbmNhY2hlZCh2bV9nZXRfcGFnZV9wcm90KHZtYS0+dm1fZmxhZ3Mp
KTsKKwkJdm1hLT52bV9vcHMgPSAmdm1fb3BzX2NwdTsKKwkJYnJlYWs7CisKKwljYXNlIEk5MTVf
TU1BUF9UWVBFX0dUVDoKKwkJdm1hLT52bV9wYWdlX3Byb3QgPQorCQkJcGdwcm90X3dyaXRlY29t
YmluZSh2bV9nZXRfcGFnZV9wcm90KHZtYS0+dm1fZmxhZ3MpKTsKKwkJdm1hLT52bV9vcHMgPSAm
dm1fb3BzX2d0dDsKKwkJYnJlYWs7CisJfQorCXZtYS0+dm1fcGFnZV9wcm90ID0gcGdwcm90X2Rl
Y3J5cHRlZCh2bWEtPnZtX3BhZ2VfcHJvdCk7CisKKwlyZXR1cm4gMDsKIH0KIAogI2lmIElTX0VO
QUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX21tYW4uaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9tbWFuLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4w
MzA3ODQzNDQwYWMKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fbW1hbi5oCkBAIC0wLDAgKzEsMzQgQEAKKy8qCisgKiBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogTUlUCisgKgorICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24K
KyAqLworCisjaWZuZGVmIF9fSTkxNV9HRU1fTU1BTl9IX18KKyNkZWZpbmUgX19JOTE1X0dFTV9N
TUFOX0hfXworCisjaW5jbHVkZSA8bGludXgvbW1fdHlwZXMuaD4KKyNpbmNsdWRlIDxsaW51eC90
eXBlcy5oPgorCitzdHJ1Y3QgZHJtX2RldmljZTsKK3N0cnVjdCBkcm1fZmlsZTsKK3N0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0Oworc3RydWN0IGZpbGU7CitzdHJ1Y3QgaTkxNV9tbWFwX29mZnNl
dDsKK3N0cnVjdCBtdXRleDsKKworaW50IGk5MTVfZ2VtX21tYXBfZ3R0X3ZlcnNpb24odm9pZCk7
CitpbnQgaTkxNV9nZW1fbW1hcChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IHZtX2FyZWFfc3Ry
dWN0ICp2bWEpOworCitpbnQgaTkxNV9nZW1fZHVtYl9tbWFwX29mZnNldChzdHJ1Y3QgZHJtX2Zp
bGUgKmZpbGVfcHJpdiwKKwkJCSAgICAgIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCisJCQkgICAg
ICB1MzIgaGFuZGxlLCB1NjQgKm9mZnNldCk7CisKK3ZvaWQgX19pOTE1X2dlbV9vYmplY3RfcmVs
ZWFzZV9tbWFwX2d0dChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKTsKK3ZvaWQgaTkx
NV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
KTsKK3ZvaWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcF9vZmZzZXQoc3RydWN0IGRybV9p
OTE1X2dlbV9vYmplY3QgKm9iaik7CisKK3ZvaWQgaTkxNV9tbWFwX29mZnNldF9kZXN0cm95KHN0
cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW8sCisJCQkgICAgICBzdHJ1Y3QgbXV0ZXggKm11dGV4
KTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMK
aW5kZXggNDU4OTQ1ZTE4MjNlLi5mMWI4N2E4Mzk5MjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKQEAgLTI5LDYgKzI5LDcgQEAKICNpbmNsdWRlICJpOTE1
X2Rydi5oIgogI2luY2x1ZGUgImk5MTVfZ2VtX2NsZmx1c2guaCIKICNpbmNsdWRlICJpOTE1X2dl
bV9jb250ZXh0LmgiCisjaW5jbHVkZSAiaTkxNV9nZW1fbW1hbi5oIgogI2luY2x1ZGUgImk5MTVf
Z2VtX29iamVjdC5oIgogI2luY2x1ZGUgImk5MTVfZ2xvYmFscy5oIgogI2luY2x1ZGUgImk5MTVf
dHJhY2UuaCIKQEAgLTYxLDYgKzYyLDkgQEAgdm9pZCBpOTE1X2dlbV9vYmplY3RfaW5pdChzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAogCiAJSU5JVF9MSVNUX0hFQUQoJm9iai0+bHV0
X2xpc3QpOwogCisJbXV0ZXhfaW5pdCgmb2JqLT5tbW9fbG9jayk7CisJSU5JVF9MSVNUX0hFQUQo
Jm9iai0+bW1hcF9vZmZzZXRzKTsKKwogCWluaXRfcmN1X2hlYWQoJm9iai0+cmN1KTsKIAogCW9i
ai0+b3BzID0gb3BzOwpAQCAtOTcsNiArMTAxLDcgQEAgdm9pZCBpOTE1X2dlbV9jbG9zZV9vYmpl
Y3Qoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnZW0sIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKIAlz
dHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gdG9faW50ZWxfYm8oZ2VtKTsKIAlzdHJ1
Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmcHJpdiA9IGZpbGUtPmRyaXZlcl9wcml2OwogCXN0
cnVjdCBpOTE1X2x1dF9oYW5kbGUgKmx1dCwgKmxuOworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0
ICptbW8sICpvbjsKIAlMSVNUX0hFQUQoY2xvc2UpOwogCiAJaTkxNV9nZW1fb2JqZWN0X2xvY2so
b2JqKTsKQEAgLTExMSw2ICsxMTYsOSBAQCB2b2lkIGk5MTVfZ2VtX2Nsb3NlX29iamVjdChzdHJ1
Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSwgc3RydWN0IGRybV9maWxlICpmaWxlKQogCX0KIAlpOTE1
X2dlbV9vYmplY3RfdW5sb2NrKG9iaik7CiAKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUobW1v
LCBvbiwgJm9iai0+bW1hcF9vZmZzZXRzLCBvZmZzZXQpCisJCWRybV92bWFfbm9kZV9yZXZva2Uo
Jm1tby0+dm1hX25vZGUsIGZpbGUpOworCiAJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGx1dCwg
bG4sICZjbG9zZSwgb2JqX2xpbmspIHsKIAkJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9
IGx1dC0+Y3R4OwogCQlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKQEAgLTE1OCw2ICsxNjYsOCBAQCBz
dGF0aWMgdm9pZCBfX2k5MTVfZ2VtX2ZyZWVfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSwKIAogCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGlt
ZV9wbSk7CiAJbGxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShvYmosIG9uLCBmcmVlZCwgZnJlZWQp
IHsKKwkJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbywgKm1uOworCiAJCXRyYWNlX2k5MTVf
Z2VtX29iamVjdF9kZXN0cm95KG9iaik7CiAKIAkJaWYgKCFsaXN0X2VtcHR5KCZvYmotPnZtYS5s
aXN0KSkgewpAQCAtMTgzLDYgKzE5MywxNCBAQCBzdGF0aWMgdm9pZCBfX2k5MTVfZ2VtX2ZyZWVf
b2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJCXNwaW5fdW5sb2NrKCZv
YmotPnZtYS5sb2NrKTsKIAkJfQogCisJCWk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXAob2Jq
KTsKKworCQlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUobW1vLCBtbiwgJm9iai0+bW1hcF9vZmZz
ZXRzLCBvZmZzZXQpIHsKKwkJCW1tby0+b2JqID0gTlVMTDsKKwkJCWk5MTVfbW1hcF9vZmZzZXRf
ZGVzdHJveShtbW8sICZvYmotPm1tb19sb2NrKTsKKwkJfQorCisJCUdFTV9CVUdfT04oIWxpc3Rf
ZW1wdHkoJm9iai0+bW1hcF9vZmZzZXRzKSk7CiAJCUdFTV9CVUdfT04oYXRvbWljX3JlYWQoJm9i
ai0+YmluZF9jb3VudCkpOwogCQlHRU1fQlVHX09OKG9iai0+dXNlcmZhdWx0X2NvdW50KTsKIAkJ
R0VNX0JVR19PTighbGlzdF9lbXB0eSgmb2JqLT5sdXRfbGlzdCkpOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCmluZGV4IGU1NzUwZDUwNmNjOS4uYTFlYjdjMGIy
M2FjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0
LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdC5oCkBAIC0x
MzIsMTMgKzEzMiwxMyBAQCB2b2lkIGk5MTVfZ2VtX29iamVjdF91bmxvY2tfZmVuY2Uoc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIHN0YXRpYyBpbmxpbmUgdm9pZAogaTkxNV9nZW1f
b2JqZWN0X3NldF9yZWFkb25seShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewot
CW9iai0+YmFzZS52bWFfbm9kZS5yZWFkb25seSA9IHRydWU7CisJb2JqLT5mbGFncyB8PSBJOTE1
X0JPX1JFQURPTkxZOwogfQogCiBzdGF0aWMgaW5saW5lIGJvb2wKIGk5MTVfZ2VtX29iamVjdF9p
c19yZWFkb25seShjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogewotCXJl
dHVybiBvYmotPmJhc2Uudm1hX25vZGUucmVhZG9ubHk7CisJcmV0dXJuIG9iai0+ZmxhZ3MgJiBJ
OTE1X0JPX1JFQURPTkxZOwogfQogCiBzdGF0aWMgaW5saW5lIGJvb2wKQEAgLTM4Nyw5ICszODcs
NiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9wYWdlcyhv
YmopOwogfQogCi12b2lkIF9faTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1hcChzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqKTsKLXZvaWQgaTkxNV9nZW1fb2JqZWN0X3JlbGVhc2VfbW1h
cChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKTsKLQogdm9pZAogaTkxNV9nZW1fb2Jq
ZWN0X2ZsdXNoX3dyaXRlX2RvbWFpbihzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAog
CQkJCSAgIHVuc2lnbmVkIGludCBmbHVzaF9kb21haW5zKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3RfdHlwZXMuaAppbmRleCAxNWY4Mjk3ZGMzNGUuLmMw
YmViOTdiNTZkMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X29iamVjdF90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9v
YmplY3RfdHlwZXMuaApAQCAtNjMsNiArNjMsMjMgQEAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3Rfb3BzIHsKIAl2b2lkICgqcmVsZWFzZSkoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9i
aik7CiB9OwogCitlbnVtIGk5MTVfbW1hcF90eXBlIHsKKwlJOTE1X01NQVBfVFlQRV9HVFQgPSAw
LAorCUk5MTVfTU1BUF9UWVBFX1dDLAorCUk5MTVfTU1BUF9UWVBFX1dCLAorCUk5MTVfTU1BUF9U
WVBFX1VDLAorfTsKKworc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgeworCXN0cnVjdCBkcm1fZGV2
aWNlICpkZXY7CisJc3RydWN0IGRybV92bWFfb2Zmc2V0X25vZGUgdm1hX25vZGU7CisJc3RydWN0
IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7CisJZW51
bSBpOTE1X21tYXBfdHlwZSBtbWFwX3R5cGU7CisKKwlzdHJ1Y3QgbGlzdF9oZWFkIG9mZnNldDsK
K307CisKIHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0IHsKIAlzdHJ1Y3QgZHJtX2dlbV9vYmpl
Y3QgYmFzZTsKIApAQCAtMTE4LDEyICsxMzUsMTcgQEAgc3RydWN0IGRybV9pOTE1X2dlbV9vYmpl
Y3QgewogCXVuc2lnbmVkIGludCB1c2VyZmF1bHRfY291bnQ7CiAJc3RydWN0IGxpc3RfaGVhZCB1
c2VyZmF1bHRfbGluazsKIAorCS8qIFByb3RlY3RzIGFjY2VzcyB0byBtbWFwIG9mZnNldHMgKi8K
KwlzdHJ1Y3QgbXV0ZXggbW1vX2xvY2s7CisJc3RydWN0IGxpc3RfaGVhZCBtbWFwX29mZnNldHM7
CisKIAlJOTE1X1NFTEZURVNUX0RFQ0xBUkUoc3RydWN0IGxpc3RfaGVhZCBzdF9saW5rKTsKIAog
CXVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAjZGVmaW5lIEk5MTVfQk9fQUxMT0NfQ09OVElHVU9VUyBC
SVQoMCkKICNkZWZpbmUgSTkxNV9CT19BTExPQ19WT0xBVElMRSAgIEJJVCgxKQogI2RlZmluZSBJ
OTE1X0JPX0FMTE9DX0ZMQUdTIChJOTE1X0JPX0FMTE9DX0NPTlRJR1VPVVMgfCBJOTE1X0JPX0FM
TE9DX1ZPTEFUSUxFKQorI2RlZmluZSBJOTE1X0JPX1JFQURPTkxZICAgICAgICAgQklUKDIpCiAK
IAkvKgogCSAqIElzIHRoZSBvYmplY3QgdG8gYmUgbWFwcGVkIGFzIHJlYWQtb25seSB0byB0aGUg
R1BVCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcGFnZXMu
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jCmluZGV4IGY0MDJj
MmM0MTVjMi4uNzUxOTdjYTY5NmE4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fcGFnZXMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fcGFnZXMuYwpAQCAtOCw2ICs4LDcgQEAKICNpbmNsdWRlICJpOTE1X2dlbV9vYmplY3QuaCIK
ICNpbmNsdWRlICJpOTE1X3NjYXR0ZXJsaXN0LmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1fbG1lbS5o
IgorI2luY2x1ZGUgImk5MTVfZ2VtX21tYW4uaCIKIAogdm9pZCBfX2k5MTVfZ2VtX29iamVjdF9z
ZXRfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAkJCQkgc3RydWN0IHNn
X3RhYmxlICpwYWdlcywKQEAgLTIwNyw2ICsyMDgsOCBAQCBpbnQgX19pOTE1X2dlbV9vYmplY3Rf
cHV0X3BhZ2VzKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJCWdvdG8gdW5sb2Nr
OwogCX0KIAorCWk5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfb2Zmc2V0KG9iaik7CisKIAkv
KgogCSAqIC0+cHV0X3BhZ2VzIG1pZ2h0IG5lZWQgdG8gYWxsb2NhdGUgbWVtb3J5IGZvciB0aGUg
Yml0MTcgc3dpenpsZQogCSAqIGFycmF5LCBoZW5jZSBwcm90ZWN0IHRoZW0gZnJvbSBiZWluZyBy
ZWFwZWQgYnkgcmVtb3ZpbmcgdGhlbSBmcm9tIGd0dApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3RpbGluZy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX3RpbGluZy5jCmluZGV4IDFmYTU5MmQ4MmFmNS4uNmM3ODI1YTJkYzJhIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdGlsaW5nLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3RpbGluZy5jCkBAIC0xMSw2ICsxMSw3
IEBACiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRlICJpOTE1X2dlbS5oIgogI2luY2x1
ZGUgImk5MTVfZ2VtX2lvY3Rscy5oIgorI2luY2x1ZGUgImk5MTVfZ2VtX21tYW4uaCIKICNpbmNs
dWRlICJpOTE1X2dlbV9vYmplY3QuaCIKIAogLyoqCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jCmluZGV4IDZjZTkxNjdmOGM5Zi4uZDE3
MTE4ZjcwYWU3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3Rz
L2k5MTVfZ2VtX21tYW4uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3Rz
L2k5MTVfZ2VtX21tYW4uYwpAQCAtNTY1LDE2ICs1NjUsMTYgQEAgc3RhdGljIGJvb2wgYXNzZXJ0
X21tYXBfb2Zmc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJICAgICAgIGlu
dCBleHBlY3RlZCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwotCWludCBl
cnI7CisJc3RydWN0IGk5MTVfbW1hcF9vZmZzZXQgKm1tbzsKIAogCW9iaiA9IGk5MTVfZ2VtX29i
amVjdF9jcmVhdGVfaW50ZXJuYWwoaTkxNSwgc2l6ZSk7CiAJaWYgKElTX0VSUihvYmopKQogCQly
ZXR1cm4gUFRSX0VSUihvYmopOwogCi0JZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9iaik7CisJ
bW1vID0gbW1hcF9vZmZzZXRfYXR0YWNoKG9iaiwgSTkxNV9NTUFQX09GRlNFVF9HVFQsIE5VTEwp
OwogCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIAotCXJldHVybiBlcnIgPT0gZXhwZWN0ZWQ7
CisJcmV0dXJuIFBUUl9FUlJfT1JfWkVSTyhtbW8pID09IGV4cGVjdGVkOwogfQogCiBzdGF0aWMg
dm9pZCBkaXNhYmxlX3JldGlyZV93b3JrZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUp
CkBAIC02MDksNiArNjA5LDcgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9vZmZzZXRfZXhoYXVzdGlv
bih2b2lkICphcmcpCiAJc3RydWN0IGRybV9tbSAqbW0gPSAmaTkxNS0+ZHJtLnZtYV9vZmZzZXRf
bWFuYWdlci0+dm1fYWRkcl9zcGFjZV9tbTsKIAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAq
b2JqOwogCXN0cnVjdCBkcm1fbW1fbm9kZSAqaG9sZSwgKm5leHQ7CisJc3RydWN0IGk5MTVfbW1h
cF9vZmZzZXQgKm1tbzsKIAlpbnQgbG9vcCwgZXJyOwogCiAJLyogRGlzYWJsZSBiYWNrZ3JvdW5k
IHJlYXBlciAqLwpAQCAtNjczLDkgKzY3NCwxMCBAQCBzdGF0aWMgaW50IGlndF9tbWFwX29mZnNl
dF9leGhhdXN0aW9uKHZvaWQgKmFyZykKIAkJZ290byBvdXQ7CiAJfQogCi0JZXJyID0gY3JlYXRl
X21tYXBfb2Zmc2V0KG9iaik7Ci0JaWYgKGVycikgeworCW1tbyA9IG1tYXBfb2Zmc2V0X2F0dGFj
aChvYmosIEk5MTVfTU1BUF9PRkZTRVRfR1RULCBOVUxMKTsKKwlpZiAoSVNfRVJSKG1tbykpIHsK
IAkJcHJfZXJyKCJVbmFibGUgdG8gaW5zZXJ0IG9iamVjdCBpbnRvIHJlY2xhaW1lZCBob2xlXG4i
KTsKKwkJZXJyID0gUFRSX0VSUihtbW8pOwogCQlnb3RvIGVycl9vYmo7CiAJfQogCkBAIC03MjQs
MTAgKzcyNiwxMSBAQCBzdGF0aWMgaW50IGlndF9tbWFwX29mZnNldF9leGhhdXN0aW9uKHZvaWQg
KmFyZykKIH0KIAogI2RlZmluZSBleHBhbmQzMih4KSAoKCh4KSA8PCAwKSB8ICgoeCkgPDwgOCkg
fCAoKHgpIDw8IDE2KSB8ICgoeCkgPDwgMjQpKQotc3RhdGljIGludCBpZ3RfbW1hcF9ndHQodm9p
ZCAqYXJnKQorc3RhdGljIGludCBpZ3RfbW1hcCh2b2lkICphcmcsIGVudW0gaTkxNV9tbWFwX3R5
cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKIAlzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICpt
bW87CiAJc3RydWN0IHZtX2FyZWFfc3RydWN0ICphcmVhOwogCXVuc2lnbmVkIGxvbmcgYWRkcjsK
IAl2b2lkICp2YWRkcjsKQEAgLTc0OSwxOCArNzUyLDE5IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBf
Z3R0KHZvaWQgKmFyZykKIAlpOTE1X2dlbV9vYmplY3RfZmx1c2hfbWFwKG9iaik7CiAJaTkxNV9n
ZW1fb2JqZWN0X3VucGluX21hcChvYmopOwogCi0JZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9i
aik7Ci0JaWYgKGVycikKKwltbW8gPSBtbWFwX29mZnNldF9hdHRhY2gob2JqLCB0eXBlLCBOVUxM
KTsKKwlpZiAoSVNfRVJSKG1tbykpIHsKKwkJZXJyID0gUFRSX0VSUihtbW8pOwogCQlnb3RvIG91
dDsKKwl9CiAKLQlhZGRyID0gaWd0X21tYXBfbm9kZShpOTE1LCAmb2JqLT5iYXNlLnZtYV9ub2Rl
LAotCQkJICAgICAwLCBQUk9UX1dSSVRFLCBNQVBfU0hBUkVEKTsKKwlhZGRyID0gaWd0X21tYXBf
bm9kZShpOTE1LCAmbW1vLT52bWFfbm9kZSwgMCwgUFJPVF9XUklURSwgTUFQX1NIQVJFRCk7CiAJ
aWYgKElTX0VSUl9WQUxVRShhZGRyKSkgewogCQllcnIgPSBhZGRyOwogCQlnb3RvIG91dDsKIAl9
CiAKLQlwcl9kZWJ1ZygiaWd0X21tYXAob2JqOmd0dCkgQCAlbHhcbiIsIGFkZHIpOworCXByX2Rl
YnVnKCJpZ3RfbW1hcCgpIEAgJWx4XG4iLCBhZGRyKTsKIAogCWFyZWEgPSBmaW5kX3ZtYShjdXJy
ZW50LT5tbSwgYWRkcik7CiAJaWYgKCFhcmVhKSB7CkBAIC03NjksOCArNzczLDggQEAgc3RhdGlj
IGludCBpZ3RfbW1hcF9ndHQodm9pZCAqYXJnKQogCQlnb3RvIG91dF91bm1hcDsKIAl9CiAKLQlp
ZiAoYXJlYS0+dm1fcHJpdmF0ZV9kYXRhICE9IG9iaikgewotCQlwcl9lcnIoInZtX2FyZWFfc3Ry
dWN0IGRpZCBub3QgcG9pbnQgYmFjayB0byBvdXIgb2JqZWN0IVxuIik7CisJaWYgKGFyZWEtPnZt
X3ByaXZhdGVfZGF0YSAhPSBtbW8pIHsKKwkJcHJfZXJyKCJ2bV9hcmVhX3N0cnVjdCBkaWQgbm90
IHBvaW50IGJhY2sgdG8gb3VyIG1tYXBfb2Zmc2V0IG9iamVjdCFcbiIpOwogCQllcnIgPSAtRUlO
VkFMOwogCQlnb3RvIG91dF91bm1hcDsKIAl9CkBAIC03ODAsMTQgKzc4NCwxNCBAQCBzdGF0aWMg
aW50IGlndF9tbWFwX2d0dCh2b2lkICphcmcpCiAJCXUzMiB4OwogCiAJCWlmIChnZXRfdXNlcih4
LCB1eCkpIHsKLQkJCXByX2VycigiVW5hYmxlIHRvIHJlYWQgZnJvbSBHVFQgbW1hcCwgb2Zmc2V0
OiV6ZFxuIiwKKwkJCXByX2VycigiVW5hYmxlIHRvIHJlYWQgZnJvbSBtbWFwLCBvZmZzZXQ6JXpk
XG4iLAogCQkJICAgICAgIGkgKiBzaXplb2YoeCkpOwogCQkJZXJyID0gLUVGQVVMVDsKIAkJCWJy
ZWFrOwogCQl9CiAKIAkJaWYgKHggIT0gZXhwYW5kMzIoUE9JU09OX0lOVVNFKSkgewotCQkJcHJf
ZXJyKCJSZWFkIGluY29ycmVjdCB2YWx1ZSBmcm9tIEdUVCBtbWFwLCBvZmZzZXQ6JXpkLCBmb3Vu
ZDoleCwgZXhwZWN0ZWQ6JXhcbiIsCisJCQlwcl9lcnIoIlJlYWQgaW5jb3JyZWN0IHZhbHVlIGZy
b20gbW1hcCwgb2Zmc2V0OiV6ZCwgZm91bmQ6JXgsIGV4cGVjdGVkOiV4XG4iLAogCQkJICAgICAg
IGkgKiBzaXplb2YoeCksIHgsIGV4cGFuZDMyKFBPSVNPTl9JTlVTRSkpOwogCQkJZXJyID0gLUVJ
TlZBTDsKIAkJCWJyZWFrOwpAQCAtNzk1LDcgKzc5OSw3IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBf
Z3R0KHZvaWQgKmFyZykKIAogCQl4ID0gZXhwYW5kMzIoUE9JU09OX0ZSRUUpOwogCQlpZiAocHV0
X3VzZXIoeCwgdXgpKSB7Ci0JCQlwcl9lcnIoIlVuYWJsZSB0byB3cml0ZSB0byBHVFQgbW1hcCwg
b2Zmc2V0OiV6ZFxuIiwKKwkJCXByX2VycigiVW5hYmxlIHRvIHdyaXRlIHRvIG1tYXAsIG9mZnNl
dDolemRcbiIsCiAJCQkgICAgICAgaSAqIHNpemVvZih4KSk7CiAJCQllcnIgPSAtRUZBVUxUOwog
CQkJYnJlYWs7CkBAIC04MTEsNyArODE1LDcgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9ndHQodm9p
ZCAqYXJnKQogCQlnb3RvIG91dDsKIAl9CiAJaWYgKGVyciA9PSAwICYmIG1lbWNocl9pbnYodmFk
ZHIsIFBPSVNPTl9GUkVFLCBQQUdFX1NJWkUpKSB7Ci0JCXByX2VycigiV3JpdGUgdmlhIEdHVFQg
bW1hcCBkaWQgbm90IGxhbmQgaW4gYmFja2luZyBzdG9yZVxuIik7CisJCXByX2VycigiV3JpdGUg
dmlhIG1tYXAgZGlkIG5vdCBsYW5kIGluIGJhY2tpbmcgc3RvcmVcbiIpOwogCQllcnIgPSAtRUlO
VkFMOwogCX0KIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKG9iaik7CkBAIC04MjEsNiArODI1
LDE2IEBAIHN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0KHZvaWQgKmFyZykKIAlyZXR1cm4gZXJyOwog
fQogCitzdGF0aWMgaW50IGlndF9tbWFwX2d0dCh2b2lkICphcmcpCit7CisJcmV0dXJuIGlndF9t
bWFwKGFyZywgSTkxNV9NTUFQX1RZUEVfR1RUKTsKK30KKworc3RhdGljIGludCBpZ3RfbW1hcF9j
cHUodm9pZCAqYXJnKQoreworCXJldHVybiBpZ3RfbW1hcChhcmcsIEk5MTVfTU1BUF9UWVBFX1dD
KTsKK30KKwogc3RhdGljIGludCBjaGVja19wcmVzZW50X3B0ZShwdGVfdCAqcHRlLCB1bnNpZ25l
ZCBsb25nIGFkZHIsIHZvaWQgKmRhdGEpCiB7CiAJaWYgKCFwdGVfcHJlc2VudCgqcHRlKSB8fCBw
dGVfbm9uZSgqcHRlKSkgewpAQCAtODczLDEwICs4ODcsMTEgQEAgc3RhdGljIGludCBwcmVmYXVs
dF9yYW5nZSh1NjQgc3RhcnQsIHU2NCBsZW4pCiAJcmV0dXJuIF9fZ2V0X3VzZXIoYywgZW5kIC0g
MSk7CiB9CiAKLXN0YXRpYyBpbnQgaWd0X21tYXBfZ3R0X3Jldm9rZSh2b2lkICphcmcpCitzdGF0
aWMgaW50IGlndF9tbWFwX3Jldm9rZSh2b2lkICphcmcsIGVudW0gaTkxNV9tbWFwX3R5cGUgdHlw
ZSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGFyZzsKIAlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqOworCXN0cnVjdCBpOTE1X21tYXBfb2Zmc2V0ICptbW87CiAJ
dW5zaWduZWQgbG9uZyBhZGRyOwogCWludCBlcnI7CiAKQEAgLTg4NywxMiArOTAyLDEzIEBAIHN0
YXRpYyBpbnQgaWd0X21tYXBfZ3R0X3Jldm9rZSh2b2lkICphcmcpCiAJaWYgKElTX0VSUihvYmop
KQogCQlyZXR1cm4gUFRSX0VSUihvYmopOwogCi0JZXJyID0gY3JlYXRlX21tYXBfb2Zmc2V0KG9i
aik7Ci0JaWYgKGVycikKKwltbW8gPSBtbWFwX29mZnNldF9hdHRhY2gob2JqLCB0eXBlLCBOVUxM
KTsKKwlpZiAoSVNfRVJSKG1tbykpIHsKKwkJZXJyID0gUFRSX0VSUihtbW8pOwogCQlnb3RvIG91
dDsKKwl9CiAKLQlhZGRyID0gaWd0X21tYXBfbm9kZShpOTE1LCAmb2JqLT5iYXNlLnZtYV9ub2Rl
LAotCQkJICAgICAwLCBQUk9UX1dSSVRFLCBNQVBfU0hBUkVEKTsKKwlhZGRyID0gaWd0X21tYXBf
bm9kZShpOTE1LCAmbW1vLT52bWFfbm9kZSwgMCwgUFJPVF9XUklURSwgTUFQX1NIQVJFRCk7CiAJ
aWYgKElTX0VSUl9WQUxVRShhZGRyKSkgewogCQllcnIgPSBhZGRyOwogCQlnb3RvIG91dDsKQEAg
LTkwMiw3ICs5MTgsOCBAQCBzdGF0aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uodm9pZCAqYXJn
KQogCWlmIChlcnIpCiAJCWdvdG8gb3V0X3VubWFwOwogCi0JR0VNX0JVR19PTighYXRvbWljX3Jl
YWQoJm9iai0+YmluZF9jb3VudCkpOworCUdFTV9CVUdfT04obW1vLT5tbWFwX3R5cGUgPT0gSTkx
NV9NTUFQX1RZUEVfR1RUICYmCisJCSAgICFhdG9taWNfcmVhZCgmb2JqLT5iaW5kX2NvdW50KSk7
CiAKIAllcnIgPSBjaGVja19wcmVzZW50KGFkZHIsIG9iai0+YmFzZS5zaXplKTsKIAlpZiAoZXJy
KQpAQCAtOTIwLDYgKzkzNywxNSBAQCBzdGF0aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uodm9p
ZCAqYXJnKQogCX0KIAlHRU1fQlVHX09OKGF0b21pY19yZWFkKCZvYmotPmJpbmRfY291bnQpKTsK
IAorCWlmICh0eXBlICE9IEk5MTVfTU1BUF9UWVBFX0dUVCkgeworCQlfX2k5MTVfZ2VtX29iamVj
dF9wdXRfcGFnZXMob2JqKTsKKwkJaWYgKGk5MTVfZ2VtX29iamVjdF9oYXNfcGFnZXMob2JqKSkg
eworCQkJcHJfZXJyKCJGYWlsZWQgdG8gcHV0LXBhZ2VzIG9iamVjdCFcbiIpOworCQkJZXJyID0g
LUVJTlZBTDsKKwkJCWdvdG8gb3V0X3VubWFwOworCQl9CisJfQorCiAJZXJyID0gY2hlY2tfYWJz
ZW50KGFkZHIsIG9iai0+YmFzZS5zaXplKTsKIAlpZiAoZXJyKQogCQlnb3RvIG91dF91bm1hcDsK
QEAgLTkzMSw2ICs5NTcsMTYgQEAgc3RhdGljIGludCBpZ3RfbW1hcF9ndHRfcmV2b2tlKHZvaWQg
KmFyZykKIAlyZXR1cm4gZXJyOwogfQogCitzdGF0aWMgaW50IGlndF9tbWFwX2d0dF9yZXZva2Uo
dm9pZCAqYXJnKQoreworCXJldHVybiBpZ3RfbW1hcF9yZXZva2UoYXJnLCBJOTE1X01NQVBfVFlQ
RV9HVFQpOworfQorCitzdGF0aWMgaW50IGlndF9tbWFwX2NwdV9yZXZva2Uodm9pZCAqYXJnKQor
eworCXJldHVybiBpZ3RfbW1hcF9yZXZva2UoYXJnLCBJOTE1X01NQVBfVFlQRV9XQyk7Cit9CisK
IGludCBpOTE1X2dlbV9tbWFuX2xpdmVfc2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQogewogCXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9zdWJ0ZXN0IHRlc3RzW10gPSB7
CkBAIC05MzgsNyArOTc0LDkgQEAgaW50IGk5MTVfZ2VtX21tYW5fbGl2ZV9zZWxmdGVzdHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJCVNVQlRFU1QoaWd0X3Ntb2tlX3RpbGluZyks
CiAJCVNVQlRFU1QoaWd0X21tYXBfb2Zmc2V0X2V4aGF1c3Rpb24pLAogCQlTVUJURVNUKGlndF9t
bWFwX2d0dCksCisJCVNVQlRFU1QoaWd0X21tYXBfY3B1KSwKIAkJU1VCVEVTVChpZ3RfbW1hcF9n
dHRfcmV2b2tlKSwKKwkJU1VCVEVTVChpZ3RfbW1hcF9jcHVfcmV2b2tlKSwKIAl9OwogCiAJcmV0
dXJuIGk5MTVfc3VidGVzdHModGVzdHMsIGk5MTUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X3Jlc2V0LmMKaW5kZXggMzYxODkyMzhlMTNjLi4wZTk0YjcyMGM5OTMgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwpAQCAtNjc4LDggKzY3OCwxMyBAQCBzdGF0aWMgdm9pZCBy
ZXZva2VfbW1hcHMoc3RydWN0IGludGVsX2d0ICpndCkKIAkJCWNvbnRpbnVlOwogCiAJCUdFTV9C
VUdfT04odm1hLT5mZW5jZSAhPSAmZ3QtPmdndHQtPmZlbmNlX3JlZ3NbaV0pOwotCQlub2RlID0g
JnZtYS0+b2JqLT5iYXNlLnZtYV9ub2RlOworCisJCWlmICghdm1hLT5tbW8pCisJCQljb250aW51
ZTsKKworCQlub2RlID0gJnZtYS0+bW1vLT52bWFfbm9kZTsKIAkJdm1hX29mZnNldCA9IHZtYS0+
Z2d0dF92aWV3LnBhcnRpYWwub2Zmc2V0IDw8IFBBR0VfU0hJRlQ7CisKIAkJdW5tYXBfbWFwcGlu
Z19yYW5nZShndC0+aTkxNS0+ZHJtLmFub25faW5vZGUtPmlfbWFwcGluZywKIAkJCQkgICAgZHJt
X3ZtYV9ub2RlX29mZnNldF9hZGRyKG5vZGUpICsgdm1hX29mZnNldCwKIAkJCQkgICAgdm1hLT5z
aXplLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKaW5kZXggZjUwOWQ4MjZmY2M3Li45NDBhODkwN2Yz
ZTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwpAQCAtNjEsNiArNjEsNyBAQAogCiAjaW5jbHVk
ZSAiZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCIKICNpbmNsdWRlICJnZW0vaTkxNV9nZW1faW9jdGxz
LmgiCisjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX21tYW4uaCIKICNpbmNsdWRlICJndC9pbnRlbF9n
dC5oIgogI2luY2x1ZGUgImd0L2ludGVsX2d0X3BtLmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfcmM2
LmgiCkBAIC0yNjYyLDE4ICsyNjYzLDEyIEBAIGNvbnN0IHN0cnVjdCBkZXZfcG1fb3BzIGk5MTVf
cG1fb3BzID0gewogCS5ydW50aW1lX3Jlc3VtZSA9IGludGVsX3J1bnRpbWVfcmVzdW1lLAogfTsK
IAotc3RhdGljIGNvbnN0IHN0cnVjdCB2bV9vcGVyYXRpb25zX3N0cnVjdCBpOTE1X2dlbV92bV9v
cHMgPSB7Ci0JLmZhdWx0ID0gaTkxNV9nZW1fZmF1bHQsCi0JLm9wZW4gPSBkcm1fZ2VtX3ZtX29w
ZW4sCi0JLmNsb3NlID0gZHJtX2dlbV92bV9jbG9zZSwKLX07Ci0KIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgZmlsZV9vcGVyYXRpb25zIGk5MTVfZHJpdmVyX2ZvcHMgPSB7CiAJLm93bmVyID0gVEhJU19N
T0RVTEUsCiAJLm9wZW4gPSBkcm1fb3BlbiwKIAkucmVsZWFzZSA9IGRybV9yZWxlYXNlLAogCS51
bmxvY2tlZF9pb2N0bCA9IGRybV9pb2N0bCwKLQkubW1hcCA9IGRybV9nZW1fbW1hcCwKKwkubW1h
cCA9IGk5MTVfZ2VtX21tYXAsCiAJLnBvbGwgPSBkcm1fcG9sbCwKIAkucmVhZCA9IGRybV9yZWFk
LAogCS5jb21wYXRfaW9jdGwgPSBpOTE1X2NvbXBhdF9pb2N0bCwKQEAgLTI3MjAsNyArMjcxNSw3
IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2lvY3RsX2Rlc2MgaTkxNV9pb2N0bHNbXSA9IHsK
IAlEUk1fSU9DVExfREVGX0RSVihJOTE1X0dFTV9QUkVBRCwgaTkxNV9nZW1fcHJlYWRfaW9jdGws
IERSTV9SRU5ERVJfQUxMT1cpLAogCURSTV9JT0NUTF9ERUZfRFJWKEk5MTVfR0VNX1BXUklURSwg
aTkxNV9nZW1fcHdyaXRlX2lvY3RsLCBEUk1fUkVOREVSX0FMTE9XKSwKIAlEUk1fSU9DVExfREVG
X0RSVihJOTE1X0dFTV9NTUFQLCBpOTE1X2dlbV9tbWFwX2lvY3RsLCBEUk1fUkVOREVSX0FMTE9X
KSwKLQlEUk1fSU9DVExfREVGX0RSVihJOTE1X0dFTV9NTUFQX0dUVCwgaTkxNV9nZW1fbW1hcF9n
dHRfaW9jdGwsIERSTV9SRU5ERVJfQUxMT1cpLAorCURSTV9JT0NUTF9ERUZfRFJWKEk5MTVfR0VN
X01NQVBfT0ZGU0VULCBpOTE1X2dlbV9tbWFwX29mZnNldF9pb2N0bCwgRFJNX1JFTkRFUl9BTExP
VyksCiAJRFJNX0lPQ1RMX0RFRl9EUlYoSTkxNV9HRU1fU0VUX0RPTUFJTiwgaTkxNV9nZW1fc2V0
X2RvbWFpbl9pb2N0bCwgRFJNX1JFTkRFUl9BTExPVyksCiAJRFJNX0lPQ1RMX0RFRl9EUlYoSTkx
NV9HRU1fU1dfRklOSVNILCBpOTE1X2dlbV9zd19maW5pc2hfaW9jdGwsIERSTV9SRU5ERVJfQUxM
T1cpLAogCURSTV9JT0NUTF9ERUZfRFJWKEk5MTVfR0VNX1NFVF9USUxJTkcsIGk5MTVfZ2VtX3Nl
dF90aWxpbmdfaW9jdGwsIERSTV9SRU5ERVJfQUxMT1cpLApAQCAtMjc2Miw3ICsyNzU3LDYgQEAg
c3RhdGljIHN0cnVjdCBkcm1fZHJpdmVyIGRyaXZlciA9IHsKIAogCS5nZW1fY2xvc2Vfb2JqZWN0
ID0gaTkxNV9nZW1fY2xvc2Vfb2JqZWN0LAogCS5nZW1fZnJlZV9vYmplY3RfdW5sb2NrZWQgPSBp
OTE1X2dlbV9mcmVlX29iamVjdCwKLQkuZ2VtX3ZtX29wcyA9ICZpOTE1X2dlbV92bV9vcHMsCiAK
IAkucHJpbWVfaGFuZGxlX3RvX2ZkID0gZHJtX2dlbV9wcmltZV9oYW5kbGVfdG9fZmQsCiAJLnBy
aW1lX2ZkX3RvX2hhbmRsZSA9IGRybV9nZW1fcHJpbWVfZmRfdG9faGFuZGxlLApAQCAtMjc3Myw3
ICsyNzY3LDggQEAgc3RhdGljIHN0cnVjdCBkcm1fZHJpdmVyIGRyaXZlciA9IHsKIAkuZ2V0X3Nj
YW5vdXRfcG9zaXRpb24gPSBpOTE1X2dldF9jcnRjX3NjYW5vdXRwb3MsCiAKIAkuZHVtYl9jcmVh
dGUgPSBpOTE1X2dlbV9kdW1iX2NyZWF0ZSwKLQkuZHVtYl9tYXBfb2Zmc2V0ID0gaTkxNV9nZW1f
bW1hcF9ndHQsCisJLmR1bWJfbWFwX29mZnNldCA9IGk5MTVfZ2VtX2R1bWJfbW1hcF9vZmZzZXQs
CisKIAkuaW9jdGxzID0gaTkxNV9pb2N0bHMsCiAJLm51bV9pb2N0bHMgPSBBUlJBWV9TSVpFKGk5
MTVfaW9jdGxzKSwKIAkuZm9wcyA9ICZpOTE1X2RyaXZlcl9mb3BzLApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmgKaW5kZXggMTQ3NDRjMTE0NDc1Li4wZDRhZDE4ZTEwZGQgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuaApAQCAtMTg1Nyw5ICsxODU3LDYgQEAgaTkxNV9tdXRleF9sb2NrX2ludGVycnVwdGli
bGUoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIGludCBpOTE1X2dlbV9kdW1iX2NyZWF0ZShzdHJ1
Y3QgZHJtX2ZpbGUgKmZpbGVfcHJpdiwKIAkJCSBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LAogCQkJ
IHN0cnVjdCBkcm1fbW9kZV9jcmVhdGVfZHVtYiAqYXJncyk7Ci1pbnQgaTkxNV9nZW1fbW1hcF9n
dHQoc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYsIHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCi0J
CSAgICAgIHUzMiBoYW5kbGUsIHU2NCAqb2Zmc2V0KTsKLWludCBpOTE1X2dlbV9tbWFwX2d0dF92
ZXJzaW9uKHZvaWQpOwogCiBpbnQgX19tdXN0X2NoZWNrIGk5MTVfZ2VtX3NldF9nbG9iYWxfc2Vx
bm8oc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdTMyIHNlcW5vKTsKIApAQCAtMTg4Miw3ICsxODc5
LDYgQEAgdm9pZCBpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwogdm9pZCBpOTE1X2dlbV9zdXNwZW5kKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7CiB2b2lkIGk5MTVfZ2VtX3N1c3BlbmRfbGF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBpOTE1X2dlbV9yZXN1bWUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZtX2ZhdWx0X3QgaTkxNV9nZW1fZmF1bHQoc3RydWN0
IHZtX2ZhdWx0ICp2bWYpOwogCiBpbnQgaTkxNV9nZW1fb3BlbihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwgc3RydWN0IGRybV9maWxlICpmaWxlKTsKIHZvaWQgaTkxNV9nZW1fcmVsZWFz
ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ2VtLmMKaW5kZXggNjEzOTViMDM0NDNlLi42NzlmYjQ2YTdjYzMgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW0uYwpAQCAtNDQsNiArNDQsNyBAQAogI2luY2x1ZGUgImdlbS9pOTE1X2dl
bV9jbGZsdXNoLmgiCiAjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCIKICNpbmNsdWRl
ICJnZW0vaTkxNV9nZW1faW9jdGxzLmgiCisjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX21tYW4uaCIK
ICNpbmNsdWRlICJnZW0vaTkxNV9nZW1fcG0uaCIKICNpbmNsdWRlICJndC9pbnRlbF9jb250ZXh0
LmgiCiAjaW5jbHVkZSAiZ3QvaW50ZWxfZW5naW5lX3VzZXIuaCIKQEAgLTg1NSw3ICs4NTYsNyBA
QCB2b2lkIGk5MTVfZ2VtX3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKIAogCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShvYmosIG9uLAogCQkJCSAmaTkxNS0+
Z2d0dC51c2VyZmF1bHRfbGlzdCwgdXNlcmZhdWx0X2xpbmspCi0JCV9faTkxNV9nZW1fb2JqZWN0
X3JlbGVhc2VfbW1hcChvYmopOworCQlfX2k5MTVfZ2VtX29iamVjdF9yZWxlYXNlX21tYXBfZ3R0
KG9iaik7CiAKIAkvKgogCSAqIFRoZSBmZW5jZSB3aWxsIGJlIGxvc3Qgd2hlbiB0aGUgZGV2aWNl
IHBvd2VycyBkb3duLiBJZiBhbnkgd2VyZQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9nZXRwYXJhbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZXRwYXJhbS5j
CmluZGV4IGNmOGE4YzNlZjA0Ny4uNTRmY2U4MWQ1NzI0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dldHBhcmFtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9nZXRwYXJhbS5jCkBAIC0yLDYgKzIsNyBAQAogICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6
IE1JVAogICovCiAKKyNpbmNsdWRlICJnZW0vaTkxNV9nZW1fbW1hbi5oIgogI2luY2x1ZGUgImd0
L2ludGVsX2VuZ2luZV91c2VyLmgiCiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfdm1hLmMKaW5kZXggZTU1MTJmMjZlMjBhLi41MTA4ZGNiMmU1YjEgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV92bWEuYwpAQCAtMTA1NCw3ICsxMDU0LDcgQEAgc3RhdGljIHZvaWQgX19pOTE1X3Zt
YV9pb3VubWFwKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogCiB2b2lkIGk5MTVfdm1hX3Jldm9rZV9t
bWFwKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogewotCXN0cnVjdCBkcm1fdm1hX29mZnNldF9ub2Rl
ICpub2RlID0gJnZtYS0+b2JqLT5iYXNlLnZtYV9ub2RlOworCXN0cnVjdCBkcm1fdm1hX29mZnNl
dF9ub2RlICpub2RlOwogCXU2NCB2bWFfb2Zmc2V0OwogCiAJbG9ja2RlcF9hc3NlcnRfaGVsZCgm
dm1hLT52bS0+bXV0ZXgpOwpAQCAtMTA2NSw2ICsxMDY1LDcgQEAgdm9pZCBpOTE1X3ZtYV9yZXZv
a2VfbW1hcChzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKIAlHRU1fQlVHX09OKCFpOTE1X3ZtYV9pc19t
YXBfYW5kX2ZlbmNlYWJsZSh2bWEpKTsKIAlHRU1fQlVHX09OKCF2bWEtPm9iai0+dXNlcmZhdWx0
X2NvdW50KTsKIAorCW5vZGUgPSAmdm1hLT5tbW8tPnZtYV9ub2RlOwogCXZtYV9vZmZzZXQgPSB2
bWEtPmdndHRfdmlldy5wYXJ0aWFsLm9mZnNldCA8PCBQQUdFX1NISUZUOwogCXVubWFwX21hcHBp
bmdfcmFuZ2Uodm1hLT52bS0+aTkxNS0+ZHJtLmFub25faW5vZGUtPmlfbWFwcGluZywKIAkJCSAg
ICBkcm1fdm1hX25vZGVfb2Zmc2V0X2FkZHIobm9kZSkgKyB2bWFfb2Zmc2V0LApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfdm1hLmgKaW5kZXggNDY1OTMyODEzYmM1Li5mMDlmNGY1MTNjNDEgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV92bWEuaApAQCAtNjMsNiArNjMsOSBAQCBzdHJ1Y3QgaTkxNV92bWEgewogCXU2NCBk
aXNwbGF5X2FsaWdubWVudDsKIAlzdHJ1Y3QgaTkxNV9wYWdlX3NpemVzIHBhZ2Vfc2l6ZXM7CiAK
KwkvKiBtbWFwLW9mZnNldCBhc3NvY2lhdGVkIHdpdGggZmVuY2luZyBmb3IgdGhpcyB2bWEgKi8K
KwlzdHJ1Y3QgaTkxNV9tbWFwX29mZnNldAkqbW1vOworCiAJdTMyIGZlbmNlX3NpemU7CiAJdTMy
IGZlbmNlX2FsaWdubWVudDsKIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBpL2RybS9pOTE1X2Ry
bS5oIGIvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCmluZGV4IDU0MDBkN2UwNTdmMS4uMDgx
Mjc0ODc5NTEyIDEwMDY0NAotLS0gYS9pbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmgKKysrIGIv
aW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCkBAIC0zOTUsNiArMzk1LDcgQEAgdHlwZWRlZiBz
dHJ1Y3QgX2RybV9pOTE1X3NhcmVhIHsKICNkZWZpbmUgRFJNX0lPQ1RMX0k5MTVfR0VNX1BXUklU
RQlEUk1fSU9XIChEUk1fQ09NTUFORF9CQVNFICsgRFJNX0k5MTVfR0VNX1BXUklURSwgc3RydWN0
IGRybV9pOTE1X2dlbV9wd3JpdGUpCiAjZGVmaW5lIERSTV9JT0NUTF9JOTE1X0dFTV9NTUFQCQlE
Uk1fSU9XUihEUk1fQ09NTUFORF9CQVNFICsgRFJNX0k5MTVfR0VNX01NQVAsIHN0cnVjdCBkcm1f
aTkxNV9nZW1fbW1hcCkKICNkZWZpbmUgRFJNX0lPQ1RMX0k5MTVfR0VNX01NQVBfR1RUCURSTV9J
T1dSKERSTV9DT01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1fTU1BUF9HVFQsIHN0cnVjdCBkcm1f
aTkxNV9nZW1fbW1hcF9ndHQpCisjZGVmaW5lIERSTV9JT0NUTF9JOTE1X0dFTV9NTUFQX09GRlNF
VAlEUk1fSU9XUihEUk1fQ09NTUFORF9CQVNFICsgRFJNX0k5MTVfR0VNX01NQVBfR1RULCBzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX21tYXBfb2Zmc2V0KQogI2RlZmluZSBEUk1fSU9DVExfSTkxNV9HRU1f
U0VUX0RPTUFJTglEUk1fSU9XIChEUk1fQ09NTUFORF9CQVNFICsgRFJNX0k5MTVfR0VNX1NFVF9E
T01BSU4sIHN0cnVjdCBkcm1faTkxNV9nZW1fc2V0X2RvbWFpbikKICNkZWZpbmUgRFJNX0lPQ1RM
X0k5MTVfR0VNX1NXX0ZJTklTSAlEUk1fSU9XIChEUk1fQ09NTUFORF9CQVNFICsgRFJNX0k5MTVf
R0VNX1NXX0ZJTklTSCwgc3RydWN0IGRybV9pOTE1X2dlbV9zd19maW5pc2gpCiAjZGVmaW5lIERS
TV9JT0NUTF9JOTE1X0dFTV9TRVRfVElMSU5HCURSTV9JT1dSIChEUk1fQ09NTUFORF9CQVNFICsg
RFJNX0k5MTVfR0VNX1NFVF9USUxJTkcsIHN0cnVjdCBkcm1faTkxNV9nZW1fc2V0X3RpbGluZykK
QEAgLTc5Myw2ICs3OTQsMzcgQEAgc3RydWN0IGRybV9pOTE1X2dlbV9tbWFwX2d0dCB7CiAJX191
NjQgb2Zmc2V0OwogfTsKIAorc3RydWN0IGRybV9pOTE1X2dlbV9tbWFwX29mZnNldCB7CisJLyoq
IEhhbmRsZSBmb3IgdGhlIG9iamVjdCBiZWluZyBtYXBwZWQuICovCisJX191MzIgaGFuZGxlOwor
CV9fdTMyIHBhZDsKKwkvKioKKwkgKiBGYWtlIG9mZnNldCB0byB1c2UgZm9yIHN1YnNlcXVlbnQg
bW1hcCBjYWxsCisJICoKKwkgKiBUaGlzIGlzIGEgZml4ZWQtc2l6ZSB0eXBlIGZvciAzMi82NCBj
b21wYXRpYmlsaXR5LgorCSAqLworCV9fdTY0IG9mZnNldDsKKworCS8qKgorCSAqIEZsYWdzIGZv
ciBleHRlbmRlZCBiZWhhdmlvdXIuCisJICoKKwkgKiBJdCBpcyBtYW5kYXRvcnkgdGhhdCBlaXRo
ZXIgb25lIG9mIHRoZSBNTUFQX09GRlNFVCBmbGFncworCSAqIHNob3VsZCBiZSBwYXNzZWQgaGVy
ZS4KKwkgKi8KKwlfX3U2NCBmbGFnczsKKyNkZWZpbmUgSTkxNV9NTUFQX09GRlNFVF9HVFQgMAor
I2RlZmluZSBJOTE1X01NQVBfT0ZGU0VUX1dDICAxCisjZGVmaW5lIEk5MTVfTU1BUF9PRkZTRVRf
V0IgIDIKKyNkZWZpbmUgSTkxNV9NTUFQX09GRlNFVF9VQyAgMworCisJLyoKKwkgKiBaZXJvLXRl
cm1pbmF0ZWQgY2hhaW4gb2YgZXh0ZW5zaW9ucy4KKwkgKgorCSAqIE5vIGN1cnJlbnQgZXh0ZW5z
aW9ucyBkZWZpbmVkOyBtYnouCisJICovCisJX191NjQgZXh0ZW5zaW9uczsKK307CisKIHN0cnVj
dCBkcm1faTkxNV9nZW1fc2V0X2RvbWFpbiB7CiAJLyoqIEhhbmRsZSBmb3IgdGhlIG9iamVjdCAq
LwogCV9fdTMyIGhhbmRsZTsKLS0gCjIuMjQuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 342B04C339
	for <lists+intel-gfx@lfdr.de>; Wed, 19 Jun 2019 23:44:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 829626E47B;
	Wed, 19 Jun 2019 21:44:12 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga02.intel.com (mga02.intel.com [134.134.136.20])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5A9846E47C
 for <intel-gfx@lists.freedesktop.org>; Wed, 19 Jun 2019 21:44:11 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by orsmga101.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 19 Jun 2019 14:44:11 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,394,1557212400"; d="scan'208";a="153925260"
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by orsmga008.jf.intel.com with ESMTP; 19 Jun 2019 14:44:11 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 19 Jun 2019 14:43:50 -0700
Message-Id: <20190619214351.12000-2-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190619214351.12000-1-daniele.ceraolospurio@intel.com>
References: <20190619214351.12000-1-daniele.ceraolospurio@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 1/2] drm/i915/guc: reorder enable/disable
 communication steps
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

TWFrZSBzdXJlIHdlIGFsd2F5cyBoYXZlIENUIGJ1ZmZlcnMgZW5hYmxlZCB3aGVuIHRoZSBpbnRl
cnJ1cHRzIGFyZQplbmFibGVkLCBzbyB3ZSBjYW4gYWx3YXlzIGhhbmRsZSBpbnRlcnJ1cHRzIGZy
b20gR3VDLiBBbHNvIG1vdmUgdGhlCnNldHRpbmcgb2YgdGhlIGd1Yy0+c2VuZCBhbmQgZ3VjLT5o
YW5kbGVyIGZ1bmN0aW9ucyB0byB0aGUgR3VDCmNvbW11bmljYXRpb24gY29udHJvbCBmdW5jdGlv
bnMgZm9yIGNvbnNpc3RlbmN5LgoKVGhlIHJlb3JkZXIgYWxzbyBmaXhlcyB0aGUgb25pb24gdW53
aW5kaW5nIG9mIGludGVsX3VjX2luaXRfaHcsIGJlY2F1c2UKZ3VjX2VuYWJsZV9jb21tdW5pY2F0
aW9uIHdvdWxkJ3ZlIGxlZnQgaW50ZXJydXB0cyBlbmFibGVkIHdoZW4gZmFpbGluZwp0byBlbmFi
bGUgQ1RCLgoKQnVnemlsbGE6IGh0dHBzOi8vYnVncy5mcmVlZGVza3RvcC5vcmcvc2hvd19idWcu
Y2dpP2lkPTExMDk0MwpTaWduZWQtb2ZmLWJ5OiBEYW5pZWxlIENlcmFvbG8gU3B1cmlvIDxkYW5p
ZWxlLmNlcmFvbG9zcHVyaW9AaW50ZWwuY29tPgpDYzogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJp
cy13aWxzb24uY28udWs+CkNjOiBNaWNoYWwgV2FqZGVjemtvIDxtaWNoYWwud2FqZGVjemtvQGlu
dGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfY3QuYyB8IDE1ICsr
Ky0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2N0LmggfCAgNCAr
KysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91Yy5jICAgICB8IDE5ICsrKysrKysrKysr
KysrKystLS0KIDMgZmlsZXMgY2hhbmdlZCwgMjMgaW5zZXJ0aW9ucygrKSwgMTUgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2N0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfY3QuYwppbmRleCAzOTIxODA5ZjgxMmIuLjky
ZWI0MGFhZGQ5YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2N0
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2N0LmMKQEAgLTUyOSw4ICs1
MjksOCBAQCBzdGF0aWMgaW50IGN0Y2hfc2VuZChzdHJ1Y3QgaW50ZWxfZ3VjX2N0ICpjdCwKIC8q
CiAgKiBDb21tYW5kIFRyYW5zcG9ydCAoQ1QpIGJ1ZmZlciBiYXNlZCBHdUMgc2VuZCBmdW5jdGlv
bi4KICAqLwotc3RhdGljIGludCBpbnRlbF9ndWNfc2VuZF9jdChzdHJ1Y3QgaW50ZWxfZ3VjICpn
dWMsIGNvbnN0IHUzMiAqYWN0aW9uLCB1MzIgbGVuLAotCQkJICAgICB1MzIgKnJlc3BvbnNlX2J1
ZiwgdTMyIHJlc3BvbnNlX2J1Zl9zaXplKQoraW50IGludGVsX2d1Y19zZW5kX2N0KHN0cnVjdCBp
bnRlbF9ndWMgKmd1YywgY29uc3QgdTMyICphY3Rpb24sIHUzMiBsZW4sCisJCSAgICAgIHUzMiAq
cmVzcG9uc2VfYnVmLCB1MzIgcmVzcG9uc2VfYnVmX3NpemUpCiB7CiAJc3RydWN0IGludGVsX2d1
Y19jdCAqY3QgPSAmZ3VjLT5jdDsKIAlzdHJ1Y3QgaW50ZWxfZ3VjX2N0X2NoYW5uZWwgKmN0Y2gg
PSAmY3QtPmhvc3RfY2hhbm5lbDsKQEAgLTgzNCw3ICs4MzQsNyBAQCBzdGF0aWMgdm9pZCBjdF9w
cm9jZXNzX2hvc3RfY2hhbm5lbChzdHJ1Y3QgaW50ZWxfZ3VjX2N0ICpjdCkKICAqIFdoZW4gd2Un
cmUgY29tbXVuaWNhdGluZyB3aXRoIHRoZSBHdUMgb3ZlciBDVCwgR3VDIHVzZXMgZXZlbnRzCiAg
KiB0byBub3RpZnkgdXMgYWJvdXQgbmV3IG1lc3NhZ2VzIGJlaW5nIHBvc3RlZCBvbiB0aGUgUkVD
ViBidWZmZXIuCiAgKi8KLXN0YXRpYyB2b2lkIGludGVsX2d1Y190b19ob3N0X2V2ZW50X2hhbmRs
ZXJfY3Qoc3RydWN0IGludGVsX2d1YyAqZ3VjKQordm9pZCBpbnRlbF9ndWNfdG9faG9zdF9ldmVu
dF9oYW5kbGVyX2N0KHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3Vj
X2N0ICpjdCA9ICZndWMtPmN0OwogCkBAIC05MDEsMTAgKzkwMSw2IEBAIGludCBpbnRlbF9ndWNf
Y3RfZW5hYmxlKHN0cnVjdCBpbnRlbF9ndWNfY3QgKmN0KQogCWlmICh1bmxpa2VseShlcnIpKQog
CQlyZXR1cm4gZXJyOwogCi0JLyogU3dpdGNoIGludG8gY21kIHRyYW5zcG9ydCBidWZmZXIgYmFz
ZWQgc2VuZCgpICovCi0JZ3VjLT5zZW5kID0gaW50ZWxfZ3VjX3NlbmRfY3Q7Ci0JZ3VjLT5oYW5k
bGVyID0gaW50ZWxfZ3VjX3RvX2hvc3RfZXZlbnRfaGFuZGxlcl9jdDsKLQlEUk1fSU5GTygiQ1Q6
ICVzXG4iLCBlbmFibGVkZGlzYWJsZWQodHJ1ZSkpOwogCXJldHVybiAwOwogfQogCkBAIC05MjEs
OSArOTE3LDQgQEAgdm9pZCBpbnRlbF9ndWNfY3RfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZ3VjX2N0
ICpjdCkKIAkJcmV0dXJuOwogCiAJY3RjaF9kaXNhYmxlKGd1YywgY3RjaCk7Ci0KLQkvKiBEaXNh
YmxlIHNlbmQgKi8KLQlndWMtPnNlbmQgPSBpbnRlbF9ndWNfc2VuZF9ub3A7Ci0JZ3VjLT5oYW5k
bGVyID0gaW50ZWxfZ3VjX3RvX2hvc3RfZXZlbnRfaGFuZGxlcl9ub3A7Ci0JRFJNX0lORk8oIkNU
OiAlc1xuIiwgZW5hYmxlZGRpc2FibGVkKGZhbHNlKSk7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfY3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVs
X2d1Y19jdC5oCmluZGV4IDQxYmE1OTNhNGRmNy4uMGVjMTc0OTNkODNiIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWNfY3QuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9ndWNfY3QuaApAQCAtMTAxLDQgKzEwMSw4IEBAIHN0YXRpYyBpbmxpbmUgdm9p
ZCBpbnRlbF9ndWNfY3Rfc3RvcChzdHJ1Y3QgaW50ZWxfZ3VjX2N0ICpjdCkKIAljdC0+aG9zdF9j
aGFubmVsLmVuYWJsZWQgPSBmYWxzZTsKIH0KIAoraW50IGludGVsX2d1Y19zZW5kX2N0KHN0cnVj
dCBpbnRlbF9ndWMgKmd1YywgY29uc3QgdTMyICphY3Rpb24sIHUzMiBsZW4sCisJCSAgICAgIHUz
MiAqcmVzcG9uc2VfYnVmLCB1MzIgcmVzcG9uc2VfYnVmX3NpemUpOwordm9pZCBpbnRlbF9ndWNf
dG9faG9zdF9ldmVudF9oYW5kbGVyX2N0KHN0cnVjdCBpbnRlbF9ndWMgKmd1Yyk7CisKICNlbmRp
ZiAvKiBfSU5URUxfR1VDX0NUX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF91Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdWMuYwppbmRleCBhZTQ1
NjUxYWM3M2MuLmM3ZjgyYzk0NGRkNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfdWMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91Yy5jCkBAIC0yMzUs
OSArMjM1LDIwIEBAIHN0YXRpYyB2b2lkIGd1Y19kaXNhYmxlX2ludGVycnVwdHMoc3RydWN0IGlu
dGVsX2d1YyAqZ3VjKQogCiBzdGF0aWMgaW50IGd1Y19lbmFibGVfY29tbXVuaWNhdGlvbihzdHJ1
Y3QgaW50ZWxfZ3VjICpndWMpCiB7CisJaW50IHJldDsKKworCXJldCA9IGludGVsX2d1Y19jdF9l
bmFibGUoJmd1Yy0+Y3QpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlndWMtPnNlbmQg
PSBpbnRlbF9ndWNfc2VuZF9jdDsKKwlndWMtPmhhbmRsZXIgPSBpbnRlbF9ndWNfdG9faG9zdF9l
dmVudF9oYW5kbGVyX2N0OworCiAJZ3VjX2VuYWJsZV9pbnRlcnJ1cHRzKGd1Yyk7CiAKLQlyZXR1
cm4gaW50ZWxfZ3VjX2N0X2VuYWJsZSgmZ3VjLT5jdCk7CisJRFJNX0lORk8oIkd1QyBjb21tdW5p
Y2F0aW9uIGVuYWJsZWRcbiIpOworCisJcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyB2b2lkIGd1Y19z
dG9wX2NvbW11bmljYXRpb24oc3RydWN0IGludGVsX2d1YyAqZ3VjKQpAQCAtMjUwLDEyICsyNjEs
MTQgQEAgc3RhdGljIHZvaWQgZ3VjX3N0b3BfY29tbXVuaWNhdGlvbihzdHJ1Y3QgaW50ZWxfZ3Vj
ICpndWMpCiAKIHN0YXRpYyB2b2lkIGd1Y19kaXNhYmxlX2NvbW11bmljYXRpb24oc3RydWN0IGlu
dGVsX2d1YyAqZ3VjKQogewotCWludGVsX2d1Y19jdF9kaXNhYmxlKCZndWMtPmN0KTsKLQogCWd1
Y19kaXNhYmxlX2ludGVycnVwdHMoZ3VjKTsKIAogCWd1Yy0+c2VuZCA9IGludGVsX2d1Y19zZW5k
X25vcDsKIAlndWMtPmhhbmRsZXIgPSBpbnRlbF9ndWNfdG9faG9zdF9ldmVudF9oYW5kbGVyX25v
cDsKKworCWludGVsX2d1Y19jdF9kaXNhYmxlKCZndWMtPmN0KTsKKworCURSTV9JTkZPKCJHdUMg
Y29tbXVuaWNhdGlvbiBkaXNhYmxlZFxuIik7CiB9CiAKIGludCBpbnRlbF91Y19pbml0X21pc2Mo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QK
SW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id AD28D35A99
	for <lists+intel-gfx@lfdr.de>; Wed,  5 Jun 2019 12:40:33 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E4C728919F;
	Wed,  5 Jun 2019 10:40:31 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga17.intel.com (mga17.intel.com [192.55.52.151])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 5490C89829
 for <intel-gfx@lists.freedesktop.org>; Wed,  5 Jun 2019 10:40:30 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga004.fm.intel.com ([10.253.24.48])
 by fmsmga107.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 05 Jun 2019 03:40:29 -0700
X-ExtLoop1: 1
Received: from ssirotki-mobl3.ger.corp.intel.com (HELO [10.251.93.246])
 ([10.251.93.246])
 by fmsmga004.fm.intel.com with ESMTP; 05 Jun 2019 03:40:28 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20190604152408.24468-1-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <9ea334bb-024c-2e1f-92e4-7563ad690c87@linux.intel.com>
Date: Wed, 5 Jun 2019 11:40:27 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.0
MIME-Version: 1.0
In-Reply-To: <20190604152408.24468-1-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH] drm/i915: Skip context_barrier emission for
 unused contexts
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDA0LzA2LzIwMTkgMTY6MjQsIENocmlzIFdpbHNvbiB3cm90ZToKPiBUaGUgaW50ZW50IHdh
cyB0byBza2lwIHVudXNlZCBIVyBjb250ZXh0cyBieSBjaGVja2luZyBjZS0+c3RhdGUuCj4gSG93
ZXZlciwgdGhpcyBvbmx5IHdvcmtzIGZvciBleGVjbGlzdHMgd2hlcmUgdGhlIHBwR1RUIHBvaW50
ZXJzIGlzCj4gc3RvcmVkIGluc2lkZSB0aGUgSFcgY29udGV4dC4gRm9yIGdlbjcsIHRoZSBwcEdU
VCBpcyBhbG9uZ3NpZGUgdGhlCj4gbG9naWNhbCBzdGF0ZSBhbmQgbXVzdCBiZSB1cGRhdGVkIG9u
IGFsbCBhY3RpdmUgZW5naW5lcyBidXQsIGNydWNpYWxseSwKPiBvbmx5IG9uIGFjdGl2ZSBlbmdp
bmVzLiBBcyB3ZSBuZWVkIGRpZmZlcmVudCBjaGVja3MsIGFuZCB0byBrZWVwCj4gY29udGV4dF9i
YXJyaWVyX3Rhc2soKSBhZ25vc3RpYywgcGFzcyBpbiB0aGUgcHJlZGljYXRlLgo+IAo+IEJ1Z3pp
bGxhOiBodHRwczovL2J1Z3MuZnJlZWRlc2t0b3Aub3JnL3Nob3dfYnVnLmNnaT9pZD0xMTA4MzYK
PiBGaXhlczogNjJjOGU0MjM0NTBkICgiZHJtL2k5MTU6IFNraXAgdW51c2VkIGNvbnRleHRzIGZv
ciBjb250ZXh0X2JhcnJpZXJfdGFzaygpIikKPiBTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24g
PGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KPiBDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51
cnN1bGluQGludGVsLmNvbT4KPiAtLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9jb250ZXh0LmMgICB8IDE1ICsrKysrKysrKysrKysrLQo+ICAgLi4uL2RybS9pOTE1L2dl
bS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jIHwgMTkgKysrKysrKysrKysrKysrLS0tLQo+
ICAgMiBmaWxlcyBjaGFuZ2VkLCAyOSBpbnNlcnRpb25zKCspLCA1IGRlbGV0aW9ucygtKQo+IAo+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwo+IGluZGV4IDA4
NzIxZWY2MmU0ZS4uNjgxOWI1OThkMjI2IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fY29udGV4dC5jCj4gQEAgLTkwMiw2ICs5MDIsNyBAQCBzdGF0aWMgdm9pZCBj
Yl9yZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlICpiYXNlKQo+ICAgSTkxNV9TRUxGVEVTVF9ERUNM
QVJFKHN0YXRpYyBpbnRlbF9lbmdpbmVfbWFza190IGNvbnRleHRfYmFycmllcl9pbmplY3RfZmF1
bHQpOwo+ICAgc3RhdGljIGludCBjb250ZXh0X2JhcnJpZXJfdGFzayhzdHJ1Y3QgaTkxNV9nZW1f
Y29udGV4dCAqY3R4LAo+ICAgCQkJCWludGVsX2VuZ2luZV9tYXNrX3QgZW5naW5lcywKPiArCQkJ
CWJvb2wgKCpza2lwKShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHZvaWQgKmRhdGEpLAo+ICAg
CQkJCWludCAoKmVtaXQpKHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLCB2b2lkICpkYXRhKSwKPiAg
IAkJCQl2b2lkICgqdGFzaykodm9pZCAqZGF0YSksCj4gICAJCQkJdm9pZCAqZGF0YSkKPiBAQCAt
OTMxLDcgKzkzMiwxMCBAQCBzdGF0aWMgaW50IGNvbnRleHRfYmFycmllcl90YXNrKHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICpjdHgsCj4gICAJCQlicmVhazsKPiAgIAkJfQo+ICAgCj4gLQkJaWYg
KCEoY2UtPmVuZ2luZS0+bWFzayAmIGVuZ2luZXMpIHx8ICFjZS0+c3RhdGUpCj4gKwkJaWYgKCEo
Y2UtPmVuZ2luZS0+bWFzayAmIGVuZ2luZXMpKQo+ICsJCQljb250aW51ZTsKPiArCj4gKwkJaWYg
KHNraXAgJiYgc2tpcChjZSwgZGF0YSkpCj4gICAJCQljb250aW51ZTsKPiAgIAo+ICAgCQlycSA9
IGludGVsX2NvbnRleHRfY3JlYXRlX3JlcXVlc3QoY2UpOwo+IEBAIC0xMDU4LDYgKzEwNjIsMTQg
QEAgc3RhdGljIGludCBlbWl0X3BwZ3R0X3VwZGF0ZShzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwg
dm9pZCAqZGF0YSkKPiAgIAlyZXR1cm4gMDsKPiAgIH0KPiAgIAo+ICtzdGF0aWMgYm9vbCBza2lw
X3BwZ3R0X3VwZGF0ZShzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UsIHZvaWQgKmRhdGEpCj4gK3sK
PiArCWlmIChIQVNfTE9HSUNBTF9SSU5HX0NPTlRFWFRTKGNlLT5lbmdpbmUtPmk5MTUpKQo+ICsJ
CXJldHVybiAhY2UtPnN0YXRlOwo+ICsJZWxzZQo+ICsJCXJldHVybiAhYXRvbWljX3JlYWQoJmNl
LT5waW5fY291bnQpOwoKV291bGQgInJldHVybiAhYXRvbWljX3JlYWQoJmNlLT5waW5fY291bnQp
IHx8ICFjZS0+c3RhdGU7IiB3b3JrIGFuZCAKYXZvaWQgdGhlIHNvbWV3aGF0IGlya3kgSEFTX0xP
R0lDQUxfUklOR19DT05URVhUUyBjaGVjaz8KClJlZ2FyZHMsCgpUdnJ0a28KCj4gK30KPiArCj4g
ICBzdGF0aWMgaW50IHNldF9wcGd0dChzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmaWxl
X3ByaXYsCj4gICAJCSAgICAgc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKPiAgIAkJICAg
ICBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2NvbnRleHRfcGFyYW0gKmFyZ3MpCj4gQEAgLTExMDMsNiAr
MTExNSw3IEBAIHN0YXRpYyBpbnQgc2V0X3BwZ3R0KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZh
dGUgKmZpbGVfcHJpdiwKPiAgIAkgKiBvbmx5IGluZGlyZWN0bHkgdGhyb3VnaCB0aGUgY29udGV4
dC4KPiAgIAkgKi8KPiAgIAllcnIgPSBjb250ZXh0X2JhcnJpZXJfdGFzayhjdHgsIEFMTF9FTkdJ
TkVTLAo+ICsJCQkJICAgc2tpcF9wcGd0dF91cGRhdGUsCj4gICAJCQkJICAgZW1pdF9wcGd0dF91
cGRhdGUsCj4gICAJCQkJICAgc2V0X3BwZ3R0X2JhcnJpZXIsCj4gICAJCQkJICAgb2xkKTsKPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9j
b250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2Nv
bnRleHQuYwo+IGluZGV4IDFiYzNiODAyNjQwMC4uNDExMDVmNmVkMjA2IDEwMDY0NAo+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fY29udGV4dC5jCj4g
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0
LmMKPiBAQCAtMTYxOSw2ICsxNjE5LDExIEBAIF9fZW5naW5lX25hbWUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsIGludGVsX2VuZ2luZV9tYXNrX3QgZW5naW5lcykKPiAgIAlyZXR1cm4g
Im5vbmUiOwo+ICAgfQo+ICAgCj4gK3N0YXRpYyBib29sIHNraXBfdW51c2VkX2VuZ2luZXMoc3Ry
dWN0IGludGVsX2NvbnRleHQgKmNlLCB2b2lkICpkYXRhKQo+ICt7Cj4gKwlyZXR1cm4gIWNlLT5z
dGF0ZTsKPiArfQo+ICsKPiAgIHN0YXRpYyB2b2lkIG1vY2tfYmFycmllcl90YXNrKHZvaWQgKmRh
dGEpCj4gICB7Cj4gICAJdW5zaWduZWQgaW50ICpjb3VudGVyID0gZGF0YTsKPiBAQCAtMTY1MSw3
ICsxNjU2LDcgQEAgc3RhdGljIGludCBtb2NrX2NvbnRleHRfYmFycmllcih2b2lkICphcmcpCj4g
ICAKPiAgIAljb3VudGVyID0gMDsKPiAgIAllcnIgPSBjb250ZXh0X2JhcnJpZXJfdGFzayhjdHgs
IDAsCj4gLQkJCQkgICBOVUxMLCBtb2NrX2JhcnJpZXJfdGFzaywgJmNvdW50ZXIpOwo+ICsJCQkJ
ICAgTlVMTCwgTlVMTCwgbW9ja19iYXJyaWVyX3Rhc2ssICZjb3VudGVyKTsKPiAgIAlpZiAoZXJy
KSB7Cj4gICAJCXByX2VycigiRmFpbGVkIGF0IGxpbmUgJWQsIGVycj0lZFxuIiwgX19MSU5FX18s
IGVycik7Cj4gICAJCWdvdG8gb3V0Owo+IEBAIC0xNjY0LDcgKzE2NjksMTAgQEAgc3RhdGljIGlu
dCBtb2NrX2NvbnRleHRfYmFycmllcih2b2lkICphcmcpCj4gICAKPiAgIAljb3VudGVyID0gMDsK
PiAgIAllcnIgPSBjb250ZXh0X2JhcnJpZXJfdGFzayhjdHgsIEFMTF9FTkdJTkVTLAo+IC0JCQkJ
ICAgTlVMTCwgbW9ja19iYXJyaWVyX3Rhc2ssICZjb3VudGVyKTsKPiArCQkJCSAgIHNraXBfdW51
c2VkX2VuZ2luZXMsCj4gKwkJCQkgICBOVUxMLAo+ICsJCQkJICAgbW9ja19iYXJyaWVyX3Rhc2ss
Cj4gKwkJCQkgICAmY291bnRlcik7Cj4gICAJaWYgKGVycikgewo+ICAgCQlwcl9lcnIoIkZhaWxl
ZCBhdCBsaW5lICVkLCBlcnI9JWRcbiIsIF9fTElORV9fLCBlcnIpOwo+ICAgCQlnb3RvIG91dDsK
PiBAQCAtMTY4NSw3ICsxNjkzLDcgQEAgc3RhdGljIGludCBtb2NrX2NvbnRleHRfYmFycmllcih2
b2lkICphcmcpCj4gICAJY291bnRlciA9IDA7Cj4gICAJY29udGV4dF9iYXJyaWVyX2luamVjdF9m
YXVsdCA9IEJJVChSQ1MwKTsKPiAgIAllcnIgPSBjb250ZXh0X2JhcnJpZXJfdGFzayhjdHgsIEFM
TF9FTkdJTkVTLAo+IC0JCQkJICAgTlVMTCwgbW9ja19iYXJyaWVyX3Rhc2ssICZjb3VudGVyKTsK
PiArCQkJCSAgIE5VTEwsIE5VTEwsIG1vY2tfYmFycmllcl90YXNrLCAmY291bnRlcik7Cj4gICAJ
Y29udGV4dF9iYXJyaWVyX2luamVjdF9mYXVsdCA9IDA7Cj4gICAJaWYgKGVyciA9PSAtRU5YSU8p
Cj4gICAJCWVyciA9IDA7Cj4gQEAgLTE3MDAsNyArMTcwOCwxMCBAQCBzdGF0aWMgaW50IG1vY2tf
Y29udGV4dF9iYXJyaWVyKHZvaWQgKmFyZykKPiAgIAo+ICAgCWNvdW50ZXIgPSAwOwo+ICAgCWVy
ciA9IGNvbnRleHRfYmFycmllcl90YXNrKGN0eCwgQUxMX0VOR0lORVMsCj4gLQkJCQkgICBOVUxM
LCBtb2NrX2JhcnJpZXJfdGFzaywgJmNvdW50ZXIpOwo+ICsJCQkJICAgc2tpcF91bnVzZWRfZW5n
aW5lcywKPiArCQkJCSAgIE5VTEwsCj4gKwkJCQkgICBtb2NrX2JhcnJpZXJfdGFzaywKPiArCQkJ
CSAgICZjb3VudGVyKTsKPiAgIAlpZiAoZXJyKSB7Cj4gICAJCXByX2VycigiRmFpbGVkIGF0IGxp
bmUgJWQsIGVycj0lZFxuIiwgX19MSU5FX18sIGVycik7Cj4gICAJCWdvdG8gb3V0Owo+IApfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFp
bGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5m
cmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

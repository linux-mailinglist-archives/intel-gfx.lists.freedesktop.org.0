Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 138A3D4823
	for <lists+intel-gfx@lfdr.de>; Fri, 11 Oct 2019 21:03:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7B8FB6E42B;
	Fri, 11 Oct 2019 19:03:37 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 21F506E430
 for <intel-gfx@lists.freedesktop.org>; Fri, 11 Oct 2019 19:03:30 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18808626-1500050 
 for <intel-gfx@lists.freedesktop.org>; Fri, 11 Oct 2019 20:03:28 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 11 Oct 2019 20:03:23 +0100
Message-Id: <20191011190325.10979-7-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191011190325.10979-1-chris@chris-wilson.co.uk>
References: <20191011190325.10979-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [CI 7/9] drm/i915/perf: Allow dynamic reconfiguration
 of the OA stream
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

SW50cm9kdWNlIGEgbmV3IHBlcmZfaW9jdGwgY29tbWFuZCB0byBjaGFuZ2UgdGhlIE9BIGNvbmZp
Z3VyYXRpb24gb2YgdGhlCmFjdGl2ZSBzdHJlYW0uIFRoaXMgYWxsb3dzIHRoZSBPQSBzdHJlYW0g
dG8gYmUgcmVjb25maWd1cmVkIGJldHdlZW4KYmF0Y2ggYnVmZmVycywgZ2l2aW5nIGdyZWF0ZXIg
ZmxleGliaWxpdHkgaW4gc2FtcGxpbmcuIFdlIGluamVjdCBhCnJlcXVlc3QgaW50byB0aGUgT0Eg
Y29udGV4dCB0byByZWNvbmZpZ3VyZSB0aGUgc3RyZWFtIGFzeW5jaHJvbm91c2x5IG9uCnRoZSBH
UFUgaW4gYmV0d2VlbiBhbmQgb3JkZXJlZCB3aXRoIGV4ZWNidWZmZXIgY2FsbHMuCgpPcmlnaW5h
bCBwYXRjaCBmb3IgZHluYW1pYyByZWNvbmZpZ3VyYXRpb24gYnkgTGlvbmVsIExhbmR3ZXJsaW4u
CgpMaW5rOiBodHRwczovL2dpdGxhYi5mcmVlZGVza3RvcC5vcmcvbWVzYS9tZXNhL21lcmdlX3Jl
cXVlc3RzLzkzMgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNv
bi5jby51az4KUmV2aWV3ZWQtYnk6IExpb25lbCBMYW5kd2VybGluIDxsaW9uZWwuZy5sYW5kd2Vy
bGluQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYyB8IDQ5
ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiBpbmNsdWRlL3VhcGkvZHJtL2k5MTVf
ZHJtLmggICAgICB8IDEzICsrKysrKysrKwogMiBmaWxlcyBjaGFuZ2VkLCA2MSBpbnNlcnRpb25z
KCspLCAxIGRlbGV0aW9uKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wZXJmLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYuYwppbmRleCBjMjQzMWI1
YTFmNTUuLjVkYWFmOGQwYmRjMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wZXJmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKQEAgLTI4NjAs
NiArMjg2MCw0MyBAQCBzdGF0aWMgdm9pZCBpOTE1X3BlcmZfZGlzYWJsZV9sb2NrZWQoc3RydWN0
IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVhbSkKIAkJc3RyZWFtLT5vcHMtPmRpc2FibGUoc3RyZWFt
KTsKIH0KIAorc3RhdGljIGxvbmcgaTkxNV9wZXJmX2NvbmZpZ19sb2NrZWQoc3RydWN0IGk5MTVf
cGVyZl9zdHJlYW0gKnN0cmVhbSwKKwkJCQkgICAgdW5zaWduZWQgbG9uZyBtZXRyaWNzX3NldCkK
K3sKKwlzdHJ1Y3QgaTkxNV9vYV9jb25maWcgKmNvbmZpZzsKKwlsb25nIHJldCA9IHN0cmVhbS0+
b2FfY29uZmlnLT5pZDsKKworCWNvbmZpZyA9IGk5MTVfcGVyZl9nZXRfb2FfY29uZmlnKHN0cmVh
bS0+cGVyZiwgbWV0cmljc19zZXQpOworCWlmICghY29uZmlnKQorCQlyZXR1cm4gLUVJTlZBTDsK
KworCWlmIChjb25maWcgIT0gc3RyZWFtLT5vYV9jb25maWcpIHsKKwkJc3RydWN0IGludGVsX2Nv
bnRleHQgKmNlOworCQlpbnQgZXJyOworCisJCS8qCisJCSAqIElmIE9BIGlzIGJvdW5kIHRvIGEg
c3BlY2lmaWMgY29udGV4dCwgZW1pdCB0aGUKKwkJICogcmVjb25maWd1cmF0aW9uIGlubGluZSBm
cm9tIHRoYXQgY29udGV4dC4gVGhlIHVwZGF0ZQorCQkgKiB3aWxsIHRoZW4gYmUgb3JkZXJlZCB3
aXRoIHJlc3BlY3QgdG8gc3VibWlzc2lvbiBvbiB0aGF0CisJCSAqIGNvbnRleHQuCisJCSAqCisJ
CSAqIFdoZW4gc2V0IGdsb2JhbGx5LCB3ZSB1c2UgYSBsb3cgcHJpb3JpdHkga2VybmVsIGNvbnRl
eHQsCisJCSAqIHNvIGl0IHdpbGwgZWZmZWN0aXZlbHkgdGFrZSBlZmZlY3Qgd2hlbiBpZGxlLgor
CQkgKi8KKwkJY2UgPSBzdHJlYW0tPnBpbm5lZF9jdHggPzogc3RyZWFtLT5lbmdpbmUtPmtlcm5l
bF9jb250ZXh0OworCisJCWVyciA9IGVtaXRfb2FfY29uZmlnKHN0cmVhbSwgY2UpOworCQlpZiAo
ZXJyID09IDApCisJCQljb25maWcgPSB4Y2hnKCZzdHJlYW0tPm9hX2NvbmZpZywgY29uZmlnKTsK
KwkJZWxzZQorCQkJcmV0ID0gZXJyOworCX0KKworCWk5MTVfb2FfY29uZmlnX3B1dChjb25maWcp
OworCisJcmV0dXJuIHJldDsKK30KKwogLyoqCiAgKiBpOTE1X3BlcmZfaW9jdGwgLSBzdXBwb3J0
IGlvY3RsKCkgdXNhZ2Ugd2l0aCBpOTE1IHBlcmYgc3RyZWFtIEZEcwogICogQHN0cmVhbTogQW4g
aTkxNSBwZXJmIHN0cmVhbQpAQCAtMjg4Myw2ICsyOTIwLDggQEAgc3RhdGljIGxvbmcgaTkxNV9w
ZXJmX2lvY3RsX2xvY2tlZChzdHJ1Y3QgaTkxNV9wZXJmX3N0cmVhbSAqc3RyZWFtLAogCWNhc2Ug
STkxNV9QRVJGX0lPQ1RMX0RJU0FCTEU6CiAJCWk5MTVfcGVyZl9kaXNhYmxlX2xvY2tlZChzdHJl
YW0pOwogCQlyZXR1cm4gMDsKKwljYXNlIEk5MTVfUEVSRl9JT0NUTF9DT05GSUc6CisJCXJldHVy
biBpOTE1X3BlcmZfY29uZmlnX2xvY2tlZChzdHJlYW0sIGFyZyk7CiAJfQogCiAJcmV0dXJuIC1F
SU5WQUw7CkBAIC00MDIwLDcgKzQwNTksMTUgQEAgdm9pZCBpOTE1X3BlcmZfZmluaShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKICAqLwogaW50IGk5MTVfcGVyZl9pb2N0bF92ZXJzaW9u
KHZvaWQpCiB7Ci0JcmV0dXJuIDE7CisJLyoKKwkgKiAxOiBJbml0aWFsIHZlcnNpb24KKwkgKiAg
IEk5MTVfUEVSRl9JT0NUTF9FTkFCTEUKKwkgKiAgIEk5MTVfUEVSRl9JT0NUTF9ESVNBQkxFCisJ
ICoKKwkgKiAyOiBBZGRlZCBydW50aW1lIG1vZGlmaWNhdGlvbiBvZiBPQSBjb25maWcuCisJICog
ICBJOTE1X1BFUkZfSU9DVExfQ09ORklHCisJICovCisJcmV0dXJuIDI7CiB9CiAKICNpZiBJU19F
TkFCTEVEKENPTkZJR19EUk1fSTkxNV9TRUxGVEVTVCkKZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFw
aS9kcm0vaTkxNV9kcm0uaCBiL2luY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaAppbmRleCAwYzdi
MjgxNWZiZjEuLmIwMDhjZThiNGU2ZiAxMDA2NDQKLS0tIGEvaW5jbHVkZS91YXBpL2RybS9pOTE1
X2RybS5oCisrKyBiL2luY2x1ZGUvdWFwaS9kcm0vaTkxNV9kcm0uaApAQCAtMTkzMiw2ICsxOTMy
LDE5IEBAIHN0cnVjdCBkcm1faTkxNV9wZXJmX29wZW5fcGFyYW0gewogICovCiAjZGVmaW5lIEk5
MTVfUEVSRl9JT0NUTF9ESVNBQkxFCV9JTygnaScsIDB4MSkKIAorLyoqCisgKiBDaGFuZ2UgbWV0
cmljc19zZXQgY2FwdHVyZWQgYnkgYSBzdHJlYW0uCisgKgorICogSWYgdGhlIHN0cmVhbSBpcyBi
b3VuZCB0byBhIHNwZWNpZmljIGNvbnRleHQsIHRoZSBjb25maWd1cmF0aW9uIGNoYW5nZQorICog
d2lsbCBwZXJmb3JtZWQgaW5saW5lIHdpdGggdGhhdCBjb250ZXh0IHN1Y2ggdGhhdCBpdCB0YWtl
cyBlZmZlY3QgYmVmb3JlCisgKiB0aGUgbmV4dCBleGVjYnVmIHN1Ym1pc3Npb24uCisgKgorICog
UmV0dXJucyB0aGUgcHJldmlvdXNseSBib3VuZCBtZXRyaWNzIHNldCBpZCwgb3IgYSBuZWdhdGl2
ZSBlcnJvciBjb2RlLgorICoKKyAqIFRoaXMgaW9jdGwgaXMgYXZhaWxhYmxlIGluIHBlcmYgcmV2
aXNpb24gMi4KKyAqLworI2RlZmluZSBJOTE1X1BFUkZfSU9DVExfQ09ORklHCV9JTygnaScsIDB4
MikKKwogLyoqCiAgKiBDb21tb24gdG8gYWxsIGk5MTUgcGVyZiByZWNvcmRzCiAgKi8KLS0gCjIu
MjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50
ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

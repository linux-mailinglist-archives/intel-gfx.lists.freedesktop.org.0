Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id BCDBA315D0
	for <lists+intel-gfx@lfdr.de>; Fri, 31 May 2019 22:07:17 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8325F89872;
	Fri, 31 May 2019 20:07:15 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mail-vs1-xe42.google.com (mail-vs1-xe42.google.com
 [IPv6:2607:f8b0:4864:20::e42])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3EFF989872
 for <intel-gfx@lists.freedesktop.org>; Fri, 31 May 2019 20:07:14 +0000 (UTC)
Received: by mail-vs1-xe42.google.com with SMTP id q64so7509683vsd.1
 for <intel-gfx@lists.freedesktop.org>; Fri, 31 May 2019 13:07:14 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=O9OBWjhmO0oUCYnfHHIA+q41+YJJv4Rjd6cv/r2V6EI=;
 b=uV8lfq8nPfjmpPt/JMNrmcQ3a/vAj5+a0oXZSWXlN47IXVp2mYEMDuuOk57M7Mwktl
 Jdiae8uk42CeKkcbNLlZusBS5hBe+rqB3S1edBAFJuPFwuj8P8NOESFSt+2AN/Z0hEJ2
 osl8XMAcN4tivVQ4W6m0GmrzBwGMZVGBIZqetkTAsWvBpopVENwZvJRpuki7LGyRgDQL
 3Pg+Kb71ZvZIci4xpz+NW9bq7t0+ge9KVhB6q+TusEt6uM+/Rc1ocw8S8lsHz+nKE+sM
 2TbtBbkHgU6xMivcAzg/mrK2hdHK4PKrPJBK3Wf5/Ssg/T5FRfXU8OGtuSHNUZAyiE+2
 NefQ==
X-Gm-Message-State: APjAAAUPp+wCfWCWo4c2ijvH/Jl4ZAMN9n0kav7UI8U/X2iYWblob+DK
 bYtSU9YnDDj9K2DHjCsC/h7osyGOtkk3yRj2vO4=
X-Google-Smtp-Source: APXvYqxK1aJYFPWJjjH3HNUa4BcwxxcFUAwD3Svt76k6DxTyrCwYH/+ROGXjCKUEbEIZ0pM1d0SHpxWKIHHmvlObp/E=
X-Received: by 2002:a67:6904:: with SMTP id e4mr6627673vsc.119.1559333233177; 
 Fri, 31 May 2019 13:07:13 -0700 (PDT)
MIME-Version: 1.0
References: <20190530203500.26272-1-chris@chris-wilson.co.uk>
 <20190530203500.26272-2-chris@chris-wilson.co.uk>
In-Reply-To: <20190530203500.26272-2-chris@chris-wilson.co.uk>
From: Matthew Auld <matthew.william.auld@gmail.com>
Date: Fri, 31 May 2019 21:06:46 +0100
Message-ID: <CAM0jSHN+Of6qFK2tuWf_KeXmHY0Ly-5ZYKyHNK19YJGHfcwuYQ@mail.gmail.com>
To: Chris Wilson <chris@chris-wilson.co.uk>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=O9OBWjhmO0oUCYnfHHIA+q41+YJJv4Rjd6cv/r2V6EI=;
 b=oNlvvzETldUJTdkBr3ZJAcrZMKXp8my7ACw/5xlqWe1qR5n/koUmOGIqNK6TLMLzhy
 icikg56++wg9iaCaALriicKJ7zVhu1YGa+qsHN4AiMUE5Y1ZJEYVba58nVGqslFMjSy3
 TltC4ma6mqzBuJCuXFcUZPeaMG8IA8PQ5D/FJKwW3sfdY68GMRKOO2Z/SSH8B0YFaOOy
 Maa2pAANzs9pPd6dFFAcCv4jOi9wAMmhf4q/YYiTpg0VgOPfIHiGXv4q6JbpvDMh+HpE
 2n01cFqJjmDqw1j/R55jE75eEXzjoZYs4ONXiJEHxOyQK2ZC/0ccC0AI9JnNEagn6h28
 6Ynw==
Subject: Re: [Intel-gfx] [PATCH 2/2] drm/i915: Report all objects with
 allocated pages to the shrinker
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Intel Graphics Development <intel-gfx@lists.freedesktop.org>,
 Matthew Auld <matthew.auld@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gVGh1LCAzMCBNYXkgMjAxOSBhdCAyMTozNSwgQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13
aWxzb24uY28udWs+IHdyb3RlOgo+Cj4gQ3VycmVudGx5LCB3ZSB0cnkgdG8gcmVwb3J0IHRvIHRo
ZSBzaHJpbmtlciB0aGUgcHJlY2lzZSBudW1iZXIgb2YKPiBvYmplY3RzIChwYWdlcykgdGhhdCBh
cmUgYXZhaWxhYmxlIHRvIGJlIHJlYXBlZCBhdCB0aGlzIG1vbWVudC4gVGhpcwo+IHJlcXVpcmVz
IHNlYXJjaGluZyBhbGwgb2JqZWN0cyB3aXRoIGFsbG9jYXRlZCBwYWdlcyB0byBzZWUgaWYgdGhl
eQo+IGZ1bGZpbGwgdGhlIHNlYXJjaCBjcml0ZXJpYSwgYW5kIHRoaXMgY291bnQgaXMgcGVyZm9y
bWVkIHF1aXRlCj4gZnJlcXVlbnRseS4gKFRoZSBzaHJpbmtlciB0cmllcyB0byBmcmVlIH4xMjgg
cGFnZXMgb24gZWFjaCBpbnZvY2F0aW9uLAo+IGJlZm9yZSB3aGljaCB3ZSBjb3VudCBhbGwgdGhl
IG9iamVjdHM7IGNvdW50aW5nIHRha2VzIGxvbmdlciB0aGFuCj4gdW5iaW5kaW5nIHRoZSBvYmpl
Y3RzISkgSWYgd2UgdGFrZSB0aGUgcHJhZ21hdGljIHZpZXcgdGhhdCB3aXRoCj4gc3VmZmljaWVu
dCBkZXNpcmUsIGFsbCBvYmplY3RzIGFyZSBldmVudHVhbGx5IHJlYXBhYmxlICh0aGV5IGJlY29t
ZQo+IGluYWN0aXZlLCBvciBubyBsb25nZXIgdXNlZCBhcyBmcmFtZWJ1ZmZlciBldGMpLCB3ZSBj
YW4gc2ltcGx5IHJldHVybgo+IHRoZSBjb3VudCBvZiBwaW5uZWQgcGFnZXMgbWFpbnRhaW5lZCBk
dXJpbmcgZ2V0X3BhZ2VzL3B1dF9wYWdlcyByYXRoZXIKPiB0aGFuIHdhbGsgdGhlIGxpc3RzIGV2
ZXJ5IHRpbWUuCj4KPiBUaGUgZG93bnNpZGUgaXMgdGhhdCB3ZSBtYXkgKHNsaWdodGx5KSBvdmVy
LXJlcG9ydCB0aGUgbnVtYmVyIG9mCj4gb2JqZWN0cy9wYWdlcyB3ZSBjb3VsZCBzaHJpbmsgYW5k
IHNvIHBlbmFsaXplIG91cnNlbHZlcyBieSBzaHJpbmtpbmcKPiBtb3JlIHRoYW4gcmVxdWlyZWQu
IFRoaXMgaXMgbWl0aWdhdGVkIGJ5IGtlZXBpbmcgdGhlIG9yZGVyIGluIHdoaWNoIHdlCj4gc2hy
aW5rIG9iamVjdHMgc3VjaCB0aGF0IHdlIGF2b2lkIHBlbmFsaXppbmcgYWN0aXZlIGFuZCBmcmVx
dWVudGx5IHVzZWQKPiBvYmplY3RzLCBhbmQgaWYgbWVtb3J5IGlzIHNvIHRpZ2h0IHRoYXQgd2Ug
bmVlZCB0byBmcmVlIHRoZW0gd2Ugd291bGQKPiBuZWVkIHRvIGFueXdheS4KPgo+IHYyOiBPbmx5
IGV4cG9zZSBzaHJpbmthYmxlIG9iamVjdHMgdG8gdGhlIHNocmlua2VyOyBhIHNtYWxsIHJlZHVj
dGlvbiBpbgo+IG5vdCBjb25zaWRlcmluZyBzdG9sZW4gYW5kIGZvcmVpZ24gb2JqZWN0cy4KPiB2
MzogUmVzdG9yZSB0aGUgdHJhY2tpbmcgZnJvbSBhICJiYWNrdXAiIGNvcHkgZnJvbSBiZWZvcmUg
dGhlIGdlbS8gc3BsaXQKPgo+IFNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hy
aXMtd2lsc29uLmNvLnVrPgo+IENjOiBKb29uYXMgTGFodGluZW4gPGpvb25hcy5sYWh0aW5lbkBs
aW51eC5pbnRlbC5jb20+Cj4gQ2M6IE1hdHRoZXcgQXVsZCA8bWF0dGhldy5hdWxkQGludGVsLmNv
bT4KPiAtLS0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jICAg
fCAgMyArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMgICB8
IDMzICsrKy0tLS0tLS0tCj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdl
cy5jICAgIHwgMjAgKysrKystLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
c2hyaW5rZXIuYyB8IDI4ICsrLS0tLS0tLS0KPiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5
MTVfZ2VtX3N0b2xlbi5jICAgfCAgMyArLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rl
YnVnZnMuYyAgICAgICAgICB8IDU4ICsrLS0tLS0tLS0tLS0tLS0tLS0tCj4gIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgICAgICAgICAgIHwgIDcgKy0tCj4gIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZ2VtLmMgICAgICAgICAgICAgIHwgMjMgKysrKy0tLS0KPiAgZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYyAgICAgICAgICAgICAgfCAxNiArKysrLS0KPiAgOSBm
aWxlcyBjaGFuZ2VkLCA2MyBpbnNlcnRpb25zKCspLCAxMjggZGVsZXRpb25zKC0pCj4KPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jCj4gaW5kZXggNTJiNzNlOTBj
OWY0Li5lNWRlYWU2MjY4MWYgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2RvbWFpbi5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2RvbWFpbi5jCj4gQEAgLTQ3NSw3ICs0NzUsOCBAQCBzdGF0aWMgdm9pZCBpOTE1X2dlbV9v
YmplY3RfYnVtcF9pbmFjdGl2ZV9nZ3R0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmop
Cj4gICAgICAgICB9Cj4gICAgICAgICBtdXRleF91bmxvY2soJmk5MTUtPmdndHQudm0ubXV0ZXgp
Owo+Cj4gLSAgICAgICBpZiAob2JqLT5tbS5tYWR2ID09IEk5MTVfTUFEVl9XSUxMTkVFRCkgewo+
ICsgICAgICAgaWYgKGk5MTVfZ2VtX29iamVjdF9pc19zaHJpbmthYmxlKG9iaikgJiYKPiArICAg
ICAgICAgICBvYmotPm1tLm1hZHYgPT0gSTkxNV9NQURWX1dJTExORUVEKSB7Cj4gICAgICAgICAg
ICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmxpc3Q7Cj4KPiAgICAgICAgICAgICAgICAgc3Bpbl9s
b2NrKCZpOTE1LT5tbS5vYmpfbG9jayk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9vYmplY3QuYwo+IGluZGV4IGE0Mjc2M2U0ZGQ1Zi4uNDljOTU5YzExYjJhIDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYwo+ICsrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYwo+IEBAIC00NCwyNSAr
NDQsNiBAQCB2b2lkIGk5MTVfZ2VtX29iamVjdF9mcmVlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCj4gICAgICAgICByZXR1cm4ga21lbV9jYWNoZV9mcmVlKGdsb2JhbC5zbGFiX29i
amVjdHMsIG9iaik7Cj4gIH0KPgo+IC0vKiBzb21lIGJvb2trZWVwaW5nICovCj4gLXN0YXRpYyB2
b2lkIGk5MTVfZ2VtX2luZm9fYWRkX29iaihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTY0IHNpemUpCj4gLXsKPiAtICAg
ICAgIHNwaW5fbG9jaygmaTkxNS0+bW0ub2JqZWN0X3N0YXRfbG9jayk7Cj4gLSAgICAgICBpOTE1
LT5tbS5vYmplY3RfY291bnQrKzsKPiAtICAgICAgIGk5MTUtPm1tLm9iamVjdF9tZW1vcnkgKz0g
c2l6ZTsKPiAtICAgICAgIHNwaW5fdW5sb2NrKCZpOTE1LT5tbS5vYmplY3Rfc3RhdF9sb2NrKTsK
PiAtfQo+IC0KPiAtc3RhdGljIHZvaWQgaTkxNV9nZW1faW5mb19yZW1vdmVfb2JqKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1NjQgc2l6ZSkKPiAtewo+IC0gICAgICAgc3Bpbl9sb2NrKCZpOTE1LT5tbS5vYmplY3Rf
c3RhdF9sb2NrKTsKPiAtICAgICAgIGk5MTUtPm1tLm9iamVjdF9jb3VudC0tOwo+IC0gICAgICAg
aTkxNS0+bW0ub2JqZWN0X21lbW9yeSAtPSBzaXplOwo+IC0gICAgICAgc3Bpbl91bmxvY2soJmk5
MTUtPm1tLm9iamVjdF9zdGF0X2xvY2spOwo+IC19Cj4gLQo+ICBzdGF0aWMgdm9pZAo+ICBmcm9u
dGJ1ZmZlcl9yZXRpcmUoc3RydWN0IGk5MTVfYWN0aXZlX3JlcXVlc3QgKmFjdGl2ZSwKPiAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdCkKPiBAQCAtOTgsOCAr
NzksNiBAQCB2b2lkIGk5MTVfZ2VtX29iamVjdF9pbml0KHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmosCj4gICAgICAgICBvYmotPm1tLm1hZHYgPSBJOTE1X01BRFZfV0lMTE5FRUQ7Cj4g
ICAgICAgICBJTklUX1JBRElYX1RSRUUoJm9iai0+bW0uZ2V0X3BhZ2UucmFkaXgsIEdGUF9LRVJO
RUwgfCBfX0dGUF9OT1dBUk4pOwo+ICAgICAgICAgbXV0ZXhfaW5pdCgmb2JqLT5tbS5nZXRfcGFn
ZS5sb2NrKTsKPiAtCj4gLSAgICAgICBpOTE1X2dlbV9pbmZvX2FkZF9vYmoodG9faTkxNShvYmot
PmJhc2UuZGV2KSwgb2JqLT5iYXNlLnNpemUpOwo+ICB9Cj4KPiAgLyoqCj4gQEAgLTE2MywxMSAr
MTQyLDE0IEBAIHZvaWQgaTkxNV9nZW1fY2xvc2Vfb2JqZWN0KHN0cnVjdCBkcm1fZ2VtX29iamVj
dCAqZ2VtLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCj4KPiAgc3RhdGljIGJvb2wgZGlzY2FyZF9i
YWNraW5nX3N0b3JhZ2Uoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiAgewo+IC0g
ICAgICAgLyogSWYgd2UgYXJlIHRoZSBsYXN0IHVzZXIgb2YgdGhlIGJhY2tpbmcgc3RvcmFnZSAo
YmUgaXQgc2htZW1mcwo+ICsgICAgICAgLyoKPiArICAgICAgICAqIElmIHdlIGFyZSB0aGUgbGFz
dCB1c2VyIG9mIHRoZSBiYWNraW5nIHN0b3JhZ2UgKGJlIGl0IHNobWVtZnMKPiAgICAgICAgICAq
IHBhZ2VzIG9yIHN0b2xlbiBldGMpLCB3ZSBrbm93IHRoYXQgdGhlIHBhZ2VzIGFyZSBnb2luZyB0
byBiZQo+ICAgICAgICAgICogaW1tZWRpYXRlbHkgcmVsZWFzZWQuIEluIHRoaXMgY2FzZSwgd2Ug
Y2FuIHRoZW4gc2tpcCBjb3B5aW5nCj4gICAgICAgICAgKiBiYWNrIHRoZSBjb250ZW50cyBmcm9t
IHRoZSBHUFUuCj4gICAgICAgICAgKi8KPiArICAgICAgIGlmICghaTkxNV9nZW1fb2JqZWN0X2lz
X3Nocmlua2FibGUob2JqKSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwo+Cj4gICAg
ICAgICBpZiAob2JqLT5tbS5tYWR2ICE9IEk5MTVfTUFEVl9XSUxMTkVFRCkKPiAgICAgICAgICAg
ICAgICAgcmV0dXJuIGZhbHNlOwo+IEBAIC0yMDgsMTMgKzE5MCwxNSBAQCBzdGF0aWMgdm9pZCBf
X2k5MTVfZ2VtX2ZyZWVfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKPiAg
ICAgICAgICAgICAgICAgR0VNX0JVR19PTighbGlzdF9lbXB0eSgmb2JqLT52bWEubGlzdCkpOwo+
ICAgICAgICAgICAgICAgICBHRU1fQlVHX09OKCFSQl9FTVBUWV9ST09UKCZvYmotPnZtYS50cmVl
KSk7Cj4KPiAtICAgICAgICAgICAgICAgLyogVGhpcyBzZXJpYWxpemVzIGZyZWVpbmcgd2l0aCB0
aGUgc2hyaW5rZXIuIFNpbmNlIHRoZSBmcmVlCj4gKyAgICAgICAgICAgICAgIC8qCj4gKyAgICAg
ICAgICAgICAgICAqIFRoaXMgc2VyaWFsaXplcyBmcmVlaW5nIHdpdGggdGhlIHNocmlua2VyLiBT
aW5jZSB0aGUgZnJlZQo+ICAgICAgICAgICAgICAgICAgKiBpcyBkZWxheWVkLCBmaXJzdCBieSBS
Q1UgdGhlbiBieSB0aGUgd29ya3F1ZXVlLCB3ZSB3YW50IHRoZQo+ICAgICAgICAgICAgICAgICAg
KiBzaHJpbmtlciB0byBiZSBhYmxlIHRvIGZyZWUgcGFnZXMgb2YgdW5yZWZlcmVuY2VkIG9iamVj
dHMsCj4gICAgICAgICAgICAgICAgICAqIG9yIGVsc2Ugd2UgbWF5IG9vbSB3aGlsc3QgdGhlcmUg
YXJlIHBsZW50eSBvZiBkZWZlcnJlZAo+ICAgICAgICAgICAgICAgICAgKiBmcmVlZCBvYmplY3Rz
Lgo+ICAgICAgICAgICAgICAgICAgKi8KPiAtICAgICAgICAgICAgICAgaWYgKGk5MTVfZ2VtX29i
amVjdF9oYXNfcGFnZXMob2JqKSkgewo+ICsgICAgICAgICAgICAgICBpZiAoaTkxNV9nZW1fb2Jq
ZWN0X2hhc19wYWdlcyhvYmopICYmCj4gKyAgICAgICAgICAgICAgICAgICBpOTE1X2dlbV9vYmpl
Y3RfaXNfc2hyaW5rYWJsZShvYmopKSB7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgc3Bpbl9s
b2NrKCZpOTE1LT5tbS5vYmpfbG9jayk7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgbGlzdF9k
ZWxfaW5pdCgmb2JqLT5tbS5saW5rKTsKPiAgICAgICAgICAgICAgICAgICAgICAgICBzcGluX3Vu
bG9jaygmaTkxNS0+bW0ub2JqX2xvY2spOwo+IEBAIC0yNDAsNyArMjI0LDYgQEAgc3RhdGljIHZv
aWQgX19pOTE1X2dlbV9mcmVlX29iamVjdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
Cj4KPiAgICAgICAgICAgICAgICAgcmVzZXJ2YXRpb25fb2JqZWN0X2ZpbmkoJm9iai0+X19idWls
dGluX3Jlc3YpOwo+ICAgICAgICAgICAgICAgICBkcm1fZ2VtX29iamVjdF9yZWxlYXNlKCZvYmot
PmJhc2UpOwo+IC0gICAgICAgICAgICAgICBpOTE1X2dlbV9pbmZvX3JlbW92ZV9vYmooaTkxNSwg
b2JqLT5iYXNlLnNpemUpOwo+Cj4gICAgICAgICAgICAgICAgIGJpdG1hcF9mcmVlKG9iai0+Yml0
XzE3KTsKPiAgICAgICAgICAgICAgICAgaTkxNV9nZW1fb2JqZWN0X2ZyZWUob2JqKTsKPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcGFnZXMuYwo+IGluZGV4IGU1Mzg2MDE0N2Yy
MS4uN2U2NGZkNmJjMTliIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9wYWdlcy5jCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X3BhZ2VzLmMKPiBAQCAtNTYsOSArNTYsMTMgQEAgdm9pZCBfX2k5MTVfZ2VtX29iamVjdF9zZXRf
cGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKPiAgICAgICAgIH0KPiAgICAg
ICAgIEdFTV9CVUdfT04oIUhBU19QQUdFX1NJWkVTKGk5MTUsIG9iai0+bW0ucGFnZV9zaXplcy5z
ZykpOwo+Cj4gLSAgICAgICBzcGluX2xvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKPiAtICAgICAg
IGxpc3RfYWRkKCZvYmotPm1tLmxpbmssICZpOTE1LT5tbS51bmJvdW5kX2xpc3QpOwo+IC0gICAg
ICAgc3Bpbl91bmxvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKPiArICAgICAgIGlmIChpOTE1X2dl
bV9vYmplY3RfaXNfc2hyaW5rYWJsZShvYmopKSB7Cj4gKyAgICAgICAgICAgICAgIHNwaW5fbG9j
aygmaTkxNS0+bW0ub2JqX2xvY2spOwo+ICsgICAgICAgICAgICAgICBpOTE1LT5tbS5zaHJpbmtf
Y291bnQrKzsKPiArICAgICAgICAgICAgICAgaTkxNS0+bW0uc2hyaW5rX21lbW9yeSArPSBvYmot
PmJhc2Uuc2l6ZTsKPiArICAgICAgICAgICAgICAgbGlzdF9hZGQoJm9iai0+bW0ubGluaywgJmk5
MTUtPm1tLnVuYm91bmRfbGlzdCk7Cj4gKyAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZpOTE1
LT5tbS5vYmpfbG9jayk7Cj4gKyAgICAgICB9Cj4gIH0KPgo+ICBpbnQgX19fX2k5MTVfZ2VtX29i
amVjdF9nZXRfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaikKPiBAQCAtMTQ2
LDkgKzE1MCwxMyBAQCBfX2k5MTVfZ2VtX29iamVjdF91bnNldF9wYWdlcyhzdHJ1Y3QgZHJtX2k5
MTVfZ2VtX29iamVjdCAqb2JqKQo+ICAgICAgICAgaWYgKElTX0VSUl9PUl9OVUxMKHBhZ2VzKSkK
PiAgICAgICAgICAgICAgICAgcmV0dXJuIHBhZ2VzOwo+Cj4gLSAgICAgICBzcGluX2xvY2soJmk5
MTUtPm1tLm9ial9sb2NrKTsKPiAtICAgICAgIGxpc3RfZGVsKCZvYmotPm1tLmxpbmspOwo+IC0g
ICAgICAgc3Bpbl91bmxvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKPiArICAgICAgIGlmIChpOTE1
X2dlbV9vYmplY3RfaXNfc2hyaW5rYWJsZShvYmopKSB7Cj4gKyAgICAgICAgICAgICAgIHNwaW5f
bG9jaygmaTkxNS0+bW0ub2JqX2xvY2spOwo+ICsgICAgICAgICAgICAgICBsaXN0X2RlbCgmb2Jq
LT5tbS5saW5rKTsKPiArICAgICAgICAgICAgICAgaTkxNS0+bW0uc2hyaW5rX2NvdW50LS07Cj4g
KyAgICAgICAgICAgICAgIGk5MTUtPm1tLnNocmlua19tZW1vcnkgLT0gb2JqLT5iYXNlLnNpemU7
Cj4gKyAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZpOTE1LT5tbS5vYmpfbG9jayk7Cj4gKyAg
ICAgICB9Cj4KPiAgICAgICAgIGlmIChvYmotPm1tLm1hcHBpbmcpIHsKPiAgICAgICAgICAgICAg
ICAgdm9pZCAqcHRyOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fc2hyaW5rZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJp
bmtlci5jCj4gaW5kZXggNmE5M2UzMjZhYmYzLi5kNzFlNjMwYzZmYjggMTAwNjQ0Cj4gLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Nocmlua2VyLmMKPiArKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2hyaW5rZXIuYwo+IEBAIC0zMDksMzAgKzMw
OSwxNCBAQCBpOTE1X2dlbV9zaHJpbmtlcl9jb3VudChzdHJ1Y3Qgc2hyaW5rZXIgKnNocmlua2Vy
LCBzdHJ1Y3Qgc2hyaW5rX2NvbnRyb2wgKnNjKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSA9Cj4gICAgICAgICAgICAgICAgIGNvbnRhaW5lcl9vZihzaHJpbmtl
ciwgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUsIG1tLnNocmlua2VyKTsKPiAtICAgICAgIHN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7Cj4gLSAgICAgICB1bnNpZ25lZCBsb25nIG51bV9v
YmplY3RzID0gMDsKPiAtICAgICAgIHVuc2lnbmVkIGxvbmcgY291bnQgPSAwOwo+ICsgICAgICAg
dW5zaWduZWQgbG9uZyBudW1fb2JqZWN0czsKPiArICAgICAgIHVuc2lnbmVkIGxvbmcgY291bnQ7
Cj4KPiAtICAgICAgIHNwaW5fbG9jaygmaTkxNS0+bW0ub2JqX2xvY2spOwo+IC0gICAgICAgbGlz
dF9mb3JfZWFjaF9lbnRyeShvYmosICZpOTE1LT5tbS51bmJvdW5kX2xpc3QsIG1tLmxpbmspCj4g
LSAgICAgICAgICAgICAgIGlmIChjYW5fcmVsZWFzZV9wYWdlcyhvYmopKSB7Cj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgY291bnQgKz0gb2JqLT5iYXNlLnNpemUgPj4gUEFHRV9TSElGVDsKPiAt
ICAgICAgICAgICAgICAgICAgICAgICBudW1fb2JqZWN0cysrOwo+IC0gICAgICAgICAgICAgICB9
Cj4gKyAgICAgICBjb3VudCA9IFJFQURfT05DRShpOTE1LT5tbS5zaHJpbmtfbWVtb3J5KSA+PiBQ
QUdFX1NISUZUOwo+ICsgICAgICAgbnVtX29iamVjdHMgPSBSRUFEX09OQ0UoaTkxNS0+bW0uc2hy
aW5rX2NvdW50KTsKPgo+IC0gICAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeShvYmosICZpOTE1LT5t
bS5ib3VuZF9saXN0LCBtbS5saW5rKQo+IC0gICAgICAgICAgICAgICBpZiAoIWk5MTVfZ2VtX29i
amVjdF9pc19hY3RpdmUob2JqKSAmJiBjYW5fcmVsZWFzZV9wYWdlcyhvYmopKSB7Cj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgY291bnQgKz0gb2JqLT5iYXNlLnNpemUgPj4gUEFHRV9TSElGVDsK
PiAtICAgICAgICAgICAgICAgICAgICAgICBudW1fb2JqZWN0cysrOwo+IC0gICAgICAgICAgICAg
ICB9Cj4gLSAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgJmk5MTUtPm1tLnB1cmdlX2xp
c3QsIG1tLmxpbmspCj4gLSAgICAgICAgICAgICAgIGlmICghaTkxNV9nZW1fb2JqZWN0X2lzX2Fj
dGl2ZShvYmopICYmIGNhbl9yZWxlYXNlX3BhZ2VzKG9iaikpIHsKPiAtICAgICAgICAgICAgICAg
ICAgICAgICBjb3VudCArPSBvYmotPmJhc2Uuc2l6ZSA+PiBQQUdFX1NISUZUOwo+IC0gICAgICAg
ICAgICAgICAgICAgICAgIG51bV9vYmplY3RzKys7Cj4gLSAgICAgICAgICAgICAgIH0KPiAtICAg
ICAgIHNwaW5fdW5sb2NrKCZpOTE1LT5tbS5vYmpfbG9jayk7Cj4gLQo+IC0gICAgICAgLyogVXBk
YXRlIG91ciBwcmVmZXJyZWQgdm1zY2FuIGJhdGNoIHNpemUgZm9yIHRoZSBuZXh0IHBhc3MuCj4g
KyAgICAgICAvKgo+ICsgICAgICAgICogVXBkYXRlIG91ciBwcmVmZXJyZWQgdm1zY2FuIGJhdGNo
IHNpemUgZm9yIHRoZSBuZXh0IHBhc3MuCj4gICAgICAgICAgKiBPdXIgcm91Z2ggZ3Vlc3MgZm9y
IGFuIGVmZmVjdGl2ZSBiYXRjaCBzaXplIGlzIHJvdWdobHkgMgo+ICAgICAgICAgICogYXZhaWxh
YmxlIEdFTSBvYmplY3RzIHdvcnRoIG9mIHBhZ2VzLiBUaGF0IGlzIHdlIGRvbid0IHdhbnQKPiAg
ICAgICAgICAqIHRoZSBzaHJpbmtlciB0byBmaXJlLCB1bnRpbCBpdCBpcyB3b3J0aCB0aGUgY29z
dCBvZiBmcmVlaW5nIGFuCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9zdG9sZW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zdG9s
ZW4uYwo+IGluZGV4IDkwODBhNzM2NjYzYS4uOGIzYTIzYmZmN2Y2IDEwMDY0NAo+IC0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zdG9sZW4uYwo+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zdG9sZW4uYwo+IEBAIC02OTAsNyArNjkwLDggQEAg
aTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9zdG9sZW5fZm9yX3ByZWFsbG9jYXRlZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYKPiAgICAgICAgIG11dGV4X3VubG9jaygmZ2d0dC0+dm0u
bXV0ZXgpOwo+Cj4gICAgICAgICBzcGluX2xvY2soJmRldl9wcml2LT5tbS5vYmpfbG9jayk7Cj4g
LSAgICAgICBsaXN0X21vdmVfdGFpbCgmb2JqLT5tbS5saW5rLCAmZGV2X3ByaXYtPm1tLmJvdW5k
X2xpc3QpOwo+ICsgICAgICAgaWYgKGk5MTVfZ2VtX29iamVjdF9pc19zaHJpbmthYmxlKG9iaikp
Cj4gKyAgICAgICAgICAgICAgIGxpc3RfbW92ZV90YWlsKCZvYmotPm1tLmxpbmssICZkZXZfcHJp
di0+bW0uYm91bmRfbGlzdCk7CgpBbHdheXMgZmFsc2UsIG5vLCBvciBtYXliZSBqdXN0IGZ1dHVy
ZSB0aGlua2luZz8KCkFueXdheSwKUmV2aWV3ZWQtYnk6IE1hdHRoZXcgQXVsZCA8bWF0dGhldy5h
dWxkQGludGVsLmNvbT4KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwt
Z2Z4

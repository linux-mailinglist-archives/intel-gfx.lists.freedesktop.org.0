Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 99EE17B4AD
	for <lists+intel-gfx@lfdr.de>; Tue, 30 Jul 2019 22:58:16 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 294806E611;
	Tue, 30 Jul 2019 20:58:14 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6C3016E611
 for <intel-gfx@lists.freedesktop.org>; Tue, 30 Jul 2019 20:58:12 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17740832-1500050 
 for multiple; Tue, 30 Jul 2019 21:58:05 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 30 Jul 2019 21:58:05 +0100
Message-Id: <20190730205805.3733-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Report resv_obj allocation failure
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U2luY2UgY29tbWl0IDY0ZDZjNTAwYTM4NCAoImRybS9pOTE1OiBHZW5lcmFsaXNlIEdQVSBhY3Rp
dml0eQp0cmFja2luZyIpLCB3ZSBoYXZlIGJlZW4gcHJlcGFyZWQgZm9yIGk5MTVfdm1hX21vdmVf
dG9fYWN0aXZlKCkgdG8gZmFpbC4KV2UgY2FuIHRha2UgYWR2YW50YWdlIG9mIHRoaXMgdG8gcmVw
b3J0IHRoZSBmYWlsdXJlIGZvciBhbGxvY2F0aW5nIHRoZQpzaGFyZWQtZmVuY2Ugc2xvdCBpbiB0
aGUgcmVzZXJ2YXRpb25fb2JqZWN0LgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJp
c0BjaHJpcy13aWxzb24uY28udWs+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEu
YyB8IDMxICsrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA5
IGluc2VydGlvbnMoKyksIDIyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfdm1hLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCmlu
ZGV4IGViMTZhMWE5M2JiYy4uNzczNGQ2MjE4Y2U3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3ZtYS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMK
QEAgLTg4NiwyMyArODg2LDYgQEAgdm9pZCBpOTE1X3ZtYV9yZXZva2VfbW1hcChzdHJ1Y3QgaTkx
NV92bWEgKnZtYSkKIAkJbGlzdF9kZWwoJnZtYS0+b2JqLT51c2VyZmF1bHRfbGluayk7CiB9CiAK
LXN0YXRpYyB2b2lkIGV4cG9ydF9mZW5jZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKLQkJCSBzdHJ1
Y3QgaTkxNV9yZXF1ZXN0ICpycSwKLQkJCSB1bnNpZ25lZCBpbnQgZmxhZ3MpCi17Ci0Jc3RydWN0
IHJlc2VydmF0aW9uX29iamVjdCAqcmVzdiA9IHZtYS0+cmVzdjsKLQotCS8qCi0JICogSWdub3Jl
IGVycm9ycyBmcm9tIGZhaWxpbmcgdG8gYWxsb2NhdGUgdGhlIG5ldyBmZW5jZSwgd2UgY2FuJ3QK
LQkgKiBoYW5kbGUgYW4gZXJyb3IgcmlnaHQgbm93LiBXb3JzdCBjYXNlIHNob3VsZCBiZSBtaXNz
ZWQKLQkgKiBzeW5jaHJvbmlzYXRpb24gbGVhZGluZyB0byByZW5kZXJpbmcgY29ycnVwdGlvbi4K
LQkgKi8KLQlpZiAoZmxhZ3MgJiBFWEVDX09CSkVDVF9XUklURSkKLQkJcmVzZXJ2YXRpb25fb2Jq
ZWN0X2FkZF9leGNsX2ZlbmNlKHJlc3YsICZycS0+ZmVuY2UpOwotCWVsc2UgaWYgKHJlc2VydmF0
aW9uX29iamVjdF9yZXNlcnZlX3NoYXJlZChyZXN2LCAxKSA9PSAwKQotCQlyZXNlcnZhdGlvbl9v
YmplY3RfYWRkX3NoYXJlZF9mZW5jZShyZXN2LCAmcnEtPmZlbmNlKTsKLX0KLQogaW50IGk5MTVf
dm1hX21vdmVfdG9fYWN0aXZlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogCQkJICAgIHN0cnVjdCBp
OTE1X3JlcXVlc3QgKnJxLAogCQkJICAgIHVuc2lnbmVkIGludCBmbGFncykKQEAgLTkyNiwxNCAr
OTA5LDIwIEBAIGludCBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZt
YSwKIAlpZiAodW5saWtlbHkoZXJyKSkKIAkJcmV0dXJuIGVycjsKIAotCW9iai0+d3JpdGVfZG9t
YWluID0gMDsKIAlpZiAoZmxhZ3MgJiBFWEVDX09CSkVDVF9XUklURSkgewotCQlvYmotPndyaXRl
X2RvbWFpbiA9IEk5MTVfR0VNX0RPTUFJTl9SRU5ERVI7Ci0KIAkJaWYgKGludGVsX2ZiX29ial9p
bnZhbGlkYXRlKG9iaiwgT1JJR0lOX0NTKSkKIAkJCV9faTkxNV9hY3RpdmVfcmVxdWVzdF9zZXQo
Jm9iai0+ZnJvbnRidWZmZXJfd3JpdGUsIHJxKTsKIAorCQlyZXNlcnZhdGlvbl9vYmplY3RfYWRk
X2V4Y2xfZmVuY2Uodm1hLT5yZXN2LCAmcnEtPmZlbmNlKTsKKwkJb2JqLT53cml0ZV9kb21haW4g
PSBJOTE1X0dFTV9ET01BSU5fUkVOREVSOwogCQlvYmotPnJlYWRfZG9tYWlucyA9IDA7CisJfSBl
bHNlIHsKKwkJZXJyID0gcmVzZXJ2YXRpb25fb2JqZWN0X3Jlc2VydmVfc2hhcmVkKHZtYS0+cmVz
diwgMSk7CisJCWlmICh1bmxpa2VseShlcnIpKQorCQkJcmV0dXJuIGVycjsKKworCQlyZXNlcnZh
dGlvbl9vYmplY3RfYWRkX3NoYXJlZF9mZW5jZSh2bWEtPnJlc3YsICZycS0+ZmVuY2UpOworCQlv
YmotPndyaXRlX2RvbWFpbiA9IDA7CiAJfQogCW9iai0+cmVhZF9kb21haW5zIHw9IEk5MTVfR0VN
X0dQVV9ET01BSU5TOwogCW9iai0+bW0uZGlydHkgPSB0cnVlOwpAQCAtOTQxLDggKzkzMCw2IEBA
IGludCBpOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKIAlpZiAo
ZmxhZ3MgJiBFWEVDX09CSkVDVF9ORUVEU19GRU5DRSkKIAkJX19pOTE1X2FjdGl2ZV9yZXF1ZXN0
X3NldCgmdm1hLT5sYXN0X2ZlbmNlLCBycSk7CiAKLQlleHBvcnRfZmVuY2Uodm1hLCBycSwgZmxh
Z3MpOwotCiAJR0VNX0JVR19PTighaTkxNV92bWFfaXNfYWN0aXZlKHZtYSkpOwogCXJldHVybiAw
OwogfQotLSAKMi4yMi4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRl
bC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 9D42775AD6
	for <lists+intel-gfx@lfdr.de>; Fri, 26 Jul 2019 00:44:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C2ACA6E838;
	Thu, 25 Jul 2019 22:44:23 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C0AAA890B6
 for <intel-gfx@lists.freedesktop.org>; Thu, 25 Jul 2019 22:44:20 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17610924-1500050 
 for multiple; Thu, 25 Jul 2019 23:44:10 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 25 Jul 2019 23:44:07 +0100
Message-Id: <20190725224407.4206-5-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190725224407.4206-1-chris@chris-wilson.co.uk>
References: <20190725224407.4206-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 5/5] drm/i915: Replace hangcheck by heartbeats
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UmVwbGFjZSBzYW1wbGluZyB0aGUgZW5naW5lIHN0YXRlIGV2ZXJ5IHNvIG9mdGVuIHdpdGggYSBw
ZXJpb2RpYwpoZWFydGJlYXQgcmVxdWVzdCB0byBtZWFzdXJlIHRoZSBoZWFsdGggb2YgYW4gZW5n
aW5lLiBUaGlzIGlzIGNvdXBsZWQKd2l0aCB0aGUgZm9yY2VkLXByZWVtcHRpb24gdG8gYWxsb3cg
bG9uZyBydW5uaW5nIHJlcXVlc3RzIHRvIHN1cnZpdmUgc28KbG9uZyBhcyB0aGV5IGRvIG5vdCBi
bG9jayBvdGhlciB1c2Vycy4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hy
aXMtd2lsc29uLmNvLnVrPgpDYzogSm9vbmFzIExhaHRpbmVuIDxqb29uYXMubGFodGluZW5AbGlu
dXguaW50ZWwuY29tPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNv
bT4KQ2M6IEpvbiBCbG9vbWZpZWxkIDxqb24uYmxvb21maWVsZEBpbnRlbC5jb20+Ci0tLQpOb3Rl
LCBzdHJpY3RseSB0aGlzIHN0aWxsIHJlcXVpcmVzIHN0cnVjdF9tdXRleC1mcmVlIHJldGlyZW1l
bnQgZm9yIHRoZQpjb3JuZXIgY2FzZSB3aGVyZSB0aGUgaWRsZS13b3JrZXIgaXMgaW5lZmZlY3Rp
dmUgYW5kIHdlIGdldCBhIGJhY2tsb2cgb2YKcmVxdWVzdHMgb24gdGhlIGtlcm5lbCByaW5nLiBP
ciBpZiB0aGUgbGVnYWN5IHJpbmdidWZmZXIgaXMgZnVsbC4uLgpXaGVuIHdlIGFyZSBhYmxlIHRv
IHJldGlyZSBmcm9tIG91dHNpZGUgb2Ygc3RydWN0X211dGV4IHdlIGNhbiBkbyB0aGUKZnVsbCBp
ZGxlLWJhcnJpZXIgYW5kIGlkbGUtd29yayBmcm9tIGhlcmUuCi0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvS2NvbmZpZy5wcm9maWxlICAgICAgICAgIHwgIDExICsKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L01ha2VmaWxlICAgICAgICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lLmggICAgICAgIHwgIDMyIC0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9lbmdpbmVfY3MuYyAgICAgfCAgMTAgKy0KIC4uLi9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lX2hlYXJ0YmVhdC5jICB8ICA5NiArKysrKwogLi4uL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmggIHwgIDE3ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZV9wbS5jICAgICB8ICAgNSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX3R5cGVzLmggIHwgIDE0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9ndC5jICAgICAgICAgICAgfCAgIDEgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZ3QuaCAgICAgICAgICAgIHwgICA0IC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2d0X3BtLmMgICAgICAgICB8ICAgMiAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9oYW5nY2hlY2suYyAgICAgfCAzNjAgLS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jICAgICAgICAgfCAgIDMgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jICB8ICAgMyAtCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2RlYnVnZnMuYyAgICAgICAgICAgfCAgODYgLS0tLS0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgICAgICB8ICAgMyArLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuaCAgICAgICAgICAgICAgIHwgICAxIC0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ3B1X2Vycm9yLmMgICAgICAgICB8ICAzNyArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9ncHVfZXJyb3IuaCAgICAgICAgIHwgICAyIC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfcGFyYW1zLmMgICAgICAgICAgICB8ICAgNSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3BhcmFtcy5oICAgICAgICAgICAgfCAgIDEgLQogMjEgZmlsZXMgY2hhbmdlZCwgMTQ4IGlu
c2VydGlvbnMoKyksIDU0NyBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmMKIGNyZWF0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmgKIGRl
bGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2su
YwoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L0tjb25maWcucHJvZmlsZSBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L0tjb25maWcucHJvZmlsZQppbmRleCAzMTg0ZTg0OTEzMzMuLmFh
ZmI1N2Y4NDE2OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvS2NvbmZpZy5wcm9m
aWxlCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L0tjb25maWcucHJvZmlsZQpAQCAtMzcsMyAr
MzcsMTQgQEAgY29uZmlnIERSTV9JOTE1X1BSRUVNUFRfVElNRU9VVAogCSAgdG8gZXhlY3V0ZS4K
IAogCSAgTWF5IGJlIDAgdG8gZGlzYWJsZSB0aGUgdGltZW91dC4KKworY29uZmlnIERSTV9JOTE1
X0hFQVJUQkVBVF9JTlRFUlZBTAorCWludCAiSW50ZXJ2YWwgYmV0d2VlbiBoZWFydGJlYXQgcHVs
c2VzIChtcykiCisJZGVmYXVsdCAyNTAwICMgbWljcm9zZWNvbmRzCisJaGVscAorCSAgV2hpbGUg
YWN0aXZlIHRoZSBkcml2ZXIgdXNlcyBhIHBlcmlvZGljIHJlcXVlc3QsIGEgaGVhcnRiZWF0LCB0
bworCSAgY2hlY2sgdGhlIHdlbGxuZXNzIG9mIHRoZSBHUFUgYW5kIHRvIHJlZ3VsYXJseSBmbHVz
aCBzdGF0ZSBjaGFuZ2VzCisJICAoaWRsZSBiYXJyaWVycykuCisKKwkgIE1heSBiZSAwIHRvIGRp
c2FibGUgaGVhcnRiZWF0cyBhbmQgdGhlcmVmb3JlIGRpc2FibGUgYXV0b21hdGljIEdQVQorCSAg
aGFuZyBkZXRlY3Rpb24uCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmls
ZSBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCmluZGV4IDUyNDUxNjI1MWE0MC4uMTgy
MDE4NTJkNjhkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQpAQCAtNzMsMTAgKzczLDEwIEBAIGd0LXkg
Kz0gXAogCWd0L2ludGVsX2JyZWFkY3J1bWJzLm8gXAogCWd0L2ludGVsX2NvbnRleHQubyBcCiAJ
Z3QvaW50ZWxfZW5naW5lX2NzLm8gXAorCWd0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQubyBcCiAJ
Z3QvaW50ZWxfZW5naW5lX3BtLm8gXAogCWd0L2ludGVsX2d0Lm8gXAogCWd0L2ludGVsX2d0X3Bt
Lm8gXAotCWd0L2ludGVsX2hhbmdjaGVjay5vIFwKIAlndC9pbnRlbF9scmMubyBcCiAJZ3QvaW50
ZWxfcmVuZGVyc3RhdGUubyBcCiAJZ3QvaW50ZWxfcmVzZXQubyBcCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZS5oCmluZGV4IGRiNWM3M2NlODZlZS4uMzhlZWI0MzIwYzk3IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaAorKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaApAQCAtOTAsMzggKzkwLDYgQEAgc3Ry
dWN0IGRybV9wcmludGVyOwogLyogc2Vxbm8gc2l6ZSBpcyBhY3R1YWxseSBvbmx5IGEgdWludDMy
LCBidXQgc2luY2Ugd2UgcGxhbiB0byB1c2UgTUlfRkxVU0hfRFcgdG8KICAqIGRvIHRoZSB3cml0
ZXMsIGFuZCB0aGF0IG11c3QgaGF2ZSBxdyBhbGlnbmVkIG9mZnNldHMsIHNpbXBseSBwcmV0ZW5k
IGl0J3MgOGIuCiAgKi8KLWVudW0gaW50ZWxfZW5naW5lX2hhbmdjaGVja19hY3Rpb24gewotCUVO
R0lORV9JRExFID0gMCwKLQlFTkdJTkVfV0FJVCwKLQlFTkdJTkVfQUNUSVZFX1NFUU5PLAotCUVO
R0lORV9BQ1RJVkVfSEVBRCwKLQlFTkdJTkVfQUNUSVZFX1NVQlVOSVRTLAotCUVOR0lORV9XQUlU
X0tJQ0ssCi0JRU5HSU5FX0RFQUQsCi19OwotCi1zdGF0aWMgaW5saW5lIGNvbnN0IGNoYXIgKgot
aGFuZ2NoZWNrX2FjdGlvbl90b19zdHIoY29uc3QgZW51bSBpbnRlbF9lbmdpbmVfaGFuZ2NoZWNr
X2FjdGlvbiBhKQotewotCXN3aXRjaCAoYSkgewotCWNhc2UgRU5HSU5FX0lETEU6Ci0JCXJldHVy
biAiaWRsZSI7Ci0JY2FzZSBFTkdJTkVfV0FJVDoKLQkJcmV0dXJuICJ3YWl0IjsKLQljYXNlIEVO
R0lORV9BQ1RJVkVfU0VRTk86Ci0JCXJldHVybiAiYWN0aXZlIHNlcW5vIjsKLQljYXNlIEVOR0lO
RV9BQ1RJVkVfSEVBRDoKLQkJcmV0dXJuICJhY3RpdmUgaGVhZCI7Ci0JY2FzZSBFTkdJTkVfQUNU
SVZFX1NVQlVOSVRTOgotCQlyZXR1cm4gImFjdGl2ZSBzdWJ1bml0cyI7Ci0JY2FzZSBFTkdJTkVf
V0FJVF9LSUNLOgotCQlyZXR1cm4gIndhaXQga2ljayI7Ci0JY2FzZSBFTkdJTkVfREVBRDoKLQkJ
cmV0dXJuICJkZWFkIjsKLQl9Ci0KLQlyZXR1cm4gInVua25vd24iOwotfQogCiB2b2lkIGludGVs
X2VuZ2luZXNfc2V0X3NjaGVkdWxlcl9jYXBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2Nz
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfY3MuYwppbmRleCA2NWNi
ZjFkOTExOGQuLjg5ZjRhMzgyNWI3NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfZW5naW5lX2NzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
ZW5naW5lX2NzLmMKQEAgLTYyMSw3ICs2MjEsNiBAQCBzdGF0aWMgaW50IGludGVsX2VuZ2luZV9z
ZXR1cF9jb21tb24oc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCWludGVsX2VuZ2lu
ZV9pbml0X2FjdGl2ZShlbmdpbmUsIEVOR0lORV9QSFlTSUNBTCk7CiAJaW50ZWxfZW5naW5lX2lu
aXRfYnJlYWRjcnVtYnMoZW5naW5lKTsKIAlpbnRlbF9lbmdpbmVfaW5pdF9leGVjbGlzdHMoZW5n
aW5lKTsKLQlpbnRlbF9lbmdpbmVfaW5pdF9oYW5nY2hlY2soZW5naW5lKTsKIAlpbnRlbF9lbmdp
bmVfaW5pdF9iYXRjaF9wb29sKGVuZ2luZSk7CiAJaW50ZWxfZW5naW5lX2luaXRfY21kX3BhcnNl
cihlbmdpbmUpOwogCWludGVsX2VuZ2luZV9pbml0X19wbShlbmdpbmUpOwpAQCAtMTQ1Myw4ICsx
NDUyLDEzIEBAIHZvaWQgaW50ZWxfZW5naW5lX2R1bXAoc3RydWN0IGludGVsX2VuZ2luZV9jcyAq
ZW5naW5lLAogCQlkcm1fcHJpbnRmKG0sICIqKiogV0VER0VEICoqKlxuIik7CiAKIAlkcm1fcHJp
bnRmKG0sICJcdEF3YWtlPyAlZFxuIiwgYXRvbWljX3JlYWQoJmVuZ2luZS0+d2FrZXJlZi5jb3Vu
dCkpOwotCWRybV9wcmludGYobSwgIlx0SGFuZ2NoZWNrOiAlZCBtcyBhZ29cbiIsCi0JCSAgIGpp
ZmZpZXNfdG9fbXNlY3MoamlmZmllcyAtIGVuZ2luZS0+aGFuZ2NoZWNrLmFjdGlvbl90aW1lc3Rh
bXApKTsKKworCXJjdV9yZWFkX2xvY2soKTsKKwlycSA9IFJFQURfT05DRShlbmdpbmUtPmxhc3Rf
aGVhcnRiZWF0KTsKKwlpZiAocnEpCisJCWRybV9wcmludGYobSwgIlx0SGVhcnRiZWF0OiAlZCBt
cyBhZ29cbiIsCisJCQkgICBqaWZmaWVzX3RvX21zZWNzKGppZmZpZXMgLSBycS0+ZW1pdHRlZF9q
aWZmaWVzKSk7CisJcmN1X3JlYWRfdW5sb2NrKCk7CiAJZHJtX3ByaW50ZihtLCAiXHRSZXNldCBj
b3VudDogJWQgKGdsb2JhbCAlZClcbiIsCiAJCSAgIGk5MTVfcmVzZXRfZW5naW5lX2NvdW50KGVy
cm9yLCBlbmdpbmUpLAogCQkgICBpOTE1X3Jlc2V0X2NvdW50KGVycm9yKSk7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmMKbmV3IGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi40YTk1NTgzNWMwZmEKLS0tIC9kZXYvbnVsbAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmMKQEAg
LTAsMCArMSw5NiBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQKKyAqCisg
KiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNpbmNsdWRlICJp
OTE1X3JlcXVlc3QuaCIKKworI2luY2x1ZGUgImludGVsX2NvbnRleHQuaCIKKyNpbmNsdWRlICJp
bnRlbF9lbmdpbmVfaGVhcnRiZWF0LmgiCisjaW5jbHVkZSAiaW50ZWxfZW5naW5lX3BtLmgiCisj
aW5jbHVkZSAiaW50ZWxfZ3QuaCIKKyNpbmNsdWRlICJpbnRlbF9yZXNldC5oIgorCitzdGF0aWMg
bG9uZyBkZWxheSh2b2lkKQoreworCWNvbnN0IGxvbmcgdCA9IG1zZWNzX3RvX2ppZmZpZXMoQ09O
RklHX0RSTV9JOTE1X0hFQVJUQkVBVF9JTlRFUlZBTCk7CisKKwlyZXR1cm4gcm91bmRfamlmZmll
c191cF9yZWxhdGl2ZSh0KTsKK30KKworc3RhdGljIHZvaWQgaGVhcnRiZWF0KHN0cnVjdCB3b3Jr
X3N0cnVjdCAqd3JrKQoreworCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSA9CisJCWNv
bnRhaW5lcl9vZih3cmssIHR5cGVvZigqZW5naW5lKSwgaGVhcnRiZWF0LndvcmspOworCXN0cnVj
dCBpbnRlbF9jb250ZXh0ICpjZSA9IGVuZ2luZS0+a2VybmVsX2NvbnRleHQ7CisJc3RydWN0IGk5
MTVfcmVxdWVzdCAqcnE7CisKKwlpZiAoIWludGVsX2VuZ2luZV9wbV9nZXRfaWZfYXdha2UoZW5n
aW5lKSkKKwkJcmV0dXJuOworCisJcnEgPSBlbmdpbmUtPmxhc3RfaGVhcnRiZWF0OworCWlmIChy
cSAmJiBpOTE1X3JlcXVlc3RfY29tcGxldGVkKHJxKSkgeworCQlpOTE1X3JlcXVlc3RfcHV0KHJx
KTsKKwkJZW5naW5lLT5sYXN0X2hlYXJ0YmVhdCA9IE5VTEw7CisJfQorCisJaWYgKGludGVsX2d0
X2lzX3dlZGdlZChlbmdpbmUtPmd0KSkKKwkJZ290byBvdXQ7CisKKwlpZiAoZW5naW5lLT5sYXN0
X2hlYXJ0YmVhdCkgeworCQlpbnRlbF9ndF9oYW5kbGVfZXJyb3IoZW5naW5lLT5ndCwgZW5naW5l
LT5tYXNrLAorCQkJCSAgICAgIEk5MTVfRVJST1JfQ0FQVFVSRSwKKwkJCQkgICAgICAic3RvcHBl
ZCBoZWFydGJlYXQgb24gJXMiLCBlbmdpbmUtPm5hbWUpOworCQlnb3RvIG91dDsKKwl9CisKKwlp
ZiAoZW5naW5lLT53YWtlcmVmX3NlcmlhbCA9PSBlbmdpbmUtPnNlcmlhbCkKKwkJZ290byBvdXQ7
CisKKwlpZiAoaW50ZWxfY29udGV4dF90aW1lbGluZV9sb2NrKGNlKSkKKwkJZ290byBvdXQ7CisK
KwlpbnRlbF9jb250ZXh0X2VudGVyKGNlKTsKKwlycSA9IF9faTkxNV9yZXF1ZXN0X2NyZWF0ZShj
ZSwgR0ZQX05PV0FJVCB8IF9fR0ZQX05PV0FSTik7CisJaW50ZWxfY29udGV4dF9leGl0KGNlKTsK
KwlpZiAoSVNfRVJSKHJxKSkKKwkJZ290byB1bmxvY2s7CisKKwllbmdpbmUtPmxhc3RfaGVhcnRi
ZWF0ID0gaTkxNV9yZXF1ZXN0X2dldChycSk7CisJZW5naW5lLT53YWtlcmVmX3NlcmlhbCA9IGVu
Z2luZS0+c2VyaWFsICsgMTsKKworCWk5MTVfcmVxdWVzdF9hZGRfYmFycmllcnMocnEpOworCV9f
aTkxNV9yZXF1ZXN0X2NvbW1pdChycSk7CisKKwlpZiAoZW5naW5lLT5zY2hlZHVsZSkgeworCQlz
dHJ1Y3QgaTkxNV9zY2hlZF9hdHRyIGF0dHIgPSB7IC5wcmlvcml0eSA9IElOVF9NQVggfTsKKwor
CQllbmdpbmUtPnNjaGVkdWxlKHJxLCAmYXR0cik7CisJfQorCit1bmxvY2s6CisJaW50ZWxfY29u
dGV4dF90aW1lbGluZV91bmxvY2soY2UpOworb3V0OgorCXNjaGVkdWxlX2RlbGF5ZWRfd29yaygm
ZW5naW5lLT5oZWFydGJlYXQsIGRlbGF5KCkpOworCWludGVsX2VuZ2luZV9wbV9wdXQoZW5naW5l
KTsKK30KKwordm9pZCBpbnRlbF9lbmdpbmVfdW5wYXJrX2hlYXJ0YmVhdChzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCit7CisJaWYgKCFDT05GSUdfRFJNX0k5MTVfSEVBUlRCRUFUX0lO
VEVSVkFMKQorCQlyZXR1cm47CisKKwlzY2hlZHVsZV9kZWxheWVkX3dvcmsoJmVuZ2luZS0+aGVh
cnRiZWF0LCBkZWxheSgpKTsKK30KKwordm9pZCBpbnRlbF9lbmdpbmVfcGFya19oZWFydGJlYXQo
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCWNhbmNlbF9kZWxheWVkX3dvcmtf
c3luYygmZW5naW5lLT5oZWFydGJlYXQpOworCWk5MTVfcmVxdWVzdF9wdXQoZmV0Y2hfYW5kX3pl
cm8oJmVuZ2luZS0+bGFzdF9oZWFydGJlYXQpKTsKK30KKwordm9pZCBpbnRlbF9lbmdpbmVfaW5p
dF9oZWFydGJlYXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCUlOSVRfREVM
QVlFRF9XT1JLKCZlbmdpbmUtPmhlYXJ0YmVhdCwgaGVhcnRiZWF0KTsKK30KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaApuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmUwNGY5YzdhYTg1ZAotLS0gL2Rldi9udWxsCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9oZWFydGJlYXQuaApAQCAt
MCwwICsxLDE3IEBACisvKgorICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorICoKKyAq
IENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2lmbmRlZiBJTlRF
TF9FTkdJTkVfSEVBUlRCRUFUX0gKKyNkZWZpbmUgSU5URUxfRU5HSU5FX0hFQVJUQkVBVF9ICisK
K3N0cnVjdCBpbnRlbF9lbmdpbmVfY3M7CisKK3ZvaWQgaW50ZWxfZW5naW5lX2luaXRfaGVhcnRi
ZWF0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7CisKK3ZvaWQgaW50ZWxfZW5naW5l
X3BhcmtfaGVhcnRiZWF0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSk7Cit2b2lkIGlu
dGVsX2VuZ2luZV91bnBhcmtfaGVhcnRiZWF0KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2lu
ZSk7CisKKyNlbmRpZiAvKiBJTlRFTF9FTkdJTkVfSEVBUlRCRUFUX0ggKi8KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMKaW5kZXggZTc0ZmJmMDRhNjhkLi42MzQ5YmIw
MzhjNzIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9w
bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9wbS5jCkBAIC03
LDYgKzcsNyBAQAogI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAKICNpbmNsdWRlICJpbnRlbF9lbmdp
bmUuaCIKKyNpbmNsdWRlICJpbnRlbF9lbmdpbmVfaGVhcnRiZWF0LmgiCiAjaW5jbHVkZSAiaW50
ZWxfZW5naW5lX3BtLmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3QuaCIKICNpbmNsdWRlICJpbnRlbF9n
dF9wbS5oIgpAQCAtMzIsNyArMzMsNyBAQCBzdGF0aWMgaW50IF9fZW5naW5lX3VucGFyayhzdHJ1
Y3QgaW50ZWxfd2FrZXJlZiAqd2YpCiAJaWYgKGVuZ2luZS0+dW5wYXJrKQogCQllbmdpbmUtPnVu
cGFyayhlbmdpbmUpOwogCi0JaW50ZWxfZW5naW5lX2luaXRfaGFuZ2NoZWNrKGVuZ2luZSk7CisJ
aW50ZWxfZW5naW5lX3VucGFya19oZWFydGJlYXQoZW5naW5lKTsKIAlyZXR1cm4gMDsKIH0KIApA
QCAtMTE1LDYgKzExNiw3IEBAIHN0YXRpYyBpbnQgX19lbmdpbmVfcGFyayhzdHJ1Y3QgaW50ZWxf
d2FrZXJlZiAqd2YpCiAKIAlHRU1fVFJBQ0UoIiVzXG4iLCBlbmdpbmUtPm5hbWUpOwogCisJaW50
ZWxfZW5naW5lX3BhcmtfaGVhcnRiZWF0KGVuZ2luZSk7CiAJaW50ZWxfZW5naW5lX2Rpc2FybV9i
cmVhZGNydW1icyhlbmdpbmUpOwogCiAJLyogTXVzdCBiZSByZXNldCB1cG9uIGlkbGluZywgb3Ig
d2UgbWF5IG1pc3MgdGhlIGJ1c3kgd2FrZXVwLiAqLwpAQCAtMTQyLDQgKzE0NCw1IEBAIHZvaWQg
aW50ZWxfZW5naW5lX3BtX3B1dChzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB2b2lk
IGludGVsX2VuZ2luZV9pbml0X19wbShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7
CiAJaW50ZWxfd2FrZXJlZl9pbml0KCZlbmdpbmUtPndha2VyZWYpOworCWludGVsX2VuZ2luZV9p
bml0X2hlYXJ0YmVhdChlbmdpbmUpOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9lbmdpbmVfdHlwZXMuaAppbmRleCA4YmU2MzAxOWQ3MDcuLjlhM2VhZDU1Njc0MyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKQEAgLTE0LDYgKzE0
LDcgQEAKICNpbmNsdWRlIDxsaW51eC9sbGlzdC5oPgogI2luY2x1ZGUgPGxpbnV4L3RpbWVyLmg+
CiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxsaW51eC93b3JrcXVldWUuaD4K
IAogI2luY2x1ZGUgImk5MTVfZ2VtLmgiCiAjaW5jbHVkZSAiaTkxNV9nZW1fYmF0Y2hfcG9vbC5o
IgpAQCAtNTUsMTQgKzU2LDYgQEAgc3RydWN0IGludGVsX2luc3Rkb25lIHsKIAl1MzIgcm93W0k5
MTVfTUFYX1NMSUNFU11bSTkxNV9NQVhfU1VCU0xJQ0VTXTsKIH07CiAKLXN0cnVjdCBpbnRlbF9l
bmdpbmVfaGFuZ2NoZWNrIHsKLQl1NjQgYWN0aGQ7Ci0JdTMyIGxhc3RfcmluZzsKLQl1MzIgbGFz
dF9oZWFkOwotCXVuc2lnbmVkIGxvbmcgYWN0aW9uX3RpbWVzdGFtcDsKLQlzdHJ1Y3QgaW50ZWxf
aW5zdGRvbmUgaW5zdGRvbmU7Ci19OwotCiBzdHJ1Y3QgaW50ZWxfcmluZyB7CiAJc3RydWN0IGty
ZWYgcmVmOwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwpAQCAtMjk4LDYgKzI5MSw5IEBAIHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgewogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpkZWZhdWx0
X3N0YXRlOwogCXZvaWQgKnBpbm5lZF9kZWZhdWx0X3N0YXRlOwogCisJc3RydWN0IGRlbGF5ZWRf
d29yayBoZWFydGJlYXQ7CisJc3RydWN0IGk5MTVfcmVxdWVzdCAqbGFzdF9oZWFydGJlYXQ7CisK
IAkvKiBSYXRoZXIgdGhhbiBoYXZlIGV2ZXJ5IGNsaWVudCB3YWl0IHVwb24gYWxsIHVzZXIgaW50
ZXJydXB0cywKIAkgKiB3aXRoIHRoZSBoZXJkIHdha2luZyBhZnRlciBldmVyeSBpbnRlcnJ1cHQg
YW5kIGVhY2ggZG9pbmcgdGhlCiAJICogaGVhdnl3ZWlnaHQgc2Vxbm8gZGFuY2UsIHdlIGRlbGVn
YXRlIHRoZSB0YXNrIChvZiBiZWluZyB0aGUKQEAgLTQzNyw4ICs0MzMsNiBAQCBzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzIHsKIAkvKiBzdGF0dXNfbm90aWZpZXI6IGxpc3Qgb2YgY2FsbGJhY2tzIGZv
ciBjb250ZXh0LXN3aXRjaCBjaGFuZ2VzICovCiAJc3RydWN0IGF0b21pY19ub3RpZmllcl9oZWFk
IGNvbnRleHRfc3RhdHVzX25vdGlmaWVyOwogCi0Jc3RydWN0IGludGVsX2VuZ2luZV9oYW5nY2hl
Y2sgaGFuZ2NoZWNrOwotCiAjZGVmaW5lIEk5MTVfRU5HSU5FX05FRURTX0NNRF9QQVJTRVIgQklU
KDApCiAjZGVmaW5lIEk5MTVfRU5HSU5FX1NVUFBPUlRTX1NUQVRTICAgQklUKDEpCiAjZGVmaW5l
IEk5MTVfRU5HSU5FX0hBU19QUkVFTVBUSU9OICAgQklUKDIpCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZ3QuYwppbmRleCBmN2U2OWRiNDAxOWQuLmZlYWY5MTZjOWFiZCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9ndC5jCkBAIC0xOSw3ICsxOSw2IEBAIHZvaWQgaW50ZWxfZ3RfaW5pdF9lYXJs
eShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAog
CXNwaW5fbG9ja19pbml0KCZndC0+Y2xvc2VkX2xvY2spOwogCi0JaW50ZWxfZ3RfaW5pdF9oYW5n
Y2hlY2soZ3QpOwogCWludGVsX2d0X2luaXRfcmVzZXQoZ3QpOwogCWludGVsX2d0X3BtX2luaXRf
ZWFybHkoZ3QpOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
Z3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmgKaW5kZXggNjQwYmIwNTMx
ZjViLi41NGQyMjkxM2VkZTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2d0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuaApAQCAtMzks
OCArMzksNiBAQCB2b2lkIGludGVsX2d0X2NsZWFyX2Vycm9yX3JlZ2lzdGVycyhzdHJ1Y3QgaW50
ZWxfZ3QgKmd0LAogdm9pZCBpbnRlbF9ndF9mbHVzaF9nZ3R0X3dyaXRlcyhzdHJ1Y3QgaW50ZWxf
Z3QgKmd0KTsKIHZvaWQgaW50ZWxfZ3RfY2hpcHNldF9mbHVzaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0
KTsKIAotdm9pZCBpbnRlbF9ndF9pbml0X2hhbmdjaGVjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0KTsK
LQogaW50IGludGVsX2d0X2luaXRfc2NyYXRjaChzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1bnNpZ25l
ZCBpbnQgc2l6ZSk7CiB2b2lkIGludGVsX2d0X2Zpbmlfc2NyYXRjaChzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0KTsKIApAQCAtNTUsNiArNTMsNCBAQCBzdGF0aWMgaW5saW5lIGJvb2wgaW50ZWxfZ3RfaXNf
d2VkZ2VkKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJcmV0dXJuIF9faW50ZWxfcmVzZXRfZmFpbGVk
KCZndC0+cmVzZXQpOwogfQogCi12b2lkIGludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0KTsKLQogI2VuZGlmIC8qIF9fSU5URUxfR1RfSF9fICovCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYwppbmRleCA2NWMwZDBjOWQ1NDMuLmQyMjNiMDdlZTMyNCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9wbS5jCkBAIC00Niw4ICs0Niw2IEBAIHN0
YXRpYyBpbnQgaW50ZWxfZ3RfdW5wYXJrKHN0cnVjdCBpbnRlbF93YWtlcmVmICp3ZikKIAogCWk5
MTVfcG11X2d0X3VucGFya2VkKGk5MTUpOwogCi0JaW50ZWxfZ3RfcXVldWVfaGFuZ2NoZWNrKGd0
KTsKLQogCXBtX25vdGlmeShpOTE1LCBJTlRFTF9HVF9VTlBBUkspOwogCiAJcmV0dXJuIDA7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2hhbmdjaGVjay5jCmRlbGV0ZWQgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwNWQwNDJjZGVmZTIuLjAwMDAwMDAwMDAwMAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9oYW5nY2hlY2suYworKysgL2Rldi9udWxsCkBAIC0xLDM2MCAr
MCwwIEBACi0vKgotICogQ29weXJpZ2h0IMKpIDIwMTYgSW50ZWwgQ29ycG9yYXRpb24KLSAqCi0g
KiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBl
cnNvbiBvYnRhaW5pbmcgYQotICogY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVk
IGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKLSAqIHRvIGRlYWwgaW4gdGhl
IFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRp
b24KLSAqIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBk
aXN0cmlidXRlLCBzdWJsaWNlbnNlLAotICogYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0
d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlCi0gKiBTb2Z0d2FyZSBpcyBm
dXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgot
ICoKLSAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90
aWNlIChpbmNsdWRpbmcgdGhlIG5leHQKLSAqIHBhcmFncmFwaCkgc2hhbGwgYmUgaW5jbHVkZWQg
aW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUKLSAqIFNvZnR3YXJl
LgotICoKLSAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJB
TlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCi0gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5P
VCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKLSAqIEZJVE5F
U1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBF
VkVOVCBTSEFMTAotICogVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxF
IEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKLSAqIExJQUJJTElUWSwgV0hFVEhFUiBJ
TiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HCi0gKiBG
Uk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNF
IE9SIE9USEVSIERFQUxJTkdTCi0gKiBJTiBUSEUgU09GVFdBUkUuCi0gKgotICovCi0KLSNpbmNs
dWRlICJpOTE1X2Rydi5oIgotI2luY2x1ZGUgImludGVsX2VuZ2luZS5oIgotI2luY2x1ZGUgImlu
dGVsX2d0LmgiCi0jaW5jbHVkZSAiaW50ZWxfcmVzZXQuaCIKLQotc3RydWN0IGhhbmdjaGVjayB7
Ci0JdTY0IGFjdGhkOwotCXUzMiByaW5nOwotCXUzMiBoZWFkOwotCWVudW0gaW50ZWxfZW5naW5l
X2hhbmdjaGVja19hY3Rpb24gYWN0aW9uOwotCXVuc2lnbmVkIGxvbmcgYWN0aW9uX3RpbWVzdGFt
cDsKLQlpbnQgZGVhZGxvY2s7Ci0Jc3RydWN0IGludGVsX2luc3Rkb25lIGluc3Rkb25lOwotCWJv
b2wgd2VkZ2VkOjE7Ci0JYm9vbCBzdGFsbGVkOjE7Ci19OwotCi1zdGF0aWMgYm9vbCBpbnN0ZG9u
ZV91bmNoYW5nZWQodTMyIGN1cnJlbnRfaW5zdGRvbmUsIHUzMiAqb2xkX2luc3Rkb25lKQotewot
CXUzMiB0bXAgPSBjdXJyZW50X2luc3Rkb25lIHwgKm9sZF9pbnN0ZG9uZTsKLQlib29sIHVuY2hh
bmdlZDsKLQotCXVuY2hhbmdlZCA9IHRtcCA9PSAqb2xkX2luc3Rkb25lOwotCSpvbGRfaW5zdGRv
bmUgfD0gdG1wOwotCi0JcmV0dXJuIHVuY2hhbmdlZDsKLX0KLQotc3RhdGljIGJvb2wgc3VidW5p
dHNfc3R1Y2soc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQotewotCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGVuZ2luZS0+aTkxNTsKLQlzdHJ1Y3QgaW50ZWxfaW5z
dGRvbmUgaW5zdGRvbmU7Ci0Jc3RydWN0IGludGVsX2luc3Rkb25lICphY2N1X2luc3Rkb25lID0g
JmVuZ2luZS0+aGFuZ2NoZWNrLmluc3Rkb25lOwotCWJvb2wgc3R1Y2s7Ci0JaW50IHNsaWNlOwot
CWludCBzdWJzbGljZTsKLQotCWludGVsX2VuZ2luZV9nZXRfaW5zdGRvbmUoZW5naW5lLCAmaW5z
dGRvbmUpOwotCi0JLyogVGhlcmUgbWlnaHQgYmUgdW5zdGFibGUgc3VidW5pdCBzdGF0ZXMgZXZl
biB3aGVuCi0JICogYWN0dWFsIGhlYWQgaXMgbm90IG1vdmluZy4gRmlsdGVyIG91dCB0aGUgdW5z
dGFibGUgb25lcyBieQotCSAqIGFjY3VtdWxhdGluZyB0aGUgdW5kb25lIC0+IGRvbmUgdHJhbnNp
dGlvbnMgYW5kIG9ubHkKLQkgKiBjb25zaWRlciB0aG9zZSBhcyBwcm9ncmVzcy4KLQkgKi8KLQlz
dHVjayA9IGluc3Rkb25lX3VuY2hhbmdlZChpbnN0ZG9uZS5pbnN0ZG9uZSwKLQkJCQkgICAmYWNj
dV9pbnN0ZG9uZS0+aW5zdGRvbmUpOwotCXN0dWNrICY9IGluc3Rkb25lX3VuY2hhbmdlZChpbnN0
ZG9uZS5zbGljZV9jb21tb24sCi0JCQkJICAgICZhY2N1X2luc3Rkb25lLT5zbGljZV9jb21tb24p
OwotCi0JZm9yX2VhY2hfaW5zdGRvbmVfc2xpY2Vfc3Vic2xpY2UoZGV2X3ByaXYsIHNsaWNlLCBz
dWJzbGljZSkgewotCQlzdHVjayAmPSBpbnN0ZG9uZV91bmNoYW5nZWQoaW5zdGRvbmUuc2FtcGxl
cltzbGljZV1bc3Vic2xpY2VdLAotCQkJCQkgICAgJmFjY3VfaW5zdGRvbmUtPnNhbXBsZXJbc2xp
Y2VdW3N1YnNsaWNlXSk7Ci0JCXN0dWNrICY9IGluc3Rkb25lX3VuY2hhbmdlZChpbnN0ZG9uZS5y
b3dbc2xpY2VdW3N1YnNsaWNlXSwKLQkJCQkJICAgICZhY2N1X2luc3Rkb25lLT5yb3dbc2xpY2Vd
W3N1YnNsaWNlXSk7Ci0JfQotCi0JcmV0dXJuIHN0dWNrOwotfQotCi1zdGF0aWMgZW51bSBpbnRl
bF9lbmdpbmVfaGFuZ2NoZWNrX2FjdGlvbgotaGVhZF9zdHVjayhzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUsIHU2NCBhY3RoZCkKLXsKLQlpZiAoYWN0aGQgIT0gZW5naW5lLT5oYW5nY2hl
Y2suYWN0aGQpIHsKLQotCQkvKiBDbGVhciBzdWJ1bml0IHN0YXRlcyBvbiBoZWFkIG1vdmVtZW50
ICovCi0JCW1lbXNldCgmZW5naW5lLT5oYW5nY2hlY2suaW5zdGRvbmUsIDAsCi0JCSAgICAgICBz
aXplb2YoZW5naW5lLT5oYW5nY2hlY2suaW5zdGRvbmUpKTsKLQotCQlyZXR1cm4gRU5HSU5FX0FD
VElWRV9IRUFEOwotCX0KLQotCWlmICghc3VidW5pdHNfc3R1Y2soZW5naW5lKSkKLQkJcmV0dXJu
IEVOR0lORV9BQ1RJVkVfU1VCVU5JVFM7Ci0KLQlyZXR1cm4gRU5HSU5FX0RFQUQ7Ci19Ci0KLXN0
YXRpYyBlbnVtIGludGVsX2VuZ2luZV9oYW5nY2hlY2tfYWN0aW9uCi1lbmdpbmVfc3R1Y2soc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1NjQgYWN0aGQpCi17Ci0JZW51bSBpbnRlbF9l
bmdpbmVfaGFuZ2NoZWNrX2FjdGlvbiBoYTsKLQl1MzIgdG1wOwotCi0JaGEgPSBoZWFkX3N0dWNr
KGVuZ2luZSwgYWN0aGQpOwotCWlmIChoYSAhPSBFTkdJTkVfREVBRCkKLQkJcmV0dXJuIGhhOwot
Ci0JaWYgKElTX0dFTihlbmdpbmUtPmk5MTUsIDIpKQotCQlyZXR1cm4gRU5HSU5FX0RFQUQ7Ci0K
LQkvKiBJcyB0aGUgY2hpcCBoYW5naW5nIG9uIGEgV0FJVF9GT1JfRVZFTlQ/Ci0JICogSWYgc28g
d2UgY2FuIHNpbXBseSBwb2tlIHRoZSBSQl9XQUlUIGJpdAotCSAqIGFuZCBicmVhayB0aGUgaGFu
Zy4gVGhpcyBzaG91bGQgd29yayBvbgotCSAqIGFsbCBidXQgdGhlIHNlY29uZCBnZW5lcmF0aW9u
IGNoaXBzZXRzLgotCSAqLwotCXRtcCA9IEVOR0lORV9SRUFEKGVuZ2luZSwgUklOR19DVEwpOwot
CWlmICh0bXAgJiBSSU5HX1dBSVQpIHsKLQkJaW50ZWxfZ3RfaGFuZGxlX2Vycm9yKGVuZ2luZS0+
Z3QsIGVuZ2luZS0+bWFzaywgMCwKLQkJCQkgICAgICAic3R1Y2sgd2FpdCBvbiAlcyIsIGVuZ2lu
ZS0+bmFtZSk7Ci0JCUVOR0lORV9XUklURShlbmdpbmUsIFJJTkdfQ1RMLCB0bXApOwotCQlyZXR1
cm4gRU5HSU5FX1dBSVRfS0lDSzsKLQl9Ci0KLQlyZXR1cm4gRU5HSU5FX0RFQUQ7Ci19Ci0KLXN0
YXRpYyB2b2lkIGhhbmdjaGVja19sb2FkX3NhbXBsZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICpl
bmdpbmUsCi0JCQkJICBzdHJ1Y3QgaGFuZ2NoZWNrICpoYykKLXsKLQloYy0+YWN0aGQgPSBpbnRl
bF9lbmdpbmVfZ2V0X2FjdGl2ZV9oZWFkKGVuZ2luZSk7Ci0JaGMtPnJpbmcgPSBFTkdJTkVfUkVB
RChlbmdpbmUsIFJJTkdfU1RBUlQpOwotCWhjLT5oZWFkID0gRU5HSU5FX1JFQUQoZW5naW5lLCBS
SU5HX0hFQUQpOwotfQotCi1zdGF0aWMgdm9pZCBoYW5nY2hlY2tfc3RvcmVfc2FtcGxlKHN0cnVj
dCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKLQkJCQkgICBjb25zdCBzdHJ1Y3QgaGFuZ2NoZWNr
ICpoYykKLXsKLQllbmdpbmUtPmhhbmdjaGVjay5hY3RoZCA9IGhjLT5hY3RoZDsKLQllbmdpbmUt
PmhhbmdjaGVjay5sYXN0X3JpbmcgPSBoYy0+cmluZzsKLQllbmdpbmUtPmhhbmdjaGVjay5sYXN0
X2hlYWQgPSBoYy0+aGVhZDsKLX0KLQotc3RhdGljIGVudW0gaW50ZWxfZW5naW5lX2hhbmdjaGVj
a19hY3Rpb24KLWhhbmdjaGVja19nZXRfYWN0aW9uKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSwKLQkJICAgICBjb25zdCBzdHJ1Y3QgaGFuZ2NoZWNrICpoYykKLXsKLQlpZiAoaW50ZWxf
ZW5naW5lX2lzX2lkbGUoZW5naW5lKSkKLQkJcmV0dXJuIEVOR0lORV9JRExFOwotCi0JaWYgKGVu
Z2luZS0+aGFuZ2NoZWNrLmxhc3RfcmluZyAhPSBoYy0+cmluZykKLQkJcmV0dXJuIEVOR0lORV9B
Q1RJVkVfU0VRTk87Ci0KLQlpZiAoZW5naW5lLT5oYW5nY2hlY2subGFzdF9oZWFkICE9IGhjLT5o
ZWFkKQotCQlyZXR1cm4gRU5HSU5FX0FDVElWRV9TRVFOTzsKLQotCXJldHVybiBlbmdpbmVfc3R1
Y2soZW5naW5lLCBoYy0+YWN0aGQpOwotfQotCi1zdGF0aWMgdm9pZCBoYW5nY2hlY2tfYWNjdW11
bGF0ZV9zYW1wbGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAotCQkJCQlzdHJ1Y3Qg
aGFuZ2NoZWNrICpoYykKLXsKLQl1bnNpZ25lZCBsb25nIHRpbWVvdXQgPSBJOTE1X0VOR0lORV9E
RUFEX1RJTUVPVVQ7Ci0KLQloYy0+YWN0aW9uID0gaGFuZ2NoZWNrX2dldF9hY3Rpb24oZW5naW5l
LCBoYyk7Ci0KLQkvKiBXZSBhbHdheXMgaW5jcmVtZW50IHRoZSBwcm9ncmVzcwotCSAqIGlmIHRo
ZSBlbmdpbmUgaXMgYnVzeSBhbmQgc3RpbGwgcHJvY2Vzc2luZwotCSAqIHRoZSBzYW1lIHJlcXVl
c3QsIHNvIHRoYXQgbm8gc2luZ2xlIHJlcXVlc3QKLQkgKiBjYW4gcnVuIGluZGVmaW5pdGVseSAo
c3VjaCBhcyBhIGNoYWluIG9mCi0JICogYmF0Y2hlcykuIFRoZSBvbmx5IHRpbWUgd2UgZG8gbm90
IGluY3JlbWVudAotCSAqIHRoZSBoYW5nY2hlY2sgc2NvcmUgb24gdGhpcyByaW5nLCBpZiB0aGlz
Ci0JICogZW5naW5lIGlzIGluIGEgbGVnaXRpbWF0ZSB3YWl0IGZvciBhbm90aGVyCi0JICogZW5n
aW5lLiBJbiB0aGF0IGNhc2UgdGhlIHdhaXRpbmcgZW5naW5lIGlzIGEKLQkgKiB2aWN0aW0gYW5k
IHdlIHdhbnQgdG8gYmUgc3VyZSB3ZSBjYXRjaCB0aGUKLQkgKiByaWdodCBjdWxwcml0LiBUaGVu
IGV2ZXJ5IHRpbWUgd2UgZG8ga2ljawotCSAqIHRoZSByaW5nLCBtYWtlIGl0IGFzIGEgcHJvZ3Jl
c3MgYXMgdGhlIHNlcW5vCi0JICogYWR2YW5jZW1lbnQgbWlnaHQgZW5zdXJlIGFuZCBpZiBub3Qs
IGl0Ci0JICogd2lsbCBjYXRjaCB0aGUgaGFuZ2luZyBlbmdpbmUuCi0JICovCi0KLQlzd2l0Y2gg
KGhjLT5hY3Rpb24pIHsKLQljYXNlIEVOR0lORV9JRExFOgotCWNhc2UgRU5HSU5FX0FDVElWRV9T
RVFOTzoKLQkJLyogQ2xlYXIgaGVhZCBhbmQgc3VidW5pdCBzdGF0ZXMgb24gc2Vxbm8gbW92ZW1l
bnQgKi8KLQkJaGMtPmFjdGhkID0gMDsKLQotCQltZW1zZXQoJmVuZ2luZS0+aGFuZ2NoZWNrLmlu
c3Rkb25lLCAwLAotCQkgICAgICAgc2l6ZW9mKGVuZ2luZS0+aGFuZ2NoZWNrLmluc3Rkb25lKSk7
Ci0KLQkJLyogSW50ZW50aW9uYWwgZmFsbCB0aHJvdWdoICovCi0JY2FzZSBFTkdJTkVfV0FJVF9L
SUNLOgotCWNhc2UgRU5HSU5FX1dBSVQ6Ci0JCWVuZ2luZS0+aGFuZ2NoZWNrLmFjdGlvbl90aW1l
c3RhbXAgPSBqaWZmaWVzOwotCQlicmVhazsKLQotCWNhc2UgRU5HSU5FX0FDVElWRV9IRUFEOgot
CWNhc2UgRU5HSU5FX0FDVElWRV9TVUJVTklUUzoKLQkJLyoKLQkJICogU2Vxbm8gc3R1Y2sgd2l0
aCBzdGlsbCBhY3RpdmUgZW5naW5lIGdldHMgbGVld2F5LAotCQkgKiBpbiBob3BlcyB0aGF0IGl0
IGlzIGp1c3QgYSBsb25nIHNoYWRlci4KLQkJICovCi0JCXRpbWVvdXQgPSBJOTE1X1NFUU5PX0RF
QURfVElNRU9VVDsKLQkJYnJlYWs7Ci0KLQljYXNlIEVOR0lORV9ERUFEOgotCQlicmVhazsKLQot
CWRlZmF1bHQ6Ci0JCU1JU1NJTkdfQ0FTRShoYy0+YWN0aW9uKTsKLQl9Ci0KLQloYy0+c3RhbGxl
ZCA9IHRpbWVfYWZ0ZXIoamlmZmllcywKLQkJCQkgZW5naW5lLT5oYW5nY2hlY2suYWN0aW9uX3Rp
bWVzdGFtcCArIHRpbWVvdXQpOwotCWhjLT53ZWRnZWQgPSB0aW1lX2FmdGVyKGppZmZpZXMsCi0J
CQkJIGVuZ2luZS0+aGFuZ2NoZWNrLmFjdGlvbl90aW1lc3RhbXAgKwotCQkJCSBJOTE1X0VOR0lO
RV9XRURHRURfVElNRU9VVCk7Ci19Ci0KLXN0YXRpYyB2b2lkIGhhbmdjaGVja19kZWNsYXJlX2hh
bmcoc3RydWN0IGludGVsX2d0ICpndCwKLQkJCQkgICBpbnRlbF9lbmdpbmVfbWFza190IGh1bmcs
Ci0JCQkJICAgaW50ZWxfZW5naW5lX21hc2tfdCBzdHVjaykKLXsKLQlzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmU7Ci0JaW50ZWxfZW5naW5lX21hc2tfdCB0bXA7Ci0JY2hhciBtc2dbODBd
OwotCWludCBsZW47Ci0KLQkvKiBJZiBzb21lIHJpbmdzIGh1bmcgYnV0IG90aGVycyB3ZXJlIHN0
aWxsIGJ1c3ksIG9ubHkKLQkgKiBibGFtZSB0aGUgaGFuZ2luZyByaW5ncyBpbiB0aGUgc3lub3Bz
aXMuCi0JICovCi0JaWYgKHN0dWNrICE9IGh1bmcpCi0JCWh1bmcgJj0gfnN0dWNrOwotCWxlbiA9
IHNjbnByaW50Zihtc2csIHNpemVvZihtc2cpLAotCQkJIiVzIG9uICIsIHN0dWNrID09IGh1bmcg
PyAibm8gcHJvZ3Jlc3MiIDogImhhbmciKTsKLQlmb3JfZWFjaF9lbmdpbmVfbWFza2VkKGVuZ2lu
ZSwgZ3QtPmk5MTUsIGh1bmcsIHRtcCkKLQkJbGVuICs9IHNjbnByaW50Zihtc2cgKyBsZW4sIHNp
emVvZihtc2cpIC0gbGVuLAotCQkJCSAiJXMsICIsIGVuZ2luZS0+bmFtZSk7Ci0JbXNnW2xlbi0y
XSA9ICdcMCc7Ci0KLQlyZXR1cm4gaW50ZWxfZ3RfaGFuZGxlX2Vycm9yKGd0LCBodW5nLCBJOTE1
X0VSUk9SX0NBUFRVUkUsICIlcyIsIG1zZyk7Ci19Ci0KLS8qCi0gKiBUaGlzIGlzIGNhbGxlZCB3
aGVuIHRoZSBjaGlwIGhhc24ndCByZXBvcnRlZCBiYWNrIHdpdGggY29tcGxldGVkCi0gKiBiYXRj
aGJ1ZmZlcnMgaW4gYSBsb25nIHRpbWUuIFdlIGtlZXAgdHJhY2sgcGVyIHJpbmcgc2Vxbm8gcHJv
Z3Jlc3MgYW5kCi0gKiBpZiB0aGVyZSBhcmUgbm8gcHJvZ3Jlc3MsIGhhbmdjaGVjayBzY29yZSBm
b3IgdGhhdCByaW5nIGlzIGluY3JlYXNlZC4KLSAqIEZ1cnRoZXIsIGFjdGhkIGlzIGluc3BlY3Rl
ZCB0byBzZWUgaWYgdGhlIHJpbmcgaXMgc3R1Y2suIE9uIHN0dWNrIGNhc2UKLSAqIHdlIGtpY2sg
dGhlIHJpbmcuIElmIHdlIHNlZSBubyBwcm9ncmVzcyBvbiB0aHJlZSBzdWJzZXF1ZW50IGNhbGxz
Ci0gKiB3ZSBhc3N1bWUgY2hpcCBpcyB3ZWRnZWQgYW5kIHRyeSB0byBmaXggaXQgYnkgcmVzZXR0
aW5nIHRoZSBjaGlwLgotICovCi1zdGF0aWMgdm9pZCBoYW5nY2hlY2tfZWxhcHNlZChzdHJ1Y3Qg
d29ya19zdHJ1Y3QgKndvcmspCi17Ci0Jc3RydWN0IGludGVsX2d0ICpndCA9Ci0JCWNvbnRhaW5l
cl9vZih3b3JrLCB0eXBlb2YoKmd0KSwgaGFuZ2NoZWNrLndvcmsud29yayk7Ci0JaW50ZWxfZW5n
aW5lX21hc2tfdCBodW5nID0gMCwgc3R1Y2sgPSAwLCB3ZWRnZWQgPSAwOwotCXN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZTsKLQllbnVtIGludGVsX2VuZ2luZV9pZCBpZDsKLQlpbnRlbF93
YWtlcmVmX3Qgd2FrZXJlZjsKLQotCWlmICghaTkxNV9tb2RwYXJhbXMuZW5hYmxlX2hhbmdjaGVj
aykKLQkJcmV0dXJuOwotCi0JaWYgKCFSRUFEX09OQ0UoZ3QtPmF3YWtlKSkKLQkJcmV0dXJuOwot
Ci0JaWYgKGludGVsX2d0X2lzX3dlZGdlZChndCkpCi0JCXJldHVybjsKLQotCXdha2VyZWYgPSBp
bnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoJmd0LT5pOTE1LT5ydW50aW1lX3BtKTsKLQlp
ZiAoIXdha2VyZWYpCi0JCXJldHVybjsKLQotCS8qIEFzIGVuYWJsaW5nIHRoZSBHUFUgcmVxdWly
ZXMgZmFpcmx5IGV4dGVuc2l2ZSBtbWlvIGFjY2VzcywKLQkgKiBwZXJpb2RpY2FsbHkgYXJtIHRo
ZSBtbWlvIGNoZWNrZXIgdG8gc2VlIGlmIHdlIGFyZSB0cmlnZ2VyaW5nCi0JICogYW55IGludmFs
aWQgYWNjZXNzLgotCSAqLwotCWludGVsX3VuY29yZV9hcm1fdW5jbGFpbWVkX21taW9fZGV0ZWN0
aW9uKGd0LT51bmNvcmUpOwotCi0JZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlk
KSB7Ci0JCXN0cnVjdCBoYW5nY2hlY2sgaGM7Ci0KLQkJaW50ZWxfZW5naW5lX3NpZ25hbF9icmVh
ZGNydW1icyhlbmdpbmUpOwotCi0JCWhhbmdjaGVja19sb2FkX3NhbXBsZShlbmdpbmUsICZoYyk7
Ci0JCWhhbmdjaGVja19hY2N1bXVsYXRlX3NhbXBsZShlbmdpbmUsICZoYyk7Ci0JCWhhbmdjaGVj
a19zdG9yZV9zYW1wbGUoZW5naW5lLCAmaGMpOwotCi0JCWlmIChoYy5zdGFsbGVkKSB7Ci0JCQlo
dW5nIHw9IGVuZ2luZS0+bWFzazsKLQkJCWlmIChoYy5hY3Rpb24gIT0gRU5HSU5FX0RFQUQpCi0J
CQkJc3R1Y2sgfD0gZW5naW5lLT5tYXNrOwotCQl9Ci0KLQkJaWYgKGhjLndlZGdlZCkKLQkJCXdl
ZGdlZCB8PSBlbmdpbmUtPm1hc2s7Ci0JfQotCi0JaWYgKEdFTV9TSE9XX0RFQlVHKCkgJiYgKGh1
bmcgfCBzdHVjaykpIHsKLQkJc3RydWN0IGRybV9wcmludGVyIHAgPSBkcm1fZGVidWdfcHJpbnRl
cigiaGFuZ2NoZWNrIik7Ci0KLQkJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3QtPmk5MTUsIGlk
KSB7Ci0JCQlpZiAoaW50ZWxfZW5naW5lX2lzX2lkbGUoZW5naW5lKSkKLQkJCQljb250aW51ZTsK
LQotCQkJaW50ZWxfZW5naW5lX2R1bXAoZW5naW5lLCAmcCwgIiVzXG4iLCBlbmdpbmUtPm5hbWUp
OwotCQl9Ci0JfQotCi0JaWYgKHdlZGdlZCkgewotCQlkZXZfZXJyKGd0LT5pOTE1LT5kcm0uZGV2
LAotCQkJIkdQVSByZWNvdmVyeSB0aW1lZCBvdXQsIgotCQkJIiBjYW5jZWxsaW5nIGFsbCBpbi1m
bGlnaHQgcmVuZGVyaW5nLlxuIik7Ci0JCUdFTV9UUkFDRV9EVU1QKCk7Ci0JCWludGVsX2d0X3Nl
dF93ZWRnZWQoZ3QpOwotCX0KLQotCWlmIChodW5nKQotCQloYW5nY2hlY2tfZGVjbGFyZV9oYW5n
KGd0LCBodW5nLCBzdHVjayk7Ci0KLQlpbnRlbF9ydW50aW1lX3BtX3B1dCgmZ3QtPmk5MTUtPnJ1
bnRpbWVfcG0sIHdha2VyZWYpOwotCi0JLyogUmVzZXQgdGltZXIgaW4gY2FzZSBHUFUgaGFuZ3Mg
d2l0aG91dCBhbm90aGVyIHJlcXVlc3QgYmVpbmcgYWRkZWQgKi8KLQlpbnRlbF9ndF9xdWV1ZV9o
YW5nY2hlY2soZ3QpOwotfQotCi12b2lkIGludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhzdHJ1Y3Qg
aW50ZWxfZ3QgKmd0KQotewotCXVuc2lnbmVkIGxvbmcgZGVsYXk7Ci0KLQlpZiAodW5saWtlbHko
IWk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hlY2spKQotCQlyZXR1cm47Ci0KLQkvKgotCSAq
IERvbid0IGNvbnRpbnVhbGx5IGRlZmVyIHRoZSBoYW5nY2hlY2sgc28gdGhhdCBpdCBpcyBhbHdh
eXMgcnVuIGF0Ci0JICogbGVhc3Qgb25jZSBhZnRlciB3b3JrIGhhcyBiZWVuIHNjaGVkdWxlZCBv
biBhbnkgcmluZy4gT3RoZXJ3aXNlLAotCSAqIHdlIHdpbGwgaWdub3JlIGEgaHVuZyByaW5nIGlm
IGEgc2Vjb25kIHJpbmcgaXMga2VwdCBidXN5LgotCSAqLwotCi0JZGVsYXkgPSByb3VuZF9qaWZm
aWVzX3VwX3JlbGF0aXZlKERSTV9JOTE1X0hBTkdDSEVDS19KSUZGSUVTKTsKLQlxdWV1ZV9kZWxh
eWVkX3dvcmsoc3lzdGVtX2xvbmdfd3EsICZndC0+aGFuZ2NoZWNrLndvcmssIGRlbGF5KTsKLX0K
LQotdm9pZCBpbnRlbF9lbmdpbmVfaW5pdF9oYW5nY2hlY2soc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKQotewotCW1lbXNldCgmZW5naW5lLT5oYW5nY2hlY2ssIDAsIHNpemVvZihlbmdp
bmUtPmhhbmdjaGVjaykpOwotCWVuZ2luZS0+aGFuZ2NoZWNrLmFjdGlvbl90aW1lc3RhbXAgPSBq
aWZmaWVzOwotfQotCi12b2lkIGludGVsX2d0X2luaXRfaGFuZ2NoZWNrKHN0cnVjdCBpbnRlbF9n
dCAqZ3QpCi17Ci0JSU5JVF9ERUxBWUVEX1dPUksoJmd0LT5oYW5nY2hlY2sud29yaywgaGFuZ2No
ZWNrX2VsYXBzZWQpOwotfQotCi0jaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfU0VMRlRF
U1QpCi0jaW5jbHVkZSAic2VsZnRlc3RfaGFuZ2NoZWNrLmMiCi0jZW5kaWYKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9yZXNldC5jCmluZGV4IDk4YzA3MWZlNTMyYi4uMGNiNDU3NTM4ZTYyIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNldC5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMKQEAgLTk3OCw4ICs5NzgsNiBAQCB2
b2lkIGludGVsX2d0X3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QsCiAJaWYgKHJldCkKIAkJZ290
byB0YWludDsKIAotCWludGVsX2d0X3F1ZXVlX2hhbmdjaGVjayhndCk7Ci0KIGZpbmlzaDoKIAly
ZXNldF9maW5pc2goZ3QsIGF3YWtlKTsKIHVubG9jazoKQEAgLTEzMDUsNCArMTMwMyw1IEBAIHZv
aWQgX19pbnRlbF9maW5pX3dlZGdlKHN0cnVjdCBpbnRlbF93ZWRnZV9tZSAqdykKIAogI2lmIElT
X0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X1NFTEZURVNUKQogI2luY2x1ZGUgInNlbGZ0ZXN0X3Jl
c2V0LmMiCisjaW5jbHVkZSAic2VsZnRlc3RfaGFuZ2NoZWNrLmMiCiAjZW5kaWYKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfaGFuZ2NoZWNrLmMKaW5kZXggZTJmYTM4YTFmZjBm
Li4wYmFkZWU1NjcyNzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X2hhbmdjaGVjay5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2hh
bmdjaGVjay5jCkBAIC0xNzMyLDcgKzE3MzIsNiBAQCBpbnQgaW50ZWxfaGFuZ2NoZWNrX2xpdmVf
c2VsZnRlc3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCX07CiAJc3RydWN0IGlu
dGVsX2d0ICpndCA9ICZpOTE1LT5ndDsKIAlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKLQlib29s
IHNhdmVkX2hhbmdjaGVjazsKIAlpbnQgZXJyOwogCiAJaWYgKCFpbnRlbF9oYXNfZ3B1X3Jlc2V0
KGd0LT5pOTE1KSkKQEAgLTE3NDIsNyArMTc0MSw2IEBAIGludCBpbnRlbF9oYW5nY2hlY2tfbGl2
ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJCXJldHVybiAtRUlP
OyAvKiB3ZSdyZSBsb25nIHBhc3QgaG9wZSBvZiBhIHN1Y2Nlc3NmdWwgcmVzZXQgKi8KIAogCXdh
a2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmZ3QtPmk5MTUtPnJ1bnRpbWVfcG0pOwotCXNh
dmVkX2hhbmdjaGVjayA9IGZldGNoX2FuZF96ZXJvKCZpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFu
Z2NoZWNrKTsKIAlkcmFpbl9kZWxheWVkX3dvcmsoJmd0LT5oYW5nY2hlY2sud29yayk7IC8qIGZs
dXNoIHBhcmFtICovCiAKIAllcnIgPSBpbnRlbF9ndF9saXZlX3N1YnRlc3RzKHRlc3RzLCBndCk7
CkBAIC0xNzUxLDcgKzE3NDksNiBAQCBpbnQgaW50ZWxfaGFuZ2NoZWNrX2xpdmVfc2VsZnRlc3Rz
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWlndF9mbHVzaF90ZXN0KGd0LT5pOTE1
LCBJOTE1X1dBSVRfTE9DS0VEKTsKIAltdXRleF91bmxvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKIAotCWk5MTVfbW9kcGFyYW1zLmVuYWJsZV9oYW5nY2hlY2sgPSBzYXZlZF9oYW5n
Y2hlY2s7CiAJaW50ZWxfcnVudGltZV9wbV9wdXQoJmd0LT5pOTE1LT5ydW50aW1lX3BtLCB3YWtl
cmVmKTsKIAogCXJldHVybiBlcnI7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2RlYnVnZnMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCmluZGV4
IDI0Nzg3YmI0OGM5Zi4uMWYwNDA4ZmYzNDViIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2RlYnVnZnMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVn
ZnMuYwpAQCAtMTA0NCw5MSArMTA0NCw2IEBAIHN0YXRpYyBpbnQgaTkxNV9mcmVxdWVuY3lfaW5m
byhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKnVudXNlZCkKIAlyZXR1cm4gcmV0OwogfQogCi1z
dGF0aWMgdm9pZCBpOTE1X2luc3Rkb25lX2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAotCQkJICAgICAgIHN0cnVjdCBzZXFfZmlsZSAqbSwKLQkJCSAgICAgICBzdHJ1Y3Qg
aW50ZWxfaW5zdGRvbmUgKmluc3Rkb25lKQotewotCWludCBzbGljZTsKLQlpbnQgc3Vic2xpY2U7
Ci0KLQlzZXFfcHJpbnRmKG0sICJcdFx0SU5TVERPTkU6IDB4JTA4eFxuIiwKLQkJICAgaW5zdGRv
bmUtPmluc3Rkb25lKTsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDMpCi0JCXJldHVy
bjsKLQotCXNlcV9wcmludGYobSwgIlx0XHRTQ19JTlNURE9ORTogMHglMDh4XG4iLAotCQkgICBp
bnN0ZG9uZS0+c2xpY2VfY29tbW9uKTsKLQotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDw9IDYp
Ci0JCXJldHVybjsKLQotCWZvcl9lYWNoX2luc3Rkb25lX3NsaWNlX3N1YnNsaWNlKGRldl9wcml2
LCBzbGljZSwgc3Vic2xpY2UpCi0JCXNlcV9wcmludGYobSwgIlx0XHRTQU1QTEVSX0lOU1RET05F
WyVkXVslZF06IDB4JTA4eFxuIiwKLQkJCSAgIHNsaWNlLCBzdWJzbGljZSwgaW5zdGRvbmUtPnNh
bXBsZXJbc2xpY2VdW3N1YnNsaWNlXSk7Ci0KLQlmb3JfZWFjaF9pbnN0ZG9uZV9zbGljZV9zdWJz
bGljZShkZXZfcHJpdiwgc2xpY2UsIHN1YnNsaWNlKQotCQlzZXFfcHJpbnRmKG0sICJcdFx0Uk9X
X0lOU1RET05FWyVkXVslZF06IDB4JTA4eFxuIiwKLQkJCSAgIHNsaWNlLCBzdWJzbGljZSwgaW5z
dGRvbmUtPnJvd1tzbGljZV1bc3Vic2xpY2VdKTsKLX0KLQotc3RhdGljIGludCBpOTE1X2hhbmdj
aGVja19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdW51c2VkKQotewotCXN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwotCXN0cnVj
dCBpbnRlbF9ndCAqZ3QgPSAmaTkxNS0+Z3Q7Ci0Jc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lOwotCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwotCWVudW0gaW50ZWxfZW5naW5lX2lkIGlk
OwotCi0Jc2VxX3ByaW50ZihtLCAiUmVzZXQgZmxhZ3M6ICVseFxuIiwgZ3QtPnJlc2V0LmZsYWdz
KTsKLQlpZiAodGVzdF9iaXQoSTkxNV9XRURHRUQsICZndC0+cmVzZXQuZmxhZ3MpKQotCQlzZXFf
cHV0cyhtLCAiXHRXZWRnZWRcbiIpOwotCWlmICh0ZXN0X2JpdChJOTE1X1JFU0VUX0JBQ0tPRkYs
ICZndC0+cmVzZXQuZmxhZ3MpKQotCQlzZXFfcHV0cyhtLCAiXHREZXZpY2UgKGdsb2JhbCkgcmVz
ZXQgaW4gcHJvZ3Jlc3NcbiIpOwotCi0JaWYgKCFpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2No
ZWNrKSB7Ci0JCXNlcV9wdXRzKG0sICJIYW5nY2hlY2sgZGlzYWJsZWRcbiIpOwotCQlyZXR1cm4g
MDsKLQl9Ci0KLQlpZiAodGltZXJfcGVuZGluZygmZ3QtPmhhbmdjaGVjay53b3JrLnRpbWVyKSkK
LQkJc2VxX3ByaW50ZihtLCAiSGFuZ2NoZWNrIGFjdGl2ZSwgdGltZXIgZmlyZXMgaW4gJWRtc1xu
IiwKLQkJCSAgIGppZmZpZXNfdG9fbXNlY3MoZ3QtPmhhbmdjaGVjay53b3JrLnRpbWVyLmV4cGly
ZXMgLQotCQkJCQkgICAgamlmZmllcykpOwotCWVsc2UgaWYgKGRlbGF5ZWRfd29ya19wZW5kaW5n
KCZndC0+aGFuZ2NoZWNrLndvcmspKQotCQlzZXFfcHV0cyhtLCAiSGFuZ2NoZWNrIGFjdGl2ZSwg
d29yayBwZW5kaW5nXG4iKTsKLQllbHNlCi0JCXNlcV9wdXRzKG0sICJIYW5nY2hlY2sgaW5hY3Rp
dmVcbiIpOwotCi0Jc2VxX3ByaW50ZihtLCAiR1QgYWN0aXZlPyAlc1xuIiwgeWVzbm8oZ3QtPmF3
YWtlKSk7Ci0KLQl3aXRoX2ludGVsX3J1bnRpbWVfcG0oJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2Vy
ZWYpIHsKLQkJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKLQkJCXN0cnVjdCBp
bnRlbF9pbnN0ZG9uZSBpbnN0ZG9uZTsKLQotCQkJc2VxX3ByaW50ZihtLCAiJXM6ICVkIG1zIGFn
b1xuIiwKLQkJCQkgICBlbmdpbmUtPm5hbWUsCi0JCQkJICAgamlmZmllc190b19tc2VjcyhqaWZm
aWVzIC0KLQkJCQkJCSAgICBlbmdpbmUtPmhhbmdjaGVjay5hY3Rpb25fdGltZXN0YW1wKSk7Ci0K
LQkJCXNlcV9wcmludGYobSwgIlx0QUNUSEQgPSAweCUwOGxseCBbY3VycmVudCAweCUwOGxseF1c
biIsCi0JCQkJICAgKGxvbmcgbG9uZyllbmdpbmUtPmhhbmdjaGVjay5hY3RoZCwKLQkJCQkgICBp
bnRlbF9lbmdpbmVfZ2V0X2FjdGl2ZV9oZWFkKGVuZ2luZSkpOwotCi0JCQlpbnRlbF9lbmdpbmVf
Z2V0X2luc3Rkb25lKGVuZ2luZSwgJmluc3Rkb25lKTsKLQotCQkJc2VxX3B1dHMobSwgIlx0aW5z
dGRvbmUgcmVhZCA9XG4iKTsKLQkJCWk5MTVfaW5zdGRvbmVfaW5mbyhpOTE1LCBtLCAmaW5zdGRv
bmUpOwotCi0JCQlzZXFfcHV0cyhtLCAiXHRpbnN0ZG9uZSBhY2N1ID1cbiIpOwotCQkJaTkxNV9p
bnN0ZG9uZV9pbmZvKGk5MTUsIG0sCi0JCQkJCSAgICZlbmdpbmUtPmhhbmdjaGVjay5pbnN0ZG9u
ZSk7Ci0JCX0KLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBpcm9ubGFrZV9kcnBj
X2luZm8oc3RydWN0IHNlcV9maWxlICptKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1ID0gbm9kZV90b19pOTE1KG0tPnByaXZhdGUpOwpAQCAtNDM4Nyw3ICs0MzAyLDYgQEAgc3Rh
dGljIGNvbnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGk5MTVfZGVidWdmc19saXN0W10gPSB7CiAJ
eyJpOTE1X2d1Y19zdGFnZV9wb29sIiwgaTkxNV9ndWNfc3RhZ2VfcG9vbCwgMH0sCiAJeyJpOTE1
X2h1Y19sb2FkX3N0YXR1cyIsIGk5MTVfaHVjX2xvYWRfc3RhdHVzX2luZm8sIDB9LAogCXsiaTkx
NV9mcmVxdWVuY3lfaW5mbyIsIGk5MTVfZnJlcXVlbmN5X2luZm8sIDB9LAotCXsiaTkxNV9oYW5n
Y2hlY2tfaW5mbyIsIGk5MTVfaGFuZ2NoZWNrX2luZm8sIDB9LAogCXsiaTkxNV9kcnBjX2luZm8i
LCBpOTE1X2RycGNfaW5mbywgMH0sCiAJeyJpOTE1X2Vtb25fc3RhdHVzIiwgaTkxNV9lbW9uX3N0
YXR1cywgMH0sCiAJeyJpOTE1X3JpbmdfZnJlcV90YWJsZSIsIGk5MTVfcmluZ19mcmVxX3RhYmxl
LCAwfSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCmluZGV4IGYyZDNkNzU0YWYzNy4uNzY5OTNlYmEz
Zjg5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKQEAgLTQxMSw4ICs0MTEsNyBAQCBzdGF0aWMg
aW50IGk5MTVfZ2V0cGFyYW1faW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0
YSwKIAkJCXJldHVybiAtRU5PREVWOwogCQlicmVhazsKIAljYXNlIEk5MTVfUEFSQU1fSEFTX0dQ
VV9SRVNFVDoKLQkJdmFsdWUgPSBpOTE1X21vZHBhcmFtcy5lbmFibGVfaGFuZ2NoZWNrICYmCi0J
CQlpbnRlbF9oYXNfZ3B1X3Jlc2V0KGRldl9wcml2KTsKKwkJdmFsdWUgPSBpbnRlbF9oYXNfZ3B1
X3Jlc2V0KGRldl9wcml2KTsKIAkJaWYgKHZhbHVlICYmIGludGVsX2hhc19yZXNldF9lbmdpbmUo
ZGV2X3ByaXYpKQogCQkJdmFsdWUgPSAyOwogCQlicmVhazsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5o
CmluZGV4IDU5ZDRhMTE0NjAzOS4uMGU3MTViMTI2NmYwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2
LmgKQEAgLTIzNzUsNyArMjM3NSw2IEBAIGV4dGVybiBjb25zdCBzdHJ1Y3QgZGV2X3BtX29wcyBp
OTE1X3BtX29wczsKIGludCBpOTE1X2RyaXZlcl9wcm9iZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwg
Y29uc3Qgc3RydWN0IHBjaV9kZXZpY2VfaWQgKmVudCk7CiB2b2lkIGk5MTVfZHJpdmVyX3JlbW92
ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsKIAotdm9pZCBpbnRlbF9lbmdpbmVfaW5pdF9oYW5n
Y2hlY2soc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKIGludCB2bHZfZm9yY2VfZ2Z4
X2Nsb2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBvbik7CiAKIHN0
YXRpYyBpbmxpbmUgYm9vbCBpbnRlbF9ndnRfYWN0aXZlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vy
cm9yLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCmluZGV4IDY3NGQz
NDFhMjNmNi4uZWZmMTBjYTVhNzg4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dwdV9lcnJvci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9y
LmMKQEAgLTU1NCwxMCArNTU0LDYgQEAgc3RhdGljIHZvaWQgZXJyb3JfcHJpbnRfZW5naW5lKHN0
cnVjdCBkcm1faTkxNV9lcnJvcl9zdGF0ZV9idWYgKm0sCiAJfQogCWVycl9wcmludGYobSwgIiAg
cmluZy0+aGVhZDogMHglMDh4XG4iLCBlZS0+Y3B1X3JpbmdfaGVhZCk7CiAJZXJyX3ByaW50Ziht
LCAiICByaW5nLT50YWlsOiAweCUwOHhcbiIsIGVlLT5jcHVfcmluZ190YWlsKTsKLQllcnJfcHJp
bnRmKG0sICIgIGhhbmdjaGVjayB0aW1lc3RhbXA6ICVkbXMgKCVsdSVzKVxuIiwKLQkJICAgamlm
Zmllc190b19tc2VjcyhlZS0+aGFuZ2NoZWNrX3RpbWVzdGFtcCAtIGVwb2NoKSwKLQkJICAgZWUt
PmhhbmdjaGVja190aW1lc3RhbXAsCi0JCSAgIGVlLT5oYW5nY2hlY2tfdGltZXN0YW1wID09IGVw
b2NoID8gIjsgZXBvY2giIDogIiIpOwogCWVycl9wcmludGYobSwgIiAgZW5naW5lIHJlc2V0IGNv
dW50OiAldVxuIiwgZWUtPnJlc2V0X2NvdW50KTsKIAogCWZvciAobiA9IDA7IG4gPCBlZS0+bnVt
X3BvcnRzOyBuKyspIHsKQEAgLTY5NSwxMSArNjkxLDggQEAgc3RhdGljIHZvaWQgX19lcnJfcHJp
bnRfdG9fc2dsKHN0cnVjdCBkcm1faTkxNV9lcnJvcl9zdGF0ZV9idWYgKm0sCiAJdHMgPSBrdGlt
ZV90b190aW1lc3BlYzY0KGVycm9yLT51cHRpbWUpOwogCWVycl9wcmludGYobSwgIlVwdGltZTog
JWxsZCBzICVsZCB1c1xuIiwKIAkJICAgKHM2NCl0cy50dl9zZWMsIHRzLnR2X25zZWMgLyBOU0VD
X1BFUl9VU0VDKTsKLQllcnJfcHJpbnRmKG0sICJFcG9jaDogJWx1IGppZmZpZXMgKCV1IEhaKVxu
IiwgZXJyb3ItPmVwb2NoLCBIWik7Ci0JZXJyX3ByaW50ZihtLCAiQ2FwdHVyZTogJWx1IGppZmZp
ZXM7ICVkIG1zIGFnbywgJWQgbXMgYWZ0ZXIgZXBvY2hcbiIsCi0JCSAgIGVycm9yLT5jYXB0dXJl
LAotCQkgICBqaWZmaWVzX3RvX21zZWNzKGppZmZpZXMgLSBlcnJvci0+Y2FwdHVyZSksCi0JCSAg
IGppZmZpZXNfdG9fbXNlY3MoZXJyb3ItPmNhcHR1cmUgLSBlcnJvci0+ZXBvY2gpKTsKKwllcnJf
cHJpbnRmKG0sICJDYXB0dXJlOiAlbHUgamlmZmllczsgJWQgbXMgYWdvXG4iLAorCQkgICBlcnJv
ci0+Y2FwdHVyZSwgamlmZmllc190b19tc2VjcyhqaWZmaWVzIC0gZXJyb3ItPmNhcHR1cmUpKTsK
IAogCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGVycm9yLT5lbmdpbmUpOyBpKyspIHsKIAkJ
aWYgKCFlcnJvci0+ZW5naW5lW2ldLmNvbnRleHQucGlkKQpAQCAtNzYwLDcgKzc1Myw5IEBAIHN0
YXRpYyB2b2lkIF9fZXJyX3ByaW50X3RvX3NnbChzdHJ1Y3QgZHJtX2k5MTVfZXJyb3Jfc3RhdGVf
YnVmICptLAogCiAJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoZXJyb3ItPmVuZ2luZSk7IGkr
KykgewogCQlpZiAoZXJyb3ItPmVuZ2luZVtpXS5lbmdpbmVfaWQgIT0gLTEpCi0JCQllcnJvcl9w
cmludF9lbmdpbmUobSwgJmVycm9yLT5lbmdpbmVbaV0sIGVycm9yLT5lcG9jaCk7CisJCQllcnJv
cl9wcmludF9lbmdpbmUobSwKKwkJCQkJICAgJmVycm9yLT5lbmdpbmVbaV0sCisJCQkJCSAgIGVy
cm9yLT5jYXB0dXJlKTsKIAl9CiAKIAlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShlcnJvci0+
ZW5naW5lKTsgaSsrKSB7CkBAIC03OTAsNyArNzg1LDcgQEAgc3RhdGljIHZvaWQgX19lcnJfcHJp
bnRfdG9fc2dsKHN0cnVjdCBkcm1faTkxNV9lcnJvcl9zdGF0ZV9idWYgKm0sCiAJCQlmb3IgKGog
PSAwOyBqIDwgZWUtPm51bV9yZXF1ZXN0czsgaisrKQogCQkJCWVycm9yX3ByaW50X3JlcXVlc3Qo
bSwgIiAiLAogCQkJCQkJICAgICZlZS0+cmVxdWVzdHNbal0sCi0JCQkJCQkgICAgZXJyb3ItPmVw
b2NoKTsKKwkJCQkJCSAgICBlcnJvci0+Y2FwdHVyZSk7CiAJCX0KIAogCQlwcmludF9lcnJvcl9v
YmoobSwgbS0+aTkxNS0+ZW5naW5lW2ldLApAQCAtMTE3MSw4ICsxMTY2LDYgQEAgc3RhdGljIHZv
aWQgZXJyb3JfcmVjb3JkX2VuZ2luZV9yZWdpc3RlcnMoc3RydWN0IGk5MTVfZ3B1X3N0YXRlICpl
cnJvciwKIAl9CiAKIAllZS0+aWRsZSA9IGludGVsX2VuZ2luZV9pc19pZGxlKGVuZ2luZSk7Ci0J
aWYgKCFlZS0+aWRsZSkKLQkJZWUtPmhhbmdjaGVja190aW1lc3RhbXAgPSBlbmdpbmUtPmhhbmdj
aGVjay5hY3Rpb25fdGltZXN0YW1wOwogCWVlLT5yZXNldF9jb3VudCA9IGk5MTVfcmVzZXRfZW5n
aW5lX2NvdW50KCZkZXZfcHJpdi0+Z3B1X2Vycm9yLAogCQkJCQkJICBlbmdpbmUpOwogCkBAIC0x
NjczLDIyICsxNjY2LDYgQEAgc3RhdGljIHZvaWQgY2FwdHVyZV9wYXJhbXMoc3RydWN0IGk5MTVf
Z3B1X3N0YXRlICplcnJvcikKIAlpOTE1X3BhcmFtc19jb3B5KCZlcnJvci0+cGFyYW1zLCAmaTkx
NV9tb2RwYXJhbXMpOwogfQogCi1zdGF0aWMgdW5zaWduZWQgbG9uZyBjYXB0dXJlX2ZpbmRfZXBv
Y2goY29uc3Qgc3RydWN0IGk5MTVfZ3B1X3N0YXRlICplcnJvcikKLXsKLQl1bnNpZ25lZCBsb25n
IGVwb2NoID0gZXJyb3ItPmNhcHR1cmU7Ci0JaW50IGk7Ci0KLQlmb3IgKGkgPSAwOyBpIDwgQVJS
QVlfU0laRShlcnJvci0+ZW5naW5lKTsgaSsrKSB7Ci0JCWNvbnN0IHN0cnVjdCBkcm1faTkxNV9l
cnJvcl9lbmdpbmUgKmVlID0gJmVycm9yLT5lbmdpbmVbaV07Ci0KLQkJaWYgKGVlLT5oYW5nY2hl
Y2tfdGltZXN0YW1wICYmCi0JCSAgICB0aW1lX2JlZm9yZShlZS0+aGFuZ2NoZWNrX3RpbWVzdGFt
cCwgZXBvY2gpKQotCQkJZXBvY2ggPSBlZS0+aGFuZ2NoZWNrX3RpbWVzdGFtcDsKLQl9Ci0KLQly
ZXR1cm4gZXBvY2g7Ci19Ci0KIHN0YXRpYyB2b2lkIGNhcHR1cmVfZmluaXNoKHN0cnVjdCBpOTE1
X2dwdV9zdGF0ZSAqZXJyb3IpCiB7CiAJc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCA9ICZlcnJvci0+
aTkxNS0+Z2d0dDsKQEAgLTE3NDAsOCArMTcxNyw2IEBAIGk5MTVfY2FwdHVyZV9ncHVfc3RhdGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJZXJyb3ItPm92ZXJsYXkgPSBpbnRlbF9v
dmVybGF5X2NhcHR1cmVfZXJyb3Jfc3RhdGUoaTkxNSk7CiAJZXJyb3ItPmRpc3BsYXkgPSBpbnRl
bF9kaXNwbGF5X2NhcHR1cmVfZXJyb3Jfc3RhdGUoaTkxNSk7CiAKLQllcnJvci0+ZXBvY2ggPSBj
YXB0dXJlX2ZpbmRfZXBvY2goZXJyb3IpOwotCiAJY2FwdHVyZV9maW5pc2goZXJyb3IpOwogCWNv
bXByZXNzX2ZpbmkoJmNvbXByZXNzKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9ncHVfZXJyb3IuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9y
LmgKaW5kZXggYTI0YzM1MTA3ZDE2Li5jNGJhMjk3Y2E4NjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9ncHVfZXJyb3IuaApAQCAtMzQsNyArMzQsNiBAQCBzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUg
ewogCWt0aW1lX3QgYm9vdHRpbWU7CiAJa3RpbWVfdCB1cHRpbWU7CiAJdW5zaWduZWQgbG9uZyBj
YXB0dXJlOwotCXVuc2lnbmVkIGxvbmcgZXBvY2g7CiAKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNTsKIApAQCAtODQsNyArODMsNiBAQCBzdHJ1Y3QgaTkxNV9ncHVfc3RhdGUgewogCQlp
bnQgZW5naW5lX2lkOwogCQkvKiBTb2Z0d2FyZSB0cmFja2VkIHN0YXRlICovCiAJCWJvb2wgaWRs
ZTsKLQkJdW5zaWduZWQgbG9uZyBoYW5nY2hlY2tfdGltZXN0YW1wOwogCQlpbnQgbnVtX3JlcXVl
c3RzOwogCQl1MzIgcmVzZXRfY291bnQ7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfcGFyYW1zLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BhcmFtcy5jCmlu
ZGV4IDI5NjQ1MmY5ZWZlNC4uZTRjZDU4ZTkwZTQwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3BhcmFtcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcGFy
YW1zLmMKQEAgLTc3LDExICs3Nyw2IEBAIGk5MTVfcGFyYW1fbmFtZWQoZXJyb3JfY2FwdHVyZSwg
Ym9vbCwgMDYwMCwKIAkidHJpYWdpbmcgYW5kIGRlYnVnZ2luZyBoYW5ncy4iKTsKICNlbmRpZgog
Ci1pOTE1X3BhcmFtX25hbWVkX3Vuc2FmZShlbmFibGVfaGFuZ2NoZWNrLCBib29sLCAwNjAwLAot
CSJQZXJpb2RpY2FsbHkgY2hlY2sgR1BVIGFjdGl2aXR5IGZvciBkZXRlY3RpbmcgaGFuZ3MuICIK
LQkiV0FSTklORzogRGlzYWJsaW5nIHRoaXMgY2FuIGNhdXNlIHN5c3RlbSB3aWRlIGhhbmdzLiAi
Ci0JIihkZWZhdWx0OiB0cnVlKSIpOwotCiBpOTE1X3BhcmFtX25hbWVkX3Vuc2FmZShlbmFibGVf
cHNyLCBpbnQsIDA2MDAsCiAJIkVuYWJsZSBQU1IgIgogCSIoMD1kaXNhYmxlZCwgMT1lbmFibGVk
KSAiCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BhcmFtcy5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wYXJhbXMuaAppbmRleCBkMjlhZGUzYjdkZTYuLjlhMzM1
OWM2ZjZmMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wYXJhbXMuaAor
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BhcmFtcy5oCkBAIC02OCw3ICs2OCw2IEBA
IHN0cnVjdCBkcm1fcHJpbnRlcjsKIAlwYXJhbShjaGFyICosIGZvcmNlX3Byb2JlLCBDT05GSUdf
RFJNX0k5MTVfRk9SQ0VfUFJPQkUpIFwKIAkvKiBsZWF2ZSBib29scyBhdCB0aGUgZW5kIHRvIG5v
dCBjcmVhdGUgaG9sZXMgKi8gXAogCXBhcmFtKGJvb2wsIGFscGhhX3N1cHBvcnQsIElTX0VOQUJM
RUQoQ09ORklHX0RSTV9JOTE1X0FMUEhBX1NVUFBPUlQpKSBcCi0JcGFyYW0oYm9vbCwgZW5hYmxl
X2hhbmdjaGVjaywgdHJ1ZSkgXAogCXBhcmFtKGJvb2wsIHByZWZhdWx0X2Rpc2FibGUsIGZhbHNl
KSBcCiAJcGFyYW0oYm9vbCwgbG9hZF9kZXRlY3RfdGVzdCwgZmFsc2UpIFwKIAlwYXJhbShib29s
LCBmb3JjZV9yZXNldF9tb2Rlc2V0X3Rlc3QsIGZhbHNlKSBcCi0tIAoyLjIyLjAKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5n
IGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

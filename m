Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CAEA9142A82
	for <lists+intel-gfx@lfdr.de>; Mon, 20 Jan 2020 13:23:24 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2E4036FA99;
	Mon, 20 Jan 2020 12:23:23 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 29BFE6FA99
 for <intel-gfx@lists.freedesktop.org>; Mon, 20 Jan 2020 12:23:20 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by fmsmga102.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 20 Jan 2020 04:23:19 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.70,342,1574150400"; d="scan'208";a="219638289"
Received: from slisovsk-lenovo-ideapad-720s-13ikb.fi.intel.com ([10.237.72.89])
 by orsmga008.jf.intel.com with ESMTP; 20 Jan 2020 04:23:17 -0800
From: Stanislav Lisovskiy <stanislav.lisovskiy@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 20 Jan 2020 14:21:02 +0200
Message-Id: <20200120122103.26886-5-stanislav.lisovskiy@intel.com>
X-Mailer: git-send-email 2.24.1.485.gad05a3d8e5
In-Reply-To: <20200120122103.26886-1-stanislav.lisovskiy@intel.com>
References: <20200120122103.26886-1-stanislav.lisovskiy@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v15 4/5] drm/i915: Manipulate DBuf slices
 properly
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

U3RhcnQgbWFuaXB1bGF0aW5nIERCdWYgc2xpY2VzIGFzIGEgbWFzaywKYnV0IG5vdCBhcyBhIHRv
dGFsIG51bWJlciwgYXMgY3VycmVudCBhcHByb2FjaApkb2Vzbid0IGdpdmUgdXMgZnVsbCBjb250
cm9sIG9uIGFsbCBjb21iaW5hdGlvbnMKb2Ygc2xpY2VzLCB3aGljaCB3ZSBtaWdodCBuZWVkKGxp
a2UgZW5hYmxpbmcgUzIKb25seSBjYW4ndCBlbmFibGVkIGJ5IHNldHRpbmcgZW5hYmxlZF9zbGlj
ZXM9MSkuCgpSZW1vdmVkIHdyb25nIGNvZGUgZnJvbSBpbnRlbF9nZXRfZGRiX3NpemUgYXMKaXQg
ZG9lc24ndCBtYXRjaCB0byBCU3BlYy4gRm9yIG5vdyBzdGlsbCBqdXN0CnVzZSBEQnVmIHNsaWNl
IHVudGlsIHByb3BlciBhbGdvcml0aG0gaXMgaW1wbGVtZW50ZWQuCgpPdGhlciBtaW5vciBjb2Rl
IHJlZmFjdG9yaW5nIHRvIGdldCBwcmVwYXJlZApmb3IgbWFqb3IgREJ1ZiBhc3NpZ25tZW50IGNo
YW5nZXMgbGFuZGVkOgotIEFzIG5vdyBlbmFibGVkIHNsaWNlcyBjb250YWluIGEgbWFzawogIHdl
IHN0aWxsIG5lZWQgc29tZSB2YWx1ZSB3aGljaCBzaG91bGQKICByZWZsZWN0IGhvdyBtdWNoIERC
dWYgc2xpY2VzIGFyZSBzdXBwb3J0ZWQKICBieSB0aGUgcGxhdGZvcm0sIG5vdyBkZXZpY2UgaW5m
byBjb250YWlucwogIG51bV9zdXBwb3J0ZWRfZGJ1Zl9zbGljZXMuCi0gUmVtb3ZlZCB1bm5lZWRl
ZCBhc3NlcnRpb24gYXMgd2UgYXJlIG5vdwogIG1hbmlwdWxhdGluZyBzbGljZXMgaW4gYSBtb3Jl
IHByb3BlciB3YXkuCgp2MjogU3RhcnQgdXNpbmcgZW5hYmxlZF9zbGljZXMgaW4gZGV2X3ByaXYK
CnYzOiAiZW5hYmxlZF9zbGljZXMiIGlzIG5vdyAiZW5hYmxlZF9kYnVmX3NsaWNlc19tYXNrIiwK
ICAgIGFzIHRoaXMgbm93IHNpdHMgaW4gZGV2X3ByaXYgaW5kZXBlbmRlbnRseS4KCnY0OiAtIEZp
eGVkIGRlYnVnIHByaW50IGZvcm1hdHRpbmcgdG8gaGV4KE1hdHQgUm9wZXIpCiAgICAtIE9wdGlt
aXplZCBkYnVmIHNsaWNlIHVwZGF0ZXMgdG8gYmUgdXNlZCBvbmx5CiAgICAgIGlmIHNsaWNlIHVu
aW9uIGlzIGRpZmZlcmVudCBmcm9tIGN1cnJlbnQgY29uZihNYXR0IFJvcGVyKQogICAgLSBGaXhl
ZCBzb21lIGZ1bmN0aW9ucyB0byBiZSBzdGF0aWMoTWF0dCBSb3BlcikKICAgIC0gQ3JlYXRlZCBh
IHBhcmFtZXRlcml6ZWQgdmVyc2lvbiBmb3IgREJVRl9DVEwgdG8KICAgICAgc2ltcGxpZnkgREJ1
ZiBwcm9ncmFtbWluZyBjeWNsZShNYXR0IFJvcGVyKQogICAgLSBSZW1vdmVkIHVucmVxdXJlZCBm
aWVsZCBmcm9tIEdFTjEwX0ZFQVRVUkVTKE1hdHQgUm9wZXIpCgp2NTogLSBSZW1vdmVkIHJlZHVu
ZGFudCBwcm9ncmFtbWluZyBkYnVmIHNsaWNlcyBoZWxwZXIoVmlsbGUgU3lyasOkbMOkKQogICAg
LSBTdGFydGVkIHRvIHVzZSBwYXJhbWV0ZXJpemVkIGxvb3AgZm9yIGh3IHJlYWRvdXQgdG8gZ2V0
IHNsaWNlcwogICAgICAoVmlsbGUgU3lyasOkbMOkKQogICAgLSBBZGRlZCBiYWNrIGFzc2VydGlv
biBjaGVja2luZyBhbW91bnQgb2YgREJVRiBzbGljZXMgZW5hYmxlZAogICAgICBhZnRlciBEQyBz
dGF0ZXMgNS82IHRyYW5zaXRpb24sIGFsc28gYWRkZWQgbmV3IGFzc2VydGlvbgogICAgICBhcyBz
dGFydGluZyBmcm9tIElDTCBETUMgc2VlbXMgdG8gcmVzdG9yZSB0aGUgbGFzdCBEQnVmCiAgICAg
IHBvd2VyIHN0YXRlIHNldCwgcmF0aGVyIHRoYW4gcG93ZXIgdXAgYWxsIGRidWYgc2xpY2VzCiAg
ICAgIGFzIGFzc2VydGlvbiB3YXMgcHJldmlvdXNseSBleHBlY3RpbmcoVmlsbGUgU3lyasOkbMOk
KQoKdjY6IC0gTm93IHVzaW5nIGVudW0gZm9yIERCdWYgc2xpY2VzIGluIHRoaXMgcGF0Y2ggKFZp
bGxlIFN5cmrDpGzDpCkKICAgIC0gUmVtb3ZlZCBnZW4xMV9hc3NlcnRfZGJ1Zl9lbmFibGVkIGFu
ZCBwdXQgZ2VuOV9hc3NlcnRfZGJ1Zl9lbmFibGVkCiAgICAgIGJhY2ssIGFzIHdlIHJlYWxseSBu
ZWVkIHRvIGhhdmUgYSBzaW5nbGUgdW5pZmllZCBhc3NlcnQgaGVyZQogICAgICBob3dldmVyIGN1
cnJlbnRseSBlbmFibGluZyBhbHdheXMgc2xpY2UgMSBpcyBlbmZvcmNlZCBieSBCU3BlYywKICAg
ICAgc28gd2Ugd2lsbCBoYXZlIHRvIE9SIGVuYWJsZWQgc2xpY2VzIG1hc2sgd2l0aCAxIGluIG9y
ZGVyCiAgICAgIHRvIGJlIGNvbnNpc3RlbnQgd2l0aCBCU3BlYywgdGhhdCB3YXkgd2UgY2FuIHVu
aWZ5IHRoYXQKICAgICAgYXNzZXJ0aW9uIGFuZCBhZ2FpbnN0IHRoZSBhY3R1YWwgc3RhdGUgZnJv
bSB0aGUgZHJpdmVyLCBidXQKICAgICAgbm90IHNvbWUgaGFyZGNvZGVkIHZhbHVlLihjb25jbHVk
ZWQgd2l0aCBWaWxsZSkKICAgIC0gUmVtb3ZlIHBhcmFtZXRlcml6ZWQgREJVRl9DVEwgdmVyc2lv
biwgdG8gZXh0cmFjdCBpdCB0byBhbm90aGVyCiAgICAgIHBhdGNoLihWaWxsZSBTeXJqw6Rsw6Qp
CnY3OgogICAgLSBSZW1vdmVkIHVubmVlZGVkIGhhcmRjb2RlZCByZXR1cm4gdmFsdWUgZm9yIG9s
ZGVyIGdlbnMgZnJvbQogICAgICBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX21hc2sgLSB0aGlz
IG5vdyBpcyBoYW5kbGVkIGluIGEKICAgICAgdW5pZmllZCBtYW5uZXIgc2luY2UgZGV2aWNlIGlu
Zm8gYW55d2F5IHJldHVybnMgbWF4IGRidWYgc2xpY2VzCiAgICAgIGFzIDEgZm9yIG9sZGVyIHBs
YXRmb3JtcyhNYXR0aGV3IFJvcGVyKQogICAgLSBOb3cgdXNpbmcgSU5URUxfSU5GTyhkZXZfcHJp
diktPm51bV9zdXBwb3J0ZWRfZGJ1Zl9zbGljZXMgaW5zdGVhZAogICAgICBvZiBpbnRlbF9kYnVm
X21heF9zbGljZXMgZnVuY3Rpb24gYXMgaXQgaXMgdHJpdmlhbChNYXR0aGV3IFJvcGVyKQoKdjg6
IC0gRml4ZWQgaWNsX2RidWZfZGlzYWJsZSB0byBkaXNhYmxlIGFsbCBkYnVmcyBzdGlsbChWaWxs
ZSBTeXJqw6Rsw6QpCgpSZXZpZXdlZC1ieTogTWF0dCBSb3BlciA8bWF0dGhldy5kLnJvcGVyQGlu
dGVsLmNvbT4KUmV2aWV3ZWQtYnk6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51
eC5pbnRlbC5jb20+ClNpZ25lZC1vZmYtYnk6IFN0YW5pc2xhdiBMaXNvdnNraXkgPHN0YW5pc2xh
di5saXNvdnNraXlAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheS5jICB8IDIzICsrLS0tCiAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
aXNwbGF5X3Bvd2VyLmMgICAgfCA4OSArKysrKystLS0tLS0tLS0tLS0tCiAuLi4vZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmggICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9kcnYuaCAgICAgICAgICAgICAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfcGNpLmMgICAgICAgICAgICAgICB8ICA1ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9kZXZpY2VfaW5mby5oICAgICAgfCAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9wbS5jICAgICAgICAgICAgICAgfCA1MyArKystLS0tLS0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfcG0uaCAgICAgICAgICAgICAgIHwgIDIgKy0KIDggZmlsZXMgY2hhbmdlZCwg
NjAgaW5zZXJ0aW9ucygrKSwgMTE3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKaW5kZXggOGIwNmVmMjk2OTNlLi4wNjFkZTE2MWI5
NWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCkBA
IC0xMzc3MCwxMiArMTM3NzAsMTIgQEAgc3RhdGljIHZvaWQgdmVyaWZ5X3dtX3N0YXRlKHN0cnVj
dCBpbnRlbF9jcnRjICpjcnRjLAogCiAJc2tsX3BpcGVfZGRiX2dldF9od19zdGF0ZShjcnRjLCBo
dy0+ZGRiX3ksIGh3LT5kZGJfdXYpOwogCi0JaHdfZW5hYmxlZF9zbGljZXMgPSBpbnRlbF9lbmFi
bGVkX2RidWZfc2xpY2VzX251bShkZXZfcHJpdik7CisJaHdfZW5hYmxlZF9zbGljZXMgPSBpbnRl
bF9lbmFibGVkX2RidWZfc2xpY2VzX21hc2soZGV2X3ByaXYpOwogCiAJaWYgKElOVEVMX0dFTihk
ZXZfcHJpdikgPj0gMTEgJiYKLQkgICAgaHdfZW5hYmxlZF9zbGljZXMgIT0gZGV2X3ByaXYtPmVu
YWJsZWRfZGJ1Zl9zbGljZXNfbnVtKQotCQlEUk1fRVJST1IoIm1pc21hdGNoIGluIERCVUYgU2xp
Y2VzIChleHBlY3RlZCAldSwgZ290ICV1KVxuIiwKLQkJCSAgZGV2X3ByaXYtPmVuYWJsZWRfZGJ1
Zl9zbGljZXNfbnVtLAorCSAgICBod19lbmFibGVkX3NsaWNlcyAhPSBkZXZfcHJpdi0+ZW5hYmxl
ZF9kYnVmX3NsaWNlc19tYXNrKQorCQlEUk1fRVJST1IoIm1pc21hdGNoIGluIERCVUYgU2xpY2Vz
IChleHBlY3RlZCAweCV4LCBnb3QgMHgleClcbiIsCisJCQkgIGRldl9wcml2LT5lbmFibGVkX2Ri
dWZfc2xpY2VzX21hc2ssCiAJCQkgIGh3X2VuYWJsZWRfc2xpY2VzKTsKIAogCS8qIHBsYW5lcyAq
LwpAQCAtMTUxMTksMjIgKzE1MTE5LDIzIEBAIHN0YXRpYyB2b2lkIGludGVsX3VwZGF0ZV90cmFu
c19wb3J0X3N5bmNfY3J0Y3Moc3RydWN0IGludGVsX2NydGMgKmNydGMsCiBzdGF0aWMgdm9pZCBp
Y2xfZGJ1Zl9zbGljZV9wcmVfdXBkYXRlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
KQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUt
PmJhc2UuZGV2KTsKLQl1OCBod19lbmFibGVkX3NsaWNlcyA9IGRldl9wcml2LT5lbmFibGVkX2Ri
dWZfc2xpY2VzX251bTsKLQl1OCByZXF1aXJlZF9zbGljZXMgPSBzdGF0ZS0+ZW5hYmxlZF9kYnVm
X3NsaWNlc19udW07CisJdTggaHdfZW5hYmxlZF9zbGljZXMgPSBkZXZfcHJpdi0+ZW5hYmxlZF9k
YnVmX3NsaWNlc19tYXNrOworCXU4IHJlcXVpcmVkX3NsaWNlcyA9IHN0YXRlLT5lbmFibGVkX2Ri
dWZfc2xpY2VzX21hc2s7CisJdTggc2xpY2VzX3VuaW9uID0gaHdfZW5hYmxlZF9zbGljZXMgfCBy
ZXF1aXJlZF9zbGljZXM7CiAKIAkvKiBJZiAybmQgREJ1ZiBzbGljZSByZXF1aXJlZCwgZW5hYmxl
IGl0IGhlcmUgKi8KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSAmJiByZXF1aXJlZF9z
bGljZXMgPiBod19lbmFibGVkX3NsaWNlcykKLQkJaWNsX2RidWZfc2xpY2VzX3VwZGF0ZShkZXZf
cHJpdiwgcmVxdWlyZWRfc2xpY2VzKTsKKwlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSAm
JiBzbGljZXNfdW5pb24gIT0gaHdfZW5hYmxlZF9zbGljZXMpCisJCWljbF9kYnVmX3NsaWNlc191
cGRhdGUoZGV2X3ByaXYsIHNsaWNlc191bmlvbik7CiB9CiAKIHN0YXRpYyB2b2lkIGljbF9kYnVm
X3NsaWNlX3Bvc3RfdXBkYXRlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQogewog
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoc3RhdGUtPmJhc2Uu
ZGV2KTsKLQl1OCBod19lbmFibGVkX3NsaWNlcyA9IGRldl9wcml2LT5lbmFibGVkX2RidWZfc2xp
Y2VzX251bTsKLQl1OCByZXF1aXJlZF9zbGljZXMgPSBzdGF0ZS0+ZW5hYmxlZF9kYnVmX3NsaWNl
c19udW07CisJdTggaHdfZW5hYmxlZF9zbGljZXMgPSBkZXZfcHJpdi0+ZW5hYmxlZF9kYnVmX3Ns
aWNlc19tYXNrOworCXU4IHJlcXVpcmVkX3NsaWNlcyA9IHN0YXRlLT5lbmFibGVkX2RidWZfc2xp
Y2VzX21hc2s7CiAKIAkvKiBJZiAybmQgREJ1ZiBzbGljZSBpcyBubyBtb3JlIHJlcXVpcmVkIGRp
c2FibGUgaXQgKi8KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSAmJiByZXF1aXJlZF9z
bGljZXMgPCBod19lbmFibGVkX3NsaWNlcykKKwlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAx
MSAmJiByZXF1aXJlZF9zbGljZXMgIT0gaHdfZW5hYmxlZF9zbGljZXMpCiAJCWljbF9kYnVmX3Ns
aWNlc191cGRhdGUoZGV2X3ByaXYsIHJlcXVpcmVkX3NsaWNlcyk7CiB9CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9wb3dlci5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMKaW5kZXggMDgw
NjU3MjAzOTFmLi4yNWMyMzYxZDk2MDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9wb3dlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV9wb3dlci5jCkBAIC0xNSw2ICsxNSw3IEBACiAjaW5jbHVk
ZSAiaW50ZWxfZGlzcGxheV90eXBlcy5oIgogI2luY2x1ZGUgImludGVsX2RwaW9fcGh5LmgiCiAj
aW5jbHVkZSAiaW50ZWxfaG90cGx1Zy5oIgorI2luY2x1ZGUgImludGVsX3BtLmgiCiAjaW5jbHVk
ZSAiaW50ZWxfc2lkZWJhbmQuaCIKICNpbmNsdWRlICJpbnRlbF90Yy5oIgogI2luY2x1ZGUgImlu
dGVsX3ZnYS5oIgpAQCAtMTAyOCwxMSArMTAyOSwxMyBAQCBzdGF0aWMgYm9vbCBnZW45X2RjX29m
Zl9wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAog
CiBzdGF0aWMgdm9pZCBnZW45X2Fzc2VydF9kYnVmX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQogewotCXUzMiB0bXAgPSBJOTE1X1JFQUQoREJVRl9DVEwpOworCXU4
IGh3X2VuYWJsZWRfZGJ1Zl9zbGljZXMgPSBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX21hc2so
ZGV2X3ByaXYpOworCXU4IGVuYWJsZWRfZGJ1Zl9zbGljZXMgPSBkZXZfcHJpdi0+ZW5hYmxlZF9k
YnVmX3NsaWNlc19tYXNrOwogCi0JV0FSTigodG1wICYgKERCVUZfUE9XRVJfU1RBVEUgfCBEQlVG
X1BPV0VSX1JFUVVFU1QpKSAhPQotCSAgICAgKERCVUZfUE9XRVJfU1RBVEUgfCBEQlVGX1BPV0VS
X1JFUVVFU1QpLAotCSAgICAgIlVuZXhwZWN0ZWQgREJ1ZiBwb3dlciBwb3dlciBzdGF0ZSAoMHgl
MDh4KVxuIiwgdG1wKTsKKwlXQVJOKGh3X2VuYWJsZWRfZGJ1Zl9zbGljZXMgIT0gZW5hYmxlZF9k
YnVmX3NsaWNlcywKKwkgICAgICJVbmV4cGVjdGVkIERCdWYgcG93ZXIgcG93ZXIgc3RhdGUgKDB4
JTA4eCwgZXhwZWN0ZWQgMHglMDh4KVxuIiwKKwkgICAgIGh3X2VuYWJsZWRfZGJ1Zl9zbGljZXMs
CisJICAgICBlbmFibGVkX2RidWZfc2xpY2VzKTsKIH0KIAogc3RhdGljIHZvaWQgZ2VuOV9kaXNh
YmxlX2RjX3N0YXRlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCkBAIC00Mzg4
LDg2ICs0MzkxLDQ2IEBAIGJvb2wgaW50ZWxfZGJ1Zl9zbGljZV9zZXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAogCiBzdGF0aWMgdm9pZCBnZW45X2RidWZfZW5hYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlpbnRlbF9kYnVmX3NsaWNlX3NldChk
ZXZfcHJpdiwgREJVRl9DVEwsIHRydWUpOworCWljbF9kYnVmX3NsaWNlc191cGRhdGUoZGV2X3By
aXYsIEJJVChEQlVGX1MxKSk7CiB9CiAKIHN0YXRpYyB2b2lkIGdlbjlfZGJ1Zl9kaXNhYmxlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlpbnRlbF9kYnVmX3NsaWNlX3Nl
dChkZXZfcHJpdiwgREJVRl9DVEwsIGZhbHNlKTsKLX0KLQotc3RhdGljIHU4IGludGVsX2RidWZf
bWF4X3NsaWNlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPCAxMSkKLQkJcmV0dXJuIDE7Ci0JcmV0dXJuIDI7CisJaWNsX2Ri
dWZfc2xpY2VzX3VwZGF0ZShkZXZfcHJpdiwgMCk7CiB9CiAKIHZvaWQgaWNsX2RidWZfc2xpY2Vz
X3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCQkgICAgdTggcmVx
X3NsaWNlcykKIHsKLQljb25zdCB1OCBod19lbmFibGVkX3NsaWNlcyA9IGRldl9wcml2LT5lbmFi
bGVkX2RidWZfc2xpY2VzX251bTsKLQlib29sIHJldDsKKwlpbnQgaTsKKwlpbnQgbWF4X3NsaWNl
cyA9IElOVEVMX0lORk8oZGV2X3ByaXYpLT5udW1fc3VwcG9ydGVkX2RidWZfc2xpY2VzOwogCi0J
aWYgKHJlcV9zbGljZXMgPiBpbnRlbF9kYnVmX21heF9zbGljZXMoZGV2X3ByaXYpKSB7Ci0JCURS
TV9FUlJPUigiSW52YWxpZCBudW1iZXIgb2YgZGJ1ZiBzbGljZXMgcmVxdWVzdGVkXG4iKTsKLQkJ
cmV0dXJuOwotCX0KKwlXQVJOKGh3ZWlnaHQ4KHJlcV9zbGljZXMpID4gbWF4X3NsaWNlcywKKwkg
ICAgICJJbnZhbGlkIG51bWJlciBvZiBkYnVmIHNsaWNlcyByZXF1ZXN0ZWRcbiIpOwogCi0JaWYg
KHJlcV9zbGljZXMgPT0gaHdfZW5hYmxlZF9zbGljZXMgfHwgcmVxX3NsaWNlcyA9PSAwKQotCQly
ZXR1cm47CisJRFJNX0RFQlVHX0tNUygiVXBkYXRpbmcgZGJ1ZiBzbGljZXMgdG8gMHgleFxuIiwg
cmVxX3NsaWNlcyk7CiAKLQlpZiAocmVxX3NsaWNlcyA+IGh3X2VuYWJsZWRfc2xpY2VzKQotCQly
ZXQgPSBpbnRlbF9kYnVmX3NsaWNlX3NldChkZXZfcHJpdiwKLQkJCQkJICAgREJVRl9DVExfUyhE
QlVGX1MyKSwgdHJ1ZSk7Ci0JZWxzZQotCQlyZXQgPSBpbnRlbF9kYnVmX3NsaWNlX3NldChkZXZf
cHJpdiwKLQkJCQkJICAgREJVRl9DVExfUyhEQlVGX1MyKSwgZmFsc2UpOworCWZvciAoaSA9IDA7
IGkgPCBtYXhfc2xpY2VzOyBpKyspIHsKKwkJaW50ZWxfZGJ1Zl9zbGljZV9zZXQoZGV2X3ByaXYs
CisJCQkJICAgICBEQlVGX0NUTF9TKGkpLAorCQkJCSAgICAgKHJlcV9zbGljZXMgJiBCSVQoaSkp
ICE9IDApOworCX0KIAotCWlmIChyZXQpCi0JCWRldl9wcml2LT5lbmFibGVkX2RidWZfc2xpY2Vz
X251bSA9IHJlcV9zbGljZXM7CisJZGV2X3ByaXYtPmVuYWJsZWRfZGJ1Zl9zbGljZXNfbWFzayA9
IHJlcV9zbGljZXM7CiB9CiAKIHN0YXRpYyB2b2lkIGljbF9kYnVmX2VuYWJsZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0JSTkxNV9XUklURShEQlVGX0NUTF9TKERCVUZf
UzEpLAotCQkgICBJOTE1X1JFQUQoREJVRl9DVExfUyhEQlVGX1MxKSkgfCBEQlVGX1BPV0VSX1JF
UVVFU1QpOwotCUk5MTVfV1JJVEUoREJVRl9DVExfUyhEQlVGX1MyKSwKLQkJICAgSTkxNV9SRUFE
KERCVUZfQ1RMX1MoREJVRl9TMikpIHwgREJVRl9QT1dFUl9SRVFVRVNUKTsKLQlQT1NUSU5HX1JF
QUQoREJVRl9DVExfUyhEQlVGX1MyKSk7Ci0KLQl1ZGVsYXkoMTApOwotCi0JaWYgKCEoSTkxNV9S
RUFEKERCVUZfQ1RMX1MoREJVRl9TMSkpICYgREJVRl9QT1dFUl9TVEFURSkgfHwKLQkgICAgIShJ
OTE1X1JFQUQoREJVRl9DVExfUyhEQlVGX1MyKSkgJiBEQlVGX1BPV0VSX1NUQVRFKSkKLQkJRFJN
X0VSUk9SKCJEQnVmIHBvd2VyIGVuYWJsZSB0aW1lb3V0XG4iKTsKLQllbHNlCi0JCS8qCi0JCSAq
IEZJWE1FOiBmb3Igbm93IHByZXRlbmQgdGhhdCB3ZSBvbmx5IGhhdmUgMSBzbGljZSwgc2VlCi0J
CSAqIGludGVsX2VuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtKCkuCi0JCSAqLwotCQlkZXZfcHJpdi0+
ZW5hYmxlZF9kYnVmX3NsaWNlc19udW0gPSAxOworCS8qCisJICogSnVzdCBwb3dlciB1cCAxIHNs
aWNlLCB3ZSB3aWxsCisJICogZmlndXJlIG91dCBsYXRlciB3aGljaCBzbGljZXMgd2UgaGF2ZSBh
bmQgd2hhdCB3ZSBuZWVkLgorCSAqLworCWljbF9kYnVmX3NsaWNlc191cGRhdGUoZGV2X3ByaXYs
IEJJVChEQlVGX1MxKSk7CiB9CiAKIHN0YXRpYyB2b2lkIGljbF9kYnVmX2Rpc2FibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCUk5MTVfV1JJVEUoREJVRl9DVExfUyhE
QlVGX1MxKSwKLQkJICAgSTkxNV9SRUFEKERCVUZfQ1RMX1MoREJVRl9TMSkpICYgfkRCVUZfUE9X
RVJfUkVRVUVTVCk7Ci0JSTkxNV9XUklURShEQlVGX0NUTF9TKERCVUZfUzIpLAotCQkgICBJOTE1
X1JFQUQoREJVRl9DVExfUyhEQlVGX1MyKSkgJiB+REJVRl9QT1dFUl9SRVFVRVNUKTsKLQlQT1NU
SU5HX1JFQUQoREJVRl9DVExfUyhEQlVGX1MyKSk7Ci0KLQl1ZGVsYXkoMTApOwotCi0JaWYgKChJ
OTE1X1JFQUQoREJVRl9DVExfUyhEQlVGX1MxKSkgJiBEQlVGX1BPV0VSX1NUQVRFKSB8fAotCSAg
ICAoSTkxNV9SRUFEKERCVUZfQ1RMX1MoREJVRl9TMikpICYgREJVRl9QT1dFUl9TVEFURSkpCi0J
CURSTV9FUlJPUigiREJ1ZiBwb3dlciBkaXNhYmxlIHRpbWVvdXQhXG4iKTsKLQllbHNlCi0JCS8q
Ci0JCSAqIEZJWE1FOiBmb3Igbm93IHByZXRlbmQgdGhhdCB0aGUgZmlyc3Qgc2xpY2UgaXMgYWx3
YXlzCi0JCSAqIGVuYWJsZWQsIHNlZSBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bSgpLgot
CQkgKi8KLQkJZGV2X3ByaXYtPmVuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtID0gMTsKKwlpY2xfZGJ1
Zl9zbGljZXNfdXBkYXRlKGRldl9wcml2LCAwKTsKIH0KIAogc3RhdGljIHZvaWQgaWNsX21idXNf
aW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaCBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCmluZGV4IDZkY2E5MGVi
Y2EzNS4uMDlmMTRlOWU3ODYzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2Rpc3BsYXlfdHlwZXMuaApAQCAtNTE4LDcgKzUxOCw3IEBAIHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgewogCXN0cnVjdCBza2xfZGRiX3ZhbHVlcyB3bV9yZXN1bHRzOwogCiAJ
LyogTnVtYmVyIG9mIGVuYWJsZWQgREJ1ZiBzbGljZXMgKi8KLQl1OCBlbmFibGVkX2RidWZfc2xp
Y2VzX251bTsKKwl1OCBlbmFibGVkX2RidWZfc2xpY2VzX21hc2s7CiAKIAlzdHJ1Y3QgaTkxNV9z
d19mZW5jZSBjb21taXRfcmVhZHk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4IDlkYmYy
ZTU3YjAxYi4uNWI4OTVhZDM4ZmJjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKQEAgLTEyMDgs
NyArMTIwOCw3IEBAIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlIHsKIAkJYm9vbCBkaXN0cnVzdF9i
aW9zX3dtOwogCX0gd207CiAKLQl1OCBlbmFibGVkX2RidWZfc2xpY2VzX251bTsgLyogR0VOMTEg
aGFzIGNvbmZpZ3VyYWJsZSAyIHNsaWNlcyAqLworCXU4IGVuYWJsZWRfZGJ1Zl9zbGljZXNfbWFz
azsgLyogR0VOMTEgaGFzIGNvbmZpZ3VyYWJsZSAyIHNsaWNlcyAqLwogCiAJc3RydWN0IGRyYW1f
aW5mbyB7CiAJCWJvb2wgdmFsaWQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3BjaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wY2kuYwppbmRleCA4M2YwMTQw
MWI4YjUuLjZjNmRhYTQ0YzQzOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9wY2kuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BjaS5jCkBAIC02MTUsNyAr
NjE1LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBpbnRlbF9kZXZpY2VfaW5mbyBjaHZfaW5mbyA9
IHsKIAkuaGFzX2d0X3VjID0gMSwgXAogCS5kaXNwbGF5Lmhhc19oZGNwID0gMSwgXAogCS5kaXNw
bGF5Lmhhc19pcGMgPSAxLCBcCi0JLmRkYl9zaXplID0gODk2CisJLmRkYl9zaXplID0gODk2LCBc
CisJLm51bV9zdXBwb3J0ZWRfZGJ1Zl9zbGljZXMgPSAxCiAKICNkZWZpbmUgU0tMX1BMQVRGT1JN
IFwKIAlHRU45X0ZFQVRVUkVTLCBcCkBAIC02NTAsNiArNjUxLDcgQEAgc3RhdGljIGNvbnN0IHN0
cnVjdCBpbnRlbF9kZXZpY2VfaW5mbyBza2xfZ3Q0X2luZm8gPSB7CiAjZGVmaW5lIEdFTjlfTFBf
RkVBVFVSRVMgXAogCUdFTig5KSwgXAogCS5pc19scCA9IDEsIFwKKwkubnVtX3N1cHBvcnRlZF9k
YnVmX3NsaWNlcyA9IDEsIFwKIAkuZGlzcGxheS5oYXNfaG90cGx1ZyA9IDEsIFwKIAkuZW5naW5l
X21hc2sgPSBCSVQoUkNTMCkgfCBCSVQoVkNTMCkgfCBCSVQoQkNTMCkgfCBCSVQoVkVDUzApLCBc
CiAJLnBpcGVfbWFzayA9IEJJVChQSVBFX0EpIHwgQklUKFBJUEVfQikgfCBCSVQoUElQRV9DKSwg
XApAQCAtNzc0LDYgKzc3Niw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaW50ZWxfZGV2aWNlX2lu
Zm8gY25sX2luZm8gPSB7CiAJfSwgXAogCUdFTigxMSksIFwKIAkuZGRiX3NpemUgPSAyMDQ4LCBc
CisJLm51bV9zdXBwb3J0ZWRfZGJ1Zl9zbGljZXMgPSAyLCBcCiAJLmhhc19sb2dpY2FsX3Jpbmdf
ZWxzcSA9IDEsIFwKIAkuY29sb3IgPSB7IC5kZWdhbW1hX2x1dF9zaXplID0gMzMsIC5nYW1tYV9s
dXRfc2l6ZSA9IDI2MjE0NSB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2RldmljZV9pbmZvLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kZXZpY2VfaW5m
by5oCmluZGV4IDI3MjVjYjdmYzE2OS4uN2Q0ZDEyMmQyMTgyIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9kZXZpY2VfaW5mby5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2RldmljZV9pbmZvLmgKQEAgLTE4MCw2ICsxODAsNyBAQCBzdHJ1Y3QgaW50ZWxf
ZGV2aWNlX2luZm8gewogCX0gZGlzcGxheTsKIAogCXUxNiBkZGJfc2l6ZTsgLyogaW4gYmxvY2tz
ICovCisJdTggbnVtX3N1cHBvcnRlZF9kYnVmX3NsaWNlczsgLyogbnVtYmVyIG9mIERCdWYgc2xp
Y2VzICovCiAKIAkvKiBSZWdpc3RlciBvZmZzZXRzIGZvciB0aGUgdmFyaW91cyBkaXNwbGF5IHBp
cGVzIGFuZCB0cmFuc2NvZGVycyAqLwogCWludCBwaXBlX29mZnNldHNbSTkxNV9NQVhfVFJBTlND
T0RFUlNdOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKaW5kZXggZjIyNTA5ZjhhYzI4Li5iNGIyOTFk
NDI0NGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwpAQCAtMzY0NCwyNiArMzY0NCwxOCBAQCBi
b29sIGlsa19kaXNhYmxlX2xwX3dtKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
IAlyZXR1cm4gX2lsa19kaXNhYmxlX2xwX3dtKGRldl9wcml2LCBXTV9ESVJUWV9MUF9BTEwpOwog
fQogCi11OCBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCit1OCBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX21hc2soc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCXU4IGVuYWJsZWRfZGJ1Zl9zbGljZXNf
bnVtOwotCi0JLyogU2xpY2UgMSB3aWxsIGFsd2F5cyBiZSBlbmFibGVkICovCi0JZW5hYmxlZF9k
YnVmX3NsaWNlc19udW0gPSAxOwotCi0JLyogR2VuIHByaW9yIHRvIEdFTjExIGhhdmUgb25seSBv
bmUgREJ1ZiBzbGljZSAqLwotCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpCi0JCXJldHVy
biBlbmFibGVkX2RidWZfc2xpY2VzX251bTsKKwlpbnQgaTsKKwlpbnQgbWF4X3NsaWNlcyA9IElO
VEVMX0lORk8oZGV2X3ByaXYpLT5udW1fc3VwcG9ydGVkX2RidWZfc2xpY2VzOworCXU4IGVuYWJs
ZWRfc2xpY2VzX21hc2sgPSAwOwogCi0JLyoKLQkgKiBGSVhNRTogZm9yIG5vdyB3ZSdsbCBvbmx5
IGV2ZXIgdXNlIDEgc2xpY2U7IHByZXRlbmQgdGhhdCB3ZSBoYXZlCi0JICogb25seSB0aGF0IDEg
c2xpY2UgZW5hYmxlZCB1bnRpbCB3ZSBoYXZlIGEgcHJvcGVyIHdheSBmb3Igb24tZGVtYW5kCi0J
ICogdG9nZ2xpbmcgb2YgdGhlIHNlY29uZCBzbGljZS4KLQkgKi8KLQlpZiAoMCAmJiBJOTE1X1JF
QUQoREJVRl9DVExfUyhEQlVGX1MyKSkgJiBEQlVGX1BPV0VSX1NUQVRFKQotCQllbmFibGVkX2Ri
dWZfc2xpY2VzX251bSsrOworCWZvciAoaSA9IDA7IGkgPCBtYXhfc2xpY2VzOyBpKyspIHsKKwkJ
aWYgKEk5MTVfUkVBRChEQlVGX0NUTF9TKGkpKSAmIERCVUZfUE9XRVJfU1RBVEUpCisJCQllbmFi
bGVkX3NsaWNlc19tYXNrIHw9IEJJVChpKTsKKwl9CiAKLQlyZXR1cm4gZW5hYmxlZF9kYnVmX3Ns
aWNlc19udW07CisJcmV0dXJuIGVuYWJsZWRfc2xpY2VzX21hc2s7CiB9CiAKIC8qCkBAIC0zODcx
LDggKzM4NjMsNiBAQCBzdGF0aWMgdTE2IGludGVsX2dldF9kZGJfc2l6ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiB7CiAJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRl
ID0gY3J0Y19zdGF0ZS0+dWFwaS5zdGF0ZTsKIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpp
bnRlbF9zdGF0ZSA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShzdGF0ZSk7Ci0JY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKmFkanVzdGVkX21vZGU7Ci0JdTY0IHRvdGFsX2RhdGFfYnc7CiAJ
dTE2IGRkYl9zaXplID0gSU5URUxfSU5GTyhkZXZfcHJpdiktPmRkYl9zaXplOwogCiAJV0FSTl9P
TihkZGJfc2l6ZSA9PSAwKTsKQEAgLTM4ODAsMjMgKzM4NzAsOCBAQCBzdGF0aWMgdTE2IGludGVs
X2dldF9kZGJfc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJaWYgKElO
VEVMX0dFTihkZXZfcHJpdikgPCAxMSkKIAkJcmV0dXJuIGRkYl9zaXplIC0gNDsgLyogNCBibG9j
a3MgZm9yIGJ5cGFzcyBwYXRoIGFsbG9jYXRpb24gKi8KIAotCWFkanVzdGVkX21vZGUgPSAmY3J0
Y19zdGF0ZS0+aHcuYWRqdXN0ZWRfbW9kZTsKLQl0b3RhbF9kYXRhX2J3ID0gdG90YWxfZGF0YV9y
YXRlICogZHJtX21vZGVfdnJlZnJlc2goYWRqdXN0ZWRfbW9kZSk7Ci0KLQkvKgotCSAqIDEyR0Iv
cyBpcyBtYXhpbXVtIEJXIHN1cHBvcnRlZCBieSBzaW5nbGUgREJ1ZiBzbGljZS4KLQkgKgotCSAq
IEZJWE1FIGRidWYgc2xpY2UgY29kZSBpcyBicm9rZW46Ci0JICogLSBtdXN0IHdhaXQgZm9yIHBs
YW5lcyB0byBzdG9wIHVzaW5nIHRoZSBzbGljZSBiZWZvcmUgcG93ZXJpbmcgaXQgb2ZmCi0JICog
LSBwbGFuZSBzdHJhZGRsaW5nIGJvdGggc2xpY2VzIGlzIGlsbGVnYWwgaW4gbXVsdGktcGlwZSBz
Y2VuYXJpb3MKLQkgKiAtIHNob3VsZCB2YWxpZGF0ZSB3ZSBzdGF5IHdpdGhpbiB0aGUgaHcgYmFu
ZHdpZHRoIGxpbWl0cwotCSAqLwotCWlmICgwICYmIChudW1fYWN0aXZlID4gMSB8fCB0b3RhbF9k
YXRhX2J3ID49IEdCcHMoMTIpKSkgewotCQlpbnRlbF9zdGF0ZS0+ZW5hYmxlZF9kYnVmX3NsaWNl
c19udW0gPSAyOwotCX0gZWxzZSB7Ci0JCWludGVsX3N0YXRlLT5lbmFibGVkX2RidWZfc2xpY2Vz
X251bSA9IDE7Ci0JCWRkYl9zaXplIC89IDI7Ci0JfQorCWludGVsX3N0YXRlLT5lbmFibGVkX2Ri
dWZfc2xpY2VzX21hc2sgPSBCSVQoREJVRl9TMSk7CisJZGRiX3NpemUgLz0gMjsKIAogCXJldHVy
biBkZGJfc2l6ZTsKIH0KQEAgLTQwOTMsOCArNDA2OCw4IEBAIHZvaWQgc2tsX3BpcGVfZGRiX2dl
dF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YywKIAogdm9pZCBza2xfZGRiX2dldF9o
d19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7Ci0JZGV2X3ByaXYt
PmVuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtID0KLQkJCQlpbnRlbF9lbmFibGVkX2RidWZfc2xpY2Vz
X251bShkZXZfcHJpdik7CisJZGV2X3ByaXYtPmVuYWJsZWRfZGJ1Zl9zbGljZXNfbWFzayA9CisJ
CQkJaW50ZWxfZW5hYmxlZF9kYnVmX3NsaWNlc19tYXNrKGRldl9wcml2KTsKIH0KIAogLyoKQEAg
LTUyMzYsNyArNTIxMSw3IEBAIHNrbF9jb21wdXRlX2RkYihzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSkKIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKIAlpbnQgcmV0LCBpOwogCi0J
c3RhdGUtPmVuYWJsZWRfZGJ1Zl9zbGljZXNfbnVtID0gZGV2X3ByaXYtPmVuYWJsZWRfZGJ1Zl9z
bGljZXNfbnVtOworCXN0YXRlLT5lbmFibGVkX2RidWZfc2xpY2VzX21hc2sgPSBkZXZfcHJpdi0+
ZW5hYmxlZF9kYnVmX3NsaWNlc19tYXNrOwogCiAJZm9yX2VhY2hfb2xkbmV3X2ludGVsX2NydGNf
aW5fc3RhdGUoc3RhdGUsIGNydGMsIG9sZF9jcnRjX3N0YXRlLAogCQkJCQkgICAgbmV3X2NydGNf
c3RhdGUsIGkpIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oCmluZGV4IDIyZmQyZGFmNjA4ZS4uZDYw
YTg1NDIxYzVhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmgKQEAgLTMyLDcgKzMyLDcgQEAgdm9p
ZCBnNHhfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
CiB2b2lkIHZsdl93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsKIHZvaWQgaWxrX3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpOwogdm9pZCBza2xfd21fZ2V0X2h3X3N0YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7Ci11OCBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwordTggaW50ZWxfZW5hYmxlZF9kYnVmX3NsaWNl
c19tYXNrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiB2b2lkIHNrbF9waXBl
X2RkYl9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVsX2NydGMgKmNydGMsCiAJCQkgICAgICAgc3Ry
dWN0IHNrbF9kZGJfZW50cnkgKmRkYl95LAogCQkJICAgICAgIHN0cnVjdCBza2xfZGRiX2VudHJ5
ICpkZGJfdXYpOwotLSAKMi4yNC4xLjQ4NS5nYWQwNWEzZDhlNQoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRl
bC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

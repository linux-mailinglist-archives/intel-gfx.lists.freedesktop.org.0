Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B2DBF85C61
	for <lists+intel-gfx@lfdr.de>; Thu,  8 Aug 2019 10:03:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 79F006E7F3;
	Thu,  8 Aug 2019 08:03:18 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0BAA76E7DF
 for <intel-gfx@lists.freedesktop.org>; Thu,  8 Aug 2019 08:03:14 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17926054-1500050 
 for multiple; Thu, 08 Aug 2019 08:42:11 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  8 Aug 2019 08:41:59 +0100
Message-Id: <20190808074207.18274-11-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0.rc1
In-Reply-To: <20190808074207.18274-1-chris@chris-wilson.co.uk>
References: <20190808074207.18274-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 11/19] drm/i915/gt: Track timeline activeness in
 enter/exit
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

TGlmdCBtb3ZpbmcgdGhlIHRpbWVsaW5lIHRvL2Zyb20gdGhlIGFjdGl2ZV9saXN0IG9uIGVudGVy
L2V4aXQgaW4gb3JkZXIKdG8gc2hvcnRlbiB0aGUgYWN0aXZlIHRyYWNraW5nIHNwYW4gaW4gY29t
cGFyaXNvbiB0byB0aGUgZXhpc3RpbmcKcGluL3VucGluLgoKU2lnbmVkLW9mZi1ieTogQ2hyaXMg
V2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgICAgICAgIHwgIDEgLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfY29udGV4dC5jICAgICAgIHwgIDIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lX3BtLmMgICAgIHwgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfbHJjLmMgICAgICAgICAgIHwgIDQgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
dGltZWxpbmUuYyAgICAgIHwgOTggKysrKysrKy0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuaCAgICAgIHwgIDMgKy0KIC4uLi9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfdGltZWxpbmVfdHlwZXMuaCAgICB8IDE4ICsrKysKIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X3RpbWVsaW5lLmMgICB8ICAyIC0KIDggZmlsZXMgY2hhbmdlZCwgNjMg
aW5zZXJ0aW9ucygrKSwgNjYgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fcG0uYwppbmRleCA0Yjg2NmRiNDZkNTIuLmU2MmNmNDEzYTgzMiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKQEAgLTM3LDcgKzM3LDYgQEAgc3RhdGljIHZvaWQg
aTkxNV9nZW1fcGFyayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlmb3JfZWFjaF9l
bmdpbmUoZW5naW5lLCBpOTE1LCBpZCkKIAkJY2FsbF9pZGxlX2JhcnJpZXJzKGVuZ2luZSk7IC8q
IGNsZWFudXAgYWZ0ZXIgd2VkZ2luZyAqLwogCi0JaW50ZWxfdGltZWxpbmVzX3BhcmsoaTkxNSk7
CiAJaTkxNV92bWFfcGFya2VkKGk5MTUpOwogCiAJaTkxNV9nbG9iYWxzX3BhcmsoKTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwppbmRleCA3NzgzM2YxNTU4YTkuLjkxMTQ5
NTNiZjkyMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4
dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2NvbnRleHQuYwpAQCAtMjgw
LDEwICsyODAsMTIgQEAgaW50IF9faW5pdCBpOTE1X2dsb2JhbF9jb250ZXh0X2luaXQodm9pZCkK
IHZvaWQgaW50ZWxfY29udGV4dF9lbnRlcl9lbmdpbmUoc3RydWN0IGludGVsX2NvbnRleHQgKmNl
KQogewogCWludGVsX2VuZ2luZV9wbV9nZXQoY2UtPmVuZ2luZSk7CisJaW50ZWxfdGltZWxpbmVf
ZW50ZXIoY2UtPnRpbWVsaW5lKTsKIH0KIAogdm9pZCBpbnRlbF9jb250ZXh0X2V4aXRfZW5naW5l
KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIHsKKwlpbnRlbF90aW1lbGluZV9leGl0KGNlLT50
aW1lbGluZSk7CiAJaW50ZWxfZW5naW5lX3BtX3B1dChjZS0+ZW5naW5lKTsKIH0KIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfcG0uYwppbmRleCA2YjE1ZTMzMzVkZDYuLmVl
NmYwOGIzNTJhNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5n
aW5lX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3BtLmMK
QEAgLTY4LDYgKzY4LDcgQEAgc3RhdGljIGJvb2wgc3dpdGNoX3RvX2tlcm5lbF9jb250ZXh0KHN0
cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAogCS8qIENoZWNrIGFnYWluIG9uIHRoZSBu
ZXh0IHJldGlyZW1lbnQuICovCiAJZW5naW5lLT53YWtlcmVmX3NlcmlhbCA9IGVuZ2luZS0+c2Vy
aWFsICsgMTsKKwlpbnRlbF90aW1lbGluZV9lbnRlcihycS0+dGltZWxpbmUpOwogCiAJaTkxNV9y
ZXF1ZXN0X2FkZF9hY3RpdmVfYmFycmllcnMocnEpOwogCV9faTkxNV9yZXF1ZXN0X2NvbW1pdChy
cSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCmluZGV4IGI0ZjkzYTY1YTI0OS4uNGRk
MDA2NjFmODdkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtMzIyMCw2ICsz
MjIwLDggQEAgc3RhdGljIHZvaWQgdmlydHVhbF9jb250ZXh0X2VudGVyKHN0cnVjdCBpbnRlbF9j
b250ZXh0ICpjZSkKIAogCWZvciAobiA9IDA7IG4gPCB2ZS0+bnVtX3NpYmxpbmdzOyBuKyspCiAJ
CWludGVsX2VuZ2luZV9wbV9nZXQodmUtPnNpYmxpbmdzW25dKTsKKworCWludGVsX3RpbWVsaW5l
X2VudGVyKGNlLT50aW1lbGluZSk7CiB9CiAKIHN0YXRpYyB2b2lkIHZpcnR1YWxfY29udGV4dF9l
eGl0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKQEAgLTMyMjcsNiArMzIyOSw4IEBAIHN0YXRp
YyB2b2lkIHZpcnR1YWxfY29udGV4dF9leGl0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSkKIAlz
dHJ1Y3QgdmlydHVhbF9lbmdpbmUgKnZlID0gY29udGFpbmVyX29mKGNlLCB0eXBlb2YoKnZlKSwg
Y29udGV4dCk7CiAJdW5zaWduZWQgaW50IG47CiAKKwlpbnRlbF90aW1lbGluZV9leGl0KGNlLT50
aW1lbGluZSk7CisKIAlmb3IgKG4gPSAwOyBuIDwgdmUtPm51bV9zaWJsaW5nczsgbisrKQogCQlp
bnRlbF9lbmdpbmVfcG1fcHV0KHZlLT5zaWJsaW5nc1tuXSk7CiB9CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfdGltZWxpbmUuYwppbmRleCA2ZGFhOWViNTllMTkuLjRhZjBiOTgwMWQ5MSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZS5jCkBAIC0yNzgsNjQgKzI3
OCwxMSBAQCB2b2lkIGludGVsX3RpbWVsaW5lc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KQogCXRpbWVsaW5lc19pbml0KCZpOTE1LT5ndCk7CiB9CiAKLXN0YXRpYyB2b2lkIHRp
bWVsaW5lX2FkZF90b19hY3RpdmUoc3RydWN0IGludGVsX3RpbWVsaW5lICp0bCkKLXsKLQlzdHJ1
Y3QgaW50ZWxfZ3RfdGltZWxpbmVzICpndCA9ICZ0bC0+Z3QtPnRpbWVsaW5lczsKLQotCW11dGV4
X2xvY2soJmd0LT5tdXRleCk7Ci0JbGlzdF9hZGQoJnRsLT5saW5rLCAmZ3QtPmFjdGl2ZV9saXN0
KTsKLQltdXRleF91bmxvY2soJmd0LT5tdXRleCk7Ci19Ci0KLXN0YXRpYyB2b2lkIHRpbWVsaW5l
X3JlbW92ZV9mcm9tX2FjdGl2ZShzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRsKQotewotCXN0cnVj
dCBpbnRlbF9ndF90aW1lbGluZXMgKmd0ID0gJnRsLT5ndC0+dGltZWxpbmVzOwotCi0JbXV0ZXhf
bG9jaygmZ3QtPm11dGV4KTsKLQlsaXN0X2RlbCgmdGwtPmxpbmspOwotCW11dGV4X3VubG9jaygm
Z3QtPm11dGV4KTsKLX0KLQotc3RhdGljIHZvaWQgdGltZWxpbmVzX3Bhcmsoc3RydWN0IGludGVs
X2d0ICpndCkKLXsKLQlzdHJ1Y3QgaW50ZWxfZ3RfdGltZWxpbmVzICp0aW1lbGluZXMgPSAmZ3Qt
PnRpbWVsaW5lczsKLQlzdHJ1Y3QgaW50ZWxfdGltZWxpbmUgKnRpbWVsaW5lOwotCi0JbXV0ZXhf
bG9jaygmdGltZWxpbmVzLT5tdXRleCk7Ci0JbGlzdF9mb3JfZWFjaF9lbnRyeSh0aW1lbGluZSwg
JnRpbWVsaW5lcy0+YWN0aXZlX2xpc3QsIGxpbmspIHsKLQkJLyoKLQkJICogQWxsIGtub3duIGZl
bmNlcyBhcmUgY29tcGxldGVkIHNvIHdlIGNhbiBzY3JhcAotCQkgKiB0aGUgY3VycmVudCBzeW5j
IHBvaW50IHRyYWNraW5nIGFuZCBzdGFydCBhZnJlc2gsCi0JCSAqIGFueSBhdHRlbXB0IHRvIHdh
aXQgdXBvbiBhIHByZXZpb3VzIHN5bmMgcG9pbnQKLQkJICogd2lsbCBiZSBza2lwcGVkIGFzIHRo
ZSBmZW5jZSB3YXMgc2lnbmFsZWQuCi0JCSAqLwotCQlpOTE1X3N5bmNtYXBfZnJlZSgmdGltZWxp
bmUtPnN5bmMpOwotCX0KLQltdXRleF91bmxvY2soJnRpbWVsaW5lcy0+bXV0ZXgpOwotfQotCi0v
KioKLSAqIGludGVsX3RpbWVsaW5lc19wYXJrIC0gY2FsbGVkIHdoZW4gdGhlIGRyaXZlciBpZGxl
cwotICogQGk5MTU6IHRoZSBkcm1faTkxNV9wcml2YXRlIGRldmljZQotICoKLSAqIFdoZW4gdGhl
IGRyaXZlciBpcyBjb21wbGV0ZWx5IGlkbGUsIHdlIGtub3cgdGhhdCBhbGwgb2Ygb3VyIHN5bmMg
cG9pbnRzCi0gKiBoYXZlIGJlZW4gc2lnbmFsZWQgYW5kIG91ciB0cmFja2luZyBpcyB0aGVuIGVu
dGlyZWx5IHJlZHVuZGFudC4gQW55IHJlcXVlc3QKLSAqIHRvIHdhaXQgdXBvbiBhbiBvbGRlciBz
eW5jIHBvaW50IHdpbGwgYmUgY29tcGxldGVkIGluc3RhbnRseSBhcyB3ZSBrbm93Ci0gKiB0aGUg
ZmVuY2UgaXMgc2lnbmFsZWQgYW5kIHRoZXJlZm9yZSB3ZSB3aWxsIG5vdCBldmVuIGxvb2sgdGhl
bSB1cCBpbiB0aGUKLSAqIHN5bmMgcG9pbnQgbWFwLgotICovCi12b2lkIGludGVsX3RpbWVsaW5l
c19wYXJrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQotewotCXRpbWVsaW5lc19wYXJr
KCZpOTE1LT5ndCk7Ci19Ci0KIHZvaWQgaW50ZWxfdGltZWxpbmVfZmluaShzdHJ1Y3QgaW50ZWxf
dGltZWxpbmUgKnRpbWVsaW5lKQogewogCUdFTV9CVUdfT04odGltZWxpbmUtPnBpbl9jb3VudCk7
CiAJR0VNX0JVR19PTighbGlzdF9lbXB0eSgmdGltZWxpbmUtPnJlcXVlc3RzKSk7CiAKLQlpOTE1
X3N5bmNtYXBfZnJlZSgmdGltZWxpbmUtPnN5bmMpOwotCiAJaWYgKHRpbWVsaW5lLT5od3NwX2Nh
Y2hlbGluZSkKIAkJY2FjaGVsaW5lX2ZyZWUodGltZWxpbmUtPmh3c3BfY2FjaGVsaW5lKTsKIAll
bHNlCkBAIC0zNzAsNiArMzE3LDcgQEAgaW50IGludGVsX3RpbWVsaW5lX3BpbihzdHJ1Y3QgaW50
ZWxfdGltZWxpbmUgKnRsKQogCWlmICh0bC0+cGluX2NvdW50KyspCiAJCXJldHVybiAwOwogCUdF
TV9CVUdfT04oIXRsLT5waW5fY291bnQpOworCUdFTV9CVUdfT04odGwtPmFjdGl2ZV9jb3VudCk7
CiAKIAllcnIgPSBpOTE1X3ZtYV9waW4odGwtPmh3c3BfZ2d0dCwgMCwgMCwgUElOX0dMT0JBTCB8
IFBJTl9ISUdIKTsKIAlpZiAoZXJyKQpAQCAtMzgwLDcgKzMyOCw2IEBAIGludCBpbnRlbF90aW1l
bGluZV9waW4oc3RydWN0IGludGVsX3RpbWVsaW5lICp0bCkKIAkJb2Zmc2V0X2luX3BhZ2UodGwt
Pmh3c3Bfb2Zmc2V0KTsKIAogCWNhY2hlbGluZV9hY3F1aXJlKHRsLT5od3NwX2NhY2hlbGluZSk7
Ci0JdGltZWxpbmVfYWRkX3RvX2FjdGl2ZSh0bCk7CiAKIAlyZXR1cm4gMDsKIApAQCAtMzg5LDYg
KzMzNiw0MCBAQCBpbnQgaW50ZWxfdGltZWxpbmVfcGluKHN0cnVjdCBpbnRlbF90aW1lbGluZSAq
dGwpCiAJcmV0dXJuIGVycjsKIH0KIAordm9pZCBpbnRlbF90aW1lbGluZV9lbnRlcihzdHJ1Y3Qg
aW50ZWxfdGltZWxpbmUgKnRsKQoreworCXN0cnVjdCBpbnRlbF9ndF90aW1lbGluZXMgKnRpbWVs
aW5lcyA9ICZ0bC0+Z3QtPnRpbWVsaW5lczsKKworCUdFTV9CVUdfT04oIXRsLT5waW5fY291bnQp
OworCWlmICh0bC0+YWN0aXZlX2NvdW50KyspCisJCXJldHVybjsKKwlHRU1fQlVHX09OKCF0bC0+
YWN0aXZlX2NvdW50KTsgLyogb3ZlcmZsb3c/ICovCisKKwltdXRleF9sb2NrKCZ0aW1lbGluZXMt
Pm11dGV4KTsKKwlsaXN0X2FkZCgmdGwtPmxpbmssICZ0aW1lbGluZXMtPmFjdGl2ZV9saXN0KTsK
KwltdXRleF91bmxvY2soJnRpbWVsaW5lcy0+bXV0ZXgpOworfQorCit2b2lkIGludGVsX3RpbWVs
aW5lX2V4aXQoc3RydWN0IGludGVsX3RpbWVsaW5lICp0bCkKK3sKKwlzdHJ1Y3QgaW50ZWxfZ3Rf
dGltZWxpbmVzICp0aW1lbGluZXMgPSAmdGwtPmd0LT50aW1lbGluZXM7CisKKwlHRU1fQlVHX09O
KCF0bC0+YWN0aXZlX2NvdW50KTsKKwlpZiAoLS10bC0+YWN0aXZlX2NvdW50KQorCQlyZXR1cm47
CisKKwltdXRleF9sb2NrKCZ0aW1lbGluZXMtPm11dGV4KTsKKwlsaXN0X2RlbCgmdGwtPmxpbmsp
OworCW11dGV4X3VubG9jaygmdGltZWxpbmVzLT5tdXRleCk7CisKKwkvKgorCSAqIFNpbmNlIHRo
aXMgdGltZWxpbmUgaXMgaWRsZSwgYWxsIGJhcmllcnMgdXBvbiB3aGljaCB3ZSB3ZXJlIHdhaXRp
bmcKKwkgKiBtdXN0IGFsc28gYmUgY29tcGxldGUgYW5kIHNvIHdlIGNhbiBkaXNjYXJkIHRoZSBs
YXN0IHVzZWQgYmFycmllcnMKKwkgKiB3aXRob3V0IGxvc3Mgb2YgaW5mb3JtYXRpb24uCisJICov
CisJaTkxNV9zeW5jbWFwX2ZyZWUoJnRsLT5zeW5jKTsKK30KKwogc3RhdGljIHUzMiB0aW1lbGlu
ZV9hZHZhbmNlKHN0cnVjdCBpbnRlbF90aW1lbGluZSAqdGwpCiB7CiAJR0VNX0JVR19PTighdGwt
PnBpbl9jb3VudCk7CkBAIC01NDYsMTYgKzUyNyw5IEBAIHZvaWQgaW50ZWxfdGltZWxpbmVfdW5w
aW4oc3RydWN0IGludGVsX3RpbWVsaW5lICp0bCkKIAlpZiAoLS10bC0+cGluX2NvdW50KQogCQly
ZXR1cm47CiAKLQl0aW1lbGluZV9yZW1vdmVfZnJvbV9hY3RpdmUodGwpOworCUdFTV9CVUdfT04o
dGwtPmFjdGl2ZV9jb3VudCk7CiAJY2FjaGVsaW5lX3JlbGVhc2UodGwtPmh3c3BfY2FjaGVsaW5l
KTsKIAotCS8qCi0JICogU2luY2UgdGhpcyB0aW1lbGluZSBpcyBpZGxlLCBhbGwgYmFyaWVycyB1
cG9uIHdoaWNoIHdlIHdlcmUgd2FpdGluZwotCSAqIG11c3QgYWxzbyBiZSBjb21wbGV0ZSBhbmQg
c28gd2UgY2FuIGRpc2NhcmQgdGhlIGxhc3QgdXNlZCBiYXJyaWVycwotCSAqIHdpdGhvdXQgbG9z
cyBvZiBpbmZvcm1hdGlvbi4KLQkgKi8KLQlpOTE1X3N5bmNtYXBfZnJlZSgmdGwtPnN5bmMpOwot
CiAJX19pOTE1X3ZtYV91bnBpbih0bC0+aHdzcF9nZ3R0KTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuaCBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX3RpbWVsaW5lLmgKaW5kZXggZTA4Y2ViZjY0ODMzLi5mNTgzYWYxYmExOGQg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lLmgKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfdGltZWxpbmUuaApAQCAtNzcsOSArNzcs
MTEgQEAgc3RhdGljIGlubGluZSBib29sIGludGVsX3RpbWVsaW5lX3N5bmNfaXNfbGF0ZXIoc3Ry
dWN0IGludGVsX3RpbWVsaW5lICp0bCwKIH0KIAogaW50IGludGVsX3RpbWVsaW5lX3BpbihzdHJ1
Y3QgaW50ZWxfdGltZWxpbmUgKnRsKTsKK3ZvaWQgaW50ZWxfdGltZWxpbmVfZW50ZXIoc3RydWN0
IGludGVsX3RpbWVsaW5lICp0bCk7CiBpbnQgaW50ZWxfdGltZWxpbmVfZ2V0X3NlcW5vKHN0cnVj
dCBpbnRlbF90aW1lbGluZSAqdGwsCiAJCQkgICAgIHN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxLAog
CQkJICAgICB1MzIgKnNlcW5vKTsKK3ZvaWQgaW50ZWxfdGltZWxpbmVfZXhpdChzdHJ1Y3QgaW50
ZWxfdGltZWxpbmUgKnRsKTsKIHZvaWQgaW50ZWxfdGltZWxpbmVfdW5waW4oc3RydWN0IGludGVs
X3RpbWVsaW5lICp0bCk7CiAKIGludCBpbnRlbF90aW1lbGluZV9yZWFkX2h3c3Aoc3RydWN0IGk5
MTVfcmVxdWVzdCAqZnJvbSwKQEAgLTg3LDcgKzg5LDYgQEAgaW50IGludGVsX3RpbWVsaW5lX3Jl
YWRfaHdzcChzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpmcm9tLAogCQkJICAgICB1MzIgKmh3c3Bfb2Zm
c2V0KTsKIAogdm9pZCBpbnRlbF90aW1lbGluZXNfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSk7Ci12b2lkIGludGVsX3RpbWVsaW5lc19wYXJrKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KTsKIHZvaWQgaW50ZWxfdGltZWxpbmVzX2Zpbmkoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpOwogCiAjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX3RpbWVsaW5lX3R5cGVzLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF90aW1lbGluZV90eXBlcy5oCmluZGV4IDlhNzFhZWE3YTMzOC4uYjFhOWYwYzU0YmYwIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF90aW1lbGluZV90eXBlcy5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3RpbWVsaW5lX3R5cGVzLmgKQEAgLTI1
LDcgKzI1LDI1IEBAIHN0cnVjdCBpbnRlbF90aW1lbGluZSB7CiAKIAlzdHJ1Y3QgbXV0ZXggbXV0
ZXg7IC8qIHByb3RlY3RzIHRoZSBmbG93IG9mIHJlcXVlc3RzICovCiAKKwkvKgorCSAqIHBpbl9j
b3VudCBhbmQgYWN0aXZlX2NvdW50IHRyYWNrIGVzc2VudGlhbGx5IHRoZSBzYW1lIHRoaW5nOgor
CSAqIEhvdyBtYW55IHJlcXVlc3RzIGFyZSBpbiBmbGlnaHQgb3IgbWF5IGJlIHVuZGVyIGNvbnN0
cnVjdGlvbi4KKwkgKgorCSAqIFdlIG5lZWQgdHdvIGRpc3RpbmN0IGNvdW50ZXJzIHNvIHRoYXQg
d2UgY2FuIGFzc2lnbiBkaWZmZXJlbnQKKwkgKiBsaWZldGltZXMgdG8gdGhlIGV2ZW50cyBmb3Ig
ZGlmZmVyZW50IHVzZS1jYXNlcy4gRm9yIGV4YW1wbGUsCisJICogd2Ugd2FudCB0byBwZXJtYW5l
bnRseSBrZWVwIHRoZSB0aW1lbGluZSBwaW5uZWQgZm9yIHRoZSBrZXJuZWwKKwkgKiBjb250ZXh0
IHNvIHRoYXQgd2UgY2FuIGlzc3VlIHJlcXVlc3RzIGF0IGFueSB0aW1lIHdpdGhvdXQgaGF2aW5n
CisJICogdG8gYWNxdWlyZSBzcGFjZSBpbiB0aGUgR0dUVC4gSG93ZXZlciwgd2Ugd2FudCB0byBr
ZWVwIHRyYWNraW5nCisJICogdGhlIGFjdGl2aXR5ICh0byBiZSBhYmxlIHRvIGRldGVjdCB3aGVu
IHdlIGJlY29tZSBpZGxlKSBhbG9uZyB0aGF0CisJICogcGVybWFuZW50bHkgcGlubmVkIHRpbWVs
aW5lIGFuZCBzbyBlbmQgdXAgcmVxdWlyaW5nIHR3byBjb3VudGVycy4KKwkgKgorCSAqIE5vdGUg
dGhhdCB0aGUgYWN0aXZlX2NvdW50IGlzIHByb3RlY3RlZCBieSB0aGUgaW50ZWxfdGltZWxpbmUu
bXV0ZXgsCisJICogYnV0IHRoZSBwaW5fY291bnQgaXMgcHJvdGVjdGVkIGJ5IGEgY29tYmluYXRp
b24gb2Ygc2VyaWFsaXNhdGlvbgorCSAqIGZyb20gdGhlIGludGVsX2NvbnRleHQgY2FsbGVyIHBs
dXMgaW50ZXJuYWwgYXRvbWljaXR5LgorCSAqLwogCXVuc2lnbmVkIGludCBwaW5fY291bnQ7CisJ
dW5zaWduZWQgaW50IGFjdGl2ZV9jb3VudDsKKwogCWNvbnN0IHUzMiAqaHdzcF9zZXFubzsKIAlz
dHJ1Y3QgaTkxNV92bWEgKmh3c3BfZ2d0dDsKIAl1MzIgaHdzcF9vZmZzZXQ7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF90aW1lbGluZS5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfdGltZWxpbmUuYwppbmRleCBmMGE4NDAwMzAzODIuLmQ1
NDExMzY5Nzc0NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rf
dGltZWxpbmUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF90aW1lbGlu
ZS5jCkBAIC04MTYsOCArODE2LDYgQEAgc3RhdGljIGludCBsaXZlX2h3c3BfcmVjeWNsZSh2b2lk
ICphcmcpCiAKIAkJCWlmIChlcnIpCiAJCQkJZ290byBvdXQ7Ci0KLQkJCWludGVsX3RpbWVsaW5l
c19wYXJrKGk5MTUpOyAvKiBFbmNvdXJhZ2UgcmVjeWNsaW5nISAqLwogCQl9IHdoaWxlICghX19p
Z3RfdGltZW91dChlbmRfdGltZSwgTlVMTCkpOwogCX0KIAotLSAKMi4yMy4wLnJjMQoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxp
bmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

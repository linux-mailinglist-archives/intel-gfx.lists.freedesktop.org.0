Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id E0C3A175A6
	for <lists+intel-gfx@lfdr.de>; Wed,  8 May 2019 12:10:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id C26E789683;
	Wed,  8 May 2019 10:10:25 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id AA2EC8958E;
 Wed,  8 May 2019 10:10:23 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16487688-1500050 
 for multiple; Wed, 08 May 2019 11:10:01 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed,  8 May 2019 11:09:46 +0100
Message-Id: <20190508100958.32637-4-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190508100958.32637-1-chris@chris-wilson.co.uk>
References: <20190508100958.32637-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH i-g-t 04/16] i915/gem_ctx_param: Test set/get
 (copy) VM
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: igt-dev@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RXhlcmNpc2UgcmV1c2luZyB0aGUgR1RUIG9mIG9uZSBjdHggaW4gYW5vdGhlci4KCnYyOiBUZXN0
IHNldHRpbmcgYmFjayB0byB0aGUgc2FtZSBWTQp2MzogQ2hlY2sgdGhlIFZNIHN0aWxsIGV4aXN0
cyBhZnRlciB0aGUgcGFyZW50IGN0eCBhcmUgZGVhZC4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdp
bHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRr
by51cnN1bGluQGludGVsLmNvbT4KLS0tCiB0ZXN0cy9pOTE1L2dlbV9jdHhfcGFyYW0uYyB8IDEw
NyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tCiAxIGZpbGUgY2hhbmdlZCwg
OTUgaW5zZXJ0aW9ucygrKSwgMTIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvdGVzdHMvaTkx
NS9nZW1fY3R4X3BhcmFtLmMgYi90ZXN0cy9pOTE1L2dlbV9jdHhfcGFyYW0uYwppbmRleCBiNmY1
NzIzNmMuLmQ5NDljZWYzMiAxMDA2NDQKLS0tIGEvdGVzdHMvaTkxNS9nZW1fY3R4X3BhcmFtLmMK
KysrIGIvdGVzdHMvaTkxNS9nZW1fY3R4X3BhcmFtLmMKQEAgLTI4LDYgKzI4LDcgQEAKICNpbmNs
dWRlIDxsaW1pdHMuaD4KIAogI2luY2x1ZGUgImlndC5oIgorI2luY2x1ZGUgImk5MTUvZ2VtX3Zt
LmgiCiAKIElHVF9URVNUX0RFU0NSSVBUSU9OKCJCYXNpYyB0ZXN0IGZvciBjb250ZXh0IHNldC9n
ZXQgcGFyYW0gaW5wdXQgdmFsaWRhdGlvbi4iKTsKIApAQCAtMzYsMTcgKzM3LDYgQEAgSUdUX1RF
U1RfREVTQ1JJUFRJT04oIkJhc2ljIHRlc3QgZm9yIGNvbnRleHQgc2V0L2dldCBwYXJhbSBpbnB1
dCB2YWxpZGF0aW9uLiIpOwogI2RlZmluZSBORVdfQ1RYCUJJVCgwKQogI2RlZmluZSBVU0VSIEJJ
VCgxKQogCi1zdGF0aWMgaW50IHJlb3Blbl9kcml2ZXIoaW50IGZkKQotewotCWNoYXIgcGF0aFsy
NTZdOwotCi0Jc25wcmludGYocGF0aCwgc2l6ZW9mKHBhdGgpLCAiL3Byb2Mvc2VsZi9mZC8lZCIs
IGZkKTsKLQlmZCA9IG9wZW4ocGF0aCwgT19SRFdSKTsKLQlpZ3RfYXNzZXJ0X2x0ZSgwLCBmZCk7
Ci0KLQlyZXR1cm4gZmQ7Ci19Ci0KIHN0YXRpYyB2b2lkIHNldF9wcmlvcml0eShpbnQgaTkxNSkK
IHsKIAlzdGF0aWMgY29uc3QgaW50NjRfdCB0ZXN0X3ZhbHVlc1tdID0gewpAQCAtOTEsNyArODEs
NyBAQCBzdGF0aWMgdm9pZCBzZXRfcHJpb3JpdHkoaW50IGk5MTUpCiAJaWd0X3Blcm11dGVfYXJy
YXkodmFsdWVzLCBzaXplLCBpZ3RfZXhjaGFuZ2VfaW50NjQpOwogCiAJaWd0X2ZvcmsoZmxhZ3Ms
IE5FV19DVFggfCBVU0VSKSB7Ci0JCWludCBmZCA9IHJlb3Blbl9kcml2ZXIoaTkxNSk7CisJCWlu
dCBmZCA9IGdlbV9yZW9wZW5fZHJpdmVyKGk5MTUpOwogCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX2Nv
bnRleHRfcGFyYW0gYXJnID0gewogCQkJLnBhcmFtID0gSTkxNV9DT05URVhUX1BBUkFNX1BSSU9S
SVRZLAogCQkJLmN0eF9pZCA9IGZsYWdzICYgTkVXX0NUWCA/IGdlbV9jb250ZXh0X2NyZWF0ZShm
ZCkgOiAwLApAQCAtMTQzLDYgKzEzMyw5NiBAQCBzdGF0aWMgdm9pZCBzZXRfcHJpb3JpdHkoaW50
IGk5MTUpCiAJZnJlZSh2YWx1ZXMpOwogfQogCitzdGF0aWMgdWludDMyX3QgX19iYXRjaF9jcmVh
dGUoaW50IGk5MTUsIHVpbnQzMl90IG9mZnNldCkKK3sKKwljb25zdCB1aW50MzJfdCBiYmUgPSBN
SV9CQVRDSF9CVUZGRVJfRU5EOworCXVpbnQzMl90IGhhbmRsZTsKKworCWhhbmRsZSA9IGdlbV9j
cmVhdGUoaTkxNSwgQUxJR04ob2Zmc2V0ICsgNCwgNDA5NikpOworCWdlbV93cml0ZShpOTE1LCBo
YW5kbGUsIG9mZnNldCwgJmJiZSwgc2l6ZW9mKGJiZSkpOworCisJcmV0dXJuIGhhbmRsZTsKK30K
Kworc3RhdGljIHVpbnQzMl90IGJhdGNoX2NyZWF0ZShpbnQgaTkxNSkKK3sKKwlyZXR1cm4gX19i
YXRjaF9jcmVhdGUoaTkxNSwgMCk7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3Rfdm0oaW50IGk5MTUp
Cit7CisJY29uc3QgdWludDY0X3Qgbm9uemVyb19vZmZzZXQgPSA0OCA8PCAyMDsKKwlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX2V4ZWNfb2JqZWN0MiBiYXRjaCA9IHsKKwkJLmhhbmRsZSA9IGJhdGNoX2Ny
ZWF0ZShpOTE1KSwKKwl9OworCXN0cnVjdCBkcm1faTkxNV9nZW1fZXhlY2J1ZmZlcjIgZWIgPSB7
CisJCS5idWZmZXJzX3B0ciA9IHRvX3VzZXJfcG9pbnRlcigmYmF0Y2gpLAorCQkuYnVmZmVyX2Nv
dW50ID0gMSwKKwl9OworCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSBhcmcgPSB7
CisJCS5wYXJhbSA9IEk5MTVfQ09OVEVYVF9QQVJBTV9WTSwKKwl9OworCXVpbnQzMl90IHBhcmVu
dCwgY2hpbGQ7CisKKwlhcmcudmFsdWUgPSAtMXVsbDsKKwlpZ3RfcmVxdWlyZShfX2dlbV9jb250
ZXh0X3NldF9wYXJhbShpOTE1LCAmYXJnKSA9PSAtRU5PRU5UKTsKKworCXBhcmVudCA9IGdlbV9j
b250ZXh0X2NyZWF0ZShpOTE1KTsKKwljaGlsZCA9IGdlbV9jb250ZXh0X2NyZWF0ZShpOTE1KTsK
KworCS8qIFVzaW5nIGltcGxpY2l0IHNvZnQtcGlubmluZyAqLworCWViLnJzdmQxID0gcGFyZW50
OworCWJhdGNoLm9mZnNldCA9IG5vbnplcm9fb2Zmc2V0OworCWdlbV9leGVjYnVmKGk5MTUsICZl
Yik7CisJaWd0X2Fzc2VydF9lcV91NjQoYmF0Y2gub2Zmc2V0LCBub256ZXJvX29mZnNldCk7CisK
KwllYi5yc3ZkMSA9IGNoaWxkOworCWJhdGNoLm9mZnNldCA9IDA7CisJZ2VtX2V4ZWNidWYoaTkx
NSwgJmViKTsKKwlpZ3RfYXNzZXJ0X2VxX3U2NChiYXRjaC5vZmZzZXQsIDApOworCisJZWIucnN2
ZDEgPSBwYXJlbnQ7CisJZ2VtX2V4ZWNidWYoaTkxNSwgJmViKTsKKwlpZ3RfYXNzZXJ0X2VxX3U2
NChiYXRjaC5vZmZzZXQsIG5vbnplcm9fb2Zmc2V0KTsKKworCWFyZy5jdHhfaWQgPSBwYXJlbnQ7
CisJZ2VtX2NvbnRleHRfZ2V0X3BhcmFtKGk5MTUsICZhcmcpOworCWdlbV9jb250ZXh0X3NldF9w
YXJhbShpOTE1LCAmYXJnKTsKKworCS8qIFN0aWxsIHRoZSBzYW1lIFZNLCBzbyBleHBlY3QgdGhl
IG9sZCBWTUEgYWdhaW4gKi8KKwliYXRjaC5vZmZzZXQgPSAwOworCWdlbV9leGVjYnVmKGk5MTUs
ICZlYik7CisJaWd0X2Fzc2VydF9lcV91NjQoYmF0Y2gub2Zmc2V0LCBub256ZXJvX29mZnNldCk7
CisKKwlhcmcuY3R4X2lkID0gY2hpbGQ7CisJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGk5MTUsICZh
cmcpOworCisJZWIucnN2ZDEgPSBjaGlsZDsKKwliYXRjaC5vZmZzZXQgPSAwOworCWdlbV9leGVj
YnVmKGk5MTUsICZlYik7CisJaWd0X2Fzc2VydF9lcV91NjQoYmF0Y2gub2Zmc2V0LCBub256ZXJv
X29mZnNldCk7CisKKwlnZW1fY29udGV4dF9kZXN0cm95KGk5MTUsIGNoaWxkKTsKKwlnZW1fY29u
dGV4dF9kZXN0cm95KGk5MTUsIHBhcmVudCk7CisKKwkvKiBib3RoIGNvbnRleHRzIGRlc3Ryb3ll
ZCwgYnV0IHdlIHN0aWxsIGtlZXAgaG9sZCBvZiB0aGUgdm0gKi8KKwljaGlsZCA9IGdlbV9jb250
ZXh0X2NyZWF0ZShpOTE1KTsKKworCWFyZy5jdHhfaWQgPSBjaGlsZDsKKwlnZW1fY29udGV4dF9z
ZXRfcGFyYW0oaTkxNSwgJmFyZyk7CisKKwllYi5yc3ZkMSA9IGNoaWxkOworCWJhdGNoLm9mZnNl
dCA9IDA7CisJZ2VtX2V4ZWNidWYoaTkxNSwgJmViKTsKKwlpZ3RfYXNzZXJ0X2VxX3U2NChiYXRj
aC5vZmZzZXQsIG5vbnplcm9fb2Zmc2V0KTsKKworCWdlbV9jb250ZXh0X2Rlc3Ryb3koaTkxNSwg
Y2hpbGQpOworCWdlbV92bV9kZXN0cm95KGk5MTUsIGFyZy52YWx1ZSk7CisKKwlnZW1fc3luYyhp
OTE1LCBiYXRjaC5oYW5kbGUpOworCWdlbV9jbG9zZShpOTE1LCBiYXRjaC5oYW5kbGUpOworfQor
CiBpZ3RfbWFpbgogewogCXN0cnVjdCBkcm1faTkxNV9nZW1fY29udGV4dF9wYXJhbSBhcmc7CkBA
IC0yNTMsNiArMzMzLDkgQEAgaWd0X21haW4KIAkJZ2VtX2NvbnRleHRfc2V0X3BhcmFtKGZkLCAm
YXJnKTsKIAl9CiAKKwlpZ3Rfc3VidGVzdCgidm0iKQorCQl0ZXN0X3ZtKGZkKTsKKwogCWFyZy5w
YXJhbSA9IEk5MTVfQ09OVEVYVF9QQVJBTV9QUklPUklUWTsKIAogCWlndF9zdWJ0ZXN0KCJzZXQt
cHJpb3JpdHktbm90LXN1cHBvcnRlZCIpIHsKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRl
bC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9E8BC3B7D5
	for <lists+intel-gfx@lfdr.de>; Mon, 10 Jun 2019 16:54:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 073928914B;
	Mon, 10 Jun 2019 14:54:36 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B91468914B
 for <intel-gfx@lists.freedesktop.org>; Mon, 10 Jun 2019 14:54:34 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16853786-1500050 
 for <intel-gfx@lists.freedesktop.org>; Mon, 10 Jun 2019 15:54:30 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 10 Jun 2019 15:54:30 +0100
Message-Id: <20190610145430.17717-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [CI] drm/i915: Promote i915->mm.obj_lock to be irqsafe
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIGludGVudCBpcyB0byBiZSBhYmxlIHRvIHVwZGF0ZSB0aGUgbW0ubGlzdHMgZnJvbSBpbnNp
ZGUgYW4gaXJxc29mZgpzZWN0aW9uIChlLmcuIGZyb20gYSBzb2Z0aXJxIHJjdSB3b3JrcXVldWUp
LCBlcmdvIHdlIG5lZWQgdG8gbWFrZSB0aGUKaTkxNS0+bW0ub2JqX2xvY2sgaXJxc2FmZS4KCnYy
OiBjYW5fZGlzY2FyZF9wYWdlcygpIGVuc3VyZXMgd2UgYXJlIHNocmlua2FibGUKdjM6IEJld2Fy
ZSBzaGFkb3dpbmcgb2YgJ2ZsYWdzJwoKRml4ZXM6IDNiNGZhOTY0MGNjZCAoImRybS9pOTE1OiBU
cmFjayB0aGUgcHVyZ2VhYmxlIG9iamVjdHMgb24gYSBzZXBhcmF0ZSBldmljdGlvbiBsaXN0IikK
QnVnemlsbGE6IGh0dHBzOi8vYnVncy5mcmVlZGVza3RvcC5vcmcvc2hvd19idWcuY2dpP2lkPTEx
MDg2OQpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51
az4KQ2M6IEpvb25hcyBMYWh0aW5lbiA8am9vbmFzLmxhaHRpbmVuQGxpbnV4LmludGVsLmNvbT4K
Q2M6IE1hdHRoZXcgQXVsZCA8bWF0dGhldy53aWxsaWFtLmF1bGRAZ21haWwuY29tPgpSZXZpZXdl
ZC1ieTogTWF0dGhldyBBdWxkIDxtYXR0aGV3LndpbGxpYW0uYXVsZEBnbWFpbC5jb20+Ci0tLQog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jICAgfCAyMyArKysrKysr
LS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYyAgIHwgMTIg
KysrKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BhZ2VzLmMgICAgfCAx
NiArKysrKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9zaHJpbmtlci5j
IHwgMzggKysrKysrKysrKy0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9zdG9sZW4uYyAgIHwgIDUgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVn
ZnMuYyAgICAgICAgICB8IDEwICsrKy0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0u
YyAgICAgICAgICAgICAgfCAgOCArKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEu
YyAgICAgICAgICAgICAgfCAxNyArKysrKy0tLS0KIDggZmlsZXMgY2hhbmdlZCwgODAgaW5zZXJ0
aW9ucygrKSwgNDkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2RvbWFpbi5jCmluZGV4IGU1ZGVhZTYyNjgxZi4uMzE5MjkyMjBiOTBmIDEwMDY0NAotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZG9tYWluLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2RvbWFpbi5jCkBAIC00NzUsMTUgKzQ3NSwyMCBA
QCBzdGF0aWMgdm9pZCBpOTE1X2dlbV9vYmplY3RfYnVtcF9pbmFjdGl2ZV9nZ3R0KHN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAJfQogCW11dGV4X3VubG9jaygmaTkxNS0+Z2d0dC52
bS5tdXRleCk7CiAKLQlpZiAoaTkxNV9nZW1fb2JqZWN0X2lzX3Nocmlua2FibGUob2JqKSAmJgot
CSAgICBvYmotPm1tLm1hZHYgPT0gSTkxNV9NQURWX1dJTExORUVEKSB7Ci0JCXN0cnVjdCBsaXN0
X2hlYWQgKmxpc3Q7Ci0KLQkJc3Bpbl9sb2NrKCZpOTE1LT5tbS5vYmpfbG9jayk7Ci0JCWxpc3Qg
PSBvYmotPmJpbmRfY291bnQgPwotCQkJJmk5MTUtPm1tLmJvdW5kX2xpc3QgOiAmaTkxNS0+bW0u
dW5ib3VuZF9saXN0OwotCQlsaXN0X21vdmVfdGFpbCgmb2JqLT5tbS5saW5rLCBsaXN0KTsKLQkJ
c3Bpbl91bmxvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKKwlpZiAoaTkxNV9nZW1fb2JqZWN0X2lz
X3Nocmlua2FibGUob2JqKSkgeworCQl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJCXNwaW5fbG9j
a19pcnFzYXZlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOworCisJCWlmIChvYmotPm1tLm1h
ZHYgPT0gSTkxNV9NQURWX1dJTExORUVEKSB7CisJCQlzdHJ1Y3QgbGlzdF9oZWFkICpsaXN0Owor
CisJCQlsaXN0ID0gb2JqLT5iaW5kX2NvdW50ID8KKwkJCQkmaTkxNS0+bW0uYm91bmRfbGlzdCA6
ICZpOTE1LT5tbS51bmJvdW5kX2xpc3Q7CisJCQlsaXN0X21vdmVfdGFpbCgmb2JqLT5tbS5saW5r
LCBsaXN0KTsKKwkJfQorCisJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPm1tLm9ial9s
b2NrLCBmbGFncyk7CiAJfQogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
b2JqZWN0LmMKaW5kZXggYTBiYzhmN2FiNzgwLi5kMDJhMWFmZjIwNTggMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKQEAgLTIwNyw5ICsyMDcsMTEgQEAgc3Rh
dGljIHZvaWQgX19pOTE1X2dlbV9mcmVlX29iamVjdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCiAJCSAqLwogCQlpZiAoaTkxNV9nZW1fb2JqZWN0X2hhc19wYWdlcyhvYmopICYmCiAJ
CSAgICBpOTE1X2dlbV9vYmplY3RfaXNfc2hyaW5rYWJsZShvYmopKSB7Ci0JCQlzcGluX2xvY2so
Jmk5MTUtPm1tLm9ial9sb2NrKTsKKwkJCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwkJCXNwaW5f
bG9ja19pcnFzYXZlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwogCQkJbGlzdF9kZWxfaW5p
dCgmb2JqLT5tbS5saW5rKTsKLQkJCXNwaW5fdW5sb2NrKCZpOTE1LT5tbS5vYmpfbG9jayk7CisJ
CQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwogCQl9
CiAKIAkJbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKQEAgLTMzMCw5ICsz
MzIsMTEgQEAgdm9pZCBpOTE1X2dlbV9mcmVlX29iamVjdChzdHJ1Y3QgZHJtX2dlbV9vYmplY3Qg
KmdlbV9vYmopCiAJCW9iai0+bW0ubWFkdiA9IEk5MTVfTUFEVl9ET05UTkVFRDsKIAogCQlpZiAo
aTkxNV9nZW1fb2JqZWN0X2hhc19wYWdlcyhvYmopKSB7Ci0JCQlzcGluX2xvY2soJmk5MTUtPm1t
Lm9ial9sb2NrKTsKKwkJCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwkJCXNwaW5fbG9ja19pcnFz
YXZlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwogCQkJbGlzdF9tb3ZlX3RhaWwoJm9iai0+
bW0ubGluaywgJmk5MTUtPm1tLnB1cmdlX2xpc3QpOwotCQkJc3Bpbl91bmxvY2soJmk5MTUtPm1t
Lm9ial9sb2NrKTsKKwkJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPm1tLm9ial9sb2Nr
LCBmbGFncyk7CiAJCX0KIAl9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9pOTE1X2dlbV9wYWdlcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Bh
Z2VzLmMKaW5kZXggN2U2NGZkNmJjMTliLi43ZmY5MDdkNmQwYzYgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9wYWdlcy5jCkBAIC01NywxMSArNTcsMTUgQEAgdm9pZCBfX2k5
MTVfZ2VtX29iamVjdF9zZXRfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwK
IAlHRU1fQlVHX09OKCFIQVNfUEFHRV9TSVpFUyhpOTE1LCBvYmotPm1tLnBhZ2Vfc2l6ZXMuc2cp
KTsKIAogCWlmIChpOTE1X2dlbV9vYmplY3RfaXNfc2hyaW5rYWJsZShvYmopKSB7Ci0JCXNwaW5f
bG9jaygmaTkxNS0+bW0ub2JqX2xvY2spOworCQl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJCXNw
aW5fbG9ja19pcnFzYXZlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOworCiAJCWk5MTUtPm1t
LnNocmlua19jb3VudCsrOwogCQlpOTE1LT5tbS5zaHJpbmtfbWVtb3J5ICs9IG9iai0+YmFzZS5z
aXplOwogCQlsaXN0X2FkZCgmb2JqLT5tbS5saW5rLCAmaTkxNS0+bW0udW5ib3VuZF9saXN0KTsK
LQkJc3Bpbl91bmxvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKKworCQlzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwogCX0KIH0KIApAQCAtMTUxLDExICsx
NTUsMTUgQEAgX19pOTE1X2dlbV9vYmplY3RfdW5zZXRfcGFnZXMoc3RydWN0IGRybV9pOTE1X2dl
bV9vYmplY3QgKm9iaikKIAkJcmV0dXJuIHBhZ2VzOwogCiAJaWYgKGk5MTVfZ2VtX29iamVjdF9p
c19zaHJpbmthYmxlKG9iaikpIHsKLQkJc3Bpbl9sb2NrKCZpOTE1LT5tbS5vYmpfbG9jayk7CisJ
CXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwkJc3Bpbl9sb2NrX2lycXNhdmUoJmk5MTUtPm1tLm9i
al9sb2NrLCBmbGFncyk7CisKIAkJbGlzdF9kZWwoJm9iai0+bW0ubGluayk7CiAJCWk5MTUtPm1t
LnNocmlua19jb3VudC0tOwogCQlpOTE1LT5tbS5zaHJpbmtfbWVtb3J5IC09IG9iai0+YmFzZS5z
aXplOwotCQlzcGluX3VubG9jaygmaTkxNS0+bW0ub2JqX2xvY2spOworCisJCXNwaW5fdW5sb2Nr
X2lycXJlc3RvcmUoJmk5MTUtPm1tLm9ial9sb2NrLCBmbGFncyk7CiAJfQogCiAJaWYgKG9iai0+
bW0ubWFwcGluZykgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX3Nocmlua2VyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fc2hyaW5r
ZXIuYwppbmRleCBkNzFlNjMwYzZmYjguLjdhNWYzZGYzZDAxMyAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Nocmlua2VyLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3Nocmlua2VyLmMKQEAgLTEzOCw3ICsxMzgsNyBAQCB1bnNp
Z25lZCBsb25nCiBpOTE1X2dlbV9zaHJpbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
CiAJCXVuc2lnbmVkIGxvbmcgdGFyZ2V0LAogCQl1bnNpZ25lZCBsb25nICpucl9zY2FubmVkLAot
CQl1bnNpZ25lZCBmbGFncykKKwkJdW5zaWduZWQgc2hyaW5rKQogewogCWNvbnN0IHN0cnVjdCB7
CiAJCXN0cnVjdCBsaXN0X2hlYWQgKmxpc3Q7CkBAIC0xNTQsNyArMTU0LDcgQEAgaTkxNV9nZW1f
c2hyaW5rKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCXVuc2lnbmVkIGxvbmcgc2Nh
bm5lZCA9IDA7CiAJYm9vbCB1bmxvY2s7CiAKLQlpZiAoIXNocmlua2VyX2xvY2soaTkxNSwgZmxh
Z3MsICZ1bmxvY2spKQorCWlmICghc2hyaW5rZXJfbG9jayhpOTE1LCBzaHJpbmssICZ1bmxvY2sp
KQogCQlyZXR1cm4gMDsKIAogCS8qCkBAIC0xNjYsMTIgKzE2NiwxMiBAQCBpOTE1X2dlbV9zaHJp
bmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJICogV2UgZG9uJ3QgY2FyZSBhYm91
dCBlcnJvcnMgaGVyZTsgaWYgd2UgY2Fubm90IHdhaXQgdXBvbiB0aGUgR1BVLAogCSAqIHdlIHdp
bGwgZnJlZSBhcyBtdWNoIGFzIHdlIGNhbiBhbmQgaG9wZSB0byBnZXQgYSBzZWNvbmQgY2hhbmNl
LgogCSAqLwotCWlmIChmbGFncyAmIEk5MTVfU0hSSU5LX0FDVElWRSkKKwlpZiAoc2hyaW5rICYg
STkxNV9TSFJJTktfQUNUSVZFKQogCQlpOTE1X2dlbV93YWl0X2Zvcl9pZGxlKGk5MTUsCiAJCQkJ
ICAgICAgIEk5MTVfV0FJVF9MT0NLRUQsCiAJCQkJICAgICAgIE1BWF9TQ0hFRFVMRV9USU1FT1VU
KTsKIAotCXRyYWNlX2k5MTVfZ2VtX3NocmluayhpOTE1LCB0YXJnZXQsIGZsYWdzKTsKKwl0cmFj
ZV9pOTE1X2dlbV9zaHJpbmsoaTkxNSwgdGFyZ2V0LCBzaHJpbmspOwogCWk5MTVfcmV0aXJlX3Jl
cXVlc3RzKGk5MTUpOwogCiAJLyoKQEAgLTE3OSwxMCArMTc5LDEwIEBAIGk5MTVfZ2VtX3Nocmlu
ayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkgKiBkZXZpY2UganVzdCB0byByZWNv
dmVyIGEgbGl0dGxlIG1lbW9yeS4gSWYgYWJzb2x1dGVseSBuZWNlc3NhcnksCiAJICogd2Ugd2ls
bCBmb3JjZSB0aGUgd2FrZSBkdXJpbmcgb29tLW5vdGlmaWVyLgogCSAqLwotCWlmIChmbGFncyAm
IEk5MTVfU0hSSU5LX0JPVU5EKSB7CisJaWYgKHNocmluayAmIEk5MTVfU0hSSU5LX0JPVU5EKSB7
CiAJCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoaTkxNSk7CiAJCWlm
ICghd2FrZXJlZikKLQkJCWZsYWdzICY9IH5JOTE1X1NIUklOS19CT1VORDsKKwkJCXNocmluayAm
PSB+STkxNV9TSFJJTktfQk9VTkQ7CiAJfQogCiAJLyoKQEAgLTIwNyw4ICsyMDcsOSBAQCBpOTE1
X2dlbV9zaHJpbmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJZm9yIChwaGFzZSA9
IHBoYXNlczsgcGhhc2UtPmxpc3Q7IHBoYXNlKyspIHsKIAkJc3RydWN0IGxpc3RfaGVhZCBzdGls
bF9pbl9saXN0OwogCQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOworCQl1bnNpZ25l
ZCBsb25nIGZsYWdzOwogCi0JCWlmICgoZmxhZ3MgJiBwaGFzZS0+Yml0KSA9PSAwKQorCQlpZiAo
KHNocmluayAmIHBoYXNlLT5iaXQpID09IDApCiAJCQljb250aW51ZTsKIAogCQlJTklUX0xJU1Rf
SEVBRCgmc3RpbGxfaW5fbGlzdCk7CkBAIC0yMjAsNTAgKzIyMSw1MCBAQCBpOTE1X2dlbV9zaHJp
bmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCSAqIHRvIGJlIGFibGUgdG8gc2hy
aW5rIHRoZWlyIHBhZ2VzLCBzbyB0aGV5IHJlbWFpbiBvbgogCQkgKiB0aGUgdW5ib3VuZC9ib3Vu
ZCBsaXN0IHVudGlsIGFjdHVhbGx5IGZyZWVkLgogCQkgKi8KLQkJc3Bpbl9sb2NrKCZpOTE1LT5t
bS5vYmpfbG9jayk7CisJCXNwaW5fbG9ja19pcnFzYXZlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxh
Z3MpOwogCQl3aGlsZSAoY291bnQgPCB0YXJnZXQgJiYKIAkJICAgICAgIChvYmogPSBsaXN0X2Zp
cnN0X2VudHJ5X29yX251bGwocGhhc2UtPmxpc3QsCiAJCQkJCQkgICAgICAgdHlwZW9mKCpvYmop
LAogCQkJCQkJICAgICAgIG1tLmxpbmspKSkgewogCQkJbGlzdF9tb3ZlX3RhaWwoJm9iai0+bW0u
bGluaywgJnN0aWxsX2luX2xpc3QpOwogCi0JCQlpZiAoZmxhZ3MgJiBJOTE1X1NIUklOS19WTUFQ
UyAmJgorCQkJaWYgKHNocmluayAmIEk5MTVfU0hSSU5LX1ZNQVBTICYmCiAJCQkgICAgIWlzX3Zt
YWxsb2NfYWRkcihvYmotPm1tLm1hcHBpbmcpKQogCQkJCWNvbnRpbnVlOwogCi0JCQlpZiAoIShm
bGFncyAmIEk5MTVfU0hSSU5LX0FDVElWRSkgJiYKKwkJCWlmICghKHNocmluayAmIEk5MTVfU0hS
SU5LX0FDVElWRSkgJiYKIAkJCSAgICAoaTkxNV9nZW1fb2JqZWN0X2lzX2FjdGl2ZShvYmopIHx8
CiAJCQkgICAgIGk5MTVfZ2VtX29iamVjdF9pc19mcmFtZWJ1ZmZlcihvYmopKSkKIAkJCQljb250
aW51ZTsKIAotCQkJaWYgKCEoZmxhZ3MgJiBJOTE1X1NIUklOS19CT1VORCkgJiYKKwkJCWlmICgh
KHNocmluayAmIEk5MTVfU0hSSU5LX0JPVU5EKSAmJgogCQkJICAgIFJFQURfT05DRShvYmotPmJp
bmRfY291bnQpKQogCQkJCWNvbnRpbnVlOwogCiAJCQlpZiAoIWNhbl9yZWxlYXNlX3BhZ2VzKG9i
aikpCiAJCQkJY29udGludWU7CiAKLQkJCXNwaW5fdW5sb2NrKCZpOTE1LT5tbS5vYmpfbG9jayk7
CisJCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwog
CiAJCQlpZiAodW5zYWZlX2Ryb3BfcGFnZXMob2JqKSkgewogCQkJCS8qIE1heSBhcnJpdmUgZnJv
bSBnZXRfcGFnZXMgb24gYW5vdGhlciBibyAqLwogCQkJCW11dGV4X2xvY2tfbmVzdGVkKCZvYmot
Pm1tLmxvY2ssCiAJCQkJCQkgIEk5MTVfTU1fU0hSSU5LRVIpOwogCQkJCWlmICghaTkxNV9nZW1f
b2JqZWN0X2hhc19wYWdlcyhvYmopKSB7Ci0JCQkJCXRyeV90b193cml0ZWJhY2sob2JqLCBmbGFn
cyk7CisJCQkJCXRyeV90b193cml0ZWJhY2sob2JqLCBzaHJpbmspOwogCQkJCQljb3VudCArPSBv
YmotPmJhc2Uuc2l6ZSA+PiBQQUdFX1NISUZUOwogCQkJCX0KIAkJCQltdXRleF91bmxvY2soJm9i
ai0+bW0ubG9jayk7CiAJCQl9CiAJCQlzY2FubmVkICs9IG9iai0+YmFzZS5zaXplID4+IFBBR0Vf
U0hJRlQ7CiAKLQkJCXNwaW5fbG9jaygmaTkxNS0+bW0ub2JqX2xvY2spOworCQkJc3Bpbl9sb2Nr
X2lycXNhdmUoJmk5MTUtPm1tLm9ial9sb2NrLCBmbGFncyk7CiAJCX0KIAkJbGlzdF9zcGxpY2Vf
dGFpbCgmc3RpbGxfaW5fbGlzdCwgcGhhc2UtPmxpc3QpOwotCQlzcGluX3VubG9jaygmaTkxNS0+
bW0ub2JqX2xvY2spOworCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9j
aywgZmxhZ3MpOwogCX0KIAotCWlmIChmbGFncyAmIEk5MTVfU0hSSU5LX0JPVU5EKQorCWlmIChz
aHJpbmsgJiBJOTE1X1NIUklOS19CT1VORCkKIAkJaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwg
d2FrZXJlZik7CiAKIAlpOTE1X3JldGlyZV9yZXF1ZXN0cyhpOTE1KTsKQEAgLTM3OSw2ICszODAs
NyBAQCBpOTE1X2dlbV9zaHJpbmtlcl9vb20oc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpuYiwgdW5z
aWduZWQgbG9uZyBldmVudCwgdm9pZCAqcHRyKQogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmo7CiAJdW5zaWduZWQgbG9uZyB1bmV2aWN0YWJsZSwgYm91bmQsIHVuYm91bmQsIGZyZWVk
X3BhZ2VzOwogCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7
CiAKIAlmcmVlZF9wYWdlcyA9IDA7CiAJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGk5MTUsIHdha2Vy
ZWYpCkBAIC0zOTIsNyArMzk0LDcgQEAgaTkxNV9nZW1fc2hyaW5rZXJfb29tKHN0cnVjdCBub3Rp
Zmllcl9ibG9jayAqbmIsIHVuc2lnbmVkIGxvbmcgZXZlbnQsIHZvaWQgKnB0cikKIAkgKiBiZWlu
ZyBwb2ludGVkIHRvIGJ5IGhhcmR3YXJlLgogCSAqLwogCXVuYm91bmQgPSBib3VuZCA9IHVuZXZp
Y3RhYmxlID0gMDsKLQlzcGluX2xvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKKwlzcGluX2xvY2tf
aXJxc2F2ZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5
KG9iaiwgJmk5MTUtPm1tLnVuYm91bmRfbGlzdCwgbW0ubGluaykgewogCQlpZiAoIWNhbl9yZWxl
YXNlX3BhZ2VzKG9iaikpCiAJCQl1bmV2aWN0YWJsZSArPSBvYmotPmJhc2Uuc2l6ZSA+PiBQQUdF
X1NISUZUOwpAQCAtNDA1LDcgKzQwNyw3IEBAIGk5MTVfZ2VtX3Nocmlua2VyX29vbShzdHJ1Y3Qg
bm90aWZpZXJfYmxvY2sgKm5iLCB1bnNpZ25lZCBsb25nIGV2ZW50LCB2b2lkICpwdHIpCiAJCWVs
c2UKIAkJCWJvdW5kICs9IG9iai0+YmFzZS5zaXplID4+IFBBR0VfU0hJRlQ7CiAJfQotCXNwaW5f
dW5sb2NrKCZpOTE1LT5tbS5vYmpfbG9jayk7CisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkx
NS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKIAogCWlmIChmcmVlZF9wYWdlcyB8fCB1bmJvdW5kIHx8
IGJvdW5kKQogCQlwcl9pbmZvKCJQdXJnaW5nIEdQVSBtZW1vcnksICVsdSBwYWdlcyBmcmVlZCwg
IgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3N0b2xlbi5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3N0b2xlbi5jCmluZGV4IDg0ZDRm
NTQ5ZWIyMS4uZjE5MGVjMjM2YThlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fc3RvbGVuLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX3N0b2xlbi5jCkBAIC02MTMsNiArNjEzLDcgQEAgaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9z
dG9sZW5fZm9yX3ByZWFsbG9jYXRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYK
IAlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwogCXN0cnVjdCBkcm1fbW1fbm9kZSAq
c3RvbGVuOwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAJ
aW50IHJldDsKIAogCWlmICghZHJtX21tX2luaXRpYWxpemVkKCZkZXZfcHJpdi0+bW0uc3RvbGVu
KSkKQEAgLTY4OSwxMCArNjkwLDEwIEBAIGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfc3RvbGVuX2Zv
cl9wcmVhbGxvY2F0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2CiAJbGlzdF9t
b3ZlX3RhaWwoJnZtYS0+dm1fbGluaywgJmdndHQtPnZtLmJvdW5kX2xpc3QpOwogCW11dGV4X3Vu
bG9jaygmZ2d0dC0+dm0ubXV0ZXgpOwogCi0Jc3Bpbl9sb2NrKCZkZXZfcHJpdi0+bW0ub2JqX2xv
Y2spOworCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+bW0ub2JqX2xvY2ssIGZsYWdzKTsK
IAlHRU1fQlVHX09OKGk5MTVfZ2VtX29iamVjdF9pc19zaHJpbmthYmxlKG9iaikpOwogCW9iai0+
YmluZF9jb3VudCsrOwotCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+bW0ub2JqX2xvY2spOworCXNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwogCiAJ
cmV0dXJuIG9iajsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1
Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2RlYnVnZnMuYwppbmRleCBmMjEyMjQx
YTI3NTguLjJlNzlmMGU0YzVhZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kZWJ1Z2ZzLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKQEAg
LTI2OSw2ICsyNjksNyBAQCBzdGF0aWMgaW50IGk5MTVfZ2VtX3N0b2xlbl9saXN0X2luZm8oc3Ry
dWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRhKQogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmo7CiAJdTY0IHRvdGFsX29ial9zaXplLCB0b3RhbF9ndHRfc2l6ZTsKIAl1bnNpZ25lZCBs
b25nIHRvdGFsLCBjb3VudCwgbjsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOwogCWludCByZXQ7CiAK
IAl0b3RhbCA9IFJFQURfT05DRShkZXZfcHJpdi0+bW0uc2hyaW5rX2NvdW50KTsKQEAgLTI4Miw3
ICsyODMsNyBAQCBzdGF0aWMgaW50IGk5MTVfZ2VtX3N0b2xlbl9saXN0X2luZm8oc3RydWN0IHNl
cV9maWxlICptLCB2b2lkICpkYXRhKQogCiAJdG90YWxfb2JqX3NpemUgPSB0b3RhbF9ndHRfc2l6
ZSA9IGNvdW50ID0gMDsKIAotCXNwaW5fbG9jaygmZGV2X3ByaXYtPm1tLm9ial9sb2NrKTsKKwlz
cGluX2xvY2tfaXJxc2F2ZSgmZGV2X3ByaXYtPm1tLm9ial9sb2NrLCBmbGFncyk7CiAJbGlzdF9m
b3JfZWFjaF9lbnRyeShvYmosICZkZXZfcHJpdi0+bW0uYm91bmRfbGlzdCwgbW0ubGluaykgewog
CQlpZiAoY291bnQgPT0gdG90YWwpCiAJCQlicmVhazsKQEAgLTMwNSw3ICszMDYsNyBAQCBzdGF0
aWMgaW50IGk5MTVfZ2VtX3N0b2xlbl9saXN0X2luZm8oc3RydWN0IHNlcV9maWxlICptLCB2b2lk
ICpkYXRhKQogCQlvYmplY3RzW2NvdW50KytdID0gb2JqOwogCQl0b3RhbF9vYmpfc2l6ZSArPSBv
YmotPmJhc2Uuc2l6ZTsKIAl9Ci0Jc3Bpbl91bmxvY2soJmRldl9wcml2LT5tbS5vYmpfbG9jayk7
CisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPm1tLm9ial9sb2NrLCBmbGFncyk7
CiAKIAlzb3J0KG9iamVjdHMsIGNvdW50LCBzaXplb2YoKm9iamVjdHMpLCBvYmpfcmFua19ieV9z
dG9sZW4sIE5VTEwpOwogCkBAIC00NTcsNiArNDU4LDcgQEAgc3RhdGljIGludCBpOTE1X2dlbV9v
YmplY3RfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJdTY0IHNpemUsIG1h
cHBlZF9zaXplLCBwdXJnZWFibGVfc2l6ZSwgZHB5X3NpemUsIGh1Z2Vfc2l6ZTsKIAlzdHJ1Y3Qg
ZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwogCXVuc2lnbmVkIGludCBwYWdlX3NpemVzID0gMDsK
Kwl1bnNpZ25lZCBsb25nIGZsYWdzOwogCWNoYXIgYnVmWzgwXTsKIAlpbnQgcmV0OwogCkBAIC00
NjksNyArNDcxLDcgQEAgc3RhdGljIGludCBpOTE1X2dlbV9vYmplY3RfaW5mbyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAJcHVyZ2VhYmxlX3NpemUgPSBwdXJnZWFibGVfY291bnQg
PSAwOwogCWh1Z2Vfc2l6ZSA9IGh1Z2VfY291bnQgPSAwOwogCi0Jc3Bpbl9sb2NrKCZkZXZfcHJp
di0+bW0ub2JqX2xvY2spOworCXNwaW5fbG9ja19pcnFzYXZlKCZkZXZfcHJpdi0+bW0ub2JqX2xv
Y2ssIGZsYWdzKTsKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KG9iaiwgJmRldl9wcml2LT5tbS51bmJv
dW5kX2xpc3QsIG1tLmxpbmspIHsKIAkJc2l6ZSArPSBvYmotPmJhc2Uuc2l6ZTsKIAkJKytjb3Vu
dDsKQEAgLTUxOCw3ICs1MjAsNyBAQCBzdGF0aWMgaW50IGk5MTVfZ2VtX29iamVjdF9pbmZvKHN0
cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkKIAkJCXBhZ2Vfc2l6ZXMgfD0gb2JqLT5tbS5w
YWdlX3NpemVzLnNnOwogCQl9CiAJfQotCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+bW0ub2JqX2xv
Y2spOworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldl9wcml2LT5tbS5vYmpfbG9jaywgZmxh
Z3MpOwogCiAJc2VxX3ByaW50ZihtLCAiJXUgYm91bmQgb2JqZWN0cywgJWxsdSBieXRlc1xuIiwK
IAkJICAgY291bnQsIHNpemUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKaW5kZXggOWYyZTIxM2M2
MDQ2Li5lOTgwYzFlZTNkY2YgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
Z2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwpAQCAtMTEzOCw3ICsx
MTM4LDEwIEBAIGk5MTVfZ2VtX21hZHZpc2VfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwg
dm9pZCAqZGF0YSwKIAkJc3RydWN0IGxpc3RfaGVhZCAqbGlzdDsKIAogCQlpZiAoaTkxNV9nZW1f
b2JqZWN0X2lzX3Nocmlua2FibGUob2JqKSkgewotCQkJc3Bpbl9sb2NrKCZpOTE1LT5tbS5vYmpf
bG9jayk7CisJCQl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJCQlzcGluX2xvY2tfaXJxc2F2ZSgm
aTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKKwogCQkJaWYgKG9iai0+bW0ubWFkdiAhPSBJOTE1
X01BRFZfV0lMTE5FRUQpCiAJCQkJbGlzdCA9ICZpOTE1LT5tbS5wdXJnZV9saXN0OwogCQkJZWxz
ZSBpZiAob2JqLT5iaW5kX2NvdW50KQpAQCAtMTE0Niw3ICsxMTQ5LDggQEAgaTkxNV9nZW1fbWFk
dmlzZV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJZWxzZQog
CQkJCWxpc3QgPSAmaTkxNS0+bW0udW5ib3VuZF9saXN0OwogCQkJbGlzdF9tb3ZlX3RhaWwoJm9i
ai0+bW0ubGluaywgbGlzdCk7Ci0JCQlzcGluX3VubG9jaygmaTkxNS0+bW0ub2JqX2xvY2spOwor
CisJCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwog
CQl9CiAJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYwppbmRleCBmNmFjODM5NGRhNzcuLjgwMDUw
ZjZhMDg5MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCkBAIC04MCwxMSArODAsMTQgQEAgc3Rh
dGljIHZvaWQgdm1hX3ByaW50X2FsbG9jYXRvcihzdHJ1Y3QgaTkxNV92bWEgKnZtYSwgY29uc3Qg
Y2hhciAqcmVhc29uKQogc3RhdGljIHZvaWQgb2JqX2J1bXBfbXJ1KHN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmopCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19p
OTE1KG9iai0+YmFzZS5kZXYpOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlzcGluX2xvY2tf
aXJxc2F2ZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsKIAotCXNwaW5fbG9jaygmaTkxNS0+
bW0ub2JqX2xvY2spOwogCWlmIChvYmotPmJpbmRfY291bnQpCiAJCWxpc3RfbW92ZV90YWlsKCZv
YmotPm1tLmxpbmssICZpOTE1LT5tbS5ib3VuZF9saXN0KTsKLQlzcGluX3VubG9jaygmaTkxNS0+
bW0ub2JqX2xvY2spOworCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+bW0ub2JqX2xv
Y2ssIGZsYWdzKTsKIAogCW9iai0+bW0uZGlydHkgPSB0cnVlOyAvKiBiZSBwYXJhbm9pZCAgKi8K
IH0KQEAgLTY3OCw4ICs2ODEsOSBAQCBpOTE1X3ZtYV9pbnNlcnQoc3RydWN0IGk5MTVfdm1hICp2
bWEsIHU2NCBzaXplLCB1NjQgYWxpZ25tZW50LCB1NjQgZmxhZ3MpCiAKIAlpZiAodm1hLT5vYmop
IHsKIAkJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IHZtYS0+b2JqOworCQl1bnNp
Z25lZCBsb25nIGZsYWdzOwogCi0JCXNwaW5fbG9jaygmZGV2X3ByaXYtPm1tLm9ial9sb2NrKTsK
KwkJc3Bpbl9sb2NrX2lycXNhdmUoJmRldl9wcml2LT5tbS5vYmpfbG9jaywgZmxhZ3MpOwogCiAJ
CWlmIChpOTE1X2dlbV9vYmplY3RfaXNfc2hyaW5rYWJsZShvYmopKQogCQkJbGlzdF9tb3ZlX3Rh
aWwoJm9iai0+bW0ubGluaywgJmRldl9wcml2LT5tbS5ib3VuZF9saXN0KTsKQEAgLTY4Nyw3ICs2
OTEsNyBAQCBpOTE1X3ZtYV9pbnNlcnQoc3RydWN0IGk5MTVfdm1hICp2bWEsIHU2NCBzaXplLCB1
NjQgYWxpZ25tZW50LCB1NjQgZmxhZ3MpCiAJCW9iai0+YmluZF9jb3VudCsrOwogCQlhc3NlcnRf
YmluZF9jb3VudChvYmopOwogCi0JCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+bW0ub2JqX2xvY2sp
OworCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXZfcHJpdi0+bW0ub2JqX2xvY2ssIGZsYWdz
KTsKIAl9CiAKIAlyZXR1cm4gMDsKQEAgLTcyMSw4ICs3MjUsOSBAQCBpOTE1X3ZtYV9yZW1vdmUo
c3RydWN0IGk5MTVfdm1hICp2bWEpCiAJICovCiAJaWYgKHZtYS0+b2JqKSB7CiAJCXN0cnVjdCBk
cm1faTkxNV9nZW1fb2JqZWN0ICpvYmogPSB2bWEtPm9iajsKKwkJdW5zaWduZWQgbG9uZyBmbGFn
czsKIAotCQlzcGluX2xvY2soJmk5MTUtPm1tLm9ial9sb2NrKTsKKwkJc3Bpbl9sb2NrX2lycXNh
dmUoJmk5MTUtPm1tLm9ial9sb2NrLCBmbGFncyk7CiAKIAkJR0VNX0JVR19PTihvYmotPmJpbmRf
Y291bnQgPT0gMCk7CiAJCWlmICgtLW9iai0+YmluZF9jb3VudCA9PSAwICYmCkBAIC03MzAsNyAr
NzM1LDcgQEAgaTkxNV92bWFfcmVtb3ZlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogCQkgICAgb2Jq
LT5tbS5tYWR2ID09IEk5MTVfTUFEVl9XSUxMTkVFRCkKIAkJCWxpc3RfbW92ZV90YWlsKCZvYmot
Pm1tLmxpbmssICZpOTE1LT5tbS51bmJvdW5kX2xpc3QpOwogCi0JCXNwaW5fdW5sb2NrKCZpOTE1
LT5tbS5vYmpfbG9jayk7CisJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmk5MTUtPm1tLm9ial9s
b2NrLCBmbGFncyk7CiAKIAkJLyoKIAkJICogQW5kIGZpbmFsbHkgbm93IHRoZSBvYmplY3QgaXMg
Y29tcGxldGVseSBkZWNvdXBsZWQgZnJvbSB0aGlzCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QK
SW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id C32CC58DEE
	for <lists+intel-gfx@lfdr.de>; Fri, 28 Jun 2019 00:28:16 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 849D26E84B;
	Thu, 27 Jun 2019 22:28:14 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id F049E6E848
 for <intel-gfx@lists.freedesktop.org>; Thu, 27 Jun 2019 22:28:12 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from localhost (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP (TLS) id
 17050457-1500050 for multiple; Thu, 27 Jun 2019 23:28:08 +0100
MIME-Version: 1.0
From: Chris Wilson <chris@chris-wilson.co.uk>
User-Agent: alot/0.6
To: Matthew Auld <matthew.auld@intel.com>, intel-gfx@lists.freedesktop.org
References: <20190627205633.1143-1-matthew.auld@intel.com>
 <20190627205633.1143-2-matthew.auld@intel.com>
In-Reply-To: <20190627205633.1143-2-matthew.auld@intel.com>
Message-ID: <156167448623.21507.18132879618504408888@skylake-alporthouse-com>
Date: Thu, 27 Jun 2019 23:28:06 +0100
Subject: Re: [Intel-gfx] [PATCH v2 01/37] drm/i915: buddy allocator
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVvdGluZyBNYXR0aGV3IEF1bGQgKDIwMTktMDYtMjcgMjE6NTU6NTcpCj4gU2ltcGxlIGJ1ZGR5
IGFsbG9jYXRvci4gV2Ugd2FudCB0byBhbGxvY2F0ZSBwcm9wZXJseSBhbGlnbmVkCj4gcG93ZXIt
b2YtdHdvIGJsb2NrcyB0byBwcm9tb3RlIHVzYWdlIG9mIGh1Z2UtcGFnZXMgZm9yIHRoZSBHVFQs
IHNvIDY0SywKPiAyTSBhbmQgcG9zc2libHkgZXZlbiAxRy4gV2hpbGUgd2UgZG8gc3VwcG9ydCBh
bGxvY2F0aW5nIHN0dWZmIGF0IGEKPiBzcGVjaWZpYyBvZmZzZXQsIGl0IGlzIG1vcmUgaW50ZW5k
ZWQgZm9yIHByZWFsbG9jYXRpbmcgcG9ydGlvbnMgb2YgdGhlCj4gYWRkcmVzcyBzcGFjZSwgc2F5
IGZvciBhbiBpbml0aWFsIGZyYW1lYnVmZmVyLCBmb3Igb3RoZXIgdXNlcyBkcm1fbW0gaXMKPiBw
cm9iYWJseSBhIG11Y2ggYmV0dGVyIGZpdC4gQW55d2F5LCBob3BlZnVsbHkgdGhpcyBjYW4gYWxs
IGJlIHRocm93bgo+IGF3YXkgaWYgd2UgZXZlbnR1YWxseSBtb3ZlIHRvIGhhdmluZyB0aGUgY29y
ZSBNTSBtYW5hZ2UgZGV2aWNlIG1lbW9yeS4KClllYWgsIEkgc3RpbGwgaGF2ZSBubyBpZGVhIHdo
eSBkcm1fbW0gZG9lc24ndCBzdWZmaWNlLgoKVGhlIGFkdmFudGFnZSBvZiBkcm1fbW1fbm9kZSBi
ZWluZyBlbWJlZGRlZCBhbmQgbm9uLWFsbG9jYXRpbmcgaXMgc3RpbGwKcHJlc2VudCwgYnV0IGRy
bV9tbV9ub2RlIGhhcyB0aGUgZGlzYWR2YW50YWdlIG9mIGhhdmluZyBncm93biB0bwphY2NvbW1v
ZGF0ZSBtdWx0aXBsZSBwcmltYXJ5IGtleXMuCgpBIGJpdCBtb3JlIG9mIGEgZGV0YWlsZWQgZGlz
Y3Vzc2lvbiBvbiB0aGUgc2hvcnRjb21pbmdzLCBhbmQKbWVhc3VyZW1lbnRzIGZvciB3aHkgd2Ug
c2hvdWxkIHVzZSBhbiBpbnRyaW5zaWNhbGx5IGFsaWduZWQgYWxsb2NhdG9yCm92ZXIgYW4gYWxs
b2NhdG9yIHRoYXQgYWxsb3dzIGFyYml0cmFyeSBhbGlnbm1lbnRzLiBUaGUgb2J2aW91cyBvbmUK
YmVpbmcgYWxsb2NhdGlvbiBzcGVlZCBmb3IgPmNodW5rX3NpemUgYWxsb2NhdGlvbnMsIGJ1dCBu
dW1iZXJzIDopCkFuZCBqdXN0IGhvdyBmcmVxdWVudGx5IGRvZXMgaXQgbWF0dGVyPwoKVGhlIG1h
am9yIGRvd25zaWRlIGlzIHRoZSBmcmFnbWVudGF0aW9uIHBlbmFsdHkuIFRoYXQgYWxzbyBuZWVk
cwpkaXNjdXNzaW9uLiAoVGhpbmsgb2YgdGhlIGpveXMgb2Yga2NvbXBhY3RkIGFuZCBrbWlncmF0
ZWQuKQoKVGhhdCBkaXNjdXNzaW9uIHNob3VsZCBhbHNvIGJlIG1pcnJvcmVkIGluIGEgdGhlb3J5
IG9mIG9wZXJhdGlvbgpkb2N1bWVudGF0aW9uLgogCj4gU2lnbmVkLW9mZi1ieTogTWF0dGhldyBB
dWxkIDxtYXR0aGV3LmF1bGRAaW50ZWwuY29tPgo+IC0tLQo+ICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9NYWtlZmlsZSAgICAgICAgICAgICAgICAgfCAgIDEgKwo+ICBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2J1ZGR5LmMgICAgICAgICAgICAgfCA0MTMgKysrKysrKysrKysrKysrCj4gIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfYnVkZHkuaCAgICAgICAgICAgICB8IDExNSArKysrCj4gIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2J1ZGR5LmMgICB8IDQ5MSArKysrKysr
KysrKysrKysrKysKPiAgLi4uL2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X21vY2tfc2VsZnRlc3Rz
LmggIHwgICAxICsKPiAgNSBmaWxlcyBjaGFuZ2VkLCAxMDIxIGluc2VydGlvbnMoKykKPiAgY3Jl
YXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYnVkZHkuYwo+ICBjcmVh
dGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9idWRkeS5oCj4gIGNyZWF0
ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9idWRkeS5j
Cj4gCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKPiBpbmRleCAzYmQ4ZjAzNDlhOGEuLmNiNjZjZjFhNWEx
MCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQo+ICsrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCj4gQEAgLTExNyw2ICsxMTcsNyBAQCBnZW0teSAr
PSBcCj4gIGk5MTUteSArPSBcCj4gICAgICAgICAgICQoZ2VtLXkpIFwKPiAgICAgICAgICAgaTkx
NV9hY3RpdmUubyBcCj4gKyAgICAgICAgIGk5MTVfYnVkZHkubyBcCj4gICAgICAgICAgIGk5MTVf
Y21kX3BhcnNlci5vIFwKPiAgICAgICAgICAgaTkxNV9nZW1fYmF0Y2hfcG9vbC5vIFwKPiAgICAg
ICAgICAgaTkxNV9nZW1fZXZpY3QubyBcCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfYnVkZHkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYnVkZHkuYwo+IG5l
dyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMDAwMDAwLi5jMGFjNjhkNzFkOTQKPiAt
LS0gL2Rldi9udWxsCj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9idWRkeS5jCj4g
QEAgLTAsMCArMSw0MTMgQEAKPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAo+ICsv
Kgo+ICsgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgo+ICsgKi8KPiArCj4g
KyNpbmNsdWRlIDxsaW51eC9zbGFiLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9saXN0Lmg+Cj4gKwo+
ICsjaW5jbHVkZSAiaTkxNV9idWRkeS5oIgo+ICsKPiArI2luY2x1ZGUgImk5MTVfZ2VtLmgiCj4g
KyNpbmNsdWRlICJpOTE1X3V0aWxzLmgiCj4gKwo+ICtzdGF0aWMgdm9pZCBtYXJrX2FsbG9jYXRl
ZChzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAqYmxvY2spCj4gK3sKPiArICAgICAgIGJsb2NrLT5o
ZWFkZXIgJj0gfkk5MTVfQlVERFlfSEVBREVSX1NUQVRFOwo+ICsgICAgICAgYmxvY2stPmhlYWRl
ciB8PSBJOTE1X0JVRERZX0FMTE9DQVRFRDsKPiArCj4gKyAgICAgICBsaXN0X2RlbF9pbml0KCZi
bG9jay0+bGluayk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIG1hcmtfZnJlZShzdHJ1Y3QgaTkx
NV9idWRkeV9tbSAqbW0sCj4gKyAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBpOTE1X2J1ZGR5
X2Jsb2NrICpibG9jaykKPiArewo+ICsgICAgICAgYmxvY2stPmhlYWRlciAmPSB+STkxNV9CVURE
WV9IRUFERVJfU1RBVEU7Cj4gKyAgICAgICBibG9jay0+aGVhZGVyIHw9IEk5MTVfQlVERFlfRlJF
RTsKPiArCj4gKyAgICAgICBsaXN0X2FkZCgmYmxvY2stPmxpbmssCj4gKyAgICAgICAgICAgICAg
ICAmbW0tPmZyZWVfbGlzdFtpOTE1X2J1ZGR5X2Jsb2NrX29yZGVyKGJsb2NrKV0pOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgdm9pZCBtYXJrX3NwbGl0KHN0cnVjdCBpOTE1X2J1ZGR5X2Jsb2NrICpibG9j
aykKPiArewo+ICsgICAgICAgYmxvY2stPmhlYWRlciAmPSB+STkxNV9CVUREWV9IRUFERVJfU1RB
VEU7Cj4gKyAgICAgICBibG9jay0+aGVhZGVyIHw9IEk5MTVfQlVERFlfU1BMSVQ7Cj4gKwo+ICsg
ICAgICAgbGlzdF9kZWxfaW5pdCgmYmxvY2stPmxpbmspOwo+ICt9Cj4gKwo+ICtpbnQgaTkxNV9i
dWRkeV9pbml0KHN0cnVjdCBpOTE1X2J1ZGR5X21tICptbSwgdTY0IHNpemUsIHU2NCBtaW5fc2l6
ZSkKPiArewo+ICsgICAgICAgdW5zaWduZWQgaW50IGk7Cj4gKyAgICAgICB1NjQgb2Zmc2V0Owo+
ICsKPiArICAgICAgIGlmIChzaXplIDwgbWluX3NpemUpCj4gKyAgICAgICAgICAgICAgIHJldHVy
biAtRUlOVkFMOwo+ICsKPiArICAgICAgIGlmIChtaW5fc2l6ZSA8IFBBR0VfU0laRSkKPiArICAg
ICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsgICAgICAgaWYgKCFpc19wb3dlcl9v
Zl8yKG1pbl9zaXplKSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsg
ICAgICAgc2l6ZSA9IHJvdW5kX2Rvd24oc2l6ZSwgbWluX3NpemUpOwo+ICsKPiArICAgICAgIG1t
LT5zaXplID0gc2l6ZTsKPiArICAgICAgIG1tLT5taW5fc2l6ZSA9IG1pbl9zaXplOwo+ICsgICAg
ICAgbW0tPm1heF9vcmRlciA9IGlsb2cyKHJvdW5kZG93bl9wb3dfb2ZfdHdvKHNpemUpKSAtIGls
b2cyKG1pbl9zaXplKTsKCmlsb2cyKHJvdW5kZG93bl9wb3dfb2ZfdHdvKHNpemUpKSBpcyBpbG9n
MihzaXplKQoKcm91bmRkb3duX3Bvd19vZl90d28oc2l6ZSk6IDEgPDwgaWxvZzIoc2l6ZSkKc28g
eW91IGFyZSBzYXlpbmcgaWxvZzIoMSA8PCBpbG9nMihzaXplKSkKCmZ3aXcsIEkgc3RpbGwgdGhp
bmsgb2YgbWluX3NpemUgYXMgbWluX2NodW5rX3NpemUgKG9yIGp1c3QgY2h1bmtfc2l6ZSkuCgo+
ICsKPiArICAgICAgIEdFTV9CVUdfT04obW0tPm1heF9vcmRlciA+IEk5MTVfQlVERFlfTUFYX09S
REVSKTsKPiArCj4gKyAgICAgICBtbS0+ZnJlZV9saXN0ID0ga21hbGxvY19hcnJheShtbS0+bWF4
X29yZGVyICsgMSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVv
ZihzdHJ1Y3QgbGlzdF9oZWFkKSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIEdGUF9LRVJORUwpOwo+ICsgICAgICAgaWYgKCFtbS0+ZnJlZV9saXN0KQo+ICsgICAgICAg
ICAgICAgICByZXR1cm4gLUVOT01FTTsKPiArCj4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDw9IG1t
LT5tYXhfb3JkZXI7ICsraSkKPiArICAgICAgICAgICAgICAgSU5JVF9MSVNUX0hFQUQoJm1tLT5m
cmVlX2xpc3RbaV0pOwo+ICsKPiArICAgICAgIG1tLT5ibG9ja3MgPSBLTUVNX0NBQ0hFKGk5MTVf
YnVkZHlfYmxvY2ssIFNMQUJfSFdDQUNIRV9BTElHTik7Cj4gKyAgICAgICBpZiAoIW1tLT5ibG9j
a3MpCj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0X2ZyZWVfbGlzdDsKCldvdWxkIG5vdCBvbmUg
Z2xvYmFsIHNsYWIgY2FjaGUgd2lsbCBzdWZmaWNlPyBXZSB3b3VsZCBoYXZlIGJldHRlcgpyZXVz
ZSwgaWYgdGhlIGtlcm5lbCBoYXNuJ3QgZGVjaWRlZCB0byBtZXJnZSBzbGFiIGNhY2hlcy4KCj4g
KyAgICAgICBtbS0+bl9yb290cyA9IGh3ZWlnaHQ2NChzaXplKTsKPiArCj4gKyAgICAgICBtbS0+
cm9vdHMgPSBrbWFsbG9jX2FycmF5KG1tLT5uX3Jvb3RzLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzaXplb2Yoc3RydWN0IGk5MTVfYnVkZHlfYmxvY2sgKiksCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdGUF9LRVJORUwpOwo+ICsgICAgICAgaWYgKCFt
bS0+cm9vdHMpCj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0X2ZyZWVfYmxvY2tzOwo+ICsKPiAr
ICAgICAgIG9mZnNldCA9IDA7Cj4gKyAgICAgICBpID0gMDsKPiArCj4gKyAgICAgICAvKgo+ICsg
ICAgICAgICogU3BsaXQgaW50byBwb3dlci1vZi10d28gYmxvY2tzLCBpbiBjYXNlIHdlIGFyZSBn
aXZlbiBhIHNpemUgdGhhdCBpcwo+ICsgICAgICAgICogbm90IGl0c2VsZiBhIHBvd2VyLW9mLXR3
by4KPiArICAgICAgICAqLwo+ICsgICAgICAgZG8gewo+ICsgICAgICAgICAgICAgICBzdHJ1Y3Qg
aTkxNV9idWRkeV9ibG9jayAqcm9vdDsKPiArICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG9y
ZGVyOwo+ICsgICAgICAgICAgICAgICB1NjQgcm9vdF9zaXplOwo+ICsKPiArICAgICAgICAgICAg
ICAgcm9vdCA9IGttZW1fY2FjaGVfemFsbG9jKG1tLT5ibG9ja3MsIEdGUF9LRVJORUwpOwo+ICsg
ICAgICAgICAgICAgICBpZiAoIXJvb3QpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgZ290byBv
dXRfZnJlZV9yb290czsKPiArCj4gKyAgICAgICAgICAgICAgIHJvb3Rfc2l6ZSA9IHJvdW5kZG93
bl9wb3dfb2ZfdHdvKHNpemUpOwo+ICsgICAgICAgICAgICAgICBvcmRlciA9IGlsb2cyKHJvb3Rf
c2l6ZSkgLSBpbG9nMihtaW5fc2l6ZSk7Cj4gKwo+ICsgICAgICAgICAgICAgICByb290LT5oZWFk
ZXIgPSBvZmZzZXQ7Cj4gKyAgICAgICAgICAgICAgIHJvb3QtPmhlYWRlciB8PSBvcmRlcjsKPiAr
Cj4gKyAgICAgICAgICAgICAgIG1hcmtfZnJlZShtbSwgcm9vdCk7Cj4gKwo+ICsgICAgICAgICAg
ICAgICBHRU1fQlVHX09OKGkgPiBtbS0+bWF4X29yZGVyKTsKPiArICAgICAgICAgICAgICAgR0VN
X0JVR19PTihpOTE1X2J1ZGR5X2Jsb2NrX3NpemUobW0sIHJvb3QpIDwgbWluX3NpemUpOwo+ICsK
PiArICAgICAgICAgICAgICAgbW0tPnJvb3RzW2ldID0gcm9vdDsKPiArCj4gKyAgICAgICAgICAg
ICAgIG9mZnNldCArPSByb290X3NpemU7Cj4gKyAgICAgICAgICAgICAgIHNpemUgLT0gcm9vdF9z
aXplOwo+ICsgICAgICAgICAgICAgICBpKys7Cj4gKyAgICAgICB9IHdoaWxlIChzaXplKTsKPiAr
Cj4gKyAgICAgICByZXR1cm4gMDsKPiArCj4gK291dF9mcmVlX3Jvb3RzOgo+ICsgICAgICAgd2hp
bGUgKGktLSkKPiArICAgICAgICAgICAgICAga21lbV9jYWNoZV9mcmVlKG1tLT5ibG9ja3MsIG1t
LT5yb290c1tpXSk7Cj4gKyAgICAgICBrZnJlZShtbS0+cm9vdHMpOwo+ICtvdXRfZnJlZV9ibG9j
a3M6Cj4gKyAgICAgICBrbWVtX2NhY2hlX2Rlc3Ryb3kobW0tPmJsb2Nrcyk7Cj4gK291dF9mcmVl
X2xpc3Q6Cj4gKyAgICAgICBrZnJlZShtbS0+ZnJlZV9saXN0KTsKPiArICAgICAgIHJldHVybiAt
RU5PTUVNOwo+ICt9Cj4gKwo+ICt2b2lkIGk5MTVfYnVkZHlfZmluaShzdHJ1Y3QgaTkxNV9idWRk
eV9tbSAqbW0pCj4gK3sKPiArICAgICAgIGludCBlcnIgPSAwOwo+ICsgICAgICAgaW50IGk7Cj4g
Kwo+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IG1tLT5uX3Jvb3RzOyArK2kpIHsKPiArICAgICAg
ICAgICAgICAgaWYgKCFpOTE1X2J1ZGR5X2Jsb2NrX2ZyZWUobW0tPnJvb3RzW2ldKSkgewo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGVyciA9IC1FQlVTWTsKPiArICAgICAgICAgICAgICAgICAg
ICAgICBjb250aW51ZTsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAgICAg
a21lbV9jYWNoZV9mcmVlKG1tLT5ibG9ja3MsIG1tLT5yb290c1tpXSk7Cj4gKyAgICAgICB9Cj4g
Kwo+ICsgICAgICAgLyoKPiArICAgICAgICAqIFhYWDogUmF0aGVyIGxlYWsgbWVtb3J5IGZvciBu
b3csIHRoYW4gaGl0IGEgcG90ZW50aWFsIHVzZXItYWZ0ZXItZnJlZQo+ICsgICAgICAgICovCgpC
dWcgYnVnIGJ1ZyBlc3QgZXN0LgoKPiArICAgICAgIGlmIChXQVJOX09OKGVycikpCj4gKyAgICAg
ICAgICAgICAgIHJldHVybjsKPiArCj4gKyAgICAgICBrZnJlZShtbS0+cm9vdHMpOwo+ICsgICAg
ICAga2ZyZWUobW0tPmZyZWVfbGlzdCk7Cj4gKyAgICAgICBrbWVtX2NhY2hlX2Rlc3Ryb3kobW0t
PmJsb2Nrcyk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgc3BsaXRfYmxvY2soc3RydWN0IGk5MTVf
YnVkZHlfbW0gKm1tLAo+ICsgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfYnVkZHlf
YmxvY2sgKmJsb2NrKQo+ICt7Cj4gKyAgICAgICB1bnNpZ25lZCBpbnQgb3JkZXIgPSBpOTE1X2J1
ZGR5X2Jsb2NrX29yZGVyKGJsb2NrKTsKPiArICAgICAgIHU2NCBvZmZzZXQgPSBpOTE1X2J1ZGR5
X2Jsb2NrX29mZnNldChibG9jayk7Cj4gKwo+ICsgICAgICAgR0VNX0JVR19PTighaTkxNV9idWRk
eV9ibG9ja19mcmVlKGJsb2NrKSk7Cj4gKyAgICAgICBHRU1fQlVHX09OKCFvcmRlcik7Cgp1aW50
IG9yZGVyID0gYmxvY2tfb3JkZXIoYmxvY2spIC0gMTsKCj4gKwo+ICsgICAgICAgYmxvY2stPmxl
ZnQgPSBrbWVtX2NhY2hlX3phbGxvYyhtbS0+YmxvY2tzLCBHRlBfS0VSTkVMKTsKPiArICAgICAg
IGlmICghYmxvY2stPmxlZnQpCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ICsK
PiArICAgICAgIGJsb2NrLT5sZWZ0LT5oZWFkZXIgPSBvZmZzZXQ7Cj4gKyAgICAgICBibG9jay0+
bGVmdC0+aGVhZGVyIHw9IG9yZGVyIC0gMTsKPiArCj4gKyAgICAgICBibG9jay0+bGVmdC0+cGFy
ZW50ID0gYmxvY2s7Cj4gKwo+ICsgICAgICAgSU5JVF9MSVNUX0hFQUQoJmJsb2NrLT5sZWZ0LT5s
aW5rKTsKPiArICAgICAgIElOSVRfTElTVF9IRUFEKCZibG9jay0+bGVmdC0+dG1wX2xpbmspOwo+
ICsKPiArICAgICAgIGJsb2NrLT5yaWdodCA9IGttZW1fY2FjaGVfemFsbG9jKG1tLT5ibG9ja3Ms
IEdGUF9LRVJORUwpOwo+ICsgICAgICAgaWYgKCFibG9jay0+cmlnaHQpIHsKPiArICAgICAgICAg
ICAgICAga21lbV9jYWNoZV9mcmVlKG1tLT5ibG9ja3MsIGJsb2NrLT5sZWZ0KTsKPiArICAgICAg
ICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgYmxvY2st
PnJpZ2h0LT5oZWFkZXIgPSBvZmZzZXQgKyAoQklUX1VMTChvcmRlciAtIDEpICogbW0tPm1pbl9z
aXplKTsKPiArICAgICAgIGJsb2NrLT5yaWdodC0+aGVhZGVyIHw9IG9yZGVyIC0gMTsKPiArCj4g
KyAgICAgICBibG9jay0+cmlnaHQtPnBhcmVudCA9IGJsb2NrOwo+ICsKPiArICAgICAgIElOSVRf
TElTVF9IRUFEKCZibG9jay0+cmlnaHQtPmxpbmspOwo+ICsgICAgICAgSU5JVF9MSVNUX0hFQUQo
JmJsb2NrLT5yaWdodC0+dG1wX2xpbmspOwoKRHVwbGljYXRlIGNvZGU/CgpibG9jay0+bGVmdCA9
IGFsbG9jX2Jsb2NrKGJsb2NrLCBvcmRlciwgb2Zmc2V0KTsKYmxvY2stPnJpZ2h0ID0gYWxsb2Nf
YmxvY2soYmxvY2ssIG9yZGVyLCBvZmZzZXQgKyBCSVQob3JkZXIpICogbW0tPm1pbl9zaXplKTsK
CmFsbG9jX2Jsb2NrOgoJc3BsaXQtPnBhcmVudCA9IGJsb2NrOwoJc3BsaXQtPmhlYWRlciA9IG9m
ZnNldDsKCXNwbGl0LT5oZWFkZXIgfD0gb3JkZXIgLSAxOwoKCS8qIFhYWCBoYXZpbmcgdG8gaW5p
dCB0aGlzIHBhaXIgaXMgd29ycmlzb21lPyAqLwoJSU5JVF9MSVNUX0hFQUQoJnNwbGl0LT5saW5r
KTsKCUlOSVRfTElTVF9IRUFEKCZzcGxpdC0+dG1wX2xpbmspOwoKCW1hcmtfZnJlZShtbSwgc3Bs
aXQpOwoJcmV0dXJuIHNwbGl0OwoKSG93ZXZlciwgaXNuJ3Qgb25lIG9mIHRoZSBqb3lzIG9mIGJ1
ZGR5IGFsbG9jYXRvcnMgdGhhdCB5b3UgYWxsb2NhdGUKaW4gcGFpcnMsIHNvIGZpbmRpbmcgdGhl
IGJ1ZGR5IGlzIGp1c3QgcG9pbnRlciBhcml0aG1ldGljPwoKPiArICAgICAgIG1hcmtfZnJlZSht
bSwgYmxvY2stPmxlZnQpOwo+ICsgICAgICAgbWFya19mcmVlKG1tLCBibG9jay0+cmlnaHQpOwo+
ICsKPiArICAgICAgIG1hcmtfc3BsaXQoYmxvY2spOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgc3RydWN0IGk5MTVfYnVkZHlfYmxvY2sgKgo+ICtnZXRfYnVkZHko
c3RydWN0IGk5MTVfYnVkZHlfYmxvY2sgKmJsb2NrKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgaTkx
NV9idWRkeV9ibG9jayAqcGFyZW50Owo+ICsKPiArICAgICAgIHBhcmVudCA9IGJsb2NrLT5wYXJl
bnQ7Cj4gKyAgICAgICBpZiAoIXBhcmVudCkKPiArICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7
Cj4gKwo+ICsgICAgICAgaWYgKHBhcmVudC0+bGVmdCA9PSBibG9jaykKPiArICAgICAgICAgICAg
ICAgcmV0dXJuIHBhcmVudC0+cmlnaHQ7Cj4gKwo+ICsgICAgICAgcmV0dXJuIHBhcmVudC0+bGVm
dDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgX19pOTE1X2J1ZGR5X2ZyZWUoc3RydWN0IGk5MTVf
YnVkZHlfbW0gKm1tLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBpOTE1
X2J1ZGR5X2Jsb2NrICpibG9jaykKPiArewo+ICsgICAgICAgbGlzdF9kZWxfaW5pdCgmYmxvY2st
PmxpbmspOyAvKiBXZSBoYXZlIG93bmVyc2hpcCBub3cgKi8KPiArCj4gKyAgICAgICB3aGlsZSAo
YmxvY2stPnBhcmVudCkgewo+ICsgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9idWRkeV9ibG9j
ayAqYnVkZHk7Cj4gKwo+ICsgICAgICAgICAgICAgICBidWRkeSA9IGdldF9idWRkeShibG9jayk7
Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAoIWk5MTVfYnVkZHlfYmxvY2tfZnJlZShidWRkeSkp
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gKwo+ICsgICAgICAgICAgICAgICBs
aXN0X2RlbCgmYnVkZHktPmxpbmspOwo+ICsKPiArICAgICAgICAgICAgICAga21lbV9jYWNoZV9m
cmVlKG1tLT5ibG9ja3MsIGJsb2NrKTsKPiArICAgICAgICAgICAgICAga21lbV9jYWNoZV9mcmVl
KG1tLT5ibG9ja3MsIGJ1ZGR5KTsKPiArCj4gKyAgICAgICAgICAgICAgIGJsb2NrID0gYmxvY2st
PnBhcmVudDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBtYXJrX2ZyZWUobW0sIGJsb2NrKTsK
PiArfQo+ICsKPiArdm9pZCBpOTE1X2J1ZGR5X2ZyZWUoc3RydWN0IGk5MTVfYnVkZHlfbW0gKm1t
LAo+ICsgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBpOTE1X2J1ZGR5X2Jsb2NrICpibG9jaykK
PiArewo+ICsgICAgICAgR0VNX0JVR19PTighaTkxNV9idWRkeV9ibG9ja19hbGxvY2F0ZWQoYmxv
Y2spKTsKPiArICAgICAgIF9faTkxNV9idWRkeV9mcmVlKG1tLCBibG9jayk7Cj4gK30KPiArCj4g
K3ZvaWQgaTkxNV9idWRkeV9mcmVlX2xpc3Qoc3RydWN0IGk5MTVfYnVkZHlfbW0gKm1tLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKm9iamVjdHMpCj4g
K3sKPiArICAgICAgIHN0cnVjdCBpOTE1X2J1ZGR5X2Jsb2NrICpibG9jaywgKm9uOwo+ICsKPiAr
ICAgICAgIGxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShibG9jaywgb24sIG9iamVjdHMsIGxpbmsp
Cj4gKyAgICAgICAgICAgICAgIGk5MTVfYnVkZHlfZnJlZShtbSwgYmxvY2spOwo+ICt9Cj4gKwo+
ICsvKgo+ICsgKiBBbGxvY2F0ZSBwb3dlci1vZi10d28gYmxvY2suIFRoZSBvcmRlciB2YWx1ZSBo
ZXJlIHRyYW5zbGF0ZXMgdG86Cj4gKyAqCj4gKyAqICAgMCA9IDJeMCAqIG1tLT5taW5fc2l6ZQo+
ICsgKiAgIDEgPSAyXjEgKiBtbS0+bWluX3NpemUKPiArICogICAyID0gMl4yICogbW0tPm1pbl9z
aXplCj4gKyAqICAgLi4uCj4gKyAqLwo+ICtzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAqCj4gK2k5
MTVfYnVkZHlfYWxsb2Moc3RydWN0IGk5MTVfYnVkZHlfbW0gKm1tLCB1bnNpZ25lZCBpbnQgb3Jk
ZXIpCj4gK3sKPiArICAgICAgIHN0cnVjdCBpOTE1X2J1ZGR5X2Jsb2NrICpibG9jayA9IE5VTEw7
Cj4gKyAgICAgICB1bnNpZ25lZCBpbnQgaTsKPiArICAgICAgIGludCBlcnI7Cj4gKwo+ICsgICAg
ICAgZm9yIChpID0gb3JkZXI7IGkgPD0gbW0tPm1heF9vcmRlcjsgKytpKSB7Cj4gKyAgICAgICAg
ICAgICAgIGJsb2NrID0gbGlzdF9maXJzdF9lbnRyeV9vcl9udWxsKCZtbS0+ZnJlZV9saXN0W2ld
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgaTkxNV9idWRkeV9ibG9jaywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbGluayk7Cj4gKyAgICAgICAgICAgICAgIGlmIChibG9jaykKPiArICAg
ICAgICAgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBpZiAo
IWJsb2NrKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRU5PU1BDKTsKPiArCj4g
KyAgICAgICBHRU1fQlVHX09OKCFpOTE1X2J1ZGR5X2Jsb2NrX2ZyZWUoYmxvY2spKTsKPiArCj4g
KyAgICAgICB3aGlsZSAoaSAhPSBvcmRlcikgewo+ICsgICAgICAgICAgICAgICBlcnIgPSBzcGxp
dF9ibG9jayhtbSwgYmxvY2spOwo+ICsgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoZXJyKSkK
PiArICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dF9mcmVlOwo+ICsKPiArICAgICAgICAg
ICAgICAgLyogR28gbG93ICovCj4gKyAgICAgICAgICAgICAgIGJsb2NrID0gYmxvY2stPmxlZnQ7
Cj4gKyAgICAgICAgICAgICAgIGktLTsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBtYXJrX2Fs
bG9jYXRlZChibG9jayk7Cj4gKyAgICAgICByZXR1cm4gYmxvY2s7Cj4gKwo+ICtvdXRfZnJlZToK
PiArICAgICAgIF9faTkxNV9idWRkeV9mcmVlKG1tLCBibG9jayk7Cj4gKyAgICAgICByZXR1cm4g
RVJSX1BUUihlcnIpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIGJvb2wgb3ZlcmxhcHModTY0
IHMxLCB1NjQgZTEsIHU2NCBzMiwgdTY0IGUyKQo+ICt7Cj4gKyAgICAgICByZXR1cm4gczEgPD0g
ZTIgJiYgZTEgPj0gczI7Cj4gK30KPiArCj4gK3N0YXRpYyBpbmxpbmUgYm9vbCBjb250YWlucyh1
NjQgczEsIHU2NCBlMSwgdTY0IHMyLCB1NjQgZTIpCj4gK3sKPiArICAgICAgIHJldHVybiBzMSA8
PSBzMiAmJiBlMSA+PSBlMjsKPiArfQo+ICsKPiArLyoKPiArICogQWxsb2NhdGUgcmFuZ2UuIE5v
dGUgdGhhdCBpdCdzIHNhZmUgdG8gY2hhaW4gdG9nZXRoZXIgbXVsdGlwbGUgYWxsb2NfcmFuZ2Vz
Cj4gKyAqIHdpdGggdGhlIHNhbWUgYmxvY2tzIGxpc3QuCj4gKyAqCj4gKyAqIEludGVuZGVkIGZv
ciBwcmUtYWxsb2NhdGluZyBwb3J0aW9ucyBvZiB0aGUgYWRkcmVzcyBzcGFjZSwgZm9yIGV4YW1w
bGUgdG8KPiArICogcmVzZXJ2ZSBhIGJsb2NrIGZvciB0aGUgaW5pdGlhbCBmcmFtZWJ1ZmZlciBv
ciBzaW1pbGFyLCBoZW5jZSB0aGUgZXhwZWN0YXRpb24KPiArICogaGVyZSBpcyB0aGF0IGk5MTVf
YnVkZHlfYWxsb2MoKSBpcyBzdGlsbCB0aGUgbWFpbiB2ZWhpY2xlIGZvcgo+ICsgKiBhbGxvY2F0
aW9ucywgc28gaWYgdGhhdCdzIG5vdCB0aGUgY2FzZSB0aGVuIHRoZSBkcm1fbW0gcmFuZ2UgYWxs
b2NhdG9yIGlzCj4gKyAqIHByb2JhYmx5IGEgbXVjaCBiZXR0ZXIgZml0LCBhbmQgc28geW91IHNo
b3VsZCBwcm9iYWJseSBnbyB1c2UgdGhhdCBpbnN0ZWFkLgo+ICsgKi8KPiAraW50IGk5MTVfYnVk
ZHlfYWxsb2NfcmFuZ2Uoc3RydWN0IGk5MTVfYnVkZHlfbW0gKm1tLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmJsb2NrcywKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICB1NjQgc3RhcnQsIHU2NCBzaXplKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgaTkx
NV9idWRkeV9ibG9jayAqYmxvY2s7Cj4gKyAgICAgICBzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAq
YnVkZHk7Cj4gKyAgICAgICBMSVNUX0hFQUQoYWxsb2NhdGVkKTsKPiArICAgICAgIExJU1RfSEVB
RChkZnMpOwo+ICsgICAgICAgdTY0IGVuZDsKPiArICAgICAgIGludCBlcnI7Cj4gKyAgICAgICBp
bnQgaTsKPiArCj4gKyAgICAgICBpZiAoc2l6ZSA8IG1tLT5taW5fc2l6ZSkKPiArICAgICAgICAg
ICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsgICAgICAgaWYgKCFJU19BTElHTkVEKHN0YXJ0
LCBtbS0+bWluX3NpemUpKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKPiArCj4g
KyAgICAgICBpZiAoIXNpemUgfHwgIUlTX0FMSUdORUQoc2l6ZSwgbW0tPm1pbl9zaXplKSkKPiAr
ICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gKwo+ICsgICAgICAgaWYgKHJhbmdlX292
ZXJmbG93cyhzdGFydCwgc2l6ZSwgbW0tPnNpemUpKQo+ICsgICAgICAgICAgICAgICByZXR1cm4g
LUVJTlZBTDsKPiArCj4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgbW0tPm5fcm9vdHM7ICsraSkK
PiArICAgICAgICAgICAgICAgbGlzdF9hZGRfdGFpbCgmbW0tPnJvb3RzW2ldLT50bXBfbGluaywg
JmRmcyk7Cj4gKwo+ICsgICAgICAgZW5kID0gc3RhcnQgKyBzaXplIC0gMTsKPiArCj4gKyAgICAg
ICBkbyB7Cj4gKyAgICAgICAgICAgICAgIHU2NCBibG9ja19zdGFydDsKPiArICAgICAgICAgICAg
ICAgdTY0IGJsb2NrX2VuZDsKPiArCj4gKyAgICAgICAgICAgICAgIGJsb2NrID0gbGlzdF9maXJz
dF9lbnRyeV9vcl9udWxsKCZkZnMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBpOTE1X2J1ZGR5X2Jsb2NrLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBfbGluayk7Cj4gKyAgICAgICAg
ICAgICAgIGlmICghYmxvY2spCj4gKyAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gKwo+
ICsgICAgICAgICAgICAgICBsaXN0X2RlbCgmYmxvY2stPnRtcF9saW5rKTsKPiArCj4gKyAgICAg
ICAgICAgICAgIGJsb2NrX3N0YXJ0ID0gaTkxNV9idWRkeV9ibG9ja19vZmZzZXQoYmxvY2spOwo+
ICsgICAgICAgICAgICAgICBibG9ja19lbmQgPSBibG9ja19zdGFydCArIGk5MTVfYnVkZHlfYmxv
Y2tfc2l6ZShtbSwgYmxvY2spIC0gMTsKPiArCj4gKyAgICAgICAgICAgICAgIGlmICghb3Zlcmxh
cHMoc3RhcnQsIGVuZCwgYmxvY2tfc3RhcnQsIGJsb2NrX2VuZCkpCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgY29udGludWU7Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAoaTkxNV9idWRkeV9i
bG9ja19hbGxvY2F0ZWQoYmxvY2spKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgZXJyID0g
LUVOT1NQQzsKPiArICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl9mcmVlOwo+ICsgICAg
ICAgICAgICAgICB9Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAoY29udGFpbnMoc3RhcnQsIGVu
ZCwgYmxvY2tfc3RhcnQsIGJsb2NrX2VuZCkpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBp
ZiAoIWk5MTVfYnVkZHlfYmxvY2tfZnJlZShibG9jaykpIHsKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGVyciA9IC1FTk9TUEM7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBnb3RvIGVycl9mcmVlOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIH0KPiArCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgbWFya19hbGxvY2F0ZWQoYmxvY2spOwo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIGxpc3RfYWRkX3RhaWwoJmJsb2NrLT5saW5rLCAmYWxsb2NhdGVkKTsKPiAr
ICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPiArICAgICAgICAgICAgICAgfQo+ICsK
PiArICAgICAgICAgICAgICAgaWYgKCFpOTE1X2J1ZGR5X2Jsb2NrX3NwbGl0KGJsb2NrKSkgewo+
ICsgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IHNwbGl0X2Jsb2NrKG1tLCBibG9jayk7Cj4g
KyAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KGVycikpCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl91bmRvOwo+ICsgICAgICAgICAgICAgICB9Cj4g
Kwo+ICsgICAgICAgICAgICAgICBsaXN0X2FkZCgmYmxvY2stPnJpZ2h0LT50bXBfbGluaywgJmRm
cyk7Cj4gKyAgICAgICAgICAgICAgIGxpc3RfYWRkKCZibG9jay0+bGVmdC0+dG1wX2xpbmssICZk
ZnMpOwo+ICsgICAgICAgfSB3aGlsZSAoMSk7Cj4gKwo+ICsgICAgICAgbGlzdF9zcGxpY2VfdGFp
bCgmYWxsb2NhdGVkLCBibG9ja3MpOwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gKwo+ICtlcnJfdW5k
bzoKPiArICAgICAgIC8qCj4gKyAgICAgICAgKiBXZSByZWFsbHkgZG9uJ3Qgd2FudCB0byBsZWF2
ZSBhcm91bmQgYSBidW5jaCBvZiBzcGxpdCBibG9ja3MsIHNpbmNlCj4gKyAgICAgICAgKiBiaWdn
ZXIgaXMgYmV0dGVyLCBzbyBtYWtlIHN1cmUgd2UgbWVyZ2UgZXZlcnl0aGluZyBiYWNrIGJlZm9y
ZSB3ZQo+ICsgICAgICAgICogZnJlZSB0aGUgYWxsb2NhdGVkIGJsb2Nrcy4KPiArICAgICAgICAq
Lwo+ICsgICAgICAgYnVkZHkgPSBnZXRfYnVkZHkoYmxvY2spOwo+ICsgICAgICAgaWYgKGJ1ZGR5
ICYmIChpOTE1X2J1ZGR5X2Jsb2NrX2ZyZWUoYmxvY2spICYmCj4gKyAgICAgICAgICAgaTkxNV9i
dWRkeV9ibG9ja19mcmVlKGJ1ZGR5KSkpCj4gKyAgICAgICAgICAgICAgIF9faTkxNV9idWRkeV9m
cmVlKG1tLCBibG9jayk7Cj4gKwo+ICtlcnJfZnJlZToKPiArICAgICAgIGk5MTVfYnVkZHlfZnJl
ZV9saXN0KG1tLCAmYWxsb2NhdGVkKTsKPiArICAgICAgIHJldHVybiBlcnI7Cj4gK30KPiArCj4g
KyNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9TRUxGVEVTVCkKPiArI2luY2x1ZGUgInNl
bGZ0ZXN0cy9pOTE1X2J1ZGR5LmMiCj4gKyNlbmRpZgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2J1ZGR5LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2J1ZGR5
LmgKPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwMDAwMC4uNjE1ZWVjZDdj
ZjRhCj4gLS0tIC9kZXYvbnVsbAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfYnVk
ZHkuaAo+IEBAIC0wLDAgKzEsMTE1IEBACj4gKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBN
SVQgKi8KPiArLyoKPiArICogQ29weXJpZ2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24KPiAr
ICovCj4gKwo+ICsjaWZuZGVmIF9fSTkxNV9CVUREWV9IX18KPiArI2RlZmluZSBfX0k5MTVfQlVE
RFlfSF9fCj4gKwo+ICsjaW5jbHVkZSA8bGludXgvYml0b3BzLmg+Cj4gKwo+ICtzdHJ1Y3QgbGlz
dF9oZWFkOwoKWW91IG5lZWQgdGhlIGFjdHVhbCBpbmNsdWRlIGZvciBlbWJlZGRpbmcgdGhlIHN0
cnVjdC4KCj4gKwo+ICtzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayB7Cj4gKyNkZWZpbmUgSTkxNV9C
VUREWV9IRUFERVJfT0ZGU0VUIEdFTk1BU0tfVUxMKDYzLCAxMikKPiArI2RlZmluZSBJOTE1X0JV
RERZX0hFQURFUl9TVEFURSAgR0VOTUFTS19VTEwoMTEsIDEwKQo+ICsjZGVmaW5lICAgSTkxNV9C
VUREWV9BTExPQ0FURUQgKDE8PDEwKQo+ICsjZGVmaW5lICAgSTkxNV9CVUREWV9GUkVFICAgICAg
ICAgKDI8PDEwKQo+ICsjZGVmaW5lICAgSTkxNV9CVUREWV9TUExJVCAgICAgICAgKDM8PDEwKQo+
ICsjZGVmaW5lIEk5MTVfQlVERFlfSEVBREVSX09SREVSICBHRU5NQVNLX1VMTCg5LCAwKQo+ICsg
ICAgICAgdTY0IGhlYWRlcjsKPiArCj4gKyAgICAgICBzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAq
bGVmdDsKPiArICAgICAgIHN0cnVjdCBpOTE1X2J1ZGR5X2Jsb2NrICpyaWdodDsKPiArICAgICAg
IHN0cnVjdCBpOTE1X2J1ZGR5X2Jsb2NrICpwYXJlbnQ7Cj4gKwo+ICsgICAgICAgLyogWFhYOiBz
b213ZXdoYXQgZnVua3kgKi8KPiArICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgbGluazsKPiArICAg
ICAgIHN0cnVjdCBsaXN0X2hlYWQgdG1wX2xpbms7Cj4gK307Cj4gKwo+ICsjZGVmaW5lIEk5MTVf
QlVERFlfTUFYX09SREVSICBJOTE1X0JVRERZX0hFQURFUl9PUkRFUgo+ICsKPiArLyogQmluYXJ5
IEJ1ZGR5IFN5c3RlbSAqLwo+ICtzdHJ1Y3QgaTkxNV9idWRkeV9tbSB7Cj4gKyAgICAgICBzdHJ1
Y3Qga21lbV9jYWNoZSAqYmxvY2tzOwo+ICsKPiArICAgICAgIC8qIE1haW50YWluIGEgZnJlZSBs
aXN0IGZvciBlYWNoIG9yZGVyLiAqLwo+ICsgICAgICAgc3RydWN0IGxpc3RfaGVhZCAqZnJlZV9s
aXN0Owo+ICsKPiArICAgICAgIC8qCj4gKyAgICAgICAgKiBNYWludGFpbiBleHBsaWNpdCBiaW5h
cnkgdHJlZShzKSB0byB0cmFjayB0aGUgYWxsb2NhdGlvbiBvZiB0aGUKPiArICAgICAgICAqIGFk
ZHJlc3Mgc3BhY2UuIFRoaXMgZ2l2ZXMgdXMgYSBzaW1wbGUgd2F5IG9mIGZpbmRpbmcgYSBidWRk
eSBibG9jawo+ICsgICAgICAgICogYW5kIHBlcmZvcm1pbmcgdGhlIHBvdGVudGlhbGx5IHJlY3Vy
c2l2ZSBtZXJnZSBzdGVwIHdoZW4gZnJlZWluZyBhCj4gKyAgICAgICAgKiBibG9jay4gIE5vZGVz
IGFyZSBlaXRoZXIgYWxsb2NhdGVkIG9yIGZyZWUsIGluIHdoaWNoIGNhc2UgdGhleSB3aWxsCj4g
KyAgICAgICAgKiBhbHNvIGV4aXN0IG9uIHRoZSByZXNwZWN0aXZlIGZyZWUgbGlzdC4KPiArICAg
ICAgICAqLwo+ICsgICAgICAgc3RydWN0IGk5MTVfYnVkZHlfYmxvY2sgKipyb290czsKPiArCj4g
KyAgICAgICB1bnNpZ25lZCBpbnQgbl9yb290czsKPiArICAgICAgIHVuc2lnbmVkIGludCBtYXhf
b3JkZXI7Cj4gKwo+ICsgICAgICAgLyogTXVzdCBiZSBhdCBsZWFzdCBQQUdFX1NJWkUgKi8KPiAr
ICAgICAgIHU2NCBtaW5fc2l6ZTsKPiArICAgICAgIHU2NCBzaXplOwo+ICt9OwoKTm90IG9uZSBt
ZW50aW9uIHRoYXQgdGhlIG93bmVyL2NhbGxlciBpcyByZXNwb25zaWJsZSBmb3IgbG9ja2luZy4K
Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHU2NAo+ICtpOTE1X2J1ZGR5X2Jsb2NrX29mZnNldChzdHJ1
Y3QgaTkxNV9idWRkeV9ibG9jayAqYmxvY2spCj4gK3sKPiArICAgICAgIHJldHVybiBibG9jay0+
aGVhZGVyICYgSTkxNV9CVUREWV9IRUFERVJfT0ZGU0VUOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5s
aW5lIHVuc2lnbmVkIGludAo+ICtpOTE1X2J1ZGR5X2Jsb2NrX29yZGVyKHN0cnVjdCBpOTE1X2J1
ZGR5X2Jsb2NrICpibG9jaykKPiArewo+ICsgICAgICAgcmV0dXJuIGJsb2NrLT5oZWFkZXIgJiBJ
OTE1X0JVRERZX0hFQURFUl9PUkRFUjsKPiArfQo+ICsKPiArc3RhdGljIGlubGluZSB1bnNpZ25l
ZCBpbnQKPiAraTkxNV9idWRkeV9ibG9ja19zdGF0ZShzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAq
YmxvY2spCj4gK3sKPiArICAgICAgIHJldHVybiBibG9jay0+aGVhZGVyICYgSTkxNV9CVUREWV9I
RUFERVJfU1RBVEU7Cj4gK30KPiArCj4gK3N0YXRpYyBpbmxpbmUgYm9vbAo+ICtpOTE1X2J1ZGR5
X2Jsb2NrX2FsbG9jYXRlZChzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAqYmxvY2spCj4gK3sKPiAr
ICAgICAgIHJldHVybiBpOTE1X2J1ZGR5X2Jsb2NrX3N0YXRlKGJsb2NrKSA9PSBJOTE1X0JVRERZ
X0FMTE9DQVRFRDsKPiArfQo+ICsKPiArc3RhdGljIGlubGluZSBib29sCj4gK2k5MTVfYnVkZHlf
YmxvY2tfZnJlZShzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAqYmxvY2spCgpUaGlzIG5lZWRzIGFu
ICdpcycgYXMgZnJlZSgpIGlzIGEgcmF0aGVyIGNvbW1vbiB2ZXJiIGFuZCB0aGlzIGlzIHZlcnks
CnZlcnkgY29uZnVzaW5nLgoKU28gaXNfYWxsb2NhdGVkLCBpc19mcmVlLCBpc19zcGxpdC4KCj4g
K3sKPiArICAgICAgIHJldHVybiBpOTE1X2J1ZGR5X2Jsb2NrX3N0YXRlKGJsb2NrKSA9PSBJOTE1
X0JVRERZX0ZSRUU7Cj4gK30KPiArCj4gK3N0YXRpYyBpbmxpbmUgYm9vbAo+ICtpOTE1X2J1ZGR5
X2Jsb2NrX3NwbGl0KHN0cnVjdCBpOTE1X2J1ZGR5X2Jsb2NrICpibG9jaykKPiArewo+ICsgICAg
ICAgcmV0dXJuIGk5MTVfYnVkZHlfYmxvY2tfc3RhdGUoYmxvY2spID09IEk5MTVfQlVERFlfU1BM
SVQ7Cj4gK30KPiArCj4gK3N0YXRpYyBpbmxpbmUgdTY0Cj4gK2k5MTVfYnVkZHlfYmxvY2tfc2l6
ZShzdHJ1Y3QgaTkxNV9idWRkeV9tbSAqbW0sCj4gKyAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBpOTE1X2J1ZGR5X2Jsb2NrICpibG9jaykKPiArewo+ICsgICAgICAgcmV0dXJuIEJJVChpOTE1
X2J1ZGR5X2Jsb2NrX29yZGVyKGJsb2NrKSkgKiBtbS0+bWluX3NpemU7Cj4gK30KPiArCj4gK2lu
dCBpOTE1X2J1ZGR5X2luaXQoc3RydWN0IGk5MTVfYnVkZHlfbW0gKm1tLCB1NjQgc2l6ZSwgdTY0
IG1pbl9zaXplKTsKPiArCj4gK3ZvaWQgaTkxNV9idWRkeV9maW5pKHN0cnVjdCBpOTE1X2J1ZGR5
X21tICptbSk7Cj4gKwo+ICtzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAqCj4gK2k5MTVfYnVkZHlf
YWxsb2Moc3RydWN0IGk5MTVfYnVkZHlfbW0gKm1tLCB1bnNpZ25lZCBpbnQgb3JkZXIpOwo+ICsK
PiAraW50IGk5MTVfYnVkZHlfYWxsb2NfcmFuZ2Uoc3RydWN0IGk5MTVfYnVkZHlfbW0gKm1tLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgKmJsb2NrcywKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICB1NjQgc3RhcnQsIHU2NCBzaXplKTsKPiArCj4gK3Zv
aWQgaTkxNV9idWRkeV9mcmVlKHN0cnVjdCBpOTE1X2J1ZGR5X21tICptbSwgc3RydWN0IGk5MTVf
YnVkZHlfYmxvY2sgKmJsb2NrKTsKPiArCj4gK3ZvaWQgaTkxNV9idWRkeV9mcmVlX2xpc3Qoc3Ry
dWN0IGk5MTVfYnVkZHlfbW0gKm1tLCBzdHJ1Y3QgbGlzdF9oZWFkICpvYmplY3RzKTsKCj4gKwo+
ICsjZW5kaWYKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfYnVkZHkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2J1ZGR5LmMK
PiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwMDAwMC4uMjE1OWFhOWY0ODY3
Cj4gLS0tIC9kZXYvbnVsbAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9p
OTE1X2J1ZGR5LmMKPiBAQCAtMCwwICsxLDQ5MSBAQAo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogTUlUCj4gKy8qCj4gKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9u
Cj4gKyAqLwo+ICsKPiArI2luY2x1ZGUgPGxpbnV4L3ByaW1lX251bWJlcnMuaD4KPiArCj4gKyNp
bmNsdWRlICIuLi9pOTE1X3NlbGZ0ZXN0LmgiCj4gKyNpbmNsdWRlICJpOTE1X3JhbmRvbS5oIgo+
ICsKPiArI2RlZmluZSBTWl84RyAoMVVMTCA8PCAzMykKPiArCj4gK3N0YXRpYyB2b2lkIF9faWd0
X2R1bXBfYmxvY2soc3RydWN0IGk5MTVfYnVkZHlfbW0gKm1tLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IGk5MTVfYnVkZHlfYmxvY2sgKmJsb2NrLAo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYm9vbCBidWRkeSkKPiArewo+ICsgICAgICAgcHJfZXJyKCJibG9j
ayBpbmZvOiBoZWFkZXI9JWxseCwgc3RhdGU9JXUsIG9yZGVyPSVkLCBvZmZzZXQ9JWxseCBzaXpl
PSVsbHggcm9vdD0lcyBidWRkeT0lc1xuIiwKPiArICAgICAgICAgICAgICBibG9jay0+aGVhZGVy
LAo+ICsgICAgICAgICAgICAgIGk5MTVfYnVkZHlfYmxvY2tfc3RhdGUoYmxvY2spLAo+ICsgICAg
ICAgICAgICAgIGk5MTVfYnVkZHlfYmxvY2tfb3JkZXIoYmxvY2spLAo+ICsgICAgICAgICAgICAg
IGk5MTVfYnVkZHlfYmxvY2tfb2Zmc2V0KGJsb2NrKSwKPiArICAgICAgICAgICAgICBpOTE1X2J1
ZGR5X2Jsb2NrX3NpemUobW0sIGJsb2NrKSwKPiArICAgICAgICAgICAgICB5ZXNubyghYmxvY2st
PnBhcmVudCksCj4gKyAgICAgICAgICAgICAgeWVzbm8oYnVkZHkpKTsKPiArfQo+ICsKPiArc3Rh
dGljIHZvaWQgaWd0X2R1bXBfYmxvY2soc3RydWN0IGk5MTVfYnVkZHlfbW0gKm1tLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBpOTE1X2J1ZGR5X2Jsb2NrICpibG9jaykKPiAr
ewo+ICsgICAgICAgc3RydWN0IGk5MTVfYnVkZHlfYmxvY2sgKmJ1ZGR5Owo+ICsKPiArICAgICAg
IF9faWd0X2R1bXBfYmxvY2sobW0sIGJsb2NrLCBmYWxzZSk7Cj4gKwo+ICsgICAgICAgYnVkZHkg
PSBnZXRfYnVkZHkoYmxvY2spOwo+ICsgICAgICAgaWYgKGJ1ZGR5KQo+ICsgICAgICAgICAgICAg
ICBfX2lndF9kdW1wX2Jsb2NrKG1tLCBidWRkeSwgdHJ1ZSk7Cj4gK30KPiArCj4gK3N0YXRpYyBp
bnQgaWd0X2NoZWNrX2Jsb2NrKHN0cnVjdCBpOTE1X2J1ZGR5X21tICptbSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAqYmxvY2spCj4gK3sKPiAr
ICAgICAgIHN0cnVjdCBpOTE1X2J1ZGR5X2Jsb2NrICpidWRkeTsKPiArICAgICAgIHVuc2lnbmVk
IGludCBibG9ja19zdGF0ZTsKPiArICAgICAgIHU2NCBibG9ja19zaXplOwo+ICsgICAgICAgdTY0
IG9mZnNldDsKPiArICAgICAgIGludCBlcnIgPSAwOwo+ICsKPiArICAgICAgIGJsb2NrX3N0YXRl
ID0gaTkxNV9idWRkeV9ibG9ja19zdGF0ZShibG9jayk7Cj4gKwo+ICsgICAgICAgaWYgKGJsb2Nr
X3N0YXRlICE9IEk5MTVfQlVERFlfQUxMT0NBVEVEICYmCj4gKyAgICAgICAgICAgYmxvY2tfc3Rh
dGUgIT0gSTkxNV9CVUREWV9GUkVFICYmCj4gKyAgICAgICAgICAgYmxvY2tfc3RhdGUgIT0gSTkx
NV9CVUREWV9TUExJVCkgewo+ICsgICAgICAgICAgICAgICBwcl9lcnIoImJsb2NrIHN0YXRlIG1p
c21hdGNoXG4iKTsKPiArICAgICAgICAgICAgICAgZXJyID0gLUVJTlZBTDsKPiArICAgICAgIH0K
PiArCj4gKyAgICAgICBibG9ja19zaXplID0gaTkxNV9idWRkeV9ibG9ja19zaXplKG1tLCBibG9j
ayk7Cj4gKyAgICAgICBvZmZzZXQgPSBpOTE1X2J1ZGR5X2Jsb2NrX29mZnNldChibG9jayk7Cj4g
Kwo+ICsgICAgICAgaWYgKGJsb2NrX3NpemUgPCBtbS0+bWluX3NpemUpIHsKPiArICAgICAgICAg
ICAgICAgcHJfZXJyKCJibG9jayBzaXplIHNtYWxsZXIgdGhhbiBtaW4gc2l6ZVxuIik7Cj4gKyAg
ICAgICAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgaWYg
KCFpc19wb3dlcl9vZl8yKGJsb2NrX3NpemUpKSB7Cj4gKyAgICAgICAgICAgICAgIHByX2Vycigi
YmxvY2sgc2l6ZSBub3QgcG93ZXIgb2YgdHdvXG4iKTsKPiArICAgICAgICAgICAgICAgZXJyID0g
LUVJTlZBTDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBpZiAoIUlTX0FMSUdORUQoYmxvY2tf
c2l6ZSwgbW0tPm1pbl9zaXplKSkgewo+ICsgICAgICAgICAgICAgICBwcl9lcnIoImJsb2NrIHNp
emUgbm90IGFsaWduZWQgdG8gbWluIHNpemVcbiIpOwo+ICsgICAgICAgICAgICAgICBlcnIgPSAt
RUlOVkFMOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGlmICghSVNfQUxJR05FRChvZmZzZXQs
IG1tLT5taW5fc2l6ZSkpIHsKPiArICAgICAgICAgICAgICAgcHJfZXJyKCJibG9jayBvZmZzZXQg
bm90IGFsaWduZWQgdG8gbWluIHNpemVcbiIpOwo+ICsgICAgICAgICAgICAgICBlcnIgPSAtRUlO
VkFMOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGlmICghSVNfQUxJR05FRChvZmZzZXQsIGJs
b2NrX3NpemUpKSB7Cj4gKyAgICAgICAgICAgICAgIHByX2VycigiYmxvY2sgb2Zmc2V0IG5vdCBh
bGlnbmVkIHRvIGJsb2NrIHNpemVcbiIpOwo+ICsgICAgICAgICAgICAgICBlcnIgPSAtRUlOVkFM
Owo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGJ1ZGR5ID0gZ2V0X2J1ZGR5KGJsb2NrKTsKPiAr
Cj4gKyAgICAgICBpZiAoIWJ1ZGR5ICYmIGJsb2NrLT5wYXJlbnQpIHsKPiArICAgICAgICAgICAg
ICAgcHJfZXJyKCJidWRkeSBoYXMgZ29uZSBmaXNoaW5nXG4iKTsKPiArICAgICAgICAgICAgICAg
ZXJyID0gLUVJTlZBTDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBpZiAoYnVkZHkpIHsKPiAr
ICAgICAgICAgICAgICAgaWYgKGk5MTVfYnVkZHlfYmxvY2tfb2Zmc2V0KGJ1ZGR5KSAhPSAob2Zm
c2V0IF4gYmxvY2tfc2l6ZSkpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBwcl9lcnIoImJ1
ZGR5IGhhcyB3cm9uZyBvZmZzZXRcbiIpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGVyciA9
IC1FSU5WQUw7Cj4gKyAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAgICAgIGlmIChp
OTE1X2J1ZGR5X2Jsb2NrX3NpemUobW0sIGJ1ZGR5KSAhPSBibG9ja19zaXplKSB7Cj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgcHJfZXJyKCJidWRkeSBzaXplIG1pc21hdGNoXG4iKTsKPiArICAg
ICAgICAgICAgICAgICAgICAgICBlcnIgPSAtRUlOVkFMOwo+ICsgICAgICAgICAgICAgICB9Cj4g
Kwo+ICsgICAgICAgICAgICAgICBpZiAoaTkxNV9idWRkeV9ibG9ja19zdGF0ZShidWRkeSkgPT0g
YmxvY2tfc3RhdGUgJiYKPiArICAgICAgICAgICAgICAgICAgIGJsb2NrX3N0YXRlID09IEk5MTVf
QlVERFlfRlJFRSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIHByX2VycigiYmxvY2sgYW5k
IGl0cyBidWRkeSBhcmUgZnJlZVxuIik7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgZXJyID0g
LUVJTlZBTDsKPiArICAgICAgICAgICAgICAgfQo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJl
dHVybiBlcnI7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgaWd0X2NoZWNrX2Jsb2NrcyhzdHJ1Y3Qg
aTkxNV9idWRkeV9tbSAqbW0sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBs
aXN0X2hlYWQgKmJsb2NrcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgdTY0IGV4cGVj
dGVkX3NpemUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgaXNfY29udGlndW91
cykKPiArewo+ICsgICAgICAgc3RydWN0IGk5MTVfYnVkZHlfYmxvY2sgKmJsb2NrOwo+ICsgICAg
ICAgc3RydWN0IGk5MTVfYnVkZHlfYmxvY2sgKnByZXY7Cj4gKyAgICAgICB1NjQgdG90YWw7Cj4g
KyAgICAgICBpbnQgZXJyID0gMDsKPiArCj4gKyAgICAgICBibG9jayA9IE5VTEw7Cj4gKyAgICAg
ICBwcmV2ID0gTlVMTDsKPiArICAgICAgIHRvdGFsID0gMDsKPiArCj4gKyAgICAgICBsaXN0X2Zv
cl9lYWNoX2VudHJ5KGJsb2NrLCBibG9ja3MsIGxpbmspIHsKPiArICAgICAgICAgICAgICAgZXJy
ID0gaWd0X2NoZWNrX2Jsb2NrKG1tLCBibG9jayk7Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAo
IWk5MTVfYnVkZHlfYmxvY2tfYWxsb2NhdGVkKGJsb2NrKSkgewo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIHByX2VycigiYmxvY2sgbm90IGFsbG9jYXRlZFxuIiksCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgZXJyID0gLUVJTlZBTDsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAg
ICAgICAgICAgaWYgKGlzX2NvbnRpZ3VvdXMgJiYgcHJldikgewo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIHU2NCBwcmV2X2Jsb2NrX3NpemU7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgdTY0
IHByZXZfb2Zmc2V0Owo+ICsgICAgICAgICAgICAgICAgICAgICAgIHU2NCBvZmZzZXQ7Cj4gKwo+
ICsgICAgICAgICAgICAgICAgICAgICAgIHByZXZfb2Zmc2V0ID0gaTkxNV9idWRkeV9ibG9ja19v
ZmZzZXQocHJldik7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcHJldl9ibG9ja19zaXplID0g
aTkxNV9idWRkeV9ibG9ja19zaXplKG1tLCBwcmV2KTsKPiArICAgICAgICAgICAgICAgICAgICAg
ICBvZmZzZXQgPSBpOTE1X2J1ZGR5X2Jsb2NrX29mZnNldChibG9jayk7Cj4gKwo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGlmIChvZmZzZXQgIT0gKHByZXZfb2Zmc2V0ICsgcHJldl9ibG9ja19z
aXplKSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJfZXJyKCJibG9jayBv
ZmZzZXQgbWlzbWF0Y2hcbiIpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJy
ID0gLUVJTlZBTDsKPiArICAgICAgICAgICAgICAgICAgICAgICB9Cj4gKyAgICAgICAgICAgICAg
IH0KPiArCj4gKyAgICAgICAgICAgICAgIGlmIChlcnIpCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgYnJlYWs7Cj4gKwo+ICsgICAgICAgICAgICAgICB0b3RhbCArPSBpOTE1X2J1ZGR5X2Jsb2Nr
X3NpemUobW0sIGJsb2NrKTsKPiArICAgICAgICAgICAgICAgcHJldiA9IGJsb2NrOwo+ICsgICAg
ICAgfQo+ICsKPiArICAgICAgIGlmICghZXJyKSB7Cj4gKyAgICAgICAgICAgICAgIGlmICh0b3Rh
bCAhPSBleHBlY3RlZF9zaXplKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcHJfZXJyKCJz
aXplIG1pc21hdGNoLCBleHBlY3RlZD0lbGx4LCBmb3VuZD0lbGx4XG4iLAo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBleHBlY3RlZF9zaXplLCB0b3RhbCk7Cj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgZXJyID0gLUVJTlZBTDsKPiArICAgICAgICAgICAgICAgfQo+ICsgICAgICAg
ICAgICAgICByZXR1cm4gZXJyOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGlmIChwcmV2KSB7
Cj4gKyAgICAgICAgICAgICAgIHByX2VycigicHJldiBibG9jaywgZHVtcDpcbiIpOwo+ICsgICAg
ICAgICAgICAgICBpZ3RfZHVtcF9ibG9jayhtbSwgcHJldik7Cj4gKyAgICAgICB9Cj4gKwo+ICsg
ICAgICAgaWYgKGJsb2NrKSB7Cj4gKyAgICAgICAgICAgICAgIHByX2VycigiYmFkIGJsb2NrLCBk
dW1wOlxuIik7Cj4gKyAgICAgICAgICAgICAgIGlndF9kdW1wX2Jsb2NrKG1tLCBibG9jayk7Cj4g
KyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIGlu
dCBpZ3RfY2hlY2tfbW0oc3RydWN0IGk5MTVfYnVkZHlfbW0gKm1tKQo+ICt7Cj4gKyAgICAgICBz
dHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAqcm9vdDsKPiArICAgICAgIHN0cnVjdCBpOTE1X2J1ZGR5
X2Jsb2NrICpwcmV2Owo+ICsgICAgICAgdW5zaWduZWQgaW50IGk7Cj4gKyAgICAgICB1NjQgdG90
YWw7Cj4gKyAgICAgICBpbnQgZXJyID0gMDsKPiArCj4gKyAgICAgICBpZiAoIW1tLT5uX3Jvb3Rz
KSB7Cj4gKyAgICAgICAgICAgICAgIHByX2Vycigibl9yb290cyBpcyB6ZXJvXG4iKTsKPiArICAg
ICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgaWYg
KG1tLT5uX3Jvb3RzICE9IGh3ZWlnaHQ2NChtbS0+c2l6ZSkpIHsKPiArICAgICAgICAgICAgICAg
cHJfZXJyKCJuX3Jvb3RzIG1pc21hdGNoLCBuX3Jvb3RzPSV1LCBleHBlY3RlZD0lbHVcbiIsCj4g
KyAgICAgICAgICAgICAgICAgICAgICBtbS0+bl9yb290cywgaHdlaWdodDY0KG1tLT5zaXplKSk7
Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsgICAgICAgfQo+ICsKPiArICAg
ICAgIHJvb3QgPSBOVUxMOwo+ICsgICAgICAgcHJldiA9IE5VTEw7Cj4gKyAgICAgICB0b3RhbCA9
IDA7Cj4gKwo+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IG1tLT5uX3Jvb3RzOyArK2kpIHsKPiAr
ICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfYnVkZHlfYmxvY2sgKmJsb2NrOwo+ICsgICAgICAg
ICAgICAgICB1bnNpZ25lZCBpbnQgb3JkZXI7Cj4gKwo+ICsgICAgICAgICAgICAgICByb290ID0g
bW0tPnJvb3RzW2ldOwo+ICsgICAgICAgICAgICAgICBpZiAoIXJvb3QpIHsKPiArICAgICAgICAg
ICAgICAgICAgICAgICBwcl9lcnIoInJvb3QoJXUpIGlzIE5VTExcbiIsIGkpOwo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAg
YnJlYWs7Cj4gKyAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAgICAgIGVyciA9IGln
dF9jaGVja19ibG9jayhtbSwgcm9vdCk7Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAoIWk5MTVf
YnVkZHlfYmxvY2tfZnJlZShyb290KSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIHByX2Vy
cigicm9vdCBub3QgZnJlZVxuIik7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgZXJyID0gLUVJ
TlZBTDsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAgICAgb3JkZXIgPSBp
OTE1X2J1ZGR5X2Jsb2NrX29yZGVyKHJvb3QpOwo+ICsKPiArICAgICAgICAgICAgICAgaWYgKCFp
KSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9yZGVyICE9IG1tLT5tYXhfb3JkZXIp
IHsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByX2VycigibWF4IG9yZGVyIHJv
b3QgbWlzc2luZ1xuIik7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSAt
RUlOVkFMOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIH0KPiArICAgICAgICAgICAgICAgfQo+
ICsKPiArICAgICAgICAgICAgICAgaWYgKHByZXYpIHsKPiArICAgICAgICAgICAgICAgICAgICAg
ICB1NjQgcHJldl9ibG9ja19zaXplOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIHU2NCBwcmV2
X29mZnNldDsKPiArICAgICAgICAgICAgICAgICAgICAgICB1NjQgb2Zmc2V0Owo+ICsKPiArICAg
ICAgICAgICAgICAgICAgICAgICBwcmV2X29mZnNldCA9IGk5MTVfYnVkZHlfYmxvY2tfb2Zmc2V0
KHByZXYpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIHByZXZfYmxvY2tfc2l6ZSA9IGk5MTVf
YnVkZHlfYmxvY2tfc2l6ZShtbSwgcHJldik7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgb2Zm
c2V0ID0gaTkxNV9idWRkeV9ibG9ja19vZmZzZXQocm9vdCk7Cj4gKwo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGlmIChvZmZzZXQgIT0gKHByZXZfb2Zmc2V0ICsgcHJldl9ibG9ja19zaXplKSkg
ewo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJfZXJyKCJyb290IG9mZnNldCBt
aXNtYXRjaFxuIik7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSAtRUlO
VkFMOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIH0KPiArICAgICAgICAgICAgICAgfQo+ICsK
PiArICAgICAgICAgICAgICAgYmxvY2sgPSBsaXN0X2ZpcnN0X2VudHJ5X29yX251bGwoJm1tLT5m
cmVlX2xpc3Rbb3JkZXJdLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jaywKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluayk7Cj4gKyAgICAgICAgICAgICAgIGlm
IChibG9jayAhPSByb290KSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgcHJfZXJyKCJyb290
IG1pc21hdGNoIGF0IG9yZGVyPSV1XG4iLCBvcmRlcik7Cj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgZXJyID0gLUVJTlZBTDsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAg
ICAgaWYgKGVycikKPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiArCj4gKyAgICAg
ICAgICAgICAgIHByZXYgPSByb290Owo+ICsgICAgICAgICAgICAgICB0b3RhbCArPSBpOTE1X2J1
ZGR5X2Jsb2NrX3NpemUobW0sIHJvb3QpOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGlmICgh
ZXJyKSB7Cj4gKyAgICAgICAgICAgICAgIGlmICh0b3RhbCAhPSBtbS0+c2l6ZSkgewo+ICsgICAg
ICAgICAgICAgICAgICAgICAgIHByX2VycigiZXhwZWN0ZWQgbW0gc2l6ZT0lbGx4LCBmb3VuZD0l
bGx4XG4iLCBtbS0+c2l6ZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWwp
Owo+ICsgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4gKyAgICAgICAgICAg
ICAgIH0KPiArICAgICAgICAgICAgICAgcmV0dXJuIGVycjsKPiArICAgICAgIH0KPiArCj4gKyAg
ICAgICBpZiAocHJldikgewo+ICsgICAgICAgICAgICAgICBwcl9lcnIoInByZXYgcm9vdCgldSks
IGR1bXA6XG4iLCBpIC0gMSk7Cj4gKyAgICAgICAgICAgICAgIGlndF9kdW1wX2Jsb2NrKG1tLCBw
cmV2KTsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBpZiAocm9vdCkgewo+ICsgICAgICAgICAg
ICAgICBwcl9lcnIoImJhZCByb290KCV1KSwgZHVtcDpcbiIsIGkpOwo+ICsgICAgICAgICAgICAg
ICBpZ3RfZHVtcF9ibG9jayhtbSwgcm9vdCk7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0
dXJuIGVycjsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgaWd0X21tX2NvbmZpZyh1NjQgKnNpemUs
IHU2NCAqbWluX3NpemUpCj4gK3sKPiArICAgICAgIEk5MTVfUk5EX1NUQVRFKHBybmcpOwo+ICsg
ICAgICAgdTY0IHMsIG1zOwo+ICsKPiArICAgICAgIC8qIE5vdGhpbmcgZmFuY3ksIGp1c3QgdHJ5
IHRvIGdldCBhbiBpbnRlcmVzdGluZyBiaXQgcGF0dGVybiAqLwo+ICsKPiArICAgICAgIHByYW5k
b21fc2VlZF9zdGF0ZSgmcHJuZywgaTkxNV9zZWxmdGVzdC5yYW5kb21fc2VlZCk7Cj4gKwo+ICsg
ICAgICAgcyA9IGk5MTVfcHJhbmRvbV91NjRfc3RhdGUoJnBybmcpICYgKFNaXzhHIC0gMSk7Cj4g
KyAgICAgICBtcyA9IEJJVF9VTEwoMTIgKyAocHJhbmRvbV91MzJfc3RhdGUoJnBybmcpICUgaWxv
ZzIocyA+PiAxMikpKTsKPiArICAgICAgIHMgPSBtYXgocyAmIC1tcywgbXMpOwo+ICsKPiArICAg
ICAgICptaW5fc2l6ZSA9IG1zOwo+ICsgICAgICAgKnNpemUgPSBzOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgaW50IGlndF9idWRkeV9hbGxvYyh2b2lkICphcmcpCj4gK3sKPiArICAgICAgIHN0cnVjdCBp
OTE1X2J1ZGR5X21tIG1tOwo+ICsgICAgICAgaW50IG1heF9vcmRlcjsKPiArICAgICAgIHU2NCBt
aW5fc2l6ZTsKPiArICAgICAgIHU2NCBtbV9zaXplOwo+ICsgICAgICAgaW50IGVycjsKPiArCj4g
KyAgICAgICBpZ3RfbW1fY29uZmlnKCZtbV9zaXplLCAmbWluX3NpemUpOwo+ICsKPiArICAgICAg
IHByX2luZm8oImJ1ZGR5X2luaXQgd2l0aCBzaXplPSVsbHgsIG1pbl9zaXplPSVsbHhcbiIsIG1t
X3NpemUsIG1pbl9zaXplKTsKPiArCj4gKyAgICAgICBlcnIgPSBpOTE1X2J1ZGR5X2luaXQoJm1t
LCBtbV9zaXplLCBtaW5fc2l6ZSk7Cj4gKyAgICAgICBpZiAoZXJyKSB7Cj4gKyAgICAgICAgICAg
ICAgIHByX2VycigiYnVkZHlfaW5pdCBmYWlsZWQoJWQpXG4iLCBlcnIpOwo+ICsgICAgICAgICAg
ICAgICByZXR1cm4gZXJyOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGZvciAobWF4X29yZGVy
ID0gbW0ubWF4X29yZGVyOyBtYXhfb3JkZXIgPj0gMDsgbWF4X29yZGVyLS0pIHsKPiArICAgICAg
ICAgICAgICAgc3RydWN0IGk5MTVfYnVkZHlfYmxvY2sgKmJsb2NrOwo+ICsgICAgICAgICAgICAg
ICBpbnQgb3JkZXI7Cj4gKyAgICAgICAgICAgICAgIExJU1RfSEVBRChibG9ja3MpOwo+ICsgICAg
ICAgICAgICAgICB1NjQgdG90YWw7Cj4gKwo+ICsgICAgICAgICAgICAgICBlcnIgPSBpZ3RfY2hl
Y2tfbW0oJm1tKTsKPiArICAgICAgICAgICAgICAgaWYgKGVycikgewo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIHByX2VycigicHJlLW1tIGNoZWNrIGZhaWxlZCwgYWJvcnRcbiIpOwo+ICsgICAg
ICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgICAgICAgICB9Cj4gKwo+ICsgICAg
ICAgICAgICAgICBwcl9pbmZvKCJmaWxsaW5nIGZyb20gbWF4X29yZGVyPSV1XG4iLCBtYXhfb3Jk
ZXIpOwo+ICsKPiArICAgICAgICAgICAgICAgb3JkZXIgPSBtYXhfb3JkZXI7Cj4gKyAgICAgICAg
ICAgICAgIHRvdGFsID0gMDsKPiArCj4gKyAgICAgICAgICAgICAgIGRvIHsKPiArcmV0cnk6Cj4g
KyAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgPSBpOTE1X2J1ZGR5X2FsbG9jKCZtbSwgb3Jk
ZXIpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmIChJU19FUlIoYmxvY2spKSB7Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSBQVFJfRVJSKGJsb2NrKTsKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIgPT0gLUVOT01FTSkgewo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcl9pbmZvKCJidWRkeV9hbGxvYyBo
aXQgLUVOT01FTSB3aXRoIG9yZGVyPSVkXG4iLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIG9yZGVyKTsKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGlmIChvcmRlci0tKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZXJyID0gMDsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBnb3RvIHJldHJ5Owo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB9Cj4gKwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBw
cl9lcnIoImJ1ZGR5X2FsbG9jIHdpdGggb3JkZXI9JWQgZmFpbGVkKCVkKVxuIiwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLCBlcnIpOwo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIH0KPiArCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgbGlzdF9hZGRfdGFpbCgmYmxvY2stPmxpbmssICZibG9ja3Mp
Owo+ICsKPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAoaTkxNV9idWRkeV9ibG9ja19vcmRl
cihibG9jaykgIT0gb3JkZXIpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBy
X2VycigiYnVkZHlfYWxsb2Mgb3JkZXIgbWlzbWF0Y2hcbiIpOwo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZXJyID0gLUVJTlZBTDsKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJyZWFrOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgdG90YWwgKz0gaTkxNV9idWRkeV9ibG9ja19zaXplKCZtbSwgYmxvY2sp
Owo+ICsgICAgICAgICAgICAgICB9IHdoaWxlICh0b3RhbCA8IG1tLnNpemUpOwo+ICsKPiArICAg
ICAgICAgICAgICAgaWYgKCFlcnIpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgZXJyID0gaWd0
X2NoZWNrX2Jsb2NrcygmbW0sICZibG9ja3MsIHRvdGFsLCBmYWxzZSk7Cj4gKwo+ICsgICAgICAg
ICAgICAgICBpOTE1X2J1ZGR5X2ZyZWVfbGlzdCgmbW0sICZibG9ja3MpOwo+ICsKPiArICAgICAg
ICAgICAgICAgaWYgKCFlcnIpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSBpZ3Rf
Y2hlY2tfbW0oJm1tKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJfZXJyKCJwb3N0LW1tIGNoZWNrIGZhaWxlZFxu
Iik7Cj4gKyAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAgICAgIGlmIChlcnIpCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAg
aWYgKGVyciA9PSAtRU5PTUVNKQo+ICsgICAgICAgICAgICAgICBlcnIgPSAwOwo+ICsKPiArICAg
ICAgIGk5MTVfYnVkZHlfZmluaSgmbW0pOwo+ICsKPiArICAgICAgIHJldHVybiBlcnI7Cj4gK30K
PiArCj4gK3N0YXRpYyBpbnQgaWd0X2J1ZGR5X2FsbG9jX3JhbmdlKHZvaWQgKmFyZykKPiArewo+
ICsgICAgICAgc3RydWN0IGk5MTVfYnVkZHlfbW0gbW07Cj4gKyAgICAgICB1bnNpZ25lZCBsb25n
IHBhZ2VfbnVtOwo+ICsgICAgICAgTElTVF9IRUFEKGJsb2Nrcyk7Cj4gKyAgICAgICB1NjQgbWlu
X3NpemU7Cj4gKyAgICAgICB1NjQgb2Zmc2V0Owo+ICsgICAgICAgdTY0IHNpemU7Cj4gKyAgICAg
ICB1NjQgcmVtOwo+ICsgICAgICAgaW50IGVycjsKPiArCj4gKyAgICAgICBpZ3RfbW1fY29uZmln
KCZzaXplLCAmbWluX3NpemUpOwo+ICsKPiArICAgICAgIHByX2luZm8oImJ1ZGR5X2luaXQgd2l0
aCBzaXplPSVsbHgsIG1pbl9zaXplPSVsbHhcbiIsIHNpemUsIG1pbl9zaXplKTsKPiArCj4gKyAg
ICAgICBlcnIgPSBpOTE1X2J1ZGR5X2luaXQoJm1tLCBzaXplLCBtaW5fc2l6ZSk7Cj4gKyAgICAg
ICBpZiAoZXJyKSB7Cj4gKyAgICAgICAgICAgICAgIHByX2VycigiYnVkZHlfaW5pdCBmYWlsZWQo
JWQpXG4iLCBlcnIpOwo+ICsgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ICsgICAgICAgfQo+
ICsKPiArICAgICAgIGVyciA9IGlndF9jaGVja19tbSgmbW0pOwo+ICsgICAgICAgaWYgKGVycikg
ewo+ICsgICAgICAgICAgICAgICBwcl9lcnIoInByZS1tbSBjaGVjayBmYWlsZWQsIGFib3J0LCBh
Ym9ydCwgYWJvcnQhXG4iKTsKPiArICAgICAgICAgICAgICAgZ290byBlcnJfZmluaTsKPiArICAg
ICAgIH0KPiArCj4gKyAgICAgICByZW0gPSBtbS5zaXplOwo+ICsgICAgICAgb2Zmc2V0ID0gMDsK
PiArCj4gKyAgICAgICBmb3JfZWFjaF9wcmltZV9udW1iZXJfZnJvbShwYWdlX251bSwgMSwgVUxP
TkdfTUFYIC0gMSkgewo+ICsgICAgICAgICAgICAgICBzdHJ1Y3QgaTkxNV9idWRkeV9ibG9jayAq
YmxvY2s7Cj4gKyAgICAgICAgICAgICAgIExJU1RfSEVBRCh0bXApOwo+ICsKPiArICAgICAgICAg
ICAgICAgc2l6ZSA9IG1pbihwYWdlX251bSAqIG1tLm1pbl9zaXplLCByZW0pOwo+ICsKPiArICAg
ICAgICAgICAgICAgZXJyID0gaTkxNV9idWRkeV9hbGxvY19yYW5nZSgmbW0sICZ0bXAsIG9mZnNl
dCwgc2l6ZSk7Cj4gKyAgICAgICAgICAgICAgIGlmIChlcnIpIHsKPiArICAgICAgICAgICAgICAg
ICAgICAgICBpZiAoZXJyID09IC1FTk9NRU0pIHsKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHByX2luZm8oImFsbG9jX3JhbmdlIGhpdCAtRU5PTUVNIHdpdGggc2l6ZT0lbGx4XG4i
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplKTsKPiArICAg
ICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugewo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcHJfZXJyKCJhbGxvY19yYW5nZSB3aXRoIG9mZnNldD0lbGx4LCBzaXplPSVsbHggZmFp
bGVkKCVkKVxuIiwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZz
ZXQsIHNpemUsIGVycik7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAg
ICAgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAg
ICAgICAgICAgYmxvY2sgPSBsaXN0X2ZpcnN0X2VudHJ5X29yX251bGwoJnRtcCwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGk5MTVfYnVk
ZHlfYmxvY2ssCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGxpbmspOwo+ICsgICAgICAgICAgICAgICBpZiAoIWJsb2NrKSB7Cj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgcHJfZXJyKCJhbGxvY19yYW5nZSBoYXMgbm8gYmxvY2tzXG4iKTsKPiArICAg
ICAgICAgICAgICAgICAgICAgICBlcnIgPSAtRUlOVkFMOwo+ICsgICAgICAgICAgICAgICB9Cj4g
Kwo+ICsgICAgICAgICAgICAgICBpZiAoaTkxNV9idWRkeV9ibG9ja19vZmZzZXQoYmxvY2spICE9
IG9mZnNldCkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIHByX2VycigiYWxsb2NfcmFuZ2Ug
c3RhcnQgb2Zmc2V0IG1pc21hdGNoLCBmb3VuZD0lbGx4LCBleHBlY3RlZD0lbGx4XG4iLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpOTE1X2J1ZGR5X2Jsb2NrX29mZnNldChibG9j
ayksIG9mZnNldCk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgZXJyID0gLUVJTlZBTDsKPiAr
ICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAgICAgaWYgKCFlcnIpCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgZXJyID0gaWd0X2NoZWNrX2Jsb2NrcygmbW0sICZ0bXAsIHNpemUs
IHRydWUpOwo+ICsKPiArICAgICAgICAgICAgICAgbGlzdF9zcGxpY2VfdGFpbCgmdG1wLCAmYmxv
Y2tzKTsKPiArCj4gKyAgICAgICAgICAgICAgIGlmIChlcnIpCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgYnJlYWs7Cj4gKwo+ICsgICAgICAgICAgICAgICBvZmZzZXQgKz0gc2l6ZTsKPiArCj4g
KyAgICAgICAgICAgICAgIHJlbSAtPSBzaXplOwo+ICsgICAgICAgICAgICAgICBpZiAoIXJlbSkK
PiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgIH0KPiArCj4gKyAgICAg
ICBpZiAoZXJyID09IC1FTk9NRU0pCj4gKyAgICAgICAgICAgICAgIGVyciA9IDA7Cj4gKwo+ICsg
ICAgICAgaTkxNV9idWRkeV9mcmVlX2xpc3QoJm1tLCAmYmxvY2tzKTsKPiArCj4gKyAgICAgICBp
ZiAoIWVycikgewo+ICsgICAgICAgICAgICAgICBlcnIgPSBpZ3RfY2hlY2tfbW0oJm1tKTsKPiAr
ICAgICAgICAgICAgICAgaWYgKGVycikKPiArICAgICAgICAgICAgICAgICAgICAgICBwcl9lcnIo
InBvc3QtbW0gY2hlY2sgZmFpbGVkXG4iKTsKPiArICAgICAgIH0KPiArCj4gK2Vycl9maW5pOgo+
ICsgICAgICAgaTkxNV9idWRkeV9maW5pKCZtbSk7Cj4gKwo+ICsgICAgICAgcmV0dXJuIGVycjsK
PiArfQo+ICsKPiAraW50IGk5MTVfYnVkZHlfbW9ja19zZWxmdGVzdHModm9pZCkKPiArewo+ICsg
ICAgICAgc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3N1YnRlc3QgdGVzdHNbXSA9IHsKPiArICAg
ICAgICAgICAgICAgU1VCVEVTVChpZ3RfYnVkZHlfYWxsb2MpLAo+ICsgICAgICAgICAgICAgICBT
VUJURVNUKGlndF9idWRkeV9hbGxvY19yYW5nZSksCj4gKyAgICAgICB9Owo+ICsKPiArICAgICAg
IHJldHVybiBpOTE1X3N1YnRlc3RzKHRlc3RzLCBOVUxMKTsKPiArfQo+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9tb2NrX3NlbGZ0ZXN0cy5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfbW9ja19zZWxmdGVzdHMuaAo+IGluZGV4
IGI1NWRhNGQ5Y2NiYS4uYjg4MDg0ZmUzMjY5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X21vY2tfc2VsZnRlc3RzLmgKPiArKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9tb2NrX3NlbGZ0ZXN0cy5oCj4gQEAgLTI1LDMgKzI1
LDQgQEAgc2VsZnRlc3QoZXZpY3QsIGk5MTVfZ2VtX2V2aWN0X21vY2tfc2VsZnRlc3RzKQo+ICBz
ZWxmdGVzdChndHQsIGk5MTVfZ2VtX2d0dF9tb2NrX3NlbGZ0ZXN0cykKPiAgc2VsZnRlc3QoaHVn
ZXBhZ2VzLCBpOTE1X2dlbV9odWdlX3BhZ2VfbW9ja19zZWxmdGVzdHMpCj4gIHNlbGZ0ZXN0KGNv
bnRleHRzLCBpOTE1X2dlbV9jb250ZXh0X21vY2tfc2VsZnRlc3RzKQo+ICtzZWxmdGVzdChidWRk
eSwgaTkxNV9idWRkeV9tb2NrX3NlbGZ0ZXN0cykKPiAtLSAKPiAyLjIwLjEKPiAKPiBfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwo+IEludGVsLWdmeCBtYWls
aW5nIGxpc3QKPiBJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCj4gaHR0cHM6Ly9saXN0
cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlz
dApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0
b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

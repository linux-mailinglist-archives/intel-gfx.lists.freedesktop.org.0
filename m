Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7EB8942ED3
	for <lists+intel-gfx@lfdr.de>; Wed, 12 Jun 2019 20:38:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8159D89826;
	Wed, 12 Jun 2019 18:38:11 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B68078981D
 for <intel-gfx@lists.freedesktop.org>; Wed, 12 Jun 2019 18:38:09 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by fmsmga102.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 12 Jun 2019 11:38:09 -0700
X-ExtLoop1: 1
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by fmsmga005.fm.intel.com with ESMTP; 12 Jun 2019 11:38:09 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 12 Jun 2019 11:37:41 -0700
Message-Id: <20190612183748.7693-3-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190612183748.7693-1-daniele.ceraolospurio@intel.com>
References: <20190612183748.7693-1-daniele.ceraolospurio@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2 2/8] drm/i915: Remove rpm asserts that use
 i915
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

UXVpdGUgYSBmZXcgb2YgdGhlIGNhbGwgcG9pbnRzIGhhdmUgYWxyZWFkeSBzd2l0Y2hlZCB0byB0
aGUgdmVyc2lvbgp3b3JraW5nIGRpcmVjdGx5IG9uIHRoZSBydW50aW1lX3BtIHN0cnVjdHVyZSwg
c28gbGV0J3Mgc3dpdGNoIG92ZXIgdGhlCnJlc3QgYW5kIGtpbGwgdGhlIGk5MTUtYmFzZWQgYXNz
ZXJ0cy4KCnYyOiByZWJhc2UKClNpZ25lZC1vZmYtYnk6IERhbmllbGUgQ2VyYW9sbyBTcHVyaW8g
PGRhbmllbGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYyAgIHwgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2
dC9hcGVydHVyZV9nbS5jICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dl
bV9mZW5jZV9yZWcuYyAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYyAg
ICAgICAgICAgIHwgIDYgKystLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMgICAg
ICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jc3IuYyAgICAgICAg
ICAgfCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheV9wb3dlci5jIHwg
IDQgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmggICAgICAgICAgIHwgMjYg
KysrKysrLS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGlt
ZV9wbS5jICAgIHwgMTAgKysrKy0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91bmNv
cmUuYyAgICAgICAgfCAxMiArKysrKy0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF93
YWtlcmVmLmMgICAgICAgfCAgMiArLQogMTEgZmlsZXMgY2hhbmdlZCwgMjkgaW5zZXJ0aW9ucygr
KSwgNDEgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX21tYW4uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFu
LmMKaW5kZXggYzdiOWIzNGRlMDFiLi5jYWE2MWYwOWY3MTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX21tYW4uYwpAQCAtMzA4LDcgKzMwOCw3IEBAIHZtX2ZhdWx0X3QgaTkx
NV9nZW1fZmF1bHQoc3RydWN0IHZtX2ZhdWx0ICp2bWYpCiAJCWdvdG8gZXJyX2ZlbmNlOwogCiAJ
LyogTWFyayBhcyBiZWluZyBtbWFwcGVkIGludG8gdXNlcnNwYWNlIGZvciBsYXRlciByZXZvY2F0
aW9uICovCi0JYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKGk5MTUpOworCWFzc2VydF9ycG1fd2Fr
ZWxvY2tfaGVsZCgmaTkxNS0+cnVudGltZV9wbSk7CiAJaWYgKCFpOTE1X3ZtYV9zZXRfdXNlcmZh
dWx0KHZtYSkgJiYgIW9iai0+dXNlcmZhdWx0X2NvdW50KyspCiAJCWxpc3RfYWRkKCZvYmotPnVz
ZXJmYXVsdF9saW5rLCAmaTkxNS0+bW0udXNlcmZhdWx0X2xpc3QpOwogCWlmIChDT05GSUdfRFJN
X0k5MTVfVVNFUkZBVUxUX0FVVE9TVVNQRU5EKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Z0L2FwZXJ0dXJlX2dtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvYXBlcnR1
cmVfZ20uYwppbmRleCAxZmEyZjY1YzNjZDEuLjdmNGUzNDU2Y2UxMSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2FwZXJ0dXJlX2dtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Z0L2FwZXJ0dXJlX2dtLmMKQEAgLTEzMSw3ICsxMzEsNyBAQCB2b2lkIGludGVsX3Zn
cHVfd3JpdGVfZmVuY2Uoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCiAJc3RydWN0IGRybV9pOTE1
X2ZlbmNlX3JlZyAqcmVnOwogCWk5MTVfcmVnX3QgZmVuY2VfcmVnX2xvLCBmZW5jZV9yZWdfaGk7
CiAKLQlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoZGV2X3ByaXYpOworCWFzc2VydF9ycG1fd2Fr
ZWxvY2tfaGVsZCgmZGV2X3ByaXYtPnJ1bnRpbWVfcG0pOwogCiAJaWYgKFdBUk5fT04oZmVuY2Ug
Pj0gdmdwdV9mZW5jZV9zeih2Z3B1KSkpCiAJCXJldHVybjsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV9nZW1fZmVuY2VfcmVnLmMKaW5kZXggMTBhYTZlMzUwYmZhLi5mMmNlZjNmYTNkZWIgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5jCkBAIC0zNjAsNyArMzYw
LDcgQEAgaTkxNV92bWFfcGluX2ZlbmNlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogCSAqIE5vdGUg
dGhhdCB3ZSByZXZva2UgZmVuY2VzIG9uIHJ1bnRpbWUgc3VzcGVuZC4gVGhlcmVmb3JlIHRoZSB1
c2VyCiAJICogbXVzdCBrZWVwIHRoZSBkZXZpY2UgYXdha2Ugd2hpbHN0IHVzaW5nIHRoZSBmZW5j
ZS4KIAkgKi8KLQlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQodm1hLT52bS0+aTkxNSk7CisJYXNz
ZXJ0X3JwbV93YWtlbG9ja19oZWxkKCZ2bWEtPnZtLT5pOTE1LT5ydW50aW1lX3BtKTsKIAogCS8q
IEp1c3QgdXBkYXRlIG91ciBwbGFjZSBpbiB0aGUgTFJVIGlmIG91ciBmZW5jZSBpcyBnZXR0aW5n
IHJldXNlZC4gKi8KIAlpZiAodm1hLT5mZW5jZSkgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9pcnEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMKaW5k
ZXggMTFjNDUxMzU4ZmI4Li4xZmJhNTY1MmY3NDEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfaXJxLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYwpA
QCAtNTg5LDcgKzU4OSw3IEBAIHZvaWQgZ2VuNl9kaXNhYmxlX3Jwc19pbnRlcnJ1cHRzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogdm9pZCBnZW45X3Jlc2V0X2d1Y19pbnRl
cnJ1cHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQlhc3NlcnRfcnBt
X3dha2Vsb2NrX2hlbGQoZGV2X3ByaXYpOworCWFzc2VydF9ycG1fd2FrZWxvY2tfaGVsZCgmZGV2
X3ByaXYtPnJ1bnRpbWVfcG0pOwogCiAJc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2Nr
KTsKIAlnZW42X3Jlc2V0X3BtX2lpcihkZXZfcHJpdiwgZGV2X3ByaXYtPnBtX2d1Y19ldmVudHMp
OwpAQCAtNTk4LDcgKzU5OCw3IEBAIHZvaWQgZ2VuOV9yZXNldF9ndWNfaW50ZXJydXB0cyhzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAKIHZvaWQgZ2VuOV9lbmFibGVfZ3VjX2lu
dGVycnVwdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCWFzc2VydF9y
cG1fd2FrZWxvY2tfaGVsZChkZXZfcHJpdik7CisJYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKCZk
ZXZfcHJpdi0+cnVudGltZV9wbSk7CiAKIAlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xv
Y2spOwogCWlmICghZGV2X3ByaXYtPmd1Yy5pbnRlcnJ1cHRzLmVuYWJsZWQpIHsKQEAgLTYxMiw3
ICs2MTIsNyBAQCB2b2lkIGdlbjlfZW5hYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKIAogdm9pZCBnZW45X2Rpc2FibGVfZ3VjX2ludGVycnVwdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewotCWFzc2VydF9ycG1fd2FrZWxv
Y2tfaGVsZChkZXZfcHJpdik7CisJYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKCZkZXZfcHJpdi0+
cnVudGltZV9wbSk7CiAKIAlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwogCWRl
dl9wcml2LT5ndWMuaW50ZXJydXB0cy5lbmFibGVkID0gZmFsc2U7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92
bWEuYwppbmRleCA4MDA1MGY2YTA4OTMuLjFmY2RmZGRkZjlhNSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3ZtYS5jCkBAIC0zNjcsNyArMzY3LDcgQEAgdm9pZCBfX2lvbWVtICppOTE1X3ZtYV9waW5faW9t
YXAoc3RydWN0IGk5MTVfdm1hICp2bWEpCiAJaW50IGVycjsKIAogCS8qIEFjY2VzcyB0aHJvdWdo
IHRoZSBHVFQgcmVxdWlyZXMgdGhlIGRldmljZSB0byBiZSBhd2FrZS4gKi8KLQlhc3NlcnRfcnBt
X3dha2Vsb2NrX2hlbGQodm1hLT52bS0+aTkxNSk7CisJYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxk
KCZ2bWEtPnZtLT5pOTE1LT5ydW50aW1lX3BtKTsKIAogCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJnZt
YS0+dm0tPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWlmIChXQVJOX09OKCFpOTE1X3ZtYV9p
c19tYXBfYW5kX2ZlbmNlYWJsZSh2bWEpKSkgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfY3NyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9jc3IuYwppbmRl
eCBiZjBlZWJkMzg1YjkuLjA5NzE1M2M3ZjNkNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfY3NyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfY3NyLmMK
QEAgLTI3Myw3ICsyNzMsNyBAQCB2b2lkIGludGVsX2Nzcl9sb2FkX3Byb2dyYW0oc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCX0KIAogCWZ3X3NpemUgPSBkZXZfcHJpdi0+Y3Ny
LmRtY19md19zaXplOwotCWFzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChkZXZfcHJpdik7CisJYXNz
ZXJ0X3JwbV93YWtlbG9ja19oZWxkKCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAKIAlwcmVlbXB0
X2Rpc2FibGUoKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlz
cGxheV9wb3dlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheV9wb3dlci5j
CmluZGV4IDI3OGE3ZWRjOTRmNS4uMmY5ZjRlMWQ1ODg0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfZGlzcGxheV9wb3dlci5jCkBAIC02OTYsNyArNjk2LDcgQEAgc3RhdGljIHZvaWQg
YXNzZXJ0X2Nhbl9lbmFibGVfZGM1KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
IAogCVdBUk5fT05DRSgoSTkxNV9SRUFEKERDX1NUQVRFX0VOKSAmIERDX1NUQVRFX0VOX1VQVE9f
REM1KSwKIAkJICAiREM1IGFscmVhZHkgcHJvZ3JhbW1lZCB0byBiZSBlbmFibGVkLlxuIik7Ci0J
YXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKGRldl9wcml2KTsKKwlhc3NlcnRfcnBtX3dha2Vsb2Nr
X2hlbGQoJmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAogCWFzc2VydF9jc3JfbG9hZGVkKGRldl9w
cml2KTsKIH0KQEAgLTE4MTQsNyArMTgxNCw3IEBAIHJlbGVhc2VfYXN5bmNfcHV0X2RvbWFpbnMo
c3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucywgdTY0IG1hc2spCiAJICog
d2FrZXJlZiB0byBtYWtlIHRoZSBzdGF0ZSBjaGVja2VyIGhhcHB5IGFib3V0IHRoZSBIVyBhY2Nl
c3MgZHVyaW5nCiAJICogcG93ZXIgd2VsbCBkaXNhYmxpbmcuCiAJICovCi0JYXNzZXJ0X3JwbV9y
YXdfd2FrZXJlZl9oZWxkKGRldl9wcml2KTsKKwlhc3NlcnRfcnBtX3Jhd193YWtlcmVmX2hlbGQo
JmRldl9wcml2LT5ydW50aW1lX3BtKTsKIAl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQo
ZGV2X3ByaXYpOwogCiAJZm9yX2VhY2hfcG93ZXJfZG9tYWluKGRvbWFpbiwgbWFzaykgewpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9kcnYuaAppbmRleCBhZWM0MGFkZjQ4NzYuLmFjMGJkNjA2Nzg2NCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmgKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfZHJ2LmgKQEAgLTE2NDAsNyArMTY0MCw3IEBAIGFzc2VydF9ycG1f
ZGV2aWNlX25vdF9zdXNwZW5kZWQoc3RydWN0IGk5MTVfcnVudGltZV9wbSAqcnBtKQogfQogCiBz
dGF0aWMgaW5saW5lIHZvaWQKLV9fX19hc3NlcnRfcnBtX3Jhd193YWtlcmVmX2hlbGQoc3RydWN0
IGk5MTVfcnVudGltZV9wbSAqcnBtLCBpbnQgd2FrZXJlZl9jb3VudCkKK19fYXNzZXJ0X3JwbV9y
YXdfd2FrZXJlZl9oZWxkKHN0cnVjdCBpOTE1X3J1bnRpbWVfcG0gKnJwbSwgaW50IHdha2VyZWZf
Y291bnQpCiB7CiAJYXNzZXJ0X3JwbV9kZXZpY2Vfbm90X3N1c3BlbmRlZChycG0pOwogCVdBUk5f
T05DRSghaW50ZWxfcnBtX3Jhd193YWtlcmVmX2NvdW50KHdha2VyZWZfY291bnQpLApAQCAtMTY0
OCwzNSArMTY0OCwyMyBAQCBfX19fYXNzZXJ0X3JwbV9yYXdfd2FrZXJlZl9oZWxkKHN0cnVjdCBp
OTE1X3J1bnRpbWVfcG0gKnJwbSwgaW50IHdha2VyZWZfY291bnQpCiB9CiAKIHN0YXRpYyBpbmxp
bmUgdm9pZAotX19fX2Fzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChzdHJ1Y3QgaTkxNV9ydW50aW1l
X3BtICpycG0sIGludCB3YWtlcmVmX2NvdW50KQorX19hc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQo
c3RydWN0IGk5MTVfcnVudGltZV9wbSAqcnBtLCBpbnQgd2FrZXJlZl9jb3VudCkKIHsKLQlfX19f
YXNzZXJ0X3JwbV9yYXdfd2FrZXJlZl9oZWxkKHJwbSwgd2FrZXJlZl9jb3VudCk7CisJX19hc3Nl
cnRfcnBtX3Jhd193YWtlcmVmX2hlbGQocnBtLCB3YWtlcmVmX2NvdW50KTsKIAlXQVJOX09OQ0Uo
IWludGVsX3JwbV93YWtlbG9ja19jb3VudCh3YWtlcmVmX2NvdW50KSwKIAkJICAiUlBNIHdha2Vs
b2NrIHJlZiBub3QgaGVsZCBkdXJpbmcgSFcgYWNjZXNzXG4iKTsKIH0KIAogc3RhdGljIGlubGlu
ZSB2b2lkCi1fX2Fzc2VydF9ycG1fcmF3X3dha2VyZWZfaGVsZChzdHJ1Y3QgaTkxNV9ydW50aW1l
X3BtICpycG0pCithc3NlcnRfcnBtX3Jhd193YWtlcmVmX2hlbGQoc3RydWN0IGk5MTVfcnVudGlt
ZV9wbSAqcnBtKQogewotCV9fX19hc3NlcnRfcnBtX3Jhd193YWtlcmVmX2hlbGQocnBtLCBhdG9t
aWNfcmVhZCgmcnBtLT53YWtlcmVmX2NvdW50KSk7CisJX19hc3NlcnRfcnBtX3Jhd193YWtlcmVm
X2hlbGQocnBtLCBhdG9taWNfcmVhZCgmcnBtLT53YWtlcmVmX2NvdW50KSk7CiB9CiAKIHN0YXRp
YyBpbmxpbmUgdm9pZAotYXNzZXJ0X3JwbV9yYXdfd2FrZXJlZl9oZWxkKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQorYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKHN0cnVjdCBpOTE1X3J1
bnRpbWVfcG0gKnJwbSkKIHsKLQlfX2Fzc2VydF9ycG1fcmF3X3dha2VyZWZfaGVsZCgmaTkxNS0+
cnVudGltZV9wbSk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZAotX19hc3NlcnRfcnBtX3dha2Vs
b2NrX2hlbGQoc3RydWN0IGk5MTVfcnVudGltZV9wbSAqcnBtKQotewotCV9fX19hc3NlcnRfcnBt
X3dha2Vsb2NrX2hlbGQocnBtLCBhdG9taWNfcmVhZCgmcnBtLT53YWtlcmVmX2NvdW50KSk7Ci19
Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZAotYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQotewotCV9fYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKCZp
OTE1LT5ydW50aW1lX3BtKTsKKwlfX2Fzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChycG0sIGF0b21p
Y19yZWFkKCZycG0tPndha2VyZWZfY291bnQpKTsKIH0KIAogLyoqCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ydW50aW1lX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9ydW50aW1lX3BtLmMKaW5kZXggN2M2MDJmNWM3NDhkLi5hZTYwYWUxYzk3MGUgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3J1bnRpbWVfcG0uYworKysgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ydW50aW1lX3BtLmMKQEAgLTMzNSwxMCArMzM1LDEw
IEBAIGludGVsX3J1bnRpbWVfcG1fYWNxdWlyZShzdHJ1Y3QgaTkxNV9ydW50aW1lX3BtICpycG0s
IGJvb2wgd2FrZWxvY2spCiB7CiAJaWYgKHdha2Vsb2NrKSB7CiAJCWF0b21pY19hZGQoMSArIElO
VEVMX1JQTV9XQUtFTE9DS19CSUFTLCAmcnBtLT53YWtlcmVmX2NvdW50KTsKLQkJX19hc3NlcnRf
cnBtX3dha2Vsb2NrX2hlbGQocnBtKTsKKwkJYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKHJwbSk7
CiAJfSBlbHNlIHsKIAkJYXRvbWljX2luYygmcnBtLT53YWtlcmVmX2NvdW50KTsKLQkJX19hc3Nl
cnRfcnBtX3Jhd193YWtlcmVmX2hlbGQocnBtKTsKKwkJYXNzZXJ0X3JwbV9yYXdfd2FrZXJlZl9o
ZWxkKHJwbSk7CiAJfQogfQogCkBAIC0zNDYsMTAgKzM0NiwxMCBAQCBzdGF0aWMgdm9pZAogaW50
ZWxfcnVudGltZV9wbV9yZWxlYXNlKHN0cnVjdCBpOTE1X3J1bnRpbWVfcG0gKnJwbSwgaW50IHdh
a2Vsb2NrKQogewogCWlmICh3YWtlbG9jaykgewotCQlfX2Fzc2VydF9ycG1fd2FrZWxvY2tfaGVs
ZChycG0pOworCQlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQocnBtKTsKIAkJYXRvbWljX3N1YihJ
TlRFTF9SUE1fV0FLRUxPQ0tfQklBUywgJnJwbS0+d2FrZXJlZl9jb3VudCk7CiAJfSBlbHNlIHsK
LQkJX19hc3NlcnRfcnBtX3Jhd193YWtlcmVmX2hlbGQocnBtKTsKKwkJYXNzZXJ0X3JwbV9yYXdf
d2FrZXJlZl9oZWxkKHJwbSk7CiAJfQogCiAJX19pbnRlbF93YWtlcmVmX2RlY19hbmRfY2hlY2tf
dHJhY2tpbmcocnBtKTsKQEAgLTQ2NSw3ICs0NjUsNyBAQCBpbnRlbF93YWtlcmVmX3QgaW50ZWxf
cnVudGltZV9wbV9nZXRfbm9yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7
CiAJc3RydWN0IGk5MTVfcnVudGltZV9wbSAqcnBtID0gJmk5MTUtPnJ1bnRpbWVfcG07CiAKLQlf
X2Fzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChycG0pOworCWFzc2VydF9ycG1fd2FrZWxvY2tfaGVs
ZChycG0pOwogCXBtX3J1bnRpbWVfZ2V0X25vcmVzdW1lKHJwbS0+a2Rldik7CiAKIAlpbnRlbF9y
dW50aW1lX3BtX2FjcXVpcmUocnBtLCB0cnVlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX3VuY29yZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfdW5jb3Jl
LmMKaW5kZXggODUxNzFhOGI4NjZhLi5lMWRlNTFjNGQ4NGQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX3VuY29yZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX3VuY29yZS5jCkBAIC01ODMsNyArNTgzLDcgQEAgdm9pZCBpbnRlbF91bmNvcmVfZm9yY2V3
YWtlX2dldChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUsCiAJaWYgKCF1bmNvcmUtPmZ1bmNz
LmZvcmNlX3dha2VfZ2V0KQogCQlyZXR1cm47CiAKLQlfX2Fzc2VydF9ycG1fd2FrZWxvY2tfaGVs
ZCh1bmNvcmUtPnJwbSk7CisJYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKHVuY29yZS0+cnBtKTsK
IAogCXNwaW5fbG9ja19pcnFzYXZlKCZ1bmNvcmUtPmxvY2ssIGlycWZsYWdzKTsKIAlfX2ludGVs
X3VuY29yZV9mb3JjZXdha2VfZ2V0KHVuY29yZSwgZndfZG9tYWlucyk7CkBAIC03MzcsNyArNzM3
LDcgQEAgdm9pZCBhc3NlcnRfZm9yY2V3YWtlc19hY3RpdmUoc3RydWN0IGludGVsX3VuY29yZSAq
dW5jb3JlLAogCWlmICghdW5jb3JlLT5mdW5jcy5mb3JjZV93YWtlX2dldCkKIAkJcmV0dXJuOwog
Ci0JX19hc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQodW5jb3JlLT5ycG0pOworCWFzc2VydF9ycG1f
d2FrZWxvY2tfaGVsZCh1bmNvcmUtPnJwbSk7CiAKIAlmd19kb21haW5zICY9IHVuY29yZS0+Zndf
ZG9tYWluczsKIAlXQVJOKGZ3X2RvbWFpbnMgJiB+dW5jb3JlLT5md19kb21haW5zX2FjdGl2ZSwK
QEAgLTEwNTQsNyArMTA1NCw3IEBAIHVuY2xhaW1lZF9yZWdfZGVidWcoc3RydWN0IGludGVsX3Vu
Y29yZSAqdW5jb3JlLAogCiAjZGVmaW5lIEdFTjJfUkVBRF9IRUFERVIoeCkgXAogCXUjI3ggdmFs
ID0gMDsgXAotCV9fYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKHVuY29yZS0+cnBtKTsKKwlhc3Nl
cnRfcnBtX3dha2Vsb2NrX2hlbGQodW5jb3JlLT5ycG0pOwogCiAjZGVmaW5lIEdFTjJfUkVBRF9G
T09URVIgXAogCXRyYWNlX2k5MTVfcmVnX3J3KGZhbHNlLCByZWcsIHZhbCwgc2l6ZW9mKHZhbCks
IHRyYWNlKTsgXApAQCAtMTA5Niw3ICsxMDk2LDcgQEAgX19nZW4yX3JlYWQoNjQpCiAJdTMyIG9m
ZnNldCA9IGk5MTVfbW1pb19yZWdfb2Zmc2V0KHJlZyk7IFwKIAl1bnNpZ25lZCBsb25nIGlycWZs
YWdzOyBcCiAJdSMjeCB2YWwgPSAwOyBcCi0JX19hc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQodW5j
b3JlLT5ycG0pOyBcCisJYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKHVuY29yZS0+cnBtKTsgXAog
CXNwaW5fbG9ja19pcnFzYXZlKCZ1bmNvcmUtPmxvY2ssIGlycWZsYWdzKTsgXAogCXVuY2xhaW1l
ZF9yZWdfZGVidWcodW5jb3JlLCByZWcsIHRydWUsIHRydWUpCiAKQEAgLTExNzAsNyArMTE3MCw3
IEBAIF9fZ2VuNl9yZWFkKDY0KQogCiAjZGVmaW5lIEdFTjJfV1JJVEVfSEVBREVSIFwKIAl0cmFj
ZV9pOTE1X3JlZ19ydyh0cnVlLCByZWcsIHZhbCwgc2l6ZW9mKHZhbCksIHRyYWNlKTsgXAotCV9f
YXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKHVuY29yZS0+cnBtKTsgXAorCWFzc2VydF9ycG1fd2Fr
ZWxvY2tfaGVsZCh1bmNvcmUtPnJwbSk7IFwKIAogI2RlZmluZSBHRU4yX1dSSVRFX0ZPT1RFUgog
CkBAIC0xMjA4LDcgKzEyMDgsNyBAQCBfX2dlbjJfd3JpdGUoMzIpCiAJdTMyIG9mZnNldCA9IGk5
MTVfbW1pb19yZWdfb2Zmc2V0KHJlZyk7IFwKIAl1bnNpZ25lZCBsb25nIGlycWZsYWdzOyBcCiAJ
dHJhY2VfaTkxNV9yZWdfcncodHJ1ZSwgcmVnLCB2YWwsIHNpemVvZih2YWwpLCB0cmFjZSk7IFwK
LQlfX2Fzc2VydF9ycG1fd2FrZWxvY2tfaGVsZCh1bmNvcmUtPnJwbSk7IFwKKwlhc3NlcnRfcnBt
X3dha2Vsb2NrX2hlbGQodW5jb3JlLT5ycG0pOyBcCiAJc3Bpbl9sb2NrX2lycXNhdmUoJnVuY29y
ZS0+bG9jaywgaXJxZmxhZ3MpOyBcCiAJdW5jbGFpbWVkX3JlZ19kZWJ1Zyh1bmNvcmUsIHJlZywg
ZmFsc2UsIHRydWUpCiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3dh
a2VyZWYuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3dha2VyZWYuYwppbmRleCBjMjVi
YTFiNWU4YmEuLmI2YzcxNjdjZTE1NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfd2FrZXJlZi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3dha2VyZWYu
YwpAQCAtMTEwLDcgKzExMCw3IEBAIHZvaWQgaW50ZWxfd2FrZXJlZl9hdXRvKHN0cnVjdCBpbnRl
bF93YWtlcmVmX2F1dG8gKndmLCB1bnNpZ25lZCBsb25nIHRpbWVvdXQpCiAJfQogCiAJLyogT3Vy
IG1pc3Npb24gaXMgdGhhdCB3ZSBvbmx5IGV4dGVuZCBhbiBhbHJlYWR5IGFjdGl2ZSB3YWtlcmVm
ICovCi0JYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKHdmLT5pOTE1KTsKKwlhc3NlcnRfcnBtX3dh
a2Vsb2NrX2hlbGQoJndmLT5pOTE1LT5ydW50aW1lX3BtKTsKIAogCWlmICghcmVmY291bnRfaW5j
X25vdF96ZXJvKCZ3Zi0+Y291bnQpKSB7CiAJCXNwaW5fbG9ja19pcnFzYXZlKCZ3Zi0+bG9jaywg
ZmxhZ3MpOwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9p
bnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 355C78940F
	for <lists+intel-gfx@lfdr.de>; Sun, 11 Aug 2019 23:06:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DC5C689DC2;
	Sun, 11 Aug 2019 21:06:49 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 4E38789DC2
 for <intel-gfx@lists.freedesktop.org>; Sun, 11 Aug 2019 21:06:48 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 17962810-1500050 
 for multiple; Sun, 11 Aug 2019 22:06:35 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sun, 11 Aug 2019 22:06:33 +0100
Message-Id: <20190811210633.18417-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0.rc1
In-Reply-To: <20190811142801.2460-2-chris@chris-wilson.co.uk>
References: <20190811142801.2460-2-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Extract general GT interrupt handlers
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+CgppOTE1X2lycS5jIGlzIGxh
cmdlLiBJdCBzZXJ2ZXMgYXMgdGhlIGNlbnRyYWwgZGlzcGF0Y2ggYW5kIGhhbmRsZXIgZm9yCmFs
bCBvZiBvdXIgZGV2aWNlIGludGVycnVwdHMuIExldHMgYnJlYWsgaXQgdXAgYnkgcHVsbGluZyBv
dXQgdGhlIEdUCmludGVycnVwdCBoYW5kbGVycy4KCkJhc2VkIG9uIGEgcGF0Y2ggYnkgQ2hyaXMg
V2lsc29uLgoKU2lnbmVkLW9mZi1ieTogQW5kaSBTaHl0aSA8YW5kaS5zaHl0aUBpbnRlbC5jb20+
Ci0tLQpSZXN0b3JlIHJwcyBpbml0OyBycHMgaXMgbm90IG1vdmVkIHVudGlsIHRoZSBuZXh0IHBh
dGNoLgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAgICAgICAgfCAg
IDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfYnJlYWRjcnVtYnMuYyB8ICAgOCAr
LQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfaXJxLmMgICAgICB8IDQ1NSArKysr
KysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X2lycS5oICAgICAg
fCAgNDQgKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtX2lycS5jICAgfCAg
IDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaCAgICB8ICAgMSAr
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMgIHwgICA5ICstCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAgICAgICAgICAgIHwgICAxIC0KIGRyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMgICAgICAgICAgICAgfCA1NzcgKystLS0tLS0tLS0t
LS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmggICAgICAgICAgICAgfCAg
NDcgKysKIDEwIGZpbGVzIGNoYW5nZWQsIDU5MyBpbnNlcnRpb25zKCspLCA1NTEgZGVsZXRpb25z
KC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3Rf
aXJxLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9n
dF9pcnEuaAoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKaW5kZXggZDIyNjY1OWZkYmIzLi40NWFkZDgxMjA0
OGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCkBAIC03OSw2ICs3OSw3IEBAIGd0LXkgKz0gXAogCWd0
L2ludGVsX2VuZ2luZV9wbS5vIFwKIAlndC9pbnRlbF9lbmdpbmVfdXNlci5vIFwKIAlndC9pbnRl
bF9ndC5vIFwKKwlndC9pbnRlbF9ndF9pcnEubyBcCiAJZ3QvaW50ZWxfZ3RfcG0ubyBcCiAJZ3Qv
aW50ZWxfZ3RfcG1faXJxLm8gXAogCWd0L2ludGVsX2hhbmdjaGVjay5vIFwKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9icmVhZGNydW1icy5jCmluZGV4IGUxYmJjOWI0MjhjZC4uY2Vi
YTFkYTYxOTY3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9icmVh
ZGNydW1icy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJz
LmMKQEAgLTM1LDkgKzM1LDkgQEAgc3RhdGljIHZvaWQgaXJxX2VuYWJsZShzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCiAJCXJldHVybjsKIAogCS8qIENhbGxlciBkaXNhYmxlcyBpbnRl
cnJ1cHRzICovCi0Jc3Bpbl9sb2NrKCZlbmdpbmUtPmk5MTUtPmlycV9sb2NrKTsKKwlzcGluX2xv
Y2soJmVuZ2luZS0+Z3QtPmlycV9sb2NrKTsKIAllbmdpbmUtPmlycV9lbmFibGUoZW5naW5lKTsK
LQlzcGluX3VubG9jaygmZW5naW5lLT5pOTE1LT5pcnFfbG9jayk7CisJc3Bpbl91bmxvY2soJmVu
Z2luZS0+Z3QtPmlycV9sb2NrKTsKIH0KIAogc3RhdGljIHZvaWQgaXJxX2Rpc2FibGUoc3RydWN0
IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQpAQCAtNDYsOSArNDYsOSBAQCBzdGF0aWMgdm9pZCBp
cnFfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCXJldHVybjsKIAog
CS8qIENhbGxlciBkaXNhYmxlcyBpbnRlcnJ1cHRzICovCi0Jc3Bpbl9sb2NrKCZlbmdpbmUtPmk5
MTUtPmlycV9sb2NrKTsKKwlzcGluX2xvY2soJmVuZ2luZS0+Z3QtPmlycV9sb2NrKTsKIAllbmdp
bmUtPmlycV9kaXNhYmxlKGVuZ2luZSk7Ci0Jc3Bpbl91bmxvY2soJmVuZ2luZS0+aTkxNS0+aXJx
X2xvY2spOworCXNwaW5fdW5sb2NrKCZlbmdpbmUtPmd0LT5pcnFfbG9jayk7CiB9CiAKIHN0YXRp
YyB2b2lkIF9faW50ZWxfYnJlYWRjcnVtYnNfZGlzYXJtX2lycShzdHJ1Y3QgaW50ZWxfYnJlYWRj
cnVtYnMgKmIpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndF9p
cnEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X2lycS5jCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMzRhNGZiNjI0YmY3Ci0tLSAvZGV2L251bGwK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfaXJxLmMKQEAgLTAsMCArMSw0
NTUgQEAKKy8qCisgKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUCisgKgorICogQ29weXJp
Z2h0IMKpIDIwMTkgSW50ZWwgQ29ycG9yYXRpb24KKyAqLworCisjaW5jbHVkZSA8bGludXgvc2No
ZWQvY2xvY2suaD4KKworI2luY2x1ZGUgImk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaTkxNV9pcnEu
aCIKKyNpbmNsdWRlICJpbnRlbF9ndC5oIgorI2luY2x1ZGUgImludGVsX2d0X2lycS5oIgorI2lu
Y2x1ZGUgImludGVsX3VuY29yZS5oIgorCitzdGF0aWMgdm9pZCBndWNfaXJxX2hhbmRsZXIoc3Ry
dWN0IGludGVsX2d1YyAqZ3VjLCB1MTYgaWlyKQoreworCWlmIChpaXIgJiBHVUNfSU5UUl9HVUMy
SE9TVCkKKwkJaW50ZWxfZ3VjX3RvX2hvc3RfZXZlbnRfaGFuZGxlcihndWMpOworfQorCitzdGF0
aWMgdm9pZAorY3NfaXJxX2hhbmRsZXIoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1
MzIgaWlyKQoreworCWJvb2wgdGFza2xldCA9IGZhbHNlOworCisJaWYgKGlpciAmIEdUX0NPTlRF
WFRfU1dJVENIX0lOVEVSUlVQVCkKKwkJdGFza2xldCA9IHRydWU7CisKKwlpZiAoaWlyICYgR1Rf
UkVOREVSX1VTRVJfSU5URVJSVVBUKSB7CisJCWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEo
ZW5naW5lKTsKKwkJdGFza2xldCB8PSBpbnRlbF9lbmdpbmVfbmVlZHNfYnJlYWRjcnVtYl90YXNr
bGV0KGVuZ2luZSk7CisJfQorCisJaWYgKHRhc2tsZXQpCisJCXRhc2tsZXRfaGlfc2NoZWR1bGUo
JmVuZ2luZS0+ZXhlY2xpc3RzLnRhc2tsZXQpOworfQorCitzdGF0aWMgdTMyCitnZW4xMV9ndF9l
bmdpbmVfaWRlbnRpdHkoc3RydWN0IGludGVsX2d0ICpndCwKKwkJCSBjb25zdCB1bnNpZ25lZCBp
bnQgYmFuaywgY29uc3QgdW5zaWduZWQgaW50IGJpdCkKK3sKKwl2b2lkIF9faW9tZW0gKiBjb25z
dCByZWdzID0gZ3QtPnVuY29yZS0+cmVnczsKKwl1MzIgdGltZW91dF90czsKKwl1MzIgaWRlbnQ7
CisKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZndC0+aXJxX2xvY2spOworCisJcmF3X3JlZ193cml0
ZShyZWdzLCBHRU4xMV9JSVJfUkVHX1NFTEVDVE9SKGJhbmspLCBCSVQoYml0KSk7CisKKwkvKgor
CSAqIE5COiBTcGVjcyBkbyBub3Qgc3BlY2lmeSBob3cgbG9uZyB0byBzcGluIHdhaXQsCisJICog
c28gd2UgZG8gfjEwMHVzIGFzIGFuIGVkdWNhdGVkIGd1ZXNzLgorCSAqLworCXRpbWVvdXRfdHMg
PSAobG9jYWxfY2xvY2soKSA+PiAxMCkgKyAxMDA7CisJZG8geworCQlpZGVudCA9IHJhd19yZWdf
cmVhZChyZWdzLCBHRU4xMV9JTlRSX0lERU5USVRZX1JFRyhiYW5rKSk7CisJfSB3aGlsZSAoIShp
ZGVudCAmIEdFTjExX0lOVFJfREFUQV9WQUxJRCkgJiYKKwkJICF0aW1lX2FmdGVyMzIobG9jYWxf
Y2xvY2soKSA+PiAxMCwgdGltZW91dF90cykpOworCisJaWYgKHVubGlrZWx5KCEoaWRlbnQgJiBH
RU4xMV9JTlRSX0RBVEFfVkFMSUQpKSkgeworCQlEUk1fRVJST1IoIklOVFJfSURFTlRJVFlfUkVH
JXU6JXUgMHglMDh4IG5vdCB2YWxpZCFcbiIsCisJCQkgIGJhbmssIGJpdCwgaWRlbnQpOworCQly
ZXR1cm4gMDsKKwl9CisKKwlyYXdfcmVnX3dyaXRlKHJlZ3MsIEdFTjExX0lOVFJfSURFTlRJVFlf
UkVHKGJhbmspLAorCQkgICAgICBHRU4xMV9JTlRSX0RBVEFfVkFMSUQpOworCisJcmV0dXJuIGlk
ZW50OworfQorCitzdGF0aWMgdm9pZAorZ2VuMTFfb3RoZXJfaXJxX2hhbmRsZXIoc3RydWN0IGlu
dGVsX2d0ICpndCwgY29uc3QgdTggaW5zdGFuY2UsCisJCQljb25zdCB1MTYgaWlyKQoreworCWlm
IChpbnN0YW5jZSA9PSBPVEhFUl9HVUNfSU5TVEFOQ0UpCisJCXJldHVybiBndWNfaXJxX2hhbmRs
ZXIoJmd0LT51Yy5ndWMsIGlpcik7CisKKwlpZiAoaW5zdGFuY2UgPT0gT1RIRVJfR1RQTV9JTlNU
QU5DRSkKKwkJcmV0dXJuIGdlbjExX3Jwc19pcnFfaGFuZGxlcihndCwgaWlyKTsKKworCVdBUk5f
T05DRSgxLCAidW5oYW5kbGVkIG90aGVyIGludGVycnVwdCBpbnN0YW5jZT0weCV4LCBpaXI9MHgl
eFxuIiwKKwkJICBpbnN0YW5jZSwgaWlyKTsKK30KKworc3RhdGljIHZvaWQKK2dlbjExX2VuZ2lu
ZV9pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBjb25zdCB1OCBjbGFzcywKKwkJCSBj
b25zdCB1OCBpbnN0YW5jZSwgY29uc3QgdTE2IGlpcikKK3sKKwlzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmU7CisKKwlpZiAoaW5zdGFuY2UgPD0gTUFYX0VOR0lORV9JTlNUQU5DRSkKKwkJ
ZW5naW5lID0gZ3QtPmVuZ2luZV9jbGFzc1tjbGFzc11baW5zdGFuY2VdOworCWVsc2UKKwkJZW5n
aW5lID0gTlVMTDsKKworCWlmIChsaWtlbHkoZW5naW5lKSkKKwkJcmV0dXJuIGNzX2lycV9oYW5k
bGVyKGVuZ2luZSwgaWlyKTsKKworCVdBUk5fT05DRSgxLCAidW5oYW5kbGVkIGVuZ2luZSBpbnRl
cnJ1cHQgY2xhc3M9MHgleCwgaW5zdGFuY2U9MHgleFxuIiwKKwkJICBjbGFzcywgaW5zdGFuY2Up
OworfQorCitzdGF0aWMgdm9pZAorZ2VuMTFfZ3RfaWRlbnRpdHlfaGFuZGxlcihzdHJ1Y3QgaW50
ZWxfZ3QgKmd0LCBjb25zdCB1MzIgaWRlbnRpdHkpCit7CisJY29uc3QgdTggY2xhc3MgPSBHRU4x
MV9JTlRSX0VOR0lORV9DTEFTUyhpZGVudGl0eSk7CisJY29uc3QgdTggaW5zdGFuY2UgPSBHRU4x
MV9JTlRSX0VOR0lORV9JTlNUQU5DRShpZGVudGl0eSk7CisJY29uc3QgdTE2IGludHIgPSBHRU4x
MV9JTlRSX0VOR0lORV9JTlRSKGlkZW50aXR5KTsKKworCWlmICh1bmxpa2VseSghaW50cikpCisJ
CXJldHVybjsKKworCWlmIChjbGFzcyA8PSBDT1BZX0VOR0lORV9DTEFTUykKKwkJcmV0dXJuIGdl
bjExX2VuZ2luZV9pcnFfaGFuZGxlcihndCwgY2xhc3MsIGluc3RhbmNlLCBpbnRyKTsKKworCWlm
IChjbGFzcyA9PSBPVEhFUl9DTEFTUykKKwkJcmV0dXJuIGdlbjExX290aGVyX2lycV9oYW5kbGVy
KGd0LCBpbnN0YW5jZSwgaW50cik7CisKKwlXQVJOX09OQ0UoMSwgInVua25vd24gaW50ZXJydXB0
IGNsYXNzPTB4JXgsIGluc3RhbmNlPTB4JXgsIGludHI9MHgleFxuIiwKKwkJICBjbGFzcywgaW5z
dGFuY2UsIGludHIpOworfQorCitzdGF0aWMgdm9pZAorZ2VuMTFfZ3RfYmFua19oYW5kbGVyKHN0
cnVjdCBpbnRlbF9ndCAqZ3QsIGNvbnN0IHVuc2lnbmVkIGludCBiYW5rKQoreworCXZvaWQgX19p
b21lbSAqIGNvbnN0IHJlZ3MgPSBndC0+dW5jb3JlLT5yZWdzOworCXVuc2lnbmVkIGxvbmcgaW50
cl9kdzsKKwl1bnNpZ25lZCBpbnQgYml0OworCisJbG9ja2RlcF9hc3NlcnRfaGVsZCgmZ3QtPmly
cV9sb2NrKTsKKworCWludHJfZHcgPSByYXdfcmVnX3JlYWQocmVncywgR0VOMTFfR1RfSU5UUl9E
VyhiYW5rKSk7CisKKwlmb3JfZWFjaF9zZXRfYml0KGJpdCwgJmludHJfZHcsIDMyKSB7CisJCWNv
bnN0IHUzMiBpZGVudCA9IGdlbjExX2d0X2VuZ2luZV9pZGVudGl0eShndCwgYmFuaywgYml0KTsK
KworCQlnZW4xMV9ndF9pZGVudGl0eV9oYW5kbGVyKGd0LCBpZGVudCk7CisJfQorCisJLyogQ2xl
YXIgbXVzdCBiZSBhZnRlciBzaGFyZWQgaGFzIGJlZW4gc2VydmVkIGZvciBlbmdpbmUgKi8KKwly
YXdfcmVnX3dyaXRlKHJlZ3MsIEdFTjExX0dUX0lOVFJfRFcoYmFuayksIGludHJfZHcpOworfQor
Cit2b2lkIGdlbjExX2d0X2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGNvbnN0IHUz
MiBtYXN0ZXJfY3RsKQoreworCXVuc2lnbmVkIGludCBiYW5rOworCisJc3Bpbl9sb2NrKCZndC0+
aXJxX2xvY2spOworCisJZm9yIChiYW5rID0gMDsgYmFuayA8IDI7IGJhbmsrKykgeworCQlpZiAo
bWFzdGVyX2N0bCAmIEdFTjExX0dUX0RXX0lSUShiYW5rKSkKKwkJCWdlbjExX2d0X2JhbmtfaGFu
ZGxlcihndCwgYmFuayk7CisJfQorCisJc3Bpbl91bmxvY2soJmd0LT5pcnFfbG9jayk7Cit9CisK
K2Jvb2wgZ2VuMTFfZ3RfcmVzZXRfb25lX2lpcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAorCQkJICAg
IGNvbnN0IHVuc2lnbmVkIGludCBiYW5rLCBjb25zdCB1bnNpZ25lZCBpbnQgYml0KQoreworCXZv
aWQgX19pb21lbSAqIGNvbnN0IHJlZ3MgPSBndC0+dW5jb3JlLT5yZWdzOworCXUzMiBkdzsKKwor
CWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmd0LT5pcnFfbG9jayk7CisKKwlkdyA9IHJhd19yZWdfcmVh
ZChyZWdzLCBHRU4xMV9HVF9JTlRSX0RXKGJhbmspKTsKKwlpZiAoZHcgJiBCSVQoYml0KSkgewor
CQkvKgorCQkgKiBBY2NvcmRpbmcgdG8gdGhlIEJTcGVjLCBEV19JSVIgYml0cyBjYW5ub3QgYmUg
Y2xlYXJlZCB3aXRob3V0CisJCSAqIGZpcnN0IHNlcnZpY2luZyB0aGUgU2VsZWN0b3IgJiBTaGFy
ZWQgSUlSIHJlZ2lzdGVycy4KKwkJICovCisJCWdlbjExX2d0X2VuZ2luZV9pZGVudGl0eShndCwg
YmFuaywgYml0KTsKKworCQkvKgorCQkgKiBXZSBsb2NrZWQgR1QgSU5UIERXIGJ5IHJlYWRpbmcg
aXQuIElmIHdlIHdhbnQgdG8gKHRyeQorCQkgKiB0bykgcmVjb3ZlciBmcm9tIHRoaXMgc3VjY2Vz
c2Z1bGx5LCB3ZSBuZWVkIHRvIGNsZWFyCisJCSAqIG91ciBiaXQsIG90aGVyd2lzZSB3ZSBhcmUg
bG9ja2luZyB0aGUgcmVnaXN0ZXIgZm9yCisJCSAqIGV2ZXJ5Ym9keS4KKwkJICovCisJCXJhd19y
ZWdfd3JpdGUocmVncywgR0VOMTFfR1RfSU5UUl9EVyhiYW5rKSwgQklUKGJpdCkpOworCisJCXJl
dHVybiB0cnVlOworCX0KKworCXJldHVybiBmYWxzZTsKK30KKwordm9pZCBnZW4xMV9ndF9pcnFf
cmVzZXQoc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNv
cmUgPSBndC0+dW5jb3JlOworCisJLyogRGlzYWJsZSBSQ1MsIEJDUywgVkNTIGFuZCBWRUNTIGNs
YXNzIGVuZ2luZXMuICovCisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfUkVOREVS
X0NPUFlfSU5UUl9FTkFCTEUsIDApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjEx
X1ZDU19WRUNTX0lOVFJfRU5BQkxFLAkgIDApOworCisJLyogUmVzdG9yZSBtYXNrcyBpcnFzIG9u
IFJDUywgQkNTLCBWQ1MgYW5kIFZFQ1MgZW5naW5lcy4gKi8KKwlpbnRlbF91bmNvcmVfd3JpdGUo
dW5jb3JlLCBHRU4xMV9SQ1MwX1JTVkRfSU5UUl9NQVNLLAl+MCk7CisJaW50ZWxfdW5jb3JlX3dy
aXRlKHVuY29yZSwgR0VOMTFfQkNTX1JTVkRfSU5UUl9NQVNLLAl+MCk7CisJaW50ZWxfdW5jb3Jl
X3dyaXRlKHVuY29yZSwgR0VOMTFfVkNTMF9WQ1MxX0lOVFJfTUFTSywJfjApOworCWludGVsX3Vu
Y29yZV93cml0ZSh1bmNvcmUsIEdFTjExX1ZDUzJfVkNTM19JTlRSX01BU0ssCX4wKTsKKwlpbnRl
bF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9WRUNTMF9WRUNTMV9JTlRSX01BU0ssCX4wKTsK
KworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dQTV9XR0JPWFBFUkZfSU5UUl9F
TkFCTEUsIDApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dQTV9XR0JPWFBF
UkZfSU5UUl9NQVNLLCAgfjApOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dV
Q19TR19JTlRSX0VOQUJMRSwgMCk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFf
R1VDX1NHX0lOVFJfTUFTSywgIH4wKTsKK30KKwordm9pZCBnZW4xMV9ndF9pcnFfcG9zdGluc3Rh
bGwoc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwljb25zdCB1MzIgaXJxcyA9IEdUX1JFTkRFUl9V
U0VSX0lOVEVSUlVQVCB8IEdUX0NPTlRFWFRfU1dJVENIX0lOVEVSUlVQVDsKKwlzdHJ1Y3QgaW50
ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3JlOworCWNvbnN0IHUzMiBkbWFzayA9IGlycXMg
PDwgMTYgfCBpcnFzOworCWNvbnN0IHUzMiBzbWFzayA9IGlycXMgPDwgMTY7CisKKwlCVUlMRF9C
VUdfT04oaXJxcyAmIDB4ZmZmZjAwMDApOworCisJLyogRW5hYmxlIFJDUywgQkNTLCBWQ1MgYW5k
IFZFQ1MgY2xhc3MgaW50ZXJydXB0cy4gKi8KKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBH
RU4xMV9SRU5ERVJfQ09QWV9JTlRSX0VOQUJMRSwgZG1hc2spOworCWludGVsX3VuY29yZV93cml0
ZSh1bmNvcmUsIEdFTjExX1ZDU19WRUNTX0lOVFJfRU5BQkxFLCBkbWFzayk7CisKKwkvKiBVbm1h
c2sgaXJxcyBvbiBSQ1MsIEJDUywgVkNTIGFuZCBWRUNTIGVuZ2luZXMuICovCisJaW50ZWxfdW5j
b3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfUkNTMF9SU1ZEX0lOVFJfTUFTSywgfnNtYXNrKTsKKwlp
bnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9CQ1NfUlNWRF9JTlRSX01BU0ssIH5zbWFz
ayk7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfVkNTMF9WQ1MxX0lOVFJfTUFT
SywgfmRtYXNrKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9WQ1MyX1ZDUzNf
SU5UUl9NQVNLLCB+ZG1hc2spOworCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX1ZF
Q1MwX1ZFQ1MxX0lOVFJfTUFTSywgfmRtYXNrKTsKKworCS8qCisJICogUlBTIGludGVycnVwdHMg
d2lsbCBnZXQgZW5hYmxlZC9kaXNhYmxlZCBvbiBkZW1hbmQgd2hlbiBSUFMgaXRzZWxmCisJICog
aXMgZW5hYmxlZC9kaXNhYmxlZC4KKwkgKi8KKwlndC0+cG1faWVyID0gMHgwOworCWd0LT5wbV9p
bXIgPSB+Z3QtPnBtX2llcjsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9HUE1f
V0dCT1hQRVJGX0lOVFJfRU5BQkxFLCAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBH
RU4xMV9HUE1fV0dCT1hQRVJGX0lOVFJfTUFTSywgIH4wKTsKKworCS8qIFNhbWUgdGhpbmcgZm9y
IEd1QyBpbnRlcnJ1cHRzICovCisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfR1VD
X1NHX0lOVFJfRU5BQkxFLCAwKTsKKwlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9H
VUNfU0dfSU5UUl9NQVNLLCAgfjApOworfQorCit2b2lkIGdlbjVfZ3RfaXJxX2hhbmRsZXIoc3Ry
dWN0IGludGVsX2d0ICpndCwgdTMyIGd0X2lpcikKK3sKKwlpZiAoZ3RfaWlyICYgR1RfUkVOREVS
X1VTRVJfSU5URVJSVVBUKQorCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGd0LT5lbmdp
bmVfY2xhc3NbUkVOREVSX0NMQVNTXVswXSk7CisJaWYgKGd0X2lpciAmIElMS19CU0RfVVNFUl9J
TlRFUlJVUFQpCisJCWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoZ3QtPmVuZ2luZV9jbGFz
c1tWSURFT19ERUNPREVfQ0xBU1NdWzBdKTsKK30KKworc3RhdGljIHZvaWQgZ2VuN19wYXJpdHlf
ZXJyb3JfaXJxX2hhbmRsZXIoc3RydWN0IGludGVsX2d0ICpndCwgdTMyIGlpcikKK3sKKwlpZiAo
IUhBU19MM19EUEYoZ3QtPmk5MTUpKQorCQlyZXR1cm47CisKKwlzcGluX2xvY2soJmd0LT5pcnFf
bG9jayk7CisJZ2VuNV9ndF9kaXNhYmxlX2lycShndCwgR1RfUEFSSVRZX0VSUk9SKGd0LT5pOTE1
KSk7CisJc3Bpbl91bmxvY2soJmd0LT5pcnFfbG9jayk7CisKKwlpZiAoaWlyICYgR1RfUkVOREVS
X0wzX1BBUklUWV9FUlJPUl9JTlRFUlJVUFRfUzEpCisJCWd0LT5pOTE1LT5sM19wYXJpdHkud2hp
Y2hfc2xpY2UgfD0gMSA8PCAxOworCisJaWYgKGlpciAmIEdUX1JFTkRFUl9MM19QQVJJVFlfRVJS
T1JfSU5URVJSVVBUKQorCQlndC0+aTkxNS0+bDNfcGFyaXR5LndoaWNoX3NsaWNlIHw9IDEgPDwg
MDsKKworCXNjaGVkdWxlX3dvcmsoJmd0LT5pOTE1LT5sM19wYXJpdHkuZXJyb3Jfd29yayk7Cit9
CisKK3ZvaWQgZ2VuNl9ndF9pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1MzIgZ3Rf
aWlyKQoreworCWlmIChndF9paXIgJiBHVF9SRU5ERVJfVVNFUl9JTlRFUlJVUFQpCisJCWludGVs
X2VuZ2luZV9icmVhZGNydW1ic19pcnEoZ3QtPmVuZ2luZV9jbGFzc1tSRU5ERVJfQ0xBU1NdWzBd
KTsKKwlpZiAoZ3RfaWlyICYgR1RfQlNEX1VTRVJfSU5URVJSVVBUKQorCQlpbnRlbF9lbmdpbmVf
YnJlYWRjcnVtYnNfaXJxKGd0LT5lbmdpbmVfY2xhc3NbVklERU9fREVDT0RFX0NMQVNTXVswXSk7
CisJaWYgKGd0X2lpciAmIEdUX0JMVF9VU0VSX0lOVEVSUlVQVCkKKwkJaW50ZWxfZW5naW5lX2Jy
ZWFkY3J1bWJzX2lycShndC0+ZW5naW5lX2NsYXNzW0NPUFlfRU5HSU5FX0NMQVNTXVswXSk7CisK
KwlpZiAoZ3RfaWlyICYgKEdUX0JMVF9DU19FUlJPUl9JTlRFUlJVUFQgfAorCQkgICAgICBHVF9C
U0RfQ1NfRVJST1JfSU5URVJSVVBUIHwKKwkJICAgICAgR1RfUkVOREVSX0NTX01BU1RFUl9FUlJP
Ul9JTlRFUlJVUFQpKQorCQlEUk1fREVCVUcoIkNvbW1hbmQgcGFyc2VyIGVycm9yLCBndF9paXIg
MHglMDh4XG4iLCBndF9paXIpOworCisJaWYgKGd0X2lpciAmIEdUX1BBUklUWV9FUlJPUihndC0+
aTkxNSkpCisJCWdlbjdfcGFyaXR5X2Vycm9yX2lycV9oYW5kbGVyKGd0LCBndF9paXIpOworfQor
Cit2b2lkIGdlbjhfZ3RfaXJxX2FjayhzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1MzIgbWFzdGVyX2N0
bCwgdTMyIGd0X2lpcls0XSkKK3sKKwl2b2lkIF9faW9tZW0gKiBjb25zdCByZWdzID0gZ3QtPnVu
Y29yZS0+cmVnczsKKworCWlmIChtYXN0ZXJfY3RsICYgKEdFTjhfR1RfUkNTX0lSUSB8IEdFTjhf
R1RfQkNTX0lSUSkpIHsKKwkJZ3RfaWlyWzBdID0gcmF3X3JlZ19yZWFkKHJlZ3MsIEdFTjhfR1Rf
SUlSKDApKTsKKwkJaWYgKGxpa2VseShndF9paXJbMF0pKQorCQkJcmF3X3JlZ193cml0ZShyZWdz
LCBHRU44X0dUX0lJUigwKSwgZ3RfaWlyWzBdKTsKKwl9CisKKwlpZiAobWFzdGVyX2N0bCAmIChH
RU44X0dUX1ZDUzBfSVJRIHwgR0VOOF9HVF9WQ1MxX0lSUSkpIHsKKwkJZ3RfaWlyWzFdID0gcmF3
X3JlZ19yZWFkKHJlZ3MsIEdFTjhfR1RfSUlSKDEpKTsKKwkJaWYgKGxpa2VseShndF9paXJbMV0p
KQorCQkJcmF3X3JlZ193cml0ZShyZWdzLCBHRU44X0dUX0lJUigxKSwgZ3RfaWlyWzFdKTsKKwl9
CisKKwlpZiAobWFzdGVyX2N0bCAmIChHRU44X0dUX1BNX0lSUSB8IEdFTjhfR1RfR1VDX0lSUSkp
IHsKKwkJZ3RfaWlyWzJdID0gcmF3X3JlZ19yZWFkKHJlZ3MsIEdFTjhfR1RfSUlSKDIpKTsKKwkJ
aWYgKGxpa2VseShndF9paXJbMl0pKQorCQkJcmF3X3JlZ193cml0ZShyZWdzLCBHRU44X0dUX0lJ
UigyKSwgZ3RfaWlyWzJdKTsKKwl9CisKKwlpZiAobWFzdGVyX2N0bCAmIEdFTjhfR1RfVkVDU19J
UlEpIHsKKwkJZ3RfaWlyWzNdID0gcmF3X3JlZ19yZWFkKHJlZ3MsIEdFTjhfR1RfSUlSKDMpKTsK
KwkJaWYgKGxpa2VseShndF9paXJbM10pKQorCQkJcmF3X3JlZ193cml0ZShyZWdzLCBHRU44X0dU
X0lJUigzKSwgZ3RfaWlyWzNdKTsKKwl9Cit9CisKK3ZvaWQgZ2VuOF9ndF9pcnFfaGFuZGxlcihz
dHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1MzIgbWFzdGVyX2N0bCwgdTMyIGd0X2lpcls0XSkKK3sKKwlp
ZiAobWFzdGVyX2N0bCAmIChHRU44X0dUX1JDU19JUlEgfCBHRU44X0dUX0JDU19JUlEpKSB7CisJ
CWNzX2lycV9oYW5kbGVyKGd0LT5lbmdpbmVfY2xhc3NbUkVOREVSX0NMQVNTXVswXSwKKwkJCSAg
ICAgICBndF9paXJbMF0gPj4gR0VOOF9SQ1NfSVJRX1NISUZUKTsKKwkJY3NfaXJxX2hhbmRsZXIo
Z3QtPmVuZ2luZV9jbGFzc1tDT1BZX0VOR0lORV9DTEFTU11bMF0sCisJCQkgICAgICAgZ3RfaWly
WzBdID4+IEdFTjhfQkNTX0lSUV9TSElGVCk7CisJfQorCisJaWYgKG1hc3Rlcl9jdGwgJiAoR0VO
OF9HVF9WQ1MwX0lSUSB8IEdFTjhfR1RfVkNTMV9JUlEpKSB7CisJCWNzX2lycV9oYW5kbGVyKGd0
LT5lbmdpbmVfY2xhc3NbVklERU9fREVDT0RFX0NMQVNTXVswXSwKKwkJCSAgICAgICBndF9paXJb
MV0gPj4gR0VOOF9WQ1MwX0lSUV9TSElGVCk7CisJCWNzX2lycV9oYW5kbGVyKGd0LT5lbmdpbmVf
Y2xhc3NbVklERU9fREVDT0RFX0NMQVNTXVsxXSwKKwkJCSAgICAgICBndF9paXJbMV0gPj4gR0VO
OF9WQ1MxX0lSUV9TSElGVCk7CisJfQorCisJaWYgKG1hc3Rlcl9jdGwgJiBHRU44X0dUX1ZFQ1Nf
SVJRKSB7CisJCWNzX2lycV9oYW5kbGVyKGd0LT5lbmdpbmVfY2xhc3NbVklERU9fRU5IQU5DRU1F
TlRfQ0xBU1NdWzBdLAorCQkJICAgICAgIGd0X2lpclszXSA+PiBHRU44X1ZFQ1NfSVJRX1NISUZU
KTsKKwl9CisKKwlpZiAobWFzdGVyX2N0bCAmIChHRU44X0dUX1BNX0lSUSB8IEdFTjhfR1RfR1VD
X0lSUSkpIHsKKwkJZ2VuNl9ycHNfaXJxX2hhbmRsZXIoZ3QtPmk5MTUsIGd0X2lpclsyXSk7CisJ
CWd1Y19pcnFfaGFuZGxlcigmZ3QtPnVjLmd1YywgZ3RfaWlyWzJdID4+IDE2KTsKKwl9Cit9CisK
K3ZvaWQgZ2VuOF9ndF9pcnFfcmVzZXQoc3RydWN0IGludGVsX2d0ICpndCkKK3sKKwlzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3JlOworCisJR0VOOF9JUlFfUkVTRVRfTkRY
KHVuY29yZSwgR1QsIDApOworCUdFTjhfSVJRX1JFU0VUX05EWCh1bmNvcmUsIEdULCAxKTsKKwlH
RU44X0lSUV9SRVNFVF9ORFgodW5jb3JlLCBHVCwgMik7CisJR0VOOF9JUlFfUkVTRVRfTkRYKHVu
Y29yZSwgR1QsIDMpOworfQorCit2b2lkIGdlbjhfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBp
bnRlbF9ndCAqZ3QpCit7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29y
ZTsKKworCS8qIFRoZXNlIGFyZSBpbnRlcnJ1cHRzIHdlJ2xsIHRvZ2dsZSB3aXRoIHRoZSByaW5n
IG1hc2sgcmVnaXN0ZXIgKi8KKwl1MzIgZ3RfaW50ZXJydXB0c1tdID0geworCQkoR1RfUkVOREVS
X1VTRVJfSU5URVJSVVBUIDw8IEdFTjhfUkNTX0lSUV9TSElGVCB8CisJCSBHVF9DT05URVhUX1NX
SVRDSF9JTlRFUlJVUFQgPDwgR0VOOF9SQ1NfSVJRX1NISUZUIHwKKwkJIEdUX1JFTkRFUl9VU0VS
X0lOVEVSUlVQVCA8PCBHRU44X0JDU19JUlFfU0hJRlQgfAorCQkgR1RfQ09OVEVYVF9TV0lUQ0hf
SU5URVJSVVBUIDw8IEdFTjhfQkNTX0lSUV9TSElGVCksCisKKwkJKEdUX1JFTkRFUl9VU0VSX0lO
VEVSUlVQVCA8PCBHRU44X1ZDUzBfSVJRX1NISUZUIHwKKwkJIEdUX0NPTlRFWFRfU1dJVENIX0lO
VEVSUlVQVCA8PCBHRU44X1ZDUzBfSVJRX1NISUZUIHwKKwkJIEdUX1JFTkRFUl9VU0VSX0lOVEVS
UlVQVCA8PCBHRU44X1ZDUzFfSVJRX1NISUZUIHwKKwkJIEdUX0NPTlRFWFRfU1dJVENIX0lOVEVS
UlVQVCA8PCBHRU44X1ZDUzFfSVJRX1NISUZUKSwKKworCQkwLAorCisJCShHVF9SRU5ERVJfVVNF
Ul9JTlRFUlJVUFQgPDwgR0VOOF9WRUNTX0lSUV9TSElGVCB8CisJCSBHVF9DT05URVhUX1NXSVRD
SF9JTlRFUlJVUFQgPDwgR0VOOF9WRUNTX0lSUV9TSElGVCkKKwl9OworCisJZ3QtPnBtX2llciA9
IDB4MDsKKwlndC0+cG1faW1yID0gfmd0LT5wbV9pZXI7CisJR0VOOF9JUlFfSU5JVF9ORFgodW5j
b3JlLCBHVCwgMCwgfmd0X2ludGVycnVwdHNbMF0sIGd0X2ludGVycnVwdHNbMF0pOworCUdFTjhf
SVJRX0lOSVRfTkRYKHVuY29yZSwgR1QsIDEsIH5ndF9pbnRlcnJ1cHRzWzFdLCBndF9pbnRlcnJ1
cHRzWzFdKTsKKwkvKgorCSAqIFJQUyBpbnRlcnJ1cHRzIHdpbGwgZ2V0IGVuYWJsZWQvZGlzYWJs
ZWQgb24gZGVtYW5kIHdoZW4gUlBTIGl0c2VsZgorCSAqIGlzIGVuYWJsZWQvZGlzYWJsZWQuIFNh
bWUgd2lsIGJlIHRoZSBjYXNlIGZvciBHdUMgaW50ZXJydXB0cy4KKwkgKi8KKwlHRU44X0lSUV9J
TklUX05EWCh1bmNvcmUsIEdULCAyLCBndC0+cG1faW1yLCBndC0+cG1faWVyKTsKKwlHRU44X0lS
UV9JTklUX05EWCh1bmNvcmUsIEdULCAzLCB+Z3RfaW50ZXJydXB0c1szXSwgZ3RfaW50ZXJydXB0
c1szXSk7Cit9CisKK3N0YXRpYyB2b2lkIGdlbjVfZ3RfdXBkYXRlX2lycShzdHJ1Y3QgaW50ZWxf
Z3QgKmd0LAorCQkJICAgICAgIHUzMiBpbnRlcnJ1cHRfbWFzaywKKwkJCSAgICAgICB1MzIgZW5h
YmxlZF9pcnFfbWFzaykKK3sKKwlsb2NrZGVwX2Fzc2VydF9oZWxkKCZndC0+aXJxX2xvY2spOwor
CisJR0VNX0JVR19PTihlbmFibGVkX2lycV9tYXNrICYgfmludGVycnVwdF9tYXNrKTsKKworCWd0
LT5ndF9pbXIgJj0gfmludGVycnVwdF9tYXNrOworCWd0LT5ndF9pbXIgfD0gKH5lbmFibGVkX2ly
cV9tYXNrICYgaW50ZXJydXB0X21hc2spOworCWludGVsX3VuY29yZV93cml0ZShndC0+dW5jb3Jl
LCBHVElNUiwgZ3QtPmd0X2ltcik7Cit9CisKK3ZvaWQgZ2VuNV9ndF9lbmFibGVfaXJxKHN0cnVj
dCBpbnRlbF9ndCAqZ3QsIHUzMiBtYXNrKQoreworCWdlbjVfZ3RfdXBkYXRlX2lycShndCwgbWFz
aywgbWFzayk7CisJaW50ZWxfdW5jb3JlX3Bvc3RpbmdfcmVhZF9mdyhndC0+dW5jb3JlLCBHVElN
Uik7Cit9CisKK3ZvaWQgZ2VuNV9ndF9kaXNhYmxlX2lycShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCB1
MzIgbWFzaykKK3sKKwlnZW41X2d0X3VwZGF0ZV9pcnEoZ3QsIG1hc2ssIDApOworfQorCit2b2lk
IGdlbjVfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCit7CisJc3RydWN0IGludGVs
X3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKKworCUdFTjNfSVJRX1JFU0VUKHVuY29yZSwg
R1QpOworCWlmIChJTlRFTF9HRU4oZ3QtPmk5MTUpID49IDYpCisJCUdFTjNfSVJRX1JFU0VUKHVu
Y29yZSwgR0VONl9QTSk7Cit9CisKK3ZvaWQgZ2VuNV9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0
IGludGVsX2d0ICpndCkKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5j
b3JlOworCXUzMiBwbV9pcnFzID0gMDsKKwl1MzIgZ3RfaXJxcyA9IDA7CisKKwlndC0+Z3RfaW1y
ID0gfjA7CisJaWYgKEhBU19MM19EUEYoZ3QtPmk5MTUpKSB7CisJCS8qIEwzIHBhcml0eSBpbnRl
cnJ1cHQgaXMgYWx3YXlzIHVubWFza2VkLiAqLworCQlndC0+Z3RfaW1yID0gfkdUX1BBUklUWV9F
UlJPUihndC0+aTkxNSk7CisJCWd0X2lycXMgfD0gR1RfUEFSSVRZX0VSUk9SKGd0LT5pOTE1KTsK
Kwl9CisKKwlndF9pcnFzIHw9IEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVDsKKwlpZiAoSVNfR0VO
KGd0LT5pOTE1LCA1KSkKKwkJZ3RfaXJxcyB8PSBJTEtfQlNEX1VTRVJfSU5URVJSVVBUOworCWVs
c2UKKwkJZ3RfaXJxcyB8PSBHVF9CTFRfVVNFUl9JTlRFUlJVUFQgfCBHVF9CU0RfVVNFUl9JTlRF
UlJVUFQ7CisKKwlHRU4zX0lSUV9JTklUKHVuY29yZSwgR1QsIGd0LT5ndF9pbXIsIGd0X2lycXMp
OworCisJaWYgKElOVEVMX0dFTihndC0+aTkxNSkgPj0gNikgeworCQkvKgorCQkgKiBSUFMgaW50
ZXJydXB0cyB3aWxsIGdldCBlbmFibGVkL2Rpc2FibGVkIG9uIGRlbWFuZCB3aGVuIFJQUworCQkg
KiBpdHNlbGYgaXMgZW5hYmxlZC9kaXNhYmxlZC4KKwkJICovCisJCWlmIChIQVNfRU5HSU5FKGd0
LT5pOTE1LCBWRUNTMCkpIHsKKwkJCXBtX2lycXMgfD0gUE1fVkVCT1hfVVNFUl9JTlRFUlJVUFQ7
CisJCQlndC0+cG1faWVyIHw9IFBNX1ZFQk9YX1VTRVJfSU5URVJSVVBUOworCQl9CisKKwkJZ3Qt
PnBtX2ltciA9IDB4ZmZmZmZmZmY7CisJCUdFTjNfSVJRX0lOSVQodW5jb3JlLCBHRU42X1BNLCBn
dC0+cG1faW1yLCBwbV9pcnFzKTsKKwl9Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9ndF9pcnEuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0
X2lycS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uOGYzNzU5Mzcx
MmM5Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3Rf
aXJxLmgKQEAgLTAsMCArMSw0NCBAQAorLyoKKyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBN
SVQKKyAqCisgKiBDb3B5cmlnaHQgwqkgMjAxOSBJbnRlbCBDb3Jwb3JhdGlvbgorICovCisKKyNp
Zm5kZWYgSU5URUxfR1RfSVJRX0gKKyNkZWZpbmUgSU5URUxfR1RfSVJRX0gKKworI2luY2x1ZGUg
PGxpbnV4L3R5cGVzLmg+CisKK3N0cnVjdCBpbnRlbF9ndDsKKworI2RlZmluZSBHRU44X0dUX0lS
UVMgKEdFTjhfR1RfUkNTX0lSUSB8IFwKKwkJICAgICAgR0VOOF9HVF9CQ1NfSVJRIHwgXAorCQkg
ICAgICBHRU44X0dUX1ZDUzBfSVJRIHwgXAorCQkgICAgICBHRU44X0dUX1ZDUzFfSVJRIHwgXAor
CQkgICAgICBHRU44X0dUX1ZFQ1NfSVJRIHwgXAorCQkgICAgICBHRU44X0dUX1BNX0lSUSB8IFwK
KwkJICAgICAgR0VOOF9HVF9HVUNfSVJRKQorCit2b2lkIGdlbjExX2d0X2lycV9yZXNldChzdHJ1
Y3QgaW50ZWxfZ3QgKmd0KTsKK3ZvaWQgZ2VuMTFfZ3RfaXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBp
bnRlbF9ndCAqZ3QpOwordm9pZCBnZW4xMV9ndF9pcnFfaGFuZGxlcihzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0LCBjb25zdCB1MzIgbWFzdGVyX2N0bCk7CisKK2Jvb2wgZ2VuMTFfZ3RfcmVzZXRfb25lX2lp
cihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LAorCQkJICAgIGNvbnN0IHVuc2lnbmVkIGludCBiYW5rLAor
CQkJICAgIGNvbnN0IHVuc2lnbmVkIGludCBiaXQpOworCit2b2lkIGdlbjVfZ3RfaXJxX2hhbmRs
ZXIoc3RydWN0IGludGVsX2d0ICpndCwgdTMyIGd0X2lpcik7CisKK3ZvaWQgZ2VuNV9ndF9pcnFf
cG9zdGluc3RhbGwoc3RydWN0IGludGVsX2d0ICpndCk7Cit2b2lkIGdlbjVfZ3RfaXJxX3Jlc2V0
KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBnZW41X2d0X2Rpc2FibGVfaXJxKHN0cnVjdCBp
bnRlbF9ndCAqZ3QsIHUzMiBtYXNrKTsKK3ZvaWQgZ2VuNV9ndF9lbmFibGVfaXJxKHN0cnVjdCBp
bnRlbF9ndCAqZ3QsIHUzMiBtYXNrKTsKKwordm9pZCBnZW42X2d0X2lycV9oYW5kbGVyKHN0cnVj
dCBpbnRlbF9ndCAqZ3QsIHUzMiBndF9paXIpOworCit2b2lkIGdlbjhfZ3RfaXJxX2FjayhzdHJ1
Y3QgaW50ZWxfZ3QgKmd0LCB1MzIgbWFzdGVyX2N0bCwgdTMyIGd0X2lpcls0XSk7Cit2b2lkIGdl
bjhfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBpbnRlbF9ndCAqZ3QpOwordm9pZCBnZW44X2d0X2lycV9o
YW5kbGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHUzMiBtYXN0ZXJfY3RsLCB1MzIgZ3RfaWlyWzRd
KTsKK3ZvaWQgZ2VuOF9ndF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGludGVsX2d0ICpndCk7CisK
KyNlbmRpZiAvKiBJTlRFTF9HVF9JUlFfSCAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZ3RfcG1faXJxLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRl
bF9ndF9wbV9pcnEuYwppbmRleCA4M2UxMWMyY2M1YWIuLmJhYmU4NjYxMjZkNyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG1faXJxLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG1faXJxLmMKQEAgLTcsNiArNyw3IEBACiAjaW5j
bHVkZSAiaTkxNV9kcnYuaCIKICNpbmNsdWRlICJpOTE1X3JlZy5oIgogI2luY2x1ZGUgImludGVs
X2d0LmgiCisjaW5jbHVkZSAiaW50ZWxfZ3RfaXJxLmgiCiAjaW5jbHVkZSAiaW50ZWxfZ3RfcG1f
aXJxLmgiCiAKIHN0YXRpYyB2b2lkIHdyaXRlX3BtX2ltcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMuaCBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3R5cGVzLmgKaW5kZXggYmI3NTIzNjRkNDQ3
Li5hZGFiNGQyYzI5YWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0X3R5cGVzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfdHlwZXMu
aApAQCAtNzQsNiArNzQsNyBAQCBzdHJ1Y3QgaW50ZWxfZ3QgewogCXN0cnVjdCBpOTE1X3ZtYSAq
c2NyYXRjaDsKIAogCXNwaW5sb2NrX3QgaXJxX2xvY2s7CisJdTMyIGd0X2ltcjsKIAl1MzIgcG1f
aWVyOwogCXUzMiBwbV9pbXI7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L2ludGVsX3JpbmdidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jpbmdi
dWZmZXIuYwppbmRleCAxNWIwMjQ2NDIyYzcuLjQwOWQ3NjRmOGM2ZCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmluZ2J1ZmZlci5jCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYwpAQCAtMzcsNiArMzcsNyBAQAogI2luY2x1
ZGUgImk5MTVfdHJhY2UuaCIKICNpbmNsdWRlICJpbnRlbF9jb250ZXh0LmgiCiAjaW5jbHVkZSAi
aW50ZWxfZ3QuaCIKKyNpbmNsdWRlICJpbnRlbF9ndF9pcnEuaCIKICNpbmNsdWRlICJpbnRlbF9n
dF9wbV9pcnEuaCIKICNpbmNsdWRlICJpbnRlbF9yZXNldC5oIgogI2luY2x1ZGUgImludGVsX3dv
cmthcm91bmRzLmgiCkBAIC05ODMsMTMgKzk4NCwxMyBAQCBzdGF0aWMgdTMyICpnZW41X2VtaXRf
YnJlYWRjcnVtYihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgdTMyICpjcykKIHN0YXRpYyB2b2lk
CiBnZW41X2lycV9lbmFibGUoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogewotCWdl
bjVfZW5hYmxlX2d0X2lycShlbmdpbmUtPmk5MTUsIGVuZ2luZS0+aXJxX2VuYWJsZV9tYXNrKTsK
KwlnZW41X2d0X2VuYWJsZV9pcnEoZW5naW5lLT5ndCwgZW5naW5lLT5pcnFfZW5hYmxlX21hc2sp
OwogfQogCiBzdGF0aWMgdm9pZAogZ2VuNV9pcnFfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5naW5l
X2NzICplbmdpbmUpCiB7Ci0JZ2VuNV9kaXNhYmxlX2d0X2lycShlbmdpbmUtPmk5MTUsIGVuZ2lu
ZS0+aXJxX2VuYWJsZV9tYXNrKTsKKwlnZW41X2d0X2Rpc2FibGVfaXJxKGVuZ2luZS0+Z3QsIGVu
Z2luZS0+aXJxX2VuYWJsZV9tYXNrKTsKIH0KIAogc3RhdGljIHZvaWQKQEAgLTEwNTAsMTQgKzEw
NTEsMTQgQEAgZ2VuNl9pcnFfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
IAkvKiBGbHVzaC9kZWxheSB0byBlbnN1cmUgdGhlIFJJTkdfSU1SIGlzIGFjdGl2ZSBiZWZvcmUg
dGhlIEdUIElNUiAqLwogCUVOR0lORV9QT1NUSU5HX1JFQUQoZW5naW5lLCBSSU5HX0lNUik7CiAK
LQlnZW41X2VuYWJsZV9ndF9pcnEoZW5naW5lLT5pOTE1LCBlbmdpbmUtPmlycV9lbmFibGVfbWFz
ayk7CisJZ2VuNV9ndF9lbmFibGVfaXJxKGVuZ2luZS0+Z3QsIGVuZ2luZS0+aXJxX2VuYWJsZV9t
YXNrKTsKIH0KIAogc3RhdGljIHZvaWQKIGdlbjZfaXJxX2Rpc2FibGUoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogewogCUVOR0lORV9XUklURShlbmdpbmUsIFJJTkdfSU1SLCB+ZW5n
aW5lLT5pcnFfa2VlcF9tYXNrKTsKLQlnZW41X2Rpc2FibGVfZ3RfaXJxKGVuZ2luZS0+aTkxNSwg
ZW5naW5lLT5pcnFfZW5hYmxlX21hc2spOworCWdlbjVfZ3RfZGlzYWJsZV9pcnEoZW5naW5lLT5n
dCwgZW5naW5lLT5pcnFfZW5hYmxlX21hc2spOwogfQogCiBzdGF0aWMgdm9pZApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmgKaW5kZXggMThiZThiMjUwYTdjLi4zOGQ2MzIyODE2MDEgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kcnYuaApAQCAtMTQyNyw3ICsxNDI3LDYgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgewogCQl1MzIgaXJxX21hc2s7CiAJCXUzMiBkZV9pcnFfbWFza1tJOTE1X01BWF9QSVBFU107
CiAJfTsKLQl1MzIgZ3RfaXJxX21hc2s7CiAJdTMyIHBtX3Jwc19ldmVudHM7CiAJdTMyIHBpcGVz
dGF0X2lycV9tYXNrW0k5MTVfTUFYX1BJUEVTXTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9pcnEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmMKaW5k
ZXggNTM4OTc2MTc0YWQ3Li43M2VmYjM3M2RmYTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfaXJxLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9pcnEuYwpA
QCAtNDQsNiArNDQsNyBAQAogI2luY2x1ZGUgImRpc3BsYXkvaW50ZWxfcHNyLmgiCiAKICNpbmNs
dWRlICJndC9pbnRlbF9ndC5oIgorI2luY2x1ZGUgImd0L2ludGVsX2d0X2lycS5oIgogI2luY2x1
ZGUgImd0L2ludGVsX2d0X3BtX2lycS5oIgogCiAjaW5jbHVkZSAiaTkxNV9kcnYuaCIKQEAgLTE3
NCw4ICsxNzUsOCBAQCBzdGF0aWMgY29uc3QgdTMyIGhwZF90Z3BbSFBEX05VTV9QSU5TXSA9IHsK
IAlbSFBEX1BPUlRfSV0gPSBTREVfVEM2X0hPVFBMVUdfVEdQLAogfTsKIAotc3RhdGljIHZvaWQg
Z2VuM19pcnFfcmVzZXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLCBpOTE1X3JlZ190IGlt
ciwKLQkJCSAgIGk5MTVfcmVnX3QgaWlyLCBpOTE1X3JlZ190IGllcikKK3ZvaWQgZ2VuM19pcnFf
cmVzZXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLCBpOTE1X3JlZ190IGltciwKKwkJICAg
IGk5MTVfcmVnX3QgaWlyLCBpOTE1X3JlZ190IGllcikKIHsKIAlpbnRlbF91bmNvcmVfd3JpdGUo
dW5jb3JlLCBpbXIsIDB4ZmZmZmZmZmYpOwogCWludGVsX3VuY29yZV9wb3N0aW5nX3JlYWQodW5j
b3JlLCBpbXIpOwpAQCAtMTg5LDcgKzE5MCw3IEBAIHN0YXRpYyB2b2lkIGdlbjNfaXJxX3Jlc2V0
KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwgaTkxNV9yZWdfdCBpbXIsCiAJaW50ZWxfdW5j
b3JlX3Bvc3RpbmdfcmVhZCh1bmNvcmUsIGlpcik7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbjJfaXJx
X3Jlc2V0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSkKK3ZvaWQgZ2VuMl9pcnFfcmVzZXQo
c3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlKQogewogCWludGVsX3VuY29yZV93cml0ZTE2KHVu
Y29yZSwgR0VOMl9JTVIsIDB4ZmZmZik7CiAJaW50ZWxfdW5jb3JlX3Bvc3RpbmdfcmVhZDE2KHVu
Y29yZSwgR0VOMl9JTVIpOwpAQCAtMjAzLDE5ICsyMDQsNiBAQCBzdGF0aWMgdm9pZCBnZW4yX2ly
cV9yZXNldChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUpCiAJaW50ZWxfdW5jb3JlX3Bvc3Rp
bmdfcmVhZDE2KHVuY29yZSwgR0VOMl9JSVIpOwogfQogCi0jZGVmaW5lIEdFTjhfSVJRX1JFU0VU
X05EWCh1bmNvcmUsIHR5cGUsIHdoaWNoKSBcCi0oeyBcCi0JdW5zaWduZWQgaW50IHdoaWNoXyA9
IHdoaWNoOyBcCi0JZ2VuM19pcnFfcmVzZXQoKHVuY29yZSksIEdFTjhfIyN0eXBlIyNfSU1SKHdo
aWNoXyksIFwKLQkJICAgICAgIEdFTjhfIyN0eXBlIyNfSUlSKHdoaWNoXyksIEdFTjhfIyN0eXBl
IyNfSUVSKHdoaWNoXykpOyBcCi19KQotCi0jZGVmaW5lIEdFTjNfSVJRX1JFU0VUKHVuY29yZSwg
dHlwZSkgXAotCWdlbjNfaXJxX3Jlc2V0KCh1bmNvcmUpLCB0eXBlIyNJTVIsIHR5cGUjI0lJUiwg
dHlwZSMjSUVSKQotCi0jZGVmaW5lIEdFTjJfSVJRX1JFU0VUKHVuY29yZSkgXAotCWdlbjJfaXJx
X3Jlc2V0KHVuY29yZSkKLQogLyoKICAqIFdlIHNob3VsZCBjbGVhciBJTVIgYXQgcHJlaW5zdGFs
bC91bmluc3RhbGwsIGFuZCBqdXN0IGNoZWNrIGF0IHBvc3RpbnN0YWxsLgogICovCkBAIC0yNDks
MTAgKzIzNywxMCBAQCBzdGF0aWMgdm9pZCBnZW4yX2Fzc2VydF9paXJfaXNfemVybyhzdHJ1Y3Qg
aW50ZWxfdW5jb3JlICp1bmNvcmUpCiAJaW50ZWxfdW5jb3JlX3Bvc3RpbmdfcmVhZDE2KHVuY29y
ZSwgR0VOMl9JSVIpOwogfQogCi1zdGF0aWMgdm9pZCBnZW4zX2lycV9pbml0KHN0cnVjdCBpbnRl
bF91bmNvcmUgKnVuY29yZSwKLQkJCSAgaTkxNV9yZWdfdCBpbXIsIHUzMiBpbXJfdmFsLAotCQkJ
ICBpOTE1X3JlZ190IGllciwgdTMyIGllcl92YWwsCi0JCQkgIGk5MTVfcmVnX3QgaWlyKQordm9p
ZCBnZW4zX2lycV9pbml0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwKKwkJICAgaTkxNV9y
ZWdfdCBpbXIsIHUzMiBpbXJfdmFsLAorCQkgICBpOTE1X3JlZ190IGllciwgdTMyIGllcl92YWws
CisJCSAgIGk5MTVfcmVnX3QgaWlyKQogewogCWdlbjNfYXNzZXJ0X2lpcl9pc196ZXJvKHVuY29y
ZSwgaWlyKTsKIApAQCAtMjYxLDggKzI0OSw4IEBAIHN0YXRpYyB2b2lkIGdlbjNfaXJxX2luaXQo
c3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAogCWludGVsX3VuY29yZV9wb3N0aW5nX3JlYWQo
dW5jb3JlLCBpbXIpOwogfQogCi1zdGF0aWMgdm9pZCBnZW4yX2lycV9pbml0KHN0cnVjdCBpbnRl
bF91bmNvcmUgKnVuY29yZSwKLQkJCSAgdTMyIGltcl92YWwsIHUzMiBpZXJfdmFsKQordm9pZCBn
ZW4yX2lycV9pbml0KHN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSwKKwkJICAgdTMyIGltcl92
YWwsIHUzMiBpZXJfdmFsKQogewogCWdlbjJfYXNzZXJ0X2lpcl9pc196ZXJvKHVuY29yZSk7CiAK
QEAgLTI3MSwyNyArMjU5LDYgQEAgc3RhdGljIHZvaWQgZ2VuMl9pcnFfaW5pdChzdHJ1Y3QgaW50
ZWxfdW5jb3JlICp1bmNvcmUsCiAJaW50ZWxfdW5jb3JlX3Bvc3RpbmdfcmVhZDE2KHVuY29yZSwg
R0VOMl9JTVIpOwogfQogCi0jZGVmaW5lIEdFTjhfSVJRX0lOSVRfTkRYKHVuY29yZSwgdHlwZSwg
d2hpY2gsIGltcl92YWwsIGllcl92YWwpIFwKLSh7IFwKLQl1bnNpZ25lZCBpbnQgd2hpY2hfID0g
d2hpY2g7IFwKLQlnZW4zX2lycV9pbml0KCh1bmNvcmUpLCBcCi0JCSAgICAgIEdFTjhfIyN0eXBl
IyNfSU1SKHdoaWNoXyksIGltcl92YWwsIFwKLQkJICAgICAgR0VOOF8jI3R5cGUjI19JRVIod2hp
Y2hfKSwgaWVyX3ZhbCwgXAotCQkgICAgICBHRU44XyMjdHlwZSMjX0lJUih3aGljaF8pKTsgXAot
fSkKLQotI2RlZmluZSBHRU4zX0lSUV9JTklUKHVuY29yZSwgdHlwZSwgaW1yX3ZhbCwgaWVyX3Zh
bCkgXAotCWdlbjNfaXJxX2luaXQoKHVuY29yZSksIFwKLQkJICAgICAgdHlwZSMjSU1SLCBpbXJf
dmFsLCBcCi0JCSAgICAgIHR5cGUjI0lFUiwgaWVyX3ZhbCwgXAotCQkgICAgICB0eXBlIyNJSVIp
Ci0KLSNkZWZpbmUgR0VOMl9JUlFfSU5JVCh1bmNvcmUsIGltcl92YWwsIGllcl92YWwpIFwKLQln
ZW4yX2lycV9pbml0KCh1bmNvcmUpLCBpbXJfdmFsLCBpZXJfdmFsKQotCi1zdGF0aWMgdm9pZCBn
ZW42X3Jwc19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIHUz
MiBwbV9paXIpOwotc3RhdGljIHZvaWQgZ3VjX2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndWMg
Kmd1YywgdTE2IGd1Y19paXIpOwotCiAvKiBGb3IgZGlzcGxheSBob3RwbHVnIGludGVycnVwdCAq
Lwogc3RhdGljIGlubGluZSB2b2lkCiBpOTE1X2hvdHBsdWdfaW50ZXJydXB0X3VwZGF0ZV9sb2Nr
ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LApAQCAtMzMwLDQxICsyOTcsNiBA
QCB2b2lkIGk5MTVfaG90cGx1Z19pbnRlcnJ1cHRfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKIAlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7CiB9
CiAKLXN0YXRpYyB1MzIKLWdlbjExX2d0X2VuZ2luZV9pZGVudGl0eShzdHJ1Y3QgaW50ZWxfZ3Qg
Kmd0LAotCQkJIGNvbnN0IHVuc2lnbmVkIGludCBiYW5rLCBjb25zdCB1bnNpZ25lZCBpbnQgYml0
KTsKLQotc3RhdGljIGJvb2wgZ2VuMTFfcmVzZXRfb25lX2lpcihzdHJ1Y3QgaW50ZWxfZ3QgKmd0
LAotCQkJCWNvbnN0IHVuc2lnbmVkIGludCBiYW5rLAotCQkJCWNvbnN0IHVuc2lnbmVkIGludCBi
aXQpCi17Ci0Jdm9pZCBfX2lvbWVtICogY29uc3QgcmVncyA9IGd0LT51bmNvcmUtPnJlZ3M7Ci0J
dTMyIGR3OwotCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZ3QtPmk5MTUtPmlycV9sb2NrKTsKLQot
CWR3ID0gcmF3X3JlZ19yZWFkKHJlZ3MsIEdFTjExX0dUX0lOVFJfRFcoYmFuaykpOwotCWlmIChk
dyAmIEJJVChiaXQpKSB7Ci0JCS8qCi0JCSAqIEFjY29yZGluZyB0byB0aGUgQlNwZWMsIERXX0lJ
UiBiaXRzIGNhbm5vdCBiZSBjbGVhcmVkIHdpdGhvdXQKLQkJICogZmlyc3Qgc2VydmljaW5nIHRo
ZSBTZWxlY3RvciAmIFNoYXJlZCBJSVIgcmVnaXN0ZXJzLgotCQkgKi8KLQkJZ2VuMTFfZ3RfZW5n
aW5lX2lkZW50aXR5KGd0LCBiYW5rLCBiaXQpOwotCi0JCS8qCi0JCSAqIFdlIGxvY2tlZCBHVCBJ
TlQgRFcgYnkgcmVhZGluZyBpdC4gSWYgd2Ugd2FudCB0byAodHJ5Ci0JCSAqIHRvKSByZWNvdmVy
IGZyb20gdGhpcyBzdWNjZXNmdWxseSwgd2UgbmVlZCB0byBjbGVhcgotCQkgKiBvdXIgYml0LCBv
dGhlcndpc2Ugd2UgYXJlIGxvY2tpbmcgdGhlIHJlZ2lzdGVyIGZvcgotCQkgKiBldmVyeWJvZHku
Ci0JCSAqLwotCQlyYXdfcmVnX3dyaXRlKHJlZ3MsIEdFTjExX0dUX0lOVFJfRFcoYmFuayksIEJJ
VChiaXQpKTsKLQotCQlyZXR1cm4gdHJ1ZTsKLQl9Ci0KLQlyZXR1cm4gZmFsc2U7Ci19Ci0KIC8q
KgogICogaWxrX3VwZGF0ZV9kaXNwbGF5X2lycSAtIHVwZGF0ZSBERUlNUgogICogQGRldl9wcml2
OiBkcml2ZXIgcHJpdmF0ZQpAQCAtMzk1LDM5ICszMjcsNiBAQCB2b2lkIGlsa191cGRhdGVfZGlz
cGxheV9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCX0KIH0KIAotLyoq
Ci0gKiBpbGtfdXBkYXRlX2d0X2lycSAtIHVwZGF0ZSBHVElNUgotICogQGRldl9wcml2OiBkcml2
ZXIgcHJpdmF0ZQotICogQGludGVycnVwdF9tYXNrOiBtYXNrIG9mIGludGVycnVwdCBiaXRzIHRv
IHVwZGF0ZQotICogQGVuYWJsZWRfaXJxX21hc2s6IG1hc2sgb2YgaW50ZXJydXB0IGJpdHMgdG8g
ZW5hYmxlCi0gKi8KLXN0YXRpYyB2b2lkIGlsa191cGRhdGVfZ3RfaXJxKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAgICAgIHUzMiBpbnRlcnJ1cHRfbWFzaywKLQkJCSAg
ICAgIHUzMiBlbmFibGVkX2lycV9tYXNrKQotewotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmRldl9w
cml2LT5pcnFfbG9jayk7Ci0KLQlXQVJOX09OKGVuYWJsZWRfaXJxX21hc2sgJiB+aW50ZXJydXB0
X21hc2spOwotCi0JaWYgKFdBUk5fT04oIWludGVsX2lycXNfZW5hYmxlZChkZXZfcHJpdikpKQot
CQlyZXR1cm47Ci0KLQlkZXZfcHJpdi0+Z3RfaXJxX21hc2sgJj0gfmludGVycnVwdF9tYXNrOwot
CWRldl9wcml2LT5ndF9pcnFfbWFzayB8PSAofmVuYWJsZWRfaXJxX21hc2sgJiBpbnRlcnJ1cHRf
bWFzayk7Ci0JSTkxNV9XUklURShHVElNUiwgZGV2X3ByaXYtPmd0X2lycV9tYXNrKTsKLX0KLQot
dm9pZCBnZW41X2VuYWJsZV9ndF9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCB1MzIgbWFzaykKLXsKLQlpbGtfdXBkYXRlX2d0X2lycShkZXZfcHJpdiwgbWFzaywgbWFzayk7
Ci0JaW50ZWxfdW5jb3JlX3Bvc3RpbmdfcmVhZF9mdygmZGV2X3ByaXYtPnVuY29yZSwgR1RJTVIp
OwotfQotCi12b2lkIGdlbjVfZGlzYWJsZV9ndF9pcnEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2LCB1MzIgbWFzaykKLXsKLQlpbGtfdXBkYXRlX2d0X2lycShkZXZfcHJpdiwgbWFz
aywgMCk7Ci19Ci0KIHN0YXRpYyBpOTE1X3JlZ190IGdlbjZfcG1faWlyKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAlXQVJOX09OX09OQ0UoSU5URUxfR0VOKGRldl9wcml2
KSA+PSAxMSk7CkBAIC00NDEsNyArMzQwLDcgQEAgdm9pZCBnZW4xMV9yZXNldF9ycHNfaW50ZXJy
dXB0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAKIAlzcGluX2xvY2tfaXJx
KCZndC0+aXJxX2xvY2spOwogCi0Jd2hpbGUgKGdlbjExX3Jlc2V0X29uZV9paXIoZ3QsIDAsIEdF
TjExX0dUUE0pKQorCXdoaWxlIChnZW4xMV9ndF9yZXNldF9vbmVfaWlyKGd0LCAwLCBHRU4xMV9H
VFBNKSkKIAkJOwogCiAJZGV2X3ByaXYtPmd0X3BtLnJwcy5wbV9paXIgPSAwOwpAQCAtNDcxLDcg
KzM3MCw3IEBAIHZvaWQgZ2VuNl9lbmFibGVfcnBzX2ludGVycnVwdHMoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQogCVdBUk5fT05fT05DRShycHMtPnBtX2lpcik7CiAKIAlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKLQkJV0FSTl9PTl9PTkNFKGdlbjExX3Jlc2V0X29u
ZV9paXIoZ3QsIDAsIEdFTjExX0dUUE0pKTsKKwkJV0FSTl9PTl9PTkNFKGdlbjExX2d0X3Jlc2V0
X29uZV9paXIoZ3QsIDAsIEdFTjExX0dUUE0pKTsKIAllbHNlCiAJCVdBUk5fT05fT05DRShJOTE1
X1JFQUQoZ2VuNl9wbV9paXIoZGV2X3ByaXYpKSAmIGRldl9wcml2LT5wbV9ycHNfZXZlbnRzKTsK
IApAQCAtNTY2LDcgKzQ2NSw3IEBAIHZvaWQgZ2VuMTFfcmVzZXRfZ3VjX2ludGVycnVwdHMoc3Ry
dWN0IGludGVsX2d1YyAqZ3VjKQogCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBndWNfdG9fZ3QoZ3Vj
KTsKIAogCXNwaW5fbG9ja19pcnEoJmd0LT5pcnFfbG9jayk7Ci0JZ2VuMTFfcmVzZXRfb25lX2lp
cihndCwgMCwgR0VOMTFfR1VDKTsKKwlnZW4xMV9ndF9yZXNldF9vbmVfaWlyKGd0LCAwLCBHRU4x
MV9HVUMpOwogCXNwaW5fdW5sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKIH0KIApAQCAtNTc4LDcg
KzQ3Nyw3IEBAIHZvaWQgZ2VuMTFfZW5hYmxlX2d1Y19pbnRlcnJ1cHRzKHN0cnVjdCBpbnRlbF9n
dWMgKmd1YykKIAlpZiAoIWd1Yy0+aW50ZXJydXB0cy5lbmFibGVkKSB7CiAJCXUzMiBldmVudHMg
PSBSRUdfRklFTERfUFJFUChFTkdJTkUxX01BU0ssIEdVQ19JTlRSX0dVQzJIT1NUKTsKIAotCQlX
QVJOX09OX09OQ0UoZ2VuMTFfcmVzZXRfb25lX2lpcihndCwgMCwgR0VOMTFfR1VDKSk7CisJCVdB
Uk5fT05fT05DRShnZW4xMV9ndF9yZXNldF9vbmVfaWlyKGd0LCAwLCBHRU4xMV9HVUMpKTsKIAkJ
aW50ZWxfdW5jb3JlX3dyaXRlKGd0LT51bmNvcmUsIEdFTjExX0dVQ19TR19JTlRSX0VOQUJMRSwg
ZXZlbnRzKTsKIAkJaW50ZWxfdW5jb3JlX3dyaXRlKGd0LT51bmNvcmUsIEdFTjExX0dVQ19TR19J
TlRSX01BU0ssIH5ldmVudHMpOwogCQlndWMtPmludGVycnVwdHMuZW5hYmxlZCA9IHRydWU7CkBA
IC0xMzc5LDYgKzEyNzgsNyBAQCBzdGF0aWMgdm9pZCBpdnlicmlkZ2VfcGFyaXR5X3dvcmsoc3Ry
dWN0IHdvcmtfc3RydWN0ICp3b3JrKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9CiAJCWNvbnRhaW5lcl9vZih3b3JrLCB0eXBlb2YoKmRldl9wcml2KSwgbDNfcGFyaXR5
LmVycm9yX3dvcmspOworCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSAmZGV2X3ByaXYtPmd0OwogCXUz
MiBlcnJvcl9zdGF0dXMsIHJvdywgYmFuaywgc3ViYmFuazsKIAljaGFyICpwYXJpdHlfZXZlbnRb
Nl07CiAJdTMyIG1pc2NjcGN0bDsKQEAgLTE0NDAsMTQ0ICsxMzQwLDEzIEBAIHN0YXRpYyB2b2lk
IGl2eWJyaWRnZV9wYXJpdHlfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAKIG91dDoK
IAlXQVJOX09OKGRldl9wcml2LT5sM19wYXJpdHkud2hpY2hfc2xpY2UpOwotCXNwaW5fbG9ja19p
cnEoJmRldl9wcml2LT5pcnFfbG9jayk7Ci0JZ2VuNV9lbmFibGVfZ3RfaXJxKGRldl9wcml2LCBH
VF9QQVJJVFlfRVJST1IoZGV2X3ByaXYpKTsKLQlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5p
cnFfbG9jayk7CisJc3Bpbl9sb2NrX2lycSgmZ3QtPmlycV9sb2NrKTsKKwlnZW41X2d0X2VuYWJs
ZV9pcnEoZ3QsIEdUX1BBUklUWV9FUlJPUihkZXZfcHJpdikpOworCXNwaW5fdW5sb2NrX2lycSgm
Z3QtPmlycV9sb2NrKTsKIAogCW11dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwogfQogCi1zdGF0aWMgdm9pZCBpdnlicmlkZ2VfcGFyaXR5X2Vycm9yX2lycV9oYW5kbGVy
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkJICAgICAgIHUzMiBpaXIp
Ci17Ci0JaWYgKCFIQVNfTDNfRFBGKGRldl9wcml2KSkKLQkJcmV0dXJuOwotCi0Jc3Bpbl9sb2Nr
KCZkZXZfcHJpdi0+aXJxX2xvY2spOwotCWdlbjVfZGlzYWJsZV9ndF9pcnEoZGV2X3ByaXYsIEdU
X1BBUklUWV9FUlJPUihkZXZfcHJpdikpOwotCXNwaW5fdW5sb2NrKCZkZXZfcHJpdi0+aXJxX2xv
Y2spOwotCi0JaWlyICY9IEdUX1BBUklUWV9FUlJPUihkZXZfcHJpdik7Ci0JaWYgKGlpciAmIEdU
X1JFTkRFUl9MM19QQVJJVFlfRVJST1JfSU5URVJSVVBUX1MxKQotCQlkZXZfcHJpdi0+bDNfcGFy
aXR5LndoaWNoX3NsaWNlIHw9IDEgPDwgMTsKLQotCWlmIChpaXIgJiBHVF9SRU5ERVJfTDNfUEFS
SVRZX0VSUk9SX0lOVEVSUlVQVCkKLQkJZGV2X3ByaXYtPmwzX3Bhcml0eS53aGljaF9zbGljZSB8
PSAxIDw8IDA7Ci0KLQlxdWV1ZV93b3JrKGRldl9wcml2LT53cSwgJmRldl9wcml2LT5sM19wYXJp
dHkuZXJyb3Jfd29yayk7Ci19Ci0KLXN0YXRpYyB2b2lkIGlsa19ndF9pcnFfaGFuZGxlcihzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkgICAgICAgdTMyIGd0X2lpcikKLXsK
LQlpZiAoZ3RfaWlyICYgR1RfUkVOREVSX1VTRVJfSU5URVJSVVBUKQotCQlpbnRlbF9lbmdpbmVf
YnJlYWRjcnVtYnNfaXJxKGRldl9wcml2LT5lbmdpbmVbUkNTMF0pOwotCWlmIChndF9paXIgJiBJ
TEtfQlNEX1VTRVJfSU5URVJSVVBUKQotCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGRl
dl9wcml2LT5lbmdpbmVbVkNTMF0pOwotfQotCi1zdGF0aWMgdm9pZCBzbmJfZ3RfaXJxX2hhbmRs
ZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJICAgICAgIHUzMiBndF9p
aXIpCi17Ci0JaWYgKGd0X2lpciAmIEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVCkKLQkJaW50ZWxf
ZW5naW5lX2JyZWFkY3J1bWJzX2lycShkZXZfcHJpdi0+ZW5naW5lW1JDUzBdKTsKLQlpZiAoZ3Rf
aWlyICYgR1RfQlNEX1VTRVJfSU5URVJSVVBUKQotCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNf
aXJxKGRldl9wcml2LT5lbmdpbmVbVkNTMF0pOwotCWlmIChndF9paXIgJiBHVF9CTFRfVVNFUl9J
TlRFUlJVUFQpCi0JCWludGVsX2VuZ2luZV9icmVhZGNydW1ic19pcnEoZGV2X3ByaXYtPmVuZ2lu
ZVtCQ1MwXSk7Ci0KLQlpZiAoZ3RfaWlyICYgKEdUX0JMVF9DU19FUlJPUl9JTlRFUlJVUFQgfAot
CQkgICAgICBHVF9CU0RfQ1NfRVJST1JfSU5URVJSVVBUIHwKLQkJICAgICAgR1RfUkVOREVSX0NT
X01BU1RFUl9FUlJPUl9JTlRFUlJVUFQpKQotCQlEUk1fREVCVUcoIkNvbW1hbmQgcGFyc2VyIGVy
cm9yLCBndF9paXIgMHglMDh4XG4iLCBndF9paXIpOwotCi0JaWYgKGd0X2lpciAmIEdUX1BBUklU
WV9FUlJPUihkZXZfcHJpdikpCi0JCWl2eWJyaWRnZV9wYXJpdHlfZXJyb3JfaXJxX2hhbmRsZXIo
ZGV2X3ByaXYsIGd0X2lpcik7Ci19Ci0KLXN0YXRpYyB2b2lkCi1nZW44X2NzX2lycV9oYW5kbGVy
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwgdTMyIGlpcikKLXsKLQlib29sIHRhc2ts
ZXQgPSBmYWxzZTsKLQotCWlmIChpaXIgJiBHVF9DT05URVhUX1NXSVRDSF9JTlRFUlJVUFQpCi0J
CXRhc2tsZXQgPSB0cnVlOwotCi0JaWYgKGlpciAmIEdUX1JFTkRFUl9VU0VSX0lOVEVSUlVQVCkg
ewotCQlpbnRlbF9lbmdpbmVfYnJlYWRjcnVtYnNfaXJxKGVuZ2luZSk7Ci0JCXRhc2tsZXQgfD0g
aW50ZWxfZW5naW5lX25lZWRzX2JyZWFkY3J1bWJfdGFza2xldChlbmdpbmUpOwotCX0KLQotCWlm
ICh0YXNrbGV0KQotCQl0YXNrbGV0X2hpX3NjaGVkdWxlKCZlbmdpbmUtPmV4ZWNsaXN0cy50YXNr
bGV0KTsKLX0KLQotc3RhdGljIHZvaWQgZ2VuOF9ndF9pcnFfYWNrKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAotCQkJICAgIHUzMiBtYXN0ZXJfY3RsLCB1MzIgZ3RfaWlyWzRdKQotewot
CXZvaWQgX19pb21lbSAqIGNvbnN0IHJlZ3MgPSBpOTE1LT51bmNvcmUucmVnczsKLQotI2RlZmlu
ZSBHRU44X0dUX0lSUVMgKEdFTjhfR1RfUkNTX0lSUSB8IFwKLQkJICAgICAgR0VOOF9HVF9CQ1Nf
SVJRIHwgXAotCQkgICAgICBHRU44X0dUX1ZDUzBfSVJRIHwgXAotCQkgICAgICBHRU44X0dUX1ZD
UzFfSVJRIHwgXAotCQkgICAgICBHRU44X0dUX1ZFQ1NfSVJRIHwgXAotCQkgICAgICBHRU44X0dU
X1BNX0lSUSB8IFwKLQkJICAgICAgR0VOOF9HVF9HVUNfSVJRKQotCi0JaWYgKG1hc3Rlcl9jdGwg
JiAoR0VOOF9HVF9SQ1NfSVJRIHwgR0VOOF9HVF9CQ1NfSVJRKSkgewotCQlndF9paXJbMF0gPSBy
YXdfcmVnX3JlYWQocmVncywgR0VOOF9HVF9JSVIoMCkpOwotCQlpZiAobGlrZWx5KGd0X2lpclsw
XSkpCi0JCQlyYXdfcmVnX3dyaXRlKHJlZ3MsIEdFTjhfR1RfSUlSKDApLCBndF9paXJbMF0pOwot
CX0KLQotCWlmIChtYXN0ZXJfY3RsICYgKEdFTjhfR1RfVkNTMF9JUlEgfCBHRU44X0dUX1ZDUzFf
SVJRKSkgewotCQlndF9paXJbMV0gPSByYXdfcmVnX3JlYWQocmVncywgR0VOOF9HVF9JSVIoMSkp
OwotCQlpZiAobGlrZWx5KGd0X2lpclsxXSkpCi0JCQlyYXdfcmVnX3dyaXRlKHJlZ3MsIEdFTjhf
R1RfSUlSKDEpLCBndF9paXJbMV0pOwotCX0KLQotCWlmIChtYXN0ZXJfY3RsICYgKEdFTjhfR1Rf
UE1fSVJRIHwgR0VOOF9HVF9HVUNfSVJRKSkgewotCQlndF9paXJbMl0gPSByYXdfcmVnX3JlYWQo
cmVncywgR0VOOF9HVF9JSVIoMikpOwotCQlpZiAobGlrZWx5KGd0X2lpclsyXSkpCi0JCQlyYXdf
cmVnX3dyaXRlKHJlZ3MsIEdFTjhfR1RfSUlSKDIpLCBndF9paXJbMl0pOwotCX0KLQotCWlmICht
YXN0ZXJfY3RsICYgR0VOOF9HVF9WRUNTX0lSUSkgewotCQlndF9paXJbM10gPSByYXdfcmVnX3Jl
YWQocmVncywgR0VOOF9HVF9JSVIoMykpOwotCQlpZiAobGlrZWx5KGd0X2lpclszXSkpCi0JCQly
YXdfcmVnX3dyaXRlKHJlZ3MsIEdFTjhfR1RfSUlSKDMpLCBndF9paXJbM10pOwotCX0KLX0KLQot
c3RhdGljIHZvaWQgZ2VuOF9ndF9pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKLQkJCQl1MzIgbWFzdGVyX2N0bCwgdTMyIGd0X2lpcls0XSkKLXsKLQlpZiAobWFzdGVy
X2N0bCAmIChHRU44X0dUX1JDU19JUlEgfCBHRU44X0dUX0JDU19JUlEpKSB7Ci0JCWdlbjhfY3Nf
aXJxX2hhbmRsZXIoaTkxNS0+ZW5naW5lW1JDUzBdLAotCQkJCSAgICBndF9paXJbMF0gPj4gR0VO
OF9SQ1NfSVJRX1NISUZUKTsKLQkJZ2VuOF9jc19pcnFfaGFuZGxlcihpOTE1LT5lbmdpbmVbQkNT
MF0sCi0JCQkJICAgIGd0X2lpclswXSA+PiBHRU44X0JDU19JUlFfU0hJRlQpOwotCX0KLQotCWlm
IChtYXN0ZXJfY3RsICYgKEdFTjhfR1RfVkNTMF9JUlEgfCBHRU44X0dUX1ZDUzFfSVJRKSkgewot
CQlnZW44X2NzX2lycV9oYW5kbGVyKGk5MTUtPmVuZ2luZVtWQ1MwXSwKLQkJCQkgICAgZ3RfaWly
WzFdID4+IEdFTjhfVkNTMF9JUlFfU0hJRlQpOwotCQlnZW44X2NzX2lycV9oYW5kbGVyKGk5MTUt
PmVuZ2luZVtWQ1MxXSwKLQkJCQkgICAgZ3RfaWlyWzFdID4+IEdFTjhfVkNTMV9JUlFfU0hJRlQp
OwotCX0KLQotCWlmIChtYXN0ZXJfY3RsICYgR0VOOF9HVF9WRUNTX0lSUSkgewotCQlnZW44X2Nz
X2lycV9oYW5kbGVyKGk5MTUtPmVuZ2luZVtWRUNTMF0sCi0JCQkJICAgIGd0X2lpclszXSA+PiBH
RU44X1ZFQ1NfSVJRX1NISUZUKTsKLQl9Ci0KLQlpZiAobWFzdGVyX2N0bCAmIChHRU44X0dUX1BN
X0lSUSB8IEdFTjhfR1RfR1VDX0lSUSkpIHsKLQkJZ2VuNl9ycHNfaXJxX2hhbmRsZXIoaTkxNSwg
Z3RfaWlyWzJdKTsKLQkJZ3VjX2lycV9oYW5kbGVyKCZpOTE1LT5ndC51Yy5ndWMsIGd0X2lpclsy
XSA+PiAxNik7Ci0JfQotfQotCiBzdGF0aWMgYm9vbCBnZW4xMV9wb3J0X2hvdHBsdWdfbG9uZ19k
ZXRlY3QoZW51bSBocGRfcGluIHBpbiwgdTMyIHZhbCkKIHsKIAlzd2l0Y2ggKHBpbikgewpAQCAt
MTg4Niw3ICsxNjU1LDcgQEAgc3RhdGljIHZvaWQgaTl4eF9waXBlX2NyY19pcnFfaGFuZGxlcihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAvKiBUaGUgUlBTIGV2ZW50cyBuZWVk
IGZvcmNld2FrZSwgc28gd2UgYWRkIHRoZW0gdG8gYSB3b3JrIHF1ZXVlIGFuZCBtYXNrIHRoZWly
CiAgKiBJTVIgYml0cyB1bnRpbCB0aGUgd29yayBpcyBkb25lLiBPdGhlciBpbnRlcnJ1cHRzIGNh
biBiZSBwcm9jZXNzZWQgd2l0aG91dAogICogdGhlIHdvcmsgcXVldWUuICovCi1zdGF0aWMgdm9p
ZCBnZW4xMV9ycHNfaXJxX2hhbmRsZXIoc3RydWN0IGludGVsX2d0ICpndCwgdTMyIHBtX2lpcikK
K3ZvaWQgZ2VuMTFfcnBzX2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHUzMiBwbV9p
aXIpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+aTkxNTsKIAlzdHJ1
Y3QgaW50ZWxfcnBzICpycHMgPSAmaTkxNS0+Z3RfcG0ucnBzOwpAQCAtMTkwNiw3ICsxNjc1LDcg
QEAgc3RhdGljIHZvaWQgZ2VuMTFfcnBzX2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3Qs
IHUzMiBwbV9paXIpCiAJc2NoZWR1bGVfd29yaygmcnBzLT53b3JrKTsKIH0KIAotc3RhdGljIHZv
aWQgZ2VuNl9ycHNfaXJxX2hhbmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCB1MzIgcG1faWlyKQordm9pZCBnZW42X3Jwc19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsIHUzMiBwbV9paXIpCiB7CiAJc3RydWN0IGludGVsX3JwcyAqcnBz
ID0gJmRldl9wcml2LT5ndF9wbS5ycHM7CiAJc3RydWN0IGludGVsX2d0ICpndCA9ICZkZXZfcHJp
di0+Z3Q7CkBAIC0xOTMxLDEyICsxNzAwLDYgQEAgc3RhdGljIHZvaWQgZ2VuNl9ycHNfaXJxX2hh
bmRsZXIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgcG1faWlyKQogCQlE
Uk1fREVCVUcoIkNvbW1hbmQgcGFyc2VyIGVycm9yLCBwbV9paXIgMHglMDh4XG4iLCBwbV9paXIp
OwogfQogCi1zdGF0aWMgdm9pZCBndWNfaXJxX2hhbmRsZXIoc3RydWN0IGludGVsX2d1YyAqZ3Vj
LCB1MTYgaWlyKQotewotCWlmIChpaXIgJiBHVUNfSU5UUl9HVUMySE9TVCkKLQkJaW50ZWxfZ3Vj
X3RvX2hvc3RfZXZlbnRfaGFuZGxlcihndWMpOwotfQotCiBzdGF0aWMgdm9pZCBpOXh4X3BpcGVz
dGF0X2lycV9yZXNldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJZW51
bSBwaXBlIHBpcGU7CkBAIC0yMjQ0LDcgKzIwMDcsNyBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgdmFs
bGV5dmlld19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpCiAJCUk5MTVfV1JJVEUoVkxW
X01BU1RFUl9JRVIsIE1BU1RFUl9JTlRFUlJVUFRfRU5BQkxFKTsKIAogCQlpZiAoZ3RfaWlyKQot
CQkJc25iX2d0X2lycV9oYW5kbGVyKGRldl9wcml2LCBndF9paXIpOworCQkJZ2VuNl9ndF9pcnFf
aGFuZGxlcigmZGV2X3ByaXYtPmd0LCBndF9paXIpOwogCQlpZiAocG1faWlyKQogCQkJZ2VuNl9y
cHNfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIHBtX2lpcik7CiAKQEAgLTIzMDIsNyArMjA2NSw3IEBA
IHN0YXRpYyBpcnFyZXR1cm5fdCBjaGVycnl2aWV3X2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQg
KmFyZykKIAkJaWVyID0gSTkxNV9SRUFEKFZMVl9JRVIpOwogCQlJOTE1X1dSSVRFKFZMVl9JRVIs
IDApOwogCi0JCWdlbjhfZ3RfaXJxX2FjayhkZXZfcHJpdiwgbWFzdGVyX2N0bCwgZ3RfaWlyKTsK
KwkJZ2VuOF9ndF9pcnFfYWNrKCZkZXZfcHJpdi0+Z3QsIG1hc3Rlcl9jdGwsIGd0X2lpcik7CiAK
IAkJaWYgKGlpciAmIEk5MTVfRElTUExBWV9QT1JUX0lOVEVSUlVQVCkKIAkJCWhvdHBsdWdfc3Rh
dHVzID0gaTl4eF9ocGRfaXJxX2FjayhkZXZfcHJpdik7CkBAIC0yMzI2LDcgKzIwODksNyBAQCBz
dGF0aWMgaXJxcmV0dXJuX3QgY2hlcnJ5dmlld19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICph
cmcpCiAJCUk5MTVfV1JJVEUoVkxWX0lFUiwgaWVyKTsKIAkJSTkxNV9XUklURShHRU44X01BU1RF
Ul9JUlEsIEdFTjhfTUFTVEVSX0lSUV9DT05UUk9MKTsKIAotCQlnZW44X2d0X2lycV9oYW5kbGVy
KGRldl9wcml2LCBtYXN0ZXJfY3RsLCBndF9paXIpOworCQlnZW44X2d0X2lycV9oYW5kbGVyKCZk
ZXZfcHJpdi0+Z3QsIG1hc3Rlcl9jdGwsIGd0X2lpcik7CiAKIAkJaWYgKGhvdHBsdWdfc3RhdHVz
KQogCQkJaTl4eF9ocGRfaXJxX2hhbmRsZXIoZGV2X3ByaXYsIGhvdHBsdWdfc3RhdHVzKTsKQEAg
LTI3NTYsOSArMjUxOSw5IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBpcm9ubGFrZV9pcnFfaGFuZGxl
cihpbnQgaXJxLCB2b2lkICphcmcpCiAJCUk5MTVfV1JJVEUoR1RJSVIsIGd0X2lpcik7CiAJCXJl
dCA9IElSUV9IQU5ETEVEOwogCQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA2KQotCQkJc25i
X2d0X2lycV9oYW5kbGVyKGRldl9wcml2LCBndF9paXIpOworCQkJZ2VuNl9ndF9pcnFfaGFuZGxl
cigmZGV2X3ByaXYtPmd0LCBndF9paXIpOwogCQllbHNlCi0JCQlpbGtfZ3RfaXJxX2hhbmRsZXIo
ZGV2X3ByaXYsIGd0X2lpcik7CisJCQlnZW41X2d0X2lycV9oYW5kbGVyKCZkZXZfcHJpdi0+Z3Qs
IGd0X2lpcik7CiAJfQogCiAJZGVfaWlyID0gSTkxNV9SRUFEKERFSUlSKTsKQEAgLTMwNjksNyAr
MjgzMiw3IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBnZW44X2lycV9oYW5kbGVyKGludCBpcnEsIHZv
aWQgKmFyZykKIAl9CiAKIAkvKiBGaW5kLCBjbGVhciwgdGhlbiBwcm9jZXNzIGVhY2ggc291cmNl
IG9mIGludGVycnVwdCAqLwotCWdlbjhfZ3RfaXJxX2FjayhkZXZfcHJpdiwgbWFzdGVyX2N0bCwg
Z3RfaWlyKTsKKwlnZW44X2d0X2lycV9hY2soJmRldl9wcml2LT5ndCwgbWFzdGVyX2N0bCwgZ3Rf
aWlyKTsKIAogCS8qIElSUXMgYXJlIHN5bmNlZCBkdXJpbmcgcnVudGltZV9zdXNwZW5kLCB3ZSBk
b24ndCByZXF1aXJlIGEgd2FrZXJlZiAqLwogCWlmIChtYXN0ZXJfY3RsICYgfkdFTjhfR1RfSVJR
UykgewpAQCAtMzA4MCwxMzQgKzI4NDMsMTEgQEAgc3RhdGljIGlycXJldHVybl90IGdlbjhfaXJx
X2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKQogCiAJZ2VuOF9tYXN0ZXJfaW50cl9lbmFibGUo
cmVncyk7CiAKLQlnZW44X2d0X2lycV9oYW5kbGVyKGRldl9wcml2LCBtYXN0ZXJfY3RsLCBndF9p
aXIpOworCWdlbjhfZ3RfaXJxX2hhbmRsZXIoJmRldl9wcml2LT5ndCwgbWFzdGVyX2N0bCwgZ3Rf
aWlyKTsKIAogCXJldHVybiBJUlFfSEFORExFRDsKIH0KIAotc3RhdGljIHUzMgotZ2VuMTFfZ3Rf
ZW5naW5lX2lkZW50aXR5KHN0cnVjdCBpbnRlbF9ndCAqZ3QsCi0JCQkgY29uc3QgdW5zaWduZWQg
aW50IGJhbmssIGNvbnN0IHVuc2lnbmVkIGludCBiaXQpCi17Ci0Jdm9pZCBfX2lvbWVtICogY29u
c3QgcmVncyA9IGd0LT51bmNvcmUtPnJlZ3M7Ci0JdTMyIHRpbWVvdXRfdHM7Ci0JdTMyIGlkZW50
OwotCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZ3QtPmk5MTUtPmlycV9sb2NrKTsKLQotCXJhd19y
ZWdfd3JpdGUocmVncywgR0VOMTFfSUlSX1JFR19TRUxFQ1RPUihiYW5rKSwgQklUKGJpdCkpOwot
Ci0JLyoKLQkgKiBOQjogU3BlY3MgZG8gbm90IHNwZWNpZnkgaG93IGxvbmcgdG8gc3BpbiB3YWl0
LAotCSAqIHNvIHdlIGRvIH4xMDB1cyBhcyBhbiBlZHVjYXRlZCBndWVzcy4KLQkgKi8KLQl0aW1l
b3V0X3RzID0gKGxvY2FsX2Nsb2NrKCkgPj4gMTApICsgMTAwOwotCWRvIHsKLQkJaWRlbnQgPSBy
YXdfcmVnX3JlYWQocmVncywgR0VOMTFfSU5UUl9JREVOVElUWV9SRUcoYmFuaykpOwotCX0gd2hp
bGUgKCEoaWRlbnQgJiBHRU4xMV9JTlRSX0RBVEFfVkFMSUQpICYmCi0JCSAhdGltZV9hZnRlcjMy
KGxvY2FsX2Nsb2NrKCkgPj4gMTAsIHRpbWVvdXRfdHMpKTsKLQotCWlmICh1bmxpa2VseSghKGlk
ZW50ICYgR0VOMTFfSU5UUl9EQVRBX1ZBTElEKSkpIHsKLQkJRFJNX0VSUk9SKCJJTlRSX0lERU5U
SVRZX1JFRyV1OiV1IDB4JTA4eCBub3QgdmFsaWQhXG4iLAotCQkJICBiYW5rLCBiaXQsIGlkZW50
KTsKLQkJcmV0dXJuIDA7Ci0JfQotCi0JcmF3X3JlZ193cml0ZShyZWdzLCBHRU4xMV9JTlRSX0lE
RU5USVRZX1JFRyhiYW5rKSwKLQkJICAgICAgR0VOMTFfSU5UUl9EQVRBX1ZBTElEKTsKLQotCXJl
dHVybiBpZGVudDsKLX0KLQotc3RhdGljIHZvaWQKLWdlbjExX290aGVyX2lycV9oYW5kbGVyKHN0
cnVjdCBpbnRlbF9ndCAqZ3QsIGNvbnN0IHU4IGluc3RhbmNlLAotCQkJY29uc3QgdTE2IGlpcikK
LXsKLQlpZiAoaW5zdGFuY2UgPT0gT1RIRVJfR1VDX0lOU1RBTkNFKQotCQlyZXR1cm4gZ3VjX2ly
cV9oYW5kbGVyKCZndC0+dWMuZ3VjLCBpaXIpOwotCi0JaWYgKGluc3RhbmNlID09IE9USEVSX0dU
UE1fSU5TVEFOQ0UpCi0JCXJldHVybiBnZW4xMV9ycHNfaXJxX2hhbmRsZXIoZ3QsIGlpcik7Ci0K
LQlXQVJOX09OQ0UoMSwgInVuaGFuZGxlZCBvdGhlciBpbnRlcnJ1cHQgaW5zdGFuY2U9MHgleCwg
aWlyPTB4JXhcbiIsCi0JCSAgaW5zdGFuY2UsIGlpcik7Ci19Ci0KLXN0YXRpYyB2b2lkCi1nZW4x
MV9lbmdpbmVfaXJxX2hhbmRsZXIoc3RydWN0IGludGVsX2d0ICpndCwgY29uc3QgdTggY2xhc3Ms
Ci0JCQkgY29uc3QgdTggaW5zdGFuY2UsIGNvbnN0IHUxNiBpaXIpCi17Ci0Jc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lOwotCi0JaWYgKGluc3RhbmNlIDw9IE1BWF9FTkdJTkVfSU5TVEFO
Q0UpCi0JCWVuZ2luZSA9IGd0LT5lbmdpbmVfY2xhc3NbY2xhc3NdW2luc3RhbmNlXTsKLQllbHNl
Ci0JCWVuZ2luZSA9IE5VTEw7Ci0KLQlpZiAobGlrZWx5KGVuZ2luZSkpCi0JCXJldHVybiBnZW44
X2NzX2lycV9oYW5kbGVyKGVuZ2luZSwgaWlyKTsKLQotCVdBUk5fT05DRSgxLCAidW5oYW5kbGVk
IGVuZ2luZSBpbnRlcnJ1cHQgY2xhc3M9MHgleCwgaW5zdGFuY2U9MHgleFxuIiwKLQkJICBjbGFz
cywgaW5zdGFuY2UpOwotfQotCi1zdGF0aWMgdm9pZAotZ2VuMTFfZ3RfaWRlbnRpdHlfaGFuZGxl
cihzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBjb25zdCB1MzIgaWRlbnRpdHkpCi17Ci0JY29uc3QgdTgg
Y2xhc3MgPSBHRU4xMV9JTlRSX0VOR0lORV9DTEFTUyhpZGVudGl0eSk7Ci0JY29uc3QgdTggaW5z
dGFuY2UgPSBHRU4xMV9JTlRSX0VOR0lORV9JTlNUQU5DRShpZGVudGl0eSk7Ci0JY29uc3QgdTE2
IGludHIgPSBHRU4xMV9JTlRSX0VOR0lORV9JTlRSKGlkZW50aXR5KTsKLQotCWlmICh1bmxpa2Vs
eSghaW50cikpCi0JCXJldHVybjsKLQotCWlmIChjbGFzcyA8PSBDT1BZX0VOR0lORV9DTEFTUykK
LQkJcmV0dXJuIGdlbjExX2VuZ2luZV9pcnFfaGFuZGxlcihndCwgY2xhc3MsIGluc3RhbmNlLCBp
bnRyKTsKLQotCWlmIChjbGFzcyA9PSBPVEhFUl9DTEFTUykKLQkJcmV0dXJuIGdlbjExX290aGVy
X2lycV9oYW5kbGVyKGd0LCBpbnN0YW5jZSwgaW50cik7Ci0KLQlXQVJOX09OQ0UoMSwgInVua25v
d24gaW50ZXJydXB0IGNsYXNzPTB4JXgsIGluc3RhbmNlPTB4JXgsIGludHI9MHgleFxuIiwKLQkJ
ICBjbGFzcywgaW5zdGFuY2UsIGludHIpOwotfQotCi1zdGF0aWMgdm9pZAotZ2VuMTFfZ3RfYmFu
a19oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGNvbnN0IHVuc2lnbmVkIGludCBiYW5rKQot
ewotCXZvaWQgX19pb21lbSAqIGNvbnN0IHJlZ3MgPSBndC0+dW5jb3JlLT5yZWdzOwotCXVuc2ln
bmVkIGxvbmcgaW50cl9kdzsKLQl1bnNpZ25lZCBpbnQgYml0OwotCi0JbG9ja2RlcF9hc3NlcnRf
aGVsZCgmZ3QtPmk5MTUtPmlycV9sb2NrKTsKLQotCWludHJfZHcgPSByYXdfcmVnX3JlYWQocmVn
cywgR0VOMTFfR1RfSU5UUl9EVyhiYW5rKSk7Ci0KLQlmb3JfZWFjaF9zZXRfYml0KGJpdCwgJmlu
dHJfZHcsIDMyKSB7Ci0JCWNvbnN0IHUzMiBpZGVudCA9IGdlbjExX2d0X2VuZ2luZV9pZGVudGl0
eShndCwgYmFuaywgYml0KTsKLQotCQlnZW4xMV9ndF9pZGVudGl0eV9oYW5kbGVyKGd0LCBpZGVu
dCk7Ci0JfQotCi0JLyogQ2xlYXIgbXVzdCBiZSBhZnRlciBzaGFyZWQgaGFzIGJlZW4gc2VydmVk
IGZvciBlbmdpbmUgKi8KLQlyYXdfcmVnX3dyaXRlKHJlZ3MsIEdFTjExX0dUX0lOVFJfRFcoYmFu
ayksIGludHJfZHcpOwotfQotCi1zdGF0aWMgdm9pZAotZ2VuMTFfZ3RfaXJxX2hhbmRsZXIoc3Ry
dWN0IGludGVsX2d0ICpndCwgY29uc3QgdTMyIG1hc3Rlcl9jdGwpCi17Ci0Jc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUgPSBndC0+aTkxNTsKLQl1bnNpZ25lZCBpbnQgYmFuazsKLQotCXNw
aW5fbG9jaygmaTkxNS0+aXJxX2xvY2spOwotCi0JZm9yIChiYW5rID0gMDsgYmFuayA8IDI7IGJh
bmsrKykgewotCQlpZiAobWFzdGVyX2N0bCAmIEdFTjExX0dUX0RXX0lSUShiYW5rKSkKLQkJCWdl
bjExX2d0X2JhbmtfaGFuZGxlcihndCwgYmFuayk7Ci0JfQotCi0Jc3Bpbl91bmxvY2soJmk5MTUt
PmlycV9sb2NrKTsKLX0KLQogc3RhdGljIHUzMgogZ2VuMTFfZ3VfbWlzY19pcnFfYWNrKHN0cnVj
dCBpbnRlbF9ndCAqZ3QsIGNvbnN0IHUzMiBtYXN0ZXJfY3RsKQogewpAQCAtMzUxNiwxNSArMzE1
Niw2IEBAIHN0YXRpYyB2b2lkIGlieF9pcnFfcHJlX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKIAlQT1NUSU5HX1JFQUQoU0RFSUVSKTsKIH0KIAotc3RhdGlj
IHZvaWQgZ2VuNV9ndF9pcnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQotewotCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwot
Ci0JR0VOM19JUlFfUkVTRVQodW5jb3JlLCBHVCk7Ci0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
Pj0gNikKLQkJR0VOM19JUlFfUkVTRVQodW5jb3JlLCBHRU42X1BNKTsKLX0KLQogc3RhdGljIHZv
aWQgdmx2X2Rpc3BsYXlfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKIHsKIAlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsK
QEAgLTM1ODksNyArMzIyMCw3IEBAIHN0YXRpYyB2b2lkIGlyb25sYWtlX2lycV9yZXNldChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCWludGVsX3VuY29yZV93cml0ZSh1bmNv
cmUsIEVEUF9QU1JfSUlSLCAweGZmZmZmZmZmKTsKIAl9CiAKLQlnZW41X2d0X2lycV9yZXNldChk
ZXZfcHJpdik7CisJZ2VuNV9ndF9pcnFfcmVzZXQoJmRldl9wcml2LT5ndCk7CiAKIAlpYnhfaXJx
X3Jlc2V0KGRldl9wcml2KTsKIH0KQEAgLTM1OTksNyArMzIzMCw3IEBAIHN0YXRpYyB2b2lkIHZh
bGxleXZpZXdfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlJ
OTE1X1dSSVRFKFZMVl9NQVNURVJfSUVSLCAwKTsKIAlQT1NUSU5HX1JFQUQoVkxWX01BU1RFUl9J
RVIpOwogCi0JZ2VuNV9ndF9pcnFfcmVzZXQoZGV2X3ByaXYpOworCWdlbjVfZ3RfaXJxX3Jlc2V0
KCZkZXZfcHJpdi0+Z3QpOwogCiAJc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsK
IAlpZiAoZGV2X3ByaXYtPmRpc3BsYXlfaXJxc19lbmFibGVkKQpAQCAtMzYwNywxNiArMzIzOCw2
IEBAIHN0YXRpYyB2b2lkIHZhbGxleXZpZXdfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKIAlzcGluX3VubG9ja19pcnEoJmRldl9wcml2LT5pcnFfbG9jayk7CiB9
CiAKLXN0YXRpYyB2b2lkIGdlbjhfZ3RfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKLXsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYt
PnVuY29yZTsKLQotCUdFTjhfSVJRX1JFU0VUX05EWCh1bmNvcmUsIEdULCAwKTsKLQlHRU44X0lS
UV9SRVNFVF9ORFgodW5jb3JlLCBHVCwgMSk7Ci0JR0VOOF9JUlFfUkVTRVRfTkRYKHVuY29yZSwg
R1QsIDIpOwotCUdFTjhfSVJRX1JFU0VUX05EWCh1bmNvcmUsIEdULCAzKTsKLX0KLQogc3RhdGlj
IHZvaWQgZ2VuOF9pcnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQog
ewogCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwpAQCAt
MzYyNCw3ICszMjQ1LDcgQEAgc3RhdGljIHZvaWQgZ2VuOF9pcnFfcmVzZXQoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogCiAJZ2VuOF9tYXN0ZXJfaW50cl9kaXNhYmxlKGRldl9w
cml2LT51bmNvcmUucmVncyk7CiAKLQlnZW44X2d0X2lycV9yZXNldChkZXZfcHJpdik7CisJZ2Vu
OF9ndF9pcnFfcmVzZXQoJmRldl9wcml2LT5ndCk7CiAKIAlpbnRlbF91bmNvcmVfd3JpdGUodW5j
b3JlLCBFRFBfUFNSX0lNUiwgMHhmZmZmZmZmZik7CiAJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29y
ZSwgRURQX1BTUl9JSVIsIDB4ZmZmZmZmZmYpOwpAQCAtMzY0MiwyNyArMzI2Myw2IEBAIHN0YXRp
YyB2b2lkIGdlbjhfaXJxX3Jlc2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
IAkJaWJ4X2lycV9yZXNldChkZXZfcHJpdik7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbjExX2d0X2ly
cV9yZXNldChzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQotewotCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVu
Y29yZSA9IGd0LT51bmNvcmU7Ci0KLQkvKiBEaXNhYmxlIFJDUywgQkNTLCBWQ1MgYW5kIFZFQ1Mg
Y2xhc3MgZW5naW5lcy4gKi8KLQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9SRU5E
RVJfQ09QWV9JTlRSX0VOQUJMRSwgMCk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VO
MTFfVkNTX1ZFQ1NfSU5UUl9FTkFCTEUsCSAgMCk7Ci0KLQkvKiBSZXN0b3JlIG1hc2tzIGlycXMg
b24gUkNTLCBCQ1MsIFZDUyBhbmQgVkVDUyBlbmdpbmVzLiAqLwotCWludGVsX3VuY29yZV93cml0
ZSh1bmNvcmUsIEdFTjExX1JDUzBfUlNWRF9JTlRSX01BU0ssCX4wKTsKLQlpbnRlbF91bmNvcmVf
d3JpdGUodW5jb3JlLCBHRU4xMV9CQ1NfUlNWRF9JTlRSX01BU0ssCX4wKTsKLQlpbnRlbF91bmNv
cmVfd3JpdGUodW5jb3JlLCBHRU4xMV9WQ1MwX1ZDUzFfSU5UUl9NQVNLLAl+MCk7Ci0JaW50ZWxf
dW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfVkNTMl9WQ1MzX0lOVFJfTUFTSywJfjApOwotCWlu
dGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX1ZFQ1MwX1ZFQ1MxX0lOVFJfTUFTSywJfjAp
OwotCi0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfR1BNX1dHQk9YUEVSRl9JTlRS
X0VOQUJMRSwgMCk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfR1BNX1dHQk9Y
UEVSRl9JTlRSX01BU0ssICB+MCk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFf
R1VDX1NHX0lOVFJfRU5BQkxFLCAwKTsKLQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4x
MV9HVUNfU0dfSU5UUl9NQVNLLCAgfjApOwotfQotCiBzdGF0aWMgdm9pZCBnZW4xMV9pcnFfcmVz
ZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCXN0cnVjdCBpbnRlbF91
bmNvcmUgKnVuY29yZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwpAQCAtMzc0NCw3ICszMzQ0LDcgQEAg
c3RhdGljIHZvaWQgY2hlcnJ5dmlld19pcnFfcmVzZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQogCUk5MTVfV1JJVEUoR0VOOF9NQVNURVJfSVJRLCAwKTsKIAlQT1NUSU5HX1JF
QUQoR0VOOF9NQVNURVJfSVJRKTsKIAotCWdlbjhfZ3RfaXJxX3Jlc2V0KGRldl9wcml2KTsKKwln
ZW44X2d0X2lycV9yZXNldCgmZGV2X3ByaXYtPmd0KTsKIAogCUdFTjNfSVJRX1JFU0VUKHVuY29y
ZSwgR0VOOF9QQ1VfKTsKIApAQCAtNDA1Nyw0NCArMzY1Nyw2IEBAIHN0YXRpYyB2b2lkIGlieF9p
cnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCQlzcHRf
aHBkX2RldGVjdGlvbl9zZXR1cChkZXZfcHJpdik7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbjVfZ3Rf
aXJxX3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlz
dHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsKLQl1MzIgcG1f
aXJxcywgZ3RfaXJxczsKLQotCXBtX2lycXMgPSBndF9pcnFzID0gMDsKLQotCWRldl9wcml2LT5n
dF9pcnFfbWFzayA9IH4wOwotCWlmIChIQVNfTDNfRFBGKGRldl9wcml2KSkgewotCQkvKiBMMyBw
YXJpdHkgaW50ZXJydXB0IGlzIGFsd2F5cyB1bm1hc2tlZC4gKi8KLQkJZGV2X3ByaXYtPmd0X2ly
cV9tYXNrID0gfkdUX1BBUklUWV9FUlJPUihkZXZfcHJpdik7Ci0JCWd0X2lycXMgfD0gR1RfUEFS
SVRZX0VSUk9SKGRldl9wcml2KTsKLQl9Ci0KLQlndF9pcnFzIHw9IEdUX1JFTkRFUl9VU0VSX0lO
VEVSUlVQVDsKLQlpZiAoSVNfR0VOKGRldl9wcml2LCA1KSkgewotCQlndF9pcnFzIHw9IElMS19C
U0RfVVNFUl9JTlRFUlJVUFQ7Ci0JfSBlbHNlIHsKLQkJZ3RfaXJxcyB8PSBHVF9CTFRfVVNFUl9J
TlRFUlJVUFQgfCBHVF9CU0RfVVNFUl9JTlRFUlJVUFQ7Ci0JfQotCi0JR0VOM19JUlFfSU5JVCh1
bmNvcmUsIEdULCBkZXZfcHJpdi0+Z3RfaXJxX21hc2ssIGd0X2lycXMpOwotCi0JaWYgKElOVEVM
X0dFTihkZXZfcHJpdikgPj0gNikgewotCQkvKgotCQkgKiBSUFMgaW50ZXJydXB0cyB3aWxsIGdl
dCBlbmFibGVkL2Rpc2FibGVkIG9uIGRlbWFuZCB3aGVuIFJQUwotCQkgKiBpdHNlbGYgaXMgZW5h
YmxlZC9kaXNhYmxlZC4KLQkJICovCi0JCWlmIChIQVNfRU5HSU5FKGRldl9wcml2LCBWRUNTMCkp
IHsKLQkJCXBtX2lycXMgfD0gUE1fVkVCT1hfVVNFUl9JTlRFUlJVUFQ7Ci0JCQlkZXZfcHJpdi0+
Z3QucG1faWVyIHw9IFBNX1ZFQk9YX1VTRVJfSU5URVJSVVBUOwotCQl9Ci0KLQkJZGV2X3ByaXYt
Pmd0LnBtX2ltciA9IDB4ZmZmZmZmZmY7Ci0JCUdFTjNfSVJRX0lOSVQodW5jb3JlLCBHRU42X1BN
LCBkZXZfcHJpdi0+Z3QucG1faW1yLCBwbV9pcnFzKTsKLQl9Ci19Ci0KIHN0YXRpYyB2b2lkIGly
b25sYWtlX2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
CiB7CiAJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlID0gJmRldl9wcml2LT51bmNvcmU7CkBA
IC00MTI4LDcgKzM2OTAsNyBAQCBzdGF0aWMgdm9pZCBpcm9ubGFrZV9pcnFfcG9zdGluc3RhbGwo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCUdFTjNfSVJRX0lOSVQodW5jb3Jl
LCBERSwgZGV2X3ByaXYtPmlycV9tYXNrLAogCQkgICAgICBkaXNwbGF5X21hc2sgfCBleHRyYV9t
YXNrKTsKIAotCWdlbjVfZ3RfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKKwlnZW41X2d0X2ly
cV9wb3N0aW5zdGFsbCgmZGV2X3ByaXYtPmd0KTsKIAogCWlsa19ocGRfZGV0ZWN0aW9uX3NldHVw
KGRldl9wcml2KTsKIApAQCAtNDE3Nyw3ICszNzM5LDcgQEAgdm9pZCB2YWxsZXl2aWV3X2Rpc2Fi
bGVfZGlzcGxheV9pcnFzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogc3Rh
dGljIHZvaWQgdmFsbGV5dmlld19pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQogewotCWdlbjVfZ3RfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKKwln
ZW41X2d0X2lycV9wb3N0aW5zdGFsbCgmZGV2X3ByaXYtPmd0KTsKIAogCXNwaW5fbG9ja19pcnEo
JmRldl9wcml2LT5pcnFfbG9jayk7CiAJaWYgKGRldl9wcml2LT5kaXNwbGF5X2lycXNfZW5hYmxl
ZCkKQEAgLTQxODgsNDEgKzM3NTAsNiBAQCBzdGF0aWMgdm9pZCB2YWxsZXl2aWV3X2lycV9wb3N0
aW5zdGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJUE9TVElOR19SRUFE
KFZMVl9NQVNURVJfSUVSKTsKIH0KIAotc3RhdGljIHZvaWQgZ2VuOF9ndF9pcnFfcG9zdGluc3Rh
bGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCi17Ci0Jc3RydWN0IGludGVsX2d0ICpn
dCA9ICZpOTE1LT5ndDsKLQlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSBndC0+dW5jb3Jl
OwotCi0JLyogVGhlc2UgYXJlIGludGVycnVwdHMgd2UnbGwgdG9nZ2xlIHdpdGggdGhlIHJpbmcg
bWFzayByZWdpc3RlciAqLwotCXUzMiBndF9pbnRlcnJ1cHRzW10gPSB7Ci0JCShHVF9SRU5ERVJf
VVNFUl9JTlRFUlJVUFQgPDwgR0VOOF9SQ1NfSVJRX1NISUZUIHwKLQkJIEdUX0NPTlRFWFRfU1dJ
VENIX0lOVEVSUlVQVCA8PCBHRU44X1JDU19JUlFfU0hJRlQgfAotCQkgR1RfUkVOREVSX1VTRVJf
SU5URVJSVVBUIDw8IEdFTjhfQkNTX0lSUV9TSElGVCB8Ci0JCSBHVF9DT05URVhUX1NXSVRDSF9J
TlRFUlJVUFQgPDwgR0VOOF9CQ1NfSVJRX1NISUZUKSwKLQotCQkoR1RfUkVOREVSX1VTRVJfSU5U
RVJSVVBUIDw8IEdFTjhfVkNTMF9JUlFfU0hJRlQgfAotCQkgR1RfQ09OVEVYVF9TV0lUQ0hfSU5U
RVJSVVBUIDw8IEdFTjhfVkNTMF9JUlFfU0hJRlQgfAotCQkgR1RfUkVOREVSX1VTRVJfSU5URVJS
VVBUIDw8IEdFTjhfVkNTMV9JUlFfU0hJRlQgfAotCQkgR1RfQ09OVEVYVF9TV0lUQ0hfSU5URVJS
VVBUIDw8IEdFTjhfVkNTMV9JUlFfU0hJRlQpLAotCi0JCTAsCi0KLQkJKEdUX1JFTkRFUl9VU0VS
X0lOVEVSUlVQVCA8PCBHRU44X1ZFQ1NfSVJRX1NISUZUIHwKLQkJIEdUX0NPTlRFWFRfU1dJVENI
X0lOVEVSUlVQVCA8PCBHRU44X1ZFQ1NfSVJRX1NISUZUKQotCX07Ci0KLQlndC0+cG1faWVyID0g
MHgwOwotCWd0LT5wbV9pbXIgPSB+Z3QtPnBtX2llcjsKLQlHRU44X0lSUV9JTklUX05EWCh1bmNv
cmUsIEdULCAwLCB+Z3RfaW50ZXJydXB0c1swXSwgZ3RfaW50ZXJydXB0c1swXSk7Ci0JR0VOOF9J
UlFfSU5JVF9ORFgodW5jb3JlLCBHVCwgMSwgfmd0X2ludGVycnVwdHNbMV0sIGd0X2ludGVycnVw
dHNbMV0pOwotCS8qCi0JICogUlBTIGludGVycnVwdHMgd2lsbCBnZXQgZW5hYmxlZC9kaXNhYmxl
ZCBvbiBkZW1hbmQgd2hlbiBSUFMgaXRzZWxmCi0JICogaXMgZW5hYmxlZC9kaXNhYmxlZC4gU2Ft
ZSB3aWwgYmUgdGhlIGNhc2UgZm9yIEd1QyBpbnRlcnJ1cHRzLgotCSAqLwotCUdFTjhfSVJRX0lO
SVRfTkRYKHVuY29yZSwgR1QsIDIsIGd0LT5wbV9pbXIsIGd0LT5wbV9pZXIpOwotCUdFTjhfSVJR
X0lOSVRfTkRYKHVuY29yZSwgR1QsIDMsIH5ndF9pbnRlcnJ1cHRzWzNdLCBndF9pbnRlcnJ1cHRz
WzNdKTsKLX0KLQogc3RhdGljIHZvaWQgZ2VuOF9kZV9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewogCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29y
ZSA9ICZkZXZfcHJpdi0+dW5jb3JlOwpAQCAtNDI5OCw3ICszODI1LDcgQEAgc3RhdGljIHZvaWQg
Z2VuOF9pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQog
CWlmIChIQVNfUENIX1NQTElUKGRldl9wcml2KSkKIAkJaWJ4X2lycV9wcmVfcG9zdGluc3RhbGwo
ZGV2X3ByaXYpOwogCi0JZ2VuOF9ndF9pcnFfcG9zdGluc3RhbGwoZGV2X3ByaXYpOworCWdlbjhf
Z3RfaXJxX3Bvc3RpbnN0YWxsKCZkZXZfcHJpdi0+Z3QpOwogCWdlbjhfZGVfaXJxX3Bvc3RpbnN0
YWxsKGRldl9wcml2KTsKIAogCWlmIChIQVNfUENIX1NQTElUKGRldl9wcml2KSkKQEAgLTQzMDcs
NDAgKzM4MzQsNiBAQCBzdGF0aWMgdm9pZCBnZW44X2lycV9wb3N0aW5zdGFsbChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJZ2VuOF9tYXN0ZXJfaW50cl9lbmFibGUoZGV2X3By
aXYtPnVuY29yZS5yZWdzKTsKIH0KIAotc3RhdGljIHZvaWQgZ2VuMTFfZ3RfaXJxX3Bvc3RpbnN0
YWxsKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCi17Ci0JY29uc3QgdTMyIGlycXMgPSBHVF9SRU5ERVJf
VVNFUl9JTlRFUlJVUFQgfCBHVF9DT05URVhUX1NXSVRDSF9JTlRFUlJVUFQ7Ci0Jc3RydWN0IGlu
dGVsX3VuY29yZSAqdW5jb3JlID0gZ3QtPnVuY29yZTsKLQljb25zdCB1MzIgZG1hc2sgPSBpcnFz
IDw8IDE2IHwgaXJxczsKLQljb25zdCB1MzIgc21hc2sgPSBpcnFzIDw8IDE2OwotCi0JQlVJTERf
QlVHX09OKGlycXMgJiAweGZmZmYwMDAwKTsKLQotCS8qIEVuYWJsZSBSQ1MsIEJDUywgVkNTIGFu
ZCBWRUNTIGNsYXNzIGludGVycnVwdHMuICovCi0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwg
R0VOMTFfUkVOREVSX0NPUFlfSU5UUl9FTkFCTEUsIGRtYXNrKTsKLQlpbnRlbF91bmNvcmVfd3Jp
dGUodW5jb3JlLCBHRU4xMV9WQ1NfVkVDU19JTlRSX0VOQUJMRSwgZG1hc2spOwotCi0JLyogVW5t
YXNrIGlycXMgb24gUkNTLCBCQ1MsIFZDUyBhbmQgVkVDUyBlbmdpbmVzLiAqLwotCWludGVsX3Vu
Y29yZV93cml0ZSh1bmNvcmUsIEdFTjExX1JDUzBfUlNWRF9JTlRSX01BU0ssIH5zbWFzayk7Ci0J
aW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfQkNTX1JTVkRfSU5UUl9NQVNLLCB+c21h
c2spOwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX1ZDUzBfVkNTMV9JTlRSX01B
U0ssIH5kbWFzayk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfVkNTMl9WQ1Mz
X0lOVFJfTUFTSywgfmRtYXNrKTsKLQlpbnRlbF91bmNvcmVfd3JpdGUodW5jb3JlLCBHRU4xMV9W
RUNTMF9WRUNTMV9JTlRSX01BU0ssIH5kbWFzayk7Ci0KLQkvKgotCSAqIFJQUyBpbnRlcnJ1cHRz
IHdpbGwgZ2V0IGVuYWJsZWQvZGlzYWJsZWQgb24gZGVtYW5kIHdoZW4gUlBTIGl0c2VsZgotCSAq
IGlzIGVuYWJsZWQvZGlzYWJsZWQuCi0JICovCi0JZ3QtPnBtX2llciA9IDB4MDsKLQlndC0+cG1f
aW1yID0gfmd0LT5wbV9pZXI7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFfR1BN
X1dHQk9YUEVSRl9JTlRSX0VOQUJMRSwgMCk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwg
R0VOMTFfR1BNX1dHQk9YUEVSRl9JTlRSX01BU0ssICB+MCk7Ci0KLQkvKiBTYW1lIHRoaW5nIGZv
ciBHdUMgaW50ZXJydXB0cyAqLwotCWludGVsX3VuY29yZV93cml0ZSh1bmNvcmUsIEdFTjExX0dV
Q19TR19JTlRSX0VOQUJMRSwgMCk7Ci0JaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgR0VOMTFf
R1VDX1NHX0lOVFJfTUFTSywgIH4wKTsKLX0KLQogc3RhdGljIHZvaWQgaWNwX2lycV9wb3N0aW5z
dGFsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiB7CiAJdTMyIG1hc2sgPSBT
REVfR01CVVNfSUNQOwpAQCAtNDM4Myw3ICszODc2LDcgQEAgc3RhdGljIHZvaWQgZ2VuMTFfaXJx
X3Bvc3RpbnN0YWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogc3RhdGlj
IHZvaWQgY2hlcnJ5dmlld19pcnFfcG9zdGluc3RhbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQogewotCWdlbjhfZ3RfaXJxX3Bvc3RpbnN0YWxsKGRldl9wcml2KTsKKwlnZW44
X2d0X2lycV9wb3N0aW5zdGFsbCgmZGV2X3ByaXYtPmd0KTsKIAogCXNwaW5fbG9ja19pcnEoJmRl
dl9wcml2LT5pcnFfbG9jayk7CiAJaWYgKGRldl9wcml2LT5kaXNwbGF5X2lycXNfZW5hYmxlZCkK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfaXJxLmggYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2lycS5oCmluZGV4IDQyYzg4MWQ4YWQ2OS4uOGU3ZTYwNzE3NzdlIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2lycS5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfaXJxLmgKQEAgLTEwLDYgKzEwLDcgQEAKICNpbmNsdWRlIDxsaW51
eC90eXBlcy5oPgogCiAjaW5jbHVkZSAiZGlzcGxheS9pbnRlbF9kaXNwbGF5LmgiCisjaW5jbHVk
ZSAiaTkxNV9yZWcuaCIKIAogc3RydWN0IGRybV9jcnRjOwogc3RydWN0IGRybV9kZXZpY2U7CkBA
IC0xOSw2ICsyMCwxMCBAQCBzdHJ1Y3QgaW50ZWxfY3J0YzsKIHN0cnVjdCBpbnRlbF9jcnRjOwog
c3RydWN0IGludGVsX2d0Owogc3RydWN0IGludGVsX2d1YzsKK3N0cnVjdCBpbnRlbF91bmNvcmU7
CisKK3ZvaWQgZ2VuMTFfcnBzX2lycV9oYW5kbGVyKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHUzMiBw
bV9paXIpOwordm9pZCBnZW42X3Jwc19pcnFfaGFuZGxlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIHUzMiBwbV9paXIpOwogCiB2b2lkIGludGVsX2lycV9pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiB2b2lkIGludGVsX2lycV9maW5pKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CkBAIC0xMjcsNCArMTMyLDQ2IEBAIHZvaWQgaTk2
NV9kaXNhYmxlX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpOwogdm9pZCBpbGtfZGlzYWJs
ZV92Ymxhbmsoc3RydWN0IGRybV9jcnRjICpjcnRjKTsKIHZvaWQgYmR3X2Rpc2FibGVfdmJsYW5r
KHN0cnVjdCBkcm1fY3J0YyAqY3J0Yyk7CiAKK3ZvaWQgZ2VuMl9pcnFfcmVzZXQoc3RydWN0IGlu
dGVsX3VuY29yZSAqdW5jb3JlKTsKK3ZvaWQgZ2VuM19pcnFfcmVzZXQoc3RydWN0IGludGVsX3Vu
Y29yZSAqdW5jb3JlLCBpOTE1X3JlZ190IGltciwKKwkJICAgIGk5MTVfcmVnX3QgaWlyLCBpOTE1
X3JlZ190IGllcik7CisKK3ZvaWQgZ2VuMl9pcnFfaW5pdChzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1
bmNvcmUsCisJCSAgIHUzMiBpbXJfdmFsLCB1MzIgaWVyX3ZhbCk7Cit2b2lkIGdlbjNfaXJxX2lu
aXQoc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3JlLAorCQkgICBpOTE1X3JlZ190IGltciwgdTMy
IGltcl92YWwsCisJCSAgIGk5MTVfcmVnX3QgaWVyLCB1MzIgaWVyX3ZhbCwKKwkJICAgaTkxNV9y
ZWdfdCBpaXIpOworCisjZGVmaW5lIEdFTjhfSVJRX1JFU0VUX05EWCh1bmNvcmUsIHR5cGUsIHdo
aWNoKSBcCisoeyBcCisJdW5zaWduZWQgaW50IHdoaWNoXyA9IHdoaWNoOyBcCisJZ2VuM19pcnFf
cmVzZXQoKHVuY29yZSksIEdFTjhfIyN0eXBlIyNfSU1SKHdoaWNoXyksIFwKKwkJICAgICAgIEdF
TjhfIyN0eXBlIyNfSUlSKHdoaWNoXyksIEdFTjhfIyN0eXBlIyNfSUVSKHdoaWNoXykpOyBcCit9
KQorCisjZGVmaW5lIEdFTjNfSVJRX1JFU0VUKHVuY29yZSwgdHlwZSkgXAorCWdlbjNfaXJxX3Jl
c2V0KCh1bmNvcmUpLCB0eXBlIyNJTVIsIHR5cGUjI0lJUiwgdHlwZSMjSUVSKQorCisjZGVmaW5l
IEdFTjJfSVJRX1JFU0VUKHVuY29yZSkgXAorCWdlbjJfaXJxX3Jlc2V0KHVuY29yZSkKKworI2Rl
ZmluZSBHRU44X0lSUV9JTklUX05EWCh1bmNvcmUsIHR5cGUsIHdoaWNoLCBpbXJfdmFsLCBpZXJf
dmFsKSBcCisoeyBcCisJdW5zaWduZWQgaW50IHdoaWNoXyA9IHdoaWNoOyBcCisJZ2VuM19pcnFf
aW5pdCgodW5jb3JlKSwgXAorCQkgICAgICBHRU44XyMjdHlwZSMjX0lNUih3aGljaF8pLCBpbXJf
dmFsLCBcCisJCSAgICAgIEdFTjhfIyN0eXBlIyNfSUVSKHdoaWNoXyksIGllcl92YWwsIFwKKwkJ
ICAgICAgR0VOOF8jI3R5cGUjI19JSVIod2hpY2hfKSk7IFwKK30pCisKKyNkZWZpbmUgR0VOM19J
UlFfSU5JVCh1bmNvcmUsIHR5cGUsIGltcl92YWwsIGllcl92YWwpIFwKKwlnZW4zX2lycV9pbml0
KCh1bmNvcmUpLCBcCisJCSAgICAgIHR5cGUjI0lNUiwgaW1yX3ZhbCwgXAorCQkgICAgICB0eXBl
IyNJRVIsIGllcl92YWwsIFwKKwkJICAgICAgdHlwZSMjSUlSKQorCisjZGVmaW5lIEdFTjJfSVJR
X0lOSVQodW5jb3JlLCBpbXJfdmFsLCBpZXJfdmFsKSBcCisJZ2VuMl9pcnFfaW5pdCgodW5jb3Jl
KSwgaW1yX3ZhbCwgaWVyX3ZhbCkKKwogI2VuZGlmIC8qIF9fSTkxNV9JUlFfSF9fICovCi0tIAoy
LjIzLjAucmMxCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B4521375043
	for <lists+intel-gfx@lfdr.de>; Thu,  6 May 2021 09:38:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A743289E8C;
	Thu,  6 May 2021 07:38:43 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga14.intel.com (mga14.intel.com [192.55.52.115])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BD86989E8C
 for <intel-gfx@lists.freedesktop.org>; Thu,  6 May 2021 07:38:41 +0000 (UTC)
IronPort-SDR: tMYlljmZskERh2KKz4tI3rLuxME+jF58+d+GE0vKTbsWEIk0mmNJQZTqplzYVpt1Qxjj4wtqaS
 MaN/2Yq3PO+A==
X-IronPort-AV: E=McAfee;i="6200,9189,9975"; a="198043101"
X-IronPort-AV: E=Sophos;i="5.82,276,1613462400"; d="scan'208";a="198043101"
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
 by fmsmga103.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 06 May 2021 00:38:40 -0700
IronPort-SDR: QXNpDOOZ3vnqDQDlXXtRU0dXnNYLu2ckPTd8Za61BS1I1gSpyGGylducCaoUZHfgOAk2CSpDc1
 FXSvdfPO7IJg==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.82,276,1613462400"; d="scan'208";a="464601928"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.171])
 by fmsmga002.fm.intel.com with SMTP; 06 May 2021 00:38:37 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Thu, 06 May 2021 10:38:36 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  6 May 2021 10:38:36 +0300
Message-Id: <20210506073836.14848-1-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.26.3
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Reorder skl+ scaler vs. plane updates
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Cooper Chiou <cooper.chiou@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KCldo
ZW4gc2Nhbm5pbmcgb3V0IE5WMTIgaWYgd2UgYXQgYW55IHRpbWUgaGF2ZSB0aGUgcGxhbmUgZW5h
YmxlZAp3aGlsZSB0aGUgc2NhbGVyIGlzIGRpc2FibGVkIHdlIGdldCBhIHByZXR0eSBjYXRhc3Ry
b3BoaWNzCnVuZGVycnVuLgoKTGV0J3MgcmVvcmRlciB0aGUgb3BlcmF0aW9ucyBzbyB0aGF0IHdl
IHRyeSB0byBhdm9pZCB0aGF0IGhhcHBlbmluZwpldmVuIGlmIG91ciB2YmxhbmsgZXZhZGUgZmFp
bHMgYW5kIHRoZSBzY2FsZXIgZW5hYmxlL2Rpc2FibGUgYW5kCnRoZSBwbGFuZSBlbmFibGUvZGlz
YWJsZSBnZXQgbGF0Y2hlZCBkdXJpbmcgdHdvIGRpZmZlbnQgZnJhbWVzLgoKVGhpcyB0YWtlcyBj
YXJlIG9mIHRoZSBtb3N0IGNvbW1vbiBjYXNlcy4gSSBzdXBwb3NlIHRoZXJlIGlzIHN0aWxsCmF0
IGxlYXN0IGEgdGhlb3JldGljYWwgcG9zc2liaWxpdHkgb2YgaGl0dGluZyB0aGlzIGlmIG9uZSBw
bGFuZQp0YWtlcyB0aGUgc2NhbGVyIGF3YXkgZnJvbSBhbm90aGVyIHBsYW5lIGJlZm9yZSB0aGUg
c2Vjb25kIHBsYW5lCmhhZCBhIGNoYW5jZSB0byBzZXQgdXAgYW5vdGhlciBzY2FsZXIgZm9yIGl0
cyB1c2UuIEJ1dCB0aGF0CmlzIHN0YXJ0aW5nIHRvIGdldCBhIGJpdCBjb21wbGljYXRlZCwgZXNw
ZWNpYWxseSBzaW5jZSB0aGUgcGxhbmUKY29tbWl0IG9yZGVyIGFscmVhZHkgaGFzIHRvIGJlIGNh
cmVmdWxseSBzZXF1ZW5jZWQgdG8gYXZvaWQgYW55CmRidWYgb3ZlcmxhcHMuIFNvIHBsdWdnaW5n
IHRoaXMgMTAwJSBtYXkgcHJvdmUgc29tZXdoYXQgaGFyZC4uLgoKQ2M6IENvb3BlciBDaGlvdSA8
Y29vcGVyLmNoaW91QGludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogVmlsbGUgU3lyasOkbMOkIDx2
aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2Rpc3BsYXkuYyAgfCAzMCArKysrKysrKysrKysrKy0tLS0tCiAuLi4vZHJt
L2k5MTUvZGlzcGxheS9za2xfdW5pdmVyc2FsX3BsYW5lLmMgICAgfCAxMSArKysrKy0tCiAyIGZp
bGVzIGNoYW5nZWQsIDMwIGluc2VydGlvbnMoKyksIDExIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKaW5kZXggZmNkODEyM2VkZThl
Li4wYzhjYTI2MTU2YjEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfZGlzcGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheS5jCkBAIC05Njk4LDggKzk2OTgsNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9waXBlX2Zh
c3RzZXQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCiAJ
Lyogb24gc2t5bGFrZSB0aGlzIGlzIGRvbmUgYnkgZGV0YWNoaW5nIHNjYWxlcnMgKi8KIAlpZiAo
RElTUExBWV9WRVIoZGV2X3ByaXYpID49IDkpIHsKLQkJc2tsX2RldGFjaF9zY2FsZXJzKG5ld19j
cnRjX3N0YXRlKTsKLQogCQlpZiAobmV3X2NydGNfc3RhdGUtPnBjaF9wZml0LmVuYWJsZWQpCiAJ
CQlza2xfcGZpdF9lbmFibGUobmV3X2NydGNfc3RhdGUpOwogCX0gZWxzZSBpZiAoSEFTX1BDSF9T
UExJVChkZXZfcHJpdikpIHsKQEAgLTk3MjUsOCArOTcyMyw4IEBAIHN0YXRpYyB2b2lkIGludGVs
X3BpcGVfZmFzdHNldChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3Rh
dGUsCiAJCWljbF9zZXRfcGlwZV9jaGlja2VuKGNydGMpOwogfQogCi1zdGF0aWMgdm9pZCBjb21t
aXRfcGlwZV9jb25maWcoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCi0JCQkgICAg
ICAgc3RydWN0IGludGVsX2NydGMgKmNydGMpCitzdGF0aWMgdm9pZCBjb21taXRfcGlwZV9wcmVf
cGxhbmVzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJCSAgIHN0cnVjdCBp
bnRlbF9jcnRjICpjcnRjKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9
IHRvX2k5MTUoc3RhdGUtPmJhc2UuZGV2KTsKIAljb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqb2xkX2NydGNfc3RhdGUgPQpAQCAtOTc0NCw5ICs5NzQyLDYgQEAgc3RhdGljIHZvaWQgY29t
bWl0X3BpcGVfY29uZmlnKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAogCQkgICAg
bmV3X2NydGNfc3RhdGUtPnVwZGF0ZV9waXBlKQogCQkJaW50ZWxfY29sb3JfY29tbWl0KG5ld19j
cnRjX3N0YXRlKTsKIAotCQlpZiAoRElTUExBWV9WRVIoZGV2X3ByaXYpID49IDkpCi0JCQlza2xf
ZGV0YWNoX3NjYWxlcnMobmV3X2NydGNfc3RhdGUpOwotCiAJCWlmIChESVNQTEFZX1ZFUihkZXZf
cHJpdikgPj0gOSB8fCBJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQogCQkJYmR3X3NldF9waXBlbWlz
YyhuZXdfY3J0Y19zdGF0ZSk7CiAKQEAgLTk3NjAsNiArOTc1NSwyMyBAQCBzdGF0aWMgdm9pZCBj
b21taXRfcGlwZV9jb25maWcoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCiAJCWRl
dl9wcml2LT5kaXNwbGF5LmF0b21pY191cGRhdGVfd2F0ZXJtYXJrcyhzdGF0ZSwgY3J0Yyk7CiB9
CiAKK3N0YXRpYyB2b2lkIGNvbW1pdF9waXBlX3Bvc3RfcGxhbmVzKHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlLAorCQkJCSAgICBzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YykKK3sKKwlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KHN0YXRlLT5iYXNlLmRl
dik7CisJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlID0KKwkJ
aW50ZWxfYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZShzdGF0ZSwgY3J0Yyk7CisKKwkvKgorCSAq
IERpc2FibGUgdGhlIHNjYWxlcihzKSBhZnRlciB0aGUgcGxhbmUocykgc28gdGhhdCB3ZSBkb24n
dAorCSAqIGdldCBhIGNhdGFzdHJvcGhpYyB1bmRlcnJ1biBldmVuIGlmIHRoZSB0d28gb3BlcmF0
aW9ucworCSAqIGVuZCB1cCBoYXBwZW5pbmcgaW4gdHdvIGRpZmZlcmVudCBmcmFtZXMuCisJICov
CisJaWYgKERJU1BMQVlfVkVSKGRldl9wcml2KSA+PSA5ICYmCisJICAgICFpbnRlbF9jcnRjX25l
ZWRzX21vZGVzZXQobmV3X2NydGNfc3RhdGUpKQorCQlza2xfZGV0YWNoX3NjYWxlcnMobmV3X2Ny
dGNfc3RhdGUpOworfQorCiBzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfY3J0YyhzdHJ1Y3QgaW50
ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0cnVjdCBpbnRlbF9jcnRjICpjcnRj
KQogewpAQCAtOTgxMSwxMyArOTgyMywxNSBAQCBzdGF0aWMgdm9pZCBpbnRlbF91cGRhdGVfY3J0
YyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKIAkvKiBQZXJmb3JtIHZibGFuayBl
dmFzaW9uIGFyb3VuZCBjb21taXQgb3BlcmF0aW9uICovCiAJaW50ZWxfcGlwZV91cGRhdGVfc3Rh
cnQobmV3X2NydGNfc3RhdGUpOwogCi0JY29tbWl0X3BpcGVfY29uZmlnKHN0YXRlLCBjcnRjKTsK
Kwljb21taXRfcGlwZV9wcmVfcGxhbmVzKHN0YXRlLCBjcnRjKTsKIAogCWlmIChESVNQTEFZX1ZF
UihkZXZfcHJpdikgPj0gOSkKIAkJc2tsX3VwZGF0ZV9wbGFuZXNfb25fY3J0YyhzdGF0ZSwgY3J0
Yyk7CiAJZWxzZQogCQlpOXh4X3VwZGF0ZV9wbGFuZXNfb25fY3J0YyhzdGF0ZSwgY3J0Yyk7CiAK
Kwljb21taXRfcGlwZV9wb3N0X3BsYW5lcyhzdGF0ZSwgY3J0Yyk7CisKIAlpbnRlbF9waXBlX3Vw
ZGF0ZV9lbmQobmV3X2NydGNfc3RhdGUpOwogCiAJLyoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvc2tsX3VuaXZlcnNhbF9wbGFuZS5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9za2xfdW5pdmVyc2FsX3BsYW5lLmMKaW5kZXggMGQzNGE1YWQ0ZTJiLi42
YWQ4NWQ3Y2IyMTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvc2ts
X3VuaXZlcnNhbF9wbGFuZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvc2ts
X3VuaXZlcnNhbF9wbGFuZS5jCkBAIC0xMDMyLDYgKzEwMzIsMTQgQEAgc2tsX3Byb2dyYW1fcGxh
bmUoc3RydWN0IGludGVsX3BsYW5lICpwbGFuZSwKIAlpZiAoIWRybV9hdG9taWNfY3J0Y19uZWVk
c19tb2Rlc2V0KCZjcnRjX3N0YXRlLT51YXBpKSkKIAkJaW50ZWxfcHNyMl9wcm9ncmFtX3BsYW5l
X3NlbF9mZXRjaChwbGFuZSwgY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUsIGNvbG9yX3BsYW5lKTsK
IAorCS8qCisJICogRW5hYmxlIHRoZSBzY2FsZXIgYmVmb3JlIHRoZSBwbGFuZSBzbyB0aGF0IHdl
IGRvbid0CisJICogZ2V0IGEgY2F0YXN0cm9waGljIHVuZGVycnVuIGV2ZW4gaWYgdGhlIHR3byBv
cGVyYXRpb25zCisJICogZW5kIHVwIGhhcHBlbmluZyBpbiB0d28gZGlmZmVyZW50IGZyYW1lcy4K
KwkgKi8KKwlpZiAocGxhbmVfc3RhdGUtPnNjYWxlcl9pZCA+PSAwKQorCQlza2xfcHJvZ3JhbV9w
bGFuZV9zY2FsZXIocGxhbmUsIGNydGNfc3RhdGUsIHBsYW5lX3N0YXRlKTsKKwogCS8qCiAJICog
VGhlIGNvbnRyb2wgcmVnaXN0ZXIgc2VsZi1hcm1zIGlmIHRoZSBwbGFuZSB3YXMgcHJldmlvdXNs
eQogCSAqIGRpc2FibGVkLiBUcnkgdG8gbWFrZSB0aGUgcGxhbmUgZW5hYmxlIGF0b21pYyBieSB3
cml0aW5nCkBAIC0xMDQxLDkgKzEwNDksNiBAQCBza2xfcHJvZ3JhbV9wbGFuZShzdHJ1Y3QgaW50
ZWxfcGxhbmUgKnBsYW5lLAogCWludGVsX2RlX3dyaXRlX2Z3KGRldl9wcml2LCBQTEFORV9TVVJG
KHBpcGUsIHBsYW5lX2lkKSwKIAkJCSAgaW50ZWxfcGxhbmVfZ2d0dF9vZmZzZXQocGxhbmVfc3Rh
dGUpICsgc3VyZl9hZGRyKTsKIAotCWlmIChwbGFuZV9zdGF0ZS0+c2NhbGVyX2lkID49IDApCi0J
CXNrbF9wcm9ncmFtX3BsYW5lX3NjYWxlcihwbGFuZSwgY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUp
OwotCiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2X3ByaXYtPnVuY29yZS5sb2NrLCBpcnFm
bGFncyk7CiB9CiAKLS0gCjIuMjYuMwoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vaW50ZWwtZ2Z4Cg==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E9EA9393D5B
	for <lists+intel-gfx@lfdr.de>; Fri, 28 May 2021 08:52:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EBA086F579;
	Fri, 28 May 2021 06:52:09 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga02.intel.com (mga02.intel.com [134.134.136.20])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 64A336F57B;
 Fri, 28 May 2021 06:52:07 +0000 (UTC)
IronPort-SDR: cI4Zg07bXoSPrR/Q0Zd523hq/22dIprM2JAS3m1iKdBPFGnMxGYiADXys4Hq6a7ha4u5NAp7Vp
 gB51np2WxiOw==
X-IronPort-AV: E=McAfee;i="6200,9189,9997"; a="190022170"
X-IronPort-AV: E=Sophos;i="5.83,229,1616482800"; d="scan'208";a="190022170"
Received: from orsmga005.jf.intel.com ([10.7.209.41])
 by orsmga101.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 27 May 2021 23:52:04 -0700
IronPort-SDR: CiwW5Lp2FP9F6zbVskbeG4WuIrIjifEmWZG6hslaJqGgAkqwcjIjK3/d5IALhcov4RN8/xnC+c
 +wJq/6yGOwFA==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.83,229,1616482800"; d="scan'208";a="615661689"
Received: from irvmail001.ir.intel.com ([10.43.11.63])
 by orsmga005.jf.intel.com with ESMTP; 27 May 2021 23:52:03 -0700
Received: from [10.249.150.132] (mwajdecz-MOBL.ger.corp.intel.com
 [10.249.150.132])
 by irvmail001.ir.intel.com (8.14.3/8.13.6/MailSET/Hub) with ESMTP id
 14S6q2lX009395; Fri, 28 May 2021 07:52:02 +0100
To: John Harrison <john.c.harrison@intel.com>,
 Matthew Brost <matthew.brost@intel.com>
References: <20210526064237.77853-1-matthew.brost@intel.com>
 <20210526064237.77853-16-matthew.brost@intel.com>
 <3d18d63d-8359-5ce0-0320-104436d57198@intel.com>
 <20210526175818.GB31459@sdutt-i7>
 <7b59483a-83ed-8857-ad8f-e2df7bb94cb6@intel.com>
From: Michal Wajdeczko <michal.wajdeczko@intel.com>
Message-ID: <51b9bd05-7d6f-29f1-de0f-3a14bade6c9c@intel.com>
Date: Fri, 28 May 2021 08:52:02 +0200
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:78.0) Gecko/20100101
 Thunderbird/78.10.2
MIME-Version: 1.0
In-Reply-To: <7b59483a-83ed-8857-ad8f-e2df7bb94cb6@intel.com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH 15/18] drm/i915/guc: Ensure H2G buffer
 updates visible before tail update
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: intel-gfx@lists.freedesktop.org, dri-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

CgpPbiAyOC4wNS4yMDIxIDAzOjEzLCBKb2huIEhhcnJpc29uIHdyb3RlOgo+IE9uIDUvMjYvMjAy
MSAxMDo1OCwgTWF0dGhldyBCcm9zdCB3cm90ZToKPj4gT24gV2VkLCBNYXkgMjYsIDIwMjEgYXQg
MDI6MzY6MThQTSArMDIwMCwgTWljaGFsIFdhamRlY3prbyB3cm90ZToKPj4+IE9uIDI2LjA1LjIw
MjEgMDg6NDIsIE1hdHRoZXcgQnJvc3Qgd3JvdGU6Cj4+Pj4gRW5zdXJlIEgyRyBidWZmZXIgdXBk
YXRlcyBhcmUgdmlzaWJsZSBiZWZvcmUgZGVzY3JpcHRvciB0YWlsIHVwZGF0ZXMgYnkKPj4+PiBp
bnNlcnRpbmcgYSBiYXJyaWVyIGJldHdlZW4gdGhlIEgyRyBidWZmZXIgdXBkYXRlIGFuZCB0aGUg
dGFpbC4gVGhlCj4+Pj4gYmFycmllciBpcyBzaW1wbGUgd21iKCkgZm9yIFNNRU0gYW5kIGlzIHJl
Z2lzdGVyIHdyaXRlIGZvciBMTUVNLgo+Pj4+IFRoaXMgaXMKPj4+PiBuZWVkZWQgaWYgbW9yZSB0
aGFuIDEgSDJHIGNhbiBiZSBpbmZsaWdodCBhdCBvbmNlLgo+Pj4+Cj4+Pj4gU2lnbmVkLW9mZi1i
eTogTWF0dGhldyBCcm9zdCA8bWF0dGhldy5icm9zdEBpbnRlbC5jb20+Cj4+Pj4gQ2M6IE1pY2hh
bCBXYWpkZWN6a28gPG1pY2hhbC53YWpkZWN6a29AaW50ZWwuY29tPgo+Pj4+IC0tLQo+Pj4+IMKg
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19jdC5jIHwgMTggKysrKysrKysr
KysrKysrKysrCj4+Pj4gwqAgMSBmaWxlIGNoYW5nZWQsIDE4IGluc2VydGlvbnMoKykKPj4+Pgo+
Pj4+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfY3Qu
Ywo+Pj4+IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvdWMvaW50ZWxfZ3VjX2N0LmMKPj4+PiBp
bmRleCBmYjg3NWQyNTc1MzYuLjQyMDYzZTFjMzU1ZCAxMDA2NDQKPj4+PiAtLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC91Yy9pbnRlbF9ndWNfY3QuYwo+Pj4+ICsrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L3VjL2ludGVsX2d1Y19jdC5jCj4+Pj4gQEAgLTMyOCw2ICszMjgsMTggQEAg
c3RhdGljIHUzMiBjdF9nZXRfbmV4dF9mZW5jZShzdHJ1Y3QKPj4+PiBpbnRlbF9ndWNfY3QgKmN0
KQo+Pj4+IMKgwqDCoMKgwqAgcmV0dXJuICsrY3QtPnJlcXVlc3RzLmxhc3RfZmVuY2U7Cj4+Pj4g
wqAgfQo+Pj4+IMKgICtzdGF0aWMgdm9pZCB3cml0ZV9iYXJyaWVyKHN0cnVjdCBpbnRlbF9ndWNf
Y3QgKmN0KSB7Cj4+Pj4gK8KgwqDCoCBzdHJ1Y3QgaW50ZWxfZ3VjICpndWMgPSBjdF90b19ndWMo
Y3QpOwo+Pj4+ICvCoMKgwqAgc3RydWN0IGludGVsX2d0ICpndCA9IGd1Y190b19ndChndWMpOwo+
Pj4+ICsKPj4+PiArwqDCoMKgIGlmIChpOTE1X2dlbV9vYmplY3RfaXNfbG1lbShndWMtPmN0LnZt
YS0+b2JqKSkgewo+Pj4+ICvCoMKgwqDCoMKgwqDCoCBHRU1fQlVHX09OKGd1Yy0+c2VuZF9yZWdz
LmZ3X2RvbWFpbnMpOwo+Pj4+ICvCoMKgwqDCoMKgwqDCoCBpbnRlbF91bmNvcmVfd3JpdGVfZnco
Z3QtPnVuY29yZSwgR0VOMTFfU09GVF9TQ1JBVENIKDApLCAwKTsKPj4+IGhtbSwgYXMgdGhpcyBp
cyBvbmUgb2YgdGhlIEd1QyBzY3JhdGNoIHJlZ2lzdGVycyB1c2VkIGZvciBIMkcgTU1JTwo+Pj4g
Y29tbXVuaWNhdGlvbiwgd3JpdGluZyAwIHRoZXJlIG1pZ2h0IGJlIGludGVycHJldGVkIGJ5IHRo
ZSBHdUMgYXMgbmV3Cj4+PiByZXF1ZXN0IHdpdGggYWN0aW9uPTAgYW5kIG1pZ2h0IHJlc3VsdHMg
aW4gZXh0cmEgcHJvY2Vzc2luZy9sb2dnaW5nIG9uCj4+PiBHdUMgc2lkZSwgYW5kLCBzaW5jZSBm
cm9tIGhlcmUgd2UgZG9uJ3QgcHJvdGVjdCBhY2Nlc3MgdG8gdGhpcyByZWdpc3Rlcgo+Pj4gYnkg
c2VuZF9tdXRleCwgd2UgY2FuIGNvcnJ1cHQgb3RoZXIgTU1JTyBtZXNzYWdlIGJlaW5nIHByZXBh
cmVkIGZyb20KPj4+IGRpZmZlcmVudCB0aHJlYWQsIC4uLiBjYW4ndCB3ZSB1c2Ugb3RoZXIgcmVn
aXN0ZXIgPwo+Pj4KPj4gSG1tLCB0aGlzIGNvZGUgaGFzIGJlZW4gaW50ZXJuYWwgZm9yIGEgbG9u
ZyB0aW1lIGFuZCB3ZSBoYXZlbid0IHNlZW4gYW4KPj4gaXNzdWVzLiBNTUlPcyBhcmUgYWx3YXlz
IGF0dGVtcHRlZCB0byBiZSBwcm9jZXNzZWQgZWFjaCBpbnRlcnJ1cHQgYW5kCj4+IHRoZW4gQ1RC
cyBhcmUgcHJvY2Vzc2VkIG5leHQuIEEgdmFsdWUgYSAwIGluIHNjcmF0Y2gwIHJlc3VsdHMgaW4g
bm8gTU1JT3MKPj4gYmVpbmcgcHJvY2Vzc2VkIGFzIGEgdmFsdWUgb2YgMCBpcyBhIHJlc2VydmVk
IGFjdGlvbiB3aGljaCB0cmFuc2xhdGVzIHRvCj4+IGEgTk9QLgo+Pgo+PiBBbHNvIGluIHRoZSBj
dXJyZW50IGk5MTUgb25jZSBDVEJzIGFyZSBlbmFibGVkIE1NSU9zIGFyZSBuZXZlciB1c2VkLgo+
PiBUaGF0IGJlaW5nIHNhaWQsIEkgdGhpbmsgb25jZSB3ZSB0cmFuc2l0aW9uIHRvIHRoZSBuZXcg
aW50ZXJmYWNlICsKPj4gZW5hYmxlIHN1c3BlbmQgb24gYSBWRiBNTUlPcyBtaWdodCBiZSB1c2Vk
Lgo+Pgo+PiBXaXRoIHRoYXQgSSBwdXJwb3NlIHRoYXQgd2UgbWVyZ2UgdGhpcyBhcyBpcyB3aXRo
IGEgY29tbWVudCBzYXlpbmcgaWYgd2UKPj4gZXZlciBtaXggQ1RCcyBhbmQgTU1JT3Mgd2UgbmVl
ZCB0byBmaW5kIGFub3RoZXIgTU1JTyByZWdpc3Rlci4gSSBkb24ndAo+PiBjaGFuZ2luZyB0aGlz
IG5vdyBpcyB3b3J0aCBkZWxheWluZyB1cHN0cmVhbWluZyB0aGlzIGFuZCBhbHNvIGFueSBjaGFu
Z2UKPj4gd2UgbWFrZSBub3cgd2lsbCBtYWtlIHVzIGxvc2UgY29uZmlkZW5jZSBpbiBjb2RlIHRo
YXQgaGFzIGJlZW4KPj4gdGhvcm91Z2hseSB0ZXN0ZWQuCj4+Cj4+IE1hdHQKPiBUaGlzIHdhcyBk
aXNjdXNzZWQgaW4gY2hhdCB3aGlsZSBpbnNwZWN0aW5nIHRoZSBHdUMgZmlybXdhcmUgY29kZS4K
PiBXcml0aW5nIHplcm8gdG8gdGhlIHNjcmF0Y2ggZG9lcyBpbmRlZWQgbm90IHRyaWdnZXIgYW55
IGV4dHJhIHByb2Nlc3NpbmcKPiBvZiBzcHVyaW91cyBNTUlPIEgyR3MuIFRoZSByZWdpc3RlciBp
cyBpbmRlZWQgYWx3YXlzIGNoZWNrZWQgd2hlbiB0aGUKPiBob3N0IHRyaWdnZXJzIGEgQ1RCIEgy
RywgYnV0IHplcm8gY291bnRzIGFzIGludmFsaWQgYW5kIHRodXMgd2lsbCBiZQo+IHNraXBwZWQu
Cj4gCj4gU28gd2l0aCBhIGNvbW1lbnQgYWJvdXQgbm90IG1peGluZyBDVEIgYW5kIE1NSU9zLCBJ
IHRoaW5rIHdlIGFyZSBnb29kCj4gZm9yIG5vdy4gSXQgc2VlbXMgdW5saWtlbHkgdGhhdCBNTUlP
cyAmIENUQiB3b3VsZCBiZSBtaXhlZC4gTU1JT3MgYXJlCj4gb25seSB1c2VkIGZvciBpbml0aWFs
aXNhdGlvbiBvcGVyYXRpb25zIGFuZCBzaG91bGQgbm90IGJlIG5lY2Vzc2FyeSBvbmNlCj4gdGhl
IENUQnMgYXJlIHVwIGFuZCBydW5uaW5nLiBJZiBtaXhpbmcgZG9lcyBvY2N1ciBpbiB0aGUgZnV0
dXJlLCBpdAo+IHNvdW5kcyBsaWtlIHNvbWV0aGluZyB0aGF0IHNob3VsZCBiZSBhZGRyZXNzZWQg
YXQgdGhlIEd1QyBhcmNoaXRlY3R1cmUKPiBsZXZlbCEKCndlbGwsIHVubGlrZWx5IGlzIG5vdCB0
aGUgc2FtZSBhcyBub3QgcG9zc2libGUuLi4KCmVzcGVjaWFsbHkgdGhhdCBvbiBNTUlPIHBhdGgg
d2UgYXJlIHByb3RlY3RpbmcgYWNjZXNzIHRvIHRoaXMgcmVnaXN0ZXIsCnNvIG1heWJlLCB0byB0
cnkgY2FwdHVyZSBhbnkgdW5leHBlY3RlZCBzY2VuYXJpb3MsIHdlIHNob3VsZCBhdCBsZWFzdAph
ZGQgc29tZXRoaW5nIGxpa2U6CgoJR0VNX1dBUk5fT04obXV0ZXhfaXNfbG9ja2VkKCZndWMtPnNl
bmRfbXV0ZXgpKQoKYW5kIHNpbmNlIHlvdSBhbHJlYWR5IGNoZWNrIGZvciBzZW5kX3JlZ3MuZndf
ZG9tYWlucyBhY3R1YWwgcmVnaXN0ZXIKb2Zmc2V0IHNob3VsZCBiZSB0YWtlbiBmcm9tIHNlbmRf
cmVncy5iYXNlID8KCmFsdGVybmF0aXZlbHksIHNpbmNlIEkgZG91YnQgdGhhdCB3ZSBoYXZlIHRv
IHVzZSB0aGlzIHNwZWNpZmljIHNlbmQKcmVnaXN0ZXIsIHdlIGNvdWxkIGRlZmluZSBpOTE1IGxl
dmVsIGZ1bmN0aW9uIGZvciB0aGUgcHVycG9zZSBvZgp0cmlnZ2VyaW5nIHdyaXRlIGJhcnJpZXIg
KG9yIG1heWJlIHdlIGFscmVhZHkgaGF2ZSBvbmU/KSB0aGF0IGlzIHVzaW5nCnJlZ2lzdGVyIHRo
YXQgaXMgbm90IGNvbmZsaWN0aW5nIHdpdGggZ3VjIE1NSU8gY29tbXVuaWNhdGlvbi4uLgoKbm90
ZSwgaW4gY2FzZSB5b3UgY2FuJ3QgZmluZCBhbnkgb3RoZXIgc2FmZSByZWdpc3RlciB0byB3cml0
ZSwgbWF5YmUKYmV0dGVyIG9wdGlvbiB0byB1c2UgaXMgU09GVF9TQ1JBVENIKDB4YzE4MCkgdGhh
dCBpcyBzdGlsbCBhdmFpbGFibGUgb24KR2VuMTEsIGJ1dCBpdCBpcyBub3QgdXNlZCBieSBHdUMg
YW55IG1vcmUgZm9yIE1NSU8gY29tbXVuaWNhdGlvbiwgYW5kIG9uCkdlbjkgd2UgZG9uJ3QgaGF2
ZSBsbWVtIHNvIG5vIGNvbmZsaWN0IGF0IGFsbCwgd2hpY2ggd2UgY2FuIGNoZWNrIHdpdGg6CgoJ
R0VNX0JVR19PTihzZW5kX3JlZ3MuYmFzZSA9PSBTT0ZUX1NDUkFUQ0gpCgphbmQgdGhlbiB3ZSBz
aG91bGQgYmUgc2FmZSBmb3Igc3VyZSwgbm90IGp1c3QgInVubGlrZWx5IgoKTWljaGFsCgo+IAo+
IFdpdGggdGhlIGNvbW1lbnQgYWRkZWQ6Cj4gUmV2aWV3ZWQtYnk6IEpvaG4gSGFycmlzb24gPEpv
aG4uQy5IYXJyaXNvbkBJbnRlbC5jb20+Cj4gCj4gCj4+IMKgCj4+Pj4gK8KgwqDCoCB9IGVsc2Ug
ewo+Pj4+ICvCoMKgwqDCoMKgwqDCoCB3bWIoKTsKPj4+PiArwqDCoMKgIH0KPj4+PiArfQo+Pj4+
ICsKPj4+PiDCoCAvKioKPj4+PiDCoMKgICogRE9DOiBDVEIgSG9zdCB0byBHdUMgcmVxdWVzdAo+
Pj4+IMKgwqAgKgo+Pj4+IEBAIC00MTEsNiArNDIzLDEyIEBAIHN0YXRpYyBpbnQgY3Rfd3JpdGUo
c3RydWN0IGludGVsX2d1Y19jdCAqY3QsCj4+Pj4gwqDCoMKgwqDCoCB9Cj4+Pj4gwqDCoMKgwqDC
oCBHRU1fQlVHX09OKHRhaWwgPiBzaXplKTsKPj4+PiDCoCArwqDCoMKgIC8qCj4+Pj4gK8KgwqDC
oMKgICogbWFrZSBzdXJlIEgyRyBidWZmZXIgdXBkYXRlIGFuZCBMUkMgdGFpbCB1cGRhdGUgKGlm
IHRoaXMKPj4+PiB0cmlnZ2VyaW5nIGEKPj4+PiArwqDCoMKgwqAgKiBzdWJtaXNzaW9uKSBhcmUg
dmlzaWJsZSBiZWZvcmUgdXBkYXRpbmcgdGhlIGRlc2NyaXB0b3IgdGFpbAo+Pj4+ICvCoMKgwqDC
oCAqLwo+Pj4+ICvCoMKgwqAgd3JpdGVfYmFycmllcihjdCk7Cj4+Pj4gKwo+Pj4+IMKgwqDCoMKg
wqAgLyogbm93IHVwZGF0ZSBkZXNjIHRhaWwgKGJhY2sgaW4gYnl0ZXMpICovCj4+Pj4gwqDCoMKg
wqDCoCBkZXNjLT50YWlsID0gdGFpbCAqIDQ7Cj4+Pj4gwqDCoMKgwqDCoCByZXR1cm4gMDsKPj4+
Pgo+PiBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwo+PiBJ
bnRlbC1nZnggbWFpbGluZyBsaXN0Cj4+IEludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
Pj4gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1n
ZngKPiAKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50
ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

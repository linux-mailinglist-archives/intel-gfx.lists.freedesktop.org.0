Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id AEC3F45558
	for <lists+intel-gfx@lfdr.de>; Fri, 14 Jun 2019 09:10:58 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2D32489338;
	Fri, 14 Jun 2019 07:10:47 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EE71689338
 for <intel-gfx@lists.freedesktop.org>; Fri, 14 Jun 2019 07:10:42 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16897540-1500050 
 for multiple; Fri, 14 Jun 2019 08:10:41 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 14 Jun 2019 08:10:13 +0100
Message-Id: <20190614071023.17929-30-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190614071023.17929-1-chris@chris-wilson.co.uk>
References: <20190614071023.17929-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 29/39] drm/i915: Make i915_vma track its own kref
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhyb3VnaG91dCB0aGUgY29kZSBiYXNlIHdlIGludGVybmFsbHkgdHJhY2sgdm1hIChvYmplY3Rz
IGJvdW5kIGludG8KYSBwYXJ0aWN1bGFyIEdUVCksIHdpdGggdGhlIG9iamVjdHMgdGhlbXNlbHZl
cyBiZWluZyB0aGUgY29tbW9uIGJhY2tpbmcKc3RvcmFnZS4gQnkgbWFraW5nIHRoZSB2bWEgaXRz
ZWxmIHJlZmVyZW5jZSBjb3VudGVkIHdlIGNhbiBzdGFydApvcGVyYXRpbmcgb24gdGhlIHZtYSBj
b25jdXJyZW50bHksIG1vdmluZyB3b3JrIGludG8gYXN5bmMgdGhyZWFkcy4KCkp1c3QgdGhlIGNv
bnZlcnNpb24gdG8gbWFraW5nIHN1cmUgd2Uga2VlcCB0cmFjayBvZiB0aGUgdm1hIHJlZmVyZW5j
ZQpjb3VudHMgaXMgbm90IHBhcnRpY3VsYXJseSBwbGVhc2FudC4KLS0tCiAuLi4vZ3B1L2RybS9p
OTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMgICAgfCAgNiArLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyAgIHwgIDYgKy0KIC4uLi9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyAgICB8IDE5ICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMgICAgfCAxNiArLS0tLQogLi4uL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fb2JqZWN0X2JsdC5jICAgIHwgIDQgKy0KIC4uLi9ncHUvZHJtL2k5MTUv
Z2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMgICB8IDI4ICsrLS0tLS0tCiAuLi4vZHJtL2k5MTUv
Z2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMgfCAxNyArKy0tLQogLi4uL2RybS9pOTE1
L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbW1hbi5jICAgIHwgMTUgKystLQogZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMgICAgIHwgIDcgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2xyYy5jICAgICAgICAgICB8IDI4ICsrKystLS0tCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMgICAgfCAxMyArLS0tCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF93b3JrYXJvdW5kcy5jICAgfCAxNiArKy0tLQogLi4uL2dwdS9k
cm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jICAgIHwgMTggKystLS0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYyAgICAgICAgICB8ICAyICstCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dlbS5jICAgICAgICAgICAgICAgfCAyMSArKystLS0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jICAgICAgICAgICB8IDE4ICstLS0tCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9yZW5kZXJfc3RhdGUuYyAgfCAgMiArLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV90aW1lbGluZS5jICAgICAgICAgIHwgIDMgKy0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfdm1hLmMgICAgICAgICAgICAgICB8IDY5ICsrKysrKysrKystLS0tLS0t
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmggICAgICAgICAgICAgICB8IDM4ICsr
KysrLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuYyAgICAgICAgICB8
IDE2ICsrKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWMuYyAgICAgICAgICAgICAg
fCAgOSArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX292ZXJsYXkuYyAgICAgICAgICB8
IDE3ICsrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0LmMg
fCAxMSArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3ZtYS5jICAgICB8
ICAzICstCiAyNSBmaWxlcyBjaGFuZ2VkLCAxNzggaW5zZXJ0aW9ucygrKSwgMjI0IGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGll
bnRfYmx0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xpZW50X2JsdC5j
CmluZGV4IGYyNTNlYzU3NjVhZC4uMjJhMjYyZGZkMDdiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xpZW50X2JsdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9jbGllbnRfYmx0LmMKQEAgLTksNyArOSw2IEBACiAKIHN0cnVj
dCBpOTE1X3NsZWV2ZSB7CiAJc3RydWN0IGk5MTVfdm1hICp2bWE7Ci0Jc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3Qgc2dfdGFibGUgKnBhZ2VzOwogCXN0cnVjdCBpOTE1
X3BhZ2Vfc2l6ZXMgcGFnZV9zaXplczsKIH07CkBAIC03Miw3ICs3MSw2IEBAIHN0YXRpYyBzdHJ1
Y3QgaTkxNV9zbGVldmUgKmNyZWF0ZV9zbGVldmUoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm0sCiAJdm1hLT5vcHMgPSAmcHJveHlfdm1hX29wczsKIAogCXNsZWV2ZS0+dm1hID0gdm1hOwot
CXNsZWV2ZS0+b2JqID0gaTkxNV9nZW1fb2JqZWN0X2dldChvYmopOwogCXNsZWV2ZS0+cGFnZXMg
PSBwYWdlczsKIAlzbGVldmUtPnBhZ2Vfc2l6ZXMgPSAqcGFnZV9zaXplczsKIApAQCAtODUsNyAr
ODMsNyBAQCBzdGF0aWMgc3RydWN0IGk5MTVfc2xlZXZlICpjcmVhdGVfc2xlZXZlKHN0cnVjdCBp
OTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAogCiBzdGF0aWMgdm9pZCBkZXN0cm95X3NsZWV2ZShzdHJ1
Y3QgaTkxNV9zbGVldmUgKnNsZWV2ZSkKIHsKLQlpOTE1X2dlbV9vYmplY3RfcHV0KHNsZWV2ZS0+
b2JqKTsKKwlpOTE1X3ZtYV9wdXQoc2xlZXZlLT52bWEpOwogCWtmcmVlKHNsZWV2ZSk7CiB9CiAK
QEAgLTE1NSw3ICsxNTMsNyBAQCBzdGF0aWMgdm9pZCBjbGVhcl9wYWdlc193b3JrZXIoc3RydWN0
IHdvcmtfc3RydWN0ICp3b3JrKQogewogCXN0cnVjdCBjbGVhcl9wYWdlc193b3JrICp3ID0gY29u
dGFpbmVyX29mKHdvcmssIHR5cGVvZigqdyksIHdvcmspOwogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1ID0gdy0+Y2UtPmdlbV9jb250ZXh0LT5pOTE1OwotCXN0cnVjdCBkcm1faTkxNV9n
ZW1fb2JqZWN0ICpvYmogPSB3LT5zbGVldmUtPm9iajsKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqID0gdy0+c2xlZXZlLT52bWEtPm9iajsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYSA9
IHctPnNsZWV2ZS0+dm1hOwogCXN0cnVjdCBpOTE1X3JlcXVlc3QgKnJxOwogCWludCBlcnIgPSB3
LT5kbWEuZXJyb3I7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9n
ZW1fY29udGV4dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQu
YwppbmRleCAyZTNlNDdiYjFkMTEuLjI0YTcxNDg1M2Y4NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5jCkBAIC0xMjcsMTAgKzEyNywxMCBAQCBzdGF0aWMg
dm9pZCBsdXRfY2xvc2Uoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAkJaWYgKCZsdXQt
Pm9ial9saW5rICE9ICZvYmotPmx1dF9saXN0KSB7CiAJCQlpOTE1X2x1dF9oYW5kbGVfZnJlZShs
dXQpOwogCQkJcmFkaXhfdHJlZV9pdGVyX2RlbGV0ZSgmY3R4LT5oYW5kbGVzX3ZtYSwgJml0ZXIs
IHNsb3QpOwotCQkJaWYgKGF0b21pY19kZWNfYW5kX3Rlc3QoJnZtYS0+b3Blbl9jb3VudCkgJiYK
LQkJCSAgICAhaTkxNV92bWFfaXNfZ2d0dCh2bWEpKQorCQkJR0VNX0JVR19PTighYXRvbWljX3Jl
YWQoJnZtYS0+b3Blbl9jb3VudCkpOworCQkJaWYgKGF0b21pY19kZWNfYW5kX3Rlc3QoJnZtYS0+
b3Blbl9jb3VudCkpCiAJCQkJaTkxNV92bWFfY2xvc2Uodm1hKTsKLQkJCWk5MTVfZ2VtX29iamVj
dF9wdXQob2JqKTsKKwkJCWk5MTVfdm1hX3B1dCh2bWEpOwogCQl9CiAKIAkJaTkxNV9nZW1fb2Jq
ZWN0X3B1dChvYmopOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2V4ZWNidWZmZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVj
YnVmZmVyLmMKaW5kZXggZWViNGM2Y2RiMDFkLi40MzU0ZjRlODVkNDEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYwpAQCAtNzk3LDggKzc5Nyw4
IEBAIHN0YXRpYyBpbnQgZWJfd2FpdF9mb3JfcmluZyhjb25zdCBzdHJ1Y3QgaTkxNV9leGVjYnVm
ZmVyICplYikKIHN0YXRpYyBpbnQgZWJfbG9va3VwX3ZtYXMoc3RydWN0IGk5MTVfZXhlY2J1ZmZl
ciAqZWIpCiB7CiAJc3RydWN0IHJhZGl4X3RyZWVfcm9vdCAqaGFuZGxlc192bWEgPSAmZWItPmdl
bV9jb250ZXh0LT5oYW5kbGVzX3ZtYTsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
OwogCXVuc2lnbmVkIGludCBpLCBiYXRjaDsKKwlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAlpbnQg
ZXJyOwogCiAJaWYgKHVubGlrZWx5KGk5MTVfZ2VtX2NvbnRleHRfaXNfYmFubmVkKGViLT5nZW1f
Y29udGV4dCkpKQpAQCAtODE3LDggKzgxNyw4IEBAIHN0YXRpYyBpbnQgZWJfbG9va3VwX3ZtYXMo
c3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIpCiAKIAlmb3IgKGkgPSAwOyBpIDwgZWItPmJ1ZmZl
cl9jb3VudDsgaSsrKSB7CiAJCXUzMiBoYW5kbGUgPSBlYi0+ZXhlY1tpXS5oYW5kbGU7CisJCXN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CiAJCXN0cnVjdCBpOTE1X2x1dF9oYW5kbGUg
Kmx1dDsKLQkJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAKIAkJdm1hID0gcmFkaXhfdHJlZV9sb29r
dXAoaGFuZGxlc192bWEsIGhhbmRsZSk7CiAJCWlmIChsaWtlbHkodm1hKSkKQEAgLTgzMSwyMSAr
ODMxLDIyIEBAIHN0YXRpYyBpbnQgZWJfbG9va3VwX3ZtYXMoc3RydWN0IGk5MTVfZXhlY2J1ZmZl
ciAqZWIpCiAJCX0KIAogCQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIGViLT52bSwgTlVM
TCk7CisJCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIAkJaWYgKElTX0VSUih2bWEpKSB7CiAJ
CQllcnIgPSBQVFJfRVJSKHZtYSk7Ci0JCQlnb3RvIGVycl9vYmo7CisJCQlnb3RvIGVycl92bWE7
CiAJCX0KIAogCQlsdXQgPSBpOTE1X2x1dF9oYW5kbGVfYWxsb2MoKTsKIAkJaWYgKHVubGlrZWx5
KCFsdXQpKSB7CiAJCQllcnIgPSAtRU5PTUVNOwotCQkJZ290byBlcnJfb2JqOworCQkJZ290byBl
cnJfcHV0OwogCQl9CiAKIAkJZXJyID0gcmFkaXhfdHJlZV9pbnNlcnQoaGFuZGxlc192bWEsIGhh
bmRsZSwgdm1hKTsKIAkJaWYgKHVubGlrZWx5KGVycikpIHsKIAkJCWk5MTVfbHV0X2hhbmRsZV9m
cmVlKGx1dCk7Ci0JCQlnb3RvIGVycl9vYmo7CisJCQlnb3RvIGVycl9wdXQ7CiAJCX0KIAogCQkv
KiB0cmFuc2ZlciByZWYgdG8gbHV0ICovCkBAIC04NzQsOCArODc1LDggQEAgc3RhdGljIGludCBl
Yl9sb29rdXBfdm1hcyhzdHJ1Y3QgaTkxNV9leGVjYnVmZmVyICplYikKIAllYi0+YXJncy0+Zmxh
Z3MgfD0gX19FWEVDX1ZBTElEQVRFRDsKIAlyZXR1cm4gZWJfcmVzZXJ2ZShlYik7CiAKLWVycl9v
Ymo6Ci0JaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworZXJyX3B1dDoKKwlpOTE1X3ZtYV9wdXQo
dm1hKTsKIGVycl92bWE6CiAJZWItPnZtYVtpXSA9IE5VTEw7CiBlcnJfY3R4OgpAQCAtMTIyNiw3
ICsxMjI3LDcgQEAgc3RhdGljIGludCBfX3JlbG9jX2dwdV9hbGxvYyhzdHJ1Y3QgaTkxNV9leGVj
YnVmZmVyICplYiwKIAogCWVyciA9IGk5MTVfdm1hX3BpbihiYXRjaCwgMCwgMCwgUElOX1VTRVIg
fCBQSU5fTk9OQkxPQ0spOwogCWlmIChlcnIpCi0JCWdvdG8gZXJyX3VubWFwOworCQlnb3RvIGVy
cl9iYXRjaDsKIAogCXJxID0gaTkxNV9yZXF1ZXN0X2NyZWF0ZShlYi0+Y29udGV4dCk7CiAJaWYg
KElTX0VSUihycSkpIHsKQEAgLTEyNjcsNiArMTI2OCw4IEBAIHN0YXRpYyBpbnQgX19yZWxvY19n
cHVfYWxsb2Moc3RydWN0IGk5MTVfZXhlY2J1ZmZlciAqZWIsCiAJaTkxNV9yZXF1ZXN0X2FkZChy
cSk7CiBlcnJfdW5waW46CiAJaTkxNV92bWFfdW5waW4oYmF0Y2gpOworZXJyX2JhdGNoOgorCWk5
MTVfdm1hX3B1dChiYXRjaCk7CiBlcnJfdW5tYXA6CiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX21h
cChvYmopOwogCXJldHVybiBlcnI7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
b2JqZWN0LmMKaW5kZXggZWU4MWFjYjA0ZDg0Li4xYWQ1M2NkZGQ0MjUgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9vYmplY3QuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0LmMKQEAgLTEyMiwxNSArMTIyLDE0IEBAIHZv
aWQgaTkxNV9nZW1fY2xvc2Vfb2JqZWN0KHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ2VtLCBzdHJ1
Y3QgZHJtX2ZpbGUgKmZpbGUpCiAJCWlmICh2bWEpIHsKIAkJCUdFTV9CVUdfT04odm1hLT5vYmog
IT0gb2JqKTsKIAkJCUdFTV9CVUdfT04oIWF0b21pY19yZWFkKCZ2bWEtPm9wZW5fY291bnQpKTsK
LQkJCWlmIChhdG9taWNfZGVjX2FuZF90ZXN0KCZ2bWEtPm9wZW5fY291bnQpICYmCi0JCQkgICAg
IWk5MTVfdm1hX2lzX2dndHQodm1hKSkKKwkJCWlmIChhdG9taWNfZGVjX2FuZF90ZXN0KCZ2bWEt
Pm9wZW5fY291bnQpKQogCQkJCWk5MTVfdm1hX2Nsb3NlKHZtYSk7CisJCQlpOTE1X3ZtYV9wdXQo
dm1hKTsKIAkJfQogCQltdXRleF91bmxvY2soJmN0eC0+bXV0ZXgpOwogCiAJCWk5MTVfZ2VtX2Nv
bnRleHRfcHV0KGx1dC0+Y3R4KTsKIAkJaTkxNV9sdXRfaGFuZGxlX2ZyZWUobHV0KTsKLQkJaTkx
NV9nZW1fb2JqZWN0X3B1dChvYmopOwogCX0KIH0KIApAQCAtMTY5LDE3ICsxNjgsOCBAQCBzdGF0
aWMgdm9pZCBfX2k5MTVfZ2VtX2ZyZWVfb2JqZWN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSwKIAogCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChpOTE1KTsKIAlsbGlzdF9m
b3JfZWFjaF9lbnRyeV9zYWZlKG9iaiwgb24sIGZyZWVkLCBmcmVlZCkgewotCQlzdHJ1Y3QgaTkx
NV92bWEgKnZtYSwgKnZuOwotCiAJCXRyYWNlX2k5MTVfZ2VtX29iamVjdF9kZXN0cm95KG9iaik7
CiAKLQkJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KLQkJbGlzdF9mb3Jf
ZWFjaF9lbnRyeV9zYWZlKHZtYSwgdm4sICZvYmotPnZtYS5saXN0LCBvYmpfbGluaykgewotCQkJ
R0VNX0JVR19PTihpOTE1X3ZtYV9pc19hY3RpdmUodm1hKSk7Ci0JCQl2bWEtPmZsYWdzICY9IH5J
OTE1X1ZNQV9QSU5fTUFTSzsKLQkJCWk5MTVfdm1hX2Rlc3Ryb3kodm1hKTsKLQkJfQogCQlHRU1f
QlVHX09OKCFsaXN0X2VtcHR5KCZvYmotPnZtYS5saXN0KSk7CiAJCUdFTV9CVUdfT04oIVJCX0VN
UFRZX1JPT1QoJm9iai0+dm1hLnRyZWUpKTsKIApAQCAtMTk5LDggKzE4OSw2IEBAIHN0YXRpYyB2
b2lkIF9faTkxNV9nZW1fZnJlZV9vYmplY3RzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
LAogCQkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdzKTsK
IAkJfQogCi0JCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAkJR0VN
X0JVR19PTihhdG9taWNfcmVhZCgmb2JqLT5iaW5kX2NvdW50KSk7CiAJCUdFTV9CVUdfT04ob2Jq
LT51c2VyZmF1bHRfY291bnQpOwogCQlHRU1fQlVHX09OKCFsaXN0X2VtcHR5KCZvYmotPmx1dF9s
aXN0KSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fb2Jq
ZWN0X2JsdC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF9ibHQu
YwppbmRleCBjYjQyZTNhMzEyZTIuLjBlNzkyMmFhNGJkMyAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX29iamVjdF9ibHQuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fb2JqZWN0X2JsdC5jCkBAIC02MSw3ICs2MSw3IEBAIGludCBp
OTE1X2dlbV9vYmplY3RfZmlsbF9ibHQoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwK
IAogCWVyciA9IGk5MTVfdm1hX3Bpbih2bWEsIDAsIDAsIFBJTl9VU0VSKTsKIAlpZiAodW5saWtl
bHkoZXJyKSkKLQkJcmV0dXJuIGVycjsKKwkJZ290byBvdXRfcHV0OwogCiAJaWYgKG9iai0+Y2Fj
aGVfZGlydHkgJiB+b2JqLT5jYWNoZV9jb2hlcmVudCkgewogCQlpOTE1X2dlbV9vYmplY3RfbG9j
ayhvYmopOwpAQCAtOTksNiArOTksOCBAQCBpbnQgaTkxNV9nZW1fb2JqZWN0X2ZpbGxfYmx0KHN0
cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJaTkxNV9yZXF1ZXN0X2FkZChycSk7CiBv
dXRfdW5waW46CiAJaTkxNV92bWFfdW5waW4odm1hKTsKK291dF9wdXQ6CisJaTkxNV92bWFfcHV0
KHZtYSk7CiAJcmV0dXJuIGVycjsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
c2VsZnRlc3RzL2h1Z2VfcGFnZXMuYwppbmRleCA3M2U2NjdiMzFjYzQuLmIwM2EyOTM2NmJkMSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2Vz
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMK
QEAgLTQxMyw3ICs0MTMsNyBAQCBzdGF0aWMgaW50IGlndF9tb2NrX2V4aGF1c3RfZGV2aWNlX3N1
cHBvcnRlZF9wYWdlcyh2b2lkICphcmcpCiAKIAkJCWVyciA9IGk5MTVfdm1hX3Bpbih2bWEsIDAs
IDAsIFBJTl9VU0VSKTsKIAkJCWlmIChlcnIpCi0JCQkJZ290byBvdXRfY2xvc2U7CisJCQkJZ290
byBvdXRfcHV0OwogCiAJCQllcnIgPSBpZ3RfY2hlY2tfcGFnZV9zaXplcyh2bWEpOwogCkBAIC00
MjQsNyArNDI0LDcgQEAgc3RhdGljIGludCBpZ3RfbW9ja19leGhhdXN0X2RldmljZV9zdXBwb3J0
ZWRfcGFnZXModm9pZCAqYXJnKQogCQkJfQogCiAJCQlpOTE1X3ZtYV91bnBpbih2bWEpOwotCQkJ
aTkxNV92bWFfY2xvc2Uodm1hKTsKKwkJCWk5MTVfdm1hX3B1dCh2bWEpOwogCiAJCQlpOTE1X2dl
bV9vYmplY3RfcHV0KG9iaik7CiAKQEAgLTQzNSw4ICs0MzUsNiBAQCBzdGF0aWMgaW50IGlndF9t
b2NrX2V4aGF1c3RfZGV2aWNlX3N1cHBvcnRlZF9wYWdlcyh2b2lkICphcmcpCiAKIAlnb3RvIG91
dF9kZXZpY2U7CiAKLW91dF9jbG9zZToKLQlpOTE1X3ZtYV9jbG9zZSh2bWEpOwogb3V0X3B1dDoK
IAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiBvdXRfZGV2aWNlOgpAQCAtNDk4LDExICs0OTYs
OSBAQCBzdGF0aWMgaW50IGlndF9tb2NrX3BwZ3R0X21pc2FsaWduZWRfZG1hKHZvaWQgKmFyZykK
IAogCQllcnIgPSBpOTE1X3ZtYV9waW4odm1hLCAwLCAwLCBmbGFncyk7CiAJCWlmIChlcnIpIHsK
LQkJCWk5MTVfdm1hX2Nsb3NlKHZtYSk7CiAJCQlnb3RvIG91dF91bnBpbjsKIAkJfQogCi0KIAkJ
ZXJyID0gaWd0X2NoZWNrX3BhZ2Vfc2l6ZXModm1hKTsKIAogCQlpZiAodm1hLT5wYWdlX3NpemVz
Lmd0dCAhPSBwYWdlX3NpemUpIHsKQEAgLTUxNCw3ICs1MTAsNiBAQCBzdGF0aWMgaW50IGlndF9t
b2NrX3BwZ3R0X21pc2FsaWduZWRfZG1hKHZvaWQgKmFyZykKIAkJaTkxNV92bWFfdW5waW4odm1h
KTsKIAogCQlpZiAoZXJyKSB7Ci0JCQlpOTE1X3ZtYV9jbG9zZSh2bWEpOwogCQkJZ290byBvdXRf
dW5waW47CiAJCX0KIApAQCAtNTI2LDEzICs1MjEsMTEgQEAgc3RhdGljIGludCBpZ3RfbW9ja19w
cGd0dF9taXNhbGlnbmVkX2RtYSh2b2lkICphcmcpCiAJCWZvciAob2Zmc2V0ID0gNDA5Njsgb2Zm
c2V0IDwgcGFnZV9zaXplOyBvZmZzZXQgKz0gNDA5NikgewogCQkJZXJyID0gaTkxNV92bWFfdW5i
aW5kKHZtYSk7CiAJCQlpZiAoZXJyKSB7Ci0JCQkJaTkxNV92bWFfY2xvc2Uodm1hKTsKIAkJCQln
b3RvIG91dF91bnBpbjsKIAkJCX0KIAogCQkJZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwg
ZmxhZ3MgfCBvZmZzZXQpOwogCQkJaWYgKGVycikgewotCQkJCWk5MTVfdm1hX2Nsb3NlKHZtYSk7
CiAJCQkJZ290byBvdXRfdW5waW47CiAJCQl9CiAKQEAgLTU0Nyw3ICs1NDAsNiBAQCBzdGF0aWMg
aW50IGlndF9tb2NrX3BwZ3R0X21pc2FsaWduZWRfZG1hKHZvaWQgKmFyZykKIAkJCWk5MTVfdm1h
X3VucGluKHZtYSk7CiAKIAkJCWlmIChlcnIpIHsKLQkJCQlpOTE1X3ZtYV9jbG9zZSh2bWEpOwog
CQkJCWdvdG8gb3V0X3VucGluOwogCQkJfQogCkBAIC01NTcsOCArNTQ5LDYgQEAgc3RhdGljIGlu
dCBpZ3RfbW9ja19wcGd0dF9taXNhbGlnbmVkX2RtYSh2b2lkICphcmcpCiAJCQkJYnJlYWs7CiAJ
CX0KIAotCQlpOTE1X3ZtYV9jbG9zZSh2bWEpOwotCiAJCWk5MTVfZ2VtX29iamVjdF91bnBpbl9w
YWdlcyhvYmopOwogCQlfX2k5MTVfZ2VtX29iamVjdF9wdXRfcGFnZXMob2JqLCBJOTE1X01NX05P
Uk1BTCk7CiAJCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKQEAgLTU4Myw4ICs1NzMsOSBAQCBz
dGF0aWMgdm9pZCBjbG9zZV9vYmplY3RfbGlzdChzdHJ1Y3QgbGlzdF9oZWFkICpvYmplY3RzLAog
CQlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAogCQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmos
ICZwcGd0dC0+dm0sIE5VTEwpOwotCQlpZiAoIUlTX0VSUih2bWEpKQotCQkJaTkxNV92bWFfY2xv
c2Uodm1hKTsKKwkJaWYgKCFJU19FUlIodm1hKSkgeworCQkJaTkxNV92bWFfcHV0KHZtYSk7CisJ
CX0KIAogCQlsaXN0X2RlbCgmb2JqLT5zdF9saW5rKTsKIAkJaTkxNV9nZW1fb2JqZWN0X3VucGlu
X3BhZ2VzKG9iaik7CkBAIC04NTUsNyArODQ2LDYgQEAgc3RhdGljIGludCBpZ3RfbW9ja19wcGd0
dF82NEsodm9pZCAqYXJnKQogCQkJfQogCiAJCQlpOTE1X3ZtYV91bnBpbih2bWEpOwotCQkJaTkx
NV92bWFfY2xvc2Uodm1hKTsKIAogCQkJaTkxNV9nZW1fb2JqZWN0X3VucGluX3BhZ2VzKG9iaik7
CiAJCQlfX2k5MTVfZ2VtX29iamVjdF9wdXRfcGFnZXMob2JqLCBJOTE1X01NX05PUk1BTCk7CkBA
IC04NjgsNyArODU4LDYgQEAgc3RhdGljIGludCBpZ3RfbW9ja19wcGd0dF82NEsodm9pZCAqYXJn
KQogb3V0X3ZtYV91bnBpbjoKIAlpOTE1X3ZtYV91bnBpbih2bWEpOwogb3V0X3ZtYV9jbG9zZToK
LQlpOTE1X3ZtYV9jbG9zZSh2bWEpOwogb3V0X29iamVjdF91bnBpbjoKIAlpOTE1X2dlbV9vYmpl
Y3RfdW5waW5fcGFnZXMob2JqKTsKIG91dF9vYmplY3RfcHV0OgpAQCAtOTkzLDcgKzk4Miw2IEBA
IHN0YXRpYyBpbnQgZ3B1X3dyaXRlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogCWk5MTVfcmVxdWVz
dF9hZGQocnEpOwogZXJyX2JhdGNoOgogCWk5MTVfdm1hX3VucGluKGJhdGNoKTsKLQlpOTE1X3Zt
YV9jbG9zZShiYXRjaCk7CiAJaTkxNV92bWFfcHV0KGJhdGNoKTsKIAogCXJldHVybiBlcnI7CkBA
IC0xMDgyLDcgKzEwNzAsNyBAQCBzdGF0aWMgaW50IF9faWd0X3dyaXRlX2h1Z2Uoc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHQgKmN0eCwKIG91dF92bWFfdW5waW46CiAJaTkxNV92bWFfdW5waW4odm1h
KTsKIG91dF92bWFfY2xvc2U6Ci0JaTkxNV92bWFfZGVzdHJveSh2bWEpOworCWk5MTVfdm1hX3B1
dCh2bWEpOwogCiAJcmV0dXJuIGVycjsKIH0KQEAgLTE0OTIsNyArMTQ4MCw2IEBAIHN0YXRpYyBp
bnQgaWd0X3BwZ3R0X3Bpbl91cGRhdGUodm9pZCAqYXJnKQogCQkJZ290byBvdXRfdW5waW47CiAK
IAkJaTkxNV92bWFfdW5waW4odm1hKTsKLQkJaTkxNV92bWFfY2xvc2Uodm1hKTsKIAogCQlpOTE1
X2dlbV9vYmplY3RfcHV0KG9iaik7CiAJfQpAQCAtMTUyNyw3ICsxNTE0LDYgQEAgc3RhdGljIGlu
dCBpZ3RfcHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcpCiBvdXRfdW5waW46CiAJaTkxNV92bWFf
dW5waW4odm1hKTsKIG91dF9jbG9zZToKLQlpOTE1X3ZtYV9jbG9zZSh2bWEpOwogb3V0X3B1dDoK
IAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAKQEAgLTE1ODMsNyArMTU2OSw2IEBAIHN0YXRp
YyBpbnQgaWd0X3RtcGZzX2ZhbGxiYWNrKHZvaWQgKmFyZykKIAogCWk5MTVfdm1hX3VucGluKHZt
YSk7CiBvdXRfY2xvc2U6Ci0JaTkxNV92bWFfY2xvc2Uodm1hKTsKIG91dF9wdXQ6CiAJaTkxNV9n
ZW1fb2JqZWN0X3B1dChvYmopOwogb3V0X3Jlc3RvcmU6CkBAIC0xNjY3LDcgKzE2NTIsNiBAQCBz
dGF0aWMgaW50IGlndF9zaHJpbmtfdGhwKHZvaWQgKmFyZykKIG91dF91bnBpbjoKIAlpOTE1X3Zt
YV91bnBpbih2bWEpOwogb3V0X2Nsb3NlOgotCWk5MTVfdm1hX2Nsb3NlKHZtYSk7CiBvdXRfcHV0
OgogCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYwppbmRleCA5ZTI4NzhhNTkw
MjMuLmIyODcwZDJiZDQ1OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3Nl
bGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTIxMCwxNCArMjEwLDE1IEBAIGdwdV9m
aWxsX2R3KHN0cnVjdCBpOTE1X3ZtYSAqdm1hLCB1NjQgb2Zmc2V0LCB1bnNpZ25lZCBsb25nIGNv
dW50LCB1MzIgdmFsdWUpCiAJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChvYmopOwogCiAJdm1h
ID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCB2bWEtPnZtLCBOVUxMKTsKLQlpZiAoSVNfRVJSKHZt
YSkpIHsKLQkJZXJyID0gUFRSX0VSUih2bWEpOwotCQlnb3RvIGVycjsKLQl9CisJaTkxNV9nZW1f
b2JqZWN0X3B1dChvYmopOworCWlmIChJU19FUlIodm1hKSkKKwkJcmV0dXJuIHZtYTsKIAogCWVy
ciA9IGk5MTVfdm1hX3Bpbih2bWEsIDAsIDAsIFBJTl9VU0VSKTsKLQlpZiAoZXJyKQotCQlnb3Rv
IGVycjsKKwlpZiAoZXJyKSB7CisJCWk5MTVfdm1hX3B1dCh2bWEpOworCQlyZXR1cm4gRVJSX1BU
UihlcnIpOworCX0KIAogCXJldHVybiB2bWE7CiAKQEAgLTMxNCw3ICszMTUsNiBAQCBzdGF0aWMg
aW50IGdwdV9maWxsKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJaTkxNV9yZXF1
ZXN0X2FkZChycSk7CiAKIAlpOTE1X3ZtYV91bnBpbihiYXRjaCk7Ci0JaTkxNV92bWFfY2xvc2Uo
YmF0Y2gpOwogCWk5MTVfdm1hX3B1dChiYXRjaCk7CiAKIAlpOTE1X3ZtYV91bnBpbih2bWEpOwpA
QCAtNzk1LDcgKzc5NSw2IEBAIGVtaXRfcnBjc19xdWVyeShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29i
amVjdCAqb2JqLAogCQlnb3RvIHNraXBfcmVxdWVzdDsKIAogCWk5MTVfdm1hX3VucGluKGJhdGNo
KTsKLQlpOTE1X3ZtYV9jbG9zZShiYXRjaCk7CiAJaTkxNV92bWFfcHV0KGJhdGNoKTsKIAogCWk5
MTVfdm1hX3VucGluKHZtYSk7CkBAIC0xMzU5LDcgKzEzNTgsNiBAQCBzdGF0aWMgaW50IHdyaXRl
X3RvX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAkJZ290byBza2lwX3Jl
cXVlc3Q7CiAKIAlpOTE1X3ZtYV91bnBpbih2bWEpOwotCWk5MTVfdm1hX2Nsb3NlKHZtYSk7CiAJ
aTkxNV92bWFfcHV0KHZtYSk7CiAKIAlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKQEAgLTE0NTYsNyAr
MTQ1NCw2IEBAIHN0YXRpYyBpbnQgcmVhZF9mcm9tX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eCwKIAkJZ290byBza2lwX3JlcXVlc3Q7CiAKIAlpOTE1X3ZtYV91bnBpbih2bWEp
OwotCWk5MTVfdm1hX2Nsb3NlKHZtYSk7CiAKIAlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFu
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21tYW4uYwpp
bmRleCBhYWMwOTNiMWIwYjIuLjhiYTQyNWY4MDYxZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9tbWFuLmMKQEAgLTE2NSwxMCArMTY1LDEw
IEBAIHN0YXRpYyBpbnQgY2hlY2tfcGFydGlhbF9tYXBwaW5nKHN0cnVjdCBkcm1faTkxNV9nZW1f
b2JqZWN0ICpvYmosCiAJCSpjcHUgPSAwOwogCQlkcm1fY2xmbHVzaF92aXJ0X3JhbmdlKGNwdSwg
c2l6ZW9mKCpjcHUpKTsKIAkJa3VubWFwKHApOwotCQlpZiAoZXJyKQotCQkJcmV0dXJuIGVycjsK
IAogCQlpOTE1X3ZtYV9kZXN0cm95KHZtYSk7CisJCWlmIChlcnIpCisJCQlyZXR1cm4gZXJyOwog
CX0KIAogCXJldHVybiAwOwpAQCAtMzM3LDEyICszMzcsMTIgQEAgc3RhdGljIGludCBtYWtlX29i
al9idXN5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmopCiAKIAllcnIgPSBpOTE1X3Zt
YV9waW4odm1hLCAwLCAwLCBQSU5fVVNFUik7CiAJaWYgKGVycikKLQkJcmV0dXJuIGVycjsKKwkJ
Z290byBvdXRfcHV0OwogCiAJcnEgPSBpOTE1X3JlcXVlc3RfY3JlYXRlKGk5MTUtPmVuZ2luZVtS
Q1MwXS0+a2VybmVsX2NvbnRleHQpOwogCWlmIChJU19FUlIocnEpKSB7Ci0JCWk5MTVfdm1hX3Vu
cGluKHZtYSk7Ci0JCXJldHVybiBQVFJfRVJSKHJxKTsKKwkJZXJyID0gUFRSX0VSUihycSk7CisJ
CWdvdG8gb3V0X3VucGluOwogCX0KIAogCWk5MTVfdm1hX2xvY2sodm1hKTsKQEAgLTM1MSw5ICsz
NTEsMTAgQEAgc3RhdGljIGludCBtYWtlX29ial9idXN5KHN0cnVjdCBkcm1faTkxNV9nZW1fb2Jq
ZWN0ICpvYmopCiAKIAlpOTE1X3JlcXVlc3RfYWRkKHJxKTsKIAorb3V0X3VucGluOgogCWk5MTVf
dm1hX3VucGluKHZtYSk7Ci0JaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOyAvKiBsZWF2ZSBpdCBv
bmx5IGFsaXZlIHZpYSBpdHMgYWN0aXZlIHJlZiAqLwotCitvdXRfcHV0OgorCWk5MTVfdm1hX3B1
dCh2bWEpOyAvKiBsZWF2ZSBpdCBvbmx5IGFsaXZlIHZpYSBpdHMgYWN0aXZlIHJlZiAqLwogCXJl
dHVybiBlcnI7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2VuZ2luZV9jcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX2NzLmMK
aW5kZXggMDEzNTcyODA0NDlhLi44NWViNWM5OWQ2NTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV9jcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZV9jcy5jCkBAIC01MzEsNyArNTMxLDcgQEAgc3RhdGljIHZvaWQgY2xl
YW51cF9zdGF0dXNfcGFnZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCWk5MTVf
dm1hX3VucGluKHZtYSk7CiAKIAlpOTE1X2dlbV9vYmplY3RfdW5waW5fbWFwKHZtYS0+b2JqKTsK
LQlpOTE1X2dlbV9vYmplY3RfcHV0KHZtYS0+b2JqKTsKKwlpOTE1X3ZtYV9wdXQodm1hKTsKIH0K
IAogc3RhdGljIGludCBwaW5fZ2d0dF9zdGF0dXNfcGFnZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2Nz
ICplbmdpbmUsCkBAIC01OTAsNyArNTkwLDcgQEAgc3RhdGljIGludCBpbml0X3N0YXR1c19wYWdl
KHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAl2YWRkciA9IGk5MTVfZ2VtX29iamVj
dF9waW5fbWFwKG9iaiwgSTkxNV9NQVBfV0IpOwogCWlmIChJU19FUlIodmFkZHIpKSB7CiAJCXJl
dCA9IFBUUl9FUlIodmFkZHIpOwotCQlnb3RvIGVycjsKKwkJZ290byBlcnJfdm1hOwogCX0KIAog
CWVuZ2luZS0+c3RhdHVzX3BhZ2UuYWRkciA9IG1lbXNldCh2YWRkciwgMCwgUEFHRV9TSVpFKTsK
QEAgLTYwMiwxMCArNjAyLDEzIEBAIHN0YXRpYyBpbnQgaW5pdF9zdGF0dXNfcGFnZShzdHJ1Y3Qg
aW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCQlnb3RvIGVycl91bnBpbjsKIAl9CiAKKwlpOTE1
X2dlbV9vYmplY3RfcHV0KG9iaik7CiAJcmV0dXJuIDA7CiAKIGVycl91bnBpbjoKIAlpOTE1X2dl
bV9vYmplY3RfdW5waW5fbWFwKG9iaik7CitlcnJfdm1hOgorCWk5MTVfdm1hX3B1dCh2bWEpOwog
ZXJyOgogCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIAlyZXR1cm4gcmV0OwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9scmMuYwppbmRleCA1ZGJjNDNjNzA0OTYuLjVjZDI2M2RkM2UyMyAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMKQEAgLTE5ODEsMTAgKzE5ODEsOSBAQCBzdGF0
aWMgaW50IGxyY19zZXR1cF93YV9jdHgoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQog
CQlyZXR1cm4gUFRSX0VSUihvYmopOwogCiAJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCAm
ZW5naW5lLT5pOTE1LT5nZ3R0LnZtLCBOVUxMKTsKLQlpZiAoSVNfRVJSKHZtYSkpIHsKLQkJZXJy
ID0gUFRSX0VSUih2bWEpOwotCQlnb3RvIGVycjsKLQl9CisJaTkxNV9nZW1fb2JqZWN0X3B1dChv
YmopOworCWlmIChJU19FUlIodm1hKSkKKwkJcmV0dXJuIFBUUl9FUlIodm1hKTsKIAogCWVyciA9
IGk5MTVfdm1hX3Bpbih2bWEsIDAsIDAsIFBJTl9HTE9CQUwgfCBQSU5fSElHSCk7CiAJaWYgKGVy
cikKQEAgLTE5OTQsNyArMTk5Myw3IEBAIHN0YXRpYyBpbnQgbHJjX3NldHVwX3dhX2N0eChzdHJ1
Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJcmV0dXJuIDA7CiAKIGVycjoKLQlpOTE1X2dl
bV9vYmplY3RfcHV0KG9iaik7CisJaTkxNV92bWFfcHV0KHZtYSk7CiAJcmV0dXJuIGVycjsKIH0K
IApAQCAtMzA2MywxNSArMzA2MiwxNCBAQCBzdGF0aWMgaW50IGV4ZWNsaXN0c19jb250ZXh0X2Rl
ZmVycmVkX2FsbG9jKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKIAkJcmV0dXJuIFBUUl9FUlIo
Y3R4X29iaik7CiAKIAl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShjdHhfb2JqLCAmZW5naW5lLT5p
OTE1LT5nZ3R0LnZtLCBOVUxMKTsKLQlpZiAoSVNfRVJSKHZtYSkpIHsKLQkJcmV0ID0gUFRSX0VS
Uih2bWEpOwotCQlnb3RvIGVycm9yX2RlcmVmX29iajsKLQl9CisJaTkxNV9nZW1fb2JqZWN0X3B1
dChjdHhfb2JqKTsKKwlpZiAoSVNfRVJSKHZtYSkpCisJCXJldHVybiBQVFJfRVJSKHZtYSk7CiAK
IAl0aW1lbGluZSA9IGdldF90aW1lbGluZShjZS0+Z2VtX2NvbnRleHQpOwogCWlmIChJU19FUlIo
dGltZWxpbmUpKSB7CiAJCXJldCA9IFBUUl9FUlIodGltZWxpbmUpOwotCQlnb3RvIGVycm9yX2Rl
cmVmX29iajsKKwkJZ290byBlcnJfdm1hOwogCX0KIAogCXJpbmcgPSBpbnRlbF9lbmdpbmVfY3Jl
YXRlX3JpbmcoZW5naW5lLApAQCAtMzA4MCwxMyArMzA3OCwxMyBAQCBzdGF0aWMgaW50IGV4ZWNs
aXN0c19jb250ZXh0X2RlZmVycmVkX2FsbG9jKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKIAlp
OTE1X3RpbWVsaW5lX3B1dCh0aW1lbGluZSk7CiAJaWYgKElTX0VSUihyaW5nKSkgewogCQlyZXQg
PSBQVFJfRVJSKHJpbmcpOwotCQlnb3RvIGVycm9yX2RlcmVmX29iajsKKwkJZ290byBlcnJfdm1h
OwogCX0KIAogCXJldCA9IHBvcHVsYXRlX2xyX2NvbnRleHQoY2UsIGN0eF9vYmosIGVuZ2luZSwg
cmluZyk7CiAJaWYgKHJldCkgewogCQlEUk1fREVCVUdfRFJJVkVSKCJGYWlsZWQgdG8gcG9wdWxh
dGUgTFJDOiAlZFxuIiwgcmV0KTsKLQkJZ290byBlcnJvcl9yaW5nX2ZyZWU7CisJCWdvdG8gZXJy
X3Jpbmc7CiAJfQogCiAJY2UtPnJpbmcgPSByaW5nOwpAQCAtMzA5NCwxMCArMzA5MiwxMCBAQCBz
dGF0aWMgaW50IGV4ZWNsaXN0c19jb250ZXh0X2RlZmVycmVkX2FsbG9jKHN0cnVjdCBpbnRlbF9j
b250ZXh0ICpjZSwKIAogCXJldHVybiAwOwogCi1lcnJvcl9yaW5nX2ZyZWU6CitlcnJfcmluZzoK
IAlpbnRlbF9yaW5nX3B1dChyaW5nKTsKLWVycm9yX2RlcmVmX29iajoKLQlpOTE1X2dlbV9vYmpl
Y3RfcHV0KGN0eF9vYmopOworZXJyX3ZtYToKKwlpOTE1X3ZtYV9wdXQodm1hKTsKIAlyZXR1cm4g
cmV0OwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5n
YnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yaW5nYnVmZmVyLmMKaW5k
ZXggYmVhZDVhZmFlYjEzLi5kMzc4M2JlYWYxMzIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX3JpbmdidWZmZXIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9yaW5nYnVmZmVyLmMKQEAgLTEyNDYsMTMgKzEyNDYsOCBAQCBpbnRlbF9yaW5nX2Ny
ZWF0ZV92bWEoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBpbnQgc2l6ZSkKIAkJ
aTkxNV9nZW1fb2JqZWN0X3NldF9yZWFkb25seShvYmopOwogCiAJdm1hID0gaTkxNV92bWFfaW5z
dGFuY2Uob2JqLCB2bSwgTlVMTCk7Ci0JaWYgKElTX0VSUih2bWEpKQotCQlnb3RvIGVycjsKLQot
CXJldHVybiB2bWE7Ci0KLWVycjoKIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisKIAlyZXR1
cm4gdm1hOwogfQogCkBAIC0xMzAwLDcgKzEyOTUsNiBAQCB2b2lkIGludGVsX3JpbmdfZnJlZShz
dHJ1Y3Qga3JlZiAqcmVmKQogewogCXN0cnVjdCBpbnRlbF9yaW5nICpyaW5nID0gY29udGFpbmVy
X29mKHJlZiwgdHlwZW9mKCpyaW5nKSwgcmVmKTsKIAotCWk5MTVfdm1hX2Nsb3NlKHJpbmctPnZt
YSk7CiAJaTkxNV92bWFfcHV0KHJpbmctPnZtYSk7CiAKIAlpOTE1X3RpbWVsaW5lX3B1dChyaW5n
LT50aW1lbGluZSk7CkBAIC0xNDA0LDEwICsxMzk4LDcgQEAgYWxsb2NfY29udGV4dF92bWEoc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCX0KIAogCXZtYSA9IGk5MTVfdm1hX2luc3Rh
bmNlKG9iaiwgJmk5MTUtPmdndHQudm0sIE5VTEwpOwotCWlmIChJU19FUlIodm1hKSkgewotCQll
cnIgPSBQVFJfRVJSKHZtYSk7Ci0JCWdvdG8gZXJyX29iajsKLQl9CisJaTkxNV9nZW1fb2JqZWN0
X3B1dChvYmopOwogCiAJcmV0dXJuIHZtYTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfd29ya2Fyb3VuZHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX3dvcmthcm91bmRzLmMKaW5kZXggMTY1YjBhNDVlMDA5Li4yYzQyZjY2ZjkzMDEgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3dvcmthcm91bmRzLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfd29ya2Fyb3VuZHMuYwpAQCAtMTMxMCwyMCAr
MTMxMCwxOSBAQCBjcmVhdGVfc2NyYXRjaChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwg
aW50IGNvdW50KQogCWk5MTVfZ2VtX29iamVjdF9zZXRfY2FjaGVfY29oZXJlbmN5KG9iaiwgSTkx
NV9DQUNIRV9MTEMpOwogCiAJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCB2bSwgTlVMTCk7
Ci0JaWYgKElTX0VSUih2bWEpKSB7Ci0JCWVyciA9IFBUUl9FUlIodm1hKTsKLQkJZ290byBlcnJf
b2JqOwotCX0KKwlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJaWYgKElTX0VSUih2bWEpKQor
CQlyZXR1cm4gdm1hOwogCiAJZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwKIAkJCSAgIGk5
MTVfdm1hX2lzX2dndHQodm1hKSA/IFBJTl9HTE9CQUwgOiBQSU5fVVNFUik7CiAJaWYgKGVycikK
LQkJZ290byBlcnJfb2JqOworCQlnb3RvIGVycl9wdXQ7CiAKIAlyZXR1cm4gdm1hOwogCi1lcnJf
b2JqOgotCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKK2Vycl9wdXQ6CisJaTkxNV92bWFfcHV0
KHZtYSk7CiAJcmV0dXJuIEVSUl9QVFIoZXJyKTsKIH0KIApAQCAtMTQwMyw4ICsxNDAyLDcgQEAg
c3RhdGljIGludCBlbmdpbmVfd2FfbGlzdF92ZXJpZnkoc3RydWN0IGludGVsX2NvbnRleHQgKmNl
LAogCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAodm1hLT5vYmopOwogCiBlcnJfdm1hOgotCWk5
MTVfdm1hX3VucGluKHZtYSk7Ci0JaTkxNV92bWFfcHV0KHZtYSk7CisJaTkxNV92bWFfZGVzdHJv
eSh2bWEpOwogCXJldHVybiBlcnI7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9z
ZWxmdGVzdF93b3JrYXJvdW5kcy5jCmluZGV4IDkzZTk1NzliOGE0Zi4uMTgwNzQ1NTE3NjMzIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKQEAg
LTExMCw3ICsxMTAsNyBAQCByZWFkX25vbnByaXZzKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpj
dHgsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAogCWVyciA9IGk5MTVfdm1hX3Bp
bih2bWEsIDAsIDAsIFBJTl9HTE9CQUwpOwogCWlmIChlcnIpCi0JCWdvdG8gZXJyX29iajsKKwkJ
Z290byBlcnJfdm1hOwogCiAJcnEgPSBpZ3RfcmVxdWVzdF9hbGxvYyhjdHgsIGVuZ2luZSk7CiAJ
aWYgKElTX0VSUihycSkpIHsKQEAgLTE0NCw2ICsxNDQsNyBAQCByZWFkX25vbnByaXZzKHN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkK
IAogCWk5MTVfcmVxdWVzdF9hZGQocnEpOwogCWk5MTVfdm1hX3VucGluKHZtYSk7CisJaTkxNV92
bWFfcHV0KHZtYSk7CiAKIAlyZXR1cm4gcmVzdWx0OwogCkBAIC0xNTEsNiArMTUyLDggQEAgcmVh
ZF9ub25wcml2cyhzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LCBzdHJ1Y3QgaW50ZWxfZW5n
aW5lX2NzICplbmdpbmUpCiAJaTkxNV9yZXF1ZXN0X2FkZChycSk7CiBlcnJfcGluOgogCWk5MTVf
dm1hX3VucGluKHZtYSk7CitlcnJfdm1hOgorCWk5MTVfdm1hX3B1dCh2bWEpOwogZXJyX29iajoK
IAlpOTE1X2dlbV9vYmplY3RfcHV0KHJlc3VsdCk7CiAJcmV0dXJuIEVSUl9QVFIoZXJyKTsKQEAg
LTM1OSwxOSArMzYyLDE4IEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKmNyZWF0ZV9iYXRjaChz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogCQlyZXR1cm4gRVJSX0NBU1Qob2JqKTsKIAog
CXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgY3R4LT52bSwgTlVMTCk7Ci0JaWYgKElTX0VS
Uih2bWEpKSB7Ci0JCWVyciA9IFBUUl9FUlIodm1hKTsKLQkJZ290byBlcnJfb2JqOwotCX0KKwlp
OTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJaWYgKElTX0VSUih2bWEpKQorCQlyZXR1cm4gdm1h
OwogCiAJZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwgUElOX1VTRVIpOwogCWlmIChlcnIp
Ci0JCWdvdG8gZXJyX29iajsKKwkJZ290byBlcnJfcHV0OwogCiAJcmV0dXJuIHZtYTsKIAotZXJy
X29iajoKLQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CitlcnJfcHV0OgorCWk5MTVfdm1hX3B1
dCh2bWEpOwogCXJldHVybiBFUlJfUFRSKGVycik7CiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9zY2hlZHVsZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9z
Y2hlZHVsZXIuYwppbmRleCBjMzZmOTA0YTZkNTQuLmJiYzg1MjM4NmIwYSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d2dC9zY2hlZHVsZXIuYwpAQCAtNTk1LDcgKzU5NSw3IEBAIHN0YXRpYyB2b2lkIHJl
bGVhc2Vfc2hhZG93X2JhdGNoX2J1ZmZlcihzdHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29y
a2xvYWQpCiAKIAkJCWlmIChiYi0+dm1hICYmICFJU19FUlIoYmItPnZtYSkpIHsKIAkJCQlpOTE1
X3ZtYV91bnBpbihiYi0+dm1hKTsKLQkJCQlpOTE1X3ZtYV9jbG9zZShiYi0+dm1hKTsKKwkJCQlp
OTE1X3ZtYV9wdXQoYmItPnZtYSk7CiAJCQl9CiAJCQlpOTE1X2dlbV9vYmplY3RfcHV0KGJiLT5v
YmopOwogCQl9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwppbmRleCA5NDkwMWQyZDY1NzMuLmZjYmNh
OGEwNmY0MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCkBAIC0xMTIsMTEgKzExMiwxNCBAQCBp
bnQgaTkxNV9nZW1fb2JqZWN0X3VuYmluZChzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2Jq
KQogCXdoaWxlICghcmV0ICYmICh2bWEgPSBsaXN0X2ZpcnN0X2VudHJ5X29yX251bGwoJm9iai0+
dm1hLmxpc3QsCiAJCQkJCQkgICAgICAgc3RydWN0IGk5MTVfdm1hLAogCQkJCQkJICAgICAgIG9i
al9saW5rKSkpIHsKKwkJaTkxNV92bWFfZ2V0KHZtYSk7CisKIAkJbGlzdF9tb3ZlX3RhaWwoJnZt
YS0+b2JqX2xpbmssICZzdGlsbF9pbl9saXN0KTsKIAkJc3Bpbl91bmxvY2soJm9iai0+dm1hLmxv
Y2spOwogCiAJCXJldCA9IGk5MTVfdm1hX3VuYmluZCh2bWEpOwogCisJCWk5MTVfdm1hX3B1dCh2
bWEpOwogCQlzcGluX2xvY2soJm9iai0+dm1hLmxvY2spOwogCX0KIAlsaXN0X3NwbGljZSgmc3Rp
bGxfaW5fbGlzdCwgJm9iai0+dm1hLmxpc3QpOwpAQCAtMTA5NSwxMSArMTA5OCwxNCBAQCBpOTE1
X2dlbV9vYmplY3RfZ2d0dF9waW4oc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAkJ
ICAgICAhIShmbGFncyAmIFBJTl9NQVBQQUJMRSksCiAJCSAgICAgaTkxNV92bWFfaXNfbWFwX2Fu
ZF9mZW5jZWFibGUodm1hKSk7CiAJCXJldCA9IGk5MTVfdm1hX3VuYmluZCh2bWEpOwotCQlpZiAo
cmV0KQorCQlpZiAocmV0KSB7CisJCQlpOTE1X3ZtYV9wdXQodm1hKTsKIAkJCXJldHVybiBFUlJf
UFRSKHJldCk7CisJCX0KIAl9CiAKIAlyZXQgPSBpOTE1X3ZtYV9waW4odm1hLCBzaXplLCBhbGln
bm1lbnQsIGZsYWdzIHwgUElOX0dMT0JBTCk7CisJaTkxNV92bWFfcHV0KHZtYSk7CiAJaWYgKHJl
dCkKIAkJcmV0dXJuIEVSUl9QVFIocmV0KTsKIApAQCAtMTQ3NiwyMCArMTQ4MiwxOSBAQCBpOTE1
X2dlbV9pbml0X3NjcmF0Y2goc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsIHVuc2lnbmVk
IGludCBzaXplKQogCX0KIAogCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgJmk5MTUtPmdn
dHQudm0sIE5VTEwpOwotCWlmIChJU19FUlIodm1hKSkgewotCQlyZXQgPSBQVFJfRVJSKHZtYSk7
Ci0JCWdvdG8gZXJyX3VucmVmOwotCX0KKwlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJaWYg
KElTX0VSUih2bWEpKQorCQlyZXR1cm4gUFRSX0VSUih2bWEpOwogCiAJcmV0ID0gaTkxNV92bWFf
cGluKHZtYSwgMCwgMCwgUElOX0dMT0JBTCB8IFBJTl9ISUdIKTsKIAlpZiAocmV0KQotCQlnb3Rv
IGVycl91bnJlZjsKKwkJZ290byBlcnJfcHV0OwogCiAJaTkxNS0+Z3Quc2NyYXRjaCA9IHZtYTsK
IAlyZXR1cm4gMDsKIAotZXJyX3VucmVmOgotCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKK2Vy
cl9wdXQ6CisJaTkxNV92bWFfcHV0KHZtYSk7CiAJcmV0dXJuIHJldDsKIH0KIApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X2dlbV9ndHQuYwppbmRleCA0NTcxMjY5NzNjZGQuLjU5ZDIxZmNiZjE4YSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKQEAgLTE5MzEsMTIgKzE5MzEsOSBAQCBzdGF0
aWMgdm9pZCBnZW42X3BwZ3R0X2NsZWFudXBfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndyaykK
IHsKIAlzdHJ1Y3QgZ2VuNl9wcGd0dF9jbGVhbnVwX3dvcmsgKndvcmsgPQogCQljb250YWluZXJf
b2Yod3JrLCB0eXBlb2YoKndvcmspLCBiYXNlKTsKLQkvKiBTaWRlIG5vdGUsIHZtYS0+dm0gaXMg
dGhlIEdHVFQgbm90IHRoZSBwcGd0dCB3ZSBqdXN0IGRlc3Ryb3llZCEgKi8KLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHdvcmstPnZtYS0+dm0tPmk5MTU7CiAKLQltdXRleF9sb2Nr
KCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwkvKiBTaWRlIG5vdGUsIHZtYS0+dm0gaXMgdGhl
IEdHVFQgbm90IHRoZSBwcGd0dCB3ZSBqdXN0IGRlc3Ryb3llZCEgKi8KIAlpOTE1X3ZtYV9kZXN0
cm95KHdvcmstPnZtYSk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
IAogCWtmcmVlKHdvcmspOwogfQpAQCAtMjA2MCw2ICsyMDU3LDcgQEAgc3RhdGljIHN0cnVjdCBp
OTE1X3ZtYSAqcGRfdm1hX2NyZWF0ZShzdHJ1Y3QgZ2VuNl9wcGd0dCAqcHBndHQsIGludCBzaXpl
KQogCWlmICghdm1hKQogCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsKIAorCWtyZWZfaW5pdCgm
dm1hLT5yZWYpOwogCWk5MTVfYWN0aXZlX2luaXQoJnZtYS0+YWN0aXZlLCBOVUxMLCBOVUxMKTsK
IAogCXZtYS0+dm0gPSAmZ2d0dC0+dm07CkBAIC0yMjQ4LDE2ICsyMjQ2LDYgQEAgaTkxNV9wcGd0
dF9jcmVhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiAJcmV0dXJuIHBwZ3R0Owog
fQogCi1zdGF0aWMgdm9pZCBwcGd0dF9kZXN0cm95X3ZtYShzdHJ1Y3QgaTkxNV9hZGRyZXNzX3Nw
YWNlICp2bSkKLXsKLQlzdHJ1Y3QgaTkxNV92bWEgKnZtYSwgKnZuOwotCi0Jdm0tPmNsb3NlZCA9
IHRydWU7Ci0JbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKHZtYSwgdm4sICZ2bS0+Ym91bmRfbGlz
dCwgdm1fbGluaykKLQkJaTkxNV92bWFfZGVzdHJveSh2bWEpOwotCUdFTV9CVUdfT04oIWxpc3Rf
ZW1wdHkoJnZtLT5ib3VuZF9saXN0KSk7Ci19Ci0KIHZvaWQgaTkxNV92bV9yZWxlYXNlKHN0cnVj
dCBrcmVmICprcmVmKQogewogCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0KQEAgLTIy
NjYsOCArMjI1NCw2IEBAIHZvaWQgaTkxNV92bV9yZWxlYXNlKHN0cnVjdCBrcmVmICprcmVmKQog
CUdFTV9CVUdfT04oaTkxNV9pc19nZ3R0KHZtKSk7CiAJdHJhY2VfaTkxNV9wcGd0dF9yZWxlYXNl
KHZtKTsKIAotCXBwZ3R0X2Rlc3Ryb3lfdm1hKHZtKTsKLQogCXZtLT5jbGVhbnVwKHZtKTsKIAlp
OTE1X2FkZHJlc3Nfc3BhY2VfZmluaSh2bSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2VtX3JlbmRlcl9zdGF0ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9nZW1fcmVuZGVyX3N0YXRlLmMKaW5kZXggNGVlMDMyMDcyZDRmLi5jNTlmMGUyMjE0MmYgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX3JlbmRlcl9zdGF0ZS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX3JlbmRlcl9zdGF0ZS5jCkBAIC0yMjgs
NyArMjI4LDcgQEAgaW50IGk5MTVfZ2VtX3JlbmRlcl9zdGF0ZV9lbWl0KHN0cnVjdCBpOTE1X3Jl
cXVlc3QgKnJxKQogZXJyX3VucGluOgogCWk5MTVfdm1hX3VucGluKHNvLnZtYSk7CiBlcnJfdm1h
OgotCWk5MTVfdm1hX2Nsb3NlKHNvLnZtYSk7CisJaTkxNV92bWFfcHV0KHNvLnZtYSk7CiBlcnJf
b2JqOgogCWk5MTVfZ2VtX29iamVjdF9wdXQoc28ub2JqKTsKIAlyZXR1cm4gZXJyOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90aW1lbGluZS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV90aW1lbGluZS5jCmluZGV4IDRmZmI2MTk5MTc2OC4uYjJiYmIxOWVlYTkw
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RpbWVsaW5lLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90aW1lbGluZS5jCkBAIC00Niw4ICs0Niw3IEBAIHN0
YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKl9faHdzcF9hbGxvYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKIAlpOTE1X2dlbV9vYmplY3Rfc2V0X2NhY2hlX2NvaGVyZW5jeShvYmosIEk5MTVf
Q0FDSEVfTExDKTsKIAogCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgJmk5MTUtPmdndHQu
dm0sIE5VTEwpOwotCWlmIChJU19FUlIodm1hKSkKLQkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmop
OworCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIAogCXJldHVybiB2bWE7CiB9CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV92bWEuYwppbmRleCAxNGM2ZDEwNDMzMmEuLmI4MGQ5ZTAwNzI5MyAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3ZtYS5jCkBAIC0xMDgsOSArMTA4LDExIEBAIHZtYV9jcmVhdGUoc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAlpZiAodm1hID09IE5VTEwpCiAJCXJldHVybiBFUlJf
UFRSKC1FTk9NRU0pOwogCi0Jdm1hLT52bSA9IHZtOworCWtyZWZfaW5pdCgmdm1hLT5yZWYpOwor
CisJdm1hLT52bSA9IGk5MTVfdm1fZ2V0KHZtKTsKIAl2bWEtPm9wcyA9ICZ2bS0+dm1hX29wczsK
LQl2bWEtPm9iaiA9IG9iajsKKwl2bWEtPm9iaiA9IGk5MTVfZ2VtX29iamVjdF9nZXQob2JqKTsK
IAl2bWEtPnJlc3YgPSBvYmotPnJlc3Y7CiAJdm1hLT5zaXplID0gb2JqLT5iYXNlLnNpemU7CiAJ
dm1hLT5kaXNwbGF5X2FsaWdubWVudCA9IEk5MTVfR1RUX01JTl9BTElHTk1FTlQ7CkBAIC0xODIs
NiArMTg0LDcgQEAgdm1hX2NyZWF0ZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAog
CQkgKi8KIAkJY21wID0gaTkxNV92bWFfY29tcGFyZShwb3MsIHZtLCB2aWV3KTsKIAkJaWYgKGNt
cCA9PSAwKSB7CisJCQlpOTE1X3ZtYV9nZXQocG9zKTsKIAkJCXNwaW5fdW5sb2NrKCZvYmotPnZt
YS5sb2NrKTsKIAkJCWk5MTVfdm1hX2ZyZWUodm1hKTsKIAkJCXJldHVybiBwb3M7CkBAIC0yNjcs
MTEgKzI3MCwxNCBAQCBpOTE1X3ZtYV9pbnN0YW5jZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqLAogCiAJc3Bpbl9sb2NrKCZvYmotPnZtYS5sb2NrKTsKIAl2bWEgPSB2bWFfbG9va3Vw
KG9iaiwgdm0sIHZpZXcpOworCWlmIChsaWtlbHkodm1hKSkKKwkJaTkxNV92bWFfZ2V0KHZtYSk7
CiAJc3Bpbl91bmxvY2soJm9iai0+dm1hLmxvY2spOworCWlmIChsaWtlbHkodm1hKSkKKwkJcmV0
dXJuIHZtYTsKIAogCS8qIHZtYV9jcmVhdGUoKSB3aWxsIHJlc29sdmUgdGhlIHJhY2UgaWYgYW5v
dGhlciBjcmVhdGVzIHRoZSB2bWEgKi8KLQlpZiAodW5saWtlbHkoIXZtYSkpCi0JCXZtYSA9IHZt
YV9jcmVhdGUob2JqLCB2bSwgdmlldyk7CisJdm1hID0gdm1hX2NyZWF0ZShvYmosIHZtLCB2aWV3
KTsKIAogCUdFTV9CVUdfT04oIUlTX0VSUih2bWEpICYmIGk5MTVfdm1hX2NvbXBhcmUodm1hLCB2
bSwgdmlldykpOwogCXJldHVybiB2bWE7CkBAIC0zMjYsNyArMzMyLDEwIEBAIGludCBpOTE1X3Zt
YV9iaW5kKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLCBlbnVtIGk5MTVfY2FjaGVfbGV2ZWwgY2FjaGVf
bGV2ZWwsCiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIAorCWlmICghdm1hX2ZsYWdzKQorCQlp
OTE1X3ZtYV9nZXQodm1hKTsKIAl2bWEtPmZsYWdzIHw9IGJpbmRfZmxhZ3M7CisKIAlyZXR1cm4g
MDsKIH0KIApAQCAtNDAwLDIyICs0MDksMTYgQEAgdm9pZCBpOTE1X3ZtYV91bnBpbl9pb21hcChz
dHJ1Y3QgaTkxNV92bWEgKnZtYSkKIHZvaWQgaTkxNV92bWFfdW5waW5fYW5kX3JlbGVhc2Uoc3Ry
dWN0IGk5MTVfdm1hICoqcF92bWEsIHVuc2lnbmVkIGludCBmbGFncykKIHsKIAlzdHJ1Y3QgaTkx
NV92bWEgKnZtYTsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqOwogCiAJdm1hID0g
ZmV0Y2hfYW5kX3plcm8ocF92bWEpOwogCWlmICghdm1hKQogCQlyZXR1cm47CiAKLQlvYmogPSB2
bWEtPm9iajsKLQlHRU1fQlVHX09OKCFvYmopOwotCiAJaTkxNV92bWFfdW5waW4odm1hKTsKLQlp
OTE1X3ZtYV9jbG9zZSh2bWEpOwotCiAJaWYgKGZsYWdzICYgSTkxNV9WTUFfUkVMRUFTRV9NQVAp
Ci0JCWk5MTVfZ2VtX29iamVjdF91bnBpbl9tYXAob2JqKTsKKwkJaTkxNV9nZW1fb2JqZWN0X3Vu
cGluX21hcCh2bWEtPm9iaik7CiAKLQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJaTkxNV92
bWFfcHV0KHZtYSk7CiB9CiAKIGJvb2wgaTkxNV92bWFfbWlzcGxhY2VkKGNvbnN0IHN0cnVjdCBp
OTE1X3ZtYSAqdm1hLApAQCAtNzYwLDExICs3NjMsMTEgQEAgdm9pZCBpOTE1X3ZtYV9jbG9zZShz
dHJ1Y3QgaTkxNV92bWEgKnZtYSkKIAkgKiBvZiB3YXN0ZWQgd29yayBmb3IgdGhlIHN0ZWFkeSBz
dGF0ZS4KIAkgKi8KIAlzcGluX2xvY2tfaXJxc2F2ZSgmaTkxNS0+Z3QuY2xvc2VkX2xvY2ssIGZs
YWdzKTsKLQlsaXN0X2FkZCgmdm1hLT5jbG9zZWRfbGluaywgJmk5MTUtPmd0LmNsb3NlZF92bWEp
OworCWxpc3RfYWRkKCZpOTE1X3ZtYV9nZXQodm1hKS0+Y2xvc2VkX2xpbmssICZpOTE1LT5ndC5j
bG9zZWRfdm1hKTsKIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpOTE1LT5ndC5jbG9zZWRfbG9j
aywgZmxhZ3MpOwogfQogCi1zdGF0aWMgdm9pZCBfX2k5MTVfdm1hX3JlbW92ZV9jbG9zZWQoc3Ry
dWN0IGk5MTVfdm1hICp2bWEpCit2b2lkIGk5MTVfdm1hX3Jlb3BlbihzdHJ1Y3QgaTkxNV92bWEg
KnZtYSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHZtYS0+dm0tPmk5MTU7
CiAKQEAgLTc3NCwxNSArNzc3LDI1IEBAIHN0YXRpYyB2b2lkIF9faTkxNV92bWFfcmVtb3ZlX2Ns
b3NlZChzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKIAlzcGluX2xvY2tfaXJxKCZpOTE1LT5ndC5jbG9z
ZWRfbG9jayk7CiAJbGlzdF9kZWxfaW5pdCgmdm1hLT5jbG9zZWRfbGluayk7CiAJc3Bpbl91bmxv
Y2tfaXJxKCZpOTE1LT5ndC5jbG9zZWRfbG9jayk7CisKKwlpOTE1X3ZtYV9wdXQodm1hKTsKIH0K
IAotdm9pZCBpOTE1X3ZtYV9yZW9wZW4oc3RydWN0IGk5MTVfdm1hICp2bWEpCit2b2lkIGk5MTVf
dm1hX2Rlc3Ryb3koc3RydWN0IGk5MTVfdm1hICp2bWEpCiB7Ci0JX19pOTE1X3ZtYV9yZW1vdmVf
Y2xvc2VkKHZtYSk7CisJbXV0ZXhfbG9jaygmdm1hLT52bS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRl
eCk7CisJdm1hLT5mbGFncyAmPSB+STkxNV9WTUFfUElOX01BU0s7CisJV0FSTl9PTihpOTE1X3Zt
YV91bmJpbmQodm1hKSk7CisJbXV0ZXhfdW5sb2NrKCZ2bWEtPnZtLT5pOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKKworCWk5MTVfdm1hX3B1dCh2bWEpOwogfQogCi1zdGF0aWMgdm9pZCBfX2k5MTVf
dm1hX2Rlc3Ryb3koc3RydWN0IGk5MTVfdm1hICp2bWEpCit2b2lkIF9faTkxNV92bWFfcmVsZWFz
ZShzdHJ1Y3Qga3JlZiAqcmVmKQogeworCXN0cnVjdCBpOTE1X3ZtYSAqdm1hID0gY29udGFpbmVy
X29mKHJlZiwgdHlwZW9mKCp2bWEpLCByZWYpOworCisJR0VNX0JVR19PTihpOTE1X3ZtYV9pc19h
Y3RpdmUodm1hKSk7CiAJR0VNX0JVR19PTih2bWEtPm5vZGUuYWxsb2NhdGVkKTsKIAlHRU1fQlVH
X09OKHZtYS0+ZmVuY2UpOwogCkBAIC03OTEsMjkgKzgwNCwxOCBAQCBzdGF0aWMgdm9pZCBfX2k5
MTVfdm1hX2Rlc3Ryb3koc3RydWN0IGk5MTVfdm1hICp2bWEpCiAKIAkJc3Bpbl9sb2NrKCZvYmot
PnZtYS5sb2NrKTsKIAkJbGlzdF9kZWwoJnZtYS0+b2JqX2xpbmspOwotCQlyYl9lcmFzZSgmdm1h
LT5vYmpfbm9kZSwgJnZtYS0+b2JqLT52bWEudHJlZSk7CisJCXJiX2VyYXNlKCZ2bWEtPm9ial9u
b2RlLCAmb2JqLT52bWEudHJlZSk7CiAJCXNwaW5fdW5sb2NrKCZvYmotPnZtYS5sb2NrKTsKKwor
CQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAJfQogCiAJaTkxNV9hY3RpdmVfZmluaSgmdm1h
LT5hY3RpdmUpOwogCisJaTkxNV92bV9wdXQodm1hLT52bSk7CiAJaTkxNV92bWFfZnJlZSh2bWEp
OwogfQogCi12b2lkIGk5MTVfdm1hX2Rlc3Ryb3koc3RydWN0IGk5MTVfdm1hICp2bWEpCi17Ci0J
bG9ja2RlcF9hc3NlcnRfaGVsZCgmdm1hLT52bS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0K
LQlHRU1fQlVHX09OKGk5MTVfdm1hX2lzX3Bpbm5lZCh2bWEpKTsKLQotCV9faTkxNV92bWFfcmVt
b3ZlX2Nsb3NlZCh2bWEpOwotCi0JV0FSTl9PTihpOTE1X3ZtYV91bmJpbmQodm1hKSk7Ci0JR0VN
X0JVR19PTihpOTE1X3ZtYV9pc19hY3RpdmUodm1hKSk7Ci0KLQlfX2k5MTVfdm1hX2Rlc3Ryb3ko
dm1hKTsKLX0KLQogdm9pZCBpOTE1X3ZtYV9wYXJrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCiB7CiAJc3RydWN0IGk5MTVfdm1hICp2bWEsICpuZXh0OwpAQCAtODIzLDcgKzgyNSw3
IEBAIHZvaWQgaTkxNV92bWFfcGFya2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQog
CQlsaXN0X2RlbF9pbml0KCZ2bWEtPmNsb3NlZF9saW5rKTsKIAkJc3Bpbl91bmxvY2tfaXJxKCZp
OTE1LT5ndC5jbG9zZWRfbG9jayk7CiAKLQkJaTkxNV92bWFfZGVzdHJveSh2bWEpOworCQlpOTE1
X3ZtYV91bmJpbmQodm1hKTsKIAogCQlzcGluX2xvY2tfaXJxKCZpOTE1LT5ndC5jbG9zZWRfbG9j
ayk7CiAJfQpAQCAtOTc1LDYgKzk3Nyw3IEBAIGludCBpOTE1X3ZtYV91bmJpbmQoc3RydWN0IGk5
MTVfdm1hICp2bWEpCiAJdm1hLT5mbGFncyAmPSB+KEk5MTVfVk1BX0dMT0JBTF9CSU5EIHwgSTkx
NV9WTUFfTE9DQUxfQklORCk7CiAKIAlpOTE1X3ZtYV9yZW1vdmUodm1hKTsKKwlpOTE1X3ZtYV9w
dXQodm1hKTsKIAogCXJldHVybiAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV92bWEuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmgKaW5kZXggNzEw
ODhmZjRhZDU5Li4yN2E1OTkzOTY2YTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfdm1hLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuaApAQCAtNTEs
MTQgKzUxLDE5IEBAIGVudW0gaTkxNV9jYWNoZV9sZXZlbDsKICAqLwogc3RydWN0IGk5MTVfdm1h
IHsKIAlzdHJ1Y3QgZHJtX21tX25vZGUgbm9kZTsKLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVj
dCAqb2JqOwotCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOworCisJc3RydWN0IGtyZWYg
cmVmOwogCWNvbnN0IHN0cnVjdCBpOTE1X3ZtYV9vcHMgKm9wczsKLQlzdHJ1Y3QgaTkxNV9mZW5j
ZV9yZWcgKmZlbmNlOwotCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3Y7IC8qKiBBbGlh
cyBvZiBvYmotPnJlc3YgKi8KKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKKwl2b2lk
ICpwcml2YXRlOyAvKiBvd25lZCBieSBjcmVhdG9yICovCisKIAlzdHJ1Y3Qgc2dfdGFibGUgKnBh
Z2VzOworCXN0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2U7CiAJdm9pZCBfX2lvbWVtICppb21h
cDsKLQl2b2lkICpwcml2YXRlOyAvKiBvd25lZCBieSBjcmVhdG9yICovCisKKwlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqOworCXN0cnVjdCByZXNlcnZhdGlvbl9vYmplY3QgKnJlc3Y7
IC8qKiBBbGlhcyBvZiBvYmotPnJlc3YgKi8KKwogCXU2NCBzaXplOwogCXU2NCBkaXNwbGF5X2Fs
aWdubWVudDsKIAlzdHJ1Y3QgaTkxNV9wYWdlX3NpemVzIHBhZ2Vfc2l6ZXM7CkBAIC02NiwxMSAr
NzEsNiBAQCBzdHJ1Y3QgaTkxNV92bWEgewogCXUzMiBmZW5jZV9zaXplOwogCXUzMiBmZW5jZV9h
bGlnbm1lbnQ7CiAKLQkvKioKLQkgKiBDb3VudCBvZiB0aGUgbnVtYmVyIG9mIHRpbWVzIHRoaXMg
dm1hIGhhcyBiZWVuIG9wZW5lZCBieSBkaWZmZXJlbnQKLQkgKiBoYW5kbGVzIChidXQgc2FtZSBm
aWxlKSBmb3IgZXhlY2J1ZiwgaS5lLiB0aGUgbnVtYmVyIG9mIGFsaWFzZXMKLQkgKiB0aGF0IGV4
aXN0IGluIHRoZSBjdHgtPmhhbmRsZV92bWFzIExVVCBmb3IgdGhpcyB2bWEuCi0JICovCiAJYXRv
bWljX3Qgb3Blbl9jb3VudDsKIAl1bnNpZ25lZCBsb25nIGZsYWdzOwogCS8qKgpAQCAtMjA2LDYg
KzIwNiwxMCBAQCBzdGF0aWMgaW5saW5lIGJvb2wgaTkxNV92bWFfaGFzX3VzZXJmYXVsdChjb25z
dCBzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKIAlyZXR1cm4gdGVzdF9iaXQoSTkxNV9WTUFfVVNFUkZB
VUxUX0JJVCwgJnZtYS0+ZmxhZ3MpOwogfQogCit2b2lkIGk5MTVfdm1hX2Nsb3NlKHN0cnVjdCBp
OTE1X3ZtYSAqdm1hKTsKK3ZvaWQgaTkxNV92bWFfcmVvcGVuKHN0cnVjdCBpOTE1X3ZtYSAqdm1h
KTsKK3ZvaWQgaTkxNV92bWFfcGFya2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsK
Kwogc3RhdGljIGlubGluZSBib29sIGk5MTVfdm1hX2lzX2Nsb3NlZChjb25zdCBzdHJ1Y3QgaTkx
NV92bWEgKnZtYSkKIHsKIAlyZXR1cm4gIWxpc3RfZW1wdHkoJnZtYS0+Y2xvc2VkX2xpbmspOwpA
QCAtMjI3LDE1ICsyMzEsMTggQEAgc3RhdGljIGlubGluZSB1MzIgaTkxNV9nZ3R0X3Bpbl9iaWFz
KHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X3ZtYSAq
aTkxNV92bWFfZ2V0KHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogewotCWk5MTVfZ2VtX29iamVjdF9n
ZXQodm1hLT5vYmopOworCWtyZWZfZ2V0KCZ2bWEtPnJlZik7CiAJcmV0dXJuIHZtYTsKIH0KIAor
dm9pZCBfX2k5MTVfdm1hX3JlbGVhc2Uoc3RydWN0IGtyZWYgKnJlZik7CiBzdGF0aWMgaW5saW5l
IHZvaWQgaTkxNV92bWFfcHV0KHN0cnVjdCBpOTE1X3ZtYSAqdm1hKQogewotCWk5MTVfZ2VtX29i
amVjdF9wdXQodm1hLT5vYmopOworCWtyZWZfcHV0KCZ2bWEtPnJlZiwgX19pOTE1X3ZtYV9yZWxl
YXNlKTsKIH0KIAordm9pZCBpOTE1X3ZtYV9kZXN0cm95KHN0cnVjdCBpOTE1X3ZtYSAqdm1hKTsK
Kwogc3RhdGljIF9fYWx3YXlzX2lubGluZSBwdHJkaWZmX3QgcHRyZGlmZihjb25zdCB2b2lkICph
LCBjb25zdCB2b2lkICpiKQogewogCXJldHVybiBhIC0gYjsKQEAgLTI5MiwxMSArMjk5LDggQEAg
Ym9vbCBpOTE1X3ZtYV9taXNwbGFjZWQoY29uc3Qgc3RydWN0IGk5MTVfdm1hICp2bWEsCiAJCQl1
NjQgc2l6ZSwgdTY0IGFsaWdubWVudCwgdTY0IGZsYWdzKTsKIHZvaWQgX19pOTE1X3ZtYV9zZXRf
bWFwX2FuZF9mZW5jZWFibGUoc3RydWN0IGk5MTVfdm1hICp2bWEpOwogdm9pZCBpOTE1X3ZtYV9y
ZXZva2VfbW1hcChzdHJ1Y3QgaTkxNV92bWEgKnZtYSk7Ci1pbnQgX19tdXN0X2NoZWNrIGk5MTVf
dm1hX3VuYmluZChzdHJ1Y3QgaTkxNV92bWEgKnZtYSk7CitpbnQgaTkxNV92bWFfdW5iaW5kKHN0
cnVjdCBpOTE1X3ZtYSAqdm1hKTsKIHZvaWQgaTkxNV92bWFfdW5saW5rX2N0eChzdHJ1Y3QgaTkx
NV92bWEgKnZtYSk7Ci12b2lkIGk5MTVfdm1hX2Nsb3NlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKTsK
LXZvaWQgaTkxNV92bWFfcmVvcGVuKHN0cnVjdCBpOTE1X3ZtYSAqdm1hKTsKLXZvaWQgaTkxNV92
bWFfZGVzdHJveShzdHJ1Y3QgaTkxNV92bWEgKnZtYSk7CiAKICNkZWZpbmUgYXNzZXJ0X3ZtYV9o
ZWxkKHZtYSkgcmVzZXJ2YXRpb25fb2JqZWN0X2Fzc2VydF9oZWxkKCh2bWEpLT5yZXN2KQogCkBA
IC00MzgsOCArNDQyLDYgQEAgaTkxNV92bWFfdW5waW5fZmVuY2Uoc3RydWN0IGk5MTVfdm1hICp2
bWEpCiAJCV9faTkxNV92bWFfdW5waW5fZmVuY2Uodm1hKTsKIH0KIAotdm9pZCBpOTE1X3ZtYV9w
YXJrZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwotCiAjZGVmaW5lIGZvcl9lYWNo
X3VudGlsKGNvbmQpIGlmIChjb25kKSBicmVhazsgZWxzZQogCiAvKioKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX2Rpc3BsYXkuYwppbmRleCA3NGZjNmQ2OTY1NDAuLmMzZjQ0Y2JkYjgxNSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheS5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXkuYwpAQCAtMzA4MCwxMiArMzA4MCwxNCBAQCBpbml0
aWFsX3BsYW5lX3ZtYShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJYnJlYWs7CiAJ
ZGVmYXVsdDoKIAkJTUlTU0lOR19DQVNFKHBsYW5lX2NvbmZpZy0+dGlsaW5nKTsKLQkJZ290byBl
cnJfb2JqOworCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CisJCXJldHVybiBOVUxMOwogCX0K
IAogCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgJmk5MTUtPmdndHQudm0sIE5VTEwpOwor
CWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIAlpZiAoSVNfRVJSKHZtYSkpCi0JCWdvdG8gZXJy
X29iajsKKwkJcmV0dXJuIE5VTEw7CiAKIAltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKIAllcnIgPSBpOTE1X3ZtYV9waW4odm1hLCAwLCAwLApAQCAtMzA5MywxNiArMzA5NSwx
NiBAQCBpbml0aWFsX3BsYW5lX3ZtYShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIAkJ
CSAgIGJhc2UgfCBQSU5fT0ZGU0VUX0ZJWEVEKTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwogCWlmIChlcnIpCi0JCWdvdG8gZXJyX29iajsKKwkJZ290byBlcnJfdm1h
OwogCi0JaWYgKGk5MTVfZ2VtX29iamVjdF9pc190aWxlZChvYmopICYmCisJaWYgKGk5MTVfZ2Vt
X29iamVjdF9pc190aWxlZCh2bWEtPm9iaikgJiYKIAkgICAgIWk5MTVfdm1hX2lzX21hcF9hbmRf
ZmVuY2VhYmxlKHZtYSkpCi0JCWdvdG8gZXJyX29iajsKKwkJZ290byBlcnJfdm1hOwogCiAJcmV0
dXJuIHZtYTsKIAotZXJyX29iajoKLQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CitlcnJfdm1h
OgorCWk5MTVfdm1hX3B1dCh2bWEpOwogCXJldHVybiBOVUxMOwogfQogCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2lu
dGVsX2d1Yy5jCmluZGV4IGM0MGE2ZWZkZDMzYS4uM2I0ZTc2ODZjZDZjIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ndWMuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9ndWMuYwpAQCAtNjY5LDE5ICs2NjksMTYgQEAgc3RydWN0IGk5MTVfdm1hICppbnRl
bF9ndWNfYWxsb2NhdGVfdm1hKHN0cnVjdCBpbnRlbF9ndWMgKmd1YywgdTMyIHNpemUpCiAJCXJl
dHVybiBFUlJfQ0FTVChvYmopOwogCiAJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCAmZGV2
X3ByaXYtPmdndHQudm0sIE5VTEwpOworCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKIAlpZiAo
SVNfRVJSKHZtYSkpCi0JCWdvdG8gZXJyOworCQlyZXR1cm4gdm1hOwogCiAJZmxhZ3MgPSBQSU5f
R0xPQkFMIHwgUElOX09GRlNFVF9CSUFTIHwgaTkxNV9nZ3R0X3Bpbl9iaWFzKHZtYSk7CiAJcmV0
ID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwgZmxhZ3MpOwogCWlmIChyZXQpIHsKKwkJaTkxNV92
bWFfcHV0KHZtYSk7CiAJCXZtYSA9IEVSUl9QVFIocmV0KTsKLQkJZ290byBlcnI7CiAJfQogCiAJ
cmV0dXJuIHZtYTsKLQotZXJyOgotCWk5MTVfZ2VtX29iamVjdF9wdXQob2JqKTsKLQlyZXR1cm4g
dm1hOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ZlcmxheS5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ZlcmxheS5jCmluZGV4IGQ1MGEwMTk2YjE2
Ni4uMDA5Y2RkYzA5MzY3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9v
dmVybGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfb3ZlcmxheS5jCkBAIC0x
ODYsNyArMTg2LDcgQEAgc3RydWN0IGludGVsX292ZXJsYXkgewogCXUzMiBicmlnaHRuZXNzLCBj
b250cmFzdCwgc2F0dXJhdGlvbjsKIAl1MzIgb2xkX3hzY2FsZSwgb2xkX3lzY2FsZTsKIAkvKiBy
ZWdpc3RlciBhY2Nlc3MgKi8KLQlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqcmVnX2JvOwor
CXN0cnVjdCBpOTE1X3ZtYSAqcmVnX3ZtYTsKIAlzdHJ1Y3Qgb3ZlcmxheV9yZWdpc3RlcnMgX19p
b21lbSAqcmVnczsKIAl1MzIgZmxpcF9hZGRyOwogCS8qIGZsaXAgaGFuZGxpbmcgKi8KQEAgLTEz
MTksMTMgKzEzMTksMTQgQEAgc3RhdGljIGludCBnZXRfcmVnaXN0ZXJzKHN0cnVjdCBpbnRlbF9v
dmVybGF5ICpvdmVybGF5LCBib29sIHVzZV9waHlzKQogCX0KIAogCXZtYSA9IGk5MTVfZ2VtX29i
amVjdF9nZ3R0X3BpbihvYmosIE5VTEwsIDAsIDAsIFBJTl9NQVBQQUJMRSk7CisJaTkxNV9nZW1f
b2JqZWN0X3B1dChvYmopOwogCWlmIChJU19FUlIodm1hKSkgewogCQllcnIgPSBQVFJfRVJSKHZt
YSk7Ci0JCWdvdG8gZXJyX3B1dF9ibzsKKwkJZ290byBlcnJfdW5sb2NrOwogCX0KIAogCWlmICh1
c2VfcGh5cykKLQkJb3ZlcmxheS0+ZmxpcF9hZGRyID0gc2dfZG1hX2FkZHJlc3Mob2JqLT5tbS5w
YWdlcy0+c2dsKTsKKwkJb3ZlcmxheS0+ZmxpcF9hZGRyID0gc2dfZG1hX2FkZHJlc3Modm1hLT5v
YmotPm1tLnBhZ2VzLT5zZ2wpOwogCWVsc2UKIAkJb3ZlcmxheS0+ZmxpcF9hZGRyID0gaTkxNV9n
Z3R0X29mZnNldCh2bWEpOwogCW92ZXJsYXktPnJlZ3MgPSBpOTE1X3ZtYV9waW5faW9tYXAodm1h
KTsKQEAgLTEzMzMsMTUgKzEzMzQsMTUgQEAgc3RhdGljIGludCBnZXRfcmVnaXN0ZXJzKHN0cnVj
dCBpbnRlbF9vdmVybGF5ICpvdmVybGF5LCBib29sIHVzZV9waHlzKQogCiAJaWYgKElTX0VSUihv
dmVybGF5LT5yZWdzKSkgewogCQllcnIgPSBQVFJfRVJSKG92ZXJsYXktPnJlZ3MpOwotCQlnb3Rv
IGVycl9wdXRfYm87CisJCWdvdG8gZXJyX3ZtYTsKIAl9CiAKLQlvdmVybGF5LT5yZWdfYm8gPSBv
Ymo7CisJb3ZlcmxheS0+cmVnX3ZtYSA9IHZtYTsKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwogCXJldHVybiAwOwogCi1lcnJfcHV0X2JvOgotCWk5MTVfZ2VtX29iamVj
dF9wdXQob2JqKTsKK2Vycl92bWE6CisJaTkxNV92bWFfZGVzdHJveSh2bWEpOwogZXJyX3VubG9j
azoKIAltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiBlcnI7
CkBAIC0xNDAxLDcgKzE0MDIsNyBAQCB2b2lkIGludGVsX292ZXJsYXlfY2xlYW51cChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJICovCiAJV0FSTl9PTihvdmVybGF5LT5hY3Rp
dmUpOwogCi0JaTkxNV9nZW1fb2JqZWN0X3B1dChvdmVybGF5LT5yZWdfYm8pOworCWk5MTVfdm1h
X2Rlc3Ryb3kob3ZlcmxheS0+cmVnX3ZtYSk7CiAJaTkxNV9hY3RpdmVfZmluaSgmb3ZlcmxheS0+
bGFzdF9mbGlwKTsKIAogCWtmcmVlKG92ZXJsYXkpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
c2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCmluZGV4IDcwYzhiYzYyNjMwMC4uNjY0YjdlM2UxZDdj
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZ3R0
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCkBA
IC0zMzIsOSArMzMyLDggQEAgc3RhdGljIHZvaWQgY2xvc2Vfb2JqZWN0X2xpc3Qoc3RydWN0IGxp
c3RfaGVhZCAqb2JqZWN0cywKIAkJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCB2bSwgTlVM
TCk7CiAJCWlmICghSVNfRVJSKHZtYSkpCiAJCQlpZ25vcmVkID0gaTkxNV92bWFfdW5iaW5kKHZt
YSk7Ci0JCS8qIE9ubHkgcHBndHQgdm1hIG1heSBiZSBjbG9zZWQgYmVmb3JlIHRoZSBvYmplY3Qg
aXMgZnJlZWQgKi8KLQkJaWYgKCFJU19FUlIodm1hKSAmJiAhaTkxNV92bWFfaXNfZ2d0dCh2bWEp
KQotCQkJaTkxNV92bWFfY2xvc2Uodm1hKTsKKwkJaWYgKCFJU19FUlIodm1hKSkKKwkJCWk5MTVf
dm1hX3B1dCh2bWEpOwogCiAJCWxpc3RfZGVsKCZvYmotPnN0X2xpbmspOwogCQlpOTE1X2dlbV9v
YmplY3RfcHV0KG9iaik7CkBAIC02MjQsOCArNjIzLDYgQEAgc3RhdGljIGludCB3YWxrX2hvbGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCX0KIAogZXJyX2Nsb3NlOgotCQlpZiAo
IWk5MTVfdm1hX2lzX2dndHQodm1hKSkKLQkJCWk5MTVfdm1hX2Nsb3NlKHZtYSk7CiBlcnJfcHV0
OgogCQlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAJCWlmIChlcnIpCkBAIC03MDYsOCArNzAz
LDYgQEAgc3RhdGljIGludCBwb3RfaG9sZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
IAl9CiAKIGVycjoKLQlpZiAoIWk5MTVfdm1hX2lzX2dndHQodm1hKSkKLQkJaTkxNV92bWFfY2xv
c2Uodm1hKTsKIGVycl9vYmo6CiAJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwogCXJldHVybiBl
cnI7CkBAIC04MDksOCArODA0LDYgQEAgc3RhdGljIGludCBkcnVua19ob2xlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAogCQl9CiAKIGVycjoKLQkJaWYgKCFpOTE1X3ZtYV9pc19nZ3R0
KHZtYSkpCi0JCQlpOTE1X3ZtYV9jbG9zZSh2bWEpOwogZXJyX29iajoKIAkJaTkxNV9nZW1fb2Jq
ZWN0X3B1dChvYmopOwogCQlrZnJlZShvcmRlcik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0
ZXN0cy9pOTE1X3ZtYS5jCmluZGV4IGExNjZkOTQwNWE5NC4uNTZjMWNhYzM2OGNjIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYworKysgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYwpAQCAtMzE3LDYgKzMxNyw3IEBA
IHN0YXRpYyBpbnQgaWd0X3ZtYV9waW4xKHZvaWQgKmFyZykKIAkJcmV0dXJuIFBUUl9FUlIob2Jq
KTsKIAogCXZtYSA9IGNoZWNrZWRfdm1hX2luc3RhbmNlKG9iaiwgJmdndHQtPnZtLCBOVUxMKTsK
KwlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CiAJaWYgKElTX0VSUih2bWEpKQogCQlnb3RvIG91
dDsKIApAQCAtMzQ1LDcgKzM0Niw3IEBAIHN0YXRpYyBpbnQgaWd0X3ZtYV9waW4xKHZvaWQgKmFy
ZykKIAogCWVyciA9IDA7CiBvdXQ6Ci0JaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworCWk5MTVf
dm1hX2Rlc3Ryb3kodm1hKTsKIAlyZXR1cm4gZXJyOwogfQogCi0tIAoyLjIwLjEKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5n
IGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 2460C58BB0
	for <lists+intel-gfx@lfdr.de>; Thu, 27 Jun 2019 22:33:07 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D0C846E4CA;
	Thu, 27 Jun 2019 20:33:04 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id AD8FC6E4CA
 for <intel-gfx@lists.freedesktop.org>; Thu, 27 Jun 2019 20:33:03 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 27 Jun 2019 13:33:03 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,425,1557212400"; d="scan'208";a="313920021"
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by orsmga004.jf.intel.com with ESMTP; 27 Jun 2019 13:33:02 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 27 Jun 2019 13:32:25 -0700
Message-Id: <20190627203225.3427-1-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [RFC] drm/i915/tgl: Gen12 csb support
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhlIENTQiBmb3JtYXQgaGFzIGJlZW4gcmV3b3JrZWQgZm9yIEdlbjEyIHRvIGluY2x1ZGUgaW5m
b3JtYXRpb24gb24KYm90aCB0aGUgY29udGV4dCB3ZSdyZSBzd2l0Y2hpbmcgYXdheSBmcm9tIGFu
ZCB0aGUgY29udGV4dCB3ZSdyZQpzd2l0Y2hpbmcgdG8uIEFmdGVyIHRoZSBjaGFuZ2UsIHNvbWUg
b2YgdGhlIGV2ZW50cyBkb24ndCBoYXZlIHRoZWlyCm93biBiaXQgYW55bW9yZSBhbmQgbmVlZCB0
byBiZSBpbmZlcnJlZCBmcm9tIG90aGVyIHZhbHVlcyBpbiB0aGUgY3NiLgpPbmUgb2YgdGhlIGNv
bnRleHQgSURzICgweDdGRikgaGFzIGFsc28gYmVlbiByZXNlcnZlZCB0byBpbmRpY2F0ZQp0aGUg
aW52YWxpZCBjdHgsIGkuZS4gZW5naW5lIGlkbGUuClRvIGtlZXAgdGhlIGxvZ2ljIHNpbXBsZSwg
d2UgY2FuIGNvbnZlcnQgdGhlIG5ldyBnZW4xMiBmb3JtYXQgdG8gdGhlCmdlbjExIGZvcm1hdCBh
bmQgcmUtdXNlIHRoZSBsZWdhY3kgY3NiIGhhbmRsaW5nIGxvZ2ljLiBUaGlzIHJlc3VsdAppbiBh
IHNsaWdsdGhseSBzbG93ZXIgaGFuZGxpbmcgZm9yIGdlbjEyIGJ1dCBhbGxvd3MgdXMgdG8gZ2V0
IHJ1bm5pbmcKd2l0aCBhIHJlbGF0aXZlbHkgc21hbGwgY2hhbmdlIGFuZCBhdm9pZHMgY29kZSBk
dXBsaWNhdGlvbi4KClJGQzogYmFzZSBUR0wgc3VwcG9ydCBbMV0gaXMgbm90IHlldCBpbiB0aGUg
dHJlZSwgYnV0IEkgd2FudGVkIHRvIGdldApzb21lIGVhcmx5IGNvbW1lbnRzIG9uIHRoaXMgYmVj
YXVzZSBJJ20gbm90IHRvdGFsbHkgY29udmluY2VkIHRoYXQgdGhlCmNvbnZlcnNpb24gaXMgdGhl
IGJlc3Qgd2F5IG9mIGRvaW5nIHRoaXMuIFRoaXMgd2F5IGlmIGFub3RoZXIgYXBwcm9hY2gKaXMg
cHJvcG9zZWQgSSBjYW4gZG8gdGhlIHdvcmsgd2hpbGUgdGhlIGJhc2Ugc3VwcG9ydCBnZXRzIHJl
dmlld2VkLiBJZgp3ZSBzdGljayB3aXRoIHRoZSBjb252ZXJzaW9uIHdlIGNhbiBwcm9iYWJseSBv
cHRpbWl6ZSBhIGJpdC4KVG91Z2h0cz8KClsxXTogaHR0cHM6Ly9wYXRjaHdvcmsuZnJlZWRlc2t0
b3Aub3JnL3Nlcmllcy82MjcyNi8KCkJzcGVjOiA0NTU1NSwgNDYxNDQKU2lnbmVkLW9mZi1ieTog
RGFuaWVsZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5jZXJhb2xvc3B1cmlvQGludGVsLmNvbT4K
Q2M6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogVHZydGtvIFVy
c3VsaW4gPHR2cnRrby51cnN1bGluQGxpbnV4LmludGVsLmNvbT4KQ2M6IE1pa2EgS3VvcHBhbGEg
PG1pa2Eua3VvcHBhbGFAbGludXguaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2xyYy5jIHwgOTMgKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0KIDEgZmls
ZSBjaGFuZ2VkLCA5MSBpbnNlcnRpb25zKCspLCAyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfbHJjLmMKaW5kZXggNDcxZTEzNGRlMTg2Li42MWNmMDE2YjhlMTUgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCkBAIC0xNjQsNiArMTY0LDE1IEBACiAKICNkZWZp
bmUgQ1RYX0RFU0NfRk9SQ0VfUkVTVE9SRSBCSVRfVUxMKDIpCiAKKyNkZWZpbmUgR0VOMTJfQ1RY
X1NUQVRVU19TV0lUQ0hFRF9UT19ORVdfUVVFVUUJKDB4MSkgLyogbG93ZXIgY3NiIGR3b3JkICov
CisjZGVmaW5lIEdFTjEyX0NUWF9TV0lUQ0hfREVUQUlMKGNzYl9kdykJKGNzYl9kdyAmIDB4Rikg
LyogdXBwZXIgY3NiIGR3b3JkICovCisjZGVmaW5lICBHRU4xMl9DVFhfQ09NUExFVEUJCSgweDAp
CisjZGVmaW5lICBHRU4xMl9DVFhfUFJFRU1QVEVECQkoMHg1KQorI2RlZmluZSBHRU4xMl9DU0Jf
Q1RYKGNzYl9kdykJCSgoKGNzYl9kdykgJiBHRU5NQVNLX1VMTCgzMSwgMTUpKSA+PiAxNSkKKyNk
ZWZpbmUgR0VOMTJfQ1RYX1NXX0lEKGN0eCkJCSgoY3R4KSAmIEdFTk1BU0soMTAsIDApKQorI2Rl
ZmluZSBHRU4xMl9DVFhfU1dfQ09VTlRFUihjdHgpCSgoKGN0eCkgJiBHRU5NQVNLKDE2LCAxMSkp
ID4+IDExKQorI2RlZmluZSBHRU4xMl9DVFhfSU5WQUxJRF9JRAkJMHg3RkYKKwogLyogVHlwaWNh
bCBzaXplIG9mIHRoZSBhdmVyYWdlIHJlcXVlc3QgKDIgcGlwZWNvbnRyb2xzIGFuZCBhIE1JX0JC
KSAqLwogI2RlZmluZSBFWEVDTElTVFNfUkVRVUVTVF9TSVpFIDY0IC8qIGJ5dGVzICovCiAjZGVm
aW5lIFdBX1RBSUxfRFdPUkRTIDIKQEAgLTEyNzksNiArMTI4OCw4MCBAQCByZXNldF9pbl9wcm9n
cmVzcyhjb25zdCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqZXhlY2xpc3RzKQogCXJl
dHVybiB1bmxpa2VseSghX190YXNrbGV0X2lzX2VuYWJsZWQoJmV4ZWNsaXN0cy0+dGFza2xldCkp
OwogfQogCisvKgorICogU3RhcnRpbmcgd2l0aCBHZW4xMiwgdGhlIGNzYiBoYXMgYSBuZXcgZm9y
bWF0OgorICoKKyAqIGxvd2VyX2R3OgorICogICBiaXQgIDA6ICAgICBzd2l0Y2hlZCB0byBuZXcg
cXVldWUKKyAqICAgYml0ICAxOiAgICAgcmVzZXJ2ZWQKKyAqICAgYml0cyAzLTU6ICAgZW5naW5l
IGNsYXNzCisgKiAgIGJpdHMgNi0xMTogIGVuZ2luZSBpbnN0YW5jZQorICogICBiaXRzIDEyLTE0
OiByZXNlcnZlZAorICogICBiaXRzIDE1LTI1OiBzdyBjb250ZXh0IGlkIG9mIHRoZSBscmMgd2Un
cmUgc3dpdGNoaW5nIHRvCisgKiAgIGJpdHMgMjYtMzE6IHN3IGNvdW50ZXIgb2YgdGhlIGxyYyB3
ZSdyZSBzd2l0Y2hpbmcgdG8KKyAqCisgKiB1cHBlcl9kdzoKKyAqICAgYml0cyAwLTM6ICAgY29u
dGV4dCBzd2l0Y2ggZGV0YWlsCisgKiAgICAgICAgICAgICAgICAgMDogY3R4IGNvbXBsZXRlCisg
KiAgICAgICAgICAgICAgICAgMTogd2FpdCBvbiBzeW5jIGZsaXAKKyAqICAgICAgICAgICAgICAg
ICAyOiB3YWl0IG9uIHZibGFuaworICogICAgICAgICAgICAgICAgIDM6IHdhaXQgb24gc2Nhbmxp
bmUKKyAqICAgICAgICAgICAgICAgICA0OiB3YWl0IG9uIHNlbWFwaG9yZQorICogICAgICAgICAg
ICAgICAgIDU6IGN0eCBwcmVlbXB0ZWQgKG5vdCBvbiBTRU1BUEhPUkVfV0FJVCBvciBXQUlUX0ZP
Ul9FVkVOVCkKKyAqICAgYml0ICA0OiAgICAgcmVzZXJ2ZWQKKyAqICAgYml0cyA1LTExOiAgd2Fp
dCBkZXRhaWwgKGZvciBzd2l0Y2ggZGV0YWlsIDEgdG8gNCkKKyAqICAgYml0cyAxMi0xNDogcmVz
ZXJ2ZWQKKyAqICAgYml0cyAxNS0yNTogc3cgY29udGV4dCBpZCBvZiB0aGUgbHJjIHdlJ3JlIHN3
aXRjaGluZyBhd2F5IGZyb20KKyAqICAgYml0cyAyNi0zMTogc3cgY291bnRlciBvZiB0aGUgbHJj
IHdlJ3JlIHN3aXRjaGluZyBhd2F5IGZyb20KKyAqCisgKiBUbyBrZWVwIHRoZSBsb2dpYyBzaW1w
bGUsIHdlIGNvbnZlcnQgdGhlIG5ldyBnZW4xMiBmb3JtYXQgdG8gdGhlIGdlbjExCisgKiBmb3Jt
YXQgYW5kIHJlLXVzZSB0aGUgbGVnYWN5IGNzYiBoYW5kbGluZyBsb2dpYy4gVGhlIHVwcGVyIDMy
IGJpdHMgb2YgdGhlCisgKiBsZWdhY3kgc3RhdHVzIHNob3VsZCBiZSBzZXQgdG8gdGhlIHVwcGVy
IDMyIGJpdHMgb2YgdGhlIGRlc2NyaXB0b3Igb2YgdGhlCisgKiBjdHggd2UncmUgc3dpdGNoaW5n
IGF3YXkgZnJvbSwgYnV0IHNpbmNlIHdlIGRvbid0IHVzZSB0aGF0IHZhbHVlIGluIG91cgorICog
bG9naWMgYXQgdGhlIG1vbWVudCB3ZSBza2lwIHRoYXQgc2V0dGluZy4KKyAqLworc3RhdGljIHUz
MgorZ2VuMTJfY29udmVydF9jc2Ioc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLCB1MzIg
bG93ZXJfZHcsIHUzMiB1cHBlcl9kdykKK3sKKwl1MzIgbGVnYWN5X3N0YXR1cyA9IDA7CisJdTMy
IGN0eF90byA9IEdFTjEyX0NTQl9DVFgobG93ZXJfZHcpOworCXUzMiBjdHhfYXdheSA9IEdFTjEy
X0NTQl9DVFgodXBwZXJfZHcpOworCXU4IHN3aXRjaF9kZXRhaWwgPSBHRU4xMl9DVFhfU1dJVENI
X0RFVEFJTCh1cHBlcl9kdyk7CisJYm9vbCBuZXdfcXVldWUgPSBsb3dlcl9kdyAmIEdFTjEyX0NU
WF9TVEFUVVNfU1dJVENIRURfVE9fTkVXX1FVRVVFOworCWJvb2wgY3R4X3RvX3ZhbGlkID0gR0VO
MTJfQ1RYX1NXX0lEKGN0eF90bykgIT0gR0VOMTJfQ1RYX0lOVkFMSURfSUQ7CisJYm9vbCBjdHhf
YXdheV92YWxpZCA9IEdFTjEyX0NUWF9TV19JRChjdHhfYXdheSkgIT0gR0VOMTJfQ1RYX0lOVkFM
SURfSUQ7CisKKwlpZiAoIWN0eF9hd2F5X3ZhbGlkICYmIGN0eF90b192YWxpZCkKKwkJbGVnYWN5
X3N0YXR1cyB8PSBHRU44X0NUWF9TVEFUVVNfSURMRV9BQ1RJVkU7CisKKwkvKgorCSAqIGN0eF9h
d2F5X3ZhbGlkICYmICFjdHhfdG9fdmFsaWQgY2FuIGluZGljYXRlIGVpdGhlciBhIGN0eCBjb21w
bGV0aW9uCisJICogb3IgYSBwcmVlbXB0LXRvLWlkbGUgb2YgYSBydW5uaW5nIGN0eC4gVGhlIDIg
Y2FzZXMgY2FuIGJlCisJICogZGlmZmVyZW50aWF0ZWQgYnkgdGhlIHZhbHVlIG9mIG5ld19xdWV1
ZSwgYnV0IHNpbmNlIHRoZQorCSAqIEdFTjhfQ1RYX1NUQVRVU19BQ1RJVkVfSURMRSBpcyBzZXQg
aW4gYm90aCBzaXR1YXRpb25zIHdlIGRvbid0CisJICogZGlmZmVyZW50aWF0ZSBiZXR3ZWVuIHRo
ZW0gaGVyZS4KKwkgKi8KKwlpZiAoY3R4X2F3YXlfdmFsaWQgJiYgIWN0eF90b192YWxpZCkKKwkJ
bGVnYWN5X3N0YXR1cyB8PSBHRU44X0NUWF9TVEFUVVNfQUNUSVZFX0lETEU7CisKKwlpZiAoKGN0
eF9hd2F5ID09IGN0eF90bykgJiYgY3R4X3RvX3ZhbGlkKQorCQlsZWdhY3lfc3RhdHVzIHw9IEdF
TjhfQ1RYX1NUQVRVU19MSVRFX1JFU1RPUkU7CisKKwlpZiAoKGN0eF9hd2F5ICE9IGN0eF90bykg
JiYgY3R4X2F3YXlfdmFsaWQgJiYgY3R4X3RvX3ZhbGlkICYmICFuZXdfcXVldWUpCisJCWxlZ2Fj
eV9zdGF0dXMgfD0gR0VOOF9DVFhfU1RBVFVTX0VMRU1FTlRfU1dJVENIOworCisJaWYgKChzd2l0
Y2hfZGV0YWlsID09IEdFTjEyX0NUWF9QUkVFTVBURUQpIHx8IChuZXdfcXVldWUgJiYgY3R4X2F3
YXlfdmFsaWQpKQorCQlsZWdhY3lfc3RhdHVzIHw9IEdFTjhfQ1RYX1NUQVRVU19QUkVFTVBURUQ7
CisKKwlpZiAoKHN3aXRjaF9kZXRhaWwgPT0gR0VOMTJfQ1RYX0NPTVBMRVRFKSAmJiBjdHhfYXdh
eV92YWxpZCkKKwkJbGVnYWN5X3N0YXR1cyB8PSBHRU44X0NUWF9TVEFUVVNfQ09NUExFVEU7CisK
KwkvKiBhZGQgb3RoZXIgZXZlbnRzIGFzIHJlcXVpcmVkIChlLmcuIHNlbWFwaG9yZSB3YWl0KSAq
LworCUdFTV9CVUdfT04oIWxlZ2FjeV9zdGF0dXMpOworCisJcmV0dXJuIGxlZ2FjeV9zdGF0dXM7
Cit9CisKIHN0YXRpYyB2b2lkIHByb2Nlc3NfY3NiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKIHsKIAlzdHJ1Y3QgaW50ZWxfZW5naW5lX2V4ZWNsaXN0cyAqIGNvbnN0IGV4ZWNsaXN0
cyA9ICZlbmdpbmUtPmV4ZWNsaXN0czsKQEAgLTEzMTYsNyArMTM5OSw3IEBAIHN0YXRpYyB2b2lk
IHByb2Nlc3NfY3NiKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKIAlybWIoKTsKIAog
CWRvIHsKLQkJdW5zaWduZWQgaW50IHN0YXR1czsKKwkJdTMyIHN0YXR1czsKIAogCQlpZiAoKyto
ZWFkID09IG51bV9lbnRyaWVzKQogCQkJaGVhZCA9IDA7CkBAIC0xMzQzLDcgKzE0MjYsMTMgQEAg
c3RhdGljIHZvaWQgcHJvY2Vzc19jc2Ioc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQog
CQkJICBlbmdpbmUtPm5hbWUsIGhlYWQsCiAJCQkgIGJ1ZlsyICogaGVhZCArIDBdLCBidWZbMiAq
IGhlYWQgKyAxXSk7CiAKLQkJc3RhdHVzID0gYnVmWzIgKiBoZWFkXTsKKwkJaWYgKElOVEVMX0dF
TihlbmdpbmUtPmk5MTUpID49IDEyKQorCQkJc3RhdHVzID0gZ2VuMTJfY29udmVydF9jc2IoZW5n
aW5lLCBidWZbMiAqIGhlYWRdLCBidWZbMiAqIGhlYWQgKyAxXSk7CisJCWVsc2UKKwkJCXN0YXR1
cyA9IGJ1ZlsyICogaGVhZF07CisKKwkJLyogZG9uJ3QgcmVhZCBmcm9tIGJ1ZltdIGFmdGVyIHRo
aXMgcG9pbnQgKi8KKwogCQlpZiAoc3RhdHVzICYgR0VOOF9DVFhfU1RBVFVTX0lETEVfQUNUSVZF
KSB7CiAJCQlHRU1fQlVHX09OKCpleGVjbGlzdHMtPmFjdGl2ZSk7CiBwcm9tb3RlOgotLSAKMi4y
MC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRl
bC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

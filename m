Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B5AA08FD09
	for <lists+intel-gfx@lfdr.de>; Fri, 16 Aug 2019 10:06:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E2B7C6EB22;
	Fri, 16 Aug 2019 08:06:10 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga14.intel.com (mga14.intel.com [192.55.52.115])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 59B036EB1E
 for <intel-gfx@lists.freedesktop.org>; Fri, 16 Aug 2019 08:06:02 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by fmsmga103.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 16 Aug 2019 01:06:02 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,391,1559545200"; d="scan'208";a="184851571"
Received: from miyoungj-mobl1.amr.corp.intel.com (HELO
 ldmartin-desk1.intel.com) ([10.254.105.68])
 by FMSMGA003.fm.intel.com with ESMTP; 16 Aug 2019 01:06:01 -0700
From: Lucas De Marchi <lucas.demarchi@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 16 Aug 2019 01:04:48 -0700
Message-Id: <20190816080503.28594-25-lucas.demarchi@intel.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190816080503.28594-1-lucas.demarchi@intel.com>
References: <20190816080503.28594-1-lucas.demarchi@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 24/39] drm/i915/tgl: move DP_TP_* to transcoder
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

R2VuIDEyIG9ud2FyZHMgbW92ZXMgdGhlIERQX1RQXyogcmVnaXN0ZXJzIHRvIGJlIHRyYW5zY29k
ZXItYmFzZWQgcmF0aGVyCnRoYW4gcG9ydC1iYXNlZC4gVGhpcyBhZGQgdGhlIG5ldyByZWdpc3Rl
ciBhZGRyZXNzIGFuZCBjaGFuZ2VzIHRoZQpmdW5jdGlvbnMgdGhhdCBhcmUgdXNlZCB3aXRoIERE
SSBvbiBnZW4gMTIgdG8gdXNlIHRoZSBuZXcgcmVnaXN0ZXJzLiBPbgpNU1QgdGhlIG1hc3RlciB0
cmFuc2NvZGVyIGlzIHRoZSBvbmUgdG8gYmUgdXNlZC4KCkNjOiBSb2RyaWdvIFZpdmkgPHJvZHJp
Z28udml2aUBpbnRlbC5jb20+CkNjOiBWaWxsZSBTeXJqw6Rsw6QgPHZpbGxlLnN5cmphbGFAbGlu
dXguaW50ZWwuY29tPgpDYzogSm9zw6kgUm9iZXJ0byBkZSBTb3V6YSA8am9zZS5zb3V6YUBpbnRl
bC5jb20+ClNpZ25lZC1vZmYtYnk6IEx1Y2FzIERlIE1hcmNoaSA8bHVjYXMuZGVtYXJjaGlAaW50
ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMgICAg
ICB8IDQyICsrKysrKysrLS0tLQogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90
eXBlcy5oICAgIHwgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5j
ICAgICAgIHwgNjYgKysrKysrKysrKysrKysrKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kcC5oICAgICAgIHwgIDkgKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2RwX21zdC5jICAgfCAyMCArKysrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfcmVnLmggICAgICAgICAgICAgICB8ICA0ICsrCiA2IGZpbGVzIGNoYW5nZWQsIDExOSBpbnNl
cnRpb25zKCspLCAyMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kZGkuYwppbmRleCBjMjZkZWU4NTIxZjYuLjE3ZDQ5Yzc3ZmFhMCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jCkBAIC0zMTM1LDE3ICszMTM1LDIyIEBAIHN0
YXRpYyB2b2lkIGludGVsX2RkaV9lbmFibGVfZmVjKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAogCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIHsK
IAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJh
c2UuZGV2KTsKKwllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRlLT5j
cHVfdHJhbnNjb2RlcjsKIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXItPnBvcnQ7CisJaTkxNV9y
ZWdfdCBjdGwsIHN0YXR1czsKIAl1MzIgdmFsOwogCiAJaWYgKCFjcnRjX3N0YXRlLT5mZWNfZW5h
YmxlKQogCQlyZXR1cm47CiAKLQl2YWwgPSBJOTE1X1JFQUQoRFBfVFBfQ1RMKHBvcnQpKTsKKwlj
dGwgPSBpbnRlbF9kcF90cF9jdGxfcmVnKGRldl9wcml2LCBjcHVfdHJhbnNjb2RlciwgcG9ydCk7
CisJc3RhdHVzID0gaW50ZWxfZHBfdHBfc3RhdHVzX3JlZyhkZXZfcHJpdiwgY3B1X3RyYW5zY29k
ZXIsIHBvcnQpOworCisJdmFsID0gSTkxNV9SRUFEKGN0bCk7CiAJdmFsIHw9IERQX1RQX0NUTF9G
RUNfRU5BQkxFOwotCUk5MTVfV1JJVEUoRFBfVFBfQ1RMKHBvcnQpLCB2YWwpOworCUk5MTVfV1JJ
VEUoY3RsLCB2YWwpOwogCi0JaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+
dW5jb3JlLCBEUF9UUF9TVEFUVVMocG9ydCksCisJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVy
KCZkZXZfcHJpdi0+dW5jb3JlLCBzdGF0dXMsCiAJCQkJICAgIERQX1RQX1NUQVRVU19GRUNfRU5B
QkxFX0xJVkUsCiAJCQkJICAgIERQX1RQX1NUQVRVU19GRUNfRU5BQkxFX0xJVkUsCiAJCQkJICAg
IDEpKQpAQCAtMzE1NiwxNiArMzE2MSwxOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfZGlzYWJs
ZV9mZWNfc3RhdGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJCWNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQogewogCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOworCWVudW0gdHJh
bnNjb2RlciBjcHVfdHJhbnNjb2RlciA9IGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyOwogCWVu
dW0gcG9ydCBwb3J0ID0gZW5jb2Rlci0+cG9ydDsKKwlpOTE1X3JlZ190IGN0bDsKIAl1MzIgdmFs
OwogCiAJaWYgKCFjcnRjX3N0YXRlLT5mZWNfZW5hYmxlKQogCQlyZXR1cm47CiAKLQl2YWwgPSBJ
OTE1X1JFQUQoRFBfVFBfQ1RMKHBvcnQpKTsKKwljdGwgPSBpbnRlbF9kcF90cF9jdGxfcmVnKGRl
dl9wcml2LCBjcHVfdHJhbnNjb2RlciwgcG9ydCk7CisJdmFsID0gSTkxNV9SRUFEKGN0bCk7CiAJ
dmFsICY9IH5EUF9UUF9DVExfRkVDX0VOQUJMRTsKLQlJOTE1X1dSSVRFKERQX1RQX0NUTChwb3J0
KSwgdmFsKTsKLQlQT1NUSU5HX1JFQUQoRFBfVFBfQ1RMKHBvcnQpKTsKKwlJOTE1X1dSSVRFKGN0
bCwgdmFsKTsKKwlQT1NUSU5HX1JFQUQoY3RsKTsKIH0KIAogc3RhdGljIHZvaWQgaW50ZWxfZGRp
X3ByZV9lbmFibGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCkBAIC0zMzI3LDcg
KzMzMzUsOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX2RkaV9idWYoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19p
OTE1KGVuY29kZXItPmJhc2UuZGV2KTsKKwllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIg
PSBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKIAllbnVtIHBvcnQgcG9ydCA9IGVuY29kZXIt
PnBvcnQ7CisJaTkxNV9yZWdfdCBjdGw7CiAJYm9vbCB3YWl0ID0gZmFsc2U7CiAJdTMyIHZhbDsK
IApAQCAtMzMzOCwxMCArMzM0OCwxMSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX2RkaV9i
dWYoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCXdhaXQgPSB0cnVlOwogCX0KIAot
CXZhbCA9IEk5MTVfUkVBRChEUF9UUF9DVEwocG9ydCkpOworCWN0bCA9IGludGVsX2RwX3RwX2N0
bF9yZWcoZGV2X3ByaXYsIGNwdV90cmFuc2NvZGVyLCBwb3J0KTsKKwl2YWwgPSBJOTE1X1JFQUQo
Y3RsKTsKIAl2YWwgJj0gfihEUF9UUF9DVExfRU5BQkxFIHwgRFBfVFBfQ1RMX0xJTktfVFJBSU5f
TUFTSyk7CiAJdmFsIHw9IERQX1RQX0NUTF9MSU5LX1RSQUlOX1BBVDE7Ci0JSTkxNV9XUklURShE
UF9UUF9DVEwocG9ydCksIHZhbCk7CisJSTkxNV9XUklURShjdGwsIHZhbCk7CiAKIAkvKiBEaXNh
YmxlIEZFQyBpbiBEUCBTaW5rICovCiAJaW50ZWxfZGRpX2Rpc2FibGVfZmVjX3N0YXRlKGVuY29k
ZXIsIGNydGNfc3RhdGUpOwpAQCAtMzc2NiwxMCArMzc3NywxMyBAQCBzdGF0aWMgdm9pZCBpbnRl
bF9kZGlfcHJlcGFyZV9saW5rX3JldHJhaW4oc3RydWN0IGludGVsX2RwICppbnRlbF9kcCkKIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQogCQl0b19pOTE1KGludGVsX2RpZ19w
b3J0LT5iYXNlLmJhc2UuZGV2KTsKIAllbnVtIHBvcnQgcG9ydCA9IGludGVsX2RpZ19wb3J0LT5i
YXNlLnBvcnQ7CisJaTkxNV9yZWdfdCBjdGw7CiAJdTMyIHZhbDsKIAlib29sIHdhaXQgPSBmYWxz
ZTsKKwllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBpbnRlbF9kcF9nZXRfdHJhbnNj
b2RlcihpbnRlbF9kcCk7CiAKLQlpZiAoSTkxNV9SRUFEKERQX1RQX0NUTChwb3J0KSkgJiBEUF9U
UF9DVExfRU5BQkxFKSB7CisJY3RsID0gaW50ZWxfZHBfdHBfY3RsX3JlZyhkZXZfcHJpdiwgY3B1
X3RyYW5zY29kZXIsIHBvcnQpOworCWlmIChJOTE1X1JFQUQoY3RsKSAmIERQX1RQX0NUTF9FTkFC
TEUpIHsKIAkJdmFsID0gSTkxNV9SRUFEKERESV9CVUZfQ1RMKHBvcnQpKTsKIAkJaWYgKHZhbCAm
IERESV9CVUZfQ1RMX0VOQUJMRSkgewogCQkJdmFsICY9IH5ERElfQlVGX0NUTF9FTkFCTEU7CkBA
IC0zNzc3LDExICszNzkxLDExIEBAIHN0YXRpYyB2b2lkIGludGVsX2RkaV9wcmVwYXJlX2xpbmtf
cmV0cmFpbihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwKQogCQkJd2FpdCA9IHRydWU7CiAJCX0K
IAotCQl2YWwgPSBJOTE1X1JFQUQoRFBfVFBfQ1RMKHBvcnQpKTsKKwkJdmFsID0gSTkxNV9SRUFE
KGN0bCk7CiAJCXZhbCAmPSB+KERQX1RQX0NUTF9FTkFCTEUgfCBEUF9UUF9DVExfTElOS19UUkFJ
Tl9NQVNLKTsKIAkJdmFsIHw9IERQX1RQX0NUTF9MSU5LX1RSQUlOX1BBVDE7Ci0JCUk5MTVfV1JJ
VEUoRFBfVFBfQ1RMKHBvcnQpLCB2YWwpOwotCQlQT1NUSU5HX1JFQUQoRFBfVFBfQ1RMKHBvcnQp
KTsKKwkJSTkxNV9XUklURShjdGwsIHZhbCk7CisJCVBPU1RJTkdfUkVBRChjdGwpOwogCiAJCWlm
ICh3YWl0KQogCQkJaW50ZWxfd2FpdF9kZGlfYnVmX2lkbGUoZGV2X3ByaXYsIHBvcnQpOwpAQCAt
Mzc5Niw4ICszODEwLDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX3ByZXBhcmVfbGlua19yZXRy
YWluKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCiAJCWlmIChkcm1fZHBfZW5oYW5jZWRfZnJh
bWVfY2FwKGludGVsX2RwLT5kcGNkKSkKIAkJCXZhbCB8PSBEUF9UUF9DVExfRU5IQU5DRURfRlJB
TUVfRU5BQkxFOwogCX0KLQlJOTE1X1dSSVRFKERQX1RQX0NUTChwb3J0KSwgdmFsKTsKLQlQT1NU
SU5HX1JFQUQoRFBfVFBfQ1RMKHBvcnQpKTsKKwlJOTE1X1dSSVRFKGN0bCwgdmFsKTsKKwlQT1NU
SU5HX1JFQUQoY3RsKTsKIAogCWludGVsX2RwLT5EUCB8PSBERElfQlVGX0NUTF9FTkFCTEU7CiAJ
STkxNV9XUklURShERElfQlVGX0NUTChwb3J0KSwgaW50ZWxfZHAtPkRQKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKaW5kZXggNTRk
MTA1M2ZmNmQwLi5jYWY1ZTJiNTBjMGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCkBAIC0xMjEzLDYgKzEyMTMsNyBAQCBzdHJ1
Y3QgaW50ZWxfZHAgewogCWJvb2wgY2FuX21zdDsgLyogdGhpcyBwb3J0IHN1cHBvcnRzIG1zdCAq
LwogCWJvb2wgaXNfbXN0OwogCWludCBhY3RpdmVfbXN0X2xpbmtzOworCWVudW0gdHJhbnNjb2Rl
ciBtc3RfbWFzdGVyX3RyYW5zOyAvKiBPbmx5IHZhbGlkIG9uIFRHTCsgKi8KIAkvKiBjb25uZWN0
b3IgZGlyZWN0bHkgYXR0YWNoZWQgLSB3b24ndCBiZSB1c2UgZm9yIG1vZGVzZXQgaW4gbXN0IHdv
cmxkICovCiAJc3RydWN0IGludGVsX2Nvbm5lY3RvciAqYXR0YWNoZWRfY29ubmVjdG9yOwogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMKaW5kZXggNDg4NGM4N2M4ZWQ3Li5l
YmZjZjE4M2M3ZjEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50
ZWxfZHAuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmMKQEAg
LTMyMDYsNiArMzIwNiw1MSBAQCBzdGF0aWMgdm9pZCBjaHZfcG9zdF9kaXNhYmxlX2RwKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCXZsdl9kcGlvX3B1dChkZXZfcHJpdik7CiB9CiAK
K2k5MTVfcmVnX3QgaW50ZWxfZHBfdHBfY3RsX3JlZyhjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCisJCQkgICAgICAgZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVy
LAorCQkJICAgICAgIGVudW0gcG9ydCBwb3J0KQoreworCWlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDEyKSB7CisJCVdBUk5fT04oY3B1X3RyYW5zY29kZXIgPT0gVFJBTlNDT0RFUl9JTlZBTElE
KTsKKwkJcmV0dXJuIFRHTF9EUF9UUF9DVEwoY3B1X3RyYW5zY29kZXIpOworCX0gZWxzZSB7CisJ
CXJldHVybiBEUF9UUF9DVEwocG9ydCk7CisJfQorfQorCitpOTE1X3JlZ190IGludGVsX2RwX3Rw
X3N0YXR1c19yZWcoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJ
CSAgZW51bSB0cmFuc2NvZGVyIGNwdV90cmFuc2NvZGVyLAorCQkJCSAgZW51bSBwb3J0IHBvcnQp
Cit7CisJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTIpIHsKKwkJV0FSTl9PTihjcHVfdHJh
bnNjb2RlciA9PSBUUkFOU0NPREVSX0lOVkFMSUQpOworCQlyZXR1cm4gVEdMX0RQX1RQX1NUQVRV
UyhjcHVfdHJhbnNjb2Rlcik7CisJfSBlbHNlIHsKKwkJcmV0dXJuIERQX1RQX1NUQVRVUyhwb3J0
KTsKKwl9Cit9CisKKy8qCisgKiBSZXR1cm4gdGhlIHRyYW5zY29kZXIgdGhhdCB0aGlzIGludGVs
X2RwIHBvcnQgaXMgZHJpdmVuLgorICogV2hlbiBpbiBNU1QgbW9kZSBpdCB3aWxsIHJldHVybiB0
aGUgbWFzdGVyIHRyYW5zY29kZXIgb2YgdGhlIE1TVCBzbyBkbyBub3QKKyAqIHVzZSBpdCB3aGVu
IHJlYWRpbmcgb3Igd3JpdGluZyByZWdpc3RlcnMgaW4gdGhlIHNsYXZlIHRyYW5zY29kZXJzLgor
ICovCitlbnVtIHRyYW5zY29kZXIgaW50ZWxfZHBfZ2V0X3RyYW5zY29kZXIoc3RydWN0IGludGVs
X2RwICppbnRlbF9kcCkKK3sKKwlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3I7CisJ
c3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGU7CisJc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGU7CisKKwlpZiAoaW50ZWxfZHAtPmlzX21zdCkKKwkJcmV0dXJu
IGludGVsX2RwLT5tc3RfbWFzdGVyX3RyYW5zOworCisJY29ubmVjdG9yID0gaW50ZWxfZHAtPmF0
dGFjaGVkX2Nvbm5lY3RvcjsKKwljb25uX3N0YXRlID0gY29ubmVjdG9yLT5iYXNlLnN0YXRlOwor
CWNydGNfc3RhdGUgPSB0b19pbnRlbF9jcnRjX3N0YXRlKGNvbm5fc3RhdGUtPmNydGMtPnN0YXRl
KTsKKworCXJldHVybiBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcjsKK30KKwogc3RhdGljIHZv
aWQKIF9pbnRlbF9kcF9zZXRfbGlua190cmFpbihzdHJ1Y3QgaW50ZWxfZHAgKmludGVsX2RwLAog
CQkJIHUzMiAqRFAsCkBAIC0zMjIxLDggKzMyNjYsMTMgQEAgX2ludGVsX2RwX3NldF9saW5rX3Ry
YWluKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAsCiAJCQkgICAgICBkcF90cmFpbl9wYXQgJiB0
cmFpbl9wYXRfbWFzayk7CiAKIAlpZiAoSEFTX0RESShkZXZfcHJpdikpIHsKLQkJdTMyIHRlbXAg
PSBJOTE1X1JFQUQoRFBfVFBfQ1RMKHBvcnQpKTsKKwkJZW51bSB0cmFuc2NvZGVyIGNwdV90cmFu
c2NvZGVyOworCQlpOTE1X3JlZ190IGN0bDsKKwkJdTMyIHRlbXA7CiAKKwkJY3B1X3RyYW5zY29k
ZXIgPSBpbnRlbF9kcF9nZXRfdHJhbnNjb2RlcihpbnRlbF9kcCk7CisJCWN0bCA9IGludGVsX2Rw
X3RwX2N0bF9yZWcoZGV2X3ByaXYsIGNwdV90cmFuc2NvZGVyLCBwb3J0KTsKKwkJdGVtcCA9IEk5
MTVfUkVBRChjdGwpOwogCQlpZiAoZHBfdHJhaW5fcGF0ICYgRFBfTElOS19TQ1JBTUJMSU5HX0RJ
U0FCTEUpCiAJCQl0ZW1wIHw9IERQX1RQX0NUTF9TQ1JBTUJMRV9ESVNBQkxFOwogCQllbHNlCkBA
IC0zMjQ3LDcgKzMyOTcsNyBAQCBfaW50ZWxfZHBfc2V0X2xpbmtfdHJhaW4oc3RydWN0IGludGVs
X2RwICppbnRlbF9kcCwKIAkJCXRlbXAgfD0gRFBfVFBfQ1RMX0xJTktfVFJBSU5fUEFUNDsKIAkJ
CWJyZWFrOwogCQl9Ci0JCUk5MTVfV1JJVEUoRFBfVFBfQ1RMKHBvcnQpLCB0ZW1wKTsKKwkJSTkx
NV9XUklURShjdGwsIHRlbXApOwogCiAJfSBlbHNlIGlmICgoSVNfSVZZQlJJREdFKGRldl9wcml2
KSAmJiBwb3J0ID09IFBPUlRfQSkgfHwKIAkJICAgKEhBU19QQ0hfQ1BUKGRldl9wcml2KSAmJiBw
b3J0ICE9IFBPUlRfQSkpIHsKQEAgLTM5NDAsMTUgKzM5OTAsMjEgQEAgdm9pZCBpbnRlbF9kcF9z
ZXRfaWRsZV9saW5rX3RyYWluKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApCiAJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gZHBfdG9faTkxNShpbnRlbF9kcCk7CiAJc3RydWN0
IGludGVsX2RpZ2l0YWxfcG9ydCAqaW50ZWxfZGlnX3BvcnQgPSBkcF90b19kaWdfcG9ydChpbnRl
bF9kcCk7CiAJZW51bSBwb3J0IHBvcnQgPSBpbnRlbF9kaWdfcG9ydC0+YmFzZS5wb3J0OworCWVu
dW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlcjsKKwlpOTE1X3JlZ190IGN0bCwgc3RhdHVzOwog
CXUzMiB2YWw7CiAKIAlpZiAoIUhBU19EREkoZGV2X3ByaXYpKQogCQlyZXR1cm47CiAKLQl2YWwg
PSBJOTE1X1JFQUQoRFBfVFBfQ1RMKHBvcnQpKTsKKwljcHVfdHJhbnNjb2RlciA9IGludGVsX2Rw
X2dldF90cmFuc2NvZGVyKGludGVsX2RwKTsKKwljdGwgPSBpbnRlbF9kcF90cF9jdGxfcmVnKGRl
dl9wcml2LCBjcHVfdHJhbnNjb2RlciwgcG9ydCk7CisJc3RhdHVzID0gaW50ZWxfZHBfdHBfc3Rh
dHVzX3JlZyhkZXZfcHJpdiwgY3B1X3RyYW5zY29kZXIsIHBvcnQpOworCisJdmFsID0gSTkxNV9S
RUFEKGN0bCk7CiAJdmFsICY9IH5EUF9UUF9DVExfTElOS19UUkFJTl9NQVNLOwogCXZhbCB8PSBE
UF9UUF9DVExfTElOS19UUkFJTl9JRExFOwotCUk5MTVfV1JJVEUoRFBfVFBfQ1RMKHBvcnQpLCB2
YWwpOworCUk5MTVfV1JJVEUoY3RsLCB2YWwpOwogCiAJLyoKIAkgKiBPbiBQT1JUX0Egd2UgY2Fu
IGhhdmUgb25seSBlRFAgaW4gU1NUIG1vZGUuIFRoZXJlIHRoZSBvbmx5IHJlYXNvbgpAQCAtMzk2
MCw3ICs0MDE2LDcgQEAgdm9pZCBpbnRlbF9kcF9zZXRfaWRsZV9saW5rX3RyYWluKHN0cnVjdCBp
bnRlbF9kcCAqaW50ZWxfZHApCiAJaWYgKHBvcnQgPT0gUE9SVF9BKQogCQlyZXR1cm47CiAKLQlp
ZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsIERQX1RQX1NUQVRV
Uyhwb3J0KSwKKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUs
IHN0YXR1cywKIAkJCQkgICAgRFBfVFBfU1RBVFVTX0lETEVfRE9ORSwKIAkJCQkgICAgRFBfVFBf
U1RBVFVTX0lETEVfRE9ORSwKIAkJCQkgICAgMSkpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2RwLmgKaW5kZXggNjU3YmJiMWY1ZWQwLi4xMDcxMjliNWQ5YTMgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuaAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwLmgKQEAgLTExLDYgKzExLDcgQEAKICNpbmNsdWRl
IDxkcm0vaTkxNV9kcm0uaD4KIAogI2luY2x1ZGUgImk5MTVfcmVnLmgiCisjaW5jbHVkZSAiaW50
ZWxfZGlzcGxheS5oIgogCiBlbnVtIHBpcGU7CiBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZTsK
QEAgLTExMyw2ICsxMTQsMTQgQEAgaW50IGludGVsX2RwX2xpbmtfcmVxdWlyZWQoaW50IHBpeGVs
X2Nsb2NrLCBpbnQgYnBwKTsKIGludCBpbnRlbF9kcF9tYXhfZGF0YV9yYXRlKGludCBtYXhfbGlu
a19jbG9jaywgaW50IG1heF9sYW5lcyk7CiBib29sIGludGVsX2RpZ2l0YWxfcG9ydF9jb25uZWN0
ZWQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpOwogCitpOTE1X3JlZ190IGludGVsX2Rw
X3RwX2N0bF9yZWcoY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJ
ICAgICAgIGVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlciwKKwkJCSAgICAgICBlbnVtIHBv
cnQgcG9ydCk7CitpOTE1X3JlZ190IGludGVsX2RwX3RwX3N0YXR1c19yZWcoY29uc3Qgc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAgZW51bSB0cmFuc2NvZGVyIGNwdV90
cmFuc2NvZGVyLAorCQkJCSAgZW51bSBwb3J0IHBvcnQpOworZW51bSB0cmFuc2NvZGVyIGludGVs
X2RwX2dldF90cmFuc2NvZGVyKHN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHApOworCiBzdGF0aWMg
aW5saW5lIHVuc2lnbmVkIGludCBpbnRlbF9kcF91bnVzZWRfbGFuZV9tYXNrKGludCBsYW5lX2Nv
dW50KQogewogCXJldHVybiB+KCgxIDw8IGxhbmVfY291bnQpIC0gMSkgJiAweGY7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RwX21zdC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9tc3QuYwppbmRleCA3NWM5ZGI4NWYyYjAu
LjdjMTRjMzQ5ZjY2NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9kcF9tc3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rw
X21zdC5jCkBAIC0zNTQsOSArMzU0LDExIEBAIHN0YXRpYyB2b2lkIGludGVsX21zdF9wcmVfcGxs
X2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlzdHJ1Y3QgaW50ZWxf
ZGlnaXRhbF9wb3J0ICppbnRlbF9kaWdfcG9ydCA9IGludGVsX21zdC0+cHJpbWFyeTsKIAlzdHJ1
Y3QgaW50ZWxfZHAgKmludGVsX2RwID0gJmludGVsX2RpZ19wb3J0LT5kcDsKIAotCWlmIChpbnRl
bF9kcC0+YWN0aXZlX21zdF9saW5rcyA9PSAwKQorCWlmIChpbnRlbF9kcC0+YWN0aXZlX21zdF9s
aW5rcyA9PSAwKSB7CisJCWludGVsX2RwLT5tc3RfbWFzdGVyX3RyYW5zID0gcGlwZV9jb25maWct
Pm1zdF9tYXN0ZXJfdHJhbnM7CiAJCWludGVsX2RpZ19wb3J0LT5iYXNlLnByZV9wbGxfZW5hYmxl
KCZpbnRlbF9kaWdfcG9ydC0+YmFzZSwKIAkJCQkJCSAgICBwaXBlX2NvbmZpZywgTlVMTCk7CisJ
fQogfQogCiBzdGF0aWMgdm9pZCBpbnRlbF9tc3RfcG9zdF9wbGxfZGlzYWJsZV9kcChzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKQEAgLTM4NCw2ICszODYsNyBAQCBzdGF0aWMgdm9pZCBp
bnRlbF9tc3RfcHJlX2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAll
bnVtIHBvcnQgcG9ydCA9IGludGVsX2RpZ19wb3J0LT5iYXNlLnBvcnQ7CiAJc3RydWN0IGludGVs
X2Nvbm5lY3RvciAqY29ubmVjdG9yID0KIAkJdG9faW50ZWxfY29ubmVjdG9yKGNvbm5fc3RhdGUt
PmNvbm5lY3Rvcik7CisJaTkxNV9yZWdfdCBzdGF0dXM7CiAJaW50IHJldDsKIAl1MzIgdGVtcDsK
IApAQCAtNDEyLDggKzQxNSwxMiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tc3RfcHJlX2VuYWJsZV9k
cChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJRFJNX0VSUk9SKCJmYWlsZWQgdG8g
YWxsb2NhdGUgdmNwaVxuIik7CiAKIAlpbnRlbF9kcC0+YWN0aXZlX21zdF9saW5rcysrOwotCXRl
bXAgPSBJOTE1X1JFQUQoRFBfVFBfU1RBVFVTKHBvcnQpKTsKLQlJOTE1X1dSSVRFKERQX1RQX1NU
QVRVUyhwb3J0KSwgdGVtcCk7CisKKwlzdGF0dXMgPSBpbnRlbF9kcF90cF9zdGF0dXNfcmVnKGRl
dl9wcml2LAorCQkJCQlwaXBlX2NvbmZpZy0+bXN0X21hc3Rlcl90cmFucywKKwkJCQkJcG9ydCk7
CisJdGVtcCA9IEk5MTVfUkVBRChzdGF0dXMpOworCUk5MTVfV1JJVEUoc3RhdHVzLCB0ZW1wKTsK
IAogCXJldCA9IGRybV9kcF91cGRhdGVfcGF5bG9hZF9wYXJ0MSgmaW50ZWxfZHAtPm1zdF9tZ3Ip
OwogCkBAIC00MjksMTEgKzQzNiwxNiBAQCBzdGF0aWMgdm9pZCBpbnRlbF9tc3RfZW5hYmxlX2Rw
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxf
ZHAgPSAmaW50ZWxfZGlnX3BvcnQtPmRwOwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOwogCWVudW0gcG9ydCBwb3J0ID0gaW50
ZWxfZGlnX3BvcnQtPmJhc2UucG9ydDsKKwlpOTE1X3JlZ190IHN0YXR1czsKIAogCURSTV9ERUJV
R19LTVMoImFjdGl2ZSBsaW5rcyAlZFxuIiwgaW50ZWxfZHAtPmFjdGl2ZV9tc3RfbGlua3MpOwog
CisJc3RhdHVzID0gaW50ZWxfZHBfdHBfc3RhdHVzX3JlZyhkZXZfcHJpdiwKKwkJCQkJcGlwZV9j
b25maWctPm1zdF9tYXN0ZXJfdHJhbnMsCisJCQkJCXBvcnQpOworCiAJaWYgKGludGVsX3dhaXRf
Zm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAotCQkJCSAgICBEUF9UUF9TVEFUVVMocG9y
dCksCisJCQkJICAgIHN0YXR1cywKIAkJCQkgICAgRFBfVFBfU1RBVFVTX0FDVF9TRU5ULAogCQkJ
CSAgICBEUF9UUF9TVEFUVVNfQUNUX1NFTlQsCiAJCQkJICAgIDEpKQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cmVnLmgKaW5kZXggYTY0YjFjNGNkN2JmLi5lY2E4Mjk1YWJhOWUgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9yZWcuaApAQCAtOTUxNyw3ICs5NTE3LDkgQEAgZW51bSBza2xfcG93ZXJfZ2F0ZSB7CiAvKiBE
aXNwbGF5UG9ydCBUcmFuc3BvcnQgQ29udHJvbCAqLwogI2RlZmluZSBfRFBfVFBfQ1RMX0EJCQkw
eDY0MDQwCiAjZGVmaW5lIF9EUF9UUF9DVExfQgkJCTB4NjQxNDAKKyNkZWZpbmUgX1RHTF9EUF9U
UF9DVExfQQkJMHg2MDU0MAogI2RlZmluZSBEUF9UUF9DVEwocG9ydCkgX01NSU9fUE9SVChwb3J0
LCBfRFBfVFBfQ1RMX0EsIF9EUF9UUF9DVExfQikKKyNkZWZpbmUgVEdMX0RQX1RQX0NUTCh0cmFu
KSBfTU1JT19UUkFOUzIoKHRyYW4pLCBfVEdMX0RQX1RQX0NUTF9BKQogI2RlZmluZSAgRFBfVFBf
Q1RMX0VOQUJMRQkJCSgxIDw8IDMxKQogI2RlZmluZSAgRFBfVFBfQ1RMX0ZFQ19FTkFCTEUJCQko
MSA8PCAzMCkKICNkZWZpbmUgIERQX1RQX0NUTF9NT0RFX1NTVAkJCSgwIDw8IDI3KQpAQCAtOTUz
Nyw3ICs5NTM5LDkgQEAgZW51bSBza2xfcG93ZXJfZ2F0ZSB7CiAvKiBEaXNwbGF5UG9ydCBUcmFu
c3BvcnQgU3RhdHVzICovCiAjZGVmaW5lIF9EUF9UUF9TVEFUVVNfQQkJCTB4NjQwNDQKICNkZWZp
bmUgX0RQX1RQX1NUQVRVU19CCQkJMHg2NDE0NAorI2RlZmluZSBfVEdMX0RQX1RQX1NUQVRVU19B
CQkweDYwNTQ0CiAjZGVmaW5lIERQX1RQX1NUQVRVUyhwb3J0KSBfTU1JT19QT1JUKHBvcnQsIF9E
UF9UUF9TVEFUVVNfQSwgX0RQX1RQX1NUQVRVU19CKQorI2RlZmluZSBUR0xfRFBfVFBfU1RBVFVT
KHRyYW4pIF9NTUlPX1RSQU5TMigodHJhbiksIF9UR0xfRFBfVFBfU1RBVFVTX0EpCiAjZGVmaW5l
ICBEUF9UUF9TVEFUVVNfRkVDX0VOQUJMRV9MSVZFCQkoMSA8PCAyOCkKICNkZWZpbmUgIERQX1RQ
X1NUQVRVU19JRExFX0RPTkUJCQkoMSA8PCAyNSkKICNkZWZpbmUgIERQX1RQX1NUQVRVU19BQ1Rf
U0VOVAkJCSgxIDw8IDI0KQotLSAKMi4yMS4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0
cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9s
aXN0aW5mby9pbnRlbC1nZng=

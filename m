Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B33FF3AD64
	for <lists+intel-gfx@lfdr.de>; Mon, 10 Jun 2019 05:04:31 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B8CE888E88;
	Mon, 10 Jun 2019 03:04:28 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A95B588E88
 for <intel-gfx@lists.freedesktop.org>; Mon, 10 Jun 2019 03:04:26 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 16847192-1500050 
 for multiple; Mon, 10 Jun 2019 04:04:17 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Mon, 10 Jun 2019 04:04:13 +0100
Message-Id: <20190610030416.4471-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 1/4] drm/i915: Move fence register tracking from
 i915->mm to ggtt
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXMgdGhlIGZlbmNlIHJlZ2lzdGVycyBvbmx5IGFwcGx5IHRvIHJlZ2lvbnMgaW5zaWRlIHRoZSBH
R1RUIGlzIG1ha2VzCm1vcmUgc2Vuc2UgdGhhdCB3ZSB0cmFjayB0aGVzZSBhcyBwYXJ0IG9mIHRo
ZSBpOTE1X2dndHQgYW5kIG5vdCB0aGUKZ2VuZXJhbCBtbS4gSW4gdGhlIG5leHQgcGF0Y2gsIHdl
IHdpbGwgdGhlbiBwdWxsIHRoZSByZWdpc3RlciBsb2NraW5nCnVuZGVybmVhdGggdGhlIGk5MTVf
Z2d0dC5tdXRleC4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2ls
c29uLmNvLnVrPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMg
IHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jICAgIHwgIDIg
Ky0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX3Jlc2V0LmMgICAgIHwgIDYgKy0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9hcGVydHVyZV9nbS5jICAgIHwgIDcgKy0KIGRyaXZlcnMv
Z3B1L2RybS9pOTE1L2d2dC9ndnQuaCAgICAgICAgICAgIHwgIDQgKy0KIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZGVidWdmcy5jICAgICAgIHwgNDIgKysrKystLS0tLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZHJ2LmMgICAgICAgICAgIHwgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZHJ2LmggICAgICAgICAgIHwgMjggLS0tLS0tLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2k5MTVfZ2VtLmMgICAgICAgICAgIHwgNTIgKysrLS0tLS0tLS0tLS0KIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5jIHwgODUgKysrKysrKysrKysrKysrKystLS0t
LS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5oIHwgMTkgKysrKy0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jICAgICAgIHwgIDIgKwogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmggICAgICAgfCAxNCArKystCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jICAgICB8ICA2ICstCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3ZtYS5oICAgICAgICAgICB8ICAyICstCiAxNSBmaWxlcyBjaGFuZ2VkLCAxNDQg
aW5zZXJ0aW9ucygrKSwgMTMyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fbW1hbi5jCmluZGV4IGM3YjliMzRkZTAxYi4uYThiOGI5YzI4MWYxIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fbW1hbi5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9tbWFuLmMKQEAgLTMxMCw5ICszMTAsOSBAQCB2
bV9mYXVsdF90IGk5MTVfZ2VtX2ZhdWx0KHN0cnVjdCB2bV9mYXVsdCAqdm1mKQogCS8qIE1hcmsg
YXMgYmVpbmcgbW1hcHBlZCBpbnRvIHVzZXJzcGFjZSBmb3IgbGF0ZXIgcmV2b2NhdGlvbiAqLwog
CWFzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChpOTE1KTsKIAlpZiAoIWk5MTVfdm1hX3NldF91c2Vy
ZmF1bHQodm1hKSAmJiAhb2JqLT51c2VyZmF1bHRfY291bnQrKykKLQkJbGlzdF9hZGQoJm9iai0+
dXNlcmZhdWx0X2xpbmssICZpOTE1LT5tbS51c2VyZmF1bHRfbGlzdCk7CisJCWxpc3RfYWRkKCZv
YmotPnVzZXJmYXVsdF9saW5rLCAmaTkxNS0+Z2d0dC51c2VyZmF1bHRfbGlzdCk7CiAJaWYgKENP
TkZJR19EUk1fSTkxNV9VU0VSRkFVTFRfQVVUT1NVU1BFTkQpCi0JCWludGVsX3dha2VyZWZfYXV0
bygmaTkxNS0+bW0udXNlcmZhdWx0X3dha2VyZWYsCisJCWludGVsX3dha2VyZWZfYXV0bygmaTkx
NS0+Z2d0dC51c2VyZmF1bHRfd2FrZXJlZiwKIAkJCQkgICBtc2Vjc190b19qaWZmaWVzX3RpbWVv
dXQoQ09ORklHX0RSTV9JOTE1X1VTRVJGQVVMVF9BVVRPU1VTUEVORCkpOwogCUdFTV9CVUdfT04o
IW9iai0+dXNlcmZhdWx0X2NvdW50KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
cG0uYwppbmRleCBmNDBmMTNjMGI4YjcuLjZkNjA2NGZiMmJmNSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKQEAgLTEyNiw3ICsxMjYsNyBAQCB2b2lkIGk5MTVfZ2VtX3N1
c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJR0VNX1RSQUNFKCJcbiIp
OwogCi0JaW50ZWxfd2FrZXJlZl9hdXRvKCZpOTE1LT5tbS51c2VyZmF1bHRfd2FrZXJlZiwgMCk7
CisJaW50ZWxfd2FrZXJlZl9hdXRvKCZpOTE1LT5nZ3R0LnVzZXJmYXVsdF93YWtlcmVmLCAwKTsK
IAlmbHVzaF93b3JrcXVldWUoaTkxNS0+d3EpOwogCiAJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9y
ZXNldC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfcmVzZXQuYwppbmRleCBhNmVj
ZmRjNzM1YzQuLjFlOTNjZjZlZWRlNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfcmVzZXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9yZXNl
dC5jCkBAIC02OTUsMTkgKzY5NSwxOSBAQCBzdGF0aWMgdm9pZCByZXZva2VfbW1hcHMoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJaW50IGk7CiAKLQlmb3IgKGkgPSAwOyBpIDwg
aTkxNS0+bnVtX2ZlbmNlX3JlZ3M7IGkrKykgeworCWZvciAoaSA9IDA7IGkgPCBpOTE1LT5nZ3R0
Lm51bV9mZW5jZXM7IGkrKykgewogCQlzdHJ1Y3QgZHJtX3ZtYV9vZmZzZXRfbm9kZSAqbm9kZTsK
IAkJc3RydWN0IGk5MTVfdm1hICp2bWE7CiAJCXU2NCB2bWFfb2Zmc2V0OwogCi0JCXZtYSA9IFJF
QURfT05DRShpOTE1LT5mZW5jZV9yZWdzW2ldLnZtYSk7CisJCXZtYSA9IFJFQURfT05DRShpOTE1
LT5nZ3R0LmZlbmNlX3JlZ3NbaV0udm1hKTsKIAkJaWYgKCF2bWEpCiAJCQljb250aW51ZTsKIAog
CQlpZiAoIWk5MTVfdm1hX2hhc191c2VyZmF1bHQodm1hKSkKIAkJCWNvbnRpbnVlOwogCi0JCUdF
TV9CVUdfT04odm1hLT5mZW5jZSAhPSAmaTkxNS0+ZmVuY2VfcmVnc1tpXSk7CisJCUdFTV9CVUdf
T04odm1hLT5mZW5jZSAhPSAmaTkxNS0+Z2d0dC5mZW5jZV9yZWdzW2ldKTsKIAkJbm9kZSA9ICZ2
bWEtPm9iai0+YmFzZS52bWFfbm9kZTsKIAkJdm1hX29mZnNldCA9IHZtYS0+Z2d0dF92aWV3LnBh
cnRpYWwub2Zmc2V0IDw8IFBBR0VfU0hJRlQ7CiAJCXVubWFwX21hcHBpbmdfcmFuZ2UoaTkxNS0+
ZHJtLmFub25faW5vZGUtPmlfbWFwcGluZywKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9hcGVydHVyZV9nbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2FwZXJ0dXJl
X2dtLmMKaW5kZXggMWZhMmY2NWMzY2QxLi40MDk4OTAyYmZhZWIgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2d2dC9hcGVydHVyZV9nbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9hcGVydHVyZV9nbS5jCkBAIC0zNSw2ICszNSw3IEBACiAgKi8KIAogI2luY2x1ZGUg
Imk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaTkxNV9nZW1fZmVuY2VfcmVnLmgiCiAjaW5jbHVkZSAi
Z3Z0LmgiCiAKIHN0YXRpYyBpbnQgYWxsb2NfZ20oc3RydWN0IGludGVsX3ZncHUgKnZncHUsIGJv
b2wgaGlnaF9nbSkKQEAgLTEyOCw3ICsxMjksNyBAQCB2b2lkIGludGVsX3ZncHVfd3JpdGVfZmVu
Y2Uoc3RydWN0IGludGVsX3ZncHUgKnZncHUsCiB7CiAJc3RydWN0IGludGVsX2d2dCAqZ3Z0ID0g
dmdwdS0+Z3Z0OwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IGd2dC0+ZGV2
X3ByaXY7Ci0Jc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqcmVnOworCXN0cnVjdCBpOTE1X2Zl
bmNlX3JlZyAqcmVnOwogCWk5MTVfcmVnX3QgZmVuY2VfcmVnX2xvLCBmZW5jZV9yZWdfaGk7CiAK
IAlhc3NlcnRfcnBtX3dha2Vsb2NrX2hlbGQoZGV2X3ByaXYpOwpAQCAtMTYzLDcgKzE2NCw3IEBA
IHN0YXRpYyB2b2lkIGZyZWVfdmdwdV9mZW5jZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIHsK
IAlzdHJ1Y3QgaW50ZWxfZ3Z0ICpndnQgPSB2Z3B1LT5ndnQ7CiAJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gZ3Z0LT5kZXZfcHJpdjsKLQlzdHJ1Y3QgZHJtX2k5MTVfZmVuY2Vf
cmVnICpyZWc7CisJc3RydWN0IGk5MTVfZmVuY2VfcmVnICpyZWc7CiAJdTMyIGk7CiAKIAlpZiAo
V0FSTl9PTighdmdwdV9mZW5jZV9zeih2Z3B1KSkpCkBAIC0xODcsNyArMTg4LDcgQEAgc3RhdGlj
IGludCBhbGxvY192Z3B1X2ZlbmNlKHN0cnVjdCBpbnRlbF92Z3B1ICp2Z3B1KQogewogCXN0cnVj
dCBpbnRlbF9ndnQgKmd2dCA9IHZncHUtPmd2dDsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSBndnQtPmRldl9wcml2OwotCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKnJl
ZzsKKwlzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKnJlZzsKIAlpbnQgaTsKIAogCWludGVsX3J1bnRp
bWVfcG1fZ2V0KGRldl9wcml2KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2
dC9ndnQuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuaAppbmRleCBiNTRmMmJkYzEz
YTQuLmRmZDEwY2Y4MmI2NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L2d2
dC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndnQuaApAQCAtODcsNyArODcsNyBA
QCBzdHJ1Y3QgaW50ZWxfdmdwdV9nbSB7CiAKIC8qIEZlbmNlcyBvd25lZCBieSBhIHZHUFUgKi8K
IHN0cnVjdCBpbnRlbF92Z3B1X2ZlbmNlIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVnICpy
ZWdzW0lOVEVMX0dWVF9NQVhfTlVNX0ZFTkNFU107CisJc3RydWN0IGk5MTVfZmVuY2VfcmVnICpy
ZWdzW0lOVEVMX0dWVF9NQVhfTlVNX0ZFTkNFU107CiAJdTMyIGJhc2U7CiAJdTMyIHNpemU7CiB9
OwpAQCAtMzkwLDcgKzM5MCw3IEBAIGludCBpbnRlbF9ndnRfbG9hZF9maXJtd2FyZShzdHJ1Y3Qg
aW50ZWxfZ3Z0ICpndnQpOwogI2RlZmluZSBndnRfaGlkZGVuX2dtYWRyX2VuZChndnQpIChndnRf
aGlkZGVuX2dtYWRyX2Jhc2UoZ3Z0KSBcCiAJCQkJICAgKyBndnRfaGlkZGVuX3N6KGd2dCkgLSAx
KQogCi0jZGVmaW5lIGd2dF9mZW5jZV9zeihndnQpIChndnQtPmRldl9wcml2LT5udW1fZmVuY2Vf
cmVncykKKyNkZWZpbmUgZ3Z0X2ZlbmNlX3N6KGd2dCkgKChndnQpLT5kZXZfcHJpdi0+Z2d0dC5u
dW1fZmVuY2VzKQogCiAvKiBBcGVydHVyZS9HTSBzcGFjZSBkZWZpbml0aW9ucyBmb3IgdkdQVSAq
LwogI2RlZmluZSB2Z3B1X2FwZXJ0dXJlX29mZnNldCh2Z3B1KQkoKHZncHUpLT5nbS5sb3dfZ21f
bm9kZS5zdGFydCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdm
cy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggZjIxMjI0MWEy
NzU4Li4zMzFiMmY0NzhjNDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZGVidWdmcy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC0x
NTYsOCArMTU2LDYgQEAgZGVzY3JpYmVfb2JqKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IGRy
bV9pOTE1X2dlbV9vYmplY3QgKm9iaikKIAl1bnNpZ25lZCBpbnQgZnJvbnRidWZmZXJfYml0czsK
IAlpbnQgcGluX2NvdW50ID0gMDsKIAotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJm9iai0+YmFzZS5k
ZXYtPnN0cnVjdF9tdXRleCk7Ci0KIAlzZXFfcHJpbnRmKG0sICIlcEs6ICVjJWMlYyVjJWMgJTh6
ZEtpQiAlMDJ4ICUwMnggJXMlcyVzIiwKIAkJICAgJm9iai0+YmFzZSwKIAkJICAgZ2V0X2FjdGl2
ZV9mbGFnKG9iaiksCkBAIC0xNzMsMTcgKzE3MSwxNyBAQCBkZXNjcmliZV9vYmooc3RydWN0IHNl
cV9maWxlICptLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQogCQkgICBvYmotPm1t
Lm1hZHYgPT0gSTkxNV9NQURWX0RPTlRORUVEID8gIiBwdXJnZWFibGUiIDogIiIpOwogCWlmIChv
YmotPmJhc2UubmFtZSkKIAkJc2VxX3ByaW50ZihtLCAiIChuYW1lOiAlZCkiLCBvYmotPmJhc2Uu
bmFtZSk7Ci0JbGlzdF9mb3JfZWFjaF9lbnRyeSh2bWEsICZvYmotPnZtYS5saXN0LCBvYmpfbGlu
aykgewotCQlpZiAoaTkxNV92bWFfaXNfcGlubmVkKHZtYSkpCi0JCQlwaW5fY291bnQrKzsKLQl9
Ci0Jc2VxX3ByaW50ZihtLCAiIChwaW5uZWQgeCAlZCkiLCBwaW5fY291bnQpOwotCWlmIChvYmot
PnBpbl9nbG9iYWwpCi0JCXNlcV9wcmludGYobSwgIiAoZ2xvYmFsKSIpOworCisJc3Bpbl9sb2Nr
KCZvYmotPnZtYS5sb2NrKTsKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KHZtYSwgJm9iai0+dm1hLmxp
c3QsIG9ial9saW5rKSB7CiAJCWlmICghZHJtX21tX25vZGVfYWxsb2NhdGVkKCZ2bWEtPm5vZGUp
KQogCQkJY29udGludWU7CiAKKwkJc3Bpbl91bmxvY2soJm9iai0+dm1hLmxvY2spOworCisJCWlm
IChpOTE1X3ZtYV9pc19waW5uZWQodm1hKSkKKwkJCXBpbl9jb3VudCsrOworCiAJCXNlcV9wcmlu
dGYobSwgIiAoJXNndHQgb2Zmc2V0OiAlMDhsbHgsIHNpemU6ICUwOGxseCwgcGFnZXM6ICVzIiwK
IAkJCSAgIGk5MTVfdm1hX2lzX2dndHQodm1hKSA/ICJnIiA6ICJwcCIsCiAJCQkgICB2bWEtPm5v
ZGUuc3RhcnQsIHZtYS0+bm9kZS5zaXplLApAQCAtMjM0LDkgKzIzMiwxNiBAQCBkZXNjcmliZV9v
Ymooc3RydWN0IHNlcV9maWxlICptLCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqKQog
CQkJCSAgIHZtYS0+ZmVuY2UtPmlkLAogCQkJCSAgIGk5MTVfYWN0aXZlX3JlcXVlc3RfaXNzZXQo
JnZtYS0+bGFzdF9mZW5jZSkgPyAiKiIgOiAiIik7CiAJCXNlcV9wdXRzKG0sICIpIik7CisKKwkJ
c3Bpbl9sb2NrKCZvYmotPnZtYS5sb2NrKTsKIAl9CisJc3Bpbl91bmxvY2soJm9iai0+dm1hLmxv
Y2spOworCisJc2VxX3ByaW50ZihtLCAiIChwaW5uZWQgeCAlZCkiLCBwaW5fY291bnQpOwogCWlm
IChvYmotPnN0b2xlbikKIAkJc2VxX3ByaW50ZihtLCAiIChzdG9sZW46ICUwOGxseCkiLCBvYmot
PnN0b2xlbi0+c3RhcnQpOworCWlmIChvYmotPnBpbl9nbG9iYWwpCisJCXNlcV9wcmludGYobSwg
IiAoZ2xvYmFsKSIpOwogCiAJZW5naW5lID0gaTkxNV9nZW1fb2JqZWN0X2xhc3Rfd3JpdGVfZW5n
aW5lKG9iaik7CiAJaWYgKGVuZ2luZSkKQEAgLTg3MCwyOCArODc1LDI1IEBAIHN0YXRpYyBpbnQg
aTkxNV9pbnRlcnJ1cHRfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAKIHN0
YXRpYyBpbnQgaTkxNV9nZW1fZmVuY2VfcmVnc19pbmZvKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9p
ZCAqZGF0YSkKIHsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSBub2RlX3Rv
X2k5MTUobS0+cHJpdmF0ZSk7Ci0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZkZXZfcHJpdi0+
ZHJtOwotCWludCBpLCByZXQ7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2Rl
X3RvX2k5MTUobS0+cHJpdmF0ZSk7CisJdW5zaWduZWQgaW50IGk7CiAKLQlyZXQgPSBtdXRleF9s
b2NrX2ludGVycnVwdGlibGUoJmRldi0+c3RydWN0X211dGV4KTsKLQlpZiAocmV0KQotCQlyZXR1
cm4gcmV0OworCXNlcV9wcmludGYobSwgIlRvdGFsIGZlbmNlcyA9ICVkXG4iLCBpOTE1LT5nZ3R0
Lm51bV9mZW5jZXMpOwogCi0Jc2VxX3ByaW50ZihtLCAiVG90YWwgZmVuY2VzID0gJWRcbiIsIGRl
dl9wcml2LT5udW1fZmVuY2VfcmVncyk7Ci0JZm9yIChpID0gMDsgaSA8IGRldl9wcml2LT5udW1f
ZmVuY2VfcmVnczsgaSsrKSB7Ci0JCXN0cnVjdCBpOTE1X3ZtYSAqdm1hID0gZGV2X3ByaXYtPmZl
bmNlX3JlZ3NbaV0udm1hOworCXJjdV9yZWFkX2xvY2soKTsKKwlmb3IgKGkgPSAwOyBpIDwgaTkx
NS0+Z2d0dC5udW1fZmVuY2VzOyBpKyspIHsKKwkJc3RydWN0IGk5MTVfdm1hICp2bWEgPSBpOTE1
LT5nZ3R0LmZlbmNlX3JlZ3NbaV0udm1hOwogCiAJCXNlcV9wcmludGYobSwgIkZlbmNlICVkLCBw
aW4gY291bnQgPSAlZCwgb2JqZWN0ID0gIiwKLQkJCSAgIGksIGRldl9wcml2LT5mZW5jZV9yZWdz
W2ldLnBpbl9jb3VudCk7CisJCQkgICBpLCBpOTE1LT5nZ3R0LmZlbmNlX3JlZ3NbaV0ucGluX2Nv
dW50KTsKIAkJaWYgKCF2bWEpCiAJCQlzZXFfcHV0cyhtLCAidW51c2VkIik7CiAJCWVsc2UKIAkJ
CWRlc2NyaWJlX29iaihtLCB2bWEtPm9iaik7CiAJCXNlcV9wdXRjKG0sICdcbicpOwogCX0KKwly
Y3VfcmVhZF91bmxvY2soKTsKIAotCW11dGV4X3VubG9jaygmZGV2LT5zdHJ1Y3RfbXV0ZXgpOwog
CXJldHVybiAwOwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Ry
di5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwppbmRleCAxYWY2NzUxZTFiMzYu
LjA2YTc2ZDQ5ZWNkMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCkBAIC0zNTAsNyArMzUwLDcg
QEAgc3RhdGljIGludCBpOTE1X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHZvaWQgKmRhdGEsCiAJCXZhbHVlID0gcGRldi0+cmV2aXNpb247CiAJCWJyZWFrOwogCWNhc2Ug
STkxNV9QQVJBTV9OVU1fRkVOQ0VTX0FWQUlMOgotCQl2YWx1ZSA9IGRldl9wcml2LT5udW1fZmVu
Y2VfcmVnczsKKwkJdmFsdWUgPSBkZXZfcHJpdi0+Z2d0dC5udW1fZmVuY2VzOwogCQlicmVhazsK
IAljYXNlIEk5MTVfUEFSQU1fSEFTX09WRVJMQVk6CiAJCXZhbHVlID0gZGV2X3ByaXYtPm92ZXJs
YXkgPyAxIDogMDsKQEAgLTE2MjUsNyArMTYyNSw2IEBAIHN0YXRpYyBpbnQgaTkxNV9kcml2ZXJf
aW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJaW50ZWxfdW5jb3Jl
X3Nhbml0aXplKGRldl9wcml2KTsKIAogCWludGVsX2d0X2luaXRfd29ya2Fyb3VuZHMoZGV2X3By
aXYpOwotCWk5MTVfZ2VtX2xvYWRfaW5pdF9mZW5jZXMoZGV2X3ByaXYpOwogCiAJLyogT24gdGhl
IDk0NUcvR00sIHRoZSBjaGlwc2V0IHJlcG9ydHMgdGhlIE1TSSBjYXBhYmlsaXR5IG9uIHRoZQog
CSAqIGludGVncmF0ZWQgZ3JhcGhpY3MgZXZlbiB0aG91Z2ggdGhlIHN1cHBvcnQgaXNuJ3QgYWN0
dWFsbHkgdGhlcmUKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2Lmgg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4IDgyZTU1YzY1Mjg5YS4uOWU2
ZWNlZDQ3N2U3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKQEAgLTc2MSwxNCArNzYxLDYgQEAg
c3RydWN0IGk5MTVfZ2VtX21tIHsKIAkgKi8KIAlzdHJ1Y3QgbGlzdF9oZWFkIHB1cmdlX2xpc3Q7
CiAKLQkvKiogTGlzdCBvZiBhbGwgb2JqZWN0cyBpbiBndHRfc3BhY2UsIGN1cnJlbnRseSBtbWFw
ZWQgYnkgdXNlcnNwYWNlLgotCSAqIEFsbCBvYmplY3RzIHdpdGhpbiB0aGlzIGxpc3QgbXVzdCBh
bHNvIGJlIG9uIGJvdW5kX2xpc3QuCi0JICovCi0Jc3RydWN0IGxpc3RfaGVhZCB1c2VyZmF1bHRf
bGlzdDsKLQotCS8qIE1hbnVhbCBydW50aW1lIHBtIGF1dG9zdXNwZW5kIGRlbGF5IGZvciB1c2Vy
IEdHVFQgbW1hcHMgKi8KLQlzdHJ1Y3QgaW50ZWxfd2FrZXJlZl9hdXRvIHVzZXJmYXVsdF93YWtl
cmVmOwotCiAJLyoqCiAJICogTGlzdCBvZiBvYmplY3RzIHdoaWNoIGFyZSBwZW5kaW5nIGRlc3Ry
dWN0aW9uLgogCSAqLwpAQCAtNzk4LDkgKzc5MCw2IEBAIHN0cnVjdCBpOTE1X2dlbV9tbSB7CiAJ
c3RydWN0IG5vdGlmaWVyX2Jsb2NrIHZtYXBfbm90aWZpZXI7CiAJc3RydWN0IHNocmlua2VyIHNo
cmlua2VyOwogCi0JLyoqIExSVSBsaXN0IG9mIG9iamVjdHMgd2l0aCBmZW5jZSByZWdzIG9uIHRo
ZW0uICovCi0Jc3RydWN0IGxpc3RfaGVhZCBmZW5jZV9saXN0OwotCiAJLyoqCiAJICogV29ya3F1
ZXVlIHRvIGZhdWx0IGluIHVzZXJwdHIgcGFnZXMsIGZsdXNoZWQgYnkgdGhlIGV4ZWNidWYKIAkg
KiB3aGVuIHJlcXVpcmVkIGJ1dCBvdGhlcndpc2UgbGVmdCB0byB1c2Vyc3BhY2UgdG8gdHJ5IGFn
YWluCkBAIC0xNDg5LDkgKzE0NzgsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSB7CiAJLyog
cHJvdGVjdHMgcGFuZWwgcG93ZXIgc2VxdWVuY2VyIHN0YXRlICovCiAJc3RydWN0IG11dGV4IHBw
c19tdXRleDsKIAotCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgZmVuY2VfcmVnc1tJOTE1X01B
WF9OVU1fRkVOQ0VTXTsgLyogYXNzdW1lIDk2NSAqLwotCWludCBudW1fZmVuY2VfcmVnczsgLyog
OCBvbiBwcmUtOTY1LCAxNiBvdGhlcndpc2UgKi8KLQogCXVuc2lnbmVkIGludCBmc2JfZnJlcSwg
bWVtX2ZyZXEsIGlzX2RkcjM7CiAJdW5zaWduZWQgaW50IHNrbF9wcmVmZXJyZWRfdmNvX2ZyZXE7
CiAJdW5zaWduZWQgaW50IG1heF9jZGNsa19mcmVxOwpAQCAtMjU0Miw3ICsyNTI4LDYgQEAgdm9p
ZCBpOTE1X2dlbV9jbGVhbnVwX3VzZXJwdHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KTsKIHZvaWQgaTkxNV9nZW1fc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUpOwogaW50IGk5MTVfZ2VtX2luaXRfZWFybHkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKIHZvaWQgaTkxNV9nZW1fY2xlYW51cF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBpOTE1X2dlbV9sb2FkX2luaXRfZmVuY2VzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiBpbnQgaTkxNV9nZW1fZnJlZXplKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiBpbnQgaTkxNV9nZW1fZnJlZXplX2xhdGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKIApAQCAtMjY2OCwxOSArMjY1Myw2IEBA
IGk5MTVfdm1fdG9fcHBndHQoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCiAJcmV0dXJu
IGNvbnRhaW5lcl9vZih2bSwgc3RydWN0IGk5MTVfaHdfcHBndHQsIHZtKTsKIH0KIAotLyogaTkx
NV9nZW1fZmVuY2VfcmVnLmMgKi8KLXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKgotaTkxNV9y
ZXNlcnZlX2ZlbmNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12b2lkIGk5
MTVfdW5yZXNlcnZlX2ZlbmNlKHN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlKTsKLQot
dm9pZCBpOTE1X2dlbV9yZXN0b3JlX2ZlbmNlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwotCi12b2lkIGk5MTVfZ2VtX2RldGVjdF9iaXRfNl9zd2l6emxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci12b2lkIGk5MTVfZ2VtX29iamVjdF9kb19iaXRfMTdf
c3dpenpsZShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLAotCQkJCSAgICAgICBzdHJ1
Y3Qgc2dfdGFibGUgKnBhZ2VzKTsKLXZvaWQgaTkxNV9nZW1fb2JqZWN0X3NhdmVfYml0XzE3X3N3
aXp6bGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKLQkJCQkJIHN0cnVjdCBzZ190
YWJsZSAqcGFnZXMpOwotCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICoK
IF9faTkxNV9nZW1fY29udGV4dF9sb29rdXBfcmN1KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZh
dGUgKmZpbGVfcHJpdiwgdTMyIGlkKQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKaW5kZXggOWYy
ZTIxM2M2MDQ2Li45OTQyN2Q4YjkyNjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYwpAQCAtODgz
LDcgKzg4Myw3IEBAIGk5MTVfZ2VtX3N3X2ZpbmlzaF9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGV2LCB2b2lkICpkYXRhLAogCXJldHVybiAwOwogfQogCi12b2lkIGk5MTVfZ2VtX3J1bnRpbWVf
c3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCit2b2lkIGk5MTVfZ2Vt
X3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKIAlzdHJ1
Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqLCAqb247CiAJaW50IGk7CkBAIC04OTYsMTcgKzg5
NiwxOSBAQCB2b2lkIGk5MTVfZ2VtX3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCiAJICovCiAKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUob2JqLCBv
biwKLQkJCQkgJmRldl9wcml2LT5tbS51c2VyZmF1bHRfbGlzdCwgdXNlcmZhdWx0X2xpbmspCisJ
CQkJICZpOTE1LT5nZ3R0LnVzZXJmYXVsdF9saXN0LCB1c2VyZmF1bHRfbGluaykKIAkJX19pOTE1
X2dlbV9vYmplY3RfcmVsZWFzZV9tbWFwKG9iaik7CiAKLQkvKiBUaGUgZmVuY2Ugd2lsbCBiZSBs
b3N0IHdoZW4gdGhlIGRldmljZSBwb3dlcnMgZG93bi4gSWYgYW55IHdlcmUKKwkvKgorCSAqIFRo
ZSBmZW5jZSB3aWxsIGJlIGxvc3Qgd2hlbiB0aGUgZGV2aWNlIHBvd2VycyBkb3duLiBJZiBhbnkg
d2VyZQogCSAqIGluIHVzZSBieSBoYXJkd2FyZSAoaS5lLiB0aGV5IGFyZSBwaW5uZWQpLCB3ZSBz
aG91bGQgbm90IGJlIHBvd2VyaW5nCiAJICogZG93biEgQWxsIG90aGVyIGZlbmNlcyB3aWxsIGJl
IHJlYWNxdWlyZWQgYnkgdGhlIHVzZXIgdXBvbiB3YWtpbmcuCiAJICovCi0JZm9yIChpID0gMDsg
aSA8IGRldl9wcml2LT5udW1fZmVuY2VfcmVnczsgaSsrKSB7Ci0JCXN0cnVjdCBkcm1faTkxNV9m
ZW5jZV9yZWcgKnJlZyA9ICZkZXZfcHJpdi0+ZmVuY2VfcmVnc1tpXTsKKwlmb3IgKGkgPSAwOyBp
IDwgaTkxNS0+Z2d0dC5udW1fZmVuY2VzOyBpKyspIHsKKwkJc3RydWN0IGk5MTVfZmVuY2VfcmVn
ICpyZWcgPSAmaTkxNS0+Z2d0dC5mZW5jZV9yZWdzW2ldOwogCi0JCS8qIElkZWFsbHkgd2Ugd2Fu
dCB0byBhc3NlcnQgdGhhdCB0aGUgZmVuY2UgcmVnaXN0ZXIgaXMgbm90CisJCS8qCisJCSAqIElk
ZWFsbHkgd2Ugd2FudCB0byBhc3NlcnQgdGhhdCB0aGUgZmVuY2UgcmVnaXN0ZXIgaXMgbm90CiAJ
CSAqIGxpdmUgYXQgdGhpcyBwb2ludCAoaS5lLiB0aGF0IG5vIHBpZWNlIG9mIGNvZGUgd2lsbCBi
ZQogCQkgKiB0cnlpbmcgdG8gd3JpdGUgdGhyb3VnaCBmZW5jZSArIEdUVCwgYXMgdGhhdCBib3Ro
IHZpb2xhdGVzCiAJCSAqIG91ciB0cmFja2luZyBvZiBhY3Rpdml0eSBhbmQgYXNzb2NpYXRlZCBs
b2NraW5nL2JhcnJpZXJzLApAQCAtMTY4NCw3ICsxNjg2LDcgQEAgdm9pZCBpOTE1X2dlbV9maW5p
X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKIAlHRU1fQlVHX09OKGRl
dl9wcml2LT5ndC5hd2FrZSk7CiAKLQlpbnRlbF93YWtlcmVmX2F1dG9fZmluaSgmZGV2X3ByaXYt
Pm1tLnVzZXJmYXVsdF93YWtlcmVmKTsKKwlpbnRlbF93YWtlcmVmX2F1dG9fZmluaSgmZGV2X3By
aXYtPmdndHQudXNlcmZhdWx0X3dha2VyZWYpOwogCiAJaTkxNV9nZW1fc3VzcGVuZF9sYXRlKGRl
dl9wcml2KTsKIAlpbnRlbF9kaXNhYmxlX2d0X3Bvd2Vyc2F2ZShkZXZfcHJpdik7CkBAIC0xNzI2
LDM4ICsxNzI4LDYgQEAgdm9pZCBpOTE1X2dlbV9pbml0X21taW8oc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCiAJaTkxNV9nZW1fc2FuaXRpemUoaTkxNSk7CiB9CiAKLXZvaWQKLWk5MTVf
Z2VtX2xvYWRfaW5pdF9mZW5jZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQot
ewotCWludCBpOwotCi0JaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gNyAmJiAhSVNfVkFMTEVZ
VklFVyhkZXZfcHJpdikgJiYKLQkgICAgIUlTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKQotCQlkZXZf
cHJpdi0+bnVtX2ZlbmNlX3JlZ3MgPSAzMjsKLQllbHNlIGlmIChJTlRFTF9HRU4oZGV2X3ByaXYp
ID49IDQgfHwKLQkJIElTX0k5NDVHKGRldl9wcml2KSB8fCBJU19JOTQ1R00oZGV2X3ByaXYpIHx8
Ci0JCSBJU19HMzMoZGV2X3ByaXYpIHx8IElTX1BJTkVWSUVXKGRldl9wcml2KSkKLQkJZGV2X3By
aXYtPm51bV9mZW5jZV9yZWdzID0gMTY7Ci0JZWxzZQotCQlkZXZfcHJpdi0+bnVtX2ZlbmNlX3Jl
Z3MgPSA4OwotCi0JaWYgKGludGVsX3ZncHVfYWN0aXZlKGRldl9wcml2KSkKLQkJZGV2X3ByaXYt
Pm51bV9mZW5jZV9yZWdzID0KLQkJCQlJOTE1X1JFQUQodmd0aWZfcmVnKGF2YWlsX3JzLmZlbmNl
X251bSkpOwotCi0JLyogSW5pdGlhbGl6ZSBmZW5jZSByZWdpc3RlcnMgdG8gemVybyAqLwotCWZv
ciAoaSA9IDA7IGkgPCBkZXZfcHJpdi0+bnVtX2ZlbmNlX3JlZ3M7IGkrKykgewotCQlzdHJ1Y3Qg
ZHJtX2k5MTVfZmVuY2VfcmVnICpmZW5jZSA9ICZkZXZfcHJpdi0+ZmVuY2VfcmVnc1tpXTsKLQot
CQlmZW5jZS0+aTkxNSA9IGRldl9wcml2OwotCQlmZW5jZS0+aWQgPSBpOwotCQlsaXN0X2FkZF90
YWlsKCZmZW5jZS0+bGluaywgJmRldl9wcml2LT5tbS5mZW5jZV9saXN0KTsKLQl9Ci0JaTkxNV9n
ZW1fcmVzdG9yZV9mZW5jZXMoZGV2X3ByaXYpOwotCi0JaTkxNV9nZW1fZGV0ZWN0X2JpdF82X3N3
aXp6bGUoZGV2X3ByaXYpOwotfQotCiBzdGF0aWMgdm9pZCBpOTE1X2dlbV9pbml0X19tbShzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKIAlzcGluX2xvY2tfaW5pdCgmaTkxNS0+bW0u
b2JqX2xvY2spOwpAQCAtMTc2OCwxMCArMTczOCw2IEBAIHN0YXRpYyB2b2lkIGk5MTVfZ2VtX2lu
aXRfX21tKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCUlOSVRfTElTVF9IRUFEKCZp
OTE1LT5tbS5wdXJnZV9saXN0KTsKIAlJTklUX0xJU1RfSEVBRCgmaTkxNS0+bW0udW5ib3VuZF9s
aXN0KTsKIAlJTklUX0xJU1RfSEVBRCgmaTkxNS0+bW0uYm91bmRfbGlzdCk7Ci0JSU5JVF9MSVNU
X0hFQUQoJmk5MTUtPm1tLmZlbmNlX2xpc3QpOwotCi0JSU5JVF9MSVNUX0hFQUQoJmk5MTUtPm1t
LnVzZXJmYXVsdF9saXN0KTsKLQlpbnRlbF93YWtlcmVmX2F1dG9faW5pdCgmaTkxNS0+bW0udXNl
cmZhdWx0X3dha2VyZWYsIGk5MTUpOwogCiAJaTkxNV9nZW1faW5pdF9fb2JqZWN0cyhpOTE1KTsK
IH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZmVuY2VfcmVnLmMKaW5kZXggMTBhYTZl
MzUwYmZhLi40YmEzNzI2NTU2YTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfZ2VtX2ZlbmNlX3JlZy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2Zl
bmNlX3JlZy5jCkBAIC0yNSw2ICsyNSw3IEBACiAKICNpbmNsdWRlICJpOTE1X2Rydi5oIgogI2lu
Y2x1ZGUgImk5MTVfc2NhdHRlcmxpc3QuaCIKKyNpbmNsdWRlICJpOTE1X3ZncHUuaCIKIAogLyoq
CiAgKiBET0M6IGZlbmNlIHJlZ2lzdGVyIGhhbmRsaW5nCkBAIC01OCw3ICs1OSw3IEBACiAKICNk
ZWZpbmUgcGlwZWxpbmVkIDAKIAotc3RhdGljIHZvaWQgaTk2NV93cml0ZV9mZW5jZV9yZWcoc3Ry
dWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2UsCitzdGF0aWMgdm9pZCBpOTY1X3dyaXRlX2Zl
bmNlX3JlZyhzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKmZlbmNlLAogCQkJCSBzdHJ1Y3QgaTkxNV92
bWEgKnZtYSkKIHsKIAlpOTE1X3JlZ190IGZlbmNlX3JlZ19sbywgZmVuY2VfcmVnX2hpOwpAQCAt
MTE1LDcgKzExNiw3IEBAIHN0YXRpYyB2b2lkIGk5NjVfd3JpdGVfZmVuY2VfcmVnKHN0cnVjdCBk
cm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlLAogCX0KIH0KIAotc3RhdGljIHZvaWQgaTkxNV93cml0
ZV9mZW5jZV9yZWcoc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2UsCitzdGF0aWMgdm9p
ZCBpOTE1X3dyaXRlX2ZlbmNlX3JlZyhzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKmZlbmNlLAogCQkJ
CSBzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKIHsKIAl1MzIgdmFsOwpAQCAtMTU1LDcgKzE1Niw3IEBA
IHN0YXRpYyB2b2lkIGk5MTVfd3JpdGVfZmVuY2VfcmVnKHN0cnVjdCBkcm1faTkxNV9mZW5jZV9y
ZWcgKmZlbmNlLAogCX0KIH0KIAotc3RhdGljIHZvaWQgaTgzMF93cml0ZV9mZW5jZV9yZWcoc3Ry
dWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2UsCitzdGF0aWMgdm9pZCBpODMwX3dyaXRlX2Zl
bmNlX3JlZyhzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKmZlbmNlLAogCQkJCSBzdHJ1Y3QgaTkxNV92
bWEgKnZtYSkKIHsKIAl1MzIgdmFsOwpAQCAtMTg3LDcgKzE4OCw3IEBAIHN0YXRpYyB2b2lkIGk4
MzBfd3JpdGVfZmVuY2VfcmVnKHN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlLAogCX0K
IH0KIAotc3RhdGljIHZvaWQgZmVuY2Vfd3JpdGUoc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAq
ZmVuY2UsCitzdGF0aWMgdm9pZCBmZW5jZV93cml0ZShzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKmZl
bmNlLAogCQkJc3RydWN0IGk5MTVfdm1hICp2bWEpCiB7CiAJLyoKQEAgLTIxMSw3ICsyMTIsNyBA
QCBzdGF0aWMgdm9pZCBmZW5jZV93cml0ZShzdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVnICpmZW5j
ZSwKIAlmZW5jZS0+ZGlydHkgPSBmYWxzZTsKIH0KIAotc3RhdGljIGludCBmZW5jZV91cGRhdGUo
c3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2UsCitzdGF0aWMgaW50IGZlbmNlX3VwZGF0
ZShzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKmZlbmNlLAogCQkJc3RydWN0IGk5MTVfdm1hICp2bWEp
CiB7CiAJaW50ZWxfd2FrZXJlZl90IHdha2VyZWY7CkBAIC0yNTYsNyArMjU3LDcgQEAgc3RhdGlj
IGludCBmZW5jZV91cGRhdGUoc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2UsCiAJCQlv
bGQtPmZlbmNlID0gTlVMTDsKIAkJfQogCi0JCWxpc3RfbW92ZSgmZmVuY2UtPmxpbmssICZmZW5j
ZS0+aTkxNS0+bW0uZmVuY2VfbGlzdCk7CisJCWxpc3RfbW92ZSgmZmVuY2UtPmxpbmssICZmZW5j
ZS0+aTkxNS0+Z2d0dC5mZW5jZV9saXN0KTsKIAl9CiAKIAkvKgpAQCAtMjgwLDcgKzI4MSw3IEBA
IHN0YXRpYyBpbnQgZmVuY2VfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNl
LAogCiAJaWYgKHZtYSkgewogCQl2bWEtPmZlbmNlID0gZmVuY2U7Ci0JCWxpc3RfbW92ZV90YWls
KCZmZW5jZS0+bGluaywgJmZlbmNlLT5pOTE1LT5tbS5mZW5jZV9saXN0KTsKKwkJbGlzdF9tb3Zl
X3RhaWwoJmZlbmNlLT5saW5rLCAmZmVuY2UtPmk5MTUtPmdndHQuZmVuY2VfbGlzdCk7CiAJfQog
CiAJaW50ZWxfcnVudGltZV9wbV9wdXQoZmVuY2UtPmk5MTUsIHdha2VyZWYpOwpAQCAtMzAwLDcg
KzMwMSw3IEBAIHN0YXRpYyBpbnQgZmVuY2VfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9mZW5jZV9y
ZWcgKmZlbmNlLAogICovCiBpbnQgaTkxNV92bWFfcHV0X2ZlbmNlKHN0cnVjdCBpOTE1X3ZtYSAq
dm1hKQogewotCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlID0gdm1hLT5mZW5jZTsK
KwlzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKmZlbmNlID0gdm1hLT5mZW5jZTsKIAogCWlmICghZmVu
Y2UpCiAJCXJldHVybiAwOwpAQCAtMzExLDExICszMTIsMTEgQEAgaW50IGk5MTVfdm1hX3B1dF9m
ZW5jZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKIAlyZXR1cm4gZmVuY2VfdXBkYXRlKGZlbmNlLCBO
VUxMKTsKIH0KIAotc3RhdGljIHN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlX2ZpbmQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0aWMgc3RydWN0IGk5MTVfZmVuY2Vf
cmVnICpmZW5jZV9maW5kKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewotCXN0cnVj
dCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlOworCXN0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqZmVu
Y2U7CiAKLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGZlbmNlLCAmaTkxNS0+bW0uZmVuY2VfbGlzdCwg
bGluaykgeworCWxpc3RfZm9yX2VhY2hfZW50cnkoZmVuY2UsICZpOTE1LT5nZ3R0LmZlbmNlX2xp
c3QsIGxpbmspIHsKIAkJR0VNX0JVR19PTihmZW5jZS0+dm1hICYmIGZlbmNlLT52bWEtPmZlbmNl
ICE9IGZlbmNlKTsKIAogCQlpZiAoZmVuY2UtPnBpbl9jb3VudCkKQEAgLTM1Miw3ICszNTMsNyBA
QCBzdGF0aWMgc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2VfZmluZChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqaTkxNSkKIGludAogaTkxNV92bWFfcGluX2ZlbmNlKHN0cnVjdCBpOTE1
X3ZtYSAqdm1hKQogewotCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKmZlbmNlOworCXN0cnVj
dCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2U7CiAJc3RydWN0IGk5MTVfdm1hICpzZXQgPSBpOTE1X2dl
bV9vYmplY3RfaXNfdGlsZWQodm1hLT5vYmopID8gdm1hIDogTlVMTDsKIAlpbnQgZXJyOwogCkBA
IC0zNjksNyArMzcwLDcgQEAgaTkxNV92bWFfcGluX2ZlbmNlKHN0cnVjdCBpOTE1X3ZtYSAqdm1h
KQogCQlmZW5jZS0+cGluX2NvdW50Kys7CiAJCWlmICghZmVuY2UtPmRpcnR5KSB7CiAJCQlsaXN0
X21vdmVfdGFpbCgmZmVuY2UtPmxpbmssCi0JCQkJICAgICAgICZmZW5jZS0+aTkxNS0+bW0uZmVu
Y2VfbGlzdCk7CisJCQkJICAgICAgICZmZW5jZS0+aTkxNS0+Z2d0dC5mZW5jZV9saXN0KTsKIAkJ
CXJldHVybiAwOwogCQl9CiAJfSBlbHNlIGlmIChzZXQpIHsKQEAgLTQwNCwxMCArNDA1LDEwIEBA
IGk5MTVfdm1hX3Bpbl9mZW5jZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSkKICAqIFRoaXMgZnVuY3Rp
b24gd2Fsa3MgdGhlIGZlbmNlIHJlZ3MgbG9va2luZyBmb3IgYSBmcmVlIG9uZSBhbmQgcmVtb3Zl
CiAgKiBpdCBmcm9tIHRoZSBmZW5jZV9saXN0LiBJdCBpcyB1c2VkIHRvIHJlc2VydmUgZmVuY2Ug
Zm9yIHZHUFUgdG8gdXNlLgogICovCi1zdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVnICoKK3N0cnVj
dCBpOTE1X2ZlbmNlX3JlZyAqCiBpOTE1X3Jlc2VydmVfZmVuY2Uoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2U7CisJc3Ry
dWN0IGk5MTVfZmVuY2VfcmVnICpmZW5jZTsKIAlpbnQgY291bnQ7CiAJaW50IHJldDsKIApAQCAt
NDE1LDcgKzQxNiw3IEBAIGk5MTVfcmVzZXJ2ZV9mZW5jZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqaTkxNSkKIAogCS8qIEtlZXAgYXQgbGVhc3Qgb25lIGZlbmNlIGF2YWlsYWJsZSBmb3IgdGhl
IGRpc3BsYXkgZW5naW5lLiAqLwogCWNvdW50ID0gMDsKLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGZl
bmNlLCAmaTkxNS0+bW0uZmVuY2VfbGlzdCwgbGluaykKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KGZl
bmNlLCAmaTkxNS0+Z2d0dC5mZW5jZV9saXN0LCBsaW5rKQogCQljb3VudCArPSAhZmVuY2UtPnBp
bl9jb3VudDsKIAlpZiAoY291bnQgPD0gMSkKIAkJcmV0dXJuIEVSUl9QVFIoLUVOT1NQQyk7CkBA
IC00NDEsMTEgKzQ0MiwxMSBAQCBpOTE1X3Jlc2VydmVfZmVuY2Uoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUpCiAgKgogICogVGhpcyBmdW5jdGlvbiBhZGQgYSByZXNlcnZlZCBmZW5jZSBy
ZWdpc3RlciBmcm9tIHZHUFUgdG8gdGhlIGZlbmNlX2xpc3QuCiAgKi8KLXZvaWQgaTkxNV91bnJl
c2VydmVfZmVuY2Uoc3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyAqZmVuY2UpCit2b2lkIGk5MTVf
dW5yZXNlcnZlX2ZlbmNlKHN0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2UpCiB7CiAJbG9ja2Rl
cF9hc3NlcnRfaGVsZCgmZmVuY2UtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCi0JbGlzdF9h
ZGQoJmZlbmNlLT5saW5rLCAmZmVuY2UtPmk5MTUtPm1tLmZlbmNlX2xpc3QpOworCWxpc3RfYWRk
KCZmZW5jZS0+bGluaywgJmZlbmNlLT5pOTE1LT5nZ3R0LmZlbmNlX2xpc3QpOwogfQogCiAvKioK
QEAgLTQ2MSw4ICs0NjIsOCBAQCB2b2lkIGk5MTVfZ2VtX3Jlc3RvcmVfZmVuY2VzKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQogCWludCBpOwogCiAJcmN1X3JlYWRfbG9jaygpOyAvKiBr
ZWVwIG9iaiBhbGl2ZSBhcyB3ZSBkZXJlZmVyZW5jZSAqLwotCWZvciAoaSA9IDA7IGkgPCBpOTE1
LT5udW1fZmVuY2VfcmVnczsgaSsrKSB7Ci0JCXN0cnVjdCBkcm1faTkxNV9mZW5jZV9yZWcgKnJl
ZyA9ICZpOTE1LT5mZW5jZV9yZWdzW2ldOworCWZvciAoaSA9IDA7IGkgPCBpOTE1LT5nZ3R0Lm51
bV9mZW5jZXM7IGkrKykgeworCQlzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKnJlZyA9ICZpOTE1LT5n
Z3R0LmZlbmNlX3JlZ3NbaV07CiAJCXN0cnVjdCBpOTE1X3ZtYSAqdm1hID0gUkVBRF9PTkNFKHJl
Zy0+dm1hKTsKIAogCQlHRU1fQlVHX09OKHZtYSAmJiB2bWEtPmZlbmNlICE9IHJlZyk7CkBAIC01
MzQsOCArNTM1LDggQEAgdm9pZCBpOTE1X2dlbV9yZXN0b3JlX2ZlbmNlcyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKICAqIERldGVjdHMgYml0IDYgc3dpenpsaW5nIG9mIGFkZHJlc3Mg
bG9va3VwIGJldHdlZW4gSUdEIGFjY2VzcyBhbmQgQ1BVCiAgKiBhY2Nlc3MgdGhyb3VnaCBtYWlu
IG1lbW9yeS4KICAqLwotdm9pZAotaTkxNV9nZW1fZGV0ZWN0X2JpdF82X3N3aXp6bGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0aWMgdm9pZAorZGV0ZWN0X2JpdF82X3N3aXp6
bGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7CiAJc3RydWN0IGludGVsX3VuY29y
ZSAqdW5jb3JlID0gJmk5MTUtPnVuY29yZTsKIAl1MzIgc3dpenpsZV94ID0gSTkxNV9CSVRfNl9T
V0laWkxFX1VOS05PV047CkBAIC03OTgsMyArNzk5LDQzIEBAIGk5MTVfZ2VtX29iamVjdF9zYXZl
X2JpdF8xN19zd2l6emxlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmosCiAJCWkrKzsK
IAl9CiB9CisKK3ZvaWQKK2k5MTVfZ2d0dF9pbml0X2ZlbmNlcyhzdHJ1Y3QgaTkxNV9nZ3R0ICpn
Z3R0KQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gZ2d0dC0+dm0uaTkxNTsK
KwlpbnQgbnVtX2ZlbmNlczsKKwlpbnQgaTsKKworCUlOSVRfTElTVF9IRUFEKCZnZ3R0LT5mZW5j
ZV9saXN0KTsKKwlJTklUX0xJU1RfSEVBRCgmZ2d0dC0+dXNlcmZhdWx0X2xpc3QpOworCWludGVs
X3dha2VyZWZfYXV0b19pbml0KCZnZ3R0LT51c2VyZmF1bHRfd2FrZXJlZiwgaTkxNSk7CisKKwlk
ZXRlY3RfYml0XzZfc3dpenpsZShpOTE1KTsKKworCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNyAm
JgorCSAgICAhKElTX1ZBTExFWVZJRVcoaTkxNSkgfHwgSVNfQ0hFUlJZVklFVyhpOTE1KSkpCisJ
CW51bV9mZW5jZXMgPSAzMjsKKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPj0gNCB8fAorCQkg
SVNfSTk0NUcoaTkxNSkgfHwgSVNfSTk0NUdNKGk5MTUpIHx8CisJCSBJU19HMzMoaTkxNSkgfHwg
SVNfUElORVZJRVcoaTkxNSkpCisJCW51bV9mZW5jZXMgPSAxNjsKKwllbHNlCisJCW51bV9mZW5j
ZXMgPSA4OworCisJaWYgKGludGVsX3ZncHVfYWN0aXZlKGk5MTUpKQorCQludW1fZmVuY2VzID0g
aW50ZWxfdW5jb3JlX3JlYWQoJmk5MTUtPnVuY29yZSwKKwkJCQkJICAgICAgIHZndGlmX3JlZyhh
dmFpbF9ycy5mZW5jZV9udW0pKTsKKworCS8qIEluaXRpYWxpemUgZmVuY2UgcmVnaXN0ZXJzIHRv
IHplcm8gKi8KKwlmb3IgKGkgPSAwOyBpIDwgbnVtX2ZlbmNlczsgaSsrKSB7CisJCXN0cnVjdCBp
OTE1X2ZlbmNlX3JlZyAqZmVuY2UgPSAmZ2d0dC0+ZmVuY2VfcmVnc1tpXTsKKworCQlmZW5jZS0+
aTkxNSA9IGk5MTU7CisJCWZlbmNlLT5pZCA9IGk7CisJCWxpc3RfYWRkX3RhaWwoJmZlbmNlLT5s
aW5rLCAmZ2d0dC0+ZmVuY2VfbGlzdCk7CisJfQorCWdndHQtPm51bV9mZW5jZXMgPSBudW1fZmVu
Y2VzOworCisJaTkxNV9nZW1fcmVzdG9yZV9mZW5jZXMoaTkxNSk7Cit9CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9mZW5jZV9yZWcuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZ2VtX2ZlbmNlX3JlZy5oCmluZGV4IDA5ZGNhZjE0MTIxYi4uZDJkYTk4ODI4
MTc5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9mZW5jZV9yZWcu
aAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9mZW5jZV9yZWcuaApAQCAtMjYs
MTMgKzI2LDE3IEBACiAjZGVmaW5lIF9fSTkxNV9GRU5DRV9SRUdfSF9fCiAKICNpbmNsdWRlIDxs
aW51eC9saXN0Lmg+CisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KIAorc3RydWN0IGRybV9pOTE1
X2dlbV9vYmplY3Q7CiBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKK3N0cnVjdCBpOTE1X2dndHQ7
CiBzdHJ1Y3QgaTkxNV92bWE7CitzdHJ1Y3Qgc2dfdGFibGU7CiAKICNkZWZpbmUgSTk2NV9GRU5D
RV9QQUdFIDQwOTZVTAogCi1zdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVnIHsKK3N0cnVjdCBpOTE1
X2ZlbmNlX3JlZyB7CiAJc3RydWN0IGxpc3RfaGVhZCBsaW5rOwogCXN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1OwogCXN0cnVjdCBpOTE1X3ZtYSAqdm1hOwpAQCAtNDksNCArNTMsMTcgQEAg
c3RydWN0IGRybV9pOTE1X2ZlbmNlX3JlZyB7CiAJYm9vbCBkaXJ0eTsKIH07CiAKKy8qIGk5MTVf
Z2VtX2ZlbmNlX3JlZy5jICovCitzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKmk5MTVfcmVzZXJ2ZV9m
ZW5jZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Cit2b2lkIGk5MTVfdW5yZXNlcnZl
X2ZlbmNlKHN0cnVjdCBpOTE1X2ZlbmNlX3JlZyAqZmVuY2UpOworCit2b2lkIGk5MTVfZ2VtX3Jl
c3RvcmVfZmVuY2VzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKKwordm9pZCBpOTE1
X2dlbV9vYmplY3RfZG9fYml0XzE3X3N3aXp6bGUoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3Qg
Km9iaiwKKwkJCQkgICAgICAgc3RydWN0IHNnX3RhYmxlICpwYWdlcyk7Cit2b2lkIGk5MTVfZ2Vt
X29iamVjdF9zYXZlX2JpdF8xN19zd2l6emxlKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpv
YmosCisJCQkJCSBzdHJ1Y3Qgc2dfdGFibGUgKnBhZ2VzKTsKKwordm9pZCBpOTE1X2dndHRfaW5p
dF9mZW5jZXMoc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCk7CisKICNlbmRpZgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbV9ndHQuYwppbmRleCA4N2JlOWMxYjYwMjEuLmFjYzNjYjdjYjIxOSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMKQEAgLTM2MDAsNiArMzYwMCw4IEBAIGludCBpOTE1
X2dndHRfaW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAKIAlnZ3R0
LT5tdHJyID0gYXJjaF9waHlzX3djX2FkZChnZ3R0LT5nbWFkci5zdGFydCwgZ2d0dC0+bWFwcGFi
bGVfZW5kKTsKIAorCWk5MTVfZ2d0dF9pbml0X2ZlbmNlcyhnZ3R0KTsKKwogCS8qCiAJICogSW5p
dGlhbGlzZSBzdG9sZW4gZWFybHkgc28gdGhhdCB3ZSBtYXkgcmVzZXJ2ZSBwcmVhbGxvY2F0ZWQK
IAkgKiBvYmplY3RzIGZvciB0aGUgQklPUyB0byBLTVMgdHJhbnNpdGlvbi4KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5oIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9nZW1fZ3R0LmgKaW5kZXggMTI4NTZmOWRkMWQxLi5lZTM5NjkzOGRlMTAgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5oCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5oCkBAIC0zOSw2ICszOSw3IEBACiAjaW5jbHVkZSA8
bGludXgvcGFnZXZlYy5oPgogCiAjaW5jbHVkZSAiZ3QvaW50ZWxfcmVzZXQuaCIKKyNpbmNsdWRl
ICJpOTE1X2dlbV9mZW5jZV9yZWcuaCIKICNpbmNsdWRlICJpOTE1X3JlcXVlc3QuaCIKICNpbmNs
dWRlICJpOTE1X3NjYXR0ZXJsaXN0LmgiCiAjaW5jbHVkZSAiaTkxNV9zZWxmdGVzdC5oIgpAQCAt
NjEsNyArNjIsNiBAQAogI2RlZmluZSBJOTE1X01BWF9OVU1fRkVOQ0VfQklUUyA2CiAKIHN0cnVj
dCBkcm1faTkxNV9maWxlX3ByaXZhdGU7Ci1zdHJ1Y3QgZHJtX2k5MTVfZmVuY2VfcmVnOwogc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3Q7CiBzdHJ1Y3QgaTkxNV92bWE7CiAKQEAgLTQwNiw2ICs0
MDYsMTggQEAgc3RydWN0IGk5MTVfZ2d0dCB7CiAKIAl1MzIgcGluX2JpYXM7CiAKKwl1bnNpZ25l
ZCBpbnQgbnVtX2ZlbmNlczsKKwlzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgZmVuY2VfcmVnc1tJOTE1
X01BWF9OVU1fRkVOQ0VTXTsKKwlzdHJ1Y3QgbGlzdF9oZWFkIGZlbmNlX2xpc3Q7CisKKwkvKiog
TGlzdCBvZiBhbGwgb2JqZWN0cyBpbiBndHRfc3BhY2UsIGN1cnJlbnRseSBtbWFwZWQgYnkgdXNl
cnNwYWNlLgorCSAqIEFsbCBvYmplY3RzIHdpdGhpbiB0aGlzIGxpc3QgbXVzdCBhbHNvIGJlIG9u
IGJvdW5kX2xpc3QuCisJICovCisJc3RydWN0IGxpc3RfaGVhZCB1c2VyZmF1bHRfbGlzdDsKKwor
CS8qIE1hbnVhbCBydW50aW1lIHBtIGF1dG9zdXNwZW5kIGRlbGF5IGZvciB1c2VyIEdHVFQgbW1h
cHMgKi8KKwlzdHJ1Y3QgaW50ZWxfd2FrZXJlZl9hdXRvIHVzZXJmYXVsdF93YWtlcmVmOworCiAJ
c3RydWN0IGRybV9tbV9ub2RlIGVycm9yX2NhcHR1cmU7CiAJc3RydWN0IGRybV9tbV9ub2RlIHVj
X2Z3OwogfTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9y
LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dwdV9lcnJvci5jCmluZGV4IDE5M2E5Mzg1
N2Q5OS4uOGRjNzI3Y2JmZTY4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2dwdV9lcnJvci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ3B1X2Vycm9yLmMK
QEAgLTExMjYsMTMgKzExMjYsMTMgQEAgc3RhdGljIHZvaWQgZ2VtX3JlY29yZF9mZW5jZXMoc3Ry
dWN0IGk5MTVfZ3B1X3N0YXRlICplcnJvcikKIAlpbnQgaTsKIAogCWlmIChJTlRFTF9HRU4oZGV2
X3ByaXYpID49IDYpIHsKLQkJZm9yIChpID0gMDsgaSA8IGRldl9wcml2LT5udW1fZmVuY2VfcmVn
czsgaSsrKQorCQlmb3IgKGkgPSAwOyBpIDwgZGV2X3ByaXYtPmdndHQubnVtX2ZlbmNlczsgaSsr
KQogCQkJZXJyb3ItPmZlbmNlW2ldID0gSTkxNV9SRUFENjQoRkVOQ0VfUkVHX0dFTjZfTE8oaSkp
OwogCX0gZWxzZSBpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSA0KSB7Ci0JCWZvciAoaSA9IDA7
IGkgPCBkZXZfcHJpdi0+bnVtX2ZlbmNlX3JlZ3M7IGkrKykKKwkJZm9yIChpID0gMDsgaSA8IGRl
dl9wcml2LT5nZ3R0Lm51bV9mZW5jZXM7IGkrKykKIAkJCWVycm9yLT5mZW5jZVtpXSA9IEk5MTVf
UkVBRDY0KEZFTkNFX1JFR185NjVfTE8oaSkpOwogCX0gZWxzZSB7Ci0JCWZvciAoaSA9IDA7IGkg
PCBkZXZfcHJpdi0+bnVtX2ZlbmNlX3JlZ3M7IGkrKykKKwkJZm9yIChpID0gMDsgaSA8IGRldl9w
cml2LT5nZ3R0Lm51bV9mZW5jZXM7IGkrKykKIAkJCWVycm9yLT5mZW5jZVtpXSA9IEk5MTVfUkVB
RChGRU5DRV9SRUcoaSkpOwogCX0KIAllcnJvci0+bmZlbmNlID0gaTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3ZtYS5oCmluZGV4IDBjNTdhYjRmZWQ1ZC4uNGI3NjlkYjY0OWJmIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfdm1hLmgKQEAgLTU0LDcgKzU0LDcgQEAgc3RydWN0IGk5MTVfdm1hIHsKIAlzdHJ1Y3QgZHJt
X2k5MTVfZ2VtX29iamVjdCAqb2JqOwogCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwog
CWNvbnN0IHN0cnVjdCBpOTE1X3ZtYV9vcHMgKm9wczsKLQlzdHJ1Y3QgZHJtX2k5MTVfZmVuY2Vf
cmVnICpmZW5jZTsKKwlzdHJ1Y3QgaTkxNV9mZW5jZV9yZWcgKmZlbmNlOwogCXN0cnVjdCByZXNl
cnZhdGlvbl9vYmplY3QgKnJlc3Y7IC8qKiBBbGlhcyBvZiBvYmotPnJlc3YgKi8KIAlzdHJ1Y3Qg
c2dfdGFibGUgKnBhZ2VzOwogCXZvaWQgX19pb21lbSAqaW9tYXA7Ci0tIAoyLjIwLjEKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWls
aW5nIGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

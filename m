Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 7B7EB7DDA3
	for <lists+intel-gfx@lfdr.de>; Thu,  1 Aug 2019 16:18:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B3E946E658;
	Thu,  1 Aug 2019 14:18:03 +0000 (UTC)
X-Original-To: Intel-gfx@lists.freedesktop.org
Delivered-To: Intel-gfx@lists.freedesktop.org
Received: from mga14.intel.com (mga14.intel.com [192.55.52.115])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 19A8A6E657
 for <Intel-gfx@lists.freedesktop.org>; Thu,  1 Aug 2019 14:18:02 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by fmsmga103.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 01 Aug 2019 07:18:01 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,334,1559545200"; d="scan'208";a="172927239"
Received: from gadevlin-mobl.ger.corp.intel.com (HELO localhost.localdomain)
 ([10.251.95.57])
 by fmsmga008.fm.intel.com with ESMTP; 01 Aug 2019 07:18:00 -0700
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
To: Intel-gfx@lists.freedesktop.org
Date: Thu,  1 Aug 2019 15:17:32 +0100
Message-Id: <20190801141732.31335-5-tvrtko.ursulin@linux.intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190801141732.31335-1-tvrtko.ursulin@linux.intel.com>
References: <20190801141732.31335-1-tvrtko.ursulin@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 5/5] drm/i915/pmu: Support multiple GPUs
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KCldpdGggZGlz
Y3JldGUgZ3JhcGhpY3Mgc3lzdGVtIGNhbiBoYXZlIGJvdGggaW50ZWdyYXRlZCBhbmQgZGlzY3Jl
dGUgR1BVCmhhbmRsZWQgYnkgaTkxNS4KCkN1cnJlbnRseSB3ZSB1c2UgYSBmaXhlZCBuYW1lICgi
aTkxNSIpIHdoZW4gcmVnaXN0ZXJpbmcgYXMgdGhlIHVuY29yZSBQTVUKcHJvdmlkZXIgd2hpY2gg
c3RvcHMgd29ya2luZyBpbiB0aGlzIGNhc2UuCgpUbyBmaXggdGhpcyB3ZSBhZGQgdGhlIFBDSSBk
ZXZpY2UgbmFtZSBzdHJpbmcgdG8gbm9uLWludGVncmF0ZWQgZGV2aWNlcwpoYW5kbGVkIGJ5IHVz
LiBJbnRlZ3JhdGVkIGRldmljZXMga2VlcCB0aGUgbGVnYWN5IG5hbWUgcHJlc2VydmluZwpiYWNr
d2FyZCBjb21wYXRpYmlsaXR5LgoKdjI6CiAqIERldGVjdCBJR1AgYW5kIGtlZXAgbGVnYWN5IG5h
bWUuIChNaWNoYWwpCiAqIFVzZSBQQ0kgZGV2aWNlIG5hbWUgYXMgc3VmZml4LiAoTWljaGFsLCBD
aHJpcykKClNpZ25lZC1vZmYtYnk6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpbnRl
bC5jb20+CkNjOiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KQ2M6IE1p
Y2hhbCBXYWpkZWN6a28gPG1pY2hhbC53YWpkZWN6a29AaW50ZWwuY29tPgotLS0KSXMgb3VyIEdQ
VSBhbHdheXMgIjAwMDA6MDA6MDIuMCI/IENJIHdpbGwgdGVsbCBtZS4KLS0tCiBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3BtdS5jIHwgMjcgKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5oIHwgIDQgKysrKwogMiBmaWxlcyBjaGFuZ2Vk
LCAyOSBpbnNlcnRpb25zKCspLCAyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfcG11LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5j
CmluZGV4IGUwZTAxODBiY2E3Yy4uOWE0MDRkODVjNGU5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3BtdS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcG11
LmMKQEAgLTEwNTMsNiArMTA1MywxNSBAQCBzdGF0aWMgdm9pZCBpOTE1X3BtdV91bnJlZ2lzdGVy
X2NwdWhwX3N0YXRlKHN0cnVjdCBpOTE1X3BtdSAqcG11KQogCWNwdWhwX3JlbW92ZV9tdWx0aV9z
dGF0ZShjcHVocF9zbG90KTsKIH0KIAorc3RhdGljIGJvb2wgaXNfaWdwKHN0cnVjdCBwY2lfZGV2
ICpwZGV2KQoreworCS8qIElHUCBpcyAwMDAwOjAwOjAyLjAgKi8KKwlyZXR1cm4gcGRldi0+YnVz
LT5wYXJlbnQgPT0gTlVMTCAmJgorCSAgICAgICBwZGV2LT5idXMtPm51bWJlciA9PSAwICYmCisJ
ICAgICAgIFBDSV9TTE9UKHBkZXYtPmRldmZuKSA9PSAyICYmCisJICAgICAgIFBDSV9GVU5DKHBk
ZXYtPmRldmZuKSA9PSAwOworfQorCiB2b2lkIGk5MTVfcG11X3JlZ2lzdGVyKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1KQogewogCXN0cnVjdCBpOTE1X3BtdSAqcG11ID0gJmk5MTUtPnBt
dTsKQEAgLTEwODMsMTAgKzEwOTIsMTkgQEAgdm9pZCBpOTE1X3BtdV9yZWdpc3RlcihzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlocnRpbWVyX2luaXQoJnBtdS0+dGltZXIsIENMT0NL
X01PTk9UT05JQywgSFJUSU1FUl9NT0RFX1JFTCk7CiAJcG11LT50aW1lci5mdW5jdGlvbiA9IGk5
MTVfc2FtcGxlOwogCi0JcmV0ID0gcGVyZl9wbXVfcmVnaXN0ZXIoJnBtdS0+YmFzZSwgImk5MTUi
LCAtMSk7Ci0JaWYgKHJldCkKKwlpZiAoIWlzX2lncChpOTE1LT5kcm0ucGRldikpCisJCXBtdS0+
bmFtZSA9IGthc3ByaW50ZihHRlBfS0VSTkVMLAorCQkJCSAgICAgICJpOTE1LSVzIiwKKwkJCQkg
ICAgICBkZXZfbmFtZShpOTE1LT5kcm0uZGV2KSk7CisJZWxzZQorCQlwbXUtPm5hbWUgPSAiaTkx
NSI7CisJaWYgKCFwbXUtPm5hbWUpCiAJCWdvdG8gZXJyOwogCisJcmV0ID0gcGVyZl9wbXVfcmVn
aXN0ZXIoJnBtdS0+YmFzZSwgcG11LT5uYW1lLCAtMSk7CisJaWYgKHJldCkKKwkJZ290byBlcnJf
bmFtZTsKKwogCXJldCA9IGk5MTVfcG11X3JlZ2lzdGVyX2NwdWhwX3N0YXRlKHBtdSk7CiAJaWYg
KHJldCkKIAkJZ290byBlcnJfdW5yZWc7CkBAIC0xMDk1LDYgKzExMTMsOSBAQCB2b2lkIGk5MTVf
cG11X3JlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCiBlcnJfdW5yZWc6
CiAJcGVyZl9wbXVfdW5yZWdpc3RlcigmcG11LT5iYXNlKTsKK2Vycl9uYW1lOgorCWlmICghaXNf
aWdwKGk5MTUtPmRybS5wZGV2KSkKKwkJa2ZyZWUocG11LT5uYW1lKTsKIGVycjoKIAlwbXUtPmJh
c2UuZXZlbnRfaW5pdCA9IE5VTEw7CiAJZnJlZV9ldmVudF9hdHRyaWJ1dGVzKHBtdSk7CkBAIC0x
MTE2LDUgKzExMzcsNyBAQCB2b2lkIGk5MTVfcG11X3VucmVnaXN0ZXIoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCiAKIAlwZXJmX3BtdV91bnJlZ2lzdGVyKCZwbXUtPmJhc2UpOwogCXBt
dS0+YmFzZS5ldmVudF9pbml0ID0gTlVMTDsKKwlpZiAoIWlzX2lncChpOTE1LT5kcm0ucGRldikp
CisJCWtmcmVlKHBtdS0+bmFtZSk7CiAJZnJlZV9ldmVudF9hdHRyaWJ1dGVzKHBtdSk7CiB9CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BtdS5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9wbXUuaAppbmRleCA0ZmM0ZjI0NzgzMDEuLjhkN2EzODhkY2RjNyAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wbXUuaAorKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3BtdS5oCkBAIC00Niw2ICs0NiwxMCBAQCBzdHJ1Y3QgaTkxNV9wbXUg
ewogCSAqIEBiYXNlOiBQTVUgYmFzZS4KIAkgKi8KIAlzdHJ1Y3QgcG11IGJhc2U7CisJLyoqCisJ
ICogQG5hbWU6IE5hbWUgYXMgcmVnaXN0ZXJlZCB3aXRoIHBlcmYgY29yZS4KKwkgKi8KKwljaGFy
ICpuYW1lOwogCS8qKgogCSAqIEBsb2NrOiBMb2NrIHByb3RlY3RpbmcgZW5hYmxlIG1hc2sgYW5k
IHJlZiBjb3VudCBoYW5kbGluZy4KIAkgKi8KLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRl
bC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

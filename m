Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 9422531726
	for <lists+intel-gfx@lfdr.de>; Sat,  1 Jun 2019 00:25:00 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D6E37899DC;
	Fri, 31 May 2019 22:24:58 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 026A2899DB
 for <intel-gfx@lists.freedesktop.org>; Fri, 31 May 2019 22:24:56 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga001.fm.intel.com ([10.253.24.23])
 by orsmga104.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 31 May 2019 15:24:55 -0700
X-ExtLoop1: 1
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by fmsmga001.fm.intel.com with ESMTP; 31 May 2019 15:24:55 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 31 May 2019 15:24:08 -0700
Message-Id: <20190531222409.9177-2-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190531222409.9177-1-daniele.ceraolospurio@intel.com>
References: <20190531222409.9177-1-daniele.ceraolospurio@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 1/2] drm/i915: extract intel_display_power.h/c
 from intel_runtime_pm.h/c
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Jani Nikula <jani.nikula@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

S2VlcCBhbGwgdGhlIGRldmljZS1sZXZlbCBQTSBtYW5hZ2VtZW50IGluIGludGVsX3J1bnRpbWVf
cG0uaC9jIGFuZCBtb3ZlCmFsbCB0aGUgZGlzcGxheSBzcGVjaWZpYyBiaXRzIGludG8gdGhlaXIg
b3duIGZpbGUuIEFsc28gYWRkIHRoZSBuZXcKaGVhZGVyIHRvIE1ha2VmaWxlLmhlYWRlci10ZXN0
LgoKQXBhcnQgZnJvbSB0aGUgZ2lhbnQgY29kZSBtb3ZlLCB0aGUgb25seSBkaWZmZXJlbmNlIGlz
IHdpdGggdGhlCmludGVsX3J1bnRpbWVfPGdldC9wdXQ+X3JhdygpIGZ1bmN0aW9ucywgd2hpY2gg
YXJlIG5vdyBleHBvc2VkIGluIHRoZQpoZWFkZXIuIFRoZSBfcHV0KCkgdmVyc2lvbiBpcyBhbHNv
IG5vdCBjb25kaXRpb25hbGx5IGNvbXBpbGVkIGFueW1vcmUKc2luY2UgaXQgaXMgb2sgdG8gYWx3
YXlzIHBhc3MgdGhlIHdha2VyZWYgdGFrZW4gZnJvbSB0aGUgX2dldCgpIHRvCl9faW50ZWxfcnVu
dGltZV9wbV9wdXQgKGl0IGlzIC0xIGlmIHRyYWNraW5nIGlzIGRpc2FibGVkKS4KClN1Z2dlc3Rl
ZC1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28udWs+ClNpZ25lZC1vZmYt
Ynk6IERhbmllbGUgQ2VyYW9sbyBTcHVyaW8gPGRhbmllbGUuY2VyYW9sb3NwdXJpb0BpbnRlbC5j
b20+CkNjOiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KQ2M6IEltcmUg
RGVhayA8aW1yZS5kZWFrQGludGVsLmNvbT4KQ2M6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3ly
amFsYUBsaW51eC5pbnRlbC5jb20+CkNjOiBKYW5pIE5pa3VsYSA8amFuaS5uaWt1bGFAaW50ZWwu
Y29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlICAgICAgICAgICAgICB8ICAg
IDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUuaGVhZGVyLXRlc3QgIHwgICAgMSAr
CiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAgICAgICAgICAgfCAgICAxICsKIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2Rpc3BsYXlfcG93ZXIuYyB8IDQ2MTIgKysrKysrKysr
KysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheV9wb3dlci5oIHwg
ICA5NiArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ydW50aW1lX3BtLmMgICAgfCA0Nzkx
ICstLS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9ydW50aW1l
X3BtLmggICAgfCAgIDgzICstCiA3IGZpbGVzIGNoYW5nZWQsIDQ4MTIgaW5zZXJ0aW9ucygrKSwg
NDc3MyBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmgKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlCmluZGV4IGE3
ODUwYmJmZmJlMC4uYzBhN2IyOTk0MDc3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9NYWtlZmlsZQorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQpAQCAtMTU5LDYg
KzE1OSw3IEBAIGk5MTUteSArPSBpbnRlbF9hdWRpby5vIFwKIAkgIGludGVsX2NvbWJvX3BoeS5v
IFwKIAkgIGludGVsX2Nvbm5lY3Rvci5vIFwKIAkgIGludGVsX2Rpc3BsYXkubyBcCisJICBpbnRl
bF9kaXNwbGF5X3Bvd2VyLm8gXAogCSAgaW50ZWxfZHBpb19waHkubyBcCiAJICBpbnRlbF9kcGxs
X21nci5vIFwKIAkgIGludGVsX2ZiYy5vIFwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L01ha2VmaWxlLmhlYWRlci10ZXN0IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUu
aGVhZGVyLXRlc3QKaW5kZXggZTAxY2Q5MWRjMWM4Li42ZWYzYjY0N2FjNjUgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L01ha2VmaWxlLmhlYWRlci10ZXN0CisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L01ha2VmaWxlLmhlYWRlci10ZXN0CkBAIC0yNSw2ICsyNSw3IEBAIGhlYWRl
cl90ZXN0IDo9IFwKIAlpbnRlbF9jcnQuaCBcCiAJaW50ZWxfY3NyLmggXAogCWludGVsX2RkaS5o
IFwKKwlpbnRlbF9kaXNwbGF5X3Bvd2VyLmggXAogCWludGVsX2RwLmggXAogCWludGVsX2RwX2F1
eF9iYWNrbGlnaHQuaCBcCiAJaW50ZWxfZHBfbGlua190cmFpbmluZy5oIFwKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2Rydi5oCmluZGV4IDc2ZjJiZjkwZWQ4Ni4uZmQ1NDUwNTc2NzI4IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmgKQEAgLTcwLDYgKzcwLDcgQEAKICNpbmNsdWRlICJpbnRlbF9iaW9zLmgiCiAj
aW5jbHVkZSAiaW50ZWxfZGV2aWNlX2luZm8uaCIKICNpbmNsdWRlICJpbnRlbF9kaXNwbGF5Lmgi
CisjaW5jbHVkZSAiaW50ZWxfZGlzcGxheV9wb3dlci5oIgogI2luY2x1ZGUgImludGVsX2RwbGxf
bWdyLmgiCiAjaW5jbHVkZSAiaW50ZWxfZnJvbnRidWZmZXIuaCIKICNpbmNsdWRlICJpbnRlbF9v
cHJlZ2lvbi5oIgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxh
eV9wb3dlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheV9wb3dlci5jCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMzQ2NGQ5NjZjNzAyCi0tLSAv
ZGV2L251bGwKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGlzcGxheV9wb3dlci5j
CkBAIC0wLDAgKzEsNDYxMiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVCAqLwor
LyoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2luY2x1
ZGUgPGxpbnV4L3ZnYWFyYi5oPgorCisjaW5jbHVkZSAiaTkxNV9kcnYuaCIKKyNpbmNsdWRlICJp
OTE1X2lycS5oIgorI2luY2x1ZGUgImludGVsX2NkY2xrLmgiCisjaW5jbHVkZSAiaW50ZWxfY29t
Ym9fcGh5LmgiCisjaW5jbHVkZSAiaW50ZWxfY3J0LmgiCisjaW5jbHVkZSAiaW50ZWxfY3NyLmgi
CisjaW5jbHVkZSAiaW50ZWxfZHAuaCIKKyNpbmNsdWRlICJpbnRlbF9kcGlvX3BoeS5oIgorI2lu
Y2x1ZGUgImludGVsX2Rydi5oIgorI2luY2x1ZGUgImludGVsX2hvdHBsdWcuaCIKKyNpbmNsdWRl
ICJpbnRlbF9zaWRlYmFuZC5oIgorCitib29sIGludGVsX2Rpc3BsYXlfcG93ZXJfd2VsbF9pc19l
bmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJCQkJIGVudW0gaTkx
NV9wb3dlcl93ZWxsX2lkIHBvd2VyX3dlbGxfaWQpOworCitjb25zdCBjaGFyICoKK2ludGVsX2Rp
c3BsYXlfcG93ZXJfZG9tYWluX3N0cihlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRv
bWFpbikKK3sKKwlzd2l0Y2ggKGRvbWFpbikgeworCWNhc2UgUE9XRVJfRE9NQUlOX0RJU1BMQVlf
Q09SRToKKwkJcmV0dXJuICJESVNQTEFZX0NPUkUiOworCWNhc2UgUE9XRVJfRE9NQUlOX1BJUEVf
QToKKwkJcmV0dXJuICJQSVBFX0EiOworCWNhc2UgUE9XRVJfRE9NQUlOX1BJUEVfQjoKKwkJcmV0
dXJuICJQSVBFX0IiOworCWNhc2UgUE9XRVJfRE9NQUlOX1BJUEVfQzoKKwkJcmV0dXJuICJQSVBF
X0MiOworCWNhc2UgUE9XRVJfRE9NQUlOX1BJUEVfQV9QQU5FTF9GSVRURVI6CisJCXJldHVybiAi
UElQRV9BX1BBTkVMX0ZJVFRFUiI7CisJY2FzZSBQT1dFUl9ET01BSU5fUElQRV9CX1BBTkVMX0ZJ
VFRFUjoKKwkJcmV0dXJuICJQSVBFX0JfUEFORUxfRklUVEVSIjsKKwljYXNlIFBPV0VSX0RPTUFJ
Tl9QSVBFX0NfUEFORUxfRklUVEVSOgorCQlyZXR1cm4gIlBJUEVfQ19QQU5FTF9GSVRURVIiOwor
CWNhc2UgUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQToKKwkJcmV0dXJuICJUUkFOU0NPREVSX0Ei
OworCWNhc2UgUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQjoKKwkJcmV0dXJuICJUUkFOU0NPREVS
X0IiOworCWNhc2UgUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQzoKKwkJcmV0dXJuICJUUkFOU0NP
REVSX0MiOworCWNhc2UgUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfRURQOgorCQlyZXR1cm4gIlRS
QU5TQ09ERVJfRURQIjsKKwljYXNlIFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0VEUF9WRFNDOgor
CQlyZXR1cm4gIlRSQU5TQ09ERVJfRURQX1ZEU0MiOworCWNhc2UgUE9XRVJfRE9NQUlOX1RSQU5T
Q09ERVJfRFNJX0E6CisJCXJldHVybiAiVFJBTlNDT0RFUl9EU0lfQSI7CisJY2FzZSBQT1dFUl9E
T01BSU5fVFJBTlNDT0RFUl9EU0lfQzoKKwkJcmV0dXJuICJUUkFOU0NPREVSX0RTSV9DIjsKKwlj
YXNlIFBPV0VSX0RPTUFJTl9QT1JUX0RESV9BX0xBTkVTOgorCQlyZXR1cm4gIlBPUlRfRERJX0Ff
TEFORVMiOworCWNhc2UgUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfTEFORVM6CisJCXJldHVybiAi
UE9SVF9ERElfQl9MQU5FUyI7CisJY2FzZSBQT1dFUl9ET01BSU5fUE9SVF9ERElfQ19MQU5FUzoK
KwkJcmV0dXJuICJQT1JUX0RESV9DX0xBTkVTIjsKKwljYXNlIFBPV0VSX0RPTUFJTl9QT1JUX0RE
SV9EX0xBTkVTOgorCQlyZXR1cm4gIlBPUlRfRERJX0RfTEFORVMiOworCWNhc2UgUE9XRVJfRE9N
QUlOX1BPUlRfRERJX0VfTEFORVM6CisJCXJldHVybiAiUE9SVF9ERElfRV9MQU5FUyI7CisJY2Fz
ZSBQT1dFUl9ET01BSU5fUE9SVF9ERElfRl9MQU5FUzoKKwkJcmV0dXJuICJQT1JUX0RESV9GX0xB
TkVTIjsKKwljYXNlIFBPV0VSX0RPTUFJTl9QT1JUX0RESV9BX0lPOgorCQlyZXR1cm4gIlBPUlRf
RERJX0FfSU8iOworCWNhc2UgUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfSU86CisJCXJldHVybiAi
UE9SVF9ERElfQl9JTyI7CisJY2FzZSBQT1dFUl9ET01BSU5fUE9SVF9ERElfQ19JTzoKKwkJcmV0
dXJuICJQT1JUX0RESV9DX0lPIjsKKwljYXNlIFBPV0VSX0RPTUFJTl9QT1JUX0RESV9EX0lPOgor
CQlyZXR1cm4gIlBPUlRfRERJX0RfSU8iOworCWNhc2UgUE9XRVJfRE9NQUlOX1BPUlRfRERJX0Vf
SU86CisJCXJldHVybiAiUE9SVF9ERElfRV9JTyI7CisJY2FzZSBQT1dFUl9ET01BSU5fUE9SVF9E
RElfRl9JTzoKKwkJcmV0dXJuICJQT1JUX0RESV9GX0lPIjsKKwljYXNlIFBPV0VSX0RPTUFJTl9Q
T1JUX0RTSToKKwkJcmV0dXJuICJQT1JUX0RTSSI7CisJY2FzZSBQT1dFUl9ET01BSU5fUE9SVF9D
UlQ6CisJCXJldHVybiAiUE9SVF9DUlQiOworCWNhc2UgUE9XRVJfRE9NQUlOX1BPUlRfT1RIRVI6
CisJCXJldHVybiAiUE9SVF9PVEhFUiI7CisJY2FzZSBQT1dFUl9ET01BSU5fVkdBOgorCQlyZXR1
cm4gIlZHQSI7CisJY2FzZSBQT1dFUl9ET01BSU5fQVVESU86CisJCXJldHVybiAiQVVESU8iOwor
CWNhc2UgUE9XRVJfRE9NQUlOX0FVWF9BOgorCQlyZXR1cm4gIkFVWF9BIjsKKwljYXNlIFBPV0VS
X0RPTUFJTl9BVVhfQjoKKwkJcmV0dXJuICJBVVhfQiI7CisJY2FzZSBQT1dFUl9ET01BSU5fQVVY
X0M6CisJCXJldHVybiAiQVVYX0MiOworCWNhc2UgUE9XRVJfRE9NQUlOX0FVWF9EOgorCQlyZXR1
cm4gIkFVWF9EIjsKKwljYXNlIFBPV0VSX0RPTUFJTl9BVVhfRToKKwkJcmV0dXJuICJBVVhfRSI7
CisJY2FzZSBQT1dFUl9ET01BSU5fQVVYX0Y6CisJCXJldHVybiAiQVVYX0YiOworCWNhc2UgUE9X
RVJfRE9NQUlOX0FVWF9JT19BOgorCQlyZXR1cm4gIkFVWF9JT19BIjsKKwljYXNlIFBPV0VSX0RP
TUFJTl9BVVhfVEJUMToKKwkJcmV0dXJuICJBVVhfVEJUMSI7CisJY2FzZSBQT1dFUl9ET01BSU5f
QVVYX1RCVDI6CisJCXJldHVybiAiQVVYX1RCVDIiOworCWNhc2UgUE9XRVJfRE9NQUlOX0FVWF9U
QlQzOgorCQlyZXR1cm4gIkFVWF9UQlQzIjsKKwljYXNlIFBPV0VSX0RPTUFJTl9BVVhfVEJUNDoK
KwkJcmV0dXJuICJBVVhfVEJUNCI7CisJY2FzZSBQT1dFUl9ET01BSU5fR01CVVM6CisJCXJldHVy
biAiR01CVVMiOworCWNhc2UgUE9XRVJfRE9NQUlOX0lOSVQ6CisJCXJldHVybiAiSU5JVCI7CisJ
Y2FzZSBQT1dFUl9ET01BSU5fTU9ERVNFVDoKKwkJcmV0dXJuICJNT0RFU0VUIjsKKwljYXNlIFBP
V0VSX0RPTUFJTl9HVF9JUlE6CisJCXJldHVybiAiR1RfSVJRIjsKKwlkZWZhdWx0OgorCQlNSVNT
SU5HX0NBU0UoZG9tYWluKTsKKwkJcmV0dXJuICI/IjsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIGlu
dGVsX3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
KwkJCQkgICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKK3sKKwlEUk1fREVC
VUdfS01TKCJlbmFibGluZyAlc1xuIiwgcG93ZXJfd2VsbC0+ZGVzYy0+bmFtZSk7CisJcG93ZXJf
d2VsbC0+ZGVzYy0+b3BzLT5lbmFibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOworCXBvd2VyX3dl
bGwtPmh3X2VuYWJsZWQgPSB0cnVlOworfQorCitzdGF0aWMgdm9pZCBpbnRlbF9wb3dlcl93ZWxs
X2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAgICAgc3Ry
dWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKK3sKKwlEUk1fREVCVUdfS01TKCJkaXNh
YmxpbmcgJXNcbiIsIHBvd2VyX3dlbGwtPmRlc2MtPm5hbWUpOworCXBvd2VyX3dlbGwtPmh3X2Vu
YWJsZWQgPSBmYWxzZTsKKwlwb3dlcl93ZWxsLT5kZXNjLT5vcHMtPmRpc2FibGUoZGV2X3ByaXYs
IHBvd2VyX3dlbGwpOworfQorCitzdGF0aWMgdm9pZCBpbnRlbF9wb3dlcl93ZWxsX2dldChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJIHN0cnVjdCBpOTE1X3Bvd2VyX3dl
bGwgKnBvd2VyX3dlbGwpCit7CisJaWYgKCFwb3dlcl93ZWxsLT5jb3VudCsrKQorCQlpbnRlbF9w
b3dlcl93ZWxsX2VuYWJsZShkZXZfcHJpdiwgcG93ZXJfd2VsbCk7Cit9CisKK3N0YXRpYyB2b2lk
IGludGVsX3Bvd2VyX3dlbGxfcHV0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
KwkJCQkgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKK3sKKwlXQVJOKCFwb3dl
cl93ZWxsLT5jb3VudCwgIlVzZSBjb3VudCBvbiBwb3dlciB3ZWxsICVzIGlzIGFscmVhZHkgemVy
byIsCisJICAgICBwb3dlcl93ZWxsLT5kZXNjLT5uYW1lKTsKKworCWlmICghLS1wb3dlcl93ZWxs
LT5jb3VudCkKKwkJaW50ZWxfcG93ZXJfd2VsbF9kaXNhYmxlKGRldl9wcml2LCBwb3dlcl93ZWxs
KTsKK30KKworLyoqCisgKiBfX2ludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5hYmxlZCAtIHVubG9j
a2VkIGNoZWNrIGZvciBhIHBvd2VyIGRvbWFpbgorICogQGRldl9wcml2OiBpOTE1IGRldmljZSBp
bnN0YW5jZQorICogQGRvbWFpbjogcG93ZXIgZG9tYWluIHRvIGNoZWNrCisgKgorICogVGhpcyBp
cyB0aGUgdW5sb2NrZWQgdmVyc2lvbiBvZiBpbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQo
KSBhbmQgc2hvdWxkCisgKiBvbmx5IGJlIHVzZWQgZnJvbSBlcnJvciBjYXB0dXJlIGFuZCByZWNv
dmVyeSBjb2RlIHdoZXJlIGRlYWRsb2NrcyBhcmUKKyAqIHBvc3NpYmxlLgorICoKKyAqIFJldHVy
bnM6CisgKiBUcnVlIHdoZW4gdGhlIHBvd2VyIGRvbWFpbiBpcyBlbmFibGVkLCBmYWxzZSBvdGhl
cndpc2UuCisgKi8KK2Jvb2wgX19pbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAgICAgIGVudW0gaW50ZWxfZGlzcGxh
eV9wb3dlcl9kb21haW4gZG9tYWluKQoreworCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2Vy
X3dlbGw7CisJYm9vbCBpc19lbmFibGVkOworCisJaWYgKGRldl9wcml2LT5ydW50aW1lX3BtLnN1
c3BlbmRlZCkKKwkJcmV0dXJuIGZhbHNlOworCisJaXNfZW5hYmxlZCA9IHRydWU7CisKKwlmb3Jf
ZWFjaF9wb3dlcl9kb21haW5fd2VsbF9yZXZlcnNlKGRldl9wcml2LCBwb3dlcl93ZWxsLCBCSVRf
VUxMKGRvbWFpbikpIHsKKwkJaWYgKHBvd2VyX3dlbGwtPmRlc2MtPmFsd2F5c19vbikKKwkJCWNv
bnRpbnVlOworCisJCWlmICghcG93ZXJfd2VsbC0+aHdfZW5hYmxlZCkgeworCQkJaXNfZW5hYmxl
ZCA9IGZhbHNlOworCQkJYnJlYWs7CisJCX0KKwl9CisKKwlyZXR1cm4gaXNfZW5hYmxlZDsKK30K
KworLyoqCisgKiBpbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQgLSBjaGVjayBmb3IgYSBw
b3dlciBkb21haW4KKyAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKKyAqIEBkb21h
aW46IHBvd2VyIGRvbWFpbiB0byBjaGVjaworICoKKyAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIHVz
ZWQgdG8gY2hlY2sgdGhlIGh3IHBvd2VyIGRvbWFpbiBzdGF0ZS4gSXQgaXMgbW9zdGx5CisgKiB1
c2VkIGluIGhhcmR3YXJlIHN0YXRlIHJlYWRvdXQgZnVuY3Rpb25zLiBFdmVyeXdoZXJlIGVsc2Ug
Y29kZSBzaG91bGQgcmVseQorICogdXBvbiBleHBsaWNpdCBwb3dlciBkb21haW4gcmVmZXJlbmNl
IGNvdW50aW5nIHRvIGVuc3VyZSB0aGF0IHRoZSBoYXJkd2FyZQorICogYmxvY2sgaXMgcG93ZXJl
ZCB1cCBiZWZvcmUgYWNjZXNzaW5nIGl0LgorICoKKyAqIENhbGxlcnMgbXVzdCBob2xkIHRoZSBy
ZWxldmFudCBtb2Rlc2V0dGluZyBsb2NrcyB0byBlbnN1cmUgdGhhdCBjb25jdXJyZW50CisgKiB0
aHJlYWRzIGNhbid0IGRpc2FibGUgdGhlIHBvd2VyIHdlbGwgd2hpbGUgdGhlIGNhbGxlciB0cmll
cyB0byByZWFkIGEgZmV3CisgKiByZWdpc3RlcnMuCisgKgorICogUmV0dXJuczoKKyAqIFRydWUg
d2hlbiB0aGUgcG93ZXIgZG9tYWluIGlzIGVuYWJsZWQsIGZhbHNlIG90aGVyd2lzZS4KKyAqLwor
Ym9vbCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAorCQkJCSAgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRv
bWFpbikKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zOworCWJv
b2wgcmV0OworCisJcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKKwor
CW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOworCXJldCA9IF9faW50ZWxfZGlzcGxh
eV9wb3dlcl9pc19lbmFibGVkKGRldl9wcml2LCBkb21haW4pOworCW11dGV4X3VubG9jaygmcG93
ZXJfZG9tYWlucy0+bG9jayk7CisKKwlyZXR1cm4gcmV0OworfQorCisvKgorICogU3RhcnRpbmcg
d2l0aCBIYXN3ZWxsLCB3ZSBoYXZlIGEgIlBvd2VyIERvd24gV2VsbCIgdGhhdCBjYW4gYmUgdHVy
bmVkIG9mZgorICogd2hlbiBub3QgbmVlZGVkIGFueW1vcmUuIFdlIGhhdmUgNCByZWdpc3RlcnMg
dGhhdCBjYW4gcmVxdWVzdCB0aGUgcG93ZXIgd2VsbAorICogdG8gYmUgZW5hYmxlZCwgYW5kIGl0
IHdpbGwgb25seSBiZSBkaXNhYmxlZCBpZiBub25lIG9mIHRoZSByZWdpc3RlcnMgaXMKKyAqIHJl
cXVlc3RpbmcgaXQgdG8gYmUgZW5hYmxlZC4KKyAqLworc3RhdGljIHZvaWQgaHN3X3Bvd2VyX3dl
bGxfcG9zdF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAg
ICAgICB1OCBpcnFfcGlwZV9tYXNrLCBib29sIGhhc192Z2EpCit7CisJc3RydWN0IHBjaV9kZXYg
KnBkZXYgPSBkZXZfcHJpdi0+ZHJtLnBkZXY7CisKKwkvKgorCSAqIEFmdGVyIHdlIHJlLWVuYWJs
ZSB0aGUgcG93ZXIgd2VsbCwgaWYgd2UgdG91Y2ggVkdBIHJlZ2lzdGVyIDB4M2Q1CisJICogd2Un
bGwgZ2V0IHVuY2xhaW1lZCByZWdpc3RlciBpbnRlcnJ1cHRzLiBUaGlzIHN0b3BzIGFmdGVyIHdl
IHdyaXRlCisJICogYW55dGhpbmcgdG8gdGhlIFZHQSBNU1IgcmVnaXN0ZXIuIFRoZSB2Z2Fjb24g
bW9kdWxlIHVzZXMgdGhpcworCSAqIHJlZ2lzdGVyIGFsbCB0aGUgdGltZSwgc28gaWYgd2UgdW5i
aW5kIG91ciBkcml2ZXIgYW5kLCBhcyBhCisJICogY29uc2VxdWVuY2UsIGJpbmQgdmdhY29uLCB3
ZSdsbCBnZXQgc3R1Y2sgaW4gYW4gaW5maW5pdGUgbG9vcCBhdAorCSAqIGNvbnNvbGVfdW5sb2Nr
KCkuIFNvIG1ha2UgaGVyZSB3ZSB0b3VjaCB0aGUgVkdBIE1TUiByZWdpc3RlciwgbWFraW5nCisJ
ICogc3VyZSB2Z2Fjb24gY2FuIGtlZXAgd29ya2luZyBub3JtYWxseSB3aXRob3V0IHRyaWdnZXJp
bmcgaW50ZXJydXB0cworCSAqIGFuZCBlcnJvciBtZXNzYWdlcy4KKwkgKi8KKwlpZiAoaGFzX3Zn
YSkgeworCQl2Z2FfZ2V0X3VuaW50ZXJydXB0aWJsZShwZGV2LCBWR0FfUlNSQ19MRUdBQ1lfSU8p
OworCQlvdXRiKGluYihWR0FfTVNSX1JFQUQpLCBWR0FfTVNSX1dSSVRFKTsKKwkJdmdhX3B1dChw
ZGV2LCBWR0FfUlNSQ19MRUdBQ1lfSU8pOworCX0KKworCWlmIChpcnFfcGlwZV9tYXNrKQorCQln
ZW44X2lycV9wb3dlcl93ZWxsX3Bvc3RfZW5hYmxlKGRldl9wcml2LCBpcnFfcGlwZV9tYXNrKTsK
K30KKworc3RhdGljIHZvaWQgaHN3X3Bvd2VyX3dlbGxfcHJlX2Rpc2FibGUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAgICAgICB1OCBpcnFfcGlwZV9tYXNrKQorewor
CWlmIChpcnFfcGlwZV9tYXNrKQorCQlnZW44X2lycV9wb3dlcl93ZWxsX3ByZV9kaXNhYmxlKGRl
dl9wcml2LCBpcnFfcGlwZV9tYXNrKTsKK30KKworCitzdGF0aWMgdm9pZCBoc3dfd2FpdF9mb3Jf
cG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJ
CQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQoreworCWNvbnN0IHN0cnVj
dCBpOTE1X3Bvd2VyX3dlbGxfcmVncyAqcmVncyA9IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5yZWdz
OworCWludCBwd19pZHggPSBwb3dlcl93ZWxsLT5kZXNjLT5oc3cuaWR4OworCisJLyogVGltZW91
dCBmb3IgUFcxOjEwIHVzLCBBVVg6bm90IHNwZWNpZmllZCwgb3RoZXIgUFdzOjIwIHVzLiAqLwor
CVdBUk5fT04oaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsCisJCQkJ
CXJlZ3MtPmRyaXZlciwKKwkJCQkJSFNXX1BXUl9XRUxMX0NUTF9TVEFURShwd19pZHgpLAorCQkJ
CQlIU1dfUFdSX1dFTExfQ1RMX1NUQVRFKHB3X2lkeCksCisJCQkJCTEpKTsKK30KKworc3RhdGlj
IHUzMiBoc3dfcG93ZXJfd2VsbF9yZXF1ZXN0ZXJzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKKwkJCQkgICAgIGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyAqcmVn
cywKKwkJCQkgICAgIGludCBwd19pZHgpCit7CisJdTMyIHJlcV9tYXNrID0gSFNXX1BXUl9XRUxM
X0NUTF9SRVEocHdfaWR4KTsKKwl1MzIgcmV0OworCisJcmV0ID0gSTkxNV9SRUFEKHJlZ3MtPmJp
b3MpICYgcmVxX21hc2sgPyAxIDogMDsKKwlyZXQgfD0gSTkxNV9SRUFEKHJlZ3MtPmRyaXZlcikg
JiByZXFfbWFzayA/IDIgOiAwOworCWlmIChyZWdzLT5rdm1yLnJlZykKKwkJcmV0IHw9IEk5MTVf
UkVBRChyZWdzLT5rdm1yKSAmIHJlcV9tYXNrID8gNCA6IDA7CisJcmV0IHw9IEk5MTVfUkVBRChy
ZWdzLT5kZWJ1ZykgJiByZXFfbWFzayA/IDggOiAwOworCisJcmV0dXJuIHJldDsKK30KKworc3Rh
dGljIHZvaWQgaHN3X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCSAgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dl
cl93ZWxsKQoreworCWNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyAqcmVncyA9IHBv
d2VyX3dlbGwtPmRlc2MtPmhzdy5yZWdzOworCWludCBwd19pZHggPSBwb3dlcl93ZWxsLT5kZXNj
LT5oc3cuaWR4OworCWJvb2wgZGlzYWJsZWQ7CisJdTMyIHJlcXM7CisKKwkvKgorCSAqIEJzcGVj
IGRvZXNuJ3QgcmVxdWlyZSB3YWl0aW5nIGZvciBQV3MgdG8gZ2V0IGRpc2FibGVkLCBidXQgc3Rp
bGwgZG8KKwkgKiB0aGlzIGZvciBwYXJhbm9pYS4gVGhlIGtub3duIGNhc2VzIHdoZXJlIGEgUFcg
d2lsbCBiZSBmb3JjZWQgb246CisJICogLSBhIEtWTVIgcmVxdWVzdCBvbiBhbnkgcG93ZXIgd2Vs
bCB2aWEgdGhlIEtWTVIgcmVxdWVzdCByZWdpc3RlcgorCSAqIC0gYSBETUMgcmVxdWVzdCBvbiBQ
VzEgYW5kIE1JU0NfSU8gcG93ZXIgd2VsbHMgdmlhIHRoZSBCSU9TIGFuZAorCSAqICAgREVCVUcg
cmVxdWVzdCByZWdpc3RlcnMKKwkgKiBTa2lwIHRoZSB3YWl0IGluIGNhc2UgYW55IG9mIHRoZSBy
ZXF1ZXN0IGJpdHMgYXJlIHNldCBhbmQgcHJpbnQgYQorCSAqIGRpYWdub3N0aWMgbWVzc2FnZS4K
KwkgKi8KKwl3YWl0X2ZvcigoZGlzYWJsZWQgPSAhKEk5MTVfUkVBRChyZWdzLT5kcml2ZXIpICYK
KwkJCSAgICAgICBIU1dfUFdSX1dFTExfQ1RMX1NUQVRFKHB3X2lkeCkpKSB8fAorCQkgKHJlcXMg
PSBoc3dfcG93ZXJfd2VsbF9yZXF1ZXN0ZXJzKGRldl9wcml2LCByZWdzLCBwd19pZHgpKSwgMSk7
CisJaWYgKGRpc2FibGVkKQorCQlyZXR1cm47CisKKwlEUk1fREVCVUdfS01TKCIlcyBmb3JjZWQg
b24gKGJpb3M6JWQgZHJpdmVyOiVkIGt2bXI6JWQgZGVidWc6JWQpXG4iLAorCQkgICAgICBwb3dl
cl93ZWxsLT5kZXNjLT5uYW1lLAorCQkgICAgICAhIShyZXFzICYgMSksICEhKHJlcXMgJiAyKSwg
ISEocmVxcyAmIDQpLCAhIShyZXFzICYgOCkpOworfQorCitzdGF0aWMgdm9pZCBnZW45X3dhaXRf
Zm9yX3Bvd2VyX3dlbGxfZnVzZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAor
CQkJCQkgICBlbnVtIHNrbF9wb3dlcl9nYXRlIHBnKQoreworCS8qIFRpbWVvdXQgNXVzIGZvciBQ
RyMwLCBmb3Igb3RoZXIgUEdzIDF1cyAqLworCVdBUk5fT04oaW50ZWxfd2FpdF9mb3JfcmVnaXN0
ZXIoJmRldl9wcml2LT51bmNvcmUsIFNLTF9GVVNFX1NUQVRVUywKKwkJCQkJU0tMX0ZVU0VfUEdf
RElTVF9TVEFUVVMocGcpLAorCQkJCQlTS0xfRlVTRV9QR19ESVNUX1NUQVRVUyhwZyksIDEpKTsK
K30KKworc3RhdGljIHZvaWQgaHN3X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKKwkJCQkgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dl
bGwpCit7CisJY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzICpyZWdzID0gcG93ZXJf
d2VsbC0+ZGVzYy0+aHN3LnJlZ3M7CisJaW50IHB3X2lkeCA9IHBvd2VyX3dlbGwtPmRlc2MtPmhz
dy5pZHg7CisJYm9vbCB3YWl0X2Z1c2VzID0gcG93ZXJfd2VsbC0+ZGVzYy0+aHN3Lmhhc19mdXNl
czsKKwllbnVtIHNrbF9wb3dlcl9nYXRlIHVuaW5pdGlhbGl6ZWRfdmFyKHBnKTsKKwl1MzIgdmFs
OworCisJaWYgKHdhaXRfZnVzZXMpIHsKKwkJcGcgPSBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEx
ID8gSUNMX1BXX0NUTF9JRFhfVE9fUEcocHdfaWR4KSA6CisJCQkJCQkgU0tMX1BXX0NUTF9JRFhf
VE9fUEcocHdfaWR4KTsKKwkJLyoKKwkJICogRm9yIFBXMSB3ZSBoYXZlIHRvIHdhaXQgYm90aCBm
b3IgdGhlIFBXMC9QRzAgZnVzZSBzdGF0ZQorCQkgKiBiZWZvcmUgZW5hYmxpbmcgdGhlIHBvd2Vy
IHdlbGwgYW5kIFBXMS9QRzEncyBvd24gZnVzZQorCQkgKiBzdGF0ZSBhZnRlciB0aGUgZW5hYmxp
bmcuIEZvciBhbGwgb3RoZXIgcG93ZXIgd2VsbHMgd2l0aAorCQkgKiBmdXNlcyB3ZSBvbmx5IGhh
dmUgdG8gd2FpdCBmb3IgdGhhdCBQVy9QRydzIGZ1c2Ugc3RhdGUKKwkJICogYWZ0ZXIgdGhlIGVu
YWJsaW5nLgorCQkgKi8KKwkJaWYgKHBnID09IFNLTF9QRzEpCisJCQlnZW45X3dhaXRfZm9yX3Bv
d2VyX3dlbGxfZnVzZXMoZGV2X3ByaXYsIFNLTF9QRzApOworCX0KKworCXZhbCA9IEk5MTVfUkVB
RChyZWdzLT5kcml2ZXIpOworCUk5MTVfV1JJVEUocmVncy0+ZHJpdmVyLCB2YWwgfCBIU1dfUFdS
X1dFTExfQ1RMX1JFUShwd19pZHgpKTsKKwloc3dfd2FpdF9mb3JfcG93ZXJfd2VsbF9lbmFibGUo
ZGV2X3ByaXYsIHBvd2VyX3dlbGwpOworCisJLyogRGlzcGxheSBXQSAjMTE3ODogY25sICovCisJ
aWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpICYmCisJICAgIHB3X2lkeCA+PSBHTEtfUFdfQ1RM
X0lEWF9BVVhfQiAmJgorCSAgICBwd19pZHggPD0gQ05MX1BXX0NUTF9JRFhfQVVYX0YpIHsKKwkJ
dmFsID0gSTkxNV9SRUFEKENOTF9BVVhfQU5BT1ZSRDEocHdfaWR4KSk7CisJCXZhbCB8PSBDTkxf
QVVYX0FOQU9WUkQxX0VOQUJMRSB8IENOTF9BVVhfQU5BT1ZSRDFfTERPX0JZUEFTUzsKKwkJSTkx
NV9XUklURShDTkxfQVVYX0FOQU9WUkQxKHB3X2lkeCksIHZhbCk7CisJfQorCisJaWYgKHdhaXRf
ZnVzZXMpCisJCWdlbjlfd2FpdF9mb3JfcG93ZXJfd2VsbF9mdXNlcyhkZXZfcHJpdiwgcGcpOwor
CisJaHN3X3Bvd2VyX3dlbGxfcG9zdF9lbmFibGUoZGV2X3ByaXYsCisJCQkJICAgcG93ZXJfd2Vs
bC0+ZGVzYy0+aHN3LmlycV9waXBlX21hc2ssCisJCQkJICAgcG93ZXJfd2VsbC0+ZGVzYy0+aHN3
Lmhhc192Z2EpOworfQorCitzdGF0aWMgdm9pZCBoc3dfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93
ZWxsICpwb3dlcl93ZWxsKQoreworCWNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyAq
cmVncyA9IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5yZWdzOworCWludCBwd19pZHggPSBwb3dlcl93
ZWxsLT5kZXNjLT5oc3cuaWR4OworCXUzMiB2YWw7CisKKwloc3dfcG93ZXJfd2VsbF9wcmVfZGlz
YWJsZShkZXZfcHJpdiwKKwkJCQkgICBwb3dlcl93ZWxsLT5kZXNjLT5oc3cuaXJxX3BpcGVfbWFz
ayk7CisKKwl2YWwgPSBJOTE1X1JFQUQocmVncy0+ZHJpdmVyKTsKKwlJOTE1X1dSSVRFKHJlZ3Mt
PmRyaXZlciwgdmFsICYgfkhTV19QV1JfV0VMTF9DVExfUkVRKHB3X2lkeCkpOworCWhzd193YWl0
X2Zvcl9wb3dlcl93ZWxsX2Rpc2FibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOworfQorCisjZGVm
aW5lIElDTF9BVVhfUFdfVE9fUE9SVChwd19pZHgpCSgocHdfaWR4KSAtIElDTF9QV19DVExfSURY
X0FVWF9BKQorCitzdGF0aWMgdm9pZAoraWNsX2NvbWJvX3BoeV9hdXhfcG93ZXJfd2VsbF9lbmFi
bGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAgICBzdHJ1Y3QgaTkx
NV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQoreworCWNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dl
bGxfcmVncyAqcmVncyA9IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5yZWdzOworCWludCBwd19pZHgg
PSBwb3dlcl93ZWxsLT5kZXNjLT5oc3cuaWR4OworCWVudW0gcG9ydCBwb3J0ID0gSUNMX0FVWF9Q
V19UT19QT1JUKHB3X2lkeCk7CisJdTMyIHZhbDsKKworCXZhbCA9IEk5MTVfUkVBRChyZWdzLT5k
cml2ZXIpOworCUk5MTVfV1JJVEUocmVncy0+ZHJpdmVyLCB2YWwgfCBIU1dfUFdSX1dFTExfQ1RM
X1JFUShwd19pZHgpKTsKKworCXZhbCA9IEk5MTVfUkVBRChJQ0xfUE9SVF9DTF9EVzEyKHBvcnQp
KTsKKwlJOTE1X1dSSVRFKElDTF9QT1JUX0NMX0RXMTIocG9ydCksIHZhbCB8IElDTF9MQU5FX0VO
QUJMRV9BVVgpOworCisJaHN3X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZW5hYmxlKGRldl9wcml2LCBw
b3dlcl93ZWxsKTsKKworCS8qIERpc3BsYXkgV0EgIzExNzg6IGljbCAqLworCWlmIChJU19JQ0VM
QUtFKGRldl9wcml2KSAmJgorCSAgICBwd19pZHggPj0gSUNMX1BXX0NUTF9JRFhfQVVYX0EgJiYg
cHdfaWR4IDw9IElDTF9QV19DVExfSURYX0FVWF9CICYmCisJICAgICFpbnRlbF9iaW9zX2lzX3Bv
cnRfZWRwKGRldl9wcml2LCBwb3J0KSkgeworCQl2YWwgPSBJOTE1X1JFQUQoSUNMX0FVWF9BTkFP
VlJEMShwd19pZHgpKTsKKwkJdmFsIHw9IElDTF9BVVhfQU5BT1ZSRDFfRU5BQkxFIHwgSUNMX0FV
WF9BTkFPVlJEMV9MRE9fQllQQVNTOworCQlJOTE1X1dSSVRFKElDTF9BVVhfQU5BT1ZSRDEocHdf
aWR4KSwgdmFsKTsKKwl9Cit9CisKK3N0YXRpYyB2b2lkCitpY2xfY29tYm9fcGh5X2F1eF9wb3dl
cl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAg
ICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKK3sKKwljb25zdCBzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsX3JlZ3MgKnJlZ3MgPSBwb3dlcl93ZWxsLT5kZXNjLT5oc3cucmVnczsK
KwlpbnQgcHdfaWR4ID0gcG93ZXJfd2VsbC0+ZGVzYy0+aHN3LmlkeDsKKwllbnVtIHBvcnQgcG9y
dCA9IElDTF9BVVhfUFdfVE9fUE9SVChwd19pZHgpOworCXUzMiB2YWw7CisKKwl2YWwgPSBJOTE1
X1JFQUQoSUNMX1BPUlRfQ0xfRFcxMihwb3J0KSk7CisJSTkxNV9XUklURShJQ0xfUE9SVF9DTF9E
VzEyKHBvcnQpLCB2YWwgJiB+SUNMX0xBTkVfRU5BQkxFX0FVWCk7CisKKwl2YWwgPSBJOTE1X1JF
QUQocmVncy0+ZHJpdmVyKTsKKwlJOTE1X1dSSVRFKHJlZ3MtPmRyaXZlciwgdmFsICYgfkhTV19Q
V1JfV0VMTF9DVExfUkVRKHB3X2lkeCkpOworCisJaHN3X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZGlz
YWJsZShkZXZfcHJpdiwgcG93ZXJfd2VsbCk7Cit9CisKKyNkZWZpbmUgSUNMX0FVWF9QV19UT19D
SChwd19pZHgpCVwKKwkoKHB3X2lkeCkgLSBJQ0xfUFdfQ1RMX0lEWF9BVVhfQSArIEFVWF9DSF9B
KQorCitzdGF0aWMgdm9pZAoraWNsX3RjX3BoeV9hdXhfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxs
ICpwb3dlcl93ZWxsKQoreworCWVudW0gYXV4X2NoIGF1eF9jaCA9IElDTF9BVVhfUFdfVE9fQ0go
cG93ZXJfd2VsbC0+ZGVzYy0+aHN3LmlkeCk7CisJdTMyIHZhbDsKKworCXZhbCA9IEk5MTVfUkVB
RChEUF9BVVhfQ0hfQ1RMKGF1eF9jaCkpOworCXZhbCAmPSB+RFBfQVVYX0NIX0NUTF9UQlRfSU87
CisJaWYgKHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5pc190Y190YnQpCisJCXZhbCB8PSBEUF9BVVhf
Q0hfQ1RMX1RCVF9JTzsKKwlJOTE1X1dSSVRFKERQX0FVWF9DSF9DVEwoYXV4X2NoKSwgdmFsKTsK
KworCWhzd19wb3dlcl93ZWxsX2VuYWJsZShkZXZfcHJpdiwgcG93ZXJfd2VsbCk7Cit9CisKKy8q
CisgKiBXZSBzaG91bGQgb25seSB1c2UgdGhlIHBvd2VyIHdlbGwgaWYgd2UgZXhwbGljaXRseSBh
c2tlZCB0aGUgaGFyZHdhcmUgdG8KKyAqIGVuYWJsZSBpdCwgc28gY2hlY2sgaWYgaXQncyBlbmFi
bGVkIGFuZCBhbHNvIGNoZWNrIGlmIHdlJ3ZlIHJlcXVlc3RlZCBpdCB0bworICogYmUgZW5hYmxl
ZC4KKyAqLworc3RhdGljIGJvb2wgaHN3X3Bvd2VyX3dlbGxfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93
ZXJfd2VsbCkKK3sKKwljb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX3JlZ3MgKnJlZ3MgPSBw
b3dlcl93ZWxsLT5kZXNjLT5oc3cucmVnczsKKwllbnVtIGk5MTVfcG93ZXJfd2VsbF9pZCBpZCA9
IHBvd2VyX3dlbGwtPmRlc2MtPmlkOworCWludCBwd19pZHggPSBwb3dlcl93ZWxsLT5kZXNjLT5o
c3cuaWR4OworCXUzMiBtYXNrID0gSFNXX1BXUl9XRUxMX0NUTF9SRVEocHdfaWR4KSB8CisJCSAg
IEhTV19QV1JfV0VMTF9DVExfU1RBVEUocHdfaWR4KTsKKwl1MzIgdmFsOworCisJdmFsID0gSTkx
NV9SRUFEKHJlZ3MtPmRyaXZlcik7CisKKwkvKgorCSAqIE9uIEdFTjkgYmlnIGNvcmUgZHVlIHRv
IGEgRE1DIGJ1ZyB0aGUgZHJpdmVyJ3MgcmVxdWVzdCBiaXRzIGZvciBQVzEKKwkgKiBhbmQgdGhl
IE1JU0NfSU8gUFcgd2lsbCBiZSBub3QgcmVzdG9yZWQsIHNvIGNoZWNrIGluc3RlYWQgZm9yIHRo
ZQorCSAqIEJJT1MncyBvd24gcmVxdWVzdCBiaXRzLCB3aGljaCBhcmUgZm9yY2VkLW9uIGZvciB0
aGVzZSBwb3dlciB3ZWxscworCSAqIHdoZW4gZXhpdGluZyBEQzUvNi4KKwkgKi8KKwlpZiAoSVNf
R0VOKGRldl9wcml2LCA5KSAmJiAhSVNfR0VOOV9MUChkZXZfcHJpdikgJiYKKwkgICAgKGlkID09
IFNLTF9ESVNQX1BXXzEgfHwgaWQgPT0gU0tMX0RJU1BfUFdfTUlTQ19JTykpCisJCXZhbCB8PSBJ
OTE1X1JFQUQocmVncy0+Ymlvcyk7CisKKwlyZXR1cm4gKHZhbCAmIG1hc2spID09IG1hc2s7Cit9
CisKK3N0YXRpYyB2b2lkIGFzc2VydF9jYW5fZW5hYmxlX2RjOShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCit7CisJV0FSTl9PTkNFKChJOTE1X1JFQUQoRENfU1RBVEVfRU4pICYg
RENfU1RBVEVfRU5fREM5KSwKKwkJICAiREM5IGFscmVhZHkgcHJvZ3JhbW1lZCB0byBiZSBlbmFi
bGVkLlxuIik7CisJV0FSTl9PTkNFKEk5MTVfUkVBRChEQ19TVEFURV9FTikgJiBEQ19TVEFURV9F
Tl9VUFRPX0RDNSwKKwkJICAiREM1IHN0aWxsIG5vdCBkaXNhYmxlZCB0byBlbmFibGUgREM5Llxu
Iik7CisJV0FSTl9PTkNFKEk5MTVfUkVBRChIU1dfUFdSX1dFTExfQ1RMMikgJgorCQkgIEhTV19Q
V1JfV0VMTF9DVExfUkVRKFNLTF9QV19DVExfSURYX1BXXzIpLAorCQkgICJQb3dlciB3ZWxsIDIg
b24uXG4iKTsKKwlXQVJOX09OQ0UoaW50ZWxfaXJxc19lbmFibGVkKGRldl9wcml2KSwKKwkJICAi
SW50ZXJydXB0cyBub3QgZGlzYWJsZWQgeWV0LlxuIik7CisKKwkgLyoKKwkgICogVE9ETzogY2hl
Y2sgZm9yIHRoZSBmb2xsb3dpbmcgdG8gdmVyaWZ5IHRoZSBjb25kaXRpb25zIHRvIGVudGVyIERD
OQorCSAgKiBzdGF0ZSBhcmUgc2F0aXNmaWVkOgorCSAgKiAxXSBDaGVjayByZWxldmFudCBkaXNw
bGF5IGVuZ2luZSByZWdpc3RlcnMgdG8gdmVyaWZ5IGlmIG1vZGUgc2V0CisJICAqIGRpc2FibGUg
c2VxdWVuY2Ugd2FzIGZvbGxvd2VkLgorCSAgKiAyXSBDaGVjayBpZiBkaXNwbGF5IHVuaW5pdGlh
bGl6ZSBzZXF1ZW5jZSBpcyBpbml0aWFsaXplZC4KKwkgICovCit9CisKK3N0YXRpYyB2b2lkIGFz
c2VydF9jYW5fZGlzYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQor
eworCVdBUk5fT05DRShpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpLAorCQkgICJJbnRlcnJ1
cHRzIG5vdCBkaXNhYmxlZCB5ZXQuXG4iKTsKKwlXQVJOX09OQ0UoSTkxNV9SRUFEKERDX1NUQVRF
X0VOKSAmIERDX1NUQVRFX0VOX1VQVE9fREM1LAorCQkgICJEQzUgc3RpbGwgbm90IGRpc2FibGVk
LlxuIik7CisKKwkgLyoKKwkgICogVE9ETzogY2hlY2sgZm9yIHRoZSBmb2xsb3dpbmcgdG8gdmVy
aWZ5IERDOSBzdGF0ZSB3YXMgaW5kZWVkCisJICAqIGVudGVyZWQgYmVmb3JlIHByb2dyYW1taW5n
IHRvIGRpc2FibGUgaXQ6CisJICAqIDFdIENoZWNrIHJlbGV2YW50IGRpc3BsYXkgZW5naW5lIHJl
Z2lzdGVycyB0byB2ZXJpZnkgaWYgbW9kZQorCSAgKiAgc2V0IGRpc2FibGUgc2VxdWVuY2Ugd2Fz
IGZvbGxvd2VkLgorCSAgKiAyXSBDaGVjayBpZiBkaXNwbGF5IHVuaW5pdGlhbGl6ZSBzZXF1ZW5j
ZSBpcyBpbml0aWFsaXplZC4KKwkgICovCit9CisKK3N0YXRpYyB2b2lkIGdlbjlfd3JpdGVfZGNf
c3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCXUzMiBzdGF0ZSkK
K3sKKwlpbnQgcmV3cml0ZXMgPSAwOworCWludCByZXJlYWRzID0gMDsKKwl1MzIgdjsKKworCUk5
MTVfV1JJVEUoRENfU1RBVEVfRU4sIHN0YXRlKTsKKworCS8qIEl0IGhhcyBiZWVuIG9ic2VydmVk
IHRoYXQgZGlzYWJsaW5nIHRoZSBkYzYgc3RhdGUgc29tZXRpbWVzCisJICogZG9lc24ndCBzdGlj
ayBhbmQgZG1jIGtlZXBzIHJldHVybmluZyBvbGQgdmFsdWUuIE1ha2Ugc3VyZQorCSAqIHRoZSB3
cml0ZSByZWFsbHkgc3RpY2tzIGVub3VnaCB0aW1lcyBhbmQgYWxzbyBmb3JjZSByZXdyaXRlIHVu
dGlsCisJICogd2UgYXJlIGNvbmZpZGVudCB0aGF0IHN0YXRlIGlzIGV4YWN0bHkgd2hhdCB3ZSB3
YW50LgorCSAqLworCWRvICB7CisJCXYgPSBJOTE1X1JFQUQoRENfU1RBVEVfRU4pOworCisJCWlm
ICh2ICE9IHN0YXRlKSB7CisJCQlJOTE1X1dSSVRFKERDX1NUQVRFX0VOLCBzdGF0ZSk7CisJCQly
ZXdyaXRlcysrOworCQkJcmVyZWFkcyA9IDA7CisJCX0gZWxzZSBpZiAocmVyZWFkcysrID4gNSkg
eworCQkJYnJlYWs7CisJCX0KKworCX0gd2hpbGUgKHJld3JpdGVzIDwgMTAwKTsKKworCWlmICh2
ICE9IHN0YXRlKQorCQlEUk1fRVJST1IoIldyaXRpbmcgZGMgc3RhdGUgdG8gMHgleCBmYWlsZWQs
IG5vdyAweCV4XG4iLAorCQkJICBzdGF0ZSwgdik7CisKKwkvKiBNb3N0IG9mIHRoZSB0aW1lcyB3
ZSBuZWVkIG9uZSByZXRyeSwgYXZvaWQgc3BhbSAqLworCWlmIChyZXdyaXRlcyA+IDEpCisJCURS
TV9ERUJVR19LTVMoIlJld3JvdGUgZGMgc3RhdGUgdG8gMHgleCAlZCB0aW1lc1xuIiwKKwkJCSAg
ICAgIHN0YXRlLCByZXdyaXRlcyk7Cit9CisKK3N0YXRpYyB1MzIgZ2VuOV9kY19tYXNrKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKK3sKKwl1MzIgbWFzazsKKworCW1hc2sgPSBE
Q19TVEFURV9FTl9VUFRPX0RDNTsKKwlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKKwkJ
bWFzayB8PSBEQ19TVEFURV9FTl9VUFRPX0RDNiB8IERDX1NUQVRFX0VOX0RDOTsKKwllbHNlIGlm
IChJU19HRU45X0xQKGRldl9wcml2KSkKKwkJbWFzayB8PSBEQ19TVEFURV9FTl9EQzk7CisJZWxz
ZQorCQltYXNrIHw9IERDX1NUQVRFX0VOX1VQVE9fREM2OworCisJcmV0dXJuIG1hc2s7Cit9CisK
K3ZvaWQgZ2VuOV9zYW5pdGl6ZV9kY19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCit7CisJdTMyIHZhbDsKKworCXZhbCA9IEk5MTVfUkVBRChEQ19TVEFURV9FTikgJiBn
ZW45X2RjX21hc2soZGV2X3ByaXYpOworCisJRFJNX0RFQlVHX0tNUygiUmVzZXR0aW5nIERDIHN0
YXRlIHRyYWNraW5nIGZyb20gJTAyeCB0byAlMDJ4XG4iLAorCQkgICAgICBkZXZfcHJpdi0+Y3Ny
LmRjX3N0YXRlLCB2YWwpOworCWRldl9wcml2LT5jc3IuZGNfc3RhdGUgPSB2YWw7Cit9CisKKy8q
KgorICogZ2VuOV9zZXRfZGNfc3RhdGUgLSBzZXQgdGFyZ2V0IGRpc3BsYXkgQyBwb3dlciBzdGF0
ZQorICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQorICogQHN0YXRlOiB0YXJnZXQg
REMgcG93ZXIgc3RhdGUKKyAqIC0gRENfU1RBVEVfRElTQUJMRQorICogLSBEQ19TVEFURV9FTl9V
UFRPX0RDNQorICogLSBEQ19TVEFURV9FTl9VUFRPX0RDNgorICogLSBEQ19TVEFURV9FTl9EQzkK
KyAqCisgKiBTaWduYWwgdG8gRE1DIGZpcm13YXJlL0hXIHRoZSB0YXJnZXQgREMgcG93ZXIgc3Rh
dGUgcGFzc2VkIGluIEBzdGF0ZS4KKyAqIERNQy9IVyBjYW4gdHVybiBvZmYgaW5kaXZpZHVhbCBk
aXNwbGF5IGNsb2NrcyBhbmQgcG93ZXIgcmFpbHMgd2hlbiBlbnRlcmluZworICogYSBkZWVwZXIg
REMgcG93ZXIgc3RhdGUgKGhpZ2hlciBpbiBudW1iZXIpIGFuZCB0dXJucyB0aGVzZSBiYWNrIHdo
ZW4gZXhpdGluZworICogdGhhdCBzdGF0ZSB0byBhIHNoYWxsb3dlciBwb3dlciBzdGF0ZSAobG93
ZXIgaW4gbnVtYmVyKS4gVGhlIEhXIHdpbGwgZGVjaWRlCisgKiB3aGVuIHRvIGFjdHVhbGx5IGVu
dGVyIGEgZ2l2ZW4gc3RhdGUgb24gYW4gb24tZGVtYW5kIGJhc2lzLCBmb3IgaW5zdGFuY2UKKyAq
IGRlcGVuZGluZyBvbiB0aGUgYWN0aXZlIHN0YXRlIG9mIGRpc3BsYXkgcGlwZXMuIFRoZSBzdGF0
ZSBvZiBkaXNwbGF5CisgKiByZWdpc3RlcnMgYmFja2VkIGJ5IGFmZmVjdGVkIHBvd2VyIHJhaWxz
IGFyZSBzYXZlZC9yZXN0b3JlZCBhcyBuZWVkZWQuCisgKgorICogQmFzZWQgb24gdGhlIGFib3Zl
IGVuYWJsaW5nIGEgZGVlcGVyIERDIHBvd2VyIHN0YXRlIGlzIGFzeW5jaHJvbm91cyB3cnQuCisg
KiBlbmFibGluZyBpdC4gRGlzYWJsaW5nIGEgZGVlcGVyIHBvd2VyIHN0YXRlIGlzIHN5bmNocm9u
b3VzOiBmb3IgaW5zdGFuY2UKKyAqIHNldHRpbmcgJURDX1NUQVRFX0RJU0FCTEUgd29uJ3QgY29t
cGxldGUgdW50aWwgYWxsIEhXIHJlc291cmNlcyBhcmUgdHVybmVkCisgKiBiYWNrIG9uIGFuZCBy
ZWdpc3RlciBzdGF0ZSBpcyByZXN0b3JlZC4gVGhpcyBpcyBndWFyYW50ZWVkIGJ5IHRoZSBNTUlP
IHdyaXRlCisgKiB0byBEQ19TVEFURV9FTiBibG9ja2luZyB1bnRpbCB0aGUgc3RhdGUgaXMgcmVz
dG9yZWQuCisgKi8KK3N0YXRpYyB2b2lkIGdlbjlfc2V0X2RjX3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHN0YXRlKQoreworCXUzMiB2YWw7CisJdTMyIG1hc2s7
CisKKwlpZiAoV0FSTl9PTl9PTkNFKHN0YXRlICYgfmRldl9wcml2LT5jc3IuYWxsb3dlZF9kY19t
YXNrKSkKKwkJc3RhdGUgJj0gZGV2X3ByaXYtPmNzci5hbGxvd2VkX2RjX21hc2s7CisKKwl2YWwg
PSBJOTE1X1JFQUQoRENfU1RBVEVfRU4pOworCW1hc2sgPSBnZW45X2RjX21hc2soZGV2X3ByaXYp
OworCURSTV9ERUJVR19LTVMoIlNldHRpbmcgREMgc3RhdGUgZnJvbSAlMDJ4IHRvICUwMnhcbiIs
CisJCSAgICAgIHZhbCAmIG1hc2ssIHN0YXRlKTsKKworCS8qIENoZWNrIGlmIERNQyBpcyBpZ25v
cmluZyBvdXIgREMgc3RhdGUgcmVxdWVzdHMgKi8KKwlpZiAoKHZhbCAmIG1hc2spICE9IGRldl9w
cml2LT5jc3IuZGNfc3RhdGUpCisJCURSTV9FUlJPUigiREMgc3RhdGUgbWlzbWF0Y2ggKDB4JXgg
LT4gMHgleClcbiIsCisJCQkgIGRldl9wcml2LT5jc3IuZGNfc3RhdGUsIHZhbCAmIG1hc2spOwor
CisJdmFsICY9IH5tYXNrOworCXZhbCB8PSBzdGF0ZTsKKworCWdlbjlfd3JpdGVfZGNfc3RhdGUo
ZGV2X3ByaXYsIHZhbCk7CisKKwlkZXZfcHJpdi0+Y3NyLmRjX3N0YXRlID0gdmFsICYgbWFzazsK
K30KKwordm9pZCBieHRfZW5hYmxlX2RjOShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCit7CisJYXNzZXJ0X2Nhbl9lbmFibGVfZGM5KGRldl9wcml2KTsKKworCURSTV9ERUJVR19L
TVMoIkVuYWJsaW5nIERDOVxuIik7CisJLyoKKwkgKiBQb3dlciBzZXF1ZW5jZXIgcmVzZXQgaXMg
bm90IG5lZWRlZCBvbgorCSAqIHBsYXRmb3JtcyB3aXRoIFNvdXRoIERpc3BsYXkgRW5naW5lIG9u
IFBDSCwKKwkgKiBiZWNhdXNlIFBQUyByZWdpc3RlcnMgYXJlIGFsd2F5cyBvbi4KKwkgKi8KKwlp
ZiAoIUhBU19QQ0hfU1BMSVQoZGV2X3ByaXYpKQorCQlpbnRlbF9wb3dlcl9zZXF1ZW5jZXJfcmVz
ZXQoZGV2X3ByaXYpOworCWdlbjlfc2V0X2RjX3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9FTl9E
QzkpOworfQorCit2b2lkIGJ4dF9kaXNhYmxlX2RjOShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCit7CisJYXNzZXJ0X2Nhbl9kaXNhYmxlX2RjOShkZXZfcHJpdik7CisKKwlEUk1f
REVCVUdfS01TKCJEaXNhYmxpbmcgREM5XG4iKTsKKworCWdlbjlfc2V0X2RjX3N0YXRlKGRldl9w
cml2LCBEQ19TVEFURV9ESVNBQkxFKTsKKworCWludGVsX3Bwc191bmxvY2tfcmVnc193YShkZXZf
cHJpdik7Cit9CisKK3N0YXRpYyB2b2lkIGFzc2VydF9jc3JfbG9hZGVkKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKK3sKKwlXQVJOX09OQ0UoIUk5MTVfUkVBRChDU1JfUFJPR1JB
TSgwKSksCisJCSAgIkNTUiBwcm9ncmFtIHN0b3JhZ2Ugc3RhcnQgaXMgTlVMTFxuIik7CisJV0FS
Tl9PTkNFKCFJOTE1X1JFQUQoQ1NSX1NTUF9CQVNFKSwgIkNTUiBTU1AgQmFzZSBOb3QgZmluZVxu
Iik7CisJV0FSTl9PTkNFKCFJOTE1X1JFQUQoQ1NSX0hUUF9TS0wpLCAiQ1NSIEhUUCBOb3QgZmlu
ZVxuIik7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICoKK2xvb2t1cF9wb3dl
cl93ZWxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJICBlbnVtIGk5MTVf
cG93ZXJfd2VsbF9pZCBwb3dlcl93ZWxsX2lkKQoreworCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwg
KnBvd2VyX3dlbGw7CisKKwlmb3JfZWFjaF9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxs
KQorCQlpZiAocG93ZXJfd2VsbC0+ZGVzYy0+aWQgPT0gcG93ZXJfd2VsbF9pZCkKKwkJCXJldHVy
biBwb3dlcl93ZWxsOworCisJLyoKKwkgKiBJdCdzIG5vdCBmZWFzaWJsZSB0byBhZGQgZXJyb3Ig
Y2hlY2tpbmcgY29kZSB0byB0aGUgY2FsbGVycyBzaW5jZQorCSAqIHRoaXMgY29uZGl0aW9uIHJl
YWxseSBzaG91bGRuJ3QgaGFwcGVuIGFuZCBpdCBkb2Vzbid0IGV2ZW4gbWFrZSBzZW5zZQorCSAq
IHRvIGFib3J0IHRoaW5ncyBsaWtlIGRpc3BsYXkgaW5pdGlhbGl6YXRpb24gc2VxdWVuY2VzLiBK
dXN0IHJldHVybgorCSAqIHRoZSBmaXJzdCBwb3dlciB3ZWxsIGFuZCBob3BlIHRoZSBXQVJOIGdl
dHMgcmVwb3J0ZWQgc28gd2UgY2FuIGZpeAorCSAqIG91ciBkcml2ZXIuCisJICovCisJV0FSTigx
LCAiUG93ZXIgd2VsbCAlZCBub3QgZGVmaW5lZCBmb3IgdGhpcyBwbGF0Zm9ybVxuIiwgcG93ZXJf
d2VsbF9pZCk7CisJcmV0dXJuICZkZXZfcHJpdi0+cG93ZXJfZG9tYWlucy5wb3dlcl93ZWxsc1sw
XTsKK30KKworc3RhdGljIHZvaWQgYXNzZXJ0X2Nhbl9lbmFibGVfZGM1KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKK3sKKwlib29sIHBnMl9lbmFibGVkID0gaW50ZWxfZGlzcGxh
eV9wb3dlcl93ZWxsX2lzX2VuYWJsZWQoZGV2X3ByaXYsCisJCQkJCVNLTF9ESVNQX1BXXzIpOwor
CisJV0FSTl9PTkNFKHBnMl9lbmFibGVkLCAiUEcyIG5vdCBkaXNhYmxlZCB0byBlbmFibGUgREM1
LlxuIik7CisKKwlXQVJOX09OQ0UoKEk5MTVfUkVBRChEQ19TVEFURV9FTikgJiBEQ19TVEFURV9F
Tl9VUFRPX0RDNSksCisJCSAgIkRDNSBhbHJlYWR5IHByb2dyYW1tZWQgdG8gYmUgZW5hYmxlZC5c
biIpOworCWFzc2VydF9ycG1fd2FrZWxvY2tfaGVsZChkZXZfcHJpdik7CisKKwlhc3NlcnRfY3Ny
X2xvYWRlZChkZXZfcHJpdik7Cit9CisKK3ZvaWQgZ2VuOV9lbmFibGVfZGM1KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKK3sKKwlhc3NlcnRfY2FuX2VuYWJsZV9kYzUoZGV2X3By
aXYpOworCisJRFJNX0RFQlVHX0tNUygiRW5hYmxpbmcgREM1XG4iKTsKKworCS8qIFdhIERpc3Bs
YXkgIzExODM6IHNrbCxrYmwsY2ZsICovCisJaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKQorCQlJ
OTE1X1dSSVRFKEdFTjhfQ0hJQ0tFTl9EQ1BSXzEsIEk5MTVfUkVBRChHRU44X0NISUNLRU5fRENQ
Ul8xKSB8CisJCQkgICBTS0xfU0VMRUNUX0FMVEVSTkFURV9EQ19FWElUKTsKKworCWdlbjlfc2V0
X2RjX3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9FTl9VUFRPX0RDNSk7Cit9CisKK3N0YXRpYyB2
b2lkIGFzc2VydF9jYW5fZW5hYmxlX2RjNihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCit7CisJV0FSTl9PTkNFKEk5MTVfUkVBRChVVElMX1BJTl9DVEwpICYgVVRJTF9QSU5fRU5B
QkxFLAorCQkgICJCYWNrbGlnaHQgaXMgbm90IGRpc2FibGVkLlxuIik7CisJV0FSTl9PTkNFKChJ
OTE1X1JFQUQoRENfU1RBVEVfRU4pICYgRENfU1RBVEVfRU5fVVBUT19EQzYpLAorCQkgICJEQzYg
YWxyZWFkeSBwcm9ncmFtbWVkIHRvIGJlIGVuYWJsZWQuXG4iKTsKKworCWFzc2VydF9jc3JfbG9h
ZGVkKGRldl9wcml2KTsKK30KKwordm9pZCBza2xfZW5hYmxlX2RjNihzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCit7CisJYXNzZXJ0X2Nhbl9lbmFibGVfZGM2KGRldl9wcml2KTsK
KworCURSTV9ERUJVR19LTVMoIkVuYWJsaW5nIERDNlxuIik7CisKKwkvKiBXYSBEaXNwbGF5ICMx
MTgzOiBza2wsa2JsLGNmbCAqLworCWlmIChJU19HRU45X0JDKGRldl9wcml2KSkKKwkJSTkxNV9X
UklURShHRU44X0NISUNLRU5fRENQUl8xLCBJOTE1X1JFQUQoR0VOOF9DSElDS0VOX0RDUFJfMSkg
fAorCQkJICAgU0tMX1NFTEVDVF9BTFRFUk5BVEVfRENfRVhJVCk7CisKKwlnZW45X3NldF9kY19z
dGF0ZShkZXZfcHJpdiwgRENfU1RBVEVfRU5fVVBUT19EQzYpOworfQorCitzdGF0aWMgdm9pZCBo
c3dfcG93ZXJfd2VsbF9zeW5jX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
KwkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQoreworCWNvbnN0IHN0
cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyAqcmVncyA9IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5y
ZWdzOworCWludCBwd19pZHggPSBwb3dlcl93ZWxsLT5kZXNjLT5oc3cuaWR4OworCXUzMiBtYXNr
ID0gSFNXX1BXUl9XRUxMX0NUTF9SRVEocHdfaWR4KTsKKwl1MzIgYmlvc19yZXEgPSBJOTE1X1JF
QUQocmVncy0+Ymlvcyk7CisKKwkvKiBUYWtlIG92ZXIgdGhlIHJlcXVlc3QgYml0IGlmIHNldCBi
eSBCSU9TLiAqLworCWlmIChiaW9zX3JlcSAmIG1hc2spIHsKKwkJdTMyIGRydl9yZXEgPSBJOTE1
X1JFQUQocmVncy0+ZHJpdmVyKTsKKworCQlpZiAoIShkcnZfcmVxICYgbWFzaykpCisJCQlJOTE1
X1dSSVRFKHJlZ3MtPmRyaXZlciwgZHJ2X3JlcSB8IG1hc2spOworCQlJOTE1X1dSSVRFKHJlZ3Mt
PmJpb3MsIGJpb3NfcmVxICYgfm1hc2spOworCX0KK30KKworc3RhdGljIHZvaWQgYnh0X2RwaW9f
Y21uX3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
KwkJCQkJICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKK3sKKwlieHRfZGRp
X3BoeV9pbml0KGRldl9wcml2LCBwb3dlcl93ZWxsLT5kZXNjLT5ieHQucGh5KTsKK30KKworc3Rh
dGljIHZvaWQgYnh0X2RwaW9fY21uX3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCSAgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dl
cl93ZWxsKQoreworCWJ4dF9kZGlfcGh5X3VuaW5pdChkZXZfcHJpdiwgcG93ZXJfd2VsbC0+ZGVz
Yy0+Ynh0LnBoeSk7Cit9CisKK3N0YXRpYyBib29sIGJ4dF9kcGlvX2Ntbl9wb3dlcl93ZWxsX2Vu
YWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCQkgICAgc3RydWN0
IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKK3sKKwlyZXR1cm4gYnh0X2RkaV9waHlfaXNf
ZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJfd2VsbC0+ZGVzYy0+Ynh0LnBoeSk7Cit9CisKK3N0YXRp
YyB2b2lkIGJ4dF92ZXJpZnlfZGRpX3BoeV9wb3dlcl93ZWxscyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCit7CisJc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbDsK
KworCXBvd2VyX3dlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgQlhUX0RJU1BfUFdf
RFBJT19DTU5fQSk7CisJaWYgKHBvd2VyX3dlbGwtPmNvdW50ID4gMCkKKwkJYnh0X2RkaV9waHlf
dmVyaWZ5X3N0YXRlKGRldl9wcml2LCBwb3dlcl93ZWxsLT5kZXNjLT5ieHQucGh5KTsKKworCXBv
d2VyX3dlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgVkxWX0RJU1BfUFdfRFBJT19D
TU5fQkMpOworCWlmIChwb3dlcl93ZWxsLT5jb3VudCA+IDApCisJCWJ4dF9kZGlfcGh5X3Zlcmlm
eV9zdGF0ZShkZXZfcHJpdiwgcG93ZXJfd2VsbC0+ZGVzYy0+Ynh0LnBoeSk7CisKKwlpZiAoSVNf
R0VNSU5JTEFLRShkZXZfcHJpdikpIHsKKwkJcG93ZXJfd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxs
KGRldl9wcml2LAorCQkJCQkgICAgICAgR0xLX0RJU1BfUFdfRFBJT19DTU5fQyk7CisJCWlmIChw
b3dlcl93ZWxsLT5jb3VudCA+IDApCisJCQlieHRfZGRpX3BoeV92ZXJpZnlfc3RhdGUoZGV2X3By
aXYsCisJCQkJCQkgcG93ZXJfd2VsbC0+ZGVzYy0+Ynh0LnBoeSk7CisJfQorfQorCitzdGF0aWMg
Ym9vbCBnZW45X2RjX29mZl9wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAorCQkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxs
KQoreworCXJldHVybiAoSTkxNV9SRUFEKERDX1NUQVRFX0VOKSAmIERDX1NUQVRFX0VOX1VQVE9f
REM1X0RDNl9NQVNLKSA9PSAwOworfQorCitzdGF0aWMgdm9pZCBnZW45X2Fzc2VydF9kYnVmX2Vu
YWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQoreworCXUzMiB0bXAgPSBJ
OTE1X1JFQUQoREJVRl9DVEwpOworCisJV0FSTigodG1wICYgKERCVUZfUE9XRVJfU1RBVEUgfCBE
QlVGX1BPV0VSX1JFUVVFU1QpKSAhPQorCSAgICAgKERCVUZfUE9XRVJfU1RBVEUgfCBEQlVGX1BP
V0VSX1JFUVVFU1QpLAorCSAgICAgIlVuZXhwZWN0ZWQgREJ1ZiBwb3dlciBwb3dlciBzdGF0ZSAo
MHglMDh4KVxuIiwgdG1wKTsKK30KKworc3RhdGljIHZvaWQgZ2VuOV9kY19vZmZfcG93ZXJfd2Vs
bF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCQkgIHN0cnVj
dCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCit7CisJc3RydWN0IGludGVsX2NkY2xrX3N0
YXRlIGNkY2xrX3N0YXRlID0ge307CisKKwlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENf
U1RBVEVfRElTQUJMRSk7CisKKwlkZXZfcHJpdi0+ZGlzcGxheS5nZXRfY2RjbGsoZGV2X3ByaXYs
ICZjZGNsa19zdGF0ZSk7CisJLyogQ2FuJ3QgcmVhZCBvdXQgdm9sdGFnZV9sZXZlbCBzbyBjYW4n
dCB1c2UgaW50ZWxfY2RjbGtfY2hhbmdlZCgpICovCisJV0FSTl9PTihpbnRlbF9jZGNsa19uZWVk
c19tb2Rlc2V0KCZkZXZfcHJpdi0+Y2RjbGsuaHcsICZjZGNsa19zdGF0ZSkpOworCisJZ2VuOV9h
c3NlcnRfZGJ1Zl9lbmFibGVkKGRldl9wcml2KTsKKworCWlmIChJU19HRU45X0xQKGRldl9wcml2
KSkKKwkJYnh0X3ZlcmlmeV9kZGlfcGh5X3Bvd2VyX3dlbGxzKGRldl9wcml2KTsKKworCWlmIChJ
TlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQorCQkvKgorCQkgKiBETUMgcmV0YWlucyBIVyBjb250
ZXh0IG9ubHkgZm9yIHBvcnQgQSwgdGhlIG90aGVyIGNvbWJvCisJCSAqIFBIWSdzIEhXIGNvbnRl
eHQgZm9yIHBvcnQgQiBpcyBsb3N0IGFmdGVyIERDIHRyYW5zaXRpb25zLAorCQkgKiBzbyB3ZSBu
ZWVkIHRvIHJlc3RvcmUgaXQgbWFudWFsbHkuCisJCSAqLworCQlpbnRlbF9jb21ib19waHlfaW5p
dChkZXZfcHJpdik7Cit9CisKK3N0YXRpYyB2b2lkIGdlbjlfZGNfb2ZmX3Bvd2VyX3dlbGxfZGlz
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCSAgIHN0cnVjdCBp
OTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCit7CisJaWYgKCFkZXZfcHJpdi0+Y3NyLmRtY19w
YXlsb2FkKQorCQlyZXR1cm47CisKKwlpZiAoZGV2X3ByaXYtPmNzci5hbGxvd2VkX2RjX21hc2sg
JiBEQ19TVEFURV9FTl9VUFRPX0RDNikKKwkJc2tsX2VuYWJsZV9kYzYoZGV2X3ByaXYpOworCWVs
c2UgaWYgKGRldl9wcml2LT5jc3IuYWxsb3dlZF9kY19tYXNrICYgRENfU1RBVEVfRU5fVVBUT19E
QzUpCisJCWdlbjlfZW5hYmxlX2RjNShkZXZfcHJpdik7Cit9CisKK3N0YXRpYyB2b2lkIGk5eHhf
cG93ZXJfd2VsbF9zeW5jX2h3X25vb3Aoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAorCQkJCQkgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKK3sKK30KKworc3Rh
dGljIHZvaWQgaTl4eF9hbHdheXNfb25fcG93ZXJfd2VsbF9ub29wKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKKwkJCQkJICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJf
d2VsbCkKK3sKK30KKworc3RhdGljIGJvb2wgaTl4eF9hbHdheXNfb25fcG93ZXJfd2VsbF9lbmFi
bGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJCQkJICAgICBzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQoreworCXJldHVybiB0cnVlOworfQorCitzdGF0
aWMgdm9pZCBpODMwX3BpcGVzX3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKKwkJCQkJIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwp
Cit7CisJaWYgKChJOTE1X1JFQUQoUElQRUNPTkYoUElQRV9BKSkgJiBQSVBFQ09ORl9FTkFCTEUp
ID09IDApCisJCWk4MzBfZW5hYmxlX3BpcGUoZGV2X3ByaXYsIFBJUEVfQSk7CisJaWYgKChJOTE1
X1JFQUQoUElQRUNPTkYoUElQRV9CKSkgJiBQSVBFQ09ORl9FTkFCTEUpID09IDApCisJCWk4MzBf
ZW5hYmxlX3BpcGUoZGV2X3ByaXYsIFBJUEVfQik7Cit9CisKK3N0YXRpYyB2b2lkIGk4MzBfcGlw
ZXNfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
KwkJCQkJICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQoreworCWk4MzBfZGlz
YWJsZV9waXBlKGRldl9wcml2LCBQSVBFX0IpOworCWk4MzBfZGlzYWJsZV9waXBlKGRldl9wcml2
LCBQSVBFX0EpOworfQorCitzdGF0aWMgYm9vbCBpODMwX3BpcGVzX3Bvd2VyX3dlbGxfZW5hYmxl
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCSAgc3RydWN0IGk5MTVf
cG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKK3sKKwlyZXR1cm4gSTkxNV9SRUFEKFBJUEVDT05GKFBJ
UEVfQSkpICYgUElQRUNPTkZfRU5BQkxFICYmCisJCUk5MTVfUkVBRChQSVBFQ09ORihQSVBFX0Ip
KSAmIFBJUEVDT05GX0VOQUJMRTsKK30KKworc3RhdGljIHZvaWQgaTgzMF9waXBlc19wb3dlcl93
ZWxsX3N5bmNfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCQkgIHN0
cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCit7CisJaWYgKHBvd2VyX3dlbGwtPmNv
dW50ID4gMCkKKwkJaTgzMF9waXBlc19wb3dlcl93ZWxsX2VuYWJsZShkZXZfcHJpdiwgcG93ZXJf
d2VsbCk7CisJZWxzZQorCQlpODMwX3BpcGVzX3Bvd2VyX3dlbGxfZGlzYWJsZShkZXZfcHJpdiwg
cG93ZXJfd2VsbCk7Cit9CisKK3N0YXRpYyB2b2lkIHZsdl9zZXRfcG93ZXJfd2VsbChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkgICAgICAgc3RydWN0IGk5MTVfcG93ZXJf
d2VsbCAqcG93ZXJfd2VsbCwgYm9vbCBlbmFibGUpCit7CisJaW50IHB3X2lkeCA9IHBvd2VyX3dl
bGwtPmRlc2MtPnZsdi5pZHg7CisJdTMyIG1hc2s7CisJdTMyIHN0YXRlOworCXUzMiBjdHJsOwor
CisJbWFzayA9IFBVTklUX1BXUkdUX01BU0socHdfaWR4KTsKKwlzdGF0ZSA9IGVuYWJsZSA/IFBV
TklUX1BXUkdUX1BXUl9PTihwd19pZHgpIDoKKwkJCSBQVU5JVF9QV1JHVF9QV1JfR0FURShwd19p
ZHgpOworCisJdmx2X3B1bml0X2dldChkZXZfcHJpdik7CisKKyNkZWZpbmUgQ09ORCBcCisJKCh2
bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX1BXUkdUX1NUQVRVUykgJiBtYXNrKSA9
PSBzdGF0ZSkKKworCWlmIChDT05EKQorCQlnb3RvIG91dDsKKworCWN0cmwgPSB2bHZfcHVuaXRf
cmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX1BXUkdUX0NUUkwpOworCWN0cmwgJj0gfm1hc2s7CisJ
Y3RybCB8PSBzdGF0ZTsKKwl2bHZfcHVuaXRfd3JpdGUoZGV2X3ByaXYsIFBVTklUX1JFR19QV1JH
VF9DVFJMLCBjdHJsKTsKKworCWlmICh3YWl0X2ZvcihDT05ELCAxMDApKQorCQlEUk1fRVJST1Io
InRpbWVvdXQgc2V0dGluZyBwb3dlciB3ZWxsIHN0YXRlICUwOHggKCUwOHgpXG4iLAorCQkJICBz
dGF0ZSwKKwkJCSAgdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19QV1JHVF9DVFJM
KSk7CisKKyN1bmRlZiBDT05ECisKK291dDoKKwl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKK30K
Kworc3RhdGljIHZvaWQgdmx2X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKKwkJCQkgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwp
Cit7CisJdmx2X3NldF9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxsLCB0cnVlKTsKK30K
Kworc3RhdGljIHZvaWQgdmx2X3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCisJCQkJICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2Vs
bCkKK3sKKwl2bHZfc2V0X3Bvd2VyX3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIGZhbHNlKTsK
K30KKworc3RhdGljIGJvb2wgdmx2X3Bvd2VyX3dlbGxfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJf
d2VsbCkKK3sKKwlpbnQgcHdfaWR4ID0gcG93ZXJfd2VsbC0+ZGVzYy0+dmx2LmlkeDsKKwlib29s
IGVuYWJsZWQgPSBmYWxzZTsKKwl1MzIgbWFzazsKKwl1MzIgc3RhdGU7CisJdTMyIGN0cmw7CisK
KwltYXNrID0gUFVOSVRfUFdSR1RfTUFTSyhwd19pZHgpOworCWN0cmwgPSBQVU5JVF9QV1JHVF9Q
V1JfT04ocHdfaWR4KTsKKworCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOworCisJc3RhdGUgPSB2
bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX1BXUkdUX1NUQVRVUykgJiBtYXNrOwor
CS8qCisJICogV2Ugb25seSBldmVyIHNldCB0aGUgcG93ZXItb24gYW5kIHBvd2VyLWdhdGUgc3Rh
dGVzLCBhbnl0aGluZworCSAqIGVsc2UgaXMgdW5leHBlY3RlZC4KKwkgKi8KKwlXQVJOX09OKHN0
YXRlICE9IFBVTklUX1BXUkdUX1BXUl9PTihwd19pZHgpICYmCisJCXN0YXRlICE9IFBVTklUX1BX
UkdUX1BXUl9HQVRFKHB3X2lkeCkpOworCWlmIChzdGF0ZSA9PSBjdHJsKQorCQllbmFibGVkID0g
dHJ1ZTsKKworCS8qCisJICogQSB0cmFuc2llbnQgc3RhdGUgYXQgdGhpcyBwb2ludCB3b3VsZCBt
ZWFuIHNvbWUgdW5leHBlY3RlZCBwYXJ0eQorCSAqIGlzIHBva2luZyBhdCB0aGUgcG93ZXIgY29u
dHJvbHMgdG9vLgorCSAqLworCWN0cmwgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRf
UkVHX1BXUkdUX0NUUkwpICYgbWFzazsKKwlXQVJOX09OKGN0cmwgIT0gc3RhdGUpOworCisJdmx2
X3B1bml0X3B1dChkZXZfcHJpdik7CisKKwlyZXR1cm4gZW5hYmxlZDsKK30KKworc3RhdGljIHZv
aWQgdmx2X2luaXRfZGlzcGxheV9jbG9ja19nYXRpbmcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQoreworCXUzMiB2YWw7CisKKwkvKgorCSAqIE9uIGRyaXZlciBsb2FkLCBhIHBp
cGUgbWF5IGJlIGFjdGl2ZSBhbmQgZHJpdmluZyBhIERTSSBkaXNwbGF5LgorCSAqIFByZXNlcnZl
IERQT1VOSVRfQ0xPQ0tfR0FURV9ESVNBQkxFIHRvIGF2b2lkIHRoZSBwaXBlIGdldHRpbmcgc3R1
Y2sKKwkgKiAoYW5kIG5ldmVyIHJlY292ZXJpbmcpIGluIHRoaXMgY2FzZS4gaW50ZWxfZHNpX3Bv
c3RfZGlzYWJsZSgpIHdpbGwKKwkgKiBjbGVhciBpdCB3aGVuIHdlIHR1cm4gb2ZmIHRoZSBkaXNw
bGF5LgorCSAqLworCXZhbCA9IEk5MTVfUkVBRChEU1BDTEtfR0FURV9EKTsKKwl2YWwgJj0gRFBP
VU5JVF9DTE9DS19HQVRFX0RJU0FCTEU7CisJdmFsIHw9IFZSSFVOSVRfQ0xPQ0tfR0FURV9ESVNB
QkxFOworCUk5MTVfV1JJVEUoRFNQQ0xLX0dBVEVfRCwgdmFsKTsKKworCS8qCisJICogRGlzYWJs
ZSB0cmlja2xlIGZlZWQgYW5kIGVuYWJsZSBwbmQgZGVhZGxpbmUgY2FsY3VsYXRpb24KKwkgKi8K
KwlJOTE1X1dSSVRFKE1JX0FSQl9WTFYsIE1JX0FSQl9ESVNQTEFZX1RSSUNLTEVfRkVFRF9ESVNB
QkxFKTsKKwlJOTE1X1dSSVRFKENCUjFfVkxWLCAwKTsKKworCVdBUk5fT04oZGV2X3ByaXYtPnJh
d2Nsa19mcmVxID09IDApOworCisJSTkxNV9XUklURShSQVdDTEtfRlJFUV9WTFYsCisJCSAgIERJ
Vl9ST1VORF9DTE9TRVNUKGRldl9wcml2LT5yYXdjbGtfZnJlcSwgMTAwMCkpOworfQorCitzdGF0
aWMgdm9pZCB2bHZfZGlzcGxheV9wb3dlcl93ZWxsX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQoreworCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOworCWVudW0g
cGlwZSBwaXBlOworCisJLyoKKwkgKiBFbmFibGUgdGhlIENSSSBjbG9jayBzb3VyY2Ugc28gd2Ug
Y2FuIGdldCBhdCB0aGUKKwkgKiBkaXNwbGF5IGFuZCB0aGUgcmVmZXJlbmNlIGNsb2NrIGZvciBW
R0EKKwkgKiBob3RwbHVnIC8gbWFudWFsIGRldGVjdGlvbi4gU3VwcG9zZWRseSBEU0kgYWxzbwor
CSAqIG5lZWRzIHRoZSByZWYgY2xvY2sgdXAgYW5kIHJ1bm5pbmcuCisJICoKKwkgKiBDSFYgRFBM
TCBCL0MgaGF2ZSBzb21lIGlzc3VlcyBpZiBWR0EgbW9kZSBpcyBlbmFibGVkLgorCSAqLworCWZv
cl9lYWNoX3BpcGUoZGV2X3ByaXYsIHBpcGUpIHsKKwkJdTMyIHZhbCA9IEk5MTVfUkVBRChEUExM
KHBpcGUpKTsKKworCQl2YWwgfD0gRFBMTF9SRUZfQ0xLX0VOQUJMRV9WTFYgfCBEUExMX1ZHQV9N
T0RFX0RJUzsKKwkJaWYgKHBpcGUgIT0gUElQRV9BKQorCQkJdmFsIHw9IERQTExfSU5URUdSQVRF
RF9DUklfQ0xLX1ZMVjsKKworCQlJOTE1X1dSSVRFKERQTEwocGlwZSksIHZhbCk7CisJfQorCisJ
dmx2X2luaXRfZGlzcGxheV9jbG9ja19nYXRpbmcoZGV2X3ByaXYpOworCisJc3Bpbl9sb2NrX2ly
cSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKKwl2YWxsZXl2aWV3X2VuYWJsZV9kaXNwbGF5X2lycXMo
ZGV2X3ByaXYpOworCXNwaW5fdW5sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKKworCS8q
CisJICogRHVyaW5nIGRyaXZlciBpbml0aWFsaXphdGlvbi9yZXN1bWUgd2UgY2FuIGF2b2lkIHJl
c3RvcmluZyB0aGUKKwkgKiBwYXJ0IG9mIHRoZSBIVy9TVyBzdGF0ZSB0aGF0IHdpbGwgYmUgaW5p
dGVkIGFueXdheSBleHBsaWNpdGx5LgorCSAqLworCWlmIChkZXZfcHJpdi0+cG93ZXJfZG9tYWlu
cy5pbml0aWFsaXppbmcpCisJCXJldHVybjsKKworCWludGVsX2hwZF9pbml0KGRldl9wcml2KTsK
KworCS8qIFJlLWVuYWJsZSB0aGUgQURQQSwgaWYgd2UgaGF2ZSBvbmUgKi8KKwlmb3JfZWFjaF9p
bnRlbF9lbmNvZGVyKCZkZXZfcHJpdi0+ZHJtLCBlbmNvZGVyKSB7CisJCWlmIChlbmNvZGVyLT50
eXBlID09IElOVEVMX09VVFBVVF9BTkFMT0cpCisJCQlpbnRlbF9jcnRfcmVzZXQoJmVuY29kZXIt
PmJhc2UpOworCX0KKworCWk5MTVfcmVkaXNhYmxlX3ZnYV9wb3dlcl9vbihkZXZfcHJpdik7CisK
KwlpbnRlbF9wcHNfdW5sb2NrX3JlZ3Nfd2EoZGV2X3ByaXYpOworfQorCitzdGF0aWMgdm9pZCB2
bHZfZGlzcGxheV9wb3dlcl93ZWxsX2RlaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCit7CisJc3Bpbl9sb2NrX2lycSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKKwl2YWxsZXl2
aWV3X2Rpc2FibGVfZGlzcGxheV9pcnFzKGRldl9wcml2KTsKKwlzcGluX3VubG9ja19pcnEoJmRl
dl9wcml2LT5pcnFfbG9jayk7CisKKwkvKiBtYWtlIHN1cmUgd2UncmUgZG9uZSBwcm9jZXNzaW5n
IGRpc3BsYXkgaXJxcyAqLworCXN5bmNocm9uaXplX2lycShkZXZfcHJpdi0+ZHJtLmlycSk7CisK
KwlpbnRlbF9wb3dlcl9zZXF1ZW5jZXJfcmVzZXQoZGV2X3ByaXYpOworCisJLyogUHJldmVudCB1
cyBmcm9tIHJlLWVuYWJsaW5nIHBvbGxpbmcgb24gYWNjaWRlbnQgaW4gbGF0ZSBzdXNwZW5kICov
CisJaWYgKCFkZXZfcHJpdi0+ZHJtLmRldi0+cG93ZXIuaXNfc3VzcGVuZGVkKQorCQlpbnRlbF9o
cGRfcG9sbF9pbml0KGRldl9wcml2KTsKK30KKworc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfcG93
ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCQkg
IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCit7CisJdmx2X3NldF9wb3dlcl93
ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxsLCB0cnVlKTsKKworCXZsdl9kaXNwbGF5X3Bvd2VyX3dl
bGxfaW5pdChkZXZfcHJpdik7Cit9CisKK3N0YXRpYyB2b2lkIHZsdl9kaXNwbGF5X3Bvd2VyX3dl
bGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCSAgIHN0
cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCit7CisJdmx2X2Rpc3BsYXlfcG93ZXJf
d2VsbF9kZWluaXQoZGV2X3ByaXYpOworCisJdmx2X3NldF9wb3dlcl93ZWxsKGRldl9wcml2LCBw
b3dlcl93ZWxsLCBmYWxzZSk7Cit9CisKK3N0YXRpYyB2b2lkIHZsdl9kcGlvX2Ntbl9wb3dlcl93
ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCSAgIHN0
cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCit7CisJLyogc2luY2UgcmVmL2NyaSBj
bG9jayB3YXMgZW5hYmxlZCAqLworCXVkZWxheSgxKTsgLyogPjEwbnMgZm9yIGNtbnJlc2V0LCA+
MG5zIGZvciBzaWRlcmVzZXQgKi8KKworCXZsdl9zZXRfcG93ZXJfd2VsbChkZXZfcHJpdiwgcG93
ZXJfd2VsbCwgdHJ1ZSk7CisKKwkvKgorCSAqIEZyb20gVkxWMkEwX0RQX2VEUF9EUElPX2RyaXZl
cl92Ymlvc19ub3Rlc18xMC5kb2N4IC0KKwkgKiAgNi4JRGUtYXNzZXJ0IGNtbl9yZXNldC9zaWRl
X3Jlc2V0LiBTYW1lIGFzIFZMViBYMC4KKwkgKiAgIGEuCUdVbml0IDB4MjExMCBiaXRbMF0gc2V0
IHRvIDEgKGRlZiAwKQorCSAqICAgYi4JVGhlIG90aGVyIGJpdHMgc3VjaCBhcyBzZnIgc2V0dGlu
Z3MgLyBtb2Rlc2VsIG1heSBhbGwKKwkgKgliZSBzZXQgdG8gMC4KKwkgKgorCSAqIFRoaXMgc2hv
dWxkIG9ubHkgYmUgZG9uZSBvbiBpbml0IGFuZCByZXN1bWUgZnJvbSBTMyB3aXRoCisJICogYm90
aCBQTExzIGRpc2FibGVkLCBvciB3ZSByaXNrIGxvc2luZyBEUElPIGFuZCBQTEwKKwkgKiBzeW5j
aHJvbml6YXRpb24uCisJICovCisJSTkxNV9XUklURShEUElPX0NUTCwgSTkxNV9SRUFEKERQSU9f
Q1RMKSB8IERQSU9fQ01OUlNUKTsKK30KKworc3RhdGljIHZvaWQgdmx2X2RwaW9fY21uX3Bvd2Vy
X3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCSAg
ICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQoreworCWVudW0gcGlwZSBwaXBl
OworCisJZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkKKwkJYXNzZXJ0X3BsbF9kaXNhYmxl
ZChkZXZfcHJpdiwgcGlwZSk7CisKKwkvKiBBc3NlcnQgY29tbW9uIHJlc2V0ICovCisJSTkxNV9X
UklURShEUElPX0NUTCwgSTkxNV9SRUFEKERQSU9fQ1RMKSAmIH5EUElPX0NNTlJTVCk7CisKKwl2
bHZfc2V0X3Bvd2VyX3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIGZhbHNlKTsKK30KKworI2Rl
ZmluZSBQT1dFUl9ET01BSU5fTUFTSyAoR0VOTUFTS19VTEwoUE9XRVJfRE9NQUlOX05VTSAtIDEs
IDApKQorCisjZGVmaW5lIEJJVFNfU0VUKHZhbCwgYml0cykgKCgodmFsKSAmIChiaXRzKSkgPT0g
KGJpdHMpKQorCitzdGF0aWMgdm9pZCBhc3NlcnRfY2h2X3BoeV9zdGF0dXMoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQoreworCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKmNtbl9i
YyA9CisJCWxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBWTFZfRElTUF9QV19EUElPX0NNTl9C
Qyk7CisJc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqY21uX2QgPQorCQlsb29rdXBfcG93ZXJfd2Vs
bChkZXZfcHJpdiwgQ0hWX0RJU1BfUFdfRFBJT19DTU5fRCk7CisJdTMyIHBoeV9jb250cm9sID0g
ZGV2X3ByaXYtPmNodl9waHlfY29udHJvbDsKKwl1MzIgcGh5X3N0YXR1cyA9IDA7CisJdTMyIHBo
eV9zdGF0dXNfbWFzayA9IDB4ZmZmZmZmZmY7CisKKwkvKgorCSAqIFRoZSBCSU9TIGNhbiBsZWF2
ZSB0aGUgUEhZIGlzIHNvbWUgd2VpcmQgc3RhdGUKKwkgKiB3aGVyZSBpdCBkb2Vzbid0IGZ1bGx5
IHBvd2VyIGRvd24gc29tZSBwYXJ0cy4KKwkgKiBEaXNhYmxlIHRoZSBhc3NlcnRzIHVudGlsIHRo
ZSBQSFkgaGFzIGJlZW4gZnVsbHkKKwkgKiByZXNldCAoaWUuIHRoZSBwb3dlciB3ZWxsIGhhcyBi
ZWVuIGRpc2FibGVkIGF0CisJICogbGVhc3Qgb25jZSkuCisJICovCisJaWYgKCFkZXZfcHJpdi0+
Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkwXSkKKwkJcGh5X3N0YXR1c19tYXNrICY9IH4oUEhZX1NU
QVRVU19DTU5fTERPKERQSU9fUEhZMCwgRFBJT19DSDApIHwKKwkJCQkgICAgIFBIWV9TVEFUVVNf
U1BMSU5FX0xETyhEUElPX1BIWTAsIERQSU9fQ0gwLCAwKSB8CisJCQkJICAgICBQSFlfU1RBVFVT
X1NQTElORV9MRE8oRFBJT19QSFkwLCBEUElPX0NIMCwgMSkgfAorCQkJCSAgICAgUEhZX1NUQVRV
U19DTU5fTERPKERQSU9fUEhZMCwgRFBJT19DSDEpIHwKKwkJCQkgICAgIFBIWV9TVEFUVVNfU1BM
SU5FX0xETyhEUElPX1BIWTAsIERQSU9fQ0gxLCAwKSB8CisJCQkJICAgICBQSFlfU1RBVFVTX1NQ
TElORV9MRE8oRFBJT19QSFkwLCBEUElPX0NIMSwgMSkpOworCisJaWYgKCFkZXZfcHJpdi0+Y2h2
X3BoeV9hc3NlcnRbRFBJT19QSFkxXSkKKwkJcGh5X3N0YXR1c19tYXNrICY9IH4oUEhZX1NUQVRV
U19DTU5fTERPKERQSU9fUEhZMSwgRFBJT19DSDApIHwKKwkJCQkgICAgIFBIWV9TVEFUVVNfU1BM
SU5FX0xETyhEUElPX1BIWTEsIERQSU9fQ0gwLCAwKSB8CisJCQkJICAgICBQSFlfU1RBVFVTX1NQ
TElORV9MRE8oRFBJT19QSFkxLCBEUElPX0NIMCwgMSkpOworCisJaWYgKGNtbl9iYy0+ZGVzYy0+
b3BzLT5pc19lbmFibGVkKGRldl9wcml2LCBjbW5fYmMpKSB7CisJCXBoeV9zdGF0dXMgfD0gUEhZ
X1BPV0VSR09PRChEUElPX1BIWTApOworCisJCS8qIHRoaXMgYXNzdW1lcyBvdmVycmlkZSBpcyBv
bmx5IHVzZWQgdG8gZW5hYmxlIGxhbmVzICovCisJCWlmICgocGh5X2NvbnRyb2wgJiBQSFlfQ0hf
UE9XRVJfRE9XTl9PVlJEX0VOKERQSU9fUEhZMCwgRFBJT19DSDApKSA9PSAwKQorCQkJcGh5X2Nv
bnRyb2wgfD0gUEhZX0NIX1BPV0VSX0RPV05fT1ZSRCgweGYsIERQSU9fUEhZMCwgRFBJT19DSDAp
OworCisJCWlmICgocGh5X2NvbnRyb2wgJiBQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEX0VOKERQSU9f
UEhZMCwgRFBJT19DSDEpKSA9PSAwKQorCQkJcGh5X2NvbnRyb2wgfD0gUEhZX0NIX1BPV0VSX0RP
V05fT1ZSRCgweGYsIERQSU9fUEhZMCwgRFBJT19DSDEpOworCisJCS8qIENMMSBpcyBvbiB3aGVu
ZXZlciBhbnl0aGluZyBpcyBvbiBpbiBlaXRoZXIgY2hhbm5lbCAqLworCQlpZiAoQklUU19TRVQo
cGh5X2NvbnRyb2wsCisJCQkgICAgIFBIWV9DSF9QT1dFUl9ET1dOX09WUkQoMHhmLCBEUElPX1BI
WTAsIERQSU9fQ0gwKSB8CisJCQkgICAgIFBIWV9DSF9QT1dFUl9ET1dOX09WUkQoMHhmLCBEUElP
X1BIWTAsIERQSU9fQ0gxKSkpCisJCQlwaHlfc3RhdHVzIHw9IFBIWV9TVEFUVVNfQ01OX0xETyhE
UElPX1BIWTAsIERQSU9fQ0gwKTsKKworCQkvKgorCQkgKiBUaGUgRFBMTEIgY2hlY2sgYWNjb3Vu
dHMgZm9yIHRoZSBwaXBlIEIgKyBwb3J0IEEgdXNhZ2UKKwkJICogd2l0aCBDTDIgcG93ZXJlZCB1
cCBidXQgYWxsIHRoZSBsYW5lcyBpbiB0aGUgc2Vjb25kIGNoYW5uZWwKKwkJICogcG93ZXJlZCBk
b3duLgorCQkgKi8KKwkJaWYgKEJJVFNfU0VUKHBoeV9jb250cm9sLAorCQkJICAgICBQSFlfQ0hf
UE9XRVJfRE9XTl9PVlJEKDB4ZiwgRFBJT19QSFkwLCBEUElPX0NIMSkpICYmCisJCSAgICAoSTkx
NV9SRUFEKERQTEwoUElQRV9CKSkgJiBEUExMX1ZDT19FTkFCTEUpID09IDApCisJCQlwaHlfc3Rh
dHVzIHw9IFBIWV9TVEFUVVNfQ01OX0xETyhEUElPX1BIWTAsIERQSU9fQ0gxKTsKKworCQlpZiAo
QklUU19TRVQocGh5X2NvbnRyb2wsCisJCQkgICAgIFBIWV9DSF9QT1dFUl9ET1dOX09WUkQoMHgz
LCBEUElPX1BIWTAsIERQSU9fQ0gwKSkpCisJCQlwaHlfc3RhdHVzIHw9IFBIWV9TVEFUVVNfU1BM
SU5FX0xETyhEUElPX1BIWTAsIERQSU9fQ0gwLCAwKTsKKwkJaWYgKEJJVFNfU0VUKHBoeV9jb250
cm9sLAorCQkJICAgICBQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEKDB4YywgRFBJT19QSFkwLCBEUElP
X0NIMCkpKQorCQkJcGh5X3N0YXR1cyB8PSBQSFlfU1RBVFVTX1NQTElORV9MRE8oRFBJT19QSFkw
LCBEUElPX0NIMCwgMSk7CisKKwkJaWYgKEJJVFNfU0VUKHBoeV9jb250cm9sLAorCQkJICAgICBQ
SFlfQ0hfUE9XRVJfRE9XTl9PVlJEKDB4MywgRFBJT19QSFkwLCBEUElPX0NIMSkpKQorCQkJcGh5
X3N0YXR1cyB8PSBQSFlfU1RBVFVTX1NQTElORV9MRE8oRFBJT19QSFkwLCBEUElPX0NIMSwgMCk7
CisJCWlmIChCSVRTX1NFVChwaHlfY29udHJvbCwKKwkJCSAgICAgUEhZX0NIX1BPV0VSX0RPV05f
T1ZSRCgweGMsIERQSU9fUEhZMCwgRFBJT19DSDEpKSkKKwkJCXBoeV9zdGF0dXMgfD0gUEhZX1NU
QVRVU19TUExJTkVfTERPKERQSU9fUEhZMCwgRFBJT19DSDEsIDEpOworCX0KKworCWlmIChjbW5f
ZC0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9wcml2LCBjbW5fZCkpIHsKKwkJcGh5X3N0YXR1
cyB8PSBQSFlfUE9XRVJHT09EKERQSU9fUEhZMSk7CisKKwkJLyogdGhpcyBhc3N1bWVzIG92ZXJy
aWRlIGlzIG9ubHkgdXNlZCB0byBlbmFibGUgbGFuZXMgKi8KKwkJaWYgKChwaHlfY29udHJvbCAm
IFBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4oRFBJT19QSFkxLCBEUElPX0NIMCkpID09IDApCisJ
CQlwaHlfY29udHJvbCB8PSBQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEKDB4ZiwgRFBJT19QSFkxLCBE
UElPX0NIMCk7CisKKwkJaWYgKEJJVFNfU0VUKHBoeV9jb250cm9sLAorCQkJICAgICBQSFlfQ0hf
UE9XRVJfRE9XTl9PVlJEKDB4ZiwgRFBJT19QSFkxLCBEUElPX0NIMCkpKQorCQkJcGh5X3N0YXR1
cyB8PSBQSFlfU1RBVFVTX0NNTl9MRE8oRFBJT19QSFkxLCBEUElPX0NIMCk7CisKKwkJaWYgKEJJ
VFNfU0VUKHBoeV9jb250cm9sLAorCQkJICAgICBQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEKDB4Mywg
RFBJT19QSFkxLCBEUElPX0NIMCkpKQorCQkJcGh5X3N0YXR1cyB8PSBQSFlfU1RBVFVTX1NQTElO
RV9MRE8oRFBJT19QSFkxLCBEUElPX0NIMCwgMCk7CisJCWlmIChCSVRTX1NFVChwaHlfY29udHJv
bCwKKwkJCSAgICAgUEhZX0NIX1BPV0VSX0RPV05fT1ZSRCgweGMsIERQSU9fUEhZMSwgRFBJT19D
SDApKSkKKwkJCXBoeV9zdGF0dXMgfD0gUEhZX1NUQVRVU19TUExJTkVfTERPKERQSU9fUEhZMSwg
RFBJT19DSDAsIDEpOworCX0KKworCXBoeV9zdGF0dXMgJj0gcGh5X3N0YXR1c19tYXNrOworCisJ
LyoKKwkgKiBUaGUgUEhZIG1heSBiZSBidXN5IHdpdGggc29tZSBpbml0aWFsIGNhbGlicmF0aW9u
IGFuZCB3aGF0bm90LAorCSAqIHNvIHRoZSBwb3dlciBzdGF0ZSBjYW4gdGFrZSBhIHdoaWxlIHRv
IGFjdHVhbGx5IGNoYW5nZS4KKwkgKi8KKwlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0ZXIoJmRl
dl9wcml2LT51bmNvcmUsCisJCQkJICAgIERJU1BMQVlfUEhZX1NUQVRVUywKKwkJCQkgICAgcGh5
X3N0YXR1c19tYXNrLAorCQkJCSAgICBwaHlfc3RhdHVzLAorCQkJCSAgICAxMCkpCisJCURSTV9F
UlJPUigiVW5leHBlY3RlZCBQSFlfU1RBVFVTIDB4JTA4eCwgZXhwZWN0ZWQgMHglMDh4IChQSFlf
Q09OVFJPTD0weCUwOHgpXG4iLAorCQkJICBJOTE1X1JFQUQoRElTUExBWV9QSFlfU1RBVFVTKSAm
IHBoeV9zdGF0dXNfbWFzaywKKwkJCSAgIHBoeV9zdGF0dXMsIGRldl9wcml2LT5jaHZfcGh5X2Nv
bnRyb2wpOworfQorCisjdW5kZWYgQklUU19TRVQKKworc3RhdGljIHZvaWQgY2h2X2RwaW9fY21u
X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJ
CQkJICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKK3sKKwllbnVtIGRwaW9f
cGh5IHBoeTsKKwllbnVtIHBpcGUgcGlwZTsKKwl1MzIgdG1wOworCisJV0FSTl9PTl9PTkNFKHBv
d2VyX3dlbGwtPmRlc2MtPmlkICE9IFZMVl9ESVNQX1BXX0RQSU9fQ01OX0JDICYmCisJCSAgICAg
cG93ZXJfd2VsbC0+ZGVzYy0+aWQgIT0gQ0hWX0RJU1BfUFdfRFBJT19DTU5fRCk7CisKKwlpZiAo
cG93ZXJfd2VsbC0+ZGVzYy0+aWQgPT0gVkxWX0RJU1BfUFdfRFBJT19DTU5fQkMpIHsKKwkJcGlw
ZSA9IFBJUEVfQTsKKwkJcGh5ID0gRFBJT19QSFkwOworCX0gZWxzZSB7CisJCXBpcGUgPSBQSVBF
X0M7CisJCXBoeSA9IERQSU9fUEhZMTsKKwl9CisKKwkvKiBzaW5jZSByZWYvY3JpIGNsb2NrIHdh
cyBlbmFibGVkICovCisJdWRlbGF5KDEpOyAvKiA+MTBucyBmb3IgY21ucmVzZXQsID4wbnMgZm9y
IHNpZGVyZXNldCAqLworCXZsdl9zZXRfcG93ZXJfd2VsbChkZXZfcHJpdiwgcG93ZXJfd2VsbCwg
dHJ1ZSk7CisKKwkvKiBQb2xsIGZvciBwaHlwd3Jnb29kIHNpZ25hbCAqLworCWlmIChpbnRlbF93
YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKKwkJCQkgICAgRElTUExBWV9QSFlf
U1RBVFVTLAorCQkJCSAgICBQSFlfUE9XRVJHT09EKHBoeSksCisJCQkJICAgIFBIWV9QT1dFUkdP
T0QocGh5KSwKKwkJCQkgICAgMSkpCisJCURSTV9FUlJPUigiRGlzcGxheSBQSFkgJWQgaXMgbm90
IHBvd2VyIHVwXG4iLCBwaHkpOworCisJdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKKworCS8qIEVu
YWJsZSBkeW5hbWljIHBvd2VyIGRvd24gKi8KKwl0bXAgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2
LCBwaXBlLCBDSFZfQ01OX0RXMjgpOworCXRtcCB8PSBEUElPX0RZTlBXUkRPV05FTl9DSDAgfCBE
UElPX0NMMVBPV0VSRE9XTkVOIHwKKwkJRFBJT19TVVNfQ0xLX0NPTkZJR19HQVRFX0NMS1JFUTsK
Kwl2bHZfZHBpb193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX0NNTl9EVzI4LCB0bXApOworCisJ
aWYgKHBvd2VyX3dlbGwtPmRlc2MtPmlkID09IFZMVl9ESVNQX1BXX0RQSU9fQ01OX0JDKSB7CisJ
CXRtcCA9IHZsdl9kcGlvX3JlYWQoZGV2X3ByaXYsIHBpcGUsIF9DSFZfQ01OX0RXNl9DSDEpOwor
CQl0bXAgfD0gRFBJT19EWU5QV1JET1dORU5fQ0gxOworCQl2bHZfZHBpb193cml0ZShkZXZfcHJp
diwgcGlwZSwgX0NIVl9DTU5fRFc2X0NIMSwgdG1wKTsKKwl9IGVsc2UgeworCQkvKgorCQkgKiBG
b3JjZSB0aGUgbm9uLWV4aXN0aW5nIENMMiBvZmYuIEJYVCBkb2VzIHRoaXMKKwkJICogdG9vLCBz
byBtYXliZSBpdCBzYXZlcyBzb21lIHBvd2VyIGV2ZW4gdGhvdWdoCisJCSAqIENMMiBkb2Vzbid0
IGV4aXN0PworCQkgKi8KKwkJdG1wID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgQ0hW
X0NNTl9EVzMwKTsKKwkJdG1wIHw9IERQSU9fQ0wyX0xET0ZVU0VfUFdSRU5COworCQl2bHZfZHBp
b193cml0ZShkZXZfcHJpdiwgcGlwZSwgQ0hWX0NNTl9EVzMwLCB0bXApOworCX0KKworCXZsdl9k
cGlvX3B1dChkZXZfcHJpdik7CisKKwlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9IFBIWV9D
T01fTEFORV9SRVNFVF9ERUFTU0VSVChwaHkpOworCUk5MTVfV1JJVEUoRElTUExBWV9QSFlfQ09O
VFJPTCwgZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCk7CisKKwlEUk1fREVCVUdfS01TKCJFbmFi
bGVkIERQSU8gUEhZJWQgKFBIWV9DT05UUk9MPTB4JTA4eClcbiIsCisJCSAgICAgIHBoeSwgZGV2
X3ByaXYtPmNodl9waHlfY29udHJvbCk7CisKKwlhc3NlcnRfY2h2X3BoeV9zdGF0dXMoZGV2X3By
aXYpOworfQorCitzdGF0aWMgdm9pZCBjaHZfZHBpb19jbW5fcG93ZXJfd2VsbF9kaXNhYmxlKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJCQkJICAgIHN0cnVjdCBpOTE1X3Bv
d2VyX3dlbGwgKnBvd2VyX3dlbGwpCit7CisJZW51bSBkcGlvX3BoeSBwaHk7CisKKwlXQVJOX09O
X09OQ0UocG93ZXJfd2VsbC0+ZGVzYy0+aWQgIT0gVkxWX0RJU1BfUFdfRFBJT19DTU5fQkMgJiYK
KwkJICAgICBwb3dlcl93ZWxsLT5kZXNjLT5pZCAhPSBDSFZfRElTUF9QV19EUElPX0NNTl9EKTsK
KworCWlmIChwb3dlcl93ZWxsLT5kZXNjLT5pZCA9PSBWTFZfRElTUF9QV19EUElPX0NNTl9CQykg
eworCQlwaHkgPSBEUElPX1BIWTA7CisJCWFzc2VydF9wbGxfZGlzYWJsZWQoZGV2X3ByaXYsIFBJ
UEVfQSk7CisJCWFzc2VydF9wbGxfZGlzYWJsZWQoZGV2X3ByaXYsIFBJUEVfQik7CisJfSBlbHNl
IHsKKwkJcGh5ID0gRFBJT19QSFkxOworCQlhc3NlcnRfcGxsX2Rpc2FibGVkKGRldl9wcml2LCBQ
SVBFX0MpOworCX0KKworCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgJj0gflBIWV9DT01fTEFO
RV9SRVNFVF9ERUFTU0VSVChwaHkpOworCUk5MTVfV1JJVEUoRElTUExBWV9QSFlfQ09OVFJPTCwg
ZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCk7CisKKwl2bHZfc2V0X3Bvd2VyX3dlbGwoZGV2X3By
aXYsIHBvd2VyX3dlbGwsIGZhbHNlKTsKKworCURSTV9ERUJVR19LTVMoIkRpc2FibGVkIERQSU8g
UEhZJWQgKFBIWV9DT05UUk9MPTB4JTA4eClcbiIsCisJCSAgICAgIHBoeSwgZGV2X3ByaXYtPmNo
dl9waHlfY29udHJvbCk7CisKKwkvKiBQSFkgaXMgZnVsbHkgcmVzZXQgbm93LCBzbyB3ZSBjYW4g
ZW5hYmxlIHRoZSBQSFkgc3RhdGUgYXNzZXJ0cyAqLworCWRldl9wcml2LT5jaHZfcGh5X2Fzc2Vy
dFtwaHldID0gdHJ1ZTsKKworCWFzc2VydF9jaHZfcGh5X3N0YXR1cyhkZXZfcHJpdik7Cit9CisK
K3N0YXRpYyB2b2lkIGFzc2VydF9jaHZfcGh5X3Bvd2VyZ2F0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIGVudW0gZHBpb19waHkgcGh5LAorCQkJCSAgICAgZW51bSBkcGlvX2No
YW5uZWwgY2gsIGJvb2wgb3ZlcnJpZGUsIHVuc2lnbmVkIGludCBtYXNrKQoreworCWVudW0gcGlw
ZSBwaXBlID0gcGh5ID09IERQSU9fUEhZMCA/IFBJUEVfQSA6IFBJUEVfQzsKKwl1MzIgcmVnLCB2
YWwsIGV4cGVjdGVkLCBhY3R1YWw7CisKKwkvKgorCSAqIFRoZSBCSU9TIGNhbiBsZWF2ZSB0aGUg
UEhZIGlzIHNvbWUgd2VpcmQgc3RhdGUKKwkgKiB3aGVyZSBpdCBkb2Vzbid0IGZ1bGx5IHBvd2Vy
IGRvd24gc29tZSBwYXJ0cy4KKwkgKiBEaXNhYmxlIHRoZSBhc3NlcnRzIHVudGlsIHRoZSBQSFkg
aGFzIGJlZW4gZnVsbHkKKwkgKiByZXNldCAoaWUuIHRoZSBwb3dlciB3ZWxsIGhhcyBiZWVuIGRp
c2FibGVkIGF0CisJICogbGVhc3Qgb25jZSkuCisJICovCisJaWYgKCFkZXZfcHJpdi0+Y2h2X3Bo
eV9hc3NlcnRbcGh5XSkKKwkJcmV0dXJuOworCisJaWYgKGNoID09IERQSU9fQ0gwKQorCQlyZWcg
PSBfQ0hWX0NNTl9EVzBfQ0gwOworCWVsc2UKKwkJcmVnID0gX0NIVl9DTU5fRFc2X0NIMTsKKwor
CXZsdl9kcGlvX2dldChkZXZfcHJpdik7CisJdmFsID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwg
cGlwZSwgcmVnKTsKKwl2bHZfZHBpb19wdXQoZGV2X3ByaXYpOworCisJLyoKKwkgKiBUaGlzIGFz
c3VtZXMgIW92ZXJyaWRlIGlzIG9ubHkgdXNlZCB3aGVuIHRoZSBwb3J0IGlzIGRpc2FibGVkLgor
CSAqIEFsbCBsYW5lcyBzaG91bGQgcG93ZXIgZG93biBldmVuIHdpdGhvdXQgdGhlIG92ZXJyaWRl
IHdoZW4KKwkgKiB0aGUgcG9ydCBpcyBkaXNhYmxlZC4KKwkgKi8KKwlpZiAoIW92ZXJyaWRlIHx8
IG1hc2sgPT0gMHhmKSB7CisJCWV4cGVjdGVkID0gRFBJT19BTExETF9QT1dFUkRPV04gfCBEUElP
X0FOWURMX1BPV0VSRE9XTjsKKwkJLyoKKwkJICogSWYgQ0gxIGNvbW1vbiBsYW5lIGlzIG5vdCBh
Y3RpdmUgYW55bW9yZQorCQkgKiAoZWcuIGZvciBwaXBlIEIgRFBMTCkgdGhlIGVudGlyZSBjaGFu
bmVsIHdpbGwKKwkJICogc2h1dCBkb3duLCB3aGljaCBjYXVzZXMgdGhlIGNvbW1vbiBsYW5lIHJl
Z2lzdGVycworCQkgKiB0byByZWFkIGFzIDAuIFRoYXQgbWVhbnMgd2UgY2FuJ3QgYWN0dWFsbHkg
Y2hlY2sKKwkJICogdGhlIGxhbmUgcG93ZXIgZG93biBzdGF0dXMgYml0cywgYnV0IGFzIHRoZSBl
bnRpcmUKKwkJICogcmVnaXN0ZXIgcmVhZHMgYXMgMCBpdCdzIGEgZ29vZCBpbmRpY2F0aW9uIHRo
YXQgdGhlCisJCSAqIGNoYW5uZWwgaXMgaW5kZWVkIGVudGlyZWx5IHBvd2VyZWQgZG93bi4KKwkJ
ICovCisJCWlmIChjaCA9PSBEUElPX0NIMSAmJiB2YWwgPT0gMCkKKwkJCWV4cGVjdGVkID0gMDsK
Kwl9IGVsc2UgaWYgKG1hc2sgIT0gMHgwKSB7CisJCWV4cGVjdGVkID0gRFBJT19BTllETF9QT1dF
UkRPV047CisJfSBlbHNlIHsKKwkJZXhwZWN0ZWQgPSAwOworCX0KKworCWlmIChjaCA9PSBEUElP
X0NIMCkKKwkJYWN0dWFsID0gdmFsID4+IERQSU9fQU5ZRExfUE9XRVJET1dOX1NISUZUX0NIMDsK
KwllbHNlCisJCWFjdHVhbCA9IHZhbCA+PiBEUElPX0FOWURMX1BPV0VSRE9XTl9TSElGVF9DSDE7
CisJYWN0dWFsICY9IERQSU9fQUxMRExfUE9XRVJET1dOIHwgRFBJT19BTllETF9QT1dFUkRPV047
CisKKwlXQVJOKGFjdHVhbCAhPSBleHBlY3RlZCwKKwkgICAgICJVbmV4cGVjdGVkIERQSU8gbGFu
ZSBwb3dlciBkb3duOiBhbGwgJWQsIGFueSAlZC4gRXhwZWN0ZWQ6IGFsbCAlZCwgYW55ICVkLiAo
MHgleCA9IDB4JTA4eClcbiIsCisJICAgICAhIShhY3R1YWwgJiBEUElPX0FMTERMX1BPV0VSRE9X
TiksICEhKGFjdHVhbCAmIERQSU9fQU5ZRExfUE9XRVJET1dOKSwKKwkgICAgICEhKGV4cGVjdGVk
ICYgRFBJT19BTExETF9QT1dFUkRPV04pLCAhIShleHBlY3RlZCAmIERQSU9fQU5ZRExfUE9XRVJE
T1dOKSwKKwkgICAgIHJlZywgdmFsKTsKK30KKworYm9vbCBjaHZfcGh5X3Bvd2VyZ2F0ZV9jaChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsIGVudW0gZHBpb19waHkgcGh5LAorCQkJ
ICBlbnVtIGRwaW9fY2hhbm5lbCBjaCwgYm9vbCBvdmVycmlkZSkKK3sKKwlzdHJ1Y3QgaTkxNV9w
b3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwor
CWJvb2wgd2FzX292ZXJyaWRlOworCisJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7
CisKKwl3YXNfb3ZlcnJpZGUgPSBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sICYgUEhZX0NIX1BP
V0VSX0RPV05fT1ZSRF9FTihwaHksIGNoKTsKKworCWlmIChvdmVycmlkZSA9PSB3YXNfb3ZlcnJp
ZGUpCisJCWdvdG8gb3V0OworCisJaWYgKG92ZXJyaWRlKQorCQlkZXZfcHJpdi0+Y2h2X3BoeV9j
b250cm9sIHw9IFBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4ocGh5LCBjaCk7CisJZWxzZQorCQlk
ZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sICY9IH5QSFlfQ0hfUE9XRVJfRE9XTl9PVlJEX0VOKHBo
eSwgY2gpOworCisJSTkxNV9XUklURShESVNQTEFZX1BIWV9DT05UUk9MLCBkZXZfcHJpdi0+Y2h2
X3BoeV9jb250cm9sKTsKKworCURSTV9ERUJVR19LTVMoIlBvd2VyIGdhdGluZyBEUElPIFBIWSVk
IENIJWQgKERQSU9fUEhZX0NPTlRST0w9MHglMDh4KVxuIiwKKwkJICAgICAgcGh5LCBjaCwgZGV2
X3ByaXYtPmNodl9waHlfY29udHJvbCk7CisKKwlhc3NlcnRfY2h2X3BoeV9zdGF0dXMoZGV2X3By
aXYpOworCitvdXQ6CisJbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKKworCXJl
dHVybiB3YXNfb3ZlcnJpZGU7Cit9CisKK3ZvaWQgY2h2X3BoeV9wb3dlcmdhdGVfbGFuZXMoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCisJCQkgICAgIGJvb2wgb3ZlcnJpZGUsIHVuc2ln
bmVkIGludCBtYXNrKQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRv
X2k5MTUoZW5jb2Rlci0+YmFzZS5kZXYpOworCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBv
d2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7CisJZW51bSBkcGlvX3BoeSBw
aHkgPSB2bHZfZHBvcnRfdG9fcGh5KGVuY190b19kaWdfcG9ydCgmZW5jb2Rlci0+YmFzZSkpOwor
CWVudW0gZHBpb19jaGFubmVsIGNoID0gdmx2X2Rwb3J0X3RvX2NoYW5uZWwoZW5jX3RvX2RpZ19w
b3J0KCZlbmNvZGVyLT5iYXNlKSk7CisKKwltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2Nr
KTsKKworCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgJj0gflBIWV9DSF9QT1dFUl9ET1dOX09W
UkQoMHhmLCBwaHksIGNoKTsKKwlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9IFBIWV9DSF9Q
T1dFUl9ET1dOX09WUkQobWFzaywgcGh5LCBjaCk7CisKKwlpZiAob3ZlcnJpZGUpCisJCWRldl9w
cml2LT5jaHZfcGh5X2NvbnRyb2wgfD0gUEhZX0NIX1BPV0VSX0RPV05fT1ZSRF9FTihwaHksIGNo
KTsKKwllbHNlCisJCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgJj0gflBIWV9DSF9QT1dFUl9E
T1dOX09WUkRfRU4ocGh5LCBjaCk7CisKKwlJOTE1X1dSSVRFKERJU1BMQVlfUEhZX0NPTlRST0ws
IGRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wpOworCisJRFJNX0RFQlVHX0tNUygiUG93ZXIgZ2F0
aW5nIERQSU8gUEhZJWQgQ0glZCBsYW5lcyAweCV4IChQSFlfQ09OVFJPTD0weCUwOHgpXG4iLAor
CQkgICAgICBwaHksIGNoLCBtYXNrLCBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sKTsKKworCWFz
c2VydF9jaHZfcGh5X3N0YXR1cyhkZXZfcHJpdik7CisKKwlhc3NlcnRfY2h2X3BoeV9wb3dlcmdh
dGUoZGV2X3ByaXYsIHBoeSwgY2gsIG92ZXJyaWRlLCBtYXNrKTsKKworCW11dGV4X3VubG9jaygm
cG93ZXJfZG9tYWlucy0+bG9jayk7Cit9CisKK3N0YXRpYyBib29sIGNodl9waXBlX3Bvd2VyX3dl
bGxfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCXN0cnVj
dCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCit7CisJZW51bSBwaXBlIHBpcGUgPSBQSVBF
X0E7CisJYm9vbCBlbmFibGVkOworCXUzMiBzdGF0ZSwgY3RybDsKKworCXZsdl9wdW5pdF9nZXQo
ZGV2X3ByaXYpOworCisJc3RhdGUgPSB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVH
X0RTUFNTUE0pICYgRFBfU1NTX01BU0socGlwZSk7CisJLyoKKwkgKiBXZSBvbmx5IGV2ZXIgc2V0
IHRoZSBwb3dlci1vbiBhbmQgcG93ZXItZ2F0ZSBzdGF0ZXMsIGFueXRoaW5nCisJICogZWxzZSBp
cyB1bmV4cGVjdGVkLgorCSAqLworCVdBUk5fT04oc3RhdGUgIT0gRFBfU1NTX1BXUl9PTihwaXBl
KSAmJiBzdGF0ZSAhPSBEUF9TU1NfUFdSX0dBVEUocGlwZSkpOworCWVuYWJsZWQgPSBzdGF0ZSA9
PSBEUF9TU1NfUFdSX09OKHBpcGUpOworCisJLyoKKwkgKiBBIHRyYW5zaWVudCBzdGF0ZSBhdCB0
aGlzIHBvaW50IHdvdWxkIG1lYW4gc29tZSB1bmV4cGVjdGVkIHBhcnR5CisJICogaXMgcG9raW5n
IGF0IHRoZSBwb3dlciBjb250cm9scyB0b28uCisJICovCisJY3RybCA9IHZsdl9wdW5pdF9yZWFk
KGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSkgJiBEUF9TU0NfTUFTSyhwaXBlKTsKKwlXQVJO
X09OKGN0cmwgPDwgMTYgIT0gc3RhdGUpOworCisJdmx2X3B1bml0X3B1dChkZXZfcHJpdik7CisK
KwlyZXR1cm4gZW5hYmxlZDsKK30KKworc3RhdGljIHZvaWQgY2h2X3NldF9waXBlX3Bvd2VyX3dl
bGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAgICBzdHJ1Y3QgaTkx
NV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsLAorCQkJCSAgICBib29sIGVuYWJsZSkKK3sKKwllbnVt
IHBpcGUgcGlwZSA9IFBJUEVfQTsKKwl1MzIgc3RhdGU7CisJdTMyIGN0cmw7CisKKwlzdGF0ZSA9
IGVuYWJsZSA/IERQX1NTU19QV1JfT04ocGlwZSkgOiBEUF9TU1NfUFdSX0dBVEUocGlwZSk7CisK
Kwl2bHZfcHVuaXRfZ2V0KGRldl9wcml2KTsKKworI2RlZmluZSBDT05EIFwKKwkoKHZsdl9wdW5p
dF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSkgJiBEUF9TU1NfTUFTSyhwaXBlKSkg
PT0gc3RhdGUpCisKKwlpZiAoQ09ORCkKKwkJZ290byBvdXQ7CisKKwljdHJsID0gdmx2X3B1bml0
X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19EU1BTU1BNKTsKKwljdHJsICY9IH5EUF9TU0NfTUFT
SyhwaXBlKTsKKwljdHJsIHw9IGVuYWJsZSA/IERQX1NTQ19QV1JfT04ocGlwZSkgOiBEUF9TU0Nf
UFdSX0dBVEUocGlwZSk7CisJdmx2X3B1bml0X3dyaXRlKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQ
U1NQTSwgY3RybCk7CisKKwlpZiAod2FpdF9mb3IoQ09ORCwgMTAwKSkKKwkJRFJNX0VSUk9SKCJ0
aW1lb3V0IHNldHRpbmcgcG93ZXIgd2VsbCBzdGF0ZSAlMDh4ICglMDh4KVxuIiwKKwkJCSAgc3Rh
dGUsCisJCQkgIHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfRFNQU1NQTSkpOwor
CisjdW5kZWYgQ09ORAorCitvdXQ6CisJdmx2X3B1bml0X3B1dChkZXZfcHJpdik7Cit9CisKK3N0
YXRpYyB2b2lkIGNodl9waXBlX3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKKwkJCQkgICAgICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJf
d2VsbCkKK3sKKwljaHZfc2V0X3BpcGVfcG93ZXJfd2VsbChkZXZfcHJpdiwgcG93ZXJfd2VsbCwg
dHJ1ZSk7CisKKwl2bHZfZGlzcGxheV9wb3dlcl93ZWxsX2luaXQoZGV2X3ByaXYpOworfQorCitz
dGF0aWMgdm9pZCBjaHZfcGlwZV9wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAorCQkJCQlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxs
KQoreworCXZsdl9kaXNwbGF5X3Bvd2VyX3dlbGxfZGVpbml0KGRldl9wcml2KTsKKworCWNodl9z
ZXRfcGlwZV9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxsLCBmYWxzZSk7Cit9CisKK3N0
YXRpYyB1NjQgX19hc3luY19wdXRfZG9tYWluc19tYXNrKHN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFp
bnMgKnBvd2VyX2RvbWFpbnMpCit7CisJcmV0dXJuIHBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF9k
b21haW5zWzBdIHwKKwkgICAgICAgcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X2RvbWFpbnNbMV07
Cit9CisKKyNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19SVU5USU1FX1BNKQor
CitzdGF0aWMgYm9vbAorYXNzZXJ0X2FzeW5jX3B1dF9kb21haW5fbWFza3NfZGlzam9pbnQoc3Ry
dWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucykKK3sKKwlyZXR1cm4gIVdBUk5f
T04ocG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X2RvbWFpbnNbMF0gJgorCQkJcG93ZXJfZG9tYWlu
cy0+YXN5bmNfcHV0X2RvbWFpbnNbMV0pOworfQorCitzdGF0aWMgYm9vbAorX19hc3luY19wdXRf
ZG9tYWluc19zdGF0ZV9vayhzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5z
KQoreworCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluOworCWJvb2wgZXJy
ID0gZmFsc2U7CisKKwllcnIgfD0gIWFzc2VydF9hc3luY19wdXRfZG9tYWluX21hc2tzX2Rpc2pv
aW50KHBvd2VyX2RvbWFpbnMpOworCWVyciB8PSBXQVJOX09OKCEhcG93ZXJfZG9tYWlucy0+YXN5
bmNfcHV0X3dha2VyZWYgIT0KKwkJICAgICAgICEhX19hc3luY19wdXRfZG9tYWluc19tYXNrKHBv
d2VyX2RvbWFpbnMpKTsKKworCWZvcl9lYWNoX3Bvd2VyX2RvbWFpbihkb21haW4sIF9fYXN5bmNf
cHV0X2RvbWFpbnNfbWFzayhwb3dlcl9kb21haW5zKSkKKwkJZXJyIHw9IFdBUk5fT04ocG93ZXJf
ZG9tYWlucy0+ZG9tYWluX3VzZV9jb3VudFtkb21haW5dICE9IDEpOworCisJcmV0dXJuICFlcnI7
Cit9CisKK3N0YXRpYyB2b2lkIHByaW50X3Bvd2VyX2RvbWFpbnMoc3RydWN0IGk5MTVfcG93ZXJf
ZG9tYWlucyAqcG93ZXJfZG9tYWlucywKKwkJCQljb25zdCBjaGFyICpwcmVmaXgsIHU2NCBtYXNr
KQoreworCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluOworCisJRFJNX0RF
QlVHX0RSSVZFUigiJXMgKCVsdSk6XG4iLCBwcmVmaXgsIGh3ZWlnaHQ2NChtYXNrKSk7CisJZm9y
X2VhY2hfcG93ZXJfZG9tYWluKGRvbWFpbiwgbWFzaykKKwkJRFJNX0RFQlVHX0RSSVZFUigiJXMg
dXNlX2NvdW50ICVkXG4iLAorCQkJCSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbl9zdHIoZG9t
YWluKSwKKwkJCQkgcG93ZXJfZG9tYWlucy0+ZG9tYWluX3VzZV9jb3VudFtkb21haW5dKTsKK30K
Kworc3RhdGljIHZvaWQKK3ByaW50X2FzeW5jX3B1dF9kb21haW5zX3N0YXRlKHN0cnVjdCBpOTE1
X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMpCit7CisJRFJNX0RFQlVHX0RSSVZFUigiYXN5
bmNfcHV0X3dha2VyZWYgJXVcbiIsCisJCQkgcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X3dha2Vy
ZWYpOworCisJcHJpbnRfcG93ZXJfZG9tYWlucyhwb3dlcl9kb21haW5zLCAiYXN5bmNfcHV0X2Rv
bWFpbnNbMF0iLAorCQkJICAgIHBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF9kb21haW5zWzBdKTsK
KwlwcmludF9wb3dlcl9kb21haW5zKHBvd2VyX2RvbWFpbnMsICJhc3luY19wdXRfZG9tYWluc1sx
XSIsCisJCQkgICAgcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X2RvbWFpbnNbMV0pOworfQorCitz
dGF0aWMgdm9pZAordmVyaWZ5X2FzeW5jX3B1dF9kb21haW5zX3N0YXRlKHN0cnVjdCBpOTE1X3Bv
d2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMpCit7CisJaWYgKCFfX2FzeW5jX3B1dF9kb21haW5z
X3N0YXRlX29rKHBvd2VyX2RvbWFpbnMpKQorCQlwcmludF9hc3luY19wdXRfZG9tYWluc19zdGF0
ZShwb3dlcl9kb21haW5zKTsKK30KKworI2Vsc2UKKworc3RhdGljIHZvaWQKK2Fzc2VydF9hc3lu
Y19wdXRfZG9tYWluX21hc2tzX2Rpc2pvaW50KHN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBv
d2VyX2RvbWFpbnMpCit7Cit9CisKK3N0YXRpYyB2b2lkCit2ZXJpZnlfYXN5bmNfcHV0X2RvbWFp
bnNfc3RhdGUoc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucykKK3sKK30K
KworI2VuZGlmIC8qIENPTkZJR19EUk1fSTkxNV9ERUJVR19SVU5USU1FX1BNICovCisKK3N0YXRp
YyB1NjQgYXN5bmNfcHV0X2RvbWFpbnNfbWFzayhzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpw
b3dlcl9kb21haW5zKQoreworCWFzc2VydF9hc3luY19wdXRfZG9tYWluX21hc2tzX2Rpc2pvaW50
KHBvd2VyX2RvbWFpbnMpOworCisJcmV0dXJuIF9fYXN5bmNfcHV0X2RvbWFpbnNfbWFzayhwb3dl
cl9kb21haW5zKTsKK30KKworc3RhdGljIHZvaWQKK2FzeW5jX3B1dF9kb21haW5zX2NsZWFyX2Rv
bWFpbihzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zLAorCQkJICAgICAg
IGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKQoreworCWFzc2VydF9hc3lu
Y19wdXRfZG9tYWluX21hc2tzX2Rpc2pvaW50KHBvd2VyX2RvbWFpbnMpOworCisJcG93ZXJfZG9t
YWlucy0+YXN5bmNfcHV0X2RvbWFpbnNbMF0gJj0gfkJJVF9VTEwoZG9tYWluKTsKKwlwb3dlcl9k
b21haW5zLT5hc3luY19wdXRfZG9tYWluc1sxXSAmPSB+QklUX1VMTChkb21haW4pOworfQorCitz
dGF0aWMgYm9vbAoraW50ZWxfZGlzcGxheV9wb3dlcl9ncmFiX2FzeW5jX3B1dF9yZWYoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAgICAgICBlbnVtIGludGVsX2Rpc3Bs
YXlfcG93ZXJfZG9tYWluIGRvbWFpbikKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpw
b3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOworCWJvb2wgcmV0ID0gZmFs
c2U7CisKKwlpZiAoIShhc3luY19wdXRfZG9tYWluc19tYXNrKHBvd2VyX2RvbWFpbnMpICYgQklU
X1VMTChkb21haW4pKSkKKwkJZ290byBvdXRfdmVyaWZ5OworCisJYXN5bmNfcHV0X2RvbWFpbnNf
Y2xlYXJfZG9tYWluKHBvd2VyX2RvbWFpbnMsIGRvbWFpbik7CisKKwlyZXQgPSB0cnVlOworCisJ
aWYgKGFzeW5jX3B1dF9kb21haW5zX21hc2socG93ZXJfZG9tYWlucykpCisJCWdvdG8gb3V0X3Zl
cmlmeTsKKworCWNhbmNlbF9kZWxheWVkX3dvcmsoJnBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF93
b3JrKTsKKwlpbnRlbF9ydW50aW1lX3BtX3B1dF9yYXcoZGV2X3ByaXYsCisJCQkJIGZldGNoX2Fu
ZF96ZXJvKCZwb3dlcl9kb21haW5zLT5hc3luY19wdXRfd2FrZXJlZikpOworb3V0X3ZlcmlmeToK
Kwl2ZXJpZnlfYXN5bmNfcHV0X2RvbWFpbnNfc3RhdGUocG93ZXJfZG9tYWlucyk7CisKKwlyZXR1
cm4gcmV0OworfQorCitzdGF0aWMgdm9pZAorX19pbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9kb21h
aW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSBlbnVtIGludGVsX2Rp
c3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbikKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5z
ICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOworCXN0cnVjdCBpOTE1
X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGw7CisKKwlpZiAoaW50ZWxfZGlzcGxheV9wb3dlcl9ncmFi
X2FzeW5jX3B1dF9yZWYoZGV2X3ByaXYsIGRvbWFpbikpCisJCXJldHVybjsKKworCWZvcl9lYWNo
X3Bvd2VyX2RvbWFpbl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxsLCBCSVRfVUxMKGRvbWFpbikp
CisJCWludGVsX3Bvd2VyX3dlbGxfZ2V0KGRldl9wcml2LCBwb3dlcl93ZWxsKTsKKworCXBvd2Vy
X2RvbWFpbnMtPmRvbWFpbl91c2VfY291bnRbZG9tYWluXSsrOworfQorCisvKioKKyAqIGludGVs
X2Rpc3BsYXlfcG93ZXJfZ2V0IC0gZ3JhYiBhIHBvd2VyIGRvbWFpbiByZWZlcmVuY2UKKyAqIEBk
ZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKKyAqIEBkb21haW46IHBvd2VyIGRvbWFpbiB0
byByZWZlcmVuY2UKKyAqCisgKiBUaGlzIGZ1bmN0aW9uIGdyYWJzIGEgcG93ZXIgZG9tYWluIHJl
ZmVyZW5jZSBmb3IgQGRvbWFpbiBhbmQgZW5zdXJlcyB0aGF0IHRoZQorICogcG93ZXIgZG9tYWlu
IGFuZCBhbGwgaXRzIHBhcmVudHMgYXJlIHBvd2VyZWQgdXAuIFRoZXJlZm9yZSB1c2VycyBzaG91
bGQgb25seQorICogZ3JhYiBhIHJlZmVyZW5jZSB0byB0aGUgaW5uZXJtb3N0IHBvd2VyIGRvbWFp
biB0aGV5IG5lZWQuCisgKgorICogQW55IHBvd2VyIGRvbWFpbiByZWZlcmVuY2Ugb2J0YWluZWQg
YnkgdGhpcyBmdW5jdGlvbiBtdXN0IGhhdmUgYSBzeW1tZXRyaWMKKyAqIGNhbGwgdG8gaW50ZWxf
ZGlzcGxheV9wb3dlcl9wdXQoKSB0byByZWxlYXNlIHRoZSByZWZlcmVuY2UgYWdhaW4uCisgKi8K
K2ludGVsX3dha2VyZWZfdCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4g
ZG9tYWluKQoreworCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAm
ZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7CisJaW50ZWxfd2FrZXJlZl90IHdha2VyZWYgPSBpbnRl
bF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7CisKKwltdXRleF9sb2NrKCZwb3dlcl9kb21haW5z
LT5sb2NrKTsKKwlfX2ludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2RvbWFpbihkZXZfcHJpdiwgZG9t
YWluKTsKKwltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOworCisJcmV0dXJuIHdh
a2VyZWY7Cit9CisKKy8qKgorICogaW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZCAt
IGdyYWIgYSByZWZlcmVuY2UgZm9yIGFuIGVuYWJsZWQgZGlzcGxheSBwb3dlciBkb21haW4KKyAq
IEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKKyAqIEBkb21haW46IHBvd2VyIGRvbWFp
biB0byByZWZlcmVuY2UKKyAqCisgKiBUaGlzIGZ1bmN0aW9uIGdyYWJzIGEgcG93ZXIgZG9tYWlu
IHJlZmVyZW5jZSBmb3IgQGRvbWFpbiBhbmQgZW5zdXJlcyB0aGF0IHRoZQorICogcG93ZXIgZG9t
YWluIGFuZCBhbGwgaXRzIHBhcmVudHMgYXJlIHBvd2VyZWQgdXAuIFRoZXJlZm9yZSB1c2VycyBz
aG91bGQgb25seQorICogZ3JhYiBhIHJlZmVyZW5jZSB0byB0aGUgaW5uZXJtb3N0IHBvd2VyIGRv
bWFpbiB0aGV5IG5lZWQuCisgKgorICogQW55IHBvd2VyIGRvbWFpbiByZWZlcmVuY2Ugb2J0YWlu
ZWQgYnkgdGhpcyBmdW5jdGlvbiBtdXN0IGhhdmUgYSBzeW1tZXRyaWMKKyAqIGNhbGwgdG8gaW50
ZWxfZGlzcGxheV9wb3dlcl9wdXQoKSB0byByZWxlYXNlIHRoZSByZWZlcmVuY2UgYWdhaW4uCisg
Ki8KK2ludGVsX3dha2VyZWZfdAoraW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfaWZfZW5hYmxlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJICAgZW51bSBpbnRlbF9kaXNw
bGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pCit7CisJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAq
cG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKKwlpbnRlbF93YWtlcmVm
X3Qgd2FrZXJlZjsKKwlib29sIGlzX2VuYWJsZWQ7CisKKwl3YWtlcmVmID0gaW50ZWxfcnVudGlt
ZV9wbV9nZXRfaWZfaW5fdXNlKGRldl9wcml2KTsKKwlpZiAoIXdha2VyZWYpCisJCXJldHVybiBm
YWxzZTsKKworCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOworCisJaWYgKF9faW50
ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKGRldl9wcml2LCBkb21haW4pKSB7CisJCV9faW50
ZWxfZGlzcGxheV9wb3dlcl9nZXRfZG9tYWluKGRldl9wcml2LCBkb21haW4pOworCQlpc19lbmFi
bGVkID0gdHJ1ZTsKKwl9IGVsc2UgeworCQlpc19lbmFibGVkID0gZmFsc2U7CisJfQorCisJbXV0
ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKKworCWlmICghaXNfZW5hYmxlZCkgewor
CQlpbnRlbF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7CisJCXdha2VyZWYgPSAw
OworCX0KKworCXJldHVybiB3YWtlcmVmOworfQorCitzdGF0aWMgdm9pZAorX19pbnRlbF9kaXNw
bGF5X3Bvd2VyX3B1dF9kb21haW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAor
CQkJCSBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbikKK3sKKwlzdHJ1Y3Qg
aTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zOworCXN0cnVjdCBpOTE1X3Bvd2VyX3dl
bGwgKnBvd2VyX3dlbGw7CisJY29uc3QgY2hhciAqbmFtZSA9IGludGVsX2Rpc3BsYXlfcG93ZXJf
ZG9tYWluX3N0cihkb21haW4pOworCisJcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJf
ZG9tYWluczsKKworCVdBUk4oIXBvd2VyX2RvbWFpbnMtPmRvbWFpbl91c2VfY291bnRbZG9tYWlu
XSwKKwkgICAgICJVc2UgY291bnQgb24gZG9tYWluICVzIGlzIGFscmVhZHkgemVyb1xuIiwKKwkg
ICAgIG5hbWUpOworCVdBUk4oYXN5bmNfcHV0X2RvbWFpbnNfbWFzayhwb3dlcl9kb21haW5zKSAm
IEJJVF9VTEwoZG9tYWluKSwKKwkgICAgICJBc3luYyBkaXNhYmxpbmcgb2YgZG9tYWluICVzIGlz
IHBlbmRpbmdcbiIsCisJICAgICBuYW1lKTsKKworCXBvd2VyX2RvbWFpbnMtPmRvbWFpbl91c2Vf
Y291bnRbZG9tYWluXS0tOworCisJZm9yX2VhY2hfcG93ZXJfZG9tYWluX3dlbGxfcmV2ZXJzZShk
ZXZfcHJpdiwgcG93ZXJfd2VsbCwgQklUX1VMTChkb21haW4pKQorCQlpbnRlbF9wb3dlcl93ZWxs
X3B1dChkZXZfcHJpdiwgcG93ZXJfd2VsbCk7Cit9CisKK3N0YXRpYyB2b2lkIF9faW50ZWxfZGlz
cGxheV9wb3dlcl9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAg
ICAgIGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKQoreworCXN0cnVjdCBp
OTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFp
bnM7CisKKwltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKKwlfX2ludGVsX2Rpc3Bs
YXlfcG93ZXJfcHV0X2RvbWFpbihkZXZfcHJpdiwgZG9tYWluKTsKKwltdXRleF91bmxvY2soJnBv
d2VyX2RvbWFpbnMtPmxvY2spOworfQorCisvKioKKyAqIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0
X3VuY2hlY2tlZCAtIHJlbGVhc2UgYW4gdW5jaGVja2VkIHBvd2VyIGRvbWFpbiByZWZlcmVuY2UK
KyAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKKyAqIEBkb21haW46IHBvd2VyIGRv
bWFpbiB0byByZWZlcmVuY2UKKyAqCisgKiBUaGlzIGZ1bmN0aW9uIGRyb3BzIHRoZSBwb3dlciBk
b21haW4gcmVmZXJlbmNlIG9idGFpbmVkIGJ5CisgKiBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldCgp
IGFuZCBtaWdodCBwb3dlciBkb3duIHRoZSBjb3JyZXNwb25kaW5nIGhhcmR3YXJlCisgKiBibG9j
ayByaWdodCBhd2F5IGlmIHRoaXMgaXMgdGhlIGxhc3QgcmVmZXJlbmNlLgorICoKKyAqIFRoaXMg
ZnVuY3Rpb24gZXhpc3RzIG9ubHkgZm9yIGhpc3RvcmljYWwgcmVhc29ucyBhbmQgc2hvdWxkIGJl
IGF2b2lkZWQgaW4KKyAqIG5ldyBjb2RlLCBhcyB0aGUgY29ycmVjdG5lc3Mgb2YgaXRzIHVzZSBj
YW5ub3QgYmUgY2hlY2tlZC4gQWx3YXlzIHVzZQorICogaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQo
KSBpbnN0ZWFkLgorICovCit2b2lkIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJICAgICAgIGVudW0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKQoreworCV9faW50ZWxfZGlzcGxheV9wb3dlcl9w
dXQoZGV2X3ByaXYsIGRvbWFpbik7CisJaW50ZWxfcnVudGltZV9wbV9wdXRfdW5jaGVja2VkKGRl
dl9wcml2KTsKK30KKworc3RhdGljIHZvaWQKK3F1ZXVlX2FzeW5jX3B1dF9kb21haW5zX3dvcmso
c3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucywKKwkJCSAgICAgaW50ZWxf
d2FrZXJlZl90IHdha2VyZWYpCit7CisJV0FSTl9PTihwb3dlcl9kb21haW5zLT5hc3luY19wdXRf
d2FrZXJlZik7CisJcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X3dha2VyZWYgPSB3YWtlcmVmOwor
CVdBUk5fT04oIXF1ZXVlX2RlbGF5ZWRfd29yayhzeXN0ZW1fdW5ib3VuZF93cSwKKwkJCQkgICAg
JnBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF93b3JrLAorCQkJCSAgICBtc2Vjc190b19qaWZmaWVz
KDEwMCkpKTsKK30KKworc3RhdGljIHZvaWQKK3JlbGVhc2VfYXN5bmNfcHV0X2RvbWFpbnMoc3Ry
dWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucywgdTY0IG1hc2spCit7CisJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0KKwkJY29udGFpbmVyX29mKHBvd2VyX2Rv
bWFpbnMsIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlLAorCQkJICAgICBwb3dlcl9kb21haW5zKTsK
KwllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbjsKKwlpbnRlbF93YWtlcmVm
X3Qgd2FrZXJlZjsKKworCS8qCisJICogVGhlIGNhbGxlciBtdXN0IGhvbGQgYWxyZWFkeSByYXcg
d2FrZXJlZiwgdXBncmFkZSB0aGF0IHRvIGEgcHJvcGVyCisJICogd2FrZXJlZiB0byBtYWtlIHRo
ZSBzdGF0ZSBjaGVja2VyIGhhcHB5IGFib3V0IHRoZSBIVyBhY2Nlc3MgZHVyaW5nCisJICogcG93
ZXIgd2VsbCBkaXNhYmxpbmcuCisJICovCisJYXNzZXJ0X3JwbV9yYXdfd2FrZXJlZl9oZWxkKGRl
dl9wcml2KTsKKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoZGV2X3ByaXYpOworCisJ
Zm9yX2VhY2hfcG93ZXJfZG9tYWluKGRvbWFpbiwgbWFzaykgeworCQkvKiBDbGVhciBiZWZvcmUg
cHV0LCBzbyBwdXQncyBzYW5pdHkgY2hlY2sgaXMgaGFwcHkuICovCisJCWFzeW5jX3B1dF9kb21h
aW5zX2NsZWFyX2RvbWFpbihwb3dlcl9kb21haW5zLCBkb21haW4pOworCQlfX2ludGVsX2Rpc3Bs
YXlfcG93ZXJfcHV0X2RvbWFpbihkZXZfcHJpdiwgZG9tYWluKTsKKwl9CisKKwlpbnRlbF9ydW50
aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7Cit9CisKK3N0YXRpYyB2b2lkCitpbnRlbF9k
aXNwbGF5X3Bvd2VyX3B1dF9hc3luY193b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKK3sK
KwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQorCQljb250YWluZXJfb2Yod29y
aywgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUsCisJCQkgICAgIHBvd2VyX2RvbWFpbnMuYXN5bmNf
cHV0X3dvcmsud29yayk7CisJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlu
cyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKKwlpbnRlbF93YWtlcmVmX3QgbmV3X3dvcmtf
d2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0X3JhdyhkZXZfcHJpdik7CisJaW50ZWxfd2Fr
ZXJlZl90IG9sZF93b3JrX3dha2VyZWYgPSAwOworCisJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlu
cy0+bG9jayk7CisKKwkvKgorCSAqIEJhaWwgb3V0IGlmIGFsbCB0aGUgZG9tYWluIHJlZnMgcGVu
ZGluZyB0byBiZSByZWxlYXNlZCB3ZXJlIGdyYWJiZWQKKwkgKiBieSBzdWJzZXF1ZW50IGdldHMg
b3IgYSBmbHVzaF93b3JrLgorCSAqLworCW9sZF93b3JrX3dha2VyZWYgPSBmZXRjaF9hbmRfemVy
bygmcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X3dha2VyZWYpOworCWlmICghb2xkX3dvcmtfd2Fr
ZXJlZikKKwkJZ290byBvdXRfdmVyaWZ5OworCisJcmVsZWFzZV9hc3luY19wdXRfZG9tYWlucyhw
b3dlcl9kb21haW5zLAorCQkJCSAgcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X2RvbWFpbnNbMF0p
OworCisJLyogUmVxdWV1ZSB0aGUgd29yayBpZiBtb3JlIGRvbWFpbnMgd2VyZSBhc3luYyBwdXQg
bWVhbndoaWxlLiAqLworCWlmIChwb3dlcl9kb21haW5zLT5hc3luY19wdXRfZG9tYWluc1sxXSkg
eworCQlwb3dlcl9kb21haW5zLT5hc3luY19wdXRfZG9tYWluc1swXSA9CisJCQlmZXRjaF9hbmRf
emVybygmcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X2RvbWFpbnNbMV0pOworCQlxdWV1ZV9hc3lu
Y19wdXRfZG9tYWluc193b3JrKHBvd2VyX2RvbWFpbnMsCisJCQkJCSAgICAgZmV0Y2hfYW5kX3pl
cm8oJm5ld193b3JrX3dha2VyZWYpKTsKKwl9CisKK291dF92ZXJpZnk6CisJdmVyaWZ5X2FzeW5j
X3B1dF9kb21haW5zX3N0YXRlKHBvd2VyX2RvbWFpbnMpOworCisJbXV0ZXhfdW5sb2NrKCZwb3dl
cl9kb21haW5zLT5sb2NrKTsKKworCWlmIChvbGRfd29ya193YWtlcmVmKQorCQlpbnRlbF9ydW50
aW1lX3BtX3B1dF9yYXcoZGV2X3ByaXYsIG9sZF93b3JrX3dha2VyZWYpOworCWlmIChuZXdfd29y
a193YWtlcmVmKQorCQlpbnRlbF9ydW50aW1lX3BtX3B1dF9yYXcoZGV2X3ByaXYsIG5ld193b3Jr
X3dha2VyZWYpOworfQorCisvKioKKyAqIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jIC0g
cmVsZWFzZSBhIHBvd2VyIGRvbWFpbiByZWZlcmVuY2UgYXN5bmNocm9ub3VzbHkKKyAqIEBpOTE1
OiBpOTE1IGRldmljZSBpbnN0YW5jZQorICogQGRvbWFpbjogcG93ZXIgZG9tYWluIHRvIHJlZmVy
ZW5jZQorICogQHdha2VyZWY6IHdha2VyZWYgYWNxdWlyZWQgZm9yIHRoZSByZWZlcmVuY2UgdGhh
dCBpcyBiZWluZyByZWxlYXNlZAorICoKKyAqIFRoaXMgZnVuY3Rpb24gZHJvcHMgdGhlIHBvd2Vy
IGRvbWFpbiByZWZlcmVuY2Ugb2J0YWluZWQgYnkKKyAqIGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0
KigpIGFuZCBzY2hlZHVsZXMgYSB3b3JrIHRvIHBvd2VyIGRvd24gdGhlCisgKiBjb3JyZXNwb25k
aW5nIGhhcmR3YXJlIGJsb2NrIGlmIHRoaXMgaXMgdGhlIGxhc3QgcmVmZXJlbmNlLgorICovCit2
b2lkIF9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfYXN5bmMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCisJCQkJICAgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFp
biwKKwkJCQkgICAgIGludGVsX3dha2VyZWZfdCB3YWtlcmVmKQoreworCXN0cnVjdCBpOTE1X3Bv
d2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93ZXJfZG9tYWluczsKKwlpbnRl
bF93YWtlcmVmX3Qgd29ya193YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXRfcmF3KGk5MTUp
OworCisJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7CisKKwlpZiAocG93ZXJfZG9t
YWlucy0+ZG9tYWluX3VzZV9jb3VudFtkb21haW5dID4gMSkgeworCQlfX2ludGVsX2Rpc3BsYXlf
cG93ZXJfcHV0X2RvbWFpbihpOTE1LCBkb21haW4pOworCisJCWdvdG8gb3V0X3ZlcmlmeTsKKwl9
CisKKwlXQVJOX09OKHBvd2VyX2RvbWFpbnMtPmRvbWFpbl91c2VfY291bnRbZG9tYWluXSAhPSAx
KTsKKworCS8qIExldCBhIHBlbmRpbmcgd29yayByZXF1ZXVlIGl0c2VsZiBvciBxdWV1ZSBhIG5l
dyBvbmUuICovCisJaWYgKHBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF93YWtlcmVmKSB7CisJCXBv
d2VyX2RvbWFpbnMtPmFzeW5jX3B1dF9kb21haW5zWzFdIHw9IEJJVF9VTEwoZG9tYWluKTsKKwl9
IGVsc2UgeworCQlwb3dlcl9kb21haW5zLT5hc3luY19wdXRfZG9tYWluc1swXSB8PSBCSVRfVUxM
KGRvbWFpbik7CisJCXF1ZXVlX2FzeW5jX3B1dF9kb21haW5zX3dvcmsocG93ZXJfZG9tYWlucywK
KwkJCQkJICAgICBmZXRjaF9hbmRfemVybygmd29ya193YWtlcmVmKSk7CisJfQorCitvdXRfdmVy
aWZ5OgorCXZlcmlmeV9hc3luY19wdXRfZG9tYWluc19zdGF0ZShwb3dlcl9kb21haW5zKTsKKwor
CW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7CisKKwlpZiAod29ya193YWtlcmVm
KQorCQlpbnRlbF9ydW50aW1lX3BtX3B1dF9yYXcoaTkxNSwgd29ya193YWtlcmVmKTsKKworCWlu
dGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOworfQorCisvKioKKyAqIGludGVsX2Rp
c3BsYXlfcG93ZXJfZmx1c2hfd29yayAtIGZsdXNoZXMgdGhlIGFzeW5jIGRpc3BsYXkgcG93ZXIg
ZGlzYWJsaW5nIHdvcmsKKyAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQorICoKKyAqIEZs
dXNoZXMgYW55IHBlbmRpbmcgd29yayB0aGF0IHdhcyBzY2hlZHVsZWQgYnkgYSBwcmVjZWRpbmcK
KyAqIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jKCkgY2FsbCwgY29tcGxldGluZyB0aGUg
ZGlzYWJsaW5nIG9mIHRoZQorICogY29ycmVzcG9uZGluZyBwb3dlciBkb21haW5zLgorICoKKyAq
IE5vdGUgdGhhdCB0aGUgd29yayBoYW5kbGVyIGZ1bmN0aW9uIG1heSBzdGlsbCBiZSBydW5uaW5n
IGFmdGVyIHRoaXMKKyAqIGZ1bmN0aW9uIHJldHVybnM7IHRvIGVuc3VyZSB0aGF0IHRoZSB3b3Jr
IGhhbmRsZXIgaXNuJ3QgcnVubmluZyB1c2UKKyAqIGludGVsX2Rpc3BsYXlfcG93ZXJfZmx1c2hf
d29ya19zeW5jKCkgaW5zdGVhZC4KKyAqLwordm9pZCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2ZsdXNo
X3dvcmsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCit7CisJc3RydWN0IGk5MTVfcG93
ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOworCWludGVs
X3dha2VyZWZfdCB3b3JrX3dha2VyZWY7CisKKwltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5s
b2NrKTsKKworCXdvcmtfd2FrZXJlZiA9IGZldGNoX2FuZF96ZXJvKCZwb3dlcl9kb21haW5zLT5h
c3luY19wdXRfd2FrZXJlZik7CisJaWYgKCF3b3JrX3dha2VyZWYpCisJCWdvdG8gb3V0X3Zlcmlm
eTsKKworCXJlbGVhc2VfYXN5bmNfcHV0X2RvbWFpbnMocG93ZXJfZG9tYWlucywKKwkJCQkgIGFz
eW5jX3B1dF9kb21haW5zX21hc2socG93ZXJfZG9tYWlucykpOworCWNhbmNlbF9kZWxheWVkX3dv
cmsoJnBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF93b3JrKTsKKworb3V0X3ZlcmlmeToKKwl2ZXJp
ZnlfYXN5bmNfcHV0X2RvbWFpbnNfc3RhdGUocG93ZXJfZG9tYWlucyk7CisKKwltdXRleF91bmxv
Y2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOworCisJaWYgKHdvcmtfd2FrZXJlZikKKwkJaW50ZWxf
cnVudGltZV9wbV9wdXRfcmF3KGk5MTUsIHdvcmtfd2FrZXJlZik7Cit9CisKKy8qKgorICogaW50
ZWxfZGlzcGxheV9wb3dlcl9mbHVzaF93b3JrX3N5bmMgLSBmbHVzaGVzIGFuZCBzeW5jcyB0aGUg
YXN5bmMgZGlzcGxheSBwb3dlciBkaXNhYmxpbmcgd29yaworICogQGk5MTU6IGk5MTUgZGV2aWNl
IGluc3RhbmNlCisgKgorICogTGlrZSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2ZsdXNoX3dvcmsoKSwg
YnV0IGFsc28gZW5zdXJlIHRoYXQgdGhlIHdvcmsKKyAqIGhhbmRsZXIgZnVuY3Rpb24gaXMgbm90
IHJ1bm5pbmcgYW55IG1vcmUgd2hlbiB0aGlzIGZ1bmN0aW9uIHJldHVybnMuCisgKi8KK3N0YXRp
YyB2b2lkCitpbnRlbF9kaXNwbGF5X3Bvd2VyX2ZsdXNoX3dvcmtfc3luYyhzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSkKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9k
b21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7CisKKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX2Zs
dXNoX3dvcmsoaTkxNSk7CisJY2FuY2VsX2RlbGF5ZWRfd29ya19zeW5jKCZwb3dlcl9kb21haW5z
LT5hc3luY19wdXRfd29yayk7CisKKwl2ZXJpZnlfYXN5bmNfcHV0X2RvbWFpbnNfc3RhdGUocG93
ZXJfZG9tYWlucyk7CisKKwlXQVJOX09OKHBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF93YWtlcmVm
KTsKK30KKworI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX1JVTlRJTUVfUE0p
CisvKioKKyAqIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0IC0gcmVsZWFzZSBhIHBvd2VyIGRvbWFp
biByZWZlcmVuY2UKKyAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKKyAqIEBkb21h
aW46IHBvd2VyIGRvbWFpbiB0byByZWZlcmVuY2UKKyAqIEB3YWtlcmVmOiB3YWtlcmVmIGFjcXVp
cmVkIGZvciB0aGUgcmVmZXJlbmNlIHRoYXQgaXMgYmVpbmcgcmVsZWFzZWQKKyAqCisgKiBUaGlz
IGZ1bmN0aW9uIGRyb3BzIHRoZSBwb3dlciBkb21haW4gcmVmZXJlbmNlIG9idGFpbmVkIGJ5Cisg
KiBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldCgpIGFuZCBtaWdodCBwb3dlciBkb3duIHRoZSBjb3Jy
ZXNwb25kaW5nIGhhcmR3YXJlCisgKiBibG9jayByaWdodCBhd2F5IGlmIHRoaXMgaXMgdGhlIGxh
c3QgcmVmZXJlbmNlLgorICovCit2b2lkIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJCSAgICAgZW51bSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2RvbWFpbiBkb21haW4sCisJCQkgICAgIGludGVsX3dha2VyZWZfdCB3YWtlcmVmKQorewor
CV9faW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoZGV2X3ByaXYsIGRvbWFpbik7CisJaW50ZWxfcnVu
dGltZV9wbV9wdXQoZGV2X3ByaXYsIHdha2VyZWYpOworfQorI2VuZGlmCisKKyNkZWZpbmUgSTgz
MF9QSVBFU19QT1dFUl9ET01BSU5TICgJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0Ep
IHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0IpIHwJCVwKKwlCSVRfVUxMKFBPV0VS
X0RPTUFJTl9QSVBFX0FfUEFORUxfRklUVEVSKSB8CVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9Q
SVBFX0JfUEFORUxfRklUVEVSKSB8CVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NPREVS
X0EpIHwJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQikgfAlcCisJQklUX1VM
TChQT1dFUl9ET01BSU5fSU5JVCkpCisKKyNkZWZpbmUgVkxWX0RJU1BMQVlfUE9XRVJfRE9NQUlO
UyAoCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fRElTUExBWV9DT1JFKSB8CVwKKwlCSVRfVUxM
KFBPV0VSX0RPTUFJTl9QSVBFX0EpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0Ip
IHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0FfUEFORUxfRklUVEVSKSB8CVwKKwlC
SVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0JfUEFORUxfRklUVEVSKSB8CVwKKwlCSVRfVUxMKFBP
V0VSX0RPTUFJTl9UUkFOU0NPREVSX0EpIHwJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5T
Q09ERVJfQikgfAlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQl9MQU5FUykgfAlc
CisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQ19MQU5FUykgfAlcCisJQklUX1VMTChQ
T1dFUl9ET01BSU5fUE9SVF9EU0kpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0NS
VCkgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1ZHQSkgfAkJCVwKKwlCSVRfVUxMKFBPV0VS
X0RPTUFJTl9BVURJTykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9CKSB8CQlcCisJ
QklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0MpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9H
TUJVUykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQorCisjZGVmaW5lIFZMVl9E
UElPX0NNTl9CQ19QT1dFUl9ET01BSU5TICgJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JU
X0RESV9CX0xBTkVTKSB8CVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9DX0xBTkVT
KSB8CVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0NSVCkgfAkJXAorCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX0FVWF9CKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0MpIHwJCVwK
KwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKKworI2RlZmluZSBWTFZfRFBJT19UWF9CX0xB
TkVTXzAxX1BPV0VSX0RPTUFJTlMgKAlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElf
Ql9MQU5FUykgfAlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0IpIHwJCVwKKwlCSVRfVUxM
KFBPV0VSX0RPTUFJTl9JTklUKSkKKworI2RlZmluZSBWTFZfRFBJT19UWF9CX0xBTkVTXzIzX1BP
V0VSX0RPTUFJTlMgKAlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQl9MQU5FUykg
fAlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0IpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9JTklUKSkKKworI2RlZmluZSBWTFZfRFBJT19UWF9DX0xBTkVTXzAxX1BPV0VSX0RPTUFJ
TlMgKAlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQ19MQU5FUykgfAlcCisJQklU
X1VMTChQT1dFUl9ET01BSU5fQVVYX0MpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklU
KSkKKworI2RlZmluZSBWTFZfRFBJT19UWF9DX0xBTkVTXzIzX1BPV0VSX0RPTUFJTlMgKAlcCisJ
QklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQ19MQU5FUykgfAlcCisJQklUX1VMTChQT1dF
Ul9ET01BSU5fQVVYX0MpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKKworI2Rl
ZmluZSBDSFZfRElTUExBWV9QT1dFUl9ET01BSU5TICgJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJ
Tl9ESVNQTEFZX0NPUkUpIHwJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQSkgfAkJXAor
CUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQikgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlO
X1BJUEVfQykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQV9QQU5FTF9GSVRURVIp
IHwJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQl9QQU5FTF9GSVRURVIpIHwJXAorCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQ19QQU5FTF9GSVRURVIpIHwJXAorCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX1RSQU5TQ09ERVJfQSkgfAlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fVFJBTlND
T0RFUl9CKSB8CVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0MpIHwJXAorCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfTEFORVMpIHwJXAorCUJJVF9VTEwoUE9XRVJf
RE9NQUlOX1BPUlRfRERJX0NfTEFORVMpIHwJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRf
RERJX0RfTEFORVMpIHwJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRFNJKSB8CQlcCisJ
QklUX1VMTChQT1dFUl9ET01BSU5fVkdBKSB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FV
RElPKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0IpIHwJCVwKKwlCSVRfVUxMKFBP
V0VSX0RPTUFJTl9BVVhfQykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9EKSB8CQlc
CisJQklUX1VMTChQT1dFUl9ET01BSU5fR01CVVMpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJ
Tl9JTklUKSkKKworI2RlZmluZSBDSFZfRFBJT19DTU5fQkNfUE9XRVJfRE9NQUlOUyAoCQlcCisJ
QklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQl9MQU5FUykgfAlcCisJQklUX1VMTChQT1dF
Ul9ET01BSU5fUE9SVF9ERElfQ19MQU5FUykgfAlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVY
X0IpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQykgfAkJXAorCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX0lOSVQpKQorCisjZGVmaW5lIENIVl9EUElPX0NNTl9EX1BPV0VSX0RPTUFJTlMg
KAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0RfTEFORVMpIHwJXAorCUJJVF9V
TEwoUE9XRVJfRE9NQUlOX0FVWF9EKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkp
CisKKyNkZWZpbmUgSFNXX0RJU1BMQVlfUE9XRVJfRE9NQUlOUyAoCQkJXAorCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX1BJUEVfQikgfAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0MpIHwJ
CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9BX1BBTkVMX0ZJVFRFUikgfAkJXAorCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQl9QQU5FTF9GSVRURVIpIHwJCVwKKwlCSVRfVUxMKFBP
V0VSX0RPTUFJTl9QSVBFX0NfUEFORUxfRklUVEVSKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01B
SU5fVFJBTlNDT0RFUl9BKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9C
KSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9DKSB8CQlcCisJQklUX1VM
TChQT1dFUl9ET01BSU5fUE9SVF9ERElfQl9MQU5FUykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9N
QUlOX1BPUlRfRERJX0NfTEFORVMpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RE
SV9EX0xBTkVTKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9DUlQpIHwgLyogRERJ
IEUgKi8JXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1ZHQSkgfAkJCQlcCisJQklUX1VMTChQT1dF
Ul9ET01BSU5fQVVESU8pIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCisKKyNk
ZWZpbmUgQkRXX0RJU1BMQVlfUE9XRVJfRE9NQUlOUyAoCQkJXAorCUJJVF9VTEwoUE9XRVJfRE9N
QUlOX1BJUEVfQikgfAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0MpIHwJCQlcCisJ
QklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9CX1BBTkVMX0ZJVFRFUikgfAkJXAorCUJJVF9VTEwo
UE9XRVJfRE9NQUlOX1BJUEVfQ19QQU5FTF9GSVRURVIpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9UUkFOU0NPREVSX0EpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NPREVS
X0IpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0MpIHwJCVwKKwlCSVRf
VUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9CX0xBTkVTKSB8CQlcCisJQklUX1VMTChQT1dFUl9E
T01BSU5fUE9SVF9ERElfQ19MQU5FUykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRf
RERJX0RfTEFORVMpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0NSVCkgfCAvKiBE
REkgRSAqLwlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fVkdBKSB8CQkJCVwKKwlCSVRfVUxMKFBP
V0VSX0RPTUFJTl9BVURJTykgfAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKKwor
I2RlZmluZSBTS0xfRElTUExBWV9QT1dFUldFTExfMl9QT1dFUl9ET01BSU5TICgJCVwKKwlCSVRf
VUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0EpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJ
Tl9QSVBFX0IpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9CKSB8CQlc
CisJQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9DKSB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9N
QUlOX1RSQU5TQ09ERVJfQykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQl9QQU5F
TF9GSVRURVIpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0NfUEFORUxfRklUVEVS
KSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQl9MQU5FUykgfAkJXAorCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0NfTEFORVMpIHwJCVwKKwlCSVRfVUxMKFBPV0VS
X0RPTUFJTl9QT1JUX0RESV9EX0xBTkVTKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9S
VF9ERElfRV9MQU5FUykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9CKSB8ICAgICAg
ICAgICAgICAgICAgICAgICBcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0MpIHwJCQlcCisJ
QklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0QpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5f
QVVESU8pIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fVkdBKSB8CQkJCVwKKwlCSVRfVUxM
KFBPV0VSX0RPTUFJTl9JTklUKSkKKyNkZWZpbmUgU0tMX0RJU1BMQVlfRERJX0lPX0FfRV9QT1dF
Ul9ET01BSU5TICgJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9BX0lPKSB8CQlc
CisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfRV9JTykgfAkJXAorCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX0lOSVQpKQorI2RlZmluZSBTS0xfRElTUExBWV9ERElfSU9fQl9QT1dFUl9ET01B
SU5TICgJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9CX0lPKSB8CQlcCisJQklU
X1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCisjZGVmaW5lIFNLTF9ESVNQTEFZX0RESV9JT19DX1BP
V0VSX0RPTUFJTlMgKAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0NfSU8pIHwJ
CVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKKyNkZWZpbmUgU0tMX0RJU1BMQVlfRERJ
X0lPX0RfUE9XRVJfRE9NQUlOUyAoCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElf
RF9JTykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQorI2RlZmluZSBTS0xfRElT
UExBWV9EQ19PRkZfUE9XRVJfRE9NQUlOUyAoCQlcCisJU0tMX0RJU1BMQVlfUE9XRVJXRUxMXzJf
UE9XRVJfRE9NQUlOUyB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fR1RfSVJRKSB8CQkJXAor
CUJJVF9VTEwoUE9XRVJfRE9NQUlOX01PREVTRVQpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01B
SU5fQVVYX0EpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCisKKyNkZWZpbmUg
QlhUX0RJU1BMQVlfUE9XRVJXRUxMXzJfUE9XRVJfRE9NQUlOUyAoCQlcCisJQklUX1VMTChQT1dF
Ul9ET01BSU5fVFJBTlNDT0RFUl9BKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9C
KSB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQikgfAkJXAorCUJJVF9V
TEwoUE9XRVJfRE9NQUlOX1BJUEVfQykgfAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFO
U0NPREVSX0MpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0JfUEFORUxfRklUVEVS
KSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9DX1BBTkVMX0ZJVFRFUikgfAkJXAor
CUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfTEFORVMpIHwJCVwKKwlCSVRfVUxMKFBP
V0VSX0RPTUFJTl9QT1JUX0RESV9DX0xBTkVTKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5f
QVVYX0IpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0MpIHwJCQlcCisJQklUX1VM
TChQT1dFUl9ET01BSU5fQVVESU8pIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fVkdBKSB8
CQkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKKyNkZWZpbmUgQlhUX0RJU1BMQVlf
RENfT0ZGX1BPV0VSX0RPTUFJTlMgKAkJXAorCUJYVF9ESVNQTEFZX1BPV0VSV0VMTF8yX1BPV0VS
X0RPTUFJTlMgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0dUX0lSUSkgfAkJCVwKKwlCSVRf
VUxMKFBPV0VSX0RPTUFJTl9NT0RFU0VUKSB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FV
WF9BKSB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0dNQlVTKSB8CQkJXAorCUJJVF9VTEwo
UE9XRVJfRE9NQUlOX0lOSVQpKQorI2RlZmluZSBCWFRfRFBJT19DTU5fQV9QT1dFUl9ET01BSU5T
ICgJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQV9MQU5FUykgfAkJXAorCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9BKSB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lO
SVQpKQorI2RlZmluZSBCWFRfRFBJT19DTU5fQkNfUE9XRVJfRE9NQUlOUyAoCQkJXAorCUJJVF9V
TEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfTEFORVMpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9QT1JUX0RESV9DX0xBTkVTKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0Ip
IHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0MpIHwJCQlcCisJQklUX1VMTChQT1dF
Ul9ET01BSU5fSU5JVCkpCisKKyNkZWZpbmUgR0xLX0RJU1BMQVlfUE9XRVJXRUxMXzJfUE9XRVJf
RE9NQUlOUyAoCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9BKSB8CQlcCisJ
QklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9CKSB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlO
X1RSQU5TQ09ERVJfQikgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQykgfAkJCVwK
KwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0MpIHwJCVwKKwlCSVRfVUxMKFBPV0VS
X0RPTUFJTl9QSVBFX0JfUEFORUxfRklUVEVSKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5f
UElQRV9DX1BBTkVMX0ZJVFRFUikgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJ
X0JfTEFORVMpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9DX0xBTkVTKSB8
CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0IpIHwgICAgICAgICAgICAgICAgICAgICAg
IFwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQykgfAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9BVURJTykgfAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9WR0EpIHwJCQkJXAorCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQorI2RlZmluZSBHTEtfRElTUExBWV9ERElfSU9fQV9Q
T1dFUl9ET01BSU5TICgJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9BX0lPKSkK
KyNkZWZpbmUgR0xLX0RJU1BMQVlfRERJX0lPX0JfUE9XRVJfRE9NQUlOUyAoCQlcCisJQklUX1VM
TChQT1dFUl9ET01BSU5fUE9SVF9ERElfQl9JTykpCisjZGVmaW5lIEdMS19ESVNQTEFZX0RESV9J
T19DX1BPV0VSX0RPTUFJTlMgKAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0Nf
SU8pKQorI2RlZmluZSBHTEtfRFBJT19DTU5fQV9QT1dFUl9ET01BSU5TICgJCQlcCisJQklUX1VM
TChQT1dFUl9ET01BSU5fUE9SVF9ERElfQV9MQU5FUykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9N
QUlOX0FVWF9BKSB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQorI2RlZmluZSBH
TEtfRFBJT19DTU5fQl9QT1dFUl9ET01BSU5TICgJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5f
UE9SVF9ERElfQl9MQU5FUykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9CKSB8CQkJ
XAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQorI2RlZmluZSBHTEtfRFBJT19DTU5fQ19Q
T1dFUl9ET01BSU5TICgJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQ19MQU5F
UykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9DKSB8CQkJXAorCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX0lOSVQpKQorI2RlZmluZSBHTEtfRElTUExBWV9BVVhfQV9QT1dFUl9ET01BSU5T
ICgJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQSkgfAkJXAorCUJJVF9VTEwoUE9XRVJf
RE9NQUlOX0FVWF9JT19BKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCisjZGVm
aW5lIEdMS19ESVNQTEFZX0FVWF9CX1BPV0VSX0RPTUFJTlMgKAkJXAorCUJJVF9VTEwoUE9XRVJf
RE9NQUlOX0FVWF9CKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCisjZGVmaW5l
IEdMS19ESVNQTEFZX0FVWF9DX1BPV0VSX0RPTUFJTlMgKAkJXAorCUJJVF9VTEwoUE9XRVJfRE9N
QUlOX0FVWF9DKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCisjZGVmaW5lIEdM
S19ESVNQTEFZX0RDX09GRl9QT1dFUl9ET01BSU5TICgJCVwKKwlHTEtfRElTUExBWV9QT1dFUldF
TExfMl9QT1dFUl9ET01BSU5TIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9HVF9JUlEpIHwJ
CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fTU9ERVNFVCkgfAkJCVwKKwlCSVRfVUxMKFBPV0VS
X0RPTUFJTl9BVVhfQSkgfAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9HTUJVUykgfAkJCVwK
KwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKKworI2RlZmluZSBDTkxfRElTUExBWV9QT1dF
UldFTExfMl9QT1dFUl9ET01BSU5TICgJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NP
REVSX0EpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0IpIHwJCQlcCisJQklUX1VM
TChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9CKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5f
UElQRV9DKSB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQykgfAkJXAor
CUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQl9QQU5FTF9GSVRURVIpIHwJCVwKKwlCSVRfVUxM
KFBPV0VSX0RPTUFJTl9QSVBFX0NfUEFORUxfRklUVEVSKSB8CQlcCisJQklUX1VMTChQT1dFUl9E
T01BSU5fUE9SVF9ERElfQl9MQU5FUykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRf
RERJX0NfTEFORVMpIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9EX0xBTkVT
KSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfRl9MQU5FUykgfAkJXAorCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9CKSB8ICAgICAgICAgICAgICAgICAgICAgICBcCisJQklU
X1VMTChQT1dFUl9ET01BSU5fQVVYX0MpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVY
X0QpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0YpIHwJCQlcCisJQklUX1VMTChQ
T1dFUl9ET01BSU5fQVVESU8pIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fVkdBKSB8CQkJ
CVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKKyNkZWZpbmUgQ05MX0RJU1BMQVlfRERJ
X0FfSU9fUE9XRVJfRE9NQUlOUyAoCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElf
QV9JTykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQorI2RlZmluZSBDTkxfRElT
UExBWV9ERElfQl9JT19QT1dFUl9ET01BSU5TICgJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9Q
T1JUX0RESV9CX0lPKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCisjZGVmaW5l
IENOTF9ESVNQTEFZX0RESV9DX0lPX1BPV0VSX0RPTUFJTlMgKAkJXAorCUJJVF9VTEwoUE9XRVJf
RE9NQUlOX1BPUlRfRERJX0NfSU8pIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkK
KyNkZWZpbmUgQ05MX0RJU1BMQVlfRERJX0RfSU9fUE9XRVJfRE9NQUlOUyAoCQlcCisJQklUX1VM
TChQT1dFUl9ET01BSU5fUE9SVF9ERElfRF9JTykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlO
X0lOSVQpKQorI2RlZmluZSBDTkxfRElTUExBWV9BVVhfQV9QT1dFUl9ET01BSU5TICgJCVwKKwlC
SVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQSkgfAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9B
VVhfSU9fQSkgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQorI2RlZmluZSBDTkxf
RElTUExBWV9BVVhfQl9QT1dFUl9ET01BSU5TICgJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9B
VVhfQikgfAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKKyNkZWZpbmUgQ05MX0RJ
U1BMQVlfQVVYX0NfUE9XRVJfRE9NQUlOUyAoCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVY
X0MpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCisjZGVmaW5lIENOTF9ESVNQ
TEFZX0FVWF9EX1BPV0VSX0RPTUFJTlMgKAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9E
KSB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQorI2RlZmluZSBDTkxfRElTUExB
WV9BVVhfRl9QT1dFUl9ET01BSU5TICgJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfRikg
fAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKKyNkZWZpbmUgQ05MX0RJU1BMQVlf
RERJX0ZfSU9fUE9XRVJfRE9NQUlOUyAoCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9E
RElfRl9JTykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQorI2RlZmluZSBDTkxf
RElTUExBWV9EQ19PRkZfUE9XRVJfRE9NQUlOUyAoCQlcCisJQ05MX0RJU1BMQVlfUE9XRVJXRUxM
XzJfUE9XRVJfRE9NQUlOUyB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fR1RfSVJRKSB8CQkJ
XAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX01PREVTRVQpIHwJCQlcCisJQklUX1VMTChQT1dFUl9E
T01BSU5fQVVYX0EpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCisKKy8qCisg
KiBJQ0wgUFdfMC9QR18wIGRvbWFpbnMgKEhXL0RNQyBjb250cm9sKToKKyAqIC0gUENJCisgKiAt
IGNsb2NrcyBleGNlcHQgcG9ydCBQTEwKKyAqIC0gY2VudHJhbCBwb3dlciBleGNlcHQgRkJDCisg
KiAtIHNoYXJlZCBmdW5jdGlvbnMgZXhjZXB0IHBpcGUgaW50ZXJydXB0cywgcGlwZSBNQlVTLCBE
QlVGIHJlZ2lzdGVycworICogSUNMIFBXXzEvUEdfMSBkb21haW5zIChIVy9ETUMgY29udHJvbCk6
CisgKiAtIERCVUYgZnVuY3Rpb24KKyAqIC0gUElQRV9BIGFuZCBpdHMgcGxhbmVzLCBleGNlcHQg
VkdBCisgKiAtIHRyYW5zY29kZXIgRURQICsgUFNSCisgKiAtIHRyYW5zY29kZXIgRFNJCisgKiAt
IERESV9BCisgKiAtIEZCQworICovCisjZGVmaW5lIElDTF9QV180X1BPV0VSX0RPTUFJTlMgKAkJ
CVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0MpIHwJCQlcCisJQklUX1VMTChQT1dFUl9E
T01BSU5fUElQRV9DX1BBTkVMX0ZJVFRFUikgfAlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5J
VCkpCisJLyogVkRTQy9qb2luaW5nICovCisjZGVmaW5lIElDTF9QV18zX1BPV0VSX0RPTUFJTlMg
KAkJCVwKKwlJQ0xfUFdfNF9QT1dFUl9ET01BSU5TIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01B
SU5fUElQRV9CKSB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQSkgfAkJ
XAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQikgfAkJXAorCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX1RSQU5TQ09ERVJfQykgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVf
Ql9QQU5FTF9GSVRURVIpIHwJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfTEFO
RVMpIHwJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfSU8pIHwJCVwKKwlCSVRf
VUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9DX0xBTkVTKSB8CVwKKwlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9QT1JUX0RESV9DX0lPKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElf
RF9MQU5FUykgfAlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfRF9JTykgfAkJXAor
CUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0VfTEFORVMpIHwJXAorCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX1BPUlRfRERJX0VfSU8pIHwJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JU
X0RESV9GX0xBTkVTKSB8CVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9GX0lPKSB8
CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0IpIHwJCQlcCisJQklUX1VMTChQT1dFUl9E
T01BSU5fQVVYX0MpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0QpIHwJCQlcCisJ
QklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0UpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5f
QVVYX0YpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX1RCVDEpIHwJCVwKKwlCSVRf
VUxMKFBPV0VSX0RPTUFJTl9BVVhfVEJUMikgfAkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FV
WF9UQlQzKSB8CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX1RCVDQpIHwJCVwKKwlCSVRf
VUxMKFBPV0VSX0RPTUFJTl9WR0EpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVESU8p
IHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCisJLyoKKwkgKiAtIHRyYW5zY29k
ZXIgV0QKKwkgKiAtIEtWTVIgKEhXIGNvbnRyb2wpCisJICovCisjZGVmaW5lIElDTF9QV18yX1BP
V0VSX0RPTUFJTlMgKAkJCVwKKwlJQ0xfUFdfM19QT1dFUl9ET01BSU5TIHwJCQlcCisJQklUX1VM
TChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9FRFBfVkRTQykgfAkJXAorCUJJVF9VTEwoUE9XRVJf
RE9NQUlOX0lOSVQpKQorCS8qCisJICogLSBLVk1SIChIVyBjb250cm9sKQorCSAqLworI2RlZmlu
ZSBJQ0xfRElTUExBWV9EQ19PRkZfUE9XRVJfRE9NQUlOUyAoCQlcCisJSUNMX1BXXzJfUE9XRVJf
RE9NQUlOUyB8CQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX01PREVTRVQpIHwJCQlcCisJQklU
X1VMTChQT1dFUl9ET01BSU5fQVVYX0EpIHwJCQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fSU5J
VCkpCisKKyNkZWZpbmUgSUNMX0RESV9JT19BX1BPV0VSX0RPTUFJTlMgKAkJCVwKKwlCSVRfVUxM
KFBPV0VSX0RPTUFJTl9QT1JUX0RESV9BX0lPKSkKKyNkZWZpbmUgSUNMX0RESV9JT19CX1BPV0VS
X0RPTUFJTlMgKAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9CX0lPKSkKKyNk
ZWZpbmUgSUNMX0RESV9JT19DX1BPV0VSX0RPTUFJTlMgKAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9QT1JUX0RESV9DX0lPKSkKKyNkZWZpbmUgSUNMX0RESV9JT19EX1BPV0VSX0RPTUFJTlMg
KAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9EX0lPKSkKKyNkZWZpbmUgSUNM
X0RESV9JT19FX1BPV0VSX0RPTUFJTlMgKAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JU
X0RESV9FX0lPKSkKKyNkZWZpbmUgSUNMX0RESV9JT19GX1BPV0VSX0RPTUFJTlMgKAkJCVwKKwlC
SVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9GX0lPKSkKKworI2RlZmluZSBJQ0xfQVVYX0Ff
SU9fUE9XRVJfRE9NQUlOUyAoCQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9JT19BKSB8
CQlcCisJQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0EpKQorI2RlZmluZSBJQ0xfQVVYX0JfSU9f
UE9XRVJfRE9NQUlOUyAoCQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9CKSkKKyNkZWZp
bmUgSUNMX0FVWF9DX0lPX1BPV0VSX0RPTUFJTlMgKAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJ
Tl9BVVhfQykpCisjZGVmaW5lIElDTF9BVVhfRF9JT19QT1dFUl9ET01BSU5TICgJCQlcCisJQklU
X1VMTChQT1dFUl9ET01BSU5fQVVYX0QpKQorI2RlZmluZSBJQ0xfQVVYX0VfSU9fUE9XRVJfRE9N
QUlOUyAoCQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9FKSkKKyNkZWZpbmUgSUNMX0FV
WF9GX0lPX1BPV0VSX0RPTUFJTlMgKAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfRikp
CisjZGVmaW5lIElDTF9BVVhfVEJUMV9JT19QT1dFUl9ET01BSU5TICgJCQlcCisJQklUX1VMTChQ
T1dFUl9ET01BSU5fQVVYX1RCVDEpKQorI2RlZmluZSBJQ0xfQVVYX1RCVDJfSU9fUE9XRVJfRE9N
QUlOUyAoCQkJXAorCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9UQlQyKSkKKyNkZWZpbmUgSUNM
X0FVWF9UQlQzX0lPX1BPV0VSX0RPTUFJTlMgKAkJCVwKKwlCSVRfVUxMKFBPV0VSX0RPTUFJTl9B
VVhfVEJUMykpCisjZGVmaW5lIElDTF9BVVhfVEJUNF9JT19QT1dFUl9ET01BSU5TICgJCQlcCisJ
QklUX1VMTChQT1dFUl9ET01BSU5fQVVYX1RCVDQpKQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGk5
MTVfcG93ZXJfd2VsbF9vcHMgaTl4eF9hbHdheXNfb25fcG93ZXJfd2VsbF9vcHMgPSB7CisJLnN5
bmNfaHcgPSBpOXh4X3Bvd2VyX3dlbGxfc3luY19od19ub29wLAorCS5lbmFibGUgPSBpOXh4X2Fs
d2F5c19vbl9wb3dlcl93ZWxsX25vb3AsCisJLmRpc2FibGUgPSBpOXh4X2Fsd2F5c19vbl9wb3dl
cl93ZWxsX25vb3AsCisJLmlzX2VuYWJsZWQgPSBpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX2Vu
YWJsZWQsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9vcHMgY2h2
X3BpcGVfcG93ZXJfd2VsbF9vcHMgPSB7CisJLnN5bmNfaHcgPSBpOXh4X3Bvd2VyX3dlbGxfc3lu
Y19od19ub29wLAorCS5lbmFibGUgPSBjaHZfcGlwZV9wb3dlcl93ZWxsX2VuYWJsZSwKKwkuZGlz
YWJsZSA9IGNodl9waXBlX3Bvd2VyX3dlbGxfZGlzYWJsZSwKKwkuaXNfZW5hYmxlZCA9IGNodl9w
aXBlX3Bvd2VyX3dlbGxfZW5hYmxlZCwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9w
b3dlcl93ZWxsX29wcyBjaHZfZHBpb19jbW5fcG93ZXJfd2VsbF9vcHMgPSB7CisJLnN5bmNfaHcg
PSBpOXh4X3Bvd2VyX3dlbGxfc3luY19od19ub29wLAorCS5lbmFibGUgPSBjaHZfZHBpb19jbW5f
cG93ZXJfd2VsbF9lbmFibGUsCisJLmRpc2FibGUgPSBjaHZfZHBpb19jbW5fcG93ZXJfd2VsbF9k
aXNhYmxlLAorCS5pc19lbmFibGVkID0gdmx2X3Bvd2VyX3dlbGxfZW5hYmxlZCwKK307CisKK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX2Rlc2MgaTl4eF9hbHdheXNfb25fcG93
ZXJfd2VsbFtdID0geworCXsKKwkJLm5hbWUgPSAiYWx3YXlzLW9uIiwKKwkJLmFsd2F5c19vbiA9
IHRydWUsCisJCS5kb21haW5zID0gUE9XRVJfRE9NQUlOX01BU0ssCisJCS5vcHMgPSAmaTl4eF9h
bHdheXNfb25fcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwl9LAor
fTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfb3BzIGk4MzBfcGlwZXNf
cG93ZXJfd2VsbF9vcHMgPSB7CisJLnN5bmNfaHcgPSBpODMwX3BpcGVzX3Bvd2VyX3dlbGxfc3lu
Y19odywKKwkuZW5hYmxlID0gaTgzMF9waXBlc19wb3dlcl93ZWxsX2VuYWJsZSwKKwkuZGlzYWJs
ZSA9IGk4MzBfcGlwZXNfcG93ZXJfd2VsbF9kaXNhYmxlLAorCS5pc19lbmFibGVkID0gaTgzMF9w
aXBlc19wb3dlcl93ZWxsX2VuYWJsZWQsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVf
cG93ZXJfd2VsbF9kZXNjIGk4MzBfcG93ZXJfd2VsbHNbXSA9IHsKKwl7CisJCS5uYW1lID0gImFs
d2F5cy1vbiIsCisJCS5hbHdheXNfb24gPSB0cnVlLAorCQkuZG9tYWlucyA9IFBPV0VSX0RPTUFJ
Tl9NQVNLLAorCQkub3BzID0gJmk5eHhfYWx3YXlzX29uX3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQg
PSBESVNQX1BXX0lEX05PTkUsCisJfSwKKwl7CisJCS5uYW1lID0gInBpcGVzIiwKKwkJLmRvbWFp
bnMgPSBJODMwX1BJUEVTX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmaTgzMF9waXBlc19wb3dl
cl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCX0sCit9OworCitzdGF0aWMg
Y29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9vcHMgaHN3X3Bvd2VyX3dlbGxfb3BzID0gewor
CS5zeW5jX2h3ID0gaHN3X3Bvd2VyX3dlbGxfc3luY19odywKKwkuZW5hYmxlID0gaHN3X3Bvd2Vy
X3dlbGxfZW5hYmxlLAorCS5kaXNhYmxlID0gaHN3X3Bvd2VyX3dlbGxfZGlzYWJsZSwKKwkuaXNf
ZW5hYmxlZCA9IGhzd19wb3dlcl93ZWxsX2VuYWJsZWQsCit9OworCitzdGF0aWMgY29uc3Qgc3Ry
dWN0IGk5MTVfcG93ZXJfd2VsbF9vcHMgZ2VuOV9kY19vZmZfcG93ZXJfd2VsbF9vcHMgPSB7CisJ
LnN5bmNfaHcgPSBpOXh4X3Bvd2VyX3dlbGxfc3luY19od19ub29wLAorCS5lbmFibGUgPSBnZW45
X2RjX29mZl9wb3dlcl93ZWxsX2VuYWJsZSwKKwkuZGlzYWJsZSA9IGdlbjlfZGNfb2ZmX3Bvd2Vy
X3dlbGxfZGlzYWJsZSwKKwkuaXNfZW5hYmxlZCA9IGdlbjlfZGNfb2ZmX3Bvd2VyX3dlbGxfZW5h
YmxlZCwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX29wcyBieHRf
ZHBpb19jbW5fcG93ZXJfd2VsbF9vcHMgPSB7CisJLnN5bmNfaHcgPSBpOXh4X3Bvd2VyX3dlbGxf
c3luY19od19ub29wLAorCS5lbmFibGUgPSBieHRfZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGUs
CisJLmRpc2FibGUgPSBieHRfZHBpb19jbW5fcG93ZXJfd2VsbF9kaXNhYmxlLAorCS5pc19lbmFi
bGVkID0gYnh0X2RwaW9fY21uX3Bvd2VyX3dlbGxfZW5hYmxlZCwKK307CisKK3N0YXRpYyBjb25z
dCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX3JlZ3MgaHN3X3Bvd2VyX3dlbGxfcmVncyA9IHsKKwku
Ymlvcwk9IEhTV19QV1JfV0VMTF9DVEwxLAorCS5kcml2ZXIJPSBIU1dfUFdSX1dFTExfQ1RMMiwK
Kwkua3Ztcgk9IEhTV19QV1JfV0VMTF9DVEwzLAorCS5kZWJ1Zwk9IEhTV19QV1JfV0VMTF9DVEw0
LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfZGVzYyBoc3dfcG93
ZXJfd2VsbHNbXSA9IHsKKwl7CisJCS5uYW1lID0gImFsd2F5cy1vbiIsCisJCS5hbHdheXNfb24g
PSB0cnVlLAorCQkuZG9tYWlucyA9IFBPV0VSX0RPTUFJTl9NQVNLLAorCQkub3BzID0gJmk5eHhf
YWx3YXlzX29uX3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJfSwK
Kwl7CisJCS5uYW1lID0gImRpc3BsYXkiLAorCQkuZG9tYWlucyA9IEhTV19ESVNQTEFZX1BPV0VS
X0RPTUFJTlMsCisJCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBIU1dfRElT
UF9QV19HTE9CQUwsCisJCXsKKwkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAor
CQkJLmhzdy5pZHggPSBIU1dfUFdfQ1RMX0lEWF9HTE9CQUwsCisJCQkuaHN3Lmhhc192Z2EgPSB0
cnVlLAorCQl9LAorCX0sCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2Vs
bF9kZXNjIGJkd19wb3dlcl93ZWxsc1tdID0geworCXsKKwkJLm5hbWUgPSAiYWx3YXlzLW9uIiwK
KwkJLmFsd2F5c19vbiA9IHRydWUsCisJCS5kb21haW5zID0gUE9XRVJfRE9NQUlOX01BU0ssCisJ
CS5vcHMgPSAmaTl4eF9hbHdheXNfb25fcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdf
SURfTk9ORSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiZGlzcGxheSIsCisJCS5kb21haW5zID0gQkRX
X0RJU1BMQVlfUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCisJ
CS5pZCA9IEhTV19ESVNQX1BXX0dMT0JBTCwKKwkJeworCQkJLmhzdy5yZWdzID0gJmhzd19wb3dl
cl93ZWxsX3JlZ3MsCisJCQkuaHN3LmlkeCA9IEhTV19QV19DVExfSURYX0dMT0JBTCwKKwkJCS5o
c3cuaXJxX3BpcGVfbWFzayA9IEJJVChQSVBFX0IpIHwgQklUKFBJUEVfQyksCisJCQkuaHN3Lmhh
c192Z2EgPSB0cnVlLAorCQl9LAorCX0sCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVf
cG93ZXJfd2VsbF9vcHMgdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9vcHMgPSB7CisJLnN5bmNfaHcg
PSBpOXh4X3Bvd2VyX3dlbGxfc3luY19od19ub29wLAorCS5lbmFibGUgPSB2bHZfZGlzcGxheV9w
b3dlcl93ZWxsX2VuYWJsZSwKKwkuZGlzYWJsZSA9IHZsdl9kaXNwbGF5X3Bvd2VyX3dlbGxfZGlz
YWJsZSwKKwkuaXNfZW5hYmxlZCA9IHZsdl9wb3dlcl93ZWxsX2VuYWJsZWQsCit9OworCitzdGF0
aWMgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9vcHMgdmx2X2RwaW9fY21uX3Bvd2VyX3dl
bGxfb3BzID0geworCS5zeW5jX2h3ID0gaTl4eF9wb3dlcl93ZWxsX3N5bmNfaHdfbm9vcCwKKwku
ZW5hYmxlID0gdmx2X2RwaW9fY21uX3Bvd2VyX3dlbGxfZW5hYmxlLAorCS5kaXNhYmxlID0gdmx2
X2RwaW9fY21uX3Bvd2VyX3dlbGxfZGlzYWJsZSwKKwkuaXNfZW5hYmxlZCA9IHZsdl9wb3dlcl93
ZWxsX2VuYWJsZWQsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9v
cHMgdmx2X2RwaW9fcG93ZXJfd2VsbF9vcHMgPSB7CisJLnN5bmNfaHcgPSBpOXh4X3Bvd2VyX3dl
bGxfc3luY19od19ub29wLAorCS5lbmFibGUgPSB2bHZfcG93ZXJfd2VsbF9lbmFibGUsCisJLmRp
c2FibGUgPSB2bHZfcG93ZXJfd2VsbF9kaXNhYmxlLAorCS5pc19lbmFibGVkID0gdmx2X3Bvd2Vy
X3dlbGxfZW5hYmxlZCwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxs
X2Rlc2Mgdmx2X3Bvd2VyX3dlbGxzW10gPSB7CisJeworCQkubmFtZSA9ICJhbHdheXMtb24iLAor
CQkuYWx3YXlzX29uID0gdHJ1ZSwKKwkJLmRvbWFpbnMgPSBQT1dFUl9ET01BSU5fTUFTSywKKwkJ
Lm9wcyA9ICZpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19J
RF9OT05FLAorCX0sCisJeworCQkubmFtZSA9ICJkaXNwbGF5IiwKKwkJLmRvbWFpbnMgPSBWTFZf
RElTUExBWV9QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJnZsdl9kaXNwbGF5X3Bvd2VyX3dlbGxf
b3BzLAorCQkuaWQgPSBWTFZfRElTUF9QV19ESVNQMkQsCisJCXsKKwkJCS52bHYuaWR4ID0gUFVO
SVRfUFdHVF9JRFhfRElTUDJELAorCQl9LAorCX0sCisJeworCQkubmFtZSA9ICJkcGlvLXR4LWIt
MDEiLAorCQkuZG9tYWlucyA9IFZMVl9EUElPX1RYX0JfTEFORVNfMDFfUE9XRVJfRE9NQUlOUyB8
CisJCQkgICBWTFZfRFBJT19UWF9CX0xBTkVTXzIzX1BPV0VSX0RPTUFJTlMgfAorCQkJICAgVkxW
X0RQSU9fVFhfQ19MQU5FU18wMV9QT1dFUl9ET01BSU5TIHwKKwkJCSAgIFZMVl9EUElPX1RYX0Nf
TEFORVNfMjNfUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9ICZ2bHZfZHBpb19wb3dlcl93ZWxsX29w
cywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCQl7CisJCQkudmx2LmlkeCA9IFBVTklUX1BX
R1RfSURYX0RQSU9fVFhfQl9MQU5FU18wMSwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiZHBp
by10eC1iLTIzIiwKKwkJLmRvbWFpbnMgPSBWTFZfRFBJT19UWF9CX0xBTkVTXzAxX1BPV0VSX0RP
TUFJTlMgfAorCQkJICAgVkxWX0RQSU9fVFhfQl9MQU5FU18yM19QT1dFUl9ET01BSU5TIHwKKwkJ
CSAgIFZMVl9EUElPX1RYX0NfTEFORVNfMDFfUE9XRVJfRE9NQUlOUyB8CisJCQkgICBWTFZfRFBJ
T19UWF9DX0xBTkVTXzIzX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmdmx2X2RwaW9fcG93ZXJf
d2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwkJeworCQkJLnZsdi5pZHggPSBQ
VU5JVF9QV0dUX0lEWF9EUElPX1RYX0JfTEFORVNfMjMsCisJCX0sCisJfSwKKwl7CisJCS5uYW1l
ID0gImRwaW8tdHgtYy0wMSIsCisJCS5kb21haW5zID0gVkxWX0RQSU9fVFhfQl9MQU5FU18wMV9Q
T1dFUl9ET01BSU5TIHwKKwkJCSAgIFZMVl9EUElPX1RYX0JfTEFORVNfMjNfUE9XRVJfRE9NQUlO
UyB8CisJCQkgICBWTFZfRFBJT19UWF9DX0xBTkVTXzAxX1BPV0VSX0RPTUFJTlMgfAorCQkJICAg
VkxWX0RQSU9fVFhfQ19MQU5FU18yM19QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJnZsdl9kcGlv
X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJCXsKKwkJCS52bHYu
aWR4ID0gUFVOSVRfUFdHVF9JRFhfRFBJT19UWF9DX0xBTkVTXzAxLAorCQl9LAorCX0sCisJewor
CQkubmFtZSA9ICJkcGlvLXR4LWMtMjMiLAorCQkuZG9tYWlucyA9IFZMVl9EUElPX1RYX0JfTEFO
RVNfMDFfUE9XRVJfRE9NQUlOUyB8CisJCQkgICBWTFZfRFBJT19UWF9CX0xBTkVTXzIzX1BPV0VS
X0RPTUFJTlMgfAorCQkJICAgVkxWX0RQSU9fVFhfQ19MQU5FU18wMV9QT1dFUl9ET01BSU5TIHwK
KwkJCSAgIFZMVl9EUElPX1RYX0NfTEFORVNfMjNfUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9ICZ2
bHZfZHBpb19wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCQl7CisJ
CQkudmx2LmlkeCA9IFBVTklUX1BXR1RfSURYX0RQSU9fVFhfQ19MQU5FU18yMywKKwkJfSwKKwl9
LAorCXsKKwkJLm5hbWUgPSAiZHBpby1jb21tb24iLAorCQkuZG9tYWlucyA9IFZMVl9EUElPX0NN
Tl9CQ19QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJnZsdl9kcGlvX2Ntbl9wb3dlcl93ZWxsX29w
cywKKwkJLmlkID0gVkxWX0RJU1BfUFdfRFBJT19DTU5fQkMsCisJCXsKKwkJCS52bHYuaWR4ID0g
UFVOSVRfUFdHVF9JRFhfRFBJT19DTU5fQkMsCisJCX0sCisJfSwKK307CisKK3N0YXRpYyBjb25z
dCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX2Rlc2MgY2h2X3Bvd2VyX3dlbGxzW10gPSB7CisJewor
CQkubmFtZSA9ICJhbHdheXMtb24iLAorCQkuYWx3YXlzX29uID0gdHJ1ZSwKKwkJLmRvbWFpbnMg
PSBQT1dFUl9ET01BSU5fTUFTSywKKwkJLm9wcyA9ICZpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxs
X29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCX0sCisJeworCQkubmFtZSA9ICJkaXNw
bGF5IiwKKwkJLyoKKwkJICogUGlwZSBBIHBvd2VyIHdlbGwgaXMgdGhlIG5ldyBkaXNwMmQgd2Vs
bC4gUGlwZSBCIGFuZCBDCisJCSAqIHBvd2VyIHdlbGxzIGRvbid0IGFjdHVhbGx5IGV4aXN0LiBQ
aXBlIEEgcG93ZXIgd2VsbCBpcworCQkgKiByZXF1aXJlZCBmb3IgYW55IHBpcGUgdG8gd29yay4K
KwkJICovCisJCS5kb21haW5zID0gQ0hWX0RJU1BMQVlfUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9
ICZjaHZfcGlwZV9wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCX0s
CisJeworCQkubmFtZSA9ICJkcGlvLWNvbW1vbi1iYyIsCisJCS5kb21haW5zID0gQ0hWX0RQSU9f
Q01OX0JDX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmY2h2X2RwaW9fY21uX3Bvd2VyX3dlbGxf
b3BzLAorCQkuaWQgPSBWTFZfRElTUF9QV19EUElPX0NNTl9CQywKKwkJeworCQkJLnZsdi5pZHgg
PSBQVU5JVF9QV0dUX0lEWF9EUElPX0NNTl9CQywKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAi
ZHBpby1jb21tb24tZCIsCisJCS5kb21haW5zID0gQ0hWX0RQSU9fQ01OX0RfUE9XRVJfRE9NQUlO
UywKKwkJLm9wcyA9ICZjaHZfZHBpb19jbW5fcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9IENIVl9E
SVNQX1BXX0RQSU9fQ01OX0QsCisJCXsKKwkJCS52bHYuaWR4ID0gUFVOSVRfUFdHVF9JRFhfRFBJ
T19DTU5fRCwKKwkJfSwKKwl9LAorfTsKKworYm9vbCBpbnRlbF9kaXNwbGF5X3Bvd2VyX3dlbGxf
aXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJCSBlbnVt
IGk5MTVfcG93ZXJfd2VsbF9pZCBwb3dlcl93ZWxsX2lkKQoreworCXN0cnVjdCBpOTE1X3Bvd2Vy
X3dlbGwgKnBvd2VyX3dlbGw7CisJYm9vbCByZXQ7CisKKwlwb3dlcl93ZWxsID0gbG9va3VwX3Bv
d2VyX3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGxfaWQpOworCXJldCA9IHBvd2VyX3dlbGwtPmRl
c2MtPm9wcy0+aXNfZW5hYmxlZChkZXZfcHJpdiwgcG93ZXJfd2VsbCk7CisKKwlyZXR1cm4gcmV0
OworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9kZXNjIHNrbF9wb3dl
cl93ZWxsc1tdID0geworCXsKKwkJLm5hbWUgPSAiYWx3YXlzLW9uIiwKKwkJLmFsd2F5c19vbiA9
IHRydWUsCisJCS5kb21haW5zID0gUE9XRVJfRE9NQUlOX01BU0ssCisJCS5vcHMgPSAmaTl4eF9h
bHdheXNfb25fcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwl9LAor
CXsKKwkJLm5hbWUgPSAicG93ZXIgd2VsbCAxIiwKKwkJLyogSGFuZGxlZCBieSB0aGUgRE1DIGZp
cm13YXJlICovCisJCS5hbHdheXNfb24gPSB0cnVlLAorCQkuZG9tYWlucyA9IDAsCisJCS5vcHMg
PSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBTS0xfRElTUF9QV18xLAorCQl7CisJCQku
aHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0gU0tMX1BXX0NU
TF9JRFhfUFdfMSwKKwkJCS5oc3cuaGFzX2Z1c2VzID0gdHJ1ZSwKKwkJfSwKKwl9LAorCXsKKwkJ
Lm5hbWUgPSAiTUlTQyBJTyBwb3dlciB3ZWxsIiwKKwkJLyogSGFuZGxlZCBieSB0aGUgRE1DIGZp
cm13YXJlICovCisJCS5hbHdheXNfb24gPSB0cnVlLAorCQkuZG9tYWlucyA9IDAsCisJCS5vcHMg
PSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBTS0xfRElTUF9QV19NSVNDX0lPLAorCQl7
CisJCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0gU0tM
X1BXX0NUTF9JRFhfTUlTQ19JTywKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiREMgb2ZmIiwK
KwkJLmRvbWFpbnMgPSBTS0xfRElTUExBWV9EQ19PRkZfUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9
ICZnZW45X2RjX29mZl9wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAor
CX0sCisJeworCQkubmFtZSA9ICJwb3dlciB3ZWxsIDIiLAorCQkuZG9tYWlucyA9IFNLTF9ESVNQ
TEFZX1BPV0VSV0VMTF8yX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxf
b3BzLAorCQkuaWQgPSBTS0xfRElTUF9QV18yLAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaHN3X3Bv
d2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0gU0tMX1BXX0NUTF9JRFhfUFdfMiwKKwkJCS5o
c3cuaXJxX3BpcGVfbWFzayA9IEJJVChQSVBFX0IpIHwgQklUKFBJUEVfQyksCisJCQkuaHN3Lmhh
c192Z2EgPSB0cnVlLAorCQkJLmhzdy5oYXNfZnVzZXMgPSB0cnVlLAorCQl9LAorCX0sCisJewor
CQkubmFtZSA9ICJEREkgQS9FIElPIHBvd2VyIHdlbGwiLAorCQkuZG9tYWlucyA9IFNLTF9ESVNQ
TEFZX0RESV9JT19BX0VfUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9v
cHMsCisJCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwkJeworCQkJLmhzdy5yZWdzID0gJmhzd19w
b3dlcl93ZWxsX3JlZ3MsCisJCQkuaHN3LmlkeCA9IFNLTF9QV19DVExfSURYX0RESV9BX0UsCisJ
CX0sCisJfSwKKwl7CisJCS5uYW1lID0gIkRESSBCIElPIHBvd2VyIHdlbGwiLAorCQkuZG9tYWlu
cyA9IFNLTF9ESVNQTEFZX0RESV9JT19CX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmaHN3X3Bv
d2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJCXsKKwkJCS5oc3cucmVn
cyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAorCQkJLmhzdy5pZHggPSBTS0xfUFdfQ1RMX0lEWF9E
RElfQiwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiRERJIEMgSU8gcG93ZXIgd2VsbCIsCisJ
CS5kb21haW5zID0gU0tMX0RJU1BMQVlfRERJX0lPX0NfUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9
ICZoc3dfcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwkJeworCQkJ
Lmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3MsCisJCQkuaHN3LmlkeCA9IFNLTF9QV19D
VExfSURYX0RESV9DLAorCQl9LAorCX0sCisJeworCQkubmFtZSA9ICJEREkgRCBJTyBwb3dlciB3
ZWxsIiwKKwkJLmRvbWFpbnMgPSBTS0xfRElTUExBWV9ERElfSU9fRF9QT1dFUl9ET01BSU5TLAor
CQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAor
CQl7CisJCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0g
U0tMX1BXX0NUTF9JRFhfRERJX0QsCisJCX0sCisJfSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1
Y3QgaTkxNV9wb3dlcl93ZWxsX2Rlc2MgYnh0X3Bvd2VyX3dlbGxzW10gPSB7CisJeworCQkubmFt
ZSA9ICJhbHdheXMtb24iLAorCQkuYWx3YXlzX29uID0gdHJ1ZSwKKwkJLmRvbWFpbnMgPSBQT1dF
Ul9ET01BSU5fTUFTSywKKwkJLm9wcyA9ICZpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX29wcywK
KwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCX0sCisJeworCQkubmFtZSA9ICJwb3dlciB3ZWxs
IDEiLAorCQkvKiBIYW5kbGVkIGJ5IHRoZSBETUMgZmlybXdhcmUgKi8KKwkJLmFsd2F5c19vbiA9
IHRydWUsCisJCS5kb21haW5zID0gMCwKKwkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCisJ
CS5pZCA9IFNLTF9ESVNQX1BXXzEsCisJCXsKKwkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2Vs
bF9yZWdzLAorCQkJLmhzdy5pZHggPSBTS0xfUFdfQ1RMX0lEWF9QV18xLAorCQkJLmhzdy5oYXNf
ZnVzZXMgPSB0cnVlLAorCQl9LAorCX0sCisJeworCQkubmFtZSA9ICJEQyBvZmYiLAorCQkuZG9t
YWlucyA9IEJYVF9ESVNQTEFZX0RDX09GRl9QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJmdlbjlf
ZGNfb2ZmX3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJfSwKKwl7
CisJCS5uYW1lID0gInBvd2VyIHdlbGwgMiIsCisJCS5kb21haW5zID0gQlhUX0RJU1BMQVlfUE9X
RVJXRUxMXzJfUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCisJ
CS5pZCA9IFNLTF9ESVNQX1BXXzIsCisJCXsKKwkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2Vs
bF9yZWdzLAorCQkJLmhzdy5pZHggPSBTS0xfUFdfQ1RMX0lEWF9QV18yLAorCQkJLmhzdy5pcnFf
cGlwZV9tYXNrID0gQklUKFBJUEVfQikgfCBCSVQoUElQRV9DKSwKKwkJCS5oc3cuaGFzX3ZnYSA9
IHRydWUsCisJCQkuaHN3Lmhhc19mdXNlcyA9IHRydWUsCisJCX0sCisJfSwKKwl7CisJCS5uYW1l
ID0gImRwaW8tY29tbW9uLWEiLAorCQkuZG9tYWlucyA9IEJYVF9EUElPX0NNTl9BX1BPV0VSX0RP
TUFJTlMsCisJCS5vcHMgPSAmYnh0X2RwaW9fY21uX3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBC
WFRfRElTUF9QV19EUElPX0NNTl9BLAorCQl7CisJCQkuYnh0LnBoeSA9IERQSU9fUEhZMSwKKwkJ
fSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiZHBpby1jb21tb24tYmMiLAorCQkuZG9tYWlucyA9IEJY
VF9EUElPX0NNTl9CQ19QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJmJ4dF9kcGlvX2Ntbl9wb3dl
cl93ZWxsX29wcywKKwkJLmlkID0gVkxWX0RJU1BfUFdfRFBJT19DTU5fQkMsCisJCXsKKwkJCS5i
eHQucGh5ID0gRFBJT19QSFkwLAorCQl9LAorCX0sCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0
IGk5MTVfcG93ZXJfd2VsbF9kZXNjIGdsa19wb3dlcl93ZWxsc1tdID0geworCXsKKwkJLm5hbWUg
PSAiYWx3YXlzLW9uIiwKKwkJLmFsd2F5c19vbiA9IHRydWUsCisJCS5kb21haW5zID0gUE9XRVJf
RE9NQUlOX01BU0ssCisJCS5vcHMgPSAmaTl4eF9hbHdheXNfb25fcG93ZXJfd2VsbF9vcHMsCisJ
CS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwl9LAorCXsKKwkJLm5hbWUgPSAicG93ZXIgd2VsbCAx
IiwKKwkJLyogSGFuZGxlZCBieSB0aGUgRE1DIGZpcm13YXJlICovCisJCS5hbHdheXNfb24gPSB0
cnVlLAorCQkuZG9tYWlucyA9IDAsCisJCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAorCQku
aWQgPSBTS0xfRElTUF9QV18xLAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxf
cmVncywKKwkJCS5oc3cuaWR4ID0gU0tMX1BXX0NUTF9JRFhfUFdfMSwKKwkJCS5oc3cuaGFzX2Z1
c2VzID0gdHJ1ZSwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiREMgb2ZmIiwKKwkJLmRvbWFp
bnMgPSBHTEtfRElTUExBWV9EQ19PRkZfUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9ICZnZW45X2Rj
X29mZl9wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCX0sCisJewor
CQkubmFtZSA9ICJwb3dlciB3ZWxsIDIiLAorCQkuZG9tYWlucyA9IEdMS19ESVNQTEFZX1BPV0VS
V0VMTF8yX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAorCQku
aWQgPSBTS0xfRElTUF9QV18yLAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxf
cmVncywKKwkJCS5oc3cuaWR4ID0gU0tMX1BXX0NUTF9JRFhfUFdfMiwKKwkJCS5oc3cuaXJxX3Bp
cGVfbWFzayA9IEJJVChQSVBFX0IpIHwgQklUKFBJUEVfQyksCisJCQkuaHN3Lmhhc192Z2EgPSB0
cnVlLAorCQkJLmhzdy5oYXNfZnVzZXMgPSB0cnVlLAorCQl9LAorCX0sCisJeworCQkubmFtZSA9
ICJkcGlvLWNvbW1vbi1hIiwKKwkJLmRvbWFpbnMgPSBHTEtfRFBJT19DTU5fQV9QT1dFUl9ET01B
SU5TLAorCQkub3BzID0gJmJ4dF9kcGlvX2Ntbl9wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gQlhU
X0RJU1BfUFdfRFBJT19DTU5fQSwKKwkJeworCQkJLmJ4dC5waHkgPSBEUElPX1BIWTEsCisJCX0s
CisJfSwKKwl7CisJCS5uYW1lID0gImRwaW8tY29tbW9uLWIiLAorCQkuZG9tYWlucyA9IEdMS19E
UElPX0NNTl9CX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmYnh0X2RwaW9fY21uX3Bvd2VyX3dl
bGxfb3BzLAorCQkuaWQgPSBWTFZfRElTUF9QV19EUElPX0NNTl9CQywKKwkJeworCQkJLmJ4dC5w
aHkgPSBEUElPX1BIWTAsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lID0gImRwaW8tY29tbW9uLWMi
LAorCQkuZG9tYWlucyA9IEdMS19EUElPX0NNTl9DX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAm
Ynh0X2RwaW9fY21uX3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBHTEtfRElTUF9QV19EUElPX0NN
Tl9DLAorCQl7CisJCQkuYnh0LnBoeSA9IERQSU9fUEhZMiwKKwkJfSwKKwl9LAorCXsKKwkJLm5h
bWUgPSAiQVVYIEEiLAorCQkuZG9tYWlucyA9IEdMS19ESVNQTEFZX0FVWF9BX1BPV0VSX0RPTUFJ
TlMsCisJCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05P
TkUsCisJCXsKKwkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAorCQkJLmhzdy5p
ZHggPSBHTEtfUFdfQ1RMX0lEWF9BVVhfQSwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiQVVY
IEIiLAorCQkuZG9tYWlucyA9IEdMS19ESVNQTEFZX0FVWF9CX1BPV0VSX0RPTUFJTlMsCisJCS5v
cHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJCXsK
KwkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAorCQkJLmhzdy5pZHggPSBHTEtf
UFdfQ1RMX0lEWF9BVVhfQiwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiQVVYIEMiLAorCQku
ZG9tYWlucyA9IEdMS19ESVNQTEFZX0FVWF9DX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmaHN3
X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJCXsKKwkJCS5oc3cu
cmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAorCQkJLmhzdy5pZHggPSBHTEtfUFdfQ1RMX0lE
WF9BVVhfQywKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiRERJIEEgSU8gcG93ZXIgd2VsbCIs
CisJCS5kb21haW5zID0gR0xLX0RJU1BMQVlfRERJX0lPX0FfUE9XRVJfRE9NQUlOUywKKwkJLm9w
cyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwkJewor
CQkJLmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3MsCisJCQkuaHN3LmlkeCA9IEdMS19Q
V19DVExfSURYX0RESV9BLAorCQl9LAorCX0sCisJeworCQkubmFtZSA9ICJEREkgQiBJTyBwb3dl
ciB3ZWxsIiwKKwkJLmRvbWFpbnMgPSBHTEtfRElTUExBWV9ERElfSU9fQl9QT1dFUl9ET01BSU5T
LAorCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05F
LAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4
ID0gU0tMX1BXX0NUTF9JRFhfRERJX0IsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lID0gIkRESSBD
IElPIHBvd2VyIHdlbGwiLAorCQkuZG9tYWlucyA9IEdMS19ESVNQTEFZX0RESV9JT19DX1BPV0VS
X0RPTUFJTlMsCisJCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BX
X0lEX05PTkUsCisJCXsKKwkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAorCQkJ
Lmhzdy5pZHggPSBTS0xfUFdfQ1RMX0lEWF9ERElfQywKKwkJfSwKKwl9LAorfTsKKworc3RhdGlj
IGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfZGVzYyBjbmxfcG93ZXJfd2VsbHNbXSA9IHsK
Kwl7CisJCS5uYW1lID0gImFsd2F5cy1vbiIsCisJCS5hbHdheXNfb24gPSB0cnVlLAorCQkuZG9t
YWlucyA9IFBPV0VSX0RPTUFJTl9NQVNLLAorCQkub3BzID0gJmk5eHhfYWx3YXlzX29uX3Bvd2Vy
X3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJfSwKKwl7CisJCS5uYW1lID0g
InBvd2VyIHdlbGwgMSIsCisJCS8qIEhhbmRsZWQgYnkgdGhlIERNQyBmaXJtd2FyZSAqLworCQku
YWx3YXlzX29uID0gdHJ1ZSwKKwkJLmRvbWFpbnMgPSAwLAorCQkub3BzID0gJmhzd19wb3dlcl93
ZWxsX29wcywKKwkJLmlkID0gU0tMX0RJU1BfUFdfMSwKKwkJeworCQkJLmhzdy5yZWdzID0gJmhz
d19wb3dlcl93ZWxsX3JlZ3MsCisJCQkuaHN3LmlkeCA9IFNLTF9QV19DVExfSURYX1BXXzEsCisJ
CQkuaHN3Lmhhc19mdXNlcyA9IHRydWUsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lID0gIkFVWCBB
IiwKKwkJLmRvbWFpbnMgPSBDTkxfRElTUExBWV9BVVhfQV9QT1dFUl9ET01BSU5TLAorCQkub3Bz
ID0gJmhzd19wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCQl7CisJ
CQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0gR0xLX1BX
X0NUTF9JRFhfQVVYX0EsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lID0gIkFVWCBCIiwKKwkJLmRv
bWFpbnMgPSBDTkxfRElTUExBWV9BVVhfQl9QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJmhzd19w
b3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCQl7CisJCQkuaHN3LnJl
Z3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0gR0xLX1BXX0NUTF9JRFhf
QVVYX0IsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lID0gIkFVWCBDIiwKKwkJLmRvbWFpbnMgPSBD
TkxfRElTUExBWV9BVVhfQ19QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJmhzd19wb3dlcl93ZWxs
X29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaHN3
X3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0gR0xLX1BXX0NUTF9JRFhfQVVYX0MsCisJ
CX0sCisJfSwKKwl7CisJCS5uYW1lID0gIkFVWCBEIiwKKwkJLmRvbWFpbnMgPSBDTkxfRElTUExB
WV9BVVhfRF9QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKKwkJ
LmlkID0gRElTUF9QV19JRF9OT05FLAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dl
bGxfcmVncywKKwkJCS5oc3cuaWR4ID0gQ05MX1BXX0NUTF9JRFhfQVVYX0QsCisJCX0sCisJfSwK
Kwl7CisJCS5uYW1lID0gIkRDIG9mZiIsCisJCS5kb21haW5zID0gQ05MX0RJU1BMQVlfRENfT0ZG
X1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmZ2VuOV9kY19vZmZfcG93ZXJfd2VsbF9vcHMsCisJ
CS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwl9LAorCXsKKwkJLm5hbWUgPSAicG93ZXIgd2VsbCAy
IiwKKwkJLmRvbWFpbnMgPSBDTkxfRElTUExBWV9QT1dFUldFTExfMl9QT1dFUl9ET01BSU5TLAor
CQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gU0tMX0RJU1BfUFdfMiwKKwkJ
eworCQkJLmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3MsCisJCQkuaHN3LmlkeCA9IFNL
TF9QV19DVExfSURYX1BXXzIsCisJCQkuaHN3LmlycV9waXBlX21hc2sgPSBCSVQoUElQRV9CKSB8
IEJJVChQSVBFX0MpLAorCQkJLmhzdy5oYXNfdmdhID0gdHJ1ZSwKKwkJCS5oc3cuaGFzX2Z1c2Vz
ID0gdHJ1ZSwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiRERJIEEgSU8gcG93ZXIgd2VsbCIs
CisJCS5kb21haW5zID0gQ05MX0RJU1BMQVlfRERJX0FfSU9fUE9XRVJfRE9NQUlOUywKKwkJLm9w
cyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwkJewor
CQkJLmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3MsCisJCQkuaHN3LmlkeCA9IEdMS19Q
V19DVExfSURYX0RESV9BLAorCQl9LAorCX0sCisJeworCQkubmFtZSA9ICJEREkgQiBJTyBwb3dl
ciB3ZWxsIiwKKwkJLmRvbWFpbnMgPSBDTkxfRElTUExBWV9ERElfQl9JT19QT1dFUl9ET01BSU5T
LAorCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05F
LAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4
ID0gU0tMX1BXX0NUTF9JRFhfRERJX0IsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lID0gIkRESSBD
IElPIHBvd2VyIHdlbGwiLAorCQkuZG9tYWlucyA9IENOTF9ESVNQTEFZX0RESV9DX0lPX1BPV0VS
X0RPTUFJTlMsCisJCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BX
X0lEX05PTkUsCisJCXsKKwkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAorCQkJ
Lmhzdy5pZHggPSBTS0xfUFdfQ1RMX0lEWF9ERElfQywKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUg
PSAiRERJIEQgSU8gcG93ZXIgd2VsbCIsCisJCS5kb21haW5zID0gQ05MX0RJU1BMQVlfRERJX0Rf
SU9fUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9
IERJU1BfUFdfSURfTk9ORSwKKwkJeworCQkJLmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3Jl
Z3MsCisJCQkuaHN3LmlkeCA9IFNLTF9QV19DVExfSURYX0RESV9ELAorCQl9LAorCX0sCisJewor
CQkubmFtZSA9ICJEREkgRiBJTyBwb3dlciB3ZWxsIiwKKwkJLmRvbWFpbnMgPSBDTkxfRElTUExB
WV9ERElfRl9JT19QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywK
KwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2Vy
X3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0gQ05MX1BXX0NUTF9JRFhfRERJX0YsCisJCX0sCisJ
fSwKKwl7CisJCS5uYW1lID0gIkFVWCBGIiwKKwkJLmRvbWFpbnMgPSBDTkxfRElTUExBWV9BVVhf
Rl9QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKKwkJLmlkID0g
RElTUF9QV19JRF9OT05FLAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVn
cywKKwkJCS5oc3cuaWR4ID0gQ05MX1BXX0NUTF9JRFhfQVVYX0YsCisJCX0sCisJfSwKK307CisK
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX29wcyBpY2xfY29tYm9fcGh5X2F1
eF9wb3dlcl93ZWxsX29wcyA9IHsKKwkuc3luY19odyA9IGhzd19wb3dlcl93ZWxsX3N5bmNfaHcs
CisJLmVuYWJsZSA9IGljbF9jb21ib19waHlfYXV4X3Bvd2VyX3dlbGxfZW5hYmxlLAorCS5kaXNh
YmxlID0gaWNsX2NvbWJvX3BoeV9hdXhfcG93ZXJfd2VsbF9kaXNhYmxlLAorCS5pc19lbmFibGVk
ID0gaHN3X3Bvd2VyX3dlbGxfZW5hYmxlZCwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaTkx
NV9wb3dlcl93ZWxsX29wcyBpY2xfdGNfcGh5X2F1eF9wb3dlcl93ZWxsX29wcyA9IHsKKwkuc3lu
Y19odyA9IGhzd19wb3dlcl93ZWxsX3N5bmNfaHcsCisJLmVuYWJsZSA9IGljbF90Y19waHlfYXV4
X3Bvd2VyX3dlbGxfZW5hYmxlLAorCS5kaXNhYmxlID0gaHN3X3Bvd2VyX3dlbGxfZGlzYWJsZSwK
KwkuaXNfZW5hYmxlZCA9IGhzd19wb3dlcl93ZWxsX2VuYWJsZWQsCit9OworCitzdGF0aWMgY29u
c3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzIGljbF9hdXhfcG93ZXJfd2VsbF9yZWdzID0g
eworCS5iaW9zCT0gSUNMX1BXUl9XRUxMX0NUTF9BVVgxLAorCS5kcml2ZXIJPSBJQ0xfUFdSX1dF
TExfQ1RMX0FVWDIsCisJLmRlYnVnCT0gSUNMX1BXUl9XRUxMX0NUTF9BVVg0LAorfTsKKworc3Rh
dGljIGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyBpY2xfZGRpX3Bvd2VyX3dlbGxf
cmVncyA9IHsKKwkuYmlvcwk9IElDTF9QV1JfV0VMTF9DVExfRERJMSwKKwkuZHJpdmVyCT0gSUNM
X1BXUl9XRUxMX0NUTF9EREkyLAorCS5kZWJ1Zwk9IElDTF9QV1JfV0VMTF9DVExfRERJNCwKK307
CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX2Rlc2MgaWNsX3Bvd2VyX3dl
bGxzW10gPSB7CisJeworCQkubmFtZSA9ICJhbHdheXMtb24iLAorCQkuYWx3YXlzX29uID0gdHJ1
ZSwKKwkJLmRvbWFpbnMgPSBQT1dFUl9ET01BSU5fTUFTSywKKwkJLm9wcyA9ICZpOXh4X2Fsd2F5
c19vbl9wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCX0sCisJewor
CQkubmFtZSA9ICJwb3dlciB3ZWxsIDEiLAorCQkvKiBIYW5kbGVkIGJ5IHRoZSBETUMgZmlybXdh
cmUgKi8KKwkJLmFsd2F5c19vbiA9IHRydWUsCisJCS5kb21haW5zID0gMCwKKwkJLm9wcyA9ICZo
c3dfcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9IFNLTF9ESVNQX1BXXzEsCisJCXsKKwkJCS5oc3cu
cmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAorCQkJLmhzdy5pZHggPSBJQ0xfUFdfQ1RMX0lE
WF9QV18xLAorCQkJLmhzdy5oYXNfZnVzZXMgPSB0cnVlLAorCQl9LAorCX0sCisJeworCQkubmFt
ZSA9ICJEQyBvZmYiLAorCQkuZG9tYWlucyA9IElDTF9ESVNQTEFZX0RDX09GRl9QT1dFUl9ET01B
SU5TLAorCQkub3BzID0gJmdlbjlfZGNfb2ZmX3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQ
X1BXX0lEX05PTkUsCisJfSwKKwl7CisJCS5uYW1lID0gInBvd2VyIHdlbGwgMiIsCisJCS5kb21h
aW5zID0gSUNMX1BXXzJfUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9v
cHMsCisJCS5pZCA9IFNLTF9ESVNQX1BXXzIsCisJCXsKKwkJCS5oc3cucmVncyA9ICZoc3dfcG93
ZXJfd2VsbF9yZWdzLAorCQkJLmhzdy5pZHggPSBJQ0xfUFdfQ1RMX0lEWF9QV18yLAorCQkJLmhz
dy5oYXNfZnVzZXMgPSB0cnVlLAorCQl9LAorCX0sCisJeworCQkubmFtZSA9ICJwb3dlciB3ZWxs
IDMiLAorCQkuZG9tYWlucyA9IElDTF9QV18zX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmaHN3
X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJCXsKKwkJCS5oc3cu
cmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAorCQkJLmhzdy5pZHggPSBJQ0xfUFdfQ1RMX0lE
WF9QV18zLAorCQkJLmhzdy5pcnFfcGlwZV9tYXNrID0gQklUKFBJUEVfQiksCisJCQkuaHN3Lmhh
c192Z2EgPSB0cnVlLAorCQkJLmhzdy5oYXNfZnVzZXMgPSB0cnVlLAorCQl9LAorCX0sCisJewor
CQkubmFtZSA9ICJEREkgQSBJTyIsCisJCS5kb21haW5zID0gSUNMX0RESV9JT19BX1BPV0VSX0RP
TUFJTlMsCisJCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lE
X05PTkUsCisJCXsKKwkJCS5oc3cucmVncyA9ICZpY2xfZGRpX3Bvd2VyX3dlbGxfcmVncywKKwkJ
CS5oc3cuaWR4ID0gSUNMX1BXX0NUTF9JRFhfRERJX0EsCisJCX0sCisJfSwKKwl7CisJCS5uYW1l
ID0gIkRESSBCIElPIiwKKwkJLmRvbWFpbnMgPSBJQ0xfRERJX0lPX0JfUE9XRVJfRE9NQUlOUywK
KwkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdfSURfTk9ORSwK
KwkJeworCQkJLmhzdy5yZWdzID0gJmljbF9kZGlfcG93ZXJfd2VsbF9yZWdzLAorCQkJLmhzdy5p
ZHggPSBJQ0xfUFdfQ1RMX0lEWF9ERElfQiwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiRERJ
IEMgSU8iLAorCQkuZG9tYWlucyA9IElDTF9ERElfSU9fQ19QT1dFUl9ET01BSU5TLAorCQkub3Bz
ID0gJmhzd19wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCQl7CisJ
CQkuaHN3LnJlZ3MgPSAmaWNsX2RkaV9wb3dlcl93ZWxsX3JlZ3MsCisJCQkuaHN3LmlkeCA9IElD
TF9QV19DVExfSURYX0RESV9DLAorCQl9LAorCX0sCisJeworCQkubmFtZSA9ICJEREkgRCBJTyIs
CisJCS5kb21haW5zID0gSUNMX0RESV9JT19EX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmaHN3
X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJCXsKKwkJCS5oc3cu
cmVncyA9ICZpY2xfZGRpX3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0gSUNMX1BXX0NU
TF9JRFhfRERJX0QsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lID0gIkRESSBFIElPIiwKKwkJLmRv
bWFpbnMgPSBJQ0xfRERJX0lPX0VfUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9ICZoc3dfcG93ZXJf
d2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwkJeworCQkJLmhzdy5yZWdzID0g
JmljbF9kZGlfcG93ZXJfd2VsbF9yZWdzLAorCQkJLmhzdy5pZHggPSBJQ0xfUFdfQ1RMX0lEWF9E
RElfRSwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiRERJIEYgSU8iLAorCQkuZG9tYWlucyA9
IElDTF9ERElfSU9fRl9QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29w
cywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaWNsX2Rk
aV9wb3dlcl93ZWxsX3JlZ3MsCisJCQkuaHN3LmlkeCA9IElDTF9QV19DVExfSURYX0RESV9GLAor
CQl9LAorCX0sCisJeworCQkubmFtZSA9ICJBVVggQSIsCisJCS5kb21haW5zID0gSUNMX0FVWF9B
X0lPX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmaWNsX2NvbWJvX3BoeV9hdXhfcG93ZXJfd2Vs
bF9vcHMsCisJCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwkJeworCQkJLmhzdy5yZWdzID0gJmlj
bF9hdXhfcG93ZXJfd2VsbF9yZWdzLAorCQkJLmhzdy5pZHggPSBJQ0xfUFdfQ1RMX0lEWF9BVVhf
QSwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiQVVYIEIiLAorCQkuZG9tYWlucyA9IElDTF9B
VVhfQl9JT19QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJmljbF9jb21ib19waHlfYXV4X3Bvd2Vy
X3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJCXsKKwkJCS5oc3cucmVncyA9
ICZpY2xfYXV4X3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0gSUNMX1BXX0NUTF9JRFhf
QVVYX0IsCisJCX0sCisJfSwKKwl7CisJCS5uYW1lID0gIkFVWCBDIiwKKwkJLmRvbWFpbnMgPSBJ
Q0xfQVVYX0NfSU9fUE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9ICZpY2xfdGNfcGh5X2F1eF9wb3dl
cl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCQl7CisJCQkuaHN3LnJlZ3Mg
PSAmaWNsX2F1eF9wb3dlcl93ZWxsX3JlZ3MsCisJCQkuaHN3LmlkeCA9IElDTF9QV19DVExfSURY
X0FVWF9DLAorCQkJLmhzdy5pc190Y190YnQgPSBmYWxzZSwKKwkJfSwKKwl9LAorCXsKKwkJLm5h
bWUgPSAiQVVYIEQiLAorCQkuZG9tYWlucyA9IElDTF9BVVhfRF9JT19QT1dFUl9ET01BSU5TLAor
CQkub3BzID0gJmljbF90Y19waHlfYXV4X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BX
X0lEX05PTkUsCisJCXsKKwkJCS5oc3cucmVncyA9ICZpY2xfYXV4X3Bvd2VyX3dlbGxfcmVncywK
KwkJCS5oc3cuaWR4ID0gSUNMX1BXX0NUTF9JRFhfQVVYX0QsCisJCQkuaHN3LmlzX3RjX3RidCA9
IGZhbHNlLAorCQl9LAorCX0sCisJeworCQkubmFtZSA9ICJBVVggRSIsCisJCS5kb21haW5zID0g
SUNMX0FVWF9FX0lPX1BPV0VSX0RPTUFJTlMsCisJCS5vcHMgPSAmaWNsX3RjX3BoeV9hdXhfcG93
ZXJfd2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKKwkJeworCQkJLmhzdy5yZWdz
ID0gJmljbF9hdXhfcG93ZXJfd2VsbF9yZWdzLAorCQkJLmhzdy5pZHggPSBJQ0xfUFdfQ1RMX0lE
WF9BVVhfRSwKKwkJCS5oc3cuaXNfdGNfdGJ0ID0gZmFsc2UsCisJCX0sCisJfSwKKwl7CisJCS5u
YW1lID0gIkFVWCBGIiwKKwkJLmRvbWFpbnMgPSBJQ0xfQVVYX0ZfSU9fUE9XRVJfRE9NQUlOUywK
KwkJLm9wcyA9ICZpY2xfdGNfcGh5X2F1eF9wb3dlcl93ZWxsX29wcywKKwkJLmlkID0gRElTUF9Q
V19JRF9OT05FLAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaWNsX2F1eF9wb3dlcl93ZWxsX3JlZ3Ms
CisJCQkuaHN3LmlkeCA9IElDTF9QV19DVExfSURYX0FVWF9GLAorCQkJLmhzdy5pc190Y190YnQg
PSBmYWxzZSwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiQVVYIFRCVDEiLAorCQkuZG9tYWlu
cyA9IElDTF9BVVhfVEJUMV9JT19QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJmljbF90Y19waHlf
YXV4X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJCXsKKwkJCS5o
c3cucmVncyA9ICZpY2xfYXV4X3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0gSUNMX1BX
X0NUTF9JRFhfQVVYX1RCVDEsCisJCQkuaHN3LmlzX3RjX3RidCA9IHRydWUsCisJCX0sCisJfSwK
Kwl7CisJCS5uYW1lID0gIkFVWCBUQlQyIiwKKwkJLmRvbWFpbnMgPSBJQ0xfQVVYX1RCVDJfSU9f
UE9XRVJfRE9NQUlOUywKKwkJLm9wcyA9ICZpY2xfdGNfcGh5X2F1eF9wb3dlcl93ZWxsX29wcywK
KwkJLmlkID0gRElTUF9QV19JRF9OT05FLAorCQl7CisJCQkuaHN3LnJlZ3MgPSAmaWNsX2F1eF9w
b3dlcl93ZWxsX3JlZ3MsCisJCQkuaHN3LmlkeCA9IElDTF9QV19DVExfSURYX0FVWF9UQlQyLAor
CQkJLmhzdy5pc190Y190YnQgPSB0cnVlLAorCQl9LAorCX0sCisJeworCQkubmFtZSA9ICJBVVgg
VEJUMyIsCisJCS5kb21haW5zID0gSUNMX0FVWF9UQlQzX0lPX1BPV0VSX0RPTUFJTlMsCisJCS5v
cHMgPSAmaWNsX3RjX3BoeV9hdXhfcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdfSURf
Tk9ORSwKKwkJeworCQkJLmhzdy5yZWdzID0gJmljbF9hdXhfcG93ZXJfd2VsbF9yZWdzLAorCQkJ
Lmhzdy5pZHggPSBJQ0xfUFdfQ1RMX0lEWF9BVVhfVEJUMywKKwkJCS5oc3cuaXNfdGNfdGJ0ID0g
dHJ1ZSwKKwkJfSwKKwl9LAorCXsKKwkJLm5hbWUgPSAiQVVYIFRCVDQiLAorCQkuZG9tYWlucyA9
IElDTF9BVVhfVEJUNF9JT19QT1dFUl9ET01BSU5TLAorCQkub3BzID0gJmljbF90Y19waHlfYXV4
X3Bvd2VyX3dlbGxfb3BzLAorCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCisJCXsKKwkJCS5oc3cu
cmVncyA9ICZpY2xfYXV4X3Bvd2VyX3dlbGxfcmVncywKKwkJCS5oc3cuaWR4ID0gSUNMX1BXX0NU
TF9JRFhfQVVYX1RCVDQsCisJCQkuaHN3LmlzX3RjX3RidCA9IHRydWUsCisJCX0sCisJfSwKKwl7
CisJCS5uYW1lID0gInBvd2VyIHdlbGwgNCIsCisJCS5kb21haW5zID0gSUNMX1BXXzRfUE9XRVJf
RE9NQUlOUywKKwkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCisJCS5pZCA9IERJU1BfUFdf
SURfTk9ORSwKKwkJeworCQkJLmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3MsCisJCQku
aHN3LmlkeCA9IElDTF9QV19DVExfSURYX1BXXzQsCisJCQkuaHN3Lmhhc19mdXNlcyA9IHRydWUs
CisJCQkuaHN3LmlycV9waXBlX21hc2sgPSBCSVQoUElQRV9DKSwKKwkJfSwKKwl9LAorfTsKKwor
c3RhdGljIGludAorc2FuaXRpemVfZGlzYWJsZV9wb3dlcl93ZWxsX29wdGlvbihjb25zdCBzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJICAgaW50IGRpc2FibGVfcG93ZXJf
d2VsbCkKK3sKKwlpZiAoZGlzYWJsZV9wb3dlcl93ZWxsID49IDApCisJCXJldHVybiAhIWRpc2Fi
bGVfcG93ZXJfd2VsbDsKKworCXJldHVybiAxOworfQorCitzdGF0aWMgdTMyIGdldF9hbGxvd2Vk
X2RjX21hc2soY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJICAg
ICAgIGludCBlbmFibGVfZGMpCit7CisJdTMyIG1hc2s7CisJaW50IHJlcXVlc3RlZF9kYzsKKwlp
bnQgbWF4X2RjOworCisJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpIHsKKwkJbWF4X2Rj
ID0gMjsKKwkJLyoKKwkJICogREM5IGhhcyBhIHNlcGFyYXRlIEhXIGZsb3cgZnJvbSB0aGUgcmVz
dCBvZiB0aGUgREMgc3RhdGVzLAorCQkgKiBub3QgZGVwZW5kaW5nIG9uIHRoZSBETUMgZmlybXdh
cmUuIEl0J3MgbmVlZGVkIGJ5IHN5c3RlbQorCQkgKiBzdXNwZW5kL3Jlc3VtZSwgc28gYWxsb3cg
aXQgdW5jb25kaXRpb25hbGx5LgorCQkgKi8KKwkJbWFzayA9IERDX1NUQVRFX0VOX0RDOTsKKwl9
IGVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMTApIHx8IElTX0dFTjlfQkMoZGV2X3ByaXYpKSB7
CisJCW1heF9kYyA9IDI7CisJCW1hc2sgPSAwOworCX0gZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZf
cHJpdikpIHsKKwkJbWF4X2RjID0gMTsKKwkJbWFzayA9IERDX1NUQVRFX0VOX0RDOTsKKwl9IGVs
c2UgeworCQltYXhfZGMgPSAwOworCQltYXNrID0gMDsKKwl9CisKKwlpZiAoIWk5MTVfbW9kcGFy
YW1zLmRpc2FibGVfcG93ZXJfd2VsbCkKKwkJbWF4X2RjID0gMDsKKworCWlmIChlbmFibGVfZGMg
Pj0gMCAmJiBlbmFibGVfZGMgPD0gbWF4X2RjKSB7CisJCXJlcXVlc3RlZF9kYyA9IGVuYWJsZV9k
YzsKKwl9IGVsc2UgaWYgKGVuYWJsZV9kYyA9PSAtMSkgeworCQlyZXF1ZXN0ZWRfZGMgPSBtYXhf
ZGM7CisJfSBlbHNlIGlmIChlbmFibGVfZGMgPiBtYXhfZGMgJiYgZW5hYmxlX2RjIDw9IDIpIHsK
KwkJRFJNX0RFQlVHX0tNUygiQWRqdXN0aW5nIHJlcXVlc3RlZCBtYXggREMgc3RhdGUgKCVkLT4l
ZClcbiIsCisJCQkgICAgICBlbmFibGVfZGMsIG1heF9kYyk7CisJCXJlcXVlc3RlZF9kYyA9IG1h
eF9kYzsKKwl9IGVsc2UgeworCQlEUk1fRVJST1IoIlVuZXhwZWN0ZWQgdmFsdWUgZm9yIGVuYWJs
ZV9kYyAoJWQpXG4iLCBlbmFibGVfZGMpOworCQlyZXF1ZXN0ZWRfZGMgPSBtYXhfZGM7CisJfQor
CisJaWYgKHJlcXVlc3RlZF9kYyA+IDEpCisJCW1hc2sgfD0gRENfU1RBVEVfRU5fVVBUT19EQzY7
CisJaWYgKHJlcXVlc3RlZF9kYyA+IDApCisJCW1hc2sgfD0gRENfU1RBVEVfRU5fVVBUT19EQzU7
CisKKwlEUk1fREVCVUdfS01TKCJBbGxvd2VkIERDIHN0YXRlIG1hc2sgJTAyeFxuIiwgbWFzayk7
CisKKwlyZXR1cm4gbWFzazsKK30KKworc3RhdGljIGludAorX19zZXRfcG93ZXJfd2VsbHMoc3Ry
dWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucywKKwkJICBjb25zdCBzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsX2Rlc2MgKnBvd2VyX3dlbGxfZGVzY3MsCisJCSAgaW50IHBvd2VyX3dl
bGxfY291bnQpCit7CisJdTY0IHBvd2VyX3dlbGxfaWRzID0gMDsKKwlpbnQgaTsKKworCXBvd2Vy
X2RvbWFpbnMtPnBvd2VyX3dlbGxfY291bnQgPSBwb3dlcl93ZWxsX2NvdW50OworCXBvd2VyX2Rv
bWFpbnMtPnBvd2VyX3dlbGxzID0KKwkJCQlrY2FsbG9jKHBvd2VyX3dlbGxfY291bnQsCisJCQkJ
CXNpemVvZigqcG93ZXJfZG9tYWlucy0+cG93ZXJfd2VsbHMpLAorCQkJCQlHRlBfS0VSTkVMKTsK
KwlpZiAoIXBvd2VyX2RvbWFpbnMtPnBvd2VyX3dlbGxzKQorCQlyZXR1cm4gLUVOT01FTTsKKwor
CWZvciAoaSA9IDA7IGkgPCBwb3dlcl93ZWxsX2NvdW50OyBpKyspIHsKKwkJZW51bSBpOTE1X3Bv
d2VyX3dlbGxfaWQgaWQgPSBwb3dlcl93ZWxsX2Rlc2NzW2ldLmlkOworCisJCXBvd2VyX2RvbWFp
bnMtPnBvd2VyX3dlbGxzW2ldLmRlc2MgPSAmcG93ZXJfd2VsbF9kZXNjc1tpXTsKKworCQlpZiAo
aWQgPT0gRElTUF9QV19JRF9OT05FKQorCQkJY29udGludWU7CisKKwkJV0FSTl9PTihpZCA+PSBz
aXplb2YocG93ZXJfd2VsbF9pZHMpICogOCk7CisJCVdBUk5fT04ocG93ZXJfd2VsbF9pZHMgJiBC
SVRfVUxMKGlkKSk7CisJCXBvd2VyX3dlbGxfaWRzIHw9IEJJVF9VTEwoaWQpOworCX0KKworCXJl
dHVybiAwOworfQorCisjZGVmaW5lIHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBfX3Bv
d2VyX3dlbGxfZGVzY3MpIFwKKwlfX3NldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBfX3Bv
d2VyX3dlbGxfZGVzY3MsIFwKKwkJCSAgQVJSQVlfU0laRShfX3Bvd2VyX3dlbGxfZGVzY3MpKQor
CisvKioKKyAqIGludGVsX3Bvd2VyX2RvbWFpbnNfaW5pdCAtIGluaXRpYWxpemVzIHRoZSBwb3dl
ciBkb21haW4gc3RydWN0dXJlcworICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQor
ICoKKyAqIEluaXRpYWxpemVzIHRoZSBwb3dlciBkb21haW4gc3RydWN0dXJlcyBmb3IgQGRldl9w
cml2IGRlcGVuZGluZyB1cG9uIHRoZQorICogc3VwcG9ydGVkIHBsYXRmb3JtLgorICovCitpbnQg
aW50ZWxfcG93ZXJfZG9tYWluc19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9w
cml2LT5wb3dlcl9kb21haW5zOworCWludCBlcnI7CisKKwlpOTE1X21vZHBhcmFtcy5kaXNhYmxl
X3Bvd2VyX3dlbGwgPQorCQlzYW5pdGl6ZV9kaXNhYmxlX3Bvd2VyX3dlbGxfb3B0aW9uKGRldl9w
cml2LAorCQkJCQkJICAgaTkxNV9tb2RwYXJhbXMuZGlzYWJsZV9wb3dlcl93ZWxsKTsKKwlkZXZf
cHJpdi0+Y3NyLmFsbG93ZWRfZGNfbWFzayA9CisJCWdldF9hbGxvd2VkX2RjX21hc2soZGV2X3By
aXYsIGk5MTVfbW9kcGFyYW1zLmVuYWJsZV9kYyk7CisKKwlCVUlMRF9CVUdfT04oUE9XRVJfRE9N
QUlOX05VTSA+IDY0KTsKKworCW11dGV4X2luaXQoJnBvd2VyX2RvbWFpbnMtPmxvY2spOworCisJ
SU5JVF9ERUxBWUVEX1dPUksoJnBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF93b3JrLAorCQkJICBp
bnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF9hc3luY193b3JrKTsKKworCS8qCisJICogVGhlIGVuYWJs
aW5nIG9yZGVyIHdpbGwgYmUgZnJvbSBsb3dlciB0byBoaWdoZXIgaW5kZXhlZCB3ZWxscywKKwkg
KiB0aGUgZGlzYWJsaW5nIG9yZGVyIGlzIHJldmVyc2VkLgorCSAqLworCWlmIChJU19HRU4oZGV2
X3ByaXYsIDExKSkgeworCQllcnIgPSBzZXRfcG93ZXJfd2VsbHMocG93ZXJfZG9tYWlucywgaWNs
X3Bvd2VyX3dlbGxzKTsKKwl9IGVsc2UgaWYgKElTX0NBTk5PTkxBS0UoZGV2X3ByaXYpKSB7CisJ
CWVyciA9IHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBjbmxfcG93ZXJfd2VsbHMpOwor
CisJCS8qCisJCSAqIERESSBhbmQgQXV4IElPIGFyZSBnZXR0aW5nIGVuYWJsZWQgZm9yIGFsbCBw
b3J0cworCQkgKiByZWdhcmRsZXNzIHRoZSBwcmVzZW5jZSBvciB1c2UuIFNvLCBpbiBvcmRlciB0
byBhdm9pZAorCQkgKiB0aW1lb3V0cywgbGV0cyByZW1vdmUgdGhlbSBmcm9tIHRoZSBsaXN0CisJ
CSAqIGZvciB0aGUgU0tVcyB3aXRob3V0IHBvcnQgRi4KKwkJICovCisJCWlmICghSVNfQ05MX1dJ
VEhfUE9SVF9GKGRldl9wcml2KSkKKwkJCXBvd2VyX2RvbWFpbnMtPnBvd2VyX3dlbGxfY291bnQg
LT0gMjsKKwl9IGVsc2UgaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpKSB7CisJCWVyciA9IHNl
dF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBnbGtfcG93ZXJfd2VsbHMpOworCX0gZWxzZSBp
ZiAoSVNfQlJPWFRPTihkZXZfcHJpdikpIHsKKwkJZXJyID0gc2V0X3Bvd2VyX3dlbGxzKHBvd2Vy
X2RvbWFpbnMsIGJ4dF9wb3dlcl93ZWxscyk7CisJfSBlbHNlIGlmIChJU19HRU45X0JDKGRldl9w
cml2KSkgeworCQllcnIgPSBzZXRfcG93ZXJfd2VsbHMocG93ZXJfZG9tYWlucywgc2tsX3Bvd2Vy
X3dlbGxzKTsKKwl9IGVsc2UgaWYgKElTX0NIRVJSWVZJRVcoZGV2X3ByaXYpKSB7CisJCWVyciA9
IHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBjaHZfcG93ZXJfd2VsbHMpOworCX0gZWxz
ZSBpZiAoSVNfQlJPQURXRUxMKGRldl9wcml2KSkgeworCQllcnIgPSBzZXRfcG93ZXJfd2VsbHMo
cG93ZXJfZG9tYWlucywgYmR3X3Bvd2VyX3dlbGxzKTsKKwl9IGVsc2UgaWYgKElTX0hBU1dFTEwo
ZGV2X3ByaXYpKSB7CisJCWVyciA9IHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBoc3df
cG93ZXJfd2VsbHMpOworCX0gZWxzZSBpZiAoSVNfVkFMTEVZVklFVyhkZXZfcHJpdikpIHsKKwkJ
ZXJyID0gc2V0X3Bvd2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMsIHZsdl9wb3dlcl93ZWxscyk7CisJ
fSBlbHNlIGlmIChJU19JODMwKGRldl9wcml2KSkgeworCQllcnIgPSBzZXRfcG93ZXJfd2VsbHMo
cG93ZXJfZG9tYWlucywgaTgzMF9wb3dlcl93ZWxscyk7CisJfSBlbHNlIHsKKwkJZXJyID0gc2V0
X3Bvd2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMsIGk5eHhfYWx3YXlzX29uX3Bvd2VyX3dlbGwpOwor
CX0KKworCXJldHVybiBlcnI7Cit9CisKKy8qKgorICogaW50ZWxfcG93ZXJfZG9tYWluc19jbGVh
bnVwIC0gY2xlYW4gdXAgcG93ZXIgZG9tYWlucyByZXNvdXJjZXMKKyAqIEBkZXZfcHJpdjogaTkx
NSBkZXZpY2UgaW5zdGFuY2UKKyAqCisgKiBSZWxlYXNlIGFueSByZXNvdXJjZXMgYWNxdWlyZWQg
YnkgaW50ZWxfcG93ZXJfZG9tYWluc19pbml0KCkKKyAqLwordm9pZCBpbnRlbF9wb3dlcl9kb21h
aW5zX2NsZWFudXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQoreworCWtmcmVl
KGRldl9wcml2LT5wb3dlcl9kb21haW5zLnBvd2VyX3dlbGxzKTsKK30KKworc3RhdGljIHZvaWQg
aW50ZWxfcG93ZXJfZG9tYWluc19zeW5jX2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdikKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmRl
dl9wcml2LT5wb3dlcl9kb21haW5zOworCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dl
bGw7CisKKwltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKKwlmb3JfZWFjaF9wb3dl
cl93ZWxsKGRldl9wcml2LCBwb3dlcl93ZWxsKSB7CisJCXBvd2VyX3dlbGwtPmRlc2MtPm9wcy0+
c3luY19odyhkZXZfcHJpdiwgcG93ZXJfd2VsbCk7CisJCXBvd2VyX3dlbGwtPmh3X2VuYWJsZWQg
PQorCQkJcG93ZXJfd2VsbC0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9wcml2LCBwb3dlcl93
ZWxsKTsKKwl9CisJbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKK30KKworc3Rh
dGljIGlubGluZQorYm9vbCBpbnRlbF9kYnVmX3NsaWNlX3NldChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCisJCQkgIGk5MTVfcmVnX3QgcmVnLCBib29sIGVuYWJsZSkKK3sKKwl1
MzIgdmFsLCBzdGF0dXM7CisKKwl2YWwgPSBJOTE1X1JFQUQocmVnKTsKKwl2YWwgPSBlbmFibGUg
PyAodmFsIHwgREJVRl9QT1dFUl9SRVFVRVNUKSA6ICh2YWwgJiB+REJVRl9QT1dFUl9SRVFVRVNU
KTsKKwlJOTE1X1dSSVRFKHJlZywgdmFsKTsKKwlQT1NUSU5HX1JFQUQocmVnKTsKKwl1ZGVsYXko
MTApOworCisJc3RhdHVzID0gSTkxNV9SRUFEKHJlZykgJiBEQlVGX1BPV0VSX1NUQVRFOworCWlm
ICgoZW5hYmxlICYmICFzdGF0dXMpIHx8ICghZW5hYmxlICYmIHN0YXR1cykpIHsKKwkJRFJNX0VS
Uk9SKCJEQnVzIHBvd2VyICVzIHRpbWVvdXQhXG4iLAorCQkJICBlbmFibGUgPyAiZW5hYmxlIiA6
ICJkaXNhYmxlIik7CisJCXJldHVybiBmYWxzZTsKKwl9CisJcmV0dXJuIHRydWU7Cit9CisKK3N0
YXRpYyB2b2lkIGdlbjlfZGJ1Zl9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQoreworCWludGVsX2RidWZfc2xpY2Vfc2V0KGRldl9wcml2LCBEQlVGX0NUTCwgdHJ1ZSk7
Cit9CisKK3N0YXRpYyB2b2lkIGdlbjlfZGJ1Zl9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKK3sKKwlpbnRlbF9kYnVmX3NsaWNlX3NldChkZXZfcHJpdiwgREJVRl9D
VEwsIGZhbHNlKTsKK30KKworc3RhdGljIHU4IGludGVsX2RidWZfbWF4X3NsaWNlcyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCit7CisJaWYgKElOVEVMX0dFTihkZXZfcHJpdikg
PCAxMSkKKwkJcmV0dXJuIDE7CisJcmV0dXJuIDI7Cit9CisKK3ZvaWQgaWNsX2RidWZfc2xpY2Vz
X3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkgICAgdTggcmVx
X3NsaWNlcykKK3sKKwljb25zdCB1OCBod19lbmFibGVkX3NsaWNlcyA9IGRldl9wcml2LT53bS5z
a2xfaHcuZGRiLmVuYWJsZWRfc2xpY2VzOworCWJvb2wgcmV0OworCisJaWYgKHJlcV9zbGljZXMg
PiBpbnRlbF9kYnVmX21heF9zbGljZXMoZGV2X3ByaXYpKSB7CisJCURSTV9FUlJPUigiSW52YWxp
ZCBudW1iZXIgb2YgZGJ1ZiBzbGljZXMgcmVxdWVzdGVkXG4iKTsKKwkJcmV0dXJuOworCX0KKwor
CWlmIChyZXFfc2xpY2VzID09IGh3X2VuYWJsZWRfc2xpY2VzIHx8IHJlcV9zbGljZXMgPT0gMCkK
KwkJcmV0dXJuOworCisJaWYgKHJlcV9zbGljZXMgPiBod19lbmFibGVkX3NsaWNlcykKKwkJcmV0
ID0gaW50ZWxfZGJ1Zl9zbGljZV9zZXQoZGV2X3ByaXYsIERCVUZfQ1RMX1MyLCB0cnVlKTsKKwll
bHNlCisJCXJldCA9IGludGVsX2RidWZfc2xpY2Vfc2V0KGRldl9wcml2LCBEQlVGX0NUTF9TMiwg
ZmFsc2UpOworCisJaWYgKHJldCkKKwkJZGV2X3ByaXYtPndtLnNrbF9ody5kZGIuZW5hYmxlZF9z
bGljZXMgPSByZXFfc2xpY2VzOworfQorCitzdGF0aWMgdm9pZCBpY2xfZGJ1Zl9lbmFibGUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQoreworCUk5MTVfV1JJVEUoREJVRl9DVExf
UzEsIEk5MTVfUkVBRChEQlVGX0NUTF9TMSkgfCBEQlVGX1BPV0VSX1JFUVVFU1QpOworCUk5MTVf
V1JJVEUoREJVRl9DVExfUzIsIEk5MTVfUkVBRChEQlVGX0NUTF9TMikgfCBEQlVGX1BPV0VSX1JF
UVVFU1QpOworCVBPU1RJTkdfUkVBRChEQlVGX0NUTF9TMik7CisKKwl1ZGVsYXkoMTApOworCisJ
aWYgKCEoSTkxNV9SRUFEKERCVUZfQ1RMX1MxKSAmIERCVUZfUE9XRVJfU1RBVEUpIHx8CisJICAg
ICEoSTkxNV9SRUFEKERCVUZfQ1RMX1MyKSAmIERCVUZfUE9XRVJfU1RBVEUpKQorCQlEUk1fRVJS
T1IoIkRCdWYgcG93ZXIgZW5hYmxlIHRpbWVvdXRcbiIpOworCWVsc2UKKwkJLyoKKwkJICogRklY
TUU6IGZvciBub3cgcHJldGVuZCB0aGF0IHdlIG9ubHkgaGF2ZSAxIHNsaWNlLCBzZWUKKwkJICog
aW50ZWxfZW5hYmxlZF9kYnVmX3NsaWNlc19udW0oKS4KKwkJICovCisJCWRldl9wcml2LT53bS5z
a2xfaHcuZGRiLmVuYWJsZWRfc2xpY2VzID0gMTsKK30KKworc3RhdGljIHZvaWQgaWNsX2RidWZf
ZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCit7CisJSTkxNV9XUklU
RShEQlVGX0NUTF9TMSwgSTkxNV9SRUFEKERCVUZfQ1RMX1MxKSAmIH5EQlVGX1BPV0VSX1JFUVVF
U1QpOworCUk5MTVfV1JJVEUoREJVRl9DVExfUzIsIEk5MTVfUkVBRChEQlVGX0NUTF9TMikgJiB+
REJVRl9QT1dFUl9SRVFVRVNUKTsKKwlQT1NUSU5HX1JFQUQoREJVRl9DVExfUzIpOworCisJdWRl
bGF5KDEwKTsKKworCWlmICgoSTkxNV9SRUFEKERCVUZfQ1RMX1MxKSAmIERCVUZfUE9XRVJfU1RB
VEUpIHx8CisJICAgIChJOTE1X1JFQUQoREJVRl9DVExfUzIpICYgREJVRl9QT1dFUl9TVEFURSkp
CisJCURSTV9FUlJPUigiREJ1ZiBwb3dlciBkaXNhYmxlIHRpbWVvdXQhXG4iKTsKKwllbHNlCisJ
CS8qCisJCSAqIEZJWE1FOiBmb3Igbm93IHByZXRlbmQgdGhhdCB0aGUgZmlyc3Qgc2xpY2UgaXMg
YWx3YXlzCisJCSAqIGVuYWJsZWQsIHNlZSBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bSgp
LgorCQkgKi8KKwkJZGV2X3ByaXYtPndtLnNrbF9ody5kZGIuZW5hYmxlZF9zbGljZXMgPSAxOwor
fQorCitzdGF0aWMgdm9pZCBpY2xfbWJ1c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKK3sKKwl1MzIgdmFsOworCisJdmFsID0gTUJVU19BQk9YX0JUX0NSRURJVF9QT09M
MSgxNikgfAorCSAgICAgIE1CVVNfQUJPWF9CVF9DUkVESVRfUE9PTDIoMTYpIHwKKwkgICAgICBN
QlVTX0FCT1hfQl9DUkVESVQoMSkgfAorCSAgICAgIE1CVVNfQUJPWF9CV19DUkVESVQoMSk7CisK
KwlJOTE1X1dSSVRFKE1CVVNfQUJPWF9DVEwsIHZhbCk7Cit9CisKK3N0YXRpYyB2b2lkIGhzd19h
c3NlcnRfY2RjbGsoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQoreworCXUzMiB2
YWwgPSBJOTE1X1JFQUQoTENQTExfQ1RMKTsKKworCS8qCisJICogVGhlIExDUExMIHJlZ2lzdGVy
IHNob3VsZCBiZSB0dXJuZWQgb24gYnkgdGhlIEJJT1MuIEZvciBub3cKKwkgKiBsZXQncyBqdXN0
IGNoZWNrIGl0cyBzdGF0ZSBhbmQgcHJpbnQgZXJyb3JzIGluIGNhc2UKKwkgKiBzb21ldGhpbmcg
aXMgd3JvbmcuICBEb24ndCBldmVuIHRyeSB0byB0dXJuIGl0IG9uLgorCSAqLworCisJaWYgKHZh
bCAmIExDUExMX0NEX1NPVVJDRV9GQ0xLKQorCQlEUk1fRVJST1IoIkNEQ0xLIHNvdXJjZSBpcyBu
b3QgTENQTExcbiIpOworCisJaWYgKHZhbCAmIExDUExMX1BMTF9ESVNBQkxFKQorCQlEUk1fRVJS
T1IoIkxDUExMIGlzIGRpc2FibGVkXG4iKTsKK30KKworc3RhdGljIHZvaWQgYXNzZXJ0X2Nhbl9k
aXNhYmxlX2xjcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKK3sKKwlzdHJ1
Y3QgZHJtX2RldmljZSAqZGV2ID0gJmRldl9wcml2LT5kcm07CisJc3RydWN0IGludGVsX2NydGMg
KmNydGM7CisKKwlmb3JfZWFjaF9pbnRlbF9jcnRjKGRldiwgY3J0YykKKwkJSTkxNV9TVEFURV9X
QVJOKGNydGMtPmFjdGl2ZSwgIkNSVEMgZm9yIHBpcGUgJWMgZW5hYmxlZFxuIiwKKwkJCQlwaXBl
X25hbWUoY3J0Yy0+cGlwZSkpOworCisJSTkxNV9TVEFURV9XQVJOKEk5MTVfUkVBRChIU1dfUFdS
X1dFTExfQ1RMMiksCisJCQkiRGlzcGxheSBwb3dlciB3ZWxsIG9uXG4iKTsKKwlJOTE1X1NUQVRF
X1dBUk4oSTkxNV9SRUFEKFNQTExfQ1RMKSAmIFNQTExfUExMX0VOQUJMRSwKKwkJCSJTUExMIGVu
YWJsZWRcbiIpOworCUk5MTVfU1RBVEVfV0FSTihJOTE1X1JFQUQoV1JQTExfQ1RMKDApKSAmIFdS
UExMX1BMTF9FTkFCTEUsCisJCQkiV1JQTEwxIGVuYWJsZWRcbiIpOworCUk5MTVfU1RBVEVfV0FS
TihJOTE1X1JFQUQoV1JQTExfQ1RMKDEpKSAmIFdSUExMX1BMTF9FTkFCTEUsCisJCQkiV1JQTEwy
IGVuYWJsZWRcbiIpOworCUk5MTVfU1RBVEVfV0FSTihJOTE1X1JFQUQoUFBfU1RBVFVTKDApKSAm
IFBQX09OLAorCQkJIlBhbmVsIHBvd2VyIG9uXG4iKTsKKwlJOTE1X1NUQVRFX1dBUk4oSTkxNV9S
RUFEKEJMQ19QV01fQ1BVX0NUTDIpICYgQkxNX1BXTV9FTkFCTEUsCisJCQkiQ1BVIFBXTTEgZW5h
YmxlZFxuIik7CisJaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKQorCQlJOTE1X1NUQVRFX1dBUk4o
STkxNV9SRUFEKEhTV19CTENfUFdNMl9DVEwpICYgQkxNX1BXTV9FTkFCTEUsCisJCQkJIkNQVSBQ
V00yIGVuYWJsZWRcbiIpOworCUk5MTVfU1RBVEVfV0FSTihJOTE1X1JFQUQoQkxDX1BXTV9QQ0hf
Q1RMMSkgJiBCTE1fUENIX1BXTV9FTkFCTEUsCisJCQkiUENIIFBXTTEgZW5hYmxlZFxuIik7CisJ
STkxNV9TVEFURV9XQVJOKEk5MTVfUkVBRChVVElMX1BJTl9DVEwpICYgVVRJTF9QSU5fRU5BQkxF
LAorCQkJIlV0aWxpdHkgcGluIGVuYWJsZWRcbiIpOworCUk5MTVfU1RBVEVfV0FSTihJOTE1X1JF
QUQoUENIX0dUQ19DVEwpICYgUENIX0dUQ19FTkFCTEUsCisJCQkiUENIIEdUQyBlbmFibGVkXG4i
KTsKKworCS8qCisJICogSW4gdGhlb3J5IHdlIGNhbiBzdGlsbCBsZWF2ZSBJUlFzIGVuYWJsZWQs
IGFzIGxvbmcgYXMgb25seSB0aGUgSFBECisJICogaW50ZXJydXB0cyByZW1haW4gZW5hYmxlZC4g
V2UgdXNlZCB0byBjaGVjayBmb3IgdGhhdCwgYnV0IHNpbmNlIGl0J3MKKwkgKiBnZW4tc3BlY2lm
aWMgYW5kIHNpbmNlIHdlIG9ubHkgZGlzYWJsZSBMQ1BMTCBhZnRlciB3ZSBmdWxseSBkaXNhYmxl
CisJICogdGhlIGludGVycnVwdHMsIHRoZSBjaGVjayBiZWxvdyBzaG91bGQgYmUgZW5vdWdoLgor
CSAqLworCUk5MTVfU1RBVEVfV0FSTihpbnRlbF9pcnFzX2VuYWJsZWQoZGV2X3ByaXYpLCAiSVJR
cyBlbmFibGVkXG4iKTsKK30KKworc3RhdGljIHUzMiBoc3dfcmVhZF9kY29tcChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCit7CisJaWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKQor
CQlyZXR1cm4gSTkxNV9SRUFEKERfQ09NUF9IU1cpOworCWVsc2UKKwkJcmV0dXJuIEk5MTVfUkVB
RChEX0NPTVBfQkRXKTsKK30KKworc3RhdGljIHZvaWQgaHN3X3dyaXRlX2Rjb21wKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdTMyIHZhbCkKK3sKKwlpZiAoSVNfSEFTV0VMTChk
ZXZfcHJpdikpIHsKKwkJaWYgKHNhbmR5YnJpZGdlX3Bjb2RlX3dyaXRlKGRldl9wcml2LAorCQkJ
CQkgICAgR0VONl9QQ09ERV9XUklURV9EX0NPTVAsIHZhbCkpCisJCQlEUk1fREVCVUdfS01TKCJG
YWlsZWQgdG8gd3JpdGUgdG8gRF9DT01QXG4iKTsKKwl9IGVsc2UgeworCQlJOTE1X1dSSVRFKERf
Q09NUF9CRFcsIHZhbCk7CisJCVBPU1RJTkdfUkVBRChEX0NPTVBfQkRXKTsKKwl9Cit9CisKKy8q
CisgKiBUaGlzIGZ1bmN0aW9uIGltcGxlbWVudHMgcGllY2VzIG9mIHR3byBzZXF1ZW5jZXMgZnJv
bSBCU3BlYzoKKyAqIC0gU2VxdWVuY2UgZm9yIGRpc3BsYXkgc29mdHdhcmUgdG8gZGlzYWJsZSBM
Q1BMTAorICogLSBTZXF1ZW5jZSBmb3IgZGlzcGxheSBzb2Z0d2FyZSB0byBhbGxvdyBwYWNrYWdl
IEM4KworICogVGhlIHN0ZXBzIGltcGxlbWVudGVkIGhlcmUgYXJlIGp1c3QgdGhlIHN0ZXBzIHRo
YXQgYWN0dWFsbHkgdG91Y2ggdGhlIExDUExMCisgKiByZWdpc3Rlci4gQ2FsbGVycyBzaG91bGQg
dGFrZSBjYXJlIG9mIGRpc2FibGluZyBhbGwgdGhlIGRpc3BsYXkgZW5naW5lCisgKiBmdW5jdGlv
bnMsIGRvaW5nIHRoZSBtb2RlIHVuc2V0LCBmaXhpbmcgaW50ZXJydXB0cywgZXRjLgorICovCitz
dGF0aWMgdm9pZCBoc3dfZGlzYWJsZV9sY3BsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCisJCQkgICAgICBib29sIHN3aXRjaF90b19mY2xrLCBib29sIGFsbG93X3Bvd2VyX2Rv
d24pCit7CisJdTMyIHZhbDsKKworCWFzc2VydF9jYW5fZGlzYWJsZV9sY3BsbChkZXZfcHJpdik7
CisKKwl2YWwgPSBJOTE1X1JFQUQoTENQTExfQ1RMKTsKKworCWlmIChzd2l0Y2hfdG9fZmNsaykg
eworCQl2YWwgfD0gTENQTExfQ0RfU09VUkNFX0ZDTEs7CisJCUk5MTVfV1JJVEUoTENQTExfQ1RM
LCB2YWwpOworCisJCWlmICh3YWl0X2Zvcl91cyhJOTE1X1JFQUQoTENQTExfQ1RMKSAmCisJCQkJ
TENQTExfQ0RfU09VUkNFX0ZDTEtfRE9ORSwgMSkpCisJCQlEUk1fRVJST1IoIlN3aXRjaGluZyB0
byBGQ0xLIGZhaWxlZFxuIik7CisKKwkJdmFsID0gSTkxNV9SRUFEKExDUExMX0NUTCk7CisJfQor
CisJdmFsIHw9IExDUExMX1BMTF9ESVNBQkxFOworCUk5MTVfV1JJVEUoTENQTExfQ1RMLCB2YWwp
OworCVBPU1RJTkdfUkVBRChMQ1BMTF9DVEwpOworCisJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lz
dGVyKCZkZXZfcHJpdi0+dW5jb3JlLCBMQ1BMTF9DVEwsCisJCQkJICAgIExDUExMX1BMTF9MT0NL
LCAwLCAxKSkKKwkJRFJNX0VSUk9SKCJMQ1BMTCBzdGlsbCBsb2NrZWRcbiIpOworCisJdmFsID0g
aHN3X3JlYWRfZGNvbXAoZGV2X3ByaXYpOworCXZhbCB8PSBEX0NPTVBfQ09NUF9ESVNBQkxFOwor
CWhzd193cml0ZV9kY29tcChkZXZfcHJpdiwgdmFsKTsKKwluZGVsYXkoMTAwKTsKKworCWlmICh3
YWl0X2ZvcigoaHN3X3JlYWRfZGNvbXAoZGV2X3ByaXYpICYKKwkJICAgICAgRF9DT01QX1JDT01Q
X0lOX1BST0dSRVNTKSA9PSAwLCAxKSkKKwkJRFJNX0VSUk9SKCJEX0NPTVAgUkNPTVAgc3RpbGwg
aW4gcHJvZ3Jlc3NcbiIpOworCisJaWYgKGFsbG93X3Bvd2VyX2Rvd24pIHsKKwkJdmFsID0gSTkx
NV9SRUFEKExDUExMX0NUTCk7CisJCXZhbCB8PSBMQ1BMTF9QT1dFUl9ET1dOX0FMTE9XOworCQlJ
OTE1X1dSSVRFKExDUExMX0NUTCwgdmFsKTsKKwkJUE9TVElOR19SRUFEKExDUExMX0NUTCk7CisJ
fQorfQorCisvKgorICogRnVsbHkgcmVzdG9yZXMgTENQTEwsIGRpc2FsbG93aW5nIHBvd2VyIGRv
d24gYW5kIHN3aXRjaGluZyBiYWNrIHRvIExDUExMCisgKiBzb3VyY2UuCisgKi8KK3N0YXRpYyB2
b2lkIGhzd19yZXN0b3JlX2xjcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikK
K3sKKwl1MzIgdmFsOworCisJdmFsID0gSTkxNV9SRUFEKExDUExMX0NUTCk7CisKKwlpZiAoKHZh
bCAmIChMQ1BMTF9QTExfTE9DSyB8IExDUExMX1BMTF9ESVNBQkxFIHwgTENQTExfQ0RfU09VUkNF
X0ZDTEsgfAorCQkgICAgTENQTExfUE9XRVJfRE9XTl9BTExPVykpID09IExDUExMX1BMTF9MT0NL
KQorCQlyZXR1cm47CisKKwkvKgorCSAqIE1ha2Ugc3VyZSB3ZSdyZSBub3Qgb24gUEM4IHN0YXRl
IGJlZm9yZSBkaXNhYmxpbmcgUEM4LCBvdGhlcndpc2UKKwkgKiB3ZSdsbCBoYW5nIHRoZSBtYWNo
aW5lLiBUbyBwcmV2ZW50IFBDOCBzdGF0ZSwganVzdCBlbmFibGUgZm9yY2Vfd2FrZS4KKwkgKi8K
KwlpbnRlbF91bmNvcmVfZm9yY2V3YWtlX2dldCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtF
X0FMTCk7CisKKwlpZiAodmFsICYgTENQTExfUE9XRVJfRE9XTl9BTExPVykgeworCQl2YWwgJj0g
fkxDUExMX1BPV0VSX0RPV05fQUxMT1c7CisJCUk5MTVfV1JJVEUoTENQTExfQ1RMLCB2YWwpOwor
CQlQT1NUSU5HX1JFQUQoTENQTExfQ1RMKTsKKwl9CisKKwl2YWwgPSBoc3dfcmVhZF9kY29tcChk
ZXZfcHJpdik7CisJdmFsIHw9IERfQ09NUF9DT01QX0ZPUkNFOworCXZhbCAmPSB+RF9DT01QX0NP
TVBfRElTQUJMRTsKKwloc3dfd3JpdGVfZGNvbXAoZGV2X3ByaXYsIHZhbCk7CisKKwl2YWwgPSBJ
OTE1X1JFQUQoTENQTExfQ1RMKTsKKwl2YWwgJj0gfkxDUExMX1BMTF9ESVNBQkxFOworCUk5MTVf
V1JJVEUoTENQTExfQ1RMLCB2YWwpOworCisJaWYgKGludGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZk
ZXZfcHJpdi0+dW5jb3JlLCBMQ1BMTF9DVEwsCisJCQkJICAgIExDUExMX1BMTF9MT0NLLCBMQ1BM
TF9QTExfTE9DSywgNSkpCisJCURSTV9FUlJPUigiTENQTEwgbm90IGxvY2tlZCB5ZXRcbiIpOwor
CisJaWYgKHZhbCAmIExDUExMX0NEX1NPVVJDRV9GQ0xLKSB7CisJCXZhbCA9IEk5MTVfUkVBRChM
Q1BMTF9DVEwpOworCQl2YWwgJj0gfkxDUExMX0NEX1NPVVJDRV9GQ0xLOworCQlJOTE1X1dSSVRF
KExDUExMX0NUTCwgdmFsKTsKKworCQlpZiAod2FpdF9mb3JfdXMoKEk5MTVfUkVBRChMQ1BMTF9D
VEwpICYKKwkJCQkgTENQTExfQ0RfU09VUkNFX0ZDTEtfRE9ORSkgPT0gMCwgMSkpCisJCQlEUk1f
RVJST1IoIlN3aXRjaGluZyBiYWNrIHRvIExDUExMIGZhaWxlZFxuIik7CisJfQorCisJaW50ZWxf
dW5jb3JlX2ZvcmNld2FrZV9wdXQoJmRldl9wcml2LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwor
CisJaW50ZWxfdXBkYXRlX2NkY2xrKGRldl9wcml2KTsKKwlpbnRlbF9kdW1wX2NkY2xrX3N0YXRl
KCZkZXZfcHJpdi0+Y2RjbGsuaHcsICJDdXJyZW50IENEQ0xLIik7Cit9CisKKy8qCisgKiBQYWNr
YWdlIHN0YXRlcyBDOCBhbmQgZGVlcGVyIGFyZSByZWFsbHkgZGVlcCBQQyBzdGF0ZXMgdGhhdCBj
YW4gb25seSBiZQorICogcmVhY2hlZCB3aGVuIGFsbCB0aGUgZGV2aWNlcyBvbiB0aGUgc3lzdGVt
IGFsbG93IGl0LCBzbyBldmVuIGlmIHRoZSBncmFwaGljcworICogZGV2aWNlIGFsbG93cyBQQzgr
LCBpdCBkb2Vzbid0IG1lYW4gdGhlIHN5c3RlbSB3aWxsIGFjdHVhbGx5IGdldCB0byB0aGVzZQor
ICogc3RhdGVzLiBPdXIgZHJpdmVyIG9ubHkgYWxsb3dzIFBDOCsgd2hlbiBnb2luZyBpbnRvIHJ1
bnRpbWUgUE0uCisgKgorICogVGhlIHJlcXVpcmVtZW50cyBmb3IgUEM4KyBhcmUgdGhhdCBhbGwg
dGhlIG91dHB1dHMgYXJlIGRpc2FibGVkLCB0aGUgcG93ZXIKKyAqIHdlbGwgaXMgZGlzYWJsZWQg
YW5kIG1vc3QgaW50ZXJydXB0cyBhcmUgZGlzYWJsZWQsIGFuZCB0aGVzZSBhcmUgYWxzbworICog
cmVxdWlyZW1lbnRzIGZvciBydW50aW1lIFBNLiBXaGVuIHRoZXNlIGNvbmRpdGlvbnMgYXJlIG1l
dCwgd2UgbWFudWFsbHkgZG8KKyAqIHRoZSBvdGhlciBjb25kaXRpb25zOiBkaXNhYmxlIHRoZSBp
bnRlcnJ1cHRzLCBjbG9ja3MgYW5kIHN3aXRjaCBMQ1BMTCByZWZjbGsKKyAqIHRvIEZjbGsuIElm
IHdlJ3JlIGluIFBDOCsgYW5kIHdlIGdldCBhbiBub24taG90cGx1ZyBpbnRlcnJ1cHQsIHdlIGNh
biBoYXJkCisgKiBoYW5nIHRoZSBtYWNoaW5lLgorICoKKyAqIFdoZW4gd2UgcmVhbGx5IHJlYWNo
IFBDOCBvciBkZWVwZXIgc3RhdGVzIChub3QganVzdCB3aGVuIHdlIGFsbG93IGl0KSB3ZSBsb3Nl
CisgKiB0aGUgc3RhdGUgb2Ygc29tZSByZWdpc3RlcnMsIHNvIHdoZW4gd2UgY29tZSBiYWNrIGZy
b20gUEM4KyB3ZSBuZWVkIHRvCisgKiByZXN0b3JlIHRoaXMgc3RhdGUuIFdlIGRvbid0IGdldCBp
bnRvIFBDOCsgaWYgd2UncmUgbm90IGluIFJDNiwgc28gd2UgZG9uJ3QKKyAqIG5lZWQgdG8gdGFr
ZSBjYXJlIG9mIHRoZSByZWdpc3RlcnMga2VwdCBieSBSQzYuIE5vdGljZSB0aGF0IHRoaXMgaGFw
cGVucyBldmVuCisgKiBpZiB3ZSBkb24ndCBwdXQgdGhlIGRldmljZSBpbiBQQ0kgRDMgc3RhdGUg
KHdoaWNoIGlzIHdoYXQgY3VycmVudGx5IGhhcHBlbnMKKyAqIGJlY2F1c2Ugb2YgdGhlIHJ1bnRp
bWUgUE0gc3VwcG9ydCkuCisgKgorICogRm9yIG1vcmUsIHJlYWQgIkRpc3BsYXkgU2VxdWVuY2Vz
IGZvciBQYWNrYWdlIEM4IiBvbiB0aGUgaGFyZHdhcmUKKyAqIGRvY3VtZW50YXRpb24uCisgKi8K
K3ZvaWQgaHN3X2VuYWJsZV9wYzgoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQor
eworCXUzMiB2YWw7CisKKwlEUk1fREVCVUdfS01TKCJFbmFibGluZyBwYWNrYWdlIEM4K1xuIik7
CisKKwlpZiAoSEFTX1BDSF9MUFRfTFAoZGV2X3ByaXYpKSB7CisJCXZhbCA9IEk5MTVfUkVBRChT
T1VUSF9EU1BDTEtfR0FURV9EKTsKKwkJdmFsICY9IH5QQ0hfTFBfUEFSVElUSU9OX0xFVkVMX0RJ
U0FCTEU7CisJCUk5MTVfV1JJVEUoU09VVEhfRFNQQ0xLX0dBVEVfRCwgdmFsKTsKKwl9CisKKwls
cHRfZGlzYWJsZV9jbGtvdXRfZHAoZGV2X3ByaXYpOworCWhzd19kaXNhYmxlX2xjcGxsKGRldl9w
cml2LCB0cnVlLCB0cnVlKTsKK30KKwordm9pZCBoc3dfZGlzYWJsZV9wYzgoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQoreworCXUzMiB2YWw7CisKKwlEUk1fREVCVUdfS01TKCJE
aXNhYmxpbmcgcGFja2FnZSBDOCtcbiIpOworCisJaHN3X3Jlc3RvcmVfbGNwbGwoZGV2X3ByaXYp
OworCWludGVsX2luaXRfcGNoX3JlZmNsayhkZXZfcHJpdik7CisKKwlpZiAoSEFTX1BDSF9MUFRf
TFAoZGV2X3ByaXYpKSB7CisJCXZhbCA9IEk5MTVfUkVBRChTT1VUSF9EU1BDTEtfR0FURV9EKTsK
KwkJdmFsIHw9IFBDSF9MUF9QQVJUSVRJT05fTEVWRUxfRElTQUJMRTsKKwkJSTkxNV9XUklURShT
T1VUSF9EU1BDTEtfR0FURV9ELCB2YWwpOworCX0KK30KKworc3RhdGljIHZvaWQgaW50ZWxfcGNo
X3Jlc2V0X2hhbmRzaGFrZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCQkJ
ICAgICAgYm9vbCBlbmFibGUpCit7CisJaTkxNV9yZWdfdCByZWc7CisJdTMyIHJlc2V0X2JpdHMs
IHZhbDsKKworCWlmIChJU19JVllCUklER0UoZGV2X3ByaXYpKSB7CisJCXJlZyA9IEdFTjdfTVNH
X0NUTDsKKwkJcmVzZXRfYml0cyA9IFdBSVRfRk9SX1BDSF9GTFJfQUNLIHwgV0FJVF9GT1JfUENI
X1JFU0VUX0FDSzsKKwl9IGVsc2UgeworCQlyZWcgPSBIU1dfTkRFX1JTVFdSTl9PUFQ7CisJCXJl
c2V0X2JpdHMgPSBSRVNFVF9QQ0hfSEFORFNIQUtFX0VOQUJMRTsKKwl9CisKKwl2YWwgPSBJOTE1
X1JFQUQocmVnKTsKKworCWlmIChlbmFibGUpCisJCXZhbCB8PSByZXNldF9iaXRzOworCWVsc2UK
KwkJdmFsICY9IH5yZXNldF9iaXRzOworCisJSTkxNV9XUklURShyZWcsIHZhbCk7Cit9CisKK3N0
YXRpYyB2b2lkIHNrbF9kaXNwbGF5X2NvcmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCisJCQkJICAgYm9vbCByZXN1bWUpCit7CisJc3RydWN0IGk5MTVfcG93ZXJfZG9t
YWlucyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKKwlzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsICp3ZWxsOworCisJZ2VuOV9zZXRfZGNfc3RhdGUoZGV2X3ByaXYsIERD
X1NUQVRFX0RJU0FCTEUpOworCisJLyogZW5hYmxlIFBDSCByZXNldCBoYW5kc2hha2UgKi8KKwlp
bnRlbF9wY2hfcmVzZXRfaGFuZHNoYWtlKGRldl9wcml2LCAhSEFTX1BDSF9OT1AoZGV2X3ByaXYp
KTsKKworCS8qIGVuYWJsZSBQRzEgYW5kIE1pc2MgSS9PICovCisJbXV0ZXhfbG9jaygmcG93ZXJf
ZG9tYWlucy0+bG9jayk7CisKKwl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFNL
TF9ESVNQX1BXXzEpOworCWludGVsX3Bvd2VyX3dlbGxfZW5hYmxlKGRldl9wcml2LCB3ZWxsKTsK
KworCXdlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgU0tMX0RJU1BfUFdfTUlTQ19J
Tyk7CisJaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHdlbGwpOworCisJbXV0ZXhf
dW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKKworCWludGVsX2NkY2xrX2luaXQoZGV2X3By
aXYpOworCisJZ2VuOV9kYnVmX2VuYWJsZShkZXZfcHJpdik7CisKKwlpZiAocmVzdW1lICYmIGRl
dl9wcml2LT5jc3IuZG1jX3BheWxvYWQpCisJCWludGVsX2Nzcl9sb2FkX3Byb2dyYW0oZGV2X3By
aXYpOworfQorCitzdGF0aWMgdm9pZCBza2xfZGlzcGxheV9jb3JlX3VuaW5pdChzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCit7CisJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAq
cG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKKwlzdHJ1Y3QgaTkxNV9w
b3dlcl93ZWxsICp3ZWxsOworCisJZ2VuOV9zZXRfZGNfc3RhdGUoZGV2X3ByaXYsIERDX1NUQVRF
X0RJU0FCTEUpOworCisJZ2VuOV9kYnVmX2Rpc2FibGUoZGV2X3ByaXYpOworCisJaW50ZWxfY2Rj
bGtfdW5pbml0KGRldl9wcml2KTsKKworCS8qIFRoZSBzcGVjIGRvZXNuJ3QgY2FsbCBmb3IgcmVt
b3ZpbmcgdGhlIHJlc2V0IGhhbmRzaGFrZSBmbGFnICovCisJLyogZGlzYWJsZSBQRzEgYW5kIE1p
c2MgSS9PICovCisKKwltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKKworCS8qCisJ
ICogQlNwZWMgc2F5cyB0byBrZWVwIHRoZSBNSVNDIElPIHBvd2VyIHdlbGwgZW5hYmxlZCBoZXJl
LCBvbmx5CisJICogcmVtb3ZlIG91ciByZXF1ZXN0IGZvciBwb3dlciB3ZWxsIDEuCisJICogTm90
ZSB0aGF0IGV2ZW4gdGhvdWdoIHRoZSBkcml2ZXIncyByZXF1ZXN0IGlzIHJlbW92ZWQgcG93ZXIg
d2VsbCAxCisJICogbWF5IHN0YXkgZW5hYmxlZCBhZnRlciB0aGlzIGR1ZSB0byBETUMncyBvd24g
cmVxdWVzdCBvbiBpdC4KKwkgKi8KKwl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYs
IFNLTF9ESVNQX1BXXzEpOworCWludGVsX3Bvd2VyX3dlbGxfZGlzYWJsZShkZXZfcHJpdiwgd2Vs
bCk7CisKKwltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOworCisJdXNsZWVwX3Jh
bmdlKDEwLCAzMCk7CQkvKiAxMCB1cyBkZWxheSBwZXIgQnNwZWMgKi8KK30KKwordm9pZCBieHRf
ZGlzcGxheV9jb3JlX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJ
ICAgYm9vbCByZXN1bWUpCit7CisJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9t
YWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKKwlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxs
ICp3ZWxsOworCisJZ2VuOV9zZXRfZGNfc3RhdGUoZGV2X3ByaXYsIERDX1NUQVRFX0RJU0FCTEUp
OworCisJLyoKKwkgKiBOREVfUlNUV1JOX09QVCBSU1QgUENIIEhhbmRzaGFrZSBFbiBtdXN0IGFs
d2F5cyBiZSAwYiBvbiBCWFQKKwkgKiBvciBlbHNlIHRoZSByZXNldCB3aWxsIGhhbmcgYmVjYXVz
ZSB0aGVyZSBpcyBubyBQQ0ggdG8gcmVzcG9uZC4KKwkgKiBNb3ZlIHRoZSBoYW5kc2hha2UgcHJv
Z3JhbW1pbmcgdG8gaW5pdGlhbGl6YXRpb24gc2VxdWVuY2UuCisJICogUHJldmlvdXNseSB3YXMg
bGVmdCB1cCB0byBCSU9TLgorCSAqLworCWludGVsX3BjaF9yZXNldF9oYW5kc2hha2UoZGV2X3By
aXYsIGZhbHNlKTsKKworCS8qIEVuYWJsZSBQRzEgKi8KKwltdXRleF9sb2NrKCZwb3dlcl9kb21h
aW5zLT5sb2NrKTsKKworCXdlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgU0tMX0RJ
U1BfUFdfMSk7CisJaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHdlbGwpOworCisJ
bXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKKworCWludGVsX2NkY2xrX2luaXQo
ZGV2X3ByaXYpOworCisJZ2VuOV9kYnVmX2VuYWJsZShkZXZfcHJpdik7CisKKwlpZiAocmVzdW1l
ICYmIGRldl9wcml2LT5jc3IuZG1jX3BheWxvYWQpCisJCWludGVsX2Nzcl9sb2FkX3Byb2dyYW0o
ZGV2X3ByaXYpOworfQorCit2b2lkIGJ4dF9kaXNwbGF5X2NvcmVfdW5pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpw
b3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOworCXN0cnVjdCBpOTE1X3Bv
d2VyX3dlbGwgKndlbGw7CisKKwlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVf
RElTQUJMRSk7CisKKwlnZW45X2RidWZfZGlzYWJsZShkZXZfcHJpdik7CisKKwlpbnRlbF9jZGNs
a191bmluaXQoZGV2X3ByaXYpOworCisJLyogVGhlIHNwZWMgZG9lc24ndCBjYWxsIGZvciByZW1v
dmluZyB0aGUgcmVzZXQgaGFuZHNoYWtlIGZsYWcgKi8KKworCS8qCisJICogRGlzYWJsZSBQVzEg
KFBHMSkuCisJICogTm90ZSB0aGF0IGV2ZW4gdGhvdWdoIHRoZSBkcml2ZXIncyByZXF1ZXN0IGlz
IHJlbW92ZWQgcG93ZXIgd2VsbCAxCisJICogbWF5IHN0YXkgZW5hYmxlZCBhZnRlciB0aGlzIGR1
ZSB0byBETUMncyBvd24gcmVxdWVzdCBvbiBpdC4KKwkgKi8KKwltdXRleF9sb2NrKCZwb3dlcl9k
b21haW5zLT5sb2NrKTsKKworCXdlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgU0tM
X0RJU1BfUFdfMSk7CisJaW50ZWxfcG93ZXJfd2VsbF9kaXNhYmxlKGRldl9wcml2LCB3ZWxsKTsK
KworCW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7CisKKwl1c2xlZXBfcmFuZ2Uo
MTAsIDMwKTsJCS8qIDEwIHVzIGRlbGF5IHBlciBCc3BlYyAqLworfQorCitzdGF0aWMgdm9pZCBj
bmxfZGlzcGxheV9jb3JlX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBi
b29sIHJlc3VtZSkKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5z
ID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOworCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKndl
bGw7CisKKwlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVfRElTQUJMRSk7CisK
KwkvKiAxLiBFbmFibGUgUENIIFJlc2V0IEhhbmRzaGFrZSAqLworCWludGVsX3BjaF9yZXNldF9o
YW5kc2hha2UoZGV2X3ByaXYsICFIQVNfUENIX05PUChkZXZfcHJpdikpOworCisJLyogMi0zLiAq
LworCWludGVsX2NvbWJvX3BoeV9pbml0KGRldl9wcml2KTsKKworCS8qCisJICogNC4gRW5hYmxl
IFBvd2VyIFdlbGwgMSAoUEcxKS4KKwkgKiAgICBUaGUgQVVYIElPIHBvd2VyIHdlbGxzIHdpbGwg
YmUgZW5hYmxlZCBvbiBkZW1hbmQuCisJICovCisJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+
bG9jayk7CisJd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBTS0xfRElTUF9QV18x
KTsKKwlpbnRlbF9wb3dlcl93ZWxsX2VuYWJsZShkZXZfcHJpdiwgd2VsbCk7CisJbXV0ZXhfdW5s
b2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKKworCS8qIDUuIEVuYWJsZSBDRCBjbG9jayAqLwor
CWludGVsX2NkY2xrX2luaXQoZGV2X3ByaXYpOworCisJLyogNi4gRW5hYmxlIERCVUYgKi8KKwln
ZW45X2RidWZfZW5hYmxlKGRldl9wcml2KTsKKworCWlmIChyZXN1bWUgJiYgZGV2X3ByaXYtPmNz
ci5kbWNfcGF5bG9hZCkKKwkJaW50ZWxfY3NyX2xvYWRfcHJvZ3JhbShkZXZfcHJpdik7Cit9CisK
K3N0YXRpYyB2b2lkIGNubF9kaXNwbGF5X2NvcmVfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdikKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21h
aW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOworCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwg
KndlbGw7CisKKwlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVfRElTQUJMRSk7
CisKKwkvKiAxLiBEaXNhYmxlIGFsbCBkaXNwbGF5IGVuZ2luZSBmdW5jdGlvbnMgLT4gYXJlYWR5
IGRvbmUgKi8KKworCS8qIDIuIERpc2FibGUgREJVRiAqLworCWdlbjlfZGJ1Zl9kaXNhYmxlKGRl
dl9wcml2KTsKKworCS8qIDMuIERpc2FibGUgQ0QgY2xvY2sgKi8KKwlpbnRlbF9jZGNsa191bmlu
aXQoZGV2X3ByaXYpOworCisJLyoKKwkgKiA0LiBEaXNhYmxlIFBvd2VyIFdlbGwgMSAoUEcxKS4K
KwkgKiAgICBUaGUgQVVYIElPIHBvd2VyIHdlbGxzIGFyZSB0b2dnbGVkIG9uIGRlbWFuZCwgc28g
dGhleSBhcmUgYWxyZWFkeQorCSAqICAgIGRpc2FibGVkIGF0IHRoaXMgcG9pbnQuCisJICovCisJ
bXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7CisJd2VsbCA9IGxvb2t1cF9wb3dlcl93
ZWxsKGRldl9wcml2LCBTS0xfRElTUF9QV18xKTsKKwlpbnRlbF9wb3dlcl93ZWxsX2Rpc2FibGUo
ZGV2X3ByaXYsIHdlbGwpOworCW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7CisK
Kwl1c2xlZXBfcmFuZ2UoMTAsIDMwKTsJCS8qIDEwIHVzIGRlbGF5IHBlciBCc3BlYyAqLworCisJ
LyogNS4gKi8KKwlpbnRlbF9jb21ib19waHlfdW5pbml0KGRldl9wcml2KTsKK30KKwordm9pZCBp
Y2xfZGlzcGxheV9jb3JlX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAor
CQkJICAgYm9vbCByZXN1bWUpCit7CisJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJf
ZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKKwlzdHJ1Y3QgaTkxNV9wb3dlcl93
ZWxsICp3ZWxsOworCisJZ2VuOV9zZXRfZGNfc3RhdGUoZGV2X3ByaXYsIERDX1NUQVRFX0RJU0FC
TEUpOworCisJLyogMS4gRW5hYmxlIFBDSCByZXNldCBoYW5kc2hha2UuICovCisJaW50ZWxfcGNo
X3Jlc2V0X2hhbmRzaGFrZShkZXZfcHJpdiwgIUhBU19QQ0hfTk9QKGRldl9wcml2KSk7CisKKwkv
KiAyLiBJbml0aWFsaXplIGFsbCBjb21ibyBwaHlzICovCisJaW50ZWxfY29tYm9fcGh5X2luaXQo
ZGV2X3ByaXYpOworCisJLyoKKwkgKiAzLiBFbmFibGUgUG93ZXIgV2VsbCAxIChQRzEpLgorCSAq
ICAgIFRoZSBBVVggSU8gcG93ZXIgd2VsbHMgd2lsbCBiZSBlbmFibGVkIG9uIGRlbWFuZC4KKwkg
Ki8KKwltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKKwl3ZWxsID0gbG9va3VwX3Bv
d2VyX3dlbGwoZGV2X3ByaXYsIFNLTF9ESVNQX1BXXzEpOworCWludGVsX3Bvd2VyX3dlbGxfZW5h
YmxlKGRldl9wcml2LCB3ZWxsKTsKKwltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2sp
OworCisJLyogNC4gRW5hYmxlIENEQ0xLLiAqLworCWludGVsX2NkY2xrX2luaXQoZGV2X3ByaXYp
OworCisJLyogNS4gRW5hYmxlIERCVUYuICovCisJaWNsX2RidWZfZW5hYmxlKGRldl9wcml2KTsK
KworCS8qIDYuIFNldHVwIE1CVVMuICovCisJaWNsX21idXNfaW5pdChkZXZfcHJpdik7CisKKwlp
ZiAocmVzdW1lICYmIGRldl9wcml2LT5jc3IuZG1jX3BheWxvYWQpCisJCWludGVsX2Nzcl9sb2Fk
X3Byb2dyYW0oZGV2X3ByaXYpOworfQorCit2b2lkIGljbF9kaXNwbGF5X2NvcmVfdW5pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9k
b21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOworCXN0cnVj
dCBpOTE1X3Bvd2VyX3dlbGwgKndlbGw7CisKKwlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwg
RENfU1RBVEVfRElTQUJMRSk7CisKKwkvKiAxLiBEaXNhYmxlIGFsbCBkaXNwbGF5IGVuZ2luZSBm
dW5jdGlvbnMgLT4gYXJlYWR5IGRvbmUgKi8KKworCS8qIDIuIERpc2FibGUgREJVRiAqLworCWlj
bF9kYnVmX2Rpc2FibGUoZGV2X3ByaXYpOworCisJLyogMy4gRGlzYWJsZSBDRCBjbG9jayAqLwor
CWludGVsX2NkY2xrX3VuaW5pdChkZXZfcHJpdik7CisKKwkvKgorCSAqIDQuIERpc2FibGUgUG93
ZXIgV2VsbCAxIChQRzEpLgorCSAqICAgIFRoZSBBVVggSU8gcG93ZXIgd2VsbHMgYXJlIHRvZ2ds
ZWQgb24gZGVtYW5kLCBzbyB0aGV5IGFyZSBhbHJlYWR5CisJICogICAgZGlzYWJsZWQgYXQgdGhp
cyBwb2ludC4KKwkgKi8KKwltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKKwl3ZWxs
ID0gbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFNLTF9ESVNQX1BXXzEpOworCWludGVsX3Bv
d2VyX3dlbGxfZGlzYWJsZShkZXZfcHJpdiwgd2VsbCk7CisJbXV0ZXhfdW5sb2NrKCZwb3dlcl9k
b21haW5zLT5sb2NrKTsKKworCS8qIDUuICovCisJaW50ZWxfY29tYm9fcGh5X3VuaW5pdChkZXZf
cHJpdik7Cit9CisKK3N0YXRpYyB2b2lkIGNodl9waHlfY29udHJvbF9pbml0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpjbW5f
YmMgPQorCQlsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgVkxWX0RJU1BfUFdfRFBJT19DTU5f
QkMpOworCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKmNtbl9kID0KKwkJbG9va3VwX3Bvd2VyX3dl
bGwoZGV2X3ByaXYsIENIVl9ESVNQX1BXX0RQSU9fQ01OX0QpOworCisJLyoKKwkgKiBESVNQTEFZ
X1BIWV9DT05UUk9MIGNhbiBnZXQgY29ycnVwdGVkIGlmIHJlYWQuIEFzIGEKKwkgKiB3b3JrYXJv
dW5kIG5ldmVyIGV2ZXIgcmVhZCBESVNQTEFZX1BIWV9DT05UUk9MLCBhbmQKKwkgKiBpbnN0ZWFk
IG1haW50YWluIGEgc2hhZG93IGNvcHkgb3Vyc2VsdmVzLiBVc2UgdGhlIGFjdHVhbAorCSAqIHBv
d2VyIHdlbGwgc3RhdGUgYW5kIGxhbmUgc3RhdHVzIHRvIHJlY29uc3RydWN0IHRoZQorCSAqIGV4
cGVjdGVkIGluaXRpYWwgdmFsdWUuCisJICovCisJZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCA9
CisJCVBIWV9MRE9fU0VRX0RFTEFZKFBIWV9MRE9fREVMQVlfNjAwTlMsIERQSU9fUEhZMCkgfAor
CQlQSFlfTERPX1NFUV9ERUxBWShQSFlfTERPX0RFTEFZXzYwME5TLCBEUElPX1BIWTEpIHwKKwkJ
UEhZX0NIX1BPV0VSX01PREUoUEhZX0NIX0RFRVBfUFNSLCBEUElPX1BIWTAsIERQSU9fQ0gwKSB8
CisJCVBIWV9DSF9QT1dFUl9NT0RFKFBIWV9DSF9ERUVQX1BTUiwgRFBJT19QSFkwLCBEUElPX0NI
MSkgfAorCQlQSFlfQ0hfUE9XRVJfTU9ERShQSFlfQ0hfREVFUF9QU1IsIERQSU9fUEhZMSwgRFBJ
T19DSDApOworCisJLyoKKwkgKiBJZiBhbGwgbGFuZXMgYXJlIGRpc2FibGVkIHdlIGxlYXZlIHRo
ZSBvdmVycmlkZSBkaXNhYmxlZAorCSAqIHdpdGggYWxsIHBvd2VyIGRvd24gYml0cyBjbGVhcmVk
IHRvIG1hdGNoIHRoZSBzdGF0ZSB3ZQorCSAqIHdvdWxkIHVzZSBhZnRlciBkaXNhYmxpbmcgdGhl
IHBvcnQuIE90aGVyd2lzZSBlbmFibGUgdGhlCisJICogb3ZlcnJpZGUgYW5kIHNldCB0aGUgbGFu
ZSBwb3dlcmRvd24gYml0cyBhY2NkaW5nIHRvIHRoZQorCSAqIGN1cnJlbnQgbGFuZSBzdGF0dXMu
CisJICovCisJaWYgKGNtbl9iYy0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9wcml2LCBjbW5f
YmMpKSB7CisJCXUzMiBzdGF0dXMgPSBJOTE1X1JFQUQoRFBMTChQSVBFX0EpKTsKKwkJdW5zaWdu
ZWQgaW50IG1hc2s7CisKKwkJbWFzayA9IHN0YXR1cyAmIERQTExfUE9SVEJfUkVBRFlfTUFTSzsK
KwkJaWYgKG1hc2sgPT0gMHhmKQorCQkJbWFzayA9IDB4MDsKKwkJZWxzZQorCQkJZGV2X3ByaXYt
PmNodl9waHlfY29udHJvbCB8PQorCQkJCVBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4oRFBJT19Q
SFkwLCBEUElPX0NIMCk7CisKKwkJZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCB8PQorCQkJUEhZ
X0NIX1BPV0VSX0RPV05fT1ZSRChtYXNrLCBEUElPX1BIWTAsIERQSU9fQ0gwKTsKKworCQltYXNr
ID0gKHN0YXR1cyAmIERQTExfUE9SVENfUkVBRFlfTUFTSykgPj4gNDsKKwkJaWYgKG1hc2sgPT0g
MHhmKQorCQkJbWFzayA9IDB4MDsKKwkJZWxzZQorCQkJZGV2X3ByaXYtPmNodl9waHlfY29udHJv
bCB8PQorCQkJCVBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4oRFBJT19QSFkwLCBEUElPX0NIMSk7
CisKKwkJZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCB8PQorCQkJUEhZX0NIX1BPV0VSX0RPV05f
T1ZSRChtYXNrLCBEUElPX1BIWTAsIERQSU9fQ0gxKTsKKworCQlkZXZfcHJpdi0+Y2h2X3BoeV9j
b250cm9sIHw9IFBIWV9DT01fTEFORV9SRVNFVF9ERUFTU0VSVChEUElPX1BIWTApOworCisJCWRl
dl9wcml2LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTBdID0gZmFsc2U7CisJfSBlbHNlIHsKKwkJ
ZGV2X3ByaXYtPmNodl9waHlfYXNzZXJ0W0RQSU9fUEhZMF0gPSB0cnVlOworCX0KKworCWlmIChj
bW5fZC0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9wcml2LCBjbW5fZCkpIHsKKwkJdTMyIHN0
YXR1cyA9IEk5MTVfUkVBRChEUElPX1BIWV9TVEFUVVMpOworCQl1bnNpZ25lZCBpbnQgbWFzazsK
KworCQltYXNrID0gc3RhdHVzICYgRFBMTF9QT1JURF9SRUFEWV9NQVNLOworCisJCWlmIChtYXNr
ID09IDB4ZikKKwkJCW1hc2sgPSAweDA7CisJCWVsc2UKKwkJCWRldl9wcml2LT5jaHZfcGh5X2Nv
bnRyb2wgfD0KKwkJCQlQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEX0VOKERQSU9fUEhZMSwgRFBJT19D
SDApOworCisJCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgfD0KKwkJCVBIWV9DSF9QT1dFUl9E
T1dOX09WUkQobWFzaywgRFBJT19QSFkxLCBEUElPX0NIMCk7CisKKwkJZGV2X3ByaXYtPmNodl9w
aHlfY29udHJvbCB8PSBQSFlfQ09NX0xBTkVfUkVTRVRfREVBU1NFUlQoRFBJT19QSFkxKTsKKwor
CQlkZXZfcHJpdi0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkxXSA9IGZhbHNlOworCX0gZWxzZSB7
CisJCWRldl9wcml2LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTFdID0gdHJ1ZTsKKwl9CisKKwlJ
OTE1X1dSSVRFKERJU1BMQVlfUEhZX0NPTlRST0wsIGRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wp
OworCisJRFJNX0RFQlVHX0tNUygiSW5pdGlhbCBQSFlfQ09OVFJPTD0weCUwOHhcbiIsCisJCSAg
ICAgIGRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wpOworfQorCitzdGF0aWMgdm9pZCB2bHZfY21u
bGFuZV93YShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCit7CisJc3RydWN0IGk5
MTVfcG93ZXJfd2VsbCAqY21uID0KKwkJbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFZMVl9E
SVNQX1BXX0RQSU9fQ01OX0JDKTsKKwlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpkaXNwMmQgPQor
CQlsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgVkxWX0RJU1BfUFdfRElTUDJEKTsKKworCS8q
IElmIHRoZSBkaXNwbGF5IG1pZ2h0IGJlIGFscmVhZHkgYWN0aXZlIHNraXAgdGhpcyAqLworCWlm
IChjbW4tPmRlc2MtPm9wcy0+aXNfZW5hYmxlZChkZXZfcHJpdiwgY21uKSAmJgorCSAgICBkaXNw
MmQtPmRlc2MtPm9wcy0+aXNfZW5hYmxlZChkZXZfcHJpdiwgZGlzcDJkKSAmJgorCSAgICBJOTE1
X1JFQUQoRFBJT19DVEwpICYgRFBJT19DTU5SU1QpCisJCXJldHVybjsKKworCURSTV9ERUJVR19L
TVMoInRvZ2dsaW5nIGRpc3BsYXkgUEhZIHNpZGUgcmVzZXRcbiIpOworCisJLyogY21ubGFuZSBu
ZWVkcyBEUExMIHJlZ2lzdGVycyAqLworCWRpc3AyZC0+ZGVzYy0+b3BzLT5lbmFibGUoZGV2X3By
aXYsIGRpc3AyZCk7CisKKwkvKgorCSAqIEZyb20gVkxWMkEwX0RQX2VEUF9IRE1JX0RQSU9fZHJp
dmVyX3ZiaW9zX25vdGVzXzExLmRvY3g6CisJICogTmVlZCB0byBhc3NlcnQgYW5kIGRlLWFzc2Vy
dCBQSFkgU0IgcmVzZXQgYnkgZ2F0aW5nIHRoZQorCSAqIGNvbW1vbiBsYW5lIHBvd2VyLCB0aGVu
IHVuLWdhdGluZyBpdC4KKwkgKiBTaW1wbHkgdW5nYXRpbmcgaXNuJ3QgZW5vdWdoIHRvIHJlc2V0
IHRoZSBQSFkgZW5vdWdoIHRvIGdldAorCSAqIHBvcnRzIGFuZCBsYW5lcyBydW5uaW5nLgorCSAq
LworCWNtbi0+ZGVzYy0+b3BzLT5kaXNhYmxlKGRldl9wcml2LCBjbW4pOworfQorCitzdGF0aWMg
Ym9vbCB2bHZfcHVuaXRfaXNfcG93ZXJfZ2F0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LCB1MzIgcmVnMCkKK3sKKwlib29sIHJldDsKKworCXZsdl9wdW5pdF9nZXQoZGV2X3By
aXYpOworCXJldCA9ICh2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgcmVnMCkgJiBTU1BNMF9TU0Nf
TUFTSykgPT0gU1NQTTBfU1NDX1BXUl9HQVRFOworCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYpOwor
CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIHZvaWQgYXNzZXJ0X3ZlZF9wb3dlcl9nYXRlZChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCit7CisJV0FSTighdmx2X3B1bml0X2lz
X3Bvd2VyX2dhdGVkKGRldl9wcml2LCBQVU5JVF9SRUdfVkVEU1NQTTApLAorCSAgICAgIlZFRCBu
b3QgcG93ZXIgZ2F0ZWRcbiIpOworfQorCitzdGF0aWMgdm9pZCBhc3NlcnRfaXNwX3Bvd2VyX2dh
dGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKK3sKKwlzdGF0aWMgY29uc3Qg
c3RydWN0IHBjaV9kZXZpY2VfaWQgaXNwX2lkc1tdID0geworCQl7UENJX0RFVklDRShQQ0lfVkVO
RE9SX0lEX0lOVEVMLCAweDBmMzgpfSwKKwkJe1BDSV9ERVZJQ0UoUENJX1ZFTkRPUl9JRF9JTlRF
TCwgMHgyMmI4KX0sCisJCXt9CisJfTsKKworCVdBUk4oIXBjaV9kZXZfcHJlc2VudChpc3BfaWRz
KSAmJgorCSAgICAgIXZsdl9wdW5pdF9pc19wb3dlcl9nYXRlZChkZXZfcHJpdiwgUFVOSVRfUkVH
X0lTUFNTUE0wKSwKKwkgICAgICJJU1Agbm90IHBvd2VyIGdhdGVkXG4iKTsKK30KKworc3RhdGlj
IHZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc192ZXJpZnlfc3RhdGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KTsKKworLyoqCisgKiBpbnRlbF9wb3dlcl9kb21haW5zX2luaXRfaHcg
LSBpbml0aWFsaXplIGhhcmR3YXJlIHBvd2VyIGRvbWFpbiBzdGF0ZQorICogQGk5MTU6IGk5MTUg
ZGV2aWNlIGluc3RhbmNlCisgKiBAcmVzdW1lOiBDYWxsZWQgZnJvbSByZXN1bWUgY29kZSBwYXRo
cyBvciBub3QKKyAqCisgKiBUaGlzIGZ1bmN0aW9uIGluaXRpYWxpemVzIHRoZSBoYXJkd2FyZSBw
b3dlciBkb21haW4gc3RhdGUgYW5kIGVuYWJsZXMgYWxsCisgKiBwb3dlciB3ZWxscyBiZWxvbmdp
bmcgdG8gdGhlIElOSVQgcG93ZXIgZG9tYWluLiBQb3dlciB3ZWxscyBpbiBvdGhlcgorICogZG9t
YWlucyAoYW5kIG5vdCBpbiB0aGUgSU5JVCBkb21haW4pIGFyZSByZWZlcmVuY2VkIG9yIGRpc2Fi
bGVkIGJ5CisgKiBpbnRlbF9tb2Rlc2V0X3JlYWRvdXRfaHdfc3RhdGUoKS4gQWZ0ZXIgdGhhdCB0
aGUgcmVmZXJlbmNlIGNvdW50IG9mIGVhY2gKKyAqIHBvd2VyIHdlbGwgbXVzdCBtYXRjaCBpdHMg
SFcgZW5hYmxlZCBzdGF0ZSwgc2VlCisgKiBpbnRlbF9wb3dlcl9kb21haW5zX3ZlcmlmeV9zdGF0
ZSgpLgorICoKKyAqIEl0IHdpbGwgcmV0dXJuIHdpdGggcG93ZXIgZG9tYWlucyBkaXNhYmxlZCAo
dG8gYmUgZW5hYmxlZCBsYXRlciBieQorICogaW50ZWxfcG93ZXJfZG9tYWluc19lbmFibGUoKSkg
YW5kIG11c3QgYmUgcGFpcmVkIHdpdGgKKyAqIGludGVsX3Bvd2VyX2RvbWFpbnNfZmluaV9odygp
LgorICovCit2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfaW5pdF9odyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgYm9vbCByZXN1bWUpCit7CisJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlu
cyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOworCisJcG93ZXJfZG9tYWlu
cy0+aW5pdGlhbGl6aW5nID0gdHJ1ZTsKKworCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpIHsK
KwkJaWNsX2Rpc3BsYXlfY29yZV9pbml0KGk5MTUsIHJlc3VtZSk7CisJfSBlbHNlIGlmIChJU19D
QU5OT05MQUtFKGk5MTUpKSB7CisJCWNubF9kaXNwbGF5X2NvcmVfaW5pdChpOTE1LCByZXN1bWUp
OworCX0gZWxzZSBpZiAoSVNfR0VOOV9CQyhpOTE1KSkgeworCQlza2xfZGlzcGxheV9jb3JlX2lu
aXQoaTkxNSwgcmVzdW1lKTsKKwl9IGVsc2UgaWYgKElTX0dFTjlfTFAoaTkxNSkpIHsKKwkJYnh0
X2Rpc3BsYXlfY29yZV9pbml0KGk5MTUsIHJlc3VtZSk7CisJfSBlbHNlIGlmIChJU19DSEVSUllW
SUVXKGk5MTUpKSB7CisJCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOworCQljaHZf
cGh5X2NvbnRyb2xfaW5pdChpOTE1KTsKKwkJbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5s
b2NrKTsKKwkJYXNzZXJ0X2lzcF9wb3dlcl9nYXRlZChpOTE1KTsKKwl9IGVsc2UgaWYgKElTX1ZB
TExFWVZJRVcoaTkxNSkpIHsKKwkJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7CisJ
CXZsdl9jbW5sYW5lX3dhKGk5MTUpOworCQltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxv
Y2spOworCQlhc3NlcnRfdmVkX3Bvd2VyX2dhdGVkKGk5MTUpOworCQlhc3NlcnRfaXNwX3Bvd2Vy
X2dhdGVkKGk5MTUpOworCX0gZWxzZSBpZiAoSVNfQlJPQURXRUxMKGk5MTUpIHx8IElTX0hBU1dF
TEwoaTkxNSkpIHsKKwkJaHN3X2Fzc2VydF9jZGNsayhpOTE1KTsKKwkJaW50ZWxfcGNoX3Jlc2V0
X2hhbmRzaGFrZShpOTE1LCAhSEFTX1BDSF9OT1AoaTkxNSkpOworCX0gZWxzZSBpZiAoSVNfSVZZ
QlJJREdFKGk5MTUpKSB7CisJCWludGVsX3BjaF9yZXNldF9oYW5kc2hha2UoaTkxNSwgIUhBU19Q
Q0hfTk9QKGk5MTUpKTsKKwl9CisKKwkvKgorCSAqIEtlZXAgYWxsIHBvd2VyIHdlbGxzIGVuYWJs
ZWQgZm9yIGFueSBkZXBlbmRlbnQgSFcgYWNjZXNzIGR1cmluZworCSAqIGluaXRpYWxpemF0aW9u
IGFuZCB0byBtYWtlIHN1cmUgd2Uga2VlcCBCSU9TIGVuYWJsZWQgZGlzcGxheSBIVworCSAqIHJl
c291cmNlcyBwb3dlcmVkIHVudGlsIGRpc3BsYXkgSFcgcmVhZG91dCBpcyBjb21wbGV0ZS4gV2Ug
ZHJvcAorCSAqIHRoaXMgcmVmZXJlbmNlIGluIGludGVsX3Bvd2VyX2RvbWFpbnNfZW5hYmxlKCku
CisJICovCisJcG93ZXJfZG9tYWlucy0+d2FrZXJlZiA9CisJCWludGVsX2Rpc3BsYXlfcG93ZXJf
Z2V0KGk5MTUsIFBPV0VSX0RPTUFJTl9JTklUKTsKKworCS8qIERpc2FibGUgcG93ZXIgc3VwcG9y
dCBpZiB0aGUgdXNlciBhc2tlZCBzby4gKi8KKwlpZiAoIWk5MTVfbW9kcGFyYW1zLmRpc2FibGVf
cG93ZXJfd2VsbCkKKwkJaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoaTkxNSwgUE9XRVJfRE9NQUlO
X0lOSVQpOworCWludGVsX3Bvd2VyX2RvbWFpbnNfc3luY19odyhpOTE1KTsKKworCXBvd2VyX2Rv
bWFpbnMtPmluaXRpYWxpemluZyA9IGZhbHNlOworfQorCisvKioKKyAqIGludGVsX3Bvd2VyX2Rv
bWFpbnNfZmluaV9odyAtIGRlaW5pdGlhbGl6ZSBodyBwb3dlciBkb21haW4gc3RhdGUKKyAqIEBp
OTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQorICoKKyAqIERlLWluaXRpYWxpemVzIHRoZSBkaXNw
bGF5IHBvd2VyIGRvbWFpbiBIVyBzdGF0ZS4gSXQgYWxzbyBlbnN1cmVzIHRoYXQgdGhlCisgKiBk
ZXZpY2Ugc3RheXMgcG93ZXJlZCB1cCBzbyB0aGF0IHRoZSBkcml2ZXIgY2FuIGJlIHJlbG9hZGVk
LgorICoKKyAqIEl0IG11c3QgYmUgY2FsbGVkIHdpdGggcG93ZXIgZG9tYWlucyBhbHJlYWR5IGRp
c2FibGVkIChhZnRlciBhIGNhbGwgdG8KKyAqIGludGVsX3Bvd2VyX2RvbWFpbnNfZGlzYWJsZSgp
KSBhbmQgbXVzdCBiZSBwYWlyZWQgd2l0aAorICogaW50ZWxfcG93ZXJfZG9tYWluc19pbml0X2h3
KCkuCisgKi8KK3ZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19maW5pX2h3KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQoreworCWludGVsX3dha2VyZWZfdCB3YWtlcmVmIF9fbWF5YmVfdW51
c2VkID0KKwkJZmV0Y2hfYW5kX3plcm8oJmk5MTUtPnBvd2VyX2RvbWFpbnMud2FrZXJlZik7CisK
KwkvKiBSZW1vdmUgdGhlIHJlZmNvdW50IHdlIHRvb2sgdG8ga2VlcCBwb3dlciB3ZWxsIHN1cHBv
cnQgZGlzYWJsZWQuICovCisJaWYgKCFpOTE1X21vZHBhcmFtcy5kaXNhYmxlX3Bvd2VyX3dlbGwp
CisJCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChpOTE1LCBQT1dFUl9ET01BSU5f
SU5JVCk7CisKKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX2ZsdXNoX3dvcmtfc3luYyhpOTE1KTsKKwor
CWludGVsX3Bvd2VyX2RvbWFpbnNfdmVyaWZ5X3N0YXRlKGk5MTUpOworCisJLyogS2VlcCB0aGUg
cG93ZXIgd2VsbCBlbmFibGVkLCBidXQgY2FuY2VsIGl0cyBycG0gd2FrZXJlZi4gKi8KKwlpbnRl
bF9ydW50aW1lX3BtX3B1dChpOTE1LCB3YWtlcmVmKTsKK30KKworLyoqCisgKiBpbnRlbF9wb3dl
cl9kb21haW5zX2VuYWJsZSAtIGVuYWJsZSB0b2dnbGluZyBvZiBkaXNwbGF5IHBvd2VyIHdlbGxz
CisgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKKyAqCisgKiBFbmFibGUgdGhlIG9uZGVt
YW5kIGVuYWJsaW5nL2Rpc2FibGluZyBvZiB0aGUgZGlzcGxheSBwb3dlciB3ZWxscy4gTm90ZSB0
aGF0CisgKiBwb3dlciB3ZWxscyBub3QgYmVsb25naW5nIHRvIFBPV0VSX0RPTUFJTl9JTklUIGFy
ZSBhbGxvd2VkIHRvIGJlIHRvZ2dsZWQKKyAqIG9ubHkgYXQgc3BlY2lmaWMgcG9pbnRzIG9mIHRo
ZSBkaXNwbGF5IG1vZGVzZXQgc2VxdWVuY2UsIHRodXMgdGhleSBhcmUgbm90CisgKiBhZmZlY3Rl
ZCBieSB0aGUgaW50ZWxfcG93ZXJfZG9tYWluc19lbmFibGUoKS9kaXNhYmxlKCkgY2FsbHMuIFRo
ZSBwdXJwb3NlCisgKiBvZiB0aGVzZSBmdW5jdGlvbiBpcyB0byBrZWVwIHRoZSByZXN0IG9mIHBv
d2VyIHdlbGxzIGVuYWJsZWQgdW50aWwgdGhlIGVuZAorICogb2YgZGlzcGxheSBIVyByZWFkb3V0
ICh3aGljaCB3aWxsIGFjcXVpcmUgdGhlIHBvd2VyIHJlZmVyZW5jZXMgcmVmbGVjdGluZworICog
dGhlIGN1cnJlbnQgSFcgc3RhdGUpLgorICovCit2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfZW5h
YmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQoreworCWludGVsX3dha2VyZWZfdCB3
YWtlcmVmIF9fbWF5YmVfdW51c2VkID0KKwkJZmV0Y2hfYW5kX3plcm8oJmk5MTUtPnBvd2VyX2Rv
bWFpbnMud2FrZXJlZik7CisKKwlpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9E
T01BSU5fSU5JVCwgd2FrZXJlZik7CisJaW50ZWxfcG93ZXJfZG9tYWluc192ZXJpZnlfc3RhdGUo
aTkxNSk7Cit9CisKKy8qKgorICogaW50ZWxfcG93ZXJfZG9tYWluc19kaXNhYmxlIC0gZGlzYWJs
ZSB0b2dnbGluZyBvZiBkaXNwbGF5IHBvd2VyIHdlbGxzCisgKiBAaTkxNTogaTkxNSBkZXZpY2Ug
aW5zdGFuY2UKKyAqCisgKiBEaXNhYmxlIHRoZSBvbmRlbWFuZCBlbmFibGluZy9kaXNhYmxpbmcg
b2YgdGhlIGRpc3BsYXkgcG93ZXIgd2VsbHMuIFNlZQorICogaW50ZWxfcG93ZXJfZG9tYWluc19l
bmFibGUoKSBmb3Igd2hpY2ggcG93ZXIgd2VsbHMgdGhpcyBjYWxsIGNvbnRyb2xzLgorICovCit2
b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5
MTUtPnBvd2VyX2RvbWFpbnM7CisKKwlXQVJOX09OKHBvd2VyX2RvbWFpbnMtPndha2VyZWYpOwor
CXBvd2VyX2RvbWFpbnMtPndha2VyZWYgPQorCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1
LCBQT1dFUl9ET01BSU5fSU5JVCk7CisKKwlpbnRlbF9wb3dlcl9kb21haW5zX3ZlcmlmeV9zdGF0
ZShpOTE1KTsKK30KKworLyoqCisgKiBpbnRlbF9wb3dlcl9kb21haW5zX3N1c3BlbmQgLSBzdXNw
ZW5kIHBvd2VyIGRvbWFpbiBzdGF0ZQorICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCisg
KiBAc3VzcGVuZF9tb2RlOiBzcGVjaWZpZXMgdGhlIHRhcmdldCBzdXNwZW5kIHN0YXRlIChpZGxl
LCBtZW0sIGhpYmVybmF0aW9uKQorICoKKyAqIFRoaXMgZnVuY3Rpb24gcHJlcGFyZXMgdGhlIGhh
cmR3YXJlIHBvd2VyIGRvbWFpbiBzdGF0ZSBiZWZvcmUgZW50ZXJpbmcKKyAqIHN5c3RlbSBzdXNw
ZW5kLgorICoKKyAqIEl0IG11c3QgYmUgY2FsbGVkIHdpdGggcG93ZXIgZG9tYWlucyBhbHJlYWR5
IGRpc2FibGVkIChhZnRlciBhIGNhbGwgdG8KKyAqIGludGVsX3Bvd2VyX2RvbWFpbnNfZGlzYWJs
ZSgpKSBhbmQgcGFpcmVkIHdpdGggaW50ZWxfcG93ZXJfZG9tYWluc19yZXN1bWUoKS4KKyAqLwor
dm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX3N1c3BlbmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUsCisJCQkJIGVudW0gaTkxNV9kcm1fc3VzcGVuZF9tb2RlIHN1c3BlbmRfbW9kZSkKK3sK
KwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUtPnBvd2Vy
X2RvbWFpbnM7CisJaW50ZWxfd2FrZXJlZl90IHdha2VyZWYgX19tYXliZV91bnVzZWQgPQorCQlm
ZXRjaF9hbmRfemVybygmcG93ZXJfZG9tYWlucy0+d2FrZXJlZik7CisKKwlpbnRlbF9kaXNwbGF5
X3Bvd2VyX3B1dChpOTE1LCBQT1dFUl9ET01BSU5fSU5JVCwgd2FrZXJlZik7CisKKwkvKgorCSAq
IEluIGNhc2Ugb2Ygc3VzcGVuZC10by1pZGxlIChha2EgUzBpeCkgb24gYSBETUMgcGxhdGZvcm0g
d2l0aG91dCBEQzkKKwkgKiBzdXBwb3J0IGRvbid0IG1hbnVhbGx5IGRlaW5pdCB0aGUgcG93ZXIg
ZG9tYWlucy4gVGhpcyBhbHNvIG1lYW5zIHRoZQorCSAqIENTUi9ETUMgZmlybXdhcmUgd2lsbCBz
dGF5IGFjdGl2ZSwgaXQgd2lsbCBwb3dlciBkb3duIGFueSBIVworCSAqIHJlc291cmNlcyBhcyBy
ZXF1aXJlZCBhbmQgYWxzbyBlbmFibGUgZGVlcGVyIHN5c3RlbSBwb3dlciBzdGF0ZXMKKwkgKiB0
aGF0IHdvdWxkIGJlIGJsb2NrZWQgaWYgdGhlIGZpcm13YXJlIHdhcyBpbmFjdGl2ZS4KKwkgKi8K
KwlpZiAoIShpOTE1LT5jc3IuYWxsb3dlZF9kY19tYXNrICYgRENfU1RBVEVfRU5fREM5KSAmJgor
CSAgICBzdXNwZW5kX21vZGUgPT0gSTkxNV9EUk1fU1VTUEVORF9JRExFICYmCisJICAgIGk5MTUt
PmNzci5kbWNfcGF5bG9hZCkgeworCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2ZsdXNoX3dvcmsoaTkx
NSk7CisJCWludGVsX3Bvd2VyX2RvbWFpbnNfdmVyaWZ5X3N0YXRlKGk5MTUpOworCQlyZXR1cm47
CisJfQorCisJLyoKKwkgKiBFdmVuIGlmIHBvd2VyIHdlbGwgc3VwcG9ydCB3YXMgZGlzYWJsZWQg
d2Ugc3RpbGwgd2FudCB0byBkaXNhYmxlCisJICogcG93ZXIgd2VsbHMgaWYgcG93ZXIgZG9tYWlu
cyBtdXN0IGJlIGRlaW5pdGlhbGl6ZWQgZm9yIHN1c3BlbmQuCisJICovCisJaWYgKCFpOTE1X21v
ZHBhcmFtcy5kaXNhYmxlX3Bvd2VyX3dlbGwpCisJCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3Vu
Y2hlY2tlZChpOTE1LCBQT1dFUl9ET01BSU5fSU5JVCk7CisKKwlpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2ZsdXNoX3dvcmsoaTkxNSk7CisJaW50ZWxfcG93ZXJfZG9tYWluc192ZXJpZnlfc3RhdGUoaTkx
NSk7CisKKwlpZiAoSU5URUxfR0VOKGk5MTUpID49IDExKQorCQlpY2xfZGlzcGxheV9jb3JlX3Vu
aW5pdChpOTE1KTsKKwllbHNlIGlmIChJU19DQU5OT05MQUtFKGk5MTUpKQorCQljbmxfZGlzcGxh
eV9jb3JlX3VuaW5pdChpOTE1KTsKKwllbHNlIGlmIChJU19HRU45X0JDKGk5MTUpKQorCQlza2xf
ZGlzcGxheV9jb3JlX3VuaW5pdChpOTE1KTsKKwllbHNlIGlmIChJU19HRU45X0xQKGk5MTUpKQor
CQlieHRfZGlzcGxheV9jb3JlX3VuaW5pdChpOTE1KTsKKworCXBvd2VyX2RvbWFpbnMtPmRpc3Bs
YXlfY29yZV9zdXNwZW5kZWQgPSB0cnVlOworfQorCisvKioKKyAqIGludGVsX3Bvd2VyX2RvbWFp
bnNfcmVzdW1lIC0gcmVzdW1lIHBvd2VyIGRvbWFpbiBzdGF0ZQorICogQGk5MTU6IGk5MTUgZGV2
aWNlIGluc3RhbmNlCisgKgorICogVGhpcyBmdW5jdGlvbiByZXN1bWUgdGhlIGhhcmR3YXJlIHBv
d2VyIGRvbWFpbiBzdGF0ZSBkdXJpbmcgc3lzdGVtIHJlc3VtZS4KKyAqCisgKiBJdCB3aWxsIHJl
dHVybiB3aXRoIHBvd2VyIGRvbWFpbiBzdXBwb3J0IGRpc2FibGVkICh0byBiZSBlbmFibGVkIGxh
dGVyIGJ5CisgKiBpbnRlbF9wb3dlcl9kb21haW5zX2VuYWJsZSgpKSBhbmQgbXVzdCBiZSBwYWly
ZWQgd2l0aAorICogaW50ZWxfcG93ZXJfZG9tYWluc19zdXNwZW5kKCkuCisgKi8KK3ZvaWQgaW50
ZWxfcG93ZXJfZG9tYWluc19yZXN1bWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCit7
CisJc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dl
cl9kb21haW5zOworCisJaWYgKHBvd2VyX2RvbWFpbnMtPmRpc3BsYXlfY29yZV9zdXNwZW5kZWQp
IHsKKwkJaW50ZWxfcG93ZXJfZG9tYWluc19pbml0X2h3KGk5MTUsIHRydWUpOworCQlwb3dlcl9k
b21haW5zLT5kaXNwbGF5X2NvcmVfc3VzcGVuZGVkID0gZmFsc2U7CisJfSBlbHNlIHsKKwkJV0FS
Tl9PTihwb3dlcl9kb21haW5zLT53YWtlcmVmKTsKKwkJcG93ZXJfZG9tYWlucy0+d2FrZXJlZiA9
CisJCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBQT1dFUl9ET01BSU5fSU5JVCk7CisJ
fQorCisJaW50ZWxfcG93ZXJfZG9tYWluc192ZXJpZnlfc3RhdGUoaTkxNSk7Cit9CisKKyNpZiBJ
U19FTkFCTEVEKENPTkZJR19EUk1fSTkxNV9ERUJVR19SVU5USU1FX1BNKQorCitzdGF0aWMgdm9p
ZCBpbnRlbF9wb3dlcl9kb21haW5zX2R1bXBfaW5mbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKK3sKKwlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5
MTUtPnBvd2VyX2RvbWFpbnM7CisJc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbDsK
KworCWZvcl9lYWNoX3Bvd2VyX3dlbGwoaTkxNSwgcG93ZXJfd2VsbCkgeworCQllbnVtIGludGVs
X2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbjsKKworCQlEUk1fREVCVUdfRFJJVkVSKCIlLTI1
cyAlZFxuIiwKKwkJCQkgcG93ZXJfd2VsbC0+ZGVzYy0+bmFtZSwgcG93ZXJfd2VsbC0+Y291bnQp
OworCisJCWZvcl9lYWNoX3Bvd2VyX2RvbWFpbihkb21haW4sIHBvd2VyX3dlbGwtPmRlc2MtPmRv
bWFpbnMpCisJCQlEUk1fREVCVUdfRFJJVkVSKCIgICUtMjNzICVkXG4iLAorCQkJCQkgaW50ZWxf
ZGlzcGxheV9wb3dlcl9kb21haW5fc3RyKGRvbWFpbiksCisJCQkJCSBwb3dlcl9kb21haW5zLT5k
b21haW5fdXNlX2NvdW50W2RvbWFpbl0pOworCX0KK30KKworLyoqCisgKiBpbnRlbF9wb3dlcl9k
b21haW5zX3ZlcmlmeV9zdGF0ZSAtIHZlcmlmeSB0aGUgSFcvU1cgc3RhdGUgZm9yIGFsbCBwb3dl
ciB3ZWxscworICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCisgKgorICogVmVyaWZ5IGlm
IHRoZSByZWZlcmVuY2UgY291bnQgb2YgZWFjaCBwb3dlciB3ZWxsIG1hdGNoZXMgaXRzIEhXIGVu
YWJsZWQKKyAqIHN0YXRlIGFuZCB0aGUgdG90YWwgcmVmY291bnQgb2YgdGhlIGRvbWFpbnMgaXQg
YmVsb25ncyB0by4gVGhpcyBtdXN0IGJlCisgKiBjYWxsZWQgYWZ0ZXIgbW9kZXNldCBIVyBzdGF0
ZSBzYW5pdGl6YXRpb24sIHdoaWNoIGlzIHJlc3BvbnNpYmxlIGZvcgorICogYWNxdWlyaW5nIHJl
ZmVyZW5jZSBjb3VudHMgZm9yIGFueSBwb3dlciB3ZWxscyBpbiB1c2UgYW5kIGRpc2FibGluZyB0
aGUKKyAqIG9uZXMgbGVmdCBvbiBieSBCSU9TIGJ1dCBub3QgcmVxdWlyZWQgYnkgYW55IGFjdGl2
ZSBvdXRwdXQuCisgKi8KK3N0YXRpYyB2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfdmVyaWZ5X3N0
YXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQoreworCXN0cnVjdCBpOTE1X3Bvd2Vy
X2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93ZXJfZG9tYWluczsKKwlzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsOworCWJvb2wgZHVtcF9kb21haW5faW5mbzsKKwor
CW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOworCisJdmVyaWZ5X2FzeW5jX3B1dF9k
b21haW5zX3N0YXRlKHBvd2VyX2RvbWFpbnMpOworCisJZHVtcF9kb21haW5faW5mbyA9IGZhbHNl
OworCWZvcl9lYWNoX3Bvd2VyX3dlbGwoaTkxNSwgcG93ZXJfd2VsbCkgeworCQllbnVtIGludGVs
X2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbjsKKwkJaW50IGRvbWFpbnNfY291bnQ7CisJCWJv
b2wgZW5hYmxlZDsKKworCQllbmFibGVkID0gcG93ZXJfd2VsbC0+ZGVzYy0+b3BzLT5pc19lbmFi
bGVkKGk5MTUsIHBvd2VyX3dlbGwpOworCQlpZiAoKHBvd2VyX3dlbGwtPmNvdW50IHx8IHBvd2Vy
X3dlbGwtPmRlc2MtPmFsd2F5c19vbikgIT0KKwkJICAgIGVuYWJsZWQpCisJCQlEUk1fRVJST1Io
InBvd2VyIHdlbGwgJXMgc3RhdGUgbWlzbWF0Y2ggKHJlZmNvdW50ICVkL2VuYWJsZWQgJWQpIiwK
KwkJCQkgIHBvd2VyX3dlbGwtPmRlc2MtPm5hbWUsCisJCQkJICBwb3dlcl93ZWxsLT5jb3VudCwg
ZW5hYmxlZCk7CisKKwkJZG9tYWluc19jb3VudCA9IDA7CisJCWZvcl9lYWNoX3Bvd2VyX2RvbWFp
bihkb21haW4sIHBvd2VyX3dlbGwtPmRlc2MtPmRvbWFpbnMpCisJCQlkb21haW5zX2NvdW50ICs9
IHBvd2VyX2RvbWFpbnMtPmRvbWFpbl91c2VfY291bnRbZG9tYWluXTsKKworCQlpZiAocG93ZXJf
d2VsbC0+Y291bnQgIT0gZG9tYWluc19jb3VudCkgeworCQkJRFJNX0VSUk9SKCJwb3dlciB3ZWxs
ICVzIHJlZmNvdW50L2RvbWFpbiByZWZjb3VudCBtaXNtYXRjaCAiCisJCQkJICAiKHJlZmNvdW50
ICVkL2RvbWFpbnMgcmVmY291bnQgJWQpXG4iLAorCQkJCSAgcG93ZXJfd2VsbC0+ZGVzYy0+bmFt
ZSwgcG93ZXJfd2VsbC0+Y291bnQsCisJCQkJICBkb21haW5zX2NvdW50KTsKKwkJCWR1bXBfZG9t
YWluX2luZm8gPSB0cnVlOworCQl9CisJfQorCisJaWYgKGR1bXBfZG9tYWluX2luZm8pIHsKKwkJ
c3RhdGljIGJvb2wgZHVtcGVkOworCisJCWlmICghZHVtcGVkKSB7CisJCQlpbnRlbF9wb3dlcl9k
b21haW5zX2R1bXBfaW5mbyhpOTE1KTsKKwkJCWR1bXBlZCA9IHRydWU7CisJCX0KKwl9CisKKwlt
dXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOworfQorCisjZWxzZQorCitzdGF0aWMg
dm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX3ZlcmlmeV9zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSkKK3sKK30KKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9kaXNwbGF5X3Bvd2VyLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9k
aXNwbGF5X3Bvd2VyLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4z
YThiNTNiZTI0MmMKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9kaXNwbGF5X3Bvd2VyLmgKQEAgLTAsMCArMSw5NiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50
aWZpZXI6IE1JVCAqLworLyoKKyAqIENvcHlyaWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9u
CisgKi8KKworI2lmbmRlZiBfX0lOVEVMX0RJU1BMQVlfUE9XRVJfSF9fCisjZGVmaW5lIF9fSU5U
RUxfRElTUExBWV9QT1dFUl9IX18KKworI2luY2x1ZGUgImludGVsX2Rpc3BsYXkuaCIKKyNpbmNs
dWRlICJpbnRlbF9ydW50aW1lX3BtLmgiCisKK3N0cnVjdCBkcm1faTkxNV9wcml2YXRlOworc3Ry
dWN0IGludGVsX2VuY29kZXI7CisKK3ZvaWQgc2tsX2VuYWJsZV9kYzYoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KTsKK3ZvaWQgZ2VuOV9zYW5pdGl6ZV9kY19zdGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwordm9pZCBieHRfZW5hYmxlX2RjOShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwordm9pZCBieHRfZGlzYWJsZV9kYzkoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKK3ZvaWQgZ2VuOV9lbmFibGVfZGM1KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CisKK2ludCBpbnRlbF9wb3dlcl9kb21haW5z
X2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKik7Cit2b2lkIGludGVsX3Bvd2VyX2RvbWFp
bnNfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwordm9pZCBpbnRl
bF9wb3dlcl9kb21haW5zX2luaXRfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LCBib29sIHJlc3VtZSk7Cit2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfZmluaV9odyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwordm9pZCBpY2xfZGlzcGxheV9jb3JlX2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIHJlc3VtZSk7Cit2b2lkIGlj
bF9kaXNwbGF5X2NvcmVfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
Cit2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdik7Cit2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfZGlzYWJsZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwordm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX3N1c3Bl
bmQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSBlbnVtIGk5MTVfZHJt
X3N1c3BlbmRfbW9kZSk7Cit2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfcmVzdW1lKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cit2b2lkIGhzd19lbmFibGVfcGM4KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7Cit2b2lkIGhzd19kaXNhYmxlX3BjOChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwordm9pZCBieHRfZGlzcGxheV9jb3JlX2luaXQo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBib29sIHJlc3VtZSk7Cit2b2lkIGJ4
dF9kaXNwbGF5X2NvcmVfdW5pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7
CisKK2NvbnN0IGNoYXIgKgoraW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW5fc3RyKGVudW0gaW50
ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKTsKKworYm9vbCBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAg
ICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbik7Citib29sIF9faW50ZWxf
ZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKKwkJCQkgICAgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbik7Citp
bnRlbF93YWtlcmVmX3QgaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2LAorCQkJCQllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRv
bWFpbik7CitpbnRlbF93YWtlcmVmX3QKK2ludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJs
ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAgIGVudW0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKTsKK3ZvaWQgaW50ZWxfZGlzcGxheV9wb3dlcl9w
dXRfdW5jaGVja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKKwkJCQkgICAg
ICAgZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pOwordm9pZCBfX2ludGVs
X2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAor
CQkJCSAgICAgZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4sCisJCQkJICAg
ICBpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZik7Cit2b2lkIGludGVsX2Rpc3BsYXlfcG93ZXJfZmx1
c2hfd29yayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CisjaWYgSVNfRU5BQkxFRChD
T05GSUdfRFJNX0k5MTVfREVCVUdfUlVOVElNRV9QTSkKK3ZvaWQgaW50ZWxfZGlzcGxheV9wb3dl
cl9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJICAgICBlbnVtIGlu
dGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbiwKKwkJCSAgICAgaW50ZWxfd2FrZXJlZl90
IHdha2VyZWYpOworc3RhdGljIGlubGluZSB2b2lkCitpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF9h
c3luYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKKwkJCSAgICAgIGVudW0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluLAorCQkJICAgICAgaW50ZWxfd2FrZXJlZl90IHdh
a2VyZWYpCit7CisJX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF9hc3luYyhpOTE1LCBkb21haW4s
IHdha2VyZWYpOworfQorI2Vsc2UKK3N0YXRpYyBpbmxpbmUgdm9pZAoraW50ZWxfZGlzcGxheV9w
b3dlcl9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCisJCQllbnVtIGludGVsX2Rp
c3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbiwKKwkJCWludGVsX3dha2VyZWZfdCB3YWtlcmVmKQor
eworCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tlZChpOTE1LCBkb21haW4pOworfQor
CitzdGF0aWMgaW5saW5lIHZvaWQKK2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LAorCQkJICAgICAgZW51bSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2RvbWFpbiBkb21haW4sCisJCQkgICAgICBpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZikKK3sK
KwlfX2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jKGk5MTUsIGRvbWFpbiwgLTEpOworfQor
I2VuZGlmCisKKyNkZWZpbmUgd2l0aF9pbnRlbF9kaXNwbGF5X3Bvd2VyKGk5MTUsIGRvbWFpbiwg
d2YpIFwKKwlmb3IgKCh3ZikgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldCgoaTkxNSksIChkb21h
aW4pKTsgKHdmKTsgXAorCSAgICAgaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfYXN5bmMoKGk5MTUp
LCAoZG9tYWluKSwgKHdmKSksICh3ZikgPSAwKQorCit2b2lkIGljbF9kYnVmX3NsaWNlc191cGRh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJICAgIHU4IHJlcV9zbGlj
ZXMpOworCit2b2lkIGNodl9waHlfcG93ZXJnYXRlX2xhbmVzKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAorCQkJICAgICBib29sIG92ZXJyaWRlLCB1bnNpZ25lZCBpbnQgbWFzayk7Citi
b29sIGNodl9waHlfcG93ZXJnYXRlX2NoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwgZW51bSBkcGlvX3BoeSBwaHksCisJCQkgIGVudW0gZHBpb19jaGFubmVsIGNoLCBib29sIG92
ZXJyaWRlKTsKKworI2VuZGlmIC8qIF9fSU5URUxfRElTUExBWV9QT1dFUl9IX18gKi8KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3J1bnRpbWVfcG0uYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX3J1bnRpbWVfcG0uYwppbmRleCAxMmY1YjY2OWYyMGUuLjNiZGVl
YTU5NmFkNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGltZV9w
bS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3J1bnRpbWVfcG0uYwpAQCAtMzIs
MTYgKzMyLDYgQEAKICNpbmNsdWRlIDxkcm0vZHJtX3ByaW50Lmg+CiAKICNpbmNsdWRlICJpOTE1
X2Rydi5oIgotI2luY2x1ZGUgImk5MTVfaXJxLmgiCi0jaW5jbHVkZSAiaW50ZWxfY2RjbGsuaCIK
LSNpbmNsdWRlICJpbnRlbF9jb21ib19waHkuaCIKLSNpbmNsdWRlICJpbnRlbF9jcnQuaCIKLSNp
bmNsdWRlICJpbnRlbF9jc3IuaCIKLSNpbmNsdWRlICJpbnRlbF9kcC5oIgotI2luY2x1ZGUgImlu
dGVsX2RwaW9fcGh5LmgiCi0jaW5jbHVkZSAiaW50ZWxfZHJ2LmgiCi0jaW5jbHVkZSAiaW50ZWxf
aG90cGx1Zy5oIgotI2luY2x1ZGUgImludGVsX3NpZGViYW5kLmgiCiAKIC8qKgogICogRE9DOiBy
dW50aW1lIHBtCkBAIC02MCwyMiArNTAsNiBAQAogICogcHJlc2VudCBmb3IgYSBnaXZlbiBwbGF0
Zm9ybS4KICAqLwogCi1zdGF0aWMgaW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVfcG1fZ2V0
X3JhdyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7Ci1zdGF0aWMgdm9pZAotX19pbnRl
bF9ydW50aW1lX3BtX3B1dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50ZWxfd2Fr
ZXJlZl90IHdyZWYsCi0JCSAgICAgICBib29sIHdha2Vsb2NrKTsKLQotI2lmIElTX0VOQUJMRUQo
Q09ORklHX0RSTV9JOTE1X0RFQlVHX1JVTlRJTUVfUE0pCi1zdGF0aWMgdm9pZAotaW50ZWxfcnVu
dGltZV9wbV9wdXRfcmF3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnRlbF93YWtl
cmVmX3Qgd3JlZik7Ci0jZWxzZQotc3RhdGljIGlubGluZSB2b2lkIGludGVsX3J1bnRpbWVfcG1f
cHV0X3JhdyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKLQkJCQkJICAgIGludGVsX3dh
a2VyZWZfdCB3cmVmKQotewotCV9faW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgLTEsIGZhbHNl
KTsKLX0KLSNlbmRpZgotCiAjaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfUlVO
VElNRV9QTSkKIAogI2luY2x1ZGUgPGxpbnV4L3NvcnQuaD4KQEAgLTM5MSw0NzI3ICszNjUsMTYw
IEBAIGludGVsX3J1bnRpbWVfcG1fcmVsZWFzZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSwgaW50IHdha2Vsb2NrKQogCV9faW50ZWxfd2FrZXJlZl9kZWNfYW5kX2NoZWNrX3RyYWNraW5n
KGk5MTUpOwogfQogCi1ib29sIGludGVsX2Rpc3BsYXlfcG93ZXJfd2VsbF9pc19lbmFibGVkKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkJIGVudW0gaTkxNV9wb3dlcl93
ZWxsX2lkIHBvd2VyX3dlbGxfaWQpOwotCi1jb25zdCBjaGFyICoKLWludGVsX2Rpc3BsYXlfcG93
ZXJfZG9tYWluX3N0cihlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbikKLXsK
LQlzd2l0Y2ggKGRvbWFpbikgewotCWNhc2UgUE9XRVJfRE9NQUlOX0RJU1BMQVlfQ09SRToKLQkJ
cmV0dXJuICJESVNQTEFZX0NPUkUiOwotCWNhc2UgUE9XRVJfRE9NQUlOX1BJUEVfQToKLQkJcmV0
dXJuICJQSVBFX0EiOwotCWNhc2UgUE9XRVJfRE9NQUlOX1BJUEVfQjoKLQkJcmV0dXJuICJQSVBF
X0IiOwotCWNhc2UgUE9XRVJfRE9NQUlOX1BJUEVfQzoKLQkJcmV0dXJuICJQSVBFX0MiOwotCWNh
c2UgUE9XRVJfRE9NQUlOX1BJUEVfQV9QQU5FTF9GSVRURVI6Ci0JCXJldHVybiAiUElQRV9BX1BB
TkVMX0ZJVFRFUiI7Ci0JY2FzZSBQT1dFUl9ET01BSU5fUElQRV9CX1BBTkVMX0ZJVFRFUjoKLQkJ
cmV0dXJuICJQSVBFX0JfUEFORUxfRklUVEVSIjsKLQljYXNlIFBPV0VSX0RPTUFJTl9QSVBFX0Nf
UEFORUxfRklUVEVSOgotCQlyZXR1cm4gIlBJUEVfQ19QQU5FTF9GSVRURVIiOwotCWNhc2UgUE9X
RVJfRE9NQUlOX1RSQU5TQ09ERVJfQToKLQkJcmV0dXJuICJUUkFOU0NPREVSX0EiOwotCWNhc2Ug
UE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQjoKLQkJcmV0dXJuICJUUkFOU0NPREVSX0IiOwotCWNh
c2UgUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQzoKLQkJcmV0dXJuICJUUkFOU0NPREVSX0MiOwot
CWNhc2UgUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfRURQOgotCQlyZXR1cm4gIlRSQU5TQ09ERVJf
RURQIjsKLQljYXNlIFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0VEUF9WRFNDOgotCQlyZXR1cm4g
IlRSQU5TQ09ERVJfRURQX1ZEU0MiOwotCWNhc2UgUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfRFNJ
X0E6Ci0JCXJldHVybiAiVFJBTlNDT0RFUl9EU0lfQSI7Ci0JY2FzZSBQT1dFUl9ET01BSU5fVFJB
TlNDT0RFUl9EU0lfQzoKLQkJcmV0dXJuICJUUkFOU0NPREVSX0RTSV9DIjsKLQljYXNlIFBPV0VS
X0RPTUFJTl9QT1JUX0RESV9BX0xBTkVTOgotCQlyZXR1cm4gIlBPUlRfRERJX0FfTEFORVMiOwot
CWNhc2UgUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfTEFORVM6Ci0JCXJldHVybiAiUE9SVF9ERElf
Ql9MQU5FUyI7Ci0JY2FzZSBQT1dFUl9ET01BSU5fUE9SVF9ERElfQ19MQU5FUzoKLQkJcmV0dXJu
ICJQT1JUX0RESV9DX0xBTkVTIjsKLQljYXNlIFBPV0VSX0RPTUFJTl9QT1JUX0RESV9EX0xBTkVT
OgotCQlyZXR1cm4gIlBPUlRfRERJX0RfTEFORVMiOwotCWNhc2UgUE9XRVJfRE9NQUlOX1BPUlRf
RERJX0VfTEFORVM6Ci0JCXJldHVybiAiUE9SVF9ERElfRV9MQU5FUyI7Ci0JY2FzZSBQT1dFUl9E
T01BSU5fUE9SVF9ERElfRl9MQU5FUzoKLQkJcmV0dXJuICJQT1JUX0RESV9GX0xBTkVTIjsKLQlj
YXNlIFBPV0VSX0RPTUFJTl9QT1JUX0RESV9BX0lPOgotCQlyZXR1cm4gIlBPUlRfRERJX0FfSU8i
OwotCWNhc2UgUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfSU86Ci0JCXJldHVybiAiUE9SVF9ERElf
Ql9JTyI7Ci0JY2FzZSBQT1dFUl9ET01BSU5fUE9SVF9ERElfQ19JTzoKLQkJcmV0dXJuICJQT1JU
X0RESV9DX0lPIjsKLQljYXNlIFBPV0VSX0RPTUFJTl9QT1JUX0RESV9EX0lPOgotCQlyZXR1cm4g
IlBPUlRfRERJX0RfSU8iOwotCWNhc2UgUE9XRVJfRE9NQUlOX1BPUlRfRERJX0VfSU86Ci0JCXJl
dHVybiAiUE9SVF9ERElfRV9JTyI7Ci0JY2FzZSBQT1dFUl9ET01BSU5fUE9SVF9ERElfRl9JTzoK
LQkJcmV0dXJuICJQT1JUX0RESV9GX0lPIjsKLQljYXNlIFBPV0VSX0RPTUFJTl9QT1JUX0RTSToK
LQkJcmV0dXJuICJQT1JUX0RTSSI7Ci0JY2FzZSBQT1dFUl9ET01BSU5fUE9SVF9DUlQ6Ci0JCXJl
dHVybiAiUE9SVF9DUlQiOwotCWNhc2UgUE9XRVJfRE9NQUlOX1BPUlRfT1RIRVI6Ci0JCXJldHVy
biAiUE9SVF9PVEhFUiI7Ci0JY2FzZSBQT1dFUl9ET01BSU5fVkdBOgotCQlyZXR1cm4gIlZHQSI7
Ci0JY2FzZSBQT1dFUl9ET01BSU5fQVVESU86Ci0JCXJldHVybiAiQVVESU8iOwotCWNhc2UgUE9X
RVJfRE9NQUlOX0FVWF9BOgotCQlyZXR1cm4gIkFVWF9BIjsKLQljYXNlIFBPV0VSX0RPTUFJTl9B
VVhfQjoKLQkJcmV0dXJuICJBVVhfQiI7Ci0JY2FzZSBQT1dFUl9ET01BSU5fQVVYX0M6Ci0JCXJl
dHVybiAiQVVYX0MiOwotCWNhc2UgUE9XRVJfRE9NQUlOX0FVWF9EOgotCQlyZXR1cm4gIkFVWF9E
IjsKLQljYXNlIFBPV0VSX0RPTUFJTl9BVVhfRToKLQkJcmV0dXJuICJBVVhfRSI7Ci0JY2FzZSBQ
T1dFUl9ET01BSU5fQVVYX0Y6Ci0JCXJldHVybiAiQVVYX0YiOwotCWNhc2UgUE9XRVJfRE9NQUlO
X0FVWF9JT19BOgotCQlyZXR1cm4gIkFVWF9JT19BIjsKLQljYXNlIFBPV0VSX0RPTUFJTl9BVVhf
VEJUMToKLQkJcmV0dXJuICJBVVhfVEJUMSI7Ci0JY2FzZSBQT1dFUl9ET01BSU5fQVVYX1RCVDI6
Ci0JCXJldHVybiAiQVVYX1RCVDIiOwotCWNhc2UgUE9XRVJfRE9NQUlOX0FVWF9UQlQzOgotCQly
ZXR1cm4gIkFVWF9UQlQzIjsKLQljYXNlIFBPV0VSX0RPTUFJTl9BVVhfVEJUNDoKLQkJcmV0dXJu
ICJBVVhfVEJUNCI7Ci0JY2FzZSBQT1dFUl9ET01BSU5fR01CVVM6Ci0JCXJldHVybiAiR01CVVMi
OwotCWNhc2UgUE9XRVJfRE9NQUlOX0lOSVQ6Ci0JCXJldHVybiAiSU5JVCI7Ci0JY2FzZSBQT1dF
Ul9ET01BSU5fTU9ERVNFVDoKLQkJcmV0dXJuICJNT0RFU0VUIjsKLQljYXNlIFBPV0VSX0RPTUFJ
Tl9HVF9JUlE6Ci0JCXJldHVybiAiR1RfSVJRIjsKLQlkZWZhdWx0OgotCQlNSVNTSU5HX0NBU0Uo
ZG9tYWluKTsKLQkJcmV0dXJuICI/IjsKLQl9Ci19Ci0KLXN0YXRpYyB2b2lkIGludGVsX3Bvd2Vy
X3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgICAg
c3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKLXsKLQlEUk1fREVCVUdfS01TKCJl
bmFibGluZyAlc1xuIiwgcG93ZXJfd2VsbC0+ZGVzYy0+bmFtZSk7Ci0JcG93ZXJfd2VsbC0+ZGVz
Yy0+b3BzLT5lbmFibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwotCXBvd2VyX3dlbGwtPmh3X2Vu
YWJsZWQgPSB0cnVlOwotfQotCi1zdGF0aWMgdm9pZCBpbnRlbF9wb3dlcl93ZWxsX2Rpc2FibGUo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCSAgICAgc3RydWN0IGk5MTVf
cG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKK3N0YXRpYyBpbnRlbF93YWtlcmVmX3QgX19pbnRlbF9y
dW50aW1lX3BtX2dldChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKKwkJCQkJICAgICAg
Ym9vbCB3YWtlbG9jaykKIHsKLQlEUk1fREVCVUdfS01TKCJkaXNhYmxpbmcgJXNcbiIsIHBvd2Vy
X3dlbGwtPmRlc2MtPm5hbWUpOwotCXBvd2VyX3dlbGwtPmh3X2VuYWJsZWQgPSBmYWxzZTsKLQlw
b3dlcl93ZWxsLT5kZXNjLT5vcHMtPmRpc2FibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwotfQor
CXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkxNS0+ZHJtLnBkZXY7CisJc3RydWN0IGRldmljZSAq
a2RldiA9ICZwZGV2LT5kZXY7CisJaW50IHJldDsKIAotc3RhdGljIHZvaWQgaW50ZWxfcG93ZXJf
d2VsbF9nZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCSBzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQotewotCWlmICghcG93ZXJfd2VsbC0+Y291bnQr
KykKLQkJaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwotfQor
CXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoa2Rldik7CisJV0FSTl9PTkNFKHJldCA8IDAsICJw
bV9ydW50aW1lX2dldF9zeW5jKCkgZmFpbGVkOiAlZFxuIiwgcmV0KTsKIAotc3RhdGljIHZvaWQg
aW50ZWxfcG93ZXJfd2VsbF9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAot
CQkJCSBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQotewotCVdBUk4oIXBvd2Vy
X3dlbGwtPmNvdW50LCAiVXNlIGNvdW50IG9uIHBvd2VyIHdlbGwgJXMgaXMgYWxyZWFkeSB6ZXJv
IiwKLQkgICAgIHBvd2VyX3dlbGwtPmRlc2MtPm5hbWUpOworCWludGVsX3J1bnRpbWVfcG1fYWNx
dWlyZShpOTE1LCB3YWtlbG9jayk7CiAKLQlpZiAoIS0tcG93ZXJfd2VsbC0+Y291bnQpCi0JCWlu
dGVsX3Bvd2VyX3dlbGxfZGlzYWJsZShkZXZfcHJpdiwgcG93ZXJfd2VsbCk7CisJcmV0dXJuIHRy
YWNrX2ludGVsX3J1bnRpbWVfcG1fd2FrZXJlZihpOTE1KTsKIH0KIAogLyoqCi0gKiBfX2ludGVs
X2Rpc3BsYXlfcG93ZXJfaXNfZW5hYmxlZCAtIHVubG9ja2VkIGNoZWNrIGZvciBhIHBvd2VyIGRv
bWFpbgotICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQotICogQGRvbWFpbjogcG93
ZXIgZG9tYWluIHRvIGNoZWNrCisgKiBpbnRlbF9ydW50aW1lX3BtX2dldF9yYXcgLSBncmFiIGEg
cmF3IHJ1bnRpbWUgcG0gcmVmZXJlbmNlCisgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UK
ICAqCiAgKiBUaGlzIGlzIHRoZSB1bmxvY2tlZCB2ZXJzaW9uIG9mIGludGVsX2Rpc3BsYXlfcG93
ZXJfaXNfZW5hYmxlZCgpIGFuZCBzaG91bGQKICAqIG9ubHkgYmUgdXNlZCBmcm9tIGVycm9yIGNh
cHR1cmUgYW5kIHJlY292ZXJ5IGNvZGUgd2hlcmUgZGVhZGxvY2tzIGFyZQogICogcG9zc2libGUu
CisgKiBUaGlzIGZ1bmN0aW9uIGdyYWJzIGEgZGV2aWNlLWxldmVsIHJ1bnRpbWUgcG0gcmVmZXJl
bmNlIChtb3N0bHkgdXNlZCBmb3IKKyAqIGFzeW5jaHJvbm91cyBQTSBtYW5hZ2VtZW50IGZyb20g
ZGlzcGxheSBjb2RlKSBhbmQgZW5zdXJlcyB0aGF0IGl0IGlzIHBvd2VyZWQKKyAqIHVwLiBSYXcg
cmVmZXJlbmNlcyBhcmUgbm90IGNvbnNpZGVyZWQgZHVyaW5nIHdha2Vsb2NrIGFzc2VydCBjaGVj
a3MuCiAgKgogICogUmV0dXJuczoKICAqIFRydWUgd2hlbiB0aGUgcG93ZXIgZG9tYWluIGlzIGVu
YWJsZWQsIGZhbHNlIG90aGVyd2lzZS4KKyAqIEFueSBydW50aW1lIHBtIHJlZmVyZW5jZSBvYnRh
aW5lZCBieSB0aGlzIGZ1bmN0aW9uIG11c3QgaGF2ZSBhIHN5bW1ldHJpYworICogY2FsbCB0byBp
bnRlbF9ydW50aW1lX3BtX3B1dF9yYXcoKSB0byByZWxlYXNlIHRoZSByZWZlcmVuY2UgYWdhaW4u
CisgKgorICogUmV0dXJuczogdGhlIHdha2VyZWYgY29va2llIHRvIHBhc3MgdG8gaW50ZWxfcnVu
dGltZV9wbV9wdXRfcmF3KCksIGV2YWx1YXRlcworICogYXMgVHJ1ZSBpZiB0aGUgd2FrZXJlZiB3
YXMgYWNxdWlyZWQsIG9yIEZhbHNlIG90aGVyd2lzZS4KICAqLwotYm9vbCBfX2ludGVsX2Rpc3Bs
YXlfcG93ZXJfaXNfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0J
CQkJICAgICAgZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pCi17Ci0Jc3Ry
dWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbDsKLQlib29sIGlzX2VuYWJsZWQ7Ci0KLQlp
ZiAoZGV2X3ByaXYtPnJ1bnRpbWVfcG0uc3VzcGVuZGVkKQotCQlyZXR1cm4gZmFsc2U7Ci0KLQlp
c19lbmFibGVkID0gdHJ1ZTsKLQotCWZvcl9lYWNoX3Bvd2VyX2RvbWFpbl93ZWxsX3JldmVyc2Uo
ZGV2X3ByaXYsIHBvd2VyX3dlbGwsIEJJVF9VTEwoZG9tYWluKSkgewotCQlpZiAocG93ZXJfd2Vs
bC0+ZGVzYy0+YWx3YXlzX29uKQotCQkJY29udGludWU7Ci0KLQkJaWYgKCFwb3dlcl93ZWxsLT5o
d19lbmFibGVkKSB7Ci0JCQlpc19lbmFibGVkID0gZmFsc2U7Ci0JCQlicmVhazsKLQkJfQotCX0K
IAotCXJldHVybiBpc19lbmFibGVkOworaW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRpbWVfcG1f
Z2V0X3JhdyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3sKKwlyZXR1cm4gX19pbnRl
bF9ydW50aW1lX3BtX2dldChpOTE1LCBmYWxzZSk7CiB9CiAKIC8qKgotICogaW50ZWxfZGlzcGxh
eV9wb3dlcl9pc19lbmFibGVkIC0gY2hlY2sgZm9yIGEgcG93ZXIgZG9tYWluCi0gKiBAZGV2X3By
aXY6IGk5MTUgZGV2aWNlIGluc3RhbmNlCi0gKiBAZG9tYWluOiBwb3dlciBkb21haW4gdG8gY2hl
Y2sKKyAqIGludGVsX3J1bnRpbWVfcG1fZ2V0IC0gZ3JhYiBhIHJ1bnRpbWUgcG0gcmVmZXJlbmNl
CisgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKICAqCi0gKiBUaGlzIGZ1bmN0aW9uIGNh
biBiZSB1c2VkIHRvIGNoZWNrIHRoZSBodyBwb3dlciBkb21haW4gc3RhdGUuIEl0IGlzIG1vc3Rs
eQotICogdXNlZCBpbiBoYXJkd2FyZSBzdGF0ZSByZWFkb3V0IGZ1bmN0aW9ucy4gRXZlcnl3aGVy
ZSBlbHNlIGNvZGUgc2hvdWxkIHJlbHkKLSAqIHVwb24gZXhwbGljaXQgcG93ZXIgZG9tYWluIHJl
ZmVyZW5jZSBjb3VudGluZyB0byBlbnN1cmUgdGhhdCB0aGUgaGFyZHdhcmUKLSAqIGJsb2NrIGlz
IHBvd2VyZWQgdXAgYmVmb3JlIGFjY2Vzc2luZyBpdC4KKyAqIFRoaXMgZnVuY3Rpb24gZ3JhYnMg
YSBkZXZpY2UtbGV2ZWwgcnVudGltZSBwbSByZWZlcmVuY2UgKG1vc3RseSB1c2VkIGZvciBHRU0K
KyAqIGNvZGUgdG8gZW5zdXJlIHRoZSBHVFQgb3IgR1QgaXMgb24pIGFuZCBlbnN1cmVzIHRoYXQg
aXQgaXMgcG93ZXJlZCB1cC4KICAqCi0gKiBDYWxsZXJzIG11c3QgaG9sZCB0aGUgcmVsZXZhbnQg
bW9kZXNldHRpbmcgbG9ja3MgdG8gZW5zdXJlIHRoYXQgY29uY3VycmVudAotICogdGhyZWFkcyBj
YW4ndCBkaXNhYmxlIHRoZSBwb3dlciB3ZWxsIHdoaWxlIHRoZSBjYWxsZXIgdHJpZXMgdG8gcmVh
ZCBhIGZldwotICogcmVnaXN0ZXJzLgorICogQW55IHJ1bnRpbWUgcG0gcmVmZXJlbmNlIG9idGFp
bmVkIGJ5IHRoaXMgZnVuY3Rpb24gbXVzdCBoYXZlIGEgc3ltbWV0cmljCisgKiBjYWxsIHRvIGlu
dGVsX3J1bnRpbWVfcG1fcHV0KCkgdG8gcmVsZWFzZSB0aGUgcmVmZXJlbmNlIGFnYWluLgogICoK
LSAqIFJldHVybnM6Ci0gKiBUcnVlIHdoZW4gdGhlIHBvd2VyIGRvbWFpbiBpcyBlbmFibGVkLCBm
YWxzZSBvdGhlcndpc2UuCisgKiBSZXR1cm5zOiB0aGUgd2FrZXJlZiBjb29raWUgdG8gcGFzcyB0
byBpbnRlbF9ydW50aW1lX3BtX3B1dCgpCiAgKi8KLWJvb2wgaW50ZWxfZGlzcGxheV9wb3dlcl9p
c19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgICAgZW51
bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pCitpbnRlbF93YWtlcmVmX3QgaW50
ZWxfcnVudGltZV9wbV9nZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7Ci0Jc3Ry
dWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWluczsKLQlib29sIHJldDsKLQotCXBv
d2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Ci0KLQltdXRleF9sb2NrKCZw
b3dlcl9kb21haW5zLT5sb2NrKTsKLQlyZXQgPSBfX2ludGVsX2Rpc3BsYXlfcG93ZXJfaXNfZW5h
YmxlZChkZXZfcHJpdiwgZG9tYWluKTsKLQltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxv
Y2spOwotCi0JcmV0dXJuIHJldDsKKwlyZXR1cm4gX19pbnRlbF9ydW50aW1lX3BtX2dldChpOTE1
LCB0cnVlKTsKIH0KIAotLyoKLSAqIFN0YXJ0aW5nIHdpdGggSGFzd2VsbCwgd2UgaGF2ZSBhICJQ
b3dlciBEb3duIFdlbGwiIHRoYXQgY2FuIGJlIHR1cm5lZCBvZmYKLSAqIHdoZW4gbm90IG5lZWRl
ZCBhbnltb3JlLiBXZSBoYXZlIDQgcmVnaXN0ZXJzIHRoYXQgY2FuIHJlcXVlc3QgdGhlIHBvd2Vy
IHdlbGwKLSAqIHRvIGJlIGVuYWJsZWQsIGFuZCBpdCB3aWxsIG9ubHkgYmUgZGlzYWJsZWQgaWYg
bm9uZSBvZiB0aGUgcmVnaXN0ZXJzIGlzCi0gKiByZXF1ZXN0aW5nIGl0IHRvIGJlIGVuYWJsZWQu
CisvKioKKyAqIGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZSAtIGdyYWIgYSBydW50aW1l
IHBtIHJlZmVyZW5jZSBpZiBkZXZpY2UgaW4gdXNlCisgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5z
dGFuY2UKKyAqCisgKiBUaGlzIGZ1bmN0aW9uIGdyYWJzIGEgZGV2aWNlLWxldmVsIHJ1bnRpbWUg
cG0gcmVmZXJlbmNlIGlmIHRoZSBkZXZpY2UgaXMKKyAqIGFscmVhZHkgaW4gdXNlIGFuZCBlbnN1
cmVzIHRoYXQgaXQgaXMgcG93ZXJlZCB1cC4gSXQgaXMgaWxsZWdhbCB0byB0cnkKKyAqIGFuZCBh
Y2Nlc3MgdGhlIEhXIHNob3VsZCBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2UoKSByZXBv
cnQgZmFpbHVyZS4KKyAqCisgKiBBbnkgcnVudGltZSBwbSByZWZlcmVuY2Ugb2J0YWluZWQgYnkg
dGhpcyBmdW5jdGlvbiBtdXN0IGhhdmUgYSBzeW1tZXRyaWMKKyAqIGNhbGwgdG8gaW50ZWxfcnVu
dGltZV9wbV9wdXQoKSB0byByZWxlYXNlIHRoZSByZWZlcmVuY2UgYWdhaW4uCisgKgorICogUmV0
dXJuczogdGhlIHdha2VyZWYgY29va2llIHRvIHBhc3MgdG8gaW50ZWxfcnVudGltZV9wbV9wdXQo
KSwgZXZhbHVhdGVzCisgKiBhcyBUcnVlIGlmIHRoZSB3YWtlcmVmIHdhcyBhY3F1aXJlZCwgb3Ig
RmFsc2Ugb3RoZXJ3aXNlLgogICovCi1zdGF0aWMgdm9pZCBoc3dfcG93ZXJfd2VsbF9wb3N0X2Vu
YWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJICAgICAgIHU4IGly
cV9waXBlX21hc2ssIGJvb2wgaGFzX3ZnYSkKLXsKLQlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGRl
dl9wcml2LT5kcm0ucGRldjsKLQotCS8qCi0JICogQWZ0ZXIgd2UgcmUtZW5hYmxlIHRoZSBwb3dl
ciB3ZWxsLCBpZiB3ZSB0b3VjaCBWR0EgcmVnaXN0ZXIgMHgzZDUKLQkgKiB3ZSdsbCBnZXQgdW5j
bGFpbWVkIHJlZ2lzdGVyIGludGVycnVwdHMuIFRoaXMgc3RvcHMgYWZ0ZXIgd2Ugd3JpdGUKLQkg
KiBhbnl0aGluZyB0byB0aGUgVkdBIE1TUiByZWdpc3Rlci4gVGhlIHZnYWNvbiBtb2R1bGUgdXNl
cyB0aGlzCi0JICogcmVnaXN0ZXIgYWxsIHRoZSB0aW1lLCBzbyBpZiB3ZSB1bmJpbmQgb3VyIGRy
aXZlciBhbmQsIGFzIGEKLQkgKiBjb25zZXF1ZW5jZSwgYmluZCB2Z2Fjb24sIHdlJ2xsIGdldCBz
dHVjayBpbiBhbiBpbmZpbml0ZSBsb29wIGF0Ci0JICogY29uc29sZV91bmxvY2soKS4gU28gbWFr
ZSBoZXJlIHdlIHRvdWNoIHRoZSBWR0EgTVNSIHJlZ2lzdGVyLCBtYWtpbmcKLQkgKiBzdXJlIHZn
YWNvbiBjYW4ga2VlcCB3b3JraW5nIG5vcm1hbGx5IHdpdGhvdXQgdHJpZ2dlcmluZyBpbnRlcnJ1
cHRzCi0JICogYW5kIGVycm9yIG1lc3NhZ2VzLgotCSAqLwotCWlmIChoYXNfdmdhKSB7Ci0JCXZn
YV9nZXRfdW5pbnRlcnJ1cHRpYmxlKHBkZXYsIFZHQV9SU1JDX0xFR0FDWV9JTyk7Ci0JCW91dGIo
aW5iKFZHQV9NU1JfUkVBRCksIFZHQV9NU1JfV1JJVEUpOwotCQl2Z2FfcHV0KHBkZXYsIFZHQV9S
U1JDX0xFR0FDWV9JTyk7Ci0JfQotCi0JaWYgKGlycV9waXBlX21hc2spCi0JCWdlbjhfaXJxX3Bv
d2VyX3dlbGxfcG9zdF9lbmFibGUoZGV2X3ByaXYsIGlycV9waXBlX21hc2spOwotfQotCi1zdGF0
aWMgdm9pZCBoc3dfcG93ZXJfd2VsbF9wcmVfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsCi0JCQkJICAgICAgIHU4IGlycV9waXBlX21hc2spCi17Ci0JaWYgKGlycV9w
aXBlX21hc2spCi0JCWdlbjhfaXJxX3Bvd2VyX3dlbGxfcHJlX2Rpc2FibGUoZGV2X3ByaXYsIGly
cV9waXBlX21hc2spOwotfQotCi0KLXN0YXRpYyB2b2lkIGhzd193YWl0X2Zvcl9wb3dlcl93ZWxs
X2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJCSAgIHN0cnVj
dCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCi17Ci0JY29uc3Qgc3RydWN0IGk5MTVfcG93
ZXJfd2VsbF9yZWdzICpyZWdzID0gcG93ZXJfd2VsbC0+ZGVzYy0+aHN3LnJlZ3M7Ci0JaW50IHB3
X2lkeCA9IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5pZHg7Ci0KLQkvKiBUaW1lb3V0IGZvciBQVzE6
MTAgdXMsIEFVWDpub3Qgc3BlY2lmaWVkLCBvdGhlciBQV3M6MjAgdXMuICovCi0JV0FSTl9PTihp
bnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3ByaXYtPnVuY29yZSwKLQkJCQkJcmVncy0+ZHJp
dmVyLAotCQkJCQlIU1dfUFdSX1dFTExfQ1RMX1NUQVRFKHB3X2lkeCksCi0JCQkJCUhTV19QV1Jf
V0VMTF9DVExfU1RBVEUocHdfaWR4KSwKLQkJCQkJMSkpOwotfQotCi1zdGF0aWMgdTMyIGhzd19w
b3dlcl93ZWxsX3JlcXVlc3RlcnMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAot
CQkJCSAgICAgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzICpyZWdzLAotCQkJCSAg
ICAgaW50IHB3X2lkeCkKLXsKLQl1MzIgcmVxX21hc2sgPSBIU1dfUFdSX1dFTExfQ1RMX1JFUShw
d19pZHgpOwotCXUzMiByZXQ7Ci0KLQlyZXQgPSBJOTE1X1JFQUQocmVncy0+YmlvcykgJiByZXFf
bWFzayA/IDEgOiAwOwotCXJldCB8PSBJOTE1X1JFQUQocmVncy0+ZHJpdmVyKSAmIHJlcV9tYXNr
ID8gMiA6IDA7Ci0JaWYgKHJlZ3MtPmt2bXIucmVnKQotCQlyZXQgfD0gSTkxNV9SRUFEKHJlZ3Mt
Pmt2bXIpICYgcmVxX21hc2sgPyA0IDogMDsKLQlyZXQgfD0gSTkxNV9SRUFEKHJlZ3MtPmRlYnVn
KSAmIHJlcV9tYXNrID8gOCA6IDA7Ci0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgdm9pZCBo
c3dfd2FpdF9mb3JfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdiwKLQkJCQkJICAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCi17
Ci0JY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzICpyZWdzID0gcG93ZXJfd2VsbC0+
ZGVzYy0+aHN3LnJlZ3M7Ci0JaW50IHB3X2lkeCA9IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5pZHg7
Ci0JYm9vbCBkaXNhYmxlZDsKLQl1MzIgcmVxczsKLQotCS8qCi0JICogQnNwZWMgZG9lc24ndCBy
ZXF1aXJlIHdhaXRpbmcgZm9yIFBXcyB0byBnZXQgZGlzYWJsZWQsIGJ1dCBzdGlsbCBkbwotCSAq
IHRoaXMgZm9yIHBhcmFub2lhLiBUaGUga25vd24gY2FzZXMgd2hlcmUgYSBQVyB3aWxsIGJlIGZv
cmNlZCBvbjoKLQkgKiAtIGEgS1ZNUiByZXF1ZXN0IG9uIGFueSBwb3dlciB3ZWxsIHZpYSB0aGUg
S1ZNUiByZXF1ZXN0IHJlZ2lzdGVyCi0JICogLSBhIERNQyByZXF1ZXN0IG9uIFBXMSBhbmQgTUlT
Q19JTyBwb3dlciB3ZWxscyB2aWEgdGhlIEJJT1MgYW5kCi0JICogICBERUJVRyByZXF1ZXN0IHJl
Z2lzdGVycwotCSAqIFNraXAgdGhlIHdhaXQgaW4gY2FzZSBhbnkgb2YgdGhlIHJlcXVlc3QgYml0
cyBhcmUgc2V0IGFuZCBwcmludCBhCi0JICogZGlhZ25vc3RpYyBtZXNzYWdlLgotCSAqLwotCXdh
aXRfZm9yKChkaXNhYmxlZCA9ICEoSTkxNV9SRUFEKHJlZ3MtPmRyaXZlcikgJgotCQkJICAgICAg
IEhTV19QV1JfV0VMTF9DVExfU1RBVEUocHdfaWR4KSkpIHx8Ci0JCSAocmVxcyA9IGhzd19wb3dl
cl93ZWxsX3JlcXVlc3RlcnMoZGV2X3ByaXYsIHJlZ3MsIHB3X2lkeCkpLCAxKTsKLQlpZiAoZGlz
YWJsZWQpCi0JCXJldHVybjsKLQotCURSTV9ERUJVR19LTVMoIiVzIGZvcmNlZCBvbiAoYmlvczol
ZCBkcml2ZXI6JWQga3ZtcjolZCBkZWJ1ZzolZClcbiIsCi0JCSAgICAgIHBvd2VyX3dlbGwtPmRl
c2MtPm5hbWUsCi0JCSAgICAgICEhKHJlcXMgJiAxKSwgISEocmVxcyAmIDIpLCAhIShyZXFzICYg
NCksICEhKHJlcXMgJiA4KSk7Ci19Ci0KLXN0YXRpYyB2b2lkIGdlbjlfd2FpdF9mb3JfcG93ZXJf
d2VsbF9mdXNlcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJCSAgIGVu
dW0gc2tsX3Bvd2VyX2dhdGUgcGcpCi17Ci0JLyogVGltZW91dCA1dXMgZm9yIFBHIzAsIGZvciBv
dGhlciBQR3MgMXVzICovCi0JV0FSTl9PTihpbnRlbF93YWl0X2Zvcl9yZWdpc3RlcigmZGV2X3By
aXYtPnVuY29yZSwgU0tMX0ZVU0VfU1RBVFVTLAotCQkJCQlTS0xfRlVTRV9QR19ESVNUX1NUQVRV
UyhwZyksCi0JCQkJCVNLTF9GVVNFX1BHX0RJU1RfU1RBVFVTKHBnKSwgMSkpOwotfQotCi1zdGF0
aWMgdm9pZCBoc3dfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2LAotCQkJCSAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKK2ludGVs
X3dha2VyZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2Uoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUpCiB7Ci0JY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzICpy
ZWdzID0gcG93ZXJfd2VsbC0+ZGVzYy0+aHN3LnJlZ3M7Ci0JaW50IHB3X2lkeCA9IHBvd2VyX3dl
bGwtPmRlc2MtPmhzdy5pZHg7Ci0JYm9vbCB3YWl0X2Z1c2VzID0gcG93ZXJfd2VsbC0+ZGVzYy0+
aHN3Lmhhc19mdXNlczsKLQllbnVtIHNrbF9wb3dlcl9nYXRlIHVuaW5pdGlhbGl6ZWRfdmFyKHBn
KTsKLQl1MzIgdmFsOworCWlmIChJU19FTkFCTEVEKENPTkZJR19QTSkpIHsKKwkJc3RydWN0IHBj
aV9kZXYgKnBkZXYgPSBpOTE1LT5kcm0ucGRldjsKKwkJc3RydWN0IGRldmljZSAqa2RldiA9ICZw
ZGV2LT5kZXY7CiAKLQlpZiAod2FpdF9mdXNlcykgewotCQlwZyA9IElOVEVMX0dFTihkZXZfcHJp
dikgPj0gMTEgPyBJQ0xfUFdfQ1RMX0lEWF9UT19QRyhwd19pZHgpIDoKLQkJCQkJCSBTS0xfUFdf
Q1RMX0lEWF9UT19QRyhwd19pZHgpOwogCQkvKgotCQkgKiBGb3IgUFcxIHdlIGhhdmUgdG8gd2Fp
dCBib3RoIGZvciB0aGUgUFcwL1BHMCBmdXNlIHN0YXRlCi0JCSAqIGJlZm9yZSBlbmFibGluZyB0
aGUgcG93ZXIgd2VsbCBhbmQgUFcxL1BHMSdzIG93biBmdXNlCi0JCSAqIHN0YXRlIGFmdGVyIHRo
ZSBlbmFibGluZy4gRm9yIGFsbCBvdGhlciBwb3dlciB3ZWxscyB3aXRoCi0JCSAqIGZ1c2VzIHdl
IG9ubHkgaGF2ZSB0byB3YWl0IGZvciB0aGF0IFBXL1BHJ3MgZnVzZSBzdGF0ZQotCQkgKiBhZnRl
ciB0aGUgZW5hYmxpbmcuCisJCSAqIEluIGNhc2VzIHJ1bnRpbWUgUE0gaXMgZGlzYWJsZWQgYnkg
dGhlIFJQTSBjb3JlIGFuZCB3ZSBnZXQKKwkJICogYW4gLUVJTlZBTCByZXR1cm4gdmFsdWUgd2Ug
YXJlIG5vdCBzdXBwb3NlZCB0byBjYWxsIHRoaXMKKwkJICogZnVuY3Rpb24sIHNpbmNlIHRoZSBw
b3dlciBzdGF0ZSBpcyB1bmRlZmluZWQuIFRoaXMgYXBwbGllcworCQkgKiBhdG0gdG8gdGhlIGxh
dGUvZWFybHkgc3lzdGVtIHN1c3BlbmQvcmVzdW1lIGhhbmRsZXJzLgogCQkgKi8KLQkJaWYgKHBn
ID09IFNLTF9QRzEpCi0JCQlnZW45X3dhaXRfZm9yX3Bvd2VyX3dlbGxfZnVzZXMoZGV2X3ByaXYs
IFNLTF9QRzApOwotCX0KLQotCXZhbCA9IEk5MTVfUkVBRChyZWdzLT5kcml2ZXIpOwotCUk5MTVf
V1JJVEUocmVncy0+ZHJpdmVyLCB2YWwgfCBIU1dfUFdSX1dFTExfQ1RMX1JFUShwd19pZHgpKTsK
LQloc3dfd2FpdF9mb3JfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwot
Ci0JLyogRGlzcGxheSBXQSAjMTE3ODogY25sICovCi0JaWYgKElTX0NBTk5PTkxBS0UoZGV2X3By
aXYpICYmCi0JICAgIHB3X2lkeCA+PSBHTEtfUFdfQ1RMX0lEWF9BVVhfQiAmJgotCSAgICBwd19p
ZHggPD0gQ05MX1BXX0NUTF9JRFhfQVVYX0YpIHsKLQkJdmFsID0gSTkxNV9SRUFEKENOTF9BVVhf
QU5BT1ZSRDEocHdfaWR4KSk7Ci0JCXZhbCB8PSBDTkxfQVVYX0FOQU9WUkQxX0VOQUJMRSB8IENO
TF9BVVhfQU5BT1ZSRDFfTERPX0JZUEFTUzsKLQkJSTkxNV9XUklURShDTkxfQVVYX0FOQU9WUkQx
KHB3X2lkeCksIHZhbCk7Ci0JfQotCi0JaWYgKHdhaXRfZnVzZXMpCi0JCWdlbjlfd2FpdF9mb3Jf
cG93ZXJfd2VsbF9mdXNlcyhkZXZfcHJpdiwgcGcpOwotCi0JaHN3X3Bvd2VyX3dlbGxfcG9zdF9l
bmFibGUoZGV2X3ByaXYsCi0JCQkJICAgcG93ZXJfd2VsbC0+ZGVzYy0+aHN3LmlycV9waXBlX21h
c2ssCi0JCQkJICAgcG93ZXJfd2VsbC0+ZGVzYy0+aHN3Lmhhc192Z2EpOwotfQotCi1zdGF0aWMg
dm9pZCBoc3dfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKLQkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQotewotCWNv
bnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyAqcmVncyA9IHBvd2VyX3dlbGwtPmRlc2Mt
Pmhzdy5yZWdzOwotCWludCBwd19pZHggPSBwb3dlcl93ZWxsLT5kZXNjLT5oc3cuaWR4OwotCXUz
MiB2YWw7Ci0KLQloc3dfcG93ZXJfd2VsbF9wcmVfZGlzYWJsZShkZXZfcHJpdiwKLQkJCQkgICBw
b3dlcl93ZWxsLT5kZXNjLT5oc3cuaXJxX3BpcGVfbWFzayk7Ci0KLQl2YWwgPSBJOTE1X1JFQUQo
cmVncy0+ZHJpdmVyKTsKLQlJOTE1X1dSSVRFKHJlZ3MtPmRyaXZlciwgdmFsICYgfkhTV19QV1Jf
V0VMTF9DVExfUkVRKHB3X2lkeCkpOwotCWhzd193YWl0X2Zvcl9wb3dlcl93ZWxsX2Rpc2FibGUo
ZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwotfQotCi0jZGVmaW5lIElDTF9BVVhfUFdfVE9fUE9SVChw
d19pZHgpCSgocHdfaWR4KSAtIElDTF9QV19DVExfSURYX0FVWF9BKQotCi1zdGF0aWMgdm9pZAot
aWNsX2NvbWJvX3BoeV9hdXhfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAotCQkJCSAgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxs
KQotewotCWNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyAqcmVncyA9IHBvd2VyX3dl
bGwtPmRlc2MtPmhzdy5yZWdzOwotCWludCBwd19pZHggPSBwb3dlcl93ZWxsLT5kZXNjLT5oc3cu
aWR4OwotCWVudW0gcG9ydCBwb3J0ID0gSUNMX0FVWF9QV19UT19QT1JUKHB3X2lkeCk7Ci0JdTMy
IHZhbDsKLQotCXZhbCA9IEk5MTVfUkVBRChyZWdzLT5kcml2ZXIpOwotCUk5MTVfV1JJVEUocmVn
cy0+ZHJpdmVyLCB2YWwgfCBIU1dfUFdSX1dFTExfQ1RMX1JFUShwd19pZHgpKTsKLQotCXZhbCA9
IEk5MTVfUkVBRChJQ0xfUE9SVF9DTF9EVzEyKHBvcnQpKTsKLQlJOTE1X1dSSVRFKElDTF9QT1JU
X0NMX0RXMTIocG9ydCksIHZhbCB8IElDTF9MQU5FX0VOQUJMRV9BVVgpOwotCi0JaHN3X3dhaXRf
Zm9yX3Bvd2VyX3dlbGxfZW5hYmxlKGRldl9wcml2LCBwb3dlcl93ZWxsKTsKLQotCS8qIERpc3Bs
YXkgV0EgIzExNzg6IGljbCAqLwotCWlmIChJU19JQ0VMQUtFKGRldl9wcml2KSAmJgotCSAgICBw
d19pZHggPj0gSUNMX1BXX0NUTF9JRFhfQVVYX0EgJiYgcHdfaWR4IDw9IElDTF9QV19DVExfSURY
X0FVWF9CICYmCi0JICAgICFpbnRlbF9iaW9zX2lzX3BvcnRfZWRwKGRldl9wcml2LCBwb3J0KSkg
ewotCQl2YWwgPSBJOTE1X1JFQUQoSUNMX0FVWF9BTkFPVlJEMShwd19pZHgpKTsKLQkJdmFsIHw9
IElDTF9BVVhfQU5BT1ZSRDFfRU5BQkxFIHwgSUNMX0FVWF9BTkFPVlJEMV9MRE9fQllQQVNTOwot
CQlJOTE1X1dSSVRFKElDTF9BVVhfQU5BT1ZSRDEocHdfaWR4KSwgdmFsKTsKKwkJaWYgKHBtX3J1
bnRpbWVfZ2V0X2lmX2luX3VzZShrZGV2KSA8PSAwKQorCQkJcmV0dXJuIDA7CiAJfQotfQotCi1z
dGF0aWMgdm9pZAotaWNsX2NvbWJvX3BoeV9hdXhfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgICAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dl
bGwgKnBvd2VyX3dlbGwpCi17Ci0JY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzICpy
ZWdzID0gcG93ZXJfd2VsbC0+ZGVzYy0+aHN3LnJlZ3M7Ci0JaW50IHB3X2lkeCA9IHBvd2VyX3dl
bGwtPmRlc2MtPmhzdy5pZHg7Ci0JZW51bSBwb3J0IHBvcnQgPSBJQ0xfQVVYX1BXX1RPX1BPUlQo
cHdfaWR4KTsKLQl1MzIgdmFsOwotCi0JdmFsID0gSTkxNV9SRUFEKElDTF9QT1JUX0NMX0RXMTIo
cG9ydCkpOwotCUk5MTVfV1JJVEUoSUNMX1BPUlRfQ0xfRFcxMihwb3J0KSwgdmFsICYgfklDTF9M
QU5FX0VOQUJMRV9BVVgpOwotCi0JdmFsID0gSTkxNV9SRUFEKHJlZ3MtPmRyaXZlcik7Ci0JSTkx
NV9XUklURShyZWdzLT5kcml2ZXIsIHZhbCAmIH5IU1dfUFdSX1dFTExfQ1RMX1JFUShwd19pZHgp
KTsKLQotCWhzd193YWl0X2Zvcl9wb3dlcl93ZWxsX2Rpc2FibGUoZGV2X3ByaXYsIHBvd2VyX3dl
bGwpOwotfQotCi0jZGVmaW5lIElDTF9BVVhfUFdfVE9fQ0gocHdfaWR4KQlcCi0JKChwd19pZHgp
IC0gSUNMX1BXX0NUTF9JRFhfQVVYX0EgKyBBVVhfQ0hfQSkKLQotc3RhdGljIHZvaWQKLWljbF90
Y19waHlfYXV4X3Bvd2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiwKLQkJCQkgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKLXsKLQllbnVt
IGF1eF9jaCBhdXhfY2ggPSBJQ0xfQVVYX1BXX1RPX0NIKHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5p
ZHgpOwotCXUzMiB2YWw7Ci0KLQl2YWwgPSBJOTE1X1JFQUQoRFBfQVVYX0NIX0NUTChhdXhfY2gp
KTsKLQl2YWwgJj0gfkRQX0FVWF9DSF9DVExfVEJUX0lPOwotCWlmIChwb3dlcl93ZWxsLT5kZXNj
LT5oc3cuaXNfdGNfdGJ0KQotCQl2YWwgfD0gRFBfQVVYX0NIX0NUTF9UQlRfSU87Ci0JSTkxNV9X
UklURShEUF9BVVhfQ0hfQ1RMKGF1eF9jaCksIHZhbCk7Ci0KLQloc3dfcG93ZXJfd2VsbF9lbmFi
bGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwotfQotCi0vKgotICogV2Ugc2hvdWxkIG9ubHkgdXNl
IHRoZSBwb3dlciB3ZWxsIGlmIHdlIGV4cGxpY2l0bHkgYXNrZWQgdGhlIGhhcmR3YXJlIHRvCi0g
KiBlbmFibGUgaXQsIHNvIGNoZWNrIGlmIGl0J3MgZW5hYmxlZCBhbmQgYWxzbyBjaGVjayBpZiB3
ZSd2ZSByZXF1ZXN0ZWQgaXQgdG8KLSAqIGJlIGVuYWJsZWQuCi0gKi8KLXN0YXRpYyBib29sIGhz
d19wb3dlcl93ZWxsX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAot
CQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCi17Ci0JY29uc3Qgc3Ry
dWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzICpyZWdzID0gcG93ZXJfd2VsbC0+ZGVzYy0+aHN3LnJl
Z3M7Ci0JZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgaWQgPSBwb3dlcl93ZWxsLT5kZXNjLT5pZDsK
LQlpbnQgcHdfaWR4ID0gcG93ZXJfd2VsbC0+ZGVzYy0+aHN3LmlkeDsKLQl1MzIgbWFzayA9IEhT
V19QV1JfV0VMTF9DVExfUkVRKHB3X2lkeCkgfAotCQkgICBIU1dfUFdSX1dFTExfQ1RMX1NUQVRF
KHB3X2lkeCk7Ci0JdTMyIHZhbDsKLQotCXZhbCA9IEk5MTVfUkVBRChyZWdzLT5kcml2ZXIpOwot
Ci0JLyoKLQkgKiBPbiBHRU45IGJpZyBjb3JlIGR1ZSB0byBhIERNQyBidWcgdGhlIGRyaXZlcidz
IHJlcXVlc3QgYml0cyBmb3IgUFcxCi0JICogYW5kIHRoZSBNSVNDX0lPIFBXIHdpbGwgYmUgbm90
IHJlc3RvcmVkLCBzbyBjaGVjayBpbnN0ZWFkIGZvciB0aGUKLQkgKiBCSU9TJ3Mgb3duIHJlcXVl
c3QgYml0cywgd2hpY2ggYXJlIGZvcmNlZC1vbiBmb3IgdGhlc2UgcG93ZXIgd2VsbHMKLQkgKiB3
aGVuIGV4aXRpbmcgREM1LzYuCi0JICovCi0JaWYgKElTX0dFTihkZXZfcHJpdiwgOSkgJiYgIUlT
X0dFTjlfTFAoZGV2X3ByaXYpICYmCi0JICAgIChpZCA9PSBTS0xfRElTUF9QV18xIHx8IGlkID09
IFNLTF9ESVNQX1BXX01JU0NfSU8pKQotCQl2YWwgfD0gSTkxNV9SRUFEKHJlZ3MtPmJpb3MpOwot
Ci0JcmV0dXJuICh2YWwgJiBtYXNrKSA9PSBtYXNrOwotfQotCi1zdGF0aWMgdm9pZCBhc3NlcnRf
Y2FuX2VuYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCVdB
Uk5fT05DRSgoSTkxNV9SRUFEKERDX1NUQVRFX0VOKSAmIERDX1NUQVRFX0VOX0RDOSksCi0JCSAg
IkRDOSBhbHJlYWR5IHByb2dyYW1tZWQgdG8gYmUgZW5hYmxlZC5cbiIpOwotCVdBUk5fT05DRShJ
OTE1X1JFQUQoRENfU1RBVEVfRU4pICYgRENfU1RBVEVfRU5fVVBUT19EQzUsCi0JCSAgIkRDNSBz
dGlsbCBub3QgZGlzYWJsZWQgdG8gZW5hYmxlIERDOS5cbiIpOwotCVdBUk5fT05DRShJOTE1X1JF
QUQoSFNXX1BXUl9XRUxMX0NUTDIpICYKLQkJICBIU1dfUFdSX1dFTExfQ1RMX1JFUShTS0xfUFdf
Q1RMX0lEWF9QV18yKSwKLQkJICAiUG93ZXIgd2VsbCAyIG9uLlxuIik7Ci0JV0FSTl9PTkNFKGlu
dGVsX2lycXNfZW5hYmxlZChkZXZfcHJpdiksCi0JCSAgIkludGVycnVwdHMgbm90IGRpc2FibGVk
IHlldC5cbiIpOwotCi0JIC8qCi0JICAqIFRPRE86IGNoZWNrIGZvciB0aGUgZm9sbG93aW5nIHRv
IHZlcmlmeSB0aGUgY29uZGl0aW9ucyB0byBlbnRlciBEQzkKLQkgICogc3RhdGUgYXJlIHNhdGlz
ZmllZDoKLQkgICogMV0gQ2hlY2sgcmVsZXZhbnQgZGlzcGxheSBlbmdpbmUgcmVnaXN0ZXJzIHRv
IHZlcmlmeSBpZiBtb2RlIHNldAotCSAgKiBkaXNhYmxlIHNlcXVlbmNlIHdhcyBmb2xsb3dlZC4K
LQkgICogMl0gQ2hlY2sgaWYgZGlzcGxheSB1bmluaXRpYWxpemUgc2VxdWVuY2UgaXMgaW5pdGlh
bGl6ZWQuCi0JICAqLwotfQotCi1zdGF0aWMgdm9pZCBhc3NlcnRfY2FuX2Rpc2FibGVfZGM5KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlXQVJOX09OQ0UoaW50ZWxfaXJx
c19lbmFibGVkKGRldl9wcml2KSwKLQkJICAiSW50ZXJydXB0cyBub3QgZGlzYWJsZWQgeWV0Llxu
Iik7Ci0JV0FSTl9PTkNFKEk5MTVfUkVBRChEQ19TVEFURV9FTikgJiBEQ19TVEFURV9FTl9VUFRP
X0RDNSwKLQkJICAiREM1IHN0aWxsIG5vdCBkaXNhYmxlZC5cbiIpOwotCi0JIC8qCi0JICAqIFRP
RE86IGNoZWNrIGZvciB0aGUgZm9sbG93aW5nIHRvIHZlcmlmeSBEQzkgc3RhdGUgd2FzIGluZGVl
ZAotCSAgKiBlbnRlcmVkIGJlZm9yZSBwcm9ncmFtbWluZyB0byBkaXNhYmxlIGl0OgotCSAgKiAx
XSBDaGVjayByZWxldmFudCBkaXNwbGF5IGVuZ2luZSByZWdpc3RlcnMgdG8gdmVyaWZ5IGlmIG1v
ZGUKLQkgICogIHNldCBkaXNhYmxlIHNlcXVlbmNlIHdhcyBmb2xsb3dlZC4KLQkgICogMl0gQ2hl
Y2sgaWYgZGlzcGxheSB1bmluaXRpYWxpemUgc2VxdWVuY2UgaXMgaW5pdGlhbGl6ZWQuCi0JICAq
LwotfQotCi1zdGF0aWMgdm9pZCBnZW45X3dyaXRlX2RjX3N0YXRlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdiwKLQkJCQl1MzIgc3RhdGUpCi17Ci0JaW50IHJld3JpdGVzID0gMDsK
LQlpbnQgcmVyZWFkcyA9IDA7Ci0JdTMyIHY7Ci0KLQlJOTE1X1dSSVRFKERDX1NUQVRFX0VOLCBz
dGF0ZSk7Ci0KLQkvKiBJdCBoYXMgYmVlbiBvYnNlcnZlZCB0aGF0IGRpc2FibGluZyB0aGUgZGM2
IHN0YXRlIHNvbWV0aW1lcwotCSAqIGRvZXNuJ3Qgc3RpY2sgYW5kIGRtYyBrZWVwcyByZXR1cm5p
bmcgb2xkIHZhbHVlLiBNYWtlIHN1cmUKLQkgKiB0aGUgd3JpdGUgcmVhbGx5IHN0aWNrcyBlbm91
Z2ggdGltZXMgYW5kIGFsc28gZm9yY2UgcmV3cml0ZSB1bnRpbAotCSAqIHdlIGFyZSBjb25maWRl
bnQgdGhhdCBzdGF0ZSBpcyBleGFjdGx5IHdoYXQgd2Ugd2FudC4KLQkgKi8KLQlkbyAgewotCQl2
ID0gSTkxNV9SRUFEKERDX1NUQVRFX0VOKTsKLQotCQlpZiAodiAhPSBzdGF0ZSkgewotCQkJSTkx
NV9XUklURShEQ19TVEFURV9FTiwgc3RhdGUpOwotCQkJcmV3cml0ZXMrKzsKLQkJCXJlcmVhZHMg
PSAwOwotCQl9IGVsc2UgaWYgKHJlcmVhZHMrKyA+IDUpIHsKLQkJCWJyZWFrOwotCQl9Ci0KLQl9
IHdoaWxlIChyZXdyaXRlcyA8IDEwMCk7CiAKLQlpZiAodiAhPSBzdGF0ZSkKLQkJRFJNX0VSUk9S
KCJXcml0aW5nIGRjIHN0YXRlIHRvIDB4JXggZmFpbGVkLCBub3cgMHgleFxuIiwKLQkJCSAgc3Rh
dGUsIHYpOwotCi0JLyogTW9zdCBvZiB0aGUgdGltZXMgd2UgbmVlZCBvbmUgcmV0cnksIGF2b2lk
IHNwYW0gKi8KLQlpZiAocmV3cml0ZXMgPiAxKQotCQlEUk1fREVCVUdfS01TKCJSZXdyb3RlIGRj
IHN0YXRlIHRvIDB4JXggJWQgdGltZXNcbiIsCi0JCQkgICAgICBzdGF0ZSwgcmV3cml0ZXMpOwot
fQotCi1zdGF0aWMgdTMyIGdlbjlfZGNfbWFzayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpCi17Ci0JdTMyIG1hc2s7Ci0KLQltYXNrID0gRENfU1RBVEVfRU5fVVBUT19EQzU7Ci0J
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCi0JCW1hc2sgfD0gRENfU1RBVEVfRU5fVVBU
T19EQzYgfCBEQ19TVEFURV9FTl9EQzk7Ci0JZWxzZSBpZiAoSVNfR0VOOV9MUChkZXZfcHJpdikp
Ci0JCW1hc2sgfD0gRENfU1RBVEVfRU5fREM5OwotCWVsc2UKLQkJbWFzayB8PSBEQ19TVEFURV9F
Tl9VUFRPX0RDNjsKLQotCXJldHVybiBtYXNrOwotfQotCi12b2lkIGdlbjlfc2FuaXRpemVfZGNf
c3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXUzMiB2YWw7Ci0K
LQl2YWwgPSBJOTE1X1JFQUQoRENfU1RBVEVfRU4pICYgZ2VuOV9kY19tYXNrKGRldl9wcml2KTsK
KwlpbnRlbF9ydW50aW1lX3BtX2FjcXVpcmUoaTkxNSwgdHJ1ZSk7CiAKLQlEUk1fREVCVUdfS01T
KCJSZXNldHRpbmcgREMgc3RhdGUgdHJhY2tpbmcgZnJvbSAlMDJ4IHRvICUwMnhcbiIsCi0JCSAg
ICAgIGRldl9wcml2LT5jc3IuZGNfc3RhdGUsIHZhbCk7Ci0JZGV2X3ByaXYtPmNzci5kY19zdGF0
ZSA9IHZhbDsKKwlyZXR1cm4gdHJhY2tfaW50ZWxfcnVudGltZV9wbV93YWtlcmVmKGk5MTUpOwog
fQogCiAvKioKLSAqIGdlbjlfc2V0X2RjX3N0YXRlIC0gc2V0IHRhcmdldCBkaXNwbGF5IEMgcG93
ZXIgc3RhdGUKLSAqIEBkZXZfcHJpdjogaTkxNSBkZXZpY2UgaW5zdGFuY2UKLSAqIEBzdGF0ZTog
dGFyZ2V0IERDIHBvd2VyIHN0YXRlCi0gKiAtIERDX1NUQVRFX0RJU0FCTEUKLSAqIC0gRENfU1RB
VEVfRU5fVVBUT19EQzUKLSAqIC0gRENfU1RBVEVfRU5fVVBUT19EQzYKLSAqIC0gRENfU1RBVEVf
RU5fREM5CisgKiBpbnRlbF9ydW50aW1lX3BtX2dldF9ub3Jlc3VtZSAtIGdyYWIgYSBydW50aW1l
IHBtIHJlZmVyZW5jZQorICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCisgKgorICogVGhp
cyBmdW5jdGlvbiBncmFicyBhIGRldmljZS1sZXZlbCBydW50aW1lIHBtIHJlZmVyZW5jZSAobW9z
dGx5IHVzZWQgZm9yIEdFTQorICogY29kZSB0byBlbnN1cmUgdGhlIEdUVCBvciBHVCBpcyBvbiku
CisgKgorICogSXQgd2lsbCBfbm90XyBwb3dlciB1cCB0aGUgZGV2aWNlIGJ1dCBpbnN0ZWFkIG9u
bHkgY2hlY2sgdGhhdCBpdCdzIHBvd2VyZWQKKyAqIG9uLiAgVGhlcmVmb3JlIGl0IGlzIG9ubHkg
dmFsaWQgdG8gY2FsbCB0aGlzIGZ1bmN0aW9ucyBmcm9tIGNvbnRleHRzIHdoZXJlCisgKiB0aGUg
ZGV2aWNlIGlzIGtub3duIHRvIGJlIHBvd2VyZWQgdXAgYW5kIHdoZXJlIHRyeWluZyB0byBwb3dl
ciBpdCB1cCB3b3VsZAorICogcmVzdWx0IGluIGhpbGFyaXR5IGFuZCBkZWFkbG9ja3MuIFRoYXQg
cHJldHR5IG11Y2ggbWVhbnMgb25seSB0aGUgc3lzdGVtCisgKiBzdXNwZW5kL3Jlc3VtZSBjb2Rl
IHdoZXJlIHRoaXMgaXMgdXNlZCB0byBncmFiIHJ1bnRpbWUgcG0gcmVmZXJlbmNlcyBmb3IKKyAq
IGRlbGF5ZWQgc2V0dXAgZG93biBpbiB3b3JrIGl0ZW1zLgogICoKLSAqIFNpZ25hbCB0byBETUMg
ZmlybXdhcmUvSFcgdGhlIHRhcmdldCBEQyBwb3dlciBzdGF0ZSBwYXNzZWQgaW4gQHN0YXRlLgot
ICogRE1DL0hXIGNhbiB0dXJuIG9mZiBpbmRpdmlkdWFsIGRpc3BsYXkgY2xvY2tzIGFuZCBwb3dl
ciByYWlscyB3aGVuIGVudGVyaW5nCi0gKiBhIGRlZXBlciBEQyBwb3dlciBzdGF0ZSAoaGlnaGVy
IGluIG51bWJlcikgYW5kIHR1cm5zIHRoZXNlIGJhY2sgd2hlbiBleGl0aW5nCi0gKiB0aGF0IHN0
YXRlIHRvIGEgc2hhbGxvd2VyIHBvd2VyIHN0YXRlIChsb3dlciBpbiBudW1iZXIpLiBUaGUgSFcg
d2lsbCBkZWNpZGUKLSAqIHdoZW4gdG8gYWN0dWFsbHkgZW50ZXIgYSBnaXZlbiBzdGF0ZSBvbiBh
biBvbi1kZW1hbmQgYmFzaXMsIGZvciBpbnN0YW5jZQotICogZGVwZW5kaW5nIG9uIHRoZSBhY3Rp
dmUgc3RhdGUgb2YgZGlzcGxheSBwaXBlcy4gVGhlIHN0YXRlIG9mIGRpc3BsYXkKLSAqIHJlZ2lz
dGVycyBiYWNrZWQgYnkgYWZmZWN0ZWQgcG93ZXIgcmFpbHMgYXJlIHNhdmVkL3Jlc3RvcmVkIGFz
IG5lZWRlZC4KKyAqIEFueSBydW50aW1lIHBtIHJlZmVyZW5jZSBvYnRhaW5lZCBieSB0aGlzIGZ1
bmN0aW9uIG11c3QgaGF2ZSBhIHN5bW1ldHJpYworICogY2FsbCB0byBpbnRlbF9ydW50aW1lX3Bt
X3B1dCgpIHRvIHJlbGVhc2UgdGhlIHJlZmVyZW5jZSBhZ2Fpbi4KICAqCi0gKiBCYXNlZCBvbiB0
aGUgYWJvdmUgZW5hYmxpbmcgYSBkZWVwZXIgREMgcG93ZXIgc3RhdGUgaXMgYXN5bmNocm9ub3Vz
IHdydC4KLSAqIGVuYWJsaW5nIGl0LiBEaXNhYmxpbmcgYSBkZWVwZXIgcG93ZXIgc3RhdGUgaXMg
c3luY2hyb25vdXM6IGZvciBpbnN0YW5jZQotICogc2V0dGluZyAlRENfU1RBVEVfRElTQUJMRSB3
b24ndCBjb21wbGV0ZSB1bnRpbCBhbGwgSFcgcmVzb3VyY2VzIGFyZSB0dXJuZWQKLSAqIGJhY2sg
b24gYW5kIHJlZ2lzdGVyIHN0YXRlIGlzIHJlc3RvcmVkLiBUaGlzIGlzIGd1YXJhbnRlZWQgYnkg
dGhlIE1NSU8gd3JpdGUKLSAqIHRvIERDX1NUQVRFX0VOIGJsb2NraW5nIHVudGlsIHRoZSBzdGF0
ZSBpcyByZXN0b3JlZC4KKyAqIFJldHVybnM6IHRoZSB3YWtlcmVmIGNvb2tpZSB0byBwYXNzIHRv
IGludGVsX3J1bnRpbWVfcG1fcHV0KCkKICAqLwotc3RhdGljIHZvaWQgZ2VuOV9zZXRfZGNfc3Rh
dGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgc3RhdGUpCi17Ci0JdTMy
IHZhbDsKLQl1MzIgbWFzazsKLQotCWlmIChXQVJOX09OX09OQ0Uoc3RhdGUgJiB+ZGV2X3ByaXYt
PmNzci5hbGxvd2VkX2RjX21hc2spKQotCQlzdGF0ZSAmPSBkZXZfcHJpdi0+Y3NyLmFsbG93ZWRf
ZGNfbWFzazsKLQotCXZhbCA9IEk5MTVfUkVBRChEQ19TVEFURV9FTik7Ci0JbWFzayA9IGdlbjlf
ZGNfbWFzayhkZXZfcHJpdik7Ci0JRFJNX0RFQlVHX0tNUygiU2V0dGluZyBEQyBzdGF0ZSBmcm9t
ICUwMnggdG8gJTAyeFxuIiwKLQkJICAgICAgdmFsICYgbWFzaywgc3RhdGUpOwotCi0JLyogQ2hl
Y2sgaWYgRE1DIGlzIGlnbm9yaW5nIG91ciBEQyBzdGF0ZSByZXF1ZXN0cyAqLwotCWlmICgodmFs
ICYgbWFzaykgIT0gZGV2X3ByaXYtPmNzci5kY19zdGF0ZSkKLQkJRFJNX0VSUk9SKCJEQyBzdGF0
ZSBtaXNtYXRjaCAoMHgleCAtPiAweCV4KVxuIiwKLQkJCSAgZGV2X3ByaXYtPmNzci5kY19zdGF0
ZSwgdmFsICYgbWFzayk7Ci0KLQl2YWwgJj0gfm1hc2s7Ci0JdmFsIHw9IHN0YXRlOwotCi0JZ2Vu
OV93cml0ZV9kY19zdGF0ZShkZXZfcHJpdiwgdmFsKTsKLQotCWRldl9wcml2LT5jc3IuZGNfc3Rh
dGUgPSB2YWwgJiBtYXNrOwotfQotCi12b2lkIGJ4dF9lbmFibGVfZGM5KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlhc3NlcnRfY2FuX2VuYWJsZV9kYzkoZGV2X3ByaXYp
OwotCi0JRFJNX0RFQlVHX0tNUygiRW5hYmxpbmcgREM5XG4iKTsKLQkvKgotCSAqIFBvd2VyIHNl
cXVlbmNlciByZXNldCBpcyBub3QgbmVlZGVkIG9uCi0JICogcGxhdGZvcm1zIHdpdGggU291dGgg
RGlzcGxheSBFbmdpbmUgb24gUENILAotCSAqIGJlY2F1c2UgUFBTIHJlZ2lzdGVycyBhcmUgYWx3
YXlzIG9uLgotCSAqLwotCWlmICghSEFTX1BDSF9TUExJVChkZXZfcHJpdikpCi0JCWludGVsX3Bv
d2VyX3NlcXVlbmNlcl9yZXNldChkZXZfcHJpdik7Ci0JZ2VuOV9zZXRfZGNfc3RhdGUoZGV2X3By
aXYsIERDX1NUQVRFX0VOX0RDOSk7Ci19Ci0KLXZvaWQgYnh0X2Rpc2FibGVfZGM5KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKK2ludGVsX3dha2VyZWZfdCBpbnRlbF9ydW50aW1l
X3BtX2dldF9ub3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKLQlhc3Nl
cnRfY2FuX2Rpc2FibGVfZGM5KGRldl9wcml2KTsKKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5
MTUtPmRybS5wZGV2OworCXN0cnVjdCBkZXZpY2UgKmtkZXYgPSAmcGRldi0+ZGV2OwogCi0JRFJN
X0RFQlVHX0tNUygiRGlzYWJsaW5nIERDOVxuIik7CisJYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxk
KGk5MTUpOworCXBtX3J1bnRpbWVfZ2V0X25vcmVzdW1lKGtkZXYpOwogCi0JZ2VuOV9zZXRfZGNf
c3RhdGUoZGV2X3ByaXYsIERDX1NUQVRFX0RJU0FCTEUpOworCWludGVsX3J1bnRpbWVfcG1fYWNx
dWlyZShpOTE1LCB0cnVlKTsKIAotCWludGVsX3Bwc191bmxvY2tfcmVnc193YShkZXZfcHJpdik7
CisJcmV0dXJuIHRyYWNrX2ludGVsX3J1bnRpbWVfcG1fd2FrZXJlZihpOTE1KTsKIH0KIAotc3Rh
dGljIHZvaWQgYXNzZXJ0X2Nzcl9sb2FkZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQorc3RhdGljIHZvaWQgX19pbnRlbF9ydW50aW1lX3BtX3B1dChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKKwkJCQkgICBpbnRlbF93YWtlcmVmX3Qgd3JlZiwKKwkJCQkgICBib29s
IHdha2Vsb2NrKQogewotCVdBUk5fT05DRSghSTkxNV9SRUFEKENTUl9QUk9HUkFNKDApKSwKLQkJ
ICAiQ1NSIHByb2dyYW0gc3RvcmFnZSBzdGFydCBpcyBOVUxMXG4iKTsKLQlXQVJOX09OQ0UoIUk5
MTVfUkVBRChDU1JfU1NQX0JBU0UpLCAiQ1NSIFNTUCBCYXNlIE5vdCBmaW5lXG4iKTsKLQlXQVJO
X09OQ0UoIUk5MTVfUkVBRChDU1JfSFRQX1NLTCksICJDU1IgSFRQIE5vdCBmaW5lXG4iKTsKLX0K
KwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2OworCXN0cnVjdCBkZXZpY2Ug
KmtkZXYgPSAmcGRldi0+ZGV2OwogCi1zdGF0aWMgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqCi1s
b29rdXBfcG93ZXJfd2VsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCSAg
ZW51bSBpOTE1X3Bvd2VyX3dlbGxfaWQgcG93ZXJfd2VsbF9pZCkKLXsKLQlzdHJ1Y3QgaTkxNV9w
b3dlcl93ZWxsICpwb3dlcl93ZWxsOworCXVudHJhY2tfaW50ZWxfcnVudGltZV9wbV93YWtlcmVm
KGk5MTUsIHdyZWYpOwogCi0JZm9yX2VhY2hfcG93ZXJfd2VsbChkZXZfcHJpdiwgcG93ZXJfd2Vs
bCkKLQkJaWYgKHBvd2VyX3dlbGwtPmRlc2MtPmlkID09IHBvd2VyX3dlbGxfaWQpCi0JCQlyZXR1
cm4gcG93ZXJfd2VsbDsKKwlpbnRlbF9ydW50aW1lX3BtX3JlbGVhc2UoaTkxNSwgd2FrZWxvY2sp
OwogCi0JLyoKLQkgKiBJdCdzIG5vdCBmZWFzaWJsZSB0byBhZGQgZXJyb3IgY2hlY2tpbmcgY29k
ZSB0byB0aGUgY2FsbGVycyBzaW5jZQotCSAqIHRoaXMgY29uZGl0aW9uIHJlYWxseSBzaG91bGRu
J3QgaGFwcGVuIGFuZCBpdCBkb2Vzbid0IGV2ZW4gbWFrZSBzZW5zZQotCSAqIHRvIGFib3J0IHRo
aW5ncyBsaWtlIGRpc3BsYXkgaW5pdGlhbGl6YXRpb24gc2VxdWVuY2VzLiBKdXN0IHJldHVybgot
CSAqIHRoZSBmaXJzdCBwb3dlciB3ZWxsIGFuZCBob3BlIHRoZSBXQVJOIGdldHMgcmVwb3J0ZWQg
c28gd2UgY2FuIGZpeAotCSAqIG91ciBkcml2ZXIuCi0JICovCi0JV0FSTigxLCAiUG93ZXIgd2Vs
bCAlZCBub3QgZGVmaW5lZCBmb3IgdGhpcyBwbGF0Zm9ybVxuIiwgcG93ZXJfd2VsbF9pZCk7Ci0J
cmV0dXJuICZkZXZfcHJpdi0+cG93ZXJfZG9tYWlucy5wb3dlcl93ZWxsc1swXTsKKwlwbV9ydW50
aW1lX21hcmtfbGFzdF9idXN5KGtkZXYpOworCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKGtk
ZXYpOwogfQogCi1zdGF0aWMgdm9pZCBhc3NlcnRfY2FuX2VuYWJsZV9kYzUoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQorLyoqCisgKiBpbnRlbF9ydW50aW1lX3BtX3B1dF9yYXcg
LSByZWxlYXNlIGEgcmF3IHJ1bnRpbWUgcG0gcmVmZXJlbmNlCisgKiBAaTkxNTogaTkxNSBkZXZp
Y2UgaW5zdGFuY2UKKyAqIEB3cmVmOiB3YWtlcmVmIGFjcXVpcmVkIGZvciB0aGUgcmVmZXJlbmNl
IHRoYXQgaXMgYmVpbmcgcmVsZWFzZWQKKyAqCisgKiBUaGlzIGZ1bmN0aW9uIGRyb3BzIHRoZSBk
ZXZpY2UtbGV2ZWwgcnVudGltZSBwbSByZWZlcmVuY2Ugb2J0YWluZWQgYnkKKyAqIGludGVsX3J1
bnRpbWVfcG1fZ2V0X3JhdygpIGFuZCBtaWdodCBwb3dlciBkb3duIHRoZSBjb3JyZXNwb25kaW5n
CisgKiBoYXJkd2FyZSBibG9jayByaWdodCBhd2F5IGlmIHRoaXMgaXMgdGhlIGxhc3QgcmVmZXJl
bmNlLgorICovCit2b2lkCitpbnRlbF9ydW50aW1lX3BtX3B1dF9yYXcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUsIGludGVsX3dha2VyZWZfdCB3cmVmKQogewotCWJvb2wgcGcyX2VuYWJs
ZWQgPSBpbnRlbF9kaXNwbGF5X3Bvd2VyX3dlbGxfaXNfZW5hYmxlZChkZXZfcHJpdiwKLQkJCQkJ
U0tMX0RJU1BfUFdfMik7Ci0KLQlXQVJOX09OQ0UocGcyX2VuYWJsZWQsICJQRzIgbm90IGRpc2Fi
bGVkIHRvIGVuYWJsZSBEQzUuXG4iKTsKLQotCVdBUk5fT05DRSgoSTkxNV9SRUFEKERDX1NUQVRF
X0VOKSAmIERDX1NUQVRFX0VOX1VQVE9fREM1KSwKLQkJICAiREM1IGFscmVhZHkgcHJvZ3JhbW1l
ZCB0byBiZSBlbmFibGVkLlxuIik7Ci0JYXNzZXJ0X3JwbV93YWtlbG9ja19oZWxkKGRldl9wcml2
KTsKLQotCWFzc2VydF9jc3JfbG9hZGVkKGRldl9wcml2KTsKKwlfX2ludGVsX3J1bnRpbWVfcG1f
cHV0KGk5MTUsIHdyZWYsIGZhbHNlKTsKIH0KIAotdm9pZCBnZW45X2VuYWJsZV9kYzUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCWFzc2VydF9jYW5fZW5hYmxlX2RjNShk
ZXZfcHJpdik7Ci0KLQlEUk1fREVCVUdfS01TKCJFbmFibGluZyBEQzVcbiIpOwotCi0JLyogV2Eg
RGlzcGxheSAjMTE4Mzogc2tsLGtibCxjZmwgKi8KLQlpZiAoSVNfR0VOOV9CQyhkZXZfcHJpdikp
Ci0JCUk5MTVfV1JJVEUoR0VOOF9DSElDS0VOX0RDUFJfMSwgSTkxNV9SRUFEKEdFTjhfQ0hJQ0tF
Tl9EQ1BSXzEpIHwKLQkJCSAgIFNLTF9TRUxFQ1RfQUxURVJOQVRFX0RDX0VYSVQpOwotCi0JZ2Vu
OV9zZXRfZGNfc3RhdGUoZGV2X3ByaXYsIERDX1NUQVRFX0VOX1VQVE9fREM1KTsKLX0KLQotc3Rh
dGljIHZvaWQgYXNzZXJ0X2Nhbl9lbmFibGVfZGM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdikKLXsKLQlXQVJOX09OQ0UoSTkxNV9SRUFEKFVUSUxfUElOX0NUTCkgJiBVVElMX1BJ
Tl9FTkFCTEUsCi0JCSAgIkJhY2tsaWdodCBpcyBub3QgZGlzYWJsZWQuXG4iKTsKLQlXQVJOX09O
Q0UoKEk5MTVfUkVBRChEQ19TVEFURV9FTikgJiBEQ19TVEFURV9FTl9VUFRPX0RDNiksCi0JCSAg
IkRDNiBhbHJlYWR5IHByb2dyYW1tZWQgdG8gYmUgZW5hYmxlZC5cbiIpOwotCi0JYXNzZXJ0X2Nz
cl9sb2FkZWQoZGV2X3ByaXYpOwotfQotCi12b2lkIHNrbF9lbmFibGVfZGM2KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlhc3NlcnRfY2FuX2VuYWJsZV9kYzYoZGV2X3By
aXYpOwotCi0JRFJNX0RFQlVHX0tNUygiRW5hYmxpbmcgREM2XG4iKTsKLQotCS8qIFdhIERpc3Bs
YXkgIzExODM6IHNrbCxrYmwsY2ZsICovCi0JaWYgKElTX0dFTjlfQkMoZGV2X3ByaXYpKQotCQlJ
OTE1X1dSSVRFKEdFTjhfQ0hJQ0tFTl9EQ1BSXzEsIEk5MTVfUkVBRChHRU44X0NISUNLRU5fRENQ
Ul8xKSB8Ci0JCQkgICBTS0xfU0VMRUNUX0FMVEVSTkFURV9EQ19FWElUKTsKLQotCWdlbjlfc2V0
X2RjX3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9FTl9VUFRPX0RDNik7Ci19Ci0KLXN0YXRpYyB2
b2lkIGhzd19wb3dlcl93ZWxsX3N5bmNfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAotCQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCi17Ci0JY29u
c3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzICpyZWdzID0gcG93ZXJfd2VsbC0+ZGVzYy0+
aHN3LnJlZ3M7Ci0JaW50IHB3X2lkeCA9IHBvd2VyX3dlbGwtPmRlc2MtPmhzdy5pZHg7Ci0JdTMy
IG1hc2sgPSBIU1dfUFdSX1dFTExfQ1RMX1JFUShwd19pZHgpOwotCXUzMiBiaW9zX3JlcSA9IEk5
MTVfUkVBRChyZWdzLT5iaW9zKTsKLQotCS8qIFRha2Ugb3ZlciB0aGUgcmVxdWVzdCBiaXQgaWYg
c2V0IGJ5IEJJT1MuICovCi0JaWYgKGJpb3NfcmVxICYgbWFzaykgewotCQl1MzIgZHJ2X3JlcSA9
IEk5MTVfUkVBRChyZWdzLT5kcml2ZXIpOwotCi0JCWlmICghKGRydl9yZXEgJiBtYXNrKSkKLQkJ
CUk5MTVfV1JJVEUocmVncy0+ZHJpdmVyLCBkcnZfcmVxIHwgbWFzayk7Ci0JCUk5MTVfV1JJVEUo
cmVncy0+YmlvcywgYmlvc19yZXEgJiB+bWFzayk7Ci0JfQotfQotCi1zdGF0aWMgdm9pZCBieHRf
ZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAotCQkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQotewotCWJ4
dF9kZGlfcGh5X2luaXQoZGV2X3ByaXYsIHBvd2VyX3dlbGwtPmRlc2MtPmJ4dC5waHkpOwotfQot
Ci1zdGF0aWMgdm9pZCBieHRfZHBpb19jbW5fcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkJICAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwg
KnBvd2VyX3dlbGwpCi17Ci0JYnh0X2RkaV9waHlfdW5pbml0KGRldl9wcml2LCBwb3dlcl93ZWxs
LT5kZXNjLT5ieHQucGh5KTsKLX0KLQotc3RhdGljIGJvb2wgYnh0X2RwaW9fY21uX3Bvd2VyX3dl
bGxfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJCSAgICBz
dHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQotewotCXJldHVybiBieHRfZGRpX3Bo
eV9pc19lbmFibGVkKGRldl9wcml2LCBwb3dlcl93ZWxsLT5kZXNjLT5ieHQucGh5KTsKLX0KLQot
c3RhdGljIHZvaWQgYnh0X3ZlcmlmeV9kZGlfcGh5X3Bvd2VyX3dlbGxzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93
ZWxsOwotCi0JcG93ZXJfd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBCWFRfRElT
UF9QV19EUElPX0NNTl9BKTsKLQlpZiAocG93ZXJfd2VsbC0+Y291bnQgPiAwKQotCQlieHRfZGRp
X3BoeV92ZXJpZnlfc3RhdGUoZGV2X3ByaXYsIHBvd2VyX3dlbGwtPmRlc2MtPmJ4dC5waHkpOwot
Ci0JcG93ZXJfd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBWTFZfRElTUF9QV19E
UElPX0NNTl9CQyk7Ci0JaWYgKHBvd2VyX3dlbGwtPmNvdW50ID4gMCkKLQkJYnh0X2RkaV9waHlf
dmVyaWZ5X3N0YXRlKGRldl9wcml2LCBwb3dlcl93ZWxsLT5kZXNjLT5ieHQucGh5KTsKLQotCWlm
IChJU19HRU1JTklMQUtFKGRldl9wcml2KSkgewotCQlwb3dlcl93ZWxsID0gbG9va3VwX3Bvd2Vy
X3dlbGwoZGV2X3ByaXYsCi0JCQkJCSAgICAgICBHTEtfRElTUF9QV19EUElPX0NNTl9DKTsKLQkJ
aWYgKHBvd2VyX3dlbGwtPmNvdW50ID4gMCkKLQkJCWJ4dF9kZGlfcGh5X3ZlcmlmeV9zdGF0ZShk
ZXZfcHJpdiwKLQkJCQkJCSBwb3dlcl93ZWxsLT5kZXNjLT5ieHQucGh5KTsKLQl9Ci19Ci0KLXN0
YXRpYyBib29sIGdlbjlfZGNfb2ZmX3Bvd2VyX3dlbGxfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJCSAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2Vy
X3dlbGwpCi17Ci0JcmV0dXJuIChJOTE1X1JFQUQoRENfU1RBVEVfRU4pICYgRENfU1RBVEVfRU5f
VVBUT19EQzVfREM2X01BU0spID09IDA7Ci19Ci0KLXN0YXRpYyB2b2lkIGdlbjlfYXNzZXJ0X2Ri
dWZfZW5hYmxlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTMyIHRt
cCA9IEk5MTVfUkVBRChEQlVGX0NUTCk7Ci0KLQlXQVJOKCh0bXAgJiAoREJVRl9QT1dFUl9TVEFU
RSB8IERCVUZfUE9XRVJfUkVRVUVTVCkpICE9Ci0JICAgICAoREJVRl9QT1dFUl9TVEFURSB8IERC
VUZfUE9XRVJfUkVRVUVTVCksCi0JICAgICAiVW5leHBlY3RlZCBEQnVmIHBvd2VyIHBvd2VyIHN0
YXRlICgweCUwOHgpXG4iLCB0bXApOwotfQotCi1zdGF0aWMgdm9pZCBnZW45X2RjX29mZl9wb3dl
cl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJCSAg
c3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKLXsKLQlzdHJ1Y3QgaW50ZWxfY2Rj
bGtfc3RhdGUgY2RjbGtfc3RhdGUgPSB7fTsKLQotCWdlbjlfc2V0X2RjX3N0YXRlKGRldl9wcml2
LCBEQ19TVEFURV9ESVNBQkxFKTsKLQotCWRldl9wcml2LT5kaXNwbGF5LmdldF9jZGNsayhkZXZf
cHJpdiwgJmNkY2xrX3N0YXRlKTsKLQkvKiBDYW4ndCByZWFkIG91dCB2b2x0YWdlX2xldmVsIHNv
IGNhbid0IHVzZSBpbnRlbF9jZGNsa19jaGFuZ2VkKCkgKi8KLQlXQVJOX09OKGludGVsX2NkY2xr
X25lZWRzX21vZGVzZXQoJmRldl9wcml2LT5jZGNsay5odywgJmNkY2xrX3N0YXRlKSk7Ci0KLQln
ZW45X2Fzc2VydF9kYnVmX2VuYWJsZWQoZGV2X3ByaXYpOwotCi0JaWYgKElTX0dFTjlfTFAoZGV2
X3ByaXYpKQotCQlieHRfdmVyaWZ5X2RkaV9waHlfcG93ZXJfd2VsbHMoZGV2X3ByaXYpOwotCi0J
aWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpCi0JCS8qCi0JCSAqIERNQyByZXRhaW5zIEhX
IGNvbnRleHQgb25seSBmb3IgcG9ydCBBLCB0aGUgb3RoZXIgY29tYm8KLQkJICogUEhZJ3MgSFcg
Y29udGV4dCBmb3IgcG9ydCBCIGlzIGxvc3QgYWZ0ZXIgREMgdHJhbnNpdGlvbnMsCi0JCSAqIHNv
IHdlIG5lZWQgdG8gcmVzdG9yZSBpdCBtYW51YWxseS4KLQkJICovCi0JCWludGVsX2NvbWJvX3Bo
eV9pbml0KGRldl9wcml2KTsKLX0KLQotc3RhdGljIHZvaWQgZ2VuOV9kY19vZmZfcG93ZXJfd2Vs
bF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkJICAgc3Ry
dWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKLXsKLQlpZiAoIWRldl9wcml2LT5jc3Iu
ZG1jX3BheWxvYWQpCi0JCXJldHVybjsKLQotCWlmIChkZXZfcHJpdi0+Y3NyLmFsbG93ZWRfZGNf
bWFzayAmIERDX1NUQVRFX0VOX1VQVE9fREM2KQotCQlza2xfZW5hYmxlX2RjNihkZXZfcHJpdik7
Ci0JZWxzZSBpZiAoZGV2X3ByaXYtPmNzci5hbGxvd2VkX2RjX21hc2sgJiBEQ19TVEFURV9FTl9V
UFRPX0RDNSkKLQkJZ2VuOV9lbmFibGVfZGM1KGRldl9wcml2KTsKLX0KLQotc3RhdGljIHZvaWQg
aTl4eF9wb3dlcl93ZWxsX3N5bmNfaHdfbm9vcChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCi0JCQkJCSBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQotewotfQot
Ci1zdGF0aWMgdm9pZCBpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX25vb3Aoc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpw
b3dlcl93ZWxsKQotewotfQotCi1zdGF0aWMgYm9vbCBpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxs
X2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCQkgICAgIHN0
cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCi17Ci0JcmV0dXJuIHRydWU7Ci19Ci0K
LXN0YXRpYyB2b2lkIGk4MzBfcGlwZXNfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCQkgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJf
d2VsbCkKLXsKLQlpZiAoKEk5MTVfUkVBRChQSVBFQ09ORihQSVBFX0EpKSAmIFBJUEVDT05GX0VO
QUJMRSkgPT0gMCkKLQkJaTgzMF9lbmFibGVfcGlwZShkZXZfcHJpdiwgUElQRV9BKTsKLQlpZiAo
KEk5MTVfUkVBRChQSVBFQ09ORihQSVBFX0IpKSAmIFBJUEVDT05GX0VOQUJMRSkgPT0gMCkKLQkJ
aTgzMF9lbmFibGVfcGlwZShkZXZfcHJpdiwgUElQRV9CKTsKLX0KLQotc3RhdGljIHZvaWQgaTgz
MF9waXBlc19wb3dlcl93ZWxsX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAotCQkJCQkgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCi17Ci0JaTgz
MF9kaXNhYmxlX3BpcGUoZGV2X3ByaXYsIFBJUEVfQik7Ci0JaTgzMF9kaXNhYmxlX3BpcGUoZGV2
X3ByaXYsIFBJUEVfQSk7Ci19Ci0KLXN0YXRpYyBib29sIGk4MzBfcGlwZXNfcG93ZXJfd2VsbF9l
bmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkJICBzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQotewotCXJldHVybiBJOTE1X1JFQUQoUElQRUNP
TkYoUElQRV9BKSkgJiBQSVBFQ09ORl9FTkFCTEUgJiYKLQkJSTkxNV9SRUFEKFBJUEVDT05GKFBJ
UEVfQikpICYgUElQRUNPTkZfRU5BQkxFOwotfQotCi1zdGF0aWMgdm9pZCBpODMwX3BpcGVzX3Bv
d2VyX3dlbGxfc3luY19odyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJ
CSAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKLXsKLQlpZiAocG93ZXJfd2Vs
bC0+Y291bnQgPiAwKQotCQlpODMwX3BpcGVzX3Bvd2VyX3dlbGxfZW5hYmxlKGRldl9wcml2LCBw
b3dlcl93ZWxsKTsKLQllbHNlCi0JCWk4MzBfcGlwZXNfcG93ZXJfd2VsbF9kaXNhYmxlKGRldl9w
cml2LCBwb3dlcl93ZWxsKTsKLX0KLQotc3RhdGljIHZvaWQgdmx2X3NldF9wb3dlcl93ZWxsKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAgICAgICBzdHJ1Y3QgaTkxNV9w
b3dlcl93ZWxsICpwb3dlcl93ZWxsLCBib29sIGVuYWJsZSkKLXsKLQlpbnQgcHdfaWR4ID0gcG93
ZXJfd2VsbC0+ZGVzYy0+dmx2LmlkeDsKLQl1MzIgbWFzazsKLQl1MzIgc3RhdGU7Ci0JdTMyIGN0
cmw7Ci0KLQltYXNrID0gUFVOSVRfUFdSR1RfTUFTSyhwd19pZHgpOwotCXN0YXRlID0gZW5hYmxl
ID8gUFVOSVRfUFdSR1RfUFdSX09OKHB3X2lkeCkgOgotCQkJIFBVTklUX1BXUkdUX1BXUl9HQVRF
KHB3X2lkeCk7Ci0KLQl2bHZfcHVuaXRfZ2V0KGRldl9wcml2KTsKLQotI2RlZmluZSBDT05EIFwK
LQkoKHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfUFdSR1RfU1RBVFVTKSAmIG1h
c2spID09IHN0YXRlKQotCi0JaWYgKENPTkQpCi0JCWdvdG8gb3V0OwotCi0JY3RybCA9IHZsdl9w
dW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfUFdSR1RfQ1RSTCk7Ci0JY3RybCAmPSB+bWFz
azsKLQljdHJsIHw9IHN0YXRlOwotCXZsdl9wdW5pdF93cml0ZShkZXZfcHJpdiwgUFVOSVRfUkVH
X1BXUkdUX0NUUkwsIGN0cmwpOwotCi0JaWYgKHdhaXRfZm9yKENPTkQsIDEwMCkpCi0JCURSTV9F
UlJPUigidGltZW91dCBzZXR0aW5nIHBvd2VyIHdlbGwgc3RhdGUgJTA4eCAoJTA4eClcbiIsCi0J
CQkgIHN0YXRlLAotCQkJICB2bHZfcHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX1BXUkdU
X0NUUkwpKTsKLQotI3VuZGVmIENPTkQKLQotb3V0OgotCXZsdl9wdW5pdF9wdXQoZGV2X3ByaXYp
OwotfQotCi1zdGF0aWMgdm9pZCB2bHZfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCSAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJf
d2VsbCkKLXsKLQl2bHZfc2V0X3Bvd2VyX3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIHRydWUp
OwotfQotCi1zdGF0aWMgdm9pZCB2bHZfcG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dl
cl93ZWxsKQotewotCXZsdl9zZXRfcG93ZXJfd2VsbChkZXZfcHJpdiwgcG93ZXJfd2VsbCwgZmFs
c2UpOwotfQotCi1zdGF0aWMgYm9vbCB2bHZfcG93ZXJfd2VsbF9lbmFibGVkKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpw
b3dlcl93ZWxsKQotewotCWludCBwd19pZHggPSBwb3dlcl93ZWxsLT5kZXNjLT52bHYuaWR4Owot
CWJvb2wgZW5hYmxlZCA9IGZhbHNlOwotCXUzMiBtYXNrOwotCXUzMiBzdGF0ZTsKLQl1MzIgY3Ry
bDsKLQotCW1hc2sgPSBQVU5JVF9QV1JHVF9NQVNLKHB3X2lkeCk7Ci0JY3RybCA9IFBVTklUX1BX
UkdUX1BXUl9PTihwd19pZHgpOwotCi0Jdmx2X3B1bml0X2dldChkZXZfcHJpdik7Ci0KLQlzdGF0
ZSA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5JVF9SRUdfUFdSR1RfU1RBVFVTKSAmIG1h
c2s7Ci0JLyoKLQkgKiBXZSBvbmx5IGV2ZXIgc2V0IHRoZSBwb3dlci1vbiBhbmQgcG93ZXItZ2F0
ZSBzdGF0ZXMsIGFueXRoaW5nCi0JICogZWxzZSBpcyB1bmV4cGVjdGVkLgotCSAqLwotCVdBUk5f
T04oc3RhdGUgIT0gUFVOSVRfUFdSR1RfUFdSX09OKHB3X2lkeCkgJiYKLQkJc3RhdGUgIT0gUFVO
SVRfUFdSR1RfUFdSX0dBVEUocHdfaWR4KSk7Ci0JaWYgKHN0YXRlID09IGN0cmwpCi0JCWVuYWJs
ZWQgPSB0cnVlOwotCi0JLyoKLQkgKiBBIHRyYW5zaWVudCBzdGF0ZSBhdCB0aGlzIHBvaW50IHdv
dWxkIG1lYW4gc29tZSB1bmV4cGVjdGVkIHBhcnR5Ci0JICogaXMgcG9raW5nIGF0IHRoZSBwb3dl
ciBjb250cm9scyB0b28uCi0JICovCi0JY3RybCA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQ
VU5JVF9SRUdfUFdSR1RfQ1RSTCkgJiBtYXNrOwotCVdBUk5fT04oY3RybCAhPSBzdGF0ZSk7Ci0K
LQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKLQotCXJldHVybiBlbmFibGVkOwotfQotCi1zdGF0
aWMgdm9pZCB2bHZfaW5pdF9kaXNwbGF5X2Nsb2NrX2dhdGluZyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTMyIHZhbDsKLQotCS8qCi0JICogT24gZHJpdmVyIGxvYWQs
IGEgcGlwZSBtYXkgYmUgYWN0aXZlIGFuZCBkcml2aW5nIGEgRFNJIGRpc3BsYXkuCi0JICogUHJl
c2VydmUgRFBPVU5JVF9DTE9DS19HQVRFX0RJU0FCTEUgdG8gYXZvaWQgdGhlIHBpcGUgZ2V0dGlu
ZyBzdHVjawotCSAqIChhbmQgbmV2ZXIgcmVjb3ZlcmluZykgaW4gdGhpcyBjYXNlLiBpbnRlbF9k
c2lfcG9zdF9kaXNhYmxlKCkgd2lsbAotCSAqIGNsZWFyIGl0IHdoZW4gd2UgdHVybiBvZmYgdGhl
IGRpc3BsYXkuCi0JICovCi0JdmFsID0gSTkxNV9SRUFEKERTUENMS19HQVRFX0QpOwotCXZhbCAm
PSBEUE9VTklUX0NMT0NLX0dBVEVfRElTQUJMRTsKLQl2YWwgfD0gVlJIVU5JVF9DTE9DS19HQVRF
X0RJU0FCTEU7Ci0JSTkxNV9XUklURShEU1BDTEtfR0FURV9ELCB2YWwpOwotCi0JLyoKLQkgKiBE
aXNhYmxlIHRyaWNrbGUgZmVlZCBhbmQgZW5hYmxlIHBuZCBkZWFkbGluZSBjYWxjdWxhdGlvbgot
CSAqLwotCUk5MTVfV1JJVEUoTUlfQVJCX1ZMViwgTUlfQVJCX0RJU1BMQVlfVFJJQ0tMRV9GRUVE
X0RJU0FCTEUpOwotCUk5MTVfV1JJVEUoQ0JSMV9WTFYsIDApOwotCi0JV0FSTl9PTihkZXZfcHJp
di0+cmF3Y2xrX2ZyZXEgPT0gMCk7Ci0KLQlJOTE1X1dSSVRFKFJBV0NMS19GUkVRX1ZMViwKLQkJ
ICAgRElWX1JPVU5EX0NMT1NFU1QoZGV2X3ByaXYtPnJhd2Nsa19mcmVxLCAxMDAwKSk7Ci19Ci0K
LXN0YXRpYyB2b2lkIHZsdl9kaXNwbGF5X3Bvd2VyX3dlbGxfaW5pdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXI7Ci0J
ZW51bSBwaXBlIHBpcGU7Ci0KLQkvKgotCSAqIEVuYWJsZSB0aGUgQ1JJIGNsb2NrIHNvdXJjZSBz
byB3ZSBjYW4gZ2V0IGF0IHRoZQotCSAqIGRpc3BsYXkgYW5kIHRoZSByZWZlcmVuY2UgY2xvY2sg
Zm9yIFZHQQotCSAqIGhvdHBsdWcgLyBtYW51YWwgZGV0ZWN0aW9uLiBTdXBwb3NlZGx5IERTSSBh
bHNvCi0JICogbmVlZHMgdGhlIHJlZiBjbG9jayB1cCBhbmQgcnVubmluZy4KLQkgKgotCSAqIENI
ViBEUExMIEIvQyBoYXZlIHNvbWUgaXNzdWVzIGlmIFZHQSBtb2RlIGlzIGVuYWJsZWQuCi0JICov
Ci0JZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkgewotCQl1MzIgdmFsID0gSTkxNV9SRUFE
KERQTEwocGlwZSkpOwotCi0JCXZhbCB8PSBEUExMX1JFRl9DTEtfRU5BQkxFX1ZMViB8IERQTExf
VkdBX01PREVfRElTOwotCQlpZiAocGlwZSAhPSBQSVBFX0EpCi0JCQl2YWwgfD0gRFBMTF9JTlRF
R1JBVEVEX0NSSV9DTEtfVkxWOwotCi0JCUk5MTVfV1JJVEUoRFBMTChwaXBlKSwgdmFsKTsKLQl9
Ci0KLQl2bHZfaW5pdF9kaXNwbGF5X2Nsb2NrX2dhdGluZyhkZXZfcHJpdik7Ci0KLQlzcGluX2xv
Y2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwotCXZhbGxleXZpZXdfZW5hYmxlX2Rpc3BsYXlf
aXJxcyhkZXZfcHJpdik7Ci0Jc3Bpbl91bmxvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwot
Ci0JLyoKLQkgKiBEdXJpbmcgZHJpdmVyIGluaXRpYWxpemF0aW9uL3Jlc3VtZSB3ZSBjYW4gYXZv
aWQgcmVzdG9yaW5nIHRoZQotCSAqIHBhcnQgb2YgdGhlIEhXL1NXIHN0YXRlIHRoYXQgd2lsbCBi
ZSBpbml0ZWQgYW55d2F5IGV4cGxpY2l0bHkuCi0JICovCi0JaWYgKGRldl9wcml2LT5wb3dlcl9k
b21haW5zLmluaXRpYWxpemluZykKLQkJcmV0dXJuOwotCi0JaW50ZWxfaHBkX2luaXQoZGV2X3By
aXYpOwotCi0JLyogUmUtZW5hYmxlIHRoZSBBRFBBLCBpZiB3ZSBoYXZlIG9uZSAqLwotCWZvcl9l
YWNoX2ludGVsX2VuY29kZXIoJmRldl9wcml2LT5kcm0sIGVuY29kZXIpIHsKLQkJaWYgKGVuY29k
ZXItPnR5cGUgPT0gSU5URUxfT1VUUFVUX0FOQUxPRykKLQkJCWludGVsX2NydF9yZXNldCgmZW5j
b2Rlci0+YmFzZSk7Ci0JfQotCi0JaTkxNV9yZWRpc2FibGVfdmdhX3Bvd2VyX29uKGRldl9wcml2
KTsKLQotCWludGVsX3Bwc191bmxvY2tfcmVnc193YShkZXZfcHJpdik7Ci19Ci0KLXN0YXRpYyB2
b2lkIHZsdl9kaXNwbGF5X3Bvd2VyX3dlbGxfZGVpbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKLXsKLQlzcGluX2xvY2tfaXJxKCZkZXZfcHJpdi0+aXJxX2xvY2spOwotCXZh
bGxleXZpZXdfZGlzYWJsZV9kaXNwbGF5X2lycXMoZGV2X3ByaXYpOwotCXNwaW5fdW5sb2NrX2ly
cSgmZGV2X3ByaXYtPmlycV9sb2NrKTsKLQotCS8qIG1ha2Ugc3VyZSB3ZSdyZSBkb25lIHByb2Nl
c3NpbmcgZGlzcGxheSBpcnFzICovCi0Jc3luY2hyb25pemVfaXJxKGRldl9wcml2LT5kcm0uaXJx
KTsKLQotCWludGVsX3Bvd2VyX3NlcXVlbmNlcl9yZXNldChkZXZfcHJpdik7Ci0KLQkvKiBQcmV2
ZW50IHVzIGZyb20gcmUtZW5hYmxpbmcgcG9sbGluZyBvbiBhY2NpZGVudCBpbiBsYXRlIHN1c3Bl
bmQgKi8KLQlpZiAoIWRldl9wcml2LT5kcm0uZGV2LT5wb3dlci5pc19zdXNwZW5kZWQpCi0JCWlu
dGVsX2hwZF9wb2xsX2luaXQoZGV2X3ByaXYpOwotfQotCi1zdGF0aWMgdm9pZCB2bHZfZGlzcGxh
eV9wb3dlcl93ZWxsX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0J
CQkJCSAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKLXsKLQl2bHZfc2V0X3Bv
d2VyX3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIHRydWUpOwotCi0Jdmx2X2Rpc3BsYXlfcG93
ZXJfd2VsbF9pbml0KGRldl9wcml2KTsKLX0KLQotc3RhdGljIHZvaWQgdmx2X2Rpc3BsYXlfcG93
ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkJ
ICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKLXsKLQl2bHZfZGlzcGxheV9w
b3dlcl93ZWxsX2RlaW5pdChkZXZfcHJpdik7Ci0KLQl2bHZfc2V0X3Bvd2VyX3dlbGwoZGV2X3By
aXYsIHBvd2VyX3dlbGwsIGZhbHNlKTsKLX0KLQotc3RhdGljIHZvaWQgdmx2X2RwaW9fY21uX3Bv
d2VyX3dlbGxfZW5hYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkJ
ICAgc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKLXsKLQkvKiBzaW5jZSByZWYv
Y3JpIGNsb2NrIHdhcyBlbmFibGVkICovCi0JdWRlbGF5KDEpOyAvKiA+MTBucyBmb3IgY21ucmVz
ZXQsID4wbnMgZm9yIHNpZGVyZXNldCAqLwotCi0Jdmx2X3NldF9wb3dlcl93ZWxsKGRldl9wcml2
LCBwb3dlcl93ZWxsLCB0cnVlKTsKLQotCS8qCi0JICogRnJvbSBWTFYyQTBfRFBfZURQX0RQSU9f
ZHJpdmVyX3ZiaW9zX25vdGVzXzEwLmRvY3ggLQotCSAqICA2LglEZS1hc3NlcnQgY21uX3Jlc2V0
L3NpZGVfcmVzZXQuIFNhbWUgYXMgVkxWIFgwLgotCSAqICAgYS4JR1VuaXQgMHgyMTEwIGJpdFsw
XSBzZXQgdG8gMSAoZGVmIDApCi0JICogICBiLglUaGUgb3RoZXIgYml0cyBzdWNoIGFzIHNmciBz
ZXR0aW5ncyAvIG1vZGVzZWwgbWF5IGFsbAotCSAqCWJlIHNldCB0byAwLgotCSAqCi0JICogVGhp
cyBzaG91bGQgb25seSBiZSBkb25lIG9uIGluaXQgYW5kIHJlc3VtZSBmcm9tIFMzIHdpdGgKLQkg
KiBib3RoIFBMTHMgZGlzYWJsZWQsIG9yIHdlIHJpc2sgbG9zaW5nIERQSU8gYW5kIFBMTAotCSAq
IHN5bmNocm9uaXphdGlvbi4KLQkgKi8KLQlJOTE1X1dSSVRFKERQSU9fQ1RMLCBJOTE1X1JFQUQo
RFBJT19DVEwpIHwgRFBJT19DTU5SU1QpOwotfQotCi1zdGF0aWMgdm9pZCB2bHZfZHBpb19jbW5f
cG93ZXJfd2VsbF9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJ
CQkJICAgIHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwpCi17Ci0JZW51bSBwaXBl
IHBpcGU7Ci0KLQlmb3JfZWFjaF9waXBlKGRldl9wcml2LCBwaXBlKQotCQlhc3NlcnRfcGxsX2Rp
c2FibGVkKGRldl9wcml2LCBwaXBlKTsKLQotCS8qIEFzc2VydCBjb21tb24gcmVzZXQgKi8KLQlJ
OTE1X1dSSVRFKERQSU9fQ1RMLCBJOTE1X1JFQUQoRFBJT19DVEwpICYgfkRQSU9fQ01OUlNUKTsK
LQotCXZsdl9zZXRfcG93ZXJfd2VsbChkZXZfcHJpdiwgcG93ZXJfd2VsbCwgZmFsc2UpOwotfQot
Ci0jZGVmaW5lIFBPV0VSX0RPTUFJTl9NQVNLIChHRU5NQVNLX1VMTChQT1dFUl9ET01BSU5fTlVN
IC0gMSwgMCkpCi0KLSNkZWZpbmUgQklUU19TRVQodmFsLCBiaXRzKSAoKCh2YWwpICYgKGJpdHMp
KSA9PSAoYml0cykpCi0KLXN0YXRpYyB2b2lkIGFzc2VydF9jaHZfcGh5X3N0YXR1cyhzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0Jc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAq
Y21uX2JjID0KLQkJbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFZMVl9ESVNQX1BXX0RQSU9f
Q01OX0JDKTsKLQlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpjbW5fZCA9Ci0JCWxvb2t1cF9wb3dl
cl93ZWxsKGRldl9wcml2LCBDSFZfRElTUF9QV19EUElPX0NNTl9EKTsKLQl1MzIgcGh5X2NvbnRy
b2wgPSBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sOwotCXUzMiBwaHlfc3RhdHVzID0gMDsKLQl1
MzIgcGh5X3N0YXR1c19tYXNrID0gMHhmZmZmZmZmZjsKLQotCS8qCi0JICogVGhlIEJJT1MgY2Fu
IGxlYXZlIHRoZSBQSFkgaXMgc29tZSB3ZWlyZCBzdGF0ZQotCSAqIHdoZXJlIGl0IGRvZXNuJ3Qg
ZnVsbHkgcG93ZXIgZG93biBzb21lIHBhcnRzLgotCSAqIERpc2FibGUgdGhlIGFzc2VydHMgdW50
aWwgdGhlIFBIWSBoYXMgYmVlbiBmdWxseQotCSAqIHJlc2V0IChpZS4gdGhlIHBvd2VyIHdlbGwg
aGFzIGJlZW4gZGlzYWJsZWQgYXQKLQkgKiBsZWFzdCBvbmNlKS4KLQkgKi8KLQlpZiAoIWRldl9w
cml2LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTBdKQotCQlwaHlfc3RhdHVzX21hc2sgJj0gfihQ
SFlfU1RBVFVTX0NNTl9MRE8oRFBJT19QSFkwLCBEUElPX0NIMCkgfAotCQkJCSAgICAgUEhZX1NU
QVRVU19TUExJTkVfTERPKERQSU9fUEhZMCwgRFBJT19DSDAsIDApIHwKLQkJCQkgICAgIFBIWV9T
VEFUVVNfU1BMSU5FX0xETyhEUElPX1BIWTAsIERQSU9fQ0gwLCAxKSB8Ci0JCQkJICAgICBQSFlf
U1RBVFVTX0NNTl9MRE8oRFBJT19QSFkwLCBEUElPX0NIMSkgfAotCQkJCSAgICAgUEhZX1NUQVRV
U19TUExJTkVfTERPKERQSU9fUEhZMCwgRFBJT19DSDEsIDApIHwKLQkJCQkgICAgIFBIWV9TVEFU
VVNfU1BMSU5FX0xETyhEUElPX1BIWTAsIERQSU9fQ0gxLCAxKSk7Ci0KLQlpZiAoIWRldl9wcml2
LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTFdKQotCQlwaHlfc3RhdHVzX21hc2sgJj0gfihQSFlf
U1RBVFVTX0NNTl9MRE8oRFBJT19QSFkxLCBEUElPX0NIMCkgfAotCQkJCSAgICAgUEhZX1NUQVRV
U19TUExJTkVfTERPKERQSU9fUEhZMSwgRFBJT19DSDAsIDApIHwKLQkJCQkgICAgIFBIWV9TVEFU
VVNfU1BMSU5FX0xETyhEUElPX1BIWTEsIERQSU9fQ0gwLCAxKSk7Ci0KLQlpZiAoY21uX2JjLT5k
ZXNjLT5vcHMtPmlzX2VuYWJsZWQoZGV2X3ByaXYsIGNtbl9iYykpIHsKLQkJcGh5X3N0YXR1cyB8
PSBQSFlfUE9XRVJHT09EKERQSU9fUEhZMCk7Ci0KLQkJLyogdGhpcyBhc3N1bWVzIG92ZXJyaWRl
IGlzIG9ubHkgdXNlZCB0byBlbmFibGUgbGFuZXMgKi8KLQkJaWYgKChwaHlfY29udHJvbCAmIFBI
WV9DSF9QT1dFUl9ET1dOX09WUkRfRU4oRFBJT19QSFkwLCBEUElPX0NIMCkpID09IDApCi0JCQlw
aHlfY29udHJvbCB8PSBQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEKDB4ZiwgRFBJT19QSFkwLCBEUElP
X0NIMCk7Ci0KLQkJaWYgKChwaHlfY29udHJvbCAmIFBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4o
RFBJT19QSFkwLCBEUElPX0NIMSkpID09IDApCi0JCQlwaHlfY29udHJvbCB8PSBQSFlfQ0hfUE9X
RVJfRE9XTl9PVlJEKDB4ZiwgRFBJT19QSFkwLCBEUElPX0NIMSk7Ci0KLQkJLyogQ0wxIGlzIG9u
IHdoZW5ldmVyIGFueXRoaW5nIGlzIG9uIGluIGVpdGhlciBjaGFubmVsICovCi0JCWlmIChCSVRT
X1NFVChwaHlfY29udHJvbCwKLQkJCSAgICAgUEhZX0NIX1BPV0VSX0RPV05fT1ZSRCgweGYsIERQ
SU9fUEhZMCwgRFBJT19DSDApIHwKLQkJCSAgICAgUEhZX0NIX1BPV0VSX0RPV05fT1ZSRCgweGYs
IERQSU9fUEhZMCwgRFBJT19DSDEpKSkKLQkJCXBoeV9zdGF0dXMgfD0gUEhZX1NUQVRVU19DTU5f
TERPKERQSU9fUEhZMCwgRFBJT19DSDApOwotCi0JCS8qCi0JCSAqIFRoZSBEUExMQiBjaGVjayBh
Y2NvdW50cyBmb3IgdGhlIHBpcGUgQiArIHBvcnQgQSB1c2FnZQotCQkgKiB3aXRoIENMMiBwb3dl
cmVkIHVwIGJ1dCBhbGwgdGhlIGxhbmVzIGluIHRoZSBzZWNvbmQgY2hhbm5lbAotCQkgKiBwb3dl
cmVkIGRvd24uCi0JCSAqLwotCQlpZiAoQklUU19TRVQocGh5X2NvbnRyb2wsCi0JCQkgICAgIFBI
WV9DSF9QT1dFUl9ET1dOX09WUkQoMHhmLCBEUElPX1BIWTAsIERQSU9fQ0gxKSkgJiYKLQkJICAg
IChJOTE1X1JFQUQoRFBMTChQSVBFX0IpKSAmIERQTExfVkNPX0VOQUJMRSkgPT0gMCkKLQkJCXBo
eV9zdGF0dXMgfD0gUEhZX1NUQVRVU19DTU5fTERPKERQSU9fUEhZMCwgRFBJT19DSDEpOwotCi0J
CWlmIChCSVRTX1NFVChwaHlfY29udHJvbCwKLQkJCSAgICAgUEhZX0NIX1BPV0VSX0RPV05fT1ZS
RCgweDMsIERQSU9fUEhZMCwgRFBJT19DSDApKSkKLQkJCXBoeV9zdGF0dXMgfD0gUEhZX1NUQVRV
U19TUExJTkVfTERPKERQSU9fUEhZMCwgRFBJT19DSDAsIDApOwotCQlpZiAoQklUU19TRVQocGh5
X2NvbnRyb2wsCi0JCQkgICAgIFBIWV9DSF9QT1dFUl9ET1dOX09WUkQoMHhjLCBEUElPX1BIWTAs
IERQSU9fQ0gwKSkpCi0JCQlwaHlfc3RhdHVzIHw9IFBIWV9TVEFUVVNfU1BMSU5FX0xETyhEUElP
X1BIWTAsIERQSU9fQ0gwLCAxKTsKLQotCQlpZiAoQklUU19TRVQocGh5X2NvbnRyb2wsCi0JCQkg
ICAgIFBIWV9DSF9QT1dFUl9ET1dOX09WUkQoMHgzLCBEUElPX1BIWTAsIERQSU9fQ0gxKSkpCi0J
CQlwaHlfc3RhdHVzIHw9IFBIWV9TVEFUVVNfU1BMSU5FX0xETyhEUElPX1BIWTAsIERQSU9fQ0gx
LCAwKTsKLQkJaWYgKEJJVFNfU0VUKHBoeV9jb250cm9sLAotCQkJICAgICBQSFlfQ0hfUE9XRVJf
RE9XTl9PVlJEKDB4YywgRFBJT19QSFkwLCBEUElPX0NIMSkpKQotCQkJcGh5X3N0YXR1cyB8PSBQ
SFlfU1RBVFVTX1NQTElORV9MRE8oRFBJT19QSFkwLCBEUElPX0NIMSwgMSk7Ci0JfQotCi0JaWYg
KGNtbl9kLT5kZXNjLT5vcHMtPmlzX2VuYWJsZWQoZGV2X3ByaXYsIGNtbl9kKSkgewotCQlwaHlf
c3RhdHVzIHw9IFBIWV9QT1dFUkdPT0QoRFBJT19QSFkxKTsKLQotCQkvKiB0aGlzIGFzc3VtZXMg
b3ZlcnJpZGUgaXMgb25seSB1c2VkIHRvIGVuYWJsZSBsYW5lcyAqLwotCQlpZiAoKHBoeV9jb250
cm9sICYgUEhZX0NIX1BPV0VSX0RPV05fT1ZSRF9FTihEUElPX1BIWTEsIERQSU9fQ0gwKSkgPT0g
MCkKLQkJCXBoeV9jb250cm9sIHw9IFBIWV9DSF9QT1dFUl9ET1dOX09WUkQoMHhmLCBEUElPX1BI
WTEsIERQSU9fQ0gwKTsKLQotCQlpZiAoQklUU19TRVQocGh5X2NvbnRyb2wsCi0JCQkgICAgIFBI
WV9DSF9QT1dFUl9ET1dOX09WUkQoMHhmLCBEUElPX1BIWTEsIERQSU9fQ0gwKSkpCi0JCQlwaHlf
c3RhdHVzIHw9IFBIWV9TVEFUVVNfQ01OX0xETyhEUElPX1BIWTEsIERQSU9fQ0gwKTsKLQotCQlp
ZiAoQklUU19TRVQocGh5X2NvbnRyb2wsCi0JCQkgICAgIFBIWV9DSF9QT1dFUl9ET1dOX09WUkQo
MHgzLCBEUElPX1BIWTEsIERQSU9fQ0gwKSkpCi0JCQlwaHlfc3RhdHVzIHw9IFBIWV9TVEFUVVNf
U1BMSU5FX0xETyhEUElPX1BIWTEsIERQSU9fQ0gwLCAwKTsKLQkJaWYgKEJJVFNfU0VUKHBoeV9j
b250cm9sLAotCQkJICAgICBQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEKDB4YywgRFBJT19QSFkxLCBE
UElPX0NIMCkpKQotCQkJcGh5X3N0YXR1cyB8PSBQSFlfU1RBVFVTX1NQTElORV9MRE8oRFBJT19Q
SFkxLCBEUElPX0NIMCwgMSk7Ci0JfQotCi0JcGh5X3N0YXR1cyAmPSBwaHlfc3RhdHVzX21hc2s7
Ci0KLQkvKgotCSAqIFRoZSBQSFkgbWF5IGJlIGJ1c3kgd2l0aCBzb21lIGluaXRpYWwgY2FsaWJy
YXRpb24gYW5kIHdoYXRub3QsCi0JICogc28gdGhlIHBvd2VyIHN0YXRlIGNhbiB0YWtlIGEgd2hp
bGUgdG8gYWN0dWFsbHkgY2hhbmdlLgotCSAqLwotCWlmIChpbnRlbF93YWl0X2Zvcl9yZWdpc3Rl
cigmZGV2X3ByaXYtPnVuY29yZSwKLQkJCQkgICAgRElTUExBWV9QSFlfU1RBVFVTLAotCQkJCSAg
ICBwaHlfc3RhdHVzX21hc2ssCi0JCQkJICAgIHBoeV9zdGF0dXMsCi0JCQkJICAgIDEwKSkKLQkJ
RFJNX0VSUk9SKCJVbmV4cGVjdGVkIFBIWV9TVEFUVVMgMHglMDh4LCBleHBlY3RlZCAweCUwOHgg
KFBIWV9DT05UUk9MPTB4JTA4eClcbiIsCi0JCQkgIEk5MTVfUkVBRChESVNQTEFZX1BIWV9TVEFU
VVMpICYgcGh5X3N0YXR1c19tYXNrLAotCQkJICAgcGh5X3N0YXR1cywgZGV2X3ByaXYtPmNodl9w
aHlfY29udHJvbCk7Ci19Ci0KLSN1bmRlZiBCSVRTX1NFVAotCi1zdGF0aWMgdm9pZCBjaHZfZHBp
b19jbW5fcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAotCQkJCQkgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93ZWxsKQotewotCWVudW0g
ZHBpb19waHkgcGh5OwotCWVudW0gcGlwZSBwaXBlOwotCXUzMiB0bXA7Ci0KLQlXQVJOX09OX09O
Q0UocG93ZXJfd2VsbC0+ZGVzYy0+aWQgIT0gVkxWX0RJU1BfUFdfRFBJT19DTU5fQkMgJiYKLQkJ
ICAgICBwb3dlcl93ZWxsLT5kZXNjLT5pZCAhPSBDSFZfRElTUF9QV19EUElPX0NNTl9EKTsKLQot
CWlmIChwb3dlcl93ZWxsLT5kZXNjLT5pZCA9PSBWTFZfRElTUF9QV19EUElPX0NNTl9CQykgewot
CQlwaXBlID0gUElQRV9BOwotCQlwaHkgPSBEUElPX1BIWTA7Ci0JfSBlbHNlIHsKLQkJcGlwZSA9
IFBJUEVfQzsKLQkJcGh5ID0gRFBJT19QSFkxOwotCX0KLQotCS8qIHNpbmNlIHJlZi9jcmkgY2xv
Y2sgd2FzIGVuYWJsZWQgKi8KLQl1ZGVsYXkoMSk7IC8qID4xMG5zIGZvciBjbW5yZXNldCwgPjBu
cyBmb3Igc2lkZXJlc2V0ICovCi0Jdmx2X3NldF9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93
ZWxsLCB0cnVlKTsKLQotCS8qIFBvbGwgZm9yIHBoeXB3cmdvb2Qgc2lnbmFsICovCi0JaWYgKGlu
dGVsX3dhaXRfZm9yX3JlZ2lzdGVyKCZkZXZfcHJpdi0+dW5jb3JlLAotCQkJCSAgICBESVNQTEFZ
X1BIWV9TVEFUVVMsCi0JCQkJICAgIFBIWV9QT1dFUkdPT0QocGh5KSwKLQkJCQkgICAgUEhZX1BP
V0VSR09PRChwaHkpLAotCQkJCSAgICAxKSkKLQkJRFJNX0VSUk9SKCJEaXNwbGF5IFBIWSAlZCBp
cyBub3QgcG93ZXIgdXBcbiIsIHBoeSk7Ci0KLQl2bHZfZHBpb19nZXQoZGV2X3ByaXYpOwotCi0J
LyogRW5hYmxlIGR5bmFtaWMgcG93ZXIgZG93biAqLwotCXRtcCA9IHZsdl9kcGlvX3JlYWQoZGV2
X3ByaXYsIHBpcGUsIENIVl9DTU5fRFcyOCk7Ci0JdG1wIHw9IERQSU9fRFlOUFdSRE9XTkVOX0NI
MCB8IERQSU9fQ0wxUE9XRVJET1dORU4gfAotCQlEUElPX1NVU19DTEtfQ09ORklHX0dBVEVfQ0xL
UkVROwotCXZsdl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMjgsIHRtcCk7
Ci0KLQlpZiAocG93ZXJfd2VsbC0+ZGVzYy0+aWQgPT0gVkxWX0RJU1BfUFdfRFBJT19DTU5fQkMp
IHsKLQkJdG1wID0gdmx2X2RwaW9fcmVhZChkZXZfcHJpdiwgcGlwZSwgX0NIVl9DTU5fRFc2X0NI
MSk7Ci0JCXRtcCB8PSBEUElPX0RZTlBXUkRPV05FTl9DSDE7Ci0JCXZsdl9kcGlvX3dyaXRlKGRl
dl9wcml2LCBwaXBlLCBfQ0hWX0NNTl9EVzZfQ0gxLCB0bXApOwotCX0gZWxzZSB7Ci0JCS8qCi0J
CSAqIEZvcmNlIHRoZSBub24tZXhpc3RpbmcgQ0wyIG9mZi4gQlhUIGRvZXMgdGhpcwotCQkgKiB0
b28sIHNvIG1heWJlIGl0IHNhdmVzIHNvbWUgcG93ZXIgZXZlbiB0aG91Z2gKLQkJICogQ0wyIGRv
ZXNuJ3QgZXhpc3Q/Ci0JCSAqLwotCQl0bXAgPSB2bHZfZHBpb19yZWFkKGRldl9wcml2LCBwaXBl
LCBDSFZfQ01OX0RXMzApOwotCQl0bXAgfD0gRFBJT19DTDJfTERPRlVTRV9QV1JFTkI7Ci0JCXZs
dl9kcGlvX3dyaXRlKGRldl9wcml2LCBwaXBlLCBDSFZfQ01OX0RXMzAsIHRtcCk7Ci0JfQotCi0J
dmx2X2RwaW9fcHV0KGRldl9wcml2KTsKLQotCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgfD0g
UEhZX0NPTV9MQU5FX1JFU0VUX0RFQVNTRVJUKHBoeSk7Ci0JSTkxNV9XUklURShESVNQTEFZX1BI
WV9DT05UUk9MLCBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sKTsKLQotCURSTV9ERUJVR19LTVMo
IkVuYWJsZWQgRFBJTyBQSFklZCAoUEhZX0NPTlRST0w9MHglMDh4KVxuIiwKLQkJICAgICAgcGh5
LCBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sKTsKLQotCWFzc2VydF9jaHZfcGh5X3N0YXR1cyhk
ZXZfcHJpdik7Ci19Ci0KLXN0YXRpYyB2b2lkIGNodl9kcGlvX2Ntbl9wb3dlcl93ZWxsX2Rpc2Fi
bGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCQkgICAgc3RydWN0IGk5
MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKLXsKLQllbnVtIGRwaW9fcGh5IHBoeTsKLQotCVdB
Uk5fT05fT05DRShwb3dlcl93ZWxsLT5kZXNjLT5pZCAhPSBWTFZfRElTUF9QV19EUElPX0NNTl9C
QyAmJgotCQkgICAgIHBvd2VyX3dlbGwtPmRlc2MtPmlkICE9IENIVl9ESVNQX1BXX0RQSU9fQ01O
X0QpOwotCi0JaWYgKHBvd2VyX3dlbGwtPmRlc2MtPmlkID09IFZMVl9ESVNQX1BXX0RQSU9fQ01O
X0JDKSB7Ci0JCXBoeSA9IERQSU9fUEhZMDsKLQkJYXNzZXJ0X3BsbF9kaXNhYmxlZChkZXZfcHJp
diwgUElQRV9BKTsKLQkJYXNzZXJ0X3BsbF9kaXNhYmxlZChkZXZfcHJpdiwgUElQRV9CKTsKLQl9
IGVsc2UgewotCQlwaHkgPSBEUElPX1BIWTE7Ci0JCWFzc2VydF9wbGxfZGlzYWJsZWQoZGV2X3By
aXYsIFBJUEVfQyk7Ci0JfQotCi0JZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCAmPSB+UEhZX0NP
TV9MQU5FX1JFU0VUX0RFQVNTRVJUKHBoeSk7Ci0JSTkxNV9XUklURShESVNQTEFZX1BIWV9DT05U
Uk9MLCBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sKTsKLQotCXZsdl9zZXRfcG93ZXJfd2VsbChk
ZXZfcHJpdiwgcG93ZXJfd2VsbCwgZmFsc2UpOwotCi0JRFJNX0RFQlVHX0tNUygiRGlzYWJsZWQg
RFBJTyBQSFklZCAoUEhZX0NPTlRST0w9MHglMDh4KVxuIiwKLQkJICAgICAgcGh5LCBkZXZfcHJp
di0+Y2h2X3BoeV9jb250cm9sKTsKLQotCS8qIFBIWSBpcyBmdWxseSByZXNldCBub3csIHNvIHdl
IGNhbiBlbmFibGUgdGhlIFBIWSBzdGF0ZSBhc3NlcnRzICovCi0JZGV2X3ByaXYtPmNodl9waHlf
YXNzZXJ0W3BoeV0gPSB0cnVlOwotCi0JYXNzZXJ0X2Nodl9waHlfc3RhdHVzKGRldl9wcml2KTsK
LX0KLQotc3RhdGljIHZvaWQgYXNzZXJ0X2Nodl9waHlfcG93ZXJnYXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBkcGlvX3BoeSBwaHksCi0JCQkJICAgICBlbnVtIGRw
aW9fY2hhbm5lbCBjaCwgYm9vbCBvdmVycmlkZSwgdW5zaWduZWQgaW50IG1hc2spCi17Ci0JZW51
bSBwaXBlIHBpcGUgPSBwaHkgPT0gRFBJT19QSFkwID8gUElQRV9BIDogUElQRV9DOwotCXUzMiBy
ZWcsIHZhbCwgZXhwZWN0ZWQsIGFjdHVhbDsKLQotCS8qCi0JICogVGhlIEJJT1MgY2FuIGxlYXZl
IHRoZSBQSFkgaXMgc29tZSB3ZWlyZCBzdGF0ZQotCSAqIHdoZXJlIGl0IGRvZXNuJ3QgZnVsbHkg
cG93ZXIgZG93biBzb21lIHBhcnRzLgotCSAqIERpc2FibGUgdGhlIGFzc2VydHMgdW50aWwgdGhl
IFBIWSBoYXMgYmVlbiBmdWxseQotCSAqIHJlc2V0IChpZS4gdGhlIHBvd2VyIHdlbGwgaGFzIGJl
ZW4gZGlzYWJsZWQgYXQKLQkgKiBsZWFzdCBvbmNlKS4KLQkgKi8KLQlpZiAoIWRldl9wcml2LT5j
aHZfcGh5X2Fzc2VydFtwaHldKQotCQlyZXR1cm47Ci0KLQlpZiAoY2ggPT0gRFBJT19DSDApCi0J
CXJlZyA9IF9DSFZfQ01OX0RXMF9DSDA7Ci0JZWxzZQotCQlyZWcgPSBfQ0hWX0NNTl9EVzZfQ0gx
OwotCi0Jdmx2X2RwaW9fZ2V0KGRldl9wcml2KTsKLQl2YWwgPSB2bHZfZHBpb19yZWFkKGRldl9w
cml2LCBwaXBlLCByZWcpOwotCXZsdl9kcGlvX3B1dChkZXZfcHJpdik7Ci0KLQkvKgotCSAqIFRo
aXMgYXNzdW1lcyAhb3ZlcnJpZGUgaXMgb25seSB1c2VkIHdoZW4gdGhlIHBvcnQgaXMgZGlzYWJs
ZWQuCi0JICogQWxsIGxhbmVzIHNob3VsZCBwb3dlciBkb3duIGV2ZW4gd2l0aG91dCB0aGUgb3Zl
cnJpZGUgd2hlbgotCSAqIHRoZSBwb3J0IGlzIGRpc2FibGVkLgotCSAqLwotCWlmICghb3ZlcnJp
ZGUgfHwgbWFzayA9PSAweGYpIHsKLQkJZXhwZWN0ZWQgPSBEUElPX0FMTERMX1BPV0VSRE9XTiB8
IERQSU9fQU5ZRExfUE9XRVJET1dOOwotCQkvKgotCQkgKiBJZiBDSDEgY29tbW9uIGxhbmUgaXMg
bm90IGFjdGl2ZSBhbnltb3JlCi0JCSAqIChlZy4gZm9yIHBpcGUgQiBEUExMKSB0aGUgZW50aXJl
IGNoYW5uZWwgd2lsbAotCQkgKiBzaHV0IGRvd24sIHdoaWNoIGNhdXNlcyB0aGUgY29tbW9uIGxh
bmUgcmVnaXN0ZXJzCi0JCSAqIHRvIHJlYWQgYXMgMC4gVGhhdCBtZWFucyB3ZSBjYW4ndCBhY3R1
YWxseSBjaGVjawotCQkgKiB0aGUgbGFuZSBwb3dlciBkb3duIHN0YXR1cyBiaXRzLCBidXQgYXMg
dGhlIGVudGlyZQotCQkgKiByZWdpc3RlciByZWFkcyBhcyAwIGl0J3MgYSBnb29kIGluZGljYXRp
b24gdGhhdCB0aGUKLQkJICogY2hhbm5lbCBpcyBpbmRlZWQgZW50aXJlbHkgcG93ZXJlZCBkb3du
LgotCQkgKi8KLQkJaWYgKGNoID09IERQSU9fQ0gxICYmIHZhbCA9PSAwKQotCQkJZXhwZWN0ZWQg
PSAwOwotCX0gZWxzZSBpZiAobWFzayAhPSAweDApIHsKLQkJZXhwZWN0ZWQgPSBEUElPX0FOWURM
X1BPV0VSRE9XTjsKLQl9IGVsc2UgewotCQlleHBlY3RlZCA9IDA7Ci0JfQotCi0JaWYgKGNoID09
IERQSU9fQ0gwKQotCQlhY3R1YWwgPSB2YWwgPj4gRFBJT19BTllETF9QT1dFUkRPV05fU0hJRlRf
Q0gwOwotCWVsc2UKLQkJYWN0dWFsID0gdmFsID4+IERQSU9fQU5ZRExfUE9XRVJET1dOX1NISUZU
X0NIMTsKLQlhY3R1YWwgJj0gRFBJT19BTExETF9QT1dFUkRPV04gfCBEUElPX0FOWURMX1BPV0VS
RE9XTjsKLQotCVdBUk4oYWN0dWFsICE9IGV4cGVjdGVkLAotCSAgICAgIlVuZXhwZWN0ZWQgRFBJ
TyBsYW5lIHBvd2VyIGRvd246IGFsbCAlZCwgYW55ICVkLiBFeHBlY3RlZDogYWxsICVkLCBhbnkg
JWQuICgweCV4ID0gMHglMDh4KVxuIiwKLQkgICAgICEhKGFjdHVhbCAmIERQSU9fQUxMRExfUE9X
RVJET1dOKSwgISEoYWN0dWFsICYgRFBJT19BTllETF9QT1dFUkRPV04pLAotCSAgICAgISEoZXhw
ZWN0ZWQgJiBEUElPX0FMTERMX1BPV0VSRE9XTiksICEhKGV4cGVjdGVkICYgRFBJT19BTllETF9Q
T1dFUkRPV04pLAotCSAgICAgcmVnLCB2YWwpOwotfQotCi1ib29sIGNodl9waHlfcG93ZXJnYXRl
X2NoKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgZW51bSBkcGlvX3BoeSBwaHks
Ci0JCQkgIGVudW0gZHBpb19jaGFubmVsIGNoLCBib29sIG92ZXJyaWRlKQotewotCXN0cnVjdCBp
OTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFp
bnM7Ci0JYm9vbCB3YXNfb3ZlcnJpZGU7Ci0KLQltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5s
b2NrKTsKLQotCXdhc19vdmVycmlkZSA9IGRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgJiBQSFlf
Q0hfUE9XRVJfRE9XTl9PVlJEX0VOKHBoeSwgY2gpOwotCi0JaWYgKG92ZXJyaWRlID09IHdhc19v
dmVycmlkZSkKLQkJZ290byBvdXQ7Ci0KLQlpZiAob3ZlcnJpZGUpCi0JCWRldl9wcml2LT5jaHZf
cGh5X2NvbnRyb2wgfD0gUEhZX0NIX1BPV0VSX0RPV05fT1ZSRF9FTihwaHksIGNoKTsKLQllbHNl
Ci0JCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgJj0gflBIWV9DSF9QT1dFUl9ET1dOX09WUkRf
RU4ocGh5LCBjaCk7Ci0KLQlJOTE1X1dSSVRFKERJU1BMQVlfUEhZX0NPTlRST0wsIGRldl9wcml2
LT5jaHZfcGh5X2NvbnRyb2wpOwotCi0JRFJNX0RFQlVHX0tNUygiUG93ZXIgZ2F0aW5nIERQSU8g
UEhZJWQgQ0glZCAoRFBJT19QSFlfQ09OVFJPTD0weCUwOHgpXG4iLAotCQkgICAgICBwaHksIGNo
LCBkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sKTsKLQotCWFzc2VydF9jaHZfcGh5X3N0YXR1cyhk
ZXZfcHJpdik7Ci0KLW91dDoKLQltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwot
Ci0JcmV0dXJuIHdhc19vdmVycmlkZTsKLX0KLQotdm9pZCBjaHZfcGh5X3Bvd2VyZ2F0ZV9sYW5l
cyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKLQkJCSAgICAgYm9vbCBvdmVycmlkZSwg
dW5zaWduZWQgaW50IG1hc2spCi17Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
ID0gdG9faTkxNShlbmNvZGVyLT5iYXNlLmRldik7Ci0Jc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlu
cyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKLQllbnVtIGRwaW9f
cGh5IHBoeSA9IHZsdl9kcG9ydF90b19waHkoZW5jX3RvX2RpZ19wb3J0KCZlbmNvZGVyLT5iYXNl
KSk7Ci0JZW51bSBkcGlvX2NoYW5uZWwgY2ggPSB2bHZfZHBvcnRfdG9fY2hhbm5lbChlbmNfdG9f
ZGlnX3BvcnQoJmVuY29kZXItPmJhc2UpKTsKLQotCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMt
PmxvY2spOwotCi0JZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCAmPSB+UEhZX0NIX1BPV0VSX0RP
V05fT1ZSRCgweGYsIHBoeSwgY2gpOwotCWRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wgfD0gUEhZ
X0NIX1BPV0VSX0RPV05fT1ZSRChtYXNrLCBwaHksIGNoKTsKLQotCWlmIChvdmVycmlkZSkKLQkJ
ZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCB8PSBQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEX0VOKHBo
eSwgY2gpOwotCWVsc2UKLQkJZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCAmPSB+UEhZX0NIX1BP
V0VSX0RPV05fT1ZSRF9FTihwaHksIGNoKTsKLQotCUk5MTVfV1JJVEUoRElTUExBWV9QSFlfQ09O
VFJPTCwgZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCk7Ci0KLQlEUk1fREVCVUdfS01TKCJQb3dl
ciBnYXRpbmcgRFBJTyBQSFklZCBDSCVkIGxhbmVzIDB4JXggKFBIWV9DT05UUk9MPTB4JTA4eClc
biIsCi0JCSAgICAgIHBoeSwgY2gsIG1hc2ssIGRldl9wcml2LT5jaHZfcGh5X2NvbnRyb2wpOwot
Ci0JYXNzZXJ0X2Nodl9waHlfc3RhdHVzKGRldl9wcml2KTsKLQotCWFzc2VydF9jaHZfcGh5X3Bv
d2VyZ2F0ZShkZXZfcHJpdiwgcGh5LCBjaCwgb3ZlcnJpZGUsIG1hc2spOwotCi0JbXV0ZXhfdW5s
b2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKLX0KLQotc3RhdGljIGJvb2wgY2h2X3BpcGVfcG93
ZXJfd2VsbF9lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkJ
c3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbCkKLXsKLQllbnVtIHBpcGUgcGlwZSA9
IFBJUEVfQTsKLQlib29sIGVuYWJsZWQ7Ci0JdTMyIHN0YXRlLCBjdHJsOwotCi0Jdmx2X3B1bml0
X2dldChkZXZfcHJpdik7Ci0KLQlzdGF0ZSA9IHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCBQVU5J
VF9SRUdfRFNQU1NQTSkgJiBEUF9TU1NfTUFTSyhwaXBlKTsKLQkvKgotCSAqIFdlIG9ubHkgZXZl
ciBzZXQgdGhlIHBvd2VyLW9uIGFuZCBwb3dlci1nYXRlIHN0YXRlcywgYW55dGhpbmcKLQkgKiBl
bHNlIGlzIHVuZXhwZWN0ZWQuCi0JICovCi0JV0FSTl9PTihzdGF0ZSAhPSBEUF9TU1NfUFdSX09O
KHBpcGUpICYmIHN0YXRlICE9IERQX1NTU19QV1JfR0FURShwaXBlKSk7Ci0JZW5hYmxlZCA9IHN0
YXRlID09IERQX1NTU19QV1JfT04ocGlwZSk7Ci0KLQkvKgotCSAqIEEgdHJhbnNpZW50IHN0YXRl
IGF0IHRoaXMgcG9pbnQgd291bGQgbWVhbiBzb21lIHVuZXhwZWN0ZWQgcGFydHkKLQkgKiBpcyBw
b2tpbmcgYXQgdGhlIHBvd2VyIGNvbnRyb2xzIHRvby4KLQkgKi8KLQljdHJsID0gdmx2X3B1bml0
X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19EU1BTU1BNKSAmIERQX1NTQ19NQVNLKHBpcGUpOwot
CVdBUk5fT04oY3RybCA8PCAxNiAhPSBzdGF0ZSk7Ci0KLQl2bHZfcHVuaXRfcHV0KGRldl9wcml2
KTsKLQotCXJldHVybiBlbmFibGVkOwotfQotCi1zdGF0aWMgdm9pZCBjaHZfc2V0X3BpcGVfcG93
ZXJfd2VsbChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJICAgIHN0cnVj
dCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGwsCi0JCQkJICAgIGJvb2wgZW5hYmxlKQotewot
CWVudW0gcGlwZSBwaXBlID0gUElQRV9BOwotCXUzMiBzdGF0ZTsKLQl1MzIgY3RybDsKLQotCXN0
YXRlID0gZW5hYmxlID8gRFBfU1NTX1BXUl9PTihwaXBlKSA6IERQX1NTU19QV1JfR0FURShwaXBl
KTsKLQotCXZsdl9wdW5pdF9nZXQoZGV2X3ByaXYpOwotCi0jZGVmaW5lIENPTkQgXAotCSgodmx2
X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19EU1BTU1BNKSAmIERQX1NTU19NQVNLKHBp
cGUpKSA9PSBzdGF0ZSkKLQotCWlmIChDT05EKQotCQlnb3RvIG91dDsKLQotCWN0cmwgPSB2bHZf
cHVuaXRfcmVhZChkZXZfcHJpdiwgUFVOSVRfUkVHX0RTUFNTUE0pOwotCWN0cmwgJj0gfkRQX1NT
Q19NQVNLKHBpcGUpOwotCWN0cmwgfD0gZW5hYmxlID8gRFBfU1NDX1BXUl9PTihwaXBlKSA6IERQ
X1NTQ19QV1JfR0FURShwaXBlKTsKLQl2bHZfcHVuaXRfd3JpdGUoZGV2X3ByaXYsIFBVTklUX1JF
R19EU1BTU1BNLCBjdHJsKTsKLQotCWlmICh3YWl0X2ZvcihDT05ELCAxMDApKQotCQlEUk1fRVJS
T1IoInRpbWVvdXQgc2V0dGluZyBwb3dlciB3ZWxsIHN0YXRlICUwOHggKCUwOHgpXG4iLAotCQkJ
ICBzdGF0ZSwKLQkJCSAgdmx2X3B1bml0X3JlYWQoZGV2X3ByaXYsIFBVTklUX1JFR19EU1BTU1BN
KSk7Ci0KLSN1bmRlZiBDT05ECi0KLW91dDoKLQl2bHZfcHVuaXRfcHV0KGRldl9wcml2KTsKLX0K
LQotc3RhdGljIHZvaWQgY2h2X3BpcGVfcG93ZXJfd2VsbF9lbmFibGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCSAgICAgICBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpw
b3dlcl93ZWxsKQotewotCWNodl9zZXRfcGlwZV9wb3dlcl93ZWxsKGRldl9wcml2LCBwb3dlcl93
ZWxsLCB0cnVlKTsKLQotCXZsdl9kaXNwbGF5X3Bvd2VyX3dlbGxfaW5pdChkZXZfcHJpdik7Ci19
Ci0KLXN0YXRpYyB2b2lkIGNodl9waXBlX3Bvd2VyX3dlbGxfZGlzYWJsZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2Vy
X3dlbGwpCi17Ci0Jdmx2X2Rpc3BsYXlfcG93ZXJfd2VsbF9kZWluaXQoZGV2X3ByaXYpOwotCi0J
Y2h2X3NldF9waXBlX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIGZhbHNlKTsKLX0K
LQotc3RhdGljIHU2NCBfX2FzeW5jX3B1dF9kb21haW5zX21hc2soc3RydWN0IGk5MTVfcG93ZXJf
ZG9tYWlucyAqcG93ZXJfZG9tYWlucykKLXsKLQlyZXR1cm4gcG93ZXJfZG9tYWlucy0+YXN5bmNf
cHV0X2RvbWFpbnNbMF0gfAotCSAgICAgICBwb3dlcl9kb21haW5zLT5hc3luY19wdXRfZG9tYWlu
c1sxXTsKLX0KLQotI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX1JVTlRJTUVf
UE0pCi0KLXN0YXRpYyBib29sCi1hc3NlcnRfYXN5bmNfcHV0X2RvbWFpbl9tYXNrc19kaXNqb2lu
dChzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zKQotewotCXJldHVybiAh
V0FSTl9PTihwb3dlcl9kb21haW5zLT5hc3luY19wdXRfZG9tYWluc1swXSAmCi0JCQlwb3dlcl9k
b21haW5zLT5hc3luY19wdXRfZG9tYWluc1sxXSk7Ci19Ci0KLXN0YXRpYyBib29sCi1fX2FzeW5j
X3B1dF9kb21haW5zX3N0YXRlX29rKHN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2Rv
bWFpbnMpCi17Ci0JZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW47Ci0JYm9v
bCBlcnIgPSBmYWxzZTsKLQotCWVyciB8PSAhYXNzZXJ0X2FzeW5jX3B1dF9kb21haW5fbWFza3Nf
ZGlzam9pbnQocG93ZXJfZG9tYWlucyk7Ci0JZXJyIHw9IFdBUk5fT04oISFwb3dlcl9kb21haW5z
LT5hc3luY19wdXRfd2FrZXJlZiAhPQotCQkgICAgICAgISFfX2FzeW5jX3B1dF9kb21haW5zX21h
c2socG93ZXJfZG9tYWlucykpOwotCi0JZm9yX2VhY2hfcG93ZXJfZG9tYWluKGRvbWFpbiwgX19h
c3luY19wdXRfZG9tYWluc19tYXNrKHBvd2VyX2RvbWFpbnMpKQotCQllcnIgfD0gV0FSTl9PTihw
b3dlcl9kb21haW5zLT5kb21haW5fdXNlX2NvdW50W2RvbWFpbl0gIT0gMSk7Ci0KLQlyZXR1cm4g
IWVycjsKLX0KLQotc3RhdGljIHZvaWQgcHJpbnRfcG93ZXJfZG9tYWlucyhzdHJ1Y3QgaTkxNV9w
b3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zLAotCQkJCWNvbnN0IGNoYXIgKnByZWZpeCwgdTY0
IG1hc2spCi17Ci0JZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW47Ci0KLQlE
Uk1fREVCVUdfRFJJVkVSKCIlcyAoJWx1KTpcbiIsIHByZWZpeCwgaHdlaWdodDY0KG1hc2spKTsK
LQlmb3JfZWFjaF9wb3dlcl9kb21haW4oZG9tYWluLCBtYXNrKQotCQlEUk1fREVCVUdfRFJJVkVS
KCIlcyB1c2VfY291bnQgJWRcbiIsCi0JCQkJIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluX3N0
cihkb21haW4pLAotCQkJCSBwb3dlcl9kb21haW5zLT5kb21haW5fdXNlX2NvdW50W2RvbWFpbl0p
OwotfQotCi1zdGF0aWMgdm9pZAotcHJpbnRfYXN5bmNfcHV0X2RvbWFpbnNfc3RhdGUoc3RydWN0
IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucykKLXsKLQlEUk1fREVCVUdfRFJJVkVS
KCJhc3luY19wdXRfd2FrZXJlZiAldVxuIiwKLQkJCSBwb3dlcl9kb21haW5zLT5hc3luY19wdXRf
d2FrZXJlZik7Ci0KLQlwcmludF9wb3dlcl9kb21haW5zKHBvd2VyX2RvbWFpbnMsICJhc3luY19w
dXRfZG9tYWluc1swXSIsCi0JCQkgICAgcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X2RvbWFpbnNb
MF0pOwotCXByaW50X3Bvd2VyX2RvbWFpbnMocG93ZXJfZG9tYWlucywgImFzeW5jX3B1dF9kb21h
aW5zWzFdIiwKLQkJCSAgICBwb3dlcl9kb21haW5zLT5hc3luY19wdXRfZG9tYWluc1sxXSk7Ci19
Ci0KLXN0YXRpYyB2b2lkCi12ZXJpZnlfYXN5bmNfcHV0X2RvbWFpbnNfc3RhdGUoc3RydWN0IGk5
MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucykKLXsKLQlpZiAoIV9fYXN5bmNfcHV0X2Rv
bWFpbnNfc3RhdGVfb2socG93ZXJfZG9tYWlucykpCi0JCXByaW50X2FzeW5jX3B1dF9kb21haW5z
X3N0YXRlKHBvd2VyX2RvbWFpbnMpOwotfQotCi0jZWxzZQotCi1zdGF0aWMgdm9pZAotYXNzZXJ0
X2FzeW5jX3B1dF9kb21haW5fbWFza3NfZGlzam9pbnQoc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlu
cyAqcG93ZXJfZG9tYWlucykKLXsKLX0KLQotc3RhdGljIHZvaWQKLXZlcmlmeV9hc3luY19wdXRf
ZG9tYWluc19zdGF0ZShzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zKQot
ewotfQotCi0jZW5kaWYgLyogQ09ORklHX0RSTV9JOTE1X0RFQlVHX1JVTlRJTUVfUE0gKi8KLQot
c3RhdGljIHU2NCBhc3luY19wdXRfZG9tYWluc19tYXNrKHN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFp
bnMgKnBvd2VyX2RvbWFpbnMpCi17Ci0JYXNzZXJ0X2FzeW5jX3B1dF9kb21haW5fbWFza3NfZGlz
am9pbnQocG93ZXJfZG9tYWlucyk7Ci0KLQlyZXR1cm4gX19hc3luY19wdXRfZG9tYWluc19tYXNr
KHBvd2VyX2RvbWFpbnMpOwotfQotCi1zdGF0aWMgdm9pZAotYXN5bmNfcHV0X2RvbWFpbnNfY2xl
YXJfZG9tYWluKHN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMsCi0JCQkg
ICAgICAgZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pCi17Ci0JYXNzZXJ0
X2FzeW5jX3B1dF9kb21haW5fbWFza3NfZGlzam9pbnQocG93ZXJfZG9tYWlucyk7Ci0KLQlwb3dl
cl9kb21haW5zLT5hc3luY19wdXRfZG9tYWluc1swXSAmPSB+QklUX1VMTChkb21haW4pOwotCXBv
d2VyX2RvbWFpbnMtPmFzeW5jX3B1dF9kb21haW5zWzFdICY9IH5CSVRfVUxMKGRvbWFpbik7Ci19
Ci0KLXN0YXRpYyBib29sCi1pbnRlbF9kaXNwbGF5X3Bvd2VyX2dyYWJfYXN5bmNfcHV0X3JlZihz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJICAgICAgIGVudW0gaW50ZWxf
ZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFp
bnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Ci0JYm9vbCByZXQg
PSBmYWxzZTsKLQotCWlmICghKGFzeW5jX3B1dF9kb21haW5zX21hc2socG93ZXJfZG9tYWlucykg
JiBCSVRfVUxMKGRvbWFpbikpKQotCQlnb3RvIG91dF92ZXJpZnk7Ci0KLQlhc3luY19wdXRfZG9t
YWluc19jbGVhcl9kb21haW4ocG93ZXJfZG9tYWlucywgZG9tYWluKTsKLQotCXJldCA9IHRydWU7
Ci0KLQlpZiAoYXN5bmNfcHV0X2RvbWFpbnNfbWFzayhwb3dlcl9kb21haW5zKSkKLQkJZ290byBv
dXRfdmVyaWZ5OwotCi0JY2FuY2VsX2RlbGF5ZWRfd29yaygmcG93ZXJfZG9tYWlucy0+YXN5bmNf
cHV0X3dvcmspOwotCWludGVsX3J1bnRpbWVfcG1fcHV0X3JhdyhkZXZfcHJpdiwKLQkJCQkgZmV0
Y2hfYW5kX3plcm8oJnBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF93YWtlcmVmKSk7Ci1vdXRfdmVy
aWZ5OgotCXZlcmlmeV9hc3luY19wdXRfZG9tYWluc19zdGF0ZShwb3dlcl9kb21haW5zKTsKLQot
CXJldHVybiByZXQ7Ci19Ci0KLXN0YXRpYyB2b2lkCi1fX2ludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0
X2RvbWFpbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0JCQkJIGVudW0gaW50
ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX2Rv
bWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Ci0Jc3RydWN0
IGk5MTVfcG93ZXJfd2VsbCAqcG93ZXJfd2VsbDsKLQotCWlmIChpbnRlbF9kaXNwbGF5X3Bvd2Vy
X2dyYWJfYXN5bmNfcHV0X3JlZihkZXZfcHJpdiwgZG9tYWluKSkKLQkJcmV0dXJuOwotCi0JZm9y
X2VhY2hfcG93ZXJfZG9tYWluX3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwsIEJJVF9VTEwoZG9t
YWluKSkKLQkJaW50ZWxfcG93ZXJfd2VsbF9nZXQoZGV2X3ByaXYsIHBvd2VyX3dlbGwpOwotCi0J
cG93ZXJfZG9tYWlucy0+ZG9tYWluX3VzZV9jb3VudFtkb21haW5dKys7Ci19Ci0KLS8qKgotICog
aW50ZWxfZGlzcGxheV9wb3dlcl9nZXQgLSBncmFiIGEgcG93ZXIgZG9tYWluIHJlZmVyZW5jZQot
ICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQotICogQGRvbWFpbjogcG93ZXIgZG9t
YWluIHRvIHJlZmVyZW5jZQotICoKLSAqIFRoaXMgZnVuY3Rpb24gZ3JhYnMgYSBwb3dlciBkb21h
aW4gcmVmZXJlbmNlIGZvciBAZG9tYWluIGFuZCBlbnN1cmVzIHRoYXQgdGhlCi0gKiBwb3dlciBk
b21haW4gYW5kIGFsbCBpdHMgcGFyZW50cyBhcmUgcG93ZXJlZCB1cC4gVGhlcmVmb3JlIHVzZXJz
IHNob3VsZCBvbmx5Ci0gKiBncmFiIGEgcmVmZXJlbmNlIHRvIHRoZSBpbm5lcm1vc3QgcG93ZXIg
ZG9tYWluIHRoZXkgbmVlZC4KLSAqCi0gKiBBbnkgcG93ZXIgZG9tYWluIHJlZmVyZW5jZSBvYnRh
aW5lZCBieSB0aGlzIGZ1bmN0aW9uIG11c3QgaGF2ZSBhIHN5bW1ldHJpYwotICogY2FsbCB0byBp
bnRlbF9kaXNwbGF5X3Bvd2VyX3B1dCgpIHRvIHJlbGVhc2UgdGhlIHJlZmVyZW5jZSBhZ2Fpbi4K
LSAqLwotaW50ZWxfd2FrZXJlZl90IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkJZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2Rv
bWFpbiBkb21haW4pCi17Ci0Jc3RydWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlu
cyA9ICZkZXZfcHJpdi0+cG93ZXJfZG9tYWluczsKLQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZiA9
IGludGVsX3J1bnRpbWVfcG1fZ2V0KGRldl9wcml2KTsKLQotCW11dGV4X2xvY2soJnBvd2VyX2Rv
bWFpbnMtPmxvY2spOwotCV9faW50ZWxfZGlzcGxheV9wb3dlcl9nZXRfZG9tYWluKGRldl9wcml2
LCBkb21haW4pOwotCW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Ci0KLQlyZXR1
cm4gd2FrZXJlZjsKLX0KLQotLyoqCi0gKiBpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFi
bGVkIC0gZ3JhYiBhIHJlZmVyZW5jZSBmb3IgYW4gZW5hYmxlZCBkaXNwbGF5IHBvd2VyIGRvbWFp
bgotICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQotICogQGRvbWFpbjogcG93ZXIg
ZG9tYWluIHRvIHJlZmVyZW5jZQotICoKLSAqIFRoaXMgZnVuY3Rpb24gZ3JhYnMgYSBwb3dlciBk
b21haW4gcmVmZXJlbmNlIGZvciBAZG9tYWluIGFuZCBlbnN1cmVzIHRoYXQgdGhlCi0gKiBwb3dl
ciBkb21haW4gYW5kIGFsbCBpdHMgcGFyZW50cyBhcmUgcG93ZXJlZCB1cC4gVGhlcmVmb3JlIHVz
ZXJzIHNob3VsZCBvbmx5Ci0gKiBncmFiIGEgcmVmZXJlbmNlIHRvIHRoZSBpbm5lcm1vc3QgcG93
ZXIgZG9tYWluIHRoZXkgbmVlZC4KLSAqCi0gKiBBbnkgcG93ZXIgZG9tYWluIHJlZmVyZW5jZSBv
YnRhaW5lZCBieSB0aGlzIGZ1bmN0aW9uIG11c3QgaGF2ZSBhIHN5bW1ldHJpYwotICogY2FsbCB0
byBpbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dCgpIHRvIHJlbGVhc2UgdGhlIHJlZmVyZW5jZSBhZ2Fp
bi4KLSAqLwotaW50ZWxfd2FrZXJlZl90Ci1pbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9pZl9lbmFi
bGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgICBlbnVtIGludGVs
X2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbikKLXsKLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21h
aW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwotCWludGVsX3dh
a2VyZWZfdCB3YWtlcmVmOwotCWJvb2wgaXNfZW5hYmxlZDsKLQotCXdha2VyZWYgPSBpbnRlbF9y
dW50aW1lX3BtX2dldF9pZl9pbl91c2UoZGV2X3ByaXYpOwotCWlmICghd2FrZXJlZikKLQkJcmV0
dXJuIGZhbHNlOwotCi0JbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Ci0KLQlpZiAo
X19pbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoZGV2X3ByaXYsIGRvbWFpbikpIHsKLQkJ
X19pbnRlbF9kaXNwbGF5X3Bvd2VyX2dldF9kb21haW4oZGV2X3ByaXYsIGRvbWFpbik7Ci0JCWlz
X2VuYWJsZWQgPSB0cnVlOwotCX0gZWxzZSB7Ci0JCWlzX2VuYWJsZWQgPSBmYWxzZTsKLQl9Ci0K
LQltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwotCi0JaWYgKCFpc19lbmFibGVk
KSB7Ci0JCWludGVsX3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKLQkJd2FrZXJl
ZiA9IDA7Ci0JfQotCi0JcmV0dXJuIHdha2VyZWY7Ci19Ci0KLXN0YXRpYyB2b2lkCi1fX2ludGVs
X2Rpc3BsYXlfcG93ZXJfcHV0X2RvbWFpbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCi0JCQkJIGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKQotewotCXN0
cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnM7Ci0Jc3RydWN0IGk5MTVfcG93
ZXJfd2VsbCAqcG93ZXJfd2VsbDsKLQljb25zdCBjaGFyICpuYW1lID0gaW50ZWxfZGlzcGxheV9w
b3dlcl9kb21haW5fc3RyKGRvbWFpbik7Ci0KLQlwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5w
b3dlcl9kb21haW5zOwotCi0JV0FSTighcG93ZXJfZG9tYWlucy0+ZG9tYWluX3VzZV9jb3VudFtk
b21haW5dLAotCSAgICAgIlVzZSBjb3VudCBvbiBkb21haW4gJXMgaXMgYWxyZWFkeSB6ZXJvXG4i
LAotCSAgICAgbmFtZSk7Ci0JV0FSTihhc3luY19wdXRfZG9tYWluc19tYXNrKHBvd2VyX2RvbWFp
bnMpICYgQklUX1VMTChkb21haW4pLAotCSAgICAgIkFzeW5jIGRpc2FibGluZyBvZiBkb21haW4g
JXMgaXMgcGVuZGluZ1xuIiwKLQkgICAgIG5hbWUpOwotCi0JcG93ZXJfZG9tYWlucy0+ZG9tYWlu
X3VzZV9jb3VudFtkb21haW5dLS07Ci0KLQlmb3JfZWFjaF9wb3dlcl9kb21haW5fd2VsbF9yZXZl
cnNlKGRldl9wcml2LCBwb3dlcl93ZWxsLCBCSVRfVUxMKGRvbWFpbikpCi0JCWludGVsX3Bvd2Vy
X3dlbGxfcHV0KGRldl9wcml2LCBwb3dlcl93ZWxsKTsKLX0KLQotc3RhdGljIHZvaWQgX19pbnRl
bF9kaXNwbGF5X3Bvd2VyX3B1dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0J
CQkJICAgICAgZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pCi17Ci0Jc3Ry
dWN0IGk5MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZkZXZfcHJpdi0+cG93ZXJf
ZG9tYWluczsKLQotCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwotCV9faW50ZWxf
ZGlzcGxheV9wb3dlcl9wdXRfZG9tYWluKGRldl9wcml2LCBkb21haW4pOwotCW11dGV4X3VubG9j
aygmcG93ZXJfZG9tYWlucy0+bG9jayk7Ci19Ci0KLS8qKgotICogaW50ZWxfZGlzcGxheV9wb3dl
cl9wdXRfdW5jaGVja2VkIC0gcmVsZWFzZSBhbiB1bmNoZWNrZWQgcG93ZXIgZG9tYWluIHJlZmVy
ZW5jZQotICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQotICogQGRvbWFpbjogcG93
ZXIgZG9tYWluIHRvIHJlZmVyZW5jZQotICoKLSAqIFRoaXMgZnVuY3Rpb24gZHJvcHMgdGhlIHBv
d2VyIGRvbWFpbiByZWZlcmVuY2Ugb2J0YWluZWQgYnkKLSAqIGludGVsX2Rpc3BsYXlfcG93ZXJf
Z2V0KCkgYW5kIG1pZ2h0IHBvd2VyIGRvd24gdGhlIGNvcnJlc3BvbmRpbmcgaGFyZHdhcmUKLSAq
IGJsb2NrIHJpZ2h0IGF3YXkgaWYgdGhpcyBpcyB0aGUgbGFzdCByZWZlcmVuY2UuCi0gKgotICog
VGhpcyBmdW5jdGlvbiBleGlzdHMgb25seSBmb3IgaGlzdG9yaWNhbCByZWFzb25zIGFuZCBzaG91
bGQgYmUgYXZvaWRlZCBpbgotICogbmV3IGNvZGUsIGFzIHRoZSBjb3JyZWN0bmVzcyBvZiBpdHMg
dXNlIGNhbm5vdCBiZSBjaGVja2VkLiBBbHdheXMgdXNlCi0gKiBpbnRlbF9kaXNwbGF5X3Bvd2Vy
X3B1dCgpIGluc3RlYWQuCi0gKi8KLXZvaWQgaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVj
a2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgICAgICAgZW51bSBp
bnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4pCi17Ci0JX19pbnRlbF9kaXNwbGF5X3Bv
d2VyX3B1dChkZXZfcHJpdiwgZG9tYWluKTsKLQlpbnRlbF9ydW50aW1lX3BtX3B1dF91bmNoZWNr
ZWQoZGV2X3ByaXYpOwotfQotCi1zdGF0aWMgdm9pZAotcXVldWVfYXN5bmNfcHV0X2RvbWFpbnNf
d29yayhzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zLAotCQkJICAgICBp
bnRlbF93YWtlcmVmX3Qgd2FrZXJlZikKLXsKLQlXQVJOX09OKHBvd2VyX2RvbWFpbnMtPmFzeW5j
X3B1dF93YWtlcmVmKTsKLQlwb3dlcl9kb21haW5zLT5hc3luY19wdXRfd2FrZXJlZiA9IHdha2Vy
ZWY7Ci0JV0FSTl9PTighcXVldWVfZGVsYXllZF93b3JrKHN5c3RlbV91bmJvdW5kX3dxLAotCQkJ
CSAgICAmcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X3dvcmssCi0JCQkJICAgIG1zZWNzX3RvX2pp
ZmZpZXMoMTAwKSkpOwotfQotCi1zdGF0aWMgdm9pZAotcmVsZWFzZV9hc3luY19wdXRfZG9tYWlu
cyhzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zLCB1NjQgbWFzaykKLXsK
LQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPQotCQljb250YWluZXJfb2YocG93
ZXJfZG9tYWlucywgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUsCi0JCQkgICAgIHBvd2VyX2RvbWFp
bnMpOwotCWVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluOwotCWludGVsX3dh
a2VyZWZfdCB3YWtlcmVmOwotCi0JLyoKLQkgKiBUaGUgY2FsbGVyIG11c3QgaG9sZCBhbHJlYWR5
IHJhdyB3YWtlcmVmLCB1cGdyYWRlIHRoYXQgdG8gYSBwcm9wZXIKLQkgKiB3YWtlcmVmIHRvIG1h
a2UgdGhlIHN0YXRlIGNoZWNrZXIgaGFwcHkgYWJvdXQgdGhlIEhXIGFjY2VzcyBkdXJpbmcKLQkg
KiBwb3dlciB3ZWxsIGRpc2FibGluZy4KLQkgKi8KLQlhc3NlcnRfcnBtX3Jhd193YWtlcmVmX2hl
bGQoZGV2X3ByaXYpOwotCXdha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldChkZXZfcHJpdik7
Ci0KLQlmb3JfZWFjaF9wb3dlcl9kb21haW4oZG9tYWluLCBtYXNrKSB7Ci0JCS8qIENsZWFyIGJl
Zm9yZSBwdXQsIHNvIHB1dCdzIHNhbml0eSBjaGVjayBpcyBoYXBweS4gKi8KLQkJYXN5bmNfcHV0
X2RvbWFpbnNfY2xlYXJfZG9tYWluKHBvd2VyX2RvbWFpbnMsIGRvbWFpbik7Ci0JCV9faW50ZWxf
ZGlzcGxheV9wb3dlcl9wdXRfZG9tYWluKGRldl9wcml2LCBkb21haW4pOwotCX0KLQotCWludGVs
X3J1bnRpbWVfcG1fcHV0KGRldl9wcml2LCB3YWtlcmVmKTsKLX0KLQotc3RhdGljIHZvaWQKLWlu
dGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3Jr
KQotewotCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9Ci0JCWNvbnRhaW5lcl9v
Zih3b3JrLCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSwKLQkJCSAgICAgcG93ZXJfZG9tYWlucy5h
c3luY19wdXRfd29yay53b3JrKTsKLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9k
b21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwotCWludGVsX3dha2VyZWZfdCBuZXdf
d29ya193YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXRfcmF3KGRldl9wcml2KTsKLQlpbnRl
bF93YWtlcmVmX3Qgb2xkX3dvcmtfd2FrZXJlZiA9IDA7Ci0KLQltdXRleF9sb2NrKCZwb3dlcl9k
b21haW5zLT5sb2NrKTsKLQotCS8qCi0JICogQmFpbCBvdXQgaWYgYWxsIHRoZSBkb21haW4gcmVm
cyBwZW5kaW5nIHRvIGJlIHJlbGVhc2VkIHdlcmUgZ3JhYmJlZAotCSAqIGJ5IHN1YnNlcXVlbnQg
Z2V0cyBvciBhIGZsdXNoX3dvcmsuCi0JICovCi0Jb2xkX3dvcmtfd2FrZXJlZiA9IGZldGNoX2Fu
ZF96ZXJvKCZwb3dlcl9kb21haW5zLT5hc3luY19wdXRfd2FrZXJlZik7Ci0JaWYgKCFvbGRfd29y
a193YWtlcmVmKQotCQlnb3RvIG91dF92ZXJpZnk7Ci0KLQlyZWxlYXNlX2FzeW5jX3B1dF9kb21h
aW5zKHBvd2VyX2RvbWFpbnMsCi0JCQkJICBwb3dlcl9kb21haW5zLT5hc3luY19wdXRfZG9tYWlu
c1swXSk7Ci0KLQkvKiBSZXF1ZXVlIHRoZSB3b3JrIGlmIG1vcmUgZG9tYWlucyB3ZXJlIGFzeW5j
IHB1dCBtZWFud2hpbGUuICovCi0JaWYgKHBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF9kb21haW5z
WzFdKSB7Ci0JCXBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF9kb21haW5zWzBdID0KLQkJCWZldGNo
X2FuZF96ZXJvKCZwb3dlcl9kb21haW5zLT5hc3luY19wdXRfZG9tYWluc1sxXSk7Ci0JCXF1ZXVl
X2FzeW5jX3B1dF9kb21haW5zX3dvcmsocG93ZXJfZG9tYWlucywKLQkJCQkJICAgICBmZXRjaF9h
bmRfemVybygmbmV3X3dvcmtfd2FrZXJlZikpOwotCX0KLQotb3V0X3ZlcmlmeToKLQl2ZXJpZnlf
YXN5bmNfcHV0X2RvbWFpbnNfc3RhdGUocG93ZXJfZG9tYWlucyk7Ci0KLQltdXRleF91bmxvY2so
JnBvd2VyX2RvbWFpbnMtPmxvY2spOwotCi0JaWYgKG9sZF93b3JrX3dha2VyZWYpCi0JCWludGVs
X3J1bnRpbWVfcG1fcHV0X3JhdyhkZXZfcHJpdiwgb2xkX3dvcmtfd2FrZXJlZik7Ci0JaWYgKG5l
d193b3JrX3dha2VyZWYpCi0JCWludGVsX3J1bnRpbWVfcG1fcHV0X3JhdyhkZXZfcHJpdiwgbmV3
X3dvcmtfd2FrZXJlZik7Ci19Ci0KLS8qKgotICogaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfYXN5
bmMgLSByZWxlYXNlIGEgcG93ZXIgZG9tYWluIHJlZmVyZW5jZSBhc3luY2hyb25vdXNseQotICog
QGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCi0gKiBAZG9tYWluOiBwb3dlciBkb21haW4gdG8g
cmVmZXJlbmNlCi0gKiBAd2FrZXJlZjogd2FrZXJlZiBhY3F1aXJlZCBmb3IgdGhlIHJlZmVyZW5j
ZSB0aGF0IGlzIGJlaW5nIHJlbGVhc2VkCi0gKgotICogVGhpcyBmdW5jdGlvbiBkcm9wcyB0aGUg
cG93ZXIgZG9tYWluIHJlZmVyZW5jZSBvYnRhaW5lZCBieQotICogaW50ZWxfZGlzcGxheV9wb3dl
cl9nZXQqKCkgYW5kIHNjaGVkdWxlcyBhIHdvcmsgdG8gcG93ZXIgZG93biB0aGUKLSAqIGNvcnJl
c3BvbmRpbmcgaGFyZHdhcmUgYmxvY2sgaWYgdGhpcyBpcyB0aGUgbGFzdCByZWZlcmVuY2UuCi0g
Ki8KLXZvaWQgX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dF9hc3luYyhzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwKLQkJCQkgICAgIGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4g
ZG9tYWluLAotCQkJCSAgICAgaW50ZWxfd2FrZXJlZl90IHdha2VyZWYpCi17Ci0Jc3RydWN0IGk5
MTVfcG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOwot
CWludGVsX3dha2VyZWZfdCB3b3JrX3dha2VyZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldF9yYXco
aTkxNSk7Ci0KLQltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKLQotCWlmIChwb3dl
cl9kb21haW5zLT5kb21haW5fdXNlX2NvdW50W2RvbWFpbl0gPiAxKSB7Ci0JCV9faW50ZWxfZGlz
cGxheV9wb3dlcl9wdXRfZG9tYWluKGk5MTUsIGRvbWFpbik7Ci0KLQkJZ290byBvdXRfdmVyaWZ5
OwotCX0KLQotCVdBUk5fT04ocG93ZXJfZG9tYWlucy0+ZG9tYWluX3VzZV9jb3VudFtkb21haW5d
ICE9IDEpOwotCi0JLyogTGV0IGEgcGVuZGluZyB3b3JrIHJlcXVldWUgaXRzZWxmIG9yIHF1ZXVl
IGEgbmV3IG9uZS4gKi8KLQlpZiAocG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X3dha2VyZWYpIHsK
LQkJcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X2RvbWFpbnNbMV0gfD0gQklUX1VMTChkb21haW4p
OwotCX0gZWxzZSB7Ci0JCXBvd2VyX2RvbWFpbnMtPmFzeW5jX3B1dF9kb21haW5zWzBdIHw9IEJJ
VF9VTEwoZG9tYWluKTsKLQkJcXVldWVfYXN5bmNfcHV0X2RvbWFpbnNfd29yayhwb3dlcl9kb21h
aW5zLAotCQkJCQkgICAgIGZldGNoX2FuZF96ZXJvKCZ3b3JrX3dha2VyZWYpKTsKLQl9Ci0KLW91
dF92ZXJpZnk6Ci0JdmVyaWZ5X2FzeW5jX3B1dF9kb21haW5zX3N0YXRlKHBvd2VyX2RvbWFpbnMp
OwotCi0JbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKLQotCWlmICh3b3JrX3dh
a2VyZWYpCi0JCWludGVsX3J1bnRpbWVfcG1fcHV0X3JhdyhpOTE1LCB3b3JrX3dha2VyZWYpOwot
Ci0JaW50ZWxfcnVudGltZV9wbV9wdXQoaTkxNSwgd2FrZXJlZik7Ci19Ci0KLS8qKgotICogaW50
ZWxfZGlzcGxheV9wb3dlcl9mbHVzaF93b3JrIC0gZmx1c2hlcyB0aGUgYXN5bmMgZGlzcGxheSBw
b3dlciBkaXNhYmxpbmcgd29yawotICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCi0gKgot
ICogRmx1c2hlcyBhbnkgcGVuZGluZyB3b3JrIHRoYXQgd2FzIHNjaGVkdWxlZCBieSBhIHByZWNl
ZGluZwotICogaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfYXN5bmMoKSBjYWxsLCBjb21wbGV0aW5n
IHRoZSBkaXNhYmxpbmcgb2YgdGhlCi0gKiBjb3JyZXNwb25kaW5nIHBvd2VyIGRvbWFpbnMuCi0g
KgotICogTm90ZSB0aGF0IHRoZSB3b3JrIGhhbmRsZXIgZnVuY3Rpb24gbWF5IHN0aWxsIGJlIHJ1
bm5pbmcgYWZ0ZXIgdGhpcwotICogZnVuY3Rpb24gcmV0dXJuczsgdG8gZW5zdXJlIHRoYXQgdGhl
IHdvcmsgaGFuZGxlciBpc24ndCBydW5uaW5nIHVzZQotICogaW50ZWxfZGlzcGxheV9wb3dlcl9m
bHVzaF93b3JrX3N5bmMoKSBpbnN0ZWFkLgotICovCi12b2lkIGludGVsX2Rpc3BsYXlfcG93ZXJf
Zmx1c2hfd29yayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKLXsKLQlzdHJ1Y3QgaTkx
NV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Ci0J
aW50ZWxfd2FrZXJlZl90IHdvcmtfd2FrZXJlZjsKLQotCW11dGV4X2xvY2soJnBvd2VyX2RvbWFp
bnMtPmxvY2spOwotCi0Jd29ya193YWtlcmVmID0gZmV0Y2hfYW5kX3plcm8oJnBvd2VyX2RvbWFp
bnMtPmFzeW5jX3B1dF93YWtlcmVmKTsKLQlpZiAoIXdvcmtfd2FrZXJlZikKLQkJZ290byBvdXRf
dmVyaWZ5OwotCi0JcmVsZWFzZV9hc3luY19wdXRfZG9tYWlucyhwb3dlcl9kb21haW5zLAotCQkJ
CSAgYXN5bmNfcHV0X2RvbWFpbnNfbWFzayhwb3dlcl9kb21haW5zKSk7Ci0JY2FuY2VsX2RlbGF5
ZWRfd29yaygmcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X3dvcmspOwotCi1vdXRfdmVyaWZ5Ogot
CXZlcmlmeV9hc3luY19wdXRfZG9tYWluc19zdGF0ZShwb3dlcl9kb21haW5zKTsKLQotCW11dGV4
X3VubG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Ci0KLQlpZiAod29ya193YWtlcmVmKQotCQlp
bnRlbF9ydW50aW1lX3BtX3B1dF9yYXcoaTkxNSwgd29ya193YWtlcmVmKTsKLX0KLQotLyoqCi0g
KiBpbnRlbF9kaXNwbGF5X3Bvd2VyX2ZsdXNoX3dvcmtfc3luYyAtIGZsdXNoZXMgYW5kIHN5bmNz
IHRoZSBhc3luYyBkaXNwbGF5IHBvd2VyIGRpc2FibGluZyB3b3JrCi0gKiBAaTkxNTogaTkxNSBk
ZXZpY2UgaW5zdGFuY2UKLSAqCi0gKiBMaWtlIGludGVsX2Rpc3BsYXlfcG93ZXJfZmx1c2hfd29y
aygpLCBidXQgYWxzbyBlbnN1cmUgdGhhdCB0aGUgd29yawotICogaGFuZGxlciBmdW5jdGlvbiBp
cyBub3QgcnVubmluZyBhbnkgbW9yZSB3aGVuIHRoaXMgZnVuY3Rpb24gcmV0dXJucy4KLSAqLwot
c3RhdGljIHZvaWQKLWludGVsX2Rpc3BsYXlfcG93ZXJfZmx1c2hfd29ya19zeW5jKHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICppOTE1KQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBv
d2VyX2RvbWFpbnMgPSAmaTkxNS0+cG93ZXJfZG9tYWluczsKLQotCWludGVsX2Rpc3BsYXlfcG93
ZXJfZmx1c2hfd29yayhpOTE1KTsKLQljYW5jZWxfZGVsYXllZF93b3JrX3N5bmMoJnBvd2VyX2Rv
bWFpbnMtPmFzeW5jX3B1dF93b3JrKTsKLQotCXZlcmlmeV9hc3luY19wdXRfZG9tYWluc19zdGF0
ZShwb3dlcl9kb21haW5zKTsKLQotCVdBUk5fT04ocG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X3dh
a2VyZWYpOwotfQotCi0jaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfUlVOVElN
RV9QTSkKLS8qKgotICogaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQgLSByZWxlYXNlIGEgcG93ZXIg
ZG9tYWluIHJlZmVyZW5jZQotICogQGRldl9wcml2OiBpOTE1IGRldmljZSBpbnN0YW5jZQotICog
QGRvbWFpbjogcG93ZXIgZG9tYWluIHRvIHJlZmVyZW5jZQotICogQHdha2VyZWY6IHdha2VyZWYg
YWNxdWlyZWQgZm9yIHRoZSByZWZlcmVuY2UgdGhhdCBpcyBiZWluZyByZWxlYXNlZAotICoKLSAq
IFRoaXMgZnVuY3Rpb24gZHJvcHMgdGhlIHBvd2VyIGRvbWFpbiByZWZlcmVuY2Ugb2J0YWluZWQg
YnkKLSAqIGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KCkgYW5kIG1pZ2h0IHBvd2VyIGRvd24gdGhl
IGNvcnJlc3BvbmRpbmcgaGFyZHdhcmUKLSAqIGJsb2NrIHJpZ2h0IGF3YXkgaWYgdGhpcyBpcyB0
aGUgbGFzdCByZWZlcmVuY2UuCi0gKi8KLXZvaWQgaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJICAgICBlbnVtIGludGVsX2Rpc3Bs
YXlfcG93ZXJfZG9tYWluIGRvbWFpbiwKLQkJCSAgICAgaW50ZWxfd2FrZXJlZl90IHdha2VyZWYp
Ci17Ci0JX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1dChkZXZfcHJpdiwgZG9tYWluKTsKLQlpbnRl
bF9ydW50aW1lX3BtX3B1dChkZXZfcHJpdiwgd2FrZXJlZik7Ci19Ci0jZW5kaWYKLQotI2RlZmlu
ZSBJODMwX1BJUEVTX1BPV0VSX0RPTUFJTlMgKAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJ
UEVfQSkgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQikgfAkJXAotCUJJVF9VTEwo
UE9XRVJfRE9NQUlOX1BJUEVfQV9QQU5FTF9GSVRURVIpIHwJXAotCUJJVF9VTEwoUE9XRVJfRE9N
QUlOX1BJUEVfQl9QQU5FTF9GSVRURVIpIHwJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5T
Q09ERVJfQSkgfAlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9CKSB8CVwKLQlC
SVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKLQotI2RlZmluZSBWTFZfRElTUExBWV9QT1dFUl9E
T01BSU5TICgJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9ESVNQTEFZX0NPUkUpIHwJXAotCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQSkgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJ
UEVfQikgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQV9QQU5FTF9GSVRURVIpIHwJ
XAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQl9QQU5FTF9GSVRURVIpIHwJXAotCUJJVF9V
TEwoUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQSkgfAlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5f
VFJBTlNDT0RFUl9CKSB8CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9CX0xBTkVT
KSB8CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9DX0xBTkVTKSB8CVwKLQlCSVRf
VUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RTSSkgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BP
UlRfQ1JUKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fVkdBKSB8CQkJXAotCUJJVF9VTEwo
UE9XRVJfRE9NQUlOX0FVRElPKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0IpIHwJ
CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQykgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9N
QUlOX0dNQlVTKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCi0KLSNkZWZpbmUg
VkxWX0RQSU9fQ01OX0JDX1BPV0VSX0RPTUFJTlMgKAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlO
X1BPUlRfRERJX0JfTEFORVMpIHwJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0Nf
TEFORVMpIHwJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfQ1JUKSB8CQlcCi0JQklUX1VM
TChQT1dFUl9ET01BSU5fQVVYX0IpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQykg
fAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQotCi0jZGVmaW5lIFZMVl9EUElPX1RY
X0JfTEFORVNfMDFfUE9XRVJfRE9NQUlOUyAoCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JU
X0RESV9CX0xBTkVTKSB8CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQikgfAkJXAotCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQotCi0jZGVmaW5lIFZMVl9EUElPX1RYX0JfTEFORVNf
MjNfUE9XRVJfRE9NQUlOUyAoCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9CX0xB
TkVTKSB8CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQikgfAkJXAotCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX0lOSVQpKQotCi0jZGVmaW5lIFZMVl9EUElPX1RYX0NfTEFORVNfMDFfUE9XRVJf
RE9NQUlOUyAoCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9DX0xBTkVTKSB8CVwK
LQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQykgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlO
X0lOSVQpKQotCi0jZGVmaW5lIFZMVl9EUElPX1RYX0NfTEFORVNfMjNfUE9XRVJfRE9NQUlOUyAo
CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9DX0xBTkVTKSB8CVwKLQlCSVRfVUxM
KFBPV0VSX0RPTUFJTl9BVVhfQykgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQot
Ci0jZGVmaW5lIENIVl9ESVNQTEFZX1BPV0VSX0RPTUFJTlMgKAkJXAotCUJJVF9VTEwoUE9XRVJf
RE9NQUlOX0RJU1BMQVlfQ09SRSkgfAlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9BKSB8
CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9CKSB8CQlcCi0JQklUX1VMTChQT1dFUl9E
T01BSU5fUElQRV9DKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9BX1BBTkVMX0ZJ
VFRFUikgfAlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9CX1BBTkVMX0ZJVFRFUikgfAlc
Ci0JQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9DX1BBTkVMX0ZJVFRFUikgfAlcCi0JQklUX1VM
TChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9BKSB8CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9U
UkFOU0NPREVSX0IpIHwJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQykgfAlc
Ci0JQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQl9MQU5FUykgfAlcCi0JQklUX1VMTChQ
T1dFUl9ET01BSU5fUE9SVF9ERElfQ19MQU5FUykgfAlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5f
UE9SVF9ERElfRF9MQU5FUykgfAlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9EU0kpIHwJ
CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9WR0EpIHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01B
SU5fQVVESU8pIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQikgfAkJXAotCUJJVF9V
TEwoUE9XRVJfRE9NQUlOX0FVWF9DKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0Qp
IHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9HTUJVUykgfAkJXAotCUJJVF9VTEwoUE9XRVJf
RE9NQUlOX0lOSVQpKQotCi0jZGVmaW5lIENIVl9EUElPX0NNTl9CQ19QT1dFUl9ET01BSU5TICgJ
CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9CX0xBTkVTKSB8CVwKLQlCSVRfVUxM
KFBPV0VSX0RPTUFJTl9QT1JUX0RESV9DX0xBTkVTKSB8CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJ
Tl9BVVhfQikgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9DKSB8CQlcCi0JQklUX1VM
TChQT1dFUl9ET01BSU5fSU5JVCkpCi0KLSNkZWZpbmUgQ0hWX0RQSU9fQ01OX0RfUE9XRVJfRE9N
QUlOUyAoCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfRF9MQU5FUykgfAlcCi0J
QklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0QpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9J
TklUKSkKLQotI2RlZmluZSBIU1dfRElTUExBWV9QT1dFUl9ET01BSU5TICgJCQlcCi0JQklUX1VM
TChQT1dFUl9ET01BSU5fUElQRV9CKSB8CQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVf
QykgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0FfUEFORUxfRklUVEVSKSB8CQlc
Ci0JQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9CX1BBTkVMX0ZJVFRFUikgfAkJXAotCUJJVF9V
TEwoUE9XRVJfRE9NQUlOX1BJUEVfQ19QQU5FTF9GSVRURVIpIHwJCVwKLQlCSVRfVUxMKFBPV0VS
X0RPTUFJTl9UUkFOU0NPREVSX0EpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NP
REVSX0IpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0MpIHwJCVwKLQlC
SVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9CX0xBTkVTKSB8CQlcCi0JQklUX1VMTChQT1dF
Ul9ET01BSU5fUE9SVF9ERElfQ19MQU5FUykgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BP
UlRfRERJX0RfTEFORVMpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0NSVCkgfCAv
KiBEREkgRSAqLwlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fVkdBKSB8CQkJCVwKLQlCSVRfVUxM
KFBPV0VSX0RPTUFJTl9BVURJTykgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkK
LQotI2RlZmluZSBCRFdfRElTUExBWV9QT1dFUl9ET01BSU5TICgJCQlcCi0JQklUX1VMTChQT1dF
Ul9ET01BSU5fUElQRV9CKSB8CQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQykgfAkJ
CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0JfUEFORUxfRklUVEVSKSB8CQlcCi0JQklU
X1VMTChQT1dFUl9ET01BSU5fUElQRV9DX1BBTkVMX0ZJVFRFUikgfAkJXAotCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX1RSQU5TQ09ERVJfQSkgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5T
Q09ERVJfQikgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQykgfAkJXAot
CUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfTEFORVMpIHwJCVwKLQlCSVRfVUxMKFBP
V0VSX0RPTUFJTl9QT1JUX0RESV9DX0xBTkVTKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5f
UE9SVF9ERElfRF9MQU5FUykgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfQ1JUKSB8
IC8qIERESSBFICovCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9WR0EpIHwJCQkJXAotCUJJVF9V
TEwoUE9XRVJfRE9NQUlOX0FVRElPKSB8CQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQp
KQotCi0jZGVmaW5lIFNLTF9ESVNQTEFZX1BPV0VSV0VMTF8yX1BPV0VSX0RPTUFJTlMgKAkJXAot
CUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQSkgfAkJXAotCUJJVF9VTEwoUE9XRVJf
RE9NQUlOX1BJUEVfQikgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0Ip
IHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0MpIHwJCQlcCi0JQklUX1VMTChQT1dF
Ul9ET01BSU5fVFJBTlNDT0RFUl9DKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9C
X1BBTkVMX0ZJVFRFUikgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQ19QQU5FTF9G
SVRURVIpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9CX0xBTkVTKSB8CQlc
Ci0JQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQ19MQU5FUykgfAkJXAotCUJJVF9VTEwo
UE9XRVJfRE9NQUlOX1BPUlRfRERJX0RfTEFORVMpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJ
Tl9QT1JUX0RESV9FX0xBTkVTKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0IpIHwg
ICAgICAgICAgICAgICAgICAgICAgIFwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQykgfAkJ
CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfRCkgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9BVURJTykgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9WR0EpIHwJCQkJXAotCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQotI2RlZmluZSBTS0xfRElTUExBWV9ERElfSU9fQV9F
X1BPV0VSX0RPTUFJTlMgKAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0FfSU8p
IHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9FX0lPKSB8CQlcCi0JQklUX1VM
TChQT1dFUl9ET01BSU5fSU5JVCkpCi0jZGVmaW5lIFNLTF9ESVNQTEFZX0RESV9JT19CX1BPV0VS
X0RPTUFJTlMgKAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfSU8pIHwJCVwK
LQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKLSNkZWZpbmUgU0tMX0RJU1BMQVlfRERJX0lP
X0NfUE9XRVJfRE9NQUlOUyAoCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQ19J
TykgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQotI2RlZmluZSBTS0xfRElTUExB
WV9ERElfSU9fRF9QT1dFUl9ET01BSU5TICgJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JU
X0RESV9EX0lPKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCi0jZGVmaW5lIFNL
TF9ESVNQTEFZX0RDX09GRl9QT1dFUl9ET01BSU5TICgJCVwKLQlTS0xfRElTUExBWV9QT1dFUldF
TExfMl9QT1dFUl9ET01BSU5TIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9HVF9JUlEpIHwJ
CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fTU9ERVNFVCkgfAkJCVwKLQlCSVRfVUxMKFBPV0VS
X0RPTUFJTl9BVVhfQSkgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKLQotI2Rl
ZmluZSBCWFRfRElTUExBWV9QT1dFUldFTExfMl9QT1dFUl9ET01BSU5TICgJCVwKLQlCSVRfVUxM
KFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0EpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9Q
SVBFX0IpIHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9CKSB8CQlcCi0J
QklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9DKSB8CQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlO
X1RSQU5TQ09ERVJfQykgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQl9QQU5FTF9G
SVRURVIpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0NfUEFORUxfRklUVEVSKSB8
CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQl9MQU5FUykgfAkJXAotCUJJVF9V
TEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0NfTEFORVMpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9BVVhfQikgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQykgfAkJCVwKLQlC
SVRfVUxMKFBPV0VSX0RPTUFJTl9BVURJTykgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9W
R0EpIHwJCQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQotI2RlZmluZSBCWFRfRElT
UExBWV9EQ19PRkZfUE9XRVJfRE9NQUlOUyAoCQlcCi0JQlhUX0RJU1BMQVlfUE9XRVJXRUxMXzJf
UE9XRVJfRE9NQUlOUyB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fR1RfSVJRKSB8CQkJXAot
CUJJVF9VTEwoUE9XRVJfRE9NQUlOX01PREVTRVQpIHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01B
SU5fQVVYX0EpIHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fR01CVVMpIHwJCQlcCi0JQklU
X1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCi0jZGVmaW5lIEJYVF9EUElPX0NNTl9BX1BPV0VSX0RP
TUFJTlMgKAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9BX0xBTkVTKSB8CQlc
Ci0JQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0EpIHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01B
SU5fSU5JVCkpCi0jZGVmaW5lIEJYVF9EUElPX0NNTl9CQ19QT1dFUl9ET01BSU5TICgJCQlcCi0J
QklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQl9MQU5FUykgfAkJXAotCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX1BPUlRfRERJX0NfTEFORVMpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9B
VVhfQikgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQykgfAkJCVwKLQlCSVRfVUxM
KFBPV0VSX0RPTUFJTl9JTklUKSkKLQotI2RlZmluZSBHTEtfRElTUExBWV9QT1dFUldFTExfMl9Q
T1dFUl9ET01BSU5TICgJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0EpIHwJ
CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QSVBFX0IpIHwJCQlcCi0JQklUX1VMTChQT1dFUl9E
T01BSU5fVFJBTlNDT0RFUl9CKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9DKSB8
CQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RSQU5TQ09ERVJfQykgfAkJXAotCUJJVF9VTEwo
UE9XRVJfRE9NQUlOX1BJUEVfQl9QQU5FTF9GSVRURVIpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9QSVBFX0NfUEFORUxfRklUVEVSKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUE9S
VF9ERElfQl9MQU5FUykgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0NfTEFO
RVMpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQikgfCAgICAgICAgICAgICAgICAg
ICAgICAgXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9DKSB8CQkJXAotCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX0FVRElPKSB8CQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1ZHQSkgfAkJCQlc
Ci0JQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCi0jZGVmaW5lIEdMS19ESVNQTEFZX0RESV9J
T19BX1BPV0VSX0RPTUFJTlMgKAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0Ff
SU8pKQotI2RlZmluZSBHTEtfRElTUExBWV9ERElfSU9fQl9QT1dFUl9ET01BSU5TICgJCVwKLQlC
SVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9CX0lPKSkKLSNkZWZpbmUgR0xLX0RJU1BMQVlf
RERJX0lPX0NfUE9XRVJfRE9NQUlOUyAoCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9E
RElfQ19JTykpCi0jZGVmaW5lIEdMS19EUElPX0NNTl9BX1BPV0VSX0RPTUFJTlMgKAkJCVwKLQlC
SVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9BX0xBTkVTKSB8CQlcCi0JQklUX1VMTChQT1dF
Ul9ET01BSU5fQVVYX0EpIHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCi0jZGVm
aW5lIEdMS19EUElPX0NNTl9CX1BPV0VSX0RPTUFJTlMgKAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9QT1JUX0RESV9CX0xBTkVTKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0Ip
IHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCi0jZGVmaW5lIEdMS19EUElPX0NN
Tl9DX1BPV0VSX0RPTUFJTlMgKAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9D
X0xBTkVTKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0MpIHwJCQlcCi0JQklUX1VM
TChQT1dFUl9ET01BSU5fSU5JVCkpCi0jZGVmaW5lIEdMS19ESVNQTEFZX0FVWF9BX1BPV0VSX0RP
TUFJTlMgKAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9BKSB8CQlcCi0JQklUX1VMTChQ
T1dFUl9ET01BSU5fQVVYX0lPX0EpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkK
LSNkZWZpbmUgR0xLX0RJU1BMQVlfQVVYX0JfUE9XRVJfRE9NQUlOUyAoCQlcCi0JQklUX1VMTChQ
T1dFUl9ET01BSU5fQVVYX0IpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKLSNk
ZWZpbmUgR0xLX0RJU1BMQVlfQVVYX0NfUE9XRVJfRE9NQUlOUyAoCQlcCi0JQklUX1VMTChQT1dF
Ul9ET01BSU5fQVVYX0MpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKLSNkZWZp
bmUgR0xLX0RJU1BMQVlfRENfT0ZGX1BPV0VSX0RPTUFJTlMgKAkJXAotCUdMS19ESVNQTEFZX1BP
V0VSV0VMTF8yX1BPV0VSX0RPTUFJTlMgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0dUX0lS
USkgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9NT0RFU0VUKSB8CQkJXAotCUJJVF9VTEwo
UE9XRVJfRE9NQUlOX0FVWF9BKSB8CQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0dNQlVTKSB8
CQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQotCi0jZGVmaW5lIENOTF9ESVNQTEFZ
X1BPV0VSV0VMTF8yX1BPV0VSX0RPTUFJTlMgKAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1RS
QU5TQ09ERVJfQSkgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQikgfAkJCVwKLQlC
SVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0IpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9QSVBFX0MpIHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9DKSB8
CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUElQRV9CX1BBTkVMX0ZJVFRFUikgfAkJXAotCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQ19QQU5FTF9GSVRURVIpIHwJCVwKLQlCSVRfVUxMKFBP
V0VSX0RPTUFJTl9QT1JUX0RESV9CX0xBTkVTKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5f
UE9SVF9ERElfQ19MQU5FUykgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0Rf
TEFORVMpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9GX0xBTkVTKSB8CQlc
Ci0JQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0IpIHwgICAgICAgICAgICAgICAgICAgICAgIFwK
LQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQykgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJ
Tl9BVVhfRCkgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfRikgfAkJCVwKLQlCSVRf
VUxMKFBPV0VSX0RPTUFJTl9BVURJTykgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9WR0Ep
IHwJCQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQotI2RlZmluZSBDTkxfRElTUExB
WV9ERElfQV9JT19QT1dFUl9ET01BSU5TICgJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JU
X0RESV9BX0lPKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCi0jZGVmaW5lIENO
TF9ESVNQTEFZX0RESV9CX0lPX1BPV0VSX0RPTUFJTlMgKAkJXAotCUJJVF9VTEwoUE9XRVJfRE9N
QUlOX1BPUlRfRERJX0JfSU8pIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKLSNk
ZWZpbmUgQ05MX0RJU1BMQVlfRERJX0NfSU9fUE9XRVJfRE9NQUlOUyAoCQlcCi0JQklUX1VMTChQ
T1dFUl9ET01BSU5fUE9SVF9ERElfQ19JTykgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lO
SVQpKQotI2RlZmluZSBDTkxfRElTUExBWV9ERElfRF9JT19QT1dFUl9ET01BSU5TICgJCVwKLQlC
SVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9EX0lPKSB8CQlcCi0JQklUX1VMTChQT1dFUl9E
T01BSU5fSU5JVCkpCi0jZGVmaW5lIENOTF9ESVNQTEFZX0FVWF9BX1BPV0VSX0RPTUFJTlMgKAkJ
XAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9BKSB8CQkJXAotCUJJVF9VTEwoUE9XRVJfRE9N
QUlOX0FVWF9JT19BKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCi0jZGVmaW5l
IENOTF9ESVNQTEFZX0FVWF9CX1BPV0VSX0RPTUFJTlMgKAkJXAotCUJJVF9VTEwoUE9XRVJfRE9N
QUlOX0FVWF9CKSB8CQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQotI2RlZmluZSBD
TkxfRElTUExBWV9BVVhfQ19QT1dFUl9ET01BSU5TICgJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJ
Tl9BVVhfQykgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKLSNkZWZpbmUgQ05M
X0RJU1BMQVlfQVVYX0RfUE9XRVJfRE9NQUlOUyAoCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5f
QVVYX0QpIHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCi0jZGVmaW5lIENOTF9E
SVNQTEFZX0FVWF9GX1BPV0VSX0RPTUFJTlMgKAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FV
WF9GKSB8CQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0lOSVQpKQotI2RlZmluZSBDTkxfRElT
UExBWV9ERElfRl9JT19QT1dFUl9ET01BSU5TICgJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9Q
T1JUX0RESV9GX0lPKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fSU5JVCkpCi0jZGVmaW5l
IENOTF9ESVNQTEFZX0RDX09GRl9QT1dFUl9ET01BSU5TICgJCVwKLQlDTkxfRElTUExBWV9QT1dF
UldFTExfMl9QT1dFUl9ET01BSU5TIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9HVF9JUlEp
IHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fTU9ERVNFVCkgfAkJCVwKLQlCSVRfVUxMKFBP
V0VSX0RPTUFJTl9BVVhfQSkgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKLQot
LyoKLSAqIElDTCBQV18wL1BHXzAgZG9tYWlucyAoSFcvRE1DIGNvbnRyb2wpOgotICogLSBQQ0kK
LSAqIC0gY2xvY2tzIGV4Y2VwdCBwb3J0IFBMTAotICogLSBjZW50cmFsIHBvd2VyIGV4Y2VwdCBG
QkMKLSAqIC0gc2hhcmVkIGZ1bmN0aW9ucyBleGNlcHQgcGlwZSBpbnRlcnJ1cHRzLCBwaXBlIE1C
VVMsIERCVUYgcmVnaXN0ZXJzCi0gKiBJQ0wgUFdfMS9QR18xIGRvbWFpbnMgKEhXL0RNQyBjb250
cm9sKToKLSAqIC0gREJVRiBmdW5jdGlvbgotICogLSBQSVBFX0EgYW5kIGl0cyBwbGFuZXMsIGV4
Y2VwdCBWR0EKLSAqIC0gdHJhbnNjb2RlciBFRFAgKyBQU1IKLSAqIC0gdHJhbnNjb2RlciBEU0kK
LSAqIC0gRERJX0EKLSAqIC0gRkJDCi0gKi8KLSNkZWZpbmUgSUNMX1BXXzRfUE9XRVJfRE9NQUlO
UyAoCQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BJUEVfQykgfAkJCVwKLQlCSVRfVUxMKFBP
V0VSX0RPTUFJTl9QSVBFX0NfUEFORUxfRklUVEVSKSB8CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJ
Tl9JTklUKSkKLQkvKiBWRFNDL2pvaW5pbmcgKi8KLSNkZWZpbmUgSUNMX1BXXzNfUE9XRVJfRE9N
QUlOUyAoCQkJXAotCUlDTF9QV180X1BPV0VSX0RPTUFJTlMgfAkJCVwKLQlCSVRfVUxMKFBPV0VS
X0RPTUFJTl9QSVBFX0IpIHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9B
KSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9CKSB8CQlcCi0JQklUX1VM
TChQT1dFUl9ET01BSU5fVFJBTlNDT0RFUl9DKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5f
UElQRV9CX1BBTkVMX0ZJVFRFUikgfAlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElf
Ql9MQU5FUykgfAlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfQl9JTykgfAkJXAot
CUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0NfTEFORVMpIHwJXAotCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX1BPUlRfRERJX0NfSU8pIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JU
X0RESV9EX0xBTkVTKSB8CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9QT1JUX0RESV9EX0lPKSB8
CQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fUE9SVF9ERElfRV9MQU5FUykgfAlcCi0JQklUX1VM
TChQT1dFUl9ET01BSU5fUE9SVF9ERElfRV9JTykgfAkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlO
X1BPUlRfRERJX0ZfTEFORVMpIHwJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0Zf
SU8pIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQikgfAkJCVwKLQlCSVRfVUxMKFBP
V0VSX0RPTUFJTl9BVVhfQykgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfRCkgfAkJ
CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfRSkgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RP
TUFJTl9BVVhfRikgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfVEJUMSkgfAkJXAot
CUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FVWF9UQlQyKSB8CQlcCi0JQklUX1VMTChQT1dFUl9ET01B
SU5fQVVYX1RCVDMpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfVEJUNCkgfAkJXAot
CUJJVF9VTEwoUE9XRVJfRE9NQUlOX1ZHQSkgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9B
VURJTykgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9JTklUKSkKLQkvKgotCSAqIC0gdHJh
bnNjb2RlciBXRAotCSAqIC0gS1ZNUiAoSFcgY29udHJvbCkKLQkgKi8KLSNkZWZpbmUgSUNMX1BX
XzJfUE9XRVJfRE9NQUlOUyAoCQkJXAotCUlDTF9QV18zX1BPV0VSX0RPTUFJTlMgfAkJCVwKLQlC
SVRfVUxMKFBPV0VSX0RPTUFJTl9UUkFOU0NPREVSX0VEUF9WRFNDKSB8CQlcCi0JQklUX1VMTChQ
T1dFUl9ET01BSU5fSU5JVCkpCi0JLyoKLQkgKiAtIEtWTVIgKEhXIGNvbnRyb2wpCi0JICovCi0j
ZGVmaW5lIElDTF9ESVNQTEFZX0RDX09GRl9QT1dFUl9ET01BSU5TICgJCVwKLQlJQ0xfUFdfMl9Q
T1dFUl9ET01BSU5TIHwJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fTU9ERVNFVCkgfAkJCVwK
LQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQSkgfAkJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJ
Tl9JTklUKSkKLQotI2RlZmluZSBJQ0xfRERJX0lPX0FfUE9XRVJfRE9NQUlOUyAoCQkJXAotCUJJ
VF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0FfSU8pKQotI2RlZmluZSBJQ0xfRERJX0lPX0Jf
UE9XRVJfRE9NQUlOUyAoCQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0JfSU8p
KQotI2RlZmluZSBJQ0xfRERJX0lPX0NfUE9XRVJfRE9NQUlOUyAoCQkJXAotCUJJVF9VTEwoUE9X
RVJfRE9NQUlOX1BPUlRfRERJX0NfSU8pKQotI2RlZmluZSBJQ0xfRERJX0lPX0RfUE9XRVJfRE9N
QUlOUyAoCQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0RfSU8pKQotI2RlZmlu
ZSBJQ0xfRERJX0lPX0VfUE9XRVJfRE9NQUlOUyAoCQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlO
X1BPUlRfRERJX0VfSU8pKQotI2RlZmluZSBJQ0xfRERJX0lPX0ZfUE9XRVJfRE9NQUlOUyAoCQkJ
XAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX1BPUlRfRERJX0ZfSU8pKQotCi0jZGVmaW5lIElDTF9B
VVhfQV9JT19QT1dFUl9ET01BSU5TICgJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0lP
X0EpIHwJCVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfQSkpCi0jZGVmaW5lIElDTF9BVVhf
Ql9JT19QT1dFUl9ET01BSU5TICgJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0IpKQot
I2RlZmluZSBJQ0xfQVVYX0NfSU9fUE9XRVJfRE9NQUlOUyAoCQkJXAotCUJJVF9VTEwoUE9XRVJf
RE9NQUlOX0FVWF9DKSkKLSNkZWZpbmUgSUNMX0FVWF9EX0lPX1BPV0VSX0RPTUFJTlMgKAkJCVwK
LQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfRCkpCi0jZGVmaW5lIElDTF9BVVhfRV9JT19QT1dF
Ul9ET01BSU5TICgJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX0UpKQotI2RlZmluZSBJ
Q0xfQVVYX0ZfSU9fUE9XRVJfRE9NQUlOUyAoCQkJXAotCUJJVF9VTEwoUE9XRVJfRE9NQUlOX0FV
WF9GKSkKLSNkZWZpbmUgSUNMX0FVWF9UQlQxX0lPX1BPV0VSX0RPTUFJTlMgKAkJCVwKLQlCSVRf
VUxMKFBPV0VSX0RPTUFJTl9BVVhfVEJUMSkpCi0jZGVmaW5lIElDTF9BVVhfVEJUMl9JT19QT1dF
Ul9ET01BSU5TICgJCQlcCi0JQklUX1VMTChQT1dFUl9ET01BSU5fQVVYX1RCVDIpKQotI2RlZmlu
ZSBJQ0xfQVVYX1RCVDNfSU9fUE9XRVJfRE9NQUlOUyAoCQkJXAotCUJJVF9VTEwoUE9XRVJfRE9N
QUlOX0FVWF9UQlQzKSkKLSNkZWZpbmUgSUNMX0FVWF9UQlQ0X0lPX1BPV0VSX0RPTUFJTlMgKAkJ
CVwKLQlCSVRfVUxMKFBPV0VSX0RPTUFJTl9BVVhfVEJUNCkpCi0KLXN0YXRpYyBjb25zdCBzdHJ1
Y3QgaTkxNV9wb3dlcl93ZWxsX29wcyBpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX29wcyA9IHsK
LQkuc3luY19odyA9IGk5eHhfcG93ZXJfd2VsbF9zeW5jX2h3X25vb3AsCi0JLmVuYWJsZSA9IGk5
eHhfYWx3YXlzX29uX3Bvd2VyX3dlbGxfbm9vcCwKLQkuZGlzYWJsZSA9IGk5eHhfYWx3YXlzX29u
X3Bvd2VyX3dlbGxfbm9vcCwKLQkuaXNfZW5hYmxlZCA9IGk5eHhfYWx3YXlzX29uX3Bvd2VyX3dl
bGxfZW5hYmxlZCwKLX07Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX29w
cyBjaHZfcGlwZV9wb3dlcl93ZWxsX29wcyA9IHsKLQkuc3luY19odyA9IGk5eHhfcG93ZXJfd2Vs
bF9zeW5jX2h3X25vb3AsCi0JLmVuYWJsZSA9IGNodl9waXBlX3Bvd2VyX3dlbGxfZW5hYmxlLAot
CS5kaXNhYmxlID0gY2h2X3BpcGVfcG93ZXJfd2VsbF9kaXNhYmxlLAotCS5pc19lbmFibGVkID0g
Y2h2X3BpcGVfcG93ZXJfd2VsbF9lbmFibGVkLAotfTsKLQotc3RhdGljIGNvbnN0IHN0cnVjdCBp
OTE1X3Bvd2VyX3dlbGxfb3BzIGNodl9kcGlvX2Ntbl9wb3dlcl93ZWxsX29wcyA9IHsKLQkuc3lu
Y19odyA9IGk5eHhfcG93ZXJfd2VsbF9zeW5jX2h3X25vb3AsCi0JLmVuYWJsZSA9IGNodl9kcGlv
X2Ntbl9wb3dlcl93ZWxsX2VuYWJsZSwKLQkuZGlzYWJsZSA9IGNodl9kcGlvX2Ntbl9wb3dlcl93
ZWxsX2Rpc2FibGUsCi0JLmlzX2VuYWJsZWQgPSB2bHZfcG93ZXJfd2VsbF9lbmFibGVkLAotfTsK
LQotc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfZGVzYyBpOXh4X2Fsd2F5c19v
bl9wb3dlcl93ZWxsW10gPSB7Ci0JewotCQkubmFtZSA9ICJhbHdheXMtb24iLAotCQkuYWx3YXlz
X29uID0gdHJ1ZSwKLQkJLmRvbWFpbnMgPSBQT1dFUl9ET01BSU5fTUFTSywKLQkJLm9wcyA9ICZp
OXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAot
CX0sCi19OwotCi1zdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9vcHMgaTgzMF9w
aXBlc19wb3dlcl93ZWxsX29wcyA9IHsKLQkuc3luY19odyA9IGk4MzBfcGlwZXNfcG93ZXJfd2Vs
bF9zeW5jX2h3LAotCS5lbmFibGUgPSBpODMwX3BpcGVzX3Bvd2VyX3dlbGxfZW5hYmxlLAotCS5k
aXNhYmxlID0gaTgzMF9waXBlc19wb3dlcl93ZWxsX2Rpc2FibGUsCi0JLmlzX2VuYWJsZWQgPSBp
ODMwX3BpcGVzX3Bvd2VyX3dlbGxfZW5hYmxlZCwKLX07Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsX2Rlc2MgaTgzMF9wb3dlcl93ZWxsc1tdID0gewotCXsKLQkJLm5hbWUg
PSAiYWx3YXlzLW9uIiwKLQkJLmFsd2F5c19vbiA9IHRydWUsCi0JCS5kb21haW5zID0gUE9XRVJf
RE9NQUlOX01BU0ssCi0JCS5vcHMgPSAmaTl4eF9hbHdheXNfb25fcG93ZXJfd2VsbF9vcHMsCi0J
CS5pZCA9IERJU1BfUFdfSURfTk9ORSwKLQl9LAotCXsKLQkJLm5hbWUgPSAicGlwZXMiLAotCQku
ZG9tYWlucyA9IEk4MzBfUElQRVNfUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZpODMwX3BpcGVz
X3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JfSwKLX07Ci0KLXN0
YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX29wcyBoc3dfcG93ZXJfd2VsbF9vcHMg
PSB7Ci0JLnN5bmNfaHcgPSBoc3dfcG93ZXJfd2VsbF9zeW5jX2h3LAotCS5lbmFibGUgPSBoc3df
cG93ZXJfd2VsbF9lbmFibGUsCi0JLmRpc2FibGUgPSBoc3dfcG93ZXJfd2VsbF9kaXNhYmxlLAot
CS5pc19lbmFibGVkID0gaHN3X3Bvd2VyX3dlbGxfZW5hYmxlZCwKLX07Ci0KLXN0YXRpYyBjb25z
dCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX29wcyBnZW45X2RjX29mZl9wb3dlcl93ZWxsX29wcyA9
IHsKLQkuc3luY19odyA9IGk5eHhfcG93ZXJfd2VsbF9zeW5jX2h3X25vb3AsCi0JLmVuYWJsZSA9
IGdlbjlfZGNfb2ZmX3Bvd2VyX3dlbGxfZW5hYmxlLAotCS5kaXNhYmxlID0gZ2VuOV9kY19vZmZf
cG93ZXJfd2VsbF9kaXNhYmxlLAotCS5pc19lbmFibGVkID0gZ2VuOV9kY19vZmZfcG93ZXJfd2Vs
bF9lbmFibGVkLAotfTsKLQotc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfb3Bz
IGJ4dF9kcGlvX2Ntbl9wb3dlcl93ZWxsX29wcyA9IHsKLQkuc3luY19odyA9IGk5eHhfcG93ZXJf
d2VsbF9zeW5jX2h3X25vb3AsCi0JLmVuYWJsZSA9IGJ4dF9kcGlvX2Ntbl9wb3dlcl93ZWxsX2Vu
YWJsZSwKLQkuZGlzYWJsZSA9IGJ4dF9kcGlvX2Ntbl9wb3dlcl93ZWxsX2Rpc2FibGUsCi0JLmlz
X2VuYWJsZWQgPSBieHRfZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGVkLAotfTsKLQotc3RhdGlj
IGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfcmVncyBoc3dfcG93ZXJfd2VsbF9yZWdzID0g
ewotCS5iaW9zCT0gSFNXX1BXUl9XRUxMX0NUTDEsCi0JLmRyaXZlcgk9IEhTV19QV1JfV0VMTF9D
VEwyLAotCS5rdm1yCT0gSFNXX1BXUl9XRUxMX0NUTDMsCi0JLmRlYnVnCT0gSFNXX1BXUl9XRUxM
X0NUTDQsCi19OwotCi1zdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9kZXNjIGhz
d19wb3dlcl93ZWxsc1tdID0gewotCXsKLQkJLm5hbWUgPSAiYWx3YXlzLW9uIiwKLQkJLmFsd2F5
c19vbiA9IHRydWUsCi0JCS5kb21haW5zID0gUE9XRVJfRE9NQUlOX01BU0ssCi0JCS5vcHMgPSAm
aTl4eF9hbHdheXNfb25fcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwK
LQl9LAotCXsKLQkJLm5hbWUgPSAiZGlzcGxheSIsCi0JCS5kb21haW5zID0gSFNXX0RJU1BMQVlf
UE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IEhT
V19ESVNQX1BXX0dMT0JBTCwKLQkJewotCQkJLmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3Jl
Z3MsCi0JCQkuaHN3LmlkeCA9IEhTV19QV19DVExfSURYX0dMT0JBTCwKLQkJCS5oc3cuaGFzX3Zn
YSA9IHRydWUsCi0JCX0sCi0JfSwKLX07Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dl
cl93ZWxsX2Rlc2MgYmR3X3Bvd2VyX3dlbGxzW10gPSB7Ci0JewotCQkubmFtZSA9ICJhbHdheXMt
b24iLAotCQkuYWx3YXlzX29uID0gdHJ1ZSwKLQkJLmRvbWFpbnMgPSBQT1dFUl9ET01BSU5fTUFT
SywKLQkJLm9wcyA9ICZpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElT
UF9QV19JRF9OT05FLAotCX0sCi0JewotCQkubmFtZSA9ICJkaXNwbGF5IiwKLQkJLmRvbWFpbnMg
PSBCRFdfRElTUExBWV9QT1dFUl9ET01BSU5TLAotCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29w
cywKLQkJLmlkID0gSFNXX0RJU1BfUFdfR0xPQkFMLAotCQl7Ci0JCQkuaHN3LnJlZ3MgPSAmaHN3
X3Bvd2VyX3dlbGxfcmVncywKLQkJCS5oc3cuaWR4ID0gSFNXX1BXX0NUTF9JRFhfR0xPQkFMLAot
CQkJLmhzdy5pcnFfcGlwZV9tYXNrID0gQklUKFBJUEVfQikgfCBCSVQoUElQRV9DKSwKLQkJCS5o
c3cuaGFzX3ZnYSA9IHRydWUsCi0JCX0sCi0JfSwKLX07Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3Qg
aTkxNV9wb3dlcl93ZWxsX29wcyB2bHZfZGlzcGxheV9wb3dlcl93ZWxsX29wcyA9IHsKLQkuc3lu
Y19odyA9IGk5eHhfcG93ZXJfd2VsbF9zeW5jX2h3X25vb3AsCi0JLmVuYWJsZSA9IHZsdl9kaXNw
bGF5X3Bvd2VyX3dlbGxfZW5hYmxlLAotCS5kaXNhYmxlID0gdmx2X2Rpc3BsYXlfcG93ZXJfd2Vs
bF9kaXNhYmxlLAotCS5pc19lbmFibGVkID0gdmx2X3Bvd2VyX3dlbGxfZW5hYmxlZCwKLX07Ci0K
LXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX29wcyB2bHZfZHBpb19jbW5fcG93
ZXJfd2VsbF9vcHMgPSB7Ci0JLnN5bmNfaHcgPSBpOXh4X3Bvd2VyX3dlbGxfc3luY19od19ub29w
LAotCS5lbmFibGUgPSB2bHZfZHBpb19jbW5fcG93ZXJfd2VsbF9lbmFibGUsCi0JLmRpc2FibGUg
PSB2bHZfZHBpb19jbW5fcG93ZXJfd2VsbF9kaXNhYmxlLAotCS5pc19lbmFibGVkID0gdmx2X3Bv
d2VyX3dlbGxfZW5hYmxlZCwKLX07Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93
ZWxsX29wcyB2bHZfZHBpb19wb3dlcl93ZWxsX29wcyA9IHsKLQkuc3luY19odyA9IGk5eHhfcG93
ZXJfd2VsbF9zeW5jX2h3X25vb3AsCi0JLmVuYWJsZSA9IHZsdl9wb3dlcl93ZWxsX2VuYWJsZSwK
LQkuZGlzYWJsZSA9IHZsdl9wb3dlcl93ZWxsX2Rpc2FibGUsCi0JLmlzX2VuYWJsZWQgPSB2bHZf
cG93ZXJfd2VsbF9lbmFibGVkLAotfTsKLQotc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2Vy
X3dlbGxfZGVzYyB2bHZfcG93ZXJfd2VsbHNbXSA9IHsKLQl7Ci0JCS5uYW1lID0gImFsd2F5cy1v
biIsCi0JCS5hbHdheXNfb24gPSB0cnVlLAotCQkuZG9tYWlucyA9IFBPV0VSX0RPTUFJTl9NQVNL
LAotCQkub3BzID0gJmk5eHhfYWx3YXlzX29uX3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQ
X1BXX0lEX05PTkUsCi0JfSwKLQl7Ci0JCS5uYW1lID0gImRpc3BsYXkiLAotCQkuZG9tYWlucyA9
IFZMVl9ESVNQTEFZX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmdmx2X2Rpc3BsYXlfcG93ZXJf
d2VsbF9vcHMsCi0JCS5pZCA9IFZMVl9ESVNQX1BXX0RJU1AyRCwKLQkJewotCQkJLnZsdi5pZHgg
PSBQVU5JVF9QV0dUX0lEWF9ESVNQMkQsCi0JCX0sCi0JfSwKLQl7Ci0JCS5uYW1lID0gImRwaW8t
dHgtYi0wMSIsCi0JCS5kb21haW5zID0gVkxWX0RQSU9fVFhfQl9MQU5FU18wMV9QT1dFUl9ET01B
SU5TIHwKLQkJCSAgIFZMVl9EUElPX1RYX0JfTEFORVNfMjNfUE9XRVJfRE9NQUlOUyB8Ci0JCQkg
ICBWTFZfRFBJT19UWF9DX0xBTkVTXzAxX1BPV0VSX0RPTUFJTlMgfAotCQkJICAgVkxWX0RQSU9f
VFhfQ19MQU5FU18yM19QT1dFUl9ET01BSU5TLAotCQkub3BzID0gJnZsdl9kcGlvX3Bvd2VyX3dl
bGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JCXsKLQkJCS52bHYuaWR4ID0gUFVO
SVRfUFdHVF9JRFhfRFBJT19UWF9CX0xBTkVTXzAxLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9
ICJkcGlvLXR4LWItMjMiLAotCQkuZG9tYWlucyA9IFZMVl9EUElPX1RYX0JfTEFORVNfMDFfUE9X
RVJfRE9NQUlOUyB8Ci0JCQkgICBWTFZfRFBJT19UWF9CX0xBTkVTXzIzX1BPV0VSX0RPTUFJTlMg
fAotCQkJICAgVkxWX0RQSU9fVFhfQ19MQU5FU18wMV9QT1dFUl9ET01BSU5TIHwKLQkJCSAgIFZM
Vl9EUElPX1RYX0NfTEFORVNfMjNfUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZ2bHZfZHBpb19w
b3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAotCQl7Ci0JCQkudmx2Lmlk
eCA9IFBVTklUX1BXR1RfSURYX0RQSU9fVFhfQl9MQU5FU18yMywKLQkJfSwKLQl9LAotCXsKLQkJ
Lm5hbWUgPSAiZHBpby10eC1jLTAxIiwKLQkJLmRvbWFpbnMgPSBWTFZfRFBJT19UWF9CX0xBTkVT
XzAxX1BPV0VSX0RPTUFJTlMgfAotCQkJICAgVkxWX0RQSU9fVFhfQl9MQU5FU18yM19QT1dFUl9E
T01BSU5TIHwKLQkJCSAgIFZMVl9EUElPX1RYX0NfTEFORVNfMDFfUE9XRVJfRE9NQUlOUyB8Ci0J
CQkgICBWTFZfRFBJT19UWF9DX0xBTkVTXzIzX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmdmx2
X2RwaW9fcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKLQkJewotCQkJ
LnZsdi5pZHggPSBQVU5JVF9QV0dUX0lEWF9EUElPX1RYX0NfTEFORVNfMDEsCi0JCX0sCi0JfSwK
LQl7Ci0JCS5uYW1lID0gImRwaW8tdHgtYy0yMyIsCi0JCS5kb21haW5zID0gVkxWX0RQSU9fVFhf
Ql9MQU5FU18wMV9QT1dFUl9ET01BSU5TIHwKLQkJCSAgIFZMVl9EUElPX1RYX0JfTEFORVNfMjNf
UE9XRVJfRE9NQUlOUyB8Ci0JCQkgICBWTFZfRFBJT19UWF9DX0xBTkVTXzAxX1BPV0VSX0RPTUFJ
TlMgfAotCQkJICAgVkxWX0RQSU9fVFhfQ19MQU5FU18yM19QT1dFUl9ET01BSU5TLAotCQkub3Bz
ID0gJnZsdl9kcGlvX3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0J
CXsKLQkJCS52bHYuaWR4ID0gUFVOSVRfUFdHVF9JRFhfRFBJT19UWF9DX0xBTkVTXzIzLAotCQl9
LAotCX0sCi0JewotCQkubmFtZSA9ICJkcGlvLWNvbW1vbiIsCi0JCS5kb21haW5zID0gVkxWX0RQ
SU9fQ01OX0JDX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmdmx2X2RwaW9fY21uX3Bvd2VyX3dl
bGxfb3BzLAotCQkuaWQgPSBWTFZfRElTUF9QV19EUElPX0NNTl9CQywKLQkJewotCQkJLnZsdi5p
ZHggPSBQVU5JVF9QV0dUX0lEWF9EUElPX0NNTl9CQywKLQkJfSwKLQl9LAotfTsKLQotc3RhdGlj
IGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfZGVzYyBjaHZfcG93ZXJfd2VsbHNbXSA9IHsK
LQl7Ci0JCS5uYW1lID0gImFsd2F5cy1vbiIsCi0JCS5hbHdheXNfb24gPSB0cnVlLAotCQkuZG9t
YWlucyA9IFBPV0VSX0RPTUFJTl9NQVNLLAotCQkub3BzID0gJmk5eHhfYWx3YXlzX29uX3Bvd2Vy
X3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JfSwKLQl7Ci0JCS5uYW1lID0g
ImRpc3BsYXkiLAotCQkvKgotCQkgKiBQaXBlIEEgcG93ZXIgd2VsbCBpcyB0aGUgbmV3IGRpc3Ay
ZCB3ZWxsLiBQaXBlIEIgYW5kIEMKLQkJICogcG93ZXIgd2VsbHMgZG9uJ3QgYWN0dWFsbHkgZXhp
c3QuIFBpcGUgQSBwb3dlciB3ZWxsIGlzCi0JCSAqIHJlcXVpcmVkIGZvciBhbnkgcGlwZSB0byB3
b3JrLgotCQkgKi8KLQkJLmRvbWFpbnMgPSBDSFZfRElTUExBWV9QT1dFUl9ET01BSU5TLAotCQku
b3BzID0gJmNodl9waXBlX3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUs
Ci0JfSwKLQl7Ci0JCS5uYW1lID0gImRwaW8tY29tbW9uLWJjIiwKLQkJLmRvbWFpbnMgPSBDSFZf
RFBJT19DTU5fQkNfUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZjaHZfZHBpb19jbW5fcG93ZXJf
d2VsbF9vcHMsCi0JCS5pZCA9IFZMVl9ESVNQX1BXX0RQSU9fQ01OX0JDLAotCQl7Ci0JCQkudmx2
LmlkeCA9IFBVTklUX1BXR1RfSURYX0RQSU9fQ01OX0JDLAotCQl9LAotCX0sCi0JewotCQkubmFt
ZSA9ICJkcGlvLWNvbW1vbi1kIiwKLQkJLmRvbWFpbnMgPSBDSFZfRFBJT19DTU5fRF9QT1dFUl9E
T01BSU5TLAotCQkub3BzID0gJmNodl9kcGlvX2Ntbl9wb3dlcl93ZWxsX29wcywKLQkJLmlkID0g
Q0hWX0RJU1BfUFdfRFBJT19DTU5fRCwKLQkJewotCQkJLnZsdi5pZHggPSBQVU5JVF9QV0dUX0lE
WF9EUElPX0NNTl9ELAotCQl9LAotCX0sCi19OwotCi1ib29sIGludGVsX2Rpc3BsYXlfcG93ZXJf
d2VsbF9pc19lbmFibGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkJ
IGVudW0gaTkxNV9wb3dlcl93ZWxsX2lkIHBvd2VyX3dlbGxfaWQpCi17Ci0Jc3RydWN0IGk5MTVf
cG93ZXJfd2VsbCAqcG93ZXJfd2VsbDsKLQlib29sIHJldDsKLQotCXBvd2VyX3dlbGwgPSBsb29r
dXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgcG93ZXJfd2VsbF9pZCk7Ci0JcmV0ID0gcG93ZXJfd2Vs
bC0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9wcml2LCBwb3dlcl93ZWxsKTsKLQotCXJldHVy
biByZXQ7Ci19Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX2Rlc2Mgc2ts
X3Bvd2VyX3dlbGxzW10gPSB7Ci0JewotCQkubmFtZSA9ICJhbHdheXMtb24iLAotCQkuYWx3YXlz
X29uID0gdHJ1ZSwKLQkJLmRvbWFpbnMgPSBQT1dFUl9ET01BSU5fTUFTSywKLQkJLm9wcyA9ICZp
OXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAot
CX0sCi0JewotCQkubmFtZSA9ICJwb3dlciB3ZWxsIDEiLAotCQkvKiBIYW5kbGVkIGJ5IHRoZSBE
TUMgZmlybXdhcmUgKi8KLQkJLmFsd2F5c19vbiA9IHRydWUsCi0JCS5kb21haW5zID0gMCwKLQkJ
Lm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IFNLTF9ESVNQX1BXXzEsCi0JCXsK
LQkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBTS0xf
UFdfQ1RMX0lEWF9QV18xLAotCQkJLmhzdy5oYXNfZnVzZXMgPSB0cnVlLAotCQl9LAotCX0sCi0J
ewotCQkubmFtZSA9ICJNSVNDIElPIHBvd2VyIHdlbGwiLAotCQkvKiBIYW5kbGVkIGJ5IHRoZSBE
TUMgZmlybXdhcmUgKi8KLQkJLmFsd2F5c19vbiA9IHRydWUsCi0JCS5kb21haW5zID0gMCwKLQkJ
Lm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IFNLTF9ESVNQX1BXX01JU0NfSU8s
Ci0JCXsKLQkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHgg
PSBTS0xfUFdfQ1RMX0lEWF9NSVNDX0lPLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9ICJEQyBv
ZmYiLAotCQkuZG9tYWlucyA9IFNLTF9ESVNQTEFZX0RDX09GRl9QT1dFUl9ET01BSU5TLAotCQku
b3BzID0gJmdlbjlfZGNfb2ZmX3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05P
TkUsCi0JfSwKLQl7Ci0JCS5uYW1lID0gInBvd2VyIHdlbGwgMiIsCi0JCS5kb21haW5zID0gU0tM
X0RJU1BMQVlfUE9XRVJXRUxMXzJfUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZoc3dfcG93ZXJf
d2VsbF9vcHMsCi0JCS5pZCA9IFNLTF9ESVNQX1BXXzIsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZo
c3dfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBTS0xfUFdfQ1RMX0lEWF9QV18yLAot
CQkJLmhzdy5pcnFfcGlwZV9tYXNrID0gQklUKFBJUEVfQikgfCBCSVQoUElQRV9DKSwKLQkJCS5o
c3cuaGFzX3ZnYSA9IHRydWUsCi0JCQkuaHN3Lmhhc19mdXNlcyA9IHRydWUsCi0JCX0sCi0JfSwK
LQl7Ci0JCS5uYW1lID0gIkRESSBBL0UgSU8gcG93ZXIgd2VsbCIsCi0JCS5kb21haW5zID0gU0tM
X0RJU1BMQVlfRERJX0lPX0FfRV9QT1dFUl9ET01BSU5TLAotCQkub3BzID0gJmhzd19wb3dlcl93
ZWxsX29wcywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAotCQl7Ci0JCQkuaHN3LnJlZ3MgPSAm
aHN3X3Bvd2VyX3dlbGxfcmVncywKLQkJCS5oc3cuaWR4ID0gU0tMX1BXX0NUTF9JRFhfRERJX0Ff
RSwKLQkJfSwKLQl9LAotCXsKLQkJLm5hbWUgPSAiRERJIEIgSU8gcG93ZXIgd2VsbCIsCi0JCS5k
b21haW5zID0gU0tMX0RJU1BMQVlfRERJX0lPX0JfUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZo
c3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKLQkJewotCQkJLmhz
dy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3MsCi0JCQkuaHN3LmlkeCA9IFNLTF9QV19DVExf
SURYX0RESV9CLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9ICJEREkgQyBJTyBwb3dlciB3ZWxs
IiwKLQkJLmRvbWFpbnMgPSBTS0xfRElTUExBWV9ERElfSU9fQ19QT1dFUl9ET01BSU5TLAotCQku
b3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAotCQl7
Ci0JCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKLQkJCS5oc3cuaWR4ID0gU0tM
X1BXX0NUTF9JRFhfRERJX0MsCi0JCX0sCi0JfSwKLQl7Ci0JCS5uYW1lID0gIkRESSBEIElPIHBv
d2VyIHdlbGwiLAotCQkuZG9tYWlucyA9IFNLTF9ESVNQTEFZX0RESV9JT19EX1BPV0VSX0RPTUFJ
TlMsCi0JCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05P
TkUsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5p
ZHggPSBTS0xfUFdfQ1RMX0lEWF9ERElfRCwKLQkJfSwKLQl9LAotfTsKLQotc3RhdGljIGNvbnN0
IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfZGVzYyBieHRfcG93ZXJfd2VsbHNbXSA9IHsKLQl7Ci0J
CS5uYW1lID0gImFsd2F5cy1vbiIsCi0JCS5hbHdheXNfb24gPSB0cnVlLAotCQkuZG9tYWlucyA9
IFBPV0VSX0RPTUFJTl9NQVNLLAotCQkub3BzID0gJmk5eHhfYWx3YXlzX29uX3Bvd2VyX3dlbGxf
b3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JfSwKLQl7Ci0JCS5uYW1lID0gInBvd2Vy
IHdlbGwgMSIsCi0JCS8qIEhhbmRsZWQgYnkgdGhlIERNQyBmaXJtd2FyZSAqLwotCQkuYWx3YXlz
X29uID0gdHJ1ZSwKLQkJLmRvbWFpbnMgPSAwLAotCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29w
cywKLQkJLmlkID0gU0tMX0RJU1BfUFdfMSwKLQkJewotCQkJLmhzdy5yZWdzID0gJmhzd19wb3dl
cl93ZWxsX3JlZ3MsCi0JCQkuaHN3LmlkeCA9IFNLTF9QV19DVExfSURYX1BXXzEsCi0JCQkuaHN3
Lmhhc19mdXNlcyA9IHRydWUsCi0JCX0sCi0JfSwKLQl7Ci0JCS5uYW1lID0gIkRDIG9mZiIsCi0J
CS5kb21haW5zID0gQlhUX0RJU1BMQVlfRENfT0ZGX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAm
Z2VuOV9kY19vZmZfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKLQl9
LAotCXsKLQkJLm5hbWUgPSAicG93ZXIgd2VsbCAyIiwKLQkJLmRvbWFpbnMgPSBCWFRfRElTUExB
WV9QT1dFUldFTExfMl9QT1dFUl9ET01BSU5TLAotCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29w
cywKLQkJLmlkID0gU0tMX0RJU1BfUFdfMiwKLQkJewotCQkJLmhzdy5yZWdzID0gJmhzd19wb3dl
cl93ZWxsX3JlZ3MsCi0JCQkuaHN3LmlkeCA9IFNLTF9QV19DVExfSURYX1BXXzIsCi0JCQkuaHN3
LmlycV9waXBlX21hc2sgPSBCSVQoUElQRV9CKSB8IEJJVChQSVBFX0MpLAotCQkJLmhzdy5oYXNf
dmdhID0gdHJ1ZSwKLQkJCS5oc3cuaGFzX2Z1c2VzID0gdHJ1ZSwKLQkJfSwKLQl9LAotCXsKLQkJ
Lm5hbWUgPSAiZHBpby1jb21tb24tYSIsCi0JCS5kb21haW5zID0gQlhUX0RQSU9fQ01OX0FfUE9X
RVJfRE9NQUlOUywKLQkJLm9wcyA9ICZieHRfZHBpb19jbW5fcG93ZXJfd2VsbF9vcHMsCi0JCS5p
ZCA9IEJYVF9ESVNQX1BXX0RQSU9fQ01OX0EsCi0JCXsKLQkJCS5ieHQucGh5ID0gRFBJT19QSFkx
LAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9ICJkcGlvLWNvbW1vbi1iYyIsCi0JCS5kb21haW5z
ID0gQlhUX0RQSU9fQ01OX0JDX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmYnh0X2RwaW9fY21u
X3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBWTFZfRElTUF9QV19EUElPX0NNTl9CQywKLQkJewot
CQkJLmJ4dC5waHkgPSBEUElPX1BIWTAsCi0JCX0sCi0JfSwKLX07Ci0KLXN0YXRpYyBjb25zdCBz
dHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX2Rlc2MgZ2xrX3Bvd2VyX3dlbGxzW10gPSB7Ci0JewotCQku
bmFtZSA9ICJhbHdheXMtb24iLAotCQkuYWx3YXlzX29uID0gdHJ1ZSwKLQkJLmRvbWFpbnMgPSBQ
T1dFUl9ET01BSU5fTUFTSywKLQkJLm9wcyA9ICZpOXh4X2Fsd2F5c19vbl9wb3dlcl93ZWxsX29w
cywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAotCX0sCi0JewotCQkubmFtZSA9ICJwb3dlciB3
ZWxsIDEiLAotCQkvKiBIYW5kbGVkIGJ5IHRoZSBETUMgZmlybXdhcmUgKi8KLQkJLmFsd2F5c19v
biA9IHRydWUsCi0JCS5kb21haW5zID0gMCwKLQkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMs
Ci0JCS5pZCA9IFNLTF9ESVNQX1BXXzEsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJf
d2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBTS0xfUFdfQ1RMX0lEWF9QV18xLAotCQkJLmhzdy5o
YXNfZnVzZXMgPSB0cnVlLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9ICJEQyBvZmYiLAotCQku
ZG9tYWlucyA9IEdMS19ESVNQTEFZX0RDX09GRl9QT1dFUl9ET01BSU5TLAotCQkub3BzID0gJmdl
bjlfZGNfb2ZmX3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JfSwK
LQl7Ci0JCS5uYW1lID0gInBvd2VyIHdlbGwgMiIsCi0JCS5kb21haW5zID0gR0xLX0RJU1BMQVlf
UE9XRVJXRUxMXzJfUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMs
Ci0JCS5pZCA9IFNLTF9ESVNQX1BXXzIsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJf
d2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBTS0xfUFdfQ1RMX0lEWF9QV18yLAotCQkJLmhzdy5p
cnFfcGlwZV9tYXNrID0gQklUKFBJUEVfQikgfCBCSVQoUElQRV9DKSwKLQkJCS5oc3cuaGFzX3Zn
YSA9IHRydWUsCi0JCQkuaHN3Lmhhc19mdXNlcyA9IHRydWUsCi0JCX0sCi0JfSwKLQl7Ci0JCS5u
YW1lID0gImRwaW8tY29tbW9uLWEiLAotCQkuZG9tYWlucyA9IEdMS19EUElPX0NNTl9BX1BPV0VS
X0RPTUFJTlMsCi0JCS5vcHMgPSAmYnh0X2RwaW9fY21uX3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQg
PSBCWFRfRElTUF9QV19EUElPX0NNTl9BLAotCQl7Ci0JCQkuYnh0LnBoeSA9IERQSU9fUEhZMSwK
LQkJfSwKLQl9LAotCXsKLQkJLm5hbWUgPSAiZHBpby1jb21tb24tYiIsCi0JCS5kb21haW5zID0g
R0xLX0RQSU9fQ01OX0JfUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZieHRfZHBpb19jbW5fcG93
ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IFZMVl9ESVNQX1BXX0RQSU9fQ01OX0JDLAotCQl7Ci0JCQku
Ynh0LnBoeSA9IERQSU9fUEhZMCwKLQkJfSwKLQl9LAotCXsKLQkJLm5hbWUgPSAiZHBpby1jb21t
b24tYyIsCi0JCS5kb21haW5zID0gR0xLX0RQSU9fQ01OX0NfUE9XRVJfRE9NQUlOUywKLQkJLm9w
cyA9ICZieHRfZHBpb19jbW5fcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IEdMS19ESVNQX1BXX0RQ
SU9fQ01OX0MsCi0JCXsKLQkJCS5ieHQucGh5ID0gRFBJT19QSFkyLAotCQl9LAotCX0sCi0Jewot
CQkubmFtZSA9ICJBVVggQSIsCi0JCS5kb21haW5zID0gR0xLX0RJU1BMQVlfQVVYX0FfUE9XRVJf
RE9NQUlOUywKLQkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdf
SURfTk9ORSwKLQkJewotCQkJLmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3MsCi0JCQku
aHN3LmlkeCA9IEdMS19QV19DVExfSURYX0FVWF9BLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9
ICJBVVggQiIsCi0JCS5kb21haW5zID0gR0xLX0RJU1BMQVlfQVVYX0JfUE9XRVJfRE9NQUlOUywK
LQkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwK
LQkJewotCQkJLmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3MsCi0JCQkuaHN3LmlkeCA9
IEdMS19QV19DVExfSURYX0FVWF9CLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9ICJBVVggQyIs
Ci0JCS5kb21haW5zID0gR0xLX0RJU1BMQVlfQVVYX0NfUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9
ICZoc3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKLQkJewotCQkJ
Lmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3MsCi0JCQkuaHN3LmlkeCA9IEdMS19QV19D
VExfSURYX0FVWF9DLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9ICJEREkgQSBJTyBwb3dlciB3
ZWxsIiwKLQkJLmRvbWFpbnMgPSBHTEtfRElTUExBWV9ERElfSU9fQV9QT1dFUl9ET01BSU5TLAot
CQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAot
CQl7Ci0JCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKLQkJCS5oc3cuaWR4ID0g
R0xLX1BXX0NUTF9JRFhfRERJX0EsCi0JCX0sCi0JfSwKLQl7Ci0JCS5uYW1lID0gIkRESSBCIElP
IHBvd2VyIHdlbGwiLAotCQkuZG9tYWlucyA9IEdMS19ESVNQTEFZX0RESV9JT19CX1BPV0VSX0RP
TUFJTlMsCi0JCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lE
X05PTkUsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhz
dy5pZHggPSBTS0xfUFdfQ1RMX0lEWF9ERElfQiwKLQkJfSwKLQl9LAotCXsKLQkJLm5hbWUgPSAi
RERJIEMgSU8gcG93ZXIgd2VsbCIsCi0JCS5kb21haW5zID0gR0xLX0RJU1BMQVlfRERJX0lPX0Nf
UE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJ
U1BfUFdfSURfTk9ORSwKLQkJewotCQkJLmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3Ms
Ci0JCQkuaHN3LmlkeCA9IFNLTF9QV19DVExfSURYX0RESV9DLAotCQl9LAotCX0sCi19OwotCi1z
dGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9kZXNjIGNubF9wb3dlcl93ZWxsc1td
ID0gewotCXsKLQkJLm5hbWUgPSAiYWx3YXlzLW9uIiwKLQkJLmFsd2F5c19vbiA9IHRydWUsCi0J
CS5kb21haW5zID0gUE9XRVJfRE9NQUlOX01BU0ssCi0JCS5vcHMgPSAmaTl4eF9hbHdheXNfb25f
cG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKLQl9LAotCXsKLQkJLm5h
bWUgPSAicG93ZXIgd2VsbCAxIiwKLQkJLyogSGFuZGxlZCBieSB0aGUgRE1DIGZpcm13YXJlICov
Ci0JCS5hbHdheXNfb24gPSB0cnVlLAotCQkuZG9tYWlucyA9IDAsCi0JCS5vcHMgPSAmaHN3X3Bv
d2VyX3dlbGxfb3BzLAotCQkuaWQgPSBTS0xfRElTUF9QV18xLAotCQl7Ci0JCQkuaHN3LnJlZ3Mg
PSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKLQkJCS5oc3cuaWR4ID0gU0tMX1BXX0NUTF9JRFhfUFdf
MSwKLQkJCS5oc3cuaGFzX2Z1c2VzID0gdHJ1ZSwKLQkJfSwKLQl9LAotCXsKLQkJLm5hbWUgPSAi
QVVYIEEiLAotCQkuZG9tYWlucyA9IENOTF9ESVNQTEFZX0FVWF9BX1BPV0VSX0RPTUFJTlMsCi0J
CS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0J
CXsKLQkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBH
TEtfUFdfQ1RMX0lEWF9BVVhfQSwKLQkJfSwKLQl9LAotCXsKLQkJLm5hbWUgPSAiQVVYIEIiLAot
CQkuZG9tYWlucyA9IENOTF9ESVNQTEFZX0FVWF9CX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAm
aHN3X3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JCXsKLQkJCS5o
c3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBHTEtfUFdfQ1RM
X0lEWF9BVVhfQiwKLQkJfSwKLQl9LAotCXsKLQkJLm5hbWUgPSAiQVVYIEMiLAotCQkuZG9tYWlu
cyA9IENOTF9ESVNQTEFZX0FVWF9DX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmaHN3X3Bvd2Vy
X3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JCXsKLQkJCS5oc3cucmVncyA9
ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBHTEtfUFdfQ1RMX0lEWF9BVVhf
QywKLQkJfSwKLQl9LAotCXsKLQkJLm5hbWUgPSAiQVVYIEQiLAotCQkuZG9tYWlucyA9IENOTF9E
SVNQTEFZX0FVWF9EX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3Bz
LAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZoc3dfcG93
ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBDTkxfUFdfQ1RMX0lEWF9BVVhfRCwKLQkJfSwK
LQl9LAotCXsKLQkJLm5hbWUgPSAiREMgb2ZmIiwKLQkJLmRvbWFpbnMgPSBDTkxfRElTUExBWV9E
Q19PRkZfUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZnZW45X2RjX29mZl9wb3dlcl93ZWxsX29w
cywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAotCX0sCi0JewotCQkubmFtZSA9ICJwb3dlciB3
ZWxsIDIiLAotCQkuZG9tYWlucyA9IENOTF9ESVNQTEFZX1BPV0VSV0VMTF8yX1BPV0VSX0RPTUFJ
TlMsCi0JCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBTS0xfRElTUF9QV18y
LAotCQl7Ci0JCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKLQkJCS5oc3cuaWR4
ID0gU0tMX1BXX0NUTF9JRFhfUFdfMiwKLQkJCS5oc3cuaXJxX3BpcGVfbWFzayA9IEJJVChQSVBF
X0IpIHwgQklUKFBJUEVfQyksCi0JCQkuaHN3Lmhhc192Z2EgPSB0cnVlLAotCQkJLmhzdy5oYXNf
ZnVzZXMgPSB0cnVlLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9ICJEREkgQSBJTyBwb3dlciB3
ZWxsIiwKLQkJLmRvbWFpbnMgPSBDTkxfRElTUExBWV9ERElfQV9JT19QT1dFUl9ET01BSU5TLAot
CQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAot
CQl7Ci0JCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywKLQkJCS5oc3cuaWR4ID0g
R0xLX1BXX0NUTF9JRFhfRERJX0EsCi0JCX0sCi0JfSwKLQl7Ci0JCS5uYW1lID0gIkRESSBCIElP
IHBvd2VyIHdlbGwiLAotCQkuZG9tYWlucyA9IENOTF9ESVNQTEFZX0RESV9CX0lPX1BPV0VSX0RP
TUFJTlMsCi0JCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lE
X05PTkUsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhz
dy5pZHggPSBTS0xfUFdfQ1RMX0lEWF9ERElfQiwKLQkJfSwKLQl9LAotCXsKLQkJLm5hbWUgPSAi
RERJIEMgSU8gcG93ZXIgd2VsbCIsCi0JCS5kb21haW5zID0gQ05MX0RJU1BMQVlfRERJX0NfSU9f
UE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJ
U1BfUFdfSURfTk9ORSwKLQkJewotCQkJLmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3Ms
Ci0JCQkuaHN3LmlkeCA9IFNLTF9QV19DVExfSURYX0RESV9DLAotCQl9LAotCX0sCi0JewotCQku
bmFtZSA9ICJEREkgRCBJTyBwb3dlciB3ZWxsIiwKLQkJLmRvbWFpbnMgPSBDTkxfRElTUExBWV9E
RElfRF9JT19QT1dFUl9ET01BSU5TLAotCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKLQkJ
LmlkID0gRElTUF9QV19JRF9OT05FLAotCQl7Ci0JCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dl
bGxfcmVncywKLQkJCS5oc3cuaWR4ID0gU0tMX1BXX0NUTF9JRFhfRERJX0QsCi0JCX0sCi0JfSwK
LQl7Ci0JCS5uYW1lID0gIkRESSBGIElPIHBvd2VyIHdlbGwiLAotCQkuZG9tYWlucyA9IENOTF9E
SVNQTEFZX0RESV9GX0lPX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxf
b3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZoc3df
cG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBDTkxfUFdfQ1RMX0lEWF9ERElfRiwKLQkJ
fSwKLQl9LAotCXsKLQkJLm5hbWUgPSAiQVVYIEYiLAotCQkuZG9tYWlucyA9IENOTF9ESVNQTEFZ
X0FVWF9GX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAotCQku
aWQgPSBESVNQX1BXX0lEX05PTkUsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZoc3dfcG93ZXJfd2Vs
bF9yZWdzLAotCQkJLmhzdy5pZHggPSBDTkxfUFdfQ1RMX0lEWF9BVVhfRiwKLQkJfSwKLQl9LAot
fTsKLQotc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfb3BzIGljbF9jb21ib19w
aHlfYXV4X3Bvd2VyX3dlbGxfb3BzID0gewotCS5zeW5jX2h3ID0gaHN3X3Bvd2VyX3dlbGxfc3lu
Y19odywKLQkuZW5hYmxlID0gaWNsX2NvbWJvX3BoeV9hdXhfcG93ZXJfd2VsbF9lbmFibGUsCi0J
LmRpc2FibGUgPSBpY2xfY29tYm9fcGh5X2F1eF9wb3dlcl93ZWxsX2Rpc2FibGUsCi0JLmlzX2Vu
YWJsZWQgPSBoc3dfcG93ZXJfd2VsbF9lbmFibGVkLAotfTsKLQotc3RhdGljIGNvbnN0IHN0cnVj
dCBpOTE1X3Bvd2VyX3dlbGxfb3BzIGljbF90Y19waHlfYXV4X3Bvd2VyX3dlbGxfb3BzID0gewot
CS5zeW5jX2h3ID0gaHN3X3Bvd2VyX3dlbGxfc3luY19odywKLQkuZW5hYmxlID0gaWNsX3RjX3Bo
eV9hdXhfcG93ZXJfd2VsbF9lbmFibGUsCi0JLmRpc2FibGUgPSBoc3dfcG93ZXJfd2VsbF9kaXNh
YmxlLAotCS5pc19lbmFibGVkID0gaHN3X3Bvd2VyX3dlbGxfZW5hYmxlZCwKLX07Ci0KLXN0YXRp
YyBjb25zdCBzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsX3JlZ3MgaWNsX2F1eF9wb3dlcl93ZWxsX3Jl
Z3MgPSB7Ci0JLmJpb3MJPSBJQ0xfUFdSX1dFTExfQ1RMX0FVWDEsCi0JLmRyaXZlcgk9IElDTF9Q
V1JfV0VMTF9DVExfQVVYMiwKLQkuZGVidWcJPSBJQ0xfUFdSX1dFTExfQ1RMX0FVWDQsCi19Owot
Ci1zdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfcG93ZXJfd2VsbF9yZWdzIGljbF9kZGlfcG93ZXJf
d2VsbF9yZWdzID0gewotCS5iaW9zCT0gSUNMX1BXUl9XRUxMX0NUTF9EREkxLAotCS5kcml2ZXIJ
PSBJQ0xfUFdSX1dFTExfQ1RMX0RESTIsCi0JLmRlYnVnCT0gSUNMX1BXUl9XRUxMX0NUTF9EREk0
LAotfTsKLQotc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3Bvd2VyX3dlbGxfZGVzYyBpY2xfcG93
ZXJfd2VsbHNbXSA9IHsKLQl7Ci0JCS5uYW1lID0gImFsd2F5cy1vbiIsCi0JCS5hbHdheXNfb24g
PSB0cnVlLAotCQkuZG9tYWlucyA9IFBPV0VSX0RPTUFJTl9NQVNLLAotCQkub3BzID0gJmk5eHhf
YWx3YXlzX29uX3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JfSwK
LQl7Ci0JCS5uYW1lID0gInBvd2VyIHdlbGwgMSIsCi0JCS8qIEhhbmRsZWQgYnkgdGhlIERNQyBm
aXJtd2FyZSAqLwotCQkuYWx3YXlzX29uID0gdHJ1ZSwKLQkJLmRvbWFpbnMgPSAwLAotCQkub3Bz
ID0gJmhzd19wb3dlcl93ZWxsX29wcywKLQkJLmlkID0gU0tMX0RJU1BfUFdfMSwKLQkJewotCQkJ
Lmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3MsCi0JCQkuaHN3LmlkeCA9IElDTF9QV19D
VExfSURYX1BXXzEsCi0JCQkuaHN3Lmhhc19mdXNlcyA9IHRydWUsCi0JCX0sCi0JfSwKLQl7Ci0J
CS5uYW1lID0gIkRDIG9mZiIsCi0JCS5kb21haW5zID0gSUNMX0RJU1BMQVlfRENfT0ZGX1BPV0VS
X0RPTUFJTlMsCi0JCS5vcHMgPSAmZ2VuOV9kY19vZmZfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9
IERJU1BfUFdfSURfTk9ORSwKLQl9LAotCXsKLQkJLm5hbWUgPSAicG93ZXIgd2VsbCAyIiwKLQkJ
LmRvbWFpbnMgPSBJQ0xfUFdfMl9QT1dFUl9ET01BSU5TLAotCQkub3BzID0gJmhzd19wb3dlcl93
ZWxsX29wcywKLQkJLmlkID0gU0tMX0RJU1BfUFdfMiwKLQkJewotCQkJLmhzdy5yZWdzID0gJmhz
d19wb3dlcl93ZWxsX3JlZ3MsCi0JCQkuaHN3LmlkeCA9IElDTF9QV19DVExfSURYX1BXXzIsCi0J
CQkuaHN3Lmhhc19mdXNlcyA9IHRydWUsCi0JCX0sCi0JfSwKLQl7Ci0JCS5uYW1lID0gInBvd2Vy
IHdlbGwgMyIsCi0JCS5kb21haW5zID0gSUNMX1BXXzNfUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9
ICZoc3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKLQkJewotCQkJ
Lmhzdy5yZWdzID0gJmhzd19wb3dlcl93ZWxsX3JlZ3MsCi0JCQkuaHN3LmlkeCA9IElDTF9QV19D
VExfSURYX1BXXzMsCi0JCQkuaHN3LmlycV9waXBlX21hc2sgPSBCSVQoUElQRV9CKSwKLQkJCS5o
c3cuaGFzX3ZnYSA9IHRydWUsCi0JCQkuaHN3Lmhhc19mdXNlcyA9IHRydWUsCi0JCX0sCi0JfSwK
LQl7Ci0JCS5uYW1lID0gIkRESSBBIElPIiwKLQkJLmRvbWFpbnMgPSBJQ0xfRERJX0lPX0FfUE9X
RVJfRE9NQUlOUywKLQkJLm9wcyA9ICZoc3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1Bf
UFdfSURfTk9ORSwKLQkJewotCQkJLmhzdy5yZWdzID0gJmljbF9kZGlfcG93ZXJfd2VsbF9yZWdz
LAotCQkJLmhzdy5pZHggPSBJQ0xfUFdfQ1RMX0lEWF9ERElfQSwKLQkJfSwKLQl9LAotCXsKLQkJ
Lm5hbWUgPSAiRERJIEIgSU8iLAotCQkuZG9tYWlucyA9IElDTF9ERElfSU9fQl9QT1dFUl9ET01B
SU5TLAotCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElTUF9QV19JRF9O
T05FLAotCQl7Ci0JCQkuaHN3LnJlZ3MgPSAmaWNsX2RkaV9wb3dlcl93ZWxsX3JlZ3MsCi0JCQku
aHN3LmlkeCA9IElDTF9QV19DVExfSURYX0RESV9CLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9
ICJEREkgQyBJTyIsCi0JCS5kb21haW5zID0gSUNMX0RESV9JT19DX1BPV0VSX0RPTUFJTlMsCi0J
CS5vcHMgPSAmaHN3X3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0J
CXsKLQkJCS5oc3cucmVncyA9ICZpY2xfZGRpX3Bvd2VyX3dlbGxfcmVncywKLQkJCS5oc3cuaWR4
ID0gSUNMX1BXX0NUTF9JRFhfRERJX0MsCi0JCX0sCi0JfSwKLQl7Ci0JCS5uYW1lID0gIkRESSBE
IElPIiwKLQkJLmRvbWFpbnMgPSBJQ0xfRERJX0lPX0RfUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9
ICZoc3dfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKLQkJewotCQkJ
Lmhzdy5yZWdzID0gJmljbF9kZGlfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBJQ0xf
UFdfQ1RMX0lEWF9ERElfRCwKLQkJfSwKLQl9LAotCXsKLQkJLm5hbWUgPSAiRERJIEUgSU8iLAot
CQkuZG9tYWlucyA9IElDTF9ERElfSU9fRV9QT1dFUl9ET01BSU5TLAotCQkub3BzID0gJmhzd19w
b3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAotCQl7Ci0JCQkuaHN3LnJl
Z3MgPSAmaWNsX2RkaV9wb3dlcl93ZWxsX3JlZ3MsCi0JCQkuaHN3LmlkeCA9IElDTF9QV19DVExf
SURYX0RESV9FLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9ICJEREkgRiBJTyIsCi0JCS5kb21h
aW5zID0gSUNMX0RESV9JT19GX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmaHN3X3Bvd2VyX3dl
bGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZp
Y2xfZGRpX3Bvd2VyX3dlbGxfcmVncywKLQkJCS5oc3cuaWR4ID0gSUNMX1BXX0NUTF9JRFhfRERJ
X0YsCi0JCX0sCi0JfSwKLQl7Ci0JCS5uYW1lID0gIkFVWCBBIiwKLQkJLmRvbWFpbnMgPSBJQ0xf
QVVYX0FfSU9fUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZpY2xfY29tYm9fcGh5X2F1eF9wb3dl
cl93ZWxsX29wcywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAotCQl7Ci0JCQkuaHN3LnJlZ3Mg
PSAmaWNsX2F1eF9wb3dlcl93ZWxsX3JlZ3MsCi0JCQkuaHN3LmlkeCA9IElDTF9QV19DVExfSURY
X0FVWF9BLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9ICJBVVggQiIsCi0JCS5kb21haW5zID0g
SUNMX0FVWF9CX0lPX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmaWNsX2NvbWJvX3BoeV9hdXhf
cG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKLQkJewotCQkJLmhzdy5y
ZWdzID0gJmljbF9hdXhfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBJQ0xfUFdfQ1RM
X0lEWF9BVVhfQiwKLQkJfSwKLQl9LAotCXsKLQkJLm5hbWUgPSAiQVVYIEMiLAotCQkuZG9tYWlu
cyA9IElDTF9BVVhfQ19JT19QT1dFUl9ET01BSU5TLAotCQkub3BzID0gJmljbF90Y19waHlfYXV4
X3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JCXsKLQkJCS5oc3cu
cmVncyA9ICZpY2xfYXV4X3Bvd2VyX3dlbGxfcmVncywKLQkJCS5oc3cuaWR4ID0gSUNMX1BXX0NU
TF9JRFhfQVVYX0MsCi0JCQkuaHN3LmlzX3RjX3RidCA9IGZhbHNlLAotCQl9LAotCX0sCi0Jewot
CQkubmFtZSA9ICJBVVggRCIsCi0JCS5kb21haW5zID0gSUNMX0FVWF9EX0lPX1BPV0VSX0RPTUFJ
TlMsCi0JCS5vcHMgPSAmaWNsX3RjX3BoeV9hdXhfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJ
U1BfUFdfSURfTk9ORSwKLQkJewotCQkJLmhzdy5yZWdzID0gJmljbF9hdXhfcG93ZXJfd2VsbF9y
ZWdzLAotCQkJLmhzdy5pZHggPSBJQ0xfUFdfQ1RMX0lEWF9BVVhfRCwKLQkJCS5oc3cuaXNfdGNf
dGJ0ID0gZmFsc2UsCi0JCX0sCi0JfSwKLQl7Ci0JCS5uYW1lID0gIkFVWCBFIiwKLQkJLmRvbWFp
bnMgPSBJQ0xfQVVYX0VfSU9fUE9XRVJfRE9NQUlOUywKLQkJLm9wcyA9ICZpY2xfdGNfcGh5X2F1
eF9wb3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElTUF9QV19JRF9OT05FLAotCQl7Ci0JCQkuaHN3
LnJlZ3MgPSAmaWNsX2F1eF9wb3dlcl93ZWxsX3JlZ3MsCi0JCQkuaHN3LmlkeCA9IElDTF9QV19D
VExfSURYX0FVWF9FLAotCQkJLmhzdy5pc190Y190YnQgPSBmYWxzZSwKLQkJfSwKLQl9LAotCXsK
LQkJLm5hbWUgPSAiQVVYIEYiLAotCQkuZG9tYWlucyA9IElDTF9BVVhfRl9JT19QT1dFUl9ET01B
SU5TLAotCQkub3BzID0gJmljbF90Y19waHlfYXV4X3Bvd2VyX3dlbGxfb3BzLAotCQkuaWQgPSBE
SVNQX1BXX0lEX05PTkUsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZpY2xfYXV4X3Bvd2VyX3dlbGxf
cmVncywKLQkJCS5oc3cuaWR4ID0gSUNMX1BXX0NUTF9JRFhfQVVYX0YsCi0JCQkuaHN3LmlzX3Rj
X3RidCA9IGZhbHNlLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9ICJBVVggVEJUMSIsCi0JCS5k
b21haW5zID0gSUNMX0FVWF9UQlQxX0lPX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmaWNsX3Rj
X3BoeV9hdXhfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKLQkJewot
CQkJLmhzdy5yZWdzID0gJmljbF9hdXhfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBJ
Q0xfUFdfQ1RMX0lEWF9BVVhfVEJUMSwKLQkJCS5oc3cuaXNfdGNfdGJ0ID0gdHJ1ZSwKLQkJfSwK
LQl9LAotCXsKLQkJLm5hbWUgPSAiQVVYIFRCVDIiLAotCQkuZG9tYWlucyA9IElDTF9BVVhfVEJU
Ml9JT19QT1dFUl9ET01BSU5TLAotCQkub3BzID0gJmljbF90Y19waHlfYXV4X3Bvd2VyX3dlbGxf
b3BzLAotCQkuaWQgPSBESVNQX1BXX0lEX05PTkUsCi0JCXsKLQkJCS5oc3cucmVncyA9ICZpY2xf
YXV4X3Bvd2VyX3dlbGxfcmVncywKLQkJCS5oc3cuaWR4ID0gSUNMX1BXX0NUTF9JRFhfQVVYX1RC
VDIsCi0JCQkuaHN3LmlzX3RjX3RidCA9IHRydWUsCi0JCX0sCi0JfSwKLQl7Ci0JCS5uYW1lID0g
IkFVWCBUQlQzIiwKLQkJLmRvbWFpbnMgPSBJQ0xfQVVYX1RCVDNfSU9fUE9XRVJfRE9NQUlOUywK
LQkJLm9wcyA9ICZpY2xfdGNfcGh5X2F1eF9wb3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElTUF9Q
V19JRF9OT05FLAotCQl7Ci0JCQkuaHN3LnJlZ3MgPSAmaWNsX2F1eF9wb3dlcl93ZWxsX3JlZ3Ms
Ci0JCQkuaHN3LmlkeCA9IElDTF9QV19DVExfSURYX0FVWF9UQlQzLAotCQkJLmhzdy5pc190Y190
YnQgPSB0cnVlLAotCQl9LAotCX0sCi0JewotCQkubmFtZSA9ICJBVVggVEJUNCIsCi0JCS5kb21h
aW5zID0gSUNMX0FVWF9UQlQ0X0lPX1BPV0VSX0RPTUFJTlMsCi0JCS5vcHMgPSAmaWNsX3RjX3Bo
eV9hdXhfcG93ZXJfd2VsbF9vcHMsCi0JCS5pZCA9IERJU1BfUFdfSURfTk9ORSwKLQkJewotCQkJ
Lmhzdy5yZWdzID0gJmljbF9hdXhfcG93ZXJfd2VsbF9yZWdzLAotCQkJLmhzdy5pZHggPSBJQ0xf
UFdfQ1RMX0lEWF9BVVhfVEJUNCwKLQkJCS5oc3cuaXNfdGNfdGJ0ID0gdHJ1ZSwKLQkJfSwKLQl9
LAotCXsKLQkJLm5hbWUgPSAicG93ZXIgd2VsbCA0IiwKLQkJLmRvbWFpbnMgPSBJQ0xfUFdfNF9Q
T1dFUl9ET01BSU5TLAotCQkub3BzID0gJmhzd19wb3dlcl93ZWxsX29wcywKLQkJLmlkID0gRElT
UF9QV19JRF9OT05FLAotCQl7Ci0JCQkuaHN3LnJlZ3MgPSAmaHN3X3Bvd2VyX3dlbGxfcmVncywK
LQkJCS5oc3cuaWR4ID0gSUNMX1BXX0NUTF9JRFhfUFdfNCwKLQkJCS5oc3cuaGFzX2Z1c2VzID0g
dHJ1ZSwKLQkJCS5oc3cuaXJxX3BpcGVfbWFzayA9IEJJVChQSVBFX0MpLAotCQl9LAotCX0sCi19
OwotCi1zdGF0aWMgaW50Ci1zYW5pdGl6ZV9kaXNhYmxlX3Bvd2VyX3dlbGxfb3B0aW9uKGNvbnN0
IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgICBpbnQgZGlzYWJsZV9w
b3dlcl93ZWxsKQotewotCWlmIChkaXNhYmxlX3Bvd2VyX3dlbGwgPj0gMCkKLQkJcmV0dXJuICEh
ZGlzYWJsZV9wb3dlcl93ZWxsOwotCi0JcmV0dXJuIDE7Ci19Ci0KLXN0YXRpYyB1MzIgZ2V0X2Fs
bG93ZWRfZGNfbWFzayhjb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCi0J
CQkgICAgICAgaW50IGVuYWJsZV9kYykKLXsKLQl1MzIgbWFzazsKLQlpbnQgcmVxdWVzdGVkX2Rj
OwotCWludCBtYXhfZGM7Ci0KLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkgewotCQlt
YXhfZGMgPSAyOwotCQkvKgotCQkgKiBEQzkgaGFzIGEgc2VwYXJhdGUgSFcgZmxvdyBmcm9tIHRo
ZSByZXN0IG9mIHRoZSBEQyBzdGF0ZXMsCi0JCSAqIG5vdCBkZXBlbmRpbmcgb24gdGhlIERNQyBm
aXJtd2FyZS4gSXQncyBuZWVkZWQgYnkgc3lzdGVtCi0JCSAqIHN1c3BlbmQvcmVzdW1lLCBzbyBh
bGxvdyBpdCB1bmNvbmRpdGlvbmFsbHkuCi0JCSAqLwotCQltYXNrID0gRENfU1RBVEVfRU5fREM5
OwotCX0gZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCAxMCkgfHwgSVNfR0VOOV9CQyhkZXZfcHJp
dikpIHsKLQkJbWF4X2RjID0gMjsKLQkJbWFzayA9IDA7Ci0JfSBlbHNlIGlmIChJU19HRU45X0xQ
KGRldl9wcml2KSkgewotCQltYXhfZGMgPSAxOwotCQltYXNrID0gRENfU1RBVEVfRU5fREM5Owot
CX0gZWxzZSB7Ci0JCW1heF9kYyA9IDA7Ci0JCW1hc2sgPSAwOwotCX0KLQotCWlmICghaTkxNV9t
b2RwYXJhbXMuZGlzYWJsZV9wb3dlcl93ZWxsKQotCQltYXhfZGMgPSAwOwotCi0JaWYgKGVuYWJs
ZV9kYyA+PSAwICYmIGVuYWJsZV9kYyA8PSBtYXhfZGMpIHsKLQkJcmVxdWVzdGVkX2RjID0gZW5h
YmxlX2RjOwotCX0gZWxzZSBpZiAoZW5hYmxlX2RjID09IC0xKSB7Ci0JCXJlcXVlc3RlZF9kYyA9
IG1heF9kYzsKLQl9IGVsc2UgaWYgKGVuYWJsZV9kYyA+IG1heF9kYyAmJiBlbmFibGVfZGMgPD0g
MikgewotCQlEUk1fREVCVUdfS01TKCJBZGp1c3RpbmcgcmVxdWVzdGVkIG1heCBEQyBzdGF0ZSAo
JWQtPiVkKVxuIiwKLQkJCSAgICAgIGVuYWJsZV9kYywgbWF4X2RjKTsKLQkJcmVxdWVzdGVkX2Rj
ID0gbWF4X2RjOwotCX0gZWxzZSB7Ci0JCURSTV9FUlJPUigiVW5leHBlY3RlZCB2YWx1ZSBmb3Ig
ZW5hYmxlX2RjICglZClcbiIsIGVuYWJsZV9kYyk7Ci0JCXJlcXVlc3RlZF9kYyA9IG1heF9kYzsK
LQl9Ci0KLQlpZiAocmVxdWVzdGVkX2RjID4gMSkKLQkJbWFzayB8PSBEQ19TVEFURV9FTl9VUFRP
X0RDNjsKLQlpZiAocmVxdWVzdGVkX2RjID4gMCkKLQkJbWFzayB8PSBEQ19TVEFURV9FTl9VUFRP
X0RDNTsKLQotCURSTV9ERUJVR19LTVMoIkFsbG93ZWQgREMgc3RhdGUgbWFzayAlMDJ4XG4iLCBt
YXNrKTsKLQotCXJldHVybiBtYXNrOwotfQotCi1zdGF0aWMgaW50Ci1fX3NldF9wb3dlcl93ZWxs
cyhzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zLAotCQkgIGNvbnN0IHN0
cnVjdCBpOTE1X3Bvd2VyX3dlbGxfZGVzYyAqcG93ZXJfd2VsbF9kZXNjcywKLQkJICBpbnQgcG93
ZXJfd2VsbF9jb3VudCkKLXsKLQl1NjQgcG93ZXJfd2VsbF9pZHMgPSAwOwotCWludCBpOwotCi0J
cG93ZXJfZG9tYWlucy0+cG93ZXJfd2VsbF9jb3VudCA9IHBvd2VyX3dlbGxfY291bnQ7Ci0JcG93
ZXJfZG9tYWlucy0+cG93ZXJfd2VsbHMgPQotCQkJCWtjYWxsb2MocG93ZXJfd2VsbF9jb3VudCwK
LQkJCQkJc2l6ZW9mKCpwb3dlcl9kb21haW5zLT5wb3dlcl93ZWxscyksCi0JCQkJCUdGUF9LRVJO
RUwpOwotCWlmICghcG93ZXJfZG9tYWlucy0+cG93ZXJfd2VsbHMpCi0JCXJldHVybiAtRU5PTUVN
OwotCi0JZm9yIChpID0gMDsgaSA8IHBvd2VyX3dlbGxfY291bnQ7IGkrKykgewotCQllbnVtIGk5
MTVfcG93ZXJfd2VsbF9pZCBpZCA9IHBvd2VyX3dlbGxfZGVzY3NbaV0uaWQ7Ci0KLQkJcG93ZXJf
ZG9tYWlucy0+cG93ZXJfd2VsbHNbaV0uZGVzYyA9ICZwb3dlcl93ZWxsX2Rlc2NzW2ldOwotCi0J
CWlmIChpZCA9PSBESVNQX1BXX0lEX05PTkUpCi0JCQljb250aW51ZTsKLQotCQlXQVJOX09OKGlk
ID49IHNpemVvZihwb3dlcl93ZWxsX2lkcykgKiA4KTsKLQkJV0FSTl9PTihwb3dlcl93ZWxsX2lk
cyAmIEJJVF9VTEwoaWQpKTsKLQkJcG93ZXJfd2VsbF9pZHMgfD0gQklUX1VMTChpZCk7Ci0JfQot
Ci0JcmV0dXJuIDA7Ci19Ci0KLSNkZWZpbmUgc2V0X3Bvd2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMs
IF9fcG93ZXJfd2VsbF9kZXNjcykgXAotCV9fc2V0X3Bvd2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMs
IF9fcG93ZXJfd2VsbF9kZXNjcywgXAotCQkJICBBUlJBWV9TSVpFKF9fcG93ZXJfd2VsbF9kZXNj
cykpCi0KLS8qKgotICogaW50ZWxfcG93ZXJfZG9tYWluc19pbml0IC0gaW5pdGlhbGl6ZXMgdGhl
IHBvd2VyIGRvbWFpbiBzdHJ1Y3R1cmVzCi0gKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIGluc3Rh
bmNlCi0gKgotICogSW5pdGlhbGl6ZXMgdGhlIHBvd2VyIGRvbWFpbiBzdHJ1Y3R1cmVzIGZvciBA
ZGV2X3ByaXYgZGVwZW5kaW5nIHVwb24gdGhlCi0gKiBzdXBwb3J0ZWQgcGxhdGZvcm0uCi0gKi8K
LWludCBpbnRlbF9wb3dlcl9kb21haW5zX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAm
ZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Ci0JaW50IGVycjsKLQotCWk5MTVfbW9kcGFyYW1zLmRp
c2FibGVfcG93ZXJfd2VsbCA9Ci0JCXNhbml0aXplX2Rpc2FibGVfcG93ZXJfd2VsbF9vcHRpb24o
ZGV2X3ByaXYsCi0JCQkJCQkgICBpOTE1X21vZHBhcmFtcy5kaXNhYmxlX3Bvd2VyX3dlbGwpOwot
CWRldl9wcml2LT5jc3IuYWxsb3dlZF9kY19tYXNrID0KLQkJZ2V0X2FsbG93ZWRfZGNfbWFzayhk
ZXZfcHJpdiwgaTkxNV9tb2RwYXJhbXMuZW5hYmxlX2RjKTsKLQotCUJVSUxEX0JVR19PTihQT1dF
Ul9ET01BSU5fTlVNID4gNjQpOwotCi0JbXV0ZXhfaW5pdCgmcG93ZXJfZG9tYWlucy0+bG9jayk7
Ci0KLQlJTklUX0RFTEFZRURfV09SSygmcG93ZXJfZG9tYWlucy0+YXN5bmNfcHV0X3dvcmssCi0J
CQkgIGludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jX3dvcmspOwotCi0JLyoKLQkgKiBUaGUg
ZW5hYmxpbmcgb3JkZXIgd2lsbCBiZSBmcm9tIGxvd2VyIHRvIGhpZ2hlciBpbmRleGVkIHdlbGxz
LAotCSAqIHRoZSBkaXNhYmxpbmcgb3JkZXIgaXMgcmV2ZXJzZWQuCi0JICovCi0JaWYgKElTX0dF
TihkZXZfcHJpdiwgMTEpKSB7Ci0JCWVyciA9IHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5z
LCBpY2xfcG93ZXJfd2VsbHMpOwotCX0gZWxzZSBpZiAoSVNfQ0FOTk9OTEFLRShkZXZfcHJpdikp
IHsKLQkJZXJyID0gc2V0X3Bvd2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMsIGNubF9wb3dlcl93ZWxs
cyk7Ci0KLQkJLyoKLQkJICogRERJIGFuZCBBdXggSU8gYXJlIGdldHRpbmcgZW5hYmxlZCBmb3Ig
YWxsIHBvcnRzCi0JCSAqIHJlZ2FyZGxlc3MgdGhlIHByZXNlbmNlIG9yIHVzZS4gU28sIGluIG9y
ZGVyIHRvIGF2b2lkCi0JCSAqIHRpbWVvdXRzLCBsZXRzIHJlbW92ZSB0aGVtIGZyb20gdGhlIGxp
c3QKLQkJICogZm9yIHRoZSBTS1VzIHdpdGhvdXQgcG9ydCBGLgotCQkgKi8KLQkJaWYgKCFJU19D
TkxfV0lUSF9QT1JUX0YoZGV2X3ByaXYpKQotCQkJcG93ZXJfZG9tYWlucy0+cG93ZXJfd2VsbF9j
b3VudCAtPSAyOwotCX0gZWxzZSBpZiAoSVNfR0VNSU5JTEFLRShkZXZfcHJpdikpIHsKLQkJZXJy
ID0gc2V0X3Bvd2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMsIGdsa19wb3dlcl93ZWxscyk7Ci0JfSBl
bHNlIGlmIChJU19CUk9YVE9OKGRldl9wcml2KSkgewotCQllcnIgPSBzZXRfcG93ZXJfd2VsbHMo
cG93ZXJfZG9tYWlucywgYnh0X3Bvd2VyX3dlbGxzKTsKLQl9IGVsc2UgaWYgKElTX0dFTjlfQkMo
ZGV2X3ByaXYpKSB7Ci0JCWVyciA9IHNldF9wb3dlcl93ZWxscyhwb3dlcl9kb21haW5zLCBza2xf
cG93ZXJfd2VsbHMpOwotCX0gZWxzZSBpZiAoSVNfQ0hFUlJZVklFVyhkZXZfcHJpdikpIHsKLQkJ
ZXJyID0gc2V0X3Bvd2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMsIGNodl9wb3dlcl93ZWxscyk7Ci0J
fSBlbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKSB7Ci0JCWVyciA9IHNldF9wb3dlcl93
ZWxscyhwb3dlcl9kb21haW5zLCBiZHdfcG93ZXJfd2VsbHMpOwotCX0gZWxzZSBpZiAoSVNfSEFT
V0VMTChkZXZfcHJpdikpIHsKLQkJZXJyID0gc2V0X3Bvd2VyX3dlbGxzKHBvd2VyX2RvbWFpbnMs
IGhzd19wb3dlcl93ZWxscyk7Ci0JfSBlbHNlIGlmIChJU19WQUxMRVlWSUVXKGRldl9wcml2KSkg
ewotCQllcnIgPSBzZXRfcG93ZXJfd2VsbHMocG93ZXJfZG9tYWlucywgdmx2X3Bvd2VyX3dlbGxz
KTsKLQl9IGVsc2UgaWYgKElTX0k4MzAoZGV2X3ByaXYpKSB7Ci0JCWVyciA9IHNldF9wb3dlcl93
ZWxscyhwb3dlcl9kb21haW5zLCBpODMwX3Bvd2VyX3dlbGxzKTsKLQl9IGVsc2UgewotCQllcnIg
PSBzZXRfcG93ZXJfd2VsbHMocG93ZXJfZG9tYWlucywgaTl4eF9hbHdheXNfb25fcG93ZXJfd2Vs
bCk7Ci0JfQotCi0JcmV0dXJuIGVycjsKLX0KLQotLyoqCi0gKiBpbnRlbF9wb3dlcl9kb21haW5z
X2NsZWFudXAgLSBjbGVhbiB1cCBwb3dlciBkb21haW5zIHJlc291cmNlcwotICogQGRldl9wcml2
OiBpOTE1IGRldmljZSBpbnN0YW5jZQotICoKLSAqIFJlbGVhc2UgYW55IHJlc291cmNlcyBhY3F1
aXJlZCBieSBpbnRlbF9wb3dlcl9kb21haW5zX2luaXQoKQotICovCi12b2lkIGludGVsX3Bvd2Vy
X2RvbWFpbnNfY2xlYW51cChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0J
a2ZyZWUoZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnMucG93ZXJfd2VsbHMpOwotfQotCi1zdGF0aWMg
dm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX3N5bmNfaHcoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMg
PSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Ci0Jc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqcG93
ZXJfd2VsbDsKLQotCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwotCWZvcl9lYWNo
X3Bvd2VyX3dlbGwoZGV2X3ByaXYsIHBvd2VyX3dlbGwpIHsKLQkJcG93ZXJfd2VsbC0+ZGVzYy0+
b3BzLT5zeW5jX2h3KGRldl9wcml2LCBwb3dlcl93ZWxsKTsKLQkJcG93ZXJfd2VsbC0+aHdfZW5h
YmxlZCA9Ci0JCQlwb3dlcl93ZWxsLT5kZXNjLT5vcHMtPmlzX2VuYWJsZWQoZGV2X3ByaXYsIHBv
d2VyX3dlbGwpOwotCX0KLQltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwotfQot
Ci1zdGF0aWMgaW5saW5lCi1ib29sIGludGVsX2RidWZfc2xpY2Vfc2V0KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAgaTkxNV9yZWdfdCByZWcsIGJvb2wgZW5hYmxlKQot
ewotCXUzMiB2YWwsIHN0YXR1czsKLQotCXZhbCA9IEk5MTVfUkVBRChyZWcpOwotCXZhbCA9IGVu
YWJsZSA/ICh2YWwgfCBEQlVGX1BPV0VSX1JFUVVFU1QpIDogKHZhbCAmIH5EQlVGX1BPV0VSX1JF
UVVFU1QpOwotCUk5MTVfV1JJVEUocmVnLCB2YWwpOwotCVBPU1RJTkdfUkVBRChyZWcpOwotCXVk
ZWxheSgxMCk7Ci0KLQlzdGF0dXMgPSBJOTE1X1JFQUQocmVnKSAmIERCVUZfUE9XRVJfU1RBVEU7
Ci0JaWYgKChlbmFibGUgJiYgIXN0YXR1cykgfHwgKCFlbmFibGUgJiYgc3RhdHVzKSkgewotCQlE
Uk1fRVJST1IoIkRCdXMgcG93ZXIgJXMgdGltZW91dCFcbiIsCi0JCQkgIGVuYWJsZSA/ICJlbmFi
bGUiIDogImRpc2FibGUiKTsKLQkJcmV0dXJuIGZhbHNlOwotCX0KLQlyZXR1cm4gdHJ1ZTsKLX0K
LQotc3RhdGljIHZvaWQgZ2VuOV9kYnVmX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYpCi17Ci0JaW50ZWxfZGJ1Zl9zbGljZV9zZXQoZGV2X3ByaXYsIERCVUZfQ1RMLCB0
cnVlKTsKLX0KLQotc3RhdGljIHZvaWQgZ2VuOV9kYnVmX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQotewotCWludGVsX2RidWZfc2xpY2Vfc2V0KGRldl9wcml2LCBE
QlVGX0NUTCwgZmFsc2UpOwotfQotCi1zdGF0aWMgdTggaW50ZWxfZGJ1Zl9tYXhfc2xpY2VzKHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlpZiAoSU5URUxfR0VOKGRldl9w
cml2KSA8IDExKQotCQlyZXR1cm4gMTsKLQlyZXR1cm4gMjsKLX0KLQotdm9pZCBpY2xfZGJ1Zl9z
bGljZXNfdXBkYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCSAgICB1
OCByZXFfc2xpY2VzKQotewotCWNvbnN0IHU4IGh3X2VuYWJsZWRfc2xpY2VzID0gZGV2X3ByaXYt
PndtLnNrbF9ody5kZGIuZW5hYmxlZF9zbGljZXM7Ci0JYm9vbCByZXQ7Ci0KLQlpZiAocmVxX3Ns
aWNlcyA+IGludGVsX2RidWZfbWF4X3NsaWNlcyhkZXZfcHJpdikpIHsKLQkJRFJNX0VSUk9SKCJJ
bnZhbGlkIG51bWJlciBvZiBkYnVmIHNsaWNlcyByZXF1ZXN0ZWRcbiIpOwotCQlyZXR1cm47Ci0J
fQotCi0JaWYgKHJlcV9zbGljZXMgPT0gaHdfZW5hYmxlZF9zbGljZXMgfHwgcmVxX3NsaWNlcyA9
PSAwKQotCQlyZXR1cm47Ci0KLQlpZiAocmVxX3NsaWNlcyA+IGh3X2VuYWJsZWRfc2xpY2VzKQot
CQlyZXQgPSBpbnRlbF9kYnVmX3NsaWNlX3NldChkZXZfcHJpdiwgREJVRl9DVExfUzIsIHRydWUp
OwotCWVsc2UKLQkJcmV0ID0gaW50ZWxfZGJ1Zl9zbGljZV9zZXQoZGV2X3ByaXYsIERCVUZfQ1RM
X1MyLCBmYWxzZSk7Ci0KLQlpZiAocmV0KQotCQlkZXZfcHJpdi0+d20uc2tsX2h3LmRkYi5lbmFi
bGVkX3NsaWNlcyA9IHJlcV9zbGljZXM7Ci19Ci0KLXN0YXRpYyB2b2lkIGljbF9kYnVmX2VuYWJs
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JSTkxNV9XUklURShEQlVG
X0NUTF9TMSwgSTkxNV9SRUFEKERCVUZfQ1RMX1MxKSB8IERCVUZfUE9XRVJfUkVRVUVTVCk7Ci0J
STkxNV9XUklURShEQlVGX0NUTF9TMiwgSTkxNV9SRUFEKERCVUZfQ1RMX1MyKSB8IERCVUZfUE9X
RVJfUkVRVUVTVCk7Ci0JUE9TVElOR19SRUFEKERCVUZfQ1RMX1MyKTsKLQotCXVkZWxheSgxMCk7
Ci0KLQlpZiAoIShJOTE1X1JFQUQoREJVRl9DVExfUzEpICYgREJVRl9QT1dFUl9TVEFURSkgfHwK
LQkgICAgIShJOTE1X1JFQUQoREJVRl9DVExfUzIpICYgREJVRl9QT1dFUl9TVEFURSkpCi0JCURS
TV9FUlJPUigiREJ1ZiBwb3dlciBlbmFibGUgdGltZW91dFxuIik7Ci0JZWxzZQotCQkvKgotCQkg
KiBGSVhNRTogZm9yIG5vdyBwcmV0ZW5kIHRoYXQgd2Ugb25seSBoYXZlIDEgc2xpY2UsIHNlZQot
CQkgKiBpbnRlbF9lbmFibGVkX2RidWZfc2xpY2VzX251bSgpLgotCQkgKi8KLQkJZGV2X3ByaXYt
PndtLnNrbF9ody5kZGIuZW5hYmxlZF9zbGljZXMgPSAxOwotfQotCi1zdGF0aWMgdm9pZCBpY2xf
ZGJ1Zl9kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlJOTE1
X1dSSVRFKERCVUZfQ1RMX1MxLCBJOTE1X1JFQUQoREJVRl9DVExfUzEpICYgfkRCVUZfUE9XRVJf
UkVRVUVTVCk7Ci0JSTkxNV9XUklURShEQlVGX0NUTF9TMiwgSTkxNV9SRUFEKERCVUZfQ1RMX1My
KSAmIH5EQlVGX1BPV0VSX1JFUVVFU1QpOwotCVBPU1RJTkdfUkVBRChEQlVGX0NUTF9TMik7Ci0K
LQl1ZGVsYXkoMTApOwotCi0JaWYgKChJOTE1X1JFQUQoREJVRl9DVExfUzEpICYgREJVRl9QT1dF
Ul9TVEFURSkgfHwKLQkgICAgKEk5MTVfUkVBRChEQlVGX0NUTF9TMikgJiBEQlVGX1BPV0VSX1NU
QVRFKSkKLQkJRFJNX0VSUk9SKCJEQnVmIHBvd2VyIGRpc2FibGUgdGltZW91dCFcbiIpOwotCWVs
c2UKLQkJLyoKLQkJICogRklYTUU6IGZvciBub3cgcHJldGVuZCB0aGF0IHRoZSBmaXJzdCBzbGlj
ZSBpcyBhbHdheXMKLQkJICogZW5hYmxlZCwgc2VlIGludGVsX2VuYWJsZWRfZGJ1Zl9zbGljZXNf
bnVtKCkuCi0JCSAqLwotCQlkZXZfcHJpdi0+d20uc2tsX2h3LmRkYi5lbmFibGVkX3NsaWNlcyA9
IDE7Ci19Ci0KLXN0YXRpYyB2b2lkIGljbF9tYnVzX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KQotewotCXUzMiB2YWw7Ci0KLQl2YWwgPSBNQlVTX0FCT1hfQlRfQ1JFRElU
X1BPT0wxKDE2KSB8Ci0JICAgICAgTUJVU19BQk9YX0JUX0NSRURJVF9QT09MMigxNikgfAotCSAg
ICAgIE1CVVNfQUJPWF9CX0NSRURJVCgxKSB8Ci0JICAgICAgTUJVU19BQk9YX0JXX0NSRURJVCgx
KTsKLQotCUk5MTVfV1JJVEUoTUJVU19BQk9YX0NUTCwgdmFsKTsKLX0KLQotc3RhdGljIHZvaWQg
aHN3X2Fzc2VydF9jZGNsayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0J
dTMyIHZhbCA9IEk5MTVfUkVBRChMQ1BMTF9DVEwpOwotCi0JLyoKLQkgKiBUaGUgTENQTEwgcmVn
aXN0ZXIgc2hvdWxkIGJlIHR1cm5lZCBvbiBieSB0aGUgQklPUy4gRm9yIG5vdwotCSAqIGxldCdz
IGp1c3QgY2hlY2sgaXRzIHN0YXRlIGFuZCBwcmludCBlcnJvcnMgaW4gY2FzZQotCSAqIHNvbWV0
aGluZyBpcyB3cm9uZy4gIERvbid0IGV2ZW4gdHJ5IHRvIHR1cm4gaXQgb24uCi0JICovCi0KLQlp
ZiAodmFsICYgTENQTExfQ0RfU09VUkNFX0ZDTEspCi0JCURSTV9FUlJPUigiQ0RDTEsgc291cmNl
IGlzIG5vdCBMQ1BMTFxuIik7Ci0KLQlpZiAodmFsICYgTENQTExfUExMX0RJU0FCTEUpCi0JCURS
TV9FUlJPUigiTENQTEwgaXMgZGlzYWJsZWRcbiIpOwotfQotCi1zdGF0aWMgdm9pZCBhc3NlcnRf
Y2FuX2Rpc2FibGVfbGNwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewot
CXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKLQlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YzsKLQotCWZvcl9lYWNoX2ludGVsX2NydGMoZGV2LCBjcnRjKQotCQlJOTE1X1NU
QVRFX1dBUk4oY3J0Yy0+YWN0aXZlLCAiQ1JUQyBmb3IgcGlwZSAlYyBlbmFibGVkXG4iLAotCQkJ
CXBpcGVfbmFtZShjcnRjLT5waXBlKSk7Ci0KLQlJOTE1X1NUQVRFX1dBUk4oSTkxNV9SRUFEKEhT
V19QV1JfV0VMTF9DVEwyKSwKLQkJCSJEaXNwbGF5IHBvd2VyIHdlbGwgb25cbiIpOwotCUk5MTVf
U1RBVEVfV0FSTihJOTE1X1JFQUQoU1BMTF9DVEwpICYgU1BMTF9QTExfRU5BQkxFLAotCQkJIlNQ
TEwgZW5hYmxlZFxuIik7Ci0JSTkxNV9TVEFURV9XQVJOKEk5MTVfUkVBRChXUlBMTF9DVEwoMCkp
ICYgV1JQTExfUExMX0VOQUJMRSwKLQkJCSJXUlBMTDEgZW5hYmxlZFxuIik7Ci0JSTkxNV9TVEFU
RV9XQVJOKEk5MTVfUkVBRChXUlBMTF9DVEwoMSkpICYgV1JQTExfUExMX0VOQUJMRSwKLQkJCSJX
UlBMTDIgZW5hYmxlZFxuIik7Ci0JSTkxNV9TVEFURV9XQVJOKEk5MTVfUkVBRChQUF9TVEFUVVMo
MCkpICYgUFBfT04sCi0JCQkiUGFuZWwgcG93ZXIgb25cbiIpOwotCUk5MTVfU1RBVEVfV0FSTihJ
OTE1X1JFQUQoQkxDX1BXTV9DUFVfQ1RMMikgJiBCTE1fUFdNX0VOQUJMRSwKLQkJCSJDUFUgUFdN
MSBlbmFibGVkXG4iKTsKLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikpCi0JCUk5MTVfU1RBVEVf
V0FSTihJOTE1X1JFQUQoSFNXX0JMQ19QV00yX0NUTCkgJiBCTE1fUFdNX0VOQUJMRSwKLQkJCQki
Q1BVIFBXTTIgZW5hYmxlZFxuIik7Ci0JSTkxNV9TVEFURV9XQVJOKEk5MTVfUkVBRChCTENfUFdN
X1BDSF9DVEwxKSAmIEJMTV9QQ0hfUFdNX0VOQUJMRSwKLQkJCSJQQ0ggUFdNMSBlbmFibGVkXG4i
KTsKLQlJOTE1X1NUQVRFX1dBUk4oSTkxNV9SRUFEKFVUSUxfUElOX0NUTCkgJiBVVElMX1BJTl9F
TkFCTEUsCi0JCQkiVXRpbGl0eSBwaW4gZW5hYmxlZFxuIik7Ci0JSTkxNV9TVEFURV9XQVJOKEk5
MTVfUkVBRChQQ0hfR1RDX0NUTCkgJiBQQ0hfR1RDX0VOQUJMRSwKLQkJCSJQQ0ggR1RDIGVuYWJs
ZWRcbiIpOwotCi0JLyoKLQkgKiBJbiB0aGVvcnkgd2UgY2FuIHN0aWxsIGxlYXZlIElSUXMgZW5h
YmxlZCwgYXMgbG9uZyBhcyBvbmx5IHRoZSBIUEQKLQkgKiBpbnRlcnJ1cHRzIHJlbWFpbiBlbmFi
bGVkLiBXZSB1c2VkIHRvIGNoZWNrIGZvciB0aGF0LCBidXQgc2luY2UgaXQncwotCSAqIGdlbi1z
cGVjaWZpYyBhbmQgc2luY2Ugd2Ugb25seSBkaXNhYmxlIExDUExMIGFmdGVyIHdlIGZ1bGx5IGRp
c2FibGUKLQkgKiB0aGUgaW50ZXJydXB0cywgdGhlIGNoZWNrIGJlbG93IHNob3VsZCBiZSBlbm91
Z2guCi0JICovCi0JSTkxNV9TVEFURV9XQVJOKGludGVsX2lycXNfZW5hYmxlZChkZXZfcHJpdiks
ICJJUlFzIGVuYWJsZWRcbiIpOwotfQotCi1zdGF0aWMgdTMyIGhzd19yZWFkX2Rjb21wKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlpZiAoSVNfSEFTV0VMTChkZXZfcHJp
dikpCi0JCXJldHVybiBJOTE1X1JFQUQoRF9DT01QX0hTVyk7Ci0JZWxzZQotCQlyZXR1cm4gSTkx
NV9SRUFEKERfQ09NUF9CRFcpOwotfQotCi1zdGF0aWMgdm9pZCBoc3dfd3JpdGVfZGNvbXAoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCB1MzIgdmFsKQotewotCWlmIChJU19IQVNX
RUxMKGRldl9wcml2KSkgewotCQlpZiAoc2FuZHlicmlkZ2VfcGNvZGVfd3JpdGUoZGV2X3ByaXYs
Ci0JCQkJCSAgICBHRU42X1BDT0RFX1dSSVRFX0RfQ09NUCwgdmFsKSkKLQkJCURSTV9ERUJVR19L
TVMoIkZhaWxlZCB0byB3cml0ZSB0byBEX0NPTVBcbiIpOwotCX0gZWxzZSB7Ci0JCUk5MTVfV1JJ
VEUoRF9DT01QX0JEVywgdmFsKTsKLQkJUE9TVElOR19SRUFEKERfQ09NUF9CRFcpOwotCX0KLX0K
LQotLyoKLSAqIFRoaXMgZnVuY3Rpb24gaW1wbGVtZW50cyBwaWVjZXMgb2YgdHdvIHNlcXVlbmNl
cyBmcm9tIEJTcGVjOgotICogLSBTZXF1ZW5jZSBmb3IgZGlzcGxheSBzb2Z0d2FyZSB0byBkaXNh
YmxlIExDUExMCi0gKiAtIFNlcXVlbmNlIGZvciBkaXNwbGF5IHNvZnR3YXJlIHRvIGFsbG93IHBh
Y2thZ2UgQzgrCi0gKiBUaGUgc3RlcHMgaW1wbGVtZW50ZWQgaGVyZSBhcmUganVzdCB0aGUgc3Rl
cHMgdGhhdCBhY3R1YWxseSB0b3VjaCB0aGUgTENQTEwKLSAqIHJlZ2lzdGVyLiBDYWxsZXJzIHNo
b3VsZCB0YWtlIGNhcmUgb2YgZGlzYWJsaW5nIGFsbCB0aGUgZGlzcGxheSBlbmdpbmUKLSAqIGZ1
bmN0aW9ucywgZG9pbmcgdGhlIG1vZGUgdW5zZXQsIGZpeGluZyBpbnRlcnJ1cHRzLCBldGMuCi0g
Ki8KLXN0YXRpYyB2b2lkIGhzd19kaXNhYmxlX2xjcGxsKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKLQkJCSAgICAgIGJvb2wgc3dpdGNoX3RvX2ZjbGssIGJvb2wgYWxsb3dfcG93
ZXJfZG93bikKLXsKLQl1MzIgdmFsOwotCi0JYXNzZXJ0X2Nhbl9kaXNhYmxlX2xjcGxsKGRldl9w
cml2KTsKLQotCXZhbCA9IEk5MTVfUkVBRChMQ1BMTF9DVEwpOwotCi0JaWYgKHN3aXRjaF90b19m
Y2xrKSB7Ci0JCXZhbCB8PSBMQ1BMTF9DRF9TT1VSQ0VfRkNMSzsKLQkJSTkxNV9XUklURShMQ1BM
TF9DVEwsIHZhbCk7Ci0KLQkJaWYgKHdhaXRfZm9yX3VzKEk5MTVfUkVBRChMQ1BMTF9DVEwpICYK
LQkJCQlMQ1BMTF9DRF9TT1VSQ0VfRkNMS19ET05FLCAxKSkKLQkJCURSTV9FUlJPUigiU3dpdGNo
aW5nIHRvIEZDTEsgZmFpbGVkXG4iKTsKLQotCQl2YWwgPSBJOTE1X1JFQUQoTENQTExfQ1RMKTsK
LQl9Ci0KLQl2YWwgfD0gTENQTExfUExMX0RJU0FCTEU7Ci0JSTkxNV9XUklURShMQ1BMTF9DVEws
IHZhbCk7Ci0JUE9TVElOR19SRUFEKExDUExMX0NUTCk7Ci0KLQlpZiAoaW50ZWxfd2FpdF9mb3Jf
cmVnaXN0ZXIoJmRldl9wcml2LT51bmNvcmUsIExDUExMX0NUTCwKLQkJCQkgICAgTENQTExfUExM
X0xPQ0ssIDAsIDEpKQotCQlEUk1fRVJST1IoIkxDUExMIHN0aWxsIGxvY2tlZFxuIik7Ci0KLQl2
YWwgPSBoc3dfcmVhZF9kY29tcChkZXZfcHJpdik7Ci0JdmFsIHw9IERfQ09NUF9DT01QX0RJU0FC
TEU7Ci0JaHN3X3dyaXRlX2Rjb21wKGRldl9wcml2LCB2YWwpOwotCW5kZWxheSgxMDApOwotCi0J
aWYgKHdhaXRfZm9yKChoc3dfcmVhZF9kY29tcChkZXZfcHJpdikgJgotCQkgICAgICBEX0NPTVBf
UkNPTVBfSU5fUFJPR1JFU1MpID09IDAsIDEpKQotCQlEUk1fRVJST1IoIkRfQ09NUCBSQ09NUCBz
dGlsbCBpbiBwcm9ncmVzc1xuIik7Ci0KLQlpZiAoYWxsb3dfcG93ZXJfZG93bikgewotCQl2YWwg
PSBJOTE1X1JFQUQoTENQTExfQ1RMKTsKLQkJdmFsIHw9IExDUExMX1BPV0VSX0RPV05fQUxMT1c7
Ci0JCUk5MTVfV1JJVEUoTENQTExfQ1RMLCB2YWwpOwotCQlQT1NUSU5HX1JFQUQoTENQTExfQ1RM
KTsKLQl9Ci19Ci0KLS8qCi0gKiBGdWxseSByZXN0b3JlcyBMQ1BMTCwgZGlzYWxsb3dpbmcgcG93
ZXIgZG93biBhbmQgc3dpdGNoaW5nIGJhY2sgdG8gTENQTEwKLSAqIHNvdXJjZS4KLSAqLwotc3Rh
dGljIHZvaWQgaHN3X3Jlc3RvcmVfbGNwbGwoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQotewotCXUzMiB2YWw7Ci0KLQl2YWwgPSBJOTE1X1JFQUQoTENQTExfQ1RMKTsKLQotCWlm
ICgodmFsICYgKExDUExMX1BMTF9MT0NLIHwgTENQTExfUExMX0RJU0FCTEUgfCBMQ1BMTF9DRF9T
T1VSQ0VfRkNMSyB8Ci0JCSAgICBMQ1BMTF9QT1dFUl9ET1dOX0FMTE9XKSkgPT0gTENQTExfUExM
X0xPQ0spCi0JCXJldHVybjsKLQotCS8qCi0JICogTWFrZSBzdXJlIHdlJ3JlIG5vdCBvbiBQQzgg
c3RhdGUgYmVmb3JlIGRpc2FibGluZyBQQzgsIG90aGVyd2lzZQotCSAqIHdlJ2xsIGhhbmcgdGhl
IG1hY2hpbmUuIFRvIHByZXZlbnQgUEM4IHN0YXRlLCBqdXN0IGVuYWJsZSBmb3JjZV93YWtlLgot
CSAqLwotCWludGVsX3VuY29yZV9mb3JjZXdha2VfZ2V0KCZkZXZfcHJpdi0+dW5jb3JlLCBGT1JD
RVdBS0VfQUxMKTsKLQotCWlmICh2YWwgJiBMQ1BMTF9QT1dFUl9ET1dOX0FMTE9XKSB7Ci0JCXZh
bCAmPSB+TENQTExfUE9XRVJfRE9XTl9BTExPVzsKLQkJSTkxNV9XUklURShMQ1BMTF9DVEwsIHZh
bCk7Ci0JCVBPU1RJTkdfUkVBRChMQ1BMTF9DVEwpOwotCX0KLQotCXZhbCA9IGhzd19yZWFkX2Rj
b21wKGRldl9wcml2KTsKLQl2YWwgfD0gRF9DT01QX0NPTVBfRk9SQ0U7Ci0JdmFsICY9IH5EX0NP
TVBfQ09NUF9ESVNBQkxFOwotCWhzd193cml0ZV9kY29tcChkZXZfcHJpdiwgdmFsKTsKLQotCXZh
bCA9IEk5MTVfUkVBRChMQ1BMTF9DVEwpOwotCXZhbCAmPSB+TENQTExfUExMX0RJU0FCTEU7Ci0J
STkxNV9XUklURShMQ1BMTF9DVEwsIHZhbCk7Ci0KLQlpZiAoaW50ZWxfd2FpdF9mb3JfcmVnaXN0
ZXIoJmRldl9wcml2LT51bmNvcmUsIExDUExMX0NUTCwKLQkJCQkgICAgTENQTExfUExMX0xPQ0ss
IExDUExMX1BMTF9MT0NLLCA1KSkKLQkJRFJNX0VSUk9SKCJMQ1BMTCBub3QgbG9ja2VkIHlldFxu
Iik7Ci0KLQlpZiAodmFsICYgTENQTExfQ0RfU09VUkNFX0ZDTEspIHsKLQkJdmFsID0gSTkxNV9S
RUFEKExDUExMX0NUTCk7Ci0JCXZhbCAmPSB+TENQTExfQ0RfU09VUkNFX0ZDTEs7Ci0JCUk5MTVf
V1JJVEUoTENQTExfQ1RMLCB2YWwpOwotCi0JCWlmICh3YWl0X2Zvcl91cygoSTkxNV9SRUFEKExD
UExMX0NUTCkgJgotCQkJCSBMQ1BMTF9DRF9TT1VSQ0VfRkNMS19ET05FKSA9PSAwLCAxKSkKLQkJ
CURSTV9FUlJPUigiU3dpdGNoaW5nIGJhY2sgdG8gTENQTEwgZmFpbGVkXG4iKTsKLQl9Ci0KLQlp
bnRlbF91bmNvcmVfZm9yY2V3YWtlX3B1dCgmZGV2X3ByaXYtPnVuY29yZSwgRk9SQ0VXQUtFX0FM
TCk7Ci0KLQlpbnRlbF91cGRhdGVfY2RjbGsoZGV2X3ByaXYpOwotCWludGVsX2R1bXBfY2RjbGtf
c3RhdGUoJmRldl9wcml2LT5jZGNsay5odywgIkN1cnJlbnQgQ0RDTEsiKTsKLX0KLQotLyoKLSAq
IFBhY2thZ2Ugc3RhdGVzIEM4IGFuZCBkZWVwZXIgYXJlIHJlYWxseSBkZWVwIFBDIHN0YXRlcyB0
aGF0IGNhbiBvbmx5IGJlCi0gKiByZWFjaGVkIHdoZW4gYWxsIHRoZSBkZXZpY2VzIG9uIHRoZSBz
eXN0ZW0gYWxsb3cgaXQsIHNvIGV2ZW4gaWYgdGhlIGdyYXBoaWNzCi0gKiBkZXZpY2UgYWxsb3dz
IFBDOCssIGl0IGRvZXNuJ3QgbWVhbiB0aGUgc3lzdGVtIHdpbGwgYWN0dWFsbHkgZ2V0IHRvIHRo
ZXNlCi0gKiBzdGF0ZXMuIE91ciBkcml2ZXIgb25seSBhbGxvd3MgUEM4KyB3aGVuIGdvaW5nIGlu
dG8gcnVudGltZSBQTS4KLSAqCi0gKiBUaGUgcmVxdWlyZW1lbnRzIGZvciBQQzgrIGFyZSB0aGF0
IGFsbCB0aGUgb3V0cHV0cyBhcmUgZGlzYWJsZWQsIHRoZSBwb3dlcgotICogd2VsbCBpcyBkaXNh
YmxlZCBhbmQgbW9zdCBpbnRlcnJ1cHRzIGFyZSBkaXNhYmxlZCwgYW5kIHRoZXNlIGFyZSBhbHNv
Ci0gKiByZXF1aXJlbWVudHMgZm9yIHJ1bnRpbWUgUE0uIFdoZW4gdGhlc2UgY29uZGl0aW9ucyBh
cmUgbWV0LCB3ZSBtYW51YWxseSBkbwotICogdGhlIG90aGVyIGNvbmRpdGlvbnM6IGRpc2FibGUg
dGhlIGludGVycnVwdHMsIGNsb2NrcyBhbmQgc3dpdGNoIExDUExMIHJlZmNsawotICogdG8gRmNs
ay4gSWYgd2UncmUgaW4gUEM4KyBhbmQgd2UgZ2V0IGFuIG5vbi1ob3RwbHVnIGludGVycnVwdCwg
d2UgY2FuIGhhcmQKLSAqIGhhbmcgdGhlIG1hY2hpbmUuCi0gKgotICogV2hlbiB3ZSByZWFsbHkg
cmVhY2ggUEM4IG9yIGRlZXBlciBzdGF0ZXMgKG5vdCBqdXN0IHdoZW4gd2UgYWxsb3cgaXQpIHdl
IGxvc2UKLSAqIHRoZSBzdGF0ZSBvZiBzb21lIHJlZ2lzdGVycywgc28gd2hlbiB3ZSBjb21lIGJh
Y2sgZnJvbSBQQzgrIHdlIG5lZWQgdG8KLSAqIHJlc3RvcmUgdGhpcyBzdGF0ZS4gV2UgZG9uJ3Qg
Z2V0IGludG8gUEM4KyBpZiB3ZSdyZSBub3QgaW4gUkM2LCBzbyB3ZSBkb24ndAotICogbmVlZCB0
byB0YWtlIGNhcmUgb2YgdGhlIHJlZ2lzdGVycyBrZXB0IGJ5IFJDNi4gTm90aWNlIHRoYXQgdGhp
cyBoYXBwZW5zIGV2ZW4KLSAqIGlmIHdlIGRvbid0IHB1dCB0aGUgZGV2aWNlIGluIFBDSSBEMyBz
dGF0ZSAod2hpY2ggaXMgd2hhdCBjdXJyZW50bHkgaGFwcGVucwotICogYmVjYXVzZSBvZiB0aGUg
cnVudGltZSBQTSBzdXBwb3J0KS4KLSAqCi0gKiBGb3IgbW9yZSwgcmVhZCAiRGlzcGxheSBTZXF1
ZW5jZXMgZm9yIFBhY2thZ2UgQzgiIG9uIHRoZSBoYXJkd2FyZQotICogZG9jdW1lbnRhdGlvbi4K
LSAqLwotdm9pZCBoc3dfZW5hYmxlX3BjOChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpCi17Ci0JdTMyIHZhbDsKLQotCURSTV9ERUJVR19LTVMoIkVuYWJsaW5nIHBhY2thZ2UgQzgr
XG4iKTsKLQotCWlmIChIQVNfUENIX0xQVF9MUChkZXZfcHJpdikpIHsKLQkJdmFsID0gSTkxNV9S
RUFEKFNPVVRIX0RTUENMS19HQVRFX0QpOwotCQl2YWwgJj0gflBDSF9MUF9QQVJUSVRJT05fTEVW
RUxfRElTQUJMRTsKLQkJSTkxNV9XUklURShTT1VUSF9EU1BDTEtfR0FURV9ELCB2YWwpOwotCX0K
LQotCWxwdF9kaXNhYmxlX2Nsa291dF9kcChkZXZfcHJpdik7Ci0JaHN3X2Rpc2FibGVfbGNwbGwo
ZGV2X3ByaXYsIHRydWUsIHRydWUpOwotfQotCi12b2lkIGhzd19kaXNhYmxlX3BjOChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCi17Ci0JdTMyIHZhbDsKLQotCURSTV9ERUJVR19L
TVMoIkRpc2FibGluZyBwYWNrYWdlIEM4K1xuIik7Ci0KLQloc3dfcmVzdG9yZV9sY3BsbChkZXZf
cHJpdik7Ci0JaW50ZWxfaW5pdF9wY2hfcmVmY2xrKGRldl9wcml2KTsKLQotCWlmIChIQVNfUENI
X0xQVF9MUChkZXZfcHJpdikpIHsKLQkJdmFsID0gSTkxNV9SRUFEKFNPVVRIX0RTUENMS19HQVRF
X0QpOwotCQl2YWwgfD0gUENIX0xQX1BBUlRJVElPTl9MRVZFTF9ESVNBQkxFOwotCQlJOTE1X1dS
SVRFKFNPVVRIX0RTUENMS19HQVRFX0QsIHZhbCk7Ci0JfQotfQotCi1zdGF0aWMgdm9pZCBpbnRl
bF9wY2hfcmVzZXRfaGFuZHNoYWtlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwK
LQkJCQkgICAgICBib29sIGVuYWJsZSkKLXsKLQlpOTE1X3JlZ190IHJlZzsKLQl1MzIgcmVzZXRf
Yml0cywgdmFsOwotCi0JaWYgKElTX0lWWUJSSURHRShkZXZfcHJpdikpIHsKLQkJcmVnID0gR0VO
N19NU0dfQ1RMOwotCQlyZXNldF9iaXRzID0gV0FJVF9GT1JfUENIX0ZMUl9BQ0sgfCBXQUlUX0ZP
Ul9QQ0hfUkVTRVRfQUNLOwotCX0gZWxzZSB7Ci0JCXJlZyA9IEhTV19OREVfUlNUV1JOX09QVDsK
LQkJcmVzZXRfYml0cyA9IFJFU0VUX1BDSF9IQU5EU0hBS0VfRU5BQkxFOwotCX0KLQotCXZhbCA9
IEk5MTVfUkVBRChyZWcpOwotCi0JaWYgKGVuYWJsZSkKLQkJdmFsIHw9IHJlc2V0X2JpdHM7Ci0J
ZWxzZQotCQl2YWwgJj0gfnJlc2V0X2JpdHM7Ci0KLQlJOTE1X1dSSVRFKHJlZywgdmFsKTsKLX0K
LQotc3RhdGljIHZvaWQgc2tsX2Rpc3BsYXlfY29yZV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiwKLQkJCQkgICBib29sIHJlc3VtZSkKLXsKLQlzdHJ1Y3QgaTkxNV9wb3dl
cl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwotCXN0
cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKndlbGw7Ci0KLQlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJp
diwgRENfU1RBVEVfRElTQUJMRSk7Ci0KLQkvKiBlbmFibGUgUENIIHJlc2V0IGhhbmRzaGFrZSAq
LwotCWludGVsX3BjaF9yZXNldF9oYW5kc2hha2UoZGV2X3ByaXYsICFIQVNfUENIX05PUChkZXZf
cHJpdikpOwotCi0JLyogZW5hYmxlIFBHMSBhbmQgTWlzYyBJL08gKi8KLQltdXRleF9sb2NrKCZw
b3dlcl9kb21haW5zLT5sb2NrKTsKLQotCXdlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJp
diwgU0tMX0RJU1BfUFdfMSk7Ci0JaW50ZWxfcG93ZXJfd2VsbF9lbmFibGUoZGV2X3ByaXYsIHdl
bGwpOwotCi0Jd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBTS0xfRElTUF9QV19N
SVNDX0lPKTsKLQlpbnRlbF9wb3dlcl93ZWxsX2VuYWJsZShkZXZfcHJpdiwgd2VsbCk7Ci0KLQlt
dXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwotCi0JaW50ZWxfY2RjbGtfaW5pdChk
ZXZfcHJpdik7Ci0KLQlnZW45X2RidWZfZW5hYmxlKGRldl9wcml2KTsKLQotCWlmIChyZXN1bWUg
JiYgZGV2X3ByaXYtPmNzci5kbWNfcGF5bG9hZCkKLQkJaW50ZWxfY3NyX2xvYWRfcHJvZ3JhbShk
ZXZfcHJpdik7Ci19Ci0KLXN0YXRpYyB2b2lkIHNrbF9kaXNwbGF5X2NvcmVfdW5pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21h
aW5zICpwb3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwotCXN0cnVjdCBp
OTE1X3Bvd2VyX3dlbGwgKndlbGw7Ci0KLQlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENf
U1RBVEVfRElTQUJMRSk7Ci0KLQlnZW45X2RidWZfZGlzYWJsZShkZXZfcHJpdik7Ci0KLQlpbnRl
bF9jZGNsa191bmluaXQoZGV2X3ByaXYpOwotCi0JLyogVGhlIHNwZWMgZG9lc24ndCBjYWxsIGZv
ciByZW1vdmluZyB0aGUgcmVzZXQgaGFuZHNoYWtlIGZsYWcgKi8KLQkvKiBkaXNhYmxlIFBHMSBh
bmQgTWlzYyBJL08gKi8KLQotCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwotCi0J
LyoKLQkgKiBCU3BlYyBzYXlzIHRvIGtlZXAgdGhlIE1JU0MgSU8gcG93ZXIgd2VsbCBlbmFibGVk
IGhlcmUsIG9ubHkKLQkgKiByZW1vdmUgb3VyIHJlcXVlc3QgZm9yIHBvd2VyIHdlbGwgMS4KLQkg
KiBOb3RlIHRoYXQgZXZlbiB0aG91Z2ggdGhlIGRyaXZlcidzIHJlcXVlc3QgaXMgcmVtb3ZlZCBw
b3dlciB3ZWxsIDEKLQkgKiBtYXkgc3RheSBlbmFibGVkIGFmdGVyIHRoaXMgZHVlIHRvIERNQydz
IG93biByZXF1ZXN0IG9uIGl0LgotCSAqLwotCXdlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChkZXZf
cHJpdiwgU0tMX0RJU1BfUFdfMSk7Ci0JaW50ZWxfcG93ZXJfd2VsbF9kaXNhYmxlKGRldl9wcml2
LCB3ZWxsKTsKLQotCW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Ci0KLQl1c2xl
ZXBfcmFuZ2UoMTAsIDMwKTsJCS8qIDEwIHVzIGRlbGF5IHBlciBCc3BlYyAqLwotfQotCi12b2lk
IGJ4dF9kaXNwbGF5X2NvcmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYs
Ci0JCQkgICBib29sIHJlc3VtZSkKLXsKLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dl
cl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwotCXN0cnVjdCBpOTE1X3Bvd2Vy
X3dlbGwgKndlbGw7Ci0KLQlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVfRElT
QUJMRSk7Ci0KLQkvKgotCSAqIE5ERV9SU1RXUk5fT1BUIFJTVCBQQ0ggSGFuZHNoYWtlIEVuIG11
c3QgYWx3YXlzIGJlIDBiIG9uIEJYVAotCSAqIG9yIGVsc2UgdGhlIHJlc2V0IHdpbGwgaGFuZyBi
ZWNhdXNlIHRoZXJlIGlzIG5vIFBDSCB0byByZXNwb25kLgotCSAqIE1vdmUgdGhlIGhhbmRzaGFr
ZSBwcm9ncmFtbWluZyB0byBpbml0aWFsaXphdGlvbiBzZXF1ZW5jZS4KLQkgKiBQcmV2aW91c2x5
IHdhcyBsZWZ0IHVwIHRvIEJJT1MuCi0JICovCi0JaW50ZWxfcGNoX3Jlc2V0X2hhbmRzaGFrZShk
ZXZfcHJpdiwgZmFsc2UpOwotCi0JLyogRW5hYmxlIFBHMSAqLwotCW11dGV4X2xvY2soJnBvd2Vy
X2RvbWFpbnMtPmxvY2spOwotCi0Jd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBT
S0xfRElTUF9QV18xKTsKLQlpbnRlbF9wb3dlcl93ZWxsX2VuYWJsZShkZXZfcHJpdiwgd2VsbCk7
Ci0KLQltdXRleF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwotCi0JaW50ZWxfY2RjbGtf
aW5pdChkZXZfcHJpdik7Ci0KLQlnZW45X2RidWZfZW5hYmxlKGRldl9wcml2KTsKLQotCWlmIChy
ZXN1bWUgJiYgZGV2X3ByaXYtPmNzci5kbWNfcGF5bG9hZCkKLQkJaW50ZWxfY3NyX2xvYWRfcHJv
Z3JhbShkZXZfcHJpdik7Ci19Ci0KLXZvaWQgYnh0X2Rpc3BsYXlfY29yZV91bmluaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFp
bnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Ci0Jc3RydWN0IGk5
MTVfcG93ZXJfd2VsbCAqd2VsbDsKLQotCWdlbjlfc2V0X2RjX3N0YXRlKGRldl9wcml2LCBEQ19T
VEFURV9ESVNBQkxFKTsKLQotCWdlbjlfZGJ1Zl9kaXNhYmxlKGRldl9wcml2KTsKLQotCWludGVs
X2NkY2xrX3VuaW5pdChkZXZfcHJpdik7Ci0KLQkvKiBUaGUgc3BlYyBkb2Vzbid0IGNhbGwgZm9y
IHJlbW92aW5nIHRoZSByZXNldCBoYW5kc2hha2UgZmxhZyAqLwotCi0JLyoKLQkgKiBEaXNhYmxl
IFBXMSAoUEcxKS4KLQkgKiBOb3RlIHRoYXQgZXZlbiB0aG91Z2ggdGhlIGRyaXZlcidzIHJlcXVl
c3QgaXMgcmVtb3ZlZCBwb3dlciB3ZWxsIDEKLQkgKiBtYXkgc3RheSBlbmFibGVkIGFmdGVyIHRo
aXMgZHVlIHRvIERNQydzIG93biByZXF1ZXN0IG9uIGl0LgotCSAqLwotCW11dGV4X2xvY2soJnBv
d2VyX2RvbWFpbnMtPmxvY2spOwotCi0Jd2VsbCA9IGxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2
LCBTS0xfRElTUF9QV18xKTsKLQlpbnRlbF9wb3dlcl93ZWxsX2Rpc2FibGUoZGV2X3ByaXYsIHdl
bGwpOwotCi0JbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKLQotCXVzbGVlcF9y
YW5nZSgxMCwgMzApOwkJLyogMTAgdXMgZGVsYXkgcGVyIEJzcGVjICovCi19Ci0KLXN0YXRpYyB2
b2lkIGNubF9kaXNwbGF5X2NvcmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsIGJvb2wgcmVzdW1lKQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2Rv
bWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Ci0Jc3RydWN0IGk5MTVfcG93ZXJfd2Vs
bCAqd2VsbDsKLQotCWdlbjlfc2V0X2RjX3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9ESVNBQkxF
KTsKLQotCS8qIDEuIEVuYWJsZSBQQ0ggUmVzZXQgSGFuZHNoYWtlICovCi0JaW50ZWxfcGNoX3Jl
c2V0X2hhbmRzaGFrZShkZXZfcHJpdiwgIUhBU19QQ0hfTk9QKGRldl9wcml2KSk7Ci0KLQkvKiAy
LTMuICovCi0JaW50ZWxfY29tYm9fcGh5X2luaXQoZGV2X3ByaXYpOwotCi0JLyoKLQkgKiA0LiBF
bmFibGUgUG93ZXIgV2VsbCAxIChQRzEpLgotCSAqICAgIFRoZSBBVVggSU8gcG93ZXIgd2VsbHMg
d2lsbCBiZSBlbmFibGVkIG9uIGRlbWFuZC4KLQkgKi8KLQltdXRleF9sb2NrKCZwb3dlcl9kb21h
aW5zLT5sb2NrKTsKLQl3ZWxsID0gbG9va3VwX3Bvd2VyX3dlbGwoZGV2X3ByaXYsIFNLTF9ESVNQ
X1BXXzEpOwotCWludGVsX3Bvd2VyX3dlbGxfZW5hYmxlKGRldl9wcml2LCB3ZWxsKTsKLQltdXRl
eF91bmxvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwotCi0JLyogNS4gRW5hYmxlIENEIGNsb2Nr
ICovCi0JaW50ZWxfY2RjbGtfaW5pdChkZXZfcHJpdik7Ci0KLQkvKiA2LiBFbmFibGUgREJVRiAq
LwotCWdlbjlfZGJ1Zl9lbmFibGUoZGV2X3ByaXYpOwotCi0JaWYgKHJlc3VtZSAmJiBkZXZfcHJp
di0+Y3NyLmRtY19wYXlsb2FkKQotCQlpbnRlbF9jc3JfbG9hZF9wcm9ncmFtKGRldl9wcml2KTsK
LX0KLQotc3RhdGljIHZvaWQgY25sX2Rpc3BsYXlfY29yZV91bmluaXQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2Vy
X2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Ci0Jc3RydWN0IGk5MTVfcG93ZXJf
d2VsbCAqd2VsbDsKLQotCWdlbjlfc2V0X2RjX3N0YXRlKGRldl9wcml2LCBEQ19TVEFURV9ESVNB
QkxFKTsKLQotCS8qIDEuIERpc2FibGUgYWxsIGRpc3BsYXkgZW5naW5lIGZ1bmN0aW9ucyAtPiBh
cmVhZHkgZG9uZSAqLwotCi0JLyogMi4gRGlzYWJsZSBEQlVGICovCi0JZ2VuOV9kYnVmX2Rpc2Fi
bGUoZGV2X3ByaXYpOwotCi0JLyogMy4gRGlzYWJsZSBDRCBjbG9jayAqLwotCWludGVsX2NkY2xr
X3VuaW5pdChkZXZfcHJpdik7Ci0KLQkvKgotCSAqIDQuIERpc2FibGUgUG93ZXIgV2VsbCAxIChQ
RzEpLgotCSAqICAgIFRoZSBBVVggSU8gcG93ZXIgd2VsbHMgYXJlIHRvZ2dsZWQgb24gZGVtYW5k
LCBzbyB0aGV5IGFyZSBhbHJlYWR5Ci0JICogICAgZGlzYWJsZWQgYXQgdGhpcyBwb2ludC4KLQkg
Ki8KLQltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2NrKTsKLQl3ZWxsID0gbG9va3VwX3Bv
d2VyX3dlbGwoZGV2X3ByaXYsIFNLTF9ESVNQX1BXXzEpOwotCWludGVsX3Bvd2VyX3dlbGxfZGlz
YWJsZShkZXZfcHJpdiwgd2VsbCk7Ci0JbXV0ZXhfdW5sb2NrKCZwb3dlcl9kb21haW5zLT5sb2Nr
KTsKLQotCXVzbGVlcF9yYW5nZSgxMCwgMzApOwkJLyogMTAgdXMgZGVsYXkgcGVyIEJzcGVjICov
Ci0KLQkvKiA1LiAqLwotCWludGVsX2NvbWJvX3BoeV91bmluaXQoZGV2X3ByaXYpOwotfQotCi12
b2lkIGljbF9kaXNwbGF5X2NvcmVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCi0JCQkgICBib29sIHJlc3VtZSkKLXsKLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpw
b3dlcl9kb21haW5zID0gJmRldl9wcml2LT5wb3dlcl9kb21haW5zOwotCXN0cnVjdCBpOTE1X3Bv
d2VyX3dlbGwgKndlbGw7Ci0KLQlnZW45X3NldF9kY19zdGF0ZShkZXZfcHJpdiwgRENfU1RBVEVf
RElTQUJMRSk7Ci0KLQkvKiAxLiBFbmFibGUgUENIIHJlc2V0IGhhbmRzaGFrZS4gKi8KLQlpbnRl
bF9wY2hfcmVzZXRfaGFuZHNoYWtlKGRldl9wcml2LCAhSEFTX1BDSF9OT1AoZGV2X3ByaXYpKTsK
LQotCS8qIDIuIEluaXRpYWxpemUgYWxsIGNvbWJvIHBoeXMgKi8KLQlpbnRlbF9jb21ib19waHlf
aW5pdChkZXZfcHJpdik7Ci0KLQkvKgotCSAqIDMuIEVuYWJsZSBQb3dlciBXZWxsIDEgKFBHMSku
Ci0JICogICAgVGhlIEFVWCBJTyBwb3dlciB3ZWxscyB3aWxsIGJlIGVuYWJsZWQgb24gZGVtYW5k
LgotCSAqLwotCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwotCXdlbGwgPSBsb29r
dXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgU0tMX0RJU1BfUFdfMSk7Ci0JaW50ZWxfcG93ZXJfd2Vs
bF9lbmFibGUoZGV2X3ByaXYsIHdlbGwpOwotCW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlucy0+
bG9jayk7Ci0KLQkvKiA0LiBFbmFibGUgQ0RDTEsuICovCi0JaW50ZWxfY2RjbGtfaW5pdChkZXZf
cHJpdik7Ci0KLQkvKiA1LiBFbmFibGUgREJVRi4gKi8KLQlpY2xfZGJ1Zl9lbmFibGUoZGV2X3By
aXYpOwotCi0JLyogNi4gU2V0dXAgTUJVUy4gKi8KLQlpY2xfbWJ1c19pbml0KGRldl9wcml2KTsK
LQotCWlmIChyZXN1bWUgJiYgZGV2X3ByaXYtPmNzci5kbWNfcGF5bG9hZCkKLQkJaW50ZWxfY3Ny
X2xvYWRfcHJvZ3JhbShkZXZfcHJpdik7Ci19Ci0KLXZvaWQgaWNsX2Rpc3BsYXlfY29yZV91bmlu
aXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBpOTE1X3Bv
d2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmZGV2X3ByaXYtPnBvd2VyX2RvbWFpbnM7Ci0J
c3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqd2VsbDsKLQotCWdlbjlfc2V0X2RjX3N0YXRlKGRldl9w
cml2LCBEQ19TVEFURV9ESVNBQkxFKTsKLQotCS8qIDEuIERpc2FibGUgYWxsIGRpc3BsYXkgZW5n
aW5lIGZ1bmN0aW9ucyAtPiBhcmVhZHkgZG9uZSAqLwotCi0JLyogMi4gRGlzYWJsZSBEQlVGICov
Ci0JaWNsX2RidWZfZGlzYWJsZShkZXZfcHJpdik7Ci0KLQkvKiAzLiBEaXNhYmxlIENEIGNsb2Nr
ICovCi0JaW50ZWxfY2RjbGtfdW5pbml0KGRldl9wcml2KTsKLQotCS8qCi0JICogNC4gRGlzYWJs
ZSBQb3dlciBXZWxsIDEgKFBHMSkuCi0JICogICAgVGhlIEFVWCBJTyBwb3dlciB3ZWxscyBhcmUg
dG9nZ2xlZCBvbiBkZW1hbmQsIHNvIHRoZXkgYXJlIGFscmVhZHkKLQkgKiAgICBkaXNhYmxlZCBh
dCB0aGlzIHBvaW50LgotCSAqLwotCW11dGV4X2xvY2soJnBvd2VyX2RvbWFpbnMtPmxvY2spOwot
CXdlbGwgPSBsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwgU0tMX0RJU1BfUFdfMSk7Ci0JaW50
ZWxfcG93ZXJfd2VsbF9kaXNhYmxlKGRldl9wcml2LCB3ZWxsKTsKLQltdXRleF91bmxvY2soJnBv
d2VyX2RvbWFpbnMtPmxvY2spOwotCi0JLyogNS4gKi8KLQlpbnRlbF9jb21ib19waHlfdW5pbml0
KGRldl9wcml2KTsKLX0KLQotc3RhdGljIHZvaWQgY2h2X3BoeV9jb250cm9sX2luaXQoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwg
KmNtbl9iYyA9Ci0JCWxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBWTFZfRElTUF9QV19EUElP
X0NNTl9CQyk7Ci0Jc3RydWN0IGk5MTVfcG93ZXJfd2VsbCAqY21uX2QgPQotCQlsb29rdXBfcG93
ZXJfd2VsbChkZXZfcHJpdiwgQ0hWX0RJU1BfUFdfRFBJT19DTU5fRCk7Ci0KLQkvKgotCSAqIERJ
U1BMQVlfUEhZX0NPTlRST0wgY2FuIGdldCBjb3JydXB0ZWQgaWYgcmVhZC4gQXMgYQotCSAqIHdv
cmthcm91bmQgbmV2ZXIgZXZlciByZWFkIERJU1BMQVlfUEhZX0NPTlRST0wsIGFuZAotCSAqIGlu
c3RlYWQgbWFpbnRhaW4gYSBzaGFkb3cgY29weSBvdXJzZWx2ZXMuIFVzZSB0aGUgYWN0dWFsCi0J
ICogcG93ZXIgd2VsbCBzdGF0ZSBhbmQgbGFuZSBzdGF0dXMgdG8gcmVjb25zdHJ1Y3QgdGhlCi0J
ICogZXhwZWN0ZWQgaW5pdGlhbCB2YWx1ZS4KLQkgKi8KLQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250
cm9sID0KLQkJUEhZX0xET19TRVFfREVMQVkoUEhZX0xET19ERUxBWV82MDBOUywgRFBJT19QSFkw
KSB8Ci0JCVBIWV9MRE9fU0VRX0RFTEFZKFBIWV9MRE9fREVMQVlfNjAwTlMsIERQSU9fUEhZMSkg
fAotCQlQSFlfQ0hfUE9XRVJfTU9ERShQSFlfQ0hfREVFUF9QU1IsIERQSU9fUEhZMCwgRFBJT19D
SDApIHwKLQkJUEhZX0NIX1BPV0VSX01PREUoUEhZX0NIX0RFRVBfUFNSLCBEUElPX1BIWTAsIERQ
SU9fQ0gxKSB8Ci0JCVBIWV9DSF9QT1dFUl9NT0RFKFBIWV9DSF9ERUVQX1BTUiwgRFBJT19QSFkx
LCBEUElPX0NIMCk7Ci0KLQkvKgotCSAqIElmIGFsbCBsYW5lcyBhcmUgZGlzYWJsZWQgd2UgbGVh
dmUgdGhlIG92ZXJyaWRlIGRpc2FibGVkCi0JICogd2l0aCBhbGwgcG93ZXIgZG93biBiaXRzIGNs
ZWFyZWQgdG8gbWF0Y2ggdGhlIHN0YXRlIHdlCi0JICogd291bGQgdXNlIGFmdGVyIGRpc2FibGlu
ZyB0aGUgcG9ydC4gT3RoZXJ3aXNlIGVuYWJsZSB0aGUKLQkgKiBvdmVycmlkZSBhbmQgc2V0IHRo
ZSBsYW5lIHBvd2VyZG93biBiaXRzIGFjY2RpbmcgdG8gdGhlCi0JICogY3VycmVudCBsYW5lIHN0
YXR1cy4KLQkgKi8KLQlpZiAoY21uX2JjLT5kZXNjLT5vcHMtPmlzX2VuYWJsZWQoZGV2X3ByaXYs
IGNtbl9iYykpIHsKLQkJdTMyIHN0YXR1cyA9IEk5MTVfUkVBRChEUExMKFBJUEVfQSkpOwotCQl1
bnNpZ25lZCBpbnQgbWFzazsKLQotCQltYXNrID0gc3RhdHVzICYgRFBMTF9QT1JUQl9SRUFEWV9N
QVNLOwotCQlpZiAobWFzayA9PSAweGYpCi0JCQltYXNrID0gMHgwOwotCQllbHNlCi0JCQlkZXZf
cHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9Ci0JCQkJUEhZX0NIX1BPV0VSX0RPV05fT1ZSRF9FTihE
UElPX1BIWTAsIERQSU9fQ0gwKTsKLQotCQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9Ci0J
CQlQSFlfQ0hfUE9XRVJfRE9XTl9PVlJEKG1hc2ssIERQSU9fUEhZMCwgRFBJT19DSDApOwotCi0J
CW1hc2sgPSAoc3RhdHVzICYgRFBMTF9QT1JUQ19SRUFEWV9NQVNLKSA+PiA0OwotCQlpZiAobWFz
ayA9PSAweGYpCi0JCQltYXNrID0gMHgwOwotCQllbHNlCi0JCQlkZXZfcHJpdi0+Y2h2X3BoeV9j
b250cm9sIHw9Ci0JCQkJUEhZX0NIX1BPV0VSX0RPV05fT1ZSRF9FTihEUElPX1BIWTAsIERQSU9f
Q0gxKTsKLQotCQlkZXZfcHJpdi0+Y2h2X3BoeV9jb250cm9sIHw9Ci0JCQlQSFlfQ0hfUE9XRVJf
RE9XTl9PVlJEKG1hc2ssIERQSU9fUEhZMCwgRFBJT19DSDEpOwotCi0JCWRldl9wcml2LT5jaHZf
cGh5X2NvbnRyb2wgfD0gUEhZX0NPTV9MQU5FX1JFU0VUX0RFQVNTRVJUKERQSU9fUEhZMCk7Ci0K
LQkJZGV2X3ByaXYtPmNodl9waHlfYXNzZXJ0W0RQSU9fUEhZMF0gPSBmYWxzZTsKLQl9IGVsc2Ug
ewotCQlkZXZfcHJpdi0+Y2h2X3BoeV9hc3NlcnRbRFBJT19QSFkwXSA9IHRydWU7Ci0JfQotCi0J
aWYgKGNtbl9kLT5kZXNjLT5vcHMtPmlzX2VuYWJsZWQoZGV2X3ByaXYsIGNtbl9kKSkgewotCQl1
MzIgc3RhdHVzID0gSTkxNV9SRUFEKERQSU9fUEhZX1NUQVRVUyk7Ci0JCXVuc2lnbmVkIGludCBt
YXNrOwotCi0JCW1hc2sgPSBzdGF0dXMgJiBEUExMX1BPUlREX1JFQURZX01BU0s7Ci0KLQkJaWYg
KG1hc2sgPT0gMHhmKQotCQkJbWFzayA9IDB4MDsKLQkJZWxzZQotCQkJZGV2X3ByaXYtPmNodl9w
aHlfY29udHJvbCB8PQotCQkJCVBIWV9DSF9QT1dFUl9ET1dOX09WUkRfRU4oRFBJT19QSFkxLCBE
UElPX0NIMCk7Ci0KLQkJZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCB8PQotCQkJUEhZX0NIX1BP
V0VSX0RPV05fT1ZSRChtYXNrLCBEUElPX1BIWTEsIERQSU9fQ0gwKTsKLQotCQlkZXZfcHJpdi0+
Y2h2X3BoeV9jb250cm9sIHw9IFBIWV9DT01fTEFORV9SRVNFVF9ERUFTU0VSVChEUElPX1BIWTEp
OwotCi0JCWRldl9wcml2LT5jaHZfcGh5X2Fzc2VydFtEUElPX1BIWTFdID0gZmFsc2U7Ci0JfSBl
bHNlIHsKLQkJZGV2X3ByaXYtPmNodl9waHlfYXNzZXJ0W0RQSU9fUEhZMV0gPSB0cnVlOwotCX0K
LQotCUk5MTVfV1JJVEUoRElTUExBWV9QSFlfQ09OVFJPTCwgZGV2X3ByaXYtPmNodl9waHlfY29u
dHJvbCk7Ci0KLQlEUk1fREVCVUdfS01TKCJJbml0aWFsIFBIWV9DT05UUk9MPTB4JTA4eFxuIiwK
LQkJICAgICAgZGV2X3ByaXYtPmNodl9waHlfY29udHJvbCk7Ci19Ci0KLXN0YXRpYyB2b2lkIHZs
dl9jbW5sYW5lX3dhKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlzdHJ1
Y3QgaTkxNV9wb3dlcl93ZWxsICpjbW4gPQotCQlsb29rdXBfcG93ZXJfd2VsbChkZXZfcHJpdiwg
VkxWX0RJU1BfUFdfRFBJT19DTU5fQkMpOwotCXN0cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKmRpc3Ay
ZCA9Ci0JCWxvb2t1cF9wb3dlcl93ZWxsKGRldl9wcml2LCBWTFZfRElTUF9QV19ESVNQMkQpOwot
Ci0JLyogSWYgdGhlIGRpc3BsYXkgbWlnaHQgYmUgYWxyZWFkeSBhY3RpdmUgc2tpcCB0aGlzICov
Ci0JaWYgKGNtbi0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9wcml2LCBjbW4pICYmCi0JICAg
IGRpc3AyZC0+ZGVzYy0+b3BzLT5pc19lbmFibGVkKGRldl9wcml2LCBkaXNwMmQpICYmCi0JICAg
IEk5MTVfUkVBRChEUElPX0NUTCkgJiBEUElPX0NNTlJTVCkKLQkJcmV0dXJuOwotCi0JRFJNX0RF
QlVHX0tNUygidG9nZ2xpbmcgZGlzcGxheSBQSFkgc2lkZSByZXNldFxuIik7Ci0KLQkvKiBjbW5s
YW5lIG5lZWRzIERQTEwgcmVnaXN0ZXJzICovCi0JZGlzcDJkLT5kZXNjLT5vcHMtPmVuYWJsZShk
ZXZfcHJpdiwgZGlzcDJkKTsKLQotCS8qCi0JICogRnJvbSBWTFYyQTBfRFBfZURQX0hETUlfRFBJ
T19kcml2ZXJfdmJpb3Nfbm90ZXNfMTEuZG9jeDoKLQkgKiBOZWVkIHRvIGFzc2VydCBhbmQgZGUt
YXNzZXJ0IFBIWSBTQiByZXNldCBieSBnYXRpbmcgdGhlCi0JICogY29tbW9uIGxhbmUgcG93ZXIs
IHRoZW4gdW4tZ2F0aW5nIGl0LgotCSAqIFNpbXBseSB1bmdhdGluZyBpc24ndCBlbm91Z2ggdG8g
cmVzZXQgdGhlIFBIWSBlbm91Z2ggdG8gZ2V0Ci0JICogcG9ydHMgYW5kIGxhbmVzIHJ1bm5pbmcu
Ci0JICovCi0JY21uLT5kZXNjLT5vcHMtPmRpc2FibGUoZGV2X3ByaXYsIGNtbik7Ci19Ci0KLXN0
YXRpYyBib29sIHZsdl9wdW5pdF9pc19wb3dlcl9nYXRlZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYsIHUzMiByZWcwKQotewotCWJvb2wgcmV0OwotCi0Jdmx2X3B1bml0X2dldChk
ZXZfcHJpdik7Ci0JcmV0ID0gKHZsdl9wdW5pdF9yZWFkKGRldl9wcml2LCByZWcwKSAmIFNTUE0w
X1NTQ19NQVNLKSA9PSBTU1BNMF9TU0NfUFdSX0dBVEU7Ci0Jdmx2X3B1bml0X3B1dChkZXZfcHJp
dik7Ci0KLQlyZXR1cm4gcmV0OwotfQotCi1zdGF0aWMgdm9pZCBhc3NlcnRfdmVkX3Bvd2VyX2dh
dGVkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKLXsKLQlXQVJOKCF2bHZfcHVu
aXRfaXNfcG93ZXJfZ2F0ZWQoZGV2X3ByaXYsIFBVTklUX1JFR19WRURTU1BNMCksCi0JICAgICAi
VkVEIG5vdCBwb3dlciBnYXRlZFxuIik7Ci19Ci0KLXN0YXRpYyB2b2lkIGFzc2VydF9pc3BfcG93
ZXJfZ2F0ZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQotewotCXN0YXRpYyBj
b25zdCBzdHJ1Y3QgcGNpX2RldmljZV9pZCBpc3BfaWRzW10gPSB7Ci0JCXtQQ0lfREVWSUNFKFBD
SV9WRU5ET1JfSURfSU5URUwsIDB4MGYzOCl9LAotCQl7UENJX0RFVklDRShQQ0lfVkVORE9SX0lE
X0lOVEVMLCAweDIyYjgpfSwKLQkJe30KLQl9OwotCi0JV0FSTighcGNpX2Rldl9wcmVzZW50KGlz
cF9pZHMpICYmCi0JICAgICAhdmx2X3B1bml0X2lzX3Bvd2VyX2dhdGVkKGRldl9wcml2LCBQVU5J
VF9SRUdfSVNQU1NQTTApLAotCSAgICAgIklTUCBub3QgcG93ZXIgZ2F0ZWRcbiIpOwotfQotCi1z
dGF0aWMgdm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX3ZlcmlmeV9zdGF0ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotCi0vKioKLSAqIGludGVsX3Bvd2VyX2RvbWFpbnNfaW5p
dF9odyAtIGluaXRpYWxpemUgaGFyZHdhcmUgcG93ZXIgZG9tYWluIHN0YXRlCi0gKiBAaTkxNTog
aTkxNSBkZXZpY2UgaW5zdGFuY2UKLSAqIEByZXN1bWU6IENhbGxlZCBmcm9tIHJlc3VtZSBjb2Rl
IHBhdGhzIG9yIG5vdAotICoKLSAqIFRoaXMgZnVuY3Rpb24gaW5pdGlhbGl6ZXMgdGhlIGhhcmR3
YXJlIHBvd2VyIGRvbWFpbiBzdGF0ZSBhbmQgZW5hYmxlcyBhbGwKLSAqIHBvd2VyIHdlbGxzIGJl
bG9uZ2luZyB0byB0aGUgSU5JVCBwb3dlciBkb21haW4uIFBvd2VyIHdlbGxzIGluIG90aGVyCi0g
KiBkb21haW5zIChhbmQgbm90IGluIHRoZSBJTklUIGRvbWFpbikgYXJlIHJlZmVyZW5jZWQgb3Ig
ZGlzYWJsZWQgYnkKLSAqIGludGVsX21vZGVzZXRfcmVhZG91dF9od19zdGF0ZSgpLiBBZnRlciB0
aGF0IHRoZSByZWZlcmVuY2UgY291bnQgb2YgZWFjaAotICogcG93ZXIgd2VsbCBtdXN0IG1hdGNo
IGl0cyBIVyBlbmFibGVkIHN0YXRlLCBzZWUKLSAqIGludGVsX3Bvd2VyX2RvbWFpbnNfdmVyaWZ5
X3N0YXRlKCkuCi0gKgotICogSXQgd2lsbCByZXR1cm4gd2l0aCBwb3dlciBkb21haW5zIGRpc2Fi
bGVkICh0byBiZSBlbmFibGVkIGxhdGVyIGJ5Ci0gKiBpbnRlbF9wb3dlcl9kb21haW5zX2VuYWJs
ZSgpKSBhbmQgbXVzdCBiZSBwYWlyZWQgd2l0aAotICogaW50ZWxfcG93ZXJfZG9tYWluc19maW5p
X2h3KCkuCi0gKi8KLXZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19pbml0X2h3KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LCBib29sIHJlc3VtZSkKLXsKLQlzdHJ1Y3QgaTkxNV9wb3dlcl9k
b21haW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUtPnBvd2VyX2RvbWFpbnM7Ci0KLQlwb3dlcl9k
b21haW5zLT5pbml0aWFsaXppbmcgPSB0cnVlOwotCi0JaWYgKElOVEVMX0dFTihpOTE1KSA+PSAx
MSkgewotCQlpY2xfZGlzcGxheV9jb3JlX2luaXQoaTkxNSwgcmVzdW1lKTsKLQl9IGVsc2UgaWYg
KElTX0NBTk5PTkxBS0UoaTkxNSkpIHsKLQkJY25sX2Rpc3BsYXlfY29yZV9pbml0KGk5MTUsIHJl
c3VtZSk7Ci0JfSBlbHNlIGlmIChJU19HRU45X0JDKGk5MTUpKSB7Ci0JCXNrbF9kaXNwbGF5X2Nv
cmVfaW5pdChpOTE1LCByZXN1bWUpOwotCX0gZWxzZSBpZiAoSVNfR0VOOV9MUChpOTE1KSkgewot
CQlieHRfZGlzcGxheV9jb3JlX2luaXQoaTkxNSwgcmVzdW1lKTsKLQl9IGVsc2UgaWYgKElTX0NI
RVJSWVZJRVcoaTkxNSkpIHsKLQkJbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Ci0J
CWNodl9waHlfY29udHJvbF9pbml0KGk5MTUpOwotCQltdXRleF91bmxvY2soJnBvd2VyX2RvbWFp
bnMtPmxvY2spOwotCQlhc3NlcnRfaXNwX3Bvd2VyX2dhdGVkKGk5MTUpOwotCX0gZWxzZSBpZiAo
SVNfVkFMTEVZVklFVyhpOTE1KSkgewotCQltdXRleF9sb2NrKCZwb3dlcl9kb21haW5zLT5sb2Nr
KTsKLQkJdmx2X2NtbmxhbmVfd2EoaTkxNSk7Ci0JCW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlu
cy0+bG9jayk7Ci0JCWFzc2VydF92ZWRfcG93ZXJfZ2F0ZWQoaTkxNSk7Ci0JCWFzc2VydF9pc3Bf
cG93ZXJfZ2F0ZWQoaTkxNSk7Ci0JfSBlbHNlIGlmIChJU19CUk9BRFdFTEwoaTkxNSkgfHwgSVNf
SEFTV0VMTChpOTE1KSkgewotCQloc3dfYXNzZXJ0X2NkY2xrKGk5MTUpOwotCQlpbnRlbF9wY2hf
cmVzZXRfaGFuZHNoYWtlKGk5MTUsICFIQVNfUENIX05PUChpOTE1KSk7Ci0JfSBlbHNlIGlmIChJ
U19JVllCUklER0UoaTkxNSkpIHsKLQkJaW50ZWxfcGNoX3Jlc2V0X2hhbmRzaGFrZShpOTE1LCAh
SEFTX1BDSF9OT1AoaTkxNSkpOwotCX0KLQotCS8qCi0JICogS2VlcCBhbGwgcG93ZXIgd2VsbHMg
ZW5hYmxlZCBmb3IgYW55IGRlcGVuZGVudCBIVyBhY2Nlc3MgZHVyaW5nCi0JICogaW5pdGlhbGl6
YXRpb24gYW5kIHRvIG1ha2Ugc3VyZSB3ZSBrZWVwIEJJT1MgZW5hYmxlZCBkaXNwbGF5IEhXCi0J
ICogcmVzb3VyY2VzIHBvd2VyZWQgdW50aWwgZGlzcGxheSBIVyByZWFkb3V0IGlzIGNvbXBsZXRl
LiBXZSBkcm9wCi0JICogdGhpcyByZWZlcmVuY2UgaW4gaW50ZWxfcG93ZXJfZG9tYWluc19lbmFi
bGUoKS4KLQkgKi8KLQlwb3dlcl9kb21haW5zLT53YWtlcmVmID0KLQkJaW50ZWxfZGlzcGxheV9w
b3dlcl9nZXQoaTkxNSwgUE9XRVJfRE9NQUlOX0lOSVQpOwotCi0JLyogRGlzYWJsZSBwb3dlciBz
dXBwb3J0IGlmIHRoZSB1c2VyIGFza2VkIHNvLiAqLwotCWlmICghaTkxNV9tb2RwYXJhbXMuZGlz
YWJsZV9wb3dlcl93ZWxsKQotCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LCBQT1dFUl9E
T01BSU5fSU5JVCk7Ci0JaW50ZWxfcG93ZXJfZG9tYWluc19zeW5jX2h3KGk5MTUpOwotCi0JcG93
ZXJfZG9tYWlucy0+aW5pdGlhbGl6aW5nID0gZmFsc2U7Ci19Ci0KLS8qKgotICogaW50ZWxfcG93
ZXJfZG9tYWluc19maW5pX2h3IC0gZGVpbml0aWFsaXplIGh3IHBvd2VyIGRvbWFpbiBzdGF0ZQot
ICogQGk5MTU6IGk5MTUgZGV2aWNlIGluc3RhbmNlCi0gKgotICogRGUtaW5pdGlhbGl6ZXMgdGhl
IGRpc3BsYXkgcG93ZXIgZG9tYWluIEhXIHN0YXRlLiBJdCBhbHNvIGVuc3VyZXMgdGhhdCB0aGUK
LSAqIGRldmljZSBzdGF5cyBwb3dlcmVkIHVwIHNvIHRoYXQgdGhlIGRyaXZlciBjYW4gYmUgcmVs
b2FkZWQuCi0gKgotICogSXQgbXVzdCBiZSBjYWxsZWQgd2l0aCBwb3dlciBkb21haW5zIGFscmVh
ZHkgZGlzYWJsZWQgKGFmdGVyIGEgY2FsbCB0bwotICogaW50ZWxfcG93ZXJfZG9tYWluc19kaXNh
YmxlKCkpIGFuZCBtdXN0IGJlIHBhaXJlZCB3aXRoCi0gKiBpbnRlbF9wb3dlcl9kb21haW5zX2lu
aXRfaHcoKS4KLSAqLwotdm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX2ZpbmlfaHcoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmk5MTUpCi17Ci0JaW50ZWxfd2FrZXJlZl90IHdha2VyZWYgX19tYXli
ZV91bnVzZWQgPQotCQlmZXRjaF9hbmRfemVybygmaTkxNS0+cG93ZXJfZG9tYWlucy53YWtlcmVm
KTsKLQotCS8qIFJlbW92ZSB0aGUgcmVmY291bnQgd2UgdG9vayB0byBrZWVwIHBvd2VyIHdlbGwg
c3VwcG9ydCBkaXNhYmxlZC4gKi8KLQlpZiAoIWk5MTVfbW9kcGFyYW1zLmRpc2FibGVfcG93ZXJf
d2VsbCkKLQkJaW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKGk5MTUsIFBPV0VSX0RP
TUFJTl9JTklUKTsKLQotCWludGVsX2Rpc3BsYXlfcG93ZXJfZmx1c2hfd29ya19zeW5jKGk5MTUp
OwotCi0JaW50ZWxfcG93ZXJfZG9tYWluc192ZXJpZnlfc3RhdGUoaTkxNSk7Ci0KLQkvKiBLZWVw
IHRoZSBwb3dlciB3ZWxsIGVuYWJsZWQsIGJ1dCBjYW5jZWwgaXRzIHJwbSB3YWtlcmVmLiAqLwot
CWludGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdha2VyZWYpOwotfQotCi0vKioKLSAqIGludGVs
X3Bvd2VyX2RvbWFpbnNfZW5hYmxlIC0gZW5hYmxlIHRvZ2dsaW5nIG9mIGRpc3BsYXkgcG93ZXIg
d2VsbHMKLSAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQotICoKLSAqIEVuYWJsZSB0aGUg
b25kZW1hbmQgZW5hYmxpbmcvZGlzYWJsaW5nIG9mIHRoZSBkaXNwbGF5IHBvd2VyIHdlbGxzLiBO
b3RlIHRoYXQKLSAqIHBvd2VyIHdlbGxzIG5vdCBiZWxvbmdpbmcgdG8gUE9XRVJfRE9NQUlOX0lO
SVQgYXJlIGFsbG93ZWQgdG8gYmUgdG9nZ2xlZAotICogb25seSBhdCBzcGVjaWZpYyBwb2ludHMg
b2YgdGhlIGRpc3BsYXkgbW9kZXNldCBzZXF1ZW5jZSwgdGh1cyB0aGV5IGFyZSBub3QKLSAqIGFm
ZmVjdGVkIGJ5IHRoZSBpbnRlbF9wb3dlcl9kb21haW5zX2VuYWJsZSgpL2Rpc2FibGUoKSBjYWxs
cy4gVGhlIHB1cnBvc2UKLSAqIG9mIHRoZXNlIGZ1bmN0aW9uIGlzIHRvIGtlZXAgdGhlIHJlc3Qg
b2YgcG93ZXIgd2VsbHMgZW5hYmxlZCB1bnRpbCB0aGUgZW5kCi0gKiBvZiBkaXNwbGF5IEhXIHJl
YWRvdXQgKHdoaWNoIHdpbGwgYWNxdWlyZSB0aGUgcG93ZXIgcmVmZXJlbmNlcyByZWZsZWN0aW5n
Ci0gKiB0aGUgY3VycmVudCBIVyBzdGF0ZSkuCi0gKi8KLXZvaWQgaW50ZWxfcG93ZXJfZG9tYWlu
c19lbmFibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCi17Ci0JaW50ZWxfd2FrZXJl
Zl90IHdha2VyZWYgX19tYXliZV91bnVzZWQgPQotCQlmZXRjaF9hbmRfemVybygmaTkxNS0+cG93
ZXJfZG9tYWlucy53YWtlcmVmKTsKLQotCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0KGk5MTUsIFBP
V0VSX0RPTUFJTl9JTklULCB3YWtlcmVmKTsKLQlpbnRlbF9wb3dlcl9kb21haW5zX3ZlcmlmeV9z
dGF0ZShpOTE1KTsKLX0KLQotLyoqCi0gKiBpbnRlbF9wb3dlcl9kb21haW5zX2Rpc2FibGUgLSBk
aXNhYmxlIHRvZ2dsaW5nIG9mIGRpc3BsYXkgcG93ZXIgd2VsbHMKLSAqIEBpOTE1OiBpOTE1IGRl
dmljZSBpbnN0YW5jZQotICoKLSAqIERpc2FibGUgdGhlIG9uZGVtYW5kIGVuYWJsaW5nL2Rpc2Fi
bGluZyBvZiB0aGUgZGlzcGxheSBwb3dlciB3ZWxscy4gU2VlCi0gKiBpbnRlbF9wb3dlcl9kb21h
aW5zX2VuYWJsZSgpIGZvciB3aGljaCBwb3dlciB3ZWxscyB0aGlzIGNhbGwgY29udHJvbHMuCi0g
Ki8KLXZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19kaXNhYmxlKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMg
PSAmaTkxNS0+cG93ZXJfZG9tYWluczsKLQotCVdBUk5fT04ocG93ZXJfZG9tYWlucy0+d2FrZXJl
Zik7Ci0JcG93ZXJfZG9tYWlucy0+d2FrZXJlZiA9Ci0JCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0
KGk5MTUsIFBPV0VSX0RPTUFJTl9JTklUKTsKLQotCWludGVsX3Bvd2VyX2RvbWFpbnNfdmVyaWZ5
X3N0YXRlKGk5MTUpOwotfQotCi0vKioKLSAqIGludGVsX3Bvd2VyX2RvbWFpbnNfc3VzcGVuZCAt
IHN1c3BlbmQgcG93ZXIgZG9tYWluIHN0YXRlCi0gKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFu
Y2UKLSAqIEBzdXNwZW5kX21vZGU6IHNwZWNpZmllcyB0aGUgdGFyZ2V0IHN1c3BlbmQgc3RhdGUg
KGlkbGUsIG1lbSwgaGliZXJuYXRpb24pCi0gKgotICogVGhpcyBmdW5jdGlvbiBwcmVwYXJlcyB0
aGUgaGFyZHdhcmUgcG93ZXIgZG9tYWluIHN0YXRlIGJlZm9yZSBlbnRlcmluZwotICogc3lzdGVt
IHN1c3BlbmQuCi0gKgotICogSXQgbXVzdCBiZSBjYWxsZWQgd2l0aCBwb3dlciBkb21haW5zIGFs
cmVhZHkgZGlzYWJsZWQgKGFmdGVyIGEgY2FsbCB0bwotICogaW50ZWxfcG93ZXJfZG9tYWluc19k
aXNhYmxlKCkpIGFuZCBwYWlyZWQgd2l0aCBpbnRlbF9wb3dlcl9kb21haW5zX3Jlc3VtZSgpLgot
ICovCi12b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfc3VzcGVuZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKLQkJCQkgZW51bSBpOTE1X2RybV9zdXNwZW5kX21vZGUgc3VzcGVuZF9tb2Rl
KQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMgPSAmaTkxNS0+
cG93ZXJfZG9tYWluczsKLQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZiBfX21heWJlX3VudXNlZCA9
Ci0JCWZldGNoX2FuZF96ZXJvKCZwb3dlcl9kb21haW5zLT53YWtlcmVmKTsKLQotCWludGVsX2Rp
c3BsYXlfcG93ZXJfcHV0KGk5MTUsIFBPV0VSX0RPTUFJTl9JTklULCB3YWtlcmVmKTsKLQotCS8q
Ci0JICogSW4gY2FzZSBvZiBzdXNwZW5kLXRvLWlkbGUgKGFrYSBTMGl4KSBvbiBhIERNQyBwbGF0
Zm9ybSB3aXRob3V0IERDOQotCSAqIHN1cHBvcnQgZG9uJ3QgbWFudWFsbHkgZGVpbml0IHRoZSBw
b3dlciBkb21haW5zLiBUaGlzIGFsc28gbWVhbnMgdGhlCi0JICogQ1NSL0RNQyBmaXJtd2FyZSB3
aWxsIHN0YXkgYWN0aXZlLCBpdCB3aWxsIHBvd2VyIGRvd24gYW55IEhXCi0JICogcmVzb3VyY2Vz
IGFzIHJlcXVpcmVkIGFuZCBhbHNvIGVuYWJsZSBkZWVwZXIgc3lzdGVtIHBvd2VyIHN0YXRlcwot
CSAqIHRoYXQgd291bGQgYmUgYmxvY2tlZCBpZiB0aGUgZmlybXdhcmUgd2FzIGluYWN0aXZlLgot
CSAqLwotCWlmICghKGk5MTUtPmNzci5hbGxvd2VkX2RjX21hc2sgJiBEQ19TVEFURV9FTl9EQzkp
ICYmCi0JICAgIHN1c3BlbmRfbW9kZSA9PSBJOTE1X0RSTV9TVVNQRU5EX0lETEUgJiYKLQkgICAg
aTkxNS0+Y3NyLmRtY19wYXlsb2FkKSB7Ci0JCWludGVsX2Rpc3BsYXlfcG93ZXJfZmx1c2hfd29y
ayhpOTE1KTsKLQkJaW50ZWxfcG93ZXJfZG9tYWluc192ZXJpZnlfc3RhdGUoaTkxNSk7Ci0JCXJl
dHVybjsKLQl9Ci0KLQkvKgotCSAqIEV2ZW4gaWYgcG93ZXIgd2VsbCBzdXBwb3J0IHdhcyBkaXNh
YmxlZCB3ZSBzdGlsbCB3YW50IHRvIGRpc2FibGUKLQkgKiBwb3dlciB3ZWxscyBpZiBwb3dlciBk
b21haW5zIG11c3QgYmUgZGVpbml0aWFsaXplZCBmb3Igc3VzcGVuZC4KLQkgKi8KLQlpZiAoIWk5
MTVfbW9kcGFyYW1zLmRpc2FibGVfcG93ZXJfd2VsbCkKLQkJaW50ZWxfZGlzcGxheV9wb3dlcl9w
dXRfdW5jaGVja2VkKGk5MTUsIFBPV0VSX0RPTUFJTl9JTklUKTsKLQotCWludGVsX2Rpc3BsYXlf
cG93ZXJfZmx1c2hfd29yayhpOTE1KTsKLQlpbnRlbF9wb3dlcl9kb21haW5zX3ZlcmlmeV9zdGF0
ZShpOTE1KTsKLQotCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCi0JCWljbF9kaXNwbGF5X2Nv
cmVfdW5pbml0KGk5MTUpOwotCWVsc2UgaWYgKElTX0NBTk5PTkxBS0UoaTkxNSkpCi0JCWNubF9k
aXNwbGF5X2NvcmVfdW5pbml0KGk5MTUpOwotCWVsc2UgaWYgKElTX0dFTjlfQkMoaTkxNSkpCi0J
CXNrbF9kaXNwbGF5X2NvcmVfdW5pbml0KGk5MTUpOwotCWVsc2UgaWYgKElTX0dFTjlfTFAoaTkx
NSkpCi0JCWJ4dF9kaXNwbGF5X2NvcmVfdW5pbml0KGk5MTUpOwotCi0JcG93ZXJfZG9tYWlucy0+
ZGlzcGxheV9jb3JlX3N1c3BlbmRlZCA9IHRydWU7Ci19Ci0KLS8qKgotICogaW50ZWxfcG93ZXJf
ZG9tYWluc19yZXN1bWUgLSByZXN1bWUgcG93ZXIgZG9tYWluIHN0YXRlCi0gKiBAaTkxNTogaTkx
NSBkZXZpY2UgaW5zdGFuY2UKLSAqCi0gKiBUaGlzIGZ1bmN0aW9uIHJlc3VtZSB0aGUgaGFyZHdh
cmUgcG93ZXIgZG9tYWluIHN0YXRlIGR1cmluZyBzeXN0ZW0gcmVzdW1lLgotICoKLSAqIEl0IHdp
bGwgcmV0dXJuIHdpdGggcG93ZXIgZG9tYWluIHN1cHBvcnQgZGlzYWJsZWQgKHRvIGJlIGVuYWJs
ZWQgbGF0ZXIgYnkKLSAqIGludGVsX3Bvd2VyX2RvbWFpbnNfZW5hYmxlKCkpIGFuZCBtdXN0IGJl
IHBhaXJlZCB3aXRoCi0gKiBpbnRlbF9wb3dlcl9kb21haW5zX3N1c3BlbmQoKS4KLSAqLwotdm9p
ZCBpbnRlbF9wb3dlcl9kb21haW5zX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSkKLXsKLQlzdHJ1Y3QgaTkxNV9wb3dlcl9kb21haW5zICpwb3dlcl9kb21haW5zID0gJmk5MTUt
PnBvd2VyX2RvbWFpbnM7Ci0KLQlpZiAocG93ZXJfZG9tYWlucy0+ZGlzcGxheV9jb3JlX3N1c3Bl
bmRlZCkgewotCQlpbnRlbF9wb3dlcl9kb21haW5zX2luaXRfaHcoaTkxNSwgdHJ1ZSk7Ci0JCXBv
d2VyX2RvbWFpbnMtPmRpc3BsYXlfY29yZV9zdXNwZW5kZWQgPSBmYWxzZTsKLQl9IGVsc2Ugewot
CQlXQVJOX09OKHBvd2VyX2RvbWFpbnMtPndha2VyZWYpOwotCQlwb3dlcl9kb21haW5zLT53YWtl
cmVmID0KLQkJCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGk5MTUsIFBPV0VSX0RPTUFJTl9JTklU
KTsKLQl9Ci0KLQlpbnRlbF9wb3dlcl9kb21haW5zX3ZlcmlmeV9zdGF0ZShpOTE1KTsKLX0KLQot
I2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVHX1JVTlRJTUVfUE0pCi0KLXN0YXRp
YyB2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfZHVtcF9pbmZvKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICppOTE1KQotewotCXN0cnVjdCBpOTE1X3Bvd2VyX2RvbWFpbnMgKnBvd2VyX2RvbWFpbnMg
PSAmaTkxNS0+cG93ZXJfZG9tYWluczsKLQlzdHJ1Y3QgaTkxNV9wb3dlcl93ZWxsICpwb3dlcl93
ZWxsOwotCi0JZm9yX2VhY2hfcG93ZXJfd2VsbChpOTE1LCBwb3dlcl93ZWxsKSB7Ci0JCWVudW0g
aW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluOwotCi0JCURSTV9ERUJVR19EUklWRVIo
IiUtMjVzICVkXG4iLAotCQkJCSBwb3dlcl93ZWxsLT5kZXNjLT5uYW1lLCBwb3dlcl93ZWxsLT5j
b3VudCk7Ci0KLQkJZm9yX2VhY2hfcG93ZXJfZG9tYWluKGRvbWFpbiwgcG93ZXJfd2VsbC0+ZGVz
Yy0+ZG9tYWlucykKLQkJCURSTV9ERUJVR19EUklWRVIoIiAgJS0yM3MgJWRcbiIsCi0JCQkJCSBp
bnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbl9zdHIoZG9tYWluKSwKLQkJCQkJIHBvd2VyX2RvbWFp
bnMtPmRvbWFpbl91c2VfY291bnRbZG9tYWluXSk7Ci0JfQotfQotCi0vKioKLSAqIGludGVsX3Bv
d2VyX2RvbWFpbnNfdmVyaWZ5X3N0YXRlIC0gdmVyaWZ5IHRoZSBIVy9TVyBzdGF0ZSBmb3IgYWxs
IHBvd2VyIHdlbGxzCi0gKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKLSAqCi0gKiBWZXJp
ZnkgaWYgdGhlIHJlZmVyZW5jZSBjb3VudCBvZiBlYWNoIHBvd2VyIHdlbGwgbWF0Y2hlcyBpdHMg
SFcgZW5hYmxlZAotICogc3RhdGUgYW5kIHRoZSB0b3RhbCByZWZjb3VudCBvZiB0aGUgZG9tYWlu
cyBpdCBiZWxvbmdzIHRvLiBUaGlzIG11c3QgYmUKLSAqIGNhbGxlZCBhZnRlciBtb2Rlc2V0IEhX
IHN0YXRlIHNhbml0aXphdGlvbiwgd2hpY2ggaXMgcmVzcG9uc2libGUgZm9yCi0gKiBhY3F1aXJp
bmcgcmVmZXJlbmNlIGNvdW50cyBmb3IgYW55IHBvd2VyIHdlbGxzIGluIHVzZSBhbmQgZGlzYWJs
aW5nIHRoZQotICogb25lcyBsZWZ0IG9uIGJ5IEJJT1MgYnV0IG5vdCByZXF1aXJlZCBieSBhbnkg
YWN0aXZlIG91dHB1dC4KLSAqLwotc3RhdGljIHZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc192ZXJp
Znlfc3RhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCi17Ci0Jc3RydWN0IGk5MTVf
cG93ZXJfZG9tYWlucyAqcG93ZXJfZG9tYWlucyA9ICZpOTE1LT5wb3dlcl9kb21haW5zOwotCXN0
cnVjdCBpOTE1X3Bvd2VyX3dlbGwgKnBvd2VyX3dlbGw7Ci0JYm9vbCBkdW1wX2RvbWFpbl9pbmZv
OwotCi0JbXV0ZXhfbG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Ci0KLQl2ZXJpZnlfYXN5bmNf
cHV0X2RvbWFpbnNfc3RhdGUocG93ZXJfZG9tYWlucyk7Ci0KLQlkdW1wX2RvbWFpbl9pbmZvID0g
ZmFsc2U7Ci0JZm9yX2VhY2hfcG93ZXJfd2VsbChpOTE1LCBwb3dlcl93ZWxsKSB7Ci0JCWVudW0g
aW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluOwotCQlpbnQgZG9tYWluc19jb3VudDsK
LQkJYm9vbCBlbmFibGVkOwotCi0JCWVuYWJsZWQgPSBwb3dlcl93ZWxsLT5kZXNjLT5vcHMtPmlz
X2VuYWJsZWQoaTkxNSwgcG93ZXJfd2VsbCk7Ci0JCWlmICgocG93ZXJfd2VsbC0+Y291bnQgfHwg
cG93ZXJfd2VsbC0+ZGVzYy0+YWx3YXlzX29uKSAhPQotCQkgICAgZW5hYmxlZCkKLQkJCURSTV9F
UlJPUigicG93ZXIgd2VsbCAlcyBzdGF0ZSBtaXNtYXRjaCAocmVmY291bnQgJWQvZW5hYmxlZCAl
ZCkiLAotCQkJCSAgcG93ZXJfd2VsbC0+ZGVzYy0+bmFtZSwKLQkJCQkgIHBvd2VyX3dlbGwtPmNv
dW50LCBlbmFibGVkKTsKLQotCQlkb21haW5zX2NvdW50ID0gMDsKLQkJZm9yX2VhY2hfcG93ZXJf
ZG9tYWluKGRvbWFpbiwgcG93ZXJfd2VsbC0+ZGVzYy0+ZG9tYWlucykKLQkJCWRvbWFpbnNfY291
bnQgKz0gcG93ZXJfZG9tYWlucy0+ZG9tYWluX3VzZV9jb3VudFtkb21haW5dOwotCi0JCWlmIChw
b3dlcl93ZWxsLT5jb3VudCAhPSBkb21haW5zX2NvdW50KSB7Ci0JCQlEUk1fRVJST1IoInBvd2Vy
IHdlbGwgJXMgcmVmY291bnQvZG9tYWluIHJlZmNvdW50IG1pc21hdGNoICIKLQkJCQkgICIocmVm
Y291bnQgJWQvZG9tYWlucyByZWZjb3VudCAlZClcbiIsCi0JCQkJICBwb3dlcl93ZWxsLT5kZXNj
LT5uYW1lLCBwb3dlcl93ZWxsLT5jb3VudCwKLQkJCQkgIGRvbWFpbnNfY291bnQpOwotCQkJZHVt
cF9kb21haW5faW5mbyA9IHRydWU7Ci0JCX0KLQl9Ci0KLQlpZiAoZHVtcF9kb21haW5faW5mbykg
ewotCQlzdGF0aWMgYm9vbCBkdW1wZWQ7Ci0KLQkJaWYgKCFkdW1wZWQpIHsKLQkJCWludGVsX3Bv
d2VyX2RvbWFpbnNfZHVtcF9pbmZvKGk5MTUpOwotCQkJZHVtcGVkID0gdHJ1ZTsKLQkJfQotCX0K
LQotCW11dGV4X3VubG9jaygmcG93ZXJfZG9tYWlucy0+bG9jayk7Ci19Ci0KLSNlbHNlCi0KLXN0
YXRpYyB2b2lkIGludGVsX3Bvd2VyX2RvbWFpbnNfdmVyaWZ5X3N0YXRlKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICppOTE1KQotewotfQotCi0jZW5kaWYKLQotc3RhdGljIGludGVsX3dha2VyZWZf
dCBfX2ludGVsX3J1bnRpbWVfcG1fZ2V0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAot
CQkJCQkgICAgICBib29sIHdha2Vsb2NrKQotewotCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gaTkx
NS0+ZHJtLnBkZXY7Ci0Jc3RydWN0IGRldmljZSAqa2RldiA9ICZwZGV2LT5kZXY7Ci0JaW50IHJl
dDsKLQotCXJldCA9IHBtX3J1bnRpbWVfZ2V0X3N5bmMoa2Rldik7Ci0JV0FSTl9PTkNFKHJldCA8
IDAsICJwbV9ydW50aW1lX2dldF9zeW5jKCkgZmFpbGVkOiAlZFxuIiwgcmV0KTsKLQotCWludGVs
X3J1bnRpbWVfcG1fYWNxdWlyZShpOTE1LCB3YWtlbG9jayk7Ci0KLQlyZXR1cm4gdHJhY2tfaW50
ZWxfcnVudGltZV9wbV93YWtlcmVmKGk5MTUpOwotfQotCi1zdGF0aWMgaW50ZWxfd2FrZXJlZl90
IGludGVsX3J1bnRpbWVfcG1fZ2V0X3JhdyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
LXsKLQlyZXR1cm4gX19pbnRlbF9ydW50aW1lX3BtX2dldChpOTE1LCBmYWxzZSk7Ci19Ci0KLS8q
KgotICogaW50ZWxfcnVudGltZV9wbV9nZXQgLSBncmFiIGEgcnVudGltZSBwbSByZWZlcmVuY2UK
LSAqIEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQotICoKLSAqIFRoaXMgZnVuY3Rpb24gZ3Jh
YnMgYSBkZXZpY2UtbGV2ZWwgcnVudGltZSBwbSByZWZlcmVuY2UgKG1vc3RseSB1c2VkIGZvciBH
RU0KLSAqIGNvZGUgdG8gZW5zdXJlIHRoZSBHVFQgb3IgR1QgaXMgb24pIGFuZCBlbnN1cmVzIHRo
YXQgaXQgaXMgcG93ZXJlZCB1cC4KLSAqCi0gKiBBbnkgcnVudGltZSBwbSByZWZlcmVuY2Ugb2J0
YWluZWQgYnkgdGhpcyBmdW5jdGlvbiBtdXN0IGhhdmUgYSBzeW1tZXRyaWMKLSAqIGNhbGwgdG8g
aW50ZWxfcnVudGltZV9wbV9wdXQoKSB0byByZWxlYXNlIHRoZSByZWZlcmVuY2UgYWdhaW4uCi0g
KgotICogUmV0dXJuczogdGhlIHdha2VyZWYgY29va2llIHRvIHBhc3MgdG8gaW50ZWxfcnVudGlt
ZV9wbV9wdXQoKQotICovCi1pbnRlbF93YWtlcmVmX3QgaW50ZWxfcnVudGltZV9wbV9nZXQoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCi17Ci0JcmV0dXJuIF9faW50ZWxfcnVudGltZV9w
bV9nZXQoaTkxNSwgdHJ1ZSk7Ci19Ci0KLS8qKgotICogaW50ZWxfcnVudGltZV9wbV9nZXRfaWZf
aW5fdXNlIC0gZ3JhYiBhIHJ1bnRpbWUgcG0gcmVmZXJlbmNlIGlmIGRldmljZSBpbiB1c2UKLSAq
IEBpOTE1OiBpOTE1IGRldmljZSBpbnN0YW5jZQotICoKLSAqIFRoaXMgZnVuY3Rpb24gZ3JhYnMg
YSBkZXZpY2UtbGV2ZWwgcnVudGltZSBwbSByZWZlcmVuY2UgaWYgdGhlIGRldmljZSBpcwotICog
YWxyZWFkeSBpbiB1c2UgYW5kIGVuc3VyZXMgdGhhdCBpdCBpcyBwb3dlcmVkIHVwLiBJdCBpcyBp
bGxlZ2FsIHRvIHRyeQotICogYW5kIGFjY2VzcyB0aGUgSFcgc2hvdWxkIGludGVsX3J1bnRpbWVf
cG1fZ2V0X2lmX2luX3VzZSgpIHJlcG9ydCBmYWlsdXJlLgotICoKLSAqIEFueSBydW50aW1lIHBt
IHJlZmVyZW5jZSBvYnRhaW5lZCBieSB0aGlzIGZ1bmN0aW9uIG11c3QgaGF2ZSBhIHN5bW1ldHJp
YwotICogY2FsbCB0byBpbnRlbF9ydW50aW1lX3BtX3B1dCgpIHRvIHJlbGVhc2UgdGhlIHJlZmVy
ZW5jZSBhZ2Fpbi4KLSAqCi0gKiBSZXR1cm5zOiB0aGUgd2FrZXJlZiBjb29raWUgdG8gcGFzcyB0
byBpbnRlbF9ydW50aW1lX3BtX3B1dCgpLCBldmFsdWF0ZXMKLSAqIGFzIFRydWUgaWYgdGhlIHdh
a2VyZWYgd2FzIGFjcXVpcmVkLCBvciBGYWxzZSBvdGhlcndpc2UuCi0gKi8KLWludGVsX3dha2Vy
ZWZfdCBpbnRlbF9ydW50aW1lX3BtX2dldF9pZl9pbl91c2Uoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUpCi17Ci0JaWYgKElTX0VOQUJMRUQoQ09ORklHX1BNKSkgewotCQlzdHJ1Y3QgcGNp
X2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2OwotCQlzdHJ1Y3QgZGV2aWNlICprZGV2ID0gJnBk
ZXYtPmRldjsKLQotCQkvKgotCQkgKiBJbiBjYXNlcyBydW50aW1lIFBNIGlzIGRpc2FibGVkIGJ5
IHRoZSBSUE0gY29yZSBhbmQgd2UgZ2V0Ci0JCSAqIGFuIC1FSU5WQUwgcmV0dXJuIHZhbHVlIHdl
IGFyZSBub3Qgc3VwcG9zZWQgdG8gY2FsbCB0aGlzCi0JCSAqIGZ1bmN0aW9uLCBzaW5jZSB0aGUg
cG93ZXIgc3RhdGUgaXMgdW5kZWZpbmVkLiBUaGlzIGFwcGxpZXMKLQkJICogYXRtIHRvIHRoZSBs
YXRlL2Vhcmx5IHN5c3RlbSBzdXNwZW5kL3Jlc3VtZSBoYW5kbGVycy4KLQkJICovCi0JCWlmIChw
bV9ydW50aW1lX2dldF9pZl9pbl91c2Uoa2RldikgPD0gMCkKLQkJCXJldHVybiAwOwotCX0KLQot
CWludGVsX3J1bnRpbWVfcG1fYWNxdWlyZShpOTE1LCB0cnVlKTsKLQotCXJldHVybiB0cmFja19p
bnRlbF9ydW50aW1lX3BtX3dha2VyZWYoaTkxNSk7Ci19Ci0KLS8qKgotICogaW50ZWxfcnVudGlt
ZV9wbV9nZXRfbm9yZXN1bWUgLSBncmFiIGEgcnVudGltZSBwbSByZWZlcmVuY2UKLSAqIEBpOTE1
OiBpOTE1IGRldmljZSBpbnN0YW5jZQotICoKLSAqIFRoaXMgZnVuY3Rpb24gZ3JhYnMgYSBkZXZp
Y2UtbGV2ZWwgcnVudGltZSBwbSByZWZlcmVuY2UgKG1vc3RseSB1c2VkIGZvciBHRU0KLSAqIGNv
ZGUgdG8gZW5zdXJlIHRoZSBHVFQgb3IgR1QgaXMgb24pLgotICoKLSAqIEl0IHdpbGwgX25vdF8g
cG93ZXIgdXAgdGhlIGRldmljZSBidXQgaW5zdGVhZCBvbmx5IGNoZWNrIHRoYXQgaXQncyBwb3dl
cmVkCi0gKiBvbi4gIFRoZXJlZm9yZSBpdCBpcyBvbmx5IHZhbGlkIHRvIGNhbGwgdGhpcyBmdW5j
dGlvbnMgZnJvbSBjb250ZXh0cyB3aGVyZQotICogdGhlIGRldmljZSBpcyBrbm93biB0byBiZSBw
b3dlcmVkIHVwIGFuZCB3aGVyZSB0cnlpbmcgdG8gcG93ZXIgaXQgdXAgd291bGQKLSAqIHJlc3Vs
dCBpbiBoaWxhcml0eSBhbmQgZGVhZGxvY2tzLiBUaGF0IHByZXR0eSBtdWNoIG1lYW5zIG9ubHkg
dGhlIHN5c3RlbQotICogc3VzcGVuZC9yZXN1bWUgY29kZSB3aGVyZSB0aGlzIGlzIHVzZWQgdG8g
Z3JhYiBydW50aW1lIHBtIHJlZmVyZW5jZXMgZm9yCi0gKiBkZWxheWVkIHNldHVwIGRvd24gaW4g
d29yayBpdGVtcy4KLSAqCi0gKiBBbnkgcnVudGltZSBwbSByZWZlcmVuY2Ugb2J0YWluZWQgYnkg
dGhpcyBmdW5jdGlvbiBtdXN0IGhhdmUgYSBzeW1tZXRyaWMKLSAqIGNhbGwgdG8gaW50ZWxfcnVu
dGltZV9wbV9wdXQoKSB0byByZWxlYXNlIHRoZSByZWZlcmVuY2UgYWdhaW4uCi0gKgotICogUmV0
dXJuczogdGhlIHdha2VyZWYgY29va2llIHRvIHBhc3MgdG8gaW50ZWxfcnVudGltZV9wbV9wdXQo
KQotICovCi1pbnRlbF93YWtlcmVmX3QgaW50ZWxfcnVudGltZV9wbV9nZXRfbm9yZXN1bWUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCi17Ci0Jc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBp
OTE1LT5kcm0ucGRldjsKLQlzdHJ1Y3QgZGV2aWNlICprZGV2ID0gJnBkZXYtPmRldjsKLQotCWFz
c2VydF9ycG1fd2FrZWxvY2tfaGVsZChpOTE1KTsKLQlwbV9ydW50aW1lX2dldF9ub3Jlc3VtZShr
ZGV2KTsKLQotCWludGVsX3J1bnRpbWVfcG1fYWNxdWlyZShpOTE1LCB0cnVlKTsKLQotCXJldHVy
biB0cmFja19pbnRlbF9ydW50aW1lX3BtX3dha2VyZWYoaTkxNSk7Ci19Ci0KLXN0YXRpYyB2b2lk
IF9faW50ZWxfcnVudGltZV9wbV9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCi0J
CQkJICAgaW50ZWxfd2FrZXJlZl90IHdyZWYsCi0JCQkJICAgYm9vbCB3YWtlbG9jaykKLXsKLQlz
dHJ1Y3QgcGNpX2RldiAqcGRldiA9IGk5MTUtPmRybS5wZGV2OwotCXN0cnVjdCBkZXZpY2UgKmtk
ZXYgPSAmcGRldi0+ZGV2OwotCi0JdW50cmFja19pbnRlbF9ydW50aW1lX3BtX3dha2VyZWYoaTkx
NSwgd3JlZik7Ci0KLQlpbnRlbF9ydW50aW1lX3BtX3JlbGVhc2UoaTkxNSwgd2FrZWxvY2spOwot
Ci0JcG1fcnVudGltZV9tYXJrX2xhc3RfYnVzeShrZGV2KTsKLQlwbV9ydW50aW1lX3B1dF9hdXRv
c3VzcGVuZChrZGV2KTsKLX0KLQotI2lmIElTX0VOQUJMRUQoQ09ORklHX0RSTV9JOTE1X0RFQlVH
X1JVTlRJTUVfUE0pCi1zdGF0aWMgdm9pZAotaW50ZWxfcnVudGltZV9wbV9wdXRfcmF3KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnRlbF93YWtlcmVmX3Qgd3JlZikKLXsKLQlfX2lu
dGVsX3J1bnRpbWVfcG1fcHV0KGk5MTUsIHdyZWYsIGZhbHNlKTsKLX0KLSNlbmRpZgotCiAvKioK
ICAqIGludGVsX3J1bnRpbWVfcG1fcHV0X3VuY2hlY2tlZCAtIHJlbGVhc2UgYW4gdW5jaGVja2Vk
IHJ1bnRpbWUgcG0gcmVmZXJlbmNlCiAgKiBAaTkxNTogaTkxNSBkZXZpY2UgaW5zdGFuY2UKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3J1bnRpbWVfcG0uaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2ludGVsX3J1bnRpbWVfcG0uaAppbmRleCAwYTRjNGIzYWVlN2QuLmE3
YWNjZWIxMzQ3MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcnVudGlt
ZV9wbS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3J1bnRpbWVfcG0uaApAQCAt
MTMsNyArMTMsNiBAQAogCiBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKIHN0cnVjdCBkcm1fcHJp
bnRlcjsKLXN0cnVjdCBpbnRlbF9lbmNvZGVyOwogCiBlbnVtIGk5MTVfZHJtX3N1c3BlbmRfbW9k
ZSB7CiAJSTkxNV9EUk1fU1VTUEVORF9JRExFLApAQCAtMjEsODkgKzIwLDE1IEBAIGVudW0gaTkx
NV9kcm1fc3VzcGVuZF9tb2RlIHsKIAlJOTE1X0RSTV9TVVNQRU5EX0hJQkVSTkFURSwKIH07CiAK
LXZvaWQgc2tsX2VuYWJsZV9kYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsK
LXZvaWQgZ2VuOV9zYW5pdGl6ZV9kY19zdGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwotdm9pZCBieHRfZW5hYmxlX2RjOShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYpOwotdm9pZCBieHRfZGlzYWJsZV9kYzkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KTsKLXZvaWQgZ2VuOV9lbmFibGVfZGM1KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Ci0KIHZvaWQgaW50ZWxfcnVudGltZV9wbV9pbml0X2Vhcmx5KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdik7Ci1pbnQgaW50ZWxfcG93ZXJfZG9tYWluc19pbml0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICopOwotdm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX2NsZWFu
dXAoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQgaW50ZWxfcG93ZXJf
ZG9tYWluc19pbml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCBy
ZXN1bWUpOwotdm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX2ZpbmlfaHcoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQgaWNsX2Rpc3BsYXlfY29yZV9pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCByZXN1bWUpOwotdm9pZCBpY2xfZGlzcGxh
eV9jb3JlX3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBp
bnRlbF9wb3dlcl9kb21haW5zX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYpOwotdm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KTsKLXZvaWQgaW50ZWxfcG93ZXJfZG9tYWluc19zdXNwZW5kKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgZW51bSBpOTE1X2RybV9zdXNwZW5k
X21vZGUpOwotdm9pZCBpbnRlbF9wb3dlcl9kb21haW5zX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBoc3dfZW5hYmxlX3BjOChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYpOwotdm9pZCBoc3dfZGlzYWJsZV9wYzgoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQgYnh0X2Rpc3BsYXlfY29yZV9pbml0KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgYm9vbCByZXN1bWUpOwotdm9pZCBieHRfZGlzcGxh
eV9jb3JlX3VuaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogdm9pZCBp
bnRlbF9ydW50aW1lX3BtX2VuYWJsZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
Owogdm9pZCBpbnRlbF9ydW50aW1lX3BtX2Rpc2FibGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KTsKIHZvaWQgaW50ZWxfcnVudGltZV9wbV9jbGVhbnVwKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdik7CiAKLWNvbnN0IGNoYXIgKgotaW50ZWxfZGlzcGxheV9wb3dl
cl9kb21haW5fc3RyKGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKTsKLQot
Ym9vbCBpbnRlbF9kaXNwbGF5X3Bvd2VyX2lzX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAotCQkJCSAgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRv
bWFpbik7Ci1ib29sIF9faW50ZWxfZGlzcGxheV9wb3dlcl9pc19lbmFibGVkKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiwKLQkJCQkgICAgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93
ZXJfZG9tYWluIGRvbWFpbik7Ci1pbnRlbF93YWtlcmVmX3QgaW50ZWxfZGlzcGxheV9wb3dlcl9n
ZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJCQllbnVtIGludGVsX2Rp
c3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbik7Ci1pbnRlbF93YWtlcmVmX3QKLWludGVsX2Rpc3Bs
YXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAotCQkJCSAgIGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluKTsKLXZvaWQg
aW50ZWxfZGlzcGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKLQkJCQkgICAgICAgZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBk
b21haW4pOwotdm9pZCBfX2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAotCQkJCSAgICAgZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2Rv
bWFpbiBkb21haW4sCi0JCQkJICAgICBpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZik7Ci12b2lkIGlu
dGVsX2Rpc3BsYXlfcG93ZXJfZmx1c2hfd29yayhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSk7Ci0jaWYgSVNfRU5BQkxFRChDT05GSUdfRFJNX0k5MTVfREVCVUdfUlVOVElNRV9QTSkKLXZv
aWQgaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAotCQkJICAgICBlbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbiwKLQkJ
CSAgICAgaW50ZWxfd2FrZXJlZl90IHdha2VyZWYpOwotc3RhdGljIGlubGluZSB2b2lkCi1pbnRl
bF9kaXNwbGF5X3Bvd2VyX3B1dF9hc3luYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwK
LQkJCSAgICAgIGVudW0gaW50ZWxfZGlzcGxheV9wb3dlcl9kb21haW4gZG9tYWluLAotCQkJICAg
ICAgaW50ZWxfd2FrZXJlZl90IHdha2VyZWYpCi17Ci0JX19pbnRlbF9kaXNwbGF5X3Bvd2VyX3B1
dF9hc3luYyhpOTE1LCBkb21haW4sIHdha2VyZWYpOwotfQotI2Vsc2UKLXN0YXRpYyBpbmxpbmUg
dm9pZAotaW50ZWxfZGlzcGxheV9wb3dlcl9wdXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5
MTUsCi0JCQllbnVtIGludGVsX2Rpc3BsYXlfcG93ZXJfZG9tYWluIGRvbWFpbiwKLQkJCWludGVs
X3dha2VyZWZfdCB3YWtlcmVmKQotewotCWludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X3VuY2hlY2tl
ZChpOTE1LCBkb21haW4pOwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQKLWludGVsX2Rpc3BsYXlf
cG93ZXJfcHV0X2FzeW5jKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAotCQkJICAgICAg
ZW51bSBpbnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbiBkb21haW4sCi0JCQkgICAgICBpbnRlbF93
YWtlcmVmX3Qgd2FrZXJlZikKLXsKLQlfX2ludGVsX2Rpc3BsYXlfcG93ZXJfcHV0X2FzeW5jKGk5
MTUsIGRvbWFpbiwgLTEpOwotfQotI2VuZGlmCi0KLSNkZWZpbmUgd2l0aF9pbnRlbF9kaXNwbGF5
X3Bvd2VyKGk5MTUsIGRvbWFpbiwgd2YpIFwKLQlmb3IgKCh3ZikgPSBpbnRlbF9kaXNwbGF5X3Bv
d2VyX2dldCgoaTkxNSksIChkb21haW4pKTsgKHdmKTsgXAotCSAgICAgaW50ZWxfZGlzcGxheV9w
b3dlcl9wdXRfYXN5bmMoKGk5MTUpLCAoZG9tYWluKSwgKHdmKSksICh3ZikgPSAwKQotCi12b2lk
IGljbF9kYnVmX3NsaWNlc191cGRhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
LAotCQkJICAgIHU4IHJlcV9zbGljZXMpOwotCiBpbnRlbF93YWtlcmVmX3QgaW50ZWxfcnVudGlt
ZV9wbV9nZXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOwogaW50ZWxfd2FrZXJlZl90
IGludGVsX3J1bnRpbWVfcG1fZ2V0X2lmX2luX3VzZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7CiBpbnRlbF93YWtlcmVmX3QgaW50ZWxfcnVudGltZV9wbV9nZXRfbm9yZXN1bWUoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpOworaW50ZWxfd2FrZXJlZl90IGludGVsX3J1bnRp
bWVfcG1fZ2V0X3JhdyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiAKICNkZWZpbmUg
d2l0aF9pbnRlbF9ydW50aW1lX3BtKGk5MTUsIHdmKSBcCiAJZm9yICgod2YpID0gaW50ZWxfcnVu
dGltZV9wbV9nZXQoaTkxNSk7ICh3Zik7IFwKQEAgLTEyMyw2ICs0OCw3IEBAIGludGVsX3J1bnRp
bWVfcG1fcHV0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LCBpbnRlbF93YWtlcmVmX3Qg
d3JlZikKIAlpbnRlbF9ydW50aW1lX3BtX3B1dF91bmNoZWNrZWQoaTkxNSk7CiB9CiAjZW5kaWYK
K3ZvaWQgaW50ZWxfcnVudGltZV9wbV9wdXRfcmF3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1LCBpbnRlbF93YWtlcmVmX3Qgd3JlZik7CiAKICNpZiBJU19FTkFCTEVEKENPTkZJR19EUk1f
STkxNV9ERUJVR19SVU5USU1FX1BNKQogdm9pZCBwcmludF9pbnRlbF9ydW50aW1lX3BtX3dha2Vy
ZWYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCkBAIC0xMzQsOSArNjAsNCBAQCBzdGF0
aWMgaW5saW5lIHZvaWQgcHJpbnRfaW50ZWxfcnVudGltZV9wbV93YWtlcmVmKHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICppOTE1LAogfQogI2VuZGlmCiAKLXZvaWQgY2h2X3BoeV9wb3dlcmdhdGVf
bGFuZXMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCi0JCQkgICAgIGJvb2wgb3ZlcnJp
ZGUsIHVuc2lnbmVkIGludCBtYXNrKTsKLWJvb2wgY2h2X3BoeV9wb3dlcmdhdGVfY2goc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIGRwaW9fcGh5IHBoeSwKLQkJCSAgZW51
bSBkcGlvX2NoYW5uZWwgY2gsIGJvb2wgb3ZlcnJpZGUpOwotCiAjZW5kaWYgLyogX19JTlRFTF9S
VU5USU1FX1BNX0hfXyAqLwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0
cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9s
aXN0aW5mby9pbnRlbC1nZng=

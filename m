Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 3E386EA3FB
	for <lists+intel-gfx@lfdr.de>; Wed, 30 Oct 2019 20:22:16 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0D0896EB3B;
	Wed, 30 Oct 2019 19:22:14 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 260286EB45
 for <intel-gfx@lists.freedesktop.org>; Wed, 30 Oct 2019 19:22:13 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19024456-1500050 
 for multiple; Wed, 30 Oct 2019 19:22:01 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 30 Oct 2019 19:21:50 +0000
Message-Id: <20191030192159.18404-2-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.24.0.rc1
In-Reply-To: <20191030192159.18404-1-chris@chris-wilson.co.uk>
References: <20191030192159.18404-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 02/11] drm/i915/gt: Call intel_gt_sanitize()
 directly
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QXNzdW1lIGFsbCByZXNwb25zaWJpbGl0eSBmb3Igb3BlcmF0aW5nIG9uIHRoZSBIVyB0byBzYW5p
dGl6ZSB0aGUgR1QKc3RhdGUgdXBvbiBsb2FkL3Jlc3VtZSBpbiBpbnRlbF9ndF9zYW5pdGl6ZSgp
IGl0c2VsZi4KClNpZ25lZC1vZmYtYnk6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29u
LmNvLnVrPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9wbS5jICAgICAg
ICB8ICA1IC0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3QuYyAgICAgICAgICAg
IHwgIDYgKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9ndC5oICAgICAgICAgICAg
fCAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYyAgICAgICAgIHwg
MzYgKysrKysrKysrKysrKysrKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jICAg
ICAgICAgICAgICAgfCAgOCArLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oICAg
ICAgICAgICAgICAgfCAgMiAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jICAgICAg
ICAgICAgICAgfCAzNyAtLS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaTkxNV9nZW0uYyAgICAgfCAgMSAtCiAuLi4vZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9tb2NrX2dlbV9kZXZpY2UuYyAgfCAgMSAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVz
dHMvbW9ja19ndHQuYyAgICAgfCAgMyArLQogMTAgZmlsZXMgY2hhbmdlZCwgNDMgaW5zZXJ0aW9u
cygrKSwgNTggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX3BtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fcG0u
YwppbmRleCBjOTliYjk0ZmU0MWUuLmUyZWU5YzA0ZWNlOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX3BtLmMKQEAgLTc0LDcgKzc0LDYgQEAgdm9pZCBpOTE1X2dlbV9zdXNwZW5k
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCSAqIG5vdCByZWx5IG9uIGl0cyBzdGF0
ZS4KIAkgKi8KIAlpbnRlbF9ndF9zdXNwZW5kKCZpOTE1LT5ndCk7Ci0JaW50ZWxfdWNfc3VzcGVu
ZCgmaTkxNS0+Z3QudWMpOwogCiAJaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhpOTE1KTsK
IH0KQEAgLTE0MCw4ICsxMzksNiBAQCB2b2lkIGk5MTVfZ2VtX3N1c3BlbmRfbGF0ZShzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJbGlzdF9zcGxpY2VfdGFpbCgma2VlcCwgKnBoYXNl
KTsKIAl9CiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaTkxNS0+bW0ub2JqX2xvY2ssIGZsYWdz
KTsKLQotCWk5MTVfZ2VtX3Nhbml0aXplKGk5MTUpOwogfQogCiB2b2lkIGk5MTVfZ2VtX3Jlc3Vt
ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKQEAgLTE2MSw4ICsxNTgsNiBAQCB2b2lk
IGk5MTVfZ2VtX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlpZiAoaW50
ZWxfZ3RfcmVzdW1lKCZpOTE1LT5ndCkpCiAJCWdvdG8gZXJyX3dlZGdlZDsKIAotCWludGVsX3Vj
X3Jlc3VtZSgmaTkxNS0+Z3QudWMpOwotCiAJLyogQWx3YXlzIHJlbG9hZCBhIGNvbnRleHQgZm9y
IHBvd2Vyc2F2aW5nLiAqLwogCWlmICghc3dpdGNoX3RvX2tlcm5lbF9jb250ZXh0X3N5bmMoJmk5
MTUtPmd0KSkKIAkJZ290byBlcnJfd2VkZ2VkOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZ3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmMK
aW5kZXggODk4NjYyYzE1OGFkLi40YzI2ZGFmN2VlNDYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2d0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZ3QuYwpAQCAtMzEsOSArMzEsMTEgQEAgdm9pZCBpbnRlbF9ndF9pbml0X2Vhcmx5KHN0cnVj
dCBpbnRlbF9ndCAqZ3QsIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWludGVsX3Vj
X2luaXRfZWFybHkoJmd0LT51Yyk7CiB9CiAKLXZvaWQgaW50ZWxfZ3RfaW5pdF9od19lYXJseShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3ZvaWQgaW50ZWxfZ3RfaW5pdF9od19lYXJs
eShzdHJ1Y3QgaW50ZWxfZ3QgKmd0LCBzdHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQogewotCWk5MTUt
Pmd0LmdndHQgPSAmaTkxNS0+Z2d0dDsKKwlndC0+Z2d0dCA9IGdndHQ7CisKKwlpbnRlbF9ndF9z
YW5pdGl6ZShndCwgZmFsc2UpOwogfQogCiBzdGF0aWMgdm9pZCBpbml0X3VudXNlZF9yaW5nKHN0
cnVjdCBpbnRlbF9ndCAqZ3QsIHUzMiBiYXNlKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfZ3QuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0LmgK
aW5kZXggNWI2ZWZmZWQzNzEzLi41NDM2ZjhjMzA3MDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2d0LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50
ZWxfZ3QuaApAQCAtMjgsNyArMjgsNyBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBpbnRlbF9ndCAq
aHVjX3RvX2d0KHN0cnVjdCBpbnRlbF9odWMgKmh1YykKIH0KIAogdm9pZCBpbnRlbF9ndF9pbml0
X2Vhcmx5KHN0cnVjdCBpbnRlbF9ndCAqZ3QsIHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1
KTsKLXZvaWQgaW50ZWxfZ3RfaW5pdF9od19lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSk7Cit2b2lkIGludGVsX2d0X2luaXRfaHdfZWFybHkoc3RydWN0IGludGVsX2d0ICpndCwg
c3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCk7CiBpbnQgX19tdXN0X2NoZWNrIGludGVsX2d0X2luaXRf
aHcoc3RydWN0IGludGVsX2d0ICpndCk7CiBpbnQgaW50ZWxfZ3RfaW5pdChzdHJ1Y3QgaW50ZWxf
Z3QgKmd0KTsKIHZvaWQgaW50ZWxfZ3RfZHJpdmVyX3JlZ2lzdGVyKHN0cnVjdCBpbnRlbF9ndCAq
Z3QpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2d0X3BtLmMKaW5kZXggMzJiZWNmMTVkNGUw
Li4xNjc5ZjRmNzhkNjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVs
X2d0X3BtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3RfcG0uYwpAQCAt
MTE4LDggKzExOCwyMiBAQCB2b2lkIGludGVsX2d0X3Nhbml0aXplKHN0cnVjdCBpbnRlbF9ndCAq
Z3QsIGJvb2wgZm9yY2UpCiB7CiAJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCWVu
dW0gaW50ZWxfZW5naW5lX2lkIGlkOworCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwogCi0JR0VN
X1RSQUNFKCJcbiIpOworCUdFTV9UUkFDRSgiZm9yY2U6JXNcbiIsIHllc25vKGZvcmNlKSk7CisK
KwkvKiBVc2UgYSByYXcgd2FrZXJlZiB0byBhdm9pZCBjYWxsaW5nIGludGVsX2Rpc3BsYXlfcG93
ZXJfZ2V0IGVhcmx5ICovCisJd2FrZXJlZiA9IGludGVsX3J1bnRpbWVfcG1fZ2V0KGd0LT51bmNv
cmUtPnJwbSk7CisJaW50ZWxfdW5jb3JlX2ZvcmNld2FrZV9nZXQoZ3QtPnVuY29yZSwgRk9SQ0VX
QUtFX0FMTCk7CisKKwkvKgorCSAqIEFzIHdlIGhhdmUganVzdCByZXN1bWVkIHRoZSBtYWNoaW5l
IGFuZCB3b2tlbiB0aGUgZGV2aWNlIHVwIGZyb20KKwkgKiBkZWVwIFBDSSBzbGVlcCAocHJlc3Vt
YWJseSBEM19jb2xkKSwgYXNzdW1lIHRoZSBIVyBoYXMgYmVlbiByZXNldAorCSAqIGJhY2sgdG8g
ZGVmYXVsdHMsIHJlY292ZXJpbmcgZnJvbSB3aGF0ZXZlciB3ZWRnZWQgc3RhdGUgd2UgbGVmdCBp
dAorCSAqIGluIGFuZCBzbyB3b3J0aCB0cnlpbmcgdG8gdXNlIHRoZSBkZXZpY2Ugb25jZSBtb3Jl
LgorCSAqLworCWlmIChpbnRlbF9ndF9pc193ZWRnZWQoZ3QpKQorCQlpbnRlbF9ndF91bnNldF93
ZWRnZWQoZ3QpOwogCiAJaW50ZWxfdWNfc2FuaXRpemUoJmd0LT51Yyk7CiAKQEAgLTEyNyw2ICsx
NDEsOCBAQCB2b2lkIGludGVsX2d0X3Nhbml0aXplKHN0cnVjdCBpbnRlbF9ndCAqZ3QsIGJvb2wg
Zm9yY2UpCiAJCWlmIChlbmdpbmUtPnJlc2V0LnByZXBhcmUpCiAJCQllbmdpbmUtPnJlc2V0LnBy
ZXBhcmUoZW5naW5lKTsKIAorCWludGVsX3VjX3Jlc2V0X3ByZXBhcmUoJmd0LT51Yyk7CisKIAlp
ZiAocmVzZXRfZW5naW5lcyhndCkgfHwgZm9yY2UpIHsKIAkJZm9yX2VhY2hfZW5naW5lKGVuZ2lu
ZSwgZ3QsIGlkKQogCQkJX19pbnRlbF9lbmdpbmVfcmVzZXQoZW5naW5lLCBmYWxzZSk7CkBAIC0x
MzUsNiArMTUxLDkgQEAgdm9pZCBpbnRlbF9ndF9zYW5pdGl6ZShzdHJ1Y3QgaW50ZWxfZ3QgKmd0
LCBib29sIGZvcmNlKQogCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LCBpZCkKIAkJaWYgKGVu
Z2luZS0+cmVzZXQuZmluaXNoKQogCQkJZW5naW5lLT5yZXNldC5maW5pc2goZW5naW5lKTsKKwor
CWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KGd0LT51bmNvcmUsIEZPUkNFV0FLRV9BTEwpOwor
CWludGVsX3J1bnRpbWVfcG1fcHV0KGd0LT51bmNvcmUtPnJwbSwgd2FrZXJlZik7CiB9CiAKIHZv
aWQgaW50ZWxfZ3RfcG1fZmluaShzdHJ1Y3QgaW50ZWxfZ3QgKmd0KQpAQCAtMTQ4LDYgKzE2Nyw4
IEBAIGludCBpbnRlbF9ndF9yZXN1bWUoc3RydWN0IGludGVsX2d0ICpndCkKIAllbnVtIGludGVs
X2VuZ2luZV9pZCBpZDsKIAlpbnQgZXJyID0gMDsKIAorCUdFTV9UUkFDRSgiXG4iKTsKKwogCS8q
CiAJICogQWZ0ZXIgcmVzdW1lLCB3ZSBtYXkgbmVlZCB0byBwb2tlIGludG8gdGhlIHBpbm5lZCBr
ZXJuZWwKIAkgKiBjb250ZXh0cyB0byBwYXBlciBvdmVyIGFueSBkYW1hZ2UgY2F1c2VkIGJ5IHRo
ZSBzdWRkZW4gc3VzcGVuZC4KQEAgLTE4Niw2ICsyMDcsOSBAQCBpbnQgaW50ZWxfZ3RfcmVzdW1l
KHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiAJfQogCiAJaW50ZWxfcmM2X2VuYWJsZSgmZ3QtPnJjNik7
CisKKwlpbnRlbF91Y19yZXN1bWUoJmd0LT51Yyk7CisKIAlpbnRlbF91bmNvcmVfZm9yY2V3YWtl
X3B1dChndC0+dW5jb3JlLCBGT1JDRVdBS0VfQUxMKTsKIAlpbnRlbF9ndF9wbV9wdXQoZ3QpOwog
CkBAIC0yMTIsMjAgKzIzNiwzMCBAQCB2b2lkIGludGVsX2d0X3N1c3BlbmQoc3RydWN0IGludGVs
X2d0ICpndCkKIAkvKiBXZSBleHBlY3QgdG8gYmUgaWRsZSBhbHJlYWR5OyBidXQgYWxzbyB3YW50
IHRvIGJlIGluZGVwZW5kZW50ICovCiAJd2FpdF9mb3JfaWRsZShndCk7CiAKKwlpbnRlbF91Y19z
dXNwZW5kKCZndC0+dWMpOworCiAJd2l0aF9pbnRlbF9ydW50aW1lX3BtKGd0LT51bmNvcmUtPnJw
bSwgd2FrZXJlZikgewogCQlpbnRlbF9ycHNfZGlzYWJsZSgmZ3QtPnJwcyk7CiAJCWludGVsX3Jj
Nl9kaXNhYmxlKCZndC0+cmM2KTsKIAkJaW50ZWxfbGxjX2Rpc2FibGUoJmd0LT5sbGMpOwogCX0K
KworCWludGVsX2d0X3Nhbml0aXplKGd0LCBmYWxzZSk7CisKKwlHRU1fVFJBQ0UoIlxuIik7CiB9
CiAKIHZvaWQgaW50ZWxfZ3RfcnVudGltZV9zdXNwZW5kKHN0cnVjdCBpbnRlbF9ndCAqZ3QpCiB7
CiAJaW50ZWxfdWNfcnVudGltZV9zdXNwZW5kKCZndC0+dWMpOworCisJR0VNX1RSQUNFKCJcbiIp
OwogfQogCiBpbnQgaW50ZWxfZ3RfcnVudGltZV9yZXN1bWUoc3RydWN0IGludGVsX2d0ICpndCkK
IHsKKwlHRU1fVFJBQ0UoIlxuIik7CisKIAlpbnRlbF9ndF9pbml0X3N3aXp6bGluZyhndCk7CiAK
IAlyZXR1cm4gaW50ZWxfdWNfcnVudGltZV9yZXN1bWUoJmd0LT51Yyk7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuYwppbmRleCAyMTI3M2I1MTZkYmUuLjdlMGMwZTMxOTU1ZSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2Rydi5jCkBAIC02MDMsOCArNjAzLDYgQEAgc3RhdGljIGludCBpOTE1X2RyaXZlcl9tbWlv
X3Byb2JlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlpZiAocmV0KQogCQln
b3RvIGVycl91bmNvcmU7CiAKLQlpOTE1X2dlbV9pbml0X21taW8oZGV2X3ByaXYpOwotCiAJcmV0
dXJuIDA7CiAKIGVycl91bmNvcmU6CkBAIC0xMTc3LDcgKzExNzUsNyBAQCBzdGF0aWMgaW50IGk5
MTVfZHJpdmVyX2h3X3Byb2JlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlp
ZiAocmV0KQogCQlnb3RvIGVycl9nZ3R0OwogCi0JaW50ZWxfZ3RfaW5pdF9od19lYXJseShkZXZf
cHJpdik7CisJaW50ZWxfZ3RfaW5pdF9od19lYXJseSgmZGV2X3ByaXYtPmd0LCAmZGV2X3ByaXYt
PmdndHQpOwogCiAJcmV0ID0gaTkxNV9nZ3R0X2VuYWJsZV9odyhkZXZfcHJpdik7CiAJaWYgKHJl
dCkgewpAQCAtMTgwNCw3ICsxODAyLDcgQEAgc3RhdGljIGludCBpOTE1X2RybV9yZXN1bWUoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldikKIAogCWRpc2FibGVfcnBtX3dha2VyZWZfYXNzZXJ0cygmZGV2
X3ByaXYtPnJ1bnRpbWVfcG0pOwogCi0JaTkxNV9nZW1fc2FuaXRpemUoZGV2X3ByaXYpOworCWlu
dGVsX2d0X3Nhbml0aXplKCZkZXZfcHJpdi0+Z3QsIHRydWUpOwogCiAJcmV0ID0gaTkxNV9nZ3R0
X2VuYWJsZV9odyhkZXZfcHJpdik7CiAJaWYgKHJldCkKQEAgLTE5MzUsOCArMTkzMyw2IEBAIHN0
YXRpYyBpbnQgaTkxNV9kcm1fcmVzdW1lX2Vhcmx5KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpCiAK
IAlpbnRlbF9wb3dlcl9kb21haW5zX3Jlc3VtZShkZXZfcHJpdik7CiAKLQlpbnRlbF9ndF9zYW5p
dGl6ZSgmZGV2X3ByaXYtPmd0LCB0cnVlKTsKLQogCWVuYWJsZV9ycG1fd2FrZXJlZl9hc3NlcnRz
KCZkZXZfcHJpdi0+cnVudGltZV9wbSk7CiAKIAlyZXR1cm4gcmV0OwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmgKaW5kZXggYTIyZDk2OWNiMzUyLi5iNWRlOGY5MjgzMjAgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuaApAQCAtMTc3OSw3ICsxNzc5LDYgQEAgaW50IGk5MTVfZ2V0cGFyYW1faW9jdGwoc3Ry
dWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIC8qIGk5MTVfZ2VtLmMgKi8KIGludCBp
OTE1X2dlbV9pbml0X3VzZXJwdHIoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsK
IHZvaWQgaTkxNV9nZW1fY2xlYW51cF91c2VycHRyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpk
ZXZfcHJpdik7Ci12b2lkIGk5MTVfZ2VtX3Nhbml0aXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KTsKIHZvaWQgaTkxNV9nZW1faW5pdF9lYXJseShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwogdm9pZCBpOTE1X2dlbV9jbGVhbnVwX2Vhcmx5KHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdik7CiBpbnQgaTkxNV9nZW1fZnJlZXplKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdik7CkBAIC0xODYzLDcgKzE4NjIsNiBAQCBzdGF0aWMgaW5saW5l
IHUzMiBpOTE1X3Jlc2V0X2VuZ2luZV9jb3VudChzdHJ1Y3QgaTkxNV9ncHVfZXJyb3IgKmVycm9y
LAogCXJldHVybiBhdG9taWNfcmVhZCgmZXJyb3ItPnJlc2V0X2VuZ2luZV9jb3VudFtlbmdpbmUt
PnVhYmlfY2xhc3NdKTsKIH0KIAotdm9pZCBpOTE1X2dlbV9pbml0X21taW8oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmk5MTUpOwogaW50IF9fbXVzdF9jaGVjayBpOTE1X2dlbV9pbml0KHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiB2b2lkIGk5MTVfZ2VtX2RyaXZlcl9yZWdp
c3RlcihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSk7CiB2b2lkIGk5MTVfZ2VtX2RyaXZl
cl91bnJlZ2lzdGVyKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbS5jCmluZGV4IGIxNTc0YWIxMDRkNy4uYWMyMzMyMmZiMzgyIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZ2VtLmMKQEAgLTEwMzksMzggKzEwMzksNiBAQCBpOTE1X2dlbV9tYWR2aXNlX2lvY3Rs
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJcmV0dXJuIGVycjsKIH0KIAot
dm9pZCBpOTE1X2dlbV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKLXsK
LQlpbnRlbF93YWtlcmVmX3Qgd2FrZXJlZjsKLQotCUdFTV9UUkFDRSgiXG4iKTsKLQotCXdha2Vy
ZWYgPSBpbnRlbF9ydW50aW1lX3BtX2dldCgmaTkxNS0+cnVudGltZV9wbSk7Ci0JaW50ZWxfdW5j
b3JlX2ZvcmNld2FrZV9nZXQoJmk5MTUtPnVuY29yZSwgRk9SQ0VXQUtFX0FMTCk7Ci0KLQkvKgot
CSAqIEFzIHdlIGhhdmUganVzdCByZXN1bWVkIHRoZSBtYWNoaW5lIGFuZCB3b2tlbiB0aGUgZGV2
aWNlIHVwIGZyb20KLQkgKiBkZWVwIFBDSSBzbGVlcCAocHJlc3VtYWJseSBEM19jb2xkKSwgYXNz
dW1lIHRoZSBIVyBoYXMgYmVlbiByZXNldAotCSAqIGJhY2sgdG8gZGVmYXVsdHMsIHJlY292ZXJp
bmcgZnJvbSB3aGF0ZXZlciB3ZWRnZWQgc3RhdGUgd2UgbGVmdCBpdAotCSAqIGluIGFuZCBzbyB3
b3J0aCB0cnlpbmcgdG8gdXNlIHRoZSBkZXZpY2Ugb25jZSBtb3JlLgotCSAqLwotCWlmIChpbnRl
bF9ndF9pc193ZWRnZWQoJmk5MTUtPmd0KSkKLQkJaW50ZWxfZ3RfdW5zZXRfd2VkZ2VkKCZpOTE1
LT5ndCk7Ci0KLQkvKgotCSAqIElmIHdlIGluaGVyaXQgY29udGV4dCBzdGF0ZSBmcm9tIHRoZSBC
SU9TIG9yIGVhcmxpZXIgb2NjdXBhbnRzCi0JICogb2YgdGhlIEdQVSwgdGhlIEdQVSBtYXkgYmUg
aW4gYW4gaW5jb25zaXN0ZW50IHN0YXRlIHdoZW4gd2UKLQkgKiB0cnkgdG8gdGFrZSBvdmVyLiBU
aGUgb25seSB3YXkgdG8gcmVtb3ZlIHRoZSBlYXJsaWVyIHN0YXRlCi0JICogaXMgYnkgcmVzZXR0
aW5nLiBIb3dldmVyLCByZXNldHRpbmcgb24gZWFybGllciBnZW4gaXMgdHJpY2t5IGFzCi0JICog
aXQgbWF5IGltcGFjdCB0aGUgZGlzcGxheSBhbmQgd2UgYXJlIHVuY2VydGFpbiBhYm91dCB0aGUg
c3RhYmlsaXR5Ci0JICogb2YgdGhlIHJlc2V0LCBzbyB0aGlzIGNvdWxkIGJlIGFwcGxpZWQgdG8g
ZXZlbiBlYXJsaWVyIGdlbi4KLQkgKi8KLQlpbnRlbF9ndF9zYW5pdGl6ZSgmaTkxNS0+Z3QsIGZh
bHNlKTsKLQotCWludGVsX3VuY29yZV9mb3JjZXdha2VfcHV0KCZpOTE1LT51bmNvcmUsIEZPUkNF
V0FLRV9BTEwpOwotCWludGVsX3J1bnRpbWVfcG1fcHV0KCZpOTE1LT5ydW50aW1lX3BtLCB3YWtl
cmVmKTsKLX0KLQogc3RhdGljIGludCBfX2ludGVsX2VuZ2luZXNfcmVjb3JkX2RlZmF1bHRzKHN0
cnVjdCBpbnRlbF9ndCAqZ3QpCiB7CiAJc3RydWN0IGk5MTVfcmVxdWVzdCAqcmVxdWVzdHNbSTkx
NV9OVU1fRU5HSU5FU10gPSB7fTsKQEAgLTE0MTMsMTEgKzEzODEsNiBAQCB2b2lkIGk5MTVfZ2Vt
X2RyaXZlcl9yZWxlYXNlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAlXQVJO
X09OKCFsaXN0X2VtcHR5KCZkZXZfcHJpdi0+Z2VtLmNvbnRleHRzLmxpc3QpKTsKIH0KIAotdm9p
ZCBpOTE1X2dlbV9pbml0X21taW8oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCi17Ci0J
aTkxNV9nZW1fc2FuaXRpemUoaTkxNSk7Ci19Ci0KIHN0YXRpYyB2b2lkIGk5MTVfZ2VtX2luaXRf
X21tKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogewogCXNwaW5fbG9ja19pbml0KCZp
OTE1LT5tbS5vYmpfbG9jayk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaTkxNV9nZW0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dl
bS5jCmluZGV4IGUzNzg1NDNlZDQ1My4uZDgzZjZiZjZkOWQ0IDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0uYwpAQCAtMTI0LDcgKzEyNCw2IEBAIHN0YXRpYyB2b2lk
IHBtX3Jlc3VtZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkgKi8KIAl3aXRoX2lu
dGVsX3J1bnRpbWVfcG0oJmk5MTUtPnJ1bnRpbWVfcG0sIHdha2VyZWYpIHsKIAkJaW50ZWxfZ3Rf
c2FuaXRpemUoJmk5MTUtPmd0LCBmYWxzZSk7Ci0JCWk5MTVfZ2VtX3Nhbml0aXplKGk5MTUpOwog
CiAJCWk5MTVfZ2VtX3Jlc3RvcmVfZ3R0X21hcHBpbmdzKGk5MTUpOwogCQlpOTE1X2dlbV9yZXN0
b3JlX2ZlbmNlcygmaTkxNS0+Z2d0dCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9zZWxmdGVzdHMvbW9ja19nZW1fZGV2aWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvbW9ja19nZW1fZGV2aWNlLmMKaW5kZXggYTBkYTU5NDRkZDMzLi4yN2VkM2NlZTZhOWIg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dlbV9kZXZp
Y2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19nZW1fZGV2aWNl
LmMKQEAgLTE4Myw3ICsxODMsNiBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqbW9ja19nZW1f
ZGV2aWNlKHZvaWQpCiAJaW50ZWxfdGltZWxpbmVzX2luaXQoaTkxNSk7CiAKIAltb2NrX2luaXRf
Z2d0dChpOTE1LCAmaTkxNS0+Z2d0dCk7Ci0JaTkxNS0+Z3QuZ2d0dCA9ICZpOTE1LT5nZ3R0Owog
CiAJbWt3cml0ZV9kZXZpY2VfaW5mbyhpOTE1KS0+ZW5naW5lX21hc2sgPSBCSVQoMCk7CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2d0dC5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL21vY2tfZ3R0LmMKaW5kZXggOWVjOTNkYzI3ZmI1
Li4yMGFjMzg0NGVkZWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9tb2NrX2d0dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2d0
dC5jCkBAIC0xMTgsOCArMTE4LDcgQEAgdm9pZCBtb2NrX2luaXRfZ2d0dChzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IGk5MTVfZ2d0dCAqZ2d0dCkKIAlnZ3R0LT52bS52bWFf
b3BzLmNsZWFyX3BhZ2VzID0gY2xlYXJfcGFnZXM7CiAKIAlpOTE1X2FkZHJlc3Nfc3BhY2VfaW5p
dCgmZ2d0dC0+dm0sIFZNX0NMQVNTX0dHVFQpOwotCi0JaW50ZWxfZ3RfaW5pdF9od19lYXJseShp
OTE1KTsKKwlpOTE1LT5ndC5nZ3R0ID0gZ2d0dDsKIH0KIAogdm9pZCBtb2NrX2ZpbmlfZ2d0dChz
dHJ1Y3QgaTkxNV9nZ3R0ICpnZ3R0KQotLSAKMi4yNC4wLnJjMQoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRl
bC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

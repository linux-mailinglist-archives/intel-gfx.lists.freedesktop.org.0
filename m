Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 410B94EEBD
	for <lists+intel-gfx@lfdr.de>; Fri, 21 Jun 2019 20:21:51 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8C5BA6E90F;
	Fri, 21 Jun 2019 18:21:49 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga02.intel.com (mga02.intel.com [134.134.136.20])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CBC0E6E90F
 for <intel-gfx@lists.freedesktop.org>; Fri, 21 Jun 2019 18:21:48 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by orsmga101.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 21 Jun 2019 11:21:48 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,401,1557212400"; d="scan'208";a="154532082"
Received: from dceraolo-linux.fm.intel.com ([10.1.27.145])
 by orsmga008.jf.intel.com with ESMTP; 21 Jun 2019 11:21:48 -0700
From: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 21 Jun 2019 11:21:22 -0700
Message-Id: <20190621182123.31368-1-daniele.ceraolospurio@intel.com>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2 1/2] drm/i915/guc: reorder enable/disable
 communication steps
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

TWFrZSBzdXJlIHdlIGFsd2F5cyBoYXZlIENUIGJ1ZmZlcnMgZW5hYmxlZCB3aGVuIHRoZSBpbnRl
cnJ1cHRzIGFyZQplbmFibGVkLCBzbyB3ZSBjYW4gYWx3YXlzIGhhbmRsZSBpbnRlcnJ1cHRzIGZy
b20gR3VDLiBBbHNvIG1vdmUgdGhlCnNldHRpbmcgb2YgdGhlIGd1Yy0+c2VuZCBhbmQgZ3VjLT5o
YW5kbGVyIGZ1bmN0aW9ucyB0byB0aGUgR3VDCmNvbW11bmljYXRpb24gY29udHJvbCBmdW5jdGlv
bnMgZm9yIGNvbnNpc3RlbmN5LgoKVGhlIHJlb3JkZXIgYWxzbyBmaXhlcyB0aGUgb25pb24gdW53
aW5kaW5nIG9mIGludGVsX3VjX2luaXRfaHcsIGJlY2F1c2UKZ3VjX2VuYWJsZV9jb21tdW5pY2F0
aW9uIHdvdWxkJ3ZlIGxlZnQgaW50ZXJydXB0cyBlbmFibGVkIHdoZW4gZmFpbGluZwp0byBlbmFi
bGUgQ1RCLgoKdjI6IGFsd2F5cyByZXR1bnIgdGhlIHJlc3VsdCBvZiBjdGNoX2VuYWJsZSgpIGlu
CiAgICBpbnRlbF9ndWNfY3RfZW5hYmxlKCkgKE1pY2hhbCkKCkJ1Z3ppbGxhOiBodHRwczovL2J1
Z3MuZnJlZWRlc2t0b3Aub3JnL3Nob3dfYnVnLmNnaT9pZD0xMTA5NDMKU2lnbmVkLW9mZi1ieTog
RGFuaWVsZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5jZXJhb2xvc3B1cmlvQGludGVsLmNvbT4K
Q2M6IENocmlzIFdpbHNvbiA8Y2hyaXNAY2hyaXMtd2lsc29uLmNvLnVrPgpDYzogTWljaGFsIFdh
amRlY3prbyA8bWljaGFsLndhamRlY3prb0BpbnRlbC5jb20+ClJldmlld2VkLWJ5OiBNYXR0aGV3
IEJyb3N0IDxtYXR0aGV3LmJyb3N0QGludGVsLmNvbT4KUmV2aWV3ZWQtYnk6IE1pY2hhbCBXYWpk
ZWN6a28gPG1pY2hhbC53YWpkZWN6a29AaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9p
OTE1L2ludGVsX2d1Y19jdC5jIHwgMjIgKysrKy0tLS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2N0LmggfCAgNCArKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9pbnRlbF91Yy5jICAgICB8IDE5ICsrKysrKysrKysrKysrKystLS0KIDMgZmlsZXMgY2hhbmdl
ZCwgMjQgaW5zZXJ0aW9ucygrKSwgMjEgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2N0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9ndWNfY3QuYwppbmRleCAzOTIxODA5ZjgxMmIuLjllMzgzYTQ3NjA5ZiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2N0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaW50ZWxfZ3VjX2N0LmMKQEAgLTUyOSw4ICs1MjksOCBAQCBzdGF0aWMgaW50IGN0Y2hf
c2VuZChzdHJ1Y3QgaW50ZWxfZ3VjX2N0ICpjdCwKIC8qCiAgKiBDb21tYW5kIFRyYW5zcG9ydCAo
Q1QpIGJ1ZmZlciBiYXNlZCBHdUMgc2VuZCBmdW5jdGlvbi4KICAqLwotc3RhdGljIGludCBpbnRl
bF9ndWNfc2VuZF9jdChzdHJ1Y3QgaW50ZWxfZ3VjICpndWMsIGNvbnN0IHUzMiAqYWN0aW9uLCB1
MzIgbGVuLAotCQkJICAgICB1MzIgKnJlc3BvbnNlX2J1ZiwgdTMyIHJlc3BvbnNlX2J1Zl9zaXpl
KQoraW50IGludGVsX2d1Y19zZW5kX2N0KHN0cnVjdCBpbnRlbF9ndWMgKmd1YywgY29uc3QgdTMy
ICphY3Rpb24sIHUzMiBsZW4sCisJCSAgICAgIHUzMiAqcmVzcG9uc2VfYnVmLCB1MzIgcmVzcG9u
c2VfYnVmX3NpemUpCiB7CiAJc3RydWN0IGludGVsX2d1Y19jdCAqY3QgPSAmZ3VjLT5jdDsKIAlz
dHJ1Y3QgaW50ZWxfZ3VjX2N0X2NoYW5uZWwgKmN0Y2ggPSAmY3QtPmhvc3RfY2hhbm5lbDsKQEAg
LTgzNCw3ICs4MzQsNyBAQCBzdGF0aWMgdm9pZCBjdF9wcm9jZXNzX2hvc3RfY2hhbm5lbChzdHJ1
Y3QgaW50ZWxfZ3VjX2N0ICpjdCkKICAqIFdoZW4gd2UncmUgY29tbXVuaWNhdGluZyB3aXRoIHRo
ZSBHdUMgb3ZlciBDVCwgR3VDIHVzZXMgZXZlbnRzCiAgKiB0byBub3RpZnkgdXMgYWJvdXQgbmV3
IG1lc3NhZ2VzIGJlaW5nIHBvc3RlZCBvbiB0aGUgUkVDViBidWZmZXIuCiAgKi8KLXN0YXRpYyB2
b2lkIGludGVsX2d1Y190b19ob3N0X2V2ZW50X2hhbmRsZXJfY3Qoc3RydWN0IGludGVsX2d1YyAq
Z3VjKQordm9pZCBpbnRlbF9ndWNfdG9faG9zdF9ldmVudF9oYW5kbGVyX2N0KHN0cnVjdCBpbnRl
bF9ndWMgKmd1YykKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3VjX2N0ICpjdCA9ICZndWMtPmN0OwogCkBA
IC04OTIsMjAgKzg5MiwxMSBAQCBpbnQgaW50ZWxfZ3VjX2N0X2VuYWJsZShzdHJ1Y3QgaW50ZWxf
Z3VjX2N0ICpjdCkKIHsKIAlzdHJ1Y3QgaW50ZWxfZ3VjICpndWMgPSBjdF90b19ndWMoY3QpOwog
CXN0cnVjdCBpbnRlbF9ndWNfY3RfY2hhbm5lbCAqY3RjaCA9ICZjdC0+aG9zdF9jaGFubmVsOwot
CWludCBlcnI7CiAKIAlpZiAoY3RjaC0+ZW5hYmxlZCkKIAkJcmV0dXJuIDA7CiAKLQllcnIgPSBj
dGNoX2VuYWJsZShndWMsIGN0Y2gpOwotCWlmICh1bmxpa2VseShlcnIpKQotCQlyZXR1cm4gZXJy
OwotCi0JLyogU3dpdGNoIGludG8gY21kIHRyYW5zcG9ydCBidWZmZXIgYmFzZWQgc2VuZCgpICov
Ci0JZ3VjLT5zZW5kID0gaW50ZWxfZ3VjX3NlbmRfY3Q7Ci0JZ3VjLT5oYW5kbGVyID0gaW50ZWxf
Z3VjX3RvX2hvc3RfZXZlbnRfaGFuZGxlcl9jdDsKLQlEUk1fSU5GTygiQ1Q6ICVzXG4iLCBlbmFi
bGVkZGlzYWJsZWQodHJ1ZSkpOwotCXJldHVybiAwOworCXJldHVybiBjdGNoX2VuYWJsZShndWMs
IGN0Y2gpOwogfQogCiAvKioKQEAgLTkyMSw5ICs5MTIsNCBAQCB2b2lkIGludGVsX2d1Y19jdF9k
aXNhYmxlKHN0cnVjdCBpbnRlbF9ndWNfY3QgKmN0KQogCQlyZXR1cm47CiAKIAljdGNoX2Rpc2Fi
bGUoZ3VjLCBjdGNoKTsKLQotCS8qIERpc2FibGUgc2VuZCAqLwotCWd1Yy0+c2VuZCA9IGludGVs
X2d1Y19zZW5kX25vcDsKLQlndWMtPmhhbmRsZXIgPSBpbnRlbF9ndWNfdG9faG9zdF9ldmVudF9o
YW5kbGVyX25vcDsKLQlEUk1fSU5GTygiQ1Q6ICVzXG4iLCBlbmFibGVkZGlzYWJsZWQoZmFsc2Up
KTsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19jdC5oIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZ3VjX2N0LmgKaW5kZXggNDFiYTU5M2E0ZGY3Li4w
ZWMxNzQ5M2Q4M2IgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19j
dC5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2d1Y19jdC5oCkBAIC0xMDEsNCAr
MTAxLDggQEAgc3RhdGljIGlubGluZSB2b2lkIGludGVsX2d1Y19jdF9zdG9wKHN0cnVjdCBpbnRl
bF9ndWNfY3QgKmN0KQogCWN0LT5ob3N0X2NoYW5uZWwuZW5hYmxlZCA9IGZhbHNlOwogfQogCitp
bnQgaW50ZWxfZ3VjX3NlbmRfY3Qoc3RydWN0IGludGVsX2d1YyAqZ3VjLCBjb25zdCB1MzIgKmFj
dGlvbiwgdTMyIGxlbiwKKwkJICAgICAgdTMyICpyZXNwb25zZV9idWYsIHUzMiByZXNwb25zZV9i
dWZfc2l6ZSk7Cit2b2lkIGludGVsX2d1Y190b19ob3N0X2V2ZW50X2hhbmRsZXJfY3Qoc3RydWN0
IGludGVsX2d1YyAqZ3VjKTsKKwogI2VuZGlmIC8qIF9JTlRFTF9HVUNfQ1RfSF8gKi8KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3VjLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF91Yy5jCmluZGV4IGFlNDU2NTFhYzczYy4uYzdmODJjOTQ0ZGQ2IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF91Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX3VjLmMKQEAgLTIzNSw5ICsyMzUsMjAgQEAgc3RhdGljIHZvaWQgZ3VjX2Rp
c2FibGVfaW50ZXJydXB0cyhzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiAKIHN0YXRpYyBpbnQgZ3Vj
X2VuYWJsZV9jb21tdW5pY2F0aW9uKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIHsKKwlpbnQgcmV0
OworCisJcmV0ID0gaW50ZWxfZ3VjX2N0X2VuYWJsZSgmZ3VjLT5jdCk7CisJaWYgKHJldCkKKwkJ
cmV0dXJuIHJldDsKKworCWd1Yy0+c2VuZCA9IGludGVsX2d1Y19zZW5kX2N0OworCWd1Yy0+aGFu
ZGxlciA9IGludGVsX2d1Y190b19ob3N0X2V2ZW50X2hhbmRsZXJfY3Q7CisKIAlndWNfZW5hYmxl
X2ludGVycnVwdHMoZ3VjKTsKIAotCXJldHVybiBpbnRlbF9ndWNfY3RfZW5hYmxlKCZndWMtPmN0
KTsKKwlEUk1fSU5GTygiR3VDIGNvbW11bmljYXRpb24gZW5hYmxlZFxuIik7CisKKwlyZXR1cm4g
MDsKIH0KIAogc3RhdGljIHZvaWQgZ3VjX3N0b3BfY29tbXVuaWNhdGlvbihzdHJ1Y3QgaW50ZWxf
Z3VjICpndWMpCkBAIC0yNTAsMTIgKzI2MSwxNCBAQCBzdGF0aWMgdm9pZCBndWNfc3RvcF9jb21t
dW5pY2F0aW9uKHN0cnVjdCBpbnRlbF9ndWMgKmd1YykKIAogc3RhdGljIHZvaWQgZ3VjX2Rpc2Fi
bGVfY29tbXVuaWNhdGlvbihzdHJ1Y3QgaW50ZWxfZ3VjICpndWMpCiB7Ci0JaW50ZWxfZ3VjX2N0
X2Rpc2FibGUoJmd1Yy0+Y3QpOwotCiAJZ3VjX2Rpc2FibGVfaW50ZXJydXB0cyhndWMpOwogCiAJ
Z3VjLT5zZW5kID0gaW50ZWxfZ3VjX3NlbmRfbm9wOwogCWd1Yy0+aGFuZGxlciA9IGludGVsX2d1
Y190b19ob3N0X2V2ZW50X2hhbmRsZXJfbm9wOworCisJaW50ZWxfZ3VjX2N0X2Rpc2FibGUoJmd1
Yy0+Y3QpOworCisJRFJNX0lORk8oIkd1QyBjb21tdW5pY2F0aW9uIGRpc2FibGVkXG4iKTsKIH0K
IAogaW50IGludGVsX3VjX2luaXRfbWlzYyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkK
LS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

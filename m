Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C7A6F34B2E
	for <lists+intel-gfx@lfdr.de>; Tue,  4 Jun 2019 16:59:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3EC1889949;
	Tue,  4 Jun 2019 14:59:33 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C6C2D89949
 for <intel-gfx@lists.freedesktop.org>; Tue,  4 Jun 2019 14:59:31 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 04 Jun 2019 07:59:31 -0700
X-ExtLoop1: 1
Received: from ideak-desk.fi.intel.com ([10.237.72.204])
 by orsmga003.jf.intel.com with ESMTP; 04 Jun 2019 07:59:30 -0700
From: Imre Deak <imre.deak@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue,  4 Jun 2019 17:58:14 +0300
Message-Id: <20190604145826.16424-12-imre.deak@intel.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190604145826.16424-1-imre.deak@intel.com>
References: <20190604145826.16424-1-imre.deak@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 11/23] drm/i915: Handle the TCCOLD power-down
 event
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QmFzZWQgb24gYSByZWNlbnQgQlNwZWMgdXBkYXRlIChJbmRleC8yMTc1MCkgd2UgbXVzdCBoYW5k
bGUgdGhlIFRDQ09MRApldmVudCBhc3NvY2lhdGVkIHdpdGggdGhlIERQLWFsdCBtb2RlLiBXZSBj
YW4gZGV0ZWN0IHRoaXMgZXZlbnQgYnkKcmVhZGluZyBhbiBpbnZhbGlkIGFsbC0xcyB2YWx1ZSBm
cm9tIEZJQSByZWdpc3RlcnMuCgpBZnRlciBkZXRlY3RpbmcgVENDT0xEIHdlIHdpbGw6Ci0gZmFs
bCBiYWNrIHRvIFRCVC1hbHQgbW9kZSB3aGVuIGF0dGVtcHRpbmcgdG8gc3dpdGNoIHRvIERQLWFs
dCBtb2RlCi0gY29uY2x1ZGUgdGhhdCBub3RoaW5nIGlzIGNvbm5lY3RlZCBkdXJpbmcgbGl2ZSBz
dGF0dXMgZGV0ZWN0aW9uCi0gV0FSTiB3aGVuIGFscmVhZHkgaW4gdW5zYWZlIG1vZGUsIHNpbmNl
IHRoZW4gVENDT0xEIGlzIHVuZXhwZWN0ZWQKCkNjOiBKb3PDqSBSb2JlcnRvIGRlIFNvdXphIDxq
b3NlLnNvdXphQGludGVsLmNvbT4KQ2M6IFJvZHJpZ28gVml2aSA8cm9kcmlnby52aXZpQGludGVs
LmNvbT4KQ2M6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3lyamFsYUBsaW51eC5pbnRlbC5jb20+
ClNpZ25lZC1vZmYtYnk6IEltcmUgRGVhayA8aW1yZS5kZWFrQGludGVsLmNvbT4KLS0tCiBkcml2
ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF90Yy5jIHwgMjMgKysrKysrKysrKysrKysrKysrKysrLS0K
IDEgZmlsZSBjaGFuZ2VkLCAyMSBpbnNlcnRpb25zKCspLCAyIGRlbGV0aW9ucygtKQoKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3RjLmMgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF90Yy5jCmluZGV4IDg0ZTBjMDY4NzdlYy4uZDkxMzgxYzBlODdkIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF90Yy5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX3RjLmMKQEAgLTQ5LDYgKzQ5LDggQEAgdTMyIGludGVsX3RjX3BvcnRfZ2V0
X2xhbmVfaW5mbyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkKIAllbnVtIHRj
X3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoZGV2X3ByaXYsIGRpZ19wb3J0LT5iYXNl
LnBvcnQpOwogCXUzMiBsYW5lX2luZm8gPSBJOTE1X1JFQUQoUE9SVF9UWF9ERkxFWERQU1ApOwog
CisJV0FSTl9PTihsYW5lX2luZm8gPT0gLTEpOworCiAJcmV0dXJuIChsYW5lX2luZm8gJiBEUF9M
QU5FX0FTU0lHTk1FTlRfTUFTSyh0Y19wb3J0KSkgPj4KIAkgICAgICAgRFBfTEFORV9BU1NJR05N
RU5UX1NISUZUKHRjX3BvcnQpOwogfQpAQCAtMTA3LDYgKzEwOSwxMiBAQCBzdGF0aWMgdTMyIHRj
X3BvcnRfbGl2ZV9zdGF0dXNfbWFzayhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9y
dCkKIAl1MzIgdmFsID0gSTkxNV9SRUFEKFBPUlRfVFhfREZMRVhEUFNQKTsKIAl1MzIgbWFzayA9
IDA7CiAKKwlpZiAodmFsID09IC0xKSB7CisJCURSTV9ERUJVR19EUklWRVIoIlBvcnQgJXM6IFBI
WSBpbiBUQ0NPTEQsIG5vdGhpbmcgY29ubmVjdGVkXG4iLAorCQkJCSB0Y19wb3J0X25hbWUoZGV2
X3ByaXYsIHRjX3BvcnQpKTsKKwkJcmV0dXJuIG1hc2s7CisJfQorCiAJaWYgKHZhbCAmIFRDX0xJ
VkVfU1RBVEVfVEJUKHRjX3BvcnQpKQogCQltYXNrIHw9IEJJVChUQ19QT1JUX1RCVF9BTFQpOwog
CWlmICh2YWwgJiBUQ19MSVZFX1NUQVRFX1RDKHRjX3BvcnQpKQpAQCAtMTMxLDEzICsxMzksMjEg
QEAgc3RhdGljIGJvb2wgaWNsX3RjX3BoeV9zdGF0dXNfY29tcGxldGUoc3RydWN0IGludGVsX2Rp
Z2l0YWxfcG9ydCAqZGlnX3BvcnQpCiAJICAgICAgIERQX1BIWV9NT0RFX1NUQVRVU19DT01QTEVU
RUQodGNfcG9ydCk7CiB9CiAKLXN0YXRpYyB2b2lkIGljbF90Y19waHlfc2V0X3NhZmVfbW9kZShz
dHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwKK3N0YXRpYyBib29sIGljbF90Y19w
aHlfc2V0X3NhZmVfbW9kZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwKIAkJ
CQkgICAgIGJvb2wgZW5hYmxlKQogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwogCWVudW0gdGNfcG9ydCB0Y19w
b3J0ID0gaW50ZWxfcG9ydF90b190YyhkZXZfcHJpdiwgZGlnX3BvcnQtPmJhc2UucG9ydCk7CiAJ
dTMyIHZhbCA9IEk5MTVfUkVBRChQT1JUX1RYX0RGTEVYRFBDU1NTKTsKIAorCWlmICh2YWwgPT0g
LTEpIHsKKwkJRFJNX0RFQlVHX0RSSVZFUigiUG9ydCAlczogUEhZIGluIFRDQ09MRCwgY2FuJ3Qg
c2V0IHNhZmUtbW9kZSB0byAlc1xuIiwKKwkJCQkgdGNfcG9ydF9uYW1lKGRldl9wcml2LCB0Y19w
b3J0KSwKKwkJCQkgZW5hYmxlZGRpc2FibGVkKGVuYWJsZSkpOworCisJCXJldHVybiBmYWxzZTsK
Kwl9CisKIAl2YWwgJj0gfkRQX1BIWV9NT0RFX1NUQVRVU19OT1RfU0FGRSh0Y19wb3J0KTsKIAlp
ZiAoIWVuYWJsZSkKIAkJdmFsIHw9IERQX1BIWV9NT0RFX1NUQVRVU19OT1RfU0FGRSh0Y19wb3J0
KTsKQEAgLTE0Nyw2ICsxNjMsOCBAQCBzdGF0aWMgdm9pZCBpY2xfdGNfcGh5X3NldF9zYWZlX21v
ZGUoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQsCiAJaWYgKGVuYWJsZSAmJiB3
YWl0X2ZvcighaWNsX3RjX3BoeV9zdGF0dXNfY29tcGxldGUoZGlnX3BvcnQpLCAxMCkpCiAJCURS
TV9ERUJVR19EUklWRVIoIlBvcnQgJXM6IFBIWSBjb21wbGV0ZSBjbGVhciB0aW1lZCBvdXRcbiIs
CiAJCQkJIHRjX3BvcnRfbmFtZShkZXZfcHJpdiwgdGNfcG9ydCkpOworCisJcmV0dXJuIHRydWU7
CiB9CiAKIC8qCkBAIC0xODcsNyArMjA1LDggQEAgc3RhdGljIGJvb2wgaWNsX3RjX3BoeV9jb25u
ZWN0KHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQogCQlyZXR1cm4gZmFsc2U7
CiAJfQogCi0JaWNsX3RjX3BoeV9zZXRfc2FmZV9tb2RlKGRpZ19wb3J0LCBmYWxzZSk7CisJaWYg
KCFpY2xfdGNfcGh5X3NldF9zYWZlX21vZGUoZGlnX3BvcnQsIGZhbHNlKSkKKwkJcmV0dXJuIGZh
bHNlOwogCiAJaWYgKGRpZ19wb3J0LT50Y19tb2RlID09IFRDX1BPUlRfTEVHQUNZKQogCQlyZXR1
cm4gdHJ1ZTsKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
aW50ZWwtZ2Z4

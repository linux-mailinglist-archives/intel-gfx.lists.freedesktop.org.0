Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 94FA010D634
	for <lists+intel-gfx@lfdr.de>; Fri, 29 Nov 2019 14:40:27 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A5F286E904;
	Fri, 29 Nov 2019 13:40:25 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EA9916E904
 for <intel-gfx@lists.freedesktop.org>; Fri, 29 Nov 2019 13:40:17 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga004.fm.intel.com ([10.253.24.48])
 by fmsmga104.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 29 Nov 2019 05:40:17 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,257,1571727600"; d="scan'208";a="234712589"
Received: from slisovsk-lenovo-ideapad-720s-13ikb.fi.intel.com ([10.237.72.89])
 by fmsmga004.fm.intel.com with ESMTP; 29 Nov 2019 05:40:15 -0800
From: Stanislav Lisovskiy <stanislav.lisovskiy@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 29 Nov 2019 15:37:09 +0200
Message-Id: <20191129133709.24397-5-stanislav.lisovskiy@intel.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191129133709.24397-1-stanislav.lisovskiy@intel.com>
References: <20191129133709.24397-1-stanislav.lisovskiy@intel.com>
Subject: [Intel-gfx] [PATCH v7 4/4] drm/i915: Correctly map DBUF slices to
 pipes
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QWRkZWQgcHJvcGVyIERCdWYgc2xpY2UgbWFwcGluZyB0byBjb3JyZXNwb25kZW50CnBpcGVzLCBk
ZXBlbmRpbmcgb24gcGlwZSBjb25maWd1cmF0aW9uIGFzIHN0YXRlZAppbiBCU3BlYy4KCnYyOgog
ICAgLSBSZW1vdmUgdW5uZWVkZWQgYnJhY2VzCiAgICAtIFN0b3AgdXNpbmcgbWFjcm8gZm9yIERC
dWYgYXNzaWdubWVudHMgYXMKICAgICAgaXQgc2VlbXMgdG8gcmVkdWNlIHJlYWRhYmlsaXR5LgoK
djM6IFN0YXJ0IHVzaW5nIGVuYWJsZWQgc2xpY2VzIG1hc2sgaW4gZGV2X3ByaXYKClNpZ25lZC1v
ZmYtYnk6IFN0YW5pc2xhdiBMaXNvdnNraXkgPHN0YW5pc2xhdi5saXNvdnNraXlAaW50ZWwuY29t
PgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMgfCAyMjYgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrLS0KIDEgZmlsZSBjaGFuZ2VkLCAyMTYgaW5zZXJ0aW9ucygrKSwg
MTAgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxf
cG0uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKaW5kZXggOGIyYTE0OTU0NTRj
Li5mMzZiMTU0NWQ5YWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3Bt
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwpAQCAtMzgxNSwxMyArMzgx
NSwzMCBAQCBib29sIGludGVsX2Nhbl9lbmFibGVfc2FndihzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSkKIAlyZXR1cm4gdHJ1ZTsKIH0KIAorLyoKKyAqIENhbGN1bGF0ZSBpbml0aWFs
IERCdWYgc2xpY2Ugb2Zmc2V0LCBiYXNlZCBvbiBzbGljZSBzaXplCisgKiBhbmQgbWFzayhpLmUg
aWYgc2xpY2Ugc2l6ZSBpcyAxMDI0IGFuZCBzZWNvbmQgc2xpY2UgaXMgZW5hYmxlZAorICogb2Zm
c2V0IHdvdWxkIGJlIDEwMjQpCisgKi8KK3N0YXRpYyB1MzIgaWNsX2dldF9maXJzdF9kYnVmX3Ns
aWNlX29mZnNldCh1MzIgZGJ1Zl9zbGljZV9tYXNrLAorCQkJCQkgICB1MzIgc2xpY2Vfc2l6ZSwg
dTMyIGRkYl9zaXplKQoreworCXUzMiBvZmZzZXQgPSAwOworCisJaWYgKCFkYnVmX3NsaWNlX21h
c2spCisJCXJldHVybiAwOworCisJb2Zmc2V0ID0gKGZmcyhkYnVmX3NsaWNlX21hc2spIC0gMSkg
KiBzbGljZV9zaXplOworCisJV0FSTl9PTihvZmZzZXQgPj0gZGRiX3NpemUpOworCXJldHVybiBv
ZmZzZXQ7Cit9CisKIHN0YXRpYyB1MTYgaW50ZWxfZ2V0X2RkYl9zaXplKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpjcnRjX3N0YXRlLAogCQkJICAgICAgY29uc3QgdTY0IHRvdGFsX2RhdGFfcmF0ZSwKIAkJ
CSAgICAgIGNvbnN0IGludCBudW1fYWN0aXZlKQogewotCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRl
ICpzdGF0ZSA9IGNydGNfc3RhdGUtPnVhcGkuc3RhdGU7Ci0Jc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqaW50ZWxfc3RhdGUgPSB0b19pbnRlbF9hdG9taWNfc3RhdGUoc3RhdGUpOwogCXUxNiBk
ZGJfc2l6ZSA9IElOVEVMX0lORk8oZGV2X3ByaXYpLT5kZGJfc2l6ZTsKIAogCVdBUk5fT04oZGRi
X3NpemUgPT0gMCk7CkBAIC0zODI5LDEyICszODQ2LDEzIEBAIHN0YXRpYyB1MTYgaW50ZWxfZ2V0
X2RkYl9zaXplKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAlpZiAoSU5URUxf
R0VOKGRldl9wcml2KSA8IDExKQogCQlyZXR1cm4gZGRiX3NpemUgLSA0OyAvKiA0IGJsb2NrcyBm
b3IgYnlwYXNzIHBhdGggYWxsb2NhdGlvbiAqLwogCi0JaW50ZWxfc3RhdGUtPmVuYWJsZWRfc2xp
Y2VzID0gREJVRl9TMV9CSVQ7Ci0JZGRiX3NpemUgLz0gMjsKLQogCXJldHVybiBkZGJfc2l6ZTsK
IH0KIAordTMyIGk5MTVfcG9zc2libGVfZGJ1Zl9zbGljZXMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAorCQkJICAgICAgaW50IHBpcGUsIHUzMiBhY3RpdmVfcGlwZXMsCisJCQkg
ICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7CisKIHN0YXRp
YyB2b2lkCiBza2xfZGRiX2dldF9waXBlX2FsbG9jYXRpb25fbGltaXRzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiwKIAkJCQkgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKQEAgLTM4NDksNyArMzg2NywxNCBAQCBza2xfZGRiX2dldF9waXBlX2Fs
bG9jYXRpb25fbGltaXRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAl1MzIg
cGlwZV93aWR0aCA9IDAsIHRvdGFsX3dpZHRoID0gMCwgd2lkdGhfYmVmb3JlX3BpcGUgPSAwOwog
CWVudW0gcGlwZSBmb3JfcGlwZSA9IHRvX2ludGVsX2NydGMoZm9yX2NydGMpLT5waXBlOwogCXUx
NiBkZGJfc2l6ZTsKKwl1MzIgZGRiX3JhbmdlX3NpemU7CiAJdTMyIGk7CisJdTMyIGRidWZfc2xp
Y2VfbWFzazsKKwl1MzIgYWN0aXZlX3BpcGVzOworCXUzMiBvZmZzZXQ7CisJdTMyIHNsaWNlX3Np
emU7CisJdTMyIHRvdGFsX3NsaWNlX21hc2s7CisJdTMyIHN0YXJ0LCBlbmQ7CiAKIAlpZiAoV0FS
Tl9PTighc3RhdGUpIHx8ICFjcnRjX3N0YXRlLT5ody5hY3RpdmUpIHsKIAkJYWxsb2MtPnN0YXJ0
ID0gMDsKQEAgLTM4NTgsMTQgKzM4ODMsMTkgQEAgc2tsX2RkYl9nZXRfcGlwZV9hbGxvY2F0aW9u
X2xpbWl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCiAJCXJldHVybjsKIAl9
CiAKLQlpZiAoaW50ZWxfc3RhdGUtPmFjdGl2ZV9waXBlX2NoYW5nZXMpCisJaWYgKGludGVsX3N0
YXRlLT5hY3RpdmVfcGlwZV9jaGFuZ2VzKSB7CiAJCSpudW1fYWN0aXZlID0gaHdlaWdodDgoaW50
ZWxfc3RhdGUtPmFjdGl2ZV9waXBlcyk7Ci0JZWxzZQorCQlhY3RpdmVfcGlwZXMgPSBpbnRlbF9z
dGF0ZS0+YWN0aXZlX3BpcGVzOworCX0gZWxzZSB7CiAJCSpudW1fYWN0aXZlID0gaHdlaWdodDgo
ZGV2X3ByaXYtPmFjdGl2ZV9waXBlcyk7CisJCWFjdGl2ZV9waXBlcyA9IGRldl9wcml2LT5hY3Rp
dmVfcGlwZXM7CisJfQogCiAJZGRiX3NpemUgPSBpbnRlbF9nZXRfZGRiX3NpemUoZGV2X3ByaXYs
IGNydGNfc3RhdGUsIHRvdGFsX2RhdGFfcmF0ZSwKIAkJCQkgICAgICAqbnVtX2FjdGl2ZSk7CiAK
KwlzbGljZV9zaXplID0gZGRiX3NpemUgLyBJTlRFTF9JTkZPKGRldl9wcml2KS0+bnVtX3N1cHBv
cnRlZF9kYnVmX3NsaWNlczsKKwogCS8qCiAJICogSWYgdGhlIHN0YXRlIGRvZXNuJ3QgY2hhbmdl
IHRoZSBhY3RpdmUgQ1JUQydzIG9yIHRoZXJlIGlzIG5vCiAJICogbW9kZXNldCByZXF1ZXN0LCB0
aGVuIHRoZXJlJ3Mgbm8gbmVlZCB0byByZWNhbGN1bGF0ZTsKQEAgLTM4ODMsMTggKzM5MTMsNjgg
QEAgc2tsX2RkYl9nZXRfcGlwZV9hbGxvY2F0aW9uX2xpbWl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsCiAJCXJldHVybjsKIAl9CiAKKwkvKgorCSAqIEdldCBhbGxvd2VkIERC
dWYgc2xpY2VzIGZvciBjb3JyZXNwb25kZW50IHBpcGUgYW5kIHBsYXRmb3JtLgorCSAqLworCWRi
dWZfc2xpY2VfbWFzayA9IGk5MTVfcG9zc2libGVfZGJ1Zl9zbGljZXMoZGV2X3ByaXYsIGZvcl9w
aXBlLAorCQkJCQkJICAgIGFjdGl2ZV9waXBlcywgY3J0Y19zdGF0ZSk7CisKKwlEUk1fREVCVUdf
S01TKCJEQnVmIHNsaWNlIG1hc2sgJXggcGlwZSAlZCBhY3RpdmUgcGlwZXMgJXhcbiIsCisJCSAg
ICAgIGRidWZfc2xpY2VfbWFzaywKKwkJICAgICAgZm9yX3BpcGUsIGFjdGl2ZV9waXBlcyk7CisK
KwkvKgorCSAqIEZpZ3VyZSBvdXQgYXQgd2hpY2ggREJ1ZiBzbGljZSB3ZSBzdGFydCwgaS5lIGlm
IHdlIHN0YXJ0IGF0IERidWYgUzIKKwkgKiBhbmQgc2xpY2Ugc2l6ZSBpcyAxMDI0LCB0aGUgb2Zm
c2V0IHdvdWxkIGJlIDEwMjQKKwkgKi8KKwlvZmZzZXQgPSBpY2xfZ2V0X2ZpcnN0X2RidWZfc2xp
Y2Vfb2Zmc2V0KGRidWZfc2xpY2VfbWFzaywKKwkJCQkJCSBzbGljZV9zaXplLCBkZGJfc2l6ZSk7
CisKKwkvKgorCSAqIEZpZ3VyZSBvdXQgdG90YWwgc2l6ZSBvZiBhbGxvd2VkIERCdWYgc2xpY2Vz
LCB3aGljaCBpcyBiYXNpY2FsbHkKKwkgKiBhIG51bWJlciBvZiBhbGxvd2VkIHNsaWNlcyBmb3Ig
dGhhdCBwaXBlIG11bHRpcGxpZWQgYnkgc2xpY2Ugc2l6ZS4KKwkgKiBJbnNpZGUgb2YgdGhpcwor
CSAqIHJhbmdlIGRkYiBlbnRyaWVzIGFyZSBzdGlsbCBhbGxvY2F0ZWQgaW4gcHJvcG9ydGlvbiB0
byBkaXNwbGF5IHdpZHRoLgorCSAqLworCWRkYl9yYW5nZV9zaXplID0gaHdlaWdodDgoZGJ1Zl9z
bGljZV9tYXNrKSAqIHNsaWNlX3NpemU7CisKIAkvKgogCSAqIFdhdGVybWFyay9kZGIgcmVxdWly
ZW1lbnQgaGlnaGx5IGRlcGVuZHMgdXBvbiB3aWR0aCBvZiB0aGUKIAkgKiBmcmFtZWJ1ZmZlciwg
U28gaW5zdGVhZCBvZiBhbGxvY2F0aW5nIEREQiBlcXVhbGx5IGFtb25nIHBpcGVzCiAJICogZGlz
dHJpYnV0ZSBEREIgYmFzZWQgb24gcmVzb2x1dGlvbi93aWR0aCBvZiB0aGUgZGlzcGxheS4KIAkg
Ki8KKwl0b3RhbF9zbGljZV9tYXNrID0gZGJ1Zl9zbGljZV9tYXNrOwogCWZvcl9lYWNoX25ld19p
bnRlbF9jcnRjX2luX3N0YXRlKGludGVsX3N0YXRlLCBjcnRjLCBjcnRjX3N0YXRlLCBpKSB7CiAJ
CWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KIAkJCSZjcnRj
X3N0YXRlLT5ody5hZGp1c3RlZF9tb2RlOwogCQllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7
CiAJCWludCBoZGlzcGxheSwgdmRpc3BsYXk7CisJCXUzMiBwaXBlX2RidWZfc2xpY2VfbWFzayA9
CisJCQkJCWk5MTVfcG9zc2libGVfZGJ1Zl9zbGljZXMoZGV2X3ByaXYsCisJCQkJCQkJCSAgcGlw
ZSwKKwkJCQkJCQkJICBhY3RpdmVfcGlwZXMsCisJCQkJCQkJCSAgY3J0Y19zdGF0ZSk7CisKKwkJ
aWYgKCFjcnRjX3N0YXRlLT5ody5hY3RpdmUpCisJCQljb250aW51ZTsKKworCQkvKgorCQkgKiBB
Y2NvcmRpbmcgdG8gQlNwZWMgcGlwZSBjYW4gc2hhcmUgb25lIGRidWYgc2xpY2Ugd2l0aCBhbm90
aGVyCisJCSAqIHBpcGVzIG9yIHBpcGUgY2FuIHVzZSBtdWx0aXBsZSBkYnVmcywgaW4gYm90aCBj
YXNlcyB3ZQorCQkgKiBhY2NvdW50IGZvciBvdGhlciBwaXBlcyBvbmx5IGlmIHRoZXkgaGF2ZSBl
eGFjdGx5IHNhbWUgbWFzay4KKwkJICogSG93ZXZlciB3ZSBuZWVkIHRvIGFjY291bnQgaG93IG1h
bnkgc2xpY2VzIHdlIHNob3VsZCBlbmFibGUKKwkJICogaW4gdG90YWwuCisJCSAqLworCQl0b3Rh
bF9zbGljZV9tYXNrIHw9IHBpcGVfZGJ1Zl9zbGljZV9tYXNrOwogCi0JCWlmICghY3J0Y19zdGF0
ZS0+aHcuZW5hYmxlKQorCQkvKgorCQkgKiBEbyBub3QgYWNjb3VudCBwaXBlcyB1c2luZyBvdGhl
ciBzbGljZSBzZXRzCisJCSAqIGx1Y2tpbHkgYXMgb2YgY3VycmVudCBCU3BlYyBzbGljZSBzZXRz
IGRvIG5vdCBwYXJ0aWFsbHkKKwkJICogaW50ZXJzZWN0KHBpcGVzIHNoYXJlIGVpdGhlciBzYW1l
IG9uZSBzbGljZSBvciBzYW1lIHNsaWNlIHNldAorCQkgKiBpLmUgbm8gcGFydGlhbCBpbnRlcnNl
Y3Rpb24pLCBzbyBpdCBpcyBlbm91Z2ggdG8gY2hlY2sgZm9yCisJCSAqIGVxdWFsaXR5IGZvciBu
b3cuCisJCSAqLworCQlpZiAoZGJ1Zl9zbGljZV9tYXNrICE9IHBpcGVfZGJ1Zl9zbGljZV9tYXNr
KQogCQkJY29udGludWU7CiAKIAkJZHJtX21vZGVfZ2V0X2h2X3RpbWluZyhhZGp1c3RlZF9tb2Rl
LCAmaGRpc3BsYXksICZ2ZGlzcGxheSk7CkBAIC0zOTA2LDggKzM5ODYsMTkgQEAgc2tsX2RkYl9n
ZXRfcGlwZV9hbGxvY2F0aW9uX2xpbWl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCiAJCQlwaXBlX3dpZHRoID0gaGRpc3BsYXk7CiAJfQogCi0JYWxsb2MtPnN0YXJ0ID0gZGRi
X3NpemUgKiB3aWR0aF9iZWZvcmVfcGlwZSAvIHRvdGFsX3dpZHRoOwotCWFsbG9jLT5lbmQgPSBk
ZGJfc2l6ZSAqICh3aWR0aF9iZWZvcmVfcGlwZSArIHBpcGVfd2lkdGgpIC8gdG90YWxfd2lkdGg7
CisJaW50ZWxfc3RhdGUtPmVuYWJsZWRfc2xpY2VzID0gdG90YWxfc2xpY2VfbWFzazsKKworCXN0
YXJ0ID0gZGRiX3JhbmdlX3NpemUgKiB3aWR0aF9iZWZvcmVfcGlwZSAvIHRvdGFsX3dpZHRoOwor
CWVuZCA9IGRkYl9yYW5nZV9zaXplICogKHdpZHRoX2JlZm9yZV9waXBlICsgcGlwZV93aWR0aCkg
LyB0b3RhbF93aWR0aDsKKworCWFsbG9jLT5zdGFydCA9IG9mZnNldCArIHN0YXJ0OworCWFsbG9j
LT5lbmQgPSBvZmZzZXQgKyBlbmQ7CisKKwlEUk1fREVCVUdfS01TKCJQaXBlICVkIGRkYiAlZC0l
ZFxuIiwgZm9yX3BpcGUsCisJCSAgICAgIGFsbG9jLT5zdGFydCwgYWxsb2MtPmVuZCk7CisJRFJN
X0RFQlVHX0tNUygiRW5hYmxlZCBkZGIgc2xpY2VzIG1hc2sgJXggbnVtIHN1cHBvcnRlZCAlZFxu
IiwKKwkJICAgICAgaW50ZWxfc3RhdGUtPmVuYWJsZWRfc2xpY2VzLAorCQkgICAgICBJTlRFTF9J
TkZPKGRldl9wcml2KS0+bnVtX3N1cHBvcnRlZF9kYnVmX3NsaWNlcyk7CiB9CiAKIHN0YXRpYyBp
bnQgc2tsX2NvbXB1dGVfd21fcGFyYW1zKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
cnRjX3N0YXRlLApAQCAtNDA3Nyw2ICs0MTY4LDEyMSBAQCBza2xfcGxhbmVfZG93bnNjYWxlX2Ft
b3VudChjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAlyZXR1cm4g
bXVsX2ZpeGVkMTYoZG93bnNjYWxlX3csIGRvd25zY2FsZV9oKTsKIH0KIAorc3RydWN0IGRidWZf
c2xpY2VfY29uZl9lbnRyeSB7CisJdTMyIGFjdGl2ZV9waXBlczsKKwl1MzIgZGJ1Zl9tYXNrW0k5
MTVfTUFYX1BJUEVTXTsKK307CisKKy8qCisgKiBUYWJsZSB0YWtlbiBmcm9tIEJzcGVjIDEyNzE2
CisgKiBQaXBlcyBkbyBoYXZlIHNvbWUgcHJlZmVycmVkIERCdWYgc2xpY2UgYWZmaW5pdHksCisg
KiBwbHVzIHRoZXJlIGFyZSBzb21lIGhhcmRjb2RlZCByZXF1aXJlbWVudHMgb24gaG93CisgKiB0
aG9zZSBzaG91bGQgYmUgZGlzdHJpYnV0ZWQgZm9yIG11bHRpcGlwZSBzY2VuYXJpb3MuCisgKiBG
b3IgbW9yZSBEQnVmIHNsaWNlcyBhbGdvcml0aG0gY2FuIGdldCBldmVuIG1vcmUgbWVzc3kKKyAq
IGFuZCBsZXNzIHJlYWRhYmxlLCBzbyBkZWNpZGVkIHRvIHVzZSBhIHRhYmxlIGFsbW9zdAorICog
YXMgaXMgZnJvbSBCU3BlYyBpdHNlbGYgLSB0aGF0IHdheSBpdCBpcyBhdCBsZWFzdCBlYXNpZXIK
KyAqIHRvIGNvbXBhcmUsIGNoYW5nZSBhbmQgY2hlY2suCisgKi8KK3N0YXRpYyBzdHJ1Y3QgZGJ1
Zl9zbGljZV9jb25mX2VudHJ5IGljbF9hbGxvd2VkX2RidWZzW10gPSB7CisJeyBCSVQoUElQRV9B
KSwgeyBEQlVGX1MxX0JJVCwgMCwgMCwgMCB9IH0sCisJeyBCSVQoUElQRV9CKSwgeyAwLCBEQlVG
X1MxX0JJVCwgMCwgMCB9IH0sCisJeyBCSVQoUElQRV9DKSwgeyAwLCAwLCBEQlVGX1MyX0JJVCwg
MCB9IH0sCisJeyBCSVQoUElQRV9BKSB8IEJJVChQSVBFX0IpLCB7IERCVUZfUzFfQklULCBEQlVG
X1MyX0JJVCwgMCwgMCB9IH0sCisJeyBCSVQoUElQRV9BKSB8IEJJVChQSVBFX0MpLCB7IERCVUZf
UzFfQklULCAwLCBEQlVGX1MyX0JJVCwgMCB9IH0sCisJeyBCSVQoUElQRV9CKSB8IEJJVChQSVBF
X0MpLCB7IDAsIERCVUZfUzFfQklULCBEQlVGX1MyX0JJVCwgMCB9IH0sCisJeyBCSVQoUElQRV9B
KSB8IEJJVChQSVBFX0IpIHwgQklUKFBJUEVfQyksCisJCXsgREJVRl9TMV9CSVQsIERCVUZfUzFf
QklULCBEQlVGX1MyX0JJVCwgMCB9IH0KK307CisKKy8qCisgKiBUYWJsZSB0YWtlbiBmcm9tIEJz
cGVjIDQ5MjU1CisgKiBQaXBlcyBkbyBoYXZlIHNvbWUgcHJlZmVycmVkIERCdWYgc2xpY2UgYWZm
aW5pdHksCisgKiBwbHVzIHRoZXJlIGFyZSBzb21lIGhhcmRjb2RlZCByZXF1aXJlbWVudHMgb24g
aG93CisgKiB0aG9zZSBzaG91bGQgYmUgZGlzdHJpYnV0ZWQgZm9yIG11bHRpcGlwZSBzY2VuYXJp
b3MuCisgKiBGb3IgbW9yZSBEQnVmIHNsaWNlcyBhbGdvcml0aG0gY2FuIGdldCBldmVuIG1vcmUg
bWVzc3kKKyAqIGFuZCBsZXNzIHJlYWRhYmxlLCBzbyBkZWNpZGVkIHRvIHVzZSBhIHRhYmxlIGFs
bW9zdAorICogYXMgaXMgZnJvbSBCU3BlYyBpdHNlbGYgLSB0aGF0IHdheSBpdCBpcyBhdCBsZWFz
dCBlYXNpZXIKKyAqIHRvIGNvbXBhcmUsIGNoYW5nZSBhbmQgY2hlY2suCisgKi8KK3N0YXRpYyBz
dHJ1Y3QgZGJ1Zl9zbGljZV9jb25mX2VudHJ5IHRnbF9hbGxvd2VkX2RidWZzW10gPSB7CisJeyBC
SVQoUElQRV9BKSwgeyBEQlVGX1MxX0JJVCB8IERCVUZfUzJfQklULCAwLCAwLCAwIH0gfSwKKwl7
IEJJVChQSVBFX0IpLCB7IDAsIERCVUZfUzFfQklUIHwgREJVRl9TMl9CSVQsIDAsIDAgfSB9LAor
CXsgQklUKFBJUEVfQyksIHsgMCwgMCwgREJVRl9TMV9CSVQgfCBEQlVGX1MyX0JJVCwgMCB9IH0s
CisJeyBCSVQoUElQRV9EKSwgeyAwLCAwLCAwLCBEQlVGX1MxX0JJVCB8IERCVUZfUzJfQklUIH0g
fSwKKwl7IEJJVChQSVBFX0EpIHwgQklUKFBJUEVfQiksIHsgREJVRl9TMl9CSVQsIERCVUZfUzFf
QklULCAwLCAwIH0gfSwKKwl7IEJJVChQSVBFX0EpIHwgQklUKFBJUEVfQyksIHsgREJVRl9TMV9C
SVQsIDAsIERCVUZfUzJfQklULCAwIH0gfSwKKwl7IEJJVChQSVBFX0EpIHwgQklUKFBJUEVfRCks
IHsgREJVRl9TMV9CSVQsIDAsIDAsIERCVUZfUzJfQklUIH0gfSwKKwl7IEJJVChQSVBFX0IpIHwg
QklUKFBJUEVfQyksIHsgMCwgREJVRl9TMV9CSVQsIERCVUZfUzJfQklULCAwIH0gfSwKKwl7IEJJ
VChQSVBFX0IpIHwgQklUKFBJUEVfRCksIHsgMCwgREJVRl9TMV9CSVQsIDAsIERCVUZfUzJfQklU
IH0gfSwKKwl7IEJJVChQSVBFX0MpIHwgQklUKFBJUEVfRCksIHsgMCwgMCwgREJVRl9TMl9CSVQs
IERCVUZfUzJfQklUIH0gfSwKKwl7IEJJVChQSVBFX0EpIHwgQklUKFBJUEVfQikgfCBCSVQoUElQ
RV9DKSwKKwkJeyBEQlVGX1MxX0JJVCwgREJVRl9TMV9CSVQsIERCVUZfUzJfQklULCAwIH0gfSwK
Kwl7IEJJVChQSVBFX0EpIHwgQklUKFBJUEVfQikgfCBCSVQoUElQRV9EKSwKKwkJeyBEQlVGX1Mx
X0JJVCwgREJVRl9TMV9CSVQsIDAsIERCVUZfUzJfQklUIH0gfSwKKwl7IEJJVChQSVBFX0EpIHwg
QklUKFBJUEVfQykgfCBCSVQoUElQRV9EKSwKKwkJeyBEQlVGX1MxX0JJVCwgMCwgREJVRl9TMl9C
SVQsIERCVUZfUzJfQklUIH0gfSwKKwl7IEJJVChQSVBFX0IpIHwgQklUKFBJUEVfQykgfCBCSVQo
UElQRV9EKSwKKwkJeyAwLCBEQlVGX1MxX0JJVCwgREJVRl9TMl9CSVQsIERCVUZfUzJfQklUIH0g
fSwKKwl7IEJJVChQSVBFX0EpIHwgQklUKFBJUEVfQikgfCBCSVQoUElQRV9DKSB8IEJJVChQSVBF
X0QpLAorCQl7IERCVUZfUzFfQklULCBEQlVGX1MxX0JJVCwgREJVRl9TMl9CSVQsIERCVUZfUzJf
QklUIH0gfSwKK307CisKK3N0YXRpYyB1MzIgaTkxNV9maW5kX3BpcGVfY29uZihpbnQgcGlwZSwK
KwkJCSAgICAgICB1MzIgYWN0aXZlX3BpcGVzLAorCQkJICAgICAgIGNvbnN0IHN0cnVjdCBkYnVm
X3NsaWNlX2NvbmZfZW50cnkgKmRidWZfc2xpY2VzLAorCQkJICAgICAgIGludCBzaXplKQorewor
CWludCBpOworCisJZm9yIChpID0gMDsgaSA8IHNpemU7IGkrKykgeworCQlpZiAoZGJ1Zl9zbGlj
ZXNbaV0uYWN0aXZlX3BpcGVzID09IGFjdGl2ZV9waXBlcykKKwkJCXJldHVybiBkYnVmX3NsaWNl
c1tpXS5kYnVmX21hc2tbcGlwZV07CisJfQorCXJldHVybiAwOworfQorCisvKgorICogVGhpcyBm
dW5jdGlvbiBmaW5kcyBhbiBlbnRyeSB3aXRoIHNhbWUgZW5hYmxlZCBwaXBlIGNvbmZpZ3VyYXRp
b24gYW5kCisgKiByZXR1cm5zIGNvcnJlc3BvbmRlbnQgREJ1ZiBzbGljZSBtYXNrIGFzIHN0YXRl
ZCBpbiBCU3BlYyBmb3IgcGFydGljdWxhcgorICogcGxhdGZvcm0uCisgKi8KK3N0YXRpYyB1MzIg
aWNsX3Bvc3NpYmxlX2RidWZfc2xpY2VzKGludCBwaXBlLAorCQkJCSAgICB1MzIgYWN0aXZlX3Bp
cGVzLAorCQkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkK
K3sKKwlyZXR1cm4gaTkxNV9maW5kX3BpcGVfY29uZihwaXBlLCBhY3RpdmVfcGlwZXMsCisJCQkJ
ICAgaWNsX2FsbG93ZWRfZGJ1ZnMsCisJCQkJICAgQVJSQVlfU0laRShpY2xfYWxsb3dlZF9kYnVm
cykpOworfQorCitzdGF0aWMgdTMyIHRnbF9wb3NzaWJsZV9kYnVmX3NsaWNlcyhpbnQgcGlwZSwK
KwkJCQkgICAgdTMyIGFjdGl2ZV9waXBlcywKKwkJCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUpCit7CisJcmV0dXJuIGk5MTVfZmluZF9waXBlX2NvbmYocGlw
ZSwgYWN0aXZlX3BpcGVzLAorCQkJCSAgIHRnbF9hbGxvd2VkX2RidWZzLAorCQkJCSAgIEFSUkFZ
X1NJWkUodGdsX2FsbG93ZWRfZGJ1ZnMpKTsKK30KKwordTMyIGk5MTVfcG9zc2libGVfZGJ1Zl9z
bGljZXMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJICAgICAgaW50IHBp
cGUsIHUzMiBhY3RpdmVfcGlwZXMsCisJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSkKK3sKKwlpZiAoSVNfR0VOKGRldl9wcml2LCAxMSkpCisJCXJldHVy
biBpY2xfcG9zc2libGVfZGJ1Zl9zbGljZXMocGlwZSwKKwkJCQkJCWFjdGl2ZV9waXBlcywKKwkJ
CQkJCWNydGNfc3RhdGUpOworCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMTIpKQorCQlyZXR1
cm4gdGdsX3Bvc3NpYmxlX2RidWZfc2xpY2VzKHBpcGUsCisJCQkJCQlhY3RpdmVfcGlwZXMsCisJ
CQkJCQljcnRjX3N0YXRlKTsKKwkvKgorCSAqIEZvciBhbnl0aGluZyBlbHNlIGp1c3QgcmV0dXJu
IG9uZSBzbGljZSB5ZXQuCisJICogU2hvdWxkIGJlIGV4dGVuZGVkIGZvciBvdGhlciBwbGF0Zm9y
bXMuCisJICovCisJcmV0dXJuIERCVUZfUzFfQklUOworfQorCiBzdGF0aWMgdTY0CiBza2xfcGxh
bmVfcmVsYXRpdmVfZGF0YV9yYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAogCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0
YXRlLAotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpJbnRlbC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRl
bC1nZng=

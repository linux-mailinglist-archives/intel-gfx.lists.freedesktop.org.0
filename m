Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 196D8184CE3
	for <lists+intel-gfx@lfdr.de>; Fri, 13 Mar 2020 17:49:19 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 685756EC33;
	Fri, 13 Mar 2020 16:49:17 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 728B06EC33
 for <intel-gfx@lists.freedesktop.org>; Fri, 13 Mar 2020 16:49:13 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 13 Mar 2020 09:49:12 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.70,549,1574150400"; d="scan'208";a="278288971"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by fmsmga002.fm.intel.com with SMTP; 13 Mar 2020 09:49:10 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Fri, 13 Mar 2020 18:49:09 +0200
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri, 13 Mar 2020 18:48:30 +0200
Message-Id: <20200313164831.5980-13-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20200313164831.5980-1-ville.syrjala@linux.intel.com>
References: <20200313164831.5980-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 12/13] drm/i915: Pass atomic state to encoder
 hooks
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KCldl
J3JlIGdvaW5nIHRvIHdhbnQgYWNjZXNzIHRvIHRoZSBhdG9taWMgc3RhdGUgZm9yIGl0ZXJhdGlu
Zwp0aGUgc2xhdmUgY3J0Y3Mgd2hlbiBlbmFibGluZyB0aGUgcG9ydCBzeW5jIG1hc3RlciBjcnRj
LiBQYXNzCnRoZSBhdG9taWMgc3RhdGUgYWxsIHRoZSB3YXkgZG93bi4KClRoZSBhbHRlcm5hdGl2
ZSB3b3VsZCBiZSB5ZXQgYW5vdGhlciBlbmNvZGVyIGhvb2sgd2hpY2ggd2UnbGwKaGF2ZSB0byBj
YWxsIGFmdGVyIGFsbCB0aGUgbm9ybWFsIG1vZGVzZXQgc3R1ZmYgaXMgZG9uZS4gTm90CnJlYWxs
eSBhIGZhbiBvZiB5ZXQgYW5vdGhlciBob29rIGp1c3QgZm9yIHRoaXMuCgpOb3RlIHRoYXQgZHVy
aW5nIHJlYWRvdXQgc3RhdGUgc2FuaXRhdGlvbiB3ZSBhcmUgbm93IGdvaW5nCnRvIHBhc3MgTlVM
TCBhcyB0aGUgYXRvbWljIHN0YXRlIHNpbmNlIHdlIGRvbid0IGhhdmUgb25lLgpXZSBuZWVkIHRv
IGNoYW5nZSB0aGF0IGFuZCB0aGVuIHdlIGNhbiBhbHNvIHMvY3J0Y19zdGF0ZS9jcnRjLwphbmQg
cy9jb25uX3N0YXRlL2Nvbm4vIGZvciB0aGUgZW5jb2RlciBob29rcyBhcyB3ZWxsLgoKU2lnbmVk
LW9mZi1ieTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4K
LS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ljbF9kc2kuYyAgICAgICAgfCAxNSAr
Ky0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2NydC5jICAgICAgfCAzMyAr
KysrLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5jICAgICAgfCA4
OSArKysrKysrKysrKystLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVs
X2RkaS5oICAgICAgfCAgMyArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9k
aXNwbGF5LmMgIHwgMjYgKysrKy0tCiAuLi4vZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5
X3R5cGVzLmggICAgfCAyMSArKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kcC5jICAgICAgIHwgNTUgKysrKysrKy0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2RwX21zdC5jICAgfCAyMSArKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kdm8uYyAgICAgIHwgIDkgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfaGRjcC5jICAgICB8ICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX2hkY3AuaCAgICAgfCAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9p
bnRlbF9oZG1pLmMgICAgIHwgNTkgKysrKysrKy0tLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9k
aXNwbGF5L2ludGVsX2x2ZHMuYyAgICAgfCAyMiArKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
ZGlzcGxheS9pbnRlbF9wYW5lbC5jICAgIHwgIDMgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfcGFuZWwuaCAgICB8ICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX3Nkdm8uYyAgICAgfCAxNyArKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX3R2LmMgICAgICAgfCAgOSArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS92bHZfZHNpLmMgICAgICAgIHwgMTIgKystCiAxOCBmaWxlcyBjaGFuZ2VkLCAyNjAgaW5zZXJ0
aW9ucygrKSwgMTQ0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaWNsX2RzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pY2xf
ZHNpLmMKaW5kZXggMTdjZWU2ZjgwZDhiLi5lYTk5MDdjM2U1YmEgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaWNsX2RzaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaWNsX2RzaS5jCkBAIC0xMDg4LDcgKzEwODgsOCBAQCBzdGF0aWMgdm9pZCBn
ZW4xMV9kc2lfcG93ZXJ1cF9wYW5lbChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlcikKIAl3
YWl0X2Zvcl9jbWRzX2Rpc3BhdGNoZWRfdG9fcGFuZWwoZW5jb2Rlcik7CiB9CiAKLXN0YXRpYyB2
b2lkIGdlbjExX2RzaV9wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKK3N0YXRpYyB2b2lkIGdlbjExX2RzaV9wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgaW50ZWxfYXRv
bWljX3N0YXRlICpzdGF0ZSwKKwkJCQkgICAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAogCQkJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJ
CQkJICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsK
QEAgLTEwOTksNyArMTEwMCw4IEBAIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9wcmVfcGxsX2VuYWJs
ZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlnZW4xMV9kc2lfcHJvZ3JhbV9lc2Nf
Y2xrX2RpdihlbmNvZGVyLCBjcnRjX3N0YXRlKTsKIH0KIAotc3RhdGljIHZvaWQgZ2VuMTFfZHNp
X3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBn
ZW4xMV9kc2lfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJ
CQkgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJIGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKIAkJCQkgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0
b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCiB7CkBAIC0xMTE4LDcgKzExMjAsOCBAQCBzdGF0aWMgdm9p
ZCBnZW4xMV9kc2lfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAln
ZW4xMV9kc2lfc2V0X3RyYW5zY29kZXJfdGltaW5ncyhlbmNvZGVyLCBwaXBlX2NvbmZpZyk7CiB9
CiAKLXN0YXRpYyB2b2lkIGdlbjExX2RzaV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCitzdGF0aWMgdm9pZCBnZW4xMV9kc2lfZW5hYmxlKHN0cnVjdCBpbnRlbF9hdG9taWNf
c3RhdGUgKnN0YXRlLAorCQkJICAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJ
CSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkgICAg
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewpAQCAtMTI2
NCw3ICsxMjY3LDggQEAgc3RhdGljIHZvaWQgZ2VuMTFfZHNpX2Rpc2FibGVfaW9fcG93ZXIoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIpCiAJfQogfQogCi1zdGF0aWMgdm9pZCBnZW4xMV9k
c2lfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGdl
bjExX2RzaV9kaXNhYmxlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJICAg
ICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCiAJCQkgICAgICBjb25zdCBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7CkBAIC0xMjkwLDcgKzEyOTQs
OCBAQCBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKIAlnZW4xMV9kc2lfZGlzYWJsZV9pb19wb3dlcihlbmNvZGVyKTsKIH0KIAotc3Rh
dGljIHZvaWQgZ2VuMTFfZHNpX3Bvc3RfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKK3N0YXRpYyB2b2lkIGdlbjExX2RzaV9wb3N0X2Rpc2FibGUoc3RydWN0IGludGVsX2F0
b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
CiAJCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAog
CQkJCSAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkK
IHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfY3J0LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2NydC5jCmluZGV4IDc4ZjliNmNk
ZTgxMC4uODBjOTE0MDQwNDZmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2NydC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
Y3J0LmMKQEAgLTIwMywyNyArMjAzLDMxIEBAIHN0YXRpYyB2b2lkIGludGVsX2NydF9zZXRfZHBt
cyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlpbnRlbF9kZV93cml0ZShkZXZfcHJp
diwgY3J0LT5hZHBhX3JlZywgYWRwYSk7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVf
Y3J0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgaW50ZWxfZGlz
YWJsZV9jcnQoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkgICAgICBzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBkcm1fY29u
bmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsKIAlpbnRlbF9jcnRfc2V0X2RwbXMoZW5j
b2Rlciwgb2xkX2NydGNfc3RhdGUsIERSTV9NT0RFX0RQTVNfT0ZGKTsKIH0KIAotc3RhdGljIHZv
aWQgcGNoX2Rpc2FibGVfY3J0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGlj
IHZvaWQgcGNoX2Rpc2FibGVfY3J0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAor
CQkJICAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKIAkJCSAgICBjb25zdCBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7CiB9CiAKLXN0YXRpYyB2b2lk
IHBjaF9wb3N0X2Rpc2FibGVfY3J0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3Rh
dGljIHZvaWQgcGNoX3Bvc3RfZGlzYWJsZV9jcnQoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUsCisJCQkJIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSBjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCiAJCQkJIGNvbnN0IHN0cnVj
dCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsKLQlpbnRlbF9kaXNhYmxl
X2NydChlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5fc3RhdGUpOworCWludGVsX2Rp
c2FibGVfY3J0KHN0YXRlLCBlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5fc3RhdGUp
OwogfQogCi1zdGF0aWMgdm9pZCBoc3dfZGlzYWJsZV9jcnQoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCitzdGF0aWMgdm9pZCBoc3dfZGlzYWJsZV9jcnQoc3RydWN0IGludGVsX2F0b21p
Y19zdGF0ZSAqc3RhdGUsCisJCQkgICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJ
CQkgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJ
ICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsK
QEAgLTIzNCw3ICsyMzgsOCBAQCBzdGF0aWMgdm9pZCBoc3dfZGlzYWJsZV9jcnQoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCiAJaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9y
dGluZyhkZXZfcHJpdiwgUElQRV9BLCBmYWxzZSk7CiB9CiAKLXN0YXRpYyB2b2lkIGhzd19wb3N0
X2Rpc2FibGVfY3J0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQg
aHN3X3Bvc3RfZGlzYWJsZV9jcnQoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJ
CQkJIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCiAJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29u
bmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsKQEAgLTI1MCwxOSArMjU1LDIwIEBAIHN0
YXRpYyB2b2lkIGhzd19wb3N0X2Rpc2FibGVfY3J0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAogCiAJaW50ZWxfZGRpX2Rpc2FibGVfcGlwZV9jbG9jayhvbGRfY3J0Y19zdGF0ZSk7CiAK
LQlwY2hfcG9zdF9kaXNhYmxlX2NydChlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5f
c3RhdGUpOworCXBjaF9wb3N0X2Rpc2FibGVfY3J0KHN0YXRlLCBlbmNvZGVyLCBvbGRfY3J0Y19z
dGF0ZSwgb2xkX2Nvbm5fc3RhdGUpOwogCiAJbHB0X2Rpc2FibGVfcGNoX3RyYW5zY29kZXIoZGV2
X3ByaXYpOwogCWxwdF9kaXNhYmxlX2ljbGtpcChkZXZfcHJpdik7CiAKLQlpbnRlbF9kZGlfZmRp
X3Bvc3RfZGlzYWJsZShlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5fc3RhdGUpOwor
CWludGVsX2RkaV9mZGlfcG9zdF9kaXNhYmxlKHN0YXRlLCBlbmNvZGVyLCBvbGRfY3J0Y19zdGF0
ZSwgb2xkX2Nvbm5fc3RhdGUpOwogCiAJZHJtX1dBUk5fT04oJmRldl9wcml2LT5kcm0sICFvbGRf
Y3J0Y19zdGF0ZS0+aGFzX3BjaF9lbmNvZGVyKTsKIAogCWludGVsX3NldF9wY2hfZmlmb191bmRl
cnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIFBJUEVfQSwgdHJ1ZSk7CiB9CiAKLXN0YXRpYyB2b2lk
IGhzd19wcmVfcGxsX2VuYWJsZV9jcnQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitz
dGF0aWMgdm9pZCBoc3dfcHJlX3BsbF9lbmFibGVfY3J0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3Rh
dGUgKnN0YXRlLAorCQkJCSAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJCSAgIGNvbnN0
IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewpAQCAtMjczLDcgKzI3
OSw4IEBAIHN0YXRpYyB2b2lkIGhzd19wcmVfcGxsX2VuYWJsZV9jcnQoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCiAJaW50ZWxfc2V0X3BjaF9maWZvX3VuZGVycnVuX3JlcG9ydGluZyhk
ZXZfcHJpdiwgUElQRV9BLCBmYWxzZSk7CiB9CiAKLXN0YXRpYyB2b2lkIGhzd19wcmVfZW5hYmxl
X2NydChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGhzd19wcmVf
ZW5hYmxlX2NydChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgICBz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKQEAgLTI5MCw3ICsyOTcsOCBAQCBzdGF0aWMg
dm9pZCBoc3dfcHJlX2VuYWJsZV9jcnQoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJ
aW50ZWxfZGRpX2VuYWJsZV9waXBlX2Nsb2NrKGNydGNfc3RhdGUpOwogfQogCi1zdGF0aWMgdm9p
ZCBoc3dfZW5hYmxlX2NydChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2
b2lkIGhzd19lbmFibGVfY3J0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJ
ICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVj
dG9yX3N0YXRlICpjb25uX3N0YXRlKQogewpAQCAtMzE0LDcgKzMyMiw4IEBAIHN0YXRpYyB2b2lk
IGhzd19lbmFibGVfY3J0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCWludGVsX3Nl
dF9wY2hfZmlmb191bmRlcnJ1bl9yZXBvcnRpbmcoZGV2X3ByaXYsIFBJUEVfQSwgdHJ1ZSk7CiB9
CiAKLXN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9jcnQoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCitzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfY3J0KHN0cnVjdCBpbnRlbF9hdG9taWNf
c3RhdGUgKnN0YXRlLAorCQkJICAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJ
CSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkgICAg
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMKaW5kZXggOWU2ZWIwZWU1YmE0Li45ODQ3
NWM4MWYxZGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGRpLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGkuYwpAQCAt
MzAxNyw3ICszMDE3LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX2Rpc2FibGVfZmVjX3N0YXRl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCWludGVsX2RlX3Bvc3RpbmdfcmVhZChk
ZXZfcHJpdiwgaW50ZWxfZHAtPnJlZ3MuZHBfdHBfY3RsKTsKIH0KIAotc3RhdGljIHZvaWQgdGds
X2RkaV9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGlj
IHZvaWQgdGdsX2RkaV9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0
YXRlLAorCQkJCSAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICBjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCQkgIGNvbnN0IHN0cnVjdCBk
cm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewpAQCAtMzE1Nyw3ICszMTU4LDggQEAg
c3RhdGljIHZvaWQgdGdsX2RkaV9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAogCWludGVsX2RzY19lbmFibGUoZW5jb2RlciwgY3J0Y19zdGF0ZSk7CiB9CiAKLXN0
YXRpYyB2b2lkIGhzd19kZGlfcHJlX2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKK3N0YXRpYyB2b2lkIGhzd19kZGlfcHJlX2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfYXRv
bWljX3N0YXRlICpzdGF0ZSwKKwkJCQkgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAog
CQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkJICBj
b25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKQEAgLTMyMzAs
MTYgKzMyMzIsMTcgQEAgc3RhdGljIHZvaWQgaHN3X2RkaV9wcmVfZW5hYmxlX2RwKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAogCWludGVsX2RzY19lbmFibGUoZW5jb2RlciwgY3J0Y19z
dGF0ZSk7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2RkaV9wcmVfZW5hYmxlX2RwKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgaW50ZWxfZGRpX3ByZV9lbmFibGVf
ZHAoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJICAgIHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSwKIAkJCQkgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUg
KmNvbm5fc3RhdGUpCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9f
aTkxNShlbmNvZGVyLT5iYXNlLmRldik7CiAKIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAx
MikKLQkJdGdsX2RkaV9wcmVfZW5hYmxlX2RwKGVuY29kZXIsIGNydGNfc3RhdGUsIGNvbm5fc3Rh
dGUpOworCQl0Z2xfZGRpX3ByZV9lbmFibGVfZHAoc3RhdGUsIGVuY29kZXIsIGNydGNfc3RhdGUs
IGNvbm5fc3RhdGUpOwogCWVsc2UKLQkJaHN3X2RkaV9wcmVfZW5hYmxlX2RwKGVuY29kZXIsIGNy
dGNfc3RhdGUsIGNvbm5fc3RhdGUpOworCQloc3dfZGRpX3ByZV9lbmFibGVfZHAoc3RhdGUsIGVu
Y29kZXIsIGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOwogCiAJLyogTVNUIHdpbGwgY2FsbCBhIHNl
dHRpbmcgb2YgTVNBIGFmdGVyIGFuIGFsbG9jYXRpbmcgb2YgVmlydHVhbCBDaGFubmVsCiAJICog
ZnJvbSBNU1QgZW5jb2RlciBwcmVfZW5hYmxlIGNhbGxiYWNrLgpAQCAtMzI1MSw3ICszMjU0LDgg
QEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX3ByZV9lbmFibGVfZHAoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCiAJfQogfQogCi1zdGF0aWMgdm9pZCBpbnRlbF9kZGlfcHJlX2VuYWJsZV9o
ZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgaW50ZWxfZGRp
X3ByZV9lbmFibGVfaGRtaShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCQkg
ICAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQkgICAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCQkgICAgICBjb25zdCBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKQEAgLTMyOTEsNyArMzI5NSw4IEBA
IHN0YXRpYyB2b2lkIGludGVsX2RkaV9wcmVfZW5hYmxlX2hkbWkoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCiAJCQkJICAgICAgIGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOwogfQogCi1z
dGF0aWMgdm9pZCBpbnRlbF9kZGlfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKK3N0YXRpYyB2b2lkIGludGVsX2RkaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlLAorCQkJCSBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJ
CQkgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCiAJCQkJIGNvbnN0
IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewpAQCAtMzMyMCwxMiAr
MzMyNSwxNCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKIAlpbnRlbF9zZXRfY3B1X2ZpZm9fdW5kZXJydW5fcmVwb3J0aW5n
KGRldl9wcml2LCBwaXBlLCB0cnVlKTsKIAogCWlmIChpbnRlbF9jcnRjX2hhc190eXBlKGNydGNf
c3RhdGUsIElOVEVMX09VVFBVVF9IRE1JKSkgewotCQlpbnRlbF9kZGlfcHJlX2VuYWJsZV9oZG1p
KGVuY29kZXIsIGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOworCQlpbnRlbF9kZGlfcHJlX2VuYWJs
ZV9oZG1pKHN0YXRlLCBlbmNvZGVyLCBjcnRjX3N0YXRlLAorCQkJCQkgIGNvbm5fc3RhdGUpOwog
CX0gZWxzZSB7CiAJCXN0cnVjdCBpbnRlbF9sc3Bjb24gKmxzcGNvbiA9CiAJCQkJZW5jX3RvX2lu
dGVsX2xzcGNvbihlbmNvZGVyKTsKIAotCQlpbnRlbF9kZGlfcHJlX2VuYWJsZV9kcChlbmNvZGVy
LCBjcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsKKwkJaW50ZWxfZGRpX3ByZV9lbmFibGVfZHAoc3Rh
dGUsIGVuY29kZXIsIGNydGNfc3RhdGUsCisJCQkJCWNvbm5fc3RhdGUpOwogCQlpZiAobHNwY29u
LT5hY3RpdmUpIHsKIAkJCXN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0ID0KIAkJ
CQkJZW5jX3RvX2RpZ19wb3J0KGVuY29kZXIpOwpAQCAtMzM2OCw3ICszMzc1LDggQEAgc3RhdGlj
IHZvaWQgaW50ZWxfZGlzYWJsZV9kZGlfYnVmKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAogCQlpbnRlbF93YWl0X2RkaV9idWZfaWRsZShkZXZfcHJpdiwgcG9ydCk7CiB9CiAKLXN0YXRp
YyB2b2lkIGludGVsX2RkaV9wb3N0X2Rpc2FibGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCitzdGF0aWMgdm9pZCBpbnRlbF9kZGlfcG9zdF9kaXNhYmxlX2RwKHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJCSAgICAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAogCQkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0
Y19zdGF0ZSwKIAkJCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xk
X2Nvbm5fc3RhdGUpCiB7CkBAIC0zNDI0LDcgKzM0MzIsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9k
ZGlfcG9zdF9kaXNhYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCWludGVs
X2RkaV9jbGtfZGlzYWJsZShlbmNvZGVyKTsKIH0KIAotc3RhdGljIHZvaWQgaW50ZWxfZGRpX3Bv
c3RfZGlzYWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZv
aWQgaW50ZWxfZGRpX3Bvc3RfZGlzYWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUg
KnN0YXRlLAorCQkJCQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQkJY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJCQljb25zdCBzdHJ1
Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7CkBAIC0zNDQ3LDcgKzM0
NTYsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfcG9zdF9kaXNhYmxlX2hkbWkoc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCiAJaW50ZWxfZHBfZHVhbF9tb2RlX3NldF90bWRzX291dHB1
dChpbnRlbF9oZG1pLCBmYWxzZSk7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2RkaV9wb3N0X2Rp
c2FibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBpbnRlbF9k
ZGlfcG9zdF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJCSAg
IHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKIAkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Nv
bm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7CkBAIC0zNDg1LDExICszNDk1LDExIEBA
IHN0YXRpYyB2b2lkIGludGVsX2RkaV9wb3N0X2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCiAJICovCiAKIAlpZiAoaW50ZWxfY3J0Y19oYXNfdHlwZShvbGRfY3J0Y19zdGF0
ZSwgSU5URUxfT1VUUFVUX0hETUkpKQotCQlpbnRlbF9kZGlfcG9zdF9kaXNhYmxlX2hkbWkoZW5j
b2RlciwKLQkJCQkJICAgIG9sZF9jcnRjX3N0YXRlLCBvbGRfY29ubl9zdGF0ZSk7CisJCWludGVs
X2RkaV9wb3N0X2Rpc2FibGVfaGRtaShzdGF0ZSwgZW5jb2Rlciwgb2xkX2NydGNfc3RhdGUsCisJ
CQkJCSAgICBvbGRfY29ubl9zdGF0ZSk7CiAJZWxzZQotCQlpbnRlbF9kZGlfcG9zdF9kaXNhYmxl
X2RwKGVuY29kZXIsCi0JCQkJCSAgb2xkX2NydGNfc3RhdGUsIG9sZF9jb25uX3N0YXRlKTsKKwkJ
aW50ZWxfZGRpX3Bvc3RfZGlzYWJsZV9kcChzdGF0ZSwgZW5jb2Rlciwgb2xkX2NydGNfc3RhdGUs
CisJCQkJCSAgb2xkX2Nvbm5fc3RhdGUpOwogCiAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0g
MTEpCiAJCWljbF91bm1hcF9wbGxzX3RvX3BvcnRzKGVuY29kZXIpOwpAQCAtMzUwMiw3ICszNTEy
LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZGRpX3Bvc3RfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5j
b2RlciAqZW5jb2RlciwKIAkJaW50ZWxfdGNfcG9ydF9wdXRfbGluayhkaWdfcG9ydCk7CiB9CiAK
LXZvaWQgaW50ZWxfZGRpX2ZkaV9wb3N0X2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVu
Y29kZXIsCit2b2lkIGludGVsX2RkaV9mZGlfcG9zdF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlLAorCQkJCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJ
CWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKIAkJCQljb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7CkBAIC0zNTM2
LDcgKzM1NDcsOCBAQCB2b2lkIGludGVsX2RkaV9mZGlfcG9zdF9kaXNhYmxlKHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAogCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBGRElfUlhfQ1RM
KFBJUEVfQSksIHZhbCk7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9kZGlfZHAoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfZGRp
X2RwKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJCXN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAogCQkJCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRl
KQogewpAQCAtMzU3Nyw3ICszNTg5LDggQEAgZ2VuOV9jaGlja2VuX3RyYW5zX3JlZ19ieV9wb3J0
KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAlyZXR1cm4gQ0hJQ0tFTl9UUkFO
Uyh0cmFuc1twb3J0XSk7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9kZGlfaGRtaShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9k
ZGlfaGRtaShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCQkgIHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUsCiAJCQkJICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSkKIHsKQEAgLTM2MzksNyArMzY1Miw4IEBAIHN0YXRpYyB2b2lkIGludGVsX2Vu
YWJsZV9kZGlfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJaW50ZWxfYXVk
aW9fY29kZWNfZW5hYmxlKGVuY29kZXIsIGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOwogfQogCi1z
dGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfZGRpKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAorc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2RkaShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJICAgICBjb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKQEAgLTM2NTAsOSAr
MzY2NCw5IEBAIHN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9kZGkoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCiAJaW50ZWxfY3J0Y192Ymxhbmtfb24oY3J0Y19zdGF0ZSk7CiAKIAlpZiAo
aW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfSERNSSkpCi0JCWlu
dGVsX2VuYWJsZV9kZGlfaGRtaShlbmNvZGVyLCBjcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsKKwkJ
aW50ZWxfZW5hYmxlX2RkaV9oZG1pKHN0YXRlLCBlbmNvZGVyLCBjcnRjX3N0YXRlLCBjb25uX3N0
YXRlKTsKIAllbHNlCi0JCWludGVsX2VuYWJsZV9kZGlfZHAoZW5jb2RlciwgY3J0Y19zdGF0ZSwg
Y29ubl9zdGF0ZSk7CisJCWludGVsX2VuYWJsZV9kZGlfZHAoc3RhdGUsIGVuY29kZXIsIGNydGNf
c3RhdGUsIGNvbm5fc3RhdGUpOwogCiAJLyogRW5hYmxlIGhkY3AgaWYgaXQncyBkZXNpcmVkICov
CiAJaWYgKGNvbm5fc3RhdGUtPmNvbnRlbnRfcHJvdGVjdGlvbiA9PQpAQCAtMzY2Miw3ICszNjc2
LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2RkaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKIAkJCQkgICh1OCljb25uX3N0YXRlLT5oZGNwX2NvbnRlbnRfdHlwZSk7CiB9CiAK
LXN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfZGRpX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAorc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJsZV9kZGlfZHAoc3RydWN0IGludGVsX2F0
b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAog
CQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCiAJCQkJ
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsKQEAg
LTM2ODIsNyArMzY5Nyw4IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfZGRpX2RwKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCQkgICAgICBmYWxzZSk7CiB9CiAKLXN0YXRp
YyB2b2lkIGludGVsX2Rpc2FibGVfZGRpX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCitzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX2RkaV9oZG1pKHN0cnVjdCBpbnRlbF9hdG9t
aWNfc3RhdGUgKnN0YXRlLAorCQkJCSAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAog
CQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKIAkJ
CQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7
CkBAIC0zNjk4LDE5ICszNzE0LDIzIEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfZGRpX2hk
bWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICAgICBjb25uZWN0b3ItPmJh
c2UuaWQsIGNvbm5lY3Rvci0+bmFtZSk7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVf
ZGRpKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgaW50ZWxfZGlz
YWJsZV9kZGkoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkgICAgICBzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBkcm1fY29u
bmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsKIAlpbnRlbF9oZGNwX2Rpc2FibGUodG9f
aW50ZWxfY29ubmVjdG9yKG9sZF9jb25uX3N0YXRlLT5jb25uZWN0b3IpKTsKIAogCWlmIChpbnRl
bF9jcnRjX2hhc190eXBlKG9sZF9jcnRjX3N0YXRlLCBJTlRFTF9PVVRQVVRfSERNSSkpCi0JCWlu
dGVsX2Rpc2FibGVfZGRpX2hkbWkoZW5jb2Rlciwgb2xkX2NydGNfc3RhdGUsIG9sZF9jb25uX3N0
YXRlKTsKKwkJaW50ZWxfZGlzYWJsZV9kZGlfaGRtaShzdGF0ZSwgZW5jb2Rlciwgb2xkX2NydGNf
c3RhdGUsCisJCQkJICAgICAgIG9sZF9jb25uX3N0YXRlKTsKIAllbHNlCi0JCWludGVsX2Rpc2Fi
bGVfZGRpX2RwKGVuY29kZXIsIG9sZF9jcnRjX3N0YXRlLCBvbGRfY29ubl9zdGF0ZSk7CisJCWlu
dGVsX2Rpc2FibGVfZGRpX2RwKHN0YXRlLCBlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwKKwkJCQkg
ICAgIG9sZF9jb25uX3N0YXRlKTsKIH0KIAotc3RhdGljIHZvaWQgaW50ZWxfZGRpX3VwZGF0ZV9w
aXBlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgaW50ZWxf
ZGRpX3VwZGF0ZV9waXBlX2RwKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJ
CSAgICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICAgICBjb25zdCBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCQkgICAgIGNvbnN0IHN0cnVjdCBk
cm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewpAQCAtMzcyMSwxOCArMzc0MSwyMCBA
QCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfdXBkYXRlX3BpcGVfZHAoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCiAJaW50ZWxfcHNyX3VwZGF0ZShpbnRlbF9kcCwgY3J0Y19zdGF0ZSk7CiAJ
aW50ZWxfZWRwX2RycnNfZW5hYmxlKGludGVsX2RwLCBjcnRjX3N0YXRlKTsKIAotCWludGVsX3Bh
bmVsX3VwZGF0ZV9iYWNrbGlnaHQoZW5jb2RlciwgY3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSk7CisJ
aW50ZWxfcGFuZWxfdXBkYXRlX2JhY2tsaWdodChzdGF0ZSwgZW5jb2RlciwgY3J0Y19zdGF0ZSwg
Y29ubl9zdGF0ZSk7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2RkaV91cGRhdGVfcGlwZShzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGludGVsX2RkaV91cGRhdGVf
cGlwZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCQkgIHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KmNydGNfc3RhdGUsCiAJCQkJICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29u
bl9zdGF0ZSkKIHsKIAogCWlmICghaW50ZWxfY3J0Y19oYXNfdHlwZShjcnRjX3N0YXRlLCBJTlRF
TF9PVVRQVVRfSERNSSkpCi0JCWludGVsX2RkaV91cGRhdGVfcGlwZV9kcChlbmNvZGVyLCBjcnRj
X3N0YXRlLCBjb25uX3N0YXRlKTsKKwkJaW50ZWxfZGRpX3VwZGF0ZV9waXBlX2RwKHN0YXRlLCBl
bmNvZGVyLCBjcnRjX3N0YXRlLAorCQkJCQkgY29ubl9zdGF0ZSk7CiAKLQlpbnRlbF9oZGNwX3Vw
ZGF0ZV9waXBlKGVuY29kZXIsIGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOworCWludGVsX2hkY3Bf
dXBkYXRlX3BpcGUoc3RhdGUsIGVuY29kZXIsIGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOwogfQog
CiBzdGF0aWMgdm9pZApAQCAtMzc2MSw3ICszNzgzLDggQEAgaW50ZWxfZGRpX3VwZGF0ZV9jb21w
bGV0ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKIH0KIAogc3RhdGljIHZvaWQK
LWludGVsX2RkaV9wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
K2ludGVsX2RkaV9wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0
ZSwKKwkJCSBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSBjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX2RkaS5oCmluZGV4IDU1ZmQ3MmI5MDFmZS4uZGU0Y2Q4NzdjMDAyIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2RkaS5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmgKQEAgLTE3LDcgKzE3LDggQEAgc3RydWN0IGlu
dGVsX2RwOwogc3RydWN0IGludGVsX2RwbGxfaHdfc3RhdGU7CiBzdHJ1Y3QgaW50ZWxfZW5jb2Rl
cjsKIAotdm9pZCBpbnRlbF9kZGlfZmRpX3Bvc3RfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqaW50ZWxfZW5jb2RlciwKK3ZvaWQgaW50ZWxfZGRpX2ZkaV9wb3N0X2Rpc2FibGUoc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJc3RydWN0IGludGVsX2VuY29kZXIgKmlu
dGVsX2VuY29kZXIsCiAJCQkJY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRj
X3N0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9z
dGF0ZSk7CiB2b2lkIGhzd19mZGlfbGlua190cmFpbihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlz
cGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKaW5k
ZXggMzkyNmFjOGYxZjEwLi44NGU1OWY2YWI4ZTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCkBAIC02Njg5LDcgKzY2ODksOCBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9lbmNvZGVyc19wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
ICpzdGF0ZSwKIAkJCWNvbnRpbnVlOwogCiAJCWlmIChlbmNvZGVyLT5wcmVfcGxsX2VuYWJsZSkK
LQkJCWVuY29kZXItPnByZV9wbGxfZW5hYmxlKGVuY29kZXIsIGNydGNfc3RhdGUsIGNvbm5fc3Rh
dGUpOworCQkJZW5jb2Rlci0+cHJlX3BsbF9lbmFibGUoc3RhdGUsIGVuY29kZXIsCisJCQkJCQlj
cnRjX3N0YXRlLCBjb25uX3N0YXRlKTsKIAl9CiB9CiAKQEAgLTY3MTAsNyArNjcxMSw4IEBAIHN0
YXRpYyB2b2lkIGludGVsX2VuY29kZXJzX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUsCiAJCQljb250aW51ZTsKIAogCQlpZiAoZW5jb2Rlci0+cHJlX2VuYWJsZSkK
LQkJCWVuY29kZXItPnByZV9lbmFibGUoZW5jb2RlciwgY3J0Y19zdGF0ZSwgY29ubl9zdGF0ZSk7
CisJCQllbmNvZGVyLT5wcmVfZW5hYmxlKHN0YXRlLCBlbmNvZGVyLAorCQkJCQkgICAgY3J0Y19z
dGF0ZSwgY29ubl9zdGF0ZSk7CiAJfQogfQogCkBAIC02NzMxLDcgKzY3MzMsOCBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9lbmNvZGVyc19lbmFibGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3Rh
dGUsCiAJCQljb250aW51ZTsKIAogCQlpZiAoZW5jb2Rlci0+ZW5hYmxlKQotCQkJZW5jb2Rlci0+
ZW5hYmxlKGVuY29kZXIsIGNydGNfc3RhdGUsIGNvbm5fc3RhdGUpOworCQkJZW5jb2Rlci0+ZW5h
YmxlKHN0YXRlLCBlbmNvZGVyLAorCQkJCQljcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsKIAkJaW50
ZWxfb3ByZWdpb25fbm90aWZ5X2VuY29kZXIoZW5jb2RlciwgdHJ1ZSk7CiAJfQogfQpAQCAtNjc1
NCw3ICs2NzU3LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5jb2RlcnNfZGlzYWJsZShzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKIAogCQlpbnRlbF9vcHJlZ2lvbl9ub3RpZnlfZW5j
b2RlcihlbmNvZGVyLCBmYWxzZSk7CiAJCWlmIChlbmNvZGVyLT5kaXNhYmxlKQotCQkJZW5jb2Rl
ci0+ZGlzYWJsZShlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5fc3RhdGUpOworCQkJ
ZW5jb2Rlci0+ZGlzYWJsZShzdGF0ZSwgZW5jb2RlciwKKwkJCQkJIG9sZF9jcnRjX3N0YXRlLCBv
bGRfY29ubl9zdGF0ZSk7CiAJfQogfQogCkBAIC02Nzc1LDcgKzY3NzksOCBAQCBzdGF0aWMgdm9p
ZCBpbnRlbF9lbmNvZGVyc19wb3N0X2Rpc2FibGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUsCiAJCQljb250aW51ZTsKIAogCQlpZiAoZW5jb2Rlci0+cG9zdF9kaXNhYmxlKQotCQkJ
ZW5jb2Rlci0+cG9zdF9kaXNhYmxlKGVuY29kZXIsIG9sZF9jcnRjX3N0YXRlLCBvbGRfY29ubl9z
dGF0ZSk7CisJCQllbmNvZGVyLT5wb3N0X2Rpc2FibGUoc3RhdGUsIGVuY29kZXIsCisJCQkJCSAg
ICAgIG9sZF9jcnRjX3N0YXRlLCBvbGRfY29ubl9zdGF0ZSk7CiAJfQogfQogCkBAIC02Nzk2LDcg
KzY4MDEsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9lbmNvZGVyc19wb3N0X3BsbF9kaXNhYmxlKHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAogCQkJY29udGludWU7CiAKIAkJaWYgKGVu
Y29kZXItPnBvc3RfcGxsX2Rpc2FibGUpCi0JCQllbmNvZGVyLT5wb3N0X3BsbF9kaXNhYmxlKGVu
Y29kZXIsIG9sZF9jcnRjX3N0YXRlLCBvbGRfY29ubl9zdGF0ZSk7CisJCQllbmNvZGVyLT5wb3N0
X3BsbF9kaXNhYmxlKHN0YXRlLCBlbmNvZGVyLAorCQkJCQkJICBvbGRfY3J0Y19zdGF0ZSwgb2xk
X2Nvbm5fc3RhdGUpOwogCX0KIH0KIApAQCAtNjgxNyw3ICs2ODIzLDggQEAgc3RhdGljIHZvaWQg
aW50ZWxfZW5jb2RlcnNfdXBkYXRlX3BpcGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3Rh
dGUsCiAJCQljb250aW51ZTsKIAogCQlpZiAoZW5jb2Rlci0+dXBkYXRlX3BpcGUpCi0JCQllbmNv
ZGVyLT51cGRhdGVfcGlwZShlbmNvZGVyLCBjcnRjX3N0YXRlLCBjb25uX3N0YXRlKTsKKwkJCWVu
Y29kZXItPnVwZGF0ZV9waXBlKHN0YXRlLCBlbmNvZGVyLAorCQkJCQkgICAgIGNydGNfc3RhdGUs
IGNvbm5fc3RhdGUpOwogCX0KIH0KIApAQCAtMTgxMzMsMTEgKzE4MTQwLDEyIEBAIHN0YXRpYyB2
b2lkIGludGVsX3Nhbml0aXplX2VuY29kZXIoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIp
CiAJCQliZXN0X2VuY29kZXIgPSBjb25uZWN0b3ItPmJhc2Uuc3RhdGUtPmJlc3RfZW5jb2RlcjsK
IAkJCWNvbm5lY3Rvci0+YmFzZS5zdGF0ZS0+YmVzdF9lbmNvZGVyID0gJmVuY29kZXItPmJhc2U7
CiAKKwkJCS8qIEZJWE1FIE5VTEwgYXRvbWljIHN0YXRlIHBhc3NlZCEgKi8KIAkJCWlmIChlbmNv
ZGVyLT5kaXNhYmxlKQotCQkJCWVuY29kZXItPmRpc2FibGUoZW5jb2RlciwgY3J0Y19zdGF0ZSwK
KwkJCQllbmNvZGVyLT5kaXNhYmxlKE5VTEwsIGVuY29kZXIsIGNydGNfc3RhdGUsCiAJCQkJCQkg
Y29ubmVjdG9yLT5iYXNlLnN0YXRlKTsKIAkJCWlmIChlbmNvZGVyLT5wb3N0X2Rpc2FibGUpCi0J
CQkJZW5jb2Rlci0+cG9zdF9kaXNhYmxlKGVuY29kZXIsIGNydGNfc3RhdGUsCisJCQkJZW5jb2Rl
ci0+cG9zdF9kaXNhYmxlKE5VTEwsIGVuY29kZXIsIGNydGNfc3RhdGUsCiAJCQkJCQkgICAgICBj
b25uZWN0b3ItPmJhc2Uuc3RhdGUpOwogCiAJCQljb25uZWN0b3ItPmJhc2Uuc3RhdGUtPmJlc3Rf
ZW5jb2RlciA9IGJlc3RfZW5jb2RlcjsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKaW5kZXggNWUwMGU2MTFmMDc3Li5hZDM5Mzg2MjMx
ZDUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eV90eXBlcy5oCkBAIC0xNDYsMjggKzE0NiwzNSBAQCBzdHJ1Y3QgaW50ZWxfZW5jb2RlciB7CiAJ
dm9pZCAoKnVwZGF0ZV9wcmVwYXJlKShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICosCiAJCQkg
ICAgICAgc3RydWN0IGludGVsX2VuY29kZXIgKiwKIAkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfY3J0
YyAqKTsKLQl2b2lkICgqcHJlX3BsbF9lbmFibGUpKHN0cnVjdCBpbnRlbF9lbmNvZGVyICosCisJ
dm9pZCAoKnByZV9wbGxfZW5hYmxlKShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICosCisJCQkg
ICAgICAgc3RydWN0IGludGVsX2VuY29kZXIgKiwKIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqLAogCQkJICAgICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0
YXRlICopOwotCXZvaWQgKCpwcmVfZW5hYmxlKShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqLAorCXZv
aWQgKCpwcmVfZW5hYmxlKShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICosCisJCQkgICBzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqLAogCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KiwKIAkJCSAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICopOwotCXZvaWQgKCpl
bmFibGUpKHN0cnVjdCBpbnRlbF9lbmNvZGVyICosCisJdm9pZCAoKmVuYWJsZSkoc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqLAorCQkgICAgICAgc3RydWN0IGludGVsX2VuY29kZXIgKiwKIAkJ
ICAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICosCiAJCSAgICAgICBjb25zdCBz
dHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqKTsKIAl2b2lkICgqdXBkYXRlX2NvbXBsZXRlKShz
dHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICosCiAJCQkJc3RydWN0IGludGVsX2VuY29kZXIgKiwK
IAkJCQlzdHJ1Y3QgaW50ZWxfY3J0YyAqKTsKLQl2b2lkICgqZGlzYWJsZSkoc3RydWN0IGludGVs
X2VuY29kZXIgKiwKKwl2b2lkICgqZGlzYWJsZSkoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
LAorCQkJc3RydWN0IGludGVsX2VuY29kZXIgKiwKIAkJCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICosCiAJCQljb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqKTsKLQl2b2lk
ICgqcG9zdF9kaXNhYmxlKShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqLAorCXZvaWQgKCpwb3N0X2Rp
c2FibGUpKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKiwKKwkJCSAgICAgc3RydWN0IGludGVs
X2VuY29kZXIgKiwKIAkJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKiwKIAkJ
CSAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKik7Ci0Jdm9pZCAoKnBvc3Rf
cGxsX2Rpc2FibGUpKHN0cnVjdCBpbnRlbF9lbmNvZGVyICosCisJdm9pZCAoKnBvc3RfcGxsX2Rp
c2FibGUpKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKiwKKwkJCQkgc3RydWN0IGludGVsX2Vu
Y29kZXIgKiwKIAkJCQkgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKiwKIAkJCQkgY29u
c3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKik7Ci0Jdm9pZCAoKnVwZGF0ZV9waXBlKShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqLAorCXZvaWQgKCp1cGRhdGVfcGlwZSkoc3RydWN0IGludGVs
X2F0b21pY19zdGF0ZSAqLAorCQkJICAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICosCiAJCQkgICAg
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKiwKIAkJCSAgICBjb25zdCBzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqKTsKIAkvKiBSZWFkIG91dCB0aGUgY3VycmVudCBodyBzdGF0ZSBv
ZiB0aGlzIGNvbm5lY3RvciwgcmV0dXJuaW5nIHRydWUgaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZHAuYwppbmRleCA4OWQ1NGY1ZmU2MGIuLmQ0YzE3YTVlOWJlMiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcC5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHAuYwpAQCAtMzM5Myw3ICszMzkzLDggQEAg
c3RhdGljIHZvaWQgaW50ZWxfZHBfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKIAl9CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfZHAoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX2RwKHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJICAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKIAkJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRj
X3N0YXRlLAogCQkJICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nv
bm5fc3RhdGUpCiB7CkBAIC0zNDEzLDIxICszNDE0LDI0IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rp
c2FibGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJaW50ZWxfZWRwX3BhbmVs
X29mZihpbnRlbF9kcCk7CiB9CiAKLXN0YXRpYyB2b2lkIGc0eF9kaXNhYmxlX2RwKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgZzR4X2Rpc2FibGVfZHAoc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKIAkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19z
dGF0ZSwKIAkJCSAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9z
dGF0ZSkKIHsKLQlpbnRlbF9kaXNhYmxlX2RwKGVuY29kZXIsIG9sZF9jcnRjX3N0YXRlLCBvbGRf
Y29ubl9zdGF0ZSk7CisJaW50ZWxfZGlzYWJsZV9kcChzdGF0ZSwgZW5jb2Rlciwgb2xkX2NydGNf
c3RhdGUsIG9sZF9jb25uX3N0YXRlKTsKIH0KIAotc3RhdGljIHZvaWQgdmx2X2Rpc2FibGVfZHAo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCB2bHZfZGlzYWJsZV9k
cChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCSAgIHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAogCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9s
ZF9jcnRjX3N0YXRlLAogCQkJICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9s
ZF9jb25uX3N0YXRlKQogewotCWludGVsX2Rpc2FibGVfZHAoZW5jb2Rlciwgb2xkX2NydGNfc3Rh
dGUsIG9sZF9jb25uX3N0YXRlKTsKKwlpbnRlbF9kaXNhYmxlX2RwKHN0YXRlLCBlbmNvZGVyLCBv
bGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5fc3RhdGUpOwogfQogCi1zdGF0aWMgdm9pZCBnNHhfcG9z
dF9kaXNhYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQg
ZzR4X3Bvc3RfZGlzYWJsZV9kcChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJ
CQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQljb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCiAJCQkJY29uc3Qgc3RydWN0IGRybV9jb25uZWN0
b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQogewpAQCAtMzQ0NywxNCArMzQ1MSwxNiBAQCBzdGF0
aWMgdm9pZCBnNHhfcG9zdF9kaXNhYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAogCQlpbGtfZWRwX3BsbF9vZmYoaW50ZWxfZHAsIG9sZF9jcnRjX3N0YXRlKTsKIH0KIAotc3Rh
dGljIHZvaWQgdmx2X3Bvc3RfZGlzYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKK3N0YXRpYyB2b2lkIHZsdl9wb3N0X2Rpc2FibGVfZHAoc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUsCisJCQkJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJCWNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsKIAlpbnRlbF9kcF9s
aW5rX2Rvd24oZW5jb2Rlciwgb2xkX2NydGNfc3RhdGUpOwogfQogCi1zdGF0aWMgdm9pZCBjaHZf
cG9zdF9kaXNhYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZv
aWQgY2h2X3Bvc3RfZGlzYWJsZV9kcChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwK
KwkJCQlzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQljb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCiAJCQkJY29uc3Qgc3RydWN0IGRybV9jb25u
ZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQogewpAQCAtMzU4MCw3ICszNTg2LDggQEAgc3Rh
dGljIHZvaWQgaW50ZWxfZHBfZW5hYmxlX3BvcnQoc3RydWN0IGludGVsX2RwICppbnRlbF9kcCwK
IAlpbnRlbF9kZV9wb3N0aW5nX3JlYWQoZGV2X3ByaXYsIGludGVsX2RwLT5vdXRwdXRfcmVnKTsK
IH0KIAotc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAorc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9hdG9taWNf
c3RhdGUgKnN0YXRlLAorCQkJICAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJ
ICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKIAkJCSAgICBj
b25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKQEAgLTM2MjYs
MjIgKzM2MzMsMjUgQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAogCX0KIH0KIAotc3RhdGljIHZvaWQgZzR4X2VuYWJsZV9kcChzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGc0eF9lbmFibGVfZHAoc3Ry
dWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkgIHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAogCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25m
aWcsCiAJCQkgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQog
ewotCWludGVsX2VuYWJsZV9kcChlbmNvZGVyLCBwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CisJ
aW50ZWxfZW5hYmxlX2RwKHN0YXRlLCBlbmNvZGVyLCBwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7
CiAJaW50ZWxfZWRwX2JhY2tsaWdodF9vbihwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CiB9CiAK
LXN0YXRpYyB2b2lkIHZsdl9lbmFibGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
CitzdGF0aWMgdm9pZCB2bHZfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0
YXRlLAorCQkJICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAogCQkJICBjb25zdCBzdHJ1Y3QgZHJt
X2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKIAlpbnRlbF9lZHBfYmFja2xpZ2h0X29u
KHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKIH0KIAotc3RhdGljIHZvaWQgZzR4X3ByZV9lbmFi
bGVfZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBnNHhfcHJl
X2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgIHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAogCQkJICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25u
ZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCiB7CkBAIC0zNzYxLDE2ICszNzcxLDE4IEBAIHN0YXRp
YyB2b2lkIHZsdl9pbml0X3BhbmVsX3Bvd2VyX3NlcXVlbmNlcihzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKIAlpbnRlbF9kcF9pbml0X3BhbmVsX3Bvd2VyX3NlcXVlbmNlcl9yZWdpc3Rl
cnMoaW50ZWxfZHAsIHRydWUpOwogfQogCi1zdGF0aWMgdm9pZCB2bHZfcHJlX2VuYWJsZV9kcChz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIHZsdl9wcmVfZW5hYmxl
X2RwKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJICAgICAgc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqcGlwZV9jb25maWcsCiAJCQkgICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqY29ubl9zdGF0ZSkKIHsKIAl2bHZfcGh5X3ByZV9lbmNvZGVyX2VuYWJsZShlbmNvZGVy
LCBwaXBlX2NvbmZpZyk7CiAKLQlpbnRlbF9lbmFibGVfZHAoZW5jb2RlciwgcGlwZV9jb25maWcs
IGNvbm5fc3RhdGUpOworCWludGVsX2VuYWJsZV9kcChzdGF0ZSwgZW5jb2RlciwgcGlwZV9jb25m
aWcsIGNvbm5fc3RhdGUpOwogfQogCi1zdGF0aWMgdm9pZCB2bHZfZHBfcHJlX3BsbF9lbmFibGUo
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCB2bHZfZHBfcHJlX3Bs
bF9lbmFibGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJICBzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpwaXBlX2NvbmZpZywKIAkJCQkgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRl
ICpjb25uX3N0YXRlKQogewpAQCAtMzc3OSwxOSArMzc5MSwyMSBAQCBzdGF0aWMgdm9pZCB2bHZf
ZHBfcHJlX3BsbF9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJdmx2X3Bo
eV9wcmVfcGxsX2VuYWJsZShlbmNvZGVyLCBwaXBlX2NvbmZpZyk7CiB9CiAKLXN0YXRpYyB2b2lk
IGNodl9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGlj
IHZvaWQgY2h2X3ByZV9lbmFibGVfZHAoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUs
CisJCQkgICAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgICAgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKIAkJCSAgICAgIGNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewogCWNodl9waHlfcHJlX2Vu
Y29kZXJfZW5hYmxlKGVuY29kZXIsIHBpcGVfY29uZmlnKTsKIAotCWludGVsX2VuYWJsZV9kcChl
bmNvZGVyLCBwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CisJaW50ZWxfZW5hYmxlX2RwKHN0YXRl
LCBlbmNvZGVyLCBwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CiAKIAkvKiBTZWNvbmQgY29tbW9u
IGxhbmUgd2lsbCBzdGF5IGFsaXZlIG9uIGl0cyBvd24gbm93ICovCiAJY2h2X3BoeV9yZWxlYXNl
X2NsMl9vdmVycmlkZShlbmNvZGVyKTsKIH0KIAotc3RhdGljIHZvaWQgY2h2X2RwX3ByZV9wbGxf
ZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgY2h2X2Rw
X3ByZV9wbGxfZW5hYmxlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJCSAg
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICBjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCiAJCQkJICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
cl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKQEAgLTM4MDAsNyArMzgxNCw4IEBAIHN0YXRpYyB2b2lk
IGNodl9kcF9wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlj
aHZfcGh5X3ByZV9wbGxfZW5hYmxlKGVuY29kZXIsIHBpcGVfY29uZmlnKTsKIH0KIAotc3RhdGlj
IHZvaWQgY2h2X2RwX3Bvc3RfcGxsX2Rpc2FibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29k
ZXIsCitzdGF0aWMgdm9pZCBjaHZfZHBfcG9zdF9wbGxfZGlzYWJsZShzdHJ1Y3QgaW50ZWxfYXRv
bWljX3N0YXRlICpzdGF0ZSwKKwkJCQkgICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
CiAJCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwK
IAkJCQkgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRl
KQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kcF9t
c3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHBfbXN0LmMKaW5kZXgg
YjlhZmMxMTM1YjliLi41ZjU0Y2MyZDZiNDAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZHBfbXN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlz
cGxheS9pbnRlbF9kcF9tc3QuYwpAQCAtMzE2LDcgKzMxNiw4IEBAIGludGVsX2RwX21zdF9hdG9t
aWNfY2hlY2soc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKIAlyZXR1cm4gcmV0Owog
fQogCi1zdGF0aWMgdm9pZCBpbnRlbF9tc3RfZGlzYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2Rl
ciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGludGVsX21zdF9kaXNhYmxlX2RwKHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJCSBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKIAkJCQkgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAog
CQkJCSBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7
CkBAIC0zNDAsNyArMzQxLDggQEAgc3RhdGljIHZvaWQgaW50ZWxfbXN0X2Rpc2FibGVfZHAoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJCSAgb2xkX2NydGNfc3RhdGUsIG9sZF9j
b25uX3N0YXRlKTsKIH0KIAotc3RhdGljIHZvaWQgaW50ZWxfbXN0X3Bvc3RfZGlzYWJsZV9kcChz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGludGVsX21zdF9wb3N0
X2Rpc2FibGVfZHAoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJICAgICAg
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICAgICAgY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJCSAgICAgIGNvbnN0IHN0cnVjdCBk
cm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsKQEAgLTQwNSwxMyArNDA3LDE0
IEBAIHN0YXRpYyB2b2lkIGludGVsX21zdF9wb3N0X2Rpc2FibGVfZHAoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCiAKIAlpbnRlbF9tc3QtPmNvbm5lY3RvciA9IE5VTEw7CiAJaWYgKGxh
c3RfbXN0X3N0cmVhbSkKLQkJaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9zdF9kaXNhYmxlKCZpbnRl
bF9kaWdfcG9ydC0+YmFzZSwKKwkJaW50ZWxfZGlnX3BvcnQtPmJhc2UucG9zdF9kaXNhYmxlKHN0
YXRlLCAmaW50ZWxfZGlnX3BvcnQtPmJhc2UsCiAJCQkJCQkgIG9sZF9jcnRjX3N0YXRlLCBOVUxM
KTsKIAogCURSTV9ERUJVR19LTVMoImFjdGl2ZSBsaW5rcyAlZFxuIiwgaW50ZWxfZHAtPmFjdGl2
ZV9tc3RfbGlua3MpOwogfQogCi1zdGF0aWMgdm9pZCBpbnRlbF9tc3RfcHJlX3BsbF9lbmFibGVf
ZHAoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBpbnRlbF9tc3Rf
cHJlX3BsbF9lbmFibGVfZHAoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJ
CXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCQljb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCiAJCQkJCWNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9y
X3N0YXRlICpjb25uX3N0YXRlKQogewpAQCAtNDIwLDExICs0MjMsMTIgQEAgc3RhdGljIHZvaWQg
aW50ZWxfbXN0X3ByZV9wbGxfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVy
LAogCXN0cnVjdCBpbnRlbF9kcCAqaW50ZWxfZHAgPSAmaW50ZWxfZGlnX3BvcnQtPmRwOwogCiAJ
aWYgKGludGVsX2RwLT5hY3RpdmVfbXN0X2xpbmtzID09IDApCi0JCWludGVsX2RpZ19wb3J0LT5i
YXNlLnByZV9wbGxfZW5hYmxlKCZpbnRlbF9kaWdfcG9ydC0+YmFzZSwKKwkJaW50ZWxfZGlnX3Bv
cnQtPmJhc2UucHJlX3BsbF9lbmFibGUoc3RhdGUsICZpbnRlbF9kaWdfcG9ydC0+YmFzZSwKIAkJ
CQkJCSAgICBwaXBlX2NvbmZpZywgTlVMTCk7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX21zdF9w
cmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQg
aW50ZWxfbXN0X3ByZV9lbmFibGVfZHAoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUs
CisJCQkJICAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSAgICBjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25maWcsCiAJCQkJICAgIGNvbnN0IHN0cnVj
dCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewpAQCAtNDU2LDcgKzQ2MCw3IEBA
IHN0YXRpYyB2b2lkIGludGVsX21zdF9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAogCWRybV9kcF9zZW5kX3Bvd2VyX3VwZG93bl9waHkoJmludGVsX2RwLT5tc3Rf
bWdyLCBjb25uZWN0b3ItPnBvcnQsIHRydWUpOwogCiAJaWYgKGZpcnN0X21zdF9zdHJlYW0pCi0J
CWludGVsX2RpZ19wb3J0LT5iYXNlLnByZV9lbmFibGUoJmludGVsX2RpZ19wb3J0LT5iYXNlLAor
CQlpbnRlbF9kaWdfcG9ydC0+YmFzZS5wcmVfZW5hYmxlKHN0YXRlLCAmaW50ZWxfZGlnX3BvcnQt
PmJhc2UsCiAJCQkJCQlwaXBlX2NvbmZpZywgTlVMTCk7CiAKIAlyZXQgPSBkcm1fZHBfbXN0X2Fs
bG9jYXRlX3ZjcGkoJmludGVsX2RwLT5tc3RfbWdyLApAQCAtNDg3LDcgKzQ5MSw4IEBAIHN0YXRp
YyB2b2lkIGludGVsX21zdF9wcmVfZW5hYmxlX2RwKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAogCWludGVsX2RwX3NldF9tX24ocGlwZV9jb25maWcsIE0xX04xKTsKIH0KIAotc3RhdGlj
IHZvaWQgaW50ZWxfbXN0X2VuYWJsZV9kcChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
K3N0YXRpYyB2b2lkIGludGVsX21zdF9lbmFibGVfZHAoc3RydWN0IGludGVsX2F0b21pY19zdGF0
ZSAqc3RhdGUsCisJCQkJc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAogCQkJCWNvbnN0IHN0cnVjdCBk
cm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kdm8uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZHZvLmMKaW5kZXggMzQxZDVjZThiMDYyLi41Y2QwOTAzNDUxOWIgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZHZvLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kdm8uYwpAQCAtMTgzLDcgKzE4Myw4IEBA
IHN0YXRpYyB2b2lkIGludGVsX2R2b19nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAogCXBpcGVfY29uZmlnLT5ody5hZGp1c3RlZF9tb2RlLmNydGNfY2xvY2sgPSBwaXBl
X2NvbmZpZy0+cG9ydF9jbG9jazsKIH0KIAotc3RhdGljIHZvaWQgaW50ZWxfZGlzYWJsZV9kdm8o
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxl
X2R2byhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgIHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0
b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQogewpAQCAtMTk3LDcgKzE5OCw4IEBAIHN0YXRpYyB2
b2lkIGludGVsX2Rpc2FibGVfZHZvKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCWlu
dGVsX2RlX3JlYWQoZGV2X3ByaXYsIGR2b19yZWcpOwogfQogCi1zdGF0aWMgdm9pZCBpbnRlbF9l
bmFibGVfZHZvKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgaW50
ZWxfZW5hYmxlX2R2byhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAg
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKIAkJCSAgICAgY29uc3Qgc3RydWN0IGRybV9jb25u
ZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCiB7CkBAIC0yNzIsNyArMjc0LDggQEAgc3RhdGljIGlu
dCBpbnRlbF9kdm9fY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX2R2b19wcmVfZW5hYmxlKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgaW50ZWxfZHZvX3ByZV9lbmFi
bGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJIHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAogCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlw
ZV9jb25maWcsCiAJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0
YXRlKQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9o
ZGNwLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkY3AuYwppbmRleCBl
ZTBmMjdlYTI4MTAuLjBlZDljNWQzM2Q3NSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9oZGNwLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxh
eS9pbnRlbF9oZGNwLmMKQEAgLTIwNzUsNyArMjA3NSw4IEBAIGludCBpbnRlbF9oZGNwX2Rpc2Fi
bGUoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yKQogCXJldHVybiByZXQ7CiB9CiAK
LXZvaWQgaW50ZWxfaGRjcF91cGRhdGVfcGlwZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKK3ZvaWQgaW50ZWxfaGRjcF91cGRhdGVfcGlwZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgICBj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCSAgICBjb25zdCBz
dHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRjcC5oIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9oZGNwLmgKaW5kZXggN2MxMmFkNjA5YjFmLi44NmJiYWVjMTIw
Y2MgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRjcC5o
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRjcC5oCkBAIC0xMSw2
ICsxMSw3IEBACiBzdHJ1Y3QgZHJtX2Nvbm5lY3RvcjsKIHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0
YXRlOwogc3RydWN0IGRybV9pOTE1X3ByaXZhdGU7CitzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
Owogc3RydWN0IGludGVsX2Nvbm5lY3RvcjsKIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlOwogc3Ry
dWN0IGludGVsX2VuY29kZXI7CkBAIC0yNiw3ICsyNyw4IEBAIGludCBpbnRlbF9oZGNwX2luaXQo
c3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVjdG9yLAogaW50IGludGVsX2hkY3BfZW5hYmxl
KHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKIAkJICAgICAgZW51bSB0cmFuc2Nv
ZGVyIGNwdV90cmFuc2NvZGVyLCB1OCBjb250ZW50X3R5cGUpOwogaW50IGludGVsX2hkY3BfZGlz
YWJsZShzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3IpOwotdm9pZCBpbnRlbF9oZGNw
X3VwZGF0ZV9waXBlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAordm9pZCBpbnRlbF9o
ZGNwX3VwZGF0ZV9waXBlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJICAg
IHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVj
dG9yX3N0YXRlICpjb25uX3N0YXRlKTsKIGJvb2wgaXNfaGRjcF9zdXBwb3J0ZWQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LCBlbnVtIHBvcnQgcG9ydCk7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWkuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfaGRtaS5jCmluZGV4IDM5OTMwMjMyYjI1My4uNDg0ZTA2N2Ix
MDBiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWku
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2hkbWkuYwpAQCAtMTg3
OCw3ICsxODc4LDggQEAgc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2hkbWlfYXVkaW8oc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJaW50ZWxfYXVkaW9fY29kZWNfZW5hYmxlKGVuY29k
ZXIsIHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKIH0KIAotc3RhdGljIHZvaWQgZzR4X2VuYWJs
ZV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgZzR4X2Vu
YWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJICAgIHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpwaXBlX2NvbmZpZywKIAkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqY29ubl9zdGF0ZSkKIHsKQEAgLTE5MDAsNyArMTkwMSw4IEBAIHN0YXRpYyB2b2lkIGc0
eF9lbmFibGVfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJaW50ZWxfZW5h
YmxlX2hkbWlfYXVkaW8oZW5jb2RlciwgcGlwZV9jb25maWcsIGNvbm5fc3RhdGUpOwogfQogCi1z
dGF0aWMgdm9pZCBpYnhfZW5hYmxlX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
CitzdGF0aWMgdm9pZCBpYnhfZW5hYmxlX2hkbWkoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUsCisJCQkgICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICAgY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAogCQkJICAgIGNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewpAQCAtMTk1MSw3ICsxOTUz
LDggQEAgc3RhdGljIHZvaWQgaWJ4X2VuYWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAogCQlpbnRlbF9lbmFibGVfaGRtaV9hdWRpbyhlbmNvZGVyLCBwaXBlX2NvbmZpZywg
Y29ubl9zdGF0ZSk7CiB9CiAKLXN0YXRpYyB2b2lkIGNwdF9lbmFibGVfaGRtaShzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGNwdF9lbmFibGVfaGRtaShzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKIAkJCSAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9jb25m
aWcsCiAJCQkgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUp
CiB7CkBAIC0yMDA0LDEzICsyMDA3LDE1IEBAIHN0YXRpYyB2b2lkIGNwdF9lbmFibGVfaGRtaShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJaW50ZWxfZW5hYmxlX2hkbWlfYXVkaW8o
ZW5jb2RlciwgcGlwZV9jb25maWcsIGNvbm5fc3RhdGUpOwogfQogCi1zdGF0aWMgdm9pZCB2bHZf
ZW5hYmxlX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCB2
bHZfZW5hYmxlX2hkbWkoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkgICAg
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICAgY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAogCQkJICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVj
dG9yX3N0YXRlICpjb25uX3N0YXRlKQogewogfQogCi1zdGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxl
X2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBpbnRlbF9k
aXNhYmxlX2hkbWkoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkgICAgICAg
c3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICAgICAgY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJICAgICAgIGNvbnN0IHN0cnVjdCBk
cm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsKQEAgLTIwNjgsNyArMjA3Myw4
IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKIAlpbnRlbF9kcF9kdWFsX21vZGVfc2V0X3RtZHNfb3V0cHV0KGludGVsX2hkbWks
IGZhbHNlKTsKIH0KIAotc3RhdGljIHZvaWQgZzR4X2Rpc2FibGVfaGRtaShzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGc0eF9kaXNhYmxlX2hkbWkoc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkgICAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICpl
bmNvZGVyLAogCQkJICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNf
c3RhdGUsCiAJCQkgICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29u
bl9zdGF0ZSkKIHsKQEAgLTIwNzYsMTAgKzIwODIsMTEgQEAgc3RhdGljIHZvaWQgZzR4X2Rpc2Fi
bGVfaGRtaShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJaW50ZWxfYXVkaW9fY29k
ZWNfZGlzYWJsZShlbmNvZGVyLAogCQkJCQkgIG9sZF9jcnRjX3N0YXRlLCBvbGRfY29ubl9zdGF0
ZSk7CiAKLQlpbnRlbF9kaXNhYmxlX2hkbWkoZW5jb2Rlciwgb2xkX2NydGNfc3RhdGUsIG9sZF9j
b25uX3N0YXRlKTsKKwlpbnRlbF9kaXNhYmxlX2hkbWkoc3RhdGUsIGVuY29kZXIsIG9sZF9jcnRj
X3N0YXRlLCBvbGRfY29ubl9zdGF0ZSk7CiB9CiAKLXN0YXRpYyB2b2lkIHBjaF9kaXNhYmxlX2hk
bWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBwY2hfZGlzYWJs
ZV9oZG1pKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJICAgICBzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
cl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7CkBAIC0yMDg4LDExICsyMDk1LDEyIEBAIHN0YXRp
YyB2b2lkIHBjaF9kaXNhYmxlX2hkbWkoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJ
CQkJCSAgb2xkX2NydGNfc3RhdGUsIG9sZF9jb25uX3N0YXRlKTsKIH0KIAotc3RhdGljIHZvaWQg
cGNoX3Bvc3RfZGlzYWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3Rh
dGljIHZvaWQgcGNoX3Bvc3RfZGlzYWJsZV9oZG1pKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUg
KnN0YXRlLAorCQkJCSAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICBjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCiAJCQkJICBjb25zdCBz
dHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7Ci0JaW50ZWxfZGlz
YWJsZV9oZG1pKGVuY29kZXIsIG9sZF9jcnRjX3N0YXRlLCBvbGRfY29ubl9zdGF0ZSk7CisJaW50
ZWxfZGlzYWJsZV9oZG1pKHN0YXRlLCBlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5f
c3RhdGUpOwogfQogCiBzdGF0aWMgaW50IGludGVsX2hkbWlfc291cmNlX21heF90bWRzX2Nsb2Nr
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQpAQCAtMjQ3NCw3ICsyNDgyLDggQEAgaW50
IGludGVsX2hkbWlfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
CiAJCX0KIAl9CiAKLQlpbnRlbF9oZG1pX2NvbXB1dGVfZ2NwX2luZm9mcmFtZShlbmNvZGVyLCBw
aXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CisJaW50ZWxfaGRtaV9jb21wdXRlX2djcF9pbmZvZnJh
bWUoZW5jb2RlciwgcGlwZV9jb25maWcsCisJCQkJCSBjb25uX3N0YXRlKTsKIAogCWlmICghaW50
ZWxfaGRtaV9jb21wdXRlX2F2aV9pbmZvZnJhbWUoZW5jb2RlciwgcGlwZV9jb25maWcsIGNvbm5f
c3RhdGUpKSB7CiAJCURSTV9ERUJVR19LTVMoImJhZCBBVkkgaW5mb2ZyYW1lXG4iKTsKQEAgLTI2
NjQsNyArMjY3Myw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfaGRtaV9nZXRfbW9kZXMoc3RydWN0IGRy
bV9jb25uZWN0b3IgKmNvbm5lY3RvcikKIAlyZXR1cm4gaW50ZWxfY29ubmVjdG9yX3VwZGF0ZV9t
b2Rlcyhjb25uZWN0b3IsIGVkaWQpOwogfQogCi1zdGF0aWMgdm9pZCBpbnRlbF9oZG1pX3ByZV9l
bmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBpbnRlbF9o
ZG1pX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJICBz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9j
cnRjX3N0YXRlICpwaXBlX2NvbmZpZywKIAkJCQkgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9y
X3N0YXRlICpjb25uX3N0YXRlKQogewpAQCAtMjY3OCw3ICsyNjg4LDggQEAgc3RhdGljIHZvaWQg
aW50ZWxfaGRtaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJ
CSAgICAgICBwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CiB9CiAKLXN0YXRpYyB2b2lkIHZsdl9o
ZG1pX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9p
ZCB2bHZfaGRtaV9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAor
CQkJCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCWNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKIAkJCQljb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
cl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKQEAgLTI2OTUsMTIgKzI3MDYsMTMgQEAgc3RhdGljIHZv
aWQgdmx2X2hkbWlfcHJlX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJ
CSAgICAgIHBpcGVfY29uZmlnLT5oYXNfaW5mb2ZyYW1lLAogCQkJICAgICAgcGlwZV9jb25maWcs
IGNvbm5fc3RhdGUpOwogCi0JZzR4X2VuYWJsZV9oZG1pKGVuY29kZXIsIHBpcGVfY29uZmlnLCBj
b25uX3N0YXRlKTsKKwlnNHhfZW5hYmxlX2hkbWkoc3RhdGUsIGVuY29kZXIsIHBpcGVfY29uZmln
LCBjb25uX3N0YXRlKTsKIAogCXZsdl93YWl0X3BvcnRfcmVhZHkoZGV2X3ByaXYsIGRwb3J0LCAw
eDApOwogfQogCi1zdGF0aWMgdm9pZCB2bHZfaGRtaV9wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIHZsdl9oZG1pX3ByZV9wbGxfZW5hYmxl
KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJCSAgICBzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKIAkJCQkgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
KnBpcGVfY29uZmlnLAogCQkJCSAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSkKIHsKQEAgLTI3MDksNyArMjcyMSw4IEBAIHN0YXRpYyB2b2lkIHZsdl9oZG1p
X3ByZV9wbGxfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCXZsdl9waHlf
cHJlX3BsbF9lbmFibGUoZW5jb2RlciwgcGlwZV9jb25maWcpOwogfQogCi1zdGF0aWMgdm9pZCBj
aHZfaGRtaV9wcmVfcGxsX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0
YXRpYyB2b2lkIGNodl9oZG1pX3ByZV9wbGxfZW5hYmxlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3Rh
dGUgKnN0YXRlLAorCQkJCSAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCQkg
ICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29uZmlnLAogCQkJCSAgICBj
b25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKQEAgLTI3MTgs
MTQgKzI3MzEsMTYgQEAgc3RhdGljIHZvaWQgY2h2X2hkbWlfcHJlX3BsbF9lbmFibGUoc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJY2h2X3BoeV9wcmVfcGxsX2VuYWJsZShlbmNvZGVy
LCBwaXBlX2NvbmZpZyk7CiB9CiAKLXN0YXRpYyB2b2lkIGNodl9oZG1pX3Bvc3RfcGxsX2Rpc2Fi
bGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBjaHZfaGRtaV9w
b3N0X3BsbF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJCSAg
ICAgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSAgICAgIGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKIAkJCQkgICAgICBjb25zdCBzdHJ1
Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7CiAJY2h2X3BoeV9wb3N0
X3BsbF9kaXNhYmxlKGVuY29kZXIsIG9sZF9jcnRjX3N0YXRlKTsKIH0KIAotc3RhdGljIHZvaWQg
dmx2X2hkbWlfcG9zdF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3Rh
dGljIHZvaWQgdmx2X2hkbWlfcG9zdF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUg
KnN0YXRlLAorCQkJCSAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICBjb25z
dCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCiAJCQkJICBjb25zdCBz
dHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7CkBAIC0yNzMzLDcg
KzI3NDgsOCBAQCBzdGF0aWMgdm9pZCB2bHZfaGRtaV9wb3N0X2Rpc2FibGUoc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCiAJdmx2X3BoeV9yZXNldF9sYW5lcyhlbmNvZGVyLCBvbGRfY3J0
Y19zdGF0ZSk7CiB9CiAKLXN0YXRpYyB2b2lkIGNodl9oZG1pX3Bvc3RfZGlzYWJsZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGNodl9oZG1pX3Bvc3RfZGlzYWJs
ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCQkgIHN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAogCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9s
ZF9jcnRjX3N0YXRlLAogCQkJCSAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9s
ZF9jb25uX3N0YXRlKQogewpAQCAtMjc0OCw3ICsyNzY0LDggQEAgc3RhdGljIHZvaWQgY2h2X2hk
bWlfcG9zdF9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCXZsdl9kcGlv
X3B1dChkZXZfcHJpdik7CiB9CiAKLXN0YXRpYyB2b2lkIGNodl9oZG1pX3ByZV9lbmFibGUoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBjaHZfaGRtaV9wcmVfZW5h
YmxlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAorCQkJCXN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyLAogCQkJCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpwaXBl
X2NvbmZpZywKIAkJCQljb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0
ZSkKIHsKQEAgLTI3NjYsNyArMjc4Myw3IEBAIHN0YXRpYyB2b2lkIGNodl9oZG1pX3ByZV9lbmFi
bGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICAgICBwaXBlX2NvbmZpZy0+
aGFzX2luZm9mcmFtZSwKIAkJCSAgICAgIHBpcGVfY29uZmlnLCBjb25uX3N0YXRlKTsKIAotCWc0
eF9lbmFibGVfaGRtaShlbmNvZGVyLCBwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CisJZzR4X2Vu
YWJsZV9oZG1pKHN0YXRlLCBlbmNvZGVyLCBwaXBlX2NvbmZpZywgY29ubl9zdGF0ZSk7CiAKIAl2
bHZfd2FpdF9wb3J0X3JlYWR5KGRldl9wcml2LCBkcG9ydCwgMHgwKTsKIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9sdmRzLmMgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX2x2ZHMuYwppbmRleCA5YTA2N2VmZmNmYTAuLmZlNTkxZjgy
MTYzZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9sdmRz
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9sdmRzLmMKQEAgLTIy
MCw3ICsyMjAsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9sdmRzX3Bwc19pbml0X2h3KHN0cnVjdCBk
cm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJICAgICAgIFJFR19GSUVMRF9QUkVQKFBQX1JF
RkVSRU5DRV9ESVZJREVSX01BU0ssIHBwcy0+ZGl2aWRlcikgfCBSRUdfRklFTERfUFJFUChQQU5F
TF9QT1dFUl9DWUNMRV9ERUxBWV9NQVNLLCBESVZfUk9VTkRfVVAocHBzLT50NCwgMTAwMCkgKyAx
KSk7CiB9CiAKLXN0YXRpYyB2b2lkIGludGVsX3ByZV9lbmFibGVfbHZkcyhzdHJ1Y3QgaW50ZWxf
ZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGludGVsX3ByZV9lbmFibGVfbHZkcyhzdHJ1
Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCQkgIHN0cnVjdCBpbnRlbF9lbmNvZGVy
ICplbmNvZGVyLAogCQkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBpcGVfY29u
ZmlnLAogCQkJCSAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUp
CiB7CkBAIC0zMDEsNyArMzAyLDggQEAgc3RhdGljIHZvaWQgaW50ZWxfcHJlX2VuYWJsZV9sdmRz
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogLyoKICAqIFNldHMgdGhlIHBvd2VyIHN0
YXRlIGZvciB0aGUgcGFuZWwuCiAgKi8KLXN0YXRpYyB2b2lkIGludGVsX2VuYWJsZV9sdmRzKHN0
cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX2x2
ZHMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkgICAgICBzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0
YXRlICpwaXBlX2NvbmZpZywKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0
YXRlICpjb25uX3N0YXRlKQogewpAQCAtMzIzLDcgKzMyNSw4IEBAIHN0YXRpYyB2b2lkIGludGVs
X2VuYWJsZV9sdmRzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCWludGVsX3BhbmVs
X2VuYWJsZV9iYWNrbGlnaHQocGlwZV9jb25maWcsIGNvbm5fc3RhdGUpOwogfQogCi1zdGF0aWMg
dm9pZCBpbnRlbF9kaXNhYmxlX2x2ZHMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitz
dGF0aWMgdm9pZCBpbnRlbF9kaXNhYmxlX2x2ZHMoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUsCisJCQkgICAgICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICAg
ICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJICAg
ICAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsK
QEAgLTM0MSwyOCArMzQ0LDMxIEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfbHZkcyhzdHJ1
Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlpbnRlbF9kZV9wb3N0aW5nX3JlYWQoZGV2X3By
aXYsIGx2ZHNfZW5jb2Rlci0+cmVnKTsKIH0KIAotc3RhdGljIHZvaWQgZ21jaF9kaXNhYmxlX2x2
ZHMoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBnbWNoX2Rpc2Fi
bGVfbHZkcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgIHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25u
ZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQogCiB7CiAJaW50ZWxfcGFuZWxfZGlzYWJsZV9i
YWNrbGlnaHQob2xkX2Nvbm5fc3RhdGUpOwogCi0JaW50ZWxfZGlzYWJsZV9sdmRzKGVuY29kZXIs
IG9sZF9jcnRjX3N0YXRlLCBvbGRfY29ubl9zdGF0ZSk7CisJaW50ZWxfZGlzYWJsZV9sdmRzKHN0
YXRlLCBlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5fc3RhdGUpOwogfQogCi1zdGF0
aWMgdm9pZCBwY2hfZGlzYWJsZV9sdmRzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAor
c3RhdGljIHZvaWQgcGNoX2Rpc2FibGVfbHZkcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpz
dGF0ZSwKKwkJCSAgICAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkgICAgIGNv
bnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKIAkJCSAgICAgY29u
c3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQogewogCWludGVs
X3BhbmVsX2Rpc2FibGVfYmFja2xpZ2h0KG9sZF9jb25uX3N0YXRlKTsKIH0KIAotc3RhdGljIHZv
aWQgcGNoX3Bvc3RfZGlzYWJsZV9sdmRzKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAor
c3RhdGljIHZvaWQgcGNoX3Bvc3RfZGlzYWJsZV9sdmRzKHN0cnVjdCBpbnRlbF9hdG9taWNfc3Rh
dGUgKnN0YXRlLAorCQkJCSAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICBj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3RhdGUsCiAJCQkJICBjb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7Ci0JaW50ZWxf
ZGlzYWJsZV9sdmRzKGVuY29kZXIsIG9sZF9jcnRjX3N0YXRlLCBvbGRfY29ubl9zdGF0ZSk7CisJ
aW50ZWxfZGlzYWJsZV9sdmRzKHN0YXRlLCBlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nv
bm5fc3RhdGUpOwogfQogCiBzdGF0aWMgZW51bSBkcm1fbW9kZV9zdGF0dXMKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuYwppbmRleCAyNzZmNDM4NzA4MDIuLmY4Y2Nm
ZTY3NDI5ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9w
YW5lbC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfcGFuZWwuYwpA
QCAtMTkzMSw3ICsxOTMxLDggQEAgc3RhdGljIGludCBwd21fc2V0dXBfYmFja2xpZ2h0KHN0cnVj
dCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3RvciwKIAlyZXR1cm4gMDsKIH0KIAotdm9pZCBpbnRl
bF9wYW5lbF91cGRhdGVfYmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAor
dm9pZCBpbnRlbF9wYW5lbF91cGRhdGVfYmFja2xpZ2h0KHN0cnVjdCBpbnRlbF9hdG9taWNfc3Rh
dGUgKnN0YXRlLAorCQkJCSAgc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICBj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCQkgIGNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlKQogewpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wYW5lbC5oIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9wYW5lbC5oCmluZGV4IGNlZGVlYTQ0MzMzNi4uMTFmMmY2YjYy
OGQ4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3BhbmVs
LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9wYW5lbC5oCkBAIC0z
Nyw3ICszNyw4IEBAIGludCBpbnRlbF9wYW5lbF9zZXR1cF9iYWNrbGlnaHQoc3RydWN0IGRybV9j
b25uZWN0b3IgKmNvbm5lY3RvciwKIAkJCQllbnVtIHBpcGUgcGlwZSk7CiB2b2lkIGludGVsX3Bh
bmVsX2VuYWJsZV9iYWNrbGlnaHQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCiAJCQkJICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqY29ubl9zdGF0
ZSk7Ci12b2lkIGludGVsX3BhbmVsX3VwZGF0ZV9iYWNrbGlnaHQoc3RydWN0IGludGVsX2VuY29k
ZXIgKmVuY29kZXIsCit2b2lkIGludGVsX3BhbmVsX3VwZGF0ZV9iYWNrbGlnaHQoc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKIAkJCQkgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAog
CQkJCSAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpOwogdm9p
ZCBpbnRlbF9wYW5lbF9kaXNhYmxlX2JhY2tsaWdodChjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
cl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9zZHZvLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX3Nkdm8uYwppbmRleCA2MzdkOGZlMmY4YzIuLmU2MzA2Y2JiN2EzYSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zZHZvLmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9zZHZvLmMKQEAgLTE0MzAsNyArMTQzMCw4IEBAIHN0
YXRpYyB2b2lkIGludGVsX3Nkdm9fdXBkYXRlX3Byb3BzKHN0cnVjdCBpbnRlbF9zZHZvICppbnRl
bF9zZHZvLAogI3VuZGVmIFVQREFURV9QUk9QRVJUWQogfQogCi1zdGF0aWMgdm9pZCBpbnRlbF9z
ZHZvX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmludGVsX2VuY29kZXIsCitzdGF0
aWMgdm9pZCBpbnRlbF9zZHZvX3ByZV9lbmFibGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
c3RhdGUsCisJCQkJICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqaW50ZWxfZW5jb2RlciwKIAkJCQkg
IGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJCSAgY29uc3Qg
c3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCiB7CkBAIC0xNzI3LDcgKzE3
MjgsOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9zZHZvX2VuYWJsZV9hdWRpbyhzdHJ1Y3QgaW50ZWxf
c2R2byAqaW50ZWxfc2R2bywKIAkJCQkgICBTRFZPX0FVRElPX1BSRVNFTkNFX0RFVEVDVCk7CiB9
CiAKLXN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfc2R2byhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAq
ZW5jb2RlciwKK3N0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVfc2R2byhzdHJ1Y3QgaW50ZWxfYXRv
bWljX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKIAkJCSAgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqb2xkX2NydGNfc3Rh
dGUsCiAJCQkgICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5fc3Rh
dGUpCiB7CkBAIC0xNzc1LDIwICsxNzc3LDIzIEBAIHN0YXRpYyB2b2lkIGludGVsX2Rpc2FibGVf
c2R2byhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAl9CiB9CiAKLXN0YXRpYyB2b2lk
IHBjaF9kaXNhYmxlX3Nkdm8oc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMg
dm9pZCBwY2hfZGlzYWJsZV9zZHZvKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAor
CQkJICAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgICAgY29uc3Qgc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJICAgICBjb25zdCBzdHJ1
Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUpCiB7CiB9CiAKLXN0YXRpYyB2
b2lkIHBjaF9wb3N0X2Rpc2FibGVfc2R2byhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwK
K3N0YXRpYyB2b2lkIHBjaF9wb3N0X2Rpc2FibGVfc2R2byhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICpzdGF0ZSwKKwkJCQkgIHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCSAg
Y29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlLAogCQkJCSAgY29u
c3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm9sZF9jb25uX3N0YXRlKQogewotCWludGVs
X2Rpc2FibGVfc2R2byhlbmNvZGVyLCBvbGRfY3J0Y19zdGF0ZSwgb2xkX2Nvbm5fc3RhdGUpOwor
CWludGVsX2Rpc2FibGVfc2R2byhzdGF0ZSwgZW5jb2Rlciwgb2xkX2NydGNfc3RhdGUsIG9sZF9j
b25uX3N0YXRlKTsKIH0KIAotc3RhdGljIHZvaWQgaW50ZWxfZW5hYmxlX3Nkdm8oc3RydWN0IGlu
dGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMgdm9pZCBpbnRlbF9lbmFibGVfc2R2byhzdHJ1
Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgIHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAogCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKnBp
cGVfY29uZmlnLAogCQkJICAgICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNv
bm5fc3RhdGUpCiB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX3R2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX3R2LmMKaW5kZXgg
ZDJlM2EzYTMyM2U5Li5iNjAwM2ZjOWUyNjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfdHYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5
L2ludGVsX3R2LmMKQEAgLTkxNCw3ICs5MTQsOCBAQCBpbnRlbF90dl9nZXRfaHdfc3RhdGUoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsIGVudW0gcGlwZSAqcGlwZSkKIH0KIAogc3RhdGlj
IHZvaWQKLWludGVsX2VuYWJsZV90dihzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK2lu
dGVsX2VuYWJsZV90dihzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKKwkJc3RydWN0
IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCWNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpwaXBlX2NvbmZpZywKIAkJY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5f
c3RhdGUpCiB7CkBAIC05MzAsNyArOTMxLDggQEAgaW50ZWxfZW5hYmxlX3R2KHN0cnVjdCBpbnRl
bF9lbmNvZGVyICplbmNvZGVyLAogfQogCiBzdGF0aWMgdm9pZAotaW50ZWxfZGlzYWJsZV90dihz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK2ludGVsX2Rpc2FibGVfdHYoc3RydWN0IGlu
dGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCSBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKIAkJIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKIAkJ
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsKQEAg
LTE0MTQsNyArMTQxNiw4IEBAIHN0YXRpYyB2b2lkIHNldF9jb2xvcl9jb252ZXJzaW9uKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKIAkJICAgICAgIChjb2xvcl9jb252ZXJzaW9u
LT5idiA8PCAxNikgfCBjb2xvcl9jb252ZXJzaW9uLT5hdik7CiB9CiAKLXN0YXRpYyB2b2lkIGlu
dGVsX3R2X3ByZV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCitzdGF0aWMg
dm9pZCBpbnRlbF90dl9wcmVfZW5hYmxlKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
LAorCQkJCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJCWNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpwaXBlX2NvbmZpZywKIAkJCQljb25zdCBzdHJ1Y3QgZHJtX2Nvbm5l
Y3Rvcl9zdGF0ZSAqY29ubl9zdGF0ZSkKIHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvdmx2X2RzaS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS92bHZf
ZHNpLmMKaW5kZXggZjRjMzYyZGM2ZTE1Li5hMjc3ZDdkNmIzYmYgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvdmx2X2RzaS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvdmx2X2RzaS5jCkBAIC03NTksNyArNzU5LDggQEAgc3RhdGljIHZvaWQgaW50
ZWxfZHNpX3VucHJlcGFyZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rlcik7CiAgKiBEU0kg
cG9ydCBlbmFibGUgaGFzIHRvIGJlIGRvbmUgYmVmb3JlIHBpcGUgYW5kIHBsYW5lIGVuYWJsZSwg
c28gd2UgZG8gaXQgaW4KICAqIHRoZSBwcmVfZW5hYmxlIGhvb2sgaW5zdGVhZCBvZiB0aGUgZW5h
YmxlIGhvb2suCiAgKi8KLXN0YXRpYyB2b2lkIGludGVsX2RzaV9wcmVfZW5hYmxlKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZvaWQgaW50ZWxfZHNpX3ByZV9lbmFibGUo
c3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJIHN0cnVjdCBpbnRlbF9lbmNv
ZGVyICplbmNvZGVyLAogCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqcGlwZV9j
b25maWcsCiAJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRl
KQogewpAQCAtODU4LDcgKzg1OSw4IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzaV9wcmVfZW5hYmxl
KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCWludGVsX2RzaV92YnRfZXhlY19zZXF1
ZW5jZShpbnRlbF9kc2ksIE1JUElfU0VRX0JBQ0tMSUdIVF9PTik7CiB9CiAKLXN0YXRpYyB2b2lk
IGJ4dF9kc2lfZW5hYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGljIHZv
aWQgYnh0X2RzaV9lbmFibGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkg
ICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgIGNvbnN0IHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAogCQkJICAgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0
b3Jfc3RhdGUgKmNvbm5fc3RhdGUpCiB7CkBAIC04NzEsNyArODczLDggQEAgc3RhdGljIHZvaWQg
Ynh0X2RzaV9lbmFibGUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAgKiBEU0kgcG9y
dCBkaXNhYmxlIGhhcyB0byBiZSBkb25lIGFmdGVyIHBpcGUgYW5kIHBsYW5lIGRpc2FibGUsIHNv
IHdlIGRvIGl0IGluCiAgKiB0aGUgcG9zdF9kaXNhYmxlIGhvb2suCiAgKi8KLXN0YXRpYyB2b2lk
IGludGVsX2RzaV9kaXNhYmxlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAorc3RhdGlj
IHZvaWQgaW50ZWxfZHNpX2Rpc2FibGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUs
CisJCQkgICAgICBzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAkJCSAgICAgIGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpvbGRfY3J0Y19zdGF0ZSwKIAkJCSAgICAgIGNvbnN0
IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpvbGRfY29ubl9zdGF0ZSkKIHsKQEAgLTkwNiw3
ICs5MDksOCBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2lfY2xlYXJfZGV2aWNlX3JlYWR5KHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyKQogCQl2bHZfZHNpX2NsZWFyX2RldmljZV9yZWFkeShl
bmNvZGVyKTsKIH0KIAotc3RhdGljIHZvaWQgaW50ZWxfZHNpX3Bvc3RfZGlzYWJsZShzdHJ1Y3Qg
aW50ZWxfZW5jb2RlciAqZW5jb2RlciwKK3N0YXRpYyB2b2lkIGludGVsX2RzaV9wb3N0X2Rpc2Fi
bGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCisJCQkJICAgc3RydWN0IGludGVs
X2VuY29kZXIgKmVuY29kZXIsCiAJCQkJICAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUg
Km9sZF9jcnRjX3N0YXRlLAogCQkJCSAgIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRl
ICpvbGRfY29ubl9zdGF0ZSkKIHsKLS0gCjIuMjQuMQoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id A38BDC34FB
	for <lists+intel-gfx@lfdr.de>; Tue,  1 Oct 2019 14:59:19 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 903956E787;
	Tue,  1 Oct 2019 12:59:17 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CFF3C6E787
 for <intel-gfx@lists.freedesktop.org>; Tue,  1 Oct 2019 12:59:16 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga008.fm.intel.com ([10.253.24.58])
 by fmsmga104.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 01 Oct 2019 05:59:16 -0700
X-IronPort-AV: E=Sophos;i="5.64,571,1559545200"; d="scan'208";a="190584645"
Received: from paaron-mobl.ger.corp.intel.com (HELO [10.251.93.134])
 ([10.251.93.134])
 by fmsmga008-auth.fm.intel.com with ESMTP/TLS/AES256-SHA;
 01 Oct 2019 05:59:15 -0700
To: Chris Wilson <chris@chris-wilson.co.uk>, intel-gfx@lists.freedesktop.org
References: <20191001094526.30083-1-chris@chris-wilson.co.uk>
 <20191001124338.12990-1-chris@chris-wilson.co.uk>
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
Organization: Intel Corporation UK Plc
Message-ID: <da0cc985-2fa0-dcfd-8db4-fef73256203b@linux.intel.com>
Date: Tue, 1 Oct 2019 13:59:14 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20191001124338.12990-1-chris@chris-wilson.co.uk>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH v2] drm/i915/selftests: Exercise potential
 false lite-restore
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Ck9uIDAxLzEwLzIwMTkgMTM6NDMsIENocmlzIFdpbHNvbiB3cm90ZToKPiBJZiBleGVjbGlzdHMn
cyBsaXRlLXJlc3RvcmUgaXMgYmFzZWQgb24gdGhlIGNvbW1vbiBHRU0gY29udGV4dCB0YWcKPiBy
YXRoZXIgdGhhbiB0aGUgcGVyLWludGVsX2NvbnRleHQgTFJDQSwgdGhlbiBhIGNvbnRleHQgc3dp
dGNoIGJldHdlZW4KPiB0d28gaW50ZWxfY29udGV4dHMgb24gdGhlIHNhbWUgZW5naW5lIGRlcml2
ZWQgZnJvbSB0aGUgc2FtZSBHRU0gY29udGV4dAo+IHdpbGwgcGVyZm9ybSBhIGxpdGUtcmVzdG9y
ZSBpbnN0ZWFkIG9mIGEgZnVsbCBjb250ZXh0IHN3aXRjaC4gV2UgY2FuCj4gZXhwbG9pdCB0aGlz
IGJ5IHBvaXNvbmluZyB0aGUgcmluZ2J1ZmZlciBvZiB0aGUgZmlyc3QgY29udGV4dCBhbmQgdHJ5
aW5nCj4gdG8gdHJpY2sgYSBzaW1wbGUgUklOR19UQUlMIHVwZGF0ZSAoaS5lLiBsaXRlLXJlc3Rv
cmUpCj4gCj4gdjI6IEFsc28gY2hlY2sgd2hhdCBoYXBwZW5zIGlmIHByZWVtcHQgY2VbMF0gd2l0
aCBjZVsxXSAoYm90aCBpbnN0YW5jZXMKPiBvbiB0aGUgc2FtZSBlbmdpbmUgZnJvbSB0aGUgc2Ft
ZSBwYXJlbnQgY29udGV4dCkgW1R2cnRrb10KPiAKPiBTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxz
b24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KPiBDYzogVHZydGtvIFVyc3VsaW4gPHR2cnRr
by51cnN1bGluQGludGVsLmNvbT4KPiAtLS0KPiAgIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3Nl
bGZ0ZXN0X2xyYy5jIHwgMTczICsrKysrKysrKysrKysrKysrKysrKysrKysKPiAgIDEgZmlsZSBj
aGFuZ2VkLCAxNzMgaW5zZXJ0aW9ucygrKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0
ZXN0X2xyYy5jCj4gaW5kZXggOTNmMmZjZGM0OWJmLi5kZTQ5OGMzOGEwMDYgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwo+IEBAIC03OSw2ICs3OSwxNzcgQEAgc3Rh
dGljIGludCBsaXZlX3Nhbml0eWNoZWNrKHZvaWQgKmFyZykKPiAgIAlyZXR1cm4gZXJyOwo+ICAg
fQo+ICAgCj4gK3N0YXRpYyBpbnQgbGl2ZV91bmxpdGVfcmVzdG9yZShzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSwgaW50IHByaW8pCj4gK3sKPiArCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3Mg
KmVuZ2luZTsKPiArCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7Cj4gKwllbnVtIGludGVs
X2VuZ2luZV9pZCBpZDsKPiArCWludGVsX3dha2VyZWZfdCB3YWtlcmVmOwo+ICsJc3RydWN0IGln
dF9zcGlubmVyIHNwaW47Cj4gKwlpbnQgZXJyID0gLUVOT01FTTsKPiArCj4gKwkvKgo+ICsJICog
Q2hlY2sgdGhhdCB3ZSBjYW4gY29ycmVjdGx5IGNvbnRleHQgc3dpdGNoIGJldHdlZW4gMiBpbnN0
YW5jZXMKPiArCSAqIG9uIHRoZSBzYW1lIGVuZ2luZSBmcm9tIHRoZSBzYW1lIHBhcmVudCBjb250
ZXh0Lgo+ICsJICovCj4gKwo+ICsJbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7
Cj4gKwl3YWtlcmVmID0gaW50ZWxfcnVudGltZV9wbV9nZXQoJmk5MTUtPnJ1bnRpbWVfcG0pOwo+
ICsKPiArCWlmIChpZ3Rfc3Bpbm5lcl9pbml0KCZzcGluLCAmaTkxNS0+Z3QpKQo+ICsJCWdvdG8g
ZXJyX3VubG9jazsKPiArCj4gKwljdHggPSBrZXJuZWxfY29udGV4dChpOTE1KTsKPiArCWlmICgh
Y3R4KQo+ICsJCWdvdG8gZXJyX3NwaW47Cj4gKwo+ICsJZXJyID0gMDsKPiArCWZvcl9lYWNoX2Vu
Z2luZShlbmdpbmUsIGk5MTUsIGlkKSB7Cj4gKwkJc3RydWN0IGludGVsX2NvbnRleHQgKmNlWzJd
ID0ge307Cj4gKwkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnFbMl07Cj4gKwkJc3RydWN0IGlndF9s
aXZlX3Rlc3QgdDsKPiArCQlpbnQgbjsKPiArCj4gKwkJaWYgKHByaW8gJiYgIWludGVsX2VuZ2lu
ZV9oYXNfcHJlZW1wdGlvbihlbmdpbmUpKQo+ICsJCQljb250aW51ZTsKPiArCj4gKwkJaWYgKCFp
bnRlbF9lbmdpbmVfY2FuX3N0b3JlX2R3b3JkKGVuZ2luZSkpCj4gKwkJCWNvbnRpbnVlOwo+ICsK
PiArCQlpZiAoaWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19mdW5jX18sIGVuZ2luZS0+
bmFtZSkpIHsKPiArCQkJZXJyID0gLUVJTzsKPiArCQkJYnJlYWs7Cj4gKwkJfQo+ICsKPiArCQlm
b3IgKG4gPSAwOyBuIDwgQVJSQVlfU0laRShjZSk7IG4rKykgewo+ICsJCQlzdHJ1Y3QgaW50ZWxf
Y29udGV4dCAqdG1wOwo+ICsKPiArCQkJdG1wID0gaW50ZWxfY29udGV4dF9jcmVhdGUoY3R4LCBl
bmdpbmUpOwo+ICsJCQlpZiAoSVNfRVJSKHRtcCkpIHsKPiArCQkJCWVyciA9IFBUUl9FUlIodG1w
KTsKPiArCQkJCWdvdG8gZXJyX2NlOwo+ICsJCQl9Cj4gKwo+ICsJCQllcnIgPSBpbnRlbF9jb250
ZXh0X3Bpbih0bXApOwo+ICsJCQlpZiAoZXJyKSB7Cj4gKwkJCQlpbnRlbF9jb250ZXh0X3B1dCh0
bXApOwo+ICsJCQkJZ290byBlcnJfY2U7Cj4gKwkJCX0KPiArCj4gKwkJCS8qCj4gKwkJCSAqIFNl
dHVwIHRoZSBwYWlyIG9mIGNvbnRleHRzIHN1Y2ggdGhhdCBpZiB3ZQo+ICsJCQkgKiBsaXRlLXJl
c3RvcmUgdXNpbmcgdGhlIFJJTkdfVEFJTCBmcm9tIGNlWzFdIGl0Cj4gKwkJCSAqIHdpbGwgZXhl
Y3V0ZSBnYXJiYWdlIGZyb20gY2VbMF0tPnJpbmcuCj4gKwkJCSAqLwo+ICsJCQltZW1zZXQodG1w
LT5yaW5nLT52YWRkciwKPiArCQkJICAgICAgIFBPSVNPTl9JTlVTRSwgLyogSVBFSFI6IDB4NWE1
YTVhNWEgW2h1bmchXSAqLwo+ICsJCQkgICAgICAgdG1wLT5yaW5nLT52bWEtPnNpemUpOwo+ICsK
PiArCQkJY2Vbbl0gPSB0bXA7Cj4gKwkJfQo+ICsJCWludGVsX3JpbmdfcmVzZXQoY2VbMV0tPnJp
bmcsIGNlWzFdLT5yaW5nLT52bWEtPnNpemUgLyAyKTsKPiArCQlfX2V4ZWNsaXN0c191cGRhdGVf
cmVnX3N0YXRlKGNlWzFdLCBlbmdpbmUpOwo+ICsKPiArCQlycVswXSA9IGlndF9zcGlubmVyX2Ny
ZWF0ZV9yZXF1ZXN0KCZzcGluLCBjZVswXSwgTUlfQVJCX0NIRUNLKTsKPiArCQlpZiAoSVNfRVJS
KHJxWzBdKSkgewo+ICsJCQllcnIgPSBQVFJfRVJSKHJxWzBdKTsKPiArCQkJZ290byBlcnJfY2U7
Cj4gKwkJfQo+ICsKPiArCQlHRU1fQlVHX09OKHJxWzBdLT50YWlsID4gY2VbMV0tPnJpbmctPmVt
aXQpOwo+ICsJCWk5MTVfcmVxdWVzdF9nZXQocnFbMF0pOwo+ICsJCWk5MTVfcmVxdWVzdF9hZGQo
cnFbMF0pOwo+ICsKPiArCQlpZiAoIWlndF93YWl0X2Zvcl9zcGlubmVyKCZzcGluLCBycVswXSkp
IHsKPiArCQkJaTkxNV9yZXF1ZXN0X3B1dChycVswXSk7Cj4gKwkJCWdvdG8gZXJyX2NlOwo+ICsJ
CX0KPiArCj4gKwkJcnFbMV0gPSBpOTE1X3JlcXVlc3RfY3JlYXRlKGNlWzFdKTsKPiArCQlpZiAo
SVNfRVJSKHJxWzFdKSkgewo+ICsJCQllcnIgPSBQVFJfRVJSKHJxWzFdKTsKPiArCQkJaTkxNV9y
ZXF1ZXN0X3B1dChycVswXSk7Cj4gKwkJCWdvdG8gZXJyX2NlOwo+ICsJCX0KPiArCQlHRU1fQlVH
X09OKHJxWzFdLT50YWlsIDw9IHJxWzBdLT50YWlsKTsKPiArCj4gKwkJaWYgKCFwcmlvKSB7Cj4g
KwkJCS8qCj4gKwkJCSAqIEVuc3VyZSB3ZSBkbyB0aGUgc3dpdGNoIHRvIGNlWzFdIG9uIGNvbXBs
ZXRpb24uCj4gKwkJCSAqCj4gKwkJCSAqIHJxWzBdIGlzIGFscmVhZHkgc3VibWl0dGVkLCBzbyB0
aGlzIHNob3VsZCByZWR1Y2UKPiArCQkJICogdG8gYSBuby1vcCAoYSB3YWl0IG9uIGEgcmVxdWVz
dCBvbiB0aGUgc2FtZSBlbmdpbmUKPiArCQkJICogdXNlcyB0aGUgc3VibWl0IGZlbmNlLCBub3Qg
dGhlIGNvbXBsZXRpb24gZmVuY2UpLAo+ICsJCQkgKiBidXQgaXQgd2lsbCBpbnN0YWxsIGEgZGVw
ZW5kZW5jeSBvbiBycVsxXSBmb3IgcnFbMF0KPiArCQkJICogdGhhdCB3aWxsIHByZXZlbnQgdGhl
IHBhaXIgYmVpbmcgcmVvcmRlcmVkIGJ5Cj4gKwkJCSAqIHRpbWVzbGljaW5nLgo+ICsJCQkgKi8K
PiArCQkJaTkxNV9yZXF1ZXN0X2F3YWl0X2RtYV9mZW5jZShycVsxXSwgJnJxWzBdLT5mZW5jZSk7
Cj4gKwkJfQo+ICsJCWk5MTVfcmVxdWVzdF9wdXQocnFbMF0pOwo+ICsKPiArCQlpOTE1X3JlcXVl
c3RfZ2V0KHJxWzFdKTsKPiArCQlpOTE1X3JlcXVlc3RfYWRkKHJxWzFdKTsKPiArCj4gKwkJaWYg
KHByaW8pIHsKPiArCQkJc3RydWN0IGk5MTVfc2NoZWRfYXR0ciBhdHRyID0gewo+ICsJCQkJLnBy
aW9yaXR5ID0gcHJpbywKPiArCQkJfTsKPiArCj4gKwkJCS8qIEFsdGVybmF0aXZlbHkgcHJlZW1w
dCB0aGUgc3Bpbm5lciB3aXRoIGNlWzFdICovCj4gKwkJCWVuZ2luZS0+c2NoZWR1bGUocnFbMV0s
ICZhdHRyKTsKPiArCQl9Cj4gKwo+ICsJCS8qIEFuZCBzd2l0Y2ggYmFjayB0byBjZVswXSBmb3Ig
Z29vZCBtZWFzdXJlICovCj4gKwkJcnFbMF0gPSBpOTE1X3JlcXVlc3RfY3JlYXRlKGNlWzBdKTsK
PiArCQlpZiAoSVNfRVJSKHJxWzBdKSkgewo+ICsJCQllcnIgPSBQVFJfRVJSKHJxWzBdKTsKPiAr
CQkJaTkxNV9yZXF1ZXN0X3B1dChycVsxXSk7Cj4gKwkJCWdvdG8gZXJyX2NlOwo+ICsJCX0KPiAr
CQlHRU1fQlVHX09OKHJxWzBdLT50YWlsID4gcnFbMV0tPnRhaWwpOwo+ICsKPiArCQlpOTE1X3Jl
cXVlc3RfYXdhaXRfZG1hX2ZlbmNlKHJxWzBdLCAmcnFbMV0tPmZlbmNlKTsKPiArCQlpOTE1X3Jl
cXVlc3RfcHV0KHJxWzFdKTsKPiArCj4gKwkJaTkxNV9yZXF1ZXN0X2FkZChycVswXSk7Cj4gKwo+
ICtlcnJfY2U6Cj4gKwkJdGFza2xldF9raWxsKCZlbmdpbmUtPmV4ZWNsaXN0cy50YXNrbGV0KTsg
LyogZmx1c2ggc3VibWlzc2lvbiAqLwoKSXMgdGhpcyByZWFsbHkgbmVlZGVkLCB3aHk/Cgo+ICsJ
CWlndF9zcGlubmVyX2VuZCgmc3Bpbik7Cj4gKwkJZm9yIChuID0gMDsgbiA8IEFSUkFZX1NJWkUo
Y2UpOyBuKyspIHsKPiArCQkJaWYgKElTX0VSUl9PUl9OVUxMKGNlW25dKSkKPiArCQkJCWJyZWFr
Owo+ICsKPiArCQkJaW50ZWxfY29udGV4dF91bnBpbihjZVtuXSk7Cj4gKwkJCWludGVsX2NvbnRl
eHRfcHV0KGNlW25dKTsKPiArCQl9Cj4gKwo+ICsJCWlmIChpZ3RfbGl2ZV90ZXN0X2VuZCgmdCkp
Cj4gKwkJCWVyciA9IC1FSU87Cj4gKwkJaWYgKGVycikKPiArCQkJYnJlYWs7Cj4gKwl9Cj4gKwo+
ICsJa2VybmVsX2NvbnRleHRfY2xvc2UoY3R4KTsKPiArZXJyX3NwaW46Cj4gKwlpZ3Rfc3Bpbm5l
cl9maW5pKCZzcGluKTsKPiArZXJyX3VubG9jazoKPiArCWludGVsX3J1bnRpbWVfcG1fcHV0KCZp
OTE1LT5ydW50aW1lX3BtLCB3YWtlcmVmKTsKPiArCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7Cj4gKwlyZXR1cm4gZXJyOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGxpdmVf
dW5saXRlX3N3aXRjaCh2b2lkICphcmcpCj4gK3sKPiArCXJldHVybiBsaXZlX3VubGl0ZV9yZXN0
b3JlKGFyZywgMCk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgbGl2ZV91bmxpdGVfcHJlZW1wdCh2
b2lkICphcmcpCj4gK3sKPiArCXJldHVybiBsaXZlX3VubGl0ZV9yZXN0b3JlKGFyZywgSTkxNV9V
U0VSX1BSSU9SSVRZKEk5MTVfUFJJT1JJVFlfTUFYKSk7Cj4gK30KPiArCj4gICBzdGF0aWMgaW50
Cj4gICBlbWl0X3NlbWFwaG9yZV9jaGFpbihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSwgc3RydWN0
IGk5MTVfdm1hICp2bWEsIGludCBpZHgpCj4gICB7Cj4gQEAgLTIxNzgsNiArMjM0OSw4IEBAIGlu
dCBpbnRlbF9leGVjbGlzdHNfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCj4gICB7Cj4gICAJc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3N1YnRlc3QgdGVzdHNb
XSA9IHsKPiAgIAkJU1VCVEVTVChsaXZlX3Nhbml0eWNoZWNrKSwKPiArCQlTVUJURVNUKGxpdmVf
dW5saXRlX3N3aXRjaCksCj4gKwkJU1VCVEVTVChsaXZlX3VubGl0ZV9wcmVlbXB0KSwKPiAgIAkJ
U1VCVEVTVChsaXZlX3RpbWVzbGljZV9wcmVlbXB0KSwKPiAgIAkJU1VCVEVTVChsaXZlX2J1c3l3
YWl0X3ByZWVtcHQpLAo+ICAgCQlTVUJURVNUKGxpdmVfcHJlZW1wdCksCj4gCgpBcGFydCBmcm9t
IHRoZSB0YXNrbGV0X2tpbGwgaGVhZCBzY3JhdGNoZXIgbG9va3MgZ29vZC4KClJldmlld2VkLWJ5
OiBUdnJ0a28gVXJzdWxpbiA8dHZydGtvLnVyc3VsaW5AaW50ZWwuY29tPgoKUmVnYXJkcywKClR2
cnRrbwpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRl
bC1nZnggbWFpbGluZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

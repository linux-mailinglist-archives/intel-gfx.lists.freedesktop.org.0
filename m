Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 8596B5B6EC
	for <lists+intel-gfx@lfdr.de>; Mon,  1 Jul 2019 10:34:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 62DE389C17;
	Mon,  1 Jul 2019 08:34:35 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8F0C989C17
 for <intel-gfx@lists.freedesktop.org>; Mon,  1 Jul 2019 08:34:34 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga002.jf.intel.com ([10.7.209.21])
 by orsmga102.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 01 Jul 2019 01:34:34 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,438,1557212400"; d="scan'208";a="174155087"
Received: from math-mobl1.ger.corp.intel.com (HELO [10.252.62.64])
 ([10.252.62.64])
 by orsmga002.jf.intel.com with ESMTP; 01 Jul 2019 01:34:31 -0700
To: intel-gfx@lists.freedesktop.org
References: <20190628085517.31886-1-maarten.lankhorst@linux.intel.com>
 <20190628085517.31886-7-maarten.lankhorst@linux.intel.com>
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Message-ID: <664c5b9d-c222-2e7b-deda-255e82d1f2e9@linux.intel.com>
Date: Mon, 1 Jul 2019 10:34:31 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.1
MIME-Version: 1.0
In-Reply-To: <20190628085517.31886-7-maarten.lankhorst@linux.intel.com>
Content-Language: en-US
Subject: Re: [Intel-gfx] [PATCH v2 6/6] drm/i915: Use intel state as much as
 possible in wm code
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T3AgMjgtMDYtMjAxOSBvbSAxMDo1NSBzY2hyZWVmIE1hYXJ0ZW4gTGFua2hvcnN0Ogo+IEluc3Rl
YWQgb2YgZGlyZWN0bHkgcmVmZXJlbmNpbmcgZHJtX2NydGNfc3RhdGUsIGNvbnZlcnQgdG8KPiBp
bnRlbF9jdGNfc3RhdGUgYW5kIHVzZSB0aGUgYmFzZSBzdHJ1Y3QuIFRoaXMgaXMgdXNlZnVsIHdo
ZW4gd2UncmUKPiBtYWtpbmcgdGhlIHNwbGl0IGJldHdlZW4gdWFwaSBhbmQgaHcgc3RhdGUsIGFu
ZCBhbHNvIG1ha2VzIHRoZQo+IGNvZGUgc2xpZ2h0bHkgbW9yZSByZWFkYWJsZS4KPgo+IEEgbG90
IG9mIHBsYWNlcyBhbHNvIHVzZSBjc3RhdGUsIGluc3RlYWQgb2YgdGhlIG1vcmUgY29tbW9uIGNy
dGNfc3RhdGUuCj4gQ2xlYW4gdGhvc2UgdXAgdG8gdXNlIGNydGNfc3RhdGUuIFNhbWUgZm9yIHBz
dGF0ZSB2cyBwbGFuZV9zdGF0ZS4gKFZpbGxlKQo+Cj4gU2lnbmVkLW9mZi1ieTogTWFhcnRlbiBM
YW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4LmludGVsLmNvbT4KPiBSZXZpZXdlZC1i
eTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KPiAtLS0K
PiAgZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCB8ICAxMiArLQo+ICBkcml2ZXJzL2dw
dS9kcm0vaTkxNS9pbnRlbF9wbS5jIHwgNDAyICsrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0t
LS0tCj4gIDIgZmlsZXMgY2hhbmdlZCwgMjAwIGluc2VydGlvbnMoKyksIDIxNCBkZWxldGlvbnMo
LSkKPgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaAo+IGluZGV4IDdkOWFlMjM0YTAyZS4uMDJkZDlm
OWYzYTg5IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKPiAr
KysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCj4gQEAgLTI4NywxNCArMjg3LDE0
IEBAIHN0cnVjdCBkcm1faTkxNV9kaXNwbGF5X2Z1bmNzIHsKPiAgCQkJICBlbnVtIHBpcGUgcGlw
ZSk7Cj4gIAlpbnQgKCpnZXRfZmlmb19zaXplKShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCj4gIAkJCSAgICAgZW51bSBpOXh4X3BsYW5lX2lkIGk5eHhfcGxhbmUpOwo+IC0JaW50
ICgqY29tcHV0ZV9waXBlX3dtKShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKTsKPiAt
CWludCAoKmNvbXB1dGVfaW50ZXJtZWRpYXRlX3dtKShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
bmV3c3RhdGUpOwo+ICsJaW50ICgqY29tcHV0ZV9waXBlX3dtKShzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSk7Cj4gKwlpbnQgKCpjb21wdXRlX2ludGVybWVkaWF0ZV93bSkoc3Ry
dWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwo+ICAJdm9pZCAoKmluaXRpYWxfd2F0
ZXJtYXJrcykoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gLQkJCQkgICBzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKTsKPiArCQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlKTsKPiAgCXZvaWQgKCphdG9taWNfdXBkYXRlX3dhdGVybWFya3Mp
KHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+IC0JCQkJCSBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3N0YXRlKTsKPiArCQkJCQkgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpOwo+ICAJdm9pZCAoKm9wdGltaXplX3dhdGVybWFya3MpKHN0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGUgKnN0YXRlLAo+IC0JCQkJICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
c3RhdGUpOwo+ICsJCQkJICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsK
PiAgCWludCAoKmNvbXB1dGVfZ2xvYmFsX3dhdGVybWFya3MpKHN0cnVjdCBpbnRlbF9hdG9taWNf
c3RhdGUgKnN0YXRlKTsKPiAgCXZvaWQgKCp1cGRhdGVfd20pKHN0cnVjdCBpbnRlbF9jcnRjICpj
cnRjKTsKPiAgCWludCAoKm1vZGVzZXRfY2FsY19jZGNsaykoc3RydWN0IGludGVsX2F0b21pY19z
dGF0ZSAqc3RhdGUpOwo+IEBAIC0xNjQ2LDcgKzE2NDYsNyBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSB7Cj4gIAkJLyoKPiAgCQkgKiBTaG91bGQgYmUgaGVsZCBhcm91bmQgYXRvbWljIFdNIHJl
Z2lzdGVyIHdyaXRpbmc7IGFsc28KPiAgCQkgKiBwcm90ZWN0cyAqIGludGVsX2NydGMtPndtLmFj
dGl2ZSBhbmQKPiAtCQkgKiBjc3RhdGUtPndtLm5lZWRfcG9zdHZibF91cGRhdGUuCj4gKwkJICog
Y3J0Y19zdGF0ZS0+d20ubmVlZF9wb3N0dmJsX3VwZGF0ZS4KPiAgCQkgKi8KPiAgCQlzdHJ1Y3Qg
bXV0ZXggd21fbXV0ZXg7Cj4gIAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
bnRlbF9wbS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwo+IGluZGV4IDQxMTZk
ZTJhNzdmZC4uZDEwYzYyZDNmMTBjIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2ludGVsX3BtLmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jCj4gQEAg
LTExOTgsOCArMTE5OCw4IEBAIHN0YXRpYyBib29sIGc0eF9yYXdfZmJjX3dtX3NldChzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCXJldHVybiBkaXJ0eTsKPiAgfQo+ICAK
PiAtc3RhdGljIHUzMiBpbGtfY29tcHV0ZV9mYmNfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNzdGF0ZSwKPiAtCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRl
ICpwc3RhdGUsCj4gK3N0YXRpYyB1MzIgaWxrX2NvbXB1dGVfZmJjX3dtKGNvbnN0IHN0cnVjdCBp
bnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICsJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50
ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlLAo+ICAJCQkgICAgICB1MzIgcHJpX3ZhbCk7Cj4g
IAo+ICBzdGF0aWMgYm9vbCBnNHhfcmF3X3BsYW5lX3dtX2NvbXB1dGUoc3RydWN0IGludGVsX2Ny
dGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gQEAgLTI0OTMsOCArMjQ5Myw4IEBAIHN0cnVjdCBpbGtf
d21fbWF4aW11bXMgewo+ICAgKiBGb3IgYm90aCBXTV9QSVBFIGFuZCBXTV9MUC4KPiAgICogbWVt
X3ZhbHVlIG11c3QgYmUgaW4gMC4xdXMgdW5pdHMuCj4gICAqLwo+IC1zdGF0aWMgdTMyIGlsa19j
b21wdXRlX3ByaV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+IC0J
CQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBzdGF0ZSwKPiArc3RhdGlj
IHUzMiBpbGtfY29tcHV0ZV9wcmlfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUsCj4gKwkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcGxh
bmVfc3RhdGUsCj4gIAkJCSAgICAgIHUzMiBtZW1fdmFsdWUsIGJvb2wgaXNfbHApCj4gIHsKPiAg
CXUzMiBtZXRob2QxLCBtZXRob2QyOwo+IEBAIC0yNTAzLDE5ICsyNTAzLDE5IEBAIHN0YXRpYyB1
MzIgaWxrX2NvbXB1dGVfcHJpX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3Rh
dGUsCj4gIAlpZiAobWVtX3ZhbHVlID09IDApCj4gIAkJcmV0dXJuIFUzMl9NQVg7Cj4gIAo+IC0J
aWYgKCFpbnRlbF93bV9wbGFuZV92aXNpYmxlKGNzdGF0ZSwgcHN0YXRlKSkKPiArCWlmICghaW50
ZWxfd21fcGxhbmVfdmlzaWJsZShjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSkpCj4gIAkJcmV0dXJu
IDA7Cj4gIAo+IC0JY3BwID0gcHN0YXRlLT5iYXNlLmZiLT5mb3JtYXQtPmNwcFswXTsKPiArCWNw
cCA9IHBsYW5lX3N0YXRlLT5iYXNlLmZiLT5mb3JtYXQtPmNwcFswXTsKPiAgCj4gLQltZXRob2Qx
ID0gaWxrX3dtX21ldGhvZDEoY3N0YXRlLT5waXhlbF9yYXRlLCBjcHAsIG1lbV92YWx1ZSk7Cj4g
KwltZXRob2QxID0gaWxrX3dtX21ldGhvZDEoY3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZSwgY3BwLCBt
ZW1fdmFsdWUpOwo+ICAKPiAgCWlmICghaXNfbHApCj4gIAkJcmV0dXJuIG1ldGhvZDE7Cj4gIAo+
IC0JbWV0aG9kMiA9IGlsa193bV9tZXRob2QyKGNzdGF0ZS0+cGl4ZWxfcmF0ZSwKPiAtCQkJCSBj
c3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCwKPiAtCQkJCSBkcm1fcmVjdF93
aWR0aCgmcHN0YXRlLT5iYXNlLmRzdCksCj4gKwltZXRob2QyID0gaWxrX3dtX21ldGhvZDIoY3J0
Y19zdGF0ZS0+cGl4ZWxfcmF0ZSwKPiArCQkJCSBjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21v
ZGUuY3J0Y19odG90YWwsCj4gKwkJCQkgZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT5iYXNl
LmRzdCksCj4gIAkJCQkgY3BwLCBtZW1fdmFsdWUpOwo+ICAKPiAgCXJldHVybiBtaW4obWV0aG9k
MSwgbWV0aG9kMik7Cj4gQEAgLTI1MjUsOCArMjUyNSw4IEBAIHN0YXRpYyB1MzIgaWxrX2NvbXB1
dGVfcHJpX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gICAqIEZv
ciBib3RoIFdNX1BJUEUgYW5kIFdNX0xQLgo+ICAgKiBtZW1fdmFsdWUgbXVzdCBiZSBpbiAwLjF1
cyB1bml0cy4KPiAgICovCj4gLXN0YXRpYyB1MzIgaWxrX2NvbXB1dGVfc3ByX3dtKGNvbnN0IHN0
cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gLQkJCSAgICAgIGNvbnN0IHN0cnVjdCBp
bnRlbF9wbGFuZV9zdGF0ZSAqcHN0YXRlLAo+ICtzdGF0aWMgdTMyIGlsa19jb21wdXRlX3Nwcl93
bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiArCQkJICAgICAg
Y29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSwKPiAgCQkJICAgICAg
dTMyIG1lbV92YWx1ZSkKPiAgewo+ICAJdTMyIG1ldGhvZDEsIG1ldGhvZDI7Cj4gQEAgLTI1MzUs
MTUgKzI1MzUsMTUgQEAgc3RhdGljIHUzMiBpbGtfY29tcHV0ZV9zcHJfd20oY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAgCWlmIChtZW1fdmFsdWUgPT0gMCkKPiAgCQly
ZXR1cm4gVTMyX01BWDsKPiAgCj4gLQlpZiAoIWludGVsX3dtX3BsYW5lX3Zpc2libGUoY3N0YXRl
LCBwc3RhdGUpKQo+ICsJaWYgKCFpbnRlbF93bV9wbGFuZV92aXNpYmxlKGNydGNfc3RhdGUsIHBs
YW5lX3N0YXRlKSkKPiAgCQlyZXR1cm4gMDsKPiAgCj4gLQljcHAgPSBwc3RhdGUtPmJhc2UuZmIt
PmZvcm1hdC0+Y3BwWzBdOwo+ICsJY3BwID0gcGxhbmVfc3RhdGUtPmJhc2UuZmItPmZvcm1hdC0+
Y3BwWzBdOwo+ICAKPiAtCW1ldGhvZDEgPSBpbGtfd21fbWV0aG9kMShjc3RhdGUtPnBpeGVsX3Jh
dGUsIGNwcCwgbWVtX3ZhbHVlKTsKPiAtCW1ldGhvZDIgPSBpbGtfd21fbWV0aG9kMihjc3RhdGUt
PnBpeGVsX3JhdGUsCj4gLQkJCQkgY3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19odG90
YWwsCj4gLQkJCQkgZHJtX3JlY3Rfd2lkdGgoJnBzdGF0ZS0+YmFzZS5kc3QpLAo+ICsJbWV0aG9k
MSA9IGlsa193bV9tZXRob2QxKGNydGNfc3RhdGUtPnBpeGVsX3JhdGUsIGNwcCwgbWVtX3ZhbHVl
KTsKPiArCW1ldGhvZDIgPSBpbGtfd21fbWV0aG9kMihjcnRjX3N0YXRlLT5waXhlbF9yYXRlLAo+
ICsJCQkJIGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCwKPiArCQkJ
CSBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUtPmJhc2UuZHN0KSwKPiAgCQkJCSBjcHAsIG1l
bV92YWx1ZSk7Cj4gIAlyZXR1cm4gbWluKG1ldGhvZDEsIG1ldGhvZDIpOwo+ICB9Cj4gQEAgLTI1
NTIsOCArMjU1Miw4IEBAIHN0YXRpYyB1MzIgaWxrX2NvbXB1dGVfc3ByX3dtKGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gICAqIEZvciBib3RoIFdNX1BJUEUgYW5kIFdN
X0xQLgo+ICAgKiBtZW1fdmFsdWUgbXVzdCBiZSBpbiAwLjF1cyB1bml0cy4KPiAgICovCj4gLXN0
YXRpYyB1MzIgaWxrX2NvbXB1dGVfY3VyX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjc3RhdGUsCj4gLQkJCSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqcHN0
YXRlLAo+ICtzdGF0aWMgdTMyIGlsa19jb21wdXRlX2N1cl93bShjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiArCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX3Bs
YW5lX3N0YXRlICpwbGFuZV9zdGF0ZSwKPiAgCQkJICAgICAgdTMyIG1lbV92YWx1ZSkKPiAgewo+
ICAJaW50IGNwcDsKPiBAQCAtMjU2MSwyOSArMjU2MSwyOSBAQCBzdGF0aWMgdTMyIGlsa19jb21w
dXRlX2N1cl93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ICAJaWYg
KG1lbV92YWx1ZSA9PSAwKQo+ICAJCXJldHVybiBVMzJfTUFYOwo+ICAKPiAtCWlmICghaW50ZWxf
d21fcGxhbmVfdmlzaWJsZShjc3RhdGUsIHBzdGF0ZSkpCj4gKwlpZiAoIWludGVsX3dtX3BsYW5l
X3Zpc2libGUoY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUpKQo+ICAJCXJldHVybiAwOwo+ICAKPiAt
CWNwcCA9IHBzdGF0ZS0+YmFzZS5mYi0+Zm9ybWF0LT5jcHBbMF07Cj4gKwljcHAgPSBwbGFuZV9z
dGF0ZS0+YmFzZS5mYi0+Zm9ybWF0LT5jcHBbMF07Cj4gIAo+IC0JcmV0dXJuIGlsa193bV9tZXRo
b2QyKGNzdGF0ZS0+cGl4ZWxfcmF0ZSwKPiAtCQkJICAgICAgY3N0YXRlLT5iYXNlLmFkanVzdGVk
X21vZGUuY3J0Y19odG90YWwsCj4gLQkJCSAgICAgIHBzdGF0ZS0+YmFzZS5jcnRjX3csIGNwcCwg
bWVtX3ZhbHVlKTsKPiArCXJldHVybiBpbGtfd21fbWV0aG9kMihjcnRjX3N0YXRlLT5waXhlbF9y
YXRlLAo+ICsJCQkgICAgICBjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19odG90
YWwsCj4gKwkJCSAgICAgIHBsYW5lX3N0YXRlLT5iYXNlLmNydGNfdywgY3BwLCBtZW1fdmFsdWUp
Owo+ICB9Cj4gIAo+ICAvKiBPbmx5IGZvciBXTV9MUC4gKi8KPiAtc3RhdGljIHUzMiBpbGtfY29t
cHV0ZV9mYmNfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAtCQkJ
ICAgICAgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwc3RhdGUsCj4gK3N0YXRpYyB1
MzIgaWxrX2NvbXB1dGVfZmJjX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRj
X3N0YXRlLAo+ICsJCQkgICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5l
X3N0YXRlLAo+ICAJCQkgICAgICB1MzIgcHJpX3ZhbCkKPiAgewo+ICAJaW50IGNwcDsKPiAgCj4g
LQlpZiAoIWludGVsX3dtX3BsYW5lX3Zpc2libGUoY3N0YXRlLCBwc3RhdGUpKQo+ICsJaWYgKCFp
bnRlbF93bV9wbGFuZV92aXNpYmxlKGNydGNfc3RhdGUsIHBsYW5lX3N0YXRlKSkKPiAgCQlyZXR1
cm4gMDsKPiAgCj4gLQljcHAgPSBwc3RhdGUtPmJhc2UuZmItPmZvcm1hdC0+Y3BwWzBdOwo+ICsJ
Y3BwID0gcGxhbmVfc3RhdGUtPmJhc2UuZmItPmZvcm1hdC0+Y3BwWzBdOwo+ICAKPiAtCXJldHVy
biBpbGtfd21fZmJjKHByaV92YWwsIGRybV9yZWN0X3dpZHRoKCZwc3RhdGUtPmJhc2UuZHN0KSwg
Y3BwKTsKPiArCXJldHVybiBpbGtfd21fZmJjKHByaV92YWwsIGRybV9yZWN0X3dpZHRoKCZwbGFu
ZV9zdGF0ZS0+YmFzZS5kc3QpLCBjcHApOwo+ICB9Cj4gIAo+ICBzdGF0aWMgdW5zaWduZWQgaW50
Cj4gQEAgLTI3NTIsNyArMjc1Miw3IEBAIHN0YXRpYyBib29sIGlsa192YWxpZGF0ZV93bV9sZXZl
bChpbnQgbGV2ZWwsCj4gIHN0YXRpYyB2b2lkIGlsa19jb21wdXRlX3dtX2xldmVsKGNvbnN0IHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwKPiAgCQkJCSBjb25zdCBzdHJ1Y3QgaW50
ZWxfY3J0YyAqaW50ZWxfY3J0YywKPiAgCQkJCSBpbnQgbGV2ZWwsCj4gLQkJCQkgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiArCQkJCSBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3J0Y19zdGF0ZSwKPiAgCQkJCSBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnByaXN0
YXRlLAo+ICAJCQkJIGNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqc3Byc3RhdGUsCj4g
IAkJCQkgY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpjdXJzdGF0ZSwKPiBAQCAtMjc3
MCwzMCArMjc3MCwzMCBAQCBzdGF0aWMgdm9pZCBpbGtfY29tcHV0ZV93bV9sZXZlbChjb25zdCBz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gIAl9Cj4gIAo+ICAJaWYgKHByaXN0
YXRlKSB7Cj4gLQkJcmVzdWx0LT5wcmlfdmFsID0gaWxrX2NvbXB1dGVfcHJpX3dtKGNzdGF0ZSwg
cHJpc3RhdGUsCj4gKwkJcmVzdWx0LT5wcmlfdmFsID0gaWxrX2NvbXB1dGVfcHJpX3dtKGNydGNf
c3RhdGUsIHByaXN0YXRlLAo+ICAJCQkJCQkgICAgIHByaV9sYXRlbmN5LCBsZXZlbCk7Cj4gLQkJ
cmVzdWx0LT5mYmNfdmFsID0gaWxrX2NvbXB1dGVfZmJjX3dtKGNzdGF0ZSwgcHJpc3RhdGUsIHJl
c3VsdC0+cHJpX3ZhbCk7Cj4gKwkJcmVzdWx0LT5mYmNfdmFsID0gaWxrX2NvbXB1dGVfZmJjX3dt
KGNydGNfc3RhdGUsIHByaXN0YXRlLCByZXN1bHQtPnByaV92YWwpOwo+ICAJfQo+ICAKPiAgCWlm
IChzcHJzdGF0ZSkKPiAtCQlyZXN1bHQtPnNwcl92YWwgPSBpbGtfY29tcHV0ZV9zcHJfd20oY3N0
YXRlLCBzcHJzdGF0ZSwgc3ByX2xhdGVuY3kpOwo+ICsJCXJlc3VsdC0+c3ByX3ZhbCA9IGlsa19j
b21wdXRlX3Nwcl93bShjcnRjX3N0YXRlLCBzcHJzdGF0ZSwgc3ByX2xhdGVuY3kpOwo+ICAKPiAg
CWlmIChjdXJzdGF0ZSkKPiAtCQlyZXN1bHQtPmN1cl92YWwgPSBpbGtfY29tcHV0ZV9jdXJfd20o
Y3N0YXRlLCBjdXJzdGF0ZSwgY3VyX2xhdGVuY3kpOwo+ICsJCXJlc3VsdC0+Y3VyX3ZhbCA9IGls
a19jb21wdXRlX2N1cl93bShjcnRjX3N0YXRlLCBjdXJzdGF0ZSwgY3VyX2xhdGVuY3kpOwo+ICAK
PiAgCXJlc3VsdC0+ZW5hYmxlID0gdHJ1ZTsKPiAgfQo+ICAKPiAgc3RhdGljIHUzMgo+IC1oc3df
Y29tcHV0ZV9saW5ldGltZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRl
KQo+ICtoc3dfY29tcHV0ZV9saW5ldGltZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiAgewo+ICAJY29uc3Qgc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAq
aW50ZWxfc3RhdGUgPQo+IC0JCXRvX2ludGVsX2F0b21pY19zdGF0ZShjc3RhdGUtPmJhc2Uuc3Rh
dGUpOwo+ICsJCXRvX2ludGVsX2F0b21pY19zdGF0ZShjcnRjX3N0YXRlLT5iYXNlLnN0YXRlKTsK
PiAgCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICphZGp1c3RlZF9tb2RlID0KPiAtCQkm
Y3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGU7Cj4gKwkJJmNydGNfc3RhdGUtPmJhc2UuYWRqdXN0
ZWRfbW9kZTsKPiAgCXUzMiBsaW5ldGltZSwgaXBzX2xpbmV0aW1lOwo+ICAKPiAtCWlmICghY3N0
YXRlLT5iYXNlLmFjdGl2ZSkKPiArCWlmICghY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpCj4gIAkJ
cmV0dXJuIDA7Cj4gIAlpZiAoV0FSTl9PTihhZGp1c3RlZF9tb2RlLT5jcnRjX2Nsb2NrID09IDAp
KQo+ICAJCXJldHVybiAwOwo+IEBAIC0zMTAxLDEwICszMTAxLDEwIEBAIHN0YXRpYyBib29sIGls
a192YWxpZGF0ZV9waXBlX3dtKGNvbnN0IHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diwKPiAgfQo+ICAKPiAgLyogQ29tcHV0ZSBuZXcgd2F0ZXJtYXJrcyBmb3IgdGhlIHBpcGUgKi8K
PiAtc3RhdGljIGludCBpbGtfY29tcHV0ZV9waXBlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjc3RhdGUpCj4gK3N0YXRpYyBpbnQgaWxrX2NvbXB1dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUg
KnN0YXRlID0gY3N0YXRlLT5iYXNlLnN0YXRlOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmludGVs
X2NydGMgPSB0b19pbnRlbF9jcnRjKGNzdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBkcm1f
YXRvbWljX3N0YXRlICpzdGF0ZSA9IGNydGNfc3RhdGUtPmJhc2Uuc3RhdGU7Cj4gKwlzdHJ1Y3Qg
aW50ZWxfY3J0YyAqaW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjKTsKPiAgCXN0cnVjdCBpbnRlbF9waXBlX3dtICpwaXBlX3dtOwo+ICAJc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9IHN0YXRlLT5kZXY7Cj4gIAljb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRldik7Cj4gQEAgLTMxMTYsOSArMzExNiw5IEBAIHN0YXRp
YyBpbnQgaWxrX2NvbXB1dGVfcGlwZV93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRl
KQo+ICAJaW50IGxldmVsLCBtYXhfbGV2ZWwgPSBpbGtfd21fbWF4X2xldmVsKGRldl9wcml2KSwg
dXNhYmxlX2xldmVsOwo+ICAJc3RydWN0IGlsa193bV9tYXhpbXVtcyBtYXg7Cj4gIAo+IC0JcGlw
ZV93bSA9ICZjc3RhdGUtPndtLmlsay5vcHRpbWFsOwo+ICsJcGlwZV93bSA9ICZjcnRjX3N0YXRl
LT53bS5pbGsub3B0aW1hbDsKPiAgCj4gLQlkcm1fYXRvbWljX2NydGNfc3RhdGVfZm9yX2VhY2hf
cGxhbmVfc3RhdGUocGxhbmUsIHBsYW5lX3N0YXRlLCAmY3N0YXRlLT5iYXNlKSB7Cj4gKwlkcm1f
YXRvbWljX2NydGNfc3RhdGVfZm9yX2VhY2hfcGxhbmVfc3RhdGUocGxhbmUsIHBsYW5lX3N0YXRl
LCAmY3J0Y19zdGF0ZS0+YmFzZSkgewo+ICAJCWNvbnN0IHN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0
ZSAqcHMgPSB0b19pbnRlbF9wbGFuZV9zdGF0ZShwbGFuZV9zdGF0ZSk7Cj4gIAo+ICAJCWlmIChw
bGFuZS0+dHlwZSA9PSBEUk1fUExBTkVfVFlQRV9QUklNQVJZKQo+IEBAIC0zMTI5LDcgKzMxMjks
NyBAQCBzdGF0aWMgaW50IGlsa19jb21wdXRlX3BpcGVfd20oc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNzdGF0ZSkKPiAgCQkJY3Vyc3RhdGUgPSBwczsKPiAgCX0KPiAgCj4gLQlwaXBlX3dtLT5w
aXBlX2VuYWJsZWQgPSBjc3RhdGUtPmJhc2UuYWN0aXZlOwo+ICsJcGlwZV93bS0+cGlwZV9lbmFi
bGVkID0gY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmU7Cj4gIAlpZiAoc3Byc3RhdGUpIHsKPiAgCQlw
aXBlX3dtLT5zcHJpdGVzX2VuYWJsZWQgPSBzcHJzdGF0ZS0+YmFzZS52aXNpYmxlOwo+ICAJCXBp
cGVfd20tPnNwcml0ZXNfc2NhbGVkID0gc3Byc3RhdGUtPmJhc2UudmlzaWJsZSAmJgo+IEBAIC0z
MTQ4LDExICszMTQ4LDExIEBAIHN0YXRpYyBpbnQgaWxrX2NvbXB1dGVfcGlwZV93bShzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQo+ICAJCXVzYWJsZV9sZXZlbCA9IDA7Cj4gIAo+ICAJ
bWVtc2V0KCZwaXBlX3dtLT53bSwgMCwgc2l6ZW9mKHBpcGVfd20tPndtKSk7Cj4gLQlpbGtfY29t
cHV0ZV93bV9sZXZlbChkZXZfcHJpdiwgaW50ZWxfY3J0YywgMCwgY3N0YXRlLAo+ICsJaWxrX2Nv
bXB1dGVfd21fbGV2ZWwoZGV2X3ByaXYsIGludGVsX2NydGMsIDAsIGNydGNfc3RhdGUsCj4gIAkJ
CSAgICAgcHJpc3RhdGUsIHNwcnN0YXRlLCBjdXJzdGF0ZSwgJnBpcGVfd20tPndtWzBdKTsKPiAg
Cj4gIAlpZiAoSVNfSEFTV0VMTChkZXZfcHJpdikgfHwgSVNfQlJPQURXRUxMKGRldl9wcml2KSkK
PiAtCQlwaXBlX3dtLT5saW5ldGltZSA9IGhzd19jb21wdXRlX2xpbmV0aW1lX3dtKGNzdGF0ZSk7
Cj4gKwkJcGlwZV93bS0+bGluZXRpbWUgPSBoc3dfY29tcHV0ZV9saW5ldGltZV93bShjcnRjX3N0
YXRlKTsKPiAgCj4gIAlpZiAoIWlsa192YWxpZGF0ZV9waXBlX3dtKGRldl9wcml2LCBwaXBlX3dt
KSkKPiAgCQlyZXR1cm4gLUVJTlZBTDsKPiBAQCAtMzE2Miw3ICszMTYyLDcgQEAgc3RhdGljIGlu
dCBpbGtfY29tcHV0ZV9waXBlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4g
IAlmb3IgKGxldmVsID0gMTsgbGV2ZWwgPD0gdXNhYmxlX2xldmVsOyBsZXZlbCsrKSB7Cj4gIAkJ
c3RydWN0IGludGVsX3dtX2xldmVsICp3bSA9ICZwaXBlX3dtLT53bVtsZXZlbF07Cj4gIAo+IC0J
CWlsa19jb21wdXRlX3dtX2xldmVsKGRldl9wcml2LCBpbnRlbF9jcnRjLCBsZXZlbCwgY3N0YXRl
LAo+ICsJCWlsa19jb21wdXRlX3dtX2xldmVsKGRldl9wcml2LCBpbnRlbF9jcnRjLCBsZXZlbCwg
Y3J0Y19zdGF0ZSwKPiAgCQkJCSAgICAgcHJpc3RhdGUsIHNwcnN0YXRlLCBjdXJzdGF0ZSwgd20p
Owo+ICAKPiAgCQkvKgo+IEBAIC0zNzQyLDcgKzM3NDIsNyBAQCBib29sIGludGVsX2Nhbl9lbmFi
bGVfc2FndihzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAgCXN0cnVjdCBpbnRlbF9j
cnRjICpjcnRjOwo+ICAJc3RydWN0IGludGVsX3BsYW5lICpwbGFuZTsKPiAtCXN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjc3RhdGU7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19z
dGF0ZTsKPiAgCWVudW0gcGlwZSBwaXBlOwo+ICAJaW50IGxldmVsLCBsYXRlbmN5Owo+ICAJaW50
IHNhZ3ZfYmxvY2tfdGltZV91czsKPiBAQCAtMzc3MywxNCArMzc3MywxNCBAQCBib29sIGludGVs
X2Nhbl9lbmFibGVfc2FndihzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgCS8q
IFNpbmNlIHdlJ3JlIG5vdyBndWFyYW50ZWVkIHRvIG9ubHkgaGF2ZSBvbmUgYWN0aXZlIENSVEMu
Li4gKi8KPiAgCXBpcGUgPSBmZnMoc3RhdGUtPmFjdGl2ZV9jcnRjcykgLSAxOwo+ICAJY3J0YyA9
IGludGVsX2dldF9jcnRjX2Zvcl9waXBlKGRldl9wcml2LCBwaXBlKTsKPiAtCWNzdGF0ZSA9IHRv
X2ludGVsX2NydGNfc3RhdGUoY3J0Yy0+YmFzZS5zdGF0ZSk7Cj4gKwljcnRjX3N0YXRlID0gdG9f
aW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiAgCj4gIAlpZiAoY3J0Yy0+YmFz
ZS5zdGF0ZS0+YWRqdXN0ZWRfbW9kZS5mbGFncyAmIERSTV9NT0RFX0ZMQUdfSU5URVJMQUNFKQo+
ICAJCXJldHVybiBmYWxzZTsKPiAgCj4gIAlmb3JfZWFjaF9pbnRlbF9wbGFuZV9vbl9jcnRjKGRl
diwgY3J0YywgcGxhbmUpIHsKPiAgCQlzdHJ1Y3Qgc2tsX3BsYW5lX3dtICp3bSA9Cj4gLQkJCSZj
c3RhdGUtPndtLnNrbC5vcHRpbWFsLnBsYW5lc1twbGFuZS0+aWRdOwo+ICsJCQkmY3J0Y19zdGF0
ZS0+d20uc2tsLm9wdGltYWwucGxhbmVzW3BsYW5lLT5pZF07Cj4gIAo+ICAJCS8qIFNraXAgdGhp
cyBwbGFuZSBpZiBpdCdzIG5vdCBlbmFibGVkICovCj4gIAkJaWYgKCF3bS0+d21bMF0ucGxhbmVf
ZW4pCj4gQEAgLTM4MTEsNyArMzgxMSw3IEBAIGJvb2wgaW50ZWxfY2FuX2VuYWJsZV9zYWd2KHN0
cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICB9Cj4gIAo+ICBzdGF0aWMgdTE2IGlu
dGVsX2dldF9kZGJfc2l6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gLQkJ
CSAgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gKwkJCSAgICAg
IGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJCQkgICAgICBj
b25zdCB1NjQgdG90YWxfZGF0YV9yYXRlLAo+ICAJCQkgICAgICBjb25zdCBpbnQgbnVtX2FjdGl2
ZSwKPiAgCQkJICAgICAgc3RydWN0IHNrbF9kZGJfYWxsb2NhdGlvbiAqZGRiKQo+IEBAIC0zODI1
LDcgKzM4MjUsNyBAQCBzdGF0aWMgdTE2IGludGVsX2dldF9kZGJfc2l6ZShzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gIAlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA8IDExKQo+
ICAJCXJldHVybiBkZGJfc2l6ZSAtIDQ7IC8qIDQgYmxvY2tzIGZvciBieXBhc3MgcGF0aCBhbGxv
Y2F0aW9uICovCj4gIAo+IC0JYWRqdXN0ZWRfbW9kZSA9ICZjc3RhdGUtPmJhc2UuYWRqdXN0ZWRf
bW9kZTsKPiArCWFkanVzdGVkX21vZGUgPSAmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2Rl
Owo+ICAJdG90YWxfZGF0YV9idyA9IHRvdGFsX2RhdGFfcmF0ZSAqIGRybV9tb2RlX3ZyZWZyZXNo
KGFkanVzdGVkX21vZGUpOwo+ICAKPiAgCS8qCj4gQEAgLTM4NDgsMjMgKzM4NDgsMjIgQEAgc3Rh
dGljIHUxNiBpbnRlbF9nZXRfZGRiX3NpemUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2LAo+ICAKPiAgc3RhdGljIHZvaWQKPiAgc2tsX2RkYl9nZXRfcGlwZV9hbGxvY2F0aW9uX2xp
bWl0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCj4gLQkJCQkgICBjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ICsJCQkJICAgY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIAkJCQkgICBjb25zdCB1NjQgdG90YWxfZGF0
YV9yYXRlLAo+ICAJCQkJICAgc3RydWN0IHNrbF9kZGJfYWxsb2NhdGlvbiAqZGRiLAo+ICAJCQkJ
ICAgc3RydWN0IHNrbF9kZGJfZW50cnkgKmFsbG9jLCAvKiBvdXQgKi8KPiAgCQkJCSAgIGludCAq
bnVtX2FjdGl2ZSAvKiBvdXQgKi8pCj4gIHsKPiAtCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpz
dGF0ZSA9IGNzdGF0ZS0+YmFzZS5zdGF0ZTsKPiArCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpz
dGF0ZSA9IGNydGNfc3RhdGUtPmJhc2Uuc3RhdGU7Cj4gIAlzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0
YXRlICppbnRlbF9zdGF0ZSA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShzdGF0ZSk7Cj4gLQlzdHJ1
Y3QgZHJtX2NydGMgKmZvcl9jcnRjID0gY3N0YXRlLT5iYXNlLmNydGM7Cj4gLQljb25zdCBzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGU7Cj4gLQljb25zdCBzdHJ1Y3QgZHJtX2NydGMg
KmNydGM7Cj4gKwlzdHJ1Y3QgZHJtX2NydGMgKmZvcl9jcnRjID0gY3J0Y19zdGF0ZS0+YmFzZS5j
cnRjOwo+ICsJY29uc3Qgc3RydWN0IGludGVsX2NydGMgKmNydGM7Cj4gIAl1MzIgcGlwZV93aWR0
aCA9IDAsIHRvdGFsX3dpZHRoID0gMCwgd2lkdGhfYmVmb3JlX3BpcGUgPSAwOwo+ICAJZW51bSBw
aXBlIGZvcl9waXBlID0gdG9faW50ZWxfY3J0Yyhmb3JfY3J0YyktPnBpcGU7Cj4gIAl1MTYgZGRi
X3NpemU7Cj4gIAl1MzIgaTsKPiAgCj4gLQlpZiAoV0FSTl9PTighc3RhdGUpIHx8ICFjc3RhdGUt
PmJhc2UuYWN0aXZlKSB7Cj4gKwlpZiAoV0FSTl9PTighc3RhdGUpIHx8ICFjcnRjX3N0YXRlLT5i
YXNlLmFjdGl2ZSkgewo+ICAJCWFsbG9jLT5zdGFydCA9IDA7Cj4gIAkJYWxsb2MtPmVuZCA9IDA7
Cj4gIAkJKm51bV9hY3RpdmUgPSBod2VpZ2h0MzIoZGV2X3ByaXYtPmFjdGl2ZV9jcnRjcyk7Cj4g
QEAgLTM4NzYsNyArMzg3NSw3IEBAIHNrbF9kZGJfZ2V0X3BpcGVfYWxsb2NhdGlvbl9saW1pdHMo
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAJZWxzZQo+ICAJCSpudW1fYWN0
aXZlID0gaHdlaWdodDMyKGRldl9wcml2LT5hY3RpdmVfY3J0Y3MpOwo+ICAKPiAtCWRkYl9zaXpl
ID0gaW50ZWxfZ2V0X2RkYl9zaXplKGRldl9wcml2LCBjc3RhdGUsIHRvdGFsX2RhdGFfcmF0ZSwK
PiArCWRkYl9zaXplID0gaW50ZWxfZ2V0X2RkYl9zaXplKGRldl9wcml2LCBjcnRjX3N0YXRlLCB0
b3RhbF9kYXRhX3JhdGUsCj4gIAkJCQkgICAgICAqbnVtX2FjdGl2ZSwgZGRiKTsKPiAgCj4gIAkv
Kgo+IEBAIC0zOTAxLDE2ICszOTAwLDE1IEBAIHNrbF9kZGJfZ2V0X3BpcGVfYWxsb2NhdGlvbl9s
aW1pdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAJICogZnJhbWVidWZm
ZXIsIFNvIGluc3RlYWQgb2YgYWxsb2NhdGluZyBEREIgZXF1YWxseSBhbW9uZyBwaXBlcwo+ICAJ
ICogZGlzdHJpYnV0ZSBEREIgYmFzZWQgb24gcmVzb2x1dGlvbi93aWR0aCBvZiB0aGUgZGlzcGxh
eS4KPiAgCSAqLwo+IC0JZm9yX2VhY2hfbmV3X2NydGNfaW5fc3RhdGUoc3RhdGUsIGNydGMsIGNy
dGNfc3RhdGUsIGkpIHsKPiAtCQljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqYWRqdXN0
ZWRfbW9kZTsKPiArCWZvcl9lYWNoX25ld19pbnRlbF9jcnRjX2luX3N0YXRlKGludGVsX3N0YXRl
LCBjcnRjLCBjcnRjX3N0YXRlLCBpKSB7Cj4gKwkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKmFkanVzdGVkX21vZGUgPQo+ICsJCQkmY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2Rl
Owo+ICsJCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKPiAgCQlpbnQgaGRpc3BsYXksIHZk
aXNwbGF5Owo+IC0JCWVudW0gcGlwZSBwaXBlOwo+ICAKPiAtCQlpZiAoIWNydGNfc3RhdGUtPmVu
YWJsZSkKPiArCQlpZiAoIWNydGNfc3RhdGUtPmJhc2UuZW5hYmxlKQo+ICAJCQljb250aW51ZTsK
PiAgCj4gLQkJcGlwZSA9IHRvX2ludGVsX2NydGMoY3J0YyktPnBpcGU7Cj4gLQkJYWRqdXN0ZWRf
bW9kZSA9ICZjcnRjX3N0YXRlLT5hZGp1c3RlZF9tb2RlOwo+ICAJCWRybV9tb2RlX2dldF9odl90
aW1pbmcoYWRqdXN0ZWRfbW9kZSwgJmhkaXNwbGF5LCAmdmRpc3BsYXkpOwo+ICAJCXRvdGFsX3dp
ZHRoICs9IGhkaXNwbGF5Owo+ICAKPiBAQCAtMzkyOSw3ICszOTI3LDcgQEAgc3RhdGljIGludCBz
a2xfY29tcHV0ZV93bV9wYXJhbXMoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCj4gIAkJCQkgdTY0IG1vZGlmaWVyLCB1bnNpZ25lZCBpbnQgcm90YXRpb24sCj4gIAkJ
CQkgdTMyIHBsYW5lX3BpeGVsX3JhdGUsIHN0cnVjdCBza2xfd21fcGFyYW1zICp3cCwKPiAgCQkJ
CSBpbnQgY29sb3JfcGxhbmUpOwo+IC1zdGF0aWMgdm9pZCBza2xfY29tcHV0ZV9wbGFuZV93bShj
b25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ICtzdGF0aWMgdm9pZCBza2xf
Y29tcHV0ZV9wbGFuZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0
ZSwKPiAgCQkJCSBpbnQgbGV2ZWwsCj4gIAkJCQkgY29uc3Qgc3RydWN0IHNrbF93bV9wYXJhbXMg
KndwLAo+ICAJCQkJIGNvbnN0IHN0cnVjdCBza2xfd21fbGV2ZWwgKnJlc3VsdF9wcmV2LAo+IEBA
IC00MDYxLDE1ICs0MDU5LDE1IEBAIHZvaWQgc2tsX2RkYl9nZXRfaHdfc3RhdGUoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAo+ICAgKiBDYWxsZXIgc2hvdWxkIHRha2UgY2FyZSBv
ZiBkaXZpZGluZyAmIHJvdW5kaW5nIG9mZiB0aGUgdmFsdWUuCj4gICAqLwo+ICBzdGF0aWMgdWlu
dF9maXhlZF8xNl8xNl90Cj4gLXNrbF9wbGFuZV9kb3duc2NhbGVfYW1vdW50KGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUsCj4gLQkJCSAgIGNvbnN0IHN0cnVjdCBpbnRlbF9w
bGFuZV9zdGF0ZSAqcHN0YXRlKQo+ICtza2xfcGxhbmVfZG93bnNjYWxlX2Ftb3VudChjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiArCQkJICAgY29uc3Qgc3RydWN0
IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX3Bs
YW5lICpwbGFuZSA9IHRvX2ludGVsX3BsYW5lKHBzdGF0ZS0+YmFzZS5wbGFuZSk7Cj4gKwlzdHJ1
Y3QgaW50ZWxfcGxhbmUgKnBsYW5lID0gdG9faW50ZWxfcGxhbmUocGxhbmVfc3RhdGUtPmJhc2Uu
cGxhbmUpOwo+ICAJdTMyIHNyY193LCBzcmNfaCwgZHN0X3csIGRzdF9oOwo+ICAJdWludF9maXhl
ZF8xNl8xNl90IGZwX3dfcmF0aW8sIGZwX2hfcmF0aW87Cj4gIAl1aW50X2ZpeGVkXzE2XzE2X3Qg
ZG93bnNjYWxlX2gsIGRvd25zY2FsZV93Owo+ICAKPiAtCWlmIChXQVJOX09OKCFpbnRlbF93bV9w
bGFuZV92aXNpYmxlKGNzdGF0ZSwgcHN0YXRlKSkpCj4gKwlpZiAoV0FSTl9PTighaW50ZWxfd21f
cGxhbmVfdmlzaWJsZShjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSkpKQo+ICAJCXJldHVybiB1MzJf
dG9fZml4ZWQxNigwKTsKPiAgCj4gIAkvKiBuLmIuLCBzcmMgaXMgMTYuMTYgZml4ZWQgcG9pbnQs
IGRzdCBpcyB3aG9sZSBpbnRlZ2VyICovCj4gQEAgLTQwNzgsMjAgKzQwNzYsMjAgQEAgc2tsX3Bs
YW5lX2Rvd25zY2FsZV9hbW91bnQoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0
ZSwKPiAgCQkgKiBDdXJzb3JzIG9ubHkgc3VwcG9ydCAwLzE4MCBkZWdyZWUgcm90YXRpb24sCj4g
IAkJICogaGVuY2Ugbm8gbmVlZCB0byBhY2NvdW50IGZvciByb3RhdGlvbiBoZXJlLgo+ICAJCSAq
Lwo+IC0JCXNyY193ID0gcHN0YXRlLT5iYXNlLnNyY193ID4+IDE2Owo+IC0JCXNyY19oID0gcHN0
YXRlLT5iYXNlLnNyY19oID4+IDE2Owo+IC0JCWRzdF93ID0gcHN0YXRlLT5iYXNlLmNydGNfdzsK
PiAtCQlkc3RfaCA9IHBzdGF0ZS0+YmFzZS5jcnRjX2g7Cj4gKwkJc3JjX3cgPSBwbGFuZV9zdGF0
ZS0+YmFzZS5zcmNfdyA+PiAxNjsKPiArCQlzcmNfaCA9IHBsYW5lX3N0YXRlLT5iYXNlLnNyY19o
ID4+IDE2Owo+ICsJCWRzdF93ID0gcGxhbmVfc3RhdGUtPmJhc2UuY3J0Y193Owo+ICsJCWRzdF9o
ID0gcGxhbmVfc3RhdGUtPmJhc2UuY3J0Y19oOwo+ICAJfSBlbHNlIHsKPiAgCQkvKgo+ICAJCSAq
IFNyYyBjb29yZGluYXRlcyBhcmUgYWxyZWFkeSByb3RhdGVkIGJ5IDI3MCBkZWdyZWVzIGZvcgo+
ICAJCSAqIHRoZSA5MC8yNzAgZGVncmVlIHBsYW5lIHJvdGF0aW9uIGNhc2VzICh0byBtYXRjaCB0
aGUKPiAgCQkgKiBHVFQgbWFwcGluZyksIGhlbmNlIG5vIG5lZWQgdG8gYWNjb3VudCBmb3Igcm90
YXRpb24gaGVyZS4KPiAgCQkgKi8KPiAtCQlzcmNfdyA9IGRybV9yZWN0X3dpZHRoKCZwc3RhdGUt
PmJhc2Uuc3JjKSA+PiAxNjsKPiAtCQlzcmNfaCA9IGRybV9yZWN0X2hlaWdodCgmcHN0YXRlLT5i
YXNlLnNyYykgPj4gMTY7Cj4gLQkJZHN0X3cgPSBkcm1fcmVjdF93aWR0aCgmcHN0YXRlLT5iYXNl
LmRzdCk7Cj4gLQkJZHN0X2ggPSBkcm1fcmVjdF9oZWlnaHQoJnBzdGF0ZS0+YmFzZS5kc3QpOwo+
ICsJCXNyY193ID0gZHJtX3JlY3Rfd2lkdGgoJnBsYW5lX3N0YXRlLT5iYXNlLnNyYykgPj4gMTY7
Cj4gKwkJc3JjX2ggPSBkcm1fcmVjdF9oZWlnaHQoJnBsYW5lX3N0YXRlLT5iYXNlLnNyYykgPj4g
MTY7Cj4gKwkJZHN0X3cgPSBkcm1fcmVjdF93aWR0aCgmcGxhbmVfc3RhdGUtPmJhc2UuZHN0KTsK
PiArCQlkc3RfaCA9IGRybV9yZWN0X2hlaWdodCgmcGxhbmVfc3RhdGUtPmJhc2UuZHN0KTsKPiAg
CX0KPiAgCj4gIAlmcF93X3JhdGlvID0gZGl2X2ZpeGVkMTYoc3JjX3csIGRzdF93KTsKPiBAQCAt
NDEzNiw0OSArNDEzNCw0NiBAQCBza2xfcGlwZV9kb3duc2NhbGVfYW1vdW50KGNvbnN0IHN0cnVj
dCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB9Cj4gIAo+ICBpbnQgc2tsX2NoZWNr
X3BpcGVfbWF4X3BpeGVsX3JhdGUoc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMsCj4gLQkJ
CQkgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4gKwkJCQkgIHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGludGVsX2NydGMtPmJhc2UuZGV2KTsKPiAtCXN0cnVjdCBk
cm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9ICZjc3RhdGUtPmJhc2U7Cj4gLQlzdHJ1Y3QgZHJt
X2F0b21pY19zdGF0ZSAqc3RhdGUgPSBjcnRjX3N0YXRlLT5zdGF0ZTsKPiArCXN0cnVjdCBkcm1f
YXRvbWljX3N0YXRlICpzdGF0ZSA9IGNydGNfc3RhdGUtPmJhc2Uuc3RhdGU7Cj4gIAlzdHJ1Y3Qg
ZHJtX3BsYW5lICpwbGFuZTsKPiAtCWNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnBzdGF0
ZTsKPiAtCXN0cnVjdCBpbnRlbF9wbGFuZV9zdGF0ZSAqaW50ZWxfcHN0YXRlOwo+ICsJY29uc3Qg
c3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqZHJtX3BsYW5lX3N0YXRlOwo+ICAJaW50IGNydGNfY2xv
Y2ssIGRvdGNsazsKPiAgCXUzMiBwaXBlX21heF9waXhlbF9yYXRlOwo+ICAJdWludF9maXhlZF8x
Nl8xNl90IHBpcGVfZG93bnNjYWxlOwo+ICAJdWludF9maXhlZF8xNl8xNl90IG1heF9kb3duc2Nh
bGUgPSB1MzJfdG9fZml4ZWQxNigxKTsKPiAgCj4gLQlpZiAoIWNzdGF0ZS0+YmFzZS5lbmFibGUp
Cj4gKwlpZiAoIWNydGNfc3RhdGUtPmJhc2UuZW5hYmxlKQo+ICAJCXJldHVybiAwOwo+ICAKPiAt
CWRybV9hdG9taWNfY3J0Y19zdGF0ZV9mb3JfZWFjaF9wbGFuZV9zdGF0ZShwbGFuZSwgcHN0YXRl
LCBjcnRjX3N0YXRlKSB7Cj4gKwlkcm1fYXRvbWljX2NydGNfc3RhdGVfZm9yX2VhY2hfcGxhbmVf
c3RhdGUocGxhbmUsIGRybV9wbGFuZV9zdGF0ZSwgJmNydGNfc3RhdGUtPmJhc2UpIHsKPiAgCQl1
aW50X2ZpeGVkXzE2XzE2X3QgcGxhbmVfZG93bnNjYWxlOwo+ICAJCXVpbnRfZml4ZWRfMTZfMTZf
dCBmcF85X2Rpdl84ID0gZGl2X2ZpeGVkMTYoOSwgOCk7Cj4gIAkJaW50IGJwcDsKPiArCQljb25z
dCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlID0KPiArCQkJdG9faW50ZWxf
cGxhbmVfc3RhdGUoZHJtX3BsYW5lX3N0YXRlKTsKPiAgCj4gLQkJaWYgKCFpbnRlbF93bV9wbGFu
ZV92aXNpYmxlKGNzdGF0ZSwKPiAtCQkJCQkgICAgdG9faW50ZWxfcGxhbmVfc3RhdGUocHN0YXRl
KSkpCj4gKwkJaWYgKCFpbnRlbF93bV9wbGFuZV92aXNpYmxlKGNydGNfc3RhdGUsIHBsYW5lX3N0
YXRlKSkKPiAgCQkJY29udGludWU7Cj4gIAo+IC0JCWlmIChXQVJOX09OKCFwc3RhdGUtPmZiKSkK
PiArCQlpZiAoV0FSTl9PTighcGxhbmVfc3RhdGUtPmJhc2UuZmIpKQo+ICAJCQlyZXR1cm4gLUVJ
TlZBTDsKPiAgCj4gLQkJaW50ZWxfcHN0YXRlID0gdG9faW50ZWxfcGxhbmVfc3RhdGUocHN0YXRl
KTsKPiAtCQlwbGFuZV9kb3duc2NhbGUgPSBza2xfcGxhbmVfZG93bnNjYWxlX2Ftb3VudChjc3Rh
dGUsCj4gLQkJCQkJCQkgICAgIGludGVsX3BzdGF0ZSk7Cj4gLQkJYnBwID0gcHN0YXRlLT5mYi0+
Zm9ybWF0LT5jcHBbMF0gKiA4Owo+ICsJCXBsYW5lX2Rvd25zY2FsZSA9IHNrbF9wbGFuZV9kb3du
c2NhbGVfYW1vdW50KGNydGNfc3RhdGUsIHBsYW5lX3N0YXRlKTsKPiArCQlicHAgPSBwbGFuZV9z
dGF0ZS0+YmFzZS5mYi0+Zm9ybWF0LT5jcHBbMF0gKiA4Owo+ICAJCWlmIChicHAgPT0gNjQpCj4g
IAkJCXBsYW5lX2Rvd25zY2FsZSA9IG11bF9maXhlZDE2KHBsYW5lX2Rvd25zY2FsZSwKPiAgCQkJ
CQkJICAgICAgZnBfOV9kaXZfOCk7Cj4gIAo+ICAJCW1heF9kb3duc2NhbGUgPSBtYXhfZml4ZWQx
NihwbGFuZV9kb3duc2NhbGUsIG1heF9kb3duc2NhbGUpOwo+ICAJfQo+IC0JcGlwZV9kb3duc2Nh
bGUgPSBza2xfcGlwZV9kb3duc2NhbGVfYW1vdW50KGNzdGF0ZSk7Cj4gKwlwaXBlX2Rvd25zY2Fs
ZSA9IHNrbF9waXBlX2Rvd25zY2FsZV9hbW91bnQoY3J0Y19zdGF0ZSk7Cj4gIAo+ICAJcGlwZV9k
b3duc2NhbGUgPSBtdWxfZml4ZWQxNihwaXBlX2Rvd25zY2FsZSwgbWF4X2Rvd25zY2FsZSk7Cj4g
IAo+IC0JY3J0Y19jbG9jayA9IGNydGNfc3RhdGUtPmFkanVzdGVkX21vZGUuY3J0Y19jbG9jazsK
PiArCWNydGNfY2xvY2sgPSBjcnRjX3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19jbG9j
azsKPiAgCWRvdGNsayA9IHRvX2ludGVsX2F0b21pY19zdGF0ZShzdGF0ZSktPmNkY2xrLmxvZ2lj
YWwuY2RjbGs7Cj4gIAo+ICAJaWYgKElTX0dFTUlOSUxBS0UoZGV2X3ByaXYpIHx8IElOVEVMX0dF
TihkZXZfcHJpdikgPj0gMTApCj4gQEAgLTQxOTUsMTIgKzQxOTAsMTEgQEAgaW50IHNrbF9jaGVj
a19waXBlX21heF9waXhlbF9yYXRlKHN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjLAo+ICB9
Cj4gIAo+ICBzdGF0aWMgdTY0Cj4gLXNrbF9wbGFuZV9yZWxhdGl2ZV9kYXRhX3JhdGUoY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAtCQkJICAgICBjb25zdCBzdHJ1Y3Qg
aW50ZWxfcGxhbmVfc3RhdGUgKmludGVsX3BzdGF0ZSwKPiArc2tsX3BsYW5lX3JlbGF0aXZlX2Rh
dGFfcmF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiArCQkJ
ICAgICBjb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlLAo+ICAJCQkg
ICAgIGNvbnN0IGludCBwbGFuZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX3BsYW5lICppbnRlbF9w
bGFuZSA9Cj4gLQkJdG9faW50ZWxfcGxhbmUoaW50ZWxfcHN0YXRlLT5iYXNlLnBsYW5lKTsKPiAr
CXN0cnVjdCBpbnRlbF9wbGFuZSAqaW50ZWxfcGxhbmUgPSB0b19pbnRlbF9wbGFuZShwbGFuZV9z
dGF0ZS0+YmFzZS5wbGFuZSk7Cj4gIAl1MzIgZGF0YV9yYXRlOwo+ICAJdTMyIHdpZHRoID0gMCwg
aGVpZ2h0ID0gMDsKPiAgCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiOwo+IEBAIC00MjA4LDEw
ICs0MjAyLDEwIEBAIHNrbF9wbGFuZV9yZWxhdGl2ZV9kYXRhX3JhdGUoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAgCXVpbnRfZml4ZWRfMTZfMTZfdCBkb3duX3NjYWxl
X2Ftb3VudDsKPiAgCXU2NCByYXRlOwo+ICAKPiAtCWlmICghaW50ZWxfcHN0YXRlLT5iYXNlLnZp
c2libGUpCj4gKwlpZiAoIXBsYW5lX3N0YXRlLT5iYXNlLnZpc2libGUpCj4gIAkJcmV0dXJuIDA7
Cj4gIAo+IC0JZmIgPSBpbnRlbF9wc3RhdGUtPmJhc2UuZmI7Cj4gKwlmYiA9IHBsYW5lX3N0YXRl
LT5iYXNlLmZiOwo+ICAJZm9ybWF0ID0gZmItPmZvcm1hdC0+Zm9ybWF0Owo+ICAKPiAgCWlmIChp
bnRlbF9wbGFuZS0+aWQgPT0gUExBTkVfQ1VSU09SKQo+IEBAIC00MjI0LDggKzQyMTgsOCBAQCBz
a2xfcGxhbmVfcmVsYXRpdmVfZGF0YV9yYXRlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjc3RhdGUsCj4gIAkgKiB0aGUgOTAvMjcwIGRlZ3JlZSBwbGFuZSByb3RhdGlvbiBjYXNlcyAo
dG8gbWF0Y2ggdGhlCj4gIAkgKiBHVFQgbWFwcGluZyksIGhlbmNlIG5vIG5lZWQgdG8gYWNjb3Vu
dCBmb3Igcm90YXRpb24gaGVyZS4KPiAgCSAqLwo+IC0Jd2lkdGggPSBkcm1fcmVjdF93aWR0aCgm
aW50ZWxfcHN0YXRlLT5iYXNlLnNyYykgPj4gMTY7Cj4gLQloZWlnaHQgPSBkcm1fcmVjdF9oZWln
aHQoJmludGVsX3BzdGF0ZS0+YmFzZS5zcmMpID4+IDE2Owo+ICsJd2lkdGggPSBkcm1fcmVjdF93
aWR0aCgmcGxhbmVfc3RhdGUtPmJhc2Uuc3JjKSA+PiAxNjsKPiArCWhlaWdodCA9IGRybV9yZWN0
X2hlaWdodCgmcGxhbmVfc3RhdGUtPmJhc2Uuc3JjKSA+PiAxNjsKPiAgCj4gIAkvKiBVViBwbGFu
ZSBkb2VzIDEvMiBwaXhlbCBzdWItc2FtcGxpbmcgKi8KPiAgCWlmIChwbGFuZSA9PSAxICYmIGlz
X3BsYW5hcl95dXZfZm9ybWF0KGZvcm1hdCkpIHsKPiBAQCAtNDIzNSw3ICs0MjI5LDcgQEAgc2ts
X3BsYW5lX3JlbGF0aXZlX2RhdGFfcmF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAq
Y3N0YXRlLAo+ICAKPiAgCWRhdGFfcmF0ZSA9IHdpZHRoICogaGVpZ2h0Owo+ICAKPiAtCWRvd25f
c2NhbGVfYW1vdW50ID0gc2tsX3BsYW5lX2Rvd25zY2FsZV9hbW91bnQoY3N0YXRlLCBpbnRlbF9w
c3RhdGUpOwo+ICsJZG93bl9zY2FsZV9hbW91bnQgPSBza2xfcGxhbmVfZG93bnNjYWxlX2Ftb3Vu
dChjcnRjX3N0YXRlLCBwbGFuZV9zdGF0ZSk7Cj4gIAo+ICAJcmF0ZSA9IG11bF9yb3VuZF91cF91
MzJfZml4ZWQxNihkYXRhX3JhdGUsIGRvd25fc2NhbGVfYW1vdW50KTsKPiAgCj4gQEAgLTQyNDQs
MzUgKzQyMzgsMzIgQEAgc2tsX3BsYW5lX3JlbGF0aXZlX2RhdGFfcmF0ZShjb25zdCBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ICB9Cj4gIAo+ICBzdGF0aWMgdTY0Cj4gLXNrbF9n
ZXRfdG90YWxfcmVsYXRpdmVfZGF0YV9yYXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICppbnRl
bF9jc3RhdGUsCj4gK3NrbF9nZXRfdG90YWxfcmVsYXRpdmVfZGF0YV9yYXRlKHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJCQkJIHU2NCAqcGxhbmVfZGF0YV9yYXRlLAo+
ICAJCQkJIHU2NCAqdXZfcGxhbmVfZGF0YV9yYXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2NydGNf
c3RhdGUgKmNzdGF0ZSA9ICZpbnRlbF9jc3RhdGUtPmJhc2U7Cj4gLQlzdHJ1Y3QgZHJtX2F0b21p
Y19zdGF0ZSAqc3RhdGUgPSBjc3RhdGUtPnN0YXRlOwo+ICsJc3RydWN0IGRybV9hdG9taWNfc3Rh
dGUgKnN0YXRlID0gY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiAgCXN0cnVjdCBkcm1fcGxhbmUg
KnBsYW5lOwo+IC0JY29uc3Qgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqcHN0YXRlOwo+ICsJY29u
c3Qgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqZHJtX3BsYW5lX3N0YXRlOwo+ICAJdTY0IHRvdGFs
X2RhdGFfcmF0ZSA9IDA7Cj4gIAo+ICAJaWYgKFdBUk5fT04oIXN0YXRlKSkKPiAgCQlyZXR1cm4g
MDsKPiAgCj4gIAkvKiBDYWxjdWxhdGUgYW5kIGNhY2hlIGRhdGEgcmF0ZSBmb3IgZWFjaCBwbGFu
ZSAqLwo+IC0JZHJtX2F0b21pY19jcnRjX3N0YXRlX2Zvcl9lYWNoX3BsYW5lX3N0YXRlKHBsYW5l
LCBwc3RhdGUsIGNzdGF0ZSkgewo+ICsJZHJtX2F0b21pY19jcnRjX3N0YXRlX2Zvcl9lYWNoX3Bs
YW5lX3N0YXRlKHBsYW5lLCBkcm1fcGxhbmVfc3RhdGUsICZjcnRjX3N0YXRlLT5iYXNlKSB7Cj4g
IAkJZW51bSBwbGFuZV9pZCBwbGFuZV9pZCA9IHRvX2ludGVsX3BsYW5lKHBsYW5lKS0+aWQ7Cj4g
KwkJY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0ZSA9Cj4gKwkJCXRv
X2ludGVsX3BsYW5lX3N0YXRlKGRybV9wbGFuZV9zdGF0ZSk7Cj4gIAkJdTY0IHJhdGU7Cj4gLQkJ
Y29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICppbnRlbF9wc3RhdGUgPQo+IC0JCQl0b19p
bnRlbF9wbGFuZV9zdGF0ZShwc3RhdGUpOwo+ICAKPiAgCQkvKiBwYWNrZWQveSAqLwo+IC0JCXJh
dGUgPSBza2xfcGxhbmVfcmVsYXRpdmVfZGF0YV9yYXRlKGludGVsX2NzdGF0ZSwKPiAtCQkJCQkJ
ICAgIGludGVsX3BzdGF0ZSwgMCk7Cj4gKwkJcmF0ZSA9IHNrbF9wbGFuZV9yZWxhdGl2ZV9kYXRh
X3JhdGUoY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUsIDApOwo+ICAJCXBsYW5lX2RhdGFfcmF0ZVtw
bGFuZV9pZF0gPSByYXRlOwo+ICAJCXRvdGFsX2RhdGFfcmF0ZSArPSByYXRlOwo+ICAKPiAgCQkv
KiB1di1wbGFuZSAqLwo+IC0JCXJhdGUgPSBza2xfcGxhbmVfcmVsYXRpdmVfZGF0YV9yYXRlKGlu
dGVsX2NzdGF0ZSwKPiAtCQkJCQkJICAgIGludGVsX3BzdGF0ZSwgMSk7Cj4gKwkJcmF0ZSA9IHNr
bF9wbGFuZV9yZWxhdGl2ZV9kYXRhX3JhdGUoY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUsIDEpOwo+
ICAJCXV2X3BsYW5lX2RhdGFfcmF0ZVtwbGFuZV9pZF0gPSByYXRlOwo+ICAJCXRvdGFsX2RhdGFf
cmF0ZSArPSByYXRlOwo+ICAJfQo+IEBAIC00MjgxLDI4ICs0MjcyLDI1IEBAIHNrbF9nZXRfdG90
YWxfcmVsYXRpdmVfZGF0YV9yYXRlKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICppbnRlbF9jc3Rh
dGUsCj4gIH0KPiAgCj4gIHN0YXRpYyB1NjQKPiAtaWNsX2dldF90b3RhbF9yZWxhdGl2ZV9kYXRh
X3JhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmludGVsX2NzdGF0ZSwKPiAraWNsX2dldF90
b3RhbF9yZWxhdGl2ZV9kYXRhX3JhdGUoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGUsCj4gIAkJCQkgdTY0ICpwbGFuZV9kYXRhX3JhdGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1fY3J0
Y19zdGF0ZSAqY3N0YXRlID0gJmludGVsX2NzdGF0ZS0+YmFzZTsKPiAtCXN0cnVjdCBkcm1fYXRv
bWljX3N0YXRlICpzdGF0ZSA9IGNzdGF0ZS0+c3RhdGU7Cj4gIAlzdHJ1Y3QgZHJtX3BsYW5lICpw
bGFuZTsKPiAtCWNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnBzdGF0ZTsKPiArCWNvbnN0
IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKmRybV9wbGFuZV9zdGF0ZTsKPiAgCXU2NCB0b3RhbF9k
YXRhX3JhdGUgPSAwOwo+ICAKPiAtCWlmIChXQVJOX09OKCFzdGF0ZSkpCj4gKwlpZiAoV0FSTl9P
TighY3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZSkpCj4gIAkJcmV0dXJuIDA7Cj4gIAo+ICAJLyogQ2Fs
Y3VsYXRlIGFuZCBjYWNoZSBkYXRhIHJhdGUgZm9yIGVhY2ggcGxhbmUgKi8KPiAtCWRybV9hdG9t
aWNfY3J0Y19zdGF0ZV9mb3JfZWFjaF9wbGFuZV9zdGF0ZShwbGFuZSwgcHN0YXRlLCBjc3RhdGUp
IHsKPiAtCQljb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKmludGVsX3BzdGF0ZSA9Cj4g
LQkJCXRvX2ludGVsX3BsYW5lX3N0YXRlKHBzdGF0ZSk7Cj4gKwlkcm1fYXRvbWljX2NydGNfc3Rh
dGVfZm9yX2VhY2hfcGxhbmVfc3RhdGUocGxhbmUsIGRybV9wbGFuZV9zdGF0ZSwgJmNydGNfc3Rh
dGUtPmJhc2UpIHsKPiArCQljb25zdCBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0
YXRlID0KPiArCQkJdG9faW50ZWxfcGxhbmVfc3RhdGUoZHJtX3BsYW5lX3N0YXRlKTsKPiAgCQll
bnVtIHBsYW5lX2lkIHBsYW5lX2lkID0gdG9faW50ZWxfcGxhbmUocGxhbmUpLT5pZDsKPiAgCQl1
NjQgcmF0ZTsKPiAgCj4gLQkJaWYgKCFpbnRlbF9wc3RhdGUtPmxpbmtlZF9wbGFuZSkgewo+IC0J
CQlyYXRlID0gc2tsX3BsYW5lX3JlbGF0aXZlX2RhdGFfcmF0ZShpbnRlbF9jc3RhdGUsCj4gLQkJ
CQkJCQkgICAgaW50ZWxfcHN0YXRlLCAwKTsKPiArCQlpZiAoIXBsYW5lX3N0YXRlLT5saW5rZWRf
cGxhbmUpIHsKPiArCQkJcmF0ZSA9IHNrbF9wbGFuZV9yZWxhdGl2ZV9kYXRhX3JhdGUoY3J0Y19z
dGF0ZSwgcGxhbmVfc3RhdGUsIDApOwo+ICAJCQlwbGFuZV9kYXRhX3JhdGVbcGxhbmVfaWRdID0g
cmF0ZTsKPiAgCQkJdG90YWxfZGF0YV9yYXRlICs9IHJhdGU7Cj4gIAkJfSBlbHNlIHsKPiBAQCAt
NDMxNSwxOCArNDMwMywxNiBAQCBpY2xfZ2V0X3RvdGFsX3JlbGF0aXZlX2RhdGFfcmF0ZShzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqaW50ZWxfY3N0YXRlLAo+ICAJCQkgKiBOVUxMIGlmIHdlIHRy
eSBnZXRfbmV3X3BsYW5lX3N0YXRlKCksIHNvIHdlCj4gIAkJCSAqIGFsd2F5cyBjYWxjdWxhdGUg
ZnJvbSB0aGUgbWFzdGVyLgo+ICAJCQkgKi8KPiAtCQkJaWYgKGludGVsX3BzdGF0ZS0+c2xhdmUp
Cj4gKwkJCWlmIChwbGFuZV9zdGF0ZS0+c2xhdmUpCj4gIAkJCQljb250aW51ZTsKPiAgCj4gIAkJ
CS8qIFkgcGxhbmUgcmF0ZSBpcyBjYWxjdWxhdGVkIG9uIHRoZSBzbGF2ZSAqLwo+IC0JCQlyYXRl
ID0gc2tsX3BsYW5lX3JlbGF0aXZlX2RhdGFfcmF0ZShpbnRlbF9jc3RhdGUsCj4gLQkJCQkJCQkg
ICAgaW50ZWxfcHN0YXRlLCAwKTsKPiAtCQkJeV9wbGFuZV9pZCA9IGludGVsX3BzdGF0ZS0+bGlu
a2VkX3BsYW5lLT5pZDsKPiArCQkJcmF0ZSA9IHNrbF9wbGFuZV9yZWxhdGl2ZV9kYXRhX3JhdGUo
Y3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUsIDApOwo+ICsJCQl5X3BsYW5lX2lkID0gcGxhbmVfc3Rh
dGUtPmxpbmtlZF9wbGFuZS0+aWQ7Cj4gIAkJCXBsYW5lX2RhdGFfcmF0ZVt5X3BsYW5lX2lkXSA9
IHJhdGU7Cj4gIAkJCXRvdGFsX2RhdGFfcmF0ZSArPSByYXRlOwo+ICAKPiAtCQkJcmF0ZSA9IHNr
bF9wbGFuZV9yZWxhdGl2ZV9kYXRhX3JhdGUoaW50ZWxfY3N0YXRlLAo+IC0JCQkJCQkJICAgIGlu
dGVsX3BzdGF0ZSwgMSk7Cj4gKwkJCXJhdGUgPSBza2xfcGxhbmVfcmVsYXRpdmVfZGF0YV9yYXRl
KGNydGNfc3RhdGUsIHBsYW5lX3N0YXRlLCAxKTsKPiAgCQkJcGxhbmVfZGF0YV9yYXRlW3BsYW5l
X2lkXSA9IHJhdGU7Cj4gIAkJCXRvdGFsX2RhdGFfcmF0ZSArPSByYXRlOwo+ICAJCX0KPiBAQCAt
NDMzNiwxNCArNDMyMiwxNCBAQCBpY2xfZ2V0X3RvdGFsX3JlbGF0aXZlX2RhdGFfcmF0ZShzdHJ1
Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqaW50ZWxfY3N0YXRlLAo+ICB9Cj4gIAo+ICBzdGF0aWMgaW50
Cj4gLXNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRl
LAo+ICtza2xfYWxsb2NhdGVfcGlwZV9kZGIoc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNf
c3RhdGUsCj4gIAkJICAgICAgc3RydWN0IHNrbF9kZGJfYWxsb2NhdGlvbiAqZGRiIC8qIG91dCAq
LykKPiAgewo+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0gY3N0YXRlLT5iYXNl
LnN0YXRlOwo+IC0Jc3RydWN0IGRybV9jcnRjICpjcnRjID0gY3N0YXRlLT5iYXNlLmNydGM7Cj4g
KwlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUgPSBjcnRjX3N0YXRlLT5iYXNlLnN0YXRl
Owo+ICsJc3RydWN0IGRybV9jcnRjICpjcnRjID0gY3J0Y19zdGF0ZS0+YmFzZS5jcnRjOwo+ICAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjLT5kZXYpOwo+
ICAJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGMpOwo+
IC0Jc3RydWN0IHNrbF9kZGJfZW50cnkgKmFsbG9jID0gJmNzdGF0ZS0+d20uc2tsLmRkYjsKPiAr
CXN0cnVjdCBza2xfZGRiX2VudHJ5ICphbGxvYyA9ICZjcnRjX3N0YXRlLT53bS5za2wuZGRiOwo+
ICAJdTE2IGFsbG9jX3NpemUsIHN0YXJ0ID0gMDsKPiAgCXUxNiB0b3RhbFtJOTE1X01BWF9QTEFO
RVNdID0ge307Cj4gIAl1MTYgdXZfdG90YWxbSTkxNV9NQVhfUExBTkVTXSA9IHt9Owo+IEBAIC00
MzU2LDQwICs0MzQyLDQwIEBAIHNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3N0YXRlLAo+ICAJaW50IGxldmVsOwo+ICAKPiAgCS8qIENsZWFyIHRoZSBwYXJ0
aXRpb25pbmcgZm9yIGRpc2FibGVkIHBsYW5lcy4gKi8KPiAtCW1lbXNldChjc3RhdGUtPndtLnNr
bC5wbGFuZV9kZGJfeSwgMCwgc2l6ZW9mKGNzdGF0ZS0+d20uc2tsLnBsYW5lX2RkYl95KSk7Cj4g
LQltZW1zZXQoY3N0YXRlLT53bS5za2wucGxhbmVfZGRiX3V2LCAwLCBzaXplb2YoY3N0YXRlLT53
bS5za2wucGxhbmVfZGRiX3V2KSk7Cj4gKwltZW1zZXQoY3J0Y19zdGF0ZS0+d20uc2tsLnBsYW5l
X2RkYl95LCAwLCBzaXplb2YoY3J0Y19zdGF0ZS0+d20uc2tsLnBsYW5lX2RkYl95KSk7Cj4gKwlt
ZW1zZXQoY3J0Y19zdGF0ZS0+d20uc2tsLnBsYW5lX2RkYl91diwgMCwgc2l6ZW9mKGNydGNfc3Rh
dGUtPndtLnNrbC5wbGFuZV9kZGJfdXYpKTsKPiAgCj4gIAlpZiAoV0FSTl9PTighc3RhdGUpKQo+
ICAJCXJldHVybiAwOwo+ICAKPiAtCWlmICghY3N0YXRlLT5iYXNlLmFjdGl2ZSkgewo+ICsJaWYg
KCFjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkgewo+ICAJCWFsbG9jLT5zdGFydCA9IGFsbG9jLT5l
bmQgPSAwOwo+ICAJCXJldHVybiAwOwo+ICAJfQo+ICAKPiAgCWlmIChJTlRFTF9HRU4oZGV2X3By
aXYpID49IDExKQo+ICAJCXRvdGFsX2RhdGFfcmF0ZSA9Cj4gLQkJCWljbF9nZXRfdG90YWxfcmVs
YXRpdmVfZGF0YV9yYXRlKGNzdGF0ZSwKPiArCQkJaWNsX2dldF90b3RhbF9yZWxhdGl2ZV9kYXRh
X3JhdGUoY3J0Y19zdGF0ZSwKPiAgCQkJCQkJCSBwbGFuZV9kYXRhX3JhdGUpOwo+ICAJZWxzZQo+
ICAJCXRvdGFsX2RhdGFfcmF0ZSA9Cj4gLQkJCXNrbF9nZXRfdG90YWxfcmVsYXRpdmVfZGF0YV9y
YXRlKGNzdGF0ZSwKPiArCQkJc2tsX2dldF90b3RhbF9yZWxhdGl2ZV9kYXRhX3JhdGUoY3J0Y19z
dGF0ZSwKPiAgCQkJCQkJCSBwbGFuZV9kYXRhX3JhdGUsCj4gIAkJCQkJCQkgdXZfcGxhbmVfZGF0
YV9yYXRlKTsKPiAgCj4gIAo+IC0Jc2tsX2RkYl9nZXRfcGlwZV9hbGxvY2F0aW9uX2xpbWl0cyhk
ZXZfcHJpdiwgY3N0YXRlLCB0b3RhbF9kYXRhX3JhdGUsCj4gKwlza2xfZGRiX2dldF9waXBlX2Fs
bG9jYXRpb25fbGltaXRzKGRldl9wcml2LCBjcnRjX3N0YXRlLCB0b3RhbF9kYXRhX3JhdGUsCj4g
IAkJCQkJICAgZGRiLCBhbGxvYywgJm51bV9hY3RpdmUpOwo+ICAJYWxsb2Nfc2l6ZSA9IHNrbF9k
ZGJfZW50cnlfc2l6ZShhbGxvYyk7Cj4gIAlpZiAoYWxsb2Nfc2l6ZSA9PSAwKQo+ICAJCXJldHVy
biAwOwo+ICAKPiAgCS8qIEFsbG9jYXRlIGZpeGVkIG51bWJlciBvZiBibG9ja3MgZm9yIGN1cnNv
ci4gKi8KPiAtCXRvdGFsW1BMQU5FX0NVUlNPUl0gPSBza2xfY3Vyc29yX2FsbG9jYXRpb24oY3N0
YXRlLCBudW1fYWN0aXZlKTsKPiArCXRvdGFsW1BMQU5FX0NVUlNPUl0gPSBza2xfY3Vyc29yX2Fs
bG9jYXRpb24oY3J0Y19zdGF0ZSwgbnVtX2FjdGl2ZSk7Cj4gIAlhbGxvY19zaXplIC09IHRvdGFs
W1BMQU5FX0NVUlNPUl07Cj4gLQljc3RhdGUtPndtLnNrbC5wbGFuZV9kZGJfeVtQTEFORV9DVVJT
T1JdLnN0YXJ0ID0KPiArCWNydGNfc3RhdGUtPndtLnNrbC5wbGFuZV9kZGJfeVtQTEFORV9DVVJT
T1JdLnN0YXJ0ID0KPiAgCQlhbGxvYy0+ZW5kIC0gdG90YWxbUExBTkVfQ1VSU09SXTsKPiAtCWNz
dGF0ZS0+d20uc2tsLnBsYW5lX2RkYl95W1BMQU5FX0NVUlNPUl0uZW5kID0gYWxsb2MtPmVuZDsK
PiArCWNydGNfc3RhdGUtPndtLnNrbC5wbGFuZV9kZGJfeVtQTEFORV9DVVJTT1JdLmVuZCA9IGFs
bG9jLT5lbmQ7Cj4gIAo+ICAJaWYgKHRvdGFsX2RhdGFfcmF0ZSA9PSAwKQo+ICAJCXJldHVybiAw
Owo+IEBAIC00NDAyLDcgKzQzODgsNyBAQCBza2xfYWxsb2NhdGVfcGlwZV9kZGIoc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAgCQlibG9ja3MgPSAwOwo+ICAJCWZvcl9lYWNoX3Bs
YW5lX2lkX29uX2NydGMoaW50ZWxfY3J0YywgcGxhbmVfaWQpIHsKPiAgCQkJY29uc3Qgc3RydWN0
IHNrbF9wbGFuZV93bSAqd20gPQo+IC0JCQkJJmNzdGF0ZS0+d20uc2tsLm9wdGltYWwucGxhbmVz
W3BsYW5lX2lkXTsKPiArCQkJCSZjcnRjX3N0YXRlLT53bS5za2wub3B0aW1hbC5wbGFuZXNbcGxh
bmVfaWRdOwo+ICAKPiAgCQkJaWYgKHBsYW5lX2lkID09IFBMQU5FX0NVUlNPUikgewo+ICAJCQkJ
aWYgKFdBUk5fT04od20tPndtW2xldmVsXS5taW5fZGRiX2FsbG9jID4KPiBAQCAtNDQzNyw3ICs0
NDIzLDcgQEAgc2tsX2FsbG9jYXRlX3BpcGVfZGRiKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpj
c3RhdGUsCj4gIAkgKi8KPiAgCWZvcl9lYWNoX3BsYW5lX2lkX29uX2NydGMoaW50ZWxfY3J0Yywg
cGxhbmVfaWQpIHsKPiAgCQljb25zdCBzdHJ1Y3Qgc2tsX3BsYW5lX3dtICp3bSA9Cj4gLQkJCSZj
c3RhdGUtPndtLnNrbC5vcHRpbWFsLnBsYW5lc1twbGFuZV9pZF07Cj4gKwkJCSZjcnRjX3N0YXRl
LT53bS5za2wub3B0aW1hbC5wbGFuZXNbcGxhbmVfaWRdOwo+ICAJCXU2NCByYXRlOwo+ICAJCXUx
NiBleHRyYTsKPiAgCj4gQEAgLTQ0NzYsOSArNDQ2Miw5IEBAIHNrbF9hbGxvY2F0ZV9waXBlX2Rk
YihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlLAo+ICAJc3RhcnQgPSBhbGxvYy0+c3Rh
cnQ7Cj4gIAlmb3JfZWFjaF9wbGFuZV9pZF9vbl9jcnRjKGludGVsX2NydGMsIHBsYW5lX2lkKSB7
Cj4gIAkJc3RydWN0IHNrbF9kZGJfZW50cnkgKnBsYW5lX2FsbG9jID0KPiAtCQkJJmNzdGF0ZS0+
d20uc2tsLnBsYW5lX2RkYl95W3BsYW5lX2lkXTsKPiArCQkJJmNydGNfc3RhdGUtPndtLnNrbC5w
bGFuZV9kZGJfeVtwbGFuZV9pZF07Cj4gIAkJc3RydWN0IHNrbF9kZGJfZW50cnkgKnV2X3BsYW5l
X2FsbG9jID0KPiAtCQkJJmNzdGF0ZS0+d20uc2tsLnBsYW5lX2RkYl91dltwbGFuZV9pZF07Cj4g
KwkJCSZjcnRjX3N0YXRlLT53bS5za2wucGxhbmVfZGRiX3V2W3BsYW5lX2lkXTsKPiAgCj4gIAkJ
aWYgKHBsYW5lX2lkID09IFBMQU5FX0NVUlNPUikKPiAgCQkJY29udGludWU7Cj4gQEAgLTQ1MDks
NyArNDQ5NSw3IEBAIHNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3N0YXRlLAo+ICAJZm9yIChsZXZlbCsrOyBsZXZlbCA8PSBpbGtfd21fbWF4X2xldmVsKGRl
dl9wcml2KTsgbGV2ZWwrKykgewo+ICAJCWZvcl9lYWNoX3BsYW5lX2lkX29uX2NydGMoaW50ZWxf
Y3J0YywgcGxhbmVfaWQpIHsKPiAgCQkJc3RydWN0IHNrbF9wbGFuZV93bSAqd20gPQo+IC0JCQkJ
JmNzdGF0ZS0+d20uc2tsLm9wdGltYWwucGxhbmVzW3BsYW5lX2lkXTsKPiArCQkJCSZjcnRjX3N0
YXRlLT53bS5za2wub3B0aW1hbC5wbGFuZXNbcGxhbmVfaWRdOwo+ICAKPiAgCQkJLyoKPiAgCQkJ
ICogV2Ugb25seSBkaXNhYmxlIHRoZSB3YXRlcm1hcmtzIGZvciBlYWNoIHBsYW5lIGlmCj4gQEAg
LTQ1NDYsNyArNDUzMiw3IEBAIHNrbF9hbGxvY2F0ZV9waXBlX2RkYihzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3N0YXRlLAo+ICAJICovCj4gIAlmb3JfZWFjaF9wbGFuZV9pZF9vbl9jcnRjKGlu
dGVsX2NydGMsIHBsYW5lX2lkKSB7Cj4gIAkJc3RydWN0IHNrbF9wbGFuZV93bSAqd20gPQo+IC0J
CQkmY3N0YXRlLT53bS5za2wub3B0aW1hbC5wbGFuZXNbcGxhbmVfaWRdOwo+ICsJCQkmY3J0Y19z
dGF0ZS0+d20uc2tsLm9wdGltYWwucGxhbmVzW3BsYW5lX2lkXTsKPiAgCj4gIAkJaWYgKHdtLT50
cmFuc193bS5wbGFuZV9yZXNfYiA+PSB0b3RhbFtwbGFuZV9pZF0pCj4gIAkJCW1lbXNldCgmd20t
PnRyYW5zX3dtLCAwLCBzaXplb2Yod20tPnRyYW5zX3dtKSk7Cj4gQEAgLTQ1OTgsNDMgKzQ1ODQs
NDMgQEAgc2tsX3dtX21ldGhvZDIodTMyIHBpeGVsX3JhdGUsIHUzMiBwaXBlX2h0b3RhbCwgdTMy
IGxhdGVuY3ksCj4gIH0KPiAgCj4gIHN0YXRpYyB1aW50X2ZpeGVkXzE2XzE2X3QKPiAtaW50ZWxf
Z2V0X2xpbmV0aW1lX3VzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4g
K2ludGVsX2dldF9saW5ldGltZV91cyhjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSkKPiAgewo+ICAJdTMyIHBpeGVsX3JhdGU7Cj4gIAl1MzIgY3J0Y19odG90YWw7Cj4g
IAl1aW50X2ZpeGVkXzE2XzE2X3QgbGluZXRpbWVfdXM7Cj4gIAo+IC0JaWYgKCFjc3RhdGUtPmJh
c2UuYWN0aXZlKQo+ICsJaWYgKCFjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZSkKPiAgCQlyZXR1cm4g
dTMyX3RvX2ZpeGVkMTYoMCk7Cj4gIAo+IC0JcGl4ZWxfcmF0ZSA9IGNzdGF0ZS0+cGl4ZWxfcmF0
ZTsKPiArCXBpeGVsX3JhdGUgPSBjcnRjX3N0YXRlLT5waXhlbF9yYXRlOwo+ICAKPiAgCWlmIChX
QVJOX09OKHBpeGVsX3JhdGUgPT0gMCkpCj4gIAkJcmV0dXJuIHUzMl90b19maXhlZDE2KDApOwo+
ICAKPiAtCWNydGNfaHRvdGFsID0gY3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19odG90
YWw7Cj4gKwljcnRjX2h0b3RhbCA9IGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRj
X2h0b3RhbDsKPiAgCWxpbmV0aW1lX3VzID0gZGl2X2ZpeGVkMTYoY3J0Y19odG90YWwgKiAxMDAw
LCBwaXhlbF9yYXRlKTsKPiAgCj4gIAlyZXR1cm4gbGluZXRpbWVfdXM7Cj4gIH0KPiAgCj4gIHN0
YXRpYyB1MzIKPiAtc2tsX2FkanVzdGVkX3BsYW5lX3BpeGVsX3JhdGUoY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAtCQkJICAgICAgY29uc3Qgc3RydWN0IGludGVsX3Bs
YW5lX3N0YXRlICpwc3RhdGUpCj4gK3NrbF9hZGp1c3RlZF9wbGFuZV9waXhlbF9yYXRlKGNvbnN0
IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICsJCQkgICAgICBjb25zdCBz
dHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgKnBsYW5lX3N0YXRlKQo+ICB7Cj4gIAl1NjQgYWRqdXN0
ZWRfcGl4ZWxfcmF0ZTsKPiAgCXVpbnRfZml4ZWRfMTZfMTZfdCBkb3duc2NhbGVfYW1vdW50Owo+
ICAKPiAgCS8qIFNob3VsZG4ndCByZWFjaCBoZXJlIG9uIGRpc2FibGVkIHBsYW5lcy4uLiAqLwo+
IC0JaWYgKFdBUk5fT04oIWludGVsX3dtX3BsYW5lX3Zpc2libGUoY3N0YXRlLCBwc3RhdGUpKSkK
PiArCWlmIChXQVJOX09OKCFpbnRlbF93bV9wbGFuZV92aXNpYmxlKGNydGNfc3RhdGUsIHBsYW5l
X3N0YXRlKSkpCj4gIAkJcmV0dXJuIDA7Cj4gIAo+ICAJLyoKPiAgCSAqIEFkanVzdGVkIHBsYW5l
IHBpeGVsIHJhdGUgaXMganVzdCB0aGUgcGlwZSdzIGFkanVzdGVkIHBpeGVsIHJhdGUKPiAgCSAq
IHdpdGggYWRkaXRpb25hbCBhZGp1c3RtZW50cyBmb3IgcGxhbmUtc3BlY2lmaWMgc2NhbGluZy4K
PiAgCSAqLwo+IC0JYWRqdXN0ZWRfcGl4ZWxfcmF0ZSA9IGNzdGF0ZS0+cGl4ZWxfcmF0ZTsKPiAt
CWRvd25zY2FsZV9hbW91bnQgPSBza2xfcGxhbmVfZG93bnNjYWxlX2Ftb3VudChjc3RhdGUsIHBz
dGF0ZSk7Cj4gKwlhZGp1c3RlZF9waXhlbF9yYXRlID0gY3J0Y19zdGF0ZS0+cGl4ZWxfcmF0ZTsK
PiArCWRvd25zY2FsZV9hbW91bnQgPSBza2xfcGxhbmVfZG93bnNjYWxlX2Ftb3VudChjcnRjX3N0
YXRlLCBwbGFuZV9zdGF0ZSk7Cj4gIAo+ICAJcmV0dXJuIG11bF9yb3VuZF91cF91MzJfZml4ZWQx
NihhZGp1c3RlZF9waXhlbF9yYXRlLAo+ICAJCQkJCSAgICBkb3duc2NhbGVfYW1vdW50KTsKPiBA
QCAtNDc2NywxMyArNDc1MywxMyBAQCBzdGF0aWMgYm9vbCBza2xfd21faGFzX2xpbmVzKHN0cnVj
dCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgaW50IGxldmVsKQo+ICAJcmV0dXJuIGxldmVs
ID4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHZvaWQgc2tsX2NvbXB1dGVfcGxhbmVfd20oY29uc3Qg
c3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiArc3RhdGljIHZvaWQgc2tsX2NvbXB1
dGVfcGxhbmVfd20oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4g
IAkJCQkgaW50IGxldmVsLAo+ICAJCQkJIGNvbnN0IHN0cnVjdCBza2xfd21fcGFyYW1zICp3cCwK
PiAgCQkJCSBjb25zdCBzdHJ1Y3Qgc2tsX3dtX2xldmVsICpyZXN1bHRfcHJldiwKPiAgCQkJCSBz
dHJ1Y3Qgc2tsX3dtX2xldmVsICpyZXN1bHQgLyogb3V0ICovKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXYp
Owo+ICsJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0
YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gIAl1MzIgbGF0ZW5jeSA9IGRldl9wcml2LT53bS5za2xf
bGF0ZW5jeVtsZXZlbF07Cj4gIAl1aW50X2ZpeGVkXzE2XzE2X3QgbWV0aG9kMSwgbWV0aG9kMjsK
PiAgCXVpbnRfZml4ZWRfMTZfMTZfdCBzZWxlY3RlZF9yZXN1bHQ7Cj4gQEAgLTQ3OTksMTQgKzQ3
ODUsMTQgQEAgc3RhdGljIHZvaWQgc2tsX2NvbXB1dGVfcGxhbmVfd20oY29uc3Qgc3RydWN0IGlu
dGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAgCW1ldGhvZDEgPSBza2xfd21fbWV0aG9kMShkZXZf
cHJpdiwgd3AtPnBsYW5lX3BpeGVsX3JhdGUsCj4gIAkJCQkgd3AtPmNwcCwgbGF0ZW5jeSwgd3At
PmRidWZfYmxvY2tfc2l6ZSk7Cj4gIAltZXRob2QyID0gc2tsX3dtX21ldGhvZDIod3AtPnBsYW5l
X3BpeGVsX3JhdGUsCj4gLQkJCQkgY3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19odG90
YWwsCj4gKwkJCQkgY3J0Y19zdGF0ZS0+YmFzZS5hZGp1c3RlZF9tb2RlLmNydGNfaHRvdGFsLAo+
ICAJCQkJIGxhdGVuY3ksCj4gIAkJCQkgd3AtPnBsYW5lX2Jsb2Nrc19wZXJfbGluZSk7Cj4gIAo+
ICAJaWYgKHdwLT55X3RpbGVkKSB7Cj4gIAkJc2VsZWN0ZWRfcmVzdWx0ID0gbWF4X2ZpeGVkMTYo
bWV0aG9kMiwgd3AtPnlfdGlsZV9taW5pbXVtKTsKPiAgCX0gZWxzZSB7Cj4gLQkJaWYgKCh3cC0+
Y3BwICogY3N0YXRlLT5iYXNlLmFkanVzdGVkX21vZGUuY3J0Y19odG90YWwgLwo+ICsJCWlmICgo
d3AtPmNwcCAqIGNydGNfc3RhdGUtPmJhc2UuYWRqdXN0ZWRfbW9kZS5jcnRjX2h0b3RhbCAvCj4g
IAkJICAgICB3cC0+ZGJ1Zl9ibG9ja19zaXplIDwgMSkgJiYKPiAgCQkgICAgICh3cC0+cGxhbmVf
Ynl0ZXNfcGVyX2xpbmUgLyB3cC0+ZGJ1Zl9ibG9ja19zaXplIDwgMSkpIHsKPiAgCQkJc2VsZWN0
ZWRfcmVzdWx0ID0gbWV0aG9kMjsKPiBAQCAtNDg5MywxOCArNDg3OSwxOCBAQCBzdGF0aWMgdm9p
ZCBza2xfY29tcHV0ZV9wbGFuZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0
YXRlLAo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZAo+IC1za2xfY29tcHV0ZV93bV9sZXZlbHMoY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiArc2tsX2NvbXB1dGVfd21fbGV2
ZWxzKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlLAo+ICAJCSAgICAg
IGNvbnN0IHN0cnVjdCBza2xfd21fcGFyYW1zICp3bV9wYXJhbXMsCj4gIAkJICAgICAgc3RydWN0
IHNrbF93bV9sZXZlbCAqbGV2ZWxzKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShjcnRjX3N0YXRlLT5iYXNlLmNydGMt
PmRldik7Cj4gIAlpbnQgbGV2ZWwsIG1heF9sZXZlbCA9IGlsa193bV9tYXhfbGV2ZWwoZGV2X3By
aXYpOwo+ICAJc3RydWN0IHNrbF93bV9sZXZlbCAqcmVzdWx0X3ByZXYgPSAmbGV2ZWxzWzBdOwo+
ICAKPiAgCWZvciAobGV2ZWwgPSAwOyBsZXZlbCA8PSBtYXhfbGV2ZWw7IGxldmVsKyspIHsKPiAg
CQlzdHJ1Y3Qgc2tsX3dtX2xldmVsICpyZXN1bHQgPSAmbGV2ZWxzW2xldmVsXTsKPiAgCj4gLQkJ
c2tsX2NvbXB1dGVfcGxhbmVfd20oY3N0YXRlLCBsZXZlbCwgd21fcGFyYW1zLAo+ICsJCXNrbF9j
b21wdXRlX3BsYW5lX3dtKGNydGNfc3RhdGUsIGxldmVsLCB3bV9wYXJhbXMsCj4gIAkJCQkgICAg
IHJlc3VsdF9wcmV2LCByZXN1bHQpOwo+ICAKPiAgCQlyZXN1bHRfcHJldiA9IHJlc3VsdDsKPiBA
QCAtNDkxMiwxNCArNDg5OCwxNCBAQCBza2xfY29tcHV0ZV93bV9sZXZlbHMoY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNzdGF0ZSwKPiAgfQo+ICAKPiAgc3RhdGljIHUzMgo+IC1za2xf
Y29tcHV0ZV9saW5ldGltZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRl
KQo+ICtza2xfY29tcHV0ZV9saW5ldGltZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0
ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0g
Y3N0YXRlLT5iYXNlLnN0YXRlOwo+ICsJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlID0g
Y3J0Y19zdGF0ZS0+YmFzZS5zdGF0ZTsKPiAgCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZf
cHJpdiA9IHRvX2k5MTUoc3RhdGUtPmRldik7Cj4gIAl1aW50X2ZpeGVkXzE2XzE2X3QgbGluZXRp
bWVfdXM7Cj4gIAl1MzIgbGluZXRpbWVfd207Cj4gIAo+IC0JbGluZXRpbWVfdXMgPSBpbnRlbF9n
ZXRfbGluZXRpbWVfdXMoY3N0YXRlKTsKPiArCWxpbmV0aW1lX3VzID0gaW50ZWxfZ2V0X2xpbmV0
aW1lX3VzKGNydGNfc3RhdGUpOwo+ICAJbGluZXRpbWVfd20gPSBmaXhlZDE2X3RvX3UzMl9yb3Vu
ZF91cChtdWxfdTMyX2ZpeGVkMTYoOCwgbGluZXRpbWVfdXMpKTsKPiAgCj4gIAkvKiBEaXNwbGF5
IFdBICMxMTM1OiBCWFQ6QUxMIEdMSzpBTEwgKi8KPiBAQCAtNDkyOSwxMSArNDkxNSwxMSBAQCBz
a2xfY29tcHV0ZV9saW5ldGltZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0
YXRlKQo+ICAJcmV0dXJuIGxpbmV0aW1lX3dtOwo+ICB9Cj4gIAo+IC1zdGF0aWMgdm9pZCBza2xf
Y29tcHV0ZV90cmFuc2l0aW9uX3dtKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3Rh
dGUsCj4gK3N0YXRpYyB2b2lkIHNrbF9jb21wdXRlX3RyYW5zaXRpb25fd20oY29uc3Qgc3RydWN0
IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUsCj4gIAkJCQkgICAgICBjb25zdCBzdHJ1Y3Qg
c2tsX3dtX3BhcmFtcyAqd3AsCj4gIAkJCQkgICAgICBzdHJ1Y3Qgc2tsX3BsYW5lX3dtICp3bSkK
PiAgewo+IC0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXY7
Cj4gKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXY7
Cj4gIAljb25zdCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGRl
dik7Cj4gIAl1MTYgdHJhbnNfbWluLCB0cmFuc195X3RpbGVfbWluOwo+ICAJY29uc3QgdTE2IHRy
YW5zX2Ftb3VudCA9IDEwOyAvKiBUaGlzIGlzIGNvbmZpZ3VyYWJsZSBhbW91bnQgKi8KPiBAQCAt
NTA5MSwxMyArNTA3NywxMiBAQCBzdGF0aWMgaW50IGljbF9idWlsZF9wbGFuZV93bShzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKPiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1z
dGF0aWMgaW50IHNrbF9idWlsZF9waXBlX3dtKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3Rh
dGUpCj4gK3N0YXRpYyBpbnQgc2tsX2J1aWxkX3BpcGVfd20oc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUpCj4gIHsKPiAtCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3N0YXRlLT5iYXNlLmNydGMtPmRldik7Cj4gLQlzdHJ1Y3Qgc2tsX3BpcGVf
d20gKnBpcGVfd20gPSAmY3N0YXRlLT53bS5za2wub3B0aW1hbDsKPiAtCXN0cnVjdCBkcm1fY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9ICZjc3RhdGUtPmJhc2U7Cj4gKwlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNydGNfc3RhdGUtPmJhc2UuY3J0Yy0+ZGV2KTsK
PiArCXN0cnVjdCBza2xfcGlwZV93bSAqcGlwZV93bSA9ICZjcnRjX3N0YXRlLT53bS5za2wub3B0
aW1hbDsKPiAgCXN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lOwo+IC0JY29uc3Qgc3RydWN0IGRybV9w
bGFuZV9zdGF0ZSAqcHN0YXRlOwo+ICsJY29uc3Qgc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqZHJt
X3BsYW5lX3N0YXRlOwo+ICAJaW50IHJldDsKPiAgCj4gIAkvKgo+IEBAIC01MTA2LDE5ICs1MDkx
LDIwIEBAIHN0YXRpYyBpbnQgc2tsX2J1aWxkX3BpcGVfd20oc3RydWN0IGludGVsX2NydGNfc3Rh
dGUgKmNzdGF0ZSkKPiAgCSAqLwo+ICAJbWVtc2V0KHBpcGVfd20tPnBsYW5lcywgMCwgc2l6ZW9m
KHBpcGVfd20tPnBsYW5lcykpOwo+ICAKPiAtCWRybV9hdG9taWNfY3J0Y19zdGF0ZV9mb3JfZWFj
aF9wbGFuZV9zdGF0ZShwbGFuZSwgcHN0YXRlLCBjcnRjX3N0YXRlKSB7Cj4gLQkJY29uc3Qgc3Ry
dWN0IGludGVsX3BsYW5lX3N0YXRlICppbnRlbF9wc3RhdGUgPQo+IC0JCQkJCQl0b19pbnRlbF9w
bGFuZV9zdGF0ZShwc3RhdGUpOwo+ICsJZHJtX2F0b21pY19jcnRjX3N0YXRlX2Zvcl9lYWNoX3Bs
YW5lX3N0YXRlKHBsYW5lLCBkcm1fcGxhbmVfc3RhdGUsCj4gKwkJCQkJCSAgICZjcnRjX3N0YXRl
LT5iYXNlKSB7Cj4gKwkJY29uc3Qgc3RydWN0IGludGVsX3BsYW5lX3N0YXRlICpwbGFuZV9zdGF0
ZSA9Cj4gKwkJCXRvX2ludGVsX3BsYW5lX3N0YXRlKGRybV9wbGFuZV9zdGF0ZSk7Cj4gIAo+ICAJ
CWlmIChJTlRFTF9HRU4oZGV2X3ByaXYpID49IDExKQo+IC0JCQlyZXQgPSBpY2xfYnVpbGRfcGxh
bmVfd20oY3N0YXRlLCBpbnRlbF9wc3RhdGUpOwo+ICsJCQlyZXQgPSBpY2xfYnVpbGRfcGxhbmVf
d20oY3J0Y19zdGF0ZSwgcGxhbmVfc3RhdGUpOwo+ICAJCWVsc2UKPiAtCQkJcmV0ID0gc2tsX2J1
aWxkX3BsYW5lX3dtKGNzdGF0ZSwgaW50ZWxfcHN0YXRlKTsKPiArCQkJcmV0ID0gc2tsX2J1aWxk
X3BsYW5lX3dtKGNydGNfc3RhdGUsIHBsYW5lX3N0YXRlKTsKPiAgCQlpZiAocmV0KQo+ICAJCQly
ZXR1cm4gcmV0Owo+ICAJfQo+ICAKPiAtCXBpcGVfd20tPmxpbmV0aW1lID0gc2tsX2NvbXB1dGVf
bGluZXRpbWVfd20oY3N0YXRlKTsKPiArCXBpcGVfd20tPmxpbmV0aW1lID0gc2tsX2NvbXB1dGVf
bGluZXRpbWVfd20oY3J0Y19zdGF0ZSk7Cj4gIAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiBAQCAtNTI3
MiwxMCArNTI1OCwxMCBAQCBzdGF0aWMgdTMyCj4gIHBpcGVzX21vZGlmaWVkKHN0cnVjdCBpbnRl
bF9hdG9taWNfc3RhdGUgKnN0YXRlKQo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsK
PiAtCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGU7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiAgCXUzMiBpLCByZXQgPSAwOwo+ICAKPiAtCWZvcl9lYWNo
X25ld19pbnRlbF9jcnRjX2luX3N0YXRlKHN0YXRlLCBjcnRjLCBjc3RhdGUsIGkpCj4gKwlmb3Jf
ZWFjaF9uZXdfaW50ZWxfY3J0Y19pbl9zdGF0ZShzdGF0ZSwgY3J0YywgY3J0Y19zdGF0ZSwgaSkK
PiAgCQlyZXQgfD0gZHJtX2NydGNfbWFzaygmY3J0Yy0+YmFzZSk7Cj4gIAo+ICAJcmV0dXJuIHJl
dDsKPiBAQCAtNTY1MSwxMSArNTYzNywxMSBAQCBza2xfY29tcHV0ZV93bShzdHJ1Y3QgaW50ZWxf
YXRvbWljX3N0YXRlICpzdGF0ZSkKPiAgfQo+ICAKPiAgc3RhdGljIHZvaWQgc2tsX2F0b21pY191
cGRhdGVfY3J0Y193bShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPiAtCQkJCSAg
ICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGUpCj4gKwkJCQkgICAgICBzdHJ1Y3Qg
aW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVsX2NydGMg
KmNydGMgPSB0b19pbnRlbF9jcnRjKGNzdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBpbnRl
bF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRlLT5iYXNlLmNydGMpOwo+ICAJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShzdGF0ZS0+YmFzZS5k
ZXYpOwo+IC0Jc3RydWN0IHNrbF9waXBlX3dtICpwaXBlX3dtID0gJmNzdGF0ZS0+d20uc2tsLm9w
dGltYWw7Cj4gKwlzdHJ1Y3Qgc2tsX3BpcGVfd20gKnBpcGVfd20gPSAmY3J0Y19zdGF0ZS0+d20u
c2tsLm9wdGltYWw7Cj4gIAllbnVtIHBpcGUgcGlwZSA9IGNydGMtPnBpcGU7Cj4gIAo+ICAJaWYg
KCEoc3RhdGUtPndtX3Jlc3VsdHMuZGlydHlfcGlwZXMgJiBkcm1fY3J0Y19tYXNrKCZjcnRjLT5i
YXNlKSkpCj4gQEAgLTU2NjUsOSArNTY1MSw5IEBAIHN0YXRpYyB2b2lkIHNrbF9hdG9taWNfdXBk
YXRlX2NydGNfd20oc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCj4gIH0KPiAgCj4g
IHN0YXRpYyB2b2lkIHNrbF9pbml0aWFsX3dtKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0
YXRlLAo+IC0JCQkgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQo+ICsJCQkgICBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKPiAgewo+IC0Jc3RydWN0IGludGVs
X2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNzdGF0ZS0+YmFzZS5jcnRjKTsKPiAr
CXN0cnVjdCBpbnRlbF9jcnRjICppbnRlbF9jcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT5iYXNlLmNydGMpOwo+ICAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGludGVsX2NydGMtPmJh
c2UuZGV2Owo+ICAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShk
ZXYpOwo+ICAJc3RydWN0IHNrbF9kZGJfdmFsdWVzICpyZXN1bHRzID0gJnN0YXRlLT53bV9yZXN1
bHRzOwo+IEBAIC01Njc3LDggKzU2NjMsOCBAQCBzdGF0aWMgdm9pZCBza2xfaW5pdGlhbF93bShz
dHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSwKPiAgCj4gIAltdXRleF9sb2NrKCZkZXZf
cHJpdi0+d20ud21fbXV0ZXgpOwo+ICAKPiAtCWlmIChjc3RhdGUtPmJhc2UuYWN0aXZlX2NoYW5n
ZWQpCj4gLQkJc2tsX2F0b21pY191cGRhdGVfY3J0Y193bShzdGF0ZSwgY3N0YXRlKTsKPiArCWlm
IChjcnRjX3N0YXRlLT5iYXNlLmFjdGl2ZV9jaGFuZ2VkKQo+ICsJCXNrbF9hdG9taWNfdXBkYXRl
X2NydGNfd20oc3RhdGUsIGNydGNfc3RhdGUpOwo+ICAKPiAgCW11dGV4X3VubG9jaygmZGV2X3By
aXYtPndtLndtX211dGV4KTsKPiAgfQo+IEBAIC01NzM0LDI2ICs1NzIwLDI2IEBAIHN0YXRpYyB2
b2lkIGlsa19wcm9ncmFtX3dhdGVybWFya3Moc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZCBpbGtfaW5pdGlhbF93YXRlcm1hcmtzKHN0cnVj
dCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlLAo+IC0JCQkJICAgc3RydWN0IGludGVsX2NydGNf
c3RhdGUgKmNzdGF0ZSkKPiArCQkJCSAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0
YXRlKQo+ICB7Cj4gLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1
KGNzdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmludGVsX2Ny
dGMgPSB0b19pbnRlbF9jcnRjKGNzdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYp
Owo+ICsJc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNf
c3RhdGUtPmJhc2UuY3J0Yyk7Cj4gIAo+ICAJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPndtLndtX211
dGV4KTsKPiAtCWludGVsX2NydGMtPndtLmFjdGl2ZS5pbGsgPSBjc3RhdGUtPndtLmlsay5pbnRl
cm1lZGlhdGU7Cj4gKwlpbnRlbF9jcnRjLT53bS5hY3RpdmUuaWxrID0gY3J0Y19zdGF0ZS0+d20u
aWxrLmludGVybWVkaWF0ZTsKPiAgCWlsa19wcm9ncmFtX3dhdGVybWFya3MoZGV2X3ByaXYpOwo+
ICAJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+ICB9Cj4gIAo+ICBzdGF0
aWMgdm9pZCBpbGtfb3B0aW1pemVfd2F0ZXJtYXJrcyhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRl
ICpzdGF0ZSwKPiAtCQkJCSAgICBzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlKQo+ICsJ
CQkJICAgIHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKQo+ICB7Cj4gLQlzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNzdGF0ZS0+YmFzZS5jcnRj
LT5kZXYpOwo+IC0Jc3RydWN0IGludGVsX2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRj
KGNzdGF0ZS0+YmFzZS5jcnRjKTsKPiArCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
diA9IHRvX2k5MTUoY3J0Y19zdGF0ZS0+YmFzZS5jcnRjLT5kZXYpOwo+ICsJc3RydWN0IGludGVs
X2NydGMgKmludGVsX2NydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPmJhc2UuY3J0Yyk7
Cj4gIAo+ICAJbXV0ZXhfbG9jaygmZGV2X3ByaXYtPndtLndtX211dGV4KTsKPiAtCWlmIChjc3Rh
dGUtPndtLm5lZWRfcG9zdHZibF91cGRhdGUpIHsKPiAtCQlpbnRlbF9jcnRjLT53bS5hY3RpdmUu
aWxrID0gY3N0YXRlLT53bS5pbGsub3B0aW1hbDsKPiArCWlmIChjcnRjX3N0YXRlLT53bS5uZWVk
X3Bvc3R2YmxfdXBkYXRlKSB7Cj4gKwkJaW50ZWxfY3J0Yy0+d20uYWN0aXZlLmlsayA9IGNydGNf
c3RhdGUtPndtLmlsay5vcHRpbWFsOwo+ICAJCWlsa19wcm9ncmFtX3dhdGVybWFya3MoZGV2X3By
aXYpOwo+ICAJfQo+ICAJbXV0ZXhfdW5sb2NrKCZkZXZfcHJpdi0+d20ud21fbXV0ZXgpOwo+IEBA
IC01ODExLDEzICs1Nzk3LDEzIEBAIHZvaWQgc2tsX3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCj4gIAlzdHJ1Y3Qgc2tsX2RkYl92YWx1ZXMgKmh3ID0g
JmRldl9wcml2LT53bS5za2xfaHc7Cj4gIAlzdHJ1Y3Qgc2tsX2RkYl9hbGxvY2F0aW9uICpkZGIg
PSAmZGV2X3ByaXYtPndtLnNrbF9ody5kZGI7Cj4gIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsK
PiAtCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjc3RhdGU7Cj4gKwlzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKPiAgCj4gIAlza2xfZGRiX2dldF9od19zdGF0ZShkZXZfcHJp
diwgZGRiKTsKPiAgCWZvcl9lYWNoX2ludGVsX2NydGMoJmRldl9wcml2LT5kcm0sIGNydGMpIHsK
PiAtCQljc3RhdGUgPSB0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uuc3RhdGUpOwo+ICsJ
CWNydGNfc3RhdGUgPSB0b19pbnRlbF9jcnRjX3N0YXRlKGNydGMtPmJhc2Uuc3RhdGUpOwo+ICAK
PiAtCQlza2xfcGlwZV93bV9nZXRfaHdfc3RhdGUoY3J0YywgJmNzdGF0ZS0+d20uc2tsLm9wdGlt
YWwpOwo+ICsJCXNrbF9waXBlX3dtX2dldF9od19zdGF0ZShjcnRjLCAmY3J0Y19zdGF0ZS0+d20u
c2tsLm9wdGltYWwpOwo+ICAKPiAgCQlpZiAoY3J0Yy0+YWN0aXZlKQo+ICAJCQlody0+ZGlydHlf
cGlwZXMgfD0gZHJtX2NydGNfbWFzaygmY3J0Yy0+YmFzZSk7Cj4gQEAgLTU4MzQsOCArNTgyMCw4
IEBAIHN0YXRpYyB2b2lkIGlsa19waXBlX3dtX2dldF9od19zdGF0ZShzdHJ1Y3QgaW50ZWxfY3J0
YyAqY3J0YykKPiAgCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBjcnRjLT5iYXNlLmRldjsKPiAg
CXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoZGV2KTsKPiAgCXN0
cnVjdCBpbGtfd21fdmFsdWVzICpodyA9ICZkZXZfcHJpdi0+d20uaHc7Cj4gLQlzdHJ1Y3QgaW50
ZWxfY3J0Y19zdGF0ZSAqY3N0YXRlID0gdG9faW50ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0
YXRlKTsKPiAtCXN0cnVjdCBpbnRlbF9waXBlX3dtICphY3RpdmUgPSAmY3N0YXRlLT53bS5pbGsu
b3B0aW1hbDsKPiArCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlID0gdG9faW50
ZWxfY3J0Y19zdGF0ZShjcnRjLT5iYXNlLnN0YXRlKTsKPiArCXN0cnVjdCBpbnRlbF9waXBlX3dt
ICphY3RpdmUgPSAmY3J0Y19zdGF0ZS0+d20uaWxrLm9wdGltYWw7Cj4gIAllbnVtIHBpcGUgcGlw
ZSA9IGNydGMtPnBpcGU7Cj4gIAlzdGF0aWMgY29uc3QgaTkxNV9yZWdfdCB3bTBfcGlwZV9yZWdb
XSA9IHsKPiAgCQlbUElQRV9BXSA9IFdNMF9QSVBFQV9JTEssCj4gQEAgLTcxOTEsNyArNzE3Nyw3
IEBAIHN0YXRpYyB2b2lkIGdlbjExX2VuYWJsZV9yYzYoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
KmRldl9wcml2KQo+ICAJICogbmV4dCByZXF1ZXN0IHRvIGV4ZWN1dGUuIElmIHRoZSBpZGxlIGh5
c3RlcmVzaXMgaXMgbGVzcyB0aGFuIHRoYXQKPiAgCSAqIGludGVycnVwdCBzZXJ2aWNlIGxhdGVu
Y3ksIHRoZSBoYXJkd2FyZSB3aWxsIGF1dG9tYXRpY2FsbHkgZ2F0ZQo+ICAJICogdGhlIHBvd2Vy
IHdlbGwgYW5kIHdlIHdpbGwgdGhlbiBpbmN1ciB0aGUgd2FrZSB1cCBjb3N0IG9uIHRvcCBvZgo+
IC0JICogdGhlIHNlcnZpY2UgbGF0ZW5jeS4gQSBzaW1pbGFyIGd1aWRlIGZyb20gaW50ZWxfcHN0
YXRlIGlzIHRoYXQgd2UKPiArCSAqIHRoZSBzZXJ2aWNlIGxhdGVuY3kuIEEgc2ltaWxhciBndWlk
ZSBmcm9tIHBsYW5lX3N0YXRlIGlzIHRoYXQgd2UKPiAgCSAqIGRvIG5vdCB3YW50IHRoZSBlbmFi
bGUgaHlzdGVyZXNpcyB0byBsZXNzIHRoYW4gdGhlIHdha2V1cCBsYXRlbmN5Lgo+ICAJICoKPiAg
CSAqIGlndC9nZW1fZXhlY19ub3Avc2VxdWVudGlhbCBwcm92aWRlcyBhIHJvdWdoIGVzdGltYXRl
IGZvciB0aGUKPiBAQCAtNzI3MCw3ICs3MjU2LDcgQEAgc3RhdGljIHZvaWQgZ2VuOV9lbmFibGVf
cmM2KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKPiAgCSAqIG5leHQgcmVxdWVz
dCB0byBleGVjdXRlLiBJZiB0aGUgaWRsZSBoeXN0ZXJlc2lzIGlzIGxlc3MgdGhhbiB0aGF0Cj4g
IAkgKiBpbnRlcnJ1cHQgc2VydmljZSBsYXRlbmN5LCB0aGUgaGFyZHdhcmUgd2lsbCBhdXRvbWF0
aWNhbGx5IGdhdGUKPiAgCSAqIHRoZSBwb3dlciB3ZWxsIGFuZCB3ZSB3aWxsIHRoZW4gaW5jdXIg
dGhlIHdha2UgdXAgY29zdCBvbiB0b3Agb2YKPiAtCSAqIHRoZSBzZXJ2aWNlIGxhdGVuY3kuIEEg
c2ltaWxhciBndWlkZSBmcm9tIGludGVsX3BzdGF0ZSBpcyB0aGF0IHdlCj4gKwkgKiB0aGUgc2Vy
dmljZSBsYXRlbmN5LiBBIHNpbWlsYXIgZ3VpZGUgZnJvbSBwbGFuZV9zdGF0ZSBpcyB0aGF0IHdl
Cj4gIAkgKiBkbyBub3Qgd2FudCB0aGUgZW5hYmxlIGh5c3RlcmVzaXMgdG8gbGVzcyB0aGFuIHRo
ZSB3YWtldXAgbGF0ZW5jeS4KPiAgCSAqCj4gIAkgKiBpZ3QvZ2VtX2V4ZWNfbm9wL3NlcXVlbnRp
YWwgcHJvdmlkZXMgYSByb3VnaCBlc3RpbWF0ZSBmb3IgdGhlCgpBbmQgcHVzaGVkLCB3aXRoIENJ
IGJlaW5nIGhhcHB5LiA6KQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50
ZWwtZ2Z4

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CAFD7F0212
	for <lists+intel-gfx@lfdr.de>; Tue,  5 Nov 2019 17:00:51 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B0C186EAD1;
	Tue,  5 Nov 2019 16:00:49 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga03.intel.com (mga03.intel.com [134.134.136.65])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 277BF6EAD0
 for <intel-gfx@lists.freedesktop.org>; Tue,  5 Nov 2019 16:00:47 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 05 Nov 2019 08:00:46 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.68,271,1569308400"; d="scan'208";a="403396456"
Received: from slisovsk-lenovo-ideapad-720s-13ikb.fi.intel.com ([10.237.72.89])
 by fmsmga006.fm.intel.com with ESMTP; 05 Nov 2019 08:00:44 -0800
From: Stanislav Lisovskiy <stanislav.lisovskiy@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue,  5 Nov 2019 17:57:56 +0200
Message-Id: <20191105155756.5186-3-stanislav.lisovskiy@intel.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191105155756.5186-1-stanislav.lisovskiy@intel.com>
References: <20191105155756.5186-1-stanislav.lisovskiy@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v10 2/2] drm/i915: Restrict qgv points which
 don't have enough bandwidth.
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

QWNjb3JkaW5nIHRvIEJTcGVjIDUzOTk4LCB3ZSBzaG91bGQgdHJ5IHRvCnJlc3RyaWN0IHFndiBw
b2ludHMsIHdoaWNoIGNhbid0IHByb3ZpZGUKZW5vdWdoIGJhbmR3aWR0aCBmb3IgZGVzaXJlZCBk
aXNwbGF5IGNvbmZpZ3VyYXRpb24uCgpDdXJyZW50bHkgd2UgYXJlIGp1c3QgY29tcGFyaW5nIGFn
YWluc3QgYWxsIG9mCnRob3NlIGFuZCB0YWtlIG1pbmltdW0od29yc3QgY2FzZSkuCgp2MjogRml4
ZWQgd3JvbmcgUENvZGUgcmVwbHkgbWFzaywgcmVtb3ZlZCBoYXJkY29kZWQKICAgIHZhbHVlcy4K
CnYzOiBGb3JiaWQgc2ltdWx0YW5lb3VzIGxlZ2FjeSBTQUdWIFBDb2RlIHJlcXVlc3RzIGFuZAog
ICAgcmVzdHJpY3RpbmcgcWd2IHBvaW50cy4gUHV0IHRoZSBhY3R1YWwgcmVzdHJpY3Rpb24KICAg
IHRvIGNvbW1pdCBmdW5jdGlvbiwgYWRkZWQgc2VyaWFsaXphdGlvbih0aGFua3MgdG8gVmlsbGUp
CiAgICB0byBwcmV2ZW50IGNvbW1pdCBiZWluZyBhcHBsaWVkIG91dCBvZiBvcmRlciBpbiBjYXNl
IG9mCiAgICBub25ibG9ja2luZyBhbmQvb3Igbm9tb2Rlc2V0IGNvbW1pdHMuCgp2NDoKICAgIC0g
TWlub3IgY29kZSByZWZhY3RvcmluZywgZml4ZWQgZmV3IHR5cG9zKHRoYW5rcyB0byBKYW1lcyBB
dXNtdXMpCiAgICAtIENoYW5nZSB0aGUgbmFtaW5nIG9mIHFndiBwb2ludAogICAgICBtYXNraW5n
L3VubWFza2luZyBmdW5jdGlvbnMoSmFtZXMgQXVzbXVzKS4KICAgIC0gU2ltcGxpZnkgdGhlIG1h
c2tpbmcvdW5tYXNraW5nIG9wZXJhdGlvbiBpdHNlbGYsCiAgICAgIGFzIHdlIGRvbid0IG5lZWQg
dG8gbWFzayBvbmx5IHNpbmdsZSBwb2ludCBwZXIgcmVxdWVzdChKYW1lcyBBdXNtdXMpCiAgICAt
IFJlamVjdCBhbmQgc3RpY2sgdG8gaGlnaGVzdCBiYW5kd2lkdGggcG9pbnQgaWYgU0FHVgogICAg
ICBjYW4ndCBiZSBlbmFibGVkKEJTcGVjKQoKdjU6CiAgICAtIEFkZCBuZXcgbWFpbGJveCByZXBs
eSBjb2Rlcywgd2hpY2ggc2VlbXMgdG8gaGFwcGVuIGR1cmluZyBib290CiAgICAgIHRpbWUgZm9y
IFRHTCBhbmQgaW5kaWNhdGUgdGhhdCBRR1Ygc2V0dGluZyBpcyBub3QgeWV0IGF2YWlsYWJsZS4K
CnY2OgogICAgLSBJbmNyZWFzZSBudW1iZXIgb2Ygc3VwcG9ydGVkIFFHViBwb2ludHMgdG8gYmUg
aW4gc3luYyB3aXRoIEJTcGVjLgoKdjc6IC0gUmViYXNlZCBhbmQgcmVzb2x2ZWQgY29uZmxpY3Qg
dG8gZml4IGJ1aWxkIGZhaWx1cmUuCiAgICAtIEZpeCBOVU1fUUdWX1BPSU5UUyB0byA4IGFuZCBt
b3ZlZCB0aGF0IHRvIGhlYWRlciBmaWxlKEphbWVzIEF1c211cykKCnY4OiAtIERvbid0IHJlcG9y
dCBhbiBlcnJvciBpZiB3ZSBjYW4ndCByZXN0cmljdCBxZ3YgcG9pbnRzLCBhcyBTQUdWCiAgICAg
IGNhbiBiZSBkaXNhYmxlZCBieSBCSU9TLCB3aGljaCBpcyBjb21wbGV0ZWx5IGxlZ2FsLiBTbyBk
b24ndAogICAgICBtYWtlIENJIHBhbmljLiBJbnN0ZWFkIGlmIHdlIGRldGVjdCB0aGF0IHRoZXJl
IGlzIG9ubHkgMSBRR1YKICAgICAgcG9pbnQgYWNjZXNzaWJsZSBqdXN0IGFuYWx5emUgaWYgd2Ug
Y2FuIGZpdCB0aGUgcmVxdWlyZWQgYmFuZHdpZHRoCiAgICAgIHJlcXVpcmVtZW50cywgYnV0IG5v
IG5lZWQgaW4gcmVzdHJpY3RpbmcuCgpSZXZpZXdlZC1ieTogSmFtZXMgQXVzbXVzIDxqYW1lcy5h
dXNtdXNAaW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBTdGFuaXNsYXYgTGlzb3Zza2l5IDxzdGFu
aXNsYXYubGlzb3Zza2l5QGludGVsLmNvbT4KQ2M6IFZpbGxlIFN5cmrDpGzDpCA8dmlsbGUuc3ly
amFsYUBpbnRlbC5jb20+CkNjOiBKYW1lcyBBdXNtdXMgPGphbWVzLmF1c211c0BpbnRlbC5jb20+
Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuaCAgIHwgICAz
ICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYncuYyAgICAgICB8IDExOCAr
KysrKysrKysrKysrKy0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYncu
aCAgICAgICB8ICAgMiArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3Bs
YXkuYyAgfCAgNjkgKysrKysrKysrLQogLi4uL2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxh
eV90eXBlcy5oICAgIHwgICAzICsKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAg
ICAgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaCAgICAg
ICAgICAgICAgIHwgICA4ICsrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5jICAgICAg
ICAgICAgICAgfCAgMTEgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmggICAgICAg
ICAgICAgICB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9zaWRlYmFuZC5jICAg
ICAgICAgfCAgMjcgKysrLQogMTAgZmlsZXMgY2hhbmdlZCwgMjA5IGluc2VydGlvbnMoKyksIDM3
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfYXRvbWljLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21p
Yy5oCmluZGV4IDdiNDk2MjM0MTliYS4uM2FiNmQ3ZWM3NWFlIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmgKQEAgLTcsNiArNyw3IEBACiAjZGVmaW5lIF9f
SU5URUxfQVRPTUlDX0hfXwogCiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlICJp
bnRlbF9kaXNwbGF5X3R5cGVzLmgiCiAKIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlOwogc3RydWN0
IGRybV9jb25uZWN0b3I7CkBAIC00MSw2ICs0Miw4IEBAIHZvaWQgaW50ZWxfY3J0Y19jb3B5X2Nv
bG9yX2Jsb2JzKHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRlKTsKIHN0cnVjdCBk
cm1fYXRvbWljX3N0YXRlICppbnRlbF9hdG9taWNfc3RhdGVfYWxsb2Moc3RydWN0IGRybV9kZXZp
Y2UgKmRldik7CiB2b2lkIGludGVsX2F0b21pY19zdGF0ZV9jbGVhcihzdHJ1Y3QgZHJtX2F0b21p
Y19zdGF0ZSAqc3RhdGUpOwogCitpbnQgaW50ZWxfYXRvbWljX3NlcmlhbGl6ZV9nbG9iYWxfc3Rh
dGUoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpOworCiBzdHJ1Y3QgaW50ZWxfY3J0
Y19zdGF0ZSAqCiBpbnRlbF9hdG9taWNfZ2V0X2NydGNfc3RhdGUoc3RydWN0IGRybV9hdG9taWNf
c3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYncuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYncuYwppbmRleCAzZjZlMjlmNjEzMjMuLjY1ZDdkMTRi
MTg3MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9idy5j
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYncuYwpAQCAtOCwxNCAr
OCwxNyBAQAogI2luY2x1ZGUgImludGVsX2J3LmgiCiAjaW5jbHVkZSAiaW50ZWxfZGlzcGxheV90
eXBlcy5oIgogI2luY2x1ZGUgImludGVsX3NpZGViYW5kLmgiCisjaW5jbHVkZSAiaW50ZWxfYXRv
bWljLmgiCisjaW5jbHVkZSAiaW50ZWxfcG0uaCIKIAogLyogUGFyYW1ldGVycyBmb3IgUWNsayBH
ZXlzZXJ2aWxsZSAoUUdWKSAqLwogc3RydWN0IGludGVsX3Fndl9wb2ludCB7CiAJdTE2IGRjbGss
IHRfcnAsIHRfcmRwcmUsIHRfcmMsIHRfcmFzLCB0X3JjZDsKIH07CiAKKwogc3RydWN0IGludGVs
X3Fndl9pbmZvIHsKLQlzdHJ1Y3QgaW50ZWxfcWd2X3BvaW50IHBvaW50c1szXTsKKwlzdHJ1Y3Qg
aW50ZWxfcWd2X3BvaW50IHBvaW50c1tOVU1fU0FHVl9QT0lOVFNdOwogCXU4IG51bV9wb2ludHM7
CiAJdTggbnVtX2NoYW5uZWxzOwogCXU4IHRfYmw7CkBAIC0xMTMsNiArMTE2LDI3IEBAIHN0YXRp
YyBpbnQgaWNsX3Bjb2RlX3JlYWRfcWd2X3BvaW50X2luZm8oc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2LAogCXJldHVybiAwOwogfQogCitpbnQgaWNsX3Bjb2RlX3Jlc3RyaWN0X3Fn
dl9wb2ludHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQkJCSAgdTMyIHBv
aW50c19tYXNrKQoreworCWludCByZXQ7CisKKwkvKiBic3BlYyBzYXlzIHRvIGtlZXAgcmV0cnlp
bmcgZm9yIGF0IGxlYXN0IDEgbXMgKi8KKwlyZXQgPSBza2xfcGNvZGVfcmVxdWVzdChkZXZfcHJp
diwgSUNMX1BDT0RFX1NBR1ZfREVfTUVNX1NTX0NPTkZJRywKKwkJCQlwb2ludHNfbWFzaywKKwkJ
CQlHRU4xMV9QQ09ERV9QT0lOVFNfUkVTVFJJQ1RFRF9NQVNLLAorCQkJCUdFTjExX1BDT0RFX1BP
SU5UU19SRVNUUklDVEVELAorCQkJCTEpOworCisJaWYgKHJldCA8IDApIHsKKwkJRFJNX0VSUk9S
KCJGYWlsZWQgdG8gZGlzYWJsZSBxZ3YgcG9pbnRzICglZClcbiIsIHJldCk7CisJCXJldHVybiBy
ZXQ7CisJfQorCisJcmV0dXJuIDA7Cit9CisKKwogc3RhdGljIGludCBpY2xfZ2V0X3Fndl9wb2lu
dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCQkJICAgICAgc3RydWN0IGlu
dGVsX3Fndl9pbmZvICpxaSkKIHsKQEAgLTI3MCwyMiArMjk0LDYgQEAgdm9pZCBpbnRlbF9id19p
bml0X2h3KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJaWNsX2dldF9id19p
bmZvKGRldl9wcml2LCAmaWNsX3NhX2luZm8pOwogfQogCi1zdGF0aWMgdW5zaWduZWQgaW50IGlu
dGVsX21heF9kYXRhX3JhdGUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAotCQkJ
CQlpbnQgbnVtX3BsYW5lcykKLXsKLQlpZiAoSU5URUxfR0VOKGRldl9wcml2KSA+PSAxMSkKLQkJ
LyoKLQkJICogRklYTUUgd2l0aCBTQUdWIGRpc2FibGVkIG1heWJlIHdlIGNhbiBhc3N1bWUKLQkJ
ICogcG9pbnQgMSB3aWxsIGFsd2F5cyBiZSB1c2VkPyBTZWVtcyB0byBtYXRjaAotCQkgKiB0aGUg
YmVoYXZpb3VyIG9ic2VydmVkIGluIHRoZSB3aWxkLgotCQkgKi8KLQkJcmV0dXJuIG1pbjMoaWNs
X21heF9idyhkZXZfcHJpdiwgbnVtX3BsYW5lcywgMCksCi0JCQkgICAgaWNsX21heF9idyhkZXZf
cHJpdiwgbnVtX3BsYW5lcywgMSksCi0JCQkgICAgaWNsX21heF9idyhkZXZfcHJpdiwgbnVtX3Bs
YW5lcywgMikpOwotCWVsc2UKLQkJcmV0dXJuIFVJTlRfTUFYOwotfQotCiBzdGF0aWMgdW5zaWdu
ZWQgaW50IGludGVsX2J3X2NydGNfbnVtX2FjdGl2ZV9wbGFuZXMoY29uc3Qgc3RydWN0IGludGVs
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUpCiB7CiAJLyoKQEAgLTM3Nyw3ICszODUsMTAgQEAgaW50
IGludGVsX2J3X2F0b21pY19jaGVjayhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkK
IAl1bnNpZ25lZCBpbnQgZGF0YV9yYXRlLCBtYXhfZGF0YV9yYXRlOwogCXVuc2lnbmVkIGludCBu
dW1fYWN0aXZlX3BsYW5lczsKIAlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKLQlpbnQgaTsKKwlp
bnQgaSwgcmV0OworCXN0cnVjdCBpbnRlbF9xZ3ZfaW5mbyBxaSA9IHt9OworCXUzMiBhbGxvd2Vk
X3BvaW50cyA9IDA7CisJdW5zaWduZWQgaW50IG1heF9id19wb2ludCA9IDAsIG1heF9idyA9IDA7
CiAKIAkvKiBGSVhNRSBlYXJsaWVyIGdlbnMgbmVlZCBzb21lIGNoZWNrcyB0b28gKi8KIAlpZiAo
SU5URUxfR0VOKGRldl9wcml2KSA8IDExKQpAQCAtNDIxLDE2ICs0MzIsNzcgQEAgaW50IGludGVs
X2J3X2F0b21pY19jaGVjayhzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKIAlkYXRh
X3JhdGUgPSBpbnRlbF9id19kYXRhX3JhdGUoZGV2X3ByaXYsIGJ3X3N0YXRlKTsKIAludW1fYWN0
aXZlX3BsYW5lcyA9IGludGVsX2J3X251bV9hY3RpdmVfcGxhbmVzKGRldl9wcml2LCBid19zdGF0
ZSk7CiAKLQltYXhfZGF0YV9yYXRlID0gaW50ZWxfbWF4X2RhdGFfcmF0ZShkZXZfcHJpdiwgbnVt
X2FjdGl2ZV9wbGFuZXMpOwotCiAJZGF0YV9yYXRlID0gRElWX1JPVU5EX1VQKGRhdGFfcmF0ZSwg
MTAwMCk7CiAKLQlpZiAoZGF0YV9yYXRlID4gbWF4X2RhdGFfcmF0ZSkgewotCQlEUk1fREVCVUdf
S01TKCJCYW5kd2lkdGggJXUgTUIvcyBleGNlZWRzIG1heCBhdmFpbGFibGUgJWQgTUIvcyAoJWQg
YWN0aXZlIHBsYW5lcylcbiIsCi0JCQkgICAgICBkYXRhX3JhdGUsIG1heF9kYXRhX3JhdGUsIG51
bV9hY3RpdmVfcGxhbmVzKTsKKwlyZXQgPSBpY2xfZ2V0X3Fndl9wb2ludHMoZGV2X3ByaXYsICZx
aSk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiAwOworCisJZm9yIChpID0gMDsgaSA8IHFpLm51
bV9wb2ludHM7IGkrKykgeworCQltYXhfZGF0YV9yYXRlID0gaWNsX21heF9idyhkZXZfcHJpdiwg
bnVtX2FjdGl2ZV9wbGFuZXMsIGkpOworCQkvKgorCQkgKiBXZSBuZWVkIHRvIGtub3cgd2hpY2gg
cWd2IHBvaW50IGdpdmVzIHVzCisJCSAqIG1heGltdW0gYmFuZHdpZHRoIGluIG9yZGVyIHRvIGRp
c2FibGUgU0FHVgorCQkgKiBpZiB3ZSBmaW5kIHRoYXQgd2UgZXhjZWVkIFNBR1YgYmxvY2sgdGlt
ZQorCQkgKiB3aXRoIHdhdGVybWFya3MuIEJ5IHRoYXQgbW9tZW50IHdlIGFscmVhZHkKKwkJICog
aGF2ZSB0aG9zZSwgYXMgaXQgaXMgY2FsY3VsYXRlZCBlYXJsaWVyIGluCisJCSAqIGludGVsX2F0
b21pY19jaGVjaywKKwkJICovCisJCWlmIChtYXhfZGF0YV9yYXRlID4gbWF4X2J3KSB7CisJCQlt
YXhfYndfcG9pbnQgPSBpOworCQkJbWF4X2J3ID0gbWF4X2RhdGFfcmF0ZTsKKwkJfQorCQlpZiAo
bWF4X2RhdGFfcmF0ZSA+PSBkYXRhX3JhdGUpCisJCQlhbGxvd2VkX3BvaW50cyB8PSAxIDw8IGk7
CisJCURSTV9ERUJVR19LTVMoIlFHViBwb2ludCAlZDogbWF4IGJ3ICVkIHJlcXVpcmVkICVkXG4i
LAorCQkJICAgICAgaSwgbWF4X2RhdGFfcmF0ZSwgZGF0YV9yYXRlKTsKKwl9CisKKwkvKgorCSAq
IEJTcGVjIHN0YXRlcyB0aGF0IHdlIGFsd2F5cyBzaG91bGQgaGF2ZSBhdCBsZWFzdCBvbmUgYWxs
b3dlZCBwb2ludAorCSAqIGxlZnQsIHNvIGlmIHdlIGNvdWxkbid0IC0gc2ltcGx5IHJlamVjdCB0
aGUgY29uZmlndXJhdGlvbiBmb3Igb2J2aW91cworCSAqIHJlYXNvbnMuCisJICovCisJaWYgKGFs
bG93ZWRfcG9pbnRzID09IDApIHsKKwkJRFJNX0RFQlVHX0tNUygiQ291bGQgbm90IGZpbmQgYW55
IHN1aXRhYmxlIFFHViBwb2ludHNcbiIpOwogCQlyZXR1cm4gLUVJTlZBTDsKIAl9CiAKKwkvKgor
CSAqIEluIGNhc2UgaWYgU0FHViBpcyBkaXNhYmxlZCBpbiBCSU9TLCB3ZSBhbHdheXMgZ2V0IDEK
KwkgKiBTQUdWIHBvaW50LCBidXQgd2UgY2FuJ3Qgc2VuZCBQQ29kZSBjb21tYW5kcyB0byByZXN0
cmljdCBpdAorCSAqIGFzIGl0IHdpbGwgZmFpbCBhbmQgcG9pbnRsZXNzIGFueXdheS4KKwkgKi8K
KwlpZiAocWkubnVtX3BvaW50cyA9PSAxKQorCQlkZXZfcHJpdi0+c2Fndl9zdGF0dXMgPSBJOTE1
X1NBR1ZfTk9UX0NPTlRST0xMRUQ7CisJZWxzZQorCQlkZXZfcHJpdi0+c2Fndl9zdGF0dXMgPSBJ
OTE1X1NBR1ZfRU5BQkxFRDsKKworCS8qCisJICogTGVhdmUgb25seSBzaW5nbGUgcG9pbnQgd2l0
aCBoaWdoZXN0IGJhbmR3aWR0aCwgaWYKKwkgKiB3ZSBjYW4ndCBlbmFibGUgU0FHViBhY2NvcmRp
bmcgdG8gQlNwZWMuCisJICovCisJaWYgKCFpbnRlbF9jYW5fZW5hYmxlX3NhZ3Yoc3RhdGUpKQor
CQlhbGxvd2VkX3BvaW50cyA9IDEgPDwgbWF4X2J3X3BvaW50OworCisJLyoKKwkgKiBXZSBzdG9y
ZSB0aGUgb25lcyB3aGljaCBuZWVkIHRvIGJlIG1hc2tlZCBhcyB0aGF0IGlzIHdoYXQgUENvZGUK
KwkgKiBhY3R1YWxseSBhY2NlcHRzIGFzIGEgcGFyYW1ldGVyLgorCSAqLworCXN0YXRlLT5xZ3Zf
cG9pbnRzX21hc2sgPSAofmFsbG93ZWRfcG9pbnRzKSAmICgoMSA8PCBxaS5udW1fcG9pbnRzKSAt
IDEpOworCisJLyoKKwkgKiBJZiB0aGUgYWN0dWFsIG1hc2sgaGFkIGNoYW5nZWQgd2UgbmVlZCB0
byBtYWtlIHN1cmUgdGhhdAorCSAqIHRoZSBjb21taXRzIGFyZSBzZXJpYWxpemVkKGluIGNhc2Ug
dGhpcyBpcyBhIG5vbW9kZXNldCwgbm9uYmxvY2tpbmcpCisJICovCisJaWYgKHN0YXRlLT5xZ3Zf
cG9pbnRzX21hc2sgIT0gZGV2X3ByaXYtPnFndl9wb2ludHNfbWFzaykgeworCQlyZXQgPSBpbnRl
bF9hdG9taWNfc2VyaWFsaXplX2dsb2JhbF9zdGF0ZShzdGF0ZSk7CisJCWlmIChyZXQpIHsKKwkJ
CURSTV9ERUJVR19LTVMoIkNvdWxkIG5vdCBzZXJpYWxpemUgZ2xvYmFsIHN0YXRlXG4iKTsKKwkJ
CXJldHVybiByZXQ7CisJCX0KKwl9CisKIAlyZXR1cm4gMDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9idy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9idy5oCmluZGV4IDlkYjEwYWYwMTJmNC4uNjZiZjliYzEwYjczIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2J3LmgKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9idy5oCkBAIC0yOCw1ICsyOCw3IEBA
IGludCBpbnRlbF9id19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiBp
bnQgaW50ZWxfYndfYXRvbWljX2NoZWNrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRl
KTsKIHZvaWQgaW50ZWxfYndfY3J0Y191cGRhdGUoc3RydWN0IGludGVsX2J3X3N0YXRlICpid19z
dGF0ZSwKIAkJCSAgY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwor
aW50IGljbF9wY29kZV9yZXN0cmljdF9xZ3ZfcG9pbnRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdiwKKwkJCQkgIHUzMiBwb2ludHNfbWFzayk7CiAKICNlbmRpZiAvKiBfX0lOVEVM
X0JXX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kaXNwbGF5LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2Rpc3BsYXku
YwppbmRleCA3ZWExZTc1MThhYjYuLjcxYzk2MDNkZmJkOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMKQEAgLTE0NzQ0LDYgKzE0NzQ0LDYwIEBAIHN0
YXRpYyB2b2lkIGludGVsX2F0b21pY19jbGVhbnVwX3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3
b3JrKQogCWludGVsX2F0b21pY19oZWxwZXJfZnJlZV9zdGF0ZShpOTE1KTsKIH0KIAorc3RhdGlj
IHZvaWQgaW50ZWxfcWd2X3BvaW50c19tYXNrKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0
YXRlKQoreworCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBzdGF0ZS0+YmFzZS5kZXY7CisJc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYpOworCWludCByZXQ7
CisJdTMyIG5ld19tYXNrID0gZGV2X3ByaXYtPnFndl9wb2ludHNfbWFzayB8IHN0YXRlLT5xZ3Zf
cG9pbnRzX21hc2s7CisKKwkvKgorCSAqIEp1c3QgcmV0dXJuIGlmIHdlIGNhbid0IGNvbnRyb2wg
U0FHViBvciBkb24ndCBoYXZlIGl0LgorCSAqLworCWlmICghaW50ZWxfaGFzX3NhZ3YoZGV2X3By
aXYpKQorCQlyZXR1cm47CisKKwkvKgorCSAqIFJlc3RyaWN0IHJlcXVpcmVkIHFndiBwb2ludHMg
YmVmb3JlIHVwZGF0aW5nIHRoZSBjb25maWd1cmF0aW9uLgorCSAqIEFjY29yZGluZyB0byBCU3Bl
YyB3ZSBjYW4ndCBtYXNrIGFuZCB1bm1hc2sgcWd2IHBvaW50cyBhdCB0aGUgc2FtZQorCSAqIHRp
bWUuIEFsc28gbWFza2luZyBzaG91bGQgYmUgZG9uZSBiZWZvcmUgdXBkYXRpbmcgdGhlIGNvbmZp
Z3VyYXRpb24KKwkgKiBhbmQgdW5tYXNraW5nIGFmdGVyd2FyZHMuCisJICovCisJcmV0ID0gaWNs
X3Bjb2RlX3Jlc3RyaWN0X3Fndl9wb2ludHMoZGV2X3ByaXYsIG5ld19tYXNrKTsKKwlpZiAocmV0
IDwgMCkKKwkJRFJNX0RFQlVHX0tNUygiQ291bGQgbm90IHJlc3RyaWN0IHJlcXVpcmVkIHFndiBw
b2ludHMoJWQpXG4iLAorCQkJICAgICAgcmV0KTsKKwllbHNlCisJCWRldl9wcml2LT5xZ3ZfcG9p
bnRzX21hc2sgPSBuZXdfbWFzazsKK30KKworc3RhdGljIHZvaWQgaW50ZWxfcWd2X3BvaW50c191
bm1hc2soc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCit7CisJc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9IHN0YXRlLT5iYXNlLmRldjsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYgPSB0b19pOTE1KGRldik7CisJaW50IHJldDsKKwl1MzIgbmV3X21hc2sgPSBkZXZf
cHJpdi0+cWd2X3BvaW50c19tYXNrICYgc3RhdGUtPnFndl9wb2ludHNfbWFzazsKKworCS8qCisJ
ICogSnVzdCByZXR1cm4gaWYgd2UgY2FuJ3QgY29udHJvbCBTQUdWIG9yIGRvbid0IGhhdmUgaXQu
CisJICovCisJaWYgKCFpbnRlbF9oYXNfc2FndihkZXZfcHJpdikpCisJCXJldHVybjsKKworCS8q
CisJICogQWxsb3cgcmVxdWlyZWQgcWd2IHBvaW50cyBhZnRlciB1cGRhdGluZyB0aGUgY29uZmln
dXJhdGlvbi4KKwkgKiBBY2NvcmRpbmcgdG8gQlNwZWMgd2UgY2FuJ3QgbWFzayBhbmQgdW5tYXNr
IHFndiBwb2ludHMgYXQgdGhlIHNhbWUKKwkgKiB0aW1lLiBBbHNvIG1hc2tpbmcgc2hvdWxkIGJl
IGRvbmUgYmVmb3JlIHVwZGF0aW5nIHRoZSBjb25maWd1cmF0aW9uCisJICogYW5kIHVubWFza2lu
ZyBhZnRlcndhcmRzLgorCSAqLworCXJldCA9IGljbF9wY29kZV9yZXN0cmljdF9xZ3ZfcG9pbnRz
KGRldl9wcml2LCBuZXdfbWFzayk7CisJaWYgKHJldCA8IDApCisJCURSTV9ERUJVR19LTVMoIkNv
dWxkIG5vdCByZXN0cmljdCByZXF1aXJlZCBxZ3YgcG9pbnRzKCVkKVxuIiwKKwkJCSAgICAgIHJl
dCk7CisJZWxzZQorCQlkZXZfcHJpdi0+cWd2X3BvaW50c19tYXNrID0gbmV3X21hc2s7Cit9CisK
IHN0YXRpYyB2b2lkIGludGVsX2F0b21pY19jb21taXRfdGFpbChzdHJ1Y3QgaW50ZWxfYXRvbWlj
X3N0YXRlICpzdGF0ZSkKIHsKIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gc3RhdGUtPmJhc2Uu
ZGV2OwpAQCAtMTQ3NzEsNiArMTQ4MjUsOSBAQCBzdGF0aWMgdm9pZCBpbnRlbF9hdG9taWNfY29t
bWl0X3RhaWwoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUpCiAJCX0KIAl9CiAKKwlp
ZiAoKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTEpKQorCQlpbnRlbF9xZ3ZfcG9pbnRzX21hc2so
c3RhdGUpOworCiAJaW50ZWxfY29tbWl0X21vZGVzZXRfZGlzYWJsZXMoc3RhdGUpOwogCiAJLyog
RklYTUU6IEV2ZW50dWFsbHkgZ2V0IHJpZCBvZiBvdXIgY3J0Yy0+Y29uZmlnIHBvaW50ZXIgKi8K
QEAgLTE0Nzg5LDggKzE0ODQ2LDkgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1pdF90
YWlsKHN0cnVjdCBpbnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQogCQkgKiBTS0wgd29ya2Fyb3Vu
ZDogYnNwZWMgcmVjb21tZW5kcyB3ZSBkaXNhYmxlIHRoZSBTQUdWIHdoZW4gd2UKIAkJICogaGF2
ZSBtb3JlIHRoZW4gb25lIHBpcGUgZW5hYmxlZAogCQkgKi8KLQkJaWYgKCFpbnRlbF9jYW5fZW5h
YmxlX3NhZ3Yoc3RhdGUpKQotCQkJaW50ZWxfZGlzYWJsZV9zYWd2KGRldl9wcml2KTsKKwkJaWYg
KElOVEVMX0dFTihkZXZfcHJpdikgPCAxMSkKKwkJCWlmICghaW50ZWxfY2FuX2VuYWJsZV9zYWd2
KHN0YXRlKSkKKwkJCQlpbnRlbF9kaXNhYmxlX3NhZ3YoZGV2X3ByaXYpOwogCiAJCWludGVsX21v
ZGVzZXRfdmVyaWZ5X2Rpc2FibGVkKGRldl9wcml2LCBzdGF0ZSk7CiAJfQpAQCAtMTQ4NzMsOCAr
MTQ5MzEsMTEgQEAgc3RhdGljIHZvaWQgaW50ZWxfYXRvbWljX2NvbW1pdF90YWlsKHN0cnVjdCBp
bnRlbF9hdG9taWNfc3RhdGUgKnN0YXRlKQogCWlmIChzdGF0ZS0+bW9kZXNldCkKIAkJaW50ZWxf
dmVyaWZ5X3BsYW5lcyhzdGF0ZSk7CiAKLQlpZiAoc3RhdGUtPm1vZGVzZXQgJiYgaW50ZWxfY2Fu
X2VuYWJsZV9zYWd2KHN0YXRlKSkKLQkJaW50ZWxfZW5hYmxlX3NhZ3YoZGV2X3ByaXYpOworCWlm
IChJTlRFTF9HRU4oZGV2X3ByaXYpIDwgMTEpIHsKKwkJaWYgKHN0YXRlLT5tb2Rlc2V0ICYmIGlu
dGVsX2Nhbl9lbmFibGVfc2FndihzdGF0ZSkpCisJCQlpbnRlbF9lbmFibGVfc2FndihkZXZfcHJp
dik7CisJfSBlbHNlCisJCWludGVsX3Fndl9wb2ludHNfdW5tYXNrKHN0YXRlKTsKIAogCWRybV9h
dG9taWNfaGVscGVyX2NvbW1pdF9od19kb25lKCZzdGF0ZS0+YmFzZSk7CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5X3R5cGVzLmgKaW5kZXggZmIy
NzQ1MzhhZjIzLi44OTZiMTNiYzQ0OTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfZGlzcGxheV90eXBlcy5oCkBAIC01MjgsNiArNTI4LDkgQEAgc3RydWN0
IGludGVsX2F0b21pY19zdGF0ZSB7CiAJc3RydWN0IGk5MTVfc3dfZmVuY2UgY29tbWl0X3JlYWR5
OwogCiAJc3RydWN0IGxsaXN0X25vZGUgZnJlZWQ7CisKKwkvKiBHZW4xMSsgb25seSAqLworCXUz
MiBxZ3ZfcG9pbnRzX21hc2s7CiB9OwogCiBzdHJ1Y3QgaW50ZWxfcGxhbmVfc3RhdGUgewpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZHJ2LmgKaW5kZXggNGY0ZTJlODM5NTEzLi45OTI0MzkwY2I5NGIgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtMTI0MywxMSArMTI0MywxMyBAQCBzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSB7CiAJfSBkcmFtX2luZm87CiAKIAlzdHJ1Y3QgaW50ZWxfYndfaW5mbyB7Ci0J
CXVuc2lnbmVkIGludCBkZXJhdGVkYndbM107IC8qIGZvciBlYWNoIFFHViBwb2ludCAqLworCQl1
bnNpZ25lZCBpbnQgZGVyYXRlZGJ3W05VTV9TQUdWX1BPSU5UU107IC8qIGZvciBlYWNoIFFHViBw
b2ludCAqLwogCQl1OCBudW1fcWd2X3BvaW50czsKIAkJdTggbnVtX3BsYW5lczsKIAl9IG1heF9i
d1s2XTsKIAorCXUzMiBxZ3ZfcG9pbnRzX21hc2s7CisKIAlzdHJ1Y3QgZHJtX3ByaXZhdGVfb2Jq
IGJ3X29iajsKIAogCXN0cnVjdCBpbnRlbF9ydW50aW1lX3BtIHJ1bnRpbWVfcG07CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9yZWcuaAppbmRleCBhNjA3ZWE1MjA4MjkuLjZkNmVjZjFkOWY2YiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9yZWcuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3JlZy5oCkBAIC04OTUxLDYgKzg5NTEsOSBAQCBlbnVtIHsKICNkZWZpbmUgVkxW
X1JFTkRFUl9DMF9DT1VOVAkJCV9NTUlPKDB4MTM4MTE4KQogI2RlZmluZSBWTFZfTUVESUFfQzBf
Q09VTlQJCQlfTU1JTygweDEzODExQykKIAorLyogQlNwZWMgcHJlY2lzZWx5IGRlZmluZXMgdGhp
cyAqLworI2RlZmluZSBOVU1fU0FHVl9QT0lOVFMgOAorCiAjZGVmaW5lIEdFTjZfUENPREVfTUFJ
TEJPWAkJCV9NTUlPKDB4MTM4MTI0KQogI2RlZmluZSAgIEdFTjZfUENPREVfUkVBRFkJCQkoMSA8
PCAzMSkKICNkZWZpbmUgICBHRU42X1BDT0RFX0VSUk9SX01BU0sJCQkweEZGCkBAIC04OTYxLDYg
Kzg5NjQsOCBAQCBlbnVtIHsKICNkZWZpbmUgICAgIEdFTjZfUENPREVfVU5JTVBMRU1FTlRFRF9D
TUQJMHhGRgogI2RlZmluZSAgICAgR0VON19QQ09ERV9USU1FT1VUCQkJMHgyCiAjZGVmaW5lICAg
ICBHRU43X1BDT0RFX0lMTEVHQUxfREFUQQkJMHgzCisjZGVmaW5lICAgICBHRU4xMV9QQ09ERV9N
QUlMX0JPWF9MT0NLRUQJCTB4NgorI2RlZmluZSAgICAgR0VOMTFfUENPREVfUkVKRUNURUQJCTB4
MTEKICNkZWZpbmUgICAgIEdFTjdfUENPREVfTUlOX0ZSRVFfVEFCTEVfR1RfUkFUSU9fT1VUX09G
X1JBTkdFIDB4MTAKICNkZWZpbmUgICBHRU42X1BDT0RFX1dSSVRFX1JDNlZJRFMJCTB4NAogI2Rl
ZmluZSAgIEdFTjZfUENPREVfUkVBRF9SQzZWSURTCQkweDUKQEAgLTg5ODIsNiArODk4Nyw3IEBA
IGVudW0gewogI2RlZmluZSAgIElDTF9QQ09ERV9NRU1fU1VCU1lTWVNURU1fSU5GTwkweGQKICNk
ZWZpbmUgICAgIElDTF9QQ09ERV9NRU1fU1NfUkVBRF9HTE9CQUxfSU5GTwkoMHgwIDw8IDgpCiAj
ZGVmaW5lICAgICBJQ0xfUENPREVfTUVNX1NTX1JFQURfUUdWX1BPSU5UX0lORk8ocG9pbnQpCSgo
KHBvaW50KSA8PCAxNikgfCAoMHgxIDw8IDgpKQorI2RlZmluZSAgIElDTF9QQ09ERV9TQUdWX0RF
X01FTV9TU19DT05GSUcJMHhlCiAjZGVmaW5lICAgR0VONl9QQ09ERV9SRUFEX0RfQ09NUAkJMHgx
MAogI2RlZmluZSAgIEdFTjZfUENPREVfV1JJVEVfRF9DT01QCQkweDExCiAjZGVmaW5lICAgSFNX
X1BDT0RFX0RFX1dSSVRFX0ZSRVFfUkVRCQkweDE3CkBAIC04OTk0LDYgKzkwMDAsOCBAQCBlbnVt
IHsKICNkZWZpbmUgICAgIEdFTjlfU0FHVl9JU19ESVNBQkxFRAkJMHgxCiAjZGVmaW5lICAgICBH
RU45X1NBR1ZfRU5BQkxFCQkJMHgzCiAjZGVmaW5lIEdFTjEyX1BDT0RFX1JFQURfU0FHVl9CTE9D
S19USU1FX1VTCTB4MjMKKyNkZWZpbmUgR0VOMTFfUENPREVfUE9JTlRTX1JFU1RSSUNURUQJCTB4
MAorI2RlZmluZSBHRU4xMV9QQ09ERV9QT0lOVFNfUkVTVFJJQ1RFRF9NQVNLCTB4MQogI2RlZmlu
ZSBHRU42X1BDT0RFX0RBVEEJCQkJX01NSU8oMHgxMzgxMjgpCiAjZGVmaW5lICAgR0VONl9QQ09E
RV9GUkVRX0lBX1JBVElPX1NISUZUCTgKICNkZWZpbmUgICBHRU42X1BDT0RFX0ZSRVFfUklOR19S
QVRJT19TSElGVAkxNgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0u
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMKaW5kZXggYzc5MmRkMTY4NzQyLi5j
NzM3ZDJlOGNkODMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmMK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfcG0uYwpAQCAtMzYxNywxMyArMzYxNyw5
IEBAIHN0YXRpYyBib29sIHNrbF9uZWVkc19tZW1vcnlfYndfd2Eoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KQogCXJldHVybiBJU19HRU45X0JDKGRldl9wcml2KSB8fCBJU19CUk9Y
VE9OKGRldl9wcml2KTsKIH0KIAotc3RhdGljIGJvb2wKK2Jvb2wKIGludGVsX2hhc19zYWd2KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIHsKLQkvKiBIQUNLISAqLwotCWlmIChJ
U19HRU4oZGV2X3ByaXYsIDEyKSkKLQkJcmV0dXJuIGZhbHNlOwotCiAJcmV0dXJuIChJU19HRU45
X0JDKGRldl9wcml2KSB8fCBJTlRFTF9HRU4oZGV2X3ByaXYpID49IDEwKSAmJgogCQlkZXZfcHJp
di0+c2Fndl9zdGF0dXMgIT0gSTkxNV9TQUdWX05PVF9DT05UUk9MTEVEOwogfQpAQCAtMzgzOSw3
ICszODM1LDcgQEAgc3RhdGljIHZvaWQgaWNsX3NldF9zYWd2X21hc2soc3RydWN0IGludGVsX2F0
b21pY19zdGF0ZSAqc3RhdGUpCiAJCWlmIChmbGFncyAmIERSTV9NT0RFX0ZMQUdfSU5URVJMQUNF
KQogCQkJY29udGludWU7CiAKLQkJaWYgKCFuZXdfY3J0Y19zdGF0ZS0+YmFzZS5hY3RpdmUpCisJ
CWlmICghbmV3X2NydGNfc3RhdGUtPmh3LmVuYWJsZSkKIAkJCWNvbnRpbnVlOwogCiAJCWNhbl9z
YWd2ID0gdHJ1ZTsKQEAgLTQzNDAsNyArNDMzNiw3IEBAIHN0YXRpYyBpbnQKIHRnbF9jaGVja19w
aXBlX2ZpdHNfc2Fndl93bShzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSwKIAkJ
ICAgICAgc3RydWN0IHNrbF9kZGJfYWxsb2NhdGlvbiAqZGRiIC8qIG91dCAqLykKIHsKLQlzdHJ1
Y3QgZHJtX2NydGMgKmNydGMgPSBjcnRjX3N0YXRlLT5iYXNlLmNydGM7CisJc3RydWN0IGRybV9j
cnRjICpjcnRjID0gY3J0Y19zdGF0ZS0+dWFwaS5jcnRjOwogCXN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdiA9IHRvX2k5MTUoY3J0Yy0+ZGV2KTsKIAlzdHJ1Y3QgaW50ZWxfY3J0YyAq
aW50ZWxfY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Yyk7CiAJc3RydWN0IHNrbF9kZGJfZW50cnkg
KmFsbG9jID0gJmNydGNfc3RhdGUtPndtLnNrbC5kZGI7CkBAIC00ODMzLDcgKzQ4MjksNiBAQCBz
dGF0aWMgdm9pZCBza2xfY29tcHV0ZV9wbGFuZV93bShjb25zdCBzdHJ1Y3QgaW50ZWxfY3J0Y19z
dGF0ZSAqY3J0Y19zdGF0ZSwKIAkJCQkgc3RydWN0IHNrbF93bV9sZXZlbCAqcmVzdWx0IC8qIG91
dCAqLykKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGNy
dGNfc3RhdGUtPnVhcGkuY3J0Yy0+ZGV2KTsKLQl1MzIgbGF0ZW5jeSA9IGRldl9wcml2LT53bS5z
a2xfbGF0ZW5jeVtsZXZlbF07CiAJdWludF9maXhlZF8xNl8xNl90IG1ldGhvZDEsIG1ldGhvZDI7
CiAJdWludF9maXhlZF8xNl8xNl90IHNlbGVjdGVkX3Jlc3VsdDsKIAl1MzIgcmVzX2Jsb2Nrcywg
cmVzX2xpbmVzLCBtaW5fZGRiX2FsbG9jID0gMDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2ludGVsX3BtLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9wbS5oCmluZGV4
IGI1NzljNzI0YjkxNS4uNTMyNzU4NjA3MzFhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pbnRlbF9wbS5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3BtLmgKQEAg
LTQzLDYgKzQzLDcgQEAgdm9pZCBza2xfcGlwZV93bV9nZXRfaHdfc3RhdGUoc3RydWN0IGludGVs
X2NydGMgKmNydGMsCiB2b2lkIGc0eF93bV9zYW5pdGl6ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpOwogdm9pZCB2bHZfd21fc2FuaXRpemUoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmRldl9wcml2KTsKIGJvb2wgaW50ZWxfY2FuX2VuYWJsZV9zYWd2KHN0cnVjdCBpbnRlbF9h
dG9taWNfc3RhdGUgKnN0YXRlKTsKK2Jvb2wgaW50ZWxfaGFzX3NhZ3Yoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2KTsKIGludCBpbnRlbF9lbmFibGVfc2FndihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogaW50IGludGVsX2Rpc2FibGVfc2FndihzdHJ1Y3QgZHJt
X2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogYm9vbCBza2xfd21fbGV2ZWxfZXF1YWxzKGNvbnN0
IHN0cnVjdCBza2xfd21fbGV2ZWwgKmwxLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaW50ZWxfc2lkZWJhbmQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX3NpZGViYW5k
LmMKaW5kZXggZTA2YjM1Yjg0NGEwLi5mZjlkYmVkMDk0ZDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2ludGVsX3NpZGViYW5kLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aW50ZWxfc2lkZWJhbmQuYwpAQCAtMzcxLDYgKzM3MSwyOSBAQCBzdGF0aWMgaW5saW5lIGludCBn
ZW43X2NoZWNrX21haWxib3hfc3RhdHVzKHUzMiBtYm94KQogCX0KIH0KIAorc3RhdGljIGlubGlu
ZSBpbnQgZ2VuMTFfY2hlY2tfbWFpbGJveF9zdGF0dXModTMyIG1ib3gpCit7CisJc3dpdGNoICht
Ym94ICYgR0VONl9QQ09ERV9FUlJPUl9NQVNLKSB7CisJY2FzZSBHRU42X1BDT0RFX1NVQ0NFU1M6
CisJCXJldHVybiAwOworCWNhc2UgR0VONl9QQ09ERV9JTExFR0FMX0NNRDoKKwkJcmV0dXJuIC1F
TlhJTzsKKwljYXNlIEdFTjdfUENPREVfVElNRU9VVDoKKwkJcmV0dXJuIC1FVElNRURPVVQ7CisJ
Y2FzZSBHRU43X1BDT0RFX0lMTEVHQUxfREFUQToKKwkJcmV0dXJuIC1FSU5WQUw7CisJY2FzZSBH
RU43X1BDT0RFX01JTl9GUkVRX1RBQkxFX0dUX1JBVElPX09VVF9PRl9SQU5HRToKKwkJcmV0dXJu
IC1FT1ZFUkZMT1c7CisJY2FzZSBHRU4xMV9QQ09ERV9NQUlMX0JPWF9MT0NLRUQ6CisJCXJldHVy
biAtRUFHQUlOOworCWNhc2UgR0VOMTFfUENPREVfUkVKRUNURUQ6CisJCXJldHVybiAtRUFDQ0VT
OworCWRlZmF1bHQ6CisJCU1JU1NJTkdfQ0FTRShtYm94ICYgR0VONl9QQ09ERV9FUlJPUl9NQVNL
KTsKKwkJcmV0dXJuIDA7CisJfQorfQorCiBzdGF0aWMgaW50IF9fc2FuZHlicmlkZ2VfcGNvZGVf
cncoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJCQkJICB1MzIgbWJveCwgdTMyICp2
YWwsIHUzMiAqdmFsMSwKIAkJCQkgIGludCBmYXN0X3RpbWVvdXRfdXMsCkBAIC00MDgsNyArNDMx
LDkgQEAgc3RhdGljIGludCBfX3NhbmR5YnJpZGdlX3Bjb2RlX3J3KHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1LAogCWlmIChpc19yZWFkICYmIHZhbDEpCiAJCSp2YWwxID0gaW50ZWxfdW5j
b3JlX3JlYWRfZncodW5jb3JlLCBHRU42X1BDT0RFX0RBVEExKTsKIAotCWlmIChJTlRFTF9HRU4o
aTkxNSkgPiA2KQorCWlmIChJTlRFTF9HRU4oaTkxNSkgPj0gMTEpCisJCXJldHVybiBnZW4xMV9j
aGVja19tYWlsYm94X3N0YXR1cyhtYm94KTsKKwllbHNlIGlmIChJTlRFTF9HRU4oaTkxNSkgPiA2
KQogCQlyZXR1cm4gZ2VuN19jaGVja19tYWlsYm94X3N0YXR1cyhtYm94KTsKIAllbHNlCiAJCXJl
dHVybiBnZW42X2NoZWNrX21haWxib3hfc3RhdHVzKG1ib3gpOwotLSAKMi4xNy4xCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZng=

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id DE6B9AB9BE
	for <lists+intel-gfx@lfdr.de>; Fri,  6 Sep 2019 15:50:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D34D989187;
	Fri,  6 Sep 2019 13:50:03 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1A62389187
 for <intel-gfx@lists.freedesktop.org>; Fri,  6 Sep 2019 13:50:02 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga005.jf.intel.com ([10.7.209.41])
 by fmsmga106.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 06 Sep 2019 06:50:02 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,473,1559545200"; d="scan'208";a="358792803"
Received: from rosetta.fi.intel.com ([10.237.72.194])
 by orsmga005.jf.intel.com with ESMTP; 06 Sep 2019 06:49:59 -0700
Received: by rosetta.fi.intel.com (Postfix, from userid 1000)
 id 054D984077D; Fri,  6 Sep 2019 16:49:58 +0300 (EEST)
From: Mika Kuoppala <mika.kuoppala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Fri,  6 Sep 2019 16:49:57 +0300
Message-Id: <20190906134957.25909-1-mika.kuoppala@linux.intel.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190906133145.3366-1-mika.kuoppala@linux.intel.com>
References: <20190906133145.3366-1-mika.kuoppala@linux.intel.com>
Subject: [Intel-gfx] [PATCH 1/2] drm/i915: Use engine relative LRIs on
 context setup
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: Lucas De Marchi <lucas.demarchi@intel.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RGFuaWVsZSBwb2ludGVkIG91dCB0aGF0IHJlbGF0aXZlIG1taW8gd29ya3MgZGlmZmVyZW50bHkg
aW4Kb24gY29udGV4dCByZXN0b3JlLiBJbnN0ZWFkIG9mIGFkZGluZyB0aGUgZW5naW5lIG1taW8g
YmFzZSB0byBvZmZzZXQsCml0IG1hc2tzIG91dCB0aGUgYmFzZSBhbmQgYWRkcyBiaXRzIFsxMjoy
XSB0byBjdXJyZW50IGVuZ2luZSBiYXNlLgoKVGhpcyBzaG91bGQgYWxsb3cgdXMgdG8gY29uc3Ry
dWN0IGNvbnRleHQgcmVnaXN0ZXIgc3RhdGUgdG8gYmUKYXBwbGljYWJsZSB0byBhbGwgaW5zdGFu
Y2VzLCBpbmNsdWRpbmcgdmlydHVhbC4gQW5kIGF2b2lkIHRoZSB0cm91YmxlCm9mIHVwZGF0aW5n
IHRoZSByZWdpc3RlcnMgb24gdmlydHVhbCBpbnN0YW5jZXMgd2hlbiBzdWJtaXR0aW5nIHdvcmsu
Cgp2Mjogb25seSBlbmFibGUgZm9yIGdlbjEyIGZvciBub3cgKE1pa2EpCnYzOiBtYWtlIGVuYWJs
aW5nIHJlYWRhYmxlIChDaHJpcykKCkJzcGVjOiAyMDIwNgpDYzogQ2hyaXMgV2lsc29uIDxjaHJp
c0BjaHJpcy13aWxzb24uY28udWs+CkNjOiBUdnJ0a28gVXJzdWxpbiA8dHZydGtvLnVyc3VsaW5A
aW50ZWwuY29tPgpDYzogTWljaGFsIFdhamRlY3prbyA8bWljaGFsLndhamRlY3prb0BpbnRlbC5j
b20+CkNjOiBKb29uYXMgTGFodGluZW4gPGpvb25hcy5sYWh0aW5lbkBsaW51eC5pbnRlbC5jb20+
CkNjOiBMdWNhcyBEZSBNYXJjaGkgPGx1Y2FzLmRlbWFyY2hpQGludGVsLmNvbT4KQ2M6IEpvaG4g
SGFycmlzb24gPEpvaG4uQy5IYXJyaXNvbkBJbnRlbC5jb20+ClN1Z2dlc3RlZC1ieTogRGFuaWVs
ZSBDZXJhb2xvIFNwdXJpbyA8ZGFuaWVsZS5jZXJhb2xvc3B1cmlvQGludGVsLmNvbT4KU2lnbmVk
LW9mZi1ieTogTWlrYSBLdW9wcGFsYSA8bWlrYS5rdW9wcGFsYUBsaW51eC5pbnRlbC5jb20+ClJl
dmlld2VkLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlzQGNocmlzLXdpbHNvbi5jby51az4KLS0tCiBk
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCB8ICA3ICsrKysrKwog
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3B1X2NvbW1hbmRzLmggfCAgMiArKwogZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfbHJjLmMgICAgICAgICAgfCAyNiArKysrKysrKysr
KysrKy0tLS0tLQogMyBmaWxlcyBjaGFuZ2VkLCAyNyBpbnNlcnRpb25zKCspLCA4IGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2VuZ2luZV90
eXBlcy5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lX3R5cGVzLmgKaW5k
ZXggMTVlMDJjYjU4YTY3Li45NDNmMDY2MzgzN2UgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2VuZ2luZV90eXBlcy5oCkBAIC00ODEsNiArNDgxLDcgQEAgc3RydWN0IGludGVs
X2VuZ2luZV9jcyB7CiAjZGVmaW5lIEk5MTVfRU5HSU5FX0hBU19TRU1BUEhPUkVTICAgQklUKDMp
CiAjZGVmaW5lIEk5MTVfRU5HSU5FX05FRURTX0JSRUFEQ1JVTUJfVEFTS0xFVCBCSVQoNCkKICNk
ZWZpbmUgSTkxNV9FTkdJTkVfSVNfVklSVFVBTCAgICAgICBCSVQoNSkKKyNkZWZpbmUgSTkxNV9F
TkdJTkVfSEFTX1JFTEFUSVZFX01NSU8gQklUKDYpCiAJdW5zaWduZWQgaW50IGZsYWdzOwogCiAJ
LyoKQEAgLTU3Niw2ICs1NzcsMTIgQEAgaW50ZWxfZW5naW5lX2lzX3ZpcnR1YWwoY29uc3Qgc3Ry
dWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQogCXJldHVybiBlbmdpbmUtPmZsYWdzICYgSTkx
NV9FTkdJTkVfSVNfVklSVFVBTDsKIH0KIAorc3RhdGljIGlubGluZSBib29sCitpbnRlbF9lbmdp
bmVfaGFzX3JlbGF0aXZlX21taW8oY29uc3Qgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqIGNvbnN0
IGVuZ2luZSkKK3sKKwlyZXR1cm4gZW5naW5lLT5mbGFncyAmIEk5MTVfRU5HSU5FX0hBU19SRUxB
VElWRV9NTUlPOworfQorCiAjZGVmaW5lIGluc3Rkb25lX2hhc19zbGljZShkZXZfcHJpdl9fXywg
c3NldV9fXywgc2xpY2VfX18pIFwKIAkoKElTX0dFTihkZXZfcHJpdl9fXywgNykgPyAxIDogKChz
c2V1X19fKS0+c2xpY2VfbWFzaykpICYgQklUKHNsaWNlX19fKSkKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3B1X2NvbW1hbmRzLmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9ndC9pbnRlbF9ncHVfY29tbWFuZHMuaAppbmRleCA4NmUwMGEyZGI4YTQuLmZiYWQ0
MDNhYjdhYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3B1X2Nv
bW1hbmRzLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfZ3B1X2NvbW1hbmRz
LmgKQEAgLTEzMiw2ICsxMzIsOCBAQAogICogICBhZGRyZXNzL3ZhbHVlIHBhaXJzLiBEb24ndCBv
dmVyZHVlIGl0LCB0aG91Z2gsIHggPD0gMl40IG11c3QgaG9sZCEKICAqLwogI2RlZmluZSBNSV9M
T0FEX1JFR0lTVEVSX0lNTSh4KQlNSV9JTlNUUigweDIyLCAyKih4KS0xKQorLyogR2VuMTErLiBh
ZGRyID0gYmFzZSArIChjdHhfcmVzdG9yZSA/IG9mZnNldCAmIEdFTk1BU0soMTIsMikgOiBvZmZz
ZXQpICovCisjZGVmaW5lICAgTUlfTFJJX0NTX01NSU8JCSgxPDwxOSkKICNkZWZpbmUgICBNSV9M
UklfRk9SQ0VfUE9TVEVECQkoMTw8MTIpCiAjZGVmaW5lIE1JX1NUT1JFX1JFR0lTVEVSX01FTSAg
ICAgICAgTUlfSU5TVFIoMHgyNCwgMSkKICNkZWZpbmUgTUlfU1RPUkVfUkVHSVNURVJfTUVNX0dF
TjggICBNSV9JTlNUUigweDI0LCAyKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z3QvaW50ZWxfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwppbmRl
eCA4N2I3NDczYTZkZmIuLmQ4MDcwYjFhYTgyOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3QvaW50ZWxfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxf
bHJjLmMKQEAgLTEyMTQsNyArMTIxNCwxMCBAQCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfZGVxdWV1
ZShzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJCQkJdW5zaWduZWQgaW50IG47CiAK
IAkJCQlHRU1fQlVHX09OKFJFQURfT05DRSh2ZS0+Y29udGV4dC5pbmZsaWdodCkpOwotCQkJCXZp
cnR1YWxfdXBkYXRlX3JlZ2lzdGVyX29mZnNldHMocmVncywgZW5naW5lKTsKKworCQkJCWlmICgh
aW50ZWxfZW5naW5lX2hhc19yZWxhdGl2ZV9tbWlvKGVuZ2luZSkpCisJCQkJCXZpcnR1YWxfdXBk
YXRlX3JlZ2lzdGVyX29mZnNldHMocmVncywKKwkJCQkJCQkJCWVuZ2luZSk7CiAKIAkJCQlpZiAo
IWxpc3RfZW1wdHkoJnZlLT5jb250ZXh0LnNpZ25hbHMpKQogCQkJCQl2aXJ0dWFsX3hmZXJfYnJl
YWRjcnVtYnModmUsIGVuZ2luZSk7CkBAIC0yOTM5LDYgKzI5NDIsOSBAQCB2b2lkIGludGVsX2V4
ZWNsaXN0c19zZXRfZGVmYXVsdF9zdWJtaXNzaW9uKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVu
Z2luZSkKIAkJaWYgKEhBU19MT0dJQ0FMX1JJTkdfUFJFRU1QVElPTihlbmdpbmUtPmk5MTUpKQog
CQkJZW5naW5lLT5mbGFncyB8PSBJOTE1X0VOR0lORV9IQVNfUFJFRU1QVElPTjsKIAl9CisKKwlp
ZiAoZW5naW5lLT5jbGFzcyAhPSBDT1BZX0VOR0lORV9DTEFTUyAmJiBJTlRFTF9HRU4oZW5naW5l
LT5pOTE1KSA+PSAxMikKKwkJZW5naW5lLT5mbGFncyB8PSBJOTE1X0VOR0lORV9IQVNfUkVMQVRJ
VkVfTU1JTzsKIH0KIAogc3RhdGljIHZvaWQgZXhlY2xpc3RzX2Rlc3Ryb3koc3RydWN0IGludGVs
X2VuZ2luZV9jcyAqZW5naW5lKQpAQCAtMzEzMCw4ICszMTM2LDEwIEBAIHN0YXRpYyB2b2lkIGV4
ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh1MzIgKnJlZ3MsCiAJCQkJICAgICBzdHJ1Y3QgaW50ZWxf
cmluZyAqcmluZykKIHsKIAlzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQgPSB2bV9hbGlhcyhjZS0+
dm0pOwotCWJvb2wgcmNzID0gZW5naW5lLT5jbGFzcyA9PSBSRU5ERVJfQ0xBU1M7Ci0JdTMyIGJh
c2UgPSBlbmdpbmUtPm1taW9fYmFzZTsKKwljb25zdCBib29sIHJjcyA9IGVuZ2luZS0+Y2xhc3Mg
PT0gUkVOREVSX0NMQVNTOworCWNvbnN0IHUzMiBiYXNlID0gZW5naW5lLT5tbWlvX2Jhc2U7CisJ
Y29uc3QgdTMyIGxyaV9iYXNlID0gaW50ZWxfZW5naW5lX2hhc19yZWxhdGl2ZV9tbWlvKGVuZ2lu
ZSkgPworCQlNSV9MUklfQ1NfTU1JTyA6IDA7CiAKIAkvKgogCSAqIEEgY29udGV4dCBpcyBhY3R1
YWxseSBhIGJpZyBiYXRjaCBidWZmZXIgd2l0aCBzZXZlcmFsCkBAIC0zMTQ0LDcgKzMxNTIsNyBA
QCBzdGF0aWMgdm9pZCBleGVjbGlzdHNfaW5pdF9yZWdfc3RhdGUodTMyICpyZWdzLAogCSAqIE11
c3Qga2VlcCBjb25zaXN0ZW50IHdpdGggdmlydHVhbF91cGRhdGVfcmVnaXN0ZXJfb2Zmc2V0cygp
LgogCSAqLwogCXJlZ3NbQ1RYX0xSSV9IRUFERVJfMF0gPSBNSV9MT0FEX1JFR0lTVEVSX0lNTShy
Y3MgPyAxNCA6IDExKSB8Ci0JCQkJIE1JX0xSSV9GT1JDRV9QT1NURUQ7CisJCU1JX0xSSV9GT1JD
RV9QT1NURUQgfCBscmlfYmFzZTsKIAogCUNUWF9SRUcocmVncywgQ1RYX0NPTlRFWFRfQ09OVFJP
TCwgUklOR19DT05URVhUX0NPTlRST0woYmFzZSksCiAJCV9NQVNLRURfQklUX0RJU0FCTEUoQ1RY
X0NUUkxfRU5HSU5FX0NUWF9SRVNUT1JFX0lOSElCSVQpIHwKQEAgLTMxOTEsNyArMzE5OSw4IEBA
IHN0YXRpYyB2b2lkIGV4ZWNsaXN0c19pbml0X3JlZ19zdGF0ZSh1MzIgKnJlZ3MsCiAJCX0KIAl9
CiAKLQlyZWdzW0NUWF9MUklfSEVBREVSXzFdID0gTUlfTE9BRF9SRUdJU1RFUl9JTU0oOSkgfCBN
SV9MUklfRk9SQ0VfUE9TVEVEOworCXJlZ3NbQ1RYX0xSSV9IRUFERVJfMV0gPQorCQlNSV9MT0FE
X1JFR0lTVEVSX0lNTSg5KSB8IE1JX0xSSV9GT1JDRV9QT1NURUQgfCBscmlfYmFzZTsKIAogCUNU
WF9SRUcocmVncywgQ1RYX0NUWF9USU1FU1RBTVAsIFJJTkdfQ1RYX1RJTUVTVEFNUChiYXNlKSwg
MCk7CiAJLyogUERQIHZhbHVlcyB3ZWxsIGJlIGFzc2lnbmVkIGxhdGVyIGlmIG5lZWRlZCAqLwpA
QCAtMzIxOCw3ICszMjI3LDcgQEAgc3RhdGljIHZvaWQgZXhlY2xpc3RzX2luaXRfcmVnX3N0YXRl
KHUzMiAqcmVncywKIAl9CiAKIAlpZiAocmNzKSB7Ci0JCXJlZ3NbQ1RYX0xSSV9IRUFERVJfMl0g
PSBNSV9MT0FEX1JFR0lTVEVSX0lNTSgxKTsKKwkJcmVnc1tDVFhfTFJJX0hFQURFUl8yXSA9IE1J
X0xPQURfUkVHSVNURVJfSU1NKDEpIHwgbHJpX2Jhc2U7CiAJCUNUWF9SRUcocmVncywgQ1RYX1Jf
UFdSX0NMS19TVEFURSwgR0VOOF9SX1BXUl9DTEtfU1RBVEUsIDApOwogCX0KIApAQCAtMzQxMSw4
ICszNDIwLDkgQEAgc3RhdGljIHZvaWQgdmlydHVhbF9lbmdpbmVfaW5pdGlhbF9oaW50KHN0cnVj
dCB2aXJ0dWFsX2VuZ2luZSAqdmUpCiAJCXJldHVybjsKIAogCXN3YXAodmUtPnNpYmxpbmdzW3N3
cF0sIHZlLT5zaWJsaW5nc1swXSk7Ci0JdmlydHVhbF91cGRhdGVfcmVnaXN0ZXJfb2Zmc2V0cyh2
ZS0+Y29udGV4dC5scmNfcmVnX3N0YXRlLAotCQkJCQl2ZS0+c2libGluZ3NbMF0pOworCWlmICgh
aW50ZWxfZW5naW5lX2hhc19yZWxhdGl2ZV9tbWlvKHZlLT5zaWJsaW5nc1swXSkpCisJCXZpcnR1
YWxfdXBkYXRlX3JlZ2lzdGVyX29mZnNldHModmUtPmNvbnRleHQubHJjX3JlZ19zdGF0ZSwKKwkJ
CQkJCXZlLT5zaWJsaW5nc1swXSk7CiB9CiAKIHN0YXRpYyBpbnQgdmlydHVhbF9jb250ZXh0X3Bp
bihzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2UpCi0tIAoyLjE3LjEKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5nIGxpc3QKSW50
ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeA==

Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 4FE3EC9DD3
	for <lists+intel-gfx@lfdr.de>; Thu,  3 Oct 2019 13:54:05 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 13A066E9AD;
	Thu,  3 Oct 2019 11:54:03 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 443E06E9AE
 for <intel-gfx@lists.freedesktop.org>; Thu,  3 Oct 2019 11:54:00 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 18706285-1500050 
 for multiple; Thu, 03 Oct 2019 12:53:39 +0100
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Thu,  3 Oct 2019 12:53:36 +0100
Message-Id: <20191003115336.32378-1-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.23.0
In-Reply-To: <20191003093639.10186-17-chris@chris-wilson.co.uk>
References: <20191003093639.10186-17-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH] drm/i915: Move context management under GEM
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

S2VlcCB0cmFjayBvZiB0aGUgR0VNIGNvbnRleHRzIHVuZGVybmVhdGggaTkxNS0+Z2VtLmNvbnRl
eHRzIGFuZCBhc3NpZ24KdGhlbSB0aGVpciBvd24gbG9jayBmb3IgdGhlIHB1cnBvc2VzIG9mIGxp
c3QgbWFuYWdlbWVudC4KCnYyOiBGb2N1cyBvbiBsb2NrIHRyYWNraW5nOyBjdHgtPnZtIGlzIHBy
b3RlY3RlZCBieSBjdHgtPm11dGV4CgpTaWduZWQtb2ZmLWJ5OiBDaHJpcyBXaWxzb24gPGNocmlz
QGNocmlzLXdpbHNvbi5jby51az4KQ2M6IFR2cnRrbyBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBp
bnRlbC5jb20+Ci0tLQpBbm5vdGF0ZSB0aGUgY3R4LT52bSBhc3NpZ25tZW50IG9uIGNyZWF0aW9u
Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYyAgIHwgMTcz
ICsrKysrKysrLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2Nv
bnRleHQuaCAgIHwgIDI3ICsrLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4
dF90eXBlcy5oIHwgICAyICstCiAuLi4vZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVm
ZmVyLmMgICAgfCAgIDIgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV91c2Vy
cHRyLmMgICB8ICAgMyArLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2h1Z2VfcGFn
ZXMuYyAgIHwgIDM2ICsrLS0KIC4uLi9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2Nv
bnRleHQuYyB8IDE2NiArKysrKysrKy0tLS0tLS0tLQogLi4uL2dwdS9kcm0vaTkxNS9nZW0vc2Vs
ZnRlc3RzL21vY2tfY29udGV4dC5jIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9p
bnRlbF9jb250ZXh0LmMgICAgICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2xyYy5jICAgICAgICAgICB8ICAgNSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF9jb250ZXh0LmMgICAgfCAgMjQgKy0tCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxm
dGVzdF9oYW5nY2hlY2suYyAgfCAgMzkgKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2Vs
ZnRlc3RfbHJjLmMgICAgICAgIHwgICA2ICstCiAuLi4vZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0
X3dvcmthcm91bmRzLmMgICAgfCAgMTAgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9zY2hl
ZHVsZXIuYyAgICAgICAgICB8ICAyNCArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVi
dWdmcy5jICAgICAgICAgICB8ICA1MCArKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9k
cnYuYyAgICAgICAgICAgICAgIHwgICAyIC0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2
LmggICAgICAgICAgICAgICB8ICAyNyArLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2Vt
LmMgICAgICAgICAgICAgICB8ICAxMCArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1f
Z3R0LmMgICAgICAgICAgIHwgICA0ICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3BlcmYu
YyAgICAgICAgICAgICAgfCAgMjQgKystCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3N5c2Zz
LmMgICAgICAgICAgICAgfCAgNzcgKysrKy0tLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
dHJhY2UuaCAgICAgICAgICAgICB8ICAgMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfZ2VtLmMgICAgIHwgICA4IC0KIC4uLi9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfZ2VtX2V2aWN0LmMgICB8ICAgMyAtCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
aTkxNV9nZW1fZ3R0LmMgfCAgMTEgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9p
OTE1X3JlcXVlc3QuYyB8ICAxMiArLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfdm1hLmMgICAgIHwgICA3ICstCiAuLi4vZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9tb2NrX2dl
bV9kZXZpY2UuYyAgfCAgIDYgKy0KIDI5IGZpbGVzIGNoYW5nZWQsIDM4OSBpbnNlcnRpb25zKCsp
LCAzODUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9j
b250ZXh0LmMKaW5kZXggYWU1ODg1NDRiZjNhLi40MjdhOWEyNWQ1OWEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuYwpAQCAtMjE4LDkgKzIxOCwxMiBAQCBz
dGF0aWMgc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXMgKmRlZmF1bHRfZW5naW5lcyhzdHJ1Y3QgaTkx
NV9nZW1fY29udGV4dCAqY3R4KQogCiBzdGF0aWMgdm9pZCBpOTE1X2dlbV9jb250ZXh0X2ZyZWUo
c3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIHsKLQlsb2NrZGVwX2Fzc2VydF9oZWxkKCZj
dHgtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCUdFTV9CVUdfT04oIWk5MTVfZ2VtX2NvbnRl
eHRfaXNfY2xvc2VkKGN0eCkpOwogCisJc3Bpbl9sb2NrKCZjdHgtPmk5MTUtPmdlbS5jb250ZXh0
cy5sb2NrKTsKKwlsaXN0X2RlbCgmY3R4LT5saW5rKTsKKwlzcGluX3VubG9jaygmY3R4LT5pOTE1
LT5nZW0uY29udGV4dHMubG9jayk7CisKIAlmcmVlX2VuZ2luZXMocmN1X2FjY2Vzc19wb2ludGVy
KGN0eC0+ZW5naW5lcykpOwogCW11dGV4X2Rlc3Ryb3koJmN0eC0+ZW5naW5lc19tdXRleCk7CiAK
QEAgLTIzMCw2NyArMjMzLDU0IEBAIHN0YXRpYyB2b2lkIGk5MTVfZ2VtX2NvbnRleHRfZnJlZShz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQogCWtmcmVlKGN0eC0+bmFtZSk7CiAJcHV0X3Bp
ZChjdHgtPnBpZCk7CiAKLQlsaXN0X2RlbCgmY3R4LT5saW5rKTsKIAltdXRleF9kZXN0cm95KCZj
dHgtPm11dGV4KTsKIAogCWtmcmVlX3JjdShjdHgsIHJjdSk7CiB9CiAKLXN0YXRpYyB2b2lkIGNv
bnRleHRzX2ZyZWUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0aWMgdm9pZCBj
b250ZXh0c19mcmVlX2FsbChzdHJ1Y3QgbGxpc3Rfbm9kZSAqbGlzdCkKIHsKLQlzdHJ1Y3QgbGxp
c3Rfbm9kZSAqZnJlZWQgPSBsbGlzdF9kZWxfYWxsKCZpOTE1LT5jb250ZXh0cy5mcmVlX2xpc3Qp
OwogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsICpjbjsKIAotCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCi0JbGxpc3RfZm9yX2VhY2hfZW50cnlf
c2FmZShjdHgsIGNuLCBmcmVlZCwgZnJlZV9saW5rKQorCWxsaXN0X2Zvcl9lYWNoX2VudHJ5X3Nh
ZmUoY3R4LCBjbiwgbGlzdCwgZnJlZV9saW5rKQogCQlpOTE1X2dlbV9jb250ZXh0X2ZyZWUoY3R4
KTsKIH0KIAotc3RhdGljIHZvaWQgY29udGV4dHNfZnJlZV9maXJzdChzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqaTkxNSkKK3N0YXRpYyB2b2lkIGNvbnRleHRzX2ZsdXNoX2ZyZWUoc3RydWN0IGk5
MTVfZ2VtX2NvbnRleHRzICpnYykKIHsKLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4Owot
CXN0cnVjdCBsbGlzdF9ub2RlICpmcmVlZDsKLQotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwotCi0JZnJlZWQgPSBsbGlzdF9kZWxfZmlyc3QoJmk5MTUtPmNv
bnRleHRzLmZyZWVfbGlzdCk7Ci0JaWYgKCFmcmVlZCkKLQkJcmV0dXJuOwotCi0JY3R4ID0gY29u
dGFpbmVyX29mKGZyZWVkLCB0eXBlb2YoKmN0eCksIGZyZWVfbGluayk7Ci0JaTkxNV9nZW1fY29u
dGV4dF9mcmVlKGN0eCk7CisJY29udGV4dHNfZnJlZV9hbGwobGxpc3RfZGVsX2FsbCgmZ2MtPmZy
ZWVfbGlzdCkpOwogfQogCiBzdGF0aWMgdm9pZCBjb250ZXh0c19mcmVlX3dvcmtlcihzdHJ1Y3Qg
d29ya19zdHJ1Y3QgKndvcmspCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPQot
CQljb250YWluZXJfb2Yod29yaywgdHlwZW9mKCppOTE1KSwgY29udGV4dHMuZnJlZV93b3JrKTsK
KwlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dHMgKmdjID0KKwkJY29udGFpbmVyX29mKHdvcmssIHR5
cGVvZigqZ2MpLCBmcmVlX3dvcmspOwogCi0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Ci0JY29udGV4dHNfZnJlZShpOTE1KTsKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOworCWNvbnRleHRzX2ZsdXNoX2ZyZWUoZ2MpOwogfQogCiB2b2lkIGk5MTVf
Z2VtX2NvbnRleHRfcmVsZWFzZShzdHJ1Y3Qga3JlZiAqcmVmKQogewogCXN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHggPSBjb250YWluZXJfb2YocmVmLCB0eXBlb2YoKmN0eCksIHJlZik7Ci0J
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBjdHgtPmk5MTU7CisJc3RydWN0IGk5MTVf
Z2VtX2NvbnRleHRzICpnYyA9ICZjdHgtPmk5MTUtPmdlbS5jb250ZXh0czsKIAogCXRyYWNlX2k5
MTVfY29udGV4dF9mcmVlKGN0eCk7Ci0JaWYgKGxsaXN0X2FkZCgmY3R4LT5mcmVlX2xpbmssICZp
OTE1LT5jb250ZXh0cy5mcmVlX2xpc3QpKQotCQlxdWV1ZV93b3JrKGk5MTUtPndxLCAmaTkxNS0+
Y29udGV4dHMuZnJlZV93b3JrKTsKKwlpZiAobGxpc3RfYWRkKCZjdHgtPmZyZWVfbGluaywgJmdj
LT5mcmVlX2xpc3QpKQorCQlxdWV1ZV93b3JrKGN0eC0+aTkxNS0+d3EsICZnYy0+ZnJlZV93b3Jr
KTsKIH0KIAogc3RhdGljIHZvaWQgY29udGV4dF9jbG9zZShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4
dCAqY3R4KQogewotCWk5MTVfZ2VtX2NvbnRleHRfc2V0X2Nsb3NlZChjdHgpOworCXN0cnVjdCBp
OTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwogCi0JaWYgKGN0eC0+dm0pCi0JCWk5MTVfdm1fY2xvc2Uo
Y3R4LT52bSk7CisJaTkxNV9nZW1fY29udGV4dF9zZXRfY2xvc2VkKGN0eCk7CiAKIAltdXRleF9s
b2NrKCZjdHgtPm11dGV4KTsKIAorCXZtID0gaTkxNV9nZW1fY29udGV4dF92bShjdHgpOworCWlm
ICh2bSkKKwkJaTkxNV92bV9jbG9zZSh2bSk7CisKIAljdHgtPmZpbGVfcHJpdiA9IEVSUl9QVFIo
LUVCQURGKTsKIAogCS8qCkBAIC0zMTcsNyArMzA3LDYgQEAgX19jcmVhdGVfY29udGV4dChzdHJ1
Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7CiAK
IAlrcmVmX2luaXQoJmN0eC0+cmVmKTsKLQlsaXN0X2FkZF90YWlsKCZjdHgtPmxpbmssICZpOTE1
LT5jb250ZXh0cy5saXN0KTsKIAljdHgtPmk5MTUgPSBpOTE1OwogCWN0eC0+c2NoZWQucHJpb3Jp
dHkgPSBJOTE1X1VTRVJfUFJJT1JJVFkoSTkxNV9QUklPUklUWV9OT1JNQUwpOwogCW11dGV4X2lu
aXQoJmN0eC0+bXV0ZXgpOwpAQCAtMzQzLDYgKzMzMiwxMCBAQCBfX2NyZWF0ZV9jb250ZXh0KHN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpF
KGN0eC0+aGFuZ190aW1lc3RhbXApOyBpKyspCiAJCWN0eC0+aGFuZ190aW1lc3RhbXBbaV0gPSBq
aWZmaWVzIC0gQ09OVEVYVF9GQVNUX0hBTkdfSklGRklFUzsKIAorCXNwaW5fbG9jaygmaTkxNS0+
Z2VtLmNvbnRleHRzLmxvY2spOworCWxpc3RfYWRkX3RhaWwoJmN0eC0+bGluaywgJmk5MTUtPmdl
bS5jb250ZXh0cy5saXN0KTsKKwlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2sp
OworCiAJcmV0dXJuIGN0eDsKIAogZXJyX2ZyZWU6CkBAIC0zNzIsMTEgKzM2NSwxMSBAQCBzdGF0
aWMgdm9pZCBfX2FwcGx5X3BwZ3R0KHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwgdm9pZCAqdm0p
CiBzdGF0aWMgc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqCiBfX3NldF9wcGd0dChzdHJ1Y3Qg
aTkxNV9nZW1fY29udGV4dCAqY3R4LCBzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKIHsK
LQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICpvbGQgPSBjdHgtPnZtOworCXN0cnVjdCBpOTE1
X2FkZHJlc3Nfc3BhY2UgKm9sZCA9IGk5MTVfZ2VtX2NvbnRleHRfdm0oY3R4KTsKIAogCUdFTV9C
VUdfT04ob2xkICYmIGk5MTVfdm1faXNfNGx2bCh2bSkgIT0gaTkxNV92bV9pc180bHZsKG9sZCkp
OwogCi0JY3R4LT52bSA9IGk5MTVfdm1fb3Blbih2bSk7CisJcmN1X2Fzc2lnbl9wb2ludGVyKGN0
eC0+dm0sIGk5MTVfdm1fb3Blbih2bSkpOwogCWNvbnRleHRfYXBwbHlfYWxsKGN0eCwgX19hcHBs
eV9wcGd0dCwgdm0pOwogCiAJcmV0dXJuIG9sZDsKQEAgLTM4NSw3ICszNzgsNyBAQCBfX3NldF9w
cGd0dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LCBzdHJ1Y3QgaTkxNV9hZGRyZXNzX3Nw
YWNlICp2bSkKIHN0YXRpYyB2b2lkIF9fYXNzaWduX3BwZ3R0KHN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHgsCiAJCQkgICBzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSkKIHsKLQlpZiAo
dm0gPT0gY3R4LT52bSkKKwlpZiAodm0gPT0gcmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pKQog
CQlyZXR1cm47CiAKIAl2bSA9IF9fc2V0X3BwZ3R0KGN0eCwgdm0pOwpAQCAtNDE3LDI3ICs0MTAs
MjUgQEAgc3RhdGljIHZvaWQgX19hc3NpZ25fdGltZWxpbmUoc3RydWN0IGk5MTVfZ2VtX2NvbnRl
eHQgKmN0eCwKIH0KIAogc3RhdGljIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICoKLWk5MTVfZ2Vt
X2NyZWF0ZV9jb250ZXh0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdiwgdW5zaWdu
ZWQgaW50IGZsYWdzKQoraTkxNV9nZW1fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUsIHVuc2lnbmVkIGludCBmbGFncykKIHsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29u
dGV4dCAqY3R4OwogCi0JbG9ja2RlcF9hc3NlcnRfaGVsZCgmZGV2X3ByaXYtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwotCiAJaWYgKGZsYWdzICYgSTkxNV9DT05URVhUX0NSRUFURV9GTEFHU19TSU5HTEVf
VElNRUxJTkUgJiYKLQkgICAgIUhBU19FWEVDTElTVFMoZGV2X3ByaXYpKQorCSAgICAhSEFTX0VY
RUNMSVNUUyhpOTE1KSkKIAkJcmV0dXJuIEVSUl9QVFIoLUVJTlZBTCk7CiAKLQkvKiBSZWFwIHRo
ZSBtb3N0IHN0YWxlIGNvbnRleHQgKi8KLQljb250ZXh0c19mcmVlX2ZpcnN0KGRldl9wcml2KTsK
KwkvKiBSZWFwIHRoZSBzdGFsZSBjb250ZXh0cyAqLworCWNvbnRleHRzX2ZsdXNoX2ZyZWUoJmk5
MTUtPmdlbS5jb250ZXh0cyk7CiAKLQljdHggPSBfX2NyZWF0ZV9jb250ZXh0KGRldl9wcml2KTsK
KwljdHggPSBfX2NyZWF0ZV9jb250ZXh0KGk5MTUpOwogCWlmIChJU19FUlIoY3R4KSkKIAkJcmV0
dXJuIGN0eDsKIAotCWlmIChIQVNfRlVMTF9QUEdUVChkZXZfcHJpdikpIHsKKwlpZiAoSEFTX0ZV
TExfUFBHVFQoaTkxNSkpIHsKIAkJc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0OwogCi0JCXBwZ3R0
ID0gaTkxNV9wcGd0dF9jcmVhdGUoZGV2X3ByaXYpOworCQlwcGd0dCA9IGk5MTVfcHBndHRfY3Jl
YXRlKGk5MTUpOwogCQlpZiAoSVNfRVJSKHBwZ3R0KSkgewogCQkJRFJNX0RFQlVHX0RSSVZFUigi
UFBHVFQgc2V0dXAgZmFpbGVkICglbGQpXG4iLAogCQkJCQkgUFRSX0VSUihwcGd0dCkpOwpAQCAt
NDQ1LDE0ICs0MzYsMTcgQEAgaTkxNV9nZW1fY3JlYXRlX2NvbnRleHQoc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmRldl9wcml2LCB1bnNpZ25lZCBpbnQgZmxhZ3MpCiAJCQlyZXR1cm4gRVJSX0NB
U1QocHBndHQpOwogCQl9CiAKKwkJbXV0ZXhfbG9jaygmY3R4LT5tdXRleCk7CiAJCV9fYXNzaWdu
X3BwZ3R0KGN0eCwgJnBwZ3R0LT52bSk7CisJCW11dGV4X3VubG9jaygmY3R4LT5tdXRleCk7CisK
IAkJaTkxNV92bV9wdXQoJnBwZ3R0LT52bSk7CiAJfQogCiAJaWYgKGZsYWdzICYgSTkxNV9DT05U
RVhUX0NSRUFURV9GTEFHU19TSU5HTEVfVElNRUxJTkUpIHsKIAkJc3RydWN0IGludGVsX3RpbWVs
aW5lICp0aW1lbGluZTsKIAotCQl0aW1lbGluZSA9IGludGVsX3RpbWVsaW5lX2NyZWF0ZSgmZGV2
X3ByaXYtPmd0LCBOVUxMKTsKKwkJdGltZWxpbmUgPSBpbnRlbF90aW1lbGluZV9jcmVhdGUoJmk5
MTUtPmd0LCBOVUxMKTsKIAkJaWYgKElTX0VSUih0aW1lbGluZSkpIHsKIAkJCWNvbnRleHRfY2xv
c2UoY3R4KTsKIAkJCXJldHVybiBFUlJfQ0FTVCh0aW1lbGluZSk7CkBAIC00OTcsNDggKzQ5MSw0
MCBAQCBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9rZXJuZWwoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsIGludCBwcmlvKQogCXJldHVybiBjdHg7CiB9CiAKLXN0YXRpYyB2b2lkIGluaXRf
Y29udGV4dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCitzdGF0aWMgdm9pZCBpbml0
X2NvbnRleHRzKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0cyAqZ2MpCiB7Ci0JbXV0ZXhfaW5pdCgm
aTkxNS0+Y29udGV4dHMubXV0ZXgpOwotCUlOSVRfTElTVF9IRUFEKCZpOTE1LT5jb250ZXh0cy5s
aXN0KTsKLQotCS8qIFVzaW5nIHRoZSBzaW1wbGUgaWRhIGludGVyZmFjZSwgdGhlIG1heCBpcyBs
aW1pdGVkIGJ5IHNpemVvZihpbnQpICovCi0JQlVJTERfQlVHX09OKE1BWF9DT05URVhUX0hXX0lE
ID4gSU5UX01BWCk7Ci0JQlVJTERfQlVHX09OKEdFTjExX01BWF9DT05URVhUX0hXX0lEID4gSU5U
X01BWCk7Ci0JaWRhX2luaXQoJmk5MTUtPmNvbnRleHRzLmh3X2lkYSk7Ci0JSU5JVF9MSVNUX0hF
QUQoJmk5MTUtPmNvbnRleHRzLmh3X2lkX2xpc3QpOworCXNwaW5fbG9ja19pbml0KCZnYy0+bG9j
ayk7CisJSU5JVF9MSVNUX0hFQUQoJmdjLT5saXN0KTsKIAotCUlOSVRfV09SSygmaTkxNS0+Y29u
dGV4dHMuZnJlZV93b3JrLCBjb250ZXh0c19mcmVlX3dvcmtlcik7Ci0JaW5pdF9sbGlzdF9oZWFk
KCZpOTE1LT5jb250ZXh0cy5mcmVlX2xpc3QpOworCUlOSVRfV09SSygmZ2MtPmZyZWVfd29yaywg
Y29udGV4dHNfZnJlZV93b3JrZXIpOworCWluaXRfbGxpc3RfaGVhZCgmZ2MtPmZyZWVfbGlzdCk7
CiB9CiAKLWludCBpOTE1X2dlbV9jb250ZXh0c19pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKK2ludCBpOTE1X2dlbV9pbml0X2NvbnRleHRzKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICppOTE1KQogewogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CiAKIAkvKiBS
ZWFzc3VyZSBvdXJzZWx2ZXMgd2UgYXJlIG9ubHkgY2FsbGVkIG9uY2UgKi8KLQlHRU1fQlVHX09O
KGRldl9wcml2LT5rZXJuZWxfY29udGV4dCk7CisJR0VNX0JVR19PTihpOTE1LT5rZXJuZWxfY29u
dGV4dCk7CiAKLQlpbml0X2NvbnRleHRzKGRldl9wcml2KTsKKwlpbml0X2NvbnRleHRzKCZpOTE1
LT5nZW0uY29udGV4dHMpOwogCiAJLyogbG93ZXN0IHByaW9yaXR5OyBpZGxlIHRhc2sgKi8KLQlj
dHggPSBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9rZXJuZWwoZGV2X3ByaXYsIEk5MTVfUFJJT1JJ
VFlfTUlOKTsKKwljdHggPSBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9rZXJuZWwoaTkxNSwgSTkx
NV9QUklPUklUWV9NSU4pOwogCWlmIChJU19FUlIoY3R4KSkgewogCQlEUk1fRVJST1IoIkZhaWxl
ZCB0byBjcmVhdGUgZGVmYXVsdCBnbG9iYWwgY29udGV4dFxuIik7CiAJCXJldHVybiBQVFJfRVJS
KGN0eCk7CiAJfQotCWRldl9wcml2LT5rZXJuZWxfY29udGV4dCA9IGN0eDsKKwlpOTE1LT5rZXJu
ZWxfY29udGV4dCA9IGN0eDsKIAogCURSTV9ERUJVR19EUklWRVIoIiVzIGNvbnRleHQgc3VwcG9y
dCBpbml0aWFsaXplZFxuIiwKLQkJCSBEUklWRVJfQ0FQUyhkZXZfcHJpdiktPmhhc19sb2dpY2Fs
X2NvbnRleHRzID8KKwkJCSBEUklWRVJfQ0FQUyhpOTE1KS0+aGFzX2xvZ2ljYWxfY29udGV4dHMg
PwogCQkJICJsb2dpY2FsIiA6ICJmYWtlIik7CiAJcmV0dXJuIDA7CiB9CiAKLXZvaWQgaTkxNV9n
ZW1fY29udGV4dHNfZmluaShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKK3ZvaWQgaTkx
NV9nZW1fZHJpdmVyX3JlbGVhc2VfX2NvbnRleHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQogewotCWxvY2tkZXBfYXNzZXJ0X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwot
CiAJZGVzdHJveV9rZXJuZWxfY29udGV4dCgmaTkxNS0+a2VybmVsX2NvbnRleHQpOwogfQogCkBA
IC01NTcsMTEgKzU0MywxNiBAQCBzdGF0aWMgaW50IHZtX2lkcl9jbGVhbnVwKGludCBpZCwgdm9p
ZCAqcCwgdm9pZCAqZGF0YSkKIHN0YXRpYyBpbnQgZ2VtX2NvbnRleHRfcmVnaXN0ZXIoc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAkJCQlzdHJ1Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRl
ICpmcHJpdikKIHsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKIAlpbnQgcmV0Owog
CiAJY3R4LT5maWxlX3ByaXYgPSBmcHJpdjsKLQlpZiAoY3R4LT52bSkKLQkJY3R4LT52bS0+Zmls
ZSA9IGZwcml2OworCisJbXV0ZXhfbG9jaygmY3R4LT5tdXRleCk7CisJdm0gPSBpOTE1X2dlbV9j
b250ZXh0X3ZtKGN0eCk7CisJaWYgKHZtKQorCQlXUklURV9PTkNFKHZtLT5maWxlLCBmcHJpdik7
IC8qIFhYWCAqLworCW11dGV4X3VubG9jaygmY3R4LT5tdXRleCk7CiAKIAljdHgtPnBpZCA9IGdl
dF90YXNrX3BpZChjdXJyZW50LCBQSURUWVBFX1BJRCk7CiAJY3R4LT5uYW1lID0ga2FzcHJpbnRm
KEdGUF9LRVJORUwsICIlc1slZF0iLApAQCAtNTk4LDkgKzU4OSw3IEBAIGludCBpOTE1X2dlbV9j
b250ZXh0X29wZW4oc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJaWRyX2luaXQoJmZp
bGVfcHJpdi0+Y29udGV4dF9pZHIpOwogCWlkcl9pbml0X2Jhc2UoJmZpbGVfcHJpdi0+dm1faWRy
LCAxKTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWN0eCA9IGk5
MTVfZ2VtX2NyZWF0ZV9jb250ZXh0KGk5MTUsIDApOwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7CiAJaWYgKElTX0VSUihjdHgpKSB7CiAJCWVyciA9IFBUUl9FUlIoY3R4
KTsKIAkJZ290byBlcnI7CkBAIC02MjgsNiArNjE3LDcgQEAgaW50IGk5MTVfZ2VtX2NvbnRleHRf
b3BlbihzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwKIHZvaWQgaTkxNV9nZW1fY29udGV4
dF9jbG9zZShzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCiB7CiAJc3RydWN0IGRybV9pOTE1X2ZpbGVf
cHJpdmF0ZSAqZmlsZV9wcml2ID0gZmlsZS0+ZHJpdmVyX3ByaXY7CisJc3RydWN0IGRybV9pOTE1
X3ByaXZhdGUgKmk5MTUgPSBmaWxlX3ByaXYtPmRldl9wcml2OwogCiAJaWRyX2Zvcl9lYWNoKCZm
aWxlX3ByaXYtPmNvbnRleHRfaWRyLCBjb250ZXh0X2lkcl9jbGVhbnVwLCBOVUxMKTsKIAlpZHJf
ZGVzdHJveSgmZmlsZV9wcml2LT5jb250ZXh0X2lkcik7CkBAIC02MzYsNiArNjI2LDggQEAgdm9p
ZCBpOTE1X2dlbV9jb250ZXh0X2Nsb3NlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKIAlpZHJfZm9y
X2VhY2goJmZpbGVfcHJpdi0+dm1faWRyLCB2bV9pZHJfY2xlYW51cCwgTlVMTCk7CiAJaWRyX2Rl
c3Ryb3koJmZpbGVfcHJpdi0+dm1faWRyKTsKIAltdXRleF9kZXN0cm95KCZmaWxlX3ByaXYtPnZt
X2lkcl9sb2NrKTsKKworCWNvbnRleHRzX2ZsdXNoX2ZyZWUoJmk5MTUtPmdlbS5jb250ZXh0cyk7
CiB9CiAKIGludCBpOTE1X2dlbV92bV9jcmVhdGVfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRl
diwgdm9pZCAqZGF0YSwKQEAgLTgxNCwxNiArODA2LDEyIEBAIHN0YXRpYyBpbnQgZ2V0X3BwZ3R0
KHN0cnVjdCBkcm1faTkxNV9maWxlX3ByaXZhdGUgKmZpbGVfcHJpdiwKIAlzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bTsKIAlpbnQgcmV0OwogCi0JaWYgKCFjdHgtPnZtKQorCWlmICghcmN1
X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pKQogCQlyZXR1cm4gLUVOT0RFVjsKIAotCS8qIFhYWCBy
Y3UgYWNxdWlyZT8gKi8KLQlyZXQgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmN0eC0+aTkx
NS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKLQorCXJjdV9y
ZWFkX2xvY2soKTsKIAl2bSA9IGk5MTVfdm1fZ2V0KGN0eC0+dm0pOwotCW11dGV4X3VubG9jaygm
Y3R4LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKKwlyY3VfcmVhZF91bmxvY2soKTsKIAogCXJl
dCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmZmlsZV9wcml2LT52bV9pZHJfbG9jayk7CiAJ
aWYgKHJldCkKQEAgLTkzMiw3ICs5MjAsNyBAQCBzdGF0aWMgaW50IHNldF9wcGd0dChzdHJ1Y3Qg
ZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYsCiAJaWYgKGFyZ3MtPnNpemUpCiAJCXJl
dHVybiAtRUlOVkFMOwogCi0JaWYgKCFjdHgtPnZtKQorCWlmICghcmN1X2FjY2Vzc19wb2ludGVy
KGN0eC0+dm0pKQogCQlyZXR1cm4gLUVOT0RFVjsKIAogCWlmICh1cHBlcl8zMl9iaXRzKGFyZ3Mt
PnZhbHVlKSkKQEAgLTk0NiwxNyArOTM0LDIwIEBAIHN0YXRpYyBpbnQgc2V0X3BwZ3R0KHN0cnVj
dCBkcm1faTkxNV9maWxlX3ByaXZhdGUgKmZpbGVfcHJpdiwKIAlpZiAoIXZtKQogCQlyZXR1cm4g
LUVOT0VOVDsKIAotCWVyciA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmY3R4LT5pOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKKwllcnIgPSBtdXRleF9sb2NrX2ludGVycnVwdGlibGUoJmN0eC0+
bXV0ZXgpOwogCWlmIChlcnIpCiAJCWdvdG8gb3V0OwogCi0JaWYgKHZtID09IGN0eC0+dm0pCisJ
aWYgKGk5MTVfZ2VtX2NvbnRleHRfaXNfY2xvc2VkKGN0eCkpIHsKKwkJZXJyID0gLUVOT0VOVDsK
KwkJZ290byBvdXQ7CisJfQorCisJaWYgKHZtID09IHJjdV9hY2Nlc3NfcG9pbnRlcihjdHgtPnZt
KSkKIAkJZ290byB1bmxvY2s7CiAKIAkvKiBUZWFyZG93biB0aGUgZXhpc3Rpbmcgb2JqOnZtYSBj
YWNoZSwgaXQgd2lsbCBoYXZlIHRvIGJlIHJlYnVpbHQuICovCi0JbXV0ZXhfbG9jaygmY3R4LT5t
dXRleCk7CiAJbHV0X2Nsb3NlKGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZjdHgtPm11dGV4KTsKIAog
CW9sZCA9IF9fc2V0X3BwZ3R0KGN0eCwgdm0pOwogCkBAIC05NzYsOCArOTY3LDcgQEAgc3RhdGlj
IGludCBzZXRfcHBndHQoc3RydWN0IGRybV9pOTE1X2ZpbGVfcHJpdmF0ZSAqZmlsZV9wcml2LAog
CX0KIAogdW5sb2NrOgotCW11dGV4X3VubG9jaygmY3R4LT5pOTE1LT5kcm0uc3RydWN0X211dGV4
KTsKLQorCW11dGV4X3VubG9jaygmY3R4LT5tdXRleCk7CiBvdXQ6CiAJaTkxNV92bV9wdXQodm0p
OwogCXJldHVybiBlcnI7CkBAIC0xODM2LDcgKzE4MjYsNyBAQCBzdGF0aWMgaW50IGNsb25lX3Zt
KHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpkc3QsCiAKIAlyY3VfcmVhZF9sb2NrKCk7CiAJZG8g
ewotCQl2bSA9IFJFQURfT05DRShzcmMtPnZtKTsKKwkJdm0gPSByY3VfZGVyZWZlcmVuY2Uoc3Jj
LT52bSk7CiAJCWlmICghdm0pCiAJCQlicmVhazsKIApAQCAtMTg1OCw3ICsxODQ4LDcgQEAgc3Rh
dGljIGludCBjbG9uZV92bShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqZHN0LAogCQkgKiBpdCBj
YW5ub3QgYmUgcmVhbGxvY2F0ZWQgZWxzZXdoZXJlLgogCQkgKi8KIAotCQlpZiAodm0gPT0gUkVB
RF9PTkNFKHNyYy0+dm0pKQorCQlpZiAodm0gPT0gcmN1X2FjY2Vzc19wb2ludGVyKHNyYy0+dm0p
KQogCQkJYnJlYWs7CiAKIAkJaTkxNV92bV9wdXQodm0pOwpAQCAtMTk2MCwxMiArMTk1MCw3IEBA
IGludCBpOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2
LCB2b2lkICpkYXRhLAogCQlyZXR1cm4gLUVJTzsKIAl9CiAKLQlyZXQgPSBpOTE1X211dGV4X2xv
Y2tfaW50ZXJydXB0aWJsZShkZXYpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7Ci0KIAlleHRf
ZGF0YS5jdHggPSBpOTE1X2dlbV9jcmVhdGVfY29udGV4dChpOTE1LCBhcmdzLT5mbGFncyk7Ci0J
bXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7CiAJaWYgKElTX0VSUihleHRfZGF0YS5j
dHgpKQogCQlyZXR1cm4gUFRSX0VSUihleHRfZGF0YS5jdHgpOwogCkBAIC0yMDkyLDEwICsyMDc3
LDEyIEBAIGludCBpOTE1X2dlbV9jb250ZXh0X2dldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2
aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAKIAljYXNlIEk5MTVfQ09OVEVYVF9QQVJBTV9HVFRfU0la
RToKIAkJYXJncy0+c2l6ZSA9IDA7Ci0JCWlmIChjdHgtPnZtKQotCQkJYXJncy0+dmFsdWUgPSBj
dHgtPnZtLT50b3RhbDsKKwkJcmN1X3JlYWRfbG9jaygpOworCQlpZiAocmN1X2FjY2Vzc19wb2lu
dGVyKGN0eC0+dm0pKQorCQkJYXJncy0+dmFsdWUgPSByY3VfZGVyZWZlcmVuY2UoY3R4LT52bSkt
PnRvdGFsOwogCQllbHNlCiAJCQlhcmdzLT52YWx1ZSA9IHRvX2k5MTUoZGV2KS0+Z2d0dC52bS50
b3RhbDsKKwkJcmN1X3JlYWRfdW5sb2NrKCk7CiAJCWJyZWFrOwogCiAJY2FzZSBJOTE1X0NPTlRF
WFRfUEFSQU1fTk9fRVJST1JfQ0FQVFVSRToKQEAgLTIxNjEsNyArMjE0OCw3IEBAIGludCBpOTE1
X2dlbV9jb250ZXh0X3NldHBhcmFtX2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQg
KmRhdGEsCiBpbnQgaTkxNV9nZW1fY29udGV4dF9yZXNldF9zdGF0c19pb2N0bChzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LAogCQkJCSAgICAgICB2b2lkICpkYXRhLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZp
bGUpCiB7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gdG9faTkxNShkZXYp
OworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkZXYpOwogCXN0cnVj
dCBkcm1faTkxNV9yZXNldF9zdGF0cyAqYXJncyA9IGRhdGE7CiAJc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eDsKIAlpbnQgcmV0OwpAQCAtMjE4Myw3ICsyMTcwLDcgQEAgaW50IGk5MTVfZ2Vt
X2NvbnRleHRfcmVzZXRfc3RhdHNfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkgKi8K
IAogCWlmIChjYXBhYmxlKENBUF9TWVNfQURNSU4pKQotCQlhcmdzLT5yZXNldF9jb3VudCA9IGk5
MTVfcmVzZXRfY291bnQoJmRldl9wcml2LT5ncHVfZXJyb3IpOworCQlhcmdzLT5yZXNldF9jb3Vu
dCA9IGk5MTVfcmVzZXRfY291bnQoJmk5MTUtPmdwdV9lcnJvcik7CiAJZWxzZQogCQlhcmdzLT5y
ZXNldF9jb3VudCA9IDA7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9jb250ZXh0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29u
dGV4dC5oCmluZGV4IDUwYmMyN2QzMGMwMy4uOTIzNDU4NjgzMGQxIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKQEAgLTExLDcgKzExLDkgQEAKIAogI2lu
Y2x1ZGUgImd0L2ludGVsX2NvbnRleHQuaCIKIAorI2luY2x1ZGUgImk5MTVfZHJ2LmgiCiAjaW5j
bHVkZSAiaTkxNV9nZW0uaCIKKyNpbmNsdWRlICJpOTE1X2dlbV9ndHQuaCIKICNpbmNsdWRlICJp
OTE1X3NjaGVkdWxlci5oIgogI2luY2x1ZGUgImludGVsX2RldmljZV9pbmZvLmgiCiAKQEAgLTEx
OCw4ICsxMjAsOCBAQCBzdGF0aWMgaW5saW5lIGJvb2wgaTkxNV9nZW1fY29udGV4dF9pc19rZXJu
ZWwoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIH0KIAogLyogaTkxNV9nZW1fY29udGV4
dC5jICovCi1pbnQgX19tdXN0X2NoZWNrIGk5MTVfZ2VtX2NvbnRleHRzX2luaXQoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KTsKLXZvaWQgaTkxNV9nZW1fY29udGV4dHNfZmluaShz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOworaW50IF9fbXVzdF9jaGVjayBpOTE1
X2dlbV9pbml0X2NvbnRleHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KTsKK3ZvaWQg
aTkxNV9nZW1fZHJpdmVyX3JlbGVhc2VfX2NvbnRleHRzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICppOTE1KTsKIAogaW50IGk5MTVfZ2VtX2NvbnRleHRfb3BlbihzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSwKIAkJCSAgc3RydWN0IGRybV9maWxlICpmaWxlKTsKQEAgLTE1OCw2ICsxNjAs
MjcgQEAgc3RhdGljIGlubGluZSB2b2lkIGk5MTVfZ2VtX2NvbnRleHRfcHV0KHN0cnVjdCBpOTE1
X2dlbV9jb250ZXh0ICpjdHgpCiAJa3JlZl9wdXQoJmN0eC0+cmVmLCBpOTE1X2dlbV9jb250ZXh0
X3JlbGVhc2UpOwogfQogCitzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2Ug
KgoraTkxNV9nZW1fY29udGV4dF92bShzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4KQorewor
CXJldHVybiByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKGN0eC0+dm0sIGxvY2tkZXBfaXNfaGVs
ZCgmY3R4LT5tdXRleCkpOworfQorCitzdGF0aWMgaW5saW5lIHN0cnVjdCBpOTE1X2FkZHJlc3Nf
c3BhY2UgKgoraTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KHN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHgpCit7CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07CisKKwlyY3VfcmVh
ZF9sb2NrKCk7CisJdm0gPSByY3VfZGVyZWZlcmVuY2UoY3R4LT52bSk7CisJaWYgKCF2bSkKKwkJ
dm0gPSAmY3R4LT5pOTE1LT5nZ3R0LnZtOworCXZtID0gaTkxNV92bV9nZXQodm0pOworCXJjdV9y
ZWFkX3VubG9jaygpOworCisJcmV0dXJuIHZtOworfQorCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBp
OTE1X2dlbV9lbmdpbmVzICoKIGk5MTVfZ2VtX2NvbnRleHRfZW5naW5lcyhzdHJ1Y3QgaTkxNV9n
ZW1fY29udGV4dCAqY3R4KQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1
X2dlbV9jb250ZXh0X3R5cGVzLmgKaW5kZXggODdiZTI3ODc3ZTIyLi5hYjhlMTM2N2RmYzggMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5cGVz
LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMu
aApAQCAtODgsNyArODgsNyBAQCBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCB7CiAJICogSW4gb3Ro
ZXIgbW9kZXMsIHRoaXMgaXMgYSBOVUxMIHBvaW50ZXIgd2l0aCB0aGUgZXhwZWN0YXRpb24gdGhh
dAogCSAqIHRoZSBjYWxsZXIgdXNlcyB0aGUgc2hhcmVkIGdsb2JhbCBHVFQuCiAJICovCi0Jc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSBf
X3JjdSAqdm07CiAKIAkvKioKIAkgKiBAcGlkOiBwcm9jZXNzIGlkIG9mIGNyZWF0b3IKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMgYi9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCmluZGV4IDg4YTg4
MWJlMTJlYy4uOTg4MTZjMzVmZmMzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9leGVjYnVmZmVyLmMKQEAgLTcyOCw3ICs3MjgsNyBAQCBzdGF0aWMgaW50IGViX3Nl
bGVjdF9jb250ZXh0KHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViKQogCQlyZXR1cm4gLUVOT0VO
VDsKIAogCWViLT5nZW1fY29udGV4dCA9IGN0eDsKLQlpZiAoY3R4LT52bSkKKwlpZiAocmN1X2Fj
Y2Vzc19wb2ludGVyKGN0eC0+dm0pKQogCQllYi0+aW52YWxpZF9mbGFncyB8PSBFWEVDX09CSkVD
VF9ORUVEU19HVFQ7CiAKIAllYi0+Y29udGV4dF9mbGFncyA9IDA7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNlcnB0ci5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJwdHIuYwppbmRleCAxNzM4YTE1ZWI5MTEuLjRmOTcwNDc0
MDEzZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3VzZXJw
dHIuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdXNlcnB0ci5jCkBA
IC03NTgsNyArNzU4LDggQEAgaTkxNV9nZW1fdXNlcnB0cl9pb2N0bChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGV2LAogCQkgKiBPbiBhbG1vc3QgYWxsIG9mIHRoZSBvbGRlciBodywgd2UgY2Fubm90IHRl
bGwgdGhlIEdQVSB0aGF0CiAJCSAqIGEgcGFnZSBpcyByZWFkb25seS4KIAkJICovCi0JCXZtID0g
ZGV2X3ByaXYtPmtlcm5lbF9jb250ZXh0LT52bTsKKwkJdm0gPSByY3VfZGVyZWZlcmVuY2VfcHJv
dGVjdGVkKGRldl9wcml2LT5rZXJuZWxfY29udGV4dC0+dm0sCisJCQkJCSAgICAgICB0cnVlKTsg
Lyogc3RhdGljIHZtICovCiAJCWlmICghdm0gfHwgIXZtLT5oYXNfcmVhZF9vbmx5KQogCQkJcmV0
dXJuIC1FTk9ERVY7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3Nl
bGZ0ZXN0cy9odWdlX3BhZ2VzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3Rz
L2h1Z2VfcGFnZXMuYwppbmRleCA5OGIyYTZjY2ZjYzEuLjMzMTQ4NThmMzA0NiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9odWdlX3BhZ2VzLmMKQEAgLTEzMjIs
MTUgKzEzMjIsMTUgQEAgc3RhdGljIGludCBpZ3RfcHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcp
CiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCA9IGFyZzsKIAlzdHJ1Y3QgZHJtX2k5MTVf
cHJpdmF0ZSAqZGV2X3ByaXYgPSBjdHgtPmk5MTU7CiAJdW5zaWduZWQgbG9uZyBzdXBwb3J0ZWQg
PSBJTlRFTF9JTkZPKGRldl9wcml2KS0+cGFnZV9zaXplczsKLQlzdHJ1Y3QgaTkxNV9hZGRyZXNz
X3NwYWNlICp2bSA9IGN0eC0+dm07CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsK
IAlzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVyIGl0OworCXN0cnVjdCBpOTE1X2FkZHJlc3Nf
c3BhY2UgKnZtOwogCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKIAlzdHJ1Y3QgaTkxNV92bWEg
KnZtYTsKIAl1bnNpZ25lZCBpbnQgZmxhZ3MgPSBQSU5fVVNFUiB8IFBJTl9PRkZTRVRfRklYRUQ7
CiAJdW5zaWduZWQgaW50IG47CiAJaW50IGZpcnN0LCBsYXN0OwotCWludCBlcnI7CisJaW50IGVy
ciA9IDA7CiAKIAkvKgogCSAqIE1ha2Ugc3VyZSB0aGVyZSdzIG5vIGZ1bm55IGJ1c2luZXNzIHdo
ZW4gZG9pbmcgYSBQSU5fVVBEQVRFIC0tIGluIHRoZQpAQCAtMTM0MCw5ICsxMzQwLDEwIEBAIHN0
YXRpYyBpbnQgaWd0X3BwZ3R0X3Bpbl91cGRhdGUodm9pZCAqYXJnKQogCSAqIGh1Z2UtZ3R0LXBh
Z2VzLgogCSAqLwogCi0JaWYgKCF2bSB8fCAhaTkxNV92bV9pc180bHZsKHZtKSkgeworCXZtID0g
aTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KGN0eCk7CisJaWYgKCFpOTE1X3ZtX2lzXzRsdmwo
dm0pKSB7CiAJCXByX2luZm8oIjQ4YiBQUEdUVCBub3Qgc3VwcG9ydGVkLCBza2lwcGluZ1xuIik7
Ci0JCXJldHVybiAwOworCQlnb3RvIG91dF92bTsKIAl9CiAKIAlmaXJzdCA9IGlsb2cyKEk5MTVf
R1RUX1BBR0VfU0laRV82NEspOwpAQCAtMTQ1MSw2ICsxNDUyLDggQEAgc3RhdGljIGludCBpZ3Rf
cHBndHRfcGluX3VwZGF0ZSh2b2lkICphcmcpCiAJaTkxNV92bWFfY2xvc2Uodm1hKTsKIG91dF9w
dXQ6CiAJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworb3V0X3ZtOgorCWk5MTVfdm1fcHV0KHZt
KTsKIAogCXJldHVybiBlcnI7CiB9CkBAIC0xNDYwLDcgKzE0NjMsNyBAQCBzdGF0aWMgaW50IGln
dF90bXBmc19mYWxsYmFjayh2b2lkICphcmcpCiAJc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0
eCA9IGFyZzsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGN0eC0+aTkxNTsKIAlz
dHJ1Y3QgdmZzbW91bnQgKmdlbWZzID0gaTkxNS0+bW0uZ2VtZnM7Ci0Jc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqdm0gPSBjdHgtPnZtID86ICZpOTE1LT5nZ3R0LnZtOworCXN0cnVjdCBpOTE1
X2FkZHJlc3Nfc3BhY2UgKnZtID0gaTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KGN0eCk7CiAJ
c3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsK
IAl1MzIgKnZhZGRyOwpAQCAtMTUxMCw2ICsxNTEzLDcgQEAgc3RhdGljIGludCBpZ3RfdG1wZnNf
ZmFsbGJhY2sodm9pZCAqYXJnKQogb3V0X3Jlc3RvcmU6CiAJaTkxNS0+bW0uZ2VtZnMgPSBnZW1m
czsKIAorCWk5MTVfdm1fcHV0KHZtKTsKIAlyZXR1cm4gZXJyOwogfQogCkBAIC0xNTE3LDE0ICsx
NTIxLDE0IEBAIHN0YXRpYyBpbnQgaWd0X3Nocmlua190aHAodm9pZCAqYXJnKQogewogCXN0cnVj
dCBpOTE1X2dlbV9jb250ZXh0ICpjdHggPSBhcmc7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBjdHgtPmk5MTU7Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0gPSBjdHgt
PnZtID86ICZpOTE1LT5nZ3R0LnZtOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0g
aTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1KGN0eCk7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9v
YmplY3QgKm9iajsKIAlzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVyIGl0OwogCXN0cnVjdCBp
bnRlbF9jb250ZXh0ICpjZTsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAl1bnNpZ25lZCBpbnQg
ZmxhZ3MgPSBQSU5fVVNFUjsKIAl1bnNpZ25lZCBpbnQgbjsKLQlpbnQgZXJyOworCWludCBlcnIg
PSAwOwogCiAJLyoKIAkgKiBTYW5pdHkgY2hlY2sgc2hyaW5raW5nIGh1Z2UtcGFnZWQgb2JqZWN0
IC0tIG1ha2Ugc3VyZSBub3RoaW5nIGJsb3dzCkBAIC0xNTMzLDEyICsxNTM3LDE0IEBAIHN0YXRp
YyBpbnQgaWd0X3Nocmlua190aHAodm9pZCAqYXJnKQogCiAJaWYgKCFpZ3RfY2FuX2FsbG9jYXRl
X3RocChpOTE1KSkgewogCQlwcl9pbmZvKCJtaXNzaW5nIFRIUCBzdXBwb3J0LCBza2lwcGluZ1xu
Iik7Ci0JCXJldHVybiAwOworCQlnb3RvIG91dF92bTsKIAl9CiAKIAlvYmogPSBpOTE1X2dlbV9v
YmplY3RfY3JlYXRlX3NobWVtKGk5MTUsIFNaXzJNKTsKLQlpZiAoSVNfRVJSKG9iaikpCi0JCXJl
dHVybiBQVFJfRVJSKG9iaik7CisJaWYgKElTX0VSUihvYmopKSB7CisJCWVyciA9IFBUUl9FUlIo
b2JqKTsKKwkJZ290byBvdXRfdm07CisJfQogCiAJdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2Jq
LCB2bSwgTlVMTCk7CiAJaWYgKElTX0VSUih2bWEpKSB7CkBAIC0xNjA3LDYgKzE2MTMsOCBAQCBz
dGF0aWMgaW50IGlndF9zaHJpbmtfdGhwKHZvaWQgKmFyZykKIAlpOTE1X3ZtYV9jbG9zZSh2bWEp
Owogb3V0X3B1dDoKIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7CitvdXRfdm06CisJaTkxNV92
bV9wdXQodm0pOwogCiAJcmV0dXJuIGVycjsKIH0KQEAgLTE2NzUsNiArMTY4Myw3IEBAIGludCBp
OTE1X2dlbV9odWdlX3BhZ2VfbGl2ZV9zZWxmdGVzdHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUpCiAJfTsKIAlzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGU7CiAJc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eDsKKwlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKIAlpbnRlbF93YWtl
cmVmX3Qgd2FrZXJlZjsKIAlpbnQgZXJyOwogCkBAIC0xNjk5LDggKzE3MDgsMTEgQEAgaW50IGk5
MTVfZ2VtX2h1Z2VfcGFnZV9saXZlX3NlbGZ0ZXN0cyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSkKIAkJZ290byBvdXRfdW5sb2NrOwogCX0KIAotCWlmIChjdHgtPnZtKQotCQljdHgtPnZt
LT5zY3J1Yl82NEsgPSB0cnVlOworCW11dGV4X2xvY2soJmN0eC0+bXV0ZXgpOworCXZtID0gaTkx
NV9nZW1fY29udGV4dF92bShjdHgpOworCWlmICh2bSkKKwkJV1JJVEVfT05DRSh2bS0+c2NydWJf
NjRLLCB0cnVlKTsKKwltdXRleF91bmxvY2soJmN0eC0+bXV0ZXgpOwogCiAJZXJyID0gaTkxNV9z
dWJ0ZXN0cyh0ZXN0cywgY3R4KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9jb250ZXh0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX2NvbnRleHQuYwppbmRleCAyZmIzMWFkYTJmYTcuLjY5YTg2
ZmMxZTM5YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9p
OTE1X2dlbV9jb250ZXh0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0
cy9pOTE1X2dlbV9jb250ZXh0LmMKQEAgLTUzLDE5ICs1MywxNyBAQCBzdGF0aWMgaW50IGxpdmVf
bm9wX3N3aXRjaCh2b2lkICphcmcpCiAJaWYgKElTX0VSUihmaWxlKSkKIAkJcmV0dXJuIFBUUl9F
UlIoZmlsZSk7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWN0
eCA9IGtjYWxsb2MobmN0eCwgc2l6ZW9mKCpjdHgpLCBHRlBfS0VSTkVMKTsKIAlpZiAoIWN0eCkg
ewogCQllcnIgPSAtRU5PTUVNOwotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8gb3V0X2ZpbGU7
CiAJfQogCiAJZm9yIChuID0gMDsgbiA8IG5jdHg7IG4rKykgewogCQljdHhbbl0gPSBsaXZlX2Nv
bnRleHQoaTkxNSwgZmlsZSk7CiAJCWlmIChJU19FUlIoY3R4W25dKSkgewogCQkJZXJyID0gUFRS
X0VSUihjdHhbbl0pOwotCQkJZ290byBvdXRfdW5sb2NrOworCQkJZ290byBvdXRfZmlsZTsKIAkJ
fQogCX0KIApAQCAtNzksNyArNzcsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2b2lk
ICphcmcpCiAJCQlycSA9IGlndF9yZXF1ZXN0X2FsbG9jKGN0eFtuXSwgZW5naW5lKTsKIAkJCWlm
IChJU19FUlIocnEpKSB7CiAJCQkJZXJyID0gUFRSX0VSUihycSk7Ci0JCQkJZ290byBvdXRfdW5s
b2NrOworCQkJCWdvdG8gb3V0X2ZpbGU7CiAJCQl9CiAJCQlpOTE1X3JlcXVlc3RfYWRkKHJxKTsK
IAkJfQpAQCAtODcsNyArODUsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICph
cmcpCiAJCQlwcl9lcnIoIkZhaWxlZCB0byBwb3B1bGF0ZWQgJWQgY29udGV4dHNcbiIsIG5jdHgp
OwogCQkJaW50ZWxfZ3Rfc2V0X3dlZGdlZCgmaTkxNS0+Z3QpOwogCQkJZXJyID0gLUVJTzsKLQkJ
CWdvdG8gb3V0X3VubG9jazsKKwkJCWdvdG8gb3V0X2ZpbGU7CiAJCX0KIAogCQl0aW1lc1sxXSA9
IGt0aW1lX2dldF9yYXcoKTsKQEAgLTk3LDcgKzk1LDcgQEAgc3RhdGljIGludCBsaXZlX25vcF9z
d2l0Y2godm9pZCAqYXJnKQogCiAJCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGk5MTUs
IF9fZnVuY19fLCBlbmdpbmUtPm5hbWUpOwogCQlpZiAoZXJyKQotCQkJZ290byBvdXRfdW5sb2Nr
OworCQkJZ290byBvdXRfZmlsZTsKIAogCQllbmRfdGltZSA9IGppZmZpZXMgKyBpOTE1X3NlbGZ0
ZXN0LnRpbWVvdXRfamlmZmllczsKIAkJZm9yX2VhY2hfcHJpbWVfbnVtYmVyX2Zyb20ocHJpbWUs
IDIsIDgxOTIpIHsKQEAgLTEwNyw3ICsxMDUsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRj
aCh2b2lkICphcmcpCiAJCQkJcnEgPSBpZ3RfcmVxdWVzdF9hbGxvYyhjdHhbbiAlIG5jdHhdLCBl
bmdpbmUpOwogCQkJCWlmIChJU19FUlIocnEpKSB7CiAJCQkJCWVyciA9IFBUUl9FUlIocnEpOwot
CQkJCQlnb3RvIG91dF91bmxvY2s7CisJCQkJCWdvdG8gb3V0X2ZpbGU7CiAJCQkJfQogCiAJCQkJ
LyoKQEAgLTE0Myw3ICsxNDEsNyBAQCBzdGF0aWMgaW50IGxpdmVfbm9wX3N3aXRjaCh2b2lkICph
cmcpCiAKIAkJZXJyID0gaWd0X2xpdmVfdGVzdF9lbmQoJnQpOwogCQlpZiAoZXJyKQotCQkJZ290
byBvdXRfdW5sb2NrOworCQkJZ290byBvdXRfZmlsZTsKIAogCQlwcl9pbmZvKCJTd2l0Y2ggbGF0
ZW5jaWVzIG9uICVzOiAxID0gJWxsdW5zLCAlbHUgPSAlbGx1bnNcbiIsCiAJCQllbmdpbmUtPm5h
bWUsCkBAIC0xNTEsOCArMTQ5LDcgQEAgc3RhdGljIGludCBsaXZlX25vcF9zd2l0Y2godm9pZCAq
YXJnKQogCQkJcHJpbWUgLSAxLCBkaXY2NF91NjQoa3RpbWVfdG9fbnModGltZXNbMV0pLCBwcmlt
ZSAtIDEpKTsKIAl9CiAKLW91dF91bmxvY2s6Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKK291dF9maWxlOgogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwogCXJl
dHVybiBlcnI7CiB9CkBAIC0yNTMsMTIgKzI1MCwxMCBAQCBzdGF0aWMgaW50IGxpdmVfcGFyYWxs
ZWxfc3dpdGNoKHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VS
UihmaWxlKTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJY3R4
ID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIoY3R4KSkgewogCQllcnIg
PSBQVFJfRVJSKGN0eCk7Ci0JCWdvdG8gb3V0X2xvY2tlZDsKKwkJZ290byBvdXRfZmlsZTsKIAl9
CiAKIAllbmdpbmVzID0gaTkxNV9nZW1fY29udGV4dF9sb2NrX2VuZ2luZXMoY3R4KTsKQEAgLTI2
OCw3ICsyNjMsNyBAQCBzdGF0aWMgaW50IGxpdmVfcGFyYWxsZWxfc3dpdGNoKHZvaWQgKmFyZykK
IAlpZiAoIWRhdGEpIHsKIAkJaTkxNV9nZW1fY29udGV4dF91bmxvY2tfZW5naW5lcyhjdHgpOwog
CQllcnIgPSAtRU5PTUVNOwotCQlnb3RvIG91dF9sb2NrZWQ7CisJCWdvdG8gb3V0OwogCX0KIAog
CW0gPSAwOyAvKiBVc2UgdGhlIGZpcnN0IGNvbnRleHQgYXMgb3VyIHRlbXBsYXRlIGZvciB0aGUg
ZW5naW5lcyAqLwpAQCAtMjc2LDcgKzI3MSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9wYXJhbGxlbF9z
d2l0Y2godm9pZCAqYXJnKQogCQllcnIgPSBpbnRlbF9jb250ZXh0X3BpbihjZSk7CiAJCWlmIChl
cnIpIHsKIAkJCWk5MTVfZ2VtX2NvbnRleHRfdW5sb2NrX2VuZ2luZXMoY3R4KTsKLQkJCWdvdG8g
b3V0X2xvY2tlZDsKKwkJCWdvdG8gb3V0OwogCQl9CiAJCWRhdGFbbSsrXS5jZVswXSA9IGludGVs
X2NvbnRleHRfZ2V0KGNlKTsKIAl9CkBAIC0yODcsNyArMjgyLDcgQEAgc3RhdGljIGludCBsaXZl
X3BhcmFsbGVsX3N3aXRjaCh2b2lkICphcmcpCiAJCWN0eCA9IGxpdmVfY29udGV4dChpOTE1LCBm
aWxlKTsKIAkJaWYgKElTX0VSUihjdHgpKSB7CiAJCQllcnIgPSBQVFJfRVJSKGN0eCk7Ci0JCQln
b3RvIG91dF9sb2NrZWQ7CisJCQlnb3RvIG91dDsKIAkJfQogCiAJCWZvciAobSA9IDA7IG0gPCBj
b3VudDsgbSsrKSB7CkBAIC0yOTYsMjAgKzI5MSwxOCBAQCBzdGF0aWMgaW50IGxpdmVfcGFyYWxs
ZWxfc3dpdGNoKHZvaWQgKmFyZykKIAogCQkJY2UgPSBpbnRlbF9jb250ZXh0X2NyZWF0ZShjdHgs
IGRhdGFbbV0uY2VbMF0tPmVuZ2luZSk7CiAJCQlpZiAoSVNfRVJSKGNlKSkKLQkJCQlnb3RvIG91
dF9sb2NrZWQ7CisJCQkJZ290byBvdXQ7CiAKIAkJCWVyciA9IGludGVsX2NvbnRleHRfcGluKGNl
KTsKIAkJCWlmIChlcnIpIHsKIAkJCQlpbnRlbF9jb250ZXh0X3B1dChjZSk7Ci0JCQkJZ290byBv
dXRfbG9ja2VkOworCQkJCWdvdG8gb3V0OwogCQkJfQogCiAJCQlkYXRhW21dLmNlW25dID0gY2U7
CiAJCX0KIAl9CiAKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJ
Zm9yIChmbiA9IGZ1bmM7ICFlcnIgJiYgKmZuOyBmbisrKSB7CiAJCXN0cnVjdCBpZ3RfbGl2ZV90
ZXN0IHQ7CiAJCWludCBuOwpAQCAtMzU0LDggKzM0Nyw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9wYXJh
bGxlbF9zd2l0Y2godm9pZCAqYXJnKQogCQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3Rf
bXV0ZXgpOwogCX0KIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotb3V0
X2xvY2tlZDoKK291dDoKIAlmb3IgKG4gPSAwOyBuIDwgY291bnQ7IG4rKykgewogCQlmb3IgKG0g
PSAwOyBtIDwgQVJSQVlfU0laRShkYXRhLT5jZSk7IG0rKykgewogCQkJaWYgKCFkYXRhW25dLmNl
W21dKQpAQCAtMzY1LDggKzM1Nyw4IEBAIHN0YXRpYyBpbnQgbGl2ZV9wYXJhbGxlbF9zd2l0Y2go
dm9pZCAqYXJnKQogCQkJaW50ZWxfY29udGV4dF9wdXQoZGF0YVtuXS5jZVttXSk7CiAJCX0KIAl9
Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlrZnJlZShkYXRhKTsK
K291dF9maWxlOgogCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwogCXJldHVybiBlcnI7CiB9
CkBAIC02MjYsMTEgKzYxOCw5IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9leGVjKHZvaWQgKmFyZykK
IAkJaWYgKElTX0VSUihmaWxlKSkKIAkJCXJldHVybiBQVFJfRVJSKGZpbGUpOwogCi0JCW11dGV4
X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJCWVyciA9IGlndF9saXZlX3Rlc3Rf
YmVnaW4oJnQsIGk5MTUsIF9fZnVuY19fLCBlbmdpbmUtPm5hbWUpOwogCQlpZiAoZXJyKQotCQkJ
Z290byBvdXRfdW5sb2NrOworCQkJZ290byBvdXRfZmlsZTsKIAogCQluY29udGV4dHMgPSAwOwog
CQluZHdvcmRzID0gMDsKQEAgLTY0Miw3ICs2MzIsNyBAQCBzdGF0aWMgaW50IGlndF9jdHhfZXhl
Yyh2b2lkICphcmcpCiAJCQljdHggPSBrZXJuZWxfY29udGV4dChpOTE1KTsKIAkJCWlmIChJU19F
UlIoY3R4KSkgewogCQkJCWVyciA9IFBUUl9FUlIoY3R4KTsKLQkJCQlnb3RvIG91dF91bmxvY2s7
CisJCQkJZ290byBvdXRfZmlsZTsKIAkJCX0KIAogCQkJY2UgPSBpOTE1X2dlbV9jb250ZXh0X2dl
dF9lbmdpbmUoY3R4LCBlbmdpbmUtPmxlZ2FjeV9pZHgpOwpAQCAtNjU0LDcgKzY0NCw3IEBAIHN0
YXRpYyBpbnQgaWd0X2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCQkJZXJyID0gUFRSX0VSUihvYmop
OwogCQkJCQlpbnRlbF9jb250ZXh0X3B1dChjZSk7CiAJCQkJCWtlcm5lbF9jb250ZXh0X2Nsb3Nl
KGN0eCk7Ci0JCQkJCWdvdG8gb3V0X3VubG9jazsKKwkJCQkJZ290byBvdXRfZmlsZTsKIAkJCQl9
CiAJCQl9CiAKQEAgLTY2MywxNyArNjUzLDE4IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9leGVjKHZv
aWQgKmFyZykKIAkJCQlwcl9lcnIoIkZhaWxlZCB0byBmaWxsIGR3b3JkICVsdSBbJWx1LyVsdV0g
d2l0aCBncHUgKCVzKSBbZnVsbC1wcGd0dD8gJXNdLCBlcnI9JWRcbiIsCiAJCQkJICAgICAgIG5k
d29yZHMsIGR3LCBtYXhfZHdvcmRzKG9iaiksCiAJCQkJICAgICAgIGVuZ2luZS0+bmFtZSwKLQkJ
CQkgICAgICAgeWVzbm8oISFjdHgtPnZtKSwgZXJyKTsKKwkJCQkgICAgICAgeWVzbm8oISFyY3Vf
YWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpLAorCQkJCSAgICAgICBlcnIpOwogCQkJCWludGVsX2Nv
bnRleHRfcHV0KGNlKTsKIAkJCQlrZXJuZWxfY29udGV4dF9jbG9zZShjdHgpOwotCQkJCWdvdG8g
b3V0X3VubG9jazsKKwkJCQlnb3RvIG91dF9maWxlOwogCQkJfQogCiAJCQllcnIgPSB0aHJvdHRs
ZShjZSwgdHEsIEFSUkFZX1NJWkUodHEpKTsKIAkJCWlmIChlcnIpIHsKIAkJCQlpbnRlbF9jb250
ZXh0X3B1dChjZSk7CiAJCQkJa2VybmVsX2NvbnRleHRfY2xvc2UoY3R4KTsKLQkJCQlnb3RvIG91
dF91bmxvY2s7CisJCQkJZ290byBvdXRfZmlsZTsKIAkJCX0KIAogCQkJaWYgKCsrZHcgPT0gbWF4
X2R3b3JkcyhvYmopKSB7CkBAIC03MDMsMTEgKzY5NCwxMCBAQCBzdGF0aWMgaW50IGlndF9jdHhf
ZXhlYyh2b2lkICphcmcpCiAJCQlkdyArPSByZW07CiAJCX0KIAotb3V0X3VubG9jazoKK291dF9m
aWxlOgogCQl0aHJvdHRsZV9yZWxlYXNlKHRxLCBBUlJBWV9TSVpFKHRxKSk7CiAJCWlmIChpZ3Rf
bGl2ZV90ZXN0X2VuZCgmdCkpCiAJCQllcnIgPSAtRUlPOwotCQltdXRleF91bmxvY2soJmk5MTUt
PmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJCW1vY2tfZmlsZV9mcmVlKGk5MTUsIGZpbGUpOwogCQlp
ZiAoZXJyKQpAQCAtNzQyLDIyICs3MzIsMjAgQEAgc3RhdGljIGludCBpZ3Rfc2hhcmVkX2N0eF9l
eGVjKHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VSUihmaWxl
KTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJcGFyZW50ID0g
bGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIocGFyZW50KSkgewogCQllcnIg
PSBQVFJfRVJSKHBhcmVudCk7Ci0JCWdvdG8gb3V0X3VubG9jazsKKwkJZ290byBvdXRfZmlsZTsK
IAl9CiAKIAlpZiAoIXBhcmVudC0+dm0pIHsgLyogbm90IGZ1bGwtcHBndHQ7IG5vdGhpbmcgdG8g
c2hhcmUgKi8KIAkJZXJyID0gMDsKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3RvIG91dF9maWxl
OwogCX0KIAogCWVyciA9IGlndF9saXZlX3Rlc3RfYmVnaW4oJnQsIGk5MTUsIF9fZnVuY19fLCAi
Iik7CiAJaWYgKGVycikKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3RvIG91dF9maWxlOwogCiAJ
Zm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgaTkxNSwgaWQpIHsKIAkJdW5zaWduZWQgbG9uZyBuY29u
dGV4dHMsIG5kd29yZHMsIGR3OwpAQCAtODAxLDcgKzc4OSw4IEBAIHN0YXRpYyBpbnQgaWd0X3No
YXJlZF9jdHhfZXhlYyh2b2lkICphcmcpCiAJCQkJcHJfZXJyKCJGYWlsZWQgdG8gZmlsbCBkd29y
ZCAlbHUgWyVsdS8lbHVdIHdpdGggZ3B1ICglcykgW2Z1bGwtcHBndHQ/ICVzXSwgZXJyPSVkXG4i
LAogCQkJCSAgICAgICBuZHdvcmRzLCBkdywgbWF4X2R3b3JkcyhvYmopLAogCQkJCSAgICAgICBl
bmdpbmUtPm5hbWUsCi0JCQkJICAgICAgIHllc25vKCEhY3R4LT52bSksIGVycik7CisJCQkJICAg
ICAgIHllc25vKCEhcmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0pKSwKKwkJCQkgICAgICAgZXJy
KTsKIAkJCQlpbnRlbF9jb250ZXh0X3B1dChjZSk7CiAJCQkJa2VybmVsX2NvbnRleHRfY2xvc2Uo
Y3R4KTsKIAkJCQlnb3RvIG91dF90ZXN0OwpAQCAtODQwLDE3ICs4MjksMTMgQEAgc3RhdGljIGlu
dCBpZ3Rfc2hhcmVkX2N0eF9leGVjKHZvaWQgKmFyZykKIAkJCWR3ICs9IHJlbTsKIAkJfQogCi0J
CW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJCWk5MTVfZ2VtX2RyYWlu
X2ZyZWVkX29iamVjdHMoaTkxNSk7Ci0JCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwogCX0KIG91dF90ZXN0OgogCXRocm90dGxlX3JlbGVhc2UodHEsIEFSUkFZX1NJWkUodHEp
KTsKIAlpZiAoaWd0X2xpdmVfdGVzdF9lbmQoJnQpKQogCQllcnIgPSAtRUlPOwotb3V0X3VubG9j
azoKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCitvdXRfZmlsZToK
IAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAlyZXR1cm4gZXJyOwogfQpAQCAtMTIyMiw4
ICsxMjA3LDYgQEAgX19pZ3RfY3R4X3NzZXUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUs
CiAJaWYgKGZsYWdzICYgVEVTVF9SRVNFVCkKIAkJaWd0X2dsb2JhbF9yZXNldF9sb2NrKCZpOTE1
LT5ndCk7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWN0eCA9
IGxpdmVfY29udGV4dChpOTE1LCBmaWxlKTsKIAlpZiAoSVNfRVJSKGN0eCkpIHsKIAkJcmV0ID0g
UFRSX0VSUihjdHgpOwpAQCAtMTI3OCw4ICsxMjYxLDYgQEAgX19pZ3RfY3R4X3NzZXUoc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOwogCiBv
dXRfdW5sb2NrOgotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0KIAlp
ZiAoZmxhZ3MgJiBURVNUX1JFU0VUKQogCQlpZ3RfZ2xvYmFsX3Jlc2V0X3VubG9jaygmaTkxNS0+
Z3QpOwogCkBAIC0xMzM5LDIzICsxMzIwLDI0IEBAIHN0YXRpYyBpbnQgaWd0X2N0eF9yZWFkb25s
eSh2b2lkICphcmcpCiAJaWYgKElTX0VSUihmaWxlKSkKIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7
CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKLQogCWVyciA9IGlndF9s
aXZlX3Rlc3RfYmVnaW4oJnQsIGk5MTUsIF9fZnVuY19fLCAiIik7CiAJaWYgKGVycikKLQkJZ290
byBvdXRfdW5sb2NrOworCQlnb3RvIG91dF9maWxlOwogCiAJY3R4ID0gbGl2ZV9jb250ZXh0KGk5
MTUsIGZpbGUpOwogCWlmIChJU19FUlIoY3R4KSkgewogCQllcnIgPSBQVFJfRVJSKGN0eCk7Ci0J
CWdvdG8gb3V0X3VubG9jazsKKwkJZ290byBvdXRfZmlsZTsKIAl9CiAKLQl2bSA9IGN0eC0+dm0g
PzogJmk5MTUtPmdndHQuYWxpYXMtPnZtOworCXJjdV9yZWFkX2xvY2soKTsKKwl2bSA9IHJjdV9k
ZXJlZmVyZW5jZShjdHgtPnZtKSA/OiAmaTkxNS0+Z2d0dC5hbGlhcy0+dm07CiAJaWYgKCF2bSB8
fCAhdm0tPmhhc19yZWFkX29ubHkpIHsKKwkJcmN1X3JlYWRfdW5sb2NrKCk7CiAJCWVyciA9IDA7
Ci0JCWdvdG8gb3V0X3VubG9jazsKKwkJZ290byBvdXRfZmlsZTsKIAl9CisJcmN1X3JlYWRfdW5s
b2NrKCk7CiAKIAluZHdvcmRzID0gMDsKIAlkdyA9IDA7CkBAIC0xMzczLDcgKzEzNTUsNyBAQCBz
dGF0aWMgaW50IGlndF9jdHhfcmVhZG9ubHkodm9pZCAqYXJnKQogCQkJCWlmIChJU19FUlIob2Jq
KSkgewogCQkJCQllcnIgPSBQVFJfRVJSKG9iaik7CiAJCQkJCWk5MTVfZ2VtX2NvbnRleHRfdW5s
b2NrX2VuZ2luZXMoY3R4KTsKLQkJCQkJZ290byBvdXRfdW5sb2NrOworCQkJCQlnb3RvIG91dF9m
aWxlOwogCQkJCX0KIAogCQkJCWlmIChwcmFuZG9tX3UzMl9zdGF0ZSgmcHJuZykgJiAxKQpAQCAt
MTM4NCwxNSArMTM2NiwxNyBAQCBzdGF0aWMgaW50IGlndF9jdHhfcmVhZG9ubHkodm9pZCAqYXJn
KQogCQkJaWYgKGVycikgewogCQkJCXByX2VycigiRmFpbGVkIHRvIGZpbGwgZHdvcmQgJWx1IFsl
bHUvJWx1XSB3aXRoIGdwdSAoJXMpIFtmdWxsLXBwZ3R0PyAlc10sIGVycj0lZFxuIiwKIAkJCQkg
ICAgICAgbmR3b3JkcywgZHcsIG1heF9kd29yZHMob2JqKSwKLQkJCQkgICAgICAgY2UtPmVuZ2lu
ZS0+bmFtZSwgeWVzbm8oISFjdHgtPnZtKSwgZXJyKTsKKwkJCQkgICAgICAgY2UtPmVuZ2luZS0+
bmFtZSwKKwkJCQkgICAgICAgeWVzbm8oISFyY3VfYWNjZXNzX3BvaW50ZXIoY3R4LT52bSkpLAor
CQkJCSAgICAgICBlcnIpOwogCQkJCWk5MTVfZ2VtX2NvbnRleHRfdW5sb2NrX2VuZ2luZXMoY3R4
KTsKLQkJCQlnb3RvIG91dF91bmxvY2s7CisJCQkJZ290byBvdXRfZmlsZTsKIAkJCX0KIAogCQkJ
ZXJyID0gdGhyb3R0bGUoY2UsIHRxLCBBUlJBWV9TSVpFKHRxKSk7CiAJCQlpZiAoZXJyKSB7CiAJ
CQkJaTkxNV9nZW1fY29udGV4dF91bmxvY2tfZW5naW5lcyhjdHgpOwotCQkJCWdvdG8gb3V0X3Vu
bG9jazsKKwkJCQlnb3RvIG91dF9maWxlOwogCQkJfQogCiAJCQlpZiAoKytkdyA9PSBtYXhfZHdv
cmRzKG9iaikpIHsKQEAgLTE0MjQsMjAgKzE0MDgsMTkgQEAgc3RhdGljIGludCBpZ3RfY3R4X3Jl
YWRvbmx5KHZvaWQgKmFyZykKIAkJZHcgKz0gcmVtOwogCX0KIAotb3V0X3VubG9jazoKK291dF9m
aWxlOgogCXRocm90dGxlX3JlbGVhc2UodHEsIEFSUkFZX1NJWkUodHEpKTsKIAlpZiAoaWd0X2xp
dmVfdGVzdF9lbmQoJnQpKQogCQllcnIgPSAtRUlPOwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJt
LnN0cnVjdF9tdXRleCk7CiAKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAlyZXR1cm4g
ZXJyOwogfQogCi1zdGF0aWMgaW50IGNoZWNrX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2VtX2NvbnRl
eHQgKmN0eCwgdTY0IG9mZnNldCkKK3N0YXRpYyBpbnQgY2hlY2tfc2NyYXRjaChzdHJ1Y3QgaTkx
NV9hZGRyZXNzX3NwYWNlICp2bSwgdTY0IG9mZnNldCkKIHsKIAlzdHJ1Y3QgZHJtX21tX25vZGUg
Km5vZGUgPQotCQlfX2RybV9tbV9pbnRlcnZhbF9maXJzdCgmY3R4LT52bS0+bW0sCisJCV9fZHJt
X21tX2ludGVydmFsX2ZpcnN0KCZ2bS0+bW0sCiAJCQkJCW9mZnNldCwgb2Zmc2V0ICsgc2l6ZW9m
KHUzMikgLSAxKTsKIAlpZiAoIW5vZGUgfHwgbm9kZS0+c3RhcnQgPiBvZmZzZXQpCiAJCXJldHVy
biAwOwpAQCAtMTQ1NSw2ICsxNDM4LDcgQEAgc3RhdGljIGludCB3cml0ZV90b19zY3JhdGNoKHN0
cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsCiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUg
Kmk5MTUgPSBjdHgtPmk5MTU7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsKKwlz
dHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKIAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycTsK
IAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAl1MzIgKmNtZDsKQEAgLTE0ODcsMTcgKzE0NzEsMTgg
QEAgc3RhdGljIGludCB3cml0ZV90b19zY3JhdGNoKHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpj
dHgsCiAKIAlpbnRlbF9ndF9jaGlwc2V0X2ZsdXNoKGVuZ2luZS0+Z3QpOwogCi0Jdm1hID0gaTkx
NV92bWFfaW5zdGFuY2Uob2JqLCBjdHgtPnZtLCBOVUxMKTsKKwl2bSA9IGk5MTVfZ2VtX2NvbnRl
eHRfZ2V0X3ZtX3JjdShjdHgpOworCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9iaiwgdm0sIE5V
TEwpOwogCWlmIChJU19FUlIodm1hKSkgewogCQllcnIgPSBQVFJfRVJSKHZtYSk7Ci0JCWdvdG8g
ZXJyOworCQlnb3RvIGVycl92bTsKIAl9CiAKIAllcnIgPSBpOTE1X3ZtYV9waW4odm1hLCAwLCAw
LCBQSU5fVVNFUiB8IFBJTl9PRkZTRVRfRklYRUQpOwogCWlmIChlcnIpCi0JCWdvdG8gZXJyOwor
CQlnb3RvIGVycl92bTsKIAotCWVyciA9IGNoZWNrX3NjcmF0Y2goY3R4LCBvZmZzZXQpOworCWVy
ciA9IGNoZWNrX3NjcmF0Y2godm0sIG9mZnNldCk7CiAJaWYgKGVycikKIAkJZ290byBlcnJfdW5w
aW47CiAKQEAgLTE1MjMsNiArMTUwOCw3IEBAIHN0YXRpYyBpbnQgd3JpdGVfdG9fc2NyYXRjaChz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCiAJaTkxNV9yZXF1ZXN0X2FkZChycSk7CiAK
KwlpOTE1X3ZtX3B1dCh2bSk7CiAJcmV0dXJuIDA7CiAKIHNraXBfcmVxdWVzdDoKQEAgLTE1MzEs
NiArMTUxNyw4IEBAIHN0YXRpYyBpbnQgd3JpdGVfdG9fc2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1f
Y29udGV4dCAqY3R4LAogCWk5MTVfcmVxdWVzdF9hZGQocnEpOwogZXJyX3VucGluOgogCWk5MTVf
dm1hX3VucGluKHZtYSk7CitlcnJfdm06CisJaTkxNV92bV9wdXQodm0pOwogZXJyOgogCWk5MTVf
Z2VtX29iamVjdF9wdXQob2JqKTsKIAlyZXR1cm4gZXJyOwpAQCAtMTU0Miw2ICsxNTMwLDcgQEAg
c3RhdGljIGludCByZWFkX2Zyb21fc2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4
LAogewogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gY3R4LT5pOTE1OwogCXN0cnVj
dCBkcm1faTkxNV9nZW1fb2JqZWN0ICpvYmo7CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAq
dm07CiAJY29uc3QgdTMyIFJDU19HUFIwID0gMHgyNjAwOyAvKiBub3QgYWxsIGVuZ2luZXMgaGF2
ZSB0aGVpciBvd24gR1BSISAqLwogCWNvbnN0IHUzMiByZXN1bHQgPSAweDEwMDsKIAlzdHJ1Y3Qg
aTkxNV9yZXF1ZXN0ICpycTsKQEAgLTE1ODYsMTcgKzE1NzUsMTggQEAgc3RhdGljIGludCByZWFk
X2Zyb21fc2NyYXRjaChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCiAJaW50ZWxfZ3Rf
Y2hpcHNldF9mbHVzaChlbmdpbmUtPmd0KTsKIAotCXZtYSA9IGk5MTVfdm1hX2luc3RhbmNlKG9i
aiwgY3R4LT52bSwgTlVMTCk7CisJdm0gPSBpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4
KTsKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIHZtLCBOVUxMKTsKIAlpZiAoSVNfRVJS
KHZtYSkpIHsKIAkJZXJyID0gUFRSX0VSUih2bWEpOwotCQlnb3RvIGVycjsKKwkJZ290byBlcnJf
dm07CiAJfQogCiAJZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwgMCwgUElOX1VTRVIgfCBQSU5f
T0ZGU0VUX0ZJWEVEKTsKIAlpZiAoZXJyKQotCQlnb3RvIGVycjsKKwkJZ290byBlcnJfdm07CiAK
LQllcnIgPSBjaGVja19zY3JhdGNoKGN0eCwgb2Zmc2V0KTsKKwllcnIgPSBjaGVja19zY3JhdGNo
KHZtLCBvZmZzZXQpOwogCWlmIChlcnIpCiAJCWdvdG8gZXJyX3VucGluOwogCkBAIC0xNjI3LDEy
ICsxNjE3LDEyIEBAIHN0YXRpYyBpbnQgcmVhZF9mcm9tX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKmN0eCwKIAllcnIgPSBpOTE1X2dlbV9vYmplY3Rfc2V0X3RvX2NwdV9kb21haW4o
b2JqLCBmYWxzZSk7CiAJaTkxNV9nZW1fb2JqZWN0X3VubG9jayhvYmopOwogCWlmIChlcnIpCi0J
CWdvdG8gZXJyOworCQlnb3RvIGVycl92bTsKIAogCWNtZCA9IGk5MTVfZ2VtX29iamVjdF9waW5f
bWFwKG9iaiwgSTkxNV9NQVBfV0IpOwogCWlmIChJU19FUlIoY21kKSkgewogCQllcnIgPSBQVFJf
RVJSKGNtZCk7Ci0JCWdvdG8gZXJyOworCQlnb3RvIGVycl92bTsKIAl9CiAKIAkqdmFsdWUgPSBj
bWRbcmVzdWx0IC8gc2l6ZW9mKCpjbWQpXTsKQEAgLTE2NDcsNiArMTYzNyw4IEBAIHN0YXRpYyBp
bnQgcmVhZF9mcm9tX3NjcmF0Y2goc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAlpOTE1
X3JlcXVlc3RfYWRkKHJxKTsKIGVycl91bnBpbjoKIAlpOTE1X3ZtYV91bnBpbih2bWEpOworZXJy
X3ZtOgorCWk5MTVfdm1fcHV0KHZtKTsKIGVycjoKIAlpOTE1X2dlbV9vYmplY3RfcHV0KG9iaik7
CiAJcmV0dXJuIGVycjsKQEAgLTE2NzcsMjcgKzE2NjksMjUgQEAgc3RhdGljIGludCBpZ3Rfdm1f
aXNvbGF0aW9uKHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VS
UihmaWxlKTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJZXJy
ID0gaWd0X2xpdmVfdGVzdF9iZWdpbigmdCwgaTkxNSwgX19mdW5jX18sICIiKTsKIAlpZiAoZXJy
KQotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8gb3V0X2ZpbGU7CiAKIAljdHhfYSA9IGxpdmVf
Y29udGV4dChpOTE1LCBmaWxlKTsKIAlpZiAoSVNfRVJSKGN0eF9hKSkgewogCQllcnIgPSBQVFJf
RVJSKGN0eF9hKTsKLQkJZ290byBvdXRfdW5sb2NrOworCQlnb3RvIG91dF9maWxlOwogCX0KIAog
CWN0eF9iID0gbGl2ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmIChJU19FUlIoY3R4X2IpKSB7
CiAJCWVyciA9IFBUUl9FUlIoY3R4X2IpOwotCQlnb3RvIG91dF91bmxvY2s7CisJCWdvdG8gb3V0
X2ZpbGU7CiAJfQogCiAJLyogV2UgY2FuIG9ubHkgdGVzdCB2bSBpc29sYXRpb24sIGlmIHRoZSB2
bSBhcmUgZGlzdGluY3QgKi8KIAlpZiAoY3R4X2EtPnZtID09IGN0eF9iLT52bSkKLQkJZ290byBv
dXRfdW5sb2NrOworCQlnb3RvIG91dF9maWxlOwogCiAJdm1fdG90YWwgPSBjdHhfYS0+dm0tPnRv
dGFsOwogCUdFTV9CVUdfT04oY3R4X2ItPnZtLT50b3RhbCAhPSB2bV90b3RhbCk7CkBAIC0xNzI2
LDcgKzE3MTYsNyBAQCBzdGF0aWMgaW50IGlndF92bV9pc29sYXRpb24odm9pZCAqYXJnKQogCQkJ
CWVyciA9IHJlYWRfZnJvbV9zY3JhdGNoKGN0eF9iLCBlbmdpbmUsCiAJCQkJCQkJb2Zmc2V0LCAm
dmFsdWUpOwogCQkJaWYgKGVycikKLQkJCQlnb3RvIG91dF91bmxvY2s7CisJCQkJZ290byBvdXRf
ZmlsZTsKIAogCQkJaWYgKHZhbHVlKSB7CiAJCQkJcHJfZXJyKCIlczogUmVhZCAlMDh4IGZyb20g
c2NyYXRjaCAob2Zmc2V0IDB4JTA4eF8lMDh4KSwgYWZ0ZXIgJWx1IHJlYWRzIVxuIiwKQEAgLTE3
MzUsNyArMTcyNSw3IEBAIHN0YXRpYyBpbnQgaWd0X3ZtX2lzb2xhdGlvbih2b2lkICphcmcpCiAJ
CQkJICAgICAgIGxvd2VyXzMyX2JpdHMob2Zmc2V0KSwKIAkJCQkgICAgICAgdGhpcyk7CiAJCQkJ
ZXJyID0gLUVJTlZBTDsKLQkJCQlnb3RvIG91dF91bmxvY2s7CisJCQkJZ290byBvdXRfZmlsZTsK
IAkJCX0KIAogCQkJdGhpcysrOwpAQCAtMTc0NSwxMSArMTczNSw5IEBAIHN0YXRpYyBpbnQgaWd0
X3ZtX2lzb2xhdGlvbih2b2lkICphcmcpCiAJcHJfaW5mbygiQ2hlY2tlZCAlbHUgc2NyYXRjaCBv
ZmZzZXRzIGFjcm9zcyAlZCBlbmdpbmVzXG4iLAogCQljb3VudCwgUlVOVElNRV9JTkZPKGk5MTUp
LT5udW1fZW5naW5lcyk7CiAKLW91dF91bmxvY2s6CitvdXRfZmlsZToKIAlpZiAoaWd0X2xpdmVf
dGVzdF9lbmQoJnQpKQogCQllcnIgPSAtRUlPOwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7Ci0KIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAlyZXR1cm4gZXJy
OwogfQpAQCAtMTc4MSwxMyArMTc2OSw5IEBAIHN0YXRpYyBpbnQgbW9ja19jb250ZXh0X2JhcnJp
ZXIodm9pZCAqYXJnKQogCSAqIGEgcmVxdWVzdDsgdXNlZnVsIGZvciByZXRpcmluZyBvbGQgc3Rh
dGUgYWZ0ZXIgbG9hZGluZyBuZXcuCiAJICovCiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3Ry
dWN0X211dGV4KTsKLQogCWN0eCA9IG1vY2tfY29udGV4dChpOTE1LCAibW9jayIpOwotCWlmICgh
Y3R4KSB7Ci0JCWVyciA9IC1FTk9NRU07Ci0JCWdvdG8gdW5sb2NrOwotCX0KKwlpZiAoIWN0eCkK
KwkJcmV0dXJuIC1FTk9NRU07CiAKIAljb3VudGVyID0gMDsKIAllcnIgPSBjb250ZXh0X2JhcnJp
ZXJfdGFzayhjdHgsIDAsCkBAIC0xODYwLDggKzE4NDQsNiBAQCBzdGF0aWMgaW50IG1vY2tfY29u
dGV4dF9iYXJyaWVyKHZvaWQgKmFyZykKIAogb3V0OgogCW1vY2tfY29udGV4dF9jbG9zZShjdHgp
OwotdW5sb2NrOgotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJcmV0
dXJuIGVycjsKICN1bmRlZiBwcl9mbXQKICNkZWZpbmUgcHJfZm10KHgpIHgKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmMgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5jCmluZGV4IDAxMDRm
MTZiMTMyNy4uZmQ3OTlkZWZkOGJlIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
ZW0vc2VsZnRlc3RzL21vY2tfY29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9zZWxmdGVzdHMvbW9ja19jb250ZXh0LmMKQEAgLTY1LDcgKzY1LDcgQEAgdm9pZCBtb2NrX2Nv
bnRleHRfY2xvc2Uoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAogdm9pZCBtb2NrX2lu
aXRfY29udGV4dHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUpCiB7Ci0JaW5pdF9jb250
ZXh0cyhpOTE1KTsKKwlpbml0X2NvbnRleHRzKCZpOTE1LT5nZW0uY29udGV4dHMpOwogfQogCiBz
dHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqCkBAIC03NCw4ICs3NCw2IEBAIGxpdmVfY29udGV4dChz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IGRybV9maWxlICpmaWxlKQogCXN0
cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CiAJaW50IGVycjsKIAotCWxvY2tkZXBfYXNzZXJ0
X2hlbGQoJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJY3R4ID0gaTkxNV9nZW1fY3JlYXRl
X2NvbnRleHQoaTkxNSwgMCk7CiAJaWYgKElTX0VSUihjdHgpKQogCQlyZXR1cm4gY3R4OwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jCmluZGV4IDM1YTQwYzI4MjBhMi4uYmUz
NGQ5N2FjMThmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9jb250
ZXh0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3QvaW50ZWxfY29udGV4dC5jCkBAIC0y
MjEsMTIgKzIyMSwyMCBAQCBpbnRlbF9jb250ZXh0X2luaXQoc3RydWN0IGludGVsX2NvbnRleHQg
KmNlLAogCQkgICBzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4LAogCQkgICBzdHJ1Y3QgaW50
ZWxfZW5naW5lX2NzICplbmdpbmUpCiB7CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07
CisKIAlHRU1fQlVHX09OKCFlbmdpbmUtPmNvcHMpOwogCiAJa3JlZl9pbml0KCZjZS0+cmVmKTsK
IAogCWNlLT5nZW1fY29udGV4dCA9IGN0eDsKLQljZS0+dm0gPSBpOTE1X3ZtX2dldChjdHgtPnZt
ID86ICZlbmdpbmUtPmd0LT5nZ3R0LT52bSk7CisJcmN1X3JlYWRfbG9jaygpOworCXZtID0gcmN1
X2RlcmVmZXJlbmNlKGN0eC0+dm0pOworCWlmICh2bSkKKwkJY2UtPnZtID0gaTkxNV92bV9nZXQo
dm0pOworCWVsc2UKKwkJY2UtPnZtID0gaTkxNV92bV9nZXQoJmVuZ2luZS0+Z3QtPmdndHQtPnZt
KTsKKwlyY3VfcmVhZF91bmxvY2soKTsKIAlpZiAoY3R4LT50aW1lbGluZSkKIAkJY2UtPnRpbWVs
aW5lID0gaW50ZWxfdGltZWxpbmVfZ2V0KGN0eC0+dGltZWxpbmUpOwogCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2d0L2ludGVsX2xyYy5jCmluZGV4IGZjOGM5M2RmNDIzNi4uZDYyNTMwMzg4OGNiIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYwpAQCAtOTgxLDYgKzk4MSwxMSBAQCBfX2V4ZWNsaXN0
c19zY2hlZHVsZV9pbihzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSkKIAkJY2UtPmxyY19kZXNjIHw9
CiAJCQkodTY0KShlbmdpbmUtPmNvbnRleHRfdGFnKysgJSBOVU1fQ09OVEVYVF9UQUcpIDw8CiAJ
CQlHRU4xMV9TV19DVFhfSURfU0hJRlQ7CisKKyNkZWZpbmUgR0VOMTFfTUFYX0NPTlRFWFRfSFdf
SUQgKDE8PDExKSAvKiBleGNsdXNpdmUgKi8KKy8qIGluIEdlbjEyIElEIDB4N0ZGIGlzIHJlc2Vy
dmVkIHRvIGluZGljYXRlIGlkbGUgKi8KKyNkZWZpbmUgR0VOMTJfTUFYX0NPTlRFWFRfSFdfSUQg
ICAgICAgIChHRU4xMV9NQVhfQ09OVEVYVF9IV19JRCAtIDEpCisKIAkJQlVJTERfQlVHX09OKE5V
TV9DT05URVhUX1RBRyA+IEdFTjEyX01BWF9DT05URVhUX0hXX0lEKTsKIAl9CiAKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQuYwppbmRleCA4NmNmZmJiMGE5Y2IuLjdj
ODM4YTU3ZTE3NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qvc2VsZnRlc3Rf
Y29udGV4dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X2NvbnRleHQu
YwpAQCAtMTU1LDEzICsxNTUsOSBAQCBzdGF0aWMgaW50IGxpdmVfY29udGV4dF9zaXplKHZvaWQg
KmFyZykKIAkgKiBIVyB0cmllcyB0byB3cml0ZSBwYXN0IHRoZSBlbmQgb2Ygb25lLgogCSAqLwog
Ci0JbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJZml4bWUgPSBr
ZXJuZWxfY29udGV4dChndC0+aTkxNSk7Ci0JaWYgKElTX0VSUihmaXhtZSkpIHsKLQkJZXJyID0g
UFRSX0VSUihmaXhtZSk7Ci0JCWdvdG8gdW5sb2NrOwotCX0KKwlpZiAoSVNfRVJSKGZpeG1lKSkK
KwkJcmV0dXJuIFBUUl9FUlIoZml4bWUpOwogCiAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwgZ3Qt
Pmk5MTUsIGlkKSB7CiAJCXN0cnVjdCB7CkBAIC0yMDEsOCArMTk3LDYgQEAgc3RhdGljIGludCBs
aXZlX2NvbnRleHRfc2l6ZSh2b2lkICphcmcpCiAJfQogCiAJa2VybmVsX2NvbnRleHRfY2xvc2Uo
Zml4bWUpOwotdW5sb2NrOgotCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwogCXJldHVybiBlcnI7CiB9CiAKQEAgLTMwNSwxMiArMjk5LDEwIEBAIHN0YXRpYyBpbnQg
bGl2ZV9hY3RpdmVfY29udGV4dCh2b2lkICphcmcpCiAJaWYgKElTX0VSUihmaWxlKSkKIAkJcmV0
dXJuIFBUUl9FUlIoZmlsZSk7CiAKLQltdXRleF9sb2NrKCZndC0+aTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Ci0KIAlmaXhtZSA9IGxpdmVfY29udGV4dChndC0+aTkxNSwgZmlsZSk7CiAJaWYgKElT
X0VSUihmaXhtZSkpIHsKIAkJZXJyID0gUFRSX0VSUihmaXhtZSk7Ci0JCWdvdG8gdW5sb2NrOwor
CQlnb3RvIG91dF9maWxlOwogCX0KIAogCWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGd0LT5pOTE1
LCBpZCkgewpAQCAtMzIzLDggKzMxNSw3IEBAIHN0YXRpYyBpbnQgbGl2ZV9hY3RpdmVfY29udGV4
dCh2b2lkICphcmcpCiAJCQlicmVhazsKIAl9CiAKLXVubG9jazoKLQltdXRleF91bmxvY2soJmd0
LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKK291dF9maWxlOgogCW1vY2tfZmlsZV9mcmVlKGd0
LT5pOTE1LCBmaWxlKTsKIAlyZXR1cm4gZXJyOwogfQpAQCAtNDE4LDEyICs0MDksMTAgQEAgc3Rh
dGljIGludCBsaXZlX3JlbW90ZV9jb250ZXh0KHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUp
KQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0u
c3RydWN0X211dGV4KTsKLQogCWZpeG1lID0gbGl2ZV9jb250ZXh0KGd0LT5pOTE1LCBmaWxlKTsK
IAlpZiAoSVNfRVJSKGZpeG1lKSkgewogCQllcnIgPSBQVFJfRVJSKGZpeG1lKTsKLQkJZ290byB1
bmxvY2s7CisJCWdvdG8gb3V0X2ZpbGU7CiAJfQogCiAJZm9yX2VhY2hfZW5naW5lKGVuZ2luZSwg
Z3QtPmk5MTUsIGlkKSB7CkBAIC00MzYsOCArNDI1LDcgQEAgc3RhdGljIGludCBsaXZlX3JlbW90
ZV9jb250ZXh0KHZvaWQgKmFyZykKIAkJCWJyZWFrOwogCX0KIAotdW5sb2NrOgotCW11dGV4X3Vu
bG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworb3V0X2ZpbGU6CiAJbW9ja19maWxl
X2ZyZWUoZ3QtPmk5MTUsIGZpbGUpOwogCXJldHVybiBlcnI7CiB9CmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2suYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2d0L3NlbGZ0ZXN0X2hhbmdjaGVjay5jCmluZGV4IGZmYmIzZDIzYjg4Ny4uZThhNDBk
Zjc5YmQwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5n
Y2hlY2suYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9oYW5nY2hlY2su
YwpAQCAtNTgsOSArNTgsNyBAQCBzdGF0aWMgaW50IGhhbmdfaW5pdChzdHJ1Y3QgaGFuZyAqaCwg
c3RydWN0IGludGVsX2d0ICpndCkKIAltZW1zZXQoaCwgMCwgc2l6ZW9mKCpoKSk7CiAJaC0+Z3Qg
PSBndDsKIAotCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAloLT5j
dHggPSBrZXJuZWxfY29udGV4dChndC0+aTkxNSk7Ci0JbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+
ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYgKElTX0VSUihoLT5jdHgpKQogCQlyZXR1cm4gUFRSX0VS
UihoLT5jdHgpOwogCkBAIC0xMzMsNyArMTMxLDcgQEAgc3RhdGljIHN0cnVjdCBpOTE1X3JlcXVl
c3QgKgogaGFuZ19jcmVhdGVfcmVxdWVzdChzdHJ1Y3QgaGFuZyAqaCwgc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lKQogewogCXN0cnVjdCBpbnRlbF9ndCAqZ3QgPSBoLT5ndDsKLQlzdHJ1
Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSA9IGgtPmN0eC0+dm0gPzogJmVuZ2luZS0+Z3QtPmdn
dHQtPnZtOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtID0gaTkxNV9nZW1fY29udGV4
dF9nZXRfdm1fcmN1KGgtPmN0eCk7CiAJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iajsK
IAlzdHJ1Y3QgaTkxNV9yZXF1ZXN0ICpycSA9IE5VTEw7CiAJc3RydWN0IGk5MTVfdm1hICpod3Ms
ICp2bWE7CkBAIC0xNDMsMTIgKzE0MSwxNSBAQCBoYW5nX2NyZWF0ZV9yZXF1ZXN0KHN0cnVjdCBo
YW5nICpoLCBzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJaW50IGVycjsKIAogCW9i
aiA9IGk5MTVfZ2VtX29iamVjdF9jcmVhdGVfaW50ZXJuYWwoZ3QtPmk5MTUsIFBBR0VfU0laRSk7
Ci0JaWYgKElTX0VSUihvYmopKQorCWlmIChJU19FUlIob2JqKSkgeworCQlpOTE1X3ZtX3B1dCh2
bSk7CiAJCXJldHVybiBFUlJfQ0FTVChvYmopOworCX0KIAogCXZhZGRyID0gaTkxNV9nZW1fb2Jq
ZWN0X3Bpbl9tYXAob2JqLCBpOTE1X2NvaGVyZW50X21hcF90eXBlKGd0LT5pOTE1KSk7CiAJaWYg
KElTX0VSUih2YWRkcikpIHsKIAkJaTkxNV9nZW1fb2JqZWN0X3B1dChvYmopOworCQlpOTE1X3Zt
X3B1dCh2bSk7CiAJCXJldHVybiBFUlJfQ0FTVCh2YWRkcik7CiAJfQogCkBAIC0xNTksMTYgKzE2
MCwyMiBAQCBoYW5nX2NyZWF0ZV9yZXF1ZXN0KHN0cnVjdCBoYW5nICpoLCBzdHJ1Y3QgaW50ZWxf
ZW5naW5lX2NzICplbmdpbmUpCiAJaC0+YmF0Y2ggPSB2YWRkcjsKIAogCXZtYSA9IGk5MTVfdm1h
X2luc3RhbmNlKGgtPm9iaiwgdm0sIE5VTEwpOwotCWlmIChJU19FUlIodm1hKSkKKwlpZiAoSVNf
RVJSKHZtYSkpIHsKKwkJaTkxNV92bV9wdXQodm0pOwogCQlyZXR1cm4gRVJSX0NBU1Qodm1hKTsK
Kwl9CiAKIAlod3MgPSBpOTE1X3ZtYV9pbnN0YW5jZShoLT5od3MsIHZtLCBOVUxMKTsKLQlpZiAo
SVNfRVJSKGh3cykpCisJaWYgKElTX0VSUihod3MpKSB7CisJCWk5MTVfdm1fcHV0KHZtKTsKIAkJ
cmV0dXJuIEVSUl9DQVNUKGh3cyk7CisJfQogCiAJZXJyID0gaTkxNV92bWFfcGluKHZtYSwgMCwg
MCwgUElOX1VTRVIpOwotCWlmIChlcnIpCisJaWYgKGVycikgeworCQlpOTE1X3ZtX3B1dCh2bSk7
CiAJCXJldHVybiBFUlJfUFRSKGVycik7CisJfQogCiAJZXJyID0gaTkxNV92bWFfcGluKGh3cywg
MCwgMCwgUElOX1VTRVIpOwogCWlmIChlcnIpCkBAIC0yNjYsNiArMjczLDcgQEAgaGFuZ19jcmVh
dGVfcmVxdWVzdChzdHJ1Y3QgaGFuZyAqaCwgc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
KQogCWk5MTVfdm1hX3VucGluKGh3cyk7CiB1bnBpbl92bWE6CiAJaTkxNV92bWFfdW5waW4odm1h
KTsKKwlpOTE1X3ZtX3B1dCh2bSk7CiAJcmV0dXJuIGVyciA/IEVSUl9QVFIoZXJyKSA6IHJxOwog
fQogCkBAIC0zODIsOSArMzkwLDcgQEAgc3RhdGljIGludCBpZ3RfcmVzZXRfbm9wKHZvaWQgKmFy
ZykKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAotCW11dGV4
X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAljdHggPSBsaXZlX2NvbnRleHQo
Z3QtPmk5MTUsIGZpbGUpOwotCW11dGV4X3VubG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0
ZXgpOwogCWlmIChJU19FUlIoY3R4KSkgewogCQllcnIgPSBQVFJfRVJSKGN0eCk7CiAJCWdvdG8g
b3V0OwpAQCAtNDU4LDkgKzQ2NCw3IEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X25vcF9lbmdpbmUo
dm9pZCAqYXJnKQogCWlmIChJU19FUlIoZmlsZSkpCiAJCXJldHVybiBQVFJfRVJSKGZpbGUpOwog
Ci0JbXV0ZXhfbG9jaygmZ3QtPmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWN0eCA9IGxpdmVf
Y29udGV4dChndC0+aTkxNSwgZmlsZSk7Ci0JbXV0ZXhfdW5sb2NrKCZndC0+aTkxNS0+ZHJtLnN0
cnVjdF9tdXRleCk7CiAJaWYgKElTX0VSUihjdHgpKSB7CiAJCWVyciA9IFBUUl9FUlIoY3R4KTsK
IAkJZ290byBvdXQ7CkBAIC03MDUsOSArNzA5LDcgQEAgc3RhdGljIGludCBhY3RpdmVfZW5naW5l
KHZvaWQgKmRhdGEpCiAJCXJldHVybiBQVFJfRVJSKGZpbGUpOwogCiAJZm9yIChjb3VudCA9IDA7
IGNvdW50IDwgQVJSQVlfU0laRShjdHgpOyBjb3VudCsrKSB7Ci0JCW11dGV4X2xvY2soJmVuZ2lu
ZS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJCWN0eFtjb3VudF0gPSBsaXZlX2NvbnRleHQo
ZW5naW5lLT5pOTE1LCBmaWxlKTsKLQkJbXV0ZXhfdW5sb2NrKCZlbmdpbmUtPmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwogCQlpZiAoSVNfRVJSKGN0eFtjb3VudF0pKSB7CiAJCQllcnIgPSBQVFJf
RVJSKGN0eFtjb3VudF0pOwogCQkJd2hpbGUgKC0tY291bnQpCkBAIC0xMjkxLDYgKzEyOTMsNyBA
QCBzdGF0aWMgaW50IGlndF9yZXNldF9ldmljdF9wcGd0dCh2b2lkICphcmcpCiB7CiAJc3RydWN0
IGludGVsX2d0ICpndCA9IGFyZzsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OworCXN0
cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtOwogCXN0cnVjdCBkcm1fZmlsZSAqZmlsZTsKIAlp
bnQgZXJyOwogCkBAIC0xMjk4LDE4ICsxMzAxLDIwIEBAIHN0YXRpYyBpbnQgaWd0X3Jlc2V0X2V2
aWN0X3BwZ3R0KHZvaWQgKmFyZykKIAlpZiAoSVNfRVJSKGZpbGUpKQogCQlyZXR1cm4gUFRSX0VS
UihmaWxlKTsKIAotCW11dGV4X2xvY2soJmd0LT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAlj
dHggPSBsaXZlX2NvbnRleHQoZ3QtPmk5MTUsIGZpbGUpOwotCW11dGV4X3VubG9jaygmZ3QtPmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWlmIChJU19FUlIoY3R4KSkgewogCQllcnIgPSBQVFJf
RVJSKGN0eCk7CiAJCWdvdG8gb3V0OwogCX0KIAogCWVyciA9IDA7Ci0JaWYgKGN0eC0+dm0pIC8q
IGFsaWFzaW5nID09IGdsb2JhbCBndHQgbG9ja2luZywgY292ZXJlZCBhYm92ZSAqLwotCQllcnIg
PSBfX2lndF9yZXNldF9ldmljdF92bWEoZ3QsIGN0eC0+dm0sCisJdm0gPSBpOTE1X2dlbV9jb250
ZXh0X2dldF92bV9yY3UoY3R4KTsKKwlpZiAoIWk5MTVfaXNfZ2d0dCh2bSkpIHsKKwkJLyogYWxp
YXNpbmcgPT0gZ2xvYmFsIGd0dCBsb2NraW5nLCBjb3ZlcmVkIGFib3ZlICovCisJCWVyciA9IF9f
aWd0X3Jlc2V0X2V2aWN0X3ZtYShndCwgdm0sCiAJCQkJCSAgICBldmljdF92bWEsIEVYRUNfT0JK
RUNUX1dSSVRFKTsKKwl9CisJaTkxNV92bV9wdXQodm0pOwogCiBvdXQ6CiAJbW9ja19maWxlX2Zy
ZWUoZ3QtPmk5MTUsIGZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfbHJjLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF9scmMuYwpp
bmRleCAwNGMxY2Y1NzM2NDIuLjhkYzQyYzVjNzU2OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3Qvc2VsZnRlc3RfbHJjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
c2VsZnRlc3RfbHJjLmMKQEAgLTE2MzEsNyArMTYzMSwxMSBAQCBzdGF0aWMgaW50IHNtb2tlX3N1
Ym1pdChzdHJ1Y3QgcHJlZW1wdF9zbW9rZSAqc21va2UsCiAJaW50IGVyciA9IDA7CiAKIAlpZiAo
YmF0Y2gpIHsKLQkJdm1hID0gaTkxNV92bWFfaW5zdGFuY2UoYmF0Y2gsIGN0eC0+dm0sIE5VTEwp
OworCQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bTsKKworCQl2bSA9IGk5MTVfZ2VtX2Nv
bnRleHRfZ2V0X3ZtX3JjdShjdHgpOworCQl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShiYXRjaCwg
dm0sIE5VTEwpOworCQlpOTE1X3ZtX3B1dCh2bSk7CiAJCWlmIChJU19FUlIodm1hKSkKIAkJCXJl
dHVybiBQVFJfRVJSKHZtYSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0
L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVz
dF93b3JrYXJvdW5kcy5jCmluZGV4IDRlZTJlMmJhYmQwZC4uZDE3OTc2ZDlmYjkxIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9zZWxmdGVzdF93b3JrYXJvdW5kcy5jCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L3NlbGZ0ZXN0X3dvcmthcm91bmRzLmMKQEAgLTMzLDYg
KzMzLDggQEAgc3RydWN0IHdhX2xpc3RzIHsKIAl9IGVuZ2luZVtJOTE1X05VTV9FTkdJTkVTXTsK
IH07CiAKKyNkZWZpbmUgY3R4X3ZtKGN0eCkgcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZCgoY3R4
KS0+dm0sIHRydWUpCisKIHN0YXRpYyB2b2lkCiByZWZlcmVuY2VfbGlzdHNfaW5pdChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgc3RydWN0IHdhX2xpc3RzICpsaXN0cykKIHsKQEAgLTM2
Miw3ICszNjQsNyBAQCBzdGF0aWMgc3RydWN0IGk5MTVfdm1hICpjcmVhdGVfYmF0Y2goc3RydWN0
IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKIAlpZiAoSVNfRVJSKG9iaikpCiAJCXJldHVybiBFUlJf
Q0FTVChvYmopOwogCi0Jdm1hID0gaTkxNV92bWFfaW5zdGFuY2Uob2JqLCBjdHgtPnZtLCBOVUxM
KTsKKwl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIGN0eF92bShjdHgpLCBOVUxMKTsKIAlp
ZiAoSVNfRVJSKHZtYSkpIHsKIAkJZXJyID0gUFRSX0VSUih2bWEpOwogCQlnb3RvIGVycl9vYmo7
CkBAIC00NjgsNyArNDcwLDcgQEAgc3RhdGljIGludCBjaGVja19kaXJ0eV93aGl0ZWxpc3Qoc3Ry
dWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCwKIAlpbnQgZXJyID0gMCwgaSwgdjsKIAl1MzIgKmNz
LCAqcmVzdWx0czsKIAotCXNjcmF0Y2ggPSBjcmVhdGVfc2NyYXRjaChjdHgtPnZtLCAyICogQVJS
QVlfU0laRSh2YWx1ZXMpICsgMSk7CisJc2NyYXRjaCA9IGNyZWF0ZV9zY3JhdGNoKGN0eF92bShj
dHgpLCAyICogQVJSQVlfU0laRSh2YWx1ZXMpICsgMSk7CiAJaWYgKElTX0VSUihzY3JhdGNoKSkK
IAkJcmV0dXJuIFBUUl9FUlIoc2NyYXRjaCk7CiAKQEAgLTEwMTgsMTQgKzEwMjAsMTQgQEAgc3Rh
dGljIGludCBsaXZlX2lzb2xhdGVkX3doaXRlbGlzdCh2b2lkICphcmcpCiAJCQlnb3RvIGVycjsK
IAkJfQogCi0JCWNsaWVudFtpXS5zY3JhdGNoWzBdID0gY3JlYXRlX3NjcmF0Y2goYy0+dm0sIDEw
MjQpOworCQljbGllbnRbaV0uc2NyYXRjaFswXSA9IGNyZWF0ZV9zY3JhdGNoKGN0eF92bShjKSwg
MTAyNCk7CiAJCWlmIChJU19FUlIoY2xpZW50W2ldLnNjcmF0Y2hbMF0pKSB7CiAJCQllcnIgPSBQ
VFJfRVJSKGNsaWVudFtpXS5zY3JhdGNoWzBdKTsKIAkJCWtlcm5lbF9jb250ZXh0X2Nsb3NlKGMp
OwogCQkJZ290byBlcnI7CiAJCX0KIAotCQljbGllbnRbaV0uc2NyYXRjaFsxXSA9IGNyZWF0ZV9z
Y3JhdGNoKGMtPnZtLCAxMDI0KTsKKwkJY2xpZW50W2ldLnNjcmF0Y2hbMV0gPSBjcmVhdGVfc2Ny
YXRjaChjdHhfdm0oYyksIDEwMjQpOwogCQlpZiAoSVNfRVJSKGNsaWVudFtpXS5zY3JhdGNoWzFd
KSkgewogCQkJZXJyID0gUFRSX0VSUihjbGllbnRbaV0uc2NyYXRjaFsxXSk7CiAJCQlpOTE1X3Zt
YV91bnBpbl9hbmRfcmVsZWFzZSgmY2xpZW50W2ldLnNjcmF0Y2hbMF0sIDApOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ3Z0L3NjaGVkdWxlci5jCmluZGV4IDAzZjU2NzA4NDU0OC4uNjg1MGYxZjQwMjQxIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvc2NoZWR1bGVyLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ3Z0L3NjaGVkdWxlci5jCkBAIC0zNjUsNyArMzY1LDggQEAgc3Rh
dGljIHZvaWQgc2V0X2NvbnRleHRfcHBndHRfZnJvbV9zaGFkb3coc3RydWN0IGludGVsX3ZncHVf
d29ya2xvYWQgKndvcmtsb2FkLAogCQkJCQkgIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgp
CiB7CiAJc3RydWN0IGludGVsX3ZncHVfbW0gKm1tID0gd29ya2xvYWQtPnNoYWRvd19tbTsKLQlz
dHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQgPSBpOTE1X3ZtX3RvX3BwZ3R0KGN0eC0+dm0pOworCXN0
cnVjdCBpOTE1X3BwZ3R0ICpwcGd0dCA9CisJCWk5MTVfdm1fdG9fcHBndHQoaTkxNV9nZW1fY29u
dGV4dF9nZXRfdm1fcmN1KGN0eCkpOwogCWludCBpID0gMDsKIAogCWlmIChtbS0+cHBndHRfbW0u
cm9vdF9lbnRyeV90eXBlID09IEdUVF9UWVBFX1BQR1RUX1JPT1RfTDRfRU5UUlkpIHsKQEAgLTM3
OCw2ICszNzksOCBAQCBzdGF0aWMgdm9pZCBzZXRfY29udGV4dF9wcGd0dF9mcm9tX3NoYWRvdyhz
dHJ1Y3QgaW50ZWxfdmdwdV93b3JrbG9hZCAqd29ya2xvYWQsCiAJCQlweF9kbWEocGQpID0gbW0t
PnBwZ3R0X21tLnNoYWRvd19wZHBzW2ldOwogCQl9CiAJfQorCisJaTkxNV92bV9wdXQoJnBwZ3R0
LT52bSk7CiB9CiAKIHN0YXRpYyBpbnQKQEAgLTEyMzAsMjAgKzEyMzMsMTggQEAgaW50IGludGVs
X3ZncHVfc2V0dXBfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIAlzdHJ1Y3Qg
aW50ZWxfdmdwdV9zdWJtaXNzaW9uICpzID0gJnZncHUtPnN1Ym1pc3Npb247CiAJc3RydWN0IGlu
dGVsX2VuZ2luZV9jcyAqZW5naW5lOwogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CisJ
c3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0OwogCWVudW0gaW50ZWxfZW5naW5lX2lkIGk7CiAJaW50
IHJldDsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwotCiAJY3R4ID0g
aTkxNV9nZW1fY29udGV4dF9jcmVhdGVfa2VybmVsKGk5MTUsIEk5MTVfUFJJT1JJVFlfTUFYKTsK
LQlpZiAoSVNfRVJSKGN0eCkpIHsKLQkJcmV0ID0gUFRSX0VSUihjdHgpOwotCQlnb3RvIG91dF91
bmxvY2s7Ci0JfQorCWlmIChJU19FUlIoY3R4KSkKKwkJcmV0dXJuIFBUUl9FUlIoY3R4KTsKIAog
CWk5MTVfZ2VtX2NvbnRleHRfc2V0X2ZvcmNlX3NpbmdsZV9zdWJtaXNzaW9uKGN0eCk7CiAKLQlp
OTE1X2NvbnRleHRfcHBndHRfcm9vdF9zYXZlKHMsIGk5MTVfdm1fdG9fcHBndHQoY3R4LT52bSkp
OworCXBwZ3R0ID0gaTkxNV92bV90b19wcGd0dChpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3Uo
Y3R4KSk7CisJaTkxNV9jb250ZXh0X3BwZ3R0X3Jvb3Rfc2F2ZShzLCBwcGd0dCk7CiAKIAlmb3Jf
ZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBpKSB7CiAJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpj
ZTsKQEAgLTEyODgsMTIgKzEyODksMTIgQEAgaW50IGludGVsX3ZncHVfc2V0dXBfc3VibWlzc2lv
bihzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSkKIAlhdG9taWNfc2V0KCZzLT5ydW5uaW5nX3dvcmts
b2FkX251bSwgMCk7CiAJYml0bWFwX3plcm8ocy0+dGxiX2hhbmRsZV9wZW5kaW5nLCBJOTE1X05V
TV9FTkdJTkVTKTsKIAorCWk5MTVfdm1fcHV0KCZwcGd0dC0+dm0pOwogCWk5MTVfZ2VtX2NvbnRl
eHRfcHV0KGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAly
ZXR1cm4gMDsKIAogb3V0X3NoYWRvd19jdHg6Ci0JaTkxNV9jb250ZXh0X3BwZ3R0X3Jvb3RfcmVz
dG9yZShzLCBpOTE1X3ZtX3RvX3BwZ3R0KGN0eC0+dm0pKTsKKwlpOTE1X2NvbnRleHRfcHBndHRf
cm9vdF9yZXN0b3JlKHMsIHBwZ3R0KTsKIAlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBpOTE1LCBp
KSB7CiAJCWlmIChJU19FUlIocy0+c2hhZG93W2ldKSkKIAkJCWJyZWFrOwpAQCAtMTMwMSw5ICsx
MzAyLDggQEAgaW50IGludGVsX3ZncHVfc2V0dXBfc3VibWlzc2lvbihzdHJ1Y3QgaW50ZWxfdmdw
dSAqdmdwdSkKIAkJaW50ZWxfY29udGV4dF91bnBpbihzLT5zaGFkb3dbaV0pOwogCQlpbnRlbF9j
b250ZXh0X3B1dChzLT5zaGFkb3dbaV0pOwogCX0KKwlpOTE1X3ZtX3B1dCgmcHBndHQtPnZtKTsK
IAlpOTE1X2dlbV9jb250ZXh0X3B1dChjdHgpOwotb3V0X3VubG9jazoKLQltdXRleF91bmxvY2so
Jmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCXJldHVybiByZXQ7CiB9CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggMGU5MGFjNjA4ZTA3Li5iMDRjZWJjMjZlY2EgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5jCkBAIC0zMTYsMTIgKzMxNiwxOCBAQCBzdGF0aWMg
dm9pZCBwcmludF9jb250ZXh0X3N0YXRzKHN0cnVjdCBzZXFfZmlsZSAqbSwKIAkJCQlzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKIAlzdHJ1Y3QgZmlsZV9zdGF0cyBrc3RhdHMgPSB7
fTsKLQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OworCXN0cnVjdCBpOTE1X2dlbV9jb250
ZXh0ICpjdHgsICpjbjsKIAotCWxpc3RfZm9yX2VhY2hfZW50cnkoY3R4LCAmaTkxNS0+Y29udGV4
dHMubGlzdCwgbGluaykgeworCXNwaW5fbG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOwor
CWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShjdHgsIGNuLCAmaTkxNS0+Z2VtLmNvbnRleHRzLmxp
c3QsIGxpbmspIHsKIAkJc3RydWN0IGk5MTVfZ2VtX2VuZ2luZXNfaXRlciBpdDsKIAkJc3RydWN0
IGludGVsX2NvbnRleHQgKmNlOwogCisJCWlmICgha3JlZl9nZXRfdW5sZXNzX3plcm8oJmN0eC0+
cmVmKSkKKwkJCWNvbnRpbnVlOworCisJCXNwaW5fdW5sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMu
bG9jayk7CisKIAkJZm9yX2VhY2hfZ2VtX2VuZ2luZShjZSwKIAkJCQkgICAgaTkxNV9nZW1fY29u
dGV4dF9sb2NrX2VuZ2luZXMoY3R4KSwgaXQpIHsKIAkJCWludGVsX2NvbnRleHRfbG9ja19waW5u
ZWQoY2UpOwpAQCAtMzM4LDcgKzM0NCw5IEBAIHN0YXRpYyB2b2lkIHByaW50X2NvbnRleHRfc3Rh
dHMoc3RydWN0IHNlcV9maWxlICptLAogCQlpOTE1X2dlbV9jb250ZXh0X3VubG9ja19lbmdpbmVz
KGN0eCk7CiAKIAkJaWYgKCFJU19FUlJfT1JfTlVMTChjdHgtPmZpbGVfcHJpdikpIHsKLQkJCXN0
cnVjdCBmaWxlX3N0YXRzIHN0YXRzID0geyAudm0gPSBjdHgtPnZtLCB9OworCQkJc3RydWN0IGZp
bGVfc3RhdHMgc3RhdHMgPSB7CisJCQkJLnZtID0gcmN1X2FjY2Vzc19wb2ludGVyKGN0eC0+dm0p
LAorCQkJfTsKIAkJCXN0cnVjdCBkcm1fZmlsZSAqZmlsZSA9IGN0eC0+ZmlsZV9wcml2LT5maWxl
OwogCQkJc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrOwogCQkJY2hhciBuYW1lWzgwXTsKQEAgLTM1
NSw3ICszNjMsMTIgQEAgc3RhdGljIHZvaWQgcHJpbnRfY29udGV4dF9zdGF0cyhzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sCiAKIAkJCXByaW50X2ZpbGVfc3RhdHMobSwgbmFtZSwgc3RhdHMpOwogCQl9CisK
KwkJc3Bpbl9sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9jayk7CisJCWxpc3Rfc2FmZV9yZXNl
dF9uZXh0KGN0eCwgY24sIGxpbmspOworCQlpOTE1X2dlbV9jb250ZXh0X3B1dChjdHgpOwogCX0K
KwlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOwogCiAJcHJpbnRfZmlsZV9z
dGF0cyhtLCAiW2tdY29udGV4dHMiLCBrc3RhdHMpOwogfQpAQCAtMzYzLDcgKzM3Niw2IEBAIHN0
YXRpYyB2b2lkIHByaW50X2NvbnRleHRfc3RhdHMoc3RydWN0IHNlcV9maWxlICptLAogc3RhdGlj
IGludCBpOTE1X2dlbV9vYmplY3RfaW5mbyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEp
CiB7CiAJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSBub2RlX3RvX2k5MTUobS0+cHJp
dmF0ZSk7Ci0JaW50IHJldDsKIAogCXNlcV9wcmludGYobSwgIiV1IHNocmlua2FibGUgWyV1IGZy
ZWVdIG9iamVjdHMsICVsbHUgYnl0ZXNcbiIsCiAJCSAgIGk5MTUtPm1tLnNocmlua19jb3VudCwK
QEAgLTM3MiwxMiArMzg0LDcgQEAgc3RhdGljIGludCBpOTE1X2dlbV9vYmplY3RfaW5mbyhzdHJ1
Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpCiAKIAlzZXFfcHV0YyhtLCAnXG4nKTsKIAotCXJl
dCA9IG11dGV4X2xvY2tfaW50ZXJydXB0aWJsZSgmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7Ci0J
aWYgKHJldCkKLQkJcmV0dXJuIHJldDsKLQogCXByaW50X2NvbnRleHRfc3RhdHMobSwgaTkxNSk7
Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAogCXJldHVybiAwOwog
fQpAQCAtMTU3OSwxOSArMTU4NiwxOSBAQCBzdGF0aWMgdm9pZCBkZXNjcmliZV9jdHhfcmluZyhz
dHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVjdCBpbnRlbF9yaW5nICpyaW5nKQogCiBzdGF0aWMgaW50
IGk5MTVfY29udGV4dF9zdGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiB7
Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gbm9kZV90b19pOTE1KG0tPnBy
aXZhdGUpOwotCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRybTsKLQlzdHJ1
Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OwotCWludCByZXQ7Ci0KLQlyZXQgPSBtdXRleF9sb2Nr
X2ludGVycnVwdGlibGUoJmRldi0+c3RydWN0X211dGV4KTsKLQlpZiAocmV0KQotCQlyZXR1cm4g
cmV0OworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gbm9kZV90b19pOTE1KG0tPnBy
aXZhdGUpOworCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHgsICpjbjsKIAotCWxpc3RfZm9y
X2VhY2hfZW50cnkoY3R4LCAmZGV2X3ByaXYtPmNvbnRleHRzLmxpc3QsIGxpbmspIHsKKwlzcGlu
X2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3Nh
ZmUoY3R4LCBjbiwgJmk5MTUtPmdlbS5jb250ZXh0cy5saXN0LCBsaW5rKSB7CiAJCXN0cnVjdCBp
OTE1X2dlbV9lbmdpbmVzX2l0ZXIgaXQ7CiAJCXN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZTsKIAor
CQlpZiAoIWtyZWZfZ2V0X3VubGVzc196ZXJvKCZjdHgtPnJlZikpCisJCQljb250aW51ZTsKKwor
CQlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCiAJCXNlcV9wdXRzKG0s
ICJIVyBjb250ZXh0ICIpOwogCQlpZiAoY3R4LT5waWQpIHsKIAkJCXN0cnVjdCB0YXNrX3N0cnVj
dCAqdGFzazsKQEAgLTE2MjYsOSArMTYzMywxMiBAQCBzdGF0aWMgaW50IGk5MTVfY29udGV4dF9z
dGF0dXMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp1bnVzZWQpCiAJCWk5MTVfZ2VtX2NvbnRl
eHRfdW5sb2NrX2VuZ2luZXMoY3R4KTsKIAogCQlzZXFfcHV0YyhtLCAnXG4nKTsKLQl9CiAKLQlt
dXRleF91bmxvY2soJmRldi0+c3RydWN0X211dGV4KTsKKwkJc3Bpbl9sb2NrKCZpOTE1LT5nZW0u
Y29udGV4dHMubG9jayk7CisJCWxpc3Rfc2FmZV9yZXNldF9uZXh0KGN0eCwgY24sIGxpbmspOwor
CQlpOTE1X2dlbV9jb250ZXh0X3B1dChjdHgpOworCX0KKwlzcGluX3VubG9jaygmaTkxNS0+Z2Vt
LmNvbnRleHRzLmxvY2spOwogCiAJcmV0dXJuIDA7CiB9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuYwpp
bmRleCA1MzIzZTRmYTU1ZDkuLjAyNGRhNTgyYmEwZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5j
CkBAIC0xNjY1LDEwICsxNjY1LDggQEAgc3RhdGljIHZvaWQgaTkxNV9kcml2ZXJfcG9zdGNsb3Nl
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSkKIHsKIAlzdHJ1
Y3QgZHJtX2k5MTVfZmlsZV9wcml2YXRlICpmaWxlX3ByaXYgPSBmaWxlLT5kcml2ZXJfcHJpdjsK
IAotCW11dGV4X2xvY2soJmRldi0+c3RydWN0X211dGV4KTsKIAlpOTE1X2dlbV9jb250ZXh0X2Ns
b3NlKGZpbGUpOwogCWk5MTVfZ2VtX3JlbGVhc2UoZGV2LCBmaWxlKTsKLQltdXRleF91bmxvY2so
JmRldi0+c3RydWN0X211dGV4KTsKIAogCWtmcmVlX3JjdShmaWxlX3ByaXYsIHJjdSk7CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4IGNiNjNiMmJkMGNlOC4uMzViNjEwZDUyMzc5IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfZHJ2LmgKQEAgLTE1MzYsMjUgKzE1MzYsNiBAQCBzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSB7CiAJaW50IGF1ZGlvX3Bvd2VyX3JlZmNvdW50OwogCXUzMiBhdWRpb19mcmVx
X2NudHJsOwogCi0Jc3RydWN0IHsKLQkJc3RydWN0IG11dGV4IG11dGV4OwotCQlzdHJ1Y3QgbGlz
dF9oZWFkIGxpc3Q7Ci0JCXN0cnVjdCBsbGlzdF9oZWFkIGZyZWVfbGlzdDsKLQkJc3RydWN0IHdv
cmtfc3RydWN0IGZyZWVfd29yazsKLQotCQkvKiBUaGUgaHcgd2FudHMgdG8gaGF2ZSBhIHN0YWJs
ZSBjb250ZXh0IGlkZW50aWZpZXIgZm9yIHRoZQotCQkgKiBsaWZldGltZSBvZiB0aGUgY29udGV4
dCAoZm9yIE9BLCBQQVNJRCwgZmF1bHRzLCBldGMpLgotCQkgKiBUaGlzIGlzIGxpbWl0ZWQgaW4g
ZXhlY2xpc3RzIHRvIDIxIGJpdHMuCi0JCSAqLwotCQlzdHJ1Y3QgaWRhIGh3X2lkYTsKLSNkZWZp
bmUgTUFYX0NPTlRFWFRfSFdfSUQgKDE8PDIxKSAvKiBleGNsdXNpdmUgKi8KLSNkZWZpbmUgTUFY
X0dVQ19DT05URVhUX0hXX0lEICgxIDw8IDIwKSAvKiBleGNsdXNpdmUgKi8KLSNkZWZpbmUgR0VO
MTFfTUFYX0NPTlRFWFRfSFdfSUQgKDE8PDExKSAvKiBleGNsdXNpdmUgKi8KLS8qIGluIEdlbjEy
IElEIDB4N0ZGIGlzIHJlc2VydmVkIHRvIGluZGljYXRlIGlkbGUgKi8KLSNkZWZpbmUgR0VOMTJf
TUFYX0NPTlRFWFRfSFdfSUQJKEdFTjExX01BWF9DT05URVhUX0hXX0lEIC0gMSkKLQkJc3RydWN0
IGxpc3RfaGVhZCBod19pZF9saXN0OwotCX0gY29udGV4dHM7Ci0KIAl1MzIgZmRpX3J4X2NvbmZp
ZzsKIAogCS8qIFNoYWRvdyBmb3IgRElTUExBWV9QSFlfQ09OVFJPTCB3aGljaCBjYW4ndCBiZSBz
YWZlbHkgcmVhZCAqLwpAQCAtMTcxMCw2ICsxNjkxLDE0IEBAIHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlIHsKIAogCXN0cnVjdCB7CiAJCXN0cnVjdCBub3RpZmllcl9ibG9jayBwbV9ub3RpZmllcjsK
KworCQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dHMgeworCQkJc3BpbmxvY2tfdCBsb2NrOyAvKiBs
b2NrcyBsaXN0ICovCisJCQlzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7CisKKwkJCXN0cnVjdCBsbGlz
dF9oZWFkIGZyZWVfbGlzdDsKKwkJCXN0cnVjdCB3b3JrX3N0cnVjdCBmcmVlX3dvcms7CisJCX0g
Y29udGV4dHM7CiAJfSBnZW07CiAKIAkvKiBGb3IgaTk0NWdtIHZibGFuayBpcnEgdnMuIEMzIHdv
cmthcm91bmQgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCmluZGV4IDVhNjY0YmRlYWQ4Yy4uZjZk
YjQxNTk4NWQ1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTEyNjYsNyArMTI2Niw3IEBA
IGludCBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAkJ
Z290byBlcnJfdW5sb2NrOwogCX0KIAotCXJldCA9IGk5MTVfZ2VtX2NvbnRleHRzX2luaXQoZGV2
X3ByaXYpOworCXJldCA9IGk5MTVfZ2VtX2luaXRfY29udGV4dHMoZGV2X3ByaXYpOwogCWlmIChy
ZXQpIHsKIAkJR0VNX0JVR19PTihyZXQgPT0gLUVJTyk7CiAJCWdvdG8gZXJyX3NjcmF0Y2g7CkBA
IC0xMzQ4LDcgKzEzNDgsNyBAQCBpbnQgaTkxNV9nZW1faW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYpCiAJfQogZXJyX2NvbnRleHQ6CiAJaWYgKHJldCAhPSAtRUlPKQotCQlp
OTE1X2dlbV9jb250ZXh0c19maW5pKGRldl9wcml2KTsKKwkJaTkxNV9nZW1fZHJpdmVyX3JlbGVh
c2VfX2NvbnRleHRzKGRldl9wcml2KTsKIGVycl9zY3JhdGNoOgogCWludGVsX2d0X2RyaXZlcl9y
ZWxlYXNlKCZkZXZfcHJpdi0+Z3QpOwogZXJyX3VubG9jazoKQEAgLTE0MTYsMTEgKzE0MTYsOSBA
QCB2b2lkIGk5MTVfZ2VtX2RyaXZlcl9yZW1vdmUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRl
dl9wcml2KQogCiB2b2lkIGk5MTVfZ2VtX2RyaXZlcl9yZWxlYXNlKHN0cnVjdCBkcm1faTkxNV9w
cml2YXRlICpkZXZfcHJpdikKIHsKLQltdXRleF9sb2NrKCZkZXZfcHJpdi0+ZHJtLnN0cnVjdF9t
dXRleCk7CiAJaW50ZWxfZW5naW5lc19jbGVhbnVwKGRldl9wcml2KTsKLQlpOTE1X2dlbV9jb250
ZXh0c19maW5pKGRldl9wcml2KTsKKwlpOTE1X2dlbV9kcml2ZXJfcmVsZWFzZV9fY29udGV4dHMo
ZGV2X3ByaXYpOwogCWludGVsX2d0X2RyaXZlcl9yZWxlYXNlKCZkZXZfcHJpdi0+Z3QpOwotCW11
dGV4X3VubG9jaygmZGV2X3ByaXYtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJaW50ZWxfd2FfbGlz
dF9mcmVlKCZkZXZfcHJpdi0+Z3Rfd2FfbGlzdCk7CiAKQEAgLTE0MzAsNyArMTQyOCw3IEBAIHZv
aWQgaTkxNV9nZW1fZHJpdmVyX3JlbGVhc2Uoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9w
cml2KQogCiAJaTkxNV9nZW1fZHJhaW5fZnJlZWRfb2JqZWN0cyhkZXZfcHJpdik7CiAKLQlXQVJO
X09OKCFsaXN0X2VtcHR5KCZkZXZfcHJpdi0+Y29udGV4dHMubGlzdCkpOworCVdBUk5fT04oIWxp
c3RfZW1wdHkoJmRldl9wcml2LT5nZW0uY29udGV4dHMubGlzdCkpOwogfQogCiB2b2lkIGk5MTVf
Z2VtX2luaXRfbW1pbyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9nZW1fZ3R0LmMKaW5kZXggMWQyNjYzNGNhNTk3Li43YjE1YmI4OTE5NzAgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtX2d0dC5jCkBAIC0xMzY2LDcgKzEzNjYsOSBAQCBzdGF0aWMg
aW50IGdlbjhfaW5pdF9zY3JhdGNoKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtKQogCWlm
ICh2bS0+aGFzX3JlYWRfb25seSAmJgogCSAgICB2bS0+aTkxNS0+a2VybmVsX2NvbnRleHQgJiYK
IAkgICAgdm0tPmk5MTUtPmtlcm5lbF9jb250ZXh0LT52bSkgewotCQlzdHJ1Y3QgaTkxNV9hZGRy
ZXNzX3NwYWNlICpjbG9uZSA9IHZtLT5pOTE1LT5rZXJuZWxfY29udGV4dC0+dm07CisJCXN0cnVj
dCBpOTE1X2FkZHJlc3Nfc3BhY2UgKmNsb25lID0KKwkJCXJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0
ZWQodm0tPmk5MTUtPmtlcm5lbF9jb250ZXh0LT52bSwKKwkJCQkJCSAgdHJ1ZSk7IC8qIHN0YXRp
YyAqLwogCiAJCUdFTV9CVUdfT04oIWNsb25lLT5oYXNfcmVhZF9vbmx5KTsKIApkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X3BlcmYuYwppbmRleCBlY2ZiYzM3YjczOGIuLjIzMTM4OGQwNmM4MiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wZXJmLmMKKysrIGIvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9wZXJmLmMKQEAgLTE4NTMsOCArMTg1Myw4IEBAIHN0YXRpYyBpbnQgZ2VuOF9j
b25maWd1cmVfYWxsX2NvbnRleHRzKHN0cnVjdCBpOTE1X3BlcmZfc3RyZWFtICpzdHJlYW0sCiAJ
fTsKICN1bmRlZiBjdHhfZmxleGV1TgogCXN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZTsK
LQlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OwotCWludCBpOworCXN0cnVjdCBpOTE1X2dl
bV9jb250ZXh0ICpjdHgsICpjbjsKKwlpbnQgaSwgZXJyOwogCiAJZm9yIChpID0gMjsgaSA8IEFS
UkFZX1NJWkUocmVncyk7IGkrKykKIAkJcmVnc1tpXS52YWx1ZSA9IG9hX2NvbmZpZ19mbGV4X3Jl
ZyhvYV9jb25maWcsIHJlZ3NbaV0ucmVnKTsKQEAgLTE4NzcsMTYgKzE4NzcsMjcgQEAgc3RhdGlj
IGludCBnZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0g
KnN0cmVhbSwKIAkgKiBjb250ZXh0LiBDb250ZXh0cyBpZGxlIGF0IHRoZSB0aW1lIG9mIHJlY29u
ZmlndXJhdGlvbiBhcmUgbm90CiAJICogdHJhcHBlZCBiZWhpbmQgdGhlIGJhcnJpZXIuCiAJICov
Ci0JbGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsICZpOTE1LT5jb250ZXh0cy5saXN0LCBsaW5rKSB7
Ci0JCWludCBlcnI7Ci0KKwlzcGluX2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKKwls
aXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoY3R4LCBjbiwgJmk5MTUtPmdlbS5jb250ZXh0cy5saXN0
LCBsaW5rKSB7CiAJCWlmIChjdHggPT0gaTkxNS0+a2VybmVsX2NvbnRleHQpCiAJCQljb250aW51
ZTsKIAorCQlpZiAoIWtyZWZfZ2V0X3VubGVzc196ZXJvKCZjdHgtPnJlZikpCisJCQljb250aW51
ZTsKKworCQlzcGluX3VubG9jaygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCiAJCWVyciA9
IGdlbjhfY29uZmlndXJlX2NvbnRleHQoY3R4LCByZWdzLCBBUlJBWV9TSVpFKHJlZ3MpKTsKLQkJ
aWYgKGVycikKKwkJaWYgKGVycikgeworCQkJaTkxNV9nZW1fY29udGV4dF9wdXQoY3R4KTsKIAkJ
CXJldHVybiBlcnI7CisJCX0KKworCQlzcGluX2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2Nr
KTsKKwkJbGlzdF9zYWZlX3Jlc2V0X25leHQoY3R4LCBjbiwgbGluayk7CisJCWk5MTVfZ2VtX2Nv
bnRleHRfcHV0KGN0eCk7CiAJfQorCXNwaW5fdW5sb2NrKCZpOTE1LT5nZW0uY29udGV4dHMubG9j
ayk7CiAKIAkvKgogCSAqIEFmdGVyIHVwZGF0aW5nIGFsbCBvdGhlciBjb250ZXh0cywgd2UgbmVl
ZCB0byBtb2RpZnkgb3Vyc2VsdmVzLgpAQCAtMTg5NSw3ICsxOTA2LDYgQEAgc3RhdGljIGludCBn
ZW44X2NvbmZpZ3VyZV9hbGxfY29udGV4dHMoc3RydWN0IGk5MTVfcGVyZl9zdHJlYW0gKnN0cmVh
bSwKIAkgKi8KIAlmb3JfZWFjaF91YWJpX2VuZ2luZShlbmdpbmUsIGk5MTUpIHsKIAkJc3RydWN0
IGludGVsX2NvbnRleHQgKmNlID0gZW5naW5lLT5rZXJuZWxfY29udGV4dDsKLQkJaW50IGVycjsK
IAogCQlpZiAoZW5naW5lLT5jbGFzcyAhPSBSRU5ERVJfQ0xBU1MpCiAJCQljb250aW51ZTsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2k5MTVfc3lzZnMuYwppbmRleCAwMzRiOGFiYzUwNjIuLjJhNzI0MDdhNjM4MCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9zeXNmcy5jCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfc3lzZnMuYwpAQCAtMTQ0LDkgKzE0NCw5IEBAIHN0YXRpYyBj
b25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIG1lZGlhX3JjNl9hdHRyX2dyb3VwID0gewogfTsK
ICNlbmRpZgogCi1zdGF0aWMgaW50IGwzX2FjY2Vzc192YWxpZChzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqZGV2X3ByaXYsIGxvZmZfdCBvZmZzZXQpCitzdGF0aWMgaW50IGwzX2FjY2Vzc192YWxp
ZChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgbG9mZl90IG9mZnNldCkKIHsKLQlpZiAo
IUhBU19MM19EUEYoZGV2X3ByaXYpKQorCWlmICghSEFTX0wzX0RQRihpOTE1KSkKIAkJcmV0dXJu
IC1FUEVSTTsKIAogCWlmIChvZmZzZXQgJSA0ICE9IDApCkBAIC0xNjQsMzEgKzE2NCwyNCBAQCBp
OTE1X2wzX3JlYWQoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCBrb2JqZWN0ICprb2JqLAogCSAg
ICAgbG9mZl90IG9mZnNldCwgc2l6ZV90IGNvdW50KQogewogCXN0cnVjdCBkZXZpY2UgKmtkZXYg
PSBrb2JqX3RvX2Rldihrb2JqKTsKLQlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYg
PSBrZGV2X21pbm9yX3RvX2k5MTUoa2Rldik7Ci0Jc3RydWN0IGRybV9kZXZpY2UgKmRldiA9ICZk
ZXZfcHJpdi0+ZHJtOworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0ga2Rldl9taW5v
cl90b19pOTE1KGtkZXYpOwogCWludCBzbGljZSA9IChpbnQpKHVpbnRwdHJfdClhdHRyLT5wcml2
YXRlOwogCWludCByZXQ7CiAKLQljb3VudCA9IHJvdW5kX2Rvd24oY291bnQsIDQpOwotCi0JcmV0
ID0gbDNfYWNjZXNzX3ZhbGlkKGRldl9wcml2LCBvZmZzZXQpOworCXJldCA9IGwzX2FjY2Vzc192
YWxpZChpOTE1LCBvZmZzZXQpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKKwljb3VudCA9
IHJvdW5kX2Rvd24oY291bnQsIDQpOwogCWNvdW50ID0gbWluX3Qoc2l6ZV90LCBHRU43X0wzTE9H
X1NJWkUgLSBvZmZzZXQsIGNvdW50KTsKKwltZW1zZXQoYnVmLCAwLCBjb3VudCk7CiAKLQlyZXQg
PSBpOTE1X211dGV4X2xvY2tfaW50ZXJydXB0aWJsZShkZXYpOwotCWlmIChyZXQpCi0JCXJldHVy
biByZXQ7Ci0KLQlpZiAoZGV2X3ByaXYtPmwzX3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNlXSkKKwlz
cGluX2xvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKKwlpZiAoaTkxNS0+bDNfcGFyaXR5
LnJlbWFwX2luZm9bc2xpY2VdKQogCQltZW1jcHkoYnVmLAotCQkgICAgICAgZGV2X3ByaXYtPmwz
X3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNlXSArIChvZmZzZXQvNCksCisJCSAgICAgICBpOTE1LT5s
M19wYXJpdHkucmVtYXBfaW5mb1tzbGljZV0gKyBvZmZzZXQgLyA0LAogCQkgICAgICAgY291bnQp
OwotCWVsc2UKLQkJbWVtc2V0KGJ1ZiwgMCwgY291bnQpOwotCi0JbXV0ZXhfdW5sb2NrKCZkZXYt
PnN0cnVjdF9tdXRleCk7CisJc3Bpbl91bmxvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsK
IAogCXJldHVybiBjb3VudDsKIH0KQEAgLTE5OSw0NiArMTkyLDQ2IEBAIGk5MTVfbDNfd3JpdGUo
c3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCBrb2JqZWN0ICprb2JqLAogCSAgICAgIGxvZmZfdCBv
ZmZzZXQsIHNpemVfdCBjb3VudCkKIHsKIAlzdHJ1Y3QgZGV2aWNlICprZGV2ID0ga29ial90b19k
ZXYoa29iaik7Ci0Jc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0ga2Rldl9taW5v
cl90b19pOTE1KGtkZXYpOwotCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSAmZGV2X3ByaXYtPmRy
bTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IGtkZXZfbWlub3JfdG9faTkxNShr
ZGV2KTsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4OwogCWludCBzbGljZSA9IChpbnQp
KHVpbnRwdHJfdClhdHRyLT5wcml2YXRlOwotCXUzMiAqKnJlbWFwX2luZm87CisJdTMyICpyZW1h
cF9pbmZvLCAqZnJlZW1lID0gTlVMTDsKIAlpbnQgcmV0OwogCi0JcmV0ID0gbDNfYWNjZXNzX3Zh
bGlkKGRldl9wcml2LCBvZmZzZXQpOworCXJldCA9IGwzX2FjY2Vzc192YWxpZChpOTE1LCBvZmZz
ZXQpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKLQlyZXQgPSBpOTE1X211dGV4X2xvY2tf
aW50ZXJydXB0aWJsZShkZXYpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7CisJcmVtYXBfaW5m
byA9IGt6YWxsb2MoR0VON19MM0xPR19TSVpFLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXJlbWFwX2lu
Zm8pCisJCXJldHVybiAtRU5PTUVNOwogCi0JcmVtYXBfaW5mbyA9ICZkZXZfcHJpdi0+bDNfcGFy
aXR5LnJlbWFwX2luZm9bc2xpY2VdOwotCWlmICghKnJlbWFwX2luZm8pIHsKLQkJKnJlbWFwX2lu
Zm8gPSBremFsbG9jKEdFTjdfTDNMT0dfU0laRSwgR0ZQX0tFUk5FTCk7Ci0JCWlmICghKnJlbWFw
X2luZm8pIHsKLQkJCXJldCA9IC1FTk9NRU07Ci0JCQlnb3RvIG91dDsKLQkJfQorCXNwaW5fbG9j
aygmaTkxNS0+Z2VtLmNvbnRleHRzLmxvY2spOworCisJaWYgKGk5MTUtPmwzX3Bhcml0eS5yZW1h
cF9pbmZvW3NsaWNlXSkgeworCQlmcmVlbWUgPSByZW1hcF9pbmZvOworCQlyZW1hcF9pbmZvID0g
aTkxNS0+bDNfcGFyaXR5LnJlbWFwX2luZm9bc2xpY2VdOworCX0gZWxzZSB7CisJCWk5MTUtPmwz
X3Bhcml0eS5yZW1hcF9pbmZvW3NsaWNlXSA9IHJlbWFwX2luZm87CiAJfQogCi0JLyogVE9ETzog
SWRlYWxseSB3ZSByZWFsbHkgd2FudCBhIEdQVSByZXNldCBoZXJlIHRvIG1ha2Ugc3VyZSBlcnJv
cnMKLQkgKiBhcmVuJ3QgcHJvcGFnYXRlZC4gU2luY2UgSSBjYW5ub3QgZmluZCBhIHN0YWJsZSB3
YXkgdG8gcmVzZXQgdGhlIEdQVQotCSAqIGF0IHRoaXMgcG9pbnQgaXQgaXMgbGVmdCBhcyBhIFRP
RE8uCi0JKi8KLQltZW1jcHkoKnJlbWFwX2luZm8gKyAob2Zmc2V0LzQpLCBidWYsIGNvdW50KTsK
Kwljb3VudCA9IHJvdW5kX2Rvd24oY291bnQsIDQpOworCW1lbWNweShyZW1hcF9pbmZvICsgb2Zm
c2V0IC8gNCwgYnVmLCBjb3VudCk7CiAKIAkvKiBOQjogV2UgZGVmZXIgdGhlIHJlbWFwcGluZyB1
bnRpbCB3ZSBzd2l0Y2ggdG8gdGhlIGNvbnRleHQgKi8KLQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGN0
eCwgJmRldl9wcml2LT5jb250ZXh0cy5saXN0LCBsaW5rKQotCQljdHgtPnJlbWFwX3NsaWNlIHw9
ICgxPDxzbGljZSk7CisJbGlzdF9mb3JfZWFjaF9lbnRyeShjdHgsICZpOTE1LT5nZW0uY29udGV4
dHMubGlzdCwgbGluaykKKwkJY3R4LT5yZW1hcF9zbGljZSB8PSBCSVQoc2xpY2UpOwogCi0JcmV0
ID0gY291bnQ7CisJc3Bpbl91bmxvY2soJmk5MTUtPmdlbS5jb250ZXh0cy5sb2NrKTsKKwlrZnJl
ZShmcmVlbWUpOwogCi1vdXQ6Ci0JbXV0ZXhfdW5sb2NrKCZkZXYtPnN0cnVjdF9tdXRleCk7CisJ
LyoKKwkgKiBUT0RPOiBJZGVhbGx5IHdlIHJlYWxseSB3YW50IGEgR1BVIHJlc2V0IGhlcmUgdG8g
bWFrZSBzdXJlIGVycm9ycworCSAqIGFyZW4ndCBwcm9wYWdhdGVkLiBTaW5jZSBJIGNhbm5vdCBm
aW5kIGEgc3RhYmxlIHdheSB0byByZXNldCB0aGUgR1BVCisJICogYXQgdGhpcyBwb2ludCBpdCBp
cyBsZWZ0IGFzIGEgVE9ETy4KKwkgKi8KIAotCXJldHVybiByZXQ7CisJcmV0dXJuIGNvdW50Owog
fQogCiBzdGF0aWMgY29uc3Qgc3RydWN0IGJpbl9hdHRyaWJ1dGUgZHBmX2F0dHJzID0gewpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV90cmFjZS5oCmluZGV4IDFmMmNmNmNmYWZiNS4uN2VmN2ExZTE2NjRjIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3RyYWNlLmgKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV90cmFjZS5oCkBAIC05NTIsNyArOTUyLDcgQEAgREVDTEFSRV9F
VkVOVF9DTEFTUyhpOTE1X2NvbnRleHQsCiAJVFBfZmFzdF9hc3NpZ24oCiAJCQlfX2VudHJ5LT5k
ZXYgPSBjdHgtPmk5MTUtPmRybS5wcmltYXJ5LT5pbmRleDsKIAkJCV9fZW50cnktPmN0eCA9IGN0
eDsKLQkJCV9fZW50cnktPnZtID0gY3R4LT52bTsKKwkJCV9fZW50cnktPnZtID0gcmN1X2FjY2Vz
c19wb2ludGVyKGN0eC0+dm0pOwogCSksCiAKIAlUUF9wcmludGsoImRldj0ldSwgY3R4PSVwLCBj
dHhfdm09JXAiLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW0uYwppbmRl
eCAwMzQ2YzNlNWI2YjYuLmJmYTQwYTViNmQ5OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2Vs
ZnRlc3RzL2k5MTVfZ2VtLmMKQEAgLTEzOCwxMSArMTM4LDkgQEAgc3RhdGljIGludCBpZ3RfZ2Vt
X3N1c3BlbmQodm9pZCAqYXJnKQogCQlyZXR1cm4gUFRSX0VSUihmaWxlKTsKIAogCWVyciA9IC1F
Tk9NRU07Ci0JbXV0ZXhfbG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJY3R4ID0gbGl2
ZV9jb250ZXh0KGk5MTUsIGZpbGUpOwogCWlmICghSVNfRVJSKGN0eCkpCiAJCWVyciA9IHN3aXRj
aF90b19jb250ZXh0KGk5MTUsIGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0
X211dGV4KTsKIAlpZiAoZXJyKQogCQlnb3RvIG91dDsKIApAQCAtMTU3LDkgKzE1NSw3IEBAIHN0
YXRpYyBpbnQgaWd0X2dlbV9zdXNwZW5kKHZvaWQgKmFyZykKIAogCXBtX3Jlc3VtZShpOTE1KTsK
IAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWVyciA9IHN3aXRjaF90
b19jb250ZXh0KGk5MTUsIGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKIG91dDoKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAlyZXR1cm4gZXJyOwpA
QCAtMTc3LDExICsxNzMsOSBAQCBzdGF0aWMgaW50IGlndF9nZW1faGliZXJuYXRlKHZvaWQgKmFy
ZykKIAkJcmV0dXJuIFBUUl9FUlIoZmlsZSk7CiAKIAllcnIgPSAtRU5PTUVNOwotCW11dGV4X2xv
Y2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWN0eCA9IGxpdmVfY29udGV4dChpOTE1LCBm
aWxlKTsKIAlpZiAoIUlTX0VSUihjdHgpKQogCQllcnIgPSBzd2l0Y2hfdG9fY29udGV4dChpOTE1
LCBjdHgpOwotCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJaWYgKGVy
cikKIAkJZ290byBvdXQ7CiAKQEAgLTE5Niw5ICsxOTAsNyBAQCBzdGF0aWMgaW50IGlndF9nZW1f
aGliZXJuYXRlKHZvaWQgKmFyZykKIAogCXBtX3Jlc3VtZShpOTE1KTsKIAotCW11dGV4X2xvY2so
Jmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCWVyciA9IHN3aXRjaF90b19jb250ZXh0KGk5MTUs
IGN0eCk7Ci0JbXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIG91dDoKIAlt
b2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKIAlyZXR1cm4gZXJyOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2V2aWN0LmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV9nZW1fZXZpY3QuYwppbmRleCBmMzlmMDI4MmU3OGMu
LjBhZjlhNThkMDExZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3Rz
L2k5MTVfZ2VtX2V2aWN0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2k5
MTVfZ2VtX2V2aWN0LmMKQEAgLTQ3Myw3ICs0NzMsNiBAQCBzdGF0aWMgaW50IGlndF9ldmljdF9j
b250ZXh0cyh2b2lkICphcmcpCiAJCX0KIAogCQljb3VudCA9IDA7Ci0JCW11dGV4X2xvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCQlvbnN0YWNrX2ZlbmNlX2luaXQoJmZlbmNlKTsKIAkJ
ZG8gewogCQkJc3RydWN0IGk5MTVfcmVxdWVzdCAqcnE7CkBAIC01MTAsOCArNTA5LDYgQEAgc3Rh
dGljIGludCBpZ3RfZXZpY3RfY29udGV4dHModm9pZCAqYXJnKQogCQkJY291bnQrKzsKIAkJCWVy
ciA9IDA7CiAJCX0gd2hpbGUoMSk7Ci0JCW11dGV4X3VubG9jaygmaTkxNS0+ZHJtLnN0cnVjdF9t
dXRleCk7Ci0KIAkJb25zdGFja19mZW5jZV9maW5pKCZmZW5jZSk7CiAJCXByX2luZm8oIlN1Ym1p
dHRlZCAlbHUgY29udGV4dHMvcmVxdWVzdHMgb24gJXNcbiIsCiAJCQljb3VudCwgZW5naW5lLT5u
YW1lKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dl
bV9ndHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYwpp
bmRleCBlNDBlNmNmYTUxZjEuLjY4MTQ2YzZhM2I4NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2k5MTVfZ2VtX2d0dC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L3NlbGZ0ZXN0cy9pOTE1X2dlbV9ndHQuYwpAQCAtMTI0Niw2ICsxMjQ2LDcgQEAgc3RhdGlj
IGludCBleGVyY2lzZV9tb2NrKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1LAogCQkJCSAg
ICAgdW5zaWduZWQgbG9uZyBlbmRfdGltZSkpCiB7CiAJY29uc3QgdTY0IGxpbWl0ID0gdG90YWxy
YW1fcGFnZXMoKSA8PCBQQUdFX1NISUZUOworCXN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
OwogCXN0cnVjdCBpOTE1X2dlbV9jb250ZXh0ICpjdHg7CiAJSUdUX1RJTUVPVVQoZW5kX3RpbWUp
OwogCWludCBlcnI7CkBAIC0xMjU0LDcgKzEyNTUsOSBAQCBzdGF0aWMgaW50IGV4ZXJjaXNlX21v
Y2soc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUsCiAJaWYgKCFjdHgpCiAJCXJldHVybiAt
RU5PTUVNOwogCi0JZXJyID0gZnVuYyhpOTE1LCBjdHgtPnZtLCAwLCBtaW4oY3R4LT52bS0+dG90
YWwsIGxpbWl0KSwgZW5kX3RpbWUpOworCXZtID0gaTkxNV9nZW1fY29udGV4dF9nZXRfdm1fcmN1
KGN0eCk7CisJZXJyID0gZnVuYyhpOTE1LCB2bSwgMCwgbWluKHZtLT50b3RhbCwgbGltaXQpLCBl
bmRfdGltZSk7CisJaTkxNV92bV9wdXQodm0pOwogCiAJbW9ja19jb250ZXh0X2Nsb3NlKGN0eCk7
CiAJcmV0dXJuIGVycjsKQEAgLTE4MDEsNyArMTgwNCw3IEBAIHN0YXRpYyBpbnQgaWd0X2NzX3Rs
Yih2b2lkICphcmcpCiAJCWdvdG8gb3V0X3VubG9jazsKIAl9CiAKLQl2bSA9IGN0eC0+dm07CisJ
dm0gPSBpOTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4KTsKIAlpZiAoIXZtKQogCQlnb3Rv
IG91dF91bmxvY2s7CiAKQEAgLTE4MDksNyArMTgxMiw3IEBAIHN0YXRpYyBpbnQgaWd0X2NzX3Rs
Yih2b2lkICphcmcpCiAJYmJlID0gaTkxNV9nZW1fb2JqZWN0X2NyZWF0ZV9pbnRlcm5hbChpOTE1
LCBQQUdFX1NJWkUpOwogCWlmIChJU19FUlIoYmJlKSkgewogCQllcnIgPSBQVFJfRVJSKGJiZSk7
Ci0JCWdvdG8gb3V0X3VubG9jazsKKwkJZ290byBvdXRfdm07CiAJfQogCiAJYmF0Y2ggPSBpOTE1
X2dlbV9vYmplY3RfcGluX21hcChiYmUsIEk5MTVfTUFQX1dDKTsKQEAgLTIwMTQsNiArMjAxNyw4
IEBAIHN0YXRpYyBpbnQgaWd0X2NzX3RsYih2b2lkICphcmcpCiAJaTkxNV9nZW1fb2JqZWN0X3B1
dChhY3QpOwogb3V0X3B1dF9iYmU6CiAJaTkxNV9nZW1fb2JqZWN0X3B1dChiYmUpOworb3V0X3Zt
OgorCWk5MTVfdm1fcHV0KHZtKTsKIG91dF91bmxvY2s6CiAJbXV0ZXhfdW5sb2NrKCZpOTE1LT5k
cm0uc3RydWN0X211dGV4KTsKIAltb2NrX2ZpbGVfZnJlZShpOTE1LCBmaWxlKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3JlcXVlc3QuYwppbmRleCBkN2Q2OGM2YTZi
ZDUuLjA4OTdhN2IwNDk0NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRl
c3RzL2k5MTVfcmVxdWVzdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9p
OTE1X3JlcXVlc3QuYwpAQCAtMTgxLDkgKzE4MSw3IEBAIHN0YXRpYyBpbnQgaWd0X3JlcXVlc3Rf
cmV3aW5kKHZvaWQgKmFyZykKIAlzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2U7CiAJaW50IGVyciA9
IC1FSU5WQUw7CiAKLQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAljdHhb
MF0gPSBtb2NrX2NvbnRleHQoaTkxNSwgIkEiKTsKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5z
dHJ1Y3RfbXV0ZXgpOwogCiAJY2UgPSBpOTE1X2dlbV9jb250ZXh0X2dldF9lbmdpbmUoY3R4WzBd
LCBSQ1MwKTsKIAlHRU1fQlVHX09OKElTX0VSUihjZSkpOwpAQCAtMTk3LDkgKzE5NSw3IEBAIHN0
YXRpYyBpbnQgaWd0X3JlcXVlc3RfcmV3aW5kKHZvaWQgKmFyZykKIAlpOTE1X3JlcXVlc3RfZ2V0
KHJlcXVlc3QpOwogCWk5MTVfcmVxdWVzdF9hZGQocmVxdWVzdCk7CiAKLQltdXRleF9sb2NrKCZp
OTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAljdHhbMV0gPSBtb2NrX2NvbnRleHQoaTkxNSwgIkIi
KTsKLQltdXRleF91bmxvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwogCiAJY2UgPSBpOTE1
X2dlbV9jb250ZXh0X2dldF9lbmdpbmUoY3R4WzFdLCBSQ1MwKTsKIAlHRU1fQlVHX09OKElTX0VS
UihjZSkpOwpAQCAtNDM4LDkgKzQzNCw3IEBAIHN0YXRpYyBpbnQgbW9ja19icmVhZGNydW1ic19z
bW9rZXRlc3Qodm9pZCAqYXJnKQogCX0KIAogCWZvciAobiA9IDA7IG4gPCB0Lm5jb250ZXh0czsg
bisrKSB7Ci0JCW11dGV4X2xvY2soJnQuZW5naW5lLT5pOTE1LT5kcm0uc3RydWN0X211dGV4KTsK
IAkJdC5jb250ZXh0c1tuXSA9IG1vY2tfY29udGV4dCh0LmVuZ2luZS0+aTkxNSwgIm1vY2siKTsK
LQkJbXV0ZXhfdW5sb2NrKCZ0LmVuZ2luZS0+aTkxNS0+ZHJtLnN0cnVjdF9tdXRleCk7CiAJCWlm
ICghdC5jb250ZXh0c1tuXSkgewogCQkJcmV0ID0gLUVOT01FTTsKIAkJCWdvdG8gb3V0X2NvbnRl
eHRzOwpAQCAtNzM0LDkgKzcyOCw5IEBAIHN0YXRpYyBpbnQgbGl2ZV9lbXB0eV9yZXF1ZXN0KHZv
aWQgKmFyZykKIHN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKnJlY3Vyc2l2ZV9iYXRjaChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIHsKIAlzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqY3R4
ID0gaTkxNS0+a2VybmVsX2NvbnRleHQ7Ci0Jc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0g
PSBjdHgtPnZtID86ICZpOTE1LT5nZ3R0LnZtOwogCXN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0
ICpvYmo7CiAJY29uc3QgaW50IGdlbiA9IElOVEVMX0dFTihpOTE1KTsKKwlzdHJ1Y3QgaTkxNV9h
ZGRyZXNzX3NwYWNlICp2bTsKIAlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAl1MzIgKmNtZDsKIAlp
bnQgZXJyOwpAQCAtNzQ1LDcgKzczOSw5IEBAIHN0YXRpYyBzdHJ1Y3QgaTkxNV92bWEgKnJlY3Vy
c2l2ZV9iYXRjaChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSkKIAlpZiAoSVNfRVJSKG9i
aikpCiAJCXJldHVybiBFUlJfQ0FTVChvYmopOwogCisJdm0gPSBpOTE1X2dlbV9jb250ZXh0X2dl
dF92bV9yY3UoY3R4KTsKIAl2bWEgPSBpOTE1X3ZtYV9pbnN0YW5jZShvYmosIHZtLCBOVUxMKTsK
KwlpOTE1X3ZtX3B1dCh2bSk7CiAJaWYgKElTX0VSUih2bWEpKSB7CiAJCWVyciA9IFBUUl9FUlIo
dm1hKTsKIAkJZ290byBlcnI7CkBAIC0xMjIwLDkgKzEyMTYsNyBAQCBzdGF0aWMgaW50IGxpdmVf
YnJlYWRjcnVtYnNfc21va2V0ZXN0KHZvaWQgKmFyZykKIAl9CiAKIAlmb3IgKG4gPSAwOyBuIDwg
dFswXS5uY29udGV4dHM7IG4rKykgewotCQltdXRleF9sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211
dGV4KTsKIAkJdFswXS5jb250ZXh0c1tuXSA9IGxpdmVfY29udGV4dChpOTE1LCBmaWxlKTsKLQkJ
bXV0ZXhfdW5sb2NrKCZpOTE1LT5kcm0uc3RydWN0X211dGV4KTsKIAkJaWYgKCF0WzBdLmNvbnRl
eHRzW25dKSB7CiAJCQlyZXQgPSAtRU5PTUVNOwogCQkJZ290byBvdXRfY29udGV4dHM7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEuYyBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pOTE1X3ZtYS5jCmluZGV4IGFjMWZmNTU4ZWI5MC4u
NThiNWY0MGEwN2RkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
aTkxNV92bWEuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvaTkxNV92bWEu
YwpAQCAtMjQsNiArMjQsNyBAQAogCiAjaW5jbHVkZSA8bGludXgvcHJpbWVfbnVtYmVycy5oPgog
CisjaW5jbHVkZSAiZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaCIKICNpbmNsdWRlICJnZW0vc2VsZnRl
c3RzL21vY2tfY29udGV4dC5oIgogCiAjaW5jbHVkZSAiaTkxNV9zY2F0dGVybGlzdC5oIgpAQCAt
MzgsNyArMzksNyBAQCBzdGF0aWMgYm9vbCBhc3NlcnRfdm1hKHN0cnVjdCBpOTE1X3ZtYSAqdm1h
LAogewogCWJvb2wgb2sgPSB0cnVlOwogCi0JaWYgKHZtYS0+dm0gIT0gY3R4LT52bSkgeworCWlm
ICh2bWEtPnZtICE9IHJjdV9hY2Nlc3NfcG9pbnRlcihjdHgtPnZtKSkgewogCQlwcl9lcnIoIlZN
QSBjcmVhdGVkIHdpdGggd3JvbmcgVk1cbiIpOwogCQlvayA9IGZhbHNlOwogCX0KQEAgLTExMywx
MSArMTE0LDEzIEBAIHN0YXRpYyBpbnQgY3JlYXRlX3ZtYXMoc3RydWN0IGRybV9pOTE1X3ByaXZh
dGUgKmk5MTUsCiAJbGlzdF9mb3JfZWFjaF9lbnRyeShvYmosIG9iamVjdHMsIHN0X2xpbmspIHsK
IAkJZm9yIChwaW5uZWQgPSAwOyBwaW5uZWQgPD0gMTsgcGlubmVkKyspIHsKIAkJCWxpc3RfZm9y
X2VhY2hfZW50cnkoY3R4LCBjb250ZXh0cywgbGluaykgewotCQkJCXN0cnVjdCBpOTE1X2FkZHJl
c3Nfc3BhY2UgKnZtID0gY3R4LT52bTsKKwkJCQlzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2
bTsKIAkJCQlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKIAkJCQlpbnQgZXJyOwogCisJCQkJdm0gPSBp
OTE1X2dlbV9jb250ZXh0X2dldF92bV9yY3UoY3R4KTsKIAkJCQl2bWEgPSBjaGVja2VkX3ZtYV9p
bnN0YW5jZShvYmosIHZtLCBOVUxMKTsKKwkJCQlpOTE1X3ZtX3B1dCh2bSk7CiAJCQkJaWYgKElT
X0VSUih2bWEpKQogCQkJCQlyZXR1cm4gUFRSX0VSUih2bWEpOwogCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19nZW1fZGV2aWNlLmMgYi9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9zZWxmdGVzdHMvbW9ja19nZW1fZGV2aWNlLmMKaW5kZXggNGU2Y2RlMGQ0ODU5
Li4zMzVmMzdiYTk4ZGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0
cy9tb2NrX2dlbV9kZXZpY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxmdGVzdHMv
bW9ja19nZW1fZGV2aWNlLmMKQEAgLTU5LDExICs1OSw5IEBAIHN0YXRpYyB2b2lkIG1vY2tfZGV2
aWNlX3JlbGVhc2Uoc3RydWN0IGRybV9kZXZpY2UgKmRldikKIAogCWk5MTVfZ2VtX2RyYWluX3dv
cmtxdWV1ZShpOTE1KTsKIAotCW11dGV4X2xvY2soJmk5MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOwog
CWZvcl9lYWNoX2VuZ2luZShlbmdpbmUsIGk5MTUsIGlkKQogCQltb2NrX2VuZ2luZV9mcmVlKGVu
Z2luZSk7Ci0JaTkxNV9nZW1fY29udGV4dHNfZmluaShpOTE1KTsKLQltdXRleF91bmxvY2soJmk5
MTUtPmRybS5zdHJ1Y3RfbXV0ZXgpOworCWk5MTVfZ2VtX2RyaXZlcl9yZWxlYXNlX19jb250ZXh0
cyhpOTE1KTsKIAogCWludGVsX3RpbWVsaW5lc19maW5pKGk5MTUpOwogCkBAIC0yMDYsNyArMjA0
LDcgQEAgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKm1vY2tfZ2VtX2RldmljZSh2b2lkKQogCXJl
dHVybiBpOTE1OwogCiBlcnJfY29udGV4dDoKLQlpOTE1X2dlbV9jb250ZXh0c19maW5pKGk5MTUp
OworCWk5MTVfZ2VtX2RyaXZlcl9yZWxlYXNlX19jb250ZXh0cyhpOTE1KTsKIGVycl9lbmdpbmU6
CiAJbW9ja19lbmdpbmVfZnJlZShpOTE1LT5lbmdpbmVbUkNTMF0pOwogZXJyX3VubG9jazoKLS0g
CjIuMjMuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
SW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

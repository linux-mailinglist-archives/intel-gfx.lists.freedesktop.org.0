Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B9A91393DF4
	for <lists+intel-gfx@lfdr.de>; Fri, 28 May 2021 09:33:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EF0DC6E086;
	Fri, 28 May 2021 07:33:31 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga11.intel.com (mga11.intel.com [192.55.52.93])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 9BDF56E086;
 Fri, 28 May 2021 07:33:30 +0000 (UTC)
IronPort-SDR: 2WKnYVhNwElGZwdO4C4Bd8xT1O0c9F61W0yoCLz4hjn9ru+k4JpMXNyZRLamJ9Nm3w65lfcDQj
 pWBekr0o4BHw==
X-IronPort-AV: E=McAfee;i="6200,9189,9997"; a="199873450"
X-IronPort-AV: E=Sophos;i="5.83,229,1616482800"; d="scan'208";a="199873450"
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by fmsmga102.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 28 May 2021 00:33:27 -0700
IronPort-SDR: +2flAWMyfi+BrvSi08Z3Dbb6bBW5eJxZIvEZippad5kt55ymfG6l0OOxjFrdffwEbjIJ5+fXR1
 MvDOn/85UQxg==
X-IronPort-AV: E=Sophos;i="5.83,229,1616482800"; d="scan'208";a="443906591"
Received: from jdahlin-mobl1.ger.corp.intel.com ([10.249.254.92])
 by orsmga008-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 28 May 2021 00:33:26 -0700
Message-ID: <169de7a9af59135d1b63278b3b69a892ecfd4549.camel@linux.intel.com>
From: Thomas =?ISO-8859-1?Q?Hellstr=F6m?= <thomas.hellstrom@linux.intel.com>
To: Christian =?ISO-8859-1?Q?K=F6nig?= <christian.koenig@amd.com>, 
 intel-gfx@lists.freedesktop.org, dri-devel@lists.freedesktop.org
Date: Fri, 28 May 2021 09:33:23 +0200
In-Reply-To: <1dffe27a-bfc6-075e-f198-0c47cd282638@amd.com>
References: <20210527141923.1962350-1-thomas.hellstrom@linux.intel.com>
 <883eab20-4326-d14a-2eb0-5e95f174a0d9@amd.com>
 <8b3382726763050334a6cb214f7ba560eebf8f28.camel@linux.intel.com>
 <e594a1d45b22e92e052d1070beadc5928e5c0ba1.camel@linux.intel.com>
 <17037c04-603c-44c8-84a2-bce49c0e4f0c@amd.com>
 <97b0903d941c05a8877579749c6a2ea6ec107d0b.camel@linux.intel.com>
 <1dffe27a-bfc6-075e-f198-0c47cd282638@amd.com>
User-Agent: Evolution 3.38.4 (3.38.4-1.fc33) 
MIME-Version: 1.0
Subject: Re: [Intel-gfx] [RFC PATCH] drm/ttm: Fix swapping dereferences of
 freed memory
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

T24gRnJpLCAyMDIxLTA1LTI4IGF0IDA5OjE2ICswMjAwLCBDaHJpc3RpYW4gS8O2bmlnIHdyb3Rl
Ogo+IEFtIDI3LjA1LjIxIHVtIDE3OjUxIHNjaHJpZWIgVGhvbWFzIEhlbGxzdHLDtm06Cj4gPiBP
biBUaHUsIDIwMjEtMDUtMjcgYXQgMTc6MzIgKzAyMDAsIENocmlzdGlhbiBLw7ZuaWcgd3JvdGU6
Cj4gPiA+IEFtIDI3LjA1LjIxIHVtIDE3OjA1IHNjaHJpZWIgVGhvbWFzIEhlbGxzdHLDtm06Cj4g
PiA+ID4gT24gVGh1LCAyMDIxLTA1LTI3IGF0IDE3OjAxICswMjAwLCBUaG9tYXMgSGVsbHN0csO2
bSB3cm90ZToKPiA+ID4gPiA+IE9uIFRodSwgMjAyMS0wNS0yNyBhdCAxNjo1NCArMDIwMCwgQ2hy
aXN0aWFuIEvDtm5pZyB3cm90ZToKPiA+ID4gPiA+ID4gQW0gMjcuMDUuMjEgdW0gMTY6MTkgc2No
cmllYiBUaG9tYXMgSGVsbHN0csO2bToKPiA+ID4gPiA+ID4gPiBUaGUgc3dhcHBpbmcgY29kZSB3
YXMgZGVyZWZlcmVuY2UgYm8tPnR0bSBwb2ludGVycwo+ID4gPiA+ID4gPiA+IHdpdGhvdXQKPiA+
ID4gPiA+ID4gPiBoYXZpbmcKPiA+ID4gPiA+ID4gPiB0aGUKPiA+ID4gPiA+ID4gPiBkbWEtcmVz
diBsb2NrIGhlbGQuIEFsc28gaXQgbWlnaHQgdHJ5IHRvIHN3YXAgb3V0Cj4gPiA+ID4gPiA+ID4g
dW5wb3B1bGF0ZWQKPiA+ID4gPiA+ID4gPiBib3MuCj4gPiA+ID4gPiA+ID4gCj4gPiA+ID4gPiA+
ID4gRml4IHRoaXMgYnkgbW92aW5nIHRoZSBiby0+dHRtIGRlcmVmZXJlbmNlIHVudGlsIHdlIGhh
dmUKPiA+ID4gPiA+ID4gPiB0aGUKPiA+ID4gPiA+ID4gPiByZXNlcnZhdGlvbgo+ID4gPiA+ID4g
PiA+IGxvY2suIENoZWNrIHRoYXQgdGhlIHR0bV90dCBpcyBwb3B1bGF0ZWQgYWZ0ZXIgdGhlCj4g
PiA+ID4gPiA+ID4gc3dhcF9ub3RpZnkKPiA+ID4gPiA+ID4gPiBjYWxsYmFjay4KPiA+ID4gPiA+
ID4gPiAKPiA+ID4gPiA+ID4gPiBTaWduZWQtb2ZmLWJ5OiBUaG9tYXMgSGVsbHN0csO2bQo+ID4g
PiA+ID4gPiA+IDx0aG9tYXMuaGVsbHN0cm9tQGxpbnV4LmludGVsLmNvbT4KPiA+ID4gPiA+ID4g
PiAtLS0KPiA+ID4gPiA+ID4gPiDCoMKgwqAgZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm8uY8Kg
wqDCoMKgIHwgMTYKPiA+ID4gPiA+ID4gPiArKysrKysrKysrKysrKystCj4gPiA+ID4gPiA+ID4g
wqDCoMKgIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2RldmljZS5jIHzCoCA4ICsrKy0tLS0tCj4g
PiA+ID4gPiA+ID4gwqDCoMKgIDIgZmlsZXMgY2hhbmdlZCwgMTggaW5zZXJ0aW9ucygrKSwgNiBk
ZWxldGlvbnMoLSkKPiA+ID4gPiA+ID4gPiAKPiA+ID4gPiA+ID4gPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL3R0bS90dG1fYm8uYwo+ID4gPiA+ID4gPiA+IGIvZHJpdmVycy9ncHUvZHJt
L3R0bS90dG1fYm8uYwo+ID4gPiA+ID4gPiA+IGluZGV4IDlmNTM1MDZhODJmYy4uODYyMTNkMzc2
NTdiIDEwMDY0NAo+ID4gPiA+ID4gPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2Jv
LmMKPiA+ID4gPiA+ID4gPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jCj4gPiA+
ID4gPiA+ID4gQEAgLTExNjMsNiArMTE2MywxNiBAQCBpbnQgdHRtX2JvX3N3YXBvdXQoc3RydWN0
Cj4gPiA+ID4gPiA+ID4gdHRtX2J1ZmZlcl9vYmplY3QKPiA+ID4gPiA+ID4gPiAqYm8sIHN0cnVj
dCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4LAo+ID4gPiA+ID4gPiA+IMKgwqDCoMKgwqDCoMKgwqDC
oMKgaWYgKCF0dG1fYm9fZXZpY3Rfc3dhcG91dF9hbGxvd2FibGUoYm8sIGN0eCwKPiA+ID4gPiA+
ID4gPiAmcGxhY2UsCj4gPiA+ID4gPiA+ID4gJmxvY2tlZCwgTlVMTCkpCj4gPiA+ID4gPiA+ID4g
wqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgcmV0dXJuIC1FQlVTWTsKPiA+ID4g
PiA+ID4gPiDCoMKgwqAgCj4gPiA+ID4gPiA+ID4gK8KgwqDCoMKgwqDCoMKgZG1hX3Jlc3ZfYXNz
ZXJ0X2hlbGQoYm8tPmJhc2UucmVzdik7Cj4gPiA+ID4gPiA+ID4gKwo+ID4gPiA+ID4gPiA+ICvC
oMKgwqDCoMKgwqDCoGlmICghYm8tPnR0bSB8fAo+ID4gPiA+ID4gPiA+ICvCoMKgwqDCoMKgwqDC
oMKgwqDCoCBiby0+dHRtLT5wYWdlX2ZsYWdzICYgVFRNX1BBR0VfRkxBR19TRyB8fAo+ID4gPiA+
ID4gPiA+ICvCoMKgwqDCoMKgwqDCoMKgwqDCoCBiby0+dHRtLT5wYWdlX2ZsYWdzICYgVFRNX1BB
R0VfRkxBR19TV0FQUEVEKQo+ID4gPiA+ID4gPiA+IHsKPiA+ID4gPiA+ID4gPiArwqDCoMKgwqDC
oMKgwqDCoMKgwqDCoMKgwqDCoMKgaWYgKGxvY2tlZCkKPiA+ID4gPiA+ID4gPiArwqDCoMKgwqDC
oMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoGRtYV9yZXN2X3VubG9jayhiby0+
YmFzZS5yZXN2KTsKPiA+ID4gPiA+ID4gPiArwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKg
cmV0dXJuIC1FQlVTWTsKPiA+ID4gPiA+ID4gPiArwqDCoMKgwqDCoMKgwqB9Cj4gPiA+ID4gPiA+
ID4gKwo+ID4gPiA+ID4gPiA+IMKgwqDCoMKgwqDCoMKgwqDCoMKgaWYgKCF0dG1fYm9fZ2V0X3Vu
bGVzc196ZXJvKGJvKSkgewo+ID4gPiA+ID4gPiA+IMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKg
wqDCoMKgwqDCoGlmIChsb2NrZWQpCj4gPiA+ID4gPiA+ID4gwqDCoMKgwqDCoMKgwqDCoMKgwqDC
oMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoGRtYV9yZXN2X3VubG9jayhiby0+YmFzZS5y
ZXN2KTsKPiA+ID4gPiA+ID4gPiBAQCAtMTIxNSw3ICsxMjI1LDggQEAgaW50IHR0bV9ib19zd2Fw
b3V0KHN0cnVjdAo+ID4gPiA+ID4gPiA+IHR0bV9idWZmZXJfb2JqZWN0Cj4gPiA+ID4gPiA+ID4g
KmJvLCBzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0eCwKPiA+ID4gPiA+ID4gPiDCoMKgwqDC
oMKgwqDCoMKgwqDCoGlmIChiby0+YmRldi0+ZnVuY3MtPnN3YXBfbm90aWZ5KQo+ID4gPiA+ID4g
PiA+IMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoMKgwqDCoGJvLT5iZGV2LT5mdW5jcy0+
c3dhcF9ub3RpZnkoYm8pOwo+ID4gPiA+ID4gPiA+IMKgwqDCoCAKPiA+ID4gPiA+ID4gPiAtwqDC
oMKgwqDCoMKgwqByZXQgPSB0dG1fdHRfc3dhcG91dChiby0+YmRldiwgYm8tPnR0bSwKPiA+ID4g
PiA+ID4gPiBnZnBfZmxhZ3MpOwo+ID4gPiA+ID4gPiA+ICvCoMKgwqDCoMKgwqDCoGlmICh0dG1f
dHRfaXNfcG9wdWxhdGVkKGJvLT50dG0pKQo+ID4gPiA+ID4gPiA+ICvCoMKgwqDCoMKgwqDCoMKg
wqDCoMKgwqDCoMKgwqByZXQgPSB0dG1fdHRfc3dhcG91dChiby0+YmRldiwgYm8tPnR0bSwKPiA+
ID4gPiA+ID4gPiBnZnBfZmxhZ3MpOwo+ID4gPiA+ID4gPiBFeGFjdGx5IHRoYXQgaXMgd2hhdCBJ
IHdvbid0IHJlY29tbWVuZC4gV2Ugd291bGQgdHJ5IHRvCj4gPiA+ID4gPiA+IHN3YXAKPiA+ID4g
PiA+ID4gb3V0Cj4gPiA+ID4gPiA+IHRoZQo+ID4gPiA+ID4gPiBzYW1lIEJPIG92ZXIgYW5kIG92
ZXIgYWdhaW4gd2l0aCB0aGF0Lgo+ID4gPiA+ID4gQnV0IHdlIHdvdWxkbid0IHNpbmNlIHRoZSBC
TyBpcyB0YWtlbiBvZmYgdGhlIExSVSBhbmQgbmV2ZXIKPiA+ID4gPiA+IHJlLQo+ID4gPiA+ID4g
YWRkZWQsCj4gPiA+ID4gPiAKPiA+ID4gPiA+IAo+ID4gPiA+IEluIGZhY3QsIHdlJ2QgcHJvYmFi
bHkgbWlnaHQgd2FudCB0byB0YWtlIHRoZSAhYm8tPnR0bSBib3Mgb2ZmCj4gPiA+ID4gdGhlCj4g
PiA+ID4gTFJVCj4gPiA+ID4gYXMgd2VsbC4uCj4gPiA+IE5vLCB3ZSBkb24ndCB3YW50IHRvIHRh
a2UgYW55IEJPcyBvZiB0aGUgTFJVIHVubGVzcyB0aGV5IGFyZQo+ID4gPiBwaW5uZWQuCj4gPiA+
IAo+ID4gPiBBZGRpbmcgYSBUVCBvYmplY3Qgb3IgcG9wdWxhdGluZyBpdCBkb2Vzbid0IG5lY2Vz
c2FyaWx5IHB1dCB0aGUKPiA+ID4gQk8KPiA+ID4gYmFjawo+ID4gPiB0byB0aGUgTFJVLgo+ID4g
T0ssIGJ1dCBzd2FwcGVkIGJvcyBhcmUgYWxzbyB0YWtlbiBvZmYgdGhlIExSVSBsaXN0IHNvIHRo
ZXNlCj4gPiB1bnBvcHVsYXRlZCBib3MgYXJlIGp1c3QgdGFraW5nIHRoZSBzYW1lIHBhdGguIE9u
bHkgZGlmZmVyZW5jZSB0bwo+ID4gc3dhcHBlZCBpcyB0aGF0IHRoZXkgZG9uJ3QgZ2V0IHJlYWQg
YmFjayBvbiByZS1wb3B1bGF0ZSwgYnV0Cj4gPiB0eXBpY2FsbHkKPiA+IGNsZWFyZWQuCj4gPiAK
PiA+IEJ1dCB3aGF0IHdvdWxkIGJlIHRoZSBwb2ludCBvZiBrZWVwaW5nIHN3YXBwZWQtb3V0IGJv
cyBvbiB0aGUgTFJVCj4gPiBsaXN0PywgcGFydGljdWxhcmx5IHdoZW4gd2UncmUgaXRlcmF0aW5n
IHVuZGVyIGEgc3BpbmxvY2s/Cj4gPiBTaG91bGRuJ3Qgd2UgdHJ5IHRvIHJlLWFkZCB0byBMUlUg
KGlmIG5vdCBhbHJlYWR5IG9uIGFuIExSVSkganVzdAo+ID4gYmVmb3JlIHBvcHVsYXRpbmc/IFRo
ZXJlIGFyZW4ndCByZWFsbHkgdGhhdCBtYW55IGNhbGxzIGluIGNvcmUgVFRNLgo+IAo+IEkgd2Fu
dCB0byBhdm9pZCByZW1vdmluZyBCT3MgZnJvbSB0aGUgTFJVIGFzIG11Y2ggYXMgcG9zc2libGUg
c2luY2UKPiB3ZSAKPiBmb3Jnb3Qgb24gbXVsdGlwbGUgcGxhY2VzIHRoYXQgd2Ugd2FudCB0byBy
ZS1hZGQgdGhlbS4KPiAKPiBDb25jZXB0dWFsIEkgdGhpbmsgdGhlIHN3YXBwZWQgQk9zIHNob3Vs
ZCBoYXZlIGEgc2VwYXJhdGUgbWVtb3J5Cj4gZG9tYWluLCAKPiB0aGlzIHdheSB3ZSBjYW4gaWdu
b3JlIHRoZW0gY2xlYW5seSB3aGVuIHN3YXBwaW5nIHRoaW5ncyBvdXQuCgpZZXMsIHRoYXQgd291
bGQgb2YgY291cnNlIHdvcmsgYXMgd2VsbC4gS2VlcGluZyB0aGVtIG9uIHRoZSBzeXN0ZW0gTFJV
CmlzIElNTyBoaWdobHkgdW5kZXNpcmFibGUuCgo+IAo+IEdvaW5nIHRvIHBpY2sgdGhpcyBwYXRj
aCB1cCwgbW9kaWZ5aW5nIGl0IGEgYml0IG1vcmUgYW5kIHRoZW4gcHVzaGluZwo+IGl0IAo+IHRv
IGRybS1taXNjLWZpeGVzIGZvciB1cHN0cmVhbWluZy4KCk9LLCBJIGRyb3BwZWQgdGhlIFRUTSBm
aXggZm9yIHRoZSBwdXJnZS1pbi1zd2FwLW5vdGlmeSBmcm9tIHRoZSBpOTE1CnNlcmllcywgaG9w
aW5nIHRoYXQgdGhlIHJld29ya2VkIHZhcmlhbnQgb2YgdGhpcyBwYXRjaCBsYW5kcyBmaXJzdC4K
ClRoYW5rcywKVGhvbWFzCgo+IAo+IFRoYW5rcywKPiBDaHJpc3RpYW4uCj4gCj4gPiAKPiA+IC9U
aG9tYXMKPiA+IAo+ID4gCj4gPiAKPiA+IAo+ID4gCj4gPiA+IENocmlzdGlhbi4KPiA+ID4gCj4g
PiA+ID4gL1Rob21hcwo+ID4gPiA+IAo+ID4gCj4gCgoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhA
bGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxt
YW4vbGlzdGluZm8vaW50ZWwtZ2Z4Cg==

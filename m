Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 58F4D11BC19
	for <lists+intel-gfx@lfdr.de>; Wed, 11 Dec 2019 19:45:37 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 48A936EBB7;
	Wed, 11 Dec 2019 18:45:32 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga04.intel.com (mga04.intel.com [192.55.52.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 147F46EBB3
 for <intel-gfx@lists.freedesktop.org>; Wed, 11 Dec 2019 18:45:30 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by fmsmga104.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 11 Dec 2019 10:45:29 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,302,1571727600"; d="scan'208";a="216016737"
Received: from josouza-mobl.jf.intel.com (HELO josouza-MOBL.intel.com)
 ([10.24.8.163])
 by orsmga003.jf.intel.com with ESMTP; 11 Dec 2019 10:45:28 -0800
From: =?UTF-8?q?Jos=C3=A9=20Roberto=20de=20Souza?= <jose.souza@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Wed, 11 Dec 2019 10:45:21 -0800
Message-Id: <20191211184526.142413-6-jose.souza@intel.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20191211184526.142413-1-jose.souza@intel.com>
References: <20191211184526.142413-1-jose.souza@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH v2 rebased 06/11] drm/i915/display: Share
 intel_connector_needs_modeset()
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

aW50ZWxfY29ubmVjdG9yX25lZWRzX21vZGVzZXQoKSB3aWxsIGJlIHVzZWQgb3V0c2lkZSBvZgpp
bnRlbF9kaXNwbGF5LmMgaW4gYSBmdXR1cmUgcGF0Y2ggc28gaXQgd291bGQgb25seSBiZSBuZWNl
c3NhcnkgdG8KcmVtb3ZlIHRoZSBzdGF0ZSBhbmQgYWRkIHRoZSBwcm90b3R5cGUgdG8gdGhlIGhl
YWRlciBmaWxlLgoKQnV0IHdoaWxlIGF0IGl0LCBJIHNpbXBsaWZpZWQgdGhlIGFyZ3VtZW50cyBh
bmQgY2hhbmdlZCB0byBpbnRlbAp0eXBlcyBhbmQgbW92ZWQgaXQgdG8gYSBiZXR0ZXIgcGxhY2Ug
aW50ZWxfYXRvbWljLmMuCgpUaGF0IGFsbG93ZWQgdXMgdG8gY29udmVydCB0aGUgd2hvbGUKaW50
ZWxfZW5jb2RlcnNfdXBkYXRlX3ByZXBhcmUvY29tcGxldGUgdG8gaW50ZWwgdHlwZSB0b28uCgpO
byBiZWhhdmlvciBjaGFuZ2VzIGludGVuZGVkIGhlcmUuCgpDYzogVmlsbGUgU3lyasOkbMOkIDx2
aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogSm9zw6kgUm9iZXJ0
byBkZSBTb3V6YSA8am9zZS5zb3V6YUBpbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuYyAgfCAzMiArKysrKysrKysrKysKIGRyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmggIHwgIDMgKysKIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jIHwgNTMgKysrKysrLS0tLS0tLS0tLS0tLS0K
IDMgZmlsZXMgY2hhbmdlZCwgNTEgaW5zZXJ0aW9ucygrKSwgMzcgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9hdG9taWMuYyBiL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRvbWljLmMKaW5kZXggZmQwMDI2ZmMz
NjE4Li42ZTkzYTM5YTZmZWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3Bs
YXkvaW50ZWxfYXRvbWljLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9hdG9taWMuYwpAQCAtMTc0LDYgKzE3NCwzOCBAQCBpbnRlbF9kaWdpdGFsX2Nvbm5lY3Rvcl9k
dXBsaWNhdGVfc3RhdGUoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcikKIAlyZXR1cm4g
JnN0YXRlLT5iYXNlOwogfQogCisvKioKKyAqIGludGVsX2RpZ2l0YWxfY29ubmVjdG9yX25lZWRz
X21vZGVzZXQgLSBjaGVjayBpZiBjb25uZWN0b3IgbmVlZHMgYSBtb2Rlc2V0CisgKi8KK2Jvb2wK
K2ludGVsX2RpZ2l0YWxfY29ubmVjdG9yX25lZWRzX21vZGVzZXQoc3RydWN0IGludGVsX2F0b21p
Y19zdGF0ZSAqc3RhdGUsCisJCQkJICAgICAgc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQoreworCXN0cnVjdCBpbnRlbF9kaWdpdGFsX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5l
Y3Rvcl9zdGF0ZSwgKm5ld19jb25uZWN0b3Jfc3RhdGU7CisJc3RydWN0IGludGVsX2NydGMgKm9s
ZF9jcnRjLCAqbmV3X2NydGM7CisJc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0
YXRlOworCisJb2xkX2Nvbm5lY3Rvcl9zdGF0ZSA9IGludGVsX2F0b21pY19nZXRfb2xkX2Nvbm5l
Y3Rvcl9zdGF0ZShzdGF0ZSwKKwkJCQkJCQkJICAgY29ubmVjdG9yKTsKKwlpZiAob2xkX2Nvbm5l
Y3Rvcl9zdGF0ZS0+YmFzZS5jcnRjKQorCQlvbGRfY3J0YyA9IHRvX2ludGVsX2NydGMob2xkX2Nv
bm5lY3Rvcl9zdGF0ZS0+YmFzZS5jcnRjKTsKKwllbHNlCisJCW9sZF9jcnRjID0gTlVMTDsKKwor
CW5ld19jb25uZWN0b3Jfc3RhdGUgPSBpbnRlbF9hdG9taWNfZ2V0X25ld19jb25uZWN0b3Jfc3Rh
dGUoc3RhdGUsCisJCQkJCQkJCSAgIGNvbm5lY3Rvcik7CisJaWYgKG5ld19jb25uZWN0b3Jfc3Rh
dGUtPmJhc2UuY3J0YykgeworCQluZXdfY3J0YyA9IHRvX2ludGVsX2NydGMobmV3X2Nvbm5lY3Rv
cl9zdGF0ZS0+YmFzZS5jcnRjKTsKKwkJbmV3X2NydGNfc3RhdGUgPSBpbnRlbF9hdG9taWNfZ2V0
X25ld19jcnRjX3N0YXRlKHN0YXRlLCBuZXdfY3J0Yyk7CisJfSBlbHNlIHsKKwkJbmV3X2NydGNf
c3RhdGUgPSBOVUxMOworCQluZXdfY3J0YyA9IE5VTEw7CisJfQorCisJcmV0dXJuIG5ld19jcnRj
ICE9IG9sZF9jcnRjIHx8CisJICAgICAgIChuZXdfY3J0YyAmJiBkcm1fYXRvbWljX2NydGNfbmVl
ZHNfbW9kZXNldCgmbmV3X2NydGNfc3RhdGUtPnVhcGkpKTsKK30KKwogLyoqCiAgKiBpbnRlbF9j
cnRjX2R1cGxpY2F0ZV9zdGF0ZSAtIGR1cGxpY2F0ZSBjcnRjIHN0YXRlCiAgKiBAY3J0YzogZHJt
IGNydGMKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfYXRv
bWljLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5oCmluZGV4
IDdiNDk2MjM0MTliYS4uYmE5Y2MyOWE1ODY1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX2F0b21pYy5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfYXRvbWljLmgKQEAgLTE3LDYgKzE3LDcgQEAgc3RydWN0IGRybV9kZXZpY2U7
CiBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZTsKIHN0cnVjdCBkcm1fcHJvcGVydHk7CiBzdHJ1Y3Qg
aW50ZWxfYXRvbWljX3N0YXRlOworc3RydWN0IGludGVsX2Nvbm5lY3RvcjsKIHN0cnVjdCBpbnRl
bF9jcnRjOwogc3RydWN0IGludGVsX2NydGNfc3RhdGU7CiAKQEAgLTMyLDYgKzMzLDggQEAgaW50
IGludGVsX2RpZ2l0YWxfY29ubmVjdG9yX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubiwKIAkJCQkJIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSk7CiBzdHJ1Y3Qg
ZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqCiBpbnRlbF9kaWdpdGFsX2Nvbm5lY3Rvcl9kdXBsaWNhdGVf
c3RhdGUoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3Rvcik7Citib29sIGludGVsX2RpZ2l0
YWxfY29ubmVjdG9yX25lZWRzX21vZGVzZXQoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3Rh
dGUsCisJCQkJCSAgIHN0cnVjdCBpbnRlbF9jb25uZWN0b3IgKmNvbm5lY3Rvcik7CiAKIHN0cnVj
dCBkcm1fY3J0Y19zdGF0ZSAqaW50ZWxfY3J0Y19kdXBsaWNhdGVfc3RhdGUoc3RydWN0IGRybV9j
cnRjICpjcnRjKTsKIHZvaWQgaW50ZWxfY3J0Y19kZXN0cm95X3N0YXRlKHN0cnVjdCBkcm1fY3J0
YyAqY3J0YywKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxf
ZGlzcGxheS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kaXNwbGF5LmMK
aW5kZXggYjRlNDRkM2NkMjc1Li4zOWIwMGExOWQ3NTIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2Rpc3BsYXkvaW50ZWxfZGlzcGxheS5jCkBAIC02MTg1LDcxICs2MTg1LDUwIEBAIGludGVs
X2Nvbm5lY3Rvcl9wcmltYXJ5X2VuY29kZXIoc3RydWN0IGludGVsX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQogCXJldHVybiBlbmNvZGVyOwogfQogCi1zdGF0aWMgYm9vbAotaW50ZWxfY29ubmVjdG9y
X25lZWRzX21vZGVzZXQoc3RydWN0IGludGVsX2F0b21pY19zdGF0ZSAqc3RhdGUsCi0JCQkgICAg
ICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGUsCi0JCQkg
ICAgICBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqbmV3X2Nvbm5fc3RhdGUpCi17
Ci0Jc3RydWN0IGludGVsX2NydGMgKm9sZF9jcnRjID0gb2xkX2Nvbm5fc3RhdGUtPmNydGMgPwot
CQkJCSAgICAgIHRvX2ludGVsX2NydGMob2xkX2Nvbm5fc3RhdGUtPmNydGMpIDogTlVMTDsKLQlz
dHJ1Y3QgaW50ZWxfY3J0YyAqbmV3X2NydGMgPSBuZXdfY29ubl9zdGF0ZS0+Y3J0YyA/Ci0JCQkJ
ICAgICAgdG9faW50ZWxfY3J0YyhuZXdfY29ubl9zdGF0ZS0+Y3J0YykgOiBOVUxMOwotCi0JcmV0
dXJuIG5ld19jcnRjICE9IG9sZF9jcnRjIHx8Ci0JICAgICAgIChuZXdfY3J0YyAmJgotCQluZWVk
c19tb2Rlc2V0KGludGVsX2F0b21pY19nZXRfbmV3X2NydGNfc3RhdGUoc3RhdGUsIG5ld19jcnRj
KSkpOwotfQotCiBzdGF0aWMgdm9pZCBpbnRlbF9lbmNvZGVyc191cGRhdGVfcHJlcGFyZShzdHJ1
Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpzdGF0ZSkKIHsKLQlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9z
dGF0ZSAqb2xkX2Nvbm5fc3RhdGU7Ci0Jc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm5ld19j
b25uX3N0YXRlOwotCXN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uOworCXN0cnVjdCBpbnRlbF9k
aWdpdGFsX2Nvbm5lY3Rvcl9zdGF0ZSAqbmV3X2Nvbm5lY3Rvcl9zdGF0ZTsKKwlzdHJ1Y3QgaW50
ZWxfY29ubmVjdG9yICpjb25uZWN0b3I7CiAJaW50IGk7CiAKLQlmb3JfZWFjaF9vbGRuZXdfY29u
bmVjdG9yX2luX3N0YXRlKCZzdGF0ZS0+YmFzZSwgY29ubiwKLQkJCQkJICAgb2xkX2Nvbm5fc3Rh
dGUsIG5ld19jb25uX3N0YXRlLCBpKSB7CisJZm9yX2VhY2hfbmV3X2ludGVsX2Nvbm5lY3Rvcl9p
bl9zdGF0ZShzdGF0ZSwgY29ubmVjdG9yLAorCQkJCQkgICAgICBuZXdfY29ubmVjdG9yX3N0YXRl
LCBpKSB7CiAJCXN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyOwogCQlzdHJ1Y3QgaW50ZWxf
Y3J0YyAqY3J0YzsKIAotCQlpZiAoIWludGVsX2Nvbm5lY3Rvcl9uZWVkc19tb2Rlc2V0KHN0YXRl
LAotCQkJCQkJICAgb2xkX2Nvbm5fc3RhdGUsCi0JCQkJCQkgICBuZXdfY29ubl9zdGF0ZSkpCisJ
CWlmICghaW50ZWxfZGlnaXRhbF9jb25uZWN0b3JfbmVlZHNfbW9kZXNldChzdGF0ZSwgY29ubmVj
dG9yKSkKIAkJCWNvbnRpbnVlOwogCi0JCWVuY29kZXIgPSBpbnRlbF9jb25uZWN0b3JfcHJpbWFy
eV9lbmNvZGVyKHRvX2ludGVsX2Nvbm5lY3Rvcihjb25uKSk7CisJCWVuY29kZXIgPSBpbnRlbF9j
b25uZWN0b3JfcHJpbWFyeV9lbmNvZGVyKGNvbm5lY3Rvcik7CiAJCWlmICghZW5jb2Rlci0+dXBk
YXRlX3ByZXBhcmUpCiAJCQljb250aW51ZTsKIAotCQljcnRjID0gbmV3X2Nvbm5fc3RhdGUtPmNy
dGMgPwotCQkJdG9faW50ZWxfY3J0YyhuZXdfY29ubl9zdGF0ZS0+Y3J0YykgOiBOVUxMOworCQlj
cnRjID0gbmV3X2Nvbm5lY3Rvcl9zdGF0ZS0+YmFzZS5jcnRjID8KKwkJCXRvX2ludGVsX2NydGMo
bmV3X2Nvbm5lY3Rvcl9zdGF0ZS0+YmFzZS5jcnRjKSA6IE5VTEw7CiAJCWVuY29kZXItPnVwZGF0
ZV9wcmVwYXJlKHN0YXRlLCBlbmNvZGVyLCBjcnRjKTsKIAl9CiB9CiAKIHN0YXRpYyB2b2lkIGlu
dGVsX2VuY29kZXJzX3VwZGF0ZV9jb21wbGV0ZShzdHJ1Y3QgaW50ZWxfYXRvbWljX3N0YXRlICpz
dGF0ZSkKIHsKLQlzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAqb2xkX2Nvbm5fc3RhdGU7Ci0J
c3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKm5ld19jb25uX3N0YXRlOwotCXN0cnVjdCBkcm1f
Y29ubmVjdG9yICpjb25uOworCXN0cnVjdCBpbnRlbF9kaWdpdGFsX2Nvbm5lY3Rvcl9zdGF0ZSAq
bmV3X2Nvbm5lY3Rvcl9zdGF0ZTsKKwlzdHJ1Y3QgaW50ZWxfY29ubmVjdG9yICpjb25uZWN0b3I7
CiAJaW50IGk7CiAKLQlmb3JfZWFjaF9vbGRuZXdfY29ubmVjdG9yX2luX3N0YXRlKCZzdGF0ZS0+
YmFzZSwgY29ubiwKLQkJCQkJICAgb2xkX2Nvbm5fc3RhdGUsIG5ld19jb25uX3N0YXRlLCBpKSB7
CisJZm9yX2VhY2hfbmV3X2ludGVsX2Nvbm5lY3Rvcl9pbl9zdGF0ZShzdGF0ZSwgY29ubmVjdG9y
LAorCQkJCQkgICAgICBuZXdfY29ubmVjdG9yX3N0YXRlLCBpKSB7CiAJCXN0cnVjdCBpbnRlbF9l
bmNvZGVyICplbmNvZGVyOwogCQlzdHJ1Y3QgaW50ZWxfY3J0YyAqY3J0YzsKIAotCQlpZiAoIWlu
dGVsX2Nvbm5lY3Rvcl9uZWVkc19tb2Rlc2V0KHN0YXRlLAotCQkJCQkJICAgb2xkX2Nvbm5fc3Rh
dGUsCi0JCQkJCQkgICBuZXdfY29ubl9zdGF0ZSkpCisJCWlmICghaW50ZWxfZGlnaXRhbF9jb25u
ZWN0b3JfbmVlZHNfbW9kZXNldChzdGF0ZSwgY29ubmVjdG9yKSkKIAkJCWNvbnRpbnVlOwogCi0J
CWVuY29kZXIgPSBpbnRlbF9jb25uZWN0b3JfcHJpbWFyeV9lbmNvZGVyKHRvX2ludGVsX2Nvbm5l
Y3Rvcihjb25uKSk7CisJCWVuY29kZXIgPSBpbnRlbF9jb25uZWN0b3JfcHJpbWFyeV9lbmNvZGVy
KGNvbm5lY3Rvcik7CiAJCWlmICghZW5jb2Rlci0+dXBkYXRlX2NvbXBsZXRlKQogCQkJY29udGlu
dWU7CiAKLQkJY3J0YyA9IG5ld19jb25uX3N0YXRlLT5jcnRjID8KLQkJCXRvX2ludGVsX2NydGMo
bmV3X2Nvbm5fc3RhdGUtPmNydGMpIDogTlVMTDsKKwkJY3J0YyA9IG5ld19jb25uZWN0b3Jfc3Rh
dGUtPmJhc2UuY3J0YyA/CisJCQl0b19pbnRlbF9jcnRjKG5ld19jb25uZWN0b3Jfc3RhdGUtPmJh
c2UuY3J0YykgOiBOVUxMOwogCQllbmNvZGVyLT51cGRhdGVfY29tcGxldGUoc3RhdGUsIGVuY29k
ZXIsIGNydGMpOwogCX0KIH0KLS0gCjIuMjQuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vaW50ZWwtZ2Z4Cg==

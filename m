Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id BA71F2930B5
	for <lists+intel-gfx@lfdr.de>; Mon, 19 Oct 2020 23:44:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 216AA6EB37;
	Mon, 19 Oct 2020 21:44:02 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga12.intel.com (mga12.intel.com [192.55.52.136])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8044E6EB36
 for <intel-gfx@lists.freedesktop.org>; Mon, 19 Oct 2020 21:44:01 +0000 (UTC)
IronPort-SDR: jbIPBGAk72laEfR5uwNMZjOdN/5y1aZiQoCdLuOhqkdMk+muRGE4fUzMEKyp9zDKgljQ9fRV+K
 Xnaqgbtuwc3Q==
X-IronPort-AV: E=McAfee;i="6000,8403,9779"; a="146405573"
X-IronPort-AV: E=Sophos;i="5.77,395,1596524400"; d="scan'208";a="146405573"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by fmsmga106.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 19 Oct 2020 14:43:46 -0700
IronPort-SDR: czC7hU1LZHMFb1Cg4Rbmykmy71otN+oNlc6agKsGnpXBdOcX44ev3FazQIV6ooZeT2GQJhFC2S
 VxQb4J2SNeAQ==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.77,395,1596524400"; d="scan'208";a="358958687"
Received: from stinkbox.fi.intel.com (HELO stinkbox) ([10.237.72.174])
 by orsmga007.jf.intel.com with SMTP; 19 Oct 2020 14:43:44 -0700
Received: by stinkbox (sSMTP sendmail emulation);
 Tue, 20 Oct 2020 00:43:43 +0300
From: Ville Syrjala <ville.syrjala@linux.intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 20 Oct 2020 00:43:33 +0300
Message-Id: <20201019214337.19330-3-ville.syrjala@linux.intel.com>
X-Mailer: git-send-email 2.26.2
In-Reply-To: <20201019214337.19330-1-ville.syrjala@linux.intel.com>
References: <20201019214337.19330-1-ville.syrjala@linux.intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 3/7] drm/i915: Adjust intel_dsc_power_domain()
 calling convention
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogVmlsbGUgU3lyasOkbMOkIDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KClBh
c3MgdGhlIGNydGMrY3B1X3RyYW5zY29kZXIgcmF0aGVyIHRoYW4gdGhlIGNydGMgc3RhdGUgdG8K
aW50ZWxfZHNjX3Bvd2VyX2RvbWFpbigpLiBUaGlzIHNob3VsZCBhbGxvdyB1cyB0byByZXVzZSBp
dApkdXJpbmcgcmVhZG91dCBhcyB3ZWxsLgoKU2lnbmVkLW9mZi1ieTogVmlsbGUgU3lyasOkbMOk
IDx2aWxsZS5zeXJqYWxhQGxpbnV4LmludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9kaXNwbGF5L2ljbF9kc2kuYyAgICB8ICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX2RkaS5jICB8ICAzICstCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2lu
dGVsX3Zkc2MuYyB8IDU0ICsrKysrKysrKysrLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9kcm0v
aTkxNS9kaXNwbGF5L2ludGVsX3Zkc2MuaCB8ICA2ICsrLQogNCBmaWxlcyBjaGFuZ2VkLCAzNCBp
bnNlcnRpb25zKCspLCAzMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ljbF9kc2kuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aWNsX2RzaS5jCmluZGV4IDA5NjY1MjkyMTQ1My4uNDYyMzIxYmE1MTMzIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNwbGF5L2ljbF9kc2kuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ljbF9kc2kuYwpAQCAtMTYxMyw2ICsxNjEzLDcgQEAgc3RhdGljIGlu
dCBnZW4xMV9kc2lfY29tcHV0ZV9jb25maWcoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIs
CiBzdGF0aWMgdm9pZCBnZW4xMV9kc2lfZ2V0X3Bvd2VyX2RvbWFpbnMoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCiAJCQkJCXN0cnVjdCBpbnRlbF9jcnRjX3N0YXRlICpjcnRjX3N0YXRl
KQogeworCXN0cnVjdCBpbnRlbF9jcnRjICpjcnRjID0gdG9faW50ZWxfY3J0YyhjcnRjX3N0YXRl
LT51YXBpLmNydGMpOwogCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShl
bmNvZGVyLT5iYXNlLmRldik7CiAKIAlnZXRfZHNpX2lvX3Bvd2VyX2RvbWFpbnMoaTkxNSwKQEAg
LTE2MjAsNyArMTYyMSw3IEBAIHN0YXRpYyB2b2lkIGdlbjExX2RzaV9nZXRfcG93ZXJfZG9tYWlu
cyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAogCWlmIChjcnRjX3N0YXRlLT5kc2Mu
Y29tcHJlc3Npb25fZW5hYmxlKQogCQlpbnRlbF9kaXNwbGF5X3Bvd2VyX2dldChpOTE1LAotCQkJ
CQlpbnRlbF9kc2NfcG93ZXJfZG9tYWluKGNydGNfc3RhdGUpKTsKKwkJCQkJaW50ZWxfZHNjX3Bv
d2VyX2RvbWFpbihjcnRjLCBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcikpOwogfQogCiBzdGF0
aWMgYm9vbCBnZW4xMV9kc2lfZ2V0X2h3X3N0YXRlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF9kZGku
YyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfZGRpLmMKaW5kZXggYmIwYjk5
MzA5NThmLi40NDA3ZGRiY2ExZmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rp
c3BsYXkvaW50ZWxfZGRpLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRl
bF9kZGkuYwpAQCAtMjE4OCw2ICsyMTg4LDcgQEAgaW50ZWxfZGRpX21haW5fbGlua19hdXhfZG9t
YWluKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQogc3RhdGljIHZvaWQgaW50
ZWxfZGRpX2dldF9wb3dlcl9kb21haW5zKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAog
CQkJCQlzdHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKIHsKKwlzdHJ1Y3QgaW50
ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRjKTsKIAlz
dHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB0b19pOTE1KGVuY29kZXItPmJhc2Uu
ZGV2KTsKIAlzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydDsKIAllbnVtIHBoeSBw
aHkgPSBpbnRlbF9wb3J0X3RvX3BoeShkZXZfcHJpdiwgZW5jb2Rlci0+cG9ydCk7CkBAIC0yMjIy
LDcgKzIyMjMsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kZGlfZ2V0X3Bvd2VyX2RvbWFpbnMoc3Ry
dWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJICovCiAJaWYgKGNydGNfc3RhdGUtPmRzYy5j
b21wcmVzc2lvbl9lbmFibGUpCiAJCWludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0KGRldl9wcml2LAot
CQkJCQlpbnRlbF9kc2NfcG93ZXJfZG9tYWluKGNydGNfc3RhdGUpKTsKKwkJCQkJaW50ZWxfZHNj
X3Bvd2VyX2RvbWFpbihjcnRjLCBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcikpOwogfQogCiB2
b2lkIGludGVsX2RkaV9lbmFibGVfcGlwZV9jbG9jayhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdmRz
Yy5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF92ZHNjLmMKaW5kZXggYzU3
MzVjMzY1NjU5Li4xNTZlMTY4OTA2NmIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2Rpc3BsYXkvaW50ZWxfdmRzYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkv
aW50ZWxfdmRzYy5jCkBAIC0zNTcsMTEgKzM1NywxMCBAQCBib29sIGludGVsX2RzY19zb3VyY2Vf
c3VwcG9ydChzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlyZXR1cm4gZmFsc2U7CiB9
CiAKLXN0YXRpYyBib29sIGlzX3BpcGVfZHNjKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRjX3N0YXRl
ICpjcnRjX3N0YXRlKQorc3RhdGljIGJvb2wgaXNfcGlwZV9kc2Moc3RydWN0IGludGVsX2NydGMg
KmNydGMsCisJCQllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIpCiB7Ci0JY29uc3Qgc3Ry
dWN0IGludGVsX2NydGMgKmNydGMgPSB0b19pbnRlbF9jcnRjKGNydGNfc3RhdGUtPnVhcGkuY3J0
Yyk7Ci0JY29uc3Qgc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGNydGMt
PmJhc2UuZGV2KTsKLQllbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29kZXIgPSBjcnRjX3N0YXRl
LT5jcHVfdHJhbnNjb2RlcjsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5
MTUoY3J0Yy0+YmFzZS5kZXYpOwogCiAJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMikKIAkJcmV0
dXJuIHRydWU7CkBAIC00NjUsOSArNDY0LDggQEAgaW50IGludGVsX2RzY19jb21wdXRlX3BhcmFt
cyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIH0KIAogZW51bSBpbnRlbF9kaXNwbGF5
X3Bvd2VyX2RvbWFpbgotaW50ZWxfZHNjX3Bvd2VyX2RvbWFpbihjb25zdCBzdHJ1Y3QgaW50ZWxf
Y3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSkKK2ludGVsX2RzY19wb3dlcl9kb21haW4oc3RydWN0IGlu
dGVsX2NydGMgKmNydGMsIGVudW0gdHJhbnNjb2RlciBjcHVfdHJhbnNjb2RlcikKIHsKLQlzdHJ1
Y3QgaW50ZWxfY3J0YyAqY3J0YyA9IHRvX2ludGVsX2NydGMoY3J0Y19zdGF0ZS0+dWFwaS5jcnRj
KTsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoY3J0Yy0+YmFzZS5k
ZXYpOwogCWVudW0gcGlwZSBwaXBlID0gY3J0Yy0+cGlwZTsKIApAQCAtNDg0LDcgKzQ4Miw3IEBA
IGludGVsX2RzY19wb3dlcl9kb21haW4oY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNy
dGNfc3RhdGUpCiAJICovCiAJaWYgKElOVEVMX0dFTihpOTE1KSA+PSAxMiAmJiAhSVNfUk9DS0VU
TEFLRShpOTE1KSAmJiBwaXBlID09IFBJUEVfQSkKIAkJcmV0dXJuIFBPV0VSX0RPTUFJTl9UUkFO
U0NPREVSX1ZEU0NfUFcyOwotCWVsc2UgaWYgKGlzX3BpcGVfZHNjKGNydGNfc3RhdGUpKQorCWVs
c2UgaWYgKGlzX3BpcGVfZHNjKGNydGMsIGNwdV90cmFuc2NvZGVyKSkKIAkJcmV0dXJuIFBPV0VS
X0RPTUFJTl9QSVBFKHBpcGUpOwogCWVsc2UKIAkJcmV0dXJuIFBPV0VSX0RPTUFJTl9UUkFOU0NP
REVSX1ZEU0NfUFcyOwpAQCAtNTE3LDcgKzUxNSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzY19w
cHNfY29uZmlndXJlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCWlmICh2ZHNjX2Nm
Zy0+dmJyX2VuYWJsZSkKIAkJcHBzX3ZhbCB8PSBEU0NfVkJSX0VOQUJMRTsKIAlkcm1faW5mbygm
ZGV2X3ByaXYtPmRybSwgIlBQUzAgPSAweCUwOHhcbiIsIHBwc192YWwpOwotCWlmICghaXNfcGlw
ZV9kc2MoY3J0Y19zdGF0ZSkpIHsKKwlpZiAoIWlzX3BpcGVfZHNjKGNydGMsIGNydGNfc3RhdGUt
PmNwdV90cmFuc2NvZGVyKSkgewogCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRFNDQV9QSUNU
VVJFX1BBUkFNRVRFUl9TRVRfMCwKIAkJCSAgICAgICBwcHNfdmFsKTsKIAkJLyoKQEAgLTU0MSw3
ICs1MzksNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9kc2NfcHBzX2NvbmZpZ3VyZShzdHJ1Y3QgaW50
ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlwcHNfdmFsID0gMDsKIAlwcHNfdmFsIHw9IERTQ19CUFAo
dmRzY19jZmctPmJpdHNfcGVyX3BpeGVsKTsKIAlkcm1faW5mbygmZGV2X3ByaXYtPmRybSwgIlBQ
UzEgPSAweCUwOHhcbiIsIHBwc192YWwpOwotCWlmICghaXNfcGlwZV9kc2MoY3J0Y19zdGF0ZSkp
IHsKKwlpZiAoIWlzX3BpcGVfZHNjKGNydGMsIGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKSkg
ewogCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRFNDQV9QSUNUVVJFX1BBUkFNRVRFUl9TRVRf
MSwKIAkJCSAgICAgICBwcHNfdmFsKTsKIAkJLyoKQEAgLTU2Niw3ICs1NjQsNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9kc2NfcHBzX2NvbmZpZ3VyZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKIAlwcHNfdmFsIHw9IERTQ19QSUNfSEVJR0hUKHZkc2NfY2ZnLT5waWNfaGVpZ2h0KSB8CiAJ
CURTQ19QSUNfV0lEVEgodmRzY19jZmctPnBpY193aWR0aCAvIG51bV92ZHNjX2luc3RhbmNlcyk7
CiAJZHJtX2luZm8oJmRldl9wcml2LT5kcm0sICJQUFMyID0gMHglMDh4XG4iLCBwcHNfdmFsKTsK
LQlpZiAoIWlzX3BpcGVfZHNjKGNydGNfc3RhdGUpKSB7CisJaWYgKCFpc19waXBlX2RzYyhjcnRj
LCBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcikpIHsKIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3By
aXYsIERTQ0FfUElDVFVSRV9QQVJBTUVURVJfU0VUXzIsCiAJCQkgICAgICAgcHBzX3ZhbCk7CiAJ
CS8qCkBAIC01OTEsNyArNTg5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNjX3Bwc19jb25maWd1
cmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJcHBzX3ZhbCB8PSBEU0NfU0xJQ0Vf
SEVJR0hUKHZkc2NfY2ZnLT5zbGljZV9oZWlnaHQpIHwKIAkJRFNDX1NMSUNFX1dJRFRIKHZkc2Nf
Y2ZnLT5zbGljZV93aWR0aCk7CiAJZHJtX2luZm8oJmRldl9wcml2LT5kcm0sICJQUFMzID0gMHgl
MDh4XG4iLCBwcHNfdmFsKTsKLQlpZiAoIWlzX3BpcGVfZHNjKGNydGNfc3RhdGUpKSB7CisJaWYg
KCFpc19waXBlX2RzYyhjcnRjLCBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcikpIHsKIAkJaW50
ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERTQ0FfUElDVFVSRV9QQVJBTUVURVJfU0VUXzMsCiAJCQkg
ICAgICAgcHBzX3ZhbCk7CiAJCS8qCkBAIC02MTYsNyArNjE0LDcgQEAgc3RhdGljIHZvaWQgaW50
ZWxfZHNjX3Bwc19jb25maWd1cmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJcHBz
X3ZhbCB8PSBEU0NfSU5JVElBTF9YTUlUX0RFTEFZKHZkc2NfY2ZnLT5pbml0aWFsX3htaXRfZGVs
YXkpIHwKIAkJRFNDX0lOSVRJQUxfREVDX0RFTEFZKHZkc2NfY2ZnLT5pbml0aWFsX2RlY19kZWxh
eSk7CiAJZHJtX2luZm8oJmRldl9wcml2LT5kcm0sICJQUFM0ID0gMHglMDh4XG4iLCBwcHNfdmFs
KTsKLQlpZiAoIWlzX3BpcGVfZHNjKGNydGNfc3RhdGUpKSB7CisJaWYgKCFpc19waXBlX2RzYyhj
cnRjLCBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcikpIHsKIAkJaW50ZWxfZGVfd3JpdGUoZGV2
X3ByaXYsIERTQ0FfUElDVFVSRV9QQVJBTUVURVJfU0VUXzQsCiAJCQkgICAgICAgcHBzX3ZhbCk7
CiAJCS8qCkBAIC02NDEsNyArNjM5LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNjX3Bwc19jb25m
aWd1cmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJcHBzX3ZhbCB8PSBEU0NfU0NB
TEVfSU5DX0lOVCh2ZHNjX2NmZy0+c2NhbGVfaW5jcmVtZW50X2ludGVydmFsKSB8CiAJCURTQ19T
Q0FMRV9ERUNfSU5UKHZkc2NfY2ZnLT5zY2FsZV9kZWNyZW1lbnRfaW50ZXJ2YWwpOwogCWRybV9p
bmZvKCZkZXZfcHJpdi0+ZHJtLCAiUFBTNSA9IDB4JTA4eFxuIiwgcHBzX3ZhbCk7Ci0JaWYgKCFp
c19waXBlX2RzYyhjcnRjX3N0YXRlKSkgeworCWlmICghaXNfcGlwZV9kc2MoY3J0YywgY3J0Y19z
dGF0ZS0+Y3B1X3RyYW5zY29kZXIpKSB7CiAJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBEU0NB
X1BJQ1RVUkVfUEFSQU1FVEVSX1NFVF81LAogCQkJICAgICAgIHBwc192YWwpOwogCQkvKgpAQCAt
NjY4LDcgKzY2Niw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzY19wcHNfY29uZmlndXJlKHN0cnVj
dCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQlEU0NfRkxBVE5FU1NfTUlOX1FQKHZkc2NfY2Zn
LT5mbGF0bmVzc19taW5fcXApIHwKIAkJRFNDX0ZMQVRORVNTX01BWF9RUCh2ZHNjX2NmZy0+Zmxh
dG5lc3NfbWF4X3FwKTsKIAlkcm1faW5mbygmZGV2X3ByaXYtPmRybSwgIlBQUzYgPSAweCUwOHhc
biIsIHBwc192YWwpOwotCWlmICghaXNfcGlwZV9kc2MoY3J0Y19zdGF0ZSkpIHsKKwlpZiAoIWlz
X3BpcGVfZHNjKGNydGMsIGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKSkgewogCQlpbnRlbF9k
ZV93cml0ZShkZXZfcHJpdiwgRFNDQV9QSUNUVVJFX1BBUkFNRVRFUl9TRVRfNiwKIAkJCSAgICAg
ICBwcHNfdmFsKTsKIAkJLyoKQEAgLTY5Myw3ICs2OTEsNyBAQCBzdGF0aWMgdm9pZCBpbnRlbF9k
c2NfcHBzX2NvbmZpZ3VyZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAlwcHNfdmFs
IHw9IERTQ19TTElDRV9CUEdfT0ZGU0VUKHZkc2NfY2ZnLT5zbGljZV9icGdfb2Zmc2V0KSB8CiAJ
CURTQ19ORkxfQlBHX09GRlNFVCh2ZHNjX2NmZy0+bmZsX2JwZ19vZmZzZXQpOwogCWRybV9pbmZv
KCZkZXZfcHJpdi0+ZHJtLCAiUFBTNyA9IDB4JTA4eFxuIiwgcHBzX3ZhbCk7Ci0JaWYgKCFpc19w
aXBlX2RzYyhjcnRjX3N0YXRlKSkgeworCWlmICghaXNfcGlwZV9kc2MoY3J0YywgY3J0Y19zdGF0
ZS0+Y3B1X3RyYW5zY29kZXIpKSB7CiAJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBEU0NBX1BJ
Q1RVUkVfUEFSQU1FVEVSX1NFVF83LAogCQkJICAgICAgIHBwc192YWwpOwogCQkvKgpAQCAtNzE4
LDcgKzcxNiw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2RzY19wcHNfY29uZmlndXJlKHN0cnVjdCBp
bnRlbF9lbmNvZGVyICplbmNvZGVyLAogCXBwc192YWwgfD0gRFNDX0ZJTkFMX09GRlNFVCh2ZHNj
X2NmZy0+ZmluYWxfb2Zmc2V0KSB8CiAJCURTQ19JTklUSUFMX09GRlNFVCh2ZHNjX2NmZy0+aW5p
dGlhbF9vZmZzZXQpOwogCWRybV9pbmZvKCZkZXZfcHJpdi0+ZHJtLCAiUFBTOCA9IDB4JTA4eFxu
IiwgcHBzX3ZhbCk7Ci0JaWYgKCFpc19waXBlX2RzYyhjcnRjX3N0YXRlKSkgeworCWlmICghaXNf
cGlwZV9kc2MoY3J0YywgY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29kZXIpKSB7CiAJCWludGVsX2Rl
X3dyaXRlKGRldl9wcml2LCBEU0NBX1BJQ1RVUkVfUEFSQU1FVEVSX1NFVF84LAogCQkJICAgICAg
IHBwc192YWwpOwogCQkvKgpAQCAtNzQzLDcgKzc0MSw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rz
Y19wcHNfY29uZmlndXJlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCXBwc192YWwg
fD0gRFNDX1JDX01PREVMX1NJWkUoRFNDX1JDX01PREVMX1NJWkVfQ09OU1QpIHwKIAkJRFNDX1JD
X0VER0VfRkFDVE9SKERTQ19SQ19FREdFX0ZBQ1RPUl9DT05TVCk7CiAJZHJtX2luZm8oJmRldl9w
cml2LT5kcm0sICJQUFM5ID0gMHglMDh4XG4iLCBwcHNfdmFsKTsKLQlpZiAoIWlzX3BpcGVfZHNj
KGNydGNfc3RhdGUpKSB7CisJaWYgKCFpc19waXBlX2RzYyhjcnRjLCBjcnRjX3N0YXRlLT5jcHVf
dHJhbnNjb2RlcikpIHsKIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3ByaXYsIERTQ0FfUElDVFVSRV9Q
QVJBTUVURVJfU0VUXzksCiAJCQkgICAgICAgcHBzX3ZhbCk7CiAJCS8qCkBAIC03NzAsNyArNzY4
LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfZHNjX3Bwc19jb25maWd1cmUoc3RydWN0IGludGVsX2Vu
Y29kZXIgKmVuY29kZXIsCiAJCURTQ19SQ19UQVJHRVRfT0ZGX0hJR0goRFNDX1JDX1RHVF9PRkZT
RVRfSElfQ09OU1QpIHwKIAkJRFNDX1JDX1RBUkdFVF9PRkZfTE9XKERTQ19SQ19UR1RfT0ZGU0VU
X0xPX0NPTlNUKTsKIAlkcm1faW5mbygmZGV2X3ByaXYtPmRybSwgIlBQUzEwID0gMHglMDh4XG4i
LCBwcHNfdmFsKTsKLQlpZiAoIWlzX3BpcGVfZHNjKGNydGNfc3RhdGUpKSB7CisJaWYgKCFpc19w
aXBlX2RzYyhjcnRjLCBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcikpIHsKIAkJaW50ZWxfZGVf
d3JpdGUoZGV2X3ByaXYsIERTQ0FfUElDVFVSRV9QQVJBTUVURVJfU0VUXzEwLAogCQkJICAgICAg
IHBwc192YWwpOwogCQkvKgpAQCAtNzk4LDcgKzc5Niw3IEBAIHN0YXRpYyB2b2lkIGludGVsX2Rz
Y19wcHNfY29uZmlndXJlKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQlEU0NfU0xJ
Q0VfUk9XX1BFUl9GUkFNRSh2ZHNjX2NmZy0+cGljX2hlaWdodCAvCiAJCQkJCXZkc2NfY2ZnLT5z
bGljZV9oZWlnaHQpOwogCWRybV9pbmZvKCZkZXZfcHJpdi0+ZHJtLCAiUFBTMTYgPSAweCUwOHhc
biIsIHBwc192YWwpOwotCWlmICghaXNfcGlwZV9kc2MoY3J0Y19zdGF0ZSkpIHsKKwlpZiAoIWlz
X3BpcGVfZHNjKGNydGMsIGNydGNfc3RhdGUtPmNwdV90cmFuc2NvZGVyKSkgewogCQlpbnRlbF9k
ZV93cml0ZShkZXZfcHJpdiwgRFNDQV9QSUNUVVJFX1BBUkFNRVRFUl9TRVRfMTYsCiAJCQkgICAg
ICAgcHBzX3ZhbCk7CiAJCS8qCkBAIC04MjcsNyArODI1LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxf
ZHNjX3Bwc19jb25maWd1cmUoc3RydWN0IGludGVsX2VuY29kZXIgKmVuY29kZXIsCiAJCWRybV9p
bmZvKCZkZXZfcHJpdi0+ZHJtLCAiIFJDX0JVRl9USFJFU0glZCA9IDB4JTA4eFxuIiwgaSwKIAkJ
CSByY19idWZfdGhyZXNoX2R3b3JkW2kgLyA0XSk7CiAJfQotCWlmICghaXNfcGlwZV9kc2MoY3J0
Y19zdGF0ZSkpIHsKKwlpZiAoIWlzX3BpcGVfZHNjKGNydGMsIGNydGNfc3RhdGUtPmNwdV90cmFu
c2NvZGVyKSkgewogCQlpbnRlbF9kZV93cml0ZShkZXZfcHJpdiwgRFNDQV9SQ19CVUZfVEhSRVNI
XzAsCiAJCQkgICAgICAgcmNfYnVmX3RocmVzaF9kd29yZFswXSk7CiAJCWludGVsX2RlX3dyaXRl
KGRldl9wcml2LCBEU0NBX1JDX0JVRl9USFJFU0hfMF9VRFcsCkBAIC04ODQsNyArODgyLDcgQEAg
c3RhdGljIHZvaWQgaW50ZWxfZHNjX3Bwc19jb25maWd1cmUoc3RydWN0IGludGVsX2VuY29kZXIg
KmVuY29kZXIsCiAJCWRybV9pbmZvKCZkZXZfcHJpdi0+ZHJtLCAiIFJDX1JBTkdFX1BBUkFNXyVk
ID0gMHglMDh4XG4iLCBpLAogCQkJIHJjX3JhbmdlX3BhcmFtc19kd29yZFtpIC8gMl0pOwogCX0K
LQlpZiAoIWlzX3BpcGVfZHNjKGNydGNfc3RhdGUpKSB7CisJaWYgKCFpc19waXBlX2RzYyhjcnRj
LCBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcikpIHsKIAkJaW50ZWxfZGVfd3JpdGUoZGV2X3By
aXYsIERTQ0FfUkNfUkFOR0VfUEFSQU1FVEVSU18wLAogCQkJICAgICAgIHJjX3JhbmdlX3BhcmFt
c19kd29yZFswXSk7CiAJCWludGVsX2RlX3dyaXRlKGRldl9wcml2LCBEU0NBX1JDX1JBTkdFX1BB
UkFNRVRFUlNfMF9VRFcsCkBAIC05ODcsMTMgKzk4NSwxMyBAQCB2b2lkIGludGVsX2RzY19nZXRf
Y29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCWlmICghaW50ZWxfZHNjX3Nv
dXJjZV9zdXBwb3J0KGVuY29kZXIsIGNydGNfc3RhdGUpKQogCQlyZXR1cm47CiAKLQlwb3dlcl9k
b21haW4gPSBpbnRlbF9kc2NfcG93ZXJfZG9tYWluKGNydGNfc3RhdGUpOworCXBvd2VyX2RvbWFp
biA9IGludGVsX2RzY19wb3dlcl9kb21haW4oY3J0YywgY3J0Y19zdGF0ZS0+Y3B1X3RyYW5zY29k
ZXIpOwogCiAJd2FrZXJlZiA9IGludGVsX2Rpc3BsYXlfcG93ZXJfZ2V0X2lmX2VuYWJsZWQoZGV2
X3ByaXYsIHBvd2VyX2RvbWFpbik7CiAJaWYgKCF3YWtlcmVmKQogCQlyZXR1cm47CiAKLQlpZiAo
IWlzX3BpcGVfZHNjKGNydGNfc3RhdGUpKSB7CisJaWYgKCFpc19waXBlX2RzYyhjcnRjLCBjcnRj
X3N0YXRlLT5jcHVfdHJhbnNjb2RlcikpIHsKIAkJZHNzX2N0bDEgPSBpbnRlbF9kZV9yZWFkKGRl
dl9wcml2LCBEU1NfQ1RMMSk7CiAJCWRzc19jdGwyID0gaW50ZWxfZGVfcmVhZChkZXZfcHJpdiwg
RFNTX0NUTDIpOwogCX0gZWxzZSB7CkBAIC0xMDExLDcgKzEwMDksNyBAQCB2b2lkIGludGVsX2Rz
Y19nZXRfY29uZmlnKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCS8qIEZJWE1FOiBh
ZGQgbW9yZSBzdGF0ZSByZWFkb3V0IGFzIG5lZWRlZCAqLwogCiAJLyogUFBTMSAqLwotCWlmICgh
aXNfcGlwZV9kc2MoY3J0Y19zdGF0ZSkpCisJaWYgKCFpc19waXBlX2RzYyhjcnRjLCBjcnRjX3N0
YXRlLT5jcHVfdHJhbnNjb2RlcikpCiAJCXZhbCA9IGludGVsX2RlX3JlYWQoZGV2X3ByaXYsIERT
Q0FfUElDVFVSRV9QQVJBTUVURVJfU0VUXzEpOwogCWVsc2UKIAkJdmFsID0gaW50ZWxfZGVfcmVh
ZChkZXZfcHJpdiwKQEAgLTEwNzUsNyArMTA3Myw3IEBAIHZvaWQgaW50ZWxfZHNjX2VuYWJsZShz
dHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2RlciwKIAogCS8qIEVuYWJsZSBQb3dlciB3ZWxscyBm
b3IgVkRTQy9qb2luaW5nICovCiAJaW50ZWxfZGlzcGxheV9wb3dlcl9nZXQoZGV2X3ByaXYsCi0J
CQkJaW50ZWxfZHNjX3Bvd2VyX2RvbWFpbihjcnRjX3N0YXRlKSk7CisJCQkJaW50ZWxfZHNjX3Bv
d2VyX2RvbWFpbihjcnRjLCBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcikpOwogCiAJaW50ZWxf
ZHNjX3Bwc19jb25maWd1cmUoZW5jb2RlciwgY3J0Y19zdGF0ZSk7CiAKQEAgLTEwODQsNyArMTA4
Miw3IEBAIHZvaWQgaW50ZWxfZHNjX2VuYWJsZShzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5jb2Rl
ciwKIAllbHNlCiAJCWludGVsX2RzY19kcF9wcHNfd3JpdGUoZW5jb2RlciwgY3J0Y19zdGF0ZSk7
CiAKLQlpZiAoIWlzX3BpcGVfZHNjKGNydGNfc3RhdGUpKSB7CisJaWYgKCFpc19waXBlX2RzYyhj
cnRjLCBjcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcikpIHsKIAkJZHNzX2N0bDFfcmVnID0gRFNT
X0NUTDE7CiAJCWRzc19jdGwyX3JlZyA9IERTU19DVEwyOwogCX0gZWxzZSB7CkBAIC0xMTExLDcg
KzExMDksNyBAQCB2b2lkIGludGVsX2RzY19kaXNhYmxlKGNvbnN0IHN0cnVjdCBpbnRlbF9jcnRj
X3N0YXRlICpvbGRfY3J0Y19zdGF0ZSkKIAlpZiAoIW9sZF9jcnRjX3N0YXRlLT5kc2MuY29tcHJl
c3Npb25fZW5hYmxlKQogCQlyZXR1cm47CiAKLQlpZiAoIWlzX3BpcGVfZHNjKG9sZF9jcnRjX3N0
YXRlKSkgeworCWlmICghaXNfcGlwZV9kc2MoY3J0Yywgb2xkX2NydGNfc3RhdGUtPmNwdV90cmFu
c2NvZGVyKSkgewogCQlkc3NfY3RsMV9yZWcgPSBEU1NfQ1RMMTsKIAkJZHNzX2N0bDJfcmVnID0g
RFNTX0NUTDI7CiAJfSBlbHNlIHsKQEAgLTExMzIsNSArMTEzMCw1IEBAIHZvaWQgaW50ZWxfZHNj
X2Rpc2FibGUoY29uc3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKm9sZF9jcnRjX3N0YXRlKQog
CiAJLyogRGlzYWJsZSBQb3dlciB3ZWxscyBmb3IgVkRTQy9qb2luaW5nICovCiAJaW50ZWxfZGlz
cGxheV9wb3dlcl9wdXRfdW5jaGVja2VkKGRldl9wcml2LAotCQkJCQkgIGludGVsX2RzY19wb3dl
cl9kb21haW4ob2xkX2NydGNfc3RhdGUpKTsKKwkJCQkJICBpbnRlbF9kc2NfcG93ZXJfZG9tYWlu
KGNydGMsIG9sZF9jcnRjX3N0YXRlLT5jcHVfdHJhbnNjb2RlcikpOwogfQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF92ZHNjLmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9kaXNwbGF5L2ludGVsX3Zkc2MuaAppbmRleCBlNTZhMzI1NGMyMTQuLmFjZjFjZTlj
NGE2ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF92ZHNj
LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF92ZHNjLmgKQEAgLTgs
OCArOCwxMCBAQAogCiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KIAotc3RydWN0IGludGVsX2Vu
Y29kZXI7CitlbnVtIHRyYW5zY29kZXI7CitzdHJ1Y3QgaW50ZWxfY3J0YzsKIHN0cnVjdCBpbnRl
bF9jcnRjX3N0YXRlOworc3RydWN0IGludGVsX2VuY29kZXI7CiAKIGJvb2wgaW50ZWxfZHNjX3Nv
dXJjZV9zdXBwb3J0KHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNvZGVyLAogCQkJICAgICAgY29u
c3Qgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwpAQCAtMjEsNiArMjMsNiBA
QCBpbnQgaW50ZWxfZHNjX2NvbXB1dGVfcGFyYW1zKHN0cnVjdCBpbnRlbF9lbmNvZGVyICplbmNv
ZGVyLAogdm9pZCBpbnRlbF9kc2NfZ2V0X2NvbmZpZyhzdHJ1Y3QgaW50ZWxfZW5jb2RlciAqZW5j
b2RlciwKIAkJCSAgc3RydWN0IGludGVsX2NydGNfc3RhdGUgKmNydGNfc3RhdGUpOwogZW51bSBp
bnRlbF9kaXNwbGF5X3Bvd2VyX2RvbWFpbgotaW50ZWxfZHNjX3Bvd2VyX2RvbWFpbihjb25zdCBz
dHJ1Y3QgaW50ZWxfY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSk7CitpbnRlbF9kc2NfcG93ZXJfZG9t
YWluKHN0cnVjdCBpbnRlbF9jcnRjICpjcnRjLCBlbnVtIHRyYW5zY29kZXIgY3B1X3RyYW5zY29k
ZXIpOwogCiAjZW5kaWYgLyogX19JTlRFTF9WRFNDX0hfXyAqLwotLSAKMi4yNi4yCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpJbnRlbC1nZnggbWFpbGlu
ZyBsaXN0CkludGVsLWdmeEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVl
ZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1nZngK

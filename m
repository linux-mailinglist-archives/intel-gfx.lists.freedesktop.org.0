Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 33E9C338073
	for <lists+intel-gfx@lfdr.de>; Thu, 11 Mar 2021 23:37:04 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B646A6EE86;
	Thu, 11 Mar 2021 22:36:53 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by gabe.freedesktop.org (Postfix) with ESMTPS id BEE506EEA6
 for <intel-gfx@lists.freedesktop.org>; Thu, 11 Mar 2021 22:36:49 +0000 (UTC)
IronPort-SDR: cLD8GIf/qibMaLfP4FLVdJR+T8VQaAfZmVuKgL0uqwi6UAsP1mGF7OO2H7BwhvaLIqBWFqLRT0
 LSAnrj9yR45g==
X-IronPort-AV: E=McAfee;i="6000,8403,9920"; a="250116447"
X-IronPort-AV: E=Sophos;i="5.81,241,1610438400"; d="scan'208";a="250116447"
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
 by orsmga104.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 11 Mar 2021 14:36:47 -0800
IronPort-SDR: jwqLi9TZLFBjcuG6tLV1GESEpTFxGzZZGR91xpK6mVrkTMONZ+RVbdV4mYRVOIcG/DXPD2Wtw/
 ekI7urbbL8mg==
X-IronPort-AV: E=Sophos;i="5.81,241,1610438400"; d="scan'208";a="438852750"
Received: from mdroper-desk1.fm.intel.com ([10.1.27.168])
 by fmsmga003-auth.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 11 Mar 2021 14:36:45 -0800
From: Matt Roper <matthew.d.roper@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Thu, 11 Mar 2021 14:36:10 -0800
Message-Id: <20210311223632.3191939-35-matthew.d.roper@intel.com>
X-Mailer: git-send-email 2.25.4
In-Reply-To: <20210311223632.3191939-1-matthew.d.roper@intel.com>
References: <20210311223632.3191939-1-matthew.d.roper@intel.com>
MIME-Version: 1.0
Subject: [Intel-gfx] [PATCH 34/56] drm/i915/adl_p: Implement TC sequences
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

RnJvbTogSm9zw6kgUm9iZXJ0byBkZSBTb3V6YSA8am9zZS5zb3V6YUBpbnRlbC5jb20+CgpBREwt
UCBoYXZlIGJhc2ljYWxseSB0aGUgc2FtZSBUQyBjb25uZWN0aW9uIGFuZCBkaXNjb25uZWN0aW9u
CnNlcXVlbmNlcyBhcyBJQ0wgYW5kIFRHTCwgdGhlIG1ham9yIGRpZmZlcmVuY2UgaXMgdGhlIG5l
dyByZWdpc3RlcnMuCgpTbyBoZXJlIGFkZGluZyBmdW5jdGlvbnMgd2l0aG91dCB0aGUgaWNsIHBy
ZWZpeCBpbiB0aGUgbmFtZSBhbmQKbWFraW5nIHRoZSBuZXcgZnVuY3Rpb25zIGNhbGwgdGhlIHBs
YXRmb3JtIHNwZWNpZmljIGZ1bmN0aW9uIHRvIGFjY2Vzcwp0aGUgY29ycmVjdCByZWdpc3Rlci4K
CkJTcGVjOiA1NTQ4MApDYzogSW1yZSBEZWFrIDxpbXJlLmRlYWtAaW50ZWwuY29tPgpTaWduZWQt
b2ZmLWJ5OiBKb3PDqSBSb2JlcnRvIGRlIFNvdXphIDxqb3NlLnNvdXphQGludGVsLmNvbT4KU2ln
bmVkLW9mZi1ieTogQ2xpbnRvbiBUYXlsb3IgPENsaW50b24uQS5UYXlsb3JAaW50ZWwuY29tPgpT
aWduZWQtb2ZmLWJ5OiBNYXR0IFJvcGVyIDxtYXR0aGV3LmQucm9wZXJAaW50ZWwuY29tPgotLS0K
IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2Rpc3BsYXkvaW50ZWxfdGMuYyB8IDEzMiArKysrKysrKysr
KysrKysrKysrKysrLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmggICAgICAgICB8
ICAxMCArKwogMiBmaWxlcyBjaGFuZ2VkLCAxMzEgaW5zZXJ0aW9ucygrKSwgMTEgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90Yy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90Yy5jCmluZGV4IGQyZDUyNDMy
OTUwOS4uODU5NTJmMzlhMTNkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9kaXNw
bGF5L2ludGVsX3RjLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZGlzcGxheS9pbnRlbF90
Yy5jCkBAIC0yMDUsNyArMjA1LDcgQEAgc3RhdGljIHZvaWQgdGNfcG9ydF9maXh1cF9sZWdhY3lf
ZmxhZyhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCwKIAlkaWdfcG9ydC0+dGNf
bGVnYWN5X3BvcnQgPSAhZGlnX3BvcnQtPnRjX2xlZ2FjeV9wb3J0OwogfQogCi1zdGF0aWMgdTMy
IHRjX3BvcnRfbGl2ZV9zdGF0dXNfbWFzayhzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdf
cG9ydCkKK3N0YXRpYyB1MzIgaWNsX3RjX3BvcnRfbGl2ZV9zdGF0dXNfbWFzayhzdHJ1Y3QgaW50
ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
aTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwogCXN0cnVjdCBpbnRlbF91
bmNvcmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7CkBAIC0yMzgsNiArMjM4LDQwIEBAIHN0YXRp
YyB1MzIgdGNfcG9ydF9saXZlX3N0YXR1c19tYXNrKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmRpZ19wb3J0KQogCXJldHVybiBtYXNrOwogfQogCitzdGF0aWMgdTMyIGFkbF90Y19wb3J0X2xp
dmVfc3RhdHVzX21hc2soc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpCit7CisJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJh
c2UuZGV2KTsKKwllbnVtIHRjX3BvcnQgdGNfcG9ydCA9IGludGVsX3BvcnRfdG9fdGMoaTkxNSwg
ZGlnX3BvcnQtPmJhc2UucG9ydCk7CisJdTMyIGlzcl9iaXQgPSBpOTE1LT5ob3RwbHVnLnBjaF9o
cGRbZGlnX3BvcnQtPmJhc2UuaHBkX3Bpbl07CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3Jl
ID0gJmk5MTUtPnVuY29yZTsKKwl1MzIgdmFsLCBtYXNrID0gMDsKKworCXZhbCA9IGludGVsX3Vu
Y29yZV9yZWFkKHVuY29yZSwgVENTU19ERElfU1RBVFVTKHRjX3BvcnQpKTsKKwlpZiAodmFsICYg
VENTU19ERElfU1RBVFVTX0hQRF9MSVZFX1NUQVRVU19BTFQpCisJCW1hc2sgfD0gQklUKFRDX1BP
UlRfRFBfQUxUKTsKKwlpZiAodmFsICYgVENTU19ERElfU1RBVFVTX0hQRF9MSVZFX1NUQVRVU19U
QlQpCisJCW1hc2sgfD0gQklUKFRDX1BPUlRfVEJUX0FMVCk7CisKKwlpZiAoaW50ZWxfdW5jb3Jl
X3JlYWQodW5jb3JlLCBTREVJU1IpICYgaXNyX2JpdCkKKwkJbWFzayB8PSBCSVQoVENfUE9SVF9M
RUdBQ1kpOworCisJLyogVGhlIHNpbmsgY2FuIGJlIGNvbm5lY3RlZCBvbmx5IGluIGEgc2luZ2xl
IG1vZGUuICovCisJaWYgKCFkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCBod2VpZ2h0MzIobWFzaykg
PiAxKSkKKwkJdGNfcG9ydF9maXh1cF9sZWdhY3lfZmxhZyhkaWdfcG9ydCwgbWFzayk7CisKKwly
ZXR1cm4gbWFzazsKK30KKworc3RhdGljIHUzMiB0Y19wb3J0X2xpdmVfc3RhdHVzX21hc2soc3Ry
dWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpCit7CisJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKKworCWlmIChJ
U19BTERFUkxBS0VfUChpOTE1KSkKKwkJcmV0dXJuIGFkbF90Y19wb3J0X2xpdmVfc3RhdHVzX21h
c2soZGlnX3BvcnQpOworCisJcmV0dXJuIGljbF90Y19wb3J0X2xpdmVfc3RhdHVzX21hc2soZGln
X3BvcnQpOworfQorCiBzdGF0aWMgYm9vbCBpY2xfdGNfcGh5X3N0YXR1c19jb21wbGV0ZShzdHJ1
Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJp
dmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwpAQCAtMjU2LDYg
KzI5MCwzMyBAQCBzdGF0aWMgYm9vbCBpY2xfdGNfcGh5X3N0YXR1c19jb21wbGV0ZShzdHJ1Y3Qg
aW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9ydCkKIAlyZXR1cm4gdmFsICYgRFBfUEhZX01PREVf
U1RBVFVTX0NPTVBMRVRFRChkaWdfcG9ydC0+dGNfcGh5X2ZpYV9pZHgpOwogfQogCitzdGF0aWMg
Ym9vbCBhZGxfdGNfcGh5X3N0YXR1c19jb21wbGV0ZShzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICpkaWdfcG9ydCkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOworCXN0cnVjdCBpbnRlbF91bmNvcmUgKnVuY29yZSA9
ICZpOTE1LT51bmNvcmU7CisJdTMyIHZhbDsKKworCXZhbCA9IGludGVsX3VuY29yZV9yZWFkKHVu
Y29yZSwgVENTU19ERElfU1RBVFVTKGRpZ19wb3J0LT50Y19waHlfZmlhX2lkeCkpOworCWlmICh2
YWwgPT0gMHhmZmZmZmZmZikgeworCQlkcm1fZGJnX2ttcygmaTkxNS0+ZHJtLAorCQkJICAgICJQ
b3J0ICVzOiBQSFkgaW4gVENDT0xELCBhc3N1bWluZyBub3QgY29tcGxldGVcbiIsCisJCQkgICAg
ZGlnX3BvcnQtPnRjX3BvcnRfbmFtZSk7CisJCXJldHVybiBmYWxzZTsKKwl9CisKKwlyZXR1cm4g
dmFsICYgVENTU19ERElfU1RBVFVTX1JFQURZOworfQorCitzdGF0aWMgYm9vbCB0Y19waHlfc3Rh
dHVzX2NvbXBsZXRlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQoreworCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNl
LmRldik7CisKKwlpZiAoSVNfQUxERVJMQUtFX1AoaTkxNSkpCisJCXJldHVybiBhZGxfdGNfcGh5
X3N0YXR1c19jb21wbGV0ZShkaWdfcG9ydCk7CisKKwlyZXR1cm4gaWNsX3RjX3BoeV9zdGF0dXNf
Y29tcGxldGUoZGlnX3BvcnQpOworfQorCiBzdGF0aWMgYm9vbCBpY2xfdGNfcGh5X3Rha2Vfb3du
ZXJzaGlwKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0LAogCQkJCSAgICAgIGJv
b2wgdGFrZSkKIHsKQEAgLTI4MCw3ICszNDEsNyBAQCBzdGF0aWMgYm9vbCBpY2xfdGNfcGh5X3Rh
a2Vfb3duZXJzaGlwKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0LAogCWludGVs
X3VuY29yZV93cml0ZSh1bmNvcmUsCiAJCQkgICBQT1JUX1RYX0RGTEVYRFBDU1NTKGRpZ19wb3J0
LT50Y19waHlfZmlhKSwgdmFsKTsKIAotCWlmICghdGFrZSAmJiB3YWl0X2ZvcighaWNsX3RjX3Bo
eV9zdGF0dXNfY29tcGxldGUoZGlnX3BvcnQpLCAxMCkpCisJaWYgKCF0YWtlICYmIHdhaXRfZm9y
KCF0Y19waHlfc3RhdHVzX2NvbXBsZXRlKGRpZ19wb3J0KSwgMTApKQogCQlkcm1fZGJnX2ttcygm
aTkxNS0+ZHJtLAogCQkJICAgICJQb3J0ICVzOiBQSFkgY29tcGxldGUgY2xlYXIgdGltZWQgb3V0
XG4iLAogCQkJICAgIGRpZ19wb3J0LT50Y19wb3J0X25hbWUpOwpAQCAtMjg4LDYgKzM0OSwzNCBA
QCBzdGF0aWMgYm9vbCBpY2xfdGNfcGh5X3Rha2Vfb3duZXJzaGlwKHN0cnVjdCBpbnRlbF9kaWdp
dGFsX3BvcnQgKmRpZ19wb3J0LAogCXJldHVybiB0cnVlOwogfQogCitzdGF0aWMgYm9vbCBhZGxf
dGNfcGh5X3Rha2Vfb3duZXJzaGlwKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0
LAorCQkJCSAgICAgIGJvb2wgdGFrZSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkx
NSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOworCXN0cnVjdCBpbnRlbF91bmNv
cmUgKnVuY29yZSA9ICZpOTE1LT51bmNvcmU7CisJZW51bSBwb3J0IHBvcnQgPSBkaWdfcG9ydC0+
YmFzZS5wb3J0OworCXUzMiB2YWw7CisKKwl2YWwgPSBpbnRlbF91bmNvcmVfcmVhZCh1bmNvcmUs
IERESV9CVUZfQ1RMKHBvcnQpKTsKKwlpZiAodGFrZSkKKwkJdmFsIHw9IERESV9CVUZfQ1RMX1RD
X1BIWV9PV05FUlNISVA7CisJZWxzZQorCQl2YWwgJj0gfkRESV9CVUZfQ1RMX1RDX1BIWV9PV05F
UlNISVA7CisJaW50ZWxfdW5jb3JlX3dyaXRlKHVuY29yZSwgRERJX0JVRl9DVEwocG9ydCksIHZh
bCk7CisKKwlyZXR1cm4gdHJ1ZTsKK30KKworc3RhdGljIGJvb2wgdGNfcGh5X3Rha2Vfb3duZXJz
aGlwKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0LCBib29sIHRha2UpCit7CisJ
c3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1KGRpZ19wb3J0LT5iYXNlLmJh
c2UuZGV2KTsKKworCWlmIChJU19BTERFUkxBS0VfUChpOTE1KSkKKwkJcmV0dXJuIGFkbF90Y19w
aHlfdGFrZV9vd25lcnNoaXAoZGlnX3BvcnQsIHRha2UpOworCisJcmV0dXJuIGljbF90Y19waHlf
dGFrZV9vd25lcnNoaXAoZGlnX3BvcnQsIHRha2UpOworfQorCiBzdGF0aWMgYm9vbCBpY2xfdGNf
cGh5X2lzX293bmVkKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQogewogCXN0
cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkxNShkaWdfcG9ydC0+YmFzZS5iYXNl
LmRldik7CkBAIC0zMDYsNiArMzk1LDI3IEBAIHN0YXRpYyBib29sIGljbF90Y19waHlfaXNfb3du
ZWQoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQpCiAJcmV0dXJuIHZhbCAmIERQ
X1BIWV9NT0RFX1NUQVRVU19OT1RfU0FGRShkaWdfcG9ydC0+dGNfcGh5X2ZpYV9pZHgpOwogfQog
CitzdGF0aWMgYm9vbCBhZGxfdGNfcGh5X2lzX293bmVkKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3Bv
cnQgKmRpZ19wb3J0KQoreworCXN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1ID0gdG9faTkx
NShkaWdfcG9ydC0+YmFzZS5iYXNlLmRldik7CisJc3RydWN0IGludGVsX3VuY29yZSAqdW5jb3Jl
ID0gJmk5MTUtPnVuY29yZTsKKwllbnVtIHBvcnQgcG9ydCA9IGRpZ19wb3J0LT5iYXNlLnBvcnQ7
CisJdTMyIHZhbDsKKworCXZhbCA9IGludGVsX3VuY29yZV9yZWFkKHVuY29yZSwgRERJX0JVRl9D
VEwocG9ydCkpOworCXJldHVybiB2YWwgJiBERElfQlVGX0NUTF9UQ19QSFlfT1dORVJTSElQOwor
fQorCitzdGF0aWMgYm9vbCB0Y19waHlfaXNfb3duZWQoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9y
dCAqZGlnX3BvcnQpCit7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmk5MTUgPSB0b19pOTE1
KGRpZ19wb3J0LT5iYXNlLmJhc2UuZGV2KTsKKworCWlmIChJU19BTERFUkxBS0VfUChpOTE1KSkK
KwkJcmV0dXJuIGFkbF90Y19waHlfaXNfb3duZWQoZGlnX3BvcnQpOworCisJcmV0dXJuIGljbF90
Y19waHlfaXNfb3duZWQoZGlnX3BvcnQpOworfQorCiAvKgogICogVGhpcyBmdW5jdGlvbiBpbXBs
ZW1lbnRzIHRoZSBmaXJzdCBwYXJ0IG9mIHRoZSBDb25uZWN0IEZsb3cgZGVzY3JpYmVkIGJ5IG91
cgogICogc3BlY2lmaWNhdGlvbiwgR2VuMTEgVHlwZUMgUHJvZ3JhbW1pbmcgY2hhcHRlci4gVGhl
IHJlc3Qgb2YgdGhlIGZsb3cgKHJlYWRpbmcKQEAgLTMyMywxMyArNDMzLDEzIEBAIHN0YXRpYyB2
b2lkIGljbF90Y19waHlfY29ubmVjdChzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0ICpkaWdfcG9y
dCwKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUoZGlnX3BvcnQtPmJh
c2UuYmFzZS5kZXYpOwogCWludCBtYXhfbGFuZXM7CiAKLQlpZiAoIWljbF90Y19waHlfc3RhdHVz
X2NvbXBsZXRlKGRpZ19wb3J0KSkgeworCWlmICghdGNfcGh5X3N0YXR1c19jb21wbGV0ZShkaWdf
cG9ydCkpIHsKIAkJZHJtX2RiZ19rbXMoJmk5MTUtPmRybSwgIlBvcnQgJXM6IFBIWSBub3QgcmVh
ZHlcbiIsCiAJCQkgICAgZGlnX3BvcnQtPnRjX3BvcnRfbmFtZSk7CiAJCWdvdG8gb3V0X3NldF90
YnRfYWx0X21vZGU7CiAJfQogCi0JaWYgKCFpY2xfdGNfcGh5X3Rha2Vfb3duZXJzaGlwKGRpZ19w
b3J0LCB0cnVlKSAmJgorCWlmICghdGNfcGh5X3Rha2Vfb3duZXJzaGlwKGRpZ19wb3J0LCB0cnVl
KSAmJgogCSAgICAhZHJtX1dBUk5fT04oJmk5MTUtPmRybSwgZGlnX3BvcnQtPnRjX2xlZ2FjeV9w
b3J0KSkKIAkJZ290byBvdXRfc2V0X3RidF9hbHRfbW9kZTsKIApAQCAtMzY0LDcgKzQ3NCw3IEBA
IHN0YXRpYyB2b2lkIGljbF90Y19waHlfY29ubmVjdChzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICpkaWdfcG9ydCwKIAlyZXR1cm47CiAKIG91dF9yZWxlYXNlX3BoeToKLQlpY2xfdGNfcGh5X3Rh
a2Vfb3duZXJzaGlwKGRpZ19wb3J0LCBmYWxzZSk7CisJdGNfcGh5X3Rha2Vfb3duZXJzaGlwKGRp
Z19wb3J0LCBmYWxzZSk7CiBvdXRfc2V0X3RidF9hbHRfbW9kZToKIAlkaWdfcG9ydC0+dGNfbW9k
ZSA9IFRDX1BPUlRfVEJUX0FMVDsKIH0KQEAgLTM4MCw3ICs0OTAsNyBAQCBzdGF0aWMgdm9pZCBp
Y2xfdGNfcGh5X2Rpc2Nvbm5lY3Qoc3RydWN0IGludGVsX2RpZ2l0YWxfcG9ydCAqZGlnX3BvcnQp
CiAJCS8qIE5vdGhpbmcgdG8gZG8sIHdlIG5ldmVyIGRpc2Nvbm5lY3QgZnJvbSBsZWdhY3kgbW9k
ZSAqLwogCQlicmVhazsKIAljYXNlIFRDX1BPUlRfRFBfQUxUOgotCQlpY2xfdGNfcGh5X3Rha2Vf
b3duZXJzaGlwKGRpZ19wb3J0LCBmYWxzZSk7CisJCXRjX3BoeV90YWtlX293bmVyc2hpcChkaWdf
cG9ydCwgZmFsc2UpOwogCQlkaWdfcG9ydC0+dGNfbW9kZSA9IFRDX1BPUlRfVEJUX0FMVDsKIAkJ
YnJlYWs7CiAJY2FzZSBUQ19QT1JUX1RCVF9BTFQ6CkBAIC0zOTUsMTMgKzUwNSwxMyBAQCBzdGF0
aWMgYm9vbCBpY2xfdGNfcGh5X2lzX2Nvbm5lY3RlZChzdHJ1Y3QgaW50ZWxfZGlnaXRhbF9wb3J0
ICpkaWdfcG9ydCkKIHsKIAlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSA9IHRvX2k5MTUo
ZGlnX3BvcnQtPmJhc2UuYmFzZS5kZXYpOwogCi0JaWYgKCFpY2xfdGNfcGh5X3N0YXR1c19jb21w
bGV0ZShkaWdfcG9ydCkpIHsKKwlpZiAoIXRjX3BoeV9zdGF0dXNfY29tcGxldGUoZGlnX3BvcnQp
KSB7CiAJCWRybV9kYmdfa21zKCZpOTE1LT5kcm0sICJQb3J0ICVzOiBQSFkgc3RhdHVzIG5vdCBj
b21wbGV0ZVxuIiwKIAkJCSAgICBkaWdfcG9ydC0+dGNfcG9ydF9uYW1lKTsKIAkJcmV0dXJuIGRp
Z19wb3J0LT50Y19tb2RlID09IFRDX1BPUlRfVEJUX0FMVDsKIAl9CiAKLQlpZiAoIWljbF90Y19w
aHlfaXNfb3duZWQoZGlnX3BvcnQpKSB7CisJaWYgKCF0Y19waHlfaXNfb3duZWQoZGlnX3BvcnQp
KSB7CiAJCWRybV9kYmdfa21zKCZpOTE1LT5kcm0sICJQb3J0ICVzOiBQSFkgbm90IG93bmVkXG4i
LAogCQkJICAgIGRpZ19wb3J0LT50Y19wb3J0X25hbWUpOwogCkBAIC00MTksOCArNTI5LDggQEAg
aW50ZWxfdGNfcG9ydF9nZXRfY3VycmVudF9tb2RlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQg
KmRpZ19wb3J0KQogCXUzMiBsaXZlX3N0YXR1c19tYXNrID0gdGNfcG9ydF9saXZlX3N0YXR1c19t
YXNrKGRpZ19wb3J0KTsKIAllbnVtIHRjX3BvcnRfbW9kZSBtb2RlOwogCi0JaWYgKCFpY2xfdGNf
cGh5X2lzX293bmVkKGRpZ19wb3J0KSB8fAotCSAgICBkcm1fV0FSTl9PTigmaTkxNS0+ZHJtLCAh
aWNsX3RjX3BoeV9zdGF0dXNfY29tcGxldGUoZGlnX3BvcnQpKSkKKwlpZiAoIXRjX3BoeV9pc19v
d25lZChkaWdfcG9ydCkgfHwKKwkgICAgZHJtX1dBUk5fT04oJmk5MTUtPmRybSwgIXRjX3BoeV9z
dGF0dXNfY29tcGxldGUoZGlnX3BvcnQpKSkKIAkJcmV0dXJuIFRDX1BPUlRfVEJUX0FMVDsKIAog
CW1vZGUgPSBkaWdfcG9ydC0+dGNfbGVnYWN5X3BvcnQgPyBUQ19QT1JUX0xFR0FDWSA6IFRDX1BP
UlRfRFBfQUxUOwpAQCAtNDQyLDcgKzU1Miw3IEBAIGludGVsX3RjX3BvcnRfZ2V0X3RhcmdldF9t
b2RlKHN0cnVjdCBpbnRlbF9kaWdpdGFsX3BvcnQgKmRpZ19wb3J0KQogCWlmIChsaXZlX3N0YXR1
c19tYXNrKQogCQlyZXR1cm4gZmxzKGxpdmVfc3RhdHVzX21hc2spIC0gMTsKIAotCXJldHVybiBp
Y2xfdGNfcGh5X3N0YXR1c19jb21wbGV0ZShkaWdfcG9ydCkgJiYKKwlyZXR1cm4gdGNfcGh5X3N0
YXR1c19jb21wbGV0ZShkaWdfcG9ydCkgJiYKIAkgICAgICAgZGlnX3BvcnQtPnRjX2xlZ2FjeV9w
b3J0ID8gVENfUE9SVF9MRUdBQ1kgOgogCQkJCQkgIFRDX1BPUlRfVEJUX0FMVDsKIH0KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcmVnLmggYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9pOTE1X3JlZy5oCmluZGV4IDFkMGNiNDIzNzIwZS4uY2U4ZjFlODkyNTIzIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3JlZy5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfcmVnLmgKQEAgLTEwMTMwLDYgKzEwMTMwLDcgQEAgZW51bSBza2xfcG93ZXJf
Z2F0ZSB7CiAjZGVmaW5lICBERElfQlVGX0VNUF9NQVNLCQkJKDB4ZiA8PCAyNCkKICNkZWZpbmUg
IERESV9CVUZfUE9SVF9SRVZFUlNBTAkJCSgxIDw8IDE2KQogI2RlZmluZSAgRERJX0JVRl9JU19J
RExFCQkJKDEgPDwgNykKKyNkZWZpbmUgIERESV9CVUZfQ1RMX1RDX1BIWV9PV05FUlNISVAJCVJF
R19CSVQoNikKICNkZWZpbmUgIERESV9BXzRfTEFORVMJCQkJKDEgPDwgNCkKICNkZWZpbmUgIERE
SV9QT1JUX1dJRFRIKHdpZHRoKQkJCSgoKHdpZHRoKSAtIDEpIDw8IDEpCiAjZGVmaW5lICBERElf
UE9SVF9XSURUSF9NQVNLCQkJKDcgPDwgMSkKQEAgLTEyNTYyLDYgKzEyNTYzLDE1IEBAIGVudW0g
c2tsX3Bvd2VyX2dhdGUgewogI2RlZmluZSAgIERQX1BJTl9BU1NJR05NRU5UX01BU0soaWR4KQkJ
KDB4ZiA8PCAoKGlkeCkgKiA0KSkKICNkZWZpbmUgICBEUF9QSU5fQVNTSUdOTUVOVChpZHgsIHgp
CQkoKHgpIDw8ICgoaWR4KSAqIDQpKQogCisjZGVmaW5lIF9UQ1NTX0RESV9TVEFUVVNfMQkJCTB4
MTYxNTAwCisjZGVmaW5lIF9UQ1NTX0RESV9TVEFUVVNfMgkJCTB4MTYxNTA0CisjZGVmaW5lIFRD
U1NfRERJX1NUQVRVUyh0YykJCQlfTU1JTyhfUElDS19FVkVOKHRjLCBcCisJCQkJCQkJCSBfVENT
U19ERElfU1RBVFVTXzEsIFwKKwkJCQkJCQkJIF9UQ1NTX0RESV9TVEFUVVNfMikpCisjZGVmaW5l
ICBUQ1NTX0RESV9TVEFUVVNfUkVBRFkJCQlSRUdfQklUKDIpCisjZGVmaW5lICBUQ1NTX0RESV9T
VEFUVVNfSFBEX0xJVkVfU1RBVFVTX1RCVAlSRUdfQklUKDEpCisjZGVmaW5lICBUQ1NTX0RESV9T
VEFUVVNfSFBEX0xJVkVfU1RBVFVTX0FMVAlSRUdfQklUKDApCisKIC8qIFRoaXMgcmVnaXN0ZXIg
Y29udHJvbHMgdGhlIERpc3BsYXkgU3RhdGUgQnVmZmVyIChEU0IpIGVuZ2luZXMuICovCiAjZGVm
aW5lIF9EU0JTTF9JTlNUQU5DRV9CQVNFCQkweDcwQjAwCiAjZGVmaW5lIERTQlNMX0lOU1RBTkNF
KHBpcGUsIGlkKQkoX0RTQlNMX0lOU1RBTkNFX0JBU0UgKyBcCi0tIAoyLjI1LjQKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkludGVsLWdmeCBtYWlsaW5n
IGxpc3QKSW50ZWwtZ2Z4QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVk
ZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2ludGVsLWdmeAo=

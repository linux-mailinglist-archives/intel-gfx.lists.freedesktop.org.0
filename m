Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 21415109866
	for <lists+intel-gfx@lfdr.de>; Tue, 26 Nov 2019 05:52:51 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4077189CC9;
	Tue, 26 Nov 2019 04:52:49 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0CF8C89C46
 for <intel-gfx@lists.freedesktop.org>; Tue, 26 Nov 2019 04:52:45 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 25 Nov 2019 20:52:44 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,244,1571727600"; d="scan'208";a="239788805"
Received: from unknown (HELO localhost.localdomain) ([10.223.165.29])
 by fmsmga002.fm.intel.com with ESMTP; 25 Nov 2019 20:52:43 -0800
From: Ankit Navik <ankit.p.navik@intel.com>
To: intel-gfx@lists.freedesktop.org
Date: Tue, 26 Nov 2019 10:21:38 +0530
Message-Id: <1574743899-17638-3-git-send-email-ankit.p.navik@intel.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1574743899-17638-1-git-send-email-ankit.p.navik@intel.com>
References: <1574743899-17638-1-git-send-email-ankit.p.navik@intel.com>
Subject: [Intel-gfx] [PATCH v6 2/3] drm/i915: set optimum eu/slice/sub-slice
 configuration based on load type
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: ankit.p.navik@intel.com, vipin.anand@intel.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCB3aWxsIHNlbGVjdCBvcHRpbXVtIGV1L3NsaWNlL3N1Yi1zbGljZSBjb25maWd1
cmF0aW9uIGJhc2VkIG9uCnR5cGUgb2YgbG9hZCAobG93LCBtZWRpdW0sIGhpZ2gpIGFzIGlucHV0
LgpCYXNlZCBvbiBvdXIgcmVhZGluZ3MgYW5kIGV4cGVyaW1lbnRzIHdlIGhhdmUgcHJlZGVmaW5l
ZCBzZXQgb2Ygb3B0aW11bQpjb25maWd1cmF0aW9uIGZvciBlYWNoIHBsYXRmb3JtKENIVCwgS0JM
KS4KaTkxNV9nZW1fY29udGV4dF9zZXRfbG9hZF90eXBlIHdpbGwgc2VsZWN0IG9wdGltdW0gY29u
ZmlndXJhdGlvbiBmcm9tCnByZS1kZWZpbmVkIG9wdGltdW0gY29uZmlndXJhdGlvbiB0YWJsZShv
cHRfY29uZmlnKS4KCkl0IGFsc28gaW50cm9kdWNlIGZsYWcgdXBkYXRlX3JlbmRlcl9jb25maWcg
d2hpY2ggY2FuIHNldCBieSBhbnkgZ292ZXJub3IuCgp2MjoKICogTW92ZSBzdGF0aWMgb3B0aW11
bV9jb25maWcgdG8gZGV2aWNlIGluaXQgdGltZS4KICogUmVuYW1lIGZ1bmN0aW9uIHRvIGFwcHJv
cHJpYXRlIG5hbWUsIGZpeCBkYXRhIHR5cGVzIGFuZCBwYXRjaCBvcmRlcmluZy4KICogUmVuYW1l
IHByZXZfbG9hZF90eXBlIHRvIHBlbmRpbmdfbG9hZF90eXBlLiAoVHZydGtvIFVyc3VsaW4pCgp2
MzoKICogQWRkIHNhZmUgZ3VhcmQgY2hlY2sgaW4gaTkxNV9nZW1fY29udGV4dF9zZXRfbG9hZF90
eXBlLgogKiBSZW5hbWUgc3RydWN0IGZyb20gb3B0aW11bV9jb25maWcgdG8gaTkxNV9zc2V1X29w
dGltdW1fY29uZmlnIHRvCiAgIGF2b2lkIG5hbWVzcGFjZSBjbGFzaGVzLgogKiBSZWR1Y2VzIG1l
bWNweSBmb3Igc3BhY2UgZWZmaWNpZW50LgogKiBSZWJhc2UuCiAqIEltcHJvdmVkIGNvbW1pdCBt
ZXNzYWdlLiAoVHZydGtvIFVyc3VsaW4pCgp2NDoKICogTW92ZSBvcHRpbXVtIGNvbmZpZyB0YWJs
ZSB0byBmaWxlIHNjb3BlLiAoVHZydGtvIFVyc3VsaW4pCgp2NToKICogQWRkcyBvcHRpbWFsIHRh
YmxlIG9mIHNsaWNlL3N1Yi1zbGljZS9FVSBmb3IgR2VuIDkgR1QxLgogKiBSZWJhc2UuCgp2NjoK
ICogUmViYXNlLgogKiBGaXggd2FybmluZ3MuCgpDYzogVmlwaW4gQW5hbmQgPHZpcGluLmFuYW5k
QGludGVsLmNvbT4KU2lnbmVkLW9mZi1ieTogQW5raXQgTmF2aWsgPGFua2l0LnAubmF2aWtAaW50
ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMg
ICAgICAgfCAxOCArKysrKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29u
dGV4dC5oICAgICAgIHwgIDIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2Nv
bnRleHRfdHlwZXMuaCB8IDMyICsrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfbHJjLmMgICAgICAgICAgICAgICB8IDQyICsrKysrKysrKysrKysrLQogZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV9kcnYuaCAgICAgICAgICAgICAgICAgICB8ICA1ICsrCiBkcml2ZXJz
L2dwdS9kcm0vaTkxNS9pbnRlbF9kZXZpY2VfaW5mby5jICAgICAgICAgIHwgNjIgKysrKysrKysr
KysrKysrKysrKysrKy0KIDYgZmlsZXMgY2hhbmdlZCwgMTU3IGluc2VydGlvbnMoKyksIDQgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2NvbnRleHQuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmMK
aW5kZXggODI4OGZiOS4uYWM5NGY5MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2NvbnRleHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkx
NV9nZW1fY29udGV4dC5jCkBAIC03MTMsMTAgKzcxMywyOCBAQCBpOTE1X2dlbV9jcmVhdGVfY29u
dGV4dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgdW5zaWduZWQgaW50IGZsYWdzKQog
CiAJdHJhY2VfaTkxNV9jb250ZXh0X2NyZWF0ZShjdHgpOwogCWF0b21pY19zZXQoJmN0eC0+cmVx
X2NudCwgMCk7CisJY3R4LT5zbGljZV9jbnQgPSBod2VpZ2h0OChSVU5USU1FX0lORk8oaTkxNSkt
PnNzZXUuc2xpY2VfbWFzayk7CisJY3R4LT5zdWJzbGljZV9jbnQgPSBod2VpZ2h0OChSVU5USU1F
X0lORk8oaTkxNSktPnNzZXUuc3Vic2xpY2VfbWFza1swXSk7CisJY3R4LT5ldV9jbnQgPSBSVU5U
SU1FX0lORk8oaTkxNSktPnNzZXUuZXVfcGVyX3N1YnNsaWNlOwogCiAJcmV0dXJuIGN0eDsKIH0K
IAordm9pZCBpOTE1X2dlbV9jb250ZXh0X3NldF9sb2FkX3R5cGUoc3RydWN0IGk5MTVfZ2VtX2Nv
bnRleHQgKmN0eCwKKwkJCQkgICAgZW51bSBnZW1fbG9hZF90eXBlIHR5cGUpCit7CisJc3RydWN0
IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gY3R4LT5pOTE1OworCisJaWYgKEdFTV9XQVJO
X09OKHR5cGUgPiBMT0FEX1RZUEVfTEFTVCkpCisJCXJldHVybjsKKworCS8qIENhbGwgb3B0X2Nv
bmZpZyB0byBnZXQgY29ycmVjdCBjb25maWd1cmF0aW9uIGZvciBldSxzbGljZSxzdWJzbGljZSAq
LworCWN0eC0+c2xpY2VfY250ID0gZGV2X3ByaXYtPm9wdF9jb25maWdbdHlwZV0uc2xpY2U7CisJ
Y3R4LT5zdWJzbGljZV9jbnQgPSBkZXZfcHJpdi0+b3B0X2NvbmZpZ1t0eXBlXS5zdWJzbGljZTsK
KwljdHgtPmV1X2NudCA9IGRldl9wcml2LT5vcHRfY29uZmlnW3R5cGVdLmV1OworCWN0eC0+cGVu
ZGluZ19sb2FkX3R5cGUgPSB0eXBlOworfQorCiBzdGF0aWMgdm9pZAogZGVzdHJveV9rZXJuZWxf
Y29udGV4dChzdHJ1Y3QgaTkxNV9nZW1fY29udGV4dCAqKmN0eHApCiB7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHQuaAppbmRleCAxOGU1MGE3Li44Njc3NDI3IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dC5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0LmgKQEAgLTE3Nyw2
ICsxNzcsOCBAQCBpbnQgaTkxNV9nZW1fY29udGV4dF9zZXRwYXJhbV9pb2N0bChzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJCSAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGVf
cHJpdik7CiBpbnQgaTkxNV9nZW1fY29udGV4dF9yZXNldF9zdGF0c19pb2N0bChzdHJ1Y3QgZHJt
X2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCQkJCSAgICAgICBzdHJ1Y3QgZHJtX2ZpbGUgKmZp
bGUpOwordm9pZCBpOTE1X2dlbV9jb250ZXh0X3NldF9sb2FkX3R5cGUoc3RydWN0IGk5MTVfZ2Vt
X2NvbnRleHQgKmN0eCwKKwkJCQllbnVtIGdlbV9sb2FkX3R5cGUgdHlwZSk7CiAKIHN0cnVjdCBp
OTE1X2dlbV9jb250ZXh0ICoKIGk5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2tlcm5lbChzdHJ1Y3Qg
ZHJtX2k5MTVfcHJpdmF0ZSAqaTkxNSwgaW50IHByaW8pOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9jb250ZXh0X3R5cGVzLmgKaW5kZXggMzkzMWMwNi4uNjg0N2Q0
OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NvbnRleHRf
dHlwZXMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY29udGV4dF90
eXBlcy5oCkBAIC00MCw2ICs0MCwxOSBAQCBzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lc19pdGVyIHsK
IAljb25zdCBzdHJ1Y3QgaTkxNV9nZW1fZW5naW5lcyAqZW5naW5lczsKIH07CiAKK2VudW0gZ2Vt
X2xvYWRfdHlwZSB7CisJTE9BRF9UWVBFX0xPVywKKwlMT0FEX1RZUEVfTUVESVVNLAorCUxPQURf
VFlQRV9ISUdILAorCUxPQURfVFlQRV9MQVNUCit9OworCitzdHJ1Y3QgaTkxNV9zc2V1X29wdGlt
dW1fY29uZmlnIHsKKwl1OCBzbGljZTsKKwl1OCBzdWJzbGljZTsKKwl1OCBldTsKK307CisKIC8q
KgogICogc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgLSBjbGllbnQgc3RhdGUKICAqCkBAIC0xNzMs
NiArMTg2LDI1IEBAIHN0cnVjdCBpOTE1X2dlbV9jb250ZXh0IHsKIAkgKi8KIAlhdG9taWNfdCBy
ZXFfY250OwogCisJLyoqIHNsaWNlX2NudDogdXNlZCB0byBzZXQgdGhlICMgb2Ygc2xpY2VzIHRv
IGJlIGVuYWJsZWQuICovCisJdTggc2xpY2VfY250OworCisJLyoqIHN1YnNsaWNlX2NudDogdXNl
ZCB0byBzZXQgdGhlICMgb2Ygc3Vic2xpY2VzIHRvIGJlIGVuYWJsZWQuICovCisJdTggc3Vic2xp
Y2VfY250OworCisJLyoqIGV1X2NudDogdXNlZCB0byBzZXQgdGhlICMgb2YgZXUgdG8gYmUgZW5h
YmxlZC4gKi8KKwl1OCBldV9jbnQ7CisKKwkvKiogbG9hZF90eXBlOiBUaGUgZGVzaWduYXRlZCBs
b2FkX3R5cGUgKGhpZ2gvbWVkaXVtL2xvdykgZm9yIGEgZ2l2ZW4KKwkgKiBudW1iZXIgb2YgcGVu
ZGluZyBjb21tYW5kcyBpbiB0aGUgY29tbWFuZCBxdWV1ZS4KKwkgKi8KKwllbnVtIGdlbV9sb2Fk
X3R5cGUgbG9hZF90eXBlOworCisJLyoqIHBlbmRpbmdfbG9hZF90eXBlOiBUaGUgZWFybGllciBs
b2FkIHR5cGUgdGhhdCB0aGUgR1BVIHdhcyBjb25maWd1cmVkCisJICogZm9yIChoaWdoL21lZGl1
bS9sb3cpLgorCSAqLworCWVudW0gZ2VtX2xvYWRfdHlwZSBwZW5kaW5nX2xvYWRfdHlwZTsKKwog
CS8qKiBqdW1wX3doaXRlbGlzdDogQml0IGFycmF5IGZvciB0cmFja2luZyBjbWRzIGR1cmluZyBj
bWRwYXJzaW5nCiAJICogIEd1YXJkZWQgYnkgc3RydWN0X211dGV4CiAJICovCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9scmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2xyYy5jCmluZGV4IDUxMWQ1YTEuLmMzZjI3OWUgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2xyYy5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d0L2ludGVsX2xyYy5jCkBAIC0yNDM2LDYgKzI0MzYsMzYgQEAgc3RhdGljIHZvaWQgZXhl
Y2xpc3RzX2NvbnRleHRfdW5waW4oc3RydWN0IGludGVsX2NvbnRleHQgKmNlKQogCWludGVsX3Jp
bmdfcmVzZXQoY2UtPnJpbmcsIGNlLT5yaW5nLT50YWlsKTsKIH0KIAorc3RhdGljIHUzMgorZ2V0
X2NvbnRleHRfcnBjc19jb25maWcoc3RydWN0IGk5MTVfZ2VtX2NvbnRleHQgKmN0eCkKK3sKKwl1
MzIgcnBjcyA9IDA7CisJc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2ID0gY3R4LT5p
OTE1OworCisJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPCA4KQorCQlyZXR1cm4gMDsKKworCWlm
IChSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1Lmhhc19zbGljZV9wZykgeworCQlycGNzIHw9
IEdFTjhfUlBDU19TX0NOVF9FTkFCTEU7CisJCXJwY3MgfD0gY3R4LT5zbGljZV9jbnQgPDwgR0VO
OF9SUENTX1NfQ05UX1NISUZUOworCQlycGNzIHw9IEdFTjhfUlBDU19FTkFCTEU7CisJfQorCisJ
aWYgKFJVTlRJTUVfSU5GTyhkZXZfcHJpdiktPnNzZXUuaGFzX3N1YnNsaWNlX3BnKSB7CisJCXJw
Y3MgfD0gR0VOOF9SUENTX1NTX0NOVF9FTkFCTEU7CisJCXJwY3MgfD0gY3R4LT5zdWJzbGljZV9j
bnQgPDwgR0VOOF9SUENTX1NTX0NOVF9TSElGVDsKKwkJcnBjcyB8PSBHRU44X1JQQ1NfRU5BQkxF
OworCX0KKworCWlmIChSVU5USU1FX0lORk8oZGV2X3ByaXYpLT5zc2V1Lmhhc19ldV9wZykgewor
CQlycGNzIHw9IGN0eC0+ZXVfY250IDw8IEdFTjhfUlBDU19FVV9NSU5fU0hJRlQ7CisJCXJwY3Mg
fD0gY3R4LT5ldV9jbnQgPDwgR0VOOF9SUENTX0VVX01BWF9TSElGVDsKKwkJcnBjcyB8PSBHRU44
X1JQQ1NfRU5BQkxFOworCX0KKworCXJldHVybiBycGNzOworfQorCiBzdGF0aWMgdm9pZAogX19l
eGVjbGlzdHNfdXBkYXRlX3JlZ19zdGF0ZShjb25zdCBzdHJ1Y3QgaW50ZWxfY29udGV4dCAqY2Us
CiAJCQkgICAgIGNvbnN0IHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSkKQEAgLTI0NTIs
OCArMjQ4MiwxMyBAQCBfX2V4ZWNsaXN0c191cGRhdGVfcmVnX3N0YXRlKGNvbnN0IHN0cnVjdCBp
bnRlbF9jb250ZXh0ICpjZSwKIAogCS8qIFJQQ1MgKi8KIAlpZiAoZW5naW5lLT5jbGFzcyA9PSBS
RU5ERVJfQ0xBU1MpIHsKLQkJcmVnc1tDVFhfUl9QV1JfQ0xLX1NUQVRFXSA9Ci0JCQlpbnRlbF9z
c2V1X21ha2VfcnBjcyhlbmdpbmUtPmk5MTUsICZjZS0+c3NldSk7CisJCWlmIChlbmdpbmUtPmk5
MTUtPnByZWRpY3RpdmVfbG9hZF9lbmFibGUpIHsKKwkJCXJlZ3NbQ1RYX1JfUFdSX0NMS19TVEFU
RV0gPQorCQkJCWdldF9jb250ZXh0X3JwY3NfY29uZmlnKGNlLT5nZW1fY29udGV4dCk7CisJCX0g
ZWxzZSB7CisJCQlyZWdzW0NUWF9SX1BXUl9DTEtfU1RBVEVdID0KKwkJCQlpbnRlbF9zc2V1X21h
a2VfcnBjcyhlbmdpbmUtPmk5MTUsICZjZS0+c3NldSk7CisJCX0KIAogCQlpOTE1X29hX2luaXRf
cmVnX3N0YXRlKGNlLCBlbmdpbmUpOwogCX0KQEAgLTI0ODUsNiArMjUyMCw5IEBAIF9fZXhlY2xp
c3RzX2NvbnRleHRfcGluKHN0cnVjdCBpbnRlbF9jb250ZXh0ICpjZSwKIAljZS0+bHJjX3JlZ19z
dGF0ZSA9IHZhZGRyICsgTFJDX1NUQVRFX1BOICogUEFHRV9TSVpFOwogCV9fZXhlY2xpc3RzX3Vw
ZGF0ZV9yZWdfc3RhdGUoY2UsIGVuZ2luZSk7CiAKKwlpZiAoY2UtPmdlbV9jb250ZXh0LT5sb2Fk
X3R5cGUgIT0gY2UtPmdlbV9jb250ZXh0LT5wZW5kaW5nX2xvYWRfdHlwZSkKKwkJY2UtPmdlbV9j
b250ZXh0LT5sb2FkX3R5cGUgPSBjZS0+Z2VtX2NvbnRleHQtPnBlbmRpbmdfbG9hZF90eXBlOwor
CiAJcmV0dXJuIDA7CiAKIHVucGluX2FjdGl2ZToKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4
IGZkYWU1YTkuLjMwNjRkZGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtOTk5LDYgKzk5
OSwxMSBAQCBzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSB7CiAJLyogcHJvdGVjdHMgcGFuZWwgcG93
ZXIgc2VxdWVuY2VyIHN0YXRlICovCiAJc3RydWN0IG11dGV4IHBwc19tdXRleDsKIAorCS8qIG9w
dGltYWwgc2xpY2Uvc3Vic2xpY2UvRVUgY29uZmlncmF0aW9uIHN0YXRlICovCisJc3RydWN0IGk5
MTVfc3NldV9vcHRpbXVtX2NvbmZpZyAqb3B0X2NvbmZpZzsKKworCWludCBwcmVkaWN0aXZlX2xv
YWRfZW5hYmxlOworCiAJdW5zaWduZWQgaW50IGZzYl9mcmVxLCBtZW1fZnJlcSwgaXNfZGRyMzsK
IAl1bnNpZ25lZCBpbnQgc2tsX3ByZWZlcnJlZF92Y29fZnJlcTsKIAl1bnNpZ25lZCBpbnQgbWF4
X2NkY2xrX2ZyZXE7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRlbF9kZXZp
Y2VfaW5mby5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaW50ZWxfZGV2aWNlX2luZm8uYwppbmRl
eCBhNWI1NzEzLi5iM2MyZjkyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pbnRl
bF9kZXZpY2VfaW5mby5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2ludGVsX2RldmljZV9p
bmZvLmMKQEAgLTg3Myw2ICs4NzMsMzQgQEAgdm9pZCBpbnRlbF9kZXZpY2VfaW5mb19zdWJwbGF0
Zm9ybV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICppOTE1KQogCVJVTlRJTUVfSU5GTyhp
OTE1KS0+cGxhdGZvcm1fbWFza1twaV0gfD0gbWFzazsKIH0KIAorLyogc3RhdGljIHRhYmxlIG9m
IHNsaWNlL3N1YnNsaWNlL0VVIGZvciBDaGVycnl2aWV3ICovCitzdGF0aWMgY29uc3Qgc3RydWN0
IGk5MTVfc3NldV9vcHRpbXVtX2NvbmZpZyBjaHZfY29uZmlnW0xPQURfVFlQRV9MQVNUXSA9IHsK
Kwl7MSwgMSwgNH0sCS8qIExvdyAqLworCXsxLCAxLCA2fSwJLyogTWVkaXVtICovCisJezEsIDIs
IDZ9CS8qIEhpZ2ggKi8KK307CisKKy8qIHN0YXRpYyB0YWJsZSBvZiBzbGljZS9zdWJzbGljZS9F
VSBmb3IgR0xLIEdUMSAqLworc3RhdGljIGNvbnN0IHN0cnVjdCBpOTE1X3NzZXVfb3B0aW11bV9j
b25maWcgZ2xrX2d0MV9jb25maWdbTE9BRF9UWVBFX0xBU1RdID0geworCXsxLCAyLCAyfSwJLyog
TG93ICovCisJezEsIDIsIDN9LAkvKiBNZWRpdW0gKi8KKwl7MSwgMiwgNn0JLyogSGlnaCAqLwor
fTsKKworLyogc3RhdGljIHRhYmxlIG9mIHNsaWNlL3N1YnNsaWNlL0VVIGZvciBLQkwgR1QyICov
CitzdGF0aWMgY29uc3Qgc3RydWN0IGk5MTVfc3NldV9vcHRpbXVtX2NvbmZpZyBrYmxfZ3QyX2Nv
bmZpZ1tMT0FEX1RZUEVfTEFTVF0gPSB7CisJezEsIDMsIDJ9LAkvKiBMb3cgKi8KKwl7MSwgMywg
NH0sCS8qIE1lZGl1bSAqLworCXsxLCAzLCA4fQkvKiBIaWdoICovCit9OworCisvKiBzdGF0aWMg
dGFibGUgb2Ygc2xpY2Uvc3Vic2xpY2UvRVUgZm9yIEtCTCBHVDMgKi8KK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgaTkxNV9zc2V1X29wdGltdW1fY29uZmlnIGtibF9ndDNfY29uZmlnW0xPQURfVFlQRV9M
QVNUXSA9IHsKKwl7MiwgMywgNH0sCS8qIExvdyAqLworCXsyLCAzLCA2fSwJLyogTWVkaXVtICov
CisJezIsIDMsIDh9CS8qIEhpZ2ggKi8KK307CisKIC8qKgogICogaW50ZWxfZGV2aWNlX2luZm9f
cnVudGltZV9pbml0IC0gaW5pdGlhbGl6ZSBydW50aW1lIGluZm8KICAqIEBkZXZfcHJpdjogdGhl
IGk5MTUgZGV2aWNlCkBAIC04OTQsNiArOTIyLDcgQEAgdm9pZCBpbnRlbF9kZXZpY2VfaW5mb19y
dW50aW1lX2luaXQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogCXN0cnVjdCBp
bnRlbF9kZXZpY2VfaW5mbyAqaW5mbyA9IG1rd3JpdGVfZGV2aWNlX2luZm8oZGV2X3ByaXYpOwog
CXN0cnVjdCBpbnRlbF9ydW50aW1lX2luZm8gKnJ1bnRpbWUgPSBSVU5USU1FX0lORk8oZGV2X3By
aXYpOwogCWVudW0gcGlwZSBwaXBlOworCXN0cnVjdCBpOTE1X3NzZXVfb3B0aW11bV9jb25maWcg
Km9wdF9jb25maWcgPSBOVUxMOwogCiAJaWYgKElOVEVMX0dFTihkZXZfcHJpdikgPj0gMTApIHsK
IAkJZm9yX2VhY2hfcGlwZShkZXZfcHJpdiwgcGlwZSkKQEAgLTk5OSwxMiArMTAyOCwzOCBAQCB2
b2lkIGludGVsX2RldmljZV9pbmZvX3J1bnRpbWVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0
ZSAqZGV2X3ByaXYpCiAJLyogSW5pdGlhbGl6ZSBzbGljZS9zdWJzbGljZS9FVSBpbmZvICovCiAJ
aWYgKElTX0hBU1dFTEwoZGV2X3ByaXYpKQogCQloYXN3ZWxsX3NzZXVfaW5mb19pbml0KGRldl9w
cml2KTsKLQllbHNlIGlmIChJU19DSEVSUllWSUVXKGRldl9wcml2KSkKKwllbHNlIGlmIChJU19D
SEVSUllWSUVXKGRldl9wcml2KSkgewogCQljaGVycnl2aWV3X3NzZXVfaW5mb19pbml0KGRldl9w
cml2KTsKKwkJb3B0X2NvbmZpZyA9IChzdHJ1Y3QgaTkxNV9zc2V1X29wdGltdW1fY29uZmlnICop
Y2h2X2NvbmZpZzsKKwkJQlVJTERfQlVHX09OKEFSUkFZX1NJWkUoY2h2X2NvbmZpZykgIT0gTE9B
RF9UWVBFX0xBU1QpOworCX0KIAllbHNlIGlmIChJU19CUk9BRFdFTEwoZGV2X3ByaXYpKQogCQli
cm9hZHdlbGxfc3NldV9pbmZvX2luaXQoZGV2X3ByaXYpOwotCWVsc2UgaWYgKElTX0dFTihkZXZf
cHJpdiwgOSkpCisJZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2LCA5KSkgewogCQlnZW45X3NzZXVf
aW5mb19pbml0KGRldl9wcml2KTsKKworCQlzd2l0Y2ggKGluZm8tPmd0KSB7CisJCWRlZmF1bHQ6
IC8qIGZhbGwgdGhyb3VnaCAqLworCQljYXNlIDE6CisJCQlvcHRfY29uZmlnID0gKHN0cnVjdCBp
OTE1X3NzZXVfb3B0aW11bV9jb25maWcgKikKKwkJCQkJCWdsa19ndDFfY29uZmlnOworCQkJQlVJ
TERfQlVHX09OKEFSUkFZX1NJWkUoZ2xrX2d0MV9jb25maWcpCisJCQkJCQkhPSBMT0FEX1RZUEVf
TEFTVCk7CisJCWJyZWFrOworCQljYXNlIDI6CisJCQlvcHRfY29uZmlnID0gKHN0cnVjdCBpOTE1
X3NzZXVfb3B0aW11bV9jb25maWcgKikKKwkJCQkJCWtibF9ndDJfY29uZmlnOworCQkJQlVJTERf
QlVHX09OKEFSUkFZX1NJWkUoa2JsX2d0Ml9jb25maWcpCisJCQkJCQkhPSBMT0FEX1RZUEVfTEFT
VCk7CisJCWJyZWFrOworCQljYXNlIDM6CisJCQlvcHRfY29uZmlnID0gKHN0cnVjdCBpOTE1X3Nz
ZXVfb3B0aW11bV9jb25maWcgKikKKwkJCQkJCWtibF9ndDNfY29uZmlnOworCQkJQlVJTERfQlVH
X09OKEFSUkFZX1NJWkUoa2JsX2d0M19jb25maWcpCisJCQkJCQkhPSBMT0FEX1RZUEVfTEFTVCk7
CisJCWJyZWFrOworCQl9CisJfQogCWVsc2UgaWYgKElTX0dFTihkZXZfcHJpdiwgMTApKQogCQln
ZW4xMF9zc2V1X2luZm9faW5pdChkZXZfcHJpdik7CiAJZWxzZSBpZiAoSVNfR0VOKGRldl9wcml2
LCAxMSkpCkBAIC0xMDE3LDYgKzEwNzIsOSBAQCB2b2lkIGludGVsX2RldmljZV9pbmZvX3J1bnRp
bWVfaW5pdChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYpCiAJCWluZm8tPnBwZ3R0
X3R5cGUgPSBJTlRFTF9QUEdUVF9OT05FOwogCX0KIAorCWlmIChvcHRfY29uZmlnKQorCQlkZXZf
cHJpdi0+b3B0X2NvbmZpZyA9IG9wdF9jb25maWc7CisKIAkvKiBJbml0aWFsaXplIGNvbW1hbmQg
c3RyZWFtIHRpbWVzdGFtcCBmcmVxdWVuY3kgKi8KIAlydW50aW1lLT5jc190aW1lc3RhbXBfZnJl
cXVlbmN5X2toeiA9IHJlYWRfdGltZXN0YW1wX2ZyZXF1ZW5jeShkZXZfcHJpdik7CiB9Ci0tIAoy
LjcuNAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KSW50
ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ2Z4

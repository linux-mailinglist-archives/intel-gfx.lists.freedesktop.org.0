Return-Path: <intel-gfx-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gfx@lfdr.de
Delivered-To: lists+intel-gfx@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1413F1419DD
	for <lists+intel-gfx@lfdr.de>; Sat, 18 Jan 2020 22:29:47 +0100 (CET)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7D6136E151;
	Sat, 18 Jan 2020 21:29:45 +0000 (UTC)
X-Original-To: intel-gfx@lists.freedesktop.org
Delivered-To: intel-gfx@lists.freedesktop.org
Received: from fireflyinternet.com (mail.fireflyinternet.com [109.228.58.192])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E21896E151
 for <intel-gfx@lists.freedesktop.org>; Sat, 18 Jan 2020 21:29:43 +0000 (UTC)
X-Default-Received-SPF: pass (skip=forwardok (res=PASS))
 x-ip-name=78.156.65.138; 
Received: from haswell.alporthouse.com (unverified [78.156.65.138]) 
 by fireflyinternet.com (Firefly Internet (M1)) with ESMTP id 19931064-1500050 
 for multiple; Sat, 18 Jan 2020 21:29:04 +0000
From: Chris Wilson <chris@chris-wilson.co.uk>
To: intel-gfx@lists.freedesktop.org
Date: Sat, 18 Jan 2020 21:29:03 +0000
Message-Id: <20200118212903.3606443-2-chris@chris-wilson.co.uk>
X-Mailer: git-send-email 2.25.0
In-Reply-To: <20200118212903.3606443-1-chris@chris-wilson.co.uk>
References: <20200118212903.3606443-1-chris@chris-wilson.co.uk>
MIME-Version: 1.0
Subject: [Intel-gfx] [RFC 2/2] drm/i915/gem: Introduce VM_WAIT,
 a futex-lite operation
X-BeenThere: intel-gfx@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Intel graphics driver community testing & development
 <intel-gfx.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gfx>
List-Post: <mailto:intel-gfx@lists.freedesktop.org>
List-Help: <mailto:intel-gfx-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gfx>,
 <mailto:intel-gfx-request@lists.freedesktop.org?subject=subscribe>
Cc: "Kristian H . Kristensen" <hoegsberg@google.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gfx-bounces@lists.freedesktop.org
Sender: "Intel-gfx" <intel-gfx-bounces@lists.freedesktop.org>

Q3VycmVudGx5LCB3ZSBvbmx5IGFsbG93IHdhaXRpbmcgb24gdGhlIGZvcndhcmQgcHJvZ3Jlc3Mg
b2YgYW4gaW5kaXZpZHVhbApHRU0gb2JqZWN0LCBvciBvZiBhIEdFTSBleGVjYnVmIGZlbmNlLiBU
aGUgcHJpbWFyeSBwdXJwb3NlIG9mIHRoZSBmZW5jZQppcyB0byBwcm92aWRlIGEgc2NoZWR1bGlu
ZyBwcmltaXRpdmUgdG8gb3JkZXIgdGhlIGV4ZWN1dGlvbiBmbG93IG9mCmJhdGNoZXMgKGNmIFZr
U2VtcGFob3JlKS4KClVzZXJzcGFjZSBpbnN0ZWFkIHVzZXMgdmFsdWVzIGluIG1lbW9yeSB0byBp
bXBsZW1lbnQgY2xpZW50IGZlbmNlcywgYW5kCmhhcyB0byBtaXggYnVzeXdhaXRpbmcgb24gdGhl
IHZhbHVlIGNvdXBsZWQgd2l0aCBhIGRtYV9mZW5jZSBpbiBjYXNlIGl0Cm5lZWRzIHRvIHNsZWVw
LiBJdCBoYXMgbm8gaW50ZXJtZWRpYXRlIHN0ZXAgd2hlcmUgaXQgY2FuIHdhaXQgb24gdGhlCm1l
bW9yeSB2YWx1ZSBpdHNlbGYgdG8gY2hhbmdlLCB3aGljaCBpcyByZXF1aXJlZCBmb3Igc2NlbmFy
aW9zIHdoZXJlIHRoZQpkbWFfZmVuY2UgbWF5IGluY3VyIHRvbyBtdWNoIGV4ZWN1dGlvbiBsYXRl
bmN5LgoKVGhlIENQVSBlcXVpdmFsZW50IGlzIGEgZnV0ZXgtc3lzY2FsbCB1c2VkIHRvIHNldHVw
IGEgd2FpdGVyL3dha2VyIGJhc2VkCm9uIGEgbWVtb3J5IGxvY2F0aW9uLiBUaGlzIGlzIHVzZWQg
dG8gaW1wbGVtZW50IGFuIGVmZmljaWVudCBzbGVlcCBmb3IKcHRocmVhZF9tdXRleF90LCB3aGVy
ZSB0aGUgZmFzdCB1bmNvbnRlbmRlZCBwYXRoIGNhbiBiZSBoYW5kbGVkIGVudGlyZWx5CmluIHVz
ZXJzcGFjZS4KClRoaXMgcGF0Y2ggaW1wbGVtZW50cyBhIHNpbWlsYXIgaWRlYSwgd2hlcmUgd2Ug
dGFrZSBhIHZpcnR1YWwgYWRkcmVzcyBpbgp0aGUgY2xpZW50J3MgcHBHVFQgYW5kIGluc3RhbGwg
YW4gaW50ZXJydXB0IGhhbmRsZXIgdG8gd2FrZSB1cCB0aGUKY3VycmVudCB0YXNrIHdoZW4gdGhl
IG1lbW9yeSBsb2NhdGlvbiBwYXNzZXMgdGhlIHVzZXIgc3VwcGxpZWQgZmlsdGVyLgpJdCBhbHNv
IGFsbG93cyB0aGUgdXNlciB0byBlbWl0IHRoZWlyIG93biBNSV9VU0VSX0lOVEVSUlVQVCB3aXRo
aW4gdGhlaXIKYmF0Y2hlcyBhZnRlciB1cGRhdGluZyB0aGUgdmFsdWUgb24gdGhlIEdQVSB0byBo
YXZlIHN1Yi1iYXRjaCBwcmVjaXNpb24Kb24gdGhlIHdha2V1cC4KCk9wZW5zOgoKLSBvbiBhdHRh
Y2hpbmcgdGhlIHdhaXRlciwgd2UgZW5hYmxlIGludGVycnVwdHMgb24gYWxsIGVuZ2luZXMsCmly
cmVzcGVjdGl2ZSBvZiB3aGljaCBhcmUgYWN0aXZlIHRvIGEgVk0uCiAqIHdlIGNhbiBvcHRpbWlz
ZSB3aGVuIHRvIGVuYWJsZSBpbnRlcnJ1cHRzIHdoaWxlIHRoZSBWTSBpcyBhY3RpdmUKICogd2Ug
Y2FuIGV4dGVuZCB0aGUgaW50ZXJmYWNlIGZvciB0aGUgdXNlciB0byBzZWxlY3Qgd2hpY2ggZW5n
aW5lcyBtYXkKICAgd2FrZSB1cwoKLSB3ZSBjb3VsZCByZXR1cm4gYW4gZmQgd3JhcHBpbmcgdGhl
IGNvbXBhcmlzb24gb3BlcmF0aW9uIG9uIHRoZSBtZW1vcnkKYWRkcmVzcyBpZiB3ZSB3YW50IHRv
IHBhc3MgdGhlIHdhaXRlciBhcm91bmQgZGlmZmVyZW50IHByb2Nlc3NlcyBvcgpyZXVzZSB0aGUg
d2FpdGVyICh3aXRoIHBvbGwoKSArIHJlYWQoKSBsaWtlIHRpbWVyZmQpLgoKUmVmZXJlbmNlczog
YjJjOTdiYzc4OTE5ICgiYW52L3F1ZXJ5OiBCdXN5LXdhaXQgZm9yIGF2YWlsYWJsZSBxdWVyeSBl
bnRyaWVzIikKUmVmZXJlbmNlczogaHR0cHM6Ly9naXRsYWIuZnJlZWRlc2t0b3Aub3JnL21lc2Ev
bWVzYS9tZXJnZV9yZXF1ZXN0cy8zMjc5I25vdGVfMzc3MjQwClRlc3RjYXNlOiBpZ3QvZ2VtX3Zt
X3dhaXQKU2lnbmVkLW9mZi1ieTogQ2hyaXMgV2lsc29uIDxjaHJpc0BjaHJpcy13aWxzb24uY28u
dWs+CkNjOiBUdnJ0a28gVXJzdWxpbiA8dHZydGtvLnVyc3VsaW5AaW50ZWwuY29tPgpDYzogSmFz
b24gRWtzdHJhbmQgPGphc29uQGpsZWtzdHJhbmQubmV0PgpDYzogS3Jpc3RpYW4gSC4gS3Jpc3Rl
bnNlbiA8aG9lZ3NiZXJnQGdvb2dsZS5jb20+CkNjOiBKb29uYXMgTGFodGluZW4gPGpvb25hcy5s
YWh0aW5lbkBsaW51eC5pbnRlbC5jb20+Ci0tLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZp
bGUgICAgICAgICAgICAgICAgfCAgIDEgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVf
Z2VtX2lvY3Rscy5oICAgfCAgIDIgKwogZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X3ZtLmMgICAgICAgfCAzODAgKysrKysrKysrKysrKysrKysrKwogZHJpdmVycy9ncHUvZHJtL2k5
MTUvZ3QvaW50ZWxfYnJlYWRjcnVtYnMuYyAgfCAgNDMgKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkx
NS9ndC9pbnRlbF9lbmdpbmUuaCAgICAgICB8ICAgNSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9lbmdpbmVfdHlwZXMuaCB8ICAgMSArCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X2Rydi5jICAgICAgICAgICAgICB8ICAgMSArCiBpbmNsdWRlL3VhcGkvZHJtL2k5MTVfZHJtLmgg
ICAgICAgICAgICAgICAgICB8ICAzNiArKwogOCBmaWxlcyBjaGFuZ2VkLCA0NjkgaW5zZXJ0aW9u
cygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV92bS5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUgYi9kcml2
ZXJzL2dwdS9kcm0vaTkxNS9NYWtlZmlsZQppbmRleCAzYzg4ZDdkOGM3NjQuLjVlMTQ0MWNmMTJk
OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvTWFrZWZpbGUKQEAgLTEzOSw2ICsxMzksNyBAQCBnZW0teSArPSBcCiAJ
Z2VtL2k5MTVfZ2VtX3Rocm90dGxlLm8gXAogCWdlbS9pOTE1X2dlbV90aWxpbmcubyBcCiAJZ2Vt
L2k5MTVfZ2VtX3VzZXJwdHIubyBcCisJZ2VtL2k5MTVfZ2VtX3ZtLm8gXAogCWdlbS9pOTE1X2dl
bV93YWl0Lm8gXAogCWdlbS9pOTE1X2dlbWZzLm8KIGk5MTUteSArPSBcCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1faW9jdGxzLmggYi9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1faW9jdGxzLmgKaW5kZXggODdkOGIyN2Y0MjZkLi45MmYyNjVj
ODQyOTAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9pb2N0
bHMuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1faW9jdGxzLmgKQEAg
LTQ4LDUgKzQ4LDcgQEAgaW50IGk5MTVfZ2VtX3VzZXJwdHJfaW9jdGwoc3RydWN0IGRybV9kZXZp
Y2UgKmRldiwgdm9pZCAqZGF0YSwKIAkJCSAgIHN0cnVjdCBkcm1fZmlsZSAqZmlsZSk7CiBpbnQg
aTkxNV9nZW1fd2FpdF9pb2N0bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAog
CQkJc3RydWN0IGRybV9maWxlICpmaWxlKTsKK2ludCBpOTE1X2dlbV92bV93YWl0X2lvY3RsKHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCisJCQkgICBzdHJ1Y3QgZHJtX2ZpbGUg
KmZpbGUpOwogCiAjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV92bS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3ZtLmMKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5kOWExZGUzZWM0YTkKLS0tIC9k
ZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdm0uYwpAQCAt
MCwwICsxLDM4MCBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVAorLyoKKyAqIENv
cHlyaWdodCDCqSAyMDIwIEludGVsIENvcnBvcmF0aW9uCisgKi8KKworI2luY2x1ZGUgPGxpbnV4
L3dhaXQuaD4KKworI2luY2x1ZGUgPGRybS9kcm1fZmlsZS5oPgorI2luY2x1ZGUgPGRybS9kcm1f
dXRpbHMuaD4KKworI2luY2x1ZGUgImk5MTVfZHJ2LmgiCisjaW5jbHVkZSAiaTkxNV9nZW1faW9j
dGxzLmgiCisjaW5jbHVkZSAiaTkxNV91c2VyX2V4dGVuc2lvbnMuaCIKKworc3RydWN0IGlvdmFf
d2FrZSB7CisJc3RydWN0IHRhc2tfc3RydWN0ICp0c2s7CisJdm9pZCAqcHRyOworCXU2NCB2YWx1
ZTsKKwl1NjQgbWFzazsKKwl1MTYgd2lkdGg7CisJdTE2IG9wOworCWJvb2wgY2FjaGVfY29oZXJl
bnQ7Cit9OworCitzdGF0aWMgYm9vbCBpb3ZhX2NvbXBhcmUoY29uc3Qgc3RydWN0IGlvdmFfd2Fr
ZSAqd2FrZSkKK3sKKwl1NjQgdmFsdWUgPSB3YWtlLT52YWx1ZSAmIHdha2UtPm1hc2s7CisJdTY0
IHRhcmdldCA9IDA7CisKKwlHRU1fQlVHX09OKHdha2UtPndpZHRoID4gc2l6ZW9mKHRhcmdldCkp
OworCisJaWYgKCF3YWtlLT5jYWNoZV9jb2hlcmVudCkKKwkJZHJtX2NsZmx1c2hfdmlydF9yYW5n
ZSh3YWtlLT5wdHIsIHdha2UtPndpZHRoKTsKKwlzd2l0Y2ggKHdha2UtPndpZHRoKSB7CisJY2Fz
ZSAxOiBtZW1jcHkoJnRhcmdldCwgd2FrZS0+cHRyLCAxKTsgYnJlYWs7CisJY2FzZSAyOiBtZW1j
cHkoJnRhcmdldCwgd2FrZS0+cHRyLCAyKTsgYnJlYWs7CisJY2FzZSA0OiBtZW1jcHkoJnRhcmdl
dCwgd2FrZS0+cHRyLCA0KTsgYnJlYWs7CisJY2FzZSA4OiBtZW1jcHkoJnRhcmdldCwgd2FrZS0+
cHRyLCA4KTsgYnJlYWs7CisJfQorCXRhcmdldCAmPSB3YWtlLT5tYXNrOworCisJc3dpdGNoICh3
YWtlLT5vcCkgeworCWNhc2UgSTkxNV9WTV9XQUlUX0VROgorCQlyZXR1cm4gdmFsdWUgPT0gdGFy
Z2V0OworCWNhc2UgSTkxNV9WTV9XQUlUX05FUToKKwkJcmV0dXJuIHZhbHVlICE9IHRhcmdldDsK
KworCWNhc2UgSTkxNV9WTV9XQUlUX0dUOgorCQlyZXR1cm4gdGFyZ2V0ID4gdmFsdWU7CisJY2Fz
ZSBJOTE1X1ZNX1dBSVRfR1RFOgorCQlyZXR1cm4gdGFyZ2V0ID49IHZhbHVlOworCisJY2FzZSBJ
OTE1X1ZNX1dBSVRfTFQ6CisJCXJldHVybiB0YXJnZXQgPCB2YWx1ZTsKKwljYXNlIEk5MTVfVk1f
V0FJVF9MVEU6CisJCXJldHVybiB0YXJnZXQgPD0gdmFsdWU7CisKKwljYXNlIEk5MTVfVk1fV0FJ
VF9BRlRFUjoKKwkJc3dpdGNoICh3YWtlLT53aWR0aCkgeworCQljYXNlIDE6ICByZXR1cm4gKHM4
KSh0YXJnZXQgLSB2YWx1ZSkgPiAwOworCQljYXNlIDI6ICByZXR1cm4gKHMxNikodGFyZ2V0IC0g
dmFsdWUpID4gMDsKKwkJY2FzZSA0OiAgcmV0dXJuIChzMzIpKHRhcmdldCAtIHZhbHVlKSA+IDA7
CisJCWRlZmF1bHQ6IHJldHVybiAoczY0KSh0YXJnZXQgLSB2YWx1ZSkgPiAwOworCQl9CisKKwlj
YXNlIEk5MTVfVk1fV0FJVF9CRUZPUkU6CisJCXN3aXRjaCAod2FrZS0+d2lkdGgpIHsKKwkJY2Fz
ZSAxOiAgcmV0dXJuIChzOCkodGFyZ2V0IC0gdmFsdWUpIDwgMDsKKwkJY2FzZSAyOiAgcmV0dXJu
IChzMTYpKHRhcmdldCAtIHZhbHVlKSA8IDA7CisJCWNhc2UgNDogIHJldHVybiAoczMyKSh0YXJn
ZXQgLSB2YWx1ZSkgPCAwOworCQlkZWZhdWx0OiByZXR1cm4gKHM2NCkodGFyZ2V0IC0gdmFsdWUp
IDwgMDsKKwkJfQorCisJZGVmYXVsdDoKKwkJcmV0dXJuIHRydWU7CisJfQorfQorCitzdGF0aWMg
aW50IGlvdmFfd2FrZSh3YWl0X3F1ZXVlX2VudHJ5X3QgKmN1cnIsCisJCSAgICAgdW5zaWduZWQg
aW50IG1vZGUsIGludCB3YWtlX2ZsYWdzLAorCQkgICAgIHZvaWQgKmtleSkKK3sKKwlzdHJ1Y3Qg
aW92YV93YWtlICp3YWtlID0gY3Vyci0+cHJpdmF0ZTsKKworCWlmICghaW92YV9jb21wYXJlKHdh
a2UpKQorCQlyZXR1cm4gMDsKKworCXJldHVybiB3YWtlX3VwX3Byb2Nlc3Mod2FrZS0+dHNrKTsK
K30KKworc3RhdGljIGludCBpb3ZhX3dha2VfbWFwKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAorCQkJ
IHN0cnVjdCBkcm1faTkxNV9nZW1fdm1fd2FpdCAqYXJnLAorCQkJIHN0cnVjdCBpb3ZhX3dha2Ug
Kndha2UpCit7CisJc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiA9IHZtYS0+b2JqOwor
CXU2NCBvZmZzZXQgPSBhcmctPmlvdmEgLSB2bWEtPm5vZGUuc3RhcnQ7CisKKwl3YWtlLT50c2sg
PSBjdXJyZW50OworCXdha2UtPnZhbHVlID0gYXJnLT52YWx1ZTsKKwl3YWtlLT5tYXNrID0gYXJn
LT5tYXNrOworCXdha2UtPm9wID0gYXJnLT5vcDsKKworCWlmIChpOTE1X2dlbV9vYmplY3RfaGFz
X3N0cnVjdF9wYWdlKG9iaikpIHsKKwkJc3RydWN0IHBhZ2UgKnBhZ2U7CisKKwkJcGFnZSA9IGk5
MTVfZ2VtX29iamVjdF9nZXRfcGFnZShvYmosIG9mZnNldCA+PiBQQUdFX1NISUZUKTsKKwkJd2Fr
ZS0+cHRyID0ga21hcChwYWdlKSArIG9mZnNldF9pbl9wYWdlKG9mZnNldCk7CisKKwkJd2FrZS0+
Y2FjaGVfY29oZXJlbnQgPQorCQkJb2JqLT5jYWNoZV9jb2hlcmVudCAmIEk5MTVfQk9fQ0FDSEVf
Q09IRVJFTlRfRk9SX1JFQUQ7CisJfSBlbHNlIHsKKwkJdm9pZCAqcHRyOworCisJCXB0ciA9IGk5
MTVfZ2VtX29iamVjdF9waW5fbWFwKG9iaiwgSTkxNV9NQVBfV0MpOworCQlpZiAoSVNfRVJSKHB0
cikpCisJCQlyZXR1cm4gUFRSX0VSUihwdHIpOworCisJCXdha2UtPnB0ciA9IHB0ciArIG9mZnNl
dDsKKwkJd2FrZS0+Y2FjaGVfY29oZXJlbnQgPSB0cnVlOworCX0KKworCXJldHVybiAwOworfQor
CitzdGF0aWMgdm9pZCBpb3ZhX3dha2VfdW5tYXAoc3RydWN0IGk5MTVfdm1hICp2bWEsCisJCQkg
ICAgc3RydWN0IGRybV9pOTE1X2dlbV92bV93YWl0ICphcmcsCisJCQkgICAgc3RydWN0IGlvdmFf
d2FrZSAqd2FrZSkKK3sKKwlzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqb2JqID0gdm1hLT5v
Ymo7CisKKwlpZiAoaTkxNV9nZW1fb2JqZWN0X2hhc19zdHJ1Y3RfcGFnZShvYmopKSB7CisJCXU2
NCBvZmZzZXQgPSBhcmctPmlvdmEgLSB2bWEtPm5vZGUuc3RhcnQ7CisKKwkJa3VubWFwKGk5MTVf
Z2VtX29iamVjdF9nZXRfcGFnZShvYmosIG9mZnNldCA+PiBQQUdFX1NISUZUKSk7CisJfSBlbHNl
IHsKKwkJaTkxNV9nZW1fb2JqZWN0X3VucGluX21hcChvYmopOworCX0KK30KKworc3RhdGljIHN0
cnVjdCBpOTE1X3ZtYSAqCitmaW5kX3ZtYV9mb3JfaW92YShzdHJ1Y3QgaTkxNV9hZGRyZXNzX3Nw
YWNlICp2bSwgdTY0IGlvdmEsIHVuc2lnbmVkIGludCB3aWR0aCkKK3sKKwlzdHJ1Y3QgZHJtX21t
X25vZGUgKm5vZGU7CisJc3RydWN0IGk5MTVfdm1hICp2bWE7CisKKwlpZiAobXV0ZXhfbG9ja19p
bnRlcnJ1cHRpYmxlKCZ2bS0+bXV0ZXgpKQorCQlyZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsKKwor
CW5vZGUgPSBfX2RybV9tbV9pbnRlcnZhbF9maXJzdCgmdm0tPm1tLCBpb3ZhLCBpb3ZhICsgd2lk
dGgpOworCWlmICghbm9kZSB8fCBub2RlLT5jb2xvciA9PSBJOTE1X0NPTE9SX1VORVZJQ1RBQkxF
KSB7CisJCXZtYSA9IEVSUl9QVFIoLUVOT0VOVCk7CisJCWdvdG8gb3V0X3VubG9jazsKKwl9CisK
KwlpZiAobm9kZS0+c3RhcnQgPiBpb3ZhIHx8IGlvdmEgKyB3aWR0aCA+IG5vZGUtPnN0YXJ0ICsg
bm9kZS0+c2l6ZSkgeworCQl2bWEgPSBFUlJfUFRSKC1FTk9FTlQpOworCQlnb3RvIG91dF91bmxv
Y2s7CisJfQorCisJdm1hID0gY29udGFpbmVyX29mKG5vZGUsIHR5cGVvZigqdm1hKSwgbm9kZSk7
CisJaTkxNV9hY3RpdmVfYWNxdWlyZSgmdm1hLT5hY3RpdmUpOworCitvdXRfdW5sb2NrOgorCW11
dGV4X3VubG9jaygmdm0tPm11dGV4KTsKKwlyZXR1cm4gdm1hOworfQorCitzdHJ1Y3QgZW5naW5l
X3dhaXQgeworCXN0cnVjdCB3YWl0X3F1ZXVlX2VudHJ5IHdxX2VudHJ5OworCXN0cnVjdCBpbnRl
bF9lbmdpbmVfY3MgKmVuZ2luZTsKKwlzdHJ1Y3QgZW5naW5lX3dhaXQgKm5leHQ7Cit9OworCitz
dGF0aWMgaW50CithZGRfZW5naW5lX3dhaXQoc3RydWN0IGVuZ2luZV93YWl0ICoqaGVhZCwKKwkJ
c3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lLAorCQlzdHJ1Y3QgaW92YV93YWtlICp3YWtl
KQoreworCXN0cnVjdCBlbmdpbmVfd2FpdCAqd2FpdDsKKworCXdhaXQgPSBrbWFsbG9jKHNpemVv
Zigqd2FpdCksIEdGUF9LRVJORUwpOworCWlmICghd2FpdCkKKwkJcmV0dXJuIC1FTk9NRU07CisK
Kwl3YWl0LT5lbmdpbmUgPSBlbmdpbmU7CisJd2FpdC0+d3FfZW50cnkuZmxhZ3MgPSAwOworCXdh
aXQtPndxX2VudHJ5LnByaXZhdGUgPSB3YWtlOworCXdhaXQtPndxX2VudHJ5LmZ1bmMgPSBpb3Zh
X3dha2U7CisJaW50ZWxfZW5naW5lX2FkZF93YWl0KGVuZ2luZSwgJndhaXQtPndxX2VudHJ5KTsK
KworCXdhaXQtPm5leHQgPSAqaGVhZDsKKwkqaGVhZCA9IHdhaXQ7CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGludCBhZGRfZ3Rfd2FpdChzdHJ1Y3QgZW5naW5lX3dhaXQgKipoZWFkLAorCQkg
ICAgICAgc3RydWN0IGludGVsX2d0ICpndCwKKwkJICAgICAgIHN0cnVjdCBpb3ZhX3dha2UgKndh
a2UpCit7CisJc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lOworCWVudW0gaW50ZWxfZW5n
aW5lX2lkIGlkOworCWludCBlcnI7CisKKwlmb3JfZWFjaF9lbmdpbmUoZW5naW5lLCBndCwgaWQp
IHsKKwkJZXJyID0gYWRkX2VuZ2luZV93YWl0KGhlYWQsIGVuZ2luZSwgd2FrZSk7CisJCWlmIChl
cnIpCisJCQlyZXR1cm4gZXJyOworCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBy
ZW1vdmVfd2FpdHMoc3RydWN0IGVuZ2luZV93YWl0ICp3YWl0KQoreworCXdoaWxlICh3YWl0KSB7
CisJCXN0cnVjdCBlbmdpbmVfd2FpdCAqbmV4dCA9IHdhaXQtPm5leHQ7CisKKwkJaW50ZWxfZW5n
aW5lX3JlbW92ZV93YWl0KHdhaXQtPmVuZ2luZSwgJndhaXQtPndxX2VudHJ5KTsKKwkJa2ZyZWUo
d2FpdCk7CisKKwkJd2FpdCA9IG5leHQ7CisJfQorfQorCitzdGF0aWMgaW5saW5lIHVuc2lnbmVk
IGxvbmcgbnNlY3NfdG9famlmZmllc190aW1lb3V0KGNvbnN0IHU2NCBuKQoreworCS8qIG5zZWNz
X3RvX2ppZmZpZXM2NCgpIGRvZXMgbm90IGd1YXJkIGFnYWluc3Qgb3ZlcmZsb3cgKi8KKwlpZiAo
TlNFQ19QRVJfU0VDICUgSFogJiYKKwkgICAgZGl2X3U2NChuLCBOU0VDX1BFUl9TRUMpID49IE1B
WF9KSUZGWV9PRkZTRVQgLyBIWikKKwkJcmV0dXJuIE1BWF9KSUZGWV9PRkZTRVQ7CisKKwlyZXR1
cm4gbWluX3QodTY0LCBNQVhfSklGRllfT0ZGU0VULCBuc2Vjc190b19qaWZmaWVzNjQobikgKyAx
KTsKK30KKworc3RhdGljIHVuc2lnbmVkIGxvbmcgdG9fd2FpdF90aW1lb3V0KGNvbnN0IHN0cnVj
dCBkcm1faTkxNV9nZW1fdm1fd2FpdCAqYXJnKQoreworCWlmIChhcmctPmZsYWdzICYgSTkxNV9W
TV9XQUlUX0FCU1RJTUUpCisJCXJldHVybiBkcm1fdGltZW91dF9hYnNfdG9famlmZmllcyhhcmct
PnRpbWVvdXQpOworCisJaWYgKGFyZy0+dGltZW91dCA8IDApCisJCXJldHVybiBNQVhfU0NIRURV
TEVfVElNRU9VVDsKKworCWlmIChhcmctPnRpbWVvdXQgPT0gMCkKKwkJcmV0dXJuIDA7CisKKwly
ZXR1cm4gbnNlY3NfdG9famlmZmllc190aW1lb3V0KGFyZy0+dGltZW91dCk7Cit9CisKK2ludCBp
OTE1X2dlbV92bV93YWl0X2lvY3RsKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCisJCQkgICB2b2lk
ICpkYXRhLCBzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUpCit7CisJc3RydWN0IGRybV9pOTE1X2ZpbGVf
cHJpdmF0ZSAqZmlsZV9wcml2ID0gZmlsZS0+ZHJpdmVyX3ByaXY7CisJc3RydWN0IGRybV9pOTE1
X2dlbV92bV93YWl0ICphcmcgPSBkYXRhOworCXN0cnVjdCBlbmdpbmVfd2FpdCAqd2FpdCA9IE5V
TEw7CisJc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm07CisJc3RydWN0IGlvdmFfd2FrZSB3
YWtlOworCXVuc2lnbmVkIGxvbmcgdGltZW91dDsKKwlzdHJ1Y3QgaTkxNV92bWEgKnZtYTsKKwlr
dGltZV90IHN0YXJ0OworCWludCBlcnI7CisKKwlpZiAoYXJnLT5mbGFncyAmIH5JOTE1X1ZNX1dB
SVRfQUJTVElNRSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlzd2l0Y2ggKGFyZy0+b3ApIHsKKwlj
YXNlIEk5MTVfVk1fV0FJVF9FUToKKwljYXNlIEk5MTVfVk1fV0FJVF9ORVE6CisJY2FzZSBJOTE1
X1ZNX1dBSVRfR1Q6CisJY2FzZSBJOTE1X1ZNX1dBSVRfR1RFOgorCWNhc2UgSTkxNV9WTV9XQUlU
X0xUOgorCWNhc2UgSTkxNV9WTV9XQUlUX0xURToKKwljYXNlIEk5MTVfVk1fV0FJVF9BRlRFUjoK
KwljYXNlIEk5MTVfVk1fV0FJVF9CRUZPUkU6CisJCWJyZWFrOworCisJZGVmYXVsdDoKKwkJcmV0
dXJuIC1FSU5WQUw7CisJfQorCisJd2FrZS53aWR0aCA9IGZsczY0KGFyZy0+bWFzayk7CisJaWYg
KCF3YWtlLndpZHRoKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCS8qIFJlc3RyaWN0IHRoZSBpb3Zh
IHRvIGJlICJuYXR1cmFsbHkiIGFsaWduZWQgKi8KKwl3YWtlLndpZHRoID0gRElWX1JPVU5EX1VQ
KHJvdW5kdXBfcG93X29mX3R3byh3YWtlLndpZHRoKSwgOCk7CisJaWYgKCFJU19BTElHTkVEKGFy
Zy0+aW92YSwgd2FrZS53aWR0aCkpCisJCXJldHVybiAtRUlOVkFMOworCisJLyogTmF0dXJhbCBh
bGlnbm1lbnQgYWxzbyBtZWFucyB0aGUgaW92YSBjYW5ub3QgY3Jvc3MgYSBwYWdlIGJvdW5kYXJ5
ICovCisJR0VNX0JVR19PTihhcmctPmlvdmEgPj4gUEFHRV9TSElGVCAhPQorCQkgICAoYXJnLT5p
b3ZhICsgd2FrZS53aWR0aCkgPj4gUEFHRV9TSElGVCk7CisKKwlyY3VfcmVhZF9sb2NrKCk7CisJ
dm0gPSB4YV9sb2FkKCZmaWxlX3ByaXYtPnZtX3hhLCBhcmctPnZtX2lkKTsKKwlpZiAodm0gJiYg
IWtyZWZfZ2V0X3VubGVzc196ZXJvKCZ2bS0+cmVmKSkKKwkJdm0gPSBOVUxMOworCXJjdV9yZWFk
X3VubG9jaygpOworCWlmICghdm0pCisJCXJldHVybiAtRU5PRU5UOworCisJdm1hID0gZmluZF92
bWFfZm9yX2lvdmEodm0sIGFyZy0+aW92YSwgd2FrZS53aWR0aCk7CisJaWYgKElTX0VSUih2bWEp
KSB7CisJCWVyciA9IFBUUl9FUlIodm1hKTsKKwkJZ290byBvdXRfdm07CisJfQorCisJZXJyID0g
aW92YV93YWtlX21hcCh2bWEsIGFyZywgJndha2UpOworCWlmIChlcnIpCisJCWdvdG8gb3V0X3Zt
YTsKKworCWVyciA9IGk5MTVfdXNlcl9leHRlbnNpb25zKHU2NF90b191c2VyX3B0cihhcmctPmV4
dGVuc2lvbnMpLAorCQkJCSAgIE5VTEwsIDAsICZ3YWtlKTsKKwlpZiAoZXJyKQorCQlnb3RvIG91
dF93YWtlOworCisJaWYgKGlvdmFfY29tcGFyZSgmd2FrZSkpCisJCWdvdG8gb3V0X3dha2U7CisK
Kwl0aW1lb3V0ID0gdG9fd2FpdF90aW1lb3V0KGFyZyk7CisJaWYgKCF0aW1lb3V0KSB7CisJCWVy
ciA9IC1FVElNRTsKKwkJZ290byBvdXRfdm1hOworCX0KKworCWVyciA9IGFkZF9ndF93YWl0KCZ3
YWl0LCB2bS0+Z3QsICZ3YWtlKTsKKwlpZiAoZXJyKQorCQlnb3RvIG91dF93YWl0OworCisJc3Rh
cnQgPSBrdGltZV9nZXQoKTsKKwlmb3IgKDs7KSB7CisJCXNldF9jdXJyZW50X3N0YXRlKFRBU0tf
SU5URVJSVVBUSUJMRSk7CisKKwkJaWYgKGlvdmFfY29tcGFyZSgmd2FrZSkpCisJCQlicmVhazsK
KworCQlpZiAoc2lnbmFsX3BlbmRpbmcod2FrZS50c2spKSB7CisJCQllcnIgPSAtRVJFU1RBUlRT
WVM7CisJCQlicmVhazsKKwkJfQorCisJCWlmICghdGltZW91dCkgeworCQkJZXJyID0gLUVUSU1F
OworCQkJYnJlYWs7CisJCX0KKworCQl0aW1lb3V0ID0gaW9fc2NoZWR1bGVfdGltZW91dCh0aW1l
b3V0KTsKKwl9CisJX19zZXRfY3VycmVudF9zdGF0ZShUQVNLX1JVTk5JTkcpOworCisJaWYgKCEo
YXJnLT5mbGFncyAmIEk5MTVfVk1fV0FJVF9BQlNUSU1FKSAmJiBhcmctPnRpbWVvdXQgPiAwKSB7
CisJCWFyZy0+dGltZW91dCAtPSBrdGltZV90b19ucyhrdGltZV9zdWIoa3RpbWVfZ2V0KCksIHN0
YXJ0KSk7CisJCWlmIChhcmctPnRpbWVvdXQgPCAwKQorCQkJYXJnLT50aW1lb3V0ID0gMDsKKwor
CQkvKgorCQkgKiBBcHBhcmVudGx5IGt0aW1lIGlzbid0IGFjY3VyYXRlIGVub3VnaCBhbmQgb2Nj
YXNpb25hbGx5IGhhcyBhCisJCSAqIGJpdCBvZiBtaXNtYXRjaCBpbiB0aGUgamlmZmllczwtPm5z
ZWNzPC0+a3RpbWUgbG9vcC4gU28gcGF0Y2gKKwkJICogdGhpbmdzIHVwIHRvIG1ha2UgdGhlIHRl
c3QgaGFwcHkuIFdlIGFsbG93IHVwIHRvIDEgamlmZnkuCisJCSAqCisJCSAqIFRoaXMgaXMgYSBy
ZWdyZXNzaW9uIGZyb20gdGhlIHRpbWVzcGVjLT5rdGltZSBjb252ZXJzaW9uLgorCQkgKi8KKwkJ
aWYgKGVyciA9PSAtRVRJTUUgJiYgIW5zZWNzX3RvX2ppZmZpZXMoYXJnLT50aW1lb3V0KSkKKwkJ
CWFyZy0+dGltZW91dCA9IDA7CisKKwkJLyogQXNrZWQgdG8gd2FpdCBiZXlvbmQgdGhlIGppZmZp
ZS9zY2hlZHVsZXIgcHJlY2lzaW9uPyAqLworCQlpZiAoZXJyID09IC1FVElNRSAmJiBhcmctPnRp
bWVvdXQpCisJCQllcnIgPSAtRUFHQUlOOworCX0KKworb3V0X3dhaXQ6CisJcmVtb3ZlX3dhaXRz
KHdhaXQpOworb3V0X3dha2U6CisJaW92YV93YWtlX3VubWFwKHZtYSwgYXJnLCAmd2FrZSk7Citv
dXRfdm1hOgorCWk5MTVfYWN0aXZlX3JlbGVhc2UoJnZtYS0+YWN0aXZlKTsKK291dF92bToKKwlp
OTE1X3ZtX3B1dCh2bSk7CisJcmV0dXJuIGVycjsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9n
dC9pbnRlbF9icmVhZGNydW1icy5jCmluZGV4IDBiYTUyNGE0MTRjNi4uY2I2YWQ4ZDY2OTE3IDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9icmVhZGNydW1icy5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2ludGVsX2JyZWFkY3J1bWJzLmMKQEAgLTIxMCw2
ICsyMTAsOCBAQCBzdGF0aWMgdm9pZCBzaWduYWxfaXJxX3dvcmsoc3RydWN0IGlycV93b3JrICp3
b3JrKQogCiAJCWk5MTVfcmVxdWVzdF9wdXQocnEpOwogCX0KKworCXdha2VfdXBfYWxsKCZiLT53
cSk7CiB9CiAKIHN0YXRpYyBib29sIF9faW50ZWxfYnJlYWRjcnVtYnNfYXJtX2lycShzdHJ1Y3Qg
aW50ZWxfYnJlYWRjcnVtYnMgKmIpCkBAIC0yNTQsNiArMjU2LDcgQEAgdm9pZCBpbnRlbF9lbmdp
bmVfaW5pdF9icmVhZGNydW1icyhzdHJ1Y3QgaW50ZWxfZW5naW5lX2NzICplbmdpbmUpCiAJSU5J
VF9MSVNUX0hFQUQoJmItPnNpZ25hbGVycyk7CiAKIAlpbml0X2lycV93b3JrKCZiLT5pcnFfd29y
aywgc2lnbmFsX2lycV93b3JrKTsKKwlpbml0X3dhaXRxdWV1ZV9oZWFkKCZiLT53cSk7CiB9CiAK
IHZvaWQgaW50ZWxfZW5naW5lX3Jlc2V0X2JyZWFkY3J1bWJzKHN0cnVjdCBpbnRlbF9lbmdpbmVf
Y3MgKmVuZ2luZSkKQEAgLTM0OSw2ICszNTIsNDYgQEAgdm9pZCBpOTE1X3JlcXVlc3RfY2FuY2Vs
X2JyZWFkY3J1bWIoc3RydWN0IGk5MTVfcmVxdWVzdCAqcnEpCiAJc3Bpbl91bmxvY2soJmItPmly
cV9sb2NrKTsKIH0KIAorc3RhdGljIHZvaWQgaW50ZWxfZW5naW5lX3Bpbl9icmVhZGNydW1ic19p
cnEoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQoreworCXN0cnVjdCBpbnRlbF9icmVh
ZGNydW1icyAqYiA9ICZlbmdpbmUtPmJyZWFkY3J1bWJzOworCisJc3Bpbl9sb2NrX2lycSgmYi0+
aXJxX2xvY2spOworCWlmICghYi0+aXJxX2VuYWJsZWQrKykKKwkJaXJxX2VuYWJsZShlbmdpbmUp
OworCUdFTV9CVUdfT04oIWItPmlycV9lbmFibGVkKTsgLyogbm8gb3ZlcmZsb3chICovCisJc3Bp
bl91bmxvY2tfaXJxKCZiLT5pcnFfbG9jayk7Cit9CisKK3N0YXRpYyB2b2lkIGludGVsX2VuZ2lu
ZV91bnBpbl9icmVhZGNydW1ic19pcnEoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKQor
eworCXN0cnVjdCBpbnRlbF9icmVhZGNydW1icyAqYiA9ICZlbmdpbmUtPmJyZWFkY3J1bWJzOwor
CisJc3Bpbl9sb2NrX2lycSgmYi0+aXJxX2xvY2spOworCUdFTV9CVUdfT04oIWItPmlycV9lbmFi
bGVkKTsgLyogbm8gdW5kZXJmbG93ISAqLworCWlmICghLS1iLT5pcnFfZW5hYmxlZCkKKwkJaXJx
X2Rpc2FibGUoZW5naW5lKTsKKwlzcGluX3VubG9ja19pcnEoJmItPmlycV9sb2NrKTsKK30KKwor
dm9pZCBpbnRlbF9lbmdpbmVfYWRkX3dhaXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5l
LAorCQkJICAgc3RydWN0IHdhaXRfcXVldWVfZW50cnkgKndhaXQpCit7CisJc3RydWN0IGludGVs
X2JyZWFkY3J1bWJzICpiID0gJmVuZ2luZS0+YnJlYWRjcnVtYnM7CisKKwlpbnRlbF9lbmdpbmVf
cGluX2JyZWFkY3J1bWJzX2lycShlbmdpbmUpOworCWFkZF93YWl0X3F1ZXVlKCZiLT53cSwgd2Fp
dCk7Cit9CisKK3ZvaWQgaW50ZWxfZW5naW5lX3JlbW92ZV93YWl0KHN0cnVjdCBpbnRlbF9lbmdp
bmVfY3MgKmVuZ2luZSwKKwkJCSAgICAgIHN0cnVjdCB3YWl0X3F1ZXVlX2VudHJ5ICp3YWl0KQor
eworCXN0cnVjdCBpbnRlbF9icmVhZGNydW1icyAqYiA9ICZlbmdpbmUtPmJyZWFkY3J1bWJzOwor
CisJcmVtb3ZlX3dhaXRfcXVldWUoJmItPndxLCB3YWl0KTsKKwlpbnRlbF9lbmdpbmVfdW5waW5f
YnJlYWRjcnVtYnNfaXJxKGVuZ2luZSk7Cit9CisKIHZvaWQgaW50ZWxfZW5naW5lX3ByaW50X2Jy
ZWFkY3J1bWJzKHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgKmVuZ2luZSwKIAkJCQkgICAgc3RydWN0
IGRybV9wcmludGVyICpwKQogewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lLmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmUuaApp
bmRleCA1ZGYwMDMwNjFlNDQuLmRjMDA3NzJkY2JhNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ3QvaW50ZWxfZW5naW5lLmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ3Qv
aW50ZWxfZW5naW5lLmgKQEAgLTIxMCw2ICsyMTAsMTEgQEAgdm9pZCBpbnRlbF9lbmdpbmVfaW5p
dF9leGVjbGlzdHMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsKIHZvaWQgaW50ZWxf
ZW5naW5lX2luaXRfYnJlYWRjcnVtYnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5naW5lKTsK
IHZvaWQgaW50ZWxfZW5naW5lX2ZpbmlfYnJlYWRjcnVtYnMoc3RydWN0IGludGVsX2VuZ2luZV9j
cyAqZW5naW5lKTsKIAordm9pZCBpbnRlbF9lbmdpbmVfYWRkX3dhaXQoc3RydWN0IGludGVsX2Vu
Z2luZV9jcyAqZW5naW5lLAorCQkJICAgc3RydWN0IHdhaXRfcXVldWVfZW50cnkgKndhaXQpOwor
dm9pZCBpbnRlbF9lbmdpbmVfcmVtb3ZlX3dhaXQoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lLAorCQkJICAgICAgc3RydWN0IHdhaXRfcXVldWVfZW50cnkgKndhaXQpOworCiB2b2lkIGlu
dGVsX2VuZ2luZV9kaXNhcm1fYnJlYWRjcnVtYnMoc3RydWN0IGludGVsX2VuZ2luZV9jcyAqZW5n
aW5lKTsKIAogc3RhdGljIGlubGluZSB2b2lkCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d0L2lu
dGVsX2VuZ2luZV90eXBlcy5oCmluZGV4IDc3ZTY4Yzc2NDNkZS4uNDE1YjEyYTZhZWYwIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndC9pbnRlbF9lbmdpbmVfdHlwZXMuaApAQCAtMzQ5LDYg
KzM0OSw3IEBAIHN0cnVjdCBpbnRlbF9lbmdpbmVfY3MgewogCQlzdHJ1Y3QgbGlzdF9oZWFkIHNp
Z25hbGVyczsKIAogCQlzdHJ1Y3QgaXJxX3dvcmsgaXJxX3dvcms7IC8qIGZvciB1c2UgZnJvbSBp
bnNpZGUgaXJxX2xvY2sgKi8KKwkJc3RydWN0IHdhaXRfcXVldWVfaGVhZCB3cTsKIAogCQl1bnNp
Z25lZCBpbnQgaXJxX2VuYWJsZWQ7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5jCmluZGV4IGY3Mzg1
YWJkZDc0Yi4uN2FiNDAzOWNjMWU1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2Rydi5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmMKQEAgLTI3NDcs
NiArMjc0Nyw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2lvY3RsX2Rlc2MgaTkxNV9pb2N0
bHNbXSA9IHsKIAlEUk1fSU9DVExfREVGX0RSVihJOTE1X1FVRVJZLCBpOTE1X3F1ZXJ5X2lvY3Rs
LCBEUk1fUkVOREVSX0FMTE9XKSwKIAlEUk1fSU9DVExfREVGX0RSVihJOTE1X0dFTV9WTV9DUkVB
VEUsIGk5MTVfZ2VtX3ZtX2NyZWF0ZV9pb2N0bCwgRFJNX1JFTkRFUl9BTExPVyksCiAJRFJNX0lP
Q1RMX0RFRl9EUlYoSTkxNV9HRU1fVk1fREVTVFJPWSwgaTkxNV9nZW1fdm1fZGVzdHJveV9pb2N0
bCwgRFJNX1JFTkRFUl9BTExPVyksCisJRFJNX0lPQ1RMX0RFRl9EUlYoSTkxNV9HRU1fVk1fV0FJ
VCwgaTkxNV9nZW1fdm1fd2FpdF9pb2N0bCwgRFJNX1JFTkRFUl9BTExPVyksCiB9OwogCiBzdGF0
aWMgc3RydWN0IGRybV9kcml2ZXIgZHJpdmVyID0gewpkaWZmIC0tZ2l0IGEvaW5jbHVkZS91YXBp
L2RybS9pOTE1X2RybS5oIGIvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCmluZGV4IDgyOWMw
YTQ4NTc3Zi4uNDIxZGY2YWE0NTIwIDEwMDY0NAotLS0gYS9pbmNsdWRlL3VhcGkvZHJtL2k5MTVf
ZHJtLmgKKysrIGIvaW5jbHVkZS91YXBpL2RybS9pOTE1X2RybS5oCkBAIC0zNTksNiArMzU5LDcg
QEAgdHlwZWRlZiBzdHJ1Y3QgX2RybV9pOTE1X3NhcmVhIHsKICNkZWZpbmUgRFJNX0k5MTVfUVVF
UlkJCQkweDM5CiAjZGVmaW5lIERSTV9JOTE1X0dFTV9WTV9DUkVBVEUJCTB4M2EKICNkZWZpbmUg
RFJNX0k5MTVfR0VNX1ZNX0RFU1RST1kJCTB4M2IKKyNkZWZpbmUgRFJNX0k5MTVfR0VNX1ZNX1dB
SVQJCTB4M2MKIC8qIE11c3QgYmUga2VwdCBjb21wYWN0IC0tIG5vIGhvbGVzICovCiAKICNkZWZp
bmUgRFJNX0lPQ1RMX0k5MTVfSU5JVAkJRFJNX0lPVyggRFJNX0NPTU1BTkRfQkFTRSArIERSTV9J
OTE1X0lOSVQsIGRybV9pOTE1X2luaXRfdCkKQEAgLTQyMiw2ICs0MjMsNyBAQCB0eXBlZGVmIHN0
cnVjdCBfZHJtX2k5MTVfc2FyZWEgewogI2RlZmluZSBEUk1fSU9DVExfSTkxNV9RVUVSWQkJCURS
TV9JT1dSKERSTV9DT01NQU5EX0JBU0UgKyBEUk1fSTkxNV9RVUVSWSwgc3RydWN0IGRybV9pOTE1
X3F1ZXJ5KQogI2RlZmluZSBEUk1fSU9DVExfSTkxNV9HRU1fVk1fQ1JFQVRFCURSTV9JT1dSKERS
TV9DT01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1fVk1fQ1JFQVRFLCBzdHJ1Y3QgZHJtX2k5MTVf
Z2VtX3ZtX2NvbnRyb2wpCiAjZGVmaW5lIERSTV9JT0NUTF9JOTE1X0dFTV9WTV9ERVNUUk9ZCURS
TV9JT1cgKERSTV9DT01NQU5EX0JBU0UgKyBEUk1fSTkxNV9HRU1fVk1fREVTVFJPWSwgc3RydWN0
IGRybV9pOTE1X2dlbV92bV9jb250cm9sKQorI2RlZmluZSBEUk1fSU9DVExfSTkxNV9HRU1fVk1f
V0FJVAlEUk1fSU9XUihEUk1fQ09NTUFORF9CQVNFICsgRFJNX0k5MTVfR0VNX1ZNX1dBSVQsIHN0
cnVjdCBkcm1faTkxNV9nZW1fdm1fd2FpdCkKIAogLyogQWxsb3cgZHJpdmVycyB0byBzdWJtaXQg
YmF0Y2hidWZmZXJzIGRpcmVjdGx5IHRvIGhhcmR3YXJlLCByZWx5aW5nCiAgKiBvbiB0aGUgc2Vj
dXJpdHkgbWVjaGFuaXNtcyBwcm92aWRlZCBieSBoYXJkd2FyZS4KQEAgLTE4MjQsNiArMTgyNiw0
MCBAQCBzdHJ1Y3QgZHJtX2k5MTVfZ2VtX3ZtX2NvbnRyb2wgewogCV9fdTMyIHZtX2lkOwogfTsK
IAorLyoKKyAqICgqSU9WQSAmIE1BU0spIE9QIChWQUxVRSAmIE1BU0spCisgKgorICogT1A6Cisg
KiAtIEVRLCBORVEKKyAqIC0gR1QsIEdURQorICogLSBMVCwgTFRFCisgKiAtIEJFRk9SRSwgQUZU
RVIKKyAqCisgKi8KK3N0cnVjdCBkcm1faTkxNV9nZW1fdm1fd2FpdCB7CisJX191NjQgZXh0ZW5z
aW9uczsKKwlfX3U2NCBpb3ZhOworCV9fdTMyIHZtX2lkOworCV9fdTE2IG9wOworI2RlZmluZSBJ
OTE1X1ZNX1dBSVRfRVEJCTAKKyNkZWZpbmUgSTkxNV9WTV9XQUlUX05FUQkxCisjZGVmaW5lIEk5
MTVfVk1fV0FJVF9HVAkJMgorI2RlZmluZSBJOTE1X1ZNX1dBSVRfR1RFCTMKKyNkZWZpbmUgSTkx
NV9WTV9XQUlUX0xUCQk0CisjZGVmaW5lIEk5MTVfVk1fV0FJVF9MVEUJNQorI2RlZmluZSBJOTE1
X1ZNX1dBSVRfQkVGT1JFCTYKKyNkZWZpbmUgSTkxNV9WTV9XQUlUX0FGVEVSCTcKKwlfX3UxNiBm
bGFnczsKKyNkZWZpbmUgSTkxNV9WTV9XQUlUX0FCU1RJTUUgMHgxCisJX191NjQgdmFsdWU7CisJ
X191NjQgbWFzazsKKyNkZWZpbmUgSTkxNV9WTV9XQUlUX1U4CQkweGZmdQorI2RlZmluZSBJOTE1
X1ZNX1dBSVRfVTE2CTB4ZmZmZnUKKyNkZWZpbmUgSTkxNV9WTV9XQUlUX1UzMgkweGZmZmZmZmZm
dWwKKyNkZWZpbmUgSTkxNV9WTV9XQUlUX1U2NAkweGZmZmZmZmZmZmZmZmZmZmZ1bGwKKwlfX3U2
NCB0aW1lb3V0OworfTsKKwogc3RydWN0IGRybV9pOTE1X3JlZ19yZWFkIHsKIAkvKgogCSAqIFJl
Z2lzdGVyIG9mZnNldC4KLS0gCjIuMjUuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KSW50ZWwtZ2Z4IG1haWxpbmcgbGlzdApJbnRlbC1nZnhAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vaW50ZWwtZ2Z4Cg==
